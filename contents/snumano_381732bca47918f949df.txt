{"context": " More than 1 year has passed since last update.CoreOS \u304c\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u3082\u306e\u304c\u8208\u5473\u6df1\u304b\u3063\u305f\u306e\u3067\u3001\u81ea\u5206\u306e\u74b0\u5883\u3067\u3001\u305d\u308c\u305e\u308c\u6700\u65b0\u306eversion\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u74b0\u5883\n\nMacosx 10.9.5\nVagrant 1.6.5\nVirtualBox 4.3.20\nGolang 1.3.3\n\n\n\u74b0\u5883\u6e96\u5099\n\netcd\n\n\nCoreOS + Vagrant \u306b etcd \u3092\u4f7f\u3063\u3066\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b\nv0.4.6 Getting Started\n\n\u4e0a\u8a18\u3092\u53c2\u8003\u306b\u3001etcd\u3092\u8d77\u52d5\u3002\ngithub\u306bIt is strongly recommended that users work with the latest 0.4.x release (0.4.6)\u3068\u3042\u308b\u306e\u3067\u3001\u6700\u65b0\u306e0.5\u306f\u907f\u3051\u3066\u30010.4.6\u3092\u4f7f\u7528\u3002\netcd\u306eoption\u306fetcd --help\u3067\u78ba\u8a8d\u3059\u308b\u3068\u3001Qiita\u306e\u60c5\u5831\u3068\u306f\u5909\u308f\u3063\u3066\u3044\u305f\u3002-addr=\u3067\u6307\u5b9a\u3059\u308baddress\u306f172.17.8.1\u3092\u4f7f\u7528\u3002\u5f8c\u3067\u3001vagrant\u3067CoreOS\u8d77\u52d5\u3057\u305f\u3089vboxnet5\u3068\u3057\u3066\u3053\u306eaddress\u304c\u4f7f\u308f\u308c\u3066\u3044\u305f\u306e\u3067\u3002\n$ curl -L  https://github.com/coreos/etcd/releases/download/v0.4.6/etcd-v0.4.6-darwin-amd64.zip -o etcd-v 0.4.6-darwin-amd64.zip.\n$ unzip etcd-v0.4.6-darwin-amd64.zip.\n$ cd etcd-v0.4.6-darwin-amd64\nochi:etcd-v0.4.6-darwin-amd64\n$ pochi:etcd-v0.4.6-darwin-amd64\n$ ./etcd -addr=172.17.8.1:4001 -v\n[etcd] Nov 26 07:09:58.687 WARNING   | Using the directory pochi.local.etcd as the etcd curation directory because a directory was not specified.\n[etcd] Nov 26 07:09:58.690 DEBUG     | pochi.local finished load snapshot\n[etcd] Nov 26 07:09:58.698 DEBUG     | URLs: /_etcd/machines:  / pochi.local (http://127.0.0.1:7001)\n[etcd] Nov 26 07:09:58.698 INFO      | Peer URLs in log:  / pochi.local (http://127.0.0.1:7001)\n[etcd] Nov 26 07:09:58.699 DEBUG     | pochi.local is restarting the cluster []\n[etcd] Nov 26 07:09:58.700 INFO      | etcd server [name pochi.local, listen on :4001, advertised url http://172.17.8.1:4001]\n[etcd] Nov 26 07:09:58.700 INFO      | peer server [name pochi.local, listen on :7001, advertised url http://127.0.0.1:7001]\n[etcd] Nov 26 07:09:58.700 INFO      | pochi.local starting in peer mode\n[etcd] Nov 26 07:09:58.700 INFO      | pochi.local: state changed from 'initialized' to 'follower'.\n[etcd] Nov 26 07:09:58.933 INFO      | pochi.local: state changed from 'follower' to 'candidate'.\n[etcd] Nov 26 07:09:58.933 INFO      | pochi.local: state changed from 'candidate' to 'leader'.\n[etcd] Nov 26 07:09:58.933 INFO      | pochi.local: leader changed from '' to 'pochi.local'.\n[etcd] Nov 26 07:09:59.701 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n[etcd] Nov 26 07:10:00.703 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n[etcd] Nov 26 07:10:01.700 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n[etcd] Nov 26 07:10:01.704 INFO      | pochi.local: snapshot of 18908 events at index 18908 completed\n[etcd] Nov 26 07:10:02.701 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n[etcd] Nov 26 07:10:03.701 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n\n$ curl http://172.17.8.1:4001/version\netcd 0.4.6\n\n\nCoreOS Vagrant\n\nCoreOS + Vagrant \u306b etcd \u3092\u4f7f\u3063\u3066\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b\nCoreOS Vagrant\n\n\u4e45\u3057\u3076\u308a\u306bvagrant\u3055\u308f\u3063\u305f\u3089\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u304c1.3.x\u304b\u30891.6.x\u306b\u306a\u3063\u3066\u305f\u3002\u5f53\u7136\u306e\u3088\u3046\u306b\u3001error\u304c\u3067\u308b\u306e\u3067\u3001\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3001rm -r ~/.vagrant.d/plugins.json ~/.vagrant.d/gems\u3092\u5b9f\u884c\u3002\n\u305d\u3057\u3066cp user-data.sample user-data\u3057\u3066\u3001user-data\u306ediscovery\u884c\u3092\u7de8\u96c6\u3002\u5143\u306esample\u306fhttps\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3054\u6ce8\u610f\u3002\n#cloud-config\n\ncoreos:\n  etcd:\n    # generate a new token for each unique cluster from https://discovery.etcd.io/new\n    # WARNING: replace each time you 'vagrant destroy'\n    discovery: http://172.17.8.1:4001/v2/keys/machines\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n  units:\n    - name: etcd.service\n      command: start\n    - name: fleet.service\n      command: start\n    - name: docker-tcp.socket\n      command: start\n      enable: true\n      content: |\n        [Unit]\n        Description=Docker Socket for the API\n\n        [Socket]\n        ListenStream=2375\n        Service=docker.service\n        BindIPv6Only=both\n\n        [Install]\n        WantedBy=sockets.target\n\n\u7121\u4e8bvagrant up\u3067\u304d\u305f\nVagrant\u30921.3.5\u304b\u30891.6.3\u306b\u4e0a\u3052\u305f\u3088\uff08Vagrant Cloud\u3092\u4f7f\u3046\u3088\u3046\u306b\u306a\u3063\u305f\uff09\n$ vagrant up\nBringing machine 'core-01' up with 'virtualbox' provider...\nBringing machine 'core-02' up with 'virtualbox' provider...\nBringing machine 'core-03' up with 'virtualbox' provider...\n==> core-01: Importing base box 'coreos-alpha'...\n==> core-01: Matching MAC address for NAT networking...\n==> core-01: Checking if box 'coreos-alpha' is up to date...\n==> core-01: Setting the name of the VM: coreos-vagrant_core-01_1416954842606_17056\n==> core-01: Clearing any previously set network interfaces...\n==> core-01: Preparing network interfaces based on configuration...\n    core-01: Adapter 1: nat\n    core-01: Adapter 2: hostonly\n==> core-01: Forwarding ports...\n    core-01: 22 => 2222 (adapter 1)\n==> core-01: Running 'pre-boot' VM customizations...\n==> core-01: Booting VM...\n==> core-01: Waiting for machine to boot. This may take a few minutes...\n    core-01: SSH address: 127.0.0.1:2222\n    core-01: SSH username: core\n    core-01: SSH auth method: private key\n    core-01: Warning: Connection timeout. Retrying...\n==> core-01: Machine booted and ready!\n==> core-01: Setting hostname...\n==> core-01: Configuring and enabling network interfaces...\n==> core-01: Running provisioner: file...\n==> core-01: Running provisioner: shell...\n    core-01: Running: inline script\n==> core-02: Importing base box 'coreos-alpha'...\n==> core-02: Matching MAC address for NAT networking...\n==> core-02: Checking if box 'coreos-alpha' is up to date...\n==> core-02: Setting the name of the VM: coreos-vagrant_core-02_1416954865219_3677\n==> core-02: Fixed port collision for 22 => 2222. Now on port 2200.\n==> core-02: Clearing any previously set network interfaces...\n==> core-02: Preparing network interfaces based on configuration...\n    core-02: Adapter 1: nat\n    core-02: Adapter 2: hostonly\n==> core-02: Forwarding ports...\n    core-02: 22 => 2200 (adapter 1)\n==> core-02: Running 'pre-boot' VM customizations...\n==> core-02: Booting VM...\n==> core-02: Waiting for machine to boot. This may take a few minutes...\n    core-02: SSH address: 127.0.0.1:2200\n    core-02: SSH username: core\n    core-02: SSH auth method: private key\n    core-02: Warning: Connection timeout. Retrying...\n==> core-02: Machine booted and ready!\n==> core-02: Setting hostname...\n==> core-02: Configuring and enabling network interfaces...\n==> core-02: Running provisioner: file...\n==> core-02: Running provisioner: shell...\n    core-02: Running: inline script\n==> core-03: Importing base box 'coreos-alpha'...\n==> core-03: Matching MAC address for NAT networking...\n==> core-03: Checking if box 'coreos-alpha' is up to date...\n==> core-03: Setting the name of the VM: coreos-vagrant_core-03_1416954886820_7707\n==> core-03: Fixed port collision for 22 => 2222. Now on port 2201.\n==> core-03: Clearing any previously set network interfaces...\n==> core-03: Preparing network interfaces based on configuration...\n    core-03: Adapter 1: nat\n    core-03: Adapter 2: hostonly\n==> core-03: Forwarding ports...\n    core-03: 22 => 2201 (adapter 1)\n==> core-03: Running 'pre-boot' VM customizations...\n==> core-03: Booting VM...\n==> core-03: Waiting for machine to boot. This may take a few minutes...\n    core-03: SSH address: 127.0.0.1:2201\n    core-03: SSH username: core\n    core-03: SSH auth method: private key\n    core-03: Warning: Connection timeout. Retrying...\n==> core-03: Machine booted and ready!\n==> core-03: Setting hostname...\n==> core-03: Configuring and enabling network interfaces...\n==> core-03: Running provisioner: file...\n==> core-03: Running provisioner: shell...\n    core-03: Running: inline script```\n\nvagrant status\u3067\u78ba\u8a8d\n$ vagrant status\nCurrent machine states:\n\ncore-01                   running (virtualbox)\ncore-02                   running (virtualbox)\ncore-03                   running (virtualbox)\n\nThis environment represents multiple VMs. The VMs are all listed\nabove with their current state. For more information about a specific\nVM, run `vagrant status NAME`.\npochi:coreos-vagrant snumano$\n\n\u4f5c\u6210\u3057\u305f1\u53f0\u76ee\u306bssh\u3057\u3066fleet\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3002ok\n\u4ed6\u306e2\u53f0\u3092\u78ba\u8a8d\u3057\u3066\u3082\u5185\u5bb9\u306f\u540c\u3058\u3002\n$ vagrant ssh core-01\nCoreOS (alpha)\ncore@core-01 ~ $ fleetctl list-machines -l\nMACHINE                 IP      METADATA\n6562797c17224c35acb666f52bad25e0    172.17.8.102    -\n8bb4edab9b71401f9455ae2b0c63f6f1    172.17.8.103    -\nc595df046ef940d1b0a384225c4d528c    172.17.8.101    -\ncore@core-01 ~ $\n\n$ vagrant ssh core-02\nCoreOS (alpha)\ncore@core-02 ~ $ fleetctl list-machines -l\nMACHINE                 IP      METADATA\n6562797c17224c35acb666f52bad25e0    172.17.8.102    -\n8bb4edab9b71401f9455ae2b0c63f6f1    172.17.8.103    -\nc595df046ef940d1b0a384225c4d528c    172.17.8.101    -\ncore@core-02 ~ $\n\n$ vagrant ssh core-03\nCoreOS (alpha)\ncore@core-03 ~ $ fleetctl list-machines -l\nMACHINE                 IP      METADATA\n6562797c17224c35acb666f52bad25e0    172.17.8.102    -\n8bb4edab9b71401f9455ae2b0c63f6f1    172.17.8.103    -\nc595df046ef940d1b0a384225c4d528c    172.17.8.101    -\ncore@core-03 ~ $\n\n\u3053\u308c\u3067CoreOS\u30af\u30e9\u30b9\u30bf\u69cb\u7bc9\u5b8c\u4e86\n\nFleet\u3067deploy\n\nfleet \u3067 CoreOS + Vagrant \u306e Cluster \u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\n\n\u4e0a\u8a18\u3092\u53c2\u8003\u306b\u3001mac\u306bFleet\u3092install\u3002mac\u304b\u3089\u4e0b\u8a18\u306e\u3088\u3046\u306bfleetctl\u30b3\u30de\u30f3\u30c9\u3067CoreOS\u30af\u30e9\u30b9\u30bf\u3092\u78ba\u8a8d\u3002endpoint\u306f\u5148\u306b\u8a2d\u5b9a\u3057\u305fetcd\u306ediscovery\u3002\n$ cd <fleet dir>\n$ bin/fleetctl --endpoint 'http://172.17.8.101:4001' list-machines -l\nMACHINE                 IP      METADATA\n6562797c17224c35acb666f52bad25e0    172.17.8.102    -\n8bb4edab9b71401f9455ae2b0c63f6f1    172.17.8.103    -\nc595df046ef940d1b0a384225c4d528c    172.17.8.101    -\n\n\u5f8c\u306e\u624b\u9806\u3092\u3042\u308f\u305b\u308b\u305f\u3081\u306b\u3001\u74b0\u5883\u5909\u6570FLEETCTL_ENDPOINT\u3092\u8a2d\u5b9a\u3002\n$ export FLEETCTL_ENDPOINT=http://172.17.8.101:4001\n$ bin/fleetctl list-machines -l\nMACHINE                 IP      METADATA\n6562797c17224c35acb666f52bad25e0    172.17.8.102    -\n8bb4edab9b71401f9455ae2b0c63f6f1    172.17.8.103    -\nc595df046ef940d1b0a384225c4d528c    172.17.8.101    -\n\nunit\u306e\u8ffd\u52a0\u306f\u3001Qiita\u306e\u9806\u756a\u3067\u306f\u4e0a\u624b\u304f\u884c\u304b\u306a\u304b\u3063\u305f\u306e\u3067\u3001github\u3092\u53c2\u8003\u306b\u3057\u305f\u3002\n2\u53f0\u76ee(.102)\u306eCoreOS\u3067\u30b5\u30fc\u30d3\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n$ bin/fleetctl start examples/hello.service\nUnit hello.service launched on 2ae5a2c5.../172.17.8.101\n$ bin/fleetctl list-units\nUNIT        MACHINE             ACTIVE  SUB\nhello.service   2ae5a2c5.../172.17.8.101    active  running\n$ bin/fleetctl list-unit-files\nUNIT        HASH    DSTATE      STATE       TARGET\nhello.service   e55c0ae launched    launched    2ae5a2c5.../172.17.8.101\n\n\u3053\u3053\u306eRemote Fleet access\u306evagrant\u3092\u53c2\u8003\u306b\u3057\u305f\u3002\n$ vagrant ssh-config\nHost core-01\n  HostName 127.0.0.1\n  User core\n  Port 2222\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /Users/snumano/.vagrant.d/insecure_private_key\n  IdentitiesOnly yes\n  LogLevel FATAL\n\nHost core-02\n  HostName 127.0.0.1\n  User core\n  Port 2200\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /Users/snumano/.vagrant.d/insecure_private_key\n  IdentitiesOnly yes\n  LogLevel FATAL\n\nHost core-03\n  HostName 127.0.0.1\n  User core\n  Port 2201\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /Users/snumano/.vagrant.d/insecure_private_key\n  IdentitiesOnly yes\n  LogLevel FATAL\n\n$ vagrant ssh-config | sed -n \"s/IdentityFile//gp\" | xargs ssh-add\nIdentity added: /Users/snumano/.vagrant.d/insecure_private_key (/Users/snumano/.vagrant.d/insecure_private_key)\nIdentity added: /Users/snumano/.vagrant.d/insecure_private_key (/Users/snumano/.vagrant.d/insecure_private_key)\nIdentity added: /Users/snumano/.vagrant.d/insecure_private_key (/Users/snumano/.vagrant.d/insecure_private_key)\n$ export FLEETCTL_TUNNEL=\"$(vagrant ssh-config | sed -n \"s/[ ]*HostName[ ]*//gp\"):$(vagrant ssh-config | sed -n \"s/[ ]*Port[ ]*//gp\")\"\n$FLEETCTL_TUNNEL\n127.0.0.1 127.0.0.1 127.0.0.1:2222 2200 2201\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u78ba\u8a8d\u3002\n$ bin/fleetctl status hello.service\n\u25cf hello.service - Hello World\n   Loaded: loaded (/run/fleet/units/hello.service; linked-runtime)\n   Active: active (running) since Wed 2014-11-26 21:47:05 UTC; 3min 44s ago\n Main PID: 1335 (bash)\n   CGroup: /system.slice/hello.service\n           \u251c\u25001335 /bin/bash -c while true; do echo \"Hello, world\"; sleep 1; done\n           \u2514\u25001609 sleep 1\n\nNov 26 21:50:40 core-01 bash[1335]: Hello, world\nNov 26 21:50:41 core-01 bash[1335]: Hello, world\nNov 26 21:50:42 core-01 bash[1335]: Hello, world\nNov 26 21:50:43 core-01 bash[1335]: Hello, world\nNov 26 21:50:44 core-01 bash[1335]: Hello, world\nNov 26 21:50:45 core-01 bash[1335]: Hello, world\nNov 26 21:50:46 core-01 bash[1335]: Hello, world\nNov 26 21:50:47 core-01 bash[1335]: Hello, world\nNov 26 21:50:48 core-01 bash[1335]: Hello, world\nNov 26 21:50:49 core-01 bash[1335]: Hello, world\n\n\u30b5\u30fc\u30d3\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308bCoreOS\u306bssh\u63a5\u7d9a\u3002\ncore-01\u306b\u63a5\u7d9a\u3057\u3066\u3044\u308b\u4e8b\u304c\u308f\u304b\u308b\u3002\n$ bin/fleetctl list-unit-files\nUNIT        HASH    DSTATE      STATE       TARGET\nhello.service   e55c0ae launched    launched    2ae5a2c5.../172.17.8.101\n$ bin/fleetctl list-units\nUNIT        MACHINE             ACTIVE  SUB\nhello.service   2ae5a2c5.../172.17.8.101    active  running\n$ bin/fleetctl ssh hello.service\nLast login: Wed Nov 26 21:50:50 2014 from 172.17.8.1\nCoreOS (alpha)\ncore@core-01 ~ $\n\n\nfailover\u3092\u8a66\u3059\n\nfleet \u3067 CoreOS + Vagrant \u306e Cluster \u3067\u30d5\u30a7\u30a4\u30eb\u30aa\u30fc\u30d0\u30fc\u3092\u78ba\u8a8d\u3059\u308b\n\n\u4e0a\u8a18\u3092\u305d\u306e\u307e\u307e\u306b\u52d5\u4f5c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n$ bin/fleetctl list-machines -l\nMACHINE                 IP      METADATA\n2ae5a2c5f8d145a2a10a5b6ca44e5ac2    172.17.8.101    -\n5571847dfe604f56a241aedaef1fa134    172.17.8.102    -\n60c954604b86414888ba2051bdadfe1b    172.17.8.103    -\n$ bin/fleetctl list-unit-files\nUNIT        HASH    DSTATE      STATE       TARGET\nhello.service   e55c0ae launched    inactive    5571847d.../172.17.8.102\n$ bin/fleetctl list-units\nUNIT        MACHINE             ACTIVE  SUB\nhello.service   5571847d.../172.17.8.102    active  running\n\n\u5225\u306eterminal\u3067core-02\u3092\u505c\u6b62\n$ vagrant suspend core-02\n==> core-02: Saving VM state and suspending execution...\npochi:coreos-vagrant snumano$ vagrant status\nCurrent machine states:\n\ncore-01                   running (virtualbox)\ncore-02                   saved (virtualbox)\ncore-03                   running (virtualbox)```\n\ncore-02\u304c\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308b\u3002\u305f\u3060\u3057\u3001\u30b5\u30fc\u30d3\u30b9\u306fcore-01\u3067\u52d5\u4f5c\u3057\u3066\u3044\u308b\n$ bin/fleetctl list-machines -l\nMACHINE                 IP      METADATA\n2ae5a2c5f8d145a2a10a5b6ca44e5ac2    172.17.8.101    -\n60c954604b86414888ba2051bdadfe1b    172.17.8.103    -\n$ bin/fleetctl list-unit-files\nUNIT        HASH    DSTATE      STATE       TARGET\nhello.service   e55c0ae launched    launched    2ae5a2c5.../172.17.8.101\n$ bin/fleetctl list-units\nUNIT        MACHINE             ACTIVE  SUB\nhello.service   2ae5a2c5.../172.17.8.101    active  running\n$ bin/fleetctl status hello.service\n\u25cf hello.service - Hello World\n   Loaded: loaded (/run/fleet/units/hello.service; linked-runtime)\n   Active: active (running) since Wed 2014-11-26 21:55:55 UTC; 32s ago\n Main PID: 1925 (bash)\n   CGroup: /system.slice/hello.service\n           \u251c\u25001925 /bin/bash -c while true; do echo \"Hello, world\"; sleep 1; done\n           \u2514\u25001958 sleep 1\n\nNov 26 21:56:18 core-01 bash[1925]: Hello, world\nNov 26 21:56:19 core-01 bash[1925]: Hello, world\nNov 26 21:56:20 core-01 bash[1925]: Hello, world\nNov 26 21:56:21 core-01 bash[1925]: Hello, world\nNov 26 21:56:22 core-01 bash[1925]: Hello, world\nNov 26 21:56:23 core-01 bash[1925]: Hello, world\nNov 26 21:56:24 core-01 bash[1925]: Hello, world\nNov 26 21:56:25 core-01 bash[1925]: Hello, world\nNov 26 21:56:26 core-01 bash[1925]: Hello, world\nNov 26 21:56:27 core-01 bash[1925]: Hello, world\n\n\n\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\nvagrant\u3067\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30b9\u30bf\u3092vagrant destroy\u3067\u524a\u9664\u5f8c\u3001\u518d\u5ea6vagrant up\u3067\u4f5c\u6210\u3057\u305f\u5834\u5408\u3001fleet\u30b3\u30de\u30f3\u30c9\u304c\u6b63\u5e38\u52d5\u4f5c\u305b\u305a\u3001error\u3092\u51fa\u3057\u307e\u3057\u305f\u3002\n$ bin/fleetctl --endpoint 'http://172.17.8.101:4001' list-machines -l\n2014/11/26 23:49:22 INFO client.go:291: Failed getting response from http://172.17.8.101:4001/: dial tcp 172.17.8.101:4001: connection refused\n2014/11/26 23:49:22 ERROR client.go:213: Unable to get result for {Get /_coreos.com/fleet/machines}, retrying in 100ms\n2014/11/26 23:49:22 INFO client.go:291: Failed getting response from http://172.17.8.101:4001/: dial tcp 172.17.8.101:4001: connection refused\n2014/11/26 23:49:22 ERROR client.go:213: Unable to get result for {Get /_coreos.com/fleet/machines}, retrying in 200ms\n2014/11/26 23:49:22 INFO client.go:291: Failed getting response from http://172.17.8.101:4001/: dial tcp 172.17.8.101:4001: connection refused\n2014/11/26 23:49:22 ERROR client.go:213: Unable to get result for {Get /_coreos.com/fleet/machines}, retrying in 400ms\n2014/11/26 23:49:22 INFO client.go:291: Failed getting response from http://172.17.8.101:4001/: dial tcp 172.17.8.101:4001: connection refused\n2014/11/26 23:49:22 ERROR client.go:213: Unable to get result for {Get /_coreos.com/fleet/machines}, retrying in 800ms\n---snip---\n\n\u539f\u56e0\u306f\u4e0d\u660e\u3067\u3059\u304c\u3001etcd\u306edir\u306e\u4e2d\u306b\u4f5c\u6210\u3055\u308c\u3066\u3044\u305f.etcd\u3068\u3044\u3046dir\u3092\u524a\u9664\u3057\u3066\u6570\u5341\u79d2\u5f8c\u306b\u3001fleetctl\u304c\u6b63\u5e38\u52d5\u4f5c\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n$ pwd\n<hogehoge>/etcd-v0.4.6-darwin-amd64\n$ ls\nREADME-etcd.md      etcd            pochi.local.etcd\nREADME-etcdctl.md   etcdctl\n$ rm -fr pochi.local.etcd\n\n[CoreOS \u304c\u63d0\u4f9b\u3057\u3066\u304f\u308c\u308b\u3082\u306e](http://qiita.com/voluntas/items/1d5c1a6b6e7bce4abac4)\u304c\u8208\u5473\u6df1\u304b\u3063\u305f\u306e\u3067\u3001\u81ea\u5206\u306e\u74b0\u5883\u3067\u3001\u305d\u308c\u305e\u308c\u6700\u65b0\u306eversion\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n# \u74b0\u5883\n* Macosx 10.9.5\n* Vagrant 1.6.5\n* VirtualBox 4.3.20\n* Golang 1.3.3\n\n# \u74b0\u5883\u6e96\u5099\n## etcd\n![etcd\u69cb\u6210\u6982\u8981](https://coreos.com/assets/images/media/5-Machine-Cluster.png)\n\n* [CoreOS + Vagrant \u306b etcd \u3092\u4f7f\u3063\u3066\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b](http://qiita.com/voluntas/items/fb4174b4327c539e1fe7)\n* [v0.4.6 Getting Started](https://github.com/coreos/etcd/releases)\n\n\u4e0a\u8a18\u3092\u53c2\u8003\u306b\u3001etcd\u3092\u8d77\u52d5\u3002\n[github](https://github.com/coreos/etcd)\u306b`It is strongly recommended that users work with the latest 0.4.x release (0.4.6)`\u3068\u3042\u308b\u306e\u3067\u3001\u6700\u65b0\u306e0.5\u306f\u907f\u3051\u3066\u30010.4.6\u3092\u4f7f\u7528\u3002\netcd\u306eoption\u306f`etcd --help`\u3067\u78ba\u8a8d\u3059\u308b\u3068\u3001Qiita\u306e\u60c5\u5831\u3068\u306f\u5909\u308f\u3063\u3066\u3044\u305f\u3002`-addr=`\u3067\u6307\u5b9a\u3059\u308baddress\u306f`172.17.8.1`\u3092\u4f7f\u7528\u3002\u5f8c\u3067\u3001vagrant\u3067CoreOS\u8d77\u52d5\u3057\u305f\u3089vboxnet5\u3068\u3057\u3066\u3053\u306eaddress\u304c\u4f7f\u308f\u308c\u3066\u3044\u305f\u306e\u3067\u3002\n\n```mac\n$ curl -L  https://github.com/coreos/etcd/releases/download/v0.4.6/etcd-v0.4.6-darwin-amd64.zip -o etcd-v 0.4.6-darwin-amd64.zip.\n$ unzip etcd-v0.4.6-darwin-amd64.zip.\n$ cd etcd-v0.4.6-darwin-amd64\nochi:etcd-v0.4.6-darwin-amd64\n$ pochi:etcd-v0.4.6-darwin-amd64\n$ ./etcd -addr=172.17.8.1:4001 -v\n[etcd] Nov 26 07:09:58.687 WARNING   | Using the directory pochi.local.etcd as the etcd curation directory because a directory was not specified.\n[etcd] Nov 26 07:09:58.690 DEBUG     | pochi.local finished load snapshot\n[etcd] Nov 26 07:09:58.698 DEBUG     | URLs: /_etcd/machines:  / pochi.local (http://127.0.0.1:7001)\n[etcd] Nov 26 07:09:58.698 INFO      | Peer URLs in log:  / pochi.local (http://127.0.0.1:7001)\n[etcd] Nov 26 07:09:58.699 DEBUG     | pochi.local is restarting the cluster []\n[etcd] Nov 26 07:09:58.700 INFO      | etcd server [name pochi.local, listen on :4001, advertised url http://172.17.8.1:4001]\n[etcd] Nov 26 07:09:58.700 INFO      | peer server [name pochi.local, listen on :7001, advertised url http://127.0.0.1:7001]\n[etcd] Nov 26 07:09:58.700 INFO      | pochi.local starting in peer mode\n[etcd] Nov 26 07:09:58.700 INFO      | pochi.local: state changed from 'initialized' to 'follower'.\n[etcd] Nov 26 07:09:58.933 INFO      | pochi.local: state changed from 'follower' to 'candidate'.\n[etcd] Nov 26 07:09:58.933 INFO      | pochi.local: state changed from 'candidate' to 'leader'.\n[etcd] Nov 26 07:09:58.933 INFO      | pochi.local: leader changed from '' to 'pochi.local'.\n[etcd] Nov 26 07:09:59.701 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n[etcd] Nov 26 07:10:00.703 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n[etcd] Nov 26 07:10:01.700 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n[etcd] Nov 26 07:10:01.704 INFO      | pochi.local: snapshot of 18908 events at index 18908 completed\n[etcd] Nov 26 07:10:02.701 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n[etcd] Nov 26 07:10:03.701 DEBUG     | URLs: /_etcd/machines:  /  (pochi.local)\n```\n\n```mac\u5225\u30bf\u30fc\u30df\u30ca\u30eb\n$ curl http://172.17.8.1:4001/version\netcd 0.4.6\n```\n\n## CoreOS Vagrant\n* [CoreOS + Vagrant \u306b etcd \u3092\u4f7f\u3063\u3066\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b](http://qiita.com/voluntas/items/fb4174b4327c539e1fe7)\n* [CoreOS Vagrant](https://github.com/coreos/coreos-vagrant)\n\n\u4e45\u3057\u3076\u308a\u306bvagrant\u3055\u308f\u3063\u305f\u3089\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u304c1.3.x\u304b\u30891.6.x\u306b\u306a\u3063\u3066\u305f\u3002\u5f53\u7136\u306e\u3088\u3046\u306b\u3001error\u304c\u3067\u308b\u306e\u3067\u3001\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3001`rm -r ~/.vagrant.d/plugins.json ~/.vagrant.d/gems`\u3092\u5b9f\u884c\u3002\n\n\n\n\u305d\u3057\u3066`cp user-data.sample user-data`\u3057\u3066\u3001user-data\u306ediscovery\u884c\u3092\u7de8\u96c6\u3002\u5143\u306esample\u306fhttps\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3054\u6ce8\u610f\u3002\n\n```user-data\n#cloud-config\n\ncoreos:\n  etcd:\n    # generate a new token for each unique cluster from https://discovery.etcd.io/new\n    # WARNING: replace each time you 'vagrant destroy'\n    discovery: http://172.17.8.1:4001/v2/keys/machines\n    addr: $public_ipv4:4001\n    peer-addr: $public_ipv4:7001\n  fleet:\n    public-ip: $public_ipv4\n  units:\n    - name: etcd.service\n      command: start\n    - name: fleet.service\n      command: start\n    - name: docker-tcp.socket\n      command: start\n      enable: true\n      content: |\n        [Unit]\n        Description=Docker Socket for the API\n\n        [Socket]\n        ListenStream=2375\n        Service=docker.service\n        BindIPv6Only=both\n\n        [Install]\n        WantedBy=sockets.target\n```\n\n\n\n\u7121\u4e8bvagrant up\u3067\u304d\u305f\n\n[Vagrant\u30921.3.5\u304b\u30891.6.3\u306b\u4e0a\u3052\u305f\u3088\uff08Vagrant Cloud\u3092\u4f7f\u3046\u3088\u3046\u306b\u306a\u3063\u305f\uff09](http://blog.pg1x.com/entry/2014/07/15/224633)\n\n\n```mac\n$ vagrant up\nBringing machine 'core-01' up with 'virtualbox' provider...\nBringing machine 'core-02' up with 'virtualbox' provider...\nBringing machine 'core-03' up with 'virtualbox' provider...\n==> core-01: Importing base box 'coreos-alpha'...\n==> core-01: Matching MAC address for NAT networking...\n==> core-01: Checking if box 'coreos-alpha' is up to date...\n==> core-01: Setting the name of the VM: coreos-vagrant_core-01_1416954842606_17056\n==> core-01: Clearing any previously set network interfaces...\n==> core-01: Preparing network interfaces based on configuration...\n    core-01: Adapter 1: nat\n    core-01: Adapter 2: hostonly\n==> core-01: Forwarding ports...\n    core-01: 22 => 2222 (adapter 1)\n==> core-01: Running 'pre-boot' VM customizations...\n==> core-01: Booting VM...\n==> core-01: Waiting for machine to boot. This may take a few minutes...\n    core-01: SSH address: 127.0.0.1:2222\n    core-01: SSH username: core\n    core-01: SSH auth method: private key\n    core-01: Warning: Connection timeout. Retrying...\n==> core-01: Machine booted and ready!\n==> core-01: Setting hostname...\n==> core-01: Configuring and enabling network interfaces...\n==> core-01: Running provisioner: file...\n==> core-01: Running provisioner: shell...\n    core-01: Running: inline script\n==> core-02: Importing base box 'coreos-alpha'...\n==> core-02: Matching MAC address for NAT networking...\n==> core-02: Checking if box 'coreos-alpha' is up to date...\n==> core-02: Setting the name of the VM: coreos-vagrant_core-02_1416954865219_3677\n==> core-02: Fixed port collision for 22 => 2222. Now on port 2200.\n==> core-02: Clearing any previously set network interfaces...\n==> core-02: Preparing network interfaces based on configuration...\n    core-02: Adapter 1: nat\n    core-02: Adapter 2: hostonly\n==> core-02: Forwarding ports...\n    core-02: 22 => 2200 (adapter 1)\n==> core-02: Running 'pre-boot' VM customizations...\n==> core-02: Booting VM...\n==> core-02: Waiting for machine to boot. This may take a few minutes...\n    core-02: SSH address: 127.0.0.1:2200\n    core-02: SSH username: core\n    core-02: SSH auth method: private key\n    core-02: Warning: Connection timeout. Retrying...\n==> core-02: Machine booted and ready!\n==> core-02: Setting hostname...\n==> core-02: Configuring and enabling network interfaces...\n==> core-02: Running provisioner: file...\n==> core-02: Running provisioner: shell...\n    core-02: Running: inline script\n==> core-03: Importing base box 'coreos-alpha'...\n==> core-03: Matching MAC address for NAT networking...\n==> core-03: Checking if box 'coreos-alpha' is up to date...\n==> core-03: Setting the name of the VM: coreos-vagrant_core-03_1416954886820_7707\n==> core-03: Fixed port collision for 22 => 2222. Now on port 2201.\n==> core-03: Clearing any previously set network interfaces...\n==> core-03: Preparing network interfaces based on configuration...\n    core-03: Adapter 1: nat\n    core-03: Adapter 2: hostonly\n==> core-03: Forwarding ports...\n    core-03: 22 => 2201 (adapter 1)\n==> core-03: Running 'pre-boot' VM customizations...\n==> core-03: Booting VM...\n==> core-03: Waiting for machine to boot. This may take a few minutes...\n    core-03: SSH address: 127.0.0.1:2201\n    core-03: SSH username: core\n    core-03: SSH auth method: private key\n    core-03: Warning: Connection timeout. Retrying...\n==> core-03: Machine booted and ready!\n==> core-03: Setting hostname...\n==> core-03: Configuring and enabling network interfaces...\n==> core-03: Running provisioner: file...\n==> core-03: Running provisioner: shell...\n    core-03: Running: inline script```\n```\n\n`vagrant status`\u3067\u78ba\u8a8d\n\n```mac\n$ vagrant status\nCurrent machine states:\n\ncore-01                   running (virtualbox)\ncore-02                   running (virtualbox)\ncore-03                   running (virtualbox)\n\nThis environment represents multiple VMs. The VMs are all listed\nabove with their current state. For more information about a specific\nVM, run `vagrant status NAME`.\npochi:coreos-vagrant snumano$\n```\n\n\u4f5c\u6210\u3057\u305f1\u53f0\u76ee\u306bssh\u3057\u3066fleet\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3002ok\n\u4ed6\u306e2\u53f0\u3092\u78ba\u8a8d\u3057\u3066\u3082\u5185\u5bb9\u306f\u540c\u3058\u3002\n\n```mac\u304b\u3089core-01\u306bssh\n$ vagrant ssh core-01\nCoreOS (alpha)\ncore@core-01 ~ $ fleetctl list-machines -l\nMACHINE\t\t\t\t\tIP\t\tMETADATA\n6562797c17224c35acb666f52bad25e0\t172.17.8.102\t-\n8bb4edab9b71401f9455ae2b0c63f6f1\t172.17.8.103\t-\nc595df046ef940d1b0a384225c4d528c\t172.17.8.101\t-\ncore@core-01 ~ $\n```\n\n```mac\u304b\u3089core-02\u306bssh\n$ vagrant ssh core-02\nCoreOS (alpha)\ncore@core-02 ~ $ fleetctl list-machines -l\nMACHINE\t\t\t\t\tIP\t\tMETADATA\n6562797c17224c35acb666f52bad25e0\t172.17.8.102\t-\n8bb4edab9b71401f9455ae2b0c63f6f1\t172.17.8.103\t-\nc595df046ef940d1b0a384225c4d528c\t172.17.8.101\t-\ncore@core-02 ~ $\n```\n\n```mac\u304b\u3089core-03\u306bssh\n$ vagrant ssh core-03\nCoreOS (alpha)\ncore@core-03 ~ $ fleetctl list-machines -l\nMACHINE\t\t\t\t\tIP\t\tMETADATA\n6562797c17224c35acb666f52bad25e0\t172.17.8.102\t-\n8bb4edab9b71401f9455ae2b0c63f6f1\t172.17.8.103\t-\nc595df046ef940d1b0a384225c4d528c\t172.17.8.101\t-\ncore@core-03 ~ $\n```\n\n\u3053\u308c\u3067CoreOS\u30af\u30e9\u30b9\u30bf\u69cb\u7bc9\u5b8c\u4e86\n\n#Fleet\u3067deploy\n* [fleet \u3067 CoreOS + Vagrant \u306e Cluster \u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b](http://qiita.com/voluntas/items/fc5b992fc3a579029566)\n\n\n\u4e0a\u8a18\u3092\u53c2\u8003\u306b\u3001mac\u306bFleet\u3092install\u3002mac\u304b\u3089\u4e0b\u8a18\u306e\u3088\u3046\u306bfleetctl\u30b3\u30de\u30f3\u30c9\u3067CoreOS\u30af\u30e9\u30b9\u30bf\u3092\u78ba\u8a8d\u3002endpoint\u306f\u5148\u306b\u8a2d\u5b9a\u3057\u305fetcd\u306ediscovery\u3002\n\n```mac\n$ cd <fleet dir>\n$ bin/fleetctl --endpoint 'http://172.17.8.101:4001' list-machines -l\nMACHINE\t\t\t\t\tIP\t\tMETADATA\n6562797c17224c35acb666f52bad25e0\t172.17.8.102\t-\n8bb4edab9b71401f9455ae2b0c63f6f1\t172.17.8.103\t-\nc595df046ef940d1b0a384225c4d528c\t172.17.8.101\t-\n```\n\n\u5f8c\u306e\u624b\u9806\u3092\u3042\u308f\u305b\u308b\u305f\u3081\u306b\u3001\u74b0\u5883\u5909\u6570FLEETCTL_ENDPOINT\u3092\u8a2d\u5b9a\u3002\n\n```mac\n$ export FLEETCTL_ENDPOINT=http://172.17.8.101:4001\n$ bin/fleetctl list-machines -l\nMACHINE\t\t\t\t\tIP\t\tMETADATA\n6562797c17224c35acb666f52bad25e0\t172.17.8.102\t-\n8bb4edab9b71401f9455ae2b0c63f6f1\t172.17.8.103\t-\nc595df046ef940d1b0a384225c4d528c\t172.17.8.101\t-\n```\n\nunit\u306e\u8ffd\u52a0\u306f\u3001Qiita\u306e\u9806\u756a\u3067\u306f\u4e0a\u624b\u304f\u884c\u304b\u306a\u304b\u3063\u305f\u306e\u3067\u3001[github](https://github.com/coreos/fleet)\u3092\u53c2\u8003\u306b\u3057\u305f\u3002\n2\u53f0\u76ee(.102)\u306eCoreOS\u3067\u30b5\u30fc\u30d3\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n```mac\n$ bin/fleetctl start examples/hello.service\nUnit hello.service launched on 2ae5a2c5.../172.17.8.101\n$ bin/fleetctl list-units\nUNIT\t\tMACHINE\t\t\t\tACTIVE\tSUB\nhello.service\t2ae5a2c5.../172.17.8.101\tactive\trunning\n$ bin/fleetctl list-unit-files\nUNIT\t\tHASH\tDSTATE\t\tSTATE\t\tTARGET\nhello.service\te55c0ae\tlaunched\tlaunched\t2ae5a2c5.../172.17.8.101\n```\n\n[\u3053\u3053](https://github.com/coreos/fleet/blob/master/Documentation/using-the-client.md)\u306eRemote Fleet access\u306evagrant\u3092\u53c2\u8003\u306b\u3057\u305f\u3002\n\n```mac\n$ vagrant ssh-config\nHost core-01\n  HostName 127.0.0.1\n  User core\n  Port 2222\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /Users/snumano/.vagrant.d/insecure_private_key\n  IdentitiesOnly yes\n  LogLevel FATAL\n\nHost core-02\n  HostName 127.0.0.1\n  User core\n  Port 2200\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /Users/snumano/.vagrant.d/insecure_private_key\n  IdentitiesOnly yes\n  LogLevel FATAL\n\nHost core-03\n  HostName 127.0.0.1\n  User core\n  Port 2201\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /Users/snumano/.vagrant.d/insecure_private_key\n  IdentitiesOnly yes\n  LogLevel FATAL\n\n$ vagrant ssh-config | sed -n \"s/IdentityFile//gp\" | xargs ssh-add\nIdentity added: /Users/snumano/.vagrant.d/insecure_private_key (/Users/snumano/.vagrant.d/insecure_private_key)\nIdentity added: /Users/snumano/.vagrant.d/insecure_private_key (/Users/snumano/.vagrant.d/insecure_private_key)\nIdentity added: /Users/snumano/.vagrant.d/insecure_private_key (/Users/snumano/.vagrant.d/insecure_private_key)\n$ export FLEETCTL_TUNNEL=\"$(vagrant ssh-config | sed -n \"s/[ ]*HostName[ ]*//gp\"):$(vagrant ssh-config | sed -n \"s/[ ]*Port[ ]*//gp\")\"\n$FLEETCTL_TUNNEL\n127.0.0.1 127.0.0.1 127.0.0.1:2222 2200 2201\n```\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u78ba\u8a8d\u3002\n\n```mac\n$ bin/fleetctl status hello.service\n\u25cf hello.service - Hello World\n   Loaded: loaded (/run/fleet/units/hello.service; linked-runtime)\n   Active: active (running) since Wed 2014-11-26 21:47:05 UTC; 3min 44s ago\n Main PID: 1335 (bash)\n   CGroup: /system.slice/hello.service\n           \u251c\u25001335 /bin/bash -c while true; do echo \"Hello, world\"; sleep 1; done\n           \u2514\u25001609 sleep 1\n\nNov 26 21:50:40 core-01 bash[1335]: Hello, world\nNov 26 21:50:41 core-01 bash[1335]: Hello, world\nNov 26 21:50:42 core-01 bash[1335]: Hello, world\nNov 26 21:50:43 core-01 bash[1335]: Hello, world\nNov 26 21:50:44 core-01 bash[1335]: Hello, world\nNov 26 21:50:45 core-01 bash[1335]: Hello, world\nNov 26 21:50:46 core-01 bash[1335]: Hello, world\nNov 26 21:50:47 core-01 bash[1335]: Hello, world\nNov 26 21:50:48 core-01 bash[1335]: Hello, world\nNov 26 21:50:49 core-01 bash[1335]: Hello, world\n```\n\n\u30b5\u30fc\u30d3\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308bCoreOS\u306bssh\u63a5\u7d9a\u3002\ncore-01\u306b\u63a5\u7d9a\u3057\u3066\u3044\u308b\u4e8b\u304c\u308f\u304b\u308b\u3002\n\n```mac\n$ bin/fleetctl list-unit-files\nUNIT\t\tHASH\tDSTATE\t\tSTATE\t\tTARGET\nhello.service\te55c0ae\tlaunched\tlaunched\t2ae5a2c5.../172.17.8.101\n$ bin/fleetctl list-units\nUNIT\t\tMACHINE\t\t\t\tACTIVE\tSUB\nhello.service\t2ae5a2c5.../172.17.8.101\tactive\trunning\n$ bin/fleetctl ssh hello.service\nLast login: Wed Nov 26 21:50:50 2014 from 172.17.8.1\nCoreOS (alpha)\ncore@core-01 ~ $\n```\n\n# failover\u3092\u8a66\u3059\n* [fleet \u3067 CoreOS + Vagrant \u306e Cluster \u3067\u30d5\u30a7\u30a4\u30eb\u30aa\u30fc\u30d0\u30fc\u3092\u78ba\u8a8d\u3059\u308b](http://qiita.com/voluntas/items/5d23bcc756c7b58168d0)\n\n\u4e0a\u8a18\u3092\u305d\u306e\u307e\u307e\u306b\u52d5\u4f5c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n```mac\n$ bin/fleetctl list-machines -l\nMACHINE\t\t\t\t\tIP\t\tMETADATA\n2ae5a2c5f8d145a2a10a5b6ca44e5ac2\t172.17.8.101\t-\n5571847dfe604f56a241aedaef1fa134\t172.17.8.102\t-\n60c954604b86414888ba2051bdadfe1b\t172.17.8.103\t-\n$ bin/fleetctl list-unit-files\nUNIT\t\tHASH\tDSTATE\t\tSTATE\t\tTARGET\nhello.service\te55c0ae\tlaunched\tinactive\t5571847d.../172.17.8.102\n$ bin/fleetctl list-units\nUNIT\t\tMACHINE\t\t\t\tACTIVE\tSUB\nhello.service\t5571847d.../172.17.8.102\tactive\trunning\n```\n\n\u5225\u306eterminal\u3067core-02\u3092\u505c\u6b62\n\n```mac\u5225terminal\n$ vagrant suspend core-02\n==> core-02: Saving VM state and suspending execution...\npochi:coreos-vagrant snumano$ vagrant status\nCurrent machine states:\n\ncore-01                   running (virtualbox)\ncore-02                   saved (virtualbox)\ncore-03                   running (virtualbox)```\n```\n\ncore-02\u304c\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308b\u3002\u305f\u3060\u3057\u3001\u30b5\u30fc\u30d3\u30b9\u306fcore-01\u3067\u52d5\u4f5c\u3057\u3066\u3044\u308b\n\n```mac\n$ bin/fleetctl list-machines -l\nMACHINE\t\t\t\t\tIP\t\tMETADATA\n2ae5a2c5f8d145a2a10a5b6ca44e5ac2\t172.17.8.101\t-\n60c954604b86414888ba2051bdadfe1b\t172.17.8.103\t-\n$ bin/fleetctl list-unit-files\nUNIT\t\tHASH\tDSTATE\t\tSTATE\t\tTARGET\nhello.service\te55c0ae\tlaunched\tlaunched\t2ae5a2c5.../172.17.8.101\n$ bin/fleetctl list-units\nUNIT\t\tMACHINE\t\t\t\tACTIVE\tSUB\nhello.service\t2ae5a2c5.../172.17.8.101\tactive\trunning\n$ bin/fleetctl status hello.service\n\u25cf hello.service - Hello World\n   Loaded: loaded (/run/fleet/units/hello.service; linked-runtime)\n   Active: active (running) since Wed 2014-11-26 21:55:55 UTC; 32s ago\n Main PID: 1925 (bash)\n   CGroup: /system.slice/hello.service\n           \u251c\u25001925 /bin/bash -c while true; do echo \"Hello, world\"; sleep 1; done\n           \u2514\u25001958 sleep 1\n\nNov 26 21:56:18 core-01 bash[1925]: Hello, world\nNov 26 21:56:19 core-01 bash[1925]: Hello, world\nNov 26 21:56:20 core-01 bash[1925]: Hello, world\nNov 26 21:56:21 core-01 bash[1925]: Hello, world\nNov 26 21:56:22 core-01 bash[1925]: Hello, world\nNov 26 21:56:23 core-01 bash[1925]: Hello, world\nNov 26 21:56:24 core-01 bash[1925]: Hello, world\nNov 26 21:56:25 core-01 bash[1925]: Hello, world\nNov 26 21:56:26 core-01 bash[1925]: Hello, world\nNov 26 21:56:27 core-01 bash[1925]: Hello, world\n```\n\n# \u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\n\nvagrant\u3067\u4f5c\u6210\u3057\u305f\u30af\u30e9\u30b9\u30bf\u3092`vagrant destroy`\u3067\u524a\u9664\u5f8c\u3001\u518d\u5ea6`vagrant up`\u3067\u4f5c\u6210\u3057\u305f\u5834\u5408\u3001fleet\u30b3\u30de\u30f3\u30c9\u304c\u6b63\u5e38\u52d5\u4f5c\u305b\u305a\u3001error\u3092\u51fa\u3057\u307e\u3057\u305f\u3002\n\n```error\n$ bin/fleetctl --endpoint 'http://172.17.8.101:4001' list-machines -l\n2014/11/26 23:49:22 INFO client.go:291: Failed getting response from http://172.17.8.101:4001/: dial tcp 172.17.8.101:4001: connection refused\n2014/11/26 23:49:22 ERROR client.go:213: Unable to get result for {Get /_coreos.com/fleet/machines}, retrying in 100ms\n2014/11/26 23:49:22 INFO client.go:291: Failed getting response from http://172.17.8.101:4001/: dial tcp 172.17.8.101:4001: connection refused\n2014/11/26 23:49:22 ERROR client.go:213: Unable to get result for {Get /_coreos.com/fleet/machines}, retrying in 200ms\n2014/11/26 23:49:22 INFO client.go:291: Failed getting response from http://172.17.8.101:4001/: dial tcp 172.17.8.101:4001: connection refused\n2014/11/26 23:49:22 ERROR client.go:213: Unable to get result for {Get /_coreos.com/fleet/machines}, retrying in 400ms\n2014/11/26 23:49:22 INFO client.go:291: Failed getting response from http://172.17.8.101:4001/: dial tcp 172.17.8.101:4001: connection refused\n2014/11/26 23:49:22 ERROR client.go:213: Unable to get result for {Get /_coreos.com/fleet/machines}, retrying in 800ms\n---snip---\n```\n\n\u539f\u56e0\u306f\u4e0d\u660e\u3067\u3059\u304c\u3001etcd\u306edir\u306e\u4e2d\u306b\u4f5c\u6210\u3055\u308c\u3066\u3044\u305f<hoge>.etcd\u3068\u3044\u3046dir\u3092\u524a\u9664\u3057\u3066\u6570\u5341\u79d2\u5f8c\u306b\u3001fleetctl\u304c\u6b63\u5e38\u52d5\u4f5c\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n```\n$ pwd\n<hogehoge>/etcd-v0.4.6-darwin-amd64\n$ ls\nREADME-etcd.md\t\tetcd\t\t\tpochi.local.etcd\nREADME-etcdctl.md\tetcdctl\n$ rm -fr pochi.local.etcd\n```\n\n", "tags": ["CoreOS"]}