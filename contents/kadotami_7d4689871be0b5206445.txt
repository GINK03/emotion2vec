{"context": "\n\n\u3084\u3063\u305f\u3053\u3068\nDjango(rest framework)\u3068js\u306eSPA\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u7528\u3044\u305fweb\u30a2\u30d7\u30ea\u306b\u304a\u3044\u3066s3\u306b\u753b\u50cf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u6848\u4ef6\u3092\u53d7\u3051\u308b\u306b\u3042\u305f\u308a\u3001signature\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u3001python3\u306e\u8a18\u4e8b\u304c\u51fa\u3066\u3053\u306a\u304b\u3063\u305f\u6c17\u304c\u3057\u305f\u306e\u3067\u5099\u5fd8\u9332\u3068\u3057\u3066\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\npython2\u306f\u3053\u3061\u3089\u306b\u3042\u308b\u306e\u3067\u3059\u304c\u306a\u304b\u306a\u304b\u624b\u9593\u53d6\u3063\u305f\u306e\u3067\u3001\u3001\u3001\n\u3053\u3093\u306a\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u8aad\u3081\u3070\u5206\u304b\u308b\u3060\u308d\uff01\u3063\u3066\u591a\u304f\u306e\u4eba\u306f\u601d\u3046\u304b\u3082\u3057\u308c\u306a\u3044\u3067\u3059\u304c\u3001\u50d5\u307f\u305f\u3044\u306a\u30b3\u30d4\u30da\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3\u30a8\u30f3\u30b8\u30cb\u30a2\u306f\u3053\u3046\u3044\u3046\u306e\u3042\u308b\u3068\u52a9\u304b\u308b\u3068\u601d\u3046\u306e\u3067\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u4ed5\u7d44\u307f\n\u3053\u306e\u8fba\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3068\u304b\u8cc7\u6599\u3068\u304b\u591a\u3044\u306e\u3067\u3059\u304c\u3001\u4e00\u5fdc\n\u666e\u901a\u306fhttp\u306eAuthorization header\u306b\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3001\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u306a\u3069\u304b\u3089\u6697\u53f7\u5316\u95a2\u6570\u3092\u4f7f\u3063\u3066\u4f5c\u6210\u3057\u305f\u7f72\u540d\u6587\u5b57\u5217\u3092\u4ed8\u4e0e\u3057\u3066\u9001\u4fe1\u3057\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u6848\u4ef6\u3060\u3063\u305f\u306e\u3067JS\u306b\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3068\u304b\u8a18\u8f09\u3059\u308b\u308f\u3051\u306b\u306f\u3044\u304d\u307e\u305b\u3093\u3002\n\u3057\u305f\u304c\u3063\u3066\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u7f72\u540d\u6587\u5b57\u5217\u3092\u4f5c\u6210\u3057\u3001\u305d\u308c\u3092\u30d5\u30ed\u30f3\u30c8\u5074\u306b\u8fd4\u3057\u3066\u305d\u308c\u3092\u7528\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306e\u6d41\u308c\u3068\u3057\u3066\u306f\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5148\u306e\u30d1\u30b9\u3092\u30d5\u30ed\u30f3\u30c8\u5074\u3067\u6307\u5b9a\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306b\u7f72\u540d\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\n\u2193\n\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u6697\u53f7\u5316\u95a2\u6570\u3092\u7528\u3044\u3066\u7f72\u540d\u6587\u5b57\u5217\u3092\u4f5c\u6210\u3057\u3001\u8fd4\u3059\n\u2193\n\u30d5\u30ed\u30f3\u30c8\u5074\u3067\u7f72\u540d\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001formData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u9001\u4fe1\u3059\u308b\u3002\n\ns3\u306e\u8a2d\u5b9a\n\u72ec\u81ea\u30b5\u30fc\u30d3\u30b9\u306e\u30d5\u30ed\u30f3\u30c8\u304b\u3089\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3068\u3044\u3046\u3053\u3068\u3067\u30af\u30ed\u30b9\u30aa\u30ea\u30b8\u30f3\u306f\u8a2d\u5b9a\u3057\u306a\u3044\u884c\u3051\u307e\u305b\u3093\u3002\n\u53cd\u6620\u306b\u3082\u7d50\u69cb\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u4e00\u756a\u6700\u521d\u306b\u3053\u308c\u3092\u3084\u3063\u3066\u304a\u304f\u3053\u3068\u3092\u30aa\u30b9\u30b9\u30e1\u3057\u307e\u3059\u3002\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3061\u3083\u3093\u3068\u3057\u305f\u3044\u3068\u304d\u306fAllowedOrigin\u306b\u3061\u3083\u3093\u3068\u3057\u305f\u30c9\u30e1\u30a4\u30f3\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\nbacket\u3092\u9078\u629e\u3057\u3066\u53f3\u5074\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u2192\u30a2\u30af\u30bb\u30b9\u8a31\u53ef\u2192CORS\u306e\u8a2d\u5b9a\u304b\u3089\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<CORSConfiguration xmlns=\"http://s3.amazonaws.com/doc/2006-03-01/\">\n    <CORSRule>\n        <AllowedOrigin>*</AllowedOrigin>\n        <AllowedMethod>GET</AllowedMethod>\n        <AllowedMethod>POST</AllowedMethod>\n        <AllowedMethod>PUT</AllowedMethod>\n        <MaxAgeSeconds>3000</MaxAgeSeconds>\n        <AllowedHeader>*</AllowedHeader>\n    </CORSRule>\n</CORSConfiguration>\n\n\n\u5b9f\u88c5\nurls.py\u306b\u306f\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3044URL\u3092\u8a18\u8f09\u3057\u3066\u304a\u3044\u3066\u4e0b\u3055\u3044\u3002\n\nsettings.py\nS3_ACCESS_KEY = 'AAAAAAAAAAAAAAAA'\nS3_SECRET_KEY = 'hogehugapiyo'\nS3_BUCKET_NAME = \"s3_bucket_name\"\n\n\n\u3053\u306e\u3088\u3046\u306bsettings\u306b\u66f8\u3044\u3066\u304a\u304f\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\nview.py\nfrom rest_framework import status\nfrom rest_framework.renderers import JSONRenderer\nfrom rest_framework.response import Response\nfrom rest_framework.views import APIView\nfrom django.conf import settings\nimport base64, hmac, hashlib\nfrom datetime import datetime, timedelta\n\nclass View(APIView):\n\n    POLICY = ''\\\n        '{\"expiration\": \"%s\",'\\\n        '  \"conditions\": ['\\\n        '    {\"acl\": \"public-read\"},'\\\n        '    {\"bucket\": \"%s\"},'\\\n        '    {\"key\": \"%s\"},'\\\n        '    [\"content-length-range\", 0,MAX_LENGTH]'\\  #\u3053\u3053\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\n        '  ]'\\\n        '}'\\\n\n    def get(self, request):\n        s = (self.POLICY % ((datetime.now() + timedelta(minutes=3)).strftime(\"%Y-%m-%dT%H:%M:%S.000Z\"), settings.s3_BUCKET_NAME, request.query_params['upload_path'])).replace(\"\\n\", \"\").encode('ascii')\n        private_key = settings.S3_SECRET_KEY\n        policy = base64.b64encode(s)\n        signature = base64.b64encode(hmac.new(private_key.encode('ascii'), policy, hashlib.sha1).digest())\n        access_key = settings.S3_ACCESS_KEY\n        data = {\n            \"policy\": policy.decode('ascii'),\n            \"signature\": signature.decode('ascii'),\n            \"access_key\": access_key\n        }\n        return Response(data, status=200)\n\n\n\u4eca\u56de\u306fpath\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u304b\u3089\u53d6\u3063\u3066\u304f\u308b\u3068\u3044\u3046\u3053\u3068\u3067request.query_params['upload_path']\u306b\u3057\u3066\u3044\u307e\u3059\u3002\u9055\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4f7f\u3044\u305f\u3051\u308c\u3070\u3054\u81ea\u7531\u306b\u3002\n\u307e\u305f\u3001\u4e00\u5fdc3\u5206\u3067\u3053\u306e\u7f72\u540d\u6587\u5b57\u5217\u306f\u5931\u52b9\u3059\u308b\u3088\u3046\u306b\u66f8\u3044\u3066\u3044\u307e\u3059\u3001\u3067\u3082\u3082\u3063\u3068\u77ed\u304f\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3002\u3002\u3002\n\u30c1\u30e7\u30c3\u30c8\u30cf\u30de\u3063\u305f\u3068\u3053\u308d\u304c\nascii\u306bencode\u3057\u305f\u5f8c\u306b\u305d\u306e\u307e\u307ejson\u3067\u8fd4\u5374\u3057\u3088\u3046\u3068\u3057\u305f\u3068\u3053\u308d\n\ntypeerror the json object must be str not 'bytes' \n\n\u3067\u8fd4\u305b\u306a\u304b\u3063\u305f\u306e\u3067decode\u3057\u3066\u8fd4\u3057\u3066\u3044\u307e\u3059\u3002\n\u3042\u3068\u306fjs\u306eformData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3053\u3093\u306a\u611f\u3058\u3067\u4f5c\u6210\n\nupload.js\n\u4f55\u304b\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\uff08jquery\u3067\u3082superagent\u3067\u3082\uff09.get(django_url, {upload_path:\"path/path.jpg\"}, function(success) {\n  formdata = new FormData();\n  formdata.append(\"acl\", \"public-read\");\n  formdata.append(\"key\", path);\n  formdata.append(\"AWSAccessKeyId\", success.access_key);\n  formdata.append(\"policy\", success.policy);\n  formdata.append(\"signature\", success.signature);\n  formdata.append(\"file\", blob);\n  library.post(s3_url ,formdata, function(){\n    console.log(\"\u308f\u30fc\u3044\uff3c(^o^)\uff0f\");\n  })\n});\n\n\njs\u306f\u96d1\u3067\u3059\u304c\u610f\u56f3\u306f\u8aad\u307f\u53d6\u3063\u3066\u3082\u3089\u3048\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u4f55\u304b\u3054\u610f\u898b\u3054\u3056\u3044\u307e\u3057\u305f\u3089\u3001\u662f\u975e\u304a\u5bc4\u305b\u304f\u3060\u3055\u3044\u3002\n\u53c2\u8003\nhttp://dev.classmethod.jp/cloud/aws/s3-cors-upload/\nhttp://funasaki.hatenablog.com/entry/2013/11/06/163558\n# \u3084\u3063\u305f\u3053\u3068\nDjango(rest framework)\u3068js\u306eSPA\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u7528\u3044\u305fweb\u30a2\u30d7\u30ea\u306b\u304a\u3044\u3066s3\u306b\u753b\u50cf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u6848\u4ef6\u3092\u53d7\u3051\u308b\u306b\u3042\u305f\u308a\u3001signature\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u3001python3\u306e\u8a18\u4e8b\u304c\u51fa\u3066\u3053\u306a\u304b\u3063\u305f\u6c17\u304c\u3057\u305f\u306e\u3067\u5099\u5fd8\u9332\u3068\u3057\u3066\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\npython2\u306f[\u3053\u3061\u3089](http://stackoverflow.com/questions/9018767/python-generated-signature-for-s3-post)\u306b\u3042\u308b\u306e\u3067\u3059\u304c\u306a\u304b\u306a\u304b\u624b\u9593\u53d6\u3063\u305f\u306e\u3067\u3001\u3001\u3001\n\n\u3053\u3093\u306a\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u8aad\u3081\u3070\u5206\u304b\u308b\u3060\u308d\uff01\u3063\u3066\u591a\u304f\u306e\u4eba\u306f\u601d\u3046\u304b\u3082\u3057\u308c\u306a\u3044\u3067\u3059\u304c\u3001\u50d5\u307f\u305f\u3044\u306a\u30b3\u30d4\u30da\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3\u30a8\u30f3\u30b8\u30cb\u30a2\u306f\u3053\u3046\u3044\u3046\u306e\u3042\u308b\u3068\u52a9\u304b\u308b\u3068\u601d\u3046\u306e\u3067\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\n# \u4ed5\u7d44\u307f\n\u3053\u306e\u8fba\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3068\u304b\u8cc7\u6599\u3068\u304b\u591a\u3044\u306e\u3067\u3059\u304c\u3001\u4e00\u5fdc\n\u666e\u901a\u306fhttp\u306eAuthorization header\u306b\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3001\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u306a\u3069\u304b\u3089\u6697\u53f7\u5316\u95a2\u6570\u3092\u4f7f\u3063\u3066\u4f5c\u6210\u3057\u305f\u7f72\u540d\u6587\u5b57\u5217\u3092\u4ed8\u4e0e\u3057\u3066\u9001\u4fe1\u3057\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u6848\u4ef6\u3060\u3063\u305f\u306e\u3067JS\u306b\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3068\u304b\u8a18\u8f09\u3059\u308b\u308f\u3051\u306b\u306f\u3044\u304d\u307e\u305b\u3093\u3002\n\u3057\u305f\u304c\u3063\u3066\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u7f72\u540d\u6587\u5b57\u5217\u3092\u4f5c\u6210\u3057\u3001\u305d\u308c\u3092\u30d5\u30ed\u30f3\u30c8\u5074\u306b\u8fd4\u3057\u3066\u305d\u308c\u3092\u7528\u3044\u307e\u3059\u3002\n\n\u4eca\u56de\u306e\u6d41\u308c\u3068\u3057\u3066\u306f\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5148\u306e\u30d1\u30b9\u3092\u30d5\u30ed\u30f3\u30c8\u5074\u3067\u6307\u5b9a\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306b\u7f72\u540d\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\n\u2193\n\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u6697\u53f7\u5316\u95a2\u6570\u3092\u7528\u3044\u3066\u7f72\u540d\u6587\u5b57\u5217\u3092\u4f5c\u6210\u3057\u3001\u8fd4\u3059\n\u2193\n\u30d5\u30ed\u30f3\u30c8\u5074\u3067\u7f72\u540d\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001formData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u9001\u4fe1\u3059\u308b\u3002\n\n# s3\u306e\u8a2d\u5b9a\n\u72ec\u81ea\u30b5\u30fc\u30d3\u30b9\u306e\u30d5\u30ed\u30f3\u30c8\u304b\u3089\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3068\u3044\u3046\u3053\u3068\u3067\u30af\u30ed\u30b9\u30aa\u30ea\u30b8\u30f3\u306f\u8a2d\u5b9a\u3057\u306a\u3044\u884c\u3051\u307e\u305b\u3093\u3002\n\u53cd\u6620\u306b\u3082\u7d50\u69cb\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u4e00\u756a\u6700\u521d\u306b\u3053\u308c\u3092\u3084\u3063\u3066\u304a\u304f\u3053\u3068\u3092\u30aa\u30b9\u30b9\u30e1\u3057\u307e\u3059\u3002\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3061\u3083\u3093\u3068\u3057\u305f\u3044\u3068\u304d\u306fAllowedOrigin\u306b\u3061\u3083\u3093\u3068\u3057\u305f\u30c9\u30e1\u30a4\u30f3\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\nbacket\u3092\u9078\u629e\u3057\u3066\u53f3\u5074\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u2192\u30a2\u30af\u30bb\u30b9\u8a31\u53ef\u2192CORS\u306e\u8a2d\u5b9a\u304b\u3089\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<CORSConfiguration xmlns=\"http://s3.amazonaws.com/doc/2006-03-01/\">\n    <CORSRule>\n        <AllowedOrigin>*</AllowedOrigin>\n        <AllowedMethod>GET</AllowedMethod>\n        <AllowedMethod>POST</AllowedMethod>\n        <AllowedMethod>PUT</AllowedMethod>\n        <MaxAgeSeconds>3000</MaxAgeSeconds>\n        <AllowedHeader>*</AllowedHeader>\n    </CORSRule>\n</CORSConfiguration>\n```\n\n# \u5b9f\u88c5\n\nurls.py\u306b\u306f\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3044URL\u3092\u8a18\u8f09\u3057\u3066\u304a\u3044\u3066\u4e0b\u3055\u3044\u3002\n\n```py3:settings.py\nS3_ACCESS_KEY = 'AAAAAAAAAAAAAAAA'\nS3_SECRET_KEY = 'hogehugapiyo'\nS3_BUCKET_NAME = \"s3_bucket_name\"\n```\n\n\u3053\u306e\u3088\u3046\u306bsettings\u306b\u66f8\u3044\u3066\u304a\u304f\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\n```py3:view.py\nfrom rest_framework import status\nfrom rest_framework.renderers import JSONRenderer\nfrom rest_framework.response import Response\nfrom rest_framework.views import APIView\nfrom django.conf import settings\nimport base64, hmac, hashlib\nfrom datetime import datetime, timedelta\n\nclass View(APIView):\n    \n    POLICY = ''\\\n        '{\"expiration\": \"%s\",'\\\n        '  \"conditions\": ['\\\n        '    {\"acl\": \"public-read\"},'\\\n        '    {\"bucket\": \"%s\"},'\\\n        '    {\"key\": \"%s\"},'\\\n        '    [\"content-length-range\", 0,MAX_LENGTH]'\\  #\u3053\u3053\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\n        '  ]'\\\n        '}'\\\n\n    def get(self, request):\n        s = (self.POLICY % ((datetime.now() + timedelta(minutes=3)).strftime(\"%Y-%m-%dT%H:%M:%S.000Z\"), settings.s3_BUCKET_NAME, request.query_params['upload_path'])).replace(\"\\n\", \"\").encode('ascii')\n        private_key = settings.S3_SECRET_KEY\n        policy = base64.b64encode(s)\n        signature = base64.b64encode(hmac.new(private_key.encode('ascii'), policy, hashlib.sha1).digest())\n        access_key = settings.S3_ACCESS_KEY\n        data = {\n            \"policy\": policy.decode('ascii'),\n            \"signature\": signature.decode('ascii'),\n            \"access_key\": access_key\n        }\n        return Response(data, status=200)\n```\n\n\u4eca\u56de\u306fpath\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u304b\u3089\u53d6\u3063\u3066\u304f\u308b\u3068\u3044\u3046\u3053\u3068\u3067request.query_params['upload_path']\u306b\u3057\u3066\u3044\u307e\u3059\u3002\u9055\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4f7f\u3044\u305f\u3051\u308c\u3070\u3054\u81ea\u7531\u306b\u3002\n\u307e\u305f\u3001\u4e00\u5fdc3\u5206\u3067\u3053\u306e\u7f72\u540d\u6587\u5b57\u5217\u306f\u5931\u52b9\u3059\u308b\u3088\u3046\u306b\u66f8\u3044\u3066\u3044\u307e\u3059\u3001\u3067\u3082\u3082\u3063\u3068\u77ed\u304f\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u3002\u3002\u3002\n\n\u30c1\u30e7\u30c3\u30c8\u30cf\u30de\u3063\u305f\u3068\u3053\u308d\u304c\nascii\u306bencode\u3057\u305f\u5f8c\u306b\u305d\u306e\u307e\u307ejson\u3067\u8fd4\u5374\u3057\u3088\u3046\u3068\u3057\u305f\u3068\u3053\u308d\n```\ntypeerror the json object must be str not 'bytes' \n```\n\u3067\u8fd4\u305b\u306a\u304b\u3063\u305f\u306e\u3067decode\u3057\u3066\u8fd4\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u3042\u3068\u306fjs\u306eformData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3053\u3093\u306a\u611f\u3058\u3067\u4f5c\u6210\n\n```js:upload.js\n\u4f55\u304b\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\uff08jquery\u3067\u3082superagent\u3067\u3082\uff09.get(django_url, {upload_path:\"path/path.jpg\"}, function(success) {\n  formdata = new FormData();\n  formdata.append(\"acl\", \"public-read\");\n  formdata.append(\"key\", path);\n  formdata.append(\"AWSAccessKeyId\", success.access_key);\n  formdata.append(\"policy\", success.policy);\n  formdata.append(\"signature\", success.signature);\n  formdata.append(\"file\", blob);\n  library.post(s3_url ,formdata, function(){\n    console.log(\"\u308f\u30fc\u3044\uff3c(^o^)\uff0f\");\n  })\n});\n```\n\njs\u306f\u96d1\u3067\u3059\u304c\u610f\u56f3\u306f\u8aad\u307f\u53d6\u3063\u3066\u3082\u3089\u3048\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4f55\u304b\u3054\u610f\u898b\u3054\u3056\u3044\u307e\u3057\u305f\u3089\u3001\u662f\u975e\u304a\u5bc4\u305b\u304f\u3060\u3055\u3044\u3002\n\n\u53c2\u8003\nhttp://dev.classmethod.jp/cloud/aws/s3-cors-upload/\nhttp://funasaki.hatenablog.com/entry/2013/11/06/163558\n", "tags": ["python3", "AWS", "Django", "django-rest-framework"]}