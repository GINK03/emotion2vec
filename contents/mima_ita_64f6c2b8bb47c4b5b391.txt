{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nSpatiaLite\u306f\u5730\u56f3\u306a\u3069\u306e\u7a7a\u9593\u60c5\u5831\u3092\u683c\u7d0d\u3067\u304d\u308bSQLite\u306e\u62e1\u5f35\u3067\u3059\u3002\nShp\u30d5\u30a1\u30a4\u30eb\u3084GeoJson\u3067\u8a18\u8ff0\u3055\u308c\u305fGeometry\u60c5\u5831\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u683c\u7d0d\u3057\u5229\u7528\u3067\u304d\u307e\u3059\u3002\nhttp://www.gaia-gis.it/gaia-sins/index.html\n\n\u914d\u5e03\u30d5\u30a1\u30a4\u30eb\u306e\u8aac\u660e\n\nSpatiaLite\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u64cd\u4f5c\u3092\u884c\u3048\u307e\u3059\u3002\n\u30d0\u30a4\u30ca\u30ea\u306e\u914d\u5e03 \nWindows\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u304b\u3089\u4efb\u610f\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nhttp://www.gaia-gis.it/gaia-sins/index.html\n\nmod_spatialite.dll/mod_spatialite.so\nSQLite\u306e\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\nSQLite\u4e0a\u3067\u3001load_extension\u3092\u5229\u7528\u3057\u3066DLL\u307e\u305f\u306fso\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u3067SpatiaLite\u306e\u6a5f\u80fd\u304c\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u30d0\u30a4\u30ca\u30ea\u306e\u914d\u5e03 \nWindows\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u304b\u3089\u4efb\u610f\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nhttp://www.gaia-gis.it/gaia-sins/index.html\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u914d\u5e03 \n\u4ee5\u4e0b\u304b\u3089libspatialite\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u30d3\u30eb\u30c9\u3059\u308b\u3053\u3068\u3067\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002\nhttps://www.gaia-gis.it/fossil/libspatialite/index\n\nspatialite_gui\nGUI\u3067spatialite\u306e\u6a5f\u80fd\u304c\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\n\nPOLYGON\u306a\u3069\u306eGeometry\u578b\u306e\u5217\u306b\u3064\u3044\u3066\u306f\u3001\u753b\u50cf\u3068\u3057\u3066\u305d\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u30d0\u30a4\u30ca\u30ea\u306e\u914d\u5e03 \nWindows\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u304b\u3089\u4efb\u610f\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nhttp://www.gaia-gis.it/gaia-sins/index.html\n\nlibspatialite\u306e\u30d3\u30eb\u30c9\n\u3082\u3057\u3001\u30d0\u30a4\u30ca\u30ea\u3067mod_spatialite\u3092\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u3001libspatialite\u3092\u30d3\u30eb\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nlibspatialite-4.2.0\u306e\u30d3\u30eb\u30c9\u306b\u306f\u4e0b\u8a18\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u5fc5\u8981\u3067\u3059\u3002\nproj-4.8.0\nproj.4\u306f\u5730\u56f3\u4f5c\u6210\u6295\u5f71\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\nhttp://trac.osgeo.org/proj/\ngeos-3.4.2 \nGeometry Engin\u306fJavaTopologySuite\u306eC++\u3078\u306e\u79fb\u690d\u3067\u3001Geometry\u3092\u51e6\u7406\u3059\u308b\u305f\u3081\u306e\u7a7a\u9593\u8ff0\u8a9e\u3068\u6a5f\u80fd\u306eAPI\u3067\u3059\u3002\nhttp://trac.osgeo.org/geos/\n\u4ee5\u4e0a\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3042\u3068\u306b\u3001libsatialite\u306e\u30bd\u30fc\u30b9\u304c\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u306b\u3066\u4e0b\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n./configure --disable-freexl\nmake\nmake install\n\n--disable-freexl\u3067Excel\u3068\u306e\u9023\u643a\u6a5f\u80fd\u3092\u7121\u52b9\u306b\u3057\u3066\u307e\u3059\u3002\n\u3053\u308c\u3092\u6709\u52b9\u306b\u3057\u305f\u5834\u5408\u306ffreexl\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\nhttps://www.gaia-gis.it/fossil/freexl/index\n\nFreeBSD\u3067\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u5834\u5408\nFreeBSD\u3067\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u3067\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\n/usr/bin/ld: cannot find -ldl\n\nFreeBSD\u3067\u306fdlopen \u306f\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u306e\u3067-ldl\u306f\u4e0d\u8981\u3067\u3059\u3002\nsrc/Makefile\u3067-ldl\u3092\u691c\u7d22\u3057\u3066\u524a\u9664\u3057\u305f\u306e\u3061\u306bmake\u3092\u3057\u76f4\u3057\u307e\u3057\u3087\u3046\u3002\n\u53c2\u8003\uff1a\nhttp://sourceforge.net/p/idjc/discussion/458834/thread/246f0841/\n\nmod_spatialite\u3092SQLite\u304b\u3089\u4f7f\u7528\u3059\u308b\u3002\n\u5148\u306b\u8ff0\u3079\u305f\u3088\u3046\u306b\u3001load_extension\u3067spatialite\u304c\u5229\u7528\u3067\u304d\u307e\u3059\u304c\u3001\u3044\u304f\u3064\u304b\u6ce8\u610f\u70b9\u304c\u3042\u308a\u307e\u3059\u3002\n\u30fbSQLite\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f3.7.17\u4ee5\u964d\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30fb\u4f9d\u5b58\u3059\u308bDLL\u306f\u3059\u3079\u3066\u3001SQLite\u304b\u3089\u8a8d\u8b58\u3067\u304d\u308b\u5834\u6240\u306b\u914d\u7f6e\u3055\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u95a2\u9023\u306eDLL\u306e\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u74b0\u5883\u5909\u6570PATH\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30fbSQLite\u3068mod_spatialite\u306e\u30d7\u30ed\u30bb\u30b9\u306f\u540c\u3058\u30d3\u30c3\u30c8\u3067\u30d3\u30eb\u30c9\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\u3000SQLite\u304c32bit\u3067\u52d5\u4f5c\u3057\u3066\u3044\u308b\u5834\u5408\u306fmod_spatialite\u306f32bit\u3067\u30d3\u30eb\u30c9\u3059\u308b\u5fc5\u8981\u304c\u308a\u3001SQLite\u304c64bit\u3067\u52d5\u4f5c\u3057\u3066\u3044\u308b\u5834\u5408\u306fmod_spatialite\u306f64bit\u3067\u30d3\u30eb\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3000\u3082\u3057\u3001Windows\u306764bit\u30d0\u30a4\u30ca\u30ea\u306eSQLite\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u4e0b\u8a18\u3092\u8a18\u4e8b\u901a\u308a\u306b\u884c\u3048\u3070\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002\nhttp://qiita.com/akaneko3/items/0e99c3c1366dfbad006f\n\u30fbload_extension\u3092\u5229\u7528\u3057\u3066DLL\u307e\u305f\u306fso\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u3067\u3001\u4ee5\u964dspatialite\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nSELECT load_extension('/usr/local/lib/mod_spatialite.so');\n\n\u30fbSQLite3\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u305f\u5834\u5408\u3001SpatiaLite\u304c\u7ba1\u7406\u3059\u308b\u30e1\u30bf\u30c7\u30fc\u30bf\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u3053\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306b\u4e0b\u8a18\u306eSQL\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\nSELECT InitSpatialMetaData();\n\n\n\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\n\u3053\u3053\u3067\u306f\u3001\u5b9f\u969b\u306b\u56fd\u571f\u6570\u5024\u60c5\u5831\u306e\u884c\u653f\u533a\u57df\u3092spatialite\u306b\u683c\u7d0d\u3057\u3066\u5229\u7528\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u56fd\u571f\u6570\u5024\u60c5\u5831\u3067\u5168\u56fd\u306e\u884c\u653f\u533a\u57df\u3092\u53d6\u5f97\u3059\u308b\u3002\n\u307e\u305a\u4e0b\u8a18\u306e\u30da\u30fc\u30b8\u304b\u3089\u5168\u56fd\u306e\u884c\u653f\u533a\u57df\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nhttp://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-N03.html\n\n\u7a7a\u306eSQLite\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\nspatialite_gui\u3092\u8d77\u52d5\u3057\u3066\u7a7a\u306eSQLite\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n[Creating a New (empty) SQLite DB]\u30a2\u30a4\u30b3\u30f3\u3092\u62bc\u3057\u3066\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\n\u6b63\u5e38\u306b\u4f5c\u6210\u3055\u308c\u308b\u3068\u3001\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u30d1\u30b9\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u3053\u3053\u307e\u3067\u306f\u666e\u901a\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u5909\u308f\u308a\u3042\u308a\u307e\u305b\u3093\u3002\n\nshp\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\n\u56fd\u571f\u6570\u5024\u60c5\u5831\u306eshp\u30d5\u30a1\u30a4\u30eb\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u53d6\u308a\u8fbc\u307f\u307e\u3059\u3002\n[Load Shape file]\u30a2\u30a4\u30b3\u30f3\u3092\u62bc\u3057\u3066\u3001\u56fd\u571f\u6570\u5024\u60c5\u5831\u306e\u300cN03-14_140401.shp\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u6642\u3001\u30a8\u30f3\u30b3\u30fc\u30c9\u3092\u805e\u304b\u308c\u308b\u306e\u3067\u300cCP932\u300d\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u6b63\u5e38\u306b\u5b8c\u4e86\u3059\u308b\u3068\u300cN03-14_140401\u300d\u3068\u3044\u3046\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n\nshp\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u4f5c\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u306e\u78ba\u8a8d\n\u3053\u3053\u3067\u306fshp\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u4f5c\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u306e\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3059\u3002\n\u4f5c\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u306e\u5217\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f\u30c6\u30fc\u30d6\u30eb\u3092\u9078\u629e\u3057\u3066\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3092\u62bc\u3057\u3066\u300cShow columns\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n\nN03_001\uff5eN03_004\u306f\u770c\u3001\u533a\u3001\u5e02\u3001N03_007\u306b\u306f\u30b3\u30fc\u30c9\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308bTEXT\u578b\u306e\u5217\u3067\u3059\u3002\nGeometry\u306f\u884c\u653f\u533a\u57df\u306e\u5f62\u304cBlob\u3068\u3057\u3066\u683c\u7d0d\u3055\u308c\u3066\u3044\u3066POLYGON\u3068\u3044\u3046spatiaLite\u304c\u6307\u5b9a\u3057\u305f\u578b\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u4f5c\u6210\u306b\u5b9f\u969b\u3057\u3088\u3046\u3055\u308c\u305fSQL\u6587\u306f\u30c6\u30fc\u30d6\u30eb\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3057\u3066[Show CREATE statement]\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\nCREATE TABLE \"N03-14_140401\" (\n\"PK_UID\" INTEGER PRIMARY KEY AUTOINCREMENT,\n\"N03_001\" TEXT,\n\"N03_002\" TEXT,\n\"N03_003\" TEXT,\n\"N03_004\" TEXT,\n\"N03_007\" TEXT, \n\"Geometry\" POLYGON)\n\n\u3067\u306f\u5b9f\u969b\u306b\u30c6\u30fc\u30d6\u30eb\u306e\u5185\u5bb9\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u306b\u3001SQL\u6587\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\nSELECT * FROM \"N03-14_140401\" LIMIT 10;\n\n\n\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\nPK_UID\uff5eN03_007\u306f\u30c6\u30ad\u30b9\u30c8\u3067\u30c7\u30fc\u30bf\u304c\u8868\u73fe\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001Geometry\u306fBLOB\u30c7\u30fc\u30bf\u306a\u306e\u3067\u4eba\u304c\u898b\u3066\u5185\u5bb9\u304c\u78ba\u8a8d\u3067\u304d\u307e\u305b\u3093\u3002\n\u3053\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\u306f\uff12\u901a\u308a\u3042\u308a\u307e\u3059\u3002\n\uff11\u3064\u306fBLOB explore\u3092\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u3067\u3059\u3002\nGeometry\u306e\u5217\u306e\u4efb\u610f\u306e\u30bb\u30eb\u3092\u9078\u629e\u3057\u3066\u53f3\u30af\u30ea\u30c3\u30af\u3092\u62bc\u3057\u300cBLOB explore\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\nBLOB explore\u3067\u306f\u30d0\u30a4\u30ca\u30ea\u3001\u753b\u50cf\u3001SVG\u3001GeoJSON\u306a\u3069\u306e\u69d8\u3005\u306a\u5f62\u5f0f\u3067\u30c7\u30fc\u30bf\u3092\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nBLOB explore\u3092\u4f7f\u7528\u3057\u306a\u3044\u65b9\u6cd5\u3068\u3057\u3066\u306f\u3001SQL\u3067Geometry\u306e\u5217\u3092\u4efb\u610f\u306e\u5f62\u5f0f\u3067\u8868\u793a\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u4f8b\u3067\u306f\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067Geometry\u5217\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n-- \u30c7\u30fc\u30bf\u304c\u9577\u3044\u306e\u3067\u6700\u521d\u306e100\u6587\u5b57\u307e\u3067\u8868\u793a\nSELECT substr(ASTEXT(Geometry), 1, 100) FROM \"N03-14_140401\" LIMIT 10;\n\n\nASTEXT\u3067POLYGON\u60c5\u5831\u3092\u6587\u5b57\u3068\u3057\u3066\u8868\u793a\u3067\u304d\u307e\u3057\u305f\u3002\u3053\u308c\u306f\u4efb\u610f\u306e\u5f62\u5f0f\u3067\u51fa\u529b\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u305f\u3068\u3048\u3070\u3001ASGEOJSON\u3068\u3057\u305f\u5834\u5408\u306f\u3001GeoJSON\u3068\u3057\u3066\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\nSELECT substr(ASGEOJSON(Geometry), 1, 100) FROM \"N03-14_140401\" LIMIT 10;\n\n\nASTEXT\u3084ASGEOJSON\u306eSpatiaLite\u306e\u63d0\u4f9b\u3059\u308b\u95a2\u6570\u306f\u4e0b\u8a18\u306e\u300cSpatial SQL functions reference guide\u300d\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\nhttp://www.gaia-gis.it/gaia-sins/spatialite-sql-4.2.0.html\n\n\u81ea\u5206\u3067\u5ea7\u6a19\u60c5\u5831\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u307f\u308b\n\u5148\u306e\u4f8b\u3067\u306fshp\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u307e\u3057\u305f\u304c\u3001\u4eca\u56de\u306f\u3001\u5ea7\u6a19\u60c5\u5831\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u81ea\u5206\u3067\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u6771\u4eac\u30bf\u30ef\u30fc\u306a\u3069\u306e\u5730\u7269\u60c5\u5831\u306e\u5ea7\u6a19\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u307e\u305a\u3001\u5730\u7269\u60c5\u5831\u3092\u542b\u307e\u306a\u3044\u5217\u306e\u307f\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nCREATE TABLE \"places\" (\n\"PK_UID\" INTEGER PRIMARY KEY AUTOINCREMENT,\n\"name\" TEXT)\n\nSQL\u3092\u5b9f\u884c\u3057\u305f\u5f8c\u306b\u3001refresh\u3092\u884c\u3046\u3068\u30c6\u30fc\u30d6\u30eb\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\n\u6b21\u306b\u3001\u5730\u7269\u60c5\u5831\u3092\u8868\u3059\u5217\u3092AddGeometryColumn()\u3092\u7528\u3044\u3066\u4f5c\u6210\u3057\u307e\u3059\u3002\nSelect AddGeometryColumn ('places', 'Geometry', 0, 'POINT', 'XY')\n\nSQL\u3092\u5b9f\u884c\u3057\u305f\u5f8c\u306b\u3001refresh\u3092\u884c\u3046\u3068\u5217\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3001\u30c6\u30fc\u30d6\u30eb\u306b\u5730\u7403\u306e\u30a2\u30a4\u30b3\u30f3\u304c\u3064\u304d\u307e\u3059\u3002\n\n\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3067\u304d\u305f\u3089\u3001\u6b21\u306f\u30c7\u30fc\u30bf\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u4f8b\u3067\u306f\u90fd\u5e81\u306e\u5ea7\u6a19\u3092\u30c6\u30fc\u30d6\u30eb\u306b\u683c\u7d0d\u3057\u3066\u3044\u307e\u3059\u3002\nINSERT INTO places (name, Geometry) VALUES(\n  '\u90fd\u5e81',\n  GeomFromText('POINT(139.692101 35.689634 )')\n)\n\nGeomFromText\u306f\u6587\u5b57\u5217\u3092Geometry\u306b\u5909\u66f4\u3059\u308b\u95a2\u6570\u3067\u3059\u3002\u4eca\u56de\u306f\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u304b\u3089\u5909\u63db\u3057\u307e\u3057\u305f\u304c\u3001GeomFromGeoJSON\u3001GeomFromKml\u306a\u3069\u3092\u5229\u7528\u3057\u3066GeoJSON\u3084Kml\u304b\u3089\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u306a\u304a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4e00\u6c17\u306b\u4f5c\u308b\u3068\u3001\u4e00\u898b\u305d\u308c\u3063\u307d\u304f\u52d5\u4f5c\u3057\u307e\u3059\u304c\u3001\u30e1\u30bf\u30c7\u30fc\u30bf\u304c\u95a2\u9023\u4ed8\u3051\u3089\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u308b\u3068\u304d\u306a\u3069\u306b\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u307e\u305b\u3093\u3002\nCREATE TABLE \"places\" (\n\"PK_UID\" INTEGER PRIMARY KEY AUTOINCREMENT,\n\"name\" TEXT,\n\"Geometry\" POINT)\n\n\n\u5ea7\u6a19\u60c5\u5831\u306b\u5bfe\u3059\u308b\u691c\u7d22\n\u3053\u3053\u3067\u306f\u5ea7\u6a19\u60c5\u5831\u306b\u3064\u3044\u3066\u691c\u7d22\u3057\u307e\u3059\u3002\nplaces\u30c6\u30fc\u30d6\u30eb\u3067\u6307\u5b9a\u3057\u305f\u5ea7\u6a19\u304c\u3001\u3069\u306e\u884c\u653f\u533a\u753b\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u304b\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\nSELECT\n  name, \"N03-14_140401\".*\nFROM\n \"N03-14_140401\"\nINNER JOIN places ON\n Contains(\"N03-14_140401\".Geometry, places.Geometry)\n\nContains\u95a2\u6570\u306f\u7b2c\u4e00\u5f15\u6570\u306e\u7bc4\u56f2\u306b\u7b2c\u4e8c\u5f15\u6570\u306e\u9818\u57df\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u304b\u8abf\u3079\u307e\u3059\u3002\n\u3053\u306e\u7d50\u679c\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u90fd\u5e81\u306f\u65b0\u5bbf\u533a\u306b\u3042\u308b\u306e\u3067\u671f\u5f85\u3069\u304a\u308a\u306e\u7d50\u679c\u3068\u3044\u3048\u308b\u3067\u3057\u3087\u3046\u3002\n\u5148\u306e\u4f8b\u3067\u306f\u30c6\u30fc\u30d6\u30eb\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3067\u691c\u7d22\u3057\u307e\u3057\u305f\u304c\u3001\u76f4\u63a5WHERE\u533a\u306b\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\nSELECT\n  *\nFROM\n \"N03-14_140401\"\nWHERE\n  Contains(\"N03-14_140401\".Geometry,GeomFromText('POINT(139.692101 35.689634 )'))\n\n\nMBR\u3068\u5927\u307e\u304b\u306a\u691c\u7d22\n\u5148\u307b\u3069\u306e\u691c\u7d22\u306f\u5404\u5ea7\u6a19\u306b\u3064\u3044\u3066\u6b63\u78ba\u306b\u691c\u7d22\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u5927\u307e\u304b\u306a\u4f4d\u7f6e\u3092\u65e9\u304f\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3002\n\u3053\u306e\u5834\u5408\u306f\u3001Minimum Bounding Rectangle - MBR\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\nMBR\u306fGEOMETRY\u306e\u304a\u304a\u307e\u304b\u306a\u5927\u304d\u3055\u3092\u8868\u3059\u3082\u306e\u3067\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8907\u96d1\u306a\u56f3\u5f62\u3092\u8d64\u3044\u67a0\u7dda\u306e\u56f3\u5f62\u3068\u307f\u306a\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u4e0d\u6b63\u78ba\u3067\u306f\u3042\u308b\u304c\u3001\u65e9\u3044\u691c\u7d22\u304c\u884c\u3048\u307e\u3059\u3002\nGEOMETRY\u304b\u3089MBR\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f Envelope()\u3092\u7528\u3044\u307e\u3059\u3002\nSELECT\n   ASTEXT(Envelope(Geometry))\nFROM\n \"N03-14_140401\"\nLIMIT 10\n\n\u3053\u306e\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5358\u7d14\u306a\u56f3\u5f62\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3067\u306f\u3001\u5148\u307b\u3069\u3068\u540c\u3058\u90fd\u5e81\u3092\u542b\u3080\u5ea7\u6a19\u3092MBR\u3092\u5229\u7528\u3057\u3066\u691c\u7d22\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nSELECT\n  *\nFROM\n \"N03-14_140401\"\nWHERE\n  MBRContains(\"N03-14_140401\".Geometry,GeomFromText('POINT(139.692101 35.689634 )'))\n\n\u691c\u7d22\u901f\u5ea6\u304c\u5411\u4e0a\u3057\u305f\u304b\u308f\u308a\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3001\u4e0d\u8981\u306a\u30c7\u30fc\u30bf\u3082\u62bd\u51fa\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u307e\u3059\u3002\n\n\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5229\u7528\u3057\u305f\u691c\u7d22\n\u901a\u5e38\u3001DB\u3092\u6271\u3046\u5834\u5408\u3001\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u691c\u7d22\u901f\u5ea6\u304c\u5411\u4e0a\u3057\u307e\u3059\u3002\n\u6b8b\u5ff5\u306a\u3053\u3068\u306b\u3001\u6587\u5b57\u3084\u6570\u5024\u306b\u4ed8\u4e0e\u3067\u304d\u308b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092Geometry\u306b\u4ed8\u4e0e\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\u3057\u304b\u3057\u306a\u304c\u3089\u3001SpatiaLite\u306fSQLite\u306eRTree\u3092\u5229\u7528\u3057\u3066\u3001RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nWonderful R*Tree Spatial Index\nhttp://www.gaia-gis.it/gaia-sins/spatialite-cookbook/html/rtree.html\nRTree\u306e\u6982\u8981\u3068\u3057\u3066\u306f\u3001Geometry\u3092MBR\u3092\u3064\u304b\u3063\u3066\u56db\u89d2\u5f62(rectangle)\u306b\u3057\u3001\u305d\u306e\u56db\u89d2\u5f62\u306e\u4ea4\u308f\u308a\u306b\u5fdc\u3058\u3066\u30c4\u30ea\u30fc\u3092\u4f5c\u308a\u3001\u691c\u7d22\u3057\u3084\u3059\u304f\u3057\u3066\u3044\u307e\u3059\u3002\nrectangle\u3092\u4f7f\u3063\u305f\u30c4\u30ea\u30fc\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u306e\u3067RTree index\u3068\u8a00\u308f\u308c\u307e\u3059\u3002\n\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u4f5c\u6210\u3068\u5229\u7528\n\u3067\u306f\u3001RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5b9f\u969b\u4f7f\u7528\u3057\u3066\u307f\u307e\u3059\u3002\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210\u3059\u308b\u306b\u306fCreateSpatialIndex\u95a2\u6570\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u7b2c\u4e00\u5f15\u6570\u306b\u30c6\u30fc\u30d6\u30eb\u540d\u3001\u7b2c\u4e8c\u5f15\u6570\u306b\u5217\u540d\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nSELECT CreateSpatialIndex(\"N03-14_140401\", \"Geometry\") ;\n\n\u6b63\u5e38\u306b\u4f5c\u6210\u3067\u304d\u305f\u5834\u5408\u306f\u30011\u304c\u8fd4\u308a\u3001refresh\u5f8c\u306bSpatialIndex\u306b\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u304c\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u4ee5\u4e0b\u306e\uff14\u3064\u306e\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\u30fbidx_N03-14_140401_Geometry\n\u30fbidx_N03-14_140401_Geometry_node\n\u30fbidx_N03-14_140401_Geometry_parent\n\u30fbidx_N03-14_140401_Geometry_rowid\nidx_N03-14_140401_Geometry\u4ee5\u5916\u306f\u5185\u90e8\u3067\u4f7f\u7528\u3059\u308b\u30c6\u30fc\u30d6\u30eb\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u30e6\u30fc\u30b6\u30fc\u304c\u76f4\u63a5\u64cd\u4f5c\u3059\u308b\u3053\u3068\u3092\u671f\u5f85\u3057\u3066\u3044\u307e\u305b\u3093\u3002\nidx_N03-14_140401_Geometry\u306fVIRTUAL TABLE\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u5b9f\u969b\u306b\u306f\u5185\u90e8\u30c6\u30fc\u30d6\u30eb\u3092\u5229\u7528\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002\n\u3067\u306f\u3001idx_N03-14_140401_Geometry\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\nSELECT * FROM \"idx_N03-14_140401_Geometry\" LIMIT 10;\n\n\u3053\u306e\u3088\u3046\u306b\u5404\u30ec\u30b3\u30fc\u30c9\u306eMRB\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u30e6\u30fc\u30b6\u306f\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u306e\u4e2d\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30d5\u30a3\u30eb\u30bf\u30fc\u3092\u3057\u3001\u7d50\u679c\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nSELECT \n  * \nFROM \"N03-14_140401\"\nWHERE ROWID IN(\n  SELECT\n    pkid\n  FROM\n   \"idx_N03-14_140401_Geometry\"\n  WHERE\n    MBRContains(\n      BuildMBR(xmin,ymin,xmax,ymax),\n      GeomFromText('POINT(139.692101 35.689634 )')\n  )\n) AND Contains(Geometry, \n  GeomFromText('POINT(139.692101 35.689634 )')\n)\n\n\u901a\u5e38\u306e\u691c\u7d22\u3088\u308a\u65e9\u304f\u6b63\u78ba\u306a\u30c7\u30fc\u30bf\u304c\u53d6\u5f97\u3067\u304d\u305f\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u30c7\u30fc\u30bf\u6570\u304c\u591a\u304f\u306a\u308c\u3070\u3001\u306a\u308b\u307b\u3069\u305d\u306e\u5dee\u304c\u5927\u304d\u304f\u73fe\u308c\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306bRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306f\u901a\u5e38\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3068\u9055\u3044\u3001\u5b9f\u30c6\u30fc\u30d6\u30eb\u306bSQL\u3092\u5b9f\u884c\u3057\u305f\u3060\u3051\u3067\u306f\u9069\u7528\u3055\u308c\u305a\u306b\u3001\u4f5c\u6210\u3055\u308c\u305fVIRTUAL TABLE\u3092\u5229\u7528\u3057\u3066\u30b5\u30d6\u30af\u30a8\u30ea\u2015\u3084JOIN\u3067\u30c7\u30fc\u30bf\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u5f79\u5272\u306b\u306a\u308a\u307e\u3059\u3002\n\u5225\u30c6\u30fc\u30d6\u30eb\u3067\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u7ba1\u7406\u3057\u3066\u3044\u308b\u3053\u3068\u3067\u3001\u5b9f\u30c6\u30fc\u30d6\u30eb\u304c\u66f4\u65b0\u3055\u308c\u305f\u6642\u306b\u4e0d\u4e00\u81f4\u304c\u3067\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3068\u3044\u3046\u7591\u554f\u3092\u3082\u3064\u3067\u3057\u3087\u3046\u3002\n\u3057\u304b\u3057\u3001CreateSpatialIndex\u3092\u5b9f\u884c\u3057\u305f\u6642\u306b\u30c8\u30ea\u30ac\u30fc\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u30e6\u30fc\u30b6\u306f\u4e00\u5207\u624b\u3092\u52a0\u3048\u305a\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3068\u30c6\u30fc\u30d6\u30eb\u306e\u540c\u671f\u304c\u3068\u308c\u307e\u3059\u3002\n\u3053\u306e\u30c8\u30ea\u30ac\u30fc\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f\u6b21\u306e\u3088\u3046\u306aSQL\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\nselect name  from sqlite_master where type = 'trigger' and tbl_name='N03-14_140401';\n\n\u4eca\u56de\u306f\u6b21\u306e\u3088\u3046\u306a\u30c8\u30ea\u30ac\u30fc\u304c\u81ea\u52d5\u3067\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u30fbggi_N03-14_140401_Geometry\n\u30fbggu_N03-14_140401_Geometry\n\u30fbgii_N03-14_140401_Geometry\n\u30fbgiu_N03-14_140401_Geometry\n\u30fbgid_N03-14_140401_Geometry\n\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u524a\u9664\n\u4f5c\u6210\u3057\u305fRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001DisableSpatialIndex\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\nSELECT DisableSpatialIndex(\"N03-14_140401\", \"Geometry\") ;\n\nrefresh\u3092\u5b9f\u884c\u3059\u308b\u3068Spatial Index\u304c\u524a\u9664\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\npython\u304b\u3089\u306e\u5229\u7528\npython\u304b\u3089SpatiaLite\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001SQLite\u304c\u9069\u5207\u306b\u5229\u7528\u3067\u304d\u308b\u72b6\u6cc1\u306a\u3089\u7c21\u5358\u306b\u5229\u7528\u3067\u304d\u307e\u3059\u3002\nPython\u304c\u4f7f\u3063\u3066\u3044\u308bSqlite3\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u6b21\u306e\u624b\u9806\u3067\u8abf\u3079\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nimport sqlite3\nprint (sqlite3.sqlite_version_info)\n\n\u3082\u3057\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u306f\u3001SQLITE\u3092\u66f4\u65b0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nWindows\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u30d5\u30a9\u30eb\u30c0\u306eDLL\u3092\u66f8\u304d\u63db\u3048\u308b\u3068\u3044\u3044\u3067\u3057\u3087\u3046\u3002\nC:\\Python27\\DLLs\\sqlite3.dll\n\u4ee5\u4e0b\u306fPython\u3067\u306e\u30b3\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\nimport sqlite3\nimport os\n\n# mod_spatialite\u306e\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u3092PATH\u306b\u52a0\u3048\u308b\nos.environ[\"PATH\"] = os.environ[\"PATH\"] + ';C:\\\\tool\\\\spatialite\\\\mod_spatialite-4.2.0-win-x86'\ncnn = sqlite3.connect('database/gyouseikuiki.sqlite')\n\n# mod_spatialite\u306e\u8aad\u307f\u8fbc\u307f\ncnn.enable_load_extension(True)\ncnn.execute(\"SELECT load_extension('./mod_spatialite-4.2.0-win-x86/mod_spatialite.dll');\")\nsql = \"\"\"\nSELECT\n  N03_001,\n  N03_002,\n  N03_003,\n  N03_004,\n  N03_007, \n  AsGeoJson(Geometry)\nFROM\n \"N03-14_140401\"\nWHERE\n  MBRContains(\"N03-14_140401\".Geometry,GeomFromText('POINT(139.692101 35.689634 )'))\n\"\"\"\n\nret = cnn.execute(sql)\nfor r in ret:\n  print('----------------------------')\n  print(r[0].encode('utf_8') )\n  print(r[1].encode('utf_8') )\n  print(r[2].encode('utf_8') )\n  print(r[3].encode('utf_8') )\n  print(r[4].encode('utf_8') )\n  print(r[5].encode('utf_8') )\n\n\u74b0\u5883\u5909\u6570\u3092mod_spatialite\u306e\u3042\u308b\u30d1\u30b9\u306b\u901a\u3057\u3001enable_load_extension\u3067\u62e1\u5f35DLL\u306e\u4f7f\u7528\u3092\u8a31\u53ef\u3057\u3066\u304b\u3089\u3001mod_spatialite\u3092\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001\u901a\u5e38\u901a\u308aSQL\u304c\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\nenable_load_extension\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\u5834\u5408\nenable_load_extension\u3092\u4f7f\u7528\u3057\u305f\u6642\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\"'sqlite3.Connection' object has no attribute 'enable_load_extension'\"\n\n\u539f\u56e0\u3068\u3057\u3066\u3001MaxOS\u3084Debian\u306a\u3069\u306e\u3044\u304f\u3064\u304b\u306eOS\u306b\u30d7\u30ea\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308bPython\u306f\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u3001\u62e1\u5f35\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f\u6a5f\u80fd\u3092\u7121\u52b9\u306b\u3057\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\nhttps://docs.python.org/2/library/sqlite3.html#f1\n\u3053\u308c\u306b\u5bfe\u5fdc\u3059\u308b\u306b\u306fPython\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u304a\u3059\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u3001Python\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b\u3001setup.py\u3092\u624b\u3067\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nSQLITE_OMIT_LOAD_EXTENSION\u3092\u691c\u7d22\u3057\u3066\u3001\u305d\u306e\u884c\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u3001./configure, make, make install \u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u3082\u3057\u3001make install \u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u5834\u5408\u306f\u3001make install\u6642\u306b\u30a8\u30e9\u30fc\u304c\u3067\u308b\u306a\u3089\u300cmake -i altinstall\u300d\u3092\u305f\u3081\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nhttp://python.g.hatena.ne.jp/nelnal_programing/20101026/1288084718\n\nPeewee\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\nORM\u3067\u3042\u308bPeewee\u30e9\u30a4\u30d6\u30e9\u30ea\u3067spatialite\u3092\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nhttp://qiita.com/mima_ita/items/9d4e1d0afac1865acdbb#spatialitesql%E3%81%B8%E3%81%AE%E6%8E%A5%E7%B6%9A%E6%96%B9%E6%B3%95\n\nphp\u304b\u3089\u306e\u5229\u7528\nWindows+PHP\u306e\u5834\u5408\u3001\u7c21\u5358\u306b\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u8a73\u7d30\u306f\u4e0b\u8a18\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nPHP\u3067\u5730\u56f3\u3068\u304b\u306e\u7a7a\u9593\u60c5\u5831\u3092DB\u306b\u683c\u7d0d\u3057\u3088\u3046\u3068\u3057\u3066Spatialite\u3092\u4f7f\u3046\u3068\u82e6\u52b4\u3059\u308b\nhttp://qiita.com/mima_ita/items/1a90de89f0a194ba843e\n\n\u305d\u306e\u4ed6Tip\n\n\u6e2c\u5730\u7cfb\u306e\u5909\u63db\u3092Spatialite\u3092\u4f7f\u3063\u3066\u884c\u3046\nTransform\u95a2\u6570\u3092\u4f7f\u3046\u3068\u6e2c\u5730\u7cfb\u306e\u5909\u63db\u304c\u884c\u3048\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u4f8b\u3067\u306fJGD2000/\u5e73\u9762\u76f4\u89d2\u5ea7\u6a19\u7cfb6\u3092\u4e16\u754c\u6e2c\u5730\u7cfb\u306b\u5909\u63db\u3057\u3066\u3044\u307e\u3059\u3002\nselect AsText(Transform(GeomFromText('POINT(-4408.916645 -108767.765479)', 2448), 4326))\n\n\n\u53c2\u8003\nSpatiaLite 4.2.0  SQL functions reference list \nhttp://www.gaia-gis.it/gaia-sins/spatialite-sql-4.2.0.html\nThe SpatiaLite Cookbook \nhttp://www.gaia-gis.it/gaia-sins/spatialite-cookbook/index.html\nA quick tutorial to SpatiaLite - a Spatial extension for SQLite(\u53e4\u3044\u304c\u6709\u7528) \nhttp://www.gaia-gis.it/gaia-sins/spatialite-tutorial-2.3.1.html\n##\u6982\u8981\nSpatiaLite\u306f\u5730\u56f3\u306a\u3069\u306e\u7a7a\u9593\u60c5\u5831\u3092\u683c\u7d0d\u3067\u304d\u308bSQLite\u306e\u62e1\u5f35\u3067\u3059\u3002\nShp\u30d5\u30a1\u30a4\u30eb\u3084GeoJson\u3067\u8a18\u8ff0\u3055\u308c\u305fGeometry\u60c5\u5831\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u683c\u7d0d\u3057\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\nhttp://www.gaia-gis.it/gaia-sins/index.html\n\n##\u914d\u5e03\u30d5\u30a1\u30a4\u30eb\u306e\u8aac\u660e\n###SpatiaLite\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u64cd\u4f5c\u3092\u884c\u3048\u307e\u3059\u3002\n\n **\u30d0\u30a4\u30ca\u30ea\u306e\u914d\u5e03** \nWindows\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u304b\u3089\u4efb\u610f\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nhttp://www.gaia-gis.it/gaia-sins/index.html\n\n###mod_spatialite.dll/mod_spatialite.so\nSQLite\u306e\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\nSQLite\u4e0a\u3067\u3001load_extension\u3092\u5229\u7528\u3057\u3066DLL\u307e\u305f\u306fso\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u3067SpatiaLite\u306e\u6a5f\u80fd\u304c\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n **\u30d0\u30a4\u30ca\u30ea\u306e\u914d\u5e03** \nWindows\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u304b\u3089\u4efb\u610f\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nhttp://www.gaia-gis.it/gaia-sins/index.html\n\n **\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u914d\u5e03** \n\u4ee5\u4e0b\u304b\u3089libspatialite\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u30d3\u30eb\u30c9\u3059\u308b\u3053\u3068\u3067\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002\nhttps://www.gaia-gis.it/fossil/libspatialite/index\n\n###spatialite_gui\nGUI\u3067spatialite\u306e\u6a5f\u80fd\u304c\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\n![spatialite2.png](https://qiita-image-store.s3.amazonaws.com/0/47856/fc86e7d9-ee70-7f29-1a63-bcf77d14ed37.png)\n\nPOLYGON\u306a\u3069\u306eGeometry\u578b\u306e\u5217\u306b\u3064\u3044\u3066\u306f\u3001\u753b\u50cf\u3068\u3057\u3066\u305d\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n![spatialite.png](https://qiita-image-store.s3.amazonaws.com/0/47856/efc395eb-e88c-f9d4-846b-5e65205676e7.png)\n\n **\u30d0\u30a4\u30ca\u30ea\u306e\u914d\u5e03** \nWindows\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u304b\u3089\u4efb\u610f\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u30d0\u30a4\u30ca\u30ea\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nhttp://www.gaia-gis.it/gaia-sins/index.html\n\n##libspatialite\u306e\u30d3\u30eb\u30c9\n\u3082\u3057\u3001\u30d0\u30a4\u30ca\u30ea\u3067mod_spatialite\u3092\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u3001libspatialite\u3092\u30d3\u30eb\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nlibspatialite-4.2.0\u306e\u30d3\u30eb\u30c9\u306b\u306f\u4e0b\u8a18\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u5fc5\u8981\u3067\u3059\u3002\n **proj-4.8.0**\nproj.4\u306f\u5730\u56f3\u4f5c\u6210\u6295\u5f71\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\nhttp://trac.osgeo.org/proj/\n\n **geos-3.4.2** \nGeometry Engin\u306fJavaTopologySuite\u306eC++\u3078\u306e\u79fb\u690d\u3067\u3001Geometry\u3092\u51e6\u7406\u3059\u308b\u305f\u3081\u306e\u7a7a\u9593\u8ff0\u8a9e\u3068\u6a5f\u80fd\u306eAPI\u3067\u3059\u3002\nhttp://trac.osgeo.org/geos/\n\n\u4ee5\u4e0a\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3042\u3068\u306b\u3001libsatialite\u306e\u30bd\u30fc\u30b9\u304c\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u306b\u3066\u4e0b\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\n./configure --disable-freexl\nmake\nmake install\n```\n\n--disable-freexl\u3067Excel\u3068\u306e\u9023\u643a\u6a5f\u80fd\u3092\u7121\u52b9\u306b\u3057\u3066\u307e\u3059\u3002\n\u3053\u308c\u3092\u6709\u52b9\u306b\u3057\u305f\u5834\u5408\u306ffreexl\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\nhttps://www.gaia-gis.it/fossil/freexl/index\n\n###FreeBSD\u3067\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u5834\u5408\nFreeBSD\u3067\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u3067\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\n\n```\n/usr/bin/ld: cannot find -ldl\n```\n\nFreeBSD\u3067\u306fdlopen \u306f\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u306e\u3067-ldl\u306f\u4e0d\u8981\u3067\u3059\u3002\nsrc/Makefile\u3067-ldl\u3092\u691c\u7d22\u3057\u3066\u524a\u9664\u3057\u305f\u306e\u3061\u306bmake\u3092\u3057\u76f4\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u53c2\u8003\uff1a\nhttp://sourceforge.net/p/idjc/discussion/458834/thread/246f0841/\n\n##mod_spatialite\u3092SQLite\u304b\u3089\u4f7f\u7528\u3059\u308b\u3002\n\u5148\u306b\u8ff0\u3079\u305f\u3088\u3046\u306b\u3001load_extension\u3067spatialite\u304c\u5229\u7528\u3067\u304d\u307e\u3059\u304c\u3001\u3044\u304f\u3064\u304b\u6ce8\u610f\u70b9\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30fbSQLite\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f3.7.17\u4ee5\u964d\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30fb\u4f9d\u5b58\u3059\u308bDLL\u306f\u3059\u3079\u3066\u3001SQLite\u304b\u3089\u8a8d\u8b58\u3067\u304d\u308b\u5834\u6240\u306b\u914d\u7f6e\u3055\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u95a2\u9023\u306eDLL\u306e\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u74b0\u5883\u5909\u6570PATH\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30fbSQLite\u3068mod_spatialite\u306e\u30d7\u30ed\u30bb\u30b9\u306f\u540c\u3058\u30d3\u30c3\u30c8\u3067\u30d3\u30eb\u30c9\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\u3000SQLite\u304c32bit\u3067\u52d5\u4f5c\u3057\u3066\u3044\u308b\u5834\u5408\u306fmod_spatialite\u306f32bit\u3067\u30d3\u30eb\u30c9\u3059\u308b\u5fc5\u8981\u304c\u308a\u3001SQLite\u304c64bit\u3067\u52d5\u4f5c\u3057\u3066\u3044\u308b\u5834\u5408\u306fmod_spatialite\u306f64bit\u3067\u30d3\u30eb\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3000\u3082\u3057\u3001Windows\u306764bit\u30d0\u30a4\u30ca\u30ea\u306eSQLite\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u4e0b\u8a18\u3092\u8a18\u4e8b\u901a\u308a\u306b\u884c\u3048\u3070\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002\nhttp://qiita.com/akaneko3/items/0e99c3c1366dfbad006f\n\n\u30fbload_extension\u3092\u5229\u7528\u3057\u3066DLL\u307e\u305f\u306fso\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u3053\u3068\u3067\u3001\u4ee5\u964dspatialite\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```sql\nSELECT load_extension('/usr/local/lib/mod_spatialite.so');\n```\n\n\u30fbSQLite3\u304b\u3089\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u305f\u5834\u5408\u3001SpatiaLite\u304c\u7ba1\u7406\u3059\u308b\u30e1\u30bf\u30c7\u30fc\u30bf\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u3053\u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306b\u4e0b\u8a18\u306eSQL\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```sql\nSELECT InitSpatialMetaData();\n```\n\n##\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\n\u3053\u3053\u3067\u306f\u3001\u5b9f\u969b\u306b\u56fd\u571f\u6570\u5024\u60c5\u5831\u306e\u884c\u653f\u533a\u57df\u3092spatialite\u306b\u683c\u7d0d\u3057\u3066\u5229\u7528\u3057\u3066\u307f\u307e\u3059\u3002\n\n###\u56fd\u571f\u6570\u5024\u60c5\u5831\u3067\u5168\u56fd\u306e\u884c\u653f\u533a\u57df\u3092\u53d6\u5f97\u3059\u308b\u3002\n\u307e\u305a\u4e0b\u8a18\u306e\u30da\u30fc\u30b8\u304b\u3089\u5168\u56fd\u306e\u884c\u653f\u533a\u57df\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nhttp://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-N03.html\n\n###\u7a7a\u306eSQLite\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\nspatialite_gui\u3092\u8d77\u52d5\u3057\u3066\u7a7a\u306eSQLite\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n[Creating a New (empty) SQLite DB]\u30a2\u30a4\u30b3\u30f3\u3092\u62bc\u3057\u3066\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n![spatialite001.png](https://qiita-image-store.s3.amazonaws.com/0/47856/1bb96499-6ac4-5423-6aa0-f0e84b564722.png)\n\n\u6b63\u5e38\u306b\u4f5c\u6210\u3055\u308c\u308b\u3068\u3001\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u30d1\u30b9\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n![spatialite002.png](https://qiita-image-store.s3.amazonaws.com/0/47856/a136324a-25b6-2deb-434a-4ecbc46c84cd.png)\n\n\u3053\u3053\u307e\u3067\u306f\u666e\u901a\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u5909\u308f\u308a\u3042\u308a\u307e\u305b\u3093\u3002\n\n###shp\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\n\u56fd\u571f\u6570\u5024\u60c5\u5831\u306eshp\u30d5\u30a1\u30a4\u30eb\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u53d6\u308a\u8fbc\u307f\u307e\u3059\u3002\n\n[Load Shape file]\u30a2\u30a4\u30b3\u30f3\u3092\u62bc\u3057\u3066\u3001\u56fd\u571f\u6570\u5024\u60c5\u5831\u306e\u300cN03-14_140401.shp\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n![spatialite003.png](https://qiita-image-store.s3.amazonaws.com/0/47856/0418627e-11a1-1db2-f549-0bc921aeac62.png)\n\n\n\u3053\u306e\u6642\u3001\u30a8\u30f3\u30b3\u30fc\u30c9\u3092\u805e\u304b\u308c\u308b\u306e\u3067\u300cCP932\u300d\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n![spatialite004.png](https://qiita-image-store.s3.amazonaws.com/0/47856/c6c940b7-0f7b-ae66-3c04-34ecb160899b.png)\n\n\u6b63\u5e38\u306b\u5b8c\u4e86\u3059\u308b\u3068\u300cN03-14_140401\u300d\u3068\u3044\u3046\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n![spatialite005.png](https://qiita-image-store.s3.amazonaws.com/0/47856/3dbc9d6f-5cb4-ff7d-15ca-efe7bf5c796a.png)\n\n###shp\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u4f5c\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u306e\u78ba\u8a8d\n\u3053\u3053\u3067\u306fshp\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u4f5c\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u306e\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3059\u3002\n\u4f5c\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u306e\u5217\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f\u30c6\u30fc\u30d6\u30eb\u3092\u9078\u629e\u3057\u3066\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3092\u62bc\u3057\u3066\u300cShow columns\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n![spatialite006.png](https://qiita-image-store.s3.amazonaws.com/0/47856/c5d78add-2fcd-e5d3-40f9-d2cdaeb2526c.png)\n\n![spatialite007.png](https://qiita-image-store.s3.amazonaws.com/0/47856/954f783c-5542-0380-70ce-cf37f13a7960.png)\n\nN03_001\uff5eN03_004\u306f\u770c\u3001\u533a\u3001\u5e02\u3001N03_007\u306b\u306f\u30b3\u30fc\u30c9\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308bTEXT\u578b\u306e\u5217\u3067\u3059\u3002\nGeometry\u306f\u884c\u653f\u533a\u57df\u306e\u5f62\u304cBlob\u3068\u3057\u3066\u683c\u7d0d\u3055\u308c\u3066\u3044\u3066POLYGON\u3068\u3044\u3046spatiaLite\u304c\u6307\u5b9a\u3057\u305f\u578b\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u4f5c\u6210\u306b\u5b9f\u969b\u3057\u3088\u3046\u3055\u308c\u305fSQL\u6587\u306f\u30c6\u30fc\u30d6\u30eb\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3057\u3066[Show CREATE statement]\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```sql\nCREATE TABLE \"N03-14_140401\" (\n\"PK_UID\" INTEGER PRIMARY KEY AUTOINCREMENT,\n\"N03_001\" TEXT,\n\"N03_002\" TEXT,\n\"N03_003\" TEXT,\n\"N03_004\" TEXT,\n\"N03_007\" TEXT, \n\"Geometry\" POLYGON)\n```\n\n\u3067\u306f\u5b9f\u969b\u306b\u30c6\u30fc\u30d6\u30eb\u306e\u5185\u5bb9\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u306b\u3001SQL\u6587\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```sql\nSELECT * FROM \"N03-14_140401\" LIMIT 10;\n```\n\n![spatialite008.png](https://qiita-image-store.s3.amazonaws.com/0/47856/1c503d9e-da00-287a-14a3-bbb3d3cad9d2.png)\n\n\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\n![spatialite009.png](https://qiita-image-store.s3.amazonaws.com/0/47856/cb4294f1-3a0f-fcd6-5483-e86ef59b646d.png)\n\nPK_UID\uff5eN03_007\u306f\u30c6\u30ad\u30b9\u30c8\u3067\u30c7\u30fc\u30bf\u304c\u8868\u73fe\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001Geometry\u306fBLOB\u30c7\u30fc\u30bf\u306a\u306e\u3067\u4eba\u304c\u898b\u3066\u5185\u5bb9\u304c\u78ba\u8a8d\u3067\u304d\u307e\u305b\u3093\u3002\n\n\u3053\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\u306f\uff12\u901a\u308a\u3042\u308a\u307e\u3059\u3002\n\uff11\u3064\u306fBLOB explore\u3092\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u3067\u3059\u3002\nGeometry\u306e\u5217\u306e\u4efb\u610f\u306e\u30bb\u30eb\u3092\u9078\u629e\u3057\u3066\u53f3\u30af\u30ea\u30c3\u30af\u3092\u62bc\u3057\u300cBLOB explore\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n![spatialite010.png](https://qiita-image-store.s3.amazonaws.com/0/47856/58c8f516-bc86-51ba-103f-ff62362545f7.png)\n\nBLOB explore\u3067\u306f\u30d0\u30a4\u30ca\u30ea\u3001\u753b\u50cf\u3001SVG\u3001GeoJSON\u306a\u3069\u306e\u69d8\u3005\u306a\u5f62\u5f0f\u3067\u30c7\u30fc\u30bf\u3092\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n![spatialite011.png](https://qiita-image-store.s3.amazonaws.com/0/47856/52019b3b-360c-06fa-a0c7-e80f41c1e557.png)\n\nBLOB explore\u3092\u4f7f\u7528\u3057\u306a\u3044\u65b9\u6cd5\u3068\u3057\u3066\u306f\u3001SQL\u3067Geometry\u306e\u5217\u3092\u4efb\u610f\u306e\u5f62\u5f0f\u3067\u8868\u793a\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u4f8b\u3067\u306f\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067Geometry\u5217\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```sql\n-- \u30c7\u30fc\u30bf\u304c\u9577\u3044\u306e\u3067\u6700\u521d\u306e100\u6587\u5b57\u307e\u3067\u8868\u793a\nSELECT substr(ASTEXT(Geometry), 1, 100) FROM \"N03-14_140401\" LIMIT 10;\n```\n\n![spatialite012.png](https://qiita-image-store.s3.amazonaws.com/0/47856/0cedd1d4-b542-a05c-e971-8cee14033e94.png)\n\nASTEXT\u3067POLYGON\u60c5\u5831\u3092\u6587\u5b57\u3068\u3057\u3066\u8868\u793a\u3067\u304d\u307e\u3057\u305f\u3002\u3053\u308c\u306f\u4efb\u610f\u306e\u5f62\u5f0f\u3067\u51fa\u529b\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u305f\u3068\u3048\u3070\u3001ASGEOJSON\u3068\u3057\u305f\u5834\u5408\u306f\u3001GeoJSON\u3068\u3057\u3066\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n```sql\nSELECT substr(ASGEOJSON(Geometry), 1, 100) FROM \"N03-14_140401\" LIMIT 10;\n```\n\n![spatialite013.png](https://qiita-image-store.s3.amazonaws.com/0/47856/aa019d39-461d-861b-83cb-58ea72f5a533.png)\n\nASTEXT\u3084ASGEOJSON\u306eSpatiaLite\u306e\u63d0\u4f9b\u3059\u308b\u95a2\u6570\u306f\u4e0b\u8a18\u306e\u300cSpatial SQL functions reference guide\u300d\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\nhttp://www.gaia-gis.it/gaia-sins/spatialite-sql-4.2.0.html\n\n###\u81ea\u5206\u3067\u5ea7\u6a19\u60c5\u5831\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u307f\u308b\n\u5148\u306e\u4f8b\u3067\u306fshp\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u307e\u3057\u305f\u304c\u3001\u4eca\u56de\u306f\u3001\u5ea7\u6a19\u60c5\u5831\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u81ea\u5206\u3067\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u6771\u4eac\u30bf\u30ef\u30fc\u306a\u3069\u306e\u5730\u7269\u60c5\u5831\u306e\u5ea7\u6a19\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u307e\u305a\u3001\u5730\u7269\u60c5\u5831\u3092\u542b\u307e\u306a\u3044\u5217\u306e\u307f\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```sql\nCREATE TABLE \"places\" (\n\"PK_UID\" INTEGER PRIMARY KEY AUTOINCREMENT,\n\"name\" TEXT)\n```\n\nSQL\u3092\u5b9f\u884c\u3057\u305f\u5f8c\u306b\u3001refresh\u3092\u884c\u3046\u3068\u30c6\u30fc\u30d6\u30eb\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\n![spatialite014.png](https://qiita-image-store.s3.amazonaws.com/0/47856/32608abf-7e38-e535-21a7-e4b11145cd5b.png)\n\n\u6b21\u306b\u3001\u5730\u7269\u60c5\u5831\u3092\u8868\u3059\u5217\u3092AddGeometryColumn()\u3092\u7528\u3044\u3066\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```sql\nSelect AddGeometryColumn ('places', 'Geometry', 0, 'POINT', 'XY')\n```\n\nSQL\u3092\u5b9f\u884c\u3057\u305f\u5f8c\u306b\u3001refresh\u3092\u884c\u3046\u3068\u5217\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3001\u30c6\u30fc\u30d6\u30eb\u306b\u5730\u7403\u306e\u30a2\u30a4\u30b3\u30f3\u304c\u3064\u304d\u307e\u3059\u3002\n\n![sptialite100.png](https://qiita-image-store.s3.amazonaws.com/0/47856/45d8f832-399b-c4e4-62da-883c73c145ec.png)\n\n\n\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3067\u304d\u305f\u3089\u3001\u6b21\u306f\u30c7\u30fc\u30bf\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u4f8b\u3067\u306f\u90fd\u5e81\u306e\u5ea7\u6a19\u3092\u30c6\u30fc\u30d6\u30eb\u306b\u683c\u7d0d\u3057\u3066\u3044\u307e\u3059\u3002\n\n```sql\nINSERT INTO places (name, Geometry) VALUES(\n  '\u90fd\u5e81',\n  GeomFromText('POINT(139.692101 35.689634 )')\n)\n```\n\nGeomFromText\u306f\u6587\u5b57\u5217\u3092Geometry\u306b\u5909\u66f4\u3059\u308b\u95a2\u6570\u3067\u3059\u3002\u4eca\u56de\u306f\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u304b\u3089\u5909\u63db\u3057\u307e\u3057\u305f\u304c\u3001GeomFromGeoJSON\u3001GeomFromKml\u306a\u3069\u3092\u5229\u7528\u3057\u3066GeoJSON\u3084Kml\u304b\u3089\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\u306a\u304a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4e00\u6c17\u306b\u4f5c\u308b\u3068\u3001\u4e00\u898b\u305d\u308c\u3063\u307d\u304f\u52d5\u4f5c\u3057\u307e\u3059\u304c\u3001\u30e1\u30bf\u30c7\u30fc\u30bf\u304c\u95a2\u9023\u4ed8\u3051\u3089\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u308b\u3068\u304d\u306a\u3069\u306b\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u307e\u305b\u3093\u3002\n\n```sql\nCREATE TABLE \"places\" (\n\"PK_UID\" INTEGER PRIMARY KEY AUTOINCREMENT,\n\"name\" TEXT,\n\"Geometry\" POINT)\n```\n\n\n\n###\u5ea7\u6a19\u60c5\u5831\u306b\u5bfe\u3059\u308b\u691c\u7d22\n\u3053\u3053\u3067\u306f\u5ea7\u6a19\u60c5\u5831\u306b\u3064\u3044\u3066\u691c\u7d22\u3057\u307e\u3059\u3002\nplaces\u30c6\u30fc\u30d6\u30eb\u3067\u6307\u5b9a\u3057\u305f\u5ea7\u6a19\u304c\u3001\u3069\u306e\u884c\u653f\u533a\u753b\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u304b\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\n\n```sql\nSELECT\n  name, \"N03-14_140401\".*\nFROM\n \"N03-14_140401\"\nINNER JOIN places ON\n Contains(\"N03-14_140401\".Geometry, places.Geometry)\n```\n\nContains\u95a2\u6570\u306f\u7b2c\u4e00\u5f15\u6570\u306e\u7bc4\u56f2\u306b\u7b2c\u4e8c\u5f15\u6570\u306e\u9818\u57df\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u304b\u8abf\u3079\u307e\u3059\u3002\n\u3053\u306e\u7d50\u679c\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n![spatialite015.png](https://qiita-image-store.s3.amazonaws.com/0/47856/009ed694-9481-cda0-9be6-bb279248c26d.png)\n\n\u90fd\u5e81\u306f\u65b0\u5bbf\u533a\u306b\u3042\u308b\u306e\u3067\u671f\u5f85\u3069\u304a\u308a\u306e\u7d50\u679c\u3068\u3044\u3048\u308b\u3067\u3057\u3087\u3046\u3002\n\u5148\u306e\u4f8b\u3067\u306f\u30c6\u30fc\u30d6\u30eb\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3067\u691c\u7d22\u3057\u307e\u3057\u305f\u304c\u3001\u76f4\u63a5WHERE\u533a\u306b\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\n\n```sql\nSELECT\n  *\nFROM\n \"N03-14_140401\"\nWHERE\n  Contains(\"N03-14_140401\".Geometry,GeomFromText('POINT(139.692101 35.689634 )'))\n```\n\n###MBR\u3068\u5927\u307e\u304b\u306a\u691c\u7d22\n\u5148\u307b\u3069\u306e\u691c\u7d22\u306f\u5404\u5ea7\u6a19\u306b\u3064\u3044\u3066\u6b63\u78ba\u306b\u691c\u7d22\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u5927\u307e\u304b\u306a\u4f4d\u7f6e\u3092\u65e9\u304f\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u5834\u5408\u306f\u3001Minimum Bounding Rectangle - MBR\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\nMBR\u306fGEOMETRY\u306e\u304a\u304a\u307e\u304b\u306a\u5927\u304d\u3055\u3092\u8868\u3059\u3082\u306e\u3067\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8907\u96d1\u306a\u56f3\u5f62\u3092\u8d64\u3044\u67a0\u7dda\u306e\u56f3\u5f62\u3068\u307f\u306a\u3057\u307e\u3059\u3002\n\n![spatialite016.png](https://qiita-image-store.s3.amazonaws.com/0/47856/bec3dd45-0c8c-12ea-5061-ba571c8aac2f.png)\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u4e0d\u6b63\u78ba\u3067\u306f\u3042\u308b\u304c\u3001\u65e9\u3044\u691c\u7d22\u304c\u884c\u3048\u307e\u3059\u3002\nGEOMETRY\u304b\u3089MBR\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f Envelope()\u3092\u7528\u3044\u307e\u3059\u3002\n\n```sql\nSELECT\n   ASTEXT(Envelope(Geometry))\nFROM\n \"N03-14_140401\"\nLIMIT 10\n```\n\n\u3053\u306e\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5358\u7d14\u306a\u56f3\u5f62\u306b\u306a\u308a\u307e\u3059\u3002\n![spatialite017.png](https://qiita-image-store.s3.amazonaws.com/0/47856/a0ae8048-3435-1f9c-e489-18e0550541df.png)\n\n\u3067\u306f\u3001\u5148\u307b\u3069\u3068\u540c\u3058\u90fd\u5e81\u3092\u542b\u3080\u5ea7\u6a19\u3092MBR\u3092\u5229\u7528\u3057\u3066\u691c\u7d22\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```sql\nSELECT\n  *\nFROM\n \"N03-14_140401\"\nWHERE\n  MBRContains(\"N03-14_140401\".Geometry,GeomFromText('POINT(139.692101 35.689634 )'))\n```\n\n\u691c\u7d22\u901f\u5ea6\u304c\u5411\u4e0a\u3057\u305f\u304b\u308f\u308a\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3001\u4e0d\u8981\u306a\u30c7\u30fc\u30bf\u3082\u62bd\u51fa\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u307e\u3059\u3002\n\n![spatialite018.png](https://qiita-image-store.s3.amazonaws.com/0/47856/6bd04ff4-7498-d95a-089b-746b6f5a0914.png)\n\n###RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5229\u7528\u3057\u305f\u691c\u7d22\n\u901a\u5e38\u3001DB\u3092\u6271\u3046\u5834\u5408\u3001\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u691c\u7d22\u901f\u5ea6\u304c\u5411\u4e0a\u3057\u307e\u3059\u3002\n\u6b8b\u5ff5\u306a\u3053\u3068\u306b\u3001\u6587\u5b57\u3084\u6570\u5024\u306b\u4ed8\u4e0e\u3067\u304d\u308b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092Geometry\u306b\u4ed8\u4e0e\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\u3057\u304b\u3057\u306a\u304c\u3089\u3001SpatiaLite\u306fSQLite\u306eRTree\u3092\u5229\u7528\u3057\u3066\u3001RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n **Wonderful R*Tree Spatial Index**\nhttp://www.gaia-gis.it/gaia-sins/spatialite-cookbook/html/rtree.html\n\nRTree\u306e\u6982\u8981\u3068\u3057\u3066\u306f\u3001Geometry\u3092MBR\u3092\u3064\u304b\u3063\u3066\u56db\u89d2\u5f62(rectangle)\u306b\u3057\u3001\u305d\u306e\u56db\u89d2\u5f62\u306e\u4ea4\u308f\u308a\u306b\u5fdc\u3058\u3066\u30c4\u30ea\u30fc\u3092\u4f5c\u308a\u3001\u691c\u7d22\u3057\u3084\u3059\u304f\u3057\u3066\u3044\u307e\u3059\u3002\nrectangle\u3092\u4f7f\u3063\u305f\u30c4\u30ea\u30fc\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u306e\u3067RTree index\u3068\u8a00\u308f\u308c\u307e\u3059\u3002\n\n####RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u4f5c\u6210\u3068\u5229\u7528\n\u3067\u306f\u3001RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5b9f\u969b\u4f7f\u7528\u3057\u3066\u307f\u307e\u3059\u3002\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210\u3059\u308b\u306b\u306fCreateSpatialIndex\u95a2\u6570\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u7b2c\u4e00\u5f15\u6570\u306b\u30c6\u30fc\u30d6\u30eb\u540d\u3001\u7b2c\u4e8c\u5f15\u6570\u306b\u5217\u540d\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```sql\nSELECT CreateSpatialIndex(\"N03-14_140401\", \"Geometry\") ;\n```\n\n\u6b63\u5e38\u306b\u4f5c\u6210\u3067\u304d\u305f\u5834\u5408\u306f\u30011\u304c\u8fd4\u308a\u3001refresh\u5f8c\u306bSpatialIndex\u306b\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u304c\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n![spatialite019.png](https://qiita-image-store.s3.amazonaws.com/0/47856/69b33707-10f5-2918-c61b-71e6d05acafc.png)\n\n![spatialite020.png](https://qiita-image-store.s3.amazonaws.com/0/47856/affa8866-87f3-5cb6-0908-5fd4a0d4177a.png)\n\n\nRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u4ee5\u4e0b\u306e\uff14\u3064\u306e\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n\u30fbidx_N03-14_140401_Geometry\n\u30fbidx_N03-14_140401_Geometry_node\n\u30fbidx_N03-14_140401_Geometry_parent\n\u30fbidx_N03-14_140401_Geometry_rowid\n\nidx_N03-14_140401_Geometry\u4ee5\u5916\u306f\u5185\u90e8\u3067\u4f7f\u7528\u3059\u308b\u30c6\u30fc\u30d6\u30eb\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u30e6\u30fc\u30b6\u30fc\u304c\u76f4\u63a5\u64cd\u4f5c\u3059\u308b\u3053\u3068\u3092\u671f\u5f85\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\nidx_N03-14_140401_Geometry\u306fVIRTUAL TABLE\u306b\u306a\u3063\u3066\u304a\u308a\u3001\u5b9f\u969b\u306b\u306f\u5185\u90e8\u30c6\u30fc\u30d6\u30eb\u3092\u5229\u7528\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n\u3067\u306f\u3001idx_N03-14_140401_Geometry\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```sql\nSELECT * FROM \"idx_N03-14_140401_Geometry\" LIMIT 10;\n```\n\n\u3053\u306e\u3088\u3046\u306b\u5404\u30ec\u30b3\u30fc\u30c9\u306eMRB\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n![spatialite021.png](https://qiita-image-store.s3.amazonaws.com/0/47856/a463a883-5e38-8fd9-2c3e-80f0f9b3874f.png)\n\n\u30e6\u30fc\u30b6\u306f\u3053\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u306e\u4e2d\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30d5\u30a3\u30eb\u30bf\u30fc\u3092\u3057\u3001\u7d50\u679c\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```sql\nSELECT \n  * \nFROM \"N03-14_140401\"\nWHERE ROWID IN(\n  SELECT\n    pkid\n  FROM\n   \"idx_N03-14_140401_Geometry\"\n  WHERE\n    MBRContains(\n      BuildMBR(xmin,ymin,xmax,ymax),\n      GeomFromText('POINT(139.692101 35.689634 )')\n  )\n) AND Contains(Geometry, \n  GeomFromText('POINT(139.692101 35.689634 )')\n)\n```\n\n\u901a\u5e38\u306e\u691c\u7d22\u3088\u308a\u65e9\u304f\u6b63\u78ba\u306a\u30c7\u30fc\u30bf\u304c\u53d6\u5f97\u3067\u304d\u305f\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u3053\u308c\u306f\u30c7\u30fc\u30bf\u6570\u304c\u591a\u304f\u306a\u308c\u3070\u3001\u306a\u308b\u307b\u3069\u305d\u306e\u5dee\u304c\u5927\u304d\u304f\u73fe\u308c\u307e\u3059\u3002\n\n\u3053\u306e\u3088\u3046\u306bRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306f\u901a\u5e38\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3068\u9055\u3044\u3001\u5b9f\u30c6\u30fc\u30d6\u30eb\u306bSQL\u3092\u5b9f\u884c\u3057\u305f\u3060\u3051\u3067\u306f\u9069\u7528\u3055\u308c\u305a\u306b\u3001\u4f5c\u6210\u3055\u308c\u305fVIRTUAL TABLE\u3092\u5229\u7528\u3057\u3066\u30b5\u30d6\u30af\u30a8\u30ea\u2015\u3084JOIN\u3067\u30c7\u30fc\u30bf\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u5f79\u5272\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u5225\u30c6\u30fc\u30d6\u30eb\u3067\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u7ba1\u7406\u3057\u3066\u3044\u308b\u3053\u3068\u3067\u3001\u5b9f\u30c6\u30fc\u30d6\u30eb\u304c\u66f4\u65b0\u3055\u308c\u305f\u6642\u306b\u4e0d\u4e00\u81f4\u304c\u3067\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3068\u3044\u3046\u7591\u554f\u3092\u3082\u3064\u3067\u3057\u3087\u3046\u3002\n\u3057\u304b\u3057\u3001CreateSpatialIndex\u3092\u5b9f\u884c\u3057\u305f\u6642\u306b\u30c8\u30ea\u30ac\u30fc\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u30e6\u30fc\u30b6\u306f\u4e00\u5207\u624b\u3092\u52a0\u3048\u305a\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3068\u30c6\u30fc\u30d6\u30eb\u306e\u540c\u671f\u304c\u3068\u308c\u307e\u3059\u3002\n\n\u3053\u306e\u30c8\u30ea\u30ac\u30fc\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f\u6b21\u306e\u3088\u3046\u306aSQL\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```sql\nselect name  from sqlite_master where type = 'trigger' and tbl_name='N03-14_140401';\n```\n\n\u4eca\u56de\u306f\u6b21\u306e\u3088\u3046\u306a\u30c8\u30ea\u30ac\u30fc\u304c\u81ea\u52d5\u3067\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u30fbggi_N03-14_140401_Geometry\n\u30fbggu_N03-14_140401_Geometry\n\u30fbgii_N03-14_140401_Geometry\n\u30fbgiu_N03-14_140401_Geometry\n\u30fbgid_N03-14_140401_Geometry\n\n\n####RTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u524a\u9664\n\u4f5c\u6210\u3057\u305fRTree\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u524a\u9664\u3059\u308b\u306b\u306f\u3001DisableSpatialIndex\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```sql\nSELECT DisableSpatialIndex(\"N03-14_140401\", \"Geometry\") ;\n```\n\nrefresh\u3092\u5b9f\u884c\u3059\u308b\u3068Spatial Index\u304c\u524a\u9664\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n![spatialite022.png](https://qiita-image-store.s3.amazonaws.com/0/47856/9c3b455c-792d-669a-3bc3-64fe1f6c1f07.png)\n\n##python\u304b\u3089\u306e\u5229\u7528\npython\u304b\u3089SpatiaLite\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001SQLite\u304c\u9069\u5207\u306b\u5229\u7528\u3067\u304d\u308b\u72b6\u6cc1\u306a\u3089\u7c21\u5358\u306b\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\nPython\u304c\u4f7f\u3063\u3066\u3044\u308bSqlite3\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u6b21\u306e\u624b\u9806\u3067\u8abf\u3079\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```py\nimport sqlite3\nprint (sqlite3.sqlite_version_info)\n```\n\n\u3082\u3057\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u306f\u3001SQLITE\u3092\u66f4\u65b0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nWindows\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u30d5\u30a9\u30eb\u30c0\u306eDLL\u3092\u66f8\u304d\u63db\u3048\u308b\u3068\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n\nC:\\Python27\\DLLs\\sqlite3.dll\n\n\u4ee5\u4e0b\u306fPython\u3067\u306e\u30b3\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002\n\n```py\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\nimport sqlite3\nimport os\n\n# mod_spatialite\u306e\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u3092PATH\u306b\u52a0\u3048\u308b\nos.environ[\"PATH\"] = os.environ[\"PATH\"] + ';C:\\\\tool\\\\spatialite\\\\mod_spatialite-4.2.0-win-x86'\ncnn = sqlite3.connect('database/gyouseikuiki.sqlite')\n\n# mod_spatialite\u306e\u8aad\u307f\u8fbc\u307f\ncnn.enable_load_extension(True)\ncnn.execute(\"SELECT load_extension('./mod_spatialite-4.2.0-win-x86/mod_spatialite.dll');\")\nsql = \"\"\"\nSELECT\n  N03_001,\n  N03_002,\n  N03_003,\n  N03_004,\n  N03_007, \n  AsGeoJson(Geometry)\nFROM\n \"N03-14_140401\"\nWHERE\n  MBRContains(\"N03-14_140401\".Geometry,GeomFromText('POINT(139.692101 35.689634 )'))\n\"\"\"\n\nret = cnn.execute(sql)\nfor r in ret:\n  print('----------------------------')\n  print(r[0].encode('utf_8') )\n  print(r[1].encode('utf_8') )\n  print(r[2].encode('utf_8') )\n  print(r[3].encode('utf_8') )\n  print(r[4].encode('utf_8') )\n  print(r[5].encode('utf_8') )\n```\n\n\u74b0\u5883\u5909\u6570\u3092mod_spatialite\u306e\u3042\u308b\u30d1\u30b9\u306b\u901a\u3057\u3001enable_load_extension\u3067\u62e1\u5f35DLL\u306e\u4f7f\u7528\u3092\u8a31\u53ef\u3057\u3066\u304b\u3089\u3001mod_spatialite\u3092\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n\u3042\u3068\u306f\u3001\u901a\u5e38\u901a\u308aSQL\u304c\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\n###enable_load_extension\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\u5834\u5408\nenable_load_extension\u3092\u4f7f\u7528\u3057\u305f\u6642\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\n```\n\"'sqlite3.Connection' object has no attribute 'enable_load_extension'\"\n```\n\n\u539f\u56e0\u3068\u3057\u3066\u3001MaxOS\u3084Debian\u306a\u3069\u306e\u3044\u304f\u3064\u304b\u306eOS\u306b\u30d7\u30ea\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308bPython\u306f\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u3001\u62e1\u5f35\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f\u6a5f\u80fd\u3092\u7121\u52b9\u306b\u3057\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\n\nhttps://docs.python.org/2/library/sqlite3.html#f1\n\n\u3053\u308c\u306b\u5bfe\u5fdc\u3059\u308b\u306b\u306fPython\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u304a\u3059\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u3001Python\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b\u3001setup.py\u3092\u624b\u3067\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nSQLITE_OMIT_LOAD_EXTENSION\u3092\u691c\u7d22\u3057\u3066\u3001\u305d\u306e\u884c\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u3001./configure, make, make install \u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\u3082\u3057\u3001make install \u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u5834\u5408\u306f\u3001make install\u6642\u306b\u30a8\u30e9\u30fc\u304c\u3067\u308b\u306a\u3089\u300cmake -i altinstall\u300d\u3092\u305f\u3081\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\nhttp://python.g.hatena.ne.jp/nelnal_programing/20101026/1288084718\n\n###Peewee\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\nORM\u3067\u3042\u308bPeewee\u30e9\u30a4\u30d6\u30e9\u30ea\u3067spatialite\u3092\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nhttp://qiita.com/mima_ita/items/9d4e1d0afac1865acdbb#spatialitesql%E3%81%B8%E3%81%AE%E6%8E%A5%E7%B6%9A%E6%96%B9%E6%B3%95\n\n##php\u304b\u3089\u306e\u5229\u7528\nWindows+PHP\u306e\u5834\u5408\u3001\u7c21\u5358\u306b\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u8a73\u7d30\u306f\u4e0b\u8a18\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nPHP\u3067\u5730\u56f3\u3068\u304b\u306e\u7a7a\u9593\u60c5\u5831\u3092DB\u306b\u683c\u7d0d\u3057\u3088\u3046\u3068\u3057\u3066Spatialite\u3092\u4f7f\u3046\u3068\u82e6\u52b4\u3059\u308b\nhttp://qiita.com/mima_ita/items/1a90de89f0a194ba843e\n\n\n##\u305d\u306e\u4ed6Tip\n###\u6e2c\u5730\u7cfb\u306e\u5909\u63db\u3092Spatialite\u3092\u4f7f\u3063\u3066\u884c\u3046\nTransform\u95a2\u6570\u3092\u4f7f\u3046\u3068\u6e2c\u5730\u7cfb\u306e\u5909\u63db\u304c\u884c\u3048\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u4f8b\u3067\u306fJGD2000/\u5e73\u9762\u76f4\u89d2\u5ea7\u6a19\u7cfb6\u3092\u4e16\u754c\u6e2c\u5730\u7cfb\u306b\u5909\u63db\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\nselect AsText(Transform(GeomFromText('POINT(-4408.916645 -108767.765479)', 2448), 4326))\n```\n\n##\u53c2\u8003\n **SpatiaLite 4.2.0  SQL functions reference list** \nhttp://www.gaia-gis.it/gaia-sins/spatialite-sql-4.2.0.html\n\n **The SpatiaLite Cookbook** \nhttp://www.gaia-gis.it/gaia-sins/spatialite-cookbook/index.html\n\n **A quick tutorial to SpatiaLite - a Spatial extension for SQLite(\u53e4\u3044\u304c\u6709\u7528)** \nhttp://www.gaia-gis.it/gaia-sins/spatialite-tutorial-2.3.1.html\n", "tags": ["SQLite3", "Python", "\u5730\u56f3"]}