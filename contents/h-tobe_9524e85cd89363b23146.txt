{"context": "\n\n\u733f\u304c\u7ba1\u7406\u3059\u308bElastic BeanStalk\n\u3076\u3063\u3061\u3083\u3051\u30d6\u30e9\u30a6\u30b6\u4e0a\u3067\u4e00\u56de\u66f8\u3044\u3066\u3066BackSpace\u62bc\u3057\u305f\u3089\u751f\u5730\u304c\u5168\u90e8\u6d88\u3048\u3066\u3084\u308b\u6c17\u304c\u7121\u304f\u306a\u308b\u75c5\u304c\u767a\u751f\u4e2d\n\u306a\u3093\u3067\u52a0\u7b46\u3059\u308b\u3051\u3069\u3053\u3093\u306a\u3093\u3092\u3068\u308a\u3042\u3048\u305a\u306f\u3063\u3064\u3051\u3066\u304a\u304f\n\n\u524d\u63d0\n\nElasticBeanStalk\u4e0a\u3067\u8907\u6570\u306eApplication\u3092\u7ba1\u7406\u3057\u3066\u3044\u308b\n\u307e\u305f\u3001\u305d\u306e\u74b0\u5883\u5185\u306b\u8907\u6570Environment\u30bb\u30c3\u30c8\u3092\u904b\u7528\u3057\u3066\u3044\u308b\n\u904b\u7528\u3057\u3066\u3044\u308bEnvironment\u306f\u4e0b\u8a18\u306e\u901a\u308a\n\n\nDEVELOP : DEV :: x-dev-stage-[XXX] \u3068\u3044\u3046\u540d\u79f0\u306eApplication\nDEMO : DEMO :: stage-[XXX] \u3068\u3044\u3046\u540d\u79f0\u306eApplication\nSTAGING : STG :: stage-[XXX] \u3068\u3044\u3046\u540d\u79f0\u306eApplication\nPRODUCTION : PROD :: stage-[XXX] \u3068\u3044\u3046\u540d\u79f0\u306eApplication\n\n\n\n\n\u4f5c\u6587\u4f8b\n#!/bin/bash\n\nbase_dir=\"/home/<fuge>/Components\"\n\ncase \"${1}\" in\n  \"prod\" | \"production\" |\"PROD\" ) \n        STAGE=\"PROD\" ;;\n  \"demo\" | \"DEMO\" )\n        STAGE=\"DEMO\" ;;\n  \"stg\" | \"STG\" | \"staging\" )\n        STAGE=\"STG\" ;;\n  \"dev\" | \"DEV\" )\n        STAGE=\"DEV\" ;;\n  \"\" ) \n        PS3=\"What Enviroment do you deploy? >\"\n        echo ${PS3}\n        ans1=\"production\"\n        ans2=\"demo\"\n        ans3=\"staging\"\n        ans4=\"develop\"\n\n       select ANS in \"$ans1\" \"$ans2\" \"$ans3\" \"$ans4\"\n       do\n         if [ -z \"$ANS\" ]; then\n           continue\n         else\n           break\n         fi\n       done\n      if [ ${REPLY} == \"1\" ];then\n         STAGE=\"PROD\"\n      elif [ ${REPLY} == \"2\" ];then\n         STAGE=\"DEMO\"\n      elif [ ${REPLY} == \"3\" ];then\n         STAGE=\"STG\"\n      elif [ ${REPLY} == \"4\" ];then\n         STAGE=\"DEV\"\n      fi\n\n     echo You selected $REPLY\\) $ANS ;;\n\nesac\n\nif [ $STAGE = \"DEV\" ]; then\n\u3000app_ary=( x-dev-stage-1 x-dev-stage-2 x-dev-stage-3 x-dev-stage-4 x-stage-n )\nelif [ $STAGE = \"STG\" -o $STAGE = \"DEMO\" -o $STAGE = \"PROD\" ]; then\n\u3000app_ary=( stage-1 stage-2 stage-3 stage-4 stage-5 )\nfi\n\n\ndeclare -a env_ary=()\n\nif [ $STAGE = \"DEV\" -o $STAGE = \"STG\" ]; then\nall_env=( \\\n  ENV_1='\u306a\u3093\u304b\u5024_A1' \\\n  ENV_2='\u306a\u3093\u304b\u5024_A2' \\\n  ENV_3='\u306a\u3093\u304b\u5024_A3' \\\n  ENV_4='\u306a\u3093\u304b\u5024_A4' \\\n  ENV_5='\u306a\u3093\u304b\u5024_A5' \\\n)\n\nelif [ $STAGE = \"DEMO\" -o $STAGE = \"PROD\" ]; then\nall_env=( \\\n  ENV_1='\u306a\u3093\u304b\u5024_B1' \\\n  ENV_2='\u306a\u3093\u304b\u5024_B2' \\\n  ENV_3='\u306a\u3093\u304b\u5024_B3' \\\n  ENV_4='\u306a\u3093\u304b\u5024_B4' \\\n  ENV_5='\u306a\u3093\u304b\u5024_B5' \\\n)\nfi\n\nfor ((i = 0; i < ${#app_ary[@]}; i++)) {\n    echo \"### Start start ENV VALUE ###\"\n    cd ${base_dir}/${app_ary[$i]}\n    pwd\n\n  if [ $STAGE = \"STG\" -o $STAGE = \"DEMO\" -o $STAGE = \"PROD\" ]; then\n     TARGET_NAME=`eb list | grep ${STAGE}-`\n     TARGET_NAME=${TARGET_NAME#\\*}\n     ENV_OPTION=\"-e ${TARGET_NAME}\"\n  else\n     TARGET_NAME=\"\"\n     ENV_OPTION=\"\"\n  fi\n    echo \"eb setenv ${all_env[@]} ${TARGET_NAME}\"\n    eb setenv ${all_env[@]} ${ENV_OPTION}\n    cd -\n    echo \"#### Finish !! ###\"\n}\n\n\n\u3053\u308c\u3067\u8907\u6570\u306eapplication\u74b0\u5883\u3000\u307e\u305f\u305d\u306e\u74b0\u5883\u5185\u306b\u542b\u307e\u308c\u308b\u8907\u6570\u306eEnvironment\u306b\u5bfe\u3057\u3066\u4e00\u6c17\u306b\u74b0\u5883\u5909\u6570\u3092\u30bb\u30c3\u30c8\u3067\u304d\u308b\n\u74b0\u5883\u5909\u6570\u90e8\u5206\uff08\u306a\u3093\u304b\u5024_XX\uff09\u3068\u304b\u306f\u5897\u6e1b\u3055\u305b\u308b\u306a\u308a\u5916\u90e8\u30d5\u30a1\u30a4\u30eb\u5316\u3057\u3066\u304a\u3051\u3070\u5e78\u305b\n#\u733f\u304c\u7ba1\u7406\u3059\u308bElastic BeanStalk\n\n\u3076\u3063\u3061\u3083\u3051\u30d6\u30e9\u30a6\u30b6\u4e0a\u3067\u4e00\u56de\u66f8\u3044\u3066\u3066BackSpace\u62bc\u3057\u305f\u3089\u751f\u5730\u304c\u5168\u90e8\u6d88\u3048\u3066\u3084\u308b\u6c17\u304c\u7121\u304f\u306a\u308b\u75c5\u304c\u767a\u751f\u4e2d\n\n\u306a\u3093\u3067\u52a0\u7b46\u3059\u308b\u3051\u3069\u3053\u3093\u306a\u3093\u3092\u3068\u308a\u3042\u3048\u305a\u306f\u3063\u3064\u3051\u3066\u304a\u304f\n\n##\u524d\u63d0\n- ElasticBeanStalk\u4e0a\u3067\u8907\u6570\u306eApplication\u3092\u7ba1\u7406\u3057\u3066\u3044\u308b\n- \u307e\u305f\u3001\u305d\u306e\u74b0\u5883\u5185\u306b\u8907\u6570Environment\u30bb\u30c3\u30c8\u3092\u904b\u7528\u3057\u3066\u3044\u308b\n- \u904b\u7528\u3057\u3066\u3044\u308bEnvironment\u306f\u4e0b\u8a18\u306e\u901a\u308a\n\t- DEVELOP : DEV :: x-dev-stage-[XXX] \u3068\u3044\u3046\u540d\u79f0\u306eApplication\n\t- DEMO : DEMO :: stage-[XXX] \u3068\u3044\u3046\u540d\u79f0\u306eApplication\n\t- STAGING : STG :: stage-[XXX] \u3068\u3044\u3046\u540d\u79f0\u306eApplication\n\t- PRODUCTION : PROD :: stage-[XXX] \u3068\u3044\u3046\u540d\u79f0\u306eApplication\n\n### \u4f5c\u6587\u4f8b\n```\n#!/bin/bash\n\nbase_dir=\"/home/<fuge>/Components\"\n\ncase \"${1}\" in\n  \"prod\" | \"production\" |\"PROD\" ) \n        STAGE=\"PROD\" ;;\n  \"demo\" | \"DEMO\" )\n        STAGE=\"DEMO\" ;;\n  \"stg\" | \"STG\" | \"staging\" )\n        STAGE=\"STG\" ;;\n  \"dev\" | \"DEV\" )\n        STAGE=\"DEV\" ;;\n  \"\" ) \n        PS3=\"What Enviroment do you deploy? >\"\n        echo ${PS3}\n        ans1=\"production\"\n        ans2=\"demo\"\n        ans3=\"staging\"\n        ans4=\"develop\"\n       \n       select ANS in \"$ans1\" \"$ans2\" \"$ans3\" \"$ans4\"\n       do\n         if [ -z \"$ANS\" ]; then\n           continue\n         else\n           break\n         fi\n       done\n      if [ ${REPLY} == \"1\" ];then\n         STAGE=\"PROD\"\n      elif [ ${REPLY} == \"2\" ];then\n         STAGE=\"DEMO\"\n      elif [ ${REPLY} == \"3\" ];then\n         STAGE=\"STG\"\n      elif [ ${REPLY} == \"4\" ];then\n         STAGE=\"DEV\"\n      fi\n\n     echo You selected $REPLY\\) $ANS ;;\n\nesac\n\nif [ $STAGE = \"DEV\" ]; then\n\u3000app_ary=( x-dev-stage-1 x-dev-stage-2 x-dev-stage-3 x-dev-stage-4 x-stage-n )\nelif [ $STAGE = \"STG\" -o $STAGE = \"DEMO\" -o $STAGE = \"PROD\" ]; then\n\u3000app_ary=( stage-1 stage-2 stage-3 stage-4 stage-5 )\nfi\n\n\ndeclare -a env_ary=()\n\nif [ $STAGE = \"DEV\" -o $STAGE = \"STG\" ]; then\nall_env=( \\\n  ENV_1='\u306a\u3093\u304b\u5024_A1' \\\n  ENV_2='\u306a\u3093\u304b\u5024_A2' \\\n  ENV_3='\u306a\u3093\u304b\u5024_A3' \\\n  ENV_4='\u306a\u3093\u304b\u5024_A4' \\\n  ENV_5='\u306a\u3093\u304b\u5024_A5' \\\n)\n\nelif [ $STAGE = \"DEMO\" -o $STAGE = \"PROD\" ]; then\nall_env=( \\\n  ENV_1='\u306a\u3093\u304b\u5024_B1' \\\n  ENV_2='\u306a\u3093\u304b\u5024_B2' \\\n  ENV_3='\u306a\u3093\u304b\u5024_B3' \\\n  ENV_4='\u306a\u3093\u304b\u5024_B4' \\\n  ENV_5='\u306a\u3093\u304b\u5024_B5' \\\n)\nfi\n\nfor ((i = 0; i < ${#app_ary[@]}; i++)) {\n    echo \"### Start start ENV VALUE ###\"\n    cd ${base_dir}/${app_ary[$i]}\n    pwd\n\n  if [ $STAGE = \"STG\" -o $STAGE = \"DEMO\" -o $STAGE = \"PROD\" ]; then\n     TARGET_NAME=`eb list | grep ${STAGE}-`\n     TARGET_NAME=${TARGET_NAME#\\*}\n     ENV_OPTION=\"-e ${TARGET_NAME}\"\n  else\n     TARGET_NAME=\"\"\n     ENV_OPTION=\"\"\n  fi\n    echo \"eb setenv ${all_env[@]} ${TARGET_NAME}\"\n    eb setenv ${all_env[@]} ${ENV_OPTION}\n    cd -\n    echo \"#### Finish !! ###\"\n}\n\n```\n\n\u3053\u308c\u3067\u8907\u6570\u306eapplication\u74b0\u5883\u3000\u307e\u305f\u305d\u306e\u74b0\u5883\u5185\u306b\u542b\u307e\u308c\u308b\u8907\u6570\u306eEnvironment\u306b\u5bfe\u3057\u3066\u4e00\u6c17\u306b\u74b0\u5883\u5909\u6570\u3092\u30bb\u30c3\u30c8\u3067\u304d\u308b\n\u74b0\u5883\u5909\u6570\u90e8\u5206\uff08\u306a\u3093\u304b\u5024_XX\uff09\u3068\u304b\u306f\u5897\u6e1b\u3055\u305b\u308b\u306a\u308a\u5916\u90e8\u30d5\u30a1\u30a4\u30eb\u5316\u3057\u3066\u304a\u3051\u3070\u5e78\u305b\n", "tags": ["AWS", "ElasticBeanstalk", "eb-cli"]}