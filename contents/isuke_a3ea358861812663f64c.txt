{"context": "HasLogs\u3068\u3044\u3046ActiveRecord\u306e\u30ed\u30b0\u3092\u53d6\u308bgem\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\nhttps://github.com/isuke/has_logs\n\u3053\u306egem\u306f\u30d9\u30fc\u30bf\u7248\u3067\u3059\u3002\u30d0\u30b0\u3084\u7834\u58ca\u7684\u306a\u4ed5\u69d8\u5909\u66f4\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u52d5\u6a5f\nActiveRecord\u306e\u30ed\u30b0\u3092\u53d6\u308bgem\u306faudited\u3084paper_trail\u306a\u3069\u3042\u308a\u307e\u3059\u304c\u3001\u3044\u305a\u308c\u3082yml\u3084json\u306b\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u3057\u3066\u4fdd\u5b58\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u30ed\u30b0\u306e\u691c\u7d22\u6a5f\u80fd\u304c\u307b\u3057\u3044\u3068\u304d\u306b\u56f0\u308a\u307e\u3059\u3088\u306d\u3002\n\u305d\u3053\u3067\u3001\u30ed\u30b0\u30c6\u30fc\u30d6\u30eb\u306b\u30ed\u30b0\u3092\u53d6\u308bgem\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\nUsage\narticles\u3068\u3044\u3046\u30c6\u30fc\u30d6\u30eb\u306e\u30ed\u30b0\u3092\u53d6\u308b\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306amigration\u3092\u66f8\u304d\u307e\u3059\u3002\nclass CreateAllTables < ActiveRecord::Migration\n  def self.up\n    create_table(:articles) do |t|\n      t.timestamps\n    end\n\n    create_table(:article_logs) do |t|\n      t.integer :article_id, null: false\n      t.string :title, null: false\n      t.text :content\n      t.boolean :public, null: false, default: true\n      t.datetime :created_at\n    end\n    add_index :article_logs,  :article_id\n    add_index :article_logs, [:article_id, :created_at], unique: true\n  end\nend\n\narticles\u30c6\u30fc\u30d6\u30eb\u304c(timestamps\u4ee5\u5916)\u304b\u3089\u3063\u307d\u306a\u306e\u304c\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002\n\u6b21\u306bModel\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nclass Article < ActiveRecord::Base\n  has_logs\nend\n\nclass ArticleLog < ActiveRecord::Base\n  act_as_log\nend\n\n\u4f7f\u3063\u3066\u898b\u307e\u3057\u3087\u3046\u3002\narticle = Article.create(title: 'test1', content: 'demo1', public: false)\narticle.attributes =   { title: 'test2', content: 'demo2', public: false } ; article.save!\narticle.attributes =   { title: 'test3', content: 'demo3', public: true  } ; article.save!\n\narticle.title\n=> 'test3'\n\narticle.logs\n=> [#<ArticleLog id: 1, article_id: 1, title: \"test1\", content: \"demo1\", created_at: \"2015-01-04 03:36:51\">,\n #<ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\">,\n #<ArticleLog id: 3, article_id: 1, title: \"test3\", content: \"demo3\", created_at: \"2015-01-04 03:36:51\">]\n\narticle.oldest_log\n=> #<ArticleLog id: 1, article_id: 1, title: \"test1\", content: \"demo1\", created_at: \"2015-01-04 03:36:51\">\n\narticle.latest_log\n=> #<ArticleLog id: 3, article_id: 1, title: \"test3\", content: \"demo3\", created_at: \"2015-01-04 03:36:51\">\n\narticle.oldest_log.next\n=> #<ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\">\n\narticle.latest_log.prev\n=> #<ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\">\n\n\u3044\u3044\u611f\u3058\u3067\u3059\u3002\nDB\u4e0a\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\narticles\n\n\n\nid\ntitle\n\n\n\n\n1\ntitle\n\n\n\n\narticle_logs\n\n\n\nid\narticle_id\ntitle\ncontent\npublic\n\n\n\n\n1\n1\ntest1\ndemo1\n0\n\n\n2\n1\ntest2\ndemo2\n0\n\n\n3\n1\ntest3\ndemo3\n1\n\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002\u3088\u304b\u3063\u305f\u3089\u4f7f\u3063\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nHasLogs\u3068\u3044\u3046ActiveRecord\u306e\u30ed\u30b0\u3092\u53d6\u308bgem\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\nhttps://github.com/isuke/has_logs\n\n**\u3053\u306egem\u306f\u30d9\u30fc\u30bf\u7248\u3067\u3059\u3002\u30d0\u30b0\u3084\u7834\u58ca\u7684\u306a\u4ed5\u69d8\u5909\u66f4\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002**\n\n## \u52d5\u6a5f\n\nActiveRecord\u306e\u30ed\u30b0\u3092\u53d6\u308bgem\u306f[audited](https://github.com/collectiveidea/audited)\u3084[paper_trail](https://github.com/airblade/paper_trail)\u306a\u3069\u3042\u308a\u307e\u3059\u304c\u3001\u3044\u305a\u308c\u3082yml\u3084json\u306b\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u3057\u3066\u4fdd\u5b58\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u30ed\u30b0\u306e\u691c\u7d22\u6a5f\u80fd\u304c\u307b\u3057\u3044\u3068\u304d\u306b\u56f0\u308a\u307e\u3059\u3088\u306d\u3002\n\u305d\u3053\u3067\u3001\u30ed\u30b0\u30c6\u30fc\u30d6\u30eb\u306b\u30ed\u30b0\u3092\u53d6\u308bgem\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n## Usage\n\narticles\u3068\u3044\u3046\u30c6\u30fc\u30d6\u30eb\u306e\u30ed\u30b0\u3092\u53d6\u308b\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306amigration\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```rb\nclass CreateAllTables < ActiveRecord::Migration\n  def self.up\n    create_table(:articles) do |t|\n      t.timestamps\n    end\n\n    create_table(:article_logs) do |t|\n      t.integer :article_id, null: false\n      t.string :title, null: false\n      t.text :content\n      t.boolean :public, null: false, default: true\n      t.datetime :created_at\n    end\n    add_index :article_logs,  :article_id\n    add_index :article_logs, [:article_id, :created_at], unique: true\n  end\nend\n```\n\narticles\u30c6\u30fc\u30d6\u30eb\u304c(timestamps\u4ee5\u5916)\u304b\u3089\u3063\u307d\u306a\u306e\u304c\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002\n\n\u6b21\u306bModel\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```rb\nclass Article < ActiveRecord::Base\n  has_logs\nend\n\nclass ArticleLog < ActiveRecord::Base\n  act_as_log\nend\n```\n\n\u4f7f\u3063\u3066\u898b\u307e\u3057\u3087\u3046\u3002\n\n```\narticle = Article.create(title: 'test1', content: 'demo1', public: false)\narticle.attributes =   { title: 'test2', content: 'demo2', public: false } ; article.save!\narticle.attributes =   { title: 'test3', content: 'demo3', public: true  } ; article.save!\n\narticle.title\n=> 'test3'\n\narticle.logs\n=> [#<ArticleLog id: 1, article_id: 1, title: \"test1\", content: \"demo1\", created_at: \"2015-01-04 03:36:51\">,\n #<ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\">,\n #<ArticleLog id: 3, article_id: 1, title: \"test3\", content: \"demo3\", created_at: \"2015-01-04 03:36:51\">]\n\narticle.oldest_log\n=> #<ArticleLog id: 1, article_id: 1, title: \"test1\", content: \"demo1\", created_at: \"2015-01-04 03:36:51\">\n\narticle.latest_log\n=> #<ArticleLog id: 3, article_id: 1, title: \"test3\", content: \"demo3\", created_at: \"2015-01-04 03:36:51\">\n\narticle.oldest_log.next\n=> #<ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\">\n\narticle.latest_log.prev\n=> #<ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\">\n```\n\n\u3044\u3044\u611f\u3058\u3067\u3059\u3002\n\nDB\u4e0a\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n##### articles\n\n| id | title |\n|---:|-------|\n| 1  | title |\n\n##### article_logs\n\n| id | article_id | title | content | public |\n|---:|-----------:|-------|---------|-------:|\n|   1|           1| test1 | demo1   |       0|\n|   2|           1| test2 | demo2   |       0|\n|   3|           1| test3 | demo3   |       1|\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002\u3088\u304b\u3063\u305f\u3089\u4f7f\u3063\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n", "tags": ["Ruby", "ActiveRecord"]}