{"tags": ["Python", "\u6570\u5b66", "sympy"], "context": "\u304d\u3063\u304b\u3051\u306f\u3001\u81ea\u5206\u304c\u904e\u53bb\u306b\u66f8\u3044\u305f\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u6574\u7406\u3057\u3066\u3044\u308b\u3068\u3001\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u30ab\u30fc\u30d6\u30d5\u30a3\u30c3\u30c6\u30a3\u30f3\u30b0(\u66f2\u7dda\u3042\u3066\u306f\u3081)\u3092\u3059\u308bJavaScript\u304c\u51fa\u3066\u304d\u3066\u3001\u61d0\u304b\u3057\u3044\u306a\u30fc\u3068\u601d\u3063\u3066\u8aad\u3093\u3067\u307f\u305f\u306e\u3067\u3059\u304c\u6570\u5f0f\u304c\u96e3\u3057\u3059\u304e\u3066\u5168\u304f\u7406\u89e3\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u4f55\u3067\u3053\u3093\u306a\u8b0e\u306e\u6570\u5f0f\u3067\u8fd1\u4f3c\u3067\u304d\u308b\u306d\u3093\u3001\u6614\u306e\u4ffa\u3059\u3052\u30fc\u306a\u3002\n\u3069\u3046\u3084\u3089\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3092\u4f7f\u3063\u3066\u8fd1\u4f3c\u3057\u3066\u3044\u305f\u3088\u3046\u3067\u3059\u3001\u5fa9\u7fd2\u304c\u3066\u3089Python\u3067\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u53c2\u8003\u66f8\u3092\u3072\u3063\u3071\u308a\u3060\u3057\u3066\u52c9\u5f37\u3057\u306a\u304a\u3057\u307e\u3057\u305f\u3001\u3061\u306a\u307f\u306b\u53c2\u8003\u6587\u732e\u306f\u91d1\u8c37\u5065\u4e00\u5148\u751f\u306e\u300c\u3053\u308c\u306a\u3089\u5206\u304b\u308b\u6700\u9069\u5316\u6570\u5b66\u2015\u57fa\u790e\u539f\u7406\u304b\u3089\u8a08\u7b97\u624b\u6cd5\u307e\u3067\u300d\u3067\u3059\u3002\u975e\u5e38\u306b\u89e3\u308a\u3084\u3059\u304f\u89e3\u8aac\u3055\u308c\u3066\u3044\u308b\u672c\u3067\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3068\u306f\u4f55\u306a\u306e\u304b\uff1f\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3068\u306f\u3001\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u3084\u95a2\u6570\u3092\u8fd1\u4f3c\u3059\u308b\u4ee3\u8868\u7684\u306a\u624b\u6cd5\u3067\u3001\u30c7\u30fc\u30bf\u89e3\u6790\u306b\u304a\u3051\u308b\u6700\u3082\u91cd\u8981\u306a\u57fa\u790e\u3068\u306a\u308a\u307e\u3059\u3002\n\u9069\u7528\u7bc4\u56f2\u306f\u975e\u5e38\u306b\u5e83\u304f\u3001\u5fae\u5206\u53ef\u80fd\u3067\u3042\u308c\u3070\u3069\u3093\u306a\u95a2\u6570\u3082\u8fd1\u4f3c\u304c\u53ef\u80fd\u3068\u3044\u3046\u5b9f\u7528\u6027\u3068\u7f8e\u3057\u3055\u3092\u517c\u306d\u5099\u3048\u305f\u624b\u6cd5\u3067\u3059\u3002\n\u4f8b\u3048\u3070\u3001\u3053\u3053\u306b20\u500b\u306e\u70b9\u304c\u3042\u3063\u305f\u3068\u3057\u307e\u3059\u3002\n\n20\u500b\u306e\u70b9\u306b\u5bfe\u3057\u3066\u6700\u3082\u8fd1\u3044\u5834\u6240\u3092\u901a\u308b\u76f4\u7dda\u3092\u7f6e\u3044\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u76f4\u7dda\u306e\u95a2\u6570f(x)=ax+bf(x)=ax+bf(x) = ax + b\u306b\u3064\u3044\u3066\u3001\u3059\u3079\u3066\u306e\u70b9\u306b\u6700\u3082\u8fd1\u3044\u5834\u6240\u3092\u901a\u308b\u30d1\u30e9\u30e1\u30fc\u30bfaa,bb\u3092\u6c42\u3081\u307e\u3059\u3002\n\u3053\u306eaa,bb\u3092\u6c42\u3081\u308b\u4ee3\u8868\u7684\u306a\u65b9\u6cd5\u304c\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306a\u306e\u3067\u3059\u3002\n\u6307\u5b9a\u306e\u5834\u6240\u3068\u30d7\u30ed\u30c3\u30c8\u3057\u305f\u5834\u6240\u306e\u8aa4\u5dee\u3092\u4e8c\u4e57\u3057\u305f\u7dcf\u548c\u304c\u6700\u5c0f\u306b\u306a\u308b\u3088\u3046\u306b\u8fd1\u4f3c\u3059\u308b\u306e\u3067\u3001\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3068\u547c\u3073\u307e\u3059\u3002\n\n\u76f4\u7dda\u306e\u8fd1\u4f3c\n\u307e\u305a\u306f\u3001\u4e00\u756a\u7c21\u5358\u306a\u76f4\u7dda\u306e\u8fd1\u4f3c\u3092\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3001\u4ee5\u4e0b\u306e4\u70b9\u3092\u8fd1\u4f3c\u3059\u308b\u76f4\u7dda\u3092\u5f15\u3044\u3066\u307f\u307e\u3059\u3002\npoints = [(107, 101), (449, 617), (816, 876), (1105,1153)]\n\n\n\u76f4\u7dda\u306e\u95a2\u6570\u306ff(x)=ax+bf(x) = ax + b\u3067\u3059\u3001aa\u304c\u50be\u304d\u3067bb\u304c\u5207\u7247\u3067\u3059\u306d\u3002\n\u95a2\u6570f(x)f(x)\u306b\u5bfe\u3057\u3066\u3001\u6307\u5b9a\u306e\u70b9\u306e\u8aa4\u5dee\u306e\u4e8c\u4e57\u304c\u6700\u5c0f\u306b\u306a\u308b\u30d1\u30e9\u30e1\u30fc\u30bfaa\u3068bb\u3092\u6c42\u3081\u307e\u3059\u3002\n\u6307\u5b9a\u306e\u5834\u6240yy\u3068\u3059\u308b\u3068\u3001\u8aa4\u5dee\u306e\u4e8c\u4e57\u3092\u6c42\u3081\u308b\u95a2\u6570j(x,y)j(x, y)\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nj(x, y) = (y - (ax + b))^2\nj(x,y)=(y\u2212(ax+b))2{j(x, y) = (y - (ax + b))^2\n}\nN\u500b\u306e\u70b9\u306b\u5bfe\u3057\u3066jj\u306e\u7dcf\u548c\u304c\u6700\u5c0f\u306b\u306a\u308c\u3070\u3088\u3044\u306e\u3067\u3001\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306e\u5f0f\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nJ = \\frac {1}{2}\\sum_{k=1}^{n} j(x_k, y_k)\nJ=12n\u2211k=1j(xk,yk){J = \\frac {1}{2}\\sum_{k=1}^{n} j(x_k, y_k)\n}\n\n\u8aa4\u5dee\u95a2\u6570j(x, y)\u306e\u504f\u5c0e\u95a2\u6570\u3092\u6c42\u3081\u308b\n\u3044\u304d\u306a\u308a\u96e3\u89e3\u30ef\u30fc\u30c9\u306e\u504f\u5c0e\u95a2\u6570\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\u304c\u3001\u4f55\u3082\u5fc3\u914d\u3042\u308a\u307e\u305b\u3093\u3002\n\u8a08\u7b97\u65b9\u6cd5\u3055\u3048\u5224\u308c\u3070\u5c0f\u5b66\u751f\u3067\u3082\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n2\u3064\u4ee5\u4e0a\u306e\u5909\u6570\u304c\u3042\u308b\u95a2\u6570\u3092\u3042\u308b1\u3064\u306e\u5909\u6570\u306b\u3064\u3044\u3066\u5fae\u5206\u3059\u308b\u3053\u3068\u3092\u504f\u5fae\u5206\u3068\u8a00\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u504f\u5fae\u5206\u306b\u3088\u3063\u3066\u6c42\u3081\u3089\u308c\u305f\u95a2\u6570\u3092\u504f\u5c0e\u95a2\u6570\u3068\u8a00\u3044\u307e\u3059\u3002\n\n \u5fae\u5206\u3092\u5fd8\u308c\u305f\u4eba\u7528\u306e\u8aac\u660e\n\u5fae\u5206\u306f\u3001(Xn)\u2032=nXn\u22121(X^n)' = nX^{n-1}\u3067\u3001\u6307\u6570\u3092n\u3092\u4fc2\u6570\u306b\u3057\u3066\u6307\u6570\u3092n-1\u3059\u308b\u3084\u3064\u3067\u3059\u3002\n\u4f8b\uff1a\n(x2)\u2032=2x(x^2)' = 2x\n(2x2)\u2032=4x(2x^2)' = 4x\n(4x3)\u2032=12x2(4x^3)' = 12x^2\n\u5fae\u5206\u306f\u30b0\u30e9\u30d5\u306e\u63a5\u7dda\u306e\u50be\u304d\u3068\u306a\u308a\u307e\u3059\u3001\u30b0\u30e9\u30d5\u306e\u77ac\u9593\u306e\u901f\u5ea6\u3092\u6c42\u3081\u308b\u3068\u8a00\u3044\u63db\u3048\u308b\u4e8b\u3082\u3067\u304d\u307e\u3059\u3002\n\u5fae\u5206\u304c0\u306e\u70b9\u306f\u3001\u51f8\u306e\u30b0\u30e9\u30d5\u306e\u5834\u5408\u306f\u5909\u66f2\u70b9\u3068\u306a\u308a\u307e\u3059\u3002\n\nSympy\u3092\u4f7f\u3063\u3066\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\n\u5fae\u5206\u304c\u89e3\u308c\u3070\u504f\u5fae\u5206\u3082\u5225\u306b\u76ee\u65b0\u3057\u3044\u4e8b\u3082\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u96e3\u3057\u3044\u4e8b\u306f\u89e3\u3089\u306a\u304f\u3066\u3082\u5e73\u6c17\u3067\u3059\u3002\n\u6211\u3005\u306b\u306fSympy(\u3068Jupyter)\u304c\u3042\u308b\u306e\u3067\u3059\uff01\nSympy\u3092\u77e5\u3089\u306a\u3044\u4eba\u306fSympy+Jupyter\u3067\u6700\u5f37\u306e\u96fb\u5353\u74b0\u5883\u3092\u4f5c\u308b\u3092\u3069\u3046\u305e\u3002\n\u3055\u3063\u305d\u304fJupyter\u3092\u8d77\u52d5\u3057\u307e\u3057\u3087\u3046\u3002\nfrom sympy import *\ninit_session()\n\n\u3053\u308c\u3067Sympy\u3068Jupyter\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\u8aa4\u5dee\u3092\u6c42\u3081\u308b\u95a2\u6570jj\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\na, b = symbols(\"a b\")\n\nj = (y - (a * x + b)) ** 2\n\nsympy.diff\u95a2\u6570\u3067\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3001\u307e\u305a\u306faa\u306b\u3064\u3044\u3066\u504f\u5fae\u5206\u3057\u307e\u3059\u3002\naa\u306b\u3064\u3044\u3066\u306e\u504f\u5c0e\u95a2\u6570\u306f\u2202j\u2202a\\frac{\\partial j}{\\partial a}\u3001bb\u306b\u3064\u3044\u3066\u306f\u2202j\u2202b\\frac{\\partial j}{\\partial b}\u3068\u66f8\u304d\u307e\u3059\u3002\nj_a = diff(j, a)\nj_b = diff(j, b)\n\n\\frac{\\partial j}{\\partial a}\n=\n- 2 x \\left(- a x - b + y\\right) \\\\\n\n\\frac{\\partial j}{\\partial b}\n=\n2 a x + 2 b - 2 y\n\u2202j\u2202a=\u22122x(\u2212ax\u2212b+y)\u2202j\u2202b=2ax+2b\u22122y{\\frac{\\partial j}{\\partial a}\n=\n- 2 x \\left(- a x - b + y\\right) \\\\\n\n\\frac{\\partial j}{\\partial b}\n=\n2 a x + 2 b - 2 y\n}\n\u76f4\u7dda\u95a2\u6570\u306e\u504f\u5c0e\u95a2\u6570\u304c\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3001Sympy\u304c\u3042\u308c\u3070\u697d\u52dd\u3067\u3059\u306d\u3002\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306f\u8aa4\u5dee\u306e\u7dcf\u548c\u306e1/2\u306a\u306e\u3067\u8a08\u7b97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u5f0f\u3078\u306e\u5024\u306e\u4ee3\u5165\u306fsympy.subs\u95a2\u6570\u3067\u884c\u3044\u307e\u3059\u3002\nsum_a = sum([j_a.subs([(x, _x), (y, _y)]) for _x, _y in points]) / 2.\nsum_b = sum([j_b.subs([(x, _x), (y, _y)]) for _x, _y in points]) / 2.\n\n\\frac {1}{2}\\sum_{k=1}^{n} \\frac{\\partial j}{\\partial a}\n=\n2099931.0 a + 2477.0 b - 2276721.0 \\\\\n\\frac {1}{2}\\sum_{k=1}^{n} \\frac{\\partial j}{\\partial b}\n=\n2477.0 a + 4 b - 2747.0\n12n\u2211k=1\u2202j\u2202a=2099931.0a+2477.0b\u22122276721.012n\u2211k=1\u2202j\u2202b=2477.0a+4b\u22122747.0{\\frac {1}{2}\\sum_{k=1}^{n} \\frac{\\partial j}{\\partial a}\n=\n2099931.0 a + 2477.0 b - 2276721.0 \\\\\n\\frac {1}{2}\\sum_{k=1}^{n} \\frac{\\partial j}{\\partial b}\n=\n2477.0 a + 4 b - 2747.0\n}\n\u5404\u7dcf\u548c\u306e1/2\u306e\u5f0f\u304c\u51fa\u307e\u3057\u305f\u306d\u3001\u3042\u3068\u306f\u3053\u306e2\u3064\u306e\u5f0f\u306e\u9023\u7acb\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u3060\u3051\u3067\u3059\u3002\n\\begin{bmatrix}\n2099931.0 & 2477.0 \\\\\n2477.0 & 4 \n\\end{bmatrix}\n\n\\begin{bmatrix}\na \\\\\nb\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2276721.0 \\\\\n2747.0\n\\end{bmatrix}\n[2099931.02477.02477.04][ab]=[2276721.02747.0]{\\begin{bmatrix}\n2099931.0 & 2477.0 \\\\\n2477.0 & 4 \n\\end{bmatrix}\n\n\\begin{bmatrix}\na \\\\\nb\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2276721.0 \\\\\n2747.0\n\\end{bmatrix}\n}\nsolve([sum_a, sum_b], [a, b])\n# {a:1.01694642025091,b:57.0059292596265} \n\na=1.01694642025091\u3001b=57.0059292596265\u304c\u7b54\u3048\u3067\u3059\u3002\u76f4\u7dda\u306e\u65b9\u7a0b\u5f0fy=ax+by = ax + b\u306b\u4ee3\u5165\u3059\u308c\u3070\u826f\u3044\u306e\u3067\u3059\u3002\n\u3055\u3063\u305d\u304f\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u76f4\u7dda\u306e\u305f\u3081\u5168\u3066\u306e\u70b9\u3092\u901a\u904e\u3067\u304d\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u305d\u308c\u306b\u8fd1\u3057\u3044\u5834\u6240\u3092\u901a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u8fd1\u4f3c\n\u5148\u7a0b\u306f\u5358\u7d14\u306a\u76f4\u7dda\u3092\u8fd1\u4f3c\u3057\u307e\u3057\u305f\u304c\u30013\u6b21\u66f2\u7dda\u306e\u30d9\u30b8\u30a7\u66f2\u7dda\u3082\u5168\u304f\u540c\u3058\u624b\u9806\u3067\u8fd1\u4f3c\u3067\u304d\u307e\u3059\u3002\n\u30d9\u30b8\u30a7\u66f2\u7dda\u306f\u3001p1p_1\u306f\u59cb\u70b9\u3001p4p_4\u306f\u7d42\u70b9\u3001p2p_2\u3068p3p_3\u304c\u305d\u308c\u305e\u308c\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308a\u307e\u3059\u3002\n\n3\u6b21\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u5f0f\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\nbz = p_{1} \\left(- t + 1\\right)^{3} + p_{2} t \\left(- 3 t + 3\\right) \\left(- t + 1\\right) + p_{3} t^{2} \\left(- 3 t + 3\\right) + p_{4} t^{3}\nbz=p1(\u2212t+1)3+p2t(\u22123t+3)(\u2212t+1)+p3t2(\u22123t+3)+p4t3{bz = p_{1} \\left(- t + 1\\right)^{3} + p_{2} t \\left(- 3 t + 3\\right) \\left(- t + 1\\right) + p_{3} t^{2} \\left(- 3 t + 3\\right) + p_{4} t^{3}\n}\nt\u306e\u7bc4\u56f2\u306f0 \u2266 t \u2266 1\u3067\u3059\u3002\n\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u5f0f\u3092bzbz\u3068\u3057\u3001\u8fd1\u4f3c\u3057\u305f\u3044\u70b9\u3092pxp_x\u3068\u3059\u308b\u3068\u3001\u8aa4\u5dee\u3092\u6c42\u3081\u308b\u95a2\u6570jj\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nj = (p_x - bz)^{2}\nj=(px\u2212bz)2{j = (p_x - bz)^{2}\n}\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306e\u5b9a\u7fa9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3057\u305f\u306d\u3002\nJ = \\frac {1}{2}\\sum_{k=1}^{n} j(x_k, y_k)\nJ=12n\u2211k=1j(xk,yk){J = \\frac {1}{2}\\sum_{k=1}^{n} j(x_k, y_k)\n}\n\u6c42\u3081\u305f\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u306fp2p_2\u3068p3p_3\u3067\u3059\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u504f\u5fae\u5206\u3057\u307e\u3059\u3002\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306e\u5b9a\u7fa9\u306e1/2\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u504f\u5c0e\u95a2\u6570\u306b1/2\u3092\u3042\u3089\u304b\u3058\u3081\u639b\u3051\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002\n\u3055\u3063\u305d\u304fSympy\u3067\u66f8\u3044\u3066\u307f\u307e\u3057\u3087\u3046\u3002\np0, p1, p2, p3, p4, px, t = symbols(\"p0 p1 p2 p3 p4 px t\")\n\nbz = (1-t)**3*p1 + 3*(1-t)**2*t*p2 + 3*(1-t)*t**2*p3 + t**3*p4\nj = (px - bz) ** 2\n\njp2 = simplify(diff(j, p2) / 2)\njp3 = simplify(diff(j, p3) / 2)\n\np2p_2\u3068p3p_3\u306e\u504f\u5c0e\u95a2\u6570\u306e1/2\u306f\u3001\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_2}\n=\n3 t \\left(t - 1\\right)^{2} \\left(- p_{1} \\left(t - 1\\right)^{3} + 3 p_{2} t \\left(t - 1\\right)^{2} - 3 p_{3} t^{2} \\left(t - 1\\right) + p_{4} t^{3} - px\\right)\n\\\\\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_3}\n=\n3 t^{2} \\left(t - 1\\right) \\left(p_{1} \\left(t - 1\\right)^{3} - 3 p_{2} t \\left(t - 1\\right)^{2} + 3 p_{3} t^{2} \\left(t - 1\\right) - p_{4} t^{3} + px\\right)\n12\u2202j\u2202p2=3t(t\u22121)2(\u2212p1(t\u22121)3+3p2t(t\u22121)2\u22123p3t2(t\u22121)+p4t3\u2212px)12\u2202j\u2202p3=3t2(t\u22121)(p1(t\u22121)3\u22123p2t(t\u22121)2+3p3t2(t\u22121)\u2212p4t3+px){\\frac{1}{2} \\frac{\\partial j}{\\partial p_2}\n=\n3 t \\left(t - 1\\right)^{2} \\left(- p_{1} \\left(t - 1\\right)^{3} + 3 p_{2} t \\left(t - 1\\right)^{2} - 3 p_{3} t^{2} \\left(t - 1\\right) + p_{4} t^{3} - px\\right)\n\\\\\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_3}\n=\n3 t^{2} \\left(t - 1\\right) \\left(p_{1} \\left(t - 1\\right)^{3} - 3 p_{2} t \\left(t - 1\\right)^{2} + 3 p_{3} t^{2} \\left(t - 1\\right) - p_{4} t^{3} + px\\right)\n}\n\u901a\u904e\u3055\u305b\u305f\u3044\u70b9pxp_x\u3068\u3001\u305d\u306e\u6642\u306btt\u306e\u30da\u30a2\u5024\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3001\u4f8b\u3068\u3057\u3066\u4ee5\u4e0b\u306e4\u70b9\u304c\u3042\u308b\u3068\u3057\u307e\u3059\u3002\npoints = [(0, 0), (0.2, 65), (0.7, 45), (1.0, 100)]\n\n\n\u59cb\u70b9\u3068\u7d42\u70b9\u304cp1p_1\u3068p4p_4\u306b\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u3053\u306e2\u3064\u306f\u65e2\u77e5\u306e\u5024\u3068\u306a\u308a\u307e\u3059\u3002\n\u6c42\u3081\u305f\u3044p2p_2\u3068p3p_3\u306b\u3064\u3044\u3066\u3001\u504f\u5c0e\u95a2\u6570\u306e\u7dcf\u548c\u3092\u9023\u5217\u65b9\u7a0b\u5f0f\u3067\u89e3\u304d\u307e\u3059\u3002\nconst = ((p1, points[0][1]), (p4, points[-1][1]))\ntp2 = sum([jp2.subs(const + ((t, x[0]), (px, x[1]))) for x in points[1:-1]])\ntp3 = sum([jp3.subs(const + ((t, x[0]), (px, x[1]))) for x in points[1:-1]])\n\nsolve([tp2, tp3], [p2, p3])\n# {p2:180.456349206349,p3:\u221253.0753968253968} \n\n\u7b54\u3048\u306fp2=180.456349206349,p3=\u221253.0753968253968\u3067\u3059\u3002\n\n\u3061\u3083\u3093\u3068\u8fd1\u4f3c\u3067\u304d\u3066\u3044\u307e\u3059\u306d\uff01\n\u8272\u3005\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\npoints = [(0, 0), (0.3, 50), (0.7, 80), (1.0, 100)]\n\n\npoints = [(0, 0), (0.2, 34), (0.4, 44), (0.6, 46), (0.8, 60), (1.0, 100)]\n\n\n\u3042\u307e\u308a\u6975\u7aef\u306a\u5024\u3067\u306a\u3044\u9650\u308a\u3001\u3061\u3083\u3093\u3068\u901a\u904e\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\u3082\u3061\u308d\u3093\u901a\u904e\u3067\u304d\u306a\u3044\u5024\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u306a\u3093\u3068\u306a\u304f\u305d\u308c\u3063\u307d\u304f\u7dda\u3092\u5f15\u3044\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u3044\u308d\u3044\u308d\u306a\u66f2\u7dda\u3092\u751f\u6210\u3057\u3066\u307f\u308b\n\u6700\u5f8c\u306bJupyter\u4e0a\u3067\u30d9\u30b8\u30a7\u66f2\u7dda\u3092\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3067\u8fd1\u4f3c\u3057\u3066\u3001\u30d7\u30ed\u30c3\u30c8\u3059\u308b\u30bb\u30eb\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n%matplotlib inline\nimport matplotlib.pyplot as plt\n\np0, p1, p2, p3, p4, px, t = symbols(\"p0 p1 p2 p3 p4 px t\")\n\nbz = (1-t)**3*p1 + 3*(1-t)**2*t*p2 + 3*(1-t)*t**2*p3 + t**3*p4\nj = (px - bz) ** 2\njp2 = simplify(diff(j, p2) / 2)\njp3 = simplify(diff(j, p3) / 2)\n\ndef plot(points):\n    const = ((p1, points[0][1]), (p4, points[-1][1]))\n    tp2 = sum([jp2.subs(const + ((t, x[0]), (px, x[1]))) for x in points[1:-1]])\n    tp3 = sum([jp3.subs(const + ((t, x[0]), (px, x[1]))) for x in points[1:-1]])\n\n    vec = solve([tp2, tp3], [p2, p3])\n\n    const = {p1: points[0][1], p2: vec[p2], p3: vec[p3], p4: points[-1][1]}\n    bz2 = bz.subs(const)\n    x = np.arange(0, 1+0.01, 0.01)\n    y = [\n        bz2.subs(t, _t)\n        for _t in x\n    ]\n    plt.plot(x, y)\n    plt.scatter([p[0] for p in points], [p[1] for p in points])\n\nplot\u95a2\u6570\u306b\u901a\u904e\u3057\u3066\u6b32\u3057\u3044\u70b9\u306e\u30ea\u30b9\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u3001\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3067\u9811\u5f35\u3063\u3066\u305d\u306e\u70b9\u3092\u901a\u3063\u3066\u304f\u308c\u307e\u3059\u3002\n\u4f7f\u3044\u65b9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u547c\u3073\u307e\u3059\u3002\npoints = [(0, 0), (0.1, -40), (0.5, -50), (0.8, 30), (1.0, 100)]\nplot(points)\n\n\n\nSympy\u3092\u4f7f\u308f\u306a\u3044\u3067\u89e3\u304f\nC/C++\u306a\u3069Sympy\u304c\u306a\u3044\u74b0\u5883\u3067\u306e\u5b9f\u88c5\u3092\u66f8\u304d\u307e\u3059\u3002\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_2}\n=\n3 t \\left(t - 1\\right)^{2} \\left(- p_{1} \\left(t - 1\\right)^{3} + 3 p_{2} t \\left(t - 1\\right)^{2} - 3 p_{3} t^{2} \\left(t - 1\\right) + p_{4} t^{3} - px\\right)\n\\\\\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_3}\n=\n3 t^{2} \\left(t - 1\\right) \\left(p_{1} \\left(t - 1\\right)^{3} - 3 p_{2} t \\left(t - 1\\right)^{2} + 3 p_{3} t^{2} \\left(t - 1\\right) - p_{4} t^{3} + px\\right)\n12\u2202j\u2202p2=3t(t\u22121)2(\u2212p1(t\u22121)3+3p2t(t\u22121)2\u22123p3t2(t\u22121)+p4t3\u2212px)12\u2202j\u2202p3=3t2(t\u22121)(p1(t\u22121)3\u22123p2t(t\u22121)2+3p3t2(t\u22121)\u2212p4t3+px){\\frac{1}{2} \\frac{\\partial j}{\\partial p_2}\n=\n3 t \\left(t - 1\\right)^{2} \\left(- p_{1} \\left(t - 1\\right)^{3} + 3 p_{2} t \\left(t - 1\\right)^{2} - 3 p_{3} t^{2} \\left(t - 1\\right) + p_{4} t^{3} - px\\right)\n\\\\\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_3}\n=\n3 t^{2} \\left(t - 1\\right) \\left(p_{1} \\left(t - 1\\right)^{3} - 3 p_{2} t \\left(t - 1\\right)^{2} + 3 p_{3} t^{2} \\left(t - 1\\right) - p_{4} t^{3} + px\\right)\n}\n\u3068\u306f\u3044\u3048\u3001\u4f7f\u7528\u3059\u308b\u306e\u306f\u4e0a\u306e\u7b97\u51fa\u6e08\u307f\u306e2\u5f0f\u3060\u3051\u3067\u3001\u4e0d\u660e\u306a\u70b9p2p_2\u3068p3p_3\u30921.0\u3068\u7f6e\u304d\u3001\u5404\u9805\u3054\u3068\u306b\u8a08\u7b97\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\u3067\u304d\u308b\u3060\u3051C/C++\u3063\u307d\u304f\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\ndef lsm(points):\n    ''' \u6700\u5c0f\u4e8c\u4e57\u6cd5\u306e\u89e3\u3092\u884c\u5217\u3067\u8fd4\u3059 '''\n    p1, p4 = points[0][1], points[-1][1]\n\n    a = b = c = d = e = f = 0.\n    for _t, _px in points[1:-1]:\n        _t_1_d = (_t - 1.) ** 2\n        _t_1 = (_t - 1.)\n\n        _p1 = p1 * _t_1 \n        _p2 = 3 * _t * _t_1_d\n        _p3 = 3 * _t ** 2 * _t_1\n        _p4 = p4 * _t ** 3\n\n        _j_p2 = 3 * _t * _t_1_d\n        _j_p3 = 3 * _t ** 2 * _t_1\n\n        a += _p2 * _j_p2\n        b += -_p3 * _j_p2\n        c += -_p2 * _j_p3\n        d += _p3 * _j_p3\n        e += -((-_p1 + _p4 - _px) * _j_p2)\n        f += -((_p1 - _p4 + _px) * _j_p3)\n\n    return [\n        [a, b],\n        [c, d]\n    ], [e, f]\n\n\ndef inv(mat, vec):\n    ''' \u9006\u884c\u5217\u3067\u9023\u7acb\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f '''\n    dm = mat[0][0] * mat[1][1] - mat[1][0] * mat[0][1]\n    assert (dm != 0.0)\n\n    a = mat[1][1] / dm\n    b = -mat[0][1] / dm\n    c = -mat[1][0] / dm\n    d = mat[0][0] / dm\n\n    return (vec[0] * a + vec[1] * b, \n            vec[0] * c + vec[1] * d)\n\npoints = [(0, 0), (0.2, 65), (0.7, 45), (1.0, 100)]\ninv(*lsm(points))\n\n\n\u3042\u3068\u304c\u304d\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306f\u3001\u5fae\u5206\u53ef\u80fd\u306a\u95a2\u6570\u3067\u3042\u308c\u3070\u8fd1\u4f3c\u53ef\u80fd\u3068\u3044\u3046\u975e\u5e38\u306b\u5f37\u529b\u306a\u624b\u6cd5\u3067\u3059\u3002\n\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u8fd1\u4f3c\u306f\u30b2\u30fc\u30e0\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u5fdc\u7528\u3059\u308b\u3068\u697d\u3057\u305d\u3046\u3067\u3059\u306d\u3002\n\u504f\u5c0e\u95a2\u6570\u3092\u4e8b\u524d\u306bSympy\u3067\u8a08\u7b97\u3057\u3066\u304a\u3051\u3070\u3001C/C++\u306a\u3069\u306e\u4ed6\u8a00\u8a9e\u3067\u3082\u9023\u7acb\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u5b9f\u88c5\u3059\u308b\u3060\u3051\u3067\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n\uff08\u9023\u7acb\u65b9\u7a0b\u5f0f\u306f\u300c\u30ac\u30a6\u30b9\u30b8\u30e7\u30eb\u30c0\u30f3\u306e\u6383\u304d\u51fa\u3057\u6cd5\u300d\u306a\u3069\u3001\u6ca2\u5c71\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u3042\u308a\u307e\u3059\uff09\n\u3084\u306f\u308aSympy\u306f\u975e\u5e38\u306b\u5f37\u529b\u306a\u30c4\u30fc\u30eb\u3067\u3059\u306d\u3001\u5909\u6570\u304c\u591a\u3044\u6570\u5f0f\u3082\u7c21\u5358\u306b\u6700\u9069\u5316/\u8a08\u7b97\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u8a08\u7b97\u304c\u82e6\u624b\u306a\u306e\u3067\u975e\u5e38\u306b\u91cd\u5b9d\u3057\u3066\u3044\u307e\u3059\u3002\n\u304d\u3063\u304b\u3051\u306f\u3001\u81ea\u5206\u304c\u904e\u53bb\u306b\u66f8\u3044\u305f\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u6574\u7406\u3057\u3066\u3044\u308b\u3068\u3001\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u30ab\u30fc\u30d6\u30d5\u30a3\u30c3\u30c6\u30a3\u30f3\u30b0([\u66f2\u7dda\u3042\u3066\u306f\u3081](https://ja.wikipedia.org/wiki/%E6%9B%B2%E7%B7%9A%E3%81%82%E3%81%A6%E3%81%AF%E3%82%81))\u3092\u3059\u308bJavaScript\u304c\u51fa\u3066\u304d\u3066\u3001\u61d0\u304b\u3057\u3044\u306a\u30fc\u3068\u601d\u3063\u3066\u8aad\u3093\u3067\u307f\u305f\u306e\u3067\u3059\u304c\u6570\u5f0f\u304c\u96e3\u3057\u3059\u304e\u3066\u5168\u304f\u7406\u89e3\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n\u4f55\u3067\u3053\u3093\u306a\u8b0e\u306e\u6570\u5f0f\u3067\u8fd1\u4f3c\u3067\u304d\u308b\u306d\u3093\u3001\u6614\u306e\u4ffa\u3059\u3052\u30fc\u306a\u3002\n\n\u3069\u3046\u3084\u3089\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3092\u4f7f\u3063\u3066\u8fd1\u4f3c\u3057\u3066\u3044\u305f\u3088\u3046\u3067\u3059\u3001\u5fa9\u7fd2\u304c\u3066\u3089Python\u3067\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u53c2\u8003\u66f8\u3092\u3072\u3063\u3071\u308a\u3060\u3057\u3066\u52c9\u5f37\u3057\u306a\u304a\u3057\u307e\u3057\u305f\u3001\u3061\u306a\u307f\u306b\u53c2\u8003\u6587\u732e\u306f\u91d1\u8c37\u5065\u4e00\u5148\u751f\u306e[\u300c\u3053\u308c\u306a\u3089\u5206\u304b\u308b\u6700\u9069\u5316\u6570\u5b66\u2015\u57fa\u790e\u539f\u7406\u304b\u3089\u8a08\u7b97\u624b\u6cd5\u307e\u3067\u300d](https://www.amazon.co.jp/%E3%81%93%E3%82%8C%E3%81%AA%E3%82%89%E5%88%86%E3%81%8B%E3%82%8B%E5%BF%9C%E7%94%A8%E6%95%B0%E5%AD%A6%E6%95%99%E5%AE%A4%E2%80%95%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%97%E6%B3%95%E3%81%8B%E3%82%89%E3%82%A6%E3%82%A7%E3%83%BC%E3%83%96%E3%83%AC%E3%83%83%E3%83%88%E3%81%BE%E3%81%A7-%E9%87%91%E8%B0%B7-%E5%81%A5%E4%B8%80/dp/4320017382)\u3067\u3059\u3002\u975e\u5e38\u306b\u89e3\u308a\u3084\u3059\u304f\u89e3\u8aac\u3055\u308c\u3066\u3044\u308b\u672c\u3067\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\n# \u6700\u5c0f\u4e8c\u4e57\u6cd5\u3068\u306f\u4f55\u306a\u306e\u304b\uff1f\n[\u6700\u5c0f\u4e8c\u4e57\u6cd5](https://ja.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%97%E6%B3%95)\u3068\u306f\u3001\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u3084\u95a2\u6570\u3092\u8fd1\u4f3c\u3059\u308b\u4ee3\u8868\u7684\u306a\u624b\u6cd5\u3067\u3001\u30c7\u30fc\u30bf\u89e3\u6790\u306b\u304a\u3051\u308b\u6700\u3082\u91cd\u8981\u306a\u57fa\u790e\u3068\u306a\u308a\u307e\u3059\u3002\n\u9069\u7528\u7bc4\u56f2\u306f\u975e\u5e38\u306b\u5e83\u304f\u3001\u5fae\u5206\u53ef\u80fd\u3067\u3042\u308c\u3070\u3069\u3093\u306a\u95a2\u6570\u3082\u8fd1\u4f3c\u304c\u53ef\u80fd\u3068\u3044\u3046\u5b9f\u7528\u6027\u3068\u7f8e\u3057\u3055\u3092\u517c\u306d\u5099\u3048\u305f\u624b\u6cd5\u3067\u3059\u3002\n\n\u4f8b\u3048\u3070\u3001\u3053\u3053\u306b20\u500b\u306e\u70b9\u304c\u3042\u3063\u305f\u3068\u3057\u307e\u3059\u3002\n\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (1).png](https://qiita-image-store.s3.amazonaws.com/0/140075/02e3d6be-a2b9-a3d1-2e4b-47cec11ce322.png)\n \n20\u500b\u306e\u70b9\u306b\u5bfe\u3057\u3066\u6700\u3082\u8fd1\u3044\u5834\u6240\u3092\u901a\u308b\u76f4\u7dda\u3092\u7f6e\u3044\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9.png](https://qiita-image-store.s3.amazonaws.com/0/140075/c2bba2a4-20a0-2d2b-cae6-74a2e5fcc288.png)\n\n\u76f4\u7dda\u306e\u95a2\u6570$f(x) = ax + b$\u306b\u3064\u3044\u3066\u3001\u3059\u3079\u3066\u306e\u70b9\u306b\u6700\u3082\u8fd1\u3044\u5834\u6240\u3092\u901a\u308b\u30d1\u30e9\u30e1\u30fc\u30bf$a$,$b$\u3092\u6c42\u3081\u307e\u3059\u3002\n\u3053\u306e$a$,$b$\u3092\u6c42\u3081\u308b\u4ee3\u8868\u7684\u306a\u65b9\u6cd5\u304c**\u6700\u5c0f\u4e8c\u4e57\u6cd5**\u306a\u306e\u3067\u3059\u3002\n\n\u6307\u5b9a\u306e\u5834\u6240\u3068\u30d7\u30ed\u30c3\u30c8\u3057\u305f\u5834\u6240\u306e**\u8aa4\u5dee\u3092\u4e8c\u4e57\u3057\u305f\u7dcf\u548c\u304c\u6700\u5c0f\u306b\u306a\u308b**\u3088\u3046\u306b\u8fd1\u4f3c\u3059\u308b\u306e\u3067\u3001\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3068\u547c\u3073\u307e\u3059\u3002\n\n# \u76f4\u7dda\u306e\u8fd1\u4f3c\n\n\u307e\u305a\u306f\u3001\u4e00\u756a\u7c21\u5358\u306a\u76f4\u7dda\u306e\u8fd1\u4f3c\u3092\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3001\u4ee5\u4e0b\u306e4\u70b9\u3092\u8fd1\u4f3c\u3059\u308b\u76f4\u7dda\u3092\u5f15\u3044\u3066\u307f\u307e\u3059\u3002\n\n```python\npoints = [(107, 101), (449, 617), (816, 876), (1105,1153)]\n```\n\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (2).png](https://qiita-image-store.s3.amazonaws.com/0/140075/9d65c5a2-ea7c-61e0-9928-5ec9eaedcb01.png)\n\n\n\u76f4\u7dda\u306e\u95a2\u6570\u306f$f(x) = ax + b$\u3067\u3059\u3001$a$\u304c\u50be\u304d\u3067$b$\u304c\u5207\u7247\u3067\u3059\u306d\u3002\n\u95a2\u6570$f(x)$\u306b\u5bfe\u3057\u3066\u3001\u6307\u5b9a\u306e\u70b9\u306e\u8aa4\u5dee\u306e\u4e8c\u4e57\u304c\u6700\u5c0f\u306b\u306a\u308b\u30d1\u30e9\u30e1\u30fc\u30bf$a$\u3068$b$\u3092\u6c42\u3081\u307e\u3059\u3002\n\n\u6307\u5b9a\u306e\u5834\u6240$y$\u3068\u3059\u308b\u3068\u3001\u8aa4\u5dee\u306e\u4e8c\u4e57\u3092\u6c42\u3081\u308b\u95a2\u6570$j(x, y)$\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```math\nj(x, y) = (y - (ax + b))^2\n```\n\nN\u500b\u306e\u70b9\u306b\u5bfe\u3057\u3066$j$\u306e\u7dcf\u548c\u304c\u6700\u5c0f\u306b\u306a\u308c\u3070\u3088\u3044\u306e\u3067\u3001\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306e\u5f0f\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```math\nJ = \\frac {1}{2}\\sum_{k=1}^{n} j(x_k, y_k)\n```\n\n\n## \u8aa4\u5dee\u95a2\u6570j(x, y)\u306e\u504f\u5c0e\u95a2\u6570\u3092\u6c42\u3081\u308b\n\n\u3044\u304d\u306a\u308a\u96e3\u89e3\u30ef\u30fc\u30c9\u306e**\u504f\u5c0e\u95a2\u6570**\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\u304c\u3001\u4f55\u3082\u5fc3\u914d\u3042\u308a\u307e\u305b\u3093\u3002\n\u8a08\u7b97\u65b9\u6cd5\u3055\u3048\u5224\u308c\u3070\u5c0f\u5b66\u751f\u3067\u3082\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n\n2\u3064\u4ee5\u4e0a\u306e\u5909\u6570\u304c\u3042\u308b\u95a2\u6570\u3092\u3042\u308b1\u3064\u306e\u5909\u6570\u306b\u3064\u3044\u3066\u5fae\u5206\u3059\u308b\u3053\u3068\u3092**\u504f\u5fae\u5206**\u3068\u8a00\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u504f\u5fae\u5206\u306b\u3088\u3063\u3066\u6c42\u3081\u3089\u308c\u305f\u95a2\u6570\u3092**\u504f\u5c0e\u95a2\u6570**\u3068\u8a00\u3044\u307e\u3059\u3002\n\n### <i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i> \u5fae\u5206\u3092\u5fd8\u308c\u305f\u4eba\u7528\u306e\u8aac\u660e\n\u5fae\u5206\u306f\u3001$(X^n)' = nX^{n-1}$\u3067\u3001\u6307\u6570\u3092n\u3092\u4fc2\u6570\u306b\u3057\u3066\u6307\u6570\u3092n-1\u3059\u308b\u3084\u3064\u3067\u3059\u3002\n\u4f8b\uff1a\n  $(x^2)' = 2x$\n  $(2x^2)' = 4x$\n  $(4x^3)' = 12x^2$\n\n\u5fae\u5206\u306f\u30b0\u30e9\u30d5\u306e\u63a5\u7dda\u306e\u50be\u304d\u3068\u306a\u308a\u307e\u3059\u3001\u30b0\u30e9\u30d5\u306e\u77ac\u9593\u306e\u901f\u5ea6\u3092\u6c42\u3081\u308b\u3068\u8a00\u3044\u63db\u3048\u308b\u4e8b\u3082\u3067\u304d\u307e\u3059\u3002\n\u5fae\u5206\u304c0\u306e\u70b9\u306f\u3001\u51f8\u306e\u30b0\u30e9\u30d5\u306e\u5834\u5408\u306f\u5909\u66f2\u70b9\u3068\u306a\u308a\u307e\u3059\u3002\n\n## Sympy\u3092\u4f7f\u3063\u3066\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\n\u5fae\u5206\u304c\u89e3\u308c\u3070\u504f\u5fae\u5206\u3082\u5225\u306b\u76ee\u65b0\u3057\u3044\u4e8b\u3082\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u96e3\u3057\u3044\u4e8b\u306f\u89e3\u3089\u306a\u304f\u3066\u3082\u5e73\u6c17\u3067\u3059\u3002\n\u6211\u3005\u306b\u306fSympy(\u3068Jupyter)\u304c\u3042\u308b\u306e\u3067\u3059\uff01\n\nSympy\u3092\u77e5\u3089\u306a\u3044\u4eba\u306f[Sympy+Jupyter\u3067\u6700\u5f37\u306e\u96fb\u5353\u74b0\u5883\u3092\u4f5c\u308b](http://qiita.com/pashango2/items/500d23c8f43784b54315)\u3092\u3069\u3046\u305e\u3002\n\n\u3055\u3063\u305d\u304fJupyter\u3092\u8d77\u52d5\u3057\u307e\u3057\u3087\u3046\u3002\n\n\n```python\nfrom sympy import *\ninit_session()\n```\n\n\u3053\u308c\u3067Sympy\u3068Jupyter\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\u8aa4\u5dee\u3092\u6c42\u3081\u308b\u95a2\u6570$j$\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```python\na, b = symbols(\"a b\")\n\nj = (y - (a * x + b)) ** 2\n```\n\n`sympy.diff`\u95a2\u6570\u3067\u504f\u5fae\u5206\u3092\u6c42\u3081\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3001\u307e\u305a\u306f$a$\u306b\u3064\u3044\u3066\u504f\u5fae\u5206\u3057\u307e\u3059\u3002\n$a$\u306b\u3064\u3044\u3066\u306e\u504f\u5c0e\u95a2\u6570\u306f$\\frac{\\partial j}{\\partial a}$\u3001$b$\u306b\u3064\u3044\u3066\u306f$\\frac{\\partial j}{\\partial b}$\u3068\u66f8\u304d\u307e\u3059\u3002\n\n```python\nj_a = diff(j, a)\nj_b = diff(j, b)\n```\n```math\n\\frac{\\partial j}{\\partial a}\n=\n- 2 x \\left(- a x - b + y\\right) \\\\\n\n\\frac{\\partial j}{\\partial b}\n=\n2 a x + 2 b - 2 y\n```\n\n\u76f4\u7dda\u95a2\u6570\u306e\u504f\u5c0e\u95a2\u6570\u304c\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3001`Sympy`\u304c\u3042\u308c\u3070\u697d\u52dd\u3067\u3059\u306d\u3002\n\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306f\u8aa4\u5dee\u306e\u7dcf\u548c\u306e1/2\u306a\u306e\u3067\u8a08\u7b97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u5f0f\u3078\u306e\u5024\u306e\u4ee3\u5165\u306f`sympy.subs`\u95a2\u6570\u3067\u884c\u3044\u307e\u3059\u3002\n\n```python\nsum_a = sum([j_a.subs([(x, _x), (y, _y)]) for _x, _y in points]) / 2.\nsum_b = sum([j_b.subs([(x, _x), (y, _y)]) for _x, _y in points]) / 2.\n```\n```math\n\\frac {1}{2}\\sum_{k=1}^{n} \\frac{\\partial j}{\\partial a}\n=\n2099931.0 a + 2477.0 b - 2276721.0 \\\\\n\\frac {1}{2}\\sum_{k=1}^{n} \\frac{\\partial j}{\\partial b}\n=\n2477.0 a + 4 b - 2747.0\n```\n\n\u5404\u7dcf\u548c\u306e1/2\u306e\u5f0f\u304c\u51fa\u307e\u3057\u305f\u306d\u3001\u3042\u3068\u306f\u3053\u306e2\u3064\u306e\u5f0f\u306e\u9023\u7acb\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u3060\u3051\u3067\u3059\u3002\n\n```math\n\\begin{bmatrix}\n2099931.0 & 2477.0 \\\\\n2477.0 & 4 \n\\end{bmatrix}\n\n\\begin{bmatrix}\na \\\\\nb\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n2276721.0 \\\\\n2747.0\n\\end{bmatrix}\n```\n\n```python\nsolve([sum_a, sum_b], [a, b])\n# {a:1.01694642025091,b:57.0059292596265} \n```\n\n`a=1.01694642025091`\u3001`b=57.0059292596265`\u304c\u7b54\u3048\u3067\u3059\u3002\u76f4\u7dda\u306e\u65b9\u7a0b\u5f0f$y = ax + b$\u306b\u4ee3\u5165\u3059\u308c\u3070\u826f\u3044\u306e\u3067\u3059\u3002\n\u3055\u3063\u305d\u304f\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (4).png](https://qiita-image-store.s3.amazonaws.com/0/140075/15b52052-7442-1aa4-2491-0208c146eace.png)\n\n\u76f4\u7dda\u306e\u305f\u3081\u5168\u3066\u306e\u70b9\u3092\u901a\u904e\u3067\u304d\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u305d\u308c\u306b\u8fd1\u3057\u3044\u5834\u6240\u3092\u901a\u3063\u3066\u3044\u307e\u3059\u3002\n\n# \u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u8fd1\u4f3c\n\n\u5148\u7a0b\u306f\u5358\u7d14\u306a\u76f4\u7dda\u3092\u8fd1\u4f3c\u3057\u307e\u3057\u305f\u304c\u30013\u6b21\u66f2\u7dda\u306e\u30d9\u30b8\u30a7\u66f2\u7dda\u3082\u5168\u304f\u540c\u3058\u624b\u9806\u3067\u8fd1\u4f3c\u3067\u304d\u307e\u3059\u3002\n\n\u30d9\u30b8\u30a7\u66f2\u7dda\u306f\u3001$p_1$\u306f\u59cb\u70b9\u3001$p_4$\u306f\u7d42\u70b9\u3001$p_2$\u3068$p_3$\u304c\u305d\u308c\u305e\u308c\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308a\u307e\u3059\u3002\n\n![bitmap.png](https://qiita-image-store.s3.amazonaws.com/0/140075/02faee43-f04d-08c7-20bb-049cbf49d2b7.png)\n\n\n3\u6b21\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u5f0f\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n```math\nbz = p_{1} \\left(- t + 1\\right)^{3} + p_{2} t \\left(- 3 t + 3\\right) \\left(- t + 1\\right) + p_{3} t^{2} \\left(- 3 t + 3\\right) + p_{4} t^{3}\n```\nt\u306e\u7bc4\u56f2\u306f0 \u2266 t \u2266 1\u3067\u3059\u3002\n\n\n\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u5f0f\u3092$bz$\u3068\u3057\u3001\u8fd1\u4f3c\u3057\u305f\u3044\u70b9\u3092$p_x$\u3068\u3059\u308b\u3068\u3001\u8aa4\u5dee\u3092\u6c42\u3081\u308b\u95a2\u6570$j$\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```math\nj = (p_x - bz)^{2}\n```\n\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306e\u5b9a\u7fa9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3057\u305f\u306d\u3002\n\n```math\nJ = \\frac {1}{2}\\sum_{k=1}^{n} j(x_k, y_k)\n```\n\n\u6c42\u3081\u305f\u3044\u30d1\u30e9\u30e1\u30fc\u30bf\u306f$p_2$\u3068$p_3$\u3067\u3059\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u504f\u5fae\u5206\u3057\u307e\u3059\u3002\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306e\u5b9a\u7fa9\u306e1/2\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u504f\u5c0e\u95a2\u6570\u306b1/2\u3092\u3042\u3089\u304b\u3058\u3081\u639b\u3051\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002\n\n\u3055\u3063\u305d\u304f`Sympy`\u3067\u66f8\u3044\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```python\np0, p1, p2, p3, p4, px, t = symbols(\"p0 p1 p2 p3 p4 px t\")\n\nbz = (1-t)**3*p1 + 3*(1-t)**2*t*p2 + 3*(1-t)*t**2*p3 + t**3*p4\nj = (px - bz) ** 2\n\njp2 = simplify(diff(j, p2) / 2)\njp3 = simplify(diff(j, p3) / 2)\n```\n\n$p_2$\u3068$p_3$\u306e\u504f\u5c0e\u95a2\u6570\u306e1/2\u306f\u3001\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```math\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_2}\n=\n3 t \\left(t - 1\\right)^{2} \\left(- p_{1} \\left(t - 1\\right)^{3} + 3 p_{2} t \\left(t - 1\\right)^{2} - 3 p_{3} t^{2} \\left(t - 1\\right) + p_{4} t^{3} - px\\right)\n\\\\\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_3}\n=\n3 t^{2} \\left(t - 1\\right) \\left(p_{1} \\left(t - 1\\right)^{3} - 3 p_{2} t \\left(t - 1\\right)^{2} + 3 p_{3} t^{2} \\left(t - 1\\right) - p_{4} t^{3} + px\\right)\n```\n\n\u901a\u904e\u3055\u305b\u305f\u3044\u70b9$p_x$\u3068\u3001\u305d\u306e\u6642\u306b$t$\u306e\u30da\u30a2\u5024\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3001\u4f8b\u3068\u3057\u3066\u4ee5\u4e0b\u306e4\u70b9\u304c\u3042\u308b\u3068\u3057\u307e\u3059\u3002\n\n```python\npoints = [(0, 0), (0.2, 65), (0.7, 45), (1.0, 100)]\n```\n\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (5).png](https://qiita-image-store.s3.amazonaws.com/0/140075/ce6c5050-47e9-02e7-581a-df1b84581b17.png)\n\n\u59cb\u70b9\u3068\u7d42\u70b9\u304c$p_1$\u3068$p_4$\u306b\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u3053\u306e2\u3064\u306f\u65e2\u77e5\u306e\u5024\u3068\u306a\u308a\u307e\u3059\u3002\n\u6c42\u3081\u305f\u3044$p_2$\u3068$p_3$\u306b\u3064\u3044\u3066\u3001\u504f\u5c0e\u95a2\u6570\u306e\u7dcf\u548c\u3092\u9023\u5217\u65b9\u7a0b\u5f0f\u3067\u89e3\u304d\u307e\u3059\u3002\n\n```python\nconst = ((p1, points[0][1]), (p4, points[-1][1]))\ntp2 = sum([jp2.subs(const + ((t, x[0]), (px, x[1]))) for x in points[1:-1]])\ntp3 = sum([jp3.subs(const + ((t, x[0]), (px, x[1]))) for x in points[1:-1]])\n\nsolve([tp2, tp3], [p2, p3])\n# {p2:180.456349206349,p3:\u221253.0753968253968} \n```\n\u7b54\u3048\u306f`p2=180.456349206349,p3=\u221253.0753968253968`\u3067\u3059\u3002\n\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (6).png](https://qiita-image-store.s3.amazonaws.com/0/140075/4622d55c-6cdd-c37b-7b96-03174e8ba0ab.png)\n\n\u3061\u3083\u3093\u3068\u8fd1\u4f3c\u3067\u304d\u3066\u3044\u307e\u3059\u306d\uff01\n\n\u8272\u3005\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```python\npoints = [(0, 0), (0.3, 50), (0.7, 80), (1.0, 100)]\n```\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (7).png](https://qiita-image-store.s3.amazonaws.com/0/140075/8c79c155-3112-6f3c-374a-def73508d9ab.png)\n\n```python\npoints = [(0, 0), (0.2, 34), (0.4, 44), (0.6, 46), (0.8, 60), (1.0, 100)]\n```\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9 (10).png](https://qiita-image-store.s3.amazonaws.com/0/140075/75106f3c-6a57-a461-761a-c70195063757.png)\n\n\n\u3042\u307e\u308a\u6975\u7aef\u306a\u5024\u3067\u306a\u3044\u9650\u308a\u3001\u3061\u3083\u3093\u3068\u901a\u904e\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\u3082\u3061\u308d\u3093\u901a\u904e\u3067\u304d\u306a\u3044\u5024\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u306a\u3093\u3068\u306a\u304f\u305d\u308c\u3063\u307d\u304f\u7dda\u3092\u5f15\u3044\u3066\u304f\u308c\u307e\u3059\u3002\n\n## \u3044\u308d\u3044\u308d\u306a\u66f2\u7dda\u3092\u751f\u6210\u3057\u3066\u307f\u308b\n\n\u6700\u5f8c\u306bJupyter\u4e0a\u3067\u30d9\u30b8\u30a7\u66f2\u7dda\u3092\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3067\u8fd1\u4f3c\u3057\u3066\u3001\u30d7\u30ed\u30c3\u30c8\u3059\u308b\u30bb\u30eb\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n```python\n%matplotlib inline\nimport matplotlib.pyplot as plt\n\np0, p1, p2, p3, p4, px, t = symbols(\"p0 p1 p2 p3 p4 px t\")\n\nbz = (1-t)**3*p1 + 3*(1-t)**2*t*p2 + 3*(1-t)*t**2*p3 + t**3*p4\nj = (px - bz) ** 2\njp2 = simplify(diff(j, p2) / 2)\njp3 = simplify(diff(j, p3) / 2)\n    \ndef plot(points):\n    const = ((p1, points[0][1]), (p4, points[-1][1]))\n    tp2 = sum([jp2.subs(const + ((t, x[0]), (px, x[1]))) for x in points[1:-1]])\n    tp3 = sum([jp3.subs(const + ((t, x[0]), (px, x[1]))) for x in points[1:-1]])\n\n    vec = solve([tp2, tp3], [p2, p3])\n\n    const = {p1: points[0][1], p2: vec[p2], p3: vec[p3], p4: points[-1][1]}\n    bz2 = bz.subs(const)\n    x = np.arange(0, 1+0.01, 0.01)\n    y = [\n        bz2.subs(t, _t)\n        for _t in x\n    ]\n    plt.plot(x, y)\n    plt.scatter([p[0] for p in points], [p[1] for p in points])\n```\n\n`plot`\u95a2\u6570\u306b\u901a\u904e\u3057\u3066\u6b32\u3057\u3044\u70b9\u306e\u30ea\u30b9\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u3001\u6700\u5c0f\u4e8c\u4e57\u6cd5\u3067\u9811\u5f35\u3063\u3066\u305d\u306e\u70b9\u3092\u901a\u3063\u3066\u304f\u308c\u307e\u3059\u3002\n\u4f7f\u3044\u65b9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u547c\u3073\u307e\u3059\u3002\n\n```python\npoints = [(0, 0), (0.1, -40), (0.5, -50), (0.8, 30), (1.0, 100)]\nplot(points)\n```\n![\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9.png](https://qiita-image-store.s3.amazonaws.com/0/140075/ffd07906-0fce-f650-e03c-b3e550f84156.png)\n\n\n# Sympy\u3092\u4f7f\u308f\u306a\u3044\u3067\u89e3\u304f\n\nC/C++\u306a\u3069Sympy\u304c\u306a\u3044\u74b0\u5883\u3067\u306e\u5b9f\u88c5\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```math\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_2}\n=\n3 t \\left(t - 1\\right)^{2} \\left(- p_{1} \\left(t - 1\\right)^{3} + 3 p_{2} t \\left(t - 1\\right)^{2} - 3 p_{3} t^{2} \\left(t - 1\\right) + p_{4} t^{3} - px\\right)\n\\\\\n\\frac{1}{2} \\frac{\\partial j}{\\partial p_3}\n=\n3 t^{2} \\left(t - 1\\right) \\left(p_{1} \\left(t - 1\\right)^{3} - 3 p_{2} t \\left(t - 1\\right)^{2} + 3 p_{3} t^{2} \\left(t - 1\\right) - p_{4} t^{3} + px\\right)\n```\n\u3068\u306f\u3044\u3048\u3001\u4f7f\u7528\u3059\u308b\u306e\u306f\u4e0a\u306e\u7b97\u51fa\u6e08\u307f\u306e2\u5f0f\u3060\u3051\u3067\u3001\u4e0d\u660e\u306a\u70b9$p_2$\u3068$p_3$\u30921.0\u3068\u7f6e\u304d\u3001\u5404\u9805\u3054\u3068\u306b\u8a08\u7b97\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\u3067\u304d\u308b\u3060\u3051C/C++\u3063\u307d\u304f\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\n```python\ndef lsm(points):\n    ''' \u6700\u5c0f\u4e8c\u4e57\u6cd5\u306e\u89e3\u3092\u884c\u5217\u3067\u8fd4\u3059 '''\n    p1, p4 = points[0][1], points[-1][1]\n\n    a = b = c = d = e = f = 0.\n    for _t, _px in points[1:-1]:\n        _t_1_d = (_t - 1.) ** 2\n        _t_1 = (_t - 1.)\n        \n        _p1 = p1 * _t_1 \n        _p2 = 3 * _t * _t_1_d\n        _p3 = 3 * _t ** 2 * _t_1\n        _p4 = p4 * _t ** 3\n        \n        _j_p2 = 3 * _t * _t_1_d\n        _j_p3 = 3 * _t ** 2 * _t_1\n\n        a += _p2 * _j_p2\n        b += -_p3 * _j_p2\n        c += -_p2 * _j_p3\n        d += _p3 * _j_p3\n        e += -((-_p1 + _p4 - _px) * _j_p2)\n        f += -((_p1 - _p4 + _px) * _j_p3)\n\n    return [\n        [a, b],\n        [c, d]\n    ], [e, f]\n\n\ndef inv(mat, vec):\n    ''' \u9006\u884c\u5217\u3067\u9023\u7acb\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f '''\n    dm = mat[0][0] * mat[1][1] - mat[1][0] * mat[0][1]\n    assert (dm != 0.0)\n    \n    a = mat[1][1] / dm\n    b = -mat[0][1] / dm\n    c = -mat[1][0] / dm\n    d = mat[0][0] / dm\n    \n    return (vec[0] * a + vec[1] * b, \n            vec[0] * c + vec[1] * d)\n\npoints = [(0, 0), (0.2, 65), (0.7, 45), (1.0, 100)]\ninv(*lsm(points))\n```\n\n# \u3042\u3068\u304c\u304d\n\n\u6700\u5c0f\u4e8c\u4e57\u6cd5\u306f\u3001\u5fae\u5206\u53ef\u80fd\u306a\u95a2\u6570\u3067\u3042\u308c\u3070\u8fd1\u4f3c\u53ef\u80fd\u3068\u3044\u3046\u975e\u5e38\u306b\u5f37\u529b\u306a\u624b\u6cd5\u3067\u3059\u3002\n\n\u30d9\u30b8\u30a7\u66f2\u7dda\u306e\u8fd1\u4f3c\u306f\u30b2\u30fc\u30e0\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u5fdc\u7528\u3059\u308b\u3068\u697d\u3057\u305d\u3046\u3067\u3059\u306d\u3002\n\u504f\u5c0e\u95a2\u6570\u3092\u4e8b\u524d\u306b`Sympy`\u3067\u8a08\u7b97\u3057\u3066\u304a\u3051\u3070\u3001C/C++\u306a\u3069\u306e\u4ed6\u8a00\u8a9e\u3067\u3082\u9023\u7acb\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u5b9f\u88c5\u3059\u308b\u3060\u3051\u3067\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n\uff08\u9023\u7acb\u65b9\u7a0b\u5f0f\u306f\u300c\u30ac\u30a6\u30b9\u30b8\u30e7\u30eb\u30c0\u30f3\u306e\u6383\u304d\u51fa\u3057\u6cd5\u300d\u306a\u3069\u3001\u6ca2\u5c71\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u3042\u308a\u307e\u3059\uff09\n\n\u3084\u306f\u308a`Sympy`\u306f\u975e\u5e38\u306b\u5f37\u529b\u306a\u30c4\u30fc\u30eb\u3067\u3059\u306d\u3001\u5909\u6570\u304c\u591a\u3044\u6570\u5f0f\u3082\u7c21\u5358\u306b\u6700\u9069\u5316/\u8a08\u7b97\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u8a08\u7b97\u304c\u82e6\u624b\u306a\u306e\u3067\u975e\u5e38\u306b\u91cd\u5b9d\u3057\u3066\u3044\u307e\u3059\u3002\n"}