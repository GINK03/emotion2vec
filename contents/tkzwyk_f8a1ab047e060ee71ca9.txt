{"tags": ["SECCON2016", "CTF", "ctf4b", "writeup"], "context": "SECCON2016\u6c7a\u52dd\u5927\u4f1a\u3068\u540c\u6642\u958b\u50ac\u3055\u308c\u305f\u300cCTF for \u30d3\u30ae\u30ca\u30fc\u30ba 2016 FINAL @\u6771\u4eac\u300d\uff08\u901a\u79f0ctf4b\uff09\u306b\u53c2\u52a0\u3057\u305f\u306e\u3067\u3001\u89e3\u3044\u305f\u554f\u984c\u306e\u89e3\u8aac\uff08writeup\uff09\u3092\u8f09\u305b\u307e\u3059\u3002\nSECCON\u3068\u3044\u3046\u306e\u306f\u3001\u60c5\u5831\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u30c6\u30fc\u30de\u306b\u591a\u69d8\u306a\u7af6\u6280\u3092\u958b\u50ac\u3059\u308b\u60c5\u5831\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b3\u30f3\u30c6\u30b9\u30c8\u30a4\u30d9\u30f3\u30c8\u3067\u3059\u3002\uff08http://2016.seccon.jp/about/ \u3088\u308a\u5f15\u7528\uff09\nCTF\u306f\u300cCapture The Flag\u300d\u306e\u7565\u3067\u3001\u60c5\u5831\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u6280\u8853\u3092\u6d3b\u304b\u3057\u305f\u7af6\u6280\u306e\u3053\u3068\u3067\u3059\u3002\n\u8a73\u3057\u304f\u306f\u30ad\u30e3\u30d7\u30c1\u30e3\u30fc\u30fb\u30b6\u30fb\u30d5\u30e9\u30c3\u30b0 - Wikipedia\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u4ee5\u4e0b\u306e\u5404\u898b\u51fa\u3057\u306f\u300c\u554f\u984c\u540d (\u30dd\u30a4\u30f3\u30c8\u6570, \u30b8\u30e3\u30f3\u30eb)\u300d\u3067\u66f8\u3044\u3066\u3044\u307e\u3059\u3002\n\nWelcome (100, Misc)\n\n\u554f\u984c\u6587\nWelcome to CTF fo    r Beginners to Tokyo Final\n\nflag : ctf4b{CTF_for_Beginners_to_Tokyo_Final}\n\n\n\u89e3\u8aac\n\u7df4\u7fd2\u7528\u554f\u984c\u3002\n\u554f\u984c\u6587\u306b\u3042\u308b\u30d5\u30e9\u30b0\u304c\u7b54\u3048\u3002\n\nCountUp Game (200, Misc)\n\n\u554f\u984c\u6587\n\u4ea4\u4e92\u306b\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u3044\u3053\u3046\n\u305f\u3060\u3057\uff0c21\u3092\u8a00\u3063\u3066\u306f\u3044\u3051\u307e\u305b\u3093\n\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u30b2\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\nlinux: \u201cnc 172.20.1.30 10001\u201d\n\n\n\u89e3\u8aac\n\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3092Linux\u3067\u5b9f\u884c\u3059\u308b\u3068\u3001\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u30b2\u30fc\u30e0\u304c\u59cb\u307e\u308b\u3002\n\u30eb\u30fc\u30eb\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3002\n\uff08\u5b50\u4f9b\u306e\u3053\u308d\u306b\u7686\u904a\u3093\u3060\u3053\u3068\u304c\u3042\u308b\u3067\u3042\u308d\u3046\u300c30\u8a00\u3063\u305f\u3089\u8ca0\u3051\u30b2\u30fc\u30e0\u300d\u3068\u307b\u307c\u540c\u3058\uff09\n\n1\u304b\u3089\u9806\u306b\u76f8\u624b\uff08\u30d7\u30ed\u30b0\u30e9\u30e0\uff09\u3068\u4ea4\u4e92\u306b\u6570\u5b57\u3092\u8a00\u3063\u3066\u300121\u3092\u8a00\u3063\u305f\u307b\u3046\u304c\u8ca0\u3051\n1\u56de\u306b\u3064\u304d3\u3064\u307e\u3067\u6570\u5b57\u3092\u8a00\u3063\u3066\u3044\u3044\n\u5e38\u306b\u76f8\u624b\u304c\u5148\u653b\n\n\u753b\u9762\u306b\u306f\u300c0/10\u300d\u3068\u3044\u3046\u8868\u793a\u304c\u3042\u308a\u30011\u6226\u52dd\u3064\u3068\u300c1/10\u300d\u3068\u306a\u3063\u305f\u306e\u3067\u3001\n10\u6226\u52dd\u3066\u3070\u30d5\u30e9\u30b0\u304c\u30b2\u30c3\u30c8\u3067\u304d\u308b\u3068\u4e88\u60f3\u3057\u305f\u3002\n\u3053\u306e\u30b2\u30fc\u30e0\u3067\u5fc5\u305a\u52dd\u3064\u306b\u306f\u3001\u8a00\u3063\u3066\u306f\u3044\u3051\u306a\u3044\u6570\u5b57\u306e\u76f4\u524d\u306e\u6570\u5b57\uff08\u4eca\u56de\u306e\u5834\u5408\u306f 20\uff09\u304b\u30894\u306e\u500d\u6570\u3092\u5f15\u3044\u305f\u6570\uff08\u4eca\u56de\u306e\u5834\u5408\u306f 20,16,12,8,4\uff09\u3067\u81ea\u5206\u306e\u30bf\u30fc\u30f3\u304c\u7d42\u308f\u308b\u3088\u3046\u306b\u3059\u308c\u3070\u3044\u3044\u3002\n\u4f8b\u3048\u3070\u3001\u76f8\u624b\u304c\u300c1\u300d\u3068\u8a00\u3063\u305f\u3089\u3001\u81ea\u5206\u306f\u300c2,3,4\u300d\u3068\u8a00\u3046\u3002\n10\u6226\u7a0b\u5ea6\u306a\u3089\u5730\u9053\u306b\u4e0a\u8a18\u306e\u5fc5\u52dd\u6cd5\u306710\u6226\u52dd\u3064\u307b\u3046\u304c\u65e9\u3044\u3068\u5224\u65ad\u3057\u300110\u6226\u52dd\u3063\u3066\u7121\u4e8b\u306b\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8\n\uff08\u30b9\u30de\u30fc\u30c8\u306a\u89e3\u304d\u65b9\u3067\u306f\u306a\u3044\u3067\u3059\u306d\u7b11\uff09\n\nClassical Injection (100, Web)\n\n\u554f\u984c\u6587\nhttp://172.20.1.60/100_1/\n\n\n\u89e3\u8aac\n\u3046\u308d\u899a\u3048\u3060\u304c\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u4e0a\u8a18URL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u304c\u3042\u3063\u3066\u3001\n\u5358\u7d14\u306aSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3 ' or 1=1 --\u3092\u5165\u308c\u308b\u3068\u3001\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8\n\uff08\u304b\u306a\u308a\u8a18\u61b6\u304c\u3042\u3044\u307e\u3044\u3067\u3059\u3002\u3002\u3002\uff09\n\nMay the extensions be with you. (100, Web)\n\n\u554f\u984c\u6587\nhttp://172.20.1.60/100_2/\n\n\n\u89e3\u8aac\n\u30d6\u30e9\u30a6\u30b6\u3067\u4e0a\u8a18URL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u305f\u3002\n\uff08\u4f55\u304b\u6587\u304c\u66f8\u3044\u3066\u3042\u3063\u305f\u3051\u3069\u899a\u3048\u3066\u3044\u306a\u3044\u3002\u3002\u3002\uff09\n\u554f\u984c\u540d\u3092\u624b\u639b\u304b\u308a\u306b\u3001\u8b1b\u7fa9\u3067\u7fd2\u3063\u305fChrome Extension\u306eEditThisCookie\u3092\u4f7f\u3046\u3068\u3001\nfalse\u3068\u3044\u3046\u5024\u304c\u5165\u3063\u305fCookie\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u305f\u3002\n\u3053\u306e\u5024\u3092true\u306b\u66f8\u304d\u63db\u3048\u3066\u3001\u30da\u30fc\u30b8\u518d\u8aad\u307f\u8fbc\u307f\u3059\u308b\u3068\u3001\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8\n\uff08\u3053\u308c\u3082\u8a18\u61b6\u304c\u3042\u3044\u307e\u3044\u3002\u3002\u3002\uff09\n\n\u3042\u3051\u3066\u307f\u3088\u3046 (200, Forensics)\n\n\u554f\u984c\u6587\nhttp://172.20.1.1/ctf/forensics/for200-1.pcap\n\n\n\u89e3\u8aac\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3092Wireshark\u3067\u958b\u3044\u3066\u3001\u3068\u308a\u3042\u3048\u305ahttp\u3067\u30d5\u30a3\u30eb\u30bf\u3092\u304b\u3051\u308b\u3002\n\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306eHTTP\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u305d\u308c\u306b\u5bfe\u3059\u308b\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u898b\u3064\u304b\u3063\u305f\u3002\nGET /transfer.zip HTTP/1.1\nHTTP\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u30d1\u30b1\u30c3\u30c8\u3092\u9078\u629e\u3057\u3001\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306eFile -> Export Objects -> HTTP \u3067\u3001transfer.zip\u3092\u62bd\u51fa\u3002\nfile\u30b3\u30de\u30f3\u30c9\u3067zip\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001unzip\u3067\u5c55\u958b\u3059\u308b\u30682.pcap\u304c\u51fa\u3066\u304d\u305f\u3002\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ file transfer.zip \ntransfer.zip: Zip archive data, at least v2.0 to extract\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ unzip transfer.zip \nArchive:  transfer.zip\n  inflating: 2.pcap                  \nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ ll\n\u5408\u8a08 60\ndrwxrwxr-x 2 ctf4b ctf4b  4096  1\u6708 29 23:47 ./\ndrwxrwxr-x 9 ctf4b ctf4b  4096  1\u6708 29 22:20 ../\n-rw-rw-r-- 1 ctf4b ctf4b 16967 10\u6708 20 00:23 2.pcap\n-rw-rw-r-- 1 ctf4b ctf4b 13173  1\u6708 29 14:14 for200-1.pcap\n-rw-r--r-- 1 ctf4b ctf4b  9088  1\u6708 29 23:44 transfer.zip\n\n2.pcap\u3092Wireshark\u3067\u958b\u304d\u3001\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306eStatistics -> Protocol Hierarchy\u3067\u898b\u3066\u307f\u308b\u3068\u3001\nFTP\u306e\u30c7\u30fc\u30bf\u8ee2\u9001\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u660e\u3089\u304b\u306b\u602a\u3057\u3044\u306e\u3067\u3001FTP-DATA\u3067\u30d5\u30a3\u30eb\u30bf\u3059\u308b\u3068\u3001\u30d1\u30b1\u30c3\u30c8\u304c3\u3064\u898b\u3064\u304b\u3063\u305f\u3002\n\u305d\u306e\u4e2d\u3067\u4e00\u756a\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3044\u30d1\u30b1\u30c3\u30c8\u3092\u53f3\u30af\u30ea\u30c3\u30af -> Follow -> TCP Stream \u3092\u958b\u304f\u3002\nShow data as\u3092UTF-8\u306b\u3059\u308b\u3068\u3001\u5148\u982d\u306bPK\u306e\u6587\u5b57\u304c\u3042\u308b\u306e\u3067\u3001zip\u30d5\u30a1\u30a4\u30eb\u3068\u5224\u65ad\u3002\nShow data as\u3092raw\u306b\u3057\u3066\u3001hoge.zip\u3068\u3044\u3046\u540d\u524d\u3067\u4fdd\u5b58\u3002\nhoge.zip\u3092\u5c55\u958b\u3059\u308b\u3068\u3001secret\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u305d\u306e\u4e0b\u306bflag.png\u304c\u3042\u308b\u3002\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ ll\n\u5408\u8a08 68\ndrwxrwxr-x 2 ctf4b ctf4b  4096  1\u6708 29 23:49 ./\ndrwxrwxr-x 9 ctf4b ctf4b  4096  1\u6708 29 22:20 ../\n-rw-rw-r-- 1 ctf4b ctf4b 16967 10\u6708 20 00:23 2.pcap\n-rw-rw-r-- 1 ctf4b ctf4b 13173  1\u6708 29 14:14 for200-1.pcap\n-rw-rw-r-- 1 ctf4b ctf4b  6065  1\u6708 29 23:49 hoge.zip\n-rw-r--r-- 1 ctf4b ctf4b  9088  1\u6708 29 23:44 transfer.zip\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ file hoge.zip \nhoge.zip: Zip archive data, at least v1.0 to extract\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ unzip hoge.zip \nArchive:  hoge.zip\n   creating: secret/\n  inflating: secret/flag.png         \nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ ll\n\u5408\u8a08 72\ndrwxrwxr-x 3 ctf4b ctf4b  4096  1\u6708 29 23:49 ./\ndrwxrwxr-x 9 ctf4b ctf4b  4096  1\u6708 29 22:20 ../\n-rw-rw-r-- 1 ctf4b ctf4b 16967 10\u6708 20 00:23 2.pcap\n-rw-rw-r-- 1 ctf4b ctf4b 13173  1\u6708 29 14:14 for200-1.pcap\n-rw-rw-r-- 1 ctf4b ctf4b  6065  1\u6708 29 23:49 hoge.zip\ndrwxr-xr-x 2 ctf4b ctf4b  4096 10\u6708 20 00:09 secret/\n-rw-r--r-- 1 ctf4b ctf4b  9088  1\u6708 29 23:44 transfer.zip\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ \n\n\u3053\u306eflag.png\u3092\u753b\u50cf\u30d3\u30e5\u30ef\u30fc\u3067\u958b\u304f\u3068\u3001\u4ee5\u4e0b\u306e\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8\nctf4b{f0ll0w7cp57r34m}\n\uff08follow tcp stream\u3067\u3059\u306d\uff09\n\nHiddenFlag (100, Binary)\n\n\u554f\u984c\u6587\n\u30d5\u30e9\u30b0\u304c\u4f55\u51e6\u304b\u306b\u96a0\u308c\u3066\u3044\u308b\u30fb\u30fb\u30fb\n\n\u554f\u984c\u30d0\u30a4\u30ca\u30ea\uff1ahttp://172.20.1.1/ctf/binary/bin100_1\n\n\n\u89e3\u8aac\n\u4e0a\u8a18\u30d0\u30a4\u30ca\u30ea\u30d5\u30a1\u30a4\u30eb\u3092Download\u3057\u3066\u3001file\u30b3\u30de\u30f3\u30c9\u3067\u898b\u308b\u3068\u3001Linux\u306e\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\nctf4b@ctf4b-vm:~/Downloads/ctf/HiddenFlag$ file bin100_1 \nbin100_1: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=d36321b101c8d2681dbf919de7e09f69f1c15304, stripped\n\n\u3068\u308a\u3042\u3048\u305astrings\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8\nctf4b@ctf4b-vm:~/Downloads/ctf/HiddenFlag$ strings bin100_1 | grep ctf4b\nctf4b{fl4g_1n_d474_53gm3n7}\n\n\uff08flag_in_data_segment\u3067\u3059\u304b\u306d\uff09\n\n\u5fa9\u7fd2 (200, Binary)\n\n\u554f\u984c\u6587\n\u8b1b\u7fa9\u306e\u5185\u5bb9\u3092\u899a\u3048\u3066\u3044\u308b\u304b\u306a\uff1f\n\u601d\u3044\u51fa\u3057\u306a\u304c\u3089\uff0c\u8a08\u7b97\u3057\u3066\u307f\u3088\u3046\uff01\n\n\u9006\u30a2\u30bb\u30f3\u30d6\u30eb\u7d50\u679c\uff1ahttp://172.20.1.1/ctf/binary/bin200_1_objdump.txt\nflag\u5f62\u5f0f\uff1actf4b{Stage1\u306e\u7b54\u3048_Stage2\u306e\u7b54\u3048}\u3000\uff08\u4f8b\uff1actf4b{10_20}\uff09\n\n\n\u89e3\u8aac\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306f\u4e0b\u8a18\n\nbin200_1_objdump.txt\n0804865f <Stage1>:\n 804865f:       55                      push   ebp\n 8048660:       89 e5                   mov    ebp,esp\n 8048662:       83 ec 10                sub    esp,0x10\n 8048665:       8b 45 08                mov    eax,DWORD PTR [ebp+0x8]\n 8048668:       c7 00 0a 88 04 08       mov    DWORD PTR [eax],0x804880a\n 804866e:       90                      nop\n 804866f:       90                      nop\n 8048670:       c7 45 f8 03 00 00 00    mov    DWORD PTR [ebp-0x8],0x3\n 8048677:       8b 55 f8                mov    edx,DWORD PTR [ebp-0x8]\n 804867a:       89 d0                   mov    eax,edx\n 804867c:       c1 e0 03                shl    eax,0x3\n 804867f:       29 d0                   sub    eax,edx\n 8048681:       89 45 fc                mov    DWORD PTR [ebp-0x4],eax\n 8048684:       8b 45 fc                mov    eax,DWORD PTR [ebp-0x4]\n 8048687:       83 c0 02                add    eax,0x2\n 804868a:       89 45 f8                mov    DWORD PTR [ebp-0x8],eax\n 804868d:       90                      nop\n 804868e:       90                      nop\n 804868f:       8b 45 f8                mov    eax,DWORD PTR [ebp-0x8]\n 8048692:       c9                      leave  \n 8048693:       c3                      ret    \n\n08048694 <Stage2>:\n 8048694:       55                      push   ebp\n 8048695:       89 e5                   mov    ebp,esp\n 8048697:       83 ec 10                sub    esp,0x10\n 804869a:       8b 45 08                mov    eax,DWORD PTR [ebp+0x8]\n 804869d:       c7 00 11 88 04 08       mov    DWORD PTR [eax],0x8048811\n 80486a3:       90                      nop\n 80486a4:       90                      nop\n 80486a5:       c7 45 f8 01 00 00 00    mov    DWORD PTR [ebp-0x8],0x1\n 80486ac:       c7 45 fc 01 00 00 00    mov    DWORD PTR [ebp-0x4],0x1\n 80486b3:       eb 0e                   jmp    80486c3 <Stage2+0x2f>\n 80486b5:       8b 45 f8                mov    eax,DWORD PTR [ebp-0x8]\n 80486b8:       0f af 45 fc             imul   eax,DWORD PTR [ebp-0x4]\n 80486bc:       89 45 f8                mov    DWORD PTR [ebp-0x8],eax\n 80486bf:       83 45 fc 01             add    DWORD PTR [ebp-0x4],0x1\n 80486c3:       83 7d fc 05             cmp    DWORD PTR [ebp-0x4],0x5\n 80486c7:       7e ec                   jle    80486b5 <Stage2+0x21>\n 80486c9:       90                      nop\n 80486ca:       90                      nop\n 80486cb:       8b 45 f8                mov    eax,DWORD PTR [ebp-0x8]\n 80486ce:       c9                      leave  \n 80486cf:       c3                      ret \n\n\nStage1\u3068Stage2\u3067eax\u30ec\u30b8\u30b9\u30bf\u306b\u6700\u5f8c\u306b\u5165\u308b\u5024\u3092\u5730\u9053\u306b\u8a08\u7b97\u3059\u308b\u3068\u3001\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8\nStage2\u306f\u8b1b\u7fa9\u3067\u3084\u3063\u305f\u3084\u3064\uff081\u304b\u30895\u306e\u7dcf\u548c\u3092\u6c42\u3081\u308b\u51e6\u7406\uff09\u3068\u51e6\u7406\u5185\u5bb9\u304c\u304b\u306a\u308a\u4f3c\u3066\u305f\u306e\u3068\u3001imul\u547d\u4ee4\u304c\u3042\u308b\u3053\u3068\u304b\u3089\u3001\u7b54\u3048\u306f5\u306e\u968e\u4e57\u3060\u3068\u4e88\u60f3\u3057\u305f\u3089\u898b\u4e8b\u6b63\u89e3\u3002\n\nUnusedFunction (200, Binary)\n\n\u554f\u984c\u6587\n\u4f7f\u308f\u308c\u3066\u3044\u306a\u3044\u95a2\u6570\u304c\u3042\u308b\u305e\n\n\u554f\u984c\u30d0\u30a4\u30ca\u30ea\uff1ahttp://172.20.1.1/ctf/binary/bin200_2\n\n\n\u89e3\u8aac\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3092Download\u3057\u3066\u3001\u3068\u308a\u3042\u3048\u305afile\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ file bin200_2\nbin200_2: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=89e81238c140040714f5eeabeb2c9c2f8c380ddf, not stripped\n\nLinux\u306e\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u5b9f\u884c\u3059\u308b\u3002\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ ./bin200_2 \nHow can I generate flag ??\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$\n\nflag\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u3092\u5c0b\u306d\u3089\u308c\u305f\u3002\u3002\u3002\n\u6b21\u306bobjdump\u3057\u3066\u307f\u308b\u3002\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ objdump -M intel -d bin200_2 > dump.txt\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ ll\n\u5408\u8a08 36\ndrwxrwxr-x 2 ctf4b ctf4b  4096  1\u6708 30 22:29 ./\ndrwxrwxr-x 9 ctf4b ctf4b  4096  1\u6708 29 22:20 ../\n-rwxrw-r-- 1 ctf4b ctf4b  7413  1\u6708 29 14:22 bin200_2*\n-rw-rw-r-- 1 ctf4b ctf4b 14000  1\u6708 30 22:29 dump.txt\n\ndump.txt\u306emain\u95a2\u6570\u4ed8\u8fd1\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\nmain\u95a2\u6570\u306e\u3059\u3050\u4e0b\u306bgenflag\u3068\u3044\u3046\u660e\u3089\u304b\u306b\u602a\u3057\u3044\u95a2\u6570\u304c\u3042\u308b\u3002\n\ndump.txt\n0804849d <main>:\n 804849d:   55                      push   ebp\n 804849e:   89 e5                   mov    ebp,esp\n 80484a0:   83 e4 f0                and    esp,0xfffffff0\n 80484a3:   83 ec 10                sub    esp,0x10\n 80484a6:   c7 04 24 30 86 04 08    mov    DWORD PTR [esp],0x8048630\n 80484ad:   e8 be fe ff ff          call   8048370 <puts@plt>\n 80484b2:   c9                      leave  \n 80484b3:   c3                      ret    \n\n080484b4 <genflag>:\n 80484b4:   55                      push   ebp\n 80484b5:   89 e5                   mov    ebp,esp\n 80484b7:   53                      push   ebx\n 80484b8:   83 ec 44                sub    esp,0x44\n 80484bb:   65 a1 14 00 00 00       mov    eax,gs:0x14\n 80484c1:   89 45 f4                mov    DWORD PTR [ebp-0xc],eax\n 80484c4:   31 c0                   xor    eax,eax\n 80484c6:   c6 45 d5 63             mov    BYTE PTR [ebp-0x2b],0x63\n 80484ca:   c6 45 d6 74             mov    BYTE PTR [ebp-0x2a],0x74\n 80484ce:   c6 45 d7 66             mov    BYTE PTR [ebp-0x29],0x66\n 80484d2:   c6 45 d8 34             mov    BYTE PTR [ebp-0x28],0x34\n 80484d6:   c6 45 d9 62             mov    BYTE PTR [ebp-0x27],0x62\n 80484da:   c6 45 da 7b             mov    BYTE PTR [ebp-0x26],0x7b\n 80484de:   c6 45 db 34             mov    BYTE PTR [ebp-0x25],0x34\n 80484e2:   c6 45 dc 6e             mov    BYTE PTR [ebp-0x24],0x6e\n 80484e6:   c6 45 dd 34             mov    BYTE PTR [ebp-0x23],0x34\n 80484ea:   c6 45 de 6c             mov    BYTE PTR [ebp-0x22],0x6c\n 80484ee:   c6 45 df 79             mov    BYTE PTR [ebp-0x21],0x79\n 80484f2:   c6 45 e0 7a             mov    BYTE PTR [ebp-0x20],0x7a\n 80484f6:   c6 45 e1 33             mov    BYTE PTR [ebp-0x1f],0x33\n 80484fa:   c6 45 e2 5f             mov    BYTE PTR [ebp-0x1e],0x5f\n 80484fe:   c6 45 e3 75             mov    BYTE PTR [ebp-0x1d],0x75\n 8048502:   c6 45 e4 6e             mov    BYTE PTR [ebp-0x1c],0x6e\n 8048506:   c6 45 e5 75             mov    BYTE PTR [ebp-0x1b],0x75\n 804850a:   c6 45 e6 35             mov    BYTE PTR [ebp-0x1a],0x35\n 804850e:   c6 45 e7 33             mov    BYTE PTR [ebp-0x19],0x33\n 8048512:   c6 45 e8 64             mov    BYTE PTR [ebp-0x18],0x64\n 8048516:   c6 45 e9 5f             mov    BYTE PTR [ebp-0x17],0x5f\n 804851a:   c6 45 ea 66             mov    BYTE PTR [ebp-0x16],0x66\n 804851e:   c6 45 eb 75             mov    BYTE PTR [ebp-0x15],0x75\n 8048522:   c6 45 ec 6e             mov    BYTE PTR [ebp-0x14],0x6e\n 8048526:   c6 45 ed 63             mov    BYTE PTR [ebp-0x13],0x63\n 804852a:   c6 45 ee 37             mov    BYTE PTR [ebp-0x12],0x37\n 804852e:   c6 45 ef 31             mov    BYTE PTR [ebp-0x11],0x31\n 8048532:   c6 45 f0 30             mov    BYTE PTR [ebp-0x10],0x30\n 8048536:   c6 45 f1 6e             mov    BYTE PTR [ebp-0xf],0x6e\n 804853a:   c6 45 f2 7d             mov    BYTE PTR [ebp-0xe],0x7d\n 804853e:   c6 45 f3 00             mov    BYTE PTR [ebp-0xd],0x0\n 8048542:   c7 04 24 07 00 00 00    mov    DWORD PTR [esp],0x7\n 8048549:   e8 12 fe ff ff          call   8048360 <malloc@plt>\n 804854e:   89 45 d0                mov    DWORD PTR [ebp-0x30],eax\n 8048551:   c7 45 cc 00 00 00 00    mov    DWORD PTR [ebp-0x34],0x0\n 8048558:   eb 19                   jmp    8048573 <genflag+0xbf>\n 804855a:   8b 55 cc                mov    edx,DWORD PTR [ebp-0x34]\n 804855d:   8b 45 d0                mov    eax,DWORD PTR [ebp-0x30]\n 8048560:   01 c2                   add    edx,eax\n 8048562:   8d 4d d5                lea    ecx,[ebp-0x2b]\n 8048565:   8b 45 cc                mov    eax,DWORD PTR [ebp-0x34]\n 8048568:   01 c8                   add    eax,ecx\n 804856a:   0f b6 00                movzx  eax,BYTE PTR [eax]\n 804856d:   88 02                   mov    BYTE PTR [edx],al\n 804856f:   83 45 cc 01             add    DWORD PTR [ebp-0x34],0x1\n 8048573:   8b 45 cc                mov    eax,DWORD PTR [ebp-0x34]\n 8048576:   83 f8 06                cmp    eax,0x6\n 8048579:   76 df                   jbe    804855a <genflag+0xa6>\n 804857b:   8b 45 d0                mov    eax,DWORD PTR [ebp-0x30]\n 804857e:   8b 5d f4                mov    ebx,DWORD PTR [ebp-0xc]\n 8048581:   65 33 1d 14 00 00 00    xor    ebx,DWORD PTR gs:0x14\n 8048588:   74 05                   je     804858f <genflag+0xdb>\n 804858a:   e8 c1 fd ff ff          call   8048350 <__stack_chk_fail@plt>\n 804858f:   83 c4 44                add    esp,0x44\n 8048592:   5b                      pop    ebx\n 8048593:   5d                      pop    ebp\n 8048594:   c3                      ret    \n 8048595:   66 90                   xchg   ax,ax\n 8048597:   66 90                   xchg   ax,ax\n 8048599:   66 90                   xchg   ax,ax\n 804859b:   66 90                   xchg   ax,ax\n 804859d:   66 90                   xchg   ax,ax\n 804859f:   90                      nop\n\n\nmov    BYTE PTR \uff5e\u3068\u3044\u3046\u547d\u4ee4\u304c\u305a\u3089\u3063\u3068\u7d9a\u304f\u90e8\u5206\u304c\u30d5\u30e9\u30b0\u3063\u307d\u3044\u5302\u3044\u304c\u3059\u308b\u306e\u3067\u3001\n\u7b2c2\u30aa\u30da\u30e9\u30f3\u30c9\u306e16\u9032\u6570\u5024\u3092\u629c\u304d\u51fa\u3057\u3066\u3001Ruby\u3067ASCII\u6587\u5b57\u306b\u5909\u63db\u3059\u308b\u3068\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ irb\nirb(main):001:0> [\"63\", \"74\", \"66\", \"34\", \"62\", \"7b\", \"34\", \"6e\", \"34\", \"6c\", \"79\", \"7a\", \"33\", \"5f\", \"75\", \"6e\", \"75\", \"35\", \"33\", \"64\", \"5f\", \"66\", \"75\", \"6e\", \"63\", \"37\", \"31\", \"30\", \"6e\", \"7d\", \"0\"].each{|c| print c.hex.chr}; puts\nctf4b{4n4lyz3_unu53d_func710n}\n=> nil\n\n\n\u611f\u60f3\n\u7d04400\u540d\u4e2d\u300112\u4f4d\u3060\u3063\u305f\u306e\u3067\u5b09\u3057\u3055\u3082\u3042\u3063\u305f\u3051\u3069\u3001\u7c21\u5358\u306a\u554f\u984c\uff08Forensics\u306e100\u70b9\u554f\u984c\uff09\u3092\u89e3\u3051\u306a\u304b\u3063\u305f\u308a\u3001\u60dc\u3057\u3044\u3068\u3053\u308d\u307e\u3067\u3044\u3063\u305f\u554f\u984c\u304c\u3044\u304f\u3064\u304b\u3042\u3063\u305f\u308a\u3057\u305f\u306e\u304c\u6094\u3057\u3044\u3002\n\u6f14\u7fd2\u524d\u306b\u884c\u308f\u308c\u305f\u8b1b\u7fa9\u306f\u5c11\u3057\u30da\u30fc\u30b9\u304c\u901f\u304f\u3066\u3001\u3064\u3044\u3066\u3044\u304f\u306e\u3067\u7cbe\u4e00\u676f\u3060\u3063\u305f\u3051\u3069\u3001\u5f79\u7acb\u3064\u30c4\u30fc\u30eb\uff08binwalk, fls\u306a\u3069\uff09\u3084\u554f\u984c\u3078\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\u65b9\u6cd5\u3092\u5b66\u3079\u305f\u306e\u3067\u975e\u5e38\u306b\u6709\u610f\u7fa9\u3060\u3063\u305f\u3002\nSECCON2016\u6c7a\u52dd\u5927\u4f1a\u3068\u540c\u6642\u958b\u50ac\u3055\u308c\u305f\u300cCTF for \u30d3\u30ae\u30ca\u30fc\u30ba 2016 FINAL @\u6771\u4eac\u300d\uff08\u901a\u79f0ctf4b\uff09\u306b\u53c2\u52a0\u3057\u305f\u306e\u3067\u3001\u89e3\u3044\u305f\u554f\u984c\u306e\u89e3\u8aac\uff08writeup\uff09\u3092\u8f09\u305b\u307e\u3059\u3002\n\nSECCON\u3068\u3044\u3046\u306e\u306f\u3001\u60c5\u5831\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u30c6\u30fc\u30de\u306b\u591a\u69d8\u306a\u7af6\u6280\u3092\u958b\u50ac\u3059\u308b\u60c5\u5831\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b3\u30f3\u30c6\u30b9\u30c8\u30a4\u30d9\u30f3\u30c8\u3067\u3059\u3002\uff08http://2016.seccon.jp/about/ \u3088\u308a\u5f15\u7528\uff09\n\nCTF\u306f\u300cCapture The Flag\u300d\u306e\u7565\u3067\u3001\u60c5\u5831\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u6280\u8853\u3092\u6d3b\u304b\u3057\u305f\u7af6\u6280\u306e\u3053\u3068\u3067\u3059\u3002\n\u8a73\u3057\u304f\u306f[\u30ad\u30e3\u30d7\u30c1\u30e3\u30fc\u30fb\u30b6\u30fb\u30d5\u30e9\u30c3\u30b0 - Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%AD%E3%83%A3%E3%83%97%E3%83%81%E3%83%A3%E3%83%BC%E3%83%BB%E3%82%B6%E3%83%BB%E3%83%95%E3%83%A9%E3%83%83%E3%82%B0)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u4ee5\u4e0b\u306e\u5404\u898b\u51fa\u3057\u306f\u300c\u554f\u984c\u540d (\u30dd\u30a4\u30f3\u30c8\u6570, \u30b8\u30e3\u30f3\u30eb)\u300d\u3067\u66f8\u3044\u3066\u3044\u307e\u3059\u3002\n# Welcome (100, Misc)\n## \u554f\u984c\u6587\n```\nWelcome to CTF fo    r Beginners to Tokyo Final\n\nflag : ctf4b{CTF_for_Beginners_to_Tokyo_Final}\n```\n## \u89e3\u8aac\n\u7df4\u7fd2\u7528\u554f\u984c\u3002\n\u554f\u984c\u6587\u306b\u3042\u308b\u30d5\u30e9\u30b0\u304c\u7b54\u3048\u3002\n\n# CountUp Game (200, Misc)\n## \u554f\u984c\u6587\n```\n\u4ea4\u4e92\u306b\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u3066\u3044\u3053\u3046\n\u305f\u3060\u3057\uff0c21\u3092\u8a00\u3063\u3066\u306f\u3044\u3051\u307e\u305b\u3093\n\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u30b2\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\nlinux: \u201cnc 172.20.1.30 10001\u201d\n```\n## \u89e3\u8aac\n\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3092Linux\u3067\u5b9f\u884c\u3059\u308b\u3068\u3001\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u30b2\u30fc\u30e0\u304c\u59cb\u307e\u308b\u3002\n\u30eb\u30fc\u30eb\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3002\n\uff08\u5b50\u4f9b\u306e\u3053\u308d\u306b\u7686\u904a\u3093\u3060\u3053\u3068\u304c\u3042\u308b\u3067\u3042\u308d\u3046\u300c30\u8a00\u3063\u305f\u3089\u8ca0\u3051\u30b2\u30fc\u30e0\u300d\u3068\u307b\u307c\u540c\u3058\uff09\n\n - 1\u304b\u3089\u9806\u306b\u76f8\u624b\uff08\u30d7\u30ed\u30b0\u30e9\u30e0\uff09\u3068\u4ea4\u4e92\u306b\u6570\u5b57\u3092\u8a00\u3063\u3066\u300121\u3092\u8a00\u3063\u305f\u307b\u3046\u304c\u8ca0\u3051\n - 1\u56de\u306b\u3064\u304d3\u3064\u307e\u3067\u6570\u5b57\u3092\u8a00\u3063\u3066\u3044\u3044\n - \u5e38\u306b\u76f8\u624b\u304c\u5148\u653b\n\n\u753b\u9762\u306b\u306f\u300c0/10\u300d\u3068\u3044\u3046\u8868\u793a\u304c\u3042\u308a\u30011\u6226\u52dd\u3064\u3068\u300c1/10\u300d\u3068\u306a\u3063\u305f\u306e\u3067\u3001\n10\u6226\u52dd\u3066\u3070\u30d5\u30e9\u30b0\u304c\u30b2\u30c3\u30c8\u3067\u304d\u308b\u3068\u4e88\u60f3\u3057\u305f\u3002\n\n\u3053\u306e\u30b2\u30fc\u30e0\u3067\u5fc5\u305a\u52dd\u3064\u306b\u306f\u3001\u8a00\u3063\u3066\u306f\u3044\u3051\u306a\u3044\u6570\u5b57\u306e\u76f4\u524d\u306e\u6570\u5b57\uff08\u4eca\u56de\u306e\u5834\u5408\u306f 20\uff09\u304b\u30894\u306e\u500d\u6570\u3092\u5f15\u3044\u305f\u6570\uff08\u4eca\u56de\u306e\u5834\u5408\u306f 20,16,12,8,4\uff09\u3067\u81ea\u5206\u306e\u30bf\u30fc\u30f3\u304c\u7d42\u308f\u308b\u3088\u3046\u306b\u3059\u308c\u3070\u3044\u3044\u3002\n\u4f8b\u3048\u3070\u3001\u76f8\u624b\u304c\u300c1\u300d\u3068\u8a00\u3063\u305f\u3089\u3001\u81ea\u5206\u306f\u300c2,3,4\u300d\u3068\u8a00\u3046\u3002\n\n10\u6226\u7a0b\u5ea6\u306a\u3089\u5730\u9053\u306b\u4e0a\u8a18\u306e\u5fc5\u52dd\u6cd5\u306710\u6226\u52dd\u3064\u307b\u3046\u304c\u65e9\u3044\u3068\u5224\u65ad\u3057\u300110\u6226\u52dd\u3063\u3066\u7121\u4e8b\u306b\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8:grinning:\n\uff08\u30b9\u30de\u30fc\u30c8\u306a\u89e3\u304d\u65b9\u3067\u306f\u306a\u3044\u3067\u3059\u306d\u7b11\uff09\n\n# Classical Injection (100, Web)\n## \u554f\u984c\u6587\n```\nhttp://172.20.1.60/100_1/\n```\n## \u89e3\u8aac\n\u3046\u308d\u899a\u3048\u3060\u304c\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u4e0a\u8a18URL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u304c\u3042\u3063\u3066\u3001\n\u5358\u7d14\u306aSQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3 `' or 1=1 --`\u3092\u5165\u308c\u308b\u3068\u3001\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8:grinning:\n\uff08\u304b\u306a\u308a\u8a18\u61b6\u304c\u3042\u3044\u307e\u3044\u3067\u3059\u3002\u3002\u3002\uff09\n# May the extensions be with you. (100, Web)\n## \u554f\u984c\u6587\n```\nhttp://172.20.1.60/100_2/\n```\n## \u89e3\u8aac\n\u30d6\u30e9\u30a6\u30b6\u3067\u4e0a\u8a18URL\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u305f\u3002\n\uff08\u4f55\u304b\u6587\u304c\u66f8\u3044\u3066\u3042\u3063\u305f\u3051\u3069\u899a\u3048\u3066\u3044\u306a\u3044\u3002\u3002\u3002\uff09\n\u554f\u984c\u540d\u3092\u624b\u639b\u304b\u308a\u306b\u3001\u8b1b\u7fa9\u3067\u7fd2\u3063\u305fChrome Extension\u306eEditThisCookie\u3092\u4f7f\u3046\u3068\u3001\n`false`\u3068\u3044\u3046\u5024\u304c\u5165\u3063\u305fCookie\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u305f\u3002\n\u3053\u306e\u5024\u3092`true`\u306b\u66f8\u304d\u63db\u3048\u3066\u3001\u30da\u30fc\u30b8\u518d\u8aad\u307f\u8fbc\u307f\u3059\u308b\u3068\u3001\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8:grinning:\n\uff08\u3053\u308c\u3082\u8a18\u61b6\u304c\u3042\u3044\u307e\u3044\u3002\u3002\u3002\uff09\n\n# \u3042\u3051\u3066\u307f\u3088\u3046 (200, Forensics)\n## \u554f\u984c\u6587\n```\nhttp://172.20.1.1/ctf/forensics/for200-1.pcap\n```\n## \u89e3\u8aac\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3092Wireshark\u3067\u958b\u3044\u3066\u3001\u3068\u308a\u3042\u3048\u305ahttp\u3067\u30d5\u30a3\u30eb\u30bf\u3092\u304b\u3051\u308b\u3002\n\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306eHTTP\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u305d\u308c\u306b\u5bfe\u3059\u308b\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u898b\u3064\u304b\u3063\u305f\u3002\n`GET /transfer.zip HTTP/1.1`\nHTTP\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u30d1\u30b1\u30c3\u30c8\u3092\u9078\u629e\u3057\u3001\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306eFile -> Export Objects -> HTTP \u3067\u3001`transfer.zip`\u3092\u62bd\u51fa\u3002\n\nfile\u30b3\u30de\u30f3\u30c9\u3067zip\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001unzip\u3067\u5c55\u958b\u3059\u308b\u3068`2.pcap`\u304c\u51fa\u3066\u304d\u305f\u3002\n\n```\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ file transfer.zip \ntransfer.zip: Zip archive data, at least v2.0 to extract\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ unzip transfer.zip \nArchive:  transfer.zip\n  inflating: 2.pcap                  \nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ ll\n\u5408\u8a08 60\ndrwxrwxr-x 2 ctf4b ctf4b  4096  1\u6708 29 23:47 ./\ndrwxrwxr-x 9 ctf4b ctf4b  4096  1\u6708 29 22:20 ../\n-rw-rw-r-- 1 ctf4b ctf4b 16967 10\u6708 20 00:23 2.pcap\n-rw-rw-r-- 1 ctf4b ctf4b 13173  1\u6708 29 14:14 for200-1.pcap\n-rw-r--r-- 1 ctf4b ctf4b  9088  1\u6708 29 23:44 transfer.zip\n```\n`2.pcap`\u3092Wireshark\u3067\u958b\u304d\u3001\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306eStatistics -> Protocol Hierarchy\u3067\u898b\u3066\u307f\u308b\u3068\u3001\nFTP\u306e\u30c7\u30fc\u30bf\u8ee2\u9001\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\u660e\u3089\u304b\u306b\u602a\u3057\u3044\u306e\u3067\u3001FTP-DATA\u3067\u30d5\u30a3\u30eb\u30bf\u3059\u308b\u3068\u3001\u30d1\u30b1\u30c3\u30c8\u304c3\u3064\u898b\u3064\u304b\u3063\u305f\u3002\n\u305d\u306e\u4e2d\u3067\u4e00\u756a\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3044\u30d1\u30b1\u30c3\u30c8\u3092\u53f3\u30af\u30ea\u30c3\u30af -> Follow -> TCP Stream \u3092\u958b\u304f\u3002\n`Show data as`\u3092`UTF-8`\u306b\u3059\u308b\u3068\u3001\u5148\u982d\u306b`PK`\u306e\u6587\u5b57\u304c\u3042\u308b\u306e\u3067\u3001zip\u30d5\u30a1\u30a4\u30eb\u3068\u5224\u65ad\u3002\n`Show data as`\u3092`raw`\u306b\u3057\u3066\u3001`hoge.zip`\u3068\u3044\u3046\u540d\u524d\u3067\u4fdd\u5b58\u3002\n\n`hoge.zip`\u3092\u5c55\u958b\u3059\u308b\u3068\u3001`secret`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u305d\u306e\u4e0b\u306b`flag.png`\u304c\u3042\u308b\u3002\n\n```\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ ll\n\u5408\u8a08 68\ndrwxrwxr-x 2 ctf4b ctf4b  4096  1\u6708 29 23:49 ./\ndrwxrwxr-x 9 ctf4b ctf4b  4096  1\u6708 29 22:20 ../\n-rw-rw-r-- 1 ctf4b ctf4b 16967 10\u6708 20 00:23 2.pcap\n-rw-rw-r-- 1 ctf4b ctf4b 13173  1\u6708 29 14:14 for200-1.pcap\n-rw-rw-r-- 1 ctf4b ctf4b  6065  1\u6708 29 23:49 hoge.zip\n-rw-r--r-- 1 ctf4b ctf4b  9088  1\u6708 29 23:44 transfer.zip\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ file hoge.zip \nhoge.zip: Zip archive data, at least v1.0 to extract\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ unzip hoge.zip \nArchive:  hoge.zip\n   creating: secret/\n  inflating: secret/flag.png         \nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ ll\n\u5408\u8a08 72\ndrwxrwxr-x 3 ctf4b ctf4b  4096  1\u6708 29 23:49 ./\ndrwxrwxr-x 9 ctf4b ctf4b  4096  1\u6708 29 22:20 ../\n-rw-rw-r-- 1 ctf4b ctf4b 16967 10\u6708 20 00:23 2.pcap\n-rw-rw-r-- 1 ctf4b ctf4b 13173  1\u6708 29 14:14 for200-1.pcap\n-rw-rw-r-- 1 ctf4b ctf4b  6065  1\u6708 29 23:49 hoge.zip\ndrwxr-xr-x 2 ctf4b ctf4b  4096 10\u6708 20 00:09 secret/\n-rw-r--r-- 1 ctf4b ctf4b  9088  1\u6708 29 23:44 transfer.zip\nctf4b@ctf4b-vm:~/Downloads/ctf/aketemiyou$ \n```\n\u3053\u306e`flag.png`\u3092\u753b\u50cf\u30d3\u30e5\u30ef\u30fc\u3067\u958b\u304f\u3068\u3001\u4ee5\u4e0b\u306e\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8:grinning:\n`ctf4b{f0ll0w7cp57r34m}`\n\uff08follow tcp stream\u3067\u3059\u306d\uff09\n# HiddenFlag (100, Binary)\n## \u554f\u984c\u6587\n```\n\u30d5\u30e9\u30b0\u304c\u4f55\u51e6\u304b\u306b\u96a0\u308c\u3066\u3044\u308b\u30fb\u30fb\u30fb\n\n\u554f\u984c\u30d0\u30a4\u30ca\u30ea\uff1ahttp://172.20.1.1/ctf/binary/bin100_1\n```\n## \u89e3\u8aac\n\u4e0a\u8a18\u30d0\u30a4\u30ca\u30ea\u30d5\u30a1\u30a4\u30eb\u3092Download\u3057\u3066\u3001file\u30b3\u30de\u30f3\u30c9\u3067\u898b\u308b\u3068\u3001Linux\u306e\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n```\nctf4b@ctf4b-vm:~/Downloads/ctf/HiddenFlag$ file bin100_1 \nbin100_1: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=d36321b101c8d2681dbf919de7e09f69f1c15304, stripped\n```\n\u3068\u308a\u3042\u3048\u305astrings\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8:grinning:\n\n```\nctf4b@ctf4b-vm:~/Downloads/ctf/HiddenFlag$ strings bin100_1 | grep ctf4b\nctf4b{fl4g_1n_d474_53gm3n7}\n```\n\uff08flag_in_data_segment\u3067\u3059\u304b\u306d\uff09\n# \u5fa9\u7fd2 (200, Binary)\n## \u554f\u984c\u6587\n```\n\u8b1b\u7fa9\u306e\u5185\u5bb9\u3092\u899a\u3048\u3066\u3044\u308b\u304b\u306a\uff1f\n\u601d\u3044\u51fa\u3057\u306a\u304c\u3089\uff0c\u8a08\u7b97\u3057\u3066\u307f\u3088\u3046\uff01\n\n\u9006\u30a2\u30bb\u30f3\u30d6\u30eb\u7d50\u679c\uff1ahttp://172.20.1.1/ctf/binary/bin200_1_objdump.txt\nflag\u5f62\u5f0f\uff1actf4b{Stage1\u306e\u7b54\u3048_Stage2\u306e\u7b54\u3048}\u3000\uff08\u4f8b\uff1actf4b{10_20}\uff09\n```\n## \u89e3\u8aac\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306f\u4e0b\u8a18\n\n```:bin200_1_objdump.txt\n0804865f <Stage1>:\n 804865f:       55                      push   ebp\n 8048660:       89 e5                   mov    ebp,esp\n 8048662:       83 ec 10                sub    esp,0x10\n 8048665:       8b 45 08                mov    eax,DWORD PTR [ebp+0x8]\n 8048668:       c7 00 0a 88 04 08       mov    DWORD PTR [eax],0x804880a\n 804866e:       90                      nop\n 804866f:       90                      nop\n 8048670:       c7 45 f8 03 00 00 00    mov    DWORD PTR [ebp-0x8],0x3\n 8048677:       8b 55 f8                mov    edx,DWORD PTR [ebp-0x8]\n 804867a:       89 d0                   mov    eax,edx\n 804867c:       c1 e0 03                shl    eax,0x3\n 804867f:       29 d0                   sub    eax,edx\n 8048681:       89 45 fc                mov    DWORD PTR [ebp-0x4],eax\n 8048684:       8b 45 fc                mov    eax,DWORD PTR [ebp-0x4]\n 8048687:       83 c0 02                add    eax,0x2\n 804868a:       89 45 f8                mov    DWORD PTR [ebp-0x8],eax\n 804868d:       90                      nop\n 804868e:       90                      nop\n 804868f:       8b 45 f8                mov    eax,DWORD PTR [ebp-0x8]\n 8048692:       c9                      leave  \n 8048693:       c3                      ret    \n\n08048694 <Stage2>:\n 8048694:       55                      push   ebp\n 8048695:       89 e5                   mov    ebp,esp\n 8048697:       83 ec 10                sub    esp,0x10\n 804869a:       8b 45 08                mov    eax,DWORD PTR [ebp+0x8]\n 804869d:       c7 00 11 88 04 08       mov    DWORD PTR [eax],0x8048811\n 80486a3:       90                      nop\n 80486a4:       90                      nop\n 80486a5:       c7 45 f8 01 00 00 00    mov    DWORD PTR [ebp-0x8],0x1\n 80486ac:       c7 45 fc 01 00 00 00    mov    DWORD PTR [ebp-0x4],0x1\n 80486b3:       eb 0e                   jmp    80486c3 <Stage2+0x2f>\n 80486b5:       8b 45 f8                mov    eax,DWORD PTR [ebp-0x8]\n 80486b8:       0f af 45 fc             imul   eax,DWORD PTR [ebp-0x4]\n 80486bc:       89 45 f8                mov    DWORD PTR [ebp-0x8],eax\n 80486bf:       83 45 fc 01             add    DWORD PTR [ebp-0x4],0x1\n 80486c3:       83 7d fc 05             cmp    DWORD PTR [ebp-0x4],0x5\n 80486c7:       7e ec                   jle    80486b5 <Stage2+0x21>\n 80486c9:       90                      nop\n 80486ca:       90                      nop\n 80486cb:       8b 45 f8                mov    eax,DWORD PTR [ebp-0x8]\n 80486ce:       c9                      leave  \n 80486cf:       c3                      ret \n```\n\nStage1\u3068Stage2\u3067eax\u30ec\u30b8\u30b9\u30bf\u306b\u6700\u5f8c\u306b\u5165\u308b\u5024\u3092\u5730\u9053\u306b\u8a08\u7b97\u3059\u308b\u3068\u3001\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8:grinning:\nStage2\u306f\u8b1b\u7fa9\u3067\u3084\u3063\u305f\u3084\u3064\uff081\u304b\u30895\u306e\u7dcf\u548c\u3092\u6c42\u3081\u308b\u51e6\u7406\uff09\u3068\u51e6\u7406\u5185\u5bb9\u304c\u304b\u306a\u308a\u4f3c\u3066\u305f\u306e\u3068\u3001imul\u547d\u4ee4\u304c\u3042\u308b\u3053\u3068\u304b\u3089\u3001\u7b54\u3048\u306f5\u306e\u968e\u4e57\u3060\u3068\u4e88\u60f3\u3057\u305f\u3089\u898b\u4e8b\u6b63\u89e3\u3002\n\n# UnusedFunction (200, Binary)\n## \u554f\u984c\u6587\n```\n\u4f7f\u308f\u308c\u3066\u3044\u306a\u3044\u95a2\u6570\u304c\u3042\u308b\u305e\n\n\u554f\u984c\u30d0\u30a4\u30ca\u30ea\uff1ahttp://172.20.1.1/ctf/binary/bin200_2\n```\n## \u89e3\u8aac\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3092Download\u3057\u3066\u3001\u3068\u308a\u3042\u3048\u305afile\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\n\n```\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ file bin200_2\nbin200_2: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=89e81238c140040714f5eeabeb2c9c2f8c380ddf, not stripped\n```\n\nLinux\u306e\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u5b9f\u884c\u3059\u308b\u3002\n\n```\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ ./bin200_2 \nHow can I generate flag ??\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$\n```\n\nflag\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u3092\u5c0b\u306d\u3089\u308c\u305f\u3002\u3002\u3002\n\u6b21\u306bobjdump\u3057\u3066\u307f\u308b\u3002\n\n```\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ objdump -M intel -d bin200_2 > dump.txt\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ ll\n\u5408\u8a08 36\ndrwxrwxr-x 2 ctf4b ctf4b  4096  1\u6708 30 22:29 ./\ndrwxrwxr-x 9 ctf4b ctf4b  4096  1\u6708 29 22:20 ../\n-rwxrw-r-- 1 ctf4b ctf4b  7413  1\u6708 29 14:22 bin200_2*\n-rw-rw-r-- 1 ctf4b ctf4b 14000  1\u6708 30 22:29 dump.txt\n```\n\n`dump.txt`\u306emain\u95a2\u6570\u4ed8\u8fd1\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\nmain\u95a2\u6570\u306e\u3059\u3050\u4e0b\u306b`genflag`\u3068\u3044\u3046\u660e\u3089\u304b\u306b\u602a\u3057\u3044\u95a2\u6570\u304c\u3042\u308b\u3002\n\n```:dump.txt\n0804849d <main>:\n 804849d:\t55                   \tpush   ebp\n 804849e:\t89 e5                \tmov    ebp,esp\n 80484a0:\t83 e4 f0             \tand    esp,0xfffffff0\n 80484a3:\t83 ec 10             \tsub    esp,0x10\n 80484a6:\tc7 04 24 30 86 04 08 \tmov    DWORD PTR [esp],0x8048630\n 80484ad:\te8 be fe ff ff       \tcall   8048370 <puts@plt>\n 80484b2:\tc9                   \tleave  \n 80484b3:\tc3                   \tret    \n\n080484b4 <genflag>:\n 80484b4:\t55                   \tpush   ebp\n 80484b5:\t89 e5                \tmov    ebp,esp\n 80484b7:\t53                   \tpush   ebx\n 80484b8:\t83 ec 44             \tsub    esp,0x44\n 80484bb:\t65 a1 14 00 00 00    \tmov    eax,gs:0x14\n 80484c1:\t89 45 f4             \tmov    DWORD PTR [ebp-0xc],eax\n 80484c4:\t31 c0                \txor    eax,eax\n 80484c6:\tc6 45 d5 63          \tmov    BYTE PTR [ebp-0x2b],0x63\n 80484ca:\tc6 45 d6 74          \tmov    BYTE PTR [ebp-0x2a],0x74\n 80484ce:\tc6 45 d7 66          \tmov    BYTE PTR [ebp-0x29],0x66\n 80484d2:\tc6 45 d8 34          \tmov    BYTE PTR [ebp-0x28],0x34\n 80484d6:\tc6 45 d9 62          \tmov    BYTE PTR [ebp-0x27],0x62\n 80484da:\tc6 45 da 7b          \tmov    BYTE PTR [ebp-0x26],0x7b\n 80484de:\tc6 45 db 34          \tmov    BYTE PTR [ebp-0x25],0x34\n 80484e2:\tc6 45 dc 6e          \tmov    BYTE PTR [ebp-0x24],0x6e\n 80484e6:\tc6 45 dd 34          \tmov    BYTE PTR [ebp-0x23],0x34\n 80484ea:\tc6 45 de 6c          \tmov    BYTE PTR [ebp-0x22],0x6c\n 80484ee:\tc6 45 df 79          \tmov    BYTE PTR [ebp-0x21],0x79\n 80484f2:\tc6 45 e0 7a          \tmov    BYTE PTR [ebp-0x20],0x7a\n 80484f6:\tc6 45 e1 33          \tmov    BYTE PTR [ebp-0x1f],0x33\n 80484fa:\tc6 45 e2 5f          \tmov    BYTE PTR [ebp-0x1e],0x5f\n 80484fe:\tc6 45 e3 75          \tmov    BYTE PTR [ebp-0x1d],0x75\n 8048502:\tc6 45 e4 6e          \tmov    BYTE PTR [ebp-0x1c],0x6e\n 8048506:\tc6 45 e5 75          \tmov    BYTE PTR [ebp-0x1b],0x75\n 804850a:\tc6 45 e6 35          \tmov    BYTE PTR [ebp-0x1a],0x35\n 804850e:\tc6 45 e7 33          \tmov    BYTE PTR [ebp-0x19],0x33\n 8048512:\tc6 45 e8 64          \tmov    BYTE PTR [ebp-0x18],0x64\n 8048516:\tc6 45 e9 5f          \tmov    BYTE PTR [ebp-0x17],0x5f\n 804851a:\tc6 45 ea 66          \tmov    BYTE PTR [ebp-0x16],0x66\n 804851e:\tc6 45 eb 75          \tmov    BYTE PTR [ebp-0x15],0x75\n 8048522:\tc6 45 ec 6e          \tmov    BYTE PTR [ebp-0x14],0x6e\n 8048526:\tc6 45 ed 63          \tmov    BYTE PTR [ebp-0x13],0x63\n 804852a:\tc6 45 ee 37          \tmov    BYTE PTR [ebp-0x12],0x37\n 804852e:\tc6 45 ef 31          \tmov    BYTE PTR [ebp-0x11],0x31\n 8048532:\tc6 45 f0 30          \tmov    BYTE PTR [ebp-0x10],0x30\n 8048536:\tc6 45 f1 6e          \tmov    BYTE PTR [ebp-0xf],0x6e\n 804853a:\tc6 45 f2 7d          \tmov    BYTE PTR [ebp-0xe],0x7d\n 804853e:\tc6 45 f3 00          \tmov    BYTE PTR [ebp-0xd],0x0\n 8048542:\tc7 04 24 07 00 00 00 \tmov    DWORD PTR [esp],0x7\n 8048549:\te8 12 fe ff ff       \tcall   8048360 <malloc@plt>\n 804854e:\t89 45 d0             \tmov    DWORD PTR [ebp-0x30],eax\n 8048551:\tc7 45 cc 00 00 00 00 \tmov    DWORD PTR [ebp-0x34],0x0\n 8048558:\teb 19                \tjmp    8048573 <genflag+0xbf>\n 804855a:\t8b 55 cc             \tmov    edx,DWORD PTR [ebp-0x34]\n 804855d:\t8b 45 d0             \tmov    eax,DWORD PTR [ebp-0x30]\n 8048560:\t01 c2                \tadd    edx,eax\n 8048562:\t8d 4d d5             \tlea    ecx,[ebp-0x2b]\n 8048565:\t8b 45 cc             \tmov    eax,DWORD PTR [ebp-0x34]\n 8048568:\t01 c8                \tadd    eax,ecx\n 804856a:\t0f b6 00             \tmovzx  eax,BYTE PTR [eax]\n 804856d:\t88 02                \tmov    BYTE PTR [edx],al\n 804856f:\t83 45 cc 01          \tadd    DWORD PTR [ebp-0x34],0x1\n 8048573:\t8b 45 cc             \tmov    eax,DWORD PTR [ebp-0x34]\n 8048576:\t83 f8 06             \tcmp    eax,0x6\n 8048579:\t76 df                \tjbe    804855a <genflag+0xa6>\n 804857b:\t8b 45 d0             \tmov    eax,DWORD PTR [ebp-0x30]\n 804857e:\t8b 5d f4             \tmov    ebx,DWORD PTR [ebp-0xc]\n 8048581:\t65 33 1d 14 00 00 00 \txor    ebx,DWORD PTR gs:0x14\n 8048588:\t74 05                \tje     804858f <genflag+0xdb>\n 804858a:\te8 c1 fd ff ff       \tcall   8048350 <__stack_chk_fail@plt>\n 804858f:\t83 c4 44             \tadd    esp,0x44\n 8048592:\t5b                   \tpop    ebx\n 8048593:\t5d                   \tpop    ebp\n 8048594:\tc3                   \tret    \n 8048595:\t66 90                \txchg   ax,ax\n 8048597:\t66 90                \txchg   ax,ax\n 8048599:\t66 90                \txchg   ax,ax\n 804859b:\t66 90                \txchg   ax,ax\n 804859d:\t66 90                \txchg   ax,ax\n 804859f:\t90                   \tnop\n```\n\n`mov    BYTE PTR \uff5e`\u3068\u3044\u3046\u547d\u4ee4\u304c\u305a\u3089\u3063\u3068\u7d9a\u304f\u90e8\u5206\u304c\u30d5\u30e9\u30b0\u3063\u307d\u3044\u5302\u3044\u304c\u3059\u308b\u306e\u3067\u3001\n\u7b2c2\u30aa\u30da\u30e9\u30f3\u30c9\u306e16\u9032\u6570\u5024\u3092\u629c\u304d\u51fa\u3057\u3066\u3001Ruby\u3067ASCII\u6587\u5b57\u306b\u5909\u63db\u3059\u308b\u3068\u30d5\u30e9\u30b0\u30b2\u30c3\u30c8:grinning:\n\n```\nctf4b@ctf4b-vm:~/Downloads/ctf/UnusedFunction$ irb\nirb(main):001:0> [\"63\", \"74\", \"66\", \"34\", \"62\", \"7b\", \"34\", \"6e\", \"34\", \"6c\", \"79\", \"7a\", \"33\", \"5f\", \"75\", \"6e\", \"75\", \"35\", \"33\", \"64\", \"5f\", \"66\", \"75\", \"6e\", \"63\", \"37\", \"31\", \"30\", \"6e\", \"7d\", \"0\"].each{|c| print c.hex.chr}; puts\nctf4b{4n4lyz3_unu53d_func710n}\n=> nil\n```\n\n# \u611f\u60f3\n\u7d04400\u540d\u4e2d\u300112\u4f4d\u3060\u3063\u305f\u306e\u3067\u5b09\u3057\u3055\u3082\u3042\u3063\u305f\u3051\u3069\u3001\u7c21\u5358\u306a\u554f\u984c\uff08Forensics\u306e100\u70b9\u554f\u984c\uff09\u3092\u89e3\u3051\u306a\u304b\u3063\u305f\u308a\u3001\u60dc\u3057\u3044\u3068\u3053\u308d\u307e\u3067\u3044\u3063\u305f\u554f\u984c\u304c\u3044\u304f\u3064\u304b\u3042\u3063\u305f\u308a\u3057\u305f\u306e\u304c\u6094\u3057\u3044\u3002\n\n\u6f14\u7fd2\u524d\u306b\u884c\u308f\u308c\u305f\u8b1b\u7fa9\u306f\u5c11\u3057\u30da\u30fc\u30b9\u304c\u901f\u304f\u3066\u3001\u3064\u3044\u3066\u3044\u304f\u306e\u3067\u7cbe\u4e00\u676f\u3060\u3063\u305f\u3051\u3069\u3001\u5f79\u7acb\u3064\u30c4\u30fc\u30eb\uff08binwalk, fls\u306a\u3069\uff09\u3084\u554f\u984c\u3078\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\u65b9\u6cd5\u3092\u5b66\u3079\u305f\u306e\u3067\u975e\u5e38\u306b\u6709\u610f\u7fa9\u3060\u3063\u305f\u3002\n"}