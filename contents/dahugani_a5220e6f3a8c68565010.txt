{"context": " More than 1 year has passed since last update.\n\ntd-agent\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306bURL\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\u305d\u306e\u5f8c\u3067yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3046\u3002\nsudo vi /etc/yum.repos.d/td.repo\n\n\ntd.repo\n[treasuredata]\nname=TreasureData\nbaseurl=http://packages.treasure-data.com/redhat/$basearch\ngpgcheck=0```\n\n\nsudo yum install -y td-agent\n```\n\ntd-agent\u306e\u8d77\u52d5\ntd-agent\u3092\u8d77\u52d5\u3059\u308b\u3002\n/etc/init.d/td-agent start\n\n\nAPI\u306e\u30ad\u30fc\u3092\u78ba\u8a8d\ntd-agent\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u8a8d\u8a3c\u3092\u3059\u308b\u3002\n\u305d\u306e\u5f8c\u3067API\u30ad\u30fc\u3092\u78ba\u8a8d\u3059\u308b\u3002\ntd account -f\ntd apikey:show\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5909\u66f4\ntd-agent\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u63db\u3048\u308b\u3002\nvi /etc/td-agent/td-agent.conf\n\n\ntd-agent.conf\n<match td.*.*>\n  type tdlog\n  apikey \u3055\u304d\u307b\u3069\u78ba\u8a8d\u3057\u305fAPI\u306e\u30ad\u30fc\n  auto_create_table\n  buffer_type file\n  buffer_path /var/log/td-agent/buffer/td\n  use_ssl true\n</match>\n<source>\n  type tail\n  path /var/log/httpd/httpd.access_log\n  pos_file /tmp/httpd.access.log.pos\n  format apache\n  tag td.test.httpd\n</source>\n\n\n\n\u8a2d\u5b9a\u3092\u66f8\u304d\u63db\u3048\u305f\u306e\u3067td-agent\u3092\u518d\u8d77\u52d5\u3059\u308b\u3002\n/etc/init.d/td-agent restart\n\n\n\u30ed\u30b0\u306e\u9001\u4fe1\u3092\u78ba\u8a8d\ntd-agent\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u308c\u3070\u6b63\u5e38\u306b\u9001\u4fe1\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u3002\ntd query -w -d test \"SELECT * FROM httpd GROUP BY v['code']\"\n\n\n\u304a\u307e\u3051 - apache\u30ed\u30b0\u3092\u7121\u7406\u3084\u308a\u51fa\u529b\u3059\u308b\u65b9\u6cd5\napache\u30ed\u30b0\u306b\u30ed\u30b0\u3092\u76f4\u63a5\u66f8\u304d\u8fbc\u3080\u3002\nvi /var/log/httpd/httpd_access_log\n\n127.0.0.1 - - [17/Oct/2013:13:46:18 +0900] \"GET /zabbix/images/general/zabbix.ico HTTP/1.1\" 200 1150 \"-\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0\"\n\n\n##td-agent\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nyum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306bURL\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\u305d\u306e\u5f8c\u3067yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3046\u3002\n\n\n```\nsudo vi /etc/yum.repos.d/td.repo\n```\n\n```td.repo\n[treasuredata]\nname=TreasureData\nbaseurl=http://packages.treasure-data.com/redhat/$basearch\ngpgcheck=0```\n```\nsudo yum install -y td-agent\n```\n\n##td-agent\u306e\u8d77\u52d5\ntd-agent\u3092\u8d77\u52d5\u3059\u308b\u3002\n\n```\n/etc/init.d/td-agent start\n```\n\n##API\u306e\u30ad\u30fc\u3092\u78ba\u8a8d\ntd-agent\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u8a8d\u8a3c\u3092\u3059\u308b\u3002\n\u305d\u306e\u5f8c\u3067API\u30ad\u30fc\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n```\ntd account -f\ntd apikey:show\n```\n\n##\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5909\u66f4\ntd-agent\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u63db\u3048\u308b\u3002\n\n```\nvi /etc/td-agent/td-agent.conf\n```\n\n```td-agent.conf\n<match td.*.*>\n  type tdlog\n  apikey \u3055\u304d\u307b\u3069\u78ba\u8a8d\u3057\u305fAPI\u306e\u30ad\u30fc\n  auto_create_table\n  buffer_type file\n  buffer_path /var/log/td-agent/buffer/td\n  use_ssl true\n</match>\n<source>\n  type tail\n  path /var/log/httpd/httpd.access_log\n  pos_file /tmp/httpd.access.log.pos\n  format apache\n  tag td.test.httpd\n</source>\n\n```\n\n\u8a2d\u5b9a\u3092\u66f8\u304d\u63db\u3048\u305f\u306e\u3067td-agent\u3092\u518d\u8d77\u52d5\u3059\u308b\u3002\n\n```\n/etc/init.d/td-agent restart\n```\n\n##\u30ed\u30b0\u306e\u9001\u4fe1\u3092\u78ba\u8a8d\ntd-agent\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u308c\u3070\u6b63\u5e38\u306b\u9001\u4fe1\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u3002\n\n```\ntd query -w -d test \"SELECT * FROM httpd GROUP BY v['code']\"\n```\n\n\n##\u304a\u307e\u3051 - apache\u30ed\u30b0\u3092\u7121\u7406\u3084\u308a\u51fa\u529b\u3059\u308b\u65b9\u6cd5\n\napache\u30ed\u30b0\u306b\u30ed\u30b0\u3092\u76f4\u63a5\u66f8\u304d\u8fbc\u3080\u3002\n\n```\nvi /var/log/httpd/httpd_access_log\n```\n\n```httpd_access_log\n127.0.0.1 - - [17/Oct/2013:13:46:18 +0900] \"GET /zabbix/images/general/zabbix.ico HTTP/1.1\" 200 1150 \"-\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0\"\n```\n\n\n\n\n\n\n\n", "tags": ["fluentd", "td-agent", "TreasureData", "CentOS"]}