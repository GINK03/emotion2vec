{"context": "AWS IoT\u3092\u4f7f\u3063\u305f\u3053\u3068\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u4f7f\u3063\u3066\u307f\u305f\u3068\u304d\u306e\u30e1\u30e2\u3002\nAWS IoT DeviceSDK(Node.js)\u3092\u4f7f\u3063\u3066\u3001MQTT\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(Mac)\u304b\u3089AWS IoT\u7d4c\u7531\u3067Thing(\u30e9\u30ba\u30d1\u30a4)\u306b\u63a5\u7d9a\u3055\u308c\u305fLED\u3092\u30c1\u30ab\u30c1\u30ab\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\n\u53c2\u8003\n\nMosquitto(MQTT)\u3092\u52d5\u304b\u3057\u3066\u307f\u305f\nMQTT\u306b\u3064\u3044\u3066\u306e\u307e\u3068\u3081\nAWS IoT\u3092\u901a\u3057\u3066Raspberry Pi 2\u306eL\u30c1\u30ab\u3092\u5b9f\u88c5\n\n\n\u74b0\u5883\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(Mac OSX 10.11.4)\n\u30e9\u30ba\u30d1\u30a43\nAWS IoT DeviceSDK for Node.js\n\n\u30e9\u30ba\u30d1\u30a4\u306eLED\u3067\u306e\u30c1\u30ab\u30c1\u30ab\u306f\u4ee5\u524d\u66f8\u3044\u305f\u3082\u306e\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nNode.js\u3067\u30e9\u30ba\u30d1\u30a4\u306b\u63a5\u7d9a\u3057\u305fLED\u3092\u70b9\u706f\u3001\u6d88\u706f\u3055\u305b\u308b(L\u30c1\u30ab)\n\n\u4eca\u56de\u306fAWS IoT\u306e\u3069\u306e\u90e8\u5206\u3092\u4f7f\u3046\u306e\u304b\nAWS IoT\u306f\u69d8\u3005\u306a\u69cb\u6210\u8981\u7d20\u304c\u3042\u308a\u307e\u3059\u3002\nAWS IoT \u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u4ed5\u7d44\u307f\n\u4eca\u56de\u306f\u4ee5\u4e0b\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\nAWS IoT\u30c7\u30d0\u30a4\u30b9SDK->AWS IoT\u3067\u7528\u610f\u3059\u308b\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3068\u306e\u6697\u53f7\u5316\u901a\u4fe1\u3092\u884c\u3046\u969b\u306b\u5229\u7528\u3002MQTT,HTTP,WebSocket\u30d7\u30ed\u30c8\u30b3\u30eb\u304c\u4f7f\u3048\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u4eca\u56de\u306fMQTT\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u4f7f\u3044\u307e\u3059\u3002SDK\u306fC,JavaScript\u53ca\u3073Arduino\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u304a\u308a\u3001JavScript(Node.js)\u3092\u5229\u7528\n\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4->IoT\u3084\u30c7\u30d0\u30a4\u30b9\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3068\u3057\u3066\u5229\u7528\u3002MQTT\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067MQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u3068\u3057\u3066\u5229\u7528\u300210\u5104\u4ee5\u4e0a\u306e\u30c7\u30d0\u30a4\u30b9\u306b\u3082\u5bfe\u5fdc\u3067\u304d\u308b\u3088\u3046\u306b\u81ea\u52d5\u7684\u306b\u30b9\u30b1\u30fc\u30eb\u3059\u308b\u3089\u3057\u3044\u3002\u3059\u3054\u3044\n\u8a8d\u8a3c\u3068\u8a8d\u53ef->IoT\u3068\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u9593\u306e\u901a\u4fe1\u306f\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u7d4c\u7531\u3068\u306a\u308a\u307e\u3059\u3002\u4e0a\u8a18\u3088\u308a\u3001\u591a\u304f\u306e\u5834\u5408\u3067\u901a\u4fe1\u306e\u6697\u53f7\u5316\u304c\u5fc5\u8981\u3002\u307e\u305f\u3001\u76f8\u4e92\u8a8d\u8a3c\uff08\u507d\u8005\u306e\u30c7\u30d0\u30a4\u30b9\u304b\u3089\u306e\u30c7\u30fc\u30bf\u3067\u306f\u306a\u3044\uff09\u306e\u6a5f\u80fd\u3082\u5fc5\u8981\u3067\u3059\u3002\u305d\u3053\u3067AWS IoT\u3067\u306f\u6697\u53f7\u5316\u306bTLS\u3092\u5229\u7528\u3057\u3001\u8a8d\u8a3c\u3067\u306fAWS\u306e\u8a8d\u8a3c\u30e1\u30bd\u30c3\u30c9(SigV4)\u3092\u4f7f\u3046\u3053\u3068\u3067\u5b9f\u65bd\u3059\u308b\u3082\u306e\u3067\u3059\u3002\u4eca\u56de\u306e\u4f8b\u3067\u3082IoT\u3068\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u9593\u306e\u8a8d\u8a3c\u3068\u8a8d\u53ef\u3092\u3057\u3066\u3044\u307e\u3059\u304c\u3001AWS\u30c7\u30d0\u30a4\u30b9SDK\u3067\u30e9\u30c3\u30d7\u3057\u3066\u3044\u308b\u306e\u3067\u30b3\u30fc\u30c9\u81ea\u4f53\u304c\u8907\u96d1\u306b\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u307e\u305f\u3001\u8a3c\u660e\u66f8\u3084\u516c\u958b\u9375\u30fb\u79d8\u5bc6\u9375\u306e\u751f\u6210\u3084\u7ba1\u7406\u3092AWS IoT\u3067\u5b9f\u65bd\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u4ed6\u306b\u3082\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306b\u9001\u4fe1\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306e\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3084\u4ed6\u306eAWS\u30ea\u30bd\u30fc\u30b9\u3068\u306e\u9023\u643a\u3092\u884c\u3046\u300c\u30eb\u30fc\u30eb\u30a8\u30f3\u30b8\u30f3\u300d\u6a5f\u80fd\u3084\u3001\u30c7\u30d0\u30a4\u30b9\u304c\u30aa\u30d5\u30e9\u30a4\u30f3\u306e\u72b6\u614b\u304b\u3089\u30aa\u30f3\u30e9\u30a4\u30f3\u72b6\u614b\u306b\u5fa9\u5e30\u3057\u305f\u969b\u306b\u30c7\u30fc\u30bf\u306e\u540c\u671f\u3092\u884c\u3046\u4e8b\u304c\u51fa\u6765\u308b\u300c\u30c7\u30d0\u30a4\u30b9\u30b7\u30e3\u30c9\u30a6\u300d\u3068\u3044\u3046\u6a5f\u80fd\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u5229\u7528\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\nAWS IoT\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n\u307e\u305a\u521d\u3081\u306bAWS IoT\u306e\u8a2d\u5b9a\u3092\u30de\u30cd\u30fc\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u884c\u3044\u307e\u3059\u3002\n\u3053\u3061\u3089\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nGetting Started with AWS IoT on Raspberry Pi and the AWS IoT Device SDK for Node.js\n\nthing(\u30c7\u30d0\u30a4\u30b9)\u306e\u767b\u9332\n\u6700\u521d\u306bthing(\u30c7\u30d0\u30a4\u30b9)\u306e\u767b\u9332\u3092\u884c\u3044\u307e\u3059\u3002\nthing\u3068\u306f\u5177\u4f53\u7684\u306b\u306f\u30e9\u30ba\u30d9\u30ea\u30fc\u30d1\u30a4\u3067\u3042\u3063\u305f\u308a\u3001AWS IoT\u3068\u63a5\u7d9a\u3059\u308b \u4f55\u3089\u304b\u306e\u30c7\u30d0\u30a4\u30b9 \u3068\u3044\u3046\u610f\u5473\u3060\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\u3068\u308a\u3042\u3048\u305a\u30de\u30cd\u30fc\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u753b\u9762\u3092\u958b\u304d\u307e\u3059\u3002\n\n\u300cGet started\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\u6b21\u306e\u753b\u9762\u3067thins\u3092\u4efb\u610f\u306e\u540d\u79f0\u3067\u767b\u9332\u3057\u307e\u3059\u3002\n\n\u540d\u79f0\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3068\u308a\u3042\u3048\u305a\u300cMyNewThing\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u767b\u9332\u3057\u307e\u3057\u3087\u3046\u3002\n\u5165\u529b\u5f8c\u3001\u300cCreate\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\u3053\u308c\u3067thing\u304c\u767b\u9332\u3055\u308c\u307e\u3057\u305f\u3002\n\u6b21\u306e\u753b\u9762\u3067\u300cView Thing\u300d\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u3067thing\u3054\u3068\u306eREST API\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306a\u3069\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\n\n\u30ad\u30fc\u30da\u30a2(\u516c\u958b\u9375\u3001\u79d8\u5bc6\u9375)\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u53ca\u3073\u8a3c\u660e\u66f8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nAWS IoT\u3067\u306f\u901a\u4fe1\u3092\u884c\u3046\u969b\u306bTLS\u306b\u3088\u308b\u6697\u53f7\u5316\u3092\u884c\u3063\u3066\u901a\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\nTLS\u901a\u4fe1\u306e\u969b\u306b\u5fc5\u8981\u306a\u8a3c\u660e\u66f8\u3084\u30ad\u30fc\u30da\u30a2\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u884c\u3044\u307e\u3059\u3002\n\u5148\u307b\u3069\u767b\u9332\u3057\u305fMyNewThing\u306e\u8a73\u7d30\u3092\u8868\u793a\u3057\u3066\u3044\u308b\u753b\u9762\u306e\u53f3\u4e0b\u306e\u300cConnect device\u300d\u3068\u3044\u3046\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u307e\u3059\u3002\n\n\u6b21\u306e\u753b\u9762\u3067\u306fthing\u3068AWS IoT\u3068\u306e\u901a\u4fe1\u306f\u4f55\u3092\u4f7f\u3063\u3066\u884c\u3046\u304b\u306e\u78ba\u8a8d\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u4eca\u56de\u306fNode.js\u306eDeviceSDK\u3092\u4f7f\u3046\u306e\u3067\u300cNode.js\u300d\u3092\u30c1\u30a7\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\u9078\u629e\u5f8c\u3001\u4e0a\u8a18\u753b\u9762\u306e\u3088\u3046\u306b\u300cGenerate certificate and policy\u300d\u3068\u3044\u3046\u30dc\u30bf\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u9078\u629e\u3057\u3066\u8a3c\u660e\u66f8\u3068\u30dd\u30ea\u30b7\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u9078\u629e\u5f8c\u3001\u5c11\u3057\u5f85\u3064\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\n\u516c\u958b\u9375\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u79d8\u5bc6\u9375\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u8a3c\u660e\u66f8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n\u304c\u3067\u304d\u307e\u3059\u3002\n\u8a3c\u660e\u66f8\u306f\u3044\u3064\u3067\u3082\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u516c\u958b\u9375\u3001\u79d8\u5bc6\u9375\u306f\u3053\u306e\u30da\u30fc\u30b8\u306e\u307f\u3057\u304b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u5fd8\u308c\u305a\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u5404\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001Mac\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u81ea\u5206\u306e\u5834\u5408\u3001\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u540d\u3068\u306a\u3063\u3066\u304a\u308a\u307e\u3057\u305f\u3002\n\nxxxxx-certificate.pem.crt->\u8a3c\u660e\u66f8\nxxxxx-private.pem.key->\u79d8\u5bc6\u9375\nxxxxx-public.pem.key->\u516c\u958b\u9375\n\nopenssl\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u30c7\u30b3\u30fc\u30c9\u3067\u3057\u3066\u8a73\u7d30\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n# X.509\u8a3c\u660e\u66f8\u3092\u30c7\u30b3\u30fc\u30c9\n$openssl x509 -text < xxxx-certificate.pem.crt\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number:\n            xxxxxx\n    Signature Algorithm: sha256WithRSAEncryption\n        Issuer: OU=Amazon Web Services O=Amazon.com Inc. L=Seattle ST=Washington C=US\n        Validity\n            Not Before: Apr  2 22:53:28 2016 GMT\n            Not After : Dec 31 23:59:59 2049 GMT\n        Subject: CN=AWS IoT Certificate\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                Public-Key: (2048 bit)\n(\u4ee5\u4e0b\u7565)\n\n\u4e0a\u8a18\u3088\u308a\u4ee5\u4e0b\u3068\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u306d\u3002\n\n\u516c\u958b\u9375\u6697\u53f7\u65b9\u5f0f\u306b2048bit\u306eRSA\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306bSHA-256\n\n\n\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\nSSL/TLS\u901a\u4fe1\u3067\u306f\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u53d6\u5f97\u3057\u305f\u30c7\u30b8\u30bf\u30eb\u8a3c\u660e\u66f8\u304c\u6b63\u5f53\u306a\u3082\u306e\u3067\u3042\u308b\u304b\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30c7\u30b8\u30bf\u30eb\u8a3c\u660e\u66f8\u304c\u6b63\u3057\u3044\u304b\u306b\u3064\u3044\u3066\u306f\u300c\u6b63\u5f53\u306a\u8a8d\u8a3c\u5c40\u304b\u3089\u767a\u884c\u3055\u308c\u305f\u3082\u306e\u3067\u3042\u308c\u3070\u6b63\u3057\u3044\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u8a3c\u660e\u3055\u308c\u307e\u3059\u3002\n\u5177\u4f53\u7684\u306bamazon.co.jp\u3092\u4f8b\u306b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u8a3c\u660e\u66f8\u60c5\u5831\u3092\u78ba\u8a8d\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u968e\u5c64\u69cb\u9020\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n\nwww.amazon.co.jp\u306e\u8a3c\u660e\u66f8\u306f\u8a8d\u8a3c\u5c40\u306e\u30b7\u30de\u30f3\u30c6\u30c3\u30af\u304b\u3089\u767a\u884c\u3055\u308c\u305f\n\u30b7\u30de\u30f3\u30c6\u30c3\u30af\u306e\u8a3c\u660e\u66f8\u306f\u8a8d\u8a3c\u5c40\u306e\u30d9\u30ea\u30b5\u30a4\u30f3\u304b\u3089\u767a\u884c\u3055\u308c\u305f\n\n\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3058\u3083\u3042\u6700\u5f8c\u306b\u30d9\u30ea\u30b5\u30a4\u30f3\u306e\u8a3c\u660e\u66f8\u306f\u4f55\u3092\u6301\u3063\u3066\u6b63\u5f53\u3067\u3042\u308b\u3068\u5224\u65ad\u3059\u308b\u304b\u3068\u3044\u3046\u3068\u3053\u3053\u3067\u767b\u5834\u3059\u308b\u306e\u304c\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u306b\u306a\u308a\u307e\u3059\u3002\n\u3064\u307e\u308a\n\n\u30d9\u30ea\u30b5\u30a4\u30f3\u306e\u8a3c\u660e\u66f8\u306f\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u304b\u3089\u767a\u884c\u3055\u308c\u305f(\u306a\u306e\u3067\u6700\u7d42\u7684\u306bwww.amazon.co.jp\u306f\u6b63\u5f53\u306a\u3082\u306e)\n\n\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u5e7e\u3064\u304b\u306e\u8a8d\u8a3c\u5c40\u306f\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3068\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u306a\u3069\u306b\u6700\u521d\u304b\u3089\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u6211\u3005\u304c\u901a\u5e38\u898b\u308b\u3088\u3046\u306a\u30b5\u30a4\u30c8\u3092\u95b2\u89a7\u3059\u308b\u969b\u306b\u308f\u3056\u308f\u3056\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u305f\u3060\u3057\u3001\u4eca\u56de\u306f\u901a\u4fe1\u3092\u3059\u308b\u306e\u304c\u30d6\u30e9\u30a6\u30b6\u3067\u306f\u306a\u3044\u305f\u3081\u3001\u5bfe\u8c61\u306e\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3060\u3051\u4e88\u3081\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u8a71\u304c\u9038\u308c\u307e\u3057\u305f\u304c\u3001\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n# root-CA.crt\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3092\u53d6\u5f97\n$wget -O root-CA.crt https://www.symantec.com/content/en/us/enterprise/verisign/roots/VeriSign-Class%203-Public-Primary-Certification-Authority-G5.pem\n\n\nMac\u5074\u3067Pubulish\u306e\u5b9f\u88c5\u3092\u3059\u308b\n\u6700\u521d\u306bMac\u5074\u3067AWS IoT\u3067\u7528\u610f\u3057\u305fMQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u3078LED\u306eON/OFF\u306e\u8a2d\u5b9a\u3092\u5b9a\u671f\u7684\u306b\u9001\u4fe1\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\u4f5c\u6210\u306b\u306fAWS DeviceSDK\u306eNode.js\u3092\u5229\u7528\u3057\u307e\u3059\u3002\naws/aws-iot-device-sdk-js\n\u307e\u305a\u306f\u4e0a\u8a18\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$npm install aws-iot-device-sdk\n\n\u4e0a\u8a18\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u914d\u7f6e\u3057\u307e\u3059\u3002\n\npublish.js\n// AWS IoT DeviceSDK\u306e\u5229\u7528\nvar awsIot = require('aws-iot-device-sdk');\n\n// \u79d8\u5bc6\u9375\u3001\u8a3c\u660e\u66f8\u306a\u3069\u306e\u8a2d\u5b9a\nvar device = awsIot.device({\n  region: 'ap-northeast-1',\n  clientId: 'MyNewThing-client',\n  privateKey: 'certs/private.pem.key',\n  clientCert: 'certs/certificate.pem.crt',\n  caCert: 'certs/root-CA.crt',\n});\n\nvar count = 0;\n\n// \u901a\u4fe1\u78ba\u7acb\u3057\u305f\u969b\u306b\u547c\u3073\u51fa\u3055\u308c\u308b\u30a4\u30d9\u30f3\u30c8\ndevice.on('connect', function() {\n  console.log('connect');\n  setInterval( function() {\n    count++;\n    var led = count % 2;\n    console.log(led.toString());\n    device.publish('topic_1', led.toString());\n  }, 1000);\n});\n\n\n\nsetInterval\u95a2\u6570\u3092\u4f7f\u3063\u3066\u5468\u671f\u7684\u306btopic_1\u3068\u3044\u3046\u30c8\u30d4\u30c3\u30af\u306b\u5bfe\u3057\u30660\u3082\u3057\u304f\u306f1\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001awsIot.device\u30af\u30e9\u30b9\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u8a2d\u5b9a\u3059\u308b\u30ea\u30fc\u30b8\u30e7\u30f3\u3084\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u306e\u30d1\u30b9\u306f\u9069\u5b9c\u5909\u66f4\u304f\u3060\u3055\u3044\u3002\n\n\u30e9\u30ba\u30d1\u30a4\u5074\u3067subscribe\u306e\u5b9f\u88c5\u3092\u3059\u308b\n\u30e9\u30ba\u30d1\u30a4\u5074\u3067\u306eNode.js\u74b0\u5883\u306e\u69cb\u7bc9\u3084\u3069\u3046\u3084\u3063\u3066\u30e9\u30ba\u30d1\u30a4\u304b\u3089LED\u306eON/OFF\u3092\u3059\u308b\u304b\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\nNode.js\u3067\u30e9\u30ba\u30d1\u30a4\u306b\u63a5\u7d9a\u3057\u305fLED\u3092\u70b9\u706f\u3001\u6d88\u706f\u3055\u305b\u308b(L\u30c1\u30ab)\n\u30e9\u30ba\u30d1\u30a4\u5074\u3067\u3082\u540c\u3058\u3088\u3046\u306bAWS IoT DeviceSDK\u3092\u4f7f\u3063\u3066publish\u3055\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067LED\u3092ON/OFF\u306b\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\u306a\u304a\u3001\u79d8\u5bc6\u9375\u3001\u8a3c\u660e\u66f8\u3001\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u306fMac\u304b\u3089scp\u306a\u3069\u3067\u30b3\u30d4\u30fc\u3059\u308b\u304b\u5225\u9014\u4ed6\u306e\u3082\u306e\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u540c\u3058\u3088\u3046\u306bnpm\u3067\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$npm install aws-iot-device-sdk\n$npm install sleep\n\n\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\nsubscribe.js\nvar awsIot = require('aws-iot-device-sdk');\nvar fs = require('fs');\nvar sleep = require('sleep');\nvar pin = 4;\n\nvar device = awsIot.device({\n  region: 'ap-northeast-1',\n  clientId: 'MyNewThing',\n  privateKey: 'certs/private.pem.key',\n  clientCert: 'certs/certificate.pem.crt',\n  caCert: 'certs/root-CA.crt',\n});\n\n// \u901a\u4fe1\u78ba\u7acb\u6642\ndevice.on('connect', function() {\n  console.log('connect');\n  device.subscribe('topic_1');\n  fs.writeFileSync('/sys/class/gpio/export', pin);\n\n  // \u3059\u3050\u306b\u66f8\u304d\u8fbc\u3082\u3046\u3068\u3059\u308b\u3068\u6a29\u9650\u30a8\u30e9\u30fc\u306e\u305f\u3081sleep\u3055\u305b\u308b\n  sleep.sleep(1);\n  fs.writeFileSync('/sys/class/gpio/gpio' + pin + '/direction', 'out');\n});\n\n// subscribe\u3057\u305f\u30c8\u30d4\u30c3\u30af\u306bpublish\u3055\u308c\u305f\u6642\u306e\u30a4\u30d9\u30f3\u30c8\ndevice.on('message', function(topic, payload) {\n  console.log('message', topic, payload.toString());\n\n  // 1\u306e\u6642\u306fLED\u3092ON.0\u306e\u6642\u306fLED\u3092OFF\n  fs.writeFileSync('/sys/class/gpio/gpio' + pin + '/value', payload.toString());\n});\n\nprocess.stdin.resume();\n\n// Ctrl+C\u306b\u3088\u3063\u3066\u7d42\u4e86\u3059\u308b\u5834\u5408\u306e\u51e6\u7406\nprocess.on('SIGINT', function() {\n  console.log('receive SIGINT signal');\n  fs.writeFileSync('/sys/class/gpio/unexport', pin);\n  process.exit();\n});\n\n\n\u306a\u304a\u3001clientId\u306b\u3064\u3044\u3066\u306fMac\u5074\u3068\u9055\u3046\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002(clientId\u306f\u91cd\u8907\u4e0d\u53ef\u306e\u305f\u3081\u3001\u3069\u3061\u3089\u304b\u3067\u63a5\u7d9a\u304c\u78ba\u7acb\u3055\u308c\u308b\u3068\u3082\u3046\u4e00\u65b9\u306e\u63a5\u7d9a\u304c\u5207\u308c\u308b\u305f\u3081)\n\nLED\u306e\u30c1\u30ab\u30c1\u30ab(L\u30c1\u30ab)\u3092\u3084\u3063\u3066\u307f\u308b\n\u3067\u306f\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u5148\u306b\u30e9\u30ba\u30d1\u30a4\u5074\u306e\u5b9f\u884c\u3092\u3057\u3066\u3001topic_1\u3068\u3044\u3046\u30c8\u30d4\u30c3\u30af\u306esubscribe\u3092\u3057\u307e\u3059\u3002\n$node subscribe.js\nconnect\n\n\u6b21\u306bMac\u5074\u306e\u30b3\u30fc\u30c9\u3092\u52d5\u304b\u3057\u3001\u5bfe\u8c61\u30c8\u30d4\u30c3\u30af\u306b\u5bfe\u3057\u30660\u30681\u306e\u60c5\u5831\u3092\u5b9a\u671f\u7684\u306b\u9001\u4fe1\u3059\u308b(publish)\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$node publish.js\nnode publish.js\nconnect\n1\n0\n1\n\u30fb\u30fb\u30fb\n\n\u3046\u307e\u304f\u3044\u3051\u3070\u4e0a\u8a18\u306e\u3088\u3046\u306b1,0,1,0...\u3068\u6a19\u6e96\u51fa\u529b\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u307e\u305f\u3001\u30e9\u30ba\u30d1\u30a4\u5074\u3082\u78ba\u8a8d\u3059\u308b\u3068\u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\u6642\u306b\u6a19\u6e96\u51fa\u529b\u3092\u3057\u3066\u3044\u307e\u3059\u3002\nmessage topic_1 1\nmessage topic_1 0\nmessage topic_1 1\nmessage topic_1 0\n\u30fb\u30fb\u30fb\n\n\u307e\u305f\u30010\u306e\u53d7\u4fe1\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u306f\u6d88\u706f\u30011\u306e\u53d7\u4fe1\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u306fLED\u304c\u70b9\u706f\u3059\u308b\u3053\u3068\u3082\u78ba\u8a8d\u3067\u304d\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3069\u3061\u3089\u3082\u7d42\u4e86\u306fCtrl+C\u306b\u3088\u3063\u3066\u7d42\u4e86\u3057\u307e\u3059\u3002\n\nAWS IoT\u306e\u524a\u9664\n\u6700\u5f8c\u306b\u4f5c\u6210\u3057\u305fAWS\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u3068\u305d\u306e\u524d\u306b\u5c11\u3057\u73fe\u5728\u306e\u72b6\u614b\u3092\u6574\u7406\u3057\u307e\u3059\u3002\n\u73fe\u5728\u306f\u4ee5\u4e0b\u306e3\u3064\u306e\u30ea\u30bd\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\n\nThing(\u30c7\u30d0\u30a4\u30b9)\nPolicy(\u30dd\u30ea\u30b7\u30fc\uff09\nCerticficate(\u8a3c\u660e\u66f8\uff09\n\n\u305d\u3057\u3066\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u95a2\u9023\u304c\u3042\u308a\u307e\u3059\u3002\n\nThing\u306bCertificate\u304c\u7d10\u3065\u3044\u3066\u3044\u308b\nPolicy\u306bCertificate\u304c\u7d10\u3065\u3044\u3066\u3044\u308b\n\n\u306a\u306e\u3067\u305d\u308c\u305e\u308c\u3092\u3044\u304d\u306a\u308a\u524a\u9664\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u30a8\u30e9\u30fc\u3068\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u7d10\u3065\u3044\u305f\u5185\u5bb9\u3092\u89e3\u6d88\u3057\u3064\u3064\u3001\u524a\u9664\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30de\u30cd\u30fc\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u306e\u3084\u308a\u65b9\u304c\u4e0d\u660e\u3060\u3063\u305f\u306e\u3067AWS CLI\u3092\u4f7f\u3063\u3066\u3084\u3063\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u306f\u305d\u308c\u305e\u308c\u306e\u60c5\u5831(ID\u3084ARN\u306a\u3069\uff09\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# thing\u4e00\u89a7\n$aws iot list-things\n{\n    \"things\": [\n        {\n            \"attributes\": {},\n            \"thingName\": \"MyNewThing\"\n        }\n    ]\n}\n\n# Policy\u4e00\u89a7\n$ aws iot list-policies\n{\n    \"policies\": [\n        {\n            \"policyName\": \"MyNewThing-Policy\",\n            \"policyArn\": \"arn:aws:iot:ap-northeast-1:xxxx:policy/MyNewThing-Policy\"\n        }\n    ]\n}\n\n# Certificate\u4e00\u89a7\n$aws iot list-certificates\n{\n    \"certificates\": [\n        {\n            \"certificateArn\": \"arn:aws:iot:ap-northeast-1:xxxx:cert/xxxxxx\",\n            \"status\": \"ACTIVE\",\n            \"creationDate\": 1459740701.304,\n            \"certificateId\": \"xxxxxx\"\n        }\n    ]\n}\n\n\n\u6700\u521d\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n# \u30dd\u30ea\u30b7\u30fc\u304b\u3089\u8a3c\u660e\u66f8\u3092\u30c7\u30bf\u30c3\u30c1\u3059\u308b\n$aws iot detach-principal-policy --policy-name MyNewThing-Policy --principal arn:aws:iot:ap-northeast-1:xxxxxx:cert/xxxxxx\n\n# \u524a\u9664\n$aws iot delete-policy --policy-name MyNewThing-Policy\n\n\u6b21\u306b\u8a3c\u660e\u66f8\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u30b9\u30c6\u30fc\u30bf\u30b9\u306e\u5909\u66f4\u3082\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n# thing\u3068principal\u306e\u95a2\u9023\u3092\u524a\u9664\u3059\u308b.principal\u306b\u306fcertificate\u306eARN\u3092\u6307\u5b9a\n$aws iot detach-thing-principal --thing-name MyNewThing --principal arn:aws:iot:ap-northeast-1:xxxxx:cert/xxxxx\n\n# \u8a3c\u660e\u66f8\u306e\u72b6\u614b\u3092ACTIVE\u304b\u3089INACTIVE\u306b\u66f4\u65b0\n$aws iot update-certificate --certificate-id xxxxxxxx--new-status INACTIVE\n\n# \u8a3c\u660e\u66f8\u306e\u524a\u9664\n$aws iot delete-certificate --certificate-id xxxxxxxxxxxxxxxx\n\n\u6700\u5f8c\u306bthing\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n# thing\u306e\u524a\u9664\n$ aws iot delete-thing --thing-name MyNewThing\n\n\u3053\u308c\u3067OK\u3067\u3059!\n\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u30fc!\nAWS IoT\u3092\u4f7f\u3063\u305f\u3053\u3068\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u4f7f\u3063\u3066\u307f\u305f\u3068\u304d\u306e\u30e1\u30e2\u3002\n\nAWS IoT DeviceSDK(Node.js)\u3092\u4f7f\u3063\u3066\u3001MQTT\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(Mac)\u304b\u3089AWS IoT\u7d4c\u7531\u3067Thing(\u30e9\u30ba\u30d1\u30a4)\u306b\u63a5\u7d9a\u3055\u308c\u305fLED\u3092\u30c1\u30ab\u30c1\u30ab\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\n# \u53c2\u8003\n\n+ [Mosquitto(MQTT)\u3092\u52d5\u304b\u3057\u3066\u307f\u305f](http://tomowatanabe.hatenablog.com/entry/2014/04/21/095650)\n+ [MQTT\u306b\u3064\u3044\u3066\u306e\u307e\u3068\u3081](http://tdoc.info/blog/2014/01/27/mqtt.html)\n+ [AWS IoT\u3092\u901a\u3057\u3066Raspberry Pi 2\u306eL\u30c1\u30ab\u3092\u5b9f\u88c5](http://qiita.com/horike37/items/5cb14c42831d3430abf7)\n\n# \u74b0\u5883\n\n+ \u30af\u30e9\u30a4\u30a2\u30f3\u30c8(Mac OSX 10.11.4)\n+ \u30e9\u30ba\u30d1\u30a43\n+ AWS IoT DeviceSDK for Node.js\n\n\u30e9\u30ba\u30d1\u30a4\u306eLED\u3067\u306e\u30c1\u30ab\u30c1\u30ab\u306f\u4ee5\u524d\u66f8\u3044\u305f\u3082\u306e\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n[Node.js\u3067\u30e9\u30ba\u30d1\u30a4\u306b\u63a5\u7d9a\u3057\u305fLED\u3092\u70b9\u706f\u3001\u6d88\u706f\u3055\u305b\u308b(L\u30c1\u30ab)](http://qiita.com/toshihirock/items/880a43ff4a5506b629c5)\n\n# \u4eca\u56de\u306fAWS IoT\u306e\u3069\u306e\u90e8\u5206\u3092\u4f7f\u3046\u306e\u304b\n\nAWS IoT\u306f\u69d8\u3005\u306a\u69cb\u6210\u8981\u7d20\u304c\u3042\u308a\u307e\u3059\u3002\n\n[AWS IoT \u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u306e\u4ed5\u7d44\u307f](https://aws.amazon.com/jp/iot/how-it-works/)\n\n\u4eca\u56de\u306f\u4ee5\u4e0b\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\n+ AWS IoT\u30c7\u30d0\u30a4\u30b9SDK->AWS IoT\u3067\u7528\u610f\u3059\u308b\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3068\u306e\u6697\u53f7\u5316\u901a\u4fe1\u3092\u884c\u3046\u969b\u306b\u5229\u7528\u3002MQTT,HTTP,WebSocket\u30d7\u30ed\u30c8\u30b3\u30eb\u304c\u4f7f\u3048\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u4eca\u56de\u306fMQTT\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u4f7f\u3044\u307e\u3059\u3002SDK\u306fC,JavaScript\u53ca\u3073Arduino\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u304a\u308a\u3001JavScript(Node.js)\u3092\u5229\u7528\n+ \u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4->IoT\u3084\u30c7\u30d0\u30a4\u30b9\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3068\u3057\u3066\u5229\u7528\u3002MQTT\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067MQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u3068\u3057\u3066\u5229\u7528\u300210\u5104\u4ee5\u4e0a\u306e\u30c7\u30d0\u30a4\u30b9\u306b\u3082\u5bfe\u5fdc\u3067\u304d\u308b\u3088\u3046\u306b\u81ea\u52d5\u7684\u306b\u30b9\u30b1\u30fc\u30eb\u3059\u308b\u3089\u3057\u3044\u3002\u3059\u3054\u3044\n+ \u8a8d\u8a3c\u3068\u8a8d\u53ef->IoT\u3068\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u9593\u306e\u901a\u4fe1\u306f\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u7d4c\u7531\u3068\u306a\u308a\u307e\u3059\u3002\u4e0a\u8a18\u3088\u308a\u3001\u591a\u304f\u306e\u5834\u5408\u3067\u901a\u4fe1\u306e\u6697\u53f7\u5316\u304c\u5fc5\u8981\u3002\u307e\u305f\u3001\u76f8\u4e92\u8a8d\u8a3c\uff08\u507d\u8005\u306e\u30c7\u30d0\u30a4\u30b9\u304b\u3089\u306e\u30c7\u30fc\u30bf\u3067\u306f\u306a\u3044\uff09\u306e\u6a5f\u80fd\u3082\u5fc5\u8981\u3067\u3059\u3002\u305d\u3053\u3067AWS IoT\u3067\u306f\u6697\u53f7\u5316\u306bTLS\u3092\u5229\u7528\u3057\u3001\u8a8d\u8a3c\u3067\u306fAWS\u306e\u8a8d\u8a3c\u30e1\u30bd\u30c3\u30c9(SigV4)\u3092\u4f7f\u3046\u3053\u3068\u3067\u5b9f\u65bd\u3059\u308b\u3082\u306e\u3067\u3059\u3002\u4eca\u56de\u306e\u4f8b\u3067\u3082IoT\u3068\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u9593\u306e\u8a8d\u8a3c\u3068\u8a8d\u53ef\u3092\u3057\u3066\u3044\u307e\u3059\u304c\u3001AWS\u30c7\u30d0\u30a4\u30b9SDK\u3067\u30e9\u30c3\u30d7\u3057\u3066\u3044\u308b\u306e\u3067\u30b3\u30fc\u30c9\u81ea\u4f53\u304c\u8907\u96d1\u306b\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u307e\u305f\u3001\u8a3c\u660e\u66f8\u3084\u516c\u958b\u9375\u30fb\u79d8\u5bc6\u9375\u306e\u751f\u6210\u3084\u7ba1\u7406\u3092AWS IoT\u3067\u5b9f\u65bd\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u4ed6\u306b\u3082\u30c7\u30d0\u30a4\u30b9\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306b\u9001\u4fe1\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306e\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3084\u4ed6\u306eAWS\u30ea\u30bd\u30fc\u30b9\u3068\u306e\u9023\u643a\u3092\u884c\u3046\u300c\u30eb\u30fc\u30eb\u30a8\u30f3\u30b8\u30f3\u300d\u6a5f\u80fd\u3084\u3001\u30c7\u30d0\u30a4\u30b9\u304c\u30aa\u30d5\u30e9\u30a4\u30f3\u306e\u72b6\u614b\u304b\u3089\u30aa\u30f3\u30e9\u30a4\u30f3\u72b6\u614b\u306b\u5fa9\u5e30\u3057\u305f\u969b\u306b\u30c7\u30fc\u30bf\u306e\u540c\u671f\u3092\u884c\u3046\u4e8b\u304c\u51fa\u6765\u308b\u300c\u30c7\u30d0\u30a4\u30b9\u30b7\u30e3\u30c9\u30a6\u300d\u3068\u3044\u3046\u6a5f\u80fd\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u5229\u7528\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n# AWS IoT\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n\n\u307e\u305a\u521d\u3081\u306bAWS IoT\u306e\u8a2d\u5b9a\u3092\u30de\u30cd\u30fc\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u884c\u3044\u307e\u3059\u3002\n\u3053\u3061\u3089\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n[Getting Started with AWS IoT on Raspberry Pi and the AWS IoT Device SDK for Node.js](https://docs.aws.amazon.com/iot/latest/developerguide/iot-device-sdk-node.html)\n\n## thing(\u30c7\u30d0\u30a4\u30b9)\u306e\u767b\u9332\n\n\u6700\u521d\u306bthing(\u30c7\u30d0\u30a4\u30b9)\u306e\u767b\u9332\u3092\u884c\u3044\u307e\u3059\u3002\nthing\u3068\u306f\u5177\u4f53\u7684\u306b\u306f\u30e9\u30ba\u30d9\u30ea\u30fc\u30d1\u30a4\u3067\u3042\u3063\u305f\u308a\u3001AWS IoT\u3068\u63a5\u7d9a\u3059\u308b **\u4f55\u3089\u304b\u306e\u30c7\u30d0\u30a4\u30b9** \u3068\u3044\u3046\u610f\u5473\u3060\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\n\u3068\u308a\u3042\u3048\u305a\u30de\u30cd\u30fc\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u753b\u9762\u3092\u958b\u304d\u307e\u3059\u3002\n\n![Screen Shot 2016-04-03 at 7.32.35 AM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/705f5a79-8b80-dfd3-6710-886b7cae673d.png \"Screen Shot 2016-04-03 at 7.32.35 AM.png\")\n\n\u300cGet started\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n\u6b21\u306e\u753b\u9762\u3067thins\u3092\u4efb\u610f\u306e\u540d\u79f0\u3067\u767b\u9332\u3057\u307e\u3059\u3002\n\n![Screen Shot 2016-04-03 at 7.35.50 AM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/93fd2f77-1e65-4401-e742-00afd6da3b7e.png \"Screen Shot 2016-04-03 at 7.35.50 AM.png\")\n\n\u540d\u79f0\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3068\u308a\u3042\u3048\u305a\u300cMyNewThing\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u767b\u9332\u3057\u307e\u3057\u3087\u3046\u3002\n\u5165\u529b\u5f8c\u3001\u300cCreate\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u3067thing\u304c\u767b\u9332\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u6b21\u306e\u753b\u9762\u3067\u300cView Thing\u300d\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u3067thing\u3054\u3068\u306eREST API\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306a\u3069\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n![Screen Shot 2016-04-03 at 7.41.08 AM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/b1d74d23-2cab-7d8c-315d-e08c5deb7201.png \"Screen Shot 2016-04-03 at 7.41.08 AM.png\")\n\n![thing.png](https://qiita-image-store.s3.amazonaws.com/0/20193/26736cf4-b224-f12b-fd7e-3d7a58bba861.png \"thing.png\")\n\n## \u30ad\u30fc\u30da\u30a2(\u516c\u958b\u9375\u3001\u79d8\u5bc6\u9375)\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u53ca\u3073\u8a3c\u660e\u66f8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\nAWS IoT\u3067\u306f\u901a\u4fe1\u3092\u884c\u3046\u969b\u306bTLS\u306b\u3088\u308b\u6697\u53f7\u5316\u3092\u884c\u3063\u3066\u901a\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\nTLS\u901a\u4fe1\u306e\u969b\u306b\u5fc5\u8981\u306a\u8a3c\u660e\u66f8\u3084\u30ad\u30fc\u30da\u30a2\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u5148\u307b\u3069\u767b\u9332\u3057\u305fMyNewThing\u306e\u8a73\u7d30\u3092\u8868\u793a\u3057\u3066\u3044\u308b\u753b\u9762\u306e\u53f3\u4e0b\u306e\u300cConnect device\u300d\u3068\u3044\u3046\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u307e\u3059\u3002\n\n![thing.png](https://qiita-image-store.s3.amazonaws.com/0/20193/26736cf4-b224-f12b-fd7e-3d7a58bba861.png \"thing.png\")\n\n\u6b21\u306e\u753b\u9762\u3067\u306fthing\u3068AWS IoT\u3068\u306e\u901a\u4fe1\u306f\u4f55\u3092\u4f7f\u3063\u3066\u884c\u3046\u304b\u306e\u78ba\u8a8d\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u4eca\u56de\u306fNode.js\u306eDeviceSDK\u3092\u4f7f\u3046\u306e\u3067\u300cNode.js\u300d\u3092\u30c1\u30a7\u30c3\u30af\u3057\u307e\u3059\u3002\n\n![Screen Shot 2016-04-03 at 7.50.56 AM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/2679a9f3-1dea-39eb-3459-a4323b165d19.png \"Screen Shot 2016-04-03 at 7.50.56 AM.png\")\n\n\u9078\u629e\u5f8c\u3001\u4e0a\u8a18\u753b\u9762\u306e\u3088\u3046\u306b\u300cGenerate certificate and policy\u300d\u3068\u3044\u3046\u30dc\u30bf\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u9078\u629e\u3057\u3066\u8a3c\u660e\u66f8\u3068\u30dd\u30ea\u30b7\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u9078\u629e\u5f8c\u3001\u5c11\u3057\u5f85\u3064\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![Screen Shot 2016-04-03 at 7.56.06 AM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/0d0dbf7b-d8c3-ff6b-3e1f-570913d924f2.png \"Screen Shot 2016-04-03 at 7.56.06 AM.png\")\n\n+ \u516c\u958b\u9375\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n+ \u79d8\u5bc6\u9375\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n+ \u8a3c\u660e\u66f8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u8a3c\u660e\u66f8\u306f\u3044\u3064\u3067\u3082\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u516c\u958b\u9375\u3001\u79d8\u5bc6\u9375\u306f\u3053\u306e\u30da\u30fc\u30b8\u306e\u307f\u3057\u304b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u5fd8\u308c\u305a\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u5404\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001Mac\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u81ea\u5206\u306e\u5834\u5408\u3001\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u540d\u3068\u306a\u3063\u3066\u304a\u308a\u307e\u3057\u305f\u3002\n\n+ xxxxx-certificate.pem.crt->\u8a3c\u660e\u66f8\n+ xxxxx-private.pem.key->\u79d8\u5bc6\u9375\n+ xxxxx-public.pem.key->\u516c\u958b\u9375\n\n`openssl`\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u30c7\u30b3\u30fc\u30c9\u3067\u3057\u3066\u8a73\u7d30\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```bash\n# X.509\u8a3c\u660e\u66f8\u3092\u30c7\u30b3\u30fc\u30c9\n$openssl x509 -text < xxxx-certificate.pem.crt\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number:\n            xxxxxx\n    Signature Algorithm: sha256WithRSAEncryption\n        Issuer: OU=Amazon Web Services O=Amazon.com Inc. L=Seattle ST=Washington C=US\n        Validity\n            Not Before: Apr  2 22:53:28 2016 GMT\n            Not After : Dec 31 23:59:59 2049 GMT\n        Subject: CN=AWS IoT Certificate\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                Public-Key: (2048 bit)\n(\u4ee5\u4e0b\u7565)\n```\n\n\u4e0a\u8a18\u3088\u308a\u4ee5\u4e0b\u3068\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u306d\u3002\n\n+ \u516c\u958b\u9375\u6697\u53f7\u65b9\u5f0f\u306b2048bit\u306eRSA\n+ \u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306bSHA-256\n\n## \u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n[\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8](http://e-words.jp/w/%E3%83%AB%E3%83%BC%E3%83%88%E8%A8%BC%E6%98%8E%E6%9B%B8.html)\n\nSSL/TLS\u901a\u4fe1\u3067\u306f\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u53d6\u5f97\u3057\u305f\u30c7\u30b8\u30bf\u30eb\u8a3c\u660e\u66f8\u304c\u6b63\u5f53\u306a\u3082\u306e\u3067\u3042\u308b\u304b\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30c7\u30b8\u30bf\u30eb\u8a3c\u660e\u66f8\u304c\u6b63\u3057\u3044\u304b\u306b\u3064\u3044\u3066\u306f\u300c\u6b63\u5f53\u306a\u8a8d\u8a3c\u5c40\u304b\u3089\u767a\u884c\u3055\u308c\u305f\u3082\u306e\u3067\u3042\u308c\u3070\u6b63\u3057\u3044\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u8a3c\u660e\u3055\u308c\u307e\u3059\u3002\n\n\u5177\u4f53\u7684\u306bamazon.co.jp\u3092\u4f8b\u306b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u8a3c\u660e\u66f8\u60c5\u5831\u3092\u78ba\u8a8d\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u968e\u5c64\u69cb\u9020\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n![Screen Shot 2016-04-03 at 8.45.44 AM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/3f3560d8-3850-edc4-7f56-8296707d7430.png \"Screen Shot 2016-04-03 at 8.45.44 AM.png\")\n\n\n+ www.amazon.co.jp\u306e\u8a3c\u660e\u66f8\u306f\u8a8d\u8a3c\u5c40\u306e\u30b7\u30de\u30f3\u30c6\u30c3\u30af\u304b\u3089\u767a\u884c\u3055\u308c\u305f\n+ \u30b7\u30de\u30f3\u30c6\u30c3\u30af\u306e\u8a3c\u660e\u66f8\u306f\u8a8d\u8a3c\u5c40\u306e\u30d9\u30ea\u30b5\u30a4\u30f3\u304b\u3089\u767a\u884c\u3055\u308c\u305f\n\n\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3058\u3083\u3042\u6700\u5f8c\u306b\u30d9\u30ea\u30b5\u30a4\u30f3\u306e\u8a3c\u660e\u66f8\u306f\u4f55\u3092\u6301\u3063\u3066\u6b63\u5f53\u3067\u3042\u308b\u3068\u5224\u65ad\u3059\u308b\u304b\u3068\u3044\u3046\u3068\u3053\u3053\u3067\u767b\u5834\u3059\u308b\u306e\u304c\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3064\u307e\u308a\n\n+ \u30d9\u30ea\u30b5\u30a4\u30f3\u306e\u8a3c\u660e\u66f8\u306f\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u304b\u3089\u767a\u884c\u3055\u308c\u305f(\u306a\u306e\u3067\u6700\u7d42\u7684\u306bwww.amazon.co.jp\u306f\u6b63\u5f53\u306a\u3082\u306e)\n\n\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u5e7e\u3064\u304b\u306e\u8a8d\u8a3c\u5c40\u306f\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3068\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u306a\u3069\u306b\u6700\u521d\u304b\u3089\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u6211\u3005\u304c\u901a\u5e38\u898b\u308b\u3088\u3046\u306a\u30b5\u30a4\u30c8\u3092\u95b2\u89a7\u3059\u308b\u969b\u306b\u308f\u3056\u308f\u3056\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u305f\u3060\u3057\u3001\u4eca\u56de\u306f\u901a\u4fe1\u3092\u3059\u308b\u306e\u304c\u30d6\u30e9\u30a6\u30b6\u3067\u306f\u306a\u3044\u305f\u3081\u3001\u5bfe\u8c61\u306e\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3060\u3051\u4e88\u3081\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u8a71\u304c\u9038\u308c\u307e\u3057\u305f\u304c\u3001\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```bash\n# root-CA.crt\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u3092\u53d6\u5f97\n$wget -O root-CA.crt https://www.symantec.com/content/en/us/enterprise/verisign/roots/VeriSign-Class%203-Public-Primary-Certification-Authority-G5.pem\n```\n\n# Mac\u5074\u3067Pubulish\u306e\u5b9f\u88c5\u3092\u3059\u308b\n\n\u6700\u521d\u306bMac\u5074\u3067AWS IoT\u3067\u7528\u610f\u3057\u305fMQTT\u30d6\u30ed\u30fc\u30ab\u30fc\u3078LED\u306eON/OFF\u306e\u8a2d\u5b9a\u3092\u5b9a\u671f\u7684\u306b\u9001\u4fe1\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\n\u4f5c\u6210\u306b\u306fAWS DeviceSDK\u306eNode.js\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n[aws/aws-iot-device-sdk-js](https://github.com/aws/aws-iot-device-sdk-js)\n\n\u307e\u305a\u306f\u4e0a\u8a18\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$npm install aws-iot-device-sdk\n```\n\n\u4e0a\u8a18\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n```publish.js\n// AWS IoT DeviceSDK\u306e\u5229\u7528\nvar awsIot = require('aws-iot-device-sdk');\n\n// \u79d8\u5bc6\u9375\u3001\u8a3c\u660e\u66f8\u306a\u3069\u306e\u8a2d\u5b9a\nvar device = awsIot.device({\n  region: 'ap-northeast-1',\n  clientId: 'MyNewThing-client',\n  privateKey: 'certs/private.pem.key',\n  clientCert: 'certs/certificate.pem.crt',\n  caCert: 'certs/root-CA.crt',\n});\n\nvar count = 0;\n\n// \u901a\u4fe1\u78ba\u7acb\u3057\u305f\u969b\u306b\u547c\u3073\u51fa\u3055\u308c\u308b\u30a4\u30d9\u30f3\u30c8\ndevice.on('connect', function() {\n  console.log('connect');\n  setInterval( function() {\n    count++;\n    var led = count % 2;\n    console.log(led.toString());\n    device.publish('topic_1', led.toString());\n  }, 1000);\n});\n\n```\n\nsetInterval\u95a2\u6570\u3092\u4f7f\u3063\u3066\u5468\u671f\u7684\u306btopic_1\u3068\u3044\u3046\u30c8\u30d4\u30c3\u30af\u306b\u5bfe\u3057\u30660\u3082\u3057\u304f\u306f1\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n\u306a\u304a\u3001awsIot.device\u30af\u30e9\u30b9\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u8a2d\u5b9a\u3059\u308b\u30ea\u30fc\u30b8\u30e7\u30f3\u3084\u8a3c\u660e\u66f8\u3001\u79d8\u5bc6\u9375\u306e\u30d1\u30b9\u306f\u9069\u5b9c\u5909\u66f4\u304f\u3060\u3055\u3044\u3002\n\n# \u30e9\u30ba\u30d1\u30a4\u5074\u3067subscribe\u306e\u5b9f\u88c5\u3092\u3059\u308b\n\n\u30e9\u30ba\u30d1\u30a4\u5074\u3067\u306eNode.js\u74b0\u5883\u306e\u69cb\u7bc9\u3084\u3069\u3046\u3084\u3063\u3066\u30e9\u30ba\u30d1\u30a4\u304b\u3089LED\u306eON/OFF\u3092\u3059\u308b\u304b\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\n[Node.js\u3067\u30e9\u30ba\u30d1\u30a4\u306b\u63a5\u7d9a\u3057\u305fLED\u3092\u70b9\u706f\u3001\u6d88\u706f\u3055\u305b\u308b(L\u30c1\u30ab)](http://qiita.com/toshihirock/items/880a43ff4a5506b629c5)\n\n\u30e9\u30ba\u30d1\u30a4\u5074\u3067\u3082\u540c\u3058\u3088\u3046\u306bAWS IoT DeviceSDK\u3092\u4f7f\u3063\u3066publish\u3055\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067LED\u3092ON/OFF\u306b\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u79d8\u5bc6\u9375\u3001\u8a3c\u660e\u66f8\u3001\u30eb\u30fc\u30c8\u8a3c\u660e\u66f8\u306fMac\u304b\u3089scp\u306a\u3069\u3067\u30b3\u30d4\u30fc\u3059\u308b\u304b\u5225\u9014\u4ed6\u306e\u3082\u306e\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u540c\u3058\u3088\u3046\u306bnpm\u3067\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$npm install aws-iot-device-sdk\n$npm install sleep\n```\n\n\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```subscribe.js\nvar awsIot = require('aws-iot-device-sdk');\nvar fs = require('fs');\nvar sleep = require('sleep');\nvar pin = 4;\n\nvar device = awsIot.device({\n  region: 'ap-northeast-1',\n  clientId: 'MyNewThing',\n  privateKey: 'certs/private.pem.key',\n  clientCert: 'certs/certificate.pem.crt',\n  caCert: 'certs/root-CA.crt',\n});\n\n// \u901a\u4fe1\u78ba\u7acb\u6642\ndevice.on('connect', function() {\n  console.log('connect');\n  device.subscribe('topic_1');\n  fs.writeFileSync('/sys/class/gpio/export', pin);\n  \n  // \u3059\u3050\u306b\u66f8\u304d\u8fbc\u3082\u3046\u3068\u3059\u308b\u3068\u6a29\u9650\u30a8\u30e9\u30fc\u306e\u305f\u3081sleep\u3055\u305b\u308b\n  sleep.sleep(1);\n  fs.writeFileSync('/sys/class/gpio/gpio' + pin + '/direction', 'out');\n});\n\n// subscribe\u3057\u305f\u30c8\u30d4\u30c3\u30af\u306bpublish\u3055\u308c\u305f\u6642\u306e\u30a4\u30d9\u30f3\u30c8\ndevice.on('message', function(topic, payload) {\n  console.log('message', topic, payload.toString());\n  \n  // 1\u306e\u6642\u306fLED\u3092ON.0\u306e\u6642\u306fLED\u3092OFF\n  fs.writeFileSync('/sys/class/gpio/gpio' + pin + '/value', payload.toString());\n});\n\nprocess.stdin.resume();\n\n// Ctrl+C\u306b\u3088\u3063\u3066\u7d42\u4e86\u3059\u308b\u5834\u5408\u306e\u51e6\u7406\nprocess.on('SIGINT', function() {\n  console.log('receive SIGINT signal');\n  fs.writeFileSync('/sys/class/gpio/unexport', pin);\n  process.exit();\n});\n```\n\n\u306a\u304a\u3001`clientId`\u306b\u3064\u3044\u3066\u306fMac\u5074\u3068\u9055\u3046\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002(clientId\u306f\u91cd\u8907\u4e0d\u53ef\u306e\u305f\u3081\u3001\u3069\u3061\u3089\u304b\u3067\u63a5\u7d9a\u304c\u78ba\u7acb\u3055\u308c\u308b\u3068\u3082\u3046\u4e00\u65b9\u306e\u63a5\u7d9a\u304c\u5207\u308c\u308b\u305f\u3081)\n\n# LED\u306e\u30c1\u30ab\u30c1\u30ab(L\u30c1\u30ab)\u3092\u3084\u3063\u3066\u307f\u308b\n\n\u3067\u306f\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u5148\u306b\u30e9\u30ba\u30d1\u30a4\u5074\u306e\u5b9f\u884c\u3092\u3057\u3066\u3001topic_1\u3068\u3044\u3046\u30c8\u30d4\u30c3\u30af\u306esubscribe\u3092\u3057\u307e\u3059\u3002\n\n```bash\n$node subscribe.js\nconnect\n```\n\n\u6b21\u306bMac\u5074\u306e\u30b3\u30fc\u30c9\u3092\u52d5\u304b\u3057\u3001\u5bfe\u8c61\u30c8\u30d4\u30c3\u30af\u306b\u5bfe\u3057\u30660\u30681\u306e\u60c5\u5831\u3092\u5b9a\u671f\u7684\u306b\u9001\u4fe1\u3059\u308b(publish)\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash\n$node publish.js\nnode publish.js\nconnect\n1\n0\n1\n\u30fb\u30fb\u30fb\n```\n\n\u3046\u307e\u304f\u3044\u3051\u3070\u4e0a\u8a18\u306e\u3088\u3046\u306b1,0,1,0...\u3068\u6a19\u6e96\u51fa\u529b\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u30e9\u30ba\u30d1\u30a4\u5074\u3082\u78ba\u8a8d\u3059\u308b\u3068\u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\u6642\u306b\u6a19\u6e96\u51fa\u529b\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\n```bash\nmessage topic_1 1\nmessage topic_1 0\nmessage topic_1 1\nmessage topic_1 0\n\u30fb\u30fb\u30fb\n```\n\n\u307e\u305f\u30010\u306e\u53d7\u4fe1\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u306f\u6d88\u706f\u30011\u306e\u53d7\u4fe1\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u306fLED\u304c\u70b9\u706f\u3059\u308b\u3053\u3068\u3082\u78ba\u8a8d\u3067\u304d\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3069\u3061\u3089\u3082\u7d42\u4e86\u306fCtrl+C\u306b\u3088\u3063\u3066\u7d42\u4e86\u3057\u307e\u3059\u3002\n\n# AWS IoT\u306e\u524a\u9664\n\n\u6700\u5f8c\u306b\u4f5c\u6210\u3057\u305fAWS\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n\u3068\u305d\u306e\u524d\u306b\u5c11\u3057\u73fe\u5728\u306e\u72b6\u614b\u3092\u6574\u7406\u3057\u307e\u3059\u3002\n\u73fe\u5728\u306f\u4ee5\u4e0b\u306e3\u3064\u306e\u30ea\u30bd\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\n\n+ Thing(\u30c7\u30d0\u30a4\u30b9)\n+ Policy(\u30dd\u30ea\u30b7\u30fc\uff09\n+ Certicficate(\u8a3c\u660e\u66f8\uff09\n\n\u305d\u3057\u3066\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u95a2\u9023\u304c\u3042\u308a\u307e\u3059\u3002\n\n+ Thing\u306bCertificate\u304c\u7d10\u3065\u3044\u3066\u3044\u308b\n+ Policy\u306bCertificate\u304c\u7d10\u3065\u3044\u3066\u3044\u308b\n\n\u306a\u306e\u3067\u305d\u308c\u305e\u308c\u3092\u3044\u304d\u306a\u308a\u524a\u9664\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u30a8\u30e9\u30fc\u3068\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u7d10\u3065\u3044\u305f\u5185\u5bb9\u3092\u89e3\u6d88\u3057\u3064\u3064\u3001\u524a\u9664\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30de\u30cd\u30fc\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u306e\u3084\u308a\u65b9\u304c\u4e0d\u660e\u3060\u3063\u305f\u306e\u3067AWS CLI\u3092\u4f7f\u3063\u3066\u3084\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u305d\u308c\u305e\u308c\u306e\u60c5\u5831(ID\u3084ARN\u306a\u3069\uff09\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n# thing\u4e00\u89a7\n$aws iot list-things\n{\n    \"things\": [\n        {\n            \"attributes\": {},\n            \"thingName\": \"MyNewThing\"\n        }\n    ]\n}\n\n# Policy\u4e00\u89a7\n$ aws iot list-policies\n{\n    \"policies\": [\n        {\n            \"policyName\": \"MyNewThing-Policy\",\n            \"policyArn\": \"arn:aws:iot:ap-northeast-1:xxxx:policy/MyNewThing-Policy\"\n        }\n    ]\n}\n\n# Certificate\u4e00\u89a7\n$aws iot list-certificates\n{\n    \"certificates\": [\n        {\n            \"certificateArn\": \"arn:aws:iot:ap-northeast-1:xxxx:cert/xxxxxx\",\n            \"status\": \"ACTIVE\",\n            \"creationDate\": 1459740701.304,\n            \"certificateId\": \"xxxxxx\"\n        }\n    ]\n}\n\n```\n\n\u6700\u521d\u306b\u30dd\u30ea\u30b7\u30fc\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n```bash\n# \u30dd\u30ea\u30b7\u30fc\u304b\u3089\u8a3c\u660e\u66f8\u3092\u30c7\u30bf\u30c3\u30c1\u3059\u308b\n$aws iot detach-principal-policy --policy-name MyNewThing-Policy --principal arn:aws:iot:ap-northeast-1:xxxxxx:cert/xxxxxx\n\n# \u524a\u9664\n$aws iot delete-policy --policy-name MyNewThing-Policy\n```\n\n\u6b21\u306b\u8a3c\u660e\u66f8\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u30b9\u30c6\u30fc\u30bf\u30b9\u306e\u5909\u66f4\u3082\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\n```bash\n# thing\u3068principal\u306e\u95a2\u9023\u3092\u524a\u9664\u3059\u308b.principal\u306b\u306fcertificate\u306eARN\u3092\u6307\u5b9a\n$aws iot detach-thing-principal --thing-name MyNewThing --principal arn:aws:iot:ap-northeast-1:xxxxx:cert/xxxxx\n\n# \u8a3c\u660e\u66f8\u306e\u72b6\u614b\u3092ACTIVE\u304b\u3089INACTIVE\u306b\u66f4\u65b0\n$aws iot update-certificate --certificate-id xxxxxxxx--new-status INACTIVE\n\n# \u8a3c\u660e\u66f8\u306e\u524a\u9664\n$aws iot delete-certificate --certificate-id xxxxxxxxxxxxxxxx\n```\n\n\u6700\u5f8c\u306bthing\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n```bash\n# thing\u306e\u524a\u9664\n$ aws iot delete-thing --thing-name MyNewThing\n```\n\n\u3053\u308c\u3067OK\u3067\u3059!\n\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u30fc!\n", "tags": ["AWS", "awsIoT", "RaspberryPi", "Node.js"]}