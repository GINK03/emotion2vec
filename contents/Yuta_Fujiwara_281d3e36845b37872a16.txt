{"context": "9\u6708\u672b\u306bLINE\u304b\u3089\u767a\u8868\u3055\u308c\u305fLINE BOT\u304c\u4f5c\u308c\u308bMessaging API\u3092\u4f7f\u3063\u3066\u3001\u7c21\u6613\u7684\u306a\u4f1a\u8a71\u304c\u3067\u304d\u308bBOT\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u4ee5\u4e0b\u306e\u74b0\u5883\u3092\u7528\u3044\u3066\u52d5\u304b\u3057\u307e\u3059\u3002\n- LINE developer\n- PHP (\u53c2\u8003\u8cc7\u6599\u304c\u591a\u304b\u3063\u305f\u306e\u3067)\n- \u3055\u304f\u3089VPS\n- docomo API\n\nLINE developers\u8a2d\u5b9a\n\u3053\u3053\u304c\u4e00\u756a\u9762\u5012\u306a\u4f5c\u696d\u306b\u306a\u308a\u307e\u3059\u3002(\u50d5\u3082\u3053\u3053\u3067\u4e00\u756a\u3064\u307e\u308a\u307e\u3057\u305f...)\n\u307e\u305a\u306fLINE BUSINESS CENTER\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3002\n\n\nLINE BUSINESS CENTER\nhttps://business.line.me/ja/\n\n\n\u300c\u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30b9\u30c8\u300d\u304b\u3089\u300c\u30d3\u30b8\u30cd\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u300d\u3092\u9078\u629e\u3002\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u306b\u3044\u304d\u307e\u3059\u3002\u3053\u3053\u304b\u3089\u300c\u4e00\u822c\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u59cb\u3081\u308b\u300d\u3092\u9078\u629e\u3002\n\u203b\u50d5\u306e\u5834\u5408\u3053\u3053\u3067\u300c\u8a8d\u8a3c\u6e08\u307f\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7533\u3057\u8fbc\u3080\u300d\u3092\u9078\u629e\u3057\u3066\u3057\u307e\u3044\u8a70\u307e\u308a\u307e\u3057\u305f\u3002\u4eca\u56de\u306f\u7121\u6599\u306e\u300c\u4e00\u822c\u30a2\u30ab\u30a6\u30f3\u30c8\u300d\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\u305d\u3057\u3066Bot\u306e\u540d\u524d\u3068\u696d\u7a2e\u3092\u9078\u629e\u3057\u3066\u3001\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7533\u3057\u8fbc\u307f\u767b\u9332\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30b9\u30c8\u306b\u3066\u81ea\u5206\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u3067\u304d\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002Messaging API\u3092\u7533\u3057\u8fbc\u307f\u3092\u884c\u3044\u307e\u3059\u3002\u3053\u3053\u304b\u3089\u3001LINE MANAGER\u306e\u30da\u30fc\u30b8\u3078\u3002\n\n\nLINE MANAGER\u8a2d\u5b9a\n\u300c\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a\u300d\u2192\u300cBot\u8a2d\u5b9a\u300d\u3092\u9078\u629e\u3057\u3001\u4ee5\u4e0b\u306e\u753b\u9762\u306e\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\u203b\u300c\u5229\u7528\u53ef\u80fd\u306aAPI\u300d\u304cREPLY_MESSAGE\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\u3082\u3057PUSH_MESSAGE\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u6709\u6599\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u5fc5\u8981\u306b\u306a\u308b\u305f\u3081\u3001\u7121\u6599\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u306fJSON\u304c\u8fd4\u3063\u3066\u304d\u307e\u305b\u3093\u3002\n\n\nLINE deveroper\u8a2d\u5b9a\n\u2460PHP\u3092\u7f6e\u3044\u3066\u3044\u308b\u30b5\u30fc\u30d0\u306eURL\u3092\u8a2d\u5b9a\u3002\nhttps://\u3010\u3055\u304f\u3089\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\u3011.sakura.ne.jp/LineBot/MessagingBot/callback.php\n\n\u2461\u30b5\u30fc\u30d0\u306fSSL\u8a8d\u8a3c\u304c\u3042\u308b\u3082\u306e(\u3055\u304f\u3089VPS\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u8a2d\u5b9a\u6e08)\n\u2462Cannel Access Token\u306f\u5f8c\u307b\u3069\u4f7f\u3044\u307e\u3059\u3002\n\n\u3053\u308c\u3067LINE\u306e\u8a2d\u5b9a\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n\u3055\u304f\u3089VPS\n\u3055\u304f\u3089\u306e\u30b5\u30fc\u30d0\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d1\u30cd\u30eb\u304b\u3089\u3001\u30c9\u30e1\u30a4\u30f3\u8a2d\u5b9a\u306e\u30da\u30fc\u30b7\u3092\u958b\u304d\u307e\u3059\u3002\u30b5\u30af\u30e9\u306eVPS\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067SSL\u3092\u5229\u7528\u3067\u304d\u308b\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3082\u3057SSL\u306e\u8a2d\u5b9a\u304c\u5229\u7528\u4e2d\u306b\u306a\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u300c\u5909\u66f4\u300d\u304b\u3089\u3001\u5171\u6709SSL\u306e\u8a2d\u5b9a\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308c\u3070OK\uff01\n\n\n\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\n\u3055\u304f\u3089\u306e\u30d5\u30a1\u30a4\u30eb\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u3092\u958b\u304d\u307e\u3059\u3002LINE developer\u3067\u8a2d\u5b9a\u3057\u305f\u968e\u5c64\u306b\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\u3057\u3066\u3042\u3052\u307e\u3059\u3002\nhttps://\u3010\u3055\u304f\u3089\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\u3011.sakura.ne.jp/LineBot/MessagingBot/callback.php\n\n\n\ndocomo Developer\u767b\u9332\n\u3042\u3068\u5c11\u3057\u3067\u3059...\u3002docomo\u306e\u30aa\u30fc\u30d7\u30f3\u5316\u3057\u3066\u3044\u308b\u4f1a\u8a71API\u3092\u4f7f\u3046\u305f\u3081\u306b\u306f\u3001\u30a2\u30ab\u30a6\u30f3\u30c8\u767b\u9332\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\ndocomo Developer https://dev.smt.docomo.ne.jp/?p=index\n\n\u767b\u9332\u5b8c\u4e86\u5f8c\u3001API Key\u3092\u4f7f\u7528\u3057\u3066\u3001Bot\u304cPOST\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u3053\u308c\u3067\u3042\u3068\u306f\u3001PHP\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u3044\u3066\u3042\u3052\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\n\u30e6\u30fc\u30b6\u30fc\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u5bfe\u3057\u3066\u306e\u8fd4\u4e8b\u3092\u8fd4\u3059\u30d7\u30ed\u30b0\u30e9\u30e0 (PHP)\n\ncallback.php\n<?php\n\n$accessToken = '\u3010Cannel Access Token\u306e\u5024\u3092\u4f7f\u7528\u3059\u308b\u3011';\n\n//\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u53d6\u5f97\n$json_string = file_get_contents('php://input');\n$jsonObj = json_decode($json_string);\n\n$type = $jsonObj->{\"events\"}[0]->{\"message\"}->{\"type\"};\n//\u30e1\u30c3\u30bb\u30fc\u30b8\u53d6\u5f97\n$text = $jsonObj->{\"events\"}[0]->{\"message\"}->{\"text\"};\n//ReplyToken\u53d6\u5f97\n$replyToken = $jsonObj->{\"events\"}[0]->{\"replyToken\"};\n\n//\u30e1\u30c3\u30bb\u30fc\u30b8\u4ee5\u5916\u306e\u3068\u304d\u306f\u4f55\u3082\u8fd4\u3055\u305a\u7d42\u4e86\nif($type != \"text\"){\n    exit;\n}\n\n//docomo\u8fd4\u4fe1\n$response = chat($text);\n\n//\u8fd4\u4fe1\u30c7\u30fc\u30bf\u4f5c\u6210\n$response_format_text = [\n    \"type\" => \"text\",\n    \"text\" => $response\n    ];\n\n$post_data = [\n    \"replyToken\" => $replyToken,\n    \"messages\" => [$response_format_text]\n    ];\n\n$ch = curl_init(\"https://api.line.me/v2/bot/message/reply\");\ncurl_setopt($ch, CURLOPT_POST, true);\ncurl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'POST');\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\ncurl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($post_data));\ncurl_setopt($ch, CURLOPT_HTTPHEADER, array(\n    'Content-Type: application/json; charser=UTF-8',\n    'Authorization: Bearer ' . $accessToken\n    ));\n$result = curl_exec($ch);\ncurl_close($ch);\n\n\n\n//\u30c9\u30b3\u30e2\u306e\u96d1\u8ac7API\u304b\u3089\u96d1\u8ac7\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\nfunction chat($text) {\n    // docomo chatAPI\n    $api_key = '\u3010docomo\u306eAPI Key\u3092\u4f7f\u7528\u3059\u308b\u3011';\n    $api_url = sprintf('https://api.apigw.smt.docomo.ne.jp/dialogue/v1/dialogue?APIKEY=%s', $api_key);\n    $req_body = array('utt' => $text);\n\n    $headers = array(\n        'Content-Type: application/json; charset=UTF-8',\n    );\n    $options = array(\n        'http'=>array(\n            'method'  => 'POST',\n            'header'  => implode(\"\\r\\n\", $headers),\n            'content' => json_encode($req_body),\n            )\n        );\n    $stream = stream_context_create($options);\n    $res = json_decode(file_get_contents($api_url, false, $stream));\n\n    return $res->utt;\n}\n\n\n\u4ee5\u4e0a\u3067\u5b8c\u6210\u3067\u3059\uff01\u3055\u304f\u3089\u306eVPS\u306f\u3059\u3067\u306b\u52d5\u3044\u3066\u3044\u308b\u30b5\u30fc\u30d0\u3067\u3042\u308c\u3070\u3059\u3093\u306a\u308a\u3068\u8a2d\u5b9a\u3067\u304d\u308b\u306e\u3067\u3059\u304c\u3001\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u3057\u305f\u3070\u304b\u308a\u3060\u3068\u8a2d\u5b9a\u304c\u5909\u66f4\u3055\u308c\u308b\u307e\u3067\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u305f\u308a\u307e\u3059\u306e\u3067\u3001\u6ce8\u610f\u304c\u5fc5\u8981\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n9\u6708\u672b\u306bLINE\u304b\u3089\u767a\u8868\u3055\u308c\u305fLINE BOT\u304c\u4f5c\u308c\u308bMessaging API\u3092\u4f7f\u3063\u3066\u3001\u7c21\u6613\u7684\u306a\u4f1a\u8a71\u304c\u3067\u304d\u308bBOT\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n<img width=\"320\" alt=\"S__11231236.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/147291/b69ac5b6-33fb-d596-2073-3af24fbb998d.jpeg\">\n\n\n\u4ee5\u4e0b\u306e\u74b0\u5883\u3092\u7528\u3044\u3066\u52d5\u304b\u3057\u307e\u3059\u3002\n- LINE developer\n- PHP (\u53c2\u8003\u8cc7\u6599\u304c\u591a\u304b\u3063\u305f\u306e\u3067)\n- \u3055\u304f\u3089VPS\n- docomo API\n##LINE developers\u8a2d\u5b9a\n\u3053\u3053\u304c\u4e00\u756a\u9762\u5012\u306a\u4f5c\u696d\u306b\u306a\u308a\u307e\u3059\u3002(\u50d5\u3082\u3053\u3053\u3067\u4e00\u756a\u3064\u307e\u308a\u307e\u3057\u305f...)\n\u307e\u305a\u306f*LINE BUSINESS CENTER*\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3002\n\n- ***LINE BUSINESS CENTER***\n https://business.line.me/ja/\n\n\u300c\u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30b9\u30c8\u300d\u304b\u3089\u300c\u30d3\u30b8\u30cd\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u300d\u3092\u9078\u629e\u3002\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u306b\u3044\u304d\u307e\u3059\u3002\u3053\u3053\u304b\u3089\u300c\u4e00\u822c\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u59cb\u3081\u308b\u300d\u3092\u9078\u629e\u3002\n\u203b\u50d5\u306e\u5834\u5408\u3053\u3053\u3067\u300c\u8a8d\u8a3c\u6e08\u307f\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7533\u3057\u8fbc\u3080\u300d\u3092\u9078\u629e\u3057\u3066\u3057\u307e\u3044\u8a70\u307e\u308a\u307e\u3057\u305f\u3002\u4eca\u56de\u306f\u7121\u6599\u306e\u300c\u4e00\u822c\u30a2\u30ab\u30a6\u30f3\u30c8\u300d\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8-2016-11-05-8.56.28.jpg](https://qiita-image-store.s3.amazonaws.com/0/147291/0d13324f-ecc1-44a1-1c31-e00f6843705b.jpeg)\n\n\n\u305d\u3057\u3066Bot\u306e\u540d\u524d\u3068\u696d\u7a2e\u3092\u9078\u629e\u3057\u3066\u3001\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7533\u3057\u8fbc\u307f\u767b\u9332\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30b9\u30c8\u306b\u3066\u81ea\u5206\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u3067\u304d\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002Messaging API\u3092\u7533\u3057\u8fbc\u307f\u3092\u884c\u3044\u307e\u3059\u3002\u3053\u3053\u304b\u3089\u3001*LINE MANAGER*\u306e\u30da\u30fc\u30b8\u3078\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8-2016-11-05-9.27.15.jpg](https://qiita-image-store.s3.amazonaws.com/0/147291/faa54649-e6d2-e4c7-dd65-965965310701.jpeg)\n\n\n###LINE MANAGER\u8a2d\u5b9a\n\u300c\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a\u300d\u2192\u300cBot\u8a2d\u5b9a\u300d\u3092\u9078\u629e\u3057\u3001\u4ee5\u4e0b\u306e\u753b\u9762\u306e\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\u203b\u300c\u5229\u7528\u53ef\u80fd\u306aAPI\u300d\u304c`REPLY_MESSAGE`\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\u3082\u3057`PUSH_MESSAGE`\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u6709\u6599\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u5fc5\u8981\u306b\u306a\u308b\u305f\u3081\u3001\u7121\u6599\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u306fJSON\u304c\u8fd4\u3063\u3066\u304d\u307e\u305b\u3093\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8-2016-11-05-9.27.15.jpg](https://qiita-image-store.s3.amazonaws.com/0/147291/3e6a36a9-e43c-31b3-099d-fe492f493c27.jpeg)\n\n###LINE deveroper\u8a2d\u5b9a\n\u2460PHP\u3092\u7f6e\u3044\u3066\u3044\u308b\u30b5\u30fc\u30d0\u306eURL\u3092\u8a2d\u5b9a\u3002```\nhttps://\u3010\u3055\u304f\u3089\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\u3011.sakura.ne.jp/LineBot/MessagingBot/callback.php\n```\n\u2461\u30b5\u30fc\u30d0\u306fSSL\u8a8d\u8a3c\u304c\u3042\u308b\u3082\u306e(\u3055\u304f\u3089VPS\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u8a2d\u5b9a\u6e08)\n\u2462`Cannel Access Token`\u306f\u5f8c\u307b\u3069\u4f7f\u3044\u307e\u3059\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8-2016-11-05-9.27.153.jpg](https://qiita-image-store.s3.amazonaws.com/0/147291/a35d0caf-1cad-8df4-5a74-ac38256e186b.jpeg)\n\n\u3053\u308c\u3067LINE\u306e\u8a2d\u5b9a\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n##\u3055\u304f\u3089VPS\n\u3055\u304f\u3089\u306e\u30b5\u30fc\u30d0\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d1\u30cd\u30eb\u304b\u3089\u3001\u30c9\u30e1\u30a4\u30f3\u8a2d\u5b9a\u306e\u30da\u30fc\u30b7\u3092\u958b\u304d\u307e\u3059\u3002\u30b5\u30af\u30e9\u306eVPS\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067SSL\u3092\u5229\u7528\u3067\u304d\u308b\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8-2016-11-05-9.27.154.jpg](https://qiita-image-store.s3.amazonaws.com/0/147291/eeca07ac-96ed-056b-5fac-354e95693156.jpeg)\n\n\u3082\u3057SSL\u306e\u8a2d\u5b9a\u304c\u5229\u7528\u4e2d\u306b\u306a\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u300c\u5909\u66f4\u300d\u304b\u3089\u3001\u5171\u6709SSL\u306e\u8a2d\u5b9a\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308c\u3070OK\uff01\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8-2016-11-05-9.\u3075\u3041\u304827.152.jpg](https://qiita-image-store.s3.amazonaws.com/0/147291/ea99c85d-2abf-bd06-081a-767eb68b7936.jpeg)\n\n##\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\n\u3055\u304f\u3089\u306e\u30d5\u30a1\u30a4\u30eb\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\u3092\u958b\u304d\u307e\u3059\u3002LINE developer\u3067\u8a2d\u5b9a\u3057\u305f\u968e\u5c64\u306b\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\u3057\u3066\u3042\u3052\u307e\u3059\u3002\n\n```\nhttps://\u3010\u3055\u304f\u3089\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\u3011.sakura.ne.jp/LineBot/MessagingBot/callback.php\n```\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8-2016-11-05rdh-9.27.152.jpg](https://qiita-image-store.s3.amazonaws.com/0/147291/2f44b52b-4807-4334-5a03-e86fff862cd2.jpeg)\n\n#docomo Developer\u767b\u9332\n\u3042\u3068\u5c11\u3057\u3067\u3059...\u3002docomo\u306e\u30aa\u30fc\u30d7\u30f3\u5316\u3057\u3066\u3044\u308b\u4f1a\u8a71API\u3092\u4f7f\u3046\u305f\u3081\u306b\u306f\u3001\u30a2\u30ab\u30a6\u30f3\u30c8\u767b\u9332\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n***docomo Developer*** https://dev.smt.docomo.ne.jp/?p=index\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8-2016-11-05\u3075\u3041\u3048r-9.27.152.jpg](https://qiita-image-store.s3.amazonaws.com/0/147291/185b60b9-7b5e-2d21-b77d-84a211c9021e.jpeg)\n\n\u767b\u9332\u5b8c\u4e86\u5f8c\u3001`API Key`\u3092\u4f7f\u7528\u3057\u3066\u3001Bot\u304cPOST\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u3053\u308c\u3067\u3042\u3068\u306f\u3001PHP\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u3044\u3066\u3042\u3052\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n#\u30e6\u30fc\u30b6\u30fc\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u5bfe\u3057\u3066\u306e\u8fd4\u4e8b\u3092\u8fd4\u3059\u30d7\u30ed\u30b0\u30e9\u30e0 (PHP)\n```callback.php\n<?php\n\n$accessToken = '\u3010Cannel Access Token\u306e\u5024\u3092\u4f7f\u7528\u3059\u308b\u3011';\n\n//\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u53d6\u5f97\n$json_string = file_get_contents('php://input');\n$jsonObj = json_decode($json_string);\n\n$type = $jsonObj->{\"events\"}[0]->{\"message\"}->{\"type\"};\n//\u30e1\u30c3\u30bb\u30fc\u30b8\u53d6\u5f97\n$text = $jsonObj->{\"events\"}[0]->{\"message\"}->{\"text\"};\n//ReplyToken\u53d6\u5f97\n$replyToken = $jsonObj->{\"events\"}[0]->{\"replyToken\"};\n\n//\u30e1\u30c3\u30bb\u30fc\u30b8\u4ee5\u5916\u306e\u3068\u304d\u306f\u4f55\u3082\u8fd4\u3055\u305a\u7d42\u4e86\nif($type != \"text\"){\n\texit;\n}\n\n//docomo\u8fd4\u4fe1\n$response = chat($text);\n\n//\u8fd4\u4fe1\u30c7\u30fc\u30bf\u4f5c\u6210\n$response_format_text = [\n\t\"type\" => \"text\",\n\t\"text\" => $response\n\t];\n\t\n$post_data = [\n\t\"replyToken\" => $replyToken,\n\t\"messages\" => [$response_format_text]\n\t];\n\n$ch = curl_init(\"https://api.line.me/v2/bot/message/reply\");\ncurl_setopt($ch, CURLOPT_POST, true);\ncurl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'POST');\ncurl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\ncurl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($post_data));\ncurl_setopt($ch, CURLOPT_HTTPHEADER, array(\n    'Content-Type: application/json; charser=UTF-8',\n    'Authorization: Bearer ' . $accessToken\n    ));\n$result = curl_exec($ch);\ncurl_close($ch);\n\n\n\n//\u30c9\u30b3\u30e2\u306e\u96d1\u8ac7API\u304b\u3089\u96d1\u8ac7\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\nfunction chat($text) {\n    // docomo chatAPI\n    $api_key = '\u3010docomo\u306eAPI Key\u3092\u4f7f\u7528\u3059\u308b\u3011';\n    $api_url = sprintf('https://api.apigw.smt.docomo.ne.jp/dialogue/v1/dialogue?APIKEY=%s', $api_key);\n    $req_body = array('utt' => $text);\n    \n    $headers = array(\n        'Content-Type: application/json; charset=UTF-8',\n    );\n    $options = array(\n        'http'=>array(\n            'method'  => 'POST',\n            'header'  => implode(\"\\r\\n\", $headers),\n            'content' => json_encode($req_body),\n            )\n        );\n    $stream = stream_context_create($options);\n    $res = json_decode(file_get_contents($api_url, false, $stream));\n \n    return $res->utt;\n}\n```\n\u4ee5\u4e0a\u3067\u5b8c\u6210\u3067\u3059\uff01\u3055\u304f\u3089\u306eVPS\u306f\u3059\u3067\u306b\u52d5\u3044\u3066\u3044\u308b\u30b5\u30fc\u30d0\u3067\u3042\u308c\u3070\u3059\u3093\u306a\u308a\u3068\u8a2d\u5b9a\u3067\u304d\u308b\u306e\u3067\u3059\u304c\u3001\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u3057\u305f\u3070\u304b\u308a\u3060\u3068\u8a2d\u5b9a\u304c\u5909\u66f4\u3055\u308c\u308b\u307e\u3067\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u305f\u308a\u307e\u3059\u306e\u3067\u3001\u6ce8\u610f\u304c\u5fc5\u8981\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n", "tags": ["linebot", "LINEmessagingAPI", "PHP", "\u3055\u304f\u3089VPS", "docomoAPI"]}