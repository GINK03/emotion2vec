{"context": "DeepLearning Advent Calendar 12\u670812\u65e5\u306e\u8a18\u4e8b\u3067\u3059\uff0e\n\u601d\u8003\u304c\u6b7b\u3093\u3067\u308b\u306e\u3068Advent Calendar\u66f8\u3044\u3066\u307f\u305f\u304b\u3063\u305f\u304b\u3089\u66f8\u304d\u307e\u3059\uff0e\n\u672c\u8a18\u4e8b\u306fNeural network(NN)\u3092\u7528\u3044\u3066stack1\u69cb\u9020\u3092\u5b9f\u73fe\u3059\u308b\u30e2\u30c7\u30eb\u3092\uff0c\u305d\u306e\u80cc\u666f\u3068\u6982\u8981\u3068\u5171\u306b\u7d39\u4ecb\u3059\u308b\u3082\u306e\u3067\u3059\uff0e\u5177\u4f53\u7684\u306b\u306f\u6b21\u306e\uff12\u3064\u306e\u30e2\u30c7\u30eb\u306e\u8aac\u660e\u3092\u884c\u3044\u307e\u3059\uff0e\n\nInferring Algorithmic Patterns with Stack-Augmented Recurrent Nets\nLearning to Transduce with Unbounded Memory\n\n3\u884c\u3067\n\nNN\u3092\u7528\u3044\u3066stack\u69cb\u9020\u3092\u5b9f\u73fe\u3057\u305f\u30e2\u30c7\u30eb\uff12\u3064\u3092\u7d39\u4ecb\u3059\u308b\uff0e\nchainer\u3092\u7528\u3044\u3066\u5b9f\u88c5\u3057\u305f\u30b3\u30fc\u30c9\u304c\u3042\u308b(\u305f\u3060\u3057copying task)\uff0e\n\u6a21\u5023\u306f\u539f\u59cb\u7684\u306a\u52d5\u6a5f\u3063\u307d\u3044\uff0e\n\n\n\u80cc\u666f\n\nplain\u306aRNN\u3068\u305d\u306e\u9650\u754c\nplain\u306aRecurrent neural network(RNN)\u306f\uff0c\u5185\u90e8\u72b6\u614b\u3068\u5165\u529b$\\mathbf{h}_t,\\mathbf{x}_t$\u306b\u5bfe\u3057\uff0c\u6b21\u306e\u5f0f\u3067\u66f4\u65b0\u3055\u308c\u308b\uff0e\n\\mathbf{h}_{t+1} = f(\\mathbf{A} \\mathbf{h}_t+\\mathbf{U} \\mathbf{x}_t)\n\n\u3053\u306e\u30e2\u30c7\u30eb\u306f\u5e38\u306b\u6d3b\u6027\u5316\u95a2\u6570$f$\u3092\u9069\u5fdc\u3059\u308b\u305f\u3081\u9577\u671f\u7684\u306a\u60c5\u5831\u306e\u8a18\u61b6\u304c\u96e3\u3057\u304b\u3063\u305f2\uff0eLSTM\u306f\u3053\u308c\u3092\u6539\u5584\u3059\u308b\u3053\u3068\u3092\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\u306e\uff11\u3064\u3068\u3057\u3066$\\mathbf{c}_t$\u3068\u3044\u3046\u5185\u90e8\u72b6\u614b\u3092\uff11\u3064\u8ffd\u52a0\u3057\u305f\uff0e\u3053\u306e$\\mathbf{c}_t$\u306f\uff0cgate\u306b\u3088\u308bweighted\u3092\u9664\u3044\u3066\u975e\u7dda\u5f62\u95a2\u6570\u3092\u304b\u3051\u3089\u308c\u306a\u3044\u305f\u3081\uff0c\u60c5\u5831\u304c\u9577\u671f\u7684\u306b\u6b8b\u308b\u3053\u3068\u304c\u671f\u5f85\u3067\u304d\u308b3\n\u3067\u3082\u3082\u3063\u3068\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u3092\u5229\u7528\u3057\u305f\u3044\uff0e\u4e16\u754c\u77e5\u8b58\u3068\u304b\uff0c\u30b3\u30fc\u30d1\u30b9\u5185\u3067\u8ab0\u304c\u3069\u3046\u3057\u305f\u3068\u304b\u7406\u89e3\u3067\u304d\u308b\u306a\u3089\u7d20\u6575\u3060\uff0e\u6216\u3044\u306f\u53e4\u5178\u7684\u306a\u96e2\u6563\u30e2\u30c7\u30eb\u306eNeural implementaiton4\u3092\u3059\u308b\u3068\u3054\u5229\u76ca\u304c\u3042\u308a\u305d\u3046\uff0e\u305d\u3093\u306a\u80cc\u666f\u304c\u3042\u3063\u3066External memory\u7cfb\u3068\u4e00\u90e8\u3067\u547c\u3070\u308c\u308bNeural network\u306eextension\u304c\u7814\u7a76\u306a\u3055\u308c\u3066\u3044\u308b\uff0e\n\nExternal memory\u7cfb\u3068stack\u69cb\u9020\nExternal memory\u3092\u5b9f\u73fe\u3059\u308b\u7814\u7a76\u306f\u305d\u306e\u30e1\u30e2\u30ea\u306e\u69cb\u9020\u306e\u9055\u3044\u304b\u3089\u5927\u304d\u304f\u5206\u3051\u3066\uff12\u3064\u306e\u30af\u30e9\u30b9\u304c\u5b58\u5728\u3059\u308b\uff0e\uff11\u3064\u304cmemory network\u3084neural turing machine\u306a\u3069\u306evector\u304c\u4e26\u3093\u3067\u308b\u3082\u306e\u3067\uff0cgoogle\u304cDifferentiable neural computer\u3084facebook\u306ememory network\u306a\u3069\u6bd4\u8f03\u7684\u77e5\u540d\u5ea6\u304c\u3042\u308a\uff0c\u95a2\u9023\u7814\u7a76\u3082\u5e7e\u3064\u304b\u3042\u308b5\uff0e\u5927\u9678\u306e\u65b9\u3067\u306f\u4eba\u6c17\u3063\u307d\u3044\uff0e\n\u3082\u3046\uff11\u3064\u304c\u4eca\u56de\u7d39\u4ecb\u3059\u308b\u3082\u306e\u3067\uff0cstack\u69cb\u9020\u3092neural implementation\u3059\u308b\u30a2\u30d7\u30ed\u30fc\u30c1\u3092\u53d6\u308b\u3082\u306e\uff0e\u3068\u306f\u3044\u3048\u3053\u306e\u30e2\u30c7\u30eb\u306e\u6570\u306f\u305d\u308c\u307b\u3069\u591a\u304f\u306f\u306a\u3044\uff0e\u4e00\u5fdc\u53e4\u304f(?)\u306f1993\u306b\u6b21\u306e\u8ad6\u6587\u304c\u767b\u5834\u3057\u3066\u3044\u305f\u308a\u3059\u308b\uff0e\u305f\u3060\u5927\u898f\u6a21\u306b\u3053\u306e\u30c6\u30fc\u30de\u3067\u7814\u7a76\u304c\u306a\u3055\u308c\u305f\u3068\u3044\u3046\u3053\u3068\u306f\u306a\u3044\u3088\u3046\u3060\uff0e\nThe Neural Network Pushdown Automaton: Model, Stack and Learning Simulations\n\u305d\u3057\u3066\u8a08\u7b97\u6a5f\u306e\u6027\u80fd\u5411\u4e0a\u3068\u5171\u306b\u6642\u9593\u306f\u9032\u307f\uff0c2015\u5e74\u306b\u6b21\u306e\uff12\u3064\u306e\u8ad6\u6587\u304c\u51fa\u305f\uff0e\nInferring Algorithmic Patterns with Stack-Augmented Recurrent Nets\nLearning to Transduce with Unbounded Memory\n\u305d\u3093\u306a\u80cc\u666f\uff0e\n\n\u30e2\u30c7\u30eb\u7d39\u4ecb\n\nInferring Algorithmic Patterns with Stack-Augmented Recurrent Nets\n\u5165\u529b\u3092$\\mathbf{x}_t$\uff0c\u96a0\u308c\u72b6\u614b\u3092$\\mathbf{h}_t$\uff0c\u51fa\u529b\u3092$\\mathbf{y}_t$\u3068\u3059\u308b\uff0e\nstack $s_t$\u306f\u5404\u30a4\u30f3\u30c7\u30c3\u30af\u30b9$i$\u306b\u30b9\u30ab\u30e9$s_t[i] \\in \\mathcal{R}$\u3092\u30b9\u30c8\u30a2\u3057\u3066\u3044\u308b\uff0c\u307e\u305fstack\u306e\u4e0a\u304b\u3089$k$\u500b\u3092\uff11\u3064\u306e\u30d9\u30af\u30c8\u30eb\u3068\u3057\u3066\u8003\u3048\u305f\u3082\u306e\u3092$\\mathbf{s}_t^k \\in \\mathcal{R}^{k}$\u3068\u8868\u8a18\u3059\u308b\uff0e\n\u4e0a\u8a18\u306e\u5b9a\u7fa9\u306e\u5143\uff0c\u6b21\u306e\u3088\u3046\u306a\u66f4\u65b0\u5f0f\u3092\u7e70\u308a\u8fd4\u3057\u3066\u3044\u304f\uff0e\n\\begin{eqnarray}\n\\mathbf{h}_t\n&=&\\sigma(U\\mathbf{x}_t+R\\mathbf{h}_{t-1}+P\\mathbf{s}^k_{t-1}) \\\\\n\n\\mathbf{y}_t &=& f(V\\mathbf{h}_t)\\\\\n\\mathbf{a}_t &=& Softmax(A\\mathbf{h}_t) \\in \\mathcal{R}^{2}\\\\\n\ns_t[i] &=&\n  \\begin{cases}\n  \\mathbf{a}_t[PUSH] \\sigma(D\\mathbf{h}_t)\n  +\n  \\mathbf{a}_t[POP] s_{t-1}[1] & ( i=0 ) \\\\\n  \\mathbf{a}_t[PUSH] s_{t-1}[i-1]\n  +\n  \\mathbf{a}_t[POP] s_{t-1}[i+1] & (  i\\neq 0 )\n  \\end{cases} \\\\\n\\end{eqnarray}\n\n$\\mathbf{h}_t$\u3068$\\mathbf{y}_t$\u306e\u610f\u5473\u306f\u901a\u5e38\u306eRNN\u3068\u5909\u308f\u3089\u306a\u3044\uff0e\u554f\u984c\u306fstack $s_t$\u306b\u4ed8\u968f\u3059\u308b\u51e6\u7406\u3068\uff0c$\\mathbf{a}_t[POP],\\mathbf{a}_t[PUSH]$\u306e\u610f\u7fa9\u3067\u5f0f\u3092\u773a\u3081\u3066\u308b\u3088\u308a\u56f3\u3092\u898b\u305f\u65b9\u304c\u7406\u89e3\u304c\u65e9\u3044\u3060\u308d\u3046\uff0e\u305d\u306e\u305f\u3081\uff0c\u6b21\u306e\u56f3\u3092\u7528\u3044\u3066\u76f4\u611f\u7684\u306a\u8aac\u660e\u3092\u884c\u30466\uff0e\n\u307e\u305a$t=3$,$s_3=(3,1,2)$\u304b\u3064$\\mathbf{a}_3[POP]=-1$\uff0c$\\mathbf{a}_3[PUSH]=2$\u3067\u3042\u308b\u3068\u3059\u308b\uff0e\u3053\u306e\u6642\uff0c$t=4$\u306e\u30b9\u30bf\u30c3\u30af$s_4$\u306f\n\n\n\n\n$s_3$\n$POP(s_3)$\n$PUSH(s_3)$\n$s_4$\n\n\n\n\n$i=0$\n$3$\n$-1*1=-1$\n$\\sigma(D\\mathbf{h}_3)$\n$-1+\\sigma(D\\mathbf{h}_3)=-1+\\sigma(D\\mathbf{h}_3)$\n\n\n$i=1$\n$1$\n$-1*2=-2$\n$2*3=6$\n$-2+6=4$\n\n\n$i=2$\n$2$\n$0$\n$2*1=2$\n$0+2=2$\n\n\n$i=3$\n\n$0$\n$2*2=4$\n$0+4=4$\n\n\n\n\u3068\u3044\u3046\u98a8\u306b\u8a08\u7b97\u3055\u308c\u308b\uff0e\n\u3053\u306e\u3088\u3046\u306b\uff0c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u5024\u304c1\u3064\u4e0a\u306b\u305a\u308c\u305fstack\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u5024\u304c1\u3064\u4e0b\u306b\u305a\u308c\u305fstack\u3068\u306e\uff0c$\\mathbf{a}_3[POP]$\u3068$\\mathbf{a}_3[PUSH]$\u3092\u7528\u3044\u305fweighted sum\u304c\u6b21\u306e$s_4$\u3068\u306a\u308b\uff0e\u3053\u308c\u306f\u901a\u5e38\u306eStack\u3092POP\u3057\u305f\u72b6\u614b\u3068PUSH\u3057\u305f\u72b6\u614b\u3092\u8db3\u3057\u5408\u308f\u305b\u305f\u5f62\u306b\u306a\u3063\u3066\u3044\u308b\uff0e\n\nvariants and extensions\n\u62e1\u5f35\u3068\u3057\u3066\uff0c\u4e0a\u304c\u308b\u64cd\u4f5c\u3068\u4e0b\u304c\u308b\u64cd\u4f5c\u306ePOP\u3068PUSH\u306b\u52a0\u3048\uff0c\u73fe\u72b6\u7dad\u6301\u306e\u64cd\u4f5cNO-OP\u3092\u52a0\u3048\u305f\u30e2\u30c7\u30eb\u3068\uff0cstack\u3092\u8907\u6570\u7528\u610f\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u5b9f\u8cea\u7684\u306bstack\u306b\u30d9\u30af\u30c8\u30eb\u3092store\u3059\u308b\u30e2\u30c7\u30eb\u306b\u95a2\u3057\u3066\u3082\u8a00\u53ca\u3057\u3066\u3044\u308b\uff0e\n\u307e\u305f\u4e0a\u8a18\u306fstack\u69cb\u9020\u3092\u7528\u3044\u3066\u3044\u308b\u304c\uff0c\u539f\u8ad6\u6587\u306fDoubly-linked lists\u3092\u7528\u3044\u305f\u30d0\u30ea\u30a2\u30f3\u30c8\u3082\u63d0\u6848\u3057\u3066\u3044\u308b\uff0e\u672c\u8a18\u4e8b\u3067\u306f\u8aac\u660e\u3057\u306a\u3044\u304c\uff0c\u8208\u5473\u306e\u3042\u308b\u65b9\u306f\u8aad\u3093\u3067\u307f\u308b\u3068\u697d\u3057\u3044\u3068\u601d\u3046\uff0e\nInferring Algorithmic Patterns with Stack-Augmented Recurrent Nets\n\nLearning to Transduce with Unbounded Memory\n\u5165\u529b\u3092$\\mathbf{x}_t$\uff0c\u51fa\u529b\u3092$\\mathbf{y}_t$\u3068\u3059\u308b7\uff0estack\u306e\u5404\u30a4\u30f3\u30c7\u30c3\u30af\u30b9$i$\u306b\u306f\uff0c\u30d9\u30af\u30c8\u30eb$\\mathbf{V}_t[i] \\in \\mathcal{R}^d$\u3068\u30b9\u30ab\u30e9$s_t \\in \\mathcal{R}$\u304c\u30b9\u30c8\u30a2\u3055\u308c\u3066\u3044\u308b\uff0e\u307e\u305fstack\u3092read\u3057\u305f\u30d9\u30af\u30c8\u30eb\u3092$\\mathbf{r}_{t}\\in \\mathcal{R}^d$\u3068\u3059\u308b\uff0e\n\u307e\u305aRNN\u304c\uff11\u3064\u3042\u308a\uff0c\u5185\u90e8\u72b6\u614b\u306f$\\mathbf{x}_t,\\mathbf{r}_{t-1}$\u3092\u7528\u3044\u3066\u66f4\u65b0\u3055\u308c\u308b\uff0e\u307e\u305f\u66f4\u65b0\u3055\u308c\u305fLSTM\u304b\u3089\u306e\u51fa\u529b\u3092$\\mathbf{o}'_t$\u3068\u3057\uff0c\u3053\u308c\u3089\uff12\u3064\u306e\u64cd\u4f5c\u3092\u307e\u3068\u3081\u3066\u6b21\u306e\u3088\u3046\u306b\u8868\u8a18\u3059\u308b\u3068\u3059\u308b\uff0e\n\\begin{eqnarray}\n\\mathbf{o}'_t\n= RNN(\\mathbf{x}_t,\\mathbf{r}_{t-1})\n\\end{eqnarray}\n\n\u3053\u306eRNN\u306e\u51fa\u529b$\\mathbf{o}'_{t}$\u3092\u6b21\u306e\u5f0f\u306b\u9069\u7528\u3057\uff0cstack\u306e\u66f4\u65b0\u306b\u5fc5\u8981\u306a\u5024\u304c\u8a08\u7b97\u3055\u308c\u308b\uff0e\n\\begin{eqnarray}\nd_t &=& \\sigma(W_d \\mathbf{o}'_t + b_d) \n&,&\nu_t &=& \\sigma(W_u \\mathbf{o}'_t + b_u) \\\\\n\\mathbf{v}_t &=& tanh(W_v \\mathbf{o}'_t+\\mathbf{b}_v)\n&,&\n\\mathbf{y}_t &=& tanh(W_o \\mathbf{o}'_t+\\mathbf{b}_o)\\\\\n\\end{eqnarray}\n\n$\\mathbf{y}_t$\u306f\u901a\u5e38\u306eoutput\u3068\u540c\u3058\u3067\u3042\u308b\uff0e\u305d\u308c\u4ee5\u5916\u306e\u5024\u3092\u7528\u3044\uff0cstack\u3068$\\mathbf{r}_t$\u304c\u66f4\u65b0\u3055\u308c\u308b\uff0e\u305f\u3060\u3057\u898b\u3084\u3059\u3055\u306e\u305f\u3081\u306b$ReLU(x)=max(0,x)$\u3068\u8868\u8a18\u3057\u305f\uff0e\n\\begin{eqnarray}\n\\mathbf{V}_t[i] &=&\n  \\begin{cases}\n    \\mathbf{V}_{t-1}[i] & ( 1 \\leq i \\leq t ) \\\\\n    \\mathbf{v}_t & (  i=t )\n  \\end{cases}\\\\\n\ns_t[i]\n &=&\n  \\begin{cases}\n    ReLU(s_{t-1}[i]-ReLU(u_t-\\sum_{j=i+1}^{t-1} s_{t-1}[j])) & ( i\\leq i \\leq t) \\\\\n    d_t & (  i=t )\n  \\end{cases}\\\\\n\n\\mathbf{r}_t &=&\n\\sum_{i=1}^{t}min(s_t[i],ReLU(1-\\sum_{j=i+1}^{t} s_t[j])) \\mathbf{V}_t[i]\n\\end{eqnarray}\n\n$\\mathbf{V}_t$\u306e\u66f4\u65b0\u306f\uff0c\u7d20\u76f4\u306b\u30d9\u30af\u30c8\u30eb\u3092\u30b9\u30c8\u30a2\u3057\u3066\u3044\u308b\u3060\u3051\u3067\uff0c\u305d\u306e\u307e\u307e\u3060\u3068\u601d\u3046\uff0e\u305f\u3060\u3053\u306e\u305d\u306e\u307e\u307e\u3055\u304csoftmax\u3092\u3068\u3063\u305f\u5024\u304c\u4e57\u7b97\u3055\u308c\u3066\u3044\u304fStack-Augmented Recurrent Nets\u3068\u306f\u9055\u3046\u70b9\u3067\u3082\u3042\u308b\uff0e\u307e\u305f$d_t$\u3082\u4e0a\u306b\u7f6e\u304f\u3060\u3051\u306a\u306e\u3067\uff0c\u3084\u306f\u308a\u305d\u306e\u307e\u307e\u3060\u308d\u3046\uff0e\n\u554f\u984c\u306f\uff0c$s_t$\u3068$\\mathbf{r}_t$\u306e\u66f4\u65b0\u304c\u5c11\u3057\u3084\u3084\u3053\u3057\u3068\u601d\u3046\uff0e\u305f\u3060$\\mathbf{r}_t$\u306f$s_t$\u306e\u66f4\u65b0\u304c\u7406\u89e3\u3067\u304d\u305f\u3089\u7406\u89e3\u51fa\u6765\u308b\u3068\u601d\u3046\u306e\u3067\uff0c$s_t$\u306e\u66f4\u65b0\u3092\u5177\u4f53\u7684\u306a\u4e8b\u4f8b\u3092\u7528\u3044\u3066\u76f4\u611f\u7684\u306b\u8aac\u660e\u3057\u3088\u3046\uff0e6\n\n\n\n$s_3[i]$ \\ $u_3$\n$0$\n$1$\n$2$\n$3$\n$4$\n$5$\n$6$\n\n\n\n\n$s_3[1]=3$\n3\n3\n3\n3\n2\n1\n0\n\n\n$s_3[2]=1$\n1\n1\n1\n0\n0\n0\n0\n\n\n$s_3[3]=2$\n2\n1\n0\n0\n0\n0\n0\n\n\n\n$t=3$,$s_3 = (3,1,2)$\u3068\u3057\uff0c$u_3$\u306e\u5024\u3092\u5909\u3048\u305f\u6642\u306b\u3069\u3046\u3044\u3046\u5024\u304c\u8a08\u7b97\u3055\u308c\u308b\u304b\u3092\u66f8\u3044\u305f\u3082\u306e\u304c\u4e0a\u8a18\u306e\u8868\u3067\u3042\u308b\uff0e\n$u_3$\u306e\u5024\u306e\u5206\u3060\u3051\u4e0b\u304b\u3089$s_3$\u3092\u5f15\u3044\u3066\u3044\u308b\u3053\u3068\u304c\u8aad\u307f\u53d6\u308c\u308b\uff0e\u5177\u4f53\u7684\u306b\u306f\uff0c\u4e0b\u304b\u3089$s_3[i]$\u3092\u8db3\u3057\u5408\u308f\u305b\u305f\u5024\u3068$u_3$\u3092\u6bd4\u8f03\u3057\uff0c\u3082\u3057\u8ca0\u306b\u306a\u308b\u3088\u3046\u306a\u3089$0$\u304c\uff0c\u6b63\u306e\u5024\u306a\u3089\u305d\u306e\u6b8b\u308a\u304c$s_3[i]$\u306b\u306f\u4ee3\u5165\u3055\u308c\u308b\uff0e\u3053\u308c\u306f$s_t$\u304cReLU\u3092\u306f\u3055\u3080\u305f\u3081\u3067\u3042\u308b\uff0e\u307e\u305f$s_t$\u306f\u6e1b\u7b97\u3055\u308c\u308b\u3070\u304b\u308a\u306a\u306e\u3067\uff0c\u4e00\u5ea6$0$\u306b\u306a\u308c\u3070\u4ee5\u964d\u305d\u306e\u5024\u306f\u305a\u3063\u3068$0$\u306e\u307e\u307e\u3067\u3042\u308b\uff0e\u3053\u306e\u6027\u8cea\u3068$\\mathbf{r}_t$\u306e\u66f4\u65b0\u5f0f\u304b\u3089\uff0c$0$\u306b\u306a\u3063\u305f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306f$\\mathbf{r}_t$\u306b\u8db3\u3057\u5408\u308f\u3055\u308c\u308b\u3053\u3068\u306f\u306a\u304f\uff0c\u7d50\u679c\u3068\u3057\u3066stack\u304b\u3089\u6392\u9664\u3055\u308c\u308b\u306e\u3068\u540c\u69d8\u306e\u6319\u52d5\u3092\u793a\u3059\uff0e\n\nvariants and extensions\n\u539f\u8ad6\u6587\u3067\u306fNeural Stack\u3068Neural Queue, Neural Deque\u306e\uff13\u3064\u306evariant\u304c\u63d0\u6848\u3055\u308c\u3066\u3044\u308b\uff0e\u57fa\u672c\u306fNeural Stack\u3068\u4f3c\u305f\u611f\u3058\u3067\uff0c\u3067\u3082Neural implementaiton\u3068\u3057\u3066\u306f\u9762\u767d\u3044\u306e\u3067\u8208\u5473\u3042\u308b\u65b9\u306f\u662f\u975e\uff0e\nLearning to Transduce with Unbounded Memory\n\n\u611f\u60f3\n\nInferring Algorithmic Patterns with Stack-Augmented Recurrent Nets\u306fsoftmax\u306eweighted sum\u3092\u3059\u308b\u305f\u3081\uff0cstack\u306f\u4e57\u7b97\u7684\u306a\u5074\u9762\u3092\u6301\u3064\uff0e\nLearning to Transduce with Unbounded Memory\u306f\u4e0a\u304b\u3089\u4e00\u5b9a\u306e\u5024\u3092\u524a\u308b\u3053\u3068\u3092\u7e70\u308a\u8fd4\u3057\u3066Push and pop\u3059\u308b\u305f\u3081\uff0c\u5f15\u304d\u7b97\u7684\u306a\u6027\u8cea\u3092\u6301\u3064\uff0e\n\n\u3084\u306f\u308a\u8a9e\u308a\u3059\u304e\u305a\u8981\u70b9\u3092\u3061\u3083\u3093\u3068\u66f8\u304f\u3068\u3044\u3046\u306e\u306f\u96e3\u3057\u3044\uff0e\n\u304c\u3093\u3070\u308a\u307e\u3059\uff0e\n\n\u30b3\u30fc\u30c9\nhttps://github.com/takuo-h/NeuralStackModels\nchainer\u3092\u7528\u3044\u305f\u4e0a\u8a18\uff12\u30e2\u30c7\u30eb\u306e\u5b9f\u88c5\uff0etask\u306fcopying\uff0e\nEncoding\u3068Decoding\u304c\u5207\u308a\u66ff\u308f\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u3069\u3046\u4e0e\u3048\u308b\u304b\u304c\u5206\u304b\u3089\u306a\u304b\u3063\u305f\u305f\u3081\uff0c\u901a\u5e38\u306e\u610f\u5473\u3067\u306eEncoder-decoder\u3092\u90e8\u5206\u7684\u306b\u7528\u3044\u3066\u308b\uff0e\n\u901a\u5e38\u306e\u610f\u5473\u3067\u306e\u6a5f\u68b0\u7ffb\u8a33\u3084\u5f37\u5316\u5b66\u7fd2\u3078\u306e\u6539\u5909\u3082\u305d\u3053\u307e\u3067\u96e3\u3057\u304f\u306a\u3044\u6c17\u306f\u3057\u307e\u3059\u304c\uff0c\u5fc5\u8981\u3067\u3042\u308c\u3070\u66f8\u304d\u76f4\u3057\u307e\u3059\uff0e\n\n\u6ce8\u91c8\n\n\n\n\n\u672c\u8a18\u4e8b\u3067\u306fStack\u306e\u5358\u8a9e\u3092NN\u306e\u30ec\u30a4\u30e4\u3092\u7a4d\u307f\u91cd\u306d\u308b\u610f\u5473\u3067\u7528\u3044\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u00a0\u21a9\n\n\nvanishing and exploding gradient\u306b\u95a2\u3057\u3066\u306f\u5272\u611b\u00a0\u21a9\n\n\n\u3053\u306e\u610f\u5473\u3067LSTM\u3068Residual network(Deep Residual Learning for Image Recognition)\u306f\u4f3c\u305f\u6027\u8cea\u3092\u6301\u3064\uff0e\u00a0\u21a9\n\n\nNeural network\u3092\u7528\u3044\u3066\u30e2\u30c7\u30eb\u3092\u5b9f\u73fe\u3057\u3088\u3046\u3068\u3059\u308b\u3053\u3068\u3092\uff0c\u500b\u4eba\u7684\u306b\u3053\u3046\u8aad\u3093\u3067\u3044\u308b\uff0e\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u3067\u3044\u3048\u3070parsing\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u4e00\u7a2e\u3067\u3042\u308bArc-eager\u3068\u304b\u306e\u5b9f\u73fe\u304c\u8003\u3048\u3089\u308c\u308b\uff0e\u00a0\u21a9\n\n\n\u6016\u3044\u304b\u3089\u8aad\u3093\u3067\u306a\u3044\u3051\u3069\uff0cNeural Random-Access Machines\u3084Lie Access Neural Turing Machine\u304c\u305d\u308c\u3089\u3057\u3044\uff0e\u8ab0\u304b\u7d39\u4ecb\u3057\u3066\u4e0b\u3055\u3044\uff0e\u00a0\u21a9\n\n\n\u672c\u6765\u306e\u5f0f\u306fsigmoid\u7b49\u3092\u306f\u3055\u3080\u305f\u3081\u3053\u306e\u3088\u3046\u306a\u5024\u3092\u53d6\u308b\u3053\u3068\u306f\u306a\u304f\uff0c\u3053\u308c\u3089\u306f\u3042\u304f\u307e\u3067\u8aac\u660e\u7528\u306e\u5024\u3067\u3042\u308b\uff0e\u00a0\u21a9\n\n\n\u539f\u8ad6\u6587\u3067\u306e\u8868\u8a18\u306f$i_t$\u3068$\\mathbf{o}_t$\u3067\u3042\u308b\u304c\uff0c\u8868\u8a18\u306e\u7d71\u4e00\u306e\u305f\u3081\u5148\u8ff0\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3059\u308b\u00a0\u21a9\n\n\n\n[DeepLearning Advent Calendar](http://qiita.com/advent-calendar/2016/deeplearning) 12\u670812\u65e5\u306e\u8a18\u4e8b\u3067\u3059\uff0e\n\u601d\u8003\u304c\u6b7b\u3093\u3067\u308b\u306e\u3068Advent Calendar\u66f8\u3044\u3066\u307f\u305f\u304b\u3063\u305f\u304b\u3089\u66f8\u304d\u307e\u3059\uff0e\n\n\u672c\u8a18\u4e8b\u306fNeural network(NN)\u3092\u7528\u3044\u3066stack[^1]\u69cb\u9020\u3092\u5b9f\u73fe\u3059\u308b\u30e2\u30c7\u30eb\u3092\uff0c\u305d\u306e\u80cc\u666f\u3068\u6982\u8981\u3068\u5171\u306b\u7d39\u4ecb\u3059\u308b\u3082\u306e\u3067\u3059\uff0e\u5177\u4f53\u7684\u306b\u306f\u6b21\u306e\uff12\u3064\u306e\u30e2\u30c7\u30eb\u306e\u8aac\u660e\u3092\u884c\u3044\u307e\u3059\uff0e\n\n- [Inferring Algorithmic Patterns with Stack-Augmented Recurrent Nets](https://arxiv.org/abs/1503.01007)\n- [Learning to Transduce with Unbounded Memory](https://arxiv.org/abs/1506.02516)\n\n[^1]: \u672c\u8a18\u4e8b\u3067\u306fStack\u306e\u5358\u8a9e\u3092NN\u306e\u30ec\u30a4\u30e4\u3092\u7a4d\u307f\u91cd\u306d\u308b\u610f\u5473\u3067\u7528\u3044\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\n\n3\u884c\u3067\n\n- NN\u3092\u7528\u3044\u3066stack\u69cb\u9020\u3092\u5b9f\u73fe\u3057\u305f\u30e2\u30c7\u30eb\uff12\u3064\u3092\u7d39\u4ecb\u3059\u308b\uff0e\n- chainer\u3092\u7528\u3044\u3066\u5b9f\u88c5\u3057\u305f\u30b3\u30fc\u30c9\u304c\u3042\u308b(\u305f\u3060\u3057copying task)\uff0e\n- \u6a21\u5023\u306f\u539f\u59cb\u7684\u306a\u52d5\u6a5f\u3063\u307d\u3044\uff0e\n\n#\u80cc\u666f\n\n###plain\u306aRNN\u3068\u305d\u306e\u9650\u754c\n\nplain\u306aRecurrent neural network(RNN)\u306f\uff0c\u5185\u90e8\u72b6\u614b\u3068\u5165\u529b$\\mathbf{h}\\_t,\\mathbf{x}\\_t$\u306b\u5bfe\u3057\uff0c\u6b21\u306e\u5f0f\u3067\u66f4\u65b0\u3055\u308c\u308b\uff0e\n\n```math\n\\mathbf{h}_{t+1} = f(\\mathbf{A} \\mathbf{h}_t+\\mathbf{U} \\mathbf{x}_t)\n```\n\u3053\u306e\u30e2\u30c7\u30eb\u306f\u5e38\u306b\u6d3b\u6027\u5316\u95a2\u6570$f$\u3092\u9069\u5fdc\u3059\u308b\u305f\u3081\u9577\u671f\u7684\u306a\u60c5\u5831\u306e\u8a18\u61b6\u304c\u96e3\u3057\u304b\u3063\u305f[^8]\uff0eLSTM\u306f\u3053\u308c\u3092\u6539\u5584\u3059\u308b\u3053\u3068\u3092\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\u306e\uff11\u3064\u3068\u3057\u3066$\\mathbf{c}\\_t$\u3068\u3044\u3046\u5185\u90e8\u72b6\u614b\u3092\uff11\u3064\u8ffd\u52a0\u3057\u305f\uff0e\u3053\u306e$\\mathbf{c}\\_t$\u306f\uff0cgate\u306b\u3088\u308bweighted\u3092\u9664\u3044\u3066\u975e\u7dda\u5f62\u95a2\u6570\u3092\u304b\u3051\u3089\u308c\u306a\u3044\u305f\u3081\uff0c\u60c5\u5831\u304c\u9577\u671f\u7684\u306b\u6b8b\u308b\u3053\u3068\u304c\u671f\u5f85\u3067\u304d\u308b[^2]\n\n[^8]: vanishing and exploding gradient\u306b\u95a2\u3057\u3066\u306f\u5272\u611b\n[^2]: \u3053\u306e\u610f\u5473\u3067LSTM\u3068Residual network([Deep Residual Learning for Image Recognition](https://arxiv.org/abs/1512.03385))\u306f\u4f3c\u305f\u6027\u8cea\u3092\u6301\u3064\uff0e\n\n\u3067\u3082\u3082\u3063\u3068\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u3092\u5229\u7528\u3057\u305f\u3044\uff0e\u4e16\u754c\u77e5\u8b58\u3068\u304b\uff0c\u30b3\u30fc\u30d1\u30b9\u5185\u3067\u8ab0\u304c\u3069\u3046\u3057\u305f\u3068\u304b\u7406\u89e3\u3067\u304d\u308b\u306a\u3089\u7d20\u6575\u3060\uff0e\u6216\u3044\u306f\u53e4\u5178\u7684\u306a\u96e2\u6563\u30e2\u30c7\u30eb\u306eNeural implementaiton[^3]\u3092\u3059\u308b\u3068\u3054\u5229\u76ca\u304c\u3042\u308a\u305d\u3046\uff0e\u305d\u3093\u306a\u80cc\u666f\u304c\u3042\u3063\u3066External memory\u7cfb\u3068\u4e00\u90e8\u3067\u547c\u3070\u308c\u308bNeural network\u306eextension\u304c\u7814\u7a76\u306a\u3055\u308c\u3066\u3044\u308b\uff0e\n\n[^3]: Neural network\u3092\u7528\u3044\u3066\u30e2\u30c7\u30eb\u3092\u5b9f\u73fe\u3057\u3088\u3046\u3068\u3059\u308b\u3053\u3068\u3092\uff0c\u500b\u4eba\u7684\u306b\u3053\u3046\u8aad\u3093\u3067\u3044\u308b\uff0e\u81ea\u7136\u8a00\u8a9e\u51e6\u7406\u3067\u3044\u3048\u3070parsing\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u4e00\u7a2e\u3067\u3042\u308bArc-eager\u3068\u304b\u306e\u5b9f\u73fe\u304c\u8003\u3048\u3089\u308c\u308b\uff0e\n\n\n###External memory\u7cfb\u3068stack\u69cb\u9020\n\nExternal memory\u3092\u5b9f\u73fe\u3059\u308b\u7814\u7a76\u306f\u305d\u306e\u30e1\u30e2\u30ea\u306e\u69cb\u9020\u306e\u9055\u3044\u304b\u3089\u5927\u304d\u304f\u5206\u3051\u3066\uff12\u3064\u306e\u30af\u30e9\u30b9\u304c\u5b58\u5728\u3059\u308b\uff0e\uff11\u3064\u304cmemory network\u3084neural turing machine\u306a\u3069\u306evector\u304c\u4e26\u3093\u3067\u308b\u3082\u306e\u3067\uff0cgoogle\u304cDifferentiable neural computer\u3084facebook\u306ememory network\u306a\u3069\u6bd4\u8f03\u7684\u77e5\u540d\u5ea6\u304c\u3042\u308a\uff0c\u95a2\u9023\u7814\u7a76\u3082\u5e7e\u3064\u304b\u3042\u308b[^4]\uff0e\u5927\u9678\u306e\u65b9\u3067\u306f\u4eba\u6c17\u3063\u307d\u3044\uff0e\n\n[^4]: \u6016\u3044\u304b\u3089\u8aad\u3093\u3067\u306a\u3044\u3051\u3069\uff0c[Neural Random-Access Machines](https://arxiv.org/abs/1511.06392?)\u3084[Lie Access Neural Turing Machine](https://arxiv.org/abs/1602.08671)\u304c\u305d\u308c\u3089\u3057\u3044\uff0e\u8ab0\u304b\u7d39\u4ecb\u3057\u3066\u4e0b\u3055\u3044\uff0e\n\n\u3082\u3046\uff11\u3064\u304c\u4eca\u56de\u7d39\u4ecb\u3059\u308b\u3082\u306e\u3067\uff0cstack\u69cb\u9020\u3092neural implementation\u3059\u308b\u30a2\u30d7\u30ed\u30fc\u30c1\u3092\u53d6\u308b\u3082\u306e\uff0e\u3068\u306f\u3044\u3048\u3053\u306e\u30e2\u30c7\u30eb\u306e\u6570\u306f\u305d\u308c\u307b\u3069\u591a\u304f\u306f\u306a\u3044\uff0e\u4e00\u5fdc\u53e4\u304f(?)\u306f1993\u306b\u6b21\u306e\u8ad6\u6587\u304c\u767b\u5834\u3057\u3066\u3044\u305f\u308a\u3059\u308b\uff0e\u305f\u3060\u5927\u898f\u6a21\u306b\u3053\u306e\u30c6\u30fc\u30de\u3067\u7814\u7a76\u304c\u306a\u3055\u308c\u305f\u3068\u3044\u3046\u3053\u3068\u306f\u306a\u3044\u3088\u3046\u3060\uff0e\n\n[The Neural Network Pushdown Automaton: Model, Stack and Learning Simulations]\n(https://clgiles.ist.psu.edu/papers/UMD-CS-TR-3118.recurrent.net.pushdown.automata.pdf)\n\n\u305d\u3057\u3066\u8a08\u7b97\u6a5f\u306e\u6027\u80fd\u5411\u4e0a\u3068\u5171\u306b\u6642\u9593\u306f\u9032\u307f\uff0c2015\u5e74\u306b\u6b21\u306e\uff12\u3064\u306e\u8ad6\u6587\u304c\u51fa\u305f\uff0e\n\n[Inferring Algorithmic Patterns with Stack-Augmented Recurrent Nets](https://arxiv.org/abs/1503.01007)\n\n[Learning to Transduce with Unbounded Memory](https://arxiv.org/abs/1506.02516)\n\n\u305d\u3093\u306a\u80cc\u666f\uff0e\n\n\n#\u30e2\u30c7\u30eb\u7d39\u4ecb\n\n\n##Inferring Algorithmic Patterns with Stack-Augmented Recurrent Nets\n\n\u5165\u529b\u3092$\\mathbf{x}\\_t$\uff0c\u96a0\u308c\u72b6\u614b\u3092$\\mathbf{h}\\_t$\uff0c\u51fa\u529b\u3092$\\mathbf{y}\\_t$\u3068\u3059\u308b\uff0e\nstack $s\\_t$\u306f\u5404\u30a4\u30f3\u30c7\u30c3\u30af\u30b9$i$\u306b\u30b9\u30ab\u30e9$s\\_t[i] \\in \\mathcal{R}$\u3092\u30b9\u30c8\u30a2\u3057\u3066\u3044\u308b\uff0c\u307e\u305fstack\u306e\u4e0a\u304b\u3089$k$\u500b\u3092\uff11\u3064\u306e\u30d9\u30af\u30c8\u30eb\u3068\u3057\u3066\u8003\u3048\u305f\u3082\u306e\u3092$\\mathbf{s}\\_t^k \\in \\mathcal{R}^{k}$\u3068\u8868\u8a18\u3059\u308b\uff0e\n\n\u4e0a\u8a18\u306e\u5b9a\u7fa9\u306e\u5143\uff0c\u6b21\u306e\u3088\u3046\u306a\u66f4\u65b0\u5f0f\u3092\u7e70\u308a\u8fd4\u3057\u3066\u3044\u304f\uff0e\n\n```math\n\\begin{eqnarray}\n\\mathbf{h}_t\n&=&\\sigma(U\\mathbf{x}_t+R\\mathbf{h}_{t-1}+P\\mathbf{s}^k_{t-1}) \\\\\n\n\\mathbf{y}_t &=& f(V\\mathbf{h}_t)\\\\\n\\mathbf{a}_t &=& Softmax(A\\mathbf{h}_t) \\in \\mathcal{R}^{2}\\\\\n\ns_t[i] &=&\n  \\begin{cases}\n  \\mathbf{a}_t[PUSH] \\sigma(D\\mathbf{h}_t)\n  +\n  \\mathbf{a}_t[POP] s_{t-1}[1] & ( i=0 ) \\\\\n  \\mathbf{a}_t[PUSH] s_{t-1}[i-1]\n  +\n  \\mathbf{a}_t[POP] s_{t-1}[i+1] & (  i\\neq 0 )\n  \\end{cases} \\\\\n\\end{eqnarray}\n```\n\n$\\mathbf{h}\\_t$\u3068$\\mathbf{y}\\_t$\u306e\u610f\u5473\u306f\u901a\u5e38\u306eRNN\u3068\u5909\u308f\u3089\u306a\u3044\uff0e\u554f\u984c\u306fstack $s\\_t$\u306b\u4ed8\u968f\u3059\u308b\u51e6\u7406\u3068\uff0c$\\mathbf{a}\\_t[POP],\\mathbf{a}\\_t[PUSH]$\u306e\u610f\u7fa9\u3067\u5f0f\u3092\u773a\u3081\u3066\u308b\u3088\u308a\u56f3\u3092\u898b\u305f\u65b9\u304c\u7406\u89e3\u304c\u65e9\u3044\u3060\u308d\u3046\uff0e\u305d\u306e\u305f\u3081\uff0c\u6b21\u306e\u56f3\u3092\u7528\u3044\u3066\u76f4\u611f\u7684\u306a\u8aac\u660e\u3092\u884c\u3046[^7]\uff0e\n\n\u307e\u305a$t=3$,$s\\_3=(3,1,2)$\u304b\u3064$\\mathbf{a}\\_3[POP]=-1$\uff0c$\\mathbf{a}\\_3[PUSH]=2$\u3067\u3042\u308b\u3068\u3059\u308b\uff0e\u3053\u306e\u6642\uff0c$t=4$\u306e\u30b9\u30bf\u30c3\u30af$s\\_4$\u306f\n\n|        |$s\\_3$ |$POP(s\\_3)$|$PUSH(s\\_3)$|$s\\_4$    |\n|:------:|:-----:|:---------:|:----------:|:--------:|\n|$i=0$   |$3$    |$-1*1=-1$  |$\\sigma(D\\mathbf{h}\\_3)$      |$-1+\\sigma(D\\mathbf{h}\\_3)=-1+\\sigma(D\\mathbf{h}\\_3)$ |\n|$i=1$   |$1$    |$-1*2=-2$  |$2*3=6$     |$-2+6=4$   |\n|$i=2$   |$2$    |$0$        |$2*1=2$     |$0+2=2$   |\n|$i=3$   |       |$0$        |$2*2=4$     |$0+4=4$   |\n\n\u3068\u3044\u3046\u98a8\u306b\u8a08\u7b97\u3055\u308c\u308b\uff0e\n\u3053\u306e\u3088\u3046\u306b\uff0c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u5024\u304c1\u3064\u4e0a\u306b\u305a\u308c\u305fstack\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u5024\u304c1\u3064\u4e0b\u306b\u305a\u308c\u305fstack\u3068\u306e\uff0c$\\mathbf{a}\\_3[POP]$\u3068$\\mathbf{a}\\_3[PUSH]$\u3092\u7528\u3044\u305fweighted sum\u304c\u6b21\u306e$s\\_4$\u3068\u306a\u308b\uff0e\u3053\u308c\u306f\u901a\u5e38\u306eStack\u3092POP\u3057\u305f\u72b6\u614b\u3068PUSH\u3057\u305f\u72b6\u614b\u3092\u8db3\u3057\u5408\u308f\u305b\u305f\u5f62\u306b\u306a\u3063\u3066\u3044\u308b\uff0e\n\n\n###variants and extensions\n\n\u62e1\u5f35\u3068\u3057\u3066\uff0c\u4e0a\u304c\u308b\u64cd\u4f5c\u3068\u4e0b\u304c\u308b\u64cd\u4f5c\u306ePOP\u3068PUSH\u306b\u52a0\u3048\uff0c\u73fe\u72b6\u7dad\u6301\u306e\u64cd\u4f5cNO-OP\u3092\u52a0\u3048\u305f\u30e2\u30c7\u30eb\u3068\uff0cstack\u3092\u8907\u6570\u7528\u610f\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u5b9f\u8cea\u7684\u306bstack\u306b\u30d9\u30af\u30c8\u30eb\u3092store\u3059\u308b\u30e2\u30c7\u30eb\u306b\u95a2\u3057\u3066\u3082\u8a00\u53ca\u3057\u3066\u3044\u308b\uff0e\n\n\u307e\u305f\u4e0a\u8a18\u306fstack\u69cb\u9020\u3092\u7528\u3044\u3066\u3044\u308b\u304c\uff0c\u539f\u8ad6\u6587\u306fDoubly-linked lists\u3092\u7528\u3044\u305f\u30d0\u30ea\u30a2\u30f3\u30c8\u3082\u63d0\u6848\u3057\u3066\u3044\u308b\uff0e\u672c\u8a18\u4e8b\u3067\u306f\u8aac\u660e\u3057\u306a\u3044\u304c\uff0c\u8208\u5473\u306e\u3042\u308b\u65b9\u306f\u8aad\u3093\u3067\u307f\u308b\u3068\u697d\u3057\u3044\u3068\u601d\u3046\uff0e\n\n\n\n[Inferring Algorithmic Patterns with Stack-Augmented Recurrent Nets](https://arxiv.org/abs/1503.01007)\n\n\n##Learning to Transduce with Unbounded Memory\n\n\u5165\u529b\u3092$\\mathbf{x}\\_t$\uff0c\u51fa\u529b\u3092$\\mathbf{y}\\_t$\u3068\u3059\u308b[^6]\uff0estack\u306e\u5404\u30a4\u30f3\u30c7\u30c3\u30af\u30b9$i$\u306b\u306f\uff0c\u30d9\u30af\u30c8\u30eb$\\mathbf{V}\\_t[i] \\in \\mathcal{R}^d$\u3068\u30b9\u30ab\u30e9$s\\_t \\in \\mathcal{R}$\u304c\u30b9\u30c8\u30a2\u3055\u308c\u3066\u3044\u308b\uff0e\u307e\u305fstack\u3092read\u3057\u305f\u30d9\u30af\u30c8\u30eb\u3092$\\mathbf{r}_{t}\\in \\mathcal{R}^d$\u3068\u3059\u308b\uff0e\n\n[^6]: \u539f\u8ad6\u6587\u3067\u306e\u8868\u8a18\u306f$i_t$\u3068$\\mathbf{o}_t$\u3067\u3042\u308b\u304c\uff0c\u8868\u8a18\u306e\u7d71\u4e00\u306e\u305f\u3081\u5148\u8ff0\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3059\u308b\n\n\u307e\u305aRNN\u304c\uff11\u3064\u3042\u308a\uff0c\u5185\u90e8\u72b6\u614b\u306f$\\mathbf{x}\\_t,\\mathbf{r}\\_{t-1}$\u3092\u7528\u3044\u3066\u66f4\u65b0\u3055\u308c\u308b\uff0e\u307e\u305f\u66f4\u65b0\u3055\u308c\u305fLSTM\u304b\u3089\u306e\u51fa\u529b\u3092$\\mathbf{o}'\\_t$\u3068\u3057\uff0c\u3053\u308c\u3089\uff12\u3064\u306e\u64cd\u4f5c\u3092\u307e\u3068\u3081\u3066\u6b21\u306e\u3088\u3046\u306b\u8868\u8a18\u3059\u308b\u3068\u3059\u308b\uff0e\n\n```math\n\\begin{eqnarray}\n\\mathbf{o}'_t\n= RNN(\\mathbf{x}_t,\\mathbf{r}_{t-1})\n\\end{eqnarray}\n```\n\n\u3053\u306eRNN\u306e\u51fa\u529b$\\mathbf{o}'\\_{t}$\u3092\u6b21\u306e\u5f0f\u306b\u9069\u7528\u3057\uff0cstack\u306e\u66f4\u65b0\u306b\u5fc5\u8981\u306a\u5024\u304c\u8a08\u7b97\u3055\u308c\u308b\uff0e\n\n```math\n\\begin{eqnarray}\nd_t &=& \\sigma(W_d \\mathbf{o}'_t + b_d) \n&,&\nu_t &=& \\sigma(W_u \\mathbf{o}'_t + b_u) \\\\\n\\mathbf{v}_t &=& tanh(W_v \\mathbf{o}'_t+\\mathbf{b}_v)\n&,&\n\\mathbf{y}_t &=& tanh(W_o \\mathbf{o}'_t+\\mathbf{b}_o)\\\\\n\\end{eqnarray}\n```\n$\\mathbf{y}\\_t$\u306f\u901a\u5e38\u306eoutput\u3068\u540c\u3058\u3067\u3042\u308b\uff0e\u305d\u308c\u4ee5\u5916\u306e\u5024\u3092\u7528\u3044\uff0cstack\u3068$\\mathbf{r}\\_t$\u304c\u66f4\u65b0\u3055\u308c\u308b\uff0e\u305f\u3060\u3057\u898b\u3084\u3059\u3055\u306e\u305f\u3081\u306b$ReLU(x)=max(0,x)$\u3068\u8868\u8a18\u3057\u305f\uff0e\n\n```math\n\\begin{eqnarray}\n\\mathbf{V}_t[i] &=&\n  \\begin{cases}\n    \\mathbf{V}_{t-1}[i] & ( 1 \\leq i \\leq t ) \\\\\n    \\mathbf{v}_t & (  i=t )\n  \\end{cases}\\\\\n\ns_t[i]\n &=&\n  \\begin{cases}\n    ReLU(s_{t-1}[i]-ReLU(u_t-\\sum_{j=i+1}^{t-1} s_{t-1}[j])) & ( i\\leq i \\leq t) \\\\\n    d_t & (  i=t )\n  \\end{cases}\\\\\n\n\\mathbf{r}_t &=&\n\\sum_{i=1}^{t}min(s_t[i],ReLU(1-\\sum_{j=i+1}^{t} s_t[j])) \\mathbf{V}_t[i]\n\\end{eqnarray}\n```\n\n$\\mathbf{V}\\_t$\u306e\u66f4\u65b0\u306f\uff0c\u7d20\u76f4\u306b\u30d9\u30af\u30c8\u30eb\u3092\u30b9\u30c8\u30a2\u3057\u3066\u3044\u308b\u3060\u3051\u3067\uff0c\u305d\u306e\u307e\u307e\u3060\u3068\u601d\u3046\uff0e\u305f\u3060\u3053\u306e\u305d\u306e\u307e\u307e\u3055\u304csoftmax\u3092\u3068\u3063\u305f\u5024\u304c\u4e57\u7b97\u3055\u308c\u3066\u3044\u304fStack-Augmented Recurrent Nets\u3068\u306f\u9055\u3046\u70b9\u3067\u3082\u3042\u308b\uff0e\u307e\u305f$d\\_t$\u3082\u4e0a\u306b\u7f6e\u304f\u3060\u3051\u306a\u306e\u3067\uff0c\u3084\u306f\u308a\u305d\u306e\u307e\u307e\u3060\u308d\u3046\uff0e\n\n\u554f\u984c\u306f\uff0c$s\\_t$\u3068$\\mathbf{r}\\_t$\u306e\u66f4\u65b0\u304c\u5c11\u3057\u3084\u3084\u3053\u3057\u3068\u601d\u3046\uff0e\u305f\u3060$\\mathbf{r}\\_t$\u306f$s\\_t$\u306e\u66f4\u65b0\u304c\u7406\u89e3\u3067\u304d\u305f\u3089\u7406\u89e3\u51fa\u6765\u308b\u3068\u601d\u3046\u306e\u3067\uff0c$s\\_t$\u306e\u66f4\u65b0\u3092\u5177\u4f53\u7684\u306a\u4e8b\u4f8b\u3092\u7528\u3044\u3066\u76f4\u611f\u7684\u306b\u8aac\u660e\u3057\u3088\u3046\uff0e[^7]\n\n|$s\\_3[i]$ \\ $u\\_3$|$0$|$1$|$2$|$3$|$4$|$5$|$6$|\n|:-----------------|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n| $s\\_3[1]=3$      |3  |3  |3  |3  |2  |1  |0  | \n| $s\\_3[2]=1$      |1  |1  |1  |0  |0  |0  |0  |\n| $s\\_3[3]=2$      |2  |1  |0  |0  |0  |0  |0  |\n\n\n$t=3$,$s\\_3 = (3,1,2)$\u3068\u3057\uff0c$u\\_3$\u306e\u5024\u3092\u5909\u3048\u305f\u6642\u306b\u3069\u3046\u3044\u3046\u5024\u304c\u8a08\u7b97\u3055\u308c\u308b\u304b\u3092\u66f8\u3044\u305f\u3082\u306e\u304c\u4e0a\u8a18\u306e\u8868\u3067\u3042\u308b\uff0e\n\n[^7]: \u672c\u6765\u306e\u5f0f\u306fsigmoid\u7b49\u3092\u306f\u3055\u3080\u305f\u3081\u3053\u306e\u3088\u3046\u306a\u5024\u3092\u53d6\u308b\u3053\u3068\u306f\u306a\u304f\uff0c\u3053\u308c\u3089\u306f\u3042\u304f\u307e\u3067\u8aac\u660e\u7528\u306e\u5024\u3067\u3042\u308b\uff0e\n\n\n\n$u\\_3$\u306e\u5024\u306e\u5206\u3060\u3051\u4e0b\u304b\u3089$s\\_3$\u3092\u5f15\u3044\u3066\u3044\u308b\u3053\u3068\u304c\u8aad\u307f\u53d6\u308c\u308b\uff0e\u5177\u4f53\u7684\u306b\u306f\uff0c\u4e0b\u304b\u3089$s\\_3[i]$\u3092\u8db3\u3057\u5408\u308f\u305b\u305f\u5024\u3068$u\\_3$\u3092\u6bd4\u8f03\u3057\uff0c\u3082\u3057\u8ca0\u306b\u306a\u308b\u3088\u3046\u306a\u3089$0$\u304c\uff0c\u6b63\u306e\u5024\u306a\u3089\u305d\u306e\u6b8b\u308a\u304c$s\\_3[i]$\u306b\u306f\u4ee3\u5165\u3055\u308c\u308b\uff0e\u3053\u308c\u306f$s\\_t$\u304cReLU\u3092\u306f\u3055\u3080\u305f\u3081\u3067\u3042\u308b\uff0e\u307e\u305f$s\\_t$\u306f\u6e1b\u7b97\u3055\u308c\u308b\u3070\u304b\u308a\u306a\u306e\u3067\uff0c\u4e00\u5ea6$0$\u306b\u306a\u308c\u3070\u4ee5\u964d\u305d\u306e\u5024\u306f\u305a\u3063\u3068$0$\u306e\u307e\u307e\u3067\u3042\u308b\uff0e\u3053\u306e\u6027\u8cea\u3068$\\mathbf{r}_t$\u306e\u66f4\u65b0\u5f0f\u304b\u3089\uff0c$0$\u306b\u306a\u3063\u305f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306f$\\mathbf{r}\\_t$\u306b\u8db3\u3057\u5408\u308f\u3055\u308c\u308b\u3053\u3068\u306f\u306a\u304f\uff0c\u7d50\u679c\u3068\u3057\u3066stack\u304b\u3089\u6392\u9664\u3055\u308c\u308b\u306e\u3068\u540c\u69d8\u306e\u6319\u52d5\u3092\u793a\u3059\uff0e\n\n\n\n###variants and extensions\n\n\u539f\u8ad6\u6587\u3067\u306fNeural Stack\u3068Neural Queue, Neural Deque\u306e\uff13\u3064\u306evariant\u304c\u63d0\u6848\u3055\u308c\u3066\u3044\u308b\uff0e\u57fa\u672c\u306fNeural Stack\u3068\u4f3c\u305f\u611f\u3058\u3067\uff0c\u3067\u3082Neural implementaiton\u3068\u3057\u3066\u306f\u9762\u767d\u3044\u306e\u3067\u8208\u5473\u3042\u308b\u65b9\u306f\u662f\u975e\uff0e\n\n\n\n[Learning to Transduce with Unbounded Memory](https://arxiv.org/abs/1506.02516)\n\n\n#\u611f\u60f3\n\n- Inferring Algorithmic Patterns with Stack-Augmented Recurrent Nets\u306fsoftmax\u306eweighted sum\u3092\u3059\u308b\u305f\u3081\uff0cstack\u306f\u4e57\u7b97\u7684\u306a\u5074\u9762\u3092\u6301\u3064\uff0e\n\n- Learning to Transduce with Unbounded Memory\u306f\u4e0a\u304b\u3089\u4e00\u5b9a\u306e\u5024\u3092\u524a\u308b\u3053\u3068\u3092\u7e70\u308a\u8fd4\u3057\u3066Push and pop\u3059\u308b\u305f\u3081\uff0c\u5f15\u304d\u7b97\u7684\u306a\u6027\u8cea\u3092\u6301\u3064\uff0e\n\n\u3084\u306f\u308a\u8a9e\u308a\u3059\u304e\u305a\u8981\u70b9\u3092\u3061\u3083\u3093\u3068\u66f8\u304f\u3068\u3044\u3046\u306e\u306f\u96e3\u3057\u3044\uff0e\n\u304c\u3093\u3070\u308a\u307e\u3059\uff0e\n\n\n#\u30b3\u30fc\u30c9\n\nhttps://github.com/takuo-h/NeuralStackModels\n\nchainer\u3092\u7528\u3044\u305f\u4e0a\u8a18\uff12\u30e2\u30c7\u30eb\u306e\u5b9f\u88c5\uff0etask\u306fcopying\uff0e\nEncoding\u3068Decoding\u304c\u5207\u308a\u66ff\u308f\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u3069\u3046\u4e0e\u3048\u308b\u304b\u304c\u5206\u304b\u3089\u306a\u304b\u3063\u305f\u305f\u3081\uff0c\u901a\u5e38\u306e\u610f\u5473\u3067\u306eEncoder-decoder\u3092\u90e8\u5206\u7684\u306b\u7528\u3044\u3066\u308b\uff0e\n\u901a\u5e38\u306e\u610f\u5473\u3067\u306e\u6a5f\u68b0\u7ffb\u8a33\u3084\u5f37\u5316\u5b66\u7fd2\u3078\u306e\u6539\u5909\u3082\u305d\u3053\u307e\u3067\u96e3\u3057\u304f\u306a\u3044\u6c17\u306f\u3057\u307e\u3059\u304c\uff0c\u5fc5\u8981\u3067\u3042\u308c\u3070\u66f8\u304d\u76f4\u3057\u307e\u3059\uff0e\n\n##\u6ce8\u91c8\n", "tags": ["NeuralNetwork", "\u6a5f\u68b0\u5b66\u7fd2", "MachineLearning"]}