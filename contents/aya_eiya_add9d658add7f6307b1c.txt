{"context": " More than 1 year has passed since last update.HTML5\u3092\u4f7f\u7528\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u69d8\u306b\u753b\u50cf\u306e\u5468\u308a\u306b\u4e38\u304f\u56f2\u3046\u3088\u3046\u306a\u30e1\u30fc\u30bf\u30fc\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u4ee5\u4e0b\u30b3\u30fc\u30c9\u3002\n\nmeter_sample.js\n// (c) aya_eiya - 2013\n(function (){\n    this.setMeter = function(_id,_size,imageSrc,_percent){\n    var percent = _percent;\n    var size = _size;\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext(\"2d\");\n    var meterDiv = document.getElementById(_id);\n        meterDiv.appendChild(canvas);\n    var image = new Image();\n    var transparent = \"rgba(0,0,0,0)\";\n    var meterColor = \"rgb(255,128,128)\";\n    var meterWidth = 16;\n    var digs = {0:0,90:Math.PI/2,180:Math.PI,360:Math.PI*2};\n\n    var margin = 0;\n    var setMargin = function(){\n        margin = size * 0.1;\n        canvas.width = size + margin * 2;\n        canvas.height = size + margin * 2;\n    };\n\n    var setFrameOfMeter = function(){\n        context.strokeStyle = meterColor;\n        context.lineWidth = 2;\n        context.beginPath();\n        context.arc(size/2 + margin,size/2 + margin, size/2 - meterWidth,digs[0],digs[360]);\n        context.stroke();\n        context.beginPath();\n        context.arc(size/2 + margin,size/2 + margin, size/2,digs[0],digs[360]);\n        context.stroke();\n    };\n\n    var setMerterValue = function(){\n        context.strokeStyle = meterColor;\n        context.lineWidth = meterWidth;\n        context.beginPath();\n        var lDig = -percent/100 * digs[180] + digs[90];\n        var rDig =  percent/100 * digs[180] + digs[90];\n        context.arc(size/2 + margin,size/2 + margin,size/2 - meterWidth/2, lDig,rDig);\n        context.stroke();\n    };\n\n    var setImageToCercle = function(){\n        var aspect = image.width/image.height;\n        context.strokeStyle = transparent;\n        context.beginPath();\n        context.arc(size/2 + margin,size/2 + margin, size/2 - meterWidth,digs[0],digs[360]);\n        context.stroke();\n        context.save();\n        context.clip();\n        context.drawImage(image,margin,margin,size * aspect,size);\n        context.restore();\n    };\n\n    var setTextArea = function(){\n        var fontSize = size * 0.18;\n        context.font = fontSize + \"px Arial\";\n        var text = percent+\"%\";\n        var textSize = context.measureText(text);\n        var textLeft = size * 0.9;\n        context.strokeStyle = meterColor;\n        context.fillStyle = \"white\";\n        context.lineWidth = 4;\n        context.beginPath();\n        context.save();\n        context.arc(textLeft,size - fontSize/2,textSize.width/2+5,0,digs[360]);\n        context.fill();\n        context.stroke();\n        context.clip();\n        context.beginPath();\n        context.fillStyle = \"black\";\n        context.fillText(text,textLeft-textSize.width/2,size-fontSize/8);\n        context.restore();\n    };\n\n    var ready = false;\n\n    var setUp = function(){\n        setMargin();\n        setImageToCercle();\n        setFrameOfMeter();\n        setMerterValue();\n        setTextArea();\n        ready = true;\n    };\n\n    image.onload = setUp;\n    var setImage = function(imageSrc){\n        ready = false;\n        image.src = imageSrc;\n    };\n    var setPercentage = function(_percent){\n        percent = _percent;\n        if(ready) setUp();\n    };\n\n    var setSize = function(_size){\n        console.log(_size);\n        size = _size;\n        if(ready) setUp();\n    };\n\n    setImage(imageSrc);\n\n    return {setSize:setSize,setImage:setImage,setPercentage:setPercentage};\n    };\n})();\n\n\n\nmeter_sample.html\n<html>\n<head>\n<title>\u30b5\u30f3\u30d7\u30eb</title>\n<script src=\"./meter.js\"></script>\n</head>\n<body>\n<p>180px\u304f\u3089\u3044\u306e\u5927\u304d\u3055\u306780%\u306e\u30e1\u30fc\u30bf\u30fc\u3092\u8868\u793a\u3059\u308b\u3002</p>\n<div id=\"meter\"></div>\n<script>\n    var _id = 'meter';\n    var size = 180;\n    var percent = 80;\n    var imageSrc = 'https://www.dropbox.com/s/0o3qka5gh2fg5hq/Geesugitan_face.png?dl=1';\n    setMeter(_id,size,imageSrc,percent);\n</script>\n</body>\n</html>\n\n\nGitHub\u306b\u4f7f\u7528\u4f8b\u3092\u4e0a\u3052\u307e\u3057\u305f\u3002\nhttps://github.com/aya-eiya/html5meter_sample\n\nHTML5\u3092\u4f7f\u7528\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u69d8\u306b\u753b\u50cf\u306e\u5468\u308a\u306b\u4e38\u304f\u56f2\u3046\u3088\u3046\u306a\u30e1\u30fc\u30bf\u30fc\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n![image](https://www.dropbox.com/s/svyxjpsqct1uzvs/meter_image.png?dl=1)\n\n\u4ee5\u4e0b\u30b3\u30fc\u30c9\u3002\n\n```JavaScript:meter_sample.js\n// (c) aya_eiya - 2013\n(function (){\n    this.setMeter = function(_id,_size,imageSrc,_percent){\n    var percent = _percent;\n    var size = _size;\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext(\"2d\");\n    var meterDiv = document.getElementById(_id);\n        meterDiv.appendChild(canvas);\n    var image = new Image();\n    var transparent = \"rgba(0,0,0,0)\";\n    var meterColor = \"rgb(255,128,128)\";\n    var meterWidth = 16;\n    var digs = {0:0,90:Math.PI/2,180:Math.PI,360:Math.PI*2};\n\n    var margin = 0;\n    var setMargin = function(){\n        margin = size * 0.1;\n        canvas.width = size + margin * 2;\n        canvas.height = size + margin * 2;\n    };\n\n    var setFrameOfMeter = function(){\n        context.strokeStyle = meterColor;\n        context.lineWidth = 2;\n        context.beginPath();\n        context.arc(size/2 + margin,size/2 + margin, size/2 - meterWidth,digs[0],digs[360]);\n        context.stroke();\n        context.beginPath();\n        context.arc(size/2 + margin,size/2 + margin, size/2,digs[0],digs[360]);\n        context.stroke();\n    };\n\n    var setMerterValue = function(){\n        context.strokeStyle = meterColor;\n        context.lineWidth = meterWidth;\n        context.beginPath();\n        var lDig = -percent/100 * digs[180] + digs[90];\n        var rDig =  percent/100 * digs[180] + digs[90];\n        context.arc(size/2 + margin,size/2 + margin,size/2 - meterWidth/2, lDig,rDig);\n        context.stroke();\n    };\n\n    var setImageToCercle = function(){\n        var aspect = image.width/image.height;\n        context.strokeStyle = transparent;\n        context.beginPath();\n        context.arc(size/2 + margin,size/2 + margin, size/2 - meterWidth,digs[0],digs[360]);\n        context.stroke();\n        context.save();\n        context.clip();\n        context.drawImage(image,margin,margin,size * aspect,size);\n        context.restore();\n    };\n\n    var setTextArea = function(){\n        var fontSize = size * 0.18;\n        context.font = fontSize + \"px Arial\";\n        var text = percent+\"%\";\n        var textSize = context.measureText(text);\n        var textLeft = size * 0.9;\n        context.strokeStyle = meterColor;\n        context.fillStyle = \"white\";\n        context.lineWidth = 4;\n        context.beginPath();\n        context.save();\n        context.arc(textLeft,size - fontSize/2,textSize.width/2+5,0,digs[360]);\n        context.fill();\n        context.stroke();\n        context.clip();\n        context.beginPath();\n        context.fillStyle = \"black\";\n        context.fillText(text,textLeft-textSize.width/2,size-fontSize/8);\n        context.restore();\n    };\n\n    var ready = false;\n\n    var setUp = function(){\n        setMargin();\n        setImageToCercle();\n        setFrameOfMeter();\n        setMerterValue();\n        setTextArea();\n        ready = true;\n    };\n\n    image.onload = setUp;\n    var setImage = function(imageSrc){\n        ready = false;\n        image.src = imageSrc;\n    };\n    var setPercentage = function(_percent){\n        percent = _percent;\n        if(ready) setUp();\n    };\n\n    var setSize = function(_size){\n        console.log(_size);\n        size = _size;\n        if(ready) setUp();\n    };\n\n    setImage(imageSrc);\n\n    return {setSize:setSize,setImage:setImage,setPercentage:setPercentage};\n    };\n})();\n```\n\n```HTML:meter_sample.html\n<html>\n<head>\n<title>\u30b5\u30f3\u30d7\u30eb</title>\n<script src=\"./meter.js\"></script>\n</head>\n<body>\n<p>180px\u304f\u3089\u3044\u306e\u5927\u304d\u3055\u306780%\u306e\u30e1\u30fc\u30bf\u30fc\u3092\u8868\u793a\u3059\u308b\u3002</p>\n<div id=\"meter\"></div>\n<script>\n    var _id = 'meter';\n    var size = 180;\n    var percent = 80;\n    var imageSrc = 'https://www.dropbox.com/s/0o3qka5gh2fg5hq/Geesugitan_face.png?dl=1';\n    setMeter(_id,size,imageSrc,percent);\n</script>\n</body>\n</html>\n```\n\nGitHub\u306b\u4f7f\u7528\u4f8b\u3092\u4e0a\u3052\u307e\u3057\u305f\u3002\nhttps://github.com/aya-eiya/html5meter_sample\n", "tags": ["HTML5", "JavaScript", "canvas"]}