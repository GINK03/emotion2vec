{"context": " More than 1 year has passed since last update.\n\nUnity5 Hierarchy\u306bC#\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u30a8\u30c7\u30a3\u30bf\u30fc\u62e1\u5f35\n\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\nCustomHierarchy.cs\nusing UnityEngine;\nusing UnityEditor;\n\n[InitializeOnLoad]\npublic static class CustomHierarchy\n{\n    static EventType event_last;\n    static MonoScript[] mss;\n\n    static CustomHierarchy()\n    {\n        mss = Resources.FindObjectsOfTypeAll<MonoScript>();\n        EditorApplication.hierarchyWindowItemOnGUI += OnGUI;\n    }\n\n    private static void OnGUI(int instanceID, Rect selectionRect)\n    {\n        var evt = Event.current;\n\n        if (evt.type != event_last)\n        { \n            switch (evt.type)\n            {\n                case EventType.DragExited:\n                    OnHierarchyDragExit();\n                    break;\n            }\n        }\n        event_last = evt.type;\n    }\n\n    private static void OnHierarchyDragExit()\n    {\n        Object obj = UnityEditor.Selection.activeObject;\n        System.Type type = (obj == null) ? null : obj.GetType();\n        string path = AssetDatabase.GetAssetPath(obj);\n        string name;\n\n        {\n            string[] array = path.Split('/');\n            name = array[array.Length - 1];\n            name = name.Split('.')[0];\n\n            Debug.Log(string.Format(\"\u30c9\u30e9\u30c3\u30b0 : {0} ({1})\",name,type));\n        }\n\n        if (type == typeof(MonoScript))\n        {\n            foreach (MonoScript ms in mss)\n            {\n                var cls = ms.GetClass();\n\n                if (cls != null && cls.Name == name)\n                {\n                    GameObject go = new GameObject();\n                    go.name = name;\n\n                    //if(go.AddComponent(name) == null)  //Unity4\u306a\u3089\u3053\u3063\u3061\n                    if (UnityEngineInternal.APIUpdaterRuntimeServices.AddComponent(go, \"Assets/CustomHierarchy.cs (57,24)\", name) == null)\n                    {\n                        GameObject.DestroyImmediate(go);\n                    }\n                    AssetDatabase.Refresh();\n                }\n            }\n\n        }\n    }\n\n}\n\n\n#Unity5 Hierarchy\u306bC#\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u30a8\u30c7\u30a3\u30bf\u30fc\u62e1\u5f35\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/44288/19dc3f36-30be-b17d-28a1-37a4dd8d52a0.png)\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/44288/f4403612-51c2-ba9f-9db9-a8795e4297c7.png)\n\n\n##\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n```  CustomHierarchy.cs\nusing UnityEngine;\nusing UnityEditor;\n\n[InitializeOnLoad]\npublic static class CustomHierarchy\n{\n    static EventType event_last;\n    static MonoScript[] mss;\n\n    static CustomHierarchy()\n    {\n        mss = Resources.FindObjectsOfTypeAll<MonoScript>();\n        EditorApplication.hierarchyWindowItemOnGUI += OnGUI;\n    }\n\n    private static void OnGUI(int instanceID, Rect selectionRect)\n    {\n        var evt = Event.current;\n\n        if (evt.type != event_last)\n        { \n            switch (evt.type)\n            {\n                case EventType.DragExited:\n                    OnHierarchyDragExit();\n                    break;\n            }\n        }\n        event_last = evt.type;\n    }\n\n    private static void OnHierarchyDragExit()\n    {\n        Object obj = UnityEditor.Selection.activeObject;\n        System.Type type = (obj == null) ? null : obj.GetType();\n        string path = AssetDatabase.GetAssetPath(obj);\n        string name;\n\n        {\n            string[] array = path.Split('/');\n            name = array[array.Length - 1];\n            name = name.Split('.')[0];\n\n            Debug.Log(string.Format(\"\u30c9\u30e9\u30c3\u30b0 : {0} ({1})\",name,type));\n        }\n\n        if (type == typeof(MonoScript))\n        {\n            foreach (MonoScript ms in mss)\n            {\n                var cls = ms.GetClass();\n               \n                if (cls != null && cls.Name == name)\n                {\n                    GameObject go = new GameObject();\n                    go.name = name;\n\n                    //if(go.AddComponent(name) == null)  //Unity4\u306a\u3089\u3053\u3063\u3061\n                    if (UnityEngineInternal.APIUpdaterRuntimeServices.AddComponent(go, \"Assets/CustomHierarchy.cs (57,24)\", name) == null)\n                    {\n                        GameObject.DestroyImmediate(go);\n                    }\n                    AssetDatabase.Refresh();\n                }\n            }\n\n        }\n    }\n\n}\n``` \n", "tags": ["Unity", "\u30a8\u30c7\u30a3\u30bf\u30fc\u62e1\u5f35", "Unity\u62e1\u5f35", "UnityEditor"]}