{"context": "\u30e1\u30fc\u30e9\u3092OUTLOOK\u3078\u7d71\u4e00\u3059\u308b\u3068\u306e\u304a\u9054\u3057\u304c\u51fa\u305f\u306e\u3067\u3001\u4eca\u307e\u3067\u306e\u30e1\u30fc\u30eb\u3092OUTLOOK\u3078\u79fb\u884c\u3057\u307e\u3057\u305f\nMozilla Thunderbird \u304b\u3089\uff11\u30e1\u30fc\u30eb\u3001\uff11\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066 EML\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u5927\u91cf\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\n\u3053\u308c\u3092OUTLOOK\u3078\u5165\u308c\u308b\u65b9\u6cd5\u3092\u63a2\u3057\u3066\u3044\u305f\u3068\u3053\u308d\u3001\u3088\u3044\u30b5\u30f3\u30d7\u30eb\u3092\u767a\u898b\uff01\uff01\nOutlook \u3067\u30d5\u30a9\u30eb\u30c0\u30fc\u306b\u542b\u307e\u308c\u308b\u591a\u6570\u306e EML \u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u62ec\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u65b9\u6cd5\n\u3053\u3061\u3089\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u6539\u9020\u3057\u3066\u3001\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u307e\u3067\u5bfe\u5fdc\u3059\u308b\u3088\u3046\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\n\nEML-Import.vbs\n'// eml \u30d5\u30a1\u30a4\u30eb\u3092 OUTLOOK \u306b\u53d6\u308a\u8fbc\u3080\u30b9\u30af\u30ea\u30d7\u30c8\n'//\n'// \u4ed5\u69d8\uff1a\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u3044\u3066\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b .eml \u30d5\u30a1\u30a4\u30eb\u3092\u5bfe\u8c61\n'//       \u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e .eml \u3082\u5bfe\u8c61\u3068\u3059\u308b\n'//       OUTLOOK \u306e\u300c\u53d7\u4fe1\u30c8\u30ec\u30a4\u300d\u306e\u30d5\u30a9\u30eb\u30c0\u300c\u30a4\u30f3\u30dd\u30fc\u30c8\u300d\u306b\u53d6\u308a\u8fbc\u3080\n'//       \u53d6\u308a\u8fbc\u3093\u3060 .eml \u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664\u3059\u308b\n'//       \u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u304b\u3089\u5b9f\u884c\u3057\u305f\u5834\u5408\u306f\u9032\u6357\u72b6\u6cc1\u3092\u8868\u793a\u3059\u308b\n'//\n'// \u5b9f\u884c\u65b9\u6cd5\uff1a\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3001\u307e\u305f\u306f\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u304b\u3089\n'//           > cscript \u30b9\u30af\u30ea\u30d7\u30c8\u540d.vbs  \u3067\u5b9f\u884c\n'//\n\n\n'//===================================================================\n'// FileSystemObject\nConst ForReading = 1    '// \u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u53d6\u308a\u5c02\u7528\u3068\u3057\u3066\u958b\u304d\u307e\u3059\u3002\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u66f8\u304d\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\nConst ForWriting = 2    '// \u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u307f\u5c02\u7528\u3068\u3057\u3066\u958b\u304d\u307e\u3059\u3002\nConst ForAppending = 8  '//\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5f8c\u306b\u8ffd\u52a0\u3057\u3066\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\n\n\n'//===================================================================\n'// \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6e96\u5099\nDim FSO\nSet FSO = WScript.CreateObject(\"Scripting.FileSystemObject\")\n\nDim WSH\nSet WSH = WScript.CreateObject(\"WScript.Shell\")\n\nDim OutlookApp \nSet OutlookApp = WScript.CreateObject(\"Outlook.Application\") \n\n\n'//===================================================================\n'// OUTLOOK\u5074\u30a4\u30f3\u30dd\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u8a2d\u5b9a\nConst olFolderInbox = 6 \nDim fldImport \nSet fldImport = OutlookApp.Session.GetDefaultFolder(olFolderInbox) \nSet fldImport = fldImport.Folders(\"\u30a4\u30f3\u30dd\u30fc\u30c8\")\nfldImport.Display \n\n\n'//===================================================================\n'// \u30ed\u30b0\u6e96\u5099 - \u30ed\u30b0\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u540c\u3058\u5834\u6240\u306b\u4f5c\u6210\n'//          - \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u540d\u306f \u30b9\u30af\u30ea\u30d7\u30c8\u540d_\u5e74\u6708\u65e5.log\nDim oLog, fn\nfn = FSO.getParentFolderName(WScript.ScriptFullName) & \"\\\" & _\n     FSO.GetBaseName(WScript.ScriptFullName) & \"_\" & _\n     Replace(Left(Now(),10), \"/\", \"\") & \".log\"\nIf FSO.FileExists(fn) = False then\n    Set oLog = FSO.CreateTextFile(fn)\nElse\n    Set oLog = FSO.OpenTextFile(fn, ForAppending, True)\nEnd If\n\n\n'//===================================================================\n'// \u958b\u59cb\nlog \"START:\" & FSO.GetFolder(\".\").Name\nCall LoopFolder( FSO.GetFolder(\".\") )\n\n\n'//===================================================================\n'// \u7d42\u4e86\nOutlookApp.ActiveExplorer.Close \nlog \"\u30a4\u30f3\u30dd\u30fc\u30c8\u306f\u7d42\u4e86\u3057\u307e\u3057\u305f\u3002\"\noLog.Close\nSet oLog = Nothing\n\n\n'//===================================================================\n'// eml\u30d5\u30a1\u30a4\u30eb\u53d6\u308a\u8fbc\u307f\uff08\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u3082\u5bfe\u8c61\uff09\nSub LoopFolder(objFolder)\n    Dim objSubFolder\n    Dim objFile\n\n    log \"LOOP: \" & objFolder\n\n    '// \u30d5\u30a1\u30a4\u30eb\u3092\u767b\u9332\n    For Each objFile In objFolder.files\n        '// \u62e1\u5f35\u5b50\u304c .eml \u306a\u3089\u30a4\u30f3\u30dd\u30fc\u30c8\u51e6\u7406\n        If LCase(Right(objFile.Name,4)) = \".eml\" Then\n           OpenEml objFile \n        End If \n    Next\n\n    '// \u30d5\u30a9\u30eb\u30c0\u304c\u3042\u308c\u3070\u518d\u5e30\n    For Each objSubFolder In objFolder.SubFolders\n        LoopFolder objSubFolder\n    Next\nEnd Sub\n\n\n'//===================================================================\n'// eml \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u30a4\u30f3\u30dd\u30fc\u30c8\nSub OpenEml( emlFile ) \n    '// \u30a8\u30e9\u30fc\u7121\u8996\n    On Error Resume Next \n    log  \"OPEN EML: \" & emlFile.Name\n\n    '// \u30e1\u30fc\u30eb\u304c\u958b\u3044\u3066\u3044\u305f\u3089\u9589\u3058\u308b \n    While Not OutlookApp.ActiveInspector Is Nothing \n        OutlookApp.ActiveInspector.Close \n        WScript.Sleep 500 \n    Wend \n\n    '// eml \u30d5\u30a1\u30a4\u30eb\u3092 Outlook \u3067\u958b\u304f\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c \n    WSH.Run \"outlook /eml \"\"\" & FSO.getParentFolderName(emlFile) & _\n        \"\\\" & emlFile.Name & \"\"\"\" \n\n    '// Outlook \u8d77\u52d5\u5f85\u3061 \n    While OutlookApp.ActiveInspector Is Nothing \n        WScript.Sleep 500 \n    Wend \n\n    '// \u30e1\u30fc\u30eb\u30d5\u30a9\u30eb\u30c0\u79fb\u52d5 \n    OutlookApp.ActiveInspector.CurrentItem.Move fldImport \n\n    '// \u53d6\u308a\u8fbc\u3093\u3060\u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664(\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3044\u306a\u3051\u308c\u3070\uff09\n    If Err.Number = 0 Then\n        emlFile.Delete\n    End If\nEnd Sub \n\n\n'//===================================================================\n'// \u30ed\u30b0\u51fa\u529b\nSub log(strMsg)\n    '// \u30a8\u30e9\u30fc\u7121\u8996\n    On Error Resume Next\n\n    '// \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\n    oLog.WriteLine(Now() & \" \" & strMsg)\n\n    '// CSCRIPT \u306a\u3089 ECHO\u3067\u8868\u793a\n    If LCase(Right(WScript.FullName, Len(\"cscript.exe\"))) = \"cscript.exe\" Then\n        WScript.Echo Now() & \" \" & strMsg\n    End If\nEnd Sub\n\n\n\n\u30e1\u30fc\u30e9\u3092OUTLOOK\u3078\u7d71\u4e00\u3059\u308b\u3068\u306e\u304a\u9054\u3057\u304c\u51fa\u305f\u306e\u3067\u3001\u4eca\u307e\u3067\u306e\u30e1\u30fc\u30eb\u3092OUTLOOK\u3078\u79fb\u884c\u3057\u307e\u3057\u305f\n\nMozilla Thunderbird \u304b\u3089\uff11\u30e1\u30fc\u30eb\u3001\uff11\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066 EML\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u5927\u91cf\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\n\u3053\u308c\u3092OUTLOOK\u3078\u5165\u308c\u308b\u65b9\u6cd5\u3092\u63a2\u3057\u3066\u3044\u305f\u3068\u3053\u308d\u3001\u3088\u3044\u30b5\u30f3\u30d7\u30eb\u3092\u767a\u898b\uff01\uff01\n\n[Outlook \u3067\u30d5\u30a9\u30eb\u30c0\u30fc\u306b\u542b\u307e\u308c\u308b\u591a\u6570\u306e EML \u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u62ec\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u65b9\u6cd5](https://outlooklab.wordpress.com/2014/12/27/outlook-%E3%81%A7%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E3%83%BC%E3%81%AB%E5%90%AB%E3%81%BE%E3%82%8C%E3%82%8B%E5%A4%9A%E6%95%B0%E3%81%AE-eml-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E4%B8%80/)\n\n\n\u3053\u3061\u3089\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u6539\u9020\u3057\u3066\u3001\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u307e\u3067\u5bfe\u5fdc\u3059\u308b\u3088\u3046\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\n\n\n```EML-Import.vbs\n'// eml \u30d5\u30a1\u30a4\u30eb\u3092 OUTLOOK \u306b\u53d6\u308a\u8fbc\u3080\u30b9\u30af\u30ea\u30d7\u30c8\n'//\n'// \u4ed5\u69d8\uff1a\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u3044\u3066\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b .eml \u30d5\u30a1\u30a4\u30eb\u3092\u5bfe\u8c61\n'//       \u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e .eml \u3082\u5bfe\u8c61\u3068\u3059\u308b\n'//       OUTLOOK \u306e\u300c\u53d7\u4fe1\u30c8\u30ec\u30a4\u300d\u306e\u30d5\u30a9\u30eb\u30c0\u300c\u30a4\u30f3\u30dd\u30fc\u30c8\u300d\u306b\u53d6\u308a\u8fbc\u3080\n'//       \u53d6\u308a\u8fbc\u3093\u3060 .eml \u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664\u3059\u308b\n'//       \u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u304b\u3089\u5b9f\u884c\u3057\u305f\u5834\u5408\u306f\u9032\u6357\u72b6\u6cc1\u3092\u8868\u793a\u3059\u308b\n'//\n'// \u5b9f\u884c\u65b9\u6cd5\uff1a\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3001\u307e\u305f\u306f\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u304b\u3089\n'//           > cscript \u30b9\u30af\u30ea\u30d7\u30c8\u540d.vbs  \u3067\u5b9f\u884c\n'//\n\n\n'//===================================================================\n'// FileSystemObject\nConst ForReading = 1    '// \u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u53d6\u308a\u5c02\u7528\u3068\u3057\u3066\u958b\u304d\u307e\u3059\u3002\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u66f8\u304d\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\nConst ForWriting = 2    '// \u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u8fbc\u307f\u5c02\u7528\u3068\u3057\u3066\u958b\u304d\u307e\u3059\u3002\nConst ForAppending = 8  '//\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5f8c\u306b\u8ffd\u52a0\u3057\u3066\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\n\n\n'//===================================================================\n'// \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6e96\u5099\nDim FSO\nSet FSO = WScript.CreateObject(\"Scripting.FileSystemObject\")\n\nDim WSH\nSet WSH = WScript.CreateObject(\"WScript.Shell\")\n\nDim OutlookApp \nSet OutlookApp = WScript.CreateObject(\"Outlook.Application\") \n\n\n'//===================================================================\n'// OUTLOOK\u5074\u30a4\u30f3\u30dd\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u8a2d\u5b9a\nConst olFolderInbox = 6 \nDim fldImport \nSet fldImport = OutlookApp.Session.GetDefaultFolder(olFolderInbox) \nSet fldImport = fldImport.Folders(\"\u30a4\u30f3\u30dd\u30fc\u30c8\")\nfldImport.Display \n\n\n'//===================================================================\n'// \u30ed\u30b0\u6e96\u5099 - \u30ed\u30b0\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u540c\u3058\u5834\u6240\u306b\u4f5c\u6210\n'//          - \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u540d\u306f \u30b9\u30af\u30ea\u30d7\u30c8\u540d_\u5e74\u6708\u65e5.log\nDim oLog, fn\nfn = FSO.getParentFolderName(WScript.ScriptFullName) & \"\\\" & _\n     FSO.GetBaseName(WScript.ScriptFullName) & \"_\" & _\n     Replace(Left(Now(),10), \"/\", \"\") & \".log\"\nIf FSO.FileExists(fn) = False then\n    Set oLog = FSO.CreateTextFile(fn)\nElse\n    Set oLog = FSO.OpenTextFile(fn, ForAppending, True)\nEnd If\n\n\n'//===================================================================\n'// \u958b\u59cb\nlog \"START:\" & FSO.GetFolder(\".\").Name\nCall LoopFolder( FSO.GetFolder(\".\") )\n\n\n'//===================================================================\n'// \u7d42\u4e86\nOutlookApp.ActiveExplorer.Close \nlog \"\u30a4\u30f3\u30dd\u30fc\u30c8\u306f\u7d42\u4e86\u3057\u307e\u3057\u305f\u3002\"\noLog.Close\nSet oLog = Nothing\n\n\n'//===================================================================\n'// eml\u30d5\u30a1\u30a4\u30eb\u53d6\u308a\u8fbc\u307f\uff08\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u3082\u5bfe\u8c61\uff09\nSub LoopFolder(objFolder)\n    Dim objSubFolder\n    Dim objFile\n    \n    log \"LOOP: \" & objFolder\n    \n    '// \u30d5\u30a1\u30a4\u30eb\u3092\u767b\u9332\n    For Each objFile In objFolder.files\n        '// \u62e1\u5f35\u5b50\u304c .eml \u306a\u3089\u30a4\u30f3\u30dd\u30fc\u30c8\u51e6\u7406\n        If LCase(Right(objFile.Name,4)) = \".eml\" Then\n           OpenEml objFile \n        End If \n    Next\n    \n    '// \u30d5\u30a9\u30eb\u30c0\u304c\u3042\u308c\u3070\u518d\u5e30\n    For Each objSubFolder In objFolder.SubFolders\n        LoopFolder objSubFolder\n    Next\nEnd Sub\n\n\n'//===================================================================\n'// eml \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u30a4\u30f3\u30dd\u30fc\u30c8\nSub OpenEml( emlFile ) \n    '// \u30a8\u30e9\u30fc\u7121\u8996\n    On Error Resume Next \n    log  \"OPEN EML: \" & emlFile.Name\n    \n    '// \u30e1\u30fc\u30eb\u304c\u958b\u3044\u3066\u3044\u305f\u3089\u9589\u3058\u308b \n    While Not OutlookApp.ActiveInspector Is Nothing \n        OutlookApp.ActiveInspector.Close \n        WScript.Sleep 500 \n    Wend \n    \n    '// eml \u30d5\u30a1\u30a4\u30eb\u3092 Outlook \u3067\u958b\u304f\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c \n    WSH.Run \"outlook /eml \"\"\" & FSO.getParentFolderName(emlFile) & _\n        \"\\\" & emlFile.Name & \"\"\"\" \n    \n    '// Outlook \u8d77\u52d5\u5f85\u3061 \n    While OutlookApp.ActiveInspector Is Nothing \n        WScript.Sleep 500 \n    Wend \n    \n    '// \u30e1\u30fc\u30eb\u30d5\u30a9\u30eb\u30c0\u79fb\u52d5 \n    OutlookApp.ActiveInspector.CurrentItem.Move fldImport \n    \n    '// \u53d6\u308a\u8fbc\u3093\u3060\u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664(\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3044\u306a\u3051\u308c\u3070\uff09\n    If Err.Number = 0 Then\n        emlFile.Delete\n    End If\nEnd Sub \n\n\n'//===================================================================\n'// \u30ed\u30b0\u51fa\u529b\nSub log(strMsg)\n    '// \u30a8\u30e9\u30fc\u7121\u8996\n    On Error Resume Next\n    \n    '// \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\n    oLog.WriteLine(Now() & \" \" & strMsg)\n    \n    '// CSCRIPT \u306a\u3089 ECHO\u3067\u8868\u793a\n    If LCase(Right(WScript.FullName, Len(\"cscript.exe\"))) = \"cscript.exe\" Then\n        WScript.Echo Now() & \" \" & strMsg\n    End If\nEnd Sub\n\n```\n\n", "tags": ["Outlook", "VBScript"]}