{"context": " More than 1 year has passed since last update.Kosugitti \u5148\u751f\u306e\u4e16\u754c\u4e00\u7c21\u5358\u306arstan\u30b3\u30fc\u30c9\u306b\u89e6\u767a\u3055\u308c\u3066\u3001\n\u4e8c\u756a\u76ee\u306b\u7c21\u5358\u306a rstan \u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\nlibrary(rstan) \n\nN <- 1000\nx <- rnorm(N, mean = 50, sd = 10)\ny <- 10 + 0.8 * x + rnorm(N, mean =0, sd = 7)\n\nstancode <- '\n  data{\n    int<lower=0> N;\n    real x[N];\n    real y[N];\n  }\n  parameters {\n    real alpha;\n    real beta;\n    real<lower=0> s;\n  }\n  model{\n    for(i in 1:N)\n      y[i] ~ normal(alpha + beta * x[i], s);\n    alpha ~ normal(0, 100);\n    beta ~ normal(0, 100);\n    s ~ inv_gamma(0.001, 0.001);\n  }\n'\ndatastan <- list(N=N, x=x, y=y)\nfit <- stan(model_code=stancode, data=datastan, iter=1000, chain=4)\ntraceplot(fit, ask=T)\nprint(fit, digit=2)\n\n\n\n\u7d50\u679c\n          mean se_mean   sd     2.5%      25%      50%      75%    97.5% n_eff Rhat\nalpha    11.60    0.06 1.11     9.29    10.90    11.60    12.33    13.73   396 1.01\nbeta      0.77    0.00 0.02     0.73     0.76     0.77     0.79     0.82   404 1.01\ns         7.01    0.01 0.15     6.71     6.90     7.01     7.10     7.32   438 1.00\nlp__  -2447.58    0.06 1.26 -2450.88 -2448.09 -2447.25 -2446.70 -2446.22   451 1.00\n\n\nalpha \u306e\u63a8\u5b9a\u304c\u3046\u307e\u304f\u3044\u3063\u3066\u306a\u3044\u3088\u3046\u306a\u6c17\u304c\u3059\u308b\u3093\u3067\u3059\u304c\u3002\u3002\u3002\n\u3054\u67fb\u53ce\u304f\u3060\u3055\u3044\u3002\n\u95a2\u9023\u8a18\u4e8b\uff1a\nStan \u3067\u76f8\u95a2\u4fc2\u6570\u3092\u63a8\u5b9a\u3059\u308b\nStan \u3067 increment_log_prob()\nKosugitti \u5148\u751f\u306e[\u4e16\u754c\u4e00\u7c21\u5358\u306arstan\u30b3\u30fc\u30c9](http://kosugitti.net/archives/4823)\u306b\u89e6\u767a\u3055\u308c\u3066\u3001\n\u4e8c\u756a\u76ee\u306b\u7c21\u5358\u306a rstan \u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\n```r\nlibrary(rstan) \n\nN <- 1000\nx <- rnorm(N, mean = 50, sd = 10)\ny <- 10 + 0.8 * x + rnorm(N, mean =0, sd = 7)\n\nstancode <- '\n  data{\n    int<lower=0> N;\n    real x[N];\n    real y[N];\n  }\n  parameters {\n    real alpha;\n    real beta;\n    real<lower=0> s;\n  }\n  model{\n    for(i in 1:N)\n      y[i] ~ normal(alpha + beta * x[i], s);\n    alpha ~ normal(0, 100);\n    beta ~ normal(0, 100);\n    s ~ inv_gamma(0.001, 0.001);\n  }\n'\ndatastan <- list(N=N, x=x, y=y)\nfit <- stan(model_code=stancode, data=datastan, iter=1000, chain=4)\ntraceplot(fit, ask=T)\nprint(fit, digit=2)\n```\n\n![Rplot01.png](https://qiita-image-store.s3.amazonaws.com/0/2570/dfec861b-f5d9-8ab0-e714-b7db8480cb0b.png)\n\n```:\u7d50\u679c\n          mean se_mean   sd     2.5%      25%      50%      75%    97.5% n_eff Rhat\nalpha    11.60    0.06 1.11     9.29    10.90    11.60    12.33    13.73   396 1.01\nbeta      0.77    0.00 0.02     0.73     0.76     0.77     0.79     0.82   404 1.01\ns         7.01    0.01 0.15     6.71     6.90     7.01     7.10     7.32   438 1.00\nlp__  -2447.58    0.06 1.26 -2450.88 -2448.09 -2447.25 -2446.70 -2446.22   451 1.00\n```\n\nalpha \u306e\u63a8\u5b9a\u304c\u3046\u307e\u304f\u3044\u3063\u3066\u306a\u3044\u3088\u3046\u306a\u6c17\u304c\u3059\u308b\u3093\u3067\u3059\u304c\u3002\u3002\u3002\n\n\n\u3054\u67fb\u53ce\u304f\u3060\u3055\u3044\u3002\n\n\u95a2\u9023\u8a18\u4e8b\uff1a\n[Stan \u3067\u76f8\u95a2\u4fc2\u6570\u3092\u63a8\u5b9a\u3059\u308b](http://qiita.com/hoxo_m/items/0f1b05681f5d6c4b560a)\n[Stan \u3067 increment_log_prob()](http://qiita.com/hoxo_m/items/56a63faf29e1af4db27d)\n", "tags": ["R", "RStan"]}