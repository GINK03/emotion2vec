{"context": "Simply.js\u3092\u4f7f\u3046\u3002\u6b21\u4e16\u4ee3SDK\u306epebble/pebblejs\u306e\u5b58\u5728\u306b\u306f\u5b8c\u6210\u3057\u3066\u304b\u3089\u6c17\u304c\u3064\u3044\u305f\nDropbox\u306e\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u8a8d\u8a3c\u3068\u304b\u9762\u5012\u306a\u4e8b\u306f\u305b\u305a\u306b\u76f4\u30ea\u30f3\u53ef\u80fd\u306aURL\u3092\u6307\u5b9a\u3059\u308b\u3002\u30a2\u30c9\u30a6\u30a7\u30a2\u3068\u304b\u5165\u308c\u308b\u5fc5\u8981\u306a\u304f\u3001dropbox\u306e\u5165\u3063\u305fPC\u3067\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3059\u308c\u3070\u3082\u3046OK\u3002\n\u6b63\u78ba\u306a\u6642\u8a08\u306fnict\u306eapi \u3092\u4f7f\u3046\u3002\n\u4e00\u679a\u76ee\u304c\u30d5\u30ea\u30fc\u30c6\u30ad\u30b9\u30c8\u3002cloudpebble\u3092\u4f7f\u3063\u3066\u3044\u308b\u304b\u3089\u65e5\u672c\u8a9e\u304c\u8c46\u8150\u306b\u306a\u3063\u3066\u308b\u3051\u3069\u3001\u5b9f\u6a5f\u3067\u306f\u5f53\u7136\u554f\u984c\u306a\u3057\u3002\u30b9\u30af\u30ed\u30fc\u30eb\u53ef\u3002\u305f\u3060\u3082\u3046\u3061\u3087\u3044\u30d5\u30a9\u30f3\u30c8\u5c0f\u3055\u304f\u3057\u305f\u3044\n\u4e8c\u679a\u76ee\u304c\u6642\u8a08\u3002\u30b9\u30de\u30db\u306e\u6642\u8a08\u3063\u3066\u305d\u3082\u305d\u3082ntp\u3058\u3083\u306a\u304f\u3066NITZ\u3060\u3057\u3001\u3044\u3064\u88dc\u6b63\u3057\u305f\u306e\u304b\u3059\u3089\u8868\u793a\u3055\u308c\u306a\u3044\u304b\u3089\u5168\u7136\u4fe1\u7528\u51fa\u6765\u306a\u3044\u3002\u306a\u3093\u3067\u30c7\u30d5\u30a9\u30eb\u30c8off\u3067\u3044\u3044\u304b\u3089ntp\u4e57\u305b\u3066\u304f\u308c\u306a\u3044\u306e\u30fb\u30fb\u30fb\u4e0a\u304b\u3089\u6b63\u3057\u3044\u6642\u523b\u3001\u30b9\u30de\u30db\u306e\u6642\u523b\u3001\u5dee\u5206\u3002\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u63cf\u753b\u3092\u66f4\u65b0\u3057\u3066\u308b\n \n\u4ee5\u4e0b\u30b3\u30fc\u30c9\nvar formatDate = function (date, format) {\n  if (!format) format = 'YYYY-MM-DD hh:mm:ss';\n  format = format.replace(/YYYY/g, date.getFullYear());\n  format = format.replace(/MM/g, ('0' + (date.getMonth() + 1)).slice(-2));\n  format = format.replace(/DD/g, ('0' + date.getDate()).slice(-2));\n  format = format.replace(/hh/g, ('0' + date.getHours()).slice(-2));\n  format = format.replace(/mm/g, ('0' + date.getMinutes()).slice(-2));\n  format = format.replace(/ss/g, ('0' + date.getSeconds()).slice(-2));\n  format = format.replace(/yy/g, [\"\u65e5\",\"\u6708\",\"\u706b\",\"\u6c34\",\"\u6728\",\"\u91d1\",\"\u571f\"][date.getDay()]);\n  return format;\n};\n/*\n{\n    id:\u5fc5\u9808\n    onLoad:\n    onUnLoad:\n    onLongPress:\n}\n*/\nvar pages=[];\npages.push({id:\"memo\",onLoad:function(me){\n    ajaxText(\"memo\",\"https://dl.dropboxusercontent.com/s/xxx\",0);\n},onUnLoad:function(data){\n    simply.text({body:\"\"});\n},onLongPress:function(data){\n    ajaxText(\"memo\",\"https://dl.dropboxusercontent.com/s/xxx\",1);\n}});\npages.push({id:\"time\",onLoad:function(me){\n    var url=\"https://ntp-a1.nict.go.jp/cgi-bin/json?\"+(new Date().getTime()/1000);\n    ajax({url:url,type:'json'},function(data){\n    var tickFunc=(function(){\n        return function(){\n            me.tick(me);\n        };\n    })(me)\n        me.offset=data.st-data.it;\n        me.timerId=setInterval(tickFunc,100);\n    });\n},onUnLoad:function(me){\n    simply.text({subtitle:\"\"});\n    clearInterval(me.timerId);\n},onLongPress:function(data){\n},tick:function(me){\n    var nowDate=new Date();\n    var ms=nowDate.getTime()+(me.offset*1000);\n    var timeObject=new Date(ms);\n    var st=formatDate(timeObject,\"hh:mm.ss\");\n    var localTime=formatDate(nowDate,\"hh:mm.ss\");\n    simply.text({subtitle:\"\u6b63:\"+st+\"\\n\u8aa4:\"+localTime+\"\\n\u5dee:\"+ Math.round(me.offset*100)/100*-1});\n},offset:0,timerId:0});\n\nfunction getPageObjectFromId(pageId){\n    for(var i =0;i<pages.length;i++){\n        if(pages[i].id==pageId){\n            return pages[i];\n        }\n    }\n    return null;\n}\nfunction onPushCenterButton(){\n    var closePage=null,openPage=null;\n    var pageId=localStorage.getItem('_page')||\"\";\n    if(pageId==\"\"){\n        closePage=null;\n        openPage=pages[0];\n    }else{\n        var index=-1;\n        for(var i =0;i<pages.length;i++){\n            if(pages[i].id==pageId){\n                index=i;\n                break;\n            }\n        }\n        if(index==-1){\n            closePage=null;\n            openPage=pages[0];\n        }else{\n            closePage=pages[index];\n            openPage=pages[(index+1)%pages.length];\n        }\n    }\n    if(closePage!=null){\n        closePage.onUnLoad(closePage);\n    }\n    simply.text({body:openPage.id});\n    openPage.onLoad(openPage);\n    localStorage.setItem('_page',openPage.id);\n}\nfunction onPushCenterButtonLong(){\n    var currentPage=null;\n    var pageId=localStorage.getItem('_page')||\"\";\n    if(pageId==\"\"){\n        currentPage=pages[0];\n    }else{\n        var index=-1;\n        for(var i =0;i<pages.length;i++){\n            if(pages[i].id==pageId){\n                index=i;\n                break;\n            }\n        }\n        if(index==-1){\n            currentPage=pages[0];\n        }else{\n            currentPage=pages[index];\n        }\n    }\n    if(currentPage!=null){\n        currentPage.onLongPress(currentPage);\n    }\n}\nfunction ajaxText(localStorageKey,url,forceUpdate){\n    var updateTimeSpanSecond=60;\n    var nowDateObject=new Date();\n    var dataUpdateUnixTime=parseInt(localStorage.getItem(localStorageKey+\"-lastUpdate\"))||nowDateObject.getTime();\n    var dateUpdateDateObject=new Date(dataUpdateUnixTime);\n    var dateUpdateString=formatDate(dateUpdateDateObject,'MM-DDyyhh:mm:ss');\n    var bodyText=localStorage.getItem(localStorageKey+\"-content\")||\"\";\n    simply.text({body:bodyText+\"\\n\"+dateUpdateString});\n    if( forceUpdate || updateTimeSpanSecond < (nowDateObject.getTime()-dataUpdateUnixTime) ){\n        ajax({ url: url, type: 'text' }, function(data) {\n            var updateDate=new Date();\n            var dateUpdateString=formatDate(updateDate,'MM-DDyyhh:mm:ss');\n            localStorage.setItem(localStorageKey+\"-lastUpdate\",updateDate.getTime());\n            localStorage.setItem(localStorageKey+\"-content\",data);\n            simply.text({body:data+\"\\n\"+dateUpdateString});\n        });\n    }\n}\nsimply.scrollable(true);\nsimply.on('singleClick', function(e) {\n    if(e.button==\"select\"){\n        onPushCenterButton();\n    }\n});\nsimply.on('longClick', function(e) {\n    if(e.button==\"select\"){\n        onPushCenterButtonLong();\n    }\n});\n(function(){\n    var pageId=localStorage.getItem('_page')||\"\";\n    if(pageId==\"\"){\n        pages[0].onLoad(pages[0]);\n    }else{\n        var index=-1;\n        for(var i =0;i<pages.length;i++){\n            if(pages[i].id==pageId){\n                index=i;\n                break;\n            }\n        }\n        if(index==-1){\n            pages[0].onLoad(pages[0]);\n        }else{\n            pages[index].onLoad(pages[index]);\n        }\n    }\n})()\n\n\u3042\u3068\u3001nict\u306eurl\u3092\u8abf\u3079\u3066\u6c17\u304c\u3064\u3044\u305f\u3051\u3069\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u304c\u5fae\u5999\u306b\u9055\u3046\u3002\nhttps://ntp-a1.nict.go.jp/cgi-bin/json \u306f\nHTTP/1.1 200 OK\nDate: Tue, 05 Apr 2016 12:42:23 GMT\nServer: Apache\nAccess-Control-Allow-Origin: *\nCache-Control: no-cache, no-store\nContent-Length: 114\nConnection: close\nContent-Type: application/json\n\nhttps://ntp-b1.nict.go.jp/cgi-bin/json \u306f\nHTTP/1.1 200 OK\nDate: Tue, 05 Apr 2016 12:42:48 GMT\nServer: Apache\nAccess-Control-Allow-Origin: *\nCache-Control: no-cache, no-store\nContent-Length: 114\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: application/json\n\nntp-b1\u306e\u65b9\u306fKeep-Alive\u304c\u5165\u3063\u3066\u308b\u3002Simply.js\u306eajax\u30e1\u30bd\u30c3\u30c9\u306fKeep-Alive\u304c\u3042\u308b\u3068\u30b3\u30b1\u308b\u304b\u3089\u6c17\u304c\u3064\u3044\u305f\u3002\nKeep-Alive\u304c\u3042\u308b\u3068\u30b3\u30b1\u308b\u306e\u3082\u76f8\u5f53\u30a2\u30ec\u3060\u3002\n[Simply.js](http://simplyjs.io/)\u3092\u4f7f\u3046\u3002\u6b21\u4e16\u4ee3SDK\u306e[pebble/pebblejs](https://github.com/pebble/pebblejs/)\u306e\u5b58\u5728\u306b\u306f\u5b8c\u6210\u3057\u3066\u304b\u3089\u6c17\u304c\u3064\u3044\u305f\n\nDropbox\u306e\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u8a8d\u8a3c\u3068\u304b\u9762\u5012\u306a\u4e8b\u306f\u305b\u305a\u306b\u76f4\u30ea\u30f3\u53ef\u80fd\u306aURL\u3092\u6307\u5b9a\u3059\u308b\u3002\u30a2\u30c9\u30a6\u30a7\u30a2\u3068\u304b\u5165\u308c\u308b\u5fc5\u8981\u306a\u304f\u3001dropbox\u306e\u5165\u3063\u305fPC\u3067\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3059\u308c\u3070\u3082\u3046OK\u3002\n\u6b63\u78ba\u306a\u6642\u8a08\u306f[nict\u306eapi](http://www.nict.go.jp/JST/http.html) \u3092\u4f7f\u3046\u3002\n\n\u4e00\u679a\u76ee\u304c\u30d5\u30ea\u30fc\u30c6\u30ad\u30b9\u30c8\u3002[cloudpebble](https://cloudpebble.net/)\u3092\u4f7f\u3063\u3066\u3044\u308b\u304b\u3089\u65e5\u672c\u8a9e\u304c\u8c46\u8150\u306b\u306a\u3063\u3066\u308b\u3051\u3069\u3001\u5b9f\u6a5f\u3067\u306f\u5f53\u7136\u554f\u984c\u306a\u3057\u3002\u30b9\u30af\u30ed\u30fc\u30eb\u53ef\u3002\u305f\u3060\u3082\u3046\u3061\u3087\u3044\u30d5\u30a9\u30f3\u30c8\u5c0f\u3055\u304f\u3057\u305f\u3044\n\u4e8c\u679a\u76ee\u304c\u6642\u8a08\u3002\u30b9\u30de\u30db\u306e\u6642\u8a08\u3063\u3066\u305d\u3082\u305d\u3082ntp\u3058\u3083\u306a\u304f\u3066NITZ\u3060\u3057\u3001\u3044\u3064\u88dc\u6b63\u3057\u305f\u306e\u304b\u3059\u3089\u8868\u793a\u3055\u308c\u306a\u3044\u304b\u3089\u5168\u7136\u4fe1\u7528\u51fa\u6765\u306a\u3044\u3002\u306a\u3093\u3067\u30c7\u30d5\u30a9\u30eb\u30c8off\u3067\u3044\u3044\u304b\u3089ntp\u4e57\u305b\u3066\u304f\u308c\u306a\u3044\u306e\u30fb\u30fb\u30fb\u4e0a\u304b\u3089\u6b63\u3057\u3044\u6642\u523b\u3001\u30b9\u30de\u30db\u306e\u6642\u523b\u3001\u5dee\u5206\u3002\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u63cf\u753b\u3092\u66f4\u65b0\u3057\u3066\u308b\n\n![imgTemp-2016-04-05-21-37-18.png](https://qiita-image-store.s3.amazonaws.com/0/5825/43aafc5f-41d9-1a8e-19ad-cc4a1552beb5.png) ![imgTemp-2016-04-05-21-38-00.png](https://qiita-image-store.s3.amazonaws.com/0/5825/1df8799e-7779-f5b6-96ff-53b4e3aeda73.png)\n\u4ee5\u4e0b\u30b3\u30fc\u30c9\n\n```js\nvar formatDate = function (date, format) {\n  if (!format) format = 'YYYY-MM-DD hh:mm:ss';\n  format = format.replace(/YYYY/g, date.getFullYear());\n  format = format.replace(/MM/g, ('0' + (date.getMonth() + 1)).slice(-2));\n  format = format.replace(/DD/g, ('0' + date.getDate()).slice(-2));\n  format = format.replace(/hh/g, ('0' + date.getHours()).slice(-2));\n  format = format.replace(/mm/g, ('0' + date.getMinutes()).slice(-2));\n  format = format.replace(/ss/g, ('0' + date.getSeconds()).slice(-2));\n  format = format.replace(/yy/g, [\"\u65e5\",\"\u6708\",\"\u706b\",\"\u6c34\",\"\u6728\",\"\u91d1\",\"\u571f\"][date.getDay()]);\n  return format;\n};\n/*\n{\n\tid:\u5fc5\u9808\n\tonLoad:\n\tonUnLoad:\n\tonLongPress:\n}\n*/\nvar pages=[];\npages.push({id:\"memo\",onLoad:function(me){\n\tajaxText(\"memo\",\"https://dl.dropboxusercontent.com/s/xxx\",0);\n},onUnLoad:function(data){\n\tsimply.text({body:\"\"});\n},onLongPress:function(data){\n\tajaxText(\"memo\",\"https://dl.dropboxusercontent.com/s/xxx\",1);\n}});\npages.push({id:\"time\",onLoad:function(me){\n\tvar url=\"https://ntp-a1.nict.go.jp/cgi-bin/json?\"+(new Date().getTime()/1000);\n\tajax({url:url,type:'json'},function(data){\n\tvar tickFunc=(function(){\n\t\treturn function(){\n\t\t\tme.tick(me);\n\t\t};\n\t})(me)\n\t\tme.offset=data.st-data.it;\n\t\tme.timerId=setInterval(tickFunc,100);\n\t});\n},onUnLoad:function(me){\n\tsimply.text({subtitle:\"\"});\n\tclearInterval(me.timerId);\n},onLongPress:function(data){\n},tick:function(me){\n\tvar nowDate=new Date();\n\tvar ms=nowDate.getTime()+(me.offset*1000);\n\tvar timeObject=new Date(ms);\n\tvar st=formatDate(timeObject,\"hh:mm.ss\");\n\tvar localTime=formatDate(nowDate,\"hh:mm.ss\");\n\tsimply.text({subtitle:\"\u6b63:\"+st+\"\\n\u8aa4:\"+localTime+\"\\n\u5dee:\"+ Math.round(me.offset*100)/100*-1});\n},offset:0,timerId:0});\n\nfunction getPageObjectFromId(pageId){\n\tfor(var i =0;i<pages.length;i++){\n\t\tif(pages[i].id==pageId){\n\t\t\treturn pages[i];\n\t\t}\n\t}\n\treturn null;\n}\nfunction onPushCenterButton(){\n\tvar closePage=null,openPage=null;\n\tvar pageId=localStorage.getItem('_page')||\"\";\n\tif(pageId==\"\"){\n\t\tclosePage=null;\n\t\topenPage=pages[0];\n\t}else{\n\t\tvar index=-1;\n\t\tfor(var i =0;i<pages.length;i++){\n\t\t\tif(pages[i].id==pageId){\n\t\t\t\tindex=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(index==-1){\n\t\t\tclosePage=null;\n\t\t\topenPage=pages[0];\n\t\t}else{\n\t\t\tclosePage=pages[index];\n\t\t\topenPage=pages[(index+1)%pages.length];\n\t\t}\n\t}\n\tif(closePage!=null){\n\t\tclosePage.onUnLoad(closePage);\n\t}\n\tsimply.text({body:openPage.id});\n\topenPage.onLoad(openPage);\n\tlocalStorage.setItem('_page',openPage.id);\n}\nfunction onPushCenterButtonLong(){\n\tvar currentPage=null;\n\tvar pageId=localStorage.getItem('_page')||\"\";\n\tif(pageId==\"\"){\n\t\tcurrentPage=pages[0];\n\t}else{\n\t\tvar index=-1;\n\t\tfor(var i =0;i<pages.length;i++){\n\t\t\tif(pages[i].id==pageId){\n\t\t\t\tindex=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(index==-1){\n\t\t\tcurrentPage=pages[0];\n\t\t}else{\n\t\t\tcurrentPage=pages[index];\n\t\t}\n\t}\n\tif(currentPage!=null){\n\t\tcurrentPage.onLongPress(currentPage);\n\t}\n}\nfunction ajaxText(localStorageKey,url,forceUpdate){\n\tvar updateTimeSpanSecond=60;\n\tvar nowDateObject=new Date();\n\tvar dataUpdateUnixTime=parseInt(localStorage.getItem(localStorageKey+\"-lastUpdate\"))||nowDateObject.getTime();\n\tvar dateUpdateDateObject=new Date(dataUpdateUnixTime);\n\tvar dateUpdateString=formatDate(dateUpdateDateObject,'MM-DDyyhh:mm:ss');\n\tvar bodyText=localStorage.getItem(localStorageKey+\"-content\")||\"\";\n\tsimply.text({body:bodyText+\"\\n\"+dateUpdateString});\n\tif( forceUpdate || updateTimeSpanSecond < (nowDateObject.getTime()-dataUpdateUnixTime) ){\n\t\tajax({ url: url, type: 'text' }, function(data) {\n\t\t\tvar updateDate=new Date();\n\t\t\tvar dateUpdateString=formatDate(updateDate,'MM-DDyyhh:mm:ss');\n\t\t\tlocalStorage.setItem(localStorageKey+\"-lastUpdate\",updateDate.getTime());\n\t\t\tlocalStorage.setItem(localStorageKey+\"-content\",data);\n\t\t\tsimply.text({body:data+\"\\n\"+dateUpdateString});\n\t\t});\n\t}\n}\nsimply.scrollable(true);\nsimply.on('singleClick', function(e) {\n\tif(e.button==\"select\"){\n\t\tonPushCenterButton();\n\t}\n});\nsimply.on('longClick', function(e) {\n\tif(e.button==\"select\"){\n\t\tonPushCenterButtonLong();\n\t}\n});\n(function(){\n\tvar pageId=localStorage.getItem('_page')||\"\";\n\tif(pageId==\"\"){\n\t\tpages[0].onLoad(pages[0]);\n\t}else{\n\t\tvar index=-1;\n\t\tfor(var i =0;i<pages.length;i++){\n\t\t\tif(pages[i].id==pageId){\n\t\t\t\tindex=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(index==-1){\n\t\t\tpages[0].onLoad(pages[0]);\n\t\t}else{\n\t\t\tpages[index].onLoad(pages[index]);\n\t\t}\n\t}\n})()\n```\n\n\n\u3042\u3068\u3001nict\u306eurl\u3092\u8abf\u3079\u3066\u6c17\u304c\u3064\u3044\u305f\u3051\u3069\u30ec\u30b9\u30dd\u30f3\u30b9\u30d8\u30c3\u30c0\u304c\u5fae\u5999\u306b\u9055\u3046\u3002\nhttps://ntp-a1.nict.go.jp/cgi-bin/json \u306f\n\n```\nHTTP/1.1 200 OK\nDate: Tue, 05 Apr 2016 12:42:23 GMT\nServer: Apache\nAccess-Control-Allow-Origin: *\nCache-Control: no-cache, no-store\nContent-Length: 114\nConnection: close\nContent-Type: application/json\n```\nhttps://ntp-b1.nict.go.jp/cgi-bin/json \u306f\n\n```\nHTTP/1.1 200 OK\nDate: Tue, 05 Apr 2016 12:42:48 GMT\nServer: Apache\nAccess-Control-Allow-Origin: *\nCache-Control: no-cache, no-store\nContent-Length: 114\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: application/json\n```\n\n\nntp-b1\u306e\u65b9\u306fKeep-Alive\u304c\u5165\u3063\u3066\u308b\u3002Simply.js\u306eajax\u30e1\u30bd\u30c3\u30c9\u306fKeep-Alive\u304c\u3042\u308b\u3068\u30b3\u30b1\u308b\u304b\u3089\u6c17\u304c\u3064\u3044\u305f\u3002\nKeep-Alive\u304c\u3042\u308b\u3068\u30b3\u30b1\u308b\u306e\u3082\u76f8\u5f53\u30a2\u30ec\u3060\u3002\n", "tags": ["Pebble", "Simply.js"]}