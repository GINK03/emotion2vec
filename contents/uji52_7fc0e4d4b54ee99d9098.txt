{"context": "\n\nMac\u304b\u3089\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u7d4c\u305a\u306bAWS Management Console\u884c\u304f\u3067\uff01(CLI\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u7de8)\n\u524d\u56de\u306e\u8a18\u4e8b\u3067\u306fNode.js\u3067\u30dd\u30ea\u30b7\u5207\u3063\u3066\u771f\u9762\u76ee\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u305f\u3051\u3069\u3082\n\u305d\u3053\u3092\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3067Policy\u30ac\u30d0\u30ac\u30d0\u3067\u6df1\u591c\u30c6\u30f3\u30b7\u30e7\u30f3\u3067\u3084\u3063\u305f\u3060\u3051\u306e\u8a18\u4e8b\u3002\n\u524d\u56de\u306e\u3093\u8aad\u3093\u3067\u306a\u304f\u3066\u3082\u8aad\u3081\u308b\u611f\u3058\u306b\u66f8\u3044\u3066\u307e\u3059\u3002\n\n\u30bf\u30fc\u30b2\u30c3\u30c8\n\nAWS\u4f7f\u3046\u4eba\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3067\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u306e\u304c\u9762\u5012\u304f\u3055\u3044\u4eba\nMac\u30e6\u30fc\u30b6(\u3058\u3083\u306a\u304f\u3066\u3082\u826f\u3044\u3051\u3069\u3001open\u30b3\u30de\u30f3\u30c9\u4f7f\u3063\u3066\u308b\u306e\u3067\u7a93\u306e\u5834\u5408\u306f\u305d\u3053\u306e\u66f8\u304d\u63db\u3048\u304c\u5fc5\u8981)\ncli\u3092\u3061\u3087\u3063\u3068\u306f\u89e6\u3063\u305f\u3053\u3068\u304c\u3042\u308b\u3002\n\n\n\u6280\u8853\u8981\u7d20\u3068\u30e9\u30a4\u30d6\u30e9\u30ea\n\u6280\u8853\u8981\u7d20\n\nAWS IAM\nAWS STS\nAWS-CLI\njq\nsed\nxargs\nsed\nxargs\nsed\n\n\n\u3084\u3063\u305f\u3053\u3068\n\nIAM\u3067\u30ed\u30fc\u30eb\u3092\u4f5c\u6210\n\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3092\u66f8\u304f\n\n\nRole\nRole\u306e\u4f5c\u6210\u3068\u3057\u3066\u306f\n\nAssumeRole52\u3068\u3044\u3046\u30ed\u30fc\u30eb\u3092\nAdministratorAccess\u306e\u30dd\u30ea\u30b7\u3092\u5f53\u3066\u3066\n\u4fe1\u983c\u95a2\u4fc2\u304b\u3089\u3001\u4f7f\u3046\u30e6\u30fc\u30b6\u304c\u305d\u306e\u30ed\u30fc\u30eb\u3092\u4f7f\u3046\u305f\u3081\u306e\u6a29\u9650\u3092\u4e0e\u3048\u308b\n\n\u30dd\u30ea\u30b7\u306b\u95a2\u3057\u3066\u306f\u4e0b\u56f3\u306e\u901a\u308a\n\n\u4fe1\u983c\u95a2\u4fc2\u30bf\u30d6\u304b\u3089\u300c\u4fe1\u983c\u95a2\u4fc2\u306e\u7de8\u96c6\u300d\u3092\u9078\u3093\u3067\u4e0b\u306e\u611f\u3058\u3067\u30e6\u30fc\u30b6\u3092\u66f8\u304d\u8db3\u3057\u305f\u3089OK\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\",\n        \"AWS\": \"arn:aws:iam::\u6570\u5b57:user/\u30e6\u30fc\u30b6\u306eID\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n\n\u8ffd\u52a0\u3057\u305f\u3089\u753b\u9762\u306b\u30e6\u30fc\u30b6\u306e\u60c5\u5831\u304c\u8ffd\u52a0\u3055\u308c\u308b\n\n\u305f\u3060\u3001\u4eca\u56de\u306e\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u306f\u3067\u6255\u3044\u51fa\u3055\u308c\u308b\u30bb\u30c3\u30b7\u30e7\u30f3\u306f\u307e\u308b\u307e\u308b\u3053\u306e\u30ed\u30fc\u30eb\u304c\u4e0e\u3048\u3089\u308c\u308b\u304b\u3089\u3001AdministratorAccess\u306a\u3093\u305e\u7d76\u5bfe\u8a31\u53ef\u305b\u305a\u3001\u89e6\u308a\u305f\u3044\u30b5\u30fc\u30d3\u30b9\u306e\u8a31\u53ef\u3057\u305f\u3044Action\u3060\u3051\u306b\u7d5e\u3063\u3066Role\u3092\u4e0e\u3048\u308b\u304f\u3089\u3044\u306e\u8a8d\u53ef\u5236\u5fa1\u3057\u306a\u304d\u3083\u306a\u3093\u3084\u3067\u3002\n\n\u30b3\u30fc\u30c9\n\u4e0b\u306e\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u306e\u30ed\u30fc\u30eb\u306eARN\u3063\u3066\u66f8\u3044\u3066\u308b\u3068\u3053\u3092\u3001\u3055\u3063\u304d\u4f5c\u3063\u305f\u30ed\u30fc\u30eb\u306eARN\u306b\u7f6e\u304d\u63db\u3048\u305f\u3089\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u901a\u308a900\u79d2\u4f7f\u3048\u308bManagement Console\u304c\u5e30\u3063\u3066\u304f\u308b\u3093\u3084\u3067\uff01\naws sts assume-role --role-arn \u30ed\u30fc\u30eb\u306eARN --role-session-name uji52|jq -r '\"%7B%22sessionId%22%3A%22\"+.Credentials.AccessKeyId+\"%22%2C%22sessionKey%22%3A%22\"+.Credentials.SecretAccessKey+\"%22%2C%22sessionToken%22%3A%22\"+.Credentials.SessionToken+\"%22%7D\"'|sed -e \"s/=/%3D/g\"|sed -e \"s/+/%2B/g\"|sed -e \"s/\\//%2F/g\"|xargs echo \"https://signin.aws.amazon.com/federation?Action=getSigninToken&SessionType=json&Session=\"|sed -e \"s/ //g\"|xargs curl -s|jq -r \".SigninToken\"|xargs echo \"https://signin.aws.amazon.com/federation?Action=login&Issuer=oneliner52&Destination=https%3A%2F%2Fap-northeast-1.console.aws.amazon.com%2Fconsole&SigninToken=\"|sed -e \"s/ //g\"|xargs open\n\n\n\u307e\u3068\u3081\n\u663c\u9593\u306b\u300c\u3042\u308c\uff1f\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3067\u66f8\u3051\u308b\u3093\u3058\u3083\u306d\uff1f\u300d\u3063\u3066\u601d\u3063\u3066\u3057\u307e\u3063\u305f\u3070\u3063\u304b\u308a\u306b\u3001\u7121\u99c4\u306a\u6311\u6226\u3092\u884c\u3044\u3001\u4eba\u751f\u521d\u306e\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc(700\u6587\u5b57\u5f31)\u304c\u5b8c\u6210\u3002\naws sts\u306e\u5f15\u6570\u3067\u304a\u597d\u304d\u306a\u30dd\u30ea\u30b7\u30fc\u5207\u3063\u305f\u308a\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u6642\u9593\u4f38\u3070\u3059\u7b49\u3057\u3066\u3001\u5404\u3005\u697d\u3057\u3093\u3067\u304f\u3060\u3055\u3044\u307e\u305b\u3002\n# Mac\u304b\u3089\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u7d4c\u305a\u306bAWS Management Console\u884c\u304f\u3067\uff01(CLI\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u7de8)\n\n[\u524d\u56de\u306e\u8a18\u4e8b](http://qiita.com/uji52/items/c779ceb447cd5c3b3a0f)\u3067\u306fNode.js\u3067\u30dd\u30ea\u30b7\u5207\u3063\u3066\u771f\u9762\u76ee\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u305f\u3051\u3069\u3082\n\n\u305d\u3053\u3092\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3067Policy\u30ac\u30d0\u30ac\u30d0\u3067\u6df1\u591c\u30c6\u30f3\u30b7\u30e7\u30f3\u3067\u3084\u3063\u305f\u3060\u3051\u306e\u8a18\u4e8b\u3002\n\n\u524d\u56de\u306e\u3093\u8aad\u3093\u3067\u306a\u304f\u3066\u3082\u8aad\u3081\u308b\u611f\u3058\u306b\u66f8\u3044\u3066\u307e\u3059\u3002\n\n## \u30bf\u30fc\u30b2\u30c3\u30c8\n\n+ AWS\u4f7f\u3046\u4eba\n+ \u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3067\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u306e\u304c\u9762\u5012\u304f\u3055\u3044\u4eba\n+ Mac\u30e6\u30fc\u30b6(\u3058\u3083\u306a\u304f\u3066\u3082\u826f\u3044\u3051\u3069\u3001open\u30b3\u30de\u30f3\u30c9\u4f7f\u3063\u3066\u308b\u306e\u3067\u7a93\u306e\u5834\u5408\u306f\u305d\u3053\u306e\u66f8\u304d\u63db\u3048\u304c\u5fc5\u8981)\n+ cli\u3092\u3061\u3087\u3063\u3068\u306f\u89e6\u3063\u305f\u3053\u3068\u304c\u3042\u308b\u3002\n\n## \u6280\u8853\u8981\u7d20\u3068\u30e9\u30a4\u30d6\u30e9\u30ea\n\n\u6280\u8853\u8981\u7d20\n\n+ AWS IAM\n+ AWS STS\n+ AWS-CLI\n+ jq\n+ sed\n+ xargs\n+ sed\n+ xargs\n+ sed\n\n## \u3084\u3063\u305f\u3053\u3068\n\n+ IAM\u3067\u30ed\u30fc\u30eb\u3092\u4f5c\u6210\n+ \u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3092\u66f8\u304f\n\n### Role\n\nRole\u306e\u4f5c\u6210\u3068\u3057\u3066\u306f\n\n+ AssumeRole52\u3068\u3044\u3046\u30ed\u30fc\u30eb\u3092\n+ AdministratorAccess\u306e\u30dd\u30ea\u30b7\u3092\u5f53\u3066\u3066\n+ \u4fe1\u983c\u95a2\u4fc2\u304b\u3089\u3001\u4f7f\u3046\u30e6\u30fc\u30b6\u304c\u305d\u306e\u30ed\u30fc\u30eb\u3092\u4f7f\u3046\u305f\u3081\u306e\u6a29\u9650\u3092\u4e0e\u3048\u308b\n\n\u30dd\u30ea\u30b7\u306b\u95a2\u3057\u3066\u306f\u4e0b\u56f3\u306e\u901a\u308a\n\n![Role1.png](https://qiita-image-store.s3.amazonaws.com/0/103725/20773f5d-f1f6-0346-02d4-18eeb4bd6dce.png \"Role1.png\")\n\n\u4fe1\u983c\u95a2\u4fc2\u30bf\u30d6\u304b\u3089\u300c\u4fe1\u983c\u95a2\u4fc2\u306e\u7de8\u96c6\u300d\u3092\u9078\u3093\u3067\u4e0b\u306e\u611f\u3058\u3067\u30e6\u30fc\u30b6\u3092\u66f8\u304d\u8db3\u3057\u305f\u3089OK\n\n```\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"ec2.amazonaws.com\",\n        \"AWS\": \"arn:aws:iam::\u6570\u5b57:user/\u30e6\u30fc\u30b6\u306eID\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n```\n\n\u8ffd\u52a0\u3057\u305f\u3089\u753b\u9762\u306b\u30e6\u30fc\u30b6\u306e\u60c5\u5831\u304c\u8ffd\u52a0\u3055\u308c\u308b\n\n![Role2.png](https://qiita-image-store.s3.amazonaws.com/0/103725/2742f9a0-5dc2-c01d-81cf-d40148c32318.png \"Role2.png\")\n\n\u305f\u3060\u3001\u4eca\u56de\u306e\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u306f\u3067\u6255\u3044\u51fa\u3055\u308c\u308b\u30bb\u30c3\u30b7\u30e7\u30f3\u306f\u307e\u308b\u307e\u308b\u3053\u306e\u30ed\u30fc\u30eb\u304c\u4e0e\u3048\u3089\u308c\u308b\u304b\u3089\u3001AdministratorAccess\u306a\u3093\u305e\u7d76\u5bfe\u8a31\u53ef\u305b\u305a\u3001\u89e6\u308a\u305f\u3044\u30b5\u30fc\u30d3\u30b9\u306e\u8a31\u53ef\u3057\u305f\u3044Action\u3060\u3051\u306b\u7d5e\u3063\u3066Role\u3092\u4e0e\u3048\u308b\u304f\u3089\u3044\u306e\u8a8d\u53ef\u5236\u5fa1\u3057\u306a\u304d\u3083\u306a\u3093\u3084\u3067\u3002\n\n### \u30b3\u30fc\u30c9\n\n\u4e0b\u306e\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u306e__\u30ed\u30fc\u30eb\u306eARN__\u3063\u3066\u66f8\u3044\u3066\u308b\u3068\u3053\u3092\u3001\u3055\u3063\u304d\u4f5c\u3063\u305f\u30ed\u30fc\u30eb\u306eARN\u306b\u7f6e\u304d\u63db\u3048\u305f\u3089\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u901a\u308a900\u79d2\u4f7f\u3048\u308bManagement Console\u304c\u5e30\u3063\u3066\u304f\u308b\u3093\u3084\u3067\uff01\n\n```\naws sts assume-role --role-arn \u30ed\u30fc\u30eb\u306eARN --role-session-name uji52|jq -r '\"%7B%22sessionId%22%3A%22\"+.Credentials.AccessKeyId+\"%22%2C%22sessionKey%22%3A%22\"+.Credentials.SecretAccessKey+\"%22%2C%22sessionToken%22%3A%22\"+.Credentials.SessionToken+\"%22%7D\"'|sed -e \"s/=/%3D/g\"|sed -e \"s/+/%2B/g\"|sed -e \"s/\\//%2F/g\"|xargs echo \"https://signin.aws.amazon.com/federation?Action=getSigninToken&SessionType=json&Session=\"|sed -e \"s/ //g\"|xargs curl -s|jq -r \".SigninToken\"|xargs echo \"https://signin.aws.amazon.com/federation?Action=login&Issuer=oneliner52&Destination=https%3A%2F%2Fap-northeast-1.console.aws.amazon.com%2Fconsole&SigninToken=\"|sed -e \"s/ //g\"|xargs open\n```\n\n## \u307e\u3068\u3081\n\n\u663c\u9593\u306b\u300c\u3042\u308c\uff1f\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc\u3067\u66f8\u3051\u308b\u3093\u3058\u3083\u306d\uff1f\u300d\u3063\u3066\u601d\u3063\u3066\u3057\u307e\u3063\u305f\u3070\u3063\u304b\u308a\u306b\u3001\u7121\u99c4\u306a\u6311\u6226\u3092\u884c\u3044\u3001\u4eba\u751f\u521d\u306e\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc(700\u6587\u5b57\u5f31)\u304c\u5b8c\u6210\u3002\n\naws sts\u306e\u5f15\u6570\u3067\u304a\u597d\u304d\u306a\u30dd\u30ea\u30b7\u30fc\u5207\u3063\u305f\u308a\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u6642\u9593\u4f38\u3070\u3059\u7b49\u3057\u3066\u3001\u5404\u3005\u697d\u3057\u3093\u3067\u304f\u3060\u3055\u3044\u307e\u305b\u3002\n", "tags": ["AWS", "aws-cli", "AWSIAM", "AWSSTS", "\u30ef\u30f3\u30e9\u30a4\u30ca\u30fc"]}