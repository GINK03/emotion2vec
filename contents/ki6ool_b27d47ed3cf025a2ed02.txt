{"context": "\u4ee5\u524d\u3001EC-CUBE\u3067Ajax \u3063\u3066\u66f8\u3044\u305f\u3051\u3069\u3001\n\u3084\u3063\u3071\u308a\u81ea\u524d\u3067\u4f5c\u308b\u306e\u306f\u3088\u308d\u3057\u304f\u306a\u3044\u306e\u3067\n\u5099\u308f\u3063\u3066\u308bAPI\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u3084\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\u3068\u3044\u3046\u304b\u77e5\u3089\u306a\u304b\u3063\u305f\u3002\n\ntemplate.js\n(function ($) {\n    function ajaxPost(param) {\n        $.ajax({\n            type: \"POST\",\n            url:  \"/api/json.php\",\n            data: { 'Operation': 'MyOperation', 'Service': 'none', 'param': param },\n            dataType: \"json\",\n            success: function(response) {\n                var s = response.MyOperation.success;\n                var r = response.MyOperation.response;\n                if (!s) {\n                    alert(r.join(\"\\n\"));\n                    return;\n                }\n                //any\n            },\n            error: function(xhr, ts, et) {\n                console.log(ts);\n                console.log(et);\n            }\n        });\n    }\n}(jQuery));\n\n\n\n/data/class/api/operations/MyOperation.php\n<?php\nclass API_MyOperation extends SC_Api_Abstract_Ex {\n\n    protected $operation_name = 'MyOperation';\n    protected $operation_description = '\u3044\u308d\u3044\u308d';\n    protected $default_auth_types = self::API_AUTH_TYPE_OPEN;\n    protected $default_enable = '1';\n    protected $default_is_log = '0';\n    protected $default_sub_data = '';\n\n    private $response;\n    private $errors;\n    private $success;\n\n    public function doAction($arrParam) {\n        $param = $arrParam['param'];\n\n        if ( empty($param) ) {\n            $this->errors[] = \"param\u306a\u3044\u3084\u3067\";\n        } else {\n            $this->response = $param;\n        }\n\n        $this->arrResponse = [\n                'success' => empty($this->errors),\n                'response' => empty($this->errors) ? $this->response : $this->errors,\n        ];\n        return true;\n    }\n\n    public function getRequestValidate() {\n        return ['DefaultResponse' => []];\n    }\n\n    public function getResponseGroupName() {\n        return 'MyOperation';\n    }\n\n    protected function lfInitParam(&$objFormParam) {\n    }\n\n}\n\n\nAmazon\u306eAPI\u3092\u5143\u306b\u4f5c\u6210\u3057\u305f\u3089\u3057\u3044\u3002\n\u5404\u300cMyOperation\u300d\u3092\u9069\u5b9c\u5909\u66f4\u3057\u3066\u3054\u5229\u7528\u304f\u3060\u3055\u3044\u3002\n$this->arrResponse \u306e\u5165\u308c\u65b9\u306fWordpress\u65b9\u5f0f\u3067\u3084\u3063\u3066\u307e\u3059\u306e\u3067\n\u3053\u308c\u307e\u305f\u6c17\u306b\u5165\u3089\u306a\u3044\u65b9\u306f\u9069\u5b9c\u5909\u66f4\u3092\u3002\n\n$default_auth_types\n\u8a8d\u8a3c\u30ec\u30d9\u30eb\u3092\u8a2d\u5b9a\u3067\u304d\u308b\n\n/data/class/api/SC_Api_Abstract.php\n<?php\n    const API_AUTH_TYPE_REFERER = '1';          // \u30ea\u30d5\u30a1\u30e9\u30fc\n    const API_AUTH_TYPE_SESSION_TOKEN = '2';    // CSRF TOKEN\n    const API_AUTH_TYPE_API_SIGNATURE = '3';    // API \u7f72\u540d\u8a8d\u8a3c \u63a8\u5968\n    const API_AUTH_TYPE_CUSTOMER = '4';         // \u4f1a\u54e1\u8a8d\u8a3c\n    const API_AUTH_TYPE_MEMBER = '5';           // \u7ba1\u7406\u8005\u8a8d\u8a3c\n    const API_AUTH_TYPE_CUSTOMER_LOGIN_SESSION = '6';   // \u9867\u5ba2\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u6709\u52b9\n    const API_AUTH_TYPE_MEMBER_LOGIN_SESSION = '7';     // \u7ba1\u7406\u8005\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u6709\u52b9\n    const API_AUTH_TYPE_IP = '8';               // IP\u8a8d\u8a3c\n    const API_AUTH_TYPE_HOST = '9';             // \u30db\u30b9\u30c8\u8a8d\u8a3c\n    const API_AUTH_TYPE_SSL = '10';             // SSL\u5f37\u5236\n    const API_AUTH_TYPE_OPEN = '99';            // \u5b8c\u5168\u30aa\u30fc\u30d7\u30f3\n\n\n/data/class/api/operations \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\n\u65e2\u5b58API\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306e\u3067\n\u3053\u3044\u3064\u3089\u8aad\u3093\u3067\u308c\u3070\u7406\u89e3\u304c\u6df1\u307e\u308b\u3068\u601d\u308f\u308c\u3002\n\u4ee5\u524d\u3001[EC-CUBE\u3067Ajax](http://qiita.com/ki6ool/items/553039e47ece8ca19867) \u3063\u3066\u66f8\u3044\u305f\u3051\u3069\u3001\n\u3084\u3063\u3071\u308a\u81ea\u524d\u3067\u4f5c\u308b\u306e\u306f\u3088\u308d\u3057\u304f\u306a\u3044\u306e\u3067\n\u5099\u308f\u3063\u3066\u308bAPI\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u3084\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\u3068\u3044\u3046\u304b\u77e5\u3089\u306a\u304b\u3063\u305f\u3002\n\n```js:template.js\n(function ($) {\n\tfunction ajaxPost(param) {\n\t    $.ajax({\n\t        type: \"POST\",\n\t        url:  \"/api/json.php\",\n\t        data: { 'Operation': 'MyOperation', 'Service': 'none', 'param': param },\n\t        dataType: \"json\",\n\t        success: function(response) {\n\t        \tvar s = response.MyOperation.success;\n\t        \tvar r = response.MyOperation.response;\n\t        \tif (!s) {\n\t        \t\talert(r.join(\"\\n\"));\n\t        \t\treturn;\n\t        \t}\n\t        \t//any\n\t        },\n\t        error: function(xhr, ts, et) {\n\t        \tconsole.log(ts);\n\t        \tconsole.log(et);\n\t        }\n\t    });\n\t}\n}(jQuery));\n```\n\n```php:/data/class/api/operations/MyOperation.php\n<?php\nclass API_MyOperation extends SC_Api_Abstract_Ex {\n\n\tprotected $operation_name = 'MyOperation';\n\tprotected $operation_description = '\u3044\u308d\u3044\u308d';\n\tprotected $default_auth_types = self::API_AUTH_TYPE_OPEN;\n\tprotected $default_enable = '1';\n\tprotected $default_is_log = '0';\n\tprotected $default_sub_data = '';\n\n\tprivate $response;\n\tprivate $errors;\n\tprivate $success;\n\n\tpublic function doAction($arrParam) {\n\t\t$param = $arrParam['param'];\n\n\t\tif ( empty($param) ) {\n\t\t\t$this->errors[] = \"param\u306a\u3044\u3084\u3067\";\n\t\t} else {\n\t\t\t$this->response = $param;\n\t\t}\n\n\t\t$this->arrResponse = [\n\t\t\t\t'success' => empty($this->errors),\n\t\t\t\t'response' => empty($this->errors) ? $this->response : $this->errors,\n\t\t];\n\t\treturn true;\n\t}\n\n\tpublic function getRequestValidate() {\n\t\treturn ['DefaultResponse' => []];\n\t}\n\n\tpublic function getResponseGroupName() {\n\t\treturn 'MyOperation';\n\t}\n\n\tprotected function lfInitParam(&$objFormParam) {\n\t}\n\n}\n```\nAmazon\u306eAPI\u3092\u5143\u306b\u4f5c\u6210\u3057\u305f\u3089\u3057\u3044\u3002\n\u5404\u300cMyOperation\u300d\u3092\u9069\u5b9c\u5909\u66f4\u3057\u3066\u3054\u5229\u7528\u304f\u3060\u3055\u3044\u3002\n\n$this->arrResponse \u306e\u5165\u308c\u65b9\u306fWordpress\u65b9\u5f0f\u3067\u3084\u3063\u3066\u307e\u3059\u306e\u3067\n\u3053\u308c\u307e\u305f\u6c17\u306b\u5165\u3089\u306a\u3044\u65b9\u306f\u9069\u5b9c\u5909\u66f4\u3092\u3002\n\n\n####$default_auth_types\n\u8a8d\u8a3c\u30ec\u30d9\u30eb\u3092\u8a2d\u5b9a\u3067\u304d\u308b\n\n```php:/data/class/api/SC_Api_Abstract.php\n<?php\n    const API_AUTH_TYPE_REFERER = '1';          // \u30ea\u30d5\u30a1\u30e9\u30fc\n    const API_AUTH_TYPE_SESSION_TOKEN = '2';    // CSRF TOKEN\n    const API_AUTH_TYPE_API_SIGNATURE = '3';    // API \u7f72\u540d\u8a8d\u8a3c \u63a8\u5968\n    const API_AUTH_TYPE_CUSTOMER = '4';         // \u4f1a\u54e1\u8a8d\u8a3c\n    const API_AUTH_TYPE_MEMBER = '5';           // \u7ba1\u7406\u8005\u8a8d\u8a3c\n    const API_AUTH_TYPE_CUSTOMER_LOGIN_SESSION = '6';   // \u9867\u5ba2\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u6709\u52b9\n    const API_AUTH_TYPE_MEMBER_LOGIN_SESSION = '7';     // \u7ba1\u7406\u8005\u30ed\u30b0\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u304c\u6709\u52b9\n    const API_AUTH_TYPE_IP = '8';               // IP\u8a8d\u8a3c\n    const API_AUTH_TYPE_HOST = '9';             // \u30db\u30b9\u30c8\u8a8d\u8a3c\n    const API_AUTH_TYPE_SSL = '10';             // SSL\u5f37\u5236\n    const API_AUTH_TYPE_OPEN = '99';            // \u5b8c\u5168\u30aa\u30fc\u30d7\u30f3\n```\n\n/data/class/api/operations \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\n\u65e2\u5b58API\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306e\u3067\n\u3053\u3044\u3064\u3089\u8aad\u3093\u3067\u308c\u3070\u7406\u89e3\u304c\u6df1\u307e\u308b\u3068\u601d\u308f\u308c\u3002\n", "tags": ["EC-CUBE", "Ajax"]}