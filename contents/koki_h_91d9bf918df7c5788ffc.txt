{"context": "\n\n\u3053\u306e\u6587\u66f8\u306b\u3064\u3044\u3066\n\u4ee5\u4e0b\u306b\u66f8\u304b\u308c\u305f\u5185\u5bb9\u3092Swift\u3067\u66f8\u304d\u306a\u304a\u3057\u305f\u3060\u3051\u3067\u3059\u3002\n- http://qiita.com/hkato193/items/c0327e4c56ccf1c15e7d\n\n\u3084\u308a\u65b9\nCMSampleBuffer -> CVImageBufferRef -> CIImage -> CGImage -> UIImage\n\u3068\u3044\u3046\u9806\u5e8f\u3067\u5909\u63db\u3057\u3066\u3044\u304f\u3068UIImage\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n//CMSampleBuffer\u3092UIImage\u306b\u5909\u63db\u3059\u308b\nfunc UIImageFromCMSamleBuffer(buffer:CMSampleBuffer)-> UIImage {\n    // \u30b5\u30f3\u30d7\u30eb\u30d0\u30c3\u30d5\u30a1\u304b\u3089\u30d4\u30af\u30bb\u30eb\u30d0\u30c3\u30d5\u30a1\u3092\u53d6\u308a\u51fa\u3059\n    let pixelBuffer:CVImageBufferRef = CMSampleBufferGetImageBuffer(buffer)!\n\n    // \u30d4\u30af\u30bb\u30eb\u30d0\u30c3\u30d5\u30a1\u3092\u30d9\u30fc\u30b9\u306bCoreImage\u306eCIImage\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n    let ciImage = CIImage(CVPixelBuffer: pixelBuffer)\n\n    //CIImage\u304b\u3089CGImage\u3092\u4f5c\u6210\n    let pixelBufferWidth = CGFloat(CVPixelBufferGetWidth(pixelBuffer))\n    let pixelBufferHeight = CGFloat(CVPixelBufferGetHeight(pixelBuffer))\n    let imageRect:CGRect = CGRectMake(0,0,pixelBufferWidth, pixelBufferHeight)\n    let ciContext = CIContext.init()\n    let cgimage = ciContext.createCGImage(ciImage, fromRect: imageRect )\n\n    // CGImage\u304b\u3089UIImage\u3092\u4f5c\u6210\n    let image = UIImage(CGImage: cgimage)\n    return image\n}\n\n\n\u6ce8\u610f\nCGImage\u3092\u98db\u3070\u3057\u3066CIImage\u304b\u3089UIImage\u3092\u4f5c\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u304c\u3001\u3053\u306e\u3084\u308a\u65b9\u3067\u306f\u5f97\u3089\u308c\u305fUIImage\u304b\u3089UIImageJPEGRepresentation\u3092\u4f7f\u3063\u3066JPG\u753b\u50cf\u3092\u4f5c\u6210\u3059\u308b\u3068\u623b\u308a\u5024\u304cnil\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067CGImage\u3092\u7d4c\u7531\u3059\u308b\u306e\u304c\u826f\u3044\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\n\u53c2\u8003\nhttp://qiita.com/hkato193/items/c0327e4c56ccf1c15e7d\n#\u3053\u306e\u6587\u66f8\u306b\u3064\u3044\u3066\n\u4ee5\u4e0b\u306b\u66f8\u304b\u308c\u305f\u5185\u5bb9\u3092Swift\u3067\u66f8\u304d\u306a\u304a\u3057\u305f\u3060\u3051\u3067\u3059\u3002\n- http://qiita.com/hkato193/items/c0327e4c56ccf1c15e7d\n\n#\u3084\u308a\u65b9\nCMSampleBuffer -> CVImageBufferRef -> CIImage -> CGImage -> UIImage\n\u3068\u3044\u3046\u9806\u5e8f\u3067\u5909\u63db\u3057\u3066\u3044\u304f\u3068UIImage\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\n\n##\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n```swift:\n\n//CMSampleBuffer\u3092UIImage\u306b\u5909\u63db\u3059\u308b\nfunc UIImageFromCMSamleBuffer(buffer:CMSampleBuffer)-> UIImage {\n    // \u30b5\u30f3\u30d7\u30eb\u30d0\u30c3\u30d5\u30a1\u304b\u3089\u30d4\u30af\u30bb\u30eb\u30d0\u30c3\u30d5\u30a1\u3092\u53d6\u308a\u51fa\u3059\n    let pixelBuffer:CVImageBufferRef = CMSampleBufferGetImageBuffer(buffer)!\n\n    // \u30d4\u30af\u30bb\u30eb\u30d0\u30c3\u30d5\u30a1\u3092\u30d9\u30fc\u30b9\u306bCoreImage\u306eCIImage\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n    let ciImage = CIImage(CVPixelBuffer: pixelBuffer)\n\n    //CIImage\u304b\u3089CGImage\u3092\u4f5c\u6210\n    let pixelBufferWidth = CGFloat(CVPixelBufferGetWidth(pixelBuffer))\n    let pixelBufferHeight = CGFloat(CVPixelBufferGetHeight(pixelBuffer))\n    let imageRect:CGRect = CGRectMake(0,0,pixelBufferWidth, pixelBufferHeight)\n    let ciContext = CIContext.init()\n    let cgimage = ciContext.createCGImage(ciImage, fromRect: imageRect )\n\n    // CGImage\u304b\u3089UIImage\u3092\u4f5c\u6210\n    let image = UIImage(CGImage: cgimage)\n    return image\n}\n```\n#\u6ce8\u610f\nCGImage\u3092\u98db\u3070\u3057\u3066CIImage\u304b\u3089UIImage\u3092\u4f5c\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u304c\u3001\u3053\u306e\u3084\u308a\u65b9\u3067\u306f\u5f97\u3089\u308c\u305fUIImage\u304b\u3089UIImageJPEGRepresentation\u3092\u4f7f\u3063\u3066JPG\u753b\u50cf\u3092\u4f5c\u6210\u3059\u308b\u3068\u623b\u308a\u5024\u304cnil\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067CGImage\u3092\u7d4c\u7531\u3059\u308b\u306e\u304c\u826f\u3044\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n\n#\u53c2\u8003\nhttp://qiita.com/hkato193/items/c0327e4c56ccf1c15e7d\n", "tags": ["Swift", "iOS", "\u753b\u50cf\u51e6\u7406", "\u30ab\u30e1\u30e9"]}