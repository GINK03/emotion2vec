{"context": " More than 1 year has passed since last update.\u672c\u7a3f\u306f\uff0chttp://www.monaka.org/blog/2014/02/04/how-to-build-ebs-image/ \u3092\u8981\u7d04\u3057\u305f\u3082\u306e\u3067\u3059\uff0e\n\n\u307e\u304f\u3089\nAWS EC2 \u306f\uff0c\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u3068\u3057\u3066 Xen \u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u306e\u3067\uff0cXen \u306e mini-os \u3092 Amazon EC2 \u3067\u52d5\u4f5c\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\n\u3053\u308c\u306f\uff0c\u30aa\u30ec\u30aa\u30ecOS\u3092\u30af\u30e9\u30a6\u30c9OS\u3068\u3057\u3066\u904b\u7528\u3059\u308b\u3068\u3044\u3046\uff0c\u4ffa\u5f97\u7684\u6e80\u8db3\u611f\u304c\u5f97\u3089\u308c\u308b\uff0c\u3068\u3044\u3046\u3053\u3068\u3092\u610f\u5473\u3059\u308b\uff0e\nAmazon \u304c\u63d0\u4f9b\u3057\u3066\u3044\u306a\u3044\u30ab\u30fc\u30cd\u30eb\u3092\u72ec\u81ea\u306b EC2 \u3067\u52d5\u4f5c\u3055\u305b\u308b\u305f\u3081\u306b\u306f\uff0c\u3069\u3046\u3084\u3089 EBS \u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u3089\u306d\u3070\u306a\u3089\u306a\u3044\u3089\u3057\u3044\uff0e\n\u79c1\u306f\uff0cAWS \u306e\u5358\u306a\u308b\u30e6\u30fc\u30b6\u3067\uff0c\u7d30\u304b\u3044\u3068\u3053\u308d\u306f\u3042\u307e\u308a\u8a73\u3057\u304f\u306a\u3044\uff0e\n\u3088\u3063\u3066\uff0cEBS \u30dc\u30ea\u30e5\u30fc\u30e0\u4ee5\u5916\u3067\u306e\u8d77\u52d5\u65b9\u6cd5\u3082\u3042\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u2026\uff0e\n\u624b\u9806\u306f\u672c\u5bb6\u30d8\u30eb\u30d7\u30da\u30fc\u30b8\u306b\u5272\u3068\u7d30\u304b\u304f\u8aac\u660e\u3055\u308c\u3066\u3044\u308b\uff0e\n\u89e3\u8aac\u30d6\u30ed\u30b0\u3082\uff0c\u30b0\u30b0\u308c\u3070\u5c71\u76db\u308a\uff0e\n\u3055\u3059\u304c\u306f\uff0c\u307f\u3093\u306a\u5927\u597d\u304dAWS\uff0e\n\u3060\u304c\u3057\u304b\u3057\uff0c\u6700\u8fd1\u306b\u306a\u3063\u3066\uff0cAWS \u306f\uff0c\u7ba1\u7406\u30c4\u30fc\u30eb\u3092 AWS-CLI \u3068\u3044\u3046\u3082\u306e\u306b\u7d71\u5408\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u4e00\u65b9\uff0c\u672c\u5bb6\u30d8\u30eb\u30d7\u30da\u30fc\u30b8\u306f\uff0cAWS-CLI \u3078\u306e\u5bfe\u5fdc\u304c\u5341\u5206\u306b\u3067\u304d\u3066\u3044\u306a\u3044\uff0e\n\u305d\u3053\u3067\uff0c\u672c\u7a3f\u3067\u306f\uff0cAWS-CLI \u3067 mini-os \u3092\u30d6\u30fc\u30c8\u3055\u305b\u308b\u305f\u3081\u306e\u624b\u9806\u3092\u8a18\u3059\uff0e\n\n\u4f5c\u696d\n\n\u6982\u8981\n\u72ec\u81ea\u306e\u30ab\u30fc\u30cd\u30eb\u3092EC2\u4e0a\u3067\u52d5\u4f5c\u3055\u305b\u308b\u305f\u3081\u306e\u30a4\u30e1\u30fc\u30b8(\u4ee5\u4e0b\uff0c\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8)\u306f\uff0cEBS \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u4f5c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\uff0e\nXen \u3067\u306f\u304a\u306a\u3058\u307f\u306e PV-GRUB \u304c\uff0c\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u4e2d\u306b\u3042\u308b boot/grub/menu.lst \u3092\u8aad\u307f\uff0c\nkernel (\u672c\u7a3f\u306e\u5834\u5408\u306f mini-os)\u3092\u30ed\u30fc\u30c9\u3057\u30d6\u30fc\u30c8\u3059\u308b\uff0e\n\u624b\u5143\u74b0\u5883\u3067EBS\u3092\u4f5c\u3063\u3066\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u304c(\u77e5\u3089\u306a\u3044)\uff0c\u3053\u3053\u3067\u306f EC2 \u4e0a\u3067 t1.micro \u3092\u7acb\u3061\u4e0a\u3052\u3066\u4f5c\u696d\u3059\u308b\uff0e\n\u4e00\u9023\u306e\u4f5c\u696d\u6642\u9593\u306f\uff0c1\u6642\u9593\u3082\u304b\u304b\u3089\u306a\u3044\uff0et1.micro \u306a\u308910\u5186\u306b\u3082\u6e80\u305f\u306a\u3044\u3088\u3046\u306a\u984d\u3060\u308d\u3046\uff0e\n\u672c\u7a3f\u3067\u306f\uff0c\u30d3\u30eb\u30c9\u306f\u624b\u5143\u3067\u884c\u3046\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\uff0e\u30d3\u30eb\u30c9\u74b0\u5883\u3055\u3048\u3082EC2\u4e0a\u306b\u7acb\u3066\u308b\u3068\u3044\u3046\u3053\u3068\u3082\uff0c\u3082\u3061\u308d\u3093\u3067\u304d\u308b\uff0e\n\u305d\u306e\u969b\u306e\u4f5c\u696d\u306e\u8aad\u307f\u66ff\u3048\u7b87\u6240\u306f\uff0c\u3044\u3061\u3044\u3061\u8a00\u53ca\u3059\u308b\u307e\u3067\u3082\u7121\u3044\u3060\u308d\u3046\uff0e\n\n\u624b\u98060: ~/.aws/config\n\u3053\u3093\u306a\u611f\u3058\uff0e\n[default]\naws_access_key_id=\u306a\u3044\u3057\u3087\naws_secret_access_key=\u306a\u3044\u3057\u3087\nregion=ap-northeast-1\noutput=text\n\nregion \u304c\u9055\u3046\u3068\uff0c\u4e0b\u8a18\u4f8b\u793a\u306e image-id \u3084\u3089\u306a\u306b\u3084\u3089\u5909\u66f4\u304c\u8981\u308b\u304b\u3082\u3057\u308c\u306a\u3044\uff0e\n\n\u624b\u98061: EBS\u30dc\u30ea\u30e5\u30fc\u30e0\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u884c\u3046 EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u751f\u6210\nEC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u308b\uff0e\n$ aws ec2 run-instances --image-id ami-dcfa4edd --instance-type t1.micro --security-group-ids quick-start-1 --key-name monaka\n\n--security-groups-ids \u3084 --key-name \u306f\uff0c\u3054\u81ea\u5206\u306e\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\uff0e\n--image-id \u3082\uff0c\u597d\u307f\u306e\u74b0\u5883\u304c\u3042\u308b\u306a\u3089\uff0c\u305d\u308c\u3067\uff0e\n\u3067\u3082\uff0c\u672c\u7a3f\u306e\u4f8b\u3060\u3068\u8907\u96d1\u306a\u3053\u3068\u306f\u3057\u306a\u3044\u306e\u3067\uff0cami\u306e\u9078\u629e\u306b\u51dd\u308b\u306e\u306f\u6642\u9593\u306e\u7121\u99c4\u304b\u3082\uff0e\n\u7d50\u679c\u306f\u3053\u3093\u306a\u611f\u3058\uff0e\n578606849602    r-351e1831\nGROUPS  sg-e242dbe3 quick-start-1\nINSTANCES   0   i386    None    False   xen ami-dcfa4edd    i-a3bec9a4  t1.micro    aki-ec5df7ed    monaka  2014-02-01T11:04:33.000Z    None    None    /dev/sda1   ebs None    paravirtual\nMONITORING  disabled\nPLACEMENT   ap-northeast-1b None    default\nSECURITYGROUPS  sg-e242dbe3 quick-start-1\nSTATE   0   pending\nSTATEREASON pending pending\n\n\n\u624b\u98062: \u8af8\u3005\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u5165\u308c\u308bEBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u751f\u6210\n$ aws ec2 create-volume --size 1 --availability-zone ap-northeast-1b\n\nmini-os \u306e\u30b5\u30a4\u30ba\u306f1MB\u4ee5\u4e0b\u306a\u306e\u3060\u304c\uff0cEBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u6700\u4f4e\u30b5\u30a4\u30ba\u306f1GB\uff0e\u7121\u99c4\u3060\u304c\u3084\u3080\u306a\u3057\uff0e\n\u7d50\u679c\u306f\u3053\u3093\u306a\u611f\u3058\uff0e\nap-northeast-1b 2014-02-01T10:46:19.012Z    1   None    creating    vol-1cbb4b16    standard\n\n\n\u624b\u98063: EBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u306e\u30a2\u30bf\u30c3\u30c1\n$ aws ec2 attach-volume --volume-id vol-1cbb4b16 --instance-id i-a3bec9a4 --device /dev/sdh1\n\nvol-1cbb4b16 \u306f\uff0c\u624b\u98062\u306e\u7d50\u679c\u3067\u5f97\u3089\u308c\u305f\u3082\u306e\uff0ei-a3bec9a4 \u306f\uff0c\u624b\u98061\u306e\u7d50\u679c\u3067\u5f97\u3089\u308c\u305f\u3082\u306e\uff0e\n\u7d50\u679c\u306f\u3053\u3093\u306a\u611f\u3058\uff0e\n2014-02-01T11:05:25.613Z    /dev/sdh1   i-a3bec9a4  attaching   vol-1cbb4b16\n\n\n\u624b\u98064: \u4f5c\u696d\u7528 EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u306e ssh \u30ed\u30b0\u30a4\u30f3\n\u624b\u98061\u3067\uff0c\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u305f\u76f4\u5f8c\u306f\uff0c\u30b5\u30fc\u30d0\u306eFQDN\u304c\u5224\u3089\u306a\u3044\uff0e\n\u305d\u308d\u305d\u308d\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u3082\u7d42\u308f\u3063\u3066\u3044\u308b\u306f\u305a\u306a\u306e\u3067\uff0c\u78ba\u8a8d\uff0e\n$ aws ec2 describe-instances --instance-ids i-a3bec9a4\n\n\u7d50\u679c\u306f\u3053\u3093\u306a\u611f\u3058\nRESERVATIONS    578606849602    r-351e1831\nGROUPS  sg-e242dbe3 quick-start-1\nINSTANCES   0   i386    None    False   xen ami-dcfa4edd    i-a3bec9a4  t1.micro    aki-ec5df7ed    monaka  2014-02-01T11:04:33.000Z    ip-10-132-154-11.ap-northeast-1.compute.internal    10.132.154.11   ec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com   54.199.18.76    /dev/sda1   ebs None    paravirtual\nBLOCKDEVICEMAPPINGS /dev/sda1\nEBS 2014-02-01T11:04:36.000Z    True    attached    vol-69bc4c63\nMONITORING  disabled\nPLACEMENT   ap-northeast-1b None    default\nSECURITYGROUPS  sg-e242dbe3 quick-start-1\nSTATE   16  running\n\ncompute.amazonaws.com \u3067\u7d42\u308f\u3063\u3066\u3044\u308b\u306e\u304c\uff0c\u5916\u5411\u304d\u306eFQDN\uff0e\n\u4eca\u56de\u306e\u5834\u5408\u306f\uff0cec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com\n\u306a\u306e\u3067\uff0c\u304a\u3082\u3080\u308d\u306b ssh\uff0e\nAmazon Linux \u306e\u5834\u5408\u306f\uff0c\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u306f ec2-user \u3068\u306a\u308b\uff0e\n$ ssh ec2-user@ec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com\n\n\u30b5\u30fc\u30d0\u306e\u516c\u958b\u9375\u3092\u53d7\u3051\u5165\u308c\u308b\u304b\u3069\u3046\u304b\u306a\u3069\u805e\u304b\u308c\u308b\uff0e\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\nThe authenticity of host 'ec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com (54.199.18.76)' can't be established.\nRSA key fingerprint is e8:10:70:59:ce:4b:7b:59:97:92:35:d8:35:a7:3a:92.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added 'ec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com,54.199.18.76' (RSA) to the list of known hosts.\n\n       __|  __|_  )\n       _|  (     /   Amazon Linux AMI\n      ___|\\___|___|\n\nSee /usr/share/doc/system-release/ for latest release notes.\nNo packages needed for security; 170 packages available\nAmazon Linux version 2013.09 is available.\n[ec2-user@ip-10-132-154-11 ~]$ \n\n\n\u624b\u98065: EBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30de\u30a6\u30f3\u30c8\n\u624b\u98063\u3067\u306f\uff0cEBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306f\u30a2\u30bf\u30c3\u30c1\u3057\u304b\u3057\u3066\u3044\u306a\u3044\uff0e\n\u3053\u3053\u3067\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u6210\u3057\u3066\uff0c\u30de\u30a6\u30f3\u30c8\u3059\u308b\uff0e\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u751f\u6210\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\n[ec2-user@ip-10-132-154-11 ~]$ sudo mkfs.ext2 /dev/sdh1\n\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\nmke2fs 1.41.12 (17-May-2010)\nFilesystem label=\nOS type: Linux\nBlock size=4096 (log=2)\nFragment size=4096 (log=2)\nStride=0 blocks, Stripe width=0 blocks\n65536 inodes, 262144 blocks\n13107 blocks (5.00%) reserved for the super user\nFirst data block=0\nMaximum filesystem blocks=268435456\n8 block groups\n32768 blocks per group, 32768 fragments per group\n8192 inodes per group\nSuperblock backups stored on blocks: \n    32768, 98304, 163840, 229376\n\nWriting inode tables: done                            \nWriting superblocks and filesystem accounting information: done\n\nThis filesystem will be automatically checked every 24 mounts or\n180 days, whichever comes first.  Use tune2fs -c or -i to override.\n\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306f\u3067\u304d\u305f\u306e\u3067\uff0c\u65e9\u901f\u30de\u30a6\u30f3\u30c8\uff0e\n[ec2-user@ip-10-132-154-11 ~]$ sudo mount /dev/sdh1 /mnt\n\n\u7279\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u51fa\u529b\u306a\u3069\u7121\u304f\uff0c\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\u623b\u3063\u3066\u304f\u308b\uff0e\n\n\u624b\u98066: menu.lst \u306e\u751f\u6210\nPV-GRUB \u304c\u8aad\u3080 menu.lst \u3092\uff0cEBS\u30dc\u30ea\u30e5\u30fc\u30e0(\u306e\u4e2d\u306b\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0)\u306b\u7f6e\u304f\uff0e\n\u30a8\u30c7\u30a3\u30bf\u4f7f\u3063\u3066\u3082\u3044\u3044\u3051\u308c\u3069\uff0c\u3053\u306e\u7a0b\u5ea6\u306a\u3089\u732b\u3067\u5341\u5206\uff0e\n[root@ip-10-132-154-11 ec2-user]# sudo -s\n[root@ip-10-132-154-11 ec2-user]# cat > /mnt/boot/grub/menu.lst\ndefault 0\n\ntitle MiniOS test\n        root (hd0)\n        kernel /mini-os\n[root@ip-10-132-154-11 ec2-user]# exit\n\nsudo -s \u3092\u4f7f\u3063\u305f\u306e\u3067\uff0c\u6700\u5f8c\u306b\u306f exit \u3067\uff0cec2-user \u306b\u623b\u3057\u3066\u304a\u3044\u305f\uff0e\n\n\u624b\u98067: mini-os \u306e\u30b3\u30d4\u30fc\n\u4f55\u3089\u304b\u306e\u65b9\u6cd5\u3067\u884c\u3046\uff0e\n\u3075\u3064\u3046\u306f scp \u3092\u4f7f\u3046\u3068\u601d\u3046\uff0e\n\u305d\u3057\u3066\uff0cEC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4e0a\u306e /mnt/mini-os \u306b\u914d\u7f6e\u3059\u308b\uff0e\n\u3053\u3053\u3067menu.lst \u306e\u8a18\u8ff0\u306b\u5f15\u3063\u5f35\u3089\u308c\u3066\uff0c\u3046\u3063\u304b\u308a\uff0c/mini-os \u306b\u7f6e\u3044\u305f\u308a\u3068\u304b\u3057\u306a\u3044\u3088\u3046\u306b\uff0e\n\n\u624b\u98068: \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u751f\u6210\n\u624b\u98067\u307e\u3067\u3067\uff0cEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u7528\u6e08\u307f\u3068\u306a\u308b\uff0e\n\u3060\u304b\u3089\uff0cstop-insrance \u306a\u308a terminate-instance \u306a\u308a\u3067\u843d\u3068\u3057\u3066\u3082\u3088\u3044\uff0e\n\u3051\u308c\u3069\u3082\uff0c\u6700\u521d\u306e\u52d5\u4f5c\u78ba\u8a8d\u304c\u3067\u304d\u308b\u307e\u3067\u306f\uff0c\u7acb\u3061\u4e0a\u3052\u3063\u3071\u306a\u3057\u306e\u307b\u3046\u304c\u3088\u3044\u304b\u3082\u3057\u308c\u306a\u3044\uff0e\nEC2\u306e\u8ab2\u91d1\u306f1\u6642\u9593\u5358\u4f4d\u3060\u3051\u308c\u3069\u3082\uff0c1\u6642\u9593\u4ee5\u5185\u306bn\u56de\u7acb\u3061\u4e0a\u3052\u76f4\u3059\u3068\uff0cn\u6642\u9593\u5206\u306e\u6599\u91d1\u306b\u306a\u308b\uff0e\nEC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30a2\u30bf\u30c3\u30c1\u3057\u305f\u307e\u307e\u3067\u3082\uff0c\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u53d6\u308c\u308b\uff0e\n\u305d\u3046\u3067\u306a\u3044\u3068\uff0c\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u610f\u5473\u304c\u7121\u3044\uff0e\n\u64cd\u4f5c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\n$ aws ec2 create-snapshot --volume-id vol-1cbb4b16\n\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\nNone    578606849602    None    snap-940d6c7a   2014-02-01T11:24:16.000Z    pending vol-1cbb4b16    1\n\n\n\u624b\u98069: \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u306e\u751f\u6210\n\u3044\u3088\u3044\u3088\u4f73\u5883\uff0e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u3092\u751f\u6210\u3059\u308b\uff0e\n\u6b63\u76f4\u8a00\u3046\u3068\uff0c\u3088\u304f\u8abf\u3079\u304c\u3064\u3044\u3066\u3044\u306a\u3044\u306e\u3060\u3051\u308c\u3069\uff0c\u30a4\u30e1\u30fc\u30b8\u306e\u6982\u8981\u3092\u793a\u3059json\u30d5\u30a1\u30a4\u30eb\u304c\u5fc5\u8981\u3089\u3057\u3044\uff0e\n\u77ed\u3044\u3082\u306e\u306a\u306e\u3067\uff0c\u3053\u308c\u3082\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u3092\u6301\u3061\u51fa\u3059\u307e\u3067\u3082\u306a\u3044\u306f\u305a\uff0e\n$ cat > blockdevice.json\n[\n        {\"DeviceName\":\"/dev/xvda\",\"Ebs\":{\"VolumeType\":\"standard\",\"DeleteOnTermination\":true,\"VolumeSize\":1,\"SnapshotId\":\"snap-940d6c7a\"}}\n]\n\nVolumeSize \u306f\uff0c\u6700\u521d\u306b 1GB \u3067\u4f5c\u3063\u305f\u304b\u3089\uff0eSnapshotId \u306f\uff0c\u624b\u98068\u306e\u51fa\u529b\u3068\u5408\u308f\u305b\u308b\uff0e\n\u305d\u3057\u3066\uff0c\u30a4\u30e1\u30fc\u30b8\u306e\u767b\u9332\u3092\u884c\u3046\uff0e\n$ aws ec2 register-image --root-device-name /dev/xvda --name \"Mini-os test\" --block-device-mappings file://blockdevice.json --architecture x86_64\n\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\n\nami-ef650eee\n\n\n\u624b\u980610: \u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u306e\u8d77\u52d5\n\u305d\u3057\u3066\u611f\u52d5\u306e\u30d5\u30a3\u30ca\u30fc\u30ec\uff0e\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u306e\u8d77\u52d5\uff0e\n$ aws ec2 run-instances --image-id ami-ef650eee --instance-type t1.micro --security-group-ids quick-start-1 --key-name monaka\n\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\n578606849602    r-f17d65f5\nGROUPS  sg-e242dbe3 quick-start-1\nINSTANCES   0   x86_64  None    False   xen ami-ef650eee    i-b38630b4  t1.micro    monaka  2014-02-01T11:46:28.000Z    None    None    /dev/xvda   ebs None    paravirtual\nMONITORING  disabled\nPLACEMENT   ap-northeast-1b None    default\nSECURITYGROUPS  sg-e242dbe3 quick-start-1\nSTATE   0   pending\nSTATEREASON pending pending\n\n\u3053\u308c\u3060\u3051\u3060\u3068\uff0c\u672c\u5f53\u306b\u7acb\u3061\u4e0a\u304c\u3063\u305f\u306e\u304b\u5224\u3089\u306a\u3044\uff0e\n\u30ed\u30b0\u306e\u53d6\u5f97\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\u3067\u884c\u3046\uff0e\n$ aws ec2 get-console-output --instance-id i-b38630b4\n\ni-b38630b4 \u306f\uff0c\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u306e run-instance \u306e\u7d50\u679c\u304b\u3089\u5f15\u3063\u5f35\u3063\u3066\u304f\u308b\uff0e\nmini-os \u81ea\u8eab\u306f\u5c0f\u3055\u3044\u3082\u306e\u306e\uff0cmini-os \u306e\u5b9f\u884c\u74b0\u5883\u306e\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u306b\u306f\uff0c\u305d\u3053\u305d\u3053\u306e\u6642\u9593\u304c\u304b\u304b\u308b\uff0e\n\u9045\u3044\u6642\u306f5\u5206\u4ee5\u4e0a\u304b\u304b\u308b\u306e\u3067\uff0c\u6c17\u9577\u306b\u5f85\u3064\uff0e\n\u3069\u3046\u305b1\u6642\u9593\u307e\u3067\u306f\u540c\u3058\u6599\u91d1\u3060\u304b\u3089\uff0e\n\u672c\u7a3f\u306f\uff0chttp://www.monaka.org/blog/2014/02/04/how-to-build-ebs-image/ \u3092\u8981\u7d04\u3057\u305f\u3082\u306e\u3067\u3059\uff0e\n\n# \u307e\u304f\u3089\n\nAWS EC2 \u306f\uff0c\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u3068\u3057\u3066 Xen \u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u306e\u3067\uff0cXen \u306e mini-os \u3092 Amazon EC2 \u3067\u52d5\u4f5c\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\n\u3053\u308c\u306f\uff0c\u30aa\u30ec\u30aa\u30ecOS\u3092\u30af\u30e9\u30a6\u30c9OS\u3068\u3057\u3066\u904b\u7528\u3059\u308b\u3068\u3044\u3046\uff0c\u4ffa\u5f97\u7684\u6e80\u8db3\u611f\u304c\u5f97\u3089\u308c\u308b\uff0c\u3068\u3044\u3046\u3053\u3068\u3092\u610f\u5473\u3059\u308b\uff0e\n\nAmazon \u304c\u63d0\u4f9b\u3057\u3066\u3044\u306a\u3044\u30ab\u30fc\u30cd\u30eb\u3092\u72ec\u81ea\u306b EC2 \u3067\u52d5\u4f5c\u3055\u305b\u308b\u305f\u3081\u306b\u306f\uff0c\u3069\u3046\u3084\u3089 EBS \u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u4f5c\u3089\u306d\u3070\u306a\u3089\u306a\u3044\u3089\u3057\u3044\uff0e\n\u79c1\u306f\uff0cAWS \u306e\u5358\u306a\u308b\u30e6\u30fc\u30b6\u3067\uff0c\u7d30\u304b\u3044\u3068\u3053\u308d\u306f\u3042\u307e\u308a\u8a73\u3057\u304f\u306a\u3044\uff0e\n\u3088\u3063\u3066\uff0cEBS \u30dc\u30ea\u30e5\u30fc\u30e0\u4ee5\u5916\u3067\u306e\u8d77\u52d5\u65b9\u6cd5\u3082\u3042\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u304c\u2026\uff0e\n\n\u624b\u9806\u306f\u672c\u5bb6\u30d8\u30eb\u30d7\u30da\u30fc\u30b8\u306b\u5272\u3068\u7d30\u304b\u304f\u8aac\u660e\u3055\u308c\u3066\u3044\u308b\uff0e\n\u89e3\u8aac\u30d6\u30ed\u30b0\u3082\uff0c\u30b0\u30b0\u308c\u3070\u5c71\u76db\u308a\uff0e\n\u3055\u3059\u304c\u306f\uff0c\u307f\u3093\u306a\u5927\u597d\u304dAWS\uff0e\n\n\u3060\u304c\u3057\u304b\u3057\uff0c\u6700\u8fd1\u306b\u306a\u3063\u3066\uff0cAWS \u306f\uff0c\u7ba1\u7406\u30c4\u30fc\u30eb\u3092 AWS-CLI \u3068\u3044\u3046\u3082\u306e\u306b\u7d71\u5408\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u4e00\u65b9\uff0c\u672c\u5bb6\u30d8\u30eb\u30d7\u30da\u30fc\u30b8\u306f\uff0cAWS-CLI \u3078\u306e\u5bfe\u5fdc\u304c\u5341\u5206\u306b\u3067\u304d\u3066\u3044\u306a\u3044\uff0e\n\n\u305d\u3053\u3067\uff0c\u672c\u7a3f\u3067\u306f\uff0cAWS-CLI \u3067 mini-os \u3092\u30d6\u30fc\u30c8\u3055\u305b\u308b\u305f\u3081\u306e\u624b\u9806\u3092\u8a18\u3059\uff0e\n\n# \u4f5c\u696d\n\n## \u6982\u8981\n\n\u72ec\u81ea\u306e\u30ab\u30fc\u30cd\u30eb\u3092EC2\u4e0a\u3067\u52d5\u4f5c\u3055\u305b\u308b\u305f\u3081\u306e\u30a4\u30e1\u30fc\u30b8(\u4ee5\u4e0b\uff0c\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8)\u306f\uff0cEBS \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u4f5c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\uff0e\nXen \u3067\u306f\u304a\u306a\u3058\u307f\u306e PV-GRUB \u304c\uff0c\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u4e2d\u306b\u3042\u308b boot/grub/menu.lst \u3092\u8aad\u307f\uff0c\nkernel (\u672c\u7a3f\u306e\u5834\u5408\u306f mini-os)\u3092\u30ed\u30fc\u30c9\u3057\u30d6\u30fc\u30c8\u3059\u308b\uff0e\n\u624b\u5143\u74b0\u5883\u3067EBS\u3092\u4f5c\u3063\u3066\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u304c(\u77e5\u3089\u306a\u3044)\uff0c\u3053\u3053\u3067\u306f EC2 \u4e0a\u3067 t1.micro \u3092\u7acb\u3061\u4e0a\u3052\u3066\u4f5c\u696d\u3059\u308b\uff0e\n\u4e00\u9023\u306e\u4f5c\u696d\u6642\u9593\u306f\uff0c1\u6642\u9593\u3082\u304b\u304b\u3089\u306a\u3044\uff0et1.micro \u306a\u308910\u5186\u306b\u3082\u6e80\u305f\u306a\u3044\u3088\u3046\u306a\u984d\u3060\u308d\u3046\uff0e\n\n\u672c\u7a3f\u3067\u306f\uff0c\u30d3\u30eb\u30c9\u306f\u624b\u5143\u3067\u884c\u3046\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\uff0e\u30d3\u30eb\u30c9\u74b0\u5883\u3055\u3048\u3082EC2\u4e0a\u306b\u7acb\u3066\u308b\u3068\u3044\u3046\u3053\u3068\u3082\uff0c\u3082\u3061\u308d\u3093\u3067\u304d\u308b\uff0e\n\u305d\u306e\u969b\u306e\u4f5c\u696d\u306e\u8aad\u307f\u66ff\u3048\u7b87\u6240\u306f\uff0c\u3044\u3061\u3044\u3061\u8a00\u53ca\u3059\u308b\u307e\u3067\u3082\u7121\u3044\u3060\u308d\u3046\uff0e\n\n## \u624b\u98060: ~/.aws/config\n\n\u3053\u3093\u306a\u611f\u3058\uff0e\n\n```\n[default]\naws_access_key_id=\u306a\u3044\u3057\u3087\naws_secret_access_key=\u306a\u3044\u3057\u3087\nregion=ap-northeast-1\noutput=text\n```\n\nregion \u304c\u9055\u3046\u3068\uff0c\u4e0b\u8a18\u4f8b\u793a\u306e image-id \u3084\u3089\u306a\u306b\u3084\u3089\u5909\u66f4\u304c\u8981\u308b\u304b\u3082\u3057\u308c\u306a\u3044\uff0e\n\n## \u624b\u98061: EBS\u30dc\u30ea\u30e5\u30fc\u30e0\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u884c\u3046 EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u751f\u6210\n\nEC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u308b\uff0e\n\n```shell-session\n$ aws ec2 run-instances --image-id ami-dcfa4edd --instance-type t1.micro --security-group-ids quick-start-1 --key-name monaka\n```\n\n--security-groups-ids \u3084 --key-name \u306f\uff0c\u3054\u81ea\u5206\u306e\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\uff0e\n--image-id \u3082\uff0c\u597d\u307f\u306e\u74b0\u5883\u304c\u3042\u308b\u306a\u3089\uff0c\u305d\u308c\u3067\uff0e\n\u3067\u3082\uff0c\u672c\u7a3f\u306e\u4f8b\u3060\u3068\u8907\u96d1\u306a\u3053\u3068\u306f\u3057\u306a\u3044\u306e\u3067\uff0cami\u306e\u9078\u629e\u306b\u51dd\u308b\u306e\u306f\u6642\u9593\u306e\u7121\u99c4\u304b\u3082\uff0e\n\n\u7d50\u679c\u306f\u3053\u3093\u306a\u611f\u3058\uff0e\n\n```\n578606849602\tr-351e1831\nGROUPS\tsg-e242dbe3\tquick-start-1\nINSTANCES\t0\ti386\tNone\tFalse\txen\tami-dcfa4edd\ti-a3bec9a4\tt1.micro\taki-ec5df7ed\tmonaka\t2014-02-01T11:04:33.000Z\tNone\tNone\t/dev/sda1\tebs\tNone\tparavirtual\nMONITORING\tdisabled\nPLACEMENT\tap-northeast-1b\tNone\tdefault\nSECURITYGROUPS\tsg-e242dbe3\tquick-start-1\nSTATE\t0\tpending\nSTATEREASON\tpending\tpending\n```\n\n## \u624b\u98062: \u8af8\u3005\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u5165\u308c\u308bEBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u751f\u6210\n\n```shell-session\n$ aws ec2 create-volume --size 1 --availability-zone ap-northeast-1b\n```\nmini-os \u306e\u30b5\u30a4\u30ba\u306f1MB\u4ee5\u4e0b\u306a\u306e\u3060\u304c\uff0cEBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u6700\u4f4e\u30b5\u30a4\u30ba\u306f1GB\uff0e\u7121\u99c4\u3060\u304c\u3084\u3080\u306a\u3057\uff0e\n\n\u7d50\u679c\u306f\u3053\u3093\u306a\u611f\u3058\uff0e\n\n```\nap-northeast-1b\t2014-02-01T10:46:19.012Z\t1\tNone\tcreating\tvol-1cbb4b16\tstandard\n```\n\n## \u624b\u98063: EBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u306e\u30a2\u30bf\u30c3\u30c1\n\n```shell-session\n$ aws ec2 attach-volume --volume-id vol-1cbb4b16 --instance-id i-a3bec9a4 --device /dev/sdh1\n```\nvol-1cbb4b16 \u306f\uff0c\u624b\u98062\u306e\u7d50\u679c\u3067\u5f97\u3089\u308c\u305f\u3082\u306e\uff0ei-a3bec9a4 \u306f\uff0c\u624b\u98061\u306e\u7d50\u679c\u3067\u5f97\u3089\u308c\u305f\u3082\u306e\uff0e\n\n\u7d50\u679c\u306f\u3053\u3093\u306a\u611f\u3058\uff0e\n\n```\n2014-02-01T11:05:25.613Z\t/dev/sdh1\ti-a3bec9a4\tattaching\tvol-1cbb4b16\n```\n\n## \u624b\u98064: \u4f5c\u696d\u7528 EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u306e ssh \u30ed\u30b0\u30a4\u30f3\n\n\u624b\u98061\u3067\uff0c\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7acb\u3061\u4e0a\u3052\u305f\u76f4\u5f8c\u306f\uff0c\u30b5\u30fc\u30d0\u306eFQDN\u304c\u5224\u3089\u306a\u3044\uff0e\n\u305d\u308d\u305d\u308d\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u3082\u7d42\u308f\u3063\u3066\u3044\u308b\u306f\u305a\u306a\u306e\u3067\uff0c\u78ba\u8a8d\uff0e\n\n```shell-session\n$ aws ec2 describe-instances --instance-ids i-a3bec9a4\n```\n\n\u7d50\u679c\u306f\u3053\u3093\u306a\u611f\u3058\n\n```\nRESERVATIONS\t578606849602\tr-351e1831\nGROUPS\tsg-e242dbe3\tquick-start-1\nINSTANCES\t0\ti386\tNone\tFalse\txen\tami-dcfa4edd\ti-a3bec9a4\tt1.micro\taki-ec5df7ed\tmonaka\t2014-02-01T11:04:33.000Z\tip-10-132-154-11.ap-northeast-1.compute.internal\t10.132.154.11\tec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com\t54.199.18.76\t/dev/sda1\tebs\tNone\tparavirtual\nBLOCKDEVICEMAPPINGS\t/dev/sda1\nEBS\t2014-02-01T11:04:36.000Z\tTrue\tattached\tvol-69bc4c63\nMONITORING\tdisabled\nPLACEMENT\tap-northeast-1b\tNone\tdefault\nSECURITYGROUPS\tsg-e242dbe3\tquick-start-1\nSTATE\t16\trunning\n```\ncompute.amazonaws.com \u3067\u7d42\u308f\u3063\u3066\u3044\u308b\u306e\u304c\uff0c\u5916\u5411\u304d\u306eFQDN\uff0e\n\u4eca\u56de\u306e\u5834\u5408\u306f\uff0cec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com\n\u306a\u306e\u3067\uff0c\u304a\u3082\u3080\u308d\u306b ssh\uff0e\n\nAmazon Linux \u306e\u5834\u5408\u306f\uff0c\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u306f ec2-user \u3068\u306a\u308b\uff0e\n\n```shell-session\n$ ssh ec2-user@ec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com\n```\n\n\u30b5\u30fc\u30d0\u306e\u516c\u958b\u9375\u3092\u53d7\u3051\u5165\u308c\u308b\u304b\u3069\u3046\u304b\u306a\u3069\u805e\u304b\u308c\u308b\uff0e\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\n\n```\nThe authenticity of host 'ec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com (54.199.18.76)' can't be established.\nRSA key fingerprint is e8:10:70:59:ce:4b:7b:59:97:92:35:d8:35:a7:3a:92.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added 'ec2-54-199-18-76.ap-northeast-1.compute.amazonaws.com,54.199.18.76' (RSA) to the list of known hosts.\n\n       __|  __|_  )\n       _|  (     /   Amazon Linux AMI\n      ___|\\___|___|\n\nSee /usr/share/doc/system-release/ for latest release notes.\nNo packages needed for security; 170 packages available\nAmazon Linux version 2013.09 is available.\n[ec2-user@ip-10-132-154-11 ~]$ \n```\n\n## \u624b\u98065: EBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306e\u30de\u30a6\u30f3\u30c8\n\n\u624b\u98063\u3067\u306f\uff0cEBS\u30dc\u30ea\u30e5\u30fc\u30e0\u306f\u30a2\u30bf\u30c3\u30c1\u3057\u304b\u3057\u3066\u3044\u306a\u3044\uff0e\n\u3053\u3053\u3067\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u6210\u3057\u3066\uff0c\u30de\u30a6\u30f3\u30c8\u3059\u308b\uff0e\n\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u751f\u6210\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\n\n```shell-session\n[ec2-user@ip-10-132-154-11 ~]$ sudo mkfs.ext2 /dev/sdh1\n```\n\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\n\n```\nmke2fs 1.41.12 (17-May-2010)\nFilesystem label=\nOS type: Linux\nBlock size=4096 (log=2)\nFragment size=4096 (log=2)\nStride=0 blocks, Stripe width=0 blocks\n65536 inodes, 262144 blocks\n13107 blocks (5.00%) reserved for the super user\nFirst data block=0\nMaximum filesystem blocks=268435456\n8 block groups\n32768 blocks per group, 32768 fragments per group\n8192 inodes per group\nSuperblock backups stored on blocks: \n\t32768, 98304, 163840, 229376\n\nWriting inode tables: done                            \nWriting superblocks and filesystem accounting information: done\n\nThis filesystem will be automatically checked every 24 mounts or\n180 days, whichever comes first.  Use tune2fs -c or -i to override.\n```\n\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306f\u3067\u304d\u305f\u306e\u3067\uff0c\u65e9\u901f\u30de\u30a6\u30f3\u30c8\uff0e\n\n```shell-session\n[ec2-user@ip-10-132-154-11 ~]$ sudo mount /dev/sdh1 /mnt\n```\n\n\u7279\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u51fa\u529b\u306a\u3069\u7121\u304f\uff0c\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\u623b\u3063\u3066\u304f\u308b\uff0e\n\n## \u624b\u98066: menu.lst \u306e\u751f\u6210\n\nPV-GRUB \u304c\u8aad\u3080 menu.lst \u3092\uff0cEBS\u30dc\u30ea\u30e5\u30fc\u30e0(\u306e\u4e2d\u306b\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0)\u306b\u7f6e\u304f\uff0e\n\u30a8\u30c7\u30a3\u30bf\u4f7f\u3063\u3066\u3082\u3044\u3044\u3051\u308c\u3069\uff0c\u3053\u306e\u7a0b\u5ea6\u306a\u3089\u732b\u3067\u5341\u5206\uff0e\n\n```shell-session\n[root@ip-10-132-154-11 ec2-user]# sudo -s\n[root@ip-10-132-154-11 ec2-user]# cat > /mnt/boot/grub/menu.lst\ndefault 0\n\ntitle MiniOS test\n        root (hd0)\n        kernel /mini-os\n[root@ip-10-132-154-11 ec2-user]# exit\n```\n\nsudo -s \u3092\u4f7f\u3063\u305f\u306e\u3067\uff0c\u6700\u5f8c\u306b\u306f exit \u3067\uff0cec2-user \u306b\u623b\u3057\u3066\u304a\u3044\u305f\uff0e\n\n## \u624b\u98067: mini-os \u306e\u30b3\u30d4\u30fc\n\n\u4f55\u3089\u304b\u306e\u65b9\u6cd5\u3067\u884c\u3046\uff0e\n\u3075\u3064\u3046\u306f scp \u3092\u4f7f\u3046\u3068\u601d\u3046\uff0e\n\u305d\u3057\u3066\uff0cEC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4e0a\u306e /mnt/mini-os \u306b\u914d\u7f6e\u3059\u308b\uff0e\n\u3053\u3053\u3067menu.lst \u306e\u8a18\u8ff0\u306b\u5f15\u3063\u5f35\u3089\u308c\u3066\uff0c\u3046\u3063\u304b\u308a\uff0c/mini-os \u306b\u7f6e\u3044\u305f\u308a\u3068\u304b\u3057\u306a\u3044\u3088\u3046\u306b\uff0e\n\n## \u624b\u98068: \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u751f\u6210\n\n\u624b\u98067\u307e\u3067\u3067\uff0cEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u7528\u6e08\u307f\u3068\u306a\u308b\uff0e\n\u3060\u304b\u3089\uff0cstop-insrance \u306a\u308a terminate-instance \u306a\u308a\u3067\u843d\u3068\u3057\u3066\u3082\u3088\u3044\uff0e\n\u3051\u308c\u3069\u3082\uff0c\u6700\u521d\u306e\u52d5\u4f5c\u78ba\u8a8d\u304c\u3067\u304d\u308b\u307e\u3067\u306f\uff0c\u7acb\u3061\u4e0a\u3052\u3063\u3071\u306a\u3057\u306e\u307b\u3046\u304c\u3088\u3044\u304b\u3082\u3057\u308c\u306a\u3044\uff0e\nEC2\u306e\u8ab2\u91d1\u306f1\u6642\u9593\u5358\u4f4d\u3060\u3051\u308c\u3069\u3082\uff0c1\u6642\u9593\u4ee5\u5185\u306bn\u56de\u7acb\u3061\u4e0a\u3052\u76f4\u3059\u3068\uff0cn\u6642\u9593\u5206\u306e\u6599\u91d1\u306b\u306a\u308b\uff0e\n\nEC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30a2\u30bf\u30c3\u30c1\u3057\u305f\u307e\u307e\u3067\u3082\uff0c\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306f\u53d6\u308c\u308b\uff0e\n\u305d\u3046\u3067\u306a\u3044\u3068\uff0c\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u306e\u610f\u5473\u304c\u7121\u3044\uff0e\n\n\u64cd\u4f5c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\n\n```shell-session\n$ aws ec2 create-snapshot --volume-id vol-1cbb4b16\n```\n\n```\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\nNone\t578606849602\tNone\tsnap-940d6c7a\t2014-02-01T11:24:16.000Z\tpending\tvol-1cbb4b16\t1\n```\n\n## \u624b\u98069: \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u306e\u751f\u6210\n\n\u3044\u3088\u3044\u3088\u4f73\u5883\uff0e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u304b\u3089\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u3092\u751f\u6210\u3059\u308b\uff0e\n\u6b63\u76f4\u8a00\u3046\u3068\uff0c\u3088\u304f\u8abf\u3079\u304c\u3064\u3044\u3066\u3044\u306a\u3044\u306e\u3060\u3051\u308c\u3069\uff0c\u30a4\u30e1\u30fc\u30b8\u306e\u6982\u8981\u3092\u793a\u3059json\u30d5\u30a1\u30a4\u30eb\u304c\u5fc5\u8981\u3089\u3057\u3044\uff0e\n\u77ed\u3044\u3082\u306e\u306a\u306e\u3067\uff0c\u3053\u308c\u3082\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u3092\u6301\u3061\u51fa\u3059\u307e\u3067\u3082\u306a\u3044\u306f\u305a\uff0e\n\n```shell-session\n$ cat > blockdevice.json\n[\n        {\"DeviceName\":\"/dev/xvda\",\"Ebs\":{\"VolumeType\":\"standard\",\"DeleteOnTermination\":true,\"VolumeSize\":1,\"SnapshotId\":\"snap-940d6c7a\"}}\n]\n```\n\nVolumeSize \u306f\uff0c\u6700\u521d\u306b 1GB \u3067\u4f5c\u3063\u305f\u304b\u3089\uff0eSnapshotId \u306f\uff0c\u624b\u98068\u306e\u51fa\u529b\u3068\u5408\u308f\u305b\u308b\uff0e\n\n\u305d\u3057\u3066\uff0c\u30a4\u30e1\u30fc\u30b8\u306e\u767b\u9332\u3092\u884c\u3046\uff0e\n\n```shell-session\n$ aws ec2 register-image --root-device-name /dev/xvda --name \"Mini-os test\" --block-device-mappings file://blockdevice.json --architecture x86_64\n```\n\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\uff0e\n```\nami-ef650eee\n```\n\n## \u624b\u980610: \u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u306e\u8d77\u52d5\n\n\u305d\u3057\u3066\u611f\u52d5\u306e\u30d5\u30a3\u30ca\u30fc\u30ec\uff0e\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u306e\u8d77\u52d5\uff0e\n\n```shell-session\n$ aws ec2 run-instances --image-id ami-ef650eee --instance-type t1.micro --security-group-ids quick-start-1 --key-name monaka\n```\n\n\u7d50\u679c\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\n\n```\n578606849602\tr-f17d65f5\nGROUPS\tsg-e242dbe3\tquick-start-1\nINSTANCES\t0\tx86_64\tNone\tFalse\txen\tami-ef650eee\ti-b38630b4\tt1.micro\tmonaka\t2014-02-01T11:46:28.000Z\tNone\tNone\t/dev/xvda\tebs\tNone\tparavirtual\nMONITORING\tdisabled\nPLACEMENT\tap-northeast-1b\tNone\tdefault\nSECURITYGROUPS\tsg-e242dbe3\tquick-start-1\nSTATE\t0\tpending\nSTATEREASON\tpending\tpending\n```\n\n\u3053\u308c\u3060\u3051\u3060\u3068\uff0c\u672c\u5f53\u306b\u7acb\u3061\u4e0a\u304c\u3063\u305f\u306e\u304b\u5224\u3089\u306a\u3044\uff0e\n\n\u30ed\u30b0\u306e\u53d6\u5f97\u306f\uff0c\u3053\u3093\u306a\u611f\u3058\u3067\u884c\u3046\uff0e\n\n```\n$ aws ec2 get-console-output --instance-id i-b38630b4\n```\n\ni-b38630b4 \u306f\uff0c\u30aa\u30ec\u30aa\u30ec\u30a4\u30e1\u30fc\u30b8\u306e run-instance \u306e\u7d50\u679c\u304b\u3089\u5f15\u3063\u5f35\u3063\u3066\u304f\u308b\uff0e\n\nmini-os \u81ea\u8eab\u306f\u5c0f\u3055\u3044\u3082\u306e\u306e\uff0cmini-os \u306e\u5b9f\u884c\u74b0\u5883\u306e\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u306b\u306f\uff0c\u305d\u3053\u305d\u3053\u306e\u6642\u9593\u304c\u304b\u304b\u308b\uff0e\n\u9045\u3044\u6642\u306f5\u5206\u4ee5\u4e0a\u304b\u304b\u308b\u306e\u3067\uff0c\u6c17\u9577\u306b\u5f85\u3064\uff0e\n\u3069\u3046\u305b1\u6642\u9593\u307e\u3067\u306f\u540c\u3058\u6599\u91d1\u3060\u304b\u3089\uff0e\n", "tags": ["aws-cli", "AWS_SDK", "Xen", "EC2"]}