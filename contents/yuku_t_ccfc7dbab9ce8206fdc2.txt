{"tags": ["Mac", "Excel", "Automator"], "context": " More than 1 year has passed since last update.\u8a73\u3057\u3044\u4e8b\u60c5\u306fWin/Mac \u3069\u3061\u3089\u306e Excel \u3067\u3082\u6b63\u3057\u304f\u958b\u3051\u308b Unicode \u306a csv \u306e\u51fa\u529b\u65b9\u6cd5\u3092\u53c2\u7167\u3057\u3066\u6b32\u3057\u3044\u306e\u3060\u3051\u3069\u3001Mac\u306eExcel\u3067Unicode\u306acsv\u3092\u9069\u5207\u306b\u958b\u304f\u306b\u306fUTF-16LE\u306atsv\u306b\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\u3069\u3046\u3057\u3066\u3082UTF-8\u306acsv\u3092\u5410\u304d\u51fa\u3059\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308a\u3001\u6bce\u56de\u5909\u63db\u3059\u308b\u306e\u304c\u9762\u5012\u306a\u306e\u3067Automator\u3067\u81ea\u52d5\u5316\u3057\u307e\u3057\u305f\u3002\n\n1. nkf\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u5909\u63db\u306b nkf \u3092\u4f7f\u3046\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nbrew install nkf\n\n\n2. Automator\u3092\u8d77\u52d5\u3057\u3066\u30b5\u30fc\u30d3\u30b9\u3092\u4f5c\u308b\n\n\n3. Utilities\u306eRun Shell Script\u3092\u30c9\u30e9\u30c3\u30b0\u30c9\u30ed\u30c3\u30d7\n\n\n4. Pass input: as arguments\u3092\u9078\u629e\u3057\u3066\u30b3\u30fc\u30c9\u3092\u66f8\u304f\n\nfor file\ndo\n    ruby -Ku -e \"require 'csv';CSV.foreach('$file', 'r') { |r| puts r.join(\\\"\\t\\\") }\" > ${file}-tmp\n    /usr/local/bin/nkf -w16 ${file}-tmp > $file\n    rm ${file}-tmp\ndone\n\n\u753b\u9762\u4e0a\u306eService receives selected\u3092documents\u306b\u5909\u66f4\u3059\u308b\u3002\n\u3042\u3068\u7d42\u308f\u3063\u305f\u3053\u3068\u3092\u77e5\u3089\u305b\u308b\u305f\u3081\u306b\u4f55\u304b\u9078\u3076\u3002\u3053\u3053\u3067\u306f'Display Notification'\u3092\u4f7f\u3063\u3066\u308b\u3002\n\u753b\u50cf\u306e\u4e2d\u3067nkf\u306e\u4f4d\u7f6e\u304c/opt/boxen\u306e\u4e2d\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u306f\u3001\u50d5\u306eMac\u306fBoxen\u3092\u4f7f\u3063\u3066\u30bb\u30c3\u30c8\u3057\u3066\u3044\u308b\u305f\u3081\u3002\u3088\u308a\u6b63\u78ba\u306b\u306f\u4e0b\u8a18\u3092\u5b9f\u884c\u3059\u308b\u3068\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u5165\u308b\u3082\u306e\u3092\u30da\u30fc\u30b9\u30c8\u3059\u308b\u3068\u3044\u3044\u3067\u3059\u3002\nwhich nkf | pbcopy\n\n\n5. \u4fdd\u5b58\u3059\u308b\n\u2318+S\u3092\u62bc\u3057\u3066\u9069\u5f53\u306a\u540d\u524d\u3092\u3064\u3051\u308b\u3002\u3053\u3053\u3067\u306futf16\u3066\u540d\u524d\u306b\u3057\u305f\u3002\n\n6. \u9069\u5f53\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u53f3\u30af\u30ea\u30c3\u30af\n\n\u51fa\u3066\u304d\u305futf16\u3092\u30af\u30ea\u30c3\u30af\u3057\u305f\u3089\u7d42\u308f\u308a\u3002\u3042\u3068\u306fExcel\u3067\u958b\u304f\u3060\u3051\u3002\n\u8a73\u3057\u3044\u4e8b\u60c5\u306f[Win/Mac \u3069\u3061\u3089\u306e Excel \u3067\u3082\u6b63\u3057\u304f\u958b\u3051\u308b Unicode \u306a csv \u306e\u51fa\u529b\u65b9\u6cd5](http://qiita.com/mashiro/items/0d0b9bbb0f4a6cca620c)\u3092\u53c2\u7167\u3057\u3066\u6b32\u3057\u3044\u306e\u3060\u3051\u3069\u3001Mac\u306eExcel\u3067Unicode\u306acsv\u3092\u9069\u5207\u306b\u958b\u304f\u306b\u306fUTF-16LE\u306atsv\u306b\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\n\u3069\u3046\u3057\u3066\u3082UTF-8\u306acsv\u3092\u5410\u304d\u51fa\u3059\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308a\u3001\u6bce\u56de\u5909\u63db\u3059\u308b\u306e\u304c\u9762\u5012\u306a\u306e\u3067Automator\u3067\u81ea\u52d5\u5316\u3057\u307e\u3057\u305f\u3002\n\n### 1. nkf\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u5909\u63db\u306b [nkf](http://sourceforge.jp/projects/nkf/) \u3092\u4f7f\u3046\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\nbrew install nkf\n```\n\n### 2. Automator\u3092\u8d77\u52d5\u3057\u3066\u30b5\u30fc\u30d3\u30b9\u3092\u4f5c\u308b\n\n![Screen Shot 2013-11-28 at 5.36.31 PM.png](https://qiita-image-store.s3.amazonaws.com/0/153/1a5fe464-cb95-451d-23f7-6ec7d2dfc953.png)\n\n### 3. Utilities\u306eRun Shell Script\u3092\u30c9\u30e9\u30c3\u30b0\u30c9\u30ed\u30c3\u30d7\n\n![Screen Shot 2013-11-28 at 5.41.14 PM.png](https://qiita-image-store.s3.amazonaws.com/0/153/4a7a5afa-add1-cee0-91d8-ead308f1c3ef.png)\n\n### 4. Pass input: as arguments\u3092\u9078\u629e\u3057\u3066\u30b3\u30fc\u30c9\u3092\u66f8\u304f\n\n ![Screen Shot 2013-11-28 at 5.37.27 PM.png](https://qiita-image-store.s3.amazonaws.com/0/153/816a28be-911d-8959-4f7b-a89327e79a44.png)\n\n```bash\nfor file\ndo\n\truby -Ku -e \"require 'csv';CSV.foreach('$file', 'r') { |r| puts r.join(\\\"\\t\\\") }\" > ${file}-tmp\n\t/usr/local/bin/nkf -w16 ${file}-tmp > $file\n\trm ${file}-tmp\ndone\n```\n\n\u753b\u9762\u4e0a\u306eService receives selected\u3092documents\u306b\u5909\u66f4\u3059\u308b\u3002\n\u3042\u3068\u7d42\u308f\u3063\u305f\u3053\u3068\u3092\u77e5\u3089\u305b\u308b\u305f\u3081\u306b\u4f55\u304b\u9078\u3076\u3002\u3053\u3053\u3067\u306f'Display Notification'\u3092\u4f7f\u3063\u3066\u308b\u3002\n\u753b\u50cf\u306e\u4e2d\u3067nkf\u306e\u4f4d\u7f6e\u304c/opt/boxen\u306e\u4e2d\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u306f\u3001\u50d5\u306eMac\u306fBoxen\u3092\u4f7f\u3063\u3066\u30bb\u30c3\u30c8\u3057\u3066\u3044\u308b\u305f\u3081\u3002\u3088\u308a\u6b63\u78ba\u306b\u306f\u4e0b\u8a18\u3092\u5b9f\u884c\u3059\u308b\u3068\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u5165\u308b\u3082\u306e\u3092\u30da\u30fc\u30b9\u30c8\u3059\u308b\u3068\u3044\u3044\u3067\u3059\u3002\n\n```bash\nwhich nkf | pbcopy\n```\n\n### 5. \u4fdd\u5b58\u3059\u308b\n\n\u2318+S\u3092\u62bc\u3057\u3066\u9069\u5f53\u306a\u540d\u524d\u3092\u3064\u3051\u308b\u3002\u3053\u3053\u3067\u306futf16\u3066\u540d\u524d\u306b\u3057\u305f\u3002\n\n### 6. \u9069\u5f53\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u53f3\u30af\u30ea\u30c3\u30af\n\n![Untitled.png](https://qiita-image-store.s3.amazonaws.com/0/153/33aaf113-5485-652d-ce27-e081dce13d2e.png)\n\n\u51fa\u3066\u304d\u305futf16\u3092\u30af\u30ea\u30c3\u30af\u3057\u305f\u3089\u7d42\u308f\u308a\u3002\u3042\u3068\u306fExcel\u3067\u958b\u304f\u3060\u3051\u3002\n"}