{"context": " More than 1 year has passed since last update.\n\n\u3069\u3053\u304b\u304b\u3089\u306e\u9858\u3044\n\u4e2d\u56fd\u3067\u3082Facebook\u3067\"\u3044\u3044\u306d\"\u3057\u305f\u3044\u3058\u3083\u306a\u3044\u3067\u3059\u304b\uff5e(\u307b\u3093\u3068\u306f\u9055\u3046\u7406\u7531\u3060\u3051\u3069\u30fb\u30fb)\n\u3068\u3044\u3046\u3053\u3068\u3067VPN & Proxy\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\u5165\u308c\u308b\u306e\u306fxl2tpd,openswan,squid\u3067\u3054\u3056\u3044\u307e\u3059\u3002\n\u3068\u306b\u304b\u304f\u3055\u3063\u3055\u3068\u4f5c\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u7c21\u5358\u306a\u65b9\u6cd5\u3067\u3044\u304d\u307e\u3059\u3002\n\n\u3077\u3089\u3063\u3068\u3075\u3049\u30fc\u3080\n\u74b0\u5883\u306fAWS\u3067\nAMI\u306f\u306a\u305c\u304bCentos\u3060\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u306e\u3067(\u591a\u5206\u81ea\u5206\u306e\u554f\u984c\u30fb\u30fb)AmazonLinux\u3067\namzn-ami-hvm-2015.03.0.x86_64-gp2\n\n\u524d\u6e96\u5099\niptables \u6b62\u3081\u308b\nSELINUX \u6b62\u3081\u308b\n\u3053\u306e\u8fba\u3092\u5165\u308c\u3066\u304a\u304f\nyum install make gcc gmp-devel bison flex\n\nsysctl.conf\u306b\u3053\u306e\u8fba\u8ffd\u8a18\u3057\u3066sysctl -p\nnet.ipv4.ip_forward = 1\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.lo.send_redirects = 0\nnet.ipv4.conf.eth0.send_redirects = 0\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.lo.accept_redirects = 0\nnet.ipv4.conf.eth0.accept_redirects = 0\n\n\u3044\u3063\u305f\u3093\u30ea\u30d6\u30fc\u30c8\n\nyum\n\u305d\u3046\u3002yum\u3067\u3059\u3088\u3002yum\u3002\nepel\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u3066\nyum install --enablerepo=epel openswan xl2tpd squid\n\n\u306f\u3044\u3001\u5165\u3063\u305f\u306d\nchkconfig xl2tpd on\nchkconfig ipsec on\nchkconfig squid on\n\n\n\u8a2d\u5b9a\n\nipsec\u306e\u8a2d\u5b9a\nconf\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7de8\u96c6\nvirtual_private=**\u306f\u8a31\u53ef\u3059\u308b\u30a2\u30c9\u30ec\u30b9\u30ec\u30f3\u30b8\u306a\u306e\u3067\u9069\u5b9c\u5909\u3048\u3066\u3042\u3052\u308b\n# cat /etc/ipsec.conf\nversion 2.0\n\nconfig setup\n    dumpdir=/var/run/pluto\n    nat_traversal=yes\n    virtual_private=%v4:10.0.0.0/8,%v4:192.168.0.0/16,%v4:172.16.0.0/12,%v4:25.0.0.0/8,%v6:fd00::/8,%v6:fe80::/10\n    protostack=netkey\ninclude /etc/ipsec.d/*.conf\n\n\u3053\u308c\u306fiOS\u7528\u306b\u5fc5\u8981\u306a\u8a2d\u5b9a\u3068\u306a\u308b\n    dpddelay=10\n    dpdtimeout=20\n    dpdaction=clear\nleft\u306b\u306f\u30b5\u30fc\u30d0\u30fc\u306ePrivateIP\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u308c\u308b\nleftnexthop\u306b\u306f\u3053\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30c7\u30d5\u30a9\u30b2\u3092\u5165\u308c\u308b\n# cat /etc/ipsec.d/l2tp-ipsec.conf\nconn L2TP-PSK-NAT\n    rightsubnet=vhost:%priv\n    dpddelay=10\n    dpdtimeout=20\n    dpdaction=clear\n    also=L2TP-PSK-noNAT\n\nconn L2TP-PSK-noNAT\n        authby=secret\n        pfs=no\n        auto=add\n        keyingtries=3\n        ikelifetime=8h\n        keylife=1h\n        type=transport\n        left=\u3053\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\n        leftnexthop=\u30c7\u30d5\u30a9\u30b2\n        leftprotoport=17/1701\n        right=%any\n        rightprotoport=17/%any\n\n\n\u4e8b\u524d\u5171\u6709\u9375\u306e\u8a2d\u5b9a\n\u4f8b\u3048\u3070foobar\n\u5b9f\u6a5f\u306f\u3082\u3063\u3068\u8907\u96d1\u306a\u306e\u306b\u3057\u3088\u3046\uff01\n# cat /etc/ipsec.secrets\n: PSK   \"foobar\"\n\n\nxl2tpd\u306e\u8a2d\u5b9a\nip range\u304cVPN\u63a5\u7d9a\u5f8c\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u632f\u3089\u308c\u308bIP\u30a2\u30c9\u30ec\u30b9\u30ec\u30f3\u30b8\nlocal ip\u304cVPN\u63a5\u7d9a\u6642\u306e\u30b5\u30fc\u30d0\u30fc\u5074\u306eIP\u30a2\u30c9\u30ec\u30b9\n# cat /etc/xl2tpd/xl2tpd.conf\n[global]\nauth file = /etc/ppp/chap-secrets\n[lns default]\nip range = 192.168.1.128-192.168.1.254\nlocal ip = 192.168.1.99\nrequire chap = yes\nrefuse pap = yes\nrequire authentication = yes\nppp debug = yes\npppoptfile = /etc/ppp/options.xl2tpd\nlength bit = yes\n\n\nxl2tpd\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u8a2d\u5b9a\noption\u3067VPN\u63a5\u7d9a\u540d(\u4f8b\u3048\u3070foovpn)\u3084VPN\u63a5\u7d9a\u5f8c\u306eDNS\u3084\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\u3002\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304b\u306a\u304f\u3066\u3082\u3044\u3044\u3051\u3069\u3001\u3001\u3068\u306b\u304b\u304f\u30d5\u30a1\u30a4\u30eb\u304c\u6563\u3063\u3066\u308b\u306a\u3041\n\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306ftouch\u3057\u3066\u304a\u304f\ntouch /var/log/xl2tpd.log\n[root@z-prd-vpnproxy01 squid]# cat /etc/ppp/options.xl2tpd\nname foovpn\nipcp-accept-local\nipcp-accept-remote\nms-dns  8.8.8.8\nauth\ncrtscts\nidle 1800\nmtu 1410\nmru 1410\nnodefaultroute\ndebug\nlock\nproxyarp\nconnect-delay 5000\nlogfile /var/log/xl2tpd.log\n\n\u63a5\u7d9a\u30e6\u30fc\u30b6\u30fc\u306f\"foo\"\n\u63a5\u7d9aVPN\u540d\u306f\"foovpn\"\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\"bar\"\n\u63a5\u7d9a\u5143IP\u30a2\u30c9\u30ec\u30b9\u306f\u9650\u5b9a\u305b\u305a*\n# cat /etc/ppp/chap-secrets\n# Secrets for authentication using CHAP\n# client        server  secret                  IP addresses\n\"foo\" \"foovpn\" \"bar\" *\n\n\nsquid\n\u307b\u307c\u30c7\u30d5\u30a9\n\u5909\u3048\u305f\u3068\u3053\u308d\u306f\u3053\u3053\u3060\u3051\n# cat /etc/squid/squid.conf\n#http_port 3128                                             \nhttp_port 0.0.0.0:8080\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\n\u3053\u3061\u3089\u3092\u89e3\u653e\n500:udp\n4500:udp\n1701:udp\n\n\u3055\u3042\u8d77\u52d5\n\n\u505c\u6b62\u3068\u8d77\u52d5\n/etc/init.d/squid stop\n/etc/init.d/xl2tpd stop\n/etc/init.d/ipsec stop\n\n/etc/init.d/squid start\n/etc/init.d/xl2tpd start\n/etc/init.d/ipsec start\n\n\n\u78ba\u8a8d\nipsec\u78ba\u8a8d\n\u4ee5\u4e0b\u30b3\u30de\u30f3\u30c9\u3067failed\u3068\u304b\u3042\u3063\u305f\u3089\u8a2d\u5b9a\u898b\u76f4\u305d\u3046\n# ipsec verify\nChecking your system to see if IPsec got installed and started correctly:\nVersion check and ipsec on-path                                 [OK]\nLinux Openswan U2.6.37/K3.14.35-28.38.amzn1.x86_64 (netkey)\nChecking for IPsec support in kernel                            [OK]\n SAref kernel support                                           [N/A]\n NETKEY:  Testing XFRM related proc values                      [OK]\n        [OK]\n        [OK]\nChecking that pluto is running                                  [OK]\n Pluto listening for IKE on udp 500                             [OK]\n Pluto listening for NAT-T on udp 4500                          [OK]\nChecking for 'ip' command                                       [OK]\nChecking /bin/sh is not /bin/dash                               [OK]\nChecking for 'iptables' command                                 [OK]\nOpportunistic Encryption Support                                [DISABLED]\n\n\n\u63a5\u7d9a\n\niPhone\u304b\u3089\niPhone\u304b\u3089\u306f\u8d85\u7d76\u7c21\u5358\uff01\niphone\u306e\u8a2d\u5b9a -> \u4e00\u822c -> VPN -> \"VPN\u69cb\u6210\u3092\u8ffd\u52a0\"\u3092\u62bc\u3059\u3002\n\u4ee5\u4e0b\u306e\u753b\u9762\u306b\u306a\u308b\u306e\u3067\u3001\u5fc5\u8981\u306a\u5024\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u8aac\u660e\u306b\u306fVPN\u540d\uff1afoovpn\n\u30b5\u30fc\u30d0\u30fc\u306b\u306f\uff1aVPN\u30b5\u30fc\u30d0\u30fc\u306e\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\n\u30a2\u30ab\u30a6\u30f3\u30c8\uff1afoo\n\u30d1\u30b9\u30ef\u30fc\u30c9\uff1abar\n\n\u30d7\u30ed\u30ad\u30b7\u306b\u306f\"\u624b\u52d5\"\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n\u5fc5\u8981\u306a\u60c5\u5831\u3092\u5165\u308c\u307e\u3059\u3002\n\u30b5\u30fc\u30d0\u30fc\u306b\u306fVPN\u8cbc\u3063\u305f\u3042\u3068\u306eIP\u30a2\u30c9\u30ec\u30b9\uff1a192.168.1.99\n\u30dd\u30fc\u30c8\u306fsquid\u3067\u8a2d\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\uff1a8080\n\n\u3042\u3068\u306fVPN\u63a5\u7d9a\u3059\u308c\u3070OK\u3067\u3059\u3002\nping\u3082\u98db\u3073\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b8\u30f3\u30b0\u3082OK\n\n\nWindows\u306f\u3084\u3063\u304b\u3044\u3002\u3002\nVPN\u63a5\u7d9a\u958b\u59cb\u6642\u306b\"809\u30b5\u30fc\u30d0\u30fc\u5fdc\u7b54\u306a\u3057\"\u30a8\u30e9\u30fc\u767a\u751f\u3002\u3002\n\n\u3076\u3063\u3061\u3083\u3051\u3053\u3061\u3089\u306e\u30b5\u30a4\u30c8\u306b\u52a9\u3051\u3066\u9802\u304d\u307e\u3057\u305f\u3002\u3042\u308a\u304c\u305f\u3084\uff5e\nhttp://reffi.jp/archives/308\n\u30ec\u30b8\u30b9\u30c8\u30ea\u3092\u5909\u3048\u308b\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PolicyAgent \u306e\nAssumeUDPEncapsulationContextOnSendRule \u3092\n\"2\"\n\u30d7\u30ed\u30ad\u30b7\u8a2d\u5b9a\u3092VPN\u5358\u4f4d\u306b\u884c\u3046\u3053\u3068\u3067OK\uff01\n\u3042\u3068\u306f\u826f\u597d\u826f\u597d^^\n\u3061\u3083\u3093\u3061\u3083\u3093\n## \u3069\u3053\u304b\u304b\u3089\u306e\u9858\u3044\n\n\u4e2d\u56fd\u3067\u3082Facebook\u3067\"\u3044\u3044\u306d\"\u3057\u305f\u3044\u3058\u3083\u306a\u3044\u3067\u3059\u304b\uff5e(\u307b\u3093\u3068\u306f\u9055\u3046\u7406\u7531\u3060\u3051\u3069\u30fb\u30fb)\n\n\n\u3068\u3044\u3046\u3053\u3068\u3067VPN & Proxy\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\u5165\u308c\u308b\u306e\u306fxl2tpd,openswan,squid\u3067\u3054\u3056\u3044\u307e\u3059\u3002\n\u3068\u306b\u304b\u304f\u3055\u3063\u3055\u3068\u4f5c\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u7c21\u5358\u306a\u65b9\u6cd5\u3067\u3044\u304d\u307e\u3059\u3002\n\n## \u3077\u3089\u3063\u3068\u3075\u3049\u30fc\u3080\n\n\u74b0\u5883\u306fAWS\u3067\nAMI\u306f\u306a\u305c\u304bCentos\u3060\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u306e\u3067(\u591a\u5206\u81ea\u5206\u306e\u554f\u984c\u30fb\u30fb)AmazonLinux\u3067\namzn-ami-hvm-2015.03.0.x86_64-gp2\n\n## \u524d\u6e96\u5099\n\niptables \u6b62\u3081\u308b\nSELINUX \u6b62\u3081\u308b\n\n\u3053\u306e\u8fba\u3092\u5165\u308c\u3066\u304a\u304f\n\n```\nyum install make gcc gmp-devel bison flex\n```\n\nsysctl.conf\u306b\u3053\u306e\u8fba\u8ffd\u8a18\u3057\u3066sysctl -p\n\n```\nnet.ipv4.ip_forward = 1\n```\n\n```\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.lo.send_redirects = 0\nnet.ipv4.conf.eth0.send_redirects = 0\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.lo.accept_redirects = 0\nnet.ipv4.conf.eth0.accept_redirects = 0\n```\n\n\u3044\u3063\u305f\u3093\u30ea\u30d6\u30fc\u30c8\n\n## yum\n\n\u305d\u3046\u3002yum\u3067\u3059\u3088\u3002yum\u3002\nepel\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u3066\n\n```\nyum install --enablerepo=epel openswan xl2tpd squid\n```\n\n\u306f\u3044\u3001\u5165\u3063\u305f\u306d\n\n```\nchkconfig xl2tpd on\nchkconfig ipsec on\nchkconfig squid on\n```\n\n## \u8a2d\u5b9a\n\n### ipsec\u306e\u8a2d\u5b9a\n\nconf\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7de8\u96c6\nvirtual_private=**\u306f\u8a31\u53ef\u3059\u308b\u30a2\u30c9\u30ec\u30b9\u30ec\u30f3\u30b8\u306a\u306e\u3067\u9069\u5b9c\u5909\u3048\u3066\u3042\u3052\u308b\n\n```\n# cat /etc/ipsec.conf\nversion 2.0\n\nconfig setup\n    dumpdir=/var/run/pluto\n    nat_traversal=yes\n    virtual_private=%v4:10.0.0.0/8,%v4:192.168.0.0/16,%v4:172.16.0.0/12,%v4:25.0.0.0/8,%v6:fd00::/8,%v6:fe80::/10\n    protostack=netkey\ninclude /etc/ipsec.d/*.conf\n```\n\n\u3053\u308c\u306fiOS\u7528\u306b\u5fc5\u8981\u306a\u8a2d\u5b9a\u3068\u306a\u308b\n    dpddelay=10\n    dpdtimeout=20\n    dpdaction=clear\n\nleft\u306b\u306f\u30b5\u30fc\u30d0\u30fc\u306ePrivateIP\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u308c\u308b\nleftnexthop\u306b\u306f\u3053\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30c7\u30d5\u30a9\u30b2\u3092\u5165\u308c\u308b\n\n```\n# cat /etc/ipsec.d/l2tp-ipsec.conf\nconn L2TP-PSK-NAT\n    rightsubnet=vhost:%priv\n    dpddelay=10\n    dpdtimeout=20\n    dpdaction=clear\n    also=L2TP-PSK-noNAT\n\nconn L2TP-PSK-noNAT\n        authby=secret\n        pfs=no\n        auto=add\n        keyingtries=3\n        ikelifetime=8h\n        keylife=1h\n        type=transport\n        left=\u3053\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\n        leftnexthop=\u30c7\u30d5\u30a9\u30b2\n        leftprotoport=17/1701\n        right=%any\n        rightprotoport=17/%any\n```\n\n### \u4e8b\u524d\u5171\u6709\u9375\u306e\u8a2d\u5b9a\n\n\u4f8b\u3048\u3070foobar\n\u5b9f\u6a5f\u306f\u3082\u3063\u3068\u8907\u96d1\u306a\u306e\u306b\u3057\u3088\u3046\uff01\n\n```\n# cat /etc/ipsec.secrets\n: PSK   \"foobar\"\n```\n\n### xl2tpd\u306e\u8a2d\u5b9a\n\nip range\u304cVPN\u63a5\u7d9a\u5f8c\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u632f\u3089\u308c\u308bIP\u30a2\u30c9\u30ec\u30b9\u30ec\u30f3\u30b8\nlocal ip\u304cVPN\u63a5\u7d9a\u6642\u306e\u30b5\u30fc\u30d0\u30fc\u5074\u306eIP\u30a2\u30c9\u30ec\u30b9\n\n```\n# cat /etc/xl2tpd/xl2tpd.conf\n[global]\nauth file = /etc/ppp/chap-secrets\n[lns default]\nip range = 192.168.1.128-192.168.1.254\nlocal ip = 192.168.1.99\nrequire chap = yes\nrefuse pap = yes\nrequire authentication = yes\nppp debug = yes\npppoptfile = /etc/ppp/options.xl2tpd\nlength bit = yes\n```\n\n### xl2tpd\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u8a2d\u5b9a\n\noption\u3067VPN\u63a5\u7d9a\u540d(\u4f8b\u3048\u3070foovpn)\u3084VPN\u63a5\u7d9a\u5f8c\u306eDNS\u3084\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\u3002\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304b\u306a\u304f\u3066\u3082\u3044\u3044\u3051\u3069\u3001\u3001\u3068\u306b\u304b\u304f\u30d5\u30a1\u30a4\u30eb\u304c\u6563\u3063\u3066\u308b\u306a\u3041\n\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306ftouch\u3057\u3066\u304a\u304f\ntouch /var/log/xl2tpd.log\n\n```\n[root@z-prd-vpnproxy01 squid]# cat /etc/ppp/options.xl2tpd\nname foovpn\nipcp-accept-local\nipcp-accept-remote\nms-dns  8.8.8.8\nauth\ncrtscts\nidle 1800\nmtu 1410\nmru 1410\nnodefaultroute\ndebug\nlock\nproxyarp\nconnect-delay 5000\nlogfile /var/log/xl2tpd.log\n```\n\n\u63a5\u7d9a\u30e6\u30fc\u30b6\u30fc\u306f\"foo\"\n\u63a5\u7d9aVPN\u540d\u306f\"foovpn\"\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\"bar\"\n\u63a5\u7d9a\u5143IP\u30a2\u30c9\u30ec\u30b9\u306f\u9650\u5b9a\u305b\u305a*\n\n```\n# cat /etc/ppp/chap-secrets\n# Secrets for authentication using CHAP\n# client        server  secret                  IP addresses\n\"foo\" \"foovpn\" \"bar\" *\n```\n\n### squid\n\n\u307b\u307c\u30c7\u30d5\u30a9\n\u5909\u3048\u305f\u3068\u3053\u308d\u306f\u3053\u3053\u3060\u3051\n\n```\n# cat /etc/squid/squid.conf\n#http_port 3128                                             \nhttp_port 0.0.0.0:8080\n```\n\n\n\n## \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\n\n\u3053\u3061\u3089\u3092\u89e3\u653e\n\n```\n500:udp\n4500:udp\n1701:udp\n```\n\n\u3055\u3042\u8d77\u52d5\n\n## \u505c\u6b62\u3068\u8d77\u52d5\n\n```\n/etc/init.d/squid stop\n/etc/init.d/xl2tpd stop\n/etc/init.d/ipsec stop\n```\n\n```\n/etc/init.d/squid start\n/etc/init.d/xl2tpd start\n/etc/init.d/ipsec start\n```\n\n### \u78ba\u8a8d\n\nipsec\u78ba\u8a8d\n\u4ee5\u4e0b\u30b3\u30de\u30f3\u30c9\u3067failed\u3068\u304b\u3042\u3063\u305f\u3089\u8a2d\u5b9a\u898b\u76f4\u305d\u3046\n\n```\n# ipsec verify\nChecking your system to see if IPsec got installed and started correctly:\nVersion check and ipsec on-path                                 [OK]\nLinux Openswan U2.6.37/K3.14.35-28.38.amzn1.x86_64 (netkey)\nChecking for IPsec support in kernel                            [OK]\n SAref kernel support                                           [N/A]\n NETKEY:  Testing XFRM related proc values                      [OK]\n        [OK]\n        [OK]\nChecking that pluto is running                                  [OK]\n Pluto listening for IKE on udp 500                             [OK]\n Pluto listening for NAT-T on udp 4500                          [OK]\nChecking for 'ip' command                                       [OK]\nChecking /bin/sh is not /bin/dash                               [OK]\nChecking for 'iptables' command                                 [OK]\nOpportunistic Encryption Support                                [DISABLED]\n```\n\n## \u63a5\u7d9a\n\n### iPhone\u304b\u3089\n\niPhone\u304b\u3089\u306f\u8d85\u7d76\u7c21\u5358\uff01\n\niphone\u306e\u8a2d\u5b9a -> \u4e00\u822c -> VPN -> \"VPN\u69cb\u6210\u3092\u8ffd\u52a0\"\u3092\u62bc\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u753b\u9762\u306b\u306a\u308b\u306e\u3067\u3001\u5fc5\u8981\u306a\u5024\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u8aac\u660e\u306b\u306fVPN\u540d\uff1afoovpn\n\u30b5\u30fc\u30d0\u30fc\u306b\u306f\uff1aVPN\u30b5\u30fc\u30d0\u30fc\u306e\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\n\u30a2\u30ab\u30a6\u30f3\u30c8\uff1afoo\n\u30d1\u30b9\u30ef\u30fc\u30c9\uff1abar\n\n![20150729034856.jpg](https://qiita-image-store.s3.amazonaws.com/0/27932/b3052bc6-c324-d77b-05a8-2699bac38c0a.jpeg)\n\n\n\u30d7\u30ed\u30ad\u30b7\u306b\u306f\"\u624b\u52d5\"\u3092\u9078\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n\u5fc5\u8981\u306a\u60c5\u5831\u3092\u5165\u308c\u307e\u3059\u3002\n\u30b5\u30fc\u30d0\u30fc\u306b\u306fVPN\u8cbc\u3063\u305f\u3042\u3068\u306eIP\u30a2\u30c9\u30ec\u30b9\uff1a192.168.1.99\n\u30dd\u30fc\u30c8\u306fsquid\u3067\u8a2d\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\uff1a8080\n![20150730055358.jpg](https://qiita-image-store.s3.amazonaws.com/0/27932/a86e9a29-cc98-d7d6-8e10-6d5b1aae2161.jpeg)\n\n\n\u3042\u3068\u306fVPN\u63a5\u7d9a\u3059\u308c\u3070OK\u3067\u3059\u3002\nping\u3082\u98db\u3073\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b8\u30f3\u30b0\u3082OK\n\n![20150730060240.jpg](https://qiita-image-store.s3.amazonaws.com/0/27932/294cee23-4cdd-cd6f-23d8-8907629cce96.jpeg)\n\n\n## Windows\u306f\u3084\u3063\u304b\u3044\u3002\u3002\n\nVPN\u63a5\u7d9a\u958b\u59cb\u6642\u306b\"809\u30b5\u30fc\u30d0\u30fc\u5fdc\u7b54\u306a\u3057\"\u30a8\u30e9\u30fc\u767a\u751f\u3002\u3002\n\n![\u7121\u984c.png](https://qiita-image-store.s3.amazonaws.com/0/27932/ba97e535-9c50-df95-6e86-4ef2fd9194ee.png)\n\n\n\u3076\u3063\u3061\u3083\u3051\u3053\u3061\u3089\u306e\u30b5\u30a4\u30c8\u306b\u52a9\u3051\u3066\u9802\u304d\u307e\u3057\u305f\u3002\u3042\u308a\u304c\u305f\u3084\uff5e\nhttp://reffi.jp/archives/308\n\n\u30ec\u30b8\u30b9\u30c8\u30ea\u3092\u5909\u3048\u308b\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PolicyAgent \u306e\nAssumeUDPEncapsulationContextOnSendRule \u3092\n\"2\"\n\n\u30d7\u30ed\u30ad\u30b7\u8a2d\u5b9a\u3092VPN\u5358\u4f4d\u306b\u884c\u3046\u3053\u3068\u3067OK\uff01\n\n\u3042\u3068\u306f\u826f\u597d\u826f\u597d^^\n\u3061\u3083\u3093\u3061\u3083\u3093\n", "tags": ["VPN", "l2tp", "openswan", "squid", "AWS"]}