{"tags": ["hitch", "Varnish"], "context": "\u516c\u5f0f\u30b5\u30a4\u30c8\nVarnish\u3092\u4f7f\u7528\u3057\u3066\u3044\u3066SSL/TLS\uff08https\uff09\u3092\u4f7f\u3044\u305f\u3044\u306a\u3089\u30b7\u30f3\u30d7\u30eb\u306a Hitch \u304c\u5fc3\u5f37\u3044\u52a9\u3051\u306b\u306a\u308b\u3002\n\u203bVarnish4.1\u4ee5\u964d\u3067\u306a\u3044\u3068PROXY Protocol\u306b\u5bfe\u5fdc\u3057\u3066\u306a\u3044\u306e\u3067\u6ce8\u610f\n\nCentOS\u306bhitch\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4f5c\u696d\u6642\u70b9\u3067\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\n2016-01-26: Hitch 1.1.1 has been released. This is a maintenance release with various bug fixes.\nSupport for TLS1.0, TLS1.1 and TLS1.2\nSNI, with and without wildcard certificates\nSupport for HAproxy's PROXY protocol\nSafe for large installations: performant up to 15 000 listening sockets and 500 000 certificates.\nSupport for seamless run-time configuration reloads of certificates and listen endpoints.\n\n\n\u30bd\u30fc\u30b9\u53d6\u5f97\ngit clone https://github.com/varnish/hitch\ncd ./hitch\n./bootstrap\n./configure\n\n\nconfigure\u3059\u308b\u3068\u304d\u3068\u304b\u306b\u8db3\u308a\u306a\u304b\u3063\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\n$ sudo yum install python-docutils\n$ sudo yum install libev-devel\n$ sudo yum install openssl-devel\n$ sudo yum install flex-devel\n\n\nconfigure\n$ ./configure\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... /bin/mkdir -p\nchecking for gawk... gawk\nchecking whether make sets $(MAKE)... yes\nchecking for gcc... gcc\nchecking for C compiler default output file name... a.out\nchecking whether the C compiler works... yes\nchecking whether we are cross compiling... no\nchecking for suffix of executables...\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... yes\nchecking whether gcc accepts -g... yes\nchecking for gcc option to accept ISO C89... none needed\nchecking for style of include used by make... GNU\nchecking dependency style of gcc... gcc3\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether make sets $(MAKE)... (cached) yes\nchecking for bison... bison -y\nchecking for flex... flex\nchecking lex output file root... lex.yy\nchecking lex library... none needed\nchecking whether yytext is a pointer... no\nchecking for rst2man... rst2man\nchecking whether to enable maintainer-specific portions of Makefiles... no\nchecking for ev_default_loop in -lev... yes\nchecking for SSL_CTX_free in -lssl... yes\nchecking how to run the C preprocessor... gcc -E\nchecking for grep that handles long lines and -e... /bin/grep\nchecking for egrep... /bin/grep -E\nchecking for ANSI C header files... yes\nchecking for sys/types.h... yes\nchecking for sys/stat.h... yes\nchecking for stdlib.h... yes\nchecking for string.h... yes\nchecking for memory.h... yes\nchecking for strings.h... yes\nchecking for inttypes.h... yes\nchecking for stdint.h... yes\nchecking for unistd.h... yes\nchecking for struct stat.st_mtim... yes\nchecking for struct stat.st_mtimespec... no\nchecking for stdlib.h... (cached) yes\nchecking for unistd.h... (cached) yes\nchecking for uid_t in sys/types.h... yes\nchecking for inline... inline\nchecking for int32_t... yes\nchecking for pid_t... yes\nchecking for size_t... yes\nchecking for ssize_t... yes\nchecking for uint32_t... yes\nchecking vfork.h usability... no\nchecking vfork.h presence... no\nchecking for vfork.h... no\nchecking for fork... yes\nchecking for vfork... yes\nchecking for working fork... yes\nchecking for working vfork... (cached) yes\nchecking for stdlib.h... (cached) yes\nchecking for GNU libc compatible malloc... yes\nchecking for stdlib.h... (cached) yes\nchecking for unistd.h... (cached) yes\nchecking for getpagesize... yes\nchecking for working mmap... yes\nchecking for inet_ntoa... yes\nchecking for accept4... yes\nconfigure: creating ./config.status\nconfig.status: creating Makefile\nconfig.status: creating src/Makefile\nconfig.status: creating config.h\nconfig.status: executing depfiles commands\n\n\n\nmake \u3068 make install\n$ make\n$ sudo make install\nMaking install in src\nmake[1]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u306b\u5165\u308a\u307e\u3059\nmake  install-am\nmake[2]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u306b\u5165\u308a\u307e\u3059\nmake[3]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u306b\u5165\u308a\u307e\u3059\ntest -z \"/usr/local/sbin\" || /bin/mkdir -p \"/usr/local/sbin\"\n  /usr/bin/install -c hitch '/usr/local/sbin'\nmake[3]: `install-data-am' \u306b\u5bfe\u3057\u3066\u884c\u3046\u3079\u304d\u4e8b\u306f\u3042\u308a\u307e\u305b\u3093.\nmake[3]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u304b\u3089\u51fa\u307e\u3059\nmake[2]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u304b\u3089\u51fa\u307e\u3059\nmake[1]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u304b\u3089\u51fa\u307e\u3059\nmake[1]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch' \u306b\u5165\u308a\u307e\u3059\nmake[2]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch' \u306b\u5165\u308a\u307e\u3059\nmake[2]: `install-exec-am' \u306b\u5bfe\u3057\u3066\u884c\u3046\u3079\u304d\u4e8b\u306f\u3042\u308a\u307e\u305b\u3093.\ntest -z \"/usr/local/share/doc/hitch\" || /bin/mkdir -p \"/usr/local/share/doc/hitch\"\n /usr/bin/install -c -m 644 hitch.conf.ex CHANGES.rst README.md '/usr/local/share/doc/hitch'\ntest -z \"/usr/local/share/man/man8\" || /bin/mkdir -p \"/usr/local/share/man/man8\"\n /usr/bin/install -c -m 644 hitch.8 '/usr/local/share/man/man8'\nmake[2]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch' \u304b\u3089\u51fa\u307e\u3059\nmake[1]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch' \u304b\u3089\u51fa\u307e\u3059\n\n\nhitch\u672c\u4f53\n/usr/local/sbin/hitch\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\n/usr/local/sbin/hitch --config=/hogehoge/hitch.conf\n\nhitch --backend=[127.0.0.1]:80 --frontend=[*]:443 server.pem\n\n./hitch --backend=0.0.0.0:80 \\\n    --frontend=[*]:443 \\\n    server.crt\n\nhitch --backend=[127.0.0.1]:80 --frontend=[*]:443 example.pem\\\n\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /home/hoge/ssl/hitch.key -out /home/hoge/ssl/nginx.crt\n\n\n\u30d7\u30ed\u30bb\u30b9443\u3067\u8d77\u52d5\u3055\u305b\u3088\u3046\u3068\u3059\u308b\u3068\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u304c\u3067\u308b\u304b\u3089\u30b1\u30fc\u30d1\u30d3\u30ea\u30c6\u30a3\u3067\u7279\u6a29\u3092\u5272\u308a\u5f53\u3066\u308b\nsudo setcap CAP_NET_BIND_SERVICE+ep /usr/local/sbin/hitch\nsudo getcap /usr/local/sbin/hitch\n\n$ sudo setcap -r /usr/local/sbin/hitch\n$ sudo getcap /usr/local/sbin/hitch\n\n\u4e00\u822c\u30e6\u30fc\u30b6\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u30dd\u30fc\u30c81024\u756a\u672a\u6e80\u3067Bind\u3059\u308b\u65b9\u6cd5\n\n/usr/local/sbin/hitch --config=/home/hoge/hitch/hitch.conf\n$ ps -aux | grep hitch\n`\n\n[\u516c\u5f0f\u30b5\u30a4\u30c8](https://hitch-tls.org/)\n\nVarnish\u3092\u4f7f\u7528\u3057\u3066\u3044\u3066SSL/TLS\uff08https\uff09\u3092\u4f7f\u3044\u305f\u3044\u306a\u3089\u30b7\u30f3\u30d7\u30eb\u306a `Hitch` \u304c\u5fc3\u5f37\u3044\u52a9\u3051\u306b\u306a\u308b\u3002\n\u203bVarnish4.1\u4ee5\u964d\u3067\u306a\u3044\u3068PROXY Protocol\u306b\u5bfe\u5fdc\u3057\u3066\u306a\u3044\u306e\u3067\u6ce8\u610f\n\n# CentOS\u306bhitch\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4f5c\u696d\u6642\u70b9\u3067\u306e\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\n2016-01-26: Hitch 1.1.1 has been released. This is a maintenance release with various bug fixes.\n\n```\nSupport for TLS1.0, TLS1.1 and TLS1.2\nSNI, with and without wildcard certificates\nSupport for HAproxy's PROXY protocol\nSafe for large installations: performant up to 15 000 listening sockets and 500 000 certificates.\nSupport for seamless run-time configuration reloads of certificates and listen endpoints.\n```\n\n# \u30bd\u30fc\u30b9\u53d6\u5f97\n```\ngit clone https://github.com/varnish/hitch\ncd ./hitch\n./bootstrap\n./configure\n```\n\n# configure\u3059\u308b\u3068\u304d\u3068\u304b\u306b\u8db3\u308a\u306a\u304b\u3063\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\n```\n$ sudo yum install python-docutils\n$ sudo yum install libev-devel\n$ sudo yum install openssl-devel\n$ sudo yum install flex-devel\n```\n\n# configure\n```\n$ ./configure\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... /bin/mkdir -p\nchecking for gawk... gawk\nchecking whether make sets $(MAKE)... yes\nchecking for gcc... gcc\nchecking for C compiler default output file name... a.out\nchecking whether the C compiler works... yes\nchecking whether we are cross compiling... no\nchecking for suffix of executables...\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... yes\nchecking whether gcc accepts -g... yes\nchecking for gcc option to accept ISO C89... none needed\nchecking for style of include used by make... GNU\nchecking dependency style of gcc... gcc3\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether make sets $(MAKE)... (cached) yes\nchecking for bison... bison -y\nchecking for flex... flex\nchecking lex output file root... lex.yy\nchecking lex library... none needed\nchecking whether yytext is a pointer... no\nchecking for rst2man... rst2man\nchecking whether to enable maintainer-specific portions of Makefiles... no\nchecking for ev_default_loop in -lev... yes\nchecking for SSL_CTX_free in -lssl... yes\nchecking how to run the C preprocessor... gcc -E\nchecking for grep that handles long lines and -e... /bin/grep\nchecking for egrep... /bin/grep -E\nchecking for ANSI C header files... yes\nchecking for sys/types.h... yes\nchecking for sys/stat.h... yes\nchecking for stdlib.h... yes\nchecking for string.h... yes\nchecking for memory.h... yes\nchecking for strings.h... yes\nchecking for inttypes.h... yes\nchecking for stdint.h... yes\nchecking for unistd.h... yes\nchecking for struct stat.st_mtim... yes\nchecking for struct stat.st_mtimespec... no\nchecking for stdlib.h... (cached) yes\nchecking for unistd.h... (cached) yes\nchecking for uid_t in sys/types.h... yes\nchecking for inline... inline\nchecking for int32_t... yes\nchecking for pid_t... yes\nchecking for size_t... yes\nchecking for ssize_t... yes\nchecking for uint32_t... yes\nchecking vfork.h usability... no\nchecking vfork.h presence... no\nchecking for vfork.h... no\nchecking for fork... yes\nchecking for vfork... yes\nchecking for working fork... yes\nchecking for working vfork... (cached) yes\nchecking for stdlib.h... (cached) yes\nchecking for GNU libc compatible malloc... yes\nchecking for stdlib.h... (cached) yes\nchecking for unistd.h... (cached) yes\nchecking for getpagesize... yes\nchecking for working mmap... yes\nchecking for inet_ntoa... yes\nchecking for accept4... yes\nconfigure: creating ./config.status\nconfig.status: creating Makefile\nconfig.status: creating src/Makefile\nconfig.status: creating config.h\nconfig.status: executing depfiles commands\n\n```\n\n\n# make \u3068 make install\n```\n$ make\n$ sudo make install\nMaking install in src\nmake[1]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u306b\u5165\u308a\u307e\u3059\nmake  install-am\nmake[2]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u306b\u5165\u308a\u307e\u3059\nmake[3]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u306b\u5165\u308a\u307e\u3059\ntest -z \"/usr/local/sbin\" || /bin/mkdir -p \"/usr/local/sbin\"\n  /usr/bin/install -c hitch '/usr/local/sbin'\nmake[3]: `install-data-am' \u306b\u5bfe\u3057\u3066\u884c\u3046\u3079\u304d\u4e8b\u306f\u3042\u308a\u307e\u305b\u3093.\nmake[3]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u304b\u3089\u51fa\u307e\u3059\nmake[2]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u304b\u3089\u51fa\u307e\u3059\nmake[1]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch/src' \u304b\u3089\u51fa\u307e\u3059\nmake[1]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch' \u306b\u5165\u308a\u307e\u3059\nmake[2]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch' \u306b\u5165\u308a\u307e\u3059\nmake[2]: `install-exec-am' \u306b\u5bfe\u3057\u3066\u884c\u3046\u3079\u304d\u4e8b\u306f\u3042\u308a\u307e\u305b\u3093.\ntest -z \"/usr/local/share/doc/hitch\" || /bin/mkdir -p \"/usr/local/share/doc/hitch\"\n /usr/bin/install -c -m 644 hitch.conf.ex CHANGES.rst README.md '/usr/local/share/doc/hitch'\ntest -z \"/usr/local/share/man/man8\" || /bin/mkdir -p \"/usr/local/share/man/man8\"\n /usr/bin/install -c -m 644 hitch.8 '/usr/local/share/man/man8'\nmake[2]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch' \u304b\u3089\u51fa\u307e\u3059\nmake[1]: \u30c7\u30a3\u30ec\u30af\u30c8\u30ea `/home/vagrant/hitch' \u304b\u3089\u51fa\u307e\u3059\n```\n\n## hitch\u672c\u4f53\n```\n/usr/local/sbin/hitch\n```\n\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\n```\n/usr/local/sbin/hitch --config=/hogehoge/hitch.conf\n\nhitch --backend=[127.0.0.1]:80 --frontend=[*]:443 server.pem\n\n./hitch --backend=0.0.0.0:80 \\\n    --frontend=[*]:443 \\\n    server.crt\n\nhitch --backend=[127.0.0.1]:80 --frontend=[*]:443 example.pem\\\n\nsudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /home/hoge/ssl/hitch.key -out /home/hoge/ssl/nginx.crt\n```\n\n# \u30d7\u30ed\u30bb\u30b9443\u3067\u8d77\u52d5\u3055\u305b\u3088\u3046\u3068\u3059\u308b\u3068\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u304c\u3067\u308b\u304b\u3089\u30b1\u30fc\u30d1\u30d3\u30ea\u30c6\u30a3\u3067\u7279\u6a29\u3092\u5272\u308a\u5f53\u3066\u308b\n```\nsudo setcap CAP_NET_BIND_SERVICE+ep /usr/local/sbin/hitch\nsudo getcap /usr/local/sbin/hitch\n```\n\n```\n$ sudo setcap -r /usr/local/sbin/hitch\n$ sudo getcap /usr/local/sbin/hitch\n```\n\n[\u4e00\u822c\u30e6\u30fc\u30b6\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u30dd\u30fc\u30c81024\u756a\u672a\u6e80\u3067Bind\u3059\u308b\u65b9\u6cd5](http://roguer.info/2012/07/23/5727/)\n\n``\n/usr/local/sbin/hitch --config=/home/hoge/hitch/hitch.conf\n$ ps -aux | grep hitch\n```\n"}