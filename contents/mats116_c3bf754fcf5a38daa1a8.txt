{"tags": ["dockerfile", "docker"], "context": " More than 1 year has passed since last update.Dockerfile\u3092\u66f8\u3044\u3066\u3044\u3066\u8a70\u307e\u3063\u305f\u3068\u3053\u308d\u306a\u3069\u3002\n\nWORKDIR \u306f ADD \u306b\u306f\u52b9\u304b\u306a\u3044\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3061\u3083\u3093\u3068\u66f8\u3044\u3066\u3042\u308b\u304c\u3001WORKDIR\u304c\u52b9\u304f\u306e\u306fRUN CMD ENTRYPOINT\u306e\u307f\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u66f8\u3044\u3066\u3082/var/app\u306b\u306f\u914d\u7f6e\u3055\u308c\u307e\u305b\u3093\u3002\n\nDockerfile\nWORKDIR /var/app\nADD Gemfile.local ./\n\n\n\nWORKDIR \u306e\u30d0\u30b0\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u3066\u3082\u3001WORKDIR\u306e\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u74b0\u5883\u5909\u6570\u304c\u52b9\u304b\u306a\u3044\u3002\n\nDockerfile\nENV APP_PATH /var/app\n\nWORKDIR ${APP_PATH}\nRUN bundle install\n\n\n\u3053\u308c\u306f\u30d0\u30b0\u306e\u3088\u3046\u3067\u3001\u4fee\u6b63\u3055\u308c\u308b\u307e\u3067\u306f\u76f4\u63a5\u66f8\u304f\u3057\u304b\u7121\u3055\u305d\u3046\u3002\n\nDockerfile\nWORKDIR /var/app\nRUN bundle install\n\n\n\nEXPOSE \u306e\u30d0\u30b0\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u3066\u3082\u3001EXPOSE\u306e\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u74b0\u5883\u5909\u6570\u304c\u52b9\u304b\u306a\u3044\u3002\n\u3053\u308c\u3082\u30d0\u30b0\u3063\u307d\u3044\u3002\n\nDockerfile\nENV PORT 80\nEXPOSE ${PORT}\n\n\n\n\u5b9f\u884c\u9806\u5e8f\u306b\u3064\u3044\u3066\nDockerfile\u306b\u304b\u304b\u308c\u3066\u3044\u308b\u5185\u5bb9\u306f\u4e00\u884c\u6bce\u306b\u30b3\u30f3\u30c6\u30ca\u306b\u5165\u308a\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u66f8\u304d\u65b9\u3060\u3068\u4e0a\u624b\u304f\u5b9f\u884c\u3055\u308c\u306a\u3044\u3002\n\nDockerfile\nRUN /etc/init.d/mysqld start\nRUN mysqladmin -u root password \"password\"\nRUN /etc/init.d/mysqld stop\n\n\n\u3053\u308c\u306f\uff11\u884c\u76ee\u3067mysql\u3092\u5b9f\u884c\u3057\u305f\u3042\u3068\u306b\u72b6\u614b\u3092\u4fdd\u5b58\u3057\u3001\u518d\u5ea6\u7acb\u3061\u4e0a\u3052\u305f\u30b3\u30f3\u30c6\u30ca\u4e0a\u3067\uff12\u884c\u76ee\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u304b\u3089\u3002\uff08\u305f\u3076\u3093\uff09\n\u306a\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u307e\u3068\u3081\u3066\u66f8\u3051\u3070OK\u3002\uff08\u898b\u96e3\u3044\u306e\u3067\u6539\u884c\u3057\u3066\u3044\u307e\u3059\uff09\n\nDockerfile\nRUN /etc/init.d/mysqld start && \\\n    mysqladmin -u root password \"password\" && \\\n    /etc/init.d/mysqld stop\n\n\n\nRUN \u306e\u4e0a\u9650\ndocker\u306ev0.7.2\u4ee5\u964d\u306b\u304a\u3051\u308b\u3001AUFX\u306e\u7a4d\u307f\u4e0a\u3052\u53ef\u80fd\u306aRUN\u306e\u4e0a\u9650\u306f 127 \u307f\u305f\u3044\u3067\u3059\u3002\n\u53c2\u8003\uff1astackoverflow\n\u306a\u306e\u3067\u3001&&\u3068\u304b\u3067\u7bc0\u7d04\u3059\u308b\u306e\u306f\u3044\u3044\u3053\u3068\u3067\u3059\u3002\n\nDockerfile\u3092\u66f8\u3044\u3066\u3044\u3066\u8a70\u307e\u3063\u305f\u3068\u3053\u308d\u306a\u3069\u3002\n\n## WORKDIR \u306f ADD \u306b\u306f\u52b9\u304b\u306a\u3044\n\n[\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://docs.docker.com/reference/builder/#workdir)\u306b\u3061\u3083\u3093\u3068\u66f8\u3044\u3066\u3042\u308b\u304c\u3001`WORKDIR `\u304c\u52b9\u304f\u306e\u306f`RUN` `CMD` `ENTRYPOINT`\u306e\u307f\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u66f8\u3044\u3066\u3082`/var/app`\u306b\u306f\u914d\u7f6e\u3055\u308c\u307e\u305b\u3093\u3002\n\n```bash:Dockerfile\nWORKDIR /var/app\nADD Gemfile.local ./\n```\n\n## WORKDIR \u306e\u30d0\u30b0\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u3066\u3082\u3001`WORKDIR`\u306e\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u74b0\u5883\u5909\u6570\u304c\u52b9\u304b\u306a\u3044\u3002\n\n```bash:Dockerfile\nENV APP_PATH /var/app\n\nWORKDIR ${APP_PATH}\nRUN bundle install\n```\n\n\u3053\u308c\u306f[\u30d0\u30b0](https://github.com/dotcloud/docker/issues/2637)\u306e\u3088\u3046\u3067\u3001\u4fee\u6b63\u3055\u308c\u308b\u307e\u3067\u306f\u76f4\u63a5\u66f8\u304f\u3057\u304b\u7121\u3055\u305d\u3046\u3002\n\n```bash:Dockerfile\nWORKDIR /var/app\nRUN bundle install\n```\n\n## EXPOSE \u306e\u30d0\u30b0\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u3066\u3082\u3001`EXPOSE `\u306e\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u74b0\u5883\u5909\u6570\u304c\u52b9\u304b\u306a\u3044\u3002\n\u3053\u308c\u3082\u30d0\u30b0\u3063\u307d\u3044\u3002\n\n```bash:Dockerfile\nENV PORT 80\nEXPOSE ${PORT}\n```\n\n## \u5b9f\u884c\u9806\u5e8f\u306b\u3064\u3044\u3066\n\nDockerfile\u306b\u304b\u304b\u308c\u3066\u3044\u308b\u5185\u5bb9\u306f\u4e00\u884c\u6bce\u306b\u30b3\u30f3\u30c6\u30ca\u306b\u5165\u308a\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u66f8\u304d\u65b9\u3060\u3068\u4e0a\u624b\u304f\u5b9f\u884c\u3055\u308c\u306a\u3044\u3002\n\n```bash:Dockerfile\nRUN /etc/init.d/mysqld start\nRUN mysqladmin -u root password \"password\"\nRUN /etc/init.d/mysqld stop\n```\n\n\u3053\u308c\u306f\uff11\u884c\u76ee\u3067mysql\u3092\u5b9f\u884c\u3057\u305f\u3042\u3068\u306b\u72b6\u614b\u3092\u4fdd\u5b58\u3057\u3001\u518d\u5ea6\u7acb\u3061\u4e0a\u3052\u305f\u30b3\u30f3\u30c6\u30ca\u4e0a\u3067\uff12\u884c\u76ee\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u304b\u3089\u3002\uff08\u305f\u3076\u3093\uff09\n\n\u306a\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u307e\u3068\u3081\u3066\u66f8\u3051\u3070OK\u3002\uff08\u898b\u96e3\u3044\u306e\u3067\u6539\u884c\u3057\u3066\u3044\u307e\u3059\uff09\n\n```bash:Dockerfile\nRUN /etc/init.d/mysqld start && \\\n    mysqladmin -u root password \"password\" && \\\n    /etc/init.d/mysqld stop\n```\n\n## RUN \u306e\u4e0a\u9650\n\ndocker\u306ev0.7.2\u4ee5\u964d\u306b\u304a\u3051\u308b\u3001AUFX\u306e\u7a4d\u307f\u4e0a\u3052\u53ef\u80fd\u306aRUN\u306e\u4e0a\u9650\u306f **127** \u307f\u305f\u3044\u3067\u3059\u3002\n\u53c2\u8003\uff1a[stackoverflow](http://stackoverflow.com/questions/21467638/number-of-commands-in-dockerfile/21468956#21468956)\n\n\u306a\u306e\u3067\u3001`&&`\u3068\u304b\u3067\u7bc0\u7d04\u3059\u308b\u306e\u306f\u3044\u3044\u3053\u3068\u3067\u3059\u3002\n"}