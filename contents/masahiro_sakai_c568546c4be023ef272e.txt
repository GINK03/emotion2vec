{"context": "Macnica Networks DAY\u3067\u884c\u308f\u308c\u305fCTF\u3001MNCTF2016\u306b\u53c2\u52a0\u3057\u3066\u304d\u305f\u306e\u3067\u3001Write-up\u3068\u3057\u3066\u7c21\u5358\u306a\u30e1\u30e2\u3092\u66f8\u3044\u3066\u304a\u304f\u3002\n\n\u554f\u984c\n\n\u70b9\u547c (MISC)\n(\u7701\u7565)\n\n\u8d85\u6a19\u7684\u578b (BINARY)\n\u5f53\u65e5\u306f\u3001\u30d0\u30a4\u30ca\u30ea\u554f\u984c\u3078\u306e\u82e6\u624b\u610f\u8b58\u3068\u3001Mac\u3067\u4f5c\u696d\u3057\u3066\u3044\u305f\u306e\u3067Windows\u30d0\u30a4\u30ca\u30ea\u9762\u5012\u3068\u601d\u3063\u3066\u5f8c\u56de\u3057\u306b\u3057\u3066\u3044\u305f\u3089\u3001\u6642\u9593\u304c\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u6642\u9593\u5207\u308c\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3060\u3051\u308c\u3069\u3001\u5b9f\u969b\u306f\u7c21\u5358\u306a\u554f\u984c\u3067\u3001\u3053\u308c\u3092\u5148\u306b\u89e3\u3044\u3066\u3044\u308c\u3070\u3068\u5f8c\u6094\u3002\n\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3092strings\u3057\u3066\u307f\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6587\u5b57\u5217\u304c\u898b\u3064\u304b\u308a\u3001\u307e\u305fGetComputerNameA\u304c\u4f7f\u308f\u308c\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308b\u3002\nComputer Name: %s\nThis host is not the target.\nOperation Aborted.\nTargeted host found. Continue operation.\n\nHopper\u3067\u3053\u306e\u6587\u5b57\u5217\u304c\u4f7f\u308f\u308c\u3066\u3044\u308b\u95a2\u6570\u3092\u898b\u3064\u3051\u3066\u30c7\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u307f\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u3002\nint sub_401080(int arg0, int arg1) {\n    eax = (*_mbsicmp)(arg0, arg1);\n    return eax;\n}\n\nint sub_4010a0() {\n    (*GetComputerNameA)(var_24, 0x10);\n    sub_401040(\"Computer Name: %s\\n\", var_24);\n    esp = ((esp - 0x4 - 0x4 - 0x4 - 0x4) + 0x8 - 0x4 - 0x4) + 0x8;\n    if (sub_401080(0x54, var_24) != 0x0) {\n            sub_401040(\"This host is not the target.\\nOperation Aborted.\\n\", stack[2038]);\n    }\n    else {\n            sub_401040(\"Targeted host found. Continue operation.\\n\", stack[2038]);\n            sub_401040(0x40217c, stack[2038]);\n    }\n    return 0x0;\n}\n\n\u3069\u3046\u3082\u3046\u307e\u304f\u30c7\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u30a2\u30bb\u30f3\u30d6\u30ea\u3092\u898b\u3066\u307f\u308b\u3068\u2026\u2026\nsub_4010a0:\n004010a0         push       ebp                                                 ; XREF=sub_4011f8+268\n004010a1         mov        ebp, esp\n004010a3         sub        esp, 0x24\n004010a6         mov        dword [ss:ebp+var_4], 0x10\n004010ad         lea        eax, dword [ss:ebp+var_4]\n004010b0         push       eax\n004010b1         lea        ecx, dword [ss:ebp+var_24]\n004010b4         push       ecx\n004010b5         call       dword [ds:imp_GetComputerNameA]                     ; imp_GetComputerNameA\n004010bb         lea        edx, dword [ss:ebp+var_24]\n004010be         push       edx                                                 ; argument #2 for method sub_401040\n004010bf         push       0x402108                                            ; \"Computer Name: %s\\\\n\", argument #1 for method sub_401040\n004010c4         call       sub_401040\n004010c9         add        esp, 0x8\n004010cc         mov        byte [ss:ebp+var_14], 0x54\n004010d0         mov        byte [ss:ebp+var_13], 0x45\n004010d4         mov        byte [ss:ebp+var_12], 0x53\n004010d8         mov        byte [ss:ebp+var_11], 0x48\n004010dc         mov        byte [ss:ebp+var_10], 0x49\n004010e0         mov        byte [ss:ebp+var_F], 0x47\n004010e4         mov        byte [ss:ebp+var_E], 0x41\n004010e8         mov        byte [ss:ebp+var_D], 0x57\n004010ec         mov        byte [ss:ebp+var_C], 0x41\n004010f0         mov        byte [ss:ebp+var_B], 0x52\n004010f4         mov        byte [ss:ebp+var_A], 0x41\n004010f8         mov        byte [ss:ebp+var_9], 0x2d\n004010fc         mov        byte [ss:ebp+var_8], 0x50\n00401100         mov        byte [ss:ebp+var_7], 0x43\n00401104         mov        byte [ss:ebp+var_6], 0x0\n00401108         lea        eax, dword [ss:ebp+var_24]\n0040110b         push       eax                                                 ; argument #2 for method sub_401080\n0040110c         lea        ecx, dword [ss:ebp+var_14]\n0040110f         push       ecx                                                 ; argument #1 for method sub_401080\n00401110         call       sub_401080\n00401115         add        esp, 0x8\n00401118         test       eax, eax\n0040111a         je         0x40112b\n\nsub_401080 \u306e\u5f15\u6570\u306e\u6587\u5b57\u5217\u304c\u4ee5\u4e0b\u3067\u69cb\u7bc9\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u3001\u30a2\u30bb\u30f3\u30d6\u30e9\u8d85\u521d\u5fc3\u8005\u306e\u81ea\u5206\u3067\u3082\u5206\u304b\u308b\u3002\n004010cc         mov        byte [ss:ebp+var_14], 0x54\n004010d0         mov        byte [ss:ebp+var_13], 0x45\n004010d4         mov        byte [ss:ebp+var_12], 0x53\n004010d8         mov        byte [ss:ebp+var_11], 0x48\n004010dc         mov        byte [ss:ebp+var_10], 0x49\n004010e0         mov        byte [ss:ebp+var_F], 0x47\n004010e4         mov        byte [ss:ebp+var_E], 0x41\n004010e8         mov        byte [ss:ebp+var_D], 0x57\n004010ec         mov        byte [ss:ebp+var_C], 0x41\n004010f0         mov        byte [ss:ebp+var_B], 0x52\n004010f4         mov        byte [ss:ebp+var_A], 0x41\n004010f8         mov        byte [ss:ebp+var_9], 0x2d\n004010fc         mov        byte [ss:ebp+var_8], 0x50\n00401100         mov        byte [ss:ebp+var_7], 0x43\n00401104         mov        byte [ss:ebp+var_6], 0x0\n00401108         lea        eax, dword [ss:ebp+var_24]\n0040110b         push       eax                                                 ; argument #2 for method sub_401080\n\n\u3068\u308a\u3042\u3048\u305a\u3001ghci\u3067\u6587\u5b57\u5217\u306b\u623b\u3059\u3068\u300cTESHIGAWARA-PC\u300d\u304c\u5f97\u3089\u308c\u305f\u3002\n> map toEnum [0x54,0x45,0x53,0x48,0x49,0x47,0x41,0x57,0x41,0x52,0x41,0x2d,0x50,0x43,0x0] :: String\n\"TESHIGAWARA-PC\\NUL\"\n\n\n\u540c\u4e00\u96c6\u56e3 (MISC)\n\u300c\u4f4f\u6240\u306a\u3069\u306f\u672c\u7269\u3067\u3042\u308b\u53ef\u80fd\u6027\u304c\u4f4e\u3044\u4e00\u65b9\u3067\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u30c9\u30e1\u30a4\u30f3\u53d6\u5f97\u6642\u306b\u78ba\u8a8d\u30e1\u30fc\u30eb\u3092\u53d7\u3051\u53d6\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u3001\u653b\u6483\u8005\u304c\u4fdd\u6301\u3057\u3066\u3044\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3042\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u3067\u3059\u300d\u3068\u3044\u3046\u30d2\u30f3\u30c8\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u305f\u306e\u3067\u3001shinobot.com\u306ewhois\u60c5\u5831\u306b\u3042\u3063\u305f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u30b0\u30b0\u308b\u3068\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304b\u3089\u30c9\u30e1\u30a4\u30f3\u3092\u691c\u7d22\u3067\u304d\u308b\u3088\u3046\u306a\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308b\u306e\u3092\u767a\u898b\u3002\u4ee5\u4e0b\u306e4\u3064\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u3059\u3050\u306b\u898b\u3064\u304b\u3063\u305f\u306e\u3060\u3051\u308c\u3069\u3001\u672c\u756a\u4e2d\u306b\u306f\u6700\u5f8c\u306e\u4e00\u3064\u304c\u5206\u304b\u3089\u305a\u3002\n\nnoitalumis.info\nmnd2015.info\nshinolocker.com\nmnctf.info\n\n\u4f55\u304b\u5225\u306e\u63a2\u3057\u65b9\u3092\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u304b\u3068\u601d\u3063\u305f\u304c\u3001\u5358\u306b\u305d\u306e\u30b5\u30a4\u30c8\u304c\u66f4\u65b0\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u304b\u4f55\u304b\u3067\u3001\u7d50\u5c40\u7279\u5225\u306a\u63a2\u3057\u65b9\u306f\u4e0d\u8981\u3060\u3063\u305f\u6a21\u69d8\u3002\u6700\u5f8c\u306e\u3072\u3068\u3064\u306fshinosec.com\u3060\u3063\u305f\u3002\n\n\u96e3\u8aad\u8a18\u9332 (MISC)\n\u30ed\u30b0\u4e2d\u306e\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u540d\u306b\u30de\u30c3\u30c1\u3059\u308b\u6b63\u898f\u8868\u73fe\u3092\u66f8\u304f\u3060\u3051\u3002\u9069\u5f53\u306bAD\\\\[A-F0-9]{6}\u3068\u304b\u66f8\u3044\u305f\u3089\u4f59\u8a08\u306a\u3082\u306e\u3082\u30de\u30c3\u30c1\u3057\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\u305f\u3068\u3048\u3070AD\\\\[A-F0-9]{6}\\b\u306a\u3069\u3068\u3059\u308c\u3070\u826f\u3044\u3002\n\n\u8d85\u6301\u682a\u4f1a (WEB)\n\u6539\u7ac4\u3057\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3059\u308c\u3070\u826f\u3044\u3002Fiddler\u3068\u304bBurp Suite\u3068\u304b\u3092\u4f7f\u3048\u308b\u3068\u30ab\u30c3\u30b3\u3088\u3044\u306e\u3060\u3051\u308c\u3069\u3001\u4f7f\u3063\u305f\u3053\u3068\u306a\u3044\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u958b\u767a\u8005\u30c4\u30fc\u30eb\u304b\u3089\u30d5\u30a9\u30fc\u30e0\u3092\u5909\u66f4\u3057\u3066\u30b5\u30d6\u30df\u30c3\u30c8\u3002\ndocument.getElementsByName(\"id\")[0].value = \"A20050023\"\nvar option = document.createElement(\"option\");\noption.text = \"1000\u53e3(1000,000\u682a)\";\noption.value = \"1000\";\ndocument.getElementsByName(\"stock\")[0].add(option)\ndocument.getElementsByName(\"stock\")[0].value = \"1000\"\n\n\n\u4e00\u884c\u633f\u5165 (WEB)\n\u5143\u306e\u30b3\u30fc\u30c9\u3092\u9069\u5f53\u306b\u6574\u5f62\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3002\neval(\n    function(p,a,c,k,e,r){\n        e=function(c){\n            return c.toString(a)\n        };\n        if(!''.replace(/^/,String)){\n            while(c--)\n                r[e(c)]=k[c]||e(c);\n            k=[function(e){return r[e]}];\n            e=function(){return'\\\\w+'};\n            c=1\n        };\n        while(c--)\n            if(k[c])\n                p=p.replace(new RegExp('\\\\b'+e(c)+'\\\\b','g'),k[c]);\n        return p\n    } ('e(6.5==\"c 1.0.0.1\"){3 4=[];3 2=6[\"5\"];2=2.o(\"\");b(3 i=0;i<2.d;i++){4.8(f.g(2[i].h(0)+i));j.k=(/[a-l-m-9]*/.n(4.7(\"\"))).7(\"\")+\\'.p\\'}}',26,26,'||ua|var|page|userAgent|navigator|join|push|||for|ShinoBrowser|length|if|String|fromCharCode|charCodeAt||window|location|zA|Z0|exec|split|html'.split('|'),0,{})\n)\n\n\u6587\u5b57\u5217\u3092\u751f\u6210\u3057\u3066eval\u3057\u3066\u3044\u308b\u306e\u3067\u3001eval\u3092alert\u306b\u66f8\u304d\u63db\u3048\u3066\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30bd\u30fc\u30b9\u304c\u5f97\u3089\u308c\u308b(\u3053\u306e\u30bd\u30fc\u30b9\u306f\u6574\u5f62\u6e08\u307f)\u3002\nif(navigator.userAgent==\"ShinoBrowser 1.0.0.1\"){\n  var page=[];\n  var ua=navigator[\"userAgent\"];\n  ua=ua.split(\"\");\n  for(var i=0;i<ua.length;i++){\n    page.push(String.fromCharCode(ua[i].charCodeAt(0)+i));\n    window.location=(/[a-zA-Z0-9]*/.exec(page.join(\"\"))).join(\"\")+'.html'\n  }\n}\n\n\u305d\u3053\u3067\u3001\u5c11\u3057\u66f8\u304d\u63db\u3048\u3066\u3001\u4ee5\u4e0b\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30d5\u30e9\u30b0\u304c\u5f97\u3089\u308c\u305f\u3002\nvar page=[];\nvar ua=\"ShinoBrowser 1.0.0.1\";\nua=ua.split(\"\");\nvar loc;\nfor(var i=0;i<ua.length;i++){\n  page.push(String.fromCharCode(ua[i].charCodeAt(0)+i));\n  loc=(/[a-zA-Z0-9]*/.exec(page.join(\"\"))).join(\"\")+'.html'\n}\nloc //=> \"SikqsGxv.html\"\n\n\n\u6697\u53f7\u65b0\u805e (CRYPT)\n\u30af\u30ed\u30b9\u30ef\u30fc\u30c9\u30d1\u30ba\u30eb\u3092\u89e3\u304f\u3060\u3051\u3067\u3001\u307b\u3068\u3093\u3069\u306e\u9805\u76ee\u306f\u7c21\u5358\u306a\u306e\u3060\u3051\u308c\u3069\u3001\u300cBitCoin\u306b\u3082\u4f7f\u308f\u308c\u3066\u3044\u308bRSA\u3092\u4eca\u5f8c\u7f6e\u304d\u63db\u3048\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\u6697\u53f7\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u300d(3\u6587\u5b57)\u304c\u5206\u304b\u3089\u305a\u3001\u3060\u3044\u3076\u6642\u9593\u3092\u4f7f\u3063\u3066\u3057\u307e\u3063\u305f\u3002\n\u305f\u3060\u3001\u5206\u304b\u3089\u306a\u3044\u306e\u306f\u4e8c\u6587\u5b57\u3060\u3051\u3060\u3063\u305f\u306e\u3067\u3001\u9811\u5f35\u3063\u3066\u30b0\u30b0\u3063\u305f\u308a\u3057\u3066\u308b\u3088\u308a\u3001\u7dcf\u5f53\u305f\u308a\u3057\u3066\u3057\u307e\u3063\u305f\u65b9\u304c\u65e9\u304b\u3063\u305f\u304b\u3082\u77e5\u308c\u306a\u3044\u3002\nvar cs = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nfor (var i = 0; i < cs.length; i++) {\n  for (var j = 0; j < cs.length; j++) {\n    var answer = \"PNGRTHTTPSLLAESMD5\" + cs[i] + \"E\" + cs[j] + \"SHA\"\n    if(md5(answer).substr(1,4)=='5545'){\n        //alert(answer)\n        alert(md5(answer))\n    }\n  }\n}\n\n\n\u6a29\u9650\u6607\u683c (BINARY)\n\u672c\u756a\u3067\u306f\u89e3\u304d\u65b9\u306e\u30a2\u30a4\u30c7\u30a3\u30a2\u304c\u601d\u3044\u3064\u304b\u305a\u3001\u300c\u8d85\u6a19\u7684\u578b\u300d\u3068\u540c\u3058\u304f\u5f8c\u56de\u3057\u306b\u3057\u3066\u3044\u305f\u3089\u3001\u6642\u9593\u304c\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u554f\u984c\u3002\n\u5f8c\u304b\u3089\u89e3\u3044\u305f\u969b\u306b\u306f\u3001\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306bPowerShellExecutor\u306a\u3069\u306e\u6587\u5b57\u5217\u304c\u898b\u3064\u304b\u3063\u305f\u305f\u3081\u3001PowerShell\u95a2\u4fc2\u306e\u8106\u5f31\u6027\u3068\u8e0f\u3093\u3067\u3001\u300cPowerShell \u6a29\u9650\u6607\u683c CVE\u300d\u3067\u30b0\u30b0\u3063\u305f\u3089\u3001\u300cCVE-2016-0099\u300d\u3092\u767a\u898b\u3002\u554f\u984c\u6587\u306b\u300c\u300cCVE_-__\u300d\u306e\u5f62\u5f0f\u3067\u3053\u305f\u3048\u3066\u304f\u3060\u3055\u3044\u300d\u3068\u3042\u3063\u305f\u306e\u3067\u3001\u6700\u521d\u306e\u30cf\u30a4\u30d5\u30f3\u306f\u542b\u307e\u306a\u3044\u300cCVE2016-0099\u300d\u3067\u6295\u7a3f\u3057\u305f\u3089\u4e0d\u6b63\u89e3\u3067\u3001\u300cCVE-2016-0099\u300d\u3068\u3057\u305f\u3089\u6b63\u89e3\u3068\u306a\u3063\u305f\u3002\n\u305f\u3060\u3001\u73fe\u5b9f\u306e\u30a4\u30f3\u30b7\u30c7\u30f3\u30c8\u5bfe\u5fdc\u3060\u3068\u3001\u3053\u3093\u306a\u65b9\u6cd5\u3067\u7279\u5b9a\u3067\u304d\u308b\u3068\u306f\u9650\u3089\u306a\u3044\u3057\u3001\u3069\u3046\u3059\u308b\u306e\u304c\u60f3\u5b9a\u89e3\u6cd5\u3060\u3063\u305f\u3093\u3060\u308d\u3046\u306a\u3041\u3001\u3068\u601d\u3063\u3066\u3044\u305f\u3089\u3001MNCTF2016 - CTF\u306eWrite-up\u7528\u30d6\u30ed\u30b0\u306b\u3001\u300c\u30d0\u30a4\u30ca\u30ea\u3092VirusTotal\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308c\u3070\u30d5\u30e9\u30b0\u304c\u51fa\u307e\u3059\u300d\u3068\u3042\u308a\u3001\u60c5\u30b7\u30b9\u5411\u3051\u3068\u3044\u3046\u3053\u3068\u3082\u8003\u3048\u308b\u3068\u3001\u306a\u308b\u307b\u3069\u3068\u601d\u3063\u305f\u3002\n\n\u4e38\u6587\u5b57\u6587 (CRYPT)\n\u672c\u756a\u3067\u306f\u3001\u5404\u6587\u5b57\u306e\u983b\u5ea6\u3092\u8abf\u3079\u3066\u983b\u5ea6\u9806\u306b\u82f1\u8a9e\u306e\u6587\u5b57\u306e\u51fa\u73fe\u983b\u5ea6\u3068\u30de\u30c3\u30c1\u30f3\u30b0\u3057\u305f\u308a\u3001\u30e6\u30cb\u30b3\u30fc\u30c9\u306e\u30b3\u30fc\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u5bfe\u3057\u3066\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u3068\u3063\u3066\u307f\u305f\u308a\u3068\u304b\u3001\u8272\u3005\u3084\u3063\u305f\u3051\u308c\u3069\u3001\u7d50\u5c40\u305d\u308c\u3063\u307d\u3044\u7d50\u679c\u306f\u5f97\u3089\u308c\u305a\u3002\n\u5f8c\u304b\u3089\u89e3\u3044\u305f\u969b\u306b\u306f\u3001\u4e38\u6587\u5b57\u3092\u666e\u901a\u306e\u6587\u5b57\u306b\u623b\u3059\u3068base64\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u306b\u6c17\u4ed8\u3044\u3066\u5fa9\u53f7\u3067\u304d\u305f\u3002\u6700\u521d\u306b\u5404\u6587\u5b57\u306e\u51fa\u73fe\u983b\u5ea6\u3092\u8abf\u3079\u305f\u969b\u306b\u3001\u6587\u5b57\u7a2e\u304c64\u6587\u5b57\u3068\u3044\u3046\u6642\u70b9\u3067\u6c17\u3065\u304f\u3079\u304d\u3060\u3063\u305f\u2026\u2026\u3002\u3042\u3068\u306f\u3001\u5fa9\u53f7\u7d50\u679c\u306b\u66f8\u3044\u3066\u3042\u308b\u7c21\u5358\u306a\u30af\u30a4\u30ba\u306b\u7b54\u3048\u308b\u3060\u3051\u3002\n\u305f\u3060\u3001\u5f97\u3089\u308c\u305f\u7b54\u3048\u3092\u30b5\u30d6\u30df\u30c3\u30c8\u3057\u3066\u3082\u6b63\u89e3\u306b\u306a\u3089\u305a\u3001\u5831\u544a\u3057\u3066\u5bfe\u5fdc\u3057\u3066\u3082\u3089\u3063\u305f\u3002\u305d\u308c\u307e\u3067\u306b\u8ab0\u3082\u6307\u6458\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u3088\u3046\u306a\u306e\u3067\u3001\u4e00\u756a\u4e57\u308a\u3060\u3063\u305f\u304b\u3082\u77e5\u308c\u306a\u3044\u3002\n\n\u7d50\u679c\n\u5f53\u65e5\u306e\u7d50\u679c\u3068\u3057\u3066\u306f\u300c\u70b9\u547c\u300d\u3001\u300c\u540c\u4e00\u96c6\u56e3\u300d(4/5)\u3001\u300c\u96e3\u8aad\u8a18\u9332\u300d\u3001\u300c\u8d85\u6301\u682a\u4f1a\u300d\u3001\u300c\u4e00\u884c\u633f\u5165\u300d\u3001\u300c\u6697\u53f7\u65b0\u805e\u300d\u3092\u89e3\u3044\u3066\u3001\u8a08205\u70b9\u306712\u4f4d\u3060\u3063\u305f\u3002\u3082\u3046\u3061\u3087\u3044\u3044\u3051\u308b\u304b\u3068\u601d\u3063\u305f\u304c\u6b8b\u5ff5\u2026\u2026\n\u73fe\u5728\u306e\u30b9\u30b3\u30a2\u30dc\u30fc\u30c9\u3067\u306f\u3001\u4e38\u6587\u5b57\u6587\u306e1\u70b9\u5206\u306b\u4e00\u756a\u4e57\u308a\u3060\u3063\u305f\u306e\u3067\u3001\u305d\u308c\u3092\u542b\u3080\u6e80\u70b9\u3092\u6700\u521d\u306b\u3068\u3063\u305f\u3053\u3068\u306b\u306a\u308a\u30011\u4f4d\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u53c2\u8003\n\u4ed6\u306e\u65b9\u306eWrite-up\u7b49\n\nMNCTF2016 - CTF\u306eWrite-up\u7528\u30d6\u30ed\u30b0\n\u30de\u30af\u30cb\u30ab\u3088\uff01\u79c1\u306f\u5e30\u3063\u3066\u304d\u305f\uff01\uff01 MNCTF2016 writeup - \u3046\u3055\u30d6\u30ed\n\n[Macnica Networks DAY](http://www.macnica.net/mnd/mnd2016/index.html/)\u3067\u884c\u308f\u308c\u305fCTF\u3001[MNCTF2016](http://mnctf.info/mnctf2016/)\u306b\u53c2\u52a0\u3057\u3066\u304d\u305f\u306e\u3067\u3001Write-up\u3068\u3057\u3066\u7c21\u5358\u306a\u30e1\u30e2\u3092\u66f8\u3044\u3066\u304a\u304f\u3002\n\n# \u554f\u984c\n\n## \u70b9\u547c (MISC)\n\n(\u7701\u7565)\n\n## \u8d85\u6a19\u7684\u578b (BINARY)\n\n\u5f53\u65e5\u306f\u3001\u30d0\u30a4\u30ca\u30ea\u554f\u984c\u3078\u306e\u82e6\u624b\u610f\u8b58\u3068\u3001Mac\u3067\u4f5c\u696d\u3057\u3066\u3044\u305f\u306e\u3067Windows\u30d0\u30a4\u30ca\u30ea\u9762\u5012\u3068\u601d\u3063\u3066\u5f8c\u56de\u3057\u306b\u3057\u3066\u3044\u305f\u3089\u3001\u6642\u9593\u304c\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u6642\u9593\u5207\u308c\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3060\u3051\u308c\u3069\u3001\u5b9f\u969b\u306f\u7c21\u5358\u306a\u554f\u984c\u3067\u3001\u3053\u308c\u3092\u5148\u306b\u89e3\u3044\u3066\u3044\u308c\u3070\u3068\u5f8c\u6094\u3002\n\n\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3092strings\u3057\u3066\u307f\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6587\u5b57\u5217\u304c\u898b\u3064\u304b\u308a\u3001\u307e\u305f`GetComputerNameA`\u304c\u4f7f\u308f\u308c\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308b\u3002\n\n```\nComputer Name: %s\nThis host is not the target.\nOperation Aborted.\nTargeted host found. Continue operation.\n```\n\nHopper\u3067\u3053\u306e\u6587\u5b57\u5217\u304c\u4f7f\u308f\u308c\u3066\u3044\u308b\u95a2\u6570\u3092\u898b\u3064\u3051\u3066\u30c7\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u307f\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u3002\n\n```c\nint sub_401080(int arg0, int arg1) {\n    eax = (*_mbsicmp)(arg0, arg1);\n    return eax;\n}\n\nint sub_4010a0() {\n    (*GetComputerNameA)(var_24, 0x10);\n    sub_401040(\"Computer Name: %s\\n\", var_24);\n    esp = ((esp - 0x4 - 0x4 - 0x4 - 0x4) + 0x8 - 0x4 - 0x4) + 0x8;\n    if (sub_401080(0x54, var_24) != 0x0) {\n            sub_401040(\"This host is not the target.\\nOperation Aborted.\\n\", stack[2038]);\n    }\n    else {\n            sub_401040(\"Targeted host found. Continue operation.\\n\", stack[2038]);\n            sub_401040(0x40217c, stack[2038]);\n    }\n    return 0x0;\n}\n```\n\n\u3069\u3046\u3082\u3046\u307e\u304f\u30c7\u30b3\u30f3\u30d1\u30a4\u30eb\u3067\u304d\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u30a2\u30bb\u30f3\u30d6\u30ea\u3092\u898b\u3066\u307f\u308b\u3068\u2026\u2026\n\n```\nsub_4010a0:\n004010a0         push       ebp                                                 ; XREF=sub_4011f8+268\n004010a1         mov        ebp, esp\n004010a3         sub        esp, 0x24\n004010a6         mov        dword [ss:ebp+var_4], 0x10\n004010ad         lea        eax, dword [ss:ebp+var_4]\n004010b0         push       eax\n004010b1         lea        ecx, dword [ss:ebp+var_24]\n004010b4         push       ecx\n004010b5         call       dword [ds:imp_GetComputerNameA]                     ; imp_GetComputerNameA\n004010bb         lea        edx, dword [ss:ebp+var_24]\n004010be         push       edx                                                 ; argument #2 for method sub_401040\n004010bf         push       0x402108                                            ; \"Computer Name: %s\\\\n\", argument #1 for method sub_401040\n004010c4         call       sub_401040\n004010c9         add        esp, 0x8\n004010cc         mov        byte [ss:ebp+var_14], 0x54\n004010d0         mov        byte [ss:ebp+var_13], 0x45\n004010d4         mov        byte [ss:ebp+var_12], 0x53\n004010d8         mov        byte [ss:ebp+var_11], 0x48\n004010dc         mov        byte [ss:ebp+var_10], 0x49\n004010e0         mov        byte [ss:ebp+var_F], 0x47\n004010e4         mov        byte [ss:ebp+var_E], 0x41\n004010e8         mov        byte [ss:ebp+var_D], 0x57\n004010ec         mov        byte [ss:ebp+var_C], 0x41\n004010f0         mov        byte [ss:ebp+var_B], 0x52\n004010f4         mov        byte [ss:ebp+var_A], 0x41\n004010f8         mov        byte [ss:ebp+var_9], 0x2d\n004010fc         mov        byte [ss:ebp+var_8], 0x50\n00401100         mov        byte [ss:ebp+var_7], 0x43\n00401104         mov        byte [ss:ebp+var_6], 0x0\n00401108         lea        eax, dword [ss:ebp+var_24]\n0040110b         push       eax                                                 ; argument #2 for method sub_401080\n0040110c         lea        ecx, dword [ss:ebp+var_14]\n0040110f         push       ecx                                                 ; argument #1 for method sub_401080\n00401110         call       sub_401080\n00401115         add        esp, 0x8\n00401118         test       eax, eax\n0040111a         je         0x40112b\n```\n\n`sub_401080` \u306e\u5f15\u6570\u306e\u6587\u5b57\u5217\u304c\u4ee5\u4e0b\u3067\u69cb\u7bc9\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u3001\u30a2\u30bb\u30f3\u30d6\u30e9\u8d85\u521d\u5fc3\u8005\u306e\u81ea\u5206\u3067\u3082\u5206\u304b\u308b\u3002\n\n```\n004010cc         mov        byte [ss:ebp+var_14], 0x54\n004010d0         mov        byte [ss:ebp+var_13], 0x45\n004010d4         mov        byte [ss:ebp+var_12], 0x53\n004010d8         mov        byte [ss:ebp+var_11], 0x48\n004010dc         mov        byte [ss:ebp+var_10], 0x49\n004010e0         mov        byte [ss:ebp+var_F], 0x47\n004010e4         mov        byte [ss:ebp+var_E], 0x41\n004010e8         mov        byte [ss:ebp+var_D], 0x57\n004010ec         mov        byte [ss:ebp+var_C], 0x41\n004010f0         mov        byte [ss:ebp+var_B], 0x52\n004010f4         mov        byte [ss:ebp+var_A], 0x41\n004010f8         mov        byte [ss:ebp+var_9], 0x2d\n004010fc         mov        byte [ss:ebp+var_8], 0x50\n00401100         mov        byte [ss:ebp+var_7], 0x43\n00401104         mov        byte [ss:ebp+var_6], 0x0\n00401108         lea        eax, dword [ss:ebp+var_24]\n0040110b         push       eax                                                 ; argument #2 for method sub_401080\n```\n\n\u3068\u308a\u3042\u3048\u305a\u3001`ghci`\u3067\u6587\u5b57\u5217\u306b\u623b\u3059\u3068\u300cTESHIGAWARA-PC\u300d\u304c\u5f97\u3089\u308c\u305f\u3002\n\n```\n> map toEnum [0x54,0x45,0x53,0x48,0x49,0x47,0x41,0x57,0x41,0x52,0x41,0x2d,0x50,0x43,0x0] :: String\n\"TESHIGAWARA-PC\\NUL\"\n```\n\n## \u540c\u4e00\u96c6\u56e3 (MISC)\n\n\u300c\u4f4f\u6240\u306a\u3069\u306f\u672c\u7269\u3067\u3042\u308b\u53ef\u80fd\u6027\u304c\u4f4e\u3044\u4e00\u65b9\u3067\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306f\u30c9\u30e1\u30a4\u30f3\u53d6\u5f97\u6642\u306b\u78ba\u8a8d\u30e1\u30fc\u30eb\u3092\u53d7\u3051\u53d6\u308b\u5fc5\u8981\u304c\u3042\u308b\u305f\u3081\u3001\u653b\u6483\u8005\u304c\u4fdd\u6301\u3057\u3066\u3044\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u3042\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u3067\u3059\u300d\u3068\u3044\u3046\u30d2\u30f3\u30c8\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u305f\u306e\u3067\u3001shinobot.com\u306e`whois`\u60c5\u5831\u306b\u3042\u3063\u305f\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u30b0\u30b0\u308b\u3068\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304b\u3089\u30c9\u30e1\u30a4\u30f3\u3092\u691c\u7d22\u3067\u304d\u308b\u3088\u3046\u306a\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308b\u306e\u3092\u767a\u898b\u3002\u4ee5\u4e0b\u306e4\u3064\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u3059\u3050\u306b\u898b\u3064\u304b\u3063\u305f\u306e\u3060\u3051\u308c\u3069\u3001\u672c\u756a\u4e2d\u306b\u306f\u6700\u5f8c\u306e\u4e00\u3064\u304c\u5206\u304b\u3089\u305a\u3002\n\n* noitalumis.info\n* mnd2015.info\n* shinolocker.com\n* mnctf.info\n\n\u4f55\u304b\u5225\u306e\u63a2\u3057\u65b9\u3092\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u304b\u3068\u601d\u3063\u305f\u304c\u3001\u5358\u306b\u305d\u306e\u30b5\u30a4\u30c8\u304c\u66f4\u65b0\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u304b\u4f55\u304b\u3067\u3001\u7d50\u5c40\u7279\u5225\u306a\u63a2\u3057\u65b9\u306f\u4e0d\u8981\u3060\u3063\u305f\u6a21\u69d8\u3002\u6700\u5f8c\u306e\u3072\u3068\u3064\u306fshinosec.com\u3060\u3063\u305f\u3002\n\n## \u96e3\u8aad\u8a18\u9332 (MISC)\n\n\u30ed\u30b0\u4e2d\u306e\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u540d\u306b\u30de\u30c3\u30c1\u3059\u308b\u6b63\u898f\u8868\u73fe\u3092\u66f8\u304f\u3060\u3051\u3002\u9069\u5f53\u306b`AD\\\\[A-F0-9]{6}`\u3068\u304b\u66f8\u3044\u305f\u3089\u4f59\u8a08\u306a\u3082\u306e\u3082\u30de\u30c3\u30c1\u3057\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\u305f\u3068\u3048\u3070`AD\\\\[A-F0-9]{6}\\b`\u306a\u3069\u3068\u3059\u308c\u3070\u826f\u3044\u3002\n\n## \u8d85\u6301\u682a\u4f1a (WEB)\n\n\u6539\u7ac4\u3057\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3059\u308c\u3070\u826f\u3044\u3002[Fiddler](http://www.telerik.com/fiddler)\u3068\u304b[Burp Suite](https://portswigger.net/burp/)\u3068\u304b\u3092\u4f7f\u3048\u308b\u3068\u30ab\u30c3\u30b3\u3088\u3044\u306e\u3060\u3051\u308c\u3069\u3001\u4f7f\u3063\u305f\u3053\u3068\u306a\u3044\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u958b\u767a\u8005\u30c4\u30fc\u30eb\u304b\u3089\u30d5\u30a9\u30fc\u30e0\u3092\u5909\u66f4\u3057\u3066\u30b5\u30d6\u30df\u30c3\u30c8\u3002\n\n```javascript\ndocument.getElementsByName(\"id\")[0].value = \"A20050023\"\nvar option = document.createElement(\"option\");\noption.text = \"1000\u53e3(1000,000\u682a)\";\noption.value = \"1000\";\ndocument.getElementsByName(\"stock\")[0].add(option)\ndocument.getElementsByName(\"stock\")[0].value = \"1000\"\n```\n\n## \u4e00\u884c\u633f\u5165 (WEB)\n\n\u5143\u306e\u30b3\u30fc\u30c9\u3092\u9069\u5f53\u306b\u6574\u5f62\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3002\n\n```javascript\neval(\n    function(p,a,c,k,e,r){\n        e=function(c){\n            return c.toString(a)\n        };\n        if(!''.replace(/^/,String)){\n            while(c--)\n                r[e(c)]=k[c]||e(c);\n            k=[function(e){return r[e]}];\n            e=function(){return'\\\\w+'};\n            c=1\n        };\n        while(c--)\n            if(k[c])\n                p=p.replace(new RegExp('\\\\b'+e(c)+'\\\\b','g'),k[c]);\n        return p\n    } ('e(6.5==\"c 1.0.0.1\"){3 4=[];3 2=6[\"5\"];2=2.o(\"\");b(3 i=0;i<2.d;i++){4.8(f.g(2[i].h(0)+i));j.k=(/[a-l-m-9]*/.n(4.7(\"\"))).7(\"\")+\\'.p\\'}}',26,26,'||ua|var|page|userAgent|navigator|join|push|||for|ShinoBrowser|length|if|String|fromCharCode|charCodeAt||window|location|zA|Z0|exec|split|html'.split('|'),0,{})\n)\n```\n\n\u6587\u5b57\u5217\u3092\u751f\u6210\u3057\u3066`eval`\u3057\u3066\u3044\u308b\u306e\u3067\u3001`eval`\u3092`alert`\u306b\u66f8\u304d\u63db\u3048\u3066\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30bd\u30fc\u30b9\u304c\u5f97\u3089\u308c\u308b(\u3053\u306e\u30bd\u30fc\u30b9\u306f\u6574\u5f62\u6e08\u307f)\u3002\n\n```javascript\nif(navigator.userAgent==\"ShinoBrowser 1.0.0.1\"){\n  var page=[];\n  var ua=navigator[\"userAgent\"];\n  ua=ua.split(\"\");\n  for(var i=0;i<ua.length;i++){\n    page.push(String.fromCharCode(ua[i].charCodeAt(0)+i));\n    window.location=(/[a-zA-Z0-9]*/.exec(page.join(\"\"))).join(\"\")+'.html'\n  }\n}\n```\n\n\u305d\u3053\u3067\u3001\u5c11\u3057\u66f8\u304d\u63db\u3048\u3066\u3001\u4ee5\u4e0b\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30d5\u30e9\u30b0\u304c\u5f97\u3089\u308c\u305f\u3002\n\n```javascript\nvar page=[];\nvar ua=\"ShinoBrowser 1.0.0.1\";\nua=ua.split(\"\");\nvar loc;\nfor(var i=0;i<ua.length;i++){\n  page.push(String.fromCharCode(ua[i].charCodeAt(0)+i));\n  loc=(/[a-zA-Z0-9]*/.exec(page.join(\"\"))).join(\"\")+'.html'\n}\nloc //=> \"SikqsGxv.html\"\n```\n\n## \u6697\u53f7\u65b0\u805e (CRYPT)\n\n\u30af\u30ed\u30b9\u30ef\u30fc\u30c9\u30d1\u30ba\u30eb\u3092\u89e3\u304f\u3060\u3051\u3067\u3001\u307b\u3068\u3093\u3069\u306e\u9805\u76ee\u306f\u7c21\u5358\u306a\u306e\u3060\u3051\u308c\u3069\u3001\u300cBitCoin\u306b\u3082\u4f7f\u308f\u308c\u3066\u3044\u308bRSA\u3092\u4eca\u5f8c\u7f6e\u304d\u63db\u3048\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\u6697\u53f7\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u300d(3\u6587\u5b57)\u304c\u5206\u304b\u3089\u305a\u3001\u3060\u3044\u3076\u6642\u9593\u3092\u4f7f\u3063\u3066\u3057\u307e\u3063\u305f\u3002\n\n\u305f\u3060\u3001\u5206\u304b\u3089\u306a\u3044\u306e\u306f\u4e8c\u6587\u5b57\u3060\u3051\u3060\u3063\u305f\u306e\u3067\u3001\u9811\u5f35\u3063\u3066\u30b0\u30b0\u3063\u305f\u308a\u3057\u3066\u308b\u3088\u308a\u3001\u7dcf\u5f53\u305f\u308a\u3057\u3066\u3057\u307e\u3063\u305f\u65b9\u304c\u65e9\u304b\u3063\u305f\u304b\u3082\u77e5\u308c\u306a\u3044\u3002\n\n```javascript\nvar cs = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nfor (var i = 0; i < cs.length; i++) {\n  for (var j = 0; j < cs.length; j++) {\n    var answer = \"PNGRTHTTPSLLAESMD5\" + cs[i] + \"E\" + cs[j] + \"SHA\"\n    if(md5(answer).substr(1,4)=='5545'){\n        //alert(answer)\n        alert(md5(answer))\n    }\n  }\n}\n```\n\n## \u6a29\u9650\u6607\u683c (BINARY)\n\n\u672c\u756a\u3067\u306f\u89e3\u304d\u65b9\u306e\u30a2\u30a4\u30c7\u30a3\u30a2\u304c\u601d\u3044\u3064\u304b\u305a\u3001\u300c\u8d85\u6a19\u7684\u578b\u300d\u3068\u540c\u3058\u304f\u5f8c\u56de\u3057\u306b\u3057\u3066\u3044\u305f\u3089\u3001\u6642\u9593\u304c\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u554f\u984c\u3002\n\n\u5f8c\u304b\u3089\u89e3\u3044\u305f\u969b\u306b\u306f\u3001\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306b`PowerShellExecutor`\u306a\u3069\u306e\u6587\u5b57\u5217\u304c\u898b\u3064\u304b\u3063\u305f\u305f\u3081\u3001PowerShell\u95a2\u4fc2\u306e\u8106\u5f31\u6027\u3068\u8e0f\u3093\u3067\u3001\u300cPowerShell \u6a29\u9650\u6607\u683c CVE\u300d\u3067\u30b0\u30b0\u3063\u305f\u3089\u3001\u300cCVE-2016-0099\u300d\u3092\u767a\u898b\u3002\u554f\u984c\u6587\u306b\u300c\u300cCVE____-_____\u300d\u306e\u5f62\u5f0f\u3067\u3053\u305f\u3048\u3066\u304f\u3060\u3055\u3044\u300d\u3068\u3042\u3063\u305f\u306e\u3067\u3001\u6700\u521d\u306e\u30cf\u30a4\u30d5\u30f3\u306f\u542b\u307e\u306a\u3044\u300cCVE2016-0099\u300d\u3067\u6295\u7a3f\u3057\u305f\u3089\u4e0d\u6b63\u89e3\u3067\u3001\u300cCVE-2016-0099\u300d\u3068\u3057\u305f\u3089\u6b63\u89e3\u3068\u306a\u3063\u305f\u3002\n\n\u305f\u3060\u3001\u73fe\u5b9f\u306e\u30a4\u30f3\u30b7\u30c7\u30f3\u30c8\u5bfe\u5fdc\u3060\u3068\u3001\u3053\u3093\u306a\u65b9\u6cd5\u3067\u7279\u5b9a\u3067\u304d\u308b\u3068\u306f\u9650\u3089\u306a\u3044\u3057\u3001\u3069\u3046\u3059\u308b\u306e\u304c\u60f3\u5b9a\u89e3\u6cd5\u3060\u3063\u305f\u3093\u3060\u308d\u3046\u306a\u3041\u3001\u3068\u601d\u3063\u3066\u3044\u305f\u3089\u3001[MNCTF2016 - CTF\u306eWrite-up\u7528\u30d6\u30ed\u30b0](http://iyfzce.hateblo.jp/entry/2016/07/08/143410)\u306b\u3001\u300c\u30d0\u30a4\u30ca\u30ea\u3092VirusTotal\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308c\u3070\u30d5\u30e9\u30b0\u304c\u51fa\u307e\u3059\u300d\u3068\u3042\u308a\u3001\u60c5\u30b7\u30b9\u5411\u3051\u3068\u3044\u3046\u3053\u3068\u3082\u8003\u3048\u308b\u3068\u3001\u306a\u308b\u307b\u3069\u3068\u601d\u3063\u305f\u3002\n\n## \u4e38\u6587\u5b57\u6587 (CRYPT)\n\n\u672c\u756a\u3067\u306f\u3001\u5404\u6587\u5b57\u306e\u983b\u5ea6\u3092\u8abf\u3079\u3066\u983b\u5ea6\u9806\u306b\u82f1\u8a9e\u306e\u6587\u5b57\u306e\u51fa\u73fe\u983b\u5ea6\u3068\u30de\u30c3\u30c1\u30f3\u30b0\u3057\u305f\u308a\u3001\u30e6\u30cb\u30b3\u30fc\u30c9\u306e\u30b3\u30fc\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u5bfe\u3057\u3066\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u3068\u3063\u3066\u307f\u305f\u308a\u3068\u304b\u3001\u8272\u3005\u3084\u3063\u305f\u3051\u308c\u3069\u3001\u7d50\u5c40\u305d\u308c\u3063\u307d\u3044\u7d50\u679c\u306f\u5f97\u3089\u308c\u305a\u3002\n\n\u5f8c\u304b\u3089\u89e3\u3044\u305f\u969b\u306b\u306f\u3001\u4e38\u6587\u5b57\u3092\u666e\u901a\u306e\u6587\u5b57\u306b\u623b\u3059\u3068base64\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u306b\u6c17\u4ed8\u3044\u3066[\u5fa9\u53f7\u3067\u304d\u305f](https://gist.github.com/msakai/e367f5572b591a9c0b46b7c5dfcc9aca)\u3002\u6700\u521d\u306b\u5404\u6587\u5b57\u306e\u51fa\u73fe\u983b\u5ea6\u3092\u8abf\u3079\u305f\u969b\u306b\u3001\u6587\u5b57\u7a2e\u304c64\u6587\u5b57\u3068\u3044\u3046\u6642\u70b9\u3067\u6c17\u3065\u304f\u3079\u304d\u3060\u3063\u305f\u2026\u2026\u3002\u3042\u3068\u306f\u3001\u5fa9\u53f7\u7d50\u679c\u306b\u66f8\u3044\u3066\u3042\u308b\u7c21\u5358\u306a\u30af\u30a4\u30ba\u306b\u7b54\u3048\u308b\u3060\u3051\u3002\n\n\u305f\u3060\u3001[\u5f97\u3089\u308c\u305f\u7b54\u3048\u3092\u30b5\u30d6\u30df\u30c3\u30c8\u3057\u3066\u3082\u6b63\u89e3\u306b\u306a\u3089\u305a\u3001\u5831\u544a\u3057\u3066\u5bfe\u5fdc\u3057\u3066\u3082\u3089\u3063\u305f](https://twitter.com/masahiro_sakai/status/751760827766550528)\u3002\u305d\u308c\u307e\u3067\u306b\u8ab0\u3082\u6307\u6458\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u3088\u3046\u306a\u306e\u3067\u3001\u4e00\u756a\u4e57\u308a\u3060\u3063\u305f\u304b\u3082\u77e5\u308c\u306a\u3044\u3002\n\n# \u7d50\u679c\n\n\u5f53\u65e5\u306e\u7d50\u679c\u3068\u3057\u3066\u306f\u300c\u70b9\u547c\u300d\u3001\u300c\u540c\u4e00\u96c6\u56e3\u300d(4/5)\u3001\u300c\u96e3\u8aad\u8a18\u9332\u300d\u3001\u300c\u8d85\u6301\u682a\u4f1a\u300d\u3001\u300c\u4e00\u884c\u633f\u5165\u300d\u3001\u300c\u6697\u53f7\u65b0\u805e\u300d\u3092\u89e3\u3044\u3066\u3001\u8a08205\u70b9\u306712\u4f4d\u3060\u3063\u305f\u3002\u3082\u3046\u3061\u3087\u3044\u3044\u3051\u308b\u304b\u3068\u601d\u3063\u305f\u304c\u6b8b\u5ff5\u2026\u2026\n\n\u73fe\u5728\u306e\u30b9\u30b3\u30a2\u30dc\u30fc\u30c9\u3067\u306f\u3001\u4e38\u6587\u5b57\u6587\u306e1\u70b9\u5206\u306b\u4e00\u756a\u4e57\u308a\u3060\u3063\u305f\u306e\u3067\u3001\u305d\u308c\u3092\u542b\u3080\u6e80\u70b9\u3092\u6700\u521d\u306b\u3068\u3063\u305f\u3053\u3068\u306b\u306a\u308a\u30011\u4f4d\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n# \u53c2\u8003\n\n\u4ed6\u306e\u65b9\u306eWrite-up\u7b49\n\n* [MNCTF2016 - CTF\u306eWrite-up\u7528\u30d6\u30ed\u30b0](http://iyfzce.hateblo.jp/entry/2016/07/08/143410)\n* [\u30de\u30af\u30cb\u30ab\u3088\uff01\u79c1\u306f\u5e30\u3063\u3066\u304d\u305f\uff01\uff01 MNCTF2016 writeup - \u3046\u3055\u30d6\u30ed](http://ra66itblog.hateblo.jp/entry/2016/07/10/011648)\n\n", "tags": ["CTF", "MNCTF"]}