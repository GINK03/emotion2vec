{"context": "\n\n\u624b\u9806\n\nPHP\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u6700\u65b0\u306eyum\u30ea\u30dd\u30b8\u30c8\u30ea\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n$ sudo yum -y update\n$ sudo rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n$ sudo rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm\n\n\nPHP7.1\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# PHP\u306eextension\u306f\u5404\u81ea\u3067\u5fc5\u8981\u306a\u3082\u306e\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n# \u7279\u306b mod_php71w, php71w-fpm, php71w-cli \u306f\u6700\u4f4e\u3067\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n# Extension\u306e\u4e00\u89a7\u306f yum search php71w \u3068\u691c\u7d22\u3059\u308c\u3070\u898b\u308c\u307e\u3059\u3002\n$ sudo yum -y install mod_php71w php71w-fpm php71w-common php71w-cli php71w-opcache php71w-pdo\n\nPHP7.1\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u304b\u78ba\u8a8d\n# \u4ee5\u4e0b\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\n$ php -v\nPHP 7.1.0 (cli) (built: Dec  3 2016 11:17:43) ( NTS )\nCopyright (c) 1997-2016 The PHP Group\nZend Engine v3.1.0-dev, Copyright (c) 1998-2016 Zend Technologies\n\n\nnginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum -y install nginx\n\nnginx\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u304b\u78ba\u8a8d\n# \u4ee5\u4e0b\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\n$ nginx -v\nnginx version: nginx/1.10.2\n\n\nphp-fpm\u306e\u8a2d\u5b9a\nwww.conf\u306e\u8a2d\u5b9a\u5909\u66f4\nsudo vim /etc/php-fpm.d/www.conf\n\n# \u4ee5\u4e0b\u306b\u5909\u66f4\nuser = nginx\ngroup = nginx\nlisten = /var/run/php-fpm/php-fpm.sock\nlisten.owner = nginx # ;\u306e\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3059\uff01\nlisten.group = nginx # ;\u306e\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3059\uff01\n\nphp-fpm\u306e\u8d77\u52d5&\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n# php-fpm \u8d77\u52d5\n$ sudo systemctl start php-fpm\n\n# php-fpm \u81ea\u52d5\u8d77\u52d5\n$ sudo systemctl enable php-fpm\n\n# \u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\uff06\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\n$ sudo systemctl status php-fpm\n\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3000/usr/lib/systemd/system/php-fpm.service; enabled;\u3000\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\nLoaded: loaded (/usr/lib/systemd/system/php-fpm.service; enabled; vendor preset: disabled)\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b9\u30c6\u30fc\u30bf\u30b9\u304cactive\u306b\u306a\u3063\u3066\u3044\u308c\u3070php-fpm\u304c\u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\nActive: active (running)\n\n\nnginx\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u8a2d\u5b9a\nsites-available\u306bconf\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n$ sudo mkdir /etc/nginx/sites-available\n$ sudo vim /etc/nginx/sites-available/dev.mysite.com.conf\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a2d\u5b9a\uff08\u81ea\u5206\u3082\u5b8c\u74a7\u306b\u306f\u7406\u89e3\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u30e1\u30e2\uff09\nserver {\n    listen 80;\n    server_name dev.mysite.com; # \u30c9\u30e1\u30a4\u30f3\n    root /var/www/dev.mysite.com; # \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\uff08\u3042\u3068\u3067\u4f5c\u6210\uff09\n\n    location / {\n        # \u30d5\u30a1\u30a4\u30eb\u53d6\u5f97\u306e\u30eb\u30fc\u30eb\u8a2d\u5b9a\n        try_files $uri $uri/ index.php$is_args$args =404;\n    }\n\n    # php-fpm\u306e\u8a2d\u5b9a\n    location ~ ^/index\\.php(/|$) {\n        fastcgi_pass   unix:/var/run/php-fpm/php-fpm.sock;\n\n        fastcgi_split_path_info ^(.+\\.php)(/.*)$;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param HTTPS off;\n    }\n}\n\nsites-enabled\u306bconf\u30d5\u30a1\u30a4\u30eb\u306e\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308b\n$ sudo mkdir /etc/nginx/sites-enabled\n$ cd /etc/nginx/sites-enabled\n$ sudo ln -s ../sites-available/dev.mysite.com.conf\n\nnginx.conf\u306bsites-enabled\u306b\u3042\u308bconfig\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307e\u305b\u308b\u8a2d\u5b9a\u3001index\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n$ sudo vim /etc/nginx/nginx.conf\n\nindex index.htm index.html index.php; # \u3053\u308c\u3092\u8ffd\u52a0\n\n# Load modular configuration files from the /etc/nginx/conf.d directory.\n# See http://nginx.org/en/docs/ngx_core_module.html#include\n# for more information.\ninclude /etc/nginx/sites-enabled/*.conf; # \u3053\u308c\u3092\u8ffd\u52a0\ninclude /etc/nginx/conf.d/*.conf;\n\nnginx\u306e\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30c1\u30a7\u30c3\u30af\n$ sudo nginx -t\n# \u4ee5\u4e0b\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308c\u3070\u5927\u4e08\u592b\nnginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /etc/nginx/nginx.conf test is successful\n\nnginx\u306e\u8d77\u52d5&\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n# nginx \u8d77\u52d5\n$ sudo systemctl start nginx\n\n# nginx \u81ea\u52d5\u8d77\u52d5\n$ sudo systemctl enable nginx\n\n# \u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\uff06\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\n$ sudo systemctl status nginx\n\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3000/usr/lib/systemd/system/nginx.service; enabled;\u3000\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\nLoaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; vendor preset: disabled)\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b9\u30c6\u30fc\u30bf\u30b9\u304cactive\u306b\u306a\u3063\u3066\u3044\u308c\u3070nginx\u304c\u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\nActive: active (running)\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u4f5c\u6210\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306b\u306a\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n$ sudo mkdir -p /var/www/dev.mysite.com\n$ sudo chown -R $USER:$USER /var/www/dev.mysite.com\n\nphp\u52d5\u4f5c\u78ba\u8a8d\u7528php\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n$ sudo vim /var/www/dev.mysite.com/index.php\n\n<?php\nphpinfo();\n\nnginx\u306e\u518d\u8d77\u52d5\uff08\u81ea\u5206\u306e\u5834\u5408\u306f\u518d\u8d77\u52d5\u306e\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u3002\u3002\u7406\u7531\u306f\u308f\u304b\u308a\u307e\u305b\u3093w\uff09\n$ sudo systemctl restart nginx\n$ sudo systemctl restart php-fpm\n\n\u4eca\u56de\u306fvagrant\u3067\u74b0\u5883\u69cb\u7bc9\u3057\u305f\u306e\u3067\u3001\u81ea\u5206\u306ePC\u306ehosts\u66f8\u304d\u63db\u3048\nsudo vim /etc/hosts\n\n# \u4ee5\u4e0b\u3092\u8ffd\u52a0\n[IP\u30a2\u30c9\u30ec\u30b9] dev.mysite.com\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u8868\u793a\u78ba\u8a8d\ndev.mysite.com\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u3066\u8868\u793a\u78ba\u8a8d\u3059\u308b\n# \u624b\u9806\n\n## PHP\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n### \u6700\u65b0\u306eyum\u30ea\u30dd\u30b8\u30c8\u30ea\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n```bash\n$ sudo yum -y update\n$ sudo rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n$ sudo rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm\n```\n\n### PHP7.1\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n# PHP\u306eextension\u306f\u5404\u81ea\u3067\u5fc5\u8981\u306a\u3082\u306e\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n# \u7279\u306b mod_php71w, php71w-fpm, php71w-cli \u306f\u6700\u4f4e\u3067\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n# Extension\u306e\u4e00\u89a7\u306f yum search php71w \u3068\u691c\u7d22\u3059\u308c\u3070\u898b\u308c\u307e\u3059\u3002\n$ sudo yum -y install mod_php71w php71w-fpm php71w-common php71w-cli php71w-opcache php71w-pdo\n```\nPHP7.1\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u304b\u78ba\u8a8d\n\n```bash\n# \u4ee5\u4e0b\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\n$ php -v\nPHP 7.1.0 (cli) (built: Dec  3 2016 11:17:43) ( NTS )\nCopyright (c) 1997-2016 The PHP Group\nZend Engine v3.1.0-dev, Copyright (c) 1998-2016 Zend Technologies\n```\n\n### nginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ sudo yum -y install nginx\n```\n\nnginx\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u304b\u78ba\u8a8d\n\n```bash\n# \u4ee5\u4e0b\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\u3067\u3059\n$ nginx -v\nnginx version: nginx/1.10.2\n```\n\n### php-fpm\u306e\u8a2d\u5b9a\nwww.conf\u306e\u8a2d\u5b9a\u5909\u66f4\n\n```bash\nsudo vim /etc/php-fpm.d/www.conf\n\n# \u4ee5\u4e0b\u306b\u5909\u66f4\nuser = nginx\ngroup = nginx\nlisten = /var/run/php-fpm/php-fpm.sock\nlisten.owner = nginx # ;\u306e\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3059\uff01\nlisten.group = nginx # ;\u306e\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3059\uff01\n```\n\nphp-fpm\u306e\u8d77\u52d5&\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n\n```bash\n# php-fpm \u8d77\u52d5\n$ sudo systemctl start php-fpm\n\n# php-fpm \u81ea\u52d5\u8d77\u52d5\n$ sudo systemctl enable php-fpm\n\n# \u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\uff06\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\n$ sudo systemctl status php-fpm\n\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3000/usr/lib/systemd/system/php-fpm.service; enabled;\u3000\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\nLoaded: loaded (/usr/lib/systemd/system/php-fpm.service; enabled; vendor preset: disabled)\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b9\u30c6\u30fc\u30bf\u30b9\u304cactive\u306b\u306a\u3063\u3066\u3044\u308c\u3070php-fpm\u304c\u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\nActive: active (running)\n```\n\n### nginx\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u8a2d\u5b9a\nsites-available\u306bconf\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\n```bash\n$ sudo mkdir /etc/nginx/sites-available\n$ sudo vim /etc/nginx/sites-available/dev.mysite.com.conf\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a2d\u5b9a\uff08\u81ea\u5206\u3082\u5b8c\u74a7\u306b\u306f\u7406\u89e3\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u30e1\u30e2\uff09\n\n```nginx\nserver {\n    listen 80;\n    server_name dev.mysite.com; # \u30c9\u30e1\u30a4\u30f3\n    root /var/www/dev.mysite.com; # \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\uff08\u3042\u3068\u3067\u4f5c\u6210\uff09\n\n    location / {\n        # \u30d5\u30a1\u30a4\u30eb\u53d6\u5f97\u306e\u30eb\u30fc\u30eb\u8a2d\u5b9a\n        try_files $uri $uri/ index.php$is_args$args =404;\n    }\n\n    # php-fpm\u306e\u8a2d\u5b9a\n    location ~ ^/index\\.php(/|$) {\n        fastcgi_pass   unix:/var/run/php-fpm/php-fpm.sock;\n\n        fastcgi_split_path_info ^(.+\\.php)(/.*)$;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param HTTPS off;\n    }\n}\n```\n\nsites-enabled\u306bconf\u30d5\u30a1\u30a4\u30eb\u306e\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308b\n\n```bash\n$ sudo mkdir /etc/nginx/sites-enabled\n$ cd /etc/nginx/sites-enabled\n$ sudo ln -s ../sites-available/dev.mysite.com.conf\n```\n\nnginx.conf\u306bsites-enabled\u306b\u3042\u308bconfig\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307e\u305b\u308b\u8a2d\u5b9a\u3001index\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n\n```bash\n$ sudo vim /etc/nginx/nginx.conf\n```\n\n```nginx\nindex index.htm index.html index.php; # \u3053\u308c\u3092\u8ffd\u52a0\n\n# Load modular configuration files from the /etc/nginx/conf.d directory.\n# See http://nginx.org/en/docs/ngx_core_module.html#include\n# for more information.\ninclude /etc/nginx/sites-enabled/*.conf; # \u3053\u308c\u3092\u8ffd\u52a0\ninclude /etc/nginx/conf.d/*.conf;\n```\n\nnginx\u306e\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30c1\u30a7\u30c3\u30af\n\n```bash\n$ sudo nginx -t\n# \u4ee5\u4e0b\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u308c\u3070\u5927\u4e08\u592b\nnginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /etc/nginx/nginx.conf test is successful\n```\n\nnginx\u306e\u8d77\u52d5&\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n\n```bash\n# nginx \u8d77\u52d5\n$ sudo systemctl start nginx\n\n# nginx \u81ea\u52d5\u8d77\u52d5\n$ sudo systemctl enable nginx\n\n# \u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\uff06\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\n$ sudo systemctl status nginx\n\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3000/usr/lib/systemd/system/nginx.service; enabled;\u3000\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\nLoaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; vendor preset: disabled)\n# \u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b9\u30c6\u30fc\u30bf\u30b9\u304cactive\u306b\u306a\u3063\u3066\u3044\u308c\u3070nginx\u304c\u8d77\u52d5\u3055\u308c\u3066\u3044\u308b\nActive: active (running)\n```\n\n### \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u4f5c\u6210\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u30eb\u30fc\u30c8\u306b\u306a\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n\n```bash\n$ sudo mkdir -p /var/www/dev.mysite.com\n$ sudo chown -R $USER:$USER /var/www/dev.mysite.com\n```\n\nphp\u52d5\u4f5c\u78ba\u8a8d\u7528php\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\n```bash\n$ sudo vim /var/www/dev.mysite.com/index.php\n```\n\n```php\n<?php\nphpinfo();\n```\n\nnginx\u306e\u518d\u8d77\u52d5\uff08\u81ea\u5206\u306e\u5834\u5408\u306f\u518d\u8d77\u52d5\u306e\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u3002\u3002\u7406\u7531\u306f\u308f\u304b\u308a\u307e\u305b\u3093w\uff09\n\n```bash\n$ sudo systemctl restart nginx\n$ sudo systemctl restart php-fpm\n```\n\n\u4eca\u56de\u306fvagrant\u3067\u74b0\u5883\u69cb\u7bc9\u3057\u305f\u306e\u3067\u3001\u81ea\u5206\u306ePC\u306ehosts\u66f8\u304d\u63db\u3048\n\n```\nsudo vim /etc/hosts\n\n# \u4ee5\u4e0b\u3092\u8ffd\u52a0\n[IP\u30a2\u30c9\u30ec\u30b9] dev.mysite.com\n```\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u8868\u793a\u78ba\u8a8d\ndev.mysite.com\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u3066\u8868\u793a\u78ba\u8a8d\u3059\u308b\n", "tags": ["PHP", "nginx", "php-fpm"]}