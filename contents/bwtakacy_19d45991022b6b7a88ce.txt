{"context": "Treasure Data\u4e0a\u3067\u306e\u30b8\u30e7\u30d6\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u304c\u4f5c\u6210\u30fb\u7ba1\u7406\u3067\u304d\u308bTreaure Workflow\u3092\u89e6\u3063\u3066\u307f\u305f\u30e1\u30e2\u3002\n\nTreasure Workflow\u306e\u7279\u5fb4\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u6319\u3052\u3089\u308c\u3066\u3044\u308b\u7279\u5fb4\u3092\u8a33\u3059\u3002\n\nDAG\u5f62\u5f0f\u306e\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u304c\u4f5c\u6210\u3067\u304d\u308b\n\u30ed\u30fc\u30ab\u30eb\u3067\u5b9f\u88c5\u3057\u3066Treasure Data\u306b\u767b\u9332\u3057\u3066\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u5b9f\u884c\u3055\u305b\u3089\u308c\u308b\u3002\u307e\u3055\u306b\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u306eSaas\nTreasure Data\u306e\u6a5f\u80fd\u304c\u4f7f\u3048\u308b\u3002Data Connector\u306b\u3088\u308b\u30c7\u30fc\u30bf\u30a4\u30f3\u30dd\u30fc\u30c8, Presto, Hive\u3067\u306e\u30af\u30a8\u30ea\u5b9f\u884c\u3001\u4ed6\u30b7\u30b9\u30c6\u30e0\u3078\u306e\u30c7\u30fc\u30bf\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\n\u518d\u5229\u7528\u3057\u3084\u3059\u3044\u30d1\u30e9\u30e1\u30bf\u5316\uff08\u4f55\u3092\u8a00\u3063\u3066\u3044\u308b\u306e\u304b\u3044\u307e\u3044\u3061\u5206\u304b\u3089\u305a\u3002\u3002\u3002\uff09\n\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u5931\u6557\u3084SLA\u672a\u9054\u306e\u5834\u5408\u306b\u30a2\u30e9\u30fc\u30c8\u901a\u77e5\n\n\u305d\u306e\u4ed6\u3001\u30bf\u30b9\u30af\u306e\u4e26\u5217\u5b9f\u884c\u6a5f\u80fd\u3082\u3042\u308b\u3002\n\u30d9\u30fc\u30b9\u306b\u306a\u3063\u3066\u3044\u308b\u30a8\u30f3\u30b8\u30f3\u306fDigdag\u3068\u3057\u3066OSS\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u3002\nTreasure Workflow\u306fDigdag\u306e\u4e00\u90e8\u6a5f\u80fd\u304c\u4f7f\u3048\u306a\u3044\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u306e\u3053\u3068\u3002\n\u307e\u305f\u3001Treasure Workflow\u3068\u3057\u3066\u3082public beta\u306a\u306e\u3067\u8272\u3005\u3068\u5236\u9650\u306f\u3042\u308b\u69d8\u5b50\u3002\n\n\u52d5\u304b\u3057\u3066\u307f\u308b\n\nTutorial\u3092\u8a66\u3059\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u5f93\u3063\u3066\u8a66\u3059\u3002\n\u306a\u304a\u3001\u4e8b\u524d\u306bTreasure Data\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b3\u30de\u30f3\u30c9\u30c4\u30fc\u30ebTD Toolbelt\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\ntd workflow\u3092\u5b9f\u884c\u3059\u308b\u3068\u521d\u56de\u6642\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u8d70\u308b\u3002\n$ td workflow\nWorkflow module not yet installed, download now? [Y/n]\nY\nDownloading Java...: done                                                                                               \nInstalling Java... done\nDownloading workflow module...: done                                                                                    \nInstalling workflow module... done\n2016-10-12 00:44:02 +0900: Digdag v0.8.17\nUsage: td workflow <command> [options...]\n  Local-mode commands:\n    init <dir>                         create a new workflow project\n    r[un] <workflow.dig>               run a workflow\n    c[heck]                            show workflow definitions\n    sched[uler]                        run a scheduler server\n    selfupdate                         update cli to the latest version\n\n  Server-mode commands:\n    server                             start server\n\n  Client-mode commands:\n    push <project-name>                create and upload a new revision\n    start <project-name> <name>        start a new session attempt of a workflow\n    retry <attempt-id>                 retry a session\n    kill <attempt-id>                  kill a running session attempt\n    backfill <project-name> <name>     start sessions of a schedule for past times\n    reschedule                         skip sessions of a schedule to a future time\n    log <attempt-id>                   show logs of a session attempt\n    workflows [project-name] [name]    show registered workflow definitions\n    schedules                          show registered schedules\n    disable <schedule-id>              disable a workflow schedule\n    disable <project-name>             disable all workflow schedules in a project\n    disable <project-name> <name>      disable a workflow schedule\n    enable <schedule-id>               enable a workflow schedule\n    enable <project-name>              enable all workflow schedules in a project\n    enable <project-name> <name>       enable a workflow schedule\n    sessions                           show sessions for all workflows\n    sessions <project-name>            show sessions for all workflows in a project\n    sessions <project-name> <name>     show sessions for a workflow\n    session  <session-id>              show a single session\n    attempts                           show attempts for all sessions\n    attempts <session-id>              show attempts for a session\n    attempt  <attempt-id>              show a single attempt\n    tasks <attempt-id>                 show tasks of a session attempt\n    delete <project-name>              delete a project\n    secrets --project <project-name>   manage secrets\n    version                            show client and server version\n\n  Options:\n    -L, --log PATH                   output log messages to a file (default: -)\n    -l, --log-level LEVEL            log level (error, warn, info, debug or trace)\n    -X KEY=VALUE                     add a performance system config\n    -c, --config PATH.properties     Configuration file (default: /Users/oonishitk/.config/digdag/config)\n\nUse `<command> --help` to see detailed usage of a command.\n\n\u306a\u304a\u3001td workflow\u30b3\u30de\u30f3\u30c9\u306ftd wf\u3068\u7701\u7565\u3057\u3066\u5b9f\u884c\u3067\u304d\u308b\u3002\u3053\u308c\u306f\u52a9\u304b\u308b\u3002\nTutorial\u7528\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u308b\u3002\n$ td db:create workflow_temp\nDatabase 'workflow_temp' is created.\nUse 'td table:create workflow_temp <table_name>' to create a table.\n\nTutorial\u7528\u306e\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u30b5\u30f3\u30d7\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u308b\u3002\n$ cd ~/Downloads\n$ curl -o nasdaq_analysis.zip -L https://gist.github.com/danielnorberg/f839e5f2fd0d1a27d63001f4fd19b947/raw/d2d6dd0e3d419ea5d18b1c1e7ded9ec106c775d4/nasdaq_analysis.zip\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0\n100  1403  100  1403    0     0    933      0  0:00:01  0:00:01 --:--:--   933\n$ unzip nasdaq_analysis.zip \nArchive:  nasdaq_analysis.zip\n   creating: nasdaq_analysis/\n  inflating: nasdaq_analysis/nasdaq_analysis.dig  \n   creating: nasdaq_analysis/queries/\n  inflating: nasdaq_analysis/queries/daily_open.sql  \n  inflating: nasdaq_analysis/queries/monthly_open.sql\n$ cd nasdaq_analysis\n$ ls -l\ntotal 8\n-rw-r--r--  1 oonishitk  staff  224  4 27 08:34 nasdaq_analysis.dig\ndrwxr-xr-x  4 oonishitk  staff  136  4 27 08:31 queries\n\n\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u306e\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u611f\u3058\u3002\ntask1\u3068task2\u3092\u30b7\u30ea\u30a2\u30eb\u306b\u5b9f\u884c\u3059\u308b\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\nnasdaq_analysis.dig\ntimezone: UTC\n\nschedule:\n  daily>: 07:00:00\n\n_export:\n  td:\n    database: workflow_temp\n\n+task1:\n  td>: queries/daily_open.sql\n  create_table: daily_open\n\n+task2:\n  td>: queries/monthly_open.sql\n  create_table: monthly_open\n\n\ntd workflow run\u3067Treasure Data\u306b\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u767b\u9332\u305b\u305a\u306b\u3001\u30ef\u30f3\u30b7\u30e7\u30c3\u30c8\u5b9f\u884c\u3055\u305b\u308b\u3002\n$ td workflow run nasdaq_analysis\n2016-10-12 00:51:36 +0900: Digdag v0.8.17\n2016-10-12 00:51:37 +0900 [WARN] (main): Using a new session time 2016-10-11T00:00:00+00:00 based on schedule.\n2016-10-12 00:51:37 +0900 [INFO] (main): Using session /Users/bwtakacy/Downloads/nasdaq_analysis/.digdag/status/20161011T000000+0000.\n2016-10-12 00:51:37 +0900 [INFO] (main): Starting a new session project id=1 workflow name=nasdaq_analysis session_time=2016-10-11T00:00:00+00:00\n2016-10-12 00:51:38 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:38 +0900 [INFO] (0018@+nasdaq_analysis+task1): td-client version: 0.7.26\n2016-10-12 00:51:38 +0900 [INFO] (0018@+nasdaq_analysis+task1): Logging initialized @2621ms\n2016-10-12 00:51:39 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:40 +0900 [INFO] (0018@+nasdaq_analysis+task1): Started presto job id=95352325:\nDROP TABLE IF EXISTS \"daily_open\";\nCREATE TABLE \"daily_open\" AS\nSELECT \n    TD_DATE_TRUNC('day', time), AVG(open) AS daily_avg_open, AVG(close) AS daily_avg_close\nFROM \n    sample_datasets.nasdaq\nWHERE\n    TD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n    1\n\n2016-10-12 00:51:42 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:45 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:50 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:52 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\n2016-10-12 00:51:52 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\n2016-10-12 00:51:54 +0900 [INFO] (0018@+nasdaq_analysis+task2): Started presto job id=95352354:\nDROP TABLE IF EXISTS \"monthly_open\";\nCREATE TABLE \"monthly_open\" AS\nSELECT \n    TD_DATE_TRUNC('month', time), \n    AVG(daily_avg_open) AS monthly_avg_open, \n    AVG(daily_avg_close) AS month_avg_close\nFROM \n    daily_open\nWHERE\n    TD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n    1\n2016-10-12 00:51:55 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\n2016-10-12 00:51:58 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\n2016-10-12 00:52:03 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\nSuccess. Task state is saved at /Users/bwtakacy/Downloads/nasdaq_analysis/.digdag/status/20161011T000000+0000 directory.\n  * Use --session <daily | hourly | \"yyyy-MM-dd[ HH:mm:ss]\"> to not reuse the last session time.\n  * Use --rerun, --start +NAME, or --goal +NAME argument to rerun skipped tasks.\n\n\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u304c\u6b63\u5e38\u306b\u5b9f\u884c\u3055\u308c\u305f\u7d50\u679c\u3001\u30af\u30a8\u30ea\u306e\u7d50\u679c\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\n$ td table:show workflow_temp daily_open\nName        : workflow_temp.daily_open\nType        : log\nCount       : 438\nSchema      : (\n    _col0:long\n    daily_avg_open:double\n    daily_avg_close:double\n)\n$ td table:show workflow_temp monthly_open\nName        : workflow_temp.monthly_open\nType        : log\nCount       : 0\nSchema      : (\n    _col0:long\n    monthly_avg_open:double\n    month_avg_close:double\n)\n\n\u3055\u3066\u3001\u3053\u306e\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3092Treasure Data\u306b\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u30b8\u30e7\u30d6\u3068\u3057\u3066\u767b\u9332\u3059\u308b\u3002\n$ td workflow push nasdaq_analysis\n2016-10-12 00:56:41 +0900: Digdag v0.8.17\nCreating .digdag/tmp/archive-5329639364818920963.tar.gz...\n  Archiving nasdaq_analysis.dig\n  Archiving queries/daily_open.sql\n  Archiving queries/monthly_open.sql\nWorkflows:\n  nasdaq_analysis\n\nUploaded:\n  id: 38188\n  name: nasdaq_analysis\n  revision: 7405dfb8-8176-44de-8983-b8419cb7f79a\n  archive type: db\n  project created at: 2016-10-11T15:56:44Z\n  revision updated at: 2016-10-11T15:56:44Z\n\nUse `td workflow workflows` to show all workflows.\n\n\u767b\u9332\u3055\u308c\u305f\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u30b8\u30e7\u30d6\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089\u78ba\u8a8d\u3067\u304d\u308b\u3002\n$ td workflow workflows\n2016-10-12 00:56:52 +0900: Digdag v0.8.17\n  nasdaq_analysis\n    nasdaq_analysis\n\nUse `td workflow workflows <project-name> <name>` to show details.\n$ td workflow workflows nasdaq_analysis nasdaq_analysis\n2016-10-12 00:57:22 +0900: Digdag v0.8.17\n_export:\n  td:\n    database: \"workflow_temp\"\nschedule:\n  daily>: \"07:00:00\"\n+task1:\n  td>: \"queries/daily_open.sql\"\n  create_table: \"daily_open\"\n+task2:\n  td>: \"queries/monthly_open.sql\"\n  create_table: \"monthly_open\"\n\n$ td workflow schedules\n2016-10-12 00:58:37 +0900: Digdag v0.8.17\nSchedules:\n  id: 112\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  disabled at: \n  next session time: 2016-10-12 00:00:00 +0000\n  next scheduled to run at: 2016-10-12 16:00:00 +0900 (in 15h 1m 22s)\n\n1 entries.\nUse `td workflow workflows [project-name] [workflow-name]` to show workflow details.\n\n\u307e\u305f\u3001\u4e00\u6642\u7684\u306b\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u5b9f\u884c\u3092\u7121\u52b9\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n$ td wf disable nasdaq_analysis\n2016-10-12 23:01:53 +0900: Digdag v0.8.17\nDisabled schedule id: 112\n[23:01:57 bwtakacy ~]$ td wf schedules\n2016-10-12 23:02:02 +0900: Digdag v0.8.17\nSchedules:\n  id: 112\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  disabled at: 2016-10-12 23:01:57 +0900 (-5s ago)\n  next session time: 2016-10-13 00:00:00 +0000\n  next scheduled to run at: 2016-10-13 16:00:00 +0900 (in 16h 57m 57s)\n\n1 entries.\nUse `td workflow workflows [project-name] [workflow-name]` to show workflow details.\n\n\u518d\u3073\u6709\u52b9\u306b\u3059\u308b\u306b\u306ftd wf enable\u3092\u5229\u7528\u3059\u308b\u3002\n\n\u969c\u5bb3\u6642\u306e\u6319\u52d5\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3060\u3068\u3053\u3053\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\n\u306a\u304a\u3001\u540c\u69d8\u306e\u60c5\u5831\u306fWeb\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3067\u3082\u30dd\u30c1\u30dd\u30c1\u3068\u78ba\u8a8d\u3067\u304d\u308b\u3002\nhttps://workflows.treasuredata.com\n\u6700\u521d\u306b\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3092\u5931\u6557\u3055\u305b\u308b\u305f\u3081\u306b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u306b\u3001\u308f\u3056\u3068\u53c2\u7167\u5148\u306e\u30c6\u30fc\u30d6\u30eb\u540d\u3092typo\u3057\u3066\u307f\u308b\u3002\n\nmonthly_open.sql\nSELECT \n    TD_DATE_TRUNC('month', time), \n    AVG(daily_avg_open) AS monthly_avg_open, \n    AVG(daily_avg_close) AS month_avg_close\nFROM \n    daily_opne  // \u672c\u5f53\u306fdaily_open\nWHERE\n    TD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n    1\n\n\n\u3053\u308c\u3092\u77e5\u3089\u306a\u3044\u3082\u306e\u3068\u3057\u3066\u3001\u30b8\u30e7\u30d6\u30a8\u30e9\u30fc\u304b\u3089\u3069\u3046\u3084\u3063\u3066\u539f\u56e0\u7279\u5b9a\u304c\u3067\u304d\u308b\u304b\u3068\u3044\u3046\u306e\u304c\u4ee5\u4e0b\u306e\u30b9\u30c6\u30c3\u30d7\u3002\n\u307e\u305a\u306f\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u30b8\u30e7\u30d6\u3068\u3057\u3066Treasure Data\u306b\u767b\u9332\u3057\u3066\u304a\u304f\u3002\n$ td wf push nasdaq_analysis\n2016-10-12 23:05:41 +0900: Digdag v0.8.17\nCreating .digdag/tmp/archive-2082789604168105713.tar.gz...\n  Archiving nasdaq_analysis.dig\n  Archiving queries/daily_open.sql\n  Archiving queries/monthly_open.sql\nWorkflows:\n  nasdaq_analysis\n\nUploaded:\n  id: 38188\n  name: nasdaq_analysis\n  revision: d98ff854-8a67-47e6-a961-025fde657def\n  archive type: db\n  project created at: 2016-10-11T15:56:44Z\n  revision updated at: 2016-10-12T14:05:45Z\n\nUse `td workflow workflows` to show all workflows.\n\n\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u767b\u9332\u3055\u308c\u305f\u30b8\u30e7\u30d6\u306e\u6b21\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u5373\u6642\u306b\u5b9f\u884c\u3055\u305b\u308b\u306b\u306ftd wf start\u3092\u4f7f\u3046\u3002\n$ td wf start nasdaq_analysis nasdaq_analysis --session now\n2016-10-12 23:06:19 +0900: Digdag v0.8.17\nStarted a session attempt:\n  session id: 487165\n  attempt id: 509667\n  uuid: 2dc34a99-d68c-4370-ae1a-6e5e1f9e4cdb\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  session time: 2016-10-12 14:06:20 +0000\n  retry attempt name: \n  params: {\"last_session_time\":\"2016-10-12T00:00:00+00:00\",\"next_session_time\":\"2016-10-13T00:00:00+00:00\"}\n  created at: 2016-10-12 23:06:24 +0900\n\n* Use `td workflow session 487165` to show session status.\n* Use `td workflow task 509667` and `td workflow log 509667` to show task status and logs.\n\n\u3061\u306a\u307f\u306b\u3001td wf start\u306f\u6b21\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u958b\u59cb\u6642\u9593\u306e\u5909\u66f4\u3084\u3001\u30ea\u30e9\u30f3\u3001\u30c9\u30e9\u30a4\u30e9\u30f3\u306a\u3069\u8272\u3005\u306a\u6a5f\u80fd\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n$ td wf start\n2016-10-12 23:49:48 +0900: Digdag v0.8.17\nUsage: td workflow start <project-name> <name>\n  Options:\n        --session <hourly | daily | now | yyyy-MM-dd | \"yyyy-MM-dd HH:mm:ss\">  set session_time to this time (required)\n        --revision <name>            use a past revision\n        --retry NAME                 set retry attempt name to a new session\n    -d, --dry-run                    tries to start a session attempt but does nothing\n    -p, --param KEY=VALUE            add a session parameter (use multiple times to set many parameters)\n    -P, --params-file PATH.yml       read session parameters from a YAML file\n    -e, --endpoint HOST[:PORT]       HTTP endpoint (default: http://127.0.0.1:65432)\n    -L, --log PATH                   output log messages to a file (default: -)\n    -l, --log-level LEVEL            log level (error, warn, info, debug or trace)\n    -X KEY=VALUE                     add a performance system config\n    -c, --config PATH.properties     Configuration file (default: /Users/bwtakacy/.config/digdag/config)\n\n\n  Examples:\n    $ td workflow start myproj workflow1 --session 2016-01-01  # use this day as session_time\n    $ td workflow start myproj workflow1 --session hourly      # use current hour's 00:00\n    $ td workflow start myproj workflow1 --session daily       # use current day's 00:00:00\n\n\u5931\u6557\u3057\u305f\u305c\u3088\u901a\u77e5\u304c\u30e1\u30fc\u30eb\u3067\u9001\u4fe1\u3055\u308c\u3066\u304f\u308b\u3002\n\u5148\u307b\u3069\u5b9f\u884c\u3057\u305f\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001status: error\u3068\u306a\u3063\u3066\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u8a66\u884cattempt\u304c\u5931\u6557\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n$ td wf session 487165\n2016-10-12 23:07:56 +0900: Digdag v0.8.17\n  session id: 487165\n  attempt id: 509667\n  uuid: 2dc34a99-d68c-4370-ae1a-6e5e1f9e4cdb\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  session time: 2016-10-12 14:06:20 +0000\n  retry attempt name: \n  params: {\"last_session_time\":\"2016-10-12T00:00:00+00:00\",\"next_session_time\":\"2016-10-13T00:00:00+00:00\"}\n  created at: 2016-10-12 23:06:24 +0900\n  kill requested: false\n  status: error\n\n\n\u5931\u6557\u3057\u305fattempt\u306b\u542b\u307e\u308c\u308btask\u306e\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u3002\n$ td wf tasks 509667\n2016-10-12 23:09:40 +0900: Digdag v0.8.17\n   id: 900691\n   name: +nasdaq_analysis\n   state: group_error\n   config: {\"schedule\":{\"daily>\":\"07:00:00\"},\"_export\":{\"td\":{\"database\":\"workflow_temp\"}}}\n   parent: null\n   upstreams: []\n   export params: {\"td\":{\"database\":\"workflow_temp\"}}\n   store params: {}\n   state params: {}\n\n   id: 900692\n   name: +nasdaq_analysis+task1\n   state: success\n   config: {\"td>\":\"queries/daily_open.sql\",\"create_table\":\"daily_open\"}\n   parent: 900691\n   upstreams: []\n   export params: {}\n   store params: {\"td\":{\"last_job_id\":\"95560560\"}}\n   state params: {\"job\":{\"jobId\":\"95560560\",\"domainKey\":\"ed457f44-bee0-4414-b6c1-20dca09cd72d\",\"pollIteration\":2,\"errorPollIteration\":null}}\n\n   id: 900693\n   name: +nasdaq_analysis+task2\n   state: error\n   config: {\"td>\":\"queries/monthly_open.sql\",\"create_table\":\"monthly_open\"}\n   parent: 900691\n   upstreams: [900692]\n   export params: {}\n   store params: {}\n   state params: {}\n\n   id: 900694\n   name: +nasdaq_analysis^failure-alert\n   state: success\n   config: {\"_type\":\"notify\",\"_command\":\"Workflow session attempt failed\"}\n   parent: 900691\n   upstreams: []\n   export params: {}\n   store params: {}\n   state params: {}\n\n4 entries.\n\ntask\u306e+nasdaq_analysis+task2\u304cstate: error\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n+nasdaq_analysis\u81ea\u4f53\u306fstate: group_error\u3068\u3044\u3046\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u3002\u5b50task\u306e\u3044\u305a\u308c\u304b\u304c\u5931\u6557\u3057\u3066\u3044\u308b\u72b6\u614b\u3092\u793a\u3057\u3066\u3044\u308b\u3068\u601d\u308f\u308c\u308b\u3002\n\u5931\u6557\u3057\u305ftask\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u3002\n$ td wf log 509667 +nasdaq_analysis+task2\n2016-10-12 23:12:45 +0900: Digdag v0.8.17\n2016-10-12 14:06:44.864 +0000 [INFO] (1093@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:06:50.203 +0000 [INFO] (0565@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:06:52.131 +0000 [INFO] (0565@+nasdaq_analysis+task2) io.digdag.standards.operator.td.TdOperatorFactory$TdOperator: Started presto job id=95560605:\nDROP TABLE IF EXISTS \"monthly_open\";\nCREATE TABLE \"monthly_open\" AS\nSELECT \n    TD_DATE_TRUNC('month', time), \n    AVG(daily_avg_open) AS monthly_avg_open, \n    AVG(daily_avg_close) AS month_avg_close\nFROM \n    daily_opne\nWHERE\n    TD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n    1\n\n2016-10-12 14:06:57.247 +0000 [INFO] (0559@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:07:00.260 +0000 [ERROR] (0559@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: Task +nasdaq_analysis+task2 failed.\nstarted at 2016-10-12T14:06:53Z\nexecuting query: DROP TABLE IF EXISTS \"monthly_open\"\nStarted fetching results.\nexecuting query: CREATE TABLE \"monthly_open\" AS\nSELECT \n    TD_DATE_TRUNC('month', time), \n    AVG(daily_avg_open) AS monthly_avg_open, \n    AVG(daily_avg_close) AS month_avg_close\nFROM \n    daily_opne\nWHERE\n    TD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n    1\nfinished at 2016-10-12T14:06:54Z\n\nQuery 20161012_140653_88801_n5e4x failed: line 7:2: Table td-presto.workflow_temp.daily_opne does not exist\n (task execution)\n> TD job 95560605 failed with status ERROR (td job)\n\n\u9577\u3044\u3051\u3069\u3001\u30ed\u30b0\u306e\u672b\u5c3e\u306bTable td-presto.workflow_temp.daily_opne does not exist\u3068\u3042\u308b\u306e\u306b\u6c17\u3065\u3051\u3070\u3088\u3044\u3002\u3053\u308c\u3067\u539f\u56e0\u7279\u5b9a\u3002\nSQL\u3092\u4fee\u6b63\u3057\u3066\u518d\u5ea6TreasureData\u306b\u767b\u9332\u3059\u308b\u3002\n$ td wf push nasdaq_analysis\n2016-10-12 23:17:50 +0900: Digdag v0.8.17\nCreating .digdag/tmp/archive-4696221085390888645.tar.gz...\n  Archiving nasdaq_analysis.dig\n  Archiving queries/daily_open.sql\n  Archiving queries/monthly_open.sql\nWorkflows:\n  nasdaq_analysis\n\nUploaded:\n  id: 38188\n  name: nasdaq_analysis\n  revision: 12877724-f51d-4643-9ead-ea6ccea26593\n  archive type: db\n  project created at: 2016-10-11T15:56:44Z\n  revision updated at: 2016-10-12T14:17:53Z\n\nUse `td workflow workflows` to show all workflows.\n\n\u3042\u3068\u306f\u3001\u5931\u6557\u3057\u305f\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u30ea\u30e9\u30f3\u3092\u884c\u3046\u3002\n\u305d\u306e\u969b\u3001td wf session\u3067\u306f\u306a\u304ftd wf retry\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u305f\u307b\u3046\u304c\u3088\u3044\u3001\u3068\u306e\u3053\u3068\u3002\nsession time\u3068\u3044\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u5931\u6557\u3057\u305f\u3068\u304d\u306e\u3082\u306e\u306e\u307e\u307e\u518d\u5b9f\u884c\u3055\u308c\u308b\u305f\u3081\u3001\u6642\u9593\u4f9d\u5b58\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306b\u6761\u4ef6\u3092\u4fdd\u3064\u3053\u3068\u304c\u3067\u304d\u308b\u30e1\u30ea\u30c3\u30c8\u304c\u3042\u308b\u305f\u3081\u30fb\u30fb\u30fb\u66f8\u3044\u3066\u3044\u3066\u4f55\u3092\u8a00\u3063\u3066\u3044\u308b\u306e\u304b\u5206\u304b\u3089\u306a\u304f\u306a\u3063\u3066\u304d\u305f\u3002\u3053\u306e\u3042\u305f\u308aDigdag\u306e\u6982\u5ff5\u3092\u3042\u307e\u308a\u7406\u89e3\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u8abf\u67fb\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306a\u3041\u3002\ntd wf retry\u30b3\u30de\u30f3\u30c9\u306e\u30d8\u30eb\u30d7\u3092\u78ba\u8a8d\u3059\u308b\u3002\n$ td wf retry \n2016-10-12 23:22:09 +0900: Digdag v0.8.17\nUsage: td workflow retry <attempt-id>\n  Options:\n        --name <name>                unique identifier of this retry attempt instead of auto-generated UUID\n        --latest-revision            use the latest revision\n        --keep-revision              keep the same revision\n        --revision <name>            use a specific revision\n        --all                        retry all tasks\n        --resume                     retry only non-successful tasks\n        --resume-from <+name>        retry from a specific task\n\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u5168\u4f53\u3092\u518d\u5b9f\u884c\u3059\u308b--all\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u3044\u308b\u304c\u3001\u3053\u3053\u3067\u306f\u5931\u6557\u3057\u305ftask\u3060\u3051\u3092\u518d\u5b9f\u884c\u3059\u308b--resume\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u307f\u308b\u3002\n$ td wf retry 509667 --name fix-typo --latest-revision --resume\n2016-10-12 23:22:50 +0900: Digdag v0.8.17\nStarted a session attempt:\n  session id: 487165\n  attempt id: 509673\n  uuid: 2dc34a99-d68c-4370-ae1a-6e5e1f9e4cdb\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  session time: 2016-10-12 14:06:20 +0000\n  retry attempt name: fix-typo\n  params: {\"last_session_time\":\"2016-10-12T00:00:00+00:00\",\"next_session_time\":\"2016-10-13T00:00:00+00:00\"}\n  created at: 2016-10-12 23:22:54 +0900\n\n* Use `td workflow session 487165` to show session status.\n* Use `td workflow task 509673` and `td workflow log 509673` to show task status and logs.\n\n\u65b0\u3057\u3044\u30bb\u30c3\u30b7\u30e7\u30f3\u8a66\u884c\u306e\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u4eca\u5ea6\u306f+nasdaq_analysis+task2\u306b\u6210\u529f\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n$ td wf task 509673\n2016-10-12 23:24:27 +0900: Digdag v0.8.17\n   id: 900713\n   name: +nasdaq_analysis\n   state: success\n   config: {\"schedule\":{\"daily>\":\"07:00:00\"},\"_export\":{\"td\":{\"database\":\"workflow_temp\"}}}\n   parent: null\n   upstreams: []\n   export params: {\"td\":{\"database\":\"workflow_temp\"}}\n   store params: {}\n   state params: {}\n\n   id: 900714\n   name: +nasdaq_analysis+task1\n   state: success\n   config: {\"td>\":\"queries/daily_open.sql\",\"create_table\":\"daily_open\"}\n   parent: 900713\n   upstreams: []\n   export params: {}\n   store params: {\"td\":{\"last_job_id\":\"95560560\"}}\n   state params: {}\n\n   id: 900715\n   name: +nasdaq_analysis+task2\n   state: success\n   config: {\"td>\":\"queries/monthly_open.sql\",\"create_table\":\"monthly_open\"}\n   parent: 900713\n   upstreams: [900714]\n   export params: {}\n   store params: {\"td\":{\"last_job_id\":\"95562707\"}}\n   state params: {\"job\":{\"jobId\":\"95562707\",\"domainKey\":\"e609a316-b7a1-4852-952a-992a8ca4e76f\",\"pollIteration\":1,\"errorPollIteration\":null}}\n\n3 entries.\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u8a66\u884c\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u78ba\u304b\u306b\u5931\u6557\u3057\u3066\u3044\u305f+nasdaq_analysis+task2\u3060\u3051\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n$ td wf log 509673\n2016-10-13 00:06:45 +0900: Digdag v0.8.17\n2016-10-12 14:22:54.877 +0000 [INFO] (0466@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:22:55.309 +0000 [INFO] (0974@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:22:55.840 +0000 [INFO] (0974@+nasdaq_analysis+task2) io.digdag.standards.operator.td.TdOperatorFactory$TdOperator: Started presto job id=95562707:\nDROP TABLE IF EXISTS \"monthly_open\";\nCREATE TABLE \"monthly_open\" AS\nSELECT \n    TD_DATE_TRUNC('month', time), \n    AVG(daily_avg_open) AS monthly_avg_open, \n    AVG(daily_avg_close) AS month_avg_close\nFROM \n    daily_open\nWHERE\n    TD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n    1\n\n2016-10-12 14:22:57.651 +0000 [INFO] (0642@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:22:59.920 +0000 [INFO] (0539@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n\n\n\u6240\u611f\n\u3061\u3087\u3063\u3068\u89e6\u3063\u305f\u3060\u3051\u3060\u304c\u3001Treasure Data\u3067\u52d5\u304b\u3059\u305f\u3081\u306b\u3057\u3063\u304b\u308a\u3068\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b\u5370\u8c61\u3002\n\u3068\u304f\u306b\u3001\u30a8\u30e9\u30fc\u6642\u306e\u60c5\u5831\u53d6\u5f97\u3001\u539f\u56e0\u7279\u5b9a\u306e\u6d41\u308c\u304c\u660e\u78ba\u306b\u30b3\u30de\u30f3\u30c9\u5316\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u7d20\u6674\u3089\u3057\u3044\u3002\u30af\u30e9\u30a6\u30c9\u3067\u306e\u904b\u7528\u30b5\u30dd\u30fc\u30c8\u307e\u3067\u8003\u616e\u3057\u3066\u3044\u308b\u306e\u3067\u3042\u308d\u3046\u3002\n\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u306e\u53ef\u8996\u5316\u306f\u51fa\u6765\u306a\u3044\u306e\u304b\u306a\uff1f\u3061\u3087\u3063\u3068\u8abf\u3079\u304d\u308c\u305a\u3002\n\u53ef\u8996\u5316\u304c\u3067\u304d\u306a\u3044\u3068\u3001\u8907\u96d1\u306a\u30b8\u30e7\u30d6\u3092\u4f5c\u3063\u3066\u3057\u307e\u3063\u305f\u3068\u304d\u306b\u8ca0\u50b5\u5316\u3059\u308b\u306e\u3067\u3084\u3084\u6c17\u306b\u306a\u308b\u3002\n\u4ee5\u4e0a\u3002\nTreasure Data\u4e0a\u3067\u306e\u30b8\u30e7\u30d6\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u304c\u4f5c\u6210\u30fb\u7ba1\u7406\u3067\u304d\u308bTreaure Workflow\u3092\u89e6\u3063\u3066\u307f\u305f\u30e1\u30e2\u3002\n\n# Treasure Workflow\u306e\u7279\u5fb4\n\n[\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://docs.treasuredata.com/articles/workflows)\u3067\u6319\u3052\u3089\u308c\u3066\u3044\u308b\u7279\u5fb4\u3092\u8a33\u3059\u3002\n\n* DAG\u5f62\u5f0f\u306e\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u304c\u4f5c\u6210\u3067\u304d\u308b\n* \u30ed\u30fc\u30ab\u30eb\u3067\u5b9f\u88c5\u3057\u3066Treasure Data\u306b\u767b\u9332\u3057\u3066\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u5b9f\u884c\u3055\u305b\u3089\u308c\u308b\u3002\u307e\u3055\u306b\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u306eSaas\n* Treasure Data\u306e\u6a5f\u80fd\u304c\u4f7f\u3048\u308b\u3002Data Connector\u306b\u3088\u308b\u30c7\u30fc\u30bf\u30a4\u30f3\u30dd\u30fc\u30c8, Presto, Hive\u3067\u306e\u30af\u30a8\u30ea\u5b9f\u884c\u3001\u4ed6\u30b7\u30b9\u30c6\u30e0\u3078\u306e\u30c7\u30fc\u30bf\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\n* \u518d\u5229\u7528\u3057\u3084\u3059\u3044\u30d1\u30e9\u30e1\u30bf\u5316\uff08\u4f55\u3092\u8a00\u3063\u3066\u3044\u308b\u306e\u304b\u3044\u307e\u3044\u3061\u5206\u304b\u3089\u305a\u3002\u3002\u3002\uff09\n* \u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u5931\u6557\u3084SLA\u672a\u9054\u306e\u5834\u5408\u306b\u30a2\u30e9\u30fc\u30c8\u901a\u77e5\n\n\u305d\u306e\u4ed6\u3001\u30bf\u30b9\u30af\u306e\u4e26\u5217\u5b9f\u884c\u6a5f\u80fd\u3082\u3042\u308b\u3002\n\n\u30d9\u30fc\u30b9\u306b\u306a\u3063\u3066\u3044\u308b\u30a8\u30f3\u30b8\u30f3\u306fDigdag\u3068\u3057\u3066OSS\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u3002\nTreasure Workflow\u306fDigdag\u306e\u4e00\u90e8\u6a5f\u80fd\u304c\u4f7f\u3048\u306a\u3044\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u306e\u3053\u3068\u3002\n\u307e\u305f\u3001Treasure Workflow\u3068\u3057\u3066\u3082public beta\u306a\u306e\u3067\u8272\u3005\u3068\u5236\u9650\u306f\u3042\u308b\u69d8\u5b50\u3002\n\n\n\n# \u52d5\u304b\u3057\u3066\u307f\u308b\n## Tutorial\u3092\u8a66\u3059\n\n[\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://docs.treasuredata.com/articles/workflows-introductory-tutorial)\u306b\u5f93\u3063\u3066\u8a66\u3059\u3002\n\n\u306a\u304a\u3001\u4e8b\u524d\u306bTreasure Data\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b3\u30de\u30f3\u30c9\u30c4\u30fc\u30ebTD Toolbelt\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n`td workflow`\u3092\u5b9f\u884c\u3059\u308b\u3068\u521d\u56de\u6642\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u8d70\u308b\u3002\n\n```\n$ td workflow\nWorkflow module not yet installed, download now? [Y/n]\nY\nDownloading Java...: done                                                                                               \nInstalling Java... done\nDownloading workflow module...: done                                                                                    \nInstalling workflow module... done\n2016-10-12 00:44:02 +0900: Digdag v0.8.17\nUsage: td workflow <command> [options...]\n  Local-mode commands:\n    init <dir>                         create a new workflow project\n    r[un] <workflow.dig>               run a workflow\n    c[heck]                            show workflow definitions\n    sched[uler]                        run a scheduler server\n    selfupdate                         update cli to the latest version\n\n  Server-mode commands:\n    server                             start server\n\n  Client-mode commands:\n    push <project-name>                create and upload a new revision\n    start <project-name> <name>        start a new session attempt of a workflow\n    retry <attempt-id>                 retry a session\n    kill <attempt-id>                  kill a running session attempt\n    backfill <project-name> <name>     start sessions of a schedule for past times\n    reschedule                         skip sessions of a schedule to a future time\n    log <attempt-id>                   show logs of a session attempt\n    workflows [project-name] [name]    show registered workflow definitions\n    schedules                          show registered schedules\n    disable <schedule-id>              disable a workflow schedule\n    disable <project-name>             disable all workflow schedules in a project\n    disable <project-name> <name>      disable a workflow schedule\n    enable <schedule-id>               enable a workflow schedule\n    enable <project-name>              enable all workflow schedules in a project\n    enable <project-name> <name>       enable a workflow schedule\n    sessions                           show sessions for all workflows\n    sessions <project-name>            show sessions for all workflows in a project\n    sessions <project-name> <name>     show sessions for a workflow\n    session  <session-id>              show a single session\n    attempts                           show attempts for all sessions\n    attempts <session-id>              show attempts for a session\n    attempt  <attempt-id>              show a single attempt\n    tasks <attempt-id>                 show tasks of a session attempt\n    delete <project-name>              delete a project\n    secrets --project <project-name>   manage secrets\n    version                            show client and server version\n\n  Options:\n    -L, --log PATH                   output log messages to a file (default: -)\n    -l, --log-level LEVEL            log level (error, warn, info, debug or trace)\n    -X KEY=VALUE                     add a performance system config\n    -c, --config PATH.properties     Configuration file (default: /Users/oonishitk/.config/digdag/config)\n\nUse `<command> --help` to see detailed usage of a command.\n```\n\n\u306a\u304a\u3001`td workflow`\u30b3\u30de\u30f3\u30c9\u306f`td wf`\u3068\u7701\u7565\u3057\u3066\u5b9f\u884c\u3067\u304d\u308b\u3002\u3053\u308c\u306f\u52a9\u304b\u308b\u3002\n\nTutorial\u7528\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u308b\u3002\n\n```\n$ td db:create workflow_temp\nDatabase 'workflow_temp' is created.\nUse 'td table:create workflow_temp <table_name>' to create a table.\n```\n\nTutorial\u7528\u306e\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u30b5\u30f3\u30d7\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u308b\u3002\n\n```\n$ cd ~/Downloads\n$ curl -o nasdaq_analysis.zip -L https://gist.github.com/danielnorberg/f839e5f2fd0d1a27d63001f4fd19b947/raw/d2d6dd0e3d419ea5d18b1c1e7ded9ec106c775d4/nasdaq_analysis.zip\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0\n100  1403  100  1403    0     0    933      0  0:00:01  0:00:01 --:--:--   933\n$ unzip nasdaq_analysis.zip \nArchive:  nasdaq_analysis.zip\n   creating: nasdaq_analysis/\n  inflating: nasdaq_analysis/nasdaq_analysis.dig  \n   creating: nasdaq_analysis/queries/\n  inflating: nasdaq_analysis/queries/daily_open.sql  \n  inflating: nasdaq_analysis/queries/monthly_open.sql\n$ cd nasdaq_analysis\n$ ls -l\ntotal 8\n-rw-r--r--  1 oonishitk  staff  224  4 27 08:34 nasdaq_analysis.dig\ndrwxr-xr-x  4 oonishitk  staff  136  4 27 08:31 queries\n```\n\n\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u306e\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u611f\u3058\u3002\ntask1\u3068task2\u3092\u30b7\u30ea\u30a2\u30eb\u306b\u5b9f\u884c\u3059\u308b\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```yaml:nasdaq_analysis.dig \ntimezone: UTC\n\nschedule:\n  daily>: 07:00:00\n\n_export:\n  td:\n    database: workflow_temp\n\n+task1:\n  td>: queries/daily_open.sql\n  create_table: daily_open\n\n+task2:\n  td>: queries/monthly_open.sql\n  create_table: monthly_open\n```\n\n`td workflow run`\u3067Treasure Data\u306b\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u767b\u9332\u305b\u305a\u306b\u3001\u30ef\u30f3\u30b7\u30e7\u30c3\u30c8\u5b9f\u884c\u3055\u305b\u308b\u3002\n\n```\n$ td workflow run nasdaq_analysis\n2016-10-12 00:51:36 +0900: Digdag v0.8.17\n2016-10-12 00:51:37 +0900 [WARN] (main): Using a new session time 2016-10-11T00:00:00+00:00 based on schedule.\n2016-10-12 00:51:37 +0900 [INFO] (main): Using session /Users/bwtakacy/Downloads/nasdaq_analysis/.digdag/status/20161011T000000+0000.\n2016-10-12 00:51:37 +0900 [INFO] (main): Starting a new session project id=1 workflow name=nasdaq_analysis session_time=2016-10-11T00:00:00+00:00\n2016-10-12 00:51:38 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:38 +0900 [INFO] (0018@+nasdaq_analysis+task1): td-client version: 0.7.26\n2016-10-12 00:51:38 +0900 [INFO] (0018@+nasdaq_analysis+task1): Logging initialized @2621ms\n2016-10-12 00:51:39 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:40 +0900 [INFO] (0018@+nasdaq_analysis+task1): Started presto job id=95352325:\nDROP TABLE IF EXISTS \"daily_open\";\nCREATE TABLE \"daily_open\" AS\nSELECT \n\tTD_DATE_TRUNC('day', time), AVG(open) AS daily_avg_open, AVG(close) AS daily_avg_close\nFROM \n\tsample_datasets.nasdaq\nWHERE\n\tTD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n\t1\n\n2016-10-12 00:51:42 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:45 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:50 +0900 [INFO] (0018@+nasdaq_analysis+task1): td>: queries/daily_open.sql\n2016-10-12 00:51:52 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\n2016-10-12 00:51:52 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\n2016-10-12 00:51:54 +0900 [INFO] (0018@+nasdaq_analysis+task2): Started presto job id=95352354:\nDROP TABLE IF EXISTS \"monthly_open\";\nCREATE TABLE \"monthly_open\" AS\nSELECT \n\tTD_DATE_TRUNC('month', time), \n\tAVG(daily_avg_open) AS monthly_avg_open, \n\tAVG(daily_avg_close) AS month_avg_close\nFROM \n\tdaily_open\nWHERE\n\tTD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n\t1\n2016-10-12 00:51:55 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\n2016-10-12 00:51:58 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\n2016-10-12 00:52:03 +0900 [INFO] (0018@+nasdaq_analysis+task2): td>: queries/monthly_open.sql\nSuccess. Task state is saved at /Users/bwtakacy/Downloads/nasdaq_analysis/.digdag/status/20161011T000000+0000 directory.\n  * Use --session <daily | hourly | \"yyyy-MM-dd[ HH:mm:ss]\"> to not reuse the last session time.\n  * Use --rerun, --start +NAME, or --goal +NAME argument to rerun skipped tasks.\n```\n\n\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u304c\u6b63\u5e38\u306b\u5b9f\u884c\u3055\u308c\u305f\u7d50\u679c\u3001\u30af\u30a8\u30ea\u306e\u7d50\u679c\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n```\n$ td table:show workflow_temp daily_open\nName        : workflow_temp.daily_open\nType        : log\nCount       : 438\nSchema      : (\n    _col0:long\n    daily_avg_open:double\n    daily_avg_close:double\n)\n$ td table:show workflow_temp monthly_open\nName        : workflow_temp.monthly_open\nType        : log\nCount       : 0\nSchema      : (\n    _col0:long\n    monthly_avg_open:double\n    month_avg_close:double\n)\n```\n\n\u3055\u3066\u3001\u3053\u306e\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3092Treasure Data\u306b\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u30b8\u30e7\u30d6\u3068\u3057\u3066\u767b\u9332\u3059\u308b\u3002\n\n```\n$ td workflow push nasdaq_analysis\n2016-10-12 00:56:41 +0900: Digdag v0.8.17\nCreating .digdag/tmp/archive-5329639364818920963.tar.gz...\n  Archiving nasdaq_analysis.dig\n  Archiving queries/daily_open.sql\n  Archiving queries/monthly_open.sql\nWorkflows:\n  nasdaq_analysis\n\nUploaded:\n  id: 38188\n  name: nasdaq_analysis\n  revision: 7405dfb8-8176-44de-8983-b8419cb7f79a\n  archive type: db\n  project created at: 2016-10-11T15:56:44Z\n  revision updated at: 2016-10-11T15:56:44Z\n\nUse `td workflow workflows` to show all workflows.\n```\n\n\u767b\u9332\u3055\u308c\u305f\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u30b8\u30e7\u30d6\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n```\n$ td workflow workflows\n2016-10-12 00:56:52 +0900: Digdag v0.8.17\n  nasdaq_analysis\n    nasdaq_analysis\n\nUse `td workflow workflows <project-name> <name>` to show details.\n$ td workflow workflows nasdaq_analysis nasdaq_analysis\n2016-10-12 00:57:22 +0900: Digdag v0.8.17\n_export:\n  td:\n    database: \"workflow_temp\"\nschedule:\n  daily>: \"07:00:00\"\n+task1:\n  td>: \"queries/daily_open.sql\"\n  create_table: \"daily_open\"\n+task2:\n  td>: \"queries/monthly_open.sql\"\n  create_table: \"monthly_open\"\n\n$ td workflow schedules\n2016-10-12 00:58:37 +0900: Digdag v0.8.17\nSchedules:\n  id: 112\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  disabled at: \n  next session time: 2016-10-12 00:00:00 +0000\n  next scheduled to run at: 2016-10-12 16:00:00 +0900 (in 15h 1m 22s)\n\n1 entries.\nUse `td workflow workflows [project-name] [workflow-name]` to show workflow details.\n```\n\n\u307e\u305f\u3001\u4e00\u6642\u7684\u306b\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u5b9f\u884c\u3092\u7121\u52b9\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```\n$ td wf disable nasdaq_analysis\n2016-10-12 23:01:53 +0900: Digdag v0.8.17\nDisabled schedule id: 112\n[23:01:57 bwtakacy ~]$ td wf schedules\n2016-10-12 23:02:02 +0900: Digdag v0.8.17\nSchedules:\n  id: 112\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  disabled at: 2016-10-12 23:01:57 +0900 (-5s ago)\n  next session time: 2016-10-13 00:00:00 +0000\n  next scheduled to run at: 2016-10-13 16:00:00 +0900 (in 16h 57m 57s)\n\n1 entries.\nUse `td workflow workflows [project-name] [workflow-name]` to show workflow details.\n```\n\n\u518d\u3073\u6709\u52b9\u306b\u3059\u308b\u306b\u306f`td wf enable`\u3092\u5229\u7528\u3059\u308b\u3002\n\n## \u969c\u5bb3\u6642\u306e\u6319\u52d5\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3060\u3068[\u3053\u3053](https://docs.treasuredata.com/articles/workflows-troubleshooting-submitted-wf)\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\n\n\u306a\u304a\u3001\u540c\u69d8\u306e\u60c5\u5831\u306fWeb\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3067\u3082\u30dd\u30c1\u30dd\u30c1\u3068\u78ba\u8a8d\u3067\u304d\u308b\u3002\nhttps://workflows.treasuredata.com\n\n\n\u6700\u521d\u306b\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3092\u5931\u6557\u3055\u305b\u308b\u305f\u3081\u306b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u306b\u3001\u308f\u3056\u3068\u53c2\u7167\u5148\u306e\u30c6\u30fc\u30d6\u30eb\u540d\u3092typo\u3057\u3066\u307f\u308b\u3002\n\n```sql:monthly_open.sql \nSELECT \n\tTD_DATE_TRUNC('month', time), \n\tAVG(daily_avg_open) AS monthly_avg_open, \n\tAVG(daily_avg_close) AS month_avg_close\nFROM \n\tdaily_opne  // \u672c\u5f53\u306fdaily_open\nWHERE\n\tTD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n\t1\n```\n\n\u3053\u308c\u3092\u77e5\u3089\u306a\u3044\u3082\u306e\u3068\u3057\u3066\u3001\u30b8\u30e7\u30d6\u30a8\u30e9\u30fc\u304b\u3089\u3069\u3046\u3084\u3063\u3066\u539f\u56e0\u7279\u5b9a\u304c\u3067\u304d\u308b\u304b\u3068\u3044\u3046\u306e\u304c\u4ee5\u4e0b\u306e\u30b9\u30c6\u30c3\u30d7\u3002\n\u307e\u305a\u306f\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u30b8\u30e7\u30d6\u3068\u3057\u3066Treasure Data\u306b\u767b\u9332\u3057\u3066\u304a\u304f\u3002\n\n```\n$ td wf push nasdaq_analysis\n2016-10-12 23:05:41 +0900: Digdag v0.8.17\nCreating .digdag/tmp/archive-2082789604168105713.tar.gz...\n  Archiving nasdaq_analysis.dig\n  Archiving queries/daily_open.sql\n  Archiving queries/monthly_open.sql\nWorkflows:\n  nasdaq_analysis\n\nUploaded:\n  id: 38188\n  name: nasdaq_analysis\n  revision: d98ff854-8a67-47e6-a961-025fde657def\n  archive type: db\n  project created at: 2016-10-11T15:56:44Z\n  revision updated at: 2016-10-12T14:05:45Z\n\nUse `td workflow workflows` to show all workflows.\n```\n\n\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u767b\u9332\u3055\u308c\u305f\u30b8\u30e7\u30d6\u306e\u6b21\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u5373\u6642\u306b\u5b9f\u884c\u3055\u305b\u308b\u306b\u306f`td wf start`\u3092\u4f7f\u3046\u3002\n\n```\n$ td wf start nasdaq_analysis nasdaq_analysis --session now\n2016-10-12 23:06:19 +0900: Digdag v0.8.17\nStarted a session attempt:\n  session id: 487165\n  attempt id: 509667\n  uuid: 2dc34a99-d68c-4370-ae1a-6e5e1f9e4cdb\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  session time: 2016-10-12 14:06:20 +0000\n  retry attempt name: \n  params: {\"last_session_time\":\"2016-10-12T00:00:00+00:00\",\"next_session_time\":\"2016-10-13T00:00:00+00:00\"}\n  created at: 2016-10-12 23:06:24 +0900\n\n* Use `td workflow session 487165` to show session status.\n* Use `td workflow task 509667` and `td workflow log 509667` to show task status and logs.\n```\n\n\u3061\u306a\u307f\u306b\u3001`td wf start`\u306f\u6b21\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u958b\u59cb\u6642\u9593\u306e\u5909\u66f4\u3084\u3001\u30ea\u30e9\u30f3\u3001\u30c9\u30e9\u30a4\u30e9\u30f3\u306a\u3069\u8272\u3005\u306a\u6a5f\u80fd\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3060\u3002\n\n```\n$ td wf start\n2016-10-12 23:49:48 +0900: Digdag v0.8.17\nUsage: td workflow start <project-name> <name>\n  Options:\n        --session <hourly | daily | now | yyyy-MM-dd | \"yyyy-MM-dd HH:mm:ss\">  set session_time to this time (required)\n        --revision <name>            use a past revision\n        --retry NAME                 set retry attempt name to a new session\n    -d, --dry-run                    tries to start a session attempt but does nothing\n    -p, --param KEY=VALUE            add a session parameter (use multiple times to set many parameters)\n    -P, --params-file PATH.yml       read session parameters from a YAML file\n    -e, --endpoint HOST[:PORT]       HTTP endpoint (default: http://127.0.0.1:65432)\n    -L, --log PATH                   output log messages to a file (default: -)\n    -l, --log-level LEVEL            log level (error, warn, info, debug or trace)\n    -X KEY=VALUE                     add a performance system config\n    -c, --config PATH.properties     Configuration file (default: /Users/bwtakacy/.config/digdag/config)\n\n\n  Examples:\n    $ td workflow start myproj workflow1 --session 2016-01-01  # use this day as session_time\n    $ td workflow start myproj workflow1 --session hourly      # use current hour's 00:00\n    $ td workflow start myproj workflow1 --session daily       # use current day's 00:00:00\n```\n\n\u5931\u6557\u3057\u305f\u305c\u3088\u901a\u77e5\u304c\u30e1\u30fc\u30eb\u3067\u9001\u4fe1\u3055\u308c\u3066\u304f\u308b\u3002\n\u5148\u307b\u3069\u5b9f\u884c\u3057\u305f\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001`status: error`\u3068\u306a\u3063\u3066\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u8a66\u884c`attempt`\u304c\u5931\u6557\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n```\n$ td wf session 487165\n2016-10-12 23:07:56 +0900: Digdag v0.8.17\n  session id: 487165\n  attempt id: 509667\n  uuid: 2dc34a99-d68c-4370-ae1a-6e5e1f9e4cdb\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  session time: 2016-10-12 14:06:20 +0000\n  retry attempt name: \n  params: {\"last_session_time\":\"2016-10-12T00:00:00+00:00\",\"next_session_time\":\"2016-10-13T00:00:00+00:00\"}\n  created at: 2016-10-12 23:06:24 +0900\n  kill requested: false\n  status: error\n\n```\n\n\u5931\u6557\u3057\u305f`attempt`\u306b\u542b\u307e\u308c\u308b`task`\u306e\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n```\n$ td wf tasks 509667\n2016-10-12 23:09:40 +0900: Digdag v0.8.17\n   id: 900691\n   name: +nasdaq_analysis\n   state: group_error\n   config: {\"schedule\":{\"daily>\":\"07:00:00\"},\"_export\":{\"td\":{\"database\":\"workflow_temp\"}}}\n   parent: null\n   upstreams: []\n   export params: {\"td\":{\"database\":\"workflow_temp\"}}\n   store params: {}\n   state params: {}\n\n   id: 900692\n   name: +nasdaq_analysis+task1\n   state: success\n   config: {\"td>\":\"queries/daily_open.sql\",\"create_table\":\"daily_open\"}\n   parent: 900691\n   upstreams: []\n   export params: {}\n   store params: {\"td\":{\"last_job_id\":\"95560560\"}}\n   state params: {\"job\":{\"jobId\":\"95560560\",\"domainKey\":\"ed457f44-bee0-4414-b6c1-20dca09cd72d\",\"pollIteration\":2,\"errorPollIteration\":null}}\n\n   id: 900693\n   name: +nasdaq_analysis+task2\n   state: error\n   config: {\"td>\":\"queries/monthly_open.sql\",\"create_table\":\"monthly_open\"}\n   parent: 900691\n   upstreams: [900692]\n   export params: {}\n   store params: {}\n   state params: {}\n\n   id: 900694\n   name: +nasdaq_analysis^failure-alert\n   state: success\n   config: {\"_type\":\"notify\",\"_command\":\"Workflow session attempt failed\"}\n   parent: 900691\n   upstreams: []\n   export params: {}\n   store params: {}\n   state params: {}\n\n4 entries.\n```\n\n`task`\u306e`+nasdaq_analysis+task2`\u304c`state: error`\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n`+nasdaq_analysis`\u81ea\u4f53\u306f`state: group_error`\u3068\u3044\u3046\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u3002\u5b50`task`\u306e\u3044\u305a\u308c\u304b\u304c\u5931\u6557\u3057\u3066\u3044\u308b\u72b6\u614b\u3092\u793a\u3057\u3066\u3044\u308b\u3068\u601d\u308f\u308c\u308b\u3002\n\n\u5931\u6557\u3057\u305f`task`\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n```\n$ td wf log 509667 +nasdaq_analysis+task2\n2016-10-12 23:12:45 +0900: Digdag v0.8.17\n2016-10-12 14:06:44.864 +0000 [INFO] (1093@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:06:50.203 +0000 [INFO] (0565@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:06:52.131 +0000 [INFO] (0565@+nasdaq_analysis+task2) io.digdag.standards.operator.td.TdOperatorFactory$TdOperator: Started presto job id=95560605:\nDROP TABLE IF EXISTS \"monthly_open\";\nCREATE TABLE \"monthly_open\" AS\nSELECT \n\tTD_DATE_TRUNC('month', time), \n\tAVG(daily_avg_open) AS monthly_avg_open, \n\tAVG(daily_avg_close) AS month_avg_close\nFROM \n\tdaily_opne\nWHERE\n\tTD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n\t1\n\n2016-10-12 14:06:57.247 +0000 [INFO] (0559@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:07:00.260 +0000 [ERROR] (0559@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: Task +nasdaq_analysis+task2 failed.\nstarted at 2016-10-12T14:06:53Z\nexecuting query: DROP TABLE IF EXISTS \"monthly_open\"\nStarted fetching results.\nexecuting query: CREATE TABLE \"monthly_open\" AS\nSELECT \n\tTD_DATE_TRUNC('month', time), \n\tAVG(daily_avg_open) AS monthly_avg_open, \n\tAVG(daily_avg_close) AS month_avg_close\nFROM \n\tdaily_opne\nWHERE\n\tTD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n\t1\nfinished at 2016-10-12T14:06:54Z\n\nQuery 20161012_140653_88801_n5e4x failed: line 7:2: Table td-presto.workflow_temp.daily_opne does not exist\n (task execution)\n> TD job 95560605 failed with status ERROR (td job)\n```\n\n\u9577\u3044\u3051\u3069\u3001\u30ed\u30b0\u306e\u672b\u5c3e\u306b`Table td-presto.workflow_temp.daily_opne does not exist`\u3068\u3042\u308b\u306e\u306b\u6c17\u3065\u3051\u3070\u3088\u3044\u3002\u3053\u308c\u3067\u539f\u56e0\u7279\u5b9a\u3002\n\nSQL\u3092\u4fee\u6b63\u3057\u3066\u518d\u5ea6TreasureData\u306b\u767b\u9332\u3059\u308b\u3002\n\n```\n$ td wf push nasdaq_analysis\n2016-10-12 23:17:50 +0900: Digdag v0.8.17\nCreating .digdag/tmp/archive-4696221085390888645.tar.gz...\n  Archiving nasdaq_analysis.dig\n  Archiving queries/daily_open.sql\n  Archiving queries/monthly_open.sql\nWorkflows:\n  nasdaq_analysis\n\nUploaded:\n  id: 38188\n  name: nasdaq_analysis\n  revision: 12877724-f51d-4643-9ead-ea6ccea26593\n  archive type: db\n  project created at: 2016-10-11T15:56:44Z\n  revision updated at: 2016-10-12T14:17:53Z\n\nUse `td workflow workflows` to show all workflows.\n```\n\n\u3042\u3068\u306f\u3001\u5931\u6557\u3057\u305f\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u30ea\u30e9\u30f3\u3092\u884c\u3046\u3002\n\u305d\u306e\u969b\u3001`td wf session`\u3067\u306f\u306a\u304f`td wf retry`\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u305f\u307b\u3046\u304c\u3088\u3044\u3001\u3068\u306e\u3053\u3068\u3002\n`session time`\u3068\u3044\u3046\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u5931\u6557\u3057\u305f\u3068\u304d\u306e\u3082\u306e\u306e\u307e\u307e\u518d\u5b9f\u884c\u3055\u308c\u308b\u305f\u3081\u3001\u6642\u9593\u4f9d\u5b58\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306b\u6761\u4ef6\u3092\u4fdd\u3064\u3053\u3068\u304c\u3067\u304d\u308b\u30e1\u30ea\u30c3\u30c8\u304c\u3042\u308b\u305f\u3081\u30fb\u30fb\u30fb\u66f8\u3044\u3066\u3044\u3066\u4f55\u3092\u8a00\u3063\u3066\u3044\u308b\u306e\u304b\u5206\u304b\u3089\u306a\u304f\u306a\u3063\u3066\u304d\u305f\u3002\u3053\u306e\u3042\u305f\u308aDigdag\u306e\u6982\u5ff5\u3092\u3042\u307e\u308a\u7406\u89e3\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u8abf\u67fb\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306a\u3041\u3002\n\n`td wf retry`\u30b3\u30de\u30f3\u30c9\u306e\u30d8\u30eb\u30d7\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n```\n$ td wf retry \n2016-10-12 23:22:09 +0900: Digdag v0.8.17\nUsage: td workflow retry <attempt-id>\n  Options:\n        --name <name>                unique identifier of this retry attempt instead of auto-generated UUID\n        --latest-revision            use the latest revision\n        --keep-revision              keep the same revision\n        --revision <name>            use a specific revision\n        --all                        retry all tasks\n        --resume                     retry only non-successful tasks\n        --resume-from <+name>        retry from a specific task\n\n```\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u5168\u4f53\u3092\u518d\u5b9f\u884c\u3059\u308b`--all`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u3044\u308b\u304c\u3001\u3053\u3053\u3067\u306f\u5931\u6557\u3057\u305f`task`\u3060\u3051\u3092\u518d\u5b9f\u884c\u3059\u308b`--resume`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4f7f\u3063\u3066\u307f\u308b\u3002\n\n```\n$ td wf retry 509667 --name fix-typo --latest-revision --resume\n2016-10-12 23:22:50 +0900: Digdag v0.8.17\nStarted a session attempt:\n  session id: 487165\n  attempt id: 509673\n  uuid: 2dc34a99-d68c-4370-ae1a-6e5e1f9e4cdb\n  project: nasdaq_analysis\n  workflow: nasdaq_analysis\n  session time: 2016-10-12 14:06:20 +0000\n  retry attempt name: fix-typo\n  params: {\"last_session_time\":\"2016-10-12T00:00:00+00:00\",\"next_session_time\":\"2016-10-13T00:00:00+00:00\"}\n  created at: 2016-10-12 23:22:54 +0900\n\n* Use `td workflow session 487165` to show session status.\n* Use `td workflow task 509673` and `td workflow log 509673` to show task status and logs.\n```\n\n\u65b0\u3057\u3044\u30bb\u30c3\u30b7\u30e7\u30f3\u8a66\u884c\u306e\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u4eca\u5ea6\u306f+nasdaq_analysis+task2\u306b\u6210\u529f\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n```\n$ td wf task 509673\n2016-10-12 23:24:27 +0900: Digdag v0.8.17\n   id: 900713\n   name: +nasdaq_analysis\n   state: success\n   config: {\"schedule\":{\"daily>\":\"07:00:00\"},\"_export\":{\"td\":{\"database\":\"workflow_temp\"}}}\n   parent: null\n   upstreams: []\n   export params: {\"td\":{\"database\":\"workflow_temp\"}}\n   store params: {}\n   state params: {}\n\n   id: 900714\n   name: +nasdaq_analysis+task1\n   state: success\n   config: {\"td>\":\"queries/daily_open.sql\",\"create_table\":\"daily_open\"}\n   parent: 900713\n   upstreams: []\n   export params: {}\n   store params: {\"td\":{\"last_job_id\":\"95560560\"}}\n   state params: {}\n\n   id: 900715\n   name: +nasdaq_analysis+task2\n   state: success\n   config: {\"td>\":\"queries/monthly_open.sql\",\"create_table\":\"monthly_open\"}\n   parent: 900713\n   upstreams: [900714]\n   export params: {}\n   store params: {\"td\":{\"last_job_id\":\"95562707\"}}\n   state params: {\"job\":{\"jobId\":\"95562707\",\"domainKey\":\"e609a316-b7a1-4852-952a-992a8ca4e76f\",\"pollIteration\":1,\"errorPollIteration\":null}}\n\n3 entries.\n```\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u8a66\u884c\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u78ba\u304b\u306b\u5931\u6557\u3057\u3066\u3044\u305f+nasdaq_analysis+task2\u3060\u3051\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n```\n$ td wf log 509673\n2016-10-13 00:06:45 +0900: Digdag v0.8.17\n2016-10-12 14:22:54.877 +0000 [INFO] (0466@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:22:55.309 +0000 [INFO] (0974@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:22:55.840 +0000 [INFO] (0974@+nasdaq_analysis+task2) io.digdag.standards.operator.td.TdOperatorFactory$TdOperator: Started presto job id=95562707:\nDROP TABLE IF EXISTS \"monthly_open\";\nCREATE TABLE \"monthly_open\" AS\nSELECT \n\tTD_DATE_TRUNC('month', time), \n\tAVG(daily_avg_open) AS monthly_avg_open, \n\tAVG(daily_avg_close) AS month_avg_close\nFROM \n\tdaily_open\nWHERE\n\tTD_TIME_RANGE(time, '2013-01-01','2015-01-01')\nGROUP BY \n\t1\n\n2016-10-12 14:22:57.651 +0000 [INFO] (0642@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n2016-10-12 14:22:59.920 +0000 [INFO] (0539@+nasdaq_analysis+task2) io.digdag.core.agent.OperatorManager: td>: queries/monthly_open.sql\n```\n\n# \u6240\u611f\n\n\u3061\u3087\u3063\u3068\u89e6\u3063\u305f\u3060\u3051\u3060\u304c\u3001Treasure Data\u3067\u52d5\u304b\u3059\u305f\u3081\u306b\u3057\u3063\u304b\u308a\u3068\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b\u5370\u8c61\u3002\n\n\u3068\u304f\u306b\u3001\u30a8\u30e9\u30fc\u6642\u306e\u60c5\u5831\u53d6\u5f97\u3001\u539f\u56e0\u7279\u5b9a\u306e\u6d41\u308c\u304c\u660e\u78ba\u306b\u30b3\u30de\u30f3\u30c9\u5316\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u7d20\u6674\u3089\u3057\u3044\u3002\u30af\u30e9\u30a6\u30c9\u3067\u306e\u904b\u7528\u30b5\u30dd\u30fc\u30c8\u307e\u3067\u8003\u616e\u3057\u3066\u3044\u308b\u306e\u3067\u3042\u308d\u3046\u3002\n\n\u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u306e\u53ef\u8996\u5316\u306f\u51fa\u6765\u306a\u3044\u306e\u304b\u306a\uff1f\u3061\u3087\u3063\u3068\u8abf\u3079\u304d\u308c\u305a\u3002\n\u53ef\u8996\u5316\u304c\u3067\u304d\u306a\u3044\u3068\u3001\u8907\u96d1\u306a\u30b8\u30e7\u30d6\u3092\u4f5c\u3063\u3066\u3057\u307e\u3063\u305f\u3068\u304d\u306b\u8ca0\u50b5\u5316\u3059\u308b\u306e\u3067\u3084\u3084\u6c17\u306b\u306a\u308b\u3002\n\n\u4ee5\u4e0a\u3002\n", "tags": ["TreasureData", "Workflow"]}