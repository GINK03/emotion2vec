{"context": " More than 1 year has passed since last update.Excel\u306eUI\u64cd\u4f5c\u3060\u3068\u884c\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30d4\u30fc\u3057\u3066\u633f\u5165\u3068\u304b\u3059\u308b\u8a33\u3067\u3059\u304c\u3001\u305d\u308c\u3068\u540c\u3058\u3053\u3068\u3092Scala\u3067\u3084\u308b\u65b9\u6cd5\u3067\u3059\u3002\n\u300c\u30b3\u30d4\u30fc\u3057\u305f\u884c\u3092\u633f\u5165\u300d\u307f\u305f\u3044\u306a\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9\u306f\u306a\u3044\u306e\u3067\uff08\u3082\u3057\u304f\u306f\u3001\u898b\u3064\u3051\u3089\u308c\u306a\u304b\u3063\u305f\uff09\u3001\u4ee5\u4e0b\u306e\u624b\u9806\u3092\u8e0f\u307f\u307e\u3059\u3002\n\n\u30b3\u30d4\u30fc\u5143\u306e\u884c\u3092\u53d6\u5f97\n\u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306b\u65b0\u3057\u3044\u884c\u3092\u8ffd\u52a0\n\u884c\u3092\u8ffd\u52a0\u3059\u308b\u4f4d\u7f6e\u4ee5\u964d\u306e\u884c\u3092\u8ffd\u52a0\u884c\u5206\u305a\u3089\u3059\n\u8ffd\u52a0\u3057\u305f\u884c\u306e\u5404\u30bb\u30eb\u306b\u3001\u30b3\u30d4\u30fc\u5143\u30bb\u30eb\u306e\n\n\n\u30b9\u30bf\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\n\u30bb\u30eb\u5024\u3092\u30b3\u30d4\u30fc\n\u30de\u30fc\u30b8\u72b6\u614b\u3092\u30b3\u30d4\u30fc\n\n\n\n\n\u6e96\u5099\n\nPOI\u306e\u5c0e\u5165\u3068\u57fa\u672c\u7684\u306a\u8aad\u307f\u66f8\u304d\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u3092\u53c2\u7167\n\n\n\u30b3\u30d4\u30fc\u5143\u306e\u884c\u3092\u53d6\u5f97\nimport java.io.{File, FileOutputStream}\n\nimport org.apache.poi.ss.usermodel._\nimport org.apache.poi.ss.util.CellRangeAddress\n\nval workbook = WorkbookFactory.create(new File(\"/path/to/excel\"))\n\nval sheet = workbook.getSheetAt(0)\n\nval originalRow = sheet.getRow(0)\n\n\n\u65b0\u3057\u3044\u884c\u3092\u8ffd\u52a0\n\u30b7\u30fc\u30c8\u672b\u5c3e\u306b1\u884c\u8ffd\u52a0\u3057\u307e\u3059\u3002\nval lastRowNum = sheet.getLastRowNum\n\nsheet.createRow(lastRowNum + 1)\n\n\n\u884c\u3092\u8ffd\u52a0\u3059\u308b\u4f4d\u7f6e\u4ee5\u964d\u306e\u884c\u3092\u4e0b\u306b\u305a\u3089\u3059\n\u884c\u3092\u8ffd\u52a0\u3057\u305f\u3044\u4f4d\u7f6e\u3092startRowNumber\u3068\u3059\u308b\u3068\u3001\u305d\u3053\u304b\u3089\u4e0b\u306e\u5168\u884c\u3092\uff11\u884c\u4e0b\u306b\u305a\u3089\u3057\u307e\u3059\u3002\nval startRowNumber = 5\n\nsheet.shiftRows(startRowNumber, lastRowNum + 1, 1)\n\n\n\n\u8ffd\u52a0\u3057\u305f\u884c\u306e\u30b9\u30bf\u30a4\u30eb\u30fb\u30bb\u30eb\u5024\u3092\u8a2d\u5b9a\n\u4eca\u56de\u306f\u30b9\u30bf\u30a4\u30eb\u3068\u30bf\u30a4\u30d7\u3001\u5024\u306e\u307f\u30b3\u30d4\u30fc\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u4ed6\u306b\u3082\u30bb\u30eb\u306e\u30b3\u30e1\u30f3\u30c8\u306a\u3069\u3082\u5fc5\u8981\u306a\u3089\u3070\u540c\u3058\u3088\u3046\u306b\u30b3\u30d4\u30fc\uff06\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n  val newRow = sheet.getRow(startRowNumber)\n\n  for{\n    index <- 0 until originalRow.getLastCellNum\n  } {\n    val originalCell = originalRow.getCell(index)\n    val newCell = newRow.createCell(index)\n\n    // \u30bb\u30eb\u306e\u30b9\u30bf\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\n    val newCellStyle = workbook.createCellStyle\n    newCellStyle.cloneStyleFrom(originalCell.getCellStyle)\n    newCell.setCellStyle(newCellStyle)\n    // \u30bb\u30eb\u30bf\u30a4\u30d7\u306e\u30b3\u30d4\u30fc\n    newCell.setCellType(originalCell.getCellType)\n    // \u30bb\u30eb\u5024\u306e\u30b3\u30d4\u30fc\n    originalCell.getCellType match {\n      case Cell.CELL_TYPE_BLANK =>\n        newCell.setCellValue(originalCell.getStringCellValue)\n      case Cell.CELL_TYPE_BOOLEAN =>\n        newCell.setCellValue(originalCell.getBooleanCellValue)\n      case Cell.CELL_TYPE_ERROR =>\n        newCell.setCellErrorValue(originalCell.getErrorCellValue)\n      case Cell.CELL_TYPE_FORMULA =>\n        newCell.setCellFormula(originalCell.getCellFormula)\n      case Cell.CELL_TYPE_NUMERIC =>\n        newCell.setCellValue(originalCell.getNumericCellValue)\n      case Cell.CELL_TYPE_STRING =>\n        newCell.setCellValue(originalCell.getStringCellValue)\n    }\n\n  }\n\n\n\u8ffd\u52a0\u3057\u305f\u884c\u306b\u30de\u30fc\u30b8\u72b6\u614b\u3092\u8a2d\u5b9a\nval newRow = sheet.getRow(startRowNumber)\nfor{\n    index <- 0 until originalRow.getLastCellNum\n} {\n// \u7565\n  for {\n    index <- 0 until sheet.getNumMergedRegions\n    cellRangeAddress <- Option(sheet.getMergedRegion(index)) if cellRangeAddress.getFirstRow == originalRow.getRowNum\n  } {\n    sheet.addMergedRegion(new CellRangeAddress(\n      newRow.getRowNum,\n      newRow.getRowNum + (cellRangeAddress.getLastRow - cellRangeAddress.getFirstRow),\n      cellRangeAddress.getFirstColumn,\n      cellRangeAddress.getLastColumn\n    ))\n  }\n\n  // \u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u51fa\u3059\n  val out = new FileOutputStream(\"/path/to/output\")\n  workbook.write(out)\n  out.close\n}\n\n\u4ee5\u4e0a\u3067\u3001\u884c\u3092\u8ffd\u52a0\u3057\u305f\u3044\u4f4d\u7f6e\u306b\u30b3\u30d4\u30fc\u5143\u3068\u540c\u3058\u884c\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u308c\u3092\u3061\u3087\u3063\u3068\u30a2\u30ec\u30f3\u30b8\u3059\u308c\u3070\u8907\u6570\u884c\u306e\u30b3\u30d4\u30fc\u3082\u3044\u3051\u307e\u3059\u3002\n\nExcel\u306eUI\u64cd\u4f5c\u3060\u3068\u884c\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30d4\u30fc\u3057\u3066\u633f\u5165\u3068\u304b\u3059\u308b\u8a33\u3067\u3059\u304c\u3001\u305d\u308c\u3068\u540c\u3058\u3053\u3068\u3092Scala\u3067\u3084\u308b\u65b9\u6cd5\u3067\u3059\u3002\n\n\u300c\u30b3\u30d4\u30fc\u3057\u305f\u884c\u3092\u633f\u5165\u300d\u307f\u305f\u3044\u306a\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9\u306f\u306a\u3044\u306e\u3067\uff08\u3082\u3057\u304f\u306f\u3001\u898b\u3064\u3051\u3089\u308c\u306a\u304b\u3063\u305f\uff09\u3001\u4ee5\u4e0b\u306e\u624b\u9806\u3092\u8e0f\u307f\u307e\u3059\u3002\n\n* \u30b3\u30d4\u30fc\u5143\u306e\u884c\u3092\u53d6\u5f97\n* \u30ef\u30fc\u30af\u30b7\u30fc\u30c8\u306b\u65b0\u3057\u3044\u884c\u3092\u8ffd\u52a0\n* \u884c\u3092\u8ffd\u52a0\u3059\u308b\u4f4d\u7f6e\u4ee5\u964d\u306e\u884c\u3092\u8ffd\u52a0\u884c\u5206\u305a\u3089\u3059\n* \u8ffd\u52a0\u3057\u305f\u884c\u306e\u5404\u30bb\u30eb\u306b\u3001\u30b3\u30d4\u30fc\u5143\u30bb\u30eb\u306e\n\t* \u30b9\u30bf\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\n\t* \u30bb\u30eb\u5024\u3092\u30b3\u30d4\u30fc\n\t* \u30de\u30fc\u30b8\u72b6\u614b\u3092\u30b3\u30d4\u30fc\n\n\n# \u6e96\u5099\n* POI\u306e\u5c0e\u5165\u3068\u57fa\u672c\u7684\u306a\u8aad\u307f\u66f8\u304d\u306b\u3064\u3044\u3066\u306f[\u3053\u3061\u3089](http://qiita.com/modal_soul/items/83074d5ef768a8edb3c9)\u3092\u53c2\u7167\n\n# \u30b3\u30d4\u30fc\u5143\u306e\u884c\u3092\u53d6\u5f97\n```scala\nimport java.io.{File, FileOutputStream}\n\nimport org.apache.poi.ss.usermodel._\nimport org.apache.poi.ss.util.CellRangeAddress\n\nval workbook = WorkbookFactory.create(new File(\"/path/to/excel\"))\n\nval sheet = workbook.getSheetAt(0)\n\nval originalRow = sheet.getRow(0)\n```\n\n# \u65b0\u3057\u3044\u884c\u3092\u8ffd\u52a0\n\u30b7\u30fc\u30c8\u672b\u5c3e\u306b1\u884c\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```scala\nval lastRowNum = sheet.getLastRowNum\n\nsheet.createRow(lastRowNum + 1)\n```\n\n# \u884c\u3092\u8ffd\u52a0\u3059\u308b\u4f4d\u7f6e\u4ee5\u964d\u306e\u884c\u3092\u4e0b\u306b\u305a\u3089\u3059\n\u884c\u3092\u8ffd\u52a0\u3057\u305f\u3044\u4f4d\u7f6e\u3092`startRowNumber`\u3068\u3059\u308b\u3068\u3001\u305d\u3053\u304b\u3089\u4e0b\u306e\u5168\u884c\u3092\uff11\u884c\u4e0b\u306b\u305a\u3089\u3057\u307e\u3059\u3002\n\n```scala\nval startRowNumber = 5\n\nsheet.shiftRows(startRowNumber, lastRowNum + 1, 1)\n\n```\n\n\n# \u8ffd\u52a0\u3057\u305f\u884c\u306e\u30b9\u30bf\u30a4\u30eb\u30fb\u30bb\u30eb\u5024\u3092\u8a2d\u5b9a\n\u4eca\u56de\u306f\u30b9\u30bf\u30a4\u30eb\u3068\u30bf\u30a4\u30d7\u3001\u5024\u306e\u307f\u30b3\u30d4\u30fc\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u4ed6\u306b\u3082\u30bb\u30eb\u306e\u30b3\u30e1\u30f3\u30c8\u306a\u3069\u3082\u5fc5\u8981\u306a\u3089\u3070\u540c\u3058\u3088\u3046\u306b\u30b3\u30d4\u30fc\uff06\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```scala\n  val newRow = sheet.getRow(startRowNumber)\n\n  for{\n  \tindex <- 0 until originalRow.getLastCellNum\n  } {\n  \tval originalCell = originalRow.getCell(index)\n  \tval newCell = newRow.createCell(index)\n\n  \t// \u30bb\u30eb\u306e\u30b9\u30bf\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\n  \tval newCellStyle = workbook.createCellStyle\n  \tnewCellStyle.cloneStyleFrom(originalCell.getCellStyle)\n  \tnewCell.setCellStyle(newCellStyle)\n  \t// \u30bb\u30eb\u30bf\u30a4\u30d7\u306e\u30b3\u30d4\u30fc\n  \tnewCell.setCellType(originalCell.getCellType)\n  \t// \u30bb\u30eb\u5024\u306e\u30b3\u30d4\u30fc\n  \toriginalCell.getCellType match {\n      case Cell.CELL_TYPE_BLANK =>\n        newCell.setCellValue(originalCell.getStringCellValue)\n      case Cell.CELL_TYPE_BOOLEAN =>\n        newCell.setCellValue(originalCell.getBooleanCellValue)\n      case Cell.CELL_TYPE_ERROR =>\n        newCell.setCellErrorValue(originalCell.getErrorCellValue)\n      case Cell.CELL_TYPE_FORMULA =>\n        newCell.setCellFormula(originalCell.getCellFormula)\n      case Cell.CELL_TYPE_NUMERIC =>\n        newCell.setCellValue(originalCell.getNumericCellValue)\n      case Cell.CELL_TYPE_STRING =>\n        newCell.setCellValue(originalCell.getStringCellValue)\n  \t}\n\n  }\n```\n\n# \u8ffd\u52a0\u3057\u305f\u884c\u306b\u30de\u30fc\u30b8\u72b6\u614b\u3092\u8a2d\u5b9a\n```scala\nval newRow = sheet.getRow(startRowNumber)\nfor{\n\tindex <- 0 until originalRow.getLastCellNum\n} {\n// \u7565\n  for {\n    index <- 0 until sheet.getNumMergedRegions\n    cellRangeAddress <- Option(sheet.getMergedRegion(index)) if cellRangeAddress.getFirstRow == originalRow.getRowNum\n  } {\n    sheet.addMergedRegion(new CellRangeAddress(\n      newRow.getRowNum,\n      newRow.getRowNum + (cellRangeAddress.getLastRow - cellRangeAddress.getFirstRow),\n      cellRangeAddress.getFirstColumn,\n      cellRangeAddress.getLastColumn\n    ))\n  }\n  \n  // \u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u51fa\u3059\n  val out = new FileOutputStream(\"/path/to/output\")\n  workbook.write(out)\n  out.close\n}\n```\n\n\u4ee5\u4e0a\u3067\u3001\u884c\u3092\u8ffd\u52a0\u3057\u305f\u3044\u4f4d\u7f6e\u306b\u30b3\u30d4\u30fc\u5143\u3068\u540c\u3058\u884c\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u308c\u3092\u3061\u3087\u3063\u3068\u30a2\u30ec\u30f3\u30b8\u3059\u308c\u3070\u8907\u6570\u884c\u306e\u30b3\u30d4\u30fc\u3082\u3044\u3051\u307e\u3059\u3002\n", "tags": ["Scala", "Excel", "POI", "Apache"]}