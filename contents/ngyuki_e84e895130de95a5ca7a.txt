{"context": " More than 1 year has passed since last update.\u5148\u307b\u3069\u6b21\u306e\u3088\u3046\u306a\u8a18\u4e8b\u3092\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\nGoogle Cloud Storage \u306b AWS CLI \u3084 AWS SDK for PHP \u3067\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\n\u8981\u3059\u308b\u306b Interoperability API \u3092\u6709\u52b9\u306b\u3059\u308c\u3070 S3 \u4e92\u63db\u306e REST API \u304c\u6709\u52b9\u306b\u306a\u308b\u3063\u3066\u3053\u3068\u306a\u306e\u3067\u3001\u666e\u901a\u306b curl \u3067 REST API \u3092\u53e9\u3044\u3066\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u307f\u307e\u3059\u3002\n<?php\n$accessKey = 'YOUR_ACCESS_KEY';\n$secretAccessKey = 'YOUR_SECRET_ACCESS_KEY';\n$bucket = 'YOUR_BUCKET_NAME';\n\n$path = 'rest.txt';\n$type = 'text/plain';\n$body = 'this is rest api';\n\n$verb = 'PUT';\n$md5 = base64_encode(md5($body, true));\n$date = gmdate(\\DateTime::RFC2822);\n$amzHeaders = '';\n$resource = \"/$bucket/$path\";\n\n$stringToSign = implode(\"\\n\", [$verb, $md5, $type, $date, $amzHeaders . $resource]);\n$signature = base64_encode(hash_hmac('sha1', $stringToSign, $secretAccessKey, true));\n$authorization = sprintf('AWS %s:%s', $accessKey, $signature);\n\n$headers = [\n    \"Date: $date\",\n    \"Content-Type: $type\",\n    \"Content-MD5: $md5\",\n    \"Authorization: $authorization\",\n];\n\n$ch = curl_init();\n\ncurl_setopt_array($ch, [\n    CURLOPT_URL => \"https://storage.googleapis.com/$bucket/$path\",\n    CURLOPT_CUSTOMREQUEST => 'PUT',\n    CURLOPT_HEADER => true,\n    CURLOPT_HTTPHEADER => $headers,\n    CURLOPT_POSTFIELDS => $body,\n]);\n\ncurl_exec($ch);\n\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ php google-cloud-storage-rest.php\n\n\u30c7\u30d9\u30ed\u30c3\u30d1\u30fc\u30b3\u30f3\u30bd\u30fc\u30eb\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u30d6\u30e9\u30a6\u30b6\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u5148\u307b\u3069\u6b21\u306e\u3088\u3046\u306a\u8a18\u4e8b\u3092\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\n\n[Google Cloud Storage \u306b AWS CLI \u3084 AWS SDK for PHP \u3067\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9](http://qiita.com/ngyuki/items/fd3bb47cd4aeb2f61fec)\n\n\u8981\u3059\u308b\u306b Interoperability API \u3092\u6709\u52b9\u306b\u3059\u308c\u3070 S3 \u4e92\u63db\u306e REST API \u304c\u6709\u52b9\u306b\u306a\u308b\u3063\u3066\u3053\u3068\u306a\u306e\u3067\u3001\u666e\u901a\u306b curl \u3067 REST API \u3092\u53e9\u3044\u3066\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u307f\u307e\u3059\u3002\n\n```php\n<?php\n$accessKey = 'YOUR_ACCESS_KEY';\n$secretAccessKey = 'YOUR_SECRET_ACCESS_KEY';\n$bucket = 'YOUR_BUCKET_NAME';\n\n$path = 'rest.txt';\n$type = 'text/plain';\n$body = 'this is rest api';\n\n$verb = 'PUT';\n$md5 = base64_encode(md5($body, true));\n$date = gmdate(\\DateTime::RFC2822);\n$amzHeaders = '';\n$resource = \"/$bucket/$path\";\n\n$stringToSign = implode(\"\\n\", [$verb, $md5, $type, $date, $amzHeaders . $resource]);\n$signature = base64_encode(hash_hmac('sha1', $stringToSign, $secretAccessKey, true));\n$authorization = sprintf('AWS %s:%s', $accessKey, $signature);\n\n$headers = [\n    \"Date: $date\",\n    \"Content-Type: $type\",\n    \"Content-MD5: $md5\",\n    \"Authorization: $authorization\",\n];\n\n$ch = curl_init();\n\ncurl_setopt_array($ch, [\n    CURLOPT_URL => \"https://storage.googleapis.com/$bucket/$path\",\n    CURLOPT_CUSTOMREQUEST => 'PUT',\n    CURLOPT_HEADER => true,\n    CURLOPT_HTTPHEADER => $headers,\n    CURLOPT_POSTFIELDS => $body,\n]);\n\ncurl_exec($ch);\n```\n\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```console\n$ php google-cloud-storage-rest.php\n```\n\n\u30c7\u30d9\u30ed\u30c3\u30d1\u30fc\u30b3\u30f3\u30bd\u30fc\u30eb\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u30d6\u30e9\u30a6\u30b6\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n![10-rest.png](https://qiita-image-store.s3.amazonaws.com/0/8734/8f80e15e-7230-dd5d-76b6-20422f4d6b16.png)\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n", "tags": ["GoogleCloudPlatform", "AWS", "PHP"]}