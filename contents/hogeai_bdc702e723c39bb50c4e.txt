{"context": "\n\n\u793e\u5185\u30d7\u30ed\u30ad\u30b7\u304d\u3064\u304f\u3066\u3001Outlook\u3057\u304b\u4f7f\u3048\u306a\u3044\u4eba\u306e\u305f\u3081\u306b\n\nOutlook\u306e\u30bf\u30b9\u30af\u6a5f\u80fd\u306f\u3001\u3081\u3061\u3083\u304f\u3061\u3083\u51c4\u3044\n\nTodoixx\u3060\u30fc\u3001Wundexxx\u3060\u30fc\u8a00\u3046\u307e\u3048\u306b\u3001Outlook\u3064\u304b\u3044\u3053\u306a\u305b\u3066\u308b\uff1f\n\u3069\u3046\u305b\u4f1a\u793e\u306f\u3001Outlook\u5f37\u5236\u3060\u308d\uff1f\uff01\nOutlook\u306e\u30bf\u30b9\u30af\u767b\u9332\u3063\u3066\u3001\u3081\u3063\u3061\u3083\u9ad8\u6a5f\u80fd\uff01\n\u3081\u3063\u3061\u3083\u51c4\u3044\u3051\u3069\u3001\u767b\u9332\u304c\u9762\u5012\u304f\u3055\u304f\u3066\u8ab0\u3082\u4f7f\u3063\u3066\u306a\u3044\n\n\nPython\u306e\u8eab\u8efd\u3055\u3092\u5229\u7528\n\nPython\u3067\u30bd\u30fc\u30b9\u4f5c\u308c\u3070\u3001\u8272\u3005\u9023\u643a\u3067\u304d\u308b\u3057\u30a2\u30a4\u30c7\u30a2\u6b21\u7b2c\u3067\u81ea\u7531\nNotification\u307f\u305f\u3044\u306b\u3082\u4f7f\u3048\u308b\n\u671f\u9650\u3064\u304d\u3082Post\u3082\u8a2d\u5b9a\u53ef\u80fd(\u671f\u9650\u306f\u3001\u624b\u52d5\u3067\u8a2d\u5b9a\u3059\u308c\u3070\u3044\u3044\u3051\u3069)\n\n\nVimmer\uff1f\n\nVim\u304b\u3089Python\u547c\u3073\u3060\u3057\u3066\u3001Outlook\u306bTask\u767b\u9332\u3067\u304d\u308b\u3088\nVim\u3058\u3083\u306a\u304f\u3066\u3082\u3001Python\u5b9f\u884c\u3059\u308c\u3070\u3067\u304d\u308b\n\n\n\u4eca\u56de\u306e\u4f8b\u306fVim\u3092\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306b\u30bf\u30b9\u30af\u3092\u6d41\u3057\u8fbc\u3080\n\nVim\u3067\u4f55\u304b\u3092\u66f8\u304f\n[:PostOutlookTask]\u3059\u308b\u3068\u3001\u66f8\u3044\u3066\u308b\u6587\u7ae0\u3092Outlook\u306eTask\u306b\u767b\u9332\u3059\u308b\nfilename\u306bPath\u3064\u3063\u3053\u3081\u3070\u3001Python\u3060\u3051\u3067\u3082\u5b9f\u884c\u3067\u304d\u308b\n\n\nwin32com.client\n\nOutlook\u64cd\u4f5c\u3059\u308bwin32com.client\u6e96\u5099\u3057\u3066\u304f\u3060\u3055\u3044\nAnaconda\u74b0\u5883\u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5165\u3063\u3066\u3044\u308b\u304b\u3089\u5927\u4e08\u592bdeath\n\n\u30bd\u30fc\u30b9\n\nOutlook_alert_vim.py\n# coding: utf-8\nimport pytz\nimport sys\nfrom datetime import datetime, timedelta\nimport win32com.client as wcl\n\n\ndef win_time_norm(d):\n    '''\n    Outlook\u306eTimeFormat\u306b\u5909\u63db\n    :param d: Datetime\n    :return: Type pytx Datetime\n    '''\n    date = pytz.utc.localize(d)\n    return date\n\n\ndef post_outlook_task(task_list):\n    '''\n    Outlook\u306b\u30bf\u30b9\u30af\u767b\u9332\u3092\u3059\u308b\n    \u30fbwin32com.client\u3092\u6e96\u5099\u3059\u308b\u3053\u3068\n    \u30fbAnaconda\u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5165\u3063\u3066\u3044\u308b\n    out_task.DueDate = s_win_day\n    \u30fb\u65e5\u4ed8\u3092\u4eca\u65e5\u306b\u3059\u308c\u3070Notification\u304c\u308f\u308a\u306b\u3082\u4f7f\u3048\u308b\n    \u30fb\u671f\u9650\u3092\u3057\u3066\u3044\u3059\u308b\u5834\u5408\u306f\u3001e_win_day\u3092\u767b\u9332\n      \u30fbedday(5\u65e5)\u30675\u65e5\u5f8c\u30a2\u30e9\u30fc\u30c8\u306b\u3057\u3066\u308b\n    :param task_list: VIM\u306eText 1\u884c\u76ee\u3092Subject\n    '''\n    stday = datetime.today()\n    edday = datetime.today() + timedelta(days=5)\n    s_win_day = win_time_norm(stday)\n    e_win_day = win_time_norm(edday)\n\n    outlook = wcl.Dispatch(\"Outlook.Application\")\n    for task in task_list:\n        out_task = outlook.CreateItem(3)\n        out_task.Subject = task[0]\n        out_task.Body = task[1]\n        out_task.StartDate = s_win_day\n        out_task.DueDate = s_win_day\n        # out_task.DueDate = e_win_day\n        out_task.ReminderSet = True\n        out_task.Save()\n\n\ndef main(args):\n    filename = str(args[0])\n    with open(filename, mode=\"r\", encoding='utf-8') as fh:\n        data = fh.readlines()\n\n    data = [t.strip().strip('\\n') for t in data if t]\n    # \u9023\u7d9a\u767b\u9332\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u308b(\u4eca\u56de\u306e\u4f8b\u3067\u306f\u3044\u3089\u306a\u3044\u3051\u3069)\n    task_list = []\n    task_list.append((data[0], \"\\n\".join(data)))\n    # task_list.append((\"test subject\",\"body row1 \\n body row2\"))\n\n    post_outlook_task(task_list)\n\n\nif __name__ == \"__main__\":\n    main(sys.argv[1:])\n\n\ns:python_file\u306e\u5834\u6240\u306f\u3001\u81ea\u5206\u3067\u6307\u5b9a\u3057\u3066\u306d\u3002\n\n_vimrc\n\"outlook_task_vim\"{{{\nfunction! s:outlook_posttask_vim()\"\n    let s:python_file = \"D:/Outlook_alert_vim.py\"\n    let s:file = tempname()\n    silent execute \":write \" . s:file\n    silent execute \"!python \" . s:python_file . ' ' . s:file\n    call delete(s:file)\n    unlet! s:file\n    unlet! s:py_script\nendfunction augroup END\"\ncommand! -nargs=0 PostOutlookTask call s:outlook_posttask_vim()\n\"}}}\n\n\n\n# \u793e\u5185\u30d7\u30ed\u30ad\u30b7\u304d\u3064\u304f\u3066\u3001Outlook\u3057\u304b\u4f7f\u3048\u306a\u3044\u4eba\u306e\u305f\u3081\u306b\n\n## Outlook\u306e\u30bf\u30b9\u30af\u6a5f\u80fd\u306f\u3001\u3081\u3061\u3083\u304f\u3061\u3083\u51c4\u3044\n- Todoixx\u3060\u30fc\u3001Wundexxx\u3060\u30fc\u8a00\u3046\u307e\u3048\u306b\u3001Outlook\u3064\u304b\u3044\u3053\u306a\u305b\u3066\u308b\uff1f\n- \u3069\u3046\u305b\u4f1a\u793e\u306f\u3001Outlook\u5f37\u5236\u3060\u308d\uff1f\uff01\n- Outlook\u306e\u30bf\u30b9\u30af\u767b\u9332\u3063\u3066\u3001\u3081\u3063\u3061\u3083\u9ad8\u6a5f\u80fd\uff01\n- \u3081\u3063\u3061\u3083\u51c4\u3044\u3051\u3069\u3001\u767b\u9332\u304c\u9762\u5012\u304f\u3055\u304f\u3066\u8ab0\u3082\u4f7f\u3063\u3066\u306a\u3044\n\n## Python\u306e\u8eab\u8efd\u3055\u3092\u5229\u7528\n- Python\u3067\u30bd\u30fc\u30b9\u4f5c\u308c\u3070\u3001\u8272\u3005\u9023\u643a\u3067\u304d\u308b\u3057\u30a2\u30a4\u30c7\u30a2\u6b21\u7b2c\u3067\u81ea\u7531\n- Notification\u307f\u305f\u3044\u306b\u3082\u4f7f\u3048\u308b\n- \u671f\u9650\u3064\u304d\u3082Post\u3082\u8a2d\u5b9a\u53ef\u80fd(\u671f\u9650\u306f\u3001\u624b\u52d5\u3067\u8a2d\u5b9a\u3059\u308c\u3070\u3044\u3044\u3051\u3069)\n\n## Vimmer\uff1f\n- Vim\u304b\u3089Python\u547c\u3073\u3060\u3057\u3066\u3001Outlook\u306bTask\u767b\u9332\u3067\u304d\u308b\u3088\n- Vim\u3058\u3083\u306a\u304f\u3066\u3082\u3001Python\u5b9f\u884c\u3059\u308c\u3070\u3067\u304d\u308b\n\n### \u4eca\u56de\u306e\u4f8b\u306fVim\u3092\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306b\u30bf\u30b9\u30af\u3092\u6d41\u3057\u8fbc\u3080\n- Vim\u3067\u4f55\u304b\u3092\u66f8\u304f\n- [:PostOutlookTask]\u3059\u308b\u3068\u3001\u66f8\u3044\u3066\u308b\u6587\u7ae0\u3092Outlook\u306eTask\u306b\u767b\u9332\u3059\u308b\n- filename\u306bPath\u3064\u3063\u3053\u3081\u3070\u3001Python\u3060\u3051\u3067\u3082\u5b9f\u884c\u3067\u304d\u308b\n\n### win32com.client\n- Outlook\u64cd\u4f5c\u3059\u308bwin32com.client\u6e96\u5099\u3057\u3066\u304f\u3060\u3055\u3044\n- Anaconda\u74b0\u5883\u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5165\u3063\u3066\u3044\u308b\u304b\u3089\u5927\u4e08\u592bdeath\n\n\n\u30bd\u30fc\u30b9\n\n```python:Outlook_alert_vim.py\n# coding: utf-8\nimport pytz\nimport sys\nfrom datetime import datetime, timedelta\nimport win32com.client as wcl\n\n\ndef win_time_norm(d):\n    '''\n    Outlook\u306eTimeFormat\u306b\u5909\u63db\n    :param d: Datetime\n    :return: Type pytx Datetime\n    '''\n    date = pytz.utc.localize(d)\n    return date\n\n\ndef post_outlook_task(task_list):\n    '''\n    Outlook\u306b\u30bf\u30b9\u30af\u767b\u9332\u3092\u3059\u308b\n    \u30fbwin32com.client\u3092\u6e96\u5099\u3059\u308b\u3053\u3068\n    \u30fbAnaconda\u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5165\u3063\u3066\u3044\u308b\n    out_task.DueDate = s_win_day\n    \u30fb\u65e5\u4ed8\u3092\u4eca\u65e5\u306b\u3059\u308c\u3070Notification\u304c\u308f\u308a\u306b\u3082\u4f7f\u3048\u308b\n    \u30fb\u671f\u9650\u3092\u3057\u3066\u3044\u3059\u308b\u5834\u5408\u306f\u3001e_win_day\u3092\u767b\u9332\n      \u30fbedday(5\u65e5)\u30675\u65e5\u5f8c\u30a2\u30e9\u30fc\u30c8\u306b\u3057\u3066\u308b\n    :param task_list: VIM\u306eText 1\u884c\u76ee\u3092Subject\n    '''\n    stday = datetime.today()\n    edday = datetime.today() + timedelta(days=5)\n    s_win_day = win_time_norm(stday)\n    e_win_day = win_time_norm(edday)\n\n    outlook = wcl.Dispatch(\"Outlook.Application\")\n    for task in task_list:\n        out_task = outlook.CreateItem(3)\n        out_task.Subject = task[0]\n        out_task.Body = task[1]\n        out_task.StartDate = s_win_day\n        out_task.DueDate = s_win_day\n        # out_task.DueDate = e_win_day\n        out_task.ReminderSet = True\n        out_task.Save()\n\n\ndef main(args):\n    filename = str(args[0])\n    with open(filename, mode=\"r\", encoding='utf-8') as fh:\n        data = fh.readlines()\n\n    data = [t.strip().strip('\\n') for t in data if t]\n    # \u9023\u7d9a\u767b\u9332\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u308b(\u4eca\u56de\u306e\u4f8b\u3067\u306f\u3044\u3089\u306a\u3044\u3051\u3069)\n    task_list = []\n    task_list.append((data[0], \"\\n\".join(data)))\n    # task_list.append((\"test subject\",\"body row1 \\n body row2\"))\n\n    post_outlook_task(task_list)\n\n\nif __name__ == \"__main__\":\n    main(sys.argv[1:])\n```\n\ns:python_file\u306e\u5834\u6240\u306f\u3001\u81ea\u5206\u3067\u6307\u5b9a\u3057\u3066\u306d\u3002\n\n```vim:_vimrc\n\"outlook_task_vim\"{{{\nfunction! s:outlook_posttask_vim()\"\n    let s:python_file = \"D:/Outlook_alert_vim.py\"\n    let s:file = tempname()\n    silent execute \":write \" . s:file\n    silent execute \"!python \" . s:python_file . ' ' . s:file\n    call delete(s:file)\n    unlet! s:file\n    unlet! s:py_script\nendfunction augroup END\"\ncommand! -nargs=0 PostOutlookTask call s:outlook_posttask_vim()\n\"}}}\n\n```\n", "tags": ["Python", "Vim", "Outlook"]}