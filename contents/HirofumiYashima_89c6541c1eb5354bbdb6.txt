{"context": " More than 1 year has passed since last update.\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u3001\u4efb\u610f\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u5b58\u3057\u305f sql \u30b9\u30af\u30ea\u30d7\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb\u3092 Python \u5185\u90e8\u304b\u3089\u8aad\u307f\u8fbc\u3093\u3067\u3001DB \u306b sqlalchemy \u306e\u30af\u30a8\u30ea\u3068\u3057\u3066\u767a\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\uff08\u4f8b\uff09\u62e1\u5f35\u5b50 .sql \u306e\u30af\u30a8\u30ea\u30fb\u30d5\u30a1\u30a4\u30eb\u304c\u3001Python \u3092\u5b9f\u884c\u4e2d\u306e\u30ab\u30ec\u30f3\u30c8\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u5834\u5408\n\n\u203b\u9069\u5b9c\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u7d76\u5bfe\u30d1\u30b9\u3092\u8a18\u8ff0\u3057\u3066\u304f\u3060\u3055\u3044\n\nquery = codecs.open(os.path.join(os.getcwd(), 'sample.sql'), 'r', 'utf-8'.read()\nfor row in session.execute(query):\n          print(row.id)\n          print(row.name)\n\n\n\u307e\u305f\u3001.sql \u30d5\u30a1\u30a4\u30eb\u306b\u3001\u5909\u6570\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3001Python \u3067\u547c\u3073\u51fa\u3057\u3066\u30af\u30a8\u30ea\u5b9f\u884c\u3059\u308b\u969b\u306b\u3001Python \u5185\u90e8\u304b\u3089\u5909\u6570\u306b\u5024\u3092\u6e21\u3057\u3066\u52d5\u7684\u306bSQL \u3092\u751f\u6210\u3059\u308b\u306b\u306f\u3001.sql \u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\n\u5909\u6570\u3092\u53d7\u3051\u53d6\u308b\uff08sql\u4e2d\u306e\uff09\u8a9e\u53e5 =: \u5909\u6570\u540d\n\n\nselect id, name from Pilots where name = :pilot_name;\n\n\n\u4e0a\u8a18\u306e\u30af\u30a8\u30ea\u3092\u8aad\u307f\u8fbc\u3093\u3060 Python \u30b9\u30af\u30ea\u30d7\u30c8\u5074\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u8981\u9818\u3067\u3001\u5909\u6570\u306b\u5024\u3092\u6e21\u3057\u307e\u3059\n\n\nsession.execute(query, {'pilot_name': pilot_name})\n\n\n\n\u4ee5\u4e0b\u3001\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\n\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\n\n\n\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u7528 sql \u30d5\u30a1\u30a4\u30eb\n\n\nsample.sql\n\n\nsample.sql\nselect id, name from Pilots order by id;\n\n\n\nsample_2.sql\n\n\nsample_2.sql\nselect id, name from Pilots where name = :pilot_name;\n\n\n\n\nPython \u30b3\u30fc\u30c9\u4f8b\n\n\nPython 2.7\nfrom sqlalchemy import create_engine, Integer, String\nfrom sqlalchemy.sql import select, text, bindparam, exists, func, and_, or_, not_\n\nengine = create_engine(\"postgresql://yashima@localhost:5432/testdb\")\nconn = engine.connect()\n\nconn\n\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm.session import sessionmaker\nfrom sqlalchemy.schema import Column\nfrom sqlalchemy.dialects.postgresql import DATE, VARCHAR, DOUBLE_PRECISION, BIGINT, INTEGER\nfrom sqlalchemy.dialects.postgresql import NUMERIC\n\nsession = sessionmaker(bind=engine)\nsession\n\n\n\n\n\nPython 2.7\nBase = declarative_base()\n\nsession = sessionmaker(bind=engine)()\n\n\n\n\n\nPython 2.7\nclass Pilots(Base):\n    __tablename__ = 'pilots'\n    id = Column(INTEGER, primary_key=True)\n    name = Column(VARCHAR(20))\n\n\nBase.metadata.create_all(engine)\n\n\n\n\nPython 2.7\nsession = sessionmaker(bind=engine)()\n\nsession\n\nsession.query()\n\nfor row in session.query(Pilots):\n    print(row.name)\n\n\n\n\u307e\u3060\u30c6\u30fc\u30d6\u30eb\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u6295\u5165\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u53c2\u7167\u3057\u3066\u3082\u4f55\u3082\u5e30\u3063\u3066\u3053\u306a\u3044\n\n\n\n\u30ec\u30b3\u30fc\u30c9\u3092\u6295\u5165\n\n\nPython 2.7\npilot = Pilots(name = '\u7dbe\u6ce2\u30ec\u30a4')\n\nsession.add(pilot)\n\nfor row in session.query(Pilots):\n    print(row.name)\n\n\n\nsession.commit()\n\n\n\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u7528SQL \u30d5\u30a1\u30a4\u30eb \u3067\u3042\u308b sample.sql \u3092\u547c\u3073\u51fa\u3057\u3066\u3001\u30af\u30a8\u30ea\u3092\u8aad\u307f\u8fbc\u3080\n\n\n\nsample.sql \u30d5\u30a1\u30a4\u30eb \u306f \u30ab\u30ec\u30f3\u30c8\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b\u306e\u3067\u3001os.getcwd() \u3068 \u30d5\u30a1\u30a4\u30eb\u540d sample.sql \u3092\u6587\u5b57\u5217\u9023\u7d50\uff08join)\u3057\u3066\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u7d76\u5bfe\u30d1\u30b9\u3092\u5f97\u308b\n\u30d5\u30a1\u30a4\u30eb\u306e\u7d76\u5bfe\u30d1\u30b9 \u3092 codecs.open() \u306b\u6e21\u3057\u3066\u3001\u6587\u5b57\u30b3\u30fc\u30c9 utf_8 \u3067 \u8aad\u307f\u8fbc\u307f\u5c02\u7528 (r) \u3067\u958b\u304f\n\n\nPython 2.7\nimport codecs\n\nimport os\n\nos.getcwd()\n\nquery = codecs.open(os.path.join(os.getcwd(), 'sample.sql'), 'r', 'utf-8'.read()\n\nprint(query)\n\n\n\n\nsession.execute( \u30af\u30a8\u30ea \uff09 \u3067 \u30af\u30a8\u30ea\u6587 \u3092\u767a\u884c\n\n \uff08 \u53c2\u8003 \uff09SQLAlchemy 0.6.5 \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 (\u548c\u8a33) \n\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u3063\u3066 SQL \u3092\u5b9f\u884c\u3059\u308b\nSession \u3092\u4f7f\u3063\u3066\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30b3\u30f3\u30c6\u30ad \u30b9\u30c8\u306e\u4e2d\u3067SQL \u5f0f\u3084\u3001SQL \u6587\u5b57>\u5217\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\u4e00\u756a\u7c21\u5358\u306a\u65b9\u6cd5\u306f execute() \u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3082\u306e\u3067\u3001 >Engine \u3084 Connection \u3092\u4f7f\u3046\u3068\u304d\u3068\u540c\u69d8\u3001 ResultProxy \u3092\u8fd4\u3057\u307e\u3059:\nSession = sessionmaker(bind=engine)\nsession = Session()\n\u6587\u5b57\u5217\u306e SQL \u3092\u5b9f\u884c\u3059\u308b\nresult = session.execute(\"select * from table where id=:id\", >{'id':7})\nSQL \u5f0f\u3092\u5b9f\u884c\u3059\u308b\nresult = session.execute(select([mytable]).where(mytable.c.id==7))\n\n\nsession.execute(query) \u3092\u5b9f\u884c\n\n\nPython 2.7\nsession.execute(query)\n\nsession.commit()\n\n\nfor row in session.execute(query):\n    print(row.id)\n    print(row.name)\n\n\n\n\n\n\u4eca\u5ea6\u306f\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u7528SQL\u30b9\u30af\u30ea\u30d7\u30c8\u4e2d\u306b\u3001\u5909\u6570 = :pilot_name \u3092\u542b\u3093\u3060\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30af\u30a8\u30ea\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3001\u5909\u6570 pilot_name \u90e8\u5206\u306b_Python\u304b\u3089\u5024\u3092\u6e21\u3057\u3066\u3001\u52d5\u7684\u306b\u30af\u30a8\u30ea\u3092\u751f\u6210\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u308b\n\nPython 2.7\nquery = codecs.open(os.path.join(os.getcwd(), 'sample_2.sql', 'r', 'utf-8'),read()\n\n\nprint(query)\n\n\n\n\nPython 2.7\npilot_name = u'\u7dbe\u6ce2\u30ec\u30a4'\n\nsession.execute(query, {pilot_name: pilot_name})\n\n\n\n\u5b9f\u884c\u30a8\u30e9\u30fc\uff1a {pilot_name: \u306e pilot_name \u3092\u30af\u30aa\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u56f2\u3080\u306e\u3092\u5fd8\u308c\u3066\u3044\u305f\n\n\n\u30a8\u30e9\u30fc\u51fa\u529b\u753b\u9762\u3092\u898b\u308b\u3068\u3001where name = %(pilot_name)s \u3068\u51fa\u529b\u3055\u308c\u3066\u3044\u308b\u3002\u3064\u307e\u308a\u3001\u5909\u6570\u3092\u57cb\u3081\u8fbc\u3093\u3060\u90e8\u5206\u304c\u3001Python \u306b\u8aad\u307f\u8fbc\u307e\u308c\u305f\u3042\u3068\u3001\u5185\u90e8\u7684\u306b\u3001Python \u306e\u6587\u5b57\u5217\u57cb\u3081\u8fbc\u307f\uff08\u5c55\u958b\uff09\u66f8\u5f0f\u306e %(  )s \u6271\u3044\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u8aad\u307f\u53d6\u308c\u308b\n\n\n\nPython 2.7\nfor row in session.execute(query, {'pilot_name': pilot_name}):\n    print(row.id)\n    print(row.name)\n\n\n\n\u5b9f\u884c\u6210\u529f\n\n\n\n\u540d\u524d\u306e\u65e5\u672c\u8a9e\u6587\u5b57\u5217\u306f\u3001u(  ) \u30e1\u30bd\u30c3\u30c9\u306b\u6e21\u3057\u3066\u30e6\u30cb\u30b3\u30fc\u30c9\u6587\u5b57\u5217\u306b\u5909\u3048\u306a\u304f\u3066\u3082\u3001OK\n\n\nPython 2.7\npilot_name = '\u7dbe\u6ce2\u30ec\u30a4'\n\nprint(query)\n\nprint(pilot_name)\n\nsession.execute(query, {'pilot_name': pilot_name})\n\nfor row in session.execute(query, {'pilot_name': pilot_name}):\n    print(row.id)\n    print(row.name)\n\n\n\n\u5b9f\u884c\u6210\u529f\n\n\n\n\u4eca\u5ea6\u306f\u3001\u30c6\u30fc\u30d6\u30eb\u306b\u8907\u6570\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u6295\u5165\u3057\u3066\u3001\u30af\u30a8\u30ea\u7d50\u679c row\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 \u306e\u4e2d\u8eab\u3092\u3001\u6587\u5b57\u5217\u57cb\u3081\u8fbc\u307f\u66f8\u5f0f\u3067\u53c2\u7167\u3057\u3066\u307f\u307e\u3059\n\n\nPython 2.7\nname_list = ['\u7887\u30b2\u30f3\u30c9\u30a6', '\u51ac\u6708\u30b3\u30a6\u30be\u30a6', '\u7887\u30b7\u30f3\u30b8', '\u60e3\u6d41\u30a2\u30b9\u30ab\u30fb\u30e9\u30f3\u30b0\u30ec\u30fc', '\u7887\u30e6\u30a4']\n\nfor n, name in enumerate(name_list):\n    session.add(Pilots(id = n+2, name = name))\n\nsession.commit()\n\n\n\n\nPython 2.7\nfor row in session.query(Pilots):\n    print(\"id : %d  /  name : %s\" % (row.id, row.name))\n\n\n\n\n\u4ee5\u4e0b\u3067\u3082OK\n\n\nPython 2.7\nfor row in session.query(Pilots):\n    print(\"id : {row.id}\".format(**vars()))\n\n\n\n\n\n\"\u6587\u5b57\u5217 %s\" % (\u5909\u6570\u540d\uff09\u3067\u306f\u8868\u793a\u6210\u529f\u3059\u308b\u3082\u306e\u306e\u3001\"\u6587\u5b57\u5217 {\u5909\u6570\u540d}\".format(**vars()) \u66f8\u5f0f\u3067\u306f\u3001\u65e5\u672c\u8a9e\u6587\u5b57\u30b3\u30fc\u30c9\u307e\u308f\u308a\u3067\u5931\u6557\u3057\u305f\u308a\u3059\u308b\u3088\u3046\u3067\u3059\n\n\n\u540d\u524d\u3092\u30e6\u30cb\u30b3\u30fc\u30c9\u3067\u6295\u5165\u3059\u308b\u304c\u3001\u4ee5\u4e0b\u306f\u6587\u5b57\u30b3\u30fc\u30c9\u30fb\u30a8\u30e9\u30fc\u3067\u5931\u6557\n\n\nPython 2.7\nclass Pilot_2(Base):\n    __table_name__ = 'pilot_2'\n    id = Column(INTEGER, primary_key=True)\n    name = Column(VARCHAR(20))\n\n\nBase.metadata.create_all(engine)\n\nsession = sessionmaker(bind=engine)()\n\nsession\n\nsession.query()\n\n# \u307e\u3060\u30ec\u30b3\u30fc\u30c9\u3092\u6295\u5165\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u8fd4\u308a\u5024\u306f NULL \u3067OK\nfor row in session.query(Pilot_2):\n    print(row.id)\n\n#\u30ec\u30b3\u30fc\u30c9\u6295\u5165\n\nname_list  [u'\u7887\u30b2\u30f3\u30c9\u30a6', u'\u51ac\u6708\u30b3\u30a6\u30be\u30a6', u'\u7887\u30b7\u30f3\u30b8', u'\u60e3\u6d41\u30a2\u30b9\u30ab\u30fb\u30e9\u30f3\u30b0\u30ec\u30fc', u'\u7887\u30e6\u30a4']\n\nfor n, name in enumerate(name_list):\n    session.add(Pilot_2(id = n+1, name = name))\n\n\nsession.commit()\n\nfor riw in session.query(Pilot_2)\n    print(\"id : {row.id}  / name: {row.name}\".format(**vars()))\n\n\n\n\n\n\u6570\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u7d5e\u3063\u3066\u5b9f\u884c\u3059\u308b\u3068\u3001\u5b9f\u884c\u6210\u529f\u3059\u308b\n\n\nPython 2.7\nfor row in session.query(Pilot_2):\n    print(\"id : {row.id}\".format(**vars()))\n\n\n\n\n\u65e5\u672c\u8a9e\u6587\u5b57\u5217\u3092\u6271\u3046\u3068\u3001\u5931\u6557\u3059\u308b \uff5e\u3084\u306f\u308a\u3001\u6587\u5b57\u30b3\u30fc\u30c9\u307e\u308f\u308a\u304b\n\n\nPython 2.7\nfor row in session.query(Pilot_2):\n    print(\"name : {row.name}\".format(**vars()))\n\n\n\n\n\u6587\u5b57\u5217\u3092 unicode('utf-8') \u3067\u30e6\u30cb\u30b3\u30fc\u30c9\u5909\u63db\u3057\u3066\u3082\u3001\u5931\u6557\n\n\nPython 2.7\nfor row in session.query(Pilot_2):\n    print(\"name : {row.name}\".format(**vars()).unicode('utf-8'))\n\n\n\n#### __\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u3001\u4efb\u610f\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u5b58\u3057\u305f _sql_ \u30b9\u30af\u30ea\u30d7\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb\u3092 _Python_ \u5185\u90e8\u304b\u3089\u8aad\u307f\u8fbc\u3093\u3067\u3001_DB_ \u306b _sqlalchemy_ \u306e\u30af\u30a8\u30ea\u3068\u3057\u3066\u767a\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002__\n\n###### **\uff08\u4f8b\uff09\u62e1\u5f35\u5b50 __.sql__ \u306e\u30af\u30a8\u30ea\u30fb\u30d5\u30a1\u30a4\u30eb\u304c\u3001_Python_ \u3092\u5b9f\u884c\u4e2d\u306e\u30ab\u30ec\u30f3\u30c8\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u5834\u5408**\n   __\u203b\u9069\u5b9c\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u7d76\u5bfe\u30d1\u30b9\u3092\u8a18\u8ff0\u3057\u3066\u304f\u3060\u3055\u3044__\n\n>query = codecs.open(os.path.join(os.getcwd(), 'sample.sql'), 'r', 'utf-8'.read()\n>\n>for row in session.execute(query):\n          print(row.id)\n          print(row.name)\n\n#### **\u307e\u305f\u3001__.sql__ \u30d5\u30a1\u30a4\u30eb\u306b\u3001\u5909\u6570\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3001_Python_ \u3067\u547c\u3073\u51fa\u3057\u3066\u30af\u30a8\u30ea\u5b9f\u884c\u3059\u308b\u969b\u306b\u3001_Python_ \u5185\u90e8\u304b\u3089\u5909\u6570\u306b\u5024\u3092\u6e21\u3057\u3066\u52d5\u7684\u306b_SQL_ \u3092\u751f\u6210\u3059\u308b\u306b\u306f\u3001__.sql__ \u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002**\n\n##### __\u5909\u6570\u3092\u53d7\u3051\u53d6\u308b\uff08sql\u4e2d\u306e\uff09\u8a9e\u53e5 =: \u5909\u6570\u540d__\n\n> __select id, name from Pilots where name = :pilot_name;__\n\n#### **\u4e0a\u8a18\u306e\u30af\u30a8\u30ea\u3092\u8aad\u307f\u8fbc\u3093\u3060 _Python_ \u30b9\u30af\u30ea\u30d7\u30c8\u5074\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u8981\u9818\u3067\u3001\u5909\u6570\u306b\u5024\u3092\u6e21\u3057\u307e\u3059**\n\n>  __session.execute(query, {'pilot_name': pilot_name})__\n\n___\n\n### __\u4ee5\u4e0b\u3001\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059__\n\n### **\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210**\n\n![ls.png](https://qiita-image-store.s3.amazonaws.com/0/43487/42d29977-dcf1-b8d7-e51d-bac3c30fae51.png)\n\n___\n\n### **\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u7528 _sql_ \u30d5\u30a1\u30a4\u30eb**\n\n* __sample.sql__\n\n```{sql:sample.sql}\nselect id, name from Pilots order by id;\n```\n\n* __sample_2.sql__\n\n```{sql:sample_2.sql}\nselect id, name from Pilots where name = :pilot_name;\n```\n\n___\n\n### **_Python_ \u30b3\u30fc\u30c9\u4f8b**\n\n\n\n```{Python:Python 2.7}\nfrom sqlalchemy import create_engine, Integer, String\nfrom sqlalchemy.sql import select, text, bindparam, exists, func, and_, or_, not_\n\nengine = create_engine(\"postgresql://yashima@localhost:5432/testdb\")\nconn = engine.connect()\n\nconn\n\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm.session import sessionmaker\nfrom sqlalchemy.schema import Column\nfrom sqlalchemy.dialects.postgresql import DATE, VARCHAR, DOUBLE_PRECISION, BIGINT, INTEGER\nfrom sqlalchemy.dialects.postgresql import NUMERIC\n\nsession = sessionmaker(bind=engine)\nsession\n```\n\n![pic_1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/192aa3f3-6832-46a4-9617-53c208b4323b.png)\n![pic_2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/5ab8897a-f68d-6144-7fcf-44863b64d0c3.png)\n\n\n```{Python:Python 2.7}\nBase = declarative_base()\n\nsession = sessionmaker(bind=engine)()\n```\n\n![pic_3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e1cf7ad4-707f-0ba1-5082-0dda9bd40b28.png)\n![pic_4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/ca86ef0e-77b2-c54c-e764-d2267c299d89.png)\n\n\n```{Python:Python 2.7}\nclass Pilots(Base):\n\t__tablename__ = 'pilots'\n\tid = Column(INTEGER, primary_key=True)\n\tname = Column(VARCHAR(20))\n\n\nBase.metadata.create_all(engine)\n```\n\n![pic_5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/9d7066b0-fbde-761e-d022-0f4b4af727c0.png)\n\n\n\n```{Python:Python 2.7}\nsession = sessionmaker(bind=engine)()\n\nsession\n\nsession.query()\n\nfor row in session.query(Pilots):\n\tprint(row.name)\n```\n\n##### **\u307e\u3060\u30c6\u30fc\u30d6\u30eb\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u6295\u5165\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u53c2\u7167\u3057\u3066\u3082\u4f55\u3082\u5e30\u3063\u3066\u3053\u306a\u3044**\n\n\n![pic_6.png](https://qiita-image-store.s3.amazonaws.com/0/43487/b340f99d-e0d6-3266-5ffc-b93745dba581.png)\n\n##### **\u30ec\u30b3\u30fc\u30c9\u3092\u6295\u5165**\n\n\n```{Python:Python 2.7}\npilot = Pilots(name = '\u7dbe\u6ce2\u30ec\u30a4')\n\nsession.add(pilot)\n\nfor row in session.query(Pilots):\n\tprint(row.name)\n\n\n\nsession.commit()\n```\n\n![pic_7.png](https://qiita-image-store.s3.amazonaws.com/0/43487/d081235d-193d-743a-a337-eca71f072ef4.png)\n\n\n\n#### **\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u7528_SQL_ \u30d5\u30a1\u30a4\u30eb \u3067\u3042\u308b __sample.sql__ \u3092\u547c\u3073\u51fa\u3057\u3066\u3001\u30af\u30a8\u30ea\u3092\u8aad\u307f\u8fbc\u3080**\n\n* __sample.sql__ \u30d5\u30a1\u30a4\u30eb \u306f \u30ab\u30ec\u30f3\u30c8\u30fb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b\u306e\u3067\u3001__os.getcwd()__ \u3068 \u30d5\u30a1\u30a4\u30eb\u540d __sample.sql__ \u3092\u6587\u5b57\u5217\u9023\u7d50\uff08__join__)\u3057\u3066\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u7d76\u5bfe\u30d1\u30b9\u3092\u5f97\u308b\n* \u30d5\u30a1\u30a4\u30eb\u306e\u7d76\u5bfe\u30d1\u30b9 \u3092 __codecs.open()__ \u306b\u6e21\u3057\u3066\u3001\u6587\u5b57\u30b3\u30fc\u30c9 __utf_8__ \u3067 \u8aad\u307f\u8fbc\u307f\u5c02\u7528 (__r__) \u3067\u958b\u304f\n\n```{Python:Python 2.7}\nimport codecs\n\nimport os\n\nos.getcwd()\n\nquery = codecs.open(os.path.join(os.getcwd(), 'sample.sql'), 'r', 'utf-8'.read()\n\nprint(query)\n```\n\n![pic_8.png](https://qiita-image-store.s3.amazonaws.com/0/43487/caadf618-a489-dbd2-e7b7-a2dbfcc68f2a.png)\n\n#### __session.execute( \u30af\u30a8\u30ea \uff09__ \u3067 \u30af\u30a8\u30ea\u6587 \u3092\u767a\u884c\n\n* **[ \uff08 \u53c2\u8003 \uff09SQLAlchemy 0.6.5 \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 (\u548c\u8a33) ](http://omake.accense.com/static/doc-ja/sqlalchemy/session.html)**\n\n>**\u30bb\u30c3\u30b7\u30e7\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u3063\u3066 SQL \u3092\u5b9f\u884c\u3059\u308b**\n>\n>Session \u3092\u4f7f\u3063\u3066\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30b3\u30f3\u30c6\u30ad \u30b9\u30c8\u306e\u4e2d\u3067SQL \u5f0f\u3084\u3001SQL \u6587\u5b57>\u5217\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\u4e00\u756a\u7c21\u5358\u306a\u65b9\u6cd5\u306f execute() \u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3082\u306e\u3067\u3001 >Engine \u3084 Connection \u3092\u4f7f\u3046\u3068\u304d\u3068\u540c\u69d8\u3001 ResultProxy \u3092\u8fd4\u3057\u307e\u3059:\n>\n>Session = sessionmaker(bind=engine)\n>session = Session()\n>\n>**\u6587\u5b57\u5217\u306e SQL \u3092\u5b9f\u884c\u3059\u308b**\n>result = session.execute(\"select * from table where id=:id\", >{'id':7})\n>\n>**SQL \u5f0f\u3092\u5b9f\u884c\u3059\u308b**\n>result = session.execute(select([mytable]).where(mytable.c.id==7))\n\n### **__session.execute(query)__ \u3092\u5b9f\u884c**\n\n```{Python:Python 2.7}\nsession.execute(query)\n\nsession.commit()\n\n\nfor row in session.execute(query):\n\tprint(row.id)\n\tprint(row.name)\n```\n\n![pic_9.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e7359a6b-ce4e-08c5-ca6c-23d7248d2305.png)\n![pic_10.png](https://qiita-image-store.s3.amazonaws.com/0/43487/20f4457c-4b06-7199-8761-72c3bfc23420.png)\n\n\n## \u4eca\u5ea6\u306f\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u7528SQL\u30b9\u30af\u30ea\u30d7\u30c8\u4e2d\u306b\u3001\u5909\u6570 __= :pilot_name__ \u3092\u542b\u3093\u3060\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30af\u30a8\u30ea\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3001\u5909\u6570 __pilot_name__ \u90e8\u5206\u306b_Python\u304b\u3089\u5024\u3092\u6e21\u3057\u3066\u3001\u52d5\u7684\u306b\u30af\u30a8\u30ea\u3092\u751f\u6210\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u308b\n\n\n```{Python:Python 2.7}\nquery = codecs.open(os.path.join(os.getcwd(), 'sample_2.sql', 'r', 'utf-8'),read()\n\n\nprint(query)\n```\n\n![pic_11.png](https://qiita-image-store.s3.amazonaws.com/0/43487/c113fadc-f9a4-b682-4031-daa3f645d0d6.png)\n\n```{Python:Python 2.7}\npilot_name = u'\u7dbe\u6ce2\u30ec\u30a4'\n\nsession.execute(query, {pilot_name: pilot_name})\n```\n\n##### **\u5b9f\u884c\u30a8\u30e9\u30fc\uff1a __{pilot_name:__ \u306e pilot_name \u3092\u30af\u30aa\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u56f2\u3080\u306e\u3092\u5fd8\u308c\u3066\u3044\u305f**\n\n###### **\u30a8\u30e9\u30fc\u51fa\u529b\u753b\u9762\u3092\u898b\u308b\u3068\u3001__where name = %(pilot_name)s__ \u3068\u51fa\u529b\u3055\u308c\u3066\u3044\u308b\u3002\u3064\u307e\u308a\u3001\u5909\u6570\u3092\u57cb\u3081\u8fbc\u3093\u3060\u90e8\u5206\u304c\u3001_Python_ \u306b\u8aad\u307f\u8fbc\u307e\u308c\u305f\u3042\u3068\u3001\u5185\u90e8\u7684\u306b\u3001_Python_ \u306e\u6587\u5b57\u5217\u57cb\u3081\u8fbc\u307f\uff08\u5c55\u958b\uff09\u66f8\u5f0f\u306e __%(  )s__ \u6271\u3044\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u8aad\u307f\u53d6\u308c\u308b**  \n\n![pic_13.png](https://qiita-image-store.s3.amazonaws.com/0/43487/02ed23f1-12ee-1f3e-637d-9f646bb66b47.png)\n\n\n```{Python:Python 2.7}\nfor row in session.execute(query, {'pilot_name': pilot_name}):\n    print(row.id)\n    print(row.name)\n```\n\n##### **\u5b9f\u884c\u6210\u529f**\n\n![pic_13_2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/ddc994e5-2797-78be-fa6c-a58f7240c0b1.png)\n\n#### **\u540d\u524d\u306e\u65e5\u672c\u8a9e\u6587\u5b57\u5217\u306f\u3001__u(  )__ \u30e1\u30bd\u30c3\u30c9\u306b\u6e21\u3057\u3066\u30e6\u30cb\u30b3\u30fc\u30c9\u6587\u5b57\u5217\u306b\u5909\u3048\u306a\u304f\u3066\u3082\u3001OK**\n\n```{Python:Python 2.7}\npilot_name = '\u7dbe\u6ce2\u30ec\u30a4'\n\nprint(query)\n\nprint(pilot_name)\n\nsession.execute(query, {'pilot_name': pilot_name})\n\nfor row in session.execute(query, {'pilot_name': pilot_name}):\n    print(row.id)\n    print(row.name)\n```\n\n##### **\u5b9f\u884c\u6210\u529f**\n\n![pic_14.png](https://qiita-image-store.s3.amazonaws.com/0/43487/ba896306-4a6c-bae0-3c1d-0853dc988d39.png)\n\n### **\u4eca\u5ea6\u306f\u3001\u30c6\u30fc\u30d6\u30eb\u306b\u8907\u6570\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u6295\u5165\u3057\u3066\u3001\u30af\u30a8\u30ea\u7d50\u679c __row\u30aa\u30d6\u30b8\u30a7\u30af\u30c8__ \u306e\u4e2d\u8eab\u3092\u3001\u6587\u5b57\u5217\u57cb\u3081\u8fbc\u307f\u66f8\u5f0f\u3067\u53c2\u7167\u3057\u3066\u307f\u307e\u3059**\n\n```{Python:Python 2.7}\nname_list = ['\u7887\u30b2\u30f3\u30c9\u30a6', '\u51ac\u6708\u30b3\u30a6\u30be\u30a6', '\u7887\u30b7\u30f3\u30b8', '\u60e3\u6d41\u30a2\u30b9\u30ab\u30fb\u30e9\u30f3\u30b0\u30ec\u30fc', '\u7887\u30e6\u30a4']\n\nfor n, name in enumerate(name_list):\n    session.add(Pilots(id = n+2, name = name))\n\nsession.commit()\n```\n\n![pic_15.png](https://qiita-image-store.s3.amazonaws.com/0/43487/449cc3e6-60c9-958a-5df1-ee47654a7ed5.png)\n\n```{Python:Python 2.7}\nfor row in session.query(Pilots):\n    print(\"id : %d  /  name : %s\" % (row.id, row.name))\n```\n\n![pic_16.png](https://qiita-image-store.s3.amazonaws.com/0/43487/1d0de22e-56f6-2ce9-8c53-1119b7e79171.png)\n\n##### **\u4ee5\u4e0b\u3067\u3082OK**\n\n```{Python:Python 2.7}\nfor row in session.query(Pilots):\n    print(\"id : {row.id}\".format(**vars()))\n```\n\n![pic_17.png](https://qiita-image-store.s3.amazonaws.com/0/43487/60909542-1f8b-16bb-a3fd-be2f2d832738.png)\n\n___\n\n#### __\"\u6587\u5b57\u5217 %s\" % (\u5909\u6570\u540d\uff09__\u3067\u306f\u8868\u793a\u6210\u529f\u3059\u308b\u3082\u306e\u306e\u3001__\"\u6587\u5b57\u5217 {\u5909\u6570\u540d}\".format(**vars())__ \u66f8\u5f0f\u3067\u306f\u3001\u65e5\u672c\u8a9e\u6587\u5b57\u30b3\u30fc\u30c9\u307e\u308f\u308a\u3067\u5931\u6557\u3057\u305f\u308a\u3059\u308b\u3088\u3046\u3067\u3059\n\n___\n\n#### **\u540d\u524d\u3092\u30e6\u30cb\u30b3\u30fc\u30c9\u3067\u6295\u5165\u3059\u308b\u304c\u3001\u4ee5\u4e0b\u306f\u6587\u5b57\u30b3\u30fc\u30c9\u30fb\u30a8\u30e9\u30fc\u3067\u5931\u6557**\n\n```{Python:Python 2.7}\nclass Pilot_2(Base):\n\t__table_name__ = 'pilot_2'\n\tid = Column(INTEGER, primary_key=True)\n\tname = Column(VARCHAR(20))\n\n\nBase.metadata.create_all(engine)\n\nsession = sessionmaker(bind=engine)()\n\nsession\n\nsession.query()\n\n# \u307e\u3060\u30ec\u30b3\u30fc\u30c9\u3092\u6295\u5165\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u8fd4\u308a\u5024\u306f NULL \u3067OK\nfor row in session.query(Pilot_2):\n\tprint(row.id)\n\n#\u30ec\u30b3\u30fc\u30c9\u6295\u5165\n\nname_list  [u'\u7887\u30b2\u30f3\u30c9\u30a6', u'\u51ac\u6708\u30b3\u30a6\u30be\u30a6', u'\u7887\u30b7\u30f3\u30b8', u'\u60e3\u6d41\u30a2\u30b9\u30ab\u30fb\u30e9\u30f3\u30b0\u30ec\u30fc', u'\u7887\u30e6\u30a4']\n\nfor n, name in enumerate(name_list):\n\tsession.add(Pilot_2(id = n+1, name = name))\n\n\nsession.commit()\n\nfor riw in session.query(Pilot_2)\n\tprint(\"id : {row.id}  / name: {row.name}\".format(**vars()))\n```\n\n![pic_18.png](https://qiita-image-store.s3.amazonaws.com/0/43487/9f1025c2-8844-9730-afe0-7eee7ad8eb7c.png)\n![pic_19.png](https://qiita-image-store.s3.amazonaws.com/0/43487/08c64882-1c8d-1990-1cf5-d34f5c83dc8c.png)\n\n#### **\u6570\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u7d5e\u3063\u3066\u5b9f\u884c\u3059\u308b\u3068\u3001\u5b9f\u884c\u6210\u529f\u3059\u308b**\n\n```{Python:Python 2.7}\nfor row in session.query(Pilot_2):\n    print(\"id : {row.id}\".format(**vars()))\n```\n\n![pic_20.png](https://qiita-image-store.s3.amazonaws.com/0/43487/ee5c14e8-010d-6afe-3739-a74cba3e234b.png)\n\n#### **\u65e5\u672c\u8a9e\u6587\u5b57\u5217\u3092\u6271\u3046\u3068\u3001\u5931\u6557\u3059\u308b \uff5e\u3084\u306f\u308a\u3001\u6587\u5b57\u30b3\u30fc\u30c9\u307e\u308f\u308a\u304b**\n\n```{Python:Python 2.7}\nfor row in session.query(Pilot_2):\n    print(\"name : {row.name}\".format(**vars()))\n```\n\n![pic_21.png](https://qiita-image-store.s3.amazonaws.com/0/43487/33d6b04f-e6bf-163a-18e6-f994c643c146.png)\n\n#### **\u6587\u5b57\u5217\u3092 __unicode('utf-8')__ \u3067\u30e6\u30cb\u30b3\u30fc\u30c9\u5909\u63db\u3057\u3066\u3082\u3001\u5931\u6557**\n\n```{Python:Python 2.7}\nfor row in session.query(Pilot_2):\n    print(\"name : {row.name}\".format(**vars()).unicode('utf-8'))\n```\n\n![pic_22.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e39754cb-b103-5900-abfb-6ae5a5ee25f7.png)\n", "tags": ["Python", "sqlalchemy", "\u52d5\u7684SQL", "PostgreSQL", "DB"]}