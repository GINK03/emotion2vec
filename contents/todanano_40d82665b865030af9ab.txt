{"context": " More than 1 year has passed since last update.\u81ea\u5206\u7528\u30e1\u30e2\u3002\n\na.cpp\n\n#include <stdio.h>\n\n#include <boost/property_tree/ptree.hpp>\n#include <boost/property_tree/xml_parser.hpp>\n\n#include <sstream>\n#include <string>\n\nconst static std::string XML = \"\\\n<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\\n<soapenv:Envelope xmlns:soapenc=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\" xmlns:soapenv=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\">\\\n    <soapenv:Body>\\\n        <RetrievePropertiesResponse xmlns=\\\"urn:vim25\\\">\\\n            <returnval>\\\n                <obj type=\\\"Datacenter\\\">datacenter-2</obj>\\\n                <propSet>\\\n                    <name>hostFolder</name>\\\n                    <val type=\\\"Folder\\\" xsi:type=\\\"ManagedObjectReference\\\">group-h4</val>\\\n                </propSet>\\\n                <propSet>\\\n                    <name>name</name>\\\n                    <val xsi:type=\\\"xsd:string\\\">vDatacenter</val>\\\n                </propSet>\\\n            </returnval>\\\n            <returnval>\\\n                <obj type=\\\"Datacenter\\\">datacenter-968</obj>\\\n                <propSet>\\\n                    <name>hostFolder</name>\\\n                    <val type=\\\"Folder\\\" xsi:type=\\\"ManagedObjectReference\\\">group-h970</val>\\\n                </propSet>\\\n                <propSet>\\\n                    <name>name</name>\\\n                    <val xsi:type=\\\"xsd:string\\\">\u65b0\u898f\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc</val>\\\n                </propSet>\\\n            </returnval>\\\n        </RetrievePropertiesResponse>\\\n    </soapenv:Body>\\\n</soapenv:Envelope>\\\n\";\n\nint main( int , char ** ) {\n\n    boost::property_tree::ptree pt;\n    std::stringstream ss( XML );\n    boost::property_tree::read_xml( ss, pt );\n\n    for( auto &it : pt.get_child( \"soapenv:Envelope.soapenv:Body.RetrievePropertiesResponse\" ) ) {\n\n        if( it.first != \"returnval\" ) {\n\n            continue;\n\n        }\n\n        std::string type = it.second.get<std::string>( \"obj.<xmlattr>.type\" );\n        std::string entity = it.second.get<std::string>( \"obj\" );\n\n        printf( \"%s\\t%s\\n\", type.c_str(), entity.c_str() );\n\n        for( auto &itt: it.second ) {\n\n            if( itt.first != \"propSet\" ) {\n\n                continue;\n\n            }\n\n            std::string name = itt.second.get<std::string>( \"name\" );\n            std::string val = itt.second.get<std::string>( \"val\" );\n\n            printf( \"\\t%s\\t%s\\n\", name.c_str(), val.c_str() );\n\n        }\n\n    }\n\n    return( 0 );\n\n}\n\n/*\n[todanano@localhost tmp]$ ./a.out\nDatacenter      datacenter-2\n        hostFolder      group-h4\n        name    vDatacenter\nDatacenter      datacenter-968\n        hostFolder      group-h970\n        name    \u65b0\u898f\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\n[todanano@localhost tmp]$\n*/\n\n\n\n\n\u81ea\u5206\u7528\u30e1\u30e2\u3002\n\n```cpp:a.cpp\n\n#include <stdio.h>\n\n#include <boost/property_tree/ptree.hpp>\n#include <boost/property_tree/xml_parser.hpp>\n\n#include <sstream>\n#include <string>\n\nconst static std::string XML = \"\\\n<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\\n<soapenv:Envelope xmlns:soapenc=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\" xmlns:soapenv=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\" xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\">\\\n\t<soapenv:Body>\\\n\t\t<RetrievePropertiesResponse xmlns=\\\"urn:vim25\\\">\\\n\t\t\t<returnval>\\\n\t\t\t\t<obj type=\\\"Datacenter\\\">datacenter-2</obj>\\\n\t\t\t\t<propSet>\\\n\t\t\t\t\t<name>hostFolder</name>\\\n\t\t\t\t\t<val type=\\\"Folder\\\" xsi:type=\\\"ManagedObjectReference\\\">group-h4</val>\\\n\t\t\t\t</propSet>\\\n\t\t\t\t<propSet>\\\n\t\t\t\t\t<name>name</name>\\\n\t\t\t\t\t<val xsi:type=\\\"xsd:string\\\">vDatacenter</val>\\\n\t\t\t\t</propSet>\\\n\t\t\t</returnval>\\\n\t\t\t<returnval>\\\n\t\t\t\t<obj type=\\\"Datacenter\\\">datacenter-968</obj>\\\n\t\t\t\t<propSet>\\\n\t\t\t\t\t<name>hostFolder</name>\\\n\t\t\t\t\t<val type=\\\"Folder\\\" xsi:type=\\\"ManagedObjectReference\\\">group-h970</val>\\\n\t\t\t\t</propSet>\\\n\t\t\t\t<propSet>\\\n\t\t\t\t\t<name>name</name>\\\n\t\t\t\t\t<val xsi:type=\\\"xsd:string\\\">\u65b0\u898f\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc</val>\\\n\t\t\t\t</propSet>\\\n\t\t\t</returnval>\\\n\t\t</RetrievePropertiesResponse>\\\n\t</soapenv:Body>\\\n</soapenv:Envelope>\\\n\";\n\nint main( int , char ** ) {\n\t\n\tboost::property_tree::ptree pt;\n\tstd::stringstream ss( XML );\n\tboost::property_tree::read_xml( ss, pt );\n\t\n\tfor( auto &it : pt.get_child( \"soapenv:Envelope.soapenv:Body.RetrievePropertiesResponse\" ) ) {\n\t\t\n\t\tif( it.first != \"returnval\" ) {\n\t\t\t\n\t\t\tcontinue;\n\t\t\t\n\t\t}\n\t\t\n\t\tstd::string type = it.second.get<std::string>( \"obj.<xmlattr>.type\" );\n\t\tstd::string entity = it.second.get<std::string>( \"obj\" );\n\t\t\n\t\tprintf( \"%s\\t%s\\n\", type.c_str(), entity.c_str() );\n\t\t\n\t\tfor( auto &itt: it.second ) {\n\t\t\t\n\t\t\tif( itt.first != \"propSet\" ) {\n\t\t\t\t\n\t\t\t\tcontinue;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tstd::string name = itt.second.get<std::string>( \"name\" );\n\t\t\tstd::string val = itt.second.get<std::string>( \"val\" );\n\t\t\t\n\t\t\tprintf( \"\\t%s\\t%s\\n\", name.c_str(), val.c_str() );\n\t\t\t\n\t\t}\n\t\t\n\t}\n\t\n\treturn( 0 );\n\t\n}\n\n/*\n[todanano@localhost tmp]$ ./a.out\nDatacenter      datacenter-2\n        hostFolder      group-h4\n        name    vDatacenter\nDatacenter      datacenter-968\n        hostFolder      group-h970\n        name    \u65b0\u898f\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\n[todanano@localhost tmp]$\n*/\n\n\n```\n\n", "tags": ["C++", "boost"]}