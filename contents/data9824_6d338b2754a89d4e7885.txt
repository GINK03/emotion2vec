{"context": " More than 1 year has passed since last update.PRML\u56f34.6\u3068\u540c\u69d8\u306b\u3001\u30af\u30e9\u30b9\u5e73\u5747\u306e\u5206\u96e2\u3092\u6700\u5927\u5316\u3059\u308b\u3088\u3046\u306a\u5c04\u5f71\u65b9\u5411\u3092\u6c42\u3081\u3001\u56f3\u793a\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30d5\u30a3\u30c3\u30b7\u30e3\u30fc\u306e\u7dda\u5f62\u5224\u5225\u306b\u3088\u308a\u3001\u30af\u30e9\u30b9\u5185\u5206\u6563\u3092\u6700\u5c0f\u5316\u3059\u308b\u3088\u3046\u306a\u5c04\u5f71\u65b9\u5411\u3092\u6c42\u3081\u3001\u56f3\u793a\u3057\u307e\u3059\u3002\u5c04\u5f71\u65b9\u5411w\u3092\u6c42\u3081\u305f\u306e\u307f\u3067\u3042\u308a\u3001\u8b58\u5225\u5883\u754c\u306f\u6c42\u3081\u3066\u3044\u307e\u305b\u3093\u3002\n\nlibrary(MASS)\nframe()\npar(mfrow=c(2, 2))\npar(mar=c(2, 2, 1, 2))\npar(mgp=c(2, 1, 0))\nset.seed(0)\nx <- mvrnorm(40, c(0, 1), matrix(c(2, 1.9, 1.9, 2), 2))\nd1 <- as.data.frame(cbind(x, 1, 1, 0))\nx <- mvrnorm(40, c(4, 0), matrix(c(2, 1.9, 1.9, 2), 2))\nd1 <- rbind(d1, as.data.frame(cbind(x, 2, 0, 1)))\nx <- mvrnorm(10, c(7, -7), matrix(c(.2, 0, 0, .2), 2))\nd2 <- rbind(d1, as.data.frame(cbind(x, 2, 0, 1)))\nnames(d1) <- c(\"x1\", \"x2\", \"class\", \"t1\", \"t2\")\nnames(d2) <- c(\"x1\", \"x2\", \"class\", \"t1\", \"t2\")\n\ndoplot <- function(d, fisher) {\n        xrange <- c(-4, 8)\n        yrange <- c(-8, 4)\n        m1 <- c(mean(d$x1[d$class==1]), mean(d$x2[d$class==1]))\n        m2 <- c(mean(d$x1[d$class==2]), mean(d$x2[d$class==2]))\n        if (fisher) {\n                s1 = cov(cbind(d$x1[d$class==1], d$x2[d$class==1])) * (sum(d$class==1) - 1)\n                s2 = cov(cbind(d$x1[d$class==2], d$x2[d$class==2])) * (sum(d$class==2) - 1)\n                sw = s1 + s2\n        } else {\n                sw = diag(1, 2)\n        }\n        w <- solve(sw) %*% (m2 - m1)\n        print(w)\n        base <- function(x1, x2) {\n                (cbind(x1, x2))\n        }\n        estimate <- function(x1, x2){\n                (t(w) %*% t(base(x1, x2)))\n        }\n        x1 <- seq(-4, 8, .1)\n        x2 <- seq(-8, 4, .1)\n        y <- outer(x1, x2, estimate)\n        plot(d$x1, d$x2, col=d$class, xlim=xrange, ylim=yrange, main=ifelse(fisher, \"Fisher's\", \"max mean diff\"))\n        contour(x1, x2, y, xlim=xrange, ylim=yrange, add=T)\n}\n\ndoplot(d1, F)\ndoplot(d2, F)\ndoplot(d1, T)\ndoplot(d2, T)\n\nPRML\u56f34.6\u3068\u540c\u69d8\u306b\u3001\u30af\u30e9\u30b9\u5e73\u5747\u306e\u5206\u96e2\u3092\u6700\u5927\u5316\u3059\u308b\u3088\u3046\u306a\u5c04\u5f71\u65b9\u5411\u3092\u6c42\u3081\u3001\u56f3\u793a\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30d5\u30a3\u30c3\u30b7\u30e3\u30fc\u306e\u7dda\u5f62\u5224\u5225\u306b\u3088\u308a\u3001\u30af\u30e9\u30b9\u5185\u5206\u6563\u3092\u6700\u5c0f\u5316\u3059\u308b\u3088\u3046\u306a\u5c04\u5f71\u65b9\u5411\u3092\u6c42\u3081\u3001\u56f3\u793a\u3057\u307e\u3059\u3002\u5c04\u5f71\u65b9\u5411w\u3092\u6c42\u3081\u305f\u306e\u307f\u3067\u3042\u308a\u3001\u8b58\u5225\u5883\u754c\u306f\u6c42\u3081\u3066\u3044\u307e\u305b\u3093\u3002\n\n![](https://dl.dropbox.com/sh/cwfemibvr7gk4cy/lbqwJO7fVW/6.FishersLinearDiscriminant.png)\n\n```r\nlibrary(MASS)\nframe()\npar(mfrow=c(2, 2))\npar(mar=c(2, 2, 1, 2))\npar(mgp=c(2, 1, 0))\nset.seed(0)\nx <- mvrnorm(40, c(0, 1), matrix(c(2, 1.9, 1.9, 2), 2))\nd1 <- as.data.frame(cbind(x, 1, 1, 0))\nx <- mvrnorm(40, c(4, 0), matrix(c(2, 1.9, 1.9, 2), 2))\nd1 <- rbind(d1, as.data.frame(cbind(x, 2, 0, 1)))\nx <- mvrnorm(10, c(7, -7), matrix(c(.2, 0, 0, .2), 2))\nd2 <- rbind(d1, as.data.frame(cbind(x, 2, 0, 1)))\nnames(d1) <- c(\"x1\", \"x2\", \"class\", \"t1\", \"t2\")\nnames(d2) <- c(\"x1\", \"x2\", \"class\", \"t1\", \"t2\")\n \ndoplot <- function(d, fisher) {\n        xrange <- c(-4, 8)\n        yrange <- c(-8, 4)\n        m1 <- c(mean(d$x1[d$class==1]), mean(d$x2[d$class==1]))\n        m2 <- c(mean(d$x1[d$class==2]), mean(d$x2[d$class==2]))\n        if (fisher) {\n                s1 = cov(cbind(d$x1[d$class==1], d$x2[d$class==1])) * (sum(d$class==1) - 1)\n                s2 = cov(cbind(d$x1[d$class==2], d$x2[d$class==2])) * (sum(d$class==2) - 1)\n                sw = s1 + s2\n        } else {\n                sw = diag(1, 2)\n        }\n        w <- solve(sw) %*% (m2 - m1)\n        print(w)\n        base <- function(x1, x2) {\n                (cbind(x1, x2))\n        }\n        estimate <- function(x1, x2){\n                (t(w) %*% t(base(x1, x2)))\n        }\n        x1 <- seq(-4, 8, .1)\n        x2 <- seq(-8, 4, .1)\n        y <- outer(x1, x2, estimate)\n        plot(d$x1, d$x2, col=d$class, xlim=xrange, ylim=yrange, main=ifelse(fisher, \"Fisher's\", \"max mean diff\"))\n        contour(x1, x2, y, xlim=xrange, ylim=yrange, add=T)\n}\n \ndoplot(d1, F)\ndoplot(d2, F)\ndoplot(d1, T)\ndoplot(d2, T)\n```\n", "tags": ["R", "PRML"]}