{"context": " More than 1 year has passed since last update.stackoverflow\u306a\u3069\u3092\u898b\u3066\u3044\u308b\u3068CakePHP3\u306e\u753b\u50cf\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u306fCakeManager\u304c\u826f\u3044\u3089\u3057\u3044\u3067\u3059\u306d\u3002\n\u3061\u3087\u3063\u3068\u4f7f\u3063\u3066\u307f\u305f\u306e\u3067\u3059\u304c\u3001installation\u3068Uploadable-Behavior\u3092\u53c2\u8003\u306bmodel\u3068template\u306b\u8a2d\u5b9a\u3059\u308b\u3068\u7c21\u5358\u306b\u753b\u50cf\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u884c\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u753b\u50cf\u306e\u66f4\u65b0(\u7f6e\u304d\u63db\u3048)\u3084\u5143\u3068\u306a\u308b\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3057\u305f\u5834\u5408\u3082\u9023\u52d5\u3057\u3066\u524a\u9664\u3057\u3066\u304f\u308c\u308b\u306a\u3069\u6a5f\u80fd\u7684\u306b\u7533\u3057\u5206\u306a\u3044\u3067\u3059\u3002\n\u3057\u304b\u3057\u3001\u66f4\u65b0\u753b\u9762\u7b49\u3067\u65e2\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6e08\u307f\u306e\u753b\u50cf\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u306a\u304f(\u3064\u307e\u308a\u672a\u6307\u5b9a)\u4ed6\u306e\u30c7\u30fc\u30bf\u3092\u66f4\u65b0\u3057\u305f\u5834\u5408\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u753b\u50cf\u304c\u524a\u9664\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u4ee5\u4e0b\u306f\u305d\u306e\u6642\u306b\u5bfe\u51e6\u3057\u305f\u30e1\u30e2\u3067\u3059\u3002\nmodel\u306e\u8a72\u5f53\u30ab\u30e9\u30e0\u3067removeFileOnUpdate\u3092false\u306b\u3057\u307e\u3059\u3002\n$this->addBehavior('Utils.Uploadable', [\n    'main_image' => [\n        'field' => 'id',\n        'fileName' => '{field}.{extension}',\n        'removeFileOnUpdate' => false, // \u3053\u3053\u3092false\u306b\u3059\u308b\n        'removeFileOnDelete' => true,\n        'fields' => [\n                'directory' => 'main_image_directory',\n                'url' => 'main_image_url',\n                'type' => 'main_image_type',\n                'size' => 'main_image_size',\n                'fileName' => 'main_image_name',\n                'filePath' => 'main_image'\n        ],\n    ],\n]);\n\nmodel\u306b\u5bfe\u5fdc\u3059\u308bcontroller\u306eedit\u30a2\u30af\u30b7\u30e7\u30f3\u3067\u3001\u753b\u50cf\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u3066\u3044\u308b\u304b\u3092\u30b5\u30a4\u30ba\u3067\u5224\u65ad\u3057\u3001\u66f4\u65b0\u3059\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u632f\u308a\u5206\u3051\u307e\u3059\u3002\npublic function edit($id = null)\n{\n    ...\n    if ($this->request->is(['patch', 'post', 'put'])) {\n        // \u753b\u50cf\u306e\u6709\u7121\u306b\u3088\u308a\u66f4\u65b0\u3059\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u5206\u3051\u308b\n        $size = $this->request->data['main_image']['size']; // image\u306e\u30b5\u30a4\u30ba\u3092\u53d6\u5f97\n\n        if($size > 0){\n            // image\u3042\u308a \u5168\u30d5\u30a3\u30fc\u30eb\u30c9\u66f4\u65b0\n            $mymodel = $this->MyModel->patchEntity($mymodel, $this->request->data);\n        }else{\n            // image\u306a\u3057 main_image\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u9664\u5916\n            $mymodel = $this->MyModel->patchEntity($mymodel, $this->request->data, \n                        ['fieldList' => ['title', 'comment', 'published_date', 'modified']\n            ]);\n        }\n        ...\n    }\n    ...\n}\n\ncontroller\u3067\u66f4\u65b0\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u9664\u5916\u3059\u308b\u3060\u3051\u3067\u3046\u307e\u304f\u3044\u304d\u305d\u3046\u306a\u611f\u3058\u3067\u3059\u304c\u3001model\u3067removeFileOnUpdate\u3092false\u306b\u3057\u306a\u3044\u3068\u524a\u9664\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u914d\u5217\u306e\u30e1\u30bd\u30c3\u30c9\u306a\u3069\u3092\u99c6\u4f7f\u3059\u308c\u3070\u3001\u8a72\u5f53\u306e\u753b\u50cf\u30ab\u30e9\u30e0\u3092\u9664\u5916\u3057\u305f\u30ab\u30e9\u30e0\u540d\u914d\u5217\u3092\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u307b\u3069\u8a73\u3057\u304f\u306a\u3044\u306e\u3067\u3053\u3053\u307e\u3067\u3067\u3059\u3002\u3042\u3068\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6e08\u307f\u306e\u753b\u50cf\u306e\u524a\u9664\u306f\u4eca\u5f8c\u8a66\u3059\u4e88\u5b9a\u3067\u3059\u3002\nstackoverflow\u306a\u3069\u3092\u898b\u3066\u3044\u308b\u3068CakePHP3\u306e\u753b\u50cf\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u306f[CakeManager](http://cakemanager.org/)\u304c\u826f\u3044\u3089\u3057\u3044\u3067\u3059\u306d\u3002\n\n\u3061\u3087\u3063\u3068\u4f7f\u3063\u3066\u307f\u305f\u306e\u3067\u3059\u304c\u3001[installation](http://cakemanager.org/docs/utils/1.0/installation/)\u3068[Uploadable-Behavior](http://cakemanager.org/docs/utils/1.0/behaviors/uploadable/)\u3092\u53c2\u8003\u306bmodel\u3068template\u306b\u8a2d\u5b9a\u3059\u308b\u3068\u7c21\u5358\u306b\u753b\u50cf\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u884c\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u753b\u50cf\u306e\u66f4\u65b0(\u7f6e\u304d\u63db\u3048)\u3084\u5143\u3068\u306a\u308b\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3057\u305f\u5834\u5408\u3082\u9023\u52d5\u3057\u3066\u524a\u9664\u3057\u3066\u304f\u308c\u308b\u306a\u3069\u6a5f\u80fd\u7684\u306b\u7533\u3057\u5206\u306a\u3044\u3067\u3059\u3002\n\n\u3057\u304b\u3057\u3001\u66f4\u65b0\u753b\u9762\u7b49\u3067\u65e2\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6e08\u307f\u306e\u753b\u50cf\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u306a\u304f(\u3064\u307e\u308a\u672a\u6307\u5b9a)\u4ed6\u306e\u30c7\u30fc\u30bf\u3092\u66f4\u65b0\u3057\u305f\u5834\u5408\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u753b\u50cf\u304c\u524a\u9664\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u4ee5\u4e0b\u306f\u305d\u306e\u6642\u306b\u5bfe\u51e6\u3057\u305f\u30e1\u30e2\u3067\u3059\u3002\n\nmodel\u306e\u8a72\u5f53\u30ab\u30e9\u30e0\u3067removeFileOnUpdate\u3092false\u306b\u3057\u307e\u3059\u3002\n\n```\n$this->addBehavior('Utils.Uploadable', [\n\t'main_image' => [\n\t\t'field' => 'id',\n\t\t'fileName' => '{field}.{extension}',\n\t\t'removeFileOnUpdate' => false, // \u3053\u3053\u3092false\u306b\u3059\u308b\n\t\t'removeFileOnDelete' => true,\n\t\t'fields' => [\n\t\t\t    'directory' => 'main_image_directory',\n\t\t\t    'url' => 'main_image_url',\n\t\t\t    'type' => 'main_image_type',\n\t\t\t    'size' => 'main_image_size',\n\t\t\t    'fileName' => 'main_image_name',\n\t\t\t    'filePath' => 'main_image'\n\t\t],\n\t],\n]);\n```\n\nmodel\u306b\u5bfe\u5fdc\u3059\u308bcontroller\u306eedit\u30a2\u30af\u30b7\u30e7\u30f3\u3067\u3001\u753b\u50cf\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u3066\u3044\u308b\u304b\u3092\u30b5\u30a4\u30ba\u3067\u5224\u65ad\u3057\u3001\u66f4\u65b0\u3059\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u632f\u308a\u5206\u3051\u307e\u3059\u3002\n\n```\npublic function edit($id = null)\n{\n\t...\n\tif ($this->request->is(['patch', 'post', 'put'])) {\n\t\t// \u753b\u50cf\u306e\u6709\u7121\u306b\u3088\u308a\u66f4\u65b0\u3059\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u5206\u3051\u308b\n\t\t$size = $this->request->data['main_image']['size']; // image\u306e\u30b5\u30a4\u30ba\u3092\u53d6\u5f97\n\n\t\tif($size > 0){\n\t\t\t// image\u3042\u308a \u5168\u30d5\u30a3\u30fc\u30eb\u30c9\u66f4\u65b0\n\t\t\t$mymodel = $this->MyModel->patchEntity($mymodel, $this->request->data);\n\t\t}else{\n\t\t\t// image\u306a\u3057 main_image\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u9664\u5916\n\t\t\t$mymodel = $this->MyModel->patchEntity($mymodel, $this->request->data, \n\t\t\t\t\t\t['fieldList' => ['title', 'comment', 'published_date', 'modified']\n\t\t\t]);\n\t\t}\n\t\t...\n\t}\n\t...\n}\n```\n\ncontroller\u3067\u66f4\u65b0\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u9664\u5916\u3059\u308b\u3060\u3051\u3067\u3046\u307e\u304f\u3044\u304d\u305d\u3046\u306a\u611f\u3058\u3067\u3059\u304c\u3001model\u3067removeFileOnUpdate\u3092false\u306b\u3057\u306a\u3044\u3068\u524a\u9664\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u914d\u5217\u306e\u30e1\u30bd\u30c3\u30c9\u306a\u3069\u3092\u99c6\u4f7f\u3059\u308c\u3070\u3001\u8a72\u5f53\u306e\u753b\u50cf\u30ab\u30e9\u30e0\u3092\u9664\u5916\u3057\u305f\u30ab\u30e9\u30e0\u540d\u914d\u5217\u3092\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u307b\u3069\u8a73\u3057\u304f\u306a\u3044\u306e\u3067\u3053\u3053\u307e\u3067\u3067\u3059\u3002\u3042\u3068\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6e08\u307f\u306e\u753b\u50cf\u306e\u524a\u9664\u306f\u4eca\u5f8c\u8a66\u3059\u4e88\u5b9a\u3067\u3059\u3002\n", "tags": ["CakePHP", "cakephp3"]}