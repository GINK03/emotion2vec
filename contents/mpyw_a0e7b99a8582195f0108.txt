{"context": "\n\n\u8aad\u8005\u5bfe\u8c61\nCakePHP 3.x \u3084 Laravel 5.x \u306b\u79fb\u884c\u3057\u305f\u3044\u3068\u601d\u3044\u3064\u3064\u3082\u306a\u304b\u306a\u304b\u8131\u5374\u3067\u304d\u305a\u306b\u53e4\u4ee3\u306e\u30af\u30bd\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u7528\u3044\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4fdd\u5b88\u3092\u5f37\u8981\u3055\u308c\u3066\u3044\u308b\u54c0\u308c\u306a\u958b\u767a\u8005\n\nCakePHP\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u66f8\u3044\u3066\u3042\u308b\u65b9\u6cd5\n\u30af\u30c3\u30bd\u5197\u9577\u306a\u914d\u5217\u306e\u5b9a\u7fa9\u3092\u8981\u6c42\u3055\u308c\u308b\u3002\u306a\u3093\u3067\u3053\u3053\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u5438\u53ce\u3057\u3066\u304f\u308c\u306a\u3044\u306e\uff1f\n$options['joins'] = array(\n    array('table' => 'books_tags',\n        'alias' => 'BooksTag',\n        'type' => 'inner',\n        'conditions' => array(\n            'Book.id = BooksTag.book_id'\n        )\n    ),\n    array('table' => 'tags',\n        'alias' => 'Tag',\n        'type' => 'inner',\n        'conditions' => array(\n            'BooksTag.tag_id = Tag.id'\n        )\n    )\n);\n\n$options['conditions'] = array(\n    'Tag.tag' => 'Novel'\n);\n\n$books = $Book->find('all', $options);\n\n\n\u4f55\u304c\u30e2\u30c0\u30f3\u3058\u3083\u3053\u306e\u91ce\u90ce\u3002\n\n\u30aa\u30ec\u30aa\u30ec\u5b9f\u88c5\n\u3053\u3093\u306a\u306e\u6bce\u56de\u66f8\u3044\u3066\u3089\u308c\u308b\u308f\u3051\u304c\u306a\u3044\u306e\u3067\uff0c\u5168\u3066\u306e\u30e2\u30c7\u30eb\u306e\u57fa\u5e95\u30af\u30e9\u30b9\u3067\u3042\u308bAppModel\u306b\u62e1\u5f35\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u88c5\u3059\u308b\u3002\n<?php\n\nApp::uses('Model', 'Model');\nApp::uses('Inflector', 'Utility');\n\nclass AppModel extends Model\n{\n    /**\n     * INNER JOIN \u88dc\u52a9\n     *\n     * @author @mpyw\n     * @param  string $targetModelName   JOIN\u3067\u53d6\u3063\u3066\u304f\u308b\u30e2\u30c7\u30eb\n     * @param  array  $conditions        JOIN\u6761\u4ef6\n     * @return array\n     */\n    public function belongsInnerJoin($targetModelName)\n    {\n        $foreignKey = Inflector::underscore($targetModelName) . '_id';\n        return $this->join('INNER', $targetModelName, [\n            \"$this->name.$foreignKey = $targetModelName.id\",\n        ]);\n    }\n    public function hasInnerJoin($targetModelName)\n    {\n        $foreignKey = Inflector::underscore($this->name) . '_id';\n        return $this->join('INNER', $targetModelName, [\n            \"$this->name.id = $targetModelName.$foreignKey\",\n        ]);\n    }\n    public function innerJoin($targetModelName, array $conditions)\n    {\n        return $this->join('INNER', $targetModelName, $conditions);\n    }\n\n    /**\n     * LEFT JOIN \u88dc\u52a9\n     *\n     * @author @mpyw\n     * @param  string $targetModelName   JOIN\u3067\u53d6\u3063\u3066\u304f\u308b\u30e2\u30c7\u30eb\n     * @param  array  $conditions        JOIN\u6761\u4ef6\n     * @return array\n     */\n    public function belongsLeftJoin($targetModelName)\n    {\n        $foreignKey = Inflector::underscore($targetModelName) . '_id';\n        return $this->join('LEFT', $targetModelName, [\n            \"$this->name.$foreignKey = $targetModelName.id\",\n        ]);\n    }\n    public function hasLeftJoin($targetModelName)\n    {\n        $foreignKey = Inflector::underscore($this->name) . '_id';\n        return $this->join('LEFT', $targetModelName, [\n            \"$this->name.id = $targetModelName.$foreignKey\",\n        ]);\n    }\n    public function leftJoin($targetModelName, array $conditions)\n    {\n        return $this->join('LEFT', $targetModelName, $conditions);\n    }\n\n    /**\n     * JOIN \u88dc\u52a9\n     *\n     * @author @mpyw\n     * @param  string $type              JOIN\u306e\u7a2e\u985e\n     * @param  string $targetModelName   JOIN\u3067\u53d6\u3063\u3066\u304f\u308b\u30e2\u30c7\u30eb\n     * @param  array  $conditions        JOIN\u6761\u4ef6\n     * @return array\n     */\n    public function join($type, $targetModelName, array $conditions)\n    {\n        return [\n            'type' => $type,\n            'table' => Inflector::tableize($targetModelName),\n            'alias' => $targetModelName,\n            'conditions' => $conditions,\n        ];\n    }\n}\n\n\u3053\u308c\u3092\u4f7f\u3046\u3068\u3055\u3063\u304d\u306e\u4f8b\u306f\u3053\u306e\u3088\u3046\u306b\u66f8\u3051\u308b\u3002\n$books = $Book->find('all', [\n    'joins' => [\n        $Book->hasInnerJoin('BooksTag'),\n        $Book->belongsInnerJoin('Tag'),\n    ],\n    'conditions' => [\n        'Tag.tag' => 'Novel',\n    ],\n]);\n\n\u3053\u308c\u3067\u3061\u3087\u3063\u3068\u3067\u3082\u4fdd\u5b88\u304c\u697d\u306b\u306a\u308a\u307e\u3059\u3088\u3046\u306b\u2026\n# \u8aad\u8005\u5bfe\u8c61\n\nCakePHP 3.x \u3084 Laravel 5.x \u306b\u79fb\u884c\u3057\u305f\u3044\u3068\u601d\u3044\u3064\u3064\u3082\u306a\u304b\u306a\u304b\u8131\u5374\u3067\u304d\u305a\u306b\u53e4\u4ee3\u306e\u30af\u30bd\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u7528\u3044\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4fdd\u5b88\u3092\u5f37\u8981\u3055\u308c\u3066\u3044\u308b\u54c0\u308c\u306a\u958b\u767a\u8005\n\n# CakePHP\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u66f8\u3044\u3066\u3042\u308b\u65b9\u6cd5\n\n\u30af\u30c3\u30bd\u5197\u9577\u306a\u914d\u5217\u306e\u5b9a\u7fa9\u3092\u8981\u6c42\u3055\u308c\u308b\u3002\u306a\u3093\u3067\u3053\u3053\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u5438\u53ce\u3057\u3066\u304f\u308c\u306a\u3044\u306e\uff1f\n\n```php\n$options['joins'] = array(\n    array('table' => 'books_tags',\n        'alias' => 'BooksTag',\n        'type' => 'inner',\n        'conditions' => array(\n            'Book.id = BooksTag.book_id'\n        )\n    ),\n    array('table' => 'tags',\n        'alias' => 'Tag',\n        'type' => 'inner',\n        'conditions' => array(\n            'BooksTag.tag_id = Tag.id'\n        )\n    )\n);\n\n$options['conditions'] = array(\n    'Tag.tag' => 'Novel'\n);\n\n$books = $Book->find('all', $options);\n```\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-02 16.48.56.png](https://qiita-image-store.s3.amazonaws.com/0/25060/7874a93e-725a-45be-071c-27e92457c87a.png)\n\n\u4f55\u304c\u30e2\u30c0\u30f3\u3058\u3083\u3053\u306e\u91ce\u90ce\u3002\n\n# \u30aa\u30ec\u30aa\u30ec\u5b9f\u88c5\n\n\u3053\u3093\u306a\u306e\u6bce\u56de\u66f8\u3044\u3066\u3089\u308c\u308b\u308f\u3051\u304c\u306a\u3044\u306e\u3067\uff0c\u5168\u3066\u306e\u30e2\u30c7\u30eb\u306e\u57fa\u5e95\u30af\u30e9\u30b9\u3067\u3042\u308b`AppModel`\u306b\u62e1\u5f35\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u88c5\u3059\u308b\u3002\n\n```php\n<?php\n\nApp::uses('Model', 'Model');\nApp::uses('Inflector', 'Utility');\n\nclass AppModel extends Model\n{\n    /**\n     * INNER JOIN \u88dc\u52a9\n     *\n     * @author @mpyw\n     * @param  string $targetModelName   JOIN\u3067\u53d6\u3063\u3066\u304f\u308b\u30e2\u30c7\u30eb\n     * @param  array  $conditions        JOIN\u6761\u4ef6\n     * @return array\n     */\n    public function belongsInnerJoin($targetModelName)\n    {\n        $foreignKey = Inflector::underscore($targetModelName) . '_id';\n        return $this->join('INNER', $targetModelName, [\n            \"$this->name.$foreignKey = $targetModelName.id\",\n        ]);\n    }\n    public function hasInnerJoin($targetModelName)\n    {\n        $foreignKey = Inflector::underscore($this->name) . '_id';\n        return $this->join('INNER', $targetModelName, [\n            \"$this->name.id = $targetModelName.$foreignKey\",\n        ]);\n    }\n    public function innerJoin($targetModelName, array $conditions)\n    {\n        return $this->join('INNER', $targetModelName, $conditions);\n    }\n\n    /**\n     * LEFT JOIN \u88dc\u52a9\n     *\n     * @author @mpyw\n     * @param  string $targetModelName   JOIN\u3067\u53d6\u3063\u3066\u304f\u308b\u30e2\u30c7\u30eb\n     * @param  array  $conditions        JOIN\u6761\u4ef6\n     * @return array\n     */\n    public function belongsLeftJoin($targetModelName)\n    {\n        $foreignKey = Inflector::underscore($targetModelName) . '_id';\n        return $this->join('LEFT', $targetModelName, [\n            \"$this->name.$foreignKey = $targetModelName.id\",\n        ]);\n    }\n    public function hasLeftJoin($targetModelName)\n    {\n        $foreignKey = Inflector::underscore($this->name) . '_id';\n        return $this->join('LEFT', $targetModelName, [\n            \"$this->name.id = $targetModelName.$foreignKey\",\n        ]);\n    }\n    public function leftJoin($targetModelName, array $conditions)\n    {\n        return $this->join('LEFT', $targetModelName, $conditions);\n    }\n\n    /**\n     * JOIN \u88dc\u52a9\n     *\n     * @author @mpyw\n     * @param  string $type              JOIN\u306e\u7a2e\u985e\n     * @param  string $targetModelName   JOIN\u3067\u53d6\u3063\u3066\u304f\u308b\u30e2\u30c7\u30eb\n     * @param  array  $conditions        JOIN\u6761\u4ef6\n     * @return array\n     */\n    public function join($type, $targetModelName, array $conditions)\n    {\n        return [\n            'type' => $type,\n            'table' => Inflector::tableize($targetModelName),\n            'alias' => $targetModelName,\n            'conditions' => $conditions,\n        ];\n    }\n}\n```\n\n\u3053\u308c\u3092\u4f7f\u3046\u3068\u3055\u3063\u304d\u306e\u4f8b\u306f\u3053\u306e\u3088\u3046\u306b\u66f8\u3051\u308b\u3002\n\n```php\n$books = $Book->find('all', [\n    'joins' => [\n        $Book->hasInnerJoin('BooksTag'),\n        $Book->belongsInnerJoin('Tag'),\n    ],\n    'conditions' => [\n        'Tag.tag' => 'Novel',\n    ],\n]);\n```\n\n\u3053\u308c\u3067\u3061\u3087\u3063\u3068\u3067\u3082\u4fdd\u5b88\u304c\u697d\u306b\u306a\u308a\u307e\u3059\u3088\u3046\u306b\u2026\n", "tags": ["CakePHP2", "PHP", "SQL", "ORM"]}