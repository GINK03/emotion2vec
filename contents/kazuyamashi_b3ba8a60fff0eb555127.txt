{"context": "\n\nContents\n\nLinux\u30ab\u30fc\u30cd\u30eb\u306e\u30d3\u30eb\u30c9:Ubuntu\n\u30c7\u30d0\u30a4\u30b9\u30c4\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb(dtb)\u306e\u4f5c\u6210:Ubuntu\nuEnv.txt\u4f5c\u6210:Ubuntu\n\n\n\nLinux\u30ab\u30fc\u30cd\u30eb\u306e\u30d3\u30eb\u30c9:Ubuntu\nLinux\u30ab\u30fc\u30cd\u30eb\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n$ cd ~/work_dir\n$ git clone -b master-next https://github.com/DigilentInc/Linux-Digilent-Dev.git\n$ cd Linux-Digilent-Dev/\n\nZybo\u7528\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u3057\u307e\u3059\u3002\n$ make ARCH=arm CROSS_COMPILE=arm-xilinx-linux-gnueabi- xilinx_zynq_defconfig\n\n\u3053\u3053\u3067\u3001Linux\u30ab\u30fc\u30cd\u30eb\u306bXillybus\u306e\u30c7\u30d0\u30a4\u30b9\u30c9\u30e9\u30a4\u30d0\u3092\u5c0e\u5165\u3059\u308b\u305f\u3081\u306b~/work_dir/Linux-Digilent-Dev/.config\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n# .config\n# 1503\u884c\u76ee\u3042\u305f\u308a\u3002\"xilly\"\u3067\u691c\u7d22\u3057\u3066\u3082\u3044\u3044\u3002\n- # CONFIG_XILLYBUS is not set\n+ CONFIG_XILLYBUS=y\n\n\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\u30d3\u30eb\u30c9\u306b\u306f\u3042\u308b\u7a0b\u5ea6\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n$ make ARCH=arm CROSS_COMPILE=arm-xilinx-linux-gnueabi-\n\n\u30d3\u30eb\u30c9\u3092\u958b\u59cb\u3059\u308b\u3068\u3001\u3044\u304f\u3064\u304b\u8cea\u554f\u3055\u308c\u307e\u3059\u3002y\u3068\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nXillybus over PCIe (XILLYBUS_PCIE) [N/m/y/?] (NEW) y\nXillybus over Device Tree (XILLYBUS_OF) [N/m/y/?] (NEW) y\n\n\u30d3\u30eb\u30c9\u306b\u6210\u529f\u3059\u308b\u3068~/work_dir/Linux-Digilent-Dev/arch/arm/boot/\u306bzImage\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002\nuImage\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ make ARCH=arm CROSS_COMPILE=arm-xilinx-linux-gnueabi- UIMAGE_LOADADDR=0x8000 uImage\n\n\u30d3\u30eb\u30c9\u306b\u6210\u529f\u3059\u308b\u3068~/work_dir/Linux-Digilent-Dev/arch/arm/boot/\u306buImage\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002\nuImage\u3092~/work_dir/\u306b\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n$ cd ~/work_dir/\n$ cp Linux-Digilent-Dev/arch/arm/boot/uImage .\n$ ls\nBOOT.bin  Linux-Digilent-Dev  u-boot-Digilent-Dev  uImage\n\nContents\u306b\u3082\u3069\u308b\n\n\n\u30c7\u30d0\u30a4\u30b9\u30c4\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb(dtb)\u306e\u4f5c\u6210:Ubuntu\ndtb\u306e\u4f5c\u6210\u306b\u4f7f\u7528\u3059\u308bdts\u30d5\u30a1\u30a4\u30eb\u306f/work_dir/Linux-Digilent-Dev/arch/arm/boot/dts/zynq-zybo.dts\u3067\u3059\u3002\n\u3053\u306e\u969b\u3001zynq-zybo.dts\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n~/work_dir\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3057\u3087\u3046\u3002\n$ cd ~/work_dir\n$ cp Linux-Digilent-Dev/arch/arm/boot/dts/zynq-zybo.dts .\n$ ls\nBOOT.bin  Linux-Digilent-Dev  u-boot-Digilent-Dev  uImage  zynq-zybo.dts\n\nzynq-zybo.dts\u306e\u7de8\u96c6\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n/*41\u884c\u76ee\u3042\u305f\u308a*/\n    chosen {\n-       bootargs = \"console=ttyPS0,115200 root=/dev/ram rw earlyprintk\";\n+       bootargs = \"console=ttyPS0,115200 root=/dev/mmcblk0p2 rw earlyprintk rootfstype=ext4 rootwait devtmpfs.mount=1\";\n        linux,stdout-path = \"/amba@0/serial@e0001000\";\n    } ;\n+   xillinux {\n+       board = \"zybo\";\n+       audio = \"ssm2603\";\n+   } ;\n    cpus {\n            #address-cells = <1>;\n            #size-cells = <0>;\n            ps7_cortexa9_0: cpu@0 {\n                bus-handle = <&ps7_axi_interconnect_0>;\n                clock-latency = <1000>;\n                clocks = <&clkc 3>;\n                compatible = \"arm,cortex-a9\";\n                device_type = \"cpu\";\n                interrupt-handle = <&ps7_scugic_0>;\n-               operating-points = <666667 1000000 333334 1000000 222223 1000000>;\n+               operating-points = <650000 1000000>;\n                reg = <0x0>;\n        } ;\n:\n:\n:\n/*329\u884c\u76ee\u3042\u305f\u308a*/\n        ps7_xadc: ps7-xadc@f8007100 {\n            clocks = <&clkc 12>;\n            compatible = \"xlnx,zynq-xadc-1.00.a\";\n            interrupt-parent = <&ps7_scugic_0>;\n            interrupts = <0 7 4>;\n            reg = <0xf8007100 0x20>;\n        } ;\n+       xillyvga@50001000 {\n+           compatible = \"xillybus,xillyvga-1.00.a\";\n+           reg = < 0x50001000 0x1000 >;\n+       } ;\n+       xillybus@50000000 {\n+           compatible = \"xillybus,xillybus-1.00.a\";\n+           reg = < 0x50000000 0x1000 >;\n+           interrupts = < 0 59 1 >;\n+           interrupt-parent = <&ps7_scugic_0>;\n+           dma-coherent;\n+       } ;\n+       xillybus_lite@50002000 {\n+           compatible = \"xillybus,xillybus_lite_of-1.00.a\";\n+           reg = < 0x50002000 0x1000 >;\n+           interrupts = < 0 58 1 >;\n+           interrupt-parent = <&ps7_scugic_0>;\n+       } ;\n    } ;\n} ;\n\n\u7de8\u96c6\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\n$ cd ~/work_dir/Linux-Digilent-Dev\n$ ./scripts/dtc/dtc -I dts -O dtb -o ../devicetree.dtb ../zynq-zybo.dts\n\n\u30d3\u30eb\u30c9\u306b\u6210\u529f\u3059\u308b\u3068~/work_dir\u306bdevicetree.dtb\u304c\u3067\u304d\u3066\u3044\u307e\u3059\u3002\nContents\u306b\u3082\u3069\u308b\n\n\nuEnv.txt\u4f5c\u6210:Ubuntu\nuEnv.txt\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ cd ~/work_dir\n$ cat <<EOT>> uEnv.txt\nuenvcmd=fatload mmc 0 0x03000000 uImage && fatload mmc 0 0x02A00000 devicetree.dtb && bootm 0x03000000 - 0x02A00000\nEOT\n\nContents\u306b\u3082\u3069\u308b\n<a name=\"Contents\"></a>\n##Contents\n\n<!-- MarkdownTOC autolink=\"true\" autoanchor=\"true\" bracket=\"round\" depth=\"3\" -->\n\n- [Linux\u30ab\u30fc\u30cd\u30eb\u306e\u30d3\u30eb\u30c9:Ubuntu](#linux\u30ab\u30fc\u30cd\u30eb\u306e\u30d3\u30eb\u30c9ubuntu)\n- [\u30c7\u30d0\u30a4\u30b9\u30c4\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb\\(dtb\\)\u306e\u4f5c\u6210:Ubuntu](#\u30c7\u30d0\u30a4\u30b9\u30c4\u30ea\u30fc\u30d5\u30a1\u30a4\u30ebdtb\u306e\u4f5c\u6210ubuntu)\n- [uEnv.txt\u4f5c\u6210:Ubuntu](#uenvtxt\u4f5c\u6210ubuntu)\n\n<!-- /MarkdownTOC -->\n\n<a name=\"linux\u30ab\u30fc\u30cd\u30eb\u306e\u30d3\u30eb\u30c9ubuntu\"></a>\n##Linux\u30ab\u30fc\u30cd\u30eb\u306e\u30d3\u30eb\u30c9:Ubuntu\n\nLinux\u30ab\u30fc\u30cd\u30eb\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```\n$ cd ~/work_dir\n$ git clone -b master-next https://github.com/DigilentInc/Linux-Digilent-Dev.git\n$ cd Linux-Digilent-Dev/\n```\n\nZybo\u7528\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u3057\u307e\u3059\u3002\n\n```\n$ make ARCH=arm CROSS_COMPILE=arm-xilinx-linux-gnueabi- xilinx_zynq_defconfig\n```\n\n\u3053\u3053\u3067\u3001Linux\u30ab\u30fc\u30cd\u30eb\u306bXillybus\u306e\u30c7\u30d0\u30a4\u30b9\u30c9\u30e9\u30a4\u30d0\u3092\u5c0e\u5165\u3059\u308b\u305f\u3081\u306b`~/work_dir/Linux-Digilent-Dev/.config`\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n```diff\n# .config\n# 1503\u884c\u76ee\u3042\u305f\u308a\u3002\"xilly\"\u3067\u691c\u7d22\u3057\u3066\u3082\u3044\u3044\u3002\n- # CONFIG_XILLYBUS is not set\n+ CONFIG_XILLYBUS=y\n```\n\n\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\u30d3\u30eb\u30c9\u306b\u306f\u3042\u308b\u7a0b\u5ea6\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\n```\n$ make ARCH=arm CROSS_COMPILE=arm-xilinx-linux-gnueabi-\n```\n\n\u30d3\u30eb\u30c9\u3092\u958b\u59cb\u3059\u308b\u3068\u3001\u3044\u304f\u3064\u304b\u8cea\u554f\u3055\u308c\u307e\u3059\u3002**y**\u3068\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nXillybus over PCIe (XILLYBUS_PCIE) [N/m/y/?] (NEW) y\nXillybus over Device Tree (XILLYBUS_OF) [N/m/y/?] (NEW) y\n```\n\n\u30d3\u30eb\u30c9\u306b\u6210\u529f\u3059\u308b\u3068`~/work_dir/Linux-Digilent-Dev/arch/arm/boot/`\u306b**zImage**\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002\n\nuImage\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n$ make ARCH=arm CROSS_COMPILE=arm-xilinx-linux-gnueabi- UIMAGE_LOADADDR=0x8000 uImage\n```\n\n\u30d3\u30eb\u30c9\u306b\u6210\u529f\u3059\u308b\u3068`~/work_dir/Linux-Digilent-Dev/arch/arm/boot/`\u306b**uImage**\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002  \nuImage\u3092`~/work_dir/`\u306b\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n$ cd ~/work_dir/\n$ cp Linux-Digilent-Dev/arch/arm/boot/uImage .\n$ ls\nBOOT.bin  Linux-Digilent-Dev  u-boot-Digilent-Dev  uImage\n```\n\n\n[Contents\u306b\u3082\u3069\u308b](#Contents)\n\n<a name=\"\u30c7\u30d0\u30a4\u30b9\u30c4\u30ea\u30fc\u30d5\u30a1\u30a4\u30ebdtb\u306e\u4f5c\u6210ubuntu\"></a>\n##\u30c7\u30d0\u30a4\u30b9\u30c4\u30ea\u30fc\u30d5\u30a1\u30a4\u30eb(dtb)\u306e\u4f5c\u6210:Ubuntu\n\ndtb\u306e\u4f5c\u6210\u306b\u4f7f\u7528\u3059\u308bdts\u30d5\u30a1\u30a4\u30eb\u306f`/work_dir/Linux-Digilent-Dev/arch/arm/boot/dts/zynq-zybo.dts`\u3067\u3059\u3002  \n\u3053\u306e\u969b\u3001**zynq-zybo.dts**\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n`~/work_dir`\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3057\u3087\u3046\u3002\n\n```\n$ cd ~/work_dir\n$ cp Linux-Digilent-Dev/arch/arm/boot/dts/zynq-zybo.dts .\n$ ls\nBOOT.bin  Linux-Digilent-Dev  u-boot-Digilent-Dev  uImage  zynq-zybo.dts\n```\n\n**zynq-zybo.dts**\u306e\u7de8\u96c6\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n```diff\n/*41\u884c\u76ee\u3042\u305f\u308a*/\n\tchosen {\n-\t\tbootargs = \"console=ttyPS0,115200 root=/dev/ram rw earlyprintk\";\n+\t\tbootargs = \"console=ttyPS0,115200 root=/dev/mmcblk0p2 rw earlyprintk rootfstype=ext4 rootwait devtmpfs.mount=1\";\n\t\tlinux,stdout-path = \"/amba@0/serial@e0001000\";\n\t} ;\n+\txillinux {\n+\t\tboard = \"zybo\";\n+\t\taudio = \"ssm2603\";\n+\t} ;\n\tcpus {\n\t\t\t#address-cells = <1>;\n\t\t\t#size-cells = <0>;\n\t\t\tps7_cortexa9_0: cpu@0 {\n\t\t\t\tbus-handle = <&ps7_axi_interconnect_0>;\n\t\t\t\tclock-latency = <1000>;\n\t\t\t\tclocks = <&clkc 3>;\n\t\t\t\tcompatible = \"arm,cortex-a9\";\n\t\t\t\tdevice_type = \"cpu\";\n\t\t\t\tinterrupt-handle = <&ps7_scugic_0>;\n-\t\t\t\toperating-points = <666667 1000000 333334 1000000 222223 1000000>;\n+\t\t\t\toperating-points = <650000 1000000>;\n\t\t\t\treg = <0x0>;\n\t\t} ;\n:\n:\n:\n/*329\u884c\u76ee\u3042\u305f\u308a*/\n\t\tps7_xadc: ps7-xadc@f8007100 {\n\t\t\tclocks = <&clkc 12>;\n\t\t\tcompatible = \"xlnx,zynq-xadc-1.00.a\";\n\t\t\tinterrupt-parent = <&ps7_scugic_0>;\n\t\t\tinterrupts = <0 7 4>;\n\t\t\treg = <0xf8007100 0x20>;\n\t\t} ;\n+\t\txillyvga@50001000 {\n+\t\t\tcompatible = \"xillybus,xillyvga-1.00.a\";\n+\t\t\treg = < 0x50001000 0x1000 >;\n+\t\t} ;\n+\t\txillybus@50000000 {\n+\t\t\tcompatible = \"xillybus,xillybus-1.00.a\";\n+\t\t\treg = < 0x50000000 0x1000 >;\n+\t\t\tinterrupts = < 0 59 1 >;\n+\t\t\tinterrupt-parent = <&ps7_scugic_0>;\n+\t\t\tdma-coherent;\n+\t\t} ;\n+\t\txillybus_lite@50002000 {\n+\t\t\tcompatible = \"xillybus,xillybus_lite_of-1.00.a\";\n+\t\t\treg = < 0x50002000 0x1000 >;\n+\t\t\tinterrupts = < 0 58 1 >;\n+\t\t\tinterrupt-parent = <&ps7_scugic_0>;\n+\t\t} ;\n\t} ;\n} ;\n```\n\n\u7de8\u96c6\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\n\n```\n$ cd ~/work_dir/Linux-Digilent-Dev\n$ ./scripts/dtc/dtc -I dts -O dtb -o ../devicetree.dtb ../zynq-zybo.dts\n```\n\n\u30d3\u30eb\u30c9\u306b\u6210\u529f\u3059\u308b\u3068`~/work_dir`\u306b**devicetree.dtb**\u304c\u3067\u304d\u3066\u3044\u307e\u3059\u3002\n\n[Contents\u306b\u3082\u3069\u308b](#Contents)\n\n<a name=\"uenvtxt\u4f5c\u6210ubuntu\"></a>\n##uEnv.txt\u4f5c\u6210:Ubuntu\n\nuEnv.txt\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n$ cd ~/work_dir\n$ cat <<EOT>> uEnv.txt\nuenvcmd=fatload mmc 0 0x03000000 uImage && fatload mmc 0 0x02A00000 devicetree.dtb && bootm 0x03000000 - 0x02A00000\nEOT\n```\n\n[Contents\u306b\u3082\u3069\u308b](#Contents)\n", "tags": ["FPGA", "Linux", "Ubuntu14.04", "zybo", "ROS"]}