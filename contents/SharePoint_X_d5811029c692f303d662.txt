{"context": "Add-PSSnapin Microsoft.SharePoint.PowerShell\n$ErrorActionPreference = \"Stop\"\n\n# \u30ea\u30b9\u30c8\u306e\u5217\u306e\u4e00\u89a7\uff08\u8868\u793a\u540d\u3001\u5185\u90e8\u540d\u3001\u96a0\u3057\u5c5e\u6027\u3001\u30bf\u30a4\u30d7\u8868\u793a\u540d\uff09\u3092\u53d6\u5f97\n# \u5f15\u6570\u306f\u3001\u30b5\u30a4\u30c8URL($WebUrl), \u30ea\u30b9\u30c8\u8868\u793a\u540d($ListDisplayName)\nfunction getListFields( $WebUrl, $ListDisplayName ) {\n    # \u30b5\u30a4\u30c8\u53d6\u5f97\n    $web  = Get-SPWeb $WebUrl\n    Write-Host \"Web : $WebUrl\"\n\n    # \u30ea\u30b9\u30c8\u53d6\u5f97\n    $list = $web.Lists | ?{ $_.title -eq $ListDisplayName }\n    Write-Host \"List : $($list.Title)\"\n\n    # \u5217\u306e\u4e00\u89a7\u3092\u51fa\u529b(\u8868\u793a\u540d\u3001\u5185\u90e8\u540d\u3001\u96a0\u3057\u5c5e\u6027\u3001\u30bf\u30a4\u30d7\u8868\u793a\u540d)\n    $list.Fields | Select Title, InternalName, Hidden, TypeDisplayName\n}\n\n# \u4f7f\u7528\u4f8b -----------------------------------------------------------------\n$webUrl          = \"http://hoge/my\"\n$listDisplayName = \"\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\"\n\n# \u4f8b\uff11\uff09\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\ngetListFields -webUrl $webUrl -listDisplayName $listDisplayName | Format-Table\n\n# \u4f8b\uff12\uff09\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u30d3\u30e5\u30fc\u306b\u51fa\u529b\ngetListFields -webUrl $webUrl -listDisplayName $listDisplayName | Out-GridView\n\n# \u4f8b\uff13\uff09\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\ngetListFields -webUrl $webUrl -listDisplayName $listDisplayName | Export-Csv -Path \"(\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9).csv\" -Encoding UTF8 -NoTypeInformation\n\n\n```\nAdd-PSSnapin Microsoft.SharePoint.PowerShell\n$ErrorActionPreference = \"Stop\"\n\n# \u30ea\u30b9\u30c8\u306e\u5217\u306e\u4e00\u89a7\uff08\u8868\u793a\u540d\u3001\u5185\u90e8\u540d\u3001\u96a0\u3057\u5c5e\u6027\u3001\u30bf\u30a4\u30d7\u8868\u793a\u540d\uff09\u3092\u53d6\u5f97\n# \u5f15\u6570\u306f\u3001\u30b5\u30a4\u30c8URL($WebUrl), \u30ea\u30b9\u30c8\u8868\u793a\u540d($ListDisplayName)\nfunction getListFields( $WebUrl, $ListDisplayName ) {\n    # \u30b5\u30a4\u30c8\u53d6\u5f97\n    $web  = Get-SPWeb $WebUrl\n    Write-Host \"Web : $WebUrl\"\n\n    # \u30ea\u30b9\u30c8\u53d6\u5f97\n    $list = $web.Lists | ?{ $_.title -eq $ListDisplayName }\n    Write-Host \"List : $($list.Title)\"\n\n    # \u5217\u306e\u4e00\u89a7\u3092\u51fa\u529b(\u8868\u793a\u540d\u3001\u5185\u90e8\u540d\u3001\u96a0\u3057\u5c5e\u6027\u3001\u30bf\u30a4\u30d7\u8868\u793a\u540d)\n    $list.Fields | Select Title, InternalName, Hidden, TypeDisplayName\n}\n```\n\n```\n# \u4f7f\u7528\u4f8b -----------------------------------------------------------------\n$webUrl          = \"http://hoge/my\"\n$listDisplayName = \"\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\"\n```\n\n```\n# \u4f8b\uff11\uff09\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\ngetListFields -webUrl $webUrl -listDisplayName $listDisplayName | Format-Table\n```\n\n```\n# \u4f8b\uff12\uff09\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u30d3\u30e5\u30fc\u306b\u51fa\u529b\ngetListFields -webUrl $webUrl -listDisplayName $listDisplayName | Out-GridView\n```\n\n```\n# \u4f8b\uff13\uff09\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\ngetListFields -webUrl $webUrl -listDisplayName $listDisplayName | Export-Csv -Path \"(\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9).csv\" -Encoding UTF8 -NoTypeInformation\n```\n", "tags": ["SharePoint", "PowerShell"]}