{"context": " More than 1 year has passed since last update.USER_EXTENTS \u304b\u3089\u30c6\u30fc\u30d6\u30eb\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30b5\u30a4\u30ba\u3092\u96c6\u8a08\u3059\u308b\u3068\u3068\u3082\u306b\u3001\u30c6\u30fc\u30d6\u30eb\u306e\u5834\u5408\u306f\u4ef6\u6570\u3082\u53d6\u5f97\u3057\u3066\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3057\u307e\u3059\u3002\n\nGetTableSize.ps1\n[void][reflection.assembly]::LoadWithPartialName(\"Oracle.DataAccess\")\n\n$conStr = \"Data Source=XE;User Id=hr;Password=hr\"\n\n$con = New-Object Oracle.DataAccess.Client.OracleConnection($conStr)\n$con.Open()\n\n$sqlStr=\"select segment_name,segment_type,sum(bytes)/1024/1024 as MB \nfrom user_extents \ngroup by segment_name,segment_type\norder by segment_type,segment_name\"\n\n$cmd = New-Object Oracle.DataAccess.Client.OracleCommand($sqlStr, $con)\n$reader = $cmd.ExecuteReader()\n\n$outputDataFormat=\"  {0, -10} {1, -30} {2, 10} {3, 15}\"\nWrite-Host ($outputDataFormat -F \"TYPE\", \"OBJECT_NAME\" ,\"SIZE(MB)\", \"RECORD_COUNT\")\nwhile ( $reader.read() )\n{\n    if ($reader[1] -eq \"TABLE\"){\n        $countSql=(\"select count(*) from {0}\" -F $reader[0])\n        $cmd = New-Object Oracle.DataAccess.Client.OracleCommand($countSql, $con)\n        $countReader = $cmd.ExecuteReader()\n        [void]$countReader.read()\n\n        Write-Host ($outputDataFormat -F $reader[1] ,$reader[0] ,$reader[2], $countReader[0])\n    }else{\n        Write-Host ($outputDataFormat -F $reader[1] ,$reader[0] ,$reader[2], \"\")\n    }\n}\n$con.Close()\n\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n  TYPE       OBJECT_NAME                      SIZE(MB)    RECORD_COUNT\n  INDEX      COUNTRY_C_ID_PK                    0.0625\n  INDEX      DEPT_ID_PK                         0.0625\n  INDEX      DEPT_LOCATION_IX                   0.0625\n  INDEX      EMP_DEPARTMENT_IX                  0.0625\n  INDEX      EMP_EMAIL_UK                       0.0625\n  INDEX      EMP_EMP_ID_PK                      0.0625\n  INDEX      EMP_JOB_IX                         0.0625\n  INDEX      EMP_MANAGER_IX                     0.0625\n  INDEX      EMP_NAME_IX                        0.0625\n  INDEX      JHIST_DEPARTMENT_IX                0.0625\n  INDEX      JHIST_EMPLOYEE_IX                  0.0625\n  INDEX      JHIST_EMP_ID_ST_DATE_PK            0.0625\n  INDEX      JHIST_JOB_IX                       0.0625\n  INDEX      JOB_ID_PK                          0.0625\n  INDEX      LOC_CITY_IX                        0.0625\n  INDEX      LOC_COUNTRY_IX                     0.0625\n  INDEX      LOC_ID_PK                          0.0625\n  INDEX      LOC_STATE_PROVINCE_IX              0.0625\n  INDEX      REG_ID_PK                          0.0625\n  TABLE      DEPARTMENTS                        0.0625              27\n  TABLE      EMPLOYEES                          0.0625             107\n  TABLE      JOBS                               0.0625              19\n  TABLE      JOB_HISTORY                        0.0625              10\n  TABLE      LOCATIONS                          0.0625              23\n  TABLE      REGIONS                            0.0625               4\n\nUSER_EXTENTS \u304b\u3089\u30c6\u30fc\u30d6\u30eb\u3068\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30b5\u30a4\u30ba\u3092\u96c6\u8a08\u3059\u308b\u3068\u3068\u3082\u306b\u3001\u30c6\u30fc\u30d6\u30eb\u306e\u5834\u5408\u306f\u4ef6\u6570\u3082\u53d6\u5f97\u3057\u3066\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3057\u307e\u3059\u3002\n\n```powershell:GetTableSize.ps1\n[void][reflection.assembly]::LoadWithPartialName(\"Oracle.DataAccess\")\n\n$conStr = \"Data Source=XE;User Id=hr;Password=hr\"\n\n$con = New-Object Oracle.DataAccess.Client.OracleConnection($conStr)\n$con.Open()\n\n$sqlStr=\"select segment_name,segment_type,sum(bytes)/1024/1024 as MB \nfrom user_extents \ngroup by segment_name,segment_type\norder by segment_type,segment_name\"\n\n$cmd = New-Object Oracle.DataAccess.Client.OracleCommand($sqlStr, $con)\n$reader = $cmd.ExecuteReader()\n\n$outputDataFormat=\"  {0, -10} {1, -30} {2, 10} {3, 15}\"\nWrite-Host ($outputDataFormat -F \"TYPE\", \"OBJECT_NAME\" ,\"SIZE(MB)\", \"RECORD_COUNT\")\nwhile ( $reader.read() )\n{\n    if ($reader[1] -eq \"TABLE\"){\n        $countSql=(\"select count(*) from {0}\" -F $reader[0])\n        $cmd = New-Object Oracle.DataAccess.Client.OracleCommand($countSql, $con)\n        $countReader = $cmd.ExecuteReader()\n        [void]$countReader.read()\n        \n        Write-Host ($outputDataFormat -F $reader[1] ,$reader[0] ,$reader[2], $countReader[0])\n    }else{\n        Write-Host ($outputDataFormat -F $reader[1] ,$reader[0] ,$reader[2], \"\")\n    }\n}\n$con.Close()\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n```\n  TYPE       OBJECT_NAME                      SIZE(MB)    RECORD_COUNT\n  INDEX      COUNTRY_C_ID_PK                    0.0625\n  INDEX      DEPT_ID_PK                         0.0625\n  INDEX      DEPT_LOCATION_IX                   0.0625\n  INDEX      EMP_DEPARTMENT_IX                  0.0625\n  INDEX      EMP_EMAIL_UK                       0.0625\n  INDEX      EMP_EMP_ID_PK                      0.0625\n  INDEX      EMP_JOB_IX                         0.0625\n  INDEX      EMP_MANAGER_IX                     0.0625\n  INDEX      EMP_NAME_IX                        0.0625\n  INDEX      JHIST_DEPARTMENT_IX                0.0625\n  INDEX      JHIST_EMPLOYEE_IX                  0.0625\n  INDEX      JHIST_EMP_ID_ST_DATE_PK            0.0625\n  INDEX      JHIST_JOB_IX                       0.0625\n  INDEX      JOB_ID_PK                          0.0625\n  INDEX      LOC_CITY_IX                        0.0625\n  INDEX      LOC_COUNTRY_IX                     0.0625\n  INDEX      LOC_ID_PK                          0.0625\n  INDEX      LOC_STATE_PROVINCE_IX              0.0625\n  INDEX      REG_ID_PK                          0.0625\n  TABLE      DEPARTMENTS                        0.0625              27\n  TABLE      EMPLOYEES                          0.0625             107\n  TABLE      JOBS                               0.0625              19\n  TABLE      JOB_HISTORY                        0.0625              10\n  TABLE      LOCATIONS                          0.0625              23\n  TABLE      REGIONS                            0.0625               4\n```", "tags": ["PowerShell", "oracle"]}