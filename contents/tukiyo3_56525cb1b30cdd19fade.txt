{"tags": ["ufw", "Ubuntu", "iptables"], "context": "ufw\u306fiptables\u306e\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u8a2d\u5b9a\u30c4\u30fc\u30eb\u3067\u3059\u3002\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\n\n\n\u30d5\u30a1\u30a4\u30eb\n\u8aac\u660e\n\n\n\n\n/etc/default/ufw\nufw\u306e\u57fa\u672c\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3002ipv6\u6709\u7121,input,output,forward \u306e\u8a2d\u5b9a\n\n\n/lib/ufw/user.rules\nufw\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3057\u305f\u5185\u5bb9\u304c\u3053\u3053\u306b\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\n\n\n\n/etc/ufw/applications.d/\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\u3068\u30dd\u30fc\u30c8\u756a\u53f7\u5b9a\u7fa9\u3002\n\u8907\u6570\u30dd\u30fc\u30c8\u3092\u4f7f\u3046\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3084/etc/services\u306b\u8f09\u3063\u3066\u3044\u306a\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f7f\u3046\u6642\u3001\u3053\u3053\u3067\u5b9a\u7fa9\u3059\u308b\u3068\nufw app list\u3067\u4e00\u89a7\u306b\u8f09\u308b\u3002\n\n\u30b3\u30de\u30f3\u30c9\n\n\u5168\u30a2\u30af\u30bb\u30b9\u7981\u6b62\nufw default deny\nufw allow 22\nufw enable\n\n\n\n\u72b6\u614b\u78ba\u8a8d\nufw status\n\n\n\n\u72b6\u614b\u78ba\u8a8d(\u30ed\u30ae\u30f3\u30b0\u8a2d\u5b9a\u30fb\u521d\u671f\u8a2d\u5b9a\u306e\u8868\u793a)\nufw status verbose\n\n\n\n\u8ffd\u52a0(enable\u306e\u6642\u3001\u5373\u5ea7\u306b\u6709\u52b9\u306b\u306a\u308b)\nufw allow in ssh\n\n\n\n\u8a31\u53ef\u30ea\u30b9\u30c8\u8ffd\u52a0\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\u306f/etc/ufw/applications.d/ \u3068 /etc/services \u306b\u3042\u308b\u3082\u306e\u3067\u767b\u9332\u53ef\u80fd\u3002\n\nufw allow proto tcp from 192.168.11.0/24 to any port 22\nufw allow ssh\nufw allow 80/tcp\nufw allow ftp\nufw allow https\nufw allow from 192.168.11.0/24\nufw allow 5000/tcp\nufw allow 60000:61000/udp\n\n\napplist\nufw app list\nufw allow Samba\nufw allow from 192.168.11.0/24 to any app Samba\n\n\n\n\u8a31\u53ef\u30ea\u30b9\u30c8\u524a\u9664\nufw delete allow 22\n\nufw delete allow from 192.168.11.0/24\n\n# \u3082\u3057\u304f\u306f\u3001\u767b\u9332\u756a\u53f7\u3092\u78ba\u8a8d\u3057\u3066\u524a\u9664\nufw status numbered\nufw delete 1\n\n\n\u30ed\u30b0\nufw logging on\ntail -f /var/log/ufw.log\nufw logging off\n\n\nipv6\u306eufw\u3092\u7121\u52b9\nvim /etc/default/ufw\n- IPV6=yes\n+ IPV6=no\n\n\n\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3092\u518d\u8aad\u8fbc\nufw reload\n\u3082\u3057\u304f\u306f\n/etc/init.d/ufw restart\n\n\ndry-run\nufw --dry-run delete allow 22\nufw --dry-run status\nufw --dry-run disable\n\nufw\u306fiptables\u306e\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u8a2d\u5b9a\u30c4\u30fc\u30eb\u3067\u3059\u3002\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n====\n\n|\u30d5\u30a1\u30a4\u30eb|\u8aac\u660e|\n|:--|:--|\n| /etc/default/ufw | ufw\u306e\u57fa\u672c\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3002ipv6\u6709\u7121,input,output,forward \u306e\u8a2d\u5b9a |\n| /lib/ufw/user.rules | ufw\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3057\u305f\u5185\u5bb9\u304c\u3053\u3053\u306b\u4fdd\u5b58\u3055\u308c\u308b\u3002 |\n\n/etc/ufw/applications.d/\n----\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\u3068\u30dd\u30fc\u30c8\u756a\u53f7\u5b9a\u7fa9\u3002\n\u8907\u6570\u30dd\u30fc\u30c8\u3092\u4f7f\u3046\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3084/etc/services\u306b\u8f09\u3063\u3066\u3044\u306a\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f7f\u3046\u6642\u3001\u3053\u3053\u3067\u5b9a\u7fa9\u3059\u308b\u3068\n`ufw app list`\u3067\u4e00\u89a7\u306b\u8f09\u308b\u3002\n\n\n\u30b3\u30de\u30f3\u30c9\n====\n\n```bash:\u5168\u30a2\u30af\u30bb\u30b9\u7981\u6b62\nufw default deny\nufw allow 22\nufw enable\n```\n\n```bash:\u72b6\u614b\u78ba\u8a8d\nufw status\n```\n\n```bash:\u72b6\u614b\u78ba\u8a8d(\u30ed\u30ae\u30f3\u30b0\u8a2d\u5b9a\u30fb\u521d\u671f\u8a2d\u5b9a\u306e\u8868\u793a)\nufw status verbose\n```\n\n```bash:\u8ffd\u52a0(enable\u306e\u6642\u3001\u5373\u5ea7\u306b\u6709\u52b9\u306b\u306a\u308b)\nufw allow in ssh\n```\n\n\u8a31\u53ef\u30ea\u30b9\u30c8\u8ffd\u52a0\n----\n\n* \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\u306f`/etc/ufw/applications.d/` \u3068 `/etc/services` \u306b\u3042\u308b\u3082\u306e\u3067\u767b\u9332\u53ef\u80fd\u3002\n\n```bash:\nufw allow proto tcp from 192.168.11.0/24 to any port 22\nufw allow ssh\nufw allow 80/tcp\nufw allow ftp\nufw allow https\nufw allow from 192.168.11.0/24\nufw allow 5000/tcp\nufw allow 60000:61000/udp\n```\n\n```bash:applist\nufw app list\nufw allow Samba\nufw allow from 192.168.11.0/24 to any app Samba\n```\n\n\u8a31\u53ef\u30ea\u30b9\u30c8\u524a\u9664\n----\n\n```bash:\nufw delete allow 22\n\nufw delete allow from 192.168.11.0/24\n\n# \u3082\u3057\u304f\u306f\u3001\u767b\u9332\u756a\u53f7\u3092\u78ba\u8a8d\u3057\u3066\u524a\u9664\nufw status numbered\nufw delete 1\n```\n\n\u30ed\u30b0\n====\n\n```bash:\nufw logging on\ntail -f /var/log/ufw.log\nufw logging off\n```\n\nipv6\u306eufw\u3092\u7121\u52b9\n====\n\n```diff:\nvim /etc/default/ufw\n- IPV6=yes\n+ IPV6=no\n```\n\n\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3092\u518d\u8aad\u8fbc\n====\n\n```bash:\nufw reload\n\u3082\u3057\u304f\u306f\n/etc/init.d/ufw restart\n```\n\ndry-run\n====\n\n```bash:\nufw --dry-run delete allow 22\nufw --dry-run status\nufw --dry-run disable\n```\n"}