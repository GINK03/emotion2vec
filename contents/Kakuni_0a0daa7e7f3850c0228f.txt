{"tags": ["Redis2.6.12"], "context": " More than 1 year has passed since last update.\n\nRedis\u306esrandmember\u306e\u30d0\u30e9\u3064\u304d\u304c\u304a\u304b\u3057\u3044\n\n\u73fe\u8c61\nRedis\u306e\u30bb\u30c3\u30c8\u578b\u306e\u95a2\u6570\u306bsrandmember\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u306e\u95a2\u6570\u306e\u30d0\u30e9\u3064\u304d\u578b\u304c\u304a\u304b\u3057\u3044\u4e8b\u306b\u6c17\u4ed8\u3044\u305f\u306e\u3067\u3001\u5099\u5fd8\u9332\u4ee3\u308f\u308a\u306b\u3002\n\n\u3069\u3046\u3044\u3046\u6642\u306b\u304a\u304b\u3057\u304f\u306a\u308b\u306e\u304b\n\n\u30ad\u30fc\u304c\u6570\u5024\u306e\u5834\u5408\u306b\u306f\u554f\u984c\u304c\u7121\u3044\u3002\n\u30ad\u30fc\u304c\u6587\u5b57\u5217\u306b\u78ba\u7387\u304c\u304a\u304b\u3057\u304f\u306a\u308b\u3002\n\u30ad\u30fc\u304c\u6587\u5b57\u5217\u3067\u3082\u78ba\u7387\u304c\u304a\u304b\u3057\u304f\u306a\u3089\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u3002\n\u6587\u5b57\u5217\u306e\u3068\u304d\u306e\u6761\u4ef6\u306f\u308f\u304b\u3089\u306a\u3044\u3002(\u305d\u3053\u307e\u3067\u8abf\u3079\u308b\u6c17\u3082\u3042\u307e\u308a\u306a\u3044\n\u30ad\u30fc\u306f\u6570\u5024\u3092\u4f7f\u3063\u305f\u65b9\u304c\u3044\u3044\u3088\n\n\n\u518d\u73fe\u30b3\u30fc\u30c9\n\nsample.pl\n#!/usr/bin/env perl\nuse 5.16.2;\nuse strict;\nuse warnings;\nuse utf8;\n\nuse Redis::Fast;\n\nmy $redis = Redis::Fast->new;\n\nmy $elements_count = 5;\nmy $try_count = 1000;\nmy $result;\n\n$redis->del(\"test\");\n$result = {};\n\nsay \"### \u8981\u7d20\u6570 $elements_count \u6570\u5024\u306e\u5834\u5408\";\nsay \"|\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387|\";\nsay \"| ---- | ---- | ---- |\";\n$redis->sadd(\"test\" , $_) for 1..$elements_count;\n$result->{$redis->srandmember(\"test\")}++ for 1..$try_count;\nfor(1..$elements_count){\n    say \"|\" . (join \" | \" , sprintf(\"%-4s\", $_) , sprintf(\"%-3s\" , $result->{$_}) , (100 * $result->{$_} / $try_count) . \"%\") . \"|\";\n}\n\n$redis->del(\"test\");\n$result = {};\n\nsay \"\";\nsay \"### \u8981\u7d20\u6570 $elements_count \u6587\u5b57\u5217\u306e\u5834\u5408\";\nsay \"\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387\";\n$redis->sadd(\"test\" , \"test$_\") for 1..$elements_count;\n$result->{$redis->srandmember(\"test\")}++ for 1..$try_count;\nfor(1..$elements_count){\n    say \"|\" . (join \" | \" , sprintf(\"%-8s\", \"test$_\") , sprintf(\"%-3s\" , $result->{\"test$_\"}) , (100 * $result->{\"test$_\"} / $try_count) . \"%\") . \"|\";\n}\n\n\n\n\n\u7d50\u679c\n\n\u8981\u7d20\u65705\u500b,\u8a66\u884c\u56de\u6570\u306f1000\u56de\u306e\u6642\u3001\u6587\u5b57\u5217\u306e\u5834\u5408\u306e\u53d6\u5f97\u78ba\u7387\u304c\u5747\u7b49\u306b\u306a\u3063\u3066\u3044\u306a\u3044\n\u8981\u7d20\u657010\u500b,\u8a66\u884c\u56de\u6570\u306f1000\u56de\u306e\u6642\u3001\u6587\u5b57\u5217\u306e\u53d6\u5f97\u304c\u5747\u7b49\u306b\u306a\u3063\u3066\u3044\u308b\n\u8981\u7d20\u657020\u500b,\u8a66\u884c\u56de\u657010\u4e07\u56de\u306e\u6642\u3001\u5747\u7b49\u306b\u306a\u3063\u3066\u3044\u306a\u3044\n\n\n\u8981\u7d20\u6570 5 \u6570\u5024\u306e\u5834\u5408\n\n\n\n\u30ad\u30fc\u540d\n\u53d6\u5f97\u6570\n\u78ba\u7387\n\n\n\n\n1\n195\n19.5%\n\n\n2\n209\n20.9%\n\n\n3\n209\n20.9%\n\n\n4\n195\n19.5%\n\n\n5\n192\n19.2%\n\n\n\n\n\u8981\u7d20\u6570 5 \u6587\u5b57\u5217\u306e\u5834\u5408\n\n\n\n\u30ad\u30fc\u540d\n\u53d6\u5f97\u6570\n\u78ba\u7387\n\n\n\n\ntest1\n125\n12.5%\n\n\ntest2\n128\n12.8%\n\n\ntest3\n249\n24.9%\n\n\ntest4\n231\n23.1%\n\n\ntest5\n267\n26.7%\n\n\n\n\n\u8981\u7d20\u6570 10 \u6570\u5024\u306e\u5834\u5408\n\n\n\n\u30ad\u30fc\u540d\n\u53d6\u5f97\u6570\n\u78ba\u7387\n\n\n\n\n1\n107\n10.7%\n\n\n2\n91\n9.1%\n\n\n3\n103\n10.3%\n\n\n4\n82\n8.2%\n\n\n5\n103\n10.3%\n\n\n6\n93\n9.3%\n\n\n7\n103\n10.3%\n\n\n8\n127\n12.7%\n\n\n9\n94\n9.4%\n\n\n10\n97\n9.7%\n\n\n\n\n\u8981\u7d20\u6570 10 \u6587\u5b57\u5217\u306e\u5834\u5408\n\n\n\n\u30ad\u30fc\u540d\n\u53d6\u5f97\u6570\n\u78ba\u7387\n\n\n\n\ntest1\n106\n10.6%\n\n\ntest2\n103\n10.3%\n\n\ntest3\n107\n10.7%\n\n\ntest4\n96\n9.6%\n\n\ntest5\n89\n8.9%\n\n\ntest6\n99\n9.9%\n\n\ntest7\n103\n10.3%\n\n\ntest8\n78\n7.8%\n\n\ntest9\n95\n9.5%\n\n\ntest10\n124\n12.4%\n\n\n\n\n\u8981\u7d20\u6570 20 \u6570\u5024\u306e\u5834\u5408\n\n\n\n\u30ad\u30fc\u540d\n\u53d6\u5f97\u6570\n\u78ba\u7387\n\n\n\n\n1\n5035\n5.035%\n\n\n2\n5051\n5.051%\n\n\n3\n5050\n5.05%\n\n\n4\n4951\n4.951%\n\n\n5\n5148\n5.148%\n\n\n6\n5082\n5.082%\n\n\n7\n5073\n5.073%\n\n\n8\n5022\n5.022%\n\n\n9\n4922\n4.922%\n\n\n10\n4983\n4.983%\n\n\n11\n4870\n4.87%\n\n\n12\n4929\n4.929%\n\n\n13\n4897\n4.897%\n\n\n14\n4924\n4.924%\n\n\n15\n4993\n4.993%\n\n\n16\n4951\n4.951%\n\n\n17\n5056\n5.056%\n\n\n18\n5024\n5.024%\n\n\n19\n4965\n4.965%\n\n\n20\n5074\n5.074%\n\n\n\n\n\u8981\u7d20\u6570 20 \u6587\u5b57\u5217\u306e\u5834\u5408\n\n\n\n\u30ad\u30fc\u540d\n\u53d6\u5f97\u6570\n\u78ba\u7387\n\n\n\n\ntest1\n6699\n6.699%\n\n\ntest2\n6560\n6.56%\n\n\ntest3\n3384\n3.384%\n\n\ntest4\n3383\n3.383%\n\n\ntest5\n6593\n6.593%\n\n\ntest6\n6684\n6.684%\n\n\ntest7\n6565\n6.565%\n\n\ntest8\n3331\n3.331%\n\n\ntest9\n6644\n6.644%\n\n\ntest10\n6785\n6.785%\n\n\ntest11\n2255\n2.255%\n\n\ntest12\n3359\n3.359%\n\n\ntest13\n6690\n6.69%\n\n\ntest14\n6740\n6.74%\n\n\ntest15\n3380\n3.38%\n\n\ntest16\n2193\n2.193%\n\n\ntest17\n6681\n6.681%\n\n\ntest18\n6640\n6.64%\n\n\ntest19\n3232\n3.232%\n\n\ntest20\n2202\n2.202%\n\n\n\n# Redis\u306esrandmember\u306e\u30d0\u30e9\u3064\u304d\u304c\u304a\u304b\u3057\u3044\n\n## \u73fe\u8c61\nRedis\u306e\u30bb\u30c3\u30c8\u578b\u306e\u95a2\u6570\u306bsrandmember\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u306e\u95a2\u6570\u306e\u30d0\u30e9\u3064\u304d\u578b\u304c\u304a\u304b\u3057\u3044\u4e8b\u306b\u6c17\u4ed8\u3044\u305f\u306e\u3067\u3001\u5099\u5fd8\u9332\u4ee3\u308f\u308a\u306b\u3002\n\n## \u3069\u3046\u3044\u3046\u6642\u306b\u304a\u304b\u3057\u304f\u306a\u308b\u306e\u304b\n* \u30ad\u30fc\u304c\u6570\u5024\u306e\u5834\u5408\u306b\u306f\u554f\u984c\u304c\u7121\u3044\u3002\n* \u30ad\u30fc\u304c\u6587\u5b57\u5217\u306b\u78ba\u7387\u304c\u304a\u304b\u3057\u304f\u306a\u308b\u3002\n* \u30ad\u30fc\u304c\u6587\u5b57\u5217\u3067\u3082\u78ba\u7387\u304c\u304a\u304b\u3057\u304f\u306a\u3089\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u3002\n* \u6587\u5b57\u5217\u306e\u3068\u304d\u306e\u6761\u4ef6\u306f\u308f\u304b\u3089\u306a\u3044\u3002(\u305d\u3053\u307e\u3067\u8abf\u3079\u308b\u6c17\u3082\u3042\u307e\u308a\u306a\u3044\n* \u30ad\u30fc\u306f\u6570\u5024\u3092\u4f7f\u3063\u305f\u65b9\u304c\u3044\u3044\u3088\n\n## \u518d\u73fe\u30b3\u30fc\u30c9\n\n```perl:sample.pl\n#!/usr/bin/env perl\nuse 5.16.2;\nuse strict;\nuse warnings;\nuse utf8;\n\nuse Redis::Fast;\n\nmy $redis = Redis::Fast->new;\n\nmy $elements_count = 5;\nmy $try_count = 1000;\nmy $result;\n\n$redis->del(\"test\");\n$result = {};\n\nsay \"### \u8981\u7d20\u6570 $elements_count \u6570\u5024\u306e\u5834\u5408\";\nsay \"|\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387|\";\nsay \"| ---- | ---- | ---- |\";\n$redis->sadd(\"test\" , $_) for 1..$elements_count;\n$result->{$redis->srandmember(\"test\")}++ for 1..$try_count;\nfor(1..$elements_count){\n    say \"|\" . (join \" | \" , sprintf(\"%-4s\", $_) , sprintf(\"%-3s\" , $result->{$_}) , (100 * $result->{$_} / $try_count) . \"%\") . \"|\";\n}\n\n$redis->del(\"test\");\n$result = {};\n\nsay \"\";\nsay \"### \u8981\u7d20\u6570 $elements_count \u6587\u5b57\u5217\u306e\u5834\u5408\";\nsay \"\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387\";\n$redis->sadd(\"test\" , \"test$_\") for 1..$elements_count;\n$result->{$redis->srandmember(\"test\")}++ for 1..$try_count;\nfor(1..$elements_count){\n    say \"|\" . (join \" | \" , sprintf(\"%-8s\", \"test$_\") , sprintf(\"%-3s\" , $result->{\"test$_\"}) , (100 * $result->{\"test$_\"} / $try_count) . \"%\") . \"|\";\n}\n\n```\n\n## \u7d50\u679c\n* \u8981\u7d20\u65705\u500b,\u8a66\u884c\u56de\u6570\u306f1000\u56de\u306e\u6642\u3001\u6587\u5b57\u5217\u306e\u5834\u5408\u306e\u53d6\u5f97\u78ba\u7387\u304c\u5747\u7b49\u306b\u306a\u3063\u3066\u3044\u306a\u3044\n* \u8981\u7d20\u657010\u500b,\u8a66\u884c\u56de\u6570\u306f1000\u56de\u306e\u6642\u3001\u6587\u5b57\u5217\u306e\u53d6\u5f97\u304c\u5747\u7b49\u306b\u306a\u3063\u3066\u3044\u308b\n* \u8981\u7d20\u657020\u500b,\u8a66\u884c\u56de\u657010\u4e07\u56de\u306e\u6642\u3001\u5747\u7b49\u306b\u306a\u3063\u3066\u3044\u306a\u3044\n\n### \u8981\u7d20\u6570 5 \u6570\u5024\u306e\u5834\u5408\n|\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387|\n| ---- | ---- | ---- |\n|1    | 195 | 19.5%|\n|2    | 209 | 20.9%|\n|3    | 209 | 20.9%|\n|4    | 195 | 19.5%|\n|5    | 192 | 19.2%|\n\n### \u8981\u7d20\u6570 5 \u6587\u5b57\u5217\u306e\u5834\u5408\n|\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387|\n| ---- | ---- | ---- |\n|test1    | 125 | 12.5%|\n|test2    | 128 | 12.8%|\n|test3    | 249 | 24.9%|\n|test4    | 231 | 23.1%|\n|test5    | 267 | 26.7%|\n\n### \u8981\u7d20\u6570 10 \u6570\u5024\u306e\u5834\u5408\n|\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387|\n| ---- | ---- | ---- |\n|1    | 107 | 10.7%|\n|2    | 91  | 9.1%|\n|3    | 103 | 10.3%|\n|4    | 82  | 8.2%|\n|5    | 103 | 10.3%|\n|6    | 93  | 9.3%|\n|7    | 103 | 10.3%|\n|8    | 127 | 12.7%|\n|9    | 94  | 9.4%|\n|10   | 97  | 9.7%|\n\n### \u8981\u7d20\u6570 10 \u6587\u5b57\u5217\u306e\u5834\u5408\n|\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387|\n| ---- | ---- | ---- |\n|test1    | 106 | 10.6%|\n|test2    | 103 | 10.3%|\n|test3    | 107 | 10.7%|\n|test4    | 96  | 9.6%|\n|test5    | 89  | 8.9%|\n|test6    | 99  | 9.9%|\n|test7    | 103 | 10.3%|\n|test8    | 78  | 7.8%|\n|test9    | 95  | 9.5%|\n|test10   | 124 | 12.4%|\n\n### \u8981\u7d20\u6570 20 \u6570\u5024\u306e\u5834\u5408\n|\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387|\n| ---- | ---- | ---- |\n|1    | 5035 | 5.035%|\n|2    | 5051 | 5.051%|\n|3    | 5050 | 5.05%|\n|4    | 4951 | 4.951%|\n|5    | 5148 | 5.148%|\n|6    | 5082 | 5.082%|\n|7    | 5073 | 5.073%|\n|8    | 5022 | 5.022%|\n|9    | 4922 | 4.922%|\n|10   | 4983 | 4.983%|\n|11   | 4870 | 4.87%|\n|12   | 4929 | 4.929%|\n|13   | 4897 | 4.897%|\n|14   | 4924 | 4.924%|\n|15   | 4993 | 4.993%|\n|16   | 4951 | 4.951%|\n|17   | 5056 | 5.056%|\n|18   | 5024 | 5.024%|\n|19   | 4965 | 4.965%|\n|20   | 5074 | 5.074%|\n\n### \u8981\u7d20\u6570 20 \u6587\u5b57\u5217\u306e\u5834\u5408\n|\u30ad\u30fc\u540d|\u53d6\u5f97\u6570|\u78ba\u7387|\n| ---- | ---- | ---- |\n|test1    | 6699 | 6.699%|\n|test2    | 6560 | 6.56%|\n|test3    | 3384 | 3.384%|\n|test4    | 3383 | 3.383%|\n|test5    | 6593 | 6.593%|\n|test6    | 6684 | 6.684%|\n|test7    | 6565 | 6.565%|\n|test8    | 3331 | 3.331%|\n|test9    | 6644 | 6.644%|\n|test10   | 6785 | 6.785%|\n|test11   | 2255 | 2.255%|\n|test12   | 3359 | 3.359%|\n|test13   | 6690 | 6.69%|\n|test14   | 6740 | 6.74%|\n|test15   | 3380 | 3.38%|\n|test16   | 2193 | 2.193%|\n|test17   | 6681 | 6.681%|\n|test18   | 6640 | 6.64%|\n|test19   | 3232 | 3.232%|\n|test20   | 2202 | 2.202%|\n"}