{"context": " More than 1 year has passed since last update.\u8fd1\u3054\u308d\u3001\u793e\u5185\u306e Slack \u3067\u5206\u5831\u304c\u6d41\u884c\u308a\u59cb\u3081\u3066\u3044\u3066\u3001\u305d\u306e\u30d3\u30c3\u30b0\u30a6\u30a7\u30fc\u30d6\u306b\u4e57\u3063\u3066\u307f\u305f\u3093\u3067\u3059\u304c\u4e09\u65e5\u304f\u3089\u3044\u3067\u98fd\u304d\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\u305f\u307e\u306b\u96c6\u4e2d\u529b\u304c\u5207\u308c\u305f\u6642\u3084\u8a70\u307e\u3063\u305f\u6642\u306b\u545f\u304f\u4ee5\u5916\u306f\u300c\u301c\u7740\u624b\u3057\u59cb\u3081\u305f\u300d\u307f\u305f\u3044\u306a\u306e\u304c\u5927\u90e8\u5206\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u3066\u3001org-mode \u3067 TODO \u7ba1\u7406\u3057\u3066\u4f5c\u696d\u6642\u9593\u8a08\u6e2c\u3068\u304b\u3082\u3057\u3066\u3044\u308b\u8eab\u304b\u3089\u3059\u308b\u3068\u4e8c\u5ea6\u624b\u9593\u3067\u9762\u5012\u304f\u3055\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001org-mode \u3067 clock-in \u3057\u305f\u6642\u306b\u52dd\u624b\u306b\u545f\u3044\u3066\u304f\u308c\u308b\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u3057\u307e\u3057\u305f\u3002\n\u3061\u306a\u307f\u306b\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u3057\u3066 https://github.com/saidie/org-minrepo-slack \u306b\u7f6e\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\nSlack \u306b\u6295\u7a3f\u3059\u308b\u95a2\u6570\nEmacs \u7528\u306e Slack \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f\u3044\u304f\u3064\u304b\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u3059\u304c\u3001\u307e\u3068\u3082\u306a\u306e\u3092\u9078\u5b9a\u3057\u305f\u308a Slack \u9023\u643a\u3055\u305b\u305f\u308a\u3068\u304b\u304c\u9762\u5012\u304f\u3055\u304b\u3063\u305f\u306e\u3067\u3001cURL \u3067 Webhook \u3092\u4f7f\u3063\u3066\u9001\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n(defun oms/send-to-slack (url text &optional options)\n  (let ((payload (json-encode (plist-put (or options '()) :text text))))\n    (call-process \"curl\" nil 0 nil \"-X\" \"POST\"\n                  \"-H\" \"Content-Type: application/json\" \"--data\" payload url)))\n\nWebhook URL\u3001\u6295\u7a3f\u5185\u5bb9 (\u3068\u30aa\u30d7\u30b7\u30e7\u30f3) \u3092\u6307\u5b9a\u3059\u308b\u3068 Slack \u306b\u6295\u7a3f\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u30aa\u30d7\u30b7\u30e7\u30f3\u306f Webhook \u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30d7\u30ed\u30d1\u30c6\u30a3\u30fc\u30ea\u30b9\u30c8\u3067\u6e21\u305b\u308b\u306e\u3067\u3001\u4f8b\u3048\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002\n(oms/send-to-slack \"https://hooks.slack.com/services/XXXXXXXXXXXXXXXX\" \"test\u3060\u3088\" '(:channel \"#test\"))\n\n\nclock-in \u3057\u305f\u3089 Slack \u306b\u6295\u7a3f\n\u30bf\u30b9\u30af\u306b clock-in \u3057\u305f\u3089 Slack \u306b\u6295\u7a3f\u3057\u305f\u3044\u308f\u3051\u3067\u3059\u304c\u3001clock-in \u3057\u305f\u3051\u3069\u3084\u3063\u3071\u4ed6\u306e\u30bf\u30b9\u30af\u5148\u306b\u3084\u308d\u3046\u3068\u3057\u305f\u6642\u3084\u64cd\u4f5c\u30df\u30b9\u3057\u305f\u6642\u3068\u304b\u3001\u5373\u5ea7\u306b\u6295\u7a3f\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u306f\u3084\u3084\u4f7f\u3044\u306b\u304f\u3044\u611f\u304c\u3042\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u5bb6\u3067\u3084\u308b\u3088\u3046\u306a (\u30bb\u30f3\u30b7\u30c6\u30a3\u30d6\u306a) \u30bf\u30b9\u30af\u306b clock-in \u3057\u305f\u6642\u306b\u793e\u5185 Slack \u306b\u901a\u77e5\u3055\u308c\u3066\u3057\u307e\u3046\u3068\u3044\u3046\u306e\u3082\u907f\u3051\u305f\u3044\u6240\u3067\u3059\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6a5f\u80fd\u3082\u76db\u308a\u8fbc\u307f\u307e\u3057\u305f\u3002\n\nclock-in \u3057\u3066\u3042\u308b\u7a0b\u5ea6\u7d99\u7d9a\u3057\u3066\u30bf\u30b9\u30af\u3092\u3084\u3063\u3066\u3044\u305f\u3089\u6295\u7a3f\n\u7279\u5b9a\u306e\u30bf\u30b0 (\u30c7\u30d5\u30a9\u30eb\u30c8\u306f @OFFICE) \u306a\u3069\u304c\u3064\u3044\u3066\u3044\u308b\u30bf\u30b9\u30af\u306e\u307f\u6295\u7a3f\n\n\u5b9f\u88c5\u3068\u3057\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n;; clock-in \u304b\u3089\u3053\u306e\u6642\u9593\u7d4c\u904e\u3057\u3066\u3082\u540c\u3058\u30bf\u30b9\u30af\u3092\u3084\u3063\u3066\u3044\u305f\u3089\u6295\u7a3f\u3059\u308b\n(defvar oms/notification-delay \"3 min\")\n\n;; \u6295\u7a3f\u3059\u308b\u30c6\u30ad\u30b9\u30c8\u3092\u8fd4\u3059\u95a2\u6570\n(defvar oms/text-function\n  (lambda () (format \"`%s` \u3092\u59cb\u3081\u305f\" org-clock-heading)))\n\n;; \u901a\u77e5\u3092\u9001\u308b\u3079\u304d\u30bf\u30b9\u30af\u304b\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u95a2\u6570\n(defvar oms/task-select-function\n  (lambda ()\n    (let ((tags (nth 5 (org-heading-components))))\n      (and tags (string-match \":@OFFICE:\" tags)))))\n\n;; \u6295\u7a3f\u3059\u308b\u95a2\u6570\n;; clock-in \u3057\u305f\u6642\u3068\u540c\u3058\u30bf\u30b9\u30af\u3092\u3084\u3063\u3066\u3044\u305f\u6642\u306e\u307f\n(defun oms/send-notification (old-task)\n  (when (and (org-clocking-p)\n             (eq old-task org-clock-current-task))\n    (oms/send-to-slack oms/slack-webhook-url\n                       (funcall oms/text-function)\n                       oms/slack-options)))\n\n;; clock-in \u3057\u305f\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n;; \u901a\u77e5\u3059\u3079\u304d\u30bf\u30b9\u30af\u306e\u5834\u5408\u306f\u6307\u5b9a\u6642\u9593\u5f8c\u306b oms/send-notification \u3092\u547c\u3076\u3088\u3046\u306b\u3059\u308b\n(defun oms/register-notification ()\n  (let ((current-task org-clock-current-task))\n    (when (and (stringp oms/slack-webhook-url)\n               (funcall oms/task-select-function))\n      (message \"will notify to Slack\")\n      (run-at-time oms/notification-delay nil\n                   'oms/send-notification current-task))))\n\n\u3067\u3001\u6700\u5f8c\u306b\u3053\u308c\u3092 hook \u306b\u767b\u9332\u3059\u308c\u3070\u5b8c\u6210\u3067\u3059\u3002\n(add-hook 'org-clock-in-hook 'oms/register-notification)\n\n\n\u7d50\u679c\n\u4f55\u306b\u7740\u624b\u3057\u3066\u3044\u308b\u304b\u3092\u66f8\u304b\u306a\u304f\u3066\u6e08\u3080\u3088\u3046\u306b\u306a\u3063\u3066\u3001\u5206\u5831\u304c\u5927\u5206\u6c17\u697d\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u305d\u3057\u3066\u3001\u545f\u304d\u3084\u5606\u304d\u306b\u5de5\u6570\u3092\u5272\u3051\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3068\u3055\u3002\n\n\n\u3064\u3076\u3084\u304d\n\nclock-out \u3057\u305f\u6642\u306b\u306f\u7279\u306b\u4f55\u3082\u51fa\u3055\u306a\u3044\u3068\u3044\u3046\u30e9\u30a4\u30d5\u30cf\u30c3\u30af\n\u4eca\u5f8c DONE \u306b\u3057\u305f\u3089\u6295\u7a3f\u3059\u308b\u3088\u3046\u306b\u3082\u3057\u305f\u3044\n\n\u8fd1\u3054\u308d\u3001\u793e\u5185\u306e Slack \u3067\u5206\u5831\u304c\u6d41\u884c\u308a\u59cb\u3081\u3066\u3044\u3066\u3001\u305d\u306e\u30d3\u30c3\u30b0\u30a6\u30a7\u30fc\u30d6\u306b\u4e57\u3063\u3066\u307f\u305f\u3093\u3067\u3059\u304c\u4e09\u65e5\u304f\u3089\u3044\u3067\u98fd\u304d\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\u305f\u307e\u306b\u96c6\u4e2d\u529b\u304c\u5207\u308c\u305f\u6642\u3084\u8a70\u307e\u3063\u305f\u6642\u306b\u545f\u304f\u4ee5\u5916\u306f\u300c\u301c\u7740\u624b\u3057\u59cb\u3081\u305f\u300d\u307f\u305f\u3044\u306a\u306e\u304c\u5927\u90e8\u5206\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u3066\u3001org-mode \u3067 TODO \u7ba1\u7406\u3057\u3066\u4f5c\u696d\u6642\u9593\u8a08\u6e2c\u3068\u304b\u3082\u3057\u3066\u3044\u308b\u8eab\u304b\u3089\u3059\u308b\u3068\u4e8c\u5ea6\u624b\u9593\u3067\u9762\u5012\u304f\u3055\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001org-mode \u3067 clock-in \u3057\u305f\u6642\u306b\u52dd\u624b\u306b\u545f\u3044\u3066\u304f\u308c\u308b\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u3057\u307e\u3057\u305f\u3002\n\n\u3061\u306a\u307f\u306b\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u3057\u3066 https://github.com/saidie/org-minrepo-slack \u306b\u7f6e\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\n## Slack \u306b\u6295\u7a3f\u3059\u308b\u95a2\u6570\n\nEmacs \u7528\u306e Slack \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f\u3044\u304f\u3064\u304b\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u3059\u304c\u3001\u307e\u3068\u3082\u306a\u306e\u3092\u9078\u5b9a\u3057\u305f\u308a Slack \u9023\u643a\u3055\u305b\u305f\u308a\u3068\u304b\u304c\u9762\u5012\u304f\u3055\u304b\u3063\u305f\u306e\u3067\u3001cURL \u3067 Webhook \u3092\u4f7f\u3063\u3066\u9001\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n```lisp\n(defun oms/send-to-slack (url text &optional options)\n  (let ((payload (json-encode (plist-put (or options '()) :text text))))\n    (call-process \"curl\" nil 0 nil \"-X\" \"POST\"\n                  \"-H\" \"Content-Type: application/json\" \"--data\" payload url)))\n```\n\nWebhook URL\u3001\u6295\u7a3f\u5185\u5bb9 (\u3068\u30aa\u30d7\u30b7\u30e7\u30f3) \u3092\u6307\u5b9a\u3059\u308b\u3068 Slack \u306b\u6295\u7a3f\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u30aa\u30d7\u30b7\u30e7\u30f3\u306f Webhook \u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30d7\u30ed\u30d1\u30c6\u30a3\u30fc\u30ea\u30b9\u30c8\u3067\u6e21\u305b\u308b\u306e\u3067\u3001\u4f8b\u3048\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002\n\n```lisp\n(oms/send-to-slack \"https://hooks.slack.com/services/XXXXXXXXXXXXXXXX\" \"test\u3060\u3088\" '(:channel \"#test\"))\n```\n\n## clock-in \u3057\u305f\u3089 Slack \u306b\u6295\u7a3f\n\n\u30bf\u30b9\u30af\u306b clock-in \u3057\u305f\u3089 Slack \u306b\u6295\u7a3f\u3057\u305f\u3044\u308f\u3051\u3067\u3059\u304c\u3001clock-in \u3057\u305f\u3051\u3069\u3084\u3063\u3071\u4ed6\u306e\u30bf\u30b9\u30af\u5148\u306b\u3084\u308d\u3046\u3068\u3057\u305f\u6642\u3084\u64cd\u4f5c\u30df\u30b9\u3057\u305f\u6642\u3068\u304b\u3001\u5373\u5ea7\u306b\u6295\u7a3f\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u306f\u3084\u3084\u4f7f\u3044\u306b\u304f\u3044\u611f\u304c\u3042\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u5bb6\u3067\u3084\u308b\u3088\u3046\u306a (\u30bb\u30f3\u30b7\u30c6\u30a3\u30d6\u306a) \u30bf\u30b9\u30af\u306b clock-in \u3057\u305f\u6642\u306b\u793e\u5185 Slack \u306b\u901a\u77e5\u3055\u308c\u3066\u3057\u307e\u3046\u3068\u3044\u3046\u306e\u3082\u907f\u3051\u305f\u3044\u6240\u3067\u3059\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u6a5f\u80fd\u3082\u76db\u308a\u8fbc\u307f\u307e\u3057\u305f\u3002\n\n- clock-in \u3057\u3066\u3042\u308b\u7a0b\u5ea6\u7d99\u7d9a\u3057\u3066\u30bf\u30b9\u30af\u3092\u3084\u3063\u3066\u3044\u305f\u3089\u6295\u7a3f\n- \u7279\u5b9a\u306e\u30bf\u30b0 (\u30c7\u30d5\u30a9\u30eb\u30c8\u306f `@OFFICE`) \u306a\u3069\u304c\u3064\u3044\u3066\u3044\u308b\u30bf\u30b9\u30af\u306e\u307f\u6295\u7a3f\n\n\u5b9f\u88c5\u3068\u3057\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n```lisp\n;; clock-in \u304b\u3089\u3053\u306e\u6642\u9593\u7d4c\u904e\u3057\u3066\u3082\u540c\u3058\u30bf\u30b9\u30af\u3092\u3084\u3063\u3066\u3044\u305f\u3089\u6295\u7a3f\u3059\u308b\n(defvar oms/notification-delay \"3 min\")\n\n;; \u6295\u7a3f\u3059\u308b\u30c6\u30ad\u30b9\u30c8\u3092\u8fd4\u3059\u95a2\u6570\n(defvar oms/text-function\n  (lambda () (format \"`%s` \u3092\u59cb\u3081\u305f\" org-clock-heading)))\n\n;; \u901a\u77e5\u3092\u9001\u308b\u3079\u304d\u30bf\u30b9\u30af\u304b\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u95a2\u6570\n(defvar oms/task-select-function\n  (lambda ()\n    (let ((tags (nth 5 (org-heading-components))))\n      (and tags (string-match \":@OFFICE:\" tags)))))\n\n;; \u6295\u7a3f\u3059\u308b\u95a2\u6570\n;; clock-in \u3057\u305f\u6642\u3068\u540c\u3058\u30bf\u30b9\u30af\u3092\u3084\u3063\u3066\u3044\u305f\u6642\u306e\u307f\n(defun oms/send-notification (old-task)\n  (when (and (org-clocking-p)\n             (eq old-task org-clock-current-task))\n    (oms/send-to-slack oms/slack-webhook-url\n                       (funcall oms/text-function)\n                       oms/slack-options)))\n\n;; clock-in \u3057\u305f\u6642\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n;; \u901a\u77e5\u3059\u3079\u304d\u30bf\u30b9\u30af\u306e\u5834\u5408\u306f\u6307\u5b9a\u6642\u9593\u5f8c\u306b oms/send-notification \u3092\u547c\u3076\u3088\u3046\u306b\u3059\u308b\n(defun oms/register-notification ()\n  (let ((current-task org-clock-current-task))\n    (when (and (stringp oms/slack-webhook-url)\n               (funcall oms/task-select-function))\n      (message \"will notify to Slack\")\n      (run-at-time oms/notification-delay nil\n                   'oms/send-notification current-task))))\n```\n\n\u3067\u3001\u6700\u5f8c\u306b\u3053\u308c\u3092 hook \u306b\u767b\u9332\u3059\u308c\u3070\u5b8c\u6210\u3067\u3059\u3002\n\n```\n(add-hook 'org-clock-in-hook 'oms/register-notification)\n```\n\n## \u7d50\u679c\n\n\u4f55\u306b\u7740\u624b\u3057\u3066\u3044\u308b\u304b\u3092\u66f8\u304b\u306a\u304f\u3066\u6e08\u3080\u3088\u3046\u306b\u306a\u3063\u3066\u3001\u5206\u5831\u304c\u5927\u5206\u6c17\u697d\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u305d\u3057\u3066\u3001\u545f\u304d\u3084\u5606\u304d\u306b\u5de5\u6570\u3092\u5272\u3051\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3068\u3055\u3002\n\n<img width=\"581\" alt=\"org-minrepo-slack.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/42655/585afb9d-28c2-004f-ffa3-51dcd3c6389d.png\">\n\n## \u3064\u3076\u3084\u304d\n\n- clock-out \u3057\u305f\u6642\u306b\u306f\u7279\u306b\u4f55\u3082\u51fa\u3055\u306a\u3044\u3068\u3044\u3046\u30e9\u30a4\u30d5\u30cf\u30c3\u30af\n- \u4eca\u5f8c DONE \u306b\u3057\u305f\u3089\u6295\u7a3f\u3059\u308b\u3088\u3046\u306b\u3082\u3057\u305f\u3044\n", "tags": ["Emacs", "org-mode", "emacs-lisp", "Slack"]}