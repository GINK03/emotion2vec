{"context": "\n\n\u5bfe\u8c61\nPython\u53ca\u3073NumPy\u521d\u5fc3\u8005\u306b\u5411\u3051\u3066\u66f8\u3044\u3066\u3044\u307e\u3059. \u300cC\u8a00\u8a9e\u306f\u4f7f\u3048\u308b\u3051\u3069\u6700\u8fd1Python\u3092\u59cb\u3081\u305f\u300d\u3068\u304b\u300cPython\u3089\u3057\u3044\u66f8\u304d\u65b9\u304c\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u300d\u306b\u8a72\u5f53\u3059\u308b\u7269\u7406\u7cfb\u306e\u6570\u5024\u8a08\u7b97\u3092\u76ee\u7684\u3068\u3057\u305f\u65b9\u306b\u306f\u7279\u306b\u6709\u7528\u304b\u3082\u3057\u308c\u307e\u305b\u3093.\n\u307e\u305f, \u81ea\u5206\u306e\u4e0d\u52c9\u5f37\u306e\u305f\u3081\u306b\u9593\u9055\u3063\u305f\u8a18\u8ff0\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093. \u3054\u5bb9\u8d66\u304f\u3060\u3055\u3044. \n\n\u3042\u3089\u307e\u3057\n\u5185\u5bb9\u306fNumPy\u3092\u7528\u3044\u305f\u6570\u5024\u8a08\u7b97\u306e\u9ad8\u901f\u5316 : \u57fa\u790e\u306e\u3064\u3065\u304d\u3067\u3059. ndarray\u306e\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u95a2\u6570\u3084\u6f14\u7b97\u3092\u7528\u3044\u3066\u53ef\u80fd\u306a\u9650\u308afor\u30eb\u30fc\u30d7\u3092\u4f7f\u308f\u305a\u306b\u57fa\u790e\u7684\u306a\u6570\u5024\u8a08\u7b97\u3092\u5b9f\u88c5\u3057\u3066\u3044\u304d\u307e\u3059. \u4eca\u56de\u304b\u3089SciPy\u3082\u4ef2\u9593\u306b\u52a0\u308f\u308a\u307e\u3059. \u4ee5\u4e0b\u3067\u306fNumPy\u30fbSciPy\u306e\u95a2\u6570\u306e\u8a73\u3057\u3044\u5b9f\u88c5\u306b\u3064\u3044\u3066\u306f\u3042\u307e\u308a\u30b3\u30e1\u30f3\u30c8\u3057\u3066\u3044\u306a\u3044\u306e\u3067, \u308f\u304b\u3089\u306a\u3044\u3053\u3068\u304c\u3042\u3063\u305f\u3089\u662f\u975e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3092\u8aad\u3093\u3067\u307f\u3066\u304f\u3060\u3055\u3044. \u8a00\u308f\u305a\u3082\u304c\u306a, \u8eca\u8f2a\u306e\u518d\u767a\u660e\u3092\u3057\u306a\u3044\u3053\u3068\u304c\u3068\u3063\u3066\u3082\u5927\u4e8b\u3067\u3059.\n\n\u5fae\u5206\n\u7269\u7406\u306e\u57fa\u790e\u65b9\u7a0b\u5f0f\u306b\u306f\u5fae\u5206\u304c\u3064\u304d\u3082\u306e\u3067\u3059. \u5fae\u5206\u306f\u7dda\u5f62\u5199\u50cf\u306a\u306e\u3067\u884c\u5217\u65b9\u7a0b\u5f0f\u3067\u8a18\u8ff0\u3067\u304d\u307e\u3059. \u305f\u3068\u3048\u3070\u3042\u308b\u95a2\u6570\u306e2\u56de\u5fae\u5206\u3092\u8a08\u7b97\u3059\u308b\u3068\u3057\u307e\u3057\u3087\u3046. \u3053\u308c\u3092\u524d\u9032\u5dee\u5206\u3068\u5f8c\u9000\u5dee\u5206\u3092\u7528\u3044\u3066\u8868\u73fe\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059:\n\\frac{d^2}{dx^2}\\psi(x) = \\frac{\\psi(x + \\Delta x) - 2\\psi(x) + \\psi(x - \\Delta x)}{\\Delta x^2} + {\\cal O}(\\Delta x^2)\nd2dx2\u03c8(x)=\u03c8(x+\u0394x)\u22122\u03c8(x)+\u03c8(x\u2212\u0394x)\u0394x2+O(\u0394x2){\\frac{d^2}{dx^2}\\psi(x) = \\frac{\\psi(x + \\Delta x) - 2\\psi(x) + \\psi(x - \\Delta x)}{\\Delta x^2} + {\\cal O}(\\Delta x^2)\n}\n\u03c8(x)\\psi(x)\u3092\u0394x\\Delta x\u3067\u96e2\u6563\u5316\u3057\u3066\u3042\u3052\u308b\u3068\n\\psi(x)\\rightarrow \\{\\psi(x_0), \\psi(x_1), ..., \\psi(x_{n-1}), \\psi(x_n)\\} = \\{\\psi_0, \\psi_1, ..., \\psi_{n-1}, \\psi_n\\}\\hspace{1cm}x_i = -L/2 + i\\Delta x\n\u03c8(x)\u2192{\u03c8(x0),\u03c8(x1),...,\u03c8(xn\u22121),\u03c8(xn)}={\u03c80,\u03c81,...,\u03c8n\u22121,\u03c8n}xi=\u2212L/2+i\u0394x{\\psi(x)\\rightarrow \\{\\psi(x_0), \\psi(x_1), ..., \\psi(x_{n-1}), \\psi(x_n)\\} = \\{\\psi_0, \\psi_1, ..., \\psi_{n-1}, \\psi_n\\}\\hspace{1cm}x_i = -L/2 + i\\Delta x\n}\n\u5fae\u5206\u306f\u884c\u5217\u5f62\u5f0f\u3067\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059:\n\\frac{d^2}{dx^2}\\psi(x) = \\frac{1}{\\Delta x^2}\n\\begin{pmatrix}\n\\psi_{-1} -2\\psi_0 + \\psi_1\\\\\n\\psi_0 -2\\psi_1 + \\psi_2\\\\\n\\vdots\\\\\n\\psi_{n-2} -2\\psi_{n-1} + \\psi_n\\\\\n\\psi_{n-1} -2\\psi_n + \\psi_{n+1}\n\\end{pmatrix}\n\\simeq \\frac{1}{\\Delta x^2}\n\\begin{pmatrix}\n-2&1&0&\\cdots&0\\\\ \n1&-2 &1&&0\\\\\n0 & 1&-2&& \\vdots\\\\\n\\vdots&&&\\ddots&1\\\\\n0& \\cdots& 0 &1& -2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\psi_0\\\\\n\\psi_1\\\\\n\\vdots\\\\\n\\psi_{n-1}\\\\\n\\psi_n\n\\end{pmatrix}\n=K\\psi\nd2dx2\u03c8(x)=1\u0394x2(\u03c8\u22121\u22122\u03c80+\u03c81\u03c80\u22122\u03c81+\u03c82\u22ee\u03c8n\u22122\u22122\u03c8n\u22121+\u03c8n\u03c8n\u22121\u22122\u03c8n+\u03c8n+1)\u22431\u0394x2(\u2212210\u22ef01\u221221001\u22122\u22ee\u22ee\u22f110\u22ef01\u22122)(\u03c80\u03c81\u22ee\u03c8n\u22121\u03c8n)=K\u03c8{\\frac{d^2}{dx^2}\\psi(x) = \\frac{1}{\\Delta x^2}\n\\begin{pmatrix}\n\\psi_{-1} -2\\psi_0 + \\psi_1\\\\\n\\psi_0 -2\\psi_1 + \\psi_2\\\\\n\\vdots\\\\\n\\psi_{n-2} -2\\psi_{n-1} + \\psi_n\\\\\n\\psi_{n-1} -2\\psi_n + \\psi_{n+1}\n\\end{pmatrix}\n\\simeq \\frac{1}{\\Delta x^2}\n\\begin{pmatrix}\n-2&1&0&\\cdots&0\\\\ \n1&-2 &1&&0\\\\\n0 & 1&-2&& \\vdots\\\\\n\\vdots&&&\\ddots&1\\\\\n0& \\cdots& 0 &1& -2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\psi_0\\\\\n\\psi_1\\\\\n\\vdots\\\\\n\\psi_{n-1}\\\\\n\\psi_n\n\\end{pmatrix}\n=K\\psi\n}\n\u306f\u3058\u3063\u3053\u3067\u5acc\u306a\u3053\u3068\u304c\u8d77\u304d\u3066\u3044\u307e\u3059\u304c, \u0394x\\Delta x\u304c\u5c0f\u3055\u3051\u308c\u3070\u5927\u4e08\u592b\u3067\u3059. \u3055\u3042\u884c\u5217\u306b\u3067\u304d\u3066\u3057\u307e\u3048\u3070\u3053\u3063\u3061\u306e\u3082\u306e\u3067\u3059. \n\n\u5b9f\u88c5\nPython\u3067\u5b9f\u88c5\u3057\u3066\u3042\u3052\u307e\u3059. \u521d\u671f\u95a2\u6570\u3092\u9069\u5f53\u306b\u7528\u610f\u3057\u3066\u5dee\u5206\u5316\u3057\u3066\u3042\u3052\u307e\u3059:\n>>> import numpy as np\n>>> def f(x):\n...     return np.exp(-x**2)\n... \n>>> L, N = 7, 100\n>>> x = np.linspace(-L/2, L/2, N)\n>>> psi = f(x)\n>>> psi\narray([  4.78511739e-06,   7.81043424e-06,   1.26216247e-05,\n         2.01935578e-05,   3.19865883e-05,   5.01626530e-05,\n         7.78844169e-05,   1.19723153e-04,   1.82206228e-04,\n         ...,\n         2.74540100e-04,   1.82206228e-04,   1.19723153e-04,\n         7.78844169e-05,   5.01626530e-05,   3.19865883e-05,\n         2.01935578e-05,   1.26216247e-05,   7.81043424e-06,\n         4.78511739e-06])\n\n\u305d\u3057\u3066\u5fae\u5206\u306e\u884c\u5217\u3092\u7528\u610f\u3057\u307e\u3059. \u305d\u306e\u305f\u3081\u306b\u306f\u52a3\u5bfe\u89d2\u6210\u5206\u306b\u5024\u3092\u683c\u7d0d\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093. \u305d\u3053\u3067ndarray\u306e\u30b9\u30e9\u30a4\u30b9\u3068np.vstack\u3092\u7d44\u307f\u5408\u308f\u305b\u307e\u3059:\n>>> K = np.eye(N, N)\n>>> K\narray([[ 1.,  0.,  0., ...,  0.,  0.,  0.],\n       [ 0.,  1.,  0., ...,  0.,  0.,  0.],\n       [ 0.,  0.,  1., ...,  0.,  0.,  0.],\n       ..., \n       [ 0.,  0.,  0., ...,  1.,  0.,  0.],\n       [ 0.,  0.,  0., ...,  0.,  1.,  0.],\n       [ 0.,  0.,  0., ...,  0.,  0.,  1.]])\n>>> K_sub = np.vstack((K[1:], np.array([0] * N)))\n>>> K_sub\narray([[ 0.,  1.,  0., ...,  0.,  0.,  0.],\n       [ 0.,  0.,  1., ...,  0.,  0.,  0.],\n       [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n       ..., \n       [ 0.,  0.,  0., ...,  0.,  1.,  0.],\n       [ 0.,  0.,  0., ...,  0.,  0.,  1.],\n       [ 0.,  0.,  0., ...,  0.,  0.,  0.]])\n>>> K = -2 * K + K_sub + K_sub.T\n>>> K\narray([[-2.,  1.,  0., ...,  0.,  0.,  0.],\n       [ 1., -2.,  1., ...,  0.,  0.,  0.],\n       [ 0.,  1., -2., ...,  0.,  0.,  0.],\n       ..., \n       [ 0.,  0.,  0., ..., -2.,  1.,  0.],\n       [ 0.,  0.,  0., ...,  1., -2.,  1.],\n       [ 0.,  0.,  0., ...,  0.,  1., -2.]])\n\n\u3053\u308c\u3067\u7a4d\u3092\u53d6\u308c\u30702\u968e\u5fae\u5206\u5b8c\u4e86\u3067\u3059:\ndx = L/N\npsi_2dot = dx**-2 * np.dot(K, psi)\n\nfor\u30eb\u30fc\u30d7\u3092\u4f7f\u308f\u305a\u306b\u66f8\u3051\u307e\u3057\u305f. \u3053\u3053\u307e\u3067\u3084\u3063\u3066\u304a\u304d\u306a\u304c\u3089, \u5b9f\u306fgradient\u3068\u3044\u3046\u52fe\u914d\u3092\u8a08\u7b97\u3059\u308b\u95a2\u6570\u304c\u3042\u308a\u307e\u3059:\npsi_dot_np = np.gradient(psi, dx)\npsi_2dot_np = np.gradient(psi_dot_np, dx)\n\n\npsi_2dot\u3068psi_2dot_np\u306f\u307b\u307c\u5b8c\u5168\u306b\u91cd\u306a\u3063\u3066\u3044\u307e\u3059. \u3053\u308c\u3058\u3083\u3042\u5148\u306e\u884c\u5217\u306e\u8a71\u306f\u4f55\u3082\u610f\u5473\u304c\u306a\u3044\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3046\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c, \u5f8c\u306e\u56fa\u6709\u5024\u65b9\u7a0b\u5f0f\u306e\u7ae0\u3067\u518d\u3073\u65e5\u306e\u76ee\u3092\u898b\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059. \n\n\u7a4d\u5206\n\u6570\u5024\u7a4d\u5206\u3067\u6709\u540d\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306fSimpson\u7a4d\u5206\u3067\u3057\u3087\u3046:\n\\int_a^b dx\\; f(x) = \\sum_{i=0}^{n-1}\\frac{h}{6}\\left[f(x_i) + 4f\\left(x_i + \\frac{h}{2}\\right) + f(x_i + h)\\right]\\hspace{1cm}x_i = a + ih\n\u222bbadxf(x)=n\u22121\u2211i=0h6[f(xi)+4f(xi+h2)+f(xi+h)]xi=a+ih{\\int_a^b dx\\; f(x) = \\sum_{i=0}^{n-1}\\frac{h}{6}\\left[f(x_i) + 4f\\left(x_i + \\frac{h}{2}\\right) + f(x_i + h)\\right]\\hspace{1cm}x_i = a + ih\n}\n\u8a3c\u660e\u306f\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u88dc\u5b8c\u3092\u7528\u3044\u308b\u3068\u30b7\u30f3\u30d7\u30eb\u3067\u3059\u304c, \u3053\u3053\u3067\u306f\u7701\u7565\u3057\u307e\u3059. \n\n\u5b9f\u88c5\n\u3053\u308c\u3092\u5b9f\u88c5\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059:\n>>> simp_arr = f(x) + 4 * f(x + dx / 2) + f(x + dx)\n>>> dx / 6 * np.sum(simp_arr)\n1.75472827313\n\n\u5f0f\u3092\u305d\u306e\u307e\u307e\u30b3\u30fc\u30c9\u306b\u843d\u3068\u3057\u8fbc\u3093\u3060\u3088\u3046\u306a\u30b7\u30f3\u30d7\u30eb\u3055\u304c\u3044\u3044\u3067\u3059\u306d. \u3057\u304b\u3057\u306a\u304c\u3089, Simpson\u7a4d\u5206\u306fSciPy\u306e\u95a2\u6570\u3068\u3057\u3066\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059:\n>>> from scipy.integrate import simps\n>>> simps(psi, x)\n1.7724525416390826\n\n\u8a08\u7b97\u7d50\u679c\u304c\u5fae\u5999\u306b\u7570\u306a\u308b\u306e\u306f, SciPy\u306e\u65b9\u304c\u7cbe\u5ea6\u306e\u826f\u3044Simpson\u5247\u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u304b\u3089\u3067\u3057\u3087\u3046. \u7279\u306b\u7406\u7531\u304c\u306a\u3044\u9650\u308a\u81ea\u5206\u3067\u7d44\u3080\u3088\u308a\u3053\u3061\u3089\u3092\u4f7f\u3046\u307b\u3046\u304c\u3044\u3044\u3067\u3059\u306d. \u3055\u3089\u306b, \u5dee\u5206\u5316\u3059\u308b\u524d\u306e\u95a2\u6570\u3092\u6e21\u3057\u3066\u7a4d\u5206\u3059\u308b\u95a2\u6570\u3082\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059:\n>>> from scipy.integrate import quad\n>>> quad(f, -np.inf, np.inf)\n(1.7724538509055159, 1.4202636780944923e-08)\n\n\u95a2\u6570\u3068\u7a4d\u5206\u533a\u9593\u3092\u4e0e\u3048\u3066\u3042\u3052\u308c\u3070\u8a08\u7b97\u304c\u3067\u304d\u307e\u3059. \u623b\u308a\u5024\u306ftuple\u3067, \u7b2c\u4e00\u6210\u5206\u304c\u7a4d\u5206\u7d50\u679c, \u7b2c\u4e8c\u6210\u5206\u304c\u7d76\u5bfe\u8aa4\u5dee\u3067\u3059. quad\u306fFortran\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3042\u308bQUADPACK\u306b\u3042\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u4f7f\u3063\u3066\u3044\u308b1\u3088\u3046\u3067\u3059. \u5b9f\u306f\u3053\u306e\u5b50, \u3068\u3066\u3082\u512a\u79c0\u3067\u3059. \u81ea\u5206\u304c\u3042\u308a\u304c\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u3044\u304f\u3064\u304b\u6319\u3052\u3066\u307f\u307e\u3059:\n\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u6975\u307f\u5e45\u3092\u5909\u5316\u3055\u305b\u308b\u9069\u5fdc\u578b\u7a4d\u5206\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\n\n\nSimpson\u7a4d\u5206\u3060\u3068\u5dee\u5206\u306e\u5e45\u306f\u7a7a\u9593\u4e00\u69d8\u306a\u306e\u3067\u3059\u304c, \u9069\u5fdc\u578b\u7a4d\u5206\u3060\u3068\u300c\u7d30\u304b\u3044\u5dee\u5206\u304c\u5fc5\u8981\u306a\u3068\u3053\u308d(\u95a2\u6570\u304c\u6fc0\u3057\u304f\u52d5\u304f\u3068\u3053\u308d)\u306f\u7d30\u304b\u304f\u3057\u3066, \u3042\u307e\u308a\u5fc5\u8981\u304c\u306a\u3044\u3068\u3053\u308d(\u95a2\u6570\u306e\u52d5\u304d\u304c\u7a4f\u3084\u304b\u306a\u3068\u3053\u308d)\u306f\u5e45\u3092\u5e83\u304f\u3059\u308b\u300d\u3088\u3046\u306a\u51e6\u7406\u3092\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u3067\u3059. \u8aa4\u5dee\u306e\u7cbe\u5ea6\u3092\u4fdd\u3063\u305f\u307e\u307e\u8a08\u7b97\u304c\u65e9\u304f\u306a\u308a\u307e\u3059. \u666e\u901a\u306e1\u6b21\u5143\u7a4d\u5206\u3067\u306f\u305d\u3093\u306a\u306b\u6709\u308a\u96e3\u307f\u304c\u611f\u3058\u3089\u308c\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c, 2\u91cd, 3\u91cd\u7a4d\u5206\u306b\u306a\u308b\u3068Simpson\u7a4d\u5206\u3068\u306f\u6bd4\u3079\u7269\u306b\u306a\u3089\u306a\u3044\u901f\u5ea6\u3067\u30592. C/C++\u3067\u81ea\u4f5c\u3057\u305fSimpson\u7a4d\u5206\u3088\u308a\u3082\u305a\u3063\u3068\u306f\u3084\u3044\u3067\u3059.\n\n\n\u7a4d\u5206\u533a\u9593\u306bnp.inf\u3092\u4e0e\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\n\n\n\u4eca\u56de\u306e\u3088\u3046\u306a\u30b3\u30f3\u30d1\u30af\u30c8\u306a\u95a2\u6570\u306f\u6c42\u3081\u308b\u8a08\u7b97\u7cbe\u5ea6\u306b\u4f9d\u3063\u3066\u3069\u3053\u307e\u3067\u7a4d\u5206\u533a\u9593\u3092\u53d6\u308b\u304b\u304c\u5909\u308f\u308a\u307e\u3059\u304c, np.inf\u3092\u4f7f\u3048\u308b\u3053\u3068\u306b\u3088\u3063\u3066, \u30ab\u30c3\u30c8\u30aa\u30d5\u3092\u6c17\u306b\u305b\u305a\u8a08\u7b97\u7cbe\u5ea6\u306fquad\u306e\u5f15\u6570epsabs, epsrel\u306a\u3069\u306b\u6295\u3052\u3066\u3057\u307e\u3048\u308b\u306e\u304c\u3044\u3044\u3067\u3059\u306d. \n\n\n\u7c21\u5358\u306b\u4f7f\u3048\u307e\u3059\n\n\n\u304a\u305d\u3089\u304fQUADPACK\u3092\u76f4\u63a5\u89e6\u308b\u3088\u308a\u305a\u3063\u3068\u7c21\u5358\u306a\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u3067\u30593.\n\n\n\u56fa\u6709\u5024\u65b9\u7a0b\u5f0f\n\u3053\u3053\u304b\u3089\u3061\u3087\u3063\u3068\u91cf\u5b50\u529b\u5b66\u306e\u304a\u8a71\u306b\u306a\u308a\u307e\u3059. \u3042\u308b\u4e00\u6b21\u5143\u8abf\u548c\u632f\u52d5\u5b50\u7cfb\u306e\u56fa\u6709\u95a2\u6570\u3068\u30a8\u30cd\u30eb\u30ae\u30fc\u56fa\u6709\u5024\u3092\u6c42\u3081\u3066\u307f\u307e\u3057\u3087\u3046. \u30cf\u30df\u30eb\u30c8\u30cb\u30a2\u30f3\u306f\nH = \\frac{\\hat{p}^2}{2} + \\frac{\\hat{q}^2}{2} = -\\frac12\\frac{d^2}{dq^2} + \\frac{q^2}{2}\nH=\u02c6p22+\u02c6q22=\u221212d2dq2+q22{H = \\frac{\\hat{p}^2}{2} + \\frac{\\hat{q}^2}{2} = -\\frac12\\frac{d^2}{dq^2} + \\frac{q^2}{2}\n}\n\u3053\u3093\u306a\u5b50\u3067\u3059. \u210f=\u03c9=m=1\\hbar = \\omega = m = 1\u306e\u5358\u4f4d\u7cfb\u3092\u63a1\u7528\u3057\u3066\u3044\u307e\u3059. \u3053\u306e\u30cf\u30df\u30eb\u30c8\u30cb\u30a2\u30f3\u306b\u5bfe\u3059\u308bSchroedinger\u65b9\u7a0b\u5f0f\nH\\psi_\\ell(q) = E_\\ell\\psi_\\ell(q)\nH\u03c8\u2113(q)=E\u2113\u03c8\u2113(q){H\\psi_\\ell(q) = E_\\ell\\psi_\\ell(q)\n}\n\u3092\u89e3\u3044\u3066\u307f\u307e\u3057\u3087\u3046. \u2113\\ell\u306f\u5dee\u5206\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u306f\u306a\u304f, \u56fa\u6709\u5024\u30fb\u56fa\u6709\u95a2\u6570\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u3059. \u307e\u305a\u306f\u30dd\u30c6\u30f3\u30b7\u30e3\u30eb\u9805\u3092\u5dee\u5206\u5316\u3057\u3066\u884c\u5217\u5f62\u5f0f\u306b\u3057\u3066\u3042\u3052\u307e\u3059:\n    \\frac{q^2}{2}\\psi(q) \\rightarrow \\frac12\n    \\begin{pmatrix}\n    q_0^2&0&0&\\cdots&0\\\\ \n    0&q_1^2 &0&\\cdots&0\\\\\n    0 & 0&q_2^2&& \\vdots\\\\\n    \\vdots&&&\\ddots&0\\\\\n    0& \\cdots& 0 &0& q_n^2\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    \\psi_0\\\\\n    \\psi_1\\\\\n    \\vdots\\\\\n    \\psi_{n-1}\\\\\n    \\psi_n\n    \\end{pmatrix}=\\frac12\n    \\begin{pmatrix}\n    (-L/2)^2&0&0&\\cdots&0\\\\ \n    0&(-L/2 + \\Delta q)^2 &0&&0\\\\\n    0 & 0&(-L/2 + 2\\Delta q)^2&& \\vdots\\\\\n    \\vdots&&&\\ddots&0\\\\\n    0& \\cdots& 0 &0& (L/2)^2\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    \\psi_0\\\\\n    \\psi_1\\\\\n    \\vdots\\\\\n    \\psi_{n-1}\\\\\n    \\psi_n\n    \\end{pmatrix} = V\\psi\nq22\u03c8(q)\u219212(q2000\u22ef00q210\u22ef000q22\u22ee\u22ee\u22f100\u22ef00q2n)(\u03c80\u03c81\u22ee\u03c8n\u22121\u03c8n)=12((\u2212L/2)200\u22ef00(\u2212L/2+\u0394q)20000(\u2212L/2+2\u0394q)2\u22ee\u22ee\u22f100\u22ef00(L/2)2)(\u03c80\u03c81\u22ee\u03c8n\u22121\u03c8n)=V\u03c8{    \\frac{q^2}{2}\\psi(q) \\rightarrow \\frac12\n    \\begin{pmatrix}\n    q_0^2&0&0&\\cdots&0\\\\ \n    0&q_1^2 &0&\\cdots&0\\\\\n    0 & 0&q_2^2&& \\vdots\\\\\n    \\vdots&&&\\ddots&0\\\\\n    0& \\cdots& 0 &0& q_n^2\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    \\psi_0\\\\\n    \\psi_1\\\\\n    \\vdots\\\\\n    \\psi_{n-1}\\\\\n    \\psi_n\n    \\end{pmatrix}=\\frac12\n    \\begin{pmatrix}\n    (-L/2)^2&0&0&\\cdots&0\\\\ \n    0&(-L/2 + \\Delta q)^2 &0&&0\\\\\n    0 & 0&(-L/2 + 2\\Delta q)^2&& \\vdots\\\\\n    \\vdots&&&\\ddots&0\\\\\n    0& \\cdots& 0 &0& (L/2)^2\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    \\psi_0\\\\\n    \\psi_1\\\\\n    \\vdots\\\\\n    \\psi_{n-1}\\\\\n    \\psi_n\n    \\end{pmatrix} = V\\psi\n}\n\u306f\u3058\u3063\u3053\u304c\u4e01\u5ea6L/2L/2\u306b\u306a\u308b\u304b\u3069\u3046\u304b\u306f\u308f\u304b\u308a\u307e\u305b\u3093\u304c, \u305d\u3053\u306f\u9069\u5f53\u306b. \u5fae\u5206\u306e\u7ae0\u3067\u3084\u3063\u305f\u3053\u3068\u3092\u601d\u3044\u51fa\u305b\u3070, Schroedinger\u65b9\u7a0b\u5f0f\u306f\nH\\psi = (K + V)\\psi = \\frac12\n\\begin{pmatrix}\n\\frac{2}{\\Delta q^2} + (-L/2)^2&\\frac{-1}{\\Delta q^2}&0&\\cdots&0\\\\ \n\\frac{-1}{\\Delta q^2}&\\frac{2}{\\Delta q^2} + (-L/2 + \\Delta q)^2 &\\frac{-1}{\\Delta q^2}&&0\\\\\n0 & \\frac{-1}{\\Delta q^2}&\\frac{2}{\\Delta q^2} + (-L/2 + 2\\Delta q)^2&& \\vdots\\\\\n\\vdots&&&\\ddots&\\frac{-1}{\\Delta q^2}\\\\\n0& \\cdots& 0 &\\frac{-1}{\\Delta q^2}& \\frac{2}{\\Delta q^2} + (L/2)^2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\psi_0\\\\\n\\psi_1\\\\\n\\vdots\\\\\n\\psi_{n-1}\\\\\n\\psi_n\n\\end{pmatrix} = E_\\ell\\psi\nH\u03c8=(K+V)\u03c8=12(2\u0394q2+(\u2212L/2)2\u22121\u0394q20\u22ef0\u22121\u0394q22\u0394q2+(\u2212L/2+\u0394q)2\u22121\u0394q200\u22121\u0394q22\u0394q2+(\u2212L/2+2\u0394q)2\u22ee\u22ee\u22f1\u22121\u0394q20\u22ef0\u22121\u0394q22\u0394q2+(L/2)2)(\u03c80\u03c81\u22ee\u03c8n\u22121\u03c8n)=E\u2113\u03c8{H\\psi = (K + V)\\psi = \\frac12\n\\begin{pmatrix}\n\\frac{2}{\\Delta q^2} + (-L/2)^2&\\frac{-1}{\\Delta q^2}&0&\\cdots&0\\\\ \n\\frac{-1}{\\Delta q^2}&\\frac{2}{\\Delta q^2} + (-L/2 + \\Delta q)^2 &\\frac{-1}{\\Delta q^2}&&0\\\\\n0 & \\frac{-1}{\\Delta q^2}&\\frac{2}{\\Delta q^2} + (-L/2 + 2\\Delta q)^2&& \\vdots\\\\\n\\vdots&&&\\ddots&\\frac{-1}{\\Delta q^2}\\\\\n0& \\cdots& 0 &\\frac{-1}{\\Delta q^2}& \\frac{2}{\\Delta q^2} + (L/2)^2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\psi_0\\\\\n\\psi_1\\\\\n\\vdots\\\\\n\\psi_{n-1}\\\\\n\\psi_n\n\\end{pmatrix} = E_\\ell\\psi\n}\n\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059. \n\n\u5b9f\u88c5\n\u3055\u3066\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u3059. \n# \u7cfb\u306e\u8a2d\u5b9a\n>>> L, N = 10, 200\n>>> x, dx = np.linspace(-L/2, L/2, N), L / N\n\n# \u904b\u52d5\u9805K\n>>> K = np.eye(N, N)\n>>> K_sub = np.vstack((K[1:], np.array([0] * N)))\n>>> K = dx**-2 * (2 * K - K_sub - K_sub.T)\n\n# \u30dd\u30c6\u30f3\u30b7\u30e3\u30eb\u9805\n>>> V = np.diag(np.linspace(-L/2, L/2, N)**2)\n\n# \u30a8\u30eb\u30df\u30fc\u30c8\u884c\u5217\u306e\u56fa\u6709\u5024\u65b9\u7a0b\u5f0f\n# w\u304c\u56fa\u6709\u5024, v\u304c\u56fa\u6709\u30d9\u30af\u30c8\u30eb\n>>> H = (K + V) / 2\n>>> w, v = np.linalg.eigh(H)\n\ndx\u306e\u5b9a\u7fa9\u304c\u5fae\u5999\u3067\u3059\u304c, \u6c17\u306b\u305b\u305a\u884c\u304d\u307e\u3057\u3087\u3046:\n\n\u6559\u79d1\u66f8\u3067\u3082\u3088\u304f\u898b\u308b\u56fa\u6709\u95a2\u6570\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u307e\u3059.\nnp.linalg.eigh\u306f\u30a8\u30eb\u30df\u30fc\u30c8\u7528\u306e\u56fa\u6709\u5024\u65b9\u7a0b\u5f0f\u306e\u30bd\u30eb\u30d0\u30fc\u3067, \u56fa\u6709\u5024\u3068\u56fa\u6709\u95a2\u6570\u3092\u8fd4\u3057\u3066\u304f\u308c\u307e\u3059. \u4eca\u56de\u306f3\u91cd\u5bfe\u89d2\u884c\u5217\u306a\u306e\u3067, \u5e2f\u884c\u5217\u7528\u306enp.linalg.eig_banded\u3067\u3082\u3088\u3044\u3067\u3059\u304c, \u901f\u5ea6\u306f\u3080\u3057\u308dnp.linalg.eigh\u306e\u65b9\u304c\u65e9\u3044\u3068\u601d\u3044\u307e\u30594. \u30e1\u30e2\u30ea\u306e\u6d88\u8cbb\u91cf\u306fnp.linalg.eig_banded\u306e\u65b9\u304c\u305f\u3076\u3093\u5c11\u306a\u3044\u3067\u3059. \n\u3053\u3053\u3067\u6ce8\u610f\u3057\u305f\u3044\u306e\u304c, \u57fa\u5e95\u72b6\u614b\u30fb\u7b2c\u4e00\u52b1\u8d77\u72b6\u614b\u30fb\u7b2c\u4e8c\u52b1\u8d77\u72b6\u614b...\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u306e\u306fv[0], v[1], v[2]...\u3067\u306f\u306a\u304f, v.T[0], v.T[1], v.T[2]...\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059. \u3053\u308c\u306f\u914d\u5217\u30c7\u30fc\u30bf\u306e\u30e1\u30e2\u30ea\u3078\u306e\u683c\u7d0d\u304cC\u7cfb\u304cRow-major\u3067\u3042\u308a, Fortran\u304cColumn-major\u3067\u3042\u308b\u98df\u3044\u9055\u3044\u304c\u6050\u3089\u304f\u539f\u56e0\u3067\u3059. np.linalg.eigh\u304cLAPACK\u306e\u30e9\u30c3\u30d1\u30fc\u3067\u3042\u308b\u306a\u3089\u3042\u308b\u610f\u5473\u81ea\u7136\u306a\u6319\u52d5\u3068\u8a00\u3048\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093. \n\u56fa\u6709\u5024\u306e\u5dee\u5206\u3092\u8a08\u7b97\u3057\u3066\u52b1\u8d77\u30a8\u30cd\u30eb\u30ae\u30fc\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u3087\u3046. \u57fa\u5e95\u304b\u308920\u500b\u307b\u3069\u51fa\u529b\u3057\u3066\u307f\u307e\u3059:\n>>> np.diff(w)[:20]\n[ 1.00470938  1.00439356  1.00407832  1.00376982  1.00351013  1.00351647\n  1.00464172  1.00938694  1.02300462  1.05279364  1.10422331  1.17688369\n  1.26494763  1.36132769  1.46086643  1.56082387  1.66005567  1.75820017\n  1.85521207  1.95115074]\n\n\u8abf\u548c\u632f\u52d5\u5b50\u7cfb\u306e\u52b1\u8d77\u30a8\u30cd\u30eb\u30ae\u30fc\u306f\u6e96\u4f4d\u306b\u4f9d\u3089\u305a\u210f\u03c9\\hbar\\omega\u306a\u306e\u3067, \u4eca\u56de\u306e\u5358\u4f4d\u7cfb\u3067\u306f1\u3067\u3059. \u4f4e\u30a8\u30cd\u30eb\u30ae\u30fc\u9818\u57df\u3067\u306f\u5272\u3068\u826f\u304f\u518d\u73fe\u3055\u308c\u3066\u3044\u307e\u3059\u304c, \u9ad8\u30a8\u30cd\u30eb\u30ae\u30fc\u9818\u57df\u3067\u306f\u304b\u306a\u308a\u602a\u3057\u304f\u306a\u3063\u3066\u307e\u3059. \u8a66\u3057\u306b\u7b2c15\u52b1\u8d77\u72b6\u614b\u3092\u51fa\u529b\u3057\u3066\u307f\u307e\u3057\u3087\u3046:\n\n\u7bc0\u306e\u6570\u306f\u3061\u3083\u3093\u306815\u500b\u3042\u308a\u307e\u3059\u304c, \u7aef\u3063\u3053\u3067\u95a2\u6570\u304c\u30b3\u30f3\u30d1\u30af\u30c8\u306b\u306a\u3063\u3066\u3044\u307e\u305b\u3093. \u3068\u3044\u3046\u308f\u3051\u3067, \u7a7a\u9593\u306e\u30b5\u30a4\u30ba\u304cL=10L=10\u3067\u306f\u8db3\u308a\u306a\u304b\u3063\u305f\u308f\u3051\u3067\u3059. \u3069\u306e\u52b1\u8d77\u72b6\u614b\u307e\u3067\u3092\u7cbe\u5ea6\u3088\u304f\u8a08\u7b97\u3057\u305f\u3044\u304b\u306b\u3088\u3063\u3066\u7a7a\u9593\u306e\u30b5\u30a4\u30ba\u3084\u5206\u5272\u6570\u3092\u5909\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059. \n\u8abf\u548c\u632f\u52d5\u5b50\u306e\u56fa\u6709\u5024\u30fb\u56fa\u6709\u95a2\u6570\u3092\u89e3\u6790\u7684\u306b\u8a08\u7b97\u3059\u308b\u306e\u306f\u305d\u3053\u305d\u3053\u9aa8\u304c\u6298\u308c\u308b\u4f5c\u696d\u3067\u3059\u304c, \u6570\u5024\u8a08\u7b97\u306b\u6295\u3052\u3066\u3042\u3052\u308b\u3068\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u3067\u3059\u306d5. \n\n\u5fae\u5206\u65b9\u7a0b\u5f0f\n1\u6b21\u5143\u306e\u62e1\u6563\u65b9\u7a0b\u5f0f\n\\frac{\\partial}{\\partial t}f(x, t) = \\frac{\\partial^2}{\\partial x^2}f(x, t)\n\u2202\u2202tf(x,t)=\u22022\u2202x2f(x,t){\\frac{\\partial}{\\partial t}f(x, t) = \\frac{\\partial^2}{\\partial x^2}f(x, t)\n}\n\u3092\u89e3\u3044\u3066\u307f\u307e\u3057\u3087\u3046. \u3053\u306e\u5b50\u306f\u521d\u671f\u6761\u4ef6\u304c\u4e0e\u3048\u3089\u308c\u308c\u3070xx\u306eFourier\u5909\u63db\u3092\u901a\u3058\u3066\u89e3\u6790\u89e3\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u30596\u304c, \u3082\u3061\u308d\u3093\u4eca\u56de\u306f\u6570\u5024\u8a08\u7b97\u3067\u89e3\u3044\u3066\u307f\u307e\u3057\u3087\u3046. \u521d\u671f\u6761\u4ef6\u3092\u30ac\u30a6\u30b7\u30a2\u30f3\u3067\u4e0e\u3048\u3066, \u304a\u6c7a\u307e\u308a\u306e\u7a7a\u9593\u306e\u5dee\u5206\u5316\u304b\u3089\u306f\u3058\u3081\u307e\u3057\u3087\u3046:\nf(x, 0) = \\exp(-x^2)\\\\\nf_k \\equiv f(k\\Delta x, t), \\hspace{0.7cm} \\Delta x = L/N\nf(x,0)=exp(\u2212x2)fk\u2261f(k\u0394x,t),\u0394x=L/N{f(x, 0) = \\exp(-x^2)\\\\\nf_k \\equiv f(k\\Delta x, t), \\hspace{0.7cm} \\Delta x = L/N\n}\n\u305d\u3046\u3059\u308b\u3068, \u5fae\u5206\u65b9\u7a0b\u5f0f\u3082\u307e\u305f\u5dee\u5206\u5316\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059:\n\\frac{d}{dt}f_0 = \\frac{f_1 - 2f_0}{\\Delta x^2}\\\\\n\\frac{d}{dt}f_1 = \\frac{f_2 - 2f_1 + f_0}{\\Delta x^2}\n...\\\\\n\\frac{d}{dt}f_k = \\frac{f_{k+1} - 2f_k + f_{k-1}}{\\Delta x^2}\\\\\n...\\\\\n\\frac{d}{dt}f_{n-1} = \\frac{f_{n} - 2f_{n-1} + f_{n-2}}{\\Delta x^2}\\\\\n\\frac{d}{dt}f_n = \\frac{-2f_n + f_{n-1}}{\\Delta x^2}\nddtf0=f1\u22122f0\u0394x2ddtf1=f2\u22122f1+f0\u0394x2...ddtfk=fk+1\u22122fk+fk\u22121\u0394x2...ddtfn\u22121=fn\u22122fn\u22121+fn\u22122\u0394x2ddtfn=\u22122fn+fn\u22121\u0394x2{\\frac{d}{dt}f_0 = \\frac{f_1 - 2f_0}{\\Delta x^2}\\\\\n\\frac{d}{dt}f_1 = \\frac{f_2 - 2f_1 + f_0}{\\Delta x^2}\n...\\\\\n\\frac{d}{dt}f_k = \\frac{f_{k+1} - 2f_k + f_{k-1}}{\\Delta x^2}\\\\\n...\\\\\n\\frac{d}{dt}f_{n-1} = \\frac{f_{n} - 2f_{n-1} + f_{n-2}}{\\Delta x^2}\\\\\n\\frac{d}{dt}f_n = \\frac{-2f_n + f_{n-1}}{\\Delta x^2}\n}\nSciPy\u306b\u306f, \u3042\u308b\u95a2\u6570\u306e\u5dee\u5206\u5316\u306e\u30ea\u30b9\u30c8[f0, f1, ... , fn-1, fn]\u3092\u5f15\u6570\u306b\u3068\u308a, \u0394t\\Delta t\u3060\u3051\u6642\u9593\u767a\u5c55\u3055\u305b\u305f\u5f8c\u306e\u30ea\u30b9\u30c8(ndarray)\u3092\u623b\u308a\u5024\u3068\u3059\u308b\u3088\u3046\u306a\u95a2\u6570\u3092\u6e21\u3057\u3066\u3042\u3052\u308b\u3053\u3068\u3067\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u308bodeint\u3068\u3044\u3046\u5fae\u5206\u65b9\u7a0b\u5f0f\u306e\u30bd\u30eb\u30d0\u30fc\u304c\u3042\u308a\u307e\u3059. \n\n\u5b9f\u88c5\n\u307e\u305a\u306f\u305d\u306e\u95a2\u6570\u3092\u4f5c\u3063\u3066\u3042\u3052\u307e\u3057\u3087\u3046.:\nfrom scipy.integrate import odeint\n\ndef equation(f, t=0, N, L):\n    dx = L / N\n    gamma = dx**-2\n    i = np.arange(1, N, 1)\n\n    # f0\n    arr = np.array(gamma * (f[1] - 2 * f[0]))\n    # f1 to fN-1\n    arr = np.append(arr, gamma * (f[i+1] - 2 * f[i] + f[i-1]))\n    # fN\n    arr = np.append(arr, gamma * (-2 * f[N] + f[N-1]))\n\n    return arr\n\n\u4f55\u3092\u3084\u3063\u3066\u3044\u308b\u304b\u306f\u306a\u3093\u3068\u306a\u304f\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059. \u3053\u306e\u95a2\u6570\u5185\u3067\u306f, \u5dee\u5206\u5316\u3057\u305fff\u3092f[n]\u306e\u3088\u3046\u306a\u914d\u5217\u306e\u5f62\u3067\u66f8\u3044\u3066\u3042\u3052\u307e\u3059. f\u306ff[0]\u304b\u3089f[N]\u306eN+1N+1\u500b\u306e\u8981\u7d20\u304b\u3089\u6210\u308a\u307e\u3059. \u307e\u305f, \u7b2c\u4e00\u5f15\u6570\u306b\u95a2\u6570\u3092\u5dee\u5206\u5316\u3057\u305f\u30ea\u30b9\u30c8f, \u7b2c\u4e8c\u5f15\u6570\u306b\u6642\u9593t\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u306e\u306f, odeint\u306e\u4ed5\u69d8\u3067\u3059. \u304b\u306a\u3089\u305a\u3053\u306e\u9806\u756a\u306b\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044. \u521d\u671f\u6642\u523b\u306f\u3082\u3061\u308d\u3093t=0t = 0\u306a\u306e\u3067, \u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059. # f1 to fN-1\u306e\u3068\u3053\u308d\u3067, [gamma * (f[j+1] - 2 * f[j] + f[j-1]) for j in i]\u3068\u66f8\u304b\u305a\u306b, \u305f\u3060ndarray\u3067\u3042\u308bi\u3092\u30ea\u30b9\u30c8\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u5165\u308c\u308b\u3060\u3051\u3067OK\u3068\u3044\u3046\u306e\u306f\u5730\u5473\u306b\u3059\u3054\u3044\u3068\u601d\u3044\u307e\u3059.\n-- \u8ffd\u8a18(2016/12/3) --\n\u7d50\u5c402\u968e\u5fae\u5206\u3092\u3059\u308b\u3060\u3051\u306a\u306e\u3067\nfrom scipy.integrate import odeint\n\ndef equation(f, t=0, N, L):\n    dx = L / N\n    arr = np.gradient(np.gradient(f, dx), dx)\n\n    return arr\n\n\u3067\u3088\u304b\u3063\u305f\u3067\u3059\u306d. gradient\u306fdiff\u3068\u9055\u3063\u3066, \u51e6\u7406\u5f8c\u306b\u30ea\u30b9\u30c8\u306e\u30b5\u30a4\u30ba\u304c\u5909\u308f\u3089\u306a\u3044\u3068\u3053\u308d\u304c\u7d20\u6674\u3089\u3057\u3044\u3067\u3059. \n-- \u8ffd\u8a18\u3053\u3053\u307e\u3067 --\n\u3061\u306a\u307f\u306b, \u521d\u671f\u95a2\u6570\u306f\ndef f(x):\n    return np.exp(-x**2)\n\n\u3067\u3057\u305f\u306d.\n\u307e\u305f, odeint\u81ea\u8eab\u3082\u6e21\u3055\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u5909\u6570\u304c\u3042\u308b\u7a0b\u5ea6\u6c7a\u307e\u3063\u3066\u3044\u307e\u3059. \u3072\u3068\u3064\u306f\u4e0a\u3067\u5b9a\u7fa9\u3057\u305fequation(f, t0, ...), \u3075\u305f\u3064\u3081\u306f\u306b\u306f\u521d\u671f\u95a2\u6570\u3092\u5dee\u5206\u5316\u3057\u305fndarray(iterable\u306a\u3089\u826f\u3044\u307f\u305f\u3044\u3067\u3059), \u307f\u3063\u3064\u3081\u306f\u8a08\u7b97\u3059\u308b\u6642\u523bt\u306e\u30ea\u30b9\u30c8\u3067\u3059. \u3055\u3089\u306b, equation\u306ff\u3068t0\u4ee5\u5916\u306b\u3082\u5909\u6570\u3092\u6301\u3063\u3066\u3044\u308b\u306e\u3067, \u305d\u308c\u3089\u306e\u5b58\u5728\u3092odeint\u306b\u6559\u3048\u3066\u3042\u3052\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306e\u3067, \u305d\u306e\u60c5\u5831\u3092args\u306b\u683c\u7d0d\u3057\u307e\u3059. \u3053\u308c\u3089\u3092\u8e0f\u307e\u3048\u3066\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059:\n# initial parameter(optional)\nN, L = 200, 40\n\n# coordinate\nq = np.linspace(-L/2, L/2, N)\n\n# initial value for each fk\nfk_0 = f(q)\n\n# time\nt_max, t_div = 10, 5\nt = np.linspace(0, t_max, t_div)\n\ntrajectories = odeint(equation, fk_0, t, args=(N, L))\n\nt[i]\u306e\u6642\u523b\u306e\u89e3\u304ctrajectories[i]\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059. \u3055\u3066, \u3053\u308c\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u307e\u3059:\n\n\u30ac\u30a6\u30b9\u30b7\u30a2\u30f3\u304c\u62e1\u6563\u3059\u308b\u69d8\u5b50\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f. \u4eca\u56de\u306f\u62e1\u6563\u65b9\u7a0b\u5f0f\u3092\u6271\u3063\u305f\u306e\u3067, (x,t)(x, t)\u306e2\u5909\u6570\u3067\u5c11\u3057\u3084\u3084\u3053\u3057\u3044\u30b3\u30fc\u30c9\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f. \u666e\u901a\u306e1\u5909\u6570\u306e\u5fae\u5206\u65b9\u7a0b\u5f0f\u306a\u3089\u3082\u3063\u3068\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059. \u30d7\u30ed\u30c3\u30c8\u3059\u308b\u3068\u304d\u306f\u3055\u3059\u304c\u306bfor\u30eb\u30fc\u30d7\u3092\u4f7f\u3044\u307e\u3059\u304c...\u305d\u308c\u306f\u3044\u3044\u3067\u3057\u3087\u3046. \u6570\u5024\u8a08\u7b97\u306e\u904e\u7a0b\u3067for\u30eb\u30fc\u30d7(\u30ea\u30b9\u30c8\u5185\u5305\u3082\u542b\u3080)\u3092\u4f7f\u3063\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u91cd\u8981\u3067\u3059. \n\n\u304a\u308f\u308a\u306b\n\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067, \u7d9a\u304d\u306f\u307e\u305f\u5225\u8a18\u4e8b\u306b\u307e\u3068\u3081\u308b\u3053\u3068\u306b\u3057\u307e\u3059. \u300c\u3082\u3063\u3068\u4e0a\u624b\u3044\u65b9\u6cd5\u304c\u3042\u308b\u3088\uff01\u300d\u3068\u3044\u3046\u65b9\u304c\u3044\u3089\u3063\u3057\u3083\u3063\u305f\u3089\u662f\u975e\u30b3\u30e1\u30f3\u30c8\u3092\u9802\u3051\u308b\u3068\u5b09\u3057\u3044\u3067\u3059. \n\u601d\u3063\u305f\u4ee5\u4e0a\u306bNumPy\u30fbSciPy\u306e\u5b88\u5099\u7bc4\u56f2\u304c\u5e83\u3044\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059. \u300c\u3082\u3057\u304b\u3057\u305f\u3089...\u300d\u3068\u601d\u3063\u3066\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3092\u63a2\u308b\u3068, \u304b\u3064\u3066\u81ea\u5206\u3067\u5b9f\u88c5\u3057\u3066\u3044\u305f\u3082\u306e\u304c\u65e2\u306b\u3042\u3063\u305f7\u3068\u3044\u3046\u3053\u3068\u306f\u3088\u304f\u3042\u308b\u3053\u3068\u3067\u3059. \u305d\u308c\u306fNumPy\u30fbSciPy\u3060\u3051\u3067\u306a\u304f, Python\u306e\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u3082\u5f53\u3066\u306f\u307e\u308a\u307e\u3059. \u662f\u975ePython\u306e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3082\u76ee\u3092\u901a\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044. \u300c\u3053\u3093\u306a\u306e\u3082\u3042\u3063\u305f\u306e\u304b\u300d\u3068\u9a5a\u304f\u3088\u3046\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5fc5\u305a\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3088.\n\u8ffd\u8a18(2016/11/25): \u4ee5\u4e0b\u306b\u7d9a\u304d\u307e\u3059\nNumPy\u30fbSciPy\u3092\u7528\u3044\u305f\u6570\u5024\u8a08\u7b97\u306e\u9ad8\u901f\u5316 : \u5fdc\u7528\u305d\u306e2\n\n\n\n\nQUADPACK\u3092\u30e9\u30c3\u30d7\u3057\u3066\u3044\u308b\u306e\u304b\u3069\u3046\u304b\u306f\u8abf\u3079\u3066\u3044\u307e\u305b\u3093. \u30de\u30cb\u30e5\u30a2\u30eb\u306b\u306f\u300c...using a technique from the Fortran library QUADPACK.\u300d\u3068\u3042\u308a\u307e\u3059. \u00a0\u21a9\n\n\n7\u91cd, 8\u91cd\u3068\u304b\u3060\u3068\u3055\u3059\u304c\u306b\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u306e\u65b9\u304c\u306f\u3084\u3044\u3068\u601d\u3044\u307e\u3059. \u00a0\u21a9\n\n\n\u4f7f\u3063\u305f\u3053\u3068\u304c\u306a\u3044\u306e\u3067\u6b63\u76f4\u308f\u304b\u308a\u307e\u305b\u3093. \u00a0\u21a9\n\n\n\u30d0\u30f3\u30c9\u884c\u5217\u306e\u30bd\u30eb\u30d0\u30fc\u306f\u7d50\u5c40\u5e2f\u3067\u6e21\u3057\u305f\u3082\u306e\u3092\u884c\u5217\u5f62\u5f0f\u306b\u5c55\u958b\u3057\u3066\u304b\u3089\u8a08\u7b97\u3059\u308b\u3088\u3046\u3067\u3059. \u305d\u3046\u306a\u308b\u3068\u7d50\u5c40\u30e1\u30e2\u30ea\u6d88\u8cbb\u91cf\u3082\u5909\u308f\u3089\u306a\u3044\u6c17\u304c\u3057\u307e\u3059\u304c...\u8a73\u3057\u304f\u306f\u3088\u304f\u77e5\u3089\u306a\u3044\u3067\u3059. \u00a0\u21a9\n\n\n\u3082\u3061\u308d\u3093\u7269\u7406\u5c4b\u3055\u3093\u306f\u6570\u5024\u8a08\u7b97\u306b\u6295\u3052\u3066\u6e80\u8db3\u3057\u3066\u3044\u3066\u306f\u3044\u3051\u307e\u305b\u3093. \u6570\u5024\u8a08\u7b97\u3060\u3051\u3067\u306f\u5b9a\u6027\u7684\u306a\u8b70\u8ad6\u304c\u3067\u304d\u306a\u3044\u306e\u3067, \u53b3\u5bc6\u306b\u89e3\u3051\u306a\u3044\u7cfb\u3067\u3082\u8fd1\u4f3c\u3059\u308b\u306a\u308a\u3057\u3066\u89e3\u6790\u7684\u306a\u89e3\u3092\u51fa\u3059\u3053\u3068\u306b\u5927\u304d\u306a\u610f\u5473\u304c\u3042\u308a\u307e\u3059. \u00a0\u21a9\n\n\n\u96fb\u5b50\u56de\u8def\u3067\u30e9\u30d7\u30e9\u30b9\u5909\u63db\u3092\u901a\u3058\u3066\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u3053\u3068\u304c\u3088\u304f\u3042\u308a\u307e\u3059\u304c, \u672c\u8cea\u7684\u306b\u306f\u305d\u308c\u3068\u540c\u3058\u3067\u3059.  \u89e3\u6790\u7684\u306b\u7a4d\u5206\u304c\u3067\u304d\u306a\u3044\u521d\u671f\u95a2\u6570\u3092\u7528\u610f\u3059\u308b\u3068\u7d50\u5c40\u6570\u5024\u7684\u306b\u89e3\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059. \u305d\u3046\u3044\u3063\u305f\u610f\u5473\u3067\u30ac\u30a6\u30b7\u30a2\u30f3\u306f\u30b3\u30f3\u30d1\u30af\u30c8\u3067\u89e3\u6790\u7684\u306b\u7a4d\u5206\u3067\u304d\u308b, \u3068\u3066\u3082\u6027\u8cea\u306e\u826f\u3044\u95a2\u6570\u3067\u3059. \u00a0\u21a9\n\n\n\u305d\u3057\u3066\u5f80\u3005\u306b\u3057\u3066, \u81ea\u5206\u304c\u5b9f\u88c5\u3057\u305f\u3082\u306e\u3088\u308a\u3082\u9065\u304b\u306b\u9ad8\u6027\u80fd\u3067\u3059.\u00a0\u21a9\n\n\n\n# \u5bfe\u8c61\nPython\u53ca\u3073NumPy\u521d\u5fc3\u8005\u306b\u5411\u3051\u3066\u66f8\u3044\u3066\u3044\u307e\u3059. \u300cC\u8a00\u8a9e\u306f\u4f7f\u3048\u308b\u3051\u3069\u6700\u8fd1Python\u3092\u59cb\u3081\u305f\u300d\u3068\u304b\u300cPython\u3089\u3057\u3044\u66f8\u304d\u65b9\u304c\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u300d\u306b\u8a72\u5f53\u3059\u308b\u7269\u7406\u7cfb\u306e\u6570\u5024\u8a08\u7b97\u3092\u76ee\u7684\u3068\u3057\u305f\u65b9\u306b\u306f\u7279\u306b\u6709\u7528\u304b\u3082\u3057\u308c\u307e\u305b\u3093.\n\n\u307e\u305f, \u81ea\u5206\u306e\u4e0d\u52c9\u5f37\u306e\u305f\u3081\u306b\u9593\u9055\u3063\u305f\u8a18\u8ff0\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093. \u3054\u5bb9\u8d66\u304f\u3060\u3055\u3044. \n\n# \u3042\u3089\u307e\u3057\n\u5185\u5bb9\u306f[NumPy\u3092\u7528\u3044\u305f\u6570\u5024\u8a08\u7b97\u306e\u9ad8\u901f\u5316 : \u57fa\u790e](http://qiita.com/jabberwocky0139/items/c3620fb2f011f20a633b)\u306e\u3064\u3065\u304d\u3067\u3059. `ndarray`\u306e\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u95a2\u6570\u3084\u6f14\u7b97\u3092\u7528\u3044\u3066\u53ef\u80fd\u306a\u9650\u308afor\u30eb\u30fc\u30d7\u3092\u4f7f\u308f\u305a\u306b\u57fa\u790e\u7684\u306a\u6570\u5024\u8a08\u7b97\u3092\u5b9f\u88c5\u3057\u3066\u3044\u304d\u307e\u3059. \u4eca\u56de\u304b\u3089SciPy\u3082\u4ef2\u9593\u306b\u52a0\u308f\u308a\u307e\u3059. \u4ee5\u4e0b\u3067\u306fNumPy\u30fbSciPy\u306e\u95a2\u6570\u306e\u8a73\u3057\u3044\u5b9f\u88c5\u306b\u3064\u3044\u3066\u306f\u3042\u307e\u308a\u30b3\u30e1\u30f3\u30c8\u3057\u3066\u3044\u306a\u3044\u306e\u3067, \u308f\u304b\u3089\u306a\u3044\u3053\u3068\u304c\u3042\u3063\u305f\u3089\u662f\u975e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3092\u8aad\u3093\u3067\u307f\u3066\u304f\u3060\u3055\u3044. \u8a00\u308f\u305a\u3082\u304c\u306a, **\u8eca\u8f2a\u306e\u518d\u767a\u660e\u3092\u3057\u306a\u3044\u3053\u3068\u304c\u3068\u3063\u3066\u3082\u5927\u4e8b\u3067\u3059.**\n\n# \u5fae\u5206\n\u7269\u7406\u306e\u57fa\u790e\u65b9\u7a0b\u5f0f\u306b\u306f\u5fae\u5206\u304c\u3064\u304d\u3082\u306e\u3067\u3059. \u5fae\u5206\u306f\u7dda\u5f62\u5199\u50cf\u306a\u306e\u3067\u884c\u5217\u65b9\u7a0b\u5f0f\u3067\u8a18\u8ff0\u3067\u304d\u307e\u3059. \u305f\u3068\u3048\u3070\u3042\u308b\u95a2\u6570\u306e2\u56de\u5fae\u5206\u3092\u8a08\u7b97\u3059\u308b\u3068\u3057\u307e\u3057\u3087\u3046. \u3053\u308c\u3092\u524d\u9032\u5dee\u5206\u3068\u5f8c\u9000\u5dee\u5206\u3092\u7528\u3044\u3066\u8868\u73fe\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059:\n\n```math\n\\frac{d^2}{dx^2}\\psi(x) = \\frac{\\psi(x + \\Delta x) - 2\\psi(x) + \\psi(x - \\Delta x)}{\\Delta x^2} + {\\cal O}(\\Delta x^2)\n```\n\n$\\psi(x)$\u3092$\\Delta x$\u3067\u96e2\u6563\u5316\u3057\u3066\u3042\u3052\u308b\u3068\n\n```math\n\\psi(x)\\rightarrow \\{\\psi(x_0), \\psi(x_1), ..., \\psi(x_{n-1}), \\psi(x_n)\\} = \\{\\psi_0, \\psi_1, ..., \\psi_{n-1}, \\psi_n\\}\\hspace{1cm}x_i = -L/2 + i\\Delta x\n```\n\n\u5fae\u5206\u306f\u884c\u5217\u5f62\u5f0f\u3067\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059:\n\n```math\n\\frac{d^2}{dx^2}\\psi(x) = \\frac{1}{\\Delta x^2}\n\\begin{pmatrix}\n\\psi_{-1} -2\\psi_0 + \\psi_1\\\\\n\\psi_0 -2\\psi_1 + \\psi_2\\\\\n\\vdots\\\\\n\\psi_{n-2} -2\\psi_{n-1} + \\psi_n\\\\\n\\psi_{n-1} -2\\psi_n + \\psi_{n+1}\n\\end{pmatrix}\n\\simeq \\frac{1}{\\Delta x^2}\n\\begin{pmatrix}\n-2&1&0&\\cdots&0\\\\ \n1&-2 &1&&0\\\\\n0 & 1&-2&& \\vdots\\\\\n\\vdots&&&\\ddots&1\\\\\n0& \\cdots& 0 &1& -2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\psi_0\\\\\n\\psi_1\\\\\n\\vdots\\\\\n\\psi_{n-1}\\\\\n\\psi_n\n\\end{pmatrix}\n=K\\psi\n```\n\n\u306f\u3058\u3063\u3053\u3067\u5acc\u306a\u3053\u3068\u304c\u8d77\u304d\u3066\u3044\u307e\u3059\u304c, $\\Delta x$\u304c\u5c0f\u3055\u3051\u308c\u3070\u5927\u4e08\u592b\u3067\u3059. \u3055\u3042\u884c\u5217\u306b\u3067\u304d\u3066\u3057\u307e\u3048\u3070\u3053\u3063\u3061\u306e\u3082\u306e\u3067\u3059. \n\n## \u5b9f\u88c5\nPython\u3067\u5b9f\u88c5\u3057\u3066\u3042\u3052\u307e\u3059. \u521d\u671f\u95a2\u6570\u3092\u9069\u5f53\u306b\u7528\u610f\u3057\u3066\u5dee\u5206\u5316\u3057\u3066\u3042\u3052\u307e\u3059:\n\n```py3\n>>> import numpy as np\n>>> def f(x):\n...     return np.exp(-x**2)\n... \n>>> L, N = 7, 100\n>>> x = np.linspace(-L/2, L/2, N)\n>>> psi = f(x)\n>>> psi\narray([  4.78511739e-06,   7.81043424e-06,   1.26216247e-05,\n         2.01935578e-05,   3.19865883e-05,   5.01626530e-05,\n         7.78844169e-05,   1.19723153e-04,   1.82206228e-04,\n\t     ...,\n         2.74540100e-04,   1.82206228e-04,   1.19723153e-04,\n         7.78844169e-05,   5.01626530e-05,   3.19865883e-05,\n         2.01935578e-05,   1.26216247e-05,   7.81043424e-06,\n         4.78511739e-06])\n```\n\u305d\u3057\u3066\u5fae\u5206\u306e\u884c\u5217\u3092\u7528\u610f\u3057\u307e\u3059. \u305d\u306e\u305f\u3081\u306b\u306f\u52a3\u5bfe\u89d2\u6210\u5206\u306b\u5024\u3092\u683c\u7d0d\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093. **\u305d\u3053\u3067`ndarray`\u306e\u30b9\u30e9\u30a4\u30b9\u3068`np.vstack`\u3092\u7d44\u307f\u5408\u308f\u305b\u307e\u3059**:\n\n```py3\n>>> K = np.eye(N, N)\n>>> K\narray([[ 1.,  0.,  0., ...,  0.,  0.,  0.],\n       [ 0.,  1.,  0., ...,  0.,  0.,  0.],\n       [ 0.,  0.,  1., ...,  0.,  0.,  0.],\n       ..., \n       [ 0.,  0.,  0., ...,  1.,  0.,  0.],\n       [ 0.,  0.,  0., ...,  0.,  1.,  0.],\n       [ 0.,  0.,  0., ...,  0.,  0.,  1.]])\n>>> K_sub = np.vstack((K[1:], np.array([0] * N)))\n>>> K_sub\narray([[ 0.,  1.,  0., ...,  0.,  0.,  0.],\n       [ 0.,  0.,  1., ...,  0.,  0.,  0.],\n       [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n       ..., \n       [ 0.,  0.,  0., ...,  0.,  1.,  0.],\n       [ 0.,  0.,  0., ...,  0.,  0.,  1.],\n       [ 0.,  0.,  0., ...,  0.,  0.,  0.]])\n>>> K = -2 * K + K_sub + K_sub.T\n>>> K\narray([[-2.,  1.,  0., ...,  0.,  0.,  0.],\n       [ 1., -2.,  1., ...,  0.,  0.,  0.],\n       [ 0.,  1., -2., ...,  0.,  0.,  0.],\n       ..., \n       [ 0.,  0.,  0., ..., -2.,  1.,  0.],\n       [ 0.,  0.,  0., ...,  1., -2.,  1.],\n       [ 0.,  0.,  0., ...,  0.,  1., -2.]])\n```\n\u3053\u308c\u3067\u7a4d\u3092\u53d6\u308c\u30702\u968e\u5fae\u5206\u5b8c\u4e86\u3067\u3059:\n\n```py3\ndx = L/N\npsi_2dot = dx**-2 * np.dot(K, psi)\n```\nfor\u30eb\u30fc\u30d7\u3092\u4f7f\u308f\u305a\u306b\u66f8\u3051\u307e\u3057\u305f. \u3053\u3053\u307e\u3067\u3084\u3063\u3066\u304a\u304d\u306a\u304c\u3089, **\u5b9f\u306f`gradient`\u3068\u3044\u3046\u52fe\u914d\u3092\u8a08\u7b97\u3059\u308b\u95a2\u6570\u304c\u3042\u308a\u307e\u3059**:\n\n```py3\npsi_dot_np = np.gradient(psi, dx)\npsi_2dot_np = np.gradient(psi_dot_np, dx)\n```\n![figure1.png](https://qiita-image-store.s3.amazonaws.com/0/146775/49f77753-4edd-99c5-ac65-774f200b474a.png)\n\n`psi_2dot`\u3068`psi_2dot_np`\u306f\u307b\u307c\u5b8c\u5168\u306b\u91cd\u306a\u3063\u3066\u3044\u307e\u3059. \u3053\u308c\u3058\u3083\u3042\u5148\u306e\u884c\u5217\u306e\u8a71\u306f\u4f55\u3082\u610f\u5473\u304c\u306a\u3044\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3046\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c, \u5f8c\u306e\u56fa\u6709\u5024\u65b9\u7a0b\u5f0f\u306e\u7ae0\u3067\u518d\u3073\u65e5\u306e\u76ee\u3092\u898b\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059. \n\n# \u7a4d\u5206\n\u6570\u5024\u7a4d\u5206\u3067\u6709\u540d\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306fSimpson\u7a4d\u5206\u3067\u3057\u3087\u3046:\n\n```math\n\\int_a^b dx\\; f(x) = \\sum_{i=0}^{n-1}\\frac{h}{6}\\left[f(x_i) + 4f\\left(x_i + \\frac{h}{2}\\right) + f(x_i + h)\\right]\\hspace{1cm}x_i = a + ih\n```\n\u8a3c\u660e\u306f\u30e9\u30b0\u30e9\u30f3\u30b8\u30e5\u88dc\u5b8c\u3092\u7528\u3044\u308b\u3068\u30b7\u30f3\u30d7\u30eb\u3067\u3059\u304c, \u3053\u3053\u3067\u306f\u7701\u7565\u3057\u307e\u3059. \n\n## \u5b9f\u88c5\n\u3053\u308c\u3092\u5b9f\u88c5\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059:\n\n```py3\n>>> simp_arr = f(x) + 4 * f(x + dx / 2) + f(x + dx)\n>>> dx / 6 * np.sum(simp_arr)\n1.75472827313\n```\n\u5f0f\u3092\u305d\u306e\u307e\u307e\u30b3\u30fc\u30c9\u306b\u843d\u3068\u3057\u8fbc\u3093\u3060\u3088\u3046\u306a\u30b7\u30f3\u30d7\u30eb\u3055\u304c\u3044\u3044\u3067\u3059\u306d. **\u3057\u304b\u3057\u306a\u304c\u3089, Simpson\u7a4d\u5206\u306fSciPy\u306e\u95a2\u6570\u3068\u3057\u3066\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059:**\n\n```py3\n>>> from scipy.integrate import simps\n>>> simps(psi, x)\n1.7724525416390826\n```\n\u8a08\u7b97\u7d50\u679c\u304c\u5fae\u5999\u306b\u7570\u306a\u308b\u306e\u306f, SciPy\u306e\u65b9\u304c\u7cbe\u5ea6\u306e\u826f\u3044Simpson\u5247\u3092\u63a1\u7528\u3057\u3066\u3044\u308b\u304b\u3089\u3067\u3057\u3087\u3046. \u7279\u306b\u7406\u7531\u304c\u306a\u3044\u9650\u308a\u81ea\u5206\u3067\u7d44\u3080\u3088\u308a\u3053\u3061\u3089\u3092\u4f7f\u3046\u307b\u3046\u304c\u3044\u3044\u3067\u3059\u306d. **\u3055\u3089\u306b, \u5dee\u5206\u5316\u3059\u308b\u524d\u306e\u95a2\u6570\u3092\u6e21\u3057\u3066\u7a4d\u5206\u3059\u308b\u95a2\u6570\u3082\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059:**\n\n```py3\n>>> from scipy.integrate import quad\n>>> quad(f, -np.inf, np.inf)\n(1.7724538509055159, 1.4202636780944923e-08)\n```\n\u95a2\u6570\u3068\u7a4d\u5206\u533a\u9593\u3092\u4e0e\u3048\u3066\u3042\u3052\u308c\u3070\u8a08\u7b97\u304c\u3067\u304d\u307e\u3059. \u623b\u308a\u5024\u306ftuple\u3067, \u7b2c\u4e00\u6210\u5206\u304c\u7a4d\u5206\u7d50\u679c, \u7b2c\u4e8c\u6210\u5206\u304c\u7d76\u5bfe\u8aa4\u5dee\u3067\u3059. `quad`\u306fFortran\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3042\u308bQUADPACK\u306b\u3042\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u4f7f\u3063\u3066\u3044\u308b[^1]\u3088\u3046\u3067\u3059. **\u5b9f\u306f\u3053\u306e\u5b50, \u3068\u3066\u3082\u512a\u79c0\u3067\u3059.** \u81ea\u5206\u304c\u3042\u308a\u304c\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u3044\u304f\u3064\u304b\u6319\u3052\u3066\u307f\u307e\u3059:\n\n* **\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u6975\u307f\u5e45\u3092\u5909\u5316\u3055\u305b\u308b\u9069\u5fdc\u578b\u7a4d\u5206\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059**\n\n> Simpson\u7a4d\u5206\u3060\u3068\u5dee\u5206\u306e\u5e45\u306f\u7a7a\u9593\u4e00\u69d8\u306a\u306e\u3067\u3059\u304c, \u9069\u5fdc\u578b\u7a4d\u5206\u3060\u3068\u300c\u7d30\u304b\u3044\u5dee\u5206\u304c\u5fc5\u8981\u306a\u3068\u3053\u308d(\u95a2\u6570\u304c\u6fc0\u3057\u304f\u52d5\u304f\u3068\u3053\u308d)\u306f\u7d30\u304b\u304f\u3057\u3066, \u3042\u307e\u308a\u5fc5\u8981\u304c\u306a\u3044\u3068\u3053\u308d(\u95a2\u6570\u306e\u52d5\u304d\u304c\u7a4f\u3084\u304b\u306a\u3068\u3053\u308d)\u306f\u5e45\u3092\u5e83\u304f\u3059\u308b\u300d\u3088\u3046\u306a\u51e6\u7406\u3092\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u3067\u3059. \u8aa4\u5dee\u306e\u7cbe\u5ea6\u3092\u4fdd\u3063\u305f\u307e\u307e\u8a08\u7b97\u304c\u65e9\u304f\u306a\u308a\u307e\u3059. \u666e\u901a\u306e1\u6b21\u5143\u7a4d\u5206\u3067\u306f\u305d\u3093\u306a\u306b\u6709\u308a\u96e3\u307f\u304c\u611f\u3058\u3089\u308c\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c, 2\u91cd, 3\u91cd\u7a4d\u5206\u306b\u306a\u308b\u3068Simpson\u7a4d\u5206\u3068\u306f\u6bd4\u3079\u7269\u306b\u306a\u3089\u306a\u3044\u901f\u5ea6\u3067\u3059[^2]. C/C++\u3067\u81ea\u4f5c\u3057\u305fSimpson\u7a4d\u5206\u3088\u308a\u3082\u305a\u3063\u3068\u306f\u3084\u3044\u3067\u3059.\n\n* **\u7a4d\u5206\u533a\u9593\u306b`np.inf`\u3092\u4e0e\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059**\n\n> \u4eca\u56de\u306e\u3088\u3046\u306a\u30b3\u30f3\u30d1\u30af\u30c8\u306a\u95a2\u6570\u306f\u6c42\u3081\u308b\u8a08\u7b97\u7cbe\u5ea6\u306b\u4f9d\u3063\u3066\u3069\u3053\u307e\u3067\u7a4d\u5206\u533a\u9593\u3092\u53d6\u308b\u304b\u304c\u5909\u308f\u308a\u307e\u3059\u304c, `np.inf`\u3092\u4f7f\u3048\u308b\u3053\u3068\u306b\u3088\u3063\u3066, \u30ab\u30c3\u30c8\u30aa\u30d5\u3092\u6c17\u306b\u305b\u305a\u8a08\u7b97\u7cbe\u5ea6\u306f`quad`\u306e\u5f15\u6570`epsabs, epsrel`\u306a\u3069\u306b\u6295\u3052\u3066\u3057\u307e\u3048\u308b\u306e\u304c\u3044\u3044\u3067\u3059\u306d. \n\n* **\u7c21\u5358\u306b\u4f7f\u3048\u307e\u3059**\n\n> \u304a\u305d\u3089\u304fQUADPACK\u3092\u76f4\u63a5\u89e6\u308b\u3088\u308a\u305a\u3063\u3068\u7c21\u5358\u306a\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u3067\u3059[^3].\n\n# \u56fa\u6709\u5024\u65b9\u7a0b\u5f0f\n\u3053\u3053\u304b\u3089\u3061\u3087\u3063\u3068\u91cf\u5b50\u529b\u5b66\u306e\u304a\u8a71\u306b\u306a\u308a\u307e\u3059. \u3042\u308b\u4e00\u6b21\u5143\u8abf\u548c\u632f\u52d5\u5b50\u7cfb\u306e\u56fa\u6709\u95a2\u6570\u3068\u30a8\u30cd\u30eb\u30ae\u30fc\u56fa\u6709\u5024\u3092\u6c42\u3081\u3066\u307f\u307e\u3057\u3087\u3046. \u30cf\u30df\u30eb\u30c8\u30cb\u30a2\u30f3\u306f\n\n```math\nH = \\frac{\\hat{p}^2}{2} + \\frac{\\hat{q}^2}{2} = -\\frac12\\frac{d^2}{dq^2} + \\frac{q^2}{2}\n```\n\u3053\u3093\u306a\u5b50\u3067\u3059. $\\hbar = \\omega = m = 1$\u306e\u5358\u4f4d\u7cfb\u3092\u63a1\u7528\u3057\u3066\u3044\u307e\u3059. \u3053\u306e\u30cf\u30df\u30eb\u30c8\u30cb\u30a2\u30f3\u306b\u5bfe\u3059\u308bSchroedinger\u65b9\u7a0b\u5f0f\n\n```math\nH\\psi_\\ell(q) = E_\\ell\\psi_\\ell(q)\n```\n\u3092\u89e3\u3044\u3066\u307f\u307e\u3057\u3087\u3046. $\\ell$\u306f\u5dee\u5206\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u306f\u306a\u304f, \u56fa\u6709\u5024\u30fb\u56fa\u6709\u95a2\u6570\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u3059. \u307e\u305a\u306f\u30dd\u30c6\u30f3\u30b7\u30e3\u30eb\u9805\u3092\u5dee\u5206\u5316\u3057\u3066\u884c\u5217\u5f62\u5f0f\u306b\u3057\u3066\u3042\u3052\u307e\u3059:\n\n```math\n\t\\frac{q^2}{2}\\psi(q) \\rightarrow \\frac12\n\t\\begin{pmatrix}\n\tq_0^2&0&0&\\cdots&0\\\\ \n\t0&q_1^2 &0&\\cdots&0\\\\\n\t0 & 0&q_2^2&& \\vdots\\\\\n\t\\vdots&&&\\ddots&0\\\\\n\t0& \\cdots& 0 &0& q_n^2\n\t\\end{pmatrix}\n\t\\begin{pmatrix}\n\t\\psi_0\\\\\n\t\\psi_1\\\\\n\t\\vdots\\\\\n\t\\psi_{n-1}\\\\\n\t\\psi_n\n\t\\end{pmatrix}=\\frac12\n\t\\begin{pmatrix}\n\t(-L/2)^2&0&0&\\cdots&0\\\\ \n\t0&(-L/2 + \\Delta q)^2 &0&&0\\\\\n\t0 & 0&(-L/2 + 2\\Delta q)^2&& \\vdots\\\\\n\t\\vdots&&&\\ddots&0\\\\\n\t0& \\cdots& 0 &0& (L/2)^2\n\t\\end{pmatrix}\n\t\\begin{pmatrix}\n\t\\psi_0\\\\\n\t\\psi_1\\\\\n\t\\vdots\\\\\n\t\\psi_{n-1}\\\\\n\t\\psi_n\n\t\\end{pmatrix} = V\\psi\n```\n\u306f\u3058\u3063\u3053\u304c\u4e01\u5ea6$L/2$\u306b\u306a\u308b\u304b\u3069\u3046\u304b\u306f\u308f\u304b\u308a\u307e\u305b\u3093\u304c, \u305d\u3053\u306f\u9069\u5f53\u306b. \u5fae\u5206\u306e\u7ae0\u3067\u3084\u3063\u305f\u3053\u3068\u3092\u601d\u3044\u51fa\u305b\u3070, Schroedinger\u65b9\u7a0b\u5f0f\u306f\n\n```math\nH\\psi = (K + V)\\psi = \\frac12\n\\begin{pmatrix}\n\\frac{2}{\\Delta q^2} + (-L/2)^2&\\frac{-1}{\\Delta q^2}&0&\\cdots&0\\\\ \n\\frac{-1}{\\Delta q^2}&\\frac{2}{\\Delta q^2} + (-L/2 + \\Delta q)^2 &\\frac{-1}{\\Delta q^2}&&0\\\\\n0 & \\frac{-1}{\\Delta q^2}&\\frac{2}{\\Delta q^2} + (-L/2 + 2\\Delta q)^2&& \\vdots\\\\\n\\vdots&&&\\ddots&\\frac{-1}{\\Delta q^2}\\\\\n0& \\cdots& 0 &\\frac{-1}{\\Delta q^2}& \\frac{2}{\\Delta q^2} + (L/2)^2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\psi_0\\\\\n\\psi_1\\\\\n\\vdots\\\\\n\\psi_{n-1}\\\\\n\\psi_n\n\\end{pmatrix} = E_\\ell\\psi\n```\n\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059. \n\n## \u5b9f\u88c5\n\u3055\u3066\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u3059. \n\n```py3\n# \u7cfb\u306e\u8a2d\u5b9a\n>>> L, N = 10, 200\n>>> x, dx = np.linspace(-L/2, L/2, N), L / N\n\n# \u904b\u52d5\u9805K\n>>> K = np.eye(N, N)\n>>> K_sub = np.vstack((K[1:], np.array([0] * N)))\n>>> K = dx**-2 * (2 * K - K_sub - K_sub.T)\n\n# \u30dd\u30c6\u30f3\u30b7\u30e3\u30eb\u9805\n>>> V = np.diag(np.linspace(-L/2, L/2, N)**2)\n\n# \u30a8\u30eb\u30df\u30fc\u30c8\u884c\u5217\u306e\u56fa\u6709\u5024\u65b9\u7a0b\u5f0f\n# w\u304c\u56fa\u6709\u5024, v\u304c\u56fa\u6709\u30d9\u30af\u30c8\u30eb\n>>> H = (K + V) / 2\n>>> w, v = np.linalg.eigh(H)\n```\n`dx`\u306e\u5b9a\u7fa9\u304c\u5fae\u5999\u3067\u3059\u304c, \u6c17\u306b\u305b\u305a\u884c\u304d\u307e\u3057\u3087\u3046:\n\n![figure2.png](https://qiita-image-store.s3.amazonaws.com/0/146775/63bf44c5-210a-6618-8f4f-e8d8ceda9675.png)\n\n\u6559\u79d1\u66f8\u3067\u3082\u3088\u304f\u898b\u308b\u56fa\u6709\u95a2\u6570\u304c\u51fa\u529b\u3055\u308c\u3066\u3044\u307e\u3059.\n`np.linalg.eigh`\u306f\u30a8\u30eb\u30df\u30fc\u30c8\u7528\u306e\u56fa\u6709\u5024\u65b9\u7a0b\u5f0f\u306e\u30bd\u30eb\u30d0\u30fc\u3067, \u56fa\u6709\u5024\u3068\u56fa\u6709\u95a2\u6570\u3092\u8fd4\u3057\u3066\u304f\u308c\u307e\u3059. \u4eca\u56de\u306f3\u91cd\u5bfe\u89d2\u884c\u5217\u306a\u306e\u3067, \u5e2f\u884c\u5217\u7528\u306e`np.linalg.eig_banded`\u3067\u3082\u3088\u3044\u3067\u3059\u304c, \u901f\u5ea6\u306f\u3080\u3057\u308d`np.linalg.eigh`\u306e\u65b9\u304c\u65e9\u3044\u3068\u601d\u3044\u307e\u3059[^4]. \u30e1\u30e2\u30ea\u306e\u6d88\u8cbb\u91cf\u306f`np.linalg.eig_banded`\u306e\u65b9\u304c\u305f\u3076\u3093\u5c11\u306a\u3044\u3067\u3059. \n\n**\u3053\u3053\u3067\u6ce8\u610f\u3057\u305f\u3044\u306e\u304c, \u57fa\u5e95\u72b6\u614b\u30fb\u7b2c\u4e00\u52b1\u8d77\u72b6\u614b\u30fb\u7b2c\u4e8c\u52b1\u8d77\u72b6\u614b...\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u306e\u306f`v[0], v[1], v[2]...`\u3067\u306f\u306a\u304f, `v.T[0], v.T[1], v.T[2]...`\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059.** \u3053\u308c\u306f\u914d\u5217\u30c7\u30fc\u30bf\u306e\u30e1\u30e2\u30ea\u3078\u306e\u683c\u7d0d\u304cC\u7cfb\u304cRow-major\u3067\u3042\u308a, Fortran\u304cColumn-major\u3067\u3042\u308b\u98df\u3044\u9055\u3044\u304c\u6050\u3089\u304f\u539f\u56e0\u3067\u3059. `np.linalg.eigh`\u304cLAPACK\u306e\u30e9\u30c3\u30d1\u30fc\u3067\u3042\u308b\u306a\u3089\u3042\u308b\u610f\u5473\u81ea\u7136\u306a\u6319\u52d5\u3068\u8a00\u3048\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093. \n\n\u56fa\u6709\u5024\u306e\u5dee\u5206\u3092\u8a08\u7b97\u3057\u3066\u52b1\u8d77\u30a8\u30cd\u30eb\u30ae\u30fc\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u3087\u3046. \u57fa\u5e95\u304b\u308920\u500b\u307b\u3069\u51fa\u529b\u3057\u3066\u307f\u307e\u3059:\n\n```py3\n>>> np.diff(w)[:20]\n[ 1.00470938  1.00439356  1.00407832  1.00376982  1.00351013  1.00351647\n  1.00464172  1.00938694  1.02300462  1.05279364  1.10422331  1.17688369\n  1.26494763  1.36132769  1.46086643  1.56082387  1.66005567  1.75820017\n  1.85521207  1.95115074]\n```\n\u8abf\u548c\u632f\u52d5\u5b50\u7cfb\u306e\u52b1\u8d77\u30a8\u30cd\u30eb\u30ae\u30fc\u306f\u6e96\u4f4d\u306b\u4f9d\u3089\u305a$\\hbar\\omega$\u306a\u306e\u3067, \u4eca\u56de\u306e\u5358\u4f4d\u7cfb\u3067\u306f1\u3067\u3059. \u4f4e\u30a8\u30cd\u30eb\u30ae\u30fc\u9818\u57df\u3067\u306f\u5272\u3068\u826f\u304f\u518d\u73fe\u3055\u308c\u3066\u3044\u307e\u3059\u304c, \u9ad8\u30a8\u30cd\u30eb\u30ae\u30fc\u9818\u57df\u3067\u306f\u304b\u306a\u308a\u602a\u3057\u304f\u306a\u3063\u3066\u307e\u3059. \u8a66\u3057\u306b\u7b2c15\u52b1\u8d77\u72b6\u614b\u3092\u51fa\u529b\u3057\u3066\u307f\u307e\u3057\u3087\u3046:\n\n![figure3.png](https://qiita-image-store.s3.amazonaws.com/0/146775/b90db706-7f4a-ea86-6347-61ee1cee7dd8.png)\n\n\u7bc0\u306e\u6570\u306f\u3061\u3083\u3093\u306815\u500b\u3042\u308a\u307e\u3059\u304c, \u7aef\u3063\u3053\u3067\u95a2\u6570\u304c\u30b3\u30f3\u30d1\u30af\u30c8\u306b\u306a\u3063\u3066\u3044\u307e\u305b\u3093. \u3068\u3044\u3046\u308f\u3051\u3067, \u7a7a\u9593\u306e\u30b5\u30a4\u30ba\u304c$L=10$\u3067\u306f\u8db3\u308a\u306a\u304b\u3063\u305f\u308f\u3051\u3067\u3059. \u3069\u306e\u52b1\u8d77\u72b6\u614b\u307e\u3067\u3092\u7cbe\u5ea6\u3088\u304f\u8a08\u7b97\u3057\u305f\u3044\u304b\u306b\u3088\u3063\u3066\u7a7a\u9593\u306e\u30b5\u30a4\u30ba\u3084\u5206\u5272\u6570\u3092\u5909\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059. \n\n\u8abf\u548c\u632f\u52d5\u5b50\u306e\u56fa\u6709\u5024\u30fb\u56fa\u6709\u95a2\u6570\u3092\u89e3\u6790\u7684\u306b\u8a08\u7b97\u3059\u308b\u306e\u306f\u305d\u3053\u305d\u3053\u9aa8\u304c\u6298\u308c\u308b\u4f5c\u696d\u3067\u3059\u304c, \u6570\u5024\u8a08\u7b97\u306b\u6295\u3052\u3066\u3042\u3052\u308b\u3068\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u3067\u3059\u306d[^5]. \n\n# \u5fae\u5206\u65b9\u7a0b\u5f0f\n1\u6b21\u5143\u306e\u62e1\u6563\u65b9\u7a0b\u5f0f\n\n```math\n\\frac{\\partial}{\\partial t}f(x, t) = \\frac{\\partial^2}{\\partial x^2}f(x, t)\n```\n\n\u3092\u89e3\u3044\u3066\u307f\u307e\u3057\u3087\u3046. \u3053\u306e\u5b50\u306f\u521d\u671f\u6761\u4ef6\u304c\u4e0e\u3048\u3089\u308c\u308c\u3070$x$\u306eFourier\u5909\u63db\u3092\u901a\u3058\u3066\u89e3\u6790\u89e3\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059[^6]\u304c, \u3082\u3061\u308d\u3093\u4eca\u56de\u306f\u6570\u5024\u8a08\u7b97\u3067\u89e3\u3044\u3066\u307f\u307e\u3057\u3087\u3046. \u521d\u671f\u6761\u4ef6\u3092\u30ac\u30a6\u30b7\u30a2\u30f3\u3067\u4e0e\u3048\u3066, \u304a\u6c7a\u307e\u308a\u306e\u7a7a\u9593\u306e\u5dee\u5206\u5316\u304b\u3089\u306f\u3058\u3081\u307e\u3057\u3087\u3046:\n\n```math\nf(x, 0) = \\exp(-x^2)\\\\\nf_k \\equiv f(k\\Delta x, t), \\hspace{0.7cm} \\Delta x = L/N\n```\n\u305d\u3046\u3059\u308b\u3068, \u5fae\u5206\u65b9\u7a0b\u5f0f\u3082\u307e\u305f\u5dee\u5206\u5316\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059:\n\n```math\n\\frac{d}{dt}f_0 = \\frac{f_1 - 2f_0}{\\Delta x^2}\\\\\n\\frac{d}{dt}f_1 = \\frac{f_2 - 2f_1 + f_0}{\\Delta x^2}\n...\\\\\n\\frac{d}{dt}f_k = \\frac{f_{k+1} - 2f_k + f_{k-1}}{\\Delta x^2}\\\\\n...\\\\\n\\frac{d}{dt}f_{n-1} = \\frac{f_{n} - 2f_{n-1} + f_{n-2}}{\\Delta x^2}\\\\\n\\frac{d}{dt}f_n = \\frac{-2f_n + f_{n-1}}{\\Delta x^2}\n```\nSciPy\u306b\u306f, \u3042\u308b\u95a2\u6570\u306e\u5dee\u5206\u5316\u306e\u30ea\u30b9\u30c8`[f0, f1, ... , fn-1, fn]`\u3092\u5f15\u6570\u306b\u3068\u308a, $\\Delta t$\u3060\u3051\u6642\u9593\u767a\u5c55\u3055\u305b\u305f\u5f8c\u306e\u30ea\u30b9\u30c8(`ndarray`)\u3092\u623b\u308a\u5024\u3068\u3059\u308b\u3088\u3046\u306a\u95a2\u6570\u3092\u6e21\u3057\u3066\u3042\u3052\u308b\u3053\u3068\u3067\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u308b**`odeint`\u3068\u3044\u3046\u5fae\u5206\u65b9\u7a0b\u5f0f\u306e\u30bd\u30eb\u30d0\u30fc\u304c\u3042\u308a\u307e\u3059.** \n\n## \u5b9f\u88c5\n\u307e\u305a\u306f\u305d\u306e\u95a2\u6570\u3092\u4f5c\u3063\u3066\u3042\u3052\u307e\u3057\u3087\u3046.:\n\n```py3\nfrom scipy.integrate import odeint\n\ndef equation(f, t=0, N, L):\n    dx = L / N\n    gamma = dx**-2\n    i = np.arange(1, N, 1)\n    \n    # f0\n    arr = np.array(gamma * (f[1] - 2 * f[0]))\n    # f1 to fN-1\n    arr = np.append(arr, gamma * (f[i+1] - 2 * f[i] + f[i-1]))\n    # fN\n    arr = np.append(arr, gamma * (-2 * f[N] + f[N-1]))\n\n    return arr\n```\n\u4f55\u3092\u3084\u3063\u3066\u3044\u308b\u304b\u306f\u306a\u3093\u3068\u306a\u304f\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059. \u3053\u306e\u95a2\u6570\u5185\u3067\u306f, \u5dee\u5206\u5316\u3057\u305f$f$\u3092`f[n]`\u306e\u3088\u3046\u306a\u914d\u5217\u306e\u5f62\u3067\u66f8\u3044\u3066\u3042\u3052\u307e\u3059. `f`\u306f`f[0]`\u304b\u3089`f[N]`\u306e$N+1$\u500b\u306e\u8981\u7d20\u304b\u3089\u6210\u308a\u307e\u3059. \u307e\u305f, \u7b2c\u4e00\u5f15\u6570\u306b\u95a2\u6570\u3092\u5dee\u5206\u5316\u3057\u305f\u30ea\u30b9\u30c8`f`, \u7b2c\u4e8c\u5f15\u6570\u306b\u6642\u9593`t`\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u306e\u306f, `odeint`\u306e\u4ed5\u69d8\u3067\u3059. \u304b\u306a\u3089\u305a\u3053\u306e\u9806\u756a\u306b\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044. \u521d\u671f\u6642\u523b\u306f\u3082\u3061\u308d\u3093$t = 0$\u306a\u306e\u3067, \u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059. **`# f1 to fN-1`\u306e\u3068\u3053\u308d\u3067, `[gamma * (f[j+1] - 2 * f[j] + f[j-1]) for j in i]`\u3068\u66f8\u304b\u305a\u306b, \u305f\u3060`ndarray`\u3067\u3042\u308b`i`\u3092\u30ea\u30b9\u30c8\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u5165\u308c\u308b\u3060\u3051\u3067OK\u3068\u3044\u3046\u306e\u306f\u5730\u5473\u306b\u3059\u3054\u3044\u3068\u601d\u3044\u307e\u3059.**\n\n**-- \u8ffd\u8a18(2016/12/3) --**\n\u7d50\u5c402\u968e\u5fae\u5206\u3092\u3059\u308b\u3060\u3051\u306a\u306e\u3067\n\n```py3\nfrom scipy.integrate import odeint\n\ndef equation(f, t=0, N, L):\n    dx = L / N\n    arr = np.gradient(np.gradient(f, dx), dx)\n\n    return arr\n```\n\u3067\u3088\u304b\u3063\u305f\u3067\u3059\u306d. `gradient`\u306f`diff`\u3068\u9055\u3063\u3066, \u51e6\u7406\u5f8c\u306b\u30ea\u30b9\u30c8\u306e\u30b5\u30a4\u30ba\u304c\u5909\u308f\u3089\u306a\u3044\u3068\u3053\u308d\u304c\u7d20\u6674\u3089\u3057\u3044\u3067\u3059. \n**-- \u8ffd\u8a18\u3053\u3053\u307e\u3067 --**\n\n\u3061\u306a\u307f\u306b, \u521d\u671f\u95a2\u6570\u306f\n\n```py3\ndef f(x):\n    return np.exp(-x**2)\n```\n\u3067\u3057\u305f\u306d.\n\n\u307e\u305f, `odeint`\u81ea\u8eab\u3082\u6e21\u3055\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u5909\u6570\u304c\u3042\u308b\u7a0b\u5ea6\u6c7a\u307e\u3063\u3066\u3044\u307e\u3059. \u3072\u3068\u3064\u306f\u4e0a\u3067\u5b9a\u7fa9\u3057\u305f`equation(f, t0, ...)`, \u3075\u305f\u3064\u3081\u306f\u306b\u306f\u521d\u671f\u95a2\u6570\u3092\u5dee\u5206\u5316\u3057\u305f`ndarray`(iterable\u306a\u3089\u826f\u3044\u307f\u305f\u3044\u3067\u3059), \u307f\u3063\u3064\u3081\u306f\u8a08\u7b97\u3059\u308b\u6642\u523b`t`\u306e\u30ea\u30b9\u30c8\u3067\u3059. \u3055\u3089\u306b, `equation`\u306f`f`\u3068`t0`\u4ee5\u5916\u306b\u3082\u5909\u6570\u3092\u6301\u3063\u3066\u3044\u308b\u306e\u3067, \u305d\u308c\u3089\u306e\u5b58\u5728\u3092`odeint`\u306b\u6559\u3048\u3066\u3042\u3052\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306e\u3067, \u305d\u306e\u60c5\u5831\u3092`args`\u306b\u683c\u7d0d\u3057\u307e\u3059. \u3053\u308c\u3089\u3092\u8e0f\u307e\u3048\u3066\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059:\n\n```py3\n# initial parameter(optional)\nN, L = 200, 40\n\n# coordinate\nq = np.linspace(-L/2, L/2, N)\n                                \n# initial value for each fk\nfk_0 = f(q)\n\n# time\nt_max, t_div = 10, 5\nt = np.linspace(0, t_max, t_div)\n\ntrajectories = odeint(equation, fk_0, t, args=(N, L))\n```\n`t[i]`\u306e\u6642\u523b\u306e\u89e3\u304c`trajectories[i]`\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059. \u3055\u3066, \u3053\u308c\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u307e\u3059:\n\n![figure4.png](https://qiita-image-store.s3.amazonaws.com/0/146775/18e75ecf-75ee-abb2-a756-362bef476362.png)\n\n\u30ac\u30a6\u30b9\u30b7\u30a2\u30f3\u304c\u62e1\u6563\u3059\u308b\u69d8\u5b50\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f. \u4eca\u56de\u306f\u62e1\u6563\u65b9\u7a0b\u5f0f\u3092\u6271\u3063\u305f\u306e\u3067, $(x, t)$\u306e2\u5909\u6570\u3067\u5c11\u3057\u3084\u3084\u3053\u3057\u3044\u30b3\u30fc\u30c9\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f. \u666e\u901a\u306e1\u5909\u6570\u306e\u5fae\u5206\u65b9\u7a0b\u5f0f\u306a\u3089\u3082\u3063\u3068\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059. \u30d7\u30ed\u30c3\u30c8\u3059\u308b\u3068\u304d\u306f\u3055\u3059\u304c\u306bfor\u30eb\u30fc\u30d7\u3092\u4f7f\u3044\u307e\u3059\u304c...\u305d\u308c\u306f\u3044\u3044\u3067\u3057\u3087\u3046. \u6570\u5024\u8a08\u7b97\u306e\u904e\u7a0b\u3067for\u30eb\u30fc\u30d7(\u30ea\u30b9\u30c8\u5185\u5305\u3082\u542b\u3080)\u3092\u4f7f\u3063\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u91cd\u8981\u3067\u3059. \n\n# \u304a\u308f\u308a\u306b\n\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067, \u7d9a\u304d\u306f\u307e\u305f\u5225\u8a18\u4e8b\u306b\u307e\u3068\u3081\u308b\u3053\u3068\u306b\u3057\u307e\u3059. \u300c\u3082\u3063\u3068\u4e0a\u624b\u3044\u65b9\u6cd5\u304c\u3042\u308b\u3088\uff01\u300d\u3068\u3044\u3046\u65b9\u304c\u3044\u3089\u3063\u3057\u3083\u3063\u305f\u3089\u662f\u975e\u30b3\u30e1\u30f3\u30c8\u3092\u9802\u3051\u308b\u3068\u5b09\u3057\u3044\u3067\u3059. \n\n\u601d\u3063\u305f\u4ee5\u4e0a\u306bNumPy\u30fbSciPy\u306e\u5b88\u5099\u7bc4\u56f2\u304c\u5e83\u3044\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059. \u300c\u3082\u3057\u304b\u3057\u305f\u3089...\u300d\u3068\u601d\u3063\u3066\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3092\u63a2\u308b\u3068, \u304b\u3064\u3066\u81ea\u5206\u3067\u5b9f\u88c5\u3057\u3066\u3044\u305f\u3082\u306e\u304c\u65e2\u306b\u3042\u3063\u305f[^7]\u3068\u3044\u3046\u3053\u3068\u306f\u3088\u304f\u3042\u308b\u3053\u3068\u3067\u3059. **\u305d\u308c\u306fNumPy\u30fbSciPy\u3060\u3051\u3067\u306a\u304f, Python\u306e\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u3082\u5f53\u3066\u306f\u307e\u308a\u307e\u3059.** \u662f\u975ePython\u306e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3082\u76ee\u3092\u901a\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044. \u300c\u3053\u3093\u306a\u306e\u3082\u3042\u3063\u305f\u306e\u304b\u300d\u3068\u9a5a\u304f\u3088\u3046\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5fc5\u305a\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3088.\n\n**\u8ffd\u8a18(2016/11/25): \u4ee5\u4e0b\u306b\u7d9a\u304d\u307e\u3059**\n[NumPy\u30fbSciPy\u3092\u7528\u3044\u305f\u6570\u5024\u8a08\u7b97\u306e\u9ad8\u901f\u5316 : \u5fdc\u7528\u305d\u306e2] (http://qiita.com/jabberwocky0139/items/26451d7942777d0001f1)\n\n\n\n[^1]: QUADPACK\u3092\u30e9\u30c3\u30d7\u3057\u3066\u3044\u308b\u306e\u304b\u3069\u3046\u304b\u306f\u8abf\u3079\u3066\u3044\u307e\u305b\u3093. \u30de\u30cb\u30e5\u30a2\u30eb\u306b\u306f\u300c...using a technique from the Fortran library QUADPACK.\u300d\u3068\u3042\u308a\u307e\u3059. \n\n[^2]: 7\u91cd, 8\u91cd\u3068\u304b\u3060\u3068\u3055\u3059\u304c\u306b\u30e2\u30f3\u30c6\u30ab\u30eb\u30ed\u306e\u65b9\u304c\u306f\u3084\u3044\u3068\u601d\u3044\u307e\u3059. \n\n[^3]: \u4f7f\u3063\u305f\u3053\u3068\u304c\u306a\u3044\u306e\u3067\u6b63\u76f4\u308f\u304b\u308a\u307e\u305b\u3093. \n\n[^4]: \u30d0\u30f3\u30c9\u884c\u5217\u306e\u30bd\u30eb\u30d0\u30fc\u306f\u7d50\u5c40\u5e2f\u3067\u6e21\u3057\u305f\u3082\u306e\u3092\u884c\u5217\u5f62\u5f0f\u306b\u5c55\u958b\u3057\u3066\u304b\u3089\u8a08\u7b97\u3059\u308b\u3088\u3046\u3067\u3059. \u305d\u3046\u306a\u308b\u3068\u7d50\u5c40\u30e1\u30e2\u30ea\u6d88\u8cbb\u91cf\u3082\u5909\u308f\u3089\u306a\u3044\u6c17\u304c\u3057\u307e\u3059\u304c...\u8a73\u3057\u304f\u306f\u3088\u304f\u77e5\u3089\u306a\u3044\u3067\u3059. \n\n[^5]: \u3082\u3061\u308d\u3093\u7269\u7406\u5c4b\u3055\u3093\u306f\u6570\u5024\u8a08\u7b97\u306b\u6295\u3052\u3066\u6e80\u8db3\u3057\u3066\u3044\u3066\u306f\u3044\u3051\u307e\u305b\u3093. \u6570\u5024\u8a08\u7b97\u3060\u3051\u3067\u306f\u5b9a\u6027\u7684\u306a\u8b70\u8ad6\u304c\u3067\u304d\u306a\u3044\u306e\u3067, \u53b3\u5bc6\u306b\u89e3\u3051\u306a\u3044\u7cfb\u3067\u3082\u8fd1\u4f3c\u3059\u308b\u306a\u308a\u3057\u3066\u89e3\u6790\u7684\u306a\u89e3\u3092\u51fa\u3059\u3053\u3068\u306b\u5927\u304d\u306a\u610f\u5473\u304c\u3042\u308a\u307e\u3059. \n\n[^6]: \u96fb\u5b50\u56de\u8def\u3067\u30e9\u30d7\u30e9\u30b9\u5909\u63db\u3092\u901a\u3058\u3066\u5fae\u5206\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u3053\u3068\u304c\u3088\u304f\u3042\u308a\u307e\u3059\u304c, \u672c\u8cea\u7684\u306b\u306f\u305d\u308c\u3068\u540c\u3058\u3067\u3059.  \u89e3\u6790\u7684\u306b\u7a4d\u5206\u304c\u3067\u304d\u306a\u3044\u521d\u671f\u95a2\u6570\u3092\u7528\u610f\u3059\u308b\u3068\u7d50\u5c40\u6570\u5024\u7684\u306b\u89e3\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059. \u305d\u3046\u3044\u3063\u305f\u610f\u5473\u3067\u30ac\u30a6\u30b7\u30a2\u30f3\u306f\u30b3\u30f3\u30d1\u30af\u30c8\u3067\u89e3\u6790\u7684\u306b\u7a4d\u5206\u3067\u304d\u308b, \u3068\u3066\u3082\u6027\u8cea\u306e\u826f\u3044\u95a2\u6570\u3067\u3059. \n\n[^7]: \u305d\u3057\u3066\u5f80\u3005\u306b\u3057\u3066, \u81ea\u5206\u304c\u5b9f\u88c5\u3057\u305f\u3082\u306e\u3088\u308a\u3082\u9065\u304b\u306b\u9ad8\u6027\u80fd\u3067\u3059.\n", "tags": ["Python", "python3", "numpy", "scipy", "\u6570\u5024\u8a08\u7b97"]}