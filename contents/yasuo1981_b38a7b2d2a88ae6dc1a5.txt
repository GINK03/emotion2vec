{"context": " More than 1 year has passed since last update.\n\nCakePHP 3 Advent Calendar 2015 15\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u3092\u7121\u6599\u3067\u4f7f\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u3001ZOHO\u30e1\u30fc\u30eb\u3092\u9078\u629e\u3057\u307e\u3057\u305f\u3002\n\u305d\u3053\u3067\u3001CakePHP3\u3067\u30b3\u30f3\u30bf\u30af\u30c8\u30d5\u30a9\u30fc\u30e0\u3092\u7c21\u5358\u306b\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n1.\u958b\u767a\u74b0\u5883\n\u30b5\u30fc\u30d0\uff1a\u3055\u304f\u3089VPS\n\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\uff1aZOHO\u30e1\u30fc\u30eb\n\n2.ZOHO\u30e1\u30fc\u30eb\n\u7121\u6599\u30d7\u30e9\u30f3\u3067\u3001\uff13\u30e6\u30fc\u30b6\u30fc\u307e\u3067\u4f5c\u308c\u307e\u3059\nhttps://www.zoho.com/mail/\nZOHO\u306e\u521d\u671f\u8a2d\u5b9a\u306f\u3001\u3059\u3067\u306b\u305f\u304f\u3055\u3093\u60c5\u5831\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u53c2\u8003\u306b\nhttp://appstars.jp/archive/123\n\u3055\u304f\u3089VPS\u306e\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306e\u5834\u6240\n\u3055\u304f\u3089VPS\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d1\u30cd\u30eb > \u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u767b\u9332\n\n3.\u30e1\u30fc\u30eb\u306e\u8a2d\u5b9a\u304c\u51fa\u6765\u305f\u304b\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\n\u203b example.com\u306f\u8abf\u3079\u305f\u3044\u30c9\u30e1\u30a4\u30f3\n$ nslookup -type=mx example.com\n\n\u7d50\u679c\u304c\u3001\u4e0b\u8a18\u5185\u5bb9\u3067\u3042\u308c\u3070\u8a2d\u5b9a\u5b8c\u4e86\nNon-authoritative answer:\nexample.com mail exchanger = 20 mx2.zohomail.com.\nexample.com mail exchanger = 10 mx.zohomail.com.\n\n\n4.\u30b3\u30fc\u30c9\n\nconfig\u306e\u8a2d\u5b9a\n\nsrc/config/app.php\n'EmailTransport' => [\n    'default' => [\n        \u5909\u66f4\u306a\u3057\n    ],\n    'zoho' => [\n        'className' => 'Smtp',\n        'host' => 'ssl://smtp.zoho.com',\n        'port' => 465,\n        'timeout' => 30,\n        'username' => 'info@example.com',\n        'password' => '\u30d1\u30b9\u30ef\u30fc\u30c9',\n        'client' => null,\n        'tls' => null,\n    ],\n],\n\n\n\nForm\u306e\u8a2d\u5b9a\n\nsrc/Form/ContactForm.php\nnamespace App\\Form;\n\nuse Cake\\Form\\Form;\nuse Cake\\Form\\Schema;\nuse Cake\\Validation\\Validator;\nuse Cake\\Network\\Email\\Email;\n\nclass ContactForm extends Form\n{\n    protected function _buildSchema(Schema $schema)\n    {\n        return $schema->addField('name', 'string')\n            ->addField('email', ['type' => 'string'])\n            ->addField('message', ['type' => 'text']);\n    }\n\n    protected function _buildValidator(Validator $validator)\n    {\n        return $validator\n            ->notEmpty('name', '\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044')\n            ->add('name', 'length', [\n                'rule' => ['minLength', 4],\n                'message' => '\u540d\u524d\u306f4\u6587\u5b57\u4ee5\u4e0a\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002'\n            ])\n            ->notEmpty('email', '\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044')\n            ->add('email', 'format', [\n                'rule' => 'email',\n                'message' => '\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002',\n            ]);\n    }\n\n    protected function _execute(array $data)\n    {\n        $email = new Email('default');\n        $email->transport('zoho');\n        $email->template('contact');\n        $email->viewVars([\n            'name' => $data['name'],\n            'email' => $data['email'],\n            'message' => $data['message']\n        ]);\n        $email->from(['info@example.jp' => '\u5dee\u51fa\u4eba\u540d']);\n        $email->to($data['email']);\n        $email->subject('\u4ef6\u540d');\n        $email->send();\n        return true;\n    }\n}\n\n\n\nEmail\u306e\u8a2d\u5b9a\n\nsrc/Template/Email/text/contact.ctp\n\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067\u9001\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002\n\n--------------------------\nName: <?= $name.\"\\n\" ?>\nEmail: <?= $email.\"\\n\" ?>\nMessage:\n<?= $message.\"\\n\" ?>\n--------------------------\n\n\n\nController\u306e\u8a2d\u5b9a\n\nsrc/Controller/ContactsController.php\n<?php\nnamespace App\\Controller;\n\nuse App\\Controller\\AppController;\nuse App\\Form\\ContactForm;\n\nclass ContactsController extends AppController\n{\n    public function index()\n    {\n        $contact = new ContactForm();\n        if ($this->request->is('post')) {\n            $contact->execute($this->request->data);\n        }\n\n        $this->set('contact', $contact);\n    }\n}\n\n\n\nView\u306e\u8a2d\u5b9a\n\nsrc/Template/Contacts/index.ctp\n<?php echo $this->Form->create($contact); ?>\n<?php echo $this->Form->input('name'); ?>\n<?php echo $this->Form->input('email'); ?>\n<?php echo $this->Form->input('message'); ?>\n<?php echo $this->Form->button('Submit'); ?>\n<?php echo $this->Form->end(); ?>\n\n\n\n\u307e\u3068\u3081\nZOHO\u3067\u306e\u30c9\u30e1\u30a4\u30f3\u8a8d\u8a3c\u3067\u3001\u3064\u307e\u305a\u3044\u3066\u5b9f\u88c5\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3057\u305f\u3002\nCakePHP3.x\u306e\u8a18\u4e8b\u304c2.x\u306b\u6bd4\u3079\u308b\u3068\u5c11\u306a\u3044\u306e\u3067\u3001\u3082\u3063\u3068\u5897\u3048\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\n\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\nhttp://qiita.com/kozo/items/00e66e8d0c3dbbfc907c\nhttp://qiita.com/milano/items/7a71b09e891f87b8f62e\n# [CakePHP 3 Advent Calendar 2015](http://qiita.com/advent-calendar/2015/cakephp3) 15\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u3092\u7121\u6599\u3067\u4f7f\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u3001ZOHO\u30e1\u30fc\u30eb\u3092\u9078\u629e\u3057\u307e\u3057\u305f\u3002\n\u305d\u3053\u3067\u3001CakePHP3\u3067\u30b3\u30f3\u30bf\u30af\u30c8\u30d5\u30a9\u30fc\u30e0\u3092\u7c21\u5358\u306b\u4f5c\u6210\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## 1.\u958b\u767a\u74b0\u5883\n\u30b5\u30fc\u30d0\uff1a\u3055\u304f\u3089VPS\n\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\uff1aZOHO\u30e1\u30fc\u30eb\n\n\n## 2.ZOHO\u30e1\u30fc\u30eb\n\u7121\u6599\u30d7\u30e9\u30f3\u3067\u3001\uff13\u30e6\u30fc\u30b6\u30fc\u307e\u3067\u4f5c\u308c\u307e\u3059\nhttps://www.zoho.com/mail/\n\nZOHO\u306e\u521d\u671f\u8a2d\u5b9a\u306f\u3001\u3059\u3067\u306b\u305f\u304f\u3055\u3093\u60c5\u5831\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u53c2\u8003\u306b\nhttp://appstars.jp/archive/123\n\n**\u3055\u304f\u3089VPS\u306e\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306e\u5834\u6240**\n\u3055\u304f\u3089VPS\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30d1\u30cd\u30eb > \u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u767b\u9332\n\n\n## 3.\u30e1\u30fc\u30eb\u306e\u8a2d\u5b9a\u304c\u51fa\u6765\u305f\u304b\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\n\n\u203b example.com\u306f\u8abf\u3079\u305f\u3044\u30c9\u30e1\u30a4\u30f3\n\n```\n$ nslookup -type=mx example.com\n```\n\n\u7d50\u679c\u304c\u3001\u4e0b\u8a18\u5185\u5bb9\u3067\u3042\u308c\u3070\u8a2d\u5b9a\u5b8c\u4e86\n\n```\nNon-authoritative answer:\nexample.com\tmail exchanger = 20 mx2.zohomail.com.\nexample.com\tmail exchanger = 10 mx.zohomail.com.\n```\n\n## 4.\u30b3\u30fc\u30c9\n\n### config\u306e\u8a2d\u5b9a\n\n```src/config/app.php\n'EmailTransport' => [\n    'default' => [\n        \u5909\u66f4\u306a\u3057\n    ],\n    'zoho' => [\n        'className' => 'Smtp',\n        'host' => 'ssl://smtp.zoho.com',\n        'port' => 465,\n        'timeout' => 30,\n        'username' => 'info@example.com',\n        'password' => '\u30d1\u30b9\u30ef\u30fc\u30c9',\n        'client' => null,\n        'tls' => null,\n    ],\n],\n```\n\n### Form\u306e\u8a2d\u5b9a\n\n```src/Form/ContactForm.php\nnamespace App\\Form;\n\nuse Cake\\Form\\Form;\nuse Cake\\Form\\Schema;\nuse Cake\\Validation\\Validator;\nuse Cake\\Network\\Email\\Email;\n\nclass ContactForm extends Form\n{\n    protected function _buildSchema(Schema $schema)\n    {\n        return $schema->addField('name', 'string')\n            ->addField('email', ['type' => 'string'])\n            ->addField('message', ['type' => 'text']);\n    }\n\n    protected function _buildValidator(Validator $validator)\n    {\n        return $validator\n            ->notEmpty('name', '\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044')\n            ->add('name', 'length', [\n                'rule' => ['minLength', 4],\n                'message' => '\u540d\u524d\u306f4\u6587\u5b57\u4ee5\u4e0a\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002'\n            ])\n            ->notEmpty('email', '\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044')\n            ->add('email', 'format', [\n                'rule' => 'email',\n                'message' => '\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002',\n            ]);\n    }\n\n    protected function _execute(array $data)\n    {\n        $email = new Email('default');\n        $email->transport('zoho');\n        $email->template('contact');\n        $email->viewVars([\n            'name' => $data['name'],\n            'email' => $data['email'],\n            'message' => $data['message']\n        ]);\n        $email->from(['info@example.jp' => '\u5dee\u51fa\u4eba\u540d']);\n        $email->to($data['email']);\n        $email->subject('\u4ef6\u540d');\n        $email->send();\n        return true;\n    }\n}\n```\n\n### Email\u306e\u8a2d\u5b9a\n```src/Template/Email/text/contact.ctp\n\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067\u9001\u4fe1\u3055\u308c\u307e\u3057\u305f\u3002\n \n--------------------------\nName: <?= $name.\"\\n\" ?>\nEmail: <?= $email.\"\\n\" ?>\nMessage:\n<?= $message.\"\\n\" ?>\n--------------------------\n```\n\n### Controller\u306e\u8a2d\u5b9a\n\n```src/Controller/ContactsController.php\n<?php\nnamespace App\\Controller;\n\nuse App\\Controller\\AppController;\nuse App\\Form\\ContactForm;\n\nclass ContactsController extends AppController\n{\n    public function index()\n    {\n        $contact = new ContactForm();\n        if ($this->request->is('post')) {\n            $contact->execute($this->request->data);\n        }\n\n        $this->set('contact', $contact);\n    }\n}\n```\n### View\u306e\u8a2d\u5b9a\n\n```php:src/Template/Contacts/index.ctp\n<?php echo $this->Form->create($contact); ?>\n<?php echo $this->Form->input('name'); ?>\n<?php echo $this->Form->input('email'); ?>\n<?php echo $this->Form->input('message'); ?>\n<?php echo $this->Form->button('Submit'); ?>\n<?php echo $this->Form->end(); ?>\n```\n\n\n# \u307e\u3068\u3081\nZOHO\u3067\u306e\u30c9\u30e1\u30a4\u30f3\u8a8d\u8a3c\u3067\u3001\u3064\u307e\u305a\u3044\u3066\u5b9f\u88c5\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3057\u305f\u3002\nCakePHP3.x\u306e\u8a18\u4e8b\u304c2.x\u306b\u6bd4\u3079\u308b\u3068\u5c11\u306a\u3044\u306e\u3067\u3001\u3082\u3063\u3068\u5897\u3048\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\n\n**\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8**\nhttp://qiita.com/kozo/items/00e66e8d0c3dbbfc907c\nhttp://qiita.com/milano/items/7a71b09e891f87b8f62e\n", "tags": ["cakephp3", "CakePHP", "PHP"]}