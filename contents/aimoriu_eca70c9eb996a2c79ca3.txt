{"tags": ["VBA"], "context": "pearltrees\nhttp://www.pearltrees.com/yuaisheng/tree/id9610952\nExcelVBA \u9006\u5f15\u304d\u5927\u5168 620\u306e\u6975\u610f\nhttp://www.shuwasystem.co.jp/support/7980html/2744.html\nWindows Forms\nhttps://en.wikipedia.org/wiki/Windows_Forms\nIE Automation Library and Web Macro Recorder\nhttp://codecentrix.blogspot.jp/\nhttp://codecentrix.com/\nVBA\u306b\u3088\u308bIE\u81ea\u52d5\u5236\u5fa1\nhttp://vba-code.net/ie/click-an-image/\n\n'\u65e5\u7d4c\u5e73\u5747\u306e\u30c1\u30e3\u30fc\u30c8\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\nSub ClickNikkeiChart()\n    Dim objIE As Object\n\n    'IE\u8d77\u52d5\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    objIE.Visible = True\n\n    'Yahoo\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u306b\u63a5\u7d9a\n    objIE.navigate \"http://finance.yahoo.co.jp/\"\n\n    'IE\u3092\u5f85\u6a5f\n    Call IEWait(objIE)\n\n    '5\u79d2\u505c\u6b62\n    Call WaitFor(5)\n\n    '\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u30c1\u30e3\u30fc\u30c8\u753b\u50cf\u3092\u30af\u30ea\u30c3\u30af\n    Call IEImageClick(objIE, \"s?s=998407.O\")\n\n    'IE\u3092\u5f85\u6a5f\n    Call IEWait(objIE)\n\n    '5\u79d2\u505c\u6b62\n    Call WaitFor(5)\n\n    'IE\u7d42\u4e86\n    objIE.Quit\n\n    Set objIE = Nothing\nEnd Sub\n\n'\u753b\u50cf\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u95a2\u6570\nPublic Function IEImageClick(ByRef objIE As Object, imageSrc As String)\n    Dim objImage As Object\n    For Each objImage In objIE.Document.getElementsByTagName(\"IMG\")\n        If InStr(objImage.src, imageSrc) &gt; 0 Then\n            objImage.Click\n            Exit For\n        End If\n    Next\nEnd Function\n\n'IE\u3092\u5f85\u6a5f\u3059\u308b\u95a2\u6570\nFunction IEWait(ByRef objIE As Object)\n    Do While objIE.Busy = True Or objIE.readyState  4\n        DoEvents\n    Loop\nEnd Function\n\n'\u6307\u5b9a\u3057\u305f\u79d2\u3060\u3051\u505c\u6b62\u3059\u308b\u95a2\u6570\nFunction WaitFor(ByVal second As Integer)\n    Dim futureTime As Date\n\n    futureTime = DateAdd(\"s\", second, Now)\n    While Now &lt; futureTime\n       DoEvents\n    Wend\nEnd Function\n\nfunction WaitForLoad($ie)\n{\n    while($ie.Busy)\n    {\n        sleep -Milliseconds 50\n    }\n}\n\n$ie = New-Object -COM InternetExplorer.Application\n$ie.Navigate(\"http://www.google.com\")\n$ie.Visible = $true\nWaitForLoad($ie)\n$searchBox = $ie.Document.getElementById(\"q\")\n$searchBox.value = \"Windows PowerShell\"\n$goButton = $ie.Document.getElementByID(\"btnG\")\n$goButton.click()\n\n\nfunction NavigateIE($url)\n{\n    $ie = new-object -com \"InternetExplorer.Application\";\n    $ie.navigate($url);\n    #ie.visible=true;\n    [System.Threading.Thread]::Sleep(2000);\n    return $ie;\n}\n\nfunction FindTag($params)\n{\n    $ie = $params[0];\n    $tagname = $params[1];\n    $contain = $params[2];\n    $doc = $ie.document;\n    $tags = @($doc.getElementsByTagName($tagname));\n    foreach($tag in $tags)\n    {\n        if($tag.outerHTML.contains($contain))\n        {\n            $sel = $tag;\n            break;\n        }\n    }\n    return $sel;\n}\n\n$ie = NavigateIE(\"http://weibo.com/12321\");\n\n$talk = FindTag($ie, \"textarea\", 'id=publish_editor');\n\n$but = FindTag($ie, \"span\", 'class=bgColorB');\n\n$talk.value = \"test\";\n$but.click(); \n\n\npearltrees\nhttp://www.pearltrees.com/yuaisheng/tree/id9610952\n\nExcelVBA \u9006\u5f15\u304d\u5927\u5168 620\u306e\u6975\u610f\nhttp://www.shuwasystem.co.jp/support/7980html/2744.html\n\nWindows Forms\nhttps://en.wikipedia.org/wiki/Windows_Forms\n\nIE Automation Library and Web Macro Recorder\nhttp://codecentrix.blogspot.jp/\nhttp://codecentrix.com/\n\nVBA\u306b\u3088\u308bIE\u81ea\u52d5\u5236\u5fa1\nhttp://vba-code.net/ie/click-an-image/\n\n```vb\n\n'\u65e5\u7d4c\u5e73\u5747\u306e\u30c1\u30e3\u30fc\u30c8\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\nSub ClickNikkeiChart()\n    Dim objIE As Object\n\n    'IE\u8d77\u52d5\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    objIE.Visible = True\n\n    'Yahoo\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u306b\u63a5\u7d9a\n    objIE.navigate \"http://finance.yahoo.co.jp/\"\n\n    'IE\u3092\u5f85\u6a5f\n    Call IEWait(objIE)\n\n    '5\u79d2\u505c\u6b62\n    Call WaitFor(5)\n\n    '\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u306e\u30c1\u30e3\u30fc\u30c8\u753b\u50cf\u3092\u30af\u30ea\u30c3\u30af\n    Call IEImageClick(objIE, \"s?s=998407.O\")\n\n    'IE\u3092\u5f85\u6a5f\n    Call IEWait(objIE)\n\n    '5\u79d2\u505c\u6b62\n    Call WaitFor(5)\n\n    'IE\u7d42\u4e86\n    objIE.Quit\n\n    Set objIE = Nothing\nEnd Sub\n\n'\u753b\u50cf\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u95a2\u6570\nPublic Function IEImageClick(ByRef objIE As Object, imageSrc As String)\n    Dim objImage As Object\n    For Each objImage In objIE.Document.getElementsByTagName(\"IMG\")\n        If InStr(objImage.src, imageSrc) &gt; 0 Then\n            objImage.Click\n            Exit For\n        End If\n    Next\nEnd Function\n\n'IE\u3092\u5f85\u6a5f\u3059\u308b\u95a2\u6570\nFunction IEWait(ByRef objIE As Object)\n    Do While objIE.Busy = True Or objIE.readyState  4\n        DoEvents\n    Loop\nEnd Function\n\n'\u6307\u5b9a\u3057\u305f\u79d2\u3060\u3051\u505c\u6b62\u3059\u308b\u95a2\u6570\nFunction WaitFor(ByVal second As Integer)\n    Dim futureTime As Date\n\n    futureTime = DateAdd(\"s\", second, Now)\n    While Now &lt; futureTime\n       DoEvents\n    Wend\nEnd Function\n```\n\n```pl\nfunction WaitForLoad($ie)\n{\n    while($ie.Busy)\n    {\n        sleep -Milliseconds 50\n    }\n}\n\n$ie = New-Object -COM InternetExplorer.Application\n$ie.Navigate(\"http://www.google.com\")\n$ie.Visible = $true\nWaitForLoad($ie)\n$searchBox = $ie.Document.getElementById(\"q\")\n$searchBox.value = \"Windows PowerShell\"\n$goButton = $ie.Document.getElementByID(\"btnG\")\n$goButton.click()\n\n```\n\n```pl\nfunction NavigateIE($url)\n{\n    $ie = new-object -com \"InternetExplorer.Application\";\n    $ie.navigate($url);\n    #ie.visible=true;\n    [System.Threading.Thread]::Sleep(2000);\n    return $ie;\n}\n\nfunction FindTag($params)\n{\n    $ie = $params[0];\n    $tagname = $params[1];\n    $contain = $params[2];\n    $doc = $ie.document;\n    $tags = @($doc.getElementsByTagName($tagname));\n    foreach($tag in $tags)\n    {\n        if($tag.outerHTML.contains($contain))\n        {\n            $sel = $tag;\n            break;\n        }\n    }\n    return $sel;\n}\n\n$ie = NavigateIE(\"http://weibo.com/12321\");\n\n$talk = FindTag($ie, \"textarea\", 'id=publish_editor');\n\n$but = FindTag($ie, \"span\", 'class=bgColorB');\n\n$talk.value = \"test\";\n$but.click(); \n```\n\n"}