{"context": " More than 1 year has passed since last update.\u25a0\u3057\u305f\u3044\u3053\u3068\nRDS\u3092\u30de\u30b9\u30bf\u30fc\u3001EC2\u4e0a\u306eMySQL\u305d\u30b9\u30ec\u30fc\u30d6\u3068\u3057\u3066\u3001\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3055\u305b\u308b\n\u203bRDS\u5074\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u306fInnoDB\u3060\u304c\u30b9\u30ec\u30fc\u30d6\u5074\u306eMySQL\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u306fMroonga\u306b\u3057\u305f\u3044\u3002\n\u25a0time_zone\u3092\u5408\u308f\u305b\u3066\u304a\u304f\nAisa/Tokyo\u3067\u63c3\u3048\u305f\u304b\u3063\u305f\u306e\u3067\u3001RDS\u3068EC2\u4e0aMySQL\u306etime_zone\u306fAsia/Tokyo\u306b\u3057\u307e\u3057\u305f\u3002\n\uff08\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u304a\u4e92\u3044\u9055\u3046\u307e\u307e\u3067\u3084\u3063\u305f\u3089\u3001\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\uff09\nRDS\u5074(\u3061\u3068\u3081\u3093\u3069\u3044\uff09\nhttp://dev.classmethod.jp/cloud/aws/change-timezone-on-amazon-rds-mysql/\nMySQL\u5074\nmy.cnf\n[mysqld]\ndefault-time-zone=Asia/Tokyo\u3000\uff03\u8ffd\u52a0\n\n\u203b\u518d\u8d77\u52d5\u3057\u3066\u30a8\u30e9\u30fc\u304c\u3067\u305f\u5834\u5408\nmysql_tzinfo_to_sql /usr/share/zoneinfo/ | mysql -u root -p mysql\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u5074\u306eMySQL\u306bRDS\u7279\u6709\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\n\u3053\u308c\u304c\u4f5c\u3089\u308c\u3066\u306a\u3044\u3068\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3059\u308b\u3002\nuse mysql;\nCREATE TABLE `rds_heartbeat2` (\n  `id` int(11) NOT NULL,\n  `value` bigint(20) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\n\n\u25a0\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3055\u305b\u305f\u3044\u30c6\u30fc\u30d6\u30eb\u3092MASTER\u5074\u306b\u4f5c\u6210\u3059\u308b\n\u30fb\u30de\u30b9\u30bf\u30fc\u5074\nCREATE TABLE `articles` (\n `id` varchar(32) NOT NULL,\n `title` varchar(26) NOT NULL,\n `del_flag` tinyint(4) NOT NULL DEFAULT '0',\n `create_date` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',\n `update_date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n PRIMARY KEY (id)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n\n\u30fb\u30b9\u30ec\u30fc\u30d6\u5074\n\u30de\u30b9\u30bf\u30fc\u3068\u540c\u3058\u3082\u306e\u3092\u4f5c\u6210\n\u203b\u3053\u306e\u6642\u70b9\u3067\u30de\u30b9\u30bf\u30fc\u5074\u306b\u306a\u3093\u3089\u304b\u306e\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3057\u3066\u304a\u304f\n\u25a0\u30de\u30b9\u30bf\u30fc\u5074\u306b\u5c02\u7528\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\n\u30de\u30b9\u30bf\u30fc\u5074\u306b\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3059\u308b\nCREATE USER 'repl'@'%' IDENTIFIED BY 'test';\nGRANT REPLICATION SLAVE ON *.* TO 'repl'@'%';\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u5074\u306emy.cnf\u306e\u8a2d\u5b9a\n[mysqld]\nserver-id = 111\nlog-bin   = mysql-bin\nrelay-log = relay-log\n\n\u25a0\u30de\u30b9\u30bf\u306e\u30c0\u30f3\u30d7\u3092\u3068\u308b\nmysqldump -u dbuser -p -h ~~~~~~~~~~~rds.amazonaws.com --no-create-db --routines --triggers --single-transaction masterdb articles > dump.sql\n\n\u203bRDS\u306fFLUSH TABLES WITH READ LOCK\u3067\u304d\u307e\u305b\u3093\n\u25a0\u30b9\u30ec\u30fc\u30d6\u306b\u30de\u30b9\u30bf\u306e\u30c0\u30f3\u30d7\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\nmysql -u root -p  slavedb < dump.sql\n\n\u25a0\u30de\u30b9\u30bf\u306e\u30d0\u30a4\u30ca\u30ea\u30ed\u30b0\u60c5\u5831\u306e\u78ba\u8a8d\nshow master status;\n\n\u4f8b\u3048\u3070\u3053\u3093\u306a\u611f\u3058\u306b\u51fa\u529b\nmysql-bin-changelog.000001 120\n\nmysql-bin-changelog\u306f\u30d0\u30a4\u30ca\u30ea\u30ed\u30b0\u3067\u3001120\u306f\u4f4d\u7f6e\u60c5\u5831\u3067\u3059\n\u25a0SLAVE\u3092\u8a2d\u5b9a\nCHANGE MASTER TO\nMASTER_HOST='~~~~~~~~~~~rds.amazonaws.com',\nMASTER_USER='repl',\nMASTER_PASSWORD='test',\nMASTER_LOG_FILE='mysql-bin-changelog.000001',    \nMASTER_LOG_POS=120;\n\nLOG_FILE\u3068LOG_POS\u306f\u30de\u30b9\u30bf\u306e\u30d0\u30a4\u30ca\u30ea\u30ed\u30b0\u60c5\u5831\u306e\u5024\u306b\u3059\u308b\n\u4e00\u5ea6\u767b\u9332\u3057\u3066\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\u306f\nCHANGE MASTER TO MASTER_LOG_FILE='mysql-bin-changelog.000002',  MASTER_LOG_POS=422;\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u958b\u59cb\nSTART SLAVE\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u306e\u72b6\u614b\u78ba\u8a8d\nSHOW SLAVE STATUS\n\nSlave_IO_Running\u304cYES Slave_SQL_Running\u304cYES \u306a\u3089\u554f\u984c\u306a\u3044\u3002\n\u305f\u3060\u3057\u30b9\u30ec\u30fc\u30d6\u958b\u59cb\u5f8c\u306b\u30de\u30b9\u30bf\u30fc\u306b\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u3001 \u30b9\u30ec\u30fc\u30d6\u306b\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u304b\u3092\u304d\u3061\u3063\u3068\u78ba\u8a8d\u3059\u308b\n\u30de\u30b9\u30bf\u30fc\u3067\u306e\u30c7\u30fc\u30bf\u767b\u9332\u304c\u30b9\u30ec\u30fc\u30d6\u306b\u3082\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\uff08\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3055\u308c\u3066\u3044\u308b\uff09 \u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u305f\u3089\u3001\u30b9\u30ec\u30fc\u30d6\u5074\u306e\u30a8\u30f3\u30b8\u30f3\u3092\u672c\u6765\u8a2d\u5b9a\u3057\u305f\u3044\u30a8\u30f3\u30b8\u30f3\u306b\u3059\u308b\n\u25a0\u30b9\u30ec\u30fc\u30d6\u5074\u306e\u30a8\u30f3\u30b8\u30f3\u306e\u5909\u66f4\nALTER TABLE articles \n  ADD FULLTEXT INDEX `content_index` (title) COMMENT 'parser \"TokenMecab\", normalizer \"NormalizerAuto\"';\nALTER TABLE articles  ENGINE=mroonga COMMENT='engine \"InnoDB\"';\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u306a\u305c\u5f8c\u304b\u3089ALTER\u3067\u30a8\u30f3\u30b8\u30f3\u3092\u5909\u3048\u3066\u308b\u304b\u3068\u3044\u3046\u3068\u3001\n\u6700\u521d\u306e\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3044\u304f\u3089\u30b9\u30ec\u30fc\u30d6\u5074\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u6307\u5b9a\u306e\u30a8\u30f3\u30b8\u30f3\u3067\u4f5c\u6210\u3057\u3066\u3044\u3066\u3082\n\u521d\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5f8c\u3001\u30de\u30b9\u30bf\u30fc\u5074\u306e\u30c6\u30fc\u30d6\u30eb\u3068\u69cb\u6210\u304c\u540c\u3058\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u3089\uff08\u518d\u4f5c\u6210\uff1f\uff09\n\u521d\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5f8cALTER\u3067\u30a8\u30f3\u30b8\u30f3\u5909\u3048\u3066\u3042\u3052\u308c\u3070\u3001\u4ee5\u964d\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n\u25a0\u3057\u305f\u3044\u3053\u3068\n\nRDS\u3092\u30de\u30b9\u30bf\u30fc\u3001EC2\u4e0a\u306eMySQL\u305d\u30b9\u30ec\u30fc\u30d6\u3068\u3057\u3066\u3001\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3055\u305b\u308b\n\n\u203bRDS\u5074\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u306fInnoDB\u3060\u304c\u30b9\u30ec\u30fc\u30d6\u5074\u306eMySQL\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u306fMroonga\u306b\u3057\u305f\u3044\u3002\n\n\u25a0time_zone\u3092\u5408\u308f\u305b\u3066\u304a\u304f\n\nAisa/Tokyo\u3067\u63c3\u3048\u305f\u304b\u3063\u305f\u306e\u3067\u3001RDS\u3068EC2\u4e0aMySQL\u306etime_zone\u306fAsia/Tokyo\u306b\u3057\u307e\u3057\u305f\u3002\n\n\uff08\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u304a\u4e92\u3044\u9055\u3046\u307e\u307e\u3067\u3084\u3063\u305f\u3089\u3001\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\uff09\n\nRDS\u5074(\u3061\u3068\u3081\u3093\u3069\u3044\uff09\n\nhttp://dev.classmethod.jp/cloud/aws/change-timezone-on-amazon-rds-mysql/\n\nMySQL\u5074\n\nmy.cnf\n<pre>[mysqld]\ndefault-time-zone=Asia/Tokyo\u3000\uff03\u8ffd\u52a0\n</pre>\n\n \u203b\u518d\u8d77\u52d5\u3057\u3066\u30a8\u30e9\u30fc\u304c\u3067\u305f\u5834\u5408\n\n<pre>\nmysql_tzinfo_to_sql /usr/share/zoneinfo/ | mysql -u root -p mysql\n</pre>\n\n \u25a0\u30b9\u30ec\u30fc\u30d6\u5074\u306eMySQL\u306bRDS\u7279\u6709\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\n\n\u3053\u308c\u304c\u4f5c\u3089\u308c\u3066\u306a\u3044\u3068\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3059\u308b\u3002\n\n<pre>\nuse mysql;\nCREATE TABLE `rds_heartbeat2` (\n  `id` int(11) NOT NULL,\n  `value` bigint(20) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\n</pre>\n\n\u25a0\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3055\u305b\u305f\u3044\u30c6\u30fc\u30d6\u30eb\u3092MASTER\u5074\u306b\u4f5c\u6210\u3059\u308b\n\n\u30fb\u30de\u30b9\u30bf\u30fc\u5074\n\n<pre>\nCREATE TABLE `articles` (\n `id` varchar(32) NOT NULL,\n `title` varchar(26) NOT NULL,\n `del_flag` tinyint(4) NOT NULL DEFAULT '0',\n `create_date` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',\n `update_date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n PRIMARY KEY (id)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n</pre>\n\n\u30fb\u30b9\u30ec\u30fc\u30d6\u5074\n\n\u30de\u30b9\u30bf\u30fc\u3068\u540c\u3058\u3082\u306e\u3092\u4f5c\u6210\n\n\u203b\u3053\u306e\u6642\u70b9\u3067\u30de\u30b9\u30bf\u30fc\u5074\u306b\u306a\u3093\u3089\u304b\u306e\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3057\u3066\u304a\u304f\n\n\u25a0\u30de\u30b9\u30bf\u30fc\u5074\u306b\u5c02\u7528\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\n\u30de\u30b9\u30bf\u30fc\u5074\u306b\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30e6\u30fc\u30b6\u3092\u4f5c\u6210\u3059\u308b\n\n<pre>\nCREATE USER 'repl'@'%' IDENTIFIED BY 'test';\nGRANT REPLICATION SLAVE ON *.* TO 'repl'@'%';\n</pre>\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u5074\u306emy.cnf\u306e\u8a2d\u5b9a\n\n<pre>\n[mysqld]\nserver-id = 111\nlog-bin   = mysql-bin\nrelay-log = relay-log\n</pre>\n\n\u25a0\u30de\u30b9\u30bf\u306e\u30c0\u30f3\u30d7\u3092\u3068\u308b\n\n<pre>\nmysqldump -u dbuser -p -h ~~~~~~~~~~~rds.amazonaws.com --no-create-db --routines --triggers --single-transaction masterdb articles > dump.sql\n</pre>\n\n\u203bRDS\u306fFLUSH TABLES WITH READ LOCK\u3067\u304d\u307e\u305b\u3093\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u306b\u30de\u30b9\u30bf\u306e\u30c0\u30f3\u30d7\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\n\n<pre>\nmysql -u root -p  slavedb < dump.sql\n</pre>\n\n\u25a0\u30de\u30b9\u30bf\u306e\u30d0\u30a4\u30ca\u30ea\u30ed\u30b0\u60c5\u5831\u306e\u78ba\u8a8d\n\n<pre>\nshow master status;\n</pre>\n\n\u4f8b\u3048\u3070\u3053\u3093\u306a\u611f\u3058\u306b\u51fa\u529b\n\n<pre>\nmysql-bin-changelog.000001 120\n</pre>\n\nmysql-bin-changelog\u306f\u30d0\u30a4\u30ca\u30ea\u30ed\u30b0\u3067\u3001120\u306f\u4f4d\u7f6e\u60c5\u5831\u3067\u3059\n\n\u25a0SLAVE\u3092\u8a2d\u5b9a\n\n<pre>\nCHANGE MASTER TO\nMASTER_HOST='~~~~~~~~~~~rds.amazonaws.com',\nMASTER_USER='repl',\nMASTER_PASSWORD='test',\nMASTER_LOG_FILE='mysql-bin-changelog.000001',    \nMASTER_LOG_POS=120;\n</pre>\n\nLOG_FILE\u3068LOG_POS\u306f\u30de\u30b9\u30bf\u306e\u30d0\u30a4\u30ca\u30ea\u30ed\u30b0\u60c5\u5831\u306e\u5024\u306b\u3059\u308b\n\n\u4e00\u5ea6\u767b\u9332\u3057\u3066\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\u306f\n\n<pre>\nCHANGE MASTER TO MASTER_LOG_FILE='mysql-bin-changelog.000002',  MASTER_LOG_POS=422;\n</pre>\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u958b\u59cb\n\n<pre>\nSTART SLAVE\n</pre>\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u306e\u72b6\u614b\u78ba\u8a8d\n\n<pre>\nSHOW SLAVE STATUS\n</pre>\n\nSlave_IO_Running\u304cYES Slave_SQL_Running\u304cYES \u306a\u3089\u554f\u984c\u306a\u3044\u3002\n\u305f\u3060\u3057\u30b9\u30ec\u30fc\u30d6\u958b\u59cb\u5f8c\u306b\u30de\u30b9\u30bf\u30fc\u306b\u30c7\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u3001 \u30b9\u30ec\u30fc\u30d6\u306b\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u304b\u3092\u304d\u3061\u3063\u3068\u78ba\u8a8d\u3059\u308b\n\n\u30de\u30b9\u30bf\u30fc\u3067\u306e\u30c7\u30fc\u30bf\u767b\u9332\u304c\u30b9\u30ec\u30fc\u30d6\u306b\u3082\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\uff08\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3055\u308c\u3066\u3044\u308b\uff09 \u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u305f\u3089\u3001\u30b9\u30ec\u30fc\u30d6\u5074\u306e\u30a8\u30f3\u30b8\u30f3\u3092\u672c\u6765\u8a2d\u5b9a\u3057\u305f\u3044\u30a8\u30f3\u30b8\u30f3\u306b\u3059\u308b\n\n\u25a0\u30b9\u30ec\u30fc\u30d6\u5074\u306e\u30a8\u30f3\u30b8\u30f3\u306e\u5909\u66f4\n\n<pre>\nALTER TABLE articles \n  ADD FULLTEXT INDEX `content_index` (title) COMMENT 'parser \"TokenMecab\", normalizer \"NormalizerAuto\"';\nALTER TABLE articles  ENGINE=mroonga COMMENT='engine \"InnoDB\"';\n</pre>\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u306a\u305c\u5f8c\u304b\u3089ALTER\u3067\u30a8\u30f3\u30b8\u30f3\u3092\u5909\u3048\u3066\u308b\u304b\u3068\u3044\u3046\u3068\u3001\n\u6700\u521d\u306e\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3044\u304f\u3089\u30b9\u30ec\u30fc\u30d6\u5074\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u6307\u5b9a\u306e\u30a8\u30f3\u30b8\u30f3\u3067\u4f5c\u6210\u3057\u3066\u3044\u3066\u3082\n\u521d\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5f8c\u3001\u30de\u30b9\u30bf\u30fc\u5074\u306e\u30c6\u30fc\u30d6\u30eb\u3068\u69cb\u6210\u304c\u540c\u3058\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u3089\uff08\u518d\u4f5c\u6210\uff1f\uff09\n\u521d\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5f8cALTER\u3067\u30a8\u30f3\u30b8\u30f3\u5909\u3048\u3066\u3042\u3052\u308c\u3070\u3001\u4ee5\u964d\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\n", "tags": ["RDS", "MySQL", "AWS", "\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3"]}