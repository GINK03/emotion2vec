{"tags": ["C\u8a00\u8a9e", "psd", "clib"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002psd.rb \u3092\u30d9\u30fc\u30b9\u306b C \u8a00\u8a9e\u3067\u79fb\u690d\u3057\u305f psd.c \u3092 MIT \u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u5143\u3067\u516c\u958b\u3057\u307e\u3057\u305f\u3002\u3053\u3053\u3067\u306f\u4f7f\u3044\u65b9\u3092\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\npsd.rb \u3068\u306e\u9055\u3044\n\nPhotoshop Big \u5f62\u5f0f (psb) \u306b\u5bfe\u5fdc\nUnicode \u6587\u5b57\u5217\u306f\u751f\u3067\u683c\u7d0d\u3057\u3066\u3044\u308b\u305f\u3081\u5909\u63db\u304c\u5fc5\u8981\n\u6728\u69cb\u9020\u306e\u30af\u30a8\u30ea\u306f\u672a\u5bfe\u5fdc\n\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nclib \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308c\u3070 package.json \u306b dependencies \u306b psd.c \u306e\u8a18\u8ff0\u3092\u3059\u308b\u3053\u3068\u3067 clib-install \u3092\u5b9f\u884c\u5f8c\u306b deps \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n{\n  \"dependencies\": {\n    \"hkrn/psd.c\": \"0.1.0\"\n  }\n}\n\n\n\u4f7f\u3044\u65b9\u306e\u4f8b\n\u3053\u3053\u3067\u306f\uff12\u3064\u306e\u4f7f\u3044\u65b9\u306e\u4f8b\u3092\u793a\u3057\u307e\u3059\u3002psd.c \u306f\u3053\u3053\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u95a2\u6570\u306e\u4ed6\u306b\u3082 API \u3068\u3057\u3066\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\npsd \u81ea\u4f53\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u5168\u4f53\u306e\u753b\u50cf\u3092\u51fa\u529b\u3059\u308b\n\u4ee5\u4e0b\u306f psd \u306e\u4e2d\u8eab\u3092\u8aad\u307f\u8fbc\u3093\u3067 stbi_image_write \u3092\u4f7f\u3063\u3066 png \u3068\u3057\u3066\u51fa\u529b\u3057\u307e\u3059\u3002\n\u7c21\u7565\u5316\u306e\u305f\u3081\u30a8\u30e9\u30fc\u51e6\u7406\u306f\u7701\u3044\u3066\u3044\u307e\u3059\u304c\u3001psdDocument(Parse|ExtractImage) \u306f\u8fd4\u308a\u5024\u306b psd_status_t \u3092\u8fd4\u3059\u305f\u3081\u3001\u3053\u306e\u5024\u304c PSD_STATUS_SUCCESS \u304b\u3069\u3046\u304b\u3092\u6bd4\u8f03\u3057\u3066\u6b63\u5e38\u306b\u51e6\u7406\u3055\u308c\u305f\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\npsd_uint8_t *bytes = ...; /* psd \u306e\u751f\u30c7\u30fc\u30bf */\npsd_rsize_t length = ...; /* psd \u306e\u751f\u30c7\u30fc\u30bf\u306e\u9577\u3055 */\npsd_buffer_t *buffer = psdBufferCreate(bytes, length);\npsd_document_t *document = psdDocumentCreate();\npsdDocumentParse(document, buffer);\npsdDocumentExtractImage(document);\nconst psd_header_t *header = psdDocumentGetHeader(document);\npsd_size_t size = psdHeaderGetSize(header);\npsd_rsize_t ncomponents = 4;\nif (const psd_uint8_t *pixel_data = psdImageGetPixelData(psdDocumentGetImage(document))) {\n    psd_rsize stride = psdHeaderGetStrideLength(header) * ncomponents;\n    stbi_write_png(\"test.png\", size.columns, size.rows, ncomponents, pixel_data, stride);\n}\npsdDocumentDestroy(document);\npsdBufferDestroy(buffer);\n\npsdImageGetPixelData \u306f psdDocumentExtractImage \u3092\u547c\u3073\u51fa\u3055\u306a\u3044\u3068 NULL \u3092\u8fd4\u3057\u307e\u3059\u3002\u3053\u308c\u306f PSD \u81ea\u4f53\u306e\u30d1\u30fc\u30b9\u3068\u753b\u50cf\u306e\u30d1\u30fc\u30b9\u304c\u5225\u51e6\u7406\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\n\npsd \u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u30ec\u30a4\u30e4\u30fc\u6bce\u306e\u753b\u50cf\u3092\u51fa\u529b\u3059\u308b\n\u30ec\u30a4\u30e4\u30fc\u6bce\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u753b\u50cf\u30c7\u30fc\u30bf\u3092 stb_image_write \u3092\u4f7f\u3063\u3066 png \u3068\u3057\u3066\u51fa\u529b\u3057\u307e\u3059\u3002\npsd_uint8_t *bytes = ...; /* psd \u306e\u751f\u30c7\u30fc\u30bf */\npsd_rsize_t length = ...; /* psd \u306e\u751f\u30c7\u30fc\u30bf\u306e\u9577\u3055 */\npsd_buffer_t *buffer = psdBufferCreate(bytes, length);\npsd_document_t *document = psdDocumentCreate();\npsdDocumentParse(document, buffer);\npsd_rsize_t layer_length;\npsd_layer_t *const *layers = psdDocumentGetAllLayers(document, &layer_length);\nfor (int i = 0; i < layer_length; i++) {\n    psd_layer_t *layer = layers[i];\n    psdLayerExtract(layer);\n    if (const psd_uint8_t *data = psdLayerGetPixelData(layer)) {\n        const psd_rect_t rect = psdLayerGetRect(layer);\n        psd_size_t size;\n        size.columns = psdRectGetWidth(&rect);\n        size.rows = psdRectGetHeight(&rect);\n        psd_rsize_t ncomponents = 4;\n        psd_rsize_t depth = psdHeaderGetDepth(psdDocumentGetHeader(document));\n        psd_rsize_t stride = psdSizeGetStrideLength(&size, depth) * ncomponents;\n        char buf[255];\n        snprintf(buf, sizeof(buf), \"%d.png\", i);\n        stbi_write_png(buf, size.columns, size.rows, ncomponents, data, stride);\n    }\n}\nfree((void *)layers);\n\npsdDocumentExtractImage \u3068\u540c\u3058\u304f psdLayerExtract \u3092\u547c\u3073\u51fa\u3055\u306a\u3044\u3068 psdLayerGetPixelData \u304c NULL \u3092\u8fd4\u3057\u307e\u3059\u3002\u307e\u305f\u3001psdDocumentGetAllLayers \u304c\u8fd4\u3059\u914d\u5217\u306e\u30dd\u30a4\u30f3\u30bf\u306f\u4f7f\u7528\u5f8c free (\u30ab\u30b9\u30bf\u30e0\u30a2\u30ed\u30b1\u30fc\u30bf\u3067\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u306f\u305d\u306e free) \u3067\u89e3\u653e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u8a2d\u8a08\n\u3053\u3053\u3067\u306f psd.c \u306e\u8a2d\u8a08\u306b\u3064\u3044\u3066\u66f8\u304d\u307e\u3059\n\n\u69cb\u9020\u4f53\npsd.c \u3067\u306f\u304a\u304a\u307e\u304b\u306b\u4ee5\u4e0b\u306e\u69cb\u9020\u4f53\u306e\u5358\u4f4d\u3067\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u3055\u308c\u3066\u3044\u307e\u3059\u3002psd_document \u304c\u5168\u3066\u306e\u89aa\u3067\u3042\u308a\u3001\u30e1\u30e2\u30ea\u7ba1\u7406\u306f\u914d\u5217\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3059\u95a2\u6570\u3092\u9664\u3044\u3066 psd_document_t \u304c\u62c5\u3063\u3066\u3044\u307e\u3059\u3002\n\npsd_document_t\n\n\npsd_header_t\npsd_resource_container_t\n\n\npsd_resource_t\n\n\npsd_layer_container_t\n\n\npsd_layer_t\n\n\npsd_image_t\n\n\n\n\u4e0a\u8a18\u306e\u69cb\u9020\u4f53\u306f\u5168\u3066\u4e0d\u5b9a\u69cb\u9020\u4f53\u3067\u3042\u308a\u3001\u76f4\u63a5\u69cb\u9020\u4f53\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u305b\u3093\u3002\u63a5\u5c3e\u8a5e\u304c Create \u306e\u95a2\u6570\u3092\u4ecb\u3057\u3066\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u578b\npsd.c \u306f\u79fb\u690d\u6027\u306e\u89b3\u70b9\u304b\u3089 int \u4ee5\u5916\u306f\u72ec\u81ea\u306e\u578b\u3092\u5b9a\u7fa9\u3057\u3001\u305d\u308c\u3089\u3092\u7528\u3044\u3066\u3044\u307e\u3059\u3002\u4ee5\u4e0b\u306f C99 \u306e\u5834\u5408\u3067\u3059\u3002\ntypedef _Bool psd_bool_t;\ntypedef uint8_t psd_uint8_t;\ntypedef int16_t psd_int16_t;\ntypedef uint16_t psd_uint16_t;\ntypedef int32_t psd_int32_t;\ntypedef uint32_t psd_uint32_t;\ntypedef int64_t psd_int64_t;\ntypedef uint64_t psd_uint64_t;\n#define psd_false false\n#define psd_true true\n\n\n\u30ab\u30b9\u30bf\u30e0\u30a2\u30ed\u30b1\u30fc\u30bf\npsd.c \u306f\u30ab\u30b9\u30bf\u30e0\u30a2\u30ed\u30b1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u306f\u30ab\u30b9\u30bf\u30e0\u30a2\u30ed\u30b1\u30fc\u30bf\u306e\u8a2d\u5b9a\u65b9\u6cd5\u3092\u793a\u3057\u307e\u3059\u3002\nstatic psd_global_allocator_t g_allocator = {\n    customMalloc,\n    customCalloc,\n    customRealloc,\n    customFree\n};\n/* \u5143\u306b\u623b\u3059\u5834\u5408\u306f psdGlobalSetCustomAllocator(0); \u3092\u547c\u3073\u51fa\u3059\u3053\u3068 */\npsdGlobalSetCustomAllocator(&g_allocator);\n\n\u63a5\u982d\u8a5e psd \u306e\u3064\u304f\u95a2\u6570\u306e\u547c\u3073\u51fa\u3057\u524d\u306b\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f OS \u6a19\u6e96\u306e malloc/calloc/realloc/free \u3092\u305d\u306e\u307e\u307e\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n[psd.rb](https://github.com/layervault/psd.rb) \u3092\u30d9\u30fc\u30b9\u306b C \u8a00\u8a9e\u3067\u79fb\u690d\u3057\u305f [psd.c](https://github.com/hkrn/psd.c/) \u3092 MIT \u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u5143\u3067\u516c\u958b\u3057\u307e\u3057\u305f\u3002\u3053\u3053\u3067\u306f\u4f7f\u3044\u65b9\u3092\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n## psd.rb \u3068\u306e\u9055\u3044\n\n - Photoshop Big \u5f62\u5f0f (psb) \u306b\u5bfe\u5fdc\n - Unicode \u6587\u5b57\u5217\u306f\u751f\u3067\u683c\u7d0d\u3057\u3066\u3044\u308b\u305f\u3081\u5909\u63db\u304c\u5fc5\u8981\n - \u6728\u69cb\u9020\u306e\u30af\u30a8\u30ea\u306f\u672a\u5bfe\u5fdc\n - \u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n[clib](https://github.com/clibs/clib) \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308c\u3070 package.json \u306b `dependencies` \u306b `psd.c` \u306e\u8a18\u8ff0\u3092\u3059\u308b\u3053\u3068\u3067 `clib-install` \u3092\u5b9f\u884c\u5f8c\u306b `deps` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\n```json\n{\n  \"dependencies\": {\n    \"hkrn/psd.c\": \"0.1.0\"\n  }\n}\n```\n\n## \u4f7f\u3044\u65b9\u306e\u4f8b\n\n\u3053\u3053\u3067\u306f\uff12\u3064\u306e\u4f7f\u3044\u65b9\u306e\u4f8b\u3092\u793a\u3057\u307e\u3059\u3002psd.c \u306f\u3053\u3053\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u95a2\u6570\u306e\u4ed6\u306b\u3082 API \u3068\u3057\u3066\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n### psd \u81ea\u4f53\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u5168\u4f53\u306e\u753b\u50cf\u3092\u51fa\u529b\u3059\u308b\n\n\u4ee5\u4e0b\u306f psd \u306e\u4e2d\u8eab\u3092\u8aad\u307f\u8fbc\u3093\u3067 stbi_image_write \u3092\u4f7f\u3063\u3066 png \u3068\u3057\u3066\u51fa\u529b\u3057\u307e\u3059\u3002\n\n\u7c21\u7565\u5316\u306e\u305f\u3081\u30a8\u30e9\u30fc\u51e6\u7406\u306f\u7701\u3044\u3066\u3044\u307e\u3059\u304c\u3001psdDocument(Parse|ExtractImage) \u306f\u8fd4\u308a\u5024\u306b `psd_status_t` \u3092\u8fd4\u3059\u305f\u3081\u3001\u3053\u306e\u5024\u304c `PSD_STATUS_SUCCESS` \u304b\u3069\u3046\u304b\u3092\u6bd4\u8f03\u3057\u3066\u6b63\u5e38\u306b\u51e6\u7406\u3055\u308c\u305f\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```c\npsd_uint8_t *bytes = ...; /* psd \u306e\u751f\u30c7\u30fc\u30bf */\npsd_rsize_t length = ...; /* psd \u306e\u751f\u30c7\u30fc\u30bf\u306e\u9577\u3055 */\npsd_buffer_t *buffer = psdBufferCreate(bytes, length);\npsd_document_t *document = psdDocumentCreate();\npsdDocumentParse(document, buffer);\npsdDocumentExtractImage(document);\nconst psd_header_t *header = psdDocumentGetHeader(document);\npsd_size_t size = psdHeaderGetSize(header);\npsd_rsize_t ncomponents = 4;\nif (const psd_uint8_t *pixel_data = psdImageGetPixelData(psdDocumentGetImage(document))) {\n    psd_rsize stride = psdHeaderGetStrideLength(header) * ncomponents;\n    stbi_write_png(\"test.png\", size.columns, size.rows, ncomponents, pixel_data, stride);\n}\npsdDocumentDestroy(document);\npsdBufferDestroy(buffer);\n```\n\npsdImageGetPixelData \u306f psdDocumentExtractImage \u3092\u547c\u3073\u51fa\u3055\u306a\u3044\u3068 NULL \u3092\u8fd4\u3057\u307e\u3059\u3002\u3053\u308c\u306f PSD \u81ea\u4f53\u306e\u30d1\u30fc\u30b9\u3068\u753b\u50cf\u306e\u30d1\u30fc\u30b9\u304c\u5225\u51e6\u7406\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\n\n### psd \u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u30ec\u30a4\u30e4\u30fc\u6bce\u306e\u753b\u50cf\u3092\u51fa\u529b\u3059\u308b\n\n\u30ec\u30a4\u30e4\u30fc\u6bce\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u753b\u50cf\u30c7\u30fc\u30bf\u3092 stb_image_write \u3092\u4f7f\u3063\u3066 png \u3068\u3057\u3066\u51fa\u529b\u3057\u307e\u3059\u3002\n\n```c\npsd_uint8_t *bytes = ...; /* psd \u306e\u751f\u30c7\u30fc\u30bf */\npsd_rsize_t length = ...; /* psd \u306e\u751f\u30c7\u30fc\u30bf\u306e\u9577\u3055 */\npsd_buffer_t *buffer = psdBufferCreate(bytes, length);\npsd_document_t *document = psdDocumentCreate();\npsdDocumentParse(document, buffer);\npsd_rsize_t layer_length;\npsd_layer_t *const *layers = psdDocumentGetAllLayers(document, &layer_length);\nfor (int i = 0; i < layer_length; i++) {\n    psd_layer_t *layer = layers[i];\n    psdLayerExtract(layer);\n    if (const psd_uint8_t *data = psdLayerGetPixelData(layer)) {\n        const psd_rect_t rect = psdLayerGetRect(layer);\n        psd_size_t size;\n        size.columns = psdRectGetWidth(&rect);\n        size.rows = psdRectGetHeight(&rect);\n        psd_rsize_t ncomponents = 4;\n        psd_rsize_t depth = psdHeaderGetDepth(psdDocumentGetHeader(document));\n        psd_rsize_t stride = psdSizeGetStrideLength(&size, depth) * ncomponents;\n        char buf[255];\n        snprintf(buf, sizeof(buf), \"%d.png\", i);\n        stbi_write_png(buf, size.columns, size.rows, ncomponents, data, stride);\n    }\n}\nfree((void *)layers);\n```\n\npsdDocumentExtractImage \u3068\u540c\u3058\u304f psdLayerExtract \u3092\u547c\u3073\u51fa\u3055\u306a\u3044\u3068 psdLayerGetPixelData \u304c NULL \u3092\u8fd4\u3057\u307e\u3059\u3002\u307e\u305f\u3001psdDocumentGetAllLayers \u304c\u8fd4\u3059\u914d\u5217\u306e\u30dd\u30a4\u30f3\u30bf\u306f\u4f7f\u7528\u5f8c free (\u30ab\u30b9\u30bf\u30e0\u30a2\u30ed\u30b1\u30fc\u30bf\u3067\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u306f\u305d\u306e free) \u3067\u89e3\u653e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n## \u8a2d\u8a08\n\n\u3053\u3053\u3067\u306f psd.c \u306e\u8a2d\u8a08\u306b\u3064\u3044\u3066\u66f8\u304d\u307e\u3059\n\n### \u69cb\u9020\u4f53\n\npsd.c \u3067\u306f\u304a\u304a\u307e\u304b\u306b\u4ee5\u4e0b\u306e\u69cb\u9020\u4f53\u306e\u5358\u4f4d\u3067\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\u3055\u308c\u3066\u3044\u307e\u3059\u3002psd_document \u304c\u5168\u3066\u306e\u89aa\u3067\u3042\u308a\u3001\u30e1\u30e2\u30ea\u7ba1\u7406\u306f\u914d\u5217\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u8fd4\u3059\u95a2\u6570\u3092\u9664\u3044\u3066 psd_document_t \u304c\u62c5\u3063\u3066\u3044\u307e\u3059\u3002\n\n - psd_document_t\n   - psd_header_t\n   - psd_resource_container_t\n     - psd_resource_t\n   - psd_layer_container_t\n     - psd_layer_t\n  - psd_image_t\n\n\u4e0a\u8a18\u306e\u69cb\u9020\u4f53\u306f\u5168\u3066\u4e0d\u5b9a\u69cb\u9020\u4f53\u3067\u3042\u308a\u3001\u76f4\u63a5\u69cb\u9020\u4f53\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u305b\u3093\u3002\u63a5\u5c3e\u8a5e\u304c Create \u306e\u95a2\u6570\u3092\u4ecb\u3057\u3066\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n### \u578b\n\npsd.c \u306f\u79fb\u690d\u6027\u306e\u89b3\u70b9\u304b\u3089 int \u4ee5\u5916\u306f\u72ec\u81ea\u306e\u578b\u3092\u5b9a\u7fa9\u3057\u3001\u305d\u308c\u3089\u3092\u7528\u3044\u3066\u3044\u307e\u3059\u3002\u4ee5\u4e0b\u306f C99 \u306e\u5834\u5408\u3067\u3059\u3002\n\n```c\ntypedef _Bool psd_bool_t;\ntypedef uint8_t psd_uint8_t;\ntypedef int16_t psd_int16_t;\ntypedef uint16_t psd_uint16_t;\ntypedef int32_t psd_int32_t;\ntypedef uint32_t psd_uint32_t;\ntypedef int64_t psd_int64_t;\ntypedef uint64_t psd_uint64_t;\n#define psd_false false\n#define psd_true true\n```\n\n### \u30ab\u30b9\u30bf\u30e0\u30a2\u30ed\u30b1\u30fc\u30bf\n\npsd.c \u306f\u30ab\u30b9\u30bf\u30e0\u30a2\u30ed\u30b1\u30fc\u30bf\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u306f\u30ab\u30b9\u30bf\u30e0\u30a2\u30ed\u30b1\u30fc\u30bf\u306e\u8a2d\u5b9a\u65b9\u6cd5\u3092\u793a\u3057\u307e\u3059\u3002\n\n```c\nstatic psd_global_allocator_t g_allocator = {\n    customMalloc,\n    customCalloc,\n    customRealloc,\n    customFree\n};\n/* \u5143\u306b\u623b\u3059\u5834\u5408\u306f psdGlobalSetCustomAllocator(0); \u3092\u547c\u3073\u51fa\u3059\u3053\u3068 */\npsdGlobalSetCustomAllocator(&g_allocator);\n```\n\n\u63a5\u982d\u8a5e psd \u306e\u3064\u304f\u95a2\u6570\u306e\u547c\u3073\u51fa\u3057\u524d\u306b\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f OS \u6a19\u6e96\u306e malloc/calloc/realloc/free \u3092\u305d\u306e\u307e\u307e\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n"}