{"tags": ["C#", "WPF", "\u57fa\u790e"], "context": " More than 1 year has passed since last update.WPF\u3067\u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3001\u5bfe\u8c61\u3068\u306a\u308b\u9805\u76ee\u304c\u5909\u66f4\u3055\u308c\u305f\u5834\u5408\u3001\u305d\u306e\u9805\u76ee\u306e\u540d\u79f0\u3092\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u3057\u3066INotifyPropertyChanged.PropertyChanged\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u751f\u3055\u305b\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30d7\u30ed\u30d1\u30c6\u30a3\u3068\u3057\u3066\u5b9f\u88c5\u3059\u308b\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u304b\uff1f\n\nTestVeiwModel.cs\nclass TestVeiwModel : ViewModelBase\n{\n    private string _foo;\n    public string Foo\n    {\n        get { return _foo; }\n        set \n        {\n            if (_foo != value)\n            {\n                _foo = value;\n                // \u5024\u304c\u5909\u66f4\u3055\u308c\u305f\u3089INotifyPropertyChanged.PropertyChanged\u3092\u767a\u751f\u3055\u305b\u308b\u3002\n                RaisePropertyChanged(\"Foo\");\n            }\n        }\n    }\n\n    public TestVeiwModel()\n    {\n        CreateDataBindItem<string>(\"Foo\", \"\", true);\n    }\n}\n\n\n\u578b\u304c\u9055\u3063\u305f\u3068\u3057\u3066\u3082\u3001\u5024\u304c\u5909\u66f4\u3055\u308c\u305f\u3089INotifyPropertyChanged.PropertyChanged\u3092\u767a\u751f\u3055\u305b\u308b\u3068\u3044\u3046\u306e\u306f\u5b9a\u5f62\u3067\u3059\u306e\u3067\u3001\u30b8\u30a7\u30cd\u30ea\u30c3\u30af\u306a\u30d8\u30eb\u30d1\u30fc\u30af\u30e9\u30b9\u306b\u307e\u3068\u3081\u3066\u307f\u307e\u3059\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u4ee5\u524d\u306b\u4f5c\u6210\u3057\u305fViewModel\u306e\u57fa\u5e95\u30af\u30e9\u30b9\u3078\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nViewModelBase.cs\n#region ==== Abstract Class : ViewModelBase \n/// <summary>\n/// ViewModel\u306e\u62bd\u8c61\u57fa\u5e95\u30af\u30e9\u30b9\n///    INotifyPropertyChanged, IDataErrorInfo \u3092\u5b9f\u88c5\u3001\n///    \u305d\u306e\u4ed6 ViewModel\u7528\u306e\u30d8\u30eb\u30d1\u30fc\u30af\u30e9\u30b9\u7b49\u3092\u63d0\u4f9b\u3059\u308b\n/// </summary>\npublic abstract class ViewModelBase : INotifyPropertyChanged, IDataErrorInfo\n{\n    //  \u7701\u7565\n\n    #region **** Inner Class : DataBindItemBase\n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u62bd\u8c61\u57fa\u5e95\u30af\u30e9\u30b9\n    /// </summary>\n    protected abstract class DataBindItemBase\n    {\n        #region **** Members\n\n        /// <summary>\n        /// \u5024\u304c\u5909\u66f4\u3055\u308c\u305f\u304b\u3069\u3046\u304b\u3092\u4fdd\u6301\u3059\u308b\u5185\u90e8\u5909\u6570\n        /// </summary>\n        private bool _changed;\n\n        #endregion\n\n        #region **** Properties\n\n        /// <summary>\n        /// \u89aa\u3068\u306a\u308bViewModel\u57fa\u5e95\u30af\u30e9\u30b9\u3078\u306e\u53c2\u7167 : ViewModelBase\n        /// </summary>\n        protected ViewModelBase _VM { get; set; }\n\n        /// <summary>\n        /// \u9805\u76ee\u540d : string\n        /// </summary>\n        public string Name { get; protected set; }\n\n        /// <summary>\n        /// \u5024\u306e\u578b(\u62bd\u8c61) : Type\n        /// </summary>\n        public abstract Type ValueType { get; }\n\n        /// <summary>\n        /// \u5024\u304c\u5909\u66f4\u3055\u308c\u305f\uff1f : bool\n        /// </summary>\n        public bool Changed\n        {\n            get { return _changed; }\n            protected set\n            {\n                if (_changed != value)\n                {\n                    _changed = value;\n                    _VM.RaisePropertyChanged(\"Changed\");\n                }\n            }\n        }\n\n        /// <summary>\n        /// \u4e0d\u6b63\u306a\u5024\u3092\u53d7\u3051\u4ed8\u3051\u308b\uff1f\n        ///    True\u306e\u5834\u5408\u3001ValidationCheck\u3067\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u5024\u3082Value\u3078\u306e\u4ee3\u5165\u3092\u8a8d\u3081\u308b\n        /// </summary>\n        public bool AcceptInvalidData { get; set; }\n\n        #endregion\n\n        #region **** Abstract Method : Initialize\n        /// <summary>\n        /// \u521d\u671f\u51e6\u7406\uff08\u62bd\u8c61\uff09\n        /// </summary>\n        public abstract void Initialize();\n        #endregion\n\n        #region **** ClearChanged\n        /// <summary>\n        /// \u9805\u76ee\u3092\u672a\u5909\u66f4\u72b6\u614b\u306b\u3059\u308b\n        /// </summary>\n        public void ClearChanged()\n        {\n            Changed = false;\n        }\n        #endregion\n    }\n    #endregion\n\n    #region **** Inner Class : DataBindItem<T> \n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u30af\u30e9\u30b9\uff08\u30b8\u30a7\u30cd\u30ea\u30c3\u30af\uff09\n    /// </summary>\n    /// <typeparam name=\"T\">\u9805\u76ee\u306e\u578b</typeparam>\n    protected class DataBindItem<T> : DataBindItemBase\n    {\n        #region **** Delegates / Events\n\n        /// <summary>\n        /// \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u7528\u30c7\u30ea\u30b2\u30fc\u30c8\n        /// </summary>\n        public Func<T, Result> CheckValidation;\n\n        /// <summary>\n        /// \u9805\u76ee\u5909\u66f4\u524d\u30a4\u30d9\u30f3\u30c8\n        ///    BeforeValueChangeEventArgs.Cancel\u306bTrue\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\n        ///    \u9805\u76ee\u5909\u66f4\u51e6\u7406\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u3002\n        /// </summary>\n        public event EventHandler<BeforeValueChangeEventArgs> BeforeValueChange;\n\n        /// <summary>\n        /// \u9805\u76ee\u5909\u66f4\u5f8c\u30a4\u30d9\u30f3\u30c8\n        /// </summary>\n        public event EventHandler<ValueChangedEventArgs> ValueChanged;\n\n        #endregion\n\n        #region **** Members\n\n        /// <summary>\n        /// \u9805\u76ee\u306e\u5024\u3092\u4fdd\u6301\u3059\u308b\u5185\u90e8\u5909\u6570\n        /// </summary>\n        private T _value;\n\n        /// <summary>\n        /// \u9805\u76ee\u306e\u521d\u671f\u5024\u3092\u4fdd\u6301\u3059\u308b\u5185\u90e8\u5909\u6570\n        /// </summary>\n        private T _defaultValue;\n\n        #endregion\n\n        #region **** Properties\n\n        /// <summary>\n        /// \u9805\u76ee\u5024 : T\n        /// </summary>\n        public T Value\n        {\n            get { return _value; }\n            set\n            {\n                // \u5024\u304c\u5909\u66f4\u3055\u308c\u305f\u3068\u304d\u306e\u307f\u51e6\u7406\u3059\u308b\n                if (!eq(_value, value))\n                {\n                    // \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\n                    Result result = (CheckValidation != null) ? CheckValidation(value) : Result.ResultSuccess;\n\n                    // \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u306b\u6210\u529f\u304b\u3001AcceptInvalidData\u304cTrue\u306e\u5834\u5408\n                    if (result.Success || AcceptInvalidData)\n                    {\n\n                        // \u5909\u66f4\u524d\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u751f\u3055\u305b\u308b\n                        BeforeValueChangeEventArgs arg = new BeforeValueChangeEventArgs(value, _value);\n                        if (BeforeValueChange != null)\n                            BeforeValueChange(this, arg);\n\n                        // \u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u306a\u3051\u308c\u3070\n                        if (!arg.Cancel)\n                        {\n                            // \u5024\u3092\u4ee3\u5165\u3059\u308b\n                            _value = value;\n                            _VM.RaisePropertyChanged(Name);\n                            Changed = true;\n\n                            // \u5909\u66f4\u5f8c\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u751f\u3055\u305b\u308b\n                            if (ValueChanged != null)\n                                ValueChanged(this, arg);\n                        }\n                    }\n\n                    // ViewModel\u306b\u5bfe\u3057\u3066\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u7d50\u679c\u3092\u30bb\u30c3\u30c8\u3059\u308b\n                    _VM.SetError(Name, result);\n                }\n            }\n        }\n\n        /// <summary>\n        /// \u9805\u76ee\u306e\u578b : Type\n        /// </summary>\n        public override Type ValueType\n        {\n            get { return _value.GetType(); }\n        }\n\n        #endregion\n\n        #region **** Constructor\n        /// <summary>\n        /// \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\n        /// </summary>\n        /// <param name=\"vm\">ViewModel\u3078\u306e\u53c2\u7167 : ViewModelBase</param>\n        /// <param name=\"name\">\u9805\u76ee\u540d : string</param>\n        /// <param name=\"defaultValue\">\u521d\u671f\u5024 : T</param>\n        public DataBindItem(ViewModelBase vm, string name, T defaultValue)\n        {\n            if (vm == null || string.IsNullOrWhiteSpace(name))\n                throw new ArgumentNullException();\n\n            _VM = vm;\n            Name = name;\n            _value = _defaultValue = defaultValue;\n            Changed = false;\n            AcceptInvalidData = false;\n        }\n        #endregion\n\n        #region **** Private Method : eq\n        /// <summary>\n        /// \u5024\u304c\u4e00\u81f4\u3059\u308b\u304b\uff1f\n        ///     T\u306b\u5bfe\u3057\u3066\u76f4\u63a5\u6bd4\u8f03\u6f14\u7b97\u5b50\u3092\u4f7f\u7528\u3067\u304d\u306a\u3044\u305f\u3081IComparable\u306b\u30ad\u30e3\u30b9\u30c8\u3057\u3066\u6bd4\u8f03\u3059\u308b\n        ///     IComparable\u3067\u306a\u3044\u5834\u5408\u306f\u3064\u306d\u306bFalse\u3092\u8fd4\u3059\u3002\n        /// </summary>\n        /// <param name=\"v1\">\u50241 : T</param>\n        /// <param name=\"v2\">\u50242 : T</param>\n        /// <returns>\u7d50\u679c\u5024 : bool</returns>\n        private bool eq(T v1, T v2)\n        {\n            if (v1 is IComparable)\n                return (v1 as IComparable).CompareTo(v2) == 0;\n            else\n                return false;\n        }\n        #endregion\n\n        #region **** Method (Override) : Initialize\n        /// <summary>\n        /// \u9805\u76ee\u3092\u521d\u671f\u5316\u3059\u308b\n        ///     \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u6307\u5b9a\u3057\u305f\u521d\u671f\u5024\u304c\u30bb\u30c3\u30c8\u3055\u308c\u308b\u3002\n        ///     \u30a8\u30e9\u30fc\u3001\u5909\u66f4\u72b6\u614b\u3082\u30af\u30ea\u30a2\u3055\u308c\u308b\u3002\n        /// </summary>\n        public override void Initialize()\n        {\n            _value = _defaultValue;\n            _VM.ClearErrror(Name);\n            Changed = false;\n        }\n        #endregion\n    }\n    #endregion\n\n    /// <summary>\n    /// DataBindItem\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \n    /// </summary>\n    protected Dictionary<string, DataBindItemBase> DataBindItems { get; private set; }\n\n    #region **** Constructor\n    /// <summary>\n    /// \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\n    /// </summary>\n    public ViewModelBase()\n    {\n        DataBindItems = new Dictionary<string, DataBindItemBase>();\n    }\n    #endregion\n\n    #region **** Method : CreateDataBindItem(1)\n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u306e\u751f\u6210\n    /// </summary>\n    /// <typeparam name=\"T\">\u9805\u76ee\u306e\u578b</typeparam>\n    /// <param name=\"name\">\u9805\u76ee\u540d : string</param>\n    /// <param name=\"defaultValue\">\u521d\u671f\u5024 : T</param>\n    /// <param name=\"checkValidation\">\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u30c7\u30ea\u30b2\u30fc\u30c8 : Func</param>\n    /// <returns>\u9805\u76ee\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 : DataBindItem</returns>\n    protected DataBindItem<T> CreateDataBindItem<T>(string name, T defaultValue, Func<T, Result> checkValidation = null)\n    {\n        DataBindItem<T> item = new DataBindItem<T>(this, name, defaultValue);\n        if (checkValidation != null)\n            item.CheckValidation = checkValidation;\n        DataBindItems[name] = item;\n        return item;\n    }\n    #endregion\n\n    #region **** Method : CreateDataBindItem(2)\n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u306e\u751f\u6210\n    /// </summary>\n    /// <typeparam name=\"T\">\u9805\u76ee\u306e\u578b</typeparam>\n    /// <param name=\"name\">\u9805\u76ee\u540d : string</param>\n    /// <param name=\"defaultValue\">\u521d\u671f\u5024 : T</param>\n    /// <param name=\"acceptInvalidData\">\u4e0d\u6b63\u306a\u5024\u3092\u53d7\u3051\u5165\u308c\u308b\u304b\uff1f : bool</param>\n    /// <param name=\"checkValidation\">\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u30c7\u30ea\u30b2\u30fc\u30c8 : Func</param>\n    /// <returns>\u9805\u76ee\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 : DataBindItem</returns>\n    protected DataBindItem<T> CreateDataBindItem<T>(string name, T defaultValue, bool acceptInvalidData, Func<T, Result> checkValidation = null)\n    {\n        DataBindItem<T> item = new DataBindItem<T>(this, name, defaultValue);\n        item.AcceptInvalidData = acceptInvalidData;\n        if (checkValidation != null)\n            item.CheckValidation = checkValidation;\n\n        DataBindItems[name] = item;\n        return item;\n    }\n    #endregion\n\n    #region **** Method : GetDataBindItem\n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u306e\u53d6\u5f97\n    /// </summary>\n    /// <typeparam name=\"T\">\u9805\u76ee\u306e\u578b</typeparam>\n    /// <param name=\"name\">\u9805\u76ee\u540d : string</param>\n    /// <returns>\u9805\u76ee\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 : DataBindItem</returns>\n    protected DataBindItem<T> GetDataBindItem<T>(string name)\n    {\n        return DataBindItems[name] as DataBindItem<T>;\n    }\n    #endregion\n\n}\n#endregion\n\n\n\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u7528\u306e\u30c7\u30ea\u30b2\u30fc\u30c8\u3084\u5024\u5909\u66f4\u6642\u306e\u30a4\u30d9\u30f3\u30c8\u306a\u3069\u3092\u8ffd\u52a0\u3057\u3066\u3042\u308b\u306e\u3067\u3001\u5c11\u3057\u30b3\u30fc\u30c9\u304c\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\n\u4f7f\u3044\u65b9\n\u5229\u7528\u3059\u308b\u30af\u30e9\u30b9\u3092ViewModelBase\u304b\u3089\u6d3e\u751f\u3055\u305b\u3066\u3001\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306a\u3069\u304b\u3089CreateDataBindItem<T>()\u3092\u547c\u3073\u51fa\u3057\u3066\u3001DataBindItem\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u751f\u6210\u3001\u3053\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u30d7\u30ed\u30d1\u30c6\u30a3\u3067\u30e9\u30c3\u30d7\u3057\u3066\u516c\u958b\u3059\u308b\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u306b\u306a\u308a\u307e\u3059\u3002\n\nTestVeiwModel.cs\nclass TestVeiwModel : ViewModelBase\n{\n    public string Foo\n    {\n        get { return GetDataBindItem<string>(\"Foo\").Value; }\n        set { GetDataBindItem<string>(\"Foo\").Value = value; }\n    }\n\n    public TestVeiwModel()\n    {\n        CreateDataBindItem<string>(\"Foo\", \"\", true);\n    }\n}\n\n\n\u751f\u6210\u3055\u308c\u305fDataBindItem\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u3001\u62bd\u8c61\u30af\u30e9\u30b9DataBindItemBase\u306eDictionary\u3067\u3042\u308bDataBindItems\u306b\u4fdd\u6301\u3055\u308c\u3066\u3044\u308b\u306e\u3067\nForeach (var item in DataBindItems.Vlaues)\n{\n    // \u4f55\u304b\u51e6\u7406\u3092\u3059\u308b\n}\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u4e00\u62ec\u51e6\u7406\u304c\u3067\u304d\u308b\u306e\u3067\u4fbf\u5229\u304b\u3082\u3002\nWPF\u3067\u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3001\u5bfe\u8c61\u3068\u306a\u308b\u9805\u76ee\u304c\u5909\u66f4\u3055\u308c\u305f\u5834\u5408\u3001\u305d\u306e\u9805\u76ee\u306e\u540d\u79f0\u3092\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u3057\u3066`INotifyPropertyChanged.PropertyChanged`\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u751f\u3055\u305b\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30d7\u30ed\u30d1\u30c6\u30a3\u3068\u3057\u3066\u5b9f\u88c5\u3059\u308b\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u304b\uff1f\n\n```csharp:TestVeiwModel.cs\nclass TestVeiwModel : ViewModelBase\n{\n    private string _foo;\n    public string Foo\n    {\n        get { return _foo; }\n        set \n        {\n            if (_foo != value)\n            {\n                _foo = value;\n                // \u5024\u304c\u5909\u66f4\u3055\u308c\u305f\u3089INotifyPropertyChanged.PropertyChanged\u3092\u767a\u751f\u3055\u305b\u308b\u3002\n                RaisePropertyChanged(\"Foo\");\n            }\n        }\n    }\n\n    public TestVeiwModel()\n    {\n        CreateDataBindItem<string>(\"Foo\", \"\", true);\n    }\n}\n```\n\n\u578b\u304c\u9055\u3063\u305f\u3068\u3057\u3066\u3082\u3001\u5024\u304c\u5909\u66f4\u3055\u308c\u305f\u3089`INotifyPropertyChanged.PropertyChanged`\u3092\u767a\u751f\u3055\u305b\u308b\u3068\u3044\u3046\u306e\u306f\u5b9a\u5f62\u3067\u3059\u306e\u3067\u3001\u30b8\u30a7\u30cd\u30ea\u30c3\u30af\u306a\u30d8\u30eb\u30d1\u30fc\u30af\u30e9\u30b9\u306b\u307e\u3068\u3081\u3066\u307f\u307e\u3059\u3002\n\n## \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n\u4ee5\u524d\u306b\u4f5c\u6210\u3057\u305f[ViewModel\u306e\u57fa\u5e95\u30af\u30e9\u30b9](http://qiita.com/hugo-sb/items/f07ef53dea817d198475)\u3078\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```csharp:ViewModelBase.cs\n#region ==== Abstract Class : ViewModelBase \n/// <summary>\n/// ViewModel\u306e\u62bd\u8c61\u57fa\u5e95\u30af\u30e9\u30b9\n///    INotifyPropertyChanged, IDataErrorInfo \u3092\u5b9f\u88c5\u3001\n///    \u305d\u306e\u4ed6 ViewModel\u7528\u306e\u30d8\u30eb\u30d1\u30fc\u30af\u30e9\u30b9\u7b49\u3092\u63d0\u4f9b\u3059\u308b\n/// </summary>\npublic abstract class ViewModelBase : INotifyPropertyChanged, IDataErrorInfo\n{\n    //  \u7701\u7565\n\n    #region **** Inner Class : DataBindItemBase\n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u62bd\u8c61\u57fa\u5e95\u30af\u30e9\u30b9\n    /// </summary>\n    protected abstract class DataBindItemBase\n    {\n        #region **** Members\n\n        /// <summary>\n        /// \u5024\u304c\u5909\u66f4\u3055\u308c\u305f\u304b\u3069\u3046\u304b\u3092\u4fdd\u6301\u3059\u308b\u5185\u90e8\u5909\u6570\n        /// </summary>\n        private bool _changed;\n\n        #endregion\n\n        #region **** Properties\n\n        /// <summary>\n        /// \u89aa\u3068\u306a\u308bViewModel\u57fa\u5e95\u30af\u30e9\u30b9\u3078\u306e\u53c2\u7167 : ViewModelBase\n        /// </summary>\n        protected ViewModelBase _VM { get; set; }\n\n        /// <summary>\n        /// \u9805\u76ee\u540d : string\n        /// </summary>\n        public string Name { get; protected set; }\n\n        /// <summary>\n        /// \u5024\u306e\u578b(\u62bd\u8c61) : Type\n        /// </summary>\n        public abstract Type ValueType { get; }\n\n        /// <summary>\n        /// \u5024\u304c\u5909\u66f4\u3055\u308c\u305f\uff1f : bool\n        /// </summary>\n        public bool Changed\n        {\n            get { return _changed; }\n            protected set\n            {\n                if (_changed != value)\n                {\n                    _changed = value;\n                    _VM.RaisePropertyChanged(\"Changed\");\n                }\n            }\n        }\n\n        /// <summary>\n        /// \u4e0d\u6b63\u306a\u5024\u3092\u53d7\u3051\u4ed8\u3051\u308b\uff1f\n        ///    True\u306e\u5834\u5408\u3001ValidationCheck\u3067\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u5024\u3082Value\u3078\u306e\u4ee3\u5165\u3092\u8a8d\u3081\u308b\n        /// </summary>\n        public bool AcceptInvalidData { get; set; }\n\n        #endregion\n\n        #region **** Abstract Method : Initialize\n        /// <summary>\n        /// \u521d\u671f\u51e6\u7406\uff08\u62bd\u8c61\uff09\n        /// </summary>\n        public abstract void Initialize();\n        #endregion\n\n        #region **** ClearChanged\n        /// <summary>\n        /// \u9805\u76ee\u3092\u672a\u5909\u66f4\u72b6\u614b\u306b\u3059\u308b\n        /// </summary>\n        public void ClearChanged()\n        {\n            Changed = false;\n        }\n        #endregion\n    }\n    #endregion\n\n    #region **** Inner Class : DataBindItem<T> \n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u30af\u30e9\u30b9\uff08\u30b8\u30a7\u30cd\u30ea\u30c3\u30af\uff09\n    /// </summary>\n    /// <typeparam name=\"T\">\u9805\u76ee\u306e\u578b</typeparam>\n    protected class DataBindItem<T> : DataBindItemBase\n    {\n        #region **** Delegates / Events\n\n        /// <summary>\n        /// \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u7528\u30c7\u30ea\u30b2\u30fc\u30c8\n        /// </summary>\n        public Func<T, Result> CheckValidation;\n\n        /// <summary>\n        /// \u9805\u76ee\u5909\u66f4\u524d\u30a4\u30d9\u30f3\u30c8\n        ///    BeforeValueChangeEventArgs.Cancel\u306bTrue\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\n        ///    \u9805\u76ee\u5909\u66f4\u51e6\u7406\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u3002\n        /// </summary>\n        public event EventHandler<BeforeValueChangeEventArgs> BeforeValueChange;\n\n        /// <summary>\n        /// \u9805\u76ee\u5909\u66f4\u5f8c\u30a4\u30d9\u30f3\u30c8\n        /// </summary>\n        public event EventHandler<ValueChangedEventArgs> ValueChanged;\n\n        #endregion\n\n        #region **** Members\n\n        /// <summary>\n        /// \u9805\u76ee\u306e\u5024\u3092\u4fdd\u6301\u3059\u308b\u5185\u90e8\u5909\u6570\n        /// </summary>\n        private T _value;\n\n        /// <summary>\n        /// \u9805\u76ee\u306e\u521d\u671f\u5024\u3092\u4fdd\u6301\u3059\u308b\u5185\u90e8\u5909\u6570\n        /// </summary>\n        private T _defaultValue;\n\n        #endregion\n\n        #region **** Properties\n\n        /// <summary>\n        /// \u9805\u76ee\u5024 : T\n        /// </summary>\n        public T Value\n        {\n            get { return _value; }\n            set\n            {\n                // \u5024\u304c\u5909\u66f4\u3055\u308c\u305f\u3068\u304d\u306e\u307f\u51e6\u7406\u3059\u308b\n                if (!eq(_value, value))\n                {\n                    // \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\n                    Result result = (CheckValidation != null) ? CheckValidation(value) : Result.ResultSuccess;\n\n                    // \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u306b\u6210\u529f\u304b\u3001AcceptInvalidData\u304cTrue\u306e\u5834\u5408\n                    if (result.Success || AcceptInvalidData)\n                    {\n\n                        // \u5909\u66f4\u524d\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u751f\u3055\u305b\u308b\n                        BeforeValueChangeEventArgs arg = new BeforeValueChangeEventArgs(value, _value);\n                        if (BeforeValueChange != null)\n                            BeforeValueChange(this, arg);\n\n                        // \u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u306a\u3051\u308c\u3070\n                        if (!arg.Cancel)\n                        {\n                            // \u5024\u3092\u4ee3\u5165\u3059\u308b\n                            _value = value;\n                            _VM.RaisePropertyChanged(Name);\n                            Changed = true;\n\n                            // \u5909\u66f4\u5f8c\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u751f\u3055\u305b\u308b\n                            if (ValueChanged != null)\n                                ValueChanged(this, arg);\n                        }\n                    }\n\n                    // ViewModel\u306b\u5bfe\u3057\u3066\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u7d50\u679c\u3092\u30bb\u30c3\u30c8\u3059\u308b\n                    _VM.SetError(Name, result);\n                }\n            }\n        }\n\n        /// <summary>\n        /// \u9805\u76ee\u306e\u578b : Type\n        /// </summary>\n        public override Type ValueType\n        {\n            get { return _value.GetType(); }\n        }\n\n        #endregion\n\n        #region **** Constructor\n        /// <summary>\n        /// \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\n        /// </summary>\n        /// <param name=\"vm\">ViewModel\u3078\u306e\u53c2\u7167 : ViewModelBase</param>\n        /// <param name=\"name\">\u9805\u76ee\u540d : string</param>\n        /// <param name=\"defaultValue\">\u521d\u671f\u5024 : T</param>\n        public DataBindItem(ViewModelBase vm, string name, T defaultValue)\n        {\n            if (vm == null || string.IsNullOrWhiteSpace(name))\n                throw new ArgumentNullException();\n\n            _VM = vm;\n            Name = name;\n            _value = _defaultValue = defaultValue;\n            Changed = false;\n            AcceptInvalidData = false;\n        }\n        #endregion\n\n        #region **** Private Method : eq\n        /// <summary>\n        /// \u5024\u304c\u4e00\u81f4\u3059\u308b\u304b\uff1f\n        ///     T\u306b\u5bfe\u3057\u3066\u76f4\u63a5\u6bd4\u8f03\u6f14\u7b97\u5b50\u3092\u4f7f\u7528\u3067\u304d\u306a\u3044\u305f\u3081IComparable\u306b\u30ad\u30e3\u30b9\u30c8\u3057\u3066\u6bd4\u8f03\u3059\u308b\n        ///     IComparable\u3067\u306a\u3044\u5834\u5408\u306f\u3064\u306d\u306bFalse\u3092\u8fd4\u3059\u3002\n        /// </summary>\n        /// <param name=\"v1\">\u50241 : T</param>\n        /// <param name=\"v2\">\u50242 : T</param>\n        /// <returns>\u7d50\u679c\u5024 : bool</returns>\n        private bool eq(T v1, T v2)\n        {\n            if (v1 is IComparable)\n                return (v1 as IComparable).CompareTo(v2) == 0;\n            else\n                return false;\n        }\n        #endregion\n\n        #region **** Method (Override) : Initialize\n        /// <summary>\n        /// \u9805\u76ee\u3092\u521d\u671f\u5316\u3059\u308b\n        ///     \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u6307\u5b9a\u3057\u305f\u521d\u671f\u5024\u304c\u30bb\u30c3\u30c8\u3055\u308c\u308b\u3002\n        ///     \u30a8\u30e9\u30fc\u3001\u5909\u66f4\u72b6\u614b\u3082\u30af\u30ea\u30a2\u3055\u308c\u308b\u3002\n        /// </summary>\n        public override void Initialize()\n        {\n            _value = _defaultValue;\n            _VM.ClearErrror(Name);\n            Changed = false;\n        }\n        #endregion\n    }\n    #endregion\n\n    /// <summary>\n    /// DataBindItem\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \n    /// </summary>\n    protected Dictionary<string, DataBindItemBase> DataBindItems { get; private set; }\n\n    #region **** Constructor\n    /// <summary>\n    /// \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\n    /// </summary>\n    public ViewModelBase()\n    {\n        DataBindItems = new Dictionary<string, DataBindItemBase>();\n    }\n    #endregion\n\n    #region **** Method : CreateDataBindItem(1)\n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u306e\u751f\u6210\n    /// </summary>\n    /// <typeparam name=\"T\">\u9805\u76ee\u306e\u578b</typeparam>\n    /// <param name=\"name\">\u9805\u76ee\u540d : string</param>\n    /// <param name=\"defaultValue\">\u521d\u671f\u5024 : T</param>\n    /// <param name=\"checkValidation\">\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u30c7\u30ea\u30b2\u30fc\u30c8 : Func</param>\n    /// <returns>\u9805\u76ee\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 : DataBindItem</returns>\n    protected DataBindItem<T> CreateDataBindItem<T>(string name, T defaultValue, Func<T, Result> checkValidation = null)\n    {\n        DataBindItem<T> item = new DataBindItem<T>(this, name, defaultValue);\n        if (checkValidation != null)\n            item.CheckValidation = checkValidation;\n        DataBindItems[name] = item;\n        return item;\n    }\n    #endregion\n\n    #region **** Method : CreateDataBindItem(2)\n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u306e\u751f\u6210\n    /// </summary>\n    /// <typeparam name=\"T\">\u9805\u76ee\u306e\u578b</typeparam>\n    /// <param name=\"name\">\u9805\u76ee\u540d : string</param>\n    /// <param name=\"defaultValue\">\u521d\u671f\u5024 : T</param>\n    /// <param name=\"acceptInvalidData\">\u4e0d\u6b63\u306a\u5024\u3092\u53d7\u3051\u5165\u308c\u308b\u304b\uff1f : bool</param>\n    /// <param name=\"checkValidation\">\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u30c7\u30ea\u30b2\u30fc\u30c8 : Func</param>\n    /// <returns>\u9805\u76ee\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 : DataBindItem</returns>\n    protected DataBindItem<T> CreateDataBindItem<T>(string name, T defaultValue, bool acceptInvalidData, Func<T, Result> checkValidation = null)\n    {\n        DataBindItem<T> item = new DataBindItem<T>(this, name, defaultValue);\n        item.AcceptInvalidData = acceptInvalidData;\n        if (checkValidation != null)\n            item.CheckValidation = checkValidation;\n\n        DataBindItems[name] = item;\n        return item;\n    }\n    #endregion\n\n    #region **** Method : GetDataBindItem\n    /// <summary>\n    /// \u30c7\u30fc\u30bf\u30d0\u30a4\u30f3\u30c9\u9805\u76ee\u306e\u53d6\u5f97\n    /// </summary>\n    /// <typeparam name=\"T\">\u9805\u76ee\u306e\u578b</typeparam>\n    /// <param name=\"name\">\u9805\u76ee\u540d : string</param>\n    /// <returns>\u9805\u76ee\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 : DataBindItem</returns>\n    protected DataBindItem<T> GetDataBindItem<T>(string name)\n    {\n        return DataBindItems[name] as DataBindItem<T>;\n    }\n    #endregion\n\n}\n#endregion\n```\n\n\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\u7528\u306e\u30c7\u30ea\u30b2\u30fc\u30c8\u3084\u5024\u5909\u66f4\u6642\u306e\u30a4\u30d9\u30f3\u30c8\u306a\u3069\u3092\u8ffd\u52a0\u3057\u3066\u3042\u308b\u306e\u3067\u3001\u5c11\u3057\u30b3\u30fc\u30c9\u304c\u9577\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\n## \u4f7f\u3044\u65b9\n\n\u5229\u7528\u3059\u308b\u30af\u30e9\u30b9\u3092`ViewModelBase`\u304b\u3089\u6d3e\u751f\u3055\u305b\u3066\u3001\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306a\u3069\u304b\u3089`CreateDataBindItem<T>()`\u3092\u547c\u3073\u51fa\u3057\u3066\u3001`DataBindItem`\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u751f\u6210\u3001\u3053\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u30d7\u30ed\u30d1\u30c6\u30a3\u3067\u30e9\u30c3\u30d7\u3057\u3066\u516c\u958b\u3059\u308b\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u306b\u306a\u308a\u307e\u3059\u3002\n\n```csharp:TestVeiwModel.cs\nclass TestVeiwModel : ViewModelBase\n{\n    public string Foo\n    {\n        get { return GetDataBindItem<string>(\"Foo\").Value; }\n        set { GetDataBindItem<string>(\"Foo\").Value = value; }\n    }\n\n    public TestVeiwModel()\n    {\n        CreateDataBindItem<string>(\"Foo\", \"\", true);\n    }\n}\n```\n\n\u751f\u6210\u3055\u308c\u305f`DataBindItem`\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u3001\u62bd\u8c61\u30af\u30e9\u30b9`DataBindItemBase`\u306e`Dictionary`\u3067\u3042\u308b`DataBindItems`\u306b\u4fdd\u6301\u3055\u308c\u3066\u3044\u308b\u306e\u3067\n\n```csharp\nForeach (var item in DataBindItems.Vlaues)\n{\n    // \u4f55\u304b\u51e6\u7406\u3092\u3059\u308b\n}\n```\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u4e00\u62ec\u51e6\u7406\u304c\u3067\u304d\u308b\u306e\u3067\u4fbf\u5229\u304b\u3082\u3002\n\n"}