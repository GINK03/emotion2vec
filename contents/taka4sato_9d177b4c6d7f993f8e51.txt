{"tags": ["Python", "boto", "DynamoDB"], "context": " More than 1 year has passed since last update.\n\n\u521d\u3081\u306b\nBoto(AWS\u306ePython SDK)\u3092\u4f7f\u3063\u3066Dynamo DB\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3044\u3001\u3068\u601d\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u521d\u6b69\u7684\u306a\u90e8\u5206\u3067\u305a\u3070\u308a\u53c2\u8003\u306b\u306a\u308bSample Code\u304c\u3046\u307e\u304f\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u4f5c\u6210\u3057\u305fCode\u3092\u30c1\u30e9\u30b7\u306e\u88cf\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nDynamo\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066get_item, query_2, scan\u3092\u3059\u308bCode\n\n\u4ee5\u4e0b\u3092\u524d\u63d0\u306b\u3057\u3066\u3044\u307e\u3059\n\nDynamo\u3078\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u304c\u4ed8\u4e0e\u3055\u308c\u305fIAM User\u306f\u4f5c\u6210\u6e08\u3067\u3001Access Key ID\u3068Secret Access Key\u3082\u4f5c\u6210\u6e08\nDynamo\u306b\u306frequests\u3068\u3044\u3046Table\u304c\u65e2\u306b\u3042\u308b\n\nrequests table\u306eHashkey\u304cString\u3067userID\u3001Range Key\u304cNumber\u3067created_date\n\n\n#!/usr/bin/env python\n# coding: utf-8\n\nimport boto.dynamodb2\nfrom boto.dynamodb2.table import Table\n\n#AWS Keys for Dynamo\naws_access_key_id = 'AKIASJOE73SDGDTDA'\naws_secret_access_key = 'BuAHZv01Us0pZTbe87987JOIeuoeaM3MO'\naws_region = 'ap-northeast-1'\n\ndef main():\n  conn = boto.dynamodb2.connect_to_region(aws_region, aws_access_key_id=aws_access_key_id,\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000aws_secret_access_key=aws_secret_access_key)\n\n  requests = Table('requests', connection=conn)\n\n  # show # of items\n  print requests.count()\n\n\n  # 'get_key_fields' example to show hash/range-key info for this table\n  print requests.get_key_fields()\n\n\n  # 'get_item' example to show all attribute of a item which has particular userID/created_date\n  item = requests.get_item(userID='USER-ID-0123-EDSMQNAK', created_date=143918255309)\n  for field, val in item.items():\n    print \"%s: %s\" % (field, val)\n\n\n  # 'query_2' example to query items with particular userID, and show all attributes for each item\n  # need to set 'userID__eq', not 'userID' \n  query_item = requests.query_2(userID__eq='USER-ID-0123-EDSMQNAK')\n  for item in query_item:\n    for field, val in item.items():\n      print '%s: %s' % (field, val)\n    print '--------------------'\n\n\n  # 'query_2' example to query items of userID (_eq) AND range key (__gt) \n  query_item = requests.query_2(userID__eq='USER-ID-0123-EDSMQNAK', created_date__gt=143918200000)\n\n\n  # 'scan' example to scan with key \"last_access_day\" >= \"20150810\" \n  query_item = requests.scan(last_access_day__gte=20150810)\n\nif __name__ == '__main__':\n  main()\n\n\n\u88dc\u8db3\n\nget_item, query_2, scan\u306e\u9055\u3044\n\n\nget_item\u306f\u3001Key (hash or hash+range_key)\u3092\u6307\u5b9a\u3057\u3066\u3001Best match\u3059\u308bitem\u30921\u4ef6\u53d6\u308a\u51fa\u3059\n\nquery_2\u306f\u3001Key (hash or hash+range_key)\u3092\u691c\u7d22\u6761\u4ef6\u3068\u3057\u3066\u3001Match\u3059\u308bitem\u3092\u8907\u6570\u53d6\u308a\u51fa\u3059\u3002\u691c\u7d22\u6761\u4ef6\u3068\u3057\u3066Key\u3057\u304b\u4f7f\u3048\u306a\u3044\u3002range_key\u306b\u5bfe\u3057\u3066\u306f\u3001KeyConditionExpression\u3068\u3044\u3046\u6f14\u7b97\u5b50(EQ|LE|LT|GE|GT|BEGINS_WITH|BETWEEN)\u3067greather, less\u306a\u3069\u306e\u7bc4\u56f2\u6307\u5b9a\u304c\u53ef\u80fd\n\nscan\u306f\u3001\u3044\u308f\u3086\u308b\u5168\u6587\u691c\u7d22\u3067\u3001Key\u4ee5\u5916\u306eattribute\u3092\u691c\u7d22\u6761\u4ef6\u306b\u691c\u7d22\u304c\u53ef\u80fd\u3067\u3059 (\u304c\u3001read capacity unit\u3092\u5927\u91cf\u6d88\u8cbb\u3057\u307e\u3059)\nAmazon\u306e\u516c\u5f0fDocument\u306f\u3053\u3061\u3089\u3092\u53c2\u7167\n\n## \u521d\u3081\u306b\n\nBoto(AWS\u306ePython SDK)\u3092\u4f7f\u3063\u3066Dynamo DB\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3044\u3001\u3068\u601d\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u521d\u6b69\u7684\u306a\u90e8\u5206\u3067\u305a\u3070\u308a\u53c2\u8003\u306b\u306a\u308bSample Code\u304c\u3046\u307e\u304f\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u4f5c\u6210\u3057\u305fCode\u3092\u30c1\u30e9\u30b7\u306e\u88cf\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\n\n### Dynamo\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066`get_item`, `query_2`, `scan`\u3092\u3059\u308bCode\n##### \u4ee5\u4e0b\u3092\u524d\u63d0\u306b\u3057\u3066\u3044\u307e\u3059\n* Dynamo\u3078\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u304c\u4ed8\u4e0e\u3055\u308c\u305fIAM User\u306f\u4f5c\u6210\u6e08\u3067\u3001`Access Key ID`\u3068`Secret Access Key`\u3082\u4f5c\u6210\u6e08\n* Dynamo\u306b\u306f`requests`\u3068\u3044\u3046Table\u304c\u65e2\u306b\u3042\u308b\n* `requests` table\u306eHashkey\u304cString\u3067`userID`\u3001Range Key\u304cNumber\u3067`created_date`\n\n\n```py\n#!/usr/bin/env python\n# coding: utf-8\n\nimport boto.dynamodb2\nfrom boto.dynamodb2.table import Table\n\n#AWS Keys for Dynamo\naws_access_key_id = 'AKIASJOE73SDGDTDA'\naws_secret_access_key = 'BuAHZv01Us0pZTbe87987JOIeuoeaM3MO'\naws_region = 'ap-northeast-1'\n\ndef main():\n  conn = boto.dynamodb2.connect_to_region(aws_region, aws_access_key_id=aws_access_key_id,\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000aws_secret_access_key=aws_secret_access_key)\n\n  requests = Table('requests', connection=conn)\n\n  # show # of items\n  print requests.count()\n\n\n  # 'get_key_fields' example to show hash/range-key info for this table\n  print requests.get_key_fields()\n  \n\n  # 'get_item' example to show all attribute of a item which has particular userID/created_date\n  item = requests.get_item(userID='USER-ID-0123-EDSMQNAK', created_date=143918255309)\n  for field, val in item.items():\n    print \"%s: %s\" % (field, val)\n\n\n  # 'query_2' example to query items with particular userID, and show all attributes for each item\n  # need to set 'userID__eq', not 'userID' \n  query_item = requests.query_2(userID__eq='USER-ID-0123-EDSMQNAK')\n  for item in query_item:\n    for field, val in item.items():\n      print '%s: %s' % (field, val)\n    print '--------------------'\n\n\n  # 'query_2' example to query items of userID (_eq) AND range key (__gt) \n  query_item = requests.query_2(userID__eq='USER-ID-0123-EDSMQNAK', created_date__gt=143918200000)\n\n\n  # 'scan' example to scan with key \"last_access_day\" >= \"20150810\" \n  query_item = requests.scan(last_access_day__gte=20150810)\n\nif __name__ == '__main__':\n  main()\n```\n\n### \u88dc\u8db3\n##### `get_item`, `query_2`, `scan`\u306e\u9055\u3044\n* `get_item`\u306f\u3001Key (hash or hash+range_key)\u3092\u6307\u5b9a\u3057\u3066\u3001Best match\u3059\u308bitem\u3092**1\u4ef6**\u53d6\u308a\u51fa\u3059\n* `query_2`\u306f\u3001Key (hash or hash+range_key)\u3092\u691c\u7d22\u6761\u4ef6\u3068\u3057\u3066\u3001Match\u3059\u308bitem\u3092**\u8907\u6570**\u53d6\u308a\u51fa\u3059\u3002\u691c\u7d22\u6761\u4ef6\u3068\u3057\u3066Key\u3057\u304b\u4f7f\u3048\u306a\u3044\u3002range_key\u306b\u5bfe\u3057\u3066\u306f\u3001`KeyConditionExpression`\u3068\u3044\u3046\u6f14\u7b97\u5b50(`EQ|LE|LT|GE|GT|BEGINS_WITH|BETWEEN`)\u3067greather, less\u306a\u3069\u306e\u7bc4\u56f2\u6307\u5b9a\u304c\u53ef\u80fd\n* `scan`\u306f\u3001\u3044\u308f\u3086\u308b\u5168\u6587\u691c\u7d22\u3067\u3001Key\u4ee5\u5916\u306eattribute\u3092\u691c\u7d22\u6761\u4ef6\u306b\u691c\u7d22\u304c\u53ef\u80fd\u3067\u3059 (\u304c\u3001read capacity unit\u3092\u5927\u91cf\u6d88\u8cbb\u3057\u307e\u3059)\n* [Amazon\u306e\u516c\u5f0fDocument\u306f\u3053\u3061\u3089\u3092\u53c2\u7167](http://docs.pythonboto.org/en/latest/ref/dynamodb.html#module-boto.dynamodb.table)\n"}