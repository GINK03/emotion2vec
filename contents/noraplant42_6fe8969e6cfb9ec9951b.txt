{"tags": ["Excel", "VBA", "ExcelVBA"], "context": "ExcelVBA\u306f\u4f7f\u3046\u6a5f\u4f1a\u304c\u591a\u3044\u5272\u306b\u6bce\u56de\u601d\u3044\u51fa\u305b\u306a\u3044\u306e\u3067\u30e1\u30e2\u3057\u307e\u3059\u3002\n\n\u30b3\u30fc\u30c9\nOption Explicit\n\nConst BOOKPATH As String = \"C:\\Users\\noraplant42\\target.xlsx\"\n\nSub Main()\nOn Error GoTo Exception\n    Dim xls As New Excel.Application\n    Dim wbook As Workbook\n    Dim wsheet As Worksheet\n\n    Dim maxRow As Long\n    Dim row As Long\n    Dim colData As Variant\n\n    ' \u5bfe\u8c61\u306eExcel\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n    Set wbook = xls.Workbooks.Open(BOOKPATH, 0, True)\n    Set wsheet = wbook.Worksheets(\"targetSheet\")\n\n    ' \u5bfe\u8c61\u5217\u306e\u6700\u5927\u884c\u3092\u53d6\u5f97\u3059\u308b\n    maxRow = wsheet.Cells(Rows.Count, 1).End(xlUp).row\n\n    ' \u5bfe\u8c61\u5217\u3092\u7bc4\u56f2\u3067\u53d6\u5f97\u3057\u3001\u914d\u5217\u306b\u3059\u308b\n    colData = wsheet.Range(wsheet.Cells(2, 1), wsheet.Cells(maxRow, 1))\n\n    ' \u5bfe\u8c61\u5217\u306e\u914d\u5217\u3092\u56de\u3057\u3066\u4f55\u304b\u51e6\u7406\u3059\u308b\n    For row = 1 To (maxRow - 1)\n        Cells(row, 5) = colData(row, 1)\n    Next row\n\n    wbook.Close False\n    Set xls = Nothing\n    Exit Sub\n\nException:\n    If Not wbook Is Nothing Then\n        wbook.Close False\n        Set xls = Nothing\n    End If\n\n    MsgBox Err.Description\nEnd Sub\n\n\n\u899a\u3048\u3066\u304a\u304f\u3068\u826f\u3055\u305d\u3046\u306a\u3053\u3068\n\n\nRange\u306e\u5024\u3092Variant\u5909\u6570\u306b\u5165\u308c\u308b\u3068\u3001\u4e8c\u6b21\u5143\u914d\u5217\u3068\u3057\u3066\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nErr.Description\u306b\u306f\u6a19\u6e96\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5165\u308a\u307e\u3059\u3002On Error GoTo ...\u3092\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u306b\u8868\u793a\u3055\u308c\u308b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3068\u540c\u3058\u3082\u306e\u3067\u3059\u3002\n\nExcelVBA\u306f\u4f7f\u3046\u6a5f\u4f1a\u304c\u591a\u3044\u5272\u306b\u6bce\u56de\u601d\u3044\u51fa\u305b\u306a\u3044\u306e\u3067\u30e1\u30e2\u3057\u307e\u3059\u3002\n\n# \u30b3\u30fc\u30c9\n```vbnet\nOption Explicit\n\nConst BOOKPATH As String = \"C:\\Users\\noraplant42\\target.xlsx\"\n\nSub Main()\nOn Error GoTo Exception\n    Dim xls As New Excel.Application\n    Dim wbook As Workbook\n    Dim wsheet As Worksheet\n\n    Dim maxRow As Long\n    Dim row As Long\n    Dim colData As Variant\n\n    ' \u5bfe\u8c61\u306eExcel\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n    Set wbook = xls.Workbooks.Open(BOOKPATH, 0, True)\n    Set wsheet = wbook.Worksheets(\"targetSheet\")\n\n    ' \u5bfe\u8c61\u5217\u306e\u6700\u5927\u884c\u3092\u53d6\u5f97\u3059\u308b\n    maxRow = wsheet.Cells(Rows.Count, 1).End(xlUp).row\n\n    ' \u5bfe\u8c61\u5217\u3092\u7bc4\u56f2\u3067\u53d6\u5f97\u3057\u3001\u914d\u5217\u306b\u3059\u308b\n    colData = wsheet.Range(wsheet.Cells(2, 1), wsheet.Cells(maxRow, 1))\n\n    ' \u5bfe\u8c61\u5217\u306e\u914d\u5217\u3092\u56de\u3057\u3066\u4f55\u304b\u51e6\u7406\u3059\u308b\n    For row = 1 To (maxRow - 1)\n        Cells(row, 5) = colData(row, 1)\n    Next row\n\n    wbook.Close False\n    Set xls = Nothing\n    Exit Sub\n\nException:\n    If Not wbook Is Nothing Then\n        wbook.Close False\n        Set xls = Nothing\n    End If\n\n    MsgBox Err.Description\nEnd Sub\n```\n\n## \u899a\u3048\u3066\u304a\u304f\u3068\u826f\u3055\u305d\u3046\u306a\u3053\u3068\n* `Range`\u306e\u5024\u3092`Variant`\u5909\u6570\u306b\u5165\u308c\u308b\u3068\u3001\u4e8c\u6b21\u5143\u914d\u5217\u3068\u3057\u3066\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n* `Err.Description`\u306b\u306f\u6a19\u6e96\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u5165\u308a\u307e\u3059\u3002`On Error GoTo ...`\u3092\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u306b\u8868\u793a\u3055\u308c\u308b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3068\u540c\u3058\u3082\u306e\u3067\u3059\u3002\n"}