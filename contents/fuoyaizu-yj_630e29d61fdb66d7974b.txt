{"context": "\n\n\u306f\u3058\u3081\u306b\nCloud Dataflow\u306eSDK\u3092\u59cb\u3081\u3066\u4f7f\u3046\u4eba\u5411\u3051\u3067\u3059\u3002\nCloud Dataflow Python SDK\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u4f7f\u3063\u3066\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u5b9f\u884c\u3068\u52d5\u4f5c\u78ba\u8a8d\u3092\u3057\u3066\u3044\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u524d\u63d0\u6761\u4ef6\nGoogle Cloud Platform\uff08GCP\uff09\u304c\u5229\u7528\u51fa\u6765\u308b\u72b6\u614b\u3067\uff11\u3064\u4ee5\u4e0a\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u6e08\u307f\n\n\u5b9f\u884c\u74b0\u5883\nGCP\u306eGoogle Cloud Shell\u3092\u4f7f\u7528\n\n\u624b\u9806\nGCP\u306eCloud Dataflow\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3042\u308b\u300cPython\u3092\u4f7f\u7528\u3057\u305f\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8\u300d\u306e\u624b\u9806\u3067\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\nPython\u3092\u4f7f\u7528\u3057\u305f\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8\u306f\u3053\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nhttps://cloud.google.com/dataflow/docs/quickstarts/quickstart-python\n\u79c1\u3060\u3051\u306a\u306e\u304b\u624b\u9806\u3069\u304a\u308a\u306b\u9032\u3081\u3066\u3082\u9014\u4e2d\u3067\u8a70\u307e\u3063\u3066\u3057\u307e\u3063\u305f\u3068\u3053\u308d\u304c\u3042\u308b\u306e\u3067\u5bfe\u5fdc\u3057\u305f\u3053\u3068\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u59cb\u3081\u308b\u524d\u306b\n\n\u30b9\u30c6\u30c3\u30d7\uff11\u304b\u30893\n\u624b\u9806\u3069\u304a\u308a\u9032\u3081\u3066\u3044\u3051\u3070\u554f\u984c\u306a\u3057\u3002\n\n\u30b9\u30c6\u30c3\u30d74\u3000Cloud SDK\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nCloud Shell\u3092\u4f7f\u3046\u306e\u3067\u30b9\u30ad\u30c3\u30d7\u3002\n\n\u30b9\u30c6\u30c3\u30d75\u3000Cloud Storage\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\n\u30d0\u30b1\u30c3\u30c8\u540d\u306fpython-test-dataflow\u3067\u4f5c\u6210\u3002\n\npip \u3068 Dataflow SDK \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n\u30b9\u30c6\u30c3\u30d71\u3000pip\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nGoogle Cloud Shell\u3092\u4f7f\u3046\u5834\u5408\u306f\u30b9\u30ad\u30c3\u30d7\u3067\u304d\u308b\u3068\u66f8\u3044\u3066\u3042\u308b\u306e\u3067\u30b9\u30ad\u30c3\u30d7\u3002\n\n\u30b9\u30c6\u30c3\u30d72\u3000\u6700\u65b0\u306eDataflow SDK for Python\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nCloud Shell\u3092\u8d77\u52d5\u3057\u4ee5\u4e0b\u3092\u5b9f\u884c\u3002\npip install google-cloud-dataflow\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u308b\u306e\u3067pip\u306e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3092\u5b9f\u65bd\u3002\nYou are using pip version 8.1.1, however version 9.0.1 is available.\nYou should consider upgrading via the 'pip install --upgrade pip' command.\n\npip\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\uff06Dataflow SDK for Python\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\nsudo pip install --upgrade pip\npip install google-cloud-dataflow\n\n\u4eca\u5ea6\u306fSDK\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u30fb\u30fb\u30fb\nCommand \"/usr/bin/python -u -c \"import setuptools, tokenize;__file__='/tmp/pip-build-cJ1Pwd/avro/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-rqFM9W-record/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-build-cJ1Pwd/avro/\n\n\u8272\u3005\u8a66\u3057\u305f\u3068\u3053\u308d\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3046\u307e\u304f\u3044\u304d\u307e\u3057\u305f\u3002\npip install google-cloud-dataflow --user\n\n\u203b --user\u304c\u5fc5\u8981\n\u53c2\u8003\uff1ahttp://googlecloudplatform-japan.blogspot.jp/2016/08/cloud-dataflow-python-sdk.html\n\n\u30b9\u30c6\u30c3\u30d73\u3000wordcount.py \u306e\u4f8b\u3092\u30ed\u30fc\u30ab\u30eb\u3067\u5b9f\u884c\npython -m apache_beam.examples.wordcount --output OUTPUT_FILE\n\n\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u5f8c\u306b\u3001\u4ee5\u4e0b\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u307e\u3057\u305f\u304c\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3053\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u308b\u5834\u5408\u304c\u3042\u308b\u3068\u66f8\u304b\u308c\u3066\u3044\u305f\u306e\u3067\u6c17\u306b\u305b\u305a\u5148\u306b\u9032\u3080\u3002\nINFO:root:Missing pipeline option (runner). Executing pipeline using the default runner: DirectPipelineRunner.\nINFO:oauth2client.client:Attempting refresh to obtain initial access_token\n\n\n\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u4f8b\u3092\u30ea\u30e2\u30fc\u30c8\u3067\u5b9f\u884c\u3059\u308b\n\n\u30b9\u30c6\u30c3\u30d71\u3000\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a\nCloud Shell\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c\u3002\nexport PROJECT=\u30d7\u30ed\u30b8\u30a7\u30af\u30c8ID \nexport BUCKET=gs://python-test-dataflow\n\n\n\u30b9\u30c6\u30c3\u30d72\u3000wordcount.py \u306e\u4f8b\u3092\u30ea\u30e2\u30fc\u30c8\u3067\u5b9f\u884c\npython -m apache_beam.examples.wordcount \\\n--project $PROJECT \\\n--job_name $PROJECT-wordcount \\\n--runner BlockingDataflowPipelineRunner \\\n--staging_location $BUCKET/staging \\\n--temp_location $BUCKET/temp \\\n--output $BUCKET/output\n\n\n\u30b9\u30c6\u30c3\u30d73\u3000\u30b8\u30e7\u30d6\u306e\u78ba\u8a8d\nGCP\u30b3\u30f3\u30bd\u30fc\u30eb\u306eDataflow\u304b\u3089\u30b8\u30e7\u30d6\u3092\u78ba\u8a8d\u3002\n\n\u30b8\u30e7\u30d6\u306e\u8a73\u7d30\n\n\u5b9f\u884c\u3057\u305f\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nhttps://github.com/apache/incubator-beam/blob/python-sdk/sdks/python/apache_beam/examples/wordcount.py\n\u203b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306f\u304a\u305d\u3089\u304f\u3053\u308c\u3067\u3042\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u9593\u9055\u3063\u3066\u3044\u305f\u3089\u3059\u307f\u307e\u305b\u3093\u3002\n\nwordcount.py\u3088\u308a\u4e00\u90e8\u629c\u7c8b\n  # Read the text file[pattern] into a PCollection.\n  lines = p | 'read' >> beam.io.Read(beam.io.TextFileSource(known_args.input))\n\n  # Count the occurrences of each word.\n  counts = (lines\n            | 'split' >> (beam.ParDo(WordExtractingDoFn())\n                          .with_output_types(unicode))\n            | 'pair_with_one' >> beam.Map(lambda x: (x, 1))\n            | 'group' >> beam.GroupByKey()\n            | 'count' >> beam.Map(lambda (word, ones): (word, sum(ones))))\n\n  # Format the counts into a PCollection of strings.\n  output = counts | 'format' >> beam.Map(lambda (word, c): '%s: %s' % (word, c))\n\n  # Write the output using a \"Write\" transform that has side effects.\n  # pylint: disable=expression-not-assigned\n  output | 'write' >> beam.io.Write(beam.io.TextFileSink(known_args.output))\n\n\n\u30b8\u30e7\u30d6\u306e\u8a73\u7d30\u3067read,split,\u30fb\u30fb\u30fbwrite\u306e\u51e6\u7406\u304c\u3069\u306e\u3088\u3046\u306b\u884c\u308f\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4f8b\uff09read\n\n\u4f8b\uff09split\n\n\u30b8\u30e7\u30d6\u306b\u3088\u3063\u3066\u4f5c\u6210\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\u3002\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3002\n\n\n\u304a\u308f\u308a\u306b\nCloud Shell\u3068Cloud Dataflow Python SDK\u3067Dataflow\u306e\u6d41\u308c\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\nCloud Dataflow Python SDK\u306f\u307e\u3060\u30d9\u30fc\u30bf\u7248\u306e\u3088\u3046\u306a\u306e\u3067\u5b9f\u969b\u306b\u4f7f\u3046\u306b\u306fJava SDK\u306e\u65b9\u304c\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\nDataflow\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u6b21\u306e\u3088\u3046\u306b\u66f8\u304b\u308c\u3066\u307e\u3057\u305f\u3002\n\u91cd\u8981: \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u306f\u3001\u5236\u9650\u306a\u3057 PCollection \u3068\u30a6\u30a3\u30f3\u30c9\u30a6\u51e6\u7406\u306e\u60c5\u5831\u304c\u542b\u307e\u308c\u307e\u3059\u3002\n\u3053\u308c\u3089\u306e\u6982\u5ff5\u306f Dataflow Java SDK \u306e\u307f\u306b\u8a72\u5f53\u3057\u307e\u3059\u3002\nDataflow Python SDK \u3067\u306f\u307e\u3060\u4f7f\u7528\u3067\u304d\u307e\u305b\u3093\u3002\n\n2016/11\u73fe\u5728\u3001Python SDK\u3067\u306f\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u306f\u3067\u304d\u306a\u3044\u3088\u3046\u3067\u3059\u3002\nJava SDK\u3092\u4f7f\u3063\u3066\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u8a66\u3057\u3066\u307f\u305f\u3044\u3068\u3044\u3046\u65b9\u306f\u3053\u3061\u3089\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\nGoogleCloud\u3067\u6c4e\u7528Database\u69cb\u7bc92 - DataFlow2 -\n# \u306f\u3058\u3081\u306b\nCloud Dataflow\u306eSDK\u3092\u59cb\u3081\u3066\u4f7f\u3046\u4eba\u5411\u3051\u3067\u3059\u3002\nCloud Dataflow Python SDK\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u4f7f\u3063\u3066\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u5b9f\u884c\u3068\u52d5\u4f5c\u78ba\u8a8d\u3092\u3057\u3066\u3044\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n# \u524d\u63d0\u6761\u4ef6\nGoogle Cloud Platform\uff08GCP\uff09\u304c\u5229\u7528\u51fa\u6765\u308b\u72b6\u614b\u3067\uff11\u3064\u4ee5\u4e0a\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u6e08\u307f\n\n# \u5b9f\u884c\u74b0\u5883\nGCP\u306eGoogle Cloud Shell\u3092\u4f7f\u7528\n\n\n# \u624b\u9806\nGCP\u306eCloud Dataflow\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3042\u308b\u300cPython\u3092\u4f7f\u7528\u3057\u305f\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8\u300d\u306e\u624b\u9806\u3067\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\nPython\u3092\u4f7f\u7528\u3057\u305f\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8\u306f\u3053\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nhttps://cloud.google.com/dataflow/docs/quickstarts/quickstart-python\n\n\n\u79c1\u3060\u3051\u306a\u306e\u304b\u624b\u9806\u3069\u304a\u308a\u306b\u9032\u3081\u3066\u3082\u9014\u4e2d\u3067\u8a70\u307e\u3063\u3066\u3057\u307e\u3063\u305f\u3068\u3053\u308d\u304c\u3042\u308b\u306e\u3067\u5bfe\u5fdc\u3057\u305f\u3053\u3068\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n## \u59cb\u3081\u308b\u524d\u306b\n### \u30b9\u30c6\u30c3\u30d7\uff11\u304b\u30893\n\u624b\u9806\u3069\u304a\u308a\u9032\u3081\u3066\u3044\u3051\u3070\u554f\u984c\u306a\u3057\u3002\n\n### \u30b9\u30c6\u30c3\u30d74\u3000Cloud SDK\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nCloud Shell\u3092\u4f7f\u3046\u306e\u3067\u30b9\u30ad\u30c3\u30d7\u3002\n\n### \u30b9\u30c6\u30c3\u30d75\u3000Cloud Storage\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\n\u30d0\u30b1\u30c3\u30c8\u540d\u306fpython-test-dataflow\u3067\u4f5c\u6210\u3002\n\n\n## pip \u3068 Dataflow SDK \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n### \u30b9\u30c6\u30c3\u30d71\u3000pip\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nGoogle Cloud Shell\u3092\u4f7f\u3046\u5834\u5408\u306f\u30b9\u30ad\u30c3\u30d7\u3067\u304d\u308b\u3068\u66f8\u3044\u3066\u3042\u308b\u306e\u3067\u30b9\u30ad\u30c3\u30d7\u3002\n\n### \u30b9\u30c6\u30c3\u30d72\u3000\u6700\u65b0\u306eDataflow SDK for Python\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nCloud Shell\u3092\u8d77\u52d5\u3057\u4ee5\u4e0b\u3092\u5b9f\u884c\u3002\n\n```\npip install google-cloud-dataflow\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u308b\u306e\u3067pip\u306e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3092\u5b9f\u65bd\u3002\n\n```\nYou are using pip version 8.1.1, however version 9.0.1 is available.\nYou should consider upgrading via the 'pip install --upgrade pip' command.\n```\n\npip\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\uff06Dataflow SDK for Python\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\n```\nsudo pip install --upgrade pip\npip install google-cloud-dataflow\n```\n\n\u4eca\u5ea6\u306fSDK\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u30fb\u30fb\u30fb\n\n```\nCommand \"/usr/bin/python -u -c \"import setuptools, tokenize;__file__='/tmp/pip-build-cJ1Pwd/avro/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" install --record /tmp/pip-rqFM9W-record/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /tmp/pip-build-cJ1Pwd/avro/\n```\n\n\u8272\u3005\u8a66\u3057\u305f\u3068\u3053\u308d\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3046\u307e\u304f\u3044\u304d\u307e\u3057\u305f\u3002\n\n```\npip install google-cloud-dataflow --user\n```\n\u203b --user\u304c\u5fc5\u8981\n\u53c2\u8003\uff1ahttp://googlecloudplatform-japan.blogspot.jp/2016/08/cloud-dataflow-python-sdk.html\n\n\n### \u30b9\u30c6\u30c3\u30d73\u3000wordcount.py \u306e\u4f8b\u3092\u30ed\u30fc\u30ab\u30eb\u3067\u5b9f\u884c\n```\npython -m apache_beam.examples.wordcount --output OUTPUT_FILE\n```\n\n\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u5f8c\u306b\u3001\u4ee5\u4e0b\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u307e\u3057\u305f\u304c\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3053\u306e\u3088\u3046\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u308b\u5834\u5408\u304c\u3042\u308b\u3068\u66f8\u304b\u308c\u3066\u3044\u305f\u306e\u3067\u6c17\u306b\u305b\u305a\u5148\u306b\u9032\u3080\u3002\n\n```\nINFO:root:Missing pipeline option (runner). Executing pipeline using the default runner: DirectPipelineRunner.\nINFO:oauth2client.client:Attempting refresh to obtain initial access_token\n```\n\n## \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306e\u4f8b\u3092\u30ea\u30e2\u30fc\u30c8\u3067\u5b9f\u884c\u3059\u308b\n### \u30b9\u30c6\u30c3\u30d71\u3000\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a\nCloud Shell\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c\u3002\n\n```\nexport PROJECT=\u30d7\u30ed\u30b8\u30a7\u30af\u30c8ID \nexport BUCKET=gs://python-test-dataflow\n```\n\n### \u30b9\u30c6\u30c3\u30d72\u3000wordcount.py \u306e\u4f8b\u3092\u30ea\u30e2\u30fc\u30c8\u3067\u5b9f\u884c\n\n```\npython -m apache_beam.examples.wordcount \\\n--project $PROJECT \\\n--job_name $PROJECT-wordcount \\\n--runner BlockingDataflowPipelineRunner \\\n--staging_location $BUCKET/staging \\\n--temp_location $BUCKET/temp \\\n--output $BUCKET/output\n```\n\n### \u30b9\u30c6\u30c3\u30d73\u3000\u30b8\u30e7\u30d6\u306e\u78ba\u8a8d\nGCP\u30b3\u30f3\u30bd\u30fc\u30eb\u306eDataflow\u304b\u3089\u30b8\u30e7\u30d6\u3092\u78ba\u8a8d\u3002\n<img width=\"930\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-17 11.22.31.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/113045/5a8083a5-913f-167e-bb02-89063fe7b5f0.png\">\n\n\u30b8\u30e7\u30d6\u306e\u8a73\u7d30\n<img width=\"774\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-17 11.25.26.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/113045/47ffcb67-3e19-145e-814e-cdc8fd3386e9.png\">\n\n\u5b9f\u884c\u3057\u305f\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nhttps://github.com/apache/incubator-beam/blob/python-sdk/sdks/python/apache_beam/examples/wordcount.py\n\u203b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306f\u304a\u305d\u3089\u304f\u3053\u308c\u3067\u3042\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u9593\u9055\u3063\u3066\u3044\u305f\u3089\u3059\u307f\u307e\u305b\u3093\u3002\n\n```python:wordcount.py\u3088\u308a\u4e00\u90e8\u629c\u7c8b\n  # Read the text file[pattern] into a PCollection.\n  lines = p | 'read' >> beam.io.Read(beam.io.TextFileSource(known_args.input))\n\n  # Count the occurrences of each word.\n  counts = (lines\n            | 'split' >> (beam.ParDo(WordExtractingDoFn())\n                          .with_output_types(unicode))\n            | 'pair_with_one' >> beam.Map(lambda x: (x, 1))\n            | 'group' >> beam.GroupByKey()\n            | 'count' >> beam.Map(lambda (word, ones): (word, sum(ones))))\n\n  # Format the counts into a PCollection of strings.\n  output = counts | 'format' >> beam.Map(lambda (word, c): '%s: %s' % (word, c))\n\n  # Write the output using a \"Write\" transform that has side effects.\n  # pylint: disable=expression-not-assigned\n  output | 'write' >> beam.io.Write(beam.io.TextFileSink(known_args.output))\n```\n\n\u30b8\u30e7\u30d6\u306e\u8a73\u7d30\u3067read,split,\u30fb\u30fb\u30fbwrite\u306e\u51e6\u7406\u304c\u3069\u306e\u3088\u3046\u306b\u884c\u308f\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u4f8b\uff09read\n<img width=\"743\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-17 11.46.54.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/113045/0c229b2b-2e1b-139d-02a9-c05d66b1b525.png\">\n\n\u4f8b\uff09split\n<img width=\"704\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-17 11.47.14.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/113045/fdfdfcd8-3987-b1a9-a1dc-6ecddd5c48aa.png\">\n\n\n\u30b8\u30e7\u30d6\u306b\u3088\u3063\u3066\u4f5c\u6210\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\u3002\n<img width=\"563\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-17 18.07.23.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/113045/6b056a98-92e7-2841-1c78-8576a0a4dcb1.png\">\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3002\n<img width=\"378\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-17 18.07.47.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/113045/8e4c4541-4b3f-a96c-163a-d6ecaeb7e864.png\">\n\n\n\n# \u304a\u308f\u308a\u306b\nCloud Shell\u3068Cloud Dataflow Python SDK\u3067Dataflow\u306e\u6d41\u308c\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\nCloud Dataflow Python SDK\u306f\u307e\u3060\u30d9\u30fc\u30bf\u7248\u306e\u3088\u3046\u306a\u306e\u3067\u5b9f\u969b\u306b\u4f7f\u3046\u306b\u306fJava SDK\u306e\u65b9\u304c\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n[Dataflow\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](https://cloud.google.com/dataflow/model/pcollection)\u306b\u6b21\u306e\u3088\u3046\u306b\u66f8\u304b\u308c\u3066\u307e\u3057\u305f\u3002\n\n```\n\u91cd\u8981: \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u306f\u3001\u5236\u9650\u306a\u3057 PCollection \u3068\u30a6\u30a3\u30f3\u30c9\u30a6\u51e6\u7406\u306e\u60c5\u5831\u304c\u542b\u307e\u308c\u307e\u3059\u3002\n\u3053\u308c\u3089\u306e\u6982\u5ff5\u306f Dataflow Java SDK \u306e\u307f\u306b\u8a72\u5f53\u3057\u307e\u3059\u3002\nDataflow Python SDK \u3067\u306f\u307e\u3060\u4f7f\u7528\u3067\u304d\u307e\u305b\u3093\u3002\n```\n2016/11\u73fe\u5728\u3001Python SDK\u3067\u306f\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u306f\u3067\u304d\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\nJava SDK\u3092\u4f7f\u3063\u3066\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u8a66\u3057\u3066\u307f\u305f\u3044\u3068\u3044\u3046\u65b9\u306f\u3053\u3061\u3089\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n[GoogleCloud\u3067\u6c4e\u7528Database\u69cb\u7bc92 - DataFlow2 -](http://qiita.com/tstakano-yj/items/e30cc393dbb6e99e42ec#_reference-24dcb3141858b6958b26)\n", "tags": ["GoogleCloudPlatform", "GoogleCloudDataflow"]}