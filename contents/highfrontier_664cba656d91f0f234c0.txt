{"context": " More than 1 year has passed since last update.TeX\u3092\u4f7f\u3044\u305f\u3044\u3068\u304d\u306binstall-tl-ubuntu\u3092\u4f7f\u3063\u3066\u3044\u308b\u3002\n\u305f\u3060\u3057\u3001vagrant-lxc\u306e\u3088\u3046\u306a\u30b3\u30f3\u30c6\u30ca\u74b0\u5883\u3067provisioning\u3059\u308b\u3068\u304d\u306b\u305d\u306e\u307e\u307e\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3046\u3068\u3001\u305d\u306e\u305f\u3073\u306b\u5927\u91cf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304c\u767a\u751f\u3059\u308b\u306e\u3067\u597d\u307e\u3057\u304f\u306a\u3044\u3002\n\u305d\u3053\u3067\n$ sudo bash install-tl-ubuntu -i /vagrant/texlive2014-20140525.iso\n\n\u3068\u3057\u305f\u3044\u308f\u3051\u3060\u304c\u3001\n\nmount: block device /dev/loop0 is write-protected, mounting read-only\nmount: cannot mount block device /dev/loop0 read-only\n\n\u306a\u3069\u3068\u6012\u3089\u308c\u3066\u30de\u30a6\u30f3\u30c8\u3067\u304d\u306a\u3044\u3002\n\u3053\u306e\u3088\u3046\u306a\u3068\u304d\u306f\u3001host\u5074\u3067\u4ee5\u4e0b\u306e\u64cd\u4f5c\u3067iso9660\u3067\u3082loopback\u30c7\u30d0\u30a4\u30b9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u3002\nsudo tee /etc/apparmor.d/lxc/lxc-default-with-mounting-custom <<EOF\nprofile lxc-container-default-with-mounting-custom flags=(attach_disconnected,mediate_deleted) {\n  #include <abstractions/lxc/container-base>\n  mount fstype=ext*,\n  mount fstype=xfs,\n  mount fstype=btrfs,\n  mount fstype=iso9660,\n}\nEOF\nsudo apparmor_parser --replace /etc/apparmor.d/lxc-containers\n\n\u81ea\u5206\u306e\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u7528\u306eVagrantfile\u306f\u3053\u3093\u306a\u611f\u3058\n\nVAGRANTFILE_API_VERSION = \"2\"\nVagrant.configure(VAGRANTFILE_API_VERSION) do config\n  config.vm.box = 'fgrehm/trusty64-lxc'\n  config.vm.define \"test\"\n  config.vm.provider :lxc do lxc\n    # allow_loop-back_device\n    lxc.customize 'aa_profile', 'lxc-container-default-with-mounting-custom'\n    lxc.customize 'cgroup.devices.allow', 'b 7:* rwm'\n    lxc.customize 'cgroup.devices.allow', 'c 10:237 rwm'\n  end\n  config.vm.provision :shell, :path =>\u3000 \"https://gist.githubusercontent.com/\u3054\u306b\u3087\u3054\u306b\u3087/raw/site.sh\", :privileged => false\nend\n\n\u3067\u3001\u7acb\u3061\u4e0a\u3052\u308b\u3068\nvagrant@vagrant-base-trusty-amd64:~$ sudo mount -t iso9660 -o loop,ro /vagrant/texlive2014-20140525.iso /mnt\nvagrant@vagrant-base-trusty-amd64:~$ ls /mnt\narchive index.html install-tl-advanced.bat LICENSE.CTAN README\nreadme-txt.dir release-texlive.txt texlive-doc tl-tray-menu.exe\nautorun.inf install-tl install-tl-windows.bat LICENSE.TL readme-html.dir\nREADME.usergroups source tlpkg\nvagrant@vagrant-base-trusty-amd64:~$\n\n\u3053\u308c\u3067 install-tl-ubuntu -i /vagrant/texlive2014-20140525.iso \u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\nTeX\u3092\u4f7f\u3044\u305f\u3044\u3068\u304d\u306binstall-tl-ubuntu\u3092\u4f7f\u3063\u3066\u3044\u308b\u3002\n\u305f\u3060\u3057\u3001vagrant-lxc\u306e\u3088\u3046\u306a\u30b3\u30f3\u30c6\u30ca\u74b0\u5883\u3067provisioning\u3059\u308b\u3068\u304d\u306b\u305d\u306e\u307e\u307e\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3046\u3068\u3001\u305d\u306e\u305f\u3073\u306b\u5927\u91cf\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304c\u767a\u751f\u3059\u308b\u306e\u3067\u597d\u307e\u3057\u304f\u306a\u3044\u3002\n\u305d\u3053\u3067\n\n```{.sh}\n$ sudo bash install-tl-ubuntu -i /vagrant/texlive2014-20140525.iso\n```\n\u3068\u3057\u305f\u3044\u308f\u3051\u3060\u304c\u3001\n```\nmount: block device /dev/loop0 is write-protected, mounting read-only\nmount: cannot mount block device /dev/loop0 read-only\n```\n\u306a\u3069\u3068\u6012\u3089\u308c\u3066\u30de\u30a6\u30f3\u30c8\u3067\u304d\u306a\u3044\u3002\n\u3053\u306e\u3088\u3046\u306a\u3068\u304d\u306f\u3001host\u5074\u3067\u4ee5\u4e0b\u306e\u64cd\u4f5c\u3067iso9660\u3067\u3082loopback\u30c7\u30d0\u30a4\u30b9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n```{.bash}\nsudo tee /etc/apparmor.d/lxc/lxc-default-with-mounting-custom <<EOF\nprofile lxc-container-default-with-mounting-custom flags=(attach_disconnected,mediate_deleted) {\n  #include <abstractions/lxc/container-base>\n  mount fstype=ext*,\n  mount fstype=xfs,\n  mount fstype=btrfs,\n  mount fstype=iso9660,\n}\nEOF\nsudo apparmor_parser --replace /etc/apparmor.d/lxc-containers\n```\n\u81ea\u5206\u306e\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u7528\u306eVagrantfile\u306f\u3053\u3093\u306a\u611f\u3058\n\n> VAGRANTFILE_API_VERSION = \"2\"\n> \n> Vagrant.configure(VAGRANTFILE_API_VERSION) do config\n>   config.vm.box = 'fgrehm/trusty64-lxc'\n>   config.vm.define \"test\"\n>   config.vm.provider :lxc do lxc\n>     # allow_loop-back_device\n>     lxc.customize 'aa_profile', 'lxc-container-default-with-mounting-custom'\n>     lxc.customize 'cgroup.devices.allow', 'b 7:* rwm'\n>     lxc.customize 'cgroup.devices.allow', 'c 10:237 rwm'\n>   end\n>   config.vm.provision :shell, :path =>\u3000 \"https://gist.githubusercontent.com/\u3054\u306b\u3087\u3054\u306b\u3087/raw/site.sh\", :privileged => false\n> end\n\n\u3067\u3001\u7acb\u3061\u4e0a\u3052\u308b\u3068\n\n```{.bash}\nvagrant@vagrant-base-trusty-amd64:~$ sudo mount -t iso9660 -o loop,ro /vagrant/texlive2014-20140525.iso /mnt\nvagrant@vagrant-base-trusty-amd64:~$ ls /mnt\narchive index.html install-tl-advanced.bat LICENSE.CTAN README\nreadme-txt.dir release-texlive.txt texlive-doc tl-tray-menu.exe\nautorun.inf install-tl install-tl-windows.bat LICENSE.TL readme-html.dir\nREADME.usergroups source tlpkg\nvagrant@vagrant-base-trusty-amd64:~$\n```\n\n\u3053\u308c\u3067 install-tl-ubuntu -i /vagrant/texlive2014-20140525.iso \u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\n", "tags": ["lxc", "vagrant"]}