{"context": "\n\n\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\nhttps://www.dropbox.com/s/wow1qe5l16z56lp/export.zip?dl=0\n\u4ed6\u306eFMP12\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30c6\u30fc\u30d6\u30eb\u3068\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u3053\u3068\u3067\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n\n\u3084\u308b\u3053\u3068\n\nExecuteSQL\u3067\u3001\u904b\u7528\u4e2d\u306e\u5168\u30c6\u30fc\u30d6\u30eb\u306e\u5168\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u5185\u5bb9\u3092\u3001\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306b\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067\u4fdd\u5b58\u3057\u3066\u30ed\u30b0\u3092\u53d6\u308b\n\u4f5c\u6210\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u3001ZIP\u3067\u5727\u7e2e\u3057\u3066\u4fdd\u5b58\u3059\u308b\u3002\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664\u3059\u308b\u3002\n\u4ee5\u4e0a\u306e\uff12\u70b9\u3092Windows\u7248 FileMaker Pro \u3068\u30d5\u30ea\u30fc\u30bd\u30d5\u30c8\u306e\u307f\u3067\u884c\u3046\uff08\u6709\u6599\u30d7\u30e9\u30b0\u30a4\u30f3\u3068\u304b\u4f59\u8a08\u306a\u304a\u91d1\u3092\u767a\u751f\u3055\u305b\u306a\u3044\uff09\n\n\n\u4f5c\u6210\u3057\u305f\u52d5\u6a5f\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u6a2a\u65ad\u3057\u3066\u691c\u7d22\u3057\u305f\u3044\nFileMaker Server\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u904b\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u3066\u304a\u3051\u3070\u300c\u6bce\u65e5\u300d\u300c\u6bce\u6642\u300d\u306a\u3069\u306e\u3088\u3046\u306a\u5b9a\u671f\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u7c21\u5358\u306b\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u8a2d\u5b9a\u6b21\u7b2c\u3067\u904b\u7528\u4e2d\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4ed6\u306b\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u5185\u5bb9\u3092\u7a7a\u306b\u3057\u305f\u300c\u30af\u30ed\u30fc\u30f3\u300d\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u308a\u3068\u3001\u901a\u5e38\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u904b\u7528\u3059\u308b\u4e0a\u3067\u306f\u56f0\u308b\u3053\u3068\u306f\u307b\u307c\u7121\u3044\u3068\u3044\u3048\u308b\u5f37\u529b\u306a\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u6a5f\u80fd\u3092\u6709\u3057\u3066\u3044\u307e\u3059\u3002\n\u3068\u3053\u308d\u304c\u3001\u3053\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3067\u4f5c\u6210\u3055\u308c\u308b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306f\u3001\u4e0b\u306b\u8a18\u8f09\u3057\u305f\u3088\u3046\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u3092\u6301\u3064\u3001\u305d\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3054\u3068\u306b\u500b\u5225\u306eFileMaker\uff08*.fmp12)\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\u904b\u7528\u4e2d\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4f55\u304b\u3057\u3089\u306e\u969c\u5bb3\u304c\u767a\u751f\u3057\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306b\u5dee\u3057\u66ff\u3048\u308b\u306a\u3069\u306e\u5834\u5408\u306f\u624b\u8efd\u306b\u5b9f\u884c\u3067\u304d\u3066\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u6642\u306b\u306f\u3053\u308c\u3067\u306f\u56f0\u308b\u3053\u3068\u3082\u6709\u308a\u307e\u3059\u3002\n>FileMaker \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3067\u4f5c\u6210\u3055\u308c\u308b\u30d5\u30a1\u30a4\u30eb\u30c4\u30ea\u30fc\u306e\u4f8b\n>    \u251c\u2500\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\uff08\u30b0\u30eb\u30fc\u30d7\uff11\uff09_2016-01-10_2300\u3000//\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5b9f\u884c\u5358\u4f4d\u3067\u4f5c\u6210\uff08\u3053\u306e\u5834\u5408\u6bce\u65e523:00\u306b\u5b9f\u884c\uff09\n> \u2502  \u2502  \u251c\u2500Cloned_by_FMS_2016-01-10_2300\u3000        //\u30af\u30ed\u30fc\u30f3\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n> \u2502  \u2502  \u2502  \u2514\u2500Databases\n> \u2502  \u2502  \u2502      \u2514\u2500\u30b0\u30eb\u30fc\u30d7\uff11\n> \u2502  \u2502  \u2502              Database1\u30af\u30ed\u30fc\u30f3.fmp12\n> \u2502  \u2502  \u2502              Database2\u30af\u30ed\u30fc\u30f3.fmp12\n> \u2502  \u2502  \u2514\u2500Databases //\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u672c\u4f53\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n> \u2502  \u2502      \u2514\u2500\u30b0\u30eb\u30fc\u30d7\uff11\n> \u2502  \u2502          \u2502  Database1.fmp12\n> \u2502  \u2502          \u2502  Database2.fmp12\n> \u2502  \u2502          \u2514\u2500RC_Data_FMS                    //\u5916\u90e8\u4fdd\u5b58\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff08\u753b\u50cf\u306a\u3069\uff09\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n> \u2502  \u2502              \u2514\u2500Database1\n> \u2502  \u2502                  \u2514\u2500Photostock\n> \u2502  \u2502                      \u2514\u2500\u5199\u771f\u7ba1\u7406\u30c6\u30fc\u30d6\u30eb\n> \u2502  \u2502                          \u2514\u2500\u5199\u771f\n> \u2502  \u2502                                  RIMG0367.jpg\n> \u2502  \u2502                                  RIMG0377.jpg\n> \u2502  \u2502                                  RIMG0421.jpg\n\n\u4f8b\u3048\u3070\u3001\u300c\u5165\u529b\u3057\u305f\u306f\u305a\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u6d88\u5931\u3057\u3066\u3044\u308b\u300d\u73fe\u8c61\u304c\u8d77\u304d\u305f\u5834\u5408\u3001\u3053\u308c\u3089\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u7fa4\u304b\u3089\u300c\u3044\u3064\u6d88\u5931\u3057\u305f\u304b\u300d\u3092\u7279\u5b9a\u3059\u308b\u3053\u3068\u306f\u524a\u9664\u6642\u306b\u30ed\u30b0\u3092\u53d6\u308b\u3088\u3046\u306a\u4ed5\u69d8\u306b\u3067\u3082\u3057\u3066\u3044\u306a\u3044\u9650\u308a\u3001\u975e\u5e38\u306b\u30b3\u30b9\u30c8\u304c\u304b\u304b\u308b\u4f5c\u696d\u306b\u306a\u308a\u307e\u3059\u3002\nFileMaker\u306e\u6a19\u6e96\u6a5f\u80fd\u3067\u306f\u3001Grep\u306e\u3088\u3046\u306b\u8907\u6570\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u691c\u7d22\u3067\u304d\u307e\u305b\u3093\u3002\u884c\u3046\u5834\u5408\u306f\uff11\u30d5\u30a1\u30a4\u30eb\u3054\u3068\u306b\u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u30b7\u30c3\u30d7\u3092\u8a2d\u5b9a\u3059\u308b\u304b\u3001\u30a4\u30f3\u30dd\u30fc\u30c8\u7528\u306e\u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30d5\u30a1\u30a4\u30eb\u3054\u3068\u306b\u30a4\u30f3\u30dd\u30fc\u30c8\u3092\u5b9f\u884c\u3057\u3001\u3069\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u305f\u304b\u3092\u30ec\u30b3\u30fc\u30c9\u306b\u8a18\u5165\u3057\u3066\u8b58\u5225\u3059\u308b\u306a\u3069\u306e\u5de5\u592b\u304c\u5fc5\u8981\u3067\u3059\u3002\u3069\u3061\u3089\u3082\u624b\u52d5\u3067\u884c\u308f\u306a\u3051\u308c\u3070\u306a\u3089\u305a\u3001\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u3084\u691c\u8a3c\u306e\u305f\u3081\u306b\u9010\u4e00\u3053\u306e\u3088\u3046\u306a\u4f5c\u696d\u3092\u884c\u3046\u306e\u306f\u30b3\u30b9\u30c8\u304c\u304b\u304b\u308b\u306e\u3067\u5225\u306e\u65b9\u7b56\u3092\u8003\u3048\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\u3053\u3046\u306a\u308b\u3068\u6f54\u304f\u5168\u30c6\u30fc\u30d6\u30eb\u5185\u5bb9\u3092\u30c6\u30ad\u30b9\u30c8\u3067\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u304a\u3044\u3066\u3001\u5fc5\u8981\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u306a\u3069\u306eGrep\u304c\u4f7f\u3048\u308b\u30c4\u30fc\u30eb\u3067\u691c\u7d22\u5b9f\u884c\u3092\u3057\u305f\u307b\u3046\u304c\u4f4e\u30b3\u30b9\u30c8\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u554f\u984c\u306f\u3069\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3059\u308b\u304b\u3067\u3059\u3002\n\n\u4f5c\u6210\u624b\u9806\n\n\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3067\u30ed\u30b0\u3092\u4fdd\u5b58\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\nFileMaker\u3067\u3082\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\uff08CSV\u3001\u30bf\u30d6\u533a\u5207\u308a\u3001Merge\u30d5\u30a1\u30a4\u30eb\uff09\u3067\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u306f\u6a19\u6e96\u6a5f\u80fd\u3067\u5099\u308f\u3063\u3066\u304a\u308a\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089\u5b9f\u884c\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u306e\u3067\u3001Server\u5074\u3067\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\u3001\u524d\u8ff0\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u3088\u3046\u306b\u5b9a\u671f\u7684\u306b\u30c6\u30fc\u30d6\u30eb\u306e\u5168\u5185\u5bb9\u3092\u66f8\u304d\u3060\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068\u3057\u3066\u4fdd\u5b58\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3088\u308b\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3067\u306f\u5bfe\u8c61\u3068\u306a\u308b\u30c6\u30fc\u30d6\u30eb\u3068\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u4e0b\u306e\u3088\u3046\u306a\u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u4e88\u3081\u8a2d\u5b9a\u3057\u3066\u304a\u304b\u306a\u3051\u308c\u3070\u306a\u3089\u305a\u3001\u5909\u6570\u7684\u306a\u8a2d\u5b9a\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\n\u3064\u307e\u308a\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u30b9\u30c6\u30c3\u30d7\u304c\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u9020\u306b\u4f9d\u5b58\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u306e\u3067\u3001\u30d5\u30a1\u30a4\u30eb\u5185\u90e8\u306b\u8907\u6570\u306e\u30c6\u30fc\u30d6\u30eb\u304c\u3042\u308b\u5834\u5408\u306f\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u305f\u3044\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306b\u9010\u6b21\u30b9\u30af\u30ea\u30d7\u30c8\u30b9\u30c6\u30c3\u30d7\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30d5\u30a1\u30a4\u30eb\u5185\u3067\u4fdd\u6301\u3059\u308b\u30c6\u30fc\u30d6\u30eb\u6570\u30fb\u30d5\u30a3\u30fc\u30eb\u30c9\u6570\u306b\u5897\u6e1b\u304c\u3042\u3063\u305f\u6642\u306b\u90fd\u5ea6\u30b9\u30af\u30ea\u30d7\u30c8\u30b9\u30c6\u30c3\u30d7\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3001\u3068\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u6027\u306e\u60aa\u3044\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u306a\u308b\u4e88\u611f\u304c\u3057\u307e\u3059\u3002\u307e\u305f\u5225\u306e\u65b9\u7b56\u3092\u8003\u3048\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\nExecuteSQL\u306b\u3088\u308b\u30c6\u30fc\u30d6\u30eb\u3001\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u5f97\nFileMaker\u95a2\u6570\u306e\u4e2d\u306b\u306fExecuteSQL\u3068\u3044\u3046\u95a2\u6570\u304c\u3042\u308a\u3001\u672c\u6765\u8a2d\u5b9a\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u30c6\u30fc\u30d6\u30eb\u30aa\u30ab\u30ec\u30f3\u30b9\u3054\u3068\u306e\u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u30b7\u30c3\u30d7\u304c\u7121\u304f\u3068\u3082\uff08\u3069\u3053\u304b\u3089\u3067\u3082\uff09\u30c6\u30fc\u30d6\u30eb\u306e\u5185\u5bb9\u3092SQL\u30af\u30a8\u30ea\u3067\u62bd\u51fa\u3057\u305f\u5024\u3092\u5f97\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3068\u3044\u3046\u4fbf\u5229\u306a\u95a2\u6570\u304c\u3042\u308a\u307e\u3059\u3002\nExecuteSQL\u3067\u306f\u30c6\u30fc\u30d6\u30eb\u306b\u4fdd\u5b58\u3055\u308c\u305f\u5024\u306e\u307f\u306a\u3089\u305a\u3001FileMaker \u30b7\u30b9\u30c6\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u3044\u3046\u3001\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u30c6\u30fc\u30d6\u30eb\u69cb\u9020\u3084\u30d5\u30a3\u30fc\u30eb\u30c9\u69cb\u9020\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5177\u4f53\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306a\u8a08\u7b97\u5f0f\u306b\u306a\u308a\u307e\u3059\u3002\n\nExecuteSQL.fmp12\n//\u30d5\u30a1\u30a4\u30eb\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u30d9\u30fc\u30b9\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u91cd\u8907\u3092\u9664\u3044\u3066\u53d6\u5f97\nExecuteSQL(\"SELECT DISTINCT BaseTableName from Filemaker_Tables\";\"\";\"\")\n\n//\u3042\u308b\u30c6\u30fc\u30d6\u30eb($tablename)\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u96c6\u8a08\u30fb\u8a08\u7b97\u30bf\u30a4\u30d7\u3092\u9664\u3044\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3092\u53d6\u5f97\nExecuteSQL(\"SELECT FieldName FROM FileMaker_Fields WHERE TableName = ? AND FieldClass='Normal'  \";\"\";\"\";$tablename)\n\n\n\u3053\u308c\u3089\u306e\u5f0f\u3067\u5f97\u3089\u308c\u305f\u5024\u3092\u57fa\u306b\u3001Loop\u3067\u5404\u30d9\u30fc\u30b9\u30c6\u30fc\u30d6\u30eb\uff08\u30c6\u30fc\u30d6\u30eb\u30aa\u30ab\u30ec\u30f3\u30b9\u306e\u57fa\u3068\u306a\u308b\u30c6\u30fc\u30d6\u30eb\u3002\u300c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7ba1\u7406\uff0f\u30c6\u30fc\u30d6\u30eb\u3067\u4f5c\u6210\u3059\u308b\u30c6\u30fc\u30d6\u30eb\uff09\u306e\u5185\u5bb9\u3092ExecuteSQL\u3067\u53d6\u5f97\u3057\u3001\u9010\u6b21\u30c6\u30ad\u30b9\u30c8\u306b\u66f8\u304d\u3060\u3059\u306e\u304c\u3088\u3055\u305d\u3046\u3067\u3059\u3002\n\u91cd\u8907\u3092\u9664\u3044\u305f\u30c6\u30fc\u30d6\u30eb\u540d\u306e\u4e00\u89a7\u304c\u53d6\u5f97\u3067\u304d\u308c\u3070\u3001\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u7528\u3044\u3066\u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u5bb9\u306e\u5168\u3066\u3092\u53d6\u5f97\u3059\u308c\u3070\u826f\u3044\u3088\u3046\u306a\u6c17\u304c\u3057\u307e\u3059\u304c\u3001\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u4e2d\u306b\u306f\u300c\u8a08\u7b97\u300d\u300c\u96c6\u8a08\u300d\u30bf\u30a4\u30d7\u306e\u3082\u306e\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3067\u306f\u3053\u308c\u3089\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3082\u53d6\u5f97\u306e\u5bfe\u8c61\u3068\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u3053\u306e\uff12\u30bf\u30a4\u30d7\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u5024\u3092\u90fd\u5ea6\u8a08\u7b97\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\u305f\u3081\u3001\u51e6\u7406\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u4e0a\u306b\u3001\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3057\u3066\u3082\u610f\u5473\u304c\u7121\u3044\u3053\u3068\u304c\u307b\u3068\u3093\u3069\u3067\u3059\u306e\u3067\u9664\u5916\u3057\u305f\u307b\u3046\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002SQL\u30af\u30a8\u30ea\u306eWHERE\u53e5\u3067 FieldClass='Normal'\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u9664\u5916\u3067\u304d\u307e\u3059\u3002\n\u3053\u3046\u3057\u3066\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3059\u308b\u3079\u304d\u30c6\u30fc\u30d6\u30eb\u540d\u3068\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u3042\u3068\u306f\u6b21\u306e\u3088\u3046\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30c6\u30fc\u30d6\u30eb\u3054\u3068Loop\u3092\u56de\u3057\u3066\u53d6\u5f97\u3057\u305f\u5024\u3092\u66f8\u304d\u51fa\u305b\u3070\u3001\u30c6\u30fc\u30d6\u30eb\u6bce\u306e\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u304c\u53ef\u80fd\u3067\u3059\u3002\n\nexport.fmp12\n001: \u30ec\u30a4\u30a2\u30a6\u30c8\u5207\u308a\u66ff\u3048 [ \u300cSYS_BACKUP\u300d (SYS_BACKUP) ]\n002: \u5909\u6570\u3092\u8a2d\u5b9a [ $dirpath; \u5024:\"Z:\\log\\textfile\\\\\" //\u30ed\u30b0\u3092\u51fa\u529b\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30d1\u30b9 ] \n003: \u5909\u6570\u3092\u8a2d\u5b9a [ $dir; \u5024:Let([ %head = \"file:/\" ]; %head & Substitute ( $dirpath ; \"\\\\\" ; \"/\" ) ) //FileMaker\u7528\u306b\u30d1\u30b9\u3092\u52a0\u5de5 ]\n004: \u5909\u6570\u3092\u8a2d\u5b9a [ $date; \u5024:Substitute(Get(\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7)&\"_\"&Get(\u30a2\u30ab\u30a6\u30f3\u30c8\u540d);[\" \";\"-\"];[\"/\";\"-\"];[\":\";\"-\"]) //\u51fa\u529b\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u540d]\n005: \n006: #\u5168\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u53d6\u5f97\n007: \u5909\u6570\u3092\u8a2d\u5b9a [ $exclude_table; \u5024:\"'SYS_BACKUP','TEST_TABLE'\" //\u9664\u5916\u3059\u308b\u30c6\u30fc\u30d6\u30eb]\n008: \u5909\u6570\u3092\u8a2d\u5b9a [ $table_list; \u5024:Let ( [ notin = \"WHERE BaseTableName NOT IN(\"& $exclude_table &\")\"; query   = \" SELECT  BaseTableName FROM  Filemaker_tables \"&notin ] ; ExecuteSQL ( query ; \"\" ; \"\" ) ) ]\n009: \u5909\u6570\u3092\u8a2d\u5b9a [ $vc_table; \u5024:ValueCount($table_list) ]\n010: \u5909\u6570\u3092\u8a2d\u5b9a [ $i; \u5024:1 ]\n011: #Loop\u3067\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306e\u30c7\u30fc\u30bf\u3092ExecuteSQL\u3067\u53d6\u5f97\u3057\u3001\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u51fa\u3059\n012: \n013: \u5909\u6570\u3092\u8a2d\u5b9a [ $i; \u5024:1 ]\n014: Loop\n015:   Exit Loop If [ $i > $vc_table ]\n016:   #\u51fa\u529b\u3059\u308b\u30c7\u30fc\u30bf\u306e\u30d8\u30c3\u30c0\uff08\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\uff09\u3092\u53d6\u5f97\n017:   \u5909\u6570\u3092\u8a2d\u5b9a [ $table_name; \u5024:GetValue ( $table_list ; $i ) ]\n018:   \u5909\u6570\u3092\u8a2d\u5b9a [ $header; \u5024:Let ( [ query  = \" SELECT  FieldName FROM  Filemaker_Fields WHERE  TableName = ? AND FieldClass = 'Normal' \" ] ; ExecuteSQL ( query ; \"\" ; \"\" ;$table_name) ) ]\n019:   \u5909\u6570\u3092\u8a2d\u5b9a [ $vc_header; \u5024:ValueCount($header) ]\n020:   \u5909\u6570\u3092\u8a2d\u5b9a [ $j; \u5024:1 ]\n021:   #\u30d8\u30c3\u30c0\u3092SQL\u306b\u9069\u3057\u305f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u3059\u308b\n022:   Loop\n023:     Exit Loop If [ $j > $vc_header ]\n024:       \u5909\u6570\u3092\u8a2d\u5b9a [ $sql_header; \u5024:If($j > 1;$sql_header & \",\") & Quote(GetValue($header;$j)) ]\n025:       \u5909\u6570\u3092\u8a2d\u5b9a [ $j; \u5024:$j + 1 ]\n026:     End Loop\n027:     #\u53d6\u5f97\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u5024\u306b\u542b\u307e\u308c\u308b\u6539\u884c\u533a\u5207\u308a\u30c7\u30fc\u30bf\u3092\u300c|\u300d\u3067\u7f6e\u63db\u3059\u308b\n028:     \u5909\u6570\u3092\u8a2d\u5b9a [ $dump; \u5024:Let ( [ Table = Quote ( $table_name ); Field = $sql_header; query  = \" SELECT  \"& FIELD &\" FROM  \"& TABLE &\" \" ] ; Substitute ( Substitute ( ExecuteSQL ( query ; Char(9) ; \"~~~\" ) ; \"\u00b6\" ; \"|\" ); \"~~~\" ; \"\u00b6\" ) ) ]\n029:     If [ ValueCount ( $dump ) >= 1 ]\n030:       #\u30d8\u30c3\u30c0\u3068\u30c7\u30fc\u30bf\u3092\u7d50\u5408\u3057\u3001Tab\u30d5\u30a1\u30a4\u30eb\u306b\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\u3002\n031:       \u5909\u6570\u3092\u8a2d\u5b9a [ $dump; \u5024:Substitute ( $header ; \"\u00b6\" ; Char(9)) &\"\u00b6\"& $dump ]\n032:       \u5909\u6570\u3092\u8a2d\u5b9a [ $path; \u5024:$dir & $date &\"_\"&$table_name&\".tab\" ]\n033:       \u5909\u6570\u3092\u8a2d\u5b9a [ $pathlist; \u5024:If ($i > 1;$pathlist &\"\u00b6\")& $pathlist ]\n034:       \u30d5\u30a3\u30fc\u30eb\u30c9\u8a2d\u5b9a [ SYS_BACKUP::TEMP; $dump ]\n035:       \u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u5bb9\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8 [ SYS_BACKUP::TEMP; \u300c$path\u300d ]\n036:     End If\n037:     \u5909\u6570\u3092\u8a2d\u5b9a [ $i; \u5024:$i + 1 ]\n038: End Loop\n039: \n040: #7z\u3092\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u5b9f\u884c & \u5727\u7e2e\u3055\u308c\u305fTAB\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\uff087z\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u74b0\u5883\u5909\u6570PATH\u306b\u901a\u3057\u3066\u304a\u304f\u3053\u3068\uff09\n041: \u30d5\u30a3\u30fc\u30eb\u30c9\u8a2d\u5b9a [ SYS_BACKUP::TEMP; \"7za a \"& $date &\".zip *.tab\" ]\n042: Event \u3092\u9001\u4fe1 [ \u30d5\u30a1\u30a4\u30eb/\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u958b\u304f; \"cmd /c 7za a \"& $dirpath & $date &\".zip \" & $dirpath &\" *.tab & del \" & $dirpath &\"*.tab\" ] [ \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u624b\u524d\u306b\u8868\u793a ]\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u6d41\u308c\u3068\u3057\u3066\u306f\u3001\n\n\u66f8\u304d\u51fa\u3057\u30c6\u30ad\u30b9\u30c8\u3092\u4e00\u6642\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u30b0\u30ed\u30fc\u30d0\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u542b\u3080\u30ec\u30a4\u30a2\u30a6\u30c8\uff08SYS_BACKUP)\u306b\u79fb\u52d5\n\u30ed\u30b0\u3092\u51fa\u529b\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u3001\u4fdd\u5b58\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u540d\u7b49\u3092\u8a2d\u5b9a\nExecuteSQL\u95a2\u6570\u3067\u30d9\u30fc\u30b9\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u53d6\u5f97\u3057\u3001Loop\u3067\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306b\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3092\u53d6\u5f97\n7zip\u3092\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u7acb\u3061\u4e0a\u3052\u3001ZIP\u3067\u5727\u7e2e\u3057\u305f\u5f8c\u306bTab\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\n\n\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u672c\u6765\u306f\u30a8\u30e9\u30fc\u51e6\u7406\u3084ZIP\u5727\u7e2e\u3001\u524a\u9664\u6642\u306b\u6392\u4ed6\u51e6\u7406\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u7701\u7565\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001\u51fa\u529b\u3057\u305f\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089ZIP\u5727\u7e2e\u3092\u884c\u3046\u305f\u3081\u306b\u30017-Zip\u306e\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u7248[7za.exe]\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u5404\u30af\u30e9\u30a4\u30a2\u30f3\u30c8PC\u306e\u9069\u5f53\u306a\u5834\u6240\u306b[7Za.exe]\u3092\u4fdd\u5b58\u3057\u3001PATH\u3092\u901a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u3053\u306e\u65b9\u5f0f\u3067\u3042\u308c\u3070\u3001ExecuteSQL\u3067\u53d6\u5f97\u3057\u305f\u5024\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304d\u8fbc\u307e\u308c\u3001\u300c\u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u5bb9\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u300d\u3067\u9010\u6b21\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u3060\u3055\u308c\u307e\u3059\u3002\u66f8\u304d\u51fa\u3057\u7528\u306e\u30b0\u30ed\u30fc\u30d0\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u3069\u3053\u304b\u306b\uff11\u3064\u4f5c\u6210\u3057\u3066\u304a\u3051\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u69cb\u9020\u306b\u5909\u66f4\u304c\u3042\u3063\u305f\u5834\u5408\u3067\u3082\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u306a\u308a\u307e\u3059\u3057\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u306b\u3082\u5fdc\u7528\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u4f5c\u696d\u30b3\u30b9\u30c8\u304c\u4e0b\u304c\u308b\u3053\u3068\u304c\u671f\u5f85\u3067\u304d\u307e\u3059\u3002\n\n\u5b9a\u671f\u7684\u306a\u5b9f\u884c\n\u3042\u3068\u306f\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9a\u671f\u7684\u306b\u5b9f\u884c\u3059\u308c\u3070\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u554f\u984c\u306f\u300c\u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u5bb9\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u300d\u304cServer\u3068\u4e92\u63db\u6027\u306e\u306a\u3044\u30b9\u30af\u30ea\u30d7\u30c8\u30b9\u30c6\u30c3\u30d7\u306a\u306e\u3067\u3001Server\u5074\u3067\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u30d0\u30c3\u30c1\u51e6\u7406\u3092\u884c\u3046\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\u3057\u305f\u304c\u3063\u3066\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u5b9a\u671f\u7684\u306b\u5b9f\u884c\u3059\u308b\u30c8\u30ea\u30ac\u3092\u4ed5\u639b\u3051\u3066\u304a\u304f\u3053\u3068\u3067\u5b9a\u671f\u7684\u306a\u5b9f\u884c\u3092\u78ba\u4fdd\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\u5177\u4f53\u7684\u306b\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u30c8\u30ea\u30ac\u300conLastWindowClose\u300d\u306b\u5bfe\u3057\u3066\u8a2d\u5b9a\u3059\u308c\u3070\u3001\u8d77\u52d5\uff11\u56de\uff08\u7d42\u4e86\uff09\u6bce\u306bZIP\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\u904b\u7528\u306e\u4ed5\u65b9\u306b\u3082\u3088\u308a\u307e\u3059\u304c\u3001\u901a\u5e38\u306f\u3053\u306e\u65b9\u6cd5\u3067\u30ed\u30b0\u3092\u53d6\u308c\u3070\u3001\u554f\u984c\u767a\u751f\u6642\u306b\u691c\u8a3c\u304c\u51fa\u6765\u308b\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\u983b\u7e41\u306b\u7d42\u4e86\u3092\u884c\u3046\u5834\u5408\u306f\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5148\u982d\u3067\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u5b9f\u884c\u53ef\u5426\u3092\u30ab\u30b9\u30bf\u30e0\u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u554f\u3044\u5408\u308f\u305b\u308b\u306a\u3069\u306e\u5bfe\u51e6\u3092\u3059\u308c\u3070\u3088\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n##\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\nhttps://www.dropbox.com/s/wow1qe5l16z56lp/export.zip?dl=0\n\u4ed6\u306eFMP12\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30c6\u30fc\u30d6\u30eb\u3068\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u3053\u3068\u3067\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n\n\n## \u3084\u308b\u3053\u3068\n\n- ExecuteSQL\u3067\u3001\u904b\u7528\u4e2d\u306e\u5168\u30c6\u30fc\u30d6\u30eb\u306e\u5168\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u5185\u5bb9\u3092\u3001\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306b\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\u3067\u4fdd\u5b58\u3057\u3066\u30ed\u30b0\u3092\u53d6\u308b\n- \u4f5c\u6210\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u3001ZIP\u3067\u5727\u7e2e\u3057\u3066\u4fdd\u5b58\u3059\u308b\u3002\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664\u3059\u308b\u3002\n- \u4ee5\u4e0a\u306e\uff12\u70b9\u3092Windows\u7248 FileMaker Pro \u3068\u30d5\u30ea\u30fc\u30bd\u30d5\u30c8\u306e\u307f\u3067\u884c\u3046\uff08\u6709\u6599\u30d7\u30e9\u30b0\u30a4\u30f3\u3068\u304b\u4f59\u8a08\u306a\u304a\u91d1\u3092\u767a\u751f\u3055\u305b\u306a\u3044\uff09\n\n## \u4f5c\u6210\u3057\u305f\u52d5\u6a5f\n### \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u6a2a\u65ad\u3057\u3066\u691c\u7d22\u3057\u305f\u3044\n\nFileMaker Server\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u904b\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u3066\u304a\u3051\u3070\u300c\u6bce\u65e5\u300d\u300c\u6bce\u6642\u300d\u306a\u3069\u306e\u3088\u3046\u306a\u5b9a\u671f\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u7c21\u5358\u306b\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u8a2d\u5b9a\u6b21\u7b2c\u3067\u904b\u7528\u4e2d\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4ed6\u306b\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u5185\u5bb9\u3092\u7a7a\u306b\u3057\u305f\u300c\u30af\u30ed\u30fc\u30f3\u300d\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u308a\u3068\u3001\u901a\u5e38\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u904b\u7528\u3059\u308b\u4e0a\u3067\u306f\u56f0\u308b\u3053\u3068\u306f\u307b\u307c\u7121\u3044\u3068\u3044\u3048\u308b\u5f37\u529b\u306a\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u6a5f\u80fd\u3092\u6709\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u3068\u3053\u308d\u304c\u3001\u3053\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3067\u4f5c\u6210\u3055\u308c\u308b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306f\u3001\u4e0b\u306b\u8a18\u8f09\u3057\u305f\u3088\u3046\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u3092\u6301\u3064\u3001\u305d\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3054\u3068\u306b\u500b\u5225\u306eFileMaker\uff08*.fmp12)\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\u904b\u7528\u4e2d\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4f55\u304b\u3057\u3089\u306e\u969c\u5bb3\u304c\u767a\u751f\u3057\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306b\u5dee\u3057\u66ff\u3048\u308b\u306a\u3069\u306e\u5834\u5408\u306f\u624b\u8efd\u306b\u5b9f\u884c\u3067\u304d\u3066\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u6642\u306b\u306f\u3053\u308c\u3067\u306f\u56f0\u308b\u3053\u3068\u3082\u6709\u308a\u307e\u3059\u3002\n\n<pre>\n>FileMaker \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3067\u4f5c\u6210\u3055\u308c\u308b\u30d5\u30a1\u30a4\u30eb\u30c4\u30ea\u30fc\u306e\u4f8b\n>    \u251c\u2500\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\uff08\u30b0\u30eb\u30fc\u30d7\uff11\uff09_2016-01-10_2300\u3000//\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5b9f\u884c\u5358\u4f4d\u3067\u4f5c\u6210\uff08\u3053\u306e\u5834\u5408\u6bce\u65e523:00\u306b\u5b9f\u884c\uff09\n> \u2502  \u2502  \u251c\u2500Cloned_by_FMS_2016-01-10_2300\u3000        //\u30af\u30ed\u30fc\u30f3\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n> \u2502  \u2502  \u2502  \u2514\u2500Databases\n> \u2502  \u2502  \u2502      \u2514\u2500\u30b0\u30eb\u30fc\u30d7\uff11\n> \u2502  \u2502  \u2502              Database1\u30af\u30ed\u30fc\u30f3.fmp12\n> \u2502  \u2502  \u2502              Database2\u30af\u30ed\u30fc\u30f3.fmp12\n> \u2502  \u2502  \u2514\u2500Databases //\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u672c\u4f53\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n> \u2502  \u2502      \u2514\u2500\u30b0\u30eb\u30fc\u30d7\uff11\n> \u2502  \u2502          \u2502  Database1.fmp12\n> \u2502  \u2502          \u2502  Database2.fmp12\n> \u2502  \u2502          \u2514\u2500RC_Data_FMS                    //\u5916\u90e8\u4fdd\u5b58\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff08\u753b\u50cf\u306a\u3069\uff09\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n> \u2502  \u2502              \u2514\u2500Database1\n> \u2502  \u2502                  \u2514\u2500Photostock\n> \u2502  \u2502                      \u2514\u2500\u5199\u771f\u7ba1\u7406\u30c6\u30fc\u30d6\u30eb\n> \u2502  \u2502                          \u2514\u2500\u5199\u771f\n> \u2502  \u2502                                  RIMG0367.jpg\n> \u2502  \u2502                                  RIMG0377.jpg\n> \u2502  \u2502                                  RIMG0421.jpg\n</pre>\n\n\u4f8b\u3048\u3070\u3001**\u300c\u5165\u529b\u3057\u305f\u306f\u305a\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u6d88\u5931\u3057\u3066\u3044\u308b\u300d**\u73fe\u8c61\u304c\u8d77\u304d\u305f\u5834\u5408\u3001\u3053\u308c\u3089\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u7fa4\u304b\u3089**\u300c\u3044\u3064\u6d88\u5931\u3057\u305f\u304b\u300d**\u3092\u7279\u5b9a\u3059\u308b\u3053\u3068\u306f\u524a\u9664\u6642\u306b\u30ed\u30b0\u3092\u53d6\u308b\u3088\u3046\u306a\u4ed5\u69d8\u306b\u3067\u3082\u3057\u3066\u3044\u306a\u3044\u9650\u308a\u3001\u975e\u5e38\u306b\u30b3\u30b9\u30c8\u304c\u304b\u304b\u308b\u4f5c\u696d\u306b\u306a\u308a\u307e\u3059\u3002\n\n**FileMaker\u306e\u6a19\u6e96\u6a5f\u80fd\u3067\u306f\u3001Grep\u306e\u3088\u3046\u306b\u8907\u6570\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u691c\u7d22\u3067\u304d\u307e\u305b\u3093\u3002**\u884c\u3046\u5834\u5408\u306f\uff11\u30d5\u30a1\u30a4\u30eb\u3054\u3068\u306b\u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u30b7\u30c3\u30d7\u3092\u8a2d\u5b9a\u3059\u308b\u304b\u3001\u30a4\u30f3\u30dd\u30fc\u30c8\u7528\u306e\u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30d5\u30a1\u30a4\u30eb\u3054\u3068\u306b\u30a4\u30f3\u30dd\u30fc\u30c8\u3092\u5b9f\u884c\u3057\u3001\u3069\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u305f\u304b\u3092\u30ec\u30b3\u30fc\u30c9\u306b\u8a18\u5165\u3057\u3066\u8b58\u5225\u3059\u308b\u306a\u3069\u306e\u5de5\u592b\u304c\u5fc5\u8981\u3067\u3059\u3002\u3069\u3061\u3089\u3082\u624b\u52d5\u3067\u884c\u308f\u306a\u3051\u308c\u3070\u306a\u3089\u305a\u3001\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u3084\u691c\u8a3c\u306e\u305f\u3081\u306b\u9010\u4e00\u3053\u306e\u3088\u3046\u306a\u4f5c\u696d\u3092\u884c\u3046\u306e\u306f\u30b3\u30b9\u30c8\u304c\u304b\u304b\u308b\u306e\u3067\u5225\u306e\u65b9\u7b56\u3092\u8003\u3048\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\n\u3053\u3046\u306a\u308b\u3068\u6f54\u304f\u5168\u30c6\u30fc\u30d6\u30eb\u5185\u5bb9\u3092\u30c6\u30ad\u30b9\u30c8\u3067\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u304a\u3044\u3066\u3001\u5fc5\u8981\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u306a\u3069\u306eGrep\u304c\u4f7f\u3048\u308b\u30c4\u30fc\u30eb\u3067\u691c\u7d22\u5b9f\u884c\u3092\u3057\u305f\u307b\u3046\u304c\u4f4e\u30b3\u30b9\u30c8\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u554f\u984c\u306f\u3069\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3059\u308b\u304b\u3067\u3059\u3002\n\n##\u4f5c\u6210\u624b\u9806\n### \u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3067\u30ed\u30b0\u3092\u4fdd\u5b58\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f5c\u6210\n\n\nFileMaker\u3067\u3082\u30c6\u30ad\u30b9\u30c8\u5f62\u5f0f\uff08CSV\u3001\u30bf\u30d6\u533a\u5207\u308a\u3001Merge\u30d5\u30a1\u30a4\u30eb\uff09\u3067\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u306f\u6a19\u6e96\u6a5f\u80fd\u3067\u5099\u308f\u3063\u3066\u304a\u308a\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089\u5b9f\u884c\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u306e\u3067\u3001Server\u5074\u3067\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u3051\u3070\u3001\u524d\u8ff0\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u3088\u3046\u306b\u5b9a\u671f\u7684\u306b\u30c6\u30fc\u30d6\u30eb\u306e\u5168\u5185\u5bb9\u3092\u66f8\u304d\u3060\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068\u3057\u3066\u4fdd\u5b58\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u3059\u3002\n\n\u3057\u304b\u3057\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3088\u308b\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3067\u306f\u5bfe\u8c61\u3068\u306a\u308b\u30c6\u30fc\u30d6\u30eb\u3068\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u4e0b\u306e\u3088\u3046\u306a\u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u4e88\u3081\u8a2d\u5b9a\u3057\u3066\u304a\u304b\u306a\u3051\u308c\u3070\u306a\u3089\u305a\u3001\u5909\u6570\u7684\u306a\u8a2d\u5b9a\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-06-13 15.56.01.png](https://qiita-image-store.s3.amazonaws.com/0/44526/5feedf90-1e45-88e6-fc7a-82ae0ebc828e.png)\n\n\u3064\u307e\u308a\u3001**\u30b9\u30af\u30ea\u30d7\u30c8\u30b9\u30c6\u30c3\u30d7\u304c\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u9020\u306b\u4f9d\u5b58\u3059\u308b**\u3053\u3068\u306b\u306a\u308b\u306e\u3067\u3001\u30d5\u30a1\u30a4\u30eb\u5185\u90e8\u306b\u8907\u6570\u306e\u30c6\u30fc\u30d6\u30eb\u304c\u3042\u308b\u5834\u5408\u306f\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u305f\u3044\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306b\u9010\u6b21\u30b9\u30af\u30ea\u30d7\u30c8\u30b9\u30c6\u30c3\u30d7\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30d5\u30a1\u30a4\u30eb\u5185\u3067\u4fdd\u6301\u3059\u308b\u30c6\u30fc\u30d6\u30eb\u6570\u30fb\u30d5\u30a3\u30fc\u30eb\u30c9\u6570\u306b\u5897\u6e1b\u304c\u3042\u3063\u305f\u6642\u306b\u90fd\u5ea6\u30b9\u30af\u30ea\u30d7\u30c8\u30b9\u30c6\u30c3\u30d7\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3001\u3068\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u6027\u306e\u60aa\u3044\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u306a\u308b\u4e88\u611f\u304c\u3057\u307e\u3059\u3002\u307e\u305f\u5225\u306e\u65b9\u7b56\u3092\u8003\u3048\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\n###ExecuteSQL\u306b\u3088\u308b\u30c6\u30fc\u30d6\u30eb\u3001\u30ec\u30b3\u30fc\u30c9\u306e\u53d6\u5f97\n\nFileMaker\u95a2\u6570\u306e\u4e2d\u306b\u306f**ExecuteSQL**\u3068\u3044\u3046\u95a2\u6570\u304c\u3042\u308a\u3001\u672c\u6765\u8a2d\u5b9a\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u30c6\u30fc\u30d6\u30eb\u30aa\u30ab\u30ec\u30f3\u30b9\u3054\u3068\u306e\u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u30b7\u30c3\u30d7\u304c\u7121\u304f\u3068\u3082\uff08\u3069\u3053\u304b\u3089\u3067\u3082\uff09\u30c6\u30fc\u30d6\u30eb\u306e\u5185\u5bb9\u3092SQL\u30af\u30a8\u30ea\u3067\u62bd\u51fa\u3057\u305f\u5024\u3092\u5f97\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3068\u3044\u3046\u4fbf\u5229\u306a\u95a2\u6570\u304c\u3042\u308a\u307e\u3059\u3002\n\nExecuteSQL\u3067\u306f\u30c6\u30fc\u30d6\u30eb\u306b\u4fdd\u5b58\u3055\u308c\u305f\u5024\u306e\u307f\u306a\u3089\u305a\u3001**FileMaker \u30b7\u30b9\u30c6\u30e0\u30aa\u30d6\u30b8\u30a7\u30af\u30c8**\u3068\u3044\u3046\u3001\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u30c6\u30fc\u30d6\u30eb\u69cb\u9020\u3084\u30d5\u30a3\u30fc\u30eb\u30c9\u69cb\u9020\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5177\u4f53\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306a\u8a08\u7b97\u5f0f\u306b\u306a\u308a\u307e\u3059\u3002\n\n```ExecuteSQL.fmp12\n//\u30d5\u30a1\u30a4\u30eb\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u30d9\u30fc\u30b9\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u91cd\u8907\u3092\u9664\u3044\u3066\u53d6\u5f97\nExecuteSQL(\"SELECT DISTINCT BaseTableName from Filemaker_Tables\";\"\";\"\")\n\n//\u3042\u308b\u30c6\u30fc\u30d6\u30eb($tablename)\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u96c6\u8a08\u30fb\u8a08\u7b97\u30bf\u30a4\u30d7\u3092\u9664\u3044\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3092\u53d6\u5f97\nExecuteSQL(\"SELECT FieldName FROM FileMaker_Fields WHERE TableName = ? AND FieldClass='Normal'  \";\"\";\"\";$tablename)\n```\n\n\u3053\u308c\u3089\u306e\u5f0f\u3067\u5f97\u3089\u308c\u305f\u5024\u3092\u57fa\u306b\u3001Loop\u3067\u5404\u30d9\u30fc\u30b9\u30c6\u30fc\u30d6\u30eb\uff08\u30c6\u30fc\u30d6\u30eb\u30aa\u30ab\u30ec\u30f3\u30b9\u306e\u57fa\u3068\u306a\u308b\u30c6\u30fc\u30d6\u30eb\u3002\u300c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7ba1\u7406\uff0f\u30c6\u30fc\u30d6\u30eb\u3067\u4f5c\u6210\u3059\u308b\u30c6\u30fc\u30d6\u30eb\uff09\u306e\u5185\u5bb9\u3092ExecuteSQL\u3067\u53d6\u5f97\u3057\u3001\u9010\u6b21\u30c6\u30ad\u30b9\u30c8\u306b\u66f8\u304d\u3060\u3059\u306e\u304c\u3088\u3055\u305d\u3046\u3067\u3059\u3002\n\n\u91cd\u8907\u3092\u9664\u3044\u305f\u30c6\u30fc\u30d6\u30eb\u540d\u306e\u4e00\u89a7\u304c\u53d6\u5f97\u3067\u304d\u308c\u3070\u3001\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u7528\u3044\u3066\u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u5bb9\u306e\u5168\u3066\u3092\u53d6\u5f97\u3059\u308c\u3070\u826f\u3044\u3088\u3046\u306a\u6c17\u304c\u3057\u307e\u3059\u304c\u3001\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u4e2d\u306b\u306f\u300c\u8a08\u7b97\u300d\u300c\u96c6\u8a08\u300d\u30bf\u30a4\u30d7\u306e\u3082\u306e\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3067\u306f\u3053\u308c\u3089\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3082\u53d6\u5f97\u306e\u5bfe\u8c61\u3068\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\u3053\u306e\uff12\u30bf\u30a4\u30d7\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u5024\u3092\u90fd\u5ea6\u8a08\u7b97\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\u305f\u3081\u3001\u51e6\u7406\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u4e0a\u306b\u3001\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3057\u3066\u3082\u610f\u5473\u304c\u7121\u3044\u3053\u3068\u304c\u307b\u3068\u3093\u3069\u3067\u3059\u306e\u3067\u9664\u5916\u3057\u305f\u307b\u3046\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002SQL\u30af\u30a8\u30ea\u306eWHERE\u53e5\u3067 FieldClass='Normal'\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u9664\u5916\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u3046\u3057\u3066\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3059\u308b\u3079\u304d\u30c6\u30fc\u30d6\u30eb\u540d\u3068\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u3042\u3068\u306f\u6b21\u306e\u3088\u3046\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30c6\u30fc\u30d6\u30eb\u3054\u3068Loop\u3092\u56de\u3057\u3066\u53d6\u5f97\u3057\u305f\u5024\u3092\u66f8\u304d\u51fa\u305b\u3070\u3001\u30c6\u30fc\u30d6\u30eb\u6bce\u306e\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n```export.fmp12\n001: \u30ec\u30a4\u30a2\u30a6\u30c8\u5207\u308a\u66ff\u3048 [ \u300cSYS_BACKUP\u300d (SYS_BACKUP) ]\n002: \u5909\u6570\u3092\u8a2d\u5b9a [ $dirpath; \u5024:\"Z:\\log\\textfile\\\\\" //\u30ed\u30b0\u3092\u51fa\u529b\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30d1\u30b9 ] \n003: \u5909\u6570\u3092\u8a2d\u5b9a [ $dir; \u5024:Let([ %head = \"file:/\" ]; %head & Substitute ( $dirpath ; \"\\\\\" ; \"/\" ) ) //FileMaker\u7528\u306b\u30d1\u30b9\u3092\u52a0\u5de5 ]\n004: \u5909\u6570\u3092\u8a2d\u5b9a [ $date; \u5024:Substitute(Get(\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7)&\"_\"&Get(\u30a2\u30ab\u30a6\u30f3\u30c8\u540d);[\" \";\"-\"];[\"/\";\"-\"];[\":\";\"-\"]) //\u51fa\u529b\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u540d]\n005: \n006: #\u5168\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u53d6\u5f97\n007: \u5909\u6570\u3092\u8a2d\u5b9a [ $exclude_table; \u5024:\"'SYS_BACKUP','TEST_TABLE'\" //\u9664\u5916\u3059\u308b\u30c6\u30fc\u30d6\u30eb]\n008: \u5909\u6570\u3092\u8a2d\u5b9a [ $table_list; \u5024:Let ( [ notin = \"WHERE BaseTableName NOT IN(\"& $exclude_table &\")\"; query\t= \" SELECT\tBaseTableName FROM\tFilemaker_tables \"&notin ] ; ExecuteSQL ( query ; \"\" ; \"\" ) ) ]\n009: \u5909\u6570\u3092\u8a2d\u5b9a [ $vc_table; \u5024:ValueCount($table_list) ]\n010: \u5909\u6570\u3092\u8a2d\u5b9a [ $i; \u5024:1 ]\n011: #Loop\u3067\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306e\u30c7\u30fc\u30bf\u3092ExecuteSQL\u3067\u53d6\u5f97\u3057\u3001\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u51fa\u3059\n012: \n013: \u5909\u6570\u3092\u8a2d\u5b9a [ $i; \u5024:1 ]\n014: Loop\n015:   Exit Loop If [ $i > $vc_table ]\n016:   #\u51fa\u529b\u3059\u308b\u30c7\u30fc\u30bf\u306e\u30d8\u30c3\u30c0\uff08\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\uff09\u3092\u53d6\u5f97\n017:   \u5909\u6570\u3092\u8a2d\u5b9a [ $table_name; \u5024:GetValue ( $table_list ; $i ) ]\n018:   \u5909\u6570\u3092\u8a2d\u5b9a [ $header; \u5024:Let ( [ query  = \" SELECT  FieldName FROM  Filemaker_Fields WHERE  TableName = ? AND FieldClass = 'Normal' \" ] ; ExecuteSQL ( query ; \"\" ; \"\" ;$table_name) ) ]\n019:   \u5909\u6570\u3092\u8a2d\u5b9a [ $vc_header; \u5024:ValueCount($header) ]\n020:   \u5909\u6570\u3092\u8a2d\u5b9a [ $j; \u5024:1 ]\n021:   #\u30d8\u30c3\u30c0\u3092SQL\u306b\u9069\u3057\u305f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u3059\u308b\n022:   Loop\n023:     Exit Loop If [ $j > $vc_header ]\n024:       \u5909\u6570\u3092\u8a2d\u5b9a [ $sql_header; \u5024:If($j > 1;$sql_header & \",\") & Quote(GetValue($header;$j)) ]\n025:       \u5909\u6570\u3092\u8a2d\u5b9a [ $j; \u5024:$j + 1 ]\n026:     End Loop\n027:     #\u53d6\u5f97\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u5024\u306b\u542b\u307e\u308c\u308b\u6539\u884c\u533a\u5207\u308a\u30c7\u30fc\u30bf\u3092\u300c|\u300d\u3067\u7f6e\u63db\u3059\u308b\n028:     \u5909\u6570\u3092\u8a2d\u5b9a [ $dump; \u5024:Let ( [ Table = Quote ( $table_name ); Field = $sql_header; query  = \" SELECT  \"& FIELD &\" FROM  \"& TABLE &\" \" ] ; Substitute ( Substitute ( ExecuteSQL ( query ; Char(9) ; \"~~~\" ) ; \"\u00b6\" ; \"|\" ); \"~~~\" ; \"\u00b6\" ) ) ]\n029:     If [ ValueCount ( $dump ) >= 1 ]\n030:       #\u30d8\u30c3\u30c0\u3068\u30c7\u30fc\u30bf\u3092\u7d50\u5408\u3057\u3001Tab\u30d5\u30a1\u30a4\u30eb\u306b\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\u3002\n031:       \u5909\u6570\u3092\u8a2d\u5b9a [ $dump; \u5024:Substitute ( $header ; \"\u00b6\" ; Char(9)) &\"\u00b6\"& $dump ]\n032:       \u5909\u6570\u3092\u8a2d\u5b9a [ $path; \u5024:$dir & $date &\"_\"&$table_name&\".tab\" ]\n033:       \u5909\u6570\u3092\u8a2d\u5b9a [ $pathlist; \u5024:If ($i > 1;$pathlist &\"\u00b6\")& $pathlist ]\n034:       \u30d5\u30a3\u30fc\u30eb\u30c9\u8a2d\u5b9a [ SYS_BACKUP::TEMP; $dump ]\n035:       \u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u5bb9\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8 [ SYS_BACKUP::TEMP; \u300c$path\u300d ]\n036:     End If\n037:     \u5909\u6570\u3092\u8a2d\u5b9a [ $i; \u5024:$i + 1 ]\n038: End Loop\n039: \n040: #7z\u3092\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u5b9f\u884c & \u5727\u7e2e\u3055\u308c\u305fTAB\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\uff087z\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u74b0\u5883\u5909\u6570PATH\u306b\u901a\u3057\u3066\u304a\u304f\u3053\u3068\uff09\n041: \u30d5\u30a3\u30fc\u30eb\u30c9\u8a2d\u5b9a [ SYS_BACKUP::TEMP; \"7za a \"& $date &\".zip *.tab\" ]\n042: Event \u3092\u9001\u4fe1 [ \u30d5\u30a1\u30a4\u30eb/\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u958b\u304f; \"cmd /c 7za a \"& $dirpath & $date &\".zip \" & $dirpath &\" *.tab & del \" & $dirpath &\"*.tab\" ] [ \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u624b\u524d\u306b\u8868\u793a ]\n```\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u6d41\u308c\u3068\u3057\u3066\u306f\u3001\n\n1. \u66f8\u304d\u51fa\u3057\u30c6\u30ad\u30b9\u30c8\u3092\u4e00\u6642\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u30b0\u30ed\u30fc\u30d0\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u542b\u3080\u30ec\u30a4\u30a2\u30a6\u30c8\uff08SYS_BACKUP)\u306b\u79fb\u52d5\n2. \u30ed\u30b0\u3092\u51fa\u529b\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u3001\u4fdd\u5b58\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u540d\u7b49\u3092\u8a2d\u5b9a\n3. ExecuteSQL\u95a2\u6570\u3067\u30d9\u30fc\u30b9\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u53d6\u5f97\u3057\u3001Loop\u3067\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306b\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3092\u53d6\u5f97\n4. 7zip\u3092\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u7acb\u3061\u4e0a\u3052\u3001ZIP\u3067\u5727\u7e2e\u3057\u305f\u5f8c\u306bTab\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\n\n\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u672c\u6765\u306f\u30a8\u30e9\u30fc\u51e6\u7406\u3084ZIP\u5727\u7e2e\u3001\u524a\u9664\u6642\u306b\u6392\u4ed6\u51e6\u7406\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u7701\u7565\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001\u51fa\u529b\u3057\u305f\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089ZIP\u5727\u7e2e\u3092\u884c\u3046\u305f\u3081\u306b\u3001[7-Zip\u306e\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u7248[7za.exe]](!https://sevenzip.osdn.jp/download.html)\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u5404\u30af\u30e9\u30a4\u30a2\u30f3\u30c8PC\u306e\u9069\u5f53\u306a\u5834\u6240\u306b[7Za.exe]\u3092\u4fdd\u5b58\u3057\u3001PATH\u3092\u901a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u65b9\u5f0f\u3067\u3042\u308c\u3070\u3001ExecuteSQL\u3067\u53d6\u5f97\u3057\u305f\u5024\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304d\u8fbc\u307e\u308c\u3001\u300c\u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u5bb9\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u300d\u3067\u9010\u6b21\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u3060\u3055\u308c\u307e\u3059\u3002\u66f8\u304d\u51fa\u3057\u7528\u306e\u30b0\u30ed\u30fc\u30d0\u30eb\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u3069\u3053\u304b\u306b\uff11\u3064\u4f5c\u6210\u3057\u3066\u304a\u3051\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u69cb\u9020\u306b\u5909\u66f4\u304c\u3042\u3063\u305f\u5834\u5408\u3067\u3082\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4fee\u6b63\u3059\u308b\u5fc5\u8981\u304c\u306a\u304f\u306a\u308a\u307e\u3059\u3057\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u306b\u3082\u5fdc\u7528\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u4f5c\u696d\u30b3\u30b9\u30c8\u304c\u4e0b\u304c\u308b\u3053\u3068\u304c\u671f\u5f85\u3067\u304d\u307e\u3059\u3002\n\n\n###\u5b9a\u671f\u7684\u306a\u5b9f\u884c\n\n\u3042\u3068\u306f\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9a\u671f\u7684\u306b\u5b9f\u884c\u3059\u308c\u3070\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u554f\u984c\u306f\u300c\u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u5bb9\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u300d\u304cServer\u3068\u4e92\u63db\u6027\u306e\u306a\u3044\u30b9\u30af\u30ea\u30d7\u30c8\u30b9\u30c6\u30c3\u30d7\u306a\u306e\u3067\u3001**Server\u5074\u3067\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u30d0\u30c3\u30c1\u51e6\u7406\u3092\u884c\u3046\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002**\u3057\u305f\u304c\u3063\u3066\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u5b9a\u671f\u7684\u306b\u5b9f\u884c\u3059\u308b\u30c8\u30ea\u30ac\u3092\u4ed5\u639b\u3051\u3066\u304a\u304f\u3053\u3068\u3067\u5b9a\u671f\u7684\u306a\u5b9f\u884c\u3092\u78ba\u4fdd\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n\u5177\u4f53\u7684\u306b\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u30c8\u30ea\u30ac\u300conLastWindowClose\u300d\u306b\u5bfe\u3057\u3066\u8a2d\u5b9a\u3059\u308c\u3070\u3001\u8d77\u52d5\uff11\u56de\uff08\u7d42\u4e86\uff09\u6bce\u306bZIP\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\u904b\u7528\u306e\u4ed5\u65b9\u306b\u3082\u3088\u308a\u307e\u3059\u304c\u3001\u901a\u5e38\u306f\u3053\u306e\u65b9\u6cd5\u3067\u30ed\u30b0\u3092\u53d6\u308c\u3070\u3001\u554f\u984c\u767a\u751f\u6642\u306b\u691c\u8a3c\u304c\u51fa\u6765\u308b\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\u983b\u7e41\u306b\u7d42\u4e86\u3092\u884c\u3046\u5834\u5408\u306f\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5148\u982d\u3067\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u5b9f\u884c\u53ef\u5426\u3092\u30ab\u30b9\u30bf\u30e0\u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u554f\u3044\u5408\u308f\u305b\u308b\u306a\u3069\u306e\u5bfe\u51e6\u3092\u3059\u308c\u3070\u3088\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n", "tags": ["FileMaker"]}