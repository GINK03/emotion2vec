{"context": " More than 1 year has passed since last update.Capybara+RSpec\u3067\u30a8\u30f3\u30c9\u30c4\u30fc\u30a8\u30f3\u30c9\u306a\u30c6\u30b9\u30c8\u3092\u66f8\u304f\u3068\u304d\u306eTips\u3067\u3059\n\nrequire \"capybara/rspec\"\u306e\u7f60\nrequire \"capybara/rspec\"\u306fafter(:each)\u306bCapybara.reset_sessions!`\u3092\u5165\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308ait\u6bce\u306bCapybara.current_session\u304c\u5909\u5316\u3057\u3066\u3057\u307e\u3046\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ef\u30f3\u30e9\u30a4\u30ca\u30fcshould\u306b\u3088\u308b\u30c6\u30b9\u30c8\u3092\u96e3\u3057\u304f\u3057\u3066\u3044\u307e\u3059\u3002\nrequire File.dirname(__FILE__) + \"/spec_helper\"\n\nfeature \"\u30d5\u30a9\u30fc\u30e0\u5165\u529b\" do\n  before :all do\n    visit \"/form.html\"\n    fill_in \"u_name\", with:\"\u30c6\u30b9\u30c8\u592a\u90ce\"\n    click_button \"\u9001\u4fe1\"\n  end\n\n  context page do\n    its(:current_path) { should eq \"/thanks.html\" }\n    it { should have_selector \"#u_name\", text:\"\u30c6\u30b9\u30c8\u592a\u90ce\" }\n  end\nend\n\n\n\u56de\u907f\u65b9\u6cd5(Capybara::DSL\u3092\u4f7f\u3044\u305f\u3044\u5834\u5408)\nrequire \"capybara/rspec\"\u3092\u4f7f\u308f\u305a\u3001\u81ea\u5206\u3067\u7d44\u307f\u8fbc\u307f\u307e\u3057\u3087\u3046\nspec/spec_helper.rb:\nrequire 'capybara/rspec/matchers'\nrequire 'capybara/rspec/features'\nRSpec.configure do |config|\n  config.include Capybara::DSL, :type => :feature\n  config.include Capybara::RSpecMatchers, :type => :feature\nend\n\n\n\u56de\u907f\u65b9\u6cd5(Capybara::DSL\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408)\n\u30c6\u30b9\u30c8\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\nrequire File.dirname(__FILE__) + \"/spec_helper\"\n\ndescribe \"\u30d5\u30a9\u30fc\u30e0\u5165\u529b\" do\n  before :all do\n    Capybara.visit \"/form.html\"\n    Capybara.fill_in \"u_name\", with:\"\u30c6\u30b9\u30c8\u592a\u90ce\"\n    Capybara.click_button \"\u9001\u4fe1\"\n  end\n\n  context Capybara.page do\n    its(:current_path) { should eq \"/thanks.html\" }\n    it { should have_selector \"#u_name\", text:\"\u30c6\u30b9\u30c8\u592a\u90ce\" }\n  end\nend\n\n\u9055\u3044\u306f\u4ee5\u4e0b\u306e\u901a\u308a\n\n\ndescribe :type => :feature\u304c\u4e0d\u8981 (\u7121\u304f\u3068\u3082\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u308b)\n\nfeature\u53e5\u3001scenario\u53e5\u7b49\u304c\u4f7f\u3048\u306a\u3044\n\u6bce\u5ea6Capybara\u3092\u3064\u3051\u308b\u5fc5\u8981\u304c\u3042\u308b\n\n\n\u6ce8\u610f\nCapybara.reset_sessions!\u3092after(:all)\u3042\u305f\u308a\u3067\u3084\u3063\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\u3055\u3082\u306a\u3044\u3068\u3001\u9077\u79fb\u72b6\u614b\u304c\u30af\u30ea\u30a2\u3055\u308c\u306a\u3044\u306e\u3067\u30c6\u30b9\u30c8\u304c\u4e0d\u5b89\u5b9a\u306b\u306a\u308a\u307e\u3059\u3088\u3002\n\nSSL\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u306e\u691c\u8a3c\u3092\u6291\u5236\u3059\u308b\n\u7121\u52b9\u306aSSL\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u3067\u52d5\u3044\u3066\u3044\u308b\u30b5\u30fc\u30d0\u3078\u306e\u30c6\u30b9\u30c8\u3092\u884c\u3046\u65b9\u6cd5\u3067\u3059\n\ncapybara-mechanize\u306e\u5834\u5408\nopenssl\u306b\u3088\u308b\u691c\u8a3c\u3092\u6291\u5236\u3057\u307e\u3059\nspec/spec_helper.rb:\nrequire \"openssl\"\nOpenSSL::SSL.module_eval { remove_const(:VERIFY_PEER) }\nOpenSSL::SSL.const_set(:VERIFY_PEER, OpenSSL::SSL::VERIFY_NONE)\nI_KNOW_THAT_OPENSSL_VERIFY_PEER_EQUALS_VERIFY_NONE_IS_WRONG = nil\n\n\u53c2\u8003\u8cc7\u6599\n\nhttp://mofuken.blogspot.jp/2012/12/ruby-open-uri-https-certificate-verify.html\n\n\u3053\u308c\u3092\u3084\u3089\u306a\u304b\u3063\u305f\u5834\u5408\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\nRuntimeError:\n Received the following error for a GET request to https://127.0.0.1: 'hostname \"127.0.0.1\" does not match the server certificate'\n\n\ncapybara-webkit\u306e\u5834\u5408\nSSL\u95a2\u9023\u306e\u30a8\u30e9\u30fc\u3092\u6291\u5236\u3057\u305fCapybara\u30c9\u30e9\u30a4\u30d0\u3092\u5b9a\u7fa9\u3057\u3001\u305d\u308c\u3092\u5229\u7528\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\nspec/spec_helper.rb:\nCapybara.register_driver :webkit_ignore_ssl do |app|\n  driver = Capybara::Webkit::Driver.new(app)\n  driver.browser.ignore_ssl_errors\n  driver\nend\n\nCapybara.configure do |config|\n  config.default_driver = :webkit_ignore_ssl\nend\n\n\u53c2\u8003\u8cc7\u6599\n\nhttp://cowjumpedoverthecommodore64.blogspot.jp/2013/09/if-your-website-runs-under-ssl-than.html\n\n\u3053\u308c\u3092\u3084\u3089\u306a\u304b\u3063\u305f\u5834\u5408\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\nCapybara::Webkit::InvalidResponseError:\n Unable to load URL: https://127.0.0.1 because of error loading https://127.0.0.1: Unknown error\n\n\nCookie\u3092\u6301\u305f\u305b\u308b\u65b9\u6cd5\n\ncapybara-mechanize\u306e\u5834\u5408\nrequire \"uri\"\npage.driver.browser.agent.cookie_jar.add URI.parse(Capybara.app_host), Mechanize::Cookie.new(\"cookie_key\", \"cookie_value\", {domain:\".example.com\", expire:Time.now+86400, path:\"/\"})\n\n\ncapybara-webkit\u306e\u5834\u5408\nrequire \"cgi\"\npage.driver.browser.set_cookie(\"cookie_key=#{CGI.escape('cookie_value')}; expires=#{(Time.now+86400).strftime(\"%a, %d %b %Y %H:%M:%S GMT\")}; domain=.example.com; path=/;\")\n\nCapybara+RSpec\u3067\u30a8\u30f3\u30c9\u30c4\u30fc\u30a8\u30f3\u30c9\u306a\u30c6\u30b9\u30c8\u3092\u66f8\u304f\u3068\u304d\u306eTips\u3067\u3059\n\n`require \"capybara/rspec\"`\u306e\u7f60\n------------------------------\n\n`require \"capybara/rspec\"`\u306f`after(:each)`\u306bCapybara.reset_sessions!`\u3092\u5165\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u3053\u308c\u306b\u3088\u308ait\u6bce\u306b`Capybara.current_session`\u304c\u5909\u5316\u3057\u3066\u3057\u307e\u3046\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ef\u30f3\u30e9\u30a4\u30ca\u30fcshould\u306b\u3088\u308b\u30c6\u30b9\u30c8\u3092\u96e3\u3057\u304f\u3057\u3066\u3044\u307e\u3059\u3002\n\n```ruby\nrequire File.dirname(__FILE__) + \"/spec_helper\"\n\nfeature \"\u30d5\u30a9\u30fc\u30e0\u5165\u529b\" do\n  before :all do\n    visit \"/form.html\"\n    fill_in \"u_name\", with:\"\u30c6\u30b9\u30c8\u592a\u90ce\"\n    click_button \"\u9001\u4fe1\"\n  end\n\n  context page do\n    its(:current_path) { should eq \"/thanks.html\" }\n    it { should have_selector \"#u_name\", text:\"\u30c6\u30b9\u30c8\u592a\u90ce\" }\n  end\nend\n```\n\n### \u56de\u907f\u65b9\u6cd5(Capybara::DSL\u3092\u4f7f\u3044\u305f\u3044\u5834\u5408) ###\n\n`require \"capybara/rspec\"`\u3092\u4f7f\u308f\u305a\u3001\u81ea\u5206\u3067\u7d44\u307f\u8fbc\u307f\u307e\u3057\u3087\u3046\n\nspec/spec_helper.rb:\n\n```ruby\nrequire 'capybara/rspec/matchers'\nrequire 'capybara/rspec/features'\nRSpec.configure do |config|\n  config.include Capybara::DSL, :type => :feature\n  config.include Capybara::RSpecMatchers, :type => :feature\nend\n```\n\n### \u56de\u907f\u65b9\u6cd5(Capybara::DSL\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408) ###\n\n\u30c6\u30b9\u30c8\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\n\n```ruby\nrequire File.dirname(__FILE__) + \"/spec_helper\"\n\ndescribe \"\u30d5\u30a9\u30fc\u30e0\u5165\u529b\" do\n  before :all do\n    Capybara.visit \"/form.html\"\n    Capybara.fill_in \"u_name\", with:\"\u30c6\u30b9\u30c8\u592a\u90ce\"\n    Capybara.click_button \"\u9001\u4fe1\"\n  end\n\n  context Capybara.page do\n    its(:current_path) { should eq \"/thanks.html\" }\n    it { should have_selector \"#u_name\", text:\"\u30c6\u30b9\u30c8\u592a\u90ce\" }\n  end\nend\n```\n\n\u9055\u3044\u306f\u4ee5\u4e0b\u306e\u901a\u308a\n\n1. `describe :type => :feature`\u304c\u4e0d\u8981 (\u7121\u304f\u3068\u3082\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u308b)\n2. `feature`\u53e5\u3001`scenario`\u53e5\u7b49\u304c\u4f7f\u3048\u306a\u3044\n3. \u6bce\u5ea6`Capybara`\u3092\u3064\u3051\u308b\u5fc5\u8981\u304c\u3042\u308b\n\n### \u6ce8\u610f ###\n\nCapybara.reset_sessions!\u3092after(:all)\u3042\u305f\u308a\u3067\u3084\u3063\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\u3055\u3082\u306a\u3044\u3068\u3001\u9077\u79fb\u72b6\u614b\u304c\u30af\u30ea\u30a2\u3055\u308c\u306a\u3044\u306e\u3067\u30c6\u30b9\u30c8\u304c\u4e0d\u5b89\u5b9a\u306b\u306a\u308a\u307e\u3059\u3088\u3002\n\n\nSSL\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u306e\u691c\u8a3c\u3092\u6291\u5236\u3059\u308b\n-------------------------------\n\n\u7121\u52b9\u306aSSL\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u3067\u52d5\u3044\u3066\u3044\u308b\u30b5\u30fc\u30d0\u3078\u306e\u30c6\u30b9\u30c8\u3092\u884c\u3046\u65b9\u6cd5\u3067\u3059\n\n### capybara-mechanize\u306e\u5834\u5408 ###\n\nopenssl\u306b\u3088\u308b\u691c\u8a3c\u3092\u6291\u5236\u3057\u307e\u3059\n\nspec/spec_helper.rb:\n\n```ruby\nrequire \"openssl\"\nOpenSSL::SSL.module_eval { remove_const(:VERIFY_PEER) }\nOpenSSL::SSL.const_set(:VERIFY_PEER, OpenSSL::SSL::VERIFY_NONE)\nI_KNOW_THAT_OPENSSL_VERIFY_PEER_EQUALS_VERIFY_NONE_IS_WRONG = nil\n```\n\n\u53c2\u8003\u8cc7\u6599\n\n* http://mofuken.blogspot.jp/2012/12/ruby-open-uri-https-certificate-verify.html\n\n\u3053\u308c\u3092\u3084\u3089\u306a\u304b\u3063\u305f\u5834\u5408\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\n\n```\nRuntimeError:\n Received the following error for a GET request to https://127.0.0.1: 'hostname \"127.0.0.1\" does not match the server certificate'\n```\n\n### capybara-webkit\u306e\u5834\u5408 ###\n\nSSL\u95a2\u9023\u306e\u30a8\u30e9\u30fc\u3092\u6291\u5236\u3057\u305fCapybara\u30c9\u30e9\u30a4\u30d0\u3092\u5b9a\u7fa9\u3057\u3001\u305d\u308c\u3092\u5229\u7528\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\n\nspec/spec_helper.rb:\n\n```ruby\nCapybara.register_driver :webkit_ignore_ssl do |app|\n  driver = Capybara::Webkit::Driver.new(app)\n  driver.browser.ignore_ssl_errors\n  driver\nend\n\nCapybara.configure do |config|\n  config.default_driver = :webkit_ignore_ssl\nend\n```\n\n\u53c2\u8003\u8cc7\u6599\n\n* http://cowjumpedoverthecommodore64.blogspot.jp/2013/09/if-your-website-runs-under-ssl-than.html\n\n\u3053\u308c\u3092\u3084\u3089\u306a\u304b\u3063\u305f\u5834\u5408\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\n\n```\nCapybara::Webkit::InvalidResponseError:\n Unable to load URL: https://127.0.0.1 because of error loading https://127.0.0.1: Unknown error\n```\n\nCookie\u3092\u6301\u305f\u305b\u308b\u65b9\u6cd5\n--------------------\n\n### capybara-mechanize\u306e\u5834\u5408 ###\n\n```ruby\nrequire \"uri\"\npage.driver.browser.agent.cookie_jar.add URI.parse(Capybara.app_host), Mechanize::Cookie.new(\"cookie_key\", \"cookie_value\", {domain:\".example.com\", expire:Time.now+86400, path:\"/\"})\n```\n\n### capybara-webkit\u306e\u5834\u5408 ###\n\n```ruby\nrequire \"cgi\"\npage.driver.browser.set_cookie(\"cookie_key=#{CGI.escape('cookie_value')}; expires=#{(Time.now+86400).strftime(\"%a, %d %b %Y %H:%M:%S GMT\")}; domain=.example.com; path=/;\")\n```\n", "tags": ["RSpec2.14.8", "Capybara2.1.0"]}