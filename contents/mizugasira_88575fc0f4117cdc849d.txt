{"context": "\u307f\u306a\u3055\u3093\u5f8c\u7de8\u306b\u3088\u3046\u3053\u305d!\n\u524d\u56de\u307e\u3067\u306e\u8a18\u4e8b\u3092\u898b\u3066\u3044\u306a\u3044\u65b9\u306f\u4e0b\u304b\u3089\u3069\u3046\u305e!\narduino wifi\u3068\u6e29\u5ea6\u30bb\u30f3\u30b5\u3092\u4f7f\u3044\u7c21\u6613\u7684\u306a\u30b0\u30e9\u30d5\u306b\u51fa\u529b\u3057\u3066\u307f\u305f\u3002(\u524d\u7de8)\n\u524d\u56de\u306fWifi\u57fa\u76e4\u3092\u3064\u3051\u305fArduino\u306bWifi\u63a5\u7d9a\u7528\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u8fbc\u3093\u3067\u78ba\u8a8d\u307e\u3067\u3092\u3057\u307e\u3057\u305f\u306d\u3002\n\u3053\u3053\u307e\u3067\u304f\u308c\u3070\u3082\u3046\u7c21\u5358\u306e\u57df\u3067\u3059\u3002\n\u305d\u308c\u3067\u306f\u7d9a\u304d\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n4.\u6e29\u5ea6\u30bb\u30f3\u30b5\u3092\u914d\u7dda\u3057\u3088\u3046\u3002\n\u79c1\u521d\u5fc3\u8005\u306a\u306e\u3067\u3068\u308a\u3042\u3048\u305a\u8abf\u3079\u3066\u307f\u305f\u3089\u5c71\u307b\u3069\u3042\u308a\u307e\u3057\u305f\u3002\n\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc(LM61CIZ)\u306e\u4f7f\u3044\u65b9\uff11\n\u3053\u3061\u3089\u306e\u8a18\u4e8b\u3092\u307e\u3093\u307e\u30b3\u30d4\u30da\u3001\u3068\u308a\u3042\u3048\u305a\u3053\u308c\u5358\u4f53\u3067\u52d5\u304b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30aa\u30c3\u30b1\u30fc\u30aa\u30c3\u30b1\u30fc\u7c21\u5358\u3060\u306a\u3002\n\u914d\u7dda\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u308c\u3067\u6e29\u5ea6\u30bb\u30f3\u30b5\u306f\u30aa\u30c3\u30b1\u30fc\n\n5.Wifi\u63a5\u7d9a\u30b3\u30fc\u30c9\u306b\u6e29\u5ea6\u30bb\u30f3\u30b5\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u8fbc\u307f\n\u3044\u305f\u3063\u3066\u7c21\u5358\u3067\u3059\u3002\n\u305f\u3060\u5358\u306bWifi\u63a5\u7d9a\u30b3\u30fc\u30c9\u306b\u4e0a\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u8fbc\u3080\u3060\u3051\u3002(\u306a\u3093\u3068\u7c21\u5358\u306a\u30fb\u30fb)\n\u5b8c\u6210\u30b3\u30fc\u30c9\u304c\u3053\u3061\u3089\n\ntest.ino\n#include <HttpClient_ESP8266_AT.h>\n\n// Arduino UNO \u306e\u5834\u5408\u306f\u3001\u4f8b\u3048\u3070\u30c7\u30b8\u30bf\u30eb\u5165\u51fa\u529b\u306e 2 \u756a, 4 \u756a\u30d4\u30f3\u3092\u5229\u7528\u3057\u3066\n// ESP-WROOM-02 \u3068\u30b7\u30ea\u30a2\u30eb\u901a\u4fe1\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nconst byte rxPin = 2; // Wire this to Tx Pin of ESP8266\nconst byte txPin = 4; // Wire this to Rx Pin of ESP8266\nHttpClient_ESP8266_AT httpClient(rxPin, txPin);\n\n\nvoid setup() {\n    // PC \u3068\u901a\u4fe1\u3059\u308b HardwareSerial \u306e baudrate \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n    // ESP-WROOM-02 \u306e baudrate \u3068\u306f\u95a2\u4fc2\u3042\u308a\u307e\u305b\u3093\u3002\n    Serial.begin(115200);\n\n    // SSID \u3068 PASSWORD \u3067\u30a2\u30af\u30bb\u30b9\u30dd\u30a4\u30f3\u30c8\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002\n    // \u30b7\u30ea\u30a2\u30eb\u63a5\u7d9a\u78ba\u8a8d\u3068 WiFi \u63a5\u7d9a\u78ba\u8a8d\u3092\u884c\u3044\u3001\u8a2d\u5b9a\u4e0d\u5099\u304c\u3042\u308c\u3070\u51fa\u529b\u3057\u307e\u3059\u3002\n    while(true) {\n        if(httpClient.statusAT()) { Serial.println(\"AT status OK\"); break; }\n        else Serial.println(\"AT status NOT OK\");\n        delay(1000);\n    }\n    while(true) { // \u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u2193\n        if(httpClient.connectAP(\"SSID\", \"PASSWORD\")) { Serial.println(\"Successfully connected to an AP\"); break; }\n        else Serial.println(\"Failed to connected to an AP. retrying...\");\n        delay(1000);\n    }\n    while(true) {\n        if(httpClient.statusWiFi()) { Serial.println(\"WiFi status OK\"); break; }\n        else Serial.println(\"WiFi status NOT OK\");\n        delay(1000);\n    }\n}\n\n\nvoid loop() {\n    // \u30ce\u30a4\u30ba\u306e\u5f71\u97ff\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5931\u6557\u3059\u308b\u3053\u3068\u304c\u3042\u308b\u305f\u3081 while \u30eb\u30fc\u30d7\u3067\u56f2\u3044\u307e\u3059\u3002\n    while(true) {\n\n        int temp;\n        int ans , tv ;\n\n        ans = analogRead(0) ;              // \u30a2\u30ca\u30ed\u30b0\uff10\u756a\u30d4\u30f3\u304b\u3089\u30bb\u30f3\u30b5\u30fc\u5024\u3092\u8aad\u8fbc\u3080\n        tv  = map(ans,0,1023,0,5000) ;     // \u30bb\u30f3\u30b5\u30fc\u5024\u3092\u96fb\u5727\u306b\u5909\u63db\u3059\u308b\n        temp = map(tv,300,1600,-30,100) ;  // \u96fb\u5727\u304b\u3089\u6e29\u5ea6\u306b\u5909\u63db\u3059\u308b\n        String string = String(temp);\n        string = \"name=\" + string;\n\n        Serial.println(temp) ;             // \u5024\u3092\u30d1\u30bd\u30b3\u30f3(\uff29\uff24\uff25)\u306b\u9001\u308b\n\n\n        // HTTP POST \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n        httpClient.post(\"www.example.com\", \"/\", \"name=hoge%27hoge&val=123\", \"application/x-www-form-urlencoded\");\n\n        // \u30ec\u30b9\u30dd\u30f3\u30b9 status code \u304c 0 \u4ee5\u4e0a\u3067\u3042\u308c\u3070\u30ea\u30af\u30a8\u30b9\u30c8\u6210\u529f\u3067\u3059\u3002\n        //   -1: \u30ce\u30a4\u30ba\u7b49\u3067\u30b7\u30ea\u30a2\u30eb\u901a\u4fe1\u304c\u3067\u304d\u305a\u3001\u305d\u3082\u305d\u3082\u30c7\u30fc\u30bf\u9001\u4fe1\u304c\u3067\u304d\u306a\u304b\u3063\u305f\u3002\n        //    0: \u30c7\u30fc\u30bf\u9001\u4fe1\u306f\u3067\u304d\u305f\u304c\u3001\u53d7\u4fe1\u30c7\u30fc\u30bf\u304c\u30ce\u30a4\u30ba\u3067\u58ca\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u3002\n        //   else (>0): \u53d7\u4fe1\u30c7\u30fc\u30bf\u304b\u3089\u6b63\u5e38\u306b HTTP \u30ec\u30b9\u30dd\u30f3\u30b9 status code \u304c\u5f97\u3089\u308c\u305f\u3002\n\n        if(httpClient.responseStatusCode() >= 0) {\n            // \u672c\u30da\u30fc\u30b8\u3067\u306f\u96fb\u5727\u30ec\u30d9\u30eb\u30b3\u30f3\u30d0\u30fc\u30bf\u3092\u7528\u610f\u3057\u3066\u3044\u306a\u3044\u60f3\u5b9a\u306e\u305f\u3081\u3001\n            // \u53d7\u4fe1\u30c7\u30fc\u30bf\u304c\u58ca\u308c\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u304f\u3001\u3057\u305f\u304c\u3063\u3066 200 \u304c 100 \u306b\u306a\u3063\u3066\u3044\u305f\u308a\u3059\u308b\u305f\u3081\u3001\n            // \u5024\u306b\u306f\u8208\u5473\u3092\u3082\u305f\u305a\u30010 \u4ee5\u4e0a\u306e\u5024\u304c\u5f97\u3089\u308c\u308b\u3053\u3068\u304c\u91cd\u8981\u3067\u3042\u308b\u3068\u8003\u3048\u3066\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u307e\u3059\u3002\n            Serial.println(\"SUCCESS\");\n\n            break; // \u6210\u529f\u3057\u305f\u306e\u3067 while \u3092\u629c\u3051\u307e\u3059\u3002\n        }\n        else {\n            Serial.println(\"FAILURE, retrying...\");\n        }\n    }\n\n    // \u672c\u30b5\u30f3\u30d7\u30eb\u3067\u306f 30 \u5206\u6bce\u306b POST \u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\n    delay(1800000);  // 1800000 = 30d\n}\n\n\n\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u52d5\u304d\u307e\u3059\u3002\n\n\n6.\u3042\u3068\u306fWeb\u30da\u30fc\u30b8\u304b\u3089\u898b\u3089\u308c\u308b\u3088\u3046\u306b\u3057\u3088\u3046\n\u3053\u3053\u307e\u3067\u304d\u305f\u3089\u79c1\u3082\u82e6\u52b4\u306a\u304f\u3067\u304d\u307e\u3059\u3002(\u307e\u3060\u307e\u3060\u672a\u719f\u8005\u3067\u3059\u304c\u30fb\u30fb\u30fb)\n\u30d9\u30bf\u30ac\u30ad\u3067\u3044\u3044\u306e\u3067\u3068\u308a\u3042\u3048\u305a\n1.input.php (\u63a5\u7d9a\u3055\u305b\u308b\u30fb\u633f\u5165)\n2.output.php (\u51fa\u529b\u3055\u305b\u308b)\n3.index.html (\u3053\u3053\u3067\u30b0\u30e9\u30d5\u51fa\u529b\u30fbjs\u3092\u76f4\u66f8\u304d) <- js\u3044\u3064\u3082\u306a\u3089\u5225\u3051\u307e\u3059\u3002\n\u3068\u308a\u3042\u3048\u305ainput.php\n\ninput.php\n<?php\n\ndate_default_timezone_set('Asia/Tokyo');\ntry {\n$pdo = new PDO('mysql:host=\u30c9\u30e1\u30a4\u30f3;dbname=DB\u306e\u540d\u524d;charset=utf8','\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d','\u30d1\u30b9\u30ef\u30fc\u30c9',\n    array(PDO::ATTR_EMULATE_PREPARES => false));\nprint '\u63a5\u7d9a\u6210\u529f';\n\necho $date = date(\"H:i:s\");   \n\n\nif(isset($_POST['name']) && isset($date)) {\n    $stmt = $pdo -> prepare(\"INSERT INTO wifi_test (value, dates) VALUES (:value, :dates)\");\n    // $_POST['']\u306e\u3068\u3053\u308d\u306b\u9001\u4fe1\u3055\u305b\u305f\u5024\u304c\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\n    $stmt->bindValue(':value', $_POST['name'], PDO::PARAM_INT);\n    $stmt->bindValue(':dates', $date, PDO::PARAM_INT);\n\n    $stmt->execute();\n}\n\n} catch (PDOException $e) {\n    exit('\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u5931\u6557\u3002'.$e->getMessage());\n}\n?>\n\n\n\n\u6b21\u306boutput.php\n\noutput.php\n<?php\n\nheader('Access-Control-Allow-Origin: *');\nheader('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept');\n\n$temperature = array(); // \u6e29\u5ea6\u683c\u7d0d\n$dates = array();       // \u6642\u9593\u683c\u7d0d\n$totalvalue = array();  // \u6e29\u5ea6\u30fb\u6642\u9593\n\n$count = 0;\n\ntry{\n    $pdo = new PDO('mysql:host=\u30c9\u30e1\u30a4\u30f3;dbname=DB\u306e\u540d\u524d;charset=utf8','\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d','\u30d1\u30b9\u30ef\u30fc\u30c9',\n    array(PDO::ATTR_EMULATE_PREPARES => false));\n\n    $stmt = $pdo->prepare(\"SELECT * FROM \u30c6\u30fc\u30d6\u30eb\");\n    $stmt->execute();\n\n    // foreach\u6587\u3067\u914d\u5217\u306e\u4e2d\u8eab\u3092\u4e00\u884c\u305a\u3064\u51fa\u529b\n    foreach ($stmt as $row) {\n        // \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3067\u51fa\u529b\n        $temperature[$count] = $row['value'];\n        $dates[$count] = $row['dates'];\n        ++$count;\n    }\n\n    for($i = 0; $i < $count; ++$i){\n        $totalvalue[$i] = array($temperature[$i],$dates[$i]);\n    }\n\n    echo json_encode($totalvalue);\n\n} catch (PDOException $e) {\n    exit('\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u5931\u6557\u3002'.$e->getMessage());\n}\n\n\n\n?>\n\n\n\n\u6b21\u306b\u51fa\u529b\u7528\u306eindex.html\n\nindex.html\n<!doctype html>\n<html>\n<head>\n    <title> Animation Callbacks </title>\n    <script src=\"js/Chart.bundle.js\"></script>\n    <script src=\"js/utils.js\"></script>\n    <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js\"></script>\n    <style>\n    canvas {\n        -moz-user-select: none;\n        -webkit-user-select: none;\n        -ms-user-select: none;\n    }\n    </style>\n</head>\n\n<body>\n    <div style=\"width: 75%;\">\n        <canvas id=\"canvas\"></canvas>\n        <progress id=\"animationProgress\" max=\"1\" value=\"0\" style=\"width: 100%\"></progress>\n    </div>\n    <br>\n    <br>\n    <button id=\"randomizeData\">Randomize Data</button>\n    <script>        \n\n        $(function(){\n            var tempdata;\n            $.ajax({\n                url: 'http://www.applicationdevelopment.esy.es/Arduinos/Wifi_communication/output.php', // \u4f8b\uff1a/ajax/?param=member\n                type: \"POST\", //POST\u3067\u9001\u4fe1\u3059\u308b\u306e\u304c\u3088\u308a\u5b89\u5168\n                async: false,\n                cache: false, //\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u30c7\u30fc\u30bf\u304c\u66f4\u65b0\u3055\u308c\u306a\u3044\u6642\u304c\u3042\u308b\u306e\u3067\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u7121\u52b9\u5316\n                dataType: \"text\"\n            }).done(function(data){\n                var data = JSON.parse(data);\n                tempdata = data;\n            })\n            echo(tempdata);\n        })\n\n\n\n        function echo(data){\n            console.log(data);\n            var MONTHS = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n            var progress = document.getElementById('animationProgress');\n            var config = {\n                type: 'line',\n                data: {\n                    labels: [ data[0][1]+\"\u6642\", data[1][1]+\"\u6642\", data[2][1]+\"\u6642\",\n                              data[3][1]+\"\u6642\", data[4][1]+\"\u6642\"],\n                    datasets: [{\n                        fill: false,\n                        borderColor: window.chartColors.red,\n                        backgroundColor: window.chartColors.red,\n                        data: [\n                            data[0][0],\n                            data[1][0],\n                            data[2][0],\n                            data[3][0],\n                            data[4][0]\n                        ]\n\n                    }]\n                }\n            };\n\n            window.onload = function() {\n                var ctx = document.getElementById(\"canvas\").getContext(\"2d\");\n                window.myLine = new Chart(ctx, config);\n            };\n        }\n        //window.myLine.update();\n\n\n    </script>\n</body>\n\n</html>\n\n\n\u4eca\u56de\u306fChart.js\u306e\u7e26\u30b0\u30e9\u30d5\u3092\u4f7f\u7528\u3002\n\u30c7\u30fc\u30bf\u306f5\u500b\u3068\u5236\u9650\u3057\u3066\u3044\u307e\u3059\u3002\n\u51fa\u529b\u3057\u305f\u306e\u304c\u3053\u3061\u3089\u3002\n\n\u3046\u307e\u304f\u3067\u304d\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3067\u4e00\u5fdc\u5b8c\u6210\u3068\u3057\u307e\u3059\u3002\n\u3044\u3084\u301c\u301c\u521d\u3081\u3066\u3054\u3068\u304c\u591a\u304b\u3063\u305f\u306e\u3067\u82e6\u6226\u3057\u307e\u3057\u305f\u304c\u3001\u4f55\u3068\u304b\u3067\u304d\u307e\u3057\u305f\u3002\n\u7686\u3055\u3093\u3082\u8208\u5473\u3092\u6301\u305f\u308c\u305f\u3089\u662f\u975e\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044 !! \u305d\u308c\u3067\u306f\u3002\u3002\u3002\n\u307f\u306a\u3055\u3093\u5f8c\u7de8\u306b\u3088\u3046\u3053\u305d!\n\u524d\u56de\u307e\u3067\u306e\u8a18\u4e8b\u3092\u898b\u3066\u3044\u306a\u3044\u65b9\u306f\u4e0b\u304b\u3089\u3069\u3046\u305e!\n\n[arduino wifi\u3068\u6e29\u5ea6\u30bb\u30f3\u30b5\u3092\u4f7f\u3044\u7c21\u6613\u7684\u306a\u30b0\u30e9\u30d5\u306b\u51fa\u529b\u3057\u3066\u307f\u305f\u3002(\u524d\u7de8)](http://qiita.com/mizugasira/items/1793e3411cfcb81c92cd)\n\n\u524d\u56de\u306fWifi\u57fa\u76e4\u3092\u3064\u3051\u305fArduino\u306bWifi\u63a5\u7d9a\u7528\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u8fbc\u3093\u3067\u78ba\u8a8d\u307e\u3067\u3092\u3057\u307e\u3057\u305f\u306d\u3002\n\u3053\u3053\u307e\u3067\u304f\u308c\u3070\u3082\u3046\u7c21\u5358\u306e\u57df\u3067\u3059\u3002\n\n\u305d\u308c\u3067\u306f\u7d9a\u304d\u3092\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n# 4.\u6e29\u5ea6\u30bb\u30f3\u30b5\u3092\u914d\u7dda\u3057\u3088\u3046\u3002\n\n\u79c1\u521d\u5fc3\u8005\u306a\u306e\u3067\u3068\u308a\u3042\u3048\u305a\u8abf\u3079\u3066\u307f\u305f\u3089\u5c71\u307b\u3069\u3042\u308a\u307e\u3057\u305f\u3002\n\n[\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc(LM61CIZ)\u306e\u4f7f\u3044\u65b9\uff11](http://www.geocities.jp/zattouka/GarageHouse/micon/Arduino/Temp/Temp.htm)\n\n\u3053\u3061\u3089\u306e\u8a18\u4e8b\u3092\u307e\u3093\u307e\u30b3\u30d4\u30da\u3001\u3068\u308a\u3042\u3048\u305a\u3053\u308c\u5358\u4f53\u3067\u52d5\u304b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n![image6.png](https://qiita-image-store.s3.amazonaws.com/0/85552/25147c54-c166-7342-d94f-d795de52b49c.png)\n\n\u30aa\u30c3\u30b1\u30fc\u30aa\u30c3\u30b1\u30fc\u7c21\u5358\u3060\u306a\u3002\n\u914d\u7dda\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n![image7.png](https://qiita-image-store.s3.amazonaws.com/0/85552/49413687-30d9-a8da-8f09-82563ee08c19.png)\n\n\u3053\u308c\u3067\u6e29\u5ea6\u30bb\u30f3\u30b5\u306f\u30aa\u30c3\u30b1\u30fc\n\n# 5.Wifi\u63a5\u7d9a\u30b3\u30fc\u30c9\u306b\u6e29\u5ea6\u30bb\u30f3\u30b5\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u8fbc\u307f\n\u3044\u305f\u3063\u3066\u7c21\u5358\u3067\u3059\u3002\n\u305f\u3060\u5358\u306bWifi\u63a5\u7d9a\u30b3\u30fc\u30c9\u306b\u4e0a\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u8fbc\u3080\u3060\u3051\u3002(\u306a\u3093\u3068\u7c21\u5358\u306a\u30fb\u30fb)\n\n\u5b8c\u6210\u30b3\u30fc\u30c9\u304c\u3053\u3061\u3089\n\n```test.ino\n#include <HttpClient_ESP8266_AT.h>\n\n// Arduino UNO \u306e\u5834\u5408\u306f\u3001\u4f8b\u3048\u3070\u30c7\u30b8\u30bf\u30eb\u5165\u51fa\u529b\u306e 2 \u756a, 4 \u756a\u30d4\u30f3\u3092\u5229\u7528\u3057\u3066\n// ESP-WROOM-02 \u3068\u30b7\u30ea\u30a2\u30eb\u901a\u4fe1\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nconst byte rxPin = 2; // Wire this to Tx Pin of ESP8266\nconst byte txPin = 4; // Wire this to Rx Pin of ESP8266\nHttpClient_ESP8266_AT httpClient(rxPin, txPin);\n\n\nvoid setup() {\n    // PC \u3068\u901a\u4fe1\u3059\u308b HardwareSerial \u306e baudrate \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n    // ESP-WROOM-02 \u306e baudrate \u3068\u306f\u95a2\u4fc2\u3042\u308a\u307e\u305b\u3093\u3002\n    Serial.begin(115200);\n\n    // SSID \u3068 PASSWORD \u3067\u30a2\u30af\u30bb\u30b9\u30dd\u30a4\u30f3\u30c8\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002\n    // \u30b7\u30ea\u30a2\u30eb\u63a5\u7d9a\u78ba\u8a8d\u3068 WiFi \u63a5\u7d9a\u78ba\u8a8d\u3092\u884c\u3044\u3001\u8a2d\u5b9a\u4e0d\u5099\u304c\u3042\u308c\u3070\u51fa\u529b\u3057\u307e\u3059\u3002\n    while(true) {\n        if(httpClient.statusAT()) { Serial.println(\"AT status OK\"); break; }\n        else Serial.println(\"AT status NOT OK\");\n        delay(1000);\n    }\n    while(true) { // \u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u2193\n        if(httpClient.connectAP(\"SSID\", \"PASSWORD\")) { Serial.println(\"Successfully connected to an AP\"); break; }\n        else Serial.println(\"Failed to connected to an AP. retrying...\");\n        delay(1000);\n    }\n    while(true) {\n        if(httpClient.statusWiFi()) { Serial.println(\"WiFi status OK\"); break; }\n        else Serial.println(\"WiFi status NOT OK\");\n        delay(1000);\n    }\n}\n   \n\nvoid loop() {\n    // \u30ce\u30a4\u30ba\u306e\u5f71\u97ff\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5931\u6557\u3059\u308b\u3053\u3068\u304c\u3042\u308b\u305f\u3081 while \u30eb\u30fc\u30d7\u3067\u56f2\u3044\u307e\u3059\u3002\n    while(true) {\n      \n        int temp;\n        int ans , tv ;\n        \n        ans = analogRead(0) ;              // \u30a2\u30ca\u30ed\u30b0\uff10\u756a\u30d4\u30f3\u304b\u3089\u30bb\u30f3\u30b5\u30fc\u5024\u3092\u8aad\u8fbc\u3080\n        tv  = map(ans,0,1023,0,5000) ;     // \u30bb\u30f3\u30b5\u30fc\u5024\u3092\u96fb\u5727\u306b\u5909\u63db\u3059\u308b\n        temp = map(tv,300,1600,-30,100) ;  // \u96fb\u5727\u304b\u3089\u6e29\u5ea6\u306b\u5909\u63db\u3059\u308b\n        String string = String(temp);\n        string = \"name=\" + string;\n        \n        Serial.println(temp) ;             // \u5024\u3092\u30d1\u30bd\u30b3\u30f3(\uff29\uff24\uff25)\u306b\u9001\u308b\n\n        \n        // HTTP POST \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n        httpClient.post(\"www.example.com\", \"/\", \"name=hoge%27hoge&val=123\", \"application/x-www-form-urlencoded\");\n\n        // \u30ec\u30b9\u30dd\u30f3\u30b9 status code \u304c 0 \u4ee5\u4e0a\u3067\u3042\u308c\u3070\u30ea\u30af\u30a8\u30b9\u30c8\u6210\u529f\u3067\u3059\u3002\n        //   -1: \u30ce\u30a4\u30ba\u7b49\u3067\u30b7\u30ea\u30a2\u30eb\u901a\u4fe1\u304c\u3067\u304d\u305a\u3001\u305d\u3082\u305d\u3082\u30c7\u30fc\u30bf\u9001\u4fe1\u304c\u3067\u304d\u306a\u304b\u3063\u305f\u3002\n        //    0: \u30c7\u30fc\u30bf\u9001\u4fe1\u306f\u3067\u304d\u305f\u304c\u3001\u53d7\u4fe1\u30c7\u30fc\u30bf\u304c\u30ce\u30a4\u30ba\u3067\u58ca\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u3002\n        //   else (>0): \u53d7\u4fe1\u30c7\u30fc\u30bf\u304b\u3089\u6b63\u5e38\u306b HTTP \u30ec\u30b9\u30dd\u30f3\u30b9 status code \u304c\u5f97\u3089\u308c\u305f\u3002\n\n        if(httpClient.responseStatusCode() >= 0) {\n            // \u672c\u30da\u30fc\u30b8\u3067\u306f\u96fb\u5727\u30ec\u30d9\u30eb\u30b3\u30f3\u30d0\u30fc\u30bf\u3092\u7528\u610f\u3057\u3066\u3044\u306a\u3044\u60f3\u5b9a\u306e\u305f\u3081\u3001\n            // \u53d7\u4fe1\u30c7\u30fc\u30bf\u304c\u58ca\u308c\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u304f\u3001\u3057\u305f\u304c\u3063\u3066 200 \u304c 100 \u306b\u306a\u3063\u3066\u3044\u305f\u308a\u3059\u308b\u305f\u3081\u3001\n            // \u5024\u306b\u306f\u8208\u5473\u3092\u3082\u305f\u305a\u30010 \u4ee5\u4e0a\u306e\u5024\u304c\u5f97\u3089\u308c\u308b\u3053\u3068\u304c\u91cd\u8981\u3067\u3042\u308b\u3068\u8003\u3048\u3066\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u307e\u3059\u3002\n            Serial.println(\"SUCCESS\");\n            \n            break; // \u6210\u529f\u3057\u305f\u306e\u3067 while \u3092\u629c\u3051\u307e\u3059\u3002\n        }\n        else {\n            Serial.println(\"FAILURE, retrying...\");\n        }\n    }\n\n    // \u672c\u30b5\u30f3\u30d7\u30eb\u3067\u306f 30 \u5206\u6bce\u306b POST \u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\n    delay(1800000);  // 1800000 = 30d\n}\n\n\n```\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u52d5\u304d\u307e\u3059\u3002\n![image8.png](https://qiita-image-store.s3.amazonaws.com/0/85552/2acc1339-d7dc-a2d3-85c0-6b8b03d7422b.png)\n\n# 6.\u3042\u3068\u306fWeb\u30da\u30fc\u30b8\u304b\u3089\u898b\u3089\u308c\u308b\u3088\u3046\u306b\u3057\u3088\u3046\n\u3053\u3053\u307e\u3067\u304d\u305f\u3089\u79c1\u3082\u82e6\u52b4\u306a\u304f\u3067\u304d\u307e\u3059\u3002(\u307e\u3060\u307e\u3060\u672a\u719f\u8005\u3067\u3059\u304c\u30fb\u30fb\u30fb)\n\n\u30d9\u30bf\u30ac\u30ad\u3067\u3044\u3044\u306e\u3067\u3068\u308a\u3042\u3048\u305a\n1.input.php (\u63a5\u7d9a\u3055\u305b\u308b\u30fb\u633f\u5165)\n2.output.php (\u51fa\u529b\u3055\u305b\u308b)\n3.index.html (\u3053\u3053\u3067\u30b0\u30e9\u30d5\u51fa\u529b\u30fbjs\u3092\u76f4\u66f8\u304d) <- js\u3044\u3064\u3082\u306a\u3089\u5225\u3051\u307e\u3059\u3002\n\n\u3068\u308a\u3042\u3048\u305ainput.php\n\n```input.php\n<?php\n\ndate_default_timezone_set('Asia/Tokyo');\ntry {\n$pdo = new PDO('mysql:host=\u30c9\u30e1\u30a4\u30f3;dbname=DB\u306e\u540d\u524d;charset=utf8','\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d','\u30d1\u30b9\u30ef\u30fc\u30c9',\n\tarray(PDO::ATTR_EMULATE_PREPARES => false));\nprint '\u63a5\u7d9a\u6210\u529f';\n\necho $date = date(\"H:i:s\");   \n\n\nif(isset($_POST['name']) && isset($date)) {\n\t$stmt = $pdo -> prepare(\"INSERT INTO wifi_test (value, dates) VALUES (:value, :dates)\");\n    // $_POST['']\u306e\u3068\u3053\u308d\u306b\u9001\u4fe1\u3055\u305b\u305f\u5024\u304c\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\n\t$stmt->bindValue(':value', $_POST['name'], PDO::PARAM_INT);\n\t$stmt->bindValue(':dates', $date, PDO::PARAM_INT);\n\n\t$stmt->execute();\n}\n\n} catch (PDOException $e) {\n\texit('\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u5931\u6557\u3002'.$e->getMessage());\n}\n?>\n\n```\n\n\u6b21\u306boutput.php\n\n```output.php\n<?php\n\nheader('Access-Control-Allow-Origin: *');\nheader('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept');\n\n$temperature = array();\t// \u6e29\u5ea6\u683c\u7d0d\n$dates = array();\t\t// \u6642\u9593\u683c\u7d0d\n$totalvalue = array();\t// \u6e29\u5ea6\u30fb\u6642\u9593\n\n$count = 0;\n\ntry{\n\t$pdo = new PDO('mysql:host=\u30c9\u30e1\u30a4\u30f3;dbname=DB\u306e\u540d\u524d;charset=utf8','\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d','\u30d1\u30b9\u30ef\u30fc\u30c9',\n\tarray(PDO::ATTR_EMULATE_PREPARES => false));\n\n\t$stmt = $pdo->prepare(\"SELECT * FROM \u30c6\u30fc\u30d6\u30eb\");\n\t$stmt->execute();\n\n\t// foreach\u6587\u3067\u914d\u5217\u306e\u4e2d\u8eab\u3092\u4e00\u884c\u305a\u3064\u51fa\u529b\n\tforeach ($stmt as $row) {\n\t\t// \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3067\u51fa\u529b\n\t\t$temperature[$count] = $row['value'];\n\t\t$dates[$count] = $row['dates'];\n\t\t++$count;\n\t}\n\n\tfor($i = 0; $i < $count; ++$i){\n\t\t$totalvalue[$i] = array($temperature[$i],$dates[$i]);\n\t}\n\n\techo json_encode($totalvalue);\n\n} catch (PDOException $e) {\n\texit('\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u5931\u6557\u3002'.$e->getMessage());\n}\n\n\n\n?>\n\n```\n\n\u6b21\u306b\u51fa\u529b\u7528\u306eindex.html\n\n```index.html\n<!doctype html>\n<html>\n<head>\n\t<title> Animation Callbacks </title>\n    <script src=\"js/Chart.bundle.js\"></script>\n    <script src=\"js/utils.js\"></script>\n    <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js\"></script>\n    <style>\n    canvas {\n        -moz-user-select: none;\n        -webkit-user-select: none;\n        -ms-user-select: none;\n    }\n    </style>\n</head>\n\n<body>\n    <div style=\"width: 75%;\">\n        <canvas id=\"canvas\"></canvas>\n        <progress id=\"animationProgress\" max=\"1\" value=\"0\" style=\"width: 100%\"></progress>\n    </div>\n    <br>\n    <br>\n    <button id=\"randomizeData\">Randomize Data</button>\n    <script>    \t\n\n\t\t$(function(){\n\t\t\tvar tempdata;\n\t\t\t$.ajax({\n\t\t\t\turl: 'http://www.applicationdevelopment.esy.es/Arduinos/Wifi_communication/output.php', // \u4f8b\uff1a/ajax/?param=member\n\t\t\t\ttype: \"POST\", //POST\u3067\u9001\u4fe1\u3059\u308b\u306e\u304c\u3088\u308a\u5b89\u5168\n\t\t\t\tasync: false,\n\t\t\t\tcache: false, //\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u30c7\u30fc\u30bf\u304c\u66f4\u65b0\u3055\u308c\u306a\u3044\u6642\u304c\u3042\u308b\u306e\u3067\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u7121\u52b9\u5316\n\t\t\t\tdataType: \"text\"\n\t\t\t}).done(function(data){\n\t\t\t\tvar data = JSON.parse(data);\n\t\t\t\ttempdata = data;\n\t\t\t})\n\t\t\techo(tempdata);\n\t\t})\n\n\n\n\t\tfunction echo(data){\n\t\t\tconsole.log(data);\n\t        var MONTHS = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n\t        var progress = document.getElementById('animationProgress');\n\t        var config = {\n\t            type: 'line',\n\t            data: {\n\t                labels: [ data[0][1]+\"\u6642\", data[1][1]+\"\u6642\", data[2][1]+\"\u6642\",\n\t                \t\t  data[3][1]+\"\u6642\", data[4][1]+\"\u6642\"],\n\t                datasets: [{\n\t                    fill: false,\n\t                    borderColor: window.chartColors.red,\n\t                    backgroundColor: window.chartColors.red,\n\t                    data: [\n\t                        data[0][0],\n\t                        data[1][0],\n\t                        data[2][0],\n\t                        data[3][0],\n\t                        data[4][0]\n\t                    ]\n\t                \n\t                }]\n\t            }\n\t        };\n\n\t        window.onload = function() {\n\t            var ctx = document.getElementById(\"canvas\").getContext(\"2d\");\n\t            window.myLine = new Chart(ctx, config);\n\t        };\n\t\t}\n\t\t//window.myLine.update();\n\t\n\n    </script>\n</body>\n\n</html>\n```\n\n\u4eca\u56de\u306fChart.js\u306e\u7e26\u30b0\u30e9\u30d5\u3092\u4f7f\u7528\u3002\n\u30c7\u30fc\u30bf\u306f5\u500b\u3068\u5236\u9650\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u51fa\u529b\u3057\u305f\u306e\u304c\u3053\u3061\u3089\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-01-19 16.34.55.png](https://qiita-image-store.s3.amazonaws.com/0/85552/960b2668-cfaf-2711-5513-81edc7bc466e.png)\n\n\u3046\u307e\u304f\u3067\u304d\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3067\u4e00\u5fdc\u5b8c\u6210\u3068\u3057\u307e\u3059\u3002\n\u3044\u3084\u301c\u301c\u521d\u3081\u3066\u3054\u3068\u304c\u591a\u304b\u3063\u305f\u306e\u3067\u82e6\u6226\u3057\u307e\u3057\u305f\u304c\u3001\u4f55\u3068\u304b\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u7686\u3055\u3093\u3082\u8208\u5473\u3092\u6301\u305f\u308c\u305f\u3089\u662f\u975e\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044 !! \u305d\u308c\u3067\u306f\u3002\u3002\u3002\n", "tags": ["Arduino", "\u30bb\u30f3\u30b5\u30fc"]}