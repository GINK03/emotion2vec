{"context": " More than 1 year has passed since last update.rails4\u3067\u8a18\u4e8b\u7de8\u96c6\u30d5\u30a9\u30fc\u30e0\u3092\u4f5c\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u4e2d\u3067\u306etips\u3067\u3059\u3002\n\u4ee5\u4e0b\u306e\u6d41\u308c\u3092\u5b9f\u73fe\u3057\u307e\u3057\u305f\u3002\n\n\u8a18\u4e8b\u7de8\u96c6\u4e2d\u306b\u753b\u50cf\u3092\u9078\u629e\u3002\n\u975e\u540c\u671f\u3067\u753b\u50cf\u304c\u30b5\u30fc\u30d0\u30fc\u5074\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u308b\u3002\npaperclip\u3067\u30b5\u30e0\u30cd\u30a4\u30eb\u304c\u4f5c\u3089\u308c\u3066amazon-s3\u306b\u8ee2\u9001\u3055\u308c\u308b\u3002\n\u6210\u529f\u3057\u305f\u3089280x210\u30b5\u30a4\u30ba\u306eURL\u3092\u8fd4\u3059\u3002\n\u8a18\u4e8b\u4e2d\u306b\u753b\u50cf\u304c\u57cb\u3081\u8fbc\u307e\u308c\u308b\u306e\u3067\u3001\u672c\u6587\u306e\u7de8\u96c6\u3092\u7d99\u7d9a\u3059\u308b\u3002\n\nbootstrap\u5c0e\u5165\u306e\u8aac\u660e\u306f\u7701\u304d\u307e\u3059\u3002\nrails\u5074\u3067\u306f\u3001aws-sdk\u3068paperclip\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\nSummernote\nhttp://hackerwins.github.io/summernote/\nSummernote\u306b\u3064\u3044\u3066\u306f\u30b5\u30f3\u30d7\u30eb\u3084github\u4e0a\u3067\u6d3b\u767a\u306a\u3084\u308a\u3068\u308a\u304c\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u306e\u8fba\u308a\u3092\u898b\u308b\u3068\u307b\u3068\u3093\u3069\u306e\u554f\u984c\u306f\u89e3\u6c7a\u3059\u308b\u3068\u601d\u3044\u307e\u3059\u3002\nhttp://hackerwins.github.io/summernote/example.html\nhttps://github.com/HackerWins/summernote/issues\nSummernote\u672c\u4f53\u306f\u4ee5\u4e0b\u306ecss\u3068js\u3067\u3059\u3002\n<link href=\"/stylesheets/summernote.css\" rel=\"stylesheet\">\n<script src=\"/javascripts/summernote.js\"></script>\n\n\u753b\u50cfupload\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u958b\u304f\u3068\u30b9\u30af\u30ed\u30fc\u30eb\u30d0\u30fc\u304c\u6d88\u3048\u308b\u73fe\u8c61\u304c\u8d77\u3053\u3063\u305f\u5834\u5408\u3001\nmaster\u3067\u306f\u540c\u73fe\u8c61\u306f\u89e3\u6c7a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001master\u304b\u3089\u53d6\u5f97\u3057\u306a\u304a\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u307f\u3093\u306a\u5927\u597d\u304dfont-awesome\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n <link rel=\"stylesheet\" href=\"//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css\">\n\n\u3042\u3068\u65e5\u672c\u8a9e\u5bfe\u5fdc\u3082\u3057\u3066\u3044\u307e\u3059\u3002\u4ee5\u4e0bURL\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u554f\u984c\u306a\u3051\u308c\u3070\u305d\u306e\u307e\u307e\u5229\u7528\u3059\u308b\u306e\u304c\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nhttps://github.com/HackerWins/summernote/blob/master/lang/summernote-ja-JP.js\n\u3053\u3053\u307e\u3067\u304c\u5c0e\u5165\u3067\u3001\u3053\u3053\u304b\u3089\u304c\u672c\u984c\u3067\u3059\u3002\nerb\u306e\u30b3\u30fc\u30c9\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002body\u304c\u8a18\u4e8b\u306e\u672c\u6587\u3067\u3001\u672c\u6587\u4e2d\u306b\u753b\u50cf\u304c\u542b\u307e\u308c\u307e\u3059\u3002\n<%= f.text_field :title %>\n<%= f.text_area :body, rows: 15 %>\n<%= f.datetime_select :published_datetime, :use_month_numbers => true, :date_separator => '/', minute_step: 30, :include_blank => true, :default => nil %>\n\njavascript\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002routes\u3067resources :blog_images\u3057\u3066\u3044\u308b\u306e\u3067\u3001post\u30e1\u30bd\u30c3\u30c9\u3092\u6307\u5b9a\u3059\u308b\u3068blog_images#create\u304c\u547c\u3070\u308c\u307e\u3059\u3002\n$(document).ready(function() {\n\n  function sendFile(file, editor,welEditable) {\n    data = new FormData();\n    data.append(\"blog_image[image]\", file);\n    $.ajax({\n      url: '/blog_images',\n      data: data,\n      cache: false,\n      contentType: false,\n      processData: false,\n      type: 'POST',\n      success: function(data){\n        editor.insertImage(welEditable, data.url);\n      }\n    });\n  }\n\n  $('#blog_article_body').summernote({\n    height: 300, /*\u9ad8\u3055\u3092\u6307\u5b9a*/\n    lang: 'ja-JP', /*\u65e5\u672c\u8a9e\u5bfe\u5fdc*/\n    toolbar: [\n      ['style', ['bold', 'italic', 'underline', 'clear']],\n      ['fontsize', ['fontsize']],\n      ['color', ['color']],\n      ['para', ['ul', 'ol', 'paragraph']],\n      ['height', ['height']],\n      ['insert', ['picture', 'video']],\n    ],\n    onImageUpload: function(files, editor, welEditable) {\n        sendFile(files[0], editor,welEditable);\n    }\n  });\n});\n\n\u30e2\u30c7\u30eb\u306fpaperclip\u3092\u4f7f\u3063\u3066\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\nclass BlogImage < ActiveRecord::Base\n\n  belongs_to :blog\n\n  has_attached_file :image, Proc.new {\n    options = {\n      :storage => :s3,\n      :s3_credentials => \"#{Rails.root.to_s}/config/s3.yml\",\n      :s3_permissions => \"public-read\",\n      :s3_headers => {'Expires' => 10.year.from_now.httpdate},\n      :styles => {\n      :\"70x52\" => [\"70x52#\", :jpg], # 4:3\n      :\"280x210\" => [\"280x210#\", :jpg], # 4:3\n      },\n      #:convert_options => { :thumb => \"-quality 85\"},\n      :default_url => \"/images/:style/missing.png\",\n      :size => { :in => 0..(4.megabytes) }\n    }\n  }.call\n\n  validates_attachment_content_type :image, :content_type =>/^image\\/(.*)/\n\n  def file\n    Paperclip.io_adapters.for(image)\n  end\n\n  def url(style = \"\")\n    \"https://s3-ap-northeast-1.amazonaws.com/webcreation.co.jp.samlet.resources/\" + image.path(style)\n  end\n\nend\n\ncontroller\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\u6210\u529f\u3057\u305f\u3089json\u3067URL\u3092\u8fd4\u3057\u307e\u3059\u3002\u305d\u306eURL\u304c\u30d6\u30ed\u30b0\u5074\u3067\u305d\u306e\u307e\u307e\u57cb\u3081\u8fbc\u307e\u308c\u307e\u3059\u3002\n  def create\n    @blog_image = BlogImage.new(params.require(:blog_image).permit(:image))\n    @blog_image.blog_id = current_user.venue.blog.id\n    if @blog_image.save\n      render json: {url: @blog_image.url(\"280x210\")}, status: 200\n    else\n      render nothing: true, status: 500\n    end\n  end\n\n\u8a18\u4e8b\u7de8\u96c6\u4e2d\u306b\u753b\u50cf\u304c\u81ea\u7136\u306bUPLOAD\u3055\u308c\u3066\u3001\u672c\u6587\u306b\u57cb\u3081\u8fbc\u307e\u308c\u308b\u306e\u3067\u5feb\u9069\u3067\u3059\u3002\nrails4\u3067\u8a18\u4e8b\u7de8\u96c6\u30d5\u30a9\u30fc\u30e0\u3092\u4f5c\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u4e2d\u3067\u306etips\u3067\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u6d41\u308c\u3092\u5b9f\u73fe\u3057\u307e\u3057\u305f\u3002\n\n1. \u8a18\u4e8b\u7de8\u96c6\u4e2d\u306b\u753b\u50cf\u3092\u9078\u629e\u3002\n2. \u975e\u540c\u671f\u3067\u753b\u50cf\u304c\u30b5\u30fc\u30d0\u30fc\u5074\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u308b\u3002\n3. paperclip\u3067\u30b5\u30e0\u30cd\u30a4\u30eb\u304c\u4f5c\u3089\u308c\u3066amazon-s3\u306b\u8ee2\u9001\u3055\u308c\u308b\u3002\n4. \u6210\u529f\u3057\u305f\u3089280x210\u30b5\u30a4\u30ba\u306eURL\u3092\u8fd4\u3059\u3002\n5. \u8a18\u4e8b\u4e2d\u306b\u753b\u50cf\u304c\u57cb\u3081\u8fbc\u307e\u308c\u308b\u306e\u3067\u3001\u672c\u6587\u306e\u7de8\u96c6\u3092\u7d99\u7d9a\u3059\u308b\u3002\n\nbootstrap\u5c0e\u5165\u306e\u8aac\u660e\u306f\u7701\u304d\u307e\u3059\u3002\nrails\u5074\u3067\u306f\u3001aws-sdk\u3068paperclip\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\nSummernote\nhttp://hackerwins.github.io/summernote/\n\nSummernote\u306b\u3064\u3044\u3066\u306f\u30b5\u30f3\u30d7\u30eb\u3084github\u4e0a\u3067\u6d3b\u767a\u306a\u3084\u308a\u3068\u308a\u304c\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u306e\u8fba\u308a\u3092\u898b\u308b\u3068\u307b\u3068\u3093\u3069\u306e\u554f\u984c\u306f\u89e3\u6c7a\u3059\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nhttp://hackerwins.github.io/summernote/example.html\nhttps://github.com/HackerWins/summernote/issues\n\nSummernote\u672c\u4f53\u306f\u4ee5\u4e0b\u306ecss\u3068js\u3067\u3059\u3002\n\n```html\n<link href=\"/stylesheets/summernote.css\" rel=\"stylesheet\">\n<script src=\"/javascripts/summernote.js\"></script>\n```\n\n\u753b\u50cfupload\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u958b\u304f\u3068\u30b9\u30af\u30ed\u30fc\u30eb\u30d0\u30fc\u304c\u6d88\u3048\u308b\u73fe\u8c61\u304c\u8d77\u3053\u3063\u305f\u5834\u5408\u3001\nmaster\u3067\u306f\u540c\u73fe\u8c61\u306f\u89e3\u6c7a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001master\u304b\u3089\u53d6\u5f97\u3057\u306a\u304a\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u307f\u3093\u306a\u5927\u597d\u304dfont-awesome\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n```html\n <link rel=\"stylesheet\" href=\"//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css\">\n```\n\n\u3042\u3068\u65e5\u672c\u8a9e\u5bfe\u5fdc\u3082\u3057\u3066\u3044\u307e\u3059\u3002\u4ee5\u4e0bURL\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u554f\u984c\u306a\u3051\u308c\u3070\u305d\u306e\u307e\u307e\u5229\u7528\u3059\u308b\u306e\u304c\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nhttps://github.com/HackerWins/summernote/blob/master/lang/summernote-ja-JP.js\n\n\u3053\u3053\u307e\u3067\u304c\u5c0e\u5165\u3067\u3001\u3053\u3053\u304b\u3089\u304c\u672c\u984c\u3067\u3059\u3002\n\nerb\u306e\u30b3\u30fc\u30c9\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002body\u304c\u8a18\u4e8b\u306e\u672c\u6587\u3067\u3001\u672c\u6587\u4e2d\u306b\u753b\u50cf\u304c\u542b\u307e\u308c\u307e\u3059\u3002\n\n```erb\n<%= f.text_field :title %>\n<%= f.text_area :body, rows: 15 %>\n<%= f.datetime_select :published_datetime, :use_month_numbers => true, :date_separator => '/', minute_step: 30, :include_blank => true, :default => nil %>\n```\n\njavascript\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002routes\u3067resources :blog_images\u3057\u3066\u3044\u308b\u306e\u3067\u3001post\u30e1\u30bd\u30c3\u30c9\u3092\u6307\u5b9a\u3059\u308b\u3068blog_images#create\u304c\u547c\u3070\u308c\u307e\u3059\u3002\n\n```js\n$(document).ready(function() {\n\n  function sendFile(file, editor,welEditable) {\n    data = new FormData();\n    data.append(\"blog_image[image]\", file);\n    $.ajax({\n      url: '/blog_images',\n      data: data,\n      cache: false,\n      contentType: false,\n      processData: false,\n      type: 'POST',\n      success: function(data){\n        editor.insertImage(welEditable, data.url);\n      }\n    });\n  }\n  \n  $('#blog_article_body').summernote({\n    height: 300, /*\u9ad8\u3055\u3092\u6307\u5b9a*/\n    lang: 'ja-JP', /*\u65e5\u672c\u8a9e\u5bfe\u5fdc*/\n    toolbar: [\n      ['style', ['bold', 'italic', 'underline', 'clear']],\n      ['fontsize', ['fontsize']],\n      ['color', ['color']],\n      ['para', ['ul', 'ol', 'paragraph']],\n      ['height', ['height']],\n      ['insert', ['picture', 'video']],\n    ],\n    onImageUpload: function(files, editor, welEditable) {\n        sendFile(files[0], editor,welEditable);\n    }\n  });\n});\n```\n\n\u30e2\u30c7\u30eb\u306fpaperclip\u3092\u4f7f\u3063\u3066\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n```rb\n\nclass BlogImage < ActiveRecord::Base\n\n  belongs_to :blog\n\n  has_attached_file :image, Proc.new {\n    options = {\n      :storage => :s3,\n      :s3_credentials => \"#{Rails.root.to_s}/config/s3.yml\",\n      :s3_permissions => \"public-read\",\n      :s3_headers => {'Expires' => 10.year.from_now.httpdate},\n      :styles => {\n      :\"70x52\" => [\"70x52#\", :jpg], # 4:3\n      :\"280x210\" => [\"280x210#\", :jpg], # 4:3\n      },\n      #:convert_options => { :thumb => \"-quality 85\"},\n      :default_url => \"/images/:style/missing.png\",\n      :size => { :in => 0..(4.megabytes) }\n    }\n  }.call\n\n  validates_attachment_content_type :image, :content_type =>/^image\\/(.*)/\n\n  def file\n    Paperclip.io_adapters.for(image)\n  end\n\n  def url(style = \"\")\n    \"https://s3-ap-northeast-1.amazonaws.com/webcreation.co.jp.samlet.resources/\" + image.path(style)\n  end\n\nend\n```\n\ncontroller\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\u6210\u529f\u3057\u305f\u3089json\u3067URL\u3092\u8fd4\u3057\u307e\u3059\u3002\u305d\u306eURL\u304c\u30d6\u30ed\u30b0\u5074\u3067\u305d\u306e\u307e\u307e\u57cb\u3081\u8fbc\u307e\u308c\u307e\u3059\u3002\n\n```rb\n  def create\n    @blog_image = BlogImage.new(params.require(:blog_image).permit(:image))\n    @blog_image.blog_id = current_user.venue.blog.id\n    if @blog_image.save\n      render json: {url: @blog_image.url(\"280x210\")}, status: 200\n    else\n      render nothing: true, status: 500\n    end\n  end\n```\n\n\u8a18\u4e8b\u7de8\u96c6\u4e2d\u306b\u753b\u50cf\u304c\u81ea\u7136\u306bUPLOAD\u3055\u308c\u3066\u3001\u672c\u6587\u306b\u57cb\u3081\u8fbc\u307e\u308c\u308b\u306e\u3067\u5feb\u9069\u3067\u3059\u3002\n", "tags": ["Rails4", "jQuery", "bootstrap"]}