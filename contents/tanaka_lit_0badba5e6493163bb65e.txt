{"context": "http://hwks.hatenadiary.jp/entry/2014/07/06/175224\n\nGPSLoader.cs\nusing UnityEngine;\nusing System.Collections;\nusing UnityEngine.UI;\n\npublic class GPSLoader : MonoBehaviour {\n\n    public Text label;\n    IEnumerator Start() {\n        if (!Input.location.isEnabledByUser) {\n            label.text = \"Error\";\n            yield break;\n        }\n        Input.location.Start();\n        int maxWait =  120;\n        while (Input.location.status == LocationServiceStatus.Initializing && maxWait > 0) {\n            yield return new WaitForSeconds(1);\n            maxWait--;\n        }\n        if (maxWait < 1) {\n            label.text = \"Timed out\";\n            yield break;\n        }\n        if (Input.location.status == LocationServiceStatus.Failed) {\n            label.text = \"Unable to determine device location\";\n            yield break;\n        } else {\n\n            string s = \"Location: \" +\n                       Input.location.lastData.latitude + \" \" +\n                       Input.location.lastData.longitude + \" \" +\n                       Input.location.lastData.altitude + \" \" +\n                       Input.location.lastData.horizontalAccuracy + \" \" +\n                       Input.location.lastData.timestamp;\n            label.text = s;\n\n        }\n        Input.location.Stop();\n    }\n}\n\n\nhttp://qiita.com/aimino/items/2149990a551bf5c0d59d\nhttp://shigekix5.wp.xdomain.jp/?p=588\n\nSkyBoxStreetView.cs\nusing UnityEngine;\nusing System.Collections;\npublic class SkyBoxStreetView : MonoBehaviour\n{\n    // Skybox\u306b\u8cbc\u308a\u4ed8\u3051\u308b\u30c6\u30af\u30b9\u30c1\u30e3\n    public Texture2D[] textures;\n    // GoogleStreetView\u3067\u4f7f\u7528\u3059\u308b\u5024\u306e\u5ba3\u8a00\n    // \u30ab\u30e1\u30e9\u306e\u5411\u304d\n    public double heading = 0.0;\n    public double pitch = 0.0;\n    // \u53d6\u5f97\u3059\u308b\u753b\u50cf\u306e\u30b5\u30a4\u30ba(640\u304c\u6700\u5927)\n    private int width = 640;\n    private int height = 640;\n    // \u8efd\u5ea6\u30fb\u7def\u5ea6(GoogleMap\u3067\u78ba\u8a8d\u3067\u304d\u308b)\n    private double longitude = 139.399488;\n    private double latitude = 35.785554;\n    // \u8996\u91ce(\u6700\u5927120)\n    public double fov;\n    // \u524d\u5f8c\u5de6\u53f3\u4e0a\u4e0b\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u5909\u6570\n    private int skyNum;\n    void Start() {\n        UpdateSkybox();\n    }\n    // \u30e1\u30a4\u30f3\u90e8\u5206\n    void UpdateSkybox() {\n        textures = new Texture2D[6];\n        // \u524d\u5f8c\u5de6\u53f3\u4e0a\u4e0b\u3092\u305d\u308c\u305e\u308c\u53d6\u5f97\n        for(skyNum=0; skyNum<6; skyNum++) { \n            fov = 90; \n            switch(skyNum) { \n            case 0: //front \n                heading = 0; \n                pitch = 0; \n                StartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum));\n                break; \n            case 1: //back \n                heading = 180; \n                pitch = 0; \n                StartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum)); \n                break; \n            case 2: // left\n                heading = 90; \n                pitch = 0; \n                StartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum)); \n                break; \n            case 3: //right\n                heading = 270; \n                pitch = 0; \n                StartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum));\n                break; \n            case 4: //up\n                heading = 0; \n                pitch = 90; \n                StartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum)); \n                break;\n            case 5: // down\n                heading = 0; \n                pitch = -90;\n                StartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum)); \n                break; \n            } \n        } \n    } // Google Map Street View\u306e\u753b\u50cf\u3092\u53d6\u3063\u3066\u304f\u308b \n    private IEnumerator GetStreetViewImage(double latitude, double longitude, double heading, double pitch, double fov, int skyNum) { \n        string url = \"http://maps.googleapis.com/maps/api/streetview?\" + \"size=\" + width + \"x\" + height + \"&location=\" + latitude + \",\" + longitude + \"&heading=\" + heading + \"&pitch=\" + pitch + \"&fov=\" + fov + \"&sensor=false\";\n        Debug.Log(skyNum + \" : \" + url);\n        WWW www = new WWW(url); yield return www; \n        // textures\u306b\u53d6\u5f97\u3057\u3066\u30c6\u30af\u30b9\u30c1\u30e3\u3092\u30bb\u30c3\u30c8 \n        textures[skyNum] = www.texture; \n        // \u3061\u3083\u3093\u3068\u30c6\u30af\u30b9\u30c1\u30e3\u3092\u53d6\u5f97\u3067\u304d\u305f\u3089skybox\u3092\u4f5c\u308b\n        CreateSkyBox(); \n    }\n    void CreateSkyBox() { \n        // Manifest\u3092\u4f5c\u6210\n        SkyboxManifest manifest = new SkyboxManifest(textures[0], textures[1], textures[2], textures[3], textures[4], textures[5]); \n        // \u4f5c\u6210\u3057\u305fManifest\u304b\u3089\u30de\u30c6\u30ea\u30a2\u30eb\u3092\u4f5c\u6210 \n        Material material = CreateSkyboxMaterial(manifest); \n        SetSkybox(material); \n        enabled = false; \n    }\n    public static Material CreateSkyboxMaterial(SkyboxManifest manifest) { \n        // Skybox\u5f62\u5f0f\u306e\u30de\u30c6\u30ea\u30a2\u30eb\u3092\u4f5c\u6210\u3057\u3066\u30c6\u30af\u30b9\u30c1\u30e3\u3092\u30bb\u30c3\u30c8 \n        Material result = new Material(Shader.Find(\"RenderFX/Skybox\")); \n        result.SetTexture(\"_FrontTex\", manifest.textures[0]); \n        result.SetTexture(\"_BackTex\", manifest.textures[1]); \n        result.SetTexture(\"_LeftTex\", manifest.textures[2]); \n        result.SetTexture(\"_RightTex\", manifest.textures[3]);\n        result.SetTexture(\"_UpTex\", manifest.textures[4]); \n        result.SetTexture(\"_DownTex\", manifest.textures[5]); \n        return result;\n    } \n    void SetSkybox(Material material) {\n        // \u30e1\u30a4\u30f3\u30ab\u30e1\u30e9\u3092\u53d6\u5f97\u3057\u3066 \n        GameObject camera = Camera.main.gameObject;\n        // Skybox\u3092\u53d6\u5f97\n        Skybox skybox = camera.GetComponent<Skybox>();\n        // Skybox\u304c\u306a\u3051\u308c\u3070\u4f5c\u6210\n        if (skybox == null)\n            skybox = camera.AddComponent<Skybox>();\n        // Skybox\u306b\u30de\u30c6\u30ea\u30a2\u30eb\u3092\u30bb\u30c3\u30c8\n        skybox.material = material;\n    }\n\n    // Skybox\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u306e\u69cb\u9020\u4f53\n    public struct SkyboxManifest\n    {\n        public Texture2D[] textures;\n        public SkyboxManifest(Texture2D front, Texture2D back, Texture2D left, Texture2D right, Texture2D up, Texture2D down)\n        {\n            textures = new Texture2D[6]\n            {\n                front,\n                back,\n                left,\n                right,\n                up,\n                down\n            };\n        }\n    }\n}\n\n\nhttp://hwks.hatenadiary.jp/entry/2014/07/06/175224\n\n```csharp:GPSLoader.cs\nusing UnityEngine;\nusing System.Collections;\nusing UnityEngine.UI;\n\npublic class GPSLoader : MonoBehaviour {\n\n\tpublic Text label;\n\tIEnumerator Start() {\n\t\tif (!Input.location.isEnabledByUser) {\n\t\t\tlabel.text = \"Error\";\n\t\t\tyield break;\n\t\t}\n\t\tInput.location.Start();\n\t\tint maxWait =  120;\n\t\twhile (Input.location.status == LocationServiceStatus.Initializing && maxWait > 0) {\n\t\t\tyield return new WaitForSeconds(1);\n\t\t\tmaxWait--;\n\t\t}\n\t\tif (maxWait < 1) {\n\t\t\tlabel.text = \"Timed out\";\n\t\t\tyield break;\n\t\t}\n\t\tif (Input.location.status == LocationServiceStatus.Failed) {\n\t\t\tlabel.text = \"Unable to determine device location\";\n\t\t\tyield break;\n\t\t} else {\n\n\t\t\tstring s = \"Location: \" +\n\t\t\t           Input.location.lastData.latitude + \" \" +\n\t\t\t           Input.location.lastData.longitude + \" \" +\n\t\t\t           Input.location.lastData.altitude + \" \" +\n\t\t\t           Input.location.lastData.horizontalAccuracy + \" \" +\n\t\t\t           Input.location.lastData.timestamp;\n\t\t\tlabel.text = s;\n\t\t\t\n\t\t}\n\t\tInput.location.Stop();\n\t}\n}\n```\n\nhttp://qiita.com/aimino/items/2149990a551bf5c0d59d\n\nhttp://shigekix5.wp.xdomain.jp/?p=588\n\n```csharp:SkyBoxStreetView.cs\nusing UnityEngine;\nusing System.Collections;\npublic class SkyBoxStreetView : MonoBehaviour\n{\n\t// Skybox\u306b\u8cbc\u308a\u4ed8\u3051\u308b\u30c6\u30af\u30b9\u30c1\u30e3\n\tpublic Texture2D[] textures;\n\t// GoogleStreetView\u3067\u4f7f\u7528\u3059\u308b\u5024\u306e\u5ba3\u8a00\n\t// \u30ab\u30e1\u30e9\u306e\u5411\u304d\n\tpublic double heading = 0.0;\n\tpublic double pitch = 0.0;\n\t// \u53d6\u5f97\u3059\u308b\u753b\u50cf\u306e\u30b5\u30a4\u30ba(640\u304c\u6700\u5927)\n\tprivate int width = 640;\n\tprivate int height = 640;\n\t// \u8efd\u5ea6\u30fb\u7def\u5ea6(GoogleMap\u3067\u78ba\u8a8d\u3067\u304d\u308b)\n\tprivate double longitude = 139.399488;\n\tprivate double latitude = 35.785554;\n\t// \u8996\u91ce(\u6700\u5927120)\n\tpublic double fov;\n\t// \u524d\u5f8c\u5de6\u53f3\u4e0a\u4e0b\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u5909\u6570\n\tprivate int skyNum;\n\tvoid Start() {\n\t\tUpdateSkybox();\n\t}\n\t// \u30e1\u30a4\u30f3\u90e8\u5206\n\tvoid UpdateSkybox() {\n\t\ttextures = new Texture2D[6];\n\t\t// \u524d\u5f8c\u5de6\u53f3\u4e0a\u4e0b\u3092\u305d\u308c\u305e\u308c\u53d6\u5f97\n\t\tfor(skyNum=0; skyNum<6; skyNum++) { \n\t\t\tfov = 90; \n\t\t\tswitch(skyNum) { \n\t\t\tcase 0: //front \n\t\t\t\theading = 0; \n\t\t\t\tpitch = 0; \n\t\t\t\tStartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum));\n\t\t\t\tbreak; \n\t\t\tcase 1: //back \n\t\t\t\theading = 180; \n\t\t\t\tpitch = 0; \n\t\t\t\tStartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum)); \n\t\t\t\tbreak; \n\t\t\tcase 2: // left\n\t\t\t\theading = 90; \n\t\t\t\tpitch = 0; \n\t\t\t\tStartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum)); \n\t\t\t\tbreak; \n\t\t\tcase 3: //right\n\t\t\t\theading = 270; \n\t\t\t\tpitch = 0; \n\t\t\t\tStartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum));\n\t\t\t\tbreak; \n\t\t\tcase 4: //up\n\t\t\t\theading = 0; \n\t\t\t\tpitch = 90; \n\t\t\t\tStartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum)); \n\t\t\t\tbreak;\n\t\t\tcase 5: // down\n\t\t\t\theading = 0; \n\t\t\t\tpitch = -90;\n\t\t\t\tStartCoroutine(GetStreetViewImage(latitude, longitude, heading, pitch, fov, skyNum)); \n\t\t\t\tbreak; \n\t\t\t} \n\t\t} \n\t} // Google Map Street View\u306e\u753b\u50cf\u3092\u53d6\u3063\u3066\u304f\u308b \n\tprivate IEnumerator GetStreetViewImage(double latitude, double longitude, double heading, double pitch, double fov, int skyNum) { \n\t\tstring url = \"http://maps.googleapis.com/maps/api/streetview?\" + \"size=\" + width + \"x\" + height + \"&location=\" + latitude + \",\" + longitude + \"&heading=\" + heading + \"&pitch=\" + pitch + \"&fov=\" + fov + \"&sensor=false\";\n\t\tDebug.Log(skyNum + \" : \" + url);\n\t\tWWW www = new WWW(url); yield return www; \n\t\t// textures\u306b\u53d6\u5f97\u3057\u3066\u30c6\u30af\u30b9\u30c1\u30e3\u3092\u30bb\u30c3\u30c8 \n\t\ttextures[skyNum] = www.texture; \n\t\t// \u3061\u3083\u3093\u3068\u30c6\u30af\u30b9\u30c1\u30e3\u3092\u53d6\u5f97\u3067\u304d\u305f\u3089skybox\u3092\u4f5c\u308b\n\t\tCreateSkyBox(); \n\t}\n\tvoid CreateSkyBox() { \n\t\t// Manifest\u3092\u4f5c\u6210\n\t\tSkyboxManifest manifest = new SkyboxManifest(textures[0], textures[1], textures[2], textures[3], textures[4], textures[5]); \n\t\t// \u4f5c\u6210\u3057\u305fManifest\u304b\u3089\u30de\u30c6\u30ea\u30a2\u30eb\u3092\u4f5c\u6210 \n\t\tMaterial material = CreateSkyboxMaterial(manifest); \n\t\tSetSkybox(material); \n\t\tenabled = false; \n\t}\n\tpublic static Material CreateSkyboxMaterial(SkyboxManifest manifest) { \n\t\t// Skybox\u5f62\u5f0f\u306e\u30de\u30c6\u30ea\u30a2\u30eb\u3092\u4f5c\u6210\u3057\u3066\u30c6\u30af\u30b9\u30c1\u30e3\u3092\u30bb\u30c3\u30c8 \n\t\tMaterial result = new Material(Shader.Find(\"RenderFX/Skybox\")); \n\t\tresult.SetTexture(\"_FrontTex\", manifest.textures[0]); \n\t\tresult.SetTexture(\"_BackTex\", manifest.textures[1]); \n\t\tresult.SetTexture(\"_LeftTex\", manifest.textures[2]); \n\t\tresult.SetTexture(\"_RightTex\", manifest.textures[3]);\n\t\tresult.SetTexture(\"_UpTex\", manifest.textures[4]); \n\t\tresult.SetTexture(\"_DownTex\", manifest.textures[5]); \n\t\treturn result;\n\t} \n\tvoid SetSkybox(Material material) {\n\t\t// \u30e1\u30a4\u30f3\u30ab\u30e1\u30e9\u3092\u53d6\u5f97\u3057\u3066 \n\t\tGameObject camera = Camera.main.gameObject;\n\t\t// Skybox\u3092\u53d6\u5f97\n\t\tSkybox skybox = camera.GetComponent<Skybox>();\n\t\t// Skybox\u304c\u306a\u3051\u308c\u3070\u4f5c\u6210\n\t\tif (skybox == null)\n\t\t\tskybox = camera.AddComponent<Skybox>();\n\t\t// Skybox\u306b\u30de\u30c6\u30ea\u30a2\u30eb\u3092\u30bb\u30c3\u30c8\n\t\tskybox.material = material;\n\t}\n\n\t// Skybox\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u306e\u69cb\u9020\u4f53\n\tpublic struct SkyboxManifest\n\t{\n\t\tpublic Texture2D[] textures;\n\t\tpublic SkyboxManifest(Texture2D front, Texture2D back, Texture2D left, Texture2D right, Texture2D up, Texture2D down)\n\t\t{\n\t\t\ttextures = new Texture2D[6]\n\t\t\t{\n\t\t\t\tfront,\n\t\t\t\tback,\n\t\t\t\tleft,\n\t\t\t\tright,\n\t\t\t\tup,\n\t\t\t\tdown\n\t\t\t};\n\t\t}\n\t}\n}\n```\n", "tags": ["Unity", "Unity3D", "GPS"]}