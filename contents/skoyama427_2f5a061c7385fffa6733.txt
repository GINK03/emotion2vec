{"context": "\u6df7\u5408\u5206\u5e03\u306e\u30d1\u30e9\u30e1\u30bf\u3092Rstan\u3067\u63a8\u5b9a\u3059\u308b\u3002\n\n1. \u6b63\u898f\u5206\u5e03\u304c\u4e8c\u3064\u306e\u5834\u5408\nlibrary(rstan)\n\nsrc <- \"\ndata {\n  int N;\n  int M;\n  real x[N];\n}\n\nparameters {\n  real mu[M];\n  real sigma[M];\n  simplex[M] pi;\n}\n\nmodel {\n  real ps[M];\n  for(n in 1:N){\n    ps[1] <- log(pi[1]) + normal_log(x[n], mu[1], sigma[1]);\n    ps[2] <- log(pi[2]) + normal_log(x[n], mu[2], sigma[2]);\n    increment_log_prob(log_sum_exp(ps));\n  }\n}\n\"\n\nx <- c(rnorm(150, 1, 1), rnorm(850, 10, 3))\ndat <- list(N=length(x), M=2, x=x)\n\nout <- stan(\n  model_code = src,\n  data = dat,\n  iter = 4000,\n  warmup = 2000,\n  thin = 1,\n  chains = 2,\n)\n\nsummary(out)\n\n\n2. \u30dd\u30a2\u30bd\u30f3\u5206\u5e03\u304c\u4e8c\u3064\u306e\u5834\u5408\nlibrary(rstan)\n\nsrc <- \"\n  data {\n    int N;\n    int M;\n    int x[N];\n  }\n\n  parameters {\n    real kappa[M];\n    simplex[M] pi;\n  }\n\n  model {\n    real ps[M];\n    for(n in 1:N){\n      ps[1] <- log(pi[1]) + poisson_log(x[n], kappa[1]);\n      ps[2] <- log(pi[2]) + poisson_log(x[n], kappa[2]);\n      increment_log_prob(log_sum_exp(ps));\n    }\n  }\n\"\n\nx <- c(rpois(150, 1), rpois(850, 5))\ndat <- list(N=length(x), M=2, x=x)\n\nout <- stan(\n  model_code = src,\n  data = dat,\n  iter = 4000,\n  warmup = 2000,\n  thin = 1,\n  chains = 2\n)\n\nsummary(out)\n\n\n3. \u4e00\u69d8\u5206\u5e03\u306e\u4e0a\u9650\u3092\u63a8\u5b9a\nlibrary(rstan) \n\nsrc <- \" \n  data { \n    int<lower=1> N; \n    real<lower=0> x[N]; \n  } \n\n  parameters { \n    real<lower=0, upper=1000> high; \n  } \n\n  model { \n    high ~ uniform(0,1000); \n    x ~ uniform(0, high); \n  } \n\" \n\nx <- c(sample(0:10, 1000, replace=T)) \ndat <- list(N=1000, x=x) \n\nout <- stan( \n  model_code = src, \n  data = dat, \n  iter = 4000, \n  warmup = 2000, \n  thin = 1, \n  chains = 2, \n) \n\nsummary(out)\n\n\u6df7\u5408\u5206\u5e03\u306e\u30d1\u30e9\u30e1\u30bf\u3092Rstan\u3067\u63a8\u5b9a\u3059\u308b\u3002\n\n####1. \u6b63\u898f\u5206\u5e03\u304c\u4e8c\u3064\u306e\u5834\u5408\n\n```r\nlibrary(rstan)\n\nsrc <- \"\ndata {\n  int N;\n  int M;\n  real x[N];\n}\n\nparameters {\n  real mu[M];\n  real sigma[M];\n  simplex[M] pi;\n}\n\nmodel {\n  real ps[M];\n  for(n in 1:N){\n    ps[1] <- log(pi[1]) + normal_log(x[n], mu[1], sigma[1]);\n    ps[2] <- log(pi[2]) + normal_log(x[n], mu[2], sigma[2]);\n    increment_log_prob(log_sum_exp(ps));\n  }\n}\n\"\n\nx <- c(rnorm(150, 1, 1), rnorm(850, 10, 3))\ndat <- list(N=length(x), M=2, x=x)\n\nout <- stan(\n  model_code = src,\n  data = dat,\n  iter = 4000,\n  warmup = 2000,\n  thin = 1,\n  chains = 2,\n)\n\nsummary(out)\n```\n\n####2. \u30dd\u30a2\u30bd\u30f3\u5206\u5e03\u304c\u4e8c\u3064\u306e\u5834\u5408\n\n```r\nlibrary(rstan)\n\nsrc <- \"\n  data {\n    int N;\n    int M;\n    int x[N];\n  }\n\n  parameters {\n    real kappa[M];\n    simplex[M] pi;\n  }\n\n  model {\n    real ps[M];\n    for(n in 1:N){\n      ps[1] <- log(pi[1]) + poisson_log(x[n], kappa[1]);\n      ps[2] <- log(pi[2]) + poisson_log(x[n], kappa[2]);\n      increment_log_prob(log_sum_exp(ps));\n    }\n  }\n\"\n\nx <- c(rpois(150, 1), rpois(850, 5))\ndat <- list(N=length(x), M=2, x=x)\n\nout <- stan(\n  model_code = src,\n  data = dat,\n  iter = 4000,\n  warmup = 2000,\n  thin = 1,\n  chains = 2\n)\n\nsummary(out)\n```\n\n####3. \u4e00\u69d8\u5206\u5e03\u306e\u4e0a\u9650\u3092\u63a8\u5b9a\n\n```r\nlibrary(rstan) \n\nsrc <- \" \n  data { \n    int<lower=1> N; \n    real<lower=0> x[N]; \n  } \n\n  parameters { \n    real<lower=0, upper=1000> high; \n  } \n\n  model { \n    high ~ uniform(0,1000); \n    x ~ uniform(0, high); \n  } \n\" \n\nx <- c(sample(0:10, 1000, replace=T)) \ndat <- list(N=1000, x=x) \n\nout <- stan( \n  model_code = src, \n  data = dat, \n  iter = 4000, \n  warmup = 2000, \n  thin = 1, \n  chains = 2, \n) \n\nsummary(out)\n```\n", "tags": ["statistics", "R", "Stan"]}