{"tags": ["JavaScript", "Electron", "Node.js"], "context": "Electron\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u30ed\u30fc\u30ab\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u6271\u3046\u3053\u3068\u3082\u591a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u753b\u50cf\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3092\u3059\u308b\u969b\u306b\u3084\u3063\u3071\u308a\u30d5\u30a1\u30a4\u30eb\u30ed\u30fc\u30c9\u3060\u3068\u3081\u3093\u3069\u304f\u3055\u3044\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u30c9\u30ed\u30c3\u30d7\u3067\u3044\u3051\u305f\u3089UX\u7684\u306b\u3082\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\u305d\u308c\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\u306a\u304a\u3001\u30c9\u30e9\u30c3\u30b0\u30c9\u30ed\u30c3\u30d7\u3067\u3082\u3044\u3051\u307e\u3059\u3057\u3001\u8a72\u5f53\u7bc4\u56f2\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30d5\u30a1\u30a4\u30eb\u9078\u629e\u306b\u3082\u306a\u308a\u307e\u3059\u3002\n\u5b8c\u6210\u306f\u3053\u3093\u306a\u30a4\u30e1\u30fc\u30b8\u306e\u3084\u3064\u3067\u3059\u3002\n\n\u30c9\u30e9\u30c3\u30b0&\u30c9\u30ed\u30c3\u30d7\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u3082\u3063\u3066\u304f\u308b\u3068\u6240\u5b9a\u306eDiv\u4e0a\u3067\u8272\u304c\u5909\u308f\u3063\u3066\u305d\u306e\u307e\u307e\u653e\u308b\u3068\u305d\u306eDiv\u5185\u306b\u653e\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u305d\u308c\u3068\u540c\u6642\u306b\u6307\u5b9a\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30ed\u30fc\u30ab\u30eb\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\u307e\u305ajs\u5074\u306f\u3053\u3093\u306a\u304b\u3093\u3058\u3067\u3059\u3002\u66f8\u304d\u51fa\u3057\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u9069\u5b9c\u4fee\u6b63\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nos\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u3044\u308c\u3066\u3053\u3046\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u3067\u3059\u3002\n\nglobal.js\nconst os = require('os'),\n      fs = require('fs'); //\u3082\u3061\u308d\u3093fs\u30e2\u30b8\u30e5\u30fc\u30eb\u3082\n\nvar home = os.homedir(); //\u3053\u3046\u3057\u3066OS\u306b\u5bfe\u5fdc\u3057\u305f\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u53d6\u5f97\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\n\n\n\u3067\u3082\u3063\u3066\u95a2\u6570\u7fa4\u306ejs\u30d5\u30a1\u30a4\u30eb\u3092\u9069\u5f53\u306b\u3064\u304f\u3063\u3066\u3053\u3046\u3067\u3059\u3002\n\nfunctions.js\nfunction dnd_thumb() {\n    var box = document.getElementById('fileBox'),\n        elm = document.getElementById('receiveFile'),\n        input = document.getElementById('inputFile'),\n        ua = navigator.userAgent,\n        ua_ie = false,\n        elm_className_base = elm.className;\n    var file_select = function(evnt){\n        var files = evnt.target.files,\n            img_num = 0;\n        elm.className = elm_className_base;\n        elm.innerHTML = '';\n        for ( var i = 0; i < files.length; i++ ){\n            var indx = i;\n            file = files[indx],\n                reader = new FileReader();\n            if( !file.type.match('image.*')){\n                continue;\n            }\n            reader.onerror = function() {\n                this.innerHTML = '<p>Error!!</p>';\n            };\n            img_num += 1;\n            reader.onload = (function(theFile){\n                return function(e){\n                    var item = document.createElement('div'),\n                        item_txt = '';\n                    item.className = 'item';\n                    item.innerHTML = '<img src=\"' + e.target.result + '\" title=\"' + item_txt + '\" alt=\"' + item_txt + '\">';\n\n                    var public = '/User/userame/Directory/rename.jpg';\n                    var enc = e.target.result;\n                    var data = enc.replace(/^data:image\\/\\w+;base64,/, '');\n                    fs.writeFile(public, data, {encoding: 'base64'}, function(err){\n                        console.log(\"Success local data publish\");\n                    });\n\n                    elm.insertBefore(item, null);\n                };\n            })(file);\n            reader.readAsDataURL(file);\n        }\n        if( img_num < 1 ){\n            elm.innerHTML = '<p>\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u305b\u3093\u3002<br>\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30ed\u30c3\u30d7\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>';\n        }\n    };\n    if( ua_ie === false ){\n        box.ondragover = function(evnt){\n            evnt.stopPropagation();\n            evnt.preventDefault();\n            elm.className = elm_className_base + 'draggle';\n        };\n        box.ondragleave = function(evnt){\n            evnt.stopPropagation();\n            evnt.preventDefault();\n            elm.className = elm_className_base;\n        };\n    }\n    input.addEventListener('change', file_select, false);\n}\n\n\n\u3067\u3001\u30d5\u30ed\u30f3\u30c8\u5074\u306f\u3053\u3046\u3002\n<div id=\"fileBox\">\n  <div id=\"receiveFileOuter\">\n    <div id=\"receiveFile\"><p>\u3053\u3053\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30ed\u30c3\u30d7</p></div>\n   </div>\n   <input type=\"file\" id=\"inputFile\" value=\"\">\n</div>\n\n\u5e74\u672b\u51fa\u8840\u5927\u30b5\u30fc\u30d3\u30b9\u3067CSS\u3082\u3002\n#fileBox {\n    max-width: 236px;\n    height: 200px;\n    position: relative;\n    margin: 0 auto;\n    border: 3px solid #ebebeb;\n    border-radius: 5px;\n    -webkit-border-radius: 5px;\n    -moz-border-radius: 5px;\n}\n#receiveFileOuter {\n    width: 100%;\n    height: 100%;\n    display: table;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1;\n    background: #fff;\n}\n#receiveFile {\n    width: 100%;\n    height: 100%;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: center;\n}\n#receiveFile.draggle {\n    background: #fcc;\n}\n#receiveFile .item {\n    display: inline-block;\n    text-align: center;\n}\n#receiveFile .item img {\n    min-width: 100%;\n    height: 200px;\n    display: table;\n    margin: 0 auto;\n    border-radius: 5px;\n    -webkit-border-radius: 5px;\n    -moz-border-radius: 5px;\n}\n#receiveFile .item .image .imageInner {\n    display: table-cell;\n    vertical-align: middle;\n    text-align: center;\n}\n#receiveFile .item .image img {\n    height: 100px;\n}\n#fileBox input#inputFile {\n    width: 100%;\n    height: 300px;\n    opacity: 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 2;\n}\n#fileBox input#inputFile.nodrop,\n#fileBox.unsupported input#inputFile {\n    width: auto;\n    height: auto;\n    top: 30px;\n    left: 30px;\n    opacity: 1;\n    background: none;\n}\n\n\u3053\u308c\u3067\u65e5\u672c\u306eElectron\u958b\u767a\u800520\u4eba\u304f\u3089\u3044\u306f\u5e78\u305b\u306b\u306a\u308c\u308b\u306f\u305a\u3002\n\u3060\u308c\u304b\u3001\u3053\u308c\u306b\u30ea\u30b5\u30a4\u30ba\u6a5f\u80fd\u3064\u3051\u3066\u30b3\u30e1\u30f3\u30c8\u3067\u8fd4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3002\u3002\n\u3060\u308c\u304b\u30fc\u3002\u3002\u3002\uff08\u3053\u306e\u307e\u307e\u3058\u3083\u30ea\u30ea\u30fc\u30b9\u76ee\u6a19\u65e5\u306b\u9593\u306b\u5408\u308f\u306a\u3044\u30fb\u30fb\u30fb\uff09\n\u305b\u3063\u304b\u304f\u30ed\u30fc\u30ab\u30eb\u30a2\u30d7\u30ea\u306a\u306e\u3067\u3001\u753b\u50cf\u51e6\u7406\u306f\u30ed\u30fc\u30ab\u30eb\u306eCPU\u3092\u30d5\u30eb\u6d3b\u7528\u3055\u305b\u3066\u3082\u3089\u3044\u305f\u3044\u3067\u3059\u306d\u3002\n\u3067\u306f\u3002\n\n\u8ffd\u8a18:2017/1/7 ArrayBuffer\u3067\u306e\u5b9f\u88c5\n\u7d50\u5c40\u3053\u3093\u306a\u611f\u3058\u3067\u307e\u3068\u307e\u308a\u307e\u3057\u305f\u3002\nconst thumbnailDrop = e => {\n\n    e.stopPropagation();\n    e.preventDefault();\n\n    let file = e.dataTransfer.files,\n        area = document.getElementById('upload-thumbnail'),\n        output = document.getElementById('file-output'),\n        f = file[0];\n\n    if (f.type === 'image/png' || f.type === 'image/jpeg' ) {\n        let reader = new FileReader();\n        reader.onload = (function(theFile) {\n            return function(e) {\n                let data = new Buffer(e.target.result);\n                fs.writeFileSync('core/image.jpg', data, {encoding:'binary'})\n                area.innerHTML = '';\n                output.innerHTML = '<img src=\"core/image.jpg\">';\n            };\n        })(f);\n        reader.readAsArrayBuffer(f);\n    } else {\n        area.innerHTML = '';\n    }\n\n}\n\nCSS\u3068\u304b\u306f\u5148\u8ff0\u306e\u3082\u306e\u306f\u4f7f\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u304c\u3001\u3053\u3063\u3061\u306e\u307b\u3046\u304c\u30b3\u30fc\u30c9\u304c\u30b9\u30c3\u30ad\u30ea\u3002\nElectron\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u30ed\u30fc\u30ab\u30eb\u30d5\u30a1\u30a4\u30eb\u3092\u6271\u3046\u3053\u3068\u3082\u591a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u753b\u50cf\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3092\u3059\u308b\u969b\u306b\u3084\u3063\u3071\u308a\u30d5\u30a1\u30a4\u30eb\u30ed\u30fc\u30c9\u3060\u3068\u3081\u3093\u3069\u304f\u3055\u3044\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u30c9\u30ed\u30c3\u30d7\u3067\u3044\u3051\u305f\u3089UX\u7684\u306b\u3082\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\u305d\u308c\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\u306a\u304a\u3001\u30c9\u30e9\u30c3\u30b0\u30c9\u30ed\u30c3\u30d7\u3067\u3082\u3044\u3051\u307e\u3059\u3057\u3001\u8a72\u5f53\u7bc4\u56f2\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30d5\u30a1\u30a4\u30eb\u9078\u629e\u306b\u3082\u306a\u308a\u307e\u3059\u3002\n\n\u5b8c\u6210\u306f\u3053\u3093\u306a\u30a4\u30e1\u30fc\u30b8\u306e\u3084\u3064\u3067\u3059\u3002\n![sample.jpg](https://qiita-image-store.s3.amazonaws.com/0/144150/dde14fd7-6d88-8a0b-e7a7-0eeef4397e70.jpeg)\n\n\u30c9\u30e9\u30c3\u30b0&\u30c9\u30ed\u30c3\u30d7\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u3082\u3063\u3066\u304f\u308b\u3068\u6240\u5b9a\u306eDiv\u4e0a\u3067\u8272\u304c\u5909\u308f\u3063\u3066\u305d\u306e\u307e\u307e\u653e\u308b\u3068\u305d\u306eDiv\u5185\u306b\u653e\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u305d\u308c\u3068\u540c\u6642\u306b\u6307\u5b9a\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30ed\u30fc\u30ab\u30eb\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n\u307e\u305ajs\u5074\u306f\u3053\u3093\u306a\u304b\u3093\u3058\u3067\u3059\u3002\u66f8\u304d\u51fa\u3057\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u9069\u5b9c\u4fee\u6b63\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n<code>os</code>\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u3044\u308c\u3066\u3053\u3046\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\u3067\u3059\u3002\n\n```Javascript:global.js\nconst os = require('os'),\n      fs = require('fs'); //\u3082\u3061\u308d\u3093fs\u30e2\u30b8\u30e5\u30fc\u30eb\u3082\n\nvar home = os.homedir(); //\u3053\u3046\u3057\u3066OS\u306b\u5bfe\u5fdc\u3057\u305f\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u53d6\u5f97\u3057\u3066\u304a\u304f\u3068\u4fbf\u5229\n```\n\n\u3067\u3082\u3063\u3066\u95a2\u6570\u7fa4\u306ejs\u30d5\u30a1\u30a4\u30eb\u3092\u9069\u5f53\u306b\u3064\u304f\u3063\u3066\u3053\u3046\u3067\u3059\u3002\n\n```Javascript:functions.js\nfunction dnd_thumb() {\n    var\tbox = document.getElementById('fileBox'),\n        elm = document.getElementById('receiveFile'),\n        input = document.getElementById('inputFile'),\n        ua = navigator.userAgent,\n        ua_ie = false,\n        elm_className_base = elm.className;\n    var file_select = function(evnt){\n        var\tfiles = evnt.target.files,\n            img_num = 0;\n        elm.className = elm_className_base;\n        elm.innerHTML = '';\n        for ( var i = 0; i < files.length; i++ ){\n            var\tindx = i;\n            file = files[indx],\n                reader = new FileReader();\n            if( !file.type.match('image.*')){\n                continue;\n            }\n            reader.onerror = function() {\n                this.innerHTML = '<p>Error!!</p>';\n            };\n            img_num += 1;\n            reader.onload = (function(theFile){\n                return function(e){\n                    var\titem = document.createElement('div'),\n                        item_txt = '';\n                    item.className = 'item';\n                    item.innerHTML = '<img src=\"' + e.target.result + '\" title=\"' + item_txt + '\" alt=\"' + item_txt + '\">';\n\n                    var public = '/User/userame/Directory/rename.jpg';\n                    var enc = e.target.result;\n                    var data = enc.replace(/^data:image\\/\\w+;base64,/, '');\n                    fs.writeFile(public, data, {encoding: 'base64'}, function(err){\n                        console.log(\"Success local data publish\");\n                    });\n\n                    elm.insertBefore(item, null);\n                };\n            })(file);\n            reader.readAsDataURL(file);\n        }\n        if( img_num < 1 ){\n            elm.innerHTML = '<p>\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u305b\u3093\u3002<br>\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30ed\u30c3\u30d7\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>';\n        }\n    };\n    if( ua_ie === false ){\n        box.ondragover = function(evnt){\n            evnt.stopPropagation();\n            evnt.preventDefault();\n            elm.className = elm_className_base + 'draggle';\n        };\n        box.ondragleave = function(evnt){\n            evnt.stopPropagation();\n            evnt.preventDefault();\n            elm.className = elm_className_base;\n        };\n    }\n    input.addEventListener('change', file_select, false);\n}\n```\n\n\u3067\u3001\u30d5\u30ed\u30f3\u30c8\u5074\u306f\u3053\u3046\u3002\n\n```\n<div id=\"fileBox\">\n  <div id=\"receiveFileOuter\">\n    <div id=\"receiveFile\"><p>\u3053\u3053\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30ed\u30c3\u30d7</p></div>\n   </div>\n   <input type=\"file\" id=\"inputFile\" value=\"\">\n</div>\n```\n\n\u5e74\u672b\u51fa\u8840\u5927\u30b5\u30fc\u30d3\u30b9\u3067CSS\u3082\u3002\n\n```\n#fileBox {\n\tmax-width: 236px;\n\theight: 200px;\n\tposition: relative;\n\tmargin: 0 auto;\n    border: 3px solid #ebebeb;\n    border-radius: 5px;\n    -webkit-border-radius: 5px;\n    -moz-border-radius: 5px;\n}\n#receiveFileOuter {\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: table;\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 1;\n\tbackground: #fff;\n}\n#receiveFile {\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: table-cell;\n\tvertical-align: middle;\n\ttext-align: center;\n}\n#receiveFile.draggle {\n\tbackground: #fcc;\n}\n#receiveFile .item {\n\tdisplay: inline-block;\n\ttext-align: center;\n}\n#receiveFile .item img {\n\tmin-width: 100%;\n\theight: 200px;\n\tdisplay: table;\n\tmargin: 0 auto;\n    border-radius: 5px;\n    -webkit-border-radius: 5px;\n    -moz-border-radius: 5px;\n}\n#receiveFile .item .image .imageInner {\n\tdisplay: table-cell;\n\tvertical-align: middle;\n\ttext-align: center;\n}\n#receiveFile .item .image img {\n\theight: 100px;\n}\n#fileBox input#inputFile {\n\twidth: 100%;\n\theight: 300px;\n\topacity: 0;\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 2;\n}\n#fileBox input#inputFile.nodrop,\n#fileBox.unsupported input#inputFile {\n\twidth: auto;\n\theight: auto;\n\ttop: 30px;\n\tleft: 30px;\n\topacity: 1;\n\tbackground: none;\n}\n```\n\n\u3053\u308c\u3067\u65e5\u672c\u306eElectron\u958b\u767a\u800520\u4eba\u304f\u3089\u3044\u306f\u5e78\u305b\u306b\u306a\u308c\u308b\u306f\u305a\u3002\n\n\u3060\u308c\u304b\u3001\u3053\u308c\u306b\u30ea\u30b5\u30a4\u30ba\u6a5f\u80fd\u3064\u3051\u3066\u30b3\u30e1\u30f3\u30c8\u3067\u8fd4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3002\u3002\n\u3060\u308c\u304b\u30fc\u3002\u3002\u3002\uff08\u3053\u306e\u307e\u307e\u3058\u3083\u30ea\u30ea\u30fc\u30b9\u76ee\u6a19\u65e5\u306b\u9593\u306b\u5408\u308f\u306a\u3044\u30fb\u30fb\u30fb\uff09\n\u305b\u3063\u304b\u304f\u30ed\u30fc\u30ab\u30eb\u30a2\u30d7\u30ea\u306a\u306e\u3067\u3001\u753b\u50cf\u51e6\u7406\u306f\u30ed\u30fc\u30ab\u30eb\u306eCPU\u3092\u30d5\u30eb\u6d3b\u7528\u3055\u305b\u3066\u3082\u3089\u3044\u305f\u3044\u3067\u3059\u306d\u3002\n\u3067\u306f\u3002\n\n## \u8ffd\u8a18:2017/1/7 ArrayBuffer\u3067\u306e\u5b9f\u88c5\n\u7d50\u5c40\u3053\u3093\u306a\u611f\u3058\u3067\u307e\u3068\u307e\u308a\u307e\u3057\u305f\u3002\n\n```\nconst thumbnailDrop = e => {\n\n    e.stopPropagation();\n    e.preventDefault();\n\n    let file = e.dataTransfer.files,\n        area = document.getElementById('upload-thumbnail'),\n        output = document.getElementById('file-output'),\n        f = file[0];\n\n    if (f.type === 'image/png' || f.type === 'image/jpeg' ) {\n        let reader = new FileReader();\n        reader.onload = (function(theFile) {\n            return function(e) {\n                let data = new Buffer(e.target.result);\n                fs.writeFileSync('core/image.jpg', data, {encoding:'binary'})\n                area.innerHTML = '';\n                output.innerHTML = '<img src=\"core/image.jpg\">';\n            };\n        })(f);\n        reader.readAsArrayBuffer(f);\n    } else {\n        area.innerHTML = '';\n    }\n\n}\n```\nCSS\u3068\u304b\u306f\u5148\u8ff0\u306e\u3082\u306e\u306f\u4f7f\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u304c\u3001\u3053\u3063\u3061\u306e\u307b\u3046\u304c\u30b3\u30fc\u30c9\u304c\u30b9\u30c3\u30ad\u30ea\u3002\n"}