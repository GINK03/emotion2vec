{"tags": ["\u7d71\u8a08\u5b66"], "context": "\u30a2\u30b8\u30a2\u30c1\u30e3\u30f3\u30d4\u30aa\u30f3\u30ba\u30ea\u30fc\u30b02017\u304c\u958b\u5e55\u3057\u307e\u3057\u305f\u3002\u7d44\u5408\u305b\u306b\u3088\u3063\u3066\u3001\u6771\u30a2\u30b8\u30a2\u533a\u5404\u30b0\u30eb\u30fc\u30d7\u306e\u9806\u4f4d\u3092\u4e88\u60f3\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u904e\u53bb\u306e\u30c7\u30fc\u30bf\u3068\u5404\u30ea\u30fc\u30b0\u9593\u306e\u6570\u5b57\u306e\u662f\u6b63\n\u4e88\u60f3\u3059\u308b\u524d\u3001\u904e\u53bb3\u5e74\u9593(2014\u5e74\uff5e2016\u5e74)\u306eACL\u6771\u30a2\u30b8\u30a2\u30b0\u30eb\u30fc\u30d7\u4e88\u9078\u306e\u30c7\u30fc\u30bf\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nK\uff1a\u97d3\u56fd\u3000J\uff1a\u65e5\u672c\u3000C\uff1a\u4e2d\u56fd\u3000A\uff1a\u30aa\u30fc\u30b9\u30c8\u30e9\u30ea\u30a2\u3000T\uff1a\u30bf\u30a4\u3000V\uff1a\u30d9\u30c8\u30ca\u30e0\u3000H\uff1a\u9999\u6e2f\n\n\u3000\u904e\u53bb3\u5e74\u306e\u30c7\u30fc\u30bf\u304b\u3089\u898b\u308c\u3070\u3001K\u30ea\u30fc\u30b0\u306e\u6210\u7e3e\u304c\u629c\u3051\u3066\u3044\u307e\u3059\u3002J\u30ea\u30fc\u30b0\u3001C\u30ea\u30fc\u30b0\u3001A\u30ea\u30fc\u30b0\u306e\u6210\u7e3e\u304c\u307b\u307c\u4e26\u3093\u3067\u3044\u307e\u3059\u3002\u305d\u306e\u3046\u3061\u3001C\u30ea\u30fc\u30b0\u306f\u83ab\u5927\u306a\u8cc7\u91d1\u3092\u6295\u5165\u3059\u308b\u3068\u3068\u3082\u306b\u3001\u6210\u7e3e\u3082\u4e0a\u304c\u3063\u3066\u304d\u3066\u3044\u307e\u3059\u3002\n$$\u653b\u6483\u529b(home)\uff1df(\u5e73\u5747\u5f97\u70b9(home),\u76f8\u624b\u306e\u5e73\u5747\u5931\u70b9(away))$$\n$$\u653b\u6483\u529b(away)\uff1df(\u5e73\u5747\u5f97\u70b9(away),\u76f8\u624b\u306e\u5e73\u5747\u5931\u70b9(home))$$\n$f(\u30fb)$\u95a2\u6570\u306f\u3001\u3053\u3053\u3067\u516c\u958b\u3057\u307e\u305b\u3093\u3002\n1\uff0eT\u30ea\u30fc\u30b0\u3068K\u30ea\u30fc\u30b0\u306e\u30c1\u30fc\u30e0\u304c\u6bd4\u8f03\u7684\u306b\u5f31\u3044\u306e\u3067\u3001\u653b\u6483\u529b\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3059\u308b\u3002\nT\u306e\u30c1\u30fc\u30e0\u306f\u3001K\u3001J\u3001C\u3001A\u3068\u5bfe\u6226\u306e\u5834\u5408\u3001T\u306e\u653b\u6483\u529b\u3092\u3000$\u653b\u6483\u529b\uff0a0.6$\u3000\u306b\u4fee\u6b63\u3059\u308b\u3002\nH\u306e\u30c1\u30fc\u30e0\u306f\u3001K\u3001J\u3001C\u3001A\u3068\u5bfe\u6226\u306e\u5834\u5408\u3001H\u306e\u653b\u6483\u529b\u3092\u3000$\u653b\u6483\u529b\uff0a0.4$\u3000\u306b\u4fee\u6b63\u3059\u308b\u3002\n2\uff0eK\u30ea\u30fc\u30b0\u306e\u30c1\u30fc\u30e0\u306f\u30db\u30fc\u30e0\u3067\u5e73\u5747\u5931\u70b9\u304c\u4f4e\u3044\u306e\u3067\u3001\u30a2\u30a6\u30a7\u30a4\u30c1\u30fc\u30e0\u306e\u653b\u6483\u529b\u3092\u3000$\u653b\u6483\u529b(away)\uff0a0.8$\u3000\u306b\u4fee\u6b63\u3059\u308b\u3002\n\u3000\n\n2017\u5e74\u306e\u7d44\u5408\u305b\n\n\n\n\u30b0\u30eb\u30fc\u30d7E\n\u30b0\u30eb\u30fc\u30d7F\n\u30b0\u30eb\u30fc\u30d7G\n\u30b0\u30eb\u30fc\u30d7H\n\n\n\n\n\u9e7f\u5cf6\u30a2\u30f3\u30c8\u30e9\u30fc\u30ba\nFC\u30bd\u30a6\u30eb\n\u5e83\u5dde\u6052\u5927\n\u30a2\u30c7\u30ec\u30fc\u30c8\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\n\n\n\u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9(\u30bf\u30a4)\n\u6d66\u548c\u30ec\u30c3\u30ba\n\u6c34\u539f\u4e09\u661f\n\u6c5f\u8607\u8607\u5be7\n\n\n\u30d7\u30ec\u30fc\u30aa\u30d5\u52dd\u8005\n\u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc\n\u5ddd\u5d0e\u30d5\u30ed\u30f3\u30bf\u30fc\u30ec\n\u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\n\n\n\u30d7\u30ec\u30fc\u30aa\u30d5\u52dd\u8005\n\u30d7\u30ec\u30fc\u30aa\u30d5\u52dd\u8005\n\u6771\u65b9(\u9999\u6e2f)\n\u30d7\u30ec\u30fc\u30aa\u30d5\u52dd\u8005\n\n\n\n\u4e0a\u6d77\u4e0a\u6e2f\u3001\u851a\u5c71\u73fe\u4ee3\u3001\u30ac\u30f3\u30d0\u5927\u962a\u306e\u52dd\u3061\u4e0a\u304c\u308a\u306e\u53ef\u80fd\u6027\u304c\u975e\u5e38\u306b\u9ad8\u3044\u3067\u3059\u3002\n\u6b8b\u308a\u306e1\u30c1\u30fc\u30e0\u306f\u4e0a\u6d77\u7533\u82b1\u3068\u30d6\u30ea\u30b9\u30d9\u30f3\u30fb\u30ed\u30a2\u306e\u52dd\u8005\u3060\u3051\u3067\u3059\u3002\n\u3053\u306e17\u30c1\u30fc\u30e0\u306e\u6628\u30b7\u30fc\u30bc\u30f3\u5404\u6240\u5c5e\u30ea\u30fc\u30b0\u306e\u30c7\u30fc\u30bf\uff08\u662f\u6b63\u6e08\u307f\uff09\n\n\n\u30d7\u30ec\u30fc\u30aa\u30d5\n\n\n\n\u30c1\u30fc\u30e0\n\u8a66\u5408\u6570\n\u52dd\n\u5206\n\u8ca0\n\u5f97\u70b9\n\u5931\u70b9\n\n\n\n\n\u4e0a\u6d77\u7533\u82b1\uff08home\uff09\n15\n9\n6\n0\n33\n14\n\n\n\u30d6\u30ea\u30b9\u30d9\u30f3\u30fb\u30ed\u30a2(away)\n13\n3\n4\n6\n15\n24\n\n\n\n\u4e0a\u6d77\u7533\u82b1\u52dd\u3061\u306e\u78ba\u7387\u304c60%\u4ee5\u4e0a\u3068\u306a\u308a\u307e\u3059\u3002\n> round(Fun(prob),4)\n     W      D      L \n0.6019 0.2108 0.1872 \n\n\u30d7\u30ec\u30fc\u30aa\u30d5\u3067\u3001\u4e0a\u6d77\u4e0a\u6e2f\u3001\u851a\u5c71\u73fe\u4ee3\u3001\u30ac\u30f3\u30d0\u5927\u962a\u3001\u4e0a\u6d77\u7533\u82b14\u30c1\u30fc\u30e0\u304c\u52dd\u3061\u3042\u304c\u308b\u3068\u4e88\u60f3\u3057\u307e\u3059\u3002\n\n\n\n\u30b0\u30eb\u30fc\u30d7E\n\u30b0\u30eb\u30fc\u30d7F\n\u30b0\u30eb\u30fc\u30d7G\n\u30b0\u30eb\u30fc\u30d7H\n\n\n\n\n\u9e7f\u5cf6\u30a2\u30f3\u30c8\u30e9\u30fc\u30ba\nFC\u30bd\u30a6\u30eb\n\u5e83\u5dde\u6052\u5927\n\u30a2\u30c7\u30ec\u30fc\u30c9\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\n\n\n\u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9(\u30bf\u30a4)\n\u6d66\u548c\u30ec\u30c3\u30ba\n\u6c34\u539f\u4e09\u661f\n\u6c5f\u8607\u8607\u5be7\n\n\n\u851a\u5c71\u73fe\u4ee3\n\u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc\n\u5ddd\u5d0e\u30d5\u30ed\u30f3\u30bf\u30fc\u30ec\n\u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\n\n\n\u4e0a\u6d77\u7533\u82b1\n\u4e0a\u6d77\u4e0a\u6e2f\n\u6771\u65b9(\u9999\u6e2f)\n\u30ac\u30f3\u30d0\u5927\u962a\n\n\n\n\n\u30b0\u30eb\u30fc\u30d7\u30ea\u30fc\u30b0\u7d42\u4e86\u5f8c\u306e\u9806\u4f4d\u4e88\u60f3\n\u5404\u30c1\u30fc\u30e0\u306e\u52dd\u3061\u70b9\u306e\u671f\u5f85\u5024\u3092\u8a08\u7b97\u3057\u3001\u9806\u4f4d\u3092\u4e88\u60f3\u3057\u307e\u3059\u3002\n\n\u30b0\u30eb\u30fc\u30d7E\n> Ranking.fun(Data_2017,group_E)\n         \u30c1\u30fc\u30e0\u3000\u3000\u3000\u3000\u3000\u3000\u52dd\u3061\u70b9\n1 \u9e7f\u5cf6\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30009.8141\n2 \u4e0a\u6d77\u7533\u82b1\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30009.5510\n3 \u851a\u5c71\u73fe\u4ee3\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.5218\n4 \u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\u30004.7901\n\n\n\u30b0\u30eb\u30fc\u30d7F\n> Ranking.fun(Data_2017, group_F)\n        \u30c1\u30fc\u30e0\u3000\u3000\u3000\u3000\u3000\u3000\u52dd\u3061\u70b9\n1  \u6d66\u548c\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.7858\n2\u3000FC\u30bd\u30a6\u30eb\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.5550\n3\u3000\u4e0a\u6d77\u4e0a\u6e2f\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.3554\n4\u3000\u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc\u3000\u30007.2954\n\n\n\u30b0\u30eb\u30fc\u30d7G\n> Ranking.fun(Data_2017, group_G)\n    \u30c1\u30fc\u30e0\u3000\u3000\u52dd\u3061\u70b9\n1\u3000\u5e83\u5dde\u6052\u5927\u300011.4519\n2\u3000\u5ddd\u5d0eF\u3000\u3000 10.0585\n3\u3000\u6c34\u539f\u4e09\u661f\u30008.5201\n4\u3000\u6771\u65b9\u3000\u3000\u30003.0354\n\n\n\u30b0\u30eb\u30fc\u30d7H\n> Ranking.fun(Data_2017, group_H)\n          \u30c1\u30fc\u30e0\u3000\u3000\u3000\u3000\u3000\u3000\u52dd\u3061\u70b9\n1 \u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\u3000\u3000\u3000\u3000\u30008.6648\n2 \u6c5f\u8607\u8607\u5be7\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.4919\n3 \u30a2\u30c7\u30ec\u30fc\u30c9\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\u30008.3848\n4\u3000G\u5927\u962a\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30007.5421\n\n\n\u30b3\u30e1\u30f3\u30c8\n\u30b0\u30eb\u30fc\u30d7E\u306f\u3001\u9e7f\u5cf6\u3001\u4e0a\u6d77\u7533\u82b1\u304c\u7a81\u7834\u3059\u308b\n\u30b0\u30eb\u30fc\u30d7G\u306f\u3001\u5e83\u5dde\u3001\u5ddd\u5d0e\u304c\u7a81\u7834\u3059\u308b\n\u30b0\u30eb\u30fc\u30d7F\u3001H\u306f\u63a5\u6226\u306b\u306a\u308a\u305d\u3046\n\ncode\n\ncode.r\nsetwd(\"C:/R\")\nData_2017 <- read.table( \"ACL2017.csv\", header = TRUE, sep=\",\")\n\ngroup_E <- c(\"\u851a\u5c71\u73fe\u4ee3\", \"\u9e7f\u5cf6\", \"\u4e0a\u6d77\u7533\u82b1\", \"\u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\")\ngroup_F <- c(\"FC\u30bd\u30a6\u30eb\", \"\u6d66\u548c\", \"\u4e0a\u6d77\u4e0a\u6e2f\", \"\u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc\")\ngroup_G <- c(\"\u6c34\u539f\u4e09\u661f\", \"\u5ddd\u5d0eF\", \"\u5e83\u5dde\u6052\u5927\", \"\u6771\u65b9\")\ngroup_H <- c(\"\u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\", \"G\u5927\u962a\", \"\u6c5f\u8607\u8607\u5be7\", \"\u30a2\u30c7\u30ec\u30fc\u30c9\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\")\n\nRanking.fun <- function(Data, group) {\n  n <- 90\n  # 1\u8a66\u5408\u306f90\u5206\u9593\u3068\u4eee\u5b9a\u3059\u308b\n  combination <- combn(4,2)\n  combination <- rbind(t(combination),cbind(combination[2,],combination[1,]))\n  con <- c(1,8,9,16,17)\n  # \u5143\u30c7\u30fc\u30bf\u306b\u3088\u308b\n  data <- rbind(Data[Data[,1] == group[1], con], \n                Data[Data[,1] == group[2], con],\n                Data[Data[,1] == group[3], con], \n                Data[Data[,1] == group[4], con])\n  comb.fun <- function(x) {\n    p_home <- (data[x[1], 2] + data[x[2], 5])/2/n\n    p_away <- (data[x[1], 3] + data[x[2], 4])/2/n\n    c(p_home, p_away)\n  }\n  prob <- t(apply(combination,1,comb.fun))\n  prob[combination[,1] == 1, 2] <- prob[combination[,1] == 1, 2]*0.8\n  if(group[4] == \"\u6771\u65b9\") {\n    prob[combination[,1] == 4, 1] <- prob[combination[,1] == 4, 1] * 0.4\n    prob[combination[,2] == 4, 2] <- prob[combination[,2] == 4, 2] * 0.4\n  }\n  if(group[4] == \"\u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\") {\n    prob[combination[,1] == 4, 1] <- prob[combination[,1] == 4, 1] * 0.6\n    prob[combination[,2] == 4, 2] <- prob[combination[,2] == 4, 2] * 0.6\n  }\n\n  Fun <- function(x){\n    k <- 10\n    prob_matrix <- matrix(0,k,4)\n    colnames(prob_matrix) <- c(\"goals\",\"W\",\"D\",\"L\")\n    prob_matrix[,1] <- c(1:10)-1\n\n    fun <- function(y){\n      c(dbinom(y[1],n,x[1]),dbinom(y[1],n,x[2]))\n    }\n\n    kv <- apply(prob_matrix,1,fun)\n\n    for (i in 2:(k-1)){\n      prob_matrix[i,\"D\"] <- kv[1,i]*kv[2,i]\n      prob_matrix[i,\"W\"] <- kv[1,i]*sum(kv[2,(1:(i-1))])\n      prob_matrix[i,\"L\"] <- kv[1,i]*sum(kv[2,((i+1):k)])\n    }\n\n    prob_matrix[1,\"D\"] <- kv[1,1]*kv[2,1]\n    prob_matrix[1,\"L\"] <- kv[1,1]*sum(kv[2,2:k])\n    prob_matrix[k,\"D\"] <- kv[1,k]*kv[2,k]\n    prob_matrix[k,\"W\"] <- kv[1,k]*sum(kv[2,1:(k-1)])\n\n    apply(prob_matrix[,c(\"W\",\"D\",\"L\")],2,sum)\n  }\n\n  prob_result <- t(round(apply(prob,1,Fun),4))\n  point <- rbind(cbind(combination[,1], prob_result %*% as.matrix(c(3,1,0))),\n                 cbind(combination[,2], prob_result %*% as.matrix(c(0,1,3))))\n  ranking.fun <- function(x) {\n    sum(point[point[,1] == x[1],2])\n  }\n\n  ranking <- apply(as.matrix(1:4),1,ranking.fun)\n  group.ranking <- data.frame(data[order(ranking, decreasing = TRUE),1],ranking[order(ranking, decreasing = TRUE)])\n  colnames(group.ranking) <- c(\"\u30c1\u30fc\u30e0\", \"\u52dd\u3061\u70b9\")\n  group.ranking\n}\n\n\n> Data_2017\n                     \u30c1\u30fc\u30e0 \u8a66\u5408\u6570 \u52dd \u5206 \u8ca0 \u5f97\u70b9 \u5931\u70b9 \u5e73\u5747\u5f97\u70b9  \u5e73\u5747\u5931\u70b9 \u8a66\u5408\u6570.1 \u52dd.1 \u5206.1 \u8ca0.1 \u5f97\u70b9.1 \u5931\u70b9.1 \u5e73\u5747\u5f97\u70b9.1 \u5e73\u5747\u5931\u70b9.1\n1                  \u851a\u5c71\u73fe\u4ee3     17  7  3  7   19   23 1.117647 1.3529412       16    6    6    4     19     20  1.1875000  1.2500000\n2          \u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9     16  8  5  3   33   21 2.062500 1.0500000       17    6    2    9     27     29  1.5882353  1.7058824\n3                  FC\u30bd\u30a6\u30eb     16  6  5  5   28   23 1.750000 1.1500000       17   11    1    5     30     20  1.7647059  1.1764706\n4                  \u6c34\u539f\u4e09\u661f     16  4  7  5   26   28 1.625000 1.4000000       17    3    9    5     19     24  1.1176471  1.4117647\n5                      \u9e7f\u5cf6     17 10  0  7   26   15 1.529412 0.8823529       17    8    5    4     27     19  1.5882353  1.1176471\n6                     \u5ddd\u5d0eF     17 11  3  3   36   23 2.117647 1.3529412       17   11    3    3     32     16  1.8823529  0.9411765\n7                      \u6d66\u548c     17 11  3  3   37   16 2.176471 0.9411765       17   12    2    3     24     12  1.4117647  0.7058824\n8                     G\u5927\u962a     17  8  4  5   26   21 1.529412 1.2352941       17    9    3    5     27     21  1.5882353  1.2352941\n9                  \u5e83\u5dde\u6052\u5927     15 10  5  0   31    7 2.066667 0.4666667       15    9    2    4     31     12  2.0666667  0.8000000\n10                 \u6c5f\u8607\u8607\u5be7     15 12  3  0   33   10 2.200000 0.6666667       15    5    3    7     20     23  1.3333333  1.5333333\n11                 \u4e0a\u6d77\u4e0a\u6e2f     15  9  5  1   36   13 2.400000 0.8666667       15    5    5    5     20     19  1.3333333  1.2666667\n12                 \u4e0a\u6d77\u7533\u82b1     15  9  6  0   33   14 2.200000 0.9333333       15    3    6    6     13     17  0.8666667  1.1333333\n13               \u30d6\u30ea\u30b9\u30d9\u30f3     14 11  2  1   34   16 2.428571 1.1428571       13    3    4    6     15     24  1.1538462  1.8461538\n14     \u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc     13  8  2  3   23   17 1.769231 1.3076923       14    6    4    4     21     16  1.5000000  1.1428571\n15 \u30a2\u30c7\u30ec\u30fc\u30c9\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9     13  7  4  2   22   12 1.692308 0.9230769       14    7    3    4     23     16  1.6428571  1.1428571\n16 \u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9     15 12  1  2   40   14 1.333333 1.4000000       15   14    1    1     33     10  0.6600000  1.1333333\n17                     \u6771\u65b9      8  6  1  1   17    6 1.062500 1.1250000        8    6    1    1     18      7  0.6750000  1.4875000\n>\n\n\u30a2\u30b8\u30a2\u30c1\u30e3\u30f3\u30d4\u30aa\u30f3\u30ba\u30ea\u30fc\u30b02017\u304c\u958b\u5e55\u3057\u307e\u3057\u305f\u3002\u7d44\u5408\u305b\u306b\u3088\u3063\u3066\u3001\u6771\u30a2\u30b8\u30a2\u533a\u5404\u30b0\u30eb\u30fc\u30d7\u306e\u9806\u4f4d\u3092\u4e88\u60f3\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n##\u904e\u53bb\u306e\u30c7\u30fc\u30bf\u3068\u5404\u30ea\u30fc\u30b0\u9593\u306e\u6570\u5b57\u306e\u662f\u6b63\n\u4e88\u60f3\u3059\u308b\u524d\u3001\u904e\u53bb3\u5e74\u9593(2014\u5e74\uff5e2016\u5e74)\u306eACL\u6771\u30a2\u30b8\u30a2\u30b0\u30eb\u30fc\u30d7\u4e88\u9078\u306e\u30c7\u30fc\u30bf\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nK\uff1a\u97d3\u56fd\u3000J\uff1a\u65e5\u672c\u3000C\uff1a\u4e2d\u56fd\u3000A\uff1a\u30aa\u30fc\u30b9\u30c8\u30e9\u30ea\u30a2\u3000T\uff1a\u30bf\u30a4\u3000V\uff1a\u30d9\u30c8\u30ca\u30e0\u3000H\uff1a\u9999\u6e2f\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/114190/a2aefc9a-50f5-0534-af9c-1dd207c75e2a.png)\n\n\u3000\u904e\u53bb3\u5e74\u306e\u30c7\u30fc\u30bf\u304b\u3089\u898b\u308c\u3070\u3001K\u30ea\u30fc\u30b0\u306e\u6210\u7e3e\u304c\u629c\u3051\u3066\u3044\u307e\u3059\u3002J\u30ea\u30fc\u30b0\u3001C\u30ea\u30fc\u30b0\u3001A\u30ea\u30fc\u30b0\u306e\u6210\u7e3e\u304c\u307b\u307c\u4e26\u3093\u3067\u3044\u307e\u3059\u3002\u305d\u306e\u3046\u3061\u3001C\u30ea\u30fc\u30b0\u306f\u83ab\u5927\u306a\u8cc7\u91d1\u3092\u6295\u5165\u3059\u308b\u3068\u3068\u3082\u306b\u3001\u6210\u7e3e\u3082\u4e0a\u304c\u3063\u3066\u304d\u3066\u3044\u307e\u3059\u3002\n\n$$\u653b\u6483\u529b(home)\uff1df(\u5e73\u5747\u5f97\u70b9(home),\u76f8\u624b\u306e\u5e73\u5747\u5931\u70b9(away))$$\n\n$$\u653b\u6483\u529b(away)\uff1df(\u5e73\u5747\u5f97\u70b9(away),\u76f8\u624b\u306e\u5e73\u5747\u5931\u70b9(home))$$\n\n$f(\u30fb)$\u95a2\u6570\u306f\u3001\u3053\u3053\u3067\u516c\u958b\u3057\u307e\u305b\u3093\u3002\n\n1\uff0eT\u30ea\u30fc\u30b0\u3068K\u30ea\u30fc\u30b0\u306e\u30c1\u30fc\u30e0\u304c\u6bd4\u8f03\u7684\u306b\u5f31\u3044\u306e\u3067\u3001\u653b\u6483\u529b\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3059\u308b\u3002\nT\u306e\u30c1\u30fc\u30e0\u306f\u3001K\u3001J\u3001C\u3001A\u3068\u5bfe\u6226\u306e\u5834\u5408\u3001T\u306e\u653b\u6483\u529b\u3092\u3000$\u653b\u6483\u529b\uff0a0.6$\u3000\u306b\u4fee\u6b63\u3059\u308b\u3002\nH\u306e\u30c1\u30fc\u30e0\u306f\u3001K\u3001J\u3001C\u3001A\u3068\u5bfe\u6226\u306e\u5834\u5408\u3001H\u306e\u653b\u6483\u529b\u3092\u3000$\u653b\u6483\u529b\uff0a0.4$\u3000\u306b\u4fee\u6b63\u3059\u308b\u3002\n\n2\uff0eK\u30ea\u30fc\u30b0\u306e\u30c1\u30fc\u30e0\u306f\u30db\u30fc\u30e0\u3067\u5e73\u5747\u5931\u70b9\u304c\u4f4e\u3044\u306e\u3067\u3001\u30a2\u30a6\u30a7\u30a4\u30c1\u30fc\u30e0\u306e\u653b\u6483\u529b\u3092\u3000$\u653b\u6483\u529b(away)\uff0a0.8$\u3000\u306b\u4fee\u6b63\u3059\u308b\u3002\n\u3000\n##2017\u5e74\u306e\u7d44\u5408\u305b\n\n|\u30b0\u30eb\u30fc\u30d7E|\u30b0\u30eb\u30fc\u30d7F|\u30b0\u30eb\u30fc\u30d7G|\u30b0\u30eb\u30fc\u30d7H|\n|:-:|:-:|:-:|:-:|\n|\u9e7f\u5cf6\u30a2\u30f3\u30c8\u30e9\u30fc\u30ba|FC\u30bd\u30a6\u30eb|\u5e83\u5dde\u6052\u5927|\u30a2\u30c7\u30ec\u30fc\u30c8\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9|\n|\u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9(\u30bf\u30a4)|\u6d66\u548c\u30ec\u30c3\u30ba|\u6c34\u539f\u4e09\u661f|\u6c5f\u8607\u8607\u5be7|\n|\u30d7\u30ec\u30fc\u30aa\u30d5\u52dd\u8005|\u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc|\u5ddd\u5d0e\u30d5\u30ed\u30f3\u30bf\u30fc\u30ec|\u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9|\n|\u30d7\u30ec\u30fc\u30aa\u30d5\u52dd\u8005|\u30d7\u30ec\u30fc\u30aa\u30d5\u52dd\u8005|\u6771\u65b9(\u9999\u6e2f)|\u30d7\u30ec\u30fc\u30aa\u30d5\u52dd\u8005|\n\n\u4e0a\u6d77\u4e0a\u6e2f\u3001\u851a\u5c71\u73fe\u4ee3\u3001\u30ac\u30f3\u30d0\u5927\u962a\u306e\u52dd\u3061\u4e0a\u304c\u308a\u306e\u53ef\u80fd\u6027\u304c\u975e\u5e38\u306b\u9ad8\u3044\u3067\u3059\u3002\n\u6b8b\u308a\u306e1\u30c1\u30fc\u30e0\u306f\u4e0a\u6d77\u7533\u82b1\u3068\u30d6\u30ea\u30b9\u30d9\u30f3\u30fb\u30ed\u30a2\u306e\u52dd\u8005\u3060\u3051\u3067\u3059\u3002\n\n\u3053\u306e17\u30c1\u30fc\u30e0\u306e\u6628\u30b7\u30fc\u30bc\u30f3\u5404\u6240\u5c5e\u30ea\u30fc\u30b0\u306e\u30c7\u30fc\u30bf\uff08\u662f\u6b63\u6e08\u307f\uff09\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/114190/cb2557de-7582-3362-ed21-2c1b7d658220.png)\n\n##\u30d7\u30ec\u30fc\u30aa\u30d5\n\n|\u30c1\u30fc\u30e0|\u8a66\u5408\u6570|\u52dd|\u5206|\u8ca0|\u5f97\u70b9|\u5931\u70b9|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|\u4e0a\u6d77\u7533\u82b1\uff08home\uff09|15|9|6|0|33|14|\n|\u30d6\u30ea\u30b9\u30d9\u30f3\u30fb\u30ed\u30a2(away)|13|3|4|6|15|24|\n\n\u4e0a\u6d77\u7533\u82b1\u52dd\u3061\u306e\u78ba\u7387\u304c60%\u4ee5\u4e0a\u3068\u306a\u308a\u307e\u3059\u3002\n\n```\n> round(Fun(prob),4)\n     W      D      L \n0.6019 0.2108 0.1872 \n```\n\n\u30d7\u30ec\u30fc\u30aa\u30d5\u3067\u3001\u4e0a\u6d77\u4e0a\u6e2f\u3001\u851a\u5c71\u73fe\u4ee3\u3001\u30ac\u30f3\u30d0\u5927\u962a\u3001\u4e0a\u6d77\u7533\u82b14\u30c1\u30fc\u30e0\u304c\u52dd\u3061\u3042\u304c\u308b\u3068\u4e88\u60f3\u3057\u307e\u3059\u3002\n\n|\u30b0\u30eb\u30fc\u30d7E|\u30b0\u30eb\u30fc\u30d7F|\u30b0\u30eb\u30fc\u30d7G|\u30b0\u30eb\u30fc\u30d7H|\n|:-:|:-:|:-:|:-:|\n|\u9e7f\u5cf6\u30a2\u30f3\u30c8\u30e9\u30fc\u30ba|FC\u30bd\u30a6\u30eb|\u5e83\u5dde\u6052\u5927|\u30a2\u30c7\u30ec\u30fc\u30c9\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9|\n|\u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9(\u30bf\u30a4)|\u6d66\u548c\u30ec\u30c3\u30ba|\u6c34\u539f\u4e09\u661f|\u6c5f\u8607\u8607\u5be7|\n|\u851a\u5c71\u73fe\u4ee3|\u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc|\u5ddd\u5d0e\u30d5\u30ed\u30f3\u30bf\u30fc\u30ec|\u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9|\n|\u4e0a\u6d77\u7533\u82b1|\u4e0a\u6d77\u4e0a\u6e2f|\u6771\u65b9(\u9999\u6e2f)|\u30ac\u30f3\u30d0\u5927\u962a|\n\n\n##\u30b0\u30eb\u30fc\u30d7\u30ea\u30fc\u30b0\u7d42\u4e86\u5f8c\u306e\u9806\u4f4d\u4e88\u60f3\n\u5404\u30c1\u30fc\u30e0\u306e\u52dd\u3061\u70b9\u306e\u671f\u5f85\u5024\u3092\u8a08\u7b97\u3057\u3001\u9806\u4f4d\u3092\u4e88\u60f3\u3057\u307e\u3059\u3002\n###\u30b0\u30eb\u30fc\u30d7E\n```\n> Ranking.fun(Data_2017,group_E)\n         \u30c1\u30fc\u30e0\u3000\u3000\u3000\u3000\u3000\u3000\u52dd\u3061\u70b9\n1 \u9e7f\u5cf6\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30009.8141\n2 \u4e0a\u6d77\u7533\u82b1\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30009.5510\n3 \u851a\u5c71\u73fe\u4ee3\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.5218\n4 \u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\u30004.7901\n```\n###\u30b0\u30eb\u30fc\u30d7F\n```\n> Ranking.fun(Data_2017, group_F)\n        \u30c1\u30fc\u30e0\u3000\u3000\u3000\u3000\u3000\u3000\u52dd\u3061\u70b9\n1  \u6d66\u548c\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.7858\n2\u3000FC\u30bd\u30a6\u30eb\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.5550\n3\u3000\u4e0a\u6d77\u4e0a\u6e2f\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.3554\n4\u3000\u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc\u3000\u30007.2954\n```\n###\u30b0\u30eb\u30fc\u30d7G\n```\n> Ranking.fun(Data_2017, group_G)\n    \u30c1\u30fc\u30e0\u3000\u3000\u52dd\u3061\u70b9\n1\u3000\u5e83\u5dde\u6052\u5927\u300011.4519\n2\u3000\u5ddd\u5d0eF\u3000\u3000 10.0585\n3\u3000\u6c34\u539f\u4e09\u661f\u30008.5201\n4\u3000\u6771\u65b9\u3000\u3000\u30003.0354\n```\n###\u30b0\u30eb\u30fc\u30d7H\n```\n> Ranking.fun(Data_2017, group_H)\n          \u30c1\u30fc\u30e0\u3000\u3000\u3000\u3000\u3000\u3000\u52dd\u3061\u70b9\n1 \u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\u3000\u3000\u3000\u3000\u30008.6648\n2 \u6c5f\u8607\u8607\u5be7\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30008.4919\n3 \u30a2\u30c7\u30ec\u30fc\u30c9\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\u30008.3848\n4\u3000G\u5927\u962a\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30007.5421\n```\n##\u30b3\u30e1\u30f3\u30c8\n\u30b0\u30eb\u30fc\u30d7E\u306f\u3001\u9e7f\u5cf6\u3001\u4e0a\u6d77\u7533\u82b1\u304c\u7a81\u7834\u3059\u308b\n\u30b0\u30eb\u30fc\u30d7G\u306f\u3001\u5e83\u5dde\u3001\u5ddd\u5d0e\u304c\u7a81\u7834\u3059\u308b\n\u30b0\u30eb\u30fc\u30d7F\u3001H\u306f\u63a5\u6226\u306b\u306a\u308a\u305d\u3046\n\n##code\n```code.r\nsetwd(\"C:/R\")\nData_2017 <- read.table( \"ACL2017.csv\", header = TRUE, sep=\",\")\n\ngroup_E <- c(\"\u851a\u5c71\u73fe\u4ee3\", \"\u9e7f\u5cf6\", \"\u4e0a\u6d77\u7533\u82b1\", \"\u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\")\ngroup_F <- c(\"FC\u30bd\u30a6\u30eb\", \"\u6d66\u548c\", \"\u4e0a\u6d77\u4e0a\u6e2f\", \"\u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc\")\ngroup_G <- c(\"\u6c34\u539f\u4e09\u661f\", \"\u5ddd\u5d0eF\", \"\u5e83\u5dde\u6052\u5927\", \"\u6771\u65b9\")\ngroup_H <- c(\"\u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\", \"G\u5927\u962a\", \"\u6c5f\u8607\u8607\u5be7\", \"\u30a2\u30c7\u30ec\u30fc\u30c9\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\")\n\nRanking.fun <- function(Data, group) {\n  n <- 90\n  # 1\u8a66\u5408\u306f90\u5206\u9593\u3068\u4eee\u5b9a\u3059\u308b\n  combination <- combn(4,2)\n  combination <- rbind(t(combination),cbind(combination[2,],combination[1,]))\n  con <- c(1,8,9,16,17)\n  # \u5143\u30c7\u30fc\u30bf\u306b\u3088\u308b\n  data <- rbind(Data[Data[,1] == group[1], con], \n                Data[Data[,1] == group[2], con],\n                Data[Data[,1] == group[3], con], \n                Data[Data[,1] == group[4], con])\n  comb.fun <- function(x) {\n    p_home <- (data[x[1], 2] + data[x[2], 5])/2/n\n    p_away <- (data[x[1], 3] + data[x[2], 4])/2/n\n    c(p_home, p_away)\n  }\n  prob <- t(apply(combination,1,comb.fun))\n  prob[combination[,1] == 1, 2] <- prob[combination[,1] == 1, 2]*0.8\n  if(group[4] == \"\u6771\u65b9\") {\n    prob[combination[,1] == 4, 1] <- prob[combination[,1] == 4, 1] * 0.4\n    prob[combination[,2] == 4, 2] <- prob[combination[,2] == 4, 2] * 0.4\n  }\n  if(group[4] == \"\u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9\") {\n    prob[combination[,1] == 4, 1] <- prob[combination[,1] == 4, 1] * 0.6\n    prob[combination[,2] == 4, 2] <- prob[combination[,2] == 4, 2] * 0.6\n  }\n\n  Fun <- function(x){\n    k <- 10\n    prob_matrix <- matrix(0,k,4)\n    colnames(prob_matrix) <- c(\"goals\",\"W\",\"D\",\"L\")\n    prob_matrix[,1] <- c(1:10)-1\n    \n    fun <- function(y){\n      c(dbinom(y[1],n,x[1]),dbinom(y[1],n,x[2]))\n    }\n    \n    kv <- apply(prob_matrix,1,fun)\n    \n    for (i in 2:(k-1)){\n      prob_matrix[i,\"D\"] <- kv[1,i]*kv[2,i]\n      prob_matrix[i,\"W\"] <- kv[1,i]*sum(kv[2,(1:(i-1))])\n      prob_matrix[i,\"L\"] <- kv[1,i]*sum(kv[2,((i+1):k)])\n    }\n    \n    prob_matrix[1,\"D\"] <- kv[1,1]*kv[2,1]\n    prob_matrix[1,\"L\"] <- kv[1,1]*sum(kv[2,2:k])\n    prob_matrix[k,\"D\"] <- kv[1,k]*kv[2,k]\n    prob_matrix[k,\"W\"] <- kv[1,k]*sum(kv[2,1:(k-1)])\n    \n    apply(prob_matrix[,c(\"W\",\"D\",\"L\")],2,sum)\n  }\n  \n  prob_result <- t(round(apply(prob,1,Fun),4))\n  point <- rbind(cbind(combination[,1], prob_result %*% as.matrix(c(3,1,0))),\n                 cbind(combination[,2], prob_result %*% as.matrix(c(0,1,3))))\n  ranking.fun <- function(x) {\n    sum(point[point[,1] == x[1],2])\n  }\n  \n  ranking <- apply(as.matrix(1:4),1,ranking.fun)\n  group.ranking <- data.frame(data[order(ranking, decreasing = TRUE),1],ranking[order(ranking, decreasing = TRUE)])\n  colnames(group.ranking) <- c(\"\u30c1\u30fc\u30e0\", \"\u52dd\u3061\u70b9\")\n  group.ranking\n}\n```\n\n```\n> Data_2017\n                     \u30c1\u30fc\u30e0 \u8a66\u5408\u6570 \u52dd \u5206 \u8ca0 \u5f97\u70b9 \u5931\u70b9 \u5e73\u5747\u5f97\u70b9  \u5e73\u5747\u5931\u70b9 \u8a66\u5408\u6570.1 \u52dd.1 \u5206.1 \u8ca0.1 \u5f97\u70b9.1 \u5931\u70b9.1 \u5e73\u5747\u5f97\u70b9.1 \u5e73\u5747\u5931\u70b9.1\n1                  \u851a\u5c71\u73fe\u4ee3     17  7  3  7   19   23 1.117647 1.3529412       16    6    6    4     19     20  1.1875000  1.2500000\n2          \u6e08\u5dde\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9     16  8  5  3   33   21 2.062500 1.0500000       17    6    2    9     27     29  1.5882353  1.7058824\n3                  FC\u30bd\u30a6\u30eb     16  6  5  5   28   23 1.750000 1.1500000       17   11    1    5     30     20  1.7647059  1.1764706\n4                  \u6c34\u539f\u4e09\u661f     16  4  7  5   26   28 1.625000 1.4000000       17    3    9    5     19     24  1.1176471  1.4117647\n5                      \u9e7f\u5cf6     17 10  0  7   26   15 1.529412 0.8823529       17    8    5    4     27     19  1.5882353  1.1176471\n6                     \u5ddd\u5d0eF     17 11  3  3   36   23 2.117647 1.3529412       17   11    3    3     32     16  1.8823529  0.9411765\n7                      \u6d66\u548c     17 11  3  3   37   16 2.176471 0.9411765       17   12    2    3     24     12  1.4117647  0.7058824\n8                     G\u5927\u962a     17  8  4  5   26   21 1.529412 1.2352941       17    9    3    5     27     21  1.5882353  1.2352941\n9                  \u5e83\u5dde\u6052\u5927     15 10  5  0   31    7 2.066667 0.4666667       15    9    2    4     31     12  2.0666667  0.8000000\n10                 \u6c5f\u8607\u8607\u5be7     15 12  3  0   33   10 2.200000 0.6666667       15    5    3    7     20     23  1.3333333  1.5333333\n11                 \u4e0a\u6d77\u4e0a\u6e2f     15  9  5  1   36   13 2.400000 0.8666667       15    5    5    5     20     19  1.3333333  1.2666667\n12                 \u4e0a\u6d77\u7533\u82b1     15  9  6  0   33   14 2.200000 0.9333333       15    3    6    6     13     17  0.8666667  1.1333333\n13               \u30d6\u30ea\u30b9\u30d9\u30f3     14 11  2  1   34   16 2.428571 1.1428571       13    3    4    6     15     24  1.1538462  1.8461538\n14     \u30a6\u30a7\u30b9\u30bf\u30f3\u30fb\u30b7\u30c9\u30cb\u30fc     13  8  2  3   23   17 1.769231 1.3076923       14    6    4    4     21     16  1.5000000  1.1428571\n15 \u30a2\u30c7\u30ec\u30fc\u30c9\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9     13  7  4  2   22   12 1.692308 0.9230769       14    7    3    4     23     16  1.6428571  1.1428571\n16 \u30e0\u30a2\u30f3\u30c8\u30f3\u30fb\u30e6\u30ca\u30a4\u30c6\u30c3\u30c9     15 12  1  2   40   14 1.333333 1.4000000       15   14    1    1     33     10  0.6600000  1.1333333\n17                     \u6771\u65b9      8  6  1  1   17    6 1.062500 1.1250000        8    6    1    1     18      7  0.6750000  1.4875000\n>\n```\n"}