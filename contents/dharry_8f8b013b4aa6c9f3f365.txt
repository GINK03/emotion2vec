{"tags": ["Lua"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\u3042\u3051\u307e\u3057\u3066\u304a\u3081\u3067\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n\u6bce\u5e74\u3001\u9069\u5f53\u306a\u8a00\u8a9e\u3092\u9078\u3093\u3067\u3001\u3042\u3051\u307e\u3057\u3066\u304a\u3081\u3067\u3068\u3046\u30e1\u30fc\u30eb\u3092\u9001\u3063\u3066\u3044\u307e\u3059\u3002\n\u4eca\u5e74\u306f\u3001Lua\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u74b0\u5883\n\nCentOS Linux release 7.1.1503 (Core) x86_64\nlua-5.1.4-14.el7.x86_64\nlua-socket-3.0-0.10.rc1.el7.x86_64\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install lua lua-socket\n\n\n\u30b3\u30fc\u30c9\n\nlocal socket = require 'socket'\nlocal smtp = require 'socket.smtp'\n\nMail = {}\nfunction Mail:send(name, to)\n   local mesgt = {\n       headers = {\n            to = to,\n            subject = \"I wish you a Happy new year 2016!\",\n            [\"Content-Type\"] = 'text/plain; charset=\"utf-8\"'\n       },\n       body = string.format(\"%s\\n\\n%s\", name, self.body)\n   }\n\n   local ok, err = smtp.send {\n       from = self.from,\n       rcpt = to,\n       source = smtp.message(mesgt),\n       user = self.user,\n       password = self.password,\n       server = self.server,\n       port = self.port\n   }\n   return ok, err\nend\n\nfunction Mail.new(server, user, password, port)\n   local obj = {\n     server = server,\n     user = user,\n     password = password,\n     port = port\n   }\n   return setmetatable(obj, {__index = Mail})\nend\n\nm = Mail.new(\"smtp.example.com\", \"username\", \"password\", 587)\nm.from = \"dharry@example.com\"\n\nemails = {\n  {\"bressler\", \"bressler@example.com\"},\n  {\"scorpio\", \"scorpio@example.com\"},\n  {\"chico\", \"chico@example.com\"},\n}\n\nm.body = [[\n2016\u5e7401\u670801\u65e5\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3042\u3051\u307e\u3057\u3066\u304a\u3081\u3067\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n]]\n\nfor key, val in pairs(emails) do\n  name = val[1]..\"\u3055\u3093\"\n  email  = val[2]\n  print(email)\n  print(name)\n  ok, err = m:send(name, email)\nend\n\n\u3042\u3051\u307e\u3057\u3066\u304a\u3081\u3067\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n\u6bce\u5e74\u3001\u9069\u5f53\u306a\u8a00\u8a9e\u3092\u9078\u3093\u3067\u3001\u3042\u3051\u307e\u3057\u3066\u304a\u3081\u3067\u3068\u3046\u30e1\u30fc\u30eb\u3092\u9001\u3063\u3066\u3044\u307e\u3059\u3002\n\u4eca\u5e74\u306f\u3001Lua\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## \u74b0\u5883\n\n* CentOS Linux release 7.1.1503 (Core) x86_64\n* lua-5.1.4-14.el7.x86_64\n* lua-socket-3.0-0.10.rc1.el7.x86_64\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session\n$ sudo yum install lua lua-socket\n```\n\n## \u30b3\u30fc\u30c9\n\n```lua\n\nlocal socket = require 'socket'\nlocal smtp = require 'socket.smtp'\n\nMail = {}\nfunction Mail:send(name, to)\n   local mesgt = {\n       headers = {\n            to = to,\n            subject = \"I wish you a Happy new year 2016!\",\n            [\"Content-Type\"] = 'text/plain; charset=\"utf-8\"'\n       },\n       body = string.format(\"%s\\n\\n%s\", name, self.body)\n   }\n\n   local ok, err = smtp.send {\n       from = self.from,\n       rcpt = to,\n       source = smtp.message(mesgt),\n       user = self.user,\n       password = self.password,\n       server = self.server,\n       port = self.port\n   }\n   return ok, err\nend\n\nfunction Mail.new(server, user, password, port)\n   local obj = {\n     server = server,\n     user = user,\n     password = password,\n     port = port\n   }\n   return setmetatable(obj, {__index = Mail})\nend\n\nm = Mail.new(\"smtp.example.com\", \"username\", \"password\", 587)\nm.from = \"dharry@example.com\"\n\nemails = {\n  {\"bressler\", \"bressler@example.com\"},\n  {\"scorpio\", \"scorpio@example.com\"},\n  {\"chico\", \"chico@example.com\"},\n}\n\nm.body = [[\n2016\u5e7401\u670801\u65e5\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3042\u3051\u307e\u3057\u3066\u304a\u3081\u3067\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n]]\n\nfor key, val in pairs(emails) do\n  name = val[1]..\"\u3055\u3093\"\n  email  = val[2]\n  print(email)\n  print(name)\n  ok, err = m:send(name, email)\nend\n```\n"}