{"tags": ["Linux", "iptables", "nftables"], "context": "iptables\u3067\u4f5c\u3063\u305f\u30d1\u30b1\u30c3\u30c8\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u30eb\u30fc\u30eb\u3092nftables\u306b\u5909\u63db\u3057\u3066\u307f\u305f\u3002\n\u4ee5\u4e0b\u306f\u3088\u304f\u3042\u308b\u5165\u529b\u306f\u7279\u5b9a\u30dd\u30fc\u30c8\u3057\u304b\u53d7\u3051\u4ed8\u3051\u306a\u304f\u3059\u308biptables\u306e\u30b9\u30af\u30ea\u30d7\u30c8\n#!/bin/sh\niptables -F\niptables -P INPUT ACCEPT\niptables -P OUTPUT ACCEPT\n\niptables -A INPUT -i lo -j ACCEPT\niptables -A INPUT -p icmp -j ACCEPT\n\niptables -A INPUT -p tcp -m tcp --dport ssh -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport smtp -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport domain -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport http -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport https -j ACCEPT\niptables -A INPUT -p udp -m udp --dport domain -j ACCEPT\n\niptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\niptables -P INPUT DROP\niptables -P OUTPUT ACCEPT\n\n\u3053\u308c\u3092nftables\u3067\u3084\u308b\u3068\u4ee5\u4e0b\u306b\u3088\u3046\u306b\u306a\u308b\u3002\n#!/usr/sbin/nft -f\nflush table filter\n\ntable filter {\n        chain input {\n                type filter hook input priority 0; policy accept;\n                ct state established accept\n                ct state related accept\n                iif lo accept\n                tcp dport {ssh,smtp,domain,http,https} accept\n                udp dport domain accept\n                ip protocol icmp accept\n                counter drop\n        }\n\n        chain output {\n                type filter hook output priority 0; policy accept;\n        }\n}\n\niptables\u3067\u4f5c\u3063\u305f\u30d1\u30b1\u30c3\u30c8\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u30eb\u30fc\u30eb\u3092nftables\u306b\u5909\u63db\u3057\u3066\u307f\u305f\u3002\n\u4ee5\u4e0b\u306f\u3088\u304f\u3042\u308b\u5165\u529b\u306f\u7279\u5b9a\u30dd\u30fc\u30c8\u3057\u304b\u53d7\u3051\u4ed8\u3051\u306a\u304f\u3059\u308biptables\u306e\u30b9\u30af\u30ea\u30d7\u30c8\n\n```bash\n#!/bin/sh\niptables -F\niptables -P INPUT ACCEPT\niptables -P OUTPUT ACCEPT\n\niptables -A INPUT -i lo -j ACCEPT\niptables -A INPUT -p icmp -j ACCEPT\n\niptables -A INPUT -p tcp -m tcp --dport ssh -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport smtp -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport domain -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport http -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport https -j ACCEPT\niptables -A INPUT -p udp -m udp --dport domain -j ACCEPT\n\niptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\niptables -P INPUT DROP\niptables -P OUTPUT ACCEPT\n```\n\n\u3053\u308c\u3092nftables\u3067\u3084\u308b\u3068\u4ee5\u4e0b\u306b\u3088\u3046\u306b\u306a\u308b\u3002\n\n```bash\n#!/usr/sbin/nft -f\nflush table filter\n\ntable filter {\n        chain input {\n                type filter hook input priority 0; policy accept;\n                ct state established accept\n                ct state related accept\n                iif lo accept\n                tcp dport {ssh,smtp,domain,http,https} accept\n                udp dport domain accept\n                ip protocol icmp accept\n                counter drop\n        }\n\n        chain output {\n                type filter hook output priority 0; policy accept;\n        }\n}\n```\n"}