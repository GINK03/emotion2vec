{"tags": ["Firebase", "JavaScript", "BaaS"], "context": "\n\n1.Firebase\u306e\u5229\u7528\u958b\u59cb\n\u3068\u308a\u3042\u3048\u305a\u3053\u3053\u304b\u3089\u65b0\u898f\u767b\u9332\u3057\u3066\u306d\n\u203bGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u5fc5\u8981\u3060\u3088\nhttps://console.firebase.google.com/\n\n\u65b0\u898f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u305f\u3089\u3001\u300c\u65b0\u898f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u300d\u30dc\u30bf\u30f3\u304b\u3089\n\u65b0\u898f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308d\u3046\n\u203b\u56fd\u306f\u307e\u3041\u3001\u65e5\u672c\u4eba\u306a\u3093\u3067\u65e5\u672c\u9078\u307c\u3046\n\u3053\u308c\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u304d\u305f\u306d\uff01\u65e9\u3044\u306d\uff01\n\n2.\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u3088\u3046\n\nFirebase tools\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3088\u3046\nnpm\u3067Firebase tools\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnpm\u304c\u306a\u3044\u4eba\u306fnode.js\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u306d\u3002\n\ncommand\n\n/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n\nbrew install nodebrew\n\nnodebrew install-binary latest\n\nnpm install -g firebase-tools\n\n\n\n\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u305f\u3081\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u7528\u610f\u3057\u3088\u3046\n\u9069\u5f53\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u3063\u305f\u3089\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u305d\u3053\u306b\u79fb\u52d5\u3057\u3066\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\ncommand\nfirebase login\n\n\n\u305d\u3057\u305f\u3089\u306a\u3093\u304b\u30d6\u30e9\u30a6\u30b6\u304c\u8d77\u52d5\u3059\u308b\u306e\u3067Firebase\u306e\u767b\u9332\u306b\u4f7f\u3063\u305f\nGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\n\u6b21\u306b\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3063\u3066\u304f\u3060\u3055\u3044\n\ncommand\nfirebase init\n\n\n\u8272\u3005\u805e\u304b\u308c\u308b\u306e\u3067\nWhat Firebase CLI features do you want to setup for this folder?\n\u2192\u3053\u308c\u306f\u305d\u306e\u307e\u307eEnter\nProject Setup\n\u2192\u3055\u3063\u304d\u4f5c\u3063\u305fFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u9078\u629e\nDatabase Setup\n\u2192\u3053\u308c\u306f\u305d\u306e\u307e\u307eEnter\nWhat do you want to use as your public directory?\n\u2192\u3053\u308c\u306fy\u3092\u9078\u629e\u3057Enter\nConfigure as a single-page app (rewrite all urls to /index.html)?\n\u2192\u3053\u308c\u3082y\u3092\u9078\u629e\u3057Enter\n\u3053\u308c\u3067\u8272\u3005\u30d5\u30a1\u30a4\u30eb\u304c\u52dd\u624b\u306b\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\uff01\npublic\n\u2514index.html\ndatabase.rules.json\nfirebase.json\npublic\u30d5\u30a9\u30eb\u30c0\u306e\u4e0b\u306b\u4f5c\u3089\u308c\u305findex.html\u3092\u9069\u5f53\u306b\u3044\u3058\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\u3068\u308a\u3042\u3048\u305ah1\u30bf\u30b0\u306e\u4e2d\u8eab\u304b\u3048\u308b\u3068\u304b\u3002\n\u305d\u3057\u3066\u30c7\u30d7\u30ed\u30a4\u30b3\u30de\u30f3\u30c9\u3092\u53e9\u3051\u3070\u3001\u30c7\u30d7\u30ed\u30a4\u5b8c\u4e86\u3067\u3059\u3002\n\ncommand\nfirebase deploy\n\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u53e9\u304f\u3068\u3001\u592a\u5b57\u3067Hosting URL\u3068\u3044\u3046\u9805\u76ee\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u3053\u306eURL\u304c\u4eca\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u30b5\u30a4\u30c8\u306eURL\u306b\u306a\u308a\u307e\u3059\u3002\n\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u3088\u3046\u3002\n\n3.\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u3063\u3066\u307f\u3088\u3046\nConsole\u306e\u300cDatabase\u300d\u3063\u3066\u3068\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u307f\u3088\u3046\u3002\n\u307e\u3060\u4f55\u3082\u306a\u3044\u306d\uff01\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u89e3\u653e\u3057\u308d\uff01\n\u300c\u65e2\u5b9a\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3 \u30eb\u30fc\u30eb\u3067\u306f\u30e6\u30fc\u30b6\u30fc\u306e\u8a8d\u8a3c\u304c\u5fc5\u8981\u3067\u3059\u300d\u3063\u3066\u9752\u6587\u5b57\u304c\u51fa\u3066\u307e\u3059\u3002\n\u3053\u306e\u307e\u307e\u3060\u3068\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u3068\u304b\u3057\u306a\u3044\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u4f7f\u3048\u306a\u3044\u3093\u3067\u3059\u306d\u3002\n\u306a\u306e\u3067\u300c\u30eb\u30fc\u30eb\u300d\u3063\u3066\u30bf\u30d6\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u306d\u3002\n\u305d\u3057\u305f\u3089\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u306b\u306a\u3063\u3066\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u306d\u3002\n\nrule.json\n{\n  \"rules\": {\n    \".read\": \"auth != null\",\n    \".write\": \"auth != null\"\n  }\n}\n\n\n\u3053\u308c\u3092\n\nrule.json\n{\n  \"rules\": {\n    \".read\": true,\n    \".write\": true\n  }\n}\n\n\n\u3053\u3046\u3057\u3061\u3083\u304a\u3046\n\u305d\u3057\u3066\u300c\u516c\u958b\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u305b\u3070\u30fb\u30fb\u30fb\n\u300c\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3 \u30eb\u30fc\u30eb\u304c\u516c\u958b\u5bfe\u8c61\u3068\u3057\u3066\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u8ab0\u3067\u3082\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8aad\u307f\u53d6\u308a\u3084\u66f8\u304d\u8fbc\u307f\u3092\u884c\u3048\u307e\u3059\u300d\n\u307f\u305f\u3044\u306a\u306e\u304c\u8d64\u6587\u5b57\u3067\u51fa\u3066\u304d\u307e\u3057\u305f\u306d\u3002\n\u3053\u308c\u3067\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u306a\u3057\u3067DB\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\uff01\n\u203b\u3053\u3053\u306e\u30eb\u30fc\u30eb\u3068\u300cdatabase.rules.json\u300d\u3067\u5b9a\u7fa9\u3057\u305f\u30eb\u30fc\u30eb\u306f\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30d7\u30ed\u30a4\u6642\u306b\u540c\u671f\u3055\u308c\u307e\u3059\u3002\n\u300cdatabase.rules.json\u300d\u306e\u5185\u5bb9\u3067\u4e0a\u66f8\u304d\u3055\u308c\u308b\u306e\u3067\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u3068\u3044\u3046\u304b\u5b9f\u969b\u306f\u300cdatabase.rules.json\u300d\u3092\u6b63\u3068\u3057\u3066\u958b\u767a\u3059\u308b\u306e\u304c\u6b63\u3057\u3044\u3067\u3059\u306d\u3002\n\n\u30b3\u30fc\u30c9\u3092\u66f8\u3053\u3046\npublic\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306eindex.html\u3092\u4ee5\u4e0b\u306e\u5185\u5bb9\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\u203bjQuery\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\nindex.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Firebase Study</title>\n    <style media=\"screen\">\n    </style>\n  </head>\n  <body>\n    <form id=\"input_form\">\n        <input type=\"text\" id=\"name\" size=\"10\" placeholder=\"Name\" value=\"\u540d\u7121\u3057\">\n        <input type=\"text\" id=\"input_text\" size=\"50\">\n        <button type=\"submit\" id=\"send_btn\">SEND</button>\n        <hr>\n        <div id=\"chat_area\"></div>\n    </form>\n  </body>\n  <script\n    src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\n    integrity=\"sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=\"\n    crossorigin=\"anonymous\"></script>\n  <script src=\"https://www.gstatic.com/firebasejs/3.6.1/firebase.js\"></script>\n  <script>\n    $(function(){\n      // \u2193\u2193\u2193\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      // Initialize Firebase\n      var config = {\n        apiKey: '<your-api-key>',\n        authDomain: '<your-auth-domain>',\n        databaseURL: '<your-database-url>',\n        storageBucket: '<your-storage-bucket>'\n      };\n      // \u2191\u2191\u2191\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      firebase.initializeApp(config);\n\n      // submit\u6642\n      $(\"#input_form\").submit(function(){\n          writeChatData($(\"#name\").val(), $(\"#input_text\").val());\n          return false;\n      });\n\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text\n        });\n      }\n\n      // \u767a\u8a00\u3092\u8868\u793a\n      firebase.database().ref(\"chat\").on(\"value\", function(snapshot) {\n          $(\"#chat_area\").html(\"\");\n\n          var logs = snapshot.val();\n          for (var key in logs) {\n              var logHtml = '<p>' + logs[key].name + '\uff1a' + logs[key].text + '</p><hr>'\n              $(\"#chat_area\").prepend(logHtml);\n          }\n      });\n\n    });\n\n  </script>\n</html>\n\n\nconfig\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3092\u958b\u304d\u3001\u30c8\u30c3\u30d7\u306e\u53f3\u5074\u306b\u3042\u308b\u300c\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u306bFirebase\u3092\u8ffd\u52a0\u300d\u306e\u30a2\u30a4\u30b3\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u3001\u305d\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306econfig\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u5b9f\u884c\u3057\u3088\u3046\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u3001\u30ed\u30fc\u30ab\u30eb\u3067\u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3057\u307e\u3059\u3002\n\ncommand\nfirebase serve\n\n\nlocalhost:5000\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u4f5c\u6210\u3057\u305f\u30c1\u30e3\u30c3\u30c8\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n4.\u8a8d\u8a3c\u6a5f\u80fd\u3092\u4f7f\u304a\u3046\n\n\u307e\u305a\u306f\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3067Authentication\u306e\u8a2d\u5b9a\n\u300cAuthentication\u300d\u30e1\u30cb\u30e5\u30fc\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u300c\u30ed\u30b0\u30a4\u30f3\u65b9\u6cd5\u300d\u30bf\u30d6\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u300c\u30e1\u30fc\u30eb\uff0f\u30d1\u30b9\u30ef\u30fc\u30c9\u300d\u304c\u7121\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\n\u6709\u52b9\u306b\u3057\u3066\u4fdd\u5b58\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30b3\u30fc\u30c9\u3092\u5909\u66f4\n\nindex.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Firebase Study</title>\n    <style media=\"screen\">\n    \u3000/** \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 */\n      body {\n        margin: 0;\n        padding: 0;\n      }\n      header {\n        background: #f99;\n        padding: 10px;\n        text-align: right;\n      }\n      #input_form {\n        padding: 10px;\n      }\n    \u3000/** \u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191 */\n    </style>\n  </head>\n  <body>\n    <!-- \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 -->\n    <header>\n      <div id=\"login_info\">\n        <input type=\"email\" id=\"email\" placeholder=\"email\">\n        <input type=\"password\" id=\"password\" placeholder=\"password\">\n        <button id=\"login_btn\">\u30ed\u30b0\u30a4\u30f3</button>\n        <button id=\"user_regist_btn\">\u65b0\u898f\u767b\u9332</button>\n      </div>\n      <div id=\"logout_info\" style=\"display: none;\">\n        <button id=\"logout_btn\">\u30ed\u30b0\u30a2\u30a6\u30c8</button>\n      </div>\n    </header>\n    <!-- \u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191 -->\n    <form id=\"input_form\">\n        <input type=\"text\" id=\"name\" size=\"10\" placeholder=\"Name\" value=\"\u540d\u7121\u3057\">\n        <input type=\"text\" id=\"input_text\" size=\"50\">\n        <button type=\"submit\" id=\"send_btn\">SEND</button>\n        <hr>\n        <div id=\"chat_area\"></div>\n    </form>\n  </body>\n  <script\n    src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\n    integrity=\"sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=\"\n    crossorigin=\"anonymous\"></script>\n  <script src=\"https://www.gstatic.com/firebasejs/3.6.1/firebase.js\"></script>\n  <script>\n    $(function(){\n      // \u2193\u2193\u2193\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      // Initialize Firebase\n      var config = {\n        apiKey: '<your-api-key>',\n        authDomain: '<your-auth-domain>',\n        databaseURL: '<your-database-url>',\n        storageBucket: '<your-storage-bucket>'\n      };\n      // \u2191\u2191\u2191\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      firebase.initializeApp(config);\n\n      // submit\u6642\n      $(\"#input_form\").submit(function(){\n          writeChatData($(\"#name\").val(), $(\"#input_text\").val());\n          return false;\n      });\n\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text\n        });\n      }\n\n      // \u767a\u8a00\u3092\u8868\u793a\n      firebase.database().ref(\"chat\").on(\"value\", function(snapshot) {\n          $(\"#chat_area\").html(\"\");\n\n          var logs = snapshot.val();\n          for (var key in logs) {\n              var logHtml = '<p>' + logs[key].name + '\uff1a' + logs[key].text + '</p><hr>'\n              $(\"#chat_area\").prepend(logHtml);\n          }\n      });\n\n      //\u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193\n      firebase.auth().onAuthStateChanged(function(user) {\n        if (user) {\n          $(\"#login_info\").hide();\n          $(\"#logout_info\").show();\n          if (user.displayName) {\n            $(\"#name\").val(user.displayName);\n          }\n        } else {\n          $(\"#logout_info\").hide();\n          $(\"#login_info\").show();\n          $(\"#name\").val(\"\");\n        }\n      });\n\n      // \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n      $(\"#user_regist_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a4\u30f3\n      $(\"#login_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a2\u30a6\u30c8\n      $(\"#logout_btn\").click(function(){\n        firebase.auth().signOut().then(function() {\n          // Sign-out successful.\n        }, function(error) {\n          // An error happened.\n        });\n      });\n\n      // \u540d\u524d\u304c\u5909\u66f4\u3055\u308c\u305f\u3089\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u5909\u66f4\n      $(\"#name\").change(function(){\n        var user = firebase.auth().currentUser;\n        if (user) {\n          user.updateProfile({\n            displayName: $(\"#name\").val()\n          });\n        }\n      });\n\n      //\u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191\n\n    });\n\n  </script>\n</html>\n\n\n\nGoogle\u3084Facebook\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u8a8d\u8a3c\u3057\u305f\u3044\n\u3053\u3053\u307e\u3067\u308f\u304b\u308c\u3070\u3042\u3068\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u898b\u308c\u3070\u5927\u4e08\u592b\nhttps://firebase.google.com/docs/auth/web/google-signin\nhttps://firebase.google.com/docs/auth/web/facebook-login\n\n5.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u3088\u3046\n\u305b\u3063\u304b\u304f\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u4f5c\u3063\u305f\u3051\u3069\u3001\u8ab0\u3067\u3082\u66f8\u304d\u8fbc\u3081\u308b\u3057\u3042\u3093\u307e\u610f\u5473\u306a\u3044\u3088\u306d\u3002\n\u306a\u306e\u3067\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u307f\u307e\u3057\u3087\u3046\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u306a\u3044\u3068\u66f8\u304d\u8fbc\u307f\u7981\u6b62\u306b\u3059\u308b\ndatabase.rules.json\u3092\u3044\u3058\u308d\u3046\n\ndatabase.rules.json\n{\n  \"rules\": {\n    \".read\": true,\n    \".write\": \"auth != null\"\n  }\n}\n\n\n\u30a8\u30e9\u30fc\u3092\u308f\u304b\u308a\u3084\u3059\u304f\u3059\u308b\u305f\u3081index.html\u3082\u3061\u3087\u3053\u3063\u3068\u3060\u3051\u3044\u3058\u308b\n\u203b\u767a\u8a00\u3092\u767b\u9332\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306bcatch\u306e\u90e8\u5206\u3092\u8ffd\u52a0\n\nindex.html\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text\n        }).catch(function(error) {\n          alert(error.message);\n        });\n      }\n\n\n\u305d\u3057\u305f\u3089\u30c7\u30d7\u30ed\u30a4\n\ncommand\nfirebase deploy\n\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u3044\u3068\u66f8\u304d\u8fbc\u3081\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u306d\n\n\u3082\u3063\u3068\u96e3\u3057\u3044\u30eb\u30fc\u30eb\u3092\n\u81ea\u5206\u306e\u767a\u8a00\u3060\u3051\u3092\u5909\u66f4\u53ef\u80fd\u306b\u3059\u308b\n\ndatabase.rules.json\n{\n  \"rules\": {\n    \"chat\": {\n      \".read\": true,\n      \"$message\": {\n        \".write\": \"data.child('user_id').val() == auth.uid || !data.exists()\"\n      }\n    }\n  }\n}\n\n\ndata\u306f\u5909\u66f4\u524d\u306e\u30c7\u30fc\u30bf\u3092\u8868\u3057\u307e\u3059\u3002\nauth\u306f\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u30fc\u306e\u60c5\u5831\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n$message\u306fchat\u8981\u7d20\u306e\u5b50\u4f9b\u306e\u8981\u7d20\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n$\u306b\u3064\u3065\u304f\u540d\u524d\u306f\u306a\u3093\u3067\u3082\u3044\u3044\u3067\u3059\u3002\n\nindex.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Firebase Study</title>\n    <style media=\"screen\">\n    \u3000/** \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 */\n      body {\n        margin: 0;\n        padding: 0;\n      }\n      header {\n        background: #f99;\n        padding: 10px;\n        text-align: right;\n      }\n      #input_form {\n        padding: 10px;\n      }\n    </style>\n  </head>\n  <body>\n    <!-- \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 -->\n    <header>\n      <div id=\"login_info\">\n        <input type=\"email\" id=\"email\" placeholder=\"email\">\n        <input type=\"password\" id=\"password\" placeholder=\"password\">\n        <button id=\"login_btn\">\u30ed\u30b0\u30a4\u30f3</button>\n        <button id=\"user_regist_btn\">\u65b0\u898f\u767b\u9332</button>\n      </div>\n      <div id=\"logout_info\" style=\"display: none;\">\n        <button id=\"logout_btn\">\u30ed\u30b0\u30a2\u30a6\u30c8</button>\n      </div>\n    </header>\n    <!-- \u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191 -->\n    <form id=\"input_form\">\n        <input type=\"text\" id=\"name\" size=\"10\" placeholder=\"Name\" value=\"\u540d\u7121\u3057\">\n        <input type=\"text\" id=\"input_text\" size=\"50\">\n        <button type=\"submit\" id=\"send_btn\">SEND</button>\n        <hr>\n        <div id=\"chat_area\"></div>\n    </form>\n  </body>\n  <script\n    src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\n    integrity=\"sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=\"\n    crossorigin=\"anonymous\"></script>\n  <script src=\"https://www.gstatic.com/firebasejs/3.6.1/firebase.js\"></script>\n  <script>\n    $(function(){\n      // \u2193\u2193\u2193\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      // Initialize Firebase\n      var config = {\n        apiKey: '<your-api-key>',\n        authDomain: '<your-auth-domain>',\n        databaseURL: '<your-database-url>',\n        storageBucket: '<your-storage-bucket>'\n      };\n      // \u2191\u2191\u2191\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      firebase.initializeApp(config);\n\n      var userId = \"\";\n\n      // submit\u6642\n      $(\"#input_form\").submit(function(){\n          writeChatData($(\"#name\").val(), $(\"#input_text\").val());\n          return false;\n      });\n\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text,\n          user_id: userId   // \u21905.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\n        }).catch(function(error) {\n          alert(error.message);\n        });\n      }\n\n      //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n      // \u767a\u8a00\u3092\u66f4\u65b0\n      function updateChatData(key, text) {\n        firebase.database().ref('chat/' + key + '/text').set(text).catch(function(error) {\n          alert(error.message);\n        });\n      }\n      //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n      // \u767a\u8a00\u3092\u8868\u793a\n      firebase.database().ref(\"chat\").on(\"value\", function(snapshot) {\n          $(\"#chat_area\").html(\"\");\n\n          var logs = snapshot.val();\n          for (var key in logs) {\n              var logHtml = '';\n              //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n              if (logs[key].user_id == userId) {\n                logHtml = '<p>' + logs[key].name + '\uff1a<input type=\"text\" class=\"update_text\" size=\"50\" value=\"' + logs[key].text + '\" data-key=\"' + key + '\"/></p><hr>'\n              } else {\n                logHtml = '<p>' + logs[key].name + '\uff1a' + logs[key].text + '</p><hr>'\n              }\n              //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n              $(\"#chat_area\").prepend(logHtml);\n          }\n\n          //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n          $(\".update_text\").off(\"change\");\n          $(\".update_text\").on(\"change\", function(){\n            var key = $(this).attr(\"data-key\");\n            var text = $(this).val();\n            updateChatData(key, text);\n          });\n          //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n      });\n\n      //\u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193\n      firebase.auth().onAuthStateChanged(function(user) {\n        if (user) {\n          $(\"#login_info\").hide();\n          $(\"#logout_info\").show();\n          if (user.displayName) {\n            $(\"#name\").val(user.displayName);\n          }\n          userId = user.uid;\n        } else {\n          $(\"#logout_info\").hide();\n          $(\"#login_info\").show();\n          $(\"#name\").val(\"\");\n        }\n      });\n\n      // \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n      $(\"#user_regist_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a4\u30f3\n      $(\"#login_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a2\u30a6\u30c8\n      $(\"#logout_btn\").click(function(){\n        firebase.auth().signOut().then(function() {\n          // Sign-out successful.\n        }, function(error) {\n          // An error happened.\n        });\n      });\n\n      // \u540d\u524d\u304c\u5909\u66f4\u3055\u308c\u305f\u3089\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u5909\u66f4\n      $(\"#name\").change(function(){\n        var user = firebase.auth().currentUser;\n        if (user) {\n          user.updateProfile({\n            displayName: $(\"#name\").val()\n          });\n        }\n      });\n\n      //\u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191\n\n    });\n\n  </script>\n</html>\n\n\n\n6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u4f7f\u304a\u3046\nFirebase\u304b\u3089GCP\u306eGoogle Cloud Storage\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u3093\u306a\u611f\u3058\u3067\u66f8\u3051\u3070\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\n\nupload\nvar storageRef = firebase.storage().ref();\nvar uploadTask = storageRef.child('images/' + userId + '/' + file.name).put(file);\n\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u306e\u30a2\u30a4\u30b3\u30f3\u753b\u50cf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\n\u767a\u8a00\u3068\u4e00\u7dd2\u306b\u30a2\u30a4\u30b3\u30f3\u3082\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u3088\u3046\n\nindex.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Firebase Study</title>\n    <style media=\"screen\">\n    \u3000/** \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 */\n      body {\n        margin: 0;\n        padding: 0;\n      }\n      header {\n        background: #f99;\n        padding: 10px;\n        text-align: right;\n      }\n      #input_form {\n        padding: 10px;\n      }\n      #user_icon {\n        height: 60px;\n      }\n    </style>\n  </head>\n  <body>\n    <!-- \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 -->\n    <header>\n      <div id=\"login_info\">\n        <input type=\"email\" id=\"email\" placeholder=\"email\">\n        <input type=\"password\" id=\"password\" placeholder=\"password\">\n        <button id=\"login_btn\">\u30ed\u30b0\u30a4\u30f3</button>\n        <button id=\"user_regist_btn\">\u65b0\u898f\u767b\u9332</button>\n      </div>\n      <div id=\"logout_info\" style=\"display: none;\">\n        <!-- \u2193\u21936.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2193\u2193 -->\n        <input type=\"file\" id=\"icon_file\"><button id=\"icon_up_btn\">\u30a2\u30a4\u30b3\u30f3\u753b\u50cf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9</button>\n        <!-- \u2191\u21916.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2191\u2191 -->\n        <button id=\"logout_btn\">\u30ed\u30b0\u30a2\u30a6\u30c8</button>\n      </div>\n    </header>\n    <!-- \u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191 -->\n    <form id=\"input_form\">\n        <!-- \u2193\u21936.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2193\u2193 -->\n        <img src=\"\" id=\"user_icon\">\n        <!-- \u2191\u21916.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2191\u2191 -->\n        <input type=\"text\" id=\"name\" size=\"10\" placeholder=\"Name\" value=\"\u540d\u7121\u3057\">\n        <input type=\"text\" id=\"input_text\" size=\"50\">\n        <button type=\"submit\" id=\"send_btn\">SEND</button>\n        <hr>\n        <div id=\"chat_area\"></div>\n    </form>\n  </body>\n  <script\n    src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\n    integrity=\"sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=\"\n    crossorigin=\"anonymous\"></script>\n  <script src=\"https://www.gstatic.com/firebasejs/3.6.1/firebase.js\"></script>\n  <script>\n    $(function(){\n      // \u2193\u2193\u2193\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      // Initialize Firebase\n      var config = {\n        apiKey: \"AIzaSyDFWFBb2ZsPoN3q7Y-KnOp_xboLvBPmK-Q\",\n        authDomain: \"fb-hack-fa53d.firebaseapp.com\",\n        databaseURL: \"https://fb-hack-fa53d.firebaseio.com\",\n        storageBucket: \"fb-hack-fa53d.appspot.com\",\n        messagingSenderId: \"462609738357\"\n      };\n      // \u2191\u2191\u2191\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      firebase.initializeApp(config);\n\n      var userId = \"\";\n\n      // submit\u6642\n      $(\"#input_form\").submit(function(){\n          writeChatData($(\"#name\").val(), $(\"#input_text\").val());\n          return false;\n      });\n\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text,\n          user_id: userId,   // \u21905.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\n          photo_url: $(\"#user_icon\").attr(\"src\") // \u21906.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n        }).catch(function(error) {\n          alert(error.message);\n        });\n      }\n\n      //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n      // \u767a\u8a00\u3092\u66f4\u65b0\n      function updateChatData(key, text) {\n        firebase.database().ref('chat/' + key + '/text').set(text).catch(function(error) {\n          alert(error.message);\n        });\n      }\n      //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n      // \u767a\u8a00\u3092\u8868\u793a\n      firebase.database().ref(\"chat\").on(\"value\", function(snapshot) {\n          $(\"#chat_area\").html(\"\");\n\n          var logs = snapshot.val();\n          for (var key in logs) {\n              var logHtml = '';\n              //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n              var photoUrl = logs[key].photo_url; // 6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n              if (!photoUrl) photoUrl = \"\";\u3000\u3000\u3000\u3000 // 6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n              if (logs[key].user_id == userId) {\n                 // 6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n                logHtml = '<p><img src=\"' + photoUrl + '\" height=\"40px\">' + logs[key].name + '\uff1a<input type=\"text\" class=\"update_text\" size=\"50\" value=\"' + logs[key].text + '\" data-key=\"' + key + '\"/></p><hr>'\n              } else {\n                 // 6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n                logHtml = '<p><img src=\"' + photoUrl + '\" height=\"40px\">' + logs[key].name + '\uff1a' + logs[key].text + '</p><hr>'\n              }\n              //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n              $(\"#chat_area\").prepend(logHtml);\n          }\n\n          //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n          $(\".update_text\").off(\"change\");\n          $(\".update_text\").on(\"change\", function(){\n            var key = $(this).attr(\"data-key\");\n            var text = $(this).val();\n            updateChatData(key, text);\n          });\n          //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n      });\n\n      //\u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193\n      firebase.auth().onAuthStateChanged(function(user) {\n        if (user) {\n          $(\"#login_info\").hide();\n          $(\"#logout_info\").show();\n          if (user.displayName) {\n            $(\"#name\").val(user.displayName);\n          }\n          //\u2193\u21936.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2193\u2193\n          if (user.photoURL) {\n            $(\"#user_icon\").attr(\"src\", user.photoURL);\n          }\n          //\u2191\u21916.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2191\u2191\n          userId = user.uid;\n        } else {\n          $(\"#logout_info\").hide();\n          $(\"#login_info\").show();\n          $(\"#name\").val(\"\");\n        }\n      });\n\n      // \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n      $(\"#user_regist_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a4\u30f3\n      $(\"#login_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a2\u30a6\u30c8\n      $(\"#logout_btn\").click(function(){\n        firebase.auth().signOut().then(function() {\n          // Sign-out successful.\n        }, function(error) {\n          // An error happened.\n        });\n      });\n\n      // \u540d\u524d\u304c\u5909\u66f4\u3055\u308c\u305f\u3089\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u5909\u66f4\n      $(\"#name\").change(function(){\n        var user = firebase.auth().currentUser;\n        if (user) {\n          user.updateProfile({\n            displayName: $(\"#name\").val()\n          });\n        }\n      });\n\n      //\u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191\n\n      //\u2193\u21936.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2193\u2193\n      $(\"#icon_up_btn\").click(function(){\n        var file = $('#icon_file')[0].files[0];\n        if (!file) return false;\n\n        var storageRef = firebase.storage().ref();\n        var uploadTask = storageRef.child('images/' + userId + '/' + file.name).put(file);\n\n        uploadTask.on('state_changed', function(snapshot){\n          // \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u4e2d\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u304c\u5909\u308f\u3063\u305f\u3068\u304d\u306b\u4f55\u304b\u3059\u308b\u5834\u6240\n        }, function(error) {\n          alert(\"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u5931\u6557\u3057\u307e\u3057\u305f\");\n        }, function() {\n          var iconURL = uploadTask.snapshot.downloadURL;\n          console.log(iconURL);\n          $('#icon_file').val(\"\");\n          alert(\"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5b8c\u4e86\");\n\n          // \u30e6\u30fc\u30b6\u30fc\u306e\u30a2\u30a4\u30b3\u30f3\u753b\u50cf\u306b\u8a2d\u5b9a\n          var user = firebase.auth().currentUser;\n          if (user) {\n            user.updateProfile({\n              photoURL: iconURL\n            });\n          }\n          $(\"#user_icon\").attr(\"src\", iconURL);\n\n        });\n      });\n      //\u2191\u21916.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2191\u2191\n\n    });\n\n  </script>\n</html>\n\n\n\n\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0a\u3067\u3059\u3002\n\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n\u4eca\u56de\u306e\u30bd\u30fc\u30b9\nhttps://github.com/nakazonor/firebase-study\n#1.Firebase\u306e\u5229\u7528\u958b\u59cb\n\n\u3068\u308a\u3042\u3048\u305a\u3053\u3053\u304b\u3089\u65b0\u898f\u767b\u9332\u3057\u3066\u306d\n\u203bGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u5fc5\u8981\u3060\u3088\nhttps://console.firebase.google.com/\n\n##\u65b0\u898f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u305f\u3089\u3001\u300c\u65b0\u898f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u300d\u30dc\u30bf\u30f3\u304b\u3089\n\u65b0\u898f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308d\u3046\n\n\u203b\u56fd\u306f\u307e\u3041\u3001\u65e5\u672c\u4eba\u306a\u3093\u3067\u65e5\u672c\u9078\u307c\u3046\n\n\u3053\u308c\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u304d\u305f\u306d\uff01\u65e9\u3044\u306d\uff01\n\n#2.\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u3088\u3046\n\n##Firebase tools\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3088\u3046\n\nnpm\u3067Firebase tools\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnpm\u304c\u306a\u3044\u4eba\u306fnode.js\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u306d\u3002\n\n```bash:command\n\n/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n\nbrew install nodebrew\n\nnodebrew install-binary latest\n\nnpm install -g firebase-tools\n```\n\n##\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u305f\u3081\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u7528\u610f\u3057\u3088\u3046\n\n\u9069\u5f53\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u3063\u305f\u3089\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u305d\u3053\u306b\u79fb\u52d5\u3057\u3066\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash:command\nfirebase login\n```\n\n\u305d\u3057\u305f\u3089\u306a\u3093\u304b\u30d6\u30e9\u30a6\u30b6\u304c\u8d77\u52d5\u3059\u308b\u306e\u3067Firebase\u306e\u767b\u9332\u306b\u4f7f\u3063\u305f\nGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\n\n\u6b21\u306b\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3063\u3066\u304f\u3060\u3055\u3044\n\n```bash:command\nfirebase init\n```\n\u8272\u3005\u805e\u304b\u308c\u308b\u306e\u3067\nWhat Firebase CLI features do you want to setup for this folder?\n\u2192\u3053\u308c\u306f\u305d\u306e\u307e\u307eEnter\n\nProject Setup\n\u2192\u3055\u3063\u304d\u4f5c\u3063\u305fFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u9078\u629e\n\nDatabase Setup\n\u2192\u3053\u308c\u306f\u305d\u306e\u307e\u307eEnter\n\nWhat do you want to use as your public directory?\n\u2192\u3053\u308c\u306fy\u3092\u9078\u629e\u3057Enter\n\nConfigure as a single-page app (rewrite all urls to /index.html)?\n\u2192\u3053\u308c\u3082y\u3092\u9078\u629e\u3057Enter\n\n\u3053\u308c\u3067\u8272\u3005\u30d5\u30a1\u30a4\u30eb\u304c\u52dd\u624b\u306b\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\uff01\n\npublic\n\u2514index.html\ndatabase.rules.json\nfirebase.json\n\npublic\u30d5\u30a9\u30eb\u30c0\u306e\u4e0b\u306b\u4f5c\u3089\u308c\u305findex.html\u3092\u9069\u5f53\u306b\u3044\u3058\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\u3068\u308a\u3042\u3048\u305ah1\u30bf\u30b0\u306e\u4e2d\u8eab\u304b\u3048\u308b\u3068\u304b\u3002\n\n\u305d\u3057\u3066\u30c7\u30d7\u30ed\u30a4\u30b3\u30de\u30f3\u30c9\u3092\u53e9\u3051\u3070\u3001\u30c7\u30d7\u30ed\u30a4\u5b8c\u4e86\u3067\u3059\u3002\n\n```bash:command\nfirebase deploy\n```\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u53e9\u304f\u3068\u3001\u592a\u5b57\u3067Hosting URL\u3068\u3044\u3046\u9805\u76ee\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u3053\u306eURL\u304c\u4eca\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u30b5\u30a4\u30c8\u306eURL\u306b\u306a\u308a\u307e\u3059\u3002\n\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u3088\u3046\u3002\n\n\n#3.\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u3063\u3066\u307f\u3088\u3046\n\nConsole\u306e\u300cDatabase\u300d\u3063\u3066\u3068\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u307f\u3088\u3046\u3002\n\u307e\u3060\u4f55\u3082\u306a\u3044\u306d\uff01\n\n##\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u89e3\u653e\u3057\u308d\uff01\n\u300c\u65e2\u5b9a\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3 \u30eb\u30fc\u30eb\u3067\u306f\u30e6\u30fc\u30b6\u30fc\u306e\u8a8d\u8a3c\u304c\u5fc5\u8981\u3067\u3059\u300d\u3063\u3066\u9752\u6587\u5b57\u304c\u51fa\u3066\u307e\u3059\u3002\n\u3053\u306e\u307e\u307e\u3060\u3068\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u3068\u304b\u3057\u306a\u3044\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u4f7f\u3048\u306a\u3044\u3093\u3067\u3059\u306d\u3002\n\u306a\u306e\u3067\u300c\u30eb\u30fc\u30eb\u300d\u3063\u3066\u30bf\u30d6\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u306d\u3002\n\u305d\u3057\u305f\u3089\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u306b\u306a\u3063\u3066\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u306d\u3002\n\n```json:rule.json\n{\n  \"rules\": {\n    \".read\": \"auth != null\",\n    \".write\": \"auth != null\"\n  }\n}\n```\n\n\u3053\u308c\u3092\n\n```json:rule.json\n{\n  \"rules\": {\n    \".read\": true,\n    \".write\": true\n  }\n}\n```\n\u3053\u3046\u3057\u3061\u3083\u304a\u3046\n\u305d\u3057\u3066\u300c\u516c\u958b\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u305b\u3070\u30fb\u30fb\u30fb\n\u300c\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3 \u30eb\u30fc\u30eb\u304c\u516c\u958b\u5bfe\u8c61\u3068\u3057\u3066\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u8ab0\u3067\u3082\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8aad\u307f\u53d6\u308a\u3084\u66f8\u304d\u8fbc\u307f\u3092\u884c\u3048\u307e\u3059\u300d\n\u307f\u305f\u3044\u306a\u306e\u304c\u8d64\u6587\u5b57\u3067\u51fa\u3066\u304d\u307e\u3057\u305f\u306d\u3002\n\u3053\u308c\u3067\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u306a\u3057\u3067DB\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\uff01\n\n\u203b\u3053\u3053\u306e\u30eb\u30fc\u30eb\u3068\u300cdatabase.rules.json\u300d\u3067\u5b9a\u7fa9\u3057\u305f\u30eb\u30fc\u30eb\u306f\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c7\u30d7\u30ed\u30a4\u6642\u306b\u540c\u671f\u3055\u308c\u307e\u3059\u3002\n\u300cdatabase.rules.json\u300d\u306e\u5185\u5bb9\u3067\u4e0a\u66f8\u304d\u3055\u308c\u308b\u306e\u3067\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u3068\u3044\u3046\u304b\u5b9f\u969b\u306f\u300cdatabase.rules.json\u300d\u3092\u6b63\u3068\u3057\u3066\u958b\u767a\u3059\u308b\u306e\u304c\u6b63\u3057\u3044\u3067\u3059\u306d\u3002\n\n\n##\u30b3\u30fc\u30c9\u3092\u66f8\u3053\u3046\npublic\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306eindex.html\u3092\u4ee5\u4e0b\u306e\u5185\u5bb9\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\u203bjQuery\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\n```html:index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Firebase Study</title>\n    <style media=\"screen\">\n    </style>\n  </head>\n  <body>\n    <form id=\"input_form\">\n        <input type=\"text\" id=\"name\" size=\"10\" placeholder=\"Name\" value=\"\u540d\u7121\u3057\">\n        <input type=\"text\" id=\"input_text\" size=\"50\">\n        <button type=\"submit\" id=\"send_btn\">SEND</button>\n        <hr>\n        <div id=\"chat_area\"></div>\n    </form>\n  </body>\n  <script\n    src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\n    integrity=\"sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=\"\n    crossorigin=\"anonymous\"></script>\n  <script src=\"https://www.gstatic.com/firebasejs/3.6.1/firebase.js\"></script>\n  <script>\n    $(function(){\n      // \u2193\u2193\u2193\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      // Initialize Firebase\n      var config = {\n        apiKey: '<your-api-key>',\n        authDomain: '<your-auth-domain>',\n        databaseURL: '<your-database-url>',\n        storageBucket: '<your-storage-bucket>'\n      };\n      // \u2191\u2191\u2191\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      firebase.initializeApp(config);\n\n      // submit\u6642\n      $(\"#input_form\").submit(function(){\n          writeChatData($(\"#name\").val(), $(\"#input_text\").val());\n          return false;\n      });\n\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text\n        });\n      }\n\n      // \u767a\u8a00\u3092\u8868\u793a\n      firebase.database().ref(\"chat\").on(\"value\", function(snapshot) {\n          $(\"#chat_area\").html(\"\");\n\n          var logs = snapshot.val();\n          for (var key in logs) {\n              var logHtml = '<p>' + logs[key].name + '\uff1a' + logs[key].text + '</p><hr>'\n              $(\"#chat_area\").prepend(logHtml);\n          }\n      });\n\n    });\n\n  </script>\n</html>\n```\n\nconfig\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3092\u958b\u304d\u3001\u30c8\u30c3\u30d7\u306e\u53f3\u5074\u306b\u3042\u308b\u300c\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u306bFirebase\u3092\u8ffd\u52a0\u300d\u306e\u30a2\u30a4\u30b3\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u3001\u305d\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306econfig\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n##\u5b9f\u884c\u3057\u3088\u3046\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u3001\u30ed\u30fc\u30ab\u30eb\u3067\u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash:command\nfirebase serve\n```\n\nlocalhost:5000\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u4f5c\u6210\u3057\u305f\u30c1\u30e3\u30c3\u30c8\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\n#4.\u8a8d\u8a3c\u6a5f\u80fd\u3092\u4f7f\u304a\u3046\n\n##\u307e\u305a\u306f\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3067Authentication\u306e\u8a2d\u5b9a\n\u300cAuthentication\u300d\u30e1\u30cb\u30e5\u30fc\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u300c\u30ed\u30b0\u30a4\u30f3\u65b9\u6cd5\u300d\u30bf\u30d6\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u300c\u30e1\u30fc\u30eb\uff0f\u30d1\u30b9\u30ef\u30fc\u30c9\u300d\u304c\u7121\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\n\u6709\u52b9\u306b\u3057\u3066\u4fdd\u5b58\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n##\u30b3\u30fc\u30c9\u3092\u5909\u66f4\n\n```html:index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Firebase Study</title>\n    <style media=\"screen\">\n    \u3000/** \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 */\n      body {\n        margin: 0;\n        padding: 0;\n      }\n      header {\n        background: #f99;\n        padding: 10px;\n        text-align: right;\n      }\n      #input_form {\n        padding: 10px;\n      }\n    \u3000/** \u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191 */\n    </style>\n  </head>\n  <body>\n    <!-- \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 -->\n    <header>\n      <div id=\"login_info\">\n        <input type=\"email\" id=\"email\" placeholder=\"email\">\n        <input type=\"password\" id=\"password\" placeholder=\"password\">\n        <button id=\"login_btn\">\u30ed\u30b0\u30a4\u30f3</button>\n        <button id=\"user_regist_btn\">\u65b0\u898f\u767b\u9332</button>\n      </div>\n      <div id=\"logout_info\" style=\"display: none;\">\n        <button id=\"logout_btn\">\u30ed\u30b0\u30a2\u30a6\u30c8</button>\n      </div>\n    </header>\n    <!-- \u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191 -->\n    <form id=\"input_form\">\n        <input type=\"text\" id=\"name\" size=\"10\" placeholder=\"Name\" value=\"\u540d\u7121\u3057\">\n        <input type=\"text\" id=\"input_text\" size=\"50\">\n        <button type=\"submit\" id=\"send_btn\">SEND</button>\n        <hr>\n        <div id=\"chat_area\"></div>\n    </form>\n  </body>\n  <script\n    src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\n    integrity=\"sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=\"\n    crossorigin=\"anonymous\"></script>\n  <script src=\"https://www.gstatic.com/firebasejs/3.6.1/firebase.js\"></script>\n  <script>\n    $(function(){\n      // \u2193\u2193\u2193\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      // Initialize Firebase\n      var config = {\n        apiKey: '<your-api-key>',\n        authDomain: '<your-auth-domain>',\n        databaseURL: '<your-database-url>',\n        storageBucket: '<your-storage-bucket>'\n      };\n      // \u2191\u2191\u2191\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      firebase.initializeApp(config);\n\n      // submit\u6642\n      $(\"#input_form\").submit(function(){\n          writeChatData($(\"#name\").val(), $(\"#input_text\").val());\n          return false;\n      });\n\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text\n        });\n      }\n\n      // \u767a\u8a00\u3092\u8868\u793a\n      firebase.database().ref(\"chat\").on(\"value\", function(snapshot) {\n          $(\"#chat_area\").html(\"\");\n\n          var logs = snapshot.val();\n          for (var key in logs) {\n              var logHtml = '<p>' + logs[key].name + '\uff1a' + logs[key].text + '</p><hr>'\n              $(\"#chat_area\").prepend(logHtml);\n          }\n      });\n\n      //\u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193\n      firebase.auth().onAuthStateChanged(function(user) {\n        if (user) {\n          $(\"#login_info\").hide();\n          $(\"#logout_info\").show();\n          if (user.displayName) {\n            $(\"#name\").val(user.displayName);\n          }\n        } else {\n          $(\"#logout_info\").hide();\n          $(\"#login_info\").show();\n          $(\"#name\").val(\"\");\n        }\n      });\n\n      // \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n      $(\"#user_regist_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a4\u30f3\n      $(\"#login_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a2\u30a6\u30c8\n      $(\"#logout_btn\").click(function(){\n        firebase.auth().signOut().then(function() {\n          // Sign-out successful.\n        }, function(error) {\n          // An error happened.\n        });\n      });\n\n      // \u540d\u524d\u304c\u5909\u66f4\u3055\u308c\u305f\u3089\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u5909\u66f4\n      $(\"#name\").change(function(){\n        var user = firebase.auth().currentUser;\n        if (user) {\n          user.updateProfile({\n            displayName: $(\"#name\").val()\n          });\n        }\n      });\n\n      //\u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191\n\n    });\n\n  </script>\n</html>\n```\n\n##Google\u3084Facebook\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u8a8d\u8a3c\u3057\u305f\u3044\n\u3053\u3053\u307e\u3067\u308f\u304b\u308c\u3070\u3042\u3068\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u898b\u308c\u3070\u5927\u4e08\u592b\n\nhttps://firebase.google.com/docs/auth/web/google-signin\nhttps://firebase.google.com/docs/auth/web/facebook-login\n\n#5.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u3088\u3046\n\u305b\u3063\u304b\u304f\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u4f5c\u3063\u305f\u3051\u3069\u3001\u8ab0\u3067\u3082\u66f8\u304d\u8fbc\u3081\u308b\u3057\u3042\u3093\u307e\u610f\u5473\u306a\u3044\u3088\u306d\u3002\n\u306a\u306e\u3067\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u307f\u307e\u3057\u3087\u3046\n\n##\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u306a\u3044\u3068\u66f8\u304d\u8fbc\u307f\u7981\u6b62\u306b\u3059\u308b\ndatabase.rules.json\u3092\u3044\u3058\u308d\u3046\n\n```json:database.rules.json\n{\n  \"rules\": {\n    \".read\": true,\n    \".write\": \"auth != null\"\n  }\n}\n```\n\n\u30a8\u30e9\u30fc\u3092\u308f\u304b\u308a\u3084\u3059\u304f\u3059\u308b\u305f\u3081index.html\u3082\u3061\u3087\u3053\u3063\u3068\u3060\u3051\u3044\u3058\u308b\n\u203b\u767a\u8a00\u3092\u767b\u9332\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306bcatch\u306e\u90e8\u5206\u3092\u8ffd\u52a0\n\n```js:index.html\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text\n        }).catch(function(error) {\n          alert(error.message);\n        });\n      }\n```\n\n\u305d\u3057\u305f\u3089\u30c7\u30d7\u30ed\u30a4\n\n```bash:command\nfirebase deploy\n```\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u3044\u3068\u66f8\u304d\u8fbc\u3081\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u306d\n\n\n##\u3082\u3063\u3068\u96e3\u3057\u3044\u30eb\u30fc\u30eb\u3092\n\u81ea\u5206\u306e\u767a\u8a00\u3060\u3051\u3092\u5909\u66f4\u53ef\u80fd\u306b\u3059\u308b\n\n\n```json:database.rules.json\n{\n  \"rules\": {\n    \"chat\": {\n      \".read\": true,\n      \"$message\": {\n        \".write\": \"data.child('user_id').val() == auth.uid || !data.exists()\"\n      }\n    }\n  }\n}\n```\ndata\u306f\u5909\u66f4\u524d\u306e\u30c7\u30fc\u30bf\u3092\u8868\u3057\u307e\u3059\u3002\nauth\u306f\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u30fc\u306e\u60c5\u5831\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n$message\u306fchat\u8981\u7d20\u306e\u5b50\u4f9b\u306e\u8981\u7d20\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\n$\u306b\u3064\u3065\u304f\u540d\u524d\u306f\u306a\u3093\u3067\u3082\u3044\u3044\u3067\u3059\u3002\n\n\n```html:index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Firebase Study</title>\n    <style media=\"screen\">\n    \u3000/** \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 */\n      body {\n        margin: 0;\n        padding: 0;\n      }\n      header {\n        background: #f99;\n        padding: 10px;\n        text-align: right;\n      }\n      #input_form {\n        padding: 10px;\n      }\n    </style>\n  </head>\n  <body>\n    <!-- \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 -->\n    <header>\n      <div id=\"login_info\">\n        <input type=\"email\" id=\"email\" placeholder=\"email\">\n        <input type=\"password\" id=\"password\" placeholder=\"password\">\n        <button id=\"login_btn\">\u30ed\u30b0\u30a4\u30f3</button>\n        <button id=\"user_regist_btn\">\u65b0\u898f\u767b\u9332</button>\n      </div>\n      <div id=\"logout_info\" style=\"display: none;\">\n        <button id=\"logout_btn\">\u30ed\u30b0\u30a2\u30a6\u30c8</button>\n      </div>\n    </header>\n    <!-- \u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191 -->\n    <form id=\"input_form\">\n        <input type=\"text\" id=\"name\" size=\"10\" placeholder=\"Name\" value=\"\u540d\u7121\u3057\">\n        <input type=\"text\" id=\"input_text\" size=\"50\">\n        <button type=\"submit\" id=\"send_btn\">SEND</button>\n        <hr>\n        <div id=\"chat_area\"></div>\n    </form>\n  </body>\n  <script\n    src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\n    integrity=\"sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=\"\n    crossorigin=\"anonymous\"></script>\n  <script src=\"https://www.gstatic.com/firebasejs/3.6.1/firebase.js\"></script>\n  <script>\n    $(function(){\n      // \u2193\u2193\u2193\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      // Initialize Firebase\n      var config = {\n        apiKey: '<your-api-key>',\n        authDomain: '<your-auth-domain>',\n        databaseURL: '<your-database-url>',\n        storageBucket: '<your-storage-bucket>'\n      };\n      // \u2191\u2191\u2191\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      firebase.initializeApp(config);\n      \n      var userId = \"\";\n\n      // submit\u6642\n      $(\"#input_form\").submit(function(){\n          writeChatData($(\"#name\").val(), $(\"#input_text\").val());\n          return false;\n      });\n\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text,\n          user_id: userId   // \u21905.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\n        }).catch(function(error) {\n          alert(error.message);\n        });\n      }\n\n      //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n      // \u767a\u8a00\u3092\u66f4\u65b0\n      function updateChatData(key, text) {\n        firebase.database().ref('chat/' + key + '/text').set(text).catch(function(error) {\n          alert(error.message);\n        });\n      }\n      //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n      // \u767a\u8a00\u3092\u8868\u793a\n      firebase.database().ref(\"chat\").on(\"value\", function(snapshot) {\n          $(\"#chat_area\").html(\"\");\n\n          var logs = snapshot.val();\n          for (var key in logs) {\n              var logHtml = '';\n              //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n              if (logs[key].user_id == userId) {\n                logHtml = '<p>' + logs[key].name + '\uff1a<input type=\"text\" class=\"update_text\" size=\"50\" value=\"' + logs[key].text + '\" data-key=\"' + key + '\"/></p><hr>'\n              } else {\n                logHtml = '<p>' + logs[key].name + '\uff1a' + logs[key].text + '</p><hr>'\n              }\n              //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n              $(\"#chat_area\").prepend(logHtml);\n          }\n\n          //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n          $(\".update_text\").off(\"change\");\n          $(\".update_text\").on(\"change\", function(){\n            var key = $(this).attr(\"data-key\");\n            var text = $(this).val();\n            updateChatData(key, text);\n          });\n          //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n      });\n\n      //\u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193\n      firebase.auth().onAuthStateChanged(function(user) {\n        if (user) {\n          $(\"#login_info\").hide();\n          $(\"#logout_info\").show();\n          if (user.displayName) {\n            $(\"#name\").val(user.displayName);\n          }\n          userId = user.uid;\n        } else {\n          $(\"#logout_info\").hide();\n          $(\"#login_info\").show();\n          $(\"#name\").val(\"\");\n        }\n      });\n\n      // \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n      $(\"#user_regist_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a4\u30f3\n      $(\"#login_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a2\u30a6\u30c8\n      $(\"#logout_btn\").click(function(){\n        firebase.auth().signOut().then(function() {\n          // Sign-out successful.\n        }, function(error) {\n          // An error happened.\n        });\n      });\n\n      // \u540d\u524d\u304c\u5909\u66f4\u3055\u308c\u305f\u3089\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u5909\u66f4\n      $(\"#name\").change(function(){\n        var user = firebase.auth().currentUser;\n        if (user) {\n          user.updateProfile({\n            displayName: $(\"#name\").val()\n          });\n        }\n      });\n\n      //\u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191\n\n    });\n\n  </script>\n</html>\n```\n\n#6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u4f7f\u304a\u3046\n\nFirebase\u304b\u3089GCP\u306eGoogle Cloud Storage\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u3093\u306a\u611f\u3058\u3067\u66f8\u3051\u3070\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\n\n```js:upload\nvar storageRef = firebase.storage().ref();\nvar uploadTask = storageRef.child('images/' + userId + '/' + file.name).put(file);\n```\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u306e\u30a2\u30a4\u30b3\u30f3\u753b\u50cf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\n\u767a\u8a00\u3068\u4e00\u7dd2\u306b\u30a2\u30a4\u30b3\u30f3\u3082\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u3088\u3046\n\n```html:index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Firebase Study</title>\n    <style media=\"screen\">\n    \u3000/** \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 */\n      body {\n        margin: 0;\n        padding: 0;\n      }\n      header {\n        background: #f99;\n        padding: 10px;\n        text-align: right;\n      }\n      #input_form {\n        padding: 10px;\n      }\n      #user_icon {\n        height: 60px;\n      }\n    </style>\n  </head>\n  <body>\n    <!-- \u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193 -->\n    <header>\n      <div id=\"login_info\">\n        <input type=\"email\" id=\"email\" placeholder=\"email\">\n        <input type=\"password\" id=\"password\" placeholder=\"password\">\n        <button id=\"login_btn\">\u30ed\u30b0\u30a4\u30f3</button>\n        <button id=\"user_regist_btn\">\u65b0\u898f\u767b\u9332</button>\n      </div>\n      <div id=\"logout_info\" style=\"display: none;\">\n        <!-- \u2193\u21936.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2193\u2193 -->\n        <input type=\"file\" id=\"icon_file\"><button id=\"icon_up_btn\">\u30a2\u30a4\u30b3\u30f3\u753b\u50cf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9</button>\n        <!-- \u2191\u21916.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2191\u2191 -->\n        <button id=\"logout_btn\">\u30ed\u30b0\u30a2\u30a6\u30c8</button>\n      </div>\n    </header>\n    <!-- \u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191 -->\n    <form id=\"input_form\">\n        <!-- \u2193\u21936.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2193\u2193 -->\n        <img src=\"\" id=\"user_icon\">\n        <!-- \u2191\u21916.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2191\u2191 -->\n        <input type=\"text\" id=\"name\" size=\"10\" placeholder=\"Name\" value=\"\u540d\u7121\u3057\">\n        <input type=\"text\" id=\"input_text\" size=\"50\">\n        <button type=\"submit\" id=\"send_btn\">SEND</button>\n        <hr>\n        <div id=\"chat_area\"></div>\n    </form>\n  </body>\n  <script\n    src=\"https://code.jquery.com/jquery-2.2.4.min.js\"\n    integrity=\"sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=\"\n    crossorigin=\"anonymous\"></script>\n  <script src=\"https://www.gstatic.com/firebasejs/3.6.1/firebase.js\"></script>\n  <script>\n    $(function(){\n      // \u2193\u2193\u2193\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      // Initialize Firebase\n      var config = {\n        apiKey: \"AIzaSyDFWFBb2ZsPoN3q7Y-KnOp_xboLvBPmK-Q\",\n        authDomain: \"fb-hack-fa53d.firebaseapp.com\",\n        databaseURL: \"https://fb-hack-fa53d.firebaseio.com\",\n        storageBucket: \"fb-hack-fa53d.appspot.com\",\n        messagingSenderId: \"462609738357\"\n      };\n      // \u2191\u2191\u2191\u3053\u3053\u306e\u60c5\u5831\u3092\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3082\u306e\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n      firebase.initializeApp(config);\n      \n      var userId = \"\";\n\n      // submit\u6642\n      $(\"#input_form\").submit(function(){\n          writeChatData($(\"#name\").val(), $(\"#input_text\").val());\n          return false;\n      });\n\n      // \u767a\u8a00\u3092\u767b\u9332\n      function writeChatData(name, text) {\n        $(\"#input_text\").val(\"\");\n        firebase.database().ref('chat').push({\n          name: name,\n          text: text,\n          user_id: userId,   // \u21905.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\n          photo_url: $(\"#user_icon\").attr(\"src\") // \u21906.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n        }).catch(function(error) {\n          alert(error.message);\n        });\n      }\n\n      //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n      // \u767a\u8a00\u3092\u66f4\u65b0\n      function updateChatData(key, text) {\n        firebase.database().ref('chat/' + key + '/text').set(text).catch(function(error) {\n          alert(error.message);\n        });\n      }\n      //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n      // \u767a\u8a00\u3092\u8868\u793a\n      firebase.database().ref(\"chat\").on(\"value\", function(snapshot) {\n          $(\"#chat_area\").html(\"\");\n\n          var logs = snapshot.val();\n          for (var key in logs) {\n              var logHtml = '';\n              //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n              var photoUrl = logs[key].photo_url; // 6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n              if (!photoUrl) photoUrl = \"\";\u3000\u3000\u3000\u3000 // 6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n              if (logs[key].user_id == userId) {\n                 // 6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n                logHtml = '<p><img src=\"' + photoUrl + '\" height=\"40px\">' + logs[key].name + '\uff1a<input type=\"text\" class=\"update_text\" size=\"50\" value=\"' + logs[key].text + '\" data-key=\"' + key + '\"/></p><hr>'\n              } else {\n                 // 6.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u5909\u66f4\n                logHtml = '<p><img src=\"' + photoUrl + '\" height=\"40px\">' + logs[key].name + '\uff1a' + logs[key].text + '</p><hr>'\n              }\n              //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n              $(\"#chat_area\").prepend(logHtml);\n          }\n\n          //\u2193\u21935.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2193\u2193\n          $(\".update_text\").off(\"change\");\n          $(\".update_text\").on(\"change\", function(){\n            var key = $(this).attr(\"data-key\");\n            var text = $(this).val();\n            updateChatData(key, text);\n          });\n          //\u2191\u21915.\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3067\u5909\u66f4\u2191\u2191\n\n      });\n\n      //\u2193\u21934.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2193\u2193\n      firebase.auth().onAuthStateChanged(function(user) {\n        if (user) {\n          $(\"#login_info\").hide();\n          $(\"#logout_info\").show();\n          if (user.displayName) {\n            $(\"#name\").val(user.displayName);\n          }\n          //\u2193\u21936.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2193\u2193\n          if (user.photoURL) {\n            $(\"#user_icon\").attr(\"src\", user.photoURL);\n          }\n          //\u2191\u21916.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2191\u2191\n          userId = user.uid;\n        } else {\n          $(\"#logout_info\").hide();\n          $(\"#login_info\").show();\n          $(\"#name\").val(\"\");\n        }\n      });\n\n      // \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n      $(\"#user_regist_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a4\u30f3\n      $(\"#login_btn\").click(function(){\n        var email = $(\"#email\").val();\n        var password = $(\"#password\").val();\n        firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {\n          // Handle Errors here.\n          var errorCode = error.code;\n          var errorMessage = error.message;\n          alert(errorMessage);\n        });\n      });\n\n      // \u30ed\u30b0\u30a2\u30a6\u30c8\n      $(\"#logout_btn\").click(function(){\n        firebase.auth().signOut().then(function() {\n          // Sign-out successful.\n        }, function(error) {\n          // An error happened.\n        });\n      });\n\n      // \u540d\u524d\u304c\u5909\u66f4\u3055\u308c\u305f\u3089\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u5909\u66f4\n      $(\"#name\").change(function(){\n        var user = firebase.auth().currentUser;\n        if (user) {\n          user.updateProfile({\n            displayName: $(\"#name\").val()\n          });\n        }\n      });\n\n      //\u2191\u21914.\u8a8d\u8a3c\u3067\u8ffd\u52a0\u2191\u2191\n\n      //\u2193\u21936.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2193\u2193\n      $(\"#icon_up_btn\").click(function(){\n        var file = $('#icon_file')[0].files[0];\n        if (!file) return false;\n\n        var storageRef = firebase.storage().ref();\n        var uploadTask = storageRef.child('images/' + userId + '/' + file.name).put(file);\n\n        uploadTask.on('state_changed', function(snapshot){\n          // \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u4e2d\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u304c\u5909\u308f\u3063\u305f\u3068\u304d\u306b\u4f55\u304b\u3059\u308b\u5834\u6240\n        }, function(error) {\n          alert(\"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u5931\u6557\u3057\u307e\u3057\u305f\");\n        }, function() {\n          var iconURL = uploadTask.snapshot.downloadURL;\n          console.log(iconURL);\n          $('#icon_file').val(\"\");\n          alert(\"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5b8c\u4e86\");\n\n          // \u30e6\u30fc\u30b6\u30fc\u306e\u30a2\u30a4\u30b3\u30f3\u753b\u50cf\u306b\u8a2d\u5b9a\n          var user = firebase.auth().currentUser;\n          if (user) {\n            user.updateProfile({\n              photoURL: iconURL\n            });\n          }\n          $(\"#user_icon\").attr(\"src\", iconURL);\n\n        });\n      });\n      //\u2191\u21916.\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8ffd\u52a0\u2191\u2191\n      \n    });\n\n  </script>\n</html>\n\n```\n\n\n\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0a\u3067\u3059\u3002\n\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n\n\u4eca\u56de\u306e\u30bd\u30fc\u30b9\nhttps://github.com/nakazonor/firebase-study\n"}