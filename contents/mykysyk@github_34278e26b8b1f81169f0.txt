{"context": " More than 1 year has passed since last update.\nbeckey_delete.vbs\nOption Explicit\n\n'----------------------------------------------------------\n'\u5909\u6570\u5b9a\u7fa9\n'----------------------------------------------------------\nDim objFileSys\nDim objIE\nDim objSubf\nDim objSubd\nDim strArray\nDim strDeleteFile\nDim strDeleteFolder\nDim strAnswer\nDim strInputCtime\nDim dateCtimeFile\nDim dateCtimeFolder\nDim i\n\n'----------------------------------------------------------\n' \u524a\u9664\u5bfe\u8c61\u306e\u30e1\u30fc\u30eb\u30c7\u30fc\u30bf\u304c\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n'----------------------------------------------------------\nstrArray = Array(\"C:\\Becky!\\454294dd.mb\\!!!!Inbox\", _\n                 \"C:\\Becky!\\454294dd.mb\\!Trash\")\n\n\n'----------------------------------------------------------\n'\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b9a\u7fa9\n'----------------------------------------------------------\nSet objFileSys = CreateObject(\"Scripting.FileSystemObject\")\nSet objIE      = WScript.CreateObject(\"InternetExplorer.Application\")\n\n'----------------------------------------------------------\n' \u524a\u9664\u51e6\u7406\n'----------------------------------------------------------\nstrAnswer = MsgBox (\"\u524a\u9664\u51e6\u7406\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\", vbYesNo , \"\u524a\u9664\u30d5\u30a1\u30a4\u30eb\u78ba\u8a8d\" )\nSelect Case strAnswer\n  Case vbYes\n\n    '----------------------------------------------------------\n    ' objIE\u306e\u521d\u671f\u8a2d\u5b9a\n    '----------------------------------------------------------\n    objIE.Navigate \"about:blank\"\n    While objIE.busy: Wend\n    While objIE.Document.readyState <> \"complete\": DoEvents : Wend\n    objIE.AddressBar     = False\n    objIE.ToolBar        = False\n    objIE.StatusBar      = False\n    objIE.Resizable      = False\n    objIE.Height         = 100\n    objIE.Width          = 600\n    objIE.Top            = 50\n    objIE.Left           = 0\n    objIE.Visible        = True\n    objIE.Document.Title = \"[VBScript] Becky! \u30d5\u30a1\u30a4\u30eb\u524a\u9664\u30e2\u30cb\u30bf\"\n\n    '--- \u524a\u9664\u65e5\u6570\u78ba\u8a8d\u51e6\u7406\n    strInputCtime     = InputBox(\"\u4f55\u65e5\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f\" & vbCr & \"(\u30c7\u30d5\u30a9\u30eb\u30c87\u65e5)\", \"\u524a\u9664\u65e5\u6307\u5b9a\", 7)\n    If strInputCtime = \"\" Then\n        MsgBox \"\u30ad\u30e3\u30f3\u30bb\u30eb\u7d42\u4e86\"\n        objIE.Quit\n        WScript.Quit\n    End If\n\n    '--- \u524a\u9664\u51e6\u7406\n    For i = 0 To UBound(strArray)\n\n        '--- \u30e1\u30fc\u30eb\u30c7\u30fc\u30bf\u30fc\u306e\u524a\u9664\n        if objFileSys.FolderExists(strArray(i)) then\n\n            '--- \u524a\u9664\u5bfe\u8c61\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u53d6\u5f97\n            Set objSubf = objFileSys.GetFolder(strArray(i))\n            For Each strDeleteFile In objSubf.Files\n\n                '--- \u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u65e5\u53d6\u5f97\n                dateCtimeFile = strDeleteFile.DateLastModified\n\n                '--- strInputCtime\u65e5\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664\n                if Cint(DateDiff(\"d\", dateCtimeFile, date)) >= Cint(strInputCtime) then\n                    objIE.Document.body.innerHTML = \"<b><font color=red>\u524a\u9664\u4e2d</font></b><br>\" & strDeleteFile\n                    objFileSys.DeleteFile strDeleteFile, True\n                    Set strDeleteFile   = Nothing\n                End if\n            Next\n        End if\n\n       '--- \u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n        if objFileSys.FolderExists(strArray(i) & \"\\#Attach\") then\n\n            '--- \u524a\u9664\u5bfe\u8c61\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u53d6\u5f97\n            Set objSubd = objFileSys.GetFolder(strArray(i) & \"\\#Attach\")\n            For Each strDeleteFolder In objSubd.Subfolders\n\n                '--- \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\u65e5\u53d6\u5f97\n                dateCtimeFolder = strDeleteFolder.DateLastModified\n\n                '--- strInputCtime\u65e5\u524d\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u524a\u9664\n                if Cint(DateDiff(\"d\", dateCtimeFolder, date)) >= Cint(strInputCtime) then\n                    objIE.Document.body.innerHTML = \"<b><font color=red>\u524a\u9664\u4e2d</font></b><br>\" & strDeleteFolder\n                    objFileSys.DeleteFolder strDeleteFolder, True\n                    Set strDeleteFolder = Nothing\n                End if\n            Next\n        End if\n    Next\n\n  Case vbNo\n    MsgBox \"\u30ad\u30e3\u30f3\u30bb\u30eb\u7d42\u4e86\"\n    WScript.Quit\n\nEnd Select\n\n'----------------------------------------------------------\n' \u5f8c\u51e6\u7406\n'----------------------------------------------------------\nobjIE.Quit\n\nSet objFileSys = Nothing\n\nMsgBox \"\u7d42\u4e86\"\n\n\n```vbnet:beckey_delete.vbs\nOption Explicit\n\n'----------------------------------------------------------\n'\u5909\u6570\u5b9a\u7fa9\n'----------------------------------------------------------\nDim objFileSys\nDim objIE\nDim objSubf\nDim objSubd\nDim strArray\nDim strDeleteFile\nDim strDeleteFolder\nDim strAnswer\nDim strInputCtime\nDim dateCtimeFile\nDim dateCtimeFolder\nDim i\n\n'----------------------------------------------------------\n' \u524a\u9664\u5bfe\u8c61\u306e\u30e1\u30fc\u30eb\u30c7\u30fc\u30bf\u304c\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n'----------------------------------------------------------\nstrArray = Array(\"C:\\Becky!\\454294dd.mb\\!!!!Inbox\", _\n                 \"C:\\Becky!\\454294dd.mb\\!Trash\")\n\n\n'----------------------------------------------------------\n'\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b9a\u7fa9\n'----------------------------------------------------------\nSet objFileSys = CreateObject(\"Scripting.FileSystemObject\")\nSet objIE      = WScript.CreateObject(\"InternetExplorer.Application\")\n\n'----------------------------------------------------------\n' \u524a\u9664\u51e6\u7406\n'----------------------------------------------------------\nstrAnswer = MsgBox (\"\u524a\u9664\u51e6\u7406\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\", vbYesNo , \"\u524a\u9664\u30d5\u30a1\u30a4\u30eb\u78ba\u8a8d\" )\nSelect Case strAnswer\n  Case vbYes\n\n    '----------------------------------------------------------\n    ' objIE\u306e\u521d\u671f\u8a2d\u5b9a\n    '----------------------------------------------------------\n    objIE.Navigate \"about:blank\"\n    While objIE.busy: Wend\n    While objIE.Document.readyState <> \"complete\": DoEvents : Wend\n    objIE.AddressBar     = False\n    objIE.ToolBar        = False\n    objIE.StatusBar      = False\n    objIE.Resizable      = False\n    objIE.Height         = 100\n    objIE.Width          = 600\n    objIE.Top            = 50\n    objIE.Left           = 0\n    objIE.Visible        = True\n    objIE.Document.Title = \"[VBScript] Becky! \u30d5\u30a1\u30a4\u30eb\u524a\u9664\u30e2\u30cb\u30bf\"\n\n    '--- \u524a\u9664\u65e5\u6570\u78ba\u8a8d\u51e6\u7406\n    strInputCtime     = InputBox(\"\u4f55\u65e5\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f\" & vbCr & \"(\u30c7\u30d5\u30a9\u30eb\u30c87\u65e5)\", \"\u524a\u9664\u65e5\u6307\u5b9a\", 7)\n    If strInputCtime = \"\" Then\n        MsgBox \"\u30ad\u30e3\u30f3\u30bb\u30eb\u7d42\u4e86\"\n        objIE.Quit\n        WScript.Quit\n    End If\n\n    '--- \u524a\u9664\u51e6\u7406\n    For i = 0 To UBound(strArray)\n\n        '--- \u30e1\u30fc\u30eb\u30c7\u30fc\u30bf\u30fc\u306e\u524a\u9664\n        if objFileSys.FolderExists(strArray(i)) then\n\n            '--- \u524a\u9664\u5bfe\u8c61\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u53d6\u5f97\n            Set objSubf = objFileSys.GetFolder(strArray(i))\n            For Each strDeleteFile In objSubf.Files\n            \n                '--- \u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u65e5\u53d6\u5f97\n                dateCtimeFile = strDeleteFile.DateLastModified\n                \n                '--- strInputCtime\u65e5\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u524a\u9664\n                if Cint(DateDiff(\"d\", dateCtimeFile, date)) >= Cint(strInputCtime) then\n                    objIE.Document.body.innerHTML = \"<b><font color=red>\u524a\u9664\u4e2d</font></b><br>\" & strDeleteFile\n                    objFileSys.DeleteFile strDeleteFile, True\n                    Set strDeleteFile   = Nothing\n                End if\n            Next\n        End if\n        \n       '--- \u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n        if objFileSys.FolderExists(strArray(i) & \"\\#Attach\") then\n\n            '--- \u524a\u9664\u5bfe\u8c61\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u53d6\u5f97\n            Set objSubd = objFileSys.GetFolder(strArray(i) & \"\\#Attach\")\n            For Each strDeleteFolder In objSubd.Subfolders\n            \n                '--- \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\u65e5\u53d6\u5f97\n                dateCtimeFolder = strDeleteFolder.DateLastModified\n                \n                '--- strInputCtime\u65e5\u524d\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u524a\u9664\n                if Cint(DateDiff(\"d\", dateCtimeFolder, date)) >= Cint(strInputCtime) then\n                    objIE.Document.body.innerHTML = \"<b><font color=red>\u524a\u9664\u4e2d</font></b><br>\" & strDeleteFolder\n                    objFileSys.DeleteFolder strDeleteFolder, True\n                    Set strDeleteFolder = Nothing\n                End if\n            Next\n        End if\n    Next\n\n  Case vbNo\n    MsgBox \"\u30ad\u30e3\u30f3\u30bb\u30eb\u7d42\u4e86\"\n    WScript.Quit\n    \nEnd Select\n\n'----------------------------------------------------------\n' \u5f8c\u51e6\u7406\n'----------------------------------------------------------\nobjIE.Quit\n\nSet objFileSys = Nothing\n\nMsgBox \"\u7d42\u4e86\"\n```", "tags": ["VBScript"]}