{"context": " More than 1 year has passed since last update.\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d0\u30b0\u304c\u3042\u308b\u3068 Sinatra \u304c\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u3092\u8868\u793a\u3057\u3066\u304f\u308c\u308b\u306f\u305a\u306a\u306e\u3067\u3059\u304c\u3001\nWindows7 \u4e0a\u3067\n invalid byte sequence in Windows-31J\n\n\u3068\u3057\u304b\u30d6\u30e9\u30a6\u30b6\u306b\u8868\u793a\u3055\u308c\u305a\u306b\u56f0\u3063\u3066\u3044\u307e\u3057\u305f\u3002lib/rack/utis.rb \u306e\u4ee5\u4e0b\u306e\u30e1\u30bd\u30c3\u30c9\u5185\u3067\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u306f\u5206\u304b\u308a\u307e\u3059\u3002\ndef escape_html(string)\n  string.to_s.gsub(ESCAPE_HTML_PATTERN){|c| ESCAPE_HTML[c] }\nend\n\nconfig.ru \u306b\u3082 app.rb \u306b\u3082\n# coding: utf-8\n\n\u3092\u66f8\u3044\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3002\n\u3067\u3001\u771f\u9762\u76ee\u306b\u8abf\u3079\u305f\u3068\u3053\u308d\n> ruby -e 'puts Encoding.default_external'\nWindows-31J\n\n\u3068\u3044\u3046\u306e\u304c\u554f\u984c\u3063\u307d\u3044\u306e\u3067\u3001\u30b0\u30b0\u3063\u3066\u307f\u305f\u3089 http://d.hatena.ne.jp/yohfee/20100810/1281449589 \u3092\u767a\u898b\uff01 \u3053\u308c\u306b\u57fa\u3065\u3044\u3066 config.ru \u3092\n\nconfig.ru\n# coding: utf-8\n\nEncoding.default_external = 'utf-8'\n\nrequire File.dirname(__FILE__) + '/app.rb'\nApplication.run!\n\n\n\u3068\u3057\u305f\u3068\u3053\u308d\u3001\u4e0a\u624b\u304f\u3044\u304d\u307e\u3057\u305f\u3002\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30d0\u30b0\u304c\u3042\u308b\u3068 Sinatra \u304c\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u3092\u8868\u793a\u3057\u3066\u304f\u308c\u308b\u306f\u305a\u306a\u306e\u3067\u3059\u304c\u3001\nWindows7 \u4e0a\u3067\n\n<pre>\n invalid byte sequence in Windows-31J\n</pre>\n\n\u3068\u3057\u304b\u30d6\u30e9\u30a6\u30b6\u306b\u8868\u793a\u3055\u308c\u305a\u306b\u56f0\u3063\u3066\u3044\u307e\u3057\u305f\u3002lib/rack/utis.rb \u306e\u4ee5\u4e0b\u306e\u30e1\u30bd\u30c3\u30c9\u5185\u3067\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u306f\u5206\u304b\u308a\u307e\u3059\u3002\n\n```rb\ndef escape_html(string)\n  string.to_s.gsub(ESCAPE_HTML_PATTERN){|c| ESCAPE_HTML[c] }\nend\n```\n\nconfig.ru \u306b\u3082 app.rb \u306b\u3082\n\n<pre>\n# coding: utf-8\n</pre>\n\n\u3092\u66f8\u3044\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3002\n\n\u3067\u3001\u771f\u9762\u76ee\u306b\u8abf\u3079\u305f\u3068\u3053\u308d\n\n```ruby\n> ruby -e 'puts Encoding.default_external'\nWindows-31J\n```\n\n\u3068\u3044\u3046\u306e\u304c\u554f\u984c\u3063\u307d\u3044\u306e\u3067\u3001\u30b0\u30b0\u3063\u3066\u307f\u305f\u3089 http://d.hatena.ne.jp/yohfee/20100810/1281449589 \u3092\u767a\u898b\uff01 \u3053\u308c\u306b\u57fa\u3065\u3044\u3066 config.ru \u3092\n\n```ruby:config.ru\n# coding: utf-8\n\nEncoding.default_external = 'utf-8'\n\nrequire File.dirname(__FILE__) + '/app.rb'\nApplication.run!\n```\n\n\u3068\u3057\u305f\u3068\u3053\u308d\u3001\u4e0a\u624b\u304f\u3044\u304d\u307e\u3057\u305f\u3002", "tags": ["Ruby", "Sinatra", "Windows"]}