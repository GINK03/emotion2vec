{"tags": ["docker", "Lua", "nginx", "dokku"], "context": " More than 1 year has passed since last update.\n\n\u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u304b\u30891\u5e74\u4ee5\u4e0a\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002 \u6c17\u3092\u3064\u3051\u3066\u306d\u3002\n\nDokku\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u74b0\u5883\u3067\u306fNginx\u30c1\u30fc\u30e0\u304c\u4fdd\u5b88\u3059\u308bNginx1.6.x(stable)\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u304c\u5c0e\u5165\u3055\u308c\u308b\u3002\n\u3053\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u542b\u3081\u3001debian\u7cfb\u304c\u63d0\u4f9b\u3059\u308bnginx-extras\u306f\u3061\u3087\u3063\u3068\u3044\u3044\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u8ffd\u52a0\u3057\u3066\u30d3\u30eb\u30c9\u3057\u305fNginx\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3060\u3002\n\u7279\u306b\u6ce8\u76ee\u306fEmbedded Lua\u3002Spdy\u3082\u76ee\u7acb\u3064\u304c\u3053\u3061\u3089\u306f\u6a19\u6e96\u3067\u3082\u542b\u307e\u308c\u3066\u3044\u308b\u306e\u3067\u3002\n# apt-cache show nginx-extras\nPackage: nginx-extras\nSource: nginx\nPriority: extra\nSection: httpd\nInstalled-Size: 1465\nMaintainer: Kartik Mistry <kartik@debian.org>\nArchitecture: amd64\nVersion: 1.6.0-1+trusty0\n\n-- snip --\n\nDescription: nginx web/proxy server (extended version)\n Nginx (\"engine X\") is a high-performance web and reverse proxy server\n created by Igor Sysoev. It can be used both as a standalone web server\n and as a proxy to reduce the load on back-end HTTP or mail servers.\n .\n This package provides a version of nginx with the standard modules, plus\n extra features and modules such as the Perl module, which allows the\n addition of Perl in configuration files.\n .\n STANDARD HTTP MODULES: Core, Access, Auth Basic, Auto Index, Browser,\n Charset, Empty GIF, FastCGI, Geo, Gzip, Headers, Index, Limit Requests,\n Limit Zone, Log, Map, Memcached, Proxy, Referer, Rewrite, SCGI,\n Split Clients, SSI, Upstream, User ID, UWSGI.\n .\n OPTIONAL HTTP MODULES: Addition, Auth Request, Debug, Embedded Perl, FLV,\n GeoIP, Gzip Precompression, Image Filter, IPv6, MP4, Random Index, Real IP,\n Secure Link, Spdy, SSL, Stub Status, Substitution, WebDAV, XSLT.\n .\n MAIL MODULES: Mail Core, IMAP, POP3, SMTP, SSL.\n .\n THIRD PARTY MODULES: Auth PAM, Chunkin, DAV Ext, Echo, Embedded Lua,\n Fancy Index, HttpHeadersMore, HTTP Substitution Filter, http push,\n Nginx Development Kit, Upload Progress, Upstream Fair Queue.\nDescription-md5: a1852af8d0ef61a51df8e6cb9581d6a6\n\n\u3061\u306a\u307f\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30a2\u30fc\u30a6\u30a9\u30fc\u30eb\u304c\u4f7f\u3044\u305f\u3044\u5834\u5408\u3001nginx-naxsi(WAF for NGINX)\u3068\u3044\u3046\u306e\u3082\u3042\u308b\u3002\n\nnginx-extras 1.6.x\u306e\u5c0e\u5165\napt-get\u3067\u5165\u308c\u3088\u3046\u3002\n# apt-get install nginx-extras\nReading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nThe following extra packages will be installed:\n  liblua5.1-0 libperl5.18\nSuggested packages:\n  nginx-doc\nThe following packages will be REMOVED:\n  nginx-full\nThe following NEW packages will be installed:\n  liblua5.1-0 libperl5.18 nginx-extras\n0 upgraded, 3 newly installed, 1 to remove and 0 not upgraded.\nNeed to get 699 kB of archives.\nAfter this operation, 922 kB of additional disk space will be used.\n\n\u3053\u308c\u3060\u3051\u3067OK\u3002\n\n\u30b5\u30f3\u30d7\u30eb\n\u3067\u3001\u524d\u56de\u306eDokku\u3067\u30a2\u30d7\u30ea\u5225\u306e\u30ab\u30b9\u30bf\u30e0Nginx\u8a2d\u5b9a - Qiita \u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u3002\nnginx.inc.conf\u3092\u6b21\u306e\u3088\u3046\u306blua\u3067\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u8fd4\u3059\u3088\u3046\u306b\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\nnginx.inc.conf\nlocation = /lua {\n    default_type 'text/plain';\n\n    content_by_lua \"ngx.say('Hello,lua module!')\";\n}\n\n\nDokku\u306b\u30a2\u30d7\u30ea\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u3001/lua\u306b\u30a2\u30af\u30bb\u30b9\u3002\n$ curl -k https://sinatra-test.example.com/lua\nHello,lua module!\n\n\u3067\u304d\u305f\u3002\n$APP/ENV\u304b\u3089\u5024\u3092\u53d6\u308b\u3088\u3046\u306bnginx\u5185\u3067\u4ed5\u8fbc\u3081\u308c\u3070\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u3068\u3057\u3066\u4f7f\u3044\u3084\u3059\u304f\u306a\u308a\u305d\u3046\u3002\n\u8ffd\u8a18\uff1a\n\u3068\u308a\u3042\u3048\u305a\u306e\u304a\u52e7\u3081\u306f\u3001nginx.conf\u306benv DOKKU_ROOT=/home/dokku;\u3042\u305f\u308a\u3092\u66f8\u3044\u3066\u304a\u304f\u3068\u3088\u3055\u305d\u3046\u3002\n<!-- too_old -->\n> **\u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u304b\u30891\u5e74\u4ee5\u4e0a\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002** \u6c17\u3092\u3064\u3051\u3066\u306d\u3002\n\nDokku\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u74b0\u5883\u3067\u306fNginx\u30c1\u30fc\u30e0\u304c\u4fdd\u5b88\u3059\u308bNginx1.6.x(stable)\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u304c\u5c0e\u5165\u3055\u308c\u308b\u3002\n\u3053\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u542b\u3081\u3001debian\u7cfb\u304c\u63d0\u4f9b\u3059\u308b`nginx-extras`\u306f\u3061\u3087\u3063\u3068\u3044\u3044\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u8ffd\u52a0\u3057\u3066\u30d3\u30eb\u30c9\u3057\u305fNginx\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3060\u3002\n\n\u7279\u306b\u6ce8\u76ee\u306f`Embedded Lua`\u3002Spdy\u3082\u76ee\u7acb\u3064\u304c\u3053\u3061\u3089\u306f\u6a19\u6e96\u3067\u3082\u542b\u307e\u308c\u3066\u3044\u308b\u306e\u3067\u3002\n\n```\n# apt-cache show nginx-extras\nPackage: nginx-extras\nSource: nginx\nPriority: extra\nSection: httpd\nInstalled-Size: 1465\nMaintainer: Kartik Mistry <kartik@debian.org>\nArchitecture: amd64\nVersion: 1.6.0-1+trusty0\n\n-- snip --\n\nDescription: nginx web/proxy server (extended version)\n Nginx (\"engine X\") is a high-performance web and reverse proxy server\n created by Igor Sysoev. It can be used both as a standalone web server\n and as a proxy to reduce the load on back-end HTTP or mail servers.\n .\n This package provides a version of nginx with the standard modules, plus\n extra features and modules such as the Perl module, which allows the\n addition of Perl in configuration files.\n .\n STANDARD HTTP MODULES: Core, Access, Auth Basic, Auto Index, Browser,\n Charset, Empty GIF, FastCGI, Geo, Gzip, Headers, Index, Limit Requests,\n Limit Zone, Log, Map, Memcached, Proxy, Referer, Rewrite, SCGI,\n Split Clients, SSI, Upstream, User ID, UWSGI.\n .\n OPTIONAL HTTP MODULES: Addition, Auth Request, Debug, Embedded Perl, FLV,\n GeoIP, Gzip Precompression, Image Filter, IPv6, MP4, Random Index, Real IP,\n Secure Link, Spdy, SSL, Stub Status, Substitution, WebDAV, XSLT.\n .\n MAIL MODULES: Mail Core, IMAP, POP3, SMTP, SSL.\n .\n THIRD PARTY MODULES: Auth PAM, Chunkin, DAV Ext, Echo, Embedded Lua,\n Fancy Index, HttpHeadersMore, HTTP Substitution Filter, http push,\n Nginx Development Kit, Upload Progress, Upstream Fair Queue.\nDescription-md5: a1852af8d0ef61a51df8e6cb9581d6a6\n```\n\n\n\u3061\u306a\u307f\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30a2\u30fc\u30a6\u30a9\u30fc\u30eb\u304c\u4f7f\u3044\u305f\u3044\u5834\u5408\u3001nginx-naxsi(WAF for NGINX)\u3068\u3044\u3046\u306e\u3082\u3042\u308b\u3002\n\n## nginx-extras 1.6.x\u306e\u5c0e\u5165\n\n`apt-get`\u3067\u5165\u308c\u3088\u3046\u3002\n\n```\n# apt-get install nginx-extras\nReading package lists... Done\nBuilding dependency tree       \nReading state information... Done\nThe following extra packages will be installed:\n  liblua5.1-0 libperl5.18\nSuggested packages:\n  nginx-doc\nThe following packages will be REMOVED:\n  nginx-full\nThe following NEW packages will be installed:\n  liblua5.1-0 libperl5.18 nginx-extras\n0 upgraded, 3 newly installed, 1 to remove and 0 not upgraded.\nNeed to get 699 kB of archives.\nAfter this operation, 922 kB of additional disk space will be used.\n```\n\n\u3053\u308c\u3060\u3051\u3067OK\u3002\n\n## \u30b5\u30f3\u30d7\u30eb\n\n\u3067\u3001\u524d\u56de\u306e[Dokku\u3067\u30a2\u30d7\u30ea\u5225\u306e\u30ab\u30b9\u30bf\u30e0Nginx\u8a2d\u5b9a - Qiita](http://qiita.com/sawanoboly/items/614f81c13ceadb9a3cff \"Dokku\u3067\u30a2\u30d7\u30ea\u5225\u306e\u30ab\u30b9\u30bf\u30e0Nginx\u8a2d\u5b9a - Qiita\") \u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u3002\n\n`nginx.inc.conf`\u3092\u6b21\u306e\u3088\u3046\u306blua\u3067\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u8fd4\u3059\u3088\u3046\u306b\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\n\n```nginx.inc.conf\nlocation = /lua {\n    default_type 'text/plain';\n    \n    content_by_lua \"ngx.say('Hello,lua module!')\";\n}\n```\n\nDokku\u306b\u30a2\u30d7\u30ea\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u3001`/lua`\u306b\u30a2\u30af\u30bb\u30b9\u3002\n\n```\n$ curl -k https://sinatra-test.example.com/lua\nHello,lua module!\n```\n\n\u3067\u304d\u305f\u3002\n\n\n`$APP/ENV`\u304b\u3089\u5024\u3092\u53d6\u308b\u3088\u3046\u306bnginx\u5185\u3067\u4ed5\u8fbc\u3081\u308c\u3070\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u3068\u3057\u3066\u4f7f\u3044\u3084\u3059\u304f\u306a\u308a\u305d\u3046\u3002\n\n\u8ffd\u8a18\uff1a\n\u3068\u308a\u3042\u3048\u305a\u306e\u304a\u52e7\u3081\u306f\u3001`nginx.conf`\u306b`env DOKKU_ROOT=/home/dokku;`\u3042\u305f\u308a\u3092\u66f8\u3044\u3066\u304a\u304f\u3068\u3088\u3055\u305d\u3046\u3002\n"}