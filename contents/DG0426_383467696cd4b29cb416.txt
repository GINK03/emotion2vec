{"context": "\u524d\u56de\u306e\u6295\u7a3f\uff08GitLab on docker \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3092\u3057\u3066\u307f\u305f\uff09\u3067GitLab\u306eversion\u304c8.3.0\u306b\u306a\u3063\u305f\u306e\u3067\u3001CI\u6a5f\u80fd\u3092\u89e6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u203bGitLab\u306f\u4ee5\u524dCI\u30b5\u30fc\u30d0\u30fc\u3092\u5225\u9014\u7528\u610f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u304c\u30018.0\u4ee5\u964dCI\u6a5f\u80fd\u304c\u672c\u4f53\u306b\u30de\u30fc\u30b8\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u74b0\u5883\n\u30db\u30b9\u30c8\u306eCentOS\u306bVirtualBox\u3067Ubuntu\u3092\u4f5c\u6210\u3057\u3001\u305d\u306e\u4e2d\u306bdocker\u3092\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\nHostOS: CentOS release 6.5\nGuestOS: Ubuntu 14.04 LTS\ndocker version: 1.9.1\ndocker container\n\n\ngitlab\npostgresql\nredis\n\n\n\n\n\u4f5c\u696d\n\u4eca\u56de\u3082sameersbn@Github\u3055\u3093\u306b\u304a\u4e16\u8a71\u306b\u306a\u308a\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nGitLab\u306b\u3064\u3044\u3066\u306f\u524d\u8ff0\u3057\u305f\u300cGitLab on docker \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3092\u3057\u3066\u307f\u305f\u300d\u3092\u4f7f\u7528\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\ndocker pull\n\u5148\u306b\u5fc5\u8981\u306adocker\u30a4\u30e1\u30fc\u30b8\u3092pull\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n$ sudo docker pull [REPOSITORY]:[TAG]\n$ sudo docker images | grep gitlab-ci-runner\nREPOSITORY             TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nsameersbn/gitlab-ci-runner   5.2.1               e51ef07f6f1f        12 months ago       350.4 MB\n\n\nCI\u6642\u306b\u4f7f\u7528\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\n$ mkdir -p /opt/gitlab-ci-runner\n\n\nGitLab\u4e0a\u306bCI\u3092\u884c\u3046\u305f\u3081\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\u4eca\u56de\u306f\u30b7\u30f3\u30d7\u30eb\u306b\u69cb\u6210\u3057\u307e\u3059\u3002\nsample.py\u306fpy.test\u7528\u306b\u6c5a\u3044\u30b3\u30fc\u30c9\u3068\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\npython-ci-sample\n\n\ntest\n\n\nsample.py\n\n\n.gitlab-ci.yml\n\n\n\n\ntest/sample.py\n\n\nimport os\nimport sys\n\n\nclass A(object): pass\n\n\ndef func(x, y = 2):\n    return x, y\n\ndef main():\n    l = [1,2, 3, 4, 5]\n    d = {'a': 1, 'b': 2}\n\nif __name__ == \"__main__\":\n    main()\n\n\n\n.gitlab-ci.yml\njob1:\n  script: echo \"Hello CI!\"\n\njob2:\n  script: pwd; cat /etc/lsb-release\n\njob3:\n  script: pep8 test/sample.py\n\njob4:\n  script: py.test --pep8 test/sample.py\n\n\n\nCI-Runner\u3068\u306e\u9023\u643a\u6e96\u5099\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSettings => Runners\u3092\u62bc\u4e0b\u3059\u308b\u3068\u3001\u300cSpecific runners\u300d\u3068\u3044\u3046\u9805\u76ee\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u3053\u3053\u306eURL\u3068token\u3092\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\u7d9a\u3044\u3066\u3001docker\u304c\u8d77\u52d5\u3057\u3066\u3044\u308bServer\u306bin\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306a\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3061\u307e\u3059\u3002\n\u203bURL, token, \u30de\u30a6\u30f3\u30c8\u5148\u306f\u9069\u5b9c\u66f8\u304d\u63db\u3048\u3066\u4e0b\u3055\u3044\u3002\n\nsetup.sh\n#!/bin/bash\n\nCI_SERVER_URL=\"\u4e0a\u8a18\u306eURL\"\nREGISTRATION_TOKEN=\"\u4e0a\u8a18\u306etoken\"\n\n## SETUP\ndocker run --name gitlab-ci-runner -it --rm \\\n -v /opt/gitlab-ci-runner:/home/gitlab_ci_runner/data \\\n --env CI_SERVER_URL=${CI_SERVER_URL} \\\n --env REGISTRATION_TOKEN=${REGISTRATION_TOKEN} \\\n sameersbn/gitlab-ci-runner:5.2.1 app:setup\n\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSettings => Runners\u306b\u300cRunners activated for this project\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u3067\u9023\u643a\u306e\u6e96\u5099\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\nCI\u5b9f\u884c\n\u307e\u305a\u306f\u5148\u307b\u3069\u8a2d\u5b9a\u3057\u305frunnner\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u203brunner\u306b\u306f\u4e88\u3081pep8\u3084pytest\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u307e\u3059\u3002\n\nrun.sh\n#!/bin/bash\n\nCI_SERVER_URL=\"\u4e0a\u8a18\u306eURL\"\nREGISTRATION_TOKEN=\"\u4e0a\u8a18\u306etoken\"\n\n## RUN\ndocker run --name gitlab-ci-runner -it --rm \\\n -v /opt/gitlab-ci-runner:/home/gitlab_ci_runner/data \\\n --env CI_SERVER_URL=${CI_SERVER_URL} \\\n --env REGISTRATION_TOKEN=${REGISTRATION_TOKEN} \\\n sameersbn/gitlab-ci-runner:5.2.1\n\n\n\u3053\u308c\u3067.gitlab-ci.yml \u306b\u8a18\u8f09\u3055\u308c\u305f\u5185\u5bb9\u3067CI\u304c\u8d70\u308a\u307e\u3059\u3002\n\n\u7d50\u679c\u78ba\u8a8d\nGitLab\u30d7\u30ed\u30b8\u30a7\u30af\u30c8 => Builds\u3092\u62bc\u4e0b\u3057\u3066\u4e0b\u3055\u3044\u3002\nRunning\u30bf\u30d6\u306b4\u7a2e\u985e\u306ejob\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\uff08\u4eca\u56de\u306f\u7c21\u5358\u306a\u3082\u306e\u306a\u306e\u3067\u3001\u3059\u3050\u306bFinished\u30bf\u30d6\u306b\u79fb\u52d5\u3057\u3066\u3057\u307e\u3046\u3068\u601d\u3044\u307e\u3059\u3002\uff09\n\u4e0b\u8a18\u306f\u53c2\u8003\u753b\u50cf\u3067\u3059\uff08job\u304c\u7570\u306a\u308a\u307e\u3059\u304c\u3001\u4e0a\u8a18job4\u306e\u7d50\u679c\u3068\u540c\u3058\u3082\u306e\u306b\u306a\u308a\u307e\u3059\uff09\n\n\n\u304a\u308f\u308a\u306b\nGitLab-CI\u304c\u624b\u8efd\u306b\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u307e\u3060\u307e\u3060\u6a5f\u80fd\u5168\u822c\u3092\u628a\u63e1\u3067\u304d\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u3044\u308d\u3044\u308d\u8a66\u3057\u3066\u307f\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\u3067\u304d\u308c\u3070\u65e2\u5b58\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u4f7f\u3063\u3066\u307f\u305f\u3044\u306a\uff5e\uff08\u9060\u3044\u76ee\uff09\n\n\u53c2\u8003\u30ea\u30f3\u30af\nGitLab Documentation / docker\nGitLab Documentation / quick_start\nGitLab Documentation / yaml\nGitLab.org / GitLab CI Runner\nGitLab.org / omnibus-gitlab-runner\nsameersbn/docker-gitlab-ci-runner\npytest \u3067 pep8 \u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b\n\n\u524d\u56de\u306e\u6295\u7a3f\uff08[GitLab on docker \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3092\u3057\u3066\u307f\u305f](http://qiita.com/DG0426/items/28b205901fca9eaff80a)\uff09\u3067GitLab\u306eversion\u304c8.3.0\u306b\u306a\u3063\u305f\u306e\u3067\u3001CI\u6a5f\u80fd\u3092\u89e6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u203bGitLab\u306f\u4ee5\u524dCI\u30b5\u30fc\u30d0\u30fc\u3092\u5225\u9014\u7528\u610f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u304c\u30018.0\u4ee5\u964dCI\u6a5f\u80fd\u304c\u672c\u4f53\u306b\u30de\u30fc\u30b8\u3055\u308c\u307e\u3057\u305f\u3002\n\n# \u74b0\u5883\n\u30db\u30b9\u30c8\u306eCentOS\u306bVirtualBox\u3067Ubuntu\u3092\u4f5c\u6210\u3057\u3001\u305d\u306e\u4e2d\u306bdocker\u3092\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\n* HostOS: CentOS release 6.5\n* GuestOS: Ubuntu 14.04 LTS\n* docker version: 1.9.1\n* docker container\n  * gitlab\n  * postgresql\n  * redis\n\n# \u4f5c\u696d\n\u4eca\u56de\u3082[sameersbn@Github](https://github.com/sameersbn)\u3055\u3093\u306b\u304a\u4e16\u8a71\u306b\u306a\u308a\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nGitLab\u306b\u3064\u3044\u3066\u306f\u524d\u8ff0\u3057\u305f\u300c[GitLab on docker \u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3092\u3057\u3066\u307f\u305f](http://qiita.com/DG0426/items/28b205901fca9eaff80a)\u300d\u3092\u4f7f\u7528\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\n## docker pull \n\u5148\u306b\u5fc5\u8981\u306adocker\u30a4\u30e1\u30fc\u30b8\u3092pull\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```shell-session\n$ sudo docker pull [REPOSITORY]:[TAG]\n$ sudo docker images | grep gitlab-ci-runner\nREPOSITORY             TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nsameersbn/gitlab-ci-runner   5.2.1               e51ef07f6f1f        12 months ago       350.4 MB\n```\n\n## CI\u6642\u306b\u4f7f\u7528\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\n\n```shell-session\n$ mkdir -p /opt/gitlab-ci-runner\n```\n\n## GitLab\u4e0a\u306bCI\u3092\u884c\u3046\u305f\u3081\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\n\u4eca\u56de\u306f\u30b7\u30f3\u30d7\u30eb\u306b\u69cb\u6210\u3057\u307e\u3059\u3002\nsample.py\u306fpy.test\u7528\u306b\u6c5a\u3044\u30b3\u30fc\u30c9\u3068\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\n - python-ci-sample\n   - test\n     - sample.py\n   - .gitlab-ci.yml\n\n```py:test/sample.py\n\n\nimport os\nimport sys\n\n\nclass A(object): pass\n\n\ndef func(x, y = 2):\n    return x, y\n\ndef main():\n    l = [1,2, 3, 4, 5]\n    d = {'a': 1, 'b': 2}\n\nif __name__ == \"__main__\":\n    main()\n```\n\n```yaml:.gitlab-ci.yml\njob1:\n  script: echo \"Hello CI!\"\n\njob2:\n  script: pwd; cat /etc/lsb-release\n\njob3:\n  script: pep8 test/sample.py\n\njob4:\n  script: py.test --pep8 test/sample.py\n```\n\n## CI-Runner\u3068\u306e\u9023\u643a\u6e96\u5099\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSettings => Runners\u3092\u62bc\u4e0b\u3059\u308b\u3068\u3001\u300cSpecific runners\u300d\u3068\u3044\u3046\u9805\u76ee\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u3053\u3053\u306eURL\u3068token\u3092\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u7d9a\u3044\u3066\u3001docker\u304c\u8d77\u52d5\u3057\u3066\u3044\u308bServer\u306bin\u3057\u3066\u3001\u6b21\u306e\u3088\u3046\u306a\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3061\u307e\u3059\u3002\n\u203bURL, token, \u30de\u30a6\u30f3\u30c8\u5148\u306f\u9069\u5b9c\u66f8\u304d\u63db\u3048\u3066\u4e0b\u3055\u3044\u3002\n\n```shell-session:setup.sh\n#!/bin/bash\n\nCI_SERVER_URL=\"\u4e0a\u8a18\u306eURL\"\nREGISTRATION_TOKEN=\"\u4e0a\u8a18\u306etoken\"\n\n## SETUP\ndocker run --name gitlab-ci-runner -it --rm \\\n -v /opt/gitlab-ci-runner:/home/gitlab_ci_runner/data \\\n --env CI_SERVER_URL=${CI_SERVER_URL} \\\n --env REGISTRATION_TOKEN=${REGISTRATION_TOKEN} \\\n sameersbn/gitlab-ci-runner:5.2.1 app:setup\n```\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSettings => Runners\u306b\u300cRunners activated for this project\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u3067\u9023\u643a\u306e\u6e96\u5099\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n## CI\u5b9f\u884c\n\n\u307e\u305a\u306f\u5148\u307b\u3069\u8a2d\u5b9a\u3057\u305frunnner\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u203brunner\u306b\u306f\u4e88\u3081pep8\u3084pytest\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u307e\u3059\u3002\n\n```shell-session:run.sh\n#!/bin/bash\n\nCI_SERVER_URL=\"\u4e0a\u8a18\u306eURL\"\nREGISTRATION_TOKEN=\"\u4e0a\u8a18\u306etoken\"\n\n## RUN\ndocker run --name gitlab-ci-runner -it --rm \\\n -v /opt/gitlab-ci-runner:/home/gitlab_ci_runner/data \\\n --env CI_SERVER_URL=${CI_SERVER_URL} \\\n --env REGISTRATION_TOKEN=${REGISTRATION_TOKEN} \\\n sameersbn/gitlab-ci-runner:5.2.1\n```\n\n\u3053\u308c\u3067.gitlab-ci.yml \u306b\u8a18\u8f09\u3055\u308c\u305f\u5185\u5bb9\u3067CI\u304c\u8d70\u308a\u307e\u3059\u3002\n\n## \u7d50\u679c\u78ba\u8a8d\n\nGitLab\u30d7\u30ed\u30b8\u30a7\u30af\u30c8 => Builds\u3092\u62bc\u4e0b\u3057\u3066\u4e0b\u3055\u3044\u3002\n\nRunning\u30bf\u30d6\u306b4\u7a2e\u985e\u306ejob\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\uff08\u4eca\u56de\u306f\u7c21\u5358\u306a\u3082\u306e\u306a\u306e\u3067\u3001\u3059\u3050\u306bFinished\u30bf\u30d6\u306b\u79fb\u52d5\u3057\u3066\u3057\u307e\u3046\u3068\u601d\u3044\u307e\u3059\u3002\uff09\n\n\u4e0b\u8a18\u306f\u53c2\u8003\u753b\u50cf\u3067\u3059\uff08job\u304c\u7570\u306a\u308a\u307e\u3059\u304c\u3001\u4e0a\u8a18job4\u306e\u7d50\u679c\u3068\u540c\u3058\u3082\u306e\u306b\u306a\u308a\u307e\u3059\uff09\n\n![gitlab-ci-sample.png](https://qiita-image-store.s3.amazonaws.com/0/58725/1bafac3e-3c07-3be9-7407-8fe9ad393d5a.png)\n\n## \u304a\u308f\u308a\u306b\n\nGitLab-CI\u304c\u624b\u8efd\u306b\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u307e\u3060\u307e\u3060\u6a5f\u80fd\u5168\u822c\u3092\u628a\u63e1\u3067\u304d\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u3044\u308d\u3044\u308d\u8a66\u3057\u3066\u307f\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\u3067\u304d\u308c\u3070\u65e2\u5b58\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u4f7f\u3063\u3066\u307f\u305f\u3044\u306a\uff5e\uff08\u9060\u3044\u76ee\uff09\n\n# \u53c2\u8003\u30ea\u30f3\u30af\n\n[GitLab Documentation / docker](http://doc.gitlab.com/ce/ci/docker/using_docker_images.html)\n[GitLab Documentation / quick_start](http://doc.gitlab.com/ce/ci/quick_start/README.html)\n[GitLab Documentation / yaml](http://doc.gitlab.com/ce/ci/yaml/README.html)\n[GitLab.org / GitLab CI Runner](https://gitlab.com/gitlab-org/gitlab-ci-runner)\n[GitLab.org / omnibus-gitlab-runner](https://gitlab.com/gitlab-org/omnibus-gitlab-runner/blob/master/doc/build/README.md)\n[sameersbn/docker-gitlab-ci-runner](https://github.com/sameersbn/docker-gitlab-ci-runner)\n[pytest \u3067 pep8 \u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3059\u308b](http://dev.ariel-networks.com/wp/archives/2491)\n", "tags": ["docker", "GitLab", "GitLab-CI"]}