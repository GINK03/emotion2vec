{"context": " More than 1 year has passed since last update.\u30a2\u30f3\u30d3\u30ea\u30fc\u30d0\u30dc\uff1f\u30a2\u30f3\u30d3\u30ea\u30d0\u30dc\u30fc\uff1f\nhttp://rashita.net/blog/?p=16722\n\u3053\u3061\u3089\u306e2\u3064\u76ee\u3001\u300c\u62e1\u5f35\u578b\u30ce\u30fc\u30c8\u30ea\u30f3\u30af\u300d\u3068\u66f8\u304b\u308c\u305f\u6a5f\u80fd\u3092AppleScript\u3067\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\n\n\u4f7f\u3044\u65b9\uff08\u57fa\u790e\u7de8\uff09\nEvernote\u306e\u30ce\u30fc\u30c8\u4e0a\u3067\u5f15\u7528\u3057\u305f\u3044\u7b87\u6240\u3092\u9078\u629e\u72b6\u614b\u306b\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089citation\u3092\u5b9f\u884c\u3059\u308b\u3068\n\n\u300cCopied\u300d\u3068\u901a\u77e5\u3002\n\n\u597d\u304d\u306a\u3068\u3053\u308d\u3067\u30da\u30fc\u30b9\u30c8\u3059\u308c\u3070\u3001\u305d\u308c\u3063\u307d\u3044\u898b\u305f\u76ee\u306e\u30ce\u30fc\u30c8\u30ea\u30f3\u30af\u3002\n\n\n\u4f7f\u3044\u65b9\uff08\u5fdc\u7528\u7de8\uff09\n\u30b9\u30af\u30ea\u30d7\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u3063\u3066\u4ed6\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3082\u62e1\u5f35\u3067\u304d\u307e\u3059\u3002\n\u4f8b\u3048\u3070Safari\u306e\u5834\u5408\u3002\u30da\u30fc\u30b8\u4e0a\u3067\u5f15\u7528\u90e8\u5206\u3092\u9078\u629e\u3057\u3066citation\u3092\u5b9f\u884c\u3002\n\nEvernote\u306b\u30da\u30fc\u30b9\u30c8\u3067\u5f15\u7528\u6587\u3092\u542b\u3093\u3060\u30ea\u30f3\u30af\u306b\u3002\u753b\u50cf\u306f\u53cd\u6620\u3055\u308c\u307e\u305b\u3093\u3002\n\n\u4eca\u306e\u3068\u3053\u308dEvernote\u3068Safari\u306e2\u7a2e\u985e\u306e\u307f\u3067\u3059\u3002\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u3044\u3058\u3063\u3066\u4ed6\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u30ea\u30f3\u30af\u306e\u8272\u3092\u5909\u3048\u308b\u306a\u308a\u3001\u30a2\u30a4\u30b3\u30f3\u3092\u4ed8\u3051\u308b\u306a\u308a\u3057\u306a\u3044\u3068\u898b\u5206\u3051\u304c\u3064\u304d\u307e\u305b\u3093\u304c\u3001\u305d\u308c\u306f\u307e\u305f\u5225\u306e\u6a5f\u4f1a\u306b\u3002\n\n(2015-12-18 \u8ffd\u8a18) \u4f7f\u3044\u65b9\uff08\u767a\u5c55\u7de8\uff09\nHTML\u3092\u7406\u89e3\u3067\u304d\u308b\u65b9\u306b\u30aa\u30b9\u30b9\u30e1\u3002\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u5192\u982d\u306b\u3042\u308bproperty citationTemplate : ...\u306e\u90e8\u5206\u3067\u3001\u8cbc\u308a\u4ed8\u3051\u308b\u30ea\u30f3\u30af\u306e\u898b\u305f\u76ee\u3092\u6c7a\u3081\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3001\u898b\u308c\u3070\u308f\u304b\u308b\u3088\u3046\u306bHTML\u3067\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\n\u5143\u306e\u307e\u307e\u3067\u306f\u7121\u99c4\u306a\u60c5\u5831\u304c\u591a\u3044\n\u6587\u5b57\u3084\u30ea\u30f3\u30af\u306e\u5927\u304d\u3055\u3084\u8272\u3001\u9806\u756a\u304c\u6c17\u306b\u304f\u308f\u306a\u3044\n\u5f15\u7528\u306fblockquote\u3058\u3083\u306a\u3044\u3068\u6c17\u6301\u3061\u60aa\u3044\n\n\u306a\u3093\u3066\u65b9\u306fHTML\u3092\u3044\u3058\u3063\u3066\u81ea\u5206\u597d\u307f\u306e\u898b\u305f\u76ee\u306b\u5909\u66f4\u3057\u307e\u3057\u3087\u3046\u3002\n\u305d\u306e\u969b\u306b\u6ce8\u610f\u3059\u3079\u304d\u3053\u3068\u3068\u3057\u3066 \u7279\u6b8a\u6587\u5b57\u306e\u53d6\u308a\u6271\u3044 \u304c\u3042\u308a\u307e\u3059\u3002\nproperty citationTemplate : ...\u306e\u90e8\u5206\u3067\u306fHTML\u5168\u4f53\u3092\u6587\u5b57\u5217\u3068\u3057\u3066citationTemplate\u3068\u3044\u3046\u5909\u6570\u306b\u5165\u308c\u308b\u305f\u3081\u3001\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3(\")\u3067\u56f2\u3063\u3066\u3044\u307e\u3059\u3002\nHTML\u5185\u3067\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3(\")\u3092\u4f7f\u3046\u3068\u3001\u305d\u3053\u304c\u6587\u5b57\u5217\u306e\u7d42\u308f\u308a\u3068\u5224\u65ad\u3055\u308c\u3066\u300c\u6b8b\u308a\u306e\u6587\u5b57\u5217\u306f\u306a\u3093\u3060\uff1f\u300d\u3063\u3066\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001\u30a8\u30b9\u30b1\u30fc\u30d7\u306e\u305f\u3081\u306b\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5(\\)\u3092\u524d\u306b\u7f6e\u3044\u3066\u3001\\\"\u3068\u8a18\u8ff0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u3046\u3059\u308c\u3070\u30a8\u30e9\u30fc\u306f\u51fa\u306a\u3044\u306f\u305a\u3002\n\u4ed6\u306b\u3082\u3064\u307e\u305a\u304f\u3053\u3068\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001Google\u306b\u983c\u308a\u306a\u304c\u3089\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u52d5\u4f5c\u74b0\u5883\n\nMac OS X: 10.11\nEvernote: ver 6.3 (452832 Direct)\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\ncitation.scpt\n(*\n* [[Clipping]]: \u5f15\u7528\u5185\u5bb9 - getClipping()\n* [[Link]]: \u30ea\u30f3\u30afURL - getLink()\n* [[Title]]: \u30ea\u30f3\u30af\u30bf\u30a4\u30c8\u30eb - getTitle()\n* [[Author]]: \u4f5c\u8005 - getAuthor()\n* [[Publisher]]: \u51fa\u7248\u793e\u3001\u767a\u884c\u5143 - getPublisher()\n* [[Date]]: \u65e5\u4ed8 - getDate()\n*)\nproperty citationTemplate : \"<br>\n<div class='citation' style='padding: 0px 30px;'>\n    <div class='clipping' style='line-height:18px; padding: 8px 15px; border-left:2px solid #dedede; color: #919191; font-family: Helvetica, sans-serif; font-style: italic; font-size: 14px;'>[[Clipping]]</div>\n    <div style='padding-left: 17px;'>\n        <div class='title' style='color: #000000; font-family: Helvetica, sans-serif; font-size: 14px; margin-top: 19px;'>\n            <a style='text-decoration: none; color: rgba(45,190,96,1.0);' href='[[Link]]'>\n                &quot;[[Title]]&quot;\n            </a>\n        </div>\n        <div style='color: #919191; font-size: 12px; margin-top: 4px; font-family: 'CaeciliaLTStd', serif; font-style: italic;'>\n            <span class='author'>[[Author]]</span>\n            <span class='publisher'>[[Publisher]].</span>\n            <span class='date'>[[Date]]</span>\n        </div>\n    </div>\n</div>\n<br>\"\n\non run\n\n    --\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5224\u5225\n    if application \"Evernote\" is running and application \"Evernote\" is frontmost then\n        set curApp to make Evernote\n    else if application \"Safari\" is running and application \"Safari\" is frontmost then\n        set curApp to make Safari\n    else\n        --set curApp to make some_application\n        error\n    end if\n\n    --citation\u306eHTML\u4f5c\u6210\n    copy citationTemplate to citation\n    repeat with replacement in {\u00ac\n        {\"[[Clipping]]\", getClipping() of curApp}, \u00ac\n        {\"[[Link]]\", getLink() of curApp}, \u00ac\n        {\"[[Title]]\", getTitle() of curApp}, \u00ac\n        {\"[[Author]]\", getAuthor() of curApp}, \u00ac\n        {\"[[Publisher]]\", getPublisher() of curApp}, \u00ac\n        {\"[[Date]]\", getDate() of curApp} \u00ac\n            }\n        set {f, r} to replacement\n        set r to my escapeHTMLSpecialChars(r)\n        set r to my replace(r, {return, linefeed}, \"<br>\")\n        set citation to my replace(citation, f, r)\n    end repeat\n\n    --HTML\u3092\u30b3\u30d4\u30fc\n    my copyHTML(citation)\n    display notification getTitle() of curApp with title \"Copied\"\nend run\n\nscript some_application\n\n    on getClipping()\n        repeat until application id (my appID) is frontmost\n            activate application id (my appID)\n        end repeat\n        set the clipboard to \"\"\n        set tmpClipboard to the clipboard as record\n        tell application \"System Events\"\n            keystroke \"c\" using {command down}\n            set timestamp to current date\n            repeat while (the clipboard as record) = tmpClipboard\n                if (current date) > timestamp + 10 then\n                    error\n                end if\n                delay 1\n            end repeat\n        end tell\n        return the clipboard as text\n    end getClipping\n\n    on getLink()\n        return \"\"\n    end getLink\n\n    on getTitle()\n        return \"\"\n    end getTitle\n\n    on getAuthor()\n        return \"\"\n    end getAuthor\n\n    on getPublisher()\n        return \"\"\n    end getPublisher\n\n    on getDate()\n        return \"\"\n    end getDate\n\n    on make\n        set a_class to me\n        script Instance\n            property parent : a_class\n            property appID : run script \"tell application \\\"System Events\\\" to return bundle identifier of process 1 whose frontmost = true and visible = true\"\n        end script\n    end make\nend script\n\nscript Evernote\n    property parent : some_application\n\n    --on getClipping()\n    --  continue getClipping()\n    --end getClipping\n\n    on getLink()\n        tell application \"Evernote\"\n            return note link of (note id (my noteID)) of notebook 1\n        end tell\n    end getLink\n\n    on getTitle()\n        tell application \"Evernote\"\n            return title of (note id (my noteID)) of notebook 1\n        end tell\n    end getTitle\n\n    on getAuthor()\n        tell application \"Evernote\"\n            set noteAuthor to author of (note id (my noteID)) of notebook 1\n        end tell\n        if noteAuthor = missing value then\n            set noteAuthor to \"\"\n        end if\n        return noteAuthor\n    end getAuthor\n\n    on getPublisher()\n        tell application \"Evernote\"\n            return name of notebook of (note id (my noteID)) of notebook 1\n        end tell\n    end getPublisher\n\n    on getDate()\n        tell application \"Evernote\"\n            tell creation date of (note id (my noteID)) of notebook 1 as date\n                return \"\" & year & \"\u5e74\" & (month of it as number) & \"\u6708\" & day & \"\u65e5\"\n            end tell\n        end tell\n    end getDate\n\n    on make\n        set self to continue make\n        script EvernoteInstance\n            property parent : self\n            property noteID : run script \"tell application \\\"Evernote\\\" to return local id of item 1 of (selection as list)\"\n        end script\n    end make\nend script\n\nscript Safari\n    property parent : some_application\n\n    on getClipping()\n        tell application \"Safari\"\n            set clipping to do JavaScript \"document.getSelection().toString();\" in current tab of window id (my windowID)\n        end tell\n        if clipping = \"\" then\n            try\n                set clipping to my extractText(my metas, linefeed & \"og:description,\", linefeed)\n            on error number -2700\n            end try\n        end if\n        return clipping\n    end getClipping\n\n    on getLink()\n        try\n            return my extractText(my metas, linefeed & \"og:url,\", linefeed)\n        on error number -2700\n        end try\n        tell application \"Safari\"\n            return URL of current tab of window id (my windowID)\n        end tell\n    end getLink\n\n    on getTitle()\n        try\n            return my extractText(my metas, linefeed & \"og:title,\", linefeed)\n        on error number -2700\n        end try\n        tell application \"Safari\"\n            return name of current tab of window id (my windowID)\n        end tell\n    end getTitle\n\n    on getAuthor()\n        try\n            return my extractText(my metas, linefeed & \"twitter:creator,\", linefeed)\n        on error number -2700\n        end try\n        return \"\"\n    end getAuthor\n\n    on getPublisher()\n        try\n            return my extractText(my metas, linefeed & \"og:site_name,\", linefeed)\n        on error number -2700\n        end try\n        return \"\"\n    end getPublisher\n\n    on getDate()\n        try\n            set ISODate to my extractText(my metas, linefeed & \"article:published_time,\", linefeed)\n            tell my ISODateToDate(ISODate)\n                return \"\" & year & \"\u5e74\" & (month of it as number) & \"\u6708\" & day & \"\u65e5\"\n            end tell\n        on error number -2700\n        end try\n        return \"\"\n    end getDate\n\n    on make\n        set self to continue make\n        script SafariInstance\n            property parent : self\n            property windowID : run script \"tell application \\\"Safari\\\" to return id of window 1 whose current tab \u2260 missing value\"\n            property metas : run script \"tell application \\\"Safari\\\" to return do JavaScript \\\"var ary=[]; var elements=document.getElementsByTagName('meta'); for(i=0; i<elements.length; i++) {content=elements[i].getAttribute('content'); if(elements[i].getAttribute('property')) {ary.push(elements[i].getAttribute('property') + ',' + elements[i].getAttribute('content'));} else if(elements[i].getAttribute('name')) {ary.push(elements[i].getAttribute('name') + ',' + elements[i].getAttribute('content'));}} '\\\\\\\\n' + ary.join('\\\\\\\\n') + '\\\\\\\\n';\\\" in current tab of window id \" & windowID\n        end script\n    end make\nend script\n\non escapeHTMLSpecialChars(args)\n    if class of args = list then\n        repeat with i from 1 to count args\n            set item i of args to my escapeHTMLSpecialChars(item i of args)\n        end repeat\n    else\n        set args to my replace(args, \"&\", \"&amp;\")\n        set args to my replace(args, \"<\", \"&lt;\")\n        set args to my replace(args, \">\", \"&gt;\")\n        set args to my replace(args, quote, \"&quot;\")\n        set args to my replace(args, \"'\", \"&#039;\")\n    end if\n    return args\nend escapeHTMLSpecialChars\n\non replace(str as text, find, replace as text)\n    set oldDel to AppleScript's text item delimiters\n    set AppleScript's text item delimiters to find\n    set replaceList to text items of str\n    set AppleScript's text item delimiters to replace\n    set str to replaceList as string\n    set AppleScript's text item delimiters to oldDel\n    return str\nend replace\n\non copyHTML(HTML as text)\n    set the clipboard to {\u00abclass utf8\u00bb:HTML, string:HTML, Unicode text:HTML, \u00abclass HTML\u00bb:my htmlToRawData(HTML)}\nend copyHTML\n\non extractText(theText, beginText, endText)\n    --beginText, endText\u4f8b: {text:\"a\", forwardSearch:false, containText:true}\n    set beginText to (beginText as record) & {forwardSearch:true, containText:false}\n    set endText to (endText as record) & {forwardSearch:true, containText:false}\n\n    if theText does not contain text of beginText or theText does not contain text of endText then error \"\u5f15\u6570\u306e\u6587\u5b57\u5217\u304c\u542b\u307e\u308c\u307e\u305b\u3093\"\n\n    set scraps to my split(theText, text of beginText)\n    if forwardSearch of beginText then\n        set theText to my join(rest of scraps, text of beginText)\n    else\n        set {theText} to reverse of scraps\n    end if\n    set scraps to my split(theText, text of endText)\n    if forwardSearch of endText then\n        set {theText} to scraps\n    else\n        set theText to my join(reverse of rest of reverse of scraps, text of endText)\n    end if\n    if containText of beginText then\n        set theText to \"\" & text of beginText & theText\n    end if\n    if containText of endText then\n        set theText to \"\" & theText & text of endText\n    end if\n    return theText\nend extractText\n\non ISODateToDate(ISODate)\n    if class of ISODate = \u00abclass isot\u00bb then\n        set aDate to ISODate as date\n    else\n        set aDate to (do shell script \"echo \" & quoted form of ISODate as \u00abclass isot\u00bb) as date\n        if ISODate ends with \"Z\" then\n            set aDate to my shiftDateFromGMT(aDate)\n        end if\n    end if\n    return aDate\nend ISODateToDate\n\non htmlToRawData(HTML as text)\n    return run script \"\u00abdata HTML\" & (do shell script \"echo \" & quoted form of HTML & \" | hexdump -v -e '/1 \\\"%02X\\\"'\") & \"\u00bb\"\nend htmlToRawData\n\non split(str as text, delim)\n    set oldDel to AppleScript's text item delimiters\n    set AppleScript's text item delimiters to delim\n    set aList to text items of str\n    set AppleScript's text item delimiters to oldDel\n    return aList\nend split\n\non join(textList, term as text)\n    set oldDel to AppleScript's text item delimiters\n    set AppleScript's text item delimiters to term\n    set aText to textList as string\n    set AppleScript's text item delimiters to oldDel\n    return aText\nend join\n\non shiftDateFromGMT(aDate)\n    global timeToGMT\n    try\n        timeToGMT\n    on error number -2753\n        set timeToGMT to time to GMT\n    end try\n    return aDate + timeToGMT\nend shiftDateFromGMT\n\n\n\n\u666e\u6bb5AppleScript\u3092\u4f7f\u308f\u306a\u3044\u65b9\u3078\n\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\u3059\u308b\u65b9\u6cd5\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u304b\u3089\u5b9f\u884c\u3057\u3066\u3082\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u6b21\u306b\u793a\u3059\u8a2d\u5b9a\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app (/Applications/Utilities/Script Editor.app) \u8d77\u52d5\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\n\u300c\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u300d\n\u300c\u74b0\u5883\u8a2d\u5b9a\u2026\u300d\n\u300c\u4e00\u822c\u300d\n\u300c\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u300d\n\u300c\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\u300d \u306b\u30c1\u30a7\u30c3\u30af\n\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u306e\u30a2\u30a4\u30b3\u30f3\u304c\u8868\u793a\u3055\u308c\u308c\u3070OK\u3002\n\nGUI\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\n\u30b9\u30af\u30ea\u30d7\u30c8\u4e2d\u306b\u300cGUI\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u300d\u3068\u547c\u3070\u308c\u308b\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u5b9f\u884c\u3059\u308b\u524d\u306b\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u8a2d\u5b9a.app (/Applications/System Preferences.app) \u8d77\u52d5\n\u300c\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3068\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u300d\n\u300c\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u300d\n \u9375\u30de\u30fc\u30af \u300c\u5909\u66f4\u3059\u308b\u306b\u306f\u30ab\u30ae\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\u300d\u3092\u30af\u30ea\u30c3\u30af\n \u30d1\u30b9\u30ef\u30fc\u30c9\u5165\u529b\n\u300c\u30ed\u30c3\u30af\u3092\u89e3\u9664\u300d\n\u300c\u30a2\u30af\u30bb\u30b7\u30d3\u30ea\u30c6\u30a3\u300d\n \u300c+\u300d\n/System/Library/CoreServices/SystemUIServer.app \u3092\u9078\u629e\n\u300c\u958b\u304f\u300d\n\n\n(2015-12-18 \u8ffd\u8a18) \u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u65b9\u6cd5\n\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u5834\u6240\u3092\u66f8\u3044\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089AppleScript\u3092\u5b9f\u884c\u3059\u308b\u306b\u306f\u7279\u5b9a\u306e\u5834\u6240\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\u4e0b\u306e\u65b9\u6cd5\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app (/Applications/Utilities/Script Editor.app) \u8d77\u52d5\n\u30d5\u30a1\u30a4\u30eb\u9078\u629e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u305f\u5834\u5408\u306f\u300c\u65b0\u898f\u66f8\u985e\u300d\n\u3053\u306e\u30da\u30fc\u30b8\u4e2d\u90e8\u306e\u300c\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u300d\u306b\u3042\u308b\u300ccitation.scpt\u300d\u5168\u4f53\u3092\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app\u306b\u30b3\u30d4\u30da\n\u2318+K\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\n\u2318+S\u3067\u4fdd\u5b58\n\u540d\u524d\u3092\u300ccitation.scpt\u300d\u306b\n\u4fdd\u5b58\u5834\u6240\u3092\u300c/Users/\uff08\u30e6\u30fc\u30b6\u540d\uff09/Library/Scripts\u300d\u306b\n\u30d5\u30a1\u30a4\u30eb\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u300c\u30b9\u30af\u30ea\u30d7\u30c8\u300d\u306e\u307e\u307e\u3067\n\u300c\u4fdd\u5b58\u300d\n\n\u4fdd\u5b58\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app\u3092\u7d42\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\u65b9\u6cd5\u306f\u5192\u982d\u306e\u300c\u4f7f\u3044\u65b9\uff08\u57fa\u790e\u7de8\uff09\u30fb\uff08\u5fdc\u7528\u7de8\uff09\u300d\u306b\u66f8\u3044\u305f\u3068\u304a\u308a\u3002\u304d\u3061\u3093\u3068\u52d5\u304f\u304b\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u66f4\u65b0\u5c65\u6b74\n\n2015-12-16: Evernote\u306e\u30ce\u30fc\u30c8\u4e0a\u3067\u5f15\u7528\u578b\u30ce\u30fc\u30c8\u30ea\u30f3\u30af\u3092\u30b3\u30d4\u30fc\u3059\u308b\u6a5f\u80fd\u5b9f\u88c5\n2015-12-17: Safari\u3067\u5f15\u7528\u578b\u30ea\u30f3\u30af\u3092\u30b3\u30d4\u30fc\u3059\u308b\u6a5f\u80fd\u8ffd\u52a0\n\n\n\u30a2\u30f3\u30d3\u30ea\u30fc\u30d0\u30dc\uff1f\u30a2\u30f3\u30d3\u30ea\u30d0\u30dc\u30fc\uff1f\n\n[http://rashita.net/blog/?p=16722](http://rashita.net/blog/?p=16722)\n\n\u3053\u3061\u3089\u306e2\u3064\u76ee\u3001\u300c\u62e1\u5f35\u578b\u30ce\u30fc\u30c8\u30ea\u30f3\u30af\u300d\u3068\u66f8\u304b\u308c\u305f\u6a5f\u80fd\u3092AppleScript\u3067\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\n\n\n## \u4f7f\u3044\u65b9\uff08\u57fa\u790e\u7de8\uff09\n\nEvernote\u306e\u30ce\u30fc\u30c8\u4e0a\u3067\u5f15\u7528\u3057\u305f\u3044\u7b87\u6240\u3092\u9078\u629e\u72b6\u614b\u306b\u3002\n\n![citation screenshot 1](https://qiita-image-store.s3.amazonaws.com/0/101438/afdff6c3-40c0-47a4-eb72-10e89f7efc0e.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-12-17 20.19.40.png\")\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089`citation`\u3092\u5b9f\u884c\u3059\u308b\u3068\n\n![citation screenshot 2](https://qiita-image-store.s3.amazonaws.com/0/101438/a4ff9c39-9578-71fb-76b6-efd3e04975e1.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-12-17 20.21.02.png\")\n\n\u300cCopied\u300d\u3068\u901a\u77e5\u3002\n\n![citation screenshot 3](https://qiita-image-store.s3.amazonaws.com/0/101438/53b0c1d2-94f4-ea11-9d55-a8df77836842.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-12-17 20.21.42.png\")\n\n\u597d\u304d\u306a\u3068\u3053\u308d\u3067\u30da\u30fc\u30b9\u30c8\u3059\u308c\u3070\u3001\u305d\u308c\u3063\u307d\u3044\u898b\u305f\u76ee\u306e\u30ce\u30fc\u30c8\u30ea\u30f3\u30af\u3002\n\n![citation screenshot 4](https://qiita-image-store.s3.amazonaws.com/0/101438/6669d35b-5eec-f260-383b-67a703297066.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-12-17 20.23.48.png\")\n\n## \u4f7f\u3044\u65b9\uff08\u5fdc\u7528\u7de8\uff09\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u3063\u3066\u4ed6\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3082\u62e1\u5f35\u3067\u304d\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070Safari\u306e\u5834\u5408\u3002\u30da\u30fc\u30b8\u4e0a\u3067\u5f15\u7528\u90e8\u5206\u3092\u9078\u629e\u3057\u3066`citation`\u3092\u5b9f\u884c\u3002\n\n![citation screenshot 5](https://qiita-image-store.s3.amazonaws.com/0/101438/f3e669e5-becb-e0b3-19f7-eff9b2121561.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-12-17 20.27.38.png\")\n\nEvernote\u306b\u30da\u30fc\u30b9\u30c8\u3067\u5f15\u7528\u6587\u3092\u542b\u3093\u3060\u30ea\u30f3\u30af\u306b\u3002\u753b\u50cf\u306f\u53cd\u6620\u3055\u308c\u307e\u305b\u3093\u3002\n\n![citation screenshot 6](https://qiita-image-store.s3.amazonaws.com/0/101438/8e1dd729-59a3-fe59-e420-6c7ab84332cd.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-12-17 20.28.18.png\")\n\n\u4eca\u306e\u3068\u3053\u308dEvernote\u3068Safari\u306e2\u7a2e\u985e\u306e\u307f\u3067\u3059\u3002\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u3044\u3058\u3063\u3066\u4ed6\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30ea\u30f3\u30af\u306e\u8272\u3092\u5909\u3048\u308b\u306a\u308a\u3001\u30a2\u30a4\u30b3\u30f3\u3092\u4ed8\u3051\u308b\u306a\u308a\u3057\u306a\u3044\u3068\u898b\u5206\u3051\u304c\u3064\u304d\u307e\u305b\u3093\u304c\u3001\u305d\u308c\u306f\u307e\u305f\u5225\u306e\u6a5f\u4f1a\u306b\u3002\n\n\n## (2015-12-18 \u8ffd\u8a18) \u4f7f\u3044\u65b9\uff08\u767a\u5c55\u7de8\uff09\n\nHTML\u3092\u7406\u89e3\u3067\u304d\u308b\u65b9\u306b\u30aa\u30b9\u30b9\u30e1\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u5192\u982d\u306b\u3042\u308b`property citationTemplate : ...`\u306e\u90e8\u5206\u3067\u3001\u8cbc\u308a\u4ed8\u3051\u308b\u30ea\u30f3\u30af\u306e\u898b\u305f\u76ee\u3092\u6c7a\u3081\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3001\u898b\u308c\u3070\u308f\u304b\u308b\u3088\u3046\u306bHTML\u3067\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\n* \u5143\u306e\u307e\u307e\u3067\u306f\u7121\u99c4\u306a\u60c5\u5831\u304c\u591a\u3044\n* \u6587\u5b57\u3084\u30ea\u30f3\u30af\u306e\u5927\u304d\u3055\u3084\u8272\u3001\u9806\u756a\u304c\u6c17\u306b\u304f\u308f\u306a\u3044\n* \u5f15\u7528\u306f`blockquote`\u3058\u3083\u306a\u3044\u3068\u6c17\u6301\u3061\u60aa\u3044\n\n\u306a\u3093\u3066\u65b9\u306fHTML\u3092\u3044\u3058\u3063\u3066\u81ea\u5206\u597d\u307f\u306e\u898b\u305f\u76ee\u306b\u5909\u66f4\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u305d\u306e\u969b\u306b\u6ce8\u610f\u3059\u3079\u304d\u3053\u3068\u3068\u3057\u3066 **\u7279\u6b8a\u6587\u5b57\u306e\u53d6\u308a\u6271\u3044** \u304c\u3042\u308a\u307e\u3059\u3002\n\n`property citationTemplate : ...`\u306e\u90e8\u5206\u3067\u306fHTML\u5168\u4f53\u3092\u6587\u5b57\u5217\u3068\u3057\u3066`citationTemplate`\u3068\u3044\u3046\u5909\u6570\u306b\u5165\u308c\u308b\u305f\u3081\u3001\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3(\")\u3067\u56f2\u3063\u3066\u3044\u307e\u3059\u3002\n\nHTML\u5185\u3067\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3(\")\u3092\u4f7f\u3046\u3068\u3001\u305d\u3053\u304c\u6587\u5b57\u5217\u306e\u7d42\u308f\u308a\u3068\u5224\u65ad\u3055\u308c\u3066\u300c\u6b8b\u308a\u306e\u6587\u5b57\u5217\u306f\u306a\u3093\u3060\uff1f\u300d\u3063\u3066\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u305d\u3053\u3067\u3001\u30a8\u30b9\u30b1\u30fc\u30d7\u306e\u305f\u3081\u306b\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5(\\\\)\u3092\u524d\u306b\u7f6e\u3044\u3066\u3001`\\\"`\u3068\u8a18\u8ff0\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u3046\u3059\u308c\u3070\u30a8\u30e9\u30fc\u306f\u51fa\u306a\u3044\u306f\u305a\u3002\n\n\u4ed6\u306b\u3082\u3064\u307e\u305a\u304f\u3053\u3068\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001Google\u306b\u983c\u308a\u306a\u304c\u3089\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n## \u52d5\u4f5c\u74b0\u5883\n\n* Mac OS X: 10.11\n* Evernote: ver 6.3 (452832 Direct)\n\n\n## \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n<!-- [citation.scpt \u3092 \u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app \u3067\u958b\u304f](applescript://com.apple.scripteditor?script=%28%2A%0A%2A%20%5B%5BClipping%5D%5D%3A%20%E5%BC%95%E7%94%A8%E5%86%85%E5%AE%B9%20-%20getClipping%28%29%0A%2A%20%5B%5BLink%5D%5D%3A%20%E3%83%AA%E3%83%B3%E3%82%AFURL%20-%20getLink%28%29%0A%2A%20%5B%5BTitle%5D%5D%3A%20%E3%83%AA%E3%83%B3%E3%82%AF%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%20-%20getTitle%28%29%0A%2A%20%5B%5BAuthor%5D%5D%3A%20%E4%BD%9C%E8%80%85%20-%20getAuthor%28%29%0A%2A%20%5B%5BPublisher%5D%5D%3A%20%E5%87%BA%E7%89%88%E7%A4%BE%E3%80%81%E7%99%BA%E8%A1%8C%E5%85%83%20-%20getPublisher%28%29%0A%2A%20%5B%5BDate%5D%5D%3A%20%E6%97%A5%E4%BB%98%20-%20getDate%28%29%0A%2A%29%0Dproperty%20citationTemplate%20%3A%20%22%3Cbr%3E%0A%3Cdiv%20class%3D%27citation%27%20style%3D%27padding%3A%200px%2030px%3B%27%3E%0A%09%3Cdiv%20class%3D%27clipping%27%20style%3D%27line-height%3A18px%3B%20padding%3A%208px%2015px%3B%20border-left%3A2px%20solid%20%23dedede%3B%20color%3A%20%23919191%3B%20font-family%3A%20Helvetica%2C%20sans-serif%3B%20font-style%3A%20italic%3B%20font-size%3A%2014px%3B%27%3E%5B%5BClipping%5D%5D%3C%2Fdiv%3E%0A%09%3Cdiv%20style%3D%27padding-left%3A%2017px%3B%27%3E%0A%09%09%3Cdiv%20class%3D%27title%27%20style%3D%27color%3A%20%23000000%3B%20font-family%3A%20Helvetica%2C%20sans-serif%3B%20font-size%3A%2014px%3B%20margin-top%3A%2019px%3B%27%3E%0A%09%09%09%3Ca%20style%3D%27text-decoration%3A%20none%3B%20color%3A%20rgba%2845%2C190%2C96%2C1.0%29%3B%27%20href%3D%27%5B%5BLink%5D%5D%27%3E%0A%09%09%09%09%26quot%3B%5B%5BTitle%5D%5D%26quot%3B%0A%09%09%09%3C%2Fa%3E%0A%09%09%3C%2Fdiv%3E%0A%09%09%3Cdiv%20style%3D%27color%3A%20%23919191%3B%20font-size%3A%2012px%3B%20margin-top%3A%204px%3B%20font-family%3A%20%27CaeciliaLTStd%27%2C%20serif%3B%20font-style%3A%20italic%3B%27%3E%0A%09%09%09%3Cspan%20class%3D%27author%27%3E%5B%5BAuthor%5D%5D%3C%2Fspan%3E%0A%09%09%09%3Cspan%20class%3D%27publisher%27%3E%5B%5BPublisher%5D%5D.%3C%2Fspan%3E%0A%09%09%09%3Cspan%20class%3D%27date%27%3E%5B%5BDate%5D%5D%3C%2Fspan%3E%0A%09%09%3C%2Fdiv%3E%0A%09%3C%2Fdiv%3E%0A%3C%2Fdiv%3E%0A%3Cbr%3E%22%0D%0Don%20run%0D%09%0D%09--%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E5%88%A4%E5%88%A5%0D%09if%20application%20%22Evernote%22%20is%20running%20and%20application%20%22Evernote%22%20is%20frontmost%20then%0D%09%09set%20curApp%20to%20make%20Evernote%0D%09else%20if%20application%20%22Safari%22%20is%20running%20and%20application%20%22Safari%22%20is%20frontmost%20then%0D%09%09set%20curApp%20to%20make%20Safari%0D%09else%0D%09%09--set%20curApp%20to%20make%20some_application%0D%09%09error%0D%09end%20if%0D%09%0D%09--citation%E3%81%AEHTML%E4%BD%9C%E6%88%90%0D%09copy%20citationTemplate%20to%20citation%0D%09repeat%20with%20replacement%20in%20%7B%C2%AC%0D%09%09%7B%22%5B%5BClipping%5D%5D%22%2C%20getClipping%28%29%20of%20curApp%7D%2C%20%C2%AC%0D%09%09%7B%22%5B%5BLink%5D%5D%22%2C%20getLink%28%29%20of%20curApp%7D%2C%20%C2%AC%0D%09%09%7B%22%5B%5BTitle%5D%5D%22%2C%20getTitle%28%29%20of%20curApp%7D%2C%20%C2%AC%0D%09%09%7B%22%5B%5BAuthor%5D%5D%22%2C%20getAuthor%28%29%20of%20curApp%7D%2C%20%C2%AC%0D%09%09%7B%22%5B%5BPublisher%5D%5D%22%2C%20getPublisher%28%29%20of%20curApp%7D%2C%20%C2%AC%0D%09%09%7B%22%5B%5BDate%5D%5D%22%2C%20getDate%28%29%20of%20curApp%7D%20%C2%AC%0D%09%09%09%7D%0D%09%09set%20%7Bf%2C%20r%7D%20to%20replacement%0D%09%09set%20r%20to%20my%20escapeHTMLSpecialChars%28r%29%0D%09%09set%20r%20to%20my%20replace%28r%2C%20%7Breturn%2C%20linefeed%7D%2C%20%22%3Cbr%3E%22%29%0D%09%09set%20citation%20to%20my%20replace%28citation%2C%20f%2C%20r%29%0D%09end%20repeat%0D%09%0D%09--HTML%E3%82%92%E3%82%B3%E3%83%94%E3%83%BC%0D%09my%20copyHTML%28citation%29%0D%09display%20notification%20getTitle%28%29%20of%20curApp%20with%20title%20%22Copied%22%0Dend%20run%0D%0Dscript%20some_application%0D%09%0D%09on%20getClipping%28%29%0D%09%09repeat%20until%20application%20id%20%28my%20appID%29%20is%20frontmost%0D%09%09%09activate%20application%20id%20%28my%20appID%29%0D%09%09end%20repeat%0D%09%09set%20the%20clipboard%20to%20%22%22%0D%09%09set%20tmpClipboard%20to%20the%20clipboard%20as%20record%0D%09%09tell%20application%20%22System%20Events%22%0D%09%09%09keystroke%20%22c%22%20using%20%7Bcommand%20down%7D%0D%09%09%09set%20timestamp%20to%20current%20date%0D%09%09%09repeat%20while%20%28the%20clipboard%20as%20record%29%20%3D%20tmpClipboard%0D%09%09%09%09if%20%28current%20date%29%20%3E%20timestamp%20%2B%2010%20then%0D%09%09%09%09%09error%0D%09%09%09%09end%20if%0D%09%09%09%09delay%201%0D%09%09%09end%20repeat%0D%09%09end%20tell%0D%09%09return%20the%20clipboard%20as%20text%0D%09end%20getClipping%0D%09%0D%09on%20getLink%28%29%0D%09%09return%20%22%22%0D%09end%20getLink%0D%09%0D%09on%20getTitle%28%29%0D%09%09return%20%22%22%0D%09end%20getTitle%0D%09%0D%09on%20getAuthor%28%29%0D%09%09return%20%22%22%0D%09end%20getAuthor%0D%09%0D%09on%20getPublisher%28%29%0D%09%09return%20%22%22%0D%09end%20getPublisher%0D%09%0D%09on%20getDate%28%29%0D%09%09return%20%22%22%0D%09end%20getDate%0D%09%0D%09on%20make%0D%09%09set%20a_class%20to%20me%0D%09%09script%20Instance%0D%09%09%09property%20parent%20%3A%20a_class%0D%09%09%09property%20appID%20%3A%20run%20script%20%22tell%20application%20%5C%22System%20Events%5C%22%20to%20return%20bundle%20identifier%20of%20process%201%20whose%20frontmost%20%3D%20true%20and%20visible%20%3D%20true%22%0D%09%09end%20script%0D%09end%20make%0Dend%20script%0D%0Dscript%20Evernote%0D%09property%20parent%20%3A%20some_application%0D%09%0D%09--on%20getClipping%28%29%0D%09--%09continue%20getClipping%28%29%0D%09--end%20getClipping%0D%09%0D%09on%20getLink%28%29%0D%09%09tell%20application%20%22Evernote%22%0D%09%09%09return%20note%20link%20of%20%28note%20id%20%28my%20noteID%29%29%20of%20notebook%201%0D%09%09end%20tell%0D%09end%20getLink%0D%09%0D%09on%20getTitle%28%29%0D%09%09tell%20application%20%22Evernote%22%0D%09%09%09return%20title%20of%20%28note%20id%20%28my%20noteID%29%29%20of%20notebook%201%0D%09%09end%20tell%0D%09end%20getTitle%0D%09%0D%09on%20getAuthor%28%29%0D%09%09tell%20application%20%22Evernote%22%0D%09%09%09set%20noteAuthor%20to%20author%20of%20%28note%20id%20%28my%20noteID%29%29%20of%20notebook%201%0D%09%09end%20tell%0D%09%09if%20noteAuthor%20%3D%20missing%20value%20then%0D%09%09%09set%20noteAuthor%20to%20%22%22%0D%09%09end%20if%0D%09%09return%20noteAuthor%0D%09end%20getAuthor%0D%09%0D%09on%20getPublisher%28%29%0D%09%09tell%20application%20%22Evernote%22%0D%09%09%09return%20name%20of%20notebook%20of%20%28note%20id%20%28my%20noteID%29%29%20of%20notebook%201%0D%09%09end%20tell%0D%09end%20getPublisher%0D%09%0D%09on%20getDate%28%29%0D%09%09tell%20application%20%22Evernote%22%0D%09%09%09tell%20creation%20date%20of%20%28note%20id%20%28my%20noteID%29%29%20of%20notebook%201%20as%20date%0D%09%09%09%09return%20%22%22%20%26%20year%20%26%20%22%E5%B9%B4%22%20%26%20%28month%20of%20it%20as%20number%29%20%26%20%22%E6%9C%88%22%20%26%20day%20%26%20%22%E6%97%A5%22%0D%09%09%09end%20tell%0D%09%09end%20tell%0D%09end%20getDate%0D%09%0D%09on%20make%0D%09%09set%20self%20to%20continue%20make%0D%09%09script%20EvernoteInstance%0D%09%09%09property%20parent%20%3A%20self%0D%09%09%09property%20noteID%20%3A%20run%20script%20%22tell%20application%20%5C%22Evernote%5C%22%20to%20return%20local%20id%20of%20item%201%20of%20%28selection%20as%20list%29%22%0D%09%09end%20script%0D%09end%20make%0Dend%20script%0D%0Dscript%20Safari%0D%09property%20parent%20%3A%20some_application%0D%09%0D%09on%20getClipping%28%29%0D%09%09tell%20application%20%22Safari%22%0D%09%09%09set%20clipping%20to%20do%20JavaScript%20%22document.getSelection%28%29.toString%28%29%3B%22%20in%20current%20tab%20of%20window%20id%20%28my%20windowID%29%0D%09%09end%20tell%0D%09%09if%20clipping%20%3D%20%22%22%20then%0D%09%09%09try%0D%09%09%09%09set%20clipping%20to%20my%20extractText%28my%20metas%2C%20linefeed%20%26%20%22og%3Adescription%2C%22%2C%20linefeed%29%0D%09%09%09on%20error%20number%20-2700%0D%09%09%09end%20try%0D%09%09end%20if%0D%09%09return%20clipping%0D%09end%20getClipping%0D%09%0D%09on%20getLink%28%29%0D%09%09try%0D%09%09%09return%20my%20extractText%28my%20metas%2C%20linefeed%20%26%20%22og%3Aurl%2C%22%2C%20linefeed%29%0D%09%09on%20error%20number%20-2700%0D%09%09end%20try%0D%09%09tell%20application%20%22Safari%22%0D%09%09%09return%20URL%20of%20current%20tab%20of%20window%20id%20%28my%20windowID%29%0D%09%09end%20tell%0D%09end%20getLink%0D%09%0D%09on%20getTitle%28%29%0D%09%09try%0D%09%09%09return%20my%20extractText%28my%20metas%2C%20linefeed%20%26%20%22og%3Atitle%2C%22%2C%20linefeed%29%0D%09%09on%20error%20number%20-2700%0D%09%09end%20try%0D%09%09tell%20application%20%22Safari%22%0D%09%09%09return%20name%20of%20current%20tab%20of%20window%20id%20%28my%20windowID%29%0D%09%09end%20tell%0D%09end%20getTitle%0D%09%0D%09on%20getAuthor%28%29%0D%09%09try%0D%09%09%09return%20my%20extractText%28my%20metas%2C%20linefeed%20%26%20%22twitter%3Acreator%2C%22%2C%20linefeed%29%0D%09%09on%20error%20number%20-2700%0D%09%09end%20try%0D%09%09return%20%22%22%0D%09end%20getAuthor%0D%09%0D%09on%20getPublisher%28%29%0D%09%09try%0D%09%09%09return%20my%20extractText%28my%20metas%2C%20linefeed%20%26%20%22og%3Asite_name%2C%22%2C%20linefeed%29%0D%09%09on%20error%20number%20-2700%0D%09%09end%20try%0D%09%09return%20%22%22%0D%09end%20getPublisher%0D%09%0D%09on%20getDate%28%29%0D%09%09try%0D%09%09%09set%20ISODate%20to%20my%20extractText%28my%20metas%2C%20linefeed%20%26%20%22article%3Apublished_time%2C%22%2C%20linefeed%29%0D%09%09%09tell%20my%20ISODateToDate%28ISODate%29%0D%09%09%09%09return%20%22%22%20%26%20year%20%26%20%22%E5%B9%B4%22%20%26%20%28month%20of%20it%20as%20number%29%20%26%20%22%E6%9C%88%22%20%26%20day%20%26%20%22%E6%97%A5%22%0D%09%09%09end%20tell%0D%09%09on%20error%20number%20-2700%0D%09%09end%20try%0D%09%09return%20%22%22%0D%09end%20getDate%0D%09%0D%09on%20make%0D%09%09set%20self%20to%20continue%20make%0D%09%09script%20SafariInstance%0D%09%09%09property%20parent%20%3A%20self%0D%09%09%09property%20windowID%20%3A%20run%20script%20%22tell%20application%20%5C%22Safari%5C%22%20to%20return%20id%20of%20window%201%20whose%20current%20tab%20%E2%89%A0%20missing%20value%22%0D%09%09%09property%20metas%20%3A%20run%20script%20%22tell%20application%20%5C%22Safari%5C%22%20to%20return%20do%20JavaScript%20%5C%22var%20ary%3D%5B%5D%3B%20var%20elements%3Ddocument.getElementsByTagName%28%27meta%27%29%3B%20for%28i%3D0%3B%20i%3Celements.length%3B%20i%2B%2B%29%20%7Bcontent%3Delements%5Bi%5D.getAttribute%28%27content%27%29%3B%20if%28elements%5Bi%5D.getAttribute%28%27property%27%29%29%20%7Bary.push%28elements%5Bi%5D.getAttribute%28%27property%27%29%20%2B%20%27%2C%27%20%2B%20elements%5Bi%5D.getAttribute%28%27content%27%29%29%3B%7D%20else%20if%28elements%5Bi%5D.getAttribute%28%27name%27%29%29%20%7Bary.push%28elements%5Bi%5D.getAttribute%28%27name%27%29%20%2B%20%27%2C%27%20%2B%20elements%5Bi%5D.getAttribute%28%27content%27%29%29%3B%7D%7D%20%27%5C%5C%5C%5Cn%27%20%2B%20ary.join%28%27%5C%5C%5C%5Cn%27%29%20%2B%20%27%5C%5C%5C%5Cn%27%3B%5C%22%20in%20current%20tab%20of%20window%20id%20%22%20%26%20windowID%0D%09%09end%20script%0D%09end%20make%0Dend%20script%0D%0Don%20escapeHTMLSpecialChars%28args%29%0D%09if%20class%20of%20args%20%3D%20list%20then%0D%09%09repeat%20with%20i%20from%201%20to%20count%20args%0D%09%09%09set%20item%20i%20of%20args%20to%20my%20escapeHTMLSpecialChars%28item%20i%20of%20args%29%0D%09%09end%20repeat%0D%09else%0D%09%09set%20args%20to%20my%20replace%28args%2C%20%22%26%22%2C%20%22%26amp%3B%22%29%0D%09%09set%20args%20to%20my%20replace%28args%2C%20%22%3C%22%2C%20%22%26lt%3B%22%29%0D%09%09set%20args%20to%20my%20replace%28args%2C%20%22%3E%22%2C%20%22%26gt%3B%22%29%0D%09%09set%20args%20to%20my%20replace%28args%2C%20quote%2C%20%22%26quot%3B%22%29%0D%09%09set%20args%20to%20my%20replace%28args%2C%20%22%27%22%2C%20%22%26%23039%3B%22%29%0D%09end%20if%0D%09return%20args%0Dend%20escapeHTMLSpecialChars%0D%0Don%20replace%28str%20as%20text%2C%20find%2C%20replace%20as%20text%29%0D%09set%20oldDel%20to%20AppleScript%27s%20text%20item%20delimiters%0D%09set%20AppleScript%27s%20text%20item%20delimiters%20to%20find%0D%09set%20replaceList%20to%20text%20items%20of%20str%0D%09set%20AppleScript%27s%20text%20item%20delimiters%20to%20replace%0D%09set%20str%20to%20replaceList%20as%20string%0D%09set%20AppleScript%27s%20text%20item%20delimiters%20to%20oldDel%0D%09return%20str%0Dend%20replace%0D%0Don%20copyHTML%28HTML%20as%20text%29%0D%09set%20the%20clipboard%20to%20%7B%C2%ABclass%20utf8%C2%BB%3AHTML%2C%20string%3AHTML%2C%20Unicode%20text%3AHTML%2C%20%C2%ABclass%20HTML%C2%BB%3Amy%20htmlToRawData%28HTML%29%7D%0Dend%20copyHTML%0D%0Don%20extractText%28theText%2C%20beginText%2C%20endText%29%0D%09--beginText%2C%20endText%E4%BE%8B%3A%20%7Btext%3A%22a%22%2C%20forwardSearch%3Afalse%2C%20containText%3Atrue%7D%0D%09set%20beginText%20to%20%28beginText%20as%20record%29%20%26%20%7BforwardSearch%3Atrue%2C%20containText%3Afalse%7D%0D%09set%20endText%20to%20%28endText%20as%20record%29%20%26%20%7BforwardSearch%3Atrue%2C%20containText%3Afalse%7D%0D%09%0D%09if%20theText%20does%20not%20contain%20text%20of%20beginText%20or%20theText%20does%20not%20contain%20text%20of%20endText%20then%20error%20%22%E5%BC%95%E6%95%B0%E3%81%AE%E6%96%87%E5%AD%97%E5%88%97%E3%81%8C%E5%90%AB%E3%81%BE%E3%82%8C%E3%81%BE%E3%81%9B%E3%82%93%22%0D%09%0D%09set%20scraps%20to%20my%20split%28theText%2C%20text%20of%20beginText%29%0D%09if%20forwardSearch%20of%20beginText%20then%0D%09%09set%20theText%20to%20my%20join%28rest%20of%20scraps%2C%20text%20of%20beginText%29%0D%09else%0D%09%09set%20%7BtheText%7D%20to%20reverse%20of%20scraps%0D%09end%20if%0D%09set%20scraps%20to%20my%20split%28theText%2C%20text%20of%20endText%29%0D%09if%20forwardSearch%20of%20endText%20then%0D%09%09set%20%7BtheText%7D%20to%20scraps%0D%09else%0D%09%09set%20theText%20to%20my%20join%28reverse%20of%20rest%20of%20reverse%20of%20scraps%2C%20text%20of%20endText%29%0D%09end%20if%0D%09if%20containText%20of%20beginText%20then%0D%09%09set%20theText%20to%20%22%22%20%26%20text%20of%20beginText%20%26%20theText%0D%09end%20if%0D%09if%20containText%20of%20endText%20then%0D%09%09set%20theText%20to%20%22%22%20%26%20theText%20%26%20text%20of%20endText%0D%09end%20if%0D%09return%20theText%0Dend%20extractText%0D%0Don%20ISODateToDate%28ISODate%29%0D%09if%20class%20of%20ISODate%20%3D%20%C2%ABclass%20isot%C2%BB%20then%0D%09%09set%20aDate%20to%20ISODate%20as%20date%0D%09else%0D%09%09set%20aDate%20to%20%28do%20shell%20script%20%22echo%20%22%20%26%20quoted%20form%20of%20ISODate%20as%20%C2%ABclass%20isot%C2%BB%29%20as%20date%0D%09%09if%20ISODate%20ends%20with%20%22Z%22%20then%0D%09%09%09set%20aDate%20to%20my%20shiftDateFromGMT%28aDate%29%0D%09%09end%20if%0D%09end%20if%0D%09return%20aDate%0Dend%20ISODateToDate%0D%0Don%20htmlToRawData%28HTML%20as%20text%29%0D%09return%20run%20script%20%22%C2%ABdata%20HTML%22%20%26%20%28do%20shell%20script%20%22echo%20%22%20%26%20quoted%20form%20of%20HTML%20%26%20%22%20%7C%20hexdump%20-v%20-e%20%27%2F1%20%5C%22%2502X%5C%22%27%22%29%20%26%20%22%C2%BB%22%0Dend%20htmlToRawData%0D%0Don%20split%28str%20as%20text%2C%20delim%29%0D%09set%20oldDel%20to%20AppleScript%27s%20text%20item%20delimiters%0D%09set%20AppleScript%27s%20text%20item%20delimiters%20to%20delim%0D%09set%20aList%20to%20text%20items%20of%20str%0D%09set%20AppleScript%27s%20text%20item%20delimiters%20to%20oldDel%0D%09return%20aList%0Dend%20split%0D%0Don%20join%28textList%2C%20term%20as%20text%29%0D%09set%20oldDel%20to%20AppleScript%27s%20text%20item%20delimiters%0D%09set%20AppleScript%27s%20text%20item%20delimiters%20to%20term%0D%09set%20aText%20to%20textList%20as%20string%0D%09set%20AppleScript%27s%20text%20item%20delimiters%20to%20oldDel%0D%09return%20aText%0Dend%20join%0D%0Don%20shiftDateFromGMT%28aDate%29%0D%09global%20timeToGMT%0D%09try%0D%09%09timeToGMT%0D%09on%20error%20number%20-2753%0D%09%09set%20timeToGMT%20to%20time%20to%20GMT%0D%09end%20try%0D%09return%20aDate%20%2B%20timeToGMT%0Dend%20shiftDateFromGMT%0D) -->\n\n\n```applescript:citation.scpt\n(*\n* [[Clipping]]: \u5f15\u7528\u5185\u5bb9 - getClipping()\n* [[Link]]: \u30ea\u30f3\u30afURL - getLink()\n* [[Title]]: \u30ea\u30f3\u30af\u30bf\u30a4\u30c8\u30eb - getTitle()\n* [[Author]]: \u4f5c\u8005 - getAuthor()\n* [[Publisher]]: \u51fa\u7248\u793e\u3001\u767a\u884c\u5143 - getPublisher()\n* [[Date]]: \u65e5\u4ed8 - getDate()\n*)\nproperty citationTemplate : \"<br>\n<div class='citation' style='padding: 0px 30px;'>\n\t<div class='clipping' style='line-height:18px; padding: 8px 15px; border-left:2px solid #dedede; color: #919191; font-family: Helvetica, sans-serif; font-style: italic; font-size: 14px;'>[[Clipping]]</div>\n\t<div style='padding-left: 17px;'>\n\t\t<div class='title' style='color: #000000; font-family: Helvetica, sans-serif; font-size: 14px; margin-top: 19px;'>\n\t\t\t<a style='text-decoration: none; color: rgba(45,190,96,1.0);' href='[[Link]]'>\n\t\t\t\t&quot;[[Title]]&quot;\n\t\t\t</a>\n\t\t</div>\n\t\t<div style='color: #919191; font-size: 12px; margin-top: 4px; font-family: 'CaeciliaLTStd', serif; font-style: italic;'>\n\t\t\t<span class='author'>[[Author]]</span>\n\t\t\t<span class='publisher'>[[Publisher]].</span>\n\t\t\t<span class='date'>[[Date]]</span>\n\t\t</div>\n\t</div>\n</div>\n<br>\"\n\non run\n\t\n\t--\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5224\u5225\n\tif application \"Evernote\" is running and application \"Evernote\" is frontmost then\n\t\tset curApp to make Evernote\n\telse if application \"Safari\" is running and application \"Safari\" is frontmost then\n\t\tset curApp to make Safari\n\telse\n\t\t--set curApp to make some_application\n\t\terror\n\tend if\n\t\n\t--citation\u306eHTML\u4f5c\u6210\n\tcopy citationTemplate to citation\n\trepeat with replacement in {\u00ac\n\t\t{\"[[Clipping]]\", getClipping() of curApp}, \u00ac\n\t\t{\"[[Link]]\", getLink() of curApp}, \u00ac\n\t\t{\"[[Title]]\", getTitle() of curApp}, \u00ac\n\t\t{\"[[Author]]\", getAuthor() of curApp}, \u00ac\n\t\t{\"[[Publisher]]\", getPublisher() of curApp}, \u00ac\n\t\t{\"[[Date]]\", getDate() of curApp} \u00ac\n\t\t\t}\n\t\tset {f, r} to replacement\n\t\tset r to my escapeHTMLSpecialChars(r)\n\t\tset r to my replace(r, {return, linefeed}, \"<br>\")\n\t\tset citation to my replace(citation, f, r)\n\tend repeat\n\t\n\t--HTML\u3092\u30b3\u30d4\u30fc\n\tmy copyHTML(citation)\n\tdisplay notification getTitle() of curApp with title \"Copied\"\nend run\n\nscript some_application\n\t\n\ton getClipping()\n\t\trepeat until application id (my appID) is frontmost\n\t\t\tactivate application id (my appID)\n\t\tend repeat\n\t\tset the clipboard to \"\"\n\t\tset tmpClipboard to the clipboard as record\n\t\ttell application \"System Events\"\n\t\t\tkeystroke \"c\" using {command down}\n\t\t\tset timestamp to current date\n\t\t\trepeat while (the clipboard as record) = tmpClipboard\n\t\t\t\tif (current date) > timestamp + 10 then\n\t\t\t\t\terror\n\t\t\t\tend if\n\t\t\t\tdelay 1\n\t\t\tend repeat\n\t\tend tell\n\t\treturn the clipboard as text\n\tend getClipping\n\t\n\ton getLink()\n\t\treturn \"\"\n\tend getLink\n\t\n\ton getTitle()\n\t\treturn \"\"\n\tend getTitle\n\t\n\ton getAuthor()\n\t\treturn \"\"\n\tend getAuthor\n\t\n\ton getPublisher()\n\t\treturn \"\"\n\tend getPublisher\n\t\n\ton getDate()\n\t\treturn \"\"\n\tend getDate\n\t\n\ton make\n\t\tset a_class to me\n\t\tscript Instance\n\t\t\tproperty parent : a_class\n\t\t\tproperty appID : run script \"tell application \\\"System Events\\\" to return bundle identifier of process 1 whose frontmost = true and visible = true\"\n\t\tend script\n\tend make\nend script\n\nscript Evernote\n\tproperty parent : some_application\n\t\n\t--on getClipping()\n\t--\tcontinue getClipping()\n\t--end getClipping\n\t\n\ton getLink()\n\t\ttell application \"Evernote\"\n\t\t\treturn note link of (note id (my noteID)) of notebook 1\n\t\tend tell\n\tend getLink\n\t\n\ton getTitle()\n\t\ttell application \"Evernote\"\n\t\t\treturn title of (note id (my noteID)) of notebook 1\n\t\tend tell\n\tend getTitle\n\t\n\ton getAuthor()\n\t\ttell application \"Evernote\"\n\t\t\tset noteAuthor to author of (note id (my noteID)) of notebook 1\n\t\tend tell\n\t\tif noteAuthor = missing value then\n\t\t\tset noteAuthor to \"\"\n\t\tend if\n\t\treturn noteAuthor\n\tend getAuthor\n\t\n\ton getPublisher()\n\t\ttell application \"Evernote\"\n\t\t\treturn name of notebook of (note id (my noteID)) of notebook 1\n\t\tend tell\n\tend getPublisher\n\t\n\ton getDate()\n\t\ttell application \"Evernote\"\n\t\t\ttell creation date of (note id (my noteID)) of notebook 1 as date\n\t\t\t\treturn \"\" & year & \"\u5e74\" & (month of it as number) & \"\u6708\" & day & \"\u65e5\"\n\t\t\tend tell\n\t\tend tell\n\tend getDate\n\t\n\ton make\n\t\tset self to continue make\n\t\tscript EvernoteInstance\n\t\t\tproperty parent : self\n\t\t\tproperty noteID : run script \"tell application \\\"Evernote\\\" to return local id of item 1 of (selection as list)\"\n\t\tend script\n\tend make\nend script\n\nscript Safari\n\tproperty parent : some_application\n\t\n\ton getClipping()\n\t\ttell application \"Safari\"\n\t\t\tset clipping to do JavaScript \"document.getSelection().toString();\" in current tab of window id (my windowID)\n\t\tend tell\n\t\tif clipping = \"\" then\n\t\t\ttry\n\t\t\t\tset clipping to my extractText(my metas, linefeed & \"og:description,\", linefeed)\n\t\t\ton error number -2700\n\t\t\tend try\n\t\tend if\n\t\treturn clipping\n\tend getClipping\n\t\n\ton getLink()\n\t\ttry\n\t\t\treturn my extractText(my metas, linefeed & \"og:url,\", linefeed)\n\t\ton error number -2700\n\t\tend try\n\t\ttell application \"Safari\"\n\t\t\treturn URL of current tab of window id (my windowID)\n\t\tend tell\n\tend getLink\n\t\n\ton getTitle()\n\t\ttry\n\t\t\treturn my extractText(my metas, linefeed & \"og:title,\", linefeed)\n\t\ton error number -2700\n\t\tend try\n\t\ttell application \"Safari\"\n\t\t\treturn name of current tab of window id (my windowID)\n\t\tend tell\n\tend getTitle\n\t\n\ton getAuthor()\n\t\ttry\n\t\t\treturn my extractText(my metas, linefeed & \"twitter:creator,\", linefeed)\n\t\ton error number -2700\n\t\tend try\n\t\treturn \"\"\n\tend getAuthor\n\t\n\ton getPublisher()\n\t\ttry\n\t\t\treturn my extractText(my metas, linefeed & \"og:site_name,\", linefeed)\n\t\ton error number -2700\n\t\tend try\n\t\treturn \"\"\n\tend getPublisher\n\t\n\ton getDate()\n\t\ttry\n\t\t\tset ISODate to my extractText(my metas, linefeed & \"article:published_time,\", linefeed)\n\t\t\ttell my ISODateToDate(ISODate)\n\t\t\t\treturn \"\" & year & \"\u5e74\" & (month of it as number) & \"\u6708\" & day & \"\u65e5\"\n\t\t\tend tell\n\t\ton error number -2700\n\t\tend try\n\t\treturn \"\"\n\tend getDate\n\t\n\ton make\n\t\tset self to continue make\n\t\tscript SafariInstance\n\t\t\tproperty parent : self\n\t\t\tproperty windowID : run script \"tell application \\\"Safari\\\" to return id of window 1 whose current tab \u2260 missing value\"\n\t\t\tproperty metas : run script \"tell application \\\"Safari\\\" to return do JavaScript \\\"var ary=[]; var elements=document.getElementsByTagName('meta'); for(i=0; i<elements.length; i++) {content=elements[i].getAttribute('content'); if(elements[i].getAttribute('property')) {ary.push(elements[i].getAttribute('property') + ',' + elements[i].getAttribute('content'));} else if(elements[i].getAttribute('name')) {ary.push(elements[i].getAttribute('name') + ',' + elements[i].getAttribute('content'));}} '\\\\\\\\n' + ary.join('\\\\\\\\n') + '\\\\\\\\n';\\\" in current tab of window id \" & windowID\n\t\tend script\n\tend make\nend script\n\non escapeHTMLSpecialChars(args)\n\tif class of args = list then\n\t\trepeat with i from 1 to count args\n\t\t\tset item i of args to my escapeHTMLSpecialChars(item i of args)\n\t\tend repeat\n\telse\n\t\tset args to my replace(args, \"&\", \"&amp;\")\n\t\tset args to my replace(args, \"<\", \"&lt;\")\n\t\tset args to my replace(args, \">\", \"&gt;\")\n\t\tset args to my replace(args, quote, \"&quot;\")\n\t\tset args to my replace(args, \"'\", \"&#039;\")\n\tend if\n\treturn args\nend escapeHTMLSpecialChars\n\non replace(str as text, find, replace as text)\n\tset oldDel to AppleScript's text item delimiters\n\tset AppleScript's text item delimiters to find\n\tset replaceList to text items of str\n\tset AppleScript's text item delimiters to replace\n\tset str to replaceList as string\n\tset AppleScript's text item delimiters to oldDel\n\treturn str\nend replace\n\non copyHTML(HTML as text)\n\tset the clipboard to {\u00abclass utf8\u00bb:HTML, string:HTML, Unicode text:HTML, \u00abclass HTML\u00bb:my htmlToRawData(HTML)}\nend copyHTML\n\non extractText(theText, beginText, endText)\n\t--beginText, endText\u4f8b: {text:\"a\", forwardSearch:false, containText:true}\n\tset beginText to (beginText as record) & {forwardSearch:true, containText:false}\n\tset endText to (endText as record) & {forwardSearch:true, containText:false}\n\t\n\tif theText does not contain text of beginText or theText does not contain text of endText then error \"\u5f15\u6570\u306e\u6587\u5b57\u5217\u304c\u542b\u307e\u308c\u307e\u305b\u3093\"\n\t\n\tset scraps to my split(theText, text of beginText)\n\tif forwardSearch of beginText then\n\t\tset theText to my join(rest of scraps, text of beginText)\n\telse\n\t\tset {theText} to reverse of scraps\n\tend if\n\tset scraps to my split(theText, text of endText)\n\tif forwardSearch of endText then\n\t\tset {theText} to scraps\n\telse\n\t\tset theText to my join(reverse of rest of reverse of scraps, text of endText)\n\tend if\n\tif containText of beginText then\n\t\tset theText to \"\" & text of beginText & theText\n\tend if\n\tif containText of endText then\n\t\tset theText to \"\" & theText & text of endText\n\tend if\n\treturn theText\nend extractText\n\non ISODateToDate(ISODate)\n\tif class of ISODate = \u00abclass isot\u00bb then\n\t\tset aDate to ISODate as date\n\telse\n\t\tset aDate to (do shell script \"echo \" & quoted form of ISODate as \u00abclass isot\u00bb) as date\n\t\tif ISODate ends with \"Z\" then\n\t\t\tset aDate to my shiftDateFromGMT(aDate)\n\t\tend if\n\tend if\n\treturn aDate\nend ISODateToDate\n\non htmlToRawData(HTML as text)\n\treturn run script \"\u00abdata HTML\" & (do shell script \"echo \" & quoted form of HTML & \" | hexdump -v -e '/1 \\\"%02X\\\"'\") & \"\u00bb\"\nend htmlToRawData\n\non split(str as text, delim)\n\tset oldDel to AppleScript's text item delimiters\n\tset AppleScript's text item delimiters to delim\n\tset aList to text items of str\n\tset AppleScript's text item delimiters to oldDel\n\treturn aList\nend split\n\non join(textList, term as text)\n\tset oldDel to AppleScript's text item delimiters\n\tset AppleScript's text item delimiters to term\n\tset aText to textList as string\n\tset AppleScript's text item delimiters to oldDel\n\treturn aText\nend join\n\non shiftDateFromGMT(aDate)\n\tglobal timeToGMT\n\ttry\n\t\ttimeToGMT\n\ton error number -2753\n\t\tset timeToGMT to time to GMT\n\tend try\n\treturn aDate + timeToGMT\nend shiftDateFromGMT\n```\n\n\n\n## \u666e\u6bb5AppleScript\u3092\u4f7f\u308f\u306a\u3044\u65b9\u3078\n\n### \u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\u3059\u308b\u65b9\u6cd5\n\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u304b\u3089\u5b9f\u884c\u3057\u3066\u3082\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u6b21\u306b\u793a\u3059\u8a2d\u5b9a\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n* \u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app (/Applications/Utilities/Script Editor.app) \u8d77\u52d5\n* \u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\n* \u300c\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u300d\n* \u300c\u74b0\u5883\u8a2d\u5b9a\u2026\u300d\n* \u300c\u4e00\u822c\u300d\n* \u300c\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u300d\n* \u300c\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\u300d \u306b\u30c1\u30a7\u30c3\u30af\n\n\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u306e\u30a2\u30a4\u30b3\u30f3\u304c\u8868\u793a\u3055\u308c\u308c\u3070OK\u3002\n\n### GUI\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u4e2d\u306b\u300cGUI\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u300d\u3068\u547c\u3070\u308c\u308b\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u5b9f\u884c\u3059\u308b\u524d\u306b\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n* \u30b7\u30b9\u30c6\u30e0\u74b0\u5883\u8a2d\u5b9a.app (/Applications/System Preferences.app) \u8d77\u52d5\n* \u300c\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3068\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u300d\n* \u300c\u30d7\u30e9\u30a4\u30d0\u30b7\u30fc\u300d\n*  \u9375\u30de\u30fc\u30af \u300c\u5909\u66f4\u3059\u308b\u306b\u306f\u30ab\u30ae\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\u300d\u3092\u30af\u30ea\u30c3\u30af\n*  \u30d1\u30b9\u30ef\u30fc\u30c9\u5165\u529b\n* \u300c\u30ed\u30c3\u30af\u3092\u89e3\u9664\u300d\n* \u300c\u30a2\u30af\u30bb\u30b7\u30d3\u30ea\u30c6\u30a3\u300d\n*  \u300c+\u300d\n* /System/Library/CoreServices/SystemUIServer.app \u3092\u9078\u629e\n* \u300c\u958b\u304f\u300d\n\n### (2015-12-18 \u8ffd\u8a18) \u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u65b9\u6cd5\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u5834\u6240\u3092\u66f8\u3044\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089AppleScript\u3092\u5b9f\u884c\u3059\u308b\u306b\u306f\u7279\u5b9a\u306e\u5834\u6240\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\n\u4e0b\u306e\u65b9\u6cd5\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n<!-- * \u3053\u306e\u30da\u30fc\u30b8\u4e2d\u90e8\u306e\u300c\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u300d\u306b\u3042\u308b\u300ccitation.scpt \u3092 \u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app \u3067\u958b\u304f\u300d\u3092\u30af\u30ea\u30c3\u30af\n* \u300c\u958b\u767a\u5143\u3092\u8b58\u5225\u3067\u304d\u306a\u3044\u30b9\u30af\u30ea\u30d7\u30c8\u300d\u3068\u3044\u3046\u30a6\u30a4\u30f3\u30c9\u30a6\u304c\u8868\u793a\u3055\u308c\u305f\u5834\u5408\u306f\u300c\u65b0\u898f\u30b9\u30af\u30ea\u30d7\u30c8\u300d\u3092\u30af\u30ea\u30c3\u30af -->\n* \u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app (/Applications/Utilities/Script Editor.app) \u8d77\u52d5\n* \u30d5\u30a1\u30a4\u30eb\u9078\u629e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u8868\u793a\u3055\u308c\u305f\u5834\u5408\u306f\u300c\u65b0\u898f\u66f8\u985e\u300d\n* \u3053\u306e\u30da\u30fc\u30b8\u4e2d\u90e8\u306e\u300c\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u300d\u306b\u3042\u308b\u300ccitation.scpt\u300d\u5168\u4f53\u3092\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app\u306b\u30b3\u30d4\u30da\n* \u2318+K\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\n* \u2318+S\u3067\u4fdd\u5b58\n* \u540d\u524d\u3092\u300ccitation.scpt\u300d\u306b\n* \u4fdd\u5b58\u5834\u6240\u3092\u300c/Users/\uff08\u30e6\u30fc\u30b6\u540d\uff09/Library/Scripts\u300d\u306b\n* \u30d5\u30a1\u30a4\u30eb\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u300c\u30b9\u30af\u30ea\u30d7\u30c8\u300d\u306e\u307e\u307e\u3067\n* \u300c\u4fdd\u5b58\u300d\n\n\u4fdd\u5b58\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf.app\u3092\u7d42\u4e86\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\u65b9\u6cd5\u306f\u5192\u982d\u306e\u300c\u4f7f\u3044\u65b9\uff08\u57fa\u790e\u7de8\uff09\u30fb\uff08\u5fdc\u7528\u7de8\uff09\u300d\u306b\u66f8\u3044\u305f\u3068\u304a\u308a\u3002\u304d\u3061\u3093\u3068\u52d5\u304f\u304b\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n## \u66f4\u65b0\u5c65\u6b74\n\n* 2015-12-16: Evernote\u306e\u30ce\u30fc\u30c8\u4e0a\u3067\u5f15\u7528\u578b\u30ce\u30fc\u30c8\u30ea\u30f3\u30af\u3092\u30b3\u30d4\u30fc\u3059\u308b\u6a5f\u80fd\u5b9f\u88c5\n* 2015-12-17: Safari\u3067\u5f15\u7528\u578b\u30ea\u30f3\u30af\u3092\u30b3\u30d4\u30fc\u3059\u308b\u6a5f\u80fd\u8ffd\u52a0\n", "tags": ["AppleScript", "Evernote", "Safari"]}