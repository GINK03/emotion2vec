{"tags": ["struts22.3.16.3", "Struts2.3.16.3", "CVE-2014-0094"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\u3042\u308c\uff1f\u306a\u304a\u3057\u305f\u3089\u3057\u3044\u3084\u3064\u304c\nhttps://www.ipa.go.jp/security/ciadr/vul/20140417-struts.html\n<interceptor-ref name=\"params\">\n    <param name=\"excludeParams\">dojo\\..*,^struts\\..*</param>\n</interceptor-ref>\n\n\nstruts2-oval-plugin-2.3.16.3.jar!/struts-plugin.xml\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<!--\n/*\n * $Id$\n *\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n-->\n<!DOCTYPE struts PUBLIC\n        \"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN\"\n        \"http://struts.apache.org/dtds/struts-2.3.dtd\">\n\n<struts>\n\n    <bean type=\"org.apache.struts2.oval.interceptor.OValValidationManager\"\n          class=\"org.apache.struts2.oval.interceptor.DefaultOValValidationManager\"/>\n\n    <constant name=\"struts.oval.validateJPAAnnotations\" value=\"false\"/>\n\n    <package name=\"oval-default\" extends=\"struts-default\">\n        <interceptors>\n            <interceptor name=\"ovalValidation\" class=\"org.apache.struts2.oval.interceptor.OValValidationInterceptor\"/>\n\n            <interceptor-stack name=\"ovalValidationStack\">\n                <interceptor-ref name=\"exception\"/>\n                <interceptor-ref name=\"alias\"/>\n                <interceptor-ref name=\"servletConfig\"/>\n                <interceptor-ref name=\"i18n\"/>\n                <interceptor-ref name=\"prepare\"/>\n                <interceptor-ref name=\"chain\"/>\n                <interceptor-ref name=\"debugging\"/>\n                <interceptor-ref name=\"profiling\"/>\n                <interceptor-ref name=\"scopedModelDriven\"/>\n                <interceptor-ref name=\"modelDriven\"/>\n                <interceptor-ref name=\"fileUpload\"/>\n                <interceptor-ref name=\"checkbox\"/>\n                <interceptor-ref name=\"staticParams\"/>\n                <interceptor-ref name=\"actionMappingParams\"/>\n                <interceptor-ref name=\"params\">\n                    <param name=\"excludeParams\">dojo\\..*,^struts\\..*</param>\n                </interceptor-ref>\n                <interceptor-ref name=\"conversionError\"/>\n                <interceptor-ref name=\"ovalValidation\">\n                    <param name=\"excludeMethods\">input,back,cancel,browse</param>\n                </interceptor-ref>\n                <interceptor-ref name=\"workflow\">\n                    <param name=\"excludeMethods\">input,back,cancel,browse</param>\n                </interceptor-ref>\n            </interceptor-stack>\n        </interceptors>\n    </package>\n\n</struts>\n\n\n\u3068\u601d\u3063\u305f\u3089\u3001\u5b9f\u88c5\u65b9\u6cd5\u304b\u3048\u305f\u3093\u304b\u3044\n\ncom.opensymphony.xwork2.interceptor.ParametersInterceptor\n\n    protected void initializeHardCodedExcludePatterns() {\n        excludeParams = new HashSet<Pattern>();\n        for (String pattern : ExcludedPatterns.EXCLUDED_PATTERNS) {\n            excludeParams.add(Pattern.compile(pattern, Pattern.CASE_INSENSITIVE));\n        }\n    }\n\n\n\ncom.opensymphony.xwork2.ExcludedPatterns\npackage com.opensymphony.xwork2;\n\n/**\n * ExcludedPatterns contains hard-coded patterns that must be rejected by {@link com.opensymphony.xwork2.interceptor.ParametersInterceptor}\n * and partially in CookInterceptor\n */\npublic class ExcludedPatterns {\n\n    public static final String CLASS_ACCESS_PATTERN = \"(.*\\\\.|^|.*|\\\\[('|\\\"))class(\\\\.|('|\\\")]|\\\\[).*\";\n\n    public static final String[] EXCLUDED_PATTERNS = {\n            CLASS_ACCESS_PATTERN,\n            \"^dojo\\\\..*\",\n            \"^struts\\\\..*\",\n            \"^session\\\\..*\",\n            \"^request\\\\..*\",\n            \"^application\\\\..*\",\n            \"^servlet(Request|Response)\\\\..*\",\n            \"^parameters\\\\..*\"\n    };\n\n}\n\n\n\u3042\u308c\uff1f\u306a\u304a\u3057\u305f\u3089\u3057\u3044\u3084\u3064\u304c\n\nhttps://www.ipa.go.jp/security/ciadr/vul/20140417-struts.html\n\n```xml\n<interceptor-ref name=\"params\">\n    <param name=\"excludeParams\">dojo\\..*,^struts\\..*</param>\n</interceptor-ref>\n```\n\n```xml:struts2-oval-plugin-2.3.16.3.jar!/struts-plugin.xml\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<!--\n/*\n * $Id$\n *\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n-->\n<!DOCTYPE struts PUBLIC\n        \"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN\"\n        \"http://struts.apache.org/dtds/struts-2.3.dtd\">\n\n<struts>\n\n    <bean type=\"org.apache.struts2.oval.interceptor.OValValidationManager\"\n          class=\"org.apache.struts2.oval.interceptor.DefaultOValValidationManager\"/>\n\n    <constant name=\"struts.oval.validateJPAAnnotations\" value=\"false\"/>\n\n    <package name=\"oval-default\" extends=\"struts-default\">\n        <interceptors>\n            <interceptor name=\"ovalValidation\" class=\"org.apache.struts2.oval.interceptor.OValValidationInterceptor\"/>\n\n            <interceptor-stack name=\"ovalValidationStack\">\n                <interceptor-ref name=\"exception\"/>\n                <interceptor-ref name=\"alias\"/>\n                <interceptor-ref name=\"servletConfig\"/>\n                <interceptor-ref name=\"i18n\"/>\n                <interceptor-ref name=\"prepare\"/>\n                <interceptor-ref name=\"chain\"/>\n                <interceptor-ref name=\"debugging\"/>\n                <interceptor-ref name=\"profiling\"/>\n                <interceptor-ref name=\"scopedModelDriven\"/>\n                <interceptor-ref name=\"modelDriven\"/>\n                <interceptor-ref name=\"fileUpload\"/>\n                <interceptor-ref name=\"checkbox\"/>\n                <interceptor-ref name=\"staticParams\"/>\n                <interceptor-ref name=\"actionMappingParams\"/>\n                <interceptor-ref name=\"params\">\n                    <param name=\"excludeParams\">dojo\\..*,^struts\\..*</param>\n                </interceptor-ref>\n                <interceptor-ref name=\"conversionError\"/>\n                <interceptor-ref name=\"ovalValidation\">\n                    <param name=\"excludeMethods\">input,back,cancel,browse</param>\n                </interceptor-ref>\n                <interceptor-ref name=\"workflow\">\n                    <param name=\"excludeMethods\">input,back,cancel,browse</param>\n                </interceptor-ref>\n            </interceptor-stack>\n        </interceptors>\n    </package>\n\n</struts>\n```\n\n\n\u3068\u601d\u3063\u305f\u3089\u3001\u5b9f\u88c5\u65b9\u6cd5\u304b\u3048\u305f\u3093\u304b\u3044\n\n```java:com.opensymphony.xwork2.interceptor.ParametersInterceptor\n\n    protected void initializeHardCodedExcludePatterns() {\n        excludeParams = new HashSet<Pattern>();\n        for (String pattern : ExcludedPatterns.EXCLUDED_PATTERNS) {\n            excludeParams.add(Pattern.compile(pattern, Pattern.CASE_INSENSITIVE));\n        }\n    }\n```\n\n```java:com.opensymphony.xwork2.ExcludedPatterns \npackage com.opensymphony.xwork2;\n\n/**\n * ExcludedPatterns contains hard-coded patterns that must be rejected by {@link com.opensymphony.xwork2.interceptor.ParametersInterceptor}\n * and partially in CookInterceptor\n */\npublic class ExcludedPatterns {\n\n    public static final String CLASS_ACCESS_PATTERN = \"(.*\\\\.|^|.*|\\\\[('|\\\"))class(\\\\.|('|\\\")]|\\\\[).*\";\n\n    public static final String[] EXCLUDED_PATTERNS = {\n            CLASS_ACCESS_PATTERN,\n            \"^dojo\\\\..*\",\n            \"^struts\\\\..*\",\n            \"^session\\\\..*\",\n            \"^request\\\\..*\",\n            \"^application\\\\..*\",\n            \"^servlet(Request|Response)\\\\..*\",\n            \"^parameters\\\\..*\"\n    };\n\n}\n```\n"}