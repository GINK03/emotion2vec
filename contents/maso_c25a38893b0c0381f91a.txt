{"tags": ["\u6587\u5b57\u5316\u3051", "R"], "context": " More than 1 year has passed since last update.png seems to work fine, even sometimes without the following addition. \n\npng(\"/tmp/test.png\")\npar(family=\"HiraMaruProN-W4\")\nplot(iris, main = \"\u30a2\u30e4\u30e1\u306e\u30c7\u30fc\u30bf\")\ndev.off()\n\nAlso, add the following chunk to the .Rprofile. This requires X. \n\nsetHook(packageEvent(\"grDevices\", \"onLoad\"),\n    function(...){\n        if(.Platform$OS.type == \"windows\")\n            grDevices::windowsFonts(sans =\"MS Gothic\",\n                                    serif=\"MS Mincho\",\n                                    mono =\"FixedFont\")\n        if(capabilities(\"aqua\"))\n            grDevices::quartzFonts(\n              sans =grDevices::quartzFont(\n                c(\"Hiragino Kaku Gothic Pro W3\",\n                  \"Hiragino Kaku Gothic Pro W6\",\n                  \"Hiragino Kaku Gothic Pro W3\",\n                  \"Hiragino Kaku Gothic Pro W6\")),\n              serif=grDevices::quartzFont(\n                c(\"Hiragino Mincho Pro W3\",\n                  \"Hiragino Mincho Pro W6\",\n                  \"Hiragino Mincho Pro W3\",\n                  \"Hiragino Mincho Pro W6\")))\n        if(capabilities(\"X11\"))\n            grDevices::X11.options(\n                fonts=c(\"-kochi-gothic-%s-%s---%d-------\",\n                        \"-adobe-symbol-medium-r---%d-------\"))\n        grDevices::pdf.options(family=\"Japan1GothicBBB\")\n        grDevices::ps.options(family=\"Japan1GothicBBB\")\n        }\n)\nattach(NULL, name = \"JapanEnv\")\nassign(\"familyset_hook\",\n       function() {\n            winfontdevs=c(\"windows\",\"win.metafile\",\n                          \"png\",\"bmp\",\"jpeg\",\"tiff\")\n            macfontdevs=c(\"quartz\",\"quartz_off_screen\")\n            devname=strsplit(names(dev.cur()),\":\")[[1L]][1]\n            if ((.Platform$OS.type == \"windows\") &&\n                (devname %in% winfontdevs))\n                    par(family=\"sans\")\n            if (capabilities(\"aqua\") &&\n                devname %in% macfontdevs)\n                    par(family=\"sans\")\n       },\n       pos=\"JapanEnv\")\nsetHook(\"plot.new\", get(\"familyset_hook\", pos=\"JapanEnv\"))\nsetHook(\"persp\", get(\"familyset_hook\", pos=\"JapanEnv\"))\n\n\n\n\npng seems to work fine, even sometimes without the following addition. \n\n>png(\"/tmp/test.png\")\npar(family=\"HiraMaruProN-W4\")\nplot(iris, main = \"\u30a2\u30e4\u30e1\u306e\u30c7\u30fc\u30bf\")\ndev.off()\n\n\nAlso, add the following chunk to the .Rprofile. This requires X. \n\n\n>setHook(packageEvent(\"grDevices\", \"onLoad\"),\n\tfunction(...){\n        if(.Platform$OS.type == \"windows\")\n            grDevices::windowsFonts(sans =\"MS Gothic\",\n                                    serif=\"MS Mincho\",\n                                    mono =\"FixedFont\")\n        if(capabilities(\"aqua\"))\n            grDevices::quartzFonts(\n              sans =grDevices::quartzFont(\n                c(\"Hiragino Kaku Gothic Pro W3\",\n                  \"Hiragino Kaku Gothic Pro W6\",\n                  \"Hiragino Kaku Gothic Pro W3\",\n                  \"Hiragino Kaku Gothic Pro W6\")),\n              serif=grDevices::quartzFont(\n                c(\"Hiragino Mincho Pro W3\",\n                  \"Hiragino Mincho Pro W6\",\n                  \"Hiragino Mincho Pro W3\",\n                  \"Hiragino Mincho Pro W6\")))\n        if(capabilities(\"X11\"))\n            grDevices::X11.options(\n                fonts=c(\"-kochi-gothic-%s-%s-*-*-%d-*-*-*-*-*-*-*\",\n                        \"-adobe-symbol-medium-r-*-*-%d-*-*-*-*-*-*-*\"))\n        grDevices::pdf.options(family=\"Japan1GothicBBB\")\n        grDevices::ps.options(family=\"Japan1GothicBBB\")\n        }\n)\n\n>attach(NULL, name = \"JapanEnv\")\nassign(\"familyset_hook\",\n       function() {\n            winfontdevs=c(\"windows\",\"win.metafile\",\n                          \"png\",\"bmp\",\"jpeg\",\"tiff\")\n            macfontdevs=c(\"quartz\",\"quartz_off_screen\")\n            devname=strsplit(names(dev.cur()),\":\")[[1L]][1]\n            if ((.Platform$OS.type == \"windows\") &&\n                (devname %in% winfontdevs))\n                    par(family=\"sans\")\n            if (capabilities(\"aqua\") &&\n                devname %in% macfontdevs)\n                    par(family=\"sans\")\n       },\n       pos=\"JapanEnv\")\nsetHook(\"plot.new\", get(\"familyset_hook\", pos=\"JapanEnv\"))\nsetHook(\"persp\", get(\"familyset_hook\", pos=\"JapanEnv\"))\n\n"}