{"context": " More than 1 year has passed since last update.\u3084\u308a\u305f\u3044\u3053\u3068\u306f\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u3067email\u3068password\u3092\u5165\u529b\u3057\u3066\u3001\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3068\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u30da\u30fc\u30b8\u306b\u9077\u79fb\u3057\u307e\u3059\u3002\n\n\n\n\u307e\u305a\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u30da\u30fc\u30b8\u3092\u7528\u610f\u3059\u308b\u305f\u3081\u306bPhoenix\u306eEcto\u306b\u95a2\u3059\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3080\u3068\u3044\u3044\u3067\u3059\u3002\n\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u306f\u30cd\u30c3\u30c8\u4e0a\u3067\u63a2\u3057\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u4e2d\u306bBootstrap3\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u306e\u3067\u3001Bootstrap3\u3082\u4f7f\u3044\u305f\u3044\u3067\u3059\u3002\u81ea\u5206\u306e\u3053\u306e\u524d\u306e\u6295\u7a3f\u3092\u53c2\u7167\u306b\u3059\u308b\u3068\u3044\u3044\u3067\u3059\u3002\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002--no-brunch\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u306f\u3053\u3053\u306b\u3042\u308a\u307e\u3059\u3002\n\n13:29:11 [N1210A001 => ~/Playground/elixir]\n$ mix phoenix.new hello_phoenix --no-brunch\n\n\n\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u306e\u30da\u30fc\u30b8\u3092\u7528\u610f\u3057\u307e\u3059\u3002\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068hello_phoenix/priv/repo/migrations/\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e0b\u306bmigration\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u3066\u3001\u5f8c\u3067\u4f7f\u3046$ mix ecto.migrate\u30b3\u30de\u30f3\u30c9\u306e\u70ba\u3067\u3059\u3002\n\n13:34:30 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix phoenix.gen.html User users name:string email:string password:string\n\n\nresources \"/users\", UserController\u3092hello_phoenix/web/router.ex\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\nhello_phoenix_dev\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u306a\u305chello_phoenix_dev\u3092\u4f5c\u6210\u3059\u308b\u304b\u306fhello_phoenix/config/dev.exs\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\npostgres\u306erole\u304c\u306a\u3044\u306a\u3069\u306e\u30a8\u30e9\u30fc\u51fa\u3066\u3044\u308b\u5834\u5408\u306f\u3053\u306e\u30da\u30fc\u30b8\u3067\u7b54\u3048\u306f\u63a2\u305b\u307e\u3059\u3002\n13:37:18 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix ecto.create\n\n\n\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u30fc\u30d9\u30b9\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n13:47:53 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix ecto.migrate\n\n\n\u3053\u308c\u3067\u30a2\u30d7\u30ea\u3092\u7acb\u3061\u4e0a\u3052\u3066\u307f\u307e\u3059\u3002\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\n13:48:01 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix phoenix.server\n\n\n*\u3000\u753b\u9762\u4e0a\u3067\u30e6\u30fc\u30b6\u3092\u8907\u6570\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\nBootstrap3\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nhttp://localhost:4000/\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306b\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u3057\u307e\u3059\u3002\n\n1) hello_phoenix/web/templates/layout/application.html.eex\u3092\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\n <!DOCTYPE html>\n <html lang=\"en\">\n   <head>\n     <meta charset=\"utf-8\">\n     <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n     <meta name=\"description\" content=\"\">\n     <meta name=\"author\" content=\"\">\n\n     <title>Hello Phoenix!</title>\n     <link rel=\"stylesheet\" href=\"<%= static_path(@conn, \"/css/bootstrap.css\") %>\">\n     <link rel=\"stylesheet\" href=\"<%= static_path(@conn, \"/css/login.css\") %>\">\n     <link rel=\"stylesheet\" href=\"<%= static_path(@conn, \"/js/bootstrap.js\") %>\">\n   </head>\n\n   <body>\n     <%= @inner %>\n   </body>\n </html>\n\n2) hello_phoenix/web/templates/page/index.html.eex\u3092\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\n <div class=\"container\">\n     <div class=\"row\">\n         <div class=\"col-sm-6 col-md-4 col-md-offset-4\">\n             <div class=\"account-wall\">\n               <form class=\"form-signin\" action=\"<%= page_path(@conn, :login) %>\" method=\"post\">\n                 <input type=\"text\" class=\"form-control\" name=\"user[email]\" placeholder=\"Email\" required autofocus>\n                 <input type=\"password\" class=\"form-control\" name=\"user[password]\" placeholder=\"Password\" required>\n                 <input type=\"hidden\" name=\"_csrf_token\" value=\"<%= get_csrf_token() %>\">\n                 <button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\">\n                     Sign in</button>\n                 <label class=\"checkbox pull-left\">\n                     <input type=\"checkbox\" value=\"remember-me\">\n                     Remember me\n                 </label>\n                 <a href=\"#\" class=\"pull-right need-help\">Need help? </a><span class=\"clearfix\"></span>\n                 </form>\n             </div>\n             <a href=\"#\" class=\"text-center new-account\">Create an account </a>\n         </div>\n     </div>\n </div>\n\n\u306a\u305c<input type=\"hidden\" name=\"_csrf_token\" value=\"<%= get_csrf_token() %>\">\u3092\u5165\u308c\u3066\u3044\u308b\u304b\u306fstackoverflow\u306e\u8cea\u554f\u3092\u53c2\u7167\u3059\u308b\u3068\u3044\u3044\u3067\u3059\u3002\u3053\u306e1\u884c\u3092\u5165\u308c\u306a\u3044\u3068\u3001\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\u3002\ninvalid CSRF (Cross Site Forgery Protection) token, make sure all requests include a '_csrf_token' param or an 'x-csrf-token' header\n\n3) login.css\u30d5\u30a1\u30a4\u30eb\u3092\u4e0b\u306e\u4e2d\u8eab\u3067\u4f5c\u6210\u3057\u3066\u3001hello_phoenix/priv/static/css/\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n.form-signin\n{\n    max-width: 330px;\n    padding: 15px;\n    margin: 0 auto;\n}\n.form-signin .form-signin-heading, .form-signin .checkbox\n{\n    margin-bottom: 10px;\n}\n.form-signin .checkbox\n{\n    font-weight: normal;\n}\n.form-signin .form-control\n{\n    position: relative;\n    font-size: 16px;\n    height: auto;\n    padding: 10px;\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n}\n.form-signin .form-control:focus\n{\n    z-index: 2;\n}\n.form-signin input[type=\"text\"]\n{\n    margin-bottom: -1px;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n}\n.form-signin input[type=\"password\"]\n{\n    margin-bottom: 10px;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n}\n.account-wall\n{\n    margin-top: 20px;\n    padding: 40px 0px 20px 0px;\n    background-color: #f7f7f7;\n    -moz-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);\n    -webkit-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);\n    box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);\n}\n.login-title\n{\n    color: #555;\n    font-size: 18px;\n    font-weight: 400;\n    display: block;\n}\n.profile-img\n{\n    width: 96px;\n    height: 96px;\n    margin: 0 auto 10px;\n    display: block;\n    -moz-border-radius: 50%;\n    -webkit-border-radius: 50%;\n    border-radius: 50%;\n}\n.need-help\n{\n    margin-top: 10px;\n}\n.new-account\n{\n    display: block;\n    margin-top: 10px;\n}\n\n4) hello_phoenix/web/router.ex\u30d5\u30a1\u30a4\u30eb\u306b/login\u3092\u90e8\u5206\u3092\u8ffd\u52a0\u3057\u3066\u3001\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u6b32\u3057\u3044\u306e\u306fpost\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n defmodule HelloPhoenix.Router do\n   use HelloPhoenix.Web, :router\n\n   pipeline :browser do\n     plug :accepts, [\"html\"]\n     plug :fetch_session\n     plug :fetch_flash\n     plug :protect_from_forgery\n   end\n\n   pipeline :api do\n     plug :accepts, [\"json\"]\n   end\n\n   scope \"/\", HelloPhoenix do\n     pipe_through :browser # Use the default browser stack\n\n     get \"/\", PageController, :index\n     post \"/login\", PageController, :login\n     resources \"/users\", UserController\n   end\n end\n\n\n5) \u3053\u308c\u3067\u30a2\u30d7\u30ea\u3092\u8d77\u52d5\u3057\u3066\u3001\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n14:28:36 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix phoenix.server\n\n\n\n\u3053\u308c\u304b\u3089\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u306b\u5165\u308a\u307e\u3059\u3002hello_phoenix/web/controllers/page_controller.ex\u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\n\n defmodule HelloPhoenix.PageController do\n   use HelloPhoenix.Web, :controller\n\n   # `query = from u in User,`\u90e8\u5206\n   # \u306e`User`\u304c\u4f7f\u3048\u308b\u70ba\u306balias\u3057\u3066\u3044\u308b\n\n   alias HelloPhoenix.User\n\n   # `redirect conn, to: Helpers.user_path(conn, :index)`\u90e8\u5206\n   # \u306e`Helpers.user_path`\u304c\u4f7f\u3048\u308b\u305f\u3081\u306balias\u3092\u3057\u3066\u3044\u308b\n\n   alias HelloPhoenix.Router.Helpers\n\n   plug :action\n\n   def index(conn, _params) do\n     render conn, \"index.html\"\n   end\n\n   def login(conn, %{\"user\" => %{\"email\" => email, \"password\" => password}}) do\n     query = from u in User,\n               where: u.email == ^email,\n               where: u.password == ^password,\n               select: u.id\n     result = HelloPhoenix.Repo.all(query)\n     # \u30e6\u30fc\u30b6\u30fc\u304c\u5b58\u5728\u3059\u308c\u3070\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u30da\u30fc\u30b8\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u307e\u3059\n     case length(result) > 0 do\n       true ->\n         redirect conn, to: Helpers.user_path(conn, :index)\n       false ->\n         text conn, \"\u30ed\u30b0\u30a4\u30f3\u5931\u6557\"\n     end\n   end\n end\n\n\u3053\u308c\u3067\u4e00\u756a\u7c21\u5358\u306a\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u307e\u305f\u5b9f\u88c5\u3057\u3066\u3044\u306a\u3044\u90e8\u5206\u306f\n1) \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u6697\u53f7\u5316\n2) \u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u306a\u3044\u30e6\u30fc\u30b6\u30fc\u306f\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u3092\u898b\u3089\u308c\u306a\u3044\u3088\u3046\u306b\n\u3069\u306a\u305f\u304b\u4e0a\u306e\u3088\u3046\u306a\u6a5f\u80fd\u5b9f\u88c5\u3057\u305f\u3089\u3001\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002\u7279\u306b\uff12\uff09\u756a\u76ee\u3067\u3059\u3002\n\n\u3084\u308a\u305f\u3044\u3053\u3068\u306f\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u3067`email`\u3068`password`\u3092\u5165\u529b\u3057\u3066\u3001\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3068\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u30da\u30fc\u30b8\u306b\u9077\u79fb\u3057\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-06-16 13.04.08.png](https://qiita-image-store.s3.amazonaws.com/0/54698/a40e3140-89b4-c4ee-d355-53058cb23b78.png)\n\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-06-16 13.04.44.png](https://qiita-image-store.s3.amazonaws.com/0/54698/9fbf7e9f-ab46-41be-d160-b89f327592e7.png)\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-06-16 13.06.35.png](https://qiita-image-store.s3.amazonaws.com/0/54698/c310064b-34b3-8857-ad00-083bf61e1a2d.png)\n\n\u307e\u305a\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u30da\u30fc\u30b8\u3092\u7528\u610f\u3059\u308b\u305f\u3081\u306bPhoenix\u306e[Ecto\u306b\u95a2\u3059\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://www.phoenixframework.org/v0.13.1/docs/ecto-models)\u3092\u8aad\u3080\u3068\u3044\u3044\u3067\u3059\u3002\n\n\n\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u306f[\u30cd\u30c3\u30c8\u4e0a\u3067\u63a2\u3057\u305f\u3082\u306e](https://gist.github.com/bMinaise/7329874)\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u4e2d\u306bBootstrap3\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u306e\u3067\u3001Bootstrap3\u3082\u4f7f\u3044\u305f\u3044\u3067\u3059\u3002\u81ea\u5206\u306e[\u3053\u306e\u524d\u306e\u6295\u7a3f](http://qiita.com/ColdFreak/items/a1cb5f86474986fd4a9e)\u3092\u53c2\u7167\u306b\u3059\u308b\u3068\u3044\u3044\u3067\u3059\u3002\n\n\n* \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002`--no-brunch`\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u306f[\u3053\u3053](http://www.phoenixframework.org/v0.13.1/docs/up-and-running)\u306b\u3042\u308a\u307e\u3059\u3002\n\n```\n13:29:11 [N1210A001 => ~/Playground/elixir]\n$ mix phoenix.new hello_phoenix --no-brunch\n```\n\n* \u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u306e\u30da\u30fc\u30b8\u3092\u7528\u610f\u3057\u307e\u3059\u3002\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068`hello_phoenix/priv/repo/migrations/`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e0b\u306bmigration\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u3066\u3001\u5f8c\u3067\u4f7f\u3046`$ mix ecto.migrate`\u30b3\u30de\u30f3\u30c9\u306e\u70ba\u3067\u3059\u3002\n\n```\n13:34:30 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix phoenix.gen.html User users name:string email:string password:string\n```\n\n* `resources \"/users\", UserController`\u3092`hello_phoenix/web/router.ex`\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\n* `hello_phoenix_dev`\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u306a\u305c`hello_phoenix_dev`\u3092\u4f5c\u6210\u3059\u308b\u304b\u306f`hello_phoenix/config/dev.exs`\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n`postgres`\u306erole\u304c\u306a\u3044\u306a\u3069\u306e\u30a8\u30e9\u30fc\u51fa\u3066\u3044\u308b\u5834\u5408\u306f[\u3053\u306e\u30da\u30fc\u30b8](http://www.phoenixframework.org/v0.13.1/docs/ecto-models)\u3067\u7b54\u3048\u306f\u63a2\u305b\u307e\u3059\u3002\n\n```\n13:37:18 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix ecto.create\n```\n\n* \u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u30fc\u30d9\u30b9\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n13:47:53 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix ecto.migrate\n```\n\n* \u3053\u308c\u3067\u30a2\u30d7\u30ea\u3092\u7acb\u3061\u4e0a\u3052\u3066\u307f\u307e\u3059\u3002\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\n```\n13:48:01 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix phoenix.server\n```\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-06-16 13.49.03.png](https://qiita-image-store.s3.amazonaws.com/0/54698/5ef759f7-55b2-e36e-afc4-d7ef1b072336.png)\n\n\n*\u3000\u753b\u9762\u4e0a\u3067\u30e6\u30fc\u30b6\u3092\u8907\u6570\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-06-16 13.55.00.png](https://qiita-image-store.s3.amazonaws.com/0/54698/8b3c2e48-97f2-6802-c7bb-c207525726d6.png)\n\n\n* [Bootstrap3\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u307e\u3059](http://qiita.com/ColdFreak/items/a1cb5f86474986fd4a9e)\u3002\n\n* `http://localhost:4000/`\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306b\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u3057\u307e\u3059\u3002\n\n1) `hello_phoenix/web/templates/layout/application.html.eex`\u3092\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\n\n```\n <!DOCTYPE html>\n <html lang=\"en\">\n   <head>\n     <meta charset=\"utf-8\">\n     <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n     <meta name=\"description\" content=\"\">\n     <meta name=\"author\" content=\"\">\n\n     <title>Hello Phoenix!</title>\n     <link rel=\"stylesheet\" href=\"<%= static_path(@conn, \"/css/bootstrap.css\") %>\">\n     <link rel=\"stylesheet\" href=\"<%= static_path(@conn, \"/css/login.css\") %>\">\n     <link rel=\"stylesheet\" href=\"<%= static_path(@conn, \"/js/bootstrap.js\") %>\">\n   </head>\n\n   <body>\n     <%= @inner %>\n   </body>\n </html>\n```\n\n2) `hello_phoenix/web/templates/page/index.html.eex`\u3092\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\n\n```\n <div class=\"container\">\n     <div class=\"row\">\n         <div class=\"col-sm-6 col-md-4 col-md-offset-4\">\n             <div class=\"account-wall\">\n               <form class=\"form-signin\" action=\"<%= page_path(@conn, :login) %>\" method=\"post\">\n                 <input type=\"text\" class=\"form-control\" name=\"user[email]\" placeholder=\"Email\" required autofocus>\n                 <input type=\"password\" class=\"form-control\" name=\"user[password]\" placeholder=\"Password\" required>\n                 <input type=\"hidden\" name=\"_csrf_token\" value=\"<%= get_csrf_token() %>\">\n                 <button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\">\n                     Sign in</button>\n                 <label class=\"checkbox pull-left\">\n                     <input type=\"checkbox\" value=\"remember-me\">\n                     Remember me\n                 </label>\n                 <a href=\"#\" class=\"pull-right need-help\">Need help? </a><span class=\"clearfix\"></span>\n                 </form>\n             </div>\n             <a href=\"#\" class=\"text-center new-account\">Create an account </a>\n         </div>\n     </div>\n </div>\n```\n\n\u306a\u305c`<input type=\"hidden\" name=\"_csrf_token\" value=\"<%= get_csrf_token() %>\">`\u3092\u5165\u308c\u3066\u3044\u308b\u304b\u306f[stackoverflow\u306e\u8cea\u554f](http://stackoverflow.com/questions/28595153/phoenix-invalid-csrf-cross-site-forgery-protection-token-error)\u3092\u53c2\u7167\u3059\u308b\u3068\u3044\u3044\u3067\u3059\u3002\u3053\u306e1\u884c\u3092\u5165\u308c\u306a\u3044\u3068\u3001\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\u3002\n`invalid CSRF (Cross Site Forgery Protection) token, make sure all requests include a '_csrf_token' param or an 'x-csrf-token' header`\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-06-16 15.09.07.png](https://qiita-image-store.s3.amazonaws.com/0/54698/f73912d5-d1d1-8874-f694-b3639266be8b.png)\n\n\n3) `login.css`\u30d5\u30a1\u30a4\u30eb\u3092\u4e0b\u306e\u4e2d\u8eab\u3067\u4f5c\u6210\u3057\u3066\u3001`hello_phoenix/priv/static/css/`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n\n```\n.form-signin\n{\n    max-width: 330px;\n    padding: 15px;\n    margin: 0 auto;\n}\n.form-signin .form-signin-heading, .form-signin .checkbox\n{\n    margin-bottom: 10px;\n}\n.form-signin .checkbox\n{\n    font-weight: normal;\n}\n.form-signin .form-control\n{\n    position: relative;\n    font-size: 16px;\n    height: auto;\n    padding: 10px;\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n}\n.form-signin .form-control:focus\n{\n    z-index: 2;\n}\n.form-signin input[type=\"text\"]\n{\n    margin-bottom: -1px;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n}\n.form-signin input[type=\"password\"]\n{\n    margin-bottom: 10px;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n}\n.account-wall\n{\n    margin-top: 20px;\n    padding: 40px 0px 20px 0px;\n    background-color: #f7f7f7;\n    -moz-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);\n    -webkit-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);\n    box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);\n}\n.login-title\n{\n    color: #555;\n    font-size: 18px;\n    font-weight: 400;\n    display: block;\n}\n.profile-img\n{\n    width: 96px;\n    height: 96px;\n    margin: 0 auto 10px;\n    display: block;\n    -moz-border-radius: 50%;\n    -webkit-border-radius: 50%;\n    border-radius: 50%;\n}\n.need-help\n{\n    margin-top: 10px;\n}\n.new-account\n{\n    display: block;\n    margin-top: 10px;\n}\n```\n\n4) `hello_phoenix/web/router.ex`\u30d5\u30a1\u30a4\u30eb\u306b`/login`\u3092\u90e8\u5206\u3092\u8ffd\u52a0\u3057\u3066\u3001\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u6b32\u3057\u3044\u306e\u306f`post`\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\n```\n defmodule HelloPhoenix.Router do\n   use HelloPhoenix.Web, :router\n\n   pipeline :browser do\n     plug :accepts, [\"html\"]\n     plug :fetch_session\n     plug :fetch_flash\n     plug :protect_from_forgery\n   end\n\n   pipeline :api do\n     plug :accepts, [\"json\"]\n   end\n\n   scope \"/\", HelloPhoenix do\n     pipe_through :browser # Use the default browser stack\n\n     get \"/\", PageController, :index\n     post \"/login\", PageController, :login\n     resources \"/users\", UserController\n   end\n end\n\n```\n\n5) \u3053\u308c\u3067\u30a2\u30d7\u30ea\u3092\u8d77\u52d5\u3057\u3066\u3001\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\n```\n14:28:36 [N1210A001 => ~/Playground/elixir/hello_phoenix]\n$ mix phoenix.server\n```\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-06-16 14.29.17.png](https://qiita-image-store.s3.amazonaws.com/0/54698/64a59fb2-81c2-43ec-378b-38c025c209e7.png)\n\n\n* \u3053\u308c\u304b\u3089\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u306b\u5165\u308a\u307e\u3059\u3002`hello_phoenix/web/controllers/page_controller.ex`\u30d5\u30a1\u30a4\u30eb\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059\u3002\n\n```\n defmodule HelloPhoenix.PageController do\n   use HelloPhoenix.Web, :controller\n\n   # `query = from u in User,`\u90e8\u5206\n   # \u306e`User`\u304c\u4f7f\u3048\u308b\u70ba\u306balias\u3057\u3066\u3044\u308b\n\n   alias HelloPhoenix.User\n\n   # `redirect conn, to: Helpers.user_path(conn, :index)`\u90e8\u5206\n   # \u306e`Helpers.user_path`\u304c\u4f7f\u3048\u308b\u305f\u3081\u306balias\u3092\u3057\u3066\u3044\u308b\n\n   alias HelloPhoenix.Router.Helpers\n\n   plug :action\n\n   def index(conn, _params) do\n     render conn, \"index.html\"\n   end\n\n   def login(conn, %{\"user\" => %{\"email\" => email, \"password\" => password}}) do\n     query = from u in User,\n               where: u.email == ^email,\n               where: u.password == ^password,\n               select: u.id\n     result = HelloPhoenix.Repo.all(query)\n     # \u30e6\u30fc\u30b6\u30fc\u304c\u5b58\u5728\u3059\u308c\u3070\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u30da\u30fc\u30b8\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u307e\u3059\n     case length(result) > 0 do\n       true ->\n         redirect conn, to: Helpers.user_path(conn, :index)\n       false ->\n         text conn, \"\u30ed\u30b0\u30a4\u30f3\u5931\u6557\"\n     end\n   end\n end\n```\n\n\u3053\u308c\u3067\u4e00\u756a\u7c21\u5358\u306a\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u307e\u305f\u5b9f\u88c5\u3057\u3066\u3044\u306a\u3044\u90e8\u5206\u306f\n\n1) \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u6697\u53f7\u5316\n2) \u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u306a\u3044\u30e6\u30fc\u30b6\u30fc\u306f\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u3092\u898b\u3089\u308c\u306a\u3044\u3088\u3046\u306b\n\n\u3069\u306a\u305f\u304b\u4e0a\u306e\u3088\u3046\u306a\u6a5f\u80fd\u5b9f\u88c5\u3057\u305f\u3089\u3001\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002\u7279\u306b\uff12\uff09\u756a\u76ee\u3067\u3059\u3002\n", "tags": ["Elixir", "Phoenix", "login"]}