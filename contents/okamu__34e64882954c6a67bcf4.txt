{"context": "\n\n\"\u307e\u305f\u6b7b\u3093\u3067\u308b\uff01\uff01\"\u30b3\u30f3\u30c6\u30ca\u306e\u6b7b\u6d3b\u7ba1\u7406\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\n\n\n\nRancherOS\u3067\u672c\u683c\u7684\u306a\u30b5\u30fc\u30d0\u30fc\u3092\u69cb\u7bc9\u3067\u5c11\u3057\u89e6\u3063\u3066\u307f\u305f\u306e\u3067\u30e1\u30e2\n\n\n\u7d4c\u7def\n\n\u6700\u8fd1docker\u304c\u4eba\u6c17\u3067\u3042\u308b\u304c\u3001\u6b7b\u6d3b\u7ba1\u7406\u3092\u3057\u3063\u304b\u308a\u3057\u3066\u306a\u3044\u3068 \u201d\u30b3\u30f3\u30c6\u30ca\u304c\u6b7b\u3093\u3067\u305f\uff01\uff01\u201d \u3068\u3044\u3046\u30b1\u30fc\u30b9\u306f\u3088\u304f\u3042\u308b\n\"slack\"\u3068\u304b\u306b\u300c\u6b7b\u3093\u3060\u305c\u3047\uff01\u300d\u3063\u3068\u901a\u77e5\u304c\u6765\u308c\u3070\u3059\u3050\u306b\u5bfe\u5fdc\u3067\u304d\u305d\u3046\u3060\u3057\u3001\u304b\u3063\u3053\u3044\u3044\n\u4eca\u306edocker\u30b5\u30fc\u30d0\u30fc\u306e\u72b6\u614b\u304c\u30ab\u30c3\u30b3\u3088\u304f\u30b0\u30e9\u30d5\u3067\u51fa\u308b\u3068\u3001\u304b\u3063\u3053\u3044\u3044\n\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u6b7b\u6d3b\u7ba1\u7406\n\n\u6b7b\u6d3b\u7ba1\u7406\u3057\u3066\u304f\u308c\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\n\nDATADOG(\u304a\u3059\u3059\u3081)\nPrometheus\n\n\nDATADOG\n\n\n\nDatadog\u3068\u306fIT\u30b7\u30b9\u30c6\u30e0\u306e\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002\u5c11\u3057\u4f5c\u696d\u3092\u884c\u3046\u3060\u3051\u3067\u3054\u81ea\u8eab\u306eIT\u30b7\u30b9\u30c6\u30e0\u3092\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3092\u898b\u3066\u60da\u308c\u307e\u3057\u305f\u3000Datadog\u306e\u672c\u5f53\u306e\u9b45\u529b\u3068\u306f\n\n\n\n\u65e9\u901f\u3001\u5c0e\u5165\u3057\u3066\u307f\u308b\n\n\u7121\u6599\u7248\u3068\u6709\u6599\u7248\u304c\u3042\u308b\u304c\u3001\u4eca\u56de\u306f\u7121\u6599\u7248\u3092\u4f7f\u3046\n\u516c\u5f0fDATADOG\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\nadd host\u306e\u753b\u9762\u3067\u300cDocker\u300d\u3068\u3042\u308b\u304cAPIKey\u306e\u307f\u3092\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304f\n\n\n\n\u25cbRancher\u306e\u5834\u5408\n\nrancher\u306e\u7ba1\u7406\u753b\u9762\u304b\u3089\u300cCATALOG\u300d->\u300cDATADOG\u300d\u3092\u9078\u629e\n\n\n\nAPIKey\u306e\u5165\u529b\n\u300cLaunch\u300d\u3059\u308c\u3070\u7d42\u4e86\uff01\u3042\u3089\u3001\u304b\u3093\u305f\u3093\u3002\n\n\n\u25cb\u666e\u901a\u306eDocker\u306e\u5834\u5408(docker-compose)\n\ndocker-compose.yml\n\ndatadog-init:\n  labels:\n    io.rancher.scheduler.global: 'true'\n    io.rancher.container.pull_image: always\n    io.rancher.container.start_once: 'true'\n  command:\n  - /bin/true\n  image: janeczku/datadog-rancher-init:latest\n  volumes:\n  - /opt/rancher\n  net: none\ndatadog-agent:\n  environment:\n    API_KEY: xxxxxxxxxxxxxxxxxxxxxxxxxx\n    DOGSTATSD_ONLY: 'false'\n  labels:\n    io.rancher.scheduler.global: 'true'\n    io.rancher.sidekicks: datadog-init\n  command:\n  - supervisord\n  - -n\n  - -c\n  - /etc/dd-agent/supervisor.conf\n  entrypoint:\n  - /opt/rancher/entrypoint.sh\n  image: datadog/docker-dd-agent:11.0.570\n  volumes:\n  - /var/run/docker.sock:/var/run/docker.sock\n  - /proc/:/host/proc/:ro\n  - /sys/fs/cgroup/:/host/sys/fs/cgroup:ro\n  volumes_from:\n  - datadog-init\n\n\n$ docker-compose up\n\n\u65e9\u901f\u3001\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3068\n\n\n\u3053\u306e\u30a4\u30d9\u30f3\u30c8\u306e\u753b\u9762\u3067\u306f\u3001\u30b3\u30f3\u30c6\u30ca\u304c\u4f5c\u3089\u308c\u305f\u3088\u30fc\u3068\u304b\u306e\u30a4\u30d9\u30f3\u30c8\u304c\u6642\u7cfb\u5217\u3067\u8868\u793a\u3055\u308c\u308b\u3063\u307d\u3044\n\n\ndocker\u3068slack\u306eintegration\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n\ndashboard\u306bdocker\u304c\u8ffd\u52a0\u3055\u308c\u305f\u306e\u3067\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\n\ndocker\u306e\u30b0\u30e9\u30d5\u3092\u8997\u3044\u3066\u307f\u308b\n\n\n\u3059\u3093\u3052\u3047\u304d\u308c\u3044\uff01\uff01\uff01\uff01\n\n\n\u300c\u672c\u984c\u300d\u30b3\u30f3\u30c6\u30ca\u304c\u6b7b\u3093\u3060\u3089slack\u306b\u901a\u77e5\u3092\u9001\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\n\n\nslack\u5074\u3067\u306e\u8a2d\u5b9a\n\n\u5de6\u4e0a\u306e\u8a2d\u5b9a\u3067\u304d\u305d\u3046\u306a\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300cApps&integrations\u300d\u3092\u9078\u629e\n\u300cDATADOG\u300d\u3092\u691c\u7d22\u3057\u3066\u300cAdd Configrations\u300d\n\u300cWebhook URL\u300d\u3092\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304f\n\n\ndatadog\u5074\u3067\u306e\u8a2d\u5b9a\n\n\u5148\u307b\u3069\u306eURL\u3068\u901a\u77e5\u3057\u305f\u3044\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u5165\u529b\n\n\n\n\u3068\u308a\u3042\u3048\u305aOK\n\n\n\u30a2\u30e9\u30fc\u30c8\u306e\u57fa\u6e96\u5024\u306e\u8a2d\u5b9a\n\n\u300cMonitors\u300d->\u300cnew Monitor\u300d->\u300cMetric\u300d\u3092\u9078\u629e\n\n\n\nrun\u30b3\u30f3\u30c6\u30ca\u30fc\u304c\uff11\u3088\u308a\u4e0b\u304c\u308b\u3068slack\u306b\u901a\u77e5\u304c\u306a\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u307f\u305f\n\n\u901a\u77e5\u304c\u304f\u308b\u3068\u3053\u3093\u306a\u611f\u3058\n\n\n\n\u3053\u308c\u3067\u3072\u3068\u307e\u305a\u3001 \u300c\u6b7b\u3093\u3067\u308b\u3084\u3093\uff01\uff01\u300d \u304c\u65e9\u3081\u306b\u308f\u304b\u308b\u3088\u3046\u306b\u306a\u3063\u305f\n\n\nPrometheus\n\n\n\nPrometheus \u3068\u306f\u3000\u4e00\u822c\u7684\u306a\u76e3\u8996\u30c4\u30fc\u30eb\u306e\u3088\u3046\u306b\u3001\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\u3001\u6570\u5024\u306e\u8868\u793a\u3001\u30b0\u30e9\u30d5\u306e\u8868\u793a\u3001\u30a2\u30e9\u30fc\u30c8\u3092\u51fa\u3059\u6a5f\u80fd\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u308c\u3060\u3051\u3067\u306a\u304f\u3001Prometheus \u306f\u72ec\u81ea\u306e\u30c7\u30fc\u30bf\u30e2\u30c7\u30eb\u3092\u6301\u3061\u3001\u30af\u30a8\u30ea\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u8a55\u4fa1\u3084\u30b0\u30e9\u30d5\u5316\u3092\u884c\u3048\u307e\u3059\u3002\n\n\n\u65e9\u901f\u3001\u5c0e\u5165\u3057\u3066\u307f\u308b\n\n\u25cbRancher\u306e\u5834\u5408\n\nrancher\u306e\u7ba1\u7406\u753b\u9762\u304b\u3089\u300cCATALOG\u300d->\u300cPrometheus\u300d\u3092\u9078\u629e\n\n\n\n\u300cLaunch\u300d\u3059\u308c\u3070\u7d42\u4e86\uff01\u3042\u3089\u3001\u304b\u3093\u305f\u3093\u3002\n\n\n\u25cb\u666e\u901a\u306eDocker\u306e\u5834\u5408(docker-compose)\n\ndocker-compose.yml\n\ngraf-db:\n  command:\n  - cat\n  tty: true\n  image: infinityworks/graf-db:08\n  links:\n  - prometheus:prometheus\n  volumes:\n  - /var/lib/grafana/\nprometheus-rancher-exporter:\n  labels:\n    io.rancher.container.create_agent: 'true'\n    io.rancher.container.agent.role: environment\n  tty: true\n  image: infinityworks/prometheus-rancher-exporter:04\nprometheus:\n  ports:\n  - 9090:9090/tcp\n  labels:\n    io.rancher.sidekicks: prom-conf\n  command:\n  - -alertmanager.url=http://alertmanager:9093\n  - -config.file=/etc/prom-conf/prometheus.yml\n  - -storage.local.path=/prometheus\n  - -web.console.libraries=/etc/prometheus/console_libraries\n  - -web.console.templates=/etc/prometheus/consoles\n  tty: true\n  image: prom/prometheus:0.18.0\n  links:\n  - ranch-eye:ranch-eye\n  - node-exporter:node-exporter\n  volumes_from:\n  - prom-conf\ngrafana:\n  ports:\n  - 3000:3000/tcp\n  labels:\n    io.rancher.sidekicks: graf-db\n  tty: true\n  image: grafana/grafana:3.0.1\n  links:\n  - prometheus:prometheus\n  volumes_from:\n  - graf-db\nprom-conf:\n  tty: true\n  image: infinityworks/prom-conf:11\n  links:\n  - ranch-eye:ranch-eye\n  - node-exporter:node-exporter\n  volumes:\n  - /etc/prom-conf/\ninfluxdb:\n  ports:\n  - 2003:2003/tcp\n  - 8083:8083/tcp\n  - 8086:8086/tcp\n  - 8090:8090/tcp\n  environment:\n    GRAPHITE_BINDING: :2003\n    GRAPHITE_DB: rancher\n    PRE_CREATE_DB: grafana;prometheus;rancher\n  image: tutum/influxdb:0.10\nranch-eye:\n  ports:\n  - 9104:9104/tcp\n  labels:\n    io.rancher.scheduler.global: 'true'\n    io.rancher.container.dns: 'true'\n  tty: true\n  image: infinityworks/ranch-eye:03\n  stdin_open: true\n  net: host\nnode-exporter:\n  labels:\n    io.rancher.scheduler.global: 'true'\n  tty: true\n  image: prom/node-exporter:latest\n  stdin_open: true\n\n\n$ docker-compose up\n\n\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b(3000\u756a\u30dd\u30fc\u30c8\u306e\u307b\u3046)\n\n\u5916\u90e8\u306b\u306f\u516c\u958b\u3057\u305f\u304f\u306a\u3044\u306e\u3067.ssh/config\u306blocalFoward\u3057\u30663000\u756a\u3092\u8ee2\u9001\u3059\u308b\ncontainer status\u306f\u3053\u3093\u306a\u611f\u3058\n\n\n\nHost Status\u306f\u306a\u3093\u304b\u304b\u3063\u3053\u3044\u3044\uff01\n\n\n\n\u7279\u5b9a\u306e\u30b3\u30f3\u30c6\u30ca\u304c\u6b7b\u3093\u3060\u6642\u306b\u901a\u77e5\u3092\u9001\u308b\n\n\u306a\u3093\u3068\u306a\u304f\u3050\u3050\u3063\u305f\u3060\u3051\u3060\u3051\u3069\u3001\u901a\u77e5\u306f\u3069\u3046\u306b\u304b\u3059\u308c\u3070\u3067\u304d\u308b\u3063\u307d\u3044\u3051\u3069\u3001\u9762\u5012\u304f\u3055\u305d\u3046\nDocker \u3067 Sensu + Graphite + Grafana \u74b0\u5883\u69cb\u7bc9\nhttp://docs.grafana.org/tutorials/hubot_howto/\n\u4eca\u56de\u306f\u898b\u9001\u308a\u307e\u3059\n\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\n\n\n\u30b3\u30f3\u30c6\u30ca\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u3092\u8b66\u544a\u3057\u3066\u304f\u308c\u308b\n\nrancher-bench-security\ndocker-bench-security\n\n\n\u5c0e\u5165\u3057\u3066\u307f\u308b\n\n\u25cbrancher\u306e\u4eba\n\nrancher-bench-security\n\u300cCATALOG\u300d->\u300crancher-bench-security\u300d\n\n\n\n\u300cLaunch\u300d\u3067\u304a\u308f\u308a\n\n\n\u25cbdocker\u306e\u4eba\n\ndocker-bench-security\n\ndocker run -it --net host --pid host --cap-add audit_control \\\n    -v /var/lib:/var/lib \\\n    -v /var/run/docker.sock:/var/run/docker.sock \\\n    -v /usr/lib/systemd:/usr/lib/systemd \\\n    -v /etc:/etc --label docker_bench_security \\\n    docker/docker-bench-security\n\n\n\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\n\n\u3053\u308c\u3082\u5916\u90e8\u306b\u306f\u516c\u958b\u3057\u305f\u304f\u306a\u3044\u306e\u3067\u3001bench_security\u30b3\u30f3\u30c6\u30ca\u306e80\u30dd\u30fc\u30c8\u3092\u9069\u5f53\u306b8888\u30dd\u30fc\u30c8\u306b\u3057\u3066\u30ed\u30fc\u30ab\u30eb\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u3066web\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\n\n\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u51fa\u308b(github\u306e\u30b5\u30f3\u30d7\u30eb)\n\u3053\u306ewarm\u3092\u4fee\u6b63\u3057\u3068\u304b\u3093\u3068\u3044\u304b\u3093\u307f\u305f\u3044\u3084\u306d\n\n\n\u307e\u3068\u3081\n\n\u3053\u3093\u306a\u308f\u3051\u3067\u3001\u306a\u3093\u3068\u306a\u304f\u6b7b\u6d3b\u7ba1\u7406\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u306b\u3064\u3044\u3066\u306f\u5927\u4e08\u592b\u304b\u306a\u3041\u3068\n\u524d\u3005\u304b\u3089\u6c17\u306b\u306a\u3063\u3066\u305f\u201dVuls\u201d\u306f\u3001RancherOS\u304c\u5bfe\u5fdc\u3057\u3066\u306a\u3044\u3089\u3057\u304f\u3066\u8ae6\u3081\u307e\u3057\u305f\u304c\u3001\u5bfe\u5fdc\u3057\u305f\u3089\u4f7f\u3044\u305f\u3044\n\u305d\u306e\u4ed6\u306b\u3082Rancher\u3067\u4f7f\u3048\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u305f\u304f\u3055\u3093\u3042\u308b\u3057\u3001\u4eca\u3082\u5897\u3048\u3066\u3044\u308b\u306e\u3067\u305f\u304f\u3055\u3093\u4f7f\u3063\u3066\u3044\u304d\u305f\u3044\n\n# \"\u307e\u305f\u6b7b\u3093\u3067\u308b\uff01\uff01\"\u30b3\u30f3\u30c6\u30ca\u306e\u6b7b\u6d3b\u7ba1\u7406\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\n\n![rancher-docker.png](https://qiita-image-store.s3.amazonaws.com/0/62822/72da51f6-163c-ca0d-c602-86a6a3943be4.png)\n\n+ [RancherOS\u3067\u672c\u683c\u7684\u306a\u30b5\u30fc\u30d0\u30fc\u3092\u69cb\u7bc9](http://qiita.com/okamu_/items/da52b4dc12221feca55c)\u3067\u5c11\u3057\u89e6\u3063\u3066\u307f\u305f\u306e\u3067\u30e1\u30e2\n\n## \u7d4c\u7def\n+ \u6700\u8fd1docker\u304c\u4eba\u6c17\u3067\u3042\u308b\u304c\u3001\u6b7b\u6d3b\u7ba1\u7406\u3092\u3057\u3063\u304b\u308a\u3057\u3066\u306a\u3044\u3068 **\u201d\u30b3\u30f3\u30c6\u30ca\u304c\u6b7b\u3093\u3067\u305f\uff01\uff01\u201d** \u3068\u3044\u3046\u30b1\u30fc\u30b9\u306f\u3088\u304f\u3042\u308b\n+ \"slack\"\u3068\u304b\u306b\u300c\u6b7b\u3093\u3060\u305c\u3047\uff01\u300d\u3063\u3068\u901a\u77e5\u304c\u6765\u308c\u3070\u3059\u3050\u306b\u5bfe\u5fdc\u3067\u304d\u305d\u3046\u3060\u3057\u3001\u304b\u3063\u3053\u3044\u3044\n+ \u4eca\u306edocker\u30b5\u30fc\u30d0\u30fc\u306e\u72b6\u614b\u304c\u30ab\u30c3\u30b3\u3088\u304f\u30b0\u30e9\u30d5\u3067\u51fa\u308b\u3068\u3001\u304b\u3063\u3053\u3044\u3044\n\n\n\n\n## \u30b3\u30f3\u30c6\u30ca\u306e\u6b7b\u6d3b\u7ba1\u7406\n\n### \u6b7b\u6d3b\u7ba1\u7406\u3057\u3066\u304f\u308c\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\n+ DATADOG(\u304a\u3059\u3059\u3081)\n+ Prometheus\n\n### [DATADOG](http://qiita.com/okamu_/items/f6875d5bce2ac6752758#datadog-agent--dogstatsd)\n![community-datadog.png](https://qiita-image-store.s3.amazonaws.com/0/62822/4f00f74a-d26d-7457-ae24-87e833cf2688.png)\n\n\n+ Datadog\u3068\u306fIT\u30b7\u30b9\u30c6\u30e0\u306e\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002\u5c11\u3057\u4f5c\u696d\u3092\u884c\u3046\u3060\u3051\u3067\u3054\u81ea\u8eab\u306eIT\u30b7\u30b9\u30c6\u30e0\u3092\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n+ \u3053\u308c\u3092\u898b\u3066\u60da\u308c\u307e\u3057\u305f\u3000[Datadog\u306e\u672c\u5f53\u306e\u9b45\u529b\u3068\u306f](http://qiita.com/jhotta/items/e7e20a1acd797bf2665b)\n\n#### \u65e9\u901f\u3001\u5c0e\u5165\u3057\u3066\u307f\u308b\n+ \u7121\u6599\u7248\u3068\u6709\u6599\u7248\u304c\u3042\u308b\u304c\u3001\u4eca\u56de\u306f\u7121\u6599\u7248\u3092\u4f7f\u3046\n+ \u516c\u5f0f[DATADOG](https://www.datadoghq.com/)\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\n+ add host\u306e\u753b\u9762\u3067\u300cDocker\u300d\u3068\u3042\u308b\u304cAPIKey\u306e\u307f\u3092\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304f\n\n![Screen Shot 2016-06-25 at 10.33.11.png](https://qiita-image-store.s3.amazonaws.com/0/62822/6291f50f-11ef-245a-e5f5-7da6ceac2b0d.png)\n\n\n##### \u25cbRancher\u306e\u5834\u5408\n\n+ rancher\u306e\u7ba1\u7406\u753b\u9762\u304b\u3089\u300cCATALOG\u300d->\u300cDATADOG\u300d\u3092\u9078\u629e\n\n<img width=\"1680\" alt=\"Screen Shot 2016-06-25 at 10.25.02.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/79753e25-145d-c1c1-6864-fca41ea9682a.png\">\n\n+ APIKey\u306e\u5165\u529b\n+ \u300cLaunch\u300d\u3059\u308c\u3070\u7d42\u4e86\uff01\u3042\u3089\u3001\u304b\u3093\u305f\u3093\u3002\n\n##### \u25cb\u666e\u901a\u306eDocker\u306e\u5834\u5408(docker-compose)\n\n+ docker-compose.yml\n\n```\ndatadog-init:\n  labels:\n    io.rancher.scheduler.global: 'true'\n    io.rancher.container.pull_image: always\n    io.rancher.container.start_once: 'true'\n  command:\n  - /bin/true\n  image: janeczku/datadog-rancher-init:latest\n  volumes:\n  - /opt/rancher\n  net: none\ndatadog-agent:\n  environment:\n    API_KEY: xxxxxxxxxxxxxxxxxxxxxxxxxx\n    DOGSTATSD_ONLY: 'false'\n  labels:\n    io.rancher.scheduler.global: 'true'\n    io.rancher.sidekicks: datadog-init\n  command:\n  - supervisord\n  - -n\n  - -c\n  - /etc/dd-agent/supervisor.conf\n  entrypoint:\n  - /opt/rancher/entrypoint.sh\n  image: datadog/docker-dd-agent:11.0.570\n  volumes:\n  - /var/run/docker.sock:/var/run/docker.sock\n  - /proc/:/host/proc/:ro\n  - /sys/fs/cgroup/:/host/sys/fs/cgroup:ro\n  volumes_from:\n  - datadog-init\n\n```\n\n\n```$ docker-compose up```\n\n\n#### \u65e9\u901f\u3001\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3068\n\n<img width=\"1672\" alt=\"Screen Shot 2016-06-25 at 10.38.22.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/88532e33-9596-f882-a263-b2127d297d7c.png\">\n\n+ \u3053\u306e\u30a4\u30d9\u30f3\u30c8\u306e\u753b\u9762\u3067\u306f\u3001\u30b3\u30f3\u30c6\u30ca\u304c\u4f5c\u3089\u308c\u305f\u3088\u30fc\u3068\u304b\u306e\u30a4\u30d9\u30f3\u30c8\u304c\u6642\u7cfb\u5217\u3067\u8868\u793a\u3055\u308c\u308b\u3063\u307d\u3044\n\n#### docker\u3068slack\u306eintegration\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n![Screen Shot 2016-06-25 at 10.41.09.png](https://qiita-image-store.s3.amazonaws.com/0/62822/887d06f2-cb4c-c131-b133-46c10ab711d7.png)\n\n#### dashboard\u306bdocker\u304c\u8ffd\u52a0\u3055\u308c\u305f\u306e\u3067\u78ba\u8a8d\u3057\u3066\u307f\u308b\n![Screen Shot 2016-06-25 at 10.43.47.png](https://qiita-image-store.s3.amazonaws.com/0/62822/46114838-a99b-d532-6b03-6642281e51d2.png)\n\n#### docker\u306e\u30b0\u30e9\u30d5\u3092\u8997\u3044\u3066\u307f\u308b\n\n\n![Screen Shot 2016-06-25 at 10.44.51.png](https://qiita-image-store.s3.amazonaws.com/0/62822/a1402caa-68af-cb8b-d172-5b6535d07289.png)\n\n+ \u3059\u3093\u3052\u3047\u304d\u308c\u3044\uff01\uff01\uff01\uff01\n\n#### **\u300c\u672c\u984c\u300d\u30b3\u30f3\u30c6\u30ca\u304c\u6b7b\u3093\u3060\u3089slack\u306b\u901a\u77e5\u3092\u9001\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b**\n\n##### slack\u5074\u3067\u306e\u8a2d\u5b9a\n+ \u5de6\u4e0a\u306e\u8a2d\u5b9a\u3067\u304d\u305d\u3046\u306a\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u300cApps&integrations\u300d\u3092\u9078\u629e\n+ \u300cDATADOG\u300d\u3092\u691c\u7d22\u3057\u3066\u300cAdd Configrations\u300d\n+ \u300cWebhook URL\u300d\u3092\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304f\n\n##### datadog\u5074\u3067\u306e\u8a2d\u5b9a\n+ \u5148\u307b\u3069\u306eURL\u3068\u901a\u77e5\u3057\u305f\u3044\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u5165\u529b\n\n<img width=\"993\" alt=\"Screen Shot 2016-06-25 at 10.49.33.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/cdb9f2a4-45a2-1f70-a9d2-689333910e20.png\">\n\n+ \u3068\u308a\u3042\u3048\u305aOK\n\n##### \u30a2\u30e9\u30fc\u30c8\u306e\u57fa\u6e96\u5024\u306e\u8a2d\u5b9a\n\n+ \u300cMonitors\u300d->\u300cnew Monitor\u300d->\u300cMetric\u300d\u3092\u9078\u629e\n\n![Screen Shot 2016-06-25 at 10.55.56.png](https://qiita-image-store.s3.amazonaws.com/0/62822/6b448e35-a42e-9920-cbc9-0ffc19bf951c.png)\n\n+ run\u30b3\u30f3\u30c6\u30ca\u30fc\u304c\uff11\u3088\u308a\u4e0b\u304c\u308b\u3068slack\u306b\u901a\u77e5\u304c\u306a\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u307f\u305f\n<img width=\"1680\" alt=\"Screen Shot 2016-06-25 at 10.58.58.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/977c9b41-80f0-125d-a7bf-4a5472c13bba.png\">\n\n+ \u901a\u77e5\u304c\u304f\u308b\u3068\u3053\u3093\u306a\u611f\u3058\n\n<img width=\"1038\" alt=\"Screen Shot 2016-06-25 at 11.00.44.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/abbafeca-a12f-4c37-79a9-962012b73306.png\">\n\n\n+ \u3053\u308c\u3067\u3072\u3068\u307e\u305a\u3001 **\u300c\u6b7b\u3093\u3067\u308b\u3084\u3093\uff01\uff01\u300d** \u304c\u65e9\u3081\u306b\u308f\u304b\u308b\u3088\u3046\u306b\u306a\u3063\u305f\n\n### [Prometheus](http://qiita.com/okamu_/items/f6875d5bce2ac6752758#prometheus)\n\n![community-Prometheus.svg.png](https://qiita-image-store.s3.amazonaws.com/0/62822/35037bfe-1b28-e1a8-78fa-d47f30b1e3b3.png)\n\n+ Prometheus \u3068\u306f\u3000\u4e00\u822c\u7684\u306a\u76e3\u8996\u30c4\u30fc\u30eb\u306e\u3088\u3046\u306b\u3001\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\u3001\u6570\u5024\u306e\u8868\u793a\u3001\u30b0\u30e9\u30d5\u306e\u8868\u793a\u3001\u30a2\u30e9\u30fc\u30c8\u3092\u51fa\u3059\u6a5f\u80fd\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u308c\u3060\u3051\u3067\u306a\u304f\u3001Prometheus \u306f\u72ec\u81ea\u306e\u30c7\u30fc\u30bf\u30e2\u30c7\u30eb\u3092\u6301\u3061\u3001\u30af\u30a8\u30ea\u8a00\u8a9e\u3092\u4f7f\u3063\u3066\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u8a55\u4fa1\u3084\u30b0\u30e9\u30d5\u5316\u3092\u884c\u3048\u307e\u3059\u3002\n\n\n#### \u65e9\u901f\u3001\u5c0e\u5165\u3057\u3066\u307f\u308b\n\n##### \u25cbRancher\u306e\u5834\u5408\n\n+ rancher\u306e\u7ba1\u7406\u753b\u9762\u304b\u3089\u300cCATALOG\u300d->\u300cPrometheus\u300d\u3092\u9078\u629e\n\n<img width=\"1680\" alt=\"Screen Shot 2016-06-25 at 09.55.22.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/9eec4244-5c5e-2051-0eee-05ca6b060ef0.png\">\n\n\n+ \u300cLaunch\u300d\u3059\u308c\u3070\u7d42\u4e86\uff01\u3042\u3089\u3001\u304b\u3093\u305f\u3093\u3002\n\n##### \u25cb\u666e\u901a\u306eDocker\u306e\u5834\u5408(docker-compose)\n\n+ docker-compose.yml\n\n\n\n```\ngraf-db:\n  command:\n  - cat\n  tty: true\n  image: infinityworks/graf-db:08\n  links:\n  - prometheus:prometheus\n  volumes:\n  - /var/lib/grafana/\nprometheus-rancher-exporter:\n  labels:\n    io.rancher.container.create_agent: 'true'\n    io.rancher.container.agent.role: environment\n  tty: true\n  image: infinityworks/prometheus-rancher-exporter:04\nprometheus:\n  ports:\n  - 9090:9090/tcp\n  labels:\n    io.rancher.sidekicks: prom-conf\n  command:\n  - -alertmanager.url=http://alertmanager:9093\n  - -config.file=/etc/prom-conf/prometheus.yml\n  - -storage.local.path=/prometheus\n  - -web.console.libraries=/etc/prometheus/console_libraries\n  - -web.console.templates=/etc/prometheus/consoles\n  tty: true\n  image: prom/prometheus:0.18.0\n  links:\n  - ranch-eye:ranch-eye\n  - node-exporter:node-exporter\n  volumes_from:\n  - prom-conf\ngrafana:\n  ports:\n  - 3000:3000/tcp\n  labels:\n    io.rancher.sidekicks: graf-db\n  tty: true\n  image: grafana/grafana:3.0.1\n  links:\n  - prometheus:prometheus\n  volumes_from:\n  - graf-db\nprom-conf:\n  tty: true\n  image: infinityworks/prom-conf:11\n  links:\n  - ranch-eye:ranch-eye\n  - node-exporter:node-exporter\n  volumes:\n  - /etc/prom-conf/\ninfluxdb:\n  ports:\n  - 2003:2003/tcp\n  - 8083:8083/tcp\n  - 8086:8086/tcp\n  - 8090:8090/tcp\n  environment:\n    GRAPHITE_BINDING: :2003\n    GRAPHITE_DB: rancher\n    PRE_CREATE_DB: grafana;prometheus;rancher\n  image: tutum/influxdb:0.10\nranch-eye:\n  ports:\n  - 9104:9104/tcp\n  labels:\n    io.rancher.scheduler.global: 'true'\n    io.rancher.container.dns: 'true'\n  tty: true\n  image: infinityworks/ranch-eye:03\n  stdin_open: true\n  net: host\nnode-exporter:\n  labels:\n    io.rancher.scheduler.global: 'true'\n  tty: true\n  image: prom/node-exporter:latest\n  stdin_open: true\n\n```\n\n```$ docker-compose up```\n\n\n#### \u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b(3000\u756a\u30dd\u30fc\u30c8\u306e\u307b\u3046)\n+ \u5916\u90e8\u306b\u306f\u516c\u958b\u3057\u305f\u304f\u306a\u3044\u306e\u3067.ssh/config\u306blocalFoward\u3057\u30663000\u756a\u3092\u8ee2\u9001\u3059\u308b\n\n+ container status\u306f\u3053\u3093\u306a\u611f\u3058\n\n<img width=\"1680\" alt=\"Screen Shot 2016-06-25 at 10.03.46.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/447ade38-3f44-6712-8c43-6459167fd600.png\">\n\n\n+ Host Status\u306f\u306a\u3093\u304b\u304b\u3063\u3053\u3044\u3044\uff01\n\n<img width=\"1680\" alt=\"Screen Shot 2016-06-25 at 10.07.16.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/62102a35-1eff-e832-08dc-c55a70d152b5.png\">\n\n\n#### \u7279\u5b9a\u306e\u30b3\u30f3\u30c6\u30ca\u304c\u6b7b\u3093\u3060\u6642\u306b\u901a\u77e5\u3092\u9001\u308b\n+ \u306a\u3093\u3068\u306a\u304f\u3050\u3050\u3063\u305f\u3060\u3051\u3060\u3051\u3069\u3001\u901a\u77e5\u306f\u3069\u3046\u306b\u304b\u3059\u308c\u3070\u3067\u304d\u308b\u3063\u307d\u3044\u3051\u3069\u3001\u9762\u5012\u304f\u3055\u305d\u3046\n+ [Docker \u3067 Sensu + Graphite + Grafana \u74b0\u5883\u69cb\u7bc9](http://d.hatena.ne.jp/tomyhero/20150902/1441178794)\n+ [http://docs.grafana.org/tutorials/hubot_howto/](http://docs.grafana.org/tutorials/hubot_howto/)\n+ \u4eca\u56de\u306f\u898b\u9001\u308a\u307e\u3059\n\n## \u30b3\u30f3\u30c6\u30ca\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\n![community-rancher-bench-security.png](https://qiita-image-store.s3.amazonaws.com/0/62822/d4d52ac8-50ee-5ca2-fa08-0a5fdef523f2.png)\n\n\n### \u30b3\u30f3\u30c6\u30ca\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u3092\u8b66\u544a\u3057\u3066\u304f\u308c\u308b\n+ rancher-bench-security\n+ docker-bench-security\n\n### \u5c0e\u5165\u3057\u3066\u307f\u308b\n\n\n#### \u25cbrancher\u306e\u4eba\n+ rancher-bench-security\n+ \u300cCATALOG\u300d->\u300crancher-bench-security\u300d\n\n<img width=\"1678\" alt=\"Screen Shot 2016-06-25 at 11.11.02.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62822/893365f4-1e4d-c3b8-1db7-6c601fe36bec.png\">\n\n+ \u300cLaunch\u300d\u3067\u304a\u308f\u308a\n\n#### \u25cbdocker\u306e\u4eba\n+ docker-bench-security\n\n```\ndocker run -it --net host --pid host --cap-add audit_control \\\n    -v /var/lib:/var/lib \\\n    -v /var/run/docker.sock:/var/run/docker.sock \\\n    -v /usr/lib/systemd:/usr/lib/systemd \\\n    -v /etc:/etc --label docker_bench_security \\\n    docker/docker-bench-security\n```\n\n### \u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\n+ \u3053\u308c\u3082\u5916\u90e8\u306b\u306f\u516c\u958b\u3057\u305f\u304f\u306a\u3044\u306e\u3067\u3001bench_security\u30b3\u30f3\u30c6\u30ca\u306e80\u30dd\u30fc\u30c8\u3092\u9069\u5f53\u306b8888\u30dd\u30fc\u30c8\u306b\u3057\u3066\u30ed\u30fc\u30ab\u30eb\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u3066web\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\n\n![benchmark_log.png](https://qiita-image-store.s3.amazonaws.com/0/62822/28a94a85-20f2-1703-f8ab-a516fc55f99e.png)\n\n+ \u3053\u3093\u306a\u611f\u3058\u3067\u51fa\u308b(github\u306e\u30b5\u30f3\u30d7\u30eb)\n+ \u3053\u306ewarm\u3092\u4fee\u6b63\u3057\u3068\u304b\u3093\u3068\u3044\u304b\u3093\u307f\u305f\u3044\u3084\u306d\n\n\n## \u307e\u3068\u3081\n+ \u3053\u3093\u306a\u308f\u3051\u3067\u3001\u306a\u3093\u3068\u306a\u304f\u6b7b\u6d3b\u7ba1\u7406\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u306b\u3064\u3044\u3066\u306f\u5927\u4e08\u592b\u304b\u306a\u3041\u3068\n+ \u524d\u3005\u304b\u3089\u6c17\u306b\u306a\u3063\u3066\u305f\u201dVuls\u201d\u306f\u3001RancherOS\u304c\u5bfe\u5fdc\u3057\u3066\u306a\u3044\u3089\u3057\u304f\u3066\u8ae6\u3081\u307e\u3057\u305f\u304c\u3001\u5bfe\u5fdc\u3057\u305f\u3089\u4f7f\u3044\u305f\u3044\n\n+ \u305d\u306e\u4ed6\u306b\u3082[Rancher\u3067\u4f7f\u3048\u308b\u30e9\u30a4\u30d6\u30e9\u30ea](http://qiita.com/okamu_/items/f6875d5bce2ac6752758)\u306f\u305f\u304f\u3055\u3093\u3042\u308b\u3057\u3001\u4eca\u3082\u5897\u3048\u3066\u3044\u308b\u306e\u3067\u305f\u304f\u3055\u3093\u4f7f\u3063\u3066\u3044\u304d\u305f\u3044\n", "tags": ["docker", "\u6b7b\u6d3b\u76e3\u8996", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3", "rancher"]}