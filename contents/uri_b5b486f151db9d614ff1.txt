{"context": " More than 1 year has passed since last update.R\u3067Gooogle\u306e\u30a2\u30af\u30bb\u30eb\u89e3\u6790\u30b5\u30fc\u30d3\u30b9Gooogle Analytics\u306e\u30c7\u30fc\u30bf\u3092\u89e3\u6790\u3059\u308b\u305f\u3081\u306e\u624b\u6cd5\u3084\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u306f\u3001 {RGoogleAnalytics}\u30d1\u30c3\u30b1\u30fc\u30b8\u306a\u3069\u3092\u306f\u3058\u3081\u3068\u3057\u3066\u3044\u304f\u3064\u304b\u3042\u3063\u3066\u3001\u7279\u306b{RGoogleAnalytics}\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u306b\u8a73\u3057\u3044\u3067\u3059\u304c\u3001{RGoogleAnalytics}\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u306a\u3093\u3068\u306a\u304f\u8907\u96d1\u306a\u611f\u3058\u3067\u3059\u3002\n\u305d\u3093\u306a\u4e2d\u3067\u6700\u8fd1\u3001{RGA}\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u3044\u3046Google Analytics API\u306e\u30e9\u30c3\u30d1\u30fc\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u65b0\u305f\u306bCRAN\u306b\u767b\u9332\u3055\u308c\u305f\u306e\u3067\u304a\u8a66\u3057\u304c\u3066\u3089\u7d39\u4ecb\u3057\u307e\u3059\u3002\u6163\u308c\u306e\u554f\u984c\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u65e2\u5b58\u306e{RGoogleAnalytics}\u3088\u308a\u3082\u4f7f\u3044\u3084\u3059\u3044\u5370\u8c61\u3067\u3059\u3002\n\u307e\u305f\u3001{RGA}\u306e\u7279\u5fb4\u3068\u3057\u3066\u3001\u901a\u5e38\u306e\u30ec\u30dd\u30fc\u30c8 API\u306b\u52a0\u3048\u3066\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30ec\u30dd\u30fc\u30c8 API\u3084\u8a66\u3057\u3066\u3044\u307e\u305b\u3093\u304cAnalytics Multi-Channel Funnels data API\u3082\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305a\u306f\u4eca\u56de\u5229\u7528\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u8aad\u307f\u8fbc\u3093\u3067\u304a\u304d\u307e\u3057\u3087\u3046\u3002\nlibrary(RGA)\nlibrary(ggthemes)\nlibrary(ggplot2)\nlibrary(munsell)\nlibrary(dplyr)\n\n\n\ud83d\udd30 \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\nGitHub\u306eREADME\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u304c\u3001\u307e\u305a\u306f\u8a8d\u8a3c\u3092\u3068\u308b\u3068\u3053\u308d\u304b\u3089\u59cb\u3081\u307e\u3059\u3002\u3053\u3053\u306fREADME\u306b\u8a73\u3057\u304f\u66f8\u3044\u3066\u3042\u308b\u901a\u308a\u306b\u9032\u3081\u308c\u3070\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n# \u30d6\u30e9\u30a6\u30b6\u304c\u7acb\u3061\u4e0a\u304c\u308a\u8a8d\u8a3c\u3092\u6c42\u3081\u3089\u308c\u308b\nauthorize()\n\n\u6b21\u306e\u30b3\u30fc\u30c9\u3067\u89e3\u6790\u306e\u5bfe\u8c61\u306b\u3059\u308bid\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\ndf_prof_list <- list_profiles() %>% \n  dplyr::filter(website.url == \"http://qiita.com\")\n# \u3053\u306e\u5024\u304cget_ga()\u95a2\u6570\u306a\u3069\u306b\u6e21\u3059profile.id\u3068\u306a\u308b\ndf_prof_list$id\n\n{RGA}\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u306fAPI\u306e\u7a2e\u985e\u306b\u5fdc\u3058\u3066\u95a2\u6570\u3092\u7528\u610f\u3057\u3066\u3044\u307e\u3059\u3002\n\n get_ga()... \u4e3b\u8981\u30ec\u30dd\u30fc\u30c8 API\n get_realtime()... \u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30ec\u30dd\u30fc\u30c8 API\n get_mcf()... Analytics Multi-Channel Funnels data API\n\nget_ga()\u95a2\u6570\u306fCore Reporting API\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u3067\u3001Google Analytics\u306e\u4e3b\u8981\u306a\u6a5f\u80fd\u3092\u30ab\u30d0\u30fc\u3057\u3066\u3044\u307e\u3059\u3002\u95a2\u6570\u5185\u306e\u5f15\u6570\u3092\u6307\u5b9a\u3057\u3066\u8a73\u7d30\u306a\u30c7\u30fc\u30bf\u3092\u5f97\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u4e3b\u8981\u306a\u95a2\u6570\u3068\u3057\u3066\u6b21\u306e\u3082\u306e\u304c\u3042\u308a\u307e\u3059\u3002\n\n  profile.id... \u30a2\u30af\u30bb\u30b9\u89e3\u6790\u306e\u5bfe\u8c61\u306b\u3059\u308bID\n  start.date, end.date... \u5bfe\u8c61\u306b\u3059\u308b\u65e5\u4ed8\u3002\u958b\u59cb\u6642\u70b9\u3068\u7d42\u4e86\u6642\u70b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002YYYY-MM-DD\u5f62\u5f0f\u3067\u65e5\u4ed8\u3092\u4e0e\u3048\u307e\u3059\u304ctoday\u308430daysAgo\u3068\u3044\u3063\u305f\u76f8\u5bfe\u7684\u306a\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3002\n  metrics, dimensions... \u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u8a73\u7d30\u306fAPI\u306e\u30ac\u30a4\u30c9\u30da\u30fc\u30b8\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u306e\u958b\u59cb\u6642\u70b9\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u89e3\u6790\u3092\u3057\u305f\u3044\u304c\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u958b\u59cb\u65e5\u3092\u5fd8\u308c\u305f...\u3068\u3044\u3046\u3068\u304d\u306b\u306ffirstdate()\u3067\u8abf\u3079\u3089\u308c\u307e\u3059\u3002\nfirstdate(profile.id = df_prof_list$id)\n\n[1] \"2014-06-08 JST\"\n\u3053\u306e\u307b\u304b\u306b\u3082\u30c7\u30fc\u30bf\u306e\u4e26\u3073\u66ff\u3048\u57fa\u6e96\u3092\u5b9a\u3081\u308bsort\u3084\u5bfe\u8c61\u306e\u7bc4\u56f2\u3092\u62bd\u51fa\u3059\u308bfilters\u306a\u3069\u306e\u5f15\u6570\u304c\u3042\u308a\u307e\u3059\u3002\n\n\ud83d\udcc8 \u30e6\u30fc\u30b6\u30fc\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\n\u307e\u305a\u306fget_ga()\u95a2\u6570\u3092\u4f7f\u3063\u3066Google Analytics\u306e\u57fa\u672c\u7684\u306a\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002Qiita\u3067\u3082\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u7d10\u4ed8\u3051\u305fGoogle Analytics\u304c\u5229\u7528\u3067\u304d\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u3067\u306f\u79c1\u306e\u6295\u7a3f\u3057\u305f\u8a18\u4e8b\u306e\u30c7\u30fc\u30bf\u3092\u4f8b\u306b\u3057\u307e\u3059\u3002\n\n\ud83d\udc40 \u30da\u30fc\u30b8\u30d3\u30e5\u30fc\u6570\n\u79c1\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30da\u30fc\u30b8 (http://qiita.com/uri) \u4ee5\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u304a\u3051\u308b\u53bb\u5e74\u4e00\u5e74\u9593\u306e\u30da\u30fc\u30b8\u30d3\u30e5\u30fc\u6570\u4e0a\u4f4d10\u30da\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u305f\u7d50\u679c\u3067\u3059\u3002\nget_ga(profile.id = df_prof_list$id,\n       start.date = \"2015-01-01\", \n       end.date   = \"2015-12-31\",\n       metrics    = \"ga:pageviews\",\n       dimensions = \"ga:pageTitle, ga:pagePath\",\n       sort       = \"-ga:pageviews\") %>% \n  dplyr::filter(grepl(\"^/uri\", page.path)) %>% \n  head(10) %>% \n  dplyr::mutate(page.path  = paste0(\"http://qiita.com\", page.path),\n                page.title = gsub(\" - Qiita\", \"\", page.title)) %>%\n  knitr::kable(format = \"markdown\")\n\n\n\n\npage.title\npage.path\npageviews\n\n\n\n\n\u30c7\u30fc\u30bf\u89e3\u6790\u305d\u306e\u524d\u306b: \u5206\u5e03\u578b\u306e\u78ba\u8a8d\u3068\u6b63\u898f\u6027\u306e\u691c\u5b9a #rstatsj\nhttp://qiita.com/uri/items/e656f90e9dda342c54bb\n8708\n\n\n\u3053\u306eR\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3059\u3054\u30442014\nhttp://qiita.com/uri/items/ce711ee6da76a1e11ca5\n2308\n\n\nR\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u305f\u3081\u306e\u7b2c\u4e00\u6b69\uff08\u672a\u5b8c\uff09\nhttp://qiita.com/uri/items/1245441ab179c6ee76f9\n1848\n\n\n\u4e00\u6b69\u9032\u3093\u3060R\u3068\u306e\u4ed8\u304d\u5408\u3044\u65b9\nhttp://qiita.com/uri/items/83804c9eb4a3cb9c6811\n1762\n\n\nGitHub - \u3053\u308c\u304b\u3089\u7814\u7a76\u3092\u59cb\u3081\u308b\u5927\u5b66\u5b66\u90e8\u751f\u3084\u9662\u751f\u306fDr.Elg\u3092\u5229\u7528\u3057\u3088\u3046\nhttp://qiita.com/uri/items/8eb4324f4c09f15e4b5b\n1644\n\n\nRStudio\u3092\u4f7f\u3063\u305fPDF\u6587\u66f8\u306e\u4f5c\u6210\uff08for RStudio 0.98.932+\uff09\nhttp://qiita.com/uri/items/d9e50e8e5a37217a3f5d\n1623\n\n\nR - \u9023\u756a\u306b\u306a\u3063\u3066\u3044\u308b\u8907\u6570\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\nhttp://qiita.com/uri/items/e162302ce8a38b009660\n1447\n\n\n2014\u5e74\u7248RStudio\u3092\u4f7f\u3063\u305f\u6587\u66f8\u4f5c\u6210\u6cd5\nhttp://qiita.com/uri/items/5cce4431ad0d96b96689\n1410\n\n\nR - \u5b66\u4f1a\u767a\u8868\u306e\u305f\u3081\u306eggplot2\u306e\u8a2d\u5b9a\u3081\u3082\nhttp://qiita.com/uri/items/615653e83642d7e475de\n1323\n\n\nRStudio 0.99\u306e\u5909\u66f4\u70b9\u3068\u6700\u8fd1\u306eR\u30b3\u30fc\u30c9\u306e\u66f8\u304d\u65b9\nhttp://qiita.com/uri/items/a60f28d437c773010daf\n1152\n\n\n\n\n\ud83d\udeb6 \u30bb\u30c3\u30b7\u30e7\u30f3\u6570\n\u6708\u3054\u3068\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u6570\u3092\u6c42\u3081\u307e\u3059\u3002{ggplot2}\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u53d6\u5f97\u3057\u305f\u30c7\u30fc\u30bf\u3092\u56f3\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nget_ga(profile.id = df_prof_list$id, \n       start.date = \"2015-01-01\", \n       end.date   = \"2015-12-31\",\n       metrics    = \"ga:sessions\",\n       dimensions = \"ga:month\") %>% \n  dplyr::mutate(month = lubridate::month(month, label = TRUE, abbr = TRUE)) %>% \n    # \u3053\u3053\u307e\u3067\u3067\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u3002\u4ee5\u4e0b\u53ef\u8996\u5316\u306e\u305f\u3081\u306e\u30b3\u30fc\u30c9\n  ggplot(aes(month, sessions, group = 1)) +\n  geom_line() +\n  geom_point(size = 2, colour = \"magenta\")\n\n\n12\u6708\u306f\u30a2\u30c9\u30d9\u30f3\u30c8\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u5f71\u97ff\u3082\u3042\u3063\u3066\u304b\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u6570\u304c\u4f38\u3073\u307e\u3057\u305f\u2197\ufe0f\u3002\u9806\u8abf\u9806\u8abf \ud83d\ude04\n\n\ud83c\udf0d \u5730\u57df\u5225\u306e\u30a2\u30af\u30bb\u30b9\n\u3053\u308c\u3092\u898b\u308b\u306e\u304c\u597d\u304d\u3067\u3059\u3002\u3069\u306e\u5730\u57df\u3001\u56fd\u306e\u4eba\u304c\u898b\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u304b\u304c\u308f\u304b\u308a\u307e\u3059\u3002\nlibrary(rworldmap)\ndf_session_country <- get_ga(profile.id = df_prof_list$id,\n       start.date = \"2015-01-01\", \n       end.date   = \"2015-12-31\",\n       metrics    = \"ga:sessions\",\n       dimensions = \"ga:country\")\ndf_session_country %>% dplyr::group_size()\n\n[1] 104\n\u591a\u3044\u306e\u304b\u5c11\u306a\u3044\u306e\u304b\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001\u3044\u308d\u3044\u308d\u306a\u56fd\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u304c\u3042\u308b\u307f\u305f\u3044\u3067\u3059\u3002\ndf_session_country %>% dplyr::arrange(-sessions) %>% \n  head(10) %>% \n  knitr::kable(format = \"markdown\")\n\n\u4e0a\u4f4d10\u306e\u56fd\u306e\u8868\u3067\u3059\u3002\u5f53\u7136\u306a\u304c\u3089\u65e5\u672c\u306e\u65b9\u304c\u591a\u304f\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n\n\ncountry\nsessions\n\n\n\n\nJapan\n29347\n\n\nUnited States\n1614\n\n\n(not set)\n904\n\n\nChina\n261\n\n\nGermany\n156\n\n\nUnited Kingdom\n151\n\n\nRussia\n127\n\n\nSouth Korea\n102\n\n\nNetherlands\n97\n\n\nFrance\n81\n\n\n\n# \u5730\u57df\u5225\u306e\u30a2\u30af\u30bb\u30b9\u3092\u53ef\u8996\u5316\u3059\u308b\u305f\u3081\u306eR\u30b3\u30fc\u30c9\ndf_session_country %<>% dplyr::mutate(sessions_c = cut(df_session_country$sessions, \n                                                       breaks = c(0, 10, 50, 100, 250, 500, 1000, 10000, 30000),\n                                                       labels = c(\"0 - 10\", \"10 - 50\", \"50 - 100\", \"100 - 250\",\n                                                                  \"250 - 500\", \"500 - 1000\", \"1000 - 10000\",\n                                                                  \"10000 - 30000\")))\nsessions_pal <- munsell::hue_slice(\"10RP\") %$% data %>% dplyr::filter(grepl(\"6/\", name)) %>% dplyr::arrange(chroma) %$% hex\nmap_world <- map_data(\"world\") %>% \n  .[.$region != \"Antarctica\",] \n\ngg <- ggplot()\ngg <- gg + geom_map(data = map_world, \n                    map = map_world,\n                    aes(x = long, y = lat, map_id = region),\n                    color = \"white\", \n                    fill = \"#7f7f7f\", \n                    size = 0.05, \n                    alpha = 0.2)\ngg <- gg + geom_map(data = df_session_country,\n              map  = map_world,\n              aes(map_id = country, fill = sessions_c))\ngg <- gg + scale_fill_manual(values = sessions_pal)\ngg <- gg + guides(fill = guide_legend(override.aes = list(colour = NA)))\ngg <- gg + coord_equal() + theme_map()\ngg <- gg + theme(legend.position = \"bottom\")\nprint(gg)\n\n\n\n\u23f0 \u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\n\u73fe\u5728\u9650\u5b9a\u7684\u306b\u8a66\u9a13\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u3082\u5bfe\u8c61\u306b\u3067\u304d\u307e\u3059\u3002\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u306b\u306fReal Time Reporting API\u3092\u5229\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u4eca\u5ea6\u306fget_realtime()\u95a2\u6570\u3092\u4f7f\u3044\u307e\u3059\u3002\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u306fget_ga()\u3068\u540c\u3058\u3067\u3001\u53d6\u5f97\u3057\u305f\u3044metrics\u3068dimensions\u3092\u6e21\u3057\u307e\u3059\u3002\nget_realtime(profile.id = df_prof_list$id,\n             metrics    = \"rt:activeUsers\",\n             dimensions = \"rt:region, rt:browser, rt:operatingSystem\")\n\nregion browser operating.system active.users\n1 Aichi Prefecture  Safari              iOS            1\n2         Hokkaido  Chrome          Windows            1\n3         New York Firefox            Linux            1\n\u65b0\u5e74\u65e9\u3005\u3001\u8ab0\u3067\u3057\u3087\u3046\u304b... \uff08\u3082\u3057\u304b\u3057\u3066\u7fbd\u9ce5\uff1f\uff09\n\u305d\u306e\u4ed6\u3001API\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u898b\u308b\u9650\u308a\u6761\u4ef6\u62bd\u51fa\u306a\u3069\u306e\u7d30\u304b\u3044\u6307\u5b9a\u3082\u3067\u304d\u305d\u3046\u306a\u306e\u3067\u826f\u3044\u3067\u3059\u3002\u516c\u5f0f\u306evignettes\u306b\u3082\u7d30\u304b\u3044\u5229\u7528\u65b9\u6cd5\u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u4e00\u5ea6\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\ud83d\udcda \u53c2\u8003\n\nR \u304b\u3089 API \u3067 Google \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u306e\u30c7\u30fc\u30bf\u3092\u8aad\u3080\u3053\u3081\u308b\u30d1\u30c3\u30b1\u30fc\u30b8, RGoogleAnalytics \u306e\u30af\u30a8\u30ea\u4f5c\u6210\u65b9\u6cd5 - \u5effTT\nGoogle Analytics Data Mining with R\n\u5404\u30d7\u30ed\u30b0\u30e9\u30e0\u8a00\u8a9e\u6bce\u306eGoogle Analytics API(R,python,Excel) - \"Diary\" \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u3055\u3093\u3078\u306e\u6069\u8fd4\u3057\nWorld Map Panel Plots with ggplot2 2.0 & ggalt | rud.is\nFaceted \u201cWorld Population by Income\u201d Choropleths in ggplot | rud.is\nR\u3067\u89e3\u6790\uff1a\u30de\u30f3\u30bb\u30eb\u30fb\u30ab\u30e9\u30fc\u30fb\u30b7\u30b9\u30c6\u30e0\u306b\u89e6\u308c\u3066\u307f\u307e\u305b\u3093\u304b\uff1f\u300cmunsell\u300d\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u7d39\u4ecb\n\n\nR\u3067Gooogle\u306e\u30a2\u30af\u30bb\u30eb\u89e3\u6790\u30b5\u30fc\u30d3\u30b9Gooogle Analytics\u306e\u30c7\u30fc\u30bf\u3092\u89e3\u6790\u3059\u308b\u305f\u3081\u306e\u624b\u6cd5\u3084\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u306f\u3001 [**`{RGoogleAnalytics}`**](https://github.com/Tatvic/RGoogleAnalytics)\u30d1\u30c3\u30b1\u30fc\u30b8\u306a\u3069\u3092\u306f\u3058\u3081\u3068\u3057\u3066\u3044\u304f\u3064\u304b\u3042\u3063\u3066\u3001\u7279\u306b**`{RGoogleAnalytics}`**\u306b\u3064\u3044\u3066\u306f[\u3053\u3061\u3089\u306e\u8a18\u4e8b](http://abrahamcow.hatenablog.com/entry/2015/01/02/215112)\u306b\u8a73\u3057\u3044\u3067\u3059\u304c\u3001**`{RGoogleAnalytics}`**\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u306a\u3093\u3068\u306a\u304f\u8907\u96d1\u306a\u611f\u3058\u3067\u3059\u3002\n\n\u305d\u3093\u306a\u4e2d\u3067\u6700\u8fd1\u3001**[`{RGA}`](https://github.com/artemklevtsov/RGA)\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u3044\u3046Google Analytics API\u306e\u30e9\u30c3\u30d1\u30fc\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u65b0\u305f\u306bCRAN\u306b\u767b\u9332\u3055\u308c\u305f**\u306e\u3067\u304a\u8a66\u3057\u304c\u3066\u3089\u7d39\u4ecb\u3057\u307e\u3059\u3002\u6163\u308c\u306e\u554f\u984c\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u65e2\u5b58\u306e**`{RGoogleAnalytics}`**\u3088\u308a\u3082\u4f7f\u3044\u3084\u3059\u3044\u5370\u8c61\u3067\u3059\u3002\n\n\u307e\u305f\u3001**`{RGA}`\u306e\u7279\u5fb4\u3068\u3057\u3066\u3001\u901a\u5e38\u306e\u30ec\u30dd\u30fc\u30c8 API\u306b\u52a0\u3048\u3066\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30ec\u30dd\u30fc\u30c8 API\u3084\u8a66\u3057\u3066\u3044\u307e\u305b\u3093\u304cAnalytics Multi-Channel Funnels data API\u3082\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059**\u3002\n\n\u307e\u305a\u306f\u4eca\u56de\u5229\u7528\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u8aad\u307f\u8fbc\u3093\u3067\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n``` r\nlibrary(RGA)\nlibrary(ggthemes)\nlibrary(ggplot2)\nlibrary(munsell)\nlibrary(dplyr)\n```\n\n### \ud83d\udd30 \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\n\nGitHub\u306eREADME\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u304c\u3001\u307e\u305a\u306f\u8a8d\u8a3c\u3092\u3068\u308b\u3068\u3053\u308d\u304b\u3089\u59cb\u3081\u307e\u3059\u3002\u3053\u3053\u306fREADME\u306b\u8a73\u3057\u304f\u66f8\u3044\u3066\u3042\u308b\u901a\u308a\u306b\u9032\u3081\u308c\u3070\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\n``` r\n# \u30d6\u30e9\u30a6\u30b6\u304c\u7acb\u3061\u4e0a\u304c\u308a\u8a8d\u8a3c\u3092\u6c42\u3081\u3089\u308c\u308b\nauthorize()\n```\n\n\u6b21\u306e\u30b3\u30fc\u30c9\u3067\u89e3\u6790\u306e\u5bfe\u8c61\u306b\u3059\u308bid\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n``` r\ndf_prof_list <- list_profiles() %>% \n  dplyr::filter(website.url == \"http://qiita.com\")\n# \u3053\u306e\u5024\u304cget_ga()\u95a2\u6570\u306a\u3069\u306b\u6e21\u3059profile.id\u3068\u306a\u308b\ndf_prof_list$id\n```\n\n**`{RGA}`**\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u306fAPI\u306e\u7a2e\u985e\u306b\u5fdc\u3058\u3066\u95a2\u6570\u3092\u7528\u610f\u3057\u3066\u3044\u307e\u3059\u3002\n\n1.  `get_ga()`... \u4e3b\u8981\u30ec\u30dd\u30fc\u30c8 API\n2.  `get_realtime()`... \u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30ec\u30dd\u30fc\u30c8 API\n3.  `get_mcf()`... Analytics Multi-Channel Funnels data API\n\n`get_ga()`\u95a2\u6570\u306f[Core Reporting API](https://developers.google.com/analytics/devguides/reporting/core/v3/common-queries)\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u3067\u3001Google Analytics\u306e\u4e3b\u8981\u306a\u6a5f\u80fd\u3092\u30ab\u30d0\u30fc\u3057\u3066\u3044\u307e\u3059\u3002\u95a2\u6570\u5185\u306e\u5f15\u6570\u3092\u6307\u5b9a\u3057\u3066\u8a73\u7d30\u306a\u30c7\u30fc\u30bf\u3092\u5f97\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u4e3b\u8981\u306a\u95a2\u6570\u3068\u3057\u3066\u6b21\u306e\u3082\u306e\u304c\u3042\u308a\u307e\u3059\u3002\n\n-   profile.id... \u30a2\u30af\u30bb\u30b9\u89e3\u6790\u306e\u5bfe\u8c61\u306b\u3059\u308bID\n-   start.date, end.date... \u5bfe\u8c61\u306b\u3059\u308b\u65e5\u4ed8\u3002\u958b\u59cb\u6642\u70b9\u3068\u7d42\u4e86\u6642\u70b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002YYYY-MM-DD\u5f62\u5f0f\u3067\u65e5\u4ed8\u3092\u4e0e\u3048\u307e\u3059\u304c`today`\u3084`30daysAgo`\u3068\u3044\u3063\u305f\u76f8\u5bfe\u7684\u306a\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3002\n-   metrics, dimensions... \u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u8a73\u7d30\u306f[API\u306e\u30ac\u30a4\u30c9\u30da\u30fc\u30b8](https://developers.google.com/analytics/devguides/reporting/core/dimsmets)\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u306e\u958b\u59cb\u6642\u70b9\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u89e3\u6790\u3092\u3057\u305f\u3044\u304c\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u958b\u59cb\u65e5\u3092\u5fd8\u308c\u305f...\u3068\u3044\u3046\u3068\u304d\u306b\u306f`firstdate()`\u3067\u8abf\u3079\u3089\u308c\u307e\u3059\u3002\n\n``` r\nfirstdate(profile.id = df_prof_list$id)\n```\n\n[1] \"2014-06-08 JST\"\n\n\u3053\u306e\u307b\u304b\u306b\u3082\u30c7\u30fc\u30bf\u306e\u4e26\u3073\u66ff\u3048\u57fa\u6e96\u3092\u5b9a\u3081\u308b*sort*\u3084\u5bfe\u8c61\u306e\u7bc4\u56f2\u3092\u62bd\u51fa\u3059\u308b*filters*\u306a\u3069\u306e\u5f15\u6570\u304c\u3042\u308a\u307e\u3059\u3002\n\n### \ud83d\udcc8 \u30e6\u30fc\u30b6\u30fc\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\n\n\u307e\u305a\u306f`get_ga()`\u95a2\u6570\u3092\u4f7f\u3063\u3066Google Analytics\u306e\u57fa\u672c\u7684\u306a\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002Qiita\u3067\u3082\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u7d10\u4ed8\u3051\u305fGoogle Analytics\u304c[\u5229\u7528\u3067\u304d\u308b](http://qiita.com/Qiita/items/c7f704e3786df3aa7a11)\u306e\u3067\u3001\u4ee5\u4e0b\u3067\u306f**\u79c1\u306e\u6295\u7a3f\u3057\u305f\u8a18\u4e8b\u306e\u30c7\u30fc\u30bf\u3092\u4f8b\u306b\u3057\u307e\u3059**\u3002\n\n#### \ud83d\udc40 \u30da\u30fc\u30b8\u30d3\u30e5\u30fc\u6570\n\n\u79c1\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30da\u30fc\u30b8 (<http://qiita.com/uri>) \u4ee5\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u304a\u3051\u308b\u53bb\u5e74\u4e00\u5e74\u9593\u306e\u30da\u30fc\u30b8\u30d3\u30e5\u30fc\u6570\u4e0a\u4f4d10\u30da\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u305f\u7d50\u679c\u3067\u3059\u3002\n\n``` r\nget_ga(profile.id = df_prof_list$id,\n       start.date = \"2015-01-01\", \n       end.date   = \"2015-12-31\",\n       metrics    = \"ga:pageviews\",\n       dimensions = \"ga:pageTitle, ga:pagePath\",\n       sort       = \"-ga:pageviews\") %>% \n  dplyr::filter(grepl(\"^/uri\", page.path)) %>% \n  head(10) %>% \n  dplyr::mutate(page.path  = paste0(\"http://qiita.com\", page.path),\n                page.title = gsub(\" - Qiita\", \"\", page.title)) %>%\n  knitr::kable(format = \"markdown\")\n```\n\n|page.title                                                        |page.path                                       | pageviews|\n|:-----------------------------------------------------------------|:-----------------------------------------------|---------:|\n|\u30c7\u30fc\u30bf\u89e3\u6790\u305d\u306e\u524d\u306b: \u5206\u5e03\u578b\u306e\u78ba\u8a8d\u3068\u6b63\u898f\u6027\u306e\u691c\u5b9a #rstatsj           |http://qiita.com/uri/items/e656f90e9dda342c54bb |      8708|\n|\u3053\u306eR\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3059\u3054\u30442014                                       |http://qiita.com/uri/items/ce711ee6da76a1e11ca5 |      2308|\n|R\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u305f\u3081\u306e\u7b2c\u4e00\u6b69\uff08\u672a\u5b8c\uff09                             |http://qiita.com/uri/items/1245441ab179c6ee76f9 |      1848|\n|\u4e00\u6b69\u9032\u3093\u3060R\u3068\u306e\u4ed8\u304d\u5408\u3044\u65b9                                         |http://qiita.com/uri/items/83804c9eb4a3cb9c6811 |      1762|\n|GitHub - \u3053\u308c\u304b\u3089\u7814\u7a76\u3092\u59cb\u3081\u308b\u5927\u5b66\u5b66\u90e8\u751f\u3084\u9662\u751f\u306fDr.Elg\u3092\u5229\u7528\u3057\u3088\u3046 |http://qiita.com/uri/items/8eb4324f4c09f15e4b5b |      1644|\n|RStudio\u3092\u4f7f\u3063\u305fPDF\u6587\u66f8\u306e\u4f5c\u6210\uff08for RStudio 0.98.932+\uff09             |http://qiita.com/uri/items/d9e50e8e5a37217a3f5d |      1623|\n|R - \u9023\u756a\u306b\u306a\u3063\u3066\u3044\u308b\u8907\u6570\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080                      |http://qiita.com/uri/items/e162302ce8a38b009660 |      1447|\n|2014\u5e74\u7248RStudio\u3092\u4f7f\u3063\u305f\u6587\u66f8\u4f5c\u6210\u6cd5                                 |http://qiita.com/uri/items/5cce4431ad0d96b96689 |      1410|\n|R - \u5b66\u4f1a\u767a\u8868\u306e\u305f\u3081\u306eggplot2\u306e\u8a2d\u5b9a\u3081\u3082                             |http://qiita.com/uri/items/615653e83642d7e475de |      1323|\n|RStudio 0.99\u306e\u5909\u66f4\u70b9\u3068\u6700\u8fd1\u306eR\u30b3\u30fc\u30c9\u306e\u66f8\u304d\u65b9                       |http://qiita.com/uri/items/a60f28d437c773010daf |      1152|\n\n#### \ud83d\udeb6 \u30bb\u30c3\u30b7\u30e7\u30f3\u6570\n\n\u6708\u3054\u3068\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u6570\u3092\u6c42\u3081\u307e\u3059\u3002**`{ggplot2}`**\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u53d6\u5f97\u3057\u305f\u30c7\u30fc\u30bf\u3092\u56f3\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n``` r\nget_ga(profile.id = df_prof_list$id, \n       start.date = \"2015-01-01\", \n       end.date   = \"2015-12-31\",\n       metrics    = \"ga:sessions\",\n       dimensions = \"ga:month\") %>% \n  dplyr::mutate(month = lubridate::month(month, label = TRUE, abbr = TRUE)) %>% \n    # \u3053\u3053\u307e\u3067\u3067\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u3002\u4ee5\u4e0b\u53ef\u8996\u5316\u306e\u305f\u3081\u306e\u30b3\u30fc\u30c9\n  ggplot(aes(month, sessions, group = 1)) +\n  geom_line() +\n  geom_point(size = 2, colour = \"magenta\")\n```\n\n![google_analytics_rga_fig1.png](https://qiita-image-store.s3.amazonaws.com/0/19462/aea4342d-08c6-d0f2-ac7b-b992f8ffd8db.png)\n\n\n12\u6708\u306f\u30a2\u30c9\u30d9\u30f3\u30c8\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u5f71\u97ff\u3082\u3042\u3063\u3066\u304b\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u6570\u304c\u4f38\u3073\u307e\u3057\u305f\u2197\ufe0f\u3002\u9806\u8abf\u9806\u8abf \ud83d\ude04\n\n#### \ud83c\udf0d \u5730\u57df\u5225\u306e\u30a2\u30af\u30bb\u30b9\n\n\u3053\u308c\u3092\u898b\u308b\u306e\u304c\u597d\u304d\u3067\u3059\u3002\u3069\u306e\u5730\u57df\u3001\u56fd\u306e\u4eba\u304c\u898b\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u304b\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n``` r\nlibrary(rworldmap)\ndf_session_country <- get_ga(profile.id = df_prof_list$id,\n       start.date = \"2015-01-01\", \n       end.date   = \"2015-12-31\",\n       metrics    = \"ga:sessions\",\n       dimensions = \"ga:country\")\ndf_session_country %>% dplyr::group_size()\n```\n\n[1] 104\n\n\u591a\u3044\u306e\u304b\u5c11\u306a\u3044\u306e\u304b\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001\u3044\u308d\u3044\u308d\u306a\u56fd\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u304c\u3042\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\n``` r\ndf_session_country %>% dplyr::arrange(-sessions) %>% \n  head(10) %>% \n  knitr::kable(format = \"markdown\")\n```\n\n\u4e0a\u4f4d10\u306e\u56fd\u306e\u8868\u3067\u3059\u3002\u5f53\u7136\u306a\u304c\u3089\u65e5\u672c\u306e\u65b9\u304c\u591a\u304f\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n|country        | sessions|\n|:--------------|--------:|\n|Japan          |    29347|\n|United States  |     1614|\n|(not set)      |      904|\n|China          |      261|\n|Germany        |      156|\n|United Kingdom |      151|\n|Russia         |      127|\n|South Korea    |      102|\n|Netherlands    |       97|\n|France         |       81|\n\n\n``` r\n# \u5730\u57df\u5225\u306e\u30a2\u30af\u30bb\u30b9\u3092\u53ef\u8996\u5316\u3059\u308b\u305f\u3081\u306eR\u30b3\u30fc\u30c9\ndf_session_country %<>% dplyr::mutate(sessions_c = cut(df_session_country$sessions, \n                                                       breaks = c(0, 10, 50, 100, 250, 500, 1000, 10000, 30000),\n                                                       labels = c(\"0 - 10\", \"10 - 50\", \"50 - 100\", \"100 - 250\",\n                                                                  \"250 - 500\", \"500 - 1000\", \"1000 - 10000\",\n                                                                  \"10000 - 30000\")))\nsessions_pal <- munsell::hue_slice(\"10RP\") %$% data %>% dplyr::filter(grepl(\"6/\", name)) %>% dplyr::arrange(chroma) %$% hex\nmap_world <- map_data(\"world\") %>% \n  .[.$region != \"Antarctica\",] \n\ngg <- ggplot()\ngg <- gg + geom_map(data = map_world, \n                    map = map_world,\n                    aes(x = long, y = lat, map_id = region),\n                    color = \"white\", \n                    fill = \"#7f7f7f\", \n                    size = 0.05, \n                    alpha = 0.2)\ngg <- gg + geom_map(data = df_session_country,\n              map  = map_world,\n              aes(map_id = country, fill = sessions_c))\ngg <- gg + scale_fill_manual(values = sessions_pal)\ngg <- gg + guides(fill = guide_legend(override.aes = list(colour = NA)))\ngg <- gg + coord_equal() + theme_map()\ngg <- gg + theme(legend.position = \"bottom\")\nprint(gg)\n```\n\n![google_analytics_rga_fig2.png](https://qiita-image-store.s3.amazonaws.com/0/19462/7530037d-ea0d-d188-66ea-f2cc5a96368e.png)\n\n\n### \u23f0 \u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\n\n\u73fe\u5728\u9650\u5b9a\u7684\u306b\u8a66\u9a13\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u3082\u5bfe\u8c61\u306b\u3067\u304d\u307e\u3059\u3002\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f[Real Time Reporting API](https://developers.google.com/analytics/devguides/reporting/realtime/dimsmets/)\u3092\u5229\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u4eca\u5ea6\u306f`get_realtime()`\u95a2\u6570\u3092\u4f7f\u3044\u307e\u3059\u3002\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u306f`get_ga()`\u3068\u540c\u3058\u3067\u3001\u53d6\u5f97\u3057\u305f\u3044*metrics*\u3068*dimensions*\u3092\u6e21\u3057\u307e\u3059\u3002\n\n``` r\nget_realtime(profile.id = df_prof_list$id,\n             metrics    = \"rt:activeUsers\",\n             dimensions = \"rt:region, rt:browser, rt:operatingSystem\")\n```\n\n  region browser operating.system active.users\n1 Aichi Prefecture  Safari              iOS            1\n2         Hokkaido  Chrome          Windows            1\n3         New York Firefox            Linux            1\n\n\u65b0\u5e74\u65e9\u3005\u3001\u8ab0\u3067\u3057\u3087\u3046\u304b... \uff08\u3082\u3057\u304b\u3057\u3066\u7fbd\u9ce5\uff1f\uff09\n\n\u305d\u306e\u4ed6\u3001API\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u898b\u308b\u9650\u308a\u6761\u4ef6\u62bd\u51fa\u306a\u3069\u306e\u7d30\u304b\u3044\u6307\u5b9a\u3082\u3067\u304d\u305d\u3046\u306a\u306e\u3067\u826f\u3044\u3067\u3059\u3002\u516c\u5f0f\u306evignettes\u306b\u3082\u7d30\u304b\u3044\u5229\u7528\u65b9\u6cd5\u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u4e00\u5ea6\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n### \ud83d\udcda \u53c2\u8003\n\n* [R \u304b\u3089 API \u3067 Google \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u306e\u30c7\u30fc\u30bf\u3092\u8aad\u3080\u3053\u3081\u308b\u30d1\u30c3\u30b1\u30fc\u30b8, RGoogleAnalytics \u306e\u30af\u30a8\u30ea\u4f5c\u6210\u65b9\u6cd5 - \u5effTT](http://abrahamcow.hatenablog.com/entry/2015/01/02/215112)\n* [Google Analytics Data Mining with R](http://www.slideshare.net/Tatvic/google-analytics-data-mining-with-r)\n* [\u5404\u30d7\u30ed\u30b0\u30e9\u30e0\u8a00\u8a9e\u6bce\u306eGoogle Analytics API(R,python,Excel) - \"Diary\" \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u3055\u3093\u3078\u306e\u6069\u8fd4\u3057](http://azwoo.hatenablog.com/entry/2015/03/31/170647)\n* [World Map Panel Plots with ggplot2 2.0 & ggalt | rud.is](http://rud.is/b/2015/12/28/world-map-panel-plots-with-ggplot2-2-0-ggalt/)\n* [Faceted \u201cWorld Population by Income\u201d Choropleths in ggplot | rud.is](http://rud.is/b/2015/07/09/faceted-world-population-by-income-choropleths-in-ggplot/)\n* [R\u3067\u89e3\u6790\uff1a\u30de\u30f3\u30bb\u30eb\u30fb\u30ab\u30e9\u30fc\u30fb\u30b7\u30b9\u30c6\u30e0\u306b\u89e6\u308c\u3066\u307f\u307e\u305b\u3093\u304b\uff1f\u300cmunsell\u300d\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u7d39\u4ecb](https://www.karada-good.net/analyticsr/r-246/)\n\n", "tags": ["R", "GoogleAnalytics"]}