{"context": " More than 1 year has passed since last update.\u3053\u306e\u8a18\u4e8b\u306fFFT \u3092\u7528\u3044\u305f\u591a\u500d\u9577\u6574\u6570\u306e\u4e57\u7b97\u306e\u52b9\u7387\u5316 (1) \u304b\u3089\u306e\u6d3e\u751f\u8a18\u4e8b\u306a\u306e\u3067\u3001\u305d\u308c\u3092\u8aad\u3093\u3067\u3044\u308b\u524d\u63d0\u306b\u66f8\u3044\u3066\u307e\u3059\u3002\n\n\u7573\u307f\u8fbc\u307f\u4e57\u7b97\n\u591a\u500d\u9577\u4e57\u7b97\u3068 DFT \u3068\u306e\u67b6\u3051\u6a4b\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u306f\u3001\u8a73\u3057\u304f\u306f\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3068\u8a00\u308f\u308c\u308b\u3082\u306e\u3067\u3001\u6e96\u5099\u3057\u3066\u3044\u308b\u8981\u7d20\u6570\u3092\u8d85\u3048\u305f\u90e8\u5206\u306e\u4e57\u7b97\u7d50\u679c\u304c\u4e0b\u4f4d\u306b\u5de1\u56de\u3057\u3066\u8db3\u3057\u8fbc\u307e\u308c\u308b \u6b63\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97 \u3068\u3001\u9006\u306b\u4e0b\u4f4d\u304b\u3089\u5dee\u3057\u5f15\u304b\u308c\u308b \u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97 \u306e\u4ed6\u3001\u03b1\u03b1\\alpha \u500d\u3055\u308c\u3066\u5de1\u56de\u3059\u308b\u30d1\u30bf\u30fc\u30f3\u3082\u3042\u308b\u30021\n\u901a\u5e38 \u201d\u591a\u500d\u9577\u4e57\u7b97\u306b FFT \u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3092\u5229\u7528\u3059\u308b\u201d \u3068\u3044\u3046\u5834\u5408\u306b\u7528\u3044\u3066\u3044\u308b\u65b9\u6cd5\u306f\u6b63\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3067\u3042\u308a\u3001\u4e0a\u4f4d\u306e\u6f14\u7b97\u7d50\u679c\u304c\u5de1\u56de\u3057\u306a\u3044\u3088\u3046\u306b\u3042\u3048\u3066 0 \u3092\u8a70\u3081\u8fbc\u3080\u6280\u6cd5\u304c\u53d6\u3089\u308c\u3066\u3044\u308b\u3002\u4f8b\u3048\u3070\n\\begin{eqnarray}\n\\{x_i\\} &=& \\{3,1,4,1\\}\\\\\n\\{y_i\\} &=& \\{5,9,2,6\\}\n\\end{eqnarray}\n{xi}={3,1,4,1}{yi}={5,9,2,6}{\\begin{eqnarray}\n\\{x_i\\} &=& \\{3,1,4,1\\}\\\\\n\\{y_i\\} &=& \\{5,9,2,6\\}\n\\end{eqnarray}\n}\n\u306e\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3092\u8003\u3048\u308b\u3068\u3001\n\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5)\\\\\n&=& 6t^6+26t^5+23t^4+61t^3+35t^2+32t+15\n\\end{eqnarray}\n(t3+4t2+t+3)(6t3+2t2+9t+5)=6t6+26t5+23t4+61t3+35t2+32t+15{\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5)\\\\\n&=& 6t^6+26t^5+23t^4+61t^3+35t^2+32t+15\n\\end{eqnarray}\n}\n\u3068\u3044\u3046\u3053\u3068\u304b\u3089\u3001\n\\{3,1,4,1\\}\\times\\{5,9,2,6\\}=\\{15,32,35,61,23,26,6\\}\n{3,1,4,1}\u00d7{5,9,2,6}={15,32,35,61,23,26,6}{\\{3,1,4,1\\}\\times\\{5,9,2,6\\}=\\{15,32,35,61,23,26,6\\}\n}\n\u3068\u3044\u3046\u306e\u304c\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u7d50\u679c\u306b\u306a\u308b\u3002\u666e\u901a\u306b DFT \u3092\u7d4c\u7531\u3057\u3066\u3053\u306e\u7d50\u679c\u3092\u51fa\u3059\u306b\u306f\u4e0a\u4f4d\u306b {0}\\{0\\} \u3092\u8ffd\u52a0\u3057\u3066 8 \u8981\u7d20\u306e DFT \u3092\u884c\u3044\u3001\n\\begin{eqnarray}\n&&{\\rm DFT}^{-1}({\\rm DFT}(\\{3,1,4,1,0,0,0,0\\})*{\\rm DFT}(\\{5,9,2,6,0,0,0,0\\}))\\\\\n&=&\\{15,32,35,61,23,26,6,0\\}\n\\end{eqnarray}\nDFT\u22121(DFT({3,1,4,1,0,0,0,0})\u2217DFT({5,9,2,6,0,0,0,0}))={15,32,35,61,23,26,6,0}{\\begin{eqnarray}\n&&{\\rm DFT}^{-1}({\\rm DFT}(\\{3,1,4,1,0,0,0,0\\})*{\\rm DFT}(\\{5,9,2,6,0,0,0,0\\}))\\\\\n&=&\\{15,32,35,61,23,26,6,0\\}\n\\end{eqnarray}\n}\n\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308b\u2026\u306e\u3060\u304c\u3001\u3053\u306e\u6f14\u7b97\u3092\u5143\u306e\u30c7\u30fc\u30bf\u6570 4 \u8981\u7d20\u306e\u307e\u307e\u884c\u3046\u3068\n\\begin{eqnarray}\n&&{\\rm DFT}^{-1}({\\rm DFT}(\\{3,1,4,1\\})*{\\rm DFT}(\\{5,9,2,6\\}))\\\\\n&=&\\{38,58,41,61\\}\n\\end{eqnarray}\nDFT\u22121(DFT({3,1,4,1})\u2217DFT({5,9,2,6}))={38,58,41,61}{\\begin{eqnarray}\n&&{\\rm DFT}^{-1}({\\rm DFT}(\\{3,1,4,1\\})*{\\rm DFT}(\\{5,9,2,6\\}))\\\\\n&=&\\{38,58,41,61\\}\n\\end{eqnarray}\n}\n\u3068\u306a\u308b\u3002\u3053\u306e\u7d50\u679c\u306f\u591a\u9805\u5f0f\u8868\u73fe\u3067\u8a00\u3048\u3070\n\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5) \\pmod{t^4-1}\\\\\n&=& 61t^3+(35+6)t^2+(32+26)t+(15+23)\\\\\n&=& 61t^3+41t^2+58t+38\n\\end{eqnarray}\n(t3+4t2+t+3)(6t3+2t2+9t+5)(modt4\u22121)=61t3+(35+6)t2+(32+26)t+(15+23)=61t3+41t2+58t+38{\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5) \\pmod{t^4-1}\\\\\n&=& 61t^3+(35+6)t^2+(32+26)t+(15+23)\\\\\n&=& 61t^3+41t^2+58t+38\n\\end{eqnarray}\n}\n\u3068\u7b49\u3057\u3044\u3002\u3053\u308c\u306f 4 \u8981\u7d20\u3092\u8d85\u3048\u308b\u90e8\u5206\u304c\u5de1\u56de\u3057\u3066\u8db3\u3057\u8fbc\u307e\u308c\u305f\u5f62\u306b\u306a\u3063\u3066\u3044\u308b(\u591a\u9805\u5f0f\u8868\u73fe\u306e 2 \u884c\u76ee)\u3002\u3053\u308c\u3092\u6b63\u5de1\u56de\u591a\u9805\u5f0f\u3068\u3044\u3046\u3002\u9006\u306b\u8d85\u3048\u305f\u90e8\u5206\u304c\u8ca0\u306b\u306a\u308b\n\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5) \\pmod{t^4+1}\\\\\n&=& 61t^3+(35-6)t^2+(32-26)t+(15-23)\\\\\n&=& 61t^3+29t^2+6t-8\n\\end{eqnarray}\n(t3+4t2+t+3)(6t3+2t2+9t+5)(modt4+1)=61t3+(35\u22126)t2+(32\u221226)t+(15\u221223)=61t3+29t2+6t\u22128{\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5) \\pmod{t^4+1}\\\\\n&=& 61t^3+(35-6)t^2+(32-26)t+(15-23)\\\\\n&=& 61t^3+29t^2+6t-8\n\\end{eqnarray}\n}\n\u306e\u5f62\u3092\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3068\u3044\u3046\u3002\n\n\u96e2\u6563\u8377\u91cd\u5909\u63db\n\u3055\u3066\u3001\u6b63\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u306b\u3064\u3044\u3066\u306f\u901a\u5e38\u306e DFT \u3092\u4f7f\u3063\u3066\u8a08\u7b97\u3059\u308c\u3070\u3044\u3044\u3053\u3068\u306f\u5148\u8ff0\u306e\u901a\u308a\u306a\u306e\u3060\u304c\u3001\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u306f\u3069\u3046\u3059\u308b\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u96e2\u6563\u8377\u91cd\u5909\u63db(Discrete Weighted Transform; DWT)\u306a\u308b\u3082\u306e\u3092\u4f7f\u3046\u3002\u307e\u305f\u65b0\u3057\u3044\u4f55\u304b\u304b\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u3082\u3042\u308b\u304c\u3001\u305d\u3093\u306a\u306b\u9762\u5012\u304f\u3055\u3044\u3053\u3068\u3067\u3082\u306a\u3044\u3002\n\u518d\u5ea6 DFT \u3068\u6b63\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u306e\u95a2\u4fc2\u3092\u5fa9\u7fd2\u3057\u3066\u304a\u304f\u3068\nz_l = n^{-1}\\sum_{k=0}^{n-1}\n \\left(\\sum_{i=0}^{n-1}x_iw^{ik}\\right)\n \\left(\\sum_{j=0}^{n-1}y_jw^{jk}\\right) w^{-kl}\n= \\sum_{i+j=l} x_iy_j + \\sum_{i+j=l+n} x_iy_j\nzl=n\u22121n\u22121\u2211k=0(n\u22121\u2211i=0xiwik)(n\u22121\u2211j=0yjwjk)w\u2212kl=\u2211i+j=lxiyj+\u2211i+j=l+nxiyj{z_l = n^{-1}\\sum_{k=0}^{n-1}\n \\left(\\sum_{i=0}^{n-1}x_iw^{ik}\\right)\n \\left(\\sum_{j=0}^{n-1}y_jw^{jk}\\right) w^{-kl}\n= \\sum_{i+j=l} x_iy_j + \\sum_{i+j=l+n} x_iy_j\n}\n\u3068\u3044\u3046\u611f\u3058\u3067\u3042\u308b\u3002\u5b9f\u306f\u3053\u306e\u5f0f\u306e\u6700\u5f8c\u306e \u2211\\sum \u304c\u5de1\u56de\u3057\u3066\u3044\u308b\u90e8\u5206\u3092\u8868\u3057\u3066\u308b\u3002\u3053\u3053\u3067\u3001\u65b0\u3057\u3044\u6570\u5217 {ai}\\{a_i\\} \u3092\u5c0e\u5165\u3057\u3066\n\\begin{cases}\nX_k = \\sum_{j=0}^{n-1}a_j x_j w^{jk}\\\\\nx_j = n^{-1}a_j^{-1} \\sum_{k=0}^{n-1} X_k w^{-kj}\n\\end{cases}\n{Xk=\u2211n\u22121j=0ajxjwjkxj=n\u22121a\u22121j\u2211n\u22121k=0Xkw\u2212kj{\\begin{cases}\nX_k = \\sum_{j=0}^{n-1}a_j x_j w^{jk}\\\\\nx_j = n^{-1}a_j^{-1} \\sum_{k=0}^{n-1} X_k w^{-kj}\n\\end{cases}\n}\n\u3068\u3057\u3088\u3046\u3002\u6570\u5f0f\u3092\u30e2\u30ea\u30e2\u30ea\u89e3\u3044\u3066\u3044\u304f\u306e\u306f\u9762\u5012\u3060\u304c\u3001\u3068\u308a\u3042\u3048\u305a ai=wi/2a_i=w^{i/2} \u3068\u3059\u308c\u3070\n\\begin{eqnarray}\n\\{Z_l\\} &=& {\\rm DWT}(\\{x_i\\}, \\{a_i\\}) * {\\rm DWT}(\\{y_j\\}, \\{a_j\\})\\\\\n\\{z_l\\} &=& {\\rm DWT}^{-1}(\\{Z_l\\}, \\{a_l\\})\\\\\n&=& \\left\\{\\sum_{i+j=l} x_iy_j - \\sum_{i+j=l+n} x_iy_j \\right\\}\n\\end{eqnarray}\n{Zl}=DWT({xi},{ai})\u2217DWT({yj},{aj}){zl}=DWT\u22121({Zl},{al})={\u2211i+j=lxiyj\u2212\u2211i+j=l+nxiyj}{\\begin{eqnarray}\n\\{Z_l\\} &=& {\\rm DWT}(\\{x_i\\}, \\{a_i\\}) * {\\rm DWT}(\\{y_j\\}, \\{a_j\\})\\\\\n\\{z_l\\} &=& {\\rm DWT}^{-1}(\\{Z_l\\}, \\{a_l\\})\\\\\n&=& \\left\\{\\sum_{i+j=l} x_iy_j - \\sum_{i+j=l+n} x_iy_j \\right\\}\n\\end{eqnarray}\n}\n\u3064\u307e\u308a\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u7d50\u679c\u304c\u6c42\u307e\u308b\u3002\u3082\u3061\u308d\u3093\u3053\u306e\u539f\u7406\u306f\u6574\u6570 DFT (NTT) \u3067\u3082\u4f7f\u3048\u308b\u3002\n\n\u52b9\u7387\u5316\n\u5143\u306e\u8a18\u4e8b\u3067\u6319\u3052\u305f\u52b9\u7387\u5316\u3068\u540c\u69d8\u306b\u5143\u306e\u30c7\u30fc\u30bf\u3084\u6f14\u7b97\u7d50\u679c\u304c\u5b9f\u6570\u3067\u3042\u308b\u3053\u3068\u3092\u5229\u7528\u3059\u308b\u3068\u3001\u8907\u7d20\u6570\u3068\u3057\u3066\u7121\u99c4\u306b\u306a\u3063\u3066\u3044\u308b\u90e8\u5206\u306b\u3082\u30c7\u30fc\u30bf\u3092\u8a70\u3081\u8fbc\u3093\u3067\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3092\u52b9\u7387\u7684\u306b\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u5143\u3068\u540c\u69d8\u306b\n\\begin{eqnarray}\nx'_j &=& x_{2j} + ix_{2j+1}\\\\\nX_k &=& \\sum_{j=0}^{n-1} x_j w^{j/2} w^{jk}\\\\\nX'_k &=& \\sum_{j=0}^{n/2-1} x'_j w^j w^{2jk}\n\\end{eqnarray}\nx\u2032j=x2j+ix2j+1Xk=n\u22121\u2211j=0xjwj/2wjkX\u2032k=n/2\u22121\u2211j=0x\u2032jwjw2jk{\\begin{eqnarray}\nx'_j &=& x_{2j} + ix_{2j+1}\\\\\nX_k &=& \\sum_{j=0}^{n-1} x_j w^{j/2} w^{jk}\\\\\nX'_k &=& \\sum_{j=0}^{n/2-1} x'_j w^j w^{2jk}\n\\end{eqnarray}\n}\n\u3068\u3059\u308b(ww \u306f\u5168\u4f53\u3092\u901a\u3057\u3066 1 \u306e\u539f\u59cb nn \u4e57\u6839\u3068\u3059\u308b\u3002\u307e\u305f\u3001{X\u2032k}\\{X'_k\\} \u306f\u9805\u6570 n/2n/2 \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\u3002)\u3068\u3001 {Xk}=DWT({xj},{wj/2})\\{X_k\\}={\\rm DWT}(\\{x_j\\},\\{w^{j/2}\\}) \u3068 {X\u2032k}=DWT({x\u2032j},{wj})\\{X'_k\\}={\\rm DWT}(\\{x'_j\\},\\{w^j\\}) \u306e\u95a2\u4fc2\u306f\n\\begin{cases}\nA'_k &= \\dfrac{1}{2}(1+iw^{k+1/2})(X'_k - \\overline{X'_{n/2-1-k}})\\\\\nX_k &= X'_k - A'_k\\\\\nX_{n/2-1-k} &= X'_{n/2-1-k} + \\overline{A'_k}\n\\end{cases}\n{A\u2032k=12(1+iwk+1/2)(X\u2032k\u2212\u00afX\u2032n/2\u22121\u2212k)Xk=X\u2032k\u2212A\u2032kXn/2\u22121\u2212k=X\u2032n/2\u22121\u2212k+\u00afA\u2032k{\\begin{cases}\nA'_k &= \\dfrac{1}{2}(1+iw^{k+1/2})(X'_k - \\overline{X'_{n/2-1-k}})\\\\\nX_k &= X'_k - A'_k\\\\\nX_{n/2-1-k} &= X'_{n/2-1-k} + \\overline{A'_k}\n\\end{cases}\n}\n\\begin{cases}\nA_k &= \\dfrac{1}{2}(1-iw^{-(k+1/2)})(X_k-\\overline{X_{n/2-1-k}})\\\\\nX'_k &= X_k - A_k\\\\\nX'_{n/2-1-k} &= X_{n/2-1-k} + \\overline{A_k}\n\\end{cases}\n{Ak=12(1\u2212iw\u2212(k+1/2))(Xk\u2212\u00afXn/2\u22121\u2212k)X\u2032k=Xk\u2212AkX\u2032n/2\u22121\u2212k=Xn/2\u22121\u2212k+\u00afAk{\\begin{cases}\nA_k &= \\dfrac{1}{2}(1-iw^{-(k+1/2)})(X_k-\\overline{X_{n/2-1-k}})\\\\\nX'_k &= X_k - A_k\\\\\nX'_{n/2-1-k} &= X_{n/2-1-k} + \\overline{A_k}\n\\end{cases}\n}\n\u3068\u306a\u308b\u3002\u3088\u304f\u898b\u308b\u3068\u534a\u5206\u304f\u3089\u3044\u8a08\u7b97\u3055\u308c\u3066\u3044\u306a\u3044\u3088\u3046\u306b\u898b\u3048\u308b\u304c\u3001\u5143\u30c7\u30fc\u30bf\u304c\u5b9f\u6570\u3067\u3042\u308b\u3053\u3068\u3092\u5229\u7528\u3057\u305f\u5171\u5f79\u306e\u95a2\u4fc2 (Xn\u22121\u2212k=\u00afXkX_{n-1-k}=\\overline{X_k}) \u3067\u5b9f\u969b\u306b\u306f\u6c42\u307e\u3063\u3066\u3044\u308b\u3002\n\u3053\u308c\u3092\u4e00\u5fdc\u30b3\u30fc\u30c9\u3063\u307d\u304f\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\nvoid NegaRealDWT(Complex* X, int n, DFTDirection dir) {\n  // \u6ce8: \u5f15\u6570\u306e n \u306f\u5143\u306e\u30c7\u30fc\u30bf\u6570\u306e\u534a\u5206\n  const double t = M_PI / n;\n  if (dir == Backward) {\n    // Convert real to complex\n    for (int i = 0; i < n / 2; ++i) {\n      Complex a = (X[i] - X[n - 1 - i].conj()) * Complex(1 - sin(th * (i + 0.5)) , -cos(th * (i + 0.5))) / 2;\n      X[i] -= a;\n      X[n - 1 - i] += a.conj();\n    }\n  }\n  NegaComplexDFT(X, n, dir);\n  if (dir == Forward) {\n    // Convert complex to real\n    for (int i = 0; i < n / 2; ++i) {\n      Complex a = (X[i] - X[n - 1 - i].conj()) * Complex(1 - sin(th * (i + 0.5)) , cos(th * (i + 0.5))) / 2;\n      X[i] -= a;\n      X[n - 1 - i] += a.conj();\n    }\n  }\n}\n\nvoid NegaCyclicRealConvolution(double x[], double y[], int n, double z[]) {\n  Complex* X = static_cast<Complex*>(x);\n  Complex* Y = static_cast<Complex*>(y);\n  NegaRealDWT(X, n / 2, Forward);  // n \u500b\u306e\u5b9f\u6570 == n/2 \u500b\u306e\u8907\u7d20\u6570\n  NegaRealDWT(Y, n / 2, Forward);\n  for (int i = 0; i < n / 2; ++i)\n    Z[i] = X[i] * Y[i];\n  Complex* Z = static_cast<Complex*>(z);\n  NegaRealDWT(Z, n / 2, Backward);\n}\n\n\n\n\n\n\u591a\u6570\u6841\u8a08\u7b97\u306b\u304a\u3051\u308b\u9ad8\u901f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u7814\u7a76, \u5f8c\u4fdd\u7bc4, \u65e9\u7a32\u7530\u5927\u5b66\u5927\u5b66\u9662 \u535a\u58eb\u8ad6\u6587\u00a0\u21a9\n\n\n\n\u3053\u306e\u8a18\u4e8b\u306f[FFT \u3092\u7528\u3044\u305f\u591a\u500d\u9577\u6574\u6570\u306e\u4e57\u7b97\u306e\u52b9\u7387\u5316 (1)](http://qiita.com/peria/items/fbdd52768b4659823d88) \u304b\u3089\u306e\u6d3e\u751f\u8a18\u4e8b\u306a\u306e\u3067\u3001\u305d\u308c\u3092\u8aad\u3093\u3067\u3044\u308b\u524d\u63d0\u306b\u66f8\u3044\u3066\u307e\u3059\u3002\n\n# \u7573\u307f\u8fbc\u307f\u4e57\u7b97\n\u591a\u500d\u9577\u4e57\u7b97\u3068 DFT \u3068\u306e\u67b6\u3051\u6a4b\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u306f\u3001\u8a73\u3057\u304f\u306f\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3068\u8a00\u308f\u308c\u308b\u3082\u306e\u3067\u3001\u6e96\u5099\u3057\u3066\u3044\u308b\u8981\u7d20\u6570\u3092\u8d85\u3048\u305f\u90e8\u5206\u306e\u4e57\u7b97\u7d50\u679c\u304c\u4e0b\u4f4d\u306b\u5de1\u56de\u3057\u3066\u8db3\u3057\u8fbc\u307e\u308c\u308b **\u6b63\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97** \u3068\u3001\u9006\u306b\u4e0b\u4f4d\u304b\u3089\u5dee\u3057\u5f15\u304b\u308c\u308b **\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97** \u306e\u4ed6\u3001$\\alpha$ \u500d\u3055\u308c\u3066\u5de1\u56de\u3059\u308b\u30d1\u30bf\u30fc\u30f3\u3082\u3042\u308b\u3002[^1]\n[^1]: \u591a\u6570\u6841\u8a08\u7b97\u306b\u304a\u3051\u308b\u9ad8\u901f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u7814\u7a76, \u5f8c\u4fdd\u7bc4, \u65e9\u7a32\u7530\u5927\u5b66\u5927\u5b66\u9662 \u535a\u58eb\u8ad6\u6587\n\n\u901a\u5e38 \u201d\u591a\u500d\u9577\u4e57\u7b97\u306b FFT \u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3092\u5229\u7528\u3059\u308b\u201d \u3068\u3044\u3046\u5834\u5408\u306b\u7528\u3044\u3066\u3044\u308b\u65b9\u6cd5\u306f\u6b63\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3067\u3042\u308a\u3001\u4e0a\u4f4d\u306e\u6f14\u7b97\u7d50\u679c\u304c\u5de1\u56de\u3057\u306a\u3044\u3088\u3046\u306b\u3042\u3048\u3066 0 \u3092\u8a70\u3081\u8fbc\u3080\u6280\u6cd5\u304c\u53d6\u3089\u308c\u3066\u3044\u308b\u3002\u4f8b\u3048\u3070\n\n```math\n\\begin{eqnarray}\n\\{x_i\\} &=& \\{3,1,4,1\\}\\\\\n\\{y_i\\} &=& \\{5,9,2,6\\}\n\\end{eqnarray}\n```\n\n\u306e\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3092\u8003\u3048\u308b\u3068\u3001\n\n```math\n\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5)\\\\\n&=& 6t^6+26t^5+23t^4+61t^3+35t^2+32t+15\n\\end{eqnarray}\n```\n\n\u3068\u3044\u3046\u3053\u3068\u304b\u3089\u3001\n\n```math\n\\{3,1,4,1\\}\\times\\{5,9,2,6\\}=\\{15,32,35,61,23,26,6\\}\n```\n\n\u3068\u3044\u3046\u306e\u304c\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u7d50\u679c\u306b\u306a\u308b\u3002\u666e\u901a\u306b DFT \u3092\u7d4c\u7531\u3057\u3066\u3053\u306e\u7d50\u679c\u3092\u51fa\u3059\u306b\u306f\u4e0a\u4f4d\u306b $\\\\{0\\\\}$ \u3092\u8ffd\u52a0\u3057\u3066 8 \u8981\u7d20\u306e DFT \u3092\u884c\u3044\u3001\n\n```math\n\\begin{eqnarray}\n&&{\\rm DFT}^{-1}({\\rm DFT}(\\{3,1,4,1,0,0,0,0\\})*{\\rm DFT}(\\{5,9,2,6,0,0,0,0\\}))\\\\\n&=&\\{15,32,35,61,23,26,6,0\\}\n\\end{eqnarray}\n```\n\n\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308b\u2026\u306e\u3060\u304c\u3001\u3053\u306e\u6f14\u7b97\u3092\u5143\u306e\u30c7\u30fc\u30bf\u6570 4 \u8981\u7d20\u306e\u307e\u307e\u884c\u3046\u3068\n\n```math\n\\begin{eqnarray}\n&&{\\rm DFT}^{-1}({\\rm DFT}(\\{3,1,4,1\\})*{\\rm DFT}(\\{5,9,2,6\\}))\\\\\n&=&\\{38,58,41,61\\}\n\\end{eqnarray}\n```\n\n\u3068\u306a\u308b\u3002\u3053\u306e\u7d50\u679c\u306f\u591a\u9805\u5f0f\u8868\u73fe\u3067\u8a00\u3048\u3070\n\n```math\n\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5) \\pmod{t^4-1}\\\\\n&=& 61t^3+(35+6)t^2+(32+26)t+(15+23)\\\\\n&=& 61t^3+41t^2+58t+38\n\\end{eqnarray}\n```\n\n\u3068\u7b49\u3057\u3044\u3002\u3053\u308c\u306f 4 \u8981\u7d20\u3092\u8d85\u3048\u308b\u90e8\u5206\u304c\u5de1\u56de\u3057\u3066\u8db3\u3057\u8fbc\u307e\u308c\u305f\u5f62\u306b\u306a\u3063\u3066\u3044\u308b(\u591a\u9805\u5f0f\u8868\u73fe\u306e 2 \u884c\u76ee)\u3002\u3053\u308c\u3092\u6b63\u5de1\u56de\u591a\u9805\u5f0f\u3068\u3044\u3046\u3002\u9006\u306b\u8d85\u3048\u305f\u90e8\u5206\u304c\u8ca0\u306b\u306a\u308b\n\n```math\n\\begin{eqnarray}\n&&(t^3+4t^2+t+3)(6t^3+2t^2+9t+5) \\pmod{t^4+1}\\\\\n&=& 61t^3+(35-6)t^2+(32-26)t+(15-23)\\\\\n&=& 61t^3+29t^2+6t-8\n\\end{eqnarray}\n```\n\n\u306e\u5f62\u3092\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3068\u3044\u3046\u3002\n\n# \u96e2\u6563\u8377\u91cd\u5909\u63db\n\u3055\u3066\u3001\u6b63\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u306b\u3064\u3044\u3066\u306f\u901a\u5e38\u306e DFT \u3092\u4f7f\u3063\u3066\u8a08\u7b97\u3059\u308c\u3070\u3044\u3044\u3053\u3068\u306f\u5148\u8ff0\u306e\u901a\u308a\u306a\u306e\u3060\u304c\u3001\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u306f\u3069\u3046\u3059\u308b\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u96e2\u6563\u8377\u91cd\u5909\u63db(Discrete Weighted Transform; DWT)\u306a\u308b\u3082\u306e\u3092\u4f7f\u3046\u3002\u307e\u305f\u65b0\u3057\u3044\u4f55\u304b\u304b\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u3082\u3042\u308b\u304c\u3001\u305d\u3093\u306a\u306b\u9762\u5012\u304f\u3055\u3044\u3053\u3068\u3067\u3082\u306a\u3044\u3002\n\n\u518d\u5ea6 DFT \u3068\u6b63\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u306e\u95a2\u4fc2\u3092\u5fa9\u7fd2\u3057\u3066\u304a\u304f\u3068\n\n```math\nz_l = n^{-1}\\sum_{k=0}^{n-1}\n \\left(\\sum_{i=0}^{n-1}x_iw^{ik}\\right)\n \\left(\\sum_{j=0}^{n-1}y_jw^{jk}\\right) w^{-kl}\n= \\sum_{i+j=l} x_iy_j + \\sum_{i+j=l+n} x_iy_j\n```\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u3042\u308b\u3002\u5b9f\u306f\u3053\u306e\u5f0f\u306e\u6700\u5f8c\u306e $\\sum$ \u304c\u5de1\u56de\u3057\u3066\u3044\u308b\u90e8\u5206\u3092\u8868\u3057\u3066\u308b\u3002\u3053\u3053\u3067\u3001\u65b0\u3057\u3044\u6570\u5217 $\\\\{a_i\\\\}$ \u3092\u5c0e\u5165\u3057\u3066\n\n```math\n\\begin{cases}\nX_k = \\sum_{j=0}^{n-1}a_j x_j w^{jk}\\\\\nx_j = n^{-1}a_j^{-1} \\sum_{k=0}^{n-1} X_k w^{-kj}\n\\end{cases}\n```\n\n\u3068\u3057\u3088\u3046\u3002\u6570\u5f0f\u3092\u30e2\u30ea\u30e2\u30ea\u89e3\u3044\u3066\u3044\u304f\u306e\u306f\u9762\u5012\u3060\u304c\u3001\u3068\u308a\u3042\u3048\u305a $a_i=w^{i/2}$ \u3068\u3059\u308c\u3070\n\n```math\n\\begin{eqnarray}\n\\{Z_l\\} &=& {\\rm DWT}(\\{x_i\\}, \\{a_i\\}) * {\\rm DWT}(\\{y_j\\}, \\{a_j\\})\\\\\n\\{z_l\\} &=& {\\rm DWT}^{-1}(\\{Z_l\\}, \\{a_l\\})\\\\\n&=& \\left\\{\\sum_{i+j=l} x_iy_j - \\sum_{i+j=l+n} x_iy_j \\right\\}\n\\end{eqnarray}\n```\n\n\u3064\u307e\u308a\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u7d50\u679c\u304c\u6c42\u307e\u308b\u3002\u3082\u3061\u308d\u3093\u3053\u306e\u539f\u7406\u306f\u6574\u6570 DFT (NTT) \u3067\u3082\u4f7f\u3048\u308b\u3002\n\n## \u52b9\u7387\u5316\n[\u5143\u306e\u8a18\u4e8b](http://qiita.com/peria/items/fbdd52768b4659823d88)\u3067\u6319\u3052\u305f\u52b9\u7387\u5316\u3068\u540c\u69d8\u306b\u5143\u306e\u30c7\u30fc\u30bf\u3084\u6f14\u7b97\u7d50\u679c\u304c\u5b9f\u6570\u3067\u3042\u308b\u3053\u3068\u3092\u5229\u7528\u3059\u308b\u3068\u3001\u8907\u7d20\u6570\u3068\u3057\u3066\u7121\u99c4\u306b\u306a\u3063\u3066\u3044\u308b\u90e8\u5206\u306b\u3082\u30c7\u30fc\u30bf\u3092\u8a70\u3081\u8fbc\u3093\u3067\u8ca0\u5de1\u56de\u7573\u307f\u8fbc\u307f\u4e57\u7b97\u3092\u52b9\u7387\u7684\u306b\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u5143\u3068\u540c\u69d8\u306b\n\n```math\n\\begin{eqnarray}\nx'_j &=& x_{2j} + ix_{2j+1}\\\\\nX_k &=& \\sum_{j=0}^{n-1} x_j w^{j/2} w^{jk}\\\\\nX'_k &=& \\sum_{j=0}^{n/2-1} x'_j w^j w^{2jk}\n\\end{eqnarray}\n```\n\n\u3068\u3059\u308b($w$ \u306f\u5168\u4f53\u3092\u901a\u3057\u3066 1 \u306e\u539f\u59cb $n$ \u4e57\u6839\u3068\u3059\u308b\u3002\u307e\u305f\u3001$\\\\{X'\\_k\\\\}$ \u306f\u9805\u6570 $n/2$ \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\u3002)\u3068\u3001 $\\\\{X_k\\\\}={\\rm DWT}(\\\\{x_j\\\\},\\\\{w^{j/2}\\\\})$ \u3068 $\\\\{X'\\_k\\\\}={\\rm DWT}(\\\\{x'\\_j\\\\},\\\\{w^j\\\\})$ \u306e\u95a2\u4fc2\u306f\n\n```math\n\\begin{cases}\nA'_k &= \\dfrac{1}{2}(1+iw^{k+1/2})(X'_k - \\overline{X'_{n/2-1-k}})\\\\\nX_k &= X'_k - A'_k\\\\\nX_{n/2-1-k} &= X'_{n/2-1-k} + \\overline{A'_k}\n\\end{cases}\n```\n\n```math\n\\begin{cases}\nA_k &= \\dfrac{1}{2}(1-iw^{-(k+1/2)})(X_k-\\overline{X_{n/2-1-k}})\\\\\nX'_k &= X_k - A_k\\\\\nX'_{n/2-1-k} &= X_{n/2-1-k} + \\overline{A_k}\n\\end{cases}\n```\n\n\u3068\u306a\u308b\u3002\u3088\u304f\u898b\u308b\u3068\u534a\u5206\u304f\u3089\u3044\u8a08\u7b97\u3055\u308c\u3066\u3044\u306a\u3044\u3088\u3046\u306b\u898b\u3048\u308b\u304c\u3001\u5143\u30c7\u30fc\u30bf\u304c\u5b9f\u6570\u3067\u3042\u308b\u3053\u3068\u3092\u5229\u7528\u3057\u305f\u5171\u5f79\u306e\u95a2\u4fc2 ($X_{n-1-k}=\\overline{X_k}$) \u3067\u5b9f\u969b\u306b\u306f\u6c42\u307e\u3063\u3066\u3044\u308b\u3002\n\u3053\u308c\u3092\u4e00\u5fdc\u30b3\u30fc\u30c9\u3063\u307d\u304f\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n```cpp\nvoid NegaRealDWT(Complex* X, int n, DFTDirection dir) {\n  // \u6ce8: \u5f15\u6570\u306e n \u306f\u5143\u306e\u30c7\u30fc\u30bf\u6570\u306e\u534a\u5206\n  const double t = M_PI / n;\n  if (dir == Backward) {\n    // Convert real to complex\n    for (int i = 0; i < n / 2; ++i) {\n      Complex a = (X[i] - X[n - 1 - i].conj()) * Complex(1 - sin(th * (i + 0.5)) , -cos(th * (i + 0.5))) / 2;\n      X[i] -= a;\n      X[n - 1 - i] += a.conj();\n    }\n  }\n  NegaComplexDFT(X, n, dir);\n  if (dir == Forward) {\n    // Convert complex to real\n    for (int i = 0; i < n / 2; ++i) {\n      Complex a = (X[i] - X[n - 1 - i].conj()) * Complex(1 - sin(th * (i + 0.5)) , cos(th * (i + 0.5))) / 2;\n      X[i] -= a;\n      X[n - 1 - i] += a.conj();\n    }\n  }\n}\n\nvoid NegaCyclicRealConvolution(double x[], double y[], int n, double z[]) {\n  Complex* X = static_cast<Complex*>(x);\n  Complex* Y = static_cast<Complex*>(y);\n  NegaRealDWT(X, n / 2, Forward);  // n \u500b\u306e\u5b9f\u6570 == n/2 \u500b\u306e\u8907\u7d20\u6570\n  NegaRealDWT(Y, n / 2, Forward);\n  for (int i = 0; i < n / 2; ++i)\n    Z[i] = X[i] * Y[i];\n  Complex* Z = static_cast<Complex*>(z);\n  NegaRealDWT(Z, n / 2, Backward);\n}\n```\n", "tags": ["math", "\u6570\u5b66", "FFT", "\u591a\u500d\u9577\u6574\u6570"]}