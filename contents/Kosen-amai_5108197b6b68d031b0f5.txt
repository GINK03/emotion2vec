{"context": "\n\n \u306f\u3058\u3081\u306b\nQiita\u3078\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u308b\u753b\u50cf\u30b5\u30a4\u30ba\u306b\u4e0a\u9650\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u4e0d\u5fc5\u8981\u306b\u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u306e\u753b\u50cf\u306f\u30da\u30fc\u30b8\u8868\u793a\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u753b\u50cf\u30b5\u30a4\u30ba\u306f\u3067\u304d\u308b\u3060\u3051\u5c0f\u3055\u304f\u3057\u307e\u3057\u3087\u3046\u3002\n\u307e\u305f\u3001\u753b\u50cf\u306e\u5e45\u30fb\u9ad8\u3055\u3092\u5c0f\u3055\u304f\u3059\u308b\u3053\u3068\u3067\u8a18\u4e8b\u306b\u4e00\u5ea6\u306b\u8868\u793a\u3067\u304d\u308b\u60c5\u5831\u91cf\u304c\u591a\u304f\u306a\u308a\u307e\u3059\u3002\n\u753b\u50cf\u306e\u90e8\u5206\u5207\u308a\u51fa\u3057\u3001\u7e2e\u5c0f\u3082\u691c\u8a0e\u3057\u307e\u3057\u3087\u3046\u3002\n\n \u65b9\u6cd51. \u6e1b\u8272\n\u753b\u50cf\u30c7\u30fc\u30bf\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u8272\u6570\u3092\u6e1b\u3089\u3059\u3053\u3068\u3067\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306e\u5bb9\u91cf\u3092\u6e1b\u3089\u3057\u307e\u3059\u3002\n\n \u30aa\u30f3\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u3067\u753b\u50cf\u3092\u6e1b\u8272\n\u3053\u3061\u3089\u306e\u30b5\u30a4\u30c8\u306bpng\u307e\u305f\u306fjpeg\u753b\u50cf\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3068\u6e1b\u8272\u3057\u305f\u753b\u50cf\u304c\u51fa\u6765\u4e0a\u304c\u308b\u306e\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3060\u3051\u3067\u3059\u3002\nTinyPNG \u2013 Compress PNG images while preserving transparency\n\u3053\u3061\u3089\u3067\u77e5\u308a\u307e\u3057\u305f\u3002\n\u753b\u50cf\u3092\u5727\u7e2e\u3057\u305f\u3044\u3068\u304d\u3001\u30aa\u30f3\u30e9\u30a4\u30f3\u304b\u3089\u5b9f\u884c\u3067\u304d\u308b\u30c4\u30fc\u30eb - Qiita\n\n \u65b9\u6cd52. \u30b5\u30a4\u30ba\u7e2e\u5c0f\n\u753b\u50cf\u306e\u30b5\u30a4\u30ba\uff08\u6a2a\u3007\u3007\u30d4\u30af\u30bb\u30eb\u00d7\u7e26\u3007\u3007\u30d4\u30af\u30bb\u30eb\uff09\u3092\u5c0f\u3055\u304f\u3059\u308b\u3053\u3068\u3067\u30d5\u30a1\u30a4\u30eb\u306e\u5bb9\u91cf\u3092\u6e1b\u3089\u3057\u307e\u3059\u3002\n\u753b\u50cf\u3092\u5c0f\u3055\u304f\u3059\u308b\u3053\u3068\u3067\u305d\u306e\u5206\u3001\u4e0b\u306e\u5185\u5bb9\u304c\u898b\u3048\u308b\u3088\u3046\u306b\u306a\u308b\u305f\u3081\u3001\u8a18\u4e8b\u306e\u898b\u901a\u3057\u304c\u826f\u304f\u306a\u308b\u52b9\u679c\u3082\u3042\u308a\u307e\u3059\u3002\n\n\n \u30aa\u30f3\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u3067\u753b\u50cf\u3092\u7e2e\u5c0f\n\u53c2\u7167\u30dc\u30bf\u30f3\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u7e2e\u5c0f\u3001\u305d\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n\u753b\u50cf\u3092\u7e2e\u5c0f\u3059\u308b\uff01\n\n \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u7e2e\u5c0f\n\u753b\u50cf\u30b5\u30a4\u30ba\u3092\u7e2e\u5c0f\u3059\u308bPowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f8b\u3002\n\u5f15\u6570\u7701\u7565\u6642\u306fGUI\u8868\u793a\u3002\n\nAdd-Type -AssemblyName System.Drawing\n\n<#\n.SYNOPSIS\n    JPEG\u753b\u50cf\u306e\u30b5\u30a4\u30ba\u3092\u7e2e\u5c0f\u3059\u308b\n\n.DESCRIPTION\n    JPEG\u753b\u50cf\u306e\u30b5\u30a4\u30ba\u3092\u5e45\u3092\u6307\u5b9a\u3057\u3066\u7e2e\u5c0f\u3059\u308b\u3002\n    \u7e2e\u5c0f\u5f8c\u306e\u753b\u50cf\u306f\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u65e5\u6642\u3092\u4ed8\u4e0e\u3057\u3066\u540c\u3058\u5834\u6240\u306b\u51fa\u529b\u3059\u308b\u3002\n\n.PARAMETER FilePath\n    JPEG\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3002\u7701\u7565\u6642\u306fGUI\u5165\u529b\u30e2\u30fc\u30c9\u3002\n\n.PARAMETER ShrinkFlg\n    \u7e2e\u5c0f\u30d5\u30e9\u30b0\u3002\u753b\u50cf\u306e\u5e45\u3092\u4f55\u30d4\u30af\u30bb\u30eb\u306b\u3059\u308b\u304b1\uff5e4\u306e\u6570\u5024\u3092\u6307\u5b9a\u3059\u308b\u3002\n    1: 320\n    2: 640(\u65e2\u5b9a)\n    3: 800\n    4:1024\n    \u753b\u50cf\u306e\u9ad8\u3055\u306f\u7e26\u6a2a\u6bd4\u3092\u7dad\u6301\u3057\u3066\u7e2e\u5c0f\u3002\n\n.EXAMPLE\n    ShrinkJpg .\\image.jpg 3\n    image.jpg\u306e\u5e45\u3092800\u306b\u7e2e\u5c0f\n\n.EXAMPLE\n    ShrinkJpg\n    GUI\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u3068\u753b\u50cf\u5e45\u3092\u5165\u529b\n#>\nfunction ShrinkJpg([string]$FilePath = \"\", [int]$ShrinkFlg = 2)\n{\n    [string]$Script:JpegSrcFilePath = $FilePath\n    [int]$Script:JpegShrinkFlg = $ShrinkFlg\n\n    if ($Script:JpegSrcFilePath)\n    {\n        # \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u5165\u529b\u3042\u308a\n    }\n    else\n    {\n        # \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u5165\u529b\u7121\u3057\u3001GUI\u3067\u5165\u529b\n        Add-Type -AssemblyName PresentationFramework\n\n        [xml]$xaml = @'\n<Window xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" Title=\"JPEG\u753b\u50cf\u3092\u7e2e\u5c0f\"\nHeight=\"300\" Width=\"600\">\n<Grid>\n    <Grid.RowDefinitions>\n        <RowDefinition Height=\"auto\"/>\n        <RowDefinition Height=\"*\"/>\n        <RowDefinition Height=\"auto\"/>\n    </Grid.RowDefinitions>\n    <Grid.ColumnDefinitions>\n        <ColumnDefinition Width=\"*\"/>\n        <ColumnDefinition Width=\"auto\"/>\n    </Grid.ColumnDefinitions>\n\n    <TextBox Name=\"filePath\" Text=\"\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u76f4\u63a5\u5165\u529b\u3001\u307e\u305f\u306f\u53c2\u7167\u30dc\u30bf\u30f3\u3067\u8a2d\u5b9a\" Margin=\"10,10,0,10\"/>\n    <Button Name=\"refButton\" Content=\"\u53c2\u7167...\" Grid.Column=\"1\" Margin=\"0,10,10,10\"/>\n\n    <GroupBox Grid.Row=\"1\" Grid.ColumnSpan=\"2\" Header=\"\u7e2e\u5c0f\u5f8c\u306e\u753b\u50cf\u306e\u5e45\" Margin=\"10\" Padding=\"10\">\n        <StackPanel Name=\"radioPanel\">\n            <RadioButton Content=\"1: 320\"/>\n            <RadioButton Content=\"2: 640\" IsChecked=\"True\"/>\n            <RadioButton Content=\"3: 800\"/>\n            <RadioButton Content=\"4: 1024\"/>\n        </StackPanel>\n    </GroupBox>\n\n    <Button Grid.Row=\"2\" Name=\"execButton\" Content=\"\u5b9f\u884c\" Width=\"150\" Height=\"40\" HorizontalAlignment=\"Left\" Margin=\"10\"/>\n</Grid>\n</Window>\n'@\n        $reader = (New-Object System.Xml.XmlNodeReader $xaml)\n        $window = [Windows.Markup.XamlReader]::Load($reader)\n\n        $file_path = $window.FindName(\"filePath\")\n        $ref_button = $window.FindName(\"refButton\")\n        $radio_panel = $window.FindName(\"radioPanel\")\n        $exec_button = $window.FindName(\"execButton\")\n\n        # \u53c2\u7167\u30dc\u30bf\u30f3\u306e\u51e6\u7406\n        $ref_button_clicked = $ref_button.add_Click\n        $ref_button_clicked.Invoke({\n            $dlg = New-Object Microsoft.Win32.OpenFileDialog\n            $dlg.Filter = \"jpeg\u30d5\u30a1\u30a4\u30eb |*.jpg;*.jpeg\"\n            $result = $dlg.ShowDialog()\n            if ($result -eq $true)\n            {\n                $file_path.Text = $dlg.FileName\n            }\n        })\n\n        # \u5b9f\u884c\u30dc\u30bf\u30f3\u306e\u51e6\u7406\n        $exec_button_clicked = $exec_button.add_Click\n        $exec_button_clicked.Invoke({\n            if ($file_path.Text -eq \"\")\n            {\n                [System.Windows.MessageBox]::Show(\"\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\") > $null\n                return\n            }\n\n            $Script:JpegSrcFilePath = $file_path.Text\n\n            $radio_panel.Children | ForEach-Object { \n                if ($_.IsChecked -eq $true)\n                {\n                    $Script:JpegShrinkFlg = [int]$_.Content.ToString().Substring(0, 1)\n                    $window.Close()\n                }\n            }\n            $window.Close()\n        })\n\n        $window.ShowDialog() > $null\n    }\n\n    if ($Script:JpegSrcFilePath)\n    {\n        if ((Test-Path $Script:JpegSrcFilePath) -eq $false)\n        {\n            Write-Error \"\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002`n[${Script:JpegSrcFilePath}]\"\n            return\n        }\n    }\n    else\n    {\n        Write-Host \"\u30d5\u30a1\u30a4\u30eb\u304c\u6307\u5b9a\u3055\u308c\u306a\u304b\u3063\u305f\u306e\u3067\u51e6\u7406\u3092\u4e2d\u6b62\u3057\u307e\u3059\u3002\"\n        return\n    }\n\n    $Script:JpegSrcFilePath = Convert-Path $Script:JpegSrcFilePath\n\n    # \u62e1\u5f35\u5b50\u78ba\u8a8d\n    [string]$ext = [System.IO.Path]::GetExtension($Script:JpegSrcFilePath)\n    if ($ext -ine \".jpg\" -and $ext -ine \".jpeg\")\n    {\n        Write-Error \"JPEG\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\"\n        return\n    }\n\n    $img = [System.Drawing.Image]::FromFile($Script:JpegSrcFilePath)\n\n    $encParams = New-Object System.Drawing.Imaging.EncoderParameters(1)\n    $encParams.Param[0] = New-Object System.Drawing.Imaging.EncoderParameter(\n        [System.Drawing.Imaging.Encoder]::Quality, 100)\n\n    [int]$shrinkWidth = $img.Width\n    [int]$shrinkHeight = $img.Height\n\n    switch ($Script:JpegShrinkFlg)\n    {\n        # \u7e2e\u5c0f\u5f8c\u306e\u6a2a\u5e45\n        1 { $shrinkWidth = 320 }\n        2 { $shrinkWidth = 640 }\n        3 { $shrinkWidth = 800 }\n        4 { $shrinkWidth = 1024 }\n        default { $shrinkWidth = 640 }\n    }\n\n    if ($img.Width -gt $shrinkWidth)\n    {\n        # \u7e2e\u5c0f\u5f8c\u306e\u9ad8\u3055\n        $shrinkHeight = $shrinkWidth / $img.Width * $img.Height\n    }\n    else\n    {\n        Write-Host \"\u65e2\u306b\u7e2e\u5c0f\u30b5\u30a4\u30ba\u4ee5\u4e0b\u3067\u3059\u3002\"\n        $img.Dispose()\n        return\n    }\n\n    [int]$w = $img.Width\n    [int]$h = $img.Height\n    Write-Host \"${w}\u00d7${h} \u2192 ${shrinkWidth}\u00d7${shrinkHeight}\" -ForegroundColor DarkGray\n\n    $resizeBmp = New-Object System.Drawing.Bitmap($shrinkWidth, $shrinkHeight)\n    $graph = [System.Drawing.Graphics]::FromImage($resizeBmp)\n    # \u88dc\u5b8c\u65b9\u6cd5\uff1a\u9ad8\u54c1\u8cea\u53cc\u4e09\u6b21\u88dc\u9593(https://msdn.microsoft.com/ja-jp/library/system.drawing.drawing2d.interpolationmode.aspx)\n    $graph.InterpolationMode = [System.Drawing.Drawing2D.InterpolationMode]::HighQualityBicubic\n\n    $graph.Clear([System.Drawing.Color]::White)\n    $graph.DrawImage($img, 0, 0, $shrinkWidth, $shrinkHeight)\n\n    # \u7e2e\u5c0f\u5f8c\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u4f5c\u6210\n    [string]$newBasePath = Split-Path -Parent $Script:JpegSrcFilePath\n    [string]$newFileName =\n        [System.IO.Path]::GetFileNameWithoutExtension($Script:JpegSrcFilePath) + \n        (Get-Date).ToString(\"_yyyyMMdd_HHmmssff\") +\n        $ext\n\n    $codec = [System.Drawing.Imaging.ImageCodecInfo]::GetImageEncoders() | \n        Where-Object {$_.MimeType -eq \"image/jpeg\"}\n    [string]$newFilePath = Join-Path $newBasePath $newFileName\n    $resizeBmp.Save($newFilePath, $codec, $($encParams))\n    $f = Get-ChildItem -LiteralPath $newFilePath\n    if ($f.Length -lt 100KB)\n    {\n        Write-Host \"${newFileName} \u3092\u51fa\u529b(\u7e2e\u5c0f\u5f8c\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u5c0f)\" -BackgroundColor Green -ForegroundColor Black\n    } \n    elseif ($f.Length -lt 300KB)\n    {\n        Write-Host \"${newFileName} \u3092\u51fa\u529b(\u7e2e\u5c0f\u5f8c\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u4e2d)\" -BackgroundColor Yellow -ForegroundColor Black\n    }\n    else\n    {\n        Write-Host \"${newFileName} \u3092\u51fa\u529b(\u7e2e\u5c0f\u5f8c\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u5927)\" -BackgroundColor Magenta -ForegroundColor Black\n    }\n\n    $resizeBmp.Dispose()\n    $img.Dispose()\n}\n\n# <i class=\"fa fa-cubes\" style=\"font-size:1em;\"></i> \u306f\u3058\u3081\u306b\nQiita\u3078\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u308b\u753b\u50cf\u30b5\u30a4\u30ba\u306b\u4e0a\u9650\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u4e0d\u5fc5\u8981\u306b\u5927\u304d\u306a\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u306e\u753b\u50cf\u306f\u30da\u30fc\u30b8\u8868\u793a\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u753b\u50cf\u30b5\u30a4\u30ba\u306f\u3067\u304d\u308b\u3060\u3051\u5c0f\u3055\u304f\u3057\u307e\u3057\u3087\u3046\u3002\n\u307e\u305f\u3001\u753b\u50cf\u306e\u5e45\u30fb\u9ad8\u3055\u3092\u5c0f\u3055\u304f\u3059\u308b\u3053\u3068\u3067\u8a18\u4e8b\u306b\u4e00\u5ea6\u306b\u8868\u793a\u3067\u304d\u308b\u60c5\u5831\u91cf\u304c\u591a\u304f\u306a\u308a\u307e\u3059\u3002\n\u753b\u50cf\u306e\u90e8\u5206\u5207\u308a\u51fa\u3057\u3001\u7e2e\u5c0f\u3082\u691c\u8a0e\u3057\u307e\u3057\u3087\u3046\u3002\n\n# <i class=\"fa fa-cubes\" style=\"font-size:1em;\"></i> \u65b9\u6cd51. \u6e1b\u8272\n\u753b\u50cf\u30c7\u30fc\u30bf\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u8272\u6570\u3092\u6e1b\u3089\u3059\u3053\u3068\u3067\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306e\u5bb9\u91cf\u3092\u6e1b\u3089\u3057\u307e\u3059\u3002\n\n## <i class=\"fa fa-cube\" style=\"font-size:1em;\"></i> \u30aa\u30f3\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u3067\u753b\u50cf\u3092\u6e1b\u8272\n\n\u3053\u3061\u3089\u306e\u30b5\u30a4\u30c8\u306bpng\u307e\u305f\u306fjpeg\u753b\u50cf\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3068\u6e1b\u8272\u3057\u305f\u753b\u50cf\u304c\u51fa\u6765\u4e0a\u304c\u308b\u306e\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n[TinyPNG \u2013 Compress PNG images while preserving transparency](https://tinypng.com/)\n\n\u3053\u3061\u3089\u3067\u77e5\u308a\u307e\u3057\u305f\u3002\n[\u753b\u50cf\u3092\u5727\u7e2e\u3057\u305f\u3044\u3068\u304d\u3001\u30aa\u30f3\u30e9\u30a4\u30f3\u304b\u3089\u5b9f\u884c\u3067\u304d\u308b\u30c4\u30fc\u30eb - Qiita](http://qiita.com/NEPPIE/items/beb303cfc8c7bba156b7)\n\n\n# <i class=\"fa fa-cubes\" style=\"font-size:1em;\"></i> \u65b9\u6cd52. \u30b5\u30a4\u30ba\u7e2e\u5c0f\n\u753b\u50cf\u306e\u30b5\u30a4\u30ba\uff08\u6a2a\u3007\u3007\u30d4\u30af\u30bb\u30eb\u00d7\u7e26\u3007\u3007\u30d4\u30af\u30bb\u30eb\uff09\u3092\u5c0f\u3055\u304f\u3059\u308b\u3053\u3068\u3067\u30d5\u30a1\u30a4\u30eb\u306e\u5bb9\u91cf\u3092\u6e1b\u3089\u3057\u307e\u3059\u3002\n\u753b\u50cf\u3092\u5c0f\u3055\u304f\u3059\u308b\u3053\u3068\u3067\u305d\u306e\u5206\u3001\u4e0b\u306e\u5185\u5bb9\u304c\u898b\u3048\u308b\u3088\u3046\u306b\u306a\u308b\u305f\u3081\u3001\u8a18\u4e8b\u306e\u898b\u901a\u3057\u304c\u826f\u304f\u306a\u308b\u52b9\u679c\u3082\u3042\u308a\u307e\u3059\u3002\n\n![p02.png](https://qiita-image-store.s3.amazonaws.com/0/142879/0c3a032c-8f3e-da90-f96f-675e15372c79.png)\n\n\n## <i class=\"fa fa-cube\" style=\"font-size:1em;\"></i> \u30aa\u30f3\u30e9\u30a4\u30f3\u30c4\u30fc\u30eb\u3067\u753b\u50cf\u3092\u7e2e\u5c0f\n\u53c2\u7167\u30dc\u30bf\u30f3\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u7e2e\u5c0f\u3001\u305d\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n[\u753b\u50cf\u3092\u7e2e\u5c0f\u3059\u308b\uff01](http://resizer.myct.jp/index.php)\n\n## <i class=\"fa fa-cube\" style=\"font-size:1em;\"></i> \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u7e2e\u5c0f\n\u753b\u50cf\u30b5\u30a4\u30ba\u3092\u7e2e\u5c0f\u3059\u308bPowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4f8b\u3002\n\u5f15\u6570\u7701\u7565\u6642\u306fGUI\u8868\u793a\u3002\n\n![q01.PNG](https://qiita-image-store.s3.amazonaws.com/0/142879/ec31f418-9d55-ff36-f6e8-557d4ccf3f04.png)\n\n```PowerShell\nAdd-Type -AssemblyName System.Drawing\n\n<#\n.SYNOPSIS\n    JPEG\u753b\u50cf\u306e\u30b5\u30a4\u30ba\u3092\u7e2e\u5c0f\u3059\u308b\n\n.DESCRIPTION\n    JPEG\u753b\u50cf\u306e\u30b5\u30a4\u30ba\u3092\u5e45\u3092\u6307\u5b9a\u3057\u3066\u7e2e\u5c0f\u3059\u308b\u3002\n    \u7e2e\u5c0f\u5f8c\u306e\u753b\u50cf\u306f\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u65e5\u6642\u3092\u4ed8\u4e0e\u3057\u3066\u540c\u3058\u5834\u6240\u306b\u51fa\u529b\u3059\u308b\u3002\n\n.PARAMETER FilePath\n    JPEG\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3002\u7701\u7565\u6642\u306fGUI\u5165\u529b\u30e2\u30fc\u30c9\u3002\n\n.PARAMETER ShrinkFlg\n    \u7e2e\u5c0f\u30d5\u30e9\u30b0\u3002\u753b\u50cf\u306e\u5e45\u3092\u4f55\u30d4\u30af\u30bb\u30eb\u306b\u3059\u308b\u304b1\uff5e4\u306e\u6570\u5024\u3092\u6307\u5b9a\u3059\u308b\u3002\n    1: 320\n    2: 640(\u65e2\u5b9a)\n    3: 800\n    4:1024\n    \u753b\u50cf\u306e\u9ad8\u3055\u306f\u7e26\u6a2a\u6bd4\u3092\u7dad\u6301\u3057\u3066\u7e2e\u5c0f\u3002\n\n.EXAMPLE\n    ShrinkJpg .\\image.jpg 3\n    image.jpg\u306e\u5e45\u3092800\u306b\u7e2e\u5c0f\n\n.EXAMPLE\n    ShrinkJpg\n    GUI\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u3068\u753b\u50cf\u5e45\u3092\u5165\u529b\n#>\nfunction ShrinkJpg([string]$FilePath = \"\", [int]$ShrinkFlg = 2)\n{\n    [string]$Script:JpegSrcFilePath = $FilePath\n    [int]$Script:JpegShrinkFlg = $ShrinkFlg\n    \n    if ($Script:JpegSrcFilePath)\n    {\n        # \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u5165\u529b\u3042\u308a\n    }\n    else\n    {\n        # \u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u5165\u529b\u7121\u3057\u3001GUI\u3067\u5165\u529b\n        Add-Type -AssemblyName PresentationFramework\n\n        [xml]$xaml = @'\n<Window xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" \nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" Title=\"JPEG\u753b\u50cf\u3092\u7e2e\u5c0f\"\nHeight=\"300\" Width=\"600\">\n<Grid>\n    <Grid.RowDefinitions>\n        <RowDefinition Height=\"auto\"/>\n        <RowDefinition Height=\"*\"/>\n        <RowDefinition Height=\"auto\"/>\n    </Grid.RowDefinitions>\n    <Grid.ColumnDefinitions>\n        <ColumnDefinition Width=\"*\"/>\n        <ColumnDefinition Width=\"auto\"/>\n    </Grid.ColumnDefinitions>\n\n    <TextBox Name=\"filePath\" Text=\"\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u76f4\u63a5\u5165\u529b\u3001\u307e\u305f\u306f\u53c2\u7167\u30dc\u30bf\u30f3\u3067\u8a2d\u5b9a\" Margin=\"10,10,0,10\"/>\n    <Button Name=\"refButton\" Content=\"\u53c2\u7167...\" Grid.Column=\"1\" Margin=\"0,10,10,10\"/>\n\n    <GroupBox Grid.Row=\"1\" Grid.ColumnSpan=\"2\" Header=\"\u7e2e\u5c0f\u5f8c\u306e\u753b\u50cf\u306e\u5e45\" Margin=\"10\" Padding=\"10\">\n        <StackPanel Name=\"radioPanel\">\n            <RadioButton Content=\"1: 320\"/>\n            <RadioButton Content=\"2: 640\" IsChecked=\"True\"/>\n            <RadioButton Content=\"3: 800\"/>\n            <RadioButton Content=\"4: 1024\"/>\n        </StackPanel>\n    </GroupBox>\n\n    <Button Grid.Row=\"2\" Name=\"execButton\" Content=\"\u5b9f\u884c\" Width=\"150\" Height=\"40\" HorizontalAlignment=\"Left\" Margin=\"10\"/>\n</Grid>\n</Window>\n'@\n        $reader = (New-Object System.Xml.XmlNodeReader $xaml)\n        $window = [Windows.Markup.XamlReader]::Load($reader)\n\n        $file_path = $window.FindName(\"filePath\")\n        $ref_button = $window.FindName(\"refButton\")\n        $radio_panel = $window.FindName(\"radioPanel\")\n        $exec_button = $window.FindName(\"execButton\")\n\n        # \u53c2\u7167\u30dc\u30bf\u30f3\u306e\u51e6\u7406\n        $ref_button_clicked = $ref_button.add_Click\n        $ref_button_clicked.Invoke({\n            $dlg = New-Object Microsoft.Win32.OpenFileDialog\n            $dlg.Filter = \"jpeg\u30d5\u30a1\u30a4\u30eb |*.jpg;*.jpeg\"\n            $result = $dlg.ShowDialog()\n            if ($result -eq $true)\n            {\n                $file_path.Text = $dlg.FileName\n            }\n        })\n\n        # \u5b9f\u884c\u30dc\u30bf\u30f3\u306e\u51e6\u7406\n        $exec_button_clicked = $exec_button.add_Click\n        $exec_button_clicked.Invoke({\n            if ($file_path.Text -eq \"\")\n            {\n                [System.Windows.MessageBox]::Show(\"\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\") > $null\n                return\n            }\n\n            $Script:JpegSrcFilePath = $file_path.Text\n\n            $radio_panel.Children | ForEach-Object { \n                if ($_.IsChecked -eq $true)\n                {\n                    $Script:JpegShrinkFlg = [int]$_.Content.ToString().Substring(0, 1)\n                    $window.Close()\n                }\n            }\n            $window.Close()\n        })\n\n        $window.ShowDialog() > $null\n    }\n\n    if ($Script:JpegSrcFilePath)\n    {\n        if ((Test-Path $Script:JpegSrcFilePath) -eq $false)\n        {\n            Write-Error \"\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002`n[${Script:JpegSrcFilePath}]\"\n            return\n        }\n    }\n    else\n    {\n        Write-Host \"\u30d5\u30a1\u30a4\u30eb\u304c\u6307\u5b9a\u3055\u308c\u306a\u304b\u3063\u305f\u306e\u3067\u51e6\u7406\u3092\u4e2d\u6b62\u3057\u307e\u3059\u3002\"\n        return\n    }\n    \n    $Script:JpegSrcFilePath = Convert-Path $Script:JpegSrcFilePath\n\n    # \u62e1\u5f35\u5b50\u78ba\u8a8d\n    [string]$ext = [System.IO.Path]::GetExtension($Script:JpegSrcFilePath)\n    if ($ext -ine \".jpg\" -and $ext -ine \".jpeg\")\n    {\n        Write-Error \"JPEG\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\"\n        return\n    }\n\n    $img = [System.Drawing.Image]::FromFile($Script:JpegSrcFilePath)\n\n    $encParams = New-Object System.Drawing.Imaging.EncoderParameters(1)\n    $encParams.Param[0] = New-Object System.Drawing.Imaging.EncoderParameter(\n        [System.Drawing.Imaging.Encoder]::Quality, 100)\n\n    [int]$shrinkWidth = $img.Width\n    [int]$shrinkHeight = $img.Height\n\n    switch ($Script:JpegShrinkFlg)\n    {\n        # \u7e2e\u5c0f\u5f8c\u306e\u6a2a\u5e45\n        1 { $shrinkWidth = 320 }\n        2 { $shrinkWidth = 640 }\n        3 { $shrinkWidth = 800 }\n        4 { $shrinkWidth = 1024 }\n        default { $shrinkWidth = 640 }\n    }\n    \n    if ($img.Width -gt $shrinkWidth)\n    {\n        # \u7e2e\u5c0f\u5f8c\u306e\u9ad8\u3055\n        $shrinkHeight = $shrinkWidth / $img.Width * $img.Height\n    }\n    else\n    {\n        Write-Host \"\u65e2\u306b\u7e2e\u5c0f\u30b5\u30a4\u30ba\u4ee5\u4e0b\u3067\u3059\u3002\"\n        $img.Dispose()\n        return\n    }\n\n    [int]$w = $img.Width\n    [int]$h = $img.Height\n    Write-Host \"${w}\u00d7${h} \u2192 ${shrinkWidth}\u00d7${shrinkHeight}\" -ForegroundColor DarkGray\n\n    $resizeBmp = New-Object System.Drawing.Bitmap($shrinkWidth, $shrinkHeight)\n    $graph = [System.Drawing.Graphics]::FromImage($resizeBmp)\n    # \u88dc\u5b8c\u65b9\u6cd5\uff1a\u9ad8\u54c1\u8cea\u53cc\u4e09\u6b21\u88dc\u9593(https://msdn.microsoft.com/ja-jp/library/system.drawing.drawing2d.interpolationmode.aspx)\n    $graph.InterpolationMode = [System.Drawing.Drawing2D.InterpolationMode]::HighQualityBicubic\n\n    $graph.Clear([System.Drawing.Color]::White)\n    $graph.DrawImage($img, 0, 0, $shrinkWidth, $shrinkHeight)\n\n    # \u7e2e\u5c0f\u5f8c\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u4f5c\u6210\n    [string]$newBasePath = Split-Path -Parent $Script:JpegSrcFilePath\n    [string]$newFileName =\n        [System.IO.Path]::GetFileNameWithoutExtension($Script:JpegSrcFilePath) + \n        (Get-Date).ToString(\"_yyyyMMdd_HHmmssff\") +\n        $ext\n\n    $codec = [System.Drawing.Imaging.ImageCodecInfo]::GetImageEncoders() | \n        Where-Object {$_.MimeType -eq \"image/jpeg\"}\n    [string]$newFilePath = Join-Path $newBasePath $newFileName\n    $resizeBmp.Save($newFilePath, $codec, $($encParams))\n    $f = Get-ChildItem -LiteralPath $newFilePath\n    if ($f.Length -lt 100KB)\n    {\n        Write-Host \"${newFileName} \u3092\u51fa\u529b(\u7e2e\u5c0f\u5f8c\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u5c0f)\" -BackgroundColor Green -ForegroundColor Black\n    } \n    elseif ($f.Length -lt 300KB)\n    {\n        Write-Host \"${newFileName} \u3092\u51fa\u529b(\u7e2e\u5c0f\u5f8c\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u4e2d)\" -BackgroundColor Yellow -ForegroundColor Black\n    }\n    else\n    {\n        Write-Host \"${newFileName} \u3092\u51fa\u529b(\u7e2e\u5c0f\u5f8c\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u5927)\" -BackgroundColor Magenta -ForegroundColor Black\n    }\n    \n    $resizeBmp.Dispose()\n    $img.Dispose()\n}\n```\n\n", "tags": ["Qiita", "\u753b\u50cf", "\u521d\u5fc3\u8005", "\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9", "PowerShell"]}