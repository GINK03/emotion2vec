{"context": " More than 1 year has passed since last update.\nxysort.fs\nlet table = [ [4;1;4;2;1;3];\n              [7;3;2;0;5;0];\n              [2;3;6;0;6;7];\n              [6;4;5;7;5;1];\n              [3;1;6;6;2;4];\n              [6;0;5;5;5;1] ]\n\nlet byRow i xss =\n  let map = List.nth xss i\n            |> List.mapi (fun i e -> (i,e))\n            |> List.sortBy (fun (i,e) -> e)\n  let indexMap i = List.findIndex (fun (i',e) -> i = i') map\n  let sorter = List.permute indexMap\n  List.map sorter xss\n\nlet byColumn i xss =\n  List.sortBy (fun xs -> List.nth xs i) xss\n\nlet action xss (c: char) =\n  match (\"ABCDEF\".IndexOf c, \"uvwxyz\".IndexOf c) with\n  | (r, _) when r >= 0 -> byRow r xss\n  | (_, c) when c >= 0 -> byColumn c xss\n  | _                  -> xss\n\nlet solve (s:string) =\n  s.ToCharArray()\n  |> Array.fold action table\n  |> List.head\n  |> System.String.Concat\n\n(* for test *)\n\ntype TestResult = Success | Failure\n\nlet test target expected =\n  let actual = solve target\n  printfn \"%A\" (if expected = actual then Success else Failure)\n\n[<EntryPoint>]\nlet main args =\n  test \"AvEx\" \"305027\"\n  test \"A\" \"112344\"\n  test \"C\" \"241413\"\n  test \"F\" \"134214\"\n  test \"u\" \"236067\"\n  test \"w\" \"732050\"\n  test \"y\" \"414213\"\n  test \"yx\" \"732050\"\n  test \"ux\" \"236067\"\n  test \"EF\" \"131424\"\n  test \"DF\" \"134124\"\n  test \"Au\" \"055165\"\n  test \"uA\" \"023667\"\n  test \"By\" \"234114\"\n  test \"yB\" \"114342\"\n  test \"yBy\" \"357020\"\n  test \"yByB\" \"350072\"\n  test \"AuBvCw\" \"131244\"\n  test \"FAuFBvFCw\" \"300527\"\n  test \"AuBv\" \"112344\"\n  test \"CwDx\" \"515056\"\n  test \"FzyE\" \"324114\"\n  test \"uAwDyB\" \"114324\"\n  test \"zExCvF\" \"073520\"\n  test \"uFxEv\" \"002357\"\n  test \"DyCwB\" \"076362\"\n  0\n\n\n```fsharp:xysort.fs\nlet table = [ [4;1;4;2;1;3];\n              [7;3;2;0;5;0];\n              [2;3;6;0;6;7];\n              [6;4;5;7;5;1];\n              [3;1;6;6;2;4];\n              [6;0;5;5;5;1] ]\n\nlet byRow i xss =\n  let map = List.nth xss i\n            |> List.mapi (fun i e -> (i,e))\n            |> List.sortBy (fun (i,e) -> e)\n  let indexMap i = List.findIndex (fun (i',e) -> i = i') map\n  let sorter = List.permute indexMap\n  List.map sorter xss\n\nlet byColumn i xss =\n  List.sortBy (fun xs -> List.nth xs i) xss\n\nlet action xss (c: char) =\n  match (\"ABCDEF\".IndexOf c, \"uvwxyz\".IndexOf c) with\n  | (r, _) when r >= 0 -> byRow r xss\n  | (_, c) when c >= 0 -> byColumn c xss\n  | _                  -> xss\n\nlet solve (s:string) =\n  s.ToCharArray()\n  |> Array.fold action table\n  |> List.head\n  |> System.String.Concat\n\n(* for test *)\n\ntype TestResult = Success | Failure\n\nlet test target expected =\n  let actual = solve target\n  printfn \"%A\" (if expected = actual then Success else Failure)\n\n[<EntryPoint>]\nlet main args =\n  test \"AvEx\" \"305027\"\n  test \"A\" \"112344\"\n  test \"C\" \"241413\"\n  test \"F\" \"134214\"\n  test \"u\" \"236067\"\n  test \"w\" \"732050\"\n  test \"y\" \"414213\"\n  test \"yx\" \"732050\"\n  test \"ux\" \"236067\"\n  test \"EF\" \"131424\"\n  test \"DF\" \"134124\"\n  test \"Au\" \"055165\"\n  test \"uA\" \"023667\"\n  test \"By\" \"234114\"\n  test \"yB\" \"114342\"\n  test \"yBy\" \"357020\"\n  test \"yByB\" \"350072\"\n  test \"AuBvCw\" \"131244\"\n  test \"FAuFBvFCw\" \"300527\"\n  test \"AuBv\" \"112344\"\n  test \"CwDx\" \"515056\"\n  test \"FzyE\" \"324114\"\n  test \"uAwDyB\" \"114324\"\n  test \"zExCvF\" \"073520\"\n  test \"uFxEv\" \"002357\"\n  test \"DyCwB\" \"076362\"\n  0\n```", "tags": ["F#", "\u3069\u3046\u66f8\u304f", "yhpg"]}