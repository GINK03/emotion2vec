{"context": "\n\n\u52d5\u6a5f\n\n\u958b\u767a\u74b0\u5883\u3092\u6574\u3048\u308b\u74b0\u5883\u3092\u6700\u65b0\u306b\u3059\u308b\n\u3044\u3044\u304b\u3052\u3093\u306bDocker\u3092\u89e6\u308b\n\n\n\u6d41\u308c\n\nMac\u306a\u306e\u3067Docker\u306e\u305f\u3081\u306eVM\u3092\u7acb\u3061\u4e0a\u3052\u308b\n\n\nVagrant\u3067VM\u7acb\u3061\u4e0a\u3052\u308b(Ubuntu: \u4eca\u307e\u3067Redhat\u7cfb\u3060\u3063\u305f\u306e\u3067\u89e6\u3063\u3066\u307f\u308b)\nVagrant\u306e\u305f\u3081\u306eVirtualBox\u30925\u306bUpdate\n\n\nDocker\u3068Docker\u306e\u30b3\u30f3\u30c6\u30ca\u4ee5\u5916\u306e\u6e96\u5099\u306e\u305f\u3081\u306eAnsible\u6e96\u5099\n\n\n\u4eca\u56de\u306fvagrant\u306eprovisioning, bootstrap.sh\u3067\u5bfe\u5fdc\n\n\nplaybook\u306e\u8a18\u8ff0\n\n\n\u30b3\u30f3\u30c6\u30ca\u3092Serverspec\u3067\u30c6\u30b9\u30c8\u3059\u308b\u306e\u3067ruby+serverspec\u3082\n\n\nDockerFile\u306e\u8a18\u8ff0\n\n\n\u3053\u3063\u3061\u3067install serverspec + \u03b1 and test\n\n\n\n\u3044\u308d\u3044\u308d\u3081\u3093\u3069\u3046\u3060\u3063\u305f\u306e\u3067\u3001\u6d41\u308c\u304c\u5909\n\nvirtualbox\n\nhttps://www.virtualbox.org/wiki/Downloads\n5.0.20\n\n\nvagrant\nhttps://www.vagrantup.com/docs/\n\ninstall\n\ninstaller\nhttps://www.vagrantup.com/downloads.html\nVagrant 1.8.1\n\n\nVM\n\n\nhttps://atlas.hashicorp.com/boxes/search\n\nubuntu 0.14.0\u307e\u3067\u3057\u304b\u306a\u304b\u3063\u305f\n\n\n\nhttp://www.vagrantbox.es/ -> \u53e4\u3044\n\nhttp://opscode.github.io/bento/ -> \u6d88\u3048\u3066\u305f\n\n\n\nhttp://chef.github.io/bento/ \u306b\u79fb\u3063\u3066\u305f\n\nhttps://atlas.hashicorp.com/bento/ bento/ubuntu-16.04 \u3042\u3063\u305f\n\n\n\n\ndonwload and settings\n\nvagrant-vm-setup.sh\nmdkir ~/programming/vagrant/ubuntu && $_\nvagrant box add bento/ubuntu-16.04\nvagrant init bento/ubuntu-16.04\nvagrant up\nvagrant ssh\n\n# or\nvagrant ssh-config --host ubuntu1604 >> ~/.ssh/config\nssh ubuntu1604\n\n# host os\ntouch synced_folder_test\n# guest os\nls /vagrant/synced_folder_test\n# https://www.vagrantup.com/docs/synced-folders/basic_usage.html\n\n\n\nvagrant-bootstrap.sh\n#!/usr/bin/env bash\n\nsudo apt-get update\nsudo apt-get install -y vim\nsudo apt-get install -y git\nwget -q -O- https://bootstrap.pypa.io/get-pip.py | sudo python\nsudo apt-get install -y ansible\n# or sudo apt-get install -y python-dev\n# and sudo pip install ansible\n\n\n\nVagrantfile-provisioning\nVagrant.configure(\"2\") do |config|\n  config.vm.box = \"bento/ubuntu-16.04\"\n  config.vm.provision :shell, path: \"bootstrap.sh\"\nend\n\n# then vagrant halt && vagrant up --provision\n# or vagrant reload --provision\n# https://www.vagrantup.com/docs/provisioning/\n\n\n\nansible\n\npython\u88fdssh\u7d4c\u7531\u3067provisioning(default)\npython2.7\u3067\u3082\u52d5\u3044\u305f\nansible2\u7cfb\u304c\u51fa\u3066\u308b\u3002\u9a12\u304c\u308c\u3066\u306a\u304b\u3063\u305f\u304b\u3089breaking changes\u306f\u5c11\u306a\u3055\u305d\u3046\n\n\ncommands\n\nansible\nansible-playbook\ndoc, galaxy, pull, vault\u3068\u306f\uff1f\n\n\nansible command\n\nplaybook\u3092\u4f7f\u308f\u306a\u3044\nhost\u306e\u6307\u5b9a\u304c\u5fc5\u8981(port\u4ed8\u304d\u3067\u3082\u826f\u3044)\n\n\ninventory\n\nhttp://docs.ansible.com/ansible/intro_inventory.html\ndefault=/etc/ansible/hosts\n-i hostfilepath\nhost\u306fgroup\u5316\u3067\u304d\u308b\n\n\nansible_example.sh\ncat <<EOF > ansible_hosts\n[local]\nlocalhost ansible_connection=local\nEOF\n\nansible local -i ansible_hosts -m ping\nansible all   -i ansible_hosts -m shell -a \"echo ansible shell module\"\n\n\n\nansible-playbook\n\nplaybook\u3092\u4f7f\u3046\u3068\u304d\n\n\nplaybook-example.yml\n---\n- hosts: 127.0.0.1\n  tasks:\n    - name: ping\n      ping:\n\n- hosts: local\n  tasks:\n    - name: shell\n      shell: \"echo $item\"\n      with_items:\n        - ansible\n        - playbook\n\n# command\n# ansible-playbook -i ansible_hosts playbook-example.yml\n\n\n\ninstall docker on ubuntu\n\nhttps://docs.docker.com/engine/installation/linux/ubuntulinux/\n\u8a2d\u5b9a\u304c\u601d\u3063\u3066\u3044\u305f\u3088\u308a\u3081\u3093\u3069\u3046\u3060\u3063\u305f\u306e\u3067\u3001ansible-playbook\u3084\u3081\u3066bootstrap.sh\u306b\u8ffd\u52a0\u3057\u305f\n\n\ndocker_install_for_ubuntu.sh\nsudo apt-get install -y apt-transport-https ca-certificates\nsudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D\necho \"deb https://apt.dockerproject.org/repo ubuntu-xenial main\" \\\n   > /etc/apt/sources.list.d/docker.list\nsudo apt-get update\nsudo apt-get purge lxc-docker\n\nsudo apt-get install -y linux-image-extra-$(uname -r)\nsudo apt-get install -y docker.io\nsudo apt-get install -y docker-engine\nsudo service docker start\n\nsudo groupadd docker\nsudo usermod -aG docker vagrant\ndocker run hello-world # without sudo\n\n\n\ndocker ecosystem\n\nbrew serach\u3067\u898b\u3064\u304b\u3063\u305f\u3082\u306e\n\nboot2docker\ndocker-machine\n\n\nAutomate Docker provisioning\ncreate VM\n\n\ndocker\n\n\nclient\n\n\ndocker-compose\n\n\nfor multi-container application\n\n\ndocker-swarm\n\n\nnative clustering capabilities to turn a group of Docker engines into a single, virtual Docker Engine.\n\n\n\n\ndocker toolbox\nhttps://www.docker.com/products/docker-toolbox, docker\u95a2\u9023\u3044\u308d\u3044\u308d\n\nDocker Engine\n\n\nDocker Engine runs on Linux to create the operating environment\n\n\nCompose\nMachine\nKitematic\n\n\nGUI\n\n\n\n\u306a\u3093\u306e\u305f\u3081\u306bubuntu\u7528\u610f\u3057\u305f\u3093\u3060\u2026\n\ninstall\u3057\u3066\u4f7f\u3063\u3066\u307f\u305f\n\ninstall\u6642\u306b\u8a2d\u5b9a\u3092\u884c\u3046shell script\u3092\u5b9f\u884c\u3055\u308c\u305f\n\n\n/.docker/machine/machines/default/boot2docker.iso\nVM/SSH\u7b49\u306e\u8a2d\u5b9a\nVM\u306fVirtualBox\u4e0a\u3067\u306fdefault\u3068\u3044\u3046\u540d\u524d\u306e\u30e1\u30e2\u30ea2G\n\n\n\ndocker run hello-world \u554f\u984c\u306a\u3057\n\u4e0a\u8a18\u5b9f\u884c\u7d42\u4e86\u6642\u306b\u52e7\u3081\u3089\u308c\u305f docker run -it ubuntu bash \u554f\u984c\u306a\u3057\n\n\nuname -a\nLinux 87631664c41b 4.4.8-boot2docker #1 SMP Mon Apr 25 21:57:27 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n\n\nubuntu\u3092centos\u306b\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u3066\u3082\u554f\u984c\u306a\u3057\n\n\nuname\u306e\u7d50\u679c\u306f\u540c\u3058\nubuntu\u3067\u306fpython\u306a\u304b\u3063\u305f\u304c\u3001centos\u3067\u306f\u3042\u3063\u305f\u306e\u3067\u4e2d\u8eab\u306f\u9055\u3046\n\n\niterm\u306b\u3057\u305f\u3068\u601d\u3046\u3093\u3060\u3051\u3069\u3001kitematic\u306eDOCKER CLI\u3067terminal\u304c\u7acb\u3061\u4e0a\u304c\u3089\u306a\u3044\n\n\n\u306a\u306e\u3067\u3001\u4e0b\u8a18\u3092iterm\u3067\u5b9f\u884c\u3059\u308b\nbash -c \"DOCKER_HOST=tcp://192.168.99.100:2376 DOCKER_CERT_PATH=~/.docker/machine/machines/default DOCKER_TLS_VERIFY=1 /bin/zsh\"\nshell\u7acb\u3061\u4e0a\u3052\u6642\u306b\u4ed6\u306e\u8a2d\u5b9a\u3092\u3059\u308b\u306e\u304b\u3001\u74b0\u5883\u5909\u6570\u3092\u305f\u3060\u8a2d\u5b9a\u3059\u308b\u3060\u3051\u3067\u306f\u30c0\u30e1\u3060\u3063\u305f\n\n\n\n\ndocker for mac/windows\nhttps://blog.docker.com/2016/03/docker-for-mac-windows-beta/\n\nDocker for Mac can be used at the same time as Docker Toolbox on the same machine, allowing developers to continue using Toolbox as they evaluate Docker for Mac. \n\n\nbeta\u306a\u306e\u3067docker ID\u3092\u767b\u9332\u3057\u3066\u304b\u3089\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308b\n\u4e0b\u8a18\u3001\u4f7f\u7528\u4f8b\u3002toolbox\u3068\u6bd4\u3079\u308b\u3068\u4fbf\u5229\u305d\u3046\nhttp://paiza.hatenablog.com/entry/docker_for_mac\n\n\n\u305d\u306e\u4ed6docker\u95a2\u9023\n\ncloud/hub\u306fdocker\u793e\u306eProduct\nbeta\u306e\u3068\u304d\u306b\u767b\u9332\u3059\u308bdocker ID\u306fhub\u30c9\u30e1\u30a4\u30f3\u3067\u4f5c\u308b\nnotary(https://docs.docker.com/notary/getting_started/)\n\n\nDockerfile\n# command: docker build -t docker-example:0.0.1 /vagrant/\n\n# Pull base image.\nFROM ubuntu:16.04\n\nMAINTAINER ksomemo\n\n# Install.\nRUN \\\n  sed -i 's/# \\(.*multiverse$\\)/\\1/g' /etc/apt/sources.list && \\\n  apt-get update && \\\n  apt-get -y upgrade && \\\n  apt-get install -y build-essential && \\\n  apt-get install -y software-properties-common && \\\n  apt-get install -y byobu curl git htop man unzip vim wget && \\\n  rm -rf /var/lib/apt/lists/*\n\n# Ruby dependencies\nRUN \\\n  apt-get update && \\\n  apt-get install -y \\\n    git tar gcc openssl \\\n    libssl-dev zlib1g-dev libyaml-dev \\\n    libreadline-dev libffi-dev libxml2-dev libxslt-dev\n\n# Ruby\nRUN git clone https://github.com/rbenv/ruby-build.git\nRUN ./ruby-build/install.sh\nRUN  ruby-build 2.3.1 /usr/local\n  #apt-get update && \\\n  #apt-get install -y ruby2.3 ruby2.3-dev\n\n# Install Nginx.\nRUN \\\n  add-apt-repository -y ppa:nginx/stable && \\\n  apt-get update && \\\n  apt-get install -y nginx && \\\n  rm -rf /var/lib/apt/lists/* && \\\n  #echo \"\\ndaemon off;\" >> /etc/nginx/nginx.conf && \\\n  chown -R www-data:www-data /var/lib/nginx\n\n# serverspec\n# Add files.\nADD .gemrc ~/.gemrc\nADD Gemfile Gemfile\n\nRUN gem update --system\nRUN gem install bundler\nRUN bundle install\n\n# Set environment variables.\nENV HOME /root\n\n# Define mountable directories.\nVOLUME [\"/etc/nginx/sites-enabled\", \"/etc/nginx/certs\", \"/etc/nginx/conf.d\", \"/var/log/nginx\", \"/var/www/html\"]\n\n# Define working directory.\nWORKDIR /etc/nginx\n\n# Expose ports.\nEXPOSE 80\nEXPOSE 443\n\n# Define default command.\nCMD [\"bash\"]\"\n\n\naaa\nhttps://docs.docker.com/engine/reference/builder\n\u53c2\u8003\u30d5\u30a1\u30a4\u30eb\n\n\nhttps://github.com/dockerfile/nginx/blob/master/Dockerfile\nhttps://github.com/dockerfile/ubuntu/blob/master/Dockerfile\n\n\nFROM \u3067base\u3068\u306a\u308bDockerfile\u3092\u6307\u5b9a\u3067\u304d\u308b\n\n\nnginx\u306f dockerfile/ubuntu\nubuntu\u306f ubuntu:14.04\n\u4e0a\u8a18\u306f https://hub.docker.com/r/library/ubuntu/ \u306e14.04\u306e\u3053\u3068\n\u4e0a\u8a18\u306f FROM scratch\n\n\napt-get update \u3092\u983b\u7e41\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\uff1f\n\n\n\u4e00\u756a\u6700\u521d\u306eRUN\u3067\u5b9f\u884c\u3057\u3066\u3044\u308b\u306e\u306b\u4e8c\u56de\u76ee\u306eRUN\u3067\u5b9f\u884c\u3057\u306a\u3044\u3068\u307f\u3064\u304b\u3089\u306a\u3044\u3082\u306e\u304c\u3042\u308b\n\n\napt-get ruby2.3\u3000\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fruby\u306fruby2.3\u30b3\u30de\u30f3\u30c9\u306b\u306a\u308b(gem\u3082\u540c\u69d8)\n\n\n\nhttps://github.com/rbenv/ruby-build/wiki \u3092\u983c\u3063\u305f\n\n\ncache\u3055\u308c\u308b\u3053\u3068\u3092\u8003\u3048\u3066\u30011\u3064\u306eRUN\u306b\u62bc\u3057\u8fbc\u3081\u306a\u3044\u307b\u3046\u304c\u8a66\u884c\u932f\u8aa4\u3057\u3084\u3059\u3044\n\n\n\u3059\u3067\u306b\u5b8c\u4e86\u3057\u305f\u3082\u306e\u3092skip\u3067\u304d\u3066\u5b09\u3057\u3044\n\n\nGemfile\u3092heredoc\u3067\u306f\u4f5c\u6210\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067ADD\u3057\u305f\n\n\nRUN <<EOF xxx EOF \u306f\u4eca\u5f8c\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3089\u3057\u3044\n\n\n\n\ndocker hub\n\nsign up\n\nid\nmail\npassword\n\n\n\u81ea\u52d5\u5316\u306e\u305f\u3081\u306e\u9023\u643a\n\nhttps://hub.docker.com/account/authorized-services/\ngithub or bitbucket account\n\n\ncli\u304b\u3089\u306elogin\n\ndocker login (username/password)\n~/.docker/config.json \u306b\u60c5\u5831\u304c\u4f5c\u6210\u3055\u308c\u308b\n\n\ncreate repository on github\n\nDockerfile\nother files\nwebhook setting(Docker)\n\n\ncreate automated-build on dockerhub\n\nhttps://hub.docker.com/add/automated-build/username/\ngithub \u306e repository\u3068\u306e\u9023\u643a\ngithub\u306bpush\u3059\u308b\u3068docker hub\u3067build\u3055\u308c\u308b\n\n\nlocal\u3088\u308a\u7d50\u69cb\u6642\u9593\u304b\u304b\u308b\n\n\n\n\netc.\n\ndocker port (fowarding port)\ndocker inspect (docker info json)\ndocker start container (start created container)\ndocker attach container (\u88cf\u3067\u5b9f\u884c\u4e2d\u30b3\u30f3\u30c6\u30ca\u306bshell\u3067\u30a2\u30af\u30bb\u30b9)\n\n\ndettach (C-p, C-q. not C-c -> exit)\n\n\ndocker commit (\u64cd\u4f5c\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u304b\u3089image\u4f5c\u6210)\n\n\nserverspec\ndocker\u30b3\u30f3\u30c6\u30ca\u3067ubuntu\u74b0\u5883\u3092\u6574\u3048\u3089\u308c\u305f\u306e\u3067\u3001\u30b3\u30d4\u30da\u3057\u3066VM ubuntu\u3067\u3082ruby\u74b0\u5883\u3092\u6574\u3048\u308b\n\nserverspec_.gemrc\ngem: --no-ri --no-rdoc\n\n\n\nserverspec_Gemfile\nsource 'https://rubygems.org'\n\ngem 'rake'\ngem 'serverspec'\ngem 'docker-api'\n\n\nserverspec-init\n + spec/\n + spec//sample_spec.rb\n + spec/spec_helper.rb\n + Rakefile\n + .rspec\n\n\n\u3088\u304f\u308f\u304b\u3063\u3066\u306a\u3044hashicorp tool\n\nhttps://speakerdeck.com/muziyoshiz/2015-4q-report\nhttp://keyamb.hatenablog.com/entry/2015/05/28/004337\nhttps://thinkit.co.jp/story/2015/04/13/5875\n\n\n## \u52d5\u6a5f\n- \u958b\u767a\u74b0\u5883\u3092\u6574\u3048\u308b\u74b0\u5883\u3092\u6700\u65b0\u306b\u3059\u308b\n- \u3044\u3044\u304b\u3052\u3093\u306bDocker\u3092\u89e6\u308b\n\n## \u6d41\u308c\n- Mac\u306a\u306e\u3067Docker\u306e\u305f\u3081\u306eVM\u3092\u7acb\u3061\u4e0a\u3052\u308b\n    - Vagrant\u3067VM\u7acb\u3061\u4e0a\u3052\u308b(Ubuntu: \u4eca\u307e\u3067Redhat\u7cfb\u3060\u3063\u305f\u306e\u3067\u89e6\u3063\u3066\u307f\u308b)\n    - Vagrant\u306e\u305f\u3081\u306eVirtualBox\u30925\u306bUpdate\n- Docker\u3068Docker\u306e\u30b3\u30f3\u30c6\u30ca\u4ee5\u5916\u306e\u6e96\u5099\u306e\u305f\u3081\u306eAnsible\u6e96\u5099\n    - \u4eca\u56de\u306fvagrant\u306eprovisioning, bootstrap.sh\u3067\u5bfe\u5fdc\n- playbook\u306e\u8a18\u8ff0\n    - <del>\u30b3\u30f3\u30c6\u30ca\u3092Serverspec\u3067\u30c6\u30b9\u30c8\u3059\u308b\u306e\u3067ruby+serverspec\u3082</del>\n- DockerFile\u306e\u8a18\u8ff0\n    - \u3053\u3063\u3061\u3067install serverspec + \u03b1 and test\n\n\u3044\u308d\u3044\u308d\u3081\u3093\u3069\u3046\u3060\u3063\u305f\u306e\u3067\u3001\u6d41\u308c\u304c\u5909\n\n## virtualbox\n- https://www.virtualbox.org/wiki/Downloads\n- 5.0.20\n\n## vagrant\nhttps://www.vagrantup.com/docs/\n\n### install\n- installer\n- https://www.vagrantup.com/downloads.html\n- Vagrant 1.8.1\n\n### VM\n- https://atlas.hashicorp.com/boxes/search\n    - ubuntu 0.14.0\u307e\u3067\u3057\u304b\u306a\u304b\u3063\u305f\n- <del>http://www.vagrantbox.es/</del> -> \u53e4\u3044\n- <del>http://opscode.github.io/bento/</del> -> \u6d88\u3048\u3066\u305f\n    - http://chef.github.io/bento/ \u306b\u79fb\u3063\u3066\u305f\n    - https://atlas.hashicorp.com/bento/ bento/ubuntu-16.04 \u3042\u3063\u305f\n\n### donwload and settings\n```bash:vagrant-vm-setup.sh\nmdkir ~/programming/vagrant/ubuntu && $_\nvagrant box add bento/ubuntu-16.04\nvagrant init bento/ubuntu-16.04\nvagrant up\nvagrant ssh\n\n# or\nvagrant ssh-config --host ubuntu1604 >> ~/.ssh/config\nssh ubuntu1604\n\n# host os\ntouch synced_folder_test\n# guest os\nls /vagrant/synced_folder_test\n# https://www.vagrantup.com/docs/synced-folders/basic_usage.html\n```\n\n```vagrant-bootstrap.sh\n#!/usr/bin/env bash\n\nsudo apt-get update\nsudo apt-get install -y vim\nsudo apt-get install -y git\nwget -q -O- https://bootstrap.pypa.io/get-pip.py | sudo python\nsudo apt-get install -y ansible\n# or sudo apt-get install -y python-dev\n# and sudo pip install ansible\n```\n\n```rb:Vagrantfile-provisioning\nVagrant.configure(\"2\") do |config|\n  config.vm.box = \"bento/ubuntu-16.04\"\n  config.vm.provision :shell, path: \"bootstrap.sh\"\nend\n\n# then vagrant halt && vagrant up --provision\n# or vagrant reload --provision\n# https://www.vagrantup.com/docs/provisioning/\n```\n\n## ansible\n- python\u88fdssh\u7d4c\u7531\u3067provisioning(default)\n- python2.7\u3067\u3082\u52d5\u3044\u305f\n- ansible2\u7cfb\u304c\u51fa\u3066\u308b\u3002\u9a12\u304c\u308c\u3066\u306a\u304b\u3063\u305f\u304b\u3089breaking changes\u306f\u5c11\u306a\u3055\u305d\u3046\n\n### commands\n- ansible\n- ansible-playbook\n- doc, galaxy, pull, vault\u3068\u306f\uff1f\n\n### ansible command\n- playbook\u3092\u4f7f\u308f\u306a\u3044\n- host\u306e\u6307\u5b9a\u304c\u5fc5\u8981(port\u4ed8\u304d\u3067\u3082\u826f\u3044)\n\n### inventory\n- http://docs.ansible.com/ansible/intro_inventory.html\n- default=/etc/ansible/hosts\n- -i hostfilepath\n- host\u306fgroup\u5316\u3067\u304d\u308b\n\n```ansible_example.sh\ncat <<EOF > ansible_hosts\n[local]\nlocalhost ansible_connection=local\nEOF\n\nansible local -i ansible_hosts -m ping\nansible all   -i ansible_hosts -m shell -a \"echo ansible shell module\"\n```\n\n### ansible-playbook\n- playbook\u3092\u4f7f\u3046\u3068\u304d\n\n```playbook-example.yml\n---\n- hosts: 127.0.0.1\n  tasks:\n    - name: ping\n      ping:\n\n- hosts: local\n  tasks:\n    - name: shell\n      shell: \"echo $item\"\n      with_items:\n        - ansible\n        - playbook\n\n# command\n# ansible-playbook -i ansible_hosts playbook-example.yml\n```\n\n## install docker on ubuntu\n- https://docs.docker.com/engine/installation/linux/ubuntulinux/\n- \u8a2d\u5b9a\u304c\u601d\u3063\u3066\u3044\u305f\u3088\u308a\u3081\u3093\u3069\u3046\u3060\u3063\u305f\u306e\u3067\u3001ansible-playbook\u3084\u3081\u3066bootstrap.sh\u306b\u8ffd\u52a0\u3057\u305f\n\n```docker_install_for_ubuntu.sh\nsudo apt-get install -y apt-transport-https ca-certificates\nsudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D\necho \"deb https://apt.dockerproject.org/repo ubuntu-xenial main\" \\\n   > /etc/apt/sources.list.d/docker.list\nsudo apt-get update\nsudo apt-get purge lxc-docker\n\nsudo apt-get install -y linux-image-extra-$(uname -r)\nsudo apt-get install -y docker.io\nsudo apt-get install -y docker-engine\nsudo service docker start\n\nsudo groupadd docker\nsudo usermod -aG docker vagrant\ndocker run hello-world # without sudo\n```\n\n## docker ecosystem\n### brew serach\u3067\u898b\u3064\u304b\u3063\u305f\u3082\u306e\n- <del>boot2docker</del>\n- docker-machine\n    - Automate Docker provisioning\n    - create VM\n- docker\n    - client\n- docker-compose\n    - for multi-container application\n- docker-swarm\n    - native clustering capabilities to turn a group of Docker engines into a single, virtual Docker Engine.\n\n### docker toolbox\nhttps://www.docker.com/products/docker-toolbox, docker\u95a2\u9023\u3044\u308d\u3044\u308d\n\n- Docker Engine\n    - Docker Engine runs on Linux to create the operating environment\n- Compose\n- Machine\n- Kitematic\n    - GUI\n\n\u306a\u3093\u306e\u305f\u3081\u306bubuntu\u7528\u610f\u3057\u305f\u3093\u3060\u2026\n\n#### install\u3057\u3066\u4f7f\u3063\u3066\u307f\u305f\n- install\u6642\u306b\u8a2d\u5b9a\u3092\u884c\u3046shell script\u3092\u5b9f\u884c\u3055\u308c\u305f\n    - `/.docker/machine/machines/default/boot2docker.iso`\n    - VM/SSH\u7b49\u306e\u8a2d\u5b9a\n    - VM\u306fVirtualBox\u4e0a\u3067\u306f`default`\u3068\u3044\u3046\u540d\u524d\u306e\u30e1\u30e2\u30ea2G\n- `docker run hello-world` \u554f\u984c\u306a\u3057\n- \u4e0a\u8a18\u5b9f\u884c\u7d42\u4e86\u6642\u306b\u52e7\u3081\u3089\u308c\u305f `docker run -it ubuntu bash` \u554f\u984c\u306a\u3057\n    - `uname -a`\n    - `Linux 87631664c41b 4.4.8-boot2docker #1 SMP Mon Apr 25 21:57:27 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux`\n- ubuntu\u3092centos\u306b\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u3066\u3082\u554f\u984c\u306a\u3057\n    - uname\u306e\u7d50\u679c\u306f\u540c\u3058\n    - ubuntu\u3067\u306fpython\u306a\u304b\u3063\u305f\u304c\u3001centos\u3067\u306f\u3042\u3063\u305f\u306e\u3067\u4e2d\u8eab\u306f\u9055\u3046\n- iterm\u306b\u3057\u305f\u3068\u601d\u3046\u3093\u3060\u3051\u3069\u3001kitematic\u306eDOCKER CLI\u3067terminal\u304c\u7acb\u3061\u4e0a\u304c\u3089\u306a\u3044\n    - \u306a\u306e\u3067\u3001\u4e0b\u8a18\u3092iterm\u3067\u5b9f\u884c\u3059\u308b\n    - `bash -c \"DOCKER_HOST=tcp://192.168.99.100:2376 DOCKER_CERT_PATH=~/.docker/machine/machines/default DOCKER_TLS_VERIFY=1 /bin/zsh\"`\n    - shell\u7acb\u3061\u4e0a\u3052\u6642\u306b\u4ed6\u306e\u8a2d\u5b9a\u3092\u3059\u308b\u306e\u304b\u3001\u74b0\u5883\u5909\u6570\u3092\u305f\u3060\u8a2d\u5b9a\u3059\u308b\u3060\u3051\u3067\u306f\u30c0\u30e1\u3060\u3063\u305f\n\n### docker for mac/windows\nhttps://blog.docker.com/2016/03/docker-for-mac-windows-beta/\n> \nDocker for Mac can be used at the same time as Docker Toolbox on the same machine, allowing developers to continue using Toolbox as they evaluate Docker for Mac. \n\n- beta\u306a\u306e\u3067docker ID\u3092\u767b\u9332\u3057\u3066\u304b\u3089\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308b\n- \u4e0b\u8a18\u3001\u4f7f\u7528\u4f8b\u3002toolbox\u3068\u6bd4\u3079\u308b\u3068\u4fbf\u5229\u305d\u3046\n- http://paiza.hatenablog.com/entry/docker_for_mac\n\n### \u305d\u306e\u4ed6docker\u95a2\u9023\n- cloud/hub\u306fdocker\u793e\u306eProduct\n- beta\u306e\u3068\u304d\u306b\u767b\u9332\u3059\u308bdocker ID\u306fhub\u30c9\u30e1\u30a4\u30f3\u3067\u4f5c\u308b\n- notary(https://docs.docker.com/notary/getting_started/)\n\n## Dockerfile\n\n```docker_Dockerfile\n# command: docker build -t docker-example:0.0.1 /vagrant/\n\n# Pull base image.\nFROM ubuntu:16.04\n\nMAINTAINER ksomemo\n\n# Install.\nRUN \\\n  sed -i 's/# \\(.*multiverse$\\)/\\1/g' /etc/apt/sources.list && \\\n  apt-get update && \\\n  apt-get -y upgrade && \\\n  apt-get install -y build-essential && \\\n  apt-get install -y software-properties-common && \\\n  apt-get install -y byobu curl git htop man unzip vim wget && \\\n  rm -rf /var/lib/apt/lists/*\n\n# Ruby dependencies\nRUN \\\n  apt-get update && \\\n  apt-get install -y \\\n    git tar gcc openssl \\\n    libssl-dev zlib1g-dev libyaml-dev \\\n    libreadline-dev libffi-dev libxml2-dev libxslt-dev\n\n# Ruby\nRUN git clone https://github.com/rbenv/ruby-build.git\nRUN ./ruby-build/install.sh\nRUN  ruby-build 2.3.1 /usr/local\n  #apt-get update && \\\n  #apt-get install -y ruby2.3 ruby2.3-dev\n\n# Install Nginx.\nRUN \\\n  add-apt-repository -y ppa:nginx/stable && \\\n  apt-get update && \\\n  apt-get install -y nginx && \\\n  rm -rf /var/lib/apt/lists/* && \\\n  #echo \"\\ndaemon off;\" >> /etc/nginx/nginx.conf && \\\n  chown -R www-data:www-data /var/lib/nginx\n\n# serverspec\n# Add files.\nADD .gemrc ~/.gemrc\nADD Gemfile Gemfile\n\nRUN gem update --system\nRUN gem install bundler\nRUN bundle install\n\n# Set environment variables.\nENV HOME /root\n\n# Define mountable directories.\nVOLUME [\"/etc/nginx/sites-enabled\", \"/etc/nginx/certs\", \"/etc/nginx/conf.d\", \"/var/log/nginx\", \"/var/www/html\"]\n\n# Define working directory.\nWORKDIR /etc/nginx\n\n# Expose ports.\nEXPOSE 80\nEXPOSE 443\n\n# Define default command.\nCMD [\"bash\"]\"\n```\n\n- aaa\n- https://docs.docker.com/engine/reference/builder\n- \u53c2\u8003\u30d5\u30a1\u30a4\u30eb\n    - https://github.com/dockerfile/nginx/blob/master/Dockerfile\n    - https://github.com/dockerfile/ubuntu/blob/master/Dockerfile\n- FROM \u3067base\u3068\u306a\u308bDockerfile\u3092\u6307\u5b9a\u3067\u304d\u308b\n    - nginx\u306f dockerfile/ubuntu\n    - ubuntu\u306f ubuntu:14.04\n    - \u4e0a\u8a18\u306f https://hub.docker.com/r/library/ubuntu/ \u306e14.04\u306e\u3053\u3068\n    - \u4e0a\u8a18\u306f FROM scratch\n- apt-get update \u3092\u983b\u7e41\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\uff1f\n    - \u4e00\u756a\u6700\u521d\u306eRUN\u3067\u5b9f\u884c\u3057\u3066\u3044\u308b\u306e\u306b\u4e8c\u56de\u76ee\u306eRUN\u3067\u5b9f\u884c\u3057\u306a\u3044\u3068\u307f\u3064\u304b\u3089\u306a\u3044\u3082\u306e\u304c\u3042\u308b\n- apt-get ruby2.3\u3000\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fruby\u306fruby2.3\u30b3\u30de\u30f3\u30c9\u306b\u306a\u308b(gem\u3082\u540c\u69d8)\n    - https://github.com/rbenv/ruby-build/wiki \u3092\u983c\u3063\u305f\n- cache\u3055\u308c\u308b\u3053\u3068\u3092\u8003\u3048\u3066\u30011\u3064\u306eRUN\u306b\u62bc\u3057\u8fbc\u3081\u306a\u3044\u307b\u3046\u304c\u8a66\u884c\u932f\u8aa4\u3057\u3084\u3059\u3044\n    - \u3059\u3067\u306b\u5b8c\u4e86\u3057\u305f\u3082\u306e\u3092skip\u3067\u304d\u3066\u5b09\u3057\u3044\n- Gemfile\u3092heredoc\u3067\u306f\u4f5c\u6210\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067ADD\u3057\u305f\n    - RUN <<EOF xxx EOF \u306f\u4eca\u5f8c\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3089\u3057\u3044\n\n### docker hub\n#### sign up\n- id\n- mail\n- password\n\n#### \u81ea\u52d5\u5316\u306e\u305f\u3081\u306e\u9023\u643a\n- https://hub.docker.com/account/authorized-services/\n- github or bitbucket account\n\n#### cli\u304b\u3089\u306elogin\n- docker login (username/password)\n- ~/.docker/config.json \u306b\u60c5\u5831\u304c\u4f5c\u6210\u3055\u308c\u308b\n\n#### create repository on github\n- Dockerfile\n- other files\n- webhook setting(Docker)\n\n#### create automated-build on dockerhub\n- https://hub.docker.com/add/automated-build/username/\n- github \u306e repository\u3068\u306e\u9023\u643a\n- github\u306bpush\u3059\u308b\u3068docker hub\u3067build\u3055\u308c\u308b\n    - local\u3088\u308a\u7d50\u69cb\u6642\u9593\u304b\u304b\u308b\n\n#### etc.\n- docker port (fowarding port)\n- docker inspect (docker info json)\n- docker start container (start created container)\n- docker attach container (\u88cf\u3067\u5b9f\u884c\u4e2d\u30b3\u30f3\u30c6\u30ca\u306bshell\u3067\u30a2\u30af\u30bb\u30b9)\n    - dettach (C-p, C-q. not C-c -> exit)\n- docker commit (\u64cd\u4f5c\u3057\u305f\u30b3\u30f3\u30c6\u30ca\u304b\u3089image\u4f5c\u6210)\n\n## serverspec\ndocker\u30b3\u30f3\u30c6\u30ca\u3067ubuntu\u74b0\u5883\u3092\u6574\u3048\u3089\u308c\u305f\u306e\u3067\u3001\u30b3\u30d4\u30da\u3057\u3066VM ubuntu\u3067\u3082ruby\u74b0\u5883\u3092\u6574\u3048\u308b\n\n```rb:serverspec_.gemrc\ngem: --no-ri --no-rdoc\n```\n\n```rb:serverspec_Gemfile\nsource 'https://rubygems.org'\n\ngem 'rake'\ngem 'serverspec'\ngem 'docker-api'\n```\n\n`serverspec-init`\n\n```\n + spec/\n + spec//sample_spec.rb\n + spec/spec_helper.rb\n + Rakefile\n + .rspec\n```\n\n\n\n\n\n## \u3088\u304f\u308f\u304b\u3063\u3066\u306a\u3044hashicorp tool\n- https://speakerdeck.com/muziyoshiz/2015-4q-report\n- http://keyamb.hatenablog.com/entry/2015/05/28/004337\n- https://thinkit.co.jp/story/2015/04/13/5875\n", "tags": ["memo"]}