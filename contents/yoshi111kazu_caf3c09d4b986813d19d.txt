{"context": "\n\n\u6982\u8981\nGAS\u306e\u5165\u9580\u3068\u3057\u3066\u3001\n\u300cGoogleAnalytics\u306e\u30c7\u30fc\u30bf\u3092GoogleDrive\u306eSpreadSheet\u306b\u4fdd\u5b58\u3057\u3066\u30ec\u30dd\u30fc\u30c8\u3092\u65e5\u6b21\u3067\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u300d\n\u3092\u81ea\u52d5\u5316\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3046\u3044\u3048\u3070\u3001Analytics\u3082\u5fc5\u8981\u306a\u6642\u3057\u304b\u898b\u3066\u3044\u306a\u304f\u3001\u8a2d\u5b9a\u3082Default\u306a\u306e\u3067\u6539\u3081\u3066\u52c9\u5f37\u3082\u8fbc\u3081\u3066\u3002\n\u524d\u63d0\u306a\u3069\uff1a\n\u3000\u30fb\u73fe\u5728\u30db\u30fc\u30e0\u30da\u30fc\u30b8\u3092\u904b\u7528\u3057\u3066\u3066\u3001\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u5207\u3063\u3066\u6a5f\u80fd\u5225\u3067\u904b\u7528\u3057\u3066\u3044\u308b\u3002\n\u3000\u30fbQiita\u3001\u306f\u3066\u306a\u30d6\u30ed\u30b0\u3082\u540c\u3058\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0ID\u8a2d\u5b9a\u3057\u3066\u3044\u3066\u3001\u307e\u3068\u3081\u3066\u96c6\u8a08\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u3000\u30fb\u30ec\u30dd\u30fc\u30c8\u5185\u5bb9\u306f\u3001\u524d\u65e5\u306ePV\u3084\u30bb\u30b7\u30e7\u30f3\u306a\u3069\u306e\u60c5\u5831\u3068\u8a18\u4e8b\u5225\u306eTop10\n\n\nGoogle Analytics\u5074\u3067\u306e\u4e8b\u524d\u8a2d\u5b9a\n\n\u300c\u7ba1\u7406\u300d\u30bf\u30d6\u3067\u306e\u8a2d\u5b9a\n\n\n\u30d5\u30a3\u30eb\u30bf\n\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068/\u4ee5\u4e0b\u306e\u30ed\u30b0\u3057\u304b\u6b8b\u3089\u306a\u3044\u306e\u3067\u30c9\u30e1\u30a4\u30f3\u3082\u8ffd\u52a0\uff08\u624b\u9806\u5272\u611b\uff09\nnot set \u9664\u5916\uff08\u591a\u304f\u306a\u3051\u308c\u3070\u4e0d\u8981\u3002\u691c\u7d22\u30a8\u30f3\u30b8\u30f3\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\uff09\n\u793e\u5185\u3001\u81ea\u5b85IP\u306e\u9664\u5916\uff08\u56fa\u5b9aIP\u3067\u3042\u308c\u3070\uff09\n\u958b\u767a\u74b0\u5883\u3092\u9664\u5916\uff08dev.xxx.jp\uff09\n\n\n\u30d3\u30e5\u30fc\u8a2d\u5b9a\n\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30da\u30fc\u30b8\u306bindex.html\u3092\u8ffd\u52a0\uff08/\u3068/index.html\u3092\u540c\u3058\u30ed\u30b0\u306b\u3059\u308b\uff09\n\n\n\n\n\n\nGoogle SpreadSheet\u306b\u30c7\u30fc\u30bf\u3092\u81ea\u52d5\u4fdd\u5b58\uff08\u65e5\u6b21 1:00\u301c2:00\uff09\n\nGoogle Drive \u3078 Google Apps Script \u306e\u8ffd\u52a0\n\n\u300c\u65b0\u898f\u300d->\u300c\u30a2\u30d7\u30ea\u8ffd\u52a0\u300d\u3088\u308a\u691c\u7d22\u3057\u3066\u8ffd\u52a0\n\n\nGoogle Analytics \u30a2\u30c9\u30aa\u30f3\u3092\u8ffd\u52a0\n\nSpreadSheet\u3092\u65b0\u898f\u4f5c\u6210\u3057\u3001\u300c\u30a2\u30c9\u30aa\u30f3\u300d\u3088\u308a\u691c\u7d22\u3057\u3066\u8ffd\u52a0\n\n\n\u8a2d\u5b9a\n\n\u300cCreate a new report\u300d\u3057\u3066\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\n\n\u4e0b\u8a18\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nhttp://tonari-it.com/google-analytics-spreadsheet/\n\n\u78ba\u8a8d\uff06\u81ea\u52d5\u5316\n\u300c\u30a2\u30c9\u30aa\u30f3\u300d\u304b\u3089Run Report\u3057\u3066OK\u3060\u3063\u305f\u3089\u3001Schedule Report\u3067\u81ea\u52d5\u5316\u3057\u307e\u3059\u3002\n\n\u4fdd\u5b58\u3057\u305f\u30c7\u30fc\u30bf\u3092\u96c6\u8a08\u3057\u3066\u30c1\u30e3\u30c3\u30c8\u3078\u9001\u4fe1\uff08\u65e5\u6b21 2:00\u301c3:00\uff09\n\n\u30b9\u30af\u30ea\u30d7\u30c8(GAS)\u306e\u8a2d\u7f6e\nSpreadSheet\u4e0a\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u3092\u958b\u304d\u3001\u300c\u30ea\u30bd\u30fc\u30b9\u300d\u304b\u3089\u30e9\u30a4\u30d6\u30e9\u30ea\u8ffd\u52a0\n\uff08\u516c\u5f0f\u3067\u306f\u306a\u304f\u3001\u500b\u4eba\u4f5c\u6210\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u306e\u3067\u78ba\u8a8d\u30fb\u7406\u89e3\u3057\u305f\u4e0a\u3067\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\nChatwork Client\nM6TcEyniCs1xb3sdXFF_FhI-MNonZQ_sT    Ver.16\nhttps://github.com/cw-shibuya/cw-event-notifier-gas\n\nSlack Client\nM3W5Ut3Q39AaIwLquryEPMwV62A3znfOO    Ver.22\nhttps://github.com/soundTricker/SlackApp\n\n\n\n\u30ec\u30dd\u30fc\u30c8\u7528\u30b9\u30af\u30ea\u30d7\u30c8\nfunction SendReport() {\n\n  var mySS=SpreadsheetApp.getActiveSpreadsheet();\n  var sheetDaily=mySS.getSheetByName(\"Daily\"); //Daily\u30ec\u30dd\u30fc\u30c8\u30b7\u30fc\u30c8\u3092\u53d6\u5f97\n  var rowDaily=sheetDaily.getDataRange().getLastRow(); //\u6700\u7d42\u884c\u3092\u53d6\u5f97\n\n  var yDate = sheetDaily.getRange(rowDaily,1).getValue();\n\n  /* \u30ec\u30dd\u30fc\u30c8\u2460 :\u524d\u65e5\u306ePV\u3068\u304b */\n  var strBody = \"[info][title]ishino.info \" +\n      Utilities.formatDate(yDate, 'JST', 'yyyy/MM/dd') + \"[/title]\" + \u3000//ga:date\n      \"PV\uff1a \" + sheetDaily.getRange(rowDaily,2).getValue() + \"\\n\" + //ga:pageviews\n      \"User\uff1a \" + sheetDaily.getRange(rowDaily,3).getValue() + \"   /   \" + //ga:users\n      \"Session\uff1a \" + sheetDaily.getRange(rowDaily,4).getValue() + \"\\n\" + //ga:sessions\n      \"\u76f4\u5e30\u7387\uff1a \" + Number(sheetDaily.getRange(rowDaily,5).getValue()*100).toFixed(1) + \"%   /   \" + //ga:bounceRate\n      \"Session\u5e73\u5747\uff1a \" + Number(sheetDaily.getRange(rowDaily,6).getValue()).toFixed(1) + \"\u79d2[hr]\" ; //ga:avgSessionDuration\n\n  /* \u30ec\u30dd\u30fc\u30c8\u2461 :\u524d\u65e5\u306e\u8a18\u4e8b\u5225Top10 */\n  var sheetPost=mySS.getSheetByName(\"\u8a18\u4e8b\u5225\"); //\u8a18\u4e8b\u5225\u30ec\u30dd\u30fc\u30c8\u30b7\u30fc\u30c8\u3092\u53d6\u5f97\n\n  for(var i=1;i<=10;i++){\n    strBody = strBody + sheetPost.getRange(i+15,3).getValue() + \" pv :  \" + sheetPost.getRange(i+15,2).getValue() + \"\\n\";\n  }\n\n  strBody = strBody + \"[hr]\" + mySS.getUrl() + \"[/info]\"; //\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eURL\u3092\u53d6\u5f97\n\n  SendCW( strBody )\n  //SendSlack( strBody )\n}\n\nfunction SendCW( strBody ) {\n  var cwClient = ChatWorkClient.factory({token: 'xxx'}); //\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30afAPI\n  cwClient.sendMessage({\n    room_id: xxx, //\u30eb\u30fc\u30e0ID\n    body: strBody\n  });\n}\n\nfunction SendSlack( strBody ) {\n  var token = 'xoxb-xxx';\n  var slackApp = SlackApp.create(token); //SlackApp \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u53d6\u5f97\n  var options = {\n    channelId: \"#bot_test\", //\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n    userName: \"mohi\", //\u6295\u7a3f\u3059\u308bbot\u306e\u540d\u524d\n    message: strBody //\u6295\u7a3f\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\n  };\n  slackApp.postMessage(options.channelId, options.message, {username: options.userName});\n}\n\n\n\n\u78ba\u8a8d\uff06\u81ea\u52d5\u5316\n\nSendReport\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066OK\u3060\u3063\u305f\u3089\u6642\u8a08\u30de\u30fc\u30af\u304b\u3089\u81ea\u52d5\u5316\u8a2d\u5b9a\u3057\u3066\u5b8c\u4e86\n\n# \u6982\u8981\nGAS\u306e\u5165\u9580\u3068\u3057\u3066\u3001\n\u300cGoogleAnalytics\u306e\u30c7\u30fc\u30bf\u3092GoogleDrive\u306eSpreadSheet\u306b\u4fdd\u5b58\u3057\u3066\u30ec\u30dd\u30fc\u30c8\u3092\u65e5\u6b21\u3067\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u300d\n\u3092\u81ea\u52d5\u5316\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3046\u3044\u3048\u3070\u3001Analytics\u3082\u5fc5\u8981\u306a\u6642\u3057\u304b\u898b\u3066\u3044\u306a\u304f\u3001\u8a2d\u5b9a\u3082Default\u306a\u306e\u3067\u6539\u3081\u3066\u52c9\u5f37\u3082\u8fbc\u3081\u3066\u3002\n\n\u524d\u63d0\u306a\u3069\uff1a\n\u3000\u30fb\u73fe\u5728\u30db\u30fc\u30e0\u30da\u30fc\u30b8\u3092\u904b\u7528\u3057\u3066\u3066\u3001\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u5207\u3063\u3066\u6a5f\u80fd\u5225\u3067\u904b\u7528\u3057\u3066\u3044\u308b\u3002\n\u3000\u30fbQiita\u3001\u306f\u3066\u306a\u30d6\u30ed\u30b0\u3082\u540c\u3058\u30c8\u30e9\u30c3\u30ad\u30f3\u30b0ID\u8a2d\u5b9a\u3057\u3066\u3044\u3066\u3001\u307e\u3068\u3081\u3066\u96c6\u8a08\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u3000\u30fb\u30ec\u30dd\u30fc\u30c8\u5185\u5bb9\u306f\u3001\u524d\u65e5\u306ePV\u3084\u30bb\u30b7\u30e7\u30f3\u306a\u3069\u306e\u60c5\u5831\u3068\u8a18\u4e8b\u5225\u306eTop10\n\n<img width=\"400\" alt=\"GA_01.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/93107/d0f7e0da-61bd-f107-596f-3c30c7886e12.png\">\n\n# Google Analytics\u5074\u3067\u306e\u4e8b\u524d\u8a2d\u5b9a\n- \u300c\u7ba1\u7406\u300d\u30bf\u30d6\u3067\u306e\u8a2d\u5b9a\n    - \u30d5\u30a3\u30eb\u30bf\n        - \u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068/\u4ee5\u4e0b\u306e\u30ed\u30b0\u3057\u304b\u6b8b\u3089\u306a\u3044\u306e\u3067\u30c9\u30e1\u30a4\u30f3\u3082\u8ffd\u52a0\uff08\u624b\u9806\u5272\u611b\uff09\n        - not set \u9664\u5916\uff08\u591a\u304f\u306a\u3051\u308c\u3070\u4e0d\u8981\u3002\u691c\u7d22\u30a8\u30f3\u30b8\u30f3\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\uff09\n        - \u793e\u5185\u3001\u81ea\u5b85IP\u306e\u9664\u5916\uff08\u56fa\u5b9aIP\u3067\u3042\u308c\u3070\uff09\n        - \u958b\u767a\u74b0\u5883\u3092\u9664\u5916\uff08dev.xxx.jp\uff09\n    - \u30d3\u30e5\u30fc\u8a2d\u5b9a\n        - \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30da\u30fc\u30b8\u306bindex.html\u3092\u8ffd\u52a0\uff08/\u3068/index.html\u3092\u540c\u3058\u30ed\u30b0\u306b\u3059\u308b\uff09\n\n# Google SpreadSheet\u306b\u30c7\u30fc\u30bf\u3092\u81ea\u52d5\u4fdd\u5b58\uff08\u65e5\u6b21 1:00\u301c2:00\uff09\n## Google Drive \u3078 Google Apps Script \u306e\u8ffd\u52a0\n- \u300c\u65b0\u898f\u300d->\u300c\u30a2\u30d7\u30ea\u8ffd\u52a0\u300d\u3088\u308a\u691c\u7d22\u3057\u3066\u8ffd\u52a0\n\n## Google Analytics \u30a2\u30c9\u30aa\u30f3\u3092\u8ffd\u52a0\n- SpreadSheet\u3092\u65b0\u898f\u4f5c\u6210\u3057\u3001\u300c\u30a2\u30c9\u30aa\u30f3\u300d\u3088\u308a\u691c\u7d22\u3057\u3066\u8ffd\u52a0\n\n## \u8a2d\u5b9a\n- \u300cCreate a new report\u300d\u3057\u3066\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n<img width=\"500\" alt=\"GA.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/93107/caa08157-0b04-c977-eef8-19e190895716.png\">\n\n\u4e0b\u8a18\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nhttp://tonari-it.com/google-analytics-spreadsheet/\n\n## \u78ba\u8a8d\uff06\u81ea\u52d5\u5316\n\u300c\u30a2\u30c9\u30aa\u30f3\u300d\u304b\u3089Run Report\u3057\u3066OK\u3060\u3063\u305f\u3089\u3001Schedule Report\u3067\u81ea\u52d5\u5316\u3057\u307e\u3059\u3002\n\n# \u4fdd\u5b58\u3057\u305f\u30c7\u30fc\u30bf\u3092\u96c6\u8a08\u3057\u3066\u30c1\u30e3\u30c3\u30c8\u3078\u9001\u4fe1\uff08\u65e5\u6b21 2:00\u301c3:00\uff09\n## \u30b9\u30af\u30ea\u30d7\u30c8(GAS)\u306e\u8a2d\u7f6e\nSpreadSheet\u4e0a\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u3092\u958b\u304d\u3001\u300c\u30ea\u30bd\u30fc\u30b9\u300d\u304b\u3089\u30e9\u30a4\u30d6\u30e9\u30ea\u8ffd\u52a0\n\uff08\u516c\u5f0f\u3067\u306f\u306a\u304f\u3001\u500b\u4eba\u4f5c\u6210\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u306e\u3067\u78ba\u8a8d\u30fb\u7406\u89e3\u3057\u305f\u4e0a\u3067\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\n- Chatwork Client\n M6TcEyniCs1xb3sdXFF_FhI-MNonZQ_sT    Ver.16  \n  https://github.com/cw-shibuya/cw-event-notifier-gas\n- Slack Client\n M3W5Ut3Q39AaIwLquryEPMwV62A3znfOO    Ver.22  \n  https://github.com/soundTricker/SlackApp\n\n## \u30ec\u30dd\u30fc\u30c8\u7528\u30b9\u30af\u30ea\u30d7\u30c8\n\n```\nfunction SendReport() {\n\n  var mySS=SpreadsheetApp.getActiveSpreadsheet();\n  var sheetDaily=mySS.getSheetByName(\"Daily\"); //Daily\u30ec\u30dd\u30fc\u30c8\u30b7\u30fc\u30c8\u3092\u53d6\u5f97\n  var rowDaily=sheetDaily.getDataRange().getLastRow(); //\u6700\u7d42\u884c\u3092\u53d6\u5f97\n\n  var yDate = sheetDaily.getRange(rowDaily,1).getValue();\n\n  /* \u30ec\u30dd\u30fc\u30c8\u2460 :\u524d\u65e5\u306ePV\u3068\u304b */\n  var strBody = \"[info][title]ishino.info \" +\n      Utilities.formatDate(yDate, 'JST', 'yyyy/MM/dd') + \"[/title]\" + \u3000//ga:date\n      \"PV\uff1a \" + sheetDaily.getRange(rowDaily,2).getValue() + \"\\n\" + //ga:pageviews\n      \"User\uff1a \" + sheetDaily.getRange(rowDaily,3).getValue() + \"   /   \" + //ga:users\n      \"Session\uff1a \" + sheetDaily.getRange(rowDaily,4).getValue() + \"\\n\" + //ga:sessions\n      \"\u76f4\u5e30\u7387\uff1a \" + Number(sheetDaily.getRange(rowDaily,5).getValue()*100).toFixed(1) + \"%   /   \" + //ga:bounceRate\n      \"Session\u5e73\u5747\uff1a \" + Number(sheetDaily.getRange(rowDaily,6).getValue()).toFixed(1) + \"\u79d2[hr]\" ; //ga:avgSessionDuration\n\n  /* \u30ec\u30dd\u30fc\u30c8\u2461 :\u524d\u65e5\u306e\u8a18\u4e8b\u5225Top10 */\n  var sheetPost=mySS.getSheetByName(\"\u8a18\u4e8b\u5225\"); //\u8a18\u4e8b\u5225\u30ec\u30dd\u30fc\u30c8\u30b7\u30fc\u30c8\u3092\u53d6\u5f97\n\n  for(var i=1;i<=10;i++){\n    strBody = strBody + sheetPost.getRange(i+15,3).getValue() + \" pv :  \" + sheetPost.getRange(i+15,2).getValue() + \"\\n\";\n  }\n\n  strBody = strBody + \"[hr]\" + mySS.getUrl() + \"[/info]\"; //\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eURL\u3092\u53d6\u5f97\n\n  SendCW( strBody )\n  //SendSlack( strBody )\n}\n\nfunction SendCW( strBody ) {\n  var cwClient = ChatWorkClient.factory({token: 'xxx'}); //\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30afAPI\n  cwClient.sendMessage({\n    room_id: xxx, //\u30eb\u30fc\u30e0ID\n    body: strBody\n  });\n}\n\nfunction SendSlack( strBody ) {\n  var token = 'xoxb-xxx';\n  var slackApp = SlackApp.create(token); //SlackApp \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u53d6\u5f97\n  var options = {\n    channelId: \"#bot_test\", //\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n    userName: \"mohi\", //\u6295\u7a3f\u3059\u308bbot\u306e\u540d\u524d\n    message: strBody //\u6295\u7a3f\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\n  };\n  slackApp.postMessage(options.channelId, options.message, {username: options.userName});\n}\n\n```\n\n## \u78ba\u8a8d\uff06\u81ea\u52d5\u5316\n- SendReport\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066OK\u3060\u3063\u305f\u3089\u6642\u8a08\u30de\u30fc\u30af\u304b\u3089\u81ea\u52d5\u5316\u8a2d\u5b9a\u3057\u3066\u5b8c\u4e86\n", "tags": ["GoogleAppsScript", "GoogleAnalytics", "ChatOps", "GoogleSpreadSheet"]}