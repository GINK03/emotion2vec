{"tags": ["FlashAir", "SPI", "AQM1248A", "Lua"], "context": " More than 1 year has passed since last update.\u5148\u65e5\u3001\u79cb\u8449\u539f\u306e\u79cb\u6708\u96fb\u5b50\u3055\u3093\u5e97\u982d\u3067\u3001\u306a\u3093\u3068\u306a\u304f\u76ee\u306b\u5165\u3063\u3066\u8cb7\u3063\u3066\u307f\u305f\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\uff2c\uff23\uff24\u30d4\u30c3\u30c1\u5909\u63db\u30ad\u30c3\u30c8AE-AQM1248\uff08SPI\u63a5\u7d9a\u306e\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u6db2\u6676AQM1248A\u642d\u8f09\uff09\u3092\u3001FlashAir\u3067\u5236\u5fa1\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nFlashAir W-03\u306eLua\u30b9\u30af\u30ea\u30d7\u30c8\u5b9f\u884c\u74b0\u5883\n\u3000FlashAir W-03\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001SD\u30ab\u30fc\u30c9\u4e0a\u3067Lua\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002Lua\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u306f\u3001FlashAir\u306eGPIO\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u3001\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2SPI\u306b\u3088\u308aSPI\u30c7\u30d0\u30a4\u30b9\u3092\u5236\u5fa1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u308c\u307e\u3067\u3001D/A\u30b3\u30f3\u30d0\u30fc\u30bfMCP4922\u3084IO\u30a8\u30ad\u30b9\u30d1\u30f3\u30c0MCP23S17\u3092\u5236\u5fa1\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u4eca\u56de\u306f\u3001FlashAir\u3067\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u6db2\u6676AQM1248A\u3092\u5236\u5fa1\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u69cb\u6210\n\u3000\u5fc5\u8981\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\nFlashAir W-03 V3.00.01\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u6e08\u307f\u306e\u3082\u306e\n\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\uff2c\uff23\uff24\u30d4\u30c3\u30c1\u5909\u63db\u30ad\u30c3\u30c8AE-AQM1248\uff08\u79cb\u6708\u96fb\u5b50\u901a\u5546\uff09\nSD\u30ab\u30fc\u30c9\u30b9\u30ed\u30c3\u30c8\uff08\u30ab\u30fc\u30c9\u30bd\u30b1\u30c3\u30c8SD-N0940\u3092DIP\u5316\uff09\n3.3V\u5b9a\u96fb\u5727\u30ec\u30ae\u30e5\u30ec\u30fc\u30bf\uff08\u79cb\u6708\u96fb\u5b50\u901a\u5546\uff09\n\u30d6\u30ec\u30c3\u30c9\u30dc\u30fc\u30c9\nAC\u30a2\u30c0\u30d7\u30bf\uff085V\uff09:\u624b\u6301\u3061\u306e\u3082\u306e\u3092\u5229\u7528\n\n\n\nSD\u30ab\u30fc\u30c9\u30b9\u30ed\u30c3\u30c8\n\u3000SD\u30ab\u30fc\u30c9\u30b9\u30ed\u30c3\u30c8\u306f\u306a\u3093\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\u304c\u3001\u4eca\u56de\u306fSD\u30ab\u30fc\u30c9\u306e1\u756a\u30012\u756a\u30017\u756a\u30018\u756a\u30d4\u30f3\u3092\u5f15\u304d\u51fa\u305b\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nFlashAir\u3068AE-AQM1248\u306e\u63a5\u7d9a\n\u3000FlashAir\u3068AE-AQM1248\u306e\u63a5\u7d9a\u306f\u3001\u4ee5\u4e0b\u306e\u8868\u306b\u793a\u3059\u901a\u308a\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002\n\n\nCONFIG\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\u3000FlashAir\u306eSD_WLAN\u30d5\u30a9\u30eb\u30c0\u5185\u306eCONFIG\u30d5\u30a1\u30a4\u30eb\u306b\u3001\u4ee5\u4e0b\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002IFMODE\u306fFlashAir\u306eGPIO\u30e2\u30fc\u30c9\u3092ON\u306b\u3057\u3066\u3044\u307e\u3059\u3002LUA_RUN_SCRIPT\u306fFlashAir\u306e\u96fb\u6e90\u6295\u5165\u5f8c\u3059\u3050\u306b\u6307\u5b9a\u306eLua\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3067\u3059\u3002\nIFMODE=1\nLUA_RUN_SCRIPT=/GLCDsample.lua\n\n\u3000\u203bSD_WLAN\u30d5\u30a9\u30eb\u30c0\u3068CONFIG\u30d5\u30a1\u30a4\u30eb\u306f\u4e0d\u53ef\u8996\u5c5e\u6027\u30d5\u30a1\u30a4\u30eb\u306a\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nLua\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\n\u3000FlashAir\u306e\u30eb\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u306b\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\uff08GLCDsample.lua\uff09\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\u3000\u3053\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001\u307e\u305a\u306f\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u6db2\u6676\u304c\u3069\u306e\u7a0b\u5ea6\u306e\u901f\u5ea6\u3067\u66f8\u304d\u63db\u3048\u3089\u308c\u308b\u306e\u304b\u3092\u8a66\u3059\u305f\u3081\u3001\u5168\u9762\u306b\u30d3\u30c3\u30c8\u30d1\u30bf\u30fc\u30f3\u3092\u63cf\u3044\u3066\u3001\u6d88\u3059\u3053\u3068\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\u3053\u306e\u30b3\u30fc\u30c9\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\u3057\u306a\u3077\u3059\u306e\u30cf\u30fc\u30c9\u88fd\u4f5c\u8a18 - Arduino\u7528\u30d8\u30c3\u30c0\u30b7\u30fc\u30eb\u30c9\u306e\u88fd\u4f5c(3)\n\u3000\u4eca\u56de\u8a66\u3057\u305fAQM1248A\u306fSPI\u63a5\u7d9a\u5bfe\u5fdc\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u30b3\u30de\u30f3\u30c9\u9001\u4fe1\u3068\u30c7\u30fc\u30bf\u9001\u4fe1\u306e\u533a\u5225\u3092\u3059\u308b\u305f\u3081\u306bRS\u7aef\u5b50\u306eHIGH/LOW\u3092\u5236\u5fa1\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u305f\u3081\u3001FlashAir\u306eLua\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bfa.spi\u95a2\u6570\u306f\u4f7f\u308f\u305a\u3001D/A\u30b3\u30f3\u30d0\u30fc\u30bfMCP4922\u3068\u540c\u69d8\u306bfa.pio\u95a2\u6570\u3092\u4f7f\u3063\u3066\u5236\u5fa1\u3057\u3066\u3044\u307e\u3059\u3002fa.pio\u95a2\u6570\u306f\u305d\u306e\u307e\u307e\u3067\u306f\u4f7f\u3044\u3065\u3089\u3044\u306e\u3067\u3001@Seg_Faul\u3055\u3093\u304c\u516c\u958b\u3057\u3066\u3044\u308b\u30e9\u30a4\u30d6\u30e9\u30eaFlashAir\u306ePIO\u3092Arduino\u98a8\u306b\u6271\u3046\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002pioduino.lua\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u3001GLCDsample.lua\u3068\u540c\u3058\u30d5\u30a9\u30eb\u30c0\u306b\u914d\u7f6e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nGLCDsample.lua\n-- FlashAir\n-- AQM1248A 128x48 Graphic LCD\nrequire(\"pioduino\")\nDA_SCK  = 1  --0x02 0000 0010 --> SD-pin 7\nDA_SDI  = 0  --0x01 0000 0001 --> SD-pin 2\nDA_CS   = 2  --0x04 0000 0100 --> SD-pin 8\nDA_RS   = 4  --0x10 0001 0000 --> SD-pin 1\n\nfunction delay(value)\n    sleep(value)\nend\n\nfunction SPISend(value)\n    digitalWrite(DA_SDI, value)\n    digitalWrite(DA_SCK, HIGH)\n    digitalWrite(DA_SCK, LOW)\nend\n\nfunction LcdCommand(value)\n    --\u30b3\u30de\u30f3\u30c9\u30c7\u30fc\u30bf\u306e\u51fa\u529b\n    digitalWrite(DA_RS, LOW)\n    digitalWrite(DA_CS, LOW)\n    --8bit\u30c7\u30fc\u30bf\u51fa\u529b\n    for i=7, 0, -1 do\n        if (bit32.band(bit32.rshift(value, i), 0x01) == 1) then\n            SPISend(HIGH)\n        else\n            SPISend(LOW)\n        end\n    end\n    digitalWrite(DA_CS,HIGH)\nend\n\nfunction LcdData(value)\n    --\u30b3\u30de\u30f3\u30c9\u30c7\u30fc\u30bf\u306e\u51fa\u529b\n    digitalWrite(DA_RS, HIGH)\n    digitalWrite(DA_CS, LOW)\n    --8bit\u30c7\u30fc\u30bf\u51fa\u529b\n    for i=7, 0, -1 do\n        if (bit32.band(bit32.rshift(value, i), 0x01) == 1) then\n            SPISend(HIGH)\n        else\n            SPISend(LOW)\n        end\n    end\n    digitalWrite(DA_CS,HIGH)\nend\n\nfunction LCDInit()\n    LcdCommand(0xae) --Display = OFF\n    LcdCommand(0xa0) --ADC = nomal\n    LcdCommand(0xc8) --Common output = revers\n    LcdCommand(0xa3) --LCD bias set = 1/7\n\n    LcdCommand(0x2c) --power control 1 = 0N\n    delay(2);\n    LcdCommand(0x2e) --power control 2 = 0N\n    delay(2);\n    LcdCommand(0x2f) --power control 3 = 0N\n\n    LcdCommand(0x23) --Vo voltage resistor ration set\n    LcdCommand(0x81) --Electronic volume mode set\n    LcdCommand(0x1c) --Electronic volume value set\n    LcdCommand(0xa4) --Display all point = normal\n    LcdCommand(0x40) --Display start line = 0\n    LcdCommand(0xa6) --Display nomal/revers = normal\n    LcdCommand(0xaf) --Display = ON\nend\n\npinMode(DA_SCK, OUTPUT)\npinMode(DA_SDI, OUTPUT)\npinMode(DA_CS,  OUTPUT)\npinMode(DA_RS,  OUTPUT)\ndigitalWrite(DA_SCK,LOW)\ndelay(1000)\nLCDInit()\nwhile(1) do\n    for page = 0, 5 do\n        LcdCommand(0xb0+page); -- 1011 XXXX : XXXX = page address\n        LcdCommand(0x10);      -- 0001 0000 : Column address set upper bit = 0000\n        LcdCommand(0x00);      -- 0000 0000 : Column address set lower bit = 0000\n        for x = 0, 127 do\n            LcdData(0)\n        end\n    end\n    delay(1000)\n    for page = 0, 5 do\n        LcdCommand(0xb0+page);\n        LcdCommand(0x10);\n        LcdCommand(0x00);\n        for x = 0, 127 do\n            LcdData(x)\n        end\n    end\n    delay(1000)\n    collectgarbage(\"collect\")\nend\n\n\n\n\u307e\u3068\u3081\n\u3000\u4ee5\u4e0a\u3067\u3001FlashAir\u304b\u3089fa.pio\u95a2\u6570\u3092\u4f7f\u3063\u3066\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u6db2\u6676AQM1248A\u306e\u63cf\u753b\u3092\u5236\u5fa1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u3061\u3087\u3063\u3068\u66f8\u304d\u63db\u3048\u901f\u5ea6\u304c\u9045\u3044\u306e\u3067\u3059\u3051\u3069\u3002\u3053\u308c\u3092\u4f7f\u3063\u3066\u3001\u9244\u9053\u6a21\u578b\u306e\u30dd\u30a4\u30f3\u30c8\u5236\u5fa1\u88c5\u7f6e\u3067\u3001\u30dd\u30a4\u30f3\u30c8\u958b\u901a\u65b9\u5411\u306e\u8868\u793a\u306a\u3069\u3057\u3066\u3082\u9762\u767d\u3044\u304b\u306a\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u8cc7\u6599\n\u3000\u3057\u306a\u3077\u3059\u306e\u30cf\u30fc\u30c9\u88fd\u4f5c\u8a18 - Arduino\u7528\u30d8\u30c3\u30c0\u30b7\u30fc\u30eb\u30c9\u306e\u88fd\u4f5c(3)\n\u3000AQM1248A\u30c7\u30fc\u30bf\u30b7\u30fc\u30c8\n\u3000FlashAir\u306ePIO\u3092Arduino\u98a8\u306b\u6271\u3046\n\u3000FlashAir Developers Lua\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\u5148\u65e5\u3001\u79cb\u8449\u539f\u306e\u79cb\u6708\u96fb\u5b50\u3055\u3093\u5e97\u982d\u3067\u3001\u306a\u3093\u3068\u306a\u304f\u76ee\u306b\u5165\u3063\u3066\u8cb7\u3063\u3066\u307f\u305f\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\uff2c\uff23\uff24\u30d4\u30c3\u30c1\u5909\u63db\u30ad\u30c3\u30c8AE-AQM1248\uff08SPI\u63a5\u7d9a\u306e\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u6db2\u6676AQM1248A\u642d\u8f09\uff09\u3092\u3001FlashAir\u3067\u5236\u5fa1\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n#FlashAir W-03\u306eLua\u30b9\u30af\u30ea\u30d7\u30c8\u5b9f\u884c\u74b0\u5883\n\u3000FlashAir W-03\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001SD\u30ab\u30fc\u30c9\u4e0a\u3067Lua\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002Lua\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u306f\u3001FlashAir\u306eGPIO\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u3001\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2SPI\u306b\u3088\u308aSPI\u30c7\u30d0\u30a4\u30b9\u3092\u5236\u5fa1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u308c\u307e\u3067\u3001[D/A\u30b3\u30f3\u30d0\u30fc\u30bfMCP4922](http://qiita.com/ayasehiro/items/1b03a24b463b67f31c32)\u3084[IO\u30a8\u30ad\u30b9\u30d1\u30f3\u30c0MCP23S17](http://qiita.com/ayasehiro/items/778d15bb4ee1c2a218c8)\u3092\u5236\u5fa1\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u4eca\u56de\u306f\u3001FlashAir\u3067\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u6db2\u6676AQM1248A\u3092\u5236\u5fa1\u3057\u3066\u307f\u307e\u3059\u3002\n\n#\u69cb\u6210\n\u3000\u5fc5\u8981\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n- FlashAir W-03 V3.00.01\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u6e08\u307f\u306e\u3082\u306e\n- \u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\uff2c\uff23\uff24\u30d4\u30c3\u30c1\u5909\u63db\u30ad\u30c3\u30c8AE-AQM1248\uff08[\u79cb\u6708\u96fb\u5b50\u901a\u5546](http://akizukidenshi.com/catalog/g/gK-07007/)\uff09\n- SD\u30ab\u30fc\u30c9\u30b9\u30ed\u30c3\u30c8\uff08[\u30ab\u30fc\u30c9\u30bd\u30b1\u30c3\u30c8SD-N0940](http://www.aitendo.com/product/1194)\u3092DIP\u5316\uff09\n- 3.3V\u5b9a\u96fb\u5727\u30ec\u30ae\u30e5\u30ec\u30fc\u30bf\uff08[\u79cb\u6708\u96fb\u5b50\u901a\u5546](http://akizukidenshi.com/catalog/g/gI-00538/)\uff09\n- \u30d6\u30ec\u30c3\u30c9\u30dc\u30fc\u30c9\n- AC\u30a2\u30c0\u30d7\u30bf\uff085V\uff09:\u624b\u6301\u3061\u306e\u3082\u306e\u3092\u5229\u7528\n\n![IMG_9328s.jpg](https://qiita-image-store.s3.amazonaws.com/0/89137/0e5e9c75-17ce-011f-9380-d1f97c4aeb8f.jpeg)\n\n###SD\u30ab\u30fc\u30c9\u30b9\u30ed\u30c3\u30c8\n\u3000SD\u30ab\u30fc\u30c9\u30b9\u30ed\u30c3\u30c8\u306f\u306a\u3093\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\u304c\u3001\u4eca\u56de\u306fSD\u30ab\u30fc\u30c9\u306e1\u756a\u30012\u756a\u30017\u756a\u30018\u756a\u30d4\u30f3\u3092\u5f15\u304d\u51fa\u305b\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n###FlashAir\u3068AE-AQM1248\u306e\u63a5\u7d9a\n\u3000FlashAir\u3068AE-AQM1248\u306e\u63a5\u7d9a\u306f\u3001\u4ee5\u4e0b\u306e\u8868\u306b\u793a\u3059\u901a\u308a\u306b\u63a5\u7d9a\u3057\u307e\u3059\u3002\n\n![FlashAir_AQM1248_pinasign.png](https://qiita-image-store.s3.amazonaws.com/0/89137/4b7c29dd-b5c8-3caa-68ac-7a1dec05cec5.png)\n\n#CONFIG\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\u3000FlashAir\u306eSD_WLAN\u30d5\u30a9\u30eb\u30c0\u5185\u306eCONFIG\u30d5\u30a1\u30a4\u30eb\u306b\u3001\u4ee5\u4e0b\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002IFMODE\u306fFlashAir\u306eGPIO\u30e2\u30fc\u30c9\u3092ON\u306b\u3057\u3066\u3044\u307e\u3059\u3002LUA_RUN_SCRIPT\u306fFlashAir\u306e\u96fb\u6e90\u6295\u5165\u5f8c\u3059\u3050\u306b\u6307\u5b9a\u306eLua\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3067\u3059\u3002\n```IFMODE=1\nLUA_RUN_SCRIPT=/GLCDsample.lua\n```\n\n\u3000\u203bSD_WLAN\u30d5\u30a9\u30eb\u30c0\u3068CONFIG\u30d5\u30a1\u30a4\u30eb\u306f\u4e0d\u53ef\u8996\u5c5e\u6027\u30d5\u30a1\u30a4\u30eb\u306a\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n#Lua\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\n\u3000FlashAir\u306e\u30eb\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u306b\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\uff08GLCDsample.lua\uff09\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\u3000\u3053\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001\u307e\u305a\u306f\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u6db2\u6676\u304c\u3069\u306e\u7a0b\u5ea6\u306e\u901f\u5ea6\u3067\u66f8\u304d\u63db\u3048\u3089\u308c\u308b\u306e\u304b\u3092\u8a66\u3059\u305f\u3081\u3001\u5168\u9762\u306b\u30d3\u30c3\u30c8\u30d1\u30bf\u30fc\u30f3\u3092\u63cf\u3044\u3066\u3001\u6d88\u3059\u3053\u3068\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\u3053\u306e\u30b3\u30fc\u30c9\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\n[\u3057\u306a\u3077\u3059\u306e\u30cf\u30fc\u30c9\u88fd\u4f5c\u8a18 - Arduino\u7528\u30d8\u30c3\u30c0\u30b7\u30fc\u30eb\u30c9\u306e\u88fd\u4f5c(3)](http://www3.big.or.jp/~schaft/hardware/HeaderShield/page003.html)\n\n\u3000\u4eca\u56de\u8a66\u3057\u305fAQM1248A\u306fSPI\u63a5\u7d9a\u5bfe\u5fdc\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u30b3\u30de\u30f3\u30c9\u9001\u4fe1\u3068\u30c7\u30fc\u30bf\u9001\u4fe1\u306e\u533a\u5225\u3092\u3059\u308b\u305f\u3081\u306bRS\u7aef\u5b50\u306eHIGH/LOW\u3092\u5236\u5fa1\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u305f\u3081\u3001FlashAir\u306eLua\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308bfa.spi\u95a2\u6570\u306f\u4f7f\u308f\u305a\u3001[D/A\u30b3\u30f3\u30d0\u30fc\u30bfMCP4922](http://qiita.com/ayasehiro/items/1b03a24b463b67f31c32)\u3068\u540c\u69d8\u306bfa.pio\u95a2\u6570\u3092\u4f7f\u3063\u3066\u5236\u5fa1\u3057\u3066\u3044\u307e\u3059\u3002fa.pio\u95a2\u6570\u306f\u305d\u306e\u307e\u307e\u3067\u306f\u4f7f\u3044\u3065\u3089\u3044\u306e\u3067\u3001@Seg_Faul\u3055\u3093\u304c\u516c\u958b\u3057\u3066\u3044\u308b\u30e9\u30a4\u30d6\u30e9\u30ea[FlashAir\u306ePIO\u3092Arduino\u98a8\u306b\u6271\u3046](https://sites.google.com/site/gpsnmeajp/electricmemo/flashairnopiowoarduino-fengni-xiu)\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002pioduino.lua\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u3001GLCDsample.lua\u3068\u540c\u3058\u30d5\u30a9\u30eb\u30c0\u306b\u914d\u7f6e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n```GLCDsample.lua\n-- FlashAir\n-- AQM1248A 128x48 Graphic LCD\nrequire(\"pioduino\")\nDA_SCK  = 1  --0x02 0000 0010 --> SD-pin 7\nDA_SDI  = 0  --0x01 0000 0001 --> SD-pin 2\nDA_CS   = 2  --0x04 0000 0100 --> SD-pin 8\nDA_RS   = 4  --0x10 0001 0000 --> SD-pin 1\n\nfunction delay(value)\n\tsleep(value)\nend\n\nfunction SPISend(value)\n\tdigitalWrite(DA_SDI, value)\n\tdigitalWrite(DA_SCK, HIGH)\n\tdigitalWrite(DA_SCK, LOW)\nend\n\nfunction LcdCommand(value)\n\t--\u30b3\u30de\u30f3\u30c9\u30c7\u30fc\u30bf\u306e\u51fa\u529b\n\tdigitalWrite(DA_RS, LOW)\n\tdigitalWrite(DA_CS, LOW)\n\t--8bit\u30c7\u30fc\u30bf\u51fa\u529b\n\tfor i=7, 0, -1 do\n\t\tif (bit32.band(bit32.rshift(value, i), 0x01) == 1) then\n\t\t\tSPISend(HIGH)\n\t\telse\n\t\t\tSPISend(LOW)\n\t\tend\n\tend\n\tdigitalWrite(DA_CS,HIGH)\nend\n\nfunction LcdData(value)\n\t--\u30b3\u30de\u30f3\u30c9\u30c7\u30fc\u30bf\u306e\u51fa\u529b\n\tdigitalWrite(DA_RS, HIGH)\n\tdigitalWrite(DA_CS, LOW)\n\t--8bit\u30c7\u30fc\u30bf\u51fa\u529b\n\tfor i=7, 0, -1 do\n\t\tif (bit32.band(bit32.rshift(value, i), 0x01) == 1) then\n\t\t\tSPISend(HIGH)\n\t\telse\n\t\t\tSPISend(LOW)\n\t\tend\n\tend\n\tdigitalWrite(DA_CS,HIGH)\nend\n\nfunction LCDInit()\n \tLcdCommand(0xae) --Display = OFF\n\tLcdCommand(0xa0) --ADC = nomal\n\tLcdCommand(0xc8) --Common output = revers\n\tLcdCommand(0xa3) --LCD bias set = 1/7\n\t\n\tLcdCommand(0x2c) --power control 1 = 0N\n\tdelay(2);\n\tLcdCommand(0x2e) --power control 2 = 0N\n\tdelay(2);\n\tLcdCommand(0x2f) --power control 3 = 0N\n\t\n\tLcdCommand(0x23) --Vo voltage resistor ration set\n\tLcdCommand(0x81) --Electronic volume mode set\n\tLcdCommand(0x1c) --Electronic volume value set\n\tLcdCommand(0xa4) --Display all point = normal\n\tLcdCommand(0x40) --Display start line = 0\n\tLcdCommand(0xa6) --Display nomal/revers = normal\n\tLcdCommand(0xaf) --Display = ON\nend\n\npinMode(DA_SCK, OUTPUT)\npinMode(DA_SDI, OUTPUT)\npinMode(DA_CS,  OUTPUT)\npinMode(DA_RS,  OUTPUT)\ndigitalWrite(DA_SCK,LOW)\ndelay(1000)\nLCDInit()\nwhile(1) do\n\tfor page = 0, 5 do\n\t\tLcdCommand(0xb0+page); -- 1011 XXXX : XXXX = page address\n    \tLcdCommand(0x10);      -- 0001 0000 : Column address set upper bit = 0000\n    \tLcdCommand(0x00);      -- 0000 0000 : Column address set lower bit = 0000\n\t\tfor x = 0, 127 do\n\t\t\tLcdData(0)\n\t\tend\n\tend\n\tdelay(1000)\n\tfor page = 0, 5 do\n\t\tLcdCommand(0xb0+page);\n    \tLcdCommand(0x10);\n    \tLcdCommand(0x00);\n\t\tfor x = 0, 127 do\n\t\t\tLcdData(x)\n\t\tend\n\tend\n\tdelay(1000)\n\tcollectgarbage(\"collect\")\nend\n```\n\n#\u307e\u3068\u3081\n\u3000\u4ee5\u4e0a\u3067\u3001FlashAir\u304b\u3089fa.pio\u95a2\u6570\u3092\u4f7f\u3063\u3066\u8d85\u5c0f\u578b\u30b0\u30e9\u30d5\u30a3\u30c3\u30af\u6db2\u6676AQM1248A\u306e\u63cf\u753b\u3092\u5236\u5fa1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u3061\u3087\u3063\u3068\u66f8\u304d\u63db\u3048\u901f\u5ea6\u304c\u9045\u3044\u306e\u3067\u3059\u3051\u3069\u3002\u3053\u308c\u3092\u4f7f\u3063\u3066\u3001\u9244\u9053\u6a21\u578b\u306e\u30dd\u30a4\u30f3\u30c8\u5236\u5fa1\u88c5\u7f6e\u3067\u3001\u30dd\u30a4\u30f3\u30c8\u958b\u901a\u65b9\u5411\u306e\u8868\u793a\u306a\u3069\u3057\u3066\u3082\u9762\u767d\u3044\u304b\u306a\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n#\u53c2\u8003\u8cc7\u6599\n\u3000[\u3057\u306a\u3077\u3059\u306e\u30cf\u30fc\u30c9\u88fd\u4f5c\u8a18 - Arduino\u7528\u30d8\u30c3\u30c0\u30b7\u30fc\u30eb\u30c9\u306e\u88fd\u4f5c(3)](http://www3.big.or.jp/~schaft/hardware/HeaderShield/page003.html)\n\u3000[AQM1248A\u30c7\u30fc\u30bf\u30b7\u30fc\u30c8](hhttp://akizukidenshi.com/download/ds/xiamen/AQM1248.pdf)\n\u3000[FlashAir\u306ePIO\u3092Arduino\u98a8\u306b\u6271\u3046](https://sites.google.com/site/gpsnmeajp/electricmemo/flashairnopiowoarduino-fengni-xiu)\n\u3000[FlashAir Developers Lua\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9](https://flashair-developers.com/ja/documents/api/lua/reference/)\n"}