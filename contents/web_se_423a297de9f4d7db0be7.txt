{"context": "aws cli\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u4e0b\u8a18\u3067\u3002\n\n$ aws --version\naws-cli/1.6.10 Python/2.6.9 Linux/3.10.57-57.140.amzn1.x86_64\n\n\u203baws-cli\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066\u306fgenerate-cli-skeleton\u304c\u4f7f\u3048\u306a\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002AmazonLinux 2014.03.02\u3067\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u53ef\u80fd\u306a1.4.4\u3067\u306f\u52d5\u4f5c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\ncli-input-json\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u53d6\u5f97\u3059\u308b\n$ aws autoscaling create-launch-configuration --generate-cli-skeleton   --region ap-southeast-2\n{\n    \"LaunchConfigurationName\": \"\",\n    \"ImageId\": \"\",\n    \"KeyName\": \"\",\n    \"SecurityGroups\": [\n        \"\"\n    ],\n    \"UserData\": \"\",\n    \"InstanceId\": \"\",\n    \"InstanceType\": \"\",\n    \"KernelId\": \"\",\n    \"RamdiskId\": \"\",\n    \"BlockDeviceMappings\": [\n        {\n            \"VirtualName\": \"\",\n            \"DeviceName\": \"\",\n            \"Ebs\": {\n                \"SnapshotId\": \"\",\n                \"VolumeSize\": 0,\n                \"VolumeType\": \"\",\n                \"DeleteOnTermination\": true,\n                \"Iops\": 0\n            },\n            \"NoDevice\": true\n        }\n    ],\n    \"InstanceMonitoring\": {\n        \"Enabled\": true\n    },\n    \"SpotPrice\": \"\",\n    \"IamInstanceProfile\": \"\",\n    \"EbsOptimized\": true,\n    \"AssociatePublicIpAddress\": true,\n    \"PlacementTenancy\": \"\"\n}\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u3068\u304bephemeral disk\u3068\u304b\u8a2d\u5b9a\u3059\u308b\u3082\u306e\u3092input.json\u306b\u8a18\u8f09\u3059\u308b\n{\n    \"LaunchConfigurationName\": \"aslc-stg-lctest\",\n    \"ImageId\": \"ami-XXXXXX\",\n    \"SecurityGroups\": [\n                \"sg-XXXXXX\"\n     ],\n    \"InstanceType\": \"m3.medium\",\n    \"BlockDeviceMappings\": [\n                {\n                    \"DeviceName\": \"/dev/sdb\",\n                    \"VirtualName\": \"ephemeral0\"\n                },\n                {\n                    \"DeviceName\": \"/dev/xvda\",\n                    \"Ebs\": {\n                        \"DeleteOnTermination\": true,\n                        \"VolumeSize\": 30,\n                        \"VolumeType\": \"gp2\"\n                    }\n                }\n            ],\n    \"InstanceMonitoring\": {\n        \"Enabled\": false\n    },\n    \"IamInstanceProfile\": \"role-XXXXXXX\",\n    \"EbsOptimized\": false,\n    \"AssociatePublicIpAddress\": true\n}\n\nUser-Data (cloud-init script)\u306f\u3001input.json\u306e\u4e2d\u306b\u306f\u5165\u308c\u3089\u308c\u306a\u3044\u3067\u3001--user-data\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\naws autoscaling create-launch-configuration  --cli-input-json file://input.json  --user-data file://userdata.sh  --region ap-southeast-2\n\nIAM Role\u3092IamInstanceProfile\u306b\u6307\u5b9a\u3059\u308b\u5834\u5408\u3001create-launch-configuration\u3092\u5b9f\u884c\u3059\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067IAM Role\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u6a29\u9650\u304c\u5fc5\u8981\u3067\u3059\u3002\n{\n    \"AutoScalingGroupName\": \"asg-stg-lctest\",\n    \"LaunchConfigurationName\": \"aslc-stg-lctest\",\n    \"MinSize\": 0,\n    \"MaxSize\": 1,\n    \"DesiredCapacity\": 1,\n    \"DefaultCooldown\": 0,\n    \"AvailabilityZones\": [\n        \"ap-southeast-2a\"\n    ],\n    \"HealthCheckType\": \"EC2\",\n    \"HealthCheckGracePeriod\": 300,\n    \"VPCZoneIdentifier\":  \"subnet-XXXXX\",\n    \"TerminationPolicies\": [\n        \"Default\"\n    ]\n}\n\nAvailabilityZones\u3068VPCZoneIdentifier\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308bAZ\u3068subnet\u304c\u30de\u30c3\u30c1\u3057\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nAutoScaling Group\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\naws autoscaling create-auto-scaling-group --cli-input-json file://asg-test.json --region ap-southeast-2\n\n\u6b21\u306f\u3001AutoScaling Group\u306e\u4e00\u90e8\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u66f4\u65b0\u3057\u307e\u3059\u3002\n{\n    \"AutoScalingGroupName\": \"asg-stg-lctest\",\n    \"LaunchConfigurationName\": \"aslc-stg-lctest-01\",\n    \"DesiredCapacity\": 0\n}\n\naws autoscaling update-auto-scaling-group --cli-input-json file://asg-u-test.json  --region ap-southeast-2\n\nAutoScaling Group\u3067\u8907\u6570AvailabilityZone\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bcli-input-json\u3092\u66f8\u304d\u307e\u3059\u3002VPCZoneIdentifier\u306e\u66f8\u304d\u65b9\u304cAvailabilityZone\u3068\u9055\u3046\u306e\u3067\u6ce8\u610f\u3002\n{\n    \"AutoScalingGroupName\": \"asg-stg-lctest-02\",\n    \"LaunchConfigurationName\": \"aslc-stg-lctest-01\",\n    \"MinSize\": 0,\n    \"MaxSize\": 1,\n    \"DesiredCapacity\": 1,\n    \"DefaultCooldown\": 0,\n    \"AvailabilityZones\": [\n        \"ap-southeast-2a\",\n        \"ap-southeast-2b\"\n    ],\n    \"HealthCheckType\": \"EC2\",\n    \"HealthCheckGracePeriod\": 300,\n    \"VPCZoneIdentifier\": \"subnet-XXXXXX,subnet-YYYYYY\",\n    \"TerminationPolicies\": [\n        \"Default\"\n    ]\n}\n\naws cli\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u4e0b\u8a18\u3067\u3002\n```\n$ aws --version\naws-cli/1.6.10 Python/2.6.9 Linux/3.10.57-57.140.amzn1.x86_64\n```\n\u203baws-cli\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066\u306fgenerate-cli-skeleton\u304c\u4f7f\u3048\u306a\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002AmazonLinux 2014.03.02\u3067\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u53ef\u80fd\u306a1.4.4\u3067\u306f\u52d5\u4f5c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\ncli-input-json\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u53d6\u5f97\u3059\u308b\n\n```\n$ aws autoscaling create-launch-configuration --generate-cli-skeleton   --region ap-southeast-2\n{\n    \"LaunchConfigurationName\": \"\",\n    \"ImageId\": \"\",\n    \"KeyName\": \"\",\n    \"SecurityGroups\": [\n        \"\"\n    ],\n    \"UserData\": \"\",\n    \"InstanceId\": \"\",\n    \"InstanceType\": \"\",\n    \"KernelId\": \"\",\n    \"RamdiskId\": \"\",\n    \"BlockDeviceMappings\": [\n        {\n            \"VirtualName\": \"\",\n            \"DeviceName\": \"\",\n            \"Ebs\": {\n                \"SnapshotId\": \"\",\n                \"VolumeSize\": 0,\n                \"VolumeType\": \"\",\n                \"DeleteOnTermination\": true,\n                \"Iops\": 0\n            },\n            \"NoDevice\": true\n        }\n    ],\n    \"InstanceMonitoring\": {\n        \"Enabled\": true\n    },\n    \"SpotPrice\": \"\",\n    \"IamInstanceProfile\": \"\",\n    \"EbsOptimized\": true,\n    \"AssociatePublicIpAddress\": true,\n    \"PlacementTenancy\": \"\"\n}\n```\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u3068\u304bephemeral disk\u3068\u304b\u8a2d\u5b9a\u3059\u308b\u3082\u306e\u3092input.json\u306b\u8a18\u8f09\u3059\u308b\n\n```\n{\n    \"LaunchConfigurationName\": \"aslc-stg-lctest\",\n    \"ImageId\": \"ami-XXXXXX\",\n    \"SecurityGroups\": [\n                \"sg-XXXXXX\"\n     ],\n    \"InstanceType\": \"m3.medium\",\n    \"BlockDeviceMappings\": [\n                {\n                    \"DeviceName\": \"/dev/sdb\",\n                    \"VirtualName\": \"ephemeral0\"\n                },\n                {\n                    \"DeviceName\": \"/dev/xvda\",\n                    \"Ebs\": {\n                        \"DeleteOnTermination\": true,\n                        \"VolumeSize\": 30,\n                        \"VolumeType\": \"gp2\"\n                    }\n                }\n            ],\n    \"InstanceMonitoring\": {\n        \"Enabled\": false\n    },\n    \"IamInstanceProfile\": \"role-XXXXXXX\",\n    \"EbsOptimized\": false,\n    \"AssociatePublicIpAddress\": true\n}\n```\n\nUser-Data (cloud-init script)\u306f\u3001input.json\u306e\u4e2d\u306b\u306f\u5165\u308c\u3089\u308c\u306a\u3044\u3067\u3001--user-data\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```\naws autoscaling create-launch-configuration  --cli-input-json file://input.json  --user-data file://userdata.sh  --region ap-southeast-2\n```\n\nIAM Role\u3092IamInstanceProfile\u306b\u6307\u5b9a\u3059\u308b\u5834\u5408\u3001create-launch-configuration\u3092\u5b9f\u884c\u3059\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067IAM Role\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u6a29\u9650\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\n\n```\n{\n    \"AutoScalingGroupName\": \"asg-stg-lctest\",\n    \"LaunchConfigurationName\": \"aslc-stg-lctest\",\n    \"MinSize\": 0,\n    \"MaxSize\": 1,\n    \"DesiredCapacity\": 1,\n    \"DefaultCooldown\": 0,\n    \"AvailabilityZones\": [\n        \"ap-southeast-2a\"\n    ],\n    \"HealthCheckType\": \"EC2\",\n    \"HealthCheckGracePeriod\": 300,\n    \"VPCZoneIdentifier\":  \"subnet-XXXXX\",\n    \"TerminationPolicies\": [\n        \"Default\"\n    ]\n}\n```\nAvailabilityZones\u3068VPCZoneIdentifier\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308bAZ\u3068subnet\u304c\u30de\u30c3\u30c1\u3057\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nAutoScaling Group\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\naws autoscaling create-auto-scaling-group --cli-input-json file://asg-test.json --region ap-southeast-2\n```\n\n\u6b21\u306f\u3001AutoScaling Group\u306e\u4e00\u90e8\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u66f4\u65b0\u3057\u307e\u3059\u3002\n\n```\n{\n    \"AutoScalingGroupName\": \"asg-stg-lctest\",\n    \"LaunchConfigurationName\": \"aslc-stg-lctest-01\",\n    \"DesiredCapacity\": 0\n}\n```\n\n```\naws autoscaling update-auto-scaling-group --cli-input-json file://asg-u-test.json  --region ap-southeast-2\n```\n\nAutoScaling Group\u3067\u8907\u6570AvailabilityZone\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bcli-input-json\u3092\u66f8\u304d\u307e\u3059\u3002VPCZoneIdentifier\u306e\u66f8\u304d\u65b9\u304cAvailabilityZone\u3068\u9055\u3046\u306e\u3067\u6ce8\u610f\u3002\n\n```\n{\n    \"AutoScalingGroupName\": \"asg-stg-lctest-02\",\n    \"LaunchConfigurationName\": \"aslc-stg-lctest-01\",\n    \"MinSize\": 0,\n    \"MaxSize\": 1,\n    \"DesiredCapacity\": 1,\n    \"DefaultCooldown\": 0,\n    \"AvailabilityZones\": [\n        \"ap-southeast-2a\",\n        \"ap-southeast-2b\"\n    ],\n    \"HealthCheckType\": \"EC2\",\n    \"HealthCheckGracePeriod\": 300,\n    \"VPCZoneIdentifier\": \"subnet-XXXXXX,subnet-YYYYYY\",\n    \"TerminationPolicies\": [\n        \"Default\"\n    ]\n}\n```\n", "tags": ["aws-cli", "AWS"]}