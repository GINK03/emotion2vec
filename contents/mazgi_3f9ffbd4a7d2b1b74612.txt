{"tags": ["JSX", "adobe", "photoshopCS6"], "context": " More than 1 year has passed since last update.\u3053\u3093\u306a\u30af\u30e9\u30b9\u3092\u7528\u610f\u3057\u3066\u3001\n#target photoshop\n\nvar PSLayerUtil = function() {\n  this._colorRef = new ActionReference();\n  this._colorRef.putEnumerated(charIDToTypeID('Lyr '), charIDToTypeID('Ordn'), charIDToTypeID('Trgt'));\n}\nPSLayerUtil.LayerColors = {\n  Red: 'Rd  ',\n  Orange: 'Orng',\n  Yellow: 'Ylw ',\n  Green: 'Grn ',\n  Blue: 'Bl  ',\n  Violet: 'Vlt ',\n  Gray: 'Gry ',\n  None: 'None',\n};\nPSLayerUtil.prototype = {\n  _colorRef: null,\n  setLayerColor: function(layerColor) {\n    var colorDescriptor = new ActionDescriptor();\n    colorDescriptor.putEnumerated(charIDToTypeID('Clr '), charIDToTypeID('Clr '), charIDToTypeID(layerColor));\n    var desc = new ActionDescriptor();\n    desc.putReference(charIDToTypeID('null'), this._colorRef);\n    desc.putObject(charIDToTypeID('T   '), charIDToTypeID('Lyr '), colorDescriptor);\n    executeAction(charIDToTypeID('setd'), desc, DialogModes.NO);\n    return this.layerColor();\n  },\n  layerColor: function() {\n    var desc = executeActionGet(this._colorRef);\n    var charID = typeIDToCharID(desc.getEnumerationValue(charIDToTypeID('Clr ')));\n    for(var key in PSLayerUtil.LayerColors) {\n      var value = PSLayerUtil.LayerColors[key];\n      if(value === charID) return key;\n    }\n    return 'None';\n  },\n}\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u5b9f\u884c\u3059\u308c\u3070\u3001\nvar util = new PSLayerUtil();\nalert(util.setLayerColor(PSLayerUtil.LayerColors.Red));\n\n\u9078\u629e\u3057\u3066\u308b\u30ec\u30a4\u30e4\u30fc\u306b\u30ab\u30e9\u30fc\u30e9\u30d9\u30eb\u304c\u4ed8\u304f\u3089\u3057\u3044\u3002\n\u3067\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067GitHub\u3067\u516c\u958b\u3057\u3066\u307f\u305f\u3002\n\u3053\u3093\u306a\u30af\u30e9\u30b9\u3092\u7528\u610f\u3057\u3066\u3001\n\n```js:\n#target photoshop\n\nvar PSLayerUtil = function() {\n  this._colorRef = new ActionReference();\n  this._colorRef.putEnumerated(charIDToTypeID('Lyr '), charIDToTypeID('Ordn'), charIDToTypeID('Trgt'));\n}\nPSLayerUtil.LayerColors = {\n  Red: 'Rd  ',\n  Orange: 'Orng',\n  Yellow: 'Ylw ',\n  Green: 'Grn ',\n  Blue: 'Bl  ',\n  Violet: 'Vlt ',\n  Gray: 'Gry ',\n  None: 'None',\n};\nPSLayerUtil.prototype = {\n  _colorRef: null,\n  setLayerColor: function(layerColor) {\n    var colorDescriptor = new ActionDescriptor();\n    colorDescriptor.putEnumerated(charIDToTypeID('Clr '), charIDToTypeID('Clr '), charIDToTypeID(layerColor));\n    var desc = new ActionDescriptor();\n    desc.putReference(charIDToTypeID('null'), this._colorRef);\n    desc.putObject(charIDToTypeID('T   '), charIDToTypeID('Lyr '), colorDescriptor);\n    executeAction(charIDToTypeID('setd'), desc, DialogModes.NO);\n    return this.layerColor();\n  },\n  layerColor: function() {\n    var desc = executeActionGet(this._colorRef);\n    var charID = typeIDToCharID(desc.getEnumerationValue(charIDToTypeID('Clr ')));\n    for(var key in PSLayerUtil.LayerColors) {\n      var value = PSLayerUtil.LayerColors[key];\n      if(value === charID) return key;\n    }\n    return 'None';\n  },\n}\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u5b9f\u884c\u3059\u308c\u3070\u3001\n\n```js:\nvar util = new PSLayerUtil();\nalert(util.setLayerColor(PSLayerUtil.LayerColors.Red));\n```\n\n\u9078\u629e\u3057\u3066\u308b\u30ec\u30a4\u30e4\u30fc\u306b\u30ab\u30e9\u30fc\u30e9\u30d9\u30eb\u304c\u4ed8\u304f\u3089\u3057\u3044\u3002\n\u3067\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067[GitHub](https://github.com/mazgi/Anice/wiki)\u3067\u516c\u958b\u3057\u3066\u307f\u305f\u3002\n"}