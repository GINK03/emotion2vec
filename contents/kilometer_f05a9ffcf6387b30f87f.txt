{"context": "Mahalanobis'\u8ddd\u96e2\u3068\u78ba\u7387\u6955\u5186\u306e\u95a2\u4fc2\u3092\u66f8\u3053\u3046\u3068\u601d\u3063\u305f\u3089\u3001\n\u601d\u3044\u306e\u5916\u3001\u7406\u8ad6\u7684\u80cc\u666f\u304c\u9577\u304f\u306a\u3063\u305f\u306e\u3067\u3053\u3053\u3067\u5206\u3051\u3066\u304a\u304d\u307e\u3059\u3002\n\nMahalanobis' Distance\n\u70b9X\u3068\u7fa4A\u306e\u30de\u30cf\u30e9\u30ce\u30d3\u30b9\u8ddd\u96e2\u306f\u3001\u4e0b\u8a18\u3067\u5b9a\u7fa9\u3055\u308c\u308b\u3002\nD_{Mahalanobis}^2 = (X-\\bar{A})^t cov(A) ^{-1}(X-\\bar{A})\u3000\\\\\n\\ \\\\\n\\begin{eqnarray}\ncov(A):& &variance\\ covariance\\ matrix \\\\\n\\bar{A}:& &mean(A)\\\\\n^t:& &transported\\ matrix\\\\ \n^{-1}:& &inverse\\ matrix \\\\\n\\end{eqnarray}\n\n\n\u6982\u5ff5\n2\u6b21\u5143\u306e\u5834\u5408\u3092\u8003\u3048\u308b\u3002\n\u524d\u56de\u7d39\u4ecb\u3057\u305f\u78ba\u7387\u6955\u5186\u306e\u8003\u3048\u65b9\u3092\u62bc\u3055\u3048\u3066\u304a\u304f\u3002\n\n\u4e8c\u6b21\u5143\u6b63\u898f\u5206\u5e03\u3092\u4f8b\u306b\u3057\u3066\u3001\u4e2d\u5fc3\u304b\u3089hoge%\u306e\u30d7\u30ed\u30c3\u30c8\u304c\u542b\u307e\u308c\u308b\u7bc4\u56f2\u3092\u63cf\u753b\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n(R\u30b3\u30fc\u30c9\u306fAppendix-1)\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001\u540c\u3058\u8272\u306e\u6955\u5186\u4e0a\u306e\u70b9\u306f\u540c\u7b49\u306b\u6271\u3044\u305f\u3044\u3001\u3068\u3044\u3046\u4e8b\u3067\u3059\u3002\n\u3053\u306e\u307e\u307e\u3067\u306f\u3001\u5206\u5e03\u306e\u4e2d\u5fc3(\u539f\u70b9)\u304b\u3089\u306e\u8ddd\u96e2\u304c\u5747\u7b49\u3067\u306f\u306a\u3044\u3002\n\u305d\u3053\u3067\u3001\u88dc\u6b63\u3092\u304b\u3051\u3066\u4e0b\u56f3\u306e\u3088\u3046\u306b\u5909\u63db\u3057\u305f\u3044\u3002\n\n2\u3064\u306e\u88dc\u6b63\u3092\u884c\u3044\u307e\u3059\u3002\n\u30fb\"\u9577\u8ef8\"\u3092X\u8ef8\u3001\"\u77ed\u8ef8\"\u3092Y\u8ef8\u306b\u4e00\u81f4\u3059\u308b\u3088\u3046\u306b\u56de\u8ee2\u88dc\u6b63\n\u30fb\u5404\u8ef8\u65b9\u5411\u306b\u5206\u6563=1\u306b\u306a\u308b\u3088\u3046\u306b\u88dc\u6b63\n\u3067\u3001\u88dc\u6b63\u5f8c\u306e\u30d7\u30ed\u30c3\u30c8\u3068\u4e2d\u5fc3\u306e\u8ddd\u96e2\u306e\u3053\u3068\u3092\u3001Mahalanobis'\u8ddd\u96e2\u3068\u8a00\u3044\u307e\u3059\u3002\n\u52d8\u6240\u306e\u92ed\u3044\u30d2\u30c8\u306f\u3001\u3053\u308c\u3063\u3066\u4e3b\u6210\u5206\u5206\u6790\u3058\u3083\u3093\u3001\u3068\u601d\u3046\u306f\u305a\u3067\u3059\u3002\n\u305d\u306e\u901a\u308a\u3001\u3067\u3057\u3066\u3001Mahalanobis'\u8ddd\u96e2\u3092\u6c42\u3081\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u5206\u6563\u5171\u5206\u6563\u884c\u5217\u306b\u57fa\u3065\u304f\u4e3b\u6210\u5206\u5206\u6790\u3092\u3057\u3066\u3001\u305d\u306e\u4e3b\u6210\u5206\u3067\u30d7\u30ed\u30c3\u30c8\u3092\u30b9\u30b1\u30fc\u30eb\u3059\u308b\u3001\u3068\u3044\u3046\u4e8b\u3068\u540c\u7b49\u306e\u64cd\u4f5c\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u6570\u5b66\u7684\u610f\u5473\n\n\u6295\u5c04\u5148\u306e\u8ef8\u4e0a\u306e\u5206\u6563\n\u5ea7\u6a19(X, Y)\u3092\u03b8\u5ea6\u56de\u8ee2\u3055\u305b\u305f\u5ea7\u6a19(X',Y')\u306f\u3001\n\\begin{eqnarray}\nX' &=& &cos\u03b8*X &+ sin\u03b8*Y \\\\\nY' &=& -&sin\u03b8*X &+ cos\u03b8*Y\n\\end{eqnarray}\n\n\u3064\u307e\u308a\u56de\u8ee2\u3057\u305f\u3044\u5411\u304d\u306e\u65b9\u5411\u30d9\u30af\u30c8\u30eb(cos\u03b8, sin\u03b8)\u304c\u5206\u304b\u308c\u3070\u826f\u3044\u3002\n\u3069\u3046\u3084\u3063\u3066\u03b8\u3092\u6c7a\u5b9a\u3059\u308c\u3070\u826f\u3044\u304b\u3068\u3044\u3046\u3068\u3001\u5206\u5e03\u306e\"\u9577\u8ef8\"\u306a\u308f\u3051\u306a\u306e\u3067\u3001\n\u305d\u306e\u8ef8\u306b\u6295\u5c04\u3057\u305f\u6642\u306b\u5206\u6563\u304c\u6700\u5927\u306b\u306a\u308b\u8ef8\u3092\u9078\u3079\u3070\u826f\u3044\u3002\n\u5c11\u3057\u8a18\u53f7\u3092\u5909\u3048\u3066\u3001\u6295\u5c04\u524d\u5ea7\u6a19(X1,X2)\u3092\u65b9\u5411\u30d9\u30af\u30c8\u30eb(h1,h2)\u306e\u8ef8\u306b\u6295\u5c04\u3057\u305f\u5ea7\u6a19\u3092Y\u3068\u3057\u307e\u3059\u3002\nY=h_1*X_1+h_2*X_2\n\n\u8ef8\u4e0a\u306e\u5ea7\u6a19\u306e\u6a19\u672c\u5e73\u5747\u306f\u3001\n\\begin{eqnarray}\n\\bar{Y}&=&\\frac{1}{n}\\sum_{i=1}^n{Y_i}=\\frac{1}{n}\\sum_{i=1}^n{(h_1X_1+h_2X_2)} \\\\\n&=&\\frac{1}{n}\\sum_{i=1}^n{h_1X_1}+\\frac{1}{n}\\sum_{i=1}^n{h_2X_2} \\\\\n&=&h_1\\bar{X_1}+h_2\\bar{X_2}\n\\end{eqnarray}\n\n\u3053\u308c\u3092\u7528\u3044\u3066\u3001\u8ef8(h1,h2)\u4e0a\u306e\u6a19\u672c\u5206\u6563\u306f\u3001\n\\begin{eqnarray}\ns^2_{(h_1, h_2)}\n&=&\\frac{1}{n-1}\\sum_{i=1}^n{(Y_i-\\bar{Y})^2} \\\\\n&=&\\frac{1}{n-1}\\sum_{i=1}^n{ \\Big\\{(h_1X_{i1}+h_2X_{i2})-(h_1\\bar{X_1}+h_2\\bar{X_2}) \\Big\\}^2 } \\\\\n&=&h_1^2 \\frac{1}{n-1}\\sum_{i=1}^n{(X_{i1}-\\bar{X_1})^2}\n+2h_1h_2\\frac{1}{n-1}\\sum_{i=1}^n{(X_{i1}-\\bar{X_1})(X_{i2}-\\bar{X_2})}\n+h_2^2 \\frac{1}{n-1}\\sum_{i=1}^n{(X_{i2}-\\bar{X_2})^2} \\\\\n&=& h_1^2\\ s_{11}+2h_1h_2\\ s_{12}+h_2^2\\ s_{22}\n\\end{eqnarray}\n\n\u3048\u301c\u3068\u3001\u521d\u9805\u304b\u3089\u3001X1\u306e\u6a19\u672c\u5206\u6563s11\u3001X1,X2\u306e\u6a19\u672c\u5171\u5206\u6563s12\u3001X2\u306e\u6a19\u672c\u5206\u6563s22\u306e\u5f62\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u4e8b\u3067\u3059\u3002\n\u3064\u30fc\u3053\u3068\u3067\u3001\nS= \\left( \n\\begin{array}{cc}\ns_{11} & s_{12} \\\\ s_{12} & s_{22}\n\\end{array} \\right), \nh= \\left( \\begin{array}{c} h_1 \\\\ h_2 \\end{array} \\right)\n\n\u5206\u6563\u5171\u5206\u6563\u884c\u5217S\u3068\u65b9\u5411\u30d9\u30af\u30c8\u30ebh\u3092\u7528\u3044\u3066\u3001\ns^2_{(h_1, h_2)} = h^t Sh\n\n\u3053\u306eh\u304c\u4e3b\u6210\u5206\u306e\u56fa\u6709\u30d9\u30af\u30c8\u30eb\u3060\u3063\u305f\u3068\u3059\u308b\u3068\u3001\n\\begin{equation}\n(S-\u03bbE)h=0\n\u3000\\Rightarrow\u3000h^t Sh = \u03bb = s^2_{(h_1, h_2)}\n\\end{equation}\n\n\u306a\u308b\u56fa\u6709\u5024\u03bb\u304c\u5b58\u5728\u3059\u308b(E\u306f\u5358\u4f4d\u884c\u5217)\u3002\n\u3059\u306a\u308f\u3061\u3001\u4e3b\u6210\u5206\u8ef8\u65b9\u5411\u306e\u5206\u6563\u306f\u3001\u5bfe\u5fdc\u3059\u308b\u56fa\u6709\u5024\u306b\u4e00\u81f4\u3059\u308b\u3002\n\uff08\u3042\u3068\u3067\u3001\u3053\u3053\u306b\u623b\u3063\u3066\u304d\u307e\u3059\uff09\n\nMahalanobis'\u8ddd\u96e2\n\u3067\u3001\u6c42\u3081\u305f\u3044\u5024\u306f\u3001\n1. \u5143\u5ea7\u6a19(X1, X2)\u3092\u56fa\u6709\u30d9\u30af\u30c8\u30ebh1(h11, h12)\u3068h2(h21,h22)\u3092\u4f7f\u3063\u3066\u4e3b\u6210\u5206\u5ea7\u6a19(pX1, pX2)\u306b\u5909\u63db\n2. \u4e3b\u6210\u5206\u5ea7\u6a19(pX1, pX2)\u3068\u4e2d\u5fc3\u306e\u8ddd\u96e2\u3092\u56fa\u6709\u5024\u03bb(\u03bb1,\u03bb2)\u306e\u30eb\u30fc\u30c8\u3067\u5272\u3063\u305f\u8ddd\u96e2\u3092\u7b97\u51fa\n\u3068\u3044\u3046\u4e8b\u306b\u306a\u308b\u3002\n\u5143\u5ea7\u6a19(X1, X2)\u306f\u3001\u4e2d\u5fc3\u539f\u70b9(0,0)\u306b\u5e73\u884c\u79fb\u52d5\u3057\u3066\u304a\u304f\u3082\u306e\u3068\u3057\u307e\u3059\u3002(\u56de\u8ee2\u306e\u95a2\u4fc2\u3067)\n\u3055\u3066\u30012\u304b\u3089\u653b\u3081\u308b\u3068\u3001\n\\begin{eqnarray}\nD^2_{mahalanobis} \n&=& \\frac{pX_1^2+pX_2^2}{s^2}\\\\\n&=& \\frac{pX_1^2+pX_2^2}{\u03bb}\\\\\n&=& ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} ) \n\\Big( \\begin{array}{c} \\frac{pX_1}{\u03bb_1} \\\\ \\frac{pX_2}{\u03bb_2} \\end{array} \\Big)  \\\\\n&=& ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} ) \n\\Big( \\begin{array}{cc} \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \\end{array} \\Big)   ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} )^t \n\\\\\n\\end{eqnarray}\n\n1\u3092\u76db\u308a\u8fbc\u3080\u3002\npX_1 = h_{11} X_1+h_{12}X_2\\\\\npX_2 = h_{21} X_1+h_{22}X_2\n\n\u3088\u308a\u3001\n\\begin{eqnarray}\n( \\begin{array}{cc}pX_1 & pX_2 \\end{array} ) &=&\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )\n\\Big( \\begin{array}{cc} h_{11} & h_{21}\\\\ h_{12} & h_{22} \\end{array} \\Big) \\\\\n& \\equiv &\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )H\n\\end{eqnarray}\n\nH\u306f\u56fa\u6709\u30d9\u30af\u30c8\u30eb\u30de\u30c8\u30ea\u30c3\u30af\u30b9\u3002\n\u307e\u305f\u3001\n( \\begin{array}{cc}pX_1 & pX_2 \\end{array} )^t =\nH^t\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )^t \\\\\n\n\n\u3053\u308c\u3089\u3092\u7528\u3044\u3066\u3001\n\\begin{eqnarray}\nD^2_{mahalanobis} \n&=& ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} ) \n\\Big( \\begin{array}{cc} \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \\end{array} \\Big)   ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} )^t \n\\\\\n&=& ( \\begin{array}{cc}X_1 & X_2 \\end{array} )\nH\n\\Big( \\begin{array}{cc} \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \\end{array} \\Big)\nH^t\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )^t\n\n\\end{eqnarray}\n\n\u5927\u4e08\u592b\u3067\u3059\u304b\uff1f\n\u30da\u30fc\u30b8\u30c8\u30c3\u30d7\u306e\u6570\u5f0f\u3068\u898b\u6bd4\u3079\u3066\u304f\u3060\u3055\u3044\u3002\u5927\u5206\u8fd1\u3065\u3044\u3066\u304d\u307e\u3057\u305f\u3002\n\u3042\u3068\u306f\u3001\nH\n\\Big( \\begin{array}{cc} \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \\end{array} \\Big)\nH^t\n \\equiv S^{-1}\n\n\u304c\u8a00\u3048\u308c\u3070OK\u3067\u3059\u306d\uff1f\n\u5c11\u3057\u30c8\u30ea\u30c3\u30ad\u30fc\u3067\u3059\u304c\u3001\n\\begin{eqnarray}\n\\Big( \\begin{array}{cc}\n \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \n\\end{array} \\Big)\n&=&\n\\Big( \\begin{array}{cc}\n \\frac{\u03bb_2}{\u03bb_1\u03bb_2} & 0\\\\ 0 & \\frac{\u03bb_1}{\u03bb_1\u03bb_2} \n\\end{array} \\Big) \\\\\n&=&\n\\frac{1}{\u03bb_1\u03bb_2}\n\\Big( \\begin{array}{cc} \u03bb_2 & 0\\\\ 0 & \u03bb_1 \\end{array} \\Big) \\\\\n&=&\n\\Big( \\begin{array}{cc} \u03bb_1 & 0\\\\ 0 & \u03bb_2 \\end{array} \\Big)^{-1} \\\\\n&\\equiv& \\Lambda^{-1}\n\\end{eqnarray}\n\n\u3068\u7f6e\u304f\u3002\n\u03bb\u5927\u6587\u5b57\u306f\u3001\u5bfe\u89d2\u6210\u5206\u304c\u56fa\u6709\u5024\u306e\u884c\u5217\u3067\u3059\u3002\nH \\Lambda^{-1} H^t \\equiv S^{-1}\n\n\u304c\u8a00\u3048\u308c\u3070OK\u3002S\u306f\u5206\u6563\u5171\u5206\u6563\u884c\u5217\u3002\n\u3075\u301c\u3002\u3055\u3066\u3001(\u3042\u3068\u3067\u3053\u3053\u306b)\u3068\u8a00\u3063\u3066\u3044\u305f\u5f0f\u3092\u518d\u63b2\u3002\n(S-\u03bbE)h=0\n\n\u3053\u308c\u3092\u4eca\u98a8\u306e\u8a18\u53f7\u306b\u66f8\u304d\u76f4\u3059\u3068\u3001\n(S-\u03bb_1 E)\\Big(\\begin{array}{c}h_{11}\\\\ h_{12}\\end{array}\\Big)=0 \\\\\n(S-\u03bb_2 E)\\Big(\\begin{array}{c}h_{21}\\\\ h_{22}\\end{array}\\Big)=0\n\n\u3053\u308c\u3092\u5c11\u3057\u6574\u7406\u3057\u3066\u3001\nS\\Big(\\begin{array}{c}h_{11}\\\\ h_{12}\\end{array}\\Big) = \u03bb_1\\Big(\\begin{array}{c}h_{11}\\\\ h_{12}\\end{array}\\Big)\\\\\nS\\Big(\\begin{array}{c}h_{21}\\\\ h_{22}\\end{array}\\Big)=\n\u03bb_2\\Big(\\begin{array}{c}h_{21}\\\\ h_{22}\\end{array}\\Big)\n\n\u4f55\u304c\u3057\u305f\u3044\u304b\u3068\u3044\u3046\u3068\u3001\n\\begin{eqnarray}\nS \\Big(\\begin{array}{cc}h_{11} & h_{21} \\\\ h_{12} & h_{22} \\end{array} \\Big)&=&\n\\Big(\\begin{array}{cc}\u03bb_{1}h_{11} & \u03bb_2h_{21} \\\\ \u03bb_1h_{12} & \u03bb_2h_{22} \\end{array} \\Big) \\\\\n&=&\\Big(\\begin{array}{cc}h_{11} & h_{21} \\\\ h_{12} & h_{22} \\end{array} \\Big)\n\\Big(\\begin{array}{cc}\u03bb_1 & 0 \\\\ 0 & \u03bb_2 \\end{array} \\Big)\n\\end{eqnarray}\n\n\u3059\u306a\u308f\u3061\u3001\nSH=H \\Lambda\n\n\u3053\u308c\u3092\u7528\u3044\u3066\u3001\n\\begin{eqnarray}\nSH&=&H \\Lambda \\\\\nS^{-1}SH&=&S^{-1}H\\Lambda \\\\\nH&=&S^{-1}H\\Lambda \\\\\nH\\Lambda^{-1}&=&S^{-1}H\\Lambda \\Lambda^{-1}=S^{-1}H\\\\\nH\\Lambda^{-1}H^{-1}&=&S^{-1}HH^{-1}=S^{-1}\n\\end{eqnarray}\n\n\u304a\u3063\u3068\u3001\u3053\u3053\u3067\u3001\n\\begin{eqnarray}\nH^tH&=&\n\\Big( \\begin{array}{cc} h_{11} & h_{12} \\\\ h_{21} & h_{22} \\end{array} \\Big)\n\\Big( \\begin{array}{cc} h_{11} & h_{21} \\\\ h_{12} & h_{22} \\end{array} \\Big)\\\\\n&=& \\Big( \\begin{array}{cc} h_{11}^2+h_{12}^2 & h_{11}h_{21}+h_{12}h_{22} \\\\\n h_{11}h_{21}+h_{12}h_{22} & h_{21}^2+h_{22}^2 \\end{array} \\Big) \\\\\n&=&\\Big( \\begin{array}{cc} 1 & 0 \\\\ 0 & 1 \\end{array} \\Big) \\\\\n\n\\therefore H^t&=&H^{-1}\n\\end{eqnarray}\n\n\u5bfe\u89d2\u6210\u5206\uff1d1\u306f\u3001\u5358\u4f4d\u30d9\u30af\u30c8\u30eb\u3060\u304b\u3089\u3002\n\u305d\u308c\u4ee5\u5916\u306e\u6210\u5206=0\u306f\u3001\u76f4\u884c\u30d9\u30af\u30c8\u30eb\u3060\u304b\u3089\u3002\n\u3084\u3063\u3068\u306a\u3063\u3001\nH\\Lambda^{-1}H^{t}=S^{-1}\n\n\u5f93\u3063\u3066\u3001\n\\begin{eqnarray}\nD^2_{mahalanobis} \n&=& ( \\begin{array}{cc}X_1 & X_2 \\end{array} )\nH \\Lambda^{-1} H^t\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )^t\\\\\n&=& ( \\begin{array}{cc}X_1 & X_2 \\end{array} )\nS^{-1}\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )^t\n\\end{eqnarray}\n\n\u3063\u3068\u3044\u3046\u4e8b\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\nAppendix\n\nAppendix-1. \u78ba\u7387\u6955\u5186\n\u8a73\u3057\u304f\u306f\u524d\u56de\nlibrary(\"ellipse\")\nlibrary(\"ggplot2\")\n\n# \"\u56de\u8ee2\u524d\"\u306e\u30c7\u30fc\u30bf\nset.seed(13)\ndat0 <- matrix(rnorm(1000), , 2)\n\n# \u56de\u8ee2\nsita <- pi/4\nrot <- matrix(c(cos(sita), -sin(sita), sin(sita), cos(sita)),2)\ndat <- data.frame(dat0 * c(2, 1) %*% rot)\n\n# \u6955\u5186\u3092\u63cf\u304f\u78ba\u7387\u6c34\u6e96\nlevel <- seq(0.1, 0.9, by=0.1)\n\n# \u6955\u5186\u5ea7\u6a19\u306e\u7b97\u51fa\ndatE <- NULL\nfor(i in level){\n  datE <-rbind(datE, cbind(i, ellipse(cov(dat), centre=apply(dat, 2, mean), level=i)))\n}\ndatE <- data.frame(datE)\ndatE$i <- factor(datE$i)\n\n# \u30ab\u30e9\u30fc\u30b3\u30fc\u30c9\u306e\u8a2d\u5b9a\nCol <- colorRamp(c(\"Red\",\"skyblue\"))\ncolor <- rgb(Col(seq(0, 1, length=length(level)))/255)\n# \u8ef8\u7bc4\u56f2\nax <- max(abs(dat))\n\n# \u63cf\u753b\nggplot()+\n  layer(\n    data = dat,\n    mapping = aes(x=X1, y=X2),\n    geom = \"point\",\n    stat = \"identity\",\n    position = \"identity\",\n    params = list(color=\"grey\")\n  )+\n  layer(\n    data = datE,\n    mapping = aes(x=X1, y=X2, color=i),\n    geom = \"path\",\n    stat = \"identity\",\n    position = \"identity\",\n    params = list(size=1.2)\n  )+\n  xlim(-ax, ax)+\n  ylim(-ax, ax)+\n  scale_color_manual(values=color)+\n  theme_bw()\n\n\u3063\u3068\u307e\u3041\u3001\u6700\u8fd1\u306fggplot2\u3092\u4f7f\u3046\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u666e\u901a\u306bplot\u3092\u4f7f\u3063\u3066\u3082\u66f8\u3051\u307e\u3059\u3002\n# ggplot2\u3092\u4f7f\u308f\u306a\u3044\u63cf\u753b\npar(mar=c(2,2,1,1))\nplot(0,0,type=\"n\", xlim=c(-ax,ax), ylim=c(-ax,ax), mgp=c(2, 0.3, 0), tcl=-0.2)\n  points(dat, col=\"grey\", pch=16)\nfor(i in 1:length(level)){\n  lines(datE[datE$i==level[i], 2:3], col=color[i], lwd=2)\n}\n\n\u3093\u301c\u3002\u3069\u3061\u3089\u304c\u898b\u76f4\u3057\u305f\u6642\u306b\u8aad\u307f\u3084\u3059\u3044\u304b\u3001\u306e\u597d\u307f\u3067\u3002\nplot\u3082\u3001\u7d50\u69cb\u4f7f\u3044\u52dd\u624b\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3088\u3063\u3002\n\n\u53c2\u8003\u6587\u732e\n\n\u9759\u5ca1\u5927 \u91d1\u4e45\u4fdd\u5148\u751f\u306e\u30da\u30fc\u30b8\u3088\u308a\u3001\u5224\u5225\u5206\u6790(\u30de\u30cf\u30e9\u30ce\u30d3\u30b9)\n\n\u66f8\u7c4d\u3067\u3059\u304c\u3001\u300e\u591a\u6b21\u5143\u30c7\u30fc\u30bf\u89e3\u6790\u6cd5(R\u3067\u5b66\u3076\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30b9)\u300f\n\n\nMahalanobis'\u8ddd\u96e2\u3068\u78ba\u7387\u6955\u5186\u306e\u95a2\u4fc2\u3092\u66f8\u3053\u3046\u3068\u601d\u3063\u305f\u3089\u3001\n\u601d\u3044\u306e\u5916\u3001\u7406\u8ad6\u7684\u80cc\u666f\u304c\u9577\u304f\u306a\u3063\u305f\u306e\u3067\u3053\u3053\u3067\u5206\u3051\u3066\u304a\u304d\u307e\u3059\u3002\n\n# Mahalanobis' Distance\n\n\u70b9`X`\u3068\u7fa4`A`\u306e\u30de\u30cf\u30e9\u30ce\u30d3\u30b9\u8ddd\u96e2\u306f\u3001\u4e0b\u8a18\u3067\u5b9a\u7fa9\u3055\u308c\u308b\u3002\n\n```math\nD_{Mahalanobis}^2 = (X-\\bar{A})^t cov(A) ^{-1}(X-\\bar{A})\u3000\\\\\n\\ \\\\\n\\begin{eqnarray}\ncov(A):& &variance\\ covariance\\ matrix \\\\\n\\bar{A}:& &mean(A)\\\\\n^t:& &transported\\ matrix\\\\ \n^{-1}:& &inverse\\ matrix \\\\\n\\end{eqnarray}\n```\n\n# \u6982\u5ff5\n\n2\u6b21\u5143\u306e\u5834\u5408\u3092\u8003\u3048\u308b\u3002\n[\u524d\u56de\u7d39\u4ecb\u3057\u305f\u78ba\u7387\u6955\u5186](http://qiita.com/kilometer/items/8ebee12a56d98e111f0d)\u306e\u8003\u3048\u65b9\u3092\u62bc\u3055\u3048\u3066\u304a\u304f\u3002\n<img width=\"500\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-05 14.23.29.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/92401/368cf3dd-08ce-8556-4d78-aa885a46b2b2.png\">\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u4e8c\u6b21\u5143\u6b63\u898f\u5206\u5e03\u3092\u4f8b\u306b\u3057\u3066\u3001\u4e2d\u5fc3\u304b\u3089`hoge`%\u306e\u30d7\u30ed\u30c3\u30c8\u304c\u542b\u307e\u308c\u308b\u7bc4\u56f2\u3092\u63cf\u753b\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n(R\u30b3\u30fc\u30c9\u306fAppendix-1)\n\n\u30dd\u30a4\u30f3\u30c8\u306f\u3001**\u540c\u3058\u8272\u306e\u6955\u5186\u4e0a\u306e\u70b9\u306f\u540c\u7b49\u306b\u6271\u3044\u305f\u3044**\u3001\u3068\u3044\u3046\u4e8b\u3067\u3059\u3002\n\u3053\u306e\u307e\u307e\u3067\u306f\u3001\u5206\u5e03\u306e\u4e2d\u5fc3(\u539f\u70b9)\u304b\u3089\u306e\u8ddd\u96e2\u304c\u5747\u7b49\u3067\u306f\u306a\u3044\u3002\n\u305d\u3053\u3067\u3001\u88dc\u6b63\u3092\u304b\u3051\u3066\u4e0b\u56f3\u306e\u3088\u3046\u306b\u5909\u63db\u3057\u305f\u3044\u3002\n<img width=\"500\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-05 14.24.38.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/92401/4cc456e5-b6ba-2eb7-adba-a7a165369089.png\">\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\u3064\u306e\u88dc\u6b63\u3092\u884c\u3044\u307e\u3059\u3002\n\u30fb\"\u9577\u8ef8\"\u3092X\u8ef8\u3001\"\u77ed\u8ef8\"\u3092Y\u8ef8\u306b\u4e00\u81f4\u3059\u308b\u3088\u3046\u306b\u56de\u8ee2\u88dc\u6b63\n\u30fb\u5404\u8ef8\u65b9\u5411\u306b\u5206\u6563=1\u306b\u306a\u308b\u3088\u3046\u306b\u88dc\u6b63\n\n\u3067\u3001\u88dc\u6b63\u5f8c\u306e\u30d7\u30ed\u30c3\u30c8\u3068\u4e2d\u5fc3\u306e\u8ddd\u96e2\u306e\u3053\u3068\u3092\u3001**Mahalanobis'\u8ddd\u96e2**\u3068\u8a00\u3044\u307e\u3059\u3002\n\n\u52d8\u6240\u306e\u92ed\u3044\u30d2\u30c8\u306f\u3001**\u3053\u308c\u3063\u3066\u4e3b\u6210\u5206\u5206\u6790\u3058\u3083\u3093**\u3001\u3068\u601d\u3046\u306f\u305a\u3067\u3059\u3002\n\u305d\u306e\u901a\u308a\u3001\u3067\u3057\u3066\u3001Mahalanobis'\u8ddd\u96e2\u3092\u6c42\u3081\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u5206\u6563\u5171\u5206\u6563\u884c\u5217\u306b\u57fa\u3065\u304f\u4e3b\u6210\u5206\u5206\u6790\u3092\u3057\u3066\u3001\u305d\u306e\u4e3b\u6210\u5206\u3067\u30d7\u30ed\u30c3\u30c8\u3092\u30b9\u30b1\u30fc\u30eb\u3059\u308b\u3001\u3068\u3044\u3046\u4e8b\u3068\u540c\u7b49\u306e\u64cd\u4f5c\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\n# \u6570\u5b66\u7684\u610f\u5473\n\n## \u6295\u5c04\u5148\u306e\u8ef8\u4e0a\u306e\u5206\u6563\n\u5ea7\u6a19`(X, Y)`\u3092\u03b8\u5ea6\u56de\u8ee2\u3055\u305b\u305f\u5ea7\u6a19`(X',Y')`\u306f\u3001\n\n```math\n\\begin{eqnarray}\nX' &=& &cos\u03b8*X &+ sin\u03b8*Y \\\\\nY' &=& -&sin\u03b8*X &+ cos\u03b8*Y\n\\end{eqnarray}\n```\n\n\u3064\u307e\u308a\u56de\u8ee2\u3057\u305f\u3044\u5411\u304d\u306e\u65b9\u5411\u30d9\u30af\u30c8\u30eb`(cos\u03b8, sin\u03b8)`\u304c\u5206\u304b\u308c\u3070\u826f\u3044\u3002\n\u3069\u3046\u3084\u3063\u3066`\u03b8`\u3092\u6c7a\u5b9a\u3059\u308c\u3070\u826f\u3044\u304b\u3068\u3044\u3046\u3068\u3001\u5206\u5e03\u306e\"\u9577\u8ef8\"\u306a\u308f\u3051\u306a\u306e\u3067\u3001\n\u305d\u306e\u8ef8\u306b\u6295\u5c04\u3057\u305f\u6642\u306b\u5206\u6563\u304c\u6700\u5927\u306b\u306a\u308b\u8ef8\u3092\u9078\u3079\u3070\u826f\u3044\u3002\n\n\u5c11\u3057\u8a18\u53f7\u3092\u5909\u3048\u3066\u3001\u6295\u5c04\u524d\u5ea7\u6a19`(X1,X2)`\u3092\u65b9\u5411\u30d9\u30af\u30c8\u30eb`(h1,h2)`\u306e\u8ef8\u306b\u6295\u5c04\u3057\u305f\u5ea7\u6a19\u3092`Y`\u3068\u3057\u307e\u3059\u3002\n\n```math\nY=h_1*X_1+h_2*X_2\n```\n\n\u8ef8\u4e0a\u306e\u5ea7\u6a19\u306e\u6a19\u672c\u5e73\u5747\u306f\u3001\n\n```math\n\\begin{eqnarray}\n\\bar{Y}&=&\\frac{1}{n}\\sum_{i=1}^n{Y_i}=\\frac{1}{n}\\sum_{i=1}^n{(h_1X_1+h_2X_2)} \\\\\n&=&\\frac{1}{n}\\sum_{i=1}^n{h_1X_1}+\\frac{1}{n}\\sum_{i=1}^n{h_2X_2} \\\\\n&=&h_1\\bar{X_1}+h_2\\bar{X_2}\n\\end{eqnarray}\n```\n\n\n\u3053\u308c\u3092\u7528\u3044\u3066\u3001\u8ef8`(h1,h2)`\u4e0a\u306e\u6a19\u672c\u5206\u6563\u306f\u3001\n\n```math\n\\begin{eqnarray}\ns^2_{(h_1, h_2)}\n&=&\\frac{1}{n-1}\\sum_{i=1}^n{(Y_i-\\bar{Y})^2} \\\\\n&=&\\frac{1}{n-1}\\sum_{i=1}^n{ \\Big\\{(h_1X_{i1}+h_2X_{i2})-(h_1\\bar{X_1}+h_2\\bar{X_2}) \\Big\\}^2 } \\\\\n&=&h_1^2 \\frac{1}{n-1}\\sum_{i=1}^n{(X_{i1}-\\bar{X_1})^2}\n+2h_1h_2\\frac{1}{n-1}\\sum_{i=1}^n{(X_{i1}-\\bar{X_1})(X_{i2}-\\bar{X_2})}\n+h_2^2 \\frac{1}{n-1}\\sum_{i=1}^n{(X_{i2}-\\bar{X_2})^2} \\\\\n&=& h_1^2\\ s_{11}+2h_1h_2\\ s_{12}+h_2^2\\ s_{22}\n\\end{eqnarray}\n```\n\n\u3048\u301c\u3068\u3001\u521d\u9805\u304b\u3089\u3001`X1`\u306e\u6a19\u672c\u5206\u6563`s11`\u3001`X1,X2`\u306e\u6a19\u672c\u5171\u5206\u6563`s12`\u3001`X2`\u306e\u6a19\u672c\u5206\u6563`s22`\u306e\u5f62\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u4e8b\u3067\u3059\u3002\n\n\u3064\u30fc\u3053\u3068\u3067\u3001\n\n```math\nS= \\left( \n\\begin{array}{cc}\ns_{11} & s_{12} \\\\ s_{12} & s_{22}\n\\end{array} \\right), \nh= \\left( \\begin{array}{c} h_1 \\\\ h_2 \\end{array} \\right)\n```\n\u5206\u6563\u5171\u5206\u6563\u884c\u5217`S`\u3068\u65b9\u5411\u30d9\u30af\u30c8\u30eb`h`\u3092\u7528\u3044\u3066\u3001\n\n```math\ns^2_{(h_1, h_2)} = h^t Sh\n```\n\n\u3053\u306e`h`\u304c\u4e3b\u6210\u5206\u306e\u56fa\u6709\u30d9\u30af\u30c8\u30eb\u3060\u3063\u305f\u3068\u3059\u308b\u3068\u3001\n\n```math\n\\begin{equation}\n(S-\u03bbE)h=0\n\u3000\\Rightarrow\u3000h^t Sh = \u03bb = s^2_{(h_1, h_2)}\n\\end{equation}\n```\n\u306a\u308b\u56fa\u6709\u5024`\u03bb`\u304c\u5b58\u5728\u3059\u308b(`E`\u306f\u5358\u4f4d\u884c\u5217)\u3002\n\u3059\u306a\u308f\u3061\u3001\u4e3b\u6210\u5206\u8ef8\u65b9\u5411\u306e\u5206\u6563\u306f\u3001\u5bfe\u5fdc\u3059\u308b\u56fa\u6709\u5024\u306b\u4e00\u81f4\u3059\u308b\u3002\n\n\uff08\u3042\u3068\u3067\u3001\u3053\u3053\u306b\u623b\u3063\u3066\u304d\u307e\u3059\uff09\n\n## Mahalanobis'\u8ddd\u96e2\n\u3067\u3001\u6c42\u3081\u305f\u3044\u5024\u306f\u3001\n1. \u5143\u5ea7\u6a19`(X1, X2)`\u3092\u56fa\u6709\u30d9\u30af\u30c8\u30eb`h1(h11, h12)`\u3068`h2(h21,h22)`\u3092\u4f7f\u3063\u3066\u4e3b\u6210\u5206\u5ea7\u6a19`(pX1, pX2)`\u306b\u5909\u63db\n2. \u4e3b\u6210\u5206\u5ea7\u6a19`(pX1, pX2)`\u3068\u4e2d\u5fc3\u306e\u8ddd\u96e2\u3092\u56fa\u6709\u5024`\u03bb(\u03bb1,\u03bb2)`\u306e\u30eb\u30fc\u30c8\u3067\u5272\u3063\u305f\u8ddd\u96e2\u3092\u7b97\u51fa\n\u3068\u3044\u3046\u4e8b\u306b\u306a\u308b\u3002\n\u5143\u5ea7\u6a19`(X1, X2)`\u306f\u3001\u4e2d\u5fc3\u539f\u70b9`(0,0)`\u306b\u5e73\u884c\u79fb\u52d5\u3057\u3066\u304a\u304f\u3082\u306e\u3068\u3057\u307e\u3059\u3002(\u56de\u8ee2\u306e\u95a2\u4fc2\u3067)\n\n\u3055\u3066\u30012\u304b\u3089\u653b\u3081\u308b\u3068\u3001\n\n```math\n\\begin{eqnarray}\nD^2_{mahalanobis} \n&=& \\frac{pX_1^2+pX_2^2}{s^2}\\\\\n&=& \\frac{pX_1^2+pX_2^2}{\u03bb}\\\\\n&=& ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} ) \n\\Big( \\begin{array}{c} \\frac{pX_1}{\u03bb_1} \\\\ \\frac{pX_2}{\u03bb_2} \\end{array} \\Big)  \\\\\n&=& ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} ) \n\\Big( \\begin{array}{cc} \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \\end{array} \\Big)   ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} )^t \n\\\\\n\\end{eqnarray}\n```\n\n1\u3092\u76db\u308a\u8fbc\u3080\u3002\n\n```math\npX_1 = h_{11} X_1+h_{12}X_2\\\\\npX_2 = h_{21} X_1+h_{22}X_2\n```\n\n\u3088\u308a\u3001\n\n```math\n\\begin{eqnarray}\n( \\begin{array}{cc}pX_1 & pX_2 \\end{array} ) &=&\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )\n\\Big( \\begin{array}{cc} h_{11} & h_{21}\\\\ h_{12} & h_{22} \\end{array} \\Big) \\\\\n& \\equiv &\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )H\n\\end{eqnarray}\n```\n\n`H`\u306f\u56fa\u6709\u30d9\u30af\u30c8\u30eb\u30de\u30c8\u30ea\u30c3\u30af\u30b9\u3002\n\n\u307e\u305f\u3001\n\n\n```math\n( \\begin{array}{cc}pX_1 & pX_2 \\end{array} )^t =\nH^t\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )^t \\\\\n\n```\n\n\u3053\u308c\u3089\u3092\u7528\u3044\u3066\u3001\n\n```math\n\\begin{eqnarray}\nD^2_{mahalanobis} \n&=& ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} ) \n\\Big( \\begin{array}{cc} \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \\end{array} \\Big)   ( \\begin{array}{cc}pX_1 & pX_2 \\end{array} )^t \n\\\\\n&=& ( \\begin{array}{cc}X_1 & X_2 \\end{array} )\nH\n\\Big( \\begin{array}{cc} \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \\end{array} \\Big)\nH^t\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )^t\n\n\\end{eqnarray}\n```\n\n\u5927\u4e08\u592b\u3067\u3059\u304b\uff1f\n\u30da\u30fc\u30b8\u30c8\u30c3\u30d7\u306e\u6570\u5f0f\u3068\u898b\u6bd4\u3079\u3066\u304f\u3060\u3055\u3044\u3002\u5927\u5206\u8fd1\u3065\u3044\u3066\u304d\u307e\u3057\u305f\u3002\n\u3042\u3068\u306f\u3001\n\n```math\nH\n\\Big( \\begin{array}{cc} \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \\end{array} \\Big)\nH^t\n \\equiv S^{-1}\n```\n\u304c\u8a00\u3048\u308c\u3070OK\u3067\u3059\u306d\uff1f\n\n\u5c11\u3057\u30c8\u30ea\u30c3\u30ad\u30fc\u3067\u3059\u304c\u3001\n\n```math\n\\begin{eqnarray}\n\\Big( \\begin{array}{cc}\n \\frac{1}{\u03bb_1} & 0\\\\ 0 & \\frac{1}{\u03bb_2} \n\\end{array} \\Big)\n&=&\n\\Big( \\begin{array}{cc}\n \\frac{\u03bb_2}{\u03bb_1\u03bb_2} & 0\\\\ 0 & \\frac{\u03bb_1}{\u03bb_1\u03bb_2} \n\\end{array} \\Big) \\\\\n&=&\n\\frac{1}{\u03bb_1\u03bb_2}\n\\Big( \\begin{array}{cc} \u03bb_2 & 0\\\\ 0 & \u03bb_1 \\end{array} \\Big) \\\\\n&=&\n\\Big( \\begin{array}{cc} \u03bb_1 & 0\\\\ 0 & \u03bb_2 \\end{array} \\Big)^{-1} \\\\\n&\\equiv& \\Lambda^{-1}\n\\end{eqnarray}\n```\n\u3068\u7f6e\u304f\u3002\n\u03bb\u5927\u6587\u5b57\u306f\u3001\u5bfe\u89d2\u6210\u5206\u304c\u56fa\u6709\u5024\u306e\u884c\u5217\u3067\u3059\u3002\n\n```math\nH \\Lambda^{-1} H^t \\equiv S^{-1}\n```\n\n\u304c\u8a00\u3048\u308c\u3070OK\u3002`S`\u306f\u5206\u6563\u5171\u5206\u6563\u884c\u5217\u3002\n\n\u3075\u301c\u3002\u3055\u3066\u3001(\u3042\u3068\u3067\u3053\u3053\u306b)\u3068\u8a00\u3063\u3066\u3044\u305f\u5f0f\u3092\u518d\u63b2\u3002\n\n```math\n(S-\u03bbE)h=0\n```\n\n\u3053\u308c\u3092\u4eca\u98a8\u306e\u8a18\u53f7\u306b\u66f8\u304d\u76f4\u3059\u3068\u3001\n\n\n```math\n(S-\u03bb_1 E)\\Big(\\begin{array}{c}h_{11}\\\\ h_{12}\\end{array}\\Big)=0 \\\\\n(S-\u03bb_2 E)\\Big(\\begin{array}{c}h_{21}\\\\ h_{22}\\end{array}\\Big)=0\n```\n\n\u3053\u308c\u3092\u5c11\u3057\u6574\u7406\u3057\u3066\u3001\n\n```math\nS\\Big(\\begin{array}{c}h_{11}\\\\ h_{12}\\end{array}\\Big) = \u03bb_1\\Big(\\begin{array}{c}h_{11}\\\\ h_{12}\\end{array}\\Big)\\\\\nS\\Big(\\begin{array}{c}h_{21}\\\\ h_{22}\\end{array}\\Big)=\n\u03bb_2\\Big(\\begin{array}{c}h_{21}\\\\ h_{22}\\end{array}\\Big)\n```\n\n\u4f55\u304c\u3057\u305f\u3044\u304b\u3068\u3044\u3046\u3068\u3001\n\n```math\n\\begin{eqnarray}\nS \\Big(\\begin{array}{cc}h_{11} & h_{21} \\\\ h_{12} & h_{22} \\end{array} \\Big)&=&\n\\Big(\\begin{array}{cc}\u03bb_{1}h_{11} & \u03bb_2h_{21} \\\\ \u03bb_1h_{12} & \u03bb_2h_{22} \\end{array} \\Big) \\\\\n&=&\\Big(\\begin{array}{cc}h_{11} & h_{21} \\\\ h_{12} & h_{22} \\end{array} \\Big)\n\\Big(\\begin{array}{cc}\u03bb_1 & 0 \\\\ 0 & \u03bb_2 \\end{array} \\Big)\n\\end{eqnarray}\n```\n\u3059\u306a\u308f\u3061\u3001\n\n```math\nSH=H \\Lambda\n```\n\n\u3053\u308c\u3092\u7528\u3044\u3066\u3001\n\n```math\n\\begin{eqnarray}\nSH&=&H \\Lambda \\\\\nS^{-1}SH&=&S^{-1}H\\Lambda \\\\\nH&=&S^{-1}H\\Lambda \\\\\nH\\Lambda^{-1}&=&S^{-1}H\\Lambda \\Lambda^{-1}=S^{-1}H\\\\\nH\\Lambda^{-1}H^{-1}&=&S^{-1}HH^{-1}=S^{-1}\n\\end{eqnarray}\n```\n\n\u304a\u3063\u3068\u3001\u3053\u3053\u3067\u3001\n\n```math\n\\begin{eqnarray}\nH^tH&=&\n\\Big( \\begin{array}{cc} h_{11} & h_{12} \\\\ h_{21} & h_{22} \\end{array} \\Big)\n\\Big( \\begin{array}{cc} h_{11} & h_{21} \\\\ h_{12} & h_{22} \\end{array} \\Big)\\\\\n&=& \\Big( \\begin{array}{cc} h_{11}^2+h_{12}^2 & h_{11}h_{21}+h_{12}h_{22} \\\\\n h_{11}h_{21}+h_{12}h_{22} & h_{21}^2+h_{22}^2 \\end{array} \\Big) \\\\\n&=&\\Big( \\begin{array}{cc} 1 & 0 \\\\ 0 & 1 \\end{array} \\Big) \\\\\n\n\\therefore H^t&=&H^{-1}\n\\end{eqnarray}\n```\n\u5bfe\u89d2\u6210\u5206\uff1d1\u306f\u3001\u5358\u4f4d\u30d9\u30af\u30c8\u30eb\u3060\u304b\u3089\u3002\n\u305d\u308c\u4ee5\u5916\u306e\u6210\u5206=0\u306f\u3001\u76f4\u884c\u30d9\u30af\u30c8\u30eb\u3060\u304b\u3089\u3002\n\n\n\u3084\u3063\u3068\u306a\u3063\u3001\n\n```math\nH\\Lambda^{-1}H^{t}=S^{-1}\n```\n\n\u5f93\u3063\u3066\u3001\n\n```math\n\\begin{eqnarray}\nD^2_{mahalanobis} \n&=& ( \\begin{array}{cc}X_1 & X_2 \\end{array} )\nH \\Lambda^{-1} H^t\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )^t\\\\\n&=& ( \\begin{array}{cc}X_1 & X_2 \\end{array} )\nS^{-1}\n( \\begin{array}{cc}X_1 & X_2 \\end{array} )^t\n\\end{eqnarray}\n```\n\n\u3063\u3068\u3044\u3046\u4e8b\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\n# Appendix\n### Appendix-1. \u78ba\u7387\u6955\u5186\n\u8a73\u3057\u304f\u306f[\u524d\u56de](http://qiita.com/kilometer/items/8ebee12a56d98e111f0d)\n\n```r\nlibrary(\"ellipse\")\nlibrary(\"ggplot2\")\n\n# \"\u56de\u8ee2\u524d\"\u306e\u30c7\u30fc\u30bf\nset.seed(13)\ndat0 <- matrix(rnorm(1000), , 2)\n\n# \u56de\u8ee2\nsita <- pi/4\nrot <- matrix(c(cos(sita), -sin(sita), sin(sita), cos(sita)),2)\ndat <- data.frame(dat0 * c(2, 1) %*% rot)\n\n# \u6955\u5186\u3092\u63cf\u304f\u78ba\u7387\u6c34\u6e96\nlevel <- seq(0.1, 0.9, by=0.1)\n\n# \u6955\u5186\u5ea7\u6a19\u306e\u7b97\u51fa\ndatE <- NULL\nfor(i in level){\n  datE <-rbind(datE, cbind(i, ellipse(cov(dat), centre=apply(dat, 2, mean), level=i)))\n}\ndatE <- data.frame(datE)\ndatE$i <- factor(datE$i)\n\n# \u30ab\u30e9\u30fc\u30b3\u30fc\u30c9\u306e\u8a2d\u5b9a\nCol <- colorRamp(c(\"Red\",\"skyblue\"))\ncolor <- rgb(Col(seq(0, 1, length=length(level)))/255)\n# \u8ef8\u7bc4\u56f2\nax <- max(abs(dat))\n\n# \u63cf\u753b\nggplot()+\n  layer(\n    data = dat,\n    mapping = aes(x=X1, y=X2),\n    geom = \"point\",\n    stat = \"identity\",\n    position = \"identity\",\n    params = list(color=\"grey\")\n  )+\n  layer(\n    data = datE,\n    mapping = aes(x=X1, y=X2, color=i),\n    geom = \"path\",\n    stat = \"identity\",\n    position = \"identity\",\n    params = list(size=1.2)\n  )+\n  xlim(-ax, ax)+\n  ylim(-ax, ax)+\n  scale_color_manual(values=color)+\n  theme_bw()\n```\n\u3063\u3068\u307e\u3041\u3001\u6700\u8fd1\u306f`ggplot2`\u3092\u4f7f\u3046\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u666e\u901a\u306b`plot`\u3092\u4f7f\u3063\u3066\u3082\u66f8\u3051\u307e\u3059\u3002\n\n```r\n# ggplot2\u3092\u4f7f\u308f\u306a\u3044\u63cf\u753b\npar(mar=c(2,2,1,1))\nplot(0,0,type=\"n\", xlim=c(-ax,ax), ylim=c(-ax,ax), mgp=c(2, 0.3, 0), tcl=-0.2)\n  points(dat, col=\"grey\", pch=16)\nfor(i in 1:length(level)){\n  lines(datE[datE$i==level[i], 2:3], col=color[i], lwd=2)\n}\n```\n\u3093\u301c\u3002\u3069\u3061\u3089\u304c\u898b\u76f4\u3057\u305f\u6642\u306b\u8aad\u307f\u3084\u3059\u3044\u304b\u3001\u306e\u597d\u307f\u3067\u3002\n`plot`\u3082\u3001\u7d50\u69cb\u4f7f\u3044\u52dd\u624b\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3088\u3063\u3002\n\n\n# \u53c2\u8003\u6587\u732e\n1. \u9759\u5ca1\u5927 \u91d1\u4e45\u4fdd\u5148\u751f\u306e\u30da\u30fc\u30b8\u3088\u308a\u3001[\u5224\u5225\u5206\u6790(\u30de\u30cf\u30e9\u30ce\u30d3\u30b9)](http://www.sist.ac.jp/~kanakubo/research/statistic/hanbetu_maha.html)\n2. \u66f8\u7c4d\u3067\u3059\u304c\u3001[\u300e\u591a\u6b21\u5143\u30c7\u30fc\u30bf\u89e3\u6790\u6cd5(R\u3067\u5b66\u3076\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30b9)\u300f](https://www.amazon.co.jp/dp/4320019229/)\n", "tags": ["R", "Mahalanobis", "ellipse", "\u7d71\u8a08\u5b66"]}