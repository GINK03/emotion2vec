{"context": "\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u3088\u3046\u306b\u3001\uff11\u3064\u306e\u30b5\u30fc\u30d0\u30fc\u306b\u8907\u6570\u306eWeb\u30a2\u30d7\u30ea\u3092\u7f6e\u3044\u3066\u304a\u304d\u305f\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u969b\u306b\u3001nginx\u3068\u5404\u30a2\u30d7\u30ea\u306b\u306f\u305d\u308c\u305e\u308c\u306e docker-compose.yml \u3092\u4f5c\u3063\u3066\u5225\u3005\u306b\u7ba1\u7406\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nnginx (\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7)\n\n\nWeb\u30a2\u30d7\u30ea1 (PHP http)\nWeb\u30a2\u30d7\u30ea2 (Python uWSGI)\n...\n\n\n\n\u3053\u306e\u5834\u5408\u306b\u3001 nginx \u304b\u3089 Web\u30a2\u30d7\u30ea1 \u3068 Web\u30a2\u30d7\u30ea2 \u306b\u30ea\u30f3\u30af\u3059\u308b\u3088\u3046\u306b\u4f5c\u308a\u305f\u3044\u306e\u3067\u3059\u304c\u3001\ndocker-compose \u3067\u4f5c\u3063\u305f\u30b3\u30f3\u30c6\u30ca\u306f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u5206\u304b\u308c\u3066\u3044\u308b\uff1f\u306e\u3067\u3001\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u6307\u5b9a\u3057\u3066\u3042\u3052\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u307f\u305f\u3044\u3067\u3059\u3002\n\n\u65b9\u6cd5\n\n\u65b9\u6cd51: nginx\u304b\u3089\u3001\u5404\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\n\n\u30e1\u30ea\u30c3\u30c8\n\n\n\u5404\u30a2\u30d7\u30ea\u306edocker-compose.yml\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b9a\u7fa9\u3092\u66f8\u304b\u306a\u304f\u3066\u826f\u3044\n\n\n\u30c7\u30e1\u30ea\u30c3\u30c8\n\n\n\u30a2\u30d7\u30ea\u304c\u5897\u3048\u308b\u3068nginx\u306edocker-compose.yml\u306b\u66f8\u304f\u8a2d\u5b9a\u304c\u5897\u3048\u308b\n\u30a2\u30d7\u30ea\u306e\u8ffd\u52a0\u3068\u524a\u9664\u6642\u306b\u6bce\u56dedocker-compose.yml\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n\u5404\u30a2\u30d7\u30ea\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540d\u304c\u5909\u308f\u3063\u305f\u5834\u5408\u306f\u3001nginx\u306edocker-compose.yml\u3092\u76f4\u3059\u5fc5\u8981\u304c\u3042\u308b(\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u304c\u5909\u308f\u3063\u305f\u6642\u306a\u3069)\n\n\n\n\n\u65b9\u6cd52: \u5171\u901a\u30ea\u30f3\u30af\u7528\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3057\u3066\u3001nginx\u3068\u5404\u30a2\u30d7\u30ea\u3067\u305d\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\n\n\u30e1\u30ea\u30c3\u30c8\n\n\n\u30a2\u30d7\u30ea\u306e\u8ffd\u52a0\u3068\u524a\u9664\u6642\u306bdocker-compose.yml\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\n\n\n\u30c7\u30e1\u30ea\u30c3\u30c8\n\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30921\u500b\u4f5c\u3063\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\n\u5404\u30a2\u30d7\u30ea\u306edocker-compose.yml\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3092\u66f8\u304f\u5fc5\u8981\u304c\u3042\u308b\n\n\n\n\n\n\n\u65b9\u6cd51: nginx\u304b\u3089\u3001\u5404\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\nnginx\u306edocker-compose.yml\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3092\u66f8\u304d\u307e\u3059\u3002\nnginx\nversion: '2'\nservices:\n    nginx:\n        image: nginx:latest\n        container_name: nginx\n        ports:\n            - '80:80'\n            - '443:443'\n        volumes:\n            - ./volumes/conf.d:/etc/nginx/conf.d\n            - ./volumes/certs:/etc/nginx/certs\n        networks:\n            - default\n            - webapp1_default\n            - webapp2_default\nnetworks:\n    webapp1_default:\n        external: true\n    webapp2_default:\n        external: true\n\n\u3053\u306e\u3088\u3046\u306b\u30012\u7b87\u6240\u306b networks \u306e\u5b9a\u7fa9\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u308b\u3068\u3001\u305d\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u898b\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540d\u306e\u8abf\u3079\u65b9\n\ndocker network ls\ndocker network ls \u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u73fe\u5728 docker \u306b\u5b58\u5728\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4e00\u89a7\u304c\u51fa\u3066\u304d\u307e\u3059\u3002\n$ docker network ls\nNETWORK ID          NAME                   DRIVER\nxxxxxxxxxxxx        bridge                 bridge              \nxxxxxxxxxxxx        host                   host                \nxxxxxxxxxxxx        nginx_default          bridge              \nxxxxxxxxxxxx        webapp1_default        bridge              \nxxxxxxxxxxxx        webapp2_default        bridge              \n\n\ndocker-compose up -d\ndocker-compose up -d \u3092\u5b9f\u884c\u3057\u305f\u6642\u306b\u3082\u51fa\u3066\u304d\u307e\u3059\u3002\n$ docker-compose up -d\nCreating network \"webapp1_default\" with the default driver\nCreating webapp1\n\n\n\u65b9\u6cd52: \u5171\u901a\u30ea\u30f3\u30af\u7528\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3057\u3066\u3001nginx\u3068\u5404\u30a2\u30d7\u30ea\u3067\u305d\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\n\u307e\u305a\u3001\u5171\u901a\u3067\u4f7f\u3046\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u540d\u524d\u306f\u3068\u308a\u3042\u3048\u305a\u3001 common_link \u3067\u4f5c\u308a\u307e\u3059\u3002\n\u53c2\u8003: http://docs.docker.jp/engine/userguide/networking/dockernetworks.html#id3\ndocker network create --driver bridge common_link\n\n\u4f5c\u6210\u3057\u305f\u3089\u3001 docker network ls \u3067\u78ba\u8a8d\u51fa\u6765\u307e\u3059\u3002\n$ docker network ls\nNETWORK ID          NAME                   DRIVER\n...\nxxxxxxxxxxxx        common_link            bridge              \n...\n\n\u6b21\u306b\u3001nginx\u3068\u5404\u30a2\u30d7\u30ea\u306edocker-compose.yml\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3092\u66f8\u304d\u307e\u3059\u3002\n\u30a2\u30d7\u30ea1\nversion: '2'\nservices:\n    webapp1:\n        \u301c\u8272\u3005\u306a\u8a2d\u5b9a\u7701\u7565\u301c\n        networks:\n            - common_link\nnetworks:\n    common_link:\n        external: true\n\nnginx\nversion: '2'\nservices:\n    nginx:\n        image: nginx:latest\n        container_name: nginx\n        ports:\n            - '80:80'\n            - '443:443'\n        volumes:\n            - ./volumes/conf.d:/etc/nginx/conf.d\n            - ./volumes/certs:/etc/nginx/certs\n        networks:\n            - common_link\nnetworks:\n    common_link:\n        external: true\n\nnetworks \u306e\u8a2d\u5b9a\u3092\u66f8\u3051\u3070OK\u3067\u3059\u3002\n\n\u53c2\u8003\n\nhttp://docs.docker.jp/compose/networking.html\nhttp://docs.docker.jp/compose/compose-file.html#network-configuration-reference\n\n\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306e\u3088\u3046\u306b\u3001\uff11\u3064\u306e\u30b5\u30fc\u30d0\u30fc\u306b\u8907\u6570\u306eWeb\u30a2\u30d7\u30ea\u3092\u7f6e\u3044\u3066\u304a\u304d\u305f\u3044\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u969b\u306b\u3001nginx\u3068\u5404\u30a2\u30d7\u30ea\u306b\u306f\u305d\u308c\u305e\u308c\u306e docker-compose.yml \u3092\u4f5c\u3063\u3066\u5225\u3005\u306b\u7ba1\u7406\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n* nginx (\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7)\n  * Web\u30a2\u30d7\u30ea1 (PHP http)\n  * Web\u30a2\u30d7\u30ea2 (Python uWSGI)\n  * ...\n\n\u3053\u306e\u5834\u5408\u306b\u3001 **nginx** \u304b\u3089 **Web\u30a2\u30d7\u30ea1** \u3068 **Web\u30a2\u30d7\u30ea2** \u306b\u30ea\u30f3\u30af\u3059\u308b\u3088\u3046\u306b\u4f5c\u308a\u305f\u3044\u306e\u3067\u3059\u304c\u3001\ndocker-compose \u3067\u4f5c\u3063\u305f\u30b3\u30f3\u30c6\u30ca\u306f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u5206\u304b\u308c\u3066\u3044\u308b\uff1f\u306e\u3067\u3001\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u6307\u5b9a\u3057\u3066\u3042\u3052\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u307f\u305f\u3044\u3067\u3059\u3002\n\n## \u65b9\u6cd5\n\n* \u65b9\u6cd51: **nginx\u304b\u3089\u3001\u5404\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b**\n    * \u30e1\u30ea\u30c3\u30c8\n        * \u5404\u30a2\u30d7\u30ea\u306edocker-compose.yml\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b9a\u7fa9\u3092\u66f8\u304b\u306a\u304f\u3066\u826f\u3044\n    * \u30c7\u30e1\u30ea\u30c3\u30c8\n        * \u30a2\u30d7\u30ea\u304c\u5897\u3048\u308b\u3068nginx\u306edocker-compose.yml\u306b\u66f8\u304f\u8a2d\u5b9a\u304c\u5897\u3048\u308b\n        * \u30a2\u30d7\u30ea\u306e\u8ffd\u52a0\u3068\u524a\u9664\u6642\u306b\u6bce\u56dedocker-compose.yml\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\n        * \u5404\u30a2\u30d7\u30ea\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540d\u304c\u5909\u308f\u3063\u305f\u5834\u5408\u306f\u3001nginx\u306edocker-compose.yml\u3092\u76f4\u3059\u5fc5\u8981\u304c\u3042\u308b(\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u304c\u5909\u308f\u3063\u305f\u6642\u306a\u3069)\n* \u65b9\u6cd52: **\u5171\u901a\u30ea\u30f3\u30af\u7528\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3057\u3066\u3001nginx\u3068\u5404\u30a2\u30d7\u30ea\u3067\u305d\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b**\n    * \u30e1\u30ea\u30c3\u30c8\n        * \u30a2\u30d7\u30ea\u306e\u8ffd\u52a0\u3068\u524a\u9664\u6642\u306bdocker-compose.yml\u3092\u5909\u66f4\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\n    * \u30c7\u30e1\u30ea\u30c3\u30c8\n        * \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30921\u500b\u4f5c\u3063\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\n        * \u5404\u30a2\u30d7\u30ea\u306edocker-compose.yml\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3092\u66f8\u304f\u5fc5\u8981\u304c\u3042\u308b\n\n## \u65b9\u6cd51: nginx\u304b\u3089\u3001\u5404\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\n\nnginx\u306edocker-compose.yml\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3092\u66f8\u304d\u307e\u3059\u3002\n\n**nginx**\n\n```\nversion: '2'\nservices:\n    nginx:\n        image: nginx:latest\n        container_name: nginx\n        ports:\n            - '80:80'\n            - '443:443'\n        volumes:\n            - ./volumes/conf.d:/etc/nginx/conf.d\n            - ./volumes/certs:/etc/nginx/certs\n        networks:\n            - default\n            - webapp1_default\n            - webapp2_default\nnetworks:\n    webapp1_default:\n        external: true\n    webapp2_default:\n        external: true\n```\n\n\u3053\u306e\u3088\u3046\u306b\u30012\u7b87\u6240\u306b `networks` \u306e\u5b9a\u7fa9\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u308b\u3068\u3001\u305d\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u898b\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n### \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540d\u306e\u8abf\u3079\u65b9\n\n#### docker network ls\n\n`docker network ls` \u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u73fe\u5728 docker \u306b\u5b58\u5728\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4e00\u89a7\u304c\u51fa\u3066\u304d\u307e\u3059\u3002\n\n```\n$ docker network ls\nNETWORK ID          NAME                   DRIVER\nxxxxxxxxxxxx        bridge                 bridge              \nxxxxxxxxxxxx        host                   host                \nxxxxxxxxxxxx        nginx_default          bridge              \nxxxxxxxxxxxx        webapp1_default        bridge              \nxxxxxxxxxxxx        webapp2_default        bridge              \n```\n\n#### docker-compose up -d\n\n`docker-compose up -d` \u3092\u5b9f\u884c\u3057\u305f\u6642\u306b\u3082\u51fa\u3066\u304d\u307e\u3059\u3002\n\n```\n$ docker-compose up -d\nCreating network \"webapp1_default\" with the default driver\nCreating webapp1\n```\n\n## \u65b9\u6cd52: \u5171\u901a\u30ea\u30f3\u30af\u7528\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3057\u3066\u3001nginx\u3068\u5404\u30a2\u30d7\u30ea\u3067\u305d\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\n\n\u307e\u305a\u3001\u5171\u901a\u3067\u4f7f\u3046\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u540d\u524d\u306f\u3068\u308a\u3042\u3048\u305a\u3001 **common_link** \u3067\u4f5c\u308a\u307e\u3059\u3002\n\u53c2\u8003: http://docs.docker.jp/engine/userguide/networking/dockernetworks.html#id3\n\n```\ndocker network create --driver bridge common_link\n```\n\n\u4f5c\u6210\u3057\u305f\u3089\u3001 `docker network ls` \u3067\u78ba\u8a8d\u51fa\u6765\u307e\u3059\u3002\n\n```\n$ docker network ls\nNETWORK ID          NAME                   DRIVER\n...\nxxxxxxxxxxxx        common_link            bridge              \n...\n```\n\n\u6b21\u306b\u3001nginx\u3068\u5404\u30a2\u30d7\u30ea\u306edocker-compose.yml\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3092\u66f8\u304d\u307e\u3059\u3002\n\n**\u30a2\u30d7\u30ea1**\n\n```\nversion: '2'\nservices:\n    webapp1:\n        \u301c\u8272\u3005\u306a\u8a2d\u5b9a\u7701\u7565\u301c\n        networks:\n            - common_link\nnetworks:\n    common_link:\n        external: true\n```\n\n**nginx**\n\n```\nversion: '2'\nservices:\n    nginx:\n        image: nginx:latest\n        container_name: nginx\n        ports:\n            - '80:80'\n            - '443:443'\n        volumes:\n            - ./volumes/conf.d:/etc/nginx/conf.d\n            - ./volumes/certs:/etc/nginx/certs\n        networks:\n            - common_link\nnetworks:\n    common_link:\n        external: true\n```\n\n`networks` \u306e\u8a2d\u5b9a\u3092\u66f8\u3051\u3070OK\u3067\u3059\u3002\n\n## \u53c2\u8003\n\n* http://docs.docker.jp/compose/networking.html\n* http://docs.docker.jp/compose/compose-file.html#network-configuration-reference\n", "tags": ["docker-compose", "docker"]}