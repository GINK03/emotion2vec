{"tags": ["\u4e2d\u56fd\u8a9e", "Unity2D"], "context": "\n\n\u7576\u89d2\u8272\u5230\u9054\u969c\u7919\u7269\u5f8c\u65b9\u6642\uff0c\u969c\u7919\u7269\u7684\u534a\u900f\u660e\u8655\u7406\n\uff32\uff30\uff27\u5e38\u6703\u6709\u7684\u4e00\u500b\u6a5f\u80fd\uff0c \u5c31\u662f\u7576\u73a9\u5bb6\u5230\u4e86\u5efa\u7bc9\u7269\u5f8c\u6216\u662f\u7246\u5f8c\uff0c \u5efa\u7bc9\u7269\u6216\u7246\u6703\u5448\u534a\u900f\u660e\u72c0\u614b\u3002\n\u5148\u524d\u6709\u67e5\u904e\uff0c\u6709\u524d\u8f29\u5229\u7528canvansGrop\u4f86\u8655\u7406\uff0c \u4f46\u56e0\u70ba\u81ea\u5df1\u4e0d\u60f3\u518d\u589e\u52a0canvans\uff0c \n\u56e0\u6b64\u5c31\u76f4\u63a5\u5229\u7528\u4ee3\u78bc\u66f4\u6539SpriteRenderer\u7684Layer\u4e86\u3002\n\u96d6\u7136\u76f4\u63a5\u4f7f\u7528z\u8ef8\u4e5f\u53ef\u4ee5\uff0c \u4f46\u56e0\u70ba\u8a2d\u7f6e\u95dc\u4fc2\u5c31\u4e0d\u4f7f\u7528z\u8ef8\u4e86...\n\n\u30fb\u5b8c\u6210\u6548\u679cgif\uff1a\n\n\n\u30fb\u6d41\u7a0b\uff1a\n1.\u9996\u5148\u6211\u5011\u5728Map\u4e0a\u653e\u7f6e\u5c0d\u8c61(Sprite)\n\n2.\u589e\u52a0Layer\u5c64(\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728SpriteRenderer\u7684Sorting Layer\u6dfb\u52a0)\n\n\u524d\u5f8c\u9806\u5e8f\u8981\u8a18\u5f97\u8b93Player\u5728\u4e2d\u9593\n\n3.\u6dfb\u52a0\u78b0\u649e\u5224\u5b9aBoxCollider2D\n\n4.\u4e26\u52fe\u4e0aisTrigger\n\n5.\u5275\u5efa\u8655\u7406\u8173\u672c\u300eMapPartsAlphaController.cs\u300f\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.UI;\n\npublic class MapPartsAlphaController : MonoBehaviour \n{\n    /// <summary>\n    /// \u76ee\u6a19\u7684SpriteRenderer.\n    /// </summary>\n    [SerializeField]\n    private SpriteRenderer _sprite;\n\n    /// <summary>\n    /// \u524d\u5f8c\u4f4d\u7f6e\u5b9a\u6578(string)\n    /// </summary>\n    private const string _kSORTING_LAYER_BACK = \"MapItemBack\";\n    private const string _kSORTING_LAYER_FRONT = \"MapItemFront\";\n\n    /// <summary>\n    /// \u534a\u900f\u660e\u7684\u984f\u8272\u5b9a\u6578\n    /// </summary>\n    private readonly Color _kTRANSLUCENT = new Color(1, 1, 1, 0.5f);\n\n    /// <summary>\n    /// \u6062\u5fa9\u539f\u672c\u984f\u8272\u8a2d\u5b9a\u7684\u5b9a\u6578\n    /// </summary>\n    private readonly Color _kNORMAL_COLOR = new Color(1, 1, 1, 1);\n\n    void Awake()\n    {\n        _sprite = this.GetComponent<SpriteRenderer> ();\n\n        // sortingLayerName\u7684\u521d\u671f\u5316\uff0c\u7d71\u4e00\u653e\u5f8c\n        _sprite.sortingLayerName = _kSORTING_LAYER_BACK;\n    }\n\n    /// <summary>\n    /// \u7bc4\u570d\u5916\n    /// </summary>\n    void OnTriggerExit2D(Collider2D collider2d)\n    {\n        if(collider2d.tag == \"Player\"){\n            _sprite.sortingLayerName = _kSORTING_LAYER_BACK;\n            _sprite.color = _kNORMAL_COLOR;\n        }\n    }\n\n    /// <summary>\n    /// \u7bc4\u570d\u5167\n    /// </summary>\n    void OnTriggerStay2D(Collider2D collider2d)\n    {\n        if(collider2d.tag == \"Player\"){\n\n            // \u5229\u7528y\u8ef8\u5224\u65b7\u73a9\u5bb6\u5728\u76ee\u6a19\u7684\u4f4d\u7f6e\uff08\u524d\u5f8c\uff09\n            bool isBack = (collider2d.transform.localPosition.y < this.transform.localPosition.y);\n\n            if(isBack){\n                _sprite.sortingLayerName = _kSORTING_LAYER_BACK;\n            }\n            else{\n                _sprite.sortingLayerName = _kSORTING_LAYER_FRONT;\n            }\n            // \u534a\u900f\u660e\n            _sprite.color = _kTRANSLUCENT;\n        }\n    }\n}\n\n6.\u5c07\u8173\u672c\u639b\u4e0a\u88ab\u57f7\u884c\u76ee\u6a19\n\n\u5b8c\u6210\uff01\n##\u7576\u89d2\u8272\u5230\u9054\u969c\u7919\u7269\u5f8c\u65b9\u6642\uff0c\u969c\u7919\u7269\u7684\u534a\u900f\u660e\u8655\u7406\n\n\uff32\uff30\uff27\u5e38\u6703\u6709\u7684\u4e00\u500b\u6a5f\u80fd\uff0c \u5c31\u662f\u7576\u73a9\u5bb6\u5230\u4e86\u5efa\u7bc9\u7269\u5f8c\u6216\u662f\u7246\u5f8c\uff0c \u5efa\u7bc9\u7269\u6216\u7246\u6703\u5448\u534a\u900f\u660e\u72c0\u614b\u3002\n\n\u5148\u524d\u6709\u67e5\u904e\uff0c\u6709\u524d\u8f29\u5229\u7528canvansGrop\u4f86\u8655\u7406\uff0c \u4f46\u56e0\u70ba\u81ea\u5df1\u4e0d\u60f3\u518d\u589e\u52a0canvans\uff0c \n\u56e0\u6b64\u5c31\u76f4\u63a5\u5229\u7528\u4ee3\u78bc\u66f4\u6539SpriteRenderer\u7684Layer\u4e86\u3002\n\u96d6\u7136\u76f4\u63a5\u4f7f\u7528z\u8ef8\u4e5f\u53ef\u4ee5\uff0c \u4f46\u56e0\u70ba\u8a2d\u7f6e\u95dc\u4fc2\u5c31\u4e0d\u4f7f\u7528z\u8ef8\u4e86...\n\n###\u30fb\u5b8c\u6210\u6548\u679cgif\uff1a\n![no1.gif](https://qiita-image-store.s3.amazonaws.com/0/157597/3b929e60-97f5-f66a-3add-62a20922ef3c.gif)\n\n###\u30fb\u6d41\u7a0b\uff1a\n1.\u9996\u5148\u6211\u5011\u5728Map\u4e0a\u653e\u7f6e\u5c0d\u8c61(Sprite)\n![6.png](https://qiita-image-store.s3.amazonaws.com/0/157597/855ce21d-0ca1-3b76-3a34-2859239cfcbe.png)\n\n\n2.\u589e\u52a0Layer\u5c64(\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728SpriteRenderer\u7684Sorting Layer\u6dfb\u52a0)\n![8.png](https://qiita-image-store.s3.amazonaws.com/0/157597/dd276c38-5819-3992-01ac-d192218f0792.png)\n\n\n**\u524d\u5f8c\u9806\u5e8f\u8981\u8a18\u5f97\u8b93Player\u5728\u4e2d\u9593**\n![10.png](https://qiita-image-store.s3.amazonaws.com/0/157597/9c8a7865-f45d-2da9-a86c-85cd9f520e16.png)\n\n\n3.\u6dfb\u52a0\u78b0\u649e\u5224\u5b9aBoxCollider2D\n![5.png](https://qiita-image-store.s3.amazonaws.com/0/157597/e1bdcca0-6529-6833-1dba-0ea1e361412f.png)\n\n\n4.\u4e26\u52fe\u4e0aisTrigger\n![4.png](https://qiita-image-store.s3.amazonaws.com/0/157597/db4db226-6e1b-e37d-3058-538724fd2bd6.png)\n\n\n5.\u5275\u5efa\u8655\u7406\u8173\u672c\u300eMapPartsAlphaController.cs\u300f\n\n```C# \nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.UI;\n\npublic class MapPartsAlphaController : MonoBehaviour \n{\n\t/// <summary>\n\t/// \u76ee\u6a19\u7684SpriteRenderer.\n\t/// </summary>\n\t[SerializeField]\n\tprivate SpriteRenderer _sprite;\n\n\t/// <summary>\n\t/// \u524d\u5f8c\u4f4d\u7f6e\u5b9a\u6578(string)\n\t/// </summary>\n\tprivate const string _kSORTING_LAYER_BACK = \"MapItemBack\";\n\tprivate const string _kSORTING_LAYER_FRONT = \"MapItemFront\";\n\n\t/// <summary>\n\t/// \u534a\u900f\u660e\u7684\u984f\u8272\u5b9a\u6578\n\t/// </summary>\n\tprivate readonly Color _kTRANSLUCENT = new Color(1, 1, 1, 0.5f);\n\n\t/// <summary>\n\t/// \u6062\u5fa9\u539f\u672c\u984f\u8272\u8a2d\u5b9a\u7684\u5b9a\u6578\n\t/// </summary>\n\tprivate readonly Color _kNORMAL_COLOR = new Color(1, 1, 1, 1);\n\n\tvoid Awake()\n\t{\n\t\t_sprite = this.GetComponent<SpriteRenderer> ();\n\n\t\t// sortingLayerName\u7684\u521d\u671f\u5316\uff0c\u7d71\u4e00\u653e\u5f8c\n\t\t_sprite.sortingLayerName = _kSORTING_LAYER_BACK;\n\t}\n\n\t/// <summary>\n\t/// \u7bc4\u570d\u5916\n\t/// </summary>\n\tvoid OnTriggerExit2D(Collider2D collider2d)\n\t{\n\t\tif(collider2d.tag == \"Player\"){\n\t\t\t_sprite.sortingLayerName = _kSORTING_LAYER_BACK;\n\t\t\t_sprite.color = _kNORMAL_COLOR;\n\t\t}\n\t}\n\n\t/// <summary>\n\t/// \u7bc4\u570d\u5167\n\t/// </summary>\n\tvoid OnTriggerStay2D(Collider2D collider2d)\n\t{\n\t\tif(collider2d.tag == \"Player\"){\n\t\t\t\n\t\t\t// \u5229\u7528y\u8ef8\u5224\u65b7\u73a9\u5bb6\u5728\u76ee\u6a19\u7684\u4f4d\u7f6e\uff08\u524d\u5f8c\uff09\n\t\t\tbool isBack = (collider2d.transform.localPosition.y < this.transform.localPosition.y);\n\n\t\t\tif(isBack){\n\t\t\t\t_sprite.sortingLayerName = _kSORTING_LAYER_BACK;\n\t\t\t}\n\t\t\telse{\n\t\t\t\t_sprite.sortingLayerName = _kSORTING_LAYER_FRONT;\n\t\t\t}\n\t\t\t// \u534a\u900f\u660e\n\t\t\t_sprite.color = _kTRANSLUCENT;\n\t\t}\n\t}\n}\n```\n\n\n6.\u5c07\u8173\u672c\u639b\u4e0a\u88ab\u57f7\u884c\u76ee\u6a19\n![7.png](https://qiita-image-store.s3.amazonaws.com/0/157597/a1efec8c-e1ef-b900-a46e-591fb9683462.png)\n\n\u5b8c\u6210\uff01\n"}