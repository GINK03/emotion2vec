{"tags": ["VBA", "Excel"], "context": "\n\n\u306f\u3058\u3081\u306b\n\u81ea\u5206\u304c\u3044\u3064\u3082\u884c\u3063\u3066\u3044\u308b\u56f2\u307f\u65b9\u304c\u3001\uff08\u4f53\u611f\u3067\u304d\u308b\u304b\u306f\u7f6e\u3044\u3066\u304a\u3044\u3066\uff09\u52b9\u7387\u9762\u3067\u3042\u307e\u308a\u3088\u308d\u3057\u304f\u306a\u3044\u65b9\u6cd5\u3060\u3063\u305f\u3002\n\u81ea\u5206\u306e\u611f\u899a\u3060\u3068\u9055\u548c\u611f\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u540c\u3058\u611f\u899a\u306e\u4eba\u3082\u3044\u308b\u3060\u308d\u3046\u3068\u5099\u5fd8\u9332\u3064\u3044\u3067\u306b\u516c\u958b\u3002\n\n\u914d\u5217\u306b\u3064\u3044\u3066\n\u540c\u3058\u7a2e\u985e\u306e\u30c7\u30fc\u30bf\u3092\u30e1\u30e2\u30ea\u4e0a\u306b\u9699\u9593\u306a\u304f\u4e26\u3079\u305f\u3082\u306e\u3002\n\u4f7f\u3046\u30c7\u30fc\u30bf\u304c\u96a3\u308a\u5408\u3063\u3066\u3044\u308b\u306a\u3089\u3001CPU\u304c\u30c7\u30fc\u30bf\u3092\u6c42\u3081\u3066\u30e1\u30e2\u30ea\u4e0a\u3092\u63a2\u3059\u624b\u9593\u304c\u6e1b\u308b\u305f\u3081\u51e6\u7406\u52b9\u7387\u304c\u826f\u304f\u306a\u308b\u3002\n\u2192\u30e1\u30e2\u30ea\u306e\u30a2\u30c9\u30ec\u30b9\u9806\u306b\u914d\u5217\u306e\u8981\u7d20\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u52b9\u7387\u304c\u826f\u3044\u3002\n\n\u5177\u4f53\u7684\u306b\u306f\u2192\u5927\u304d\u3044\u6b21\u5143\u306e\u6dfb\u3048\u5b57\u304b\u3089\u56f2\u3080\n\u60aa\u3044\u4f8b\n'\u60aa\u3044\u4f8b\n'sampleArray(0 To X, 0 To Y)\nDim i&, j&\nFor i = 0 To X  '1\u6b21\u5143\u76ee\n    For j = 0 To Y  '2\u6b21\u5143\u76ee\n        '\n        'Debug.Print VarPtr(sampleArray(i, j))\n        'sampleArray(i, j)\u3092\u4f7f\u3063\u3066\u4f55\u304b\u51e6\u7406\n        '\n    Next j\nNext i\n\n\u826f\u3044\u4f8b\n'\u826f\u3044\u4f8b\n'sampleArray(0 To X, 0 To Y)\nDim i&, j&\nFor j = 0 To Y  '2\u6b21\u5143\u76ee\n    For i = 0 To X  '1\u6b21\u5143\u76ee\n        '\n        'Debug.Print VarPtr(sampleArray(i, j))\n        'sampleArray(i, j)\u3092\u4f7f\u3063\u3066\u4f55\u304b\u51e6\u7406\n        '\n    Next i\nNext j\n\ni,j\u306e\u9806\u756a\u304c\u305a\u308c\u308b\u306e\u304c\u6c17\u306b\u306a\u308b\u304c\u3001\u3053\u3061\u3089\u306e\u307b\u3046\u304c\u30e1\u30e2\u30ea\u306e\u30a2\u30af\u30bb\u30b9\u9806\u306e\u9762\u3067\u3088\u308a\u826f\u3044\u65b9\u6cd5\u3068\u306a\u308b\u3002\n\n\u305d\u306e\u4ed6\u30b5\u30f3\u30d7\u30eb\n'Excel\u3067\u5b9f\u884c\u3059\u308b\u3053\u3068\u524d\u63d0\nSub \u914d\u5217\u30a2\u30c9\u30ec\u30b9\u30c6\u30b9\u30c8()\n    Dim tmpArray() As Variant\n\n    Let tmpArray = Range(\"A1:A9\").Value\n    Call PrintArrayAddress(tmpArray, \"9\u884c1\u5217\")\n\n    Let tmpArray = Range(\"A1:I1\").Value\n    Call PrintArrayAddress(tmpArray, \"1\u884c9\u5217\")\n\n    Let tmpArray = Range(\"A1:C3\").Value\n    Call PrintArrayAddress(tmpArray, \"3\u884c3\u5217\")\n\nEnd Sub\n\nSub PrintArrayAddress(ByRef inputArray() As Variant, ByVal iArrayName As String)\n    Dim i&, j&\n    Debug.Print vbCrLf; iArrayName; \"\u306e\u914d\u5217\u30a2\u30c9\u30ec\u30b9\"\n\n    '\u826f\u304f\u306a\u3044\u30a2\u30af\u30bb\u30b9\u65b9\u6cd5\u306a\u306e\u30673\u884c3\u5217\u306e\u914d\u5217\u3067\u306f\u30a2\u30c9\u30ec\u30b9\u304c\u305a\u308c\u3066\u51fa\u529b\u3055\u308c\u308b\n    For i = LBound(inputArray, 1) To UBound(inputArray, 1) Step 1\n        For j = LBound(inputArray, 2) To UBound(inputArray, 2) Step 1\n            Debug.Print iArrayName; \"(\"; i; \",\"; j; \")\", VarPtr(inputArray(i, j))\n        Next j\n    Next i\nEnd Sub\n\n\n\u53c2\u8003\n\u3044\u3064\u3082\u304a\u4e16\u8a71\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\nVBA ReDim\u306f\u306a\u305c\u6700\u5f8c\u306e\u6b21\u5143\u3060\u3051\u3057\u304b\u62e1\u5f35\u3067\u304d\u306a\u3044\u306e\u304b\u3002\nVBA \u914d\u5217\u3068\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u9055\u3044\u3092\u30e1\u30e2\u30ea\u4e0a\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u304b\u3089\u7406\u89e3\u3059\u308b\n\n# \u306f\u3058\u3081\u306b\n\n\u81ea\u5206\u304c\u3044\u3064\u3082\u884c\u3063\u3066\u3044\u308b\u56f2\u307f\u65b9\u304c\u3001\uff08\u4f53\u611f\u3067\u304d\u308b\u304b\u306f\u7f6e\u3044\u3066\u304a\u3044\u3066\uff09\u52b9\u7387\u9762\u3067\u3042\u307e\u308a\u3088\u308d\u3057\u304f\u306a\u3044\u65b9\u6cd5\u3060\u3063\u305f\u3002\n\n\u81ea\u5206\u306e\u611f\u899a\u3060\u3068\u9055\u548c\u611f\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u540c\u3058\u611f\u899a\u306e\u4eba\u3082\u3044\u308b\u3060\u308d\u3046\u3068\u5099\u5fd8\u9332\u3064\u3044\u3067\u306b\u516c\u958b\u3002\n\n# \u914d\u5217\u306b\u3064\u3044\u3066\n\n\u540c\u3058\u7a2e\u985e\u306e\u30c7\u30fc\u30bf\u3092\u30e1\u30e2\u30ea\u4e0a\u306b\u9699\u9593\u306a\u304f\u4e26\u3079\u305f\u3082\u306e\u3002\n\u4f7f\u3046\u30c7\u30fc\u30bf\u304c\u96a3\u308a\u5408\u3063\u3066\u3044\u308b\u306a\u3089\u3001CPU\u304c\u30c7\u30fc\u30bf\u3092\u6c42\u3081\u3066\u30e1\u30e2\u30ea\u4e0a\u3092\u63a2\u3059\u624b\u9593\u304c\u6e1b\u308b\u305f\u3081\u51e6\u7406\u52b9\u7387\u304c\u826f\u304f\u306a\u308b\u3002\n\n\u2192\u30e1\u30e2\u30ea\u306e\u30a2\u30c9\u30ec\u30b9\u9806\u306b\u914d\u5217\u306e\u8981\u7d20\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u52b9\u7387\u304c\u826f\u3044\u3002\n\n# \u5177\u4f53\u7684\u306b\u306f\u2192\u5927\u304d\u3044\u6b21\u5143\u306e\u6dfb\u3048\u5b57\u304b\u3089\u56f2\u3080\n\n\u60aa\u3044\u4f8b\n\n```vbnet\n'\u60aa\u3044\u4f8b\n'sampleArray(0 To X, 0 To Y)\nDim i&, j&\nFor i = 0 To X  '1\u6b21\u5143\u76ee\n    For j = 0 To Y  '2\u6b21\u5143\u76ee\n        '\n        'Debug.Print VarPtr(sampleArray(i, j))\n        'sampleArray(i, j)\u3092\u4f7f\u3063\u3066\u4f55\u304b\u51e6\u7406\n        '\n    Next j\nNext i\n```\n\n\u826f\u3044\u4f8b\n\n\n```vbnet\n'\u826f\u3044\u4f8b\n'sampleArray(0 To X, 0 To Y)\nDim i&, j&\nFor j = 0 To Y  '2\u6b21\u5143\u76ee\n    For i = 0 To X  '1\u6b21\u5143\u76ee\n        '\n        'Debug.Print VarPtr(sampleArray(i, j))\n        'sampleArray(i, j)\u3092\u4f7f\u3063\u3066\u4f55\u304b\u51e6\u7406\n        '\n    Next i\nNext j\n```\n\n`i,j`\u306e\u9806\u756a\u304c\u305a\u308c\u308b\u306e\u304c\u6c17\u306b\u306a\u308b\u304c\u3001\u3053\u3061\u3089\u306e\u307b\u3046\u304c\u30e1\u30e2\u30ea\u306e\u30a2\u30af\u30bb\u30b9\u9806\u306e\u9762\u3067\u3088\u308a\u826f\u3044\u65b9\u6cd5\u3068\u306a\u308b\u3002\n\n# \u305d\u306e\u4ed6\u30b5\u30f3\u30d7\u30eb\n\n```vbnet\n'Excel\u3067\u5b9f\u884c\u3059\u308b\u3053\u3068\u524d\u63d0\nSub \u914d\u5217\u30a2\u30c9\u30ec\u30b9\u30c6\u30b9\u30c8()\n    Dim tmpArray() As Variant\n    \n    Let tmpArray = Range(\"A1:A9\").Value\n    Call PrintArrayAddress(tmpArray, \"9\u884c1\u5217\")\n    \n    Let tmpArray = Range(\"A1:I1\").Value\n    Call PrintArrayAddress(tmpArray, \"1\u884c9\u5217\")\n    \n    Let tmpArray = Range(\"A1:C3\").Value\n    Call PrintArrayAddress(tmpArray, \"3\u884c3\u5217\")\n    \nEnd Sub\n\nSub PrintArrayAddress(ByRef inputArray() As Variant, ByVal iArrayName As String)\n    Dim i&, j&\n    Debug.Print vbCrLf; iArrayName; \"\u306e\u914d\u5217\u30a2\u30c9\u30ec\u30b9\"\n    \n    '\u826f\u304f\u306a\u3044\u30a2\u30af\u30bb\u30b9\u65b9\u6cd5\u306a\u306e\u30673\u884c3\u5217\u306e\u914d\u5217\u3067\u306f\u30a2\u30c9\u30ec\u30b9\u304c\u305a\u308c\u3066\u51fa\u529b\u3055\u308c\u308b\n    For i = LBound(inputArray, 1) To UBound(inputArray, 1) Step 1\n        For j = LBound(inputArray, 2) To UBound(inputArray, 2) Step 1\n            Debug.Print iArrayName; \"(\"; i; \",\"; j; \")\", VarPtr(inputArray(i, j))\n        Next j\n    Next i\nEnd Sub\n```\n\n# \u53c2\u8003\n\u3044\u3064\u3082\u304a\u4e16\u8a71\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n>[VBA ReDim\u306f\u306a\u305c\u6700\u5f8c\u306e\u6b21\u5143\u3060\u3051\u3057\u304b\u62e1\u5f35\u3067\u304d\u306a\u3044\u306e\u304b\u3002](http://thom.hateblo.jp/entry/2015/12/26/014523 \"VBA ReDim\u306f\u306a\u305c\u6700\u5f8c\u306e\u6b21\u5143\u3060\u3051\u3057\u304b\u62e1\u5f35\u3067\u304d\u306a\u3044\u306e\u304b\u3002\")\n\n>[VBA \u914d\u5217\u3068\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u9055\u3044\u3092\u30e1\u30e2\u30ea\u4e0a\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u304b\u3089\u7406\u89e3\u3059\u308b](http://thom.hateblo.jp/entry/2016/08/31/014820 \"VBA \u914d\u5217\u3068\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u9055\u3044\u3092\u30e1\u30e2\u30ea\u4e0a\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u304b\u3089\u7406\u89e3\u3059\u308b\")\n"}