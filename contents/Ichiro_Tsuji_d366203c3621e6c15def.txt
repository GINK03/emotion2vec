{"context": "\n\n\u6982\u8981\n\n\u672c\u30b3\u30f3\u30c6\u30f3\u30c4\u306f\u3001JAWS DAYS 2017\u306eIoT\u30cf\u30f3\u30ba\u30aa\u30f3\u5411\u3051\u306b\u4f5c\u6210\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u3092\u69cb\u7bc9\u3057\u3066\u3001\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u3092Quicksight\u3067\u53ef\u8996\u5316\u3057\u307e\u3059\u3002\n\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc -> RaspberryPi -> Kinesis Firehose -> S3 -> Athena -> Quicksight\n\u672c\u683c\u7684\u306a\u5206\u6790\u3084\u53ef\u8996\u5316\u306b\u3082\u8010\u3048\u3046\u308b\u69cb\u6210\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u3078\u306e\u5fdc\u7528\u3082\u53ef\u80fd\u3067\u3059\u3002\u307e\u305f\u3001\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u306e\u7d44\u307f\u7acb\u3066\u3067\u306f\u7c21\u5358\u306a\u96fb\u5b50\u5de5\u4f5c\u3092\u4f53\u9a13\u3067\u304d\u307e\u3059\u3002\n\n\n\uff1c\u524d\u7de8\uff1e\u306e\u7bc4\u56f2\n\uff1c\u524d\u7de8\uff1e\u3067\u306f\u3001\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc -> RaspberryPi -> Kinesis Firehose -> S3 \u306e\u90e8\u5206\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\u6210\u529f\u3059\u308c\u3070\u4e0b\u8a18\u306e\u3088\u3046\u306aJSON\u30e1\u30c3\u30bb\u30fc\u30b8\u304cS3\u30d0\u30b1\u30c3\u30c8\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\u6c4e\u7528\u7684\u306aJSON\u30e1\u30c3\u30bb\u30fc\u30b8\u3067\u3059\u306e\u3067\u3001\u5f8c\u5de5\u7a0b\u3067\u69d8\u3005\u306b\u6d3b\u7528\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd(\u30b3\u30b3\u91cd\u8981\uff01)\u3067\u3059\u3002\n{\"time\":\"2017-02-04 19:14:33\", \"temperature\":25.562}\n{\"time\":\"2017-02-04 19:14:43\", \"temperature\":25.562}\n{\"time\":\"2017-02-04 19:14:53\", \"temperature\":25.5}\n{\"time\":\"2017-02-04 19:15:03\", \"temperature\":19.5}\n{\"time\":\"2017-02-04 19:15:13\", \"temperature\":15.375}\n{\"time\":\"2017-02-04 19:15:23\", \"temperature\":14.5}\n\n\n\uff1c\u5f8c\u7de8\uff1e\u306f\u3053\u3061\u3089\n\n\n\u5fc5\u8981\u306a\u6a5f\u6750\n\n\nPC\nRaspberryPi 2\u307e\u305f\u306f3\nmicro USB\u96fb\u6e90\nmicro SD\u30ab\u30fc\u30c9 (8GB\u4ee5\u4e0a)\n\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u30bb\u30c3\u30c8\n\n\nDS18B20\n2.2k\u03a9\u30ab\u30fc\u30dc\u30f3\u62b5\u6297\n\u30d6\u30ec\u30c3\u30c9\u30dc\u30fc\u30c9\n\u30b8\u30e3\u30f3\u30d1\u30ef\u30a4\u30e4 \u30aa\u30b9\u30fc\u30e1\u30b9 3\u672c\n\n\n\n\n\u524d\u63d0\u6761\u4ef6\n\n\nAWS\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u3082\u3063\u3066\u3044\u308b\u3053\u3068\u3002\u30a2\u30ab\u30a6\u30f3\u30c8\u958b\u8a2d\u624b\u9806\u306f\u3053\u3061\u3089\n\nRaspberryPi\u306bRaspbian\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3067\u3001PC\u304b\u3089SSH\u3067\u30ed\u30b0\u30a4\u30f3\u307e\u305f\u306fHDMI\u63a5\u7d9a\u306e\u30e2\u30cb\u30bf\u3067\u30bf\u30fc\u30df\u30ca\u30eb\u64cd\u4f5c\u304c\u3067\u304d\u308b\u3053\u3068\u3002\u624b\u9806\u306f\u3053\u3061\u3089\u3002Raspbian\u306f[Release date:2017-01-11]\u3067\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\nRaspberryPi\u304c\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u3066\u3044\u308b\u3053\u3068\n\n\n\uff1c\u524d\u7de8\uff1e\u3067\u5229\u7528\u3059\u308bAWS\u30b5\u30fc\u30d3\u30b9\n\n\nAmazon Kinesis Firehose\n\n\u591a\u6570\u306e\u30ce\u30fc\u30c9\u304b\u3089\u30c7\u30fc\u30bf\u3092\u96c6\u7d04\u3059\u308b\u5834\u5408\u3001\u53e4\u304f\u306fFTP\u30b5\u30fc\u30d0\u3092\u5229\u7528\u3057\u307e\u3057\u305f\u3002\u73fe\u5728\u3067\u3042\u308c\u3070HTTP\u30d9\u30fc\u30b9\u306eAPI\u30b5\u30fc\u30d0\u3068\u3044\u3063\u305f\u3068\u3053\u308d\u3067\u3057\u3087\u3046\u304b\u3002\u6570\u5343\uff5e\u6570\u4e07\u3068\u3044\u3063\u305f\u591a\u6570\u306eIoT\u30a8\u30c3\u30b8\u30c7\u30d0\u30a4\u30b9\u30ce\u30fc\u30c9\u3092\u96c6\u7d04\u3059\u308b\u5834\u5408\u3001\u30b5\u30fc\u30d0\u306e\u30b9\u30b1\u30fc\u30eb\u3084\u5206\u6563\u51e6\u7406\u304c\u5927\u304d\u306a\u8ab2\u984c\u3068\u306a\u308a\u307e\u3059\u3002Kinesis\u30d5\u30a1\u30df\u30ea\u30fc\u306f\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u30c7\u30fc\u30bf\u306e\u96c6\u7d04\u306b\u7279\u5316\u3057\u305f\u30d5\u30eb\u30de\u30cd\u30fc\u30b8\u30c9\u30b5\u30fc\u30d3\u30b9\u3067\u3001\u5358\u4e00\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3067\u5927\u91cf\u306e\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u306f\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u3064\u3051\u3066\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306bHTTPS\u3067POST\u3059\u308b\u3002CLI\u3084SDK\u3082\u5229\u7528\u53ef\u80fd\n\u53d7\u4fe1\u3057\u305f\u30c7\u30fc\u30bf\u306fAmazon Kinesis Analytics\u3001Amazon S3\u3001Amazon Redshift\u3001\u304a\u3088\u3073 Amazon Elasticsearch Service\u306e\u3069\u308c\u304b\u306b\u914d\u9001\u3055\u308c\u308b\n\u914d\u9001\u5148\u306b\u306f\u8a2d\u5b9a\u3057\u305f\u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u6bce\u306b\u30c7\u30fc\u30bf\u304c\u5c4a\u304f\u3002\u6700\u5c0f\u306e\u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u306f60\u79d2\n\u30c7\u30fc\u30bf\u8ee2\u9001\u91cf\u306b\u3088\u308b\u8ab2\u91d1\n\u30aa\u30fc\u30c8\u30b9\u30b1\u30fc\u30eb\u3067\u30011 \u79d2\u3042\u305f\u308a\u6570\u30ae\u30ac\u30d0\u30a4\u30c8\u3092\u8d85\u3048\u308b\u5165\u529b\u30c7\u30fc\u30bf\u30ec\u30fc\u30c8\u306b\u3082\u5bfe\u5fdc\n\u3055\u3089\u306a\u308b\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u6027(\u9045\u5ef6\u6570\u79d2\u4ee5\u5185)\u304c\u6c42\u3081\u3089\u308c\u308b\u5834\u5408\u306f\u3001Kinesis Streams\u3092\u4f7f\u3046\n\n\nAmazon S3\n\n\u4e00\u898b\u305f\u3060\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30b9\u30c8\u30ec\u30fc\u30b8(\u30d5\u30a1\u30a4\u30eb\u30b5\u30fc\u30d0)\u3067\u3059\u304c\u3001AWS\u306e\u6839\u5e79\u3092\u306a\u3059\u30b5\u30fc\u30d3\u30b9\u3068\u8a00\u3048\u3001\u975e\u5e38\u306b\u591a\u304f\u306e\u6a5f\u80fd\u3092\u3082\u3063\u3066\u3044\u308b\u306e\u3067\u4e00\u8a00\u3067\u8aac\u660e\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\u4eca\u56de\u306e\u5229\u7528\u7528\u9014\u306b\u7d5e\u3063\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\n\nAPI/CLI/SDK\u3067HTTPS\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\n\n\u30b9\u30c8\u30ec\u30fc\u30b8\u5bb9\u91cf\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u6570\u3068\u30c7\u30fc\u30bf\u8ee2\u9001\u91cf(\u30a2\u30a6\u30c8\u30d0\u30a6\u30f3\u30c9)\u306b\u3088\u308b\u8ab2\u91d1\u3002\u30b9\u30c8\u30ec\u30fc\u30b8\u5bb9\u91cf1GB\u3042\u305f\u308a3\u5186\uff0f\u6708\u7a0b\u5ea6\u3068\u975e\u5e38\u306b\u4f4e\u6599\u91d1\n\u30d0\u30b1\u30c3\u30c8\u6bce\u306b\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u3001\u30ea\u30fc\u30b8\u30e7\u30f3\u5185\u30673\u7b87\u6240\u306b\u30b3\u30d4\u30fc\u304c\u4f5c\u6210\u3055\u308c\u308b\nIoT\u306b\u304a\u3051\u308b\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u3068\u3057\u3066\u306f\u3001\u30c7\u30fc\u30bf\u306e\u30cf\u30d6\u3068\u3057\u3066\u306e\u4f7f\u3044\u65b9\u304c\u6709\u52b9\u3002S3\u306b\u30c7\u30fc\u30bf\u3092\u96c6\u3081\u3066\u304a\u3051\u3070AWS\u306e\u3055\u307e\u3056\u307e\u306a\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u5229\u7528\u53ef\u80fd\u3068\u306a\u308b\u3002JSON\u5f62\u5f0f\u306e\u30c7\u30fc\u30bf\u304c\u671b\u307e\u3057\u3044\n\n\n[ToDo 0] RaspberryPi\u306e\u6e96\u5099\n\n\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u78ba\u8a8d\nRaspberryPi\u3092\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3057\u3001PC\u304b\u3089\u6709\u7ddaLAN\u307e\u305f\u306fWi-Fi\u7d4c\u7531\u3067SSH\u63a5\u7d9a\u3057\u307e\u3059\u3002\nRaspberryPi\u306eIP\u30a2\u30c9\u30ec\u30b9\u304c\u5206\u304b\u3089\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u3061\u3089\u3092\u53c2\u8003\u306bGUI\u3084ifconfig\u30b3\u30de\u30f3\u30c9\u7b49\u3067\u8abf\u3079\u3066\u304f\u3060\u3055\u3044\u3002\u4e0b\u8a18\u306e\u5834\u5408\u3001192.168.0.209\u304cRaspberryPi\u306eIP\u30a2\u30c9\u30ec\u30b9(Wi-Fi)\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\nWi-Fi\u3067\u63a5\u7d9a\u3059\u308b\u306e\u306bwlan0\u306bIP\u30a2\u30c9\u30ec\u30b9\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001\u3053\u3061\u3089\u3092\u53c2\u8003\u306bWi-Fi\u30a2\u30af\u30bb\u30b9\u30dd\u30a4\u30f3\u30c8\u3078\u306e\u63a5\u7d9a\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u4e0b\u3055\u3044\u3002\n$ ifconfig\nwlan0     Link encap:Ethernet  HWaddr cc:e1:d5:4d:59:5e\n          inet addr:192.168.0.209  Bcast:192.168.0.255  Mask:255.255.255.0\n          inet6 addr: 2001:268:d006:d652::2/128 Scope:Global\n\nwget\u30b3\u30de\u30f3\u30c9\u3067\u9069\u5f53\u306aURL\u3092\u6253\u3063\u3066\u307f\u308c\u3070\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u3066\u3044\u308b\u304b\u78ba\u8a8d\u304c\u3067\u304d\u307e\u3059\u3002\n $ wget https://google.co.jp\n\n--2016-03-23 17:53:19--  https://google.co.jp/\nResolving google.co.jp (google.co.jp)... 2404:6800:4003:809::2003, 106.162.198.104, 106.162.198.123, ...\nConnecting to google.co.jp (google.co.jp)|2404:6800:4003:809::2003|:443... connected.\nHTTP request sent, awaiting response... 301 Moved Permanently\nLocation: https://www.google.co.jp/ [following]\n--2016-03-23 17:53:30--  https://www.google.co.jp/\nResolving www.google.co.jp (www.google.co.jp)... 2404:6800:4007:805::2003, 106.162.192.173, 106.162.192.167, ...\nConnecting to www.google.co.jp (www.google.co.jp)|2404:6800:4007:805::2003|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: \u2018index.html\u2019\n\nindex.html              [ <=>                  ]  18.90K  --.-KB/s   in 0.1s\n\n2016-03-23 17:53:32 (130 KB/s) - \u2018index.html\u2019 saved [19358]\n\n\n\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3068vim\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u304c\u78ba\u8a8d\u3067\u304d\u305f\u3089\u3001\u4e0b\u8a18\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ sudo apt-get update\n$ sudo apt-get install -y vim\n\n\n[ToDo 1] API\u30a2\u30af\u30bb\u30b9\u7528\u306eKey\u3092\u4f5c\u6210\u3059\u308b(AWS)\n\nKinesis Firehose\u306bAPI\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306b\u3001AWS\u306eIAM Access Key\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u4f5c\u6210\u3059\u308b\u306e\u306f\u4e0b\u8a18\u306e\u30e6\u30fc\u30b6\u30fc\u304a\u3088\u3073\u305d\u308c\u306b\u3072\u3082\u4ed8\u304fKey\u3067\u3059\u3002\n\n\n\n\u30e6\u30fc\u30b6\u30fc\u540d\n\u30a2\u30af\u30bb\u30b9\u6a29\n\u4f7f\u7528\u7b87\u6240\n\n\n\n\nfirehose-full\nAmazonKinesisFirehoseFullAccess\nRaspberryPi\u304b\u3089Kinesis\u3078\u306e\u66f8\u304d\u8fbc\u307f\n\n\n\n\nAWS\u306b\u30b5\u30a4\u30f3\u30a4\u30f3\u3059\u308b\nIdentity and Access Management(IAM)\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u958b\u304f\u203b \u82f1\u8a9e\u753b\u9762\u3067\u8aac\u660e\u3059\u308b\u306e\u3067\u65e5\u672c\u8a9e\u8868\u793a\u306b\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u753b\u9762\u5de6\u4e0b\u306e\u8a00\u8a9e\u9078\u629e\u3092\u300cEnglish\u300d\u306b\u5909\u66f4\u3059\u308b\n\n\n\n\u300cfirehose-full\u300d\u3068\u3044\u3046\u540d\u524d\u3067Programmatic access\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3059\u308b\n\n\n\n\n\n[Attach existing policies directly]\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001[firehose]\u3067\u691c\u7d22\u3057\u3066\u3001[AmazonKinesisFirehoseFullAccess]\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\n[Next: Review]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\n\n[Create user]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\n\n\u8a8d\u8a3c\u60c5\u5831\u306e\u66f8\u304b\u308c\u305fCSV\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001[Close]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\n\n\n[ToDo 2] Kinesis Firehose\u306e\u8a2d\u5b9a(AWS)\n\n\nKinesis\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u958b\u304f\n\n\n\nKinesis Firehose\u306f2017\u5e742\u6708\u73fe\u5728\u3001\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u63d0\u4f9b\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u5229\u7528\u53ef\u80fd\u306a\u5317\u30d0\u30fc\u30b8\u30cb\u30a2(N.Virginia)\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u9078\u629e\u3059\u308b\n\n\n[Go to Firehose]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\n[Create Delivery Stream]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\n\u914d\u9001\u5148\u306b[Amazon S3]\u3092\u9078\u629e\u3059\u308b\n\n\n\u4efb\u610f\u306eStream Name\u3092\u5165\u529b\u3057\u3001\u30ed\u30b0\u3092\u683c\u7d0d\u3059\u308bS3\u30d0\u30b1\u30c3\u30c8\u3092\u9078\u629e(\u3053\u3053\u3067\u306f\u3068\u3082\u306b\u300ciotan-f\u300d\u3068\u3057\u3066\u3044\u308b)\u3059\u308b\u3002\u30d0\u30b1\u30c3\u30c8\u306f\u3053\u3053\u3067\u4f5c\u6210\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b(S3\u30d0\u30b1\u30c3\u30c8\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u306f\u304a\u597d\u307f\u3067)\n\u30ed\u30b0\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067Stream\u540d+\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3068\u306a\u308b\u304c\u3001\u5fc5\u8981\u3067\u3042\u308c\u3070\u30d7\u30ec\u30d5\u30a3\u30c3\u30af\u30b9\u3092\u6307\u5b9a\u3059\u308b\n[Next]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\nBuffer interval(S3\u3078\u306e\u9001\u4fe1\u9593\u9694)\u3092\u6307\u5b9a\u3059\u308b\u3002\u6700\u5c0f\u5024\u306f60\u79d2\u3002\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u65e9\u304f\u7d50\u679c\u304c\u5206\u304b\u308b\u3088\u3046\u306b60\u79d2\u306b\u8a2d\u5b9a\u3059\u308b\n\nIAM role\u3067[Firehose Delivery IAM role]\u3092\u9078\u629e\u3059\u308b\n\u4ed6\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067OK\n\n\n\u305d\u306e\u307e\u307e[Allow]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\n\u305d\u306e\u307e\u307e[Next]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\n[Create Delivery Stream]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\n\n\nS3\u914d\u9001\u30b9\u30c8\u30ea\u30fc\u30e0\u304c\u4f5c\u6210\u3055\u308c\u305f\u3002[ACTIVE]\u306b\u306a\u3063\u305f\u3089\u5229\u7528\u53ef\u80fd\n\n\n\n\n[ToDo 3] AWS CLI\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b(RaspberryPi)\n\n\nAWS CLI\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npip\u30b3\u30de\u30f3\u30c9\u3067AWS CLI\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ sudo pip install awscli\n(\u9014\u4e2d\u7701\u7565)\nSuccessfully installed awscli botocore PyYAML docutils rsa s3transfer jmespath python-dateutil futures\nCleaning up...\n\n\nAWS CLI\u306e\u8a2d\u5b9a\nCLI\u3092\u5b9f\u884c\u3059\u308b\u969b\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3084\u8a8d\u8a3c\u60c5\u5831\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u8a8d\u8a3c\u60c5\u5831\u306f[ToDo 1]\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fCSV\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\n\n\n\u9805\u76ee\n\u5165\u529b\u5185\u5bb9\n\n\n\n\nAWS Access Key ID\n(CSV\u53c2\u7167)\n\n\nAWS Secret Access Key\n(CSV\u53c2\u7167)\n\n\nDefault region name\nus-east-1\n\n\nDefault output format\njson\n\n\n\n$ aws configure\nAWS Access Key ID [None]: ************                    \nAWS Secret Access Key [None]: ************\nDefault region name [None]: us-east-1\nDefault output format [None]: json\n\n\n[ToDo 4] AWS CLI\u3067Kinesis Firehose\u306bput-record\u3057\u3066\u307f\u308b(RaspberryPi / AWS)\n\n\n\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306eput-record\nAWS CLI\u3067Kinesis Firehose\u306b\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092put-record\u3057\u3066\u307f\u307e\u3059\u3002--delivery-stream-name\u306e\u3042\u3068\u306e*****\u306b\u306f\u3001[ToDo 2]\u3067\u8a2d\u5b9a\u3057\u305f\u30b9\u30c8\u30ea\u30fc\u30e0\u540d\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306a\"RecordId\"\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u30c7\u30fc\u30bf\u304cS3\u306b\u66f8\u304d\u8fbc\u307e\u308c\u308b\u307e\u3067\u3001\u6700\u5927\u3067[ToDo 2]\u3067\u8a2d\u5b9a\u3057\u305fBuffer interval\u306e\u79d2\u6570\u3060\u3051\u304b\u304b\u308a\u307e\u3059\u3002\n$ aws firehose put-record --delivery-stream-name ***** --record Data=blob\n{\n    \"RecordId\": \"PEMfHNCtnMGQ5+bCvkm7TgynKepLxf2awvfD5He1atikTPY3zg8Eo2o3LnGhEqYzlVFUEnbv4xT7z8t/AUOVMI8Fy4EcznypTh1xDLP1RnoBtB7MzXOa1094BJ3WhvSV9vWC0sxaHeTAMcDoe1hkSrDQ1BsVZje3iMGkxOuMpnCKw/wEAhPtFn3V3/safpY7sTm7dr8oGYWbPNGzxN7wc6K6VgTYzV6Z\"\n}\n\n\n\nS3\u30d0\u30b1\u30c3\u30c8\u306e\u78ba\u8a8d\nQuicksight\u3067\u306e\u5206\u6790\u6642\u306b\u30a8\u30e9\u30fc\u306e\u539f\u56e0\u3068\u306a\u308b\u306e\u3067\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\u3057\u305f\u3089\u5fc5\u305a\u524a\u9664\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u4e0b\u3055\u3044\u3002\n\nS3\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u958b\u304f(\u65b0UI\u3067\u8aac\u660e)\n[ToDo 2]\u3067\u8a2d\u5b9a\u3057\u305f\u30d0\u30b1\u30c3\u30c8 -> \u5e74 -> \u6708 -> \u65e5 -> \u6642(UTC) \u306e\u9806\u306b\u958b\u304f\n1\u3064\u3060\u3051\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n\n\n\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u3067\u958b\u304f\u3068\u9001\u4fe1\u5185\u5bb9\u304c\u78ba\u8a8d\u3067\u304d\u308b\n\u78ba\u8a8d\u5f8c\u306f\u30d0\u30b1\u30c3\u30c8\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u3066\u304a\u304f\n\n\n\n\nS3\u30d0\u30b1\u30c3\u30c8\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u66f8\u304d\u8fbc\u307e\u308c\u306a\u3044\u5834\u5408\u306f\u30fb\u30fb\u30fb\nKinesis Firehose\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u753b\u9762\u304b\u3089\u30c7\u30e2\u30c7\u30fc\u30bf\u304c\u9001\u4fe1\u3067\u304d\u308b\u306e\u3067\u3001S3\u30d0\u30b1\u30c3\u30c8\u306b\u66f8\u304d\u8fbc\u307e\u308c\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3053\u3068\u3067\u539f\u56e0\u306e\u5207\u308a\u5206\u3051\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\n[ToDo 5] \u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u56de\u8def\u3092\u7d44\u307f\u7acb\u3066\u3066\u6e29\u5ea6\u3092\u8a08\u6e2c\u3059\u308b(RaspberryPi)\n\n\n1-wire\u30c7\u30b8\u30bf\u30eb\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u3068\u306f\nRaspberryPi\u306eGPIO\u306f\u30c7\u30b8\u30bf\u30eb\u4fe1\u53f7\u3057\u304b\u53d7\u3051\u4ed8\u3051\u307e\u305b\u3093\u304c\u3001\u591a\u304f\u306e\u30bb\u30f3\u30b5\u30fc\u985e\u306f\u30a2\u30ca\u30ed\u30b0\u4fe1\u53f7\u3092\u51fa\u529b\u3057\u307e\u3059\u306e\u3067\u3001AD\u30b3\u30f3\u30d0\u30fc\u30bf\u30fc\u3092\u4f7f\u3063\u3066\u4fe1\u53f7\u3092\u5909\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u4f7f\u3046\u30c7\u30b8\u30bf\u30eb\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fcDS18B20\u306f\u30011-wire\u898f\u683c\u306b\u6e96\u62e0\u3057\u3066\u304a\u308a\u30011\u672c\u306e\u4fe1\u53f7\u7dda\u3060\u3051\u3067\u4f4e\u901f\u306a\u30c7\u30b8\u30bf\u30eb\u30c7\u30fc\u30bf\u8ee2\u9001\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u56de\u8def\u304c\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u56de\u8def\u306e\u7d44\u307f\u7acb\u3066\n\u5ff5\u306e\u305f\u3081\u3001RaspberryPi\u3092\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3\u3057\u3066\u56de\u8def\u3092\u63a5\u7d9a\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u4e0b\u8a18\u306e\u30d1\u30fc\u30c4\u3092\u56f3\u306e\u901a\u308a\u914d\u7dda\u3057\u3001RaspberryPi\u306e\u96fb\u6e90\u3092ON\u306b\u3057\u307e\u3059\u3002\u30b8\u30e3\u30f3\u30d1\u30ef\u30a4\u30e4\u306e\u8272\u306f\u56f3\u306e\u901a\u308a\u3067\u306a\u304f\u3066\u304b\u307e\u3044\u307e\u305b\u3093\u3002\n\nDS18B20\n2.2k\u03a9\u30ab\u30fc\u30dc\u30f3\u62b5\u6297\n\u30d6\u30ec\u30c3\u30c9\u30dc\u30fc\u30c9\n\u30b8\u30e3\u30f3\u30d1\u30ef\u30a4\u30e4 \u30aa\u30b9\u30fc\u30e1\u30b9 3\u672c\n\n\n\nRaspberryPi\u306e\u8a2d\u5b9a\n\n1-wire\u30c7\u30d0\u30a4\u30b9\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8d77\u52d5\u6642\u306b\u8aad\u307f\u8fbc\u3080\u3088\u3046\u306b\u3059\u308b\n\n$ sudo vim /etc/modules\n\n(\u6700\u5f8c\u5c3e\u306b\u4e0b\u8a182\u884c\u3092\u8ffd\u8a18\u3059\u308b)\nw1-gpio\nw1-therm\n\n\n1-wire\u30c7\u30d0\u30a4\u30b9\u306eGPIO\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\u3092\u8a18\u8ff0\u3059\u308b\n\n$ sudo vim /boot/config.txt\n\n(\u6700\u5f8c\u5c3e\u306b\u4e0b\u8a181\u884c\u3092\u8ffd\u8a18\u3059\u308b)\ndtoverlay=w1-gpio-pullup,gpiopin=4\n\n\n\u30ea\u30d6\u30fc\u30c8\u5f8c\u3001\u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n\n$ sudo reboot\n\n\n\u6e29\u5ea6\u3092\u8aad\u307f\u51fa\u3059\nDS18B20\u306f\u6e29\u5ea6\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u3080\u4ed5\u69d8\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u518d\u8d77\u52d5\u3059\u308b\u3068/sys/bus/w1/devices/28-************/ (28-************\u306f\u500b\u4f53\u306b\u3088\u308a\u7570\u306a\u308b\u30c7\u30d0\u30a4\u30b9ID)\u3068\u3044\u3046\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u4f5c\u6210\u3055\u308c\u3066\u304a\u308a\u3001\u305d\u306e\u4e2d\u306bw1_slave\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308b\u306f\u305a\u3067\u3059\u3002t=\u306b\u7d9a\u304f5\u6841\u306e\u6574\u6570\u30921000\u3067\u5272\u3063\u305f\u6570\u304c\u6e29\u5ea6(\u6442\u6c0f)\u3067\u3059\u3002\n\u30c7\u30d0\u30a4\u30b9ID 28-************ \u306f[ToDo 6]\u3067\u4f7f\u3046\u306e\u3067\u63a7\u3048\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n$ cd /sys/bus/w1/devices/\n$ ls -l\ntotal 0\nlrwxrwxrwx 1 root root 0 Feb  6 01:28 28-************ -> ../../../devices/w1_bus_master1/28-************\nlrwxrwxrwx 1 root root 0 Feb  6 01:28 w1_bus_master1 -> ../../../devices/w1_bus_master1\n$ cd 28-************\n$ cat w1_slave \na7 01 55 00 7f ff 0c 10 22 : crc=22 YES\na7 01 55 00 7f ff 0c 10 22 t=26437\n\n\n\n[ToDo 6] \u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u6e29\u5ea6\u30c7\u30fc\u30bf\u3092Kinesis Firehose\u306bput-record\u3059\u308b(RaspberryPi)\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u4e00\u5b9a\u6642\u9593\u3054\u3068\u306b\u6e29\u5ea6\u3092\u8aad\u307f\u51fa\u3057\u3001AWS CLI\u3092\u53e9\u3044\u3066Kinesis Firehose\u306bput-record\u3057\u307e\u3059\u3002JSON\u306f[\"]\u3092\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3053\u3068\u306b\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u672c\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u30a8\u30e9\u30fc\u51e6\u7406\u3092\u8003\u616e\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u306e\u5834\u5408\u306f\u3001\u5f53\u7136\u30a8\u30e9\u30fc\u51e6\u7406\u3092\u8003\u616e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001fluentd\u306a\u3069\u306e\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u4f7f\u3046\u3068\u3088\u3044\u3067\u3057\u3087\u3046\u3002\n$ cd ~\n$ vim temp-firehose.sh\n\n\n\ndeviceid=\u306e\u3042\u3068\u306e28-************\u306b\u306f\u3001[ToDo 5]\u3067\u63a7\u3048\u305f28-\u304b\u3089\u59cb\u307e\u308bDS18B20\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092\u5165\u529b\u3059\u308b\n\nstreamname=\u306e\u3042\u3068\u306e*********\u306b\u306f\u3001[ToDo 2]\u3067\u8a2d\u5b9a\u3057\u305f\u30b9\u30c8\u30ea\u30fc\u30e0\u540d\u3092\u5165\u529b\u3059\u308b\n\n\ntemp-firehose.sh\n#!/bin/bash\n\n# \u7b2c1\u5f15\u6570\u304c\u30c7\u30fc\u30bf\u306e\u9001\u4fe1\u9593\u9694\u3068\u306a\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f15\u79d2)\nif [ \"$1\" = \"\" ]\nthen\n        interval=15\nelse\n        interval=$1\nfi\n\n# DS18B20\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092deviceid\u306b\u30bb\u30c3\u30c8\ndeviceid=28-************\n# Kinesis Firehose\u30b9\u30c8\u30ea\u30fc\u30e0\u540d\u3092streamname\u306b\u30bb\u30c3\u30c8\nstreamname=*********\n\nwhile [ 1 ]\ndo\n        (\n                # \u65e5\u6642\u3092time\u306b\u30bb\u30c3\u30c8\n                time=`date '+%F %T'`\n                # \u6e29\u5ea6\u3092\u8aad\u307f\u53d6\u308a\u3001temp\u306b\u30bb\u30c3\u30c8\n                temp=$(awk -F= 'END {print $2/1000}' < /sys/bus/w1/devices/$deviceid/w1_slave)\n                # \u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u304c\u53d6\u5f97\u3067\u304d\u305f\u3068\u304d\u306e\u307f\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3059\u308b\n                if [ -n \"$temp\" ] ; then\n                        # \u9001\u4fe1\u3059\u308bJSON\u6587\u5b57\u5217\u3092\u4f5c\u308b\n                        payload='{\\\"time\\\":\\\"'$time'\\\", \\\"temperature\\\":'$temp'}'\n                        # JSON\u3092\u753b\u9762\u306b\u8868\u793a\n                        echo $payload\n                        # AWS CLI\u3067put-record\u3059\u308b\n                        aws firehose put-record --delivery-stream-name $streamname --record=\"{\\\"Data\\\":\\\"$payload\\n\\\"}\"\n                fi\n        ) &\n        sleep $interval\ndone\n\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u505c\u6b62\u3059\u308b\u5834\u5408\u306fctrl + C\u3002\u7b2c1\u5f15\u6570(\u4e0b\u8a18\u3067\u306f20)\u304c\u9001\u4fe1\u9593\u9694\u3067\u3001\u7701\u7565\u3057\u305f\u5834\u5408\u306f15\u79d2\u9593\u9694\u3067\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\u4e0b\u8a18\u306e\u3088\u3046\u306bJSON\u3068\"RecordId\"\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u4ea4\u4e92\u306b\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u9001\u4fe1\u9593\u9694\u306b\u3088\u3063\u3066\u306f\u30ec\u30b9\u30dd\u30f3\u30b9\u306f\u9045\u308c\u3066\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u3082\u3042\u308a\u307e\u3059\u3002\n$ sh temp-firehose.sh 20\n{\\\"time\\\":\\\"2017-02-06 01:00:10\\\", \\\"temperature\\\":26.187}\n{\n    \"RecordId\": \"sqyX8BaKpoWgWlYjJcPdxlp/sIxOIisujyk/cjbgnUO+CbigLVEhNk9UBL9VmmQL7QXtWu5c0Gi0yZF9hYi8rY5YBXoM9anaKsEowTHSfpjQSpx9/zink5b8WQvJYZtAazYolN7GfwQkWzCQHmTbGrUztmLwiZfECorKU4SCiHF0xbDkz5b+1W9F/ylabNHNbV8Fx4gEIJs45pX+LpWz7+zjsMHmZSun\"\n}\n{\\\"time\\\":\\\"2017-02-06 01:00:30\\\", \\\"temperature\\\":26.062}\n{\n    \"RecordId\": \"sHadXs3jJTUnu9FLwPfwZzVDautdy7Vdy7k7u9dt1tYLlgF5MA4aVTYiNTh6yOtKn8H+OwWOIS3WmJTIO70kA+3snWWWG+a0fHFwQEXkIZTlu1ybXbPfXPS9566mMRkA1nLAxiBQSsXr8Wpv9XO9S6e3tf5CJYwOMaKbVVCKpr+u+uKqueyZVioLAKQz1TrF11jMBxNUdApdyVK8LQFvWu9c3V+WDcPl\"\n}\n\n\n[ToDo 7] S3\u30d0\u30b1\u30c3\u30c8\u306b\u6e29\u5ea6\u30c7\u30fc\u30bf\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304c\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b(AWS)\n\n[ToDo 4]\u306e\u624b\u9806\u3067S3\u30d0\u30b1\u30c3\u30c8\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u521d\u56de\u306f\u66f8\u304d\u8fbc\u307e\u308c\u308b\u307e\u3067\u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\u3068JSON\u304c\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\u30bb\u30f3\u30b5\u30fc\u3092\u4fdd\u51b7\u5264\u3067\u51b7\u3084\u3059\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u6e29\u5ea6\u304c\u4e0b\u304c\u308a\u307e\u3059\u3002\n\n\u6b63\u5e38\u306b\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u305f\u3089\u3001\u30c7\u30fc\u30bf\u3092\u84c4\u7a4d\u3059\u308b\u305f\u3081\u306b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u5b9f\u884c\u3057\u305f\u307e\u307e\u306e\u72b6\u614b\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u4ed6\u306e\u64cd\u4f5c\u3092\u3059\u308b\u5834\u5408\u306f\u3001\u5225\u30a6\u30a4\u30f3\u30c9\u30a6\u3067SSH\u63a5\u7d9a\u3057\u307e\u3057\u3087\u3046\u3002\n\n\uff1c\u5f8c\u7de8\uff1e\u306f\u3053\u3061\u3089\n\n\n[\u304a\u307e\u3051] \u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u6e29\u5ea6\u30c7\u30fc\u30bf\u3092DynamoDB\u306bput-item\u3059\u308b(RaspberryPi)\n\nNoSQL DB\u3067\u3042\u308bAmazon DynamoDB\u306b\u3082\u307b\u307c\u540c\u3058\u65b9\u6cd5\u3067\u66f8\u304d\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nIoT.kyoto VIS\u3067\u53ef\u8996\u5316\u3059\u308b\u3068\u826f\u3044\u304b\u3082\u3067\u3059\u3002(\u5ba3\u4f1d\u30b9\u30df\u30de\u30bb\u30f3)\n\n\nDynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n\naws configure\u30b3\u30de\u30f3\u30c9\u3067\u767b\u9332\u3057\u305fIAM\u306bDynamoDB\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650(AmazonDynamoDBFullAccess\u7b49)\u3092\u4ed8\u4e0e\u3059\u308b\n\u4ee5\u4e0b\u306e\u6761\u4ef6\u3067DynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n\n\n\n\u9805\u76ee\n\u8a2d\u5b9a\u5024\n\n\n\n\n\u30ea\u30fc\u30b8\u30e7\u30f3\n\u5317\u30d0\u30fc\u30b8\u30cb\u30a2(us-east-1)\n\n\nTable Name\n(\u4efb\u610f\u306e\u30c6\u30fc\u30d6\u30eb\u540d)\n\n\nPartition key\nid\n\n\nSort key\ntime\n\n\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\n$ vim temp-dynamodb.sh\n\n\n\ndeviceid=\u306e\u3042\u3068\u306e28-************\u306b\u306f\u3001[ToDo 5]\u3067\u63a7\u3048\u305f28-\u304b\u3089\u59cb\u307e\u308bDS18B20\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092\u5165\u529b\u3059\u308b\n\ntablename=\u306e\u3042\u3068\u306e*********\u306b\u306f\u3001DynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5165\u529b\u3059\u308b\n\n\ntemp-dynamodb.sh\n#!/bin/bash\n\n# \u7b2c1\u5f15\u6570\u304c\u30c7\u30fc\u30bf\u306e\u9001\u4fe1\u9593\u9694\u3068\u306a\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f15\u79d2)\nif [ \"$1\" = \"\" ]\nthen\n        interval=15\nelse\n        interval=$1\nfi\n\n# DS18B20\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092deviceid\u306b\u30bb\u30c3\u30c8\ndeviceid=28-************\n# DynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u540d\u3092tablemname\u306b\u30bb\u30c3\u30c8\ntablename=*********\n# \u30ce\u30fc\u30c9\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092id\u306b\u30bb\u30c3\u30c8\nid=id001\n\nwhile [ 1 ]\ndo\n        (\n                # \u65e5\u6642\u3092time\u306b\u30bb\u30c3\u30c8\n                time=`date '+%F %T'`\n                # \u6e29\u5ea6\u3092\u8aad\u307f\u53d6\u308a\u3001temp\u306b\u30bb\u30c3\u30c8\n                temp=$(awk -F= 'END {print $2/1000}' < /sys/bus/w1/devices/$deviceid/w1_slave)\n                # \u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u304c\u53d6\u5f97\u3067\u304d\u305f\u3068\u304d\u306e\u307f\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3059\u308b\n                if [ -n \"$temp\" ] ; then\n                        # \u9001\u4fe1\u3059\u308bJSON\u6587\u5b57\u5217\u3092\u4f5c\u308b\n                        payload='{\"id\": {\"S\":\"'$id'\"},\"time\": {\"S\":\"'$time'\"},\"temperature\": {\"N\":\"'$temp'\"}}'\n                        # JSON\u3092\u753b\u9762\u306b\u8868\u793a\n                        echo $payload\n                        # AWS CLI\u3067put-item\u3059\u308b(\u6d88\u8cbb\u30ad\u30e3\u30d1\u30b7\u30c6\u30a3\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u306a\u3057)\n                        aws dynamodb put-item --table-name tablename --item=\"$payload\"\n                        # AWS CLI\u3067put-item\u3059\u308b(\u6d88\u8cbb\u30ad\u30e3\u30d1\u30b7\u30c6\u30a3\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3042\u308a)\n                        #aws dynamodb put-item --table-name $tablename --item=\"$payload\" --return-consumed-capacity TOTAL\n                fi\n        ) &\n        sleep $interval\ndone\n\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u505c\u6b62\u3059\u308b\u5834\u5408\u306fctrl + C\u3002\u7b2c1\u5f15\u6570(\u4e0b\u8a18\u3067\u306f1)\u304c\u9001\u4fe1\u9593\u9694\u3067\u3001\u7701\u7565\u3057\u305f\u5834\u5408\u306f15\u79d2\u9593\u9694\u3067\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u305a\u3001JSON\u304c\u9023\u7d9a\u3057\u3066\u8868\u793a\u3055\u308c\u3066\u3044\u305f\u3089\u6210\u529f\u3067\u3059\u3002\n$ sh temp-dynamodb.sh 1\n{\"id\": {\"S\":\"id001\"},\"time\": {\"S\":\"2017-02-12 14:09:48\"},\"temperature\": {\"N\":\"30.437\"}}\n{\"id\": {\"S\":\"id001\"},\"time\": {\"S\":\"2017-02-12 14:09:49\"},\"temperature\": {\"N\":\"29.937\"}}\n{\"id\": {\"S\":\"id001\"},\"time\": {\"S\":\"2017-02-12 14:09:50\"},\"temperature\": {\"N\":\"29.562\"}}\n{\"id\": {\"S\":\"id001\"},\"time\": {\"S\":\"2017-02-12 14:09:51\"},\"temperature\": {\"N\":\"29.312\"}}\n\n\nDynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n#**\u6982\u8981**\n\u672c\u30b3\u30f3\u30c6\u30f3\u30c4\u306f\u3001[**JAWS DAYS 2017**](http://jawsdays2017.jaws-ug.jp)\u306e[**IoT\u30cf\u30f3\u30ba\u30aa\u30f3**](https://jaws-days.doorkeeper.jp/events/57107)\u5411\u3051\u306b\u4f5c\u6210\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u3092\u69cb\u7bc9\u3057\u3066\u3001\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u3092Quicksight\u3067\u53ef\u8996\u5316\u3057\u307e\u3059\u3002\n**\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc -> RaspberryPi -> Kinesis Firehose -> S3 -> Athena -> Quicksight**\n\u672c\u683c\u7684\u306a\u5206\u6790\u3084\u53ef\u8996\u5316\u306b\u3082\u8010\u3048\u3046\u308b\u69cb\u6210\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u3078\u306e\u5fdc\u7528\u3082\u53ef\u80fd\u3067\u3059\u3002\u307e\u305f\u3001\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u306e\u7d44\u307f\u7acb\u3066\u3067\u306f\u7c21\u5358\u306a\u96fb\u5b50\u5de5\u4f5c\u3092\u4f53\u9a13\u3067\u304d\u307e\u3059\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-06 21.28.43.png](https://qiita-image-store.s3.amazonaws.com/0/80392/08be9470-5ce9-537c-400f-de0af1152e36.png)\n\n\n##\uff1c\u524d\u7de8\uff1e\u306e\u7bc4\u56f2\n\uff1c\u524d\u7de8\uff1e\u3067\u306f\u3001**\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc -> RaspberryPi -> Kinesis Firehose -> S3** \u306e\u90e8\u5206\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\u6210\u529f\u3059\u308c\u3070\u4e0b\u8a18\u306e\u3088\u3046\u306aJSON\u30e1\u30c3\u30bb\u30fc\u30b8\u304cS3\u30d0\u30b1\u30c3\u30c8\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\u6c4e\u7528\u7684\u306aJSON\u30e1\u30c3\u30bb\u30fc\u30b8\u3067\u3059\u306e\u3067\u3001**\u5f8c\u5de5\u7a0b\u3067\u69d8\u3005\u306b\u6d3b\u7528\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd**(\u30b3\u30b3\u91cd\u8981\uff01)\u3067\u3059\u3002\n\n```JOSN\n{\"time\":\"2017-02-04 19:14:33\", \"temperature\":25.562}\n{\"time\":\"2017-02-04 19:14:43\", \"temperature\":25.562}\n{\"time\":\"2017-02-04 19:14:53\", \"temperature\":25.5}\n{\"time\":\"2017-02-04 19:15:03\", \"temperature\":19.5}\n{\"time\":\"2017-02-04 19:15:13\", \"temperature\":15.375}\n{\"time\":\"2017-02-04 19:15:23\", \"temperature\":14.5}\n```\n\n##\uff1c\u5f8c\u7de8\uff1e\u306f[\u3053\u3061\u3089](http://qiita.com/ha_ru_ma_ki/items/ee77b3755ef50181bba4)\n\n#**\u5fc5\u8981\u306a\u6a5f\u6750**\n* PC\n* RaspberryPi 2\u307e\u305f\u306f3\n* micro USB\u96fb\u6e90\n* micro SD\u30ab\u30fc\u30c9 (8GB\u4ee5\u4e0a)\n* \u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u30bb\u30c3\u30c8\n    * DS18B20\n    * 2.2k\u03a9\u30ab\u30fc\u30dc\u30f3\u62b5\u6297\n    * \u30d6\u30ec\u30c3\u30c9\u30dc\u30fc\u30c9\n    * \u30b8\u30e3\u30f3\u30d1\u30ef\u30a4\u30e4 \u30aa\u30b9\u30fc\u30e1\u30b9 3\u672c\n\n#**\u524d\u63d0\u6761\u4ef6**\n* AWS\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u3082\u3063\u3066\u3044\u308b\u3053\u3068\u3002\u30a2\u30ab\u30a6\u30f3\u30c8\u958b\u8a2d\u624b\u9806\u306f[**\u3053\u3061\u3089**](https://aws.amazon.com/jp/register-flow/)\n* RaspberryPi\u306b[Raspbian](https://www.raspberrypi.org/downloads/raspbian/)\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3067\u3001PC\u304b\u3089SSH\u3067\u30ed\u30b0\u30a4\u30f3\u307e\u305f\u306fHDMI\u63a5\u7d9a\u306e\u30e2\u30cb\u30bf\u3067\u30bf\u30fc\u30df\u30ca\u30eb\u64cd\u4f5c\u304c\u3067\u304d\u308b\u3053\u3068\u3002\u624b\u9806\u306f[**\u3053\u3061\u3089**](http://qiita.com/Ichiro_Tsuji/items/e7ff30f0ec0b7d0ceed5)\u3002Raspbian\u306f[**Release date:2017-01-11**]\u3067\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\n* RaspberryPi\u304c\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u3066\u3044\u308b\u3053\u3068\n\n#**\uff1c\u524d\u7de8\uff1e\u3067\u5229\u7528\u3059\u308bAWS\u30b5\u30fc\u30d3\u30b9**\n##[Amazon Kinesis Firehose](https://aws.amazon.com/jp/kinesis/firehose/)\n\u591a\u6570\u306e\u30ce\u30fc\u30c9\u304b\u3089\u30c7\u30fc\u30bf\u3092\u96c6\u7d04\u3059\u308b\u5834\u5408\u3001\u53e4\u304f\u306fFTP\u30b5\u30fc\u30d0\u3092\u5229\u7528\u3057\u307e\u3057\u305f\u3002\u73fe\u5728\u3067\u3042\u308c\u3070HTTP\u30d9\u30fc\u30b9\u306eAPI\u30b5\u30fc\u30d0\u3068\u3044\u3063\u305f\u3068\u3053\u308d\u3067\u3057\u3087\u3046\u304b\u3002\u6570\u5343\uff5e\u6570\u4e07\u3068\u3044\u3063\u305f\u591a\u6570\u306eIoT\u30a8\u30c3\u30b8\u30c7\u30d0\u30a4\u30b9\u30ce\u30fc\u30c9\u3092\u96c6\u7d04\u3059\u308b\u5834\u5408\u3001\u30b5\u30fc\u30d0\u306e\u30b9\u30b1\u30fc\u30eb\u3084\u5206\u6563\u51e6\u7406\u304c\u5927\u304d\u306a\u8ab2\u984c\u3068\u306a\u308a\u307e\u3059\u3002Kinesis\u30d5\u30a1\u30df\u30ea\u30fc\u306f\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u30c7\u30fc\u30bf\u306e\u96c6\u7d04\u306b\u7279\u5316\u3057\u305f\u30d5\u30eb\u30de\u30cd\u30fc\u30b8\u30c9\u30b5\u30fc\u30d3\u30b9\u3067\u3001\u5358\u4e00\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3067\u5927\u91cf\u306e\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n* \u30c7\u30fc\u30bf\u306f\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u3064\u3051\u3066\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306bHTTPS\u3067POST\u3059\u308b\u3002CLI\u3084SDK\u3082\u5229\u7528\u53ef\u80fd\n* \u53d7\u4fe1\u3057\u305f\u30c7\u30fc\u30bf\u306fAmazon Kinesis Analytics\u3001Amazon S3\u3001Amazon Redshift\u3001\u304a\u3088\u3073 Amazon Elasticsearch Service\u306e\u3069\u308c\u304b\u306b\u914d\u9001\u3055\u308c\u308b\n* \u914d\u9001\u5148\u306b\u306f\u8a2d\u5b9a\u3057\u305f\u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u6bce\u306b\u30c7\u30fc\u30bf\u304c\u5c4a\u304f\u3002\u6700\u5c0f\u306e\u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u306f60\u79d2\n* [\u30c7\u30fc\u30bf\u8ee2\u9001\u91cf\u306b\u3088\u308b\u8ab2\u91d1](https://aws.amazon.com/jp/kinesis/firehose/pricing/)\n* \u30aa\u30fc\u30c8\u30b9\u30b1\u30fc\u30eb\u3067\u30011 \u79d2\u3042\u305f\u308a\u6570\u30ae\u30ac\u30d0\u30a4\u30c8\u3092\u8d85\u3048\u308b\u5165\u529b\u30c7\u30fc\u30bf\u30ec\u30fc\u30c8\u306b\u3082\u5bfe\u5fdc\n* \u3055\u3089\u306a\u308b\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u6027(\u9045\u5ef6\u6570\u79d2\u4ee5\u5185)\u304c\u6c42\u3081\u3089\u308c\u308b\u5834\u5408\u306f\u3001Kinesis Streams\u3092\u4f7f\u3046\n\n##[Amazon S3](https://aws.amazon.com/jp/s3/)\n\u4e00\u898b\u305f\u3060\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30b9\u30c8\u30ec\u30fc\u30b8(\u30d5\u30a1\u30a4\u30eb\u30b5\u30fc\u30d0)\u3067\u3059\u304c\u3001AWS\u306e\u6839\u5e79\u3092\u306a\u3059\u30b5\u30fc\u30d3\u30b9\u3068\u8a00\u3048\u3001\u975e\u5e38\u306b\u591a\u304f\u306e\u6a5f\u80fd\u3092\u3082\u3063\u3066\u3044\u308b\u306e\u3067\u4e00\u8a00\u3067\u8aac\u660e\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\u4eca\u56de\u306e\u5229\u7528\u7528\u9014\u306b\u7d5e\u3063\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\n\n* API/CLI/SDK\u3067HTTPS\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\n* [\u30b9\u30c8\u30ec\u30fc\u30b8\u5bb9\u91cf\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u6570\u3068\u30c7\u30fc\u30bf\u8ee2\u9001\u91cf(\u30a2\u30a6\u30c8\u30d0\u30a6\u30f3\u30c9)\u306b\u3088\u308b\u8ab2\u91d1](https://aws.amazon.com/jp/s3/pricing/)\u3002\u30b9\u30c8\u30ec\u30fc\u30b8\u5bb9\u91cf1GB\u3042\u305f\u308a3\u5186\uff0f\u6708\u7a0b\u5ea6\u3068\u975e\u5e38\u306b\u4f4e\u6599\u91d1\n* \u30d0\u30b1\u30c3\u30c8\u6bce\u306b\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u3001\u30ea\u30fc\u30b8\u30e7\u30f3\u5185\u30673\u7b87\u6240\u306b\u30b3\u30d4\u30fc\u304c\u4f5c\u6210\u3055\u308c\u308b\n* IoT\u306b\u304a\u3051\u308b\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u3068\u3057\u3066\u306f\u3001\u30c7\u30fc\u30bf\u306e\u30cf\u30d6\u3068\u3057\u3066\u306e\u4f7f\u3044\u65b9\u304c\u6709\u52b9\u3002S3\u306b\u30c7\u30fc\u30bf\u3092\u96c6\u3081\u3066\u304a\u3051\u3070AWS\u306e\u3055\u307e\u3056\u307e\u306a\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u5229\u7528\u53ef\u80fd\u3068\u306a\u308b\u3002JSON\u5f62\u5f0f\u306e\u30c7\u30fc\u30bf\u304c\u671b\u307e\u3057\u3044\n\n#**[ToDo 0] RaspberryPi\u306e\u6e96\u5099**\n##\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u78ba\u8a8d\nRaspberryPi\u3092\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3057\u3001PC\u304b\u3089\u6709\u7ddaLAN\u307e\u305f\u306fWi-Fi\u7d4c\u7531\u3067SSH\u63a5\u7d9a\u3057\u307e\u3059\u3002\nRaspberryPi\u306eIP\u30a2\u30c9\u30ec\u30b9\u304c\u5206\u304b\u3089\u306a\u3044\u5834\u5408\u306f\u3001[**\u3053\u3061\u3089**](http://qiita.com/Ichiro_Tsuji/items/e7ff30f0ec0b7d0ceed5#%E3%82%B3%E3%83%B3%E3%82%BD%E3%83%BC%E3%83%AB%E7%94%BB%E9%9D%A2%E3%81%AE%E8%A1%A8%E7%A4%BA)\u3092\u53c2\u8003\u306bGUI\u3084**`ifconfig`**\u30b3\u30de\u30f3\u30c9\u7b49\u3067\u8abf\u3079\u3066\u304f\u3060\u3055\u3044\u3002\u4e0b\u8a18\u306e\u5834\u5408\u3001192.168.0.209\u304cRaspberryPi\u306eIP\u30a2\u30c9\u30ec\u30b9(Wi-Fi)\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\nWi-Fi\u3067\u63a5\u7d9a\u3059\u308b\u306e\u306b**`wlan0`**\u306bIP\u30a2\u30c9\u30ec\u30b9\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001[**\u3053\u3061\u3089**](http://qiita.com/Ichiro_Tsuji/items/e7ff30f0ec0b7d0ceed5#gui%E3%81%A7wi-fi%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B)\u3092\u53c2\u8003\u306bWi-Fi\u30a2\u30af\u30bb\u30b9\u30dd\u30a4\u30f3\u30c8\u3078\u306e\u63a5\u7d9a\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u4e0b\u3055\u3044\u3002\n\n```bash\n$ ifconfig\nwlan0     Link encap:Ethernet  HWaddr cc:e1:d5:4d:59:5e\n          inet addr:192.168.0.209  Bcast:192.168.0.255  Mask:255.255.255.0\n          inet6 addr: 2001:268:d006:d652::2/128 Scope:Global\n```\n\n**`wget`**\u30b3\u30de\u30f3\u30c9\u3067\u9069\u5f53\u306aURL\u3092\u6253\u3063\u3066\u307f\u308c\u3070\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u3066\u3044\u308b\u304b\u78ba\u8a8d\u304c\u3067\u304d\u307e\u3059\u3002\n\n```bash\n $ wget https://google.co.jp\n\n--2016-03-23 17:53:19--  https://google.co.jp/\nResolving google.co.jp (google.co.jp)... 2404:6800:4003:809::2003, 106.162.198.104, 106.162.198.123, ...\nConnecting to google.co.jp (google.co.jp)|2404:6800:4003:809::2003|:443... connected.\nHTTP request sent, awaiting response... 301 Moved Permanently\nLocation: https://www.google.co.jp/ [following]\n--2016-03-23 17:53:30--  https://www.google.co.jp/\nResolving www.google.co.jp (www.google.co.jp)... 2404:6800:4007:805::2003, 106.162.192.173, 106.162.192.167, ...\nConnecting to www.google.co.jp (www.google.co.jp)|2404:6800:4007:805::2003|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: \u2018index.html\u2019\n\nindex.html              [ <=>                  ]  18.90K  --.-KB/s   in 0.1s\n\n2016-03-23 17:53:32 (130 KB/s) - \u2018index.html\u2019 saved [19358]\n```\n\n##\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3068vim\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u304c\u78ba\u8a8d\u3067\u304d\u305f\u3089\u3001\u4e0b\u8a18\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo apt-get update\n$ sudo apt-get install -y vim\n```\n\n#**[ToDo 1] API\u30a2\u30af\u30bb\u30b9\u7528\u306eKey\u3092\u4f5c\u6210\u3059\u308b(AWS)**\nKinesis Firehose\u306bAPI\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306b\u3001AWS\u306eIAM Access Key\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u4f5c\u6210\u3059\u308b\u306e\u306f\u4e0b\u8a18\u306e\u30e6\u30fc\u30b6\u30fc\u304a\u3088\u3073\u305d\u308c\u306b\u3072\u3082\u4ed8\u304fKey\u3067\u3059\u3002\n\n| \u30e6\u30fc\u30b6\u30fc\u540d | \u30a2\u30af\u30bb\u30b9\u6a29 | \u4f7f\u7528\u7b87\u6240 |\n|----------|----------|----------|\n| firehose-full | AmazonKinesisFirehoseFullAccess | RaspberryPi\u304b\u3089Kinesis\u3078\u306e\u66f8\u304d\u8fbc\u307f |\n\n* AWS\u306b[\u30b5\u30a4\u30f3\u30a4\u30f3](https://console.aws.amazon.com/)\u3059\u308b\n* Identity and Access Management(IAM)\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u958b\u304f<BR>\u203b \u82f1\u8a9e\u753b\u9762\u3067\u8aac\u660e\u3059\u308b\u306e\u3067\u65e5\u672c\u8a9e\u8868\u793a\u306b\u306a\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u753b\u9762\u5de6\u4e0b\u306e\u8a00\u8a9e\u9078\u629e\u3092\u300cEnglish\u300d\u306b\u5909\u66f4\u3059\u308b<BR>\n![AWS Management Console 2017-02-05 15-21-17.png](https://qiita-image-store.s3.amazonaws.com/0/80392/1cb88cc2-a86a-b9d7-7414-97354a338df6.png)\n<BR><BR>\n* \u300cfirehose-full\u300d\u3068\u3044\u3046\u540d\u524d\u3067Programmatic access\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3059\u308b<BR>\n![IAM Management Console 2017-02-05 15-25-26.png](https://qiita-image-store.s3.amazonaws.com/0/80392/dc7adb2c-e039-d6f3-12f7-b6b3cf0fb61f.png)\n<BR><BR>\n![IAM Management Console 2017-02-05 15-27-19.png](https://qiita-image-store.s3.amazonaws.com/0/80392/8aec525c-52a5-89fc-d3c5-1d18882bd145.png)\n<BR><BR>\n* [Attach existing policies directly]\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001[firehose]\u3067\u691c\u7d22\u3057\u3066\u3001[AmazonKinesisFirehoseFullAccess]\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\n* [Next: Review]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![IAM Management Console 2017-02-05 15-36-54.png](https://qiita-image-store.s3.amazonaws.com/0/80392/b93985ae-201f-6730-71bf-7024b038b2e0.png)\n<BR><BR>\n* [Create user]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![IAM Management Console 2017-02-05 15-38-24.png](https://qiita-image-store.s3.amazonaws.com/0/80392/9dcbdfed-df8c-6b0d-c63b-0e36607e0087.png)\n<BR><BR>\n* \u8a8d\u8a3c\u60c5\u5831\u306e\u66f8\u304b\u308c\u305fCSV\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001[Close]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![IAM Management Console 2017-02-05 15-41-43.png](https://qiita-image-store.s3.amazonaws.com/0/80392/a3c29183-8437-e796-d71e-31289c89af54.png)\n\n#**[ToDo 2] Kinesis Firehose\u306e\u8a2d\u5b9a(AWS)**\n* Kinesis\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u958b\u304f<BR>\n![AWS Management Console 2017-02-05 15-13-43.png](https://qiita-image-store.s3.amazonaws.com/0/80392/ae81397a-dd42-dc7e-aa58-7ab06feb00e7.png)\n<BR><BR>\n* Kinesis Firehose\u306f2017\u5e742\u6708\u73fe\u5728\u3001\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u63d0\u4f9b\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u5229\u7528\u53ef\u80fd\u306a\u5317\u30d0\u30fc\u30b8\u30cb\u30a2(N.Virginia)\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u9078\u629e\u3059\u308b<BR>\n![k-1.png](https://qiita-image-store.s3.amazonaws.com/0/80392/9bfa9b74-a4c3-9188-2046-af6fbd0dc3b7.png)<BR><BR>\n* [Go to Firehose]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-10-19 13.42.20.png](https://qiita-image-store.s3.amazonaws.com/0/80392/472756eb-fefa-84c9-0eff-8cf5741fb938.png)<BR><BR>\n* [Create Delivery Stream]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![Amazon Kinesis Firehose 2016-10-19 13-43-18.png](https://qiita-image-store.s3.amazonaws.com/0/80392/7a25283b-594d-d1c2-260d-229f4ccf806e.png)<BR><BR>\n* \u914d\u9001\u5148\u306b[Amazon S3]\u3092\u9078\u629e\u3059\u308b<BR>\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-10-19 13.44.22.png](https://qiita-image-store.s3.amazonaws.com/0/80392/3c53785c-026c-5212-0599-5eb9d3131049.png)<BR><BR>\n* \u4efb\u610f\u306eStream Name\u3092\u5165\u529b\u3057\u3001\u30ed\u30b0\u3092\u683c\u7d0d\u3059\u308bS3\u30d0\u30b1\u30c3\u30c8\u3092\u9078\u629e(\u3053\u3053\u3067\u306f\u3068\u3082\u306b\u300ciotan-f\u300d\u3068\u3057\u3066\u3044\u308b)\u3059\u308b\u3002\u30d0\u30b1\u30c3\u30c8\u306f\u3053\u3053\u3067\u4f5c\u6210\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b(S3\u30d0\u30b1\u30c3\u30c8\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u306f\u304a\u597d\u307f\u3067)\n* \u30ed\u30b0\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067Stream\u540d+\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3068\u306a\u308b\u304c\u3001\u5fc5\u8981\u3067\u3042\u308c\u3070\u30d7\u30ec\u30d5\u30a3\u30c3\u30af\u30b9\u3092\u6307\u5b9a\u3059\u308b\n* [Next]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![Amazon Kinesis Firehose 2016-10-19 13-46-27.png](https://qiita-image-store.s3.amazonaws.com/0/80392/06ce462f-250c-eca2-2118-0894ec187f0d.png)<BR><BR>\n* Buffer interval(S3\u3078\u306e\u9001\u4fe1\u9593\u9694)\u3092\u6307\u5b9a\u3059\u308b\u3002\u6700\u5c0f\u5024\u306f60\u79d2\u3002**\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u65e9\u304f\u7d50\u679c\u304c\u5206\u304b\u308b\u3088\u3046\u306b60\u79d2\u306b\u8a2d\u5b9a\u3059\u308b**\n* IAM role\u3067[Firehose Delivery IAM role]\u3092\u9078\u629e\u3059\u308b\n* \u4ed6\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067OK<BR>\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-03-04 14.50.48.png](https://qiita-image-store.s3.amazonaws.com/0/80392/72ab066b-b638-91b3-a6af-30d802383e7f.png)<BR><BR>\n* \u305d\u306e\u307e\u307e[Allow]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![IAM Management Console 2016-10-19 13-49-20.png](https://qiita-image-store.s3.amazonaws.com/0/80392/c157d4de-ec77-8361-22b6-0c8ba7b6a331.png)<BR><BR>\n* \u305d\u306e\u307e\u307e[Next]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![Amazon Kinesis Firehose 2016-10-19 13-50-05.png](https://qiita-image-store.s3.amazonaws.com/0/80392/3d722e41-6f5c-3d59-51a3-19f4f1aa9430.png)<BR><BR>\n* [Create Delivery Stream]\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b<BR>\n![Amazon Kinesis Firehose 2016-10-19 13-51-10.png](https://qiita-image-store.s3.amazonaws.com/0/80392/d7e20fcf-59ae-498a-8f02-f8870d20894d.png)<BR><BR>\n* S3\u914d\u9001\u30b9\u30c8\u30ea\u30fc\u30e0\u304c\u4f5c\u6210\u3055\u308c\u305f\u3002[ACTIVE]\u306b\u306a\u3063\u305f\u3089\u5229\u7528\u53ef\u80fd<BR>\n![Amazon Kinesis Firehose 2016-10-19 14-24-14.png](https://qiita-image-store.s3.amazonaws.com/0/80392/a7f368ff-9a9f-073c-a3cb-e6a93bf48e89.png)\n\n#**[ToDo 3] AWS CLI\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b(RaspberryPi)**\n##AWS CLI\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npip\u30b3\u30de\u30f3\u30c9\u3067[AWS CLI](https://aws.amazon.com/jp/cli/)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo pip install awscli\n(\u9014\u4e2d\u7701\u7565)\nSuccessfully installed awscli botocore PyYAML docutils rsa s3transfer jmespath python-dateutil futures\nCleaning up...\n```\n##AWS CLI\u306e\u8a2d\u5b9a\nCLI\u3092\u5b9f\u884c\u3059\u308b\u969b\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3084\u8a8d\u8a3c\u60c5\u5831\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u8a8d\u8a3c\u60c5\u5831\u306f[ToDo 1]\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fCSV\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\n| \u9805\u76ee | \u5165\u529b\u5185\u5bb9 |\n|------|---------|\n|AWS Access Key ID|(CSV\u53c2\u7167)|\n|AWS Secret Access Key|(CSV\u53c2\u7167)|\n|Default region name|us-east-1|\n|Default output format|json|\n\n```bash\n$ aws configure\nAWS Access Key ID [None]: ************                    \nAWS Secret Access Key [None]: ************\nDefault region name [None]: us-east-1\nDefault output format [None]: json\n```\n\n#**[ToDo 4] AWS CLI\u3067Kinesis Firehose\u306bput-record\u3057\u3066\u307f\u308b(RaspberryPi / AWS)**\n##\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306eput-record\nAWS CLI\u3067Kinesis Firehose\u306b\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092put-record\u3057\u3066\u307f\u307e\u3059\u3002`--delivery-stream-name`\u306e\u3042\u3068\u306e`*****`\u306b\u306f\u3001[ToDo 2]\u3067\u8a2d\u5b9a\u3057\u305f\u30b9\u30c8\u30ea\u30fc\u30e0\u540d\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306a`\"RecordId\"`\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u30c7\u30fc\u30bf\u304cS3\u306b\u66f8\u304d\u8fbc\u307e\u308c\u308b\u307e\u3067\u3001\u6700\u5927\u3067[ToDo 2]\u3067\u8a2d\u5b9a\u3057\u305fBuffer interval\u306e\u79d2\u6570\u3060\u3051\u304b\u304b\u308a\u307e\u3059\u3002\n\n```bash\n$ aws firehose put-record --delivery-stream-name ***** --record Data=blob\n{\n    \"RecordId\": \"PEMfHNCtnMGQ5+bCvkm7TgynKepLxf2awvfD5He1atikTPY3zg8Eo2o3LnGhEqYzlVFUEnbv4xT7z8t/AUOVMI8Fy4EcznypTh1xDLP1RnoBtB7MzXOa1094BJ3WhvSV9vWC0sxaHeTAMcDoe1hkSrDQ1BsVZje3iMGkxOuMpnCKw/wEAhPtFn3V3/safpY7sTm7dr8oGYWbPNGzxN7wc6K6VgTYzV6Z\"\n}\n\n```\n##S3\u30d0\u30b1\u30c3\u30c8\u306e\u78ba\u8a8d\n**Quicksight\u3067\u306e\u5206\u6790\u6642\u306b\u30a8\u30e9\u30fc\u306e\u539f\u56e0\u3068\u306a\u308b\u306e\u3067\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\u3057\u305f\u3089\u5fc5\u305a\u524a\u9664\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u4e0b\u3055\u3044\u3002**\n\n* S3\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u958b\u304f([\u65b0UI](http://dev.classmethod.jp/cloud/aws/s3-new-console/)\u3067\u8aac\u660e)\n* [ToDo 2]\u3067\u8a2d\u5b9a\u3057\u305f\u30d0\u30b1\u30c3\u30c8 -> \u5e74 -> \u6708 -> \u65e5 -> \u6642(UTC) \u306e\u9806\u306b\u958b\u304f\n* 1\u3064\u3060\u3051\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b<BR>\n![S3 Management Console 2017-02-05 18-28-22.png](https://qiita-image-store.s3.amazonaws.com/0/80392/60b7bfd6-950b-568a-2389-d1cd031f2db1.png)<BR><BR>\n* \u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u3067\u958b\u304f\u3068\u9001\u4fe1\u5185\u5bb9\u304c\u78ba\u8a8d\u3067\u304d\u308b\n* \u78ba\u8a8d\u5f8c\u306f\u30d0\u30b1\u30c3\u30c8\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u3066\u304a\u304f<BR>\n![iotan-f-2-2017-02-05-09-07-49-8c4cf761-2815-4bda-8f76-be03d3525ee6 (1) 2017-02-05 18-30-49.png](https://qiita-image-store.s3.amazonaws.com/0/80392/4dfd4329-6474-a061-f97a-77d25f3b522d.png)<BR><BR>\n\n##S3\u30d0\u30b1\u30c3\u30c8\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u66f8\u304d\u8fbc\u307e\u308c\u306a\u3044\u5834\u5408\u306f\u30fb\u30fb\u30fb\nKinesis Firehose\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u753b\u9762\u304b\u3089\u30c7\u30e2\u30c7\u30fc\u30bf\u304c\u9001\u4fe1\u3067\u304d\u308b\u306e\u3067\u3001S3\u30d0\u30b1\u30c3\u30c8\u306b\u66f8\u304d\u8fbc\u307e\u308c\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3053\u3068\u3067\u539f\u56e0\u306e\u5207\u308a\u5206\u3051\u304c\u3067\u304d\u307e\u3059\u3002\n![Amazon Kinesis Firehose 2017-02-05 18-21-24.png](https://qiita-image-store.s3.amazonaws.com/0/80392/6b363d50-4549-d549-6ee3-cc4d9cc8da56.png)\n![iotan-f-2-2017-02-05-09-39-46-02201148-4ccd-4c57-81eb-81f5d7fc8c4e 2017-02-05 18-43-29.png](https://qiita-image-store.s3.amazonaws.com/0/80392/c8a2c4a9-3701-f455-a147-6b7e79f95845.png)\n\n\n#**[ToDo 5] \u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u56de\u8def\u3092\u7d44\u307f\u7acb\u3066\u3066\u6e29\u5ea6\u3092\u8a08\u6e2c\u3059\u308b(RaspberryPi)**\n##[1-wire](https://ja.wikipedia.org/wiki/1-Wire)\u30c7\u30b8\u30bf\u30eb\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u3068\u306f\nRaspberryPi\u306eGPIO\u306f\u30c7\u30b8\u30bf\u30eb\u4fe1\u53f7\u3057\u304b\u53d7\u3051\u4ed8\u3051\u307e\u305b\u3093\u304c\u3001\u591a\u304f\u306e\u30bb\u30f3\u30b5\u30fc\u985e\u306f\u30a2\u30ca\u30ed\u30b0\u4fe1\u53f7\u3092\u51fa\u529b\u3057\u307e\u3059\u306e\u3067\u3001AD\u30b3\u30f3\u30d0\u30fc\u30bf\u30fc\u3092\u4f7f\u3063\u3066\u4fe1\u53f7\u3092\u5909\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u4f7f\u3046\u30c7\u30b8\u30bf\u30eb\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc**DS18B20**\u306f\u3001[1-wire](https://ja.wikipedia.org/wiki/1-Wire)\u898f\u683c\u306b\u6e96\u62e0\u3057\u3066\u304a\u308a\u30011\u672c\u306e\u4fe1\u53f7\u7dda\u3060\u3051\u3067\u4f4e\u901f\u306a\u30c7\u30b8\u30bf\u30eb\u30c7\u30fc\u30bf\u8ee2\u9001\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u56de\u8def\u304c\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\n\n##\u6e29\u5ea6\u30bb\u30f3\u30b5\u30fc\u56de\u8def\u306e\u7d44\u307f\u7acb\u3066\n**\u5ff5\u306e\u305f\u3081\u3001RaspberryPi\u3092\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3\u3057\u3066\u56de\u8def\u3092\u63a5\u7d9a\u3057\u3066\u4e0b\u3055\u3044\u3002**\n\u4e0b\u8a18\u306e\u30d1\u30fc\u30c4\u3092\u56f3\u306e\u901a\u308a\u914d\u7dda\u3057\u3001RaspberryPi\u306e\u96fb\u6e90\u3092ON\u306b\u3057\u307e\u3059\u3002\u30b8\u30e3\u30f3\u30d1\u30ef\u30a4\u30e4\u306e\u8272\u306f\u56f3\u306e\u901a\u308a\u3067\u306a\u304f\u3066\u304b\u307e\u3044\u307e\u305b\u3093\u3002\n\n* DS18B20\n* 2.2k\u03a9\u30ab\u30fc\u30dc\u30f3\u62b5\u6297\n* \u30d6\u30ec\u30c3\u30c9\u30dc\u30fc\u30c9\n* \u30b8\u30e3\u30f3\u30d1\u30ef\u30a4\u30e4 \u30aa\u30b9\u30fc\u30e1\u30b9 3\u672c\n\n![DS18B20.png](https://qiita-image-store.s3.amazonaws.com/0/80392/20389c2e-683a-bf4a-1200-f55ee9604b10.png)\n\n##RaspberryPi\u306e\u8a2d\u5b9a\n* 1-wire\u30c7\u30d0\u30a4\u30b9\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8d77\u52d5\u6642\u306b\u8aad\u307f\u8fbc\u3080\u3088\u3046\u306b\u3059\u308b\n\n```bash\n$ sudo vim /etc/modules\n\n(\u6700\u5f8c\u5c3e\u306b\u4e0b\u8a182\u884c\u3092\u8ffd\u8a18\u3059\u308b)\nw1-gpio\nw1-therm\n```\n\n* 1-wire\u30c7\u30d0\u30a4\u30b9\u306eGPIO\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\u3092\u8a18\u8ff0\u3059\u308b\n\n```bash\n$ sudo vim /boot/config.txt\n\n(\u6700\u5f8c\u5c3e\u306b\u4e0b\u8a181\u884c\u3092\u8ffd\u8a18\u3059\u308b)\ndtoverlay=w1-gpio-pullup,gpiopin=4\n```\n\n* \u30ea\u30d6\u30fc\u30c8\u5f8c\u3001\u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n\n```bash\n$ sudo reboot\n```\n\n##\u6e29\u5ea6\u3092\u8aad\u307f\u51fa\u3059\nDS18B20\u306f\u6e29\u5ea6\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u3080\u4ed5\u69d8\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u518d\u8d77\u52d5\u3059\u308b\u3068`/sys/bus/w1/devices/28-************/` (`28-************`\u306f\u500b\u4f53\u306b\u3088\u308a\u7570\u306a\u308b\u30c7\u30d0\u30a4\u30b9ID)\u3068\u3044\u3046\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u4f5c\u6210\u3055\u308c\u3066\u304a\u308a\u3001\u305d\u306e\u4e2d\u306b`w1_slave`\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308b\u306f\u305a\u3067\u3059\u3002`t=`\u306b\u7d9a\u304f5\u6841\u306e\u6574\u6570\u30921000\u3067\u5272\u3063\u305f\u6570\u304c\u6e29\u5ea6(\u6442\u6c0f)\u3067\u3059\u3002\n\u30c7\u30d0\u30a4\u30b9ID `28-************` \u306f**[ToDo 6]\u3067\u4f7f\u3046\u306e\u3067\u63a7\u3048\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044**\u3002\n\n```bash\n$ cd /sys/bus/w1/devices/\n$ ls -l\ntotal 0\nlrwxrwxrwx 1 root root 0 Feb  6 01:28 28-************ -> ../../../devices/w1_bus_master1/28-************\nlrwxrwxrwx 1 root root 0 Feb  6 01:28 w1_bus_master1 -> ../../../devices/w1_bus_master1\n$ cd 28-************\n$ cat w1_slave \na7 01 55 00 7f ff 0c 10 22 : crc=22 YES\na7 01 55 00 7f ff 0c 10 22 t=26437\n```\n\n![pi@raspberrypi: :sys:bus:w1:devices:28-0214642802ff \u2014 ssh pi@192.168.0.3 \u2014 90\u00d711 2017-02-06 01-32-30.png](https://qiita-image-store.s3.amazonaws.com/0/80392/0ef8c927-fe6b-cab6-eec8-8fa48e6d01c9.png)\n\n#**[ToDo 6] \u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u6e29\u5ea6\u30c7\u30fc\u30bf\u3092Kinesis Firehose\u306bput-record\u3059\u308b(RaspberryPi)**\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u4e00\u5b9a\u6642\u9593\u3054\u3068\u306b\u6e29\u5ea6\u3092\u8aad\u307f\u51fa\u3057\u3001AWS CLI\u3092\u53e9\u3044\u3066Kinesis Firehose\u306bput-record\u3057\u307e\u3059\u3002JSON\u306f[**`\"`**]\u3092\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3053\u3068\u306b\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u672c\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u30a8\u30e9\u30fc\u51e6\u7406\u3092\u8003\u616e\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u30d7\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\u306e\u5834\u5408\u306f\u3001\u5f53\u7136\u30a8\u30e9\u30fc\u51e6\u7406\u3092\u8003\u616e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001[fluentd\u306a\u3069\u306e\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u4f7f\u3046](http://qiita.com/Ichiro_Tsuji/items/fce61bdd5974a2c9cf14)\u3068\u3088\u3044\u3067\u3057\u3087\u3046\u3002\n\n\n```bash\n$ cd ~\n$ vim temp-firehose.sh\n```\n\n* `deviceid=`\u306e\u3042\u3068\u306e`28-************`\u306b\u306f\u3001[ToDo 5]\u3067\u63a7\u3048\u305f`28-`\u304b\u3089\u59cb\u307e\u308bDS18B20\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092\u5165\u529b\u3059\u308b\n* `streamname=`\u306e\u3042\u3068\u306e`*********`\u306b\u306f\u3001[ToDo 2]\u3067\u8a2d\u5b9a\u3057\u305f\u30b9\u30c8\u30ea\u30fc\u30e0\u540d\u3092\u5165\u529b\u3059\u308b\n\n```bash:temp-firehose.sh\n#!/bin/bash\n\n# \u7b2c1\u5f15\u6570\u304c\u30c7\u30fc\u30bf\u306e\u9001\u4fe1\u9593\u9694\u3068\u306a\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f15\u79d2)\nif [ \"$1\" = \"\" ]\nthen\n        interval=15\nelse\n        interval=$1\nfi\n\n# DS18B20\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092deviceid\u306b\u30bb\u30c3\u30c8\ndeviceid=28-************\n# Kinesis Firehose\u30b9\u30c8\u30ea\u30fc\u30e0\u540d\u3092streamname\u306b\u30bb\u30c3\u30c8\nstreamname=*********\n\nwhile [ 1 ]\ndo\n        (\n                # \u65e5\u6642\u3092time\u306b\u30bb\u30c3\u30c8\n                time=`date '+%F %T'`\n                # \u6e29\u5ea6\u3092\u8aad\u307f\u53d6\u308a\u3001temp\u306b\u30bb\u30c3\u30c8\n                temp=$(awk -F= 'END {print $2/1000}' < /sys/bus/w1/devices/$deviceid/w1_slave)\n                # \u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u304c\u53d6\u5f97\u3067\u304d\u305f\u3068\u304d\u306e\u307f\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3059\u308b\n                if [ -n \"$temp\" ] ; then\n                        # \u9001\u4fe1\u3059\u308bJSON\u6587\u5b57\u5217\u3092\u4f5c\u308b\n                        payload='{\\\"time\\\":\\\"'$time'\\\", \\\"temperature\\\":'$temp'}'\n                        # JSON\u3092\u753b\u9762\u306b\u8868\u793a\n                        echo $payload\n                        # AWS CLI\u3067put-record\u3059\u308b\n                        aws firehose put-record --delivery-stream-name $streamname --record=\"{\\\"Data\\\":\\\"$payload\\n\\\"}\"\n                fi\n        ) &\n        sleep $interval\ndone\n```\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u505c\u6b62\u3059\u308b\u5834\u5408\u306f`ctrl + C`\u3002\u7b2c1\u5f15\u6570(\u4e0b\u8a18\u3067\u306f20)\u304c\u9001\u4fe1\u9593\u9694\u3067\u3001\u7701\u7565\u3057\u305f\u5834\u5408\u306f15\u79d2\u9593\u9694\u3067\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\u4e0b\u8a18\u306e\u3088\u3046\u306bJSON\u3068`\"RecordId\"`\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u4ea4\u4e92\u306b\u8868\u793a\u3055\u308c\u305f\u3089\u6210\u529f\u3067\u3059\u3002\u9001\u4fe1\u9593\u9694\u306b\u3088\u3063\u3066\u306f\u30ec\u30b9\u30dd\u30f3\u30b9\u306f\u9045\u308c\u3066\u8868\u793a\u3055\u308c\u308b\u3053\u3068\u3082\u3042\u308a\u307e\u3059\u3002\n\n```bash\n$ sh temp-firehose.sh 20\n{\\\"time\\\":\\\"2017-02-06 01:00:10\\\", \\\"temperature\\\":26.187}\n{\n    \"RecordId\": \"sqyX8BaKpoWgWlYjJcPdxlp/sIxOIisujyk/cjbgnUO+CbigLVEhNk9UBL9VmmQL7QXtWu5c0Gi0yZF9hYi8rY5YBXoM9anaKsEowTHSfpjQSpx9/zink5b8WQvJYZtAazYolN7GfwQkWzCQHmTbGrUztmLwiZfECorKU4SCiHF0xbDkz5b+1W9F/ylabNHNbV8Fx4gEIJs45pX+LpWz7+zjsMHmZSun\"\n}\n{\\\"time\\\":\\\"2017-02-06 01:00:30\\\", \\\"temperature\\\":26.062}\n{\n    \"RecordId\": \"sHadXs3jJTUnu9FLwPfwZzVDautdy7Vdy7k7u9dt1tYLlgF5MA4aVTYiNTh6yOtKn8H+OwWOIS3WmJTIO70kA+3snWWWG+a0fHFwQEXkIZTlu1ybXbPfXPS9566mMRkA1nLAxiBQSsXr8Wpv9XO9S6e3tf5CJYwOMaKbVVCKpr+u+uKqueyZVioLAKQz1TrF11jMBxNUdApdyVK8LQFvWu9c3V+WDcPl\"\n}\n```\n\n#**[ToDo 7] S3\u30d0\u30b1\u30c3\u30c8\u306b\u6e29\u5ea6\u30c7\u30fc\u30bf\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304c\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b(AWS)**\n[ToDo 4]\u306e\u624b\u9806\u3067S3\u30d0\u30b1\u30c3\u30c8\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u521d\u56de\u306f\u66f8\u304d\u8fbc\u307e\u308c\u308b\u307e\u3067\u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002<BR>\n![S3 Management Console 2017-02-06 01-21-10.png](https://qiita-image-store.s3.amazonaws.com/0/80392/c4fb4193-7b26-96e8-f61d-a59b7992e09a.png)\n\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\u3068JSON\u304c\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\u30bb\u30f3\u30b5\u30fc\u3092\u4fdd\u51b7\u5264\u3067\u51b7\u3084\u3059\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u6e29\u5ea6\u304c\u4e0b\u304c\u308a\u307e\u3059\u3002<BR>\n![iotan-f-2-2017-02-05-16-04-50-9ee9d802-867e-41bc-b222-6162ec3c2f18 2017-02-06 01-23-02.png](https://qiita-image-store.s3.amazonaws.com/0/80392/e216a1b7-8c44-28a5-bc4c-bc24b74cd41a.png)\n\n**\u6b63\u5e38\u306b\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u305f\u3089\u3001\u30c7\u30fc\u30bf\u3092\u84c4\u7a4d\u3059\u308b\u305f\u3081\u306b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u5b9f\u884c\u3057\u305f\u307e\u307e\u306e\u72b6\u614b\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002**\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u4ed6\u306e\u64cd\u4f5c\u3092\u3059\u308b\u5834\u5408\u306f\u3001\u5225\u30a6\u30a4\u30f3\u30c9\u30a6\u3067SSH\u63a5\u7d9a\u3057\u307e\u3057\u3087\u3046\u3002\n\n#**\uff1c\u5f8c\u7de8\uff1e\u306f[\u3053\u3061\u3089](http://qiita.com/ha_ru_ma_ki/items/ee77b3755ef50181bba4)**\n\n#**[\u304a\u307e\u3051] \u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u6e29\u5ea6\u30c7\u30fc\u30bf\u3092DynamoDB\u306bput-item\u3059\u308b(RaspberryPi)**\nNoSQL DB\u3067\u3042\u308b[Amazon DynamoDB](https://aws.amazon.com/jp/dynamodb/)\u306b\u3082\u307b\u307c\u540c\u3058\u65b9\u6cd5\u3067\u66f8\u304d\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n[IoT.kyoto VIS](http://iot.kyoto)\u3067\u53ef\u8996\u5316\u3059\u308b\u3068\u826f\u3044\u304b\u3082\u3067\u3059\u3002(\u5ba3\u4f1d\u30b9\u30df\u30de\u30bb\u30f3)\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-12 14.29.41.png](https://qiita-image-store.s3.amazonaws.com/0/80392/b760a59d-3e9a-8857-2cfe-351630220753.png)\n\n\n##DynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\n* `aws configure`\u30b3\u30de\u30f3\u30c9\u3067\u767b\u9332\u3057\u305fIAM\u306bDynamoDB\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650(`AmazonDynamoDBFullAccess`\u7b49)\u3092\u4ed8\u4e0e\u3059\u308b\n* \u4ee5\u4e0b\u306e\u6761\u4ef6\u3067DynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n| \u9805\u76ee | \u8a2d\u5b9a\u5024 |\n|----------|----------|\n| \u30ea\u30fc\u30b8\u30e7\u30f3 | \u5317\u30d0\u30fc\u30b8\u30cb\u30a2(us-east-1) |\n| Table Name | (\u4efb\u610f\u306e\u30c6\u30fc\u30d6\u30eb\u540d) |\n| Partition key | id |\n| Sort key | time |\n\n##\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\n```bash\n$ vim temp-dynamodb.sh\n```\n\n* `deviceid=`\u306e\u3042\u3068\u306e`28-************`\u306b\u306f\u3001[ToDo 5]\u3067\u63a7\u3048\u305f`28-`\u304b\u3089\u59cb\u307e\u308bDS18B20\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092\u5165\u529b\u3059\u308b\n* `tablename=`\u306e\u3042\u3068\u306e`*********`\u306b\u306f\u3001DynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5165\u529b\u3059\u308b\n\n```bash:temp-dynamodb.sh\n#!/bin/bash\n\n# \u7b2c1\u5f15\u6570\u304c\u30c7\u30fc\u30bf\u306e\u9001\u4fe1\u9593\u9694\u3068\u306a\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f15\u79d2)\nif [ \"$1\" = \"\" ]\nthen\n        interval=15\nelse\n        interval=$1\nfi\n\n# DS18B20\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092deviceid\u306b\u30bb\u30c3\u30c8\ndeviceid=28-************\n# DynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u540d\u3092tablemname\u306b\u30bb\u30c3\u30c8\ntablename=*********\n# \u30ce\u30fc\u30c9\u306e\u30c7\u30d0\u30a4\u30b9ID\u3092id\u306b\u30bb\u30c3\u30c8\nid=id001\n\nwhile [ 1 ]\ndo\n        (\n                # \u65e5\u6642\u3092time\u306b\u30bb\u30c3\u30c8\n                time=`date '+%F %T'`\n                # \u6e29\u5ea6\u3092\u8aad\u307f\u53d6\u308a\u3001temp\u306b\u30bb\u30c3\u30c8\n                temp=$(awk -F= 'END {print $2/1000}' < /sys/bus/w1/devices/$deviceid/w1_slave)\n                # \u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u304c\u53d6\u5f97\u3067\u304d\u305f\u3068\u304d\u306e\u307f\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3059\u308b\n                if [ -n \"$temp\" ] ; then\n                        # \u9001\u4fe1\u3059\u308bJSON\u6587\u5b57\u5217\u3092\u4f5c\u308b\n                        payload='{\"id\": {\"S\":\"'$id'\"},\"time\": {\"S\":\"'$time'\"},\"temperature\": {\"N\":\"'$temp'\"}}'\n                        # JSON\u3092\u753b\u9762\u306b\u8868\u793a\n                        echo $payload\n                        # AWS CLI\u3067put-item\u3059\u308b(\u6d88\u8cbb\u30ad\u30e3\u30d1\u30b7\u30c6\u30a3\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u306a\u3057)\n                        aws dynamodb put-item --table-name tablename --item=\"$payload\"\n                        # AWS CLI\u3067put-item\u3059\u308b(\u6d88\u8cbb\u30ad\u30e3\u30d1\u30b7\u30c6\u30a3\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3042\u308a)\n                        #aws dynamodb put-item --table-name $tablename --item=\"$payload\" --return-consumed-capacity TOTAL\n                fi\n        ) &\n        sleep $interval\ndone\n```\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u505c\u6b62\u3059\u308b\u5834\u5408\u306fctrl + C\u3002\u7b2c1\u5f15\u6570(\u4e0b\u8a18\u3067\u306f1)\u304c\u9001\u4fe1\u9593\u9694\u3067\u3001\u7701\u7565\u3057\u305f\u5834\u5408\u306f15\u79d2\u9593\u9694\u3067\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\u4e0b\u8a18\u306e\u3088\u3046\u306b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u305a\u3001JSON\u304c\u9023\u7d9a\u3057\u3066\u8868\u793a\u3055\u308c\u3066\u3044\u305f\u3089\u6210\u529f\u3067\u3059\u3002\n\n```bash\n$ sh temp-dynamodb.sh 1\n{\"id\": {\"S\":\"id001\"},\"time\": {\"S\":\"2017-02-12 14:09:48\"},\"temperature\": {\"N\":\"30.437\"}}\n{\"id\": {\"S\":\"id001\"},\"time\": {\"S\":\"2017-02-12 14:09:49\"},\"temperature\": {\"N\":\"29.937\"}}\n{\"id\": {\"S\":\"id001\"},\"time\": {\"S\":\"2017-02-12 14:09:50\"},\"temperature\": {\"N\":\"29.562\"}}\n{\"id\": {\"S\":\"id001\"},\"time\": {\"S\":\"2017-02-12 14:09:51\"},\"temperature\": {\"N\":\"29.312\"}}\n```\n\n##DynamoDB\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u66f8\u304d\u8fbc\u307e\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-02-12 14.14.51.png](https://qiita-image-store.s3.amazonaws.com/0/80392/a64bdf5e-beed-ec44-58c8-723e512eef12.png)\n", "tags": ["RaspberryPi", "AWS", "IoT", "QuickSight", "Athena"]}