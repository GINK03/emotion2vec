{"context": " More than 1 year has passed since last update.\u4e16\u306e\u4e2d\u4fbf\u5229\u306a\u3082\u306e\u3067\u81ea\u5206\u3067\u30b5\u30fc\u30d0\u3092\u7acb\u3066\u308b\u3053\u3068\u3082\u6700\u8fd1\u3067\u306f\u7121\u304f\u306a\u3063\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\u306b\u96c6\u4e2d\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u305f\u3060\u3001\u3069\u3093\u306a\u306b\u4fbf\u5229\u306b\u306a\u3063\u3066\u3082\u4f7f\u3046\u305f\u3081\u306b\u306f\u8a2d\u5b9a\u304c\u5fc5\u305a\u5fc5\u8981\u306b\u306a\u308b\u308f\u3051\u3067\u3001\u77e5\u8b58\u304c\u306a\u304f\u3066\u306f\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u540d\u524d\u3084\u5185\u5bb9\u3092\u3069\u3093\u306a\u3075\u3046\u306b\u8a2d\u5b9a\u3057\u305f\u3089\u826f\u3044\u304b\u3042\u305f\u308a\u3092\u3064\u3051\u308b\u4e8b\u3082\u307e\u307e\u306a\u308a\u307e\u305b\u3093\u3002\n\u72ec\u65ad\u3068\u504f\u898b\u3067\u3059\u304cweb\u7cfb\u30a8\u30f3\u30b8\u30cb\u30a2\u306b\u3082\u6df1\u3044\u95a2\u308f\u308a\u306e\u3042\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\uff12\u3064\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u3001\u30b5\u30fc\u30d0\u69cb\u7bc9\u306e\u624b\u9806\u3092\u66f8\u304d\u7559\u3081\u305f\u306e\u3067\u3001\u51ac\u4f11\u307f\u306e\u4f59\u8208\u306b\u3067\u3082\u3069\u3046\u305e\u3002\n\nDNS\n\nDNS\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\u3059\u308b\nDNS\u30b5\u30fc\u30d0\u3092\u4f5c\u308b\u306e\u306bAWS\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u5916\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u305f\u3081\u3001\u540d\u524d\u89e3\u6c7a\u306b\u5229\u7528\u3055\u308c\u308b53\u756a\u30dd\u30fc\u30c8\u306eTCP/UDP\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u6642\u306eSecurityGroup\u306b53\u756a\u30dd\u30fc\u30c8\u306eTCP/UDP\u3092\u4ed8\u4e0e\u3059\u308c\u3070\u5927\u4e08\u592b\u3067\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u30d6\u30e9\u30a6\u30b6\u3067www.yahoo.co.jp\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068google.co.jp\u306b\u30a2\u30af\u30bb\u30b9\u3055\u308c\u308b\u3088\u3046\u306bDNS\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u305f\u3060\u3057chroot\u306a\u3069\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5bfe\u7b56\u306f\u884c\u3063\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u3053\u306e\u8a2d\u5b9a\u306e\u307e\u307e\u904b\u7528\u3059\u308b\u306e\u306f\u3084\u3081\u305f\u65b9\u304c\u826f\u3044\u3067\u3059\u3002\n\n\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u30b5\u30a4\u30c8\nDNS\u30b5\u30fc\u30d0\u30fc\u69cb\u7bc9(BIND)\nEC2\u4e0a\u3067\u5185\u90e8\u5411\u3051DNS\u3092\u69cb\u7bc9\u3057\u3066\u307f\u308b\n\n\u5fc5\u8981\u306a\u7269\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nbind\nbind\u306fDNS\u30b5\u30fc\u30d0\u3068\u30ea\u30be\u30eb\u30d0\u306a\u3069\u306e\u5404\u7a2e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u5165\u3063\u3066\u307e\u3059\u3002\nDNS\u30b5\u30fc\u30d0\u306b\u306fIP\u30a2\u30c9\u30ec\u30b9\u3068\u30c9\u30e1\u30a4\u30f3\u306e\u30bb\u30c3\u30c8\u3092\u4fdd\u6301\u3057\u3066\u304a\u308a\u3001\u30ea\u30be\u30eb\u30d0\u304cDNS\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3044\u540d\u524d\u89e3\u6c7a\u3092\u884c\u3044\u307e\u3059\u3002\n$ sudo yum -y install bind\n\nbind\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n$ sudo cp /etc/named.conf{,.org}\n$ sudo vim /etc/named.conf\n\n\n/etc/named.conf\n//\n// named.conf\n//\n// Provided by Red Hat bind package to configure the ISC BIND named(8) DNS\n// server as a caching only nameserver (as a localhost DNS resolver only).\n//\n// See /usr/share/doc/bind*/sample/ for example named configuration files.\n//\n\noptions {\n        # \u81ea\u8eab\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304b\u3089\u5fdc\u7b54\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\n         # listen on port\u306bEC2\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\u3092\u8ffd\u52a0\n        listen-on port 53 { 127.0.0.1; XXX.XXX.XXX.XXX;};\n        listen-on-v6 port 53 { ::1; };\n        directory       \"/var/named\";\n        dump-file       \"/var/named/data/cache_dump.db\";\n        statistics-file \"/var/named/data/named_stats.txt\";\n        memstatistics-file \"/var/named/data/named_mem_stats.txt\";\n        # \u5916\u304b\u3089\u306e\u8981\u6c42\u306b\u7b54\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081any\u306b\u5909\u66f4\n        allow-query     { any; };\n        recursion yes;\n\n        dnssec-enable yes;\n        dnssec-validation yes;\n        dnssec-lookaside auto;\n        # \u81ea\u5206\u3067\u306f\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u306a\u304b\u3063\u305f\u6642\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308bDNS\u30b5\u30fc\u30d0\u306eIP\u30a2\u30c9\u30ec\u30b9\n        # 8.8.8.8\u306fGoogle\u304c\u63d0\u4f9b\u3059\u308bDNS\n        forwarders {  8.8.8.8; 8.8.4.4; };\n        forward only;\n\n        /* Path to ISC DLV key */\n        bindkeys-file \"/etc/named.iscdlv.key\";\n\n        managed-keys-directory \"/var/named/dynamic\";\n};\n\nlogging {\n        channel default_debug {\n                file \"data/named.run\";\n                severity dynamic;\n        };\n};\n\nzone \".\" IN {\n        type hint;\n        file \"named.ca\";\n};\n\n# yahoo.co.jp\u306e\u554f\u3044\u5408\u308f\u305b\u3092master.yahoo.co.jp\u306e\u4e2d\u306b\u8a18\u8ff0\u3055\u308c\u305fIP\u3067\u8fd4\u5374\u3059\u308b\nzone \"yahoo.co.jp\" IN {\n  type master;\n  file \"master.yahoo.co.jp\";\n};\n\ninclude \"/etc/named.rfc1912.zones\";\ninclude \"/etc/named.root.key\";\n\n\nyahoo.co.jp\u3078\u306e\u540d\u524d\u89e3\u6c7a\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\n$ sudo vi /var/named/master.yahoo.co.jp\n\n\n/var/named/master.yahoo.co.jp\n$TTL 43200\nyahoo.co.jp.     IN      SOA    help.yahoo.co.jp. ns01.yahoo.co.jp. (\n                         1\n                         21600\n                         7200\n                         1209600\n                         43200)\n\nyahoo.co.jp.            NS      ns01.yahoo.co.jp.\nns01                    A       216.58.220.206 # google.co.jp\u306eIP\nwww                     A       216.58.220.206 # google.co.jp\u306eIP\n\n\n\u8d77\u52d5\u3068\u81ea\u52d5\u8d77\u52d5\u3092\u6709\u52b9\u5316\n$ sudo /etc/init.d/named start\n$ sudo chkconfig named on\n\nDNS\u30ea\u30be\u30eb\u30d0\u306e\u5411\u304d\u5148\u3092\u81ea\u8eab\u306eDNS\u30b5\u30fc\u30d0\u306b\u5909\u66f4\u3059\u308b\n$ sudo cp /etc/resolv.conf{,.org}\n$ sudo vi /etc/resolv.conf\n$ cat /etc/resolv.conf\n; generated by /sbin/dhclient-script\nsearch ap-northeast-1.compute.internal\nnameserver 127.0.0.1\n\n$ sudo vi /etc/sysconfig/network-scripts/ifcfg-eth0\n\nDEVICE=eth0\nBOOTPROTO=dhcp\nONBOOT=yes\nTYPE=Ethernet\nUSERCTL=yes\n# DHCP\u3067IP\u3092\u53d6\u5f97\u6642\u306byes\u3060\u3068/etc/resolv.conf\u306e\u5024\u304c\u66f4\u65b0\u3055\u308c\u3066\u3057\u307e\u3046\nPEERDNS=no\nIPV6INIT=no\nPERSISTENT_DHCLIENT=yes\n\n\u3053\u308c\u3067DNS\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\u306f\u7d42\u308f\u308a\u3067\u3001PC\u306eDNS\u306e\u5411\u304d\u5148\u3092\u4f5c\u6210\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306ePublicIP\u3092\u6307\u5b9a\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u306byahoo.co.jp\u3068\u5165\u529b\u3057\u307e\u3059\u3002\n\u3046\u307e\u304f\u884c\u3063\u3066\u3044\u308c\u3070google.co.jp\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\nSMTP POP3\nSMTP\u3068POP3\u306f\u30e1\u30fc\u30eb\u306e\u9001\u53d7\u4fe1\u306b\u4f7f\u308f\u308c\u308b\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\nSMTP\u306f\u9001\u4fe1\u3001POP3\u306f\u53d7\u4fe1\u3092\u62c5\u5f53\u3057\u3066\u3044\u307e\u3059\u3002\n\u4f7f\u7528\u3059\u308b\u30dd\u30fc\u30c8\u306fSMTP\u304c25\u756a POP3\u304c110\u756a\u3067\u3059\u3002\n\n\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\n\n\u5fc5\u8981\u306a\u3082\u306e\n\n\u30b5\u30fc\u30d0\n\u30e1\u30fc\u30eb\u3092\u9001\u53d7\u4fe1\u3059\u308b\u306e\u306b\u5fc5\u8981\u3067\u3059\u3002\n\u30c9\u30e1\u30a4\u30f3\n\u53d7\u4fe1\u306e\u5fc5\u8981\u304c\u3042\u308b\u306a\u3089\u5fc5\u9808\u3067\u3059\u3002\n\n\n\u30b5\u30fc\u30d0\u306e\u7528\u610f\n\u9001\u4fe1\u306b\u306fPostfix \u53d7\u4fe1\u306fDevecot\u3092\u4f7f\u3044\u307e\u3059\u3001\u4f8b\u3067\u306fAmazonLinux\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u4f5c\u6210\u3059\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eSecurityGroup\u306b\u306f25\u3068110\u306e\u30dd\u30fc\u30c8\u306e\u30a4\u30f3\u30d0\u30a6\u30f3\u30c9\u3092\u8a31\u53ef\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\nEC2\u304b\u3089\u30ed\u30fc\u30ab\u30eb\u306b\u5bfe\u3057\u3066\u306e\u30e1\u30fc\u30eb\u3067\u3082\u30dd\u30fc\u30c8\u304c\u7a7a\u3044\u3066\u306a\u3044\u3068\u9001\u53d7\u4fe1\u304c\u51fa\u6765\u307e\u305b\u3093\u3002\n\u81ea\u5b85\u30b5\u30fc\u30d0\u306a\u3089\u3070\u30eb\u30fc\u30bf\u306e\u8a2d\u5b9a\u308225\u3068110\u756a\u306e\u30dd\u30fc\u30c8\u3092\u5229\u7528\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\nDovecot\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nshell\nsudo yum -y install dovecot\nsudo service dovecot start # \u8d77\u52d5\n$ sudo chkconfig dovecot on # \u81ea\u52d5\u8d77\u52d5\u6709\u52b9\n\n\n\nPostfix\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nshell\n# \u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u8cea\u554f\u306b\u56de\u7b54\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\n# \u7528\u9014\u306b\u3064\u3044\u3066\u306f\u300c\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b5\u30a4\u30c8\u300d\u3001\u30b7\u30b9\u30c6\u30e0\u30e1\u30fc\u30eb\u540d\u306f\u300c\u4e86\u89e3\u300d\u3092\u9078\u629e\n$ sudo yum -y install postfix mailx\n$ sudo service postfix start # \u8d77\u52d5\n$ sudo chkconfig postfix on # \u81ea\u52d5\u8d77\u52d5\u6709\u52b9\n\n# postfix\u3068\u540c\u3058\u304fPOP3\u3092\u63d0\u4f9b\u3059\u308bsendmail\u304b\u3089postfix\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u306b\u3059\u308b\n$ sudo /etc/rc.d/init.d/sendmail stop # \u505c\u6b62\n$ sudo chkconfig sendmail off # \u81ea\u52d5\u8d77\u52d5\u3092\u7121\u52b9\n$ sudo alternatives --config mta # alternatives\u30b3\u30de\u30f3\u30c9\u3067mta\u3092postfix\u306b\u5909\u66f4\u3059\u308b 2\u3092\u5165\u529b\u3057\u3066\u30a8\u30f3\u30bf\u30fc\n2 \u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3042\u308a 'mta' \u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\n  \u9078\u629e       \u30b3\u30de\u30f3\u30c9\n-----------------------------------------------\n*  1           /usr/sbin/sendmail.sendmail\n + 2           /usr/sbin/sendmail.postfix\n\n\n\npostfix\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u63db\u3048\u308b\n\n/etc/postfix/main.cf\n# \u30e1\u30fc\u30eb\u3092\u9001\u308b\u6642\u306e@\u4ee5\u964d\u306e\u6587\u5b57\u5217\nmyhostname = mail.example.com\u306a\u3069\n\n# \u30c9\u30e1\u30a4\u30f3\u540d\nmydomain = example.com\n\n# \u30b3\u30e1\u30f3\u30c8\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067#\u3092\u5916\u3059\nmyorigin = $mydomain\n\n# localhost\u3060\u3068\u30ed\u30fc\u30ab\u30eb\u5185\u304b\u3089\u306e\u30e1\u30fc\u30eb\u306e\u53d7\u4fe1\u306e\u307f\u53ef\u80fd\u306a\u306e\u3067\u5168\u3066\u306e\u30e1\u30fc\u30eb\u3092\u53d7\u4fe1\u53ef\u80fd\u306b\u3059\u308b\ninet_interfaces = all\n\n# ipv6\u3092\u8a31\u53ef\u3059\u308b\u3068\u74b0\u5883\u306b\u3088\u3063\u3066\u306f\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3089\u3057\u3044\ninet_protocols = ipv4\n\n# $mydomain\u3092\u8ffd\u52a0\u3059\u308b\n# mta\u304c@\u4ee5\u964d\u306e\u30c9\u30e1\u30a4\u30f3\u3092mydestination\u306e\u5024\u3068\u6bd4\u8f03\u3057\u3066\u81ea\u5206\u304c\u53d7\u4fe1\u3059\u308b\u3079\u304d\u304b\u5224\u5b9a\u306b\u4f7f\u3046\u305f\u3081\u3001\n# \u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3068\u53d7\u4fe1\u51fa\u6765\u306a\u3044\nmydestination = $myhostname, localhost.$mydomain, localhost, $mydomain\n\nhome_mailbox = Maildir/ # \u30b3\u30e1\u30f3\u30c8\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067#\u3092\u5916\u3059\n\n\n\nshell\n# test@mail.example.com\u5b9b\u306f /home/test/Maildir/new\u4ee5\u4e0b\u306b\u4fdd\u5b58\u3055\u308c\u308b\n\n# \u30e6\u30fc\u30b6\u4f5c\u6210\u6642\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\u3092\u8a2d\u5b9a\n$ sudo mkdir -p /etc/skel/Maildir/{new,cur,tmp}\n$ sudo chmod -R 700 /etc/skel/Maildir/\n$ sudo useradd test\n$ sudo passwd test\n$ su - test\n\n\n\n\u5b9f\u884c\n\nshell\n# \u9001\u308c\u305f\u304b\u3069\u3046\u304b /var/log/mail.log \u3068 /var/log/mail.err\u3092tail\u3057\u3066\u304a\u304f\u3068\u308f\u304b\u308a\u3084\u3059\u3044\n# \u3055\u304d\u307b\u3069\u4f5c\u6210\u3057\u305fdovcot\u3067\u9001\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\necho \"Hello\" | mail ec2-user@localhost\n\n\n# \u78ba\u8a8d Hello\u3068\u3044\u3046\u5185\u5bb9\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\nsudo cat /var/mail/ec2-user\n\nFrom ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal  Sun Nov 29 18:38:38 2015\nReturn-Path: <ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal>\nReceived: from ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal (localhost [127.0.0.1])\n    by ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal (8.14.4/8.14.4) with ESMTP id tATIccSd031046\n    for <ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal>; Sun, 29 Nov 2015 18:38:38 GMT\nReceived: (from ec2-user@localhost)\n    by ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal (8.14.4/8.14.4/Submit) id tATIccjD031045\n    for ec2-user@localhost; Sun, 29 Nov 2015 18:38:38 GMT\nFrom: EC2 Default User <ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal>\nMessage-Id: <201511291838.tATIccjD031045@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal>\nDate: Sun, 29 Nov 2015 18:38:38 +0000\nTo: ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal\nUser-Agent: Heirloom mailx 12.4 7/29/08\nMIME-Version: 1.0\nContent-Type: text/plain; charset=us-ascii\nContent-Transfer-Encoding: 7bit\n\nHello\n\n\n\u307b\u3044\u3001\u30ed\u30fc\u30ab\u30eb\u304b\u3089\u306e\u9001\u53d7\u4fe1\u306f\u5272\u308a\u3068\u3059\u3093\u306a\u308a\u51fa\u6765\u307e\u3057\u305f\u3002\n\nDNS\u306e\u8a2d\u5b9a\u3092\u884c\u3046\n\u5916\u90e8\u304b\u3089\u30e1\u30fc\u30eb\u3092\u53d7\u4fe1\u3059\u308b\u305f\u3081\u306b\u306f\u3001@\u4ee5\u964d\u306e\u30c9\u30e1\u30a4\u30f3\u304b\u3089\u4eca\u4f5c\u6210\u3057\u305f\u30b5\u30fc\u30d0\u306eIP\u304c\u5f15\u3051\u308b\u3088\u3046\u306b\u306a\u3089\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\u306a\u306e\u3067\u3001\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306bMX\u30ec\u30b3\u30fc\u30c9\u3068A\u30ec\u30b3\u30fc\u30c9\u3092\u767b\u9332\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u304a\u540d\u524d.com\u3067\u3042\u308c\u3070\u8a2d\u5b9a\u3059\u308b\u4e8b\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u3042\u308b\u3044\u306f\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u3092AWS\u306eRoute53\u306b\u5909\u66f4\u3057\u3001\u767b\u9332\u3057\u307e\u3059\u3002\n\nA\u30ec\u30b3\u30fc\u30c9\nA\u30ec\u30b3\u30fc\u30c9\u306f\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u5fdc\u3059\u308bIP\u30a2\u30c9\u30ec\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\u30ec\u30b3\u30fc\u30c9\n\u305d\u306e\u4ed6\u306b\u306fCNAME\u30ec\u30b3\u30fc\u30c9\u306a\u3069\u304c\u6709\u308a\u3001CNAME\u30ec\u30b3\u30fc\u30c9\u306f\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u3057\u3066\u5225\u306e\u30c9\u30e1\u30a4\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\nMX\u30ec\u30b3\u30fc\u30c9\n\u30e1\u30fc\u30eb\u306e\u5b9b\u5148\u3092A\u30ec\u30b3\u30fc\u30c9\u3067\u6307\u5b9a\u3057\u305f\u30c9\u30e1\u30a4\u30f3\u540d\u3092MX\u30ec\u30b3\u30fc\u30c9\u306eVALUE\u306b\u8a18\u8ff0\u3059\u308b\u3002\n\n\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u308b\u306b\u306f\u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u3057\u3070\u3089\u304f\u3057\u305f\u3089dig\u30b3\u30de\u30f3\u30c9(windows\u3067\u3042\u308c\u3070nslookup)\u3092\u4f7f\u3063\u3066\u8a2d\u5b9a\u304c\u6ce2\u53ca\u3055\u308c\u305f\u304b\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n# ANSWER SECTION\u306b\u5148\u307b\u3069\u306e\u8a2d\u5b9a\u304c\u51fa\u3066\u3044\u308c\u3070OK\n# MX\u30ec\u30b3\u30fc\u30c9\u304c\u6ce2\u53ca\u3055\u308c\u305f\u304b\u78ba\u8a8d\u3059\u308b\u306e\u306f dig mail.example.com mx \u3067\u78ba\u8a8d\u51fa\u6765\u308b\n$ dig mail.example.com\n\n; <<>> DiG 9.8.3-P1 <<>> mail.example.com\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 26357\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 4, ADDITIONAL: 6\n\n;; QUESTION SECTION:\n;mail.example.com.          IN  A\n\n;; ANSWER SECTION:\nmail.example.com.       3600    IN  A   XXX.XXX.XXX.XXX\n\n;; AUTHORITY SECTION:\nexample.com.        86265   IN  NS  03.dnsv.jp.\nexample.com.        86265   IN  NS  02.dnsv.jp.\nexample.com.        86265   IN  NS  04.dnsv.jp.\nexample.com.        86265   IN  NS  01.dnsv.jp.\n\n;; ADDITIONAL SECTION:\n01.dnsv.jp.     19035   IN  A   XXX.XXX.XXX.XXX\n02.dnsv.jp.     15489   IN  A   XXX.XXX.XXX.XXX\n03.dnsv.jp.     15390   IN  A   XXX.XXX.XXX.XXX\n03.dnsv.jp.     12191   IN  AAAA    2400:8500:3000::53\n04.dnsv.jp.     13134   IN  A   XXX.XXX.XXX.XXX\n04.dnsv.jp.     48160   IN  AAAA    2400:8500:3fff::53\n\n;; Query time: 36 msec\n;; SERVER: 192.168.11.1#53(192.168.11.1)\n;; WHEN: Sat Dec  5 12:31:33 2015\n;; MSG SIZE  rcvd: 243\n\n\n\n\u9001\u53d7\u4fe1\u3092\u3057\u3066\u307f\u308b\n\u307e\u305a\u306f\u53d7\u4fe1\u3092\u3057\u3066\u307f\u308b\u306e\u3067\u3001Gmail\u306a\u3069\u306e\u30e1\u30fc\u30e9\u304b\u3089test@mail.example.com\u306b\u5411\u3051\u3066\u30e1\u30fc\u30eb\u3092\u9001\u3063\u3066\u307f\u308b\u3002\n\u3059\u308b\u3068test\u30e6\u30fc\u30b6\u306eMaildir/new\u306b\u65b0\u898f\u30e1\u30fc\u30eb\u304c\u5c4a\u3044\u3066\u3044\u308b\u306f\u305a...!\n\u540c\u3058\u3088\u3046\u306bmail\u30b3\u30de\u30f3\u30c9\u3067\u5916\u90e8\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u3057\u3066\u3082\u9001\u308b\u4e8b\u304c\u53ef\u80fd\u3067\u3059\u3002\n\nshell\necho \"\u9001\u4fe1\u30c6\u30b9\u30c8\" | mail \"example@gmail.com\"\n\n\n\n\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\n\u3053\u308c\u307e\u3067\u306f\u81ea\u8eab\u3067\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u3092\u8aac\u660e\u3057\u307e\u3057\u305f\u304c\u3001\u4ee5\u4e0b\u306e\u30b5\u30fc\u30d3\u30b9\u306f\u3053\u308c\u307e\u3067\u306e\u82e6\u52b4\u3092\u4ee3\u7406\u3067\u884c\u3063\u3066\u304f\u308c\u308b\u7269\u3067\u3059\u3002\n\u81ea\u5206\u3067\u4f5c\u308b\u6a5f\u4f1a\u304c\u3042\u308b\u3068\u304d\u306f\u672c\u5f53\u306b\u81ea\u5206\u3067\u4f5c\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u304b\u5224\u65ad\u3057\u3001\u305d\u306e\u4e2d\u3067\u3082\u30b5\u30fc\u30d3\u30b9\u3054\u3068\u306b\u7279\u8272\u304c\u7570\u306a\u308b\u306e\u3067\u614e\u91cd\u306b\u9078\u629e\u3059\u308b\u3068\u5e78\u305b\u306b\u306a\u308c\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\nSES\nAWS\u304c\u63d0\u4f9b\u3059\u308b\u30e1\u30fc\u30eb\u30b5\u30fc\u30d3\u30b9 \u5b89\u3044\u304b\u3089\u500b\u4eba\u3067\u3082\u4f7f\u3044\u3084\u3059\u3044\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u6642\u306a\u3069\u306e\u7d14\u7c8b\u306b\u30e1\u30fc\u30eb\u3092\u9001\u308b\u3060\u3051\u306e\u5834\u5408\u306f\u3053\u308c\u3067\u5341\u5206\u3001\u305f\u3060\u9001\u4fe1\u30ea\u30b9\u30c8\u306a\u3069\u306e\u9867\u5ba2\u7ba1\u7406\u3061\u3063\u304f\u306a\u3053\u3068\u307e\u3067\u6c42\u3081\u308b\u3068\u8f9b\u3044\u3002\n\u30d6\u30ec\u30a4\u30f3\u30e1\u30fc\u30eb\n\u56fd\u5185\u3067\u306f\u304b\u306a\u308a\u5b9f\u7e3e\u304c\u3042\u308a\u305d\u3046\u3002\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u5bfe\u3057\u3066\u30ea\u30b9\u30c8\u5316\u3057\u305f\u308a\u4e88\u7d04\u9001\u4fe1\u306a\u3069\u884c\u3046\u4e8b\u304c\u53ef\u80fd\u306a\u306e\u3067\u3001\u30e1\u30eb\u30de\u30ac\u7cfb\u306e\u30b5\u30fc\u30d3\u30b9\u3084\u308b\u5834\u5408\u306f\u3053\u308c\u304c\u826f\u3044\u304b\u3082\u3002\n\u305f\u3060\u4ed6\u306e\u30e1\u30fc\u30eb\u30b5\u30fc\u30d3\u30b9\u3068\u6bd4\u3079\u3066\u9001\u4fe1\u6570\u3067\u306f\u306a\u304f\u3001\u9001\u4fe1\u5148\u3068\u3057\u3066\u767b\u9332\u3057\u3066\u3044\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u6570\u306b\u3088\u3063\u3066\u5909\u308f\u3063\u3066\u304d\u3066\u5024\u6bb5\u306f\u6c7a\u3057\u3066\u5b89\u304f\u306a\u3044\u3002\nMandril\nAPI\u304c\u5145\u5b9f\u3057\u3066\u3044\u308b...\u3089\u3057\u3044\u3002\u5024\u6bb5\u3082SES\u3068\u5f35\u308b\u304f\u3089\u3044\u5b89\u3044\u3002\n\n\u4e16\u306e\u4e2d\u4fbf\u5229\u306a\u3082\u306e\u3067\u81ea\u5206\u3067\u30b5\u30fc\u30d0\u3092\u7acb\u3066\u308b\u3053\u3068\u3082\u6700\u8fd1\u3067\u306f\u7121\u304f\u306a\u3063\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u958b\u767a\u306b\u96c6\u4e2d\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u305f\u3060\u3001\u3069\u3093\u306a\u306b\u4fbf\u5229\u306b\u306a\u3063\u3066\u3082\u4f7f\u3046\u305f\u3081\u306b\u306f\u8a2d\u5b9a\u304c\u5fc5\u305a\u5fc5\u8981\u306b\u306a\u308b\u308f\u3051\u3067\u3001\u77e5\u8b58\u304c\u306a\u304f\u3066\u306f\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u540d\u524d\u3084\u5185\u5bb9\u3092\u3069\u3093\u306a\u3075\u3046\u306b\u8a2d\u5b9a\u3057\u305f\u3089\u826f\u3044\u304b\u3042\u305f\u308a\u3092\u3064\u3051\u308b\u4e8b\u3082\u307e\u307e\u306a\u308a\u307e\u305b\u3093\u3002\n\u72ec\u65ad\u3068\u504f\u898b\u3067\u3059\u304cweb\u7cfb\u30a8\u30f3\u30b8\u30cb\u30a2\u306b\u3082\u6df1\u3044\u95a2\u308f\u308a\u306e\u3042\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\uff12\u3064\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u3001\u30b5\u30fc\u30d0\u69cb\u7bc9\u306e\u624b\u9806\u3092\u66f8\u304d\u7559\u3081\u305f\u306e\u3067\u3001\u51ac\u4f11\u307f\u306e\u4f59\u8208\u306b\u3067\u3082\u3069\u3046\u305e\u3002\n\n# DNS\n\n## DNS\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\u3059\u308b\nDNS\u30b5\u30fc\u30d0\u3092\u4f5c\u308b\u306e\u306bAWS\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u5916\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u305f\u3081\u3001\u540d\u524d\u89e3\u6c7a\u306b\u5229\u7528\u3055\u308c\u308b53\u756a\u30dd\u30fc\u30c8\u306eTCP/UDP\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u6642\u306eSecurityGroup\u306b53\u756a\u30dd\u30fc\u30c8\u306eTCP/UDP\u3092\u4ed8\u4e0e\u3059\u308c\u3070\u5927\u4e08\u592b\u3067\u3059\u3002\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u30d6\u30e9\u30a6\u30b6\u3067www.yahoo.co.jp\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068google.co.jp\u306b\u30a2\u30af\u30bb\u30b9\u3055\u308c\u308b\u3088\u3046\u306bDNS\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u305f\u3060\u3057chroot\u306a\u3069\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5bfe\u7b56\u306f\u884c\u3063\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u3053\u306e\u8a2d\u5b9a\u306e\u307e\u307e\u904b\u7528\u3059\u308b\u306e\u306f\u3084\u3081\u305f\u65b9\u304c\u826f\u3044\u3067\u3059\u3002\n\n## \u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u30b5\u30a4\u30c8\n\n[DNS\u30b5\u30fc\u30d0\u30fc\u69cb\u7bc9(BIND)](http://centossrv.com/bind.shtml \"DNS\u30b5\u30fc\u30d0\u30fc\u69cb\u7bc9(BIND)\")\n\n[EC2\u4e0a\u3067\u5185\u90e8\u5411\u3051DNS\u3092\u69cb\u7bc9\u3057\u3066\u307f\u308b](http://qiita.com/mechamogera/items/574de60310fb19e088ca \"EC2\u4e0a\u3067\u5185\u90e8\u5411\u3051DNS\u3092\u69cb\u7bc9\u3057\u3066\u307f\u308b\")\n\n### \u5fc5\u8981\u306a\u7269\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n#### bind\nbind\u306fDNS\u30b5\u30fc\u30d0\u3068\u30ea\u30be\u30eb\u30d0\u306a\u3069\u306e\u5404\u7a2e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u5165\u3063\u3066\u307e\u3059\u3002\nDNS\u30b5\u30fc\u30d0\u306b\u306fIP\u30a2\u30c9\u30ec\u30b9\u3068\u30c9\u30e1\u30a4\u30f3\u306e\u30bb\u30c3\u30c8\u3092\u4fdd\u6301\u3057\u3066\u304a\u308a\u3001\u30ea\u30be\u30eb\u30d0\u304cDNS\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3044\u540d\u524d\u89e3\u6c7a\u3092\u884c\u3044\u307e\u3059\u3002\n\n```\n$ sudo yum -y install bind\n```\n\nbind\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\n```\n$ sudo cp /etc/named.conf{,.org}\n$ sudo vim /etc/named.conf\n```\n\n```config:/etc/named.conf\n//\n// named.conf\n//\n// Provided by Red Hat bind package to configure the ISC BIND named(8) DNS\n// server as a caching only nameserver (as a localhost DNS resolver only).\n//\n// See /usr/share/doc/bind*/sample/ for example named configuration files.\n//\n\noptions {\n        # \u81ea\u8eab\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304b\u3089\u5fdc\u7b54\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\n\t\t # listen on port\u306bEC2\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\u3092\u8ffd\u52a0\n        listen-on port 53 { 127.0.0.1; XXX.XXX.XXX.XXX;};\n        listen-on-v6 port 53 { ::1; };\n        directory       \"/var/named\";\n        dump-file       \"/var/named/data/cache_dump.db\";\n        statistics-file \"/var/named/data/named_stats.txt\";\n        memstatistics-file \"/var/named/data/named_mem_stats.txt\";\n        # \u5916\u304b\u3089\u306e\u8981\u6c42\u306b\u7b54\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081any\u306b\u5909\u66f4\n        allow-query     { any; };\n        recursion yes;\n\n        dnssec-enable yes;\n        dnssec-validation yes;\n        dnssec-lookaside auto;\n        # \u81ea\u5206\u3067\u306f\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u306a\u304b\u3063\u305f\u6642\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308bDNS\u30b5\u30fc\u30d0\u306eIP\u30a2\u30c9\u30ec\u30b9\n        # 8.8.8.8\u306fGoogle\u304c\u63d0\u4f9b\u3059\u308bDNS\n        forwarders {  8.8.8.8; 8.8.4.4; };\n        forward only;\n\n        /* Path to ISC DLV key */\n        bindkeys-file \"/etc/named.iscdlv.key\";\n\n        managed-keys-directory \"/var/named/dynamic\";\n};\n\nlogging {\n        channel default_debug {\n                file \"data/named.run\";\n                severity dynamic;\n        };\n};\n\nzone \".\" IN {\n        type hint;\n        file \"named.ca\";\n};\n\n# yahoo.co.jp\u306e\u554f\u3044\u5408\u308f\u305b\u3092master.yahoo.co.jp\u306e\u4e2d\u306b\u8a18\u8ff0\u3055\u308c\u305fIP\u3067\u8fd4\u5374\u3059\u308b\nzone \"yahoo.co.jp\" IN {\n  type master;\n  file \"master.yahoo.co.jp\";\n};\n\ninclude \"/etc/named.rfc1912.zones\";\ninclude \"/etc/named.root.key\";\n```\n\nyahoo.co.jp\u3078\u306e\u540d\u524d\u89e3\u6c7a\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\n\n```\n$ sudo vi /var/named/master.yahoo.co.jp\n```\n\n```config:/var/named/master.yahoo.co.jp\n$TTL 43200\nyahoo.co.jp.     IN      SOA    help.yahoo.co.jp. ns01.yahoo.co.jp. (\n                         1\n                         21600\n                         7200\n                         1209600\n                         43200)\n\nyahoo.co.jp.            NS      ns01.yahoo.co.jp.\nns01                    A       216.58.220.206 # google.co.jp\u306eIP\nwww                     A       216.58.220.206 # google.co.jp\u306eIP\n```\n\n\u8d77\u52d5\u3068\u81ea\u52d5\u8d77\u52d5\u3092\u6709\u52b9\u5316\n\n```\n$ sudo /etc/init.d/named start\n$ sudo chkconfig named on\n```\n\nDNS\u30ea\u30be\u30eb\u30d0\u306e\u5411\u304d\u5148\u3092\u81ea\u8eab\u306eDNS\u30b5\u30fc\u30d0\u306b\u5909\u66f4\u3059\u308b\n\n```\n$ sudo cp /etc/resolv.conf{,.org}\n$ sudo vi /etc/resolv.conf\n$ cat /etc/resolv.conf\n; generated by /sbin/dhclient-script\nsearch ap-northeast-1.compute.internal\nnameserver 127.0.0.1\n```\n\n```\n$ sudo vi /etc/sysconfig/network-scripts/ifcfg-eth0\n```\n\n```/etc/sysconfig/network-scripts/ifcfg-eth0\nDEVICE=eth0\nBOOTPROTO=dhcp\nONBOOT=yes\nTYPE=Ethernet\nUSERCTL=yes\n# DHCP\u3067IP\u3092\u53d6\u5f97\u6642\u306byes\u3060\u3068/etc/resolv.conf\u306e\u5024\u304c\u66f4\u65b0\u3055\u308c\u3066\u3057\u307e\u3046\nPEERDNS=no\nIPV6INIT=no\nPERSISTENT_DHCLIENT=yes\n```\n\n\u3053\u308c\u3067DNS\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\u306f\u7d42\u308f\u308a\u3067\u3001PC\u306eDNS\u306e\u5411\u304d\u5148\u3092\u4f5c\u6210\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306ePublicIP\u3092\u6307\u5b9a\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u306byahoo.co.jp\u3068\u5165\u529b\u3057\u307e\u3059\u3002\n\u3046\u307e\u304f\u884c\u3063\u3066\u3044\u308c\u3070google.co.jp\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n# SMTP POP3\nSMTP\u3068POP3\u306f\u30e1\u30fc\u30eb\u306e\u9001\u53d7\u4fe1\u306b\u4f7f\u308f\u308c\u308b\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\nSMTP\u306f\u9001\u4fe1\u3001POP3\u306f\u53d7\u4fe1\u3092\u62c5\u5f53\u3057\u3066\u3044\u307e\u3059\u3002\n\u4f7f\u7528\u3059\u308b\u30dd\u30fc\u30c8\u306fSMTP\u304c25\u756a POP3\u304c110\u756a\u3067\u3059\u3002\n\n## \u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\n\n### \u5fc5\u8981\u306a\u3082\u306e\n\n1. \u30b5\u30fc\u30d0\n\u30e1\u30fc\u30eb\u3092\u9001\u53d7\u4fe1\u3059\u308b\u306e\u306b\u5fc5\u8981\u3067\u3059\u3002\n\n2. \u30c9\u30e1\u30a4\u30f3\n\u53d7\u4fe1\u306e\u5fc5\u8981\u304c\u3042\u308b\u306a\u3089\u5fc5\u9808\u3067\u3059\u3002\n\n### \u30b5\u30fc\u30d0\u306e\u7528\u610f\n\u9001\u4fe1\u306b\u306fPostfix \u53d7\u4fe1\u306fDevecot\u3092\u4f7f\u3044\u307e\u3059\u3001\u4f8b\u3067\u306fAmazonLinux\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u4f5c\u6210\u3059\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eSecurityGroup\u306b\u306f25\u3068110\u306e\u30dd\u30fc\u30c8\u306e\u30a4\u30f3\u30d0\u30a6\u30f3\u30c9\u3092\u8a31\u53ef\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\nEC2\u304b\u3089\u30ed\u30fc\u30ab\u30eb\u306b\u5bfe\u3057\u3066\u306e\u30e1\u30fc\u30eb\u3067\u3082\u30dd\u30fc\u30c8\u304c\u7a7a\u3044\u3066\u306a\u3044\u3068\u9001\u53d7\u4fe1\u304c\u51fa\u6765\u307e\u305b\u3093\u3002\n\u81ea\u5b85\u30b5\u30fc\u30d0\u306a\u3089\u3070\u30eb\u30fc\u30bf\u306e\u8a2d\u5b9a\u308225\u3068110\u756a\u306e\u30dd\u30fc\u30c8\u3092\u5229\u7528\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\n#### Dovecot\n\n##### \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell:shell\nsudo yum -y install dovecot\nsudo service dovecot start # \u8d77\u52d5\n$ sudo chkconfig dovecot on # \u81ea\u52d5\u8d77\u52d5\u6709\u52b9\n```\n\n#### Postfix\n\n##### \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell:shell\n# \u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u8cea\u554f\u306b\u56de\u7b54\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\n# \u7528\u9014\u306b\u3064\u3044\u3066\u306f\u300c\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b5\u30a4\u30c8\u300d\u3001\u30b7\u30b9\u30c6\u30e0\u30e1\u30fc\u30eb\u540d\u306f\u300c\u4e86\u89e3\u300d\u3092\u9078\u629e\n$ sudo yum -y install postfix mailx\n$ sudo service postfix start # \u8d77\u52d5\n$ sudo chkconfig postfix on # \u81ea\u52d5\u8d77\u52d5\u6709\u52b9\n\n# postfix\u3068\u540c\u3058\u304fPOP3\u3092\u63d0\u4f9b\u3059\u308bsendmail\u304b\u3089postfix\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u306b\u3059\u308b\n$ sudo /etc/rc.d/init.d/sendmail stop # \u505c\u6b62\n$ sudo chkconfig sendmail off # \u81ea\u52d5\u8d77\u52d5\u3092\u7121\u52b9\n$ sudo alternatives --config mta # alternatives\u30b3\u30de\u30f3\u30c9\u3067mta\u3092postfix\u306b\u5909\u66f4\u3059\u308b 2\u3092\u5165\u529b\u3057\u3066\u30a8\u30f3\u30bf\u30fc\n2 \u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u3042\u308a 'mta' \u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\n  \u9078\u629e       \u30b3\u30de\u30f3\u30c9\n-----------------------------------------------\n*  1           /usr/sbin/sendmail.sendmail\n + 2           /usr/sbin/sendmail.postfix\n```\n\n##### postfix\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u66f8\u304d\u63db\u3048\u308b\n\n```config:/etc/postfix/main.cf\n# \u30e1\u30fc\u30eb\u3092\u9001\u308b\u6642\u306e@\u4ee5\u964d\u306e\u6587\u5b57\u5217\nmyhostname = mail.example.com\u306a\u3069\n\n# \u30c9\u30e1\u30a4\u30f3\u540d\nmydomain = example.com\n\n# \u30b3\u30e1\u30f3\u30c8\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067#\u3092\u5916\u3059\nmyorigin = $mydomain\n\n# localhost\u3060\u3068\u30ed\u30fc\u30ab\u30eb\u5185\u304b\u3089\u306e\u30e1\u30fc\u30eb\u306e\u53d7\u4fe1\u306e\u307f\u53ef\u80fd\u306a\u306e\u3067\u5168\u3066\u306e\u30e1\u30fc\u30eb\u3092\u53d7\u4fe1\u53ef\u80fd\u306b\u3059\u308b\ninet_interfaces = all\n\n# ipv6\u3092\u8a31\u53ef\u3059\u308b\u3068\u74b0\u5883\u306b\u3088\u3063\u3066\u306f\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3089\u3057\u3044\ninet_protocols = ipv4\n\n# $mydomain\u3092\u8ffd\u52a0\u3059\u308b\n# mta\u304c@\u4ee5\u964d\u306e\u30c9\u30e1\u30a4\u30f3\u3092mydestination\u306e\u5024\u3068\u6bd4\u8f03\u3057\u3066\u81ea\u5206\u304c\u53d7\u4fe1\u3059\u308b\u3079\u304d\u304b\u5224\u5b9a\u306b\u4f7f\u3046\u305f\u3081\u3001\n# \u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3068\u53d7\u4fe1\u51fa\u6765\u306a\u3044\nmydestination = $myhostname, localhost.$mydomain, localhost, $mydomain\n\nhome_mailbox = Maildir/ # \u30b3\u30e1\u30f3\u30c8\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067#\u3092\u5916\u3059\n```\n\n#####\n\n```shell:shell\n# test@mail.example.com\u5b9b\u306f /home/test/Maildir/new\u4ee5\u4e0b\u306b\u4fdd\u5b58\u3055\u308c\u308b\n\n# \u30e6\u30fc\u30b6\u4f5c\u6210\u6642\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\u3092\u8a2d\u5b9a\n$ sudo mkdir -p /etc/skel/Maildir/{new,cur,tmp}\n$ sudo chmod -R 700 /etc/skel/Maildir/\n$ sudo useradd test\n$ sudo passwd test\n$ su - test\n```\n\n\n#### \u5b9f\u884c\n```shell:shell\n# \u9001\u308c\u305f\u304b\u3069\u3046\u304b /var/log/mail.log \u3068 /var/log/mail.err\u3092tail\u3057\u3066\u304a\u304f\u3068\u308f\u304b\u308a\u3084\u3059\u3044\n# \u3055\u304d\u307b\u3069\u4f5c\u6210\u3057\u305fdovcot\u3067\u9001\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\necho \"Hello\" | mail ec2-user@localhost\n```\n\n```\u5b9f\u884c\u7d50\u679c\n# \u78ba\u8a8d Hello\u3068\u3044\u3046\u5185\u5bb9\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308c\u3070\u6210\u529f\nsudo cat /var/mail/ec2-user\n\nFrom ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal  Sun Nov 29 18:38:38 2015\nReturn-Path: <ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal>\nReceived: from ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal (localhost [127.0.0.1])\n\tby ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal (8.14.4/8.14.4) with ESMTP id tATIccSd031046\n\tfor <ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal>; Sun, 29 Nov 2015 18:38:38 GMT\nReceived: (from ec2-user@localhost)\n\tby ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal (8.14.4/8.14.4/Submit) id tATIccjD031045\n\tfor ec2-user@localhost; Sun, 29 Nov 2015 18:38:38 GMT\nFrom: EC2 Default User <ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal>\nMessage-Id: <201511291838.tATIccjD031045@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal>\nDate: Sun, 29 Nov 2015 18:38:38 +0000\nTo: ec2-user@ip-XXX-XXX-XXX-XXX.ap-northeast-1.compute.internal\nUser-Agent: Heirloom mailx 12.4 7/29/08\nMIME-Version: 1.0\nContent-Type: text/plain; charset=us-ascii\nContent-Transfer-Encoding: 7bit\n\nHello\n\n```\n\n\u307b\u3044\u3001\u30ed\u30fc\u30ab\u30eb\u304b\u3089\u306e\u9001\u53d7\u4fe1\u306f\u5272\u308a\u3068\u3059\u3093\u306a\u308a\u51fa\u6765\u307e\u3057\u305f\u3002\n\n##### DNS\u306e\u8a2d\u5b9a\u3092\u884c\u3046\n\u5916\u90e8\u304b\u3089\u30e1\u30fc\u30eb\u3092\u53d7\u4fe1\u3059\u308b\u305f\u3081\u306b\u306f\u3001@\u4ee5\u964d\u306e\u30c9\u30e1\u30a4\u30f3\u304b\u3089\u4eca\u4f5c\u6210\u3057\u305f\u30b5\u30fc\u30d0\u306eIP\u304c\u5f15\u3051\u308b\u3088\u3046\u306b\u306a\u3089\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\u306a\u306e\u3067\u3001\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306bMX\u30ec\u30b3\u30fc\u30c9\u3068A\u30ec\u30b3\u30fc\u30c9\u3092\u767b\u9332\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u304a\u540d\u524d.com\u3067\u3042\u308c\u3070\u8a2d\u5b9a\u3059\u308b\u4e8b\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u3042\u308b\u3044\u306f\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u3092AWS\u306eRoute53\u306b\u5909\u66f4\u3057\u3001\u767b\u9332\u3057\u307e\u3059\u3002\n\n1. A\u30ec\u30b3\u30fc\u30c9\nA\u30ec\u30b3\u30fc\u30c9\u306f\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u5fdc\u3059\u308bIP\u30a2\u30c9\u30ec\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\u30ec\u30b3\u30fc\u30c9\n\u305d\u306e\u4ed6\u306b\u306fCNAME\u30ec\u30b3\u30fc\u30c9\u306a\u3069\u304c\u6709\u308a\u3001CNAME\u30ec\u30b3\u30fc\u30c9\u306f\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u3057\u3066\u5225\u306e\u30c9\u30e1\u30a4\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\n\n2. MX\u30ec\u30b3\u30fc\u30c9\n\u30e1\u30fc\u30eb\u306e\u5b9b\u5148\u3092A\u30ec\u30b3\u30fc\u30c9\u3067\u6307\u5b9a\u3057\u305f\u30c9\u30e1\u30a4\u30f3\u540d\u3092MX\u30ec\u30b3\u30fc\u30c9\u306eVALUE\u306b\u8a18\u8ff0\u3059\u308b\u3002\n\n\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u308b\u306b\u306f\u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u3057\u3070\u3089\u304f\u3057\u305f\u3089dig\u30b3\u30de\u30f3\u30c9(windows\u3067\u3042\u308c\u3070nslookup)\u3092\u4f7f\u3063\u3066\u8a2d\u5b9a\u304c\u6ce2\u53ca\u3055\u308c\u305f\u304b\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\n```\n# ANSWER SECTION\u306b\u5148\u307b\u3069\u306e\u8a2d\u5b9a\u304c\u51fa\u3066\u3044\u308c\u3070OK\n# MX\u30ec\u30b3\u30fc\u30c9\u304c\u6ce2\u53ca\u3055\u308c\u305f\u304b\u78ba\u8a8d\u3059\u308b\u306e\u306f dig mail.example.com mx \u3067\u78ba\u8a8d\u51fa\u6765\u308b\n$ dig mail.example.com\n\n; <<>> DiG 9.8.3-P1 <<>> mail.example.com\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 26357\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 4, ADDITIONAL: 6\n\n;; QUESTION SECTION:\n;mail.example.com.\t\t\tIN\tA\n\n;; ANSWER SECTION:\nmail.example.com.\t\t3600\tIN\tA\tXXX.XXX.XXX.XXX\n\n;; AUTHORITY SECTION:\nexample.com.\t\t86265\tIN\tNS\t03.dnsv.jp.\nexample.com.\t\t86265\tIN\tNS\t02.dnsv.jp.\nexample.com.\t\t86265\tIN\tNS\t04.dnsv.jp.\nexample.com.\t\t86265\tIN\tNS\t01.dnsv.jp.\n\n;; ADDITIONAL SECTION:\n01.dnsv.jp.\t\t19035\tIN\tA\tXXX.XXX.XXX.XXX\n02.dnsv.jp.\t\t15489\tIN\tA\tXXX.XXX.XXX.XXX\n03.dnsv.jp.\t\t15390\tIN\tA\tXXX.XXX.XXX.XXX\n03.dnsv.jp.\t\t12191\tIN\tAAAA\t2400:8500:3000::53\n04.dnsv.jp.\t\t13134\tIN\tA\tXXX.XXX.XXX.XXX\n04.dnsv.jp.\t\t48160\tIN\tAAAA\t2400:8500:3fff::53\n\n;; Query time: 36 msec\n;; SERVER: 192.168.11.1#53(192.168.11.1)\n;; WHEN: Sat Dec  5 12:31:33 2015\n;; MSG SIZE  rcvd: 243\n\n```\n\n##### \u9001\u53d7\u4fe1\u3092\u3057\u3066\u307f\u308b\n\n\u307e\u305a\u306f\u53d7\u4fe1\u3092\u3057\u3066\u307f\u308b\u306e\u3067\u3001Gmail\u306a\u3069\u306e\u30e1\u30fc\u30e9\u304b\u3089test@mail.example.com\u306b\u5411\u3051\u3066\u30e1\u30fc\u30eb\u3092\u9001\u3063\u3066\u307f\u308b\u3002\n\u3059\u308b\u3068test\u30e6\u30fc\u30b6\u306eMaildir/new\u306b\u65b0\u898f\u30e1\u30fc\u30eb\u304c\u5c4a\u3044\u3066\u3044\u308b\u306f\u305a...!\n\n\u540c\u3058\u3088\u3046\u306bmail\u30b3\u30de\u30f3\u30c9\u3067\u5916\u90e8\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u3057\u3066\u3082\u9001\u308b\u4e8b\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n```shell:shell\necho \"\u9001\u4fe1\u30c6\u30b9\u30c8\" | mail \"example@gmail.com\"\n```\n\n## \u5916\u90e8\u30b5\u30fc\u30d3\u30b9\n\n\u3053\u308c\u307e\u3067\u306f\u81ea\u8eab\u3067\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u3092\u8aac\u660e\u3057\u307e\u3057\u305f\u304c\u3001\u4ee5\u4e0b\u306e\u30b5\u30fc\u30d3\u30b9\u306f\u3053\u308c\u307e\u3067\u306e\u82e6\u52b4\u3092\u4ee3\u7406\u3067\u884c\u3063\u3066\u304f\u308c\u308b\u7269\u3067\u3059\u3002\n\u81ea\u5206\u3067\u4f5c\u308b\u6a5f\u4f1a\u304c\u3042\u308b\u3068\u304d\u306f\u672c\u5f53\u306b\u81ea\u5206\u3067\u4f5c\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u304b\u5224\u65ad\u3057\u3001\u305d\u306e\u4e2d\u3067\u3082\u30b5\u30fc\u30d3\u30b9\u3054\u3068\u306b\u7279\u8272\u304c\u7570\u306a\u308b\u306e\u3067\u614e\u91cd\u306b\u9078\u629e\u3059\u308b\u3068\u5e78\u305b\u306b\u306a\u308c\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n1. SES\nAWS\u304c\u63d0\u4f9b\u3059\u308b\u30e1\u30fc\u30eb\u30b5\u30fc\u30d3\u30b9 \u5b89\u3044\u304b\u3089\u500b\u4eba\u3067\u3082\u4f7f\u3044\u3084\u3059\u3044\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u6642\u306a\u3069\u306e\u7d14\u7c8b\u306b\u30e1\u30fc\u30eb\u3092\u9001\u308b\u3060\u3051\u306e\u5834\u5408\u306f\u3053\u308c\u3067\u5341\u5206\u3001\u305f\u3060\u9001\u4fe1\u30ea\u30b9\u30c8\u306a\u3069\u306e\u9867\u5ba2\u7ba1\u7406\u3061\u3063\u304f\u306a\u3053\u3068\u307e\u3067\u6c42\u3081\u308b\u3068\u8f9b\u3044\u3002\n\n2. \u30d6\u30ec\u30a4\u30f3\u30e1\u30fc\u30eb\n\u56fd\u5185\u3067\u306f\u304b\u306a\u308a\u5b9f\u7e3e\u304c\u3042\u308a\u305d\u3046\u3002\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u5bfe\u3057\u3066\u30ea\u30b9\u30c8\u5316\u3057\u305f\u308a\u4e88\u7d04\u9001\u4fe1\u306a\u3069\u884c\u3046\u4e8b\u304c\u53ef\u80fd\u306a\u306e\u3067\u3001\u30e1\u30eb\u30de\u30ac\u7cfb\u306e\u30b5\u30fc\u30d3\u30b9\u3084\u308b\u5834\u5408\u306f\u3053\u308c\u304c\u826f\u3044\u304b\u3082\u3002\n\u305f\u3060\u4ed6\u306e\u30e1\u30fc\u30eb\u30b5\u30fc\u30d3\u30b9\u3068\u6bd4\u3079\u3066\u9001\u4fe1\u6570\u3067\u306f\u306a\u304f\u3001\u9001\u4fe1\u5148\u3068\u3057\u3066\u767b\u9332\u3057\u3066\u3044\u308b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e\u6570\u306b\u3088\u3063\u3066\u5909\u308f\u3063\u3066\u304d\u3066\u5024\u6bb5\u306f\u6c7a\u3057\u3066\u5b89\u304f\u306a\u3044\u3002\n\n3. Mandril\nAPI\u304c\u5145\u5b9f\u3057\u3066\u3044\u308b...\u3089\u3057\u3044\u3002\u5024\u6bb5\u3082SES\u3068\u5f35\u308b\u304f\u3089\u3044\u5b89\u3044\u3002\n", "tags": ["bind", "pop3", "SMTP"]}