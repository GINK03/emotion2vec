{"tags": ["HTTPS", "SSL", "TLS"], "context": "\u3053\u306e\u8a18\u4e8b\u306fACCESS Advent Calendar 2016\u306e14\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u6628\u5e74\u306b\u5f15\u304d\u7d9a\u304dID\u6280\u8853\u30fb\u6697\u53f7\u6280\u8853\u3092\u4e2d\u5fc3\u306b\u3044\u308d\u3044\u308d\u3084\u3063\u3066\u3044\u305f\u306e\u3067\u4eca\u5e74\u306e\u30cd\u30bf\u3082\u4f3c\u305f\u3088\u3046\u306a\u611f\u3058\u3067\u3001\u73fe\u5728\u6700\u7d42\u627f\u8a8d\u306b\u5411\u3051\u3066\u8abf\u6574\u304c\u9032\u307f\u3064\u3064\u3042\u308bTLS 1.3\u306e\u8a71\u3092\u3057\u307e\u3059\u3002\n\n\nSSL/TLS\u3068\u306f\n\n\u8a8d\u8a3c\n\u6697\u53f7\u5316\n\u6539\u3056\u3093\u9632\u6b62\n\n\u306e3\u70b9\u3092\u63d0\u4f9b\u3059\u308b\u30bb\u30ad\u30e5\u30a2\u901a\u4fe1\u306e\u305f\u3081\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\u73fe\u5728\u4e00\u822c\u7684\u306b\u4f7f\u308f\u308c\u3066\u3044\u308b\u306e\u306f Transport Layer Security(TLS) \u3067\u3059\u304c\u3001\u904e\u53bb\u306b\u4f7f\u308f\u308c\u3066\u3044\u305f Secure Socket Layer(SSL) \u3068\u3044\u3046\u540d\u79f0\u304c\u5e83\u304f\u6d78\u900f\u3057\u3066\u3044\u308b\u306e\u3067\u307b\u307c\u540c\u3058\u610f\u5473\u3067\u4f7f\u308f\u308c\u307e\u3059\u3002 HTTPS \u3068\u3044\u3046\u306e\u306fHTTP over SSL\u3082\u3057\u304f\u306fHTTP Secure\u306e\u7565\u3067\u3001TLS\u3092\u4f7f\u3063\u3066\u30bb\u30ad\u30e5\u30a2\u306bHTTP\u901a\u4fe1\u3092\u884c\u3048\u308b\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\nSSL/TLS\u304c\u73fe\u4ee3\u306e\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30d3\u30b8\u30cd\u30b9\u306b\u304a\u3044\u3066\u4e0d\u53ef\u6b20\u3068\u3055\u308c\u308b\u306e\u306b\u306f\u3001\u5546\u53d6\u5f15\u306e\u5b89\u5168\u6027\u3084\u5b8c\u5168\u6027\u3092\u78ba\u4fdd\u3059\u308b\u306e\u306b\u3053\u306e\u6280\u8853\u304c\u4e0d\u53ef\u6b20\u3060\u304b\u3089\u3067\u3059\u3002\u4f8b\u3048\u3070\u3001\u9280\u884c\u3068\u30aa\u30f3\u30e9\u30a4\u30f3\u53d6\u5f15\u3092\u3059\u308b\u3068\u3057\u3066\u3001SSL/TLS\u304c\u306a\u3044\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3059\uff1a\n\n\u8a8d\u8a3c: \u6697\u8a3c\u756a\u53f7\u3092\u9001\u4fe1\u3059\u308b\u76f8\u624b\u304c\u672c\u5f53\u306b\u81ea\u5206\u304c\u53d6\u5f15\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u9280\u884c\u304b\u3001\u306a\u308a\u3059\u307e\u3057\u306e\u7b2c\u4e09\u8005\u304b\u78ba\u8a3c\u3092\u6301\u3064\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u6697\u53f7\u5316: \u305f\u3068\u3048\u76f8\u624b\u304c\u672c\u7269\u3067\u3042\u308b\u3068\u308f\u304b\u3063\u3066\u3082\u3001\u901a\u4fe1\u7d4c\u8def\u306e\u4e2d\u8eab\u304c\u8aad\u3081\u308c\u3070\u60aa\u610f\u306e\u7b2c\u4e09\u8005\u304c\u6697\u8a3c\u756a\u53f7\u3092\u596a\u53d6\u3067\u304d\u307e\u3059\u3002\n\u6539\u3056\u3093\u9632\u6b62: \u4eee\u306b\u4e0a\u8a182\u3064\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3082\u3001\u901a\u4fe1\u306e\u4e2d\u8eab\u3092\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308c\u3070\u632f\u8fbc\u5148/\u632f\u8fbc\u91d1\u984d\u3092\u52dd\u624b\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u4ee5\u4e0a\u306b\u52a0\u3048\u3066\u3001\u73fe\u4ee3\u3067\u306f\u5546\u53d6\u5f15\u4ee5\u5916\u306e\u7528\u9014\u3067\u3082SSL/TLS\u304c\u6c42\u3081\u3089\u308c\u3066\u3044\u308b\uff08\uff1d \u5e38\u6642HTTPS\u5316 \uff09\u306e\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u80cc\u666f\u304c\u3042\u308a\u307e\u3059\uff1a\n\n\u901a\u4fe1\u306e\u79d8\u5bc6\u306f\u3082\u306f\u3084\u6240\u4e0e\u306e\u3082\u306e\u3067\u306f\u306a\u3044\uff01\n\n\n\u691c\u7d22\u5c65\u6b74\u30fb\u95b2\u89a7\u5c65\u6b74\u304b\u3089\u884c\u52d5\u306e\u7279\u5fb4/\u4e3b\u7fa9\u601d\u60f3\u306a\u3069\u304c\u308f\u304b\u308b\n\n\n\u500b\u4eba\u7279\u5b9a\u304c\u3067\u304d\u308b\n\n\nNSA\u306b\u3088\u308b\u5927\u898f\u6a21\u76d7\u8074\u304c\u767a\u899a\n\n\n\u6697\u53f7\u5316\u6e08\u307f\u3060\u308d\u3046\u3068\u95a2\u4fc2\u306a\u3044\u3001\u56fd\u5bb6\u4e88\u7b97\u3067\u6697\u53f7\u9375\u306e\u89e3\u6790\u3084\u30d1\u30b9\u30ef\u30fc\u30c9\u30af\u30e9\u30c3\u30af\u3092\u3084\u3063\u3066\u3044\u308b\uff01\n\n\n\n\nHTTP/2\u306a\u3069\u306e\u65b0\u3057\u3044\u6280\u8853\u306fHTTPS\u901a\u4fe1\u304c\u5fc5\u9808\n\n\nTLS 1.3\u3068\u306f\nTLS 1.3\u306f\u3001\u73fe\u5728\u4ed5\u69d8\u7b56\u5b9a\u304c\u9032\u884c\u4e2d\u306eTLS\u306e\u6700\u65b0\u7248\u3067\u3001\n\nTLS 1.2\u4ee5\u524d\u306e\u6280\u8853\u7684\u8ca0\u50b5\u306e\u89e3\u6d88\u306b\u3088\u308b\u8106\u5f31\u6027\u5bfe\u7b56\nForward Secrecy\u306e\u5c0e\u5165\n\n\u3092\u76ee\u7684\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\nForward Secrecy\u3068\u306f\nForward Secrecy(\u6587\u732e\u306b\u3088\u3063\u3066\u306f\"Perfect Forward Secrecy\"\u3068\u8a18\u8ff0\u3055\u308c\u308b\u3053\u3068\u3082\u3042\u308b)\u3068\u306f\u3001\u30bb\u30ad\u30e5\u30a2\u901a\u4fe1\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u6027\u8cea\u3067\u3001 \u9577\u671f\u9375(long-term key)\u306e\u66b4\u9732\u306b\u3088\u3063\u3066\u904e\u53bb\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u30ad\u30fc\u306e\u5b89\u5168\u6027\u304c\u5931\u308f\u308c\u306a\u3044 \u3053\u3068\u3092\u793a\u3059\u6027\u8cea\u3067\u3059\u3002\u300c\u904e\u53bb\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u30ad\u30fc\u300d\u306e\u5b89\u5168\u6027\u306a\u306e\u306b\u300cForward\u300d\u3068\u3044\u3046\u8a9e\u304c\u4f7f\u308f\u308c\u308b\u306e\u306f\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u3042\u3068 \u5c06\u6765\u306b\u308f\u305f\u3063\u3066 \u79d8\u5bc6\u9375\u306e\u66b4\u9732\u306b\u8010\u3048\u308b\u3001\u3068\u3044\u3046\u6027\u8cea\u3060\u304b\u3089\u3067\u3059\u3002\n\nRSA\u9375\u4ea4\u63db\u306fFS\u3067\u306a\u3044\nTLS 1.2\u4ee5\u524d\u306b\u4f7f\u308f\u308c\u3066\u3044\u305f RSA\u9375\u4ea4\u63db \u306f\u3053\u306e\u6027\u8cea\u3092\u6e80\u305f\u3057\u307e\u305b\u3093\u3002RSA\u9375\u4ea4\u63db\u3067\u306f\n\n\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u304b\u3089\u516c\u958b\u9375\u3092\u53d6\u308a\u51fa\u3057\n\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u3066\u516c\u958b\u9375\u3067\u6697\u53f7\u5316\n\u30b5\u30fc\u30d0\u306f\u8a3c\u660e\u66f8\u306b\u5bfe\u5fdc\u3059\u308b\u79d8\u5bc6\u9375\u3067\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u3092\u5fa9\u53f7\n\u7d50\u679c\u3068\u3057\u3066\u540c\u3058\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u304b\u3089\u30bb\u30c3\u30b7\u30e7\u30f3\u9375\u3092\u751f\u6210\n\n\u2026\u3068\u3044\u3046\u624b\u9806\u3092\u8e0f\u3093\u3067\u9375\u306e\u4ea4\u63db\u3092\u884c\u3044\u307e\u3059\u304c\u3001\u300c\u9577\u671f\u9375\u3067\u3042\u308b\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u306b\u5bfe\u5fdc\u3059\u308b\u79d8\u5bc6\u9375\u300d\u304c\u66b4\u9732\u3055\u308c\u3001\u300c\u6697\u53f7\u5316\u3055\u308c\u305f\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u300d\u306e\u901a\u4fe1\u304c\u508d\u53d7\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u904e\u53bb\u306e\u901a\u4fe1\u3067\u3042\u3063\u3066\u3082\u79d8\u5bc6\u9375\u3092\u3082\u3068\u306b\u30bb\u30c3\u30b7\u30e7\u30f3\u9375\u3092\u5165\u624b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u79d8\u5bc6\u6027\u3092\u7834\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nDiffie-Hellman\u9375\u4ea4\u63db\n\n\u6570\u5b66\u7684\u306a\u5b9a\u7fa9\np \u306f\u5024\u306e\u5927\u304d\u306a\u7d20\u6570\u3001g \u306f (Z/pZ)\u2217(\\mathbb{Z}/p\\mathbb{Z})* \u306e\u751f\u6210\u5143\uff08\u305d\u308c\u305e\u308c\u516c\u958b\u306e\u5024\uff09\u3068\u3057\u3001\u4e92\u3044\u306b 0\u2264a,b\u2264p\u221220 \\leq a, b \\leq p - 2\u3000\u3092\u6e80\u305f\u3059\u3088\u3046\u306b\u79d8\u5bc6\u306e\u5024\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\nA=gamodp,B=gbmodpA = g^{a} \\mod p, B = g^{b} \\mod p \u3092\u8a08\u7b97\u3057\u76f8\u624b\u306b\u6e21\u3057\u307e\u3059\u3002\nKA=Bamodp,KB=AbmodpK_A = B^a \\mod p, K_B = A^b \\mod p \u3068\u3059\u308b\u3068\u3001\nKAB=KBA=gabmodpK_{AB} = K_{BA} = g^{ab} \\mod p \u3088\u308a\u5171\u901a\u9375\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u4e00\u65b9\u3067\u3001 AA \u3068 BB \u304b\u3089 K=gabmodpK = g^{ab} \\mod p\u3092\u591a\u9805\u5f0f\u6642\u9593\u3067\u8a08\u7b97\u3059\u308b\u65b9\u6cd5\u306f\u73fe\u5728\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\uff08\u96e2\u6563\u5bfe\u6570\u554f\u984c\uff09\n\u6955\u5186\u66f2\u7dda\u3092\u4f7f\u3063\u305fDiffie-Hellman\u3067\u3042\u308bECDH\u306e\u4ed5\u7d44\u307f\u306f\u7701\u7565\u3057\u307e\u3059\u304c\u3001\u540c\u69d8\u306b\u6955\u5186\u66f2\u7dda\u4e0a\u306e\u96e2\u6563\u5bfe\u6570\u554f\u984c\u306e\u56f0\u96e3\u6027\u3092\u5229\u7528\u3057\u305f\u9375\u4ea4\u63db\u65b9\u6cd5\u3067\u3059\u3002\n\n\u308f\u304b\u308a\u3084\u3059\u3044DH\u9375\u4ea4\u63db\nDH\u9375\u4ea4\u63db\u306f\u4e00\u822c\u306b\u3088\u304f\u7d75\u306e\u5177\u3092\u6df7\u305c\u308b\u4f8b\u3067\u8aac\u660e\u3055\u308c\u307e\u3059\u3002\u6df7\u305c\u305f\u7d75\u306e\u5177\u304b\u3089\u6df7\u305c\u308b\u524d\u306e2\u8272\u3092\u5fa9\u5143\u3059\u308b\u306e\u304c\u56f0\u96e3\u3067\u3042\u308b\u3068\u3044\u3046\u6027\u8cea\u304c\u3001AA \u3068 BB \u304b\u3089 K=gabmodpK = g^{ab} \\mod p\u3092\u591a\u9805\u5f0f\u6642\u9593\u3067\u8a08\u7b97\u3059\u308b\u306e\u304c\u56f0\u96e3\u3067\u3042\u308b\u3068\u3044\u3046\u6027\u8cea\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n\n\nDH\u9375\u4ea4\u63db\u306f\u4f7f\u3044\u65b9\u306b\u3088\u3063\u3066\u306fFS\nDH\u9375\u4ea4\u63db\u306e\u3046\u3061\u3001\u7279\u306b\u30bb\u30c3\u30b7\u30e7\u30f3\u3054\u3068\u306b\u4e00\u6642\u7684\u306a(ephemeral)\u79d8\u5bc6\u306e\u5024(=A,BA, B)\u3092\u751f\u6210\u3059\u308b DHE, ECDHE \u306fForward Secrecy\u3092\u6301\u3061\u307e\u3059\u3002\nTLS\u3067\u306f\u4f7f\u7528\u3059\u308b\u6709\u9650\u7fa4(p\u3068g\uff09\u30fb\u6955\u5186\u66f2\u7dda\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001NamedGroup/NamedCurve\u3068\u3057\u3066 \u4ed5\u69d8\u306e\u4e0a\u3067\u6c7a\u3081\u3089\u308c\u3066\u3044\u308b\u516c\u958b\u306e\u5024 \u3067\u3059\u3002\u305d\u306e\u3046\u3048\u3067\u3001\u6bce\u56de\u7570\u306a\u308bA,BA, B\u306e\u5024\u3092\u7528\u3044\u3066\u30bb\u30c3\u30b7\u30e7\u30f3\u9375\u3092\u4f5c\u308b\u306e\u3067\u3001 \u9577\u671f\u9375\u3068\u306a\u308b\u5024\u304c\u5b58\u5728\u305b\u305a \u7d50\u679c\u3068\u3057\u3066\u5c06\u6765\u306b\u308f\u305f\u3063\u3066\u901a\u4fe1\u306e\u79d8\u5bc6\u304c\u4fdd\u305f\u308c\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\nDH\u9375\u4ea4\u63db\u306f\u4e2d\u9593\u8005\u653b\u6483\u306b\u5f31\u3044\n\u4e2d\u9593\u8005Eve\u304cA,BA,B\u306e\u5024\u3092\u53d7\u3051\u53d6\u308a\u3001a,ba,b\u3068\u540c\u69d8\u306e\u6027\u8cea\u3092\u6301\u3064c,dc,d\u3092\u751f\u6210\u3057\u3001\u4ee5\u4e0b\u306e\u5024\u3092\u76f8\u624b\u306b\u4ee3\u308f\u308a\u306b\u6e21\u3059\u3068\u3057\u307e\u3059:\nAE=gcmodpA_E = g^c \\mod p BE=gdmodpB_E = g^d \\mod p\n\u305d\u3046\u3059\u308b\u3068Alice\u3068Bob\u306f\nKAE=BaEmodpK_{AE} = B_E^a \\mod p KBE=AbEmodpK_{BE} = A_E^b \\mod p\n\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u3068\u304d\u3001Alice\u3068Eve\u3001Eve\u3068Bob\u306e\u9593\u306b\u5171\u901a\u9375\u306e\u7533\u3057\u5408\u308f\u305b\u304c\u6210\u7acb\u3057\u307e\u3059\uff08\u524d\u8005\u306fKAEK_{AE}\u3001\u5f8c\u8005\u306fKBEK_{BE}\uff09\u3002\n\u3053\u306e\u3088\u3046\u306b\u4e2d\u9593\u8005\u653b\u6483\u3092\u884c\u3046\u3053\u3068\u304c\u5bb9\u6613\u306a\u306e\u3067\u3001DH\u9375\u4ea4\u63db\u306f\u5358\u4f53\u3067\u306f\u7528\u3044\u3089\u308c\u305a\u3001TLS\u3067\u306f\u76f8\u624b\u306e\u8a8d\u8a3c\u3092\u884c\u3046\u305f\u3081\u306b \u4eca\u307e\u3067\u901a\u308a\u8a3c\u660e\u66f8\u3092\u7528\u3044\u307e\u3059\u3002\n\n\u305d\u3082\u305d\u3082\u4f55\u3067Forward Secrecy\uff1f\nForward Secrecy\u3092\u6301\u305f\u306a\u3044\u9375\u4ea4\u63db\u3092\u7528\u3044\u308b\u3068\u3001\u6697\u53f7\u5316\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u30b5\u30fc\u30d0\u30fc\u306b\u6b8b\u3063\u3066\u3044\u305f\u3089\u3044\u3064\u3067\u3082\u904e\u53bb\u306e\u3084\u308a\u3068\u308a\u304c\u5fa9\u53f7\u3055\u308c\u3066\u3057\u307e\u3046\u3068\u3044\u3046\u3053\u3068\u304c\u554f\u984c\u3068\u306a\u3063\u305f\u305f\u3081\u3067\u3059\u3002\u5177\u4f53\u7684\u306a\u4e8b\u4ef6\u3068\u3057\u3066\u306f\u3001Edward Snowden\u306e\u5185\u90e8\u544a\u767a\u4e8b\u4ef6\u306b\u95a2\u9023\u3057\u3066FBI\u304c\u30e1\u30fc\u30eb\u30b5\u30fc\u30d3\u30b9Lavabit\u306b\u5bfe\u3057\u3066\u79d8\u5bc6\u9375\u3092\u88c1\u5224\u6240\u547d\u4ee4\u3067\u8981\u6c42\u3057\u305f\u7d50\u679c\u79d8\u5bc6\u9375\u304c\u5f15\u304d\u6e21\u3055\u308c\u305d\u306e\u30b5\u30fc\u30d3\u30b9\u306f\u3084\u3080\u306a\u304f\u5ec3\u696d\u3001\u3068\u3044\u3046\u4e8b\u4ef6\u304c\u3042\u308a\u3001\u3053\u308c\u3092\u6a5f\u306bForward Secrecy\u306e\u5c0e\u5165\u306e\u6a5f\u904b\u304c\u9ad8\u307e\u308a\u307e\u3057\u305f\u3002\n\nTLS 1.3\u3067\u306e\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u306e\u5909\u66f4\nTLS 1.2\u3067\u306f2RTT(\u518d\u63a5\u7d9a\u306a\u30891.5RTT)\u304b\u304b\u3063\u3066\u3044\u305f\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u304c 0.5\u301c1RTT \u306b\u3001\u518d\u63a5\u7d9a\u306a\u3089\u5834\u5408\u306b\u3088\u3063\u3066\u306f 0RTT \u3067\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6539\u5584\u304c\u56f3\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\nTLS 1.2\u307e\u3067\u306e\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\nTLS 1.2\u307e\u3067\u306f\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u304c\u884c\u308f\u308c\u3066\u3044\u307e\u3057\u305f: \n\nHello\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u4ea4\u63db\u306b\u3088\u3063\u3066\u3001\u4f7f\u7528\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08\u9375\u4ea4\u63db\u3001\u6697\u53f7\u5316\uff09\u306b\u3064\u3044\u3066\u5408\u610f\u3059\u308b\u3002\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u306e\u4ea4\u63db\u3092\u884c\u3044\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u7d99\u7d9a\u3092\u5224\u5b9a\u3059\u308b\npremaster secret\u306e\u5408\u610f\u306e\u305f\u3081\u306e\u6697\u53f7\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u4ea4\u63db\u3092\u884c\u3046\n\u4e92\u3044\u3092\u8a8d\u8a3c\u3057\u5408\u3046\u305f\u3081\u306e\u6697\u53f7\u60c5\u5831\u306e\u4ea4\u63db\u3092\u884c\u3046\n\n\n\u8a8d\u8a3c\n\n\npremaster secret\u3068random value\u304b\u3089master secret\u3092\u751f\u6210\n\u30ec\u30b3\u30fc\u30c9\u30ec\u30a4\u30e4\u30fc\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4f9b\u7d66\u3059\u308b\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30fb\u30b5\u30fc\u30d0\u30fc\u3068\u3082\u306b\u3001\u4e92\u3044\u306b\u6b63\u3057\u3044\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u8a08\u7b97\u3067\u304d\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001\u540c\u6642\u306b\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u304c\u6539\u3056\u3093\u306a\u3057\u306b\u884c\u308f\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n\n\u6697\u53f7\u5316\u3001\u6539\u3056\u3093\u9632\u6b62\n\n\n\n\u5b9f\u969b\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u3084\u308a\u53d6\u308a\u306f\u4ee5\u4e0b\u306e\u56f3\u306e\u901a\u308a\u3067\u3059\uff1a\n\n\nTLS 1.3\u3067\u306e\u5909\u66f4\u70b9\nTLS 1.3\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3055\u308c\u3066\u3044\u307e\u3059\uff1a\n\nServer/Client KeyExchange \u306f ClientHello/ServerHello\u306eExtension\u306e\u4e2d\u306b\u79fb\u52d5\n\n\n1RTT\u76ee\u7d42\u308f\u3063\u3066\u3084\u3063\u3068Key\u3092\u9001\u3063\u3066\u305f\u306e\u3092\u6700\u521d\u304b\u3089\u9001\u3063\u3066\u3057\u307e\u3046\n\n\nChangeCipherSpec\u5ec3\u6b62\u3001\u9375\u4ea4\u63db\u76f4\u5f8c\u306b\u6697\u53f7\u5316\u958b\u59cb\n\n\n\u4eca\u307e\u3067\u306f\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u6697\u53f7\u5316\u306a\u3057\u300d\u306e\u30ec\u30b3\u30fc\u30c9\u5c64\u6697\u53f7\u5316\u306e\u5909\u66f4\u3092\u901a\u77e5\u3057\u3042\u3046\u307f\u305f\u3044\u306a\u3053\u3068\u306e\u305f\u3081\u306b\u4f7f\u308f\u308c\u3066\u3044\u305f\u304c\u2026\n\n\n\n\n\n\nTLS 1.2\u306eClientHello\nstruct {\n  ProtocolVersion client_version;\n  Random random;\n  SessionID session_id;\n  CipherSuite cipher_suites<2..2^16-2>;\n  CompressionMethod compression_methods<1..2^8-1>;\n  select(extensions_present){\n    case false:\n      struct {};\n    case true:\n      Extension extensions<0..2^16-1>;\n  };\n} ClientHello;\n\n\nTLS 1.3\u306eClientHello\nstruct {\n  ProtocolVersion legacy_version = 0x0303;\n  Random random;\n  opaque legacy_session_id<0..32>;\n  CipherSuite cipher_suites<2..2^16-2>;\n  opaque legacy_compression_methods<1..2^8-1>;\n  Extension extensions<0..2^16-1>;\n} ClientHello;\n\n\n\u4f55\u304c\u9055\u3046\uff1f\n\u4e92\u63db\u6027\u3092\u7dad\u6301\u3059\u308b\u305f\u3081\u306blegacy\u3068\u3057\u3066\u3044\u304f\u3064\u304b\u5024\u304c\u6b8b\u3063\u3066\u3044\u307e\u3059\u304c\u3001ClientHello\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6bd4\u8f03\u3059\u308b\u3068\u304b\u306a\u308a\u306e\u6a5f\u80fd\u304c\u524a\u3089\u308c\u3066\u3044\u307e\u3059:\n\n\u591a\u304f\u306e\u30b5\u30fc\u30d0\u30fc\u304cversion negotiation\u3092\u9069\u5207\u306b\u5b9f\u88c5\u3057\u306a\u3044\u306e\u3067\u30010x0303\u56fa\u5b9a(=TLS 1.2\u306e\u5024)\u3068\u3057\u3001extension\u306b\u79fb\u52d5\n\u518d\u63a5\u7d9a\u306e\u969b\u306bSessionID + Ticket\u306e\u4ee3\u308f\u308a\u306bPre-Shared Key(PSK)\u3092\u5229\u7528\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3057\u305f\u305f\u3081\u3001session_id\u5ec3\u6b62\n\nCompression\u3092\u5ec3\u6b62\u3002CRIME\u653b\u6483\u306a\u3069\u306e\u5bfe\u7b56\nTLS 1.3\u3067\u306f\u5fc5\u305aExtension\u304c\u5b58\u5728\nExtensions\u306e\u4e2d\u3067\u6697\u53f7\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u3084\u308a\u3068\u308a\n\n\n\u3069\u3046\u3084\u3063\u30660.5RTT\u3067\u6697\u53f7\u5316\uff1f\nTLS 1.2\u307e\u3067\u3068\u306e\u6c7a\u5b9a\u7684\u306a\u9055\u3044\u306f\u3001ServerHello\u304b\u3089\u5148\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3059\u3089\u6697\u53f7\u5316\u3055\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3053\u308c\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u4ed5\u7d44\u307f\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\uff1a\n\n\nClientHello\u306e\u6bb5\u968e\u3067PSK\u4f7f\u7528\uff08\u518d\u63a5\u7d9a\uff09\u304b(EC)DHE\u4f7f\u7528\uff08\u521d\u56de\u63a5\u7d9a\uff09\u304b\u3092\u6c7a\u5b9a\nDHE\u306e\u5834\u5408\n\n\nDHE\u306epublic value\u306fKeyShare\u306eNamedGroup\u306b\u542b\u307e\u308c\u308b\nClientHello, ServerHello\u306e\u305d\u308c\u305e\u308c\u306eKeyShare\u306e\u4e2d\u306bK=gxmodpK = g^x \\mod p \u304c\u542b\u307e\u308c\u308b\u3002\u30b5\u30fc\u30d0\u30fc\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u516c\u958b\u306e\u5024\u3092\u53d7\u3051\u53d6\u3063\u305f\u3089\u81ea\u5206\u306e\u79d8\u5bc6\u306e\u5024\u3092\u4f7f\u3063\u3066\u5171\u901a\u9375\u3092\u8a08\u7b97\u53ef\u80fd\n\n\n\n\n\u30ec\u30b3\u30fc\u30c9\u5c64\u6697\u53f7\u5316\u306e\u898b\u76f4\u3057\n\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u4ee5\u5916\u306b\u3082\u30ec\u30b3\u30fc\u30c9\u5c64\u306e\u6697\u53f7\u5316\u306b\u7528\u3044\u3089\u308c\u308b\u6697\u53f7\u65b9\u5f0f\u306b\u3082\u898b\u76f4\u3057\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\n\nCompression\u5ec3\u6b62\n\u3053\u3061\u3089\u306f\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u306e\u4e2d\u3067\u3082\u89e6\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u6b63\u3057\u3044\u5e73\u6587\u306e\u3068\u304d\u306b\u5727\u7e2e\u7387\u304c\u4e0a\u304c\u308b\u3068\u3044\u3046\u6027\u8cea\u3092\u7528\u3044\u305f\u30b5\u30a4\u30c9\u30c1\u30e3\u30cd\u30eb\u653b\u6483\u304c\u3044\u304f\u3064\u304b\uff08CRIME\u3001BREACH\u306a\u3069\uff09\u5b58\u5728\u3057\u3001\u3053\u308c\u3089\u306e\u653b\u6483\u3078\u306e\u5bfe\u7b56\u3068\u3057\u3066\u30ec\u30b3\u30fc\u30c9\u5c64\u306e\u5727\u7e2e\u304c\u884c\u308f\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\nCBC\u30e2\u30fc\u30c9\u5ec3\u6b62\u3001AEAD\u5fc5\u9808(AES-GCM, ChaCha20-Poly1305\u7b49)\n\u6697\u53f7\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u6697\u53f7\u5229\u7528\u30e2\u30fc\u30c9\u306b\u3064\u3044\u3066\u8a8d\u8a3c\u4ed8\u304d\u6697\u53f7(AEAD: \u4ed8\u52a0\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u30c7\u30fc\u30bf\u306e\u4fdd\u8b77\u3068\u5b8c\u5168\u6027\u306e\u78ba\u8a8d\u3092\u540c\u6642\u306b\u884c\u3046\u3082\u306e)\u306e\u307f\u306b\u9650\u5b9a\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3053\u306e\u5909\u66f4\u306f\u4eca\u307e\u3067\u5e83\u304f\u7528\u3044\u3089\u308c\u3066\u304d\u305fCBC\u30e2\u30fc\u30c9\u304c\u5ec3\u6b62\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u80cc\u666f\u306b\u306f\u3001CBC\u30e2\u30fc\u30c9\u3092\u7279\u306b\u72d9\u3063\u305f\u653b\u6483(BEAST\u653b\u6483\u3001Lucky Thirteen\u653b\u6483\u306a\u3069)\u304c\u983b\u767a\u3057\u305f\u3053\u3068\u304c\u80cc\u666f\u306b\u3042\u308a\u307e\u3059\u3002\n\n\n\u53c2\u8003\u8cc7\u6599\n\nThe Transport Layer Security(TLS) Protocol Version 1.3\nThe Transport Layer Security (TLS) Protocol Version 1.2\nTLS 1.3\u3068\u306f\nSSL/TLS & Perfect Forward Secrecy\nWeb over HTTPS\n\n\n\u660e\u65e5\u3082\u5f15\u304d\u7d9a\u304d\u79c1\u304c\u62c5\u5f53\u3067\u3001TLS\u306e\u8a71\u3092\u3057\u307e\u3059\u3002\u3057\u304b\u3057\u300c\u6700\u65b0\u306e\u300dTLS\u306e\u8a71\u3068\u306f\u8a00\u3063\u3066\u3044\u306a\u3044\u2026\uff01\n\u3053\u306e\u8a18\u4e8b\u306f[ACCESS Advent Calendar 2016](http://qiita.com/advent-calendar/2016/access)\u306e14\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n[\u6628\u5e74](http://qiita.com/sylph01/items/208ae313c03426feedc1)\u306b\u5f15\u304d\u7d9a\u304dID\u6280\u8853\u30fb\u6697\u53f7\u6280\u8853\u3092\u4e2d\u5fc3\u306b\u3044\u308d\u3044\u308d\u3084\u3063\u3066\u3044\u305f\u306e\u3067\u4eca\u5e74\u306e\u30cd\u30bf\u3082\u4f3c\u305f\u3088\u3046\u306a\u611f\u3058\u3067\u3001\u73fe\u5728\u6700\u7d42\u627f\u8a8d\u306b\u5411\u3051\u3066\u8abf\u6574\u304c\u9032\u307f\u3064\u3064\u3042\u308bTLS 1.3\u306e\u8a71\u3092\u3057\u307e\u3059\u3002\n\n----\n\n# SSL/TLS\u3068\u306f\n\n* \u8a8d\u8a3c\n* \u6697\u53f7\u5316\n* \u6539\u3056\u3093\u9632\u6b62\n\n\u306e3\u70b9\u3092\u63d0\u4f9b\u3059\u308b\u30bb\u30ad\u30e5\u30a2\u901a\u4fe1\u306e\u305f\u3081\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\u73fe\u5728\u4e00\u822c\u7684\u306b\u4f7f\u308f\u308c\u3066\u3044\u308b\u306e\u306f **Transport Layer Security(TLS)** \u3067\u3059\u304c\u3001\u904e\u53bb\u306b\u4f7f\u308f\u308c\u3066\u3044\u305f **Secure Socket Layer(SSL)** \u3068\u3044\u3046\u540d\u79f0\u304c\u5e83\u304f\u6d78\u900f\u3057\u3066\u3044\u308b\u306e\u3067\u307b\u307c\u540c\u3058\u610f\u5473\u3067\u4f7f\u308f\u308c\u307e\u3059\u3002 **HTTPS** \u3068\u3044\u3046\u306e\u306fHTTP over SSL\u3082\u3057\u304f\u306fHTTP Secure\u306e\u7565\u3067\u3001TLS\u3092\u4f7f\u3063\u3066\u30bb\u30ad\u30e5\u30a2\u306bHTTP\u901a\u4fe1\u3092\u884c\u3048\u308b\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\n\nSSL/TLS\u304c\u73fe\u4ee3\u306e\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30d3\u30b8\u30cd\u30b9\u306b\u304a\u3044\u3066\u4e0d\u53ef\u6b20\u3068\u3055\u308c\u308b\u306e\u306b\u306f\u3001\u5546\u53d6\u5f15\u306e\u5b89\u5168\u6027\u3084\u5b8c\u5168\u6027\u3092\u78ba\u4fdd\u3059\u308b\u306e\u306b\u3053\u306e\u6280\u8853\u304c\u4e0d\u53ef\u6b20\u3060\u304b\u3089\u3067\u3059\u3002\u4f8b\u3048\u3070\u3001\u9280\u884c\u3068\u30aa\u30f3\u30e9\u30a4\u30f3\u53d6\u5f15\u3092\u3059\u308b\u3068\u3057\u3066\u3001SSL/TLS\u304c\u306a\u3044\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3059\uff1a\n\n* \u8a8d\u8a3c: \u6697\u8a3c\u756a\u53f7\u3092\u9001\u4fe1\u3059\u308b\u76f8\u624b\u304c\u672c\u5f53\u306b\u81ea\u5206\u304c\u53d6\u5f15\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u9280\u884c\u304b\u3001\u306a\u308a\u3059\u307e\u3057\u306e\u7b2c\u4e09\u8005\u304b\u78ba\u8a3c\u3092\u6301\u3064\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n* \u6697\u53f7\u5316: \u305f\u3068\u3048\u76f8\u624b\u304c\u672c\u7269\u3067\u3042\u308b\u3068\u308f\u304b\u3063\u3066\u3082\u3001\u901a\u4fe1\u7d4c\u8def\u306e\u4e2d\u8eab\u304c\u8aad\u3081\u308c\u3070\u60aa\u610f\u306e\u7b2c\u4e09\u8005\u304c\u6697\u8a3c\u756a\u53f7\u3092\u596a\u53d6\u3067\u304d\u307e\u3059\u3002\n* \u6539\u3056\u3093\u9632\u6b62: \u4eee\u306b\u4e0a\u8a182\u3064\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3082\u3001\u901a\u4fe1\u306e\u4e2d\u8eab\u3092\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308c\u3070\u632f\u8fbc\u5148/\u632f\u8fbc\u91d1\u984d\u3092\u52dd\u624b\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u4ee5\u4e0a\u306b\u52a0\u3048\u3066\u3001\u73fe\u4ee3\u3067\u306f\u5546\u53d6\u5f15\u4ee5\u5916\u306e\u7528\u9014\u3067\u3082SSL/TLS\u304c\u6c42\u3081\u3089\u308c\u3066\u3044\u308b\uff08\uff1d **\u5e38\u6642HTTPS\u5316** \uff09\u306e\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u80cc\u666f\u304c\u3042\u308a\u307e\u3059\uff1a\n\n* \u901a\u4fe1\u306e\u79d8\u5bc6\u306f\u3082\u306f\u3084\u6240\u4e0e\u306e\u3082\u306e\u3067\u306f\u306a\u3044\uff01\n    * \u691c\u7d22\u5c65\u6b74\u30fb\u95b2\u89a7\u5c65\u6b74\u304b\u3089\u884c\u52d5\u306e\u7279\u5fb4/\u4e3b\u7fa9\u601d\u60f3\u306a\u3069\u304c\u308f\u304b\u308b\n        * \u500b\u4eba\u7279\u5b9a\u304c\u3067\u304d\u308b\n    * NSA\u306b\u3088\u308b\u5927\u898f\u6a21\u76d7\u8074\u304c\u767a\u899a\n        * \u6697\u53f7\u5316\u6e08\u307f\u3060\u308d\u3046\u3068\u95a2\u4fc2\u306a\u3044\u3001\u56fd\u5bb6\u4e88\u7b97\u3067\u6697\u53f7\u9375\u306e\u89e3\u6790\u3084\u30d1\u30b9\u30ef\u30fc\u30c9\u30af\u30e9\u30c3\u30af\u3092\u3084\u3063\u3066\u3044\u308b\uff01\n* HTTP/2\u306a\u3069\u306e\u65b0\u3057\u3044\u6280\u8853\u306fHTTPS\u901a\u4fe1\u304c\u5fc5\u9808\n\n# TLS 1.3\u3068\u306f\n\nTLS 1.3\u306f\u3001\u73fe\u5728\u4ed5\u69d8\u7b56\u5b9a\u304c\u9032\u884c\u4e2d\u306eTLS\u306e\u6700\u65b0\u7248\u3067\u3001\n\n* TLS 1.2\u4ee5\u524d\u306e\u6280\u8853\u7684\u8ca0\u50b5\u306e\u89e3\u6d88\u306b\u3088\u308b\u8106\u5f31\u6027\u5bfe\u7b56\n* Forward Secrecy\u306e\u5c0e\u5165\n\n\u3092\u76ee\u7684\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n# Forward Secrecy\u3068\u306f\n\nForward Secrecy(\u6587\u732e\u306b\u3088\u3063\u3066\u306f\"Perfect Forward Secrecy\"\u3068\u8a18\u8ff0\u3055\u308c\u308b\u3053\u3068\u3082\u3042\u308b)\u3068\u306f\u3001\u30bb\u30ad\u30e5\u30a2\u901a\u4fe1\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u6027\u8cea\u3067\u3001 **\u9577\u671f\u9375(long-term key)\u306e\u66b4\u9732\u306b\u3088\u3063\u3066\u904e\u53bb\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u30ad\u30fc\u306e\u5b89\u5168\u6027\u304c\u5931\u308f\u308c\u306a\u3044** \u3053\u3068\u3092\u793a\u3059\u6027\u8cea\u3067\u3059\u3002\u300c\u904e\u53bb\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u30ad\u30fc\u300d\u306e\u5b89\u5168\u6027\u306a\u306e\u306b\u300cForward\u300d\u3068\u3044\u3046\u8a9e\u304c\u4f7f\u308f\u308c\u308b\u306e\u306f\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u3063\u305f\u3042\u3068 **\u5c06\u6765\u306b\u308f\u305f\u3063\u3066** \u79d8\u5bc6\u9375\u306e\u66b4\u9732\u306b\u8010\u3048\u308b\u3001\u3068\u3044\u3046\u6027\u8cea\u3060\u304b\u3089\u3067\u3059\u3002\n\n## RSA\u9375\u4ea4\u63db\u306fFS\u3067\u306a\u3044\n\nTLS 1.2\u4ee5\u524d\u306b\u4f7f\u308f\u308c\u3066\u3044\u305f **RSA\u9375\u4ea4\u63db** \u306f\u3053\u306e\u6027\u8cea\u3092\u6e80\u305f\u3057\u307e\u305b\u3093\u3002RSA\u9375\u4ea4\u63db\u3067\u306f\n\n* \u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u304b\u3089\u516c\u958b\u9375\u3092\u53d6\u308a\u51fa\u3057\n* \u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u3066\u516c\u958b\u9375\u3067\u6697\u53f7\u5316\n* \u30b5\u30fc\u30d0\u306f\u8a3c\u660e\u66f8\u306b\u5bfe\u5fdc\u3059\u308b\u79d8\u5bc6\u9375\u3067\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u3092\u5fa9\u53f7\n* \u7d50\u679c\u3068\u3057\u3066\u540c\u3058\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u304b\u3089\u30bb\u30c3\u30b7\u30e7\u30f3\u9375\u3092\u751f\u6210\n\n\u2026\u3068\u3044\u3046\u624b\u9806\u3092\u8e0f\u3093\u3067\u9375\u306e\u4ea4\u63db\u3092\u884c\u3044\u307e\u3059\u304c\u3001\u300c\u9577\u671f\u9375\u3067\u3042\u308b\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u306b\u5bfe\u5fdc\u3059\u308b\u79d8\u5bc6\u9375\u300d\u304c\u66b4\u9732\u3055\u308c\u3001\u300c\u6697\u53f7\u5316\u3055\u308c\u305f\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u300d\u306e\u901a\u4fe1\u304c\u508d\u53d7\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u904e\u53bb\u306e\u901a\u4fe1\u3067\u3042\u3063\u3066\u3082\u79d8\u5bc6\u9375\u3092\u3082\u3068\u306b\u30bb\u30c3\u30b7\u30e7\u30f3\u9375\u3092\u5165\u624b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u79d8\u5bc6\u6027\u3092\u7834\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n## Diffie-Hellman\u9375\u4ea4\u63db\n\n### \u6570\u5b66\u7684\u306a\u5b9a\u7fa9\n\np \u306f\u5024\u306e\u5927\u304d\u306a\u7d20\u6570\u3001g \u306f $(\\mathbb{Z}/p\\mathbb{Z})*$ \u306e\u751f\u6210\u5143\uff08\u305d\u308c\u305e\u308c\u516c\u958b\u306e\u5024\uff09\u3068\u3057\u3001\u4e92\u3044\u306b $0 \\leq a, b \\leq p - 2$\u3000\u3092\u6e80\u305f\u3059\u3088\u3046\u306b\u79d8\u5bc6\u306e\u5024\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n- $A = g^{a} \\mod p, B = g^{b} \\mod p$ \u3092\u8a08\u7b97\u3057\u76f8\u624b\u306b\u6e21\u3057\u307e\u3059\u3002\n\n- $K_A = B^a \\mod p, K_B = A^b \\mod p$ \u3068\u3059\u308b\u3068\u3001\n\n- $K_{AB} = K_{BA} = g^{ab} \\mod p$ \u3088\u308a\u5171\u901a\u9375\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u4e00\u65b9\u3067\u3001 $A$ \u3068 $B$ \u304b\u3089 $K = g^{ab} \\mod p$\u3092\u591a\u9805\u5f0f\u6642\u9593\u3067\u8a08\u7b97\u3059\u308b\u65b9\u6cd5\u306f\u73fe\u5728\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\uff08\u96e2\u6563\u5bfe\u6570\u554f\u984c\uff09\n\n\u6955\u5186\u66f2\u7dda\u3092\u4f7f\u3063\u305fDiffie-Hellman\u3067\u3042\u308bECDH\u306e\u4ed5\u7d44\u307f\u306f\u7701\u7565\u3057\u307e\u3059\u304c\u3001\u540c\u69d8\u306b\u6955\u5186\u66f2\u7dda\u4e0a\u306e\u96e2\u6563\u5bfe\u6570\u554f\u984c\u306e\u56f0\u96e3\u6027\u3092\u5229\u7528\u3057\u305f\u9375\u4ea4\u63db\u65b9\u6cd5\u3067\u3059\u3002\n\n### \u308f\u304b\u308a\u3084\u3059\u3044DH\u9375\u4ea4\u63db\n\nDH\u9375\u4ea4\u63db\u306f\u4e00\u822c\u306b\u3088\u304f\u7d75\u306e\u5177\u3092\u6df7\u305c\u308b\u4f8b\u3067\u8aac\u660e\u3055\u308c\u307e\u3059\u3002\u6df7\u305c\u305f\u7d75\u306e\u5177\u304b\u3089\u6df7\u305c\u308b\u524d\u306e2\u8272\u3092\u5fa9\u5143\u3059\u308b\u306e\u304c\u56f0\u96e3\u3067\u3042\u308b\u3068\u3044\u3046\u6027\u8cea\u304c\u3001$A$ \u3068 $B$ \u304b\u3089 $K = g^{ab} \\mod p$\u3092\u591a\u9805\u5f0f\u6642\u9593\u3067\u8a08\u7b97\u3059\u308b\u306e\u304c\u56f0\u96e3\u3067\u3042\u308b\u3068\u3044\u3046\u6027\u8cea\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n\n[![](https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Diffie-Hellman_Key_Exchange.svg/399px-Diffie-Hellman_Key_Exchange.svg.png)](https://commons.wikimedia.org/wiki/File:Diffie-Hellman_Key_Exchange.svg)\n\n### DH\u9375\u4ea4\u63db\u306f\u4f7f\u3044\u65b9\u306b\u3088\u3063\u3066\u306fFS\n\nDH\u9375\u4ea4\u63db\u306e\u3046\u3061\u3001\u7279\u306b\u30bb\u30c3\u30b7\u30e7\u30f3\u3054\u3068\u306b\u4e00\u6642\u7684\u306a(ephemeral)\u79d8\u5bc6\u306e\u5024(=$A, B$)\u3092\u751f\u6210\u3059\u308b **DHE, ECDHE** \u306fForward Secrecy\u3092\u6301\u3061\u307e\u3059\u3002\n\nTLS\u3067\u306f\u4f7f\u7528\u3059\u308b\u6709\u9650\u7fa4(p\u3068g\uff09\u30fb\u6955\u5186\u66f2\u7dda\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001NamedGroup/NamedCurve\u3068\u3057\u3066 **\u4ed5\u69d8\u306e\u4e0a\u3067\u6c7a\u3081\u3089\u308c\u3066\u3044\u308b\u516c\u958b\u306e\u5024** \u3067\u3059\u3002\u305d\u306e\u3046\u3048\u3067\u3001\u6bce\u56de\u7570\u306a\u308b$A, B$\u306e\u5024\u3092\u7528\u3044\u3066\u30bb\u30c3\u30b7\u30e7\u30f3\u9375\u3092\u4f5c\u308b\u306e\u3067\u3001 **\u9577\u671f\u9375\u3068\u306a\u308b\u5024\u304c\u5b58\u5728\u305b\u305a** \u7d50\u679c\u3068\u3057\u3066\u5c06\u6765\u306b\u308f\u305f\u3063\u3066\u901a\u4fe1\u306e\u79d8\u5bc6\u304c\u4fdd\u305f\u308c\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n### DH\u9375\u4ea4\u63db\u306f\u4e2d\u9593\u8005\u653b\u6483\u306b\u5f31\u3044\n\n\u4e2d\u9593\u8005Eve\u304c$A,B$\u306e\u5024\u3092\u53d7\u3051\u53d6\u308a\u3001$a,b$\u3068\u540c\u69d8\u306e\u6027\u8cea\u3092\u6301\u3064$c,d$\u3092\u751f\u6210\u3057\u3001\u4ee5\u4e0b\u306e\u5024\u3092\u76f8\u624b\u306b\u4ee3\u308f\u308a\u306b\u6e21\u3059\u3068\u3057\u307e\u3059:\n\n$$A_E = g^c \\mod p$$ $$B_E = g^d \\mod p$$\n\n\u305d\u3046\u3059\u308b\u3068Alice\u3068Bob\u306f\n\n$$K_{AE} = B_E^a \\mod p$$ $$K_{BE} = A_E^b \\mod p$$\n\n\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u306e\u3068\u304d\u3001Alice\u3068Eve\u3001Eve\u3068Bob\u306e\u9593\u306b\u5171\u901a\u9375\u306e\u7533\u3057\u5408\u308f\u305b\u304c\u6210\u7acb\u3057\u307e\u3059\uff08\u524d\u8005\u306f$K_{AE}$\u3001\u5f8c\u8005\u306f$K_{BE}$\uff09\u3002\n\n\u3053\u306e\u3088\u3046\u306b\u4e2d\u9593\u8005\u653b\u6483\u3092\u884c\u3046\u3053\u3068\u304c\u5bb9\u6613\u306a\u306e\u3067\u3001DH\u9375\u4ea4\u63db\u306f\u5358\u4f53\u3067\u306f\u7528\u3044\u3089\u308c\u305a\u3001TLS\u3067\u306f\u76f8\u624b\u306e\u8a8d\u8a3c\u3092\u884c\u3046\u305f\u3081\u306b **\u4eca\u307e\u3067\u901a\u308a\u8a3c\u660e\u66f8\u3092\u7528\u3044\u307e\u3059\u3002**\n\n## \u305d\u3082\u305d\u3082\u4f55\u3067Forward Secrecy\uff1f\n\nForward Secrecy\u3092\u6301\u305f\u306a\u3044\u9375\u4ea4\u63db\u3092\u7528\u3044\u308b\u3068\u3001\u6697\u53f7\u5316\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u30b5\u30fc\u30d0\u30fc\u306b\u6b8b\u3063\u3066\u3044\u305f\u3089\u3044\u3064\u3067\u3082\u904e\u53bb\u306e\u3084\u308a\u3068\u308a\u304c\u5fa9\u53f7\u3055\u308c\u3066\u3057\u307e\u3046\u3068\u3044\u3046\u3053\u3068\u304c\u554f\u984c\u3068\u306a\u3063\u305f\u305f\u3081\u3067\u3059\u3002\u5177\u4f53\u7684\u306a\u4e8b\u4ef6\u3068\u3057\u3066\u306f\u3001Edward Snowden\u306e\u5185\u90e8\u544a\u767a\u4e8b\u4ef6\u306b\u95a2\u9023\u3057\u3066FBI\u304c\u30e1\u30fc\u30eb\u30b5\u30fc\u30d3\u30b9Lavabit\u306b\u5bfe\u3057\u3066\u79d8\u5bc6\u9375\u3092\u88c1\u5224\u6240\u547d\u4ee4\u3067\u8981\u6c42\u3057\u305f\u7d50\u679c\u79d8\u5bc6\u9375\u304c\u5f15\u304d\u6e21\u3055\u308c\u305d\u306e\u30b5\u30fc\u30d3\u30b9\u306f\u3084\u3080\u306a\u304f\u5ec3\u696d\u3001\u3068\u3044\u3046\u4e8b\u4ef6\u304c\u3042\u308a\u3001\u3053\u308c\u3092\u6a5f\u306bForward Secrecy\u306e\u5c0e\u5165\u306e\u6a5f\u904b\u304c\u9ad8\u307e\u308a\u307e\u3057\u305f\u3002\n\n# TLS 1.3\u3067\u306e\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u306e\u5909\u66f4\n\nTLS 1.2\u3067\u306f2RTT(\u518d\u63a5\u7d9a\u306a\u30891.5RTT)\u304b\u304b\u3063\u3066\u3044\u305f\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u304c **0.5\u301c1RTT** \u306b\u3001\u518d\u63a5\u7d9a\u306a\u3089\u5834\u5408\u306b\u3088\u3063\u3066\u306f **0RTT** \u3067\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6539\u5584\u304c\u56f3\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\n## TLS 1.2\u307e\u3067\u306e\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\n\nTLS 1.2\u307e\u3067\u306f\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u304c\u884c\u308f\u308c\u3066\u3044\u307e\u3057\u305f: \n\n1. Hello\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u4ea4\u63db\u306b\u3088\u3063\u3066\u3001\u4f7f\u7528\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08\u9375\u4ea4\u63db\u3001\u6697\u53f7\u5316\uff09\u306b\u3064\u3044\u3066\u5408\u610f\u3059\u308b\u3002\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u306e\u4ea4\u63db\u3092\u884c\u3044\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u7d99\u7d9a\u3092\u5224\u5b9a\u3059\u308b\n2. premaster secret\u306e\u5408\u610f\u306e\u305f\u3081\u306e\u6697\u53f7\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u4ea4\u63db\u3092\u884c\u3046\n3. \u4e92\u3044\u3092\u8a8d\u8a3c\u3057\u5408\u3046\u305f\u3081\u306e\u6697\u53f7\u60c5\u5831\u306e\u4ea4\u63db\u3092\u884c\u3046\n    - **\u8a8d\u8a3c**\n4. premaster secret\u3068random value\u304b\u3089master secret\u3092\u751f\u6210\n5. \u30ec\u30b3\u30fc\u30c9\u30ec\u30a4\u30e4\u30fc\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u4f9b\u7d66\u3059\u308b\n6. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30fb\u30b5\u30fc\u30d0\u30fc\u3068\u3082\u306b\u3001\u4e92\u3044\u306b\u6b63\u3057\u3044\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u8a08\u7b97\u3067\u304d\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001\u540c\u6642\u306b\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u304c\u6539\u3056\u3093\u306a\u3057\u306b\u884c\u308f\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n    - **\u6697\u53f7\u5316\u3001\u6539\u3056\u3093\u9632\u6b62**\n\n\u5b9f\u969b\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u3084\u308a\u53d6\u308a\u306f\u4ee5\u4e0b\u306e\u56f3\u306e\u901a\u308a\u3067\u3059\uff1a\n\n![tls12.png](https://qiita-image-store.s3.amazonaws.com/0/42250/044f5880-9bf4-843f-5e72-b7f35752bbcb.png \"tls12.png\")\n\n\n## TLS 1.3\u3067\u306e\u5909\u66f4\u70b9\n\nTLS 1.3\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3055\u308c\u3066\u3044\u307e\u3059\uff1a\n\n- Server/Client KeyExchange \u306f ClientHello/ServerHello\u306eExtension\u306e\u4e2d\u306b\u79fb\u52d5\n    - 1RTT\u76ee\u7d42\u308f\u3063\u3066\u3084\u3063\u3068Key\u3092\u9001\u3063\u3066\u305f\u306e\u3092\u6700\u521d\u304b\u3089\u9001\u3063\u3066\u3057\u307e\u3046\n- ChangeCipherSpec\u5ec3\u6b62\u3001\u9375\u4ea4\u63db\u76f4\u5f8c\u306b\u6697\u53f7\u5316\u958b\u59cb\n    - \u4eca\u307e\u3067\u306f\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u6697\u53f7\u5316\u306a\u3057\u300d\u306e\u30ec\u30b3\u30fc\u30c9\u5c64\u6697\u53f7\u5316\u306e\u5909\u66f4\u3092\u901a\u77e5\u3057\u3042\u3046\u307f\u305f\u3044\u306a\u3053\u3068\u306e\u305f\u3081\u306b\u4f7f\u308f\u308c\u3066\u3044\u305f\u304c\u2026\n\n![tls13_1.png](https://qiita-image-store.s3.amazonaws.com/0/42250/ccda2cbc-f3ed-c114-3ba1-79c096458122.png \"tls13_1.png\")\n\n![tls13_2.png](https://qiita-image-store.s3.amazonaws.com/0/42250/d68e4ec1-39dd-19c9-5482-fa82726f71d8.png \"tls13_2.png\")\n\n### TLS 1.2\u306eClientHello\n\n```\nstruct {\n  ProtocolVersion client_version;\n  Random random;\n  SessionID session_id;\n  CipherSuite cipher_suites<2..2^16-2>;\n  CompressionMethod compression_methods<1..2^8-1>;\n  select(extensions_present){\n    case false:\n      struct {};\n    case true:\n      Extension extensions<0..2^16-1>;\n  };\n} ClientHello;\n```\n\n### TLS 1.3\u306eClientHello\n\n```\nstruct {\n  ProtocolVersion legacy_version = 0x0303;\n  Random random;\n  opaque legacy_session_id<0..32>;\n  CipherSuite cipher_suites<2..2^16-2>;\n  opaque legacy_compression_methods<1..2^8-1>;\n  Extension extensions<0..2^16-1>;\n} ClientHello;\n```\n\n### \u4f55\u304c\u9055\u3046\uff1f\n\n\u4e92\u63db\u6027\u3092\u7dad\u6301\u3059\u308b\u305f\u3081\u306blegacy\u3068\u3057\u3066\u3044\u304f\u3064\u304b\u5024\u304c\u6b8b\u3063\u3066\u3044\u307e\u3059\u304c\u3001ClientHello\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6bd4\u8f03\u3059\u308b\u3068\u304b\u306a\u308a\u306e\u6a5f\u80fd\u304c\u524a\u3089\u308c\u3066\u3044\u307e\u3059:\n\n- \u591a\u304f\u306e\u30b5\u30fc\u30d0\u30fc\u304cversion negotiation\u3092\u9069\u5207\u306b\u5b9f\u88c5\u3057\u306a\u3044\u306e\u3067\u30010x0303\u56fa\u5b9a(=TLS 1.2\u306e\u5024)\u3068\u3057\u3001extension\u306b\u79fb\u52d5\n- \u518d\u63a5\u7d9a\u306e\u969b\u306bSessionID + Ticket\u306e\u4ee3\u308f\u308a\u306bPre-Shared Key(PSK)\u3092\u5229\u7528\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3057\u305f\u305f\u3081\u3001session_id\u5ec3\u6b62\n- **Compression\u3092\u5ec3\u6b62\u3002**CRIME\u653b\u6483\u306a\u3069\u306e\u5bfe\u7b56\n- TLS 1.3\u3067\u306f\u5fc5\u305aExtension\u304c\u5b58\u5728\n- Extensions\u306e\u4e2d\u3067\u6697\u53f7\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u3084\u308a\u3068\u308a\n\n## \u3069\u3046\u3084\u3063\u30660.5RTT\u3067\u6697\u53f7\u5316\uff1f\n\nTLS 1.2\u307e\u3067\u3068\u306e\u6c7a\u5b9a\u7684\u306a\u9055\u3044\u306f\u3001ServerHello\u304b\u3089\u5148\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3059\u3089\u6697\u53f7\u5316\u3055\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\u3053\u308c\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u4ed5\u7d44\u307f\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\uff1a\n\n![HowEncryptionWorks.png](https://qiita-image-store.s3.amazonaws.com/0/42250/7f3a0ef8-041c-ef54-cfee-ef1a68ebdc23.png \"HowEncryptionWorks.png\")\n\n\n- ClientHello\u306e\u6bb5\u968e\u3067PSK\u4f7f\u7528\uff08\u518d\u63a5\u7d9a\uff09\u304b(EC)DHE\u4f7f\u7528\uff08\u521d\u56de\u63a5\u7d9a\uff09\u304b\u3092\u6c7a\u5b9a\n- DHE\u306e\u5834\u5408\n    - DHE\u306epublic value\u306fKeyShare\u306eNamedGroup\u306b\u542b\u307e\u308c\u308b\n    - ClientHello, ServerHello\u306e\u305d\u308c\u305e\u308c\u306eKeyShare\u306e\u4e2d\u306b$K = g^x \\mod p$ \u304c\u542b\u307e\u308c\u308b\u3002\u30b5\u30fc\u30d0\u30fc\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u516c\u958b\u306e\u5024\u3092\u53d7\u3051\u53d6\u3063\u305f\u3089\u81ea\u5206\u306e\u79d8\u5bc6\u306e\u5024\u3092\u4f7f\u3063\u3066\u5171\u901a\u9375\u3092\u8a08\u7b97\u53ef\u80fd\n\n# \u30ec\u30b3\u30fc\u30c9\u5c64\u6697\u53f7\u5316\u306e\u898b\u76f4\u3057\n\n\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u4ee5\u5916\u306b\u3082\u30ec\u30b3\u30fc\u30c9\u5c64\u306e\u6697\u53f7\u5316\u306b\u7528\u3044\u3089\u308c\u308b\u6697\u53f7\u65b9\u5f0f\u306b\u3082\u898b\u76f4\u3057\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\n\n## Compression\u5ec3\u6b62\n\n\u3053\u3061\u3089\u306f\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u306e\u4e2d\u3067\u3082\u89e6\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u6b63\u3057\u3044\u5e73\u6587\u306e\u3068\u304d\u306b\u5727\u7e2e\u7387\u304c\u4e0a\u304c\u308b\u3068\u3044\u3046\u6027\u8cea\u3092\u7528\u3044\u305f\u30b5\u30a4\u30c9\u30c1\u30e3\u30cd\u30eb\u653b\u6483\u304c\u3044\u304f\u3064\u304b\uff08CRIME\u3001BREACH\u306a\u3069\uff09\u5b58\u5728\u3057\u3001\u3053\u308c\u3089\u306e\u653b\u6483\u3078\u306e\u5bfe\u7b56\u3068\u3057\u3066\u30ec\u30b3\u30fc\u30c9\u5c64\u306e\u5727\u7e2e\u304c\u884c\u308f\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n## CBC\u30e2\u30fc\u30c9\u5ec3\u6b62\u3001AEAD\u5fc5\u9808(AES-GCM, ChaCha20-Poly1305\u7b49)\n\n\u6697\u53f7\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u6697\u53f7\u5229\u7528\u30e2\u30fc\u30c9\u306b\u3064\u3044\u3066[\u8a8d\u8a3c\u4ed8\u304d\u6697\u53f7](https://ja.wikipedia.org/wiki/%E8%AA%8D%E8%A8%BC%E4%BB%98%E3%81%8D%E6%9A%97%E5%8F%B7)(AEAD: \u4ed8\u52a0\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u30c7\u30fc\u30bf\u306e\u4fdd\u8b77\u3068\u5b8c\u5168\u6027\u306e\u78ba\u8a8d\u3092\u540c\u6642\u306b\u884c\u3046\u3082\u306e)\u306e\u307f\u306b\u9650\u5b9a\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3053\u306e\u5909\u66f4\u306f\u4eca\u307e\u3067\u5e83\u304f\u7528\u3044\u3089\u308c\u3066\u304d\u305f[CBC\u30e2\u30fc\u30c9](https://ja.wikipedia.org/wiki/%E6%9A%97%E5%8F%B7%E5%88%A9%E7%94%A8%E3%83%A2%E3%83%BC%E3%83%89#CBC)\u304c\u5ec3\u6b62\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u80cc\u666f\u306b\u306f\u3001CBC\u30e2\u30fc\u30c9\u3092\u7279\u306b\u72d9\u3063\u305f\u653b\u6483(BEAST\u653b\u6483\u3001Lucky Thirteen\u653b\u6483\u306a\u3069)\u304c\u983b\u767a\u3057\u305f\u3053\u3068\u304c\u80cc\u666f\u306b\u3042\u308a\u307e\u3059\u3002\n\n----\n\n# \u53c2\u8003\u8cc7\u6599\n\n- [The Transport Layer Security(TLS) Protocol Version 1.3](https://tlswg.github.io/tls13-spec/)\n- [The Transport Layer Security (TLS) Protocol Version 1.2](https://tools.ietf.org/html/rfc5246)\n- [TLS 1.3\u3068\u306f](https://speakerdeck.com/shigeki/tls1-dot-3tohahe-ka)\n- [SSL/TLS & Perfect Forward Secrecy](https://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html)\n- [Web over HTTPS](https://speakerdeck.com/jxck/web-over-https)\n\n----\n\n\u660e\u65e5\u3082\u5f15\u304d\u7d9a\u304d\u79c1\u304c\u62c5\u5f53\u3067\u3001TLS\u306e\u8a71\u3092\u3057\u307e\u3059\u3002\u3057\u304b\u3057\u300c\u6700\u65b0\u306e\u300dTLS\u306e\u8a71\u3068\u306f\u8a00\u3063\u3066\u3044\u306a\u3044\u2026\uff01\n"}