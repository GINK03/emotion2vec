{"context": "\n\n\u306f\u3058\u3081\u306b\n\u3053\u308c\u306f\u3001Visual Basic Advent Calendar 2016\u306e16\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u3053\u308c\u307e\u30672\u56deAdvent Calendar 2016\u306b\u7d39\u4ecb\u8a18\u4e8b\u3092\u66f8\u304b\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u304c\u30012\u56de\u3068\u3082\u30c7\u30e2\u3063\u307d\u3044\u5185\u5bb9\u3060\u3063\u305f\u306e\u3067\u3001\u4eca\u56de\u306f\u3061\u3083\u3093\u3068VBAHaskell\u306b\u304a\u3051\u308b\u95a2\u6570\u306e\u4f5c\u308a\u65b9\u306b\u3064\u3044\u3066\u66f8\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u95a2\u6570\u306b\u3067\u304d\u308b\u3082\u306e\nVBAHaskell\u3067\u306f\u3001\u95a2\u6570\u672c\u4f53\u3068\u305d\u308c\u3068\u30da\u30a2\u306b\u306a\u308b\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5b9a\u7fa9\u3057\u3066\u3001\u3086\u308b\u3075\u308f\u306a\u95a2\u6570\u578b\u3063\u307d\u3044\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3057\u304b\u3057\u305d\u306e\u4f7f\u3044\u65b9\u304c\u3067\u304d\u308b\u95a2\u6570\u306e\u30d1\u30bf\u30fc\u30f3\u306f\u4e00\u3064\u3060\u3051\u3067\u3059\u3002\n' VBAHaskell\u3067\u57fa\u672c\u7684\u306b\u5b9a\u7fa9\u3067\u304d\u308b \u305f\u3063\u305f\u3072\u3068\u3064\u306e\u95a2\u6570\u30d1\u30bf\u30fc\u30f3\nFunction f(ByRef a As Variant, ByRef b As Variant) As Variant\n' \u305f\u3060\u3057\u3001\u7b2c\u4e8c\u5f15\u6570\u306f Optional \u306b\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u308b\nFunction g(ByRef a As Variant, Optional ByRef b As Variant) As Variant\n\n\u3053\u308c\u3060\u3051\u3067\u3059\u304c\u3001\u4ee5\u4e0b\u306e3\u3064\u306e\u65b9\u6cd5\u3067\u7528\u9014\u3092\u5e83\u3052\u3089\u308c\u307e\u3059\u3002\n\n\u914d\u5217\u95a2\u6570\u306e\u5f15\u6570\u306b\u3059\u308b\nplus\u3068\u3001\u305d\u306e\u30da\u30a2\u3067\u3042\u308bp_plus\u306f\u5358\u306b\u8db3\u3057\u7b97\u3059\u308b\u3060\u3051\u306e\u95a2\u6570\u3067\u3059\u304c\u3001mapF\u3084zipWith\u3001fold/scan\u7cfb\u306e\u95a2\u6570\u306e\u5f15\u6570\u306b\u3059\u308c\u3070\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3067\u304d\u307e\u3059\u3002\n' \u3075\u305f\u3064\u306e\u914d\u5217\u306e\u5404\u8981\u7d20\u3092\u52a0\u3048\u308b\nprintM zipWith(p_plus, iota(0, 9), iota(30000, 30009))\n  30000  30002  30004  30006  30008  30010  30012  30014  30016  30018\n\nzipWith\u306f\u4e8c\u3064\u306e\u914d\u5217\u304b\u3089\u65b0\u305f\u306b\u914d\u5217\u3092\u4f5c\u6210\u3059\u308b\u95a2\u6570\u3067\u3059\u304c\u3001p_plus\u304c\u305d\u306e\u7b2c1\u5f15\u6570\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002API\u5185\u3067\u30eb\u30fc\u30d7\u3057\u30660+30000, 1+30001, ..., 9+30009\u3068\u3044\u3046\u914d\u5217\u3092\u4f5c\u3063\u3066\u307e\u3059\u3002\u5f15\u304d\u7b97\u306b\u3057\u305f\u3051\u308c\u3070p_minus\u3092\u3001\u639b\u3051\u7b97\u306b\u3057\u305f\u3051\u308c\u3070p_mult\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n' \u81ea\u7136\u6570\u3092\u9806\u6b21\u8db3\u3057\u3066\u3044\u304f\nprintM scanl1(p_plus, iota(0, 100))\n  0  1  3  6  10  15  21  28  36  45  55  66  78  91  105  120  136  153  171  190  210  231  253  276  300  325  351  378  406  435  465  496  528  561  595  630  666  703  741  780  820  861  903  946  990  1035  1081  1128  1176  1225  1275  1326  1378  1431  1485  1540  1596  1653  1711  1770  1830  1891  1953  2016  2080  2145  2211  2278  2346  2415  2485  2556  2628  2701  2775  2850  2926  3003  3081  3160  3240  3321  3403  3486  3570  3655  3741  3828  3916  4005  4095  4186  4278  4371  4465  4560  4656  4753  4851  4950  5050\n\n\u540c\u3058\u304fp_plus\u3092\u4f7f\u3063\u3066\u307e\u3059\u304c\u3001\u7aef\u304b\u3089\u3069\u3093\u3069\u3093\u51e6\u7406\u3057\u3066\u5c65\u6b74\u3092\u51fa\u3059scanl1\u306b\u4f7f\u3046\u3068\u4e0a\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u95a2\u6570\u3092\u5408\u6210\u3059\u308b\nless\u3068p_less\u306f\u5927\u5c0f\u95a2\u4fc2 \"<\" \u8868\u3057\u307e\u3059\u304c\u3001\u6587\u5b57\u5217\u306e\u9577\u3055\u3092\u6c42\u3081\u308bp_len\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u914d\u5217\u3092\u300c\u6587\u5b57\u5217\u306e\u9577\u3055\u9806\u300d\u306b\u30bd\u30fc\u30c8\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n' String \u306e\u914d\u5217\ns = Array(\"Zbkn\", \"Afkbpirthrit\", \"123\", \"Kdgndi\")\n' \u6587\u5b57\u5217\u306e\u9577\u3055\u9806\u306b\u3057\u305f\u3068\u304d\u306e\u9806\u4f4d ord \u3092\u51fa\u529b\u3059\u308b\nord = sortIndex_pred(s, p_less(p_len, p_len))\nprintM ord\n  2  0  3  1\n' Ord \u9806\u306b\u4e26\u3079\u308b\nprintM  subV(s, ord)\n  123  Zbkn  Kdgndi  Afkbpirthrit\n\n\u4e0a\u306e\u4f8b\u3067\u306f\u3001p_less(p_len, p_len) \u304c\u30bd\u30fc\u30c8\u306b\u4f7f\u3046\u6bd4\u8f03\u95a2\u6570\u3068\u306a\u308a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u5f15\u6570\u304c\u96a0\u308c\u3066\u3044\u308b\u306e\u3067\u5b9f\u969b\u306b\u306f\u3053\u3093\u306a\u69cb\u9020\u3067\u3059\u3002\n\u3000\u3000p_less(p_len( _  _ ), p_len( _  _ ))\n\u3053\u308c\u306b\u3075\u305f\u3064\u306e\u6587\u5b57\u5217s1\u3068s2\u3092\u4ee3\u5165\u3059\u308b\u3068 Len(s1) < Len(s2) \u3068\u306a\u3063\u3066\u3001\u6587\u5b57\u5217\u9577\u306e\u6bd4\u8f03\u306b\u306a\u308a\u307e\u3059\u3002\u500b\u3005\u306e\u95a2\u6570\u306f\u5358\u6a5f\u80fd\u3067\u3082\u5408\u6210\u3059\u308c\u3070\u8907\u96d1\u306a\u3082\u306e\u3092\u4f5c\u308c\u308b\u306e\u3067\u3001\u76ee\u7684\u3054\u3068\u306b\u3044\u3061\u3044\u3061 Function \u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3092\u66f8\u3044\u3066\u95a2\u6570\u3092\u5b9a\u7fa9\u305b\u305a\u306b\u3059\u307f\u307e\u3059\u3002\u305f\u3068\u3048\u3070\u6587\u5b57\u5217\u9577\u3067\u964d\u9806\u30bd\u30fc\u30c8\u3057\u305f\u3051\u308c\u3070p_greater\u3092\u4f7f\u3048\u3070\u3044\u3044\u3067\u3059\u3002\n' String \u306e\u914d\u5217\ns = Array(\"Zbkn\", \"Afkbpirthrit\", \"123\", \"Kdgndi\")\n' \u6587\u5b57\u5217\u306e\u9577\u3055\u9806\uff08\u964d\u9806\uff09\u306b\u3057\u305f\u3068\u304d\u306e\u9806\u4f4d ord \u3092\u51fa\u529b\u3059\u308b\nord = sortIndex_pred(s, p_greater(p_len, p_len))\nprintM ord\n  1  3  0  2\n' Ord \u9806\u306b\u4e26\u3079\u308b\nprintM  subV(s, ord)\n  Afkbpirthrit  Kdgndi  Zbkn  123\n\n\n\u5f15\u6570\u3001\u623b\u308a\u5024\u3092\u914d\u5217\u306b\u3059\u308b\n\u81ea\u5206\u81ea\u8eab\u304c\u914d\u5217\u3092\u5f15\u6570\u306b\u3068\u308b\u3053\u3068\u3067\u3001\u591a\u6570\u306e\u8981\u7d20\u3092\u76f8\u624b\u306b\u3057\u305f\u51e6\u7406\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u623b\u308a\u5024\u3092\u914d\u5217\u306b\u3059\u308b\u306e\u3082\u540c\u69d8\u3067\u3059\u3002\n\u305f\u3068\u3048\u3070filterR\u3068\u3044\u3046\u95a2\u6570\u306f\u3001\u7b2c1\u5f15\u6570\u306b\u5bfe\u8c61\u914d\u5217\u3001\u7b2c2\u5f15\u6570\u306b<0/1>\u30d5\u30e9\u30b0\u304b\u3089\u306a\u308b\u914d\u5217\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u914d\u5217\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3092\u3057\u307e\u3059\u3002\n'\u30d9\u30af\u30c8\u30eb\u30fb\u914d\u5217\u306e\uff08\u884c\u306e\uff09\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n'Flg\u306f 0/1\nPublic Function filterR(ByRef data As Variant, ByRef flg As Variant) As Variant\n\n\u4e0b\u306f\u6574\u6570\u5217\u304b\u30893\u306e\u500d\u6570\u3060\u3051\u62bd\u51fa\u3059\u308b\u5358\u7d14\u306a\u4f8b\u3067\u3059\u304c\u3001\u30d5\u30e9\u30b0\u3092\u4f5c\u308b\u306e\u306b\u95a2\u6570\u5408\u6210\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\na = iota(0, 30)               ' 0\u304b\u308930\u307e\u3067\u306e\u6574\u6570\u5217\nf = p_equal(p_mod(, 3), 0)    ' (x Mod 3) = 0 \u3092\u8868\u3059\u95a2\u6570\nprintM filterR(a, mapF(f, a))\n  0  3  6  9  12  15  18  21  24  27  30\n\n\n\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u308a\u65b9\nOptional\u5f15\u6570\u306e\u306a\u3044\u3044\u3061\u3070\u3093\u8eab\u8fd1\u306a\u4f8b\u306f\u8db3\u3057\u7b97\u3067\u3059\u3002\n\u3053\u306e\u95a2\u6570\u306f\u3001Haskell_2_stdFun\u30e2\u30b8\u30e5\u30fc\u30eb\uff08Github\u3001\u3082\u3057\u304f\u306f\u3053\u3053\uff09\u306b\u3042\u308a\u307e\u3059\u3002\n'\u52a0\u7b97\nFunction plus(ByRef a As Variant, ByRef b As Variant) As Variant\n    plus = a + b\nEnd Function\n\n    Function p_plus(Optional ByRef firstParam As Variant, Optional ByRef secondParam As Variant) As Variant\n        p_plus = make_funPointer(AddressOf plus, firstParam, secondParam)\n    End Function\n\nFunction plus \u306f\u6700\u521d\u306b\u8ff0\u3079\u305f\u30d1\u30bf\u30fc\u30f3\u3092\u5b88\u3063\u3066\u666e\u901a\u306b\u5b9a\u7fa9\u3057\u305fVBA\u95a2\u6570\u3067\u3059\u3002\np_plus\u306e\u65b9\u306fplus\u306e\u30da\u30a2\u3067\u3042\u308b\u3053\u3068\u3092\u660e\u78ba\u306b\u3059\u308b\u305f\u3081\u306bp_plus\u3068\u3044\u3046\u540d\u524d\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001AddressOf\u306e\u5f15\u6570\u304cplus\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u672c\u8cea\u3067\u3059\u3002\n\u81ea\u5206\u3067\u65b0\u3057\u304f\u95a2\u6570\u3068\u305d\u306e\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3068\u304d\u306f\u3001\u3053\u308c\u3092\u30b3\u30d4\u30da\u3057\u3066\u95a2\u6570\u540d\u3060\u3051\u5909\u3048\u308c\u3070OK\u3067\u3059\u3002make_funPointer\u304c\u3059\u3079\u3066\u306e\u4ed5\u4e8b\u3092\u3084\u3063\u3066\u3044\u307e\u3059\u3002\n\u7b2c\u4e8c\u5f15\u6570\u304cOptional\u306a\u5834\u5408\u306f\u3001\u305d\u308c\u304c\u5168\u304f\u306e\u30c0\u30df\u30fc\u3067\u3042\u308b\u304b\u305d\u3046\u3067\u306a\u3044\u304b\u3067\u30d1\u30bf\u30fc\u30f3\u304c\u5206\u304b\u308c\u307e\u3059\u3002\n\u6b21\u306e\u6307\u6570\u95a2\u6570 expN \u306f\u7d44\u307f\u8fbc\u307f\u306eexp\u305d\u306e\u307e\u3093\u307e\u3067\u3059\u304c\u3001\u7b2c\u4e8c\u5f15\u6570\u306f\u540d\u524d\u306e\u901a\u308a\u30c0\u30df\u30fc\u3067\u3001\u3042\u3063\u3066\u3082\u306a\u304f\u3066\u3082\u7121\u5f71\u97ff\u3067\u3059\u3002IsMissing\u306e\u5224\u5b9a\u3082\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u3053\u306e\u5834\u5408\u306f\u3001\u6700\u521d\u306e\u30d1\u30bf\u30fc\u30f3\u3068\u540c\u3058\u3067\u3001make_funPointer\u3067\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\n'\u6307\u6570\u95a2\u6570\nFunction expN(ByRef a As Variant, ByRef dummy As Variant) As Variant\n    expN = Exp(a)\nEnd Function\n    Function p_exp(Optional ByRef firstParam As Variant, Optional ByRef secondParam As Variant) As Variant\n        p_exp = make_funPointer(AddressOf expN, firstParam, secondParam)\n    End Function\n\n\u5bfe\u6570\u95a2\u6570\u306e\u5834\u5408\u306f\u7b2c\u4e8c\u5f15\u6570\u304c\u306a\u3051\u308c\u3070\u81ea\u7136\u5bfe\u6570\u3001\u3042\u308c\u3070\u305d\u306e\u6570\u3092\u5e95\u306b\u3059\u308b\u305f\u3081\u3001IsMissing\u3067\u5224\u5b9a\u3092\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u3046\u3044\u3046\u95a2\u6570\u306b\u5bfe\u3057\u3066\u306fmake_funPointer\u306e\u4ee3\u308f\u308a\u306bmake_funPointer_with_2nd_Default\u3092\u4f7f\u3044\u307e\u3059\u3002\n'\u5bfe\u6570\u95a2\u6570\nFunction logN(ByRef a As Variant, Optional ByRef base As Variant) As Variant\n    If IsMissing(base) Then\n        logN = Log(a)\n    Else\n        logN = Log(a) / Log(base)\n    End If\nEnd Function\n    Function p_log(Optional ByRef firstParam As Variant, Optional ByRef secondParam As Variant) As Variant\n        p_log = make_funPointer_with_2nd_Default(AddressOf logN, firstParam, secondParam)\n    End Function\n\nmake_funPointer\u3068make_funPointer_with_2nd_Default\u304c\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306fAPI\u3068\u306e\u7d61\u307f\u3082\u3042\u308b\u306e\u3067\u8907\u96d1\u3067\u3059\u304c\u3001\u3069\u3061\u3089\u3092\u4f7f\u3046\u304b\u306e\u57fa\u6e96\u306f\u4e0a\u306b\u8ff0\u3079\u305f\u901a\u308a\u5358\u7d14\u306a\u306e\u3067\u3001p_plus\u304bp_log\u306e\u3069\u3061\u3089\u304b\u3092\u30b3\u30d4\u30da\u3059\u308b\u3068\u3044\u3046\u65b9\u91dd\u3067\u5341\u5206\u3067\u3059\u3002\n\n\u30ea\u30f3\u30af\nQiita\u3000VBAHaskell\u306e\u7d39\u4ecb\u3000\u305d\u306e1\u3000\uff08\u6700\u521d\u306fmapF\uff09\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9(Github)\nVBAHaskell\u306e\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\ndll\u30d0\u30a4\u30ca\u30ea\uff1a\nhttps://github.com/mYmd/VBA/blob/master/bin/mapM (32bit-Office\u7528)\nhttps://github.com/mYmd/VBA/blob/master/bin/mapM64 (64bit-Officey\u7528)\nVBA\u30b3\u30fc\u30c9\u6dfb\u4ed8\u6e08\u307fExcel\u30d6\u30c3\u30af\nVBAHaskell\u307b\u307c\u5168\u90e8\u5165\u308a.xlsm\n##\u306f\u3058\u3081\u306b\n\u3053\u308c\u306f\u3001[Visual Basic Advent Calendar 2016](http://qiita.com/advent-calendar/2016/vb)\u306e16\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n\u3053\u308c\u307e\u30672\u56deAdvent Calendar 2016\u306b\u7d39\u4ecb\u8a18\u4e8b\u3092\u66f8\u304b\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u304c\u30012\u56de\u3068\u3082\u30c7\u30e2\u3063\u307d\u3044\u5185\u5bb9\u3060\u3063\u305f\u306e\u3067\u3001\u4eca\u56de\u306f\u3061\u3083\u3093\u3068VBAHaskell\u306b\u304a\u3051\u308b\u95a2\u6570\u306e\u4f5c\u308a\u65b9\u306b\u3064\u3044\u3066\u66f8\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n##\u95a2\u6570\u306b\u3067\u304d\u308b\u3082\u306e\nVBAHaskell\u3067\u306f\u3001\u95a2\u6570\u672c\u4f53\u3068\u305d\u308c\u3068\u30da\u30a2\u306b\u306a\u308b\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5b9a\u7fa9\u3057\u3066\u3001\u3086\u308b\u3075\u308f\u306a\u95a2\u6570\u578b\u3063\u307d\u3044\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3057\u304b\u3057\u305d\u306e\u4f7f\u3044\u65b9\u304c\u3067\u304d\u308b\u95a2\u6570\u306e\u30d1\u30bf\u30fc\u30f3\u306f\u4e00\u3064\u3060\u3051\u3067\u3059\u3002\n\n```vbnet\n' VBAHaskell\u3067\u57fa\u672c\u7684\u306b\u5b9a\u7fa9\u3067\u304d\u308b \u305f\u3063\u305f\u3072\u3068\u3064\u306e\u95a2\u6570\u30d1\u30bf\u30fc\u30f3\nFunction f(ByRef a As Variant, ByRef b As Variant) As Variant\n' \u305f\u3060\u3057\u3001\u7b2c\u4e8c\u5f15\u6570\u306f Optional \u306b\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u308b\nFunction g(ByRef a As Variant, Optional ByRef b As Variant) As Variant\n```\n\u3053\u308c\u3060\u3051\u3067\u3059\u304c\u3001\u4ee5\u4e0b\u306e3\u3064\u306e\u65b9\u6cd5\u3067\u7528\u9014\u3092\u5e83\u3052\u3089\u308c\u307e\u3059\u3002\n\n##\u914d\u5217\u95a2\u6570\u306e\u5f15\u6570\u306b\u3059\u308b\n`plus`\u3068\u3001\u305d\u306e\u30da\u30a2\u3067\u3042\u308b`p_plus`\u306f\u5358\u306b\u8db3\u3057\u7b97\u3059\u308b\u3060\u3051\u306e\u95a2\u6570\u3067\u3059\u304c\u3001`mapF`\u3084`zipWith`\u3001`fold/scan`\u7cfb\u306e\u95a2\u6570\u306e\u5f15\u6570\u306b\u3059\u308c\u3070\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3067\u304d\u307e\u3059\u3002\n\n```vbnet\n' \u3075\u305f\u3064\u306e\u914d\u5217\u306e\u5404\u8981\u7d20\u3092\u52a0\u3048\u308b\nprintM zipWith(p_plus, iota(0, 9), iota(30000, 30009))\n  30000  30002  30004  30006  30008  30010  30012  30014  30016  30018\n```\n`zipWith`\u306f\u4e8c\u3064\u306e\u914d\u5217\u304b\u3089\u65b0\u305f\u306b\u914d\u5217\u3092\u4f5c\u6210\u3059\u308b\u95a2\u6570\u3067\u3059\u304c\u3001`p_plus`\u304c\u305d\u306e\u7b2c1\u5f15\u6570\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002API\u5185\u3067\u30eb\u30fc\u30d7\u3057\u3066`0+30000, 1+30001, ..., 9+30009`\u3068\u3044\u3046\u914d\u5217\u3092\u4f5c\u3063\u3066\u307e\u3059\u3002\u5f15\u304d\u7b97\u306b\u3057\u305f\u3051\u308c\u3070`p_minus`\u3092\u3001\u639b\u3051\u7b97\u306b\u3057\u305f\u3051\u308c\u3070`p_mult`\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```vbnet\n' \u81ea\u7136\u6570\u3092\u9806\u6b21\u8db3\u3057\u3066\u3044\u304f\nprintM scanl1(p_plus, iota(0, 100))\n  0  1  3  6  10  15  21  28  36  45  55  66  78  91  105  120  136  153  171  190  210  231  253  276  300  325  351  378  406  435  465  496  528  561  595  630  666  703  741  780  820  861  903  946  990  1035  1081  1128  1176  1225  1275  1326  1378  1431  1485  1540  1596  1653  1711  1770  1830  1891  1953  2016  2080  2145  2211  2278  2346  2415  2485  2556  2628  2701  2775  2850  2926  3003  3081  3160  3240  3321  3403  3486  3570  3655  3741  3828  3916  4005  4095  4186  4278  4371  4465  4560  4656  4753  4851  4950  5050\n```\n\u540c\u3058\u304f`p_plus`\u3092\u4f7f\u3063\u3066\u307e\u3059\u304c\u3001\u7aef\u304b\u3089\u3069\u3093\u3069\u3093\u51e6\u7406\u3057\u3066\u5c65\u6b74\u3092\u51fa\u3059`scanl1`\u306b\u4f7f\u3046\u3068\u4e0a\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n##\u95a2\u6570\u3092\u5408\u6210\u3059\u308b\n`less`\u3068`p_less`\u306f\u5927\u5c0f\u95a2\u4fc2 `\"<\"` \u8868\u3057\u307e\u3059\u304c\u3001\u6587\u5b57\u5217\u306e\u9577\u3055\u3092\u6c42\u3081\u308b`p_len`\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u914d\u5217\u3092\u300c\u6587\u5b57\u5217\u306e\u9577\u3055\u9806\u300d\u306b\u30bd\u30fc\u30c8\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```vbnet\n' String \u306e\u914d\u5217\ns = Array(\"Zbkn\", \"Afkbpirthrit\", \"123\", \"Kdgndi\")\n' \u6587\u5b57\u5217\u306e\u9577\u3055\u9806\u306b\u3057\u305f\u3068\u304d\u306e\u9806\u4f4d ord \u3092\u51fa\u529b\u3059\u308b\nord = sortIndex_pred(s, p_less(p_len, p_len))\nprintM ord\n  2  0  3  1\n' Ord \u9806\u306b\u4e26\u3079\u308b\nprintM  subV(s, ord)\n  123  Zbkn  Kdgndi  Afkbpirthrit\n```\n\u4e0a\u306e\u4f8b\u3067\u306f\u3001`p_less(p_len, p_len)` \u304c\u30bd\u30fc\u30c8\u306b\u4f7f\u3046\u6bd4\u8f03\u95a2\u6570\u3068\u306a\u308a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u5f15\u6570\u304c\u96a0\u308c\u3066\u3044\u308b\u306e\u3067\u5b9f\u969b\u306b\u306f\u3053\u3093\u306a\u69cb\u9020\u3067\u3059\u3002\n\u3000\u3000**p_less(p_len( _ :sunny: _ ), p_len( _ :stuck_out_tongue: _ ))**\n\u3053\u308c\u306b\u3075\u305f\u3064\u306e\u6587\u5b57\u5217`s1`\u3068`s2`\u3092\u4ee3\u5165\u3059\u308b\u3068 `Len(s1) < Len(s2)` \u3068\u306a\u3063\u3066\u3001\u6587\u5b57\u5217\u9577\u306e\u6bd4\u8f03\u306b\u306a\u308a\u307e\u3059\u3002\u500b\u3005\u306e\u95a2\u6570\u306f\u5358\u6a5f\u80fd\u3067\u3082\u5408\u6210\u3059\u308c\u3070\u8907\u96d1\u306a\u3082\u306e\u3092\u4f5c\u308c\u308b\u306e\u3067\u3001\u76ee\u7684\u3054\u3068\u306b\u3044\u3061\u3044\u3061 `Function` \u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3092\u66f8\u3044\u3066\u95a2\u6570\u3092\u5b9a\u7fa9\u305b\u305a\u306b\u3059\u307f\u307e\u3059\u3002\u305f\u3068\u3048\u3070\u6587\u5b57\u5217\u9577\u3067\u964d\u9806\u30bd\u30fc\u30c8\u3057\u305f\u3051\u308c\u3070`p_greater`\u3092\u4f7f\u3048\u3070\u3044\u3044\u3067\u3059\u3002\n\n```vbnet\n' String \u306e\u914d\u5217\ns = Array(\"Zbkn\", \"Afkbpirthrit\", \"123\", \"Kdgndi\")\n' \u6587\u5b57\u5217\u306e\u9577\u3055\u9806\uff08\u964d\u9806\uff09\u306b\u3057\u305f\u3068\u304d\u306e\u9806\u4f4d ord \u3092\u51fa\u529b\u3059\u308b\nord = sortIndex_pred(s, p_greater(p_len, p_len))\nprintM ord\n  1  3  0  2\n' Ord \u9806\u306b\u4e26\u3079\u308b\nprintM  subV(s, ord)\n  Afkbpirthrit  Kdgndi  Zbkn  123\n```\n\n\n##\u5f15\u6570\u3001\u623b\u308a\u5024\u3092\u914d\u5217\u306b\u3059\u308b\n\u81ea\u5206\u81ea\u8eab\u304c\u914d\u5217\u3092\u5f15\u6570\u306b\u3068\u308b\u3053\u3068\u3067\u3001\u591a\u6570\u306e\u8981\u7d20\u3092\u76f8\u624b\u306b\u3057\u305f\u51e6\u7406\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u623b\u308a\u5024\u3092\u914d\u5217\u306b\u3059\u308b\u306e\u3082\u540c\u69d8\u3067\u3059\u3002\n\u305f\u3068\u3048\u3070`filterR`\u3068\u3044\u3046\u95a2\u6570\u306f\u3001\u7b2c1\u5f15\u6570\u306b\u5bfe\u8c61\u914d\u5217\u3001\u7b2c2\u5f15\u6570\u306b<0/1>\u30d5\u30e9\u30b0\u304b\u3089\u306a\u308b\u914d\u5217\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u914d\u5217\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3092\u3057\u307e\u3059\u3002\n\n```vbnet\n'\u30d9\u30af\u30c8\u30eb\u30fb\u914d\u5217\u306e\uff08\u884c\u306e\uff09\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n'Flg\u306f 0/1\nPublic Function filterR(ByRef data As Variant, ByRef flg As Variant) As Variant\n```\n\u4e0b\u306f\u6574\u6570\u5217\u304b\u30893\u306e\u500d\u6570\u3060\u3051\u62bd\u51fa\u3059\u308b\u5358\u7d14\u306a\u4f8b\u3067\u3059\u304c\u3001\u30d5\u30e9\u30b0\u3092\u4f5c\u308b\u306e\u306b\u95a2\u6570\u5408\u6210\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\n```vbnet\na = iota(0, 30)               ' 0\u304b\u308930\u307e\u3067\u306e\u6574\u6570\u5217\nf = p_equal(p_mod(, 3), 0)    ' (x Mod 3) = 0 \u3092\u8868\u3059\u95a2\u6570\nprintM filterR(a, mapF(f, a))\n  0  3  6  9  12  15  18  21  24  27  30\n```\n\n##\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u308a\u65b9\nOptional\u5f15\u6570\u306e\u306a\u3044\u3044\u3061\u3070\u3093\u8eab\u8fd1\u306a\u4f8b\u306f\u8db3\u3057\u7b97\u3067\u3059\u3002\n\u3053\u306e\u95a2\u6570\u306f\u3001Haskell_2_stdFun\u30e2\u30b8\u30e5\u30fc\u30eb\uff08[Github](https://github.com/mYmd/VBA/blob/master/Haskell_2_stdFun.bas)\u3001\u3082\u3057\u304f\u306f[\u3053\u3053](http://home.b07.itscom.net/m-yamada/VBA/Haskell_2_stdFun.bas)\uff09\u306b\u3042\u308a\u307e\u3059\u3002\n\n```vbnet\n'\u52a0\u7b97\nFunction plus(ByRef a As Variant, ByRef b As Variant) As Variant\n    plus = a + b\nEnd Function\n\n    Function p_plus(Optional ByRef firstParam As Variant, Optional ByRef secondParam As Variant) As Variant\n        p_plus = make_funPointer(AddressOf plus, firstParam, secondParam)\n    End Function\n```\n\n`Function plus` \u306f\u6700\u521d\u306b\u8ff0\u3079\u305f\u30d1\u30bf\u30fc\u30f3\u3092\u5b88\u3063\u3066\u666e\u901a\u306b\u5b9a\u7fa9\u3057\u305fVBA\u95a2\u6570\u3067\u3059\u3002\n`p_plus`\u306e\u65b9\u306f`plus`\u306e\u30da\u30a2\u3067\u3042\u308b\u3053\u3068\u3092\u660e\u78ba\u306b\u3059\u308b\u305f\u3081\u306b`p_plus`\u3068\u3044\u3046\u540d\u524d\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001`AddressOf`\u306e\u5f15\u6570\u304c`plus`\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u672c\u8cea\u3067\u3059\u3002\n\u81ea\u5206\u3067\u65b0\u3057\u304f\u95a2\u6570\u3068\u305d\u306e\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3068\u304d\u306f\u3001\u3053\u308c\u3092\u30b3\u30d4\u30da\u3057\u3066\u95a2\u6570\u540d\u3060\u3051\u5909\u3048\u308c\u3070OK\u3067\u3059\u3002`make_funPointer`\u304c\u3059\u3079\u3066\u306e\u4ed5\u4e8b\u3092\u3084\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u7b2c\u4e8c\u5f15\u6570\u304cOptional\u306a\u5834\u5408\u306f\u3001\u305d\u308c\u304c\u5168\u304f\u306e\u30c0\u30df\u30fc\u3067\u3042\u308b\u304b\u305d\u3046\u3067\u306a\u3044\u304b\u3067\u30d1\u30bf\u30fc\u30f3\u304c\u5206\u304b\u308c\u307e\u3059\u3002\n\u6b21\u306e\u6307\u6570\u95a2\u6570 `expN` \u306f\u7d44\u307f\u8fbc\u307f\u306e`exp`\u305d\u306e\u307e\u3093\u307e\u3067\u3059\u304c\u3001\u7b2c\u4e8c\u5f15\u6570\u306f\u540d\u524d\u306e\u901a\u308a\u30c0\u30df\u30fc\u3067\u3001\u3042\u3063\u3066\u3082\u306a\u304f\u3066\u3082\u7121\u5f71\u97ff\u3067\u3059\u3002`IsMissing`\u306e\u5224\u5b9a\u3082\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u3053\u306e\u5834\u5408\u306f\u3001\u6700\u521d\u306e\u30d1\u30bf\u30fc\u30f3\u3068\u540c\u3058\u3067\u3001`make_funPointer`\u3067\u95a2\u6570\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n```vbnet\n'\u6307\u6570\u95a2\u6570\nFunction expN(ByRef a As Variant, ByRef dummy As Variant) As Variant\n    expN = Exp(a)\nEnd Function\n    Function p_exp(Optional ByRef firstParam As Variant, Optional ByRef secondParam As Variant) As Variant\n        p_exp = make_funPointer(AddressOf expN, firstParam, secondParam)\n    End Function\n```\n\u5bfe\u6570\u95a2\u6570\u306e\u5834\u5408\u306f\u7b2c\u4e8c\u5f15\u6570\u304c\u306a\u3051\u308c\u3070\u81ea\u7136\u5bfe\u6570\u3001\u3042\u308c\u3070\u305d\u306e\u6570\u3092\u5e95\u306b\u3059\u308b\u305f\u3081\u3001`IsMissing`\u3067\u5224\u5b9a\u3092\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u3046\u3044\u3046\u95a2\u6570\u306b\u5bfe\u3057\u3066\u306f`make_funPointer`\u306e\u4ee3\u308f\u308a\u306b`make_funPointer_with_2nd_Default`\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```vbnet\n'\u5bfe\u6570\u95a2\u6570\nFunction logN(ByRef a As Variant, Optional ByRef base As Variant) As Variant\n    If IsMissing(base) Then\n        logN = Log(a)\n    Else\n        logN = Log(a) / Log(base)\n    End If\nEnd Function\n    Function p_log(Optional ByRef firstParam As Variant, Optional ByRef secondParam As Variant) As Variant\n        p_log = make_funPointer_with_2nd_Default(AddressOf logN, firstParam, secondParam)\n    End Function\n```\n`make_funPointer`\u3068`make_funPointer_with_2nd_Default`\u304c\u3084\u3063\u3066\u3044\u308b\u3053\u3068\u306fAPI\u3068\u306e\u7d61\u307f\u3082\u3042\u308b\u306e\u3067\u8907\u96d1\u3067\u3059\u304c\u3001\u3069\u3061\u3089\u3092\u4f7f\u3046\u304b\u306e\u57fa\u6e96\u306f\u4e0a\u306b\u8ff0\u3079\u305f\u901a\u308a\u5358\u7d14\u306a\u306e\u3067\u3001`p_plus`\u304b`p_log`\u306e\u3069\u3061\u3089\u304b\u3092\u30b3\u30d4\u30da\u3059\u308b\u3068\u3044\u3046\u65b9\u91dd\u3067\u5341\u5206\u3067\u3059\u3002\n\n* * *\n\n\u30ea\u30f3\u30af\n\n[Qiita\u3000VBAHaskell\u306e\u7d39\u4ecb\u3000\u305d\u306e1\u3000\uff08\u6700\u521d\u306fmapF\uff09](http://qiita.com/mmYYmmdd/items/c731edf943acc0a0ebe9)\n[\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9(Github)](https://github.com/mYmd/VBA)\n[VBAHaskell\u306e\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9](http://home.b07.itscom.net/m-yamada/vh_Manual/VBAHaskell_reference.htm)\ndll\u30d0\u30a4\u30ca\u30ea\uff1a\nhttps://github.com/mYmd/VBA/blob/master/bin/mapM (32bit-Office\u7528)\nhttps://github.com/mYmd/VBA/blob/master/bin/mapM64 (64bit-Officey\u7528)\nVBA\u30b3\u30fc\u30c9\u6dfb\u4ed8\u6e08\u307fExcel\u30d6\u30c3\u30af\n[VBAHaskell\u307b\u307c\u5168\u90e8\u5165\u308a.xlsm](https://github.com/mYmd/VBA/blob/master/bin/VBAHaskell%E3%81%BB%E3%81%BC%E5%85%A8%E9%83%A8%E5%85%A5%E3%82%8A.xlsm)\n\n", "tags": ["VBA"]}