{"context": " More than 1 year has passed since last update.\u81ea\u5206\u7528\u30e1\u30e2\n\u30de\u30fc\u30af\u30c0\u30a6\u30f3\u66f8\u304d\u65b9\u308f\u304b\u3093\u306a\u3044(Redmine\u98a8\u306b\u66f8\u3051\u3070\u3044\u3044\u306e\u304b\u3057\u3089\uff1f)\n\u3068\u308a\u3042\u3048\u305a\u3001\u5f8c\u3067\u6574\u5f62\u3057\u3088\u3046\u3002\nCentOS7\u4e0a\u306bDocker1.8.2\u3092\u5165\u308c\u3066\u3001DockerRegistry\u3092\u4f5c\u308d\u3046\u3068\u601d\u3063\u305f\u3002\n\u3057\u304b\u3057\u3001DockerRegistry\u306f\u975e\u63a8\u5968\u306b\u306a\u3063\u305f\uff1f\u3088\u3046\u306a\u96f0\u56f2\u6c17\u3092\u91b8\u3057\u51fa\u3057\u3066\u308b\u3088\u3046\u306a\u30fb\u30fb\u30fb\n\u9055\u3046\u304b\u3001DockerRegistry\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u304c\u975e\u63a8\u5968\u306b\u306a\u3063\u305f\u306e\u304b\u3002\nDistribution\u4f7f\u3048\u3063\u3066gitHub\u306b\u66f8\u3044\u3066\u3042\u308b\u3002\nhttps://github.com/docker/docker-registry\nDis\uff5e\nhttps://github.com/docker/distribution\nhttps://docs.docker.com/registry/\nDockerHub\u306f\u2193\nhttps://hub.docker.com/r/distribution/registry/\n\u7c73\u30b3\u30f3\u30c6\u30ca\u4e0a\u3067\u52d5\u4f5c\u3059\u308bRegistry\u3060\u3051\u3058\u3083\u306a\u304f\u3066\u3001yum install\u3067\u304d\u308bdocker registry\u3082\u3042\u308b\u307f\u305f\u3044\u3002\n# yum -y update\n# yum list docker\n 1.8.2\uff5e\u3063\u3066\u51fa\u3066\u305f\n# yum -y install docker\n$ systemctl start docker\n\n\u4e00\u822c\u30e6\u30fc\u30b6\u3067Docker\u3092\u8d77\u52d5\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n\u3000\u2192\u5f53\u8a72\u30e6\u30fc\u30b6\u3092docker\u30b0\u30eb\u30fc\u30d7\u306b\u6240\u5c5e\u3055\u305b\u306a\u3044\u3068\u3060\u3081\u3063\u307d\u3044\u3002\nhttp://tech.withsin.net/2015/08/19/permission-of-docker-socket/\n\u25a0docker\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\u3068dockeruser\u4f5c\u6210\n\ngroup add docker\n\nuseradd -g hoge\n\n\n\u25a0dockerRegistry\u8a2d\u7f6e\n/home/hoge/registry\u3000\u306bprivate registry\u306e\u6c38\u7d9a\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u3002(\u30b3\u30f3\u30c6\u30ca\u306b\u30c7\u30fc\u30bf\u5165\u308c\u3063\u3071\u306b\u3057\u3068\u304f\u3068\u3001\u30b3\u30f3\u30c6\u30ca\u7834\u68c4\u3057\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30c7\u30fc\u30bf\u3082\u6d88\u3048\u308b)\n\nsu - hoge\n\n$ mkdir registry\n$ systemctl start docker\n$ docker run -d -p 5000:5000 -v /home/hoge/registry:/var/lib/registry --name=my-registry registry:2\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES\nd0e5b9df6428        registry:2          \"/bin/registry /etc/d\"   9 seconds ago       Up 7 seconds        0.0.0.0:5000->5000/tcp   my-registry\n$ docker pull busybox\n$ docker tag busybox localhost:5000/busybox\n$ docker push localhost:5000/busybox\nThe push refers to a repository localhost:5000/busybox\nSending image list\nError: Status 503 trying to push repository busybox: \"{\\\"errors\\\":[{\\\"code\\\":\\\"UNAVAILABLE\\\",\\\"message\\\":\\\"service unavailable\\\",\\\"detail\\\":\\\"health check failed: please see /debug/health\\\"}]}\\n\"\n\n\n503\u304c\u8fd4\u3063\u3066\u304d\u305f\u3002\n\n\u6c17\u4ed8\u3044\u305f\u3053\u3068\u3092\u3069\u3093\u3069\u3093\u8ffd\u8a18\u3057\u3066\u3044\u304f\u3002\n\u81ea\u5206\u7528\u30e1\u30e2\u306a\u306e\u3067\u3001\u30bf\u30b0\u304b\u3089Docker\u306a\u3069\u3092\u524a\u9664\u3002\n\u81ea\u5206\u7528\u30e1\u30e2\n\u30de\u30fc\u30af\u30c0\u30a6\u30f3\u66f8\u304d\u65b9\u308f\u304b\u3093\u306a\u3044(Redmine\u98a8\u306b\u66f8\u3051\u3070\u3044\u3044\u306e\u304b\u3057\u3089\uff1f)\n\u3068\u308a\u3042\u3048\u305a\u3001\u5f8c\u3067\u6574\u5f62\u3057\u3088\u3046\u3002\n\nCentOS7\u4e0a\u306bDocker1.8.2\u3092\u5165\u308c\u3066\u3001DockerRegistry\u3092\u4f5c\u308d\u3046\u3068\u601d\u3063\u305f\u3002\n\u3057\u304b\u3057\u3001DockerRegistry\u306f\u975e\u63a8\u5968\u306b\u306a\u3063\u305f\uff1f\u3088\u3046\u306a\u96f0\u56f2\u6c17\u3092\u91b8\u3057\u51fa\u3057\u3066\u308b\u3088\u3046\u306a\u30fb\u30fb\u30fb\n\u9055\u3046\u304b\u3001DockerRegistry\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u304c\u975e\u63a8\u5968\u306b\u306a\u3063\u305f\u306e\u304b\u3002\n\nDistribution\u4f7f\u3048\u3063\u3066gitHub\u306b\u66f8\u3044\u3066\u3042\u308b\u3002\nhttps://github.com/docker/docker-registry\n\nDis\uff5e\nhttps://github.com/docker/distribution\nhttps://docs.docker.com/registry/\n\nDockerHub\u306f\u2193\nhttps://hub.docker.com/r/distribution/registry/\n\n\u7c73\u30b3\u30f3\u30c6\u30ca\u4e0a\u3067\u52d5\u4f5c\u3059\u308bRegistry\u3060\u3051\u3058\u3083\u306a\u304f\u3066\u3001yum install\u3067\u304d\u308bdocker registry\u3082\u3042\u308b\u307f\u305f\u3044\u3002\n\n<pre>\n# yum -y update\n# yum list docker\n 1.8.2\uff5e\u3063\u3066\u51fa\u3066\u305f\n# yum -y install docker\n$ systemctl start docker\n</pre>\n\n\u4e00\u822c\u30e6\u30fc\u30b6\u3067Docker\u3092\u8d77\u52d5\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n\u3000\u2192\u5f53\u8a72\u30e6\u30fc\u30b6\u3092docker\u30b0\u30eb\u30fc\u30d7\u306b\u6240\u5c5e\u3055\u305b\u306a\u3044\u3068\u3060\u3081\u3063\u307d\u3044\u3002\nhttp://tech.withsin.net/2015/08/19/permission-of-docker-socket/\n\n\u25a0docker\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\u3068dockeruser\u4f5c\u6210\n<pre>\n# group add docker\n# useradd -g hoge\n</pre>\n\n\u25a0dockerRegistry\u8a2d\u7f6e\n/home/hoge/registry\u3000\u306bprivate registry\u306e\u6c38\u7d9a\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u3002(\u30b3\u30f3\u30c6\u30ca\u306b\u30c7\u30fc\u30bf\u5165\u308c\u3063\u3071\u306b\u3057\u3068\u304f\u3068\u3001\u30b3\u30f3\u30c6\u30ca\u7834\u68c4\u3057\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30c7\u30fc\u30bf\u3082\u6d88\u3048\u308b)\n<pre>\n# su - hoge\n$ mkdir registry\n$ systemctl start docker\n$ docker run -d -p 5000:5000 -v /home/hoge/registry:/var/lib/registry --name=my-registry registry:2\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES\nd0e5b9df6428        registry:2          \"/bin/registry /etc/d\"   9 seconds ago       Up 7 seconds        0.0.0.0:5000->5000/tcp   my-registry\n$ docker pull busybox\n$ docker tag busybox localhost:5000/busybox\n$ docker push localhost:5000/busybox\nThe push refers to a repository [localhost:5000/busybox] (len: 1)\nSending image list\nError: Status 503 trying to push repository busybox: \"{\\\"errors\\\":[{\\\"code\\\":\\\"UNAVAILABLE\\\",\\\"message\\\":\\\"service unavailable\\\",\\\"detail\\\":\\\"health check failed: please see /debug/health\\\"}]}\\n\"\n\n</pre>\n503\u304c\u8fd4\u3063\u3066\u304d\u305f\u3002\n\n\n\u6c17\u4ed8\u3044\u305f\u3053\u3068\u3092\u3069\u3093\u3069\u3093\u8ffd\u8a18\u3057\u3066\u3044\u304f\u3002\n\n\u81ea\u5206\u7528\u30e1\u30e2\u306a\u306e\u3067\u3001\u30bf\u30b0\u304b\u3089Docker\u306a\u3069\u3092\u524a\u9664\u3002\n", "tags": ["\u81ea\u5206\u7528\u30e1\u30e2"]}