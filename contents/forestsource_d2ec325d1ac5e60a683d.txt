{"context": " More than 1 year has passed since last update.\n\n\u51e6\u7406\u3092\u307f\u308b\nhttp://www.decompileandroid.com/\n\u3053\u3053\u3067apk\u3092\u30bd\u30fc\u30bd\u30b3\u30fc\u30c9\u306b\u76f4\u3059\u4e8b\u304c\u3067\u304d\u308b\nsource->src->com->example->seccon2015->rock_paper_scissors\n\nMainActivity.java(59~)\n if (1000 == cnt)\n   {\n                textview.setText((new StringBuilder()).append(\"SECCON{\").append(String.valueOf((cnt + calc()) * 107)).append(\"}\").toString());\n   }\n\n\n\n\u3053\u3053\u304c\u30d5\u30e9\u30b0\u3092\u51fa\u529b\u3059\u308b\u51e6\u7406\u3067\u3042\u308b\u3068\u5206\u304b\u308b\u3002\n\nMainActivity.java(73~)\n public MainActivity()\n   {\n        cnt = 0;\n   }\n\n\ncnt\u306e\u521d\u671f\u5024\u304c0\u3067\u3042\u308b\u4e8b\u304c\u5206\u304b\u308b\u3002\n\n\u65b9\u5411\u6027\n\u30d5\u30e9\u30b0\u8868\u793a\u6761\u4ef6\u306fcnt\u304c1000\n\u3088\u3063\u3066\u3001\u3053\u306e\u5909\u6570\u306e\u521d\u671f\u5024\u3092999\u306b\u3057\u30661\u56de\u304b\u3066\u3070\u30d5\u30e9\u30b0\u304c\u51fa\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\napk\u306e\u66f8\u304d\u63db\u3048\napktool\u3092\u4f7f\u3046\nhttp://ibotpeaches.github.io/Apktool/\n$ apktool rps.apk\n$ vim rps/smail//com/example/seccon2015/rock_paper_scissors\n\n14\u884c\u76ee\u306b .field cnt:I\u3068\u3042\u308b\u3002\n53\u884c\u76ee\u306b\niput v0, p0, Lcom/example/seccon2015/rock_paper_scissors/MainActivity;->cnt:I\n\u3068\u3042\u308b\u305f\u3081\u3001\u3053\u3053\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u5909\u6570\u3092999\u306b\u3059\u308c\u3070\u3088\u3044\u3002 \n.line 15\nconst/4 v0, 0x00\niput v0, p0, Lcom/example/seccon2015/rock_paper_scissors/MainActivity;->cnt:I\n\n\u3053\u308c\u3092\u4e0b\u8a18\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\n.line 15\nconst v5, 0x3E8\niput v5, p0, Lcom/example/seccon2015/rock_paper_scissors/MainActivity;->cnt:I\n\nsmail\u306e\u6587\u6cd5\u306f\u3053\u3053\u3092\u898b\u308c\u3070\u5206\u304b\u308b\u3002\nhttp://stpr18.blogspot.jp/\n$ apktool b rps\n$ ls rps/dist/rps.apk\n\n\u3053\u308c\u304c\u3042\u305f\u3089\u3057\u304f\u3067\u304d\u305fapk\u30d5\u30a1\u30a4\u30eb\u3068\u306a\u308b\u3002\n\n\u7f72\u540d\n\u3053\u308c\u3092\u5b9f\u969b\u306b\u52d5\u304b\u305d\u3046\u3068\u3059\u308b\u3068\u3001\u7f72\u540d\u304c\u306a\u3044\u3068\u304b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u3002\n\u3053\u3053\u3092\u53c2\u8003\u306b\u7f72\u540d\u3092\u3059\u308b\u3002\nAndroid \u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u306b\u7f72\u540d\u3092\u884c\u3046\n$ keytool -genkey\n...\n... #alias\u3092\u805e\u304b\u308c\u308b\u304b\u3089\u899a\u3048\u3066\u304a\u304f\n$ keytool -list #\u9375\u304c\u3042\u308b\u304b\u78ba\u8a8d\u3059\u308b\n$ jarsigner rps.apk \"\u3055\u3063\u304d\u306ealias\"\n\u30ad\u30fc\u30b9\u30c8\u30a2\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044:\njar\u306f\u7f72\u540d\u3055\u308c\u307e\u3057\u305f\u3002\nkeytool rps/dist/rps.apk hoge\n\n\u3053\u308c\u3067\u7f72\u540d\u7d42\u4e86\n\u3042\u3068\u306f\u3053\u308c\u3092\u5b9f\u6a5f\u306a\u308agenymotion\u3067\u8d77\u52d5\u3057\u3066\u30011\u56de\u52dd\u3066\u3070\u30d5\u30e9\u30b0\u304c\u51fa\u308b\n\n## \u51e6\u7406\u3092\u307f\u308b\nhttp://www.decompileandroid.com/\n\u3053\u3053\u3067apk\u3092\u30bd\u30fc\u30bd\u30b3\u30fc\u30c9\u306b\u76f4\u3059\u4e8b\u304c\u3067\u304d\u308b\n\nsource->src->com->example->seccon2015->rock_paper_scissors\n\n\n```MainActivity.java(59~)\n if (1000 == cnt)\n   {\n                textview.setText((new StringBuilder()).append(\"SECCON{\").append(String.valueOf((cnt + calc()) * 107)).append(\"}\").toString());\n   }\n\n```\n\u3053\u3053\u304c\u30d5\u30e9\u30b0\u3092\u51fa\u529b\u3059\u308b\u51e6\u7406\u3067\u3042\u308b\u3068\u5206\u304b\u308b\u3002\n\n```MainActivity.java(73~)\n public MainActivity()\n   {\n        cnt = 0;\n   }\n```\n\ncnt\u306e\u521d\u671f\u5024\u304c0\u3067\u3042\u308b\u4e8b\u304c\u5206\u304b\u308b\u3002\n\n\n## \u65b9\u5411\u6027\n\u30d5\u30e9\u30b0\u8868\u793a\u6761\u4ef6\u306fcnt\u304c1000\n\u3088\u3063\u3066\u3001\u3053\u306e\u5909\u6570\u306e\u521d\u671f\u5024\u3092999\u306b\u3057\u30661\u56de\u304b\u3066\u3070\u30d5\u30e9\u30b0\u304c\u51fa\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n## apk\u306e\u66f8\u304d\u63db\u3048\n\napktool\u3092\u4f7f\u3046\n\nhttp://ibotpeaches.github.io/Apktool/\n\n```sh\n$ apktool rps.apk\n$ vim rps/smail//com/example/seccon2015/rock_paper_scissors\n```\n\n14\u884c\u76ee\u306b `.field cnt:I`\u3068\u3042\u308b\u3002\n53\u884c\u76ee\u306b\n`iput v0, p0, Lcom/example/seccon2015/rock_paper_scissors/MainActivity;->cnt:I`\n\n\u3068\u3042\u308b\u305f\u3081\u3001\u3053\u3053\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u5909\u6570\u3092999\u306b\u3059\u308c\u3070\u3088\u3044\u3002 \n\n```\n.line 15\nconst/4 v0, 0x00\niput v0, p0, Lcom/example/seccon2015/rock_paper_scissors/MainActivity;->cnt:I\n\n\u3053\u308c\u3092\u4e0b\u8a18\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\n.line 15\nconst v5, 0x3E8\niput v5, p0, Lcom/example/seccon2015/rock_paper_scissors/MainActivity;->cnt:I\n```\n\nsmail\u306e\u6587\u6cd5\u306f\u3053\u3053\u3092\u898b\u308c\u3070\u5206\u304b\u308b\u3002\nhttp://stpr18.blogspot.jp/\n\n```\n$ apktool b rps\n$ ls rps/dist/rps.apk\n```\n\u3053\u308c\u304c\u3042\u305f\u3089\u3057\u304f\u3067\u304d\u305fapk\u30d5\u30a1\u30a4\u30eb\u3068\u306a\u308b\u3002\n\n\n## \u7f72\u540d\n\u3053\u308c\u3092\u5b9f\u969b\u306b\u52d5\u304b\u305d\u3046\u3068\u3059\u308b\u3068\u3001\u7f72\u540d\u304c\u306a\u3044\u3068\u304b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u3002\n\u3053\u3053\u3092\u53c2\u8003\u306b\u7f72\u540d\u3092\u3059\u308b\u3002\n[Android \u4f5c\u6210\u3057\u305f\u30a2\u30d7\u30ea\u306b\u7f72\u540d\u3092\u884c\u3046](http://blue-red.ddo.jp/~ao/wiki/wiki.cgi?page=Android+%BA%EE%C0%AE%A4%B7%A4%BF%A5%A2%A5%D7%A5%EA%A4%CB%BD%F0%CC%BE%A4%F2%B9%D4%A4%A6)\n\n```sh\n$ keytool -genkey\n...\n... #alias\u3092\u805e\u304b\u308c\u308b\u304b\u3089\u899a\u3048\u3066\u304a\u304f\n$ keytool -list #\u9375\u304c\u3042\u308b\u304b\u78ba\u8a8d\u3059\u308b\n$ jarsigner rps.apk \"\u3055\u3063\u304d\u306ealias\"\n\u30ad\u30fc\u30b9\u30c8\u30a2\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044:\njar\u306f\u7f72\u540d\u3055\u308c\u307e\u3057\u305f\u3002\nkeytool rps/dist/rps.apk hoge\n```\n\n\u3053\u308c\u3067\u7f72\u540d\u7d42\u4e86\n\n\u3042\u3068\u306f\u3053\u308c\u3092\u5b9f\u6a5f\u306a\u308agenymotion\u3067\u8d77\u52d5\u3057\u3066\u30011\u56de\u52dd\u3066\u3070\u30d5\u30e9\u30b0\u304c\u51fa\u308b\n\n", "tags": ["CTF", "seccon"]}