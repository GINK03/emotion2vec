{"tags": ["Unity3D", "\u30b7\u30a7\u30fc\u30c0\u30fc"], "context": "\n\n\u306f\u3058\u3081\u306b\n\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u3092\u4f7f\u3063\u3066\u96e8\u3092\u63cf\u753b\u3055\u305b\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30b5\u30f3\u30d7\u30eb\n\n\u8b1d\u8f9e\n\u4eca\u56de\u306e\u8a18\u4e8b\u3092\u66f8\u304f\u306b\u3042\u305f\u3063\u3066\u3001\u4ee5\u4e0b\u306e\u30b9\u30e9\u30a4\u30c9\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002 \nPLAYDEAD\u3055\u3093\u306b\u611f\u8b1d\uff01\nhttps://docs.google.com/presentation/d/1_JHp-k4bDc9WhcMlC9hAPSGj_0UaJh5DBpSlLkwI74M/mobilepresent?slide=id.g5dea027fa_0375\n\n\n0. \u96e8\u3092\u63cf\u753b\u3059\u308b\u307e\u3067\u306e\u7c21\u5358\u306a\u6d41\u308c\n\u4e09\u89d2\u5f62\u3092\u5927\u91cf\u306b\u51fa\u3059 -> \u4e71\u6570\u3092\u4f7f\u3063\u3066\u4e09\u89d2\u5f62\u3092\u9ad8\u901f\u306b\u63fa\u3089\u3059 -> \u96e8\u3063\u307d\u304f\u898b\u3048\u308b\n\n1. \u4e09\u89d2\u5f62\u3092\u5927\u91cf\u306b\u751f\u6210\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u9069\u5f53\u306aGameObject\u306b\u30a2\u30bf\u30c3\u30c1\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nProcedualRandomMesh.cs\nusing UnityEngine;\nusing System.Collections.Generic;\n\n[RequireComponent(typeof(MeshRenderer))]\n[RequireComponent(typeof(MeshFilter))]\npublic class ProcedualRandomMesh : MonoBehaviour\n{\n    // \u4e09\u89d2\u5f62\u306e\u500b\u6570\n    private int triangleCount = 1500;\n\n    // \u4e09\u89d2\u5f62\u306e\u5927\u304d\u3055\n    private float triangleScale = 0.002f;\n\n    // \u30e1\u30c3\u30b7\u30e5\u306e\u5927\u304d\u3055\n    private Vector3 meshScale = new Vector3(4f, 4f, 4f);\n\n    private void Start()\n    {\n        this.Initialize();\n    }\n\n    /// <summary>\n    /// \u521d\u671f\u5316 \n    /// </summary>\n    public void Initialize()\n    {\n        var vertices = new List<Vector3>();\n        var triangles = new List<int>();\n        int pos = 0;\n        for (int i = 0; i < this.triangleCount; i++)\n        {\n            var v1 = Vector3.Scale(new Vector3(Random.value, Random.value, Random.value) - Vector3.one * 0.5f, this.meshScale);\n            var v2 = v1 + new Vector3(Random.value - 0.5f, 0f, Random.value - 0.5f) * triangleScale;\n            var v3 = v1 + new Vector3(Random.value - 0.5f, 0f, Random.value - 0.5f) * triangleScale;\n\n            vertices.Add(v1);\n            vertices.Add(v2);\n            vertices.Add(v3);\n\n            triangles.Add(pos + 0);\n            triangles.Add(pos + 1);\n            triangles.Add(pos + 2);\n            pos += 3;\n        }\n\n        //\u30e1\u30c3\u30b7\u30e5\u751f\u6210\n        var mesh = new Mesh();\n        mesh.vertices = vertices.ToArray();\n        mesh.triangles = triangles.ToArray();\n\n        var meshFilter = this.GetComponent<MeshFilter>();\n        meshFilter.mesh = mesh;\n    }\n\n}\n\n\n\u6c7a\u3081\u3089\u308c\u305f\u9818\u57df\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306a\u5ea7\u6a19\u3092\u3068\u3063\u3066\u4e09\u89d2\u5f62\u3092\u5927\u91cf\u306b\u751f\u6210\u3002\n\u6700\u5f8c\u306b\u305d\u308c\u3089\u5168\u3066\u306e\u4e09\u89d2\u5f62\u30921\u3064\u306e\u30e1\u30c3\u30b7\u30e5\u306b\u307e\u3068\u3081\u3066\u3044\u307e\u3059\u3002\n\n2. \u96e8\u3063\u307d\u3044\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u3059\u308b\u30b7\u30a7\u30fc\u30c0\u30fc\n\u4ee5\u4e0b\u306e\u30b7\u30a7\u30fc\u30c0\u30fc\u3092ProcedualRandomMesh.cs\u304c\u30a2\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308bGameObject\u306b\u30a2\u30bf\u30c3\u30c1\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nrain.shader\n// \u53c2\u8003URL\n// https://docs.google.com/presentation/d/1_JHp-k4bDc9WhcMlC9hAPSGj_0UaJh5DBpSlLkwI74M/mobilepresent?slide=id.g5dea027fa_0375\nShader \"Custom/Rain\" {\n    Properties {\n        _MainTex (\"Base (RGB)\", 2D) = \"white\" {}\n        _Color (\"Color\", Color) = (0,0,0,1.0) // \u96e8\u306e\u8272\n        _Speed (\"Speed\", Float) = 6.0 \n        _Scale (\"Scale\", Float) = 4.0\n    }\n    SubShader {\n        Tags {\n            \"Queue\" = \"Transparent\"\n            \"RenderType\" = \"Transparent\"\n        }\n        CGPROGRAM\n        #pragma surface surf Lambert alpha\n        #pragma vertex vert\n\n        sampler2D _MainTex;\n\n        // [0;1]\u306e\u30e9\u30f3\u30c0\u30e0\u306a\u5024\u3092\u8fd4\u3059\u95a2\u6570\n        float nhash11(float n){\n            return frac(sin(n) * 43758.5453);\n        }\n\n        // \u5024\u57df[a;b] \u3092 \u5024\u57df[0;1]\u3078\u5909\u63db\u3059\u308b\u95a2\u6570\n        float remap(float t, float a, float b){\n            return clamp((t-a)/(b-a), 0, 1);\n        }\n\n        fixed4 _Color;\n        half _Speed;\n        half _Scale;\n\n        // \u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u95a2\u6570\n        void vert(inout appdata_full v) {\n            fixed rnd = nhash11(fmod(v.vertex.z, 512.0));\n            float timer = _Time.w * _Speed * remap(0.7, 1.0, rnd);\n            v.vertex.y -= fmod(-v.vertex.y + timer, _Scale) + v.vertex.y - _Scale * 0.5;\n        }\n\n        struct Input {\n            float2 uv_MainTex;\n        };\n\n        void surf(Input IN, inout SurfaceOutput o) {\n            half4 c = tex2D(_MainTex, IN.uv_MainTex);\n            o.Albedo = c.rgb * _Color.rgb;\n            o.Alpha  = _Color.a;\n        }\n        ENDCG\n    }\n}\n\n\n\u96e8\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306f\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u95a2\u6570\u306e\u4e2d\u3067\u884c\u3063\u3066\u3044\u307e\u3059\u3002\nfixed rnd = nhash11(fmod(v.vertex.z, 512.0));\nfloat timer = _Time.w * _Speed * remap(0.7, 1.0, rnd);\nv.vertex.y -= fmod(-v.vertex.y + timer, _Scale) + v.vertex.y - _Scale * 0.5;\n\n\n3. \u52d5\u304b\u3059\n\u4e0a\u8a18\u3092\u5b9f\u884c\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u63cf\u753b\u3055\u308c\u307e\u3059\u3002\n\u96e8\u306e\u843d\u3061\u65b9\u306b\u504f\u308a\u304c\u3042\u3063\u3066\u3061\u3087\u3063\u3068\u6b8b\u5ff5\u306a\u611f\u3058\u3002\n\n\n4. \u96e8\u3092\u4e71\u6570\u3067\u63fa\u3089\u3059\n\u96e8\u3092\u4e71\u6570\u3067\u63fa\u3089\u3057\u3066\u307f\u307e\u3059\u3002\nProcedualRandomMesh.cs \u3078\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\nprivate float randomness = 0.1f;\nvoid Update()\n{\n    this.transform.position = new Vector3(Random.value, 0f, Random.value) * randomness;\n}\n\n\n\u7d50\u679c\n\n\u3044\u3044\u611f\u3058\u306b\u30d0\u30e9\u3064\u3044\u3066\u304f\u308c\u307e\u3057\u305f\u3002\n\n5. \u5b8c\u6210\n\u96e8\u306e\u8272\u306e\u30a2\u30eb\u30d5\u30a1\u5024\u3092\u4e0b\u3052\u3066\u5b8c\u6210\uff01\n\n\u96e8\u306e\u8272\u3092\u767d\u304f\u3057\u3066\u3082\u9762\u767d\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n#\u306f\u3058\u3081\u306b\n\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u3092\u4f7f\u3063\u3066\u96e8\u3092\u63cf\u753b\u3055\u305b\u3066\u307f\u307e\u3057\u305f\u3002\n<img width = 480 src = \"https://qiita-image-store.s3.amazonaws.com/0/44288/7d862aba-4513-77b5-cb33-4deb0a4e063e.gif\">\n\n<a href = \"https://github.com/rngtm/unity-sample-rain\">\u30b5\u30f3\u30d7\u30eb</a>\n\n\n#\u8b1d\u8f9e\n\u4eca\u56de\u306e\u8a18\u4e8b\u3092\u66f8\u304f\u306b\u3042\u305f\u3063\u3066\u3001\u4ee5\u4e0b\u306e\u30b9\u30e9\u30a4\u30c9\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002 \n**PLAYDEAD\u3055\u3093\u306b\u611f\u8b1d\uff01**\nhttps://docs.google.com/presentation/d/1_JHp-k4bDc9WhcMlC9hAPSGj_0UaJh5DBpSlLkwI74M/mobilepresent?slide=id.g5dea027fa_0375\n<img width = 380 src = \"https://qiita-image-store.s3.amazonaws.com/0/44288/a1809f95-bcc1-0151-9ec8-b3ae794aeb4a.png\">\n\n#0. \u96e8\u3092\u63cf\u753b\u3059\u308b\u307e\u3067\u306e\u7c21\u5358\u306a\u6d41\u308c\n\n\u4e09\u89d2\u5f62\u3092\u5927\u91cf\u306b\u51fa\u3059 -> \u4e71\u6570\u3092\u4f7f\u3063\u3066\u4e09\u89d2\u5f62\u3092\u9ad8\u901f\u306b\u63fa\u3089\u3059 -> **\u96e8\u3063\u307d\u304f\u898b\u3048\u308b**\n\n#1. \u4e09\u89d2\u5f62\u3092\u5927\u91cf\u306b\u751f\u6210\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u9069\u5f53\u306aGameObject\u306b\u30a2\u30bf\u30c3\u30c1\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```ProcedualRandomMesh.cs\nusing UnityEngine;\nusing System.Collections.Generic;\n\n[RequireComponent(typeof(MeshRenderer))]\n[RequireComponent(typeof(MeshFilter))]\npublic class ProcedualRandomMesh : MonoBehaviour\n{\n    // \u4e09\u89d2\u5f62\u306e\u500b\u6570\n    private int triangleCount = 1500;\n\n    // \u4e09\u89d2\u5f62\u306e\u5927\u304d\u3055\n    private float triangleScale = 0.002f;\n\n    // \u30e1\u30c3\u30b7\u30e5\u306e\u5927\u304d\u3055\n    private Vector3 meshScale = new Vector3(4f, 4f, 4f);\n\n    private void Start()\n    {\n        this.Initialize();\n    }\n\n    /// <summary>\n    /// \u521d\u671f\u5316 \n    /// </summary>\n    public void Initialize()\n    {\n        var vertices = new List<Vector3>();\n        var triangles = new List<int>();\n        int pos = 0;\n        for (int i = 0; i < this.triangleCount; i++)\n        {\n            var v1 = Vector3.Scale(new Vector3(Random.value, Random.value, Random.value) - Vector3.one * 0.5f, this.meshScale);\n            var v2 = v1 + new Vector3(Random.value - 0.5f, 0f, Random.value - 0.5f) * triangleScale;\n            var v3 = v1 + new Vector3(Random.value - 0.5f, 0f, Random.value - 0.5f) * triangleScale;\n\n            vertices.Add(v1);\n            vertices.Add(v2);\n            vertices.Add(v3);\n\n            triangles.Add(pos + 0);\n            triangles.Add(pos + 1);\n            triangles.Add(pos + 2);\n            pos += 3;\n        }\n\n        //\u30e1\u30c3\u30b7\u30e5\u751f\u6210\n        var mesh = new Mesh();\n        mesh.vertices = vertices.ToArray();\n        mesh.triangles = triangles.ToArray();\n\n        var meshFilter = this.GetComponent<MeshFilter>();\n        meshFilter.mesh = mesh;\n    }\n\n}\n```\n\u6c7a\u3081\u3089\u308c\u305f\u9818\u57df\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306a\u5ea7\u6a19\u3092\u3068\u3063\u3066\u4e09\u89d2\u5f62\u3092\u5927\u91cf\u306b\u751f\u6210\u3002\n\u6700\u5f8c\u306b\u305d\u308c\u3089\u5168\u3066\u306e\u4e09\u89d2\u5f62\u30921\u3064\u306e\u30e1\u30c3\u30b7\u30e5\u306b\u307e\u3068\u3081\u3066\u3044\u307e\u3059\u3002\n\n\n#2. \u96e8\u3063\u307d\u3044\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u3059\u308b\u30b7\u30a7\u30fc\u30c0\u30fc\n\u4ee5\u4e0b\u306e\u30b7\u30a7\u30fc\u30c0\u30fc\u3092```ProcedualRandomMesh.cs```\u304c\u30a2\u30bf\u30c3\u30c1\u3055\u308c\u3066\u3044\u308bGameObject\u306b\u30a2\u30bf\u30c3\u30c1\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```rain.shader\n// \u53c2\u8003URL\n// https://docs.google.com/presentation/d/1_JHp-k4bDc9WhcMlC9hAPSGj_0UaJh5DBpSlLkwI74M/mobilepresent?slide=id.g5dea027fa_0375\nShader \"Custom/Rain\" {\n    Properties {\n        _MainTex (\"Base (RGB)\", 2D) = \"white\" {}\n        _Color (\"Color\", Color) = (0,0,0,1.0) // \u96e8\u306e\u8272\n        _Speed (\"Speed\", Float) = 6.0 \n        _Scale (\"Scale\", Float) = 4.0\n    }\n    SubShader {\n        Tags {\n            \"Queue\" = \"Transparent\"\n            \"RenderType\" = \"Transparent\"\n        }\n        CGPROGRAM\n        #pragma surface surf Lambert alpha\n        #pragma vertex vert\n\n        sampler2D _MainTex;\n\n        // [0;1]\u306e\u30e9\u30f3\u30c0\u30e0\u306a\u5024\u3092\u8fd4\u3059\u95a2\u6570\n        float nhash11(float n){\n            return frac(sin(n) * 43758.5453);\n        }\n\n        // \u5024\u57df[a;b] \u3092 \u5024\u57df[0;1]\u3078\u5909\u63db\u3059\u308b\u95a2\u6570\n        float remap(float t, float a, float b){\n            return clamp((t-a)/(b-a), 0, 1);\n        }\n\n        fixed4 _Color;\n        half _Speed;\n        half _Scale;\n\n        // \u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u95a2\u6570\n        void vert(inout appdata_full v) {\n            fixed rnd = nhash11(fmod(v.vertex.z, 512.0));\n            float timer = _Time.w * _Speed * remap(0.7, 1.0, rnd);\n            v.vertex.y -= fmod(-v.vertex.y + timer, _Scale) + v.vertex.y - _Scale * 0.5;\n        }\n\n        struct Input {\n            float2 uv_MainTex;\n        };\n\n        void surf(Input IN, inout SurfaceOutput o) {\n            half4 c = tex2D(_MainTex, IN.uv_MainTex);\n            o.Albedo = c.rgb * _Color.rgb;\n            o.Alpha  = _Color.a;\n        }\n        ENDCG\n    }\n}\n```\n\n\u96e8\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306f\u9802\u70b9\u30b7\u30a7\u30fc\u30c0\u30fc\u95a2\u6570\u306e\u4e2d\u3067\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\n```glsl\nfixed rnd = nhash11(fmod(v.vertex.z, 512.0));\nfloat timer = _Time.w * _Speed * remap(0.7, 1.0, rnd);\nv.vertex.y -= fmod(-v.vertex.y + timer, _Scale) + v.vertex.y - _Scale * 0.5;\n```\n\n#3. \u52d5\u304b\u3059\n\u4e0a\u8a18\u3092\u5b9f\u884c\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u63cf\u753b\u3055\u308c\u307e\u3059\u3002\n\n\u96e8\u306e\u843d\u3061\u65b9\u306b\u504f\u308a\u304c\u3042\u3063\u3066\u3061\u3087\u3063\u3068\u6b8b\u5ff5\u306a\u611f\u3058\u3002\n![rain_noRandom.gif](https://qiita-image-store.s3.amazonaws.com/0/44288/4be57239-b38b-c952-ea22-6f2668dbec92.gif)\n\n#4. \u96e8\u3092\u4e71\u6570\u3067\u63fa\u3089\u3059\n\u96e8\u3092\u4e71\u6570\u3067\u63fa\u3089\u3057\u3066\u307f\u307e\u3059\u3002\n```ProcedualRandomMesh.cs``` \u3078\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\n\n```csharp\nprivate float randomness = 0.1f;\nvoid Update()\n{\n    this.transform.position = new Vector3(Random.value, 0f, Random.value) * randomness;\n}\n```\n\n#### \u7d50\u679c\n![rain_random.gif](https://qiita-image-store.s3.amazonaws.com/0/44288/e33958a3-3900-7418-efa8-c61c21ebf302.gif)\n\u3044\u3044\u611f\u3058\u306b\u30d0\u30e9\u3064\u3044\u3066\u304f\u308c\u307e\u3057\u305f\u3002\n\n#5. \u5b8c\u6210\n\u96e8\u306e\u8272\u306e\u30a2\u30eb\u30d5\u30a1\u5024\u3092\u4e0b\u3052\u3066\u5b8c\u6210\uff01\n![rain_small_alpha.gif](https://qiita-image-store.s3.amazonaws.com/0/44288/e628068f-7dcf-91a9-4336-58ded3a0c54b.gif)\n\n\u96e8\u306e\u8272\u3092\u767d\u304f\u3057\u3066\u3082\u9762\u767d\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n![rain_small_white.gif](https://qiita-image-store.s3.amazonaws.com/0/44288/9e762c3f-634d-9a7a-defd-a170ce998a5a.gif)\n"}