{"context": " More than 1 year has passed since last update.\n\u52d5\u4f5c\u78ba\u8a8d\nC++ Builder XE4\n\n\nhttp://qiita.com/AinoMegumi/items/f46dc3f6da4bb62e622e\n\u306b\u3066\u8a66\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u8208\u5473\u3092\u5f15\u3044\u305f\u306e\u3067\u5b9f\u88c5\u3057\u3066\u307f\u305f\u3002\n\nUnit1.cpp\n#include <Windows.h>\n#include <iostream>\n#include <LM.h>\n#pragma comment(lib, \"netapi32.lib\")\n\n...\n\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\n    PVOID pv;\n    DWORD n, i = 0, err;\n    do\n    {\n        switch (err = NetQueryDisplayInformation(0, 1, i, MAXDWORD, MAX_PREFERRED_LENGTH, &n, &pv))\n        {\n        case 0:\n        case ERROR_MORE_DATA:\n            if (n)\n            {\n                PNET_DISPLAY_USER p = (PNET_DISPLAY_USER)pv;\n\n                do\n                {\n                    i = p->usri1_next_index;\n                    OutputDebugString(p->usri1_name);\n                } while (p++, --n);\n            }\n            NetApiBufferFree(pv);\n            break;\n        }\n    } while (err == ERROR_MORE_DATA);\n\n}\n//---------------------------------------------------------------------------\n\n\n\n\u7d50\u679c\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: Administrator \u30d7\u30ed\u30bb\u30b9 Project1.exe\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: Guest \u30d7\u30ed\u30bb\u30b9 Project1.exe\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: [\u81ea\u5206\u306e\u30e6\u30fc\u30b6\u540d] \u30d7\u30ed\u30bb\u30b9 Project1.exe\n...\n\n\n\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u306fC++ Builder\u3068\u3044\u3046\u3088\u308aWin32API\u3068\u3044\u3046\u3082\u306e\u306a\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\nDelphi\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306b\u3042\u308b\u304c\u3001\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u306e\u65b9\u304c\u8aad\u307f\u3084\u3059\u3044\u3002\nhttp://stackoverflow.com/questions/27689479/delphi-list-all-windows-users-logged-on-a-computer\n```txt:\u52d5\u4f5c\u78ba\u8a8d\nC++ Builder XE4\n```\n\nhttp://qiita.com/AinoMegumi/items/f46dc3f6da4bb62e622e\n\u306b\u3066\u8a66\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u8208\u5473\u3092\u5f15\u3044\u305f\u306e\u3067\u5b9f\u88c5\u3057\u3066\u307f\u305f\u3002\n\n```Unit1.cpp\n#include <Windows.h>\n#include <iostream>\n#include <LM.h>\n#pragma comment(lib, \"netapi32.lib\")\n\n...\n\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\n\tPVOID pv;\n\tDWORD n, i = 0, err;\n    do\n    {\n        switch (err = NetQueryDisplayInformation(0, 1, i, MAXDWORD, MAX_PREFERRED_LENGTH, &n, &pv))\n        {\n        case 0:\n        case ERROR_MORE_DATA:\n            if (n)\n            {\n                PNET_DISPLAY_USER p = (PNET_DISPLAY_USER)pv;\n\n\t\t\t\tdo\n                {\n\t\t\t\t\ti = p->usri1_next_index;\n\t\t\t\t\tOutputDebugString(p->usri1_name);\n                } while (p++, --n);\n            }\n            NetApiBufferFree(pv);\n            break;\n        }\n\t} while (err == ERROR_MORE_DATA);\n\n}\n//---------------------------------------------------------------------------\n```\n\n```txt:\u7d50\u679c\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: Administrator \u30d7\u30ed\u30bb\u30b9 Project1.exe\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: Guest \u30d7\u30ed\u30bb\u30b9 Project1.exe\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: [\u81ea\u5206\u306e\u30e6\u30fc\u30b6\u540d] \u30d7\u30ed\u30bb\u30b9 Project1.exe\n...\n```\n\n\n\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u306fC++ Builder\u3068\u3044\u3046\u3088\u308aWin32API\u3068\u3044\u3046\u3082\u306e\u306a\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\nDelphi\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306b\u3042\u308b\u304c\u3001\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u306e\u65b9\u304c\u8aad\u307f\u3084\u3059\u3044\u3002\nhttp://stackoverflow.com/questions/27689479/delphi-list-all-windows-users-logged-on-a-computer\n\n", "tags": ["cppBuilder"]}