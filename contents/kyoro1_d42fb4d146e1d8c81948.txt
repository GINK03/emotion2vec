{"tags": ["Python", "numpy", "seaborn"], "context": "\u3053\u306e\u8a18\u4e8b\u3067\u306fBox-Muller\u306e\u65b9\u6cd5\u3067N(0,1)N(0,1)\u306b\u5f93\u3046\u5909\u6570\u3092\u751f\u6210\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\nBox-Muller\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u6982\u8981\n2\u3064\u306e\u72ec\u7acb\u306a\u4e00\u69d8\u5206\u5e03\u3092U1,U2U_1, U_2\u3068\u3057\u307e\u3059\u3002\u3053\u306e\u3068\u304d\u6b21\u306eX1,X2X_1, X_2\u3067\u5b9a\u7fa9\u3055\u308c\u308b2 \u5909\u6570\u306f\u6b63\u898f\u5206\u5e03\u306b\u5f93\u3046\u3053\u3068\u304c\u77e5\u3089\u308c\u3066\u3044\u307e\u3059\uff08\u3063\u3066\u7d50\u679c\u3060\u3051\u304b\u30f2\u30a4w\uff09\n\\begin{eqnarray}\nX_1 &=& \\sqrt{-2\\log(U_1)}\\cos(2\\pi U_2) \\\\\nX_2 &=& \\sqrt{-2\\log(U_2)}\\sin(2\\pi U_1)\n\\end{eqnarray}\nX1X2==\u22122log(U1)\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u221acos(2\u03c0U2)\u22122log(U2)\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u2212\u221asin(2\u03c0U1){\\begin{eqnarray}\nX_1 &=& \\sqrt{-2\\log(U_1)}\\cos(2\\pi U_2) \\\\\nX_2 &=& \\sqrt{-2\\log(U_2)}\\sin(2\\pi U_1)\n\\end{eqnarray}\n}\n\u2192\u53f3\u8fba\u306eU1,U2U_1, U_2\u306e\u300c\u6df7\u3056\u308a\u5177\u5408\u300d\u306b\u6ce8\u610f\u3067\u3059\u306d\u30fc\u3002\n\uff08\u30b3\u30b3\u3092\u9593\u9055\u3048\u308b\u3068\u3001\u5909\u306a\u611f\u3058\u306e\u5206\u5e03\u306b\u306a\u308a\u307e\u3059w\uff09\n\n\u6e96\u5099\n\u4eca\u56de\u306fnumpy,seaborn\u3092\u4f7f\u3046\u306e\u3067\u3001\u6e96\u5099\u3057\u3068\u304d\u307e\u3057\u3087\u3002\n## preparation\nimport numpy as np\nimport seaborn as sns\n\n\nStep1: \u4e00\u69d8\u5206\u5e03\u3092\u751f\u6210\n0\u223c10\\sim 1\u306e\u9593\u306b\u5024\u3092\u3068\u308b\u95a2\u6570np.random.uniform(0,1)\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u72ec\u7acb\u306a\u4e00\u69d8\u5206\u5e03U1,U2U_1, U_2\u3092\u4f5c\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u914d\u5217\u306b\u3082\u305f\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\u4e00\u7aef\u3001sample\u6570\u309210000\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u304b\u3002\n## Sample size\nN = 10000\n## Uniform distributions\nrandom_list1 = [np.random.uniform(0,1) for i in range(N)]\nrandom_list2 = [np.random.uniform(0,1) for i in range(N)]\n\n\nStep2: \u4e00\u69d8\u3067\u3042\u308b\u3053\u3068\u306e\u78ba\u8a8d\n\u4e00\u5fdc\u3001\u3001\u3001\uff08\u305f\u3060\u306e\u76ee\u8996\u78ba\u8a8d\u3067\u3059\u304c\u3001\u3001\uff09\nsns.tsplot(random_list1)\n\n\n\u2192\u4f55\u3068\u306a\u304f\u5927\u4e08\u592b\u305d\u3046\uff01\n\nStep3: 2\u5909\u6570\u306e\u3076\u3063\u3053\u307f - zip\u95a2\u6570\n\u300cBox-Muller\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u6982\u8981\u300d\u306b\u8a18\u8f09\u3057\u305f\u3068\u304a\u308a\u3001U1,U2U_1, U_2\u306e\u300c\u6df7\u3056\u308a\u5177\u5408\u300d\u304c\u9762\u5012\u3067\u3059\u304c\u3001\u3053\u3053\u306fzip\u95a2\u6570\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u304b\u3002\nzip(random_list1,random_list2))\n\n\u3068\u3059\u308c\u3070\u3001random_list1\u3068random_list2\u306e2\u3064\u306e\u914d\u5217\u306e\u540c\u3058\u4f4d\u7f6e\u306b\u3042\u308b\u8981\u7d20\u30921\u3064\u305a\u3064\u53d6\u3063\u3066\u304d\u3066\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\u30a4\u30e1\u30fc\u30b8\u7684\u306b\u306f\n\\begin{eqnarray}\nlist1 &=& [a_0, a_1, a_2, \\ldots] \\\\\nlist2 &=& [b_0, b_1, b_2, \\ldots]\n\\end{eqnarray}\nlist1list2==[a0,a1,a2,\u2026][b0,b1,b2,\u2026]{\\begin{eqnarray}\nlist1 &=& [a_0, a_1, a_2, \\ldots] \\\\\nlist2 &=& [b_0, b_1, b_2, \\ldots]\n\\end{eqnarray}\n}\n\u306b\u5bfe\u3057\u3066\n[[a_0,b_0], [a_1,b_1], [a_2,b_2] \\ldots] ]\n[[a0,b0],[a1,b1],[a2,b2]\u2026]]{[[a_0,b_0], [a_1,b_1], [a_2,b_2] \\ldots] ]\n}\n\u3092\u8fd4\u3059\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\n\nStep4: \u751f\u6210\u3057\u307e\u30fc\u3059 -map\u95a2\u6570\u3068\u304b\n\u4eca\u56de\u306fmap\u95a2\u6570\u3068lambda\u5f0f\u3092\u4f7f\u3044\u307e\u3059\u30fc\u3002\nnorm_list = map(lambda x: np.sqrt(-2*np.log(x[0]))*np.sin(2*np.pi*x[1]), zip(random_list1,random_list2))\n\n\u2192U1,U2U_1, U_2\u3092\u3072\u3063\u304f\u308a\u8fd4\u3057\u3066\u4f5c\u3063\u305fX2X_2\u3082\u6311\u6226\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\uff01\n\nStep5 \u3001\u3001\u3067\u7d50\u679c\u306f\uff1f\nsns.distplot(norm_list)\n\n\n\u4f55\u3068\u306a\u304f\u6b63\u898f\u5206\u5e03\u3063\u307d\u3044\u3067\u3059\u306d\uff57\n\nStep6 \u3082\u3063\u3068\u7c21\u5358\u306a\u65b9\u6cd5\uff1f\n\u307e\u3041\u3001\u8003\u3048\u308b\u3053\u3068\u306f\u307f\u3093\u306a\u4e00\u7dd2\u3068\u8a00\u3044\u307e\u3059\u304b\u3001\u7528\u610f\u3055\u308c\u3066\u307e\u3059\u3088\u306d\u3001\u305d\u308a\u3083\u3002!\nrnd = np.random.RandomState(0)\nrandom_element = [rnd.randn() for i in range(N)]\nsns.distplot(random_element)\n\n\n\nReference\n\nBox-Muller\u6cd5\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306fBox-Muller\u306e\u65b9\u6cd5\u3067$N(0,1)$\u306b\u5f93\u3046\u5909\u6570\u3092\u751f\u6210\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\n## Box-Muller\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u6982\u8981\n2\u3064\u306e\u72ec\u7acb\u306a\u4e00\u69d8\u5206\u5e03\u3092$U_1, U_2$\u3068\u3057\u307e\u3059\u3002\u3053\u306e\u3068\u304d\u6b21\u306e$X_1, X_2$\u3067\u5b9a\u7fa9\u3055\u308c\u308b2 \u5909\u6570\u306f\u6b63\u898f\u5206\u5e03\u306b\u5f93\u3046\u3053\u3068\u304c\u77e5\u3089\u308c\u3066\u3044\u307e\u3059\uff08\u3063\u3066\u7d50\u679c\u3060\u3051\u304b\u30f2\u30a4w\uff09\n\n```math\n\\begin{eqnarray}\nX_1 &=& \\sqrt{-2\\log(U_1)}\\cos(2\\pi U_2) \\\\\nX_2 &=& \\sqrt{-2\\log(U_2)}\\sin(2\\pi U_1)\n\\end{eqnarray}\n```\n\n\u2192\u53f3\u8fba\u306e$U_1, U_2$\u306e\u300c\u6df7\u3056\u308a\u5177\u5408\u300d\u306b\u6ce8\u610f\u3067\u3059\u306d\u30fc\u3002\n\uff08\u30b3\u30b3\u3092\u9593\u9055\u3048\u308b\u3068\u3001\u5909\u306a\u611f\u3058\u306e\u5206\u5e03\u306b\u306a\u308a\u307e\u3059w\uff09\n\n## \u6e96\u5099\n\u4eca\u56de\u306f`numpy`,`seaborn`\u3092\u4f7f\u3046\u306e\u3067\u3001\u6e96\u5099\u3057\u3068\u304d\u307e\u3057\u3087\u3002\n\n```py\n## preparation\nimport numpy as np\nimport seaborn as sns\n```\n\n## Step1: \u4e00\u69d8\u5206\u5e03\u3092\u751f\u6210\n$0\\sim 1$\u306e\u9593\u306b\u5024\u3092\u3068\u308b\u95a2\u6570`np.random.uniform(0,1)`\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u72ec\u7acb\u306a\u4e00\u69d8\u5206\u5e03$U_1, U_2$\u3092\u4f5c\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u914d\u5217\u306b\u3082\u305f\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u4e00\u7aef\u3001sample\u6570\u3092`10000`\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u304b\u3002\n\n```py\n## Sample size\nN = 10000\n## Uniform distributions\nrandom_list1 = [np.random.uniform(0,1) for i in range(N)]\nrandom_list2 = [np.random.uniform(0,1) for i in range(N)]\n```\n\n## Step2: \u4e00\u69d8\u3067\u3042\u308b\u3053\u3068\u306e\u78ba\u8a8d\n\u4e00\u5fdc\u3001\u3001\u3001\uff08\u305f\u3060\u306e\u76ee\u8996\u78ba\u8a8d\u3067\u3059\u304c\u3001\u3001\uff09\n\n```py\nsns.tsplot(random_list1)\n```\n\n![Unknown.png](https://qiita-image-store.s3.amazonaws.com/0/80539/b8a12656-96fc-6e5e-2e78-65394fa53e99.png)\n\n\u2192\u4f55\u3068\u306a\u304f\u5927\u4e08\u592b\u305d\u3046\uff01\n\n## Step3: 2\u5909\u6570\u306e\u3076\u3063\u3053\u307f - `zip`\u95a2\u6570\n\u300cBox-Muller\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u6982\u8981\u300d\u306b\u8a18\u8f09\u3057\u305f\u3068\u304a\u308a\u3001$U_1, U_2$\u306e\u300c\u6df7\u3056\u308a\u5177\u5408\u300d\u304c\u9762\u5012\u3067\u3059\u304c\u3001\u3053\u3053\u306f`zip`\u95a2\u6570\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u304b\u3002\n\n```py\nzip(random_list1,random_list2))\n```\n\u3068\u3059\u308c\u3070\u3001`random_list1`\u3068`random_list2`\u306e2\u3064\u306e\u914d\u5217\u306e\u540c\u3058\u4f4d\u7f6e\u306b\u3042\u308b\u8981\u7d20\u30921\u3064\u305a\u3064\u53d6\u3063\u3066\u304d\u3066\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\u30a4\u30e1\u30fc\u30b8\u7684\u306b\u306f\n\n```math\n\\begin{eqnarray}\nlist1 &=& [a_0, a_1, a_2, \\ldots] \\\\\nlist2 &=& [b_0, b_1, b_2, \\ldots]\n\\end{eqnarray}\n```\n\n\u306b\u5bfe\u3057\u3066\n\n```math\n[[a_0,b_0], [a_1,b_1], [a_2,b_2] \\ldots] ]\n```\n\n\u3092\u8fd4\u3059\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\n\n## Step4: \u751f\u6210\u3057\u307e\u30fc\u3059 -`map`\u95a2\u6570\u3068\u304b\n\u4eca\u56de\u306f`map`\u95a2\u6570\u3068`lambda`\u5f0f\u3092\u4f7f\u3044\u307e\u3059\u30fc\u3002\n\n```py\nnorm_list = map(lambda x: np.sqrt(-2*np.log(x[0]))*np.sin(2*np.pi*x[1]), zip(random_list1,random_list2))\n```\n\n\u2192$U_1, U_2$\u3092\u3072\u3063\u304f\u308a\u8fd4\u3057\u3066\u4f5c\u3063\u305f$X_2$\u3082\u6311\u6226\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\uff01\n\n## Step5 \u3001\u3001\u3067\u7d50\u679c\u306f\uff1f\n\n```py\nsns.distplot(norm_list)\n```\n\n![Unknown-1.png](https://qiita-image-store.s3.amazonaws.com/0/80539/0afafa50-8061-6ffc-40e3-d0c538703410.png)\n\n\u4f55\u3068\u306a\u304f\u6b63\u898f\u5206\u5e03\u3063\u307d\u3044\u3067\u3059\u306d\uff57\n\n## Step6 \u3082\u3063\u3068\u7c21\u5358\u306a\u65b9\u6cd5\uff1f\n\u307e\u3041\u3001\u8003\u3048\u308b\u3053\u3068\u306f\u307f\u3093\u306a\u4e00\u7dd2\u3068\u8a00\u3044\u307e\u3059\u304b\u3001\u7528\u610f\u3055\u308c\u3066\u307e\u3059\u3088\u306d\u3001\u305d\u308a\u3083\u3002!\n\n```py\nrnd = np.random.RandomState(0)\nrandom_element = [rnd.randn() for i in range(N)]\nsns.distplot(random_element)\n```\n\n![Unknown-2.png](https://qiita-image-store.s3.amazonaws.com/0/80539/c7e31ab8-6b47-bfe1-2319-0a8734a764c5.png)\n\n# Reference\n- [Box-Muller\u6cd5](http://aidiary.hatenablog.com/entry/20140706/1404646793)\n"}