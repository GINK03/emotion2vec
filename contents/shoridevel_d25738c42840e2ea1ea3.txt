{"context": " More than 1 year has passed since last update.Option Explicit\n\n' CSV\u5f62\u5f0f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u66f8\u304d\u51fa\u3059\u30b5\u30f3\u30d7\u30eb\nSub WRITE_CSVFile()\n    Const cnsTITLE = \"CSV\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\u51e6\u7406\"\n    Const cnsFILTER = \"CSV\u30d5\u30a1\u30a4\u30eb (*.csv;*.dat),*.csv;*.dat\"\n    Dim xlAPP As Application        ' Application\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    Dim intFF As Integer            ' FreeFile\u5024\n    Dim strFILENAME As String       ' OPEN\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u540d(\u30d5\u30eb\u30d1\u30b9)\n    Dim X(1 To 5) As Variant        ' \u66f8\u304d\u51fa\u3059\u30ec\u30b3\u30fc\u30c9\u5185\u5bb9\n    Dim GYO As Long                 ' \u53ce\u5bb9\u3059\u308b\u30bb\u30eb\u306e\u884c\n    Dim GYOMAX As Long              ' \u30c7\u30fc\u30bf\u304c\u53ce\u5bb9\u3055\u308c\u305f\u6700\u7d42\u884c\n    Dim lngREC As Long              ' \u30ec\u30b3\u30fc\u30c9\u4ef6\u6570\u30ab\u30a6\u30f3\u30bf\n    Dim COL As Long                 ' \u30ab\u30e9\u30e0(Work)\n\n    ' Application\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\n    Set xlAPP = Application\n    ' \u300c\u540d\u524d\u3092\u4ed8\u3051\u3066\u4fdd\u5b58\u300d\u306e\u30d5\u30a9\u30fc\u30e0\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u306e\u6307\u5b9a\u3092\u53d7\u3051\u308b\n    xlAPP.StatusBar = \"\u51fa\u529b\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u6307\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\"\n    strFILENAME = xlAPP.GetSaveAsFilename(InitialFilename:=\"SAMPLE.csv\", _\n        FileFilter:=cnsFILTER, Title:=cnsTITLE)\n    ' \u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u305f\u5834\u5408\u306f\u4ee5\u964d\u306e\u51e6\u7406\u306f\u884c\u306a\u308f\u306a\u3044\n    If StrConv(strFILENAME, vbUpperCase) = \"FALSE\" Then Exit Sub\n\n    ' \u53ce\u5bb9\u6700\u7d42\u884c\u306e\u5224\u5b9a(Excel\u8a8d\u77e5\u306e\u6700\u7d42\u884c\u304b\u3089\u4e0a\u306b\u5411\u304b\u3063\u3066\u30c7\u30fc\u30bf\u304c\u3042\u308b\u884c\u3092\u63a2\u3059)\n    GYOMAX = Cells.SpecialCells(xlCellTypeLastCell).Row\n    Do While Cells(GYOMAX, 1).Value = \"\"\n        GYOMAX = GYOMAX - 1\n    Loop\n    If GYOMAX < 2 Then\n        xlAPP.StatusBar = False\n        MsgBox \"\u30c6\u30ad\u30b9\u30c8\u3092A\uff5eE\u52172\u884c\u76ee\u304b\u3089\u5165\u529b\u3057\u3066\u304b\u3089\u8d77\u52d5\u3057\u3066\u4e0b\u3055\u3044\u3002\",, cnsTITLE\n        Exit Sub\n    End If\n\n    ' FreeFile\u5024\u306e\u53d6\u5f97(\u4ee5\u964d\u3053\u306e\u5024\u3067\u5165\u51fa\u529b\u3059\u308b)\n    intFF = FreeFile\n    ' \u6307\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092OPEN(\u51fa\u529b\u30e2\u30fc\u30c9)\n    Open strFILENAME For Output As #intFF\n    ' 2\u884c\u76ee\u304b\u3089\u958b\u59cb\n    GYO = 2\n    ' \u6700\u7d42\u884c\u307e\u3067\u7e70\u308a\u8fd4\u3059\n    Do Until GYO > GYOMAX\n        Erase X         ' \u521d\u671f\u5316                                     ' \u2460\n        ' A\uff5eE\u5217\u5185\u5bb9\u3092\u30ec\u30b3\u30fc\u30c9\u306b\u30bb\u30c3\u30c8(\u5148\u982d\u306f2\u884c\u76ee)\n        For COL = 1 To 5\n            X(COL) = FP_CutInjusticeChar(Cells(GYO, COL).Value)      ' \u2461\n        Next COL\n        ' \u30ec\u30b3\u30fc\u30c9\u4ef6\u6570\u30ab\u30a6\u30f3\u30bf\u306e\u52a0\u7b97\n        lngREC = lngREC + 1\n        xlAPP.StatusBar = \"\u51fa\u529b\u4e2d\u3067\u3059\uff0e\uff0e\uff0e\uff0e(\" & lngREC & \"\u30ec\u30b3\u30fc\u30c9\u76ee)\"\n        ' \u30ec\u30b3\u30fc\u30c9\u3092\u51fa\u529b\n        Write #intFF, X(1), X(2), X(3), X(4), X(5)                   ' \u2462\n        ' \u884c\u3092\u52a0\u7b97\n        GYO = GYO + 1\n    Loop\n    ' \u6307\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092CLOSE\n    Close #intFF\n    xlAPP.StatusBar = False\n    ' \u7d42\u4e86\u306e\u8868\u793a\n    MsgBox \"\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\" & vbCr & _\n        \"\u30ec\u30b3\u30fc\u30c9\u4ef6\u6570=\" & lngREC & \"\u4ef6\", vbInformation, cnsTITLE\nEnd Sub\n\n' CSV\u30c6\u30ad\u30b9\u30c8\u9805\u76ee\u306b\u51fa\u529b\u3067\u304d\u306a\u3044\u6587\u5b57\u3092\u9664\u53bb\u3059\u308b\nPrivate Function FP_CutInjusticeChar(vntInText As Variant) As Variant\n    Dim strInText2 As String\n    Dim POS As Long\n    Dim strChar As String\n    Dim strOutText As String\n\n    FP_CutInjusticeChar = Empty\n    ' \u4e00\u65e6\u3001\u6587\u5b57\u5217\u306b\u5909\u63db\u3059\u308b\n    strInText2 = Trim$(CStr(vntInText))\n    ' \u30d6\u30e9\u30f3\u30af\u306e\u5834\u5408\u306f\u51e6\u7406\u306a\u3057\n    If strInText2 = \"\" Then Exit Function\n\n    ' \u6587\u5b57\u5217\u306e\u6841\u6570\u5206\u7e70\u308a\u8fd4\u3059\n    strOutText = \"\"\n    For POS = 1 To Len(strInText2)\n        ' 1\u6587\u5b57\u3092\u53d6\u308a\u51fa\u3059\n        strChar = Mid(strInText2, POS, 1)\n        ' \u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3068CR\u30b3\u30fc\u30c9\u3092OMIT\n        If ((strChar <> vbCr) And (strChar <> \"\"\"\")) Then\n            strOutText = strOutText & strChar\n        End If\n    Next POS\n    ' \u5143\u306e\u5024\u304c\u6570\u5024\u306e\u5834\u5408\u306fDouble\u578b\u3068\u3059\u308b\n    If IsNumeric(vntInText) = True Then\n        FP_CutInjusticeChar = CDbl(strOutText)\n    Else\n        FP_CutInjusticeChar = strOutText\n    End If\nEnd Function\n\n\n\u53c2\u8003URL\nhttp://www.asahi-net.or.jp/~ef2o-inue/vba_o/sub05_110_050.html\nhttp://www.nurs.or.jp/~ppoy/access/excel/xlM033.html\n```\nOption Explicit\n\n' CSV\u5f62\u5f0f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u66f8\u304d\u51fa\u3059\u30b5\u30f3\u30d7\u30eb\nSub WRITE_CSVFile()\n    Const cnsTITLE = \"CSV\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\u51e6\u7406\"\n    Const cnsFILTER = \"CSV\u30d5\u30a1\u30a4\u30eb (*.csv;*.dat),*.csv;*.dat\"\n    Dim xlAPP As Application        ' Application\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    Dim intFF As Integer            ' FreeFile\u5024\n    Dim strFILENAME As String       ' OPEN\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u540d(\u30d5\u30eb\u30d1\u30b9)\n    Dim X(1 To 5) As Variant        ' \u66f8\u304d\u51fa\u3059\u30ec\u30b3\u30fc\u30c9\u5185\u5bb9\n    Dim GYO As Long                 ' \u53ce\u5bb9\u3059\u308b\u30bb\u30eb\u306e\u884c\n    Dim GYOMAX As Long              ' \u30c7\u30fc\u30bf\u304c\u53ce\u5bb9\u3055\u308c\u305f\u6700\u7d42\u884c\n    Dim lngREC As Long              ' \u30ec\u30b3\u30fc\u30c9\u4ef6\u6570\u30ab\u30a6\u30f3\u30bf\n    Dim COL As Long                 ' \u30ab\u30e9\u30e0(Work)\n\n    ' Application\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\n    Set xlAPP = Application\n    ' \u300c\u540d\u524d\u3092\u4ed8\u3051\u3066\u4fdd\u5b58\u300d\u306e\u30d5\u30a9\u30fc\u30e0\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u306e\u6307\u5b9a\u3092\u53d7\u3051\u308b\n    xlAPP.StatusBar = \"\u51fa\u529b\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u6307\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\"\n    strFILENAME = xlAPP.GetSaveAsFilename(InitialFilename:=\"SAMPLE.csv\", _\n        FileFilter:=cnsFILTER, Title:=cnsTITLE)\n    ' \u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u305f\u5834\u5408\u306f\u4ee5\u964d\u306e\u51e6\u7406\u306f\u884c\u306a\u308f\u306a\u3044\n    If StrConv(strFILENAME, vbUpperCase) = \"FALSE\" Then Exit Sub\n\n    ' \u53ce\u5bb9\u6700\u7d42\u884c\u306e\u5224\u5b9a(Excel\u8a8d\u77e5\u306e\u6700\u7d42\u884c\u304b\u3089\u4e0a\u306b\u5411\u304b\u3063\u3066\u30c7\u30fc\u30bf\u304c\u3042\u308b\u884c\u3092\u63a2\u3059)\n    GYOMAX = Cells.SpecialCells(xlCellTypeLastCell).Row\n    Do While Cells(GYOMAX, 1).Value = \"\"\n        GYOMAX = GYOMAX - 1\n    Loop\n    If GYOMAX < 2 Then\n        xlAPP.StatusBar = False\n        MsgBox \"\u30c6\u30ad\u30b9\u30c8\u3092A\uff5eE\u52172\u884c\u76ee\u304b\u3089\u5165\u529b\u3057\u3066\u304b\u3089\u8d77\u52d5\u3057\u3066\u4e0b\u3055\u3044\u3002\",, cnsTITLE\n        Exit Sub\n    End If\n\n    ' FreeFile\u5024\u306e\u53d6\u5f97(\u4ee5\u964d\u3053\u306e\u5024\u3067\u5165\u51fa\u529b\u3059\u308b)\n    intFF = FreeFile\n    ' \u6307\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092OPEN(\u51fa\u529b\u30e2\u30fc\u30c9)\n    Open strFILENAME For Output As #intFF\n    ' 2\u884c\u76ee\u304b\u3089\u958b\u59cb\n    GYO = 2\n    ' \u6700\u7d42\u884c\u307e\u3067\u7e70\u308a\u8fd4\u3059\n    Do Until GYO > GYOMAX\n        Erase X         ' \u521d\u671f\u5316                                     ' \u2460\n        ' A\uff5eE\u5217\u5185\u5bb9\u3092\u30ec\u30b3\u30fc\u30c9\u306b\u30bb\u30c3\u30c8(\u5148\u982d\u306f2\u884c\u76ee)\n        For COL = 1 To 5\n            X(COL) = FP_CutInjusticeChar(Cells(GYO, COL).Value)      ' \u2461\n        Next COL\n        ' \u30ec\u30b3\u30fc\u30c9\u4ef6\u6570\u30ab\u30a6\u30f3\u30bf\u306e\u52a0\u7b97\n        lngREC = lngREC + 1\n        xlAPP.StatusBar = \"\u51fa\u529b\u4e2d\u3067\u3059\uff0e\uff0e\uff0e\uff0e(\" & lngREC & \"\u30ec\u30b3\u30fc\u30c9\u76ee)\"\n        ' \u30ec\u30b3\u30fc\u30c9\u3092\u51fa\u529b\n        Write #intFF, X(1), X(2), X(3), X(4), X(5)                   ' \u2462\n        ' \u884c\u3092\u52a0\u7b97\n        GYO = GYO + 1\n    Loop\n    ' \u6307\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092CLOSE\n    Close #intFF\n    xlAPP.StatusBar = False\n    ' \u7d42\u4e86\u306e\u8868\u793a\n    MsgBox \"\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\" & vbCr & _\n        \"\u30ec\u30b3\u30fc\u30c9\u4ef6\u6570=\" & lngREC & \"\u4ef6\", vbInformation, cnsTITLE\nEnd Sub\n\n' CSV\u30c6\u30ad\u30b9\u30c8\u9805\u76ee\u306b\u51fa\u529b\u3067\u304d\u306a\u3044\u6587\u5b57\u3092\u9664\u53bb\u3059\u308b\nPrivate Function FP_CutInjusticeChar(vntInText As Variant) As Variant\n    Dim strInText2 As String\n    Dim POS As Long\n    Dim strChar As String\n    Dim strOutText As String\n\n    FP_CutInjusticeChar = Empty\n    ' \u4e00\u65e6\u3001\u6587\u5b57\u5217\u306b\u5909\u63db\u3059\u308b\n    strInText2 = Trim$(CStr(vntInText))\n    ' \u30d6\u30e9\u30f3\u30af\u306e\u5834\u5408\u306f\u51e6\u7406\u306a\u3057\n    If strInText2 = \"\" Then Exit Function\n\n    ' \u6587\u5b57\u5217\u306e\u6841\u6570\u5206\u7e70\u308a\u8fd4\u3059\n    strOutText = \"\"\n    For POS = 1 To Len(strInText2)\n        ' 1\u6587\u5b57\u3092\u53d6\u308a\u51fa\u3059\n        strChar = Mid(strInText2, POS, 1)\n        ' \u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3068CR\u30b3\u30fc\u30c9\u3092OMIT\n        If ((strChar <> vbCr) And (strChar <> \"\"\"\")) Then\n            strOutText = strOutText & strChar\n        End If\n    Next POS\n    ' \u5143\u306e\u5024\u304c\u6570\u5024\u306e\u5834\u5408\u306fDouble\u578b\u3068\u3059\u308b\n    If IsNumeric(vntInText) = True Then\n        FP_CutInjusticeChar = CDbl(strOutText)\n    Else\n        FP_CutInjusticeChar = strOutText\n    End If\nEnd Function\n```\n\n### \u53c2\u8003URL\nhttp://www.asahi-net.or.jp/~ef2o-inue/vba_o/sub05_110_050.html\nhttp://www.nurs.or.jp/~ppoy/access/excel/xlM033.html\n", "tags": ["Excel", "VisualBasic"]}