{"context": " More than 1 year has passed since last update.\n\n\u554f\u984c\nAWS Lambda\u304cVPC\u5bfe\u5fdc\u3057\u305f\u306e\u3067\u8a66\u3057\u305f\u3068\u3053\u308d\u3001\u305d\u306e\u307e\u307e\u3067\u306fs3\u3078\u306e\u30a2\u30af\u30bb\u30b9\u304c\u51fa\u6765\u306a\u304b\u3063\u305f\u3002\n\u4f8b\u3048\u3070\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3059\u308b\u3002\n{\n  \"errorMessage\": \"2016-02-12T17:15:10.898Z 12c18327-ddbc-1e15-ad30-da8934f8a9c3 Task timed out after 30.00 seconds\"\n}\n\n\n\u539f\u56e0\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u66f8\u3044\u3066\u3042\u3063\u305f\u3002\n\nWhen you add VPC configuration to a Lambda function, it can only access resources in that VPC. If a Lambda function needs to access both VPC resources and the public Internet, the VPC needs to have a Network Address Translation (NAT) instance inside the VPC.\nAWS Lambda uses the VPC information you provide to set up ENIs that allow your Lambda function to access VPC resources. The ENIs that AWS Lambda creates do not have public Internet access. Therefore, even if you have an Internet gateway attached to your VPC, your Lambda function will not be able to access the Internet. If your Lambda function requires Internet access (for example, to access AWS services that don't have VPC endpoints, such as Amazon Kinesis), you can configure a NAT instance inside your VPC or you can use the Amazon VPC NAT gateway. For more information, see NAT Gateways in the Amazon VPC User Guide.\n\n\n\u89e3\u6c7a\u7b56\n\nNAT\u3092\u4f7f\u3046\u65b9\u6cd5\nprivate subnet\u306bLambda\u3092\u8a2d\u7f6e\u3057\u3001\u305d\u306erouting table\u3067\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5411\u3051\u306e\u901a\u4fe1(0.0.0.0/0)\u306e\u7d4c\u8def\u60c5\u5831\u3092\u3092NAT gateway\u53c8\u306fNAT instance\u306b\u5272\u308a\u5f53\u3066\u308b\u3002\nLambda on VPC\u3092\u4f7f\u3046\u3068\u3001Internet gateway\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308bpublic subnet\u3092\u8a2d\u5b9a\u3057\u3066\u3082\u5916\u90e8\u3078\u306e\u901a\u4fe1\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001Default VPC\u3060\u308d\u3046\u304c\u6562\u3048\u3066private subnet\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\nVPC Endpoint\u3092\u4f7f\u3046\u65b9\u6cd5\nVPC Endpoint for S3\u3092\u8a2d\u5b9a\u3059\u308b\u4e8b\u306b\u3088\u3063\u3066\u3001private network\u7d4c\u7531\u306e\u901a\u4fe1\u304c\u53ef\u80fd\u306b\u306a\u308b\u3002\u4f46\u3057\u3001Lambda\u3068\u540c\u4e00\u30ea\u30fc\u30b8\u30e7\u30f3\u306es3 bucket\u306b\u9650\u5b9a\u3055\u308c\u308b\u3002\ns3\u4ee5\u5916\u306e\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u8d8a\u3057\u306e\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u306b\u306f\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\u304c\u3001\u3053\u3061\u3089\u306e\u65b9\u304c\u8a2d\u5b9a\u304c\u3088\u308a\u7c21\u5358\u3002\n## \u554f\u984c\n\nAWS Lambda\u304c[VPC\u5bfe\u5fdc\u3057\u305f](https://aws.amazon.com/blogs/aws/new-access-resources-in-a-vpc-from-your-lambda-functions/)\u306e\u3067\u8a66\u3057\u305f\u3068\u3053\u308d\u3001\u305d\u306e\u307e\u307e\u3067\u306fs3\u3078\u306e\u30a2\u30af\u30bb\u30b9\u304c\u51fa\u6765\u306a\u304b\u3063\u305f\u3002\n\n\u4f8b\u3048\u3070\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3059\u308b\u3002\n\n```json\n{\n  \"errorMessage\": \"2016-02-12T17:15:10.898Z 12c18327-ddbc-1e15-ad30-da8934f8a9c3 Task timed out after 30.00 seconds\"\n}\n```\n\n## \u539f\u56e0\n\n[\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://docs.aws.amazon.com/lambda/latest/dg/vpc.html)\u306b\u66f8\u3044\u3066\u3042\u3063\u305f\u3002\n\n> When you add VPC configuration to a Lambda function, it can only access resources in that VPC. If a Lambda function needs to access both VPC resources and the public Internet, the VPC needs to have a Network Address Translation (NAT) instance inside the VPC.\n\n> AWS Lambda uses the VPC information you provide to set up ENIs that allow your Lambda function to access VPC resources. The ENIs that AWS Lambda creates do not have public Internet access. Therefore, **even if you have an Internet gateway attached to your VPC, your Lambda function will not be able to access the Internet**. If your Lambda function requires Internet access (for example, to access AWS services that don't have VPC endpoints, such as Amazon Kinesis), you can configure a NAT instance inside your VPC or you can use the Amazon VPC NAT gateway. For more information, see NAT Gateways in the Amazon VPC User Guide.\n\n\n\n## \u89e3\u6c7a\u7b56\n\n### NAT\u3092\u4f7f\u3046\u65b9\u6cd5\n\n`private subnet`\u306bLambda\u3092\u8a2d\u7f6e\u3057\u3001\u305d\u306e`routing table`\u3067\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5411\u3051\u306e\u901a\u4fe1(`0.0.0.0/0`)\u306e\u7d4c\u8def\u60c5\u5831\u3092\u3092NAT gateway\u53c8\u306fNAT instance\u306b\u5272\u308a\u5f53\u3066\u308b\u3002\n\nLambda on VPC\u3092\u4f7f\u3046\u3068\u3001Internet gateway\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308b`public subnet`\u3092\u8a2d\u5b9a\u3057\u3066\u3082\u5916\u90e8\u3078\u306e\u901a\u4fe1\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001Default VPC\u3060\u308d\u3046\u304c\u6562\u3048\u3066`private subnet`\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n### VPC Endpoint\u3092\u4f7f\u3046\u65b9\u6cd5\n\n[VPC Endpoint](http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-endpoints.html) for S3\u3092\u8a2d\u5b9a\u3059\u308b\u4e8b\u306b\u3088\u3063\u3066\u3001private network\u7d4c\u7531\u306e\u901a\u4fe1\u304c\u53ef\u80fd\u306b\u306a\u308b\u3002\u4f46\u3057\u3001Lambda\u3068\u540c\u4e00\u30ea\u30fc\u30b8\u30e7\u30f3\u306es3 bucket\u306b\u9650\u5b9a\u3055\u308c\u308b\u3002\n\ns3\u4ee5\u5916\u306e\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u8d8a\u3057\u306e\u5916\u90e8\u30ea\u30bd\u30fc\u30b9\u306b\u306f\u30a2\u30af\u30bb\u30b9\u3067\u304d\u306a\u3044\u304c\u3001\u3053\u3061\u3089\u306e\u65b9\u304c\u8a2d\u5b9a\u304c\u3088\u308a\u7c21\u5358\u3002\n", "tags": ["AWS", "lambda", "vpc", "S3"]}