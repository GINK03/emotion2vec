{"context": " More than 1 year has passed since last update.\u305d\u306e\u6614\u3001\nhttp://blogs.yahoo.co.jp/igproj_fusion/16633531.html\n\u304b\u3089\u306e\u3001\nhttp://rpubs.com/kohske/3522\n\u304b\u3089\u306e\u3001\nhttp://blogs.yahoo.co.jp/igproj_fusion/17011933.html\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u7a74\u306e\u958b\u304fpolygon\u3092\u63cf\u753b\u3059\u308b\u30ab\u30b9\u30bf\u30e0geom\u3092\u4f5c\u3063\u305f\u3002\n\u6700\u8fd1\u3001ggplot2 2.0\u306b\u306a\u3063\u3066\u52d5\u304b\u306a\u304f\u306a\u3063\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u3068\u3044\u3046\u554f\u3044\u5408\u308f\u305b\u304c\u6765\u3066\u3001\n2.0\u5bfe\u5fdc\u306ecustom geom\u3092\u66f8\u3044\u305f\u3002\n\u6700\u521d\u306b\u5b9a\u7fa9\u3059\u308b\u3002\nFirst, define GeomHolygon and geom_holygon\nlibrary(ggplot2)\nlibrary(proto)\nlibrary(grid)\n\nGeomHolygon <- ggproto(\n  \"GeomHolygon\", \n  GeomPolygon,\n  extra_params = c(\"na.rm\", \"rule\"),\n  draw_panel = function(data, scales, coordinates, rule) {\n    n <- nrow(data)\n    if (n == 1) \n      return(zeroGrob())\n\n    munched <- coord_munch(coordinates, data, scales)\n    munched <- munched[order(munched$group), ]\n\n    first_idx <- !duplicated(munched$group)\n    first_rows <- munched[first_idx, ]\n\n    ggplot2:::ggname(\n      \"geom_holygon\", \n      pathGrob(munched$x, munched$y, default.units = \"native\", \n               id = munched$group, rule = rule, \n               gp = gpar(col = first_rows$colour, \n                         fill = alpha(first_rows$fill, first_rows$alpha), \n                         lwd = first_rows$size * .pt, \n                         lty = first_rows$linetype)))\n  }\n)\n\ngeom_holygon <- function (mapping = NULL, data = NULL, stat = \"identity\", position = \"identity\", \n                          na.rm = FALSE, show.legend = NA, inherit.aes = TRUE, rule = \"winding\", ...) {\n  ggplot2::layer(data = data, mapping = mapping, stat = stat, geom = GeomHolygon, \n                 position = position, show.legend = show.legend, inherit.aes = inherit.aes, \n                 params = list(na.rm = na.rm , rule = rule, ...))\n}\n\n\u3067\u3001\nthen,\nggplot(p524072p_df, aes(long, lat, group = group)) + geom_holygon(fill = \"skyblue\") + coord_map()\n\nEnjoy!!\n\u305d\u306e\u6614\u3001\nhttp://blogs.yahoo.co.jp/igproj_fusion/16633531.html\n\u304b\u3089\u306e\u3001\nhttp://rpubs.com/kohske/3522\n\u304b\u3089\u306e\u3001\nhttp://blogs.yahoo.co.jp/igproj_fusion/17011933.html\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u7a74\u306e\u958b\u304fpolygon\u3092\u63cf\u753b\u3059\u308b\u30ab\u30b9\u30bf\u30e0geom\u3092\u4f5c\u3063\u305f\u3002\n\n\u6700\u8fd1\u3001ggplot2 2.0\u306b\u306a\u3063\u3066\u52d5\u304b\u306a\u304f\u306a\u3063\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u3068\u3044\u3046\u554f\u3044\u5408\u308f\u305b\u304c\u6765\u3066\u3001\n2.0\u5bfe\u5fdc\u306ecustom geom\u3092\u66f8\u3044\u305f\u3002\n\n\n\u6700\u521d\u306b\u5b9a\u7fa9\u3059\u308b\u3002\nFirst, define GeomHolygon and geom_holygon\n\n```\nlibrary(ggplot2)\nlibrary(proto)\nlibrary(grid)\n\nGeomHolygon <- ggproto(\n  \"GeomHolygon\", \n  GeomPolygon,\n  extra_params = c(\"na.rm\", \"rule\"),\n  draw_panel = function(data, scales, coordinates, rule) {\n    n <- nrow(data)\n    if (n == 1) \n      return(zeroGrob())\n\n    munched <- coord_munch(coordinates, data, scales)\n    munched <- munched[order(munched$group), ]\n    \n    first_idx <- !duplicated(munched$group)\n    first_rows <- munched[first_idx, ]\n    \n    ggplot2:::ggname(\n      \"geom_holygon\", \n      pathGrob(munched$x, munched$y, default.units = \"native\", \n               id = munched$group, rule = rule, \n               gp = gpar(col = first_rows$colour, \n                         fill = alpha(first_rows$fill, first_rows$alpha), \n                         lwd = first_rows$size * .pt, \n                         lty = first_rows$linetype)))\n  }\n)\n\ngeom_holygon <- function (mapping = NULL, data = NULL, stat = \"identity\", position = \"identity\", \n                          na.rm = FALSE, show.legend = NA, inherit.aes = TRUE, rule = \"winding\", ...) {\n  ggplot2::layer(data = data, mapping = mapping, stat = stat, geom = GeomHolygon, \n                 position = position, show.legend = show.legend, inherit.aes = inherit.aes, \n                 params = list(na.rm = na.rm , rule = rule, ...))\n}\n```\n\n\u3067\u3001\nthen,\n\n```\nggplot(p524072p_df, aes(long, lat, group = group)) + geom_holygon(fill = \"skyblue\") + coord_map()\n```\n\nEnjoy!!\n\n", "tags": ["R", "ggplot2"]}