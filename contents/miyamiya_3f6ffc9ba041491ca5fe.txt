{"context": "\u30d6\u30ed\u30b0\u304b\u3089\u306e\u8ee2\u8f09\nHyper-V \u3067\u7d44\u3093\u3060 NAPT \u306e\u5185\u5074\u306b\u3044\u308b\u30b2\u30b9\u30c8 OS \u3092\u3001\u30db\u30b9\u30c8 OS \u7d4c\u7531\u3067\u4ed6\u306e\u7aef\u672b\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u30c6\u30fc\u30d6\u30eb\u306b\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u306e\u60c5\u5831\u3092\u767b\u9332\u3059\u308b\u3002\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6d41\u3057\u307e\u3059\nAdd-NetNatStaticMapping [-NatName] <String> -ExternalIPAddress <String> -ExternalPort <UInt16> -InternalIPAddress <String> -Protocol <Protocol> [-InternalPort <UInt16> ]\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\u6642\u306b\u306f\u3001\u5148\u306b\u4e0b\u8a18\u60c5\u5831\u3092\u628a\u63e1\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u30b2\u30b9\u30c8 OS \u306e IP \u30a2\u30c9\u30ec\u30b9\u3068\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\u30dd\u30fc\u30c8\u756a\u53f7\n\u30db\u30b9\u30c8 OS \u304c\u53d7\u3051\u4ed8\u3051\u308b\u30dd\u30fc\u30c8\u756a\u53f7\n\n\u3064\u307e\u308a\u3001\u30db\u30b9\u30c8 OS \u306e\u4f55\u756a\u306e\u30dd\u30fc\u30c8\u3067\u53d7\u3051\u3066\u3001\u30b2\u30b9\u30c8 OS \u306e\u4f55\u756a\u306e\u30dd\u30fc\u30c8\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\u304b\u3092\u628a\u63e1\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001SharePoint \u3092\u30bb\u30df\u30ca\u30fc\u3067\u4f7f\u3046\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3001\u624b\u5143\u306e\u4eee\u60f3\u74b0\u5883\u4e0a\u306e SharePoint \u3092\u30db\u30b9\u30c8 OS \u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u4ed6\u306e\u30de\u30b7\u30f3\u304b\u3089\u3082\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u8ffd\u52a0\u3057\u307e\u3057\u305f\n-ExternalIPAddress \u306f 0.0.0.0 (\u5168\u3066\u304b\u3089\u53d7\u3051\u4ed8\u3051\u308b) \u3068\u3057\u307e\u3059\u3002\n# NAT \u30c6\u30fc\u30d6\u30eb\u540d\u3092\u78ba\u8a8d\nPS> Get-NetNat\nName                             : VmNAPT\nExternalIPInterfaceAddressPrefix :\nInternalIPInterfaceAddressPrefix : 10.0.1.0/24\nIcmpQueryTimeout                 : 30\nTcpEstablishedConnectionTimeout  : 1800\nTcpTransientConnectionTimeout    : 120\nTcpFilteringBehavior             : AddressDependentFiltering\nUdpFilteringBehavior             : AddressDependentFiltering\nUdpIdleSessionTimeout            : 120\nUdpInboundRefresh                : False\nStore                            : Local\nActive                           : True\n\n# \u30db\u30b9\u30c8 OS \u304c\u53d7\u3051\u305f\u4ed6\u306e\u7aef\u672b(0.0.0.0)\u304b\u3089\u30dd\u30fc\u30c8 80 \u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u3001\u30b2\u30b9\u30c8(10.0.1.10) \u306e\u30dd\u30fc\u30c8 80 \u3092\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\n\nPS> Add-NetNatStaticMapping \"VmNAPT\" -ExternalIPAddress 0.0.0.0 -InternalIPAddress 10.0.1.10 -ExternalPort 80 -Protocol TCP -InternalPort 80\n\nStaticMappingID               : 0\nNatName                       : VmNAPT\nProtocol                      : TCP\nRemoteExternalIPAddressPrefix : 0.0.0.0/0\nExternalIPAddress             : 0.0.0.0\nExternalPort                  : 80\nInternalIPAddress             : 10.0.1.10\nInternalPort                  : 80\nInternalRoutingDomainId       : {00000000-0000-0000-0000-000000000000}\nActive                        : True\n\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3059\u308b\nGet-NetNatStaticMapping [[-NatName] <String[]>]\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3059\u308b\u4f8b\nPS> Get-NetNatStaticMapping\n\nStaticMappingID               : 0\nNatName                       : VmNAPT\nProtocol                      : TCP\nRemoteExternalIPAddressPrefix : 0.0.0.0/0\nExternalIPAddress             : 0.0.0.0\nExternalPort                  : 80\nInternalIPAddress             : 10.0.1.10\nInternalPort                  : 80\nInternalRoutingDomainId       : {00000000-0000-0000-0000-000000000000}\nActive                        : True\n\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u524a\u9664\u3059\u308b\nRemove-NetNatStaticMapping [[-NatName] <String[]>]\n\n\u8a2d\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u524a\u9664\u3059\u308b\u4f8b\nPS> Remove-NetNatStaticMapping \"VmNAPT\"\n\n\u78ba\u8a8d\n\u3053\u306e\u64cd\u4f5c\u3092\u5b9f\u884c\u3057\u307e\u3059\u304b?\n\u5bfe\u8c61 VmNAPT;0;0 \u306e PolicyStore Local \u306b\u5bfe\u3057\u3066\u64cd\u4f5c Delete \u3092\u5b9f\u884c\u3057\u3066\u3044\u307e\u3059\n[Y] \u306f\u3044(Y)  [A] \u3059\u3079\u3066\u7d9a\u884c(A)  [N] \u3044\u3044\u3048(N)  [L] \u3059\u3079\u3066\u7121\u8996(L)  [S] \u4e2d\u65ad(S)  [?] \u30d8\u30eb\u30d7 (\u65e2\u5b9a\u5024\u306f \"Y\"): y\n\n[\u30d6\u30ed\u30b0\u304b\u3089\u306e\u8ee2\u8f09](http://1bed.saloon.jp/?page_id=1947)\n\nHyper-V \u3067\u7d44\u3093\u3060 NAPT \u306e\u5185\u5074\u306b\u3044\u308b\u30b2\u30b9\u30c8 OS \u3092\u3001\u30db\u30b9\u30c8 OS \u7d4c\u7531\u3067\u4ed6\u306e\u7aef\u672b\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u30c6\u30fc\u30d6\u30eb\u306b\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u306e\u60c5\u5831\u3092\u767b\u9332\u3059\u308b\u3002\n\n## \u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\n\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6d41\u3057\u307e\u3059\n\n```ps1\nAdd-NetNatStaticMapping [-NatName] <String> -ExternalIPAddress <String> -ExternalPort <UInt16> -InternalIPAddress <String> -Protocol <Protocol> [-InternalPort <UInt16> ]\n```\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\u6642\u306b\u306f\u3001\u5148\u306b\u4e0b\u8a18\u60c5\u5831\u3092\u628a\u63e1\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n  * \u30b2\u30b9\u30c8 OS \u306e IP \u30a2\u30c9\u30ec\u30b9\u3068\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\u30dd\u30fc\u30c8\u756a\u53f7\n  * \u30db\u30b9\u30c8 OS \u304c\u53d7\u3051\u4ed8\u3051\u308b\u30dd\u30fc\u30c8\u756a\u53f7\n\n\u3064\u307e\u308a\u3001\u30db\u30b9\u30c8 OS \u306e\u4f55\u756a\u306e\u30dd\u30fc\u30c8\u3067\u53d7\u3051\u3066\u3001\u30b2\u30b9\u30c8 OS \u306e\u4f55\u756a\u306e\u30dd\u30fc\u30c8\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\u304b\u3092\u628a\u63e1\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3001SharePoint \u3092\u30bb\u30df\u30ca\u30fc\u3067\u4f7f\u3046\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3001\u624b\u5143\u306e\u4eee\u60f3\u74b0\u5883\u4e0a\u306e SharePoint \u3092\u30db\u30b9\u30c8 OS \u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u4ed6\u306e\u30de\u30b7\u30f3\u304b\u3089\u3082\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u8ffd\u52a0\u3057\u307e\u3057\u305f\n\n```-ExternalIPAddress``` \u306f 0.0.0.0 (\u5168\u3066\u304b\u3089\u53d7\u3051\u4ed8\u3051\u308b) \u3068\u3057\u307e\u3059\u3002\n\n```ps1\n# NAT \u30c6\u30fc\u30d6\u30eb\u540d\u3092\u78ba\u8a8d\nPS> Get-NetNat\nName                             : VmNAPT\nExternalIPInterfaceAddressPrefix :\nInternalIPInterfaceAddressPrefix : 10.0.1.0/24\nIcmpQueryTimeout                 : 30\nTcpEstablishedConnectionTimeout  : 1800\nTcpTransientConnectionTimeout    : 120\nTcpFilteringBehavior             : AddressDependentFiltering\nUdpFilteringBehavior             : AddressDependentFiltering\nUdpIdleSessionTimeout            : 120\nUdpInboundRefresh                : False\nStore                            : Local\nActive                           : True\n\n# \u30db\u30b9\u30c8 OS \u304c\u53d7\u3051\u305f\u4ed6\u306e\u7aef\u672b(0.0.0.0)\u304b\u3089\u30dd\u30fc\u30c8 80 \u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u3001\u30b2\u30b9\u30c8(10.0.1.10) \u306e\u30dd\u30fc\u30c8 80 \u3092\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\n\nPS> Add-NetNatStaticMapping \"VmNAPT\" -ExternalIPAddress 0.0.0.0 -InternalIPAddress 10.0.1.10 -ExternalPort 80 -Protocol TCP -InternalPort 80\n\nStaticMappingID               : 0\nNatName                       : VmNAPT\nProtocol                      : TCP\nRemoteExternalIPAddressPrefix : 0.0.0.0/0\nExternalIPAddress             : 0.0.0.0\nExternalPort                  : 80\nInternalIPAddress             : 10.0.1.10\nInternalPort                  : 80\nInternalRoutingDomainId       : {00000000-0000-0000-0000-000000000000}\nActive                        : True\n```\n\n## \u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3059\u308b\n\n```ps1\nGet-NetNatStaticMapping [[-NatName] <String[]>]\n```\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u78ba\u8a8d\u3059\u308b\u4f8b\n\n```ps1\nPS> Get-NetNatStaticMapping\n\nStaticMappingID               : 0\nNatName                       : VmNAPT\nProtocol                      : TCP\nRemoteExternalIPAddressPrefix : 0.0.0.0/0\nExternalIPAddress             : 0.0.0.0\nExternalPort                  : 80\nInternalIPAddress             : 10.0.1.10\nInternalPort                  : 80\nInternalRoutingDomainId       : {00000000-0000-0000-0000-000000000000}\nActive                        : True\n```\n\n## \u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u524a\u9664\u3059\u308b\n\n```ps1\nRemove-NetNatStaticMapping [[-NatName] <String[]>]\n```\n\n\u8a2d\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3092\u524a\u9664\u3059\u308b\u4f8b\n\n```ps1\nPS> Remove-NetNatStaticMapping \"VmNAPT\"\n\n\u78ba\u8a8d\n\u3053\u306e\u64cd\u4f5c\u3092\u5b9f\u884c\u3057\u307e\u3059\u304b?\n\u5bfe\u8c61 VmNAPT;0;0 \u306e PolicyStore Local \u306b\u5bfe\u3057\u3066\u64cd\u4f5c Delete \u3092\u5b9f\u884c\u3057\u3066\u3044\u307e\u3059\n[Y] \u306f\u3044(Y)  [A] \u3059\u3079\u3066\u7d9a\u884c(A)  [N] \u3044\u3044\u3048(N)  [L] \u3059\u3079\u3066\u7121\u8996(L)  [S] \u4e2d\u65ad(S)  [?] \u30d8\u30eb\u30d7 (\u65e2\u5b9a\u5024\u306f \"Y\"): y\n```\n", "tags": ["PowerShell", "Hyper-V"]}