{"context": "\n\n\u6307\u5b9a\u30d5\u30a9\u30eb\u30c0\u4e2d\u306b\u3042\u308b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eID\u3092\u53d6\u5f97\u3059\u308b\n\n\u30d5\u30a9\u30eb\u30c0\u5185\u306eID\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u30cd\u30c3\u30c8\u306b\u843d\u3061\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\nGetFolderIdList.js\nfunction GetFolderIdList() {\n  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"SheetName\");\n  var Folder = DriveApp.getFolderById(\"FolderId\");\n  var serchId = Folder.getId();\n  var files = DriveApp.searchFiles(\n  \"mimeType = 'application/vnd.google-apps.spreadsheet' and '\"+serchId+\"' in parents and trashed = false\"\n  );\n  var filelist = new Array();\n  for(i=0;files.hasNext();i++){\n    var fileArray = files.next();\n    var tmp = new Array();\n    tmp.push(fileArray.getId());\n    tmp.push(fileArray.getName());\n    filelist.push(tmp);\n    Logger.log(filelist[i]);\n  }\n  var lastColumn = filelist[0].length;\n  var lastRow = filelist.length;\n  sheet.getRange(1,1,lastRow,lastColumn).setValues(filelist);\n}\n\n\n\n3/25\u66f4\u65b0\nGetFolderIdList\u3067ID\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3057\u3066\u3001\nID\u2192book\u540d+sheet\u540d\u4e00\u89a7\u3092\u96a3\u306b\u51fa\u529b\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8ffd\u8a18\u3002\nDriveApp\u304c\u74b0\u5883\u306b\u3088\u3063\u3066\u306f\u30a2\u30af\u30bb\u30b9\u62d2\u5426\u3055\u308c\u308b\u306e\u3067\u3001\u5225\u3082\u306e\u3068\u3057\u3066\u4f5c\u6210\u3002\n\u8a73\u3057\u304f\u306f\u4e0b\u8a18\u53c2\u7167\u3002\nhttps://groups.google.com/forum/#!topic/google-apps-api-japan/NZA3DIe9RL4\n\u30fb\u4e0d\u8981\u306a\u30b7\u30fc\u30c8\u3092\u9664\u304f\u70ba\u306b\u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u62bd\u51fa\u51fa\u6765\u308b\u3088\u3046\u306b\n\u30fbID\u4e00\u89a7\u304c\u98db\u3073\u98db\u3073\u3067\u3082\u6a5f\u80fd\u3059\u308b\u3088\u3046\u306b\n\nGetFolderIdList.js\nfunction GetSheetNameList(){\n  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"SheetName\");\n  var values = sheet.getRange(\"A:A\").getValues();\n  var keyword = \"\u30b7\u30fc\u30c8\";\n  var idLastRow = values.filter(String).length;\n  var idList = new Array();\n  var sheetNameOut = new Array();\n\n  for(i=0;i<idLastRow;i++){\n    var tmp = new Array();\n    if(values[i][0]!=\"\"){\n      tmp.push(values[i][0]);\n      idList.push(tmp);\n    }\n    else{\n      idLastRow++;\n    }\n  }\n  var idLastRow = values.filter(String).length;\n  for(j=0;j<idLastRow;j++){\n    var bookList = SpreadsheetApp.openById(idList[j]);\n    var sheetNameList = bookList.getSheets();\n    for(i=0;i<sheetNameList.length;i++){\n      if(sheetNameList[i].getName().indexOf(keyword) != -1){\n        var tmp = new Array();\n        tmp.push(bookList.getName());\n        tmp.push(sheetNameList[i].getName());\n        sheetNameOut.push(tmp)\n      }\n    }\n  }\n  var sheetNamelastColumn = sheetNameOut[0].length;\n  var sheetNamelastRow = sheetNameOut.length;\n  sheet.getRange(1,3,sheetNamelastRow,sheetNamelastColumn).setValues(sheetNameOut);\n}\n\n\n### **\u6307\u5b9a\u30d5\u30a9\u30eb\u30c0\u4e2d\u306b\u3042\u308b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eID\u3092\u53d6\u5f97\u3059\u308b**\n\u30d5\u30a9\u30eb\u30c0\u5185\u306eID\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u30cd\u30c3\u30c8\u306b\u843d\u3061\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n* * *\n```js:GetFolderIdList.js\nfunction GetFolderIdList() {\n  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"SheetName\");\n  var Folder = DriveApp.getFolderById(\"FolderId\");\n  var serchId = Folder.getId();\n  var files = DriveApp.searchFiles(\n  \"mimeType = 'application/vnd.google-apps.spreadsheet' and '\"+serchId+\"' in parents and trashed = false\"\n  );\n  var filelist = new Array();\n  for(i=0;files.hasNext();i++){\n    var fileArray = files.next();\n    var tmp = new Array();\n    tmp.push(fileArray.getId());\n    tmp.push(fileArray.getName());\n    filelist.push(tmp);\n    Logger.log(filelist[i]);\n  }\n  var lastColumn = filelist[0].length;\n  var lastRow = filelist.length;\n  sheet.getRange(1,1,lastRow,lastColumn).setValues(filelist);\n}\n```\n* * *\n\n3/25\u66f4\u65b0\nGetFolderIdList\u3067ID\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3057\u3066\u3001\nID\u2192book\u540d+sheet\u540d\u4e00\u89a7\u3092\u96a3\u306b\u51fa\u529b\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8ffd\u8a18\u3002\nDriveApp\u304c\u74b0\u5883\u306b\u3088\u3063\u3066\u306f\u30a2\u30af\u30bb\u30b9\u62d2\u5426\u3055\u308c\u308b\u306e\u3067\u3001\u5225\u3082\u306e\u3068\u3057\u3066\u4f5c\u6210\u3002\n\u8a73\u3057\u304f\u306f\u4e0b\u8a18\u53c2\u7167\u3002\nhttps://groups.google.com/forum/#!topic/google-apps-api-japan/NZA3DIe9RL4\n\u30fb\u4e0d\u8981\u306a\u30b7\u30fc\u30c8\u3092\u9664\u304f\u70ba\u306b\u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u62bd\u51fa\u51fa\u6765\u308b\u3088\u3046\u306b\n\u30fbID\u4e00\u89a7\u304c\u98db\u3073\u98db\u3073\u3067\u3082\u6a5f\u80fd\u3059\u308b\u3088\u3046\u306b\n\n```js:GetFolderIdList.js\nfunction GetSheetNameList(){\n  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"SheetName\");\n  var values = sheet.getRange(\"A:A\").getValues();\n  var keyword = \"\u30b7\u30fc\u30c8\";\n  var idLastRow = values.filter(String).length;\n  var idList = new Array();\n  var sheetNameOut = new Array();\n\n  for(i=0;i<idLastRow;i++){\n    var tmp = new Array();\n    if(values[i][0]!=\"\"){\n      tmp.push(values[i][0]);\n      idList.push(tmp);\n    }\n    else{\n      idLastRow++;\n    }\n  }\n  var idLastRow = values.filter(String).length;\n  for(j=0;j<idLastRow;j++){\n    var bookList = SpreadsheetApp.openById(idList[j]);\n    var sheetNameList = bookList.getSheets();\n    for(i=0;i<sheetNameList.length;i++){\n      if(sheetNameList[i].getName().indexOf(keyword) != -1){\n        var tmp = new Array();\n        tmp.push(bookList.getName());\n        tmp.push(sheetNameList[i].getName());\n        sheetNameOut.push(tmp)\n      }\n    }\n  }\n  var sheetNamelastColumn = sheetNameOut[0].length;\n  var sheetNamelastRow = sheetNameOut.length;\n  sheet.getRange(1,3,sheetNamelastRow,sheetNamelastColumn).setValues(sheetNameOut);\n}\n```\n", "tags": ["google", "Apps", "script", "JavaScript", "gas"]}