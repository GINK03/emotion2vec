{"context": " More than 1 year has passed since last update.awk\u3063\u3066\u4fbf\u5229\u3067\u3059\u3088\u306d\u3002\napache\u30ed\u30b0\u306erequest_date\u3063\u3066\u4ee5\u5916\u3068\u81ea\u529b\u3067\u30d1\u30fc\u30b9\u3059\u308b\u3068\u9762\u5012\u81ed\u3063\u304b\u305f\u306e\u3067\u30e1\u30e2\n\uff08\u6b63\u898f\u8868\u73fe\u306f\u81ea\u4fe1\u304c\u306a\u3044\u306e\u3067\u3053\u3063\u3061\u306e\u307b\u3046\u304c\u306f\u3084\u3093\u3044\u3058\u3083\u306d\u3047\uff1f\uff09\u3063\u3066\u30c4\u30c3\u30b3\u30df\u5927\u6b53\u8fce\u3067\u3059\u3002\n\naccess_log.awk\n{\n    request_date = $4 $5\n    #\u4e21\u7aef\u306b\u3042\u308b[]\u3092\u9664\u53bb\u3059\u308b\n    req_length = length(request_date);\n    request_date = substr(request_date, 2, req_length)\n    request_date = substr(request_date, 1, req_length - 2 )\n    #print request_date\n\n    split(request_date, arr, \"/\");\n    day = arr[1]\n    month = arr[2]\n    #\u6708\u306e\u82f1\u5b57\u6708\u3092\u6570\u5b57\u306b\u5909\u63db\n    sub(/(January|Jan|JANUARY|JAN)/, \"01\", month)\n    sub(/(February|Feb|FEBRUARY|FEB)/, \"02\", month)\n    sub(/(March|Mar|MARCH|MAR)/, \"03\", month)\n    sub(/(April|Apr|APRIL|APR)/, \"04\", month)\n    sub(/(May|MAY)/, 05, month)\n    sub(/(June|Jun|JUNE|JUN)/, \"06\", month)\n    sub(/(July|Jul|JULY|JUL)/, \"07\", month)\n    sub(/(August|Aug|AUGUST|AUG)/, \"08\", month)\n    sub(/(September|Sep|SEPTEMBER|SEP)/, \"09\", month)\n    sub(/(October|Oct|OCTOBER|OCT)/, \"10\", month)\n    sub(/(November|Nov|NOVEMBER|NOV)/, \"11\", month)\n    sub(/(December|Dec|DECEMBER|DEC)/, \"12\", month)\n\n    split(arr[3], arr2, \":\");\n    year = arr2[1]\n    hour = arr2[2]\n    minute = arr2[3]\n    split(arr2[4], arr3, \"+\")\n    second = arr3[1]\n    request_date = year \"-\" month \"-\" day \" \" hour \":\" minute \":\" second\n}\n{\n    method = $6\n    path = $7\n    code = $9\n}\n#tsv\u3060\u3068import\u3068\u304b\u3057\u3084\u3059\u3044\u306e\u3067\u304a\u597d\u307f\u3067\n{print request_date \"\\t\" method\"\\t\"path \"\\t\"code}\n\n\n\u4f7f\u3044\u65b9\n#\u753b\u50cf,css,js\u306f\u9664\u5916\u3057\u3066\u307e\u3059\ncat -r /path/to/access_log | grep -v .jpg | grep -v .png | grep -v .gif | grep -v .css | grep -v .js | awk -f access_log.awk\n\n\nawk\u3063\u3066\u4fbf\u5229\u3067\u3059\u3088\u306d\u3002\napache\u30ed\u30b0\u306erequest_date\u3063\u3066\u4ee5\u5916\u3068\u81ea\u529b\u3067\u30d1\u30fc\u30b9\u3059\u308b\u3068\u9762\u5012\u81ed\u3063\u304b\u305f\u306e\u3067\u30e1\u30e2\n\uff08\u6b63\u898f\u8868\u73fe\u306f\u81ea\u4fe1\u304c\u306a\u3044\u306e\u3067\u3053\u3063\u3061\u306e\u307b\u3046\u304c\u306f\u3084\u3093\u3044\u3058\u3083\u306d\u3047\uff1f\uff09\u3063\u3066\u30c4\u30c3\u30b3\u30df\u5927\u6b53\u8fce\u3067\u3059\u3002\n\n\n```shell:access_log.awk\n{\n    request_date = $4 $5\n    #\u4e21\u7aef\u306b\u3042\u308b[]\u3092\u9664\u53bb\u3059\u308b\n    req_length = length(request_date);\n    request_date = substr(request_date, 2, req_length)\n    request_date = substr(request_date, 1, req_length - 2 )\n    #print request_date\n\n    split(request_date, arr, \"/\");\n    day = arr[1]\n    month = arr[2]\n    #\u6708\u306e\u82f1\u5b57\u6708\u3092\u6570\u5b57\u306b\u5909\u63db\n    sub(/(January|Jan|JANUARY|JAN)/, \"01\", month)\n    sub(/(February|Feb|FEBRUARY|FEB)/, \"02\", month)\n    sub(/(March|Mar|MARCH|MAR)/, \"03\", month)\n    sub(/(April|Apr|APRIL|APR)/, \"04\", month)\n    sub(/(May|MAY)/, 05, month)\n    sub(/(June|Jun|JUNE|JUN)/, \"06\", month)\n    sub(/(July|Jul|JULY|JUL)/, \"07\", month)\n    sub(/(August|Aug|AUGUST|AUG)/, \"08\", month)\n    sub(/(September|Sep|SEPTEMBER|SEP)/, \"09\", month)\n    sub(/(October|Oct|OCTOBER|OCT)/, \"10\", month)\n    sub(/(November|Nov|NOVEMBER|NOV)/, \"11\", month)\n    sub(/(December|Dec|DECEMBER|DEC)/, \"12\", month)\n\n    split(arr[3], arr2, \":\");\n    year = arr2[1]\n    hour = arr2[2]\n    minute = arr2[3]\n    split(arr2[4], arr3, \"+\")\n    second = arr3[1]\n    request_date = year \"-\" month \"-\" day \" \" hour \":\" minute \":\" second\n}\n{\n    method = $6\n    path = $7\n    code = $9\n}\n#tsv\u3060\u3068import\u3068\u304b\u3057\u3084\u3059\u3044\u306e\u3067\u304a\u597d\u307f\u3067\n{print request_date \"\\t\" method\"\\t\"path \"\\t\"code}\n```\n\n\u4f7f\u3044\u65b9\n\n```shell\n#\u753b\u50cf,css,js\u306f\u9664\u5916\u3057\u3066\u307e\u3059\ncat -r /path/to/access_log | grep -v .jpg | grep -v .png | grep -v .gif | grep -v .css | grep -v .js | awk -f access_log.awk\n```\n\n", "tags": ["awk", "shell"]}