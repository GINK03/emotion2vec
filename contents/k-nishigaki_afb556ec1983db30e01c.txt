{"context": "\n\n\u7d50\u8ad6\nMac \u4f7f\u3063\u3066\u3066 Ansible \u3067 SSH \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u52b9\u304b\u306a\u3044\u3068\u304d\u306f -c ssh \u30aa\u30d7\u30b7\u30e7\u30f3\u3064\u3051\u308b\u3079\u3057\n\uff08teratail \u3067\u6559\u3048\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\uff09\n\n\u56f0\u3063\u3066\u3044\u305f\u3053\u3068\nMac \u304b\u3089\u3000Linux \u30de\u30b7\u30f3\u3092 Ansible \u3067\u69cb\u7bc9\u3057\u3066\u305f\u3093\u3060\u3051\u3069\u3069\u3046\u306b\u3082\u3053\u3046\u306b\u3082 SSH \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u3046\u307e\u304f\u3044\u3063\u3066\u306a\u304f\u3066 git clone \u3068\u304b\u305d\u3053\u3089\u8fba\u304c\u5168\u304f\u3067\u304d\u306a\u304b\u3063\u305f\u3002\nfatal: [xxx.xxx.xxx.xxx]: FAILED! => {\"changed\": true, \"cmd\": [\"ssh-add\", \"-l\"], \"delta\": \"0:00:00.004968\", \"end\": \"2016-12-21 11:44:41.814838\", \"failed\": true, \"invocation\": {\"module_args\": {\"_raw_params\": \"ssh-add -l\", \"_uses_shell\": false, \"chdir\": null, \"creates\": null, \"executable\": null, \"removes\": null, \"warn\": true}, \"module_name\": \"command\"}, \"rc\": 2, \"start\": \"2016-12-21 11:44:41.809870\", \"stderr\": \"Could not open a connection to your authentication agent.\", \"stdout\": \"\", \"stdout_lines\": [], \"warnings\": []}\n\n\n\n\u539f\u56e0\nMac \u3067 Ansible \u4f7f\u3063\u3066\u308b\u3068 SSH \u306b openssl \u3067\u306f\u306a\u304f paramiko \u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u4f7f\u7528\u3055\u308c\u308b\u305f\u3081\u2026\u3089\u3057\u3044\u3002\n\u306a\u304a\u3001\u74b0\u5883\u306f \n\nMac OSX 10.10\nPython 2.7.10\nAnsible 2.1.1.0\n\n\n\u5bfe\u7b56\nansible.cfg \u306b\u8a2d\u5b9a\u3092\u66f8\u3044\u3066\u5b9f\u884c\n$ cat /etc/ansible/ansible.cfg\n[defaults]\ntransport = ssh\n# \u2191\u3053\u308c\u3067 -c ssh \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3057\u3066\u3044\u308b\u306e\u3068\u540c\u7fa9\n\n[ssh_connection]\nssh_args = -o ForwardAgent=yes\n# \u2191 SSH \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\n\n\u30bf\u30b9\u30af\n---\n- name: test ssh-agent\n  command: ssh-add -l\n  become: no\n\n\u5b9f\u884c\u7d50\u679c\n{\"changed\": true, \"cmd\": [\"ssh-add\", \"-l\"], \"delta\": \"0:00:00.023313\", \"end\": \"2016-12-22 12:11:02.230611\", \"invocation\": {\"module_args\": {\"_raw_params\": \"ssh-add -l\", \"_uses_shell\": false, \"chdir\": null, \"creates\": null, \"executable\": null, \"removes\": null, \"warn\": true}, \"module_name\": \"command\"}, \"rc\": 0, \"start\": \"2016-12-22 12:11:02.207298\", \"stderr\": \"\", \"stdout\": \"2048 hogehoge (RSA)\", \"stdout_lines\": [\"2048 fugafuga (RSA)\"], \"warnings\": []}\n\n\n\u3067\u304d\u305f  \n# \u7d50\u8ad6\n\nMac \u4f7f\u3063\u3066\u3066 Ansible \u3067 SSH \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u52b9\u304b\u306a\u3044\u3068\u304d\u306f `-c ssh` \u30aa\u30d7\u30b7\u30e7\u30f3\u3064\u3051\u308b\u3079\u3057\n[\uff08teratail \u3067\u6559\u3048\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\uff09](https://teratail.com/questions/59571)\n\n# \u56f0\u3063\u3066\u3044\u305f\u3053\u3068\n\nMac \u304b\u3089\u3000Linux \u30de\u30b7\u30f3\u3092 Ansible \u3067\u69cb\u7bc9\u3057\u3066\u305f\u3093\u3060\u3051\u3069\u3069\u3046\u306b\u3082\u3053\u3046\u306b\u3082 SSH \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u3046\u307e\u304f\u3044\u3063\u3066\u306a\u304f\u3066 `git clone` \u3068\u304b\u305d\u3053\u3089\u8fba\u304c\u5168\u304f\u3067\u304d\u306a\u304b\u3063\u305f\u3002\n\n```\nfatal: [xxx.xxx.xxx.xxx]: FAILED! => {\"changed\": true, \"cmd\": [\"ssh-add\", \"-l\"], \"delta\": \"0:00:00.004968\", \"end\": \"2016-12-21 11:44:41.814838\", \"failed\": true, \"invocation\": {\"module_args\": {\"_raw_params\": \"ssh-add -l\", \"_uses_shell\": false, \"chdir\": null, \"creates\": null, \"executable\": null, \"removes\": null, \"warn\": true}, \"module_name\": \"command\"}, \"rc\": 2, \"start\": \"2016-12-21 11:44:41.809870\", \"stderr\": \"Could not open a connection to your authentication agent.\", \"stdout\": \"\", \"stdout_lines\": [], \"warnings\": []}\n\n```\n\n# \u539f\u56e0\n\nMac \u3067 Ansible \u4f7f\u3063\u3066\u308b\u3068 SSH \u306b openssl \u3067\u306f\u306a\u304f paramiko \u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u4f7f\u7528\u3055\u308c\u308b\u305f\u3081\u2026\u3089\u3057\u3044\u3002\n\u306a\u304a\u3001\u74b0\u5883\u306f \n\n- Mac OSX 10.10\n- Python 2.7.10\n- Ansible 2.1.1.0\n\n# \u5bfe\u7b56\n\nansible.cfg \u306b\u8a2d\u5b9a\u3092\u66f8\u3044\u3066\u5b9f\u884c\n\n```bash\n$ cat /etc/ansible/ansible.cfg\n[defaults]\ntransport = ssh\n# \u2191\u3053\u308c\u3067 -c ssh \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3057\u3066\u3044\u308b\u306e\u3068\u540c\u7fa9\n\n[ssh_connection]\nssh_args = -o ForwardAgent=yes\n# \u2191 SSH \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\n```\n\n\u30bf\u30b9\u30af\n\n```yaml\n---\n- name: test ssh-agent\n  command: ssh-add -l\n  become: no\n```\n\n\u5b9f\u884c\u7d50\u679c\n\n```bash\n{\"changed\": true, \"cmd\": [\"ssh-add\", \"-l\"], \"delta\": \"0:00:00.023313\", \"end\": \"2016-12-22 12:11:02.230611\", \"invocation\": {\"module_args\": {\"_raw_params\": \"ssh-add -l\", \"_uses_shell\": false, \"chdir\": null, \"creates\": null, \"executable\": null, \"removes\": null, \"warn\": true}, \"module_name\": \"command\"}, \"rc\": 0, \"start\": \"2016-12-22 12:11:02.207298\", \"stderr\": \"\", \"stdout\": \"2048 hogehoge (RSA)\", \"stdout_lines\": [\"2048 fugafuga (RSA)\"], \"warnings\": []}\n\n```\n\n\u3067\u304d\u305f :tada: \n", "tags": ["Ansible", "SSH", "macos"]}