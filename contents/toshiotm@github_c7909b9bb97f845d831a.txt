{"context": " More than 1 year has passed since last update.Ransack\u306esort_link\u3092\u4f7f\u7528\u3057\u305f\u6642\u306b\u3001\u7b2c\uff12\u30bd\u30fc\u30c8\u306fid\u306e\u6607\u9806\u3068\u306a\u3063\u3066\u3044\u308b\u304c\u3001\u305d\u308c\u3092\u4ed6\u306e\u9805\u76ee\u306b\u5909\u66f4\u3059\u308b\u65b9\u6cd5\u3002\n\n\u6e96\u5099\n\u78ba\u8a8d\u7528\u306btitle\u3068body\u3092\u6301\u3063\u305fDialy\u3092scaffold\u3057\u3066\u4f5c\u6210\u3059\u308b\u3002\nscaffold\n\nrails generate scaffold dialy title:string body:text\n\n\u305d\u306e\u4ed6\nGemfile\u306b\u4e0b\u8a18\u3092\u8ffd\u52a0\u3057\u3066bundle install\u3092\u5b9f\u884c\u3002\ngem 'ransack', github: 'activerecord-hackery/ransack', branch: 'rails-4.1'\n\n\n\nRansack\u306e\u8a2d\u5b9a\u3092\u884c\u3046\n\u4e0b\u8a18\u30b5\u30a4\u30c8\u306eREADME\u3092\u53c2\u8003\u306b\u3001scaffold\u3057\u305f\u72b6\u614b\u306bRansack\u306esort_link\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\u3002\nRansack\n\ndialies_controller.rb\n  # GET /dialies\n  # GET /dialies.json\n  def index\n    @q = Dialy.search(params[:q])\n    @dialies = @q.result(distinct: true)\n  end\n\n\n\nindex.html.erb\n<h1>Listing dialies</h1>\n\n<table>\n  <thead>\n    <tr>\n      <th>ID</th>\n      <%= content_tag :th, sort_link(@q, :title) %>\n      <th>Body</th>\n      <th colspan=\"3\"></th>\n    </tr>\n  </thead>\n\n  <tbody>\n    <% @dialies.each do |dialy| %>\n      <tr>\n        <td><%= dialy.id %></td>\n        <td><%= dialy.title %></td>\n        <td><%= dialy.body %></td>\n        <td><%= link_to 'Show', dialy %></td>\n        <td><%= link_to 'Edit', edit_dialy_path(dialy) %></td>\n        <td><%= link_to 'Destroy', dialy, method: :delete, data: { confirm: 'Are you sure?' } %></td>\n      </tr>\n    <% end %>\n  </tbody>\n</table>\n\n<br>\n\n<%= link_to 'New Dialy', new_dialy_path %>\n\n\nTitle\u3060\u3051\u306bsort_link\u3092\u3064\u3051\u3066\u3044\u308b\u3002\n\n\u7b2c\uff12\u30bd\u30fc\u30c8\u3092\u8a2d\u5b9a\u3057\u306a\u3044\u5834\u5408\n\u4f55\u3082\u8a2d\u5b9a\u3057\u306a\u3044\u3068id\u306e\u6607\u9806\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u7b2c\uff12\u30bd\u30fc\u30c8\u306b\u306a\u308b\u3002\n\n\n\u7b2c\uff12\u30bd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\n\u305d\u3053\u3067\u3001dialies_controller.rb#index\u3092\u4e0b\u8a18\u306b\u5909\u66f4\u3059\u308b\u3002\n(\u6761\u4ef6\u5165\u308c\u3066\u3044\u308b\u3068\u3053\u308d\u306f\u3001\u3082\u3063\u3068\u3046\u307e\u304f\u66f8\u304d\u305f\u3044\u2026\uff09\n\ndialies_controller.rb\n  # GET /dialies\n  # GET /dialies.json\n  def index\n    # \u7b2c\uff12\u30bd\u30fc\u30c8\u9806\u306bbody\u306e\u6607\u9806\u3092\u8a2d\u5b9a\n    search_params = params[:q]\n    search_params[:s] = [search_params[:s], \"body asc\"] unless (search_params.nil? || search_params[:s].nil?)\n\n    @q = Dialy.search(search_params)\n    @dialies = @q.result(distinct: true)\n  end\n\n\n\u7d50\u679c\n\nid\u306e\u6607\u9806\u304b\u3089body\u306e\u6607\u9806\u306b\u7b2c\uff12\u30bd\u30fc\u30c8\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u3002\n\u4eca\u56de\u306f\u3001Array\u3067\u7b2c\uff12\u30bd\u30fc\u30c8\u3092\u8ffd\u52a0\u3057\u305f\u3051\u308c\u3069Ransack\u306e\u30bd\u30fc\u30b9\u3092\u898b\u308b\u3068\u4ed6\u306b\u3082Hash\u3068String\u3067\u6307\u5b9a\u51fa\u6765\u308b\u307f\u305f\u3044\u3002\n\nsearch.rb\n\n   def sorts=(args)\n      case args\n      when Array\n        # \u7701\u7565\n      when Hash\n        # \u7701\u7565\n      when String\n        # \u7701\u7565\n      else\n        raise ArgumentError, \"Invalid argument (#{args.class}) supplied to sorts=\"\n      end\n    end\n    alias :s= :sorts=\n\n\nview\u3060\u3051\u3067\u7b2c\uff12\u30bd\u30fc\u30c8\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3063\u3066\u51fa\u6765\u308b\u3093\u3060\u308d\u3046\u304b\u3002\n\u63a2\u3057\u65b9\u304c\u60aa\u3044\u306e\u304b\u3001\u898b\u3064\u3051\u3089\u308c\u306a\u304b\u3063\u305f\u3002\n\nRansack\u306esort_link\u3092\u4f7f\u7528\u3057\u305f\u6642\u306b\u3001\u7b2c\uff12\u30bd\u30fc\u30c8\u306fid\u306e\u6607\u9806\u3068\u306a\u3063\u3066\u3044\u308b\u304c\u3001\u305d\u308c\u3092\u4ed6\u306e\u9805\u76ee\u306b\u5909\u66f4\u3059\u308b\u65b9\u6cd5\u3002\n\n## \u6e96\u5099\n\u78ba\u8a8d\u7528\u306btitle\u3068body\u3092\u6301\u3063\u305fDialy\u3092scaffold\u3057\u3066\u4f5c\u6210\u3059\u308b\u3002\n\n**scaffold**\n> rails generate scaffold dialy title:string body:text\n\n**\u305d\u306e\u4ed6**\nGemfile\u306b\u4e0b\u8a18\u3092\u8ffd\u52a0\u3057\u3066bundle install\u3092\u5b9f\u884c\u3002\n\n```Gemfile\ngem 'ransack', github: 'activerecord-hackery/ransack', branch: 'rails-4.1'\n\n```\n\n## Ransack\u306e\u8a2d\u5b9a\u3092\u884c\u3046\n\u4e0b\u8a18\u30b5\u30a4\u30c8\u306eREADME\u3092\u53c2\u8003\u306b\u3001scaffold\u3057\u305f\u72b6\u614b\u306bRansack\u306esort_link\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n[Ransack](https://github.com/activerecord-hackery/ransack)\n\n\n```dialies_controller.rb\n  # GET /dialies\n  # GET /dialies.json\n  def index\n    @q = Dialy.search(params[:q])\n    @dialies = @q.result(distinct: true)\n  end\n```\n\n```index.html.erb\n<h1>Listing dialies</h1>\n\n<table>\n  <thead>\n    <tr>\n      <th>ID</th>\n      <%= content_tag :th, sort_link(@q, :title) %>\n      <th>Body</th>\n      <th colspan=\"3\"></th>\n    </tr>\n  </thead>\n\n  <tbody>\n    <% @dialies.each do |dialy| %>\n      <tr>\n        <td><%= dialy.id %></td>\n        <td><%= dialy.title %></td>\n        <td><%= dialy.body %></td>\n        <td><%= link_to 'Show', dialy %></td>\n        <td><%= link_to 'Edit', edit_dialy_path(dialy) %></td>\n        <td><%= link_to 'Destroy', dialy, method: :delete, data: { confirm: 'Are you sure?' } %></td>\n      </tr>\n    <% end %>\n  </tbody>\n</table>\n\n<br>\n\n<%= link_to 'New Dialy', new_dialy_path %>\n```\nTitle\u3060\u3051\u306bsort_link\u3092\u3064\u3051\u3066\u3044\u308b\u3002\n\n## \u7b2c\uff12\u30bd\u30fc\u30c8\u3092\u8a2d\u5b9a\u3057\u306a\u3044\u5834\u5408\n\u4f55\u3082\u8a2d\u5b9a\u3057\u306a\u3044\u3068id\u306e\u6607\u9806\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u7b2c\uff12\u30bd\u30fc\u30c8\u306b\u306a\u308b\u3002\n\n![RansackSample1.png](https://qiita-image-store.s3.amazonaws.com/0/18110/038d9b04-39fb-0ac3-ed23-5ca2f77aa299.png \"RansackSample1.png\")\n\n\n## \u7b2c\uff12\u30bd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\n\u305d\u3053\u3067\u3001dialies_controller.rb#index\u3092\u4e0b\u8a18\u306b\u5909\u66f4\u3059\u308b\u3002\n(\u6761\u4ef6\u5165\u308c\u3066\u3044\u308b\u3068\u3053\u308d\u306f\u3001\u3082\u3063\u3068\u3046\u307e\u304f\u66f8\u304d\u305f\u3044\u2026\uff09\n\n```dialies_controller.rb\n  # GET /dialies\n  # GET /dialies.json\n  def index\n\t# \u7b2c\uff12\u30bd\u30fc\u30c8\u9806\u306bbody\u306e\u6607\u9806\u3092\u8a2d\u5b9a\n    search_params = params[:q]\n    search_params[:s] = [search_params[:s], \"body asc\"] unless (search_params.nil? || search_params[:s].nil?)\n    \n    @q = Dialy.search(search_params)\n    @dialies = @q.result(distinct: true)\n  end\n```\n\n***\u7d50\u679c***\n![RansackSample.png](https://qiita-image-store.s3.amazonaws.com/0/18110/f9d34d31-8dac-23ed-d182-d146687b6776.png \"RansackSample.png\")\n\n\n\nid\u306e\u6607\u9806\u304b\u3089body\u306e\u6607\u9806\u306b\u7b2c\uff12\u30bd\u30fc\u30c8\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u3002\n\u4eca\u56de\u306f\u3001Array\u3067\u7b2c\uff12\u30bd\u30fc\u30c8\u3092\u8ffd\u52a0\u3057\u305f\u3051\u308c\u3069Ransack\u306e\u30bd\u30fc\u30b9\u3092\u898b\u308b\u3068\u4ed6\u306b\u3082Hash\u3068String\u3067\u6307\u5b9a\u51fa\u6765\u308b\u307f\u305f\u3044\u3002\n\n```search.rb\n\n   def sorts=(args)\n      case args\n      when Array\n\t\t# \u7701\u7565\n      when Hash\n\t\t# \u7701\u7565\n      when String\n\t\t# \u7701\u7565\n      else\n        raise ArgumentError, \"Invalid argument (#{args.class}) supplied to sorts=\"\n      end\n    end\n    alias :s= :sorts=\n```\n\nview\u3060\u3051\u3067\u7b2c\uff12\u30bd\u30fc\u30c8\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3063\u3066\u51fa\u6765\u308b\u3093\u3060\u308d\u3046\u304b\u3002\n\u63a2\u3057\u65b9\u304c\u60aa\u3044\u306e\u304b\u3001\u898b\u3064\u3051\u3089\u308c\u306a\u304b\u3063\u305f\u3002\n\n", "tags": ["Rails", "ransack"]}