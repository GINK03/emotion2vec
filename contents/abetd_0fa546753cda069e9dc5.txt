{"tags": ["SpringBoot", "openshift"], "context": "\n\n\u3084\u308a\u305f\u3044\u3053\u3068\nGradle\u3067\u4f5c\u6210\u3057\u305fSpringBoot\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092OpenShift\u3067\u5b9f\u884c\u3059\u308b\u3002\nOpenShift\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fDIY\u3067\u4f5c\u6210\u3059\u308b\u3002\n\u30bd\u30fc\u30b9\u3082\u3001Bitbucket\u3067\u7ba1\u7406\u3059\u308b\u3053\u3068\u3067\u3001\u7121\u6599\u3067\u30bd\u30fc\u30b9\u7ba1\u7406\u3092\u3057\u3001\u5b9f\u884c\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u3002\n\n\u524d\u63d0\nGradle\u3067\u4f5c\u6210\u3057\u305fSpringBoot\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304cBitbucket\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u5b58\u5728\u3059\u308b\u3002\nOpenShift\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u3042\u308a\u3001rhc\u30b3\u30de\u30f3\u30c9\u304c\u3057\u3088\u3046\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\nOpenShift\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b .openshift/action_hooks \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\ndeploy,start,stop\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\ndeploy : JDK,Gradle\u304c\u306a\u3051\u308c\u3070\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001gradle\u3067\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\ndeploy\n#!/bin/bash\n\nset -x\n\nif [ ! -d $OPENSHIFT_DATA_DIR/jdk1.8.0_101 ]; then\n   cd $OPENSHIFT_DATA_DIR\n   wget --no-check-certificate --no-cookies --header \"Cookie: oraclelicense=accept-securebackup-cookie\" http://download.oracle.com/otn-pub/java/jdk/8u101-b13/jdk-8u101-linux-x64.tar.gz\n   tar xvf *.tar.gz\n   rm -f *.tar.gz\nfi\n\nif [ ! -d $OPENSHIFT_DATA_DIR/gradle-2.13 ]; then\n    cd $OPENSHIFT_DATA_DIR\n    wget https://services.gradle.org/distributions/gradle-2.13-bin.zip\n    unzip gradle-2.13-bin.zip\n    rm -f gradle-2.13-bin.zip\nfi\n\nif [ ! -d $OPENSHIFT_DATA_DIR/gradle ]; then\n    cd $OPENSHIFT_DATA_DIR\n    mkdir gradle\nfi\n\nif [ ! -d $OPENSHIFT_DATA_DIR/logs ]; then\n    cd $OPENSHIFT_DATA_DIR\n    mkdir logs\nfi\n\ncd $OPENSHIFT_REPO_DIR\nexport GRADLE_USER_HOME=$OPENSHIFT_DATA_DIR/gradle\nexport GRADLE_HOME=$OPENSHIFT_DATA_DIR/gradle-2.13\nexport JAVA_HOME=$OPENSHIFT_DATA_DIR/jdk1.8.0_101\nexport PATH=$JAVA_HOME/bin:$GRADLE_HOME/bin:$PATH\n\ngradle bootRepackage\n\n\nstart : \u8d77\u52d5\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\nstart\n#!/bin/bash\n\nsource $OPENSHIFT_CARTRIDGE_SDK_BASH\n\nset -x\n\nexport JAVA_HOME=$OPENSHIFT_DATA_DIR/jdk1.8.0_101\nexport PATH=$JAVA_HOME/bin:$PATH\n\ncd $OPENSHIFT_REPO_DIR\nnohup java -jar build/libs/*.jar --server.port=${OPENSHIFT_DIY_PORT} --server.address=${OPENSHIFT_DIY_IP} &\n\n\nstop : \u505c\u6b62\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\nstop\n#!/bin/bash\n\nsource $OPENSHIFT_CARTRIDGE_SDK_BASH\n\nPID=$(ps -ef | grep java.*\\.jar | grep -v grep | awk '{ print $2 }')\n\nif [ -z \"$PID\" ]\nthen\n    client_result \"Application is already stopped\"\nelse\n    kill $PID\nfi\n\n\n\n\u5404\u30d5\u30a1\u30a4\u30eb\u306f\u5b9f\u884c\u6a29\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\nOpenShift\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3002\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067DIY\u30ab\u30fc\u30c8\u30ea\u30c3\u30b8\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3002\nrhc app create <app-name> diy-0.1\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u308b\u306e\u3067\u3001\u4e00\u5ea6\u524a\u9664\u3057\u3001\u30b3\u30df\u30c3\u30c8\u3059\u308b\u3002\ncd <app-name>\ngit rm -rf .openshift README.md diy misc\ngit commit -am \"Removed template application source code\"\n\nBitbucket\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30ea\u30e2\u30fc\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u3057\u3066\u8ffd\u52a0\u3057\u3001pull\u3059\u308b\u3002\ngit remote add upstream https://<user>@bitbucket.org/<user>/<repository>.git\ngit pull -s recursive -X theirs upstream master\n\nBitbucket\u306e\u304b\u3089pull\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u3001OpenShift\u306bpush\u3059\u308b\u3002\ngit push\n\ndeploy, start \u306e\u5404\u30d5\u30a1\u30a4\u30eb\u304c\u5b9f\u884c\u3055\u308c\u308b\u306e\u3067\u3001SpringBoot\u304c\u8d77\u52d5\u3057\u305f\u3089\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\nhttp://<app-namd>-<domain>.rhcloud.com/\n\n\n\u30e1\u30e2\n\naction_hooks\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u5b9f\u884c\u6a29\u3092\u5fd8\u308c\u308b\u3068\u3001\u5f53\u305f\u308a\u524d\u3060\u304c\u3001\u5931\u6557\u3059\u308b\u3002\nbuild.gradle\u306f\u3001\u5909\u66f4\u3057\u306a\u304b\u3063\u305f\u3002\n\n\n\u53c2\u8003\n\nSpring Boot\u30ad\u30e3\u30f3\u30d7 \u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599\nOPENSHIFT DIY: BUILD SPRING BOOT / UNDERTOW APPLICATION WITH GRADLE\nGradle Distributions\n\n\n## \u3084\u308a\u305f\u3044\u3053\u3068\n\nGradle\u3067\u4f5c\u6210\u3057\u305fSpringBoot\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092OpenShift\u3067\u5b9f\u884c\u3059\u308b\u3002\nOpenShift\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fDIY\u3067\u4f5c\u6210\u3059\u308b\u3002\n\u30bd\u30fc\u30b9\u3082\u3001Bitbucket\u3067\u7ba1\u7406\u3059\u308b\u3053\u3068\u3067\u3001\u7121\u6599\u3067\u30bd\u30fc\u30b9\u7ba1\u7406\u3092\u3057\u3001\u5b9f\u884c\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u3002\n\n## \u524d\u63d0\n\nGradle\u3067\u4f5c\u6210\u3057\u305fSpringBoot\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304cBitbucket\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u5b58\u5728\u3059\u308b\u3002\nOpenShift\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u3042\u308a\u3001rhc\u30b3\u30de\u30f3\u30c9\u304c\u3057\u3088\u3046\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n## OpenShift\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b .openshift/action_hooks \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\ndeploy,start,stop\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\ndeploy : JDK,Gradle\u304c\u306a\u3051\u308c\u3070\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001gradle\u3067\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```bash:deploy\n#!/bin/bash\n\nset -x\n\nif [ ! -d $OPENSHIFT_DATA_DIR/jdk1.8.0_101 ]; then\n   cd $OPENSHIFT_DATA_DIR\n   wget --no-check-certificate --no-cookies --header \"Cookie: oraclelicense=accept-securebackup-cookie\" http://download.oracle.com/otn-pub/java/jdk/8u101-b13/jdk-8u101-linux-x64.tar.gz\n   tar xvf *.tar.gz\n   rm -f *.tar.gz\nfi\n\nif [ ! -d $OPENSHIFT_DATA_DIR/gradle-2.13 ]; then\n    cd $OPENSHIFT_DATA_DIR\n    wget https://services.gradle.org/distributions/gradle-2.13-bin.zip\n    unzip gradle-2.13-bin.zip\n    rm -f gradle-2.13-bin.zip\nfi\n\nif [ ! -d $OPENSHIFT_DATA_DIR/gradle ]; then\n    cd $OPENSHIFT_DATA_DIR\n    mkdir gradle\nfi\n\nif [ ! -d $OPENSHIFT_DATA_DIR/logs ]; then\n    cd $OPENSHIFT_DATA_DIR\n    mkdir logs\nfi\n\ncd $OPENSHIFT_REPO_DIR\nexport GRADLE_USER_HOME=$OPENSHIFT_DATA_DIR/gradle\nexport GRADLE_HOME=$OPENSHIFT_DATA_DIR/gradle-2.13\nexport JAVA_HOME=$OPENSHIFT_DATA_DIR/jdk1.8.0_101\nexport PATH=$JAVA_HOME/bin:$GRADLE_HOME/bin:$PATH\n\ngradle bootRepackage\n```\n\nstart : \u8d77\u52d5\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\n```bash:start\n#!/bin/bash\n\nsource $OPENSHIFT_CARTRIDGE_SDK_BASH\n\nset -x\n\nexport JAVA_HOME=$OPENSHIFT_DATA_DIR/jdk1.8.0_101\nexport PATH=$JAVA_HOME/bin:$PATH\n\ncd $OPENSHIFT_REPO_DIR\nnohup java -jar build/libs/*.jar --server.port=${OPENSHIFT_DIY_PORT} --server.address=${OPENSHIFT_DIY_IP} &\n```\n\nstop : \u505c\u6b62\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\u30b9\u30af\u30ea\u30d7\u30c8\n\n```bash:stop\n#!/bin/bash\n\nsource $OPENSHIFT_CARTRIDGE_SDK_BASH\n\nPID=$(ps -ef | grep java.*\\.jar | grep -v grep | awk '{ print $2 }')\n\nif [ -z \"$PID\" ]\nthen\n    client_result \"Application is already stopped\"\nelse\n    kill $PID\nfi\n\n```\n\n\u5404\u30d5\u30a1\u30a4\u30eb\u306f\u5b9f\u884c\u6a29\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n## OpenShift\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067DIY\u30ab\u30fc\u30c8\u30ea\u30c3\u30b8\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\nrhc app create <app-name> diy-0.1\n```\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u308b\u306e\u3067\u3001\u4e00\u5ea6\u524a\u9664\u3057\u3001\u30b3\u30df\u30c3\u30c8\u3059\u308b\u3002\n\n```\ncd <app-name>\ngit rm -rf .openshift README.md diy misc\ngit commit -am \"Removed template application source code\"\n```\n\nBitbucket\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30ea\u30e2\u30fc\u30c8\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u3057\u3066\u8ffd\u52a0\u3057\u3001pull\u3059\u308b\u3002\n\n```\ngit remote add upstream https://<user>@bitbucket.org/<user>/<repository>.git\ngit pull -s recursive -X theirs upstream master\n```\n\nBitbucket\u306e\u304b\u3089pull\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u3001OpenShift\u306bpush\u3059\u308b\u3002\n\n```\ngit push\n```\n\ndeploy, start \u306e\u5404\u30d5\u30a1\u30a4\u30eb\u304c\u5b9f\u884c\u3055\u308c\u308b\u306e\u3067\u3001SpringBoot\u304c\u8d77\u52d5\u3057\u305f\u3089\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\n```\nhttp://<app-namd>-<domain>.rhcloud.com/\n```\n\n## \u30e1\u30e2\n\n- action_hooks\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u5b9f\u884c\u6a29\u3092\u5fd8\u308c\u308b\u3068\u3001\u5f53\u305f\u308a\u524d\u3060\u304c\u3001\u5931\u6557\u3059\u308b\u3002\n- build.gradle\u306f\u3001\u5909\u66f4\u3057\u306a\u304b\u3063\u305f\u3002\n\n## \u53c2\u8003\n\n- [Spring Boot\u30ad\u30e3\u30f3\u30d7 \u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599](http://spring-boot-camp.readthedocs.io/ja/latest/index.html)\n\n- [OPENSHIFT DIY: BUILD SPRING BOOT / UNDERTOW APPLICATION WITH GRADLE](http://blog.codeleak.pl/2015/02/openshift-diy-build-spring-boot.html)\n\n- [Gradle Distributions](https://services.gradle.org/distributions/)\n\n"}