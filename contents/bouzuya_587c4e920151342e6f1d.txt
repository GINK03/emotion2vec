{"context": " More than 1 year has passed since last update.\u3053\u308c\u306f Hubot Advent Calendar 2014 \u306e 9 \u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u6628\u65e5\u306f @udzura \u3055\u3093\u306e \u300ecarrier\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u96d1\u306bHubot\u304b\u3089\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u300f\u3067\u3057\u305f\u3002stream \u3092\u4e2d\u5fc3\u3068\u3057\u305f\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f Node.js \u3089\u3057\u3044\u826f\u3044\u5f62\u306a\u306e\u3067\u3059\u304c\u3001\u307c\u304f\u500b\u4eba\u3068\u3057\u3066\u306f\u3042\u3093\u307e\u308a\u4f7f\u3048\u3066\u306a\u3044\u3067\u3059\u306d\u3002\u3042\u3068 @bouzuya Advent Calendar \u7684\u306a\u717d\u308a\u304c\u898b\u3048\u305f\u6c17\u3082\u3057\u307e\u3059\u304c\u3001\u6c17\u306e\u305b\u3044\u3067\u3057\u3087\u3046\u3002\n\u307e\u305f\u3001\u4eca\u56de\u306f @bouzuya \u306e Hubot \u9023\u8f09\u306e\u7b2c 7 \u56de\u3067\u3059\u3002\u76ee\u6b21\u306f\u3001\u7b2c 1 \u56de\u306e\u8a18\u4e8b\u306b\u3042\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u3069\u3046\u305e\u3002\n\n\u524d\u56de\u307e\u3067\u3001\u305d\u3057\u3066\u4eca\u56de\u306f\n\u524d\u56de\u306f \u7c21\u5358\u306a Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3082\u3063\u3068\u3064\u304f\u308d\u3046 (\u304a\u307f\u304f\u3058\u7cfb) \u3068\u3044\u3046\u3053\u3068\u3067\u3001Response#random \u3092\u4f7f\u3063\u3066\u3001\u30e9\u30f3\u30c0\u30e0\u306b\u3072\u3068\u3064\u3092\u9078\u3093\u3067\u8fd4\u3059 Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3064\u304f\u308a\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306f\u5916\u90e8\u306e npm \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f7f\u3044\u306a\u304c\u3089\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3059\u308b Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3064\u304f\u308a\u307e\u3057\u3087\u3046\u3002npm \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u81ea\u7531\u306b\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308c\u3070\u3001\u3067\u304d\u308b\u3053\u3068\u304c\u3055\u3089\u306b\u5e83\u304c\u308a\u307e\u3059\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\n\u307e\u305a\u3001\u4eca\u56de\u3064\u304f\u308d\u3046\u3068\u3057\u3066\u3044\u308b Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u5171\u6709\u3057\u307e\u3057\u3087\u3046\u3002\n\u4eca\u56de\u306f\u300c\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3001Hubot Advent Calendar 2014 \u3067\u3082\u5229\u7528\u3057\u3066\u3044\u308b\u300c Adventar \u300d\u306b HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u3057\u3066\u3001\u305d\u306e\u7d50\u679c\u3092\u89e3\u6790\u3057\u307e\u3057\u3087\u3046\u3002\n\u5b9f\u884c\u30a4\u30e1\u30fc\u30b8\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\nbouzuya> hubot adventar hubot\nhubot> Hubot http://www.adventar.org/calendars/384\n\n\n\u3055\u3063\u305d\u304f\u3064\u304f\u308b\n\u307e\u305a\u306f Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092 generator-hubot \u3067\u751f\u6210\u3057\u307e\u3059\u3002\n$ mkdir hubot-adventar\n$ cd hubot-adventar\n\n$ yo hubot:script\n...\n\n\u3082\u3046\u6163\u308c\u305f\u3082\u306e\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u6b21\u306b Node.js \u306e\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3067\u306e\u5b9a\u756a\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3042\u308b request \u3068 cheerio \u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067 npm \u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u305d\u308c\u3089\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001package.json \u306b\u4f9d\u5b58\u95a2\u4fc2\u3092\u8ffd\u52a0\u3067\u304d\u307e\u3059\u3002 \n$ npm install --save request cheerio\nrequest@2.49.0 node_modules/request\n\u251c\u2500\u2500 caseless@0.8.0\n\u251c\u2500\u2500 json-stringify-safe@5.0.0\n\u251c\u2500\u2500 forever-agent@0.5.2\n\u251c\u2500\u2500 aws-sign2@0.5.0\n\u251c\u2500\u2500 stringstream@0.0.4\n\u251c\u2500\u2500 tunnel-agent@0.4.0\n\u251c\u2500\u2500 oauth-sign@0.5.0\n\u251c\u2500\u2500 node-uuid@1.4.2\n\u251c\u2500\u2500 qs@2.3.3\n\u251c\u2500\u2500 mime-types@1.0.2\n\u251c\u2500\u2500 combined-stream@0.0.7 (delayed-stream@0.0.5)\n\u251c\u2500\u2500 form-data@0.1.4 (mime@1.2.11, async@0.9.0)\n\u251c\u2500\u2500 tough-cookie@0.12.1 (punycode@1.3.2)\n\u251c\u2500\u2500 http-signature@0.10.0 (assert-plus@0.1.2, asn1@0.1.11, ctype@0.5.2)\n\u251c\u2500\u2500 bl@0.9.3 (readable-stream@1.0.33)\n\u2514\u2500\u2500 hawk@1.1.1 (cryptiles@0.2.2, sntp@0.2.4, boom@0.4.2, hoek@0.9.1)\n\ncheerio@0.18.0 node_modules/cheerio\n\u251c\u2500\u2500 entities@1.1.1\n\u251c\u2500\u2500 lodash@2.4.1\n\u251c\u2500\u2500 dom-serializer@0.0.1 (domelementtype@1.1.3)\n\u251c\u2500\u2500 htmlparser2@3.8.2 (domelementtype@1.1.3, domutils@1.5.0, entities@1.0.0, domhandler@2.3.0, readable-stream@1.1.13)\n\u2514\u2500\u2500 CSSselect@0.4.1 (domutils@1.4.3, CSSwhat@0.4.7)\n\n\u7c21\u5358\u3067\u3059\u306d\u3002npm \u306f\u3053\u306e\u3088\u3046\u306b\u7c21\u5358\u306b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u8ffd\u52a0\u3067\u304d\u307e\u3059\u3002dependencies \u3082\u304d\u3061\u3093\u3068\u30bd\u30fc\u30c8\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u3055\u3066\u3001\u66f8\u3044\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\u3067\u306f\u3001\u3053\u3061\u3089\u306b\u5b8c\u6210\u3057\u305f\u3082\u306e\u304c\u3054\u3056\u3044\u307e\u3059\u3002\n\nsrc/adventar.coffee\n# Description\n#   A Hubot script for listing advent calendars in Adventar\n#\n# Configuration:\n#   None\n#\n# Commands:\n#   hubot adventar <query> - lists advent calendars in Adventar\n#\n# Author:\n#   bouzuya <m@bouzuya.net>\n\ncheerio = require 'cheerio'\nrequest = require 'request'\n\nmodule.exports = (robot) ->\n\n  robot.respond /adventar(?: (\\S+))?/, (msg) ->\n    query = msg.match[1]\n\n    # send HTTP request\n    baseUrl = 'http://www.adventar.org'\n    request baseUrl + '/', (_, res) ->\n\n      # parse response body\n      $ = cheerio.load res.body\n      calendars = []\n      $('.mod-calendarList .mod-calendarList-title a').each ->\n        a = $ @\n        url = baseUrl + a.attr('href')\n        name = a.text()\n        calendars.push { url, name }\n\n      # filter calendars\n      filtered = calendars.filter (c) ->\n        if query? then c.name.match(new RegExp(query, 'i')) else true\n\n      # format calendars\n      message = filtered\n        .map (c) ->\n          \"#{c.name} #{c.url}\"\n        .join '\\n'\n\n      msg.send message\n\n\n\n\u89e3\u8aac\n\u3048\u3048\u3068\u3001\u89e3\u8aac\u3057\u307e\u3059\u3002\n\nrequire\n\ncheerio = require 'cheerio'\nrequest = require 'request'\n\ncheerio / request \u3068\u3044\u3046\u5909\u6570\u306b\u305d\u308c\u305e\u308c npm \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\u4f7f\u3044\u304b\u305f\u306e\u8a73\u7d30\u306f\u305d\u308c\u305e\u308c\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\n(?: (\\S+))?\n\nrobot.respond /adventar(?: (\\S+))?/, (msg) ->\n\nHubot \u30b9\u30af\u30ea\u30d7\u30c8\u306b\u9650\u3063\u305f\u8a71\u3058\u3083\u306a\u3044\u3051\u3069\u3001\u500b\u4eba\u7684\u306b\u3053\u306e (?: (\\S+))? \u3084 (?:\\s+(\\S+))? \u306e\u3088\u3046\u306a\u6b63\u898f\u8868\u73fe\u3092\u3088\u304f\u4f7f\u3044\u307e\u3059\u3002(?:) \u306f\u30de\u30c3\u30c1\u3057\u3066\u3082\u53d6\u308a\u51fa\u3057\u306e\u969b\u306e\u30b0\u30eb\u30fc\u30d7\u306b\u306f\u8ffd\u52a0\u3055\u308c\u307e\u305b\u3093\u3002\n\nrequest\n\n# send HTTP request\nbaseUrl = 'http://www.adventar.org'\nrequest baseUrl + '/', (_, res) ->\n\n\u7d20\u6734\u306b HTTP \u30ea\u30af\u30a8\u30b9\u30c8 + \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u306e\u8a2d\u5b9a\u3002Node.js \u3067\u306e\u57fa\u672c\u5f62\u3067\u3059\u3002\u4eca\u56de\u306f\u624b\u629c\u304d\u306e\u305f\u3081\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u306e\u7b2c\u4e00\u5f15\u6570\u306e err \u3092\u7121\u8996\u3057\u3066\u3044\u307e\u3059\u3002\n\ncheerio\n\n# parse response body\n$ = cheerio.load res.body\ncalendars = []\n$('.mod-calendarList .mod-calendarList-title a').each ->\n  a = $ @\n  url = baseUrl + a.attr('href')\n  name = a.text()\n  calendars.push { url, name }\n\ncheerio \u3092\u4f7f\u3046\u3068 jQuery \u306e\u3088\u3046\u306a\u30bb\u30ec\u30af\u30bf\u306a\u3069\u304c\u4f7f\u3048\u308b\u3002\u307c\u304f\u306f\u57fa\u672c\u7684\u306b\u306f\u4e0a\u8a18\u306e\u3088\u3046\u306b\u60c5\u5831\u3092\u629c\u304d\u51fa\u3057\u305f\u3089\u3064\u3081\u304b\u3048\u3066\u3001\u305d\u308c\u4ee5\u964d\u306f cheerio \u3092\u4f7f\u308f\u306a\u3044\u4e3b\u7fa9\u3067\u3059\u3002cheerio \u3067\u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30a4\u30f3\u3059\u308b\u3068\u308f\u304b\u308a\u3065\u3089\u3044\u306e\u3067\u3002\n\u3042\u3068\u306f\u7279\u306b\u306a\u3044\u304b\u306a\u3002\u666e\u901a\u306e JavaScript \u306a\u52d5\u304d\u3060\u3057\u3002\u3044\u3064\u3082\u306a\u3089\u9762\u5012\u306a\u306e\u3067\u5168\u90e8\u30c1\u30a7\u30a4\u30f3\u306b\u3057\u3066\u3044\u308b\u3051\u3069\u3001\u30b3\u30e1\u30f3\u30c8\u3044\u308c\u305f\u307b\u3046\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u304b\u3068\u601d\u3063\u3066\u3001\u533a\u5207\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u52d5\u304b\u3057\u3066\u307f\u308b\n\u3058\u3083\u3042\u3001\u52d5\u304b\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n$ HUBOT_SHELL_USER_NAME='bouzuya' PATH=\"./node_modules/hubot/node_modules/.bin:$PATH\" $(npm bin)/hubot -a shell -n hubot -r src\nhubot> hubot adventar hubot\nhubot> Hubot http://www.adventar.org/calendars/384\nhubot> hubot adventar\n...\n\u3044\u308d\u3075 http://www.adventar.org/calendars/331\n\u8499\u53e4\u30bf\u30f3\u30e1\u30f3\u4e2d\u672c http://www.adventar.org/calendars/330\n\u30e9\u30fc\u30e1\u30f3 http://www.adventar.org/calendars/329\n\u30d7\u30ea\u30ad\u30e5\u30a2 http://www.adventar.org/calendars/328\n\u3057\u3087\u307c\u3061\u3080 http://www.adventar.org/calendars/327\nhubot> \n\n\u3088\u3044\u306e\u3067\u306f\n\n\u307e\u3068\u3081\n\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3092\u3059\u308b Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3064\u304f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u305d\u3093\u306a\u306b\u7d30\u304b\u304f\u8aac\u660e\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u305f\u3076\u3093\u5927\u4e08\u592b\u3067\u3057\u3087\u3046\u3002\u3082\u3046\u307c\u304f\u306e\u77e5\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u307b\u307c\u66f8\u3044\u305f\u3068\u8a00\u3063\u3066\u826f\u3044\u3067\u3059\u306d\u3002\n\u3061\u306a\u307f\u306b\u4eca\u56de\u306e\u30b5\u30f3\u30d7\u30eb\u306f bouzuya/hubot-adventar \u306b\u3042\u308a\u307e\u3059\u3002\u3046\u307e\u304f\u52d5\u304b\u306a\u3044\u3001\u306a\u3069\u304c\u3042\u308c\u3070\u53c2\u8003\u306b\u3069\u3046\u305e\u3002\n\n\u6700\u5f8c\u306b\n\u3053\u3046\u3044\u3046\u5834\u9762\u3067\u7d39\u4ecb\u3059\u308b\u306e\u306b\u3061\u3087\u3046\u3069\u826f\u3044 API \u3063\u3066\u4f55\u306a\u306e\u3067\u3057\u3087\u3046\u3002\u3067\u304d\u308c\u3070\u30c8\u30fc\u30af\u30f3\u306a\u3069\u304c\u4e0d\u8981\u3067\u3001\u305d\u308c\u306a\u308a\u306b\u77e5\u540d\u5ea6\u304c\u3042\u3063\u3066\u3001\u53ef\u80fd\u306a\u3089\u753b\u50cf\u3092\u8fd4\u3057\u3066\u304f\u308c\u308b\u3068 Slack \u306a\u3069\u3067\u898b\u308b\u3068\u975e\u5e38\u306b\u826f\u3044\u306e\u3067\u3059\u304c\u3002\n\u6b21\u56de\u3069\u3046\u3057\u307e\u3057\u3087\u3046\u304b\u3002Hubot \u3067 HTTP \u3092\u5f85\u3061\u53d7\u3051\u308b\u8a71\u3067\u3082\u3057\u307e\u3057\u3087\u3046\u304b\u306d\u3002\n\u3067\u306f\u3002\n\u3053\u308c\u306f [Hubot Advent Calendar 2014][hubot-adventar-2014] \u306e 9 \u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n\u6628\u65e5\u306f @udzura \u3055\u3093\u306e \u300e[carrier\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u96d1\u306bHubot\u304b\u3089\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064][hubot-adventar-2014-8]\u300f\u3067\u3057\u305f\u3002stream \u3092\u4e2d\u5fc3\u3068\u3057\u305f\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f Node.js \u3089\u3057\u3044\u826f\u3044\u5f62\u306a\u306e\u3067\u3059\u304c\u3001\u307c\u304f\u500b\u4eba\u3068\u3057\u3066\u306f\u3042\u3093\u307e\u308a\u4f7f\u3048\u3066\u306a\u3044\u3067\u3059\u306d\u3002\u3042\u3068 @bouzuya Advent Calendar \u7684\u306a\u717d\u308a\u304c\u898b\u3048\u305f\u6c17\u3082\u3057\u307e\u3059\u304c\u3001\u6c17\u306e\u305b\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u307e\u305f\u3001\u4eca\u56de\u306f @bouzuya \u306e Hubot \u9023\u8f09\u306e\u7b2c 7 \u56de\u3067\u3059\u3002[\u76ee\u6b21\u306f\u3001\u7b2c 1 \u56de\u306e\u8a18\u4e8b\u306b\u3042\u308b][hubot-adventar-2014-bouzuya-index]\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u3069\u3046\u305e\u3002\n\n# \u524d\u56de\u307e\u3067\u3001\u305d\u3057\u3066\u4eca\u56de\u306f\n\n\u524d\u56de\u306f [\u7c21\u5358\u306a Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3082\u3063\u3068\u3064\u304f\u308d\u3046 (\u304a\u307f\u304f\u3058\u7cfb)][hubot-adventar-2014-7] \u3068\u3044\u3046\u3053\u3068\u3067\u3001`Response#random` \u3092\u4f7f\u3063\u3066\u3001\u30e9\u30f3\u30c0\u30e0\u306b\u3072\u3068\u3064\u3092\u9078\u3093\u3067\u8fd4\u3059 Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3064\u304f\u308a\u307e\u3057\u305f\u3002\n\n\u4eca\u56de\u306f\u5916\u90e8\u306e npm \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f7f\u3044\u306a\u304c\u3089\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3059\u308b Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3064\u304f\u308a\u307e\u3057\u3087\u3046\u3002npm \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u81ea\u7531\u306b\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308c\u3070\u3001\u3067\u304d\u308b\u3053\u3068\u304c\u3055\u3089\u306b\u5e83\u304c\u308a\u307e\u3059\u3002\n\n# \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\n\n\u307e\u305a\u3001\u4eca\u56de\u3064\u304f\u308d\u3046\u3068\u3057\u3066\u3044\u308b Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u5171\u6709\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u4eca\u56de\u306f\u300c\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u300d\u3068\u3044\u3046\u3053\u3068\u3067\u3001[Hubot Advent Calendar 2014][hubot-adventar-2014] \u3067\u3082\u5229\u7528\u3057\u3066\u3044\u308b\u300c [Adventar][adventar] \u300d\u306b HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u3057\u3066\u3001\u305d\u306e\u7d50\u679c\u3092\u89e3\u6790\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u5b9f\u884c\u30a4\u30e1\u30fc\u30b8\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n```\nbouzuya> hubot adventar hubot\nhubot> Hubot http://www.adventar.org/calendars/384\n```\n\n# \u3055\u3063\u305d\u304f\u3064\u304f\u308b\n\n\u307e\u305a\u306f Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092 `generator-hubot` \u3067\u751f\u6210\u3057\u307e\u3059\u3002\n\n```bash\n$ mkdir hubot-adventar\n$ cd hubot-adventar\n\n$ yo hubot:script\n...\n```\n\n\u3082\u3046\u6163\u308c\u305f\u3082\u306e\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u6b21\u306b Node.js \u306e\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3067\u306e\u5b9a\u756a\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3042\u308b `request` \u3068 `cheerio` \u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067 npm \u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u305d\u308c\u3089\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001`package.json` \u306b\u4f9d\u5b58\u95a2\u4fc2\u3092\u8ffd\u52a0\u3067\u304d\u307e\u3059\u3002 \n\n```bash\n$ npm install --save request cheerio\nrequest@2.49.0 node_modules/request\n\u251c\u2500\u2500 caseless@0.8.0\n\u251c\u2500\u2500 json-stringify-safe@5.0.0\n\u251c\u2500\u2500 forever-agent@0.5.2\n\u251c\u2500\u2500 aws-sign2@0.5.0\n\u251c\u2500\u2500 stringstream@0.0.4\n\u251c\u2500\u2500 tunnel-agent@0.4.0\n\u251c\u2500\u2500 oauth-sign@0.5.0\n\u251c\u2500\u2500 node-uuid@1.4.2\n\u251c\u2500\u2500 qs@2.3.3\n\u251c\u2500\u2500 mime-types@1.0.2\n\u251c\u2500\u2500 combined-stream@0.0.7 (delayed-stream@0.0.5)\n\u251c\u2500\u2500 form-data@0.1.4 (mime@1.2.11, async@0.9.0)\n\u251c\u2500\u2500 tough-cookie@0.12.1 (punycode@1.3.2)\n\u251c\u2500\u2500 http-signature@0.10.0 (assert-plus@0.1.2, asn1@0.1.11, ctype@0.5.2)\n\u251c\u2500\u2500 bl@0.9.3 (readable-stream@1.0.33)\n\u2514\u2500\u2500 hawk@1.1.1 (cryptiles@0.2.2, sntp@0.2.4, boom@0.4.2, hoek@0.9.1)\n\ncheerio@0.18.0 node_modules/cheerio\n\u251c\u2500\u2500 entities@1.1.1\n\u251c\u2500\u2500 lodash@2.4.1\n\u251c\u2500\u2500 dom-serializer@0.0.1 (domelementtype@1.1.3)\n\u251c\u2500\u2500 htmlparser2@3.8.2 (domelementtype@1.1.3, domutils@1.5.0, entities@1.0.0, domhandler@2.3.0, readable-stream@1.1.13)\n\u2514\u2500\u2500 CSSselect@0.4.1 (domutils@1.4.3, CSSwhat@0.4.7)\n```\n\n\u7c21\u5358\u3067\u3059\u306d\u3002npm \u306f\u3053\u306e\u3088\u3046\u306b\u7c21\u5358\u306b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u8ffd\u52a0\u3067\u304d\u307e\u3059\u3002`dependencies` \u3082\u304d\u3061\u3093\u3068\u30bd\u30fc\u30c8\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u3055\u3066\u3001\u66f8\u3044\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\u3067\u306f\u3001\u3053\u3061\u3089\u306b\u5b8c\u6210\u3057\u305f\u3082\u306e\u304c\u3054\u3056\u3044\u307e\u3059\u3002\n\n```coffeescript:src/adventar.coffee\n# Description\n#   A Hubot script for listing advent calendars in Adventar\n#\n# Configuration:\n#   None\n#\n# Commands:\n#   hubot adventar <query> - lists advent calendars in Adventar\n#\n# Author:\n#   bouzuya <m@bouzuya.net>\n\ncheerio = require 'cheerio'\nrequest = require 'request'\n\nmodule.exports = (robot) ->\n\n  robot.respond /adventar(?: (\\S+))?/, (msg) ->\n    query = msg.match[1]\n\n    # send HTTP request\n    baseUrl = 'http://www.adventar.org'\n    request baseUrl + '/', (_, res) ->\n\n      # parse response body\n      $ = cheerio.load res.body\n      calendars = []\n      $('.mod-calendarList .mod-calendarList-title a').each ->\n        a = $ @\n        url = baseUrl + a.attr('href')\n        name = a.text()\n        calendars.push { url, name }\n\n      # filter calendars\n      filtered = calendars.filter (c) ->\n        if query? then c.name.match(new RegExp(query, 'i')) else true\n\n      # format calendars\n      message = filtered\n        .map (c) ->\n          \"#{c.name} #{c.url}\"\n        .join '\\n'\n\n      msg.send message\n```\n\n# \u89e3\u8aac\n\n\u3048\u3048\u3068\u3001\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n## `require`\n\n```coffeescript\ncheerio = require 'cheerio'\nrequest = require 'request'\n```\n\n`cheerio` / `request` \u3068\u3044\u3046\u5909\u6570\u306b\u305d\u308c\u305e\u308c npm \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u8aad\u307f\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\u4f7f\u3044\u304b\u305f\u306e\u8a73\u7d30\u306f\u305d\u308c\u305e\u308c\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\n## `(?: (\\S+))?`\n\n```coffeescript\nrobot.respond /adventar(?: (\\S+))?/, (msg) ->\n```\n\nHubot \u30b9\u30af\u30ea\u30d7\u30c8\u306b\u9650\u3063\u305f\u8a71\u3058\u3083\u306a\u3044\u3051\u3069\u3001\u500b\u4eba\u7684\u306b\u3053\u306e `(?: (\\S+))?` \u3084 `(?:\\s+(\\S+))?` \u306e\u3088\u3046\u306a\u6b63\u898f\u8868\u73fe\u3092\u3088\u304f\u4f7f\u3044\u307e\u3059\u3002`(?:)` \u306f\u30de\u30c3\u30c1\u3057\u3066\u3082\u53d6\u308a\u51fa\u3057\u306e\u969b\u306e\u30b0\u30eb\u30fc\u30d7\u306b\u306f\u8ffd\u52a0\u3055\u308c\u307e\u305b\u3093\u3002\n\n## `request`\n\n```coffeescript\n# send HTTP request\nbaseUrl = 'http://www.adventar.org'\nrequest baseUrl + '/', (_, res) ->\n```\n\n\u7d20\u6734\u306b HTTP \u30ea\u30af\u30a8\u30b9\u30c8 + \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u306e\u8a2d\u5b9a\u3002Node.js \u3067\u306e\u57fa\u672c\u5f62\u3067\u3059\u3002\u4eca\u56de\u306f\u624b\u629c\u304d\u306e\u305f\u3081\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u306e\u7b2c\u4e00\u5f15\u6570\u306e `err` \u3092\u7121\u8996\u3057\u3066\u3044\u307e\u3059\u3002\n\n## `cheerio`\n\n```coffeescript\n# parse response body\n$ = cheerio.load res.body\ncalendars = []\n$('.mod-calendarList .mod-calendarList-title a').each ->\n  a = $ @\n  url = baseUrl + a.attr('href')\n  name = a.text()\n  calendars.push { url, name }\n```\n\n`cheerio` \u3092\u4f7f\u3046\u3068 jQuery \u306e\u3088\u3046\u306a\u30bb\u30ec\u30af\u30bf\u306a\u3069\u304c\u4f7f\u3048\u308b\u3002\u307c\u304f\u306f\u57fa\u672c\u7684\u306b\u306f\u4e0a\u8a18\u306e\u3088\u3046\u306b\u60c5\u5831\u3092\u629c\u304d\u51fa\u3057\u305f\u3089\u3064\u3081\u304b\u3048\u3066\u3001\u305d\u308c\u4ee5\u964d\u306f `cheerio` \u3092\u4f7f\u308f\u306a\u3044\u4e3b\u7fa9\u3067\u3059\u3002`cheerio` \u3067\u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30a4\u30f3\u3059\u308b\u3068\u308f\u304b\u308a\u3065\u3089\u3044\u306e\u3067\u3002\n\n\u3042\u3068\u306f\u7279\u306b\u306a\u3044\u304b\u306a\u3002\u666e\u901a\u306e JavaScript \u306a\u52d5\u304d\u3060\u3057\u3002\u3044\u3064\u3082\u306a\u3089\u9762\u5012\u306a\u306e\u3067\u5168\u90e8\u30c1\u30a7\u30a4\u30f3\u306b\u3057\u3066\u3044\u308b\u3051\u3069\u3001\u30b3\u30e1\u30f3\u30c8\u3044\u308c\u305f\u307b\u3046\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u304b\u3068\u601d\u3063\u3066\u3001\u533a\u5207\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n# \u52d5\u304b\u3057\u3066\u307f\u308b\n\n\u3058\u3083\u3042\u3001\u52d5\u304b\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```bash\n$ HUBOT_SHELL_USER_NAME='bouzuya' PATH=\"./node_modules/hubot/node_modules/.bin:$PATH\" $(npm bin)/hubot -a shell -n hubot -r src\nhubot> hubot adventar hubot\nhubot> Hubot http://www.adventar.org/calendars/384\nhubot> hubot adventar\n...\n\u3044\u308d\u3075 http://www.adventar.org/calendars/331\n\u8499\u53e4\u30bf\u30f3\u30e1\u30f3\u4e2d\u672c http://www.adventar.org/calendars/330\n\u30e9\u30fc\u30e1\u30f3 http://www.adventar.org/calendars/329\n\u30d7\u30ea\u30ad\u30e5\u30a2 http://www.adventar.org/calendars/328\n\u3057\u3087\u307c\u3061\u3080 http://www.adventar.org/calendars/327\nhubot> \n```\n\n\u3088\u3044\u306e\u3067\u306f\n\n# \u307e\u3068\u3081\n\n\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3092\u3059\u308b Hubot \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3064\u304f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u305d\u3093\u306a\u306b\u7d30\u304b\u304f\u8aac\u660e\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u305f\u3076\u3093\u5927\u4e08\u592b\u3067\u3057\u3087\u3046\u3002\u3082\u3046\u307c\u304f\u306e\u77e5\u3063\u3066\u3044\u308b\u3053\u3068\u306f\u307b\u307c\u66f8\u3044\u305f\u3068\u8a00\u3063\u3066\u826f\u3044\u3067\u3059\u306d\u3002\n\n\u3061\u306a\u307f\u306b\u4eca\u56de\u306e\u30b5\u30f3\u30d7\u30eb\u306f [bouzuya/hubot-adventar][] \u306b\u3042\u308a\u307e\u3059\u3002\u3046\u307e\u304f\u52d5\u304b\u306a\u3044\u3001\u306a\u3069\u304c\u3042\u308c\u3070\u53c2\u8003\u306b\u3069\u3046\u305e\u3002\n\n# \u6700\u5f8c\u306b\n\n\u3053\u3046\u3044\u3046\u5834\u9762\u3067\u7d39\u4ecb\u3059\u308b\u306e\u306b\u3061\u3087\u3046\u3069\u826f\u3044 API \u3063\u3066\u4f55\u306a\u306e\u3067\u3057\u3087\u3046\u3002\u3067\u304d\u308c\u3070\u30c8\u30fc\u30af\u30f3\u306a\u3069\u304c\u4e0d\u8981\u3067\u3001\u305d\u308c\u306a\u308a\u306b\u77e5\u540d\u5ea6\u304c\u3042\u3063\u3066\u3001\u53ef\u80fd\u306a\u3089\u753b\u50cf\u3092\u8fd4\u3057\u3066\u304f\u308c\u308b\u3068 Slack \u306a\u3069\u3067\u898b\u308b\u3068\u975e\u5e38\u306b\u826f\u3044\u306e\u3067\u3059\u304c\u3002\n\n\u6b21\u56de\u3069\u3046\u3057\u307e\u3057\u3087\u3046\u304b\u3002Hubot \u3067 HTTP \u3092\u5f85\u3061\u53d7\u3051\u308b\u8a71\u3067\u3082\u3057\u307e\u3057\u3087\u3046\u304b\u306d\u3002\n\n\u3067\u306f\u3002\n\n[getting-started-with-hubot]: https://github.com/github/hubot/tree/v2.9.3/docs#getting-started-with-hubot\n[bouzuya/hubot-hello-world]: https://github.com/bouzuya/hubot-hello-world/\n[bouzuya/hubot-choice]: https://github.com/bouzuya/hubot-choice/\n[bouzuya/hubot-adventar]: https://github.com/bouzuya/hubot-adventar/\n[github/hubot]: https://github.com/github/hubot/\n[hubot.github.com]: https://hubot.github.com/\n[hubot-adventar-2014]: http://www.adventar.org/calendars/384\n[hubot-adventar-2014-bouzuya-index]: http://qiita.com/bouzuya/items/c7d0ad80c357aab6b696\n[hubot-adventar-2014-1]: http://qiita.com/bouzuya/items/c7d0ad80c357aab6b696\n[hubot-adventar-2014-2]: http://qiita.com/bouzuya/items/11c0c6da2b3ad54b827f\n[hubot-adventar-2014-3]: http://qiita.com/bouzuya/items/2a200c9e8a45e2478bc2\n[hubot-adventar-2014-4]: http://qiita.com/bouzuya/items/4c0206d72ff22ade9339\n[hubot-adventar-2014-5]: http://pasero.net/~mako/blog/s/685\n[hubot-adventar-2014-6]: http://qiita.com/bouzuya/items/4e051f68f8d68a2944b0\n[hubot-adventar-2014-7]: http://qiita.com/bouzuya/items/2e935c99647b93d8ee1d\n[hubot-adventar-2014-8]: http://udzura.hatenablog.jp/entry/2014/12/08/182744\n[ops-for-everyone]: https://speakerdeck.com/johndbritton/ops-for-everyone\n[adventar]: http://www.adventar.org/\n", "tags": ["Hubot2.10.0", "\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0"]}