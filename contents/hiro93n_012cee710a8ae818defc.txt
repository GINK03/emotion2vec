{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n\u7c21\u5358\u306a\u304a\u554f\u3044\u5408\u308f\u305b\u30d5\u30a9\u30fc\u30e0\u304c\u5fc5\u8981\u3060\u3063\u305f\u306e\u3067\u3064\u304f\u308a\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306f\u3055\u304f\u3089\u30b5\u30fc\u30d0\u306e\u30e1\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u30e1\u30fc\u30eb\u3092\u9001\u3063\u3066\u3044\u307e\u3059\u3002\n\u307e\u305a\u30ed\u30b8\u30c3\u30af\u5074\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\ncontact.js\nvar express = require('express');\nvar router = express.Router();\n\n// \u4e0b\u306e\uff12\u3064\u306fnpm install\u3067\u65b0\u305f\u306b\u5165\u308c\u308b\u3082\u306e\nvar nodemailer = require(\"nodemailer\");\nvar smtpTransport = require('nodemailer-smtp-transport');\n\nrouter.get('/', function(req, res, next) {\n    var types = [\n    {value:'--\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044--'}, \n    {value:'\u304c\u3063\u3053\u3046\u306b\u3064\u3044\u3066'},\n    {value:'\u3076\u304b\u3064\u306b\u3064\u3044\u3066'},\n    {value:'\u305d\u306e\u4ed6'}\n    ];\n    res.render('contact', {\n        title: '\u304a\u554f\u3044\u5408\u308f\u305b',\n        types: types,\n    });\n});\n\nrouter.post('/', function(req, res, next) {\n// \u30e1\u30fc\u30eb\u5185\u5bb9\u306e\u53d6\u5f97\nvar types = req.body.type;  \nvar name = req.body.name;  \nvar email = req.body.mail;\nvar message = req.body.message;\n\n// SMTP\u30b5\u30fc\u30d0\u30fc\u306e\u8a2d\u5b9a\nvar transporter = nodemailer.createTransport(smtpTransport({\n    host: \"XXXXX.sakura.ne.jp\",\n    port: 587,\n    tls: true,\n// web\u30e1\u30fc\u30eb\u306e\u30ed\u30b0\u30a4\u30f3\u30a2\u30ab\u30a6\u30f3\u30c8\n    auth: {\n        user: \"info@XXXXX.sakura.ne.jp\",\n        pass: \"passwd\"\n    }\n}));\n\ntransporter.sendMail({\n    from: '\u304a\u554f\u3044\u5408\u308f\u305b <info@example.com>',\n    // \u304a\u554f\u3044\u5408\u308f\u305b\u53d7\u3051\u53d6\u308a\u5148\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\n    to: 'contact@example.com',\n    subject: types,\n    text: message + \"/\" + name + \"/\" + email,\n    html: message + \"<br>\" + name + \"<br>\" + email\n    }, function(err){\n        if(err) return next(err);\n        console.log(\"\u304a\u554f\u3044\u5408\u308f\u305b\u30e1\u30fc\u30eb\u9001\u4fe1\u5b8c\u4e86\");\n    //\u3000\u5b8c\u4e86\u30da\u30fc\u30b8\u3078\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\n    res.redirect('/done');\n    });\n});\n\nrouter.get('/done', function(req, res, next) {\n    res.render('contact_done', {\n        title: '\u304a\u554f\u3044\u5408\u308f\u305b\u3092\u53d7\u3051\u4ed8\u3051\u307e\u3057\u305f',\n    });\n});\n\nmodule.exports = router;\n\n\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u5074\u306f\u3053\u3093\u306a\u611f\u3058\u3002swig\u3067\u66f8\u3044\u3066\u307e\u3059\u3002\n\ncontact.html\n<section class=\"section\">\n    <h1><span class=\"content\">\u304a\u554f\u3044\u5408\u308f\u305b</span></h1>\n\n    <form method=\"POST\" class=\"content form contactForm\">\n        <dl>\n            <dt>\u304a\u554f\u3044\u5408\u308f\u305b\u306e\u7a2e\u985e (\u5fc5\u9808)</dt>\n            <dd>\n                <div class=\"selectWrap\">\n                    <select name=\"type\">\n{% for t in types %}\n                        <option value=\"{{t.value}}\">{{t.value}}</option>\n{% endfor %}\n                    </select>\n                </div>\n            </dd>\n            <dt>\u304a\u540d\u524d (\u5fc5\u9808)</dt>\n            <dd><input type=\"text\" name=\"name\" required></dd>\n            <dt>\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9 (\u5fc5\u9808)</dt>\n            <dd><input type=\"email\" name=\"mail\" required></dd>\n            <dt>\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9</dt>\n            <dd><textarea name=\"message\" required></textarea></dd>\n        </dl>\n        <div class=\"btnWrap\">\n            <button type=\"submit\" class=\"button\">\u9001\u4fe1\u3059\u308b</button>\n        </div>\n    </form>\n</section>\n\n\n\u305d\u308c\u3067\u306f\u826f\u304d\u304a\u554f\u3044\u5408\u308f\u305b\u30e9\u30a4\u30d5\u3092\uff01\n\n\u74b0\u5883\nexpress4.9 / io.js v2.3.3\n# \u6982\u8981\n\u7c21\u5358\u306a\u304a\u554f\u3044\u5408\u308f\u305b\u30d5\u30a9\u30fc\u30e0\u304c\u5fc5\u8981\u3060\u3063\u305f\u306e\u3067\u3064\u304f\u308a\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306f\u3055\u304f\u3089\u30b5\u30fc\u30d0\u306e\u30e1\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u30e1\u30fc\u30eb\u3092\u9001\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u307e\u305a\u30ed\u30b8\u30c3\u30af\u5074\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n```contact.js\nvar express = require('express');\nvar router = express.Router();\n\n// \u4e0b\u306e\uff12\u3064\u306fnpm install\u3067\u65b0\u305f\u306b\u5165\u308c\u308b\u3082\u306e\nvar nodemailer = require(\"nodemailer\");\nvar smtpTransport = require('nodemailer-smtp-transport');\n\nrouter.get('/', function(req, res, next) {\n\tvar types = [\n\t{value:'--\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044--'},\t\n\t{value:'\u304c\u3063\u3053\u3046\u306b\u3064\u3044\u3066'},\n\t{value:'\u3076\u304b\u3064\u306b\u3064\u3044\u3066'},\n\t{value:'\u305d\u306e\u4ed6'}\n\t];\n\tres.render('contact', {\n\t\ttitle: '\u304a\u554f\u3044\u5408\u308f\u305b',\n\t\ttypes: types,\n\t});\n});\n\nrouter.post('/', function(req, res, next) {\n// \u30e1\u30fc\u30eb\u5185\u5bb9\u306e\u53d6\u5f97\nvar types = req.body.type;  \nvar name = req.body.name;  \nvar email = req.body.mail;\nvar message = req.body.message;\n\n// SMTP\u30b5\u30fc\u30d0\u30fc\u306e\u8a2d\u5b9a\nvar transporter = nodemailer.createTransport(smtpTransport({\n\thost: \"XXXXX.sakura.ne.jp\",\n\tport: 587,\n\ttls: true,\n// web\u30e1\u30fc\u30eb\u306e\u30ed\u30b0\u30a4\u30f3\u30a2\u30ab\u30a6\u30f3\u30c8\n\tauth: {\n\t\tuser: \"info@XXXXX.sakura.ne.jp\",\n\t\tpass: \"passwd\"\n\t}\n}));\n\ntransporter.sendMail({\n\tfrom: '\u304a\u554f\u3044\u5408\u308f\u305b <info@example.com>',\n\t// \u304a\u554f\u3044\u5408\u308f\u305b\u53d7\u3051\u53d6\u308a\u5148\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\n\tto: 'contact@example.com',\n\tsubject: types,\n\ttext: message + \"/\" + name + \"/\" + email,\n\thtml: message + \"<br>\" + name + \"<br>\" + email\n\t}, function(err){\n\t\tif(err) return next(err);\n\t\tconsole.log(\"\u304a\u554f\u3044\u5408\u308f\u305b\u30e1\u30fc\u30eb\u9001\u4fe1\u5b8c\u4e86\");\n\t//\u3000\u5b8c\u4e86\u30da\u30fc\u30b8\u3078\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\n\tres.redirect('/done');\n\t});\n});\n\nrouter.get('/done', function(req, res, next) {\n\tres.render('contact_done', {\n\t\ttitle: '\u304a\u554f\u3044\u5408\u308f\u305b\u3092\u53d7\u3051\u4ed8\u3051\u307e\u3057\u305f',\n\t});\n});\n\nmodule.exports = router;\n\n```\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u5074\u306f\u3053\u3093\u306a\u611f\u3058\u3002swig\u3067\u66f8\u3044\u3066\u307e\u3059\u3002\n\n```contact.html\n<section class=\"section\">\n\t<h1><span class=\"content\">\u304a\u554f\u3044\u5408\u308f\u305b</span></h1>\n\n\t<form method=\"POST\" class=\"content form contactForm\">\n\t\t<dl>\n\t\t\t<dt>\u304a\u554f\u3044\u5408\u308f\u305b\u306e\u7a2e\u985e (\u5fc5\u9808)</dt>\n\t\t\t<dd>\n\t\t\t\t<div class=\"selectWrap\">\n\t\t\t\t\t<select name=\"type\">\n{% for t in types %}\n\t\t\t\t\t\t<option value=\"{{t.value}}\">{{t.value}}</option>\n{% endfor %}\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t</dd>\n\t\t\t<dt>\u304a\u540d\u524d (\u5fc5\u9808)</dt>\n\t\t\t<dd><input type=\"text\" name=\"name\" required></dd>\n\t\t\t<dt>\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9 (\u5fc5\u9808)</dt>\n\t\t\t<dd><input type=\"email\" name=\"mail\" required></dd>\n\t\t\t<dt>\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9</dt>\n\t\t\t<dd><textarea name=\"message\" required></textarea></dd>\n\t\t</dl>\n\t\t<div class=\"btnWrap\">\n\t\t\t<button type=\"submit\" class=\"button\">\u9001\u4fe1\u3059\u308b</button>\n\t\t</div>\n\t</form>\n</section>\n```\n\n\u305d\u308c\u3067\u306f\u826f\u304d\u304a\u554f\u3044\u5408\u308f\u305b\u30e9\u30a4\u30d5\u3092\uff01\n\n## \u74b0\u5883\nexpress4.9 / io.js v2.3.3\n", "tags": ["Express", "Node.js"]}