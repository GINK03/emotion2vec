{"tags": ["jq", "AWS", "awscli"], "context": " More than 1 year has passed since last update.Evernote\u306b\u66f8\u304d\u6e9c\u3081\u3066\u3044\u308b\u7269\u3092Qiita\u5316\u3057\u3066\u3044\u304f\u3053\u3068\u306b\u3059\u308b\u3002\n\n\n\n\u4f7f\u7528\u74b0\u5883\n\u30d0\u30fc\u30b8\u30e7\u30f3\n\n\n\n\nMac OS X\n10.7.5\n\n\nPython\n2.7.6\n\n\nawscli\n1.3.1\n\n\njq\n1.3\n\n\n\n\nawscli\u3068jq\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nawscli\uff08Python2.6\u4ee5\u4e0a\u5fc5\u8981\uff09\npip install awscli\n\n#version\u304c\u4e0a\u304c\u3063\u305f\u5834\u5408\u306fupgrade\u3059\u308b\npip install awscli --upgrade\n\njq\nbrew install jq\n\n\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306f1.3(2014/3/16)\nbinary\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u5b9f\u884c\u6a29\u9650\u4ed8\u3051\u308b\u3060\u3051\u3067\u4f7f\u7528\u53ef\u80fd\nhttp://stedolan.github.io/jq/\n\nawscli\u4f7f\u7528\u6e96\u5099\n\u591a\u6570\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u6301\u3063\u3066\u3044\u308b\u5834\u5408\u306fcofig\u306b\u307e\u3068\u3081\u3066\u8a18\u8f09\n\nawscli_account.conf\n[profile < account(--profile\u3067\u8a18\u8ff0\u3059\u308b\u540d\u524d) >]\naws_access_key_id = < access key >\naws_secret_access_key = < secret key>\nregion = < aws region >\n\n#\u8a18\u8ff0\u4f8b\n[profile gacharion]\naws_access_key_id = ABCDEFG\naws_secret_access_key = secret1234access\nregion = ap-northeast-1\n\n#default\u306f\"-profile\"\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306b\u9069\u7528\u3055\u308c\u308b\n[default]\naws_access_key_id = <default access key>\naws_secret_access_key = <default secret key>\nregion = <default region>\n\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u8d77\u52d5\u6642\u306btab\u88dc\u5b8c\u304c\u52b9\u304f\u3088\u3046\u306b\u3059\u308b\u3002\n\u307e\u305f\u3001\u4e0a\u8a18conf\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u306a\u3044\u3068\"--profile\"\u3067\u6307\u5b9a\u3067\u304d\u306a\u3044\u306e\u3067export\u3057\u3066\u304a\u304f\u3002\n\n.bashrc\n# tab\u88dc\u5b8c\ncomplete -C aws_completer aws\n# \"--profile\"\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u6307\u5b9a\u3059\u308b\u969b\u306e\u60c5\u5831\u3092\u8a18\u8f09\u3057\u305fconfig\nexport AWS_CONFIG_FILE=/home/gacharion/awscli_account.conf\n# region\u306edefault\u3092\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u306b\uff08\u2b06\u306econfig\u3067\u3082\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u3069\u3061\u3089\u304b\u3067\u5927\u4e08\u592b\uff09\nexport AWS_DEFAULT_REGION=ap-northeast-1\n\n\n# zsh\u306e\u5834\u5408\u306etab\u88dc\u5b8c\u306f\u4e0b\u8a18\n# virtualenv\u74b0\u5883\u306e\u5834\u5408\nsource ~/.virtualenvs/2.7.6/bin/aws_zsh_completer.sh\n\n\n\u4f7f\u3044\u65b9\n$ aws --version\naws-cli/1.3.1 Python/2.7.6 Darwin/11.4.2\n\n$ jq\n\njq - commandline JSON processor [version 1.3]\nUsage: jq [options] <jq filter> [file...]\n\nFor a description of the command line options and\nhow to write jq filters (and why you might want to)\nsee the jq manpage, or the online documentation at\nhttp://stedolan.github.com/jq\n\n\nAvailabilityZone\u6bce\u306e\u30b9\u30dd\u30c3\u30c8\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u53f0\u6570\u3092\u3068\u308b\u4f8b\n$ aws ec2 describe-spot-instance-requests \\\n    --profile gacharion \\\n    | jq '[ .SpotInstanceRequests[] | { LaunchedAvailabilityZone } ] | group_by(.LaunchedAvailabilityZone) | .[] | .[0] + { \"Count\": length }'\n\n\nEvernote\u306b\u66f8\u304d\u6e9c\u3081\u3066\u3044\u308b\u7269\u3092Qiita\u5316\u3057\u3066\u3044\u304f\u3053\u3068\u306b\u3059\u308b\u3002\n\n\n| \u4f7f\u7528\u74b0\u5883 | \u30d0\u30fc\u30b8\u30e7\u30f3 |\n|:-----------|------------:|\n| Mac OS X   |   10.7.5   |\n| Python     | 2.7.6 |\n| awscli     | 1.3.1 |\n| jq         | 1.3\n\n\n## awscli\u3068jq\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nawscli\uff08Python2.6\u4ee5\u4e0a\u5fc5\u8981\uff09\n\n```bash\npip install awscli\n\n#version\u304c\u4e0a\u304c\u3063\u305f\u5834\u5408\u306fupgrade\u3059\u308b\npip install awscli --upgrade\n```\n\njq\n\n##\n```bash\nbrew install jq\n```\n\n\n\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u306f1.3(2014/3/16)\nbinary\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u5b9f\u884c\u6a29\u9650\u4ed8\u3051\u308b\u3060\u3051\u3067\u4f7f\u7528\u53ef\u80fd\nhttp://stedolan.github.io/jq/\n\n\n## awscli\u4f7f\u7528\u6e96\u5099\n**\u591a\u6570\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u6301\u3063\u3066\u3044\u308b\u5834\u5408\u306fcofig\u306b\u307e\u3068\u3081\u3066\u8a18\u8f09**\n\n```Bash:awscli_account.conf\n[profile < account(--profile\u3067\u8a18\u8ff0\u3059\u308b\u540d\u524d) >]\naws_access_key_id = < access key >\naws_secret_access_key = < secret key>\nregion = < aws region >\n\n#\u8a18\u8ff0\u4f8b\n[profile gacharion]\naws_access_key_id = ABCDEFG\naws_secret_access_key = secret1234access\nregion = ap-northeast-1\n\n#default\u306f\"-profile\"\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306b\u9069\u7528\u3055\u308c\u308b\n[default]\naws_access_key_id = <default access key>\naws_secret_access_key = <default secret key>\nregion = <default region>\n\n```\n\n**\u30b3\u30f3\u30bd\u30fc\u30eb\u8d77\u52d5\u6642\u306btab\u88dc\u5b8c\u304c\u52b9\u304f\u3088\u3046\u306b\u3059\u308b\u3002\n\u307e\u305f\u3001\u4e0a\u8a18conf\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u306a\u3044\u3068\"--profile\"\u3067\u6307\u5b9a\u3067\u304d\u306a\u3044\u306e\u3067export\u3057\u3066\u304a\u304f\u3002**\n\n```Bash:.bashrc\n# tab\u88dc\u5b8c\ncomplete -C aws_completer aws\n# \"--profile\"\u3067\u30a2\u30ab\u30a6\u30f3\u30c8\u6307\u5b9a\u3059\u308b\u969b\u306e\u60c5\u5831\u3092\u8a18\u8f09\u3057\u305fconfig\nexport AWS_CONFIG_FILE=/home/gacharion/awscli_account.conf\n# region\u306edefault\u3092\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u306b\uff08\u2b06\u306econfig\u3067\u3082\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u3069\u3061\u3089\u304b\u3067\u5927\u4e08\u592b\uff09\nexport AWS_DEFAULT_REGION=ap-northeast-1\n```\n\n```\n# zsh\u306e\u5834\u5408\u306etab\u88dc\u5b8c\u306f\u4e0b\u8a18\n# virtualenv\u74b0\u5883\u306e\u5834\u5408\nsource ~/.virtualenvs/2.7.6/bin/aws_zsh_completer.sh\n```\n\n## \u4f7f\u3044\u65b9\n\n```bash\n$ aws --version\naws-cli/1.3.1 Python/2.7.6 Darwin/11.4.2\n\n$ jq\n\njq - commandline JSON processor [version 1.3]\nUsage: jq [options] <jq filter> [file...]\n\nFor a description of the command line options and\nhow to write jq filters (and why you might want to)\nsee the jq manpage, or the online documentation at\nhttp://stedolan.github.com/jq\n```\n\n###AvailabilityZone\u6bce\u306e\u30b9\u30dd\u30c3\u30c8\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u53f0\u6570\u3092\u3068\u308b\u4f8b\n\n```bash\n$ aws ec2 describe-spot-instance-requests \\\n    --profile gacharion \\\n    | jq '[ .SpotInstanceRequests[] | { LaunchedAvailabilityZone } ] | group_by(.LaunchedAvailabilityZone) | .[] | .[0] + { \"Count\": length }'\n```\n"}