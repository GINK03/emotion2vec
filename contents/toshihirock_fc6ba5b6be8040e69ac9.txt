{"tags": ["openldap"], "context": "Windows\u30ed\u30b0\u30aa\u30f3\u306a\u3069\u3067\u4f7f\u3063\u305f\u3053\u3068\u306f\u3042\u308bLDAP\u3067\u3059\u304c\u3001\u8a73\u7d30\u3084\u69cb\u7bc9\u306a\u3069\u306f\u3084\u3063\u305f\u3053\u3068\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u672c\u3092\u898b\u306a\u304c\u3089\u52c9\u5f37\u3057\u3066\u307f\u305f\u306e\u3067\u30e1\u30e2\u3002\n\u53c2\u8003\u306b\u3055\u305b\u3066\u3082\u3089\u3063\u305f\u672c\u306e\u5185\u5bb9\u3092\u9014\u4e2d\u307e\u3067\u3084\u3063\u305f\u6642\u306e\u4f5c\u696d\u30e1\u30e2\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u53c2\u8003\n\n\u30a4\u30f3\u30d5\u30e9\u30a8\u30f3\u30b8\u30cb\u30a2\u6559\u672c2\u2015\u2015\u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u30fb\u69cb\u7bc9\u6280\u8853\u89e3\u8aac (Software Design\u5225\u518a)\n\u5165\u9580LDAP/OpenLDAP\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30b5\u30fc\u30d3\u30b9\u5c0e\u5165\u30fb\u904b\u7528\u30ac\u30a4\u30c9\u7b2c2\u7248\n\n\n\u74b0\u5883\n\nAmazon Linux AMI 2016.03.1\n\n\nLDAP\u3068\u306f\n\nLightweight Directory Access Protocol\u306e\u7565\u8a9e\u3067\u3001OSI\u53c2\u7167\u30e2\u30c7\u30eb\u3067\u306fHTTP\u306a\u3069\u3068\u540c\u3058\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5c64\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3002\u691c\u7d22(search)\u3001\u8ffd\u52a0(add)\u3001\u524a\u9664(delete)\u3001\u5909\u66f4(modify)\u3068\u3044\u3063\u305f\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u767b\u9332\u3057\u305f\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u63d0\u4f9b\u3002\nLDAP\u3067\u306f\u540d\u524d\u306e\u901a\u308a\u3001Directory\u306e\u7ba1\u7406\u3092\u884c\u3046\u3002LDAP\u306b\u304a\u3051\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u306f\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u306e\u96fb\u8a71\u5e33\u3084\u540d\u7c3f\u306b\u76f8\u5f53\u3057\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u306e\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3084\u30b0\u30eb\u30fc\u30d7\u60c5\u5831\u3092\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u5171\u6709\u3059\u308b\u305f\u3081\u306e\u30b5\u30fc\u30d3\u30b9\nLDAP\u306fLDAP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(\u8a8d\u8a3c\u3055\u308c\u308b\u5074)\u3068LDAP\u30b5\u30fc\u30d0\u30fc(\u8a8d\u8a3c\u3059\u308b)\u3067\u69cb\u6210\u3055\u308c\u308b\u3002LDAP\u30b5\u30fc\u30d0\u30fc\u3092\u8907\u6570\u53f0\u3067\u69cb\u6210\u3057\u3001\u8ca0\u8377\u5206\u6563\u53ca\u3073\u5197\u9577\u5316\u69cb\u6210\u3092\u3068\u308b\u3053\u3068\u3082\u3067\u304d\u308b\nUnix\u30bd\u30b1\u30c3\u30c8\u3082\u3057\u304f\u306fTCP\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u901a\u4fe1\u3002ldap\u30d7\u30ed\u30c8\u30b3\u30eb\u306e389\u30dd\u30fc\u30c8\u304bldaps\u306e636\u30dd\u30fc\u30c8\u3092\u5229\u7528\u3059\u308b\n\n\nLDAP\u306e\u8a2d\u8a08\n\nLDAP\u3067\u306fDIT(Directory Information Tree)\u3068\u3044\u3046\u30c4\u30ea\u30fc\u69cb\u9020\u306e\u30c7\u30fc\u30bf\u5f62\u5f0f\u3067\u60c5\u5831\u3092\u7ba1\u7406\u3059\u308b\n\u30c4\u30ea\u30fc\u306b\u306f\u300c\u30a8\u30f3\u30c8\u30ea\u300d\u3068\u547c\u3070\u308c\u308b\u5358\u4f4d\u3067\u60c5\u5831\u304c\u767b\u9332\u3055\u308c\u308b\n\u4e00\u3064\u306e\u30a8\u30f3\u30c8\u30ea\u306b\u306fDN(Distinguished Name)\u3068\u547c\u3070\u308c\u308b\u30c4\u30ea\u30fc\u69cb\u9020\u5185\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u4f4d\u7f6e\u3092\u793a\u3059\u8b58\u5225\u5b50\u304c\u4e00\u610f\u306b\u4ed8\u4e0e\u3055\u308c\u308b\n\u4e00\u3064\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u8907\u6570\u306e\u300c\u5c5e\u6027\u300d\u3067\u69cb\u6210\u3055\u308c\u308b\u3002\u5c5e\u6027\u306f\u300c\u5c5e\u6027\u540d:\u5024\u300d\u306e\u30bb\u30c3\u30c8\u3067\u767b\u9332\u3055\u308c\u3066\u3044\u308b\n\u30a8\u30f3\u30c8\u30ea\u306b\u306f\u5fc5\u305a\u300cobjectClass\u300d\u3068\u547c\u3070\u308c\u308b\u5c5e\u6027\u304c\u6307\u5b9a\u3055\u308c\u3001\u30a8\u30f3\u30c8\u30ea\u306b\u767b\u9332\u3055\u308c\u308b\u3079\u304d\u5c5e\u6027\u306a\u3069\u3092\u5b9a\u7fa9\u3067\u304d\u308b\nobjectClass\u306f\u30b9\u30ad\u30fc\u30de\u3068\u547c\u3070\u308c\u3001LDAP\u30b5\u30fc\u30d0\u30fc\u3054\u3068\u306b\u5b9a\u7fa9\u3067\u304d\u308b\u304c\u3001\u6a19\u6e96\u7684\u306a\u30b9\u30ad\u30fc\u30de\u306fRFC\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\n\u72ec\u81ea\u306e\u5c5e\u6027\u60c5\u5831\u3092\u8ffd\u52a0\u3057\u305f\u3044\u5834\u5408\u306a\u3069\u306b\u306fobjectClass\u306b\u8ffd\u52a0\u3057\u305f\u3044\u72ec\u81ea\u306e\u5c5e\u6027\u60c5\u5831\u3092\u5b9a\u7fa9\u3059\u308c\u3070OK\n\n\u4ee5\u4e0b\u3001\u3088\u304f\u4f7f\u3046\u5c5e\u6027\u540d\n\n\n\n\u5c5e\u6027\u30bf\u30a4\u30d7\n\u8aac\u660e\n\n\n\n\ndn\n\u8b58\u5225\u5b50(Distinguished Name\n\n\nobjectClass\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30af\u30e9\u30b9\n\n\ndc\n\u30c9\u30e1\u30a4\u30f3\u69cb\u6210\u8981\u7d20(Domain Component\n\n\no\n\u7d44\u7e54\u540d(Organization)\n\n\nou\n\u7d44\u7e54\u5358\u4f4d(Organization Unit\n\n\ncn\n\u4e00\u822c\u540d\u79f0(Common Name)\n\n\n\n\nLDAP\u306e\u8907\u88fd(\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3)\n\nLDAP\u30b5\u30fc\u30d0\u30fc\u3054\u3068\u306e\u8907\u88fd(replication)\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067LDAP\u30b5\u30fc\u30d0\u30fc\u9593\u3067\u30a8\u30f3\u30c8\u30ea\u60c5\u5831\u3092\u5171\u6709\u3057\u3001\u8907\u6570\u53f0\u69cb\u6210\u304c\u3067\u304d\u308b\n\u8907\u88fd\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u304a\u3089\u305a\u3001\u88fd\u54c1\u3054\u3068\u306b\u9055\u3046\u305f\u3081\u3001\u8907\u6570\u53f0\u69cb\u6210\u3092\u884c\u3046\u5834\u5408\u3001\u540c\u3058\u88fd\u54c1\u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308b\n\u30a8\u30f3\u30c8\u30ea\u306e\u8ffd\u52a0\u30fb\u66f4\u65b0\u304c\u53ef\u80fd\u306aLDAP\u30b5\u30fc\u30d0\u30fc\u3092\u30de\u30b9\u30bf\u30fc\u3082\u3057\u304f\u306f\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3068\u547c\u3073\u3001\u30a8\u30f3\u30c8\u30ea\u306e\u53c2\u7167\u306e\u307f\u304c\u53ef\u80fd\u306aLDAP\u30b5\u30fc\u30d0\u30fc\u3092\u30b9\u30ec\u30fc\u30d6\u3082\u3057\u304f\u306f\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u3068\u547c\u3076\n\u4e00\u822c\u7684\u306aLDAP\u88fd\u54c1\u3067\u306f\u8907\u6570\u53f0\u306e\u30de\u30b9\u30bf\u30fc\u3067\u69cb\u6210\u3055\u308c\u308b\u30de\u30eb\u30c1\u30b9\u30bf\u30fc\u69cb\u6210\u304c\u53ef\u80fd\u3067\u3001\u7528\u9014\u306b\u3088\u3063\u3066\u306f\u4e0a\u8a18\u306b\u52a0\u3048\u3001\u8a8d\u8a3c\u3084\u53c2\u7167\u5c02\u7528\u306e\u30b9\u30ec\u30fc\u30d7\u30b5\u30fc\u30d0\u30fc\u3092\u52a0\u3048\u308b\u69cb\u6210\u3082\u53ef\u80fd\n\u30de\u30eb\u30c1\u30b9\u30bf\u30fc\u69cb\u6210\u3067LDAP\u30de\u30b9\u30bf\u30fc\u30b5\u30fc\u30d0\u30fc\u304c\u8907\u6570\u306e\u5834\u5408\u306b\u540c\u3058\u30a8\u30f3\u30c8\u30ea\u306b\u5bfe\u3057\u3066\u9023\u7d9a\u306e\u66f8\u304d\u8fbc\u307f\u304c\u305d\u308c\u305e\u308c\u5225\u306e\u30de\u30b9\u30bf\u30fc\u30b5\u30fc\u30d0\u30fc\u306b\u3088\u3063\u3066\u5b9f\u884c\u3055\u308c\u308b\u3068\u30a8\u30f3\u30c8\u30ea\u306e\u5185\u5bb9\u304c\u610f\u56f3\u3057\u305f\u901a\u308a\u306b\u306a\u3089\u306a\u3044\u5834\u5408\u304c\u3042\u308b\uff08\u5f8c\u8ff0\uff09\u4e0a\u8a18\u3088\u308a\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306b\u3088\u3063\u3066\u540c\u3058\u30a8\u30f3\u30c8\u30ea\u306e\u66f4\u65b0\u306f\u540c\u3058\u30de\u30b9\u30bf\u30fc\u30b5\u30fc\u30d0\u30fc\u306b\u901a\u4fe1\u3059\u308b\u306a\u3069\u306e\u5de5\u592b\u304c\u5fc5\u8981\n\u30a8\u30f3\u30c8\u30ea\u306e\u8907\u88fd\u65b9\u6cd5\u3068\u3057\u3066\u5927\u304d\u304f\u5206\u3051\u3066\u4ee5\u4e0b\u306e2\u7a2e\u985e\u304c\u3042\u308b\u3002\u300c\u64cd\u4f5c\u30ed\u30b0\u306b\u3088\u308b\u5bfe\u8c61\u306e\u5c5e\u6027\u306e\u307f\u3092\u8907\u88fd\u3059\u308b\u65b9\u5f0f\u300d\u3001\u300c\u30a8\u30f3\u30c8\u30ea\u5168\u4f53\u3092\u8907\u88fd\u3059\u308b\u65b9\u5f0f\u300d\n\u300c\u64cd\u4f5c\u30ed\u30b0\u3092\u9001\u308b\u65b9\u5f0f\u300d\u3067\u306f\u81ea\u8eab\u306e\u30de\u30b9\u30bf\u30fc\u30b5\u30fc\u30d0\u30fc\u3067\u5b9f\u884c\u3057\u305f\u8ffd\u52a0\u51e6\u7406\u306e\u30ed\u30b0\u3092\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3057\u3001\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u3067\u306f\u305d\u306e\u30ed\u30b0\u60c5\u5831\u306b\u57fa\u3065\u3044\u3066\u5bfe\u8c61\u30a8\u30f3\u30c8\u30ea\u306e\u66f4\u65b0\u3092\u884c\u3046\n\u300c\u30a8\u30f3\u30c8\u30ea\u5168\u4f53\u3092\u8907\u88fd\u3059\u308b\u65b9\u5f0f\u300d\u4f8b\u3048\u3070\u4eee\u306b\u30b0\u30eb\u30fc\u30d7X\u3068\u3044\u3046\u6240\u306b\u30e6\u30fc\u30b6\u30fcA\u3092\u8ffd\u52a0\u3057\u305f\u5834\u5408\u3001\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u306b\u306f\u30e6\u30fc\u30b6\u30fcA\u3060\u3051\u304c\u5165\u3063\u305f\u30b0\u30eb\u30fc\u30d7X\u306e\u30a8\u30f3\u30c8\u30ea\u5168\u4f53\u306e\u60c5\u5831\u304c\u9001\u4fe1\u3055\u308c\u308b\u3002\u4e0a\u8a18\u4ed5\u69d8\u3088\u308a\u3001\u540c\u3058\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u540c\u3058\u30b0\u30eb\u30fc\u30d7\u306b\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\u306e\u4f9d\u983c(\u30e6\u30fc\u30b6\u30fcB\u3068\u3059\u308b)\u304c\u30e6\u30fc\u30b6\u30fcA\u3092\u767b\u9332\u3059\u308b\u30b5\u30fc\u30d0\u30fc\u3067\u4ee5\u5916\u3067\u3042\u3063\u305f\u5834\u5408\u3001\u53cc\u65b9\u306e\u30b5\u30fc\u30d0\u30fc\u3067\u30b0\u30eb\u30fc\u30d7X\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u60c5\u5831\u304c\u66f4\u65b0\u3055\u308c\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u30e6\u30fc\u30b6\u30fcA\u3082\u3057\u304f\u306f\u30e6\u30fc\u30b6\u30fcB\u306e\u60c5\u5831\u304c\u55aa\u5931\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\nOpenLDAP\u3067\u4e00\u822c\u7684\u306b\u5229\u7528\u3055\u308c\u308b\u300csyncrepl\u300d\u306f\u300c\u30a8\u30f3\u30c8\u30ea\u5168\u4f53\u3092\u8907\u88fd\u3059\u308b\u65b9\u5f0f\u300d\u3067\u3042\u308b\u3002\u300c\u64cd\u4f5c\u30ed\u30b0\u3092\u9001\u308b\u65b9\u5f0f\u300d\u306f\u300cDelta-syncrepl\u300d\u3068\u547c\u3070\u308c\u3001\u30de\u30b9\u30bf\u30fc\u30fb\u30b9\u30ec\u30fc\u30d6\u65b9\u5f0f\u3067\u306e\u5229\u7528\u304c\u60f3\u5b9a\u3055\u308c\u3066\u3044\u308b\n\n\nOpenLDAP\u30b5\u30fc\u30d0\u30fc\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ca\u3073\u521d\u671f\u8a2d\u5b9a\n\u307e\u305a\u306fOpenLDAP\u30b5\u30fc\u30d0\u30fc\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001LDAP\u30b5\u30fc\u30d0\u30fc\u306e\u8d77\u52d5\u3092\u884c\u3044\u307e\u3059\u3002\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$sudo yum install openldap-clients openldap-servers\n\n# \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n$slapd -V\n@(#) $OpenLDAP: slapd 2.4.40 (Mar  8 2016 23:38:46) $\n    mockbuild@gobi-build-60006.pdx1.amazon.com:/builddir/build/BUILD/openldap-2.4.40/openldap-2.4.40/build-servers/servers/slapd\n\n# \u8d77\u52d5\n$sudo service slapd start\nStarting slapd:                                            [  OK  ]\n\n\u4f55\u3082\u8a2d\u5b9a\u3057\u306a\u3044\u3068LDAP\u306e\u30ed\u30b0\u306f\u51fa\u529b\u3055\u308c\u307e\u305b\u3093\u3002\nLDAP\u3067\u306fsyslog(rsyslog)\u306e\u30ed\u30b0\u30d5\u30a1\u30b7\u30ea\u30c6\u30a3\u30fc\u300clocal4\u300d\u3067\u30ed\u30b0\u51fa\u529b\u3092\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u4e0a\u8a18\u30ed\u30b0\u30d5\u30a1\u30b7\u30ea\u30c6\u30a3\u30fc\u306e\u30ed\u30b0\u60c5\u5831\u9001\u4fe1\u6642\u306b\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\u3059\u308b\u3088\u3046\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\n\n/etc/rsyslog.conf\nlocal4.*                                                /var/log/slapd\n\n\n\u5909\u66f4\u5f8c\u3001rsyslog\u30d7\u30ed\u30bb\u30b9\u3092\u518d\u8d77\u52d5\u3057\u3066\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\n$sudo serivice slapd restart\n\n\u4e0a\u8a18\u3067/var/log/slapd\u3068\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u3066\u3044\u308c\u3070OK\u3067\u3059\u3002\n\u51fa\u529b\u3059\u308b\u30ed\u30b0\u30ec\u30d9\u30eb\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u300cstats\u300d\u3068\u3044\u3046\u3082\u306e\u3089\u3057\u3044\u306e\u3067\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30ed\u30b0\u30ec\u30d9\u30eb\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u3067\u30ed\u30b0\u51fa\u529b\u3055\u308c\u308b\u5185\u5bb9\u3092\u5909\u66f4\u51fa\u6765\u307e\u3059\u3002\n\n\u691c\u7d22\u3057\u3066\u307f\u308b\nLDAP\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3060\u3051\u3067\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u72b6\u614b\u3067\u3082cn=config\u3068\u3044\u3046LDAP\u30b5\u30fc\u30d0\u30fc\u306e\u8a2d\u5b9a\u306b\u95a2\u3059\u308b\u30a8\u30f3\u30c8\u30ea\u306b\u3064\u3044\u3066\u306f\u767b\u9332\u3055\u308c\u3066\u304a\u308a\u3001\u305d\u306e\u60c5\u5831\u3092\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\n(root\u30e6\u30fc\u30b6\u30fc\u3067\u5b9f\u884c\u3059\u308b\u70b9\u306b\u6ce8\u610f\u3002\u57fa\u672c\u7684\u306b\u4ee5\u964d\u306e\u30b3\u30de\u30f3\u30c9\u64cd\u4f5c\u306froot\u30e6\u30fc\u30b6\u30fc\u3067\u306e\u64cd\u4f5c\u3092\u60f3\u5b9a\u3002root\u30e6\u30fc\u30b6\u3067\u306a\u3044\u3068\u30d5\u30a1\u30a4\u30eb\u6a29\u9650\u304c\u306a\u304f\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059)\n$sudo su\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b cn=config dn\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: cn=config\n\ndn: cn=schema,cn=config\n\ndn: cn={0}corba,cn=schema,cn=config\n\ndn: cn={1}core,cn=schema,cn=config\n\ndn: cn={2}cosine,cn=schema,cn=config\n\ndn: cn={3}duaconf,cn=schema,cn=config\n\ndn: cn={4}dyngroup,cn=schema,cn=config\n\ndn: cn={5}inetorgperson,cn=schema,cn=config\n\ndn: cn={6}java,cn=schema,cn=config\n\ndn: cn={7}misc,cn=schema,cn=config\n\ndn: cn={8}nis,cn=schema,cn=config\n\ndn: cn={9}openldap,cn=schema,cn=config\n\ndn: cn={10}ppolicy,cn=schema,cn=config\n\ndn: cn={11}collective,cn=schema,cn=config\n\ndn: olcDatabase={-1}frontend,cn=config\n\ndn: olcDatabase={0}config,cn=config\n\ndn: olcDatabase={1}monitor,cn=config\n\ndn: olcDatabase={2}bdb,cn=config\n\n\u30b3\u30de\u30f3\u30c9\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u610f\u5473\u306f\u3056\u3063\u304f\u308a\u4ee5\u4e0b\u3067\u3059\u3002\n\n-LLL->LDAP\u691c\u7d22\u7d50\u679c\u8868\u793a\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\n-Y EXTERNAL->SASL\u306eEXTERANL\u8a8d\u8a3c\u3092\u5229\u7528\u3057\u3066LDAP\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n-H ldapi:///->LDAP\u30b5\u30fc\u30d0\u30fc\u306e\u30db\u30b9\u30c8\u3002\u4eca\u56de\u306fInter process Communication(IPC)\u3092\u5229\u7528\u3057\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u540c\u4e00\u30db\u30b9\u30c8\u4e0a\u306e\u30d7\u30ed\u30bb\u30b9\u3068\u901a\u4fe1\u3092\u5b9f\u65bd\n-b\u3000cn=config dn->\u691c\u7d22\u30a8\u30f3\u30c8\u30ea\u306e\u6761\u4ef6\u3002\u4eca\u56de\u306e\u5834\u5408\u306b\u306f\u5c5e\u6027cn=config\u306e\u6761\u4ef6\u306edn\u5c5e\u6027\u30a8\u30f3\u30c8\u30ea\u306b\u3064\u3044\u3066\u8868\u793a\n\n\u4e0a\u8a18\u8868\u793a\u3055\u308c\u305f\u5185\u5bb9\u3092\u5b9f\u969b\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n# \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u79fb\u52d5\n$/etc/openldap\n\n# slap.d/cn=config\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4e0b\u304ccn=config\u306e\u6761\u4ef6\u306b\u5408\u81f4\u3059\u308b\u30d5\u30a1\u30a4\u30eb\n$tree slapd.d/\nslapd.d/\n\u251c\u2500\u2500 cn=config\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cn=schema\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={0}corba.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={10}ppolicy.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={11}collective.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={1}core.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={2}cosine.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={3}duaconf.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={4}dyngroup.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={5}inetorgperson.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={6}java.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={7}misc.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={8}nis.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 cn={9}openldap.ldif\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cn=schema.ldif\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 olcDatabase={-1}frontend.ldif\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 olcDatabase={0}config.ldif\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 olcDatabase={1}monitor.ldif\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 olcDatabase={2}bdb.ldif\n\u2514\u2500\u2500 cn=config.ldif\n\n2 directories, 18 files\n\n# \u5b9f\u969b\u306b\u691c\u7d22\u3057\u3066\u307f\u308b\n$find slapd.d/ -type f|xargs cat|grep dn:|sort\ndn: cn=config\ndn: cn=schema\ndn: cn={0}corba\ndn: cn={10}ppolicy\ndn: cn={11}collective\ndn: cn={1}core\ndn: cn={2}cosine\ndn: cn={3}duaconf\ndn: cn={4}dyngroup\ndn: cn={5}inetorgperson\ndn: cn={6}java\ndn: cn={7}misc\ndn: cn={8}nis\ndn: cn={9}openldap\ndn: olcDatabase={-1}frontend\ndn: olcDatabase={0}config\ndn: olcDatabase={1}monitor\ndn: olcDatabase={2}bdb\n\n\u4e0a\u8a18\u7d50\u679c\u3088\u308a\u3001cn=config\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4e0b\u306eldif\u3068\u3044\u3046\u62e1\u5f35\u5b50\u3067dn\u5c5e\u6027\u306e\u8a18\u8ff0\u306b\u3064\u3044\u3066\u306e\u7d50\u679c\u3092ldapsearch\u30b3\u30de\u30f3\u30c9\u3067\u306f\u629c\u304d\u51fa\u3057\u3066\u3044\u308b\u4e8b\u304c\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\n\u8272\u3005\u691c\u7d22\u3057\u3066\u307f\u308b\n\u8272\u3005\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u30d9\u30fc\u30b9\u30c4\u30ea\u30fc\n\u307e\u305a\u306f\u30d9\u30fc\u30b9\u30c4\u30ea\u30fc\u3092\u691c\u7d22\u3057\u307e\u3059\u3002\u30d9\u30fc\u30b9\u30c4\u30ea\u30fc\u306b\u306f\u8d77\u52d5\u6642\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3084PID\u30d5\u30a1\u30a4\u30eb\u3001TLS\u63a5\u7d9a\u6642\u306e\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u306e\u60c5\u5831\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b cn=config -s base\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: cn=config\nobjectClass: olcGlobal\ncn: config\nolcConfigFile: /usr/share/openldap-servers/slapd.conf.obsolete\nolcConfigDir: /etc/openldap/slapd.d\nolcAllows: bind_v2\nolcArgsFile: /var/run/openldap/slapd.args\nolcAttributeOptions: lang-\nolcAuthzPolicy: none\nolcConcurrency: 0\nolcConnMaxPending: 100\nolcConnMaxPendingAuth: 1000\nolcGentleHUP: FALSE\nolcIdleTimeout: 0\nolcIndexSubstrIfMaxLen: 4\nolcIndexSubstrIfMinLen: 2\nolcIndexSubstrAnyLen: 4\nolcIndexSubstrAnyStep: 2\nolcIndexIntLen: 4\nolcListenerThreads: 1\nolcLocalSSF: 71\nolcLogLevel: 0\nolcPidFile: /var/run/openldap/slapd.pid\nolcReadOnly: FALSE\nolcReverseLookup: FALSE\nolcSaslSecProps: noplain,noanonymous\nolcSockbufMaxIncoming: 262143\nolcSockbufMaxIncomingAuth: 16777215\nolcThreads: 16\nolcTLSCACertificatePath: /etc/openldap/certs\nolcTLSCertificateFile: \"OpenLDAP Server\"\nolcTLSCertificateKeyFile: /etc/openldap/certs/password\nolcTLSVerifyClient: never\nolcTLSProtocolMin: 3.1\nolcToolThreads: 1\nolcWriteTimeout: 0\n\n\u4e0a\u8a18\u306f\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u306f/etc/openldap/slapd.d/cn\\=config.ldif\u306e\u5185\u5bb9\u306e\u4e00\u90e8\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\nfrontend\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n\u6b21\u306bfrontend\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u5024\u306b\u3064\u3044\u3066\u78ba\u8a8d\u3057\u307e\u3059\u3002\nfrontend\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u9069\u7528\u3059\u308b\u8a2d\u5b9a\u3092\u8a18\u8f09\u3059\u308b\u305f\u3081\u306e\u6697\u9ed9\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b olcDatabase={-1}frontend,cn=config\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: olcDatabase={-1}frontend,cn=config\nobjectClass: olcDatabaseConfig\nobjectClass: olcFrontendConfig\nolcDatabase: {-1}frontend\nolcAddContentAcl: FALSE\nolcLastMod: TRUE\nolcMaxDerefDepth: 0\nolcReadOnly: FALSE\nolcSchemaDN: cn=Subschema\nolcSyncUseSubentry: FALSE\nolcMonitoring: FALSE\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u7279\u306b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306f\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\nconfig\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n\u6b21\u306bconfig\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u5024\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nconfig\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fOpenLDAP\u30b5\u30fc\u30d0\u30fc\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b olcDatabase={0}config,cn=config\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: olcDatabase={0}config,cn=config\nobjectClass: olcDatabaseConfig\nolcDatabase: {0}config\nolcAccess: {0}to *  by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=externa\n l,cn=auth\" manage  by * none\nolcAddContentAcl: TRUE\nolcLastMod: TRUE\nolcMaxDerefDepth: 15\nolcReadOnly: FALSE\nolcRootDN: cn=config\nolcSyncUseSubentry: FALSE\nolcMonitoring: FALSE\n\n\nmonitor\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n\u6b21\u306bmonitor\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u5024\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nmonitor\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fLDAP\u306e\u52d5\u4f5c\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b olcDatabase={1}monitor,cn=config\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: olcDatabase={1}monitor,cn=config\nobjectClass: olcDatabaseConfig\nolcDatabase: {1}monitor\nolcAccess: {0}to *  by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=externa\n l,cn=auth\" read  by dn.base=\"cn=manager,dc=my-domain,dc=com\" read  by * none\nolcAddContentAcl: FALSE\nolcLastMod: TRUE\nolcMaxDerefDepth: 15\nolcReadOnly: FALSE\nolcSyncUseSubentry: FALSE\nolcMonitoring: FALSE\n\n\u3053\u3061\u3089\u3082config\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u540c\u3058\u8a2d\u5b9a\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n\u6700\u5f8c\u306bLDAP\u3067\u30c7\u30fc\u30bf\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b olcDatabase={2}bdb,cn=config\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: olcDatabase={2}bdb,cn=config\nobjectClass: olcDatabaseConfig\nobjectClass: olcBdbConfig\nolcDatabase: {2}bdb\nolcDbDirectory: /var/lib/ldap\nolcSuffix: dc=my-domain,dc=com\nolcAddContentAcl: FALSE\nolcLastMod: TRUE\nolcMaxDerefDepth: 15\nolcReadOnly: FALSE\nolcRootDN: cn=Manager,dc=my-domain,dc=com\nolcSyncUseSubentry: FALSE\nolcMonitoring: TRUE\nolcDbCacheSize: 1000\nolcDbCheckpoint: 1024 15\nolcDbNoSync: FALSE\nolcDbDirtyRead: FALSE\nolcDbIDLcacheSize: 0\nolcDbIndex: objectClass pres,eq\nolcDbIndex: cn pres,eq,sub\nolcDbIndex: uid pres,eq,sub\nolcDbIndex: uidNumber pres,eq\nolcDbIndex: gidNumber pres,eq\nolcDbIndex: givenName pres,eq,sub\nolcDbIndex: ou pres,eq,sub\nolcDbIndex: mail pres,eq,sub\nolcDbIndex: sn pres,eq,sub\nolcDbIndex: loginShell pres,eq\nolcDbIndex: memberUid pres,eq,sub\nolcDbIndex: nisMapName pres,eq,sub\nolcDbIndex: nisMapEntry pres,eq,sub\nolcDbLinearIndex: FALSE\nolcDbMode: 0600\nolcDbSearchStack: 16\nolcDbShmKey: 0\nolcDbCacheFree: 1\nolcDbDNcacheSize: 0\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5229\u7528\u3057\u3066\u3044\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7a2e\u985e\u306fBDB(Berkeley)\u3067\u3042\u308b\u3053\u3068\u304c\u300cobjectClass: olcBdbConfig\u300d\u3068\u306a\u3063\u3066\u308b\u70b9\u304b\u3089\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\u306a\u304a\u3001CentOS7\u3067\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3063\u305f\u5834\u5408\u3001BDB\u3092\u6539\u826f\u3057\u305fHDB(Hierarchical DB)\u306a\u3069\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u300colcSuffix: dc=my-domain,dc=com\u300d\u3068\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u4e00\u5ea6\u3053\u3061\u3089\u306e\u5185\u5bb9\u3067\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b dc=my-domain,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\nNo such object (32)\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\u307e\u3060\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306a\u7d50\u679c\u3067\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\nLDAP\u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066\u5229\u7528\u3059\u308b\u305f\u3081\u306b\u65e2\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5b9a\u7fa9\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n# \u30b5\u30fc\u30d3\u30b9\u306e\u505c\u6b62\n$sudo service slapd stop\nStopping slapd:                                            [  OK  ]\n\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n$sudo rm /etc/openldap/slapd.d/cn\\=config/olcDatabase\\=\\{2\\}bdb.ldif\n\n# \u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\n$sudo service slapd start\nStarting slapd:                                            [  OK  ]\n\n\n\u4ee5\u4e0b\u306b\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u540d\u300cdc=example, dc=com\u300d\u306e\u30c4\u30ea\u30fc\u3092\u4f5c\u6210\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306eLDIF\u30d5\u30a1\u30a4\u30eb\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\u4f5c\u6210\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fHDB\u3068\u3057\u307e\u3059\u3002\n\nexample_com.ldif\ndn: olcDatabase=hdb,cn=config\nobjectClass: olcHdbConfig\nolcDatabase: hdb\nolcDbDirectory: /var/lib/ldap\nolcSuffix: dc=example,dc=com\nolcRootDN: cn=Manager,dc=example,dc=com\nolcAccess: to * by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\" manage by * none\n\n\n\u4e0a\u8a18\u306eolcAccess\u884c\u3067\u306fOpenLDAP\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u306eroot\u30e6\u30fc\u30b6\u30fc\u304cSASL/EXTERNAL\u3067\u8a8d\u8a3c\u3057\u305f\u6642\u306b\u7ba1\u7406\u8005\u6a29\u9650\u304c\u4ed8\u4e0e\u3055\u308c\u308b\u3088\u3046\u306b\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u300colcRootDN: cn=Manager,dc=example,dc=com\u300d\u3068\u3059\u308b\u3053\u3068\u3067Linux\u306a\u3069\u306eroot\u30e6\u30fc\u30b6\u30fc\u306b\u4f3c\u305f\u5168\u3066\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u60c5\u5831\u3092\u64cd\u4f5c\u3067\u304d\u308b\u30eb\u30fc\u30c8DN\u306eDN\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002cn(\u4e00\u822c\u540d\u79f0)\u3067\u306f\u4e00\u822c\u7684\u306b\u300cManager\u300d\u304c\u4f7f\u308f\u308c\u307e\u3059\u3002\n\u4e0a\u8a18example_com.ldif\u30d5\u30a1\u30a4\u30eb\u306f\u4efb\u610f\u306e\u5834\u6240\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002(/etc/openldap/slapd.d/cn=config\u914d\u4e0b\u306a\u3069\u914d\u7f6e\u3059\u308b\u3068\u30d7\u30ed\u30bb\u30b9\u8d77\u52d5\u6642\u306bwarning\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u305d\u308c\u4ee5\u5916\u306e\u4efb\u610f\u306e\u5834\u6240\u306b\u7f6e\u304f\u3088\u3046\u306b\u6ce8\u610f)\n\u914d\u7f6e\u5f8c\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\n$ldapadd -Y EXTERNAL -H ldapi:/// -f example_com.ldif\n\n\u66f8\u304d\u8fbc\u307f\u5f8c\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b cn=config\n(\u7565)\ndn: olcDatabase={2}hdb,cn=config\nobjectClass: olcHdbConfig\nolcDatabase: {2}hdb\nolcDbDirectory: /var/lib/ldap\nolcSuffix: dc=example,dc=com\nolcAccess: {0}to * by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=external\n ,cn=auth\" manage by * none\nolcRootDN: cn=Manager,dc=example,dc=com\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u5148\u307b\u3069ldif\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u3044\u305f\u5185\u5bb9\u304c\u8a18\u8f09\u3055\u308c\u3066\u3044\u308c\u3070OK\u3067\u3059\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a8\u30f3\u30c8\u30ea\u3092\u683c\u7d0d\u3059\u308b\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u4f5c\u6210\u3067\u304d\u305f\u306e\u3067\u3001\u6b21\u306b\u4e0a\u8a18\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a8\u30f3\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a2\u3064\u306e\u30a8\u30f3\u30c8\u30ea\u3092base.ldif\u3068\u3057\u3066\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nbase.ldif\n# \u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\n# 2\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\n\n\u4e00\u3064\u306eldif\u30d5\u30a1\u30a4\u30eb\u3067\u3082\u30a8\u30f3\u30c8\u30ea\u3068\u30a8\u30f3\u30c8\u30ea\u306e\u9593\u306b\u7a7a\u884c\u3092\u5165\u308c\u308b\u3053\u3068\u3067\u8907\u6570\u306e\u30a8\u30f3\u30c8\u30ea\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u300cdn: dc=example,dc=com\u300d\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u3053\u306eDIT\u306e\u4e00\u756a\u4e0a\u306e\u30a8\u30f3\u30c8\u30ea\u3068\u306a\u308a\u307e\u3059\u3002\n2\u3064\u76ee\u306fou=Users\u3068\u3044\u3046\u8a18\u8ff0\u304c\u3042\u308a\u3001\u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u4e00\u3064\u4e0b\u306e\u968e\u5c64\u306b\u4f4d\u7f6e\u3059\u308bUsers\u3068\u3044\u3046\u7d44\u7e54\u306e\u30a8\u30f3\u30c8\u30ea\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u4eca\u56de\u3001\u4e0a\u8a18\u306b\u5408\u308f\u305b\u3066\u7ba1\u7406\u8005\u30a8\u30f3\u30c8\u30ea\u3082\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u7ba1\u7406\u8005\u30a8\u30f3\u30c8\u30ea\u306b\u8a18\u8f09\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u4f5c\u6210\u3057\u307e\u3059\u3002\n$slappasswd\nNew password:\nRe-enter new password:\n{SSHA}WLxWiWqlZb8jWRWm19qV9ptFo3nOUfwj\n\n\u4e0a\u8a18\u3092\u5229\u7528\u3057\u3066\u5148\u307b\u3069\u306ebase.ldif\u306b\u7ba1\u7406\u8005\u30a8\u30f3\u30c8\u30ea\u60c5\u5831\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002userPassword\u5c5e\u6027\u306b\u306f\u4e0a\u8a18\u3067\u751f\u6210\u3057\u305f\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nbase.ldif\n# \u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\n# 2\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\n# 3\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword: {SSHA}WLxWiWqlZb8jWRWm19qV9ptFo3nOUfwj\n\n\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3092\u4efb\u610f\u306e\u5834\u6240\u306b\u914d\u7f6e\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3092\u884c\u3044\u307e\u3059\u3002\n# \u767b\u9332\n$ldapadd -Y EXTERNAL -H ldapi:/// -f base.ldif\n\n# \u767b\u9332\u78ba\u8a8d\u3002\u30a8\u30f3\u30c8\u30ea\u3092\u5168\u3066\u8868\u793a\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b dc=example,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword:: e1NTSEF9V0x4V2lXcWxaYjhqV1JXbTE5cVY5cHRGbzNuT1Vmd2o=\n\n# \u7279\u5b9a\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u307f\u8868\u793a\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b cn=Manager,dc=example,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword:: e1NTSEF9V0x4V2lXcWxaYjhqV1JXbTE5cVY5cHRGbzNuT1Vmd2o=\n\n\u554f\u984c\u306a\u3051\u308c\u3070\u767b\u9332\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\u8a18\u8ff0\u304c\u8aa4\u3063\u3066\u3044\u308b\u5834\u5408\u3001\u3069\u306e\u5c5e\u6027\u540d\u304c\u8aa4\u3063\u3066\u3044\u308b\u304b\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u4fee\u6b63\u3057\u3001\u767b\u9332\u3057\u76f4\u3057\u307e\u3059\u3002\u6ce8\u610f\u70b9\u3068\u3057\u3066\u4e00\u3064\u306eldif\u30d5\u30a1\u30a4\u30eb\u306b\u8907\u6570\u306e\u30a8\u30f3\u30c8\u30ea\u3092\u8a18\u8ff0\u3057\u3001\u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u554f\u984c\u306a\u304b\u3063\u305f\u304c\u30012\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u8a18\u8ff0\u8aa4\u308a\u304c\u3042\u308b\u5834\u5408\u3001\u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u767b\u9332\u3055\u308c\u305f\u72b6\u614b\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u540c\u3058ldif\u3092\u7528\u3044\u3066\u767b\u9332\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u300cdn: dc=example,dc=com\u300d\u306f\u3059\u3067\u306b\u5b58\u5728\u3059\u308b\u3068\u3044\u3046\u65e8\u306e\u8868\u793a\u304c\u3055\u308c\u308b\u305f\u3081\u3001\u305d\u306e\u5834\u5408\u3001\u65e2\u306b\u767b\u9332\u3057\u305f\u60c5\u5831\u306f\u524a\u9664\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u57fa\u672c\u7684\u306b\u4ee5\u964d\u306f\u540c\u3058\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u300cdc=example,dc=com\u300d\u3092\u53c2\u7167\u3059\u308b\u306e\u3067LDAP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u53c2\u7167\u3059\u308b\u8a2d\u5b9a\u306b\u3057\u307e\u3059\u3002\nLDAP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u53c2\u7167\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n/etc/openldap/ldap.conf\nBASE dc=example,dc=com\nURI ldapi:///\n\n\n\u4e0a\u8a18\u306b\u3088\u308a\u3001\u4eca\u5f8c\u306f\u30db\u30b9\u30c8\u540d\u3068\u30d9\u30fc\u30b9\u30a8\u30f3\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u306a\u304f\u3066\u3082\u60c5\u5831\u306e\u53c2\u7167\u304c\u3067\u304d\u307e\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword:: e1NTSEF9V0x4V2lXcWxaYjhqV1JXbTE5cVY5cHRGbzNuT1Vmd2o=\n\n\n\u5916\u90e8\u304b\u3089\u306e\u63a5\u7d9a\u8a2d\u5b9a\n\u6b21\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7d4c\u7531\u3067LDAP\u306b\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\u307e\u305a\u306f\u30a8\u30f3\u30c8\u30ea\u306b\u8a8d\u8a3c\u306e\u305f\u3081\u306b\u6a29\u9650\u3092\u4ed8\u4e0e\u3057\u307e\u3059\u3002\n\nacl.ldif\ndn: olcDatabase={2}hdb,cn=config\nreplace: olcAccess\nolcAccess: to * by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\" manage by * break\nolcAccess: to attrs=userPassword by anonymous auth by * none\nolcAccess: to * by * read\n\n\n\u65e2\u306b\u5b9a\u7fa9\u3055\u308c\u305f\u30a8\u30f3\u30c8\u30ea\u3092\u5909\u66f4\u3059\u308b\u305f\u3081\u306bldapmodify\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ldapmodify -Y EXTERNAL -f acl.ldif\n\n\u767b\u9332\u5f8c\u3001\u7ba1\u7406\u8005\u30a8\u30f3\u30c8\u30ea\u3067\u8a8d\u8a3c\u3067\u304d\u308b\u304b\u3084\u3063\u3066\u307f\u307e\u3059\u3002\n\u8a8d\u8a3c\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306fslappasswd\u30b3\u30de\u30f3\u30c9\u3067\u6307\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n$dapsearch -x -D\"cn=Manager,dc=example,dc=com\" -H ldap://localhost -W\nEnter LDAP Password:\n# extended LDIF\n#\n# LDAPv3\n# base <dc=example,dc=com> (default) with scope subtree\n# filter: (objectclass=*)\n# requesting: ALL\n#\n\n# example.com\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\n# Users, example.com\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\n# Manager, example.com\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword:: e1NTSEF9V0x4V2lXcWxaYjhqV1JXbTE5cVY5cHRGbzNuT1Vmd2o=\n\n# search result\nsearch: 2\nresult: 0 Success\n\n# numResponses: 4\n# numEntries: 3\n\n\u8a8d\u8a3c\u5f8c\u3001\u30a8\u30f3\u30c8\u30ea\u306e\u60c5\u5831\u304c\u7121\u4e8b\u53d6\u5f97\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u30e6\u30fc\u30b6\u30fc\u3001\u30b0\u30eb\u30fc\u30d7\u306e\u8ffd\u52a0\n\u30e6\u30fc\u30b6\u30fc\u304c\u30b0\u30eb\u30fc\u30d7\u306e\u30a8\u30f3\u30c8\u30ea\u3092\u767b\u9332\u3067\u304d\u308b\u6e96\u5099\u3092\u3057\u307e\u3059\u3002\n\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\u306bobjectClass\u3068\u3057\u3066\u300cinetOrgPerson\u300d\u3001\u300cposixAccount\u300d\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u5229\u7528\u3057\u305f\u3044objectClass\u304c\u8aad\u307f\u8fbc\u307f\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ldapsearch -LLL -Y EXTERNAL -b cn=schema,cn=config dn\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: cn=schema,cn=config\n\ndn: cn={0}corba,cn=schema,cn=config\n\ndn: cn={1}core,cn=schema,cn=config\n\ndn: cn={2}cosine,cn=schema,cn=config\n\ndn: cn={3}duaconf,cn=schema,cn=config\n\ndn: cn={4}dyngroup,cn=schema,cn=config\n\ndn: cn={5}inetorgperson,cn=schema,cn=config\n\ndn: cn={6}java,cn=schema,cn=config\n\ndn: cn={7}misc,cn=schema,cn=config\n\ndn: cn={8}nis,cn=schema,cn=config\n\ndn: cn={9}openldap,cn=schema,cn=config\n\ndn: cn={10}ppolicy,cn=schema,cn=config\n\ndn: cn={11}collective,cn=schema,cn=config\n\ninetOrgPerson\u304c\u4f9d\u5b58\u3057\u3066\u3044\u308bcosine\u30b9\u30ad\u30fc\u30de\u3001inetorgperson\u30b9\u30ad\u30fc\u30de\u3001posixAccount\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308bnis\u30b9\u30ad\u30fc\u30de\u304c\u8aad\u307f\u8fbc\u307e\u308c\u3066\u304a\u308a\u3001\u3059\u3067\u306b\u5404objectClass\u304c\u5229\u7528\u51fa\u6765\u308b\u72b6\u614b\u3067\u3042\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u306e\u3067\u3001\u4f55\u3082\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u30e6\u30fc\u30b6\u30fc\u306e\u767b\u9332\n\u5b9f\u969b\u306b\u30e6\u30fc\u30b6\u30fc\u306e\u767b\u9332\u3092\u884c\u3063\u3066\u307f\u307e\u3059\u3002\n\u767b\u9332\u3059\u308b\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u306eldif\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nuser.ldif\ndn: uid=testuser01,ou=Users,dc=example,dc=com\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: testuser01\ncn: \u3086\u30fc\u3056\u30fc01\nsn: \u30c6\u30b9\u30c8\nuidNumber: 10001\ngidNumber: 10001\nhomeDirectory: /home/testuser01\n\n\n\u8ffd\u52a0\u3057\u307e\u3059\u3002\n# \u767b\u9332\n$ldapadd -Y EXTERNAL -f users.ldif\n\n# \u78ba\u8a8d\n$ldapsearch -LLL -Y EXTERNAL -b uid=testuser01,ou=Users,dc=example,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: uid=testuser01,ou=Users,dc=example,dc=com\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: testuser01\ncn:: 44KG44O844GW44O8MDE=\nsn:: 44OG44K544OI\nuidNumber: 10001\ngidNumber: 10001\nhomeDirectory: /home/testuser01\n\n\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u304c\u8ffd\u52a0\u3067\u304d\u307e\u3057\u305f\u3002\n\u4e0a\u8a18\u30e6\u30fc\u30b6\u30fc\u3067\u8a8d\u8a3c\u3092\u3057\u3066\u307f\u305f\u3044\u306e\u3067\u3059\u304c\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067ldappasswd\u30b3\u30de\u30f3\u30c9\u3092\u5229\u7528\u3057\u3066\u30e9\u30f3\u30c0\u30e0\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5272\u308a\u5f53\u3066\u3066\u304b\u3089\u8a8d\u8a3c\u3057\u3066\u307f\u307e\u3059\u3002\n# \u30e9\u30f3\u30c0\u30e0\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n$ldappasswd -Y EXTERNAL uid=testuser01,ou=Users,dc=example,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\nNew password: sqZUZ7Zh\n\n# \u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u8a8d\u8a3c\n$ldapwhoami -x -D uid=testuser01,ou=Users,dc=example,dc=com -H ldap://localhost -W\nEnter LDAP Password:\ndn:uid=testuser01,ou=Users,dc=example,dc=com\n\nWindows\u30ed\u30b0\u30aa\u30f3\u306a\u3069\u3067\u4f7f\u3063\u305f\u3053\u3068\u306f\u3042\u308bLDAP\u3067\u3059\u304c\u3001\u8a73\u7d30\u3084\u69cb\u7bc9\u306a\u3069\u306f\u3084\u3063\u305f\u3053\u3068\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u672c\u3092\u898b\u306a\u304c\u3089\u52c9\u5f37\u3057\u3066\u307f\u305f\u306e\u3067\u30e1\u30e2\u3002\n\u53c2\u8003\u306b\u3055\u305b\u3066\u3082\u3089\u3063\u305f\u672c\u306e\u5185\u5bb9\u3092\u9014\u4e2d\u307e\u3067\u3084\u3063\u305f\u6642\u306e\u4f5c\u696d\u30e1\u30e2\u3068\u306a\u308a\u307e\u3059\u3002\n\n# \u53c2\u8003\n\n+ [\u30a4\u30f3\u30d5\u30e9\u30a8\u30f3\u30b8\u30cb\u30a2\u6559\u672c2\u2015\u2015\u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u30fb\u69cb\u7bc9\u6280\u8853\u89e3\u8aac (Software Design\u5225\u518a)](http://www.amazon.co.jp/gp/product/4774177822/ref=s9_simh_gw_g14_i4_r?pf_rd_m=AN1VRQENFRJN5&pf_rd_s=desktop-1&pf_rd_r=1X35ZRCN02H7Q0PJA0WY&pf_rd_t=36701&pf_rd_p=302362649&pf_rd_i=desktop)\n+ [\u5165\u9580LDAP/OpenLDAP\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30b5\u30fc\u30d3\u30b9\u5c0e\u5165\u30fb\u904b\u7528\u30ac\u30a4\u30c9\u7b2c2\u7248](http://www.amazon.co.jp/%E5%85%A5%E9%96%80LDAP-OpenLDAP%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E5%B0%8E%E5%85%A5%E3%83%BB%E9%81%8B%E7%94%A8%E3%82%AC%E3%82%A4%E3%83%89%E7%AC%AC2%E7%89%88-%E3%83%87%E3%83%BC%E3%82%B8%E3%83%BC%E3%83%8D%E3%83%83%E3%83%88/dp/4798033499/ref=sr_1_1?ie=UTF8&qid=1462484994&sr=8-1&keywords=ldap)\n\n# \u74b0\u5883\n\n+ Amazon Linux AMI 2016.03.1\n\n# LDAP\u3068\u306f\n\n+ Lightweight Directory Access Protocol\u306e\u7565\u8a9e\u3067\u3001OSI\u53c2\u7167\u30e2\u30c7\u30eb\u3067\u306fHTTP\u306a\u3069\u3068\u540c\u3058\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5c64\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3002\u691c\u7d22(search)\u3001\u8ffd\u52a0(add)\u3001\u524a\u9664(delete)\u3001\u5909\u66f4(modify)\u3068\u3044\u3063\u305f\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u767b\u9332\u3057\u305f\u60c5\u5831\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u63d0\u4f9b\u3002\n+ LDAP\u3067\u306f\u540d\u524d\u306e\u901a\u308a\u3001Directory\u306e\u7ba1\u7406\u3092\u884c\u3046\u3002LDAP\u306b\u304a\u3051\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u306f\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u306e\u96fb\u8a71\u5e33\u3084\u540d\u7c3f\u306b\u76f8\u5f53\u3057\u3001\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u30fc\u306e\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3084\u30b0\u30eb\u30fc\u30d7\u60c5\u5831\u3092\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u5171\u6709\u3059\u308b\u305f\u3081\u306e\u30b5\u30fc\u30d3\u30b9\n+ LDAP\u306fLDAP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8(\u8a8d\u8a3c\u3055\u308c\u308b\u5074)\u3068LDAP\u30b5\u30fc\u30d0\u30fc(\u8a8d\u8a3c\u3059\u308b)\u3067\u69cb\u6210\u3055\u308c\u308b\u3002LDAP\u30b5\u30fc\u30d0\u30fc\u3092\u8907\u6570\u53f0\u3067\u69cb\u6210\u3057\u3001\u8ca0\u8377\u5206\u6563\u53ca\u3073\u5197\u9577\u5316\u69cb\u6210\u3092\u3068\u308b\u3053\u3068\u3082\u3067\u304d\u308b\n+ Unix\u30bd\u30b1\u30c3\u30c8\u3082\u3057\u304f\u306fTCP\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u901a\u4fe1\u3002ldap\u30d7\u30ed\u30c8\u30b3\u30eb\u306e389\u30dd\u30fc\u30c8\u304bldaps\u306e636\u30dd\u30fc\u30c8\u3092\u5229\u7528\u3059\u308b\n\n# LDAP\u306e\u8a2d\u8a08\n\n+ LDAP\u3067\u306fDIT(Directory Information Tree)\u3068\u3044\u3046\u30c4\u30ea\u30fc\u69cb\u9020\u306e\u30c7\u30fc\u30bf\u5f62\u5f0f\u3067\u60c5\u5831\u3092\u7ba1\u7406\u3059\u308b\n+ \u30c4\u30ea\u30fc\u306b\u306f\u300c\u30a8\u30f3\u30c8\u30ea\u300d\u3068\u547c\u3070\u308c\u308b\u5358\u4f4d\u3067\u60c5\u5831\u304c\u767b\u9332\u3055\u308c\u308b\n+ \u4e00\u3064\u306e\u30a8\u30f3\u30c8\u30ea\u306b\u306fDN(Distinguished Name)\u3068\u547c\u3070\u308c\u308b\u30c4\u30ea\u30fc\u69cb\u9020\u5185\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u4f4d\u7f6e\u3092\u793a\u3059\u8b58\u5225\u5b50\u304c\u4e00\u610f\u306b\u4ed8\u4e0e\u3055\u308c\u308b\n+ \u4e00\u3064\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u8907\u6570\u306e\u300c\u5c5e\u6027\u300d\u3067\u69cb\u6210\u3055\u308c\u308b\u3002\u5c5e\u6027\u306f\u300c\u5c5e\u6027\u540d:\u5024\u300d\u306e\u30bb\u30c3\u30c8\u3067\u767b\u9332\u3055\u308c\u3066\u3044\u308b\n+ \u30a8\u30f3\u30c8\u30ea\u306b\u306f\u5fc5\u305a\u300cobjectClass\u300d\u3068\u547c\u3070\u308c\u308b\u5c5e\u6027\u304c\u6307\u5b9a\u3055\u308c\u3001\u30a8\u30f3\u30c8\u30ea\u306b\u767b\u9332\u3055\u308c\u308b\u3079\u304d\u5c5e\u6027\u306a\u3069\u3092\u5b9a\u7fa9\u3067\u304d\u308b\n+ objectClass\u306f\u30b9\u30ad\u30fc\u30de\u3068\u547c\u3070\u308c\u3001LDAP\u30b5\u30fc\u30d0\u30fc\u3054\u3068\u306b\u5b9a\u7fa9\u3067\u304d\u308b\u304c\u3001\u6a19\u6e96\u7684\u306a\u30b9\u30ad\u30fc\u30de\u306fRFC\u3067\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\n+ \u72ec\u81ea\u306e\u5c5e\u6027\u60c5\u5831\u3092\u8ffd\u52a0\u3057\u305f\u3044\u5834\u5408\u306a\u3069\u306b\u306fobjectClass\u306b\u8ffd\u52a0\u3057\u305f\u3044\u72ec\u81ea\u306e\u5c5e\u6027\u60c5\u5831\u3092\u5b9a\u7fa9\u3059\u308c\u3070OK\n\n\u4ee5\u4e0b\u3001\u3088\u304f\u4f7f\u3046\u5c5e\u6027\u540d\n\n|\u5c5e\u6027\u30bf\u30a4\u30d7|\u8aac\u660e|\n|:-----------|:------------|\n| dn       |\u8b58\u5225\u5b50(Distinguished Name|\n| objectClass|\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30af\u30e9\u30b9|\n| dc|\u30c9\u30e1\u30a4\u30f3\u69cb\u6210\u8981\u7d20(Domain Component|\n| o        |\u7d44\u7e54\u540d(Organization)|\n| ou       |\u7d44\u7e54\u5358\u4f4d(Organization Unit|\n| cn    |\u4e00\u822c\u540d\u79f0(Common Name)|\n\n\n# LDAP\u306e\u8907\u88fd(\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3)\n\n+ LDAP\u30b5\u30fc\u30d0\u30fc\u3054\u3068\u306e\u8907\u88fd(replication)\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067LDAP\u30b5\u30fc\u30d0\u30fc\u9593\u3067\u30a8\u30f3\u30c8\u30ea\u60c5\u5831\u3092\u5171\u6709\u3057\u3001\u8907\u6570\u53f0\u69cb\u6210\u304c\u3067\u304d\u308b\n+ \u8907\u88fd\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u304a\u3089\u305a\u3001\u88fd\u54c1\u3054\u3068\u306b\u9055\u3046\u305f\u3081\u3001\u8907\u6570\u53f0\u69cb\u6210\u3092\u884c\u3046\u5834\u5408\u3001\u540c\u3058\u88fd\u54c1\u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308b\n+ \u30a8\u30f3\u30c8\u30ea\u306e\u8ffd\u52a0\u30fb\u66f4\u65b0\u304c\u53ef\u80fd\u306aLDAP\u30b5\u30fc\u30d0\u30fc\u3092\u30de\u30b9\u30bf\u30fc\u3082\u3057\u304f\u306f\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3068\u547c\u3073\u3001\u30a8\u30f3\u30c8\u30ea\u306e\u53c2\u7167\u306e\u307f\u304c\u53ef\u80fd\u306aLDAP\u30b5\u30fc\u30d0\u30fc\u3092\u30b9\u30ec\u30fc\u30d6\u3082\u3057\u304f\u306f\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u3068\u547c\u3076\n+ \u4e00\u822c\u7684\u306aLDAP\u88fd\u54c1\u3067\u306f\u8907\u6570\u53f0\u306e\u30de\u30b9\u30bf\u30fc\u3067\u69cb\u6210\u3055\u308c\u308b\u30de\u30eb\u30c1\u30b9\u30bf\u30fc\u69cb\u6210\u304c\u53ef\u80fd\u3067\u3001\u7528\u9014\u306b\u3088\u3063\u3066\u306f\u4e0a\u8a18\u306b\u52a0\u3048\u3001\u8a8d\u8a3c\u3084\u53c2\u7167\u5c02\u7528\u306e\u30b9\u30ec\u30fc\u30d7\u30b5\u30fc\u30d0\u30fc\u3092\u52a0\u3048\u308b\u69cb\u6210\u3082\u53ef\u80fd\n+ \u30de\u30eb\u30c1\u30b9\u30bf\u30fc\u69cb\u6210\u3067LDAP\u30de\u30b9\u30bf\u30fc\u30b5\u30fc\u30d0\u30fc\u304c\u8907\u6570\u306e\u5834\u5408\u306b\u540c\u3058\u30a8\u30f3\u30c8\u30ea\u306b\u5bfe\u3057\u3066\u9023\u7d9a\u306e\u66f8\u304d\u8fbc\u307f\u304c\u305d\u308c\u305e\u308c\u5225\u306e\u30de\u30b9\u30bf\u30fc\u30b5\u30fc\u30d0\u30fc\u306b\u3088\u3063\u3066\u5b9f\u884c\u3055\u308c\u308b\u3068\u30a8\u30f3\u30c8\u30ea\u306e\u5185\u5bb9\u304c\u610f\u56f3\u3057\u305f\u901a\u308a\u306b\u306a\u3089\u306a\u3044\u5834\u5408\u304c\u3042\u308b\uff08\u5f8c\u8ff0\uff09\u4e0a\u8a18\u3088\u308a\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306b\u3088\u3063\u3066\u540c\u3058\u30a8\u30f3\u30c8\u30ea\u306e\u66f4\u65b0\u306f\u540c\u3058\u30de\u30b9\u30bf\u30fc\u30b5\u30fc\u30d0\u30fc\u306b\u901a\u4fe1\u3059\u308b\u306a\u3069\u306e\u5de5\u592b\u304c\u5fc5\u8981\n+ \u30a8\u30f3\u30c8\u30ea\u306e\u8907\u88fd\u65b9\u6cd5\u3068\u3057\u3066\u5927\u304d\u304f\u5206\u3051\u3066\u4ee5\u4e0b\u306e2\u7a2e\u985e\u304c\u3042\u308b\u3002\u300c\u64cd\u4f5c\u30ed\u30b0\u306b\u3088\u308b\u5bfe\u8c61\u306e\u5c5e\u6027\u306e\u307f\u3092\u8907\u88fd\u3059\u308b\u65b9\u5f0f\u300d\u3001\u300c\u30a8\u30f3\u30c8\u30ea\u5168\u4f53\u3092\u8907\u88fd\u3059\u308b\u65b9\u5f0f\u300d\n+ \u300c\u64cd\u4f5c\u30ed\u30b0\u3092\u9001\u308b\u65b9\u5f0f\u300d\u3067\u306f\u81ea\u8eab\u306e\u30de\u30b9\u30bf\u30fc\u30b5\u30fc\u30d0\u30fc\u3067\u5b9f\u884c\u3057\u305f\u8ffd\u52a0\u51e6\u7406\u306e\u30ed\u30b0\u3092\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3057\u3001\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u3067\u306f\u305d\u306e\u30ed\u30b0\u60c5\u5831\u306b\u57fa\u3065\u3044\u3066\u5bfe\u8c61\u30a8\u30f3\u30c8\u30ea\u306e\u66f4\u65b0\u3092\u884c\u3046\n+ \u300c\u30a8\u30f3\u30c8\u30ea\u5168\u4f53\u3092\u8907\u88fd\u3059\u308b\u65b9\u5f0f\u300d\u4f8b\u3048\u3070\u4eee\u306b\u30b0\u30eb\u30fc\u30d7X\u3068\u3044\u3046\u6240\u306b\u30e6\u30fc\u30b6\u30fcA\u3092\u8ffd\u52a0\u3057\u305f\u5834\u5408\u3001\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u306b\u306f\u30e6\u30fc\u30b6\u30fcA\u3060\u3051\u304c\u5165\u3063\u305f\u30b0\u30eb\u30fc\u30d7X\u306e\u30a8\u30f3\u30c8\u30ea\u5168\u4f53\u306e\u60c5\u5831\u304c\u9001\u4fe1\u3055\u308c\u308b\u3002\u4e0a\u8a18\u4ed5\u69d8\u3088\u308a\u3001\u540c\u3058\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u540c\u3058\u30b0\u30eb\u30fc\u30d7\u306b\u30e6\u30fc\u30b6\u30fc\u8ffd\u52a0\u306e\u4f9d\u983c(\u30e6\u30fc\u30b6\u30fcB\u3068\u3059\u308b)\u304c\u30e6\u30fc\u30b6\u30fcA\u3092\u767b\u9332\u3059\u308b\u30b5\u30fc\u30d0\u30fc\u3067\u4ee5\u5916\u3067\u3042\u3063\u305f\u5834\u5408\u3001\u53cc\u65b9\u306e\u30b5\u30fc\u30d0\u30fc\u3067\u30b0\u30eb\u30fc\u30d7X\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u60c5\u5831\u304c\u66f4\u65b0\u3055\u308c\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u30e6\u30fc\u30b6\u30fcA\u3082\u3057\u304f\u306f\u30e6\u30fc\u30b6\u30fcB\u306e\u60c5\u5831\u304c\u55aa\u5931\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\n+ OpenLDAP\u3067\u4e00\u822c\u7684\u306b\u5229\u7528\u3055\u308c\u308b\u300csyncrepl\u300d\u306f\u300c\u30a8\u30f3\u30c8\u30ea\u5168\u4f53\u3092\u8907\u88fd\u3059\u308b\u65b9\u5f0f\u300d\u3067\u3042\u308b\u3002\u300c\u64cd\u4f5c\u30ed\u30b0\u3092\u9001\u308b\u65b9\u5f0f\u300d\u306f\u300cDelta-syncrepl\u300d\u3068\u547c\u3070\u308c\u3001\u30de\u30b9\u30bf\u30fc\u30fb\u30b9\u30ec\u30fc\u30d6\u65b9\u5f0f\u3067\u306e\u5229\u7528\u304c\u60f3\u5b9a\u3055\u308c\u3066\u3044\u308b\n\n# OpenLDAP\u30b5\u30fc\u30d0\u30fc\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ca\u3073\u521d\u671f\u8a2d\u5b9a\n \n\u307e\u305a\u306fOpenLDAP\u30b5\u30fc\u30d0\u30fc\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001LDAP\u30b5\u30fc\u30d0\u30fc\u306e\u8d77\u52d5\u3092\u884c\u3044\u307e\u3059\u3002\n \n```bash\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$sudo yum install openldap-clients openldap-servers\n\n# \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n$slapd -V\n@(#) $OpenLDAP: slapd 2.4.40 (Mar  8 2016 23:38:46) $\n\tmockbuild@gobi-build-60006.pdx1.amazon.com:/builddir/build/BUILD/openldap-2.4.40/openldap-2.4.40/build-servers/servers/slapd\n\n# \u8d77\u52d5\n$sudo service slapd start\nStarting slapd:                                            [  OK  ]\n```\n\n\u4f55\u3082\u8a2d\u5b9a\u3057\u306a\u3044\u3068LDAP\u306e\u30ed\u30b0\u306f\u51fa\u529b\u3055\u308c\u307e\u305b\u3093\u3002\nLDAP\u3067\u306fsyslog(rsyslog)\u306e\u30ed\u30b0\u30d5\u30a1\u30b7\u30ea\u30c6\u30a3\u30fc\u300clocal4\u300d\u3067\u30ed\u30b0\u51fa\u529b\u3092\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u4e0a\u8a18\u30ed\u30b0\u30d5\u30a1\u30b7\u30ea\u30c6\u30a3\u30fc\u306e\u30ed\u30b0\u60c5\u5831\u9001\u4fe1\u6642\u306b\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\u3059\u308b\u3088\u3046\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\n\n```text:/etc/rsyslog.conf\nlocal4.*                                                /var/log/slapd\n```\n\n\u5909\u66f4\u5f8c\u3001rsyslog\u30d7\u30ed\u30bb\u30b9\u3092\u518d\u8d77\u52d5\u3057\u3066\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\n\n```bash\n$sudo serivice slapd restart\n```\n\n\u4e0a\u8a18\u3067`/var/log/slapd`\u3068\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u3066\u3044\u308c\u3070OK\u3067\u3059\u3002\n\u51fa\u529b\u3059\u308b\u30ed\u30b0\u30ec\u30d9\u30eb\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u300cstats\u300d\u3068\u3044\u3046\u3082\u306e\u3089\u3057\u3044\u306e\u3067\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30ed\u30b0\u30ec\u30d9\u30eb\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u3067\u30ed\u30b0\u51fa\u529b\u3055\u308c\u308b\u5185\u5bb9\u3092\u5909\u66f4\u51fa\u6765\u307e\u3059\u3002\n\n\n# \u691c\u7d22\u3057\u3066\u307f\u308b\n\nLDAP\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3060\u3051\u3067\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u72b6\u614b\u3067\u3082cn=config\u3068\u3044\u3046LDAP\u30b5\u30fc\u30d0\u30fc\u306e\u8a2d\u5b9a\u306b\u95a2\u3059\u308b\u30a8\u30f3\u30c8\u30ea\u306b\u3064\u3044\u3066\u306f\u767b\u9332\u3055\u308c\u3066\u304a\u308a\u3001\u305d\u306e\u60c5\u5831\u3092\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\n(root\u30e6\u30fc\u30b6\u30fc\u3067\u5b9f\u884c\u3059\u308b\u70b9\u306b\u6ce8\u610f\u3002\u57fa\u672c\u7684\u306b\u4ee5\u964d\u306e\u30b3\u30de\u30f3\u30c9\u64cd\u4f5c\u306froot\u30e6\u30fc\u30b6\u30fc\u3067\u306e\u64cd\u4f5c\u3092\u60f3\u5b9a\u3002root\u30e6\u30fc\u30b6\u3067\u306a\u3044\u3068\u30d5\u30a1\u30a4\u30eb\u6a29\u9650\u304c\u306a\u304f\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059)\n\n```bash\n$sudo su\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b cn=config dn\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: cn=config\n\ndn: cn=schema,cn=config\n\ndn: cn={0}corba,cn=schema,cn=config\n\ndn: cn={1}core,cn=schema,cn=config\n\ndn: cn={2}cosine,cn=schema,cn=config\n\ndn: cn={3}duaconf,cn=schema,cn=config\n\ndn: cn={4}dyngroup,cn=schema,cn=config\n\ndn: cn={5}inetorgperson,cn=schema,cn=config\n\ndn: cn={6}java,cn=schema,cn=config\n\ndn: cn={7}misc,cn=schema,cn=config\n\ndn: cn={8}nis,cn=schema,cn=config\n\ndn: cn={9}openldap,cn=schema,cn=config\n\ndn: cn={10}ppolicy,cn=schema,cn=config\n\ndn: cn={11}collective,cn=schema,cn=config\n\ndn: olcDatabase={-1}frontend,cn=config\n\ndn: olcDatabase={0}config,cn=config\n\ndn: olcDatabase={1}monitor,cn=config\n\ndn: olcDatabase={2}bdb,cn=config\n```\n\n\u30b3\u30de\u30f3\u30c9\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u610f\u5473\u306f\u3056\u3063\u304f\u308a\u4ee5\u4e0b\u3067\u3059\u3002\n\n+ -LLL->LDAP\u691c\u7d22\u7d50\u679c\u8868\u793a\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\n+ -Y EXTERNAL->SASL\u306eEXTERANL\u8a8d\u8a3c\u3092\u5229\u7528\u3057\u3066LDAP\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\n+ -H ldapi:///->LDAP\u30b5\u30fc\u30d0\u30fc\u306e\u30db\u30b9\u30c8\u3002\u4eca\u56de\u306fInter process Communication(IPC)\u3092\u5229\u7528\u3057\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3068\u540c\u4e00\u30db\u30b9\u30c8\u4e0a\u306e\u30d7\u30ed\u30bb\u30b9\u3068\u901a\u4fe1\u3092\u5b9f\u65bd\n+ -b\u3000cn=config dn->\u691c\u7d22\u30a8\u30f3\u30c8\u30ea\u306e\u6761\u4ef6\u3002\u4eca\u56de\u306e\u5834\u5408\u306b\u306f\u5c5e\u6027cn=config\u306e\u6761\u4ef6\u306edn\u5c5e\u6027\u30a8\u30f3\u30c8\u30ea\u306b\u3064\u3044\u3066\u8868\u793a\n\n\u4e0a\u8a18\u8868\u793a\u3055\u308c\u305f\u5185\u5bb9\u3092\u5b9f\u969b\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```bash\n# \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u79fb\u52d5\n$/etc/openldap\n\n# slap.d/cn=config\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4e0b\u304ccn=config\u306e\u6761\u4ef6\u306b\u5408\u81f4\u3059\u308b\u30d5\u30a1\u30a4\u30eb\n$tree slapd.d/\nslapd.d/\n\u251c\u2500\u2500 cn=config\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cn=schema\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={0}corba.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={10}ppolicy.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={11}collective.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={1}core.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={2}cosine.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={3}duaconf.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={4}dyngroup.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={5}inetorgperson.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={6}java.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={7}misc.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 cn={8}nis.ldif\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 cn={9}openldap.ldif\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cn=schema.ldif\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 olcDatabase={-1}frontend.ldif\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 olcDatabase={0}config.ldif\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 olcDatabase={1}monitor.ldif\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 olcDatabase={2}bdb.ldif\n\u2514\u2500\u2500 cn=config.ldif\n\n2 directories, 18 files\n\n# \u5b9f\u969b\u306b\u691c\u7d22\u3057\u3066\u307f\u308b\n$find slapd.d/ -type f|xargs cat|grep dn:|sort\ndn: cn=config\ndn: cn=schema\ndn: cn={0}corba\ndn: cn={10}ppolicy\ndn: cn={11}collective\ndn: cn={1}core\ndn: cn={2}cosine\ndn: cn={3}duaconf\ndn: cn={4}dyngroup\ndn: cn={5}inetorgperson\ndn: cn={6}java\ndn: cn={7}misc\ndn: cn={8}nis\ndn: cn={9}openldap\ndn: olcDatabase={-1}frontend\ndn: olcDatabase={0}config\ndn: olcDatabase={1}monitor\ndn: olcDatabase={2}bdb\n```\n\n\u4e0a\u8a18\u7d50\u679c\u3088\u308a\u3001cn=config\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u914d\u4e0b\u306eldif\u3068\u3044\u3046\u62e1\u5f35\u5b50\u3067dn\u5c5e\u6027\u306e\u8a18\u8ff0\u306b\u3064\u3044\u3066\u306e\u7d50\u679c\u3092ldapsearch\u30b3\u30de\u30f3\u30c9\u3067\u306f\u629c\u304d\u51fa\u3057\u3066\u3044\u308b\u4e8b\u304c\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\n# \u8272\u3005\u691c\u7d22\u3057\u3066\u307f\u308b\n\n\u8272\u3005\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\n\n## \u30d9\u30fc\u30b9\u30c4\u30ea\u30fc\n\n\u307e\u305a\u306f\u30d9\u30fc\u30b9\u30c4\u30ea\u30fc\u3092\u691c\u7d22\u3057\u307e\u3059\u3002\u30d9\u30fc\u30b9\u30c4\u30ea\u30fc\u306b\u306f\u8d77\u52d5\u6642\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3084PID\u30d5\u30a1\u30a4\u30eb\u3001TLS\u63a5\u7d9a\u6642\u306e\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u306e\u60c5\u5831\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b cn=config -s base\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: cn=config\nobjectClass: olcGlobal\ncn: config\nolcConfigFile: /usr/share/openldap-servers/slapd.conf.obsolete\nolcConfigDir: /etc/openldap/slapd.d\nolcAllows: bind_v2\nolcArgsFile: /var/run/openldap/slapd.args\nolcAttributeOptions: lang-\nolcAuthzPolicy: none\nolcConcurrency: 0\nolcConnMaxPending: 100\nolcConnMaxPendingAuth: 1000\nolcGentleHUP: FALSE\nolcIdleTimeout: 0\nolcIndexSubstrIfMaxLen: 4\nolcIndexSubstrIfMinLen: 2\nolcIndexSubstrAnyLen: 4\nolcIndexSubstrAnyStep: 2\nolcIndexIntLen: 4\nolcListenerThreads: 1\nolcLocalSSF: 71\nolcLogLevel: 0\nolcPidFile: /var/run/openldap/slapd.pid\nolcReadOnly: FALSE\nolcReverseLookup: FALSE\nolcSaslSecProps: noplain,noanonymous\nolcSockbufMaxIncoming: 262143\nolcSockbufMaxIncomingAuth: 16777215\nolcThreads: 16\nolcTLSCACertificatePath: /etc/openldap/certs\nolcTLSCertificateFile: \"OpenLDAP Server\"\nolcTLSCertificateKeyFile: /etc/openldap/certs/password\nolcTLSVerifyClient: never\nolcTLSProtocolMin: 3.1\nolcToolThreads: 1\nolcWriteTimeout: 0\n```\n\n\u4e0a\u8a18\u306f\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u306f`/etc/openldap/slapd.d/cn\\=config.ldif`\u306e\u5185\u5bb9\u306e\u4e00\u90e8\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n### frontend\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n\n\u6b21\u306bfrontend\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u5024\u306b\u3064\u3044\u3066\u78ba\u8a8d\u3057\u307e\u3059\u3002\nfrontend\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u9069\u7528\u3059\u308b\u8a2d\u5b9a\u3092\u8a18\u8f09\u3059\u308b\u305f\u3081\u306e\u6697\u9ed9\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b olcDatabase={-1}frontend,cn=config\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: olcDatabase={-1}frontend,cn=config\nobjectClass: olcDatabaseConfig\nobjectClass: olcFrontendConfig\nolcDatabase: {-1}frontend\nolcAddContentAcl: FALSE\nolcLastMod: TRUE\nolcMaxDerefDepth: 0\nolcReadOnly: FALSE\nolcSchemaDN: cn=Subschema\nolcSyncUseSubentry: FALSE\nolcMonitoring: FALSE\n```\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u7279\u306b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306f\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\n## config\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n\n\u6b21\u306bconfig\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u5024\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nconfig\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fOpenLDAP\u30b5\u30fc\u30d0\u30fc\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b olcDatabase={0}config,cn=config\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: olcDatabase={0}config,cn=config\nobjectClass: olcDatabaseConfig\nolcDatabase: {0}config\nolcAccess: {0}to *  by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=externa\n l,cn=auth\" manage  by * none\nolcAddContentAcl: TRUE\nolcLastMod: TRUE\nolcMaxDerefDepth: 15\nolcReadOnly: FALSE\nolcRootDN: cn=config\nolcSyncUseSubentry: FALSE\nolcMonitoring: FALSE\n```\n\n## monitor\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n\n\u6b21\u306bmonitor\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u5024\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\nmonitor\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fLDAP\u306e\u52d5\u4f5c\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b olcDatabase={1}monitor,cn=config\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: olcDatabase={1}monitor,cn=config\nobjectClass: olcDatabaseConfig\nolcDatabase: {1}monitor\nolcAccess: {0}to *  by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=externa\n l,cn=auth\" read  by dn.base=\"cn=manager,dc=my-domain,dc=com\" read  by * none\nolcAddContentAcl: FALSE\nolcLastMod: TRUE\nolcMaxDerefDepth: 15\nolcReadOnly: FALSE\nolcSyncUseSubentry: FALSE\nolcMonitoring: FALSE\n```\n\n\u3053\u3061\u3089\u3082config\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u540c\u3058\u8a2d\u5b9a\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n## \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n\n\u6700\u5f8c\u306bLDAP\u3067\u30c7\u30fc\u30bf\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b\u5229\u7528\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b olcDatabase={2}bdb,cn=config\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: olcDatabase={2}bdb,cn=config\nobjectClass: olcDatabaseConfig\nobjectClass: olcBdbConfig\nolcDatabase: {2}bdb\nolcDbDirectory: /var/lib/ldap\nolcSuffix: dc=my-domain,dc=com\nolcAddContentAcl: FALSE\nolcLastMod: TRUE\nolcMaxDerefDepth: 15\nolcReadOnly: FALSE\nolcRootDN: cn=Manager,dc=my-domain,dc=com\nolcSyncUseSubentry: FALSE\nolcMonitoring: TRUE\nolcDbCacheSize: 1000\nolcDbCheckpoint: 1024 15\nolcDbNoSync: FALSE\nolcDbDirtyRead: FALSE\nolcDbIDLcacheSize: 0\nolcDbIndex: objectClass pres,eq\nolcDbIndex: cn pres,eq,sub\nolcDbIndex: uid pres,eq,sub\nolcDbIndex: uidNumber pres,eq\nolcDbIndex: gidNumber pres,eq\nolcDbIndex: givenName pres,eq,sub\nolcDbIndex: ou pres,eq,sub\nolcDbIndex: mail pres,eq,sub\nolcDbIndex: sn pres,eq,sub\nolcDbIndex: loginShell pres,eq\nolcDbIndex: memberUid pres,eq,sub\nolcDbIndex: nisMapName pres,eq,sub\nolcDbIndex: nisMapEntry pres,eq,sub\nolcDbLinearIndex: FALSE\nolcDbMode: 0600\nolcDbSearchStack: 16\nolcDbShmKey: 0\nolcDbCacheFree: 1\nolcDbDNcacheSize: 0\n```\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5229\u7528\u3057\u3066\u3044\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7a2e\u985e\u306fBDB(Berkeley)\u3067\u3042\u308b\u3053\u3068\u304c\u300cobjectClass: olcBdbConfig\u300d\u3068\u306a\u3063\u3066\u308b\u70b9\u304b\u3089\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\u306a\u304a\u3001CentOS7\u3067\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3063\u305f\u5834\u5408\u3001BDB\u3092\u6539\u826f\u3057\u305fHDB(Hierarchical DB)\u306a\u3069\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u300colcSuffix: dc=my-domain,dc=com\u300d\u3068\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u4e00\u5ea6\u3053\u3061\u3089\u306e\u5185\u5bb9\u3067\u691c\u7d22\u3057\u3066\u307f\u307e\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b dc=my-domain,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\nNo such object (32)\n```\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\u307e\u3060\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306a\u7d50\u679c\u3067\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\n\nLDAP\u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066\u5229\u7528\u3059\u308b\u305f\u3081\u306b\u65e2\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5b9a\u7fa9\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n```bash\n# \u30b5\u30fc\u30d3\u30b9\u306e\u505c\u6b62\n$sudo service slapd stop\nStopping slapd:                                            [  OK  ]\n\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n$sudo rm /etc/openldap/slapd.d/cn\\=config/olcDatabase\\=\\{2\\}bdb.ldif\n\n# \u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\n$sudo service slapd start\nStarting slapd:                                            [  OK  ]\n\n```\n\n\u4ee5\u4e0b\u306b\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u540d\u300cdc=example, dc=com\u300d\u306e\u30c4\u30ea\u30fc\u3092\u4f5c\u6210\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306eLDIF\u30d5\u30a1\u30a4\u30eb\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\u4f5c\u6210\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306fHDB\u3068\u3057\u307e\u3059\u3002\n\n```text:example_com.ldif\ndn: olcDatabase=hdb,cn=config\nobjectClass: olcHdbConfig\nolcDatabase: hdb\nolcDbDirectory: /var/lib/ldap\nolcSuffix: dc=example,dc=com\nolcRootDN: cn=Manager,dc=example,dc=com\nolcAccess: to * by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\" manage by * none\n```\n\n\u4e0a\u8a18\u306eolcAccess\u884c\u3067\u306fOpenLDAP\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u306eroot\u30e6\u30fc\u30b6\u30fc\u304cSASL/EXTERNAL\u3067\u8a8d\u8a3c\u3057\u305f\u6642\u306b\u7ba1\u7406\u8005\u6a29\u9650\u304c\u4ed8\u4e0e\u3055\u308c\u308b\u3088\u3046\u306b\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u300colcRootDN: cn=Manager,dc=example,dc=com\u300d\u3068\u3059\u308b\u3053\u3068\u3067Linux\u306a\u3069\u306eroot\u30e6\u30fc\u30b6\u30fc\u306b\u4f3c\u305f\u5168\u3066\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u60c5\u5831\u3092\u64cd\u4f5c\u3067\u304d\u308b\u30eb\u30fc\u30c8DN\u306eDN\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002cn(\u4e00\u822c\u540d\u79f0)\u3067\u306f\u4e00\u822c\u7684\u306b\u300cManager\u300d\u304c\u4f7f\u308f\u308c\u307e\u3059\u3002\n\n\u4e0a\u8a18example_com.ldif\u30d5\u30a1\u30a4\u30eb\u306f\u4efb\u610f\u306e\u5834\u6240\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002(/etc/openldap/slapd.d/cn\\=config\u914d\u4e0b\u306a\u3069\u914d\u7f6e\u3059\u308b\u3068\u30d7\u30ed\u30bb\u30b9\u8d77\u52d5\u6642\u306bwarning\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u305d\u308c\u4ee5\u5916\u306e\u4efb\u610f\u306e\u5834\u6240\u306b\u7f6e\u304f\u3088\u3046\u306b\u6ce8\u610f)\n\u914d\u7f6e\u5f8c\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\n\n```bash\n$ldapadd -Y EXTERNAL -H ldapi:/// -f example_com.ldif\n```\n\n\u66f8\u304d\u8fbc\u307f\u5f8c\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b cn=config\n(\u7565)\ndn: olcDatabase={2}hdb,cn=config\nobjectClass: olcHdbConfig\nolcDatabase: {2}hdb\nolcDbDirectory: /var/lib/ldap\nolcSuffix: dc=example,dc=com\nolcAccess: {0}to * by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=external\n ,cn=auth\" manage by * none\nolcRootDN: cn=Manager,dc=example,dc=com\n```\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u5148\u307b\u3069ldif\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u3044\u305f\u5185\u5bb9\u304c\u8a18\u8f09\u3055\u308c\u3066\u3044\u308c\u3070OK\u3067\u3059\u3002\n\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a8\u30f3\u30c8\u30ea\u3092\u683c\u7d0d\u3059\u308b\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u4f5c\u6210\u3067\u304d\u305f\u306e\u3067\u3001\u6b21\u306b\u4e0a\u8a18\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a8\u30f3\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a2\u3064\u306e\u30a8\u30f3\u30c8\u30ea\u3092base.ldif\u3068\u3057\u3066\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```text:base.ldif\n# \u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\n# 2\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n```\n\n\u4e00\u3064\u306eldif\u30d5\u30a1\u30a4\u30eb\u3067\u3082\u30a8\u30f3\u30c8\u30ea\u3068\u30a8\u30f3\u30c8\u30ea\u306e\u9593\u306b\u7a7a\u884c\u3092\u5165\u308c\u308b\u3053\u3068\u3067\u8907\u6570\u306e\u30a8\u30f3\u30c8\u30ea\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u300cdn: dc=example,dc=com\u300d\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u3053\u306eDIT\u306e\u4e00\u756a\u4e0a\u306e\u30a8\u30f3\u30c8\u30ea\u3068\u306a\u308a\u307e\u3059\u3002\n2\u3064\u76ee\u306fou=Users\u3068\u3044\u3046\u8a18\u8ff0\u304c\u3042\u308a\u3001\u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u4e00\u3064\u4e0b\u306e\u968e\u5c64\u306b\u4f4d\u7f6e\u3059\u308bUsers\u3068\u3044\u3046\u7d44\u7e54\u306e\u30a8\u30f3\u30c8\u30ea\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n\u4eca\u56de\u3001\u4e0a\u8a18\u306b\u5408\u308f\u305b\u3066\u7ba1\u7406\u8005\u30a8\u30f3\u30c8\u30ea\u3082\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u7ba1\u7406\u8005\u30a8\u30f3\u30c8\u30ea\u306b\u8a18\u8f09\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash\n$slappasswd\nNew password:\nRe-enter new password:\n{SSHA}WLxWiWqlZb8jWRWm19qV9ptFo3nOUfwj\n```\n\n\u4e0a\u8a18\u3092\u5229\u7528\u3057\u3066\u5148\u307b\u3069\u306ebase.ldif\u306b\u7ba1\u7406\u8005\u30a8\u30f3\u30c8\u30ea\u60c5\u5831\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002userPassword\u5c5e\u6027\u306b\u306f\u4e0a\u8a18\u3067\u751f\u6210\u3057\u305f\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```text:base.ldif\n# \u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\n# 2\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\n# 3\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword: {SSHA}WLxWiWqlZb8jWRWm19qV9ptFo3nOUfwj\n```\n\n\u4e0a\u8a18\u30d5\u30a1\u30a4\u30eb\u3092\u4efb\u610f\u306e\u5834\u6240\u306b\u914d\u7f6e\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3092\u884c\u3044\u307e\u3059\u3002\n\n```bash\n# \u767b\u9332\n$ldapadd -Y EXTERNAL -H ldapi:/// -f base.ldif\n\n# \u767b\u9332\u78ba\u8a8d\u3002\u30a8\u30f3\u30c8\u30ea\u3092\u5168\u3066\u8868\u793a\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b dc=example,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword:: e1NTSEF9V0x4V2lXcWxaYjhqV1JXbTE5cVY5cHRGbzNuT1Vmd2o=\n\n# \u7279\u5b9a\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u307f\u8868\u793a\n$ldapsearch -LLL -Y EXTERNAL -H ldapi:/// -b cn=Manager,dc=example,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword:: e1NTSEF9V0x4V2lXcWxaYjhqV1JXbTE5cVY5cHRGbzNuT1Vmd2o=\n```\n\n\u554f\u984c\u306a\u3051\u308c\u3070\u767b\u9332\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\u8a18\u8ff0\u304c\u8aa4\u3063\u3066\u3044\u308b\u5834\u5408\u3001\u3069\u306e\u5c5e\u6027\u540d\u304c\u8aa4\u3063\u3066\u3044\u308b\u304b\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u4fee\u6b63\u3057\u3001\u767b\u9332\u3057\u76f4\u3057\u307e\u3059\u3002\u6ce8\u610f\u70b9\u3068\u3057\u3066\u4e00\u3064\u306eldif\u30d5\u30a1\u30a4\u30eb\u306b\u8907\u6570\u306e\u30a8\u30f3\u30c8\u30ea\u3092\u8a18\u8ff0\u3057\u3001\u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u554f\u984c\u306a\u304b\u3063\u305f\u304c\u30012\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306e\u8a18\u8ff0\u8aa4\u308a\u304c\u3042\u308b\u5834\u5408\u3001\u4e00\u3064\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u767b\u9332\u3055\u308c\u305f\u72b6\u614b\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u540c\u3058ldif\u3092\u7528\u3044\u3066\u767b\u9332\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u300cdn: dc=example,dc=com\u300d\u306f\u3059\u3067\u306b\u5b58\u5728\u3059\u308b\u3068\u3044\u3046\u65e8\u306e\u8868\u793a\u304c\u3055\u308c\u308b\u305f\u3081\u3001\u305d\u306e\u5834\u5408\u3001\u65e2\u306b\u767b\u9332\u3057\u305f\u60c5\u5831\u306f\u524a\u9664\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u57fa\u672c\u7684\u306b\u4ee5\u964d\u306f\u540c\u3058\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u300cdc=example,dc=com\u300d\u3092\u53c2\u7167\u3059\u308b\u306e\u3067LDAP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u53c2\u7167\u3059\u308b\u8a2d\u5b9a\u306b\u3057\u307e\u3059\u3002\nLDAP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u53c2\u7167\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n```text:/etc/openldap/ldap.conf\nBASE dc=example,dc=com\nURI ldapi:///\n```\n\n\u4e0a\u8a18\u306b\u3088\u308a\u3001\u4eca\u5f8c\u306f\u30db\u30b9\u30c8\u540d\u3068\u30d9\u30fc\u30b9\u30a8\u30f3\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u306a\u304f\u3066\u3082\u60c5\u5831\u306e\u53c2\u7167\u304c\u3067\u304d\u307e\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword:: e1NTSEF9V0x4V2lXcWxaYjhqV1JXbTE5cVY5cHRGbzNuT1Vmd2o=\n```\n\n# \u5916\u90e8\u304b\u3089\u306e\u63a5\u7d9a\u8a2d\u5b9a\n\n\u6b21\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7d4c\u7531\u3067LDAP\u306b\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\u307e\u305a\u306f\u30a8\u30f3\u30c8\u30ea\u306b\u8a8d\u8a3c\u306e\u305f\u3081\u306b\u6a29\u9650\u3092\u4ed8\u4e0e\u3057\u307e\u3059\u3002\n\n```text:acl.ldif\ndn: olcDatabase={2}hdb,cn=config\nreplace: olcAccess\nolcAccess: to * by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\" manage by * break\nolcAccess: to attrs=userPassword by anonymous auth by * none\nolcAccess: to * by * read\n```\n\u65e2\u306b\u5b9a\u7fa9\u3055\u308c\u305f\u30a8\u30f3\u30c8\u30ea\u3092\u5909\u66f4\u3059\u308b\u305f\u3081\u306b`ldapmodify`\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash\n$ldapmodify -Y EXTERNAL -f acl.ldif\n```\n\n\u767b\u9332\u5f8c\u3001\u7ba1\u7406\u8005\u30a8\u30f3\u30c8\u30ea\u3067\u8a8d\u8a3c\u3067\u304d\u308b\u304b\u3084\u3063\u3066\u307f\u307e\u3059\u3002\n\u8a8d\u8a3c\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f`slappasswd `\u30b3\u30de\u30f3\u30c9\u3067\u6307\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\n```bash\n$dapsearch -x -D\"cn=Manager,dc=example,dc=com\" -H ldap://localhost -W\nEnter LDAP Password:\n# extended LDIF\n#\n# LDAPv3\n# base <dc=example,dc=com> (default) with scope subtree\n# filter: (objectclass=*)\n# requesting: ALL\n#\n\n# example.com\ndn: dc=example,dc=com\ndc: example\no: example.com\nobjectClass: dcObject\nobjectClass: organization\n\n# Users, example.com\ndn: ou=Users,dc=example,dc=com\nou: Users\nobjectClass: organizationalUnit\n\n# Manager, example.com\ndn: cn=Manager,dc=example,dc=com\nobjectClass: organizationalRole\nobjectClass: simpleSecurityObject\ncn: Manager\nuserPassword:: e1NTSEF9V0x4V2lXcWxaYjhqV1JXbTE5cVY5cHRGbzNuT1Vmd2o=\n\n# search result\nsearch: 2\nresult: 0 Success\n\n# numResponses: 4\n# numEntries: 3\n```\n\n\u8a8d\u8a3c\u5f8c\u3001\u30a8\u30f3\u30c8\u30ea\u306e\u60c5\u5831\u304c\u7121\u4e8b\u53d6\u5f97\u3067\u304d\u307e\u3057\u305f\u3002\n\n# \u30e6\u30fc\u30b6\u30fc\u3001\u30b0\u30eb\u30fc\u30d7\u306e\u8ffd\u52a0\n\n\u30e6\u30fc\u30b6\u30fc\u304c\u30b0\u30eb\u30fc\u30d7\u306e\u30a8\u30f3\u30c8\u30ea\u3092\u767b\u9332\u3067\u304d\u308b\u6e96\u5099\u3092\u3057\u307e\u3059\u3002\n\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\u306bobjectClass\u3068\u3057\u3066\u300cinetOrgPerson\u300d\u3001\u300cposixAccount\u300d\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u5229\u7528\u3057\u305f\u3044objectClass\u304c\u8aad\u307f\u8fbc\u307f\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$ldapsearch -LLL -Y EXTERNAL -b cn=schema,cn=config dn\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: cn=schema,cn=config\n\ndn: cn={0}corba,cn=schema,cn=config\n\ndn: cn={1}core,cn=schema,cn=config\n\ndn: cn={2}cosine,cn=schema,cn=config\n\ndn: cn={3}duaconf,cn=schema,cn=config\n\ndn: cn={4}dyngroup,cn=schema,cn=config\n\ndn: cn={5}inetorgperson,cn=schema,cn=config\n\ndn: cn={6}java,cn=schema,cn=config\n\ndn: cn={7}misc,cn=schema,cn=config\n\ndn: cn={8}nis,cn=schema,cn=config\n\ndn: cn={9}openldap,cn=schema,cn=config\n\ndn: cn={10}ppolicy,cn=schema,cn=config\n\ndn: cn={11}collective,cn=schema,cn=config\n```\n\ninetOrgPerson\u304c\u4f9d\u5b58\u3057\u3066\u3044\u308bcosine\u30b9\u30ad\u30fc\u30de\u3001inetorgperson\u30b9\u30ad\u30fc\u30de\u3001posixAccount\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308bnis\u30b9\u30ad\u30fc\u30de\u304c\u8aad\u307f\u8fbc\u307e\u308c\u3066\u304a\u308a\u3001\u3059\u3067\u306b\u5404objectClass\u304c\u5229\u7528\u51fa\u6765\u308b\u72b6\u614b\u3067\u3042\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u306e\u3067\u3001\u4f55\u3082\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n# \u30e6\u30fc\u30b6\u30fc\u306e\u767b\u9332\n\n\u5b9f\u969b\u306b\u30e6\u30fc\u30b6\u30fc\u306e\u767b\u9332\u3092\u884c\u3063\u3066\u307f\u307e\u3059\u3002\n\u767b\u9332\u3059\u308b\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u306eldif\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```text:user.ldif\ndn: uid=testuser01,ou=Users,dc=example,dc=com\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: testuser01\ncn: \u3086\u30fc\u3056\u30fc01\nsn: \u30c6\u30b9\u30c8\nuidNumber: 10001\ngidNumber: 10001\nhomeDirectory: /home/testuser01\n```\n\n\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```bash\n# \u767b\u9332\n$ldapadd -Y EXTERNAL -f users.ldif\n\n# \u78ba\u8a8d\n$ldapsearch -LLL -Y EXTERNAL -b uid=testuser01,ou=Users,dc=example,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\ndn: uid=testuser01,ou=Users,dc=example,dc=com\nobjectClass: inetOrgPerson\nobjectClass: posixAccount\nuid: testuser01\ncn:: 44KG44O844GW44O8MDE=\nsn:: 44OG44K544OI\nuidNumber: 10001\ngidNumber: 10001\nhomeDirectory: /home/testuser01\n```\n\n\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u304c\u8ffd\u52a0\u3067\u304d\u307e\u3057\u305f\u3002\n\u4e0a\u8a18\u30e6\u30fc\u30b6\u30fc\u3067\u8a8d\u8a3c\u3092\u3057\u3066\u307f\u305f\u3044\u306e\u3067\u3059\u304c\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067`ldappasswd`\u30b3\u30de\u30f3\u30c9\u3092\u5229\u7528\u3057\u3066\u30e9\u30f3\u30c0\u30e0\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5272\u308a\u5f53\u3066\u3066\u304b\u3089\u8a8d\u8a3c\u3057\u3066\u307f\u307e\u3059\u3002\n\n```bash\n# \u30e9\u30f3\u30c0\u30e0\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n$ldappasswd -Y EXTERNAL uid=testuser01,ou=Users,dc=example,dc=com\nSASL/EXTERNAL authentication started\nSASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\nSASL SSF: 0\nNew password: sqZUZ7Zh\n\n# \u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u8a8d\u8a3c\n$ldapwhoami -x -D uid=testuser01,ou=Users,dc=example,dc=com -H ldap://localhost -W\nEnter LDAP Password:\ndn:uid=testuser01,ou=Users,dc=example,dc=com\n```\n"}