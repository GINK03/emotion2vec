{"context": " More than 1 year has passed since last update.Amazon SNS\u306e\u30e2\u30d0\u30a4\u30eb\u30d7\u30c3\u30b7\u30e5\u3092\u4f7f\u3063\u3066GCM\u7d4c\u7531\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u65b9\u6cd5\u306e\u3081\u3082\n\nGCM\u306e\u8a2d\u5b9a\nSNS\u304b\u3089GCM\u3092\u7d4c\u7531\u3057\u3066\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u305f\u3081\u3001\u307e\u305a\u306fGCM\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\nGoogle Developer Console\u3067GCM\u3092\u6709\u52b9\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\nGoogle Developer Console\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u9078\u629e\uff08\u307e\u305f\u306f\u4f5c\u6210\uff09\nAPI\u304b\u3089Cloud Messaging for Android\u3092\u9078\u629e\n\nAPI\u3092\u6709\u52b9\u306b\u3059\u308b\n\n\"\u8a8d\u8a3c\u60c5\u5831\"\u304b\u3089API\u30ad\u30fc\u3092\u4f5c\u6210 \n\n\u30b5\u30fc\u30d0\u30fc\u30ad\u30fc\u9078\u629e\n\nIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u3066\u4f5c\u6210\uff08IP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u3069\u306e\u30a2\u30c9\u30ec\u30b9\u304b\u3089\u3067\u3082\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u4ed8\u3051\u308b\uff09\n\nAPI\u30ad\u30fc\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\n\n\n\nGCM\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u53d6\u5f97\n1.\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u53d6\u5f97\n2. \u30d1\u30c3\u30b1\u30fc\u30b8\u306bAndroid\u30a2\u30d7\u30ea\u306e\u30eb\u30fc\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u8a2d\u5b9a\u3057\uff08\u3053\u3053\u3067\u306f\"gcm.play.android.samples.com.gcmquickstart\"\u3092\u8a2d\u5b9a\uff09\u3001\"Choose and configure services\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n\n3.\"ENABLE GOOGLE CLOUD MESSAGING\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n\n4.\"Server API Key\"\u3068\"Sender ID\"\u306f\u5f8c\u307b\u3069\u5229\u7528\u3059\u308b\u306e\u3067\u4fdd\u5b58\u3057\u3066\u304a\u304d\u307e\u3059\u3002\"Generate configuration files\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n\nSender ID:\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30a2\u30d7\u30ea\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u306e\u8a8d\u8a3c\u306b\u4f7f\u7528\u3059\u308b\nAPI Key:\n\n\n5.\"Download google-services.json\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\n\n\nGCM\u306eregist token\u53d6\u5f97\n\u53c2\u7167\uff1aTry Cloud Messaging for Android\n\u6ce8\uff1a\u6700\u65b0\u306eAndroid Studio\u3068Google Play Services\u304c\u5fc5\u8981\u3067\u3059\u3002\n\ngoogle-services\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u3057\u307e\u3059\n\n$ git clone https://github.com/googlesamples/google-services.git\n\n\nAndroidStudio\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u958b\u304d\u307e\u3059\uff08google-services/android/gcm\uff09\n\u4ee5\u4e0b\u306e\u30bd\u30fc\u30b9\u3092\u7de8\u96c6\u3057\u307e\u3059\n\n\ngcm.play.android.samples.com.gcmsender.GcmSender.java 30\u884c\u76eepublic static final String API_KEY = \"[Server API Key]\";\n\nres/values/strings.xml 9\u884c\u76ee<string name=\"gcm_defaultSenderId\">[Sender ID]</string>\n\nServer API Key\u3001Sender ID\u306f\u524d\u7bc0\u306eGoogle Developer Console\u3067\u53d6\u5f97\u3057\u305f\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\n\n\napp\u3092\u5b9f\u884c\u3057\u307e\u3059\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059./gradlew run -Pargs=\"\u3053\u3093\u306b\u3061\u306f\"\nAndroid\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u304c\u6765\u307e\u3059\n\n\n\u3061\u306a\u307f\u306b\u3001\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306f\u8d77\u52d5\u6642\u306b\"/topics/global\"\u3092\u8cfc\u8aad\u3057\u3066\u3044\u307e\u3059\u3002gradlew\u30b3\u30de\u30f3\u30c9\u3067\u306f\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u307f\u3092\u6e21\u3059\u3068\"/topics/global\"\u3068\u3044\u3046Topic\u306b\u30d1\u30d6\u30ea\u30c3\u30b7\u30e5\u3059\u308b\u306e\u3067\u3001\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u8d77\u52d5\u3057\u305f\u7aef\u672b\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nTopic\u3067\u306f\u306a\u304f\u3001\u7279\u5b9a\u306e\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u306b\u306f\u7b2c\u4e8c\u5f15\u6570\u306b[regist token]\u3092\u6e21\u3057\u307e\u3059\u3002\n./gradlew run -Pargs=\"\u3053\u3093\u306b\u3061\u306f,[regist token]\"\n\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001[regist token]\u306e\u7aef\u672b\u306b\u306e\u307f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30d1\u30d6\u30ea\u30c3\u30b7\u30e5\u3067\u304d\u307e\u3059\u3002\nTopic\u306b\u3064\u3044\u3066\u306e\u8a73\u7d30\u306fImplementing Topic Messaging\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nregistration token\u306e\u53d6\u5f97\n\u300cGCM\u306e\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\u300d\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\u3053\u306eRegistration Token\u304cGCM\u304b\u3089\u306eregistration token\u3068\u306a\u308a\u307e\u3059\u3002\n08-07 12:01:37.960  13513-13567/gcm.play.android.samples.com.gcmquickstart I/RegIntentService\ufe55 GCM Registration Token: xxxxx\n\nregistration token\u53d6\u5f97\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002InstanceID\u3092\u5229\u7528\u3057\u3066\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002getInstance\u306e\u5f15\u6570\u306b\u306fContext\u3092\u6e21\u3057\u307e\u3059\u3002R.string.gcm_defaultSenderId\u306e\u5024\u306fstring.xml\u306b\u8a2d\u5b9a\u3057\u305f[Sender ID]\u3067\u3059\u3002\n\nRegistrationIntentService.java(53\u884c\u76ee)\nInstanceID instanceID = InstanceID.getInstance(this);\nString token = instanceID.getToken(getString(R.string.gcm_defaultSenderId),\n        GoogleCloudMessaging.INSTANCE_ID_SCOPE, null)\n\n\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\nPUSH\u901a\u77e5\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\u3059\u308b\u306b\u306fGcmListenerService\u3092\u62e1\u5f35\u3057\u307e\u3059\u3002\nonMessageReceived\u30e1\u30bd\u30c3\u30c9\u3092\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3057\u3066\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u53d7\u4fe1\u5f8c\u306e\u51e6\u7406\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n@Override\npublic void onMessageReceived(String from, Bundle data) {\n    String message = data.getString(\"message\");\n    Log.d(TAG, \"From: \" + from);\n    Log.d(TAG, \"Message: \" + message);\n\n    /**\n     * Production applications would usually process the message here.\n     * Eg: - Syncing with server.\n     *     - Store message in local database.\n     *     - Update UI.\n     */\n\n    /**\n     * In some cases it may be useful to show a notification indicating to the user\n     * that a message was received.\n     */\n    sendNotification(message);\n}\n\n\n\n./gradlew run -Pargs=\"\u3053\u3093\u306b\u3061\u306f\"\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\n\n08-12 11:02:24.612   2954-17735/gcm.play.android.samples.com.gcmquickstart D/MyGcmListenerService\ufe55 From: /topics/global\n08-12 11:02:24.612   2954-17735/gcm.play.android.samples.com.gcmquickstart D/MyGcmListenerService\ufe55 Message: \u3053\u3093\u306b\u3061\u306f\n\n\n\n./gradlew run -Pargs=\"\u3053\u3093\u306b\u3061\u306f,[regist token]\"\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\n\n08-12 11:28:04.964   30196-2379/gcm.play.android.samples.com.gcmquickstart D/MyGcmListenerService\ufe55 From: [Sender ID]\n08-12 11:28:04.964   30196-2379/gcm.play.android.samples.com.gcmquickstart D/MyGcmListenerService\ufe55 Message: \u3053\u3093\u306b\u3061\u306f\n\n\nGCM\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u8a73\u7d30\nGCM\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff08Android\uff09\u306e\u8a73\u7d30\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306eURL\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nImplementing GCM Client on Android\n\n\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\n\n\u624b\u52d5\u3067\u901a\u77e5\n\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u624b\u52d5\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u9001\u3063\u3066\u307f\u307e\u3059\u3002\n\nAmazon SNS\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089[Applications]\u3092\u9078\u629e\u3057\u3001[Create Platform Application]\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n\n\n\u4ee5\u4e0b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\n\n\nApplication Name:\u4efb\u610f\u306e\u5024\uff08\u4eca\u56de\u306fSampleGCM\u3092\u8a2d\u5b9a\uff09\nPush Notification Platform:Google Cloud Messaging(GCM)\nAPI Key:GCM\u306e\u8a2d\u5b9a\u3067\u53d6\u5f97\u3057\u305fServer API Key\n\n\n\n\nApplication\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\n\n\n\u4f5c\u6210\u3057\u305fApplication\u3092\u9078\u629e\u3057\u3066[Create Platform Endpoint]\u3092\u30af\u30ea\u30c3\u30af\n\n\nDevice token\u306b\u300cGCM\u306eregist token\u53d6\u5f97\u300d\u3067\u53d6\u5f97\u3057\u305fregist token\u3092\u8a2d\u5b9a\u3057\u3001[Add endpoint]\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\uff08User data\u306f\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u95a2\u9023\u4ed8\u3051\u308b\u4efb\u610f\u306e\u5024\u3067Amazon\u3000SNS\u306f\u3053\u306e\u5024\u3092\u4f7f\u7528\u3057\u307e\u305b\u3093\uff09\n\n\n\u30c7\u30d0\u30a4\u30b9\u3092\u767b\u9332\u3057\u305f\u3089\u3001SampleGCM\u306eARN\u306e\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u300cApplication Details\u300d\u3092\u8868\u793a\u3057\u307e\u3059\n\u767b\u9332\u3057\u305fToken\u3092\u9078\u629e\u3057\u3066[Publish to Endpoint]\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n\n\n[JSON message generator]\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n\n\n[Message]\u3092\u5165\u529b\u3057\u3066[Generate JSON]\u3092\u30af\u30ea\u30c3\u30af\n\n\nGCM\u7528\u306eJSON\u304c\u751f\u6210\u3055\u308c\u308b\u306e\u3067\u3001[Publish message]\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u307e\u3059\n\n\n\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u304c\u304d\u307e\u3059\n\n\n\nJava\u3067\u901a\u77e5\nAWS SDK for Java\u3092\u5229\u7528\u3057\u3066\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u884c\u3044\u307e\u3059\u3002\n\n\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\n1\u3092\u89e3\u51cd\u3057\u3001snsmobilepush/SNSSamples\u3092IDE\u3067\u958b\u304d\u307e\u3059\n\u4ee5\u4e0b\u3092\u7de8\u96c6\u3057\u307e\u3059\n\n\nAPI Key:GCM\u306eAPI Key\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d:GCM\u3092\u5229\u7528\u53ef\u80fd\u306b\u8a2d\u5b9a\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\n\n\n\n\nSNSMobilePush.java(96\u884c\u76ee)\nString serverAPIKey = \"[API Key]\";\nString applicationName = \"[\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d]\";\nString registrationId = \"[regist token]\";\n\n\n4.AwsCredentials.properties\u3092\u7de8\u96c6\u3057\u307e\u3059\n\nAwsCredentials.properties\naccessKey=[Amazon SNS\u3092\u5229\u7528\u53ef\u80fd\u306aAWS\u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc]\nsecretKey=[Amazon SNS\u3092\u5229\u7528\u53ef\u80fd\u306aAWS\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc]\n\n\n5.SNSMobilePush.java(66\u884c\u76ee)\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u5916\u3057\u307e\u3059\n\nSNSMobilePush.java\nsample.demoAndroidAppNotification();\n\n\n6.com.amazonaws.sns.samples.mobilepush.SNSMobilePush\u3092\u5b9f\u884c\u3059\u308b\u3068\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u304c\u304d\u307e\u3059\n\nAmazon SNS\u306e\u30e2\u30d0\u30a4\u30eb\u30d7\u30c3\u30b7\u30e5\u3092\u4f7f\u3063\u3066GCM\u7d4c\u7531\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u65b9\u6cd5\u306e\u3081\u3082\n#GCM\u306e\u8a2d\u5b9a\nSNS\u304b\u3089GCM\u3092\u7d4c\u7531\u3057\u3066\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u305f\u3081\u3001\u307e\u305a\u306fGCM\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\nGoogle Developer Console\u3067GCM\u3092\u6709\u52b9\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n1. [Google Developer Console](https://console.developers.google.com)\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u9078\u629e\uff08\u307e\u305f\u306f\u4f5c\u6210\uff09\n2. API\u304b\u3089Cloud Messaging for Android\u3092\u9078\u629e\n![API_\u30e9\u30a4\u30d5\u3099\u30e9\u30ea_-_Default_Demo_App.png](https://qiita-image-store.s3.amazonaws.com/0/23385/e5654d6f-3eed-efb3-473d-60b53087e753.png \"API_\u30e9\u30a4\u30d5\u3099\u30e9\u30ea_-_Default_Demo_App.png\")\n\n3. API\u3092\u6709\u52b9\u306b\u3059\u308b\n![Google_Cloud_Messaging_for_Android_-_Default_Demo_App.png](https://qiita-image-store.s3.amazonaws.com/0/23385/8d4b1619-d87c-5592-13e3-4fd9ca371b3a.png \"Google_Cloud_Messaging_for_Android_-_Default_Demo_App.png\")\n4. \"\u8a8d\u8a3c\u60c5\u5831\"\u304b\u3089API\u30ad\u30fc\u3092\u4f5c\u6210 \n![\u8a8d\u8a3c\u60c5\u5831_-_Default_Demo_App.png](https://qiita-image-store.s3.amazonaws.com/0/23385/cea4ab16-c5a2-d90c-1d35-ada25f2af369.png \"\u8a8d\u8a3c\u60c5\u5831_-_Default_Demo_App.png\")\n\n5. \u30b5\u30fc\u30d0\u30fc\u30ad\u30fc\u9078\u629e\n![\u8a8d\u8a3c\u60c5\u5831_-_Default_Demo_App2.png](https://qiita-image-store.s3.amazonaws.com/0/23385/bbf267d6-d8bd-920d-a41c-2c24150ca2f2.png \"\u8a8d\u8a3c\u60c5\u5831_-_Default_Demo_App2.png\")\n\n6. IP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u3066\u4f5c\u6210\uff08IP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u3069\u306e\u30a2\u30c9\u30ec\u30b9\u304b\u3089\u3067\u3082\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u4ed8\u3051\u308b\uff09\n![\u8a8d\u8a3c\u60c5\u5831_-_Default_Demo_App3.png](https://qiita-image-store.s3.amazonaws.com/0/23385/a19fbd81-24c6-0d47-d099-9907726a7e3c.png \"\u8a8d\u8a3c\u60c5\u5831_-_Default_Demo_App3.png\")\n7. API\u30ad\u30fc\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\n![\u8a8d\u8a3c\u60c5\u5831_-_Default_Demo_App4.png](https://qiita-image-store.s3.amazonaws.com/0/23385/6170b34b-b0d1-cbe3-7f87-3538f3e56cf1.png \"\u8a8d\u8a3c\u60c5\u5831_-_Default_Demo_App4.png\")\n\n# GCM\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u53d6\u5f97\n1.\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\n[\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u53d6\u5f97](https://developers.google.com/mobile/add?platform=android&cntapi=gcm&cntapp=Default%20Demo%20App&cntpkg=gcm.play.android.samples.com.gcmquickstart&cnturl=https:%2F%2Fdevelopers.google.com%2Fcloud-messaging%2Fandroid%2Fstart%3Fconfigured%3Dtrue&cntlbl=Continue%20Try%20Cloud%20Messaging)\n2. \u30d1\u30c3\u30b1\u30fc\u30b8\u306bAndroid\u30a2\u30d7\u30ea\u306e\u30eb\u30fc\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u8a2d\u5b9a\u3057\uff08\u3053\u3053\u3067\u306f\"gcm.play.android.samples.com.gcmquickstart\"\u3092\u8a2d\u5b9a\uff09\u3001\"Choose and configure services\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n![Add_Google_Services_\u00a0___\u00a0_Google_Developers.png](https://qiita-image-store.s3.amazonaws.com/0/23385/417497c1-836b-c85c-b8c0-a0bd1ff4088d.png \"Add_Google_Services_\u00a0___\u00a0_Google_Developers.png\")\n\n\n3.\"ENABLE GOOGLE CLOUD MESSAGING\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n![Add_Google_Services_\u00a0___\u00a0_Google_Developers2.png](https://qiita-image-store.s3.amazonaws.com/0/23385/bf6c02a8-44c0-6af9-f362-d3c52c16d332.png \"Add_Google_Services_\u00a0___\u00a0_Google_Developers2.png\")\n\n\n4.\"Server API Key\"\u3068\"Sender ID\"\u306f\u5f8c\u307b\u3069\u5229\u7528\u3059\u308b\u306e\u3067\u4fdd\u5b58\u3057\u3066\u304a\u304d\u307e\u3059\u3002\"Generate configuration files\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n\n - Sender ID:\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30a2\u30d7\u30ea\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u306e\u8a8d\u8a3c\u306b\u4f7f\u7528\u3059\u308b\n - API Key:\n\n\n![Add_Google_Services_\u00a0___\u00a0_Google_Developers3.png](https://qiita-image-store.s3.amazonaws.com/0/23385/47cbb0ee-acea-bb26-35a4-9e7d26f39eb1.png \"Add_Google_Services_\u00a0___\u00a0_Google_Developers3.png\")\n\n5.\"Download google-services.json\"\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\n![Add_Google_Services_\u00a0___\u00a0_Google_Developers4.png](https://qiita-image-store.s3.amazonaws.com/0/23385/8504ce41-1d5f-1f52-f1b3-33f71f43cb6e.png \"Add_Google_Services_\u00a0___\u00a0_Google_Developers4.png\")\n\n# GCM\u306eregist token\u53d6\u5f97\n\n\u53c2\u7167\uff1a[Try Cloud Messaging for Android](https://developers.google.com/cloud-messaging/android/start)\n\u6ce8\uff1a\u6700\u65b0\u306e[Android Studio](https://developer.android.com/intl/ja/sdk/index.html)\u3068[Google Play Services](https://developer.android.com/intl/ja/sdk/installing/adding-packages.html)\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n1. google-services\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u3057\u307e\u3059\n``` \n$ git clone https://github.com/googlesamples/google-services.git\n```\n2. AndroidStudio\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u958b\u304d\u307e\u3059\uff08google-services/android/gcm\uff09\n3. \u4ee5\u4e0b\u306e\u30bd\u30fc\u30b9\u3092\u7de8\u96c6\u3057\u307e\u3059\n - gcm.play.android.samples.com.gcmsender.GcmSender.java 30\u884c\u76ee```public static final String API_KEY = \"[Server API Key]\";```\n - res/values/strings.xml 9\u884c\u76ee```<string name=\"gcm_defaultSenderId\">[Sender ID]</string>```\n - Server API Key\u3001Sender ID\u306f\u524d\u7bc0\u306eGoogle Developer Console\u3067\u53d6\u5f97\u3057\u305f\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\n4. app\u3092\u5b9f\u884c\u3057\u307e\u3059\n![device-2015-08-12-104216.png](https://qiita-image-store.s3.amazonaws.com/0/23385/dbfc3ff5-b125-85f1-3109-1f99f0dd23da.png \"device-2015-08-12-104216.png\")\n\n5. \u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059```./gradlew run -Pargs=\"\u3053\u3093\u306b\u3061\u306f\"```\n6. Android\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u304c\u6765\u307e\u3059\n![device-2015-08-07-121455.png](https://qiita-image-store.s3.amazonaws.com/0/23385/f4dc372d-4635-52ee-1923-ffd2c03611c7.png \"device-2015-08-07-121455.png\")\n\n\u3061\u306a\u307f\u306b\u3001\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306f\u8d77\u52d5\u6642\u306b\"/topics/global\"\u3092\u8cfc\u8aad\u3057\u3066\u3044\u307e\u3059\u3002gradlew\u30b3\u30de\u30f3\u30c9\u3067\u306f\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u307f\u3092\u6e21\u3059\u3068\"/topics/global\"\u3068\u3044\u3046Topic\u306b\u30d1\u30d6\u30ea\u30c3\u30b7\u30e5\u3059\u308b\u306e\u3067\u3001\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u8d77\u52d5\u3057\u305f\u7aef\u672b\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nTopic\u3067\u306f\u306a\u304f\u3001\u7279\u5b9a\u306e\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u306b\u306f\u7b2c\u4e8c\u5f15\u6570\u306b[regist token]\u3092\u6e21\u3057\u307e\u3059\u3002\n\n```\n./gradlew run -Pargs=\"\u3053\u3093\u306b\u3061\u306f,[regist token]\"\n```\n\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001[regist token]\u306e\u7aef\u672b\u306b\u306e\u307f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30d1\u30d6\u30ea\u30c3\u30b7\u30e5\u3067\u304d\u307e\u3059\u3002\nTopic\u306b\u3064\u3044\u3066\u306e\u8a73\u7d30\u306f[Implementing Topic Messaging](https://developers.google.com/cloud-messaging/topic-messaging)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\n##registration token\u306e\u53d6\u5f97\n\u300cGCM\u306e\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\u300d\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\u3053\u306eRegistration Token\u304cGCM\u304b\u3089\u306eregistration token\u3068\u306a\u308a\u307e\u3059\u3002\n\n```\n08-07 12:01:37.960  13513-13567/gcm.play.android.samples.com.gcmquickstart I/RegIntentService\ufe55 GCM Registration Token: xxxxx\n```\n\nregistration token\u53d6\u5f97\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002[InstanceID](https://developers.google.com/android/reference/com/google/android/gms/iid/InstanceID)\u3092\u5229\u7528\u3057\u3066\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002```getInstance```\u306e\u5f15\u6570\u306b\u306f```Context```\u3092\u6e21\u3057\u307e\u3059\u3002```R.string.gcm_defaultSenderId```\u306e\u5024\u306fstring.xml\u306b\u8a2d\u5b9a\u3057\u305f[Sender ID]\u3067\u3059\u3002\n\n```java:RegistrationIntentService.java(53\u884c\u76ee)\nInstanceID instanceID = InstanceID.getInstance(this);\nString token = instanceID.getToken(getString(R.string.gcm_defaultSenderId),\n        GoogleCloudMessaging.INSTANCE_ID_SCOPE, null)\n```\n##\u30e1\u30c3\u30bb\u30fc\u30b8\u53d7\u4fe1\n\nPUSH\u901a\u77e5\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u4fe1\u3059\u308b\u306b\u306f```GcmListenerService```\u3092\u62e1\u5f35\u3057\u307e\u3059\u3002\n```onMessageReceived```\u30e1\u30bd\u30c3\u30c9\u3092\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3057\u3066\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u53d7\u4fe1\u5f8c\u306e\u51e6\u7406\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n```java\n@Override\npublic void onMessageReceived(String from, Bundle data) {\n    String message = data.getString(\"message\");\n    Log.d(TAG, \"From: \" + from);\n    Log.d(TAG, \"Message: \" + message);\n\n    /**\n     * Production applications would usually process the message here.\n     * Eg: - Syncing with server.\n     *     - Store message in local database.\n     *     - Update UI.\n     */\n\n    /**\n     * In some cases it may be useful to show a notification indicating to the user\n     * that a message was received.\n     */\n    sendNotification(message);\n}\n```\n\n- ```./gradlew run -Pargs=\"\u3053\u3093\u306b\u3061\u306f\"```\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\n\n```\n08-12 11:02:24.612   2954-17735/gcm.play.android.samples.com.gcmquickstart D/MyGcmListenerService\ufe55 From: /topics/global\n08-12 11:02:24.612   2954-17735/gcm.play.android.samples.com.gcmquickstart D/MyGcmListenerService\ufe55 Message: \u3053\u3093\u306b\u3061\u306f\n```\n\n- ```./gradlew run -Pargs=\"\u3053\u3093\u306b\u3061\u306f,[regist token]\"```\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\n\n```\n08-12 11:28:04.964   30196-2379/gcm.play.android.samples.com.gcmquickstart D/MyGcmListenerService\ufe55 From: [Sender ID]\n08-12 11:28:04.964   30196-2379/gcm.play.android.samples.com.gcmquickstart D/MyGcmListenerService\ufe55 Message: \u3053\u3093\u306b\u3061\u306f\n```\n\n\n\n##GCM\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u8a73\u7d30\nGCM\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff08Android\uff09\u306e\u8a73\u7d30\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306eURL\u3092\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n[Implementing GCM Client on Android](https://developers.google.com/cloud-messaging/android/client)\n\n\n\n#\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\n##\u624b\u52d5\u3067\u901a\u77e5\n\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u624b\u52d5\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u9001\u3063\u3066\u307f\u307e\u3059\u3002\n\n1. Amazon SNS\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089[Applications]\u3092\u9078\u629e\u3057\u3001[Create Platform Application]\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n![AWS_SNS.png](https://qiita-image-store.s3.amazonaws.com/0/23385/f5ca7da2-6b25-7640-75b8-716e2868d0bd.png \"AWS_SNS.png\")\n2. \u4ee5\u4e0b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\n - Application Name:\u4efb\u610f\u306e\u5024\uff08\u4eca\u56de\u306fSampleGCM\u3092\u8a2d\u5b9a\uff09\n - Push Notification Platform:Google Cloud Messaging(GCM)\n - API Key:GCM\u306e\u8a2d\u5b9a\u3067\u53d6\u5f97\u3057\u305fServer API Key\n![AWS_SNS2.png](https://qiita-image-store.s3.amazonaws.com/0/23385/a82ba38d-aa1c-f6ff-b42e-ad5590ff66fd.png \"AWS_SNS2.png\")\n3. Application\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\n![AWS_SNS3.png](https://qiita-image-store.s3.amazonaws.com/0/23385/9e256e34-439f-53be-140f-0b369b762ce8.png \"AWS_SNS3.png\")\n4. \u4f5c\u6210\u3057\u305fApplication\u3092\u9078\u629e\u3057\u3066[Create Platform Endpoint]\u3092\u30af\u30ea\u30c3\u30af\n![AWS_SNS4.png](https://qiita-image-store.s3.amazonaws.com/0/23385/09b2a1b6-39aa-115c-70a3-4266cea11c8b.png \"AWS_SNS4.png\")\n5. Device token\u306b\u300cGCM\u306eregist token\u53d6\u5f97\u300d\u3067\u53d6\u5f97\u3057\u305fregist token\u3092\u8a2d\u5b9a\u3057\u3001[Add endpoint]\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\uff08User data\u306f\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u95a2\u9023\u4ed8\u3051\u308b\u4efb\u610f\u306e\u5024\u3067Amazon\u3000SNS\u306f\u3053\u306e\u5024\u3092\u4f7f\u7528\u3057\u307e\u305b\u3093\uff09\n![AWS_SNS5.png](https://qiita-image-store.s3.amazonaws.com/0/23385/be66ad4d-da97-df01-232e-ca5937bd8d19.png \"AWS_SNS5.png\")\n6. \u30c7\u30d0\u30a4\u30b9\u3092\u767b\u9332\u3057\u305f\u3089\u3001SampleGCM\u306eARN\u306e\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u300cApplication Details\u300d\u3092\u8868\u793a\u3057\u307e\u3059\n7. \u767b\u9332\u3057\u305fToken\u3092\u9078\u629e\u3057\u3066[Publish to Endpoint]\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n![AWS_SNS6.png](https://qiita-image-store.s3.amazonaws.com/0/23385/750a120c-eefa-a217-57fd-fcf66fdc4f38.png \"AWS_SNS6.png\")\n8. [JSON message generator]\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\n![AWS_SNS7.png](https://qiita-image-store.s3.amazonaws.com/0/23385/42778b1a-9e7c-de11-58bd-85d6f2655f29.png \"AWS_SNS7.png\")\n9. [Message]\u3092\u5165\u529b\u3057\u3066[Generate JSON]\u3092\u30af\u30ea\u30c3\u30af\n![AWS_SNS8.png](https://qiita-image-store.s3.amazonaws.com/0/23385/67855e7e-ac0f-093e-eef3-5ec30b3edc92.png \"AWS_SNS8.png\")\n10. GCM\u7528\u306eJSON\u304c\u751f\u6210\u3055\u308c\u308b\u306e\u3067\u3001[Publish message]\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u307e\u3059\n![AWS_SNS9.png](https://qiita-image-store.s3.amazonaws.com/0/23385/81622979-6a03-b09a-e29f-64e08dd1013f.png \"AWS_SNS9.png\")\n11. \u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u304c\u304d\u307e\u3059\n\n![device-2015-08-12-120541.png](https://qiita-image-store.s3.amazonaws.com/0/23385/544498a3-367e-c92e-bd41-84797df9fd2a.png \"device-2015-08-12-120541.png\")\n\n##Java\u3067\u901a\u77e5\n[AWS SDK for Java](https://aws.amazon.com/jp/sdk-for-java/)\u3092\u5229\u7528\u3057\u3066\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u884c\u3044\u307e\u3059\u3002\n\n1. [\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3](https://s3.amazonaws.com/codesamples/sns/latest/snsmobilepush.zip)\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\n2. 1\u3092\u89e3\u51cd\u3057\u3001snsmobilepush/SNSSamples\u3092IDE\u3067\u958b\u304d\u307e\u3059\n3. \u4ee5\u4e0b\u3092\u7de8\u96c6\u3057\u307e\u3059\n - API Key:GCM\u306eAPI Key\n - \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d:GCM\u3092\u5229\u7528\u53ef\u80fd\u306b\u8a2d\u5b9a\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\n\n```java:SNSMobilePush.java(96\u884c\u76ee)\nString serverAPIKey = \"[API Key]\";\nString applicationName = \"[\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d]\";\nString registrationId = \"[regist token]\";\n```\n\n4.AwsCredentials.properties\u3092\u7de8\u96c6\u3057\u307e\u3059\n\n```AwsCredentials.properties\naccessKey=[Amazon SNS\u3092\u5229\u7528\u53ef\u80fd\u306aAWS\u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc]\nsecretKey=[Amazon SNS\u3092\u5229\u7528\u53ef\u80fd\u306aAWS\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc]\n```\n\n5.SNSMobilePush.java(66\u884c\u76ee)\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u5916\u3057\u307e\u3059\n\n```java:SNSMobilePush.java\nsample.demoAndroidAppNotification();\n```\n6.com.amazonaws.sns.samples.mobilepush.SNSMobilePush\u3092\u5b9f\u884c\u3059\u308b\u3068\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u304c\u304d\u307e\u3059\n![device-2015-08-13-111102.png](https://qiita-image-store.s3.amazonaws.com/0/23385/f71121b4-04fd-7f44-55ad-95b24d57b33d.png \"device-2015-08-13-111102.png\")\n\n\n\n\n", "tags": ["Android", "AWS", "SNS", "GCM"]}