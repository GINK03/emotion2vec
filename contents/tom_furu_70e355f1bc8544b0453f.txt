{"tags": ["PHP", "PHP7"], "context": " More than 1 year has passed since last update.PHP\u306b\u304a\u3051\u308b\u4f8b\u5916\u51e6\u7406\u306fPHP5\u304b\u3089\u3067PHP4\u4ee5\u524d\u306b\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u305d\u306e\u9803\u306f\u81ea\u524d\u3067\u5bfe\u51e6\u3059\u308b\u3057\u304b\u306a\u304f\u4e88\u60f3\u5916\u306e\u52d5\u4f5c\u306b\u5bfe\u5fdc\u3057\u304d\u308c\u306a\u3044\u306a\u3069\u3042\u308a\u307e\u3057\u305f\u304c\u3001TryCatch\u30d6\u30ed\u30c3\u30af\u306e\u5b9f\u88c5\u306b\u3088\u308a\u6539\u5584\u3055\u308c\u3064\u3064\u3042\u308a\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u6355\u6349\u3067\u304d\u306a\u3044\u30a8\u30e9\u30fc\u304c\u3042\u308b\u3068\u3044\u3063\u305f\u554f\u984c\u304c\u307e\u3060\u6b8b\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306ePHP7\u3067\u306f\u3001\u305d\u3046\u3044\u3063\u305f\u554f\u984c\u3078\u306e\u5bfe\u51e6\u3082\u884c\u308f\u308c\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u3069\u306e\u3088\u3046\u306b\u6539\u5584\u3055\u308c\u308b\u306e\u304b\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u65e2\u5b58\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\n\u30a8\u30e9\u30fc\u7a2e\u5225\u3068\u3057\u3066\u306f\u4ee5\u4e0b\u3002\n\u3053\u3061\u3089\u3060\u3068\u65e5\u672c\u8a9e\u306a\u306e\u3067\u5206\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n// Fatal errors\nE_ERROR\nE_CORE_ERROR\nE_COMPILE_ERROR\nE_USER_ERROR\n\n// Recoverable fatal errors\nE_RECOVERABLE_ERROR\n// Parse error\nE_PARSE\n\n// Warnings\nE_WARNING\nE_CORE_WARNING\nE_COMPILE_WARNING\nE_USER_WARNING\n\n// Notices etc.\nE_DEPRECATED\nE_USER_DEPRECATED\nE_NOTICE\nE_USER_NOTICE\nE_STRICT\n\n\n\u8ab2\u984c\u2460\n\u4e0a\u8a18\u306b\u3042\u308b\uff14\u3064\u306eFatal errors\u306b\u95a2\u3057\u3066\u306fTryCatch\u3067\u6355\u6349\u3067\u304d\u307e\u305b\u3093\u3002\u76f4\u3050\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u4fee\u4e86\u51e6\u7406\u304c\u8d70\u3063\u3066\u3057\u307e\u3046\u305f\u3081\u3067\u3059\u3002\n\u3053\u308c\u306b\u3064\u3044\u3066\u306fregister_shutdown_function\u95a2\u6570\u3092\u4f7f\u3046\u3068\u3044\u3046\u306e\u304c\u89e3\u6c7a\u6cd5\u3067\u3059\u3002\nregister_shutdown_function(function() { var_dump(error_get_last()); });\n\n$null = null;\n$null->foo();\n\n// shutdown function output:\narray(4) {\n  [\"type\"]=> int(1)\n  [\"message\"]=> string(47) \"Call to a member function foo() on a non-object\"\n  [\"file\"]=> ...\n  [\"line\"]=> ...\n}\n\n\u3057\u304b\u3057\u3001\u3053\u308c\u3067\u306ffinally\u30d6\u30ed\u30c3\u30af\u304c\u4f7f\u3048\u307e\u305b\u3093\u3002\n\u30ea\u30bd\u30fc\u30b9\u306e\u89e3\u653e\u51e6\u7406\u306a\u3069\u5fc5\u305a\u5b9f\u884c\u3057\u305f\u3044\u51e6\u7406\u306b\u5bfe\u5fdc\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u8ab2\u984c\u2461\nClass\u306e__destruct\u3082\u540c\u69d8\u306b\u5b9f\u884c\u3055\u308c\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u305f\u3081\u3001\u30ed\u30c3\u30af\u3055\u308c\u305f\u307e\u307e\u306e\u30ea\u30bd\u30fc\u30b9\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\nclass LockManager {\n    private $lock;\n    public function __construct(Lock $lock) {\n        $this->lock = $lock;\n        $this->lock->acquire();\n    }\n    public function __destruct() {\n        $this->lock->release();\n    }\n}\n\nfunction test($lock) {\n    $manager = new LockManager($lock); // acquire lock\n\n    doSomething();\n\n    // automatically release lock via dtor\n}\n\n\u3053\u306e\u5834\u5408\u306a\u3089doSomething()\u3067FatalError\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306b\u8d77\u3053\u308a\u307e\u3059\u3002\n\n\u65b0\u305f\u306a\u30a8\u30e9\u30fc\u30af\u30e9\u30b9\n\u3053\u306e\u3088\u3046\u306a\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u305f\u3081\u306b\u3001PHP7\u304b\u3089\u306fError\u30af\u30e9\u30b9\u304c\u5b9f\u88c5\u3055\u308c\u307e\u3057\u305f\u3002\nhttp://php.net/manual/ja/class.error.php\nException\u30af\u30e9\u30b9\u306f\u7d99\u627f\u3057\u3066\u3044\u306a\u3044\u3068\u306e\u3053\u3068\u306a\u306e\u3067\u3001\u3053\u3093\u306a\u611f\u3058\u3067\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\ntry {\n    call_method(null); // oops!\n} catch (Exception $ex) {\n    echo \"Exception\u3092\u30ad\u30e3\u30c3\u30c1: {$ex->getMessage()}\\n\";\n} catch (Error $er) {\n    echo \"Error\u3092\u30ad\u30e3\u30c3\u30c1: {$er->getMessage()}\\n\";\n} finally {\n    echo \"finally!!\\n\";\n}\n\n\u7d50\u679c\u306f\nError\u3092\u30ad\u30e3\u30c3\u30c1: Call to undefined function call_method()\nfinally!!\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u7121\u4e8b\u306b\u6355\u6349\u3067\u304d\u307e\u3057\u305f\uff01\n\n\u307e\u3068\u3081\n\u524d\u7f6e\u304d\u3070\u304b\u308a\u306a\u304c\u304f\u306a\u308a\u307e\u3057\u305f\u304c\u3001\u4ee5\u4e0a\u304c\u4f8b\u5916\u51e6\u7406\u306b\u95a2\u3057\u3066\u5206\u304b\u3063\u305f\u3053\u3068\u3067\u3059\u3002\nPHP7\u3078\u79fb\u884c\u3059\u308b\u969b\u306b\u4f8b\u5916\u51e6\u7406\u306e\u7bc4\u56f2\u3092\u5e83\u3052\u308b\u306b\u306fcatch (Error $er){}\u3068\u3044\u3063\u305f\u30d6\u30ed\u30c3\u30af\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002\n\u305f\u3060\u3053\u308c\u306b\u3088\u3063\u3066\u30a8\u30e9\u30fc\u3078\u306e\u5bfe\u51e6\u65b9\u6cd5\u304c\u3084\u308a\u3084\u3059\u304f\u306a\u308a\u305d\u3046\u3067\u3059\u306d\u3002\n\u5168\u3066\u306eFatalError\u306b\u3064\u3044\u3066\u78ba\u8a8d\u3057\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u3069\u306e\u7a0b\u5ea6\u304c\u30ab\u30d0\u30fc\u3067\u304d\u308b\u306e\u304b\u5206\u304b\u3089\u306a\u3044\u306e\u3067\u4eca\u5f8c\u3082\u8272\u3005\u8abf\u3079\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u8b1d\u7f6a\nAdventCalendar\u306e\u6295\u7a3f\u3001\u9045\u308c\u3066\u3057\u307e\u3044\u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\nPHP\u306b\u304a\u3051\u308b\u4f8b\u5916\u51e6\u7406\u306fPHP5\u304b\u3089\u3067PHP4\u4ee5\u524d\u306b\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u305d\u306e\u9803\u306f\u81ea\u524d\u3067\u5bfe\u51e6\u3059\u308b\u3057\u304b\u306a\u304f\u4e88\u60f3\u5916\u306e\u52d5\u4f5c\u306b\u5bfe\u5fdc\u3057\u304d\u308c\u306a\u3044\u306a\u3069\u3042\u308a\u307e\u3057\u305f\u304c\u3001TryCatch\u30d6\u30ed\u30c3\u30af\u306e\u5b9f\u88c5\u306b\u3088\u308a\u6539\u5584\u3055\u308c\u3064\u3064\u3042\u308a\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u6355\u6349\u3067\u304d\u306a\u3044\u30a8\u30e9\u30fc\u304c\u3042\u308b\u3068\u3044\u3063\u305f\u554f\u984c\u304c\u307e\u3060\u6b8b\u3063\u3066\u3044\u307e\u3057\u305f\u3002\u0010\n\u4eca\u56de\u306ePHP7\u3067\u306f\u3001\u305d\u3046\u3044\u3063\u305f\u554f\u984c\u3078\u306e\u5bfe\u51e6\u3082\u884c\u308f\u308c\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u3069\u306e\u3088\u3046\u306b\u6539\u5584\u3055\u308c\u308b\u306e\u304b\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u3002\n\n##\u65e2\u5b58\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\n\u30a8\u30e9\u30fc\u7a2e\u5225\u3068\u3057\u3066\u306f\u4ee5\u4e0b\u3002\n[\u3053\u3061\u3089](http://php.net/manual/ja/errorfunc.constants.php)\u3060\u3068\u65e5\u672c\u8a9e\u306a\u306e\u3067\u5206\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n\n```\n// Fatal errors\nE_ERROR\nE_CORE_ERROR\nE_COMPILE_ERROR\nE_USER_ERROR\n\n// Recoverable fatal errors\nE_RECOVERABLE_ERROR\n// Parse error\nE_PARSE\n\n// Warnings\nE_WARNING\nE_CORE_WARNING\nE_COMPILE_WARNING\nE_USER_WARNING\n\n// Notices etc.\nE_DEPRECATED\nE_USER_DEPRECATED\nE_NOTICE\nE_USER_NOTICE\nE_STRICT\n```\n\n###\u8ab2\u984c\u2460\n\u4e0a\u8a18\u306b\u3042\u308b\uff14\u3064\u306eFatal errors\u306b\u95a2\u3057\u3066\u306fTryCatch\u3067\u6355\u6349\u3067\u304d\u307e\u305b\u3093\u3002\u76f4\u3050\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u4fee\u4e86\u51e6\u7406\u304c\u8d70\u3063\u3066\u3057\u307e\u3046\u305f\u3081\u3067\u3059\u3002\n\u3053\u308c\u306b\u3064\u3044\u3066\u306f`register_shutdown_function`\u95a2\u6570\u3092\u4f7f\u3046\u3068\u3044\u3046\u306e\u304c\u89e3\u6c7a\u6cd5\u3067\u3059\u3002\n\n```\nregister_shutdown_function(function() { var_dump(error_get_last()); });\n \n$null = null;\n$null->foo();\n \n// shutdown function output:\narray(4) {\n  [\"type\"]=> int(1)\n  [\"message\"]=> string(47) \"Call to a member function foo() on a non-object\"\n  [\"file\"]=> ...\n  [\"line\"]=> ...\n}\n```\n\u3057\u304b\u3057\u3001\u3053\u308c\u3067\u306ffinally\u30d6\u30ed\u30c3\u30af\u304c\u4f7f\u3048\u307e\u305b\u3093\u3002\n\u30ea\u30bd\u30fc\u30b9\u306e\u89e3\u653e\u51e6\u7406\u306a\u3069\u5fc5\u305a\u5b9f\u884c\u3057\u305f\u3044\u51e6\u7406\u306b\u5bfe\u5fdc\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002\n\n###\u8ab2\u984c\u2461\n\u0010Class\u306e__destruct\u3082\u540c\u69d8\u306b\u5b9f\u884c\u3055\u308c\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u305f\u3081\u3001\u30ed\u30c3\u30af\u3055\u308c\u305f\u307e\u307e\u306e\u30ea\u30bd\u30fc\u30b9\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n```\nclass LockManager {\n    private $lock;\n    public function __construct(Lock $lock) {\n        $this->lock = $lock;\n        $this->lock->acquire();\n    }\n    public function __destruct() {\n        $this->lock->release();\n    }\n}\n \nfunction test($lock) {\n    $manager = new LockManager($lock); // acquire lock\n \n    doSomething();\n \n    // automatically release lock via dtor\n}\n```\n\u3053\u306e\u5834\u5408\u306a\u3089`doSomething()`\u3067FatalError\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306b\u8d77\u3053\u308a\u307e\u3059\u3002\n\n##\u65b0\u305f\u306a\u30a8\u30e9\u30fc\u30af\u30e9\u30b9\n\u3053\u306e\u3088\u3046\u306a\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u305f\u3081\u306b\u3001PHP7\u304b\u3089\u306f```Error```\u30af\u30e9\u30b9\u304c\u5b9f\u88c5\u3055\u308c\u307e\u3057\u305f\u3002\nhttp://php.net/manual/ja/class.error.php\n`Exception`\u30af\u30e9\u30b9\u306f\u7d99\u627f\u3057\u3066\u3044\u306a\u3044\u3068\u306e\u3053\u3068\u306a\u306e\u3067\u3001\u3053\u3093\u306a\u611f\u3058\u3067\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n```\ntry {\n    call_method(null); // oops!\n} catch (Exception $ex) {\n    echo \"Exception\u3092\u30ad\u30e3\u30c3\u30c1: {$ex->getMessage()}\\n\";\n} catch (Error $er) {\n    echo \"Error\u3092\u30ad\u30e3\u30c3\u30c1: {$er->getMessage()}\\n\";\n} finally {\n    echo \"finally!!\\n\";\n}\n```\n\u7d50\u679c\u306f\n\n```\nError\u3092\u30ad\u30e3\u30c3\u30c1: Call to undefined function call_method()\nfinally!!\n```\n\u3068\u3044\u3046\u611f\u3058\u3067\u7121\u4e8b\u306b\u6355\u6349\u3067\u304d\u307e\u3057\u305f\uff01\n\n##\u307e\u3068\u3081\n\u524d\u7f6e\u304d\u3070\u304b\u308a\u306a\u304c\u304f\u306a\u308a\u307e\u3057\u305f\u304c\u3001\u4ee5\u4e0a\u304c\u4f8b\u5916\u51e6\u7406\u306b\u95a2\u3057\u3066\u5206\u304b\u3063\u305f\u3053\u3068\u3067\u3059\u3002\nPHP7\u3078\u79fb\u884c\u3059\u308b\u969b\u306b\u4f8b\u5916\u51e6\u7406\u306e\u7bc4\u56f2\u3092\u5e83\u3052\u308b\u306b\u306f`catch (Error $er){}`\u3068\u3044\u3063\u305f\u30d6\u30ed\u30c3\u30af\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002\n\u305f\u3060\u3053\u308c\u306b\u3088\u3063\u3066\u30a8\u30e9\u30fc\u3078\u306e\u5bfe\u51e6\u65b9\u6cd5\u304c\u3084\u308a\u3084\u3059\u304f\u306a\u308a\u305d\u3046\u3067\u3059\u306d\u3002\n\u5168\u3066\u306eFatalError\u306b\u3064\u3044\u3066\u78ba\u8a8d\u3057\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u3069\u306e\u7a0b\u5ea6\u304c\u30ab\u30d0\u30fc\u3067\u304d\u308b\u306e\u304b\u5206\u304b\u3089\u306a\u3044\u306e\u3067\u4eca\u5f8c\u3082\u8272\u3005\u8abf\u3079\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n###\u8b1d\u7f6a\nAdventCalendar\u306e\u6295\u7a3f\u3001\u9045\u308c\u3066\u3057\u307e\u3044\u7533\u3057\u8a33\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n"}