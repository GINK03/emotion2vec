{"tags": ["ASP.NET", "mvc", "VB.Net", "dropdown"], "context": "\n\n\u6982\u8981\nTransaction\u306e\u5165\u529b\u88dc\u52a9\u3068\u3057\u3066\u3001Master\u306e\u5185\u5bb9\u3092\u3001DropdownList\u306b\u53d6\u5f97\u3057\u3001Transaction\u306e\u66f4\u65b0\u51e6\u7406\u3092\u884c\u3046\u3002\n\n\u30a4\u30e1\u30fc\u30b8\n\n\n\u74b0\u5883\nWindows7 32bit SP1\nMicrosoft SQL Server 11.00.3000\nVisual Studio2013 Professional Version12.0 Update4\nVB.net\n\n\u5b9f\u88c5\nModel\n\nEmployee.vb\nPublic Class Employee\n Public Property Id As Integer\n Public Property Name As String\n Public Property CountryId As String\nEnd Class\n\n\n\nCountry.vb\nPublic Class Employee\n Public Property Id As Integer\n Public Property CountryId As String\n Public Property CountryName As String\nEnd Class\n\n\n\nSampleContext.vb\nPublic Class SampleContext\n    Inherits DbContext\n Public Sub New()\n  MyBase.New(\"SampleContext\")\n End Sub\n Public Property Employees As DbSet(Of Employee)\n Public Property Countries As DbSet(Of Country)\nEnd Class\n\n\nControl\n\nEmployeeControl.vb\nPublic Class EmployeeController\n    Inherits Controller\n <HttpGet>\n Function Index() As ActionResult\n  Return View(db.Employees.ToList())\n End Function\n\n <HttpGet>\n Function Create() As ActionResult\n  Dim emp As New Employee\n  Dim ct = db.Countrys.ToList()\n  ViewBag.model1 = New SelectList(ct, \"Id\", \"CountryId\", emp.CountryId)\n  ViewBag.model1 = db.Countries.[Select](Function(m) New SelectListItem() With {\n                            .Text = m.CountryName, \n                            .Value = m.CountryId})\n  Return View()\n End Function\n\n <HttpPost>\n Function Create(<Bind(Include:=\"ID,Name,CountryId\")> ByVal employ As Employee) As ActionResult\n  If ModelState.IsValid Then\n   db.Employees.Add(employ)\n   db.SaveChanges()\n   Return RedirectToAction(\"Index\")\n  End If\n  Return View(employ)\n End Function\nEnd Class\n\n\nView\n\nIndex.vbhtml\n@modeltype  DropdownHoge.Models.Employee\n@Code\n    ViewData(\"Title\") = \"Create\"\nEnd Code\n@Using (Html.BeginForm())\n@Html.AntiForgeryToken()\n    @<div class=\"form-horizontal\">\n         <h4>Employee</h4>\n         <hr />\n        @Html.ValidationSummary(True, \"\", New With {.class = \"text-danger\"})\n         <div class=\"form-group\">\n             @Html.LabelFor(Function(model) model.Name, htmlAttributes:=New With {.class = \"control-label col-md-2\"})\n             <div class=\"col-md-10\">\n                 @Html.EditorFor(Function(model) model.Name, New With {.htmlAttributes = New With {.class = \"form-control\"}})\n                 @Html.ValidationMessageFor(Function(model) model.Name, \"\", New With {.class = \"text-danger\"})\n             </div>\n         </div>\n         <div class=\"form-group\">\n             @Html.LabelFor(Function(model) model.CountryId, htmlAttributes:=New With {.class = \"control-label col-sm-2\"})\n             <div class=\"col-sm-10\">\n                 @Html.DropDownListFor(Function(model) model.CountryId, DirectCast(ViewBag.model1, IEnumerable(Of SelectListItem)),\"SELECT\", New With{.class=\"form-control\"})\n             </div>\n         </div>\n         <div class=\"form-group\">\n             <div class=\"col-md-offset-2 col-md-10\">\n                 <input type=\"submit\" value=\"Create\" class=\"btn btn-default\" />\n             </div>\n         </div>\n    </div>\n\nEnd Using\n\n\n\nCreate.vbhtml\n@modeltype  DropdownHoge.Models.Employee\n@Code\n    ViewData(\"Title\") = \"Create\"\nEnd Code\n\n<h2>Create</h2>\n\n@Using (Html.BeginForm())\n    @Html.AntiForgeryToken()\n    @<div class=\"form-horizontal\">\n         <h4>Employee</h4>\n         <hr />\n        @Html.ValidationSummary(True, \"\", New With {.class = \"text-danger\"})\n         <div class=\"form-group\">\n             @Html.LabelFor(Function(model) model.Name, htmlAttributes:=New With {.class = \"control-label col-md-2\"})\n             <div class=\"col-md-10\">\n                 @Html.EditorFor(Function(model) model.Name, New With {.htmlAttributes = New With {.class = \"form-control\"}})\n                 @Html.ValidationMessageFor(Function(model) model.Name, \"\", New With {.class = \"text-danger\"})\n             </div>\n         </div>\n         <div class=\"form-group\">\n             @Html.LabelFor(Function(model) model.CountryId, htmlAttributes:=New With {.class = \"control-label col-sm-2\"})\n             <div class=\"col-sm-10\">\n                 @Html.DropDownListFor(Function(model) model.CountryId, DirectCast(ViewBag.model1, IEnumerable(Of SelectListItem)),\"SELECT\", New With{.class=\"form-control\"})\n             </div>\n         </div>\n         <div class=\"form-group\">\n             <div class=\"col-md-offset-2 col-md-10\">\n                 <input type=\"submit\" value=\"Create\" class=\"btn btn-default\" />\n             </div>\n         </div>\n    </div>\n\nEnd Using\n\n\n\n\u753b\u9762\n\n\n\u6700\u5f8c\u306b\n\u3053\u3053\u307e\u3067\u3044\u304d\u3064\u304f\u306e\u304c\u5927\u5909\u3060\u3063\u305f\u3002\u7406\u89e3\u304c\u8db3\u308a\u306a\u3044\u3068\u3053\u308d\u304c\u591a\u3044\u306e\u3067\u3001\u7406\u89e3\u5f8c\u3001\u90e8\u5206\u30d3\u30e5\u30fc\u3092\u4f7f\u3063\u3066\u3082\u8a66\u3057\u3066\u307f\u308b\u3002\n#\u6982\u8981\nTransaction\u306e\u5165\u529b\u88dc\u52a9\u3068\u3057\u3066\u3001Master\u306e\u5185\u5bb9\u3092\u3001DropdownList\u306b\u53d6\u5f97\u3057\u3001Transaction\u306e\u66f4\u65b0\u51e6\u7406\u3092\u884c\u3046\u3002\n#\u30a4\u30e1\u30fc\u30b8\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/101511/9ee8781f-8bb3-09af-a77f-89a5084f9ba9.png)\n#\u74b0\u5883\nWindows7 32bit SP1\nMicrosoft SQL Server 11.00.3000\nVisual Studio2013 Professional Version12.0 Update4\nVB.net\n#\u5b9f\u88c5\nModel\n\n```vbnet:Employee.vb\nPublic Class Employee\n Public Property Id As Integer\n Public Property Name As String\n Public Property CountryId As String\nEnd Class\n```\n\n```vbnet:Country.vb\nPublic Class Employee\n Public Property Id As Integer\n Public Property CountryId As String\n Public Property CountryName As String\nEnd Class\n```\n\n```vbnet:SampleContext.vb\nPublic Class SampleContext\n    Inherits DbContext\n Public Sub New()\n  MyBase.New(\"SampleContext\")\n End Sub\n Public Property Employees As DbSet(Of Employee)\n Public Property Countries As DbSet(Of Country)\nEnd Class\n```\n\n\nControl\n\n```vbnet:EmployeeControl.vb\nPublic Class EmployeeController\n    Inherits Controller\n <HttpGet>\n Function Index() As ActionResult\n  Return View(db.Employees.ToList())\n End Function\n\n <HttpGet>\n Function Create() As ActionResult\n  Dim emp As New Employee\n  Dim ct = db.Countrys.ToList()\n  ViewBag.model1 = New SelectList(ct, \"Id\", \"CountryId\", emp.CountryId)\n  ViewBag.model1 = db.Countries.[Select](Function(m) New SelectListItem() With {\n                            .Text = m.CountryName, \n                            .Value = m.CountryId})\n  Return View()\n End Function\n\n <HttpPost>\n Function Create(<Bind(Include:=\"ID,Name,CountryId\")> ByVal employ As Employee) As ActionResult\n  If ModelState.IsValid Then\n   db.Employees.Add(employ)\n   db.SaveChanges()\n   Return RedirectToAction(\"Index\")\n  End If\n  Return View(employ)\n End Function\nEnd Class\n```\n\nView\n\n```vbnet:Index.vbhtml\n@modeltype  DropdownHoge.Models.Employee\n@Code\n    ViewData(\"Title\") = \"Create\"\nEnd Code\n@Using (Html.BeginForm())\n@Html.AntiForgeryToken()\n    @<div class=\"form-horizontal\">\n         <h4>Employee</h4>\n         <hr />\n        @Html.ValidationSummary(True, \"\", New With {.class = \"text-danger\"})\n         <div class=\"form-group\">\n             @Html.LabelFor(Function(model) model.Name, htmlAttributes:=New With {.class = \"control-label col-md-2\"})\n             <div class=\"col-md-10\">\n                 @Html.EditorFor(Function(model) model.Name, New With {.htmlAttributes = New With {.class = \"form-control\"}})\n                 @Html.ValidationMessageFor(Function(model) model.Name, \"\", New With {.class = \"text-danger\"})\n             </div>\n         </div>\n         <div class=\"form-group\">\n             @Html.LabelFor(Function(model) model.CountryId, htmlAttributes:=New With {.class = \"control-label col-sm-2\"})\n             <div class=\"col-sm-10\">\n                 @Html.DropDownListFor(Function(model) model.CountryId, DirectCast(ViewBag.model1, IEnumerable(Of SelectListItem)),\"SELECT\", New With{.class=\"form-control\"})\n             </div>\n         </div>\n         <div class=\"form-group\">\n             <div class=\"col-md-offset-2 col-md-10\">\n                 <input type=\"submit\" value=\"Create\" class=\"btn btn-default\" />\n             </div>\n         </div>\n    </div>\n\nEnd Using\n```\n\n```vbnet:Create.vbhtml\n@modeltype  DropdownHoge.Models.Employee\n@Code\n    ViewData(\"Title\") = \"Create\"\nEnd Code\n\n<h2>Create</h2>\n\n@Using (Html.BeginForm())\n    @Html.AntiForgeryToken()\n    @<div class=\"form-horizontal\">\n         <h4>Employee</h4>\n         <hr />\n        @Html.ValidationSummary(True, \"\", New With {.class = \"text-danger\"})\n         <div class=\"form-group\">\n             @Html.LabelFor(Function(model) model.Name, htmlAttributes:=New With {.class = \"control-label col-md-2\"})\n             <div class=\"col-md-10\">\n                 @Html.EditorFor(Function(model) model.Name, New With {.htmlAttributes = New With {.class = \"form-control\"}})\n                 @Html.ValidationMessageFor(Function(model) model.Name, \"\", New With {.class = \"text-danger\"})\n             </div>\n         </div>\n         <div class=\"form-group\">\n             @Html.LabelFor(Function(model) model.CountryId, htmlAttributes:=New With {.class = \"control-label col-sm-2\"})\n             <div class=\"col-sm-10\">\n                 @Html.DropDownListFor(Function(model) model.CountryId, DirectCast(ViewBag.model1, IEnumerable(Of SelectListItem)),\"SELECT\", New With{.class=\"form-control\"})\n             </div>\n         </div>\n         <div class=\"form-group\">\n             <div class=\"col-md-offset-2 col-md-10\">\n                 <input type=\"submit\" value=\"Create\" class=\"btn btn-default\" />\n             </div>\n         </div>\n    </div>\n\nEnd Using\n```\n#\u753b\u9762\n![kekka.png](https://qiita-image-store.s3.amazonaws.com/0/101511/d73590b4-4a65-1143-0d80-910255f769d2.png)\n#\u6700\u5f8c\u306b\n\u3053\u3053\u307e\u3067\u3044\u304d\u3064\u304f\u306e\u304c\u5927\u5909\u3060\u3063\u305f\u3002\u7406\u89e3\u304c\u8db3\u308a\u306a\u3044\u3068\u3053\u308d\u304c\u591a\u3044\u306e\u3067\u3001\u7406\u89e3\u5f8c\u3001\u90e8\u5206\u30d3\u30e5\u30fc\u3092\u4f7f\u3063\u3066\u3082\u8a66\u3057\u3066\u307f\u308b\u3002\n\n\n\n\n"}