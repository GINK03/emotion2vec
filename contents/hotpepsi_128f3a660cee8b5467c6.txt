{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nSSH\u306e\u516c\u958b\u9375\u306b\u306ffingerprint\u304c\u8868\u793a\u3055\u308c\u308b\u304c\u3001\u4f55\u306a\u306e\u304b\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u8abf\u3079\u305f\u30022048bit\u306eRSA\u306e\u516c\u958b\u9375\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\u3002\n\nfingerprint\u3068\u306f\n\u9375\u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306e\u60c5\u5831\u3002\u3044\u308f\u3086\u308b\u96fb\u5b50\u6307\u7d0b\u3002\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u4f7f\u3046\u306e\u3067\u3001\u5024\u304c\u308f\u305a\u304b\u3067\u3082\u7570\u306a\u3063\u3066\u3044\u308b\u3068\u3001\u5168\u304f\u9055\u3046\u5024\u304c\u51fa\u529b\u3055\u308c\u308b\u3002\n\u305d\u306e\u305f\u3081\u3001\u8996\u8a8d\u6027\u304c\u3088\u304f\u3001\u9375\u306e\u5168\u3066\u306e\u60c5\u5831\u3067\u6bd4\u8f03\u3057\u306a\u304f\u3066\u3082\u3059\u3080\u3002\n\u5341\u5206\u306b\u826f\u3044\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u4f7f\u3048\u3070\u3001\u305f\u307e\u305f\u307efingerprint\u304c\u4e00\u81f4\u3059\u308b\u3053\u3068\u306f\u307e\u305a\u306a\u3044\u3002\n(\u73fe\u5728\u3067\u306fMD5\u3067\u306f\u306a\u304fSHA-2\u3092\u4f7f\u3063\u305f\u307b\u3046\u304c\u826f\u3044\u3068\u601d\u308f\u308c\u308b)\n\nOpenSSH\u5f62\u5f0f\n\u516c\u958b\u9375\u306e\u30d5\u30a1\u30a4\u30eb\u5f62\u5f0f\u306b\u306f\u4f55\u7a2e\u985e\u304b\u3042\u308b\u3002SSH\u7528\u306e\u9375\u3092\u4f5c\u308b\u3068\u304d\u3001\u305f\u3044\u3066\u3044\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u4f5c\u308b\u3002\n$ ssh-keygen -t rsa -b 2048\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u3068\u3001ssh-rsa\u3067\u306f\u3058\u307e\u308b\u516c\u958b\u9375\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\u3053\u308c\u306f\u304a\u304a\u3080\u306dRFC4716\u306e\u5f62\u5f0f\u3068\u540c\u3058\u3060\u304c\u3001\u30d8\u30c3\u30c0\u306f\u542b\u307e\u305a\u6539\u884c\u3082\u3055\u308c\u3066\u3044\u306a\u3044\u3002OpenSSH\u72ec\u81ea\u306e\u5f62\u5f0f\u3089\u3057\u3044\u3002BASE64\u306e\u4e2d\u8eab\u306f\u540c\u3058\u306a\u306e\u3067\u3001\n---- BEGIN SSH2 PUBLIC KEY ----\nBASE64\u3067\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305fAAAA\u3067\u306f\u3058\u307e\u308b\u90e8\u5206\u309276\u6587\u5b57\u4ee5\u5185\u306b\u6539\u884c\u3057\u305f\u3082\u306e\n---- END SSH2 PUBLIC KEY ----\n\n\n\u306e\u3088\u3046\u306b\u3059\u308b\u3068RFC4716\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u306a\u308b\u3002\nBASE64\u306e\u4e2d\u8eab(\u30d0\u30a4\u30ca\u30ea\u90e8\u5206)\u306f\u3001RFC4253\u3067\u898f\u5b9a\u3055\u308c\u3066\u3044\u308b\u3002\n\u30d0\u30a4\u30ca\u30ea\u306e\u90e8\u5206\u306fbig endian\u3067\u8a18\u9332\u3055\u308c\u3066\u304a\u308a\u3001\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002(\u5148\u982d\u306e7\u6841\u306e\u6570\u5024\u306f\u30aa\u30d5\u30bb\u30c3\u30c8)\n0000000 00 00 00 07 73 73 68 2d 72 73 61 00 00 00 03 01\n0000010 00 01 00 00 01 01 00 ef 3d a8 c9 e3 ed e6 f3 5b\n0000020 1f b3 db 89 e8 b0 04 e8 11 9c 25 32 c9 4b d4 a3\n0000030 a5 a2 fa ea 94 5a f3 31 ae 38 b5 bc 7d b5 56 24\n0000040 d9 60 b8 e0 e3 44 6b ba 54 82 18 5c 23 cf 09 c8\n0000050 e0 03 2d 11 d2 19 ee e3 a8 97 5d 84 df 13 99 60\n0000060 d8 30 4c 16 83 34 24 fd a7 42 18 62 e1 55 19 f4\n0000070 32 c6 56 af af ba 12 21 a6 8d 9a 54 91 cb ed 28\n0000080 b3 5c 62 ec 88 88 3c 21 c4 ff b9 df 89 f0 d0 8a\n0000090 a1 ad 6f a6 fa 4c 13 b0 3f 74 17 83 92 1d ad 78\n00000a0 aa 40 90 25 93 ef 12 d1 73 e1 6e 7c 30 cd 63 a1\n00000b0 96 b4 77 59 fb 6a 8f 29 41 3d 21 92 0c 94 28 17\n00000c0 47 c9 e6 1d 9c 03 6c 89 88 6a 93 57 7e d8 45 34\n00000d0 e1 3d 69 90 12 ec fc 36 3c 78 6d 36 84 69 3b a5\n00000e0 e7 f5 0d 85 27 a5 b3 b9 21 77 f2 2f 1d 5f 68 37\n00000f0 a4 f6 a3 85 7f fd f0 2c ca 34 59 95 82 84 50 79\n0000100 5d 6f 73 0b fd 01 f1 5a ce fe 86 a5 92 6b d3 42\n0000110 c3 05 d9 1a 11 25 c3                           \n\n\u5148\u982d\u304b\u3089\u3001\u6b21\u306e\u3088\u3046\u306a\u610f\u5473\u3067\u3042\u308b\u3002\n\n\n\nbinary\n\u610f\u5473\n\n\n\n\n00 00 00 07\n\u6587\u5b57\u5217 \"ssh-rsa\"\u306e\u9577\u3055\n\n\n73 73 68 2d 72 73 61\n\"ssh-rsa\"\n\n\n00 00 00 03\n\u6570\u5024\u306e\u30d0\u30a4\u30c8\u6570(3)\n\n\n01 00 01\ne\u306e\u5024(0x10001)\n\n\n00 00 01 01\n\u6570\u5024\u306e\u30d0\u30a4\u30c8\u6570(0x101)\n\n\n00 ef 3d a8...\nn\u306e\u5024(0xEF3DA8...)\n\n\n\n\u3053\u308c\u4ee5\u5916\u306e\u60c5\u5831\u306f\u5165\u3063\u3066\u304a\u3089\u305a\u3001\u304b\u306a\u308a\u30b7\u30f3\u30d7\u30eb\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3042\u308b\u3002\nn\u306e\u5148\u982d\u304c00\u3060\u304c\u3001\u6700\u4e0a\u4f4d\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u30bc\u30ed\u3092\u8ffd\u52a0\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u3066\u3001\u8ca0\u306e\u5024\u3068\u898b\u306a\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u308f\u308c\u308b\u3002\nfingerprint\u306f\u3001\u3053\u306e\u30d0\u30a4\u30ca\u30ea\u90e8\u5206\u306eMD5\u306e\u5024(16\u30d0\u30a4\u30c8)\u3067\u3042\u308b\u3002\n\nPKCS#1\u5f62\u5f0f\nSSH\u4ee5\u5916\u306e\u7528\u9014\u3067\u516c\u958b\u9375\u3092\u3084\u308a\u3068\u308a\u3059\u308b\u3068\u304d\u306f\u3001\u30d8\u30c3\u30c0\u3064\u304d\u306ePEM\u5f62\u5f0f\u3092\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\u3068\u601d\u3046\u3002OpenSSH\u5f62\u5f0f\u304b\u3089\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u5909\u63db\u53ef\u80fd\u3067\u3042\u308b\u3002\n$ ssh-keygen -f hoge.pub -e -m pem\n\n\u203b ssh-keygen\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066\u306f\u3053\u308c\u306f\u5931\u6557\u3059\u308b\u3002\u6700\u65b0\u7248\u306eOpenSSH\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u304b\u3001\u307e\u305f\u306f\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067RFC4716\u5f62\u5f0f\u306e\u79d8\u5bc6\u9375\u304b\u3089\u51fa\u529b\u3067\u304d\u308b\u3002\n$ openssl rsa -in hoge -RSAPublicKey_out\n\n\u524d\u63b2\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u3082\u306e\u304c\u4ee5\u4e0b\u306e\u5f62\u5f0f\u306b\u306a\u308b\u3002\n-----BEGIN RSA PUBLIC KEY-----\nMIIBCgKCAQEA7z2oyePt5vNbH7PbieiwBOgRnCUyyUvUo6Wi+uqUWvMxrji1vH21\nViTZYLjg40RrulSCGFwjzwnI4AMtEdIZ7uOol12E3xOZYNgwTBaDNCT9p0IYYuFV\nGfQyxlavr7oSIaaNmlSRy+0os1xi7IiIPCHE/7nfifDQiqGtb6b6TBOwP3QXg5Id\nrXiqQJAlk+8S0XPhbnwwzWOhlrR3WftqjylBPSGSDJQoF0fJ5h2cA2yJiGqTV37Y\nRTThPWmQEuz8Njx4bTaEaTul5/UNhSels7khd/IvHV9oN6T2o4V//fAsyjRZlYKE\nUHldb3ML/QHxWs7+hqWSa9NCwwXZGhElwwIDAQAB\n-----END RSA PUBLIC KEY-----\n\n\u3053\u308c\u306fPKCS#1\u5f62\u5f0f\u3067\u3001\u4e2d\u8eab\u306fDER\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u6570\u5024(\u3044\u308f\u3086\u308bASN.1\u30d0\u30a4\u30ca\u30ea)\u3067\u3042\u308b\u3002\n\u306a\u304aDER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u3066BASE64\u306b\u304b\u3051\u305f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092PEM\u3068\u547c\u3076\u3088\u3046\u3067\u3001\u69d8\u3005\u306aPEM\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u3002\n0000000 30 82 01 0a 02 82 01 01 00 ef 3d a8 c9 e3 ed e6\n0000010 f3 5b 1f b3 db 89 e8 b0 04 e8 11 9c 25 32 c9 4b\n0000020 d4 a3 a5 a2 fa ea 94 5a f3 31 ae 38 b5 bc 7d b5\n0000030 56 24 d9 60 b8 e0 e3 44 6b ba 54 82 18 5c 23 cf\n0000040 09 c8 e0 03 2d 11 d2 19 ee e3 a8 97 5d 84 df 13\n0000050 99 60 d8 30 4c 16 83 34 24 fd a7 42 18 62 e1 55\n0000060 19 f4 32 c6 56 af af ba 12 21 a6 8d 9a 54 91 cb\n0000070 ed 28 b3 5c 62 ec 88 88 3c 21 c4 ff b9 df 89 f0\n0000080 d0 8a a1 ad 6f a6 fa 4c 13 b0 3f 74 17 83 92 1d\n0000090 ad 78 aa 40 90 25 93 ef 12 d1 73 e1 6e 7c 30 cd\n00000a0 63 a1 96 b4 77 59 fb 6a 8f 29 41 3d 21 92 0c 94\n00000b0 28 17 47 c9 e6 1d 9c 03 6c 89 88 6a 93 57 7e d8\n00000c0 45 34 e1 3d 69 90 12 ec fc 36 3c 78 6d 36 84 69\n00000d0 3b a5 e7 f5 0d 85 27 a5 b3 b9 21 77 f2 2f 1d 5f\n00000e0 68 37 a4 f6 a3 85 7f fd f0 2c ca 34 59 95 82 84\n00000f0 50 79 5d 6f 73 0b fd 01 f1 5a ce fe 86 a5 92 6b\n0000100 d3 42 c3 05 d9 1a 11 25 c3 02 03 01 00 01      \n\n\u610f\u5473\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n\n\nbinary\n\u610f\u5473\n\n\n\n\n30 \u3000\u3000\u3000\nSEQUENCE\n\n\n82\n\u6b21\u306e2\u30d0\u30a4\u30c8\u304cSEQUENCE\u306e\u9577\u3055\n\n\n01 0a\n0x10A\u30d0\u30a4\u30c8\n\n\n02\nINTEGER\n\n\n82\n\u6b21\u306e2\u30d0\u30a4\u30c8\u304cINTEGER\u306e\u9577\u3055\n\n\n01 01\nn\u306e\u9577\u3055(0x101\u30d0\u30a4\u30c8)\n\n\n00 ef 3d a8...\nn\u306e\u5024(0xEF3DA8...)\n\n\n02\nINTEGER\n\n\n03\nINTEGER\u306e\u9577\u3055(3\u30d0\u30a4\u30c8)\n\n\n01 00 01\ne\u306e\u5024(0x10001)\n\n\n\n\u3053\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u306f\u3001\u8907\u5408\u578b\u3067\u6570\u5024\u304c2\u3064\u5165\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u3057\u304b\u8a00\u3063\u3066\u3044\u306a\u3044\u3002\u3053\u308c\u3082\u6bd4\u8f03\u7684\u30b7\u30f3\u30d7\u30eb\u306a\u5f62\u5f0f\u3067\u3042\u308b\u3002\n\nPKCS#8\u5f62\u5f0f\n\u5225\u306e\u5f62\u5f0f\u3082\u3042\u308b\u3002OpenSSL\u3067\n$ openssl genrsa -out hoge.key 2048\n$ openssl rsa -pubout -in hoge.key \n\n\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u751f\u6210\u3067\u304d\u308b\u3002\n\u3082\u3057\u304f\u306f\u3001ssh-keygen\u3067\u4f5c\u6210\u3057\u305f\u9375\u304b\u3089\u3001\n$ openssl rsa -in hoge -pubout\n\n\u3067\u3082\u51fa\u529b\u3067\u304d\u308b\u3002\n\u3053\u308c\u306fPKCS#8\u5f62\u5f0f\u306e\u516c\u958b\u9375\u3067\u3042\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5185\u5bb9\u3067\u3042\u308b\u3002\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7z2oyePt5vNbH7Pbieiw\nBOgRnCUyyUvUo6Wi+uqUWvMxrji1vH21ViTZYLjg40RrulSCGFwjzwnI4AMtEdIZ\n7uOol12E3xOZYNgwTBaDNCT9p0IYYuFVGfQyxlavr7oSIaaNmlSRy+0os1xi7IiI\nPCHE/7nfifDQiqGtb6b6TBOwP3QXg5IdrXiqQJAlk+8S0XPhbnwwzWOhlrR3Wftq\njylBPSGSDJQoF0fJ5h2cA2yJiGqTV37YRTThPWmQEuz8Njx4bTaEaTul5/UNhSel\ns7khd/IvHV9oN6T2o4V//fAsyjRZlYKEUHldb3ML/QHxWs7+hqWSa9NCwwXZGhEl\nwwIDAQAB\n-----END PUBLIC KEY-----\n\n\u30d0\u30a4\u30ca\u30ea\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n0000000 30 82 01 22 30 0d 06 09 2a 86 48 86 f7 0d 01 01\n0000010 01 05 00 03 82 01 0f 00 30 82 01 0a 02 82 01 01\n0000020 00 ef 3d a8 c9 e3 ed e6 f3 5b 1f b3 db 89 e8 b0\n0000030 04 e8 11 9c 25 32 c9 4b d4 a3 a5 a2 fa ea 94 5a\n0000040 f3 31 ae 38 b5 bc 7d b5 56 24 d9 60 b8 e0 e3 44\n0000050 6b ba 54 82 18 5c 23 cf 09 c8 e0 03 2d 11 d2 19\n0000060 ee e3 a8 97 5d 84 df 13 99 60 d8 30 4c 16 83 34\n0000070 24 fd a7 42 18 62 e1 55 19 f4 32 c6 56 af af ba\n0000080 12 21 a6 8d 9a 54 91 cb ed 28 b3 5c 62 ec 88 88\n0000090 3c 21 c4 ff b9 df 89 f0 d0 8a a1 ad 6f a6 fa 4c\n00000a0 13 b0 3f 74 17 83 92 1d ad 78 aa 40 90 25 93 ef\n00000b0 12 d1 73 e1 6e 7c 30 cd 63 a1 96 b4 77 59 fb 6a\n00000c0 8f 29 41 3d 21 92 0c 94 28 17 47 c9 e6 1d 9c 03\n00000d0 6c 89 88 6a 93 57 7e d8 45 34 e1 3d 69 90 12 ec\n00000e0 fc 36 3c 78 6d 36 84 69 3b a5 e7 f5 0d 85 27 a5\n00000f0 b3 b9 21 77 f2 2f 1d 5f 68 37 a4 f6 a3 85 7f fd\n0000100 f0 2c ca 34 59 95 82 84 50 79 5d 6f 73 0b fd 01\n0000110 f1 5a ce fe 86 a5 92 6b d3 42 c3 05 d9 1a 11 25\n0000120 c3 02 03 01 00 01                              \n0000126\n\n\n\n\nbinary\n\u610f\u5473\n\n\n\n\n30 \u3000\u3000\u3000\nSEQUENCE\n\n\n82\n\u6b21\u306e2\u30d0\u30a4\u30c8\u304cSEQUENCE\u306e\u9577\u3055\n\n\n01 22\n0x122\u30d0\u30a4\u30c8\n\n\n30 \u3000\u3000\u3000\nSEQUENCE\n\n\n0d \u3000\u3000\u3000\nOBJECT (AlgorithmIdentifier)\n\n\n06 \u3000\u3000\u3000\nOBJECT IDENTIFIER (algorithm)\n\n\n09 \u3000\u3000\u3000\nOBJECT IDENTIFIER\u306e\u9577\u3055(9\u30d0\u30a4\u30c8)\n\n\n2a 86 48 86 f7 0d 01 01 01\nPKCS#1 rsaEncryption\n\n\n05 \u3000\u3000\u3000\nNULL (parameters)\n\n\n00 \u3000\u3000\u3000\nNULL\u306e\u9577\u3055(0\u30d0\u30a4\u30c8)\n\n\n03 \u3000\u3000\u3000\nBIT STRING\n\n\n82\n\u6b21\u306e2\u30d0\u30a4\u30c8\u304cBIT STRING\u306e\u9577\u3055\n\n\n01 0f \u3000\u3000\u3000\nBIT STRING\u306e\u9577\u3055(0x10F\u30d0\u30a4\u30c8)\n\n\n00 \u3000\u3000\u3000\n\u672a\u4f7f\u7528\u30d3\u30c3\u30c8\u306e\u9577\u3055(0\u30d3\u30c3\u30c8)\n\n\n30 82 01 0a...\nPKCS#1 \u516c\u958b\u9375\n\n\n\n\u3053\u306e\u5f62\u5f0f\u3067\u306fPKCS#1\u306e\u516c\u958b\u9375\u3067\u3042\u308b\u3068\u3044\u3046\u60c5\u5831\u304c\u5165\u3063\u3066\u3044\u308b\u3002\n\n\u8aad\u307f\u8fbc\u307f\nOpenSSL\u3067PKCS#1\u5f62\u5f0f\u306ePEM\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u306b\u306fPEM_read_RSAPublicKey\u3092\u4f7f\u7528\u3059\u308b\u3002\nPKCS#8\u5f62\u5f0f\u306ePEM\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u306b\u306fPEM_read_RSA_PUBKEY\u3092\u4f7f\u7528\u3059\u308b\u3002\n\u3053\u308c\u306b\u3088\u308aRSA\u69cb\u9020\u4f53\u304c\u5f97\u3089\u308c\u308b\u3002\n\nfingerprint\u306e\u751f\u6210\nOpenSSH\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u3001BASE64\u306e\u30c7\u30b3\u30fc\u30c9\u3092\u884c\u3046\u3060\u3051\u3067\u3088\u3044\u3002BASE64\u306e\u30c7\u30b3\u30fc\u30c9\u306fOpenSSL\u306eBIO_f_base64\u306a\u3069\u3067\u884c\u3048\u308b\u3002\nPEM\u30d5\u30a1\u30a4\u30eb\u304b\u3089Fingerprint\u3092\u751f\u6210\u3059\u308b\u306b\u306f\u3001\u516c\u958b\u9375\u3092RSA\u69cb\u9020\u4f53\u306b\u8aad\u307f\u8fbc\u3093\u3060\u3042\u3068\u3001BN_bn2bin\u3067\u6574\u6570(e\u3068n)\u3092\u30d0\u30a4\u30ca\u30ea\u306b\u66f8\u304d\u51fa\u305b\u3070\u3088\u3044\u3002\n\u6700\u7d42\u7684\u306b\u5b8c\u6210\u3057\u305f\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3053\u308c\u3002\nhttps://github.com/firewood/test/blob/master/fingerprint.cc\n\nRuby\u7248\nRuby\u3067\u3059\u3067\u306b\u540c\u3058\u3053\u3068\u3092\u3057\u3066\u3044\u308b\u65b9\u304c\u3044\u305f\u3002\nCalculating RSA Key Fingerprints in Ruby\nhttps://stelfox.net/blog/2014/04/calculating-rsa-key-fingerprints-in-ruby/\n\u3053\u308c\u3092\u3082\u3068\u306b\u3001\u4e09\u3064\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u5bfe\u5fdc\u7248\u3092\u66f8\u3044\u3066\u307f\u305f\u3002\nhttps://github.com/firewood/test/blob/master/fingerprint.rb\n\nfingerprint.rb\n#!/usr/bin/env ruby\n\nrequire 'openssl'\nrequire 'base64'\n\ndef decode_pubkey(content)\n  key = OpenSSL::PKey::RSA.new(content)\n  key && [key.public_key.e, key.public_key.n] || nil\nend\n\ndef decode_ssh_pubkey(content)\n  s = content.split(' ')\n  return nil unless s.size >= 2 && s[0] == 'ssh-rsa' && s[1].slice(0, 4) == 'AAAA'\n  bin = Base64.decode64(s[1])\n  prefix = [7].pack('N') + 'ssh-rsa'\n  return nil unless bin.slice!(0, prefix.length) == prefix\n\n  data = []\n  until bin.empty?\n    header = bin.slice!(0, 4)\n    return nil unless header.length == 4\n    bytes = header.unpack('N').first\n    number = bin.slice!(0, bytes)\n    return nil unless number.length == bytes\n    data << OpenSSL::BN.new(number, 2)\n  end\n  data.size >= 2 && data || nil\nend\n\ndef fingerprint(filename)\n  content = File.read(filename)\n  e, n = decode_ssh_pubkey(content) || decode_pubkey(content)\n  return nil unless n\n  data_string = [7].pack('N') + 'ssh-rsa' + e.to_s(0) + n.to_s(0)\n  OpenSSL::Digest::MD5.hexdigest(data_string).scan(/../).join(':')\nend\n\nputs fingerprint(ARGV[0] || 'pubkey')\n\n\n\n\u53c2\u8003\u8a18\u4e8b\n\nRSA\u516c\u958b\u9375\u304b\u3089\u7d20\u6570\u306e\u7a4d\u3092\u53d6\u308a\u51fa\u3059\u65b9\u6cd5\nhttp://d.hatena.ne.jp/hnw/20140517\nRSA \u79d8\u5bc6\u9375/\u516c\u958b\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\nhttp://bearmini.hatenablog.com/entry/2014/02/05/143510\nConverting OpenSSH public keys\nhttp://blog.oddbit.com/2011/05/08/converting-openssh-public-keys/\nHowto base64 decode with C/C++ and OpenSSL\nhttp://www.ioncannon.net/programming/122/howto-base64-decode-with-cc-and-openssl/\nA Layman's Guide to a Subset of ASN.1, BER, and DER\nhttp://luca.ntop.org/Teaching/Appunti/asn1.html\nASN.1 \u30d0\u30a4\u30ca\u30ea\u5909\u63db\u898f\u5247 (BER)\nhttp://www.geocities.co.jp/SiliconValley-SanJose/3377/asn1Body.html#BITSTRING\nASN.1 key structures in DER and PEM\nhttps://tls.mbed.org/kb/cryptography/asn1-key-structures-in-der-and-pem\n\n\n### \u6982\u8981\n\nSSH\u306e\u516c\u958b\u9375\u306b\u306ffingerprint\u304c\u8868\u793a\u3055\u308c\u308b\u304c\u3001\u4f55\u306a\u306e\u304b\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u8abf\u3079\u305f\u30022048bit\u306eRSA\u306e\u516c\u958b\u9375\u3092\u60f3\u5b9a\u3057\u3066\u3044\u308b\u3002\n\n### fingerprint\u3068\u306f\n\n\u9375\u3092\u8b58\u5225\u3059\u308b\u305f\u3081\u306e\u60c5\u5831\u3002\u3044\u308f\u3086\u308b\u96fb\u5b50\u6307\u7d0b\u3002\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u4f7f\u3046\u306e\u3067\u3001\u5024\u304c\u308f\u305a\u304b\u3067\u3082\u7570\u306a\u3063\u3066\u3044\u308b\u3068\u3001\u5168\u304f\u9055\u3046\u5024\u304c\u51fa\u529b\u3055\u308c\u308b\u3002\n\u305d\u306e\u305f\u3081\u3001\u8996\u8a8d\u6027\u304c\u3088\u304f\u3001\u9375\u306e\u5168\u3066\u306e\u60c5\u5831\u3067\u6bd4\u8f03\u3057\u306a\u304f\u3066\u3082\u3059\u3080\u3002\n\u5341\u5206\u306b\u826f\u3044\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u4f7f\u3048\u3070\u3001\u305f\u307e\u305f\u307efingerprint\u304c\u4e00\u81f4\u3059\u308b\u3053\u3068\u306f\u307e\u305a\u306a\u3044\u3002\n(\u73fe\u5728\u3067\u306fMD5\u3067\u306f\u306a\u304fSHA-2\u3092\u4f7f\u3063\u305f\u307b\u3046\u304c\u826f\u3044\u3068\u601d\u308f\u308c\u308b)\n\n### OpenSSH\u5f62\u5f0f\n\n\u516c\u958b\u9375\u306e\u30d5\u30a1\u30a4\u30eb\u5f62\u5f0f\u306b\u306f\u4f55\u7a2e\u985e\u304b\u3042\u308b\u3002SSH\u7528\u306e\u9375\u3092\u4f5c\u308b\u3068\u304d\u3001\u305f\u3044\u3066\u3044\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u4f5c\u308b\u3002\n\n```bash\n$ ssh-keygen -t rsa -b 2048\n```\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u3068\u3001ssh-rsa\u3067\u306f\u3058\u307e\u308b\u516c\u958b\u9375\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\u3053\u308c\u306f\u304a\u304a\u3080\u306dRFC4716\u306e\u5f62\u5f0f\u3068\u540c\u3058\u3060\u304c\u3001\u30d8\u30c3\u30c0\u306f\u542b\u307e\u305a\u6539\u884c\u3082\u3055\u308c\u3066\u3044\u306a\u3044\u3002OpenSSH\u72ec\u81ea\u306e\u5f62\u5f0f\u3089\u3057\u3044\u3002BASE64\u306e\u4e2d\u8eab\u306f\u540c\u3058\u306a\u306e\u3067\u3001\n\n```\n---- BEGIN SSH2 PUBLIC KEY ----\nBASE64\u3067\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305fAAAA\u3067\u306f\u3058\u307e\u308b\u90e8\u5206\u309276\u6587\u5b57\u4ee5\u5185\u306b\u6539\u884c\u3057\u305f\u3082\u306e\n---- END SSH2 PUBLIC KEY ----\n\n```\n\n\u306e\u3088\u3046\u306b\u3059\u308b\u3068RFC4716\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u306a\u308b\u3002\nBASE64\u306e\u4e2d\u8eab(\u30d0\u30a4\u30ca\u30ea\u90e8\u5206)\u306f\u3001RFC4253\u3067\u898f\u5b9a\u3055\u308c\u3066\u3044\u308b\u3002\n\u30d0\u30a4\u30ca\u30ea\u306e\u90e8\u5206\u306fbig endian\u3067\u8a18\u9332\u3055\u308c\u3066\u304a\u308a\u3001\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002(\u5148\u982d\u306e7\u6841\u306e\u6570\u5024\u306f\u30aa\u30d5\u30bb\u30c3\u30c8)\n\n```\n0000000 00 00 00 07 73 73 68 2d 72 73 61 00 00 00 03 01\n0000010 00 01 00 00 01 01 00 ef 3d a8 c9 e3 ed e6 f3 5b\n0000020 1f b3 db 89 e8 b0 04 e8 11 9c 25 32 c9 4b d4 a3\n0000030 a5 a2 fa ea 94 5a f3 31 ae 38 b5 bc 7d b5 56 24\n0000040 d9 60 b8 e0 e3 44 6b ba 54 82 18 5c 23 cf 09 c8\n0000050 e0 03 2d 11 d2 19 ee e3 a8 97 5d 84 df 13 99 60\n0000060 d8 30 4c 16 83 34 24 fd a7 42 18 62 e1 55 19 f4\n0000070 32 c6 56 af af ba 12 21 a6 8d 9a 54 91 cb ed 28\n0000080 b3 5c 62 ec 88 88 3c 21 c4 ff b9 df 89 f0 d0 8a\n0000090 a1 ad 6f a6 fa 4c 13 b0 3f 74 17 83 92 1d ad 78\n00000a0 aa 40 90 25 93 ef 12 d1 73 e1 6e 7c 30 cd 63 a1\n00000b0 96 b4 77 59 fb 6a 8f 29 41 3d 21 92 0c 94 28 17\n00000c0 47 c9 e6 1d 9c 03 6c 89 88 6a 93 57 7e d8 45 34\n00000d0 e1 3d 69 90 12 ec fc 36 3c 78 6d 36 84 69 3b a5\n00000e0 e7 f5 0d 85 27 a5 b3 b9 21 77 f2 2f 1d 5f 68 37\n00000f0 a4 f6 a3 85 7f fd f0 2c ca 34 59 95 82 84 50 79\n0000100 5d 6f 73 0b fd 01 f1 5a ce fe 86 a5 92 6b d3 42\n0000110 c3 05 d9 1a 11 25 c3                           \n```\n\n\u5148\u982d\u304b\u3089\u3001\u6b21\u306e\u3088\u3046\u306a\u610f\u5473\u3067\u3042\u308b\u3002\n\n| binary             | \u610f\u5473 |\n|:-------------------|:------------|\n| 00 00 00 07          |  \u6587\u5b57\u5217 \"ssh-rsa\"\u306e\u9577\u3055 |\n| 73 73 68 2d 72 73 61 | \"ssh-rsa\" |\n| 00 00 00 03          | \u6570\u5024\u306e\u30d0\u30a4\u30c8\u6570(3) |\n| 01 00 01             | e\u306e\u5024(0x10001) |\n| 00 00 01 01          | \u6570\u5024\u306e\u30d0\u30a4\u30c8\u6570(0x101) |\n| 00 ef 3d a8...       | n\u306e\u5024(0xEF3DA8...) |\n\n\u3053\u308c\u4ee5\u5916\u306e\u60c5\u5831\u306f\u5165\u3063\u3066\u304a\u3089\u305a\u3001\u304b\u306a\u308a\u30b7\u30f3\u30d7\u30eb\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3042\u308b\u3002\nn\u306e\u5148\u982d\u304c00\u3060\u304c\u3001\u6700\u4e0a\u4f4d\u30d3\u30c3\u30c8\u304c\u7acb\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u30bc\u30ed\u3092\u8ffd\u52a0\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u3066\u3001\u8ca0\u306e\u5024\u3068\u898b\u306a\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u308f\u308c\u308b\u3002\nfingerprint\u306f\u3001\u3053\u306e\u30d0\u30a4\u30ca\u30ea\u90e8\u5206\u306eMD5\u306e\u5024(16\u30d0\u30a4\u30c8)\u3067\u3042\u308b\u3002\n\n### PKCS#1\u5f62\u5f0f\n\nSSH\u4ee5\u5916\u306e\u7528\u9014\u3067\u516c\u958b\u9375\u3092\u3084\u308a\u3068\u308a\u3059\u308b\u3068\u304d\u306f\u3001\u30d8\u30c3\u30c0\u3064\u304d\u306ePEM\u5f62\u5f0f\u3092\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\u3068\u601d\u3046\u3002OpenSSH\u5f62\u5f0f\u304b\u3089\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u5909\u63db\u53ef\u80fd\u3067\u3042\u308b\u3002\n\n```\n$ ssh-keygen -f hoge.pub -e -m pem\n```\n\n\u203b ssh-keygen\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066\u306f\u3053\u308c\u306f\u5931\u6557\u3059\u308b\u3002\u6700\u65b0\u7248\u306eOpenSSH\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u304b\u3001\u307e\u305f\u306f\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067RFC4716\u5f62\u5f0f\u306e\u79d8\u5bc6\u9375\u304b\u3089\u51fa\u529b\u3067\u304d\u308b\u3002\n\n```\n$ openssl rsa -in hoge -RSAPublicKey_out\n```\n\n\u524d\u63b2\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u3082\u306e\u304c\u4ee5\u4e0b\u306e\u5f62\u5f0f\u306b\u306a\u308b\u3002\n\n```\n-----BEGIN RSA PUBLIC KEY-----\nMIIBCgKCAQEA7z2oyePt5vNbH7PbieiwBOgRnCUyyUvUo6Wi+uqUWvMxrji1vH21\nViTZYLjg40RrulSCGFwjzwnI4AMtEdIZ7uOol12E3xOZYNgwTBaDNCT9p0IYYuFV\nGfQyxlavr7oSIaaNmlSRy+0os1xi7IiIPCHE/7nfifDQiqGtb6b6TBOwP3QXg5Id\nrXiqQJAlk+8S0XPhbnwwzWOhlrR3WftqjylBPSGSDJQoF0fJ5h2cA2yJiGqTV37Y\nRTThPWmQEuz8Njx4bTaEaTul5/UNhSels7khd/IvHV9oN6T2o4V//fAsyjRZlYKE\nUHldb3ML/QHxWs7+hqWSa9NCwwXZGhElwwIDAQAB\n-----END RSA PUBLIC KEY-----\n```\n\n\u3053\u308c\u306fPKCS#1\u5f62\u5f0f\u3067\u3001\u4e2d\u8eab\u306fDER\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u6570\u5024(\u3044\u308f\u3086\u308bASN.1\u30d0\u30a4\u30ca\u30ea)\u3067\u3042\u308b\u3002\n\u306a\u304aDER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u3066BASE64\u306b\u304b\u3051\u305f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092PEM\u3068\u547c\u3076\u3088\u3046\u3067\u3001\u69d8\u3005\u306aPEM\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308b\u3002\n\n```\n0000000 30 82 01 0a 02 82 01 01 00 ef 3d a8 c9 e3 ed e6\n0000010 f3 5b 1f b3 db 89 e8 b0 04 e8 11 9c 25 32 c9 4b\n0000020 d4 a3 a5 a2 fa ea 94 5a f3 31 ae 38 b5 bc 7d b5\n0000030 56 24 d9 60 b8 e0 e3 44 6b ba 54 82 18 5c 23 cf\n0000040 09 c8 e0 03 2d 11 d2 19 ee e3 a8 97 5d 84 df 13\n0000050 99 60 d8 30 4c 16 83 34 24 fd a7 42 18 62 e1 55\n0000060 19 f4 32 c6 56 af af ba 12 21 a6 8d 9a 54 91 cb\n0000070 ed 28 b3 5c 62 ec 88 88 3c 21 c4 ff b9 df 89 f0\n0000080 d0 8a a1 ad 6f a6 fa 4c 13 b0 3f 74 17 83 92 1d\n0000090 ad 78 aa 40 90 25 93 ef 12 d1 73 e1 6e 7c 30 cd\n00000a0 63 a1 96 b4 77 59 fb 6a 8f 29 41 3d 21 92 0c 94\n00000b0 28 17 47 c9 e6 1d 9c 03 6c 89 88 6a 93 57 7e d8\n00000c0 45 34 e1 3d 69 90 12 ec fc 36 3c 78 6d 36 84 69\n00000d0 3b a5 e7 f5 0d 85 27 a5 b3 b9 21 77 f2 2f 1d 5f\n00000e0 68 37 a4 f6 a3 85 7f fd f0 2c ca 34 59 95 82 84\n00000f0 50 79 5d 6f 73 0b fd 01 f1 5a ce fe 86 a5 92 6b\n0000100 d3 42 c3 05 d9 1a 11 25 c3 02 03 01 00 01      \n```\n\n\u610f\u5473\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n| binary             | \u610f\u5473 |\n|:-------------------|:------------|\n| 30 \u3000\u3000\u3000         | SEQUENCE |\n| 82       | \u6b21\u306e2\u30d0\u30a4\u30c8\u304cSEQUENCE\u306e\u9577\u3055 |\n| 01 0a           | 0x10A\u30d0\u30a4\u30c8 |\n| 02              | INTEGER |\n| 82       | \u6b21\u306e2\u30d0\u30a4\u30c8\u304cINTEGER\u306e\u9577\u3055 |\n| 01 01    | n\u306e\u9577\u3055(0x101\u30d0\u30a4\u30c8) |\n| 00 ef 3d a8...   | n\u306e\u5024(0xEF3DA8...) |\n| 02              | INTEGER |\n| 03       | INTEGER\u306e\u9577\u3055(3\u30d0\u30a4\u30c8) |\n| 01 00 01      | e\u306e\u5024(0x10001) |\n\n\u3053\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u306f\u3001\u8907\u5408\u578b\u3067\u6570\u5024\u304c2\u3064\u5165\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u3057\u304b\u8a00\u3063\u3066\u3044\u306a\u3044\u3002\u3053\u308c\u3082\u6bd4\u8f03\u7684\u30b7\u30f3\u30d7\u30eb\u306a\u5f62\u5f0f\u3067\u3042\u308b\u3002\n\n### PKCS#8\u5f62\u5f0f\n\n\u5225\u306e\u5f62\u5f0f\u3082\u3042\u308b\u3002OpenSSL\u3067\n\n```\n$ openssl genrsa -out hoge.key 2048\n$ openssl rsa -pubout -in hoge.key \n```\n\n\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u751f\u6210\u3067\u304d\u308b\u3002\n\u3082\u3057\u304f\u306f\u3001ssh-keygen\u3067\u4f5c\u6210\u3057\u305f\u9375\u304b\u3089\u3001\n\n```\n$ openssl rsa -in hoge -pubout\n```\n\n\u3067\u3082\u51fa\u529b\u3067\u304d\u308b\u3002\n\n\u3053\u308c\u306fPKCS#8\u5f62\u5f0f\u306e\u516c\u958b\u9375\u3067\u3042\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5185\u5bb9\u3067\u3042\u308b\u3002\n\n```\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7z2oyePt5vNbH7Pbieiw\nBOgRnCUyyUvUo6Wi+uqUWvMxrji1vH21ViTZYLjg40RrulSCGFwjzwnI4AMtEdIZ\n7uOol12E3xOZYNgwTBaDNCT9p0IYYuFVGfQyxlavr7oSIaaNmlSRy+0os1xi7IiI\nPCHE/7nfifDQiqGtb6b6TBOwP3QXg5IdrXiqQJAlk+8S0XPhbnwwzWOhlrR3Wftq\njylBPSGSDJQoF0fJ5h2cA2yJiGqTV37YRTThPWmQEuz8Njx4bTaEaTul5/UNhSel\ns7khd/IvHV9oN6T2o4V//fAsyjRZlYKEUHldb3ML/QHxWs7+hqWSa9NCwwXZGhEl\nwwIDAQAB\n-----END PUBLIC KEY-----\n```\n\n\u30d0\u30a4\u30ca\u30ea\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n```\n0000000 30 82 01 22 30 0d 06 09 2a 86 48 86 f7 0d 01 01\n0000010 01 05 00 03 82 01 0f 00 30 82 01 0a 02 82 01 01\n0000020 00 ef 3d a8 c9 e3 ed e6 f3 5b 1f b3 db 89 e8 b0\n0000030 04 e8 11 9c 25 32 c9 4b d4 a3 a5 a2 fa ea 94 5a\n0000040 f3 31 ae 38 b5 bc 7d b5 56 24 d9 60 b8 e0 e3 44\n0000050 6b ba 54 82 18 5c 23 cf 09 c8 e0 03 2d 11 d2 19\n0000060 ee e3 a8 97 5d 84 df 13 99 60 d8 30 4c 16 83 34\n0000070 24 fd a7 42 18 62 e1 55 19 f4 32 c6 56 af af ba\n0000080 12 21 a6 8d 9a 54 91 cb ed 28 b3 5c 62 ec 88 88\n0000090 3c 21 c4 ff b9 df 89 f0 d0 8a a1 ad 6f a6 fa 4c\n00000a0 13 b0 3f 74 17 83 92 1d ad 78 aa 40 90 25 93 ef\n00000b0 12 d1 73 e1 6e 7c 30 cd 63 a1 96 b4 77 59 fb 6a\n00000c0 8f 29 41 3d 21 92 0c 94 28 17 47 c9 e6 1d 9c 03\n00000d0 6c 89 88 6a 93 57 7e d8 45 34 e1 3d 69 90 12 ec\n00000e0 fc 36 3c 78 6d 36 84 69 3b a5 e7 f5 0d 85 27 a5\n00000f0 b3 b9 21 77 f2 2f 1d 5f 68 37 a4 f6 a3 85 7f fd\n0000100 f0 2c ca 34 59 95 82 84 50 79 5d 6f 73 0b fd 01\n0000110 f1 5a ce fe 86 a5 92 6b d3 42 c3 05 d9 1a 11 25\n0000120 c3 02 03 01 00 01                              \n0000126\n```\n\n| binary             | \u610f\u5473 |\n|:-------------------|:------------|\n| 30 \u3000\u3000\u3000         | SEQUENCE |\n| 82       | \u6b21\u306e2\u30d0\u30a4\u30c8\u304cSEQUENCE\u306e\u9577\u3055 |\n| 01 22           | 0x122\u30d0\u30a4\u30c8 |\n| 30 \u3000\u3000\u3000         | SEQUENCE |\n| 0d \u3000\u3000\u3000         | OBJECT (AlgorithmIdentifier) |\n| 06 \u3000\u3000\u3000         | OBJECT IDENTIFIER (algorithm) |\n| 09 \u3000\u3000\u3000         | OBJECT IDENTIFIER\u306e\u9577\u3055(9\u30d0\u30a4\u30c8) |\n| 2a 86 48 86 f7 0d 01 01 01 | PKCS#1 rsaEncryption |\n| 05 \u3000\u3000\u3000         | NULL (parameters) |\n| 00 \u3000\u3000\u3000         | NULL\u306e\u9577\u3055(0\u30d0\u30a4\u30c8) |\n| 03 \u3000\u3000\u3000         | BIT STRING  |\n| 82       | \u6b21\u306e2\u30d0\u30a4\u30c8\u304cBIT STRING\u306e\u9577\u3055 |\n| 01 0f \u3000\u3000\u3000      | BIT STRING\u306e\u9577\u3055(0x10F\u30d0\u30a4\u30c8) |\n| 00 \u3000\u3000\u3000         | \u672a\u4f7f\u7528\u30d3\u30c3\u30c8\u306e\u9577\u3055(0\u30d3\u30c3\u30c8) |\n| 30 82 01 0a... | PKCS#1 \u516c\u958b\u9375 |\n\n\u3053\u306e\u5f62\u5f0f\u3067\u306fPKCS#1\u306e\u516c\u958b\u9375\u3067\u3042\u308b\u3068\u3044\u3046\u60c5\u5831\u304c\u5165\u3063\u3066\u3044\u308b\u3002\n\n### \u8aad\u307f\u8fbc\u307f\n\nOpenSSL\u3067PKCS#1\u5f62\u5f0f\u306ePEM\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u306b\u306fPEM_read_RSAPublicKey\u3092\u4f7f\u7528\u3059\u308b\u3002\nPKCS#8\u5f62\u5f0f\u306ePEM\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u306b\u306fPEM_read_RSA_PUBKEY\u3092\u4f7f\u7528\u3059\u308b\u3002\n\u3053\u308c\u306b\u3088\u308aRSA\u69cb\u9020\u4f53\u304c\u5f97\u3089\u308c\u308b\u3002\n\n### fingerprint\u306e\u751f\u6210\n\nOpenSSH\u5f62\u5f0f\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5834\u5408\u3001BASE64\u306e\u30c7\u30b3\u30fc\u30c9\u3092\u884c\u3046\u3060\u3051\u3067\u3088\u3044\u3002BASE64\u306e\u30c7\u30b3\u30fc\u30c9\u306fOpenSSL\u306eBIO_f_base64\u306a\u3069\u3067\u884c\u3048\u308b\u3002\nPEM\u30d5\u30a1\u30a4\u30eb\u304b\u3089Fingerprint\u3092\u751f\u6210\u3059\u308b\u306b\u306f\u3001\u516c\u958b\u9375\u3092RSA\u69cb\u9020\u4f53\u306b\u8aad\u307f\u8fbc\u3093\u3060\u3042\u3068\u3001BN_bn2bin\u3067\u6574\u6570(e\u3068n)\u3092\u30d0\u30a4\u30ca\u30ea\u306b\u66f8\u304d\u51fa\u305b\u3070\u3088\u3044\u3002\n\n\u6700\u7d42\u7684\u306b\u5b8c\u6210\u3057\u305f\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u3053\u308c\u3002\nhttps://github.com/firewood/test/blob/master/fingerprint.cc\n\n### Ruby\u7248\n\nRuby\u3067\u3059\u3067\u306b\u540c\u3058\u3053\u3068\u3092\u3057\u3066\u3044\u308b\u65b9\u304c\u3044\u305f\u3002\n\nCalculating RSA Key Fingerprints in Ruby\nhttps://stelfox.net/blog/2014/04/calculating-rsa-key-fingerprints-in-ruby/\n\n\u3053\u308c\u3092\u3082\u3068\u306b\u3001\u4e09\u3064\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u5bfe\u5fdc\u7248\u3092\u66f8\u3044\u3066\u307f\u305f\u3002\nhttps://github.com/firewood/test/blob/master/fingerprint.rb\n\n```ruby:fingerprint.rb\n#!/usr/bin/env ruby\n\nrequire 'openssl'\nrequire 'base64'\n\ndef decode_pubkey(content)\n  key = OpenSSL::PKey::RSA.new(content)\n  key && [key.public_key.e, key.public_key.n] || nil\nend\n\ndef decode_ssh_pubkey(content)\n  s = content.split(' ')\n  return nil unless s.size >= 2 && s[0] == 'ssh-rsa' && s[1].slice(0, 4) == 'AAAA'\n  bin = Base64.decode64(s[1])\n  prefix = [7].pack('N') + 'ssh-rsa'\n  return nil unless bin.slice!(0, prefix.length) == prefix\n\n  data = []\n  until bin.empty?\n    header = bin.slice!(0, 4)\n    return nil unless header.length == 4\n    bytes = header.unpack('N').first\n    number = bin.slice!(0, bytes)\n    return nil unless number.length == bytes\n    data << OpenSSL::BN.new(number, 2)\n  end\n  data.size >= 2 && data || nil\nend\n\ndef fingerprint(filename)\n  content = File.read(filename)\n  e, n = decode_ssh_pubkey(content) || decode_pubkey(content)\n  return nil unless n\n  data_string = [7].pack('N') + 'ssh-rsa' + e.to_s(0) + n.to_s(0)\n  OpenSSL::Digest::MD5.hexdigest(data_string).scan(/../).join(':')\nend\n\nputs fingerprint(ARGV[0] || 'pubkey')\n```\n\n### \u53c2\u8003\u8a18\u4e8b\n\n* RSA\u516c\u958b\u9375\u304b\u3089\u7d20\u6570\u306e\u7a4d\u3092\u53d6\u308a\u51fa\u3059\u65b9\u6cd5\nhttp://d.hatena.ne.jp/hnw/20140517\n\n* RSA \u79d8\u5bc6\u9375/\u516c\u958b\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\nhttp://bearmini.hatenablog.com/entry/2014/02/05/143510\n\n* Converting OpenSSH public keys\nhttp://blog.oddbit.com/2011/05/08/converting-openssh-public-keys/\n\n* Howto base64 decode with C/C++ and OpenSSL\nhttp://www.ioncannon.net/programming/122/howto-base64-decode-with-cc-and-openssl/\n\n* A Layman's Guide to a Subset of ASN.1, BER, and DER\nhttp://luca.ntop.org/Teaching/Appunti/asn1.html\n\n* ASN.1 \u30d0\u30a4\u30ca\u30ea\u5909\u63db\u898f\u5247 (BER)\nhttp://www.geocities.co.jp/SiliconValley-SanJose/3377/asn1Body.html#BITSTRING\n\n* ASN.1 key structures in DER and PEM\nhttps://tls.mbed.org/kb/cryptography/asn1-key-structures-in-der-and-pem\n", "tags": ["\u516c\u958b\u9375", "RSA"]}