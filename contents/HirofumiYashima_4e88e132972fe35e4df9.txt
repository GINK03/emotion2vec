{"tags": ["R", "\u6642\u7cfb\u5217\u89e3\u6790", "\u7d71\u8a08\u5b66", "statistics", "\u30c7\u30fc\u30bf\u5206\u6790"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u524d\u56de\u306e\u8a18\u4e8b\u306b\u5f15\u304d\u7d9a\u304d\u3001TAR \uff08\u95be\u5024\uff09 \u30e2\u30c7\u30eb \u306e\u6982\u8981\u3068R\u3067\u306e\u5206\u6790\u30b3\u30fc\u30c9\u3092\u7d39\u4ecb\u3057\u3066\u3044\u304d\u307e\u3059\n\uff08\u524d\u56de\u306e\u8a18\u4e8b\uff09\u300e\u3010R\u8a00\u8a9e \u5fdc\u7528\u6642\u7cfb\u5217\u89e3\u6790\u3011\u30d1\u30c3\u30b1\u30fc\u30b8 {tsDyn} \u3067\u3001\u30c7\u30fc\u30bf\u671f\u9593\u4e2d\u306e\u30e2\u30c7\u30eb\u69cb\u9020 \u5909\u5316\u70b9\u3092\u62bd\u51fa\u3000\uff5e\u300cTAR\u30e2\u30c7\u30eb\uff08\u95be\u5024\u30e2\u30c7\u30eb\uff09\u300d\u300f\n\n\u4ee5\u4e0b\u3001\u524d\u56de\u306e\u8a18\u4e8b\u3068\u5171\u901a\u3059\u308b\u7b87\u6240\u3092\u518d\u63b2\u3057\u307e\u3059\n\n\nTAR\uff08\u95be\u5024\uff09\u30e2\u30c7\u30eb\u3068\u306f\n\n\u3053\u308c\u307e\u3067 Qiita \u306b\u6295\u7a3f\u3057\u305f\u8a18\u4e8b\u306e\u4e2d\u3067\u3001\u8003\u5bdf\u3059\u308b\u30c7\u30fc\u30bf\u671f\u9593\u4e2d\u306b\u3001\u6642\u7cfb\u5217\u5909\u6570\u9593\u306e\u30e2\u30c7\u30eb\u69cb\u9020\u304c\u5909\u5316\u3057\u3066\u3057\u307e\u3046\uff08\u306a\u3044\u3057\u306f\u3001\u5909\u5316\u3059\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\uff09\u5834\u5408\u306b\u3001\u6709\u52b9\u306a\u6642\u7cfb\u5217\u89e3\u6790\u624b\u6cd5\u3092\u7d39\u4ecb\u3057\u3066\u304d\u307e\u3057\u305f\u3002\n\uff08\u904e\u53bb\u306e\u6295\u7a3f\uff09\n\u300c\u3010R\u8a00\u8a9e\u3011\u6642\u9593\u306e\u52d5\u304d\u306b\u3042\u308f\u305b\u3066 \u5b9a\u6570\u9805 \u3084 \u56de\u5e30\u4fc2\u6570 \u304c\u52d5\u7684\u306b\u5909\u5316\u3057\u3066\u3044\u304f\u56de\u5e30\u30e2\u30c7\u30eb\u3092\u89e3\u6790\u3059\u308b\u65b9\u6cd5\uff08\u30c7\u30fc\u30bf\u306e\u89b3\u6e2c\u8aa4\u5dee\u3092\u53d6\u308a\u9664\u3044\u305f\u300c\u771f\u306e\u5024\u300d\u3092\u540c\u6642\u306b\u63a8\u5b9a\uff09\u300d\n\u300cR\u8a00\u8a9e\u3067\u30a6\u30a7\u30fc\u30d6\u30ec\u30c3\u30c8\u5909\u63db \uff5e\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u5404\u6ce2\u9577\u6210\u5206\u306e\u542b\u6709\u6fc3\u5ea6\u304c\u3001\u6642\u9593\u63a8\u79fb\u3068\u3068\u3082\u306b\u3069\u3046\u5909\u5316\u3059\u308b\u304b\u3092\u8996\u899a\u5316\u3059\u308b\u65b9\u6cd5\u300d\n\u4eca\u56de\u306f\u3001\u4ee5\u4e0b\u306e\u30e2\u30c7\u30eb \u3068 R \u3067\u306e\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\uff08\u95a2\u6570\uff09\u3092\u7d39\u4ecb\u3057\u307e\u3059\n \uff08\u5f15\u7528\u5143\uff09 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09Power point \u8cc7\u6599\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d\n\n\u95be\u5024\u30e2\u30c7\u30eb\u3068\u306f\u30e2\u30c7\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u72b6\u614b\u306b\u4f9d\u5b58\u3057\u3066\n\u5909\u5316\u3059\u308b\u30e2\u30c7\u30eb\u306e\u7dcf\u79f0\u3067\u3042\u308b\u3002\n\u72b6\u614b\u306f\u901a\u5e38\u3042\u308b\u89b3\u6e2c\u53ef\u80fd\u306a\u5909\u6570\u306b\u3088\u3063\u3066\u8868\u3055\u308c\u308b\u3002\n\u4f8b\u3048\u3070\u3042\u308b\u89b3\u6e2c\u53ef\u80fd\u306a\u5909\u6570\u3092 st \u3068\u3059\u308b\u3068\u3001\u3042\u308b\u5024 a \u306b\u5bfe\n\u3057\u3066\u3001 st < a \u306a\u3089\u72b6\u614b 1\u3001 st \u2265 a \u306a\u3089\u72b6\u614b 2\u306e\u3088\u3046\u306b\u72b6\u614b\n\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n\u3053\u306e\u3088\u3046\u306a\u5909\u6570 st \u3092\u72b6\u614b\u5909\u6570\u3068\u3088\u3076\u3002\u72b6\u614b\u5909\u6570\u3092\u3069\u306e\u3088\n\u3046\u306b\u9078\u3076\u304b\u306f\u5206\u6790\u306e\u76ee\u7684\u306b\u4f9d\u5b58\u3059\u308b\u3002\n\n \u4ee5\u4e0b\u3001\u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09Power point \u8cc7\u6599\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d\u3088\u308a\u8ee2\u8f09\n\n\n\n\n\n\n\n\uff08\u53c2\u8003\u8cc7\u6599\uff09\n \u2460 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d\n \u2461 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u300cR \u306b\u3088\u308b\u6642\u7cfb\u5217\u5206\u6790 5\u300d1. TAR \u30e2\u30c7\u30eb\u3092\u63a8\u5b9a\u3059\u308b\n \u2462 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0 \uff082013-08-22\uff09\u300cR\u3067\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\uff1a\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\uff08\u95be\u5024\u30e2\u30c7\u30eb\u3001\u5e73\u6ed1\u63a8\u79fb\u30e2\u30c7\u30eb\u3001\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\uff09\u300d\n\n\uff08\u5229\u7528\u4e8b\u4f8b\uff09\n \u7802\u7530 \u6d0b\u5fd7\uff08\u5c71\u5f62\u5927\u5b66 \u4eba\u6587\u5b66\u90e8\uff09\u300c\u95be\u5024\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u306e\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u6307\u6570\u3078\u306e\u5fdc\u7528\u300d\uff082006\uff09 \n \u7027\u672c\u592a\u90ce\u30fb\u5742\u672c\u76f4\u6a39\u300c\u69cb\u9020\u5909\u5316\u3068\u975e\u7dda\u5f62\u6027\u3092\u8003\u616e\u3057\u305f\u30e2\u30c7\u30eb\u306b\u3088\u308b\u308f\u304c\u56fd\u306e\u6b73\u5165\u3068\u6b73\u51fa\u306e\u56e0\u679c\u6027\u5206\u6790\u300d\n \u4f50\u7af9\u5149\u5f66\u300c\u65e5\u672c\u306b\u304a\u3051\u308b\u30d5\u30a3\u30c3\u30b7\u30e3\u30fc\u4eee\u8aac\u306e\u691c\u8a3c\n\u2015 TAR \u30e2\u30c7\u30eb\u3092\u7528\u3044\u305f\u4e00\u8003\u5bdf\u2015\u300d \n\n\nR \u306b\u304a\u3051\u308b\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\n\n\u30d1\u30c3\u30b1\u30fc\u30b8 {tsDyn}\n\n\n\u975e\u7dda\u5f62\u81ea\u5df1\u56de\u5e30\uff08\u6642\u7cfb\u5217\uff09\u30e2\u30c7\u30eb\u306e\u89e3\u6790\u306b\u7279\u5316\u3057\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\u306b {tsDyn} (timeseries dynamics)\u304c\u3042\u308a\u307e\u3059\n \uff08 CRAN \u767b\u9332 \u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cb\u30e5\u30a2\u30eb \u3078\u306e\u30ea\u30f3\u30af \uff09\n  \uff08 \u4e0a\u8a18\u30de\u30cb\u30e5\u30a2\u30eb\u304b\u3089\u8cbc\u3089\u308c\u3066\u3044\u308b\u30ea\u30f3\u30af\u30da\u30fc\u30b8\uff09 \n\ntsDyn is an R package for nonlinear time series modelling.\nIn particular, some non-linear autoregressive models are implemented (NLAR):\nSETAR\nLSTAR\nSTAR\nNNET\nAAR\nThere are also some tests for nonlinearity and independence. A short guide is bundled, once installed type\nvignette('tsDyn')\n\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001\u8907\u6570\u306e\u975e\u7dda\u5f62\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u3092\u6271\u3046\u305f\u3081\u306e\u95a2\u6570\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n\u81ea\u5df1\u52b1\u8d77\uff08 Self-Exciting Threshold AutoRegressive \uff09 (SETAR)\u30e2\u30c7\u30eb\n\n\n \uff08 Wikipedia \uff09 \n\n\n\u5e73\u6ed1\u63a8\u79fb\uff08 ST \uff09\u81ea\u5df1\u56de\u5e30 \uff08 AR \uff09\u30e2\u30c7\u30eb\u3000(smooth-transition model)\n\n\n \uff08 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30af \uff09 \n\n\n\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\uff08 L \uff09 \u5e73\u6ed1\u63a8\u79fb\uff08 ST \uff09\u81ea\u5df1\u56de\u5e30 \uff08 AR \uff09\u30e2\u30c7\u30eb\u3000(logistic smooth-transition model)\n\n\n \uff08 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30af \uff09 \n\n\nnnet \uff08\u975e\u7dda\u5f62\u6700\u5c0f\u30cb\u4e57\u6cd5\uff09\u30e2\u30c7\u30eb\n\n\nAAR \u52a0\u6cd5\uff08Additive\uff09\u975e\u7dda\u5f62\uff08nonlinear\uff09\u81ea\u5df1\u56de\u5e30\uff08autoregressive\uff09\u30e2\u30c7\u30eb\u3000\n\n iAnalysis \uff5e\u304a\u3068\u3046\u3055\u3093\u306e\u89e3\u6790\u65e5\u8a18\uff5e\u3000\uff082010-05-14\uff09\u300c[R\u30e9\u30a4\u30d6\u30e9\u30ea\u63a2\u7d22]R\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u63a2\u7d223\uff08\u6642\u7cfb\u5217\u30e2\u30c7\u30eb\u3001\u7d4c\u6e08\uff09\n\n\n\n\u672c\u7a3f\u3067\u306f\u3053\u306e\u3046\u3061\u3001lstar \u30e2\u30c7\u30eb\u3092\u5206\u6790\u3059\u308b lstar( ) \u95a2\u6570\u3092\u4f7f\u3046\u65b9\u6cd5\u3092\u3068\u308a\u3042\u3052\u307e\u3059\u3002\n\nlstar \u30e2\u30c7\u30eb\u3068\u306f\uff1f\n\uff08\u53c2\u8003\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\uff09\u300c\u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\u300d\u304b\u3089\u3001\u5f15\u7528\u3057\u307e\u3059\n \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0 \uff082013-08-22\uff09\u300cR\u3067\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\uff1a\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\uff08\u95be\u5024\u30e2\u30c7\u30eb\u3001\u5e73\u6ed1\u63a8\u79fb\u30e2\u30c7\u30eb\u3001\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\uff09\u300d\n\n\nlstar( ) \u95a2\u6570\u306e\u4f7f\u3044\u65b9\n[\u7d44\u8fbc\u307f\u30c7\u30fc\u30bf] lynx  \uff08\u5317\u897f\u30ab\u30ca\u30c0\u306e\u30aa\u30aa\u30e4\u30de\u30cd\u30b3\u3000\u5e74\u6b21\u6355\u7372\u500b\u4f53\u6570\uff09\n[\u95a2\u6570] lstar(  )  \u95a2\u6570  \n\n\uff08\u95a2\u6570\u306e\u5f15\u6570\uff09\u3000\u30c7\u30fc\u30bf\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 , \u5404\u30ec\u30b8\u30fc\u30e0\u306e AR\u30e2\u30c7\u30eb\u6b21\u6570 , \u30ec\u30b8\u30fc\u30e0\u6570, etc\u3000\n\n\uff08\u95a2\u6570\u306e\u623b\u308a\u5024\uff09\n\n\n\u3010\u30e2\u30c7\u30eb\u69cb\u7bc9 \u53ca\u3073 \u63a8\u8a08\u306e\u624b\u9806\u3011\n\n\n\uff08\uff11\uff09\u30e2\u30c7\u30eb\u8a2d\u8a08  lstar( ) \uff1a \u3042\u3089\u304b\u3058\u3081 \u60f3\u5b9a\u3055\u308c\u308b \u5909\u5316\u306e\u6570\uff08\u533a\u5206\u6570\uff09 \u3068 \u5909\u5316\u306e\u7bc4\u56f2\uff08\u533a\u5206\u533a\u9593\uff09 \u3092\u5f15\u6570\u306b\u6e21\u3059\n\n\uff08\uff12\uff09\u30e2\u30c7\u30eb\u63a8\u8a08  summary( \u30e2\u30c7\u30eb\u540d ) \uff1a \u63a8\u8a08\u306e\u5b9f\u884c\u3068\u7d50\u679c\u306e\u53d6\u5f97\n\n\uff08\uff13\uff09\u7d50\u679c\u306e\u8996\u899a\u5316 plot(summary( )) \uff1a\u30b0\u30e9\u30d5\u51fa\u529b\n[\u95a2\u6570 \u4ed5\u69d8\uff08\u8a73\u7d30\uff09]\n\nR\n?lstar\n\n\nLSTAR {tsDyn}   R Documentation\nLogistic Smooth Transition AutoRegressive model\n\nDescription\n\nLogistic Smooth Transition AutoRegressive model.\n\nUsage\n\nlstar(x, m, d=1, steps=d, series, mL, mH, mTh, thDelay, \n          thVar, th, gamma, trace=TRUE, include = c(\"const\", \"trend\",\"none\", \"both\"), \n          control=list(), starting.control=list())\nArguments\n\nx   \ntime series\n\nm, d, steps \nembedding dimension, time delay, forecasting steps\n\nseries  \ntime series name (optional)\n\nmL  \nautoregressive order for 'low' regime (default: m). Must be <=m\n\nmH  \nautoregressive order for 'high' regime (default: m). Must be <=m\n\nthDelay \n'time delay' for the threshold variable (as multiple of embedding time delay d)\n\nmTh \ncoefficients for the lagged time series, to obtain the threshold variable\n\nthVar   \nexternal threshold variable\n\nth, gamma   \nstarting values for coefficients in the LSTAR model. If missing, a grid search is performed\n\ntrace   \nshould additional infos be printed? (logical)\n\ninclude \nType of deterministic regressors to include\n\ncontrol \nfurther arguments to be passed as control list to optim\n\nstarting.control    \nfurther arguments for the grid search (dimension, bounds). See details below.\n\nDetails\n\nx[t+steps] = ( phi1[0] + phi1[1] x[t] + phi1[2] x[t-d] + \u2026 + phi1[mL] x[t - (mL-1)d] ) G( z[t], th, gamma ) + ( phi2[0] + phi2[1] x[t] + phi2[2] x[t-d] + \u2026 + phi2[mH] x[t - (mH-1)d] ) (1 - G( z[t], th, gamma ) ) + eps[t+steps]\n\nwith z the threshold variable, and G the logistic function, computed as plogis(q, location = th, scale = 1/gamma), so see plogis documentation for details on the logistic function formulation and parameters meanings. The threshold variable can alternatively be specified by:\n\nmTh\nz[t] = x[t] mTh[1] + x[t-d] mTh[2] + \u2026 + x[t-(m-1)d] mTh[m]\nthDelay\nz[t] = x[t - thDelay*d ]\nthVar\nz[t] = thVar[t]\nNote that if starting values for phi1 and phi2 are provided, isn't necessary to specify mL and mH. Further, the user has to specify only one parameter between mTh, thDelay and thVar for indicating the threshold variable.\n\nEstimation of the transition parameters th and gamma, as well as the regression parameters phi1 and phi2, is done using concentrated least squares, as suggested in Leybourne et al. (1996).\n\nGiven th and gamma, the model is linear, so regression coefficients can be obtained as usual by OLS. So the nonlinear numerical search needs only to be done for th and gamma; the regression parameters are then recovered by OLS again from the optimal th and gamma.\n\nFor the nonlinear estimation of the parameters th and gamma, the program uses the optim function, with optimization method BFGS using the analytical gradient. For the estimation of standard values, optim is re-run using the complete Least Squares objective function, and the standard errors are obtained by inverting the hessian. You can pass further arguments to optim directly with the control list argument. For instance, the option maxit maybe useful when there are convergence issues (see examples).\n\nStarting parameters are obtained doing a simple two-dimensional grid-search over th and gamma. Parameters of the grid (interval for the values, dimension of the grid) can be passed to starting.control.\n\nnTh\nThe number of threshold values (th) in the grid. Defaults to 200\n\nnGamma\nThe number of smoothing values (gamma) in the grid. Defaults to 40\n\ntrim\nThe minimal percentage of observations in each regime. Defaults to 10% (possible threshold values are between the 0.1 and 0.9 quantile)\n\ngammaInt\nThe lower and higher smoothing values of the grid. Defaults to c(1,40)\n\nthInt\nThe lower and higher threshold values of the grid. When not specified (default, i.e NA), the interval are the trim quantiles above.\n\nValue\n\nAn object of class nlar, subclass lstar, i.e. a list with fitted model informations.\n\nAuthor(s)\n\nAntonio, Fabio Di Narzo\n\nReferences\n\nNon-linear time series models in empirical finance, Philip Hans Franses and Dick van Dijk, Cambridge: Cambridge University Press (2000).\n\nNon-Linear Time Series: A Dynamical Systems Approach, Tong, H., Oxford: Oxford University Press (1990).\n\nLeybourne, S., Newbold, P., Vougas, D. (1998) Unit roots and smooth transitions, Journal of Time Series Analysis, 19: 83-97\n\nSee Also\n\nplot.lstar for details on plots produced for this model from the plot generic.\n\nExamples\n\n#fit a LSTAR model. Note 'maxit': slow convergence\nmod.lstar <- lstar(log10(lynx), m=2, mTh=c(0,1), control=list(maxit=3000))\nmod.lstar\n\n#fit a LSTAR model without a constant in both regimes. \nmod.lstar2 <- lstar(log10(lynx), m=1,  include=\"none\")\nmod.lstar2\n\n#Note in example below that the initial grid search seems to be to narrow. \n# Extend it, and evaluate more values (slow!):\ncontrols <- list(gammaInt=c(1,2000), nGamma=50)\nmod.lstar3 <- lstar(log10(lynx), m=1,  include=\"none\", starting.control=controls)\nmod.lstar3\n\n# a few methods for lstar:\nsummary(mod.lstar)\nresiduals(mod.lstar)\nAIC(mod.lstar)\nBIC(mod.lstar)\nplot(mod.lstar)\npredict(mod.lstar, n.ahead=5)\n\n\n\n\uff08 \u4f7f\u7528\u4f8b \uff09\n\n\uff08\u4ee5\u4e0b\u3001\u53c2\u8003\u8cc7\u6599 \u2461\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3001\u8cc7\u6599 \u2462\u306e\u95a2\u6570\u4f7f\u7528\u6cd5\u3092\u8ffd\u52a0\u3057\u3066\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001{tsDyn} \u306e\u4f7f\u3044\u65b9\u3092\u78ba\u8a8d\u3057\u307e\u3059\uff09\n \uff08\u4ee5\u4e0b\u3001\u8cc7\u6599 \u2461 \u9577\u5009\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u6240\u53ce\u306e\u30b3\u30fc\u30c9\u3092\u3001\u307b\u307c\u305d\u306e\u307e\u307e\u5b9f\u884c\uff09\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u7528\u610f\n\n\nR\ninstall.packages(\"tseriesChaos\")\ninstall.packages(\"tsDyn\")\n\nrequire(tseriesChaos)\nrequire(tsDyn)\n\n\nTAR Model estimation with using function lstar()\n( Model Case.1 )\nAR(2) Model\n\nR\nls1 <- lstar(x, m=2)\n\n\nUsing maximum autoregressive order for low regime: mL = 2 \nUsing maximum autoregressive order for high regime: mH = 2 \nUsing default threshold variable: thDelay=0\nPerforming grid search for starting values...\nStarting values fixed: gamma =  100 , th =  2.565527 ; SSE =  4.602334 \nGrid search selected lower/upper bound gamma (was:  1 100 ]). \n                      Might try to widen bound with arg: 'starting.control=list(gammaInt=c(1,200))'\nOptimization algorithm converged\nOptimized values fixed for regime 2  : gamma =  100.0001 , th =  2.567991 ; SSE =  4.601211 \n\n\nR\nsummary(ls1)\n\n\nNon linear autoregressive model\n\nLSTAR model\nCoefficients:\nLow regime:\n    const1     phi1.1     phi1.2 \n 0.4145994  1.2337266 -0.3270309 \n\nHigh regime:\n    const2     phi2.1     phi2.2 \n 0.7981470  0.3103511 -0.6352231 \n\nSmoothing parameter: gamma = 100 \n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)\n\nValue: 2.568 \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.595535 -0.132497  0.040485  0.129664  0.467416 \n\nFit:\nresiduals variance = 0.04036,  AIC = -350, MAPE = 5.94%\n\nCoefficient(s):\n         Estimate  Std. Error  t value  Pr(>|z|)    \nconst1   0.414599    0.289071   1.4342 0.1515020    \nphi1.1   1.233727    0.146647   8.4129 < 2.2e-16 ***\nphi1.2  -0.327031    0.098753  -3.3116 0.0009276 ***\nconst2   0.798147    0.346388   2.3042 0.0212115 *  \nphi2.1   0.310351    0.167130   1.8569 0.0633195 .  \nphi2.2  -0.635223    0.121885  -5.2117 1.872e-07 ***\ngamma  100.000109   77.576840   1.2890 0.1973821    \nth       2.567991    0.014846 172.9708 < 2.2e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nNon-linearity test of full-order LSTAR model against full-order AR model\n F = 8.529 ; p-value = 0.00036569 \n\nThreshold \nVariable: Z(t) = + (1) X(t) + (0) X(t-1)\n\n\nR\nplot(ls1)\n\n\n\n\n\n\n\u4ee5\u4e0b\u3001\u300c\u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\u300d\u306b\u5023\u3044\u3001plot(regime( ))\u3092\u5b9f\u884c\n\nR\nplot(regime(ls1))\n\n\n\n\nR\nprint(regime(ls1))\n\n\nTime Series:\nStart = 1821 \nEnd = 1934 \nFrequency = 1 \n  [1] NA NA  1  2  2  2  2  2  2  2  2  2  1  1  1  2  2  2  2  2  2  1  1  1  1  2\n [27]  2  2  2  2  1  2  1  1  2  2  2  2  2  2  1  1  1  2  2  2  2  2  2  1  2  1\n [53]  2  2  2  2  2  2  1  1  1  2  2  2  2  2  2  2  1  1  1  1  1  2  2  2  2  2\n [79]  1  1  2  2  2  2  2  2  2  2  1  2  2  2  2  2  2  2  2  2  1  1  1  1  2  2\n[105]  2  2  2  2  2  2  2  2  2  2\n\n\u30b0\u30e9\u30d5\u3092\u6bd4\u8f03\u3057\u3066\u307f\u308b\n\nR\n\nplot(x, col=\"blue\")\npar(new=T)\nplot(regime(ls1), col=\"red\")\n\n\n\n\n\n\u305d\u306e\u4ed6 \u95a2\u9023\u3059\u308b\u5206\u6790\u624b\u6cd5\n\u30de\u30eb\u30b3\u30d5\u30fb\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30e2\u30c7\u30eb \uff08 Markov Switching \uff09\n\u203b \u672c\u7a3f\u3067\u5f15\u7528\u3057\u3066\u304d\u305f\u300c\u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\u300d\u8a18\u4e8b\u3067\u3082\u53d6\u308a\u4e0a\u3052\u3089\u308c\u3066\u3044\u308b\u304c\u3001\u624b\u6cd5\u306e\u6982\u8981\u8aac\u660e\u306f\u4ed6\u66f8\u306b\u59d4\u306d\u3089\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u308f\u304b\u308a\u3065\u3089\u3044\n\uff08 \u4ee5\u4e0b\u304c\u5206\u304b\u308a\u3084\u3059\u3044 \uff09\n \u6c96\u672c\u7adc\u7fa9\uff082013\u5e746\u670823\u65e5\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30e2\u30c7\u30eb\u306e\u30de\u30af\u30ed\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u3078\u306e\u5fdc\u5fdc\u7528\u300d\n\n\n\n\uff08\u4ee5\u4e0b\u306f\u3001\u3088\u308a\u304b\u307f\u304f\u3060\u3044\u3060\u8aac\u660e\uff09\n \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5e83\u544a\u4ee3\u7406\u5e97\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\uff082013-12-04\uff09\u300c\u30b5\u30fc\u30e2\u30f3\u3068\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5e83\u544a\u3068\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\u300d\n\n\n\n\n\uff08 \u5229\u7528\u4e8b\u4f8b \uff09\n \u5927\u585a\u82b3\u5b8f\uff082011\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30fb\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u6642\u7a7a\u9593\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u306b\u3088\u308b\u65e5\u672c\u306e\u5730\u57df\u5225\u306e\u666f\u6c17\u5faa\u74b0\u306e\u8a08\u91cf\u5206\u6790\u300d\n\n \u5c0f\u6c60\u5149\u592a\u90ce\uff08\u5b66\u4f4d\u8ad6\u65872005\u5e74\u5ea6\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30e2\u30c7\u30eb\u3092\u7528\u3044\u305f\u30d5\u30c3\u30c8\u30b5\u30eb\u306e\u8a66\u5408\u5206\u6790\u300d\n\n### \u524d\u56de\u306e\u8a18\u4e8b\u306b\u5f15\u304d\u7d9a\u304d\u3001**TAR** **\uff08\u95be\u5024\uff09** **\u30e2\u30c7\u30eb** \u306e\u6982\u8981\u3068R\u3067\u306e\u5206\u6790\u30b3\u30fc\u30c9\u3092\u7d39\u4ecb\u3057\u3066\u3044\u304d\u307e\u3059\n\n[\uff08\u524d\u56de\u306e\u8a18\u4e8b\uff09\u300e\u3010R\u8a00\u8a9e \u5fdc\u7528\u6642\u7cfb\u5217\u89e3\u6790\u3011\u30d1\u30c3\u30b1\u30fc\u30b8 {tsDyn} \u3067\u3001\u30c7\u30fc\u30bf\u671f\u9593\u4e2d\u306e\u30e2\u30c7\u30eb\u69cb\u9020 \u5909\u5316\u70b9\u3092\u62bd\u51fa\u3000\uff5e\u300cTAR\u30e2\u30c7\u30eb\uff08\u95be\u5024\u30e2\u30c7\u30eb\uff09\u300d\u300f](http://qiita.com/HirofumiYashima/items/504154593aecbe288c7f)\n\n\n### \u4ee5\u4e0b\u3001\u524d\u56de\u306e\u8a18\u4e8b\u3068\u5171\u901a\u3059\u308b\u7b87\u6240\u3092\u518d\u63b2\u3057\u307e\u3059\n-----------------------------------------------------------------------------------------------------------\n\n\n\n###**TAR\uff08\u95be\u5024\uff09\u30e2\u30c7\u30eb\u3068\u306f**\n\n\u3053\u308c\u307e\u3067 _**Qiita**_ \u306b\u6295\u7a3f\u3057\u305f\u8a18\u4e8b\u306e\u4e2d\u3067\u3001\u8003\u5bdf\u3059\u308b\u30c7\u30fc\u30bf\u671f\u9593\u4e2d\u306b\u3001\u6642\u7cfb\u5217\u5909\u6570\u9593\u306e\u30e2\u30c7\u30eb\u69cb\u9020\u304c\u5909\u5316\u3057\u3066\u3057\u307e\u3046\uff08\u306a\u3044\u3057\u306f\u3001\u5909\u5316\u3059\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\uff09\u5834\u5408\u306b\u3001\u6709\u52b9\u306a\u6642\u7cfb\u5217\u89e3\u6790\u624b\u6cd5\u3092\u7d39\u4ecb\u3057\u3066\u304d\u307e\u3057\u305f\u3002\n\n**\uff08\u904e\u53bb\u306e\u6295\u7a3f\uff09**\n\n[\u300c\u3010R\u8a00\u8a9e\u3011\u6642\u9593\u306e\u52d5\u304d\u306b\u3042\u308f\u305b\u3066 \u5b9a\u6570\u9805 \u3084 \u56de\u5e30\u4fc2\u6570 \u304c\u52d5\u7684\u306b\u5909\u5316\u3057\u3066\u3044\u304f\u56de\u5e30\u30e2\u30c7\u30eb\u3092\u89e3\u6790\u3059\u308b\u65b9\u6cd5\uff08\u30c7\u30fc\u30bf\u306e\u89b3\u6e2c\u8aa4\u5dee\u3092\u53d6\u308a\u9664\u3044\u305f\u300c\u771f\u306e\u5024\u300d\u3092\u540c\u6642\u306b\u63a8\u5b9a\uff09\u300d](http://qiita.com/HirofumiYashima/items/873c8930a30b6669be20)\n\n[\u300cR\u8a00\u8a9e\u3067\u30a6\u30a7\u30fc\u30d6\u30ec\u30c3\u30c8\u5909\u63db \uff5e\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u5404\u6ce2\u9577\u6210\u5206\u306e\u542b\u6709\u6fc3\u5ea6\u304c\u3001\u6642\u9593\u63a8\u79fb\u3068\u3068\u3082\u306b\u3069\u3046\u5909\u5316\u3059\u308b\u304b\u3092\u8996\u899a\u5316\u3059\u308b\u65b9\u6cd5\u300d](http://qiita.com/HirofumiYashima/items/0d1cbde1c0bd0d60203b)\n\n**\u4eca\u56de\u306f\u3001\u4ee5\u4e0b\u306e\u30e2\u30c7\u30eb** \u3068 _**R**_ \u3067\u306e\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\uff08\u95a2\u6570\uff09\u3092\u7d39\u4ecb\u3057\u307e\u3059\n\n[ \uff08\u5f15\u7528\u5143\uff09 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09_Power point \u8cc7\u6599_\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d]\n(http://web.keio.jp/~nagakura/zemi/ts16_slide.pdf)\n> \u95be\u5024\u30e2\u30c7\u30eb\u3068\u306f\u30e2\u30c7\u30eb\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u304c\u72b6\u614b\u306b\u4f9d\u5b58\u3057\u3066\n\u5909\u5316\u3059\u308b\u30e2\u30c7\u30eb\u306e\u7dcf\u79f0\u3067\u3042\u308b\u3002\n>\u72b6\u614b\u306f\u901a\u5e38\u3042\u308b\u89b3\u6e2c\u53ef\u80fd\u306a\u5909\u6570\u306b\u3088\u3063\u3066\u8868\u3055\u308c\u308b\u3002\n>\n>\u4f8b\u3048\u3070\u3042\u308b\u89b3\u6e2c\u53ef\u80fd\u306a\u5909\u6570\u3092 st \u3068\u3059\u308b\u3068\u3001\u3042\u308b\u5024 a \u306b\u5bfe\n\u3057\u3066\u3001 st < a \u306a\u3089\u72b6\u614b 1\u3001 st \u2265 a \u306a\u3089\u72b6\u614b 2\u306e\u3088\u3046\u306b\u72b6\u614b\n\u3092\u5b9a\u7fa9\u3059\u308b\u3002\n>\n>\u3053\u306e\u3088\u3046\u306a\u5909\u6570 st \u3092\u72b6\u614b\u5909\u6570\u3068\u3088\u3076\u3002\u72b6\u614b\u5909\u6570\u3092\u3069\u306e\u3088\n\u3046\u306b\u9078\u3076\u304b\u306f\u5206\u6790\u306e\u76ee\u7684\u306b\u4f9d\u5b58\u3059\u308b\u3002\n\n[ \u4ee5\u4e0b\u3001\u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09_Power point \u8cc7\u6599_\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d\u3088\u308a\u8ee2\u8f09]\n(http://web.keio.jp/~nagakura/zemi/ts16_slide.pdf)\n![nagakura.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/4b4ca5a5-69d9-629f-fed1-b256c3500be7.png)\n\n![nagakura.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/81f8453d-a7c2-1bd8-b9e0-574a610eeb1d.png)\n\n![nagakura.3.png](https://qiita-image-store.s3.amazonaws.com/0/43487/8477b48c-7f71-076b-aa7d-e4205e7636ea.png)\n\n![nagakura.4.png](https://qiita-image-store.s3.amazonaws.com/0/43487/2e7ad14d-74ba-d5d8-e009-5553ac091c04.png)\n\n![nagakura.5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/430ca691-0ce0-c85b-3ac0-e3705930c166.png)\n\n![nagakura.6.png](https://qiita-image-store.s3.amazonaws.com/0/43487/39544847-eae9-2fd4-4dc7-669cbfaad58e.png)\n\n\n##### \uff08\u53c2\u8003\u8cc7\u6599\uff09\n[ \u2460 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u300c\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\u300d](http://web.keio.jp/~nagakura/zemi/ts16_slide.pdf)\n\n[ \u2461 \u9577\u5009 \u5927\u8f14\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u300cR \u306b\u3088\u308b\u6642\u7cfb\u5217\u5206\u6790 5\u300d1. TAR \u30e2\u30c7\u30eb\u3092\u63a8\u5b9a\u3059\u308b](http://web.keio.jp/~nagakura/R/ts_R5_2013.pdf)\n\n[ \u2462 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0 \uff082013-08-22\uff09\u300cR\u3067\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\uff1a\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\uff08\u95be\u5024\u30e2\u30c7\u30eb\u3001\u5e73\u6ed1\u63a8\u79fb\u30e2\u30c7\u30eb\u3001\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\uff09\u300d](http://tjo.hatenablog.com/entry/2013/08/22/204451)\n\n\n\n##### \uff08\u5229\u7528\u4e8b\u4f8b\uff09\n[ \u7802\u7530 \u6d0b\u5fd7\uff08\u5c71\u5f62\u5927\u5b66 \u4eba\u6587\u5b66\u90e8\uff09\u300c\u95be\u5024\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u306e\u65e5\u7d4c\u5e73\u5747\u682a\u4fa1\u6307\u6570\u3078\u306e\u5fdc\u7528\u300d\uff082006\uff09 ](http://www.ose.or.jp/f/general_cms_pages/15567/wysiwyg/rerk0608.pdf)\n\n\n[ \u7027\u672c\u592a\u90ce\u30fb\u5742\u672c\u76f4\u6a39\u300c\u69cb\u9020\u5909\u5316\u3068\u975e\u7dda\u5f62\u6027\u3092\u8003\u616e\u3057\u305f\u30e2\u30c7\u30eb\u306b\u3088\u308b\u308f\u304c\u56fd\u306e\u6b73\u5165\u3068\u6b73\u51fa\u306e\u56e0\u679c\u6027\u5206\u6790\u300d](http://catalog.lib.kyushu-u.ac.jp/handle/2324/20497/p111.pdf)\n\n\n[ \u4f50\u7af9\u5149\u5f66\u300c\u65e5\u672c\u306b\u304a\u3051\u308b\u30d5\u30a3\u30c3\u30b7\u30e3\u30fc\u4eee\u8aac\u306e\u691c\u8a3c\n\u2015 TAR \u30e2\u30c7\u30eb\u3092\u7528\u3044\u305f\u4e00\u8003\u5bdf\u2015\u300d ](http://doors.doshisha.ac.jp/webopac/bdyview.do?bodyid=BD00005562&elmid=Body&lfname=034057030008.pdf)\n\n-----------------------------------------------------------------------------------\n# _**R**_ \u306b\u304a\u3051\u308b\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\n## \u30d1\u30c3\u30b1\u30fc\u30b8 _**{tsDyn}**_\n##### **\u975e\u7dda\u5f62\u81ea\u5df1\u56de\u5e30\uff08\u6642\u7cfb\u5217\uff09\u30e2\u30c7\u30eb**\u306e\u89e3\u6790\u306b\u7279\u5316\u3057\u305f\u30d1\u30c3\u30b1\u30fc\u30b8\u306b _**{tsDyn}**_ (timeseries dynamics)\u304c\u3042\u308a\u307e\u3059 \n\n[ \uff08 _CRAN_ \u767b\u9332 \u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cb\u30e5\u30a2\u30eb \u3078\u306e\u30ea\u30f3\u30af \uff09](http://cran.r-project.org/web/packages/tsDyn/tsDyn.pdf)\n\n[  \uff08 \u4e0a\u8a18\u30de\u30cb\u30e5\u30a2\u30eb\u304b\u3089\u8cbc\u3089\u308c\u3066\u3044\u308b\u30ea\u30f3\u30af\u30da\u30fc\u30b8\uff09 ](https://code.google.com/p/tsdyn/)\n>tsDyn is an R package for nonlinear time series modelling.\n>\n>**In particular, some non-linear autoregressive models are implemented (NLAR):**\n>\n>SETAR\nLSTAR\nSTAR\nNNET\nAAR\n>\n>There are also some tests for nonlinearity and independence. A short guide is bundled, once installed type\n> vignette('tsDyn')\n\n#### \u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001\u8907\u6570\u306e\u975e\u7dda\u5f62\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u3092\u6271\u3046\u305f\u3081\u306e\u95a2\u6570\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n-------------------------------------------------------------------------------------\n###### **\u81ea\u5df1\u52b1\u8d77\uff08**  _**Self-Exciting Threshold AutoRegressive**_ **\uff09** **(SETAR)\u30e2\u30c7\u30eb** \n###### [ \uff08 _Wikipedia_ \uff09 ](http://en.wikipedia.org/wiki/SETAR_(model))\n\n###### **\u5e73\u6ed1\u63a8\u79fb\uff08 _ST_ \uff09\u81ea\u5df1\u56de\u5e30 \uff08 _AR_ \uff09\u30e2\u30c7\u30eb\u3000(smooth-transition model)**\n###### [ \uff08 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30af \uff09 ](http://tjo.hatenablog.com/entry/2013/08/22/204451)\n\n###### **\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\uff08 _L_ \uff09 \u5e73\u6ed1\u63a8\u79fb\uff08 _ST_ \uff09\u81ea\u5df1\u56de\u5e30 \uff08 _AR_ \uff09\u30e2\u30c7\u30eb\u3000(logistic smooth-transition model)**\n###### [ \uff08 \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30af \uff09 ](http://tjo.hatenablog.com/entry/2013/08/22/204451)\n\n###### _**nnet**_ **\uff08\u975e\u7dda\u5f62\u6700\u5c0f\u30cb\u4e57\u6cd5\uff09\u30e2\u30c7\u30eb**\n\n###### _**AAR**_ **\u52a0\u6cd5\uff08Additive\uff09\u975e\u7dda\u5f62\uff08nonlinear\uff09\u81ea\u5df1\u56de\u5e30\uff08autoregressive\uff09\u30e2\u30c7\u30eb**\u3000\n###### [ iAnalysis \uff5e\u304a\u3068\u3046\u3055\u3093\u306e\u89e3\u6790\u65e5\u8a18\uff5e\u3000\uff082010-05-14\uff09\u300c[R\u30e9\u30a4\u30d6\u30e9\u30ea\u63a2\u7d22]R\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u63a2\u7d223\uff08\u6642\u7cfb\u5217\u30e2\u30c7\u30eb\u3001\u7d4c\u6e08\uff09](http://d.hatena.ne.jp/isseing333/20100514/1273829174)\n-------------------------------------------------------------------------------------\n\n#### \u672c\u7a3f\u3067\u306f\u3053\u306e\u3046\u3061\u3001_**lstar**_ \u30e2\u30c7\u30eb\u3092\u5206\u6790\u3059\u308b _**lstar( )**_ \u95a2\u6570\u3092\u4f7f\u3046\u65b9\u6cd5\u3092\u3068\u308a\u3042\u3052\u307e\u3059\u3002\n\n# _**lstar**_ \u30e2\u30c7\u30eb\u3068\u306f\uff1f\n\uff08\u53c2\u8003\u30a6\u30a7\u30d6\u30b5\u30a4\u30c8\uff09\u300c\u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\u300d\u304b\u3089\u3001\u5f15\u7528\u3057\u307e\u3059\n[ \u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0 \uff082013-08-22\uff09\u300cR\u3067\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\uff1a\u72b6\u614b\u5909\u5316\u3092\u4f34\u3046\u30e2\u30c7\u30eb\uff08\u95be\u5024\u30e2\u30c7\u30eb\u3001\u5e73\u6ed1\u63a8\u79fb\u30e2\u30c7\u30eb\u3001\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\uff09\u300d](http://tjo.hatenablog.com/entry/2013/08/22/204451)\n\n![ginza.png](https://qiita-image-store.s3.amazonaws.com/0/43487/985cd892-1417-1d7d-179e-c9a3a79895d3.png)\n\n\n#  _**lstar( )**_ \u95a2\u6570\u306e\u4f7f\u3044\u65b9 \n**[\u7d44\u8fbc\u307f\u30c7\u30fc\u30bf]** _**lynx**_  \uff08\u5317\u897f\u30ab\u30ca\u30c0\u306e\u30aa\u30aa\u30e4\u30de\u30cd\u30b3\u3000\u5e74\u6b21\u6355\u7372\u500b\u4f53\u6570\uff09\n\n**[\u95a2\u6570]**  _**lstar(  )**_  \u95a2\u6570  \n\n######**\uff08\u95a2\u6570\u306e\u5f15\u6570\uff09**\u3000\u30c7\u30fc\u30bf\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 , \u5404\u30ec\u30b8\u30fc\u30e0\u306e **AR\u30e2\u30c7\u30eb\u6b21\u6570** , \u30ec\u30b8\u30fc\u30e0\u6570, etc\u3000\n\n######**\uff08\u95a2\u6570\u306e\u623b\u308a\u5024\uff09**\n\n#### **\u3010\u30e2\u30c7\u30eb\u69cb\u7bc9 \u53ca\u3073 \u63a8\u8a08\u306e\u624b\u9806\u3011** \n#####\uff08\uff11\uff09\u30e2\u30c7\u30eb\u8a2d\u8a08  _**lstar( )**_ \uff1a \u3042\u3089\u304b\u3058\u3081 \u60f3\u5b9a\u3055\u308c\u308b **\u5909\u5316\u306e\u6570\uff08\u533a\u5206\u6570\uff09** \u3068 **\u5909\u5316\u306e\u7bc4\u56f2\uff08\u533a\u5206\u533a\u9593\uff09** \u3092\u5f15\u6570\u306b\u6e21\u3059\n#####\uff08\uff12\uff09\u30e2\u30c7\u30eb\u63a8\u8a08  _**summary( \u30e2\u30c7\u30eb\u540d )**_ \uff1a \u63a8\u8a08\u306e\u5b9f\u884c\u3068\u7d50\u679c\u306e\u53d6\u5f97\n#####\uff08\uff13\uff09\u7d50\u679c\u306e\u8996\u899a\u5316 _**plot(summary( ))**_ \uff1a\u30b0\u30e9\u30d5\u51fa\u529b\n\n\n**[\u95a2\u6570 \u4ed5\u69d8\uff08\u8a73\u7d30\uff09]**\n\n```{r:R}\n?lstar\n```\n\n```\nLSTAR {tsDyn}\tR Documentation\nLogistic Smooth Transition AutoRegressive model\n\nDescription\n\nLogistic Smooth Transition AutoRegressive model.\n\nUsage\n\nlstar(x, m, d=1, steps=d, series, mL, mH, mTh, thDelay, \n          thVar, th, gamma, trace=TRUE, include = c(\"const\", \"trend\",\"none\", \"both\"), \n          control=list(), starting.control=list())\nArguments\n\nx\t\ntime series\n\nm, d, steps\t\nembedding dimension, time delay, forecasting steps\n\nseries\t\ntime series name (optional)\n\nmL\t\nautoregressive order for 'low' regime (default: m). Must be <=m\n\nmH\t\nautoregressive order for 'high' regime (default: m). Must be <=m\n\nthDelay\t\n'time delay' for the threshold variable (as multiple of embedding time delay d)\n\nmTh\t\ncoefficients for the lagged time series, to obtain the threshold variable\n\nthVar\t\nexternal threshold variable\n\nth, gamma\t\nstarting values for coefficients in the LSTAR model. If missing, a grid search is performed\n\ntrace\t\nshould additional infos be printed? (logical)\n\ninclude\t\nType of deterministic regressors to include\n\ncontrol\t\nfurther arguments to be passed as control list to optim\n\nstarting.control\t\nfurther arguments for the grid search (dimension, bounds). See details below.\n\nDetails\n\nx[t+steps] = ( phi1[0] + phi1[1] x[t] + phi1[2] x[t-d] + \u2026 + phi1[mL] x[t - (mL-1)d] ) G( z[t], th, gamma ) + ( phi2[0] + phi2[1] x[t] + phi2[2] x[t-d] + \u2026 + phi2[mH] x[t - (mH-1)d] ) (1 - G( z[t], th, gamma ) ) + eps[t+steps]\n\nwith z the threshold variable, and G the logistic function, computed as plogis(q, location = th, scale = 1/gamma), so see plogis documentation for details on the logistic function formulation and parameters meanings. The threshold variable can alternatively be specified by:\n\nmTh\nz[t] = x[t] mTh[1] + x[t-d] mTh[2] + \u2026 + x[t-(m-1)d] mTh[m]\nthDelay\nz[t] = x[t - thDelay*d ]\nthVar\nz[t] = thVar[t]\nNote that if starting values for phi1 and phi2 are provided, isn't necessary to specify mL and mH. Further, the user has to specify only one parameter between mTh, thDelay and thVar for indicating the threshold variable.\n\nEstimation of the transition parameters th and gamma, as well as the regression parameters phi1 and phi2, is done using concentrated least squares, as suggested in Leybourne et al. (1996).\n\nGiven th and gamma, the model is linear, so regression coefficients can be obtained as usual by OLS. So the nonlinear numerical search needs only to be done for th and gamma; the regression parameters are then recovered by OLS again from the optimal th and gamma.\n\nFor the nonlinear estimation of the parameters th and gamma, the program uses the optim function, with optimization method BFGS using the analytical gradient. For the estimation of standard values, optim is re-run using the complete Least Squares objective function, and the standard errors are obtained by inverting the hessian. You can pass further arguments to optim directly with the control list argument. For instance, the option maxit maybe useful when there are convergence issues (see examples).\n\nStarting parameters are obtained doing a simple two-dimensional grid-search over th and gamma. Parameters of the grid (interval for the values, dimension of the grid) can be passed to starting.control.\n\nnTh\nThe number of threshold values (th) in the grid. Defaults to 200\n\nnGamma\nThe number of smoothing values (gamma) in the grid. Defaults to 40\n\ntrim\nThe minimal percentage of observations in each regime. Defaults to 10% (possible threshold values are between the 0.1 and 0.9 quantile)\n\ngammaInt\nThe lower and higher smoothing values of the grid. Defaults to c(1,40)\n\nthInt\nThe lower and higher threshold values of the grid. When not specified (default, i.e NA), the interval are the trim quantiles above.\n\nValue\n\nAn object of class nlar, subclass lstar, i.e. a list with fitted model informations.\n\nAuthor(s)\n\nAntonio, Fabio Di Narzo\n\nReferences\n\nNon-linear time series models in empirical finance, Philip Hans Franses and Dick van Dijk, Cambridge: Cambridge University Press (2000).\n\nNon-Linear Time Series: A Dynamical Systems Approach, Tong, H., Oxford: Oxford University Press (1990).\n\nLeybourne, S., Newbold, P., Vougas, D. (1998) Unit roots and smooth transitions, Journal of Time Series Analysis, 19: 83-97\n\nSee Also\n\nplot.lstar for details on plots produced for this model from the plot generic.\n\nExamples\n\n#fit a LSTAR model. Note 'maxit': slow convergence\nmod.lstar <- lstar(log10(lynx), m=2, mTh=c(0,1), control=list(maxit=3000))\nmod.lstar\n\n#fit a LSTAR model without a constant in both regimes. \nmod.lstar2 <- lstar(log10(lynx), m=1,  include=\"none\")\nmod.lstar2\n\n#Note in example below that the initial grid search seems to be to narrow. \n# Extend it, and evaluate more values (slow!):\ncontrols <- list(gammaInt=c(1,2000), nGamma=50)\nmod.lstar3 <- lstar(log10(lynx), m=1,  include=\"none\", starting.control=controls)\nmod.lstar3\n\n# a few methods for lstar:\nsummary(mod.lstar)\nresiduals(mod.lstar)\nAIC(mod.lstar)\nBIC(mod.lstar)\nplot(mod.lstar)\npredict(mod.lstar, n.ahead=5)\n```\n\n-----------------------------------------------------------------------------------\n# \uff08 \u4f7f\u7528\u4f8b \uff09\n#### \uff08\u4ee5\u4e0b\u3001\u53c2\u8003\u8cc7\u6599 \u2461\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u3001\u8cc7\u6599 \u2462\u306e\u95a2\u6570\u4f7f\u7528\u6cd5\u3092\u8ffd\u52a0\u3057\u3066\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001_**{tsDyn}**_ \u306e\u4f7f\u3044\u65b9\u3092\u78ba\u8a8d\u3057\u307e\u3059\uff09\n\n[ \uff08\u4ee5\u4e0b\u3001\u8cc7\u6599 \u2461 \u9577\u5009\uff08\u6176\u61c9\u7fa9\u587e\u5927\u5b66\uff09\u6240\u53ce\u306e\u30b3\u30fc\u30c9\u3092\u3001\u307b\u307c\u305d\u306e\u307e\u307e\u5b9f\u884c\uff09](http://web.keio.jp/~nagakura/R/ts_R5_2013.pdf)\n\n#### **\u30d1\u30c3\u30b1\u30fc\u30b8\u7528\u610f**\n```{r:R}\ninstall.packages(\"tseriesChaos\")\ninstall.packages(\"tsDyn\")\n\nrequire(tseriesChaos)\nrequire(tsDyn)\n```\n\n\nTAR Model estimation with using function lstar()\n\n( Model Case.1 )\n\nAR(2) Model\n\n```{r:R}\nls1 <- lstar(x, m=2)\n```\n\n```\nUsing maximum autoregressive order for low regime: mL = 2 \nUsing maximum autoregressive order for high regime: mH = 2 \nUsing default threshold variable: thDelay=0\nPerforming grid search for starting values...\nStarting values fixed: gamma =  100 , th =  2.565527 ; SSE =  4.602334 \nGrid search selected lower/upper bound gamma (was:  1 100 ]). \n\t\t\t\t\t  Might try to widen bound with arg: 'starting.control=list(gammaInt=c(1,200))'\nOptimization algorithm converged\nOptimized values fixed for regime 2  : gamma =  100.0001 , th =  2.567991 ; SSE =  4.601211 \n```\n\n```{r:R}\nsummary(ls1)\n```\n\n```\nNon linear autoregressive model\n\nLSTAR model\nCoefficients:\nLow regime:\n    const1     phi1.1     phi1.2 \n 0.4145994  1.2337266 -0.3270309 \n\nHigh regime:\n    const2     phi2.1     phi2.2 \n 0.7981470  0.3103511 -0.6352231 \n\nSmoothing parameter: gamma = 100 \n\nThreshold\nVariable: Z(t) = + (1) X(t) + (0) X(t-1)\n\nValue: 2.568 \n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.595535 -0.132497  0.040485  0.129664  0.467416 \n\nFit:\nresiduals variance = 0.04036,  AIC = -350, MAPE = 5.94%\n\nCoefficient(s):\n         Estimate  Std. Error  t value  Pr(>|z|)    \nconst1   0.414599    0.289071   1.4342 0.1515020    \nphi1.1   1.233727    0.146647   8.4129 < 2.2e-16 ***\nphi1.2  -0.327031    0.098753  -3.3116 0.0009276 ***\nconst2   0.798147    0.346388   2.3042 0.0212115 *  \nphi2.1   0.310351    0.167130   1.8569 0.0633195 .  \nphi2.2  -0.635223    0.121885  -5.2117 1.872e-07 ***\ngamma  100.000109   77.576840   1.2890 0.1973821    \nth       2.567991    0.014846 172.9708 < 2.2e-16 ***\n---\nSignif. codes:  0 \u2018***\u2019 0.001 \u2018**\u2019 0.01 \u2018*\u2019 0.05 \u2018.\u2019 0.1 \u2018 \u2019 1\n\nNon-linearity test of full-order LSTAR model against full-order AR model\n F = 8.529 ; p-value = 0.00036569 \n\nThreshold \nVariable: Z(t) = + (1) X(t) + (0) X(t-1)\n```\n\n\n```{r:R}\nplot(ls1)\n```\n![graph.28.png](https://qiita-image-store.s3.amazonaws.com/0/43487/edcfa846-ef86-9060-ac2e-ec22c5d8ddea.png)\n\n![graph.29.png](https://qiita-image-store.s3.amazonaws.com/0/43487/8e4b11f4-9d83-5a30-bea0-b1a6b421ce22.png)\n\n\n![graph.30.png](https://qiita-image-store.s3.amazonaws.com/0/43487/d43cc71e-25eb-0a18-7558-05e8e67e91ba.png)\n\n![graph.31.png](https://qiita-image-store.s3.amazonaws.com/0/43487/5d322377-eda9-d18d-8f69-95739121fc5a.png)\n\n\n\n\u4ee5\u4e0b\u3001\u300c\u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\u300d\u306b\u5023\u3044\u3001plot(regime( ))\u3092\u5b9f\u884c\n\n```{r:R}\nplot(regime(ls1))\n```\n![graph.32.png](https://qiita-image-store.s3.amazonaws.com/0/43487/d5a94fd4-e2c5-49ce-4235-1bcca5079686.png)\n\n\n\n```{r:R}\nprint(regime(ls1))\n```\n\n\n```\nTime Series:\nStart = 1821 \nEnd = 1934 \nFrequency = 1 \n  [1] NA NA  1  2  2  2  2  2  2  2  2  2  1  1  1  2  2  2  2  2  2  1  1  1  1  2\n [27]  2  2  2  2  1  2  1  1  2  2  2  2  2  2  1  1  1  2  2  2  2  2  2  1  2  1\n [53]  2  2  2  2  2  2  1  1  1  2  2  2  2  2  2  2  1  1  1  1  1  2  2  2  2  2\n [79]  1  1  2  2  2  2  2  2  2  2  1  2  2  2  2  2  2  2  2  2  1  1  1  1  2  2\n[105]  2  2  2  2  2  2  2  2  2  2\n```\n\n**\u30b0\u30e9\u30d5\u3092\u6bd4\u8f03\u3057\u3066\u307f\u308b**\n\n```{r:R}\n\nplot(x, col=\"blue\")\npar(new=T)\nplot(regime(ls1), col=\"red\")\n\n```\n![2graph.png](https://qiita-image-store.s3.amazonaws.com/0/43487/1883ce43-6713-f220-2cdf-429ce786f04f.png)\n\n\n## \u305d\u306e\u4ed6 \u95a2\u9023\u3059\u308b\u5206\u6790\u624b\u6cd5\n**\u30de\u30eb\u30b3\u30d5\u30fb\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30e2\u30c7\u30eb** _**\uff08 Markov Switching \uff09**_\n\n\u203b \u672c\u7a3f\u3067\u5f15\u7528\u3057\u3066\u304d\u305f\u300c\u9280\u5ea7\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\u300d\u8a18\u4e8b\u3067\u3082\u53d6\u308a\u4e0a\u3052\u3089\u308c\u3066\u3044\u308b\u304c\u3001\u624b\u6cd5\u306e\u6982\u8981\u8aac\u660e\u306f\u4ed6\u66f8\u306b\u59d4\u306d\u3089\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u308f\u304b\u308a\u3065\u3089\u3044\n\n**\uff08 \u4ee5\u4e0b\u304c\u5206\u304b\u308a\u3084\u3059\u3044 \uff09**\n\n[ \u6c96\u672c\u7adc\u7fa9\uff082013\u5e746\u670823\u65e5\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30e2\u30c7\u30eb\u306e\u30de\u30af\u30ed\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u3078\u306e\u5fdc\u5fdc\u7528\u300d](http://stat.econ.osaka-u.ac.jp/~suryo/201306/msmodel_jea13.pdf)\n![MSmodel.png](https://qiita-image-store.s3.amazonaws.com/0/43487/6b2a3f43-bb10-0c29-5573-257e6029df92.png)\n\n![MSmodel.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/db5a0960-0aa2-1283-7827-ecf9c49116dc.png)\n\n\n-----------------------------------------------------------------------------\n**\uff08\u4ee5\u4e0b\u306f\u3001\u3088\u308a\u304b\u307f\u304f\u3060\u3044\u3060\u8aac\u660e\uff09**\n\n[ \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5e83\u544a\u4ee3\u7406\u5e97\u3067\u50cd\u304f\u30c7\u30fc\u30bf\u30b5\u30a4\u30a8\u30f3\u30c6\u30a3\u30b9\u30c8\u306e\u30d6\u30ed\u30b0\uff082013-12-04\uff09\u300c\u30b5\u30fc\u30e2\u30f3\u3068\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u5e83\u544a\u3068\u30de\u30eb\u30b3\u30d5\u8ee2\u63db\u30e2\u30c7\u30eb\u300d](http://ameblo.jp/cyberanalyst/entry-11717614381.html)\n![ameba.0.png](https://qiita-image-store.s3.amazonaws.com/0/43487/e2ec634c-900e-27b7-3942-5d3358aafaa4.png)\n\n![ameba.0.5.png](https://qiita-image-store.s3.amazonaws.com/0/43487/d3f555f1-835a-330e-de72-a98f8025a522.png)\n\n![ameba.1.png](https://qiita-image-store.s3.amazonaws.com/0/43487/fd9edfd3-7a63-5cc7-4d39-3c11574771a0.png)\n\n![ameba.2.png](https://qiita-image-store.s3.amazonaws.com/0/43487/ac594101-f8db-54fb-b69a-0a8aa04c6ae0.png)\n\n**\uff08 \u5229\u7528\u4e8b\u4f8b \uff09**\n[ \u5927\u585a\u82b3\u5b8f\uff082011\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30fb\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u6642\u7a7a\u9593\u81ea\u5df1\u56de\u5e30\u30e2\u30c7\u30eb\u306b\u3088\u308b\u65e5\u672c\u306e\u5730\u57df\u5225\u306e\u666f\u6c17\u5faa\u74b0\u306e\u8a08\u91cf\u5206\u6790\u300d\n  ](http://www.terrapub.co.jp/journals/jjssj/pdf/4002/40020089.pdf)\n\n[ \u5c0f\u6c60\u5149\u592a\u90ce\uff08\u5b66\u4f4d\u8ad6\u65872005\u5e74\u5ea6\uff09\u300c\u30de\u30eb\u30b3\u30d5\u30e2\u30c7\u30eb\u3092\u7528\u3044\u305f\u30d5\u30c3\u30c8\u30b5\u30eb\u306e\u8a66\u5408\u5206\u6790\u300d](http://www.ise.chuo-u.ac.jp/ise-labs/taguchi-lab/pdf/r01d8104023.pdf)\n"}