{"tags": ["JavaScript", "canvas", "\u51f8\u5305"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002canvas\u3067\u51f8\u5305\u3092\u63cf\u753b\u3059\u308b\u3002\n\u51f8\u5305\u3068\u306f\u3001wiki\u306b\u3082\u3042\u308b\u304c\u7c21\u5358\u306b\u3044\u3046\u3068\u8f2a\u30b4\u30e0\u3092\u304b\u3051\u305f\u3088\u3046\u306a\u72b6\u614b\u3002\n\n\n\u3084\u308b\u3053\u3068\n\n\u70b9\u3092\u6563\u308a\u3070\u3081\u308b\n\u6700\u5c0f\u306e\u51f8\u96c6\u5408\u3092\u6c42\u3081\u308b\n\u7dda\u3092\u5f15\u304f\n\n\n\u70b9\u3092\u6563\u308a\u3070\u3081\u308b\n\u307e\u305a\u306f\u30e9\u30f3\u30c0\u30e0\u3067100\u500b\u306e\u5ea7\u6a19\u3092\u3064\u304f\u308a\u3001\u5ea7\u6a19\u306e\u4f4d\u7f6e\u306b\u70b9\u3092\u63cf\u753b\u3059\u308b\u3002\n\n\u5ea7\u6a19\u3092\u3064\u304f\u3063\u3066\u63cf\u753b\n// canvas\u3092\u53d6\u5f97\nvar canvas = document.getElementById('canvas');\n// canvas\u3092\u753b\u9762\u30b5\u30a4\u30ba\u306b\u3059\u308b\ncanvas.width = document.documentElement.clientWidth;\ncanvas.height = document.documentElement.clientHeight;\n\n// context\u3092\u53d6\u5f97\nvar context = canvas.getContext('2d');\n\n// \u70b9\u3092\u5165\u308c\u308b\u914d\u5217\nvar points = [];\n\n// \u3042\u307e\u308a\u7aef\u306b\u884c\u304d\u904e\u304e\u306a\u3044\u3088\u3046\u306b\u4e71\u6570\u3092\u4f5c\u6210\nvar margin = 100;\nfor (var i = 0; i < 100; i++) {\n  points.push({\n    x: (Math.random() * (canvas.width - margin * 2) + margin) | 0,\n    y: (Math.random() * (canvas.height - margin * 2) + margin) | 0\n  });\n}\n\n// \u70b9\u3092\u63cf\u753b\ncontext.fillStyle = '#00f';\npoints.forEach(function (point) {\n  context.beginPath();\n  context.arc(point.x, point.y, 1, 0, Math.PI*2);\n  context.fill();\n});\n\n\n\u3053\u3093\u306a\u611f\u3058\u3002\n\n\n\u6700\u5c0f\u306e\u51f8\u96c6\u5408\u3092\u6c42\u3081\u308b\n\u3053\u306e\u90e8\u5206\u306e\u51e6\u7406\u306f\u3044\u308d\u3044\u308d\u3084\u308a\u65b9\u304c\u3042\u308a\u305d\u3046\u3060\u304c\u3001\u4eca\u56de\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u51f8\u96c6\u5408\u3092\u6c42\u3081\u305f\u3002\n\n100\u500b\u306e\u5ea7\u6a19\u306e\u3046\u3061\u3001Y\u5ea7\u6a19\u304c\u6700\u5c0f\u306e\u3082\u306e\u3092\u62bd\u51fa\u3059\u308b\nY\u5ea7\u6a19\u304c\u540c\u3058\u3082\u306e\u304c\u3042\u308b\u5834\u5408\u3001\u305d\u306e\u4e2d\u3067X\u5ea7\u6a19\u304c\u6700\u5c0f\u306e\u3082\u306e\u3092\u9078\u629e\u3057\u3001\u8d77\u70b9\u3068\u3059\u308b\n\u8d77\u70b9\u3092\u4e2d\u5fc3\u3068\u3057\u3001\u305d\u308c\u4ee5\u5916\u306e99\u500b\u306e\u5ea7\u6a19\u306e\u89d2\u5ea6\u3092\u8a08\u7b97\u3057\u3066\u6c42\u3081\u3089\u308c\u305f\u5024\u304c\u6700\u5c0f\u306b\u306a\u3063\u305f\u5ea7\u6a19\u3092\u6b21\u306e\u8d77\u70b9\u3068\u3059\u308b\n3\u3092\u6700\u521d\u306e\u8d77\u70b9\u306b\u305f\u3069\u308a\u7740\u304f\u307e\u3067\u7e70\u308a\u8fd4\u3059\n\ntheta\u3092\u8a08\u7b97\u3059\u308b\u95a2\u6570\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\ngetTheta\n// \u5ea7\u6a19\u540c\u58eb\u306e\u89d2\u5ea6\u3092\u8a08\u7b97\nvar getTheta = function (point1, point2) {\n  var width = point2.x - point1.x,\n      height = point2.y - point1.y,\n      radian = Math.atan(height / width),\n      theta = radian * (180 / Math.PI);\n\n  // arctan\u306e\u8fd4\u308a\u5024\u306f -90 <= \u89d2\u5ea6 <= 90 \u306a\u306e\u3067\u3001\n  // \u5ea7\u6a19\u306e\u8c61\u9650\u306b\u3088\u3063\u3066\u5024\u306e\u8abf\u6574\u3092\u884c\u3046\n  if (width >= 0 && height >= 0) {\n    theta += 0;\n  } else if ((width < 0 && height >= 0) || (width < 0 && height < 0)) {\n    theta += 180;\n  } else {\n    theta += 360;\n  }\n\n  return theta;\n};\n\n\n100\u500b\u306e\u5ea7\u6a19\u304b\u3089\u51f8\u96c6\u5408\u3092\u6c42\u3081\u308b\u95a2\u6570\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\ngetConvexPoints\nvar getConvexPoints = function (points) {\n\n  var convexPoints = [];\n\n  // \u4e00\u756a\u5c0f\u3055\u3044Y\u3092\u53d6\u5f97\n  var minY = points.reduce(function (min, point) {\n    return Math.min(min, point.y);\n  }, Infinity);\n\n  // \u4e00\u756a\u5c0f\u3055\u3044Y\u3092\u6301\u3064\u4e2d\u3067\u3001\u4e00\u756a\u5c0f\u3055\u3044X\u3092\u6301\u3064\u70b9\u3092\u53d6\u5f97\n  var C1 = points.filter(function (point) {\n    return point.y === minY;\n  }).sort(function (a, b) {\n    return a.x - b.x;\n  })[0];\n\n  convexPoints.push(C1);\n\n  var Cn = C1;\n  // \u8d77\u70b9\u304b\u3089\u6642\u8a08\u56de\u308a\u306b\u6b21\u306e\u70b9\u3092\u8d77\u70b9\u3092\u8d70\u67fb\u3057\u3066\u3044\u304f\n  while (1) {\n    var minTheta = Infinity,\n        cLength = convexPoints.length,\n        borderTheta = cLength === 1 ? 0 : (function () {\n          var current = convexPoints[cLength-1],\n              prev = convexPoints[cLength-2];\n\n          return getTheta(prev, current)\n        })(),\n        index = -1;\n\n    points.forEach(function (point, i) {\n      if (point === Cn || point == null) { return; }\n\n      var theta = getTheta(Cn, point);\n      if (minTheta >= theta && theta >= borderTheta) {\n        minTheta = theta;\n        index = i;\n      }\n    });\n\n    Cn = points[index];\n\n    if (Cn === C1) { break; }\n\n    convexPoints.push(Cn);\n\n  };\n\n  return convexPoints;\n};\n\n\n\n\u7dda\u3092\u5f15\u304f\n\u6700\u5f8c\u306b\u3001\u6c42\u3081\u305f\u51f8\u96c6\u5408\u306e\u5ea7\u6a19\u306b\u6cbf\u3063\u3066\u7dda\u3092\u5f15\u304f\u3002\n\n\u7dda\u3092\u5f15\u304f\nvar convexPoints = getConvexPoints(points);\ncontext.strokeStyle = '#000';\ncontext.beginPath();\nconvexPoints.forEach(function (point) {\n  context.lineTo(point.x, point.y);\n});\ncontext.closePath();\ncontext.stroke();\n\n\n\u3053\u3093\u306a\u611f\u3058\u3002\n\n\ndemo\nhttp://keiskimu.com/Qiita/Convex-hull/\n\ncanvas\u3067\u51f8\u5305\u3092\u63cf\u753b\u3059\u308b\u3002\n\n\u51f8\u5305\u3068\u306f\u3001[wiki](https://ja.wikipedia.org/wiki/%E5%87%B8%E5%8C%85)\u306b\u3082\u3042\u308b\u304c\u7c21\u5358\u306b\u3044\u3046\u3068\u8f2a\u30b4\u30e0\u3092\u304b\u3051\u305f\u3088\u3046\u306a\u72b6\u614b\u3002\n\n![\u51f8\u5305\u306e\u30a4\u30e1\u30fc\u30b8](https://qiita-image-store.s3.amazonaws.com/0/53664/4ddce4c3-6c6c-c2de-aafc-a5701dde0d96.png \"10pointshull1.png\")\n\n\n## \u3084\u308b\u3053\u3068\n\n1. \u70b9\u3092\u6563\u308a\u3070\u3081\u308b\n2. \u6700\u5c0f\u306e\u51f8\u96c6\u5408\u3092\u6c42\u3081\u308b\n3. \u7dda\u3092\u5f15\u304f\n\n## \u70b9\u3092\u6563\u308a\u3070\u3081\u308b\n\u307e\u305a\u306f\u30e9\u30f3\u30c0\u30e0\u3067100\u500b\u306e\u5ea7\u6a19\u3092\u3064\u304f\u308a\u3001\u5ea7\u6a19\u306e\u4f4d\u7f6e\u306b\u70b9\u3092\u63cf\u753b\u3059\u308b\u3002\n\n```javascript:\u5ea7\u6a19\u3092\u3064\u304f\u3063\u3066\u63cf\u753b\n// canvas\u3092\u53d6\u5f97\nvar canvas = document.getElementById('canvas');\n// canvas\u3092\u753b\u9762\u30b5\u30a4\u30ba\u306b\u3059\u308b\ncanvas.width = document.documentElement.clientWidth;\ncanvas.height = document.documentElement.clientHeight;\n\n// context\u3092\u53d6\u5f97\nvar context = canvas.getContext('2d');\n\n// \u70b9\u3092\u5165\u308c\u308b\u914d\u5217\nvar points = [];\n\n// \u3042\u307e\u308a\u7aef\u306b\u884c\u304d\u904e\u304e\u306a\u3044\u3088\u3046\u306b\u4e71\u6570\u3092\u4f5c\u6210\nvar margin = 100;\nfor (var i = 0; i < 100; i++) {\n  points.push({\n    x: (Math.random() * (canvas.width - margin * 2) + margin) | 0,\n    y: (Math.random() * (canvas.height - margin * 2) + margin) | 0\n  });\n}\n\n// \u70b9\u3092\u63cf\u753b\ncontext.fillStyle = '#00f';\npoints.forEach(function (point) {\n  context.beginPath();\n  context.arc(point.x, point.y, 1, 0, Math.PI*2);\n  context.fill();\n});\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3002\n![\u70b9\u3092\u63cf\u753b](https://qiita-image-store.s3.amazonaws.com/0/53664/dc905c41-9ced-bc53-b2fd-062961459e93.png \"Kobito.UiR2GD.png\")\n\n## \u6700\u5c0f\u306e\u51f8\u96c6\u5408\u3092\u6c42\u3081\u308b\n\u3053\u306e\u90e8\u5206\u306e\u51e6\u7406\u306f\u3044\u308d\u3044\u308d\u3084\u308a\u65b9\u304c\u3042\u308a\u305d\u3046\u3060\u304c\u3001\u4eca\u56de\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u51f8\u96c6\u5408\u3092\u6c42\u3081\u305f\u3002\n\n1. 100\u500b\u306e\u5ea7\u6a19\u306e\u3046\u3061\u3001Y\u5ea7\u6a19\u304c\u6700\u5c0f\u306e\u3082\u306e\u3092\u62bd\u51fa\u3059\u308b\n2. Y\u5ea7\u6a19\u304c\u540c\u3058\u3082\u306e\u304c\u3042\u308b\u5834\u5408\u3001\u305d\u306e\u4e2d\u3067X\u5ea7\u6a19\u304c\u6700\u5c0f\u306e\u3082\u306e\u3092\u9078\u629e\u3057\u3001\u8d77\u70b9\u3068\u3059\u308b\n3. \u8d77\u70b9\u3092\u4e2d\u5fc3\u3068\u3057\u3001\u305d\u308c\u4ee5\u5916\u306e99\u500b\u306e\u5ea7\u6a19\u306e\u89d2\u5ea6\u3092\u8a08\u7b97\u3057\u3066\u6c42\u3081\u3089\u308c\u305f\u5024\u304c\u6700\u5c0f\u306b\u306a\u3063\u305f\u5ea7\u6a19\u3092\u6b21\u306e\u8d77\u70b9\u3068\u3059\u308b\n4. 3\u3092\u6700\u521d\u306e\u8d77\u70b9\u306b\u305f\u3069\u308a\u7740\u304f\u307e\u3067\u7e70\u308a\u8fd4\u3059\n\ntheta\u3092\u8a08\u7b97\u3059\u308b\u95a2\u6570\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n```javascript:getTheta\n// \u5ea7\u6a19\u540c\u58eb\u306e\u89d2\u5ea6\u3092\u8a08\u7b97\nvar getTheta = function (point1, point2) {\n  var width = point2.x - point1.x,\n      height = point2.y - point1.y,\n      radian = Math.atan(height / width),\n      theta = radian * (180 / Math.PI);\n\n  // arctan\u306e\u8fd4\u308a\u5024\u306f -90 <= \u89d2\u5ea6 <= 90 \u306a\u306e\u3067\u3001\n  // \u5ea7\u6a19\u306e\u8c61\u9650\u306b\u3088\u3063\u3066\u5024\u306e\u8abf\u6574\u3092\u884c\u3046\n  if (width >= 0 && height >= 0) {\n    theta += 0;\n  } else if ((width < 0 && height >= 0) || (width < 0 && height < 0)) {\n    theta += 180;\n  } else {\n    theta += 360;\n  }\n\n  return theta;\n};\n```\n\n100\u500b\u306e\u5ea7\u6a19\u304b\u3089\u51f8\u96c6\u5408\u3092\u6c42\u3081\u308b\u95a2\u6570\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n```javascript:getConvexPoints\nvar getConvexPoints = function (points) {\n\n  var convexPoints = [];\n\n  // \u4e00\u756a\u5c0f\u3055\u3044Y\u3092\u53d6\u5f97\n  var minY = points.reduce(function (min, point) {\n    return Math.min(min, point.y);\n  }, Infinity);\n\n  // \u4e00\u756a\u5c0f\u3055\u3044Y\u3092\u6301\u3064\u4e2d\u3067\u3001\u4e00\u756a\u5c0f\u3055\u3044X\u3092\u6301\u3064\u70b9\u3092\u53d6\u5f97\n  var C1 = points.filter(function (point) {\n    return point.y === minY;\n  }).sort(function (a, b) {\n    return a.x - b.x;\n  })[0];\n\n  convexPoints.push(C1);\n\n  var Cn = C1;\n  // \u8d77\u70b9\u304b\u3089\u6642\u8a08\u56de\u308a\u306b\u6b21\u306e\u70b9\u3092\u8d77\u70b9\u3092\u8d70\u67fb\u3057\u3066\u3044\u304f\n  while (1) {\n    var minTheta = Infinity,\n        cLength = convexPoints.length,\n        borderTheta = cLength === 1 ? 0 : (function () {\n          var current = convexPoints[cLength-1],\n              prev = convexPoints[cLength-2];\n\n          return getTheta(prev, current)\n        })(),\n        index = -1;\n\n    points.forEach(function (point, i) {\n      if (point === Cn || point == null) { return; }\n\n      var theta = getTheta(Cn, point);\n      if (minTheta >= theta && theta >= borderTheta) {\n        minTheta = theta;\n        index = i;\n      }\n    });\n\n    Cn = points[index];\n\n    if (Cn === C1) { break; }\n\n    convexPoints.push(Cn);\n\n  };\n\n  return convexPoints;\n};\n```\n\n## \u7dda\u3092\u5f15\u304f\n\u6700\u5f8c\u306b\u3001\u6c42\u3081\u305f\u51f8\u96c6\u5408\u306e\u5ea7\u6a19\u306b\u6cbf\u3063\u3066\u7dda\u3092\u5f15\u304f\u3002\n\n```javascript:\u7dda\u3092\u5f15\u304f\nvar convexPoints = getConvexPoints(points);\ncontext.strokeStyle = '#000';\ncontext.beginPath();\nconvexPoints.forEach(function (point) {\n  context.lineTo(point.x, point.y);\n});\ncontext.closePath();\ncontext.stroke();\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3002\n![\u51f8\u5305\u3092\u63cf\u753b](https://qiita-image-store.s3.amazonaws.com/0/53664/4e2afc68-447c-2d61-3d2e-b694c793db08.png \"Kobito.nQWyi5.png\")\n\n## demo\n\nhttp://keiskimu.com/Qiita/Convex-hull/\n\n"}