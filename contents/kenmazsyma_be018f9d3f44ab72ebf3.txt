{"context": " More than 1 year has passed since last update.WebTest\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u3068\u3001WSGI\u30d9\u30fc\u30b9\u306eWeb\u30a2\u30d7\u30ea\u3092\u30c6\u30b9\u30c8\u3059\u308b\u30b3\u30fc\u30c9\u3092\u7c21\u5358\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\npip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\nsudo pip install webtest\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u4ee5\u4e0b\u306fbottle\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u4f7f\u3063\u305f\u3001JSON-RPC\u30b5\u30fc\u30d0\u5b9f\u88c5\u306e\u4f8b\u3067\u3059\u3002  \n\nWeb\u30a2\u30d7\u30ea\u5074\n\napp.py\nfrom bottle import Bottle, HTTPResponse\n\nHOST='localhost'\nPORT=8080\nDEBUG=True\n\napp = Bottle()\n\ndef makeRes(code, data):\n    data['retcode'] = code\n    r = HTTPResponse(status=200, body=json.dumps(data))\n    r.set_header('Content-Type', 'application/json')\n    return r\n\n@app.post('/aikotoba')\ndef api_aikotoba():\n    o = request.json\n    if o is None:\n        return makeRes('ERR_PARAM', {})\n    if not 'kotoba' in o:\n        return makeRes('ERR_PARAM', {})\n    if o['kotoba']=='\u5c71':\n        return makeRes('OK', {'henji':'\u3048\u3063\uff1f'}\n    else:\n        return makeRes('OK', {'henji':'\u306f\u3063\uff1f'}\n\nif __name__=='__main__':\n    app.run(host=HOST, port=PORT, debug=DEBUG, reloader=True)\n\n\n\nUnitTest\u5074\n\ntest_app.py\nimport unittest\nimport api \nfrom webtest import TestApp\n\nos.environ['WEBTEST_TARGET_URL'] = 'http://localhost:8080'\ntest_app = TestApp(api.app)\n\nclass ApiTest(unittest.TestCase):\n    def test_api_aikotoba1(self):\n        res = test_app.post_json('/aikotoba',{\n            'kotoba':'\u5c71' \n        })\n        self.assertEqual(res.json['henji'], '\u3048\u3063\uff1f')\n    def test_api_aikotoba2(self):\n        res = test_app.post_json('/aikotoba',{\n            'kotoba':'\u5ddd' \n        })\n        self.assertEqual(res.json['henji'], '\u306f\u3063\uff1f')\n\nif __name__ == '__main__':\n    unittest.main()\n\n\n\n\u30c6\u30b9\u30c8\u5b9f\u65bd\n\n1.\u30c6\u30b9\u30c8\u30b5\u30fc\u30d0\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\u3002\npython app.py\n\n\n2.UnitTest\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\npython app_test.py\n\n\n3.\u7d50\u679c\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u3053\u3093\u306a\u611f\u3058\u3067\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n..\n----------------------------------------------------------------------\nRan 2 tests in 0.079s\n\nOK\n\nUnitTest\u30af\u30e9\u30b9\u306eassert\u306a\u3093\u3061\u3083\u3089\u304c\u4e0d\u4e00\u81f4\u306e\u5834\u5408\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n.F\n======================================================================\nFAIL: test_api_aikotoba2 (__main__.ApiTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"test_app.py\", line 16, in test_api_aikotoba2\n    self.assertEqual(res.json['henji'], '\u306f\u3063\uff1f')\nAssertionError: '\u3078\u3063\uff1f' != '\u306f\u3063\uff1f'\n- \u3078\u3063\uff1f\n? ^\n+ \u306f\u3063\uff1f\n? ^\n\n\n----------------------------------------------------------------------\nRan 2 tests in 0.126s\n\nFAILED (failures=1)\n\n\n\nWebTest\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3046\u3068\u3001WSGI\u30d9\u30fc\u30b9\u306eWeb\u30a2\u30d7\u30ea\u3092\u30c6\u30b9\u30c8\u3059\u308b\u30b3\u30fc\u30c9\u3092\u7c21\u5358\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\npip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n\n```bash\nsudo pip install webtest\n```\n\n## \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n\u4ee5\u4e0b\u306fbottle\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u4f7f\u3063\u305f\u3001JSON-RPC\u30b5\u30fc\u30d0\u5b9f\u88c5\u306e\u4f8b\u3067\u3059\u3002  \n\n#### Web\u30a2\u30d7\u30ea\u5074\n```app.py\nfrom bottle import Bottle, HTTPResponse\n\nHOST='localhost'\nPORT=8080\nDEBUG=True\n\napp = Bottle()\n\ndef makeRes(code, data):\n\tdata['retcode'] = code\n\tr = HTTPResponse(status=200, body=json.dumps(data))\n\tr.set_header('Content-Type', 'application/json')\n\treturn r\n\n@app.post('/aikotoba')\ndef api_aikotoba():\n\to = request.json\n\tif o is None:\n\t\treturn makeRes('ERR_PARAM', {})\n\tif not 'kotoba' in o:\n\t\treturn makeRes('ERR_PARAM', {})\n\tif o['kotoba']=='\u5c71':\n\t\treturn makeRes('OK', {'henji':'\u3048\u3063\uff1f'}\n\telse:\n\t\treturn makeRes('OK', {'henji':'\u306f\u3063\uff1f'}\n\nif __name__=='__main__':\n\tapp.run(host=HOST, port=PORT, debug=DEBUG, reloader=True)\n```\n\n#### UnitTest\u5074\n```test_app.py\nimport unittest\nimport api \nfrom webtest import TestApp\n\nos.environ['WEBTEST_TARGET_URL'] = 'http://localhost:8080'\ntest_app = TestApp(api.app)\n\nclass ApiTest(unittest.TestCase):\n\tdef test_api_aikotoba1(self):\n\t\tres = test_app.post_json('/aikotoba',{\n\t\t\t'kotoba':'\u5c71' \n\t\t})\n\t\tself.assertEqual(res.json['henji'], '\u3048\u3063\uff1f')\n\tdef test_api_aikotoba2(self):\n\t\tres = test_app.post_json('/aikotoba',{\n\t\t\t'kotoba':'\u5ddd' \n\t\t})\n\t\tself.assertEqual(res.json['henji'], '\u306f\u3063\uff1f')\n\nif __name__ == '__main__':\n    unittest.main()\n```\n\n## \u30c6\u30b9\u30c8\u5b9f\u65bd\n\n#### 1.\u30c6\u30b9\u30c8\u30b5\u30fc\u30d0\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\u3002\n\n```\npython app.py\n```\n\n#### 2.UnitTest\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\npython app_test.py\n```\n\n#### 3.\u7d50\u679c\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n```\n..\n----------------------------------------------------------------------\nRan 2 tests in 0.079s\n\nOK\n```\n\nUnitTest\u30af\u30e9\u30b9\u306eassert\u306a\u3093\u3061\u3083\u3089\u304c\u4e0d\u4e00\u81f4\u306e\u5834\u5408\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n```\n.F\n======================================================================\nFAIL: test_api_aikotoba2 (__main__.ApiTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"test_app.py\", line 16, in test_api_aikotoba2\n    self.assertEqual(res.json['henji'], '\u306f\u3063\uff1f')\nAssertionError: '\u3078\u3063\uff1f' != '\u306f\u3063\uff1f'\n- \u3078\u3063\uff1f\n? ^\n+ \u306f\u3063\uff1f\n? ^\n\n\n----------------------------------------------------------------------\nRan 2 tests in 0.126s\n\nFAILED (failures=1)\n\n```\n", "tags": ["Python", "unittest"]}