{"context": "\u300c\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u300d\u3067\u30af\u30fc\u30dd\u30f3\u3092\u3044\u305f\u3060\u3044\u3066\u3044\u305f\u306e\u3067\u3001\u5546\u7528\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306a\u3075\u3064\u30fc\u306e\u30b5\u30fc\u30d3\u30b9\u74b0\u5883\u3092\u3064\u304f\u308b\u306e\u306b\u3069\u3046\u3044\u3046\u3053\u3068\u3092\u3084\u308c\u3070\u3044\u3044\u306e\u304b\u3001\u3068\u3044\u3046\u3053\u3068\u3092\u8a66\u3057\u3066\u307f\u305f. \u305d\u306e\u30ed\u30b0.\n\u6ce81: \u5b9f\u9a13\u30ec\u30d9\u30eb\u306e\u8a2d\u8a08\uff06\u8a2d\u5b9a\u306a\u306e\u3067\u3001\u3068\u304f\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u5468\u308a\u306f\u4e38\u30d1\u30af\u30ea\u3057\u306a\u3044\u65b9\u304c\u3044\u3044\u304b\u3082.\n\u6ce82: \u6599\u91d1\u3084\u6a5f\u80fd\u306a\u3069\u306f\u6295\u7a3f\u5f53\u6642\u306e\u3082\u306e\u3067\u3059.\n\n\u74b0\u5883\u306e\u6982\u8981\n\n\u3072\u3068\u307e\u305aWordPress\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\nAPP\u30b5\u30fc\u30d0x2(app1, app2), DB\u30b5\u30fc\u30d0x1(db1), HTTP\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5(www)\nAPP\u30b5\u30fc\u30d0\u3068DB\u30b5\u30fc\u30d0\u3067\u306f\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u308f\u3051\u308b(APP:192.168.0.0/24, DB:192.168.1.0/24)\n\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u304b\u3089\u4e0a\u306f\u9762\u5012\u306a\u306e\u3067\u3001\u5168\u30db\u30b9\u30c8CoreOS\u3067\u69cb\u6210\u3057\u3066\u3001\u3042\u3068\u306fDocker\u3067\u30b4\u30cb\u30e7\u308b\n\n\nfleet \u3092\u4f7f\u3063\u305f\u308a\u3001Docker \u306e\u30de\u30eb\u30c1\u30db\u30b9\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6a5f\u80fd\u3068\u304b\u306f\u3001\u3053\u3053\u3067\u306f\u6271\u308f\u306a\u3044\nBlue-Green Deployment \u3069\u3046\u3059\u3093\u306e\u3001\u3068\u304b\u3082\u307e\u3063\u305f\u304f\u6271\u308f\u306a\u3044\n\n\n\n\n\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\n\n\n\u4f5c\u696d\u306e\u6982\u8981\n\nVPC\u30eb\u30fc\u30bf\u3092\u4f5c\u6210\uff06\u8a2d\u5b9a\n\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u3092\u4f5c\u6210\uff06\u8a2d\u5b9a\n\u30b5\u30fc\u30d0\u8a2d\u5b9a\n\u52d5\u4f5c\u78ba\u8a8d\nAPP\u30b5\u30fc\u30d0\u306e\u5897\u8a2d\nDNS\u306e\u8a2d\u5b9a\n\u76e3\u8996\u306e\u8a2d\u5b9a\n\n\n\u4f5c\u696d\u624b\u9806\n\nVPC\u30eb\u30fc\u30bf\u3092\u4f5c\u6210\uff06\u8a2d\u5b9a\n\n\u4f5c\u6210\n\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u3001VPC\u30eb\u30fc\u30bf\u3092\u8d77\u52d5\u3059\u308b.\n\u3053\u3053\u3067\u306f\u3001 wp_vpc \u3068\u3044\u3046\u540d\u524d\u3092\u6307\u5b9a.\n\n\n\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u8a2d\u5b9a\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3092\u5165\u308c\u308b. \u305d\u308c\u305e\u308c\u306e\u63a5\u7d9a\u5148\u3068\u3057\u3066\u300c\u65b0\u898f\u30b9\u30a4\u30c3\u30c1\u3092\u4f5c\u6210\u300d\u3092\u6307\u5b9a\u3059\u308b.\n\u3053\u3053\u3067\u306f\u3001\u5404\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u904b\u7528\u3059\u308b\u3053\u3068\u3068\u3057\u3001\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u306b\u306f .1 \u3092\u5272\u308a\u5f53\u3066\u308b.\n\u63a5\u7d9a\u5148\u306e\u30b9\u30a4\u30c3\u30c1\u3092\u4f5c\u6210\u3057\u305f\u5f8c\u3001\u305d\u308c\u305e\u308c\u306b\u540d\u524d\u3092\u3064\u3051\u3066\u304a\u304f\u3068\u4fbf\u5229.\n\n192.168.0.0/24 \u2192 APP\u30b5\u30fc\u30d0\u306e\u3042\u308bpublic\u30bb\u30b0\u30e1\u30f3\u30c8(wp_vpc_public)\n192.168.1.0/24 \u2192 DB\u30b5\u30fc\u30d0\u306e\u3042\u308bprivate\u30bb\u30b0\u30e1\u30f3\u30c8(wp_vpc_private)\n\n\n\nNAT\u8a2d\u5b9a\n\u30b0\u30ed\u30fc\u30d0\u30eb\u507480\u756a\u30dd\u30fc\u30c8(HTTP)\u3078\u306e\u63a5\u7d9a\u3092\u3001\u3053\u306e\u3042\u3068\u4f5c\u6210\u3059\u308b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306eVIP\u3067\u3042\u308b 192.168.0.10:80 \u3078\u5909\u63db\u3059\u308b\u8a2d\u5b9a\u3092\u5165\u308c\u308b.\n\n\n\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u8a2d\u5b9a\nInbound \u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306b\u3064\u3044\u3066\u3001\u4ee5\u4e0b\u306e\u901a\u4fe1\u306e\u307f\u8a31\u5bb9\u3057\u3001\u305d\u308c\u4ee5\u5916\u306f\u62d2\u5426\u3059\u308b\u8a2d\u5b9a\u3092\u5165\u308c\u308b.\n\npublic\u30bb\u30b0\u30e1\u30f3\u30c8\u3078\u306eTCP80\npublic <-> private \u9593\u306eIP\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\n\n\n\n\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\n\u9069\u5f53\u306a\u30b5\u30a4\u30ba\u3067\u3001app1 \u3068 db1 \u3092\u4f5c\u6210\u3059\u308b. app2 \u306f\u3042\u3068\u3067 app1 \u3092\u30af\u30ed\u30fc\u30f3\u3059\u308b\u3053\u3068\u306b\u3059\u308b.\n\n\u4f5c\u6210\u6642\u306e\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066 CoreOS \u3092\u6307\u5b9a\u3059\u308b.\n\n\u63a5\u7d9a\u5148\u306b\u306f\u3001\u5148\u307b\u3069\u3064\u304f\u3063\u305f\u305d\u308c\u305e\u308c\u306e\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u30b9\u30a4\u30c3\u30c1\u3092\u6307\u5b9a\u3057\u3001\u30db\u30b9\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u306b\u306f\u305d\u308c\u305e\u308c .11 \u3092\u6307\u5b9a\u3059\u308b.\n\u7ba1\u7406\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u3001\u5f8c\u3067\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u8a2d\u5b9a\u3059\u308b\u3068\u304d\u306b\u4f7f\u3046.\n\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u3092\u4f5c\u6210\uff06\u8a2d\u5b9a\n\n\u4f5c\u6210\n\u63a5\u7d9a\u5148\u30b9\u30a4\u30c3\u30c1\u3068\u3057\u3066\u3001VPC\u30eb\u30fc\u30bf\u914d\u4e0b\u306b\u3064\u304f\u3063\u305fpublic\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u30b9\u30a4\u30c3\u30c1\u3092\u6307\u5b9a\u3059\u308b.\n\u3053\u3053\u3067\u6307\u5b9a\u3059\u308bIPv4\u30a2\u30c9\u30ec\u30b9\u306f\u3001VIP\u3067\u306f\u306a\u304f\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u81ea\u4f53\u306b\u5272\u308a\u5f53\u3066\u308b\u3082\u306e\u306a\u306e\u3067\u3001 .2 \u3092\u6307\u5b9a\u3057\u3066\u304a\u304f.\n\u540d\u524d\u306f www \u3068\u304b\u9069\u5f53\u306b\u3064\u3051\u3066\u304a\u304f.\n\n\nVIP\u8a2d\u5b9a\n\u3053\u3053\u3067\u3001\u5148\u307b\u3069VPC\u30eb\u30fc\u30bf\u306bNAT\u8a2d\u5b9a\u3057\u305f VIP = 192.168.0.10 \u3092\u6307\u5b9a\u3059\u308b.\n\n\n\u5b9f\u30b5\u30fc\u30d0\u8a2d\u5b9a\n192.168.0.10:80 \u3078\u306e\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306e\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u5148\u3092\u6307\u5b9a\u3059\u308b.\n\u3072\u3068\u307e\u305a\u3001192.168.0.11 \u306e1\u53f0\u306e\u307f\u8ffd\u52a0\u3057\u3066\u304a\u304f.\n\n\n\u30b5\u30fc\u30d0\u8a2d\u5b9a\n\nDocker\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u30ed\u30b0\u30a4\u30f3\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067 Docker \u3092\u6700\u65b0\u7248\u306b\u3059\u308b.\n$ update_engine_client -update\n\n\ncloud-config.yml \u3092\u7de8\u96c6\napp1 \u306b\u306f wordpress:latest \u3092\u3001db1 \u306b\u306f mysql:latest \u3092\u305d\u308c\u305e\u308c\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b.\nCoreOS \u8d77\u52d5\u6642\u306e\u8a2d\u5b9a\u306f /usr/share/oem/cloud-config.yml \u306b\u3042\u308b\u306e\u3067\u3001\u3053\u308c\u3092\u7de8\u96c6\u3059\u308b.\n\nDB\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\u8a2d\u5b9a\nAPP\u30b5\u30fc\u30d0\u8d77\u52d5\u6642\u306bDB\u30db\u30b9\u30c8\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u307e\u305a\u306f db1 \u304b\u3089.\n(\u30b3\u30d4\u30da\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u30d6\u30e9\u30a6\u30b6\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3060\u3068\u3067\u304d\u306a\u3044\u304b\u3082\u306a\u306e\u3067\u3001\u9069\u5f53\u306b\u30b0\u30ed\u30fc\u30d0\u30ebIP\u304b\u3089NAT\u3055\u305b\u308b\u306a\u308a\u3001ssh\u306e\u7a74\u3042\u3051\u308b\u306a\u3069\u3057\u3066\u304f\u3060\u3055\u3044.)\niptables \u3092\u66f4\u65b0\u3059\u308b\u8a2d\u5b9a\u3082\u5165\u308c\u3066\u304a\u304f.\n\ncloud-config.yml\n# \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u3082\u306e\u306b\u3001\u4e0b\u8a18\u3092\u8ffd\u8a18.\n\ncoreos:\n  units:\n    -\n      name: mysql.service\n      command: restart\n      content: |\n        [Unit]\n        Description=mysql\n        After=mysql.service\n        Require=mysql.service\n\n        [Service]\n        ExecStart=/usr/bin/docker run -it -e MYSQL_ROOT_PASSWORD=secret -p 3306:3306 -d wordpress\n\n        [Install]\n        WantedBy=multi-user.target\n\n\nreboot \u3057\u3066\u518d\u8d77\u52d5\u3057\u3066\u304d\u305f\u5f8c\u306b docker ps \u3057\u3066 MySQL \u306e\u30b3\u30f3\u30c6\u30ca\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b.\n\nAPP\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\u8a2d\u5b9a\napp1 \u306f\u3001VIP:192.168.0.10 \u306e\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u5148\u3068\u306a\u308b.\n\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u306fDSR\u69cb\u6210\u306e\u8a2d\u5b9a\u65b9\u6cd5\u304c\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u306e\u3067\u3001\u3053\u308c\u306b\u5247\u308b. \u304c\u3001CoreOS \u3067\u306e\u30eb\u30fc\u30d7\u30d0\u30c3\u30af\u30a2\u30c9\u30ec\u30b9\u8ffd\u52a0\u8a2d\u5b9a\u304c\u3001\u3088\u304f\u308f\u304b\u3089\u306a\u304b\u3063\u305f\uff06\u306a\u3093\u304b\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u306e\u3067\u3001iptables \u306b NAT \u306e PREROUTING \u8a2d\u5b9a\u3092\u5165\u308c\u3001VIP \u5411\u3051\u306e\u901a\u4fe1\u3092\u53d7\u3051\u5165\u308c\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u304a\u304f.\n\ncloud-config.yml\n# \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u3082\u306e\u306b\u3001\u4e0b\u8a18\u3092\u8ffd\u8a18.\n\ncoreos:\n  units:\n    - \n      command: iptables-restore.service\n      enable: true\n    -\n      name: wordpress.service\n      command: restart\n      content: |\n        [Unit]\n        Description=wordpress\n        After=wordpress.service\n        Require=wordpress.service\n\n        [Service]\n        ExecStart=/usr/bin/docker run -it -e WORDPRESS_DB_HOST=192.168.1.11:3306 -e WORDPRESS_DB_USER=root -e WODPRESS_DB_PASSWORD=secret -p 80:80 -d wordpress\n\n        [Install]\n        WantedBy=multi-user.target\n\nwrite_files:\n  - \n    path: /var/lib/iptables/rules-save\n    permissions: 0644\n    owner: root:root\n    content: |\n      *nat\n      -A PREROUTING -d 192.168.0.10 -j REDIRECT\n      COMMIT  \n\n\nreboot \u3057\u3066\u518d\u8d77\u52d5\u3057\u3066\u304d\u305f\u5f8c\u306b docker ps \u3057\u3066 WordPress \u306e\u30b3\u30f3\u30c6\u30ca\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b.\n\n\u52d5\u4f5c\u78ba\u8a8d\nWeb\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u3063\u3066\u3001VPC\u30eb\u30fc\u30bf\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308b\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\u3092\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b.\nWordPress \u306e\u521d\u671f\u8a2d\u5b9a\u753b\u9762\u304c\u51fa\u3066\u304f\u308c\u3070\u6210\u529f.\n\nAPP\u30b5\u30fc\u30d0\u306e\u5897\u8a2d\n\napp1 \u3092\u8907\u88fd\n\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u30b5\u30fc\u30d0\u8a73\u7d30\u753b\u9762\u4e0a\u90e8\u306b\u3042\u308b\u300c\u30af\u30ed\u30fc\u30f3\u300d\u3092\u9078\u629e\u3057\u3001public \u30bb\u30b0\u30e1\u30f3\u30c8\u306b app1 \u306e\u30af\u30ed\u30fc\u30f3 app2 \u3092\u4f5c\u6210\u3059\u308b. IP\u30a2\u30c9\u30ec\u30b9\u306f 192.168.0.12 \u3068\u3059\u308b. \u3042\u3068\u306f app1 \u3068\u540c\u3058.\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u5b9f\u30b5\u30fc\u30d0\u306b\u8ffd\u52a0\n\u4f5c\u6210\u3057\u305f app2 \u3092\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u5b9f\u30b5\u30fc\u30d0\u3068\u3057\u3066\u8ffd\u52a0\u3059\u308b.\n\u8ffd\u52a0\u8a2d\u5b9a\u5f8c\u306f\u300c\u53cd\u6620\u300d\u3059\u308b.\nWeb\u30d6\u30e9\u30a6\u30b6\u3067\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3084\u30ea\u30ed\u30fc\u30c9\u306a\u3069\u3057\u3066\u307f\u3066\u3001\u758e\u901a\u78ba\u8a8d.\n\nDNS\u306e\u8a2d\u5b9a\n\u30be\u30fc\u30f3\u6301\u3061\u8fbc\u3080\u306e\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u3001\u4eca\u56de\u306f\u3084\u3063\u3066\u306a\u3044.\n\u5de6\u306b\u30e1\u30cb\u30e5\u30fc\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3053\u304b\u3089\u3067\u304d\u308b\u307d\u3044.\n\n\u76e3\u8996\u306e\u8a2d\u5b9a\n\u300c\u30b7\u30f3\u30d7\u30eb\u76e3\u8996\u300d\u3092\u4f7f\u3063\u3066\u3001VPC\u30eb\u30fc\u30bf\u306e\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\u306b\u5bfe\u3057\u3066HTTP\u76e3\u8996\u306e\u8a2d\u5b9a\u3092\u5165\u308c\u308b.\n\n\n\u3067\u3082\u3001\u304a\u9ad8\u3044\u3093\u3067\u3057\u3087\u3046\uff1f\n\u3053\u306e\u69cb\u6210\u3067\u3001\u6708\u984d18,037\u5186(\u7a0e\u8fbc)(\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u5834\u5408).\nWordPress \u3063\u3066\u30b5\u30f3\u30d7\u30eb\u304c\u3088\u304f\u306a\u3044\u304b. \u305d\u308c\u306a\u308a\u306b\u30b9\u30b1\u30fc\u30eb\u3055\u305b\u3066\u3044\u304d\u305f\u3044\u3001\u3075\u3064\u30fc\u306eAPP+DB\u306a\u30b5\u30fc\u30d3\u30b9\u3092\u3064\u304f\u308b\u3068\u8003\u3048\u308c\u3070\u3001\u3046\u30fc\u3093\u3001\u3046\u30fc\u3093\u3001\u8ff7\u3046\u5024\u6bb5. \u30c7\u30fc\u30bf\u8ee2\u9001\u6599\u304c\u304b\u304b\u3089\u306a\u3044\u3063\u3066\u3044\u3046\u306e\u306f\u3044\u3044\u3067\u3059\u306d.\n\n\n\u6240\u611f\n\u697d\u3057\u304b\u3063\u305f\u3067\u3059. \u30af\u30fc\u30dd\u30f3\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f.\nAWS\u3088\u308a\u3082\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6a5f\u5668\u5468\u308a\u3044\u3058\u3063\u3066\u308b\u611f\u899a\u3042\u308b\u304b\u306a.\n\u300c\u30b9\u30a4\u30c3\u30c1\u300d\u300c\u30eb\u30fc\u30bf\u300d\u3068\u304b\u305d\u3046\u3044\u3046\u540d\u79f0\u304c\u30e1\u30cb\u30e5\u30fc\u5185\u306b\u3042\u308b\u304b\u3089\u3063\u3066\u306e\u3082\u3042\u308b\u304b.\n\u3061\u306a\u307f\u306b\u3001WordPress \u304c\u3084\u308a\u305f\u3044\u3093\u3067\u3042\u308c\u3070\u3001\u8d77\u52d5\u6642\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3082\u4f7f\u3048\u308b\u3057\u3001 KUSANAGI for \u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9 | KUSANAGI \u3068\u3044\u3046\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3068\u3066\u3082\u7c21\u5358\u306b\u4f7f\u3048\u305d\u3046\u306a\u306e\u3067\u3001\u308f\u3056\u308f\u3056 CoreOS \u3067\u3053\u3093\u306a\u3053\u3068\u3084\u3089\u306a\u304f\u3066\u826f\u3044\u3067\u3059(\u3084\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u3060\u3051).\n\n\u53c2\u8003\n\n\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\uff5c\u3055\u304f\u3089\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u516c\u5f0f\u30b5\u30dd\u30fc\u30c8\u30b5\u30a4\u30c8\n\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d3\u30b9\u4ed5\u69d8\u30fb\u6599\u91d1 | \u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\n\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u306e\u6599\u91d1\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\uff5c\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\n\n\n\u300c\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u300d\u3067\u30af\u30fc\u30dd\u30f3\u3092\u3044\u305f\u3060\u3044\u3066\u3044\u305f\u306e\u3067\u3001\u5546\u7528\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306a\u3075\u3064\u30fc\u306e\u30b5\u30fc\u30d3\u30b9\u74b0\u5883\u3092\u3064\u304f\u308b\u306e\u306b\u3069\u3046\u3044\u3046\u3053\u3068\u3092\u3084\u308c\u3070\u3044\u3044\u306e\u304b\u3001\u3068\u3044\u3046\u3053\u3068\u3092\u8a66\u3057\u3066\u307f\u305f. \u305d\u306e\u30ed\u30b0.\n\n\u6ce81: \u5b9f\u9a13\u30ec\u30d9\u30eb\u306e\u8a2d\u8a08\uff06\u8a2d\u5b9a\u306a\u306e\u3067\u3001\u3068\u304f\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u5468\u308a\u306f\u4e38\u30d1\u30af\u30ea\u3057\u306a\u3044\u65b9\u304c\u3044\u3044\u304b\u3082.\n\u6ce82: \u6599\u91d1\u3084\u6a5f\u80fd\u306a\u3069\u306f\u6295\u7a3f\u5f53\u6642\u306e\u3082\u306e\u3067\u3059.\n\n# \u74b0\u5883\u306e\u6982\u8981\n\n* \u3072\u3068\u307e\u305aWordPress\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\n* APP\u30b5\u30fc\u30d0x2(app1, app2), DB\u30b5\u30fc\u30d0x1(db1), HTTP\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5(www)\n* APP\u30b5\u30fc\u30d0\u3068DB\u30b5\u30fc\u30d0\u3067\u306f\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u308f\u3051\u308b(APP:192.168.0.0/24, DB:192.168.1.0/24)\n* \u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u304b\u3089\u4e0a\u306f\u9762\u5012\u306a\u306e\u3067\u3001\u5168\u30db\u30b9\u30c8CoreOS\u3067\u69cb\u6210\u3057\u3066\u3001\u3042\u3068\u306fDocker\u3067\u30b4\u30cb\u30e7\u308b\n\t* fleet \u3092\u4f7f\u3063\u305f\u308a\u3001Docker \u306e\u30de\u30eb\u30c1\u30db\u30b9\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6a5f\u80fd\u3068\u304b\u306f\u3001\u3053\u3053\u3067\u306f\u6271\u308f\u306a\u3044\n\t* Blue-Green Deployment \u3069\u3046\u3059\u3093\u306e\u3001\u3068\u304b\u3082\u307e\u3063\u305f\u304f\u6271\u308f\u306a\u3044\n\n# \u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 16.25.52.png](https://qiita-image-store.s3.amazonaws.com/0/1329/f4397092-19f7-d7d0-29e3-b12113692eb7.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 16.25.52.png\")\n\n# \u4f5c\u696d\u306e\u6982\u8981\n\n* VPC\u30eb\u30fc\u30bf\u3092\u4f5c\u6210\uff06\u8a2d\u5b9a\n* \u30b5\u30fc\u30d0\u3092\u4f5c\u6210\n* \u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u3092\u4f5c\u6210\uff06\u8a2d\u5b9a\n* \u30b5\u30fc\u30d0\u8a2d\u5b9a\n* \u52d5\u4f5c\u78ba\u8a8d\n* APP\u30b5\u30fc\u30d0\u306e\u5897\u8a2d\n* DNS\u306e\u8a2d\u5b9a\n* \u76e3\u8996\u306e\u8a2d\u5b9a\n\n# \u4f5c\u696d\u624b\u9806\n\n## VPC\u30eb\u30fc\u30bf\u3092\u4f5c\u6210\uff06\u8a2d\u5b9a\n\n### \u4f5c\u6210\n\n\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u3001VPC\u30eb\u30fc\u30bf\u3092\u8d77\u52d5\u3059\u308b.\n\u3053\u3053\u3067\u306f\u3001 wp_vpc \u3068\u3044\u3046\u540d\u524d\u3092\u6307\u5b9a.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 18.01.51.png](https://qiita-image-store.s3.amazonaws.com/0/1329/65e71c59-83d2-4424-ccec-43befac3d681.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 18.01.51.png\")\n\n### \u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u8a2d\u5b9a\n\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3092\u5165\u308c\u308b. \u305d\u308c\u305e\u308c\u306e\u63a5\u7d9a\u5148\u3068\u3057\u3066\u300c\u65b0\u898f\u30b9\u30a4\u30c3\u30c1\u3092\u4f5c\u6210\u300d\u3092\u6307\u5b9a\u3059\u308b.\n\n\u3053\u3053\u3067\u306f\u3001\u5404\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u904b\u7528\u3059\u308b\u3053\u3068\u3068\u3057\u3001\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u306b\u306f .1 \u3092\u5272\u308a\u5f53\u3066\u308b.\n\u63a5\u7d9a\u5148\u306e\u30b9\u30a4\u30c3\u30c1\u3092\u4f5c\u6210\u3057\u305f\u5f8c\u3001\u305d\u308c\u305e\u308c\u306b\u540d\u524d\u3092\u3064\u3051\u3066\u304a\u304f\u3068\u4fbf\u5229.\n\n* 192.168.0.0/24 \u2192 APP\u30b5\u30fc\u30d0\u306e\u3042\u308bpublic\u30bb\u30b0\u30e1\u30f3\u30c8(wp_vpc_public)\n* 192.168.1.0/24 \u2192 DB\u30b5\u30fc\u30d0\u306e\u3042\u308bprivate\u30bb\u30b0\u30e1\u30f3\u30c8(wp_vpc_private)\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 18.15.54.png](https://qiita-image-store.s3.amazonaws.com/0/1329/cddae315-5407-a620-59e4-ed94659d9123.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 18.15.54.png\")\n\n### NAT\u8a2d\u5b9a\n\n\u30b0\u30ed\u30fc\u30d0\u30eb\u507480\u756a\u30dd\u30fc\u30c8(HTTP)\u3078\u306e\u63a5\u7d9a\u3092\u3001\u3053\u306e\u3042\u3068\u4f5c\u6210\u3059\u308b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306eVIP\u3067\u3042\u308b 192.168.0.10:80 \u3078\u5909\u63db\u3059\u308b\u8a2d\u5b9a\u3092\u5165\u308c\u308b.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 18.16.07.png](https://qiita-image-store.s3.amazonaws.com/0/1329/869f4092-e8b9-3790-20c5-ca5fd6be6e4e.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 18.16.07.png\")\n\n### \u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u8a2d\u5b9a\n\nInbound \u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306b\u3064\u3044\u3066\u3001\u4ee5\u4e0b\u306e\u901a\u4fe1\u306e\u307f\u8a31\u5bb9\u3057\u3001\u305d\u308c\u4ee5\u5916\u306f\u62d2\u5426\u3059\u308b\u8a2d\u5b9a\u3092\u5165\u308c\u308b.\n\n* public\u30bb\u30b0\u30e1\u30f3\u30c8\u3078\u306eTCP80\n* public <-> private \u9593\u306eIP\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 18.32.41.png](https://qiita-image-store.s3.amazonaws.com/0/1329/7a04a8c5-1c1a-e5f4-1e24-6a639be767c3.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 18.32.41.png\")\n\n## \u30b5\u30fc\u30d0\u3092\u4f5c\u6210\n\n\u9069\u5f53\u306a\u30b5\u30a4\u30ba\u3067\u3001app1 \u3068 db1 \u3092\u4f5c\u6210\u3059\u308b. app2 \u306f\u3042\u3068\u3067 app1 \u3092\u30af\u30ed\u30fc\u30f3\u3059\u308b\u3053\u3068\u306b\u3059\u308b.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 17.32.08.png](https://qiita-image-store.s3.amazonaws.com/0/1329/e9b2be63-5414-7028-b087-369cda64385f.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 17.32.08.png\")\n\n\u4f5c\u6210\u6642\u306e\u30c7\u30a3\u30b9\u30af\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066 CoreOS \u3092\u6307\u5b9a\u3059\u308b.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 17.32.30.png](https://qiita-image-store.s3.amazonaws.com/0/1329/81d75493-8d47-76a7-1d28-e7c34bd223fa.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 17.32.30.png\")\n\n\u63a5\u7d9a\u5148\u306b\u306f\u3001\u5148\u307b\u3069\u3064\u304f\u3063\u305f\u305d\u308c\u305e\u308c\u306e\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u30b9\u30a4\u30c3\u30c1\u3092\u6307\u5b9a\u3057\u3001\u30db\u30b9\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u306b\u306f\u305d\u308c\u305e\u308c .11 \u3092\u6307\u5b9a\u3059\u308b.\n\u7ba1\u7406\u30e6\u30fc\u30b6\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u3001\u5f8c\u3067\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u8a2d\u5b9a\u3059\u308b\u3068\u304d\u306b\u4f7f\u3046.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-03-24_19_27_06.png](https://qiita-image-store.s3.amazonaws.com/0/1329/4f2be8ae-302e-038a-624d-b637cc584d27.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-03-24_19_27_06.png\")\n\n## \u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u3092\u4f5c\u6210\uff06\u8a2d\u5b9a\n\n### \u4f5c\u6210\n\n\u63a5\u7d9a\u5148\u30b9\u30a4\u30c3\u30c1\u3068\u3057\u3066\u3001VPC\u30eb\u30fc\u30bf\u914d\u4e0b\u306b\u3064\u304f\u3063\u305fpublic\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u30b9\u30a4\u30c3\u30c1\u3092\u6307\u5b9a\u3059\u308b.\n\u3053\u3053\u3067\u6307\u5b9a\u3059\u308bIPv4\u30a2\u30c9\u30ec\u30b9\u306f\u3001VIP\u3067\u306f\u306a\u304f\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u81ea\u4f53\u306b\u5272\u308a\u5f53\u3066\u308b\u3082\u306e\u306a\u306e\u3067\u3001 .2 \u3092\u6307\u5b9a\u3057\u3066\u304a\u304f.\n\u540d\u524d\u306f www \u3068\u304b\u9069\u5f53\u306b\u3064\u3051\u3066\u304a\u304f.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-03-24_19_18_06.png](https://qiita-image-store.s3.amazonaws.com/0/1329/1054ff72-1013-76c7-bd95-d76fe36abd95.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-03-24_19_18_06.png\")\n\n### VIP\u8a2d\u5b9a\n\n\u3053\u3053\u3067\u3001\u5148\u307b\u3069VPC\u30eb\u30fc\u30bf\u306bNAT\u8a2d\u5b9a\u3057\u305f VIP = 192.168.0.10 \u3092\u6307\u5b9a\u3059\u308b.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 19.24.13.png](https://qiita-image-store.s3.amazonaws.com/0/1329/ec858e38-81c9-fbf4-2481-a5ff4342f904.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 19.24.13.png\")\n\n### \u5b9f\u30b5\u30fc\u30d0\u8a2d\u5b9a\n\n192.168.0.10:80 \u3078\u306e\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306e\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u5148\u3092\u6307\u5b9a\u3059\u308b.\n\u3072\u3068\u307e\u305a\u3001192.168.0.11 \u306e1\u53f0\u306e\u307f\u8ffd\u52a0\u3057\u3066\u304a\u304f.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 19.24.30.png](https://qiita-image-store.s3.amazonaws.com/0/1329/c61ed57c-e54e-8f7a-b9b7-e1eae956eb0d.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-24 19.24.30.png\")\n\n## \u30b5\u30fc\u30d0\u8a2d\u5b9a\n\n### Docker\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u30ed\u30b0\u30a4\u30f3\u3057\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067 Docker \u3092\u6700\u65b0\u7248\u306b\u3059\u308b.\n\n```\n$ update_engine_client -update\n```\n\n### cloud-config.yml \u3092\u7de8\u96c6\n\napp1 \u306b\u306f wordpress:latest \u3092\u3001db1 \u306b\u306f mysql:latest \u3092\u305d\u308c\u305e\u308c\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b.\nCoreOS \u8d77\u52d5\u6642\u306e\u8a2d\u5b9a\u306f `/usr/share/oem/cloud-config.yml` \u306b\u3042\u308b\u306e\u3067\u3001\u3053\u308c\u3092\u7de8\u96c6\u3059\u308b.\n\n#### DB\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\u8a2d\u5b9a\n\nAPP\u30b5\u30fc\u30d0\u8d77\u52d5\u6642\u306bDB\u30db\u30b9\u30c8\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u307e\u305a\u306f db1 \u304b\u3089.\n(\u30b3\u30d4\u30da\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u30d6\u30e9\u30a6\u30b6\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3060\u3068\u3067\u304d\u306a\u3044\u304b\u3082\u306a\u306e\u3067\u3001\u9069\u5f53\u306b\u30b0\u30ed\u30fc\u30d0\u30ebIP\u304b\u3089NAT\u3055\u305b\u308b\u306a\u308a\u3001ssh\u306e\u7a74\u3042\u3051\u308b\u306a\u3069\u3057\u3066\u304f\u3060\u3055\u3044.)\n\niptables \u3092\u66f4\u65b0\u3059\u308b\u8a2d\u5b9a\u3082\u5165\u308c\u3066\u304a\u304f.\n\n```cloud-config.yml\n# \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u3082\u306e\u306b\u3001\u4e0b\u8a18\u3092\u8ffd\u8a18.\n\ncoreos:\n  units:\n    -\n      name: mysql.service\n      command: restart\n      content: |\n        [Unit]\n        Description=mysql\n        After=mysql.service\n        Require=mysql.service\n        \n        [Service]\n        ExecStart=/usr/bin/docker run -it -e MYSQL_ROOT_PASSWORD=secret -p 3306:3306 -d wordpress\n        \n        [Install]\n        WantedBy=multi-user.target\n```\n\n`reboot` \u3057\u3066\u518d\u8d77\u52d5\u3057\u3066\u304d\u305f\u5f8c\u306b `docker ps` \u3057\u3066 MySQL \u306e\u30b3\u30f3\u30c6\u30ca\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b.\n\n#### APP\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\u8a2d\u5b9a\n\napp1 \u306f\u3001VIP:192.168.0.10 \u306e\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u5148\u3068\u306a\u308b.\n[\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u306fDSR\u69cb\u6210\u306e\u8a2d\u5b9a\u65b9\u6cd5\u304c\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f](https://help.sakura.ad.jp/app/answers/detail/a_id/2517)\u306e\u3067\u3001\u3053\u308c\u306b\u5247\u308b. \u304c\u3001CoreOS \u3067\u306e\u30eb\u30fc\u30d7\u30d0\u30c3\u30af\u30a2\u30c9\u30ec\u30b9\u8ffd\u52a0\u8a2d\u5b9a\u304c\u3001\u3088\u304f\u308f\u304b\u3089\u306a\u304b\u3063\u305f\uff06\u306a\u3093\u304b\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u306e\u3067\u3001iptables \u306b NAT \u306e PREROUTING \u8a2d\u5b9a\u3092\u5165\u308c\u3001VIP \u5411\u3051\u306e\u901a\u4fe1\u3092\u53d7\u3051\u5165\u308c\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u304a\u304f.\n\n```cloud-config.yml\n# \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u3082\u306e\u306b\u3001\u4e0b\u8a18\u3092\u8ffd\u8a18.\n\ncoreos:\n  units:\n    - \n      command: iptables-restore.service\n      enable: true\n    -\n      name: wordpress.service\n      command: restart\n      content: |\n        [Unit]\n        Description=wordpress\n        After=wordpress.service\n        Require=wordpress.service\n        \n        [Service]\n        ExecStart=/usr/bin/docker run -it -e WORDPRESS_DB_HOST=192.168.1.11:3306 -e WORDPRESS_DB_USER=root -e WODPRESS_DB_PASSWORD=secret -p 80:80 -d wordpress\n        \n        [Install]\n        WantedBy=multi-user.target\n\nwrite_files:\n  - \n    path: /var/lib/iptables/rules-save\n    permissions: 0644\n    owner: root:root\n    content: |\n      *nat\n      -A PREROUTING -d 192.168.0.10 -j REDIRECT\n      COMMIT  \n```\n\n`reboot` \u3057\u3066\u518d\u8d77\u52d5\u3057\u3066\u304d\u305f\u5f8c\u306b `docker ps` \u3057\u3066 WordPress \u306e\u30b3\u30f3\u30c6\u30ca\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b.\n\n## \u52d5\u4f5c\u78ba\u8a8d\n\nWeb\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u3063\u3066\u3001VPC\u30eb\u30fc\u30bf\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308b\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\u3092\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b.\nWordPress \u306e\u521d\u671f\u8a2d\u5b9a\u753b\u9762\u304c\u51fa\u3066\u304f\u308c\u3070\u6210\u529f.\n\n## APP\u30b5\u30fc\u30d0\u306e\u5897\u8a2d\n\n### app1 \u3092\u8907\u88fd\n\n\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u30b5\u30fc\u30d0\u8a73\u7d30\u753b\u9762\u4e0a\u90e8\u306b\u3042\u308b\u300c\u30af\u30ed\u30fc\u30f3\u300d\u3092\u9078\u629e\u3057\u3001public \u30bb\u30b0\u30e1\u30f3\u30c8\u306b app1 \u306e\u30af\u30ed\u30fc\u30f3 app2 \u3092\u4f5c\u6210\u3059\u308b. IP\u30a2\u30c9\u30ec\u30b9\u306f 192.168.0.12 \u3068\u3059\u308b. \u3042\u3068\u306f app1 \u3068\u540c\u3058.\n\n### \u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u5b9f\u30b5\u30fc\u30d0\u306b\u8ffd\u52a0\n\n\u4f5c\u6210\u3057\u305f app2 \u3092\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u5b9f\u30b5\u30fc\u30d0\u3068\u3057\u3066\u8ffd\u52a0\u3059\u308b.\n\u8ffd\u52a0\u8a2d\u5b9a\u5f8c\u306f\u300c\u53cd\u6620\u300d\u3059\u308b.\nWeb\u30d6\u30e9\u30a6\u30b6\u3067\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3084\u30ea\u30ed\u30fc\u30c9\u306a\u3069\u3057\u3066\u307f\u3066\u3001\u758e\u901a\u78ba\u8a8d.\n\n## DNS\u306e\u8a2d\u5b9a\n\n\u30be\u30fc\u30f3\u6301\u3061\u8fbc\u3080\u306e\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u3001\u4eca\u56de\u306f\u3084\u3063\u3066\u306a\u3044.\n\u5de6\u306b\u30e1\u30cb\u30e5\u30fc\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3053\u304b\u3089\u3067\u304d\u308b\u307d\u3044.\n\n## \u76e3\u8996\u306e\u8a2d\u5b9a\n\n\u300c\u30b7\u30f3\u30d7\u30eb\u76e3\u8996\u300d\u3092\u4f7f\u3063\u3066\u3001VPC\u30eb\u30fc\u30bf\u306e\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\u306b\u5bfe\u3057\u3066HTTP\u76e3\u8996\u306e\u8a2d\u5b9a\u3092\u5165\u308c\u308b.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-03-25_10_31_53.png](https://qiita-image-store.s3.amazonaws.com/0/1329/fda5a4f4-1ed3-511c-e9ec-12c3e44352c8.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8_2016-03-25_10_31_53.png\")\n\n# \u3067\u3082\u3001\u304a\u9ad8\u3044\u3093\u3067\u3057\u3087\u3046\uff1f\n\n\u3053\u306e\u69cb\u6210\u3067\u3001\u6708\u984d18,037\u5186(\u7a0e\u8fbc)(\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u5834\u5408).\n\nWordPress \u3063\u3066\u30b5\u30f3\u30d7\u30eb\u304c\u3088\u304f\u306a\u3044\u304b. \u305d\u308c\u306a\u308a\u306b\u30b9\u30b1\u30fc\u30eb\u3055\u305b\u3066\u3044\u304d\u305f\u3044\u3001\u3075\u3064\u30fc\u306eAPP+DB\u306a\u30b5\u30fc\u30d3\u30b9\u3092\u3064\u304f\u308b\u3068\u8003\u3048\u308c\u3070\u3001\u3046\u30fc\u3093\u3001\u3046\u30fc\u3093\u3001\u8ff7\u3046\u5024\u6bb5. \u30c7\u30fc\u30bf\u8ee2\u9001\u6599\u304c\u304b\u304b\u3089\u306a\u3044\u3063\u3066\u3044\u3046\u306e\u306f\u3044\u3044\u3067\u3059\u306d.\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-25 10.40.41.png](https://qiita-image-store.s3.amazonaws.com/0/1329/5910819f-1bbf-47ef-cfa2-bb9fa935efe7.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-25 10.40.41.png\")\n\n# \u6240\u611f\n\n\u697d\u3057\u304b\u3063\u305f\u3067\u3059. \u30af\u30fc\u30dd\u30f3\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f.\nAWS\u3088\u308a\u3082\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u6a5f\u5668\u5468\u308a\u3044\u3058\u3063\u3066\u308b\u611f\u899a\u3042\u308b\u304b\u306a.\n\u300c\u30b9\u30a4\u30c3\u30c1\u300d\u300c\u30eb\u30fc\u30bf\u300d\u3068\u304b\u305d\u3046\u3044\u3046\u540d\u79f0\u304c\u30e1\u30cb\u30e5\u30fc\u5185\u306b\u3042\u308b\u304b\u3089\u3063\u3066\u306e\u3082\u3042\u308b\u304b.\n\n\u3061\u306a\u307f\u306b\u3001WordPress \u304c\u3084\u308a\u305f\u3044\u3093\u3067\u3042\u308c\u3070\u3001\u8d77\u52d5\u6642\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3082\u4f7f\u3048\u308b\u3057\u3001 [KUSANAGI for \u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9 | KUSANAGI](https://kusanagi.tokyo/cloud/kusanagi-for-sakuracloud/) \u3068\u3044\u3046\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3068\u3066\u3082\u7c21\u5358\u306b\u4f7f\u3048\u305d\u3046\u306a\u306e\u3067\u3001\u308f\u3056\u308f\u3056 CoreOS \u3067\u3053\u3093\u306a\u3053\u3068\u3084\u3089\u306a\u304f\u3066\u826f\u3044\u3067\u3059(\u3084\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u3060\u3051).\n\n# \u53c2\u8003\n\n* [\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\uff5c\u3055\u304f\u3089\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u516c\u5f0f\u30b5\u30dd\u30fc\u30c8\u30b5\u30a4\u30c8](https://help.sakura.ad.jp/app/cloud)\n* [\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d3\u30b9\u4ed5\u69d8\u30fb\u6599\u91d1 | \u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9](http://cloud.sakura.ad.jp/specification.php)\n* [\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9\u306e\u6599\u91d1\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\uff5c\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9](http://cloud.sakura.ad.jp/payment/simulation.php)\n", "tags": ["CoreOS", "\u3055\u304f\u3089\u306e\u30af\u30e9\u30a6\u30c9", "\u3055\u304f\u3089"]}