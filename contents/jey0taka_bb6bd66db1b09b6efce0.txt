{"context": " More than 1 year has passed since last update.\n\n\u5fc5\u8981\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum install rpm-build pcre-devel gcc\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u6e96\u5099\nmkdir -p /root/rpmbuild/SOURCES\nmkdir -p /root/rpmbuild/SPECS\ncd /root/rpmbuild/SOURCES\n\n\u30bd\u30fc\u30b9\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nwget http://www.haproxy.org/download/1.5/src/haproxy-1.5.5.tar.gz\ntar zxvf haproxy-1.5.5.tar.gz\ncp haproxy-1.5.0/examples/haproxy.spec ../SPECS/\n\nRPM\u306e\u30d3\u30eb\u30c9\ncd /root/rpmbuild/SPECS\nrpmbuild -ba haproxy.spec\n\nHaproxy\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nrpm -Uvh /root/rpmbuild/RPMS/x86_64/haproxy-1.5.5-1.x86_64.rpm\nmkdir /var/lib/haproxy\n\n\u30ed\u30b0\u51fa\u529b\u306e\u8a2d\u5b9a\n\n/etc/rsyslog.conf\n#*.info;mail.none;authpriv.none;cron.none                /var/log/messages\n*.info;mail.none;authpriv.none;cron.none;local6.none                /var/log/messages\n\nlocal6.*                                                /var/log/haproxy.log\n\n# Provides UDP syslog reception\n#$ModLoad imudp\n#$UDPServerRun 514\n\n$ModLoad imudp\n$UDPServerRun 514\n\n\n\n\u30ed\u30b0\u306e\u30ed\u30fc\u30c6\u30fc\u30c8\u8a2d\u5b9a\n\n/etc/logrotate.d/syslog\n/var/log/cron\n/var/log/maillog\n/var/log/messages\n/var/log/secure\n/var/log/spooler\n/var/log/haproxy.log\n{\n    sharedscripts\n    postrotate\n        /bin/kill -HUP `cat /var/run/syslogd.pid 2> /dev/null` 2> /dev/null || true\n    endscript\n}\n\n\n\n\u8a2d\u5b9a\uff20\u30b5\u30f3\u30d7\u30eb\n\n/etc/haproxy/haproxy.cfg\nglobal\n        log         127.0.0.1 local6\n        maxconn     16384\n        chroot      /var/lib/haproxy\n        uid 99\n        gid 99\n        daemon\n#       debug\n        spread-checks 5\n        nbproc      4 #CPU\u306e\u30b3\u30a2\u6570\u306b\u5408\u308f\u305b\u308b\n\ndefaults\n        log             global\n        option          tcplog\n        mode tcp\n        retries 2\n        timeout connect 5s\n        timeout client  20s\n        timeout server  20s\n        timeout check   10s\n\nlisten http\n        bind *:80\n        mode tcp\n        balance roundrobin\n        option  log-health-checks\n        option  tcp-smart-connect\n        option  contstats\n        server  read1 192.168.1.11:80 check port 80 inter 30000 fall 1\n        server  read2 192.168.1.12:80 check port 80 inter 30000 fall 1\n\n\n# \u5fc5\u8981\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum install rpm-build pcre-devel gcc\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u6e96\u5099\nmkdir -p /root/rpmbuild/SOURCES\nmkdir -p /root/rpmbuild/SPECS\ncd /root/rpmbuild/SOURCES\n\n# \u30bd\u30fc\u30b9\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nwget http://www.haproxy.org/download/1.5/src/haproxy-1.5.5.tar.gz\ntar zxvf haproxy-1.5.5.tar.gz\ncp haproxy-1.5.0/examples/haproxy.spec ../SPECS/\n\n# RPM\u306e\u30d3\u30eb\u30c9\ncd /root/rpmbuild/SPECS\nrpmbuild -ba haproxy.spec\n\n# Haproxy\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nrpm -Uvh /root/rpmbuild/RPMS/x86_64/haproxy-1.5.5-1.x86_64.rpm\n\nmkdir /var/lib/haproxy\n\n# \u30ed\u30b0\u51fa\u529b\u306e\u8a2d\u5b9a\n```/etc/rsyslog.conf\n#*.info;mail.none;authpriv.none;cron.none                /var/log/messages\n*.info;mail.none;authpriv.none;cron.none;local6.none                /var/log/messages\n\nlocal6.*                                                /var/log/haproxy.log\n\n# Provides UDP syslog reception\n#$ModLoad imudp\n#$UDPServerRun 514\n\n$ModLoad imudp\n$UDPServerRun 514\n```\n\n# \u30ed\u30b0\u306e\u30ed\u30fc\u30c6\u30fc\u30c8\u8a2d\u5b9a\n```/etc/logrotate.d/syslog\n/var/log/cron\n/var/log/maillog\n/var/log/messages\n/var/log/secure\n/var/log/spooler\n/var/log/haproxy.log\n{\n    sharedscripts\n    postrotate\n        /bin/kill -HUP `cat /var/run/syslogd.pid 2> /dev/null` 2> /dev/null || true\n    endscript\n}\n```\n\n# \u8a2d\u5b9a\uff20\u30b5\u30f3\u30d7\u30eb\n```/etc/haproxy/haproxy.cfg\nglobal\n        log         127.0.0.1 local6\n        maxconn     16384\n        chroot      /var/lib/haproxy\n        uid 99\n        gid 99\n        daemon\n#       debug\n        spread-checks 5\n        nbproc      4 #CPU\u306e\u30b3\u30a2\u6570\u306b\u5408\u308f\u305b\u308b\n\ndefaults\n        log             global\n        option          tcplog\n        mode tcp\n        retries 2\n        timeout connect 5s\n        timeout client  20s\n        timeout server  20s\n        timeout check   10s\n\nlisten http\n        bind *:80\n        mode tcp\n        balance roundrobin\n        option  log-health-checks\n        option  tcp-smart-connect\n        option  contstats\n        server  read1 192.168.1.11:80 check port 80 inter 30000 fall 1\n        server  read2 192.168.1.12:80 check port 80 inter 30000 fall 1\n```\n", "tags": ["haproxy"]}