{"context": "\n\n\u76ee\u6a19\n\nCoffeeScript\u3067\u66f8\u304d\u305f\u3044\u306e\u3067*.cofee\u3092\u30a6\u30a9\u30c3\u30c1\u3057\u3066\u81ea\u52d5\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u305b\u305f\u3044\nSass\u3068\u304b\u3082\u4f7f\u3044\u305f\u3044\nmocha\u3092\u30d6\u30e9\u30a6\u30b6\u3067\u8d70\u3089\u305b\u305f\u3044\u306e\u3067\u30c6\u30b9\u30c8\u7528\u306e\u30b5\u30fc\u30d0\u30fc\u3092express\u3067\u69cb\u7bc9\u3059\u308b\nLiveReload\u3067\u30c6\u30b9\u30c8\u7528\u306e\u30da\u30fc\u30b8\u3092\u66f4\u65b0\u3055\u305b\u308b\n\u4ee5\u4e0a\u306e\u30bf\u30b9\u30af\u3092grunt\u30b3\u30de\u30f3\u30c9\u4e00\u767a\u3067\u7acb\u3061\u4e0a\u3052\u305f\u3044\n\u305d\u306e\u74b0\u5883\u69cb\u7bc9\u3092npm install\u3092\u542b\u3080\u6700\u4f4e\u9650\u306e\u6e96\u5099\u3067\u6e08\u307e\u305b\u305f\u3044\n\n\n\u69cb\u6210\u65b9\u91dd\n.\n\u251c\u2500\u2500 devel\n\u2502   \u251c\u2500\u2500 coffee\n\u2502   \u251c\u2500\u2500 node_modules\n\u2502   \u251c\u2500\u2500 sass\n\u2502   \u2514\u2500\u2500 test\n\u2502       \u251c\u2500\u2500 coffee\n\u2502       \u2514\u2500\u2500 js\n\u2514\u2500\u2500 static\n    \u251c\u2500\u2500 css\n    \u251c\u2500\u2500 img\n    \u251c\u2500\u2500 js\n    \u2514\u2500\u2500 vendors\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u3063\u3068\ndevel/cofee -> static/js\ndevel/sass -> static/css\ntest/coffee -> test/js\n\u306b\u81ea\u52d5\u7684\u306b\u914d\u7f6e\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\ndevel/node_moduls\u306fgrunt\u3067\u4f7f\u3046\u30e2\u30b8\u30e5\u30fc\u30eb\u3001static/vendors\u306b\u306fbower\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b3rd\u30d1\u30fc\u30c6\u30a3\u30fc\u306e\u30d5\u30a1\u30a4\u30eb\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30bd\u30fc\u30b9\nhttps://github.com/keitaoouchi/grunt-tdd-sample\n\n\u8a66\u3059\n\u4e8b\u524d\u306bbundler\u3001bower\u306e\u5c0e\u5165\u304c\u5fc5\u8981\u3002\nnpm install -g bower grunt-cli\n\ngem install bundler\n\ngit clone https://github.com/keitaoouchi/grunt-tdd-sample\ncd grunt-tdd-sample/devel\nnpm install\ngrunt setup\ngrunt\n\n\u305d\u3057\u3066\nhttp://localhost:3000/hoge/fuga\n\u3078\u3002\n\ngrunt\u306e\u74b0\u5883\u3092\u4f5c\u308b\u305f\u3081\u306epackage.json\ndevel\u4ee5\u4e0b\u306b\u914d\u7f6e\u3057\u3066npm install\n\npackage.json\n{\n  \"name\": \"static\",\n  \"version\": \"0.0.1\",\n  \"devDependencies\": {\n    \"grunt\": \"~0.4.1\",\n    \"grunt-contrib-compress\": \"~0.5.1\",\n    \"grunt-contrib-watch\": \"~0.5.1\",\n    \"grunt-contrib-coffee\": \"~0.7.0\",\n    \"grunt-notify\": \"~0.2.7\",\n    \"grunt-contrib-compass\": \"~0.5.0\",\n    \"grunt-express-server\": \"~0.4.2\",\n    \"grunt-exec\": \"~0.4.2\",\n    \"express\": \"~3.3.4\",\n    \"jade\": \"~0.34.1\",\n    \"mocha\": \"~1.12.0\",\n    \"sinon\": \"~1.7.3\",\n    \"chai\": \"~1.7.2\"\n  },\n  \"directories\": {\n    \"test\": \"test\"\n  }\n}\n\n\n\ncompass/sass\u3092\u5c0e\u5165\u3059\u308b\u305f\u3081\u306eGemfile\n\u5c0e\u5165\u306fgrunt\u306b\u3084\u3089\u305b\u308b\u306e\u3067Gemfile\u3092devel\u76f4\u4e0b\u306b\u8cbc\u308b\u3060\u3051\n\nGemfile\nsource 'http://rubygems.org'\n\ngem 'sass'\ngem 'compass'\n\n\n\nbower\u3067\u5c0e\u5165\u3059\u308b3rd\u30d1\u30fc\u30c6\u30fc\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092static/vendors\u306b\u914d\u7f6e\u3059\u308b.bowerrc\ndevel\u76f4\u4e0b\u306b\u914d\u7f6e\n\n.bowerrc\n{\n  \"directory\": \"./../static/vendors\"\n}\n\n\n\nbower\u3067\u5c0e\u5165\u3059\u308b\u305f\u3081\u306ebower.json\u306e\u4e00\u4f8b\ndevel\u76f4\u4e0b\u306b\u914d\u7f6e\u3059\u308b\n\nbower.json\n{\n  \"name\": \"static\",\n  \"version\": \"0.0.1\",\n  \"ignore\": [\n    \"**/.*\",\n    \"node_modules\",\n    \"components\"\n  ],\n  \"dependencies\": {\n    \"jquery\": \"~2.0.0\",\n    \"backbone-amd\": \"~1.0.0\",\n    \"requirejs-domready\": \"~2.0.1\",\n    \"requirejs\": \"~2.1.5\",\n    \"underscore-amd\": \"~1.4.4\"\n  },\n  \"devDependencies\": {\n    \"mocha\": \"~1.11.0\",\n    \"chai\": \"~1.6.1\",\n    \"sinon\": \"http://sinonjs.org/releases/sinon-1.7.1.js\"\n  }\n}\n\n\n\nGruntfile.coffee\n\u3084\u306f\u308adevel\u76f4\u4e0b\u306b\u914d\u7f6e\n\nGruntfile.coffee\nmodule.exports = (grunt) ->\n  grunt.loadNpmTasks 'grunt-contrib-coffee'\n  grunt.loadNpmTasks 'grunt-contrib-watch'\n  grunt.loadNpmTasks 'grunt-contrib-compass'\n  grunt.loadNpmTasks 'grunt-express-server'\n  grunt.loadNpmTasks 'grunt-notify'\n  grunt.loadNpmTasks 'grunt-exec'\n\n  grunt.initConfig(\n\n    #\u69cb\u6587\u30a8\u30e9\u30fc\u3068\u304b\u3042\u3063\u3066\u5931\u6557\u3059\u308b\u3068\u901a\u77e5\u3059\u308b\n    notify_hooks:\n      options:\n        enabled: true\n\n    #compass/sass\u5c0e\u5165\u3068bower install\u3059\u308b\n    exec:\n      bundle:\n        command: 'bundle'\n      bower:\n        command: 'rm -rf ./../static/vendors && bower install'\n\n    #express\u3067\u30c6\u30b9\u30c8\u7528\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3061\u4e0a\u3052\u308b\n    express:\n      dev:\n        options:\n          script: 'test/server.js'\n\n    #devel/coffee => static/js\u3001devel/test/coffee => devel/test/js\n    coffee:\n      devel:\n        options:\n          bare: true\n        files: [\n          {\n            expand: true\n            cwd: './coffee'\n            src: '**/*.coffee'\n            dest: './../static/js'\n            ext: '.js'\n          },\n          {\n            expand: true\n            cwd: './test/coffee'\n            src: '**/*.coffee'\n            dest: './test/js'\n            ext: '.js'\n          }\n        ]\n\n    #sass\u3064\u304b\u3046\n    compass:\n      dev:\n        options:\n          bundleExec: true\n          sassDir: 'sass'\n          cssDir: './../static/css'\n      test:\n        options:\n          bundleExec: true\n          sassDir: 'test/sass'\n          cssDir: 'test/css'\n\n    #\u76e3\u8996: \u4e00\u500b\u3067\u3082\u5909\u66f4\u3042\u3063\u305f\u3089\u5168\u90e8\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u76f4\u3057\u3066\u3066\u30c0\u30b5\u3057\n    watch:\n      devel:\n        files: ['test/coffee/**/*.coffee', 'test/sass/**/*.sass', 'coffee/**/*.coffee', 'sass/**/*.sass']\n        tasks: ['compass:dev', 'compass:test', 'coffee:devel']\n      options:\n        # \u6b7b\u3093\u3067\u3082\u6b7b\u306a\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n        nospawn: false\n        # \u5b09\u3057\u3044\n        livereload: true\n  )\n\n  #\u74b0\u5883\u4f5c\u3063\u3066\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u305f\u3061\u3042\u3052\u3066\u76e3\u8996\u4f53\u5236\u306b\u5165\u308b\n  grunt.registerTask 'default', ['coffee:devel', 'compass:dev', 'compass:test', 'express:dev', 'watch:devel']\n  #\u74b0\u5883\u4f5c\u3063\u3066\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\n  grunt.registerTask 'compile', ['exec:bundle', 'exec:bower', 'coffee:devel', 'compass:dev']\n  #\u74b0\u5883\u4f5c\u308b\u3060\u3051\n  grunt.registerTask 'setup', ['exec:bundle', 'exec:bower']\n\n\n\ndevel/test/server.js\nmocha\u3092\u30d6\u30e9\u30a6\u30b6\u3067\u8d70\u3089\u305b\u308b\u305f\u3081\u306e\u30b5\u30fc\u30d0\u30fc\u3092express\u3067\u7c21\u5358\u306b\u3002\n\ntest/server.js\nvar express = require('express');\nvar http = require('http');\n\nvar app = express();\n\napp.configure(function(){\n  app.set('port', process.env.PORT || 8080);\n  app.set('view engine', 'jade');\n  app.use(express.static('./../'));\n});\n\n\napp.get(/(.+)(\\/.+)?/, function(req, res){\n  var path = req.params[0].replace('/', '');\n  res.render(__dirname + '/template', {target: path});\n});\n\nhttp.createServer(app).listen(app.get('port'), function(){\n  console.log(\"Express server listening on port \" + app.get('port'));\n});\n\n\ngrunt\u306ewatch\u30bf\u30b9\u30af\u3067\u76e3\u8996\u3055\u308c\u3066\u308b\u306e\u3067\u3001devel/test\u4ee5\u4e0b\u306bcoffee/hoge/fuga-spec.coffee\u3068\u304b\u4f5c\u3063\u3068\u304f\u3068fuga-spec.coffee\u304c\u66f4\u65b0\u3055\u308c\u308b\u305f\u3073\u306bjs/hoge/fuga-spec.js\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u3066\u3001\u4e0a\u8a18\u30b5\u30fc\u30d0\u30fc\u304c\u7a3c\u50cd\u3057\u3066\u308b\u306e\u3067localhost:3000/hoge/fuga\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u30d6\u30e9\u30a6\u30b6\u306b\u30c6\u30b9\u30c8\u7d50\u679c\u304c\u8868\u793a\u3055\u308c\u308b\u3068\u3068\u3082\u306bLiveReload\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u6b21\u306e\u30c6\u30b9\u30c8\u7d50\u679c\u304c\u968f\u6642\u66f4\u65b0\u3055\u308c\u308b\u3002\n\nrequire.js\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092coffee\u3067\u66f8\u304f\n\ndevel/coffee/config.coffee\nrequire =\n  baseUrl: '/static'\n  paths:\n    jquery: 'vendors/jquery/jquery.min'\n    underscore: 'vendors/underscore-amd/underscore-min'\n    backbone: 'vendors/backbone-amd/backbone-min'\n    domReady: 'vendors/requirejs-domready/domReady'\n  shim:\n    underscore:\n      exports: '_'\n    backbone:\n      deps: [\"jquery\", \"underscore\"]\n      exports: \"Backbone\"\n\n\n\ndevel/test/coffee/spec-config.coffee\nrequire_test =\n  paths:\n    mocha: 'vendors/mocha/mocha'\n    chai: 'vendors/chai/chai'\n    sinon: 'vendors/sinon/index'\n  shim:\n    mocha:\n      exports: 'mocha'\n    chai:\n      exports: 'chai'\n    sinon:\n      exports: 'sinon'\n\nrequire = window.require || {}\n\nfor key, val of require_test.paths\n  require.paths[key] = val\nfor key, val of require_test.shim\n  require.shim[key] = val\n\n\n\n\u30c6\u30b9\u30c8\u5bfe\u8c61\u3068\u306a\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u4f8b\n\u3082\u306e\u3059\u3054\u304f\u3069\u3046\u3067\u3082\u3044\u3044\u611f\u3058\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092Requirejs\u3067\u4f5c\u308a\u307e\u3059\u3002\n\ndevel/hoge/fuga.coffee\ndefine(\n  'js/hoge/fuga',\n  ['jquery', 'underscore', 'backbone'],\n  ($, _, Backbone) ->\n    'use strict'\n\n    App =\n      Models: {}\n      Collections: {}\n      Views: {}\n\n    class App.Models.Fuga extends Backbone.Model\n\n      initialize: (obj) ->\n        @name = obj.name\n\n    class App.Collections.Fugas extends Backbone.Collection\n\n      model: App.Models.Fuga\n\n    class App.Views.FugaView extends Backbone.View\n\n      initialize: ->\n        @listenTo(@collection, 'sync', @render)\n        @collection.fetch()\n\n      render: ->\n\n    App.initialize = ->\n\n\n    if Object.freeze? then Object.freeze App else App\n)\n\n\n\n\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30c6\u30b9\u30c8\u3059\u308bspec\u4f8b\n\ndevel/test/coffee/hoge/fuga-spec.coffee\nrequire(['js/hoge/fuga', 'backbone', 'mocha', 'chai', 'sinon'], (App, Backbone, mocha, chai, sinon) ->\n  'use strict'\n\n  mocha.ui 'bdd'\n\n  chai.should()\n\n  describe 'App', ->\n    it 'App.Models.Fuga\u306fBackbone.Model\u3092\u7d99\u627f', ->\n      App.Models.Fuga.prototype.should.be.an.instanceof Backbone.Model\n    it 'App.Collections.Fugas\u306fBackbone.Collection\u3092\u7d99\u627f', ->\n      App.Collections.Fugas.prototype.should.be.an.instanceof Backbone.Collection\n    it 'App.Views.FugaView\u306fBackbone.View\u3092\u7d99\u627f', ->\n      App.Views.FugaView.prototype.should.be.an.instanceof Backbone.View\n\n  describe 'App.Models.Fuga', ->\n\n    fuga = null\n    before ->\n      fuga = new App.Models.Fuga({name: 'fuga'})\n\n    it 'fuga\u306ename\u304cfuga', ->\n      fuga.name.should.be.equals 'fuga'\n\n  describe 'App.View.FugaView', ->\n\n    it '\u521d\u671f\u5316\u6642\u306bcollection\u3092fetch\u3059\u308b', ->\n      iamspy = new App.Collections.Fugas()\n      iamspy.fetch = sinon.spy()\n      new App.Views.FugaView collection: iamspy\n      iamspy.fetch.called.should.be.true\n\n  mocha.run()\n\n)\n\n\n\nmocha\u3067\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306ejade\u30c6\u30f3\u30d7\u30ec\n\ntemplate.jade\ndoctype 5\nhtml\n  head\n    title (^q^) < #{target} \u306e\u3066\u3059\u3068\n    link(rel='stylesheet', href='/static/vendors/mocha/mocha.css')\n    link(rel='stylesheet', href='/devel/test/css/style.css')\n\n  body\n    div(class='title')\n      h1 (^q^) < #{target} \u306e\u3066\u3059\u3068\n    div(id='mocha')\n    script(src='/static/js/config.js')\n    script(src='/devel/test/js/spec-config.js')\n    script(src='/static/vendors/requirejs/require.js')\n    script(src='/devel/test/js/#{target}-spec.js')\n\n\n\n\u30c6\u30b9\u30c8\u7d50\u679c\u306e\u30b5\u30f3\u30d7\u30eb\u753b\u50cf\n\n\n## \u76ee\u6a19\n* CoffeeScript\u3067\u66f8\u304d\u305f\u3044\u306e\u3067*.cofee\u3092\u30a6\u30a9\u30c3\u30c1\u3057\u3066\u81ea\u52d5\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u305b\u305f\u3044\n* Sass\u3068\u304b\u3082\u4f7f\u3044\u305f\u3044\n* mocha\u3092\u30d6\u30e9\u30a6\u30b6\u3067\u8d70\u3089\u305b\u305f\u3044\u306e\u3067\u30c6\u30b9\u30c8\u7528\u306e\u30b5\u30fc\u30d0\u30fc\u3092express\u3067\u69cb\u7bc9\u3059\u308b\n* LiveReload\u3067\u30c6\u30b9\u30c8\u7528\u306e\u30da\u30fc\u30b8\u3092\u66f4\u65b0\u3055\u305b\u308b\n* \u4ee5\u4e0a\u306e\u30bf\u30b9\u30af\u3092grunt\u30b3\u30de\u30f3\u30c9\u4e00\u767a\u3067\u7acb\u3061\u4e0a\u3052\u305f\u3044\n* \u305d\u306e\u74b0\u5883\u69cb\u7bc9\u3092npm install\u3092\u542b\u3080\u6700\u4f4e\u9650\u306e\u6e96\u5099\u3067\u6e08\u307e\u305b\u305f\u3044\n\n## \u69cb\u6210\u65b9\u91dd\n```\n.\n\u251c\u2500\u2500 devel\n\u2502   \u251c\u2500\u2500 coffee\n\u2502   \u251c\u2500\u2500 node_modules\n\u2502   \u251c\u2500\u2500 sass\n\u2502   \u2514\u2500\u2500 test\n\u2502       \u251c\u2500\u2500 coffee\n\u2502       \u2514\u2500\u2500 js\n\u2514\u2500\u2500 static\n    \u251c\u2500\u2500 css\n    \u251c\u2500\u2500 img\n    \u251c\u2500\u2500 js\n    \u2514\u2500\u2500 vendors\n```\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u3063\u3068\ndevel/cofee -> static/js\ndevel/sass -> static/css\ntest/coffee -> test/js\n\u306b\u81ea\u52d5\u7684\u306b\u914d\u7f6e\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\ndevel/node_moduls\u306fgrunt\u3067\u4f7f\u3046\u30e2\u30b8\u30e5\u30fc\u30eb\u3001static/vendors\u306b\u306fbower\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b3rd\u30d1\u30fc\u30c6\u30a3\u30fc\u306e\u30d5\u30a1\u30a4\u30eb\u3002\n\n## \u30b5\u30f3\u30d7\u30eb\u30bd\u30fc\u30b9\n\nhttps://github.com/keitaoouchi/grunt-tdd-sample\n\n## \u8a66\u3059\n\n\u4e8b\u524d\u306bbundler\u3001bower\u306e\u5c0e\u5165\u304c\u5fc5\u8981\u3002\n\n```bash\nnpm install -g bower grunt-cli\n```\n\n```bash\ngem install bundler\n```\n\n```bash\ngit clone https://github.com/keitaoouchi/grunt-tdd-sample\ncd grunt-tdd-sample/devel\nnpm install\ngrunt setup\ngrunt\n```\n\n\u305d\u3057\u3066\nhttp://localhost:3000/hoge/fuga\n\u3078\u3002\n\n## grunt\u306e\u74b0\u5883\u3092\u4f5c\u308b\u305f\u3081\u306epackage.json\ndevel\u4ee5\u4e0b\u306b\u914d\u7f6e\u3057\u3066npm install\n\n```json:package.json\n{\n  \"name\": \"static\",\n  \"version\": \"0.0.1\",\n  \"devDependencies\": {\n    \"grunt\": \"~0.4.1\",\n    \"grunt-contrib-compress\": \"~0.5.1\",\n    \"grunt-contrib-watch\": \"~0.5.1\",\n    \"grunt-contrib-coffee\": \"~0.7.0\",\n    \"grunt-notify\": \"~0.2.7\",\n    \"grunt-contrib-compass\": \"~0.5.0\",\n    \"grunt-express-server\": \"~0.4.2\",\n    \"grunt-exec\": \"~0.4.2\",\n    \"express\": \"~3.3.4\",\n    \"jade\": \"~0.34.1\",\n    \"mocha\": \"~1.12.0\",\n    \"sinon\": \"~1.7.3\",\n    \"chai\": \"~1.7.2\"\n  },\n  \"directories\": {\n    \"test\": \"test\"\n  }\n}\n```\n\n## compass/sass\u3092\u5c0e\u5165\u3059\u308b\u305f\u3081\u306eGemfile\n\u5c0e\u5165\u306fgrunt\u306b\u3084\u3089\u305b\u308b\u306e\u3067Gemfile\u3092devel\u76f4\u4e0b\u306b\u8cbc\u308b\u3060\u3051\n\n```ruby:Gemfile\nsource 'http://rubygems.org'\n\ngem 'sass'\ngem 'compass'\n```\n\n## bower\u3067\u5c0e\u5165\u3059\u308b3rd\u30d1\u30fc\u30c6\u30fc\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092static/vendors\u306b\u914d\u7f6e\u3059\u308b.bowerrc\ndevel\u76f4\u4e0b\u306b\u914d\u7f6e\n\n```json:.bowerrc\n{\n  \"directory\": \"./../static/vendors\"\n}\n```\n\n## bower\u3067\u5c0e\u5165\u3059\u308b\u305f\u3081\u306ebower.json\u306e\u4e00\u4f8b\ndevel\u76f4\u4e0b\u306b\u914d\u7f6e\u3059\u308b\n\n```json:bower.json\n{\n  \"name\": \"static\",\n  \"version\": \"0.0.1\",\n  \"ignore\": [\n    \"**/.*\",\n    \"node_modules\",\n    \"components\"\n  ],\n  \"dependencies\": {\n    \"jquery\": \"~2.0.0\",\n    \"backbone-amd\": \"~1.0.0\",\n    \"requirejs-domready\": \"~2.0.1\",\n    \"requirejs\": \"~2.1.5\",\n    \"underscore-amd\": \"~1.4.4\"\n  },\n  \"devDependencies\": {\n    \"mocha\": \"~1.11.0\",\n    \"chai\": \"~1.6.1\",\n    \"sinon\": \"http://sinonjs.org/releases/sinon-1.7.1.js\"\n  }\n}\n```\n\n## Gruntfile.coffee\n\u3084\u306f\u308adevel\u76f4\u4e0b\u306b\u914d\u7f6e\n\n```coffeescript:Gruntfile.coffee\nmodule.exports = (grunt) ->\n  grunt.loadNpmTasks 'grunt-contrib-coffee'\n  grunt.loadNpmTasks 'grunt-contrib-watch'\n  grunt.loadNpmTasks 'grunt-contrib-compass'\n  grunt.loadNpmTasks 'grunt-express-server'\n  grunt.loadNpmTasks 'grunt-notify'\n  grunt.loadNpmTasks 'grunt-exec'\n\n  grunt.initConfig(\n\n    #\u69cb\u6587\u30a8\u30e9\u30fc\u3068\u304b\u3042\u3063\u3066\u5931\u6557\u3059\u308b\u3068\u901a\u77e5\u3059\u308b\n    notify_hooks:\n      options:\n        enabled: true\n\n    #compass/sass\u5c0e\u5165\u3068bower install\u3059\u308b\n    exec:\n      bundle:\n        command: 'bundle'\n      bower:\n        command: 'rm -rf ./../static/vendors && bower install'\n\n    #express\u3067\u30c6\u30b9\u30c8\u7528\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3061\u4e0a\u3052\u308b\n    express:\n      dev:\n        options:\n          script: 'test/server.js'\n\n    #devel/coffee => static/js\u3001devel/test/coffee => devel/test/js\n    coffee:\n      devel:\n        options:\n          bare: true\n        files: [\n          {\n            expand: true\n            cwd: './coffee'\n            src: '**/*.coffee'\n            dest: './../static/js'\n            ext: '.js'\n          },\n          {\n            expand: true\n            cwd: './test/coffee'\n            src: '**/*.coffee'\n            dest: './test/js'\n            ext: '.js'\n          }\n        ]\n\n    #sass\u3064\u304b\u3046\n    compass:\n      dev:\n        options:\n          bundleExec: true\n          sassDir: 'sass'\n          cssDir: './../static/css'\n      test:\n        options:\n          bundleExec: true\n          sassDir: 'test/sass'\n          cssDir: 'test/css'\n\n    #\u76e3\u8996: \u4e00\u500b\u3067\u3082\u5909\u66f4\u3042\u3063\u305f\u3089\u5168\u90e8\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u76f4\u3057\u3066\u3066\u30c0\u30b5\u3057\n    watch:\n      devel:\n        files: ['test/coffee/**/*.coffee', 'test/sass/**/*.sass', 'coffee/**/*.coffee', 'sass/**/*.sass']\n        tasks: ['compass:dev', 'compass:test', 'coffee:devel']\n      options:\n        # \u6b7b\u3093\u3067\u3082\u6b7b\u306a\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n        nospawn: false\n        # \u5b09\u3057\u3044\n        livereload: true\n  )\n\n  #\u74b0\u5883\u4f5c\u3063\u3066\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u305f\u3061\u3042\u3052\u3066\u76e3\u8996\u4f53\u5236\u306b\u5165\u308b\n  grunt.registerTask 'default', ['coffee:devel', 'compass:dev', 'compass:test', 'express:dev', 'watch:devel']\n  #\u74b0\u5883\u4f5c\u3063\u3066\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\n  grunt.registerTask 'compile', ['exec:bundle', 'exec:bower', 'coffee:devel', 'compass:dev']\n  #\u74b0\u5883\u4f5c\u308b\u3060\u3051\n  grunt.registerTask 'setup', ['exec:bundle', 'exec:bower']\n```\n\n## devel/test/server.js\n\nmocha\u3092\u30d6\u30e9\u30a6\u30b6\u3067\u8d70\u3089\u305b\u308b\u305f\u3081\u306e\u30b5\u30fc\u30d0\u30fc\u3092express\u3067\u7c21\u5358\u306b\u3002\n\n```js:test/server.js\nvar express = require('express');\nvar http = require('http');\n\nvar app = express();\n\napp.configure(function(){\n  app.set('port', process.env.PORT || 8080);\n  app.set('view engine', 'jade');\n  app.use(express.static('./../'));\n});\n\n\napp.get(/(.+)(\\/.+)?/, function(req, res){\n  var path = req.params[0].replace('/', '');\n  res.render(__dirname + '/template', {target: path});\n});\n\nhttp.createServer(app).listen(app.get('port'), function(){\n  console.log(\"Express server listening on port \" + app.get('port'));\n});\n```\n\ngrunt\u306ewatch\u30bf\u30b9\u30af\u3067\u76e3\u8996\u3055\u308c\u3066\u308b\u306e\u3067\u3001devel/test\u4ee5\u4e0b\u306bcoffee/hoge/fuga-spec.coffee\u3068\u304b\u4f5c\u3063\u3068\u304f\u3068fuga-spec.coffee\u304c\u66f4\u65b0\u3055\u308c\u308b\u305f\u3073\u306bjs/hoge/fuga-spec.js\u306b\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u308c\u3066\u3001\u4e0a\u8a18\u30b5\u30fc\u30d0\u30fc\u304c\u7a3c\u50cd\u3057\u3066\u308b\u306e\u3067localhost:3000/hoge/fuga\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u30d6\u30e9\u30a6\u30b6\u306b\u30c6\u30b9\u30c8\u7d50\u679c\u304c\u8868\u793a\u3055\u308c\u308b\u3068\u3068\u3082\u306bLiveReload\u3067\u30b3\u30f3\u30d1\u30a4\u30eb\u6b21\u306e\u30c6\u30b9\u30c8\u7d50\u679c\u304c\u968f\u6642\u66f4\u65b0\u3055\u308c\u308b\u3002\n\n## require.js\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092coffee\u3067\u66f8\u304f\n\n```coffeescript:devel/coffee/config.coffee\nrequire =\n  baseUrl: '/static'\n  paths:\n    jquery: 'vendors/jquery/jquery.min'\n    underscore: 'vendors/underscore-amd/underscore-min'\n    backbone: 'vendors/backbone-amd/backbone-min'\n    domReady: 'vendors/requirejs-domready/domReady'\n  shim:\n    underscore:\n      exports: '_'\n    backbone:\n      deps: [\"jquery\", \"underscore\"]\n      exports: \"Backbone\"\n```\n\n```coffeescript:devel/test/coffee/spec-config.coffee\nrequire_test =\n  paths:\n    mocha: 'vendors/mocha/mocha'\n    chai: 'vendors/chai/chai'\n    sinon: 'vendors/sinon/index'\n  shim:\n    mocha:\n      exports: 'mocha'\n    chai:\n      exports: 'chai'\n    sinon:\n      exports: 'sinon'\n\nrequire = window.require || {}\n\nfor key, val of require_test.paths\n  require.paths[key] = val\nfor key, val of require_test.shim\n  require.shim[key] = val\n```\n\n## \u30c6\u30b9\u30c8\u5bfe\u8c61\u3068\u306a\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u4f8b\n\n\u3082\u306e\u3059\u3054\u304f\u3069\u3046\u3067\u3082\u3044\u3044\u611f\u3058\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092Requirejs\u3067\u4f5c\u308a\u307e\u3059\u3002\n\n```coffeescript:devel/hoge/fuga.coffee\ndefine(\n  'js/hoge/fuga',\n  ['jquery', 'underscore', 'backbone'],\n  ($, _, Backbone) ->\n    'use strict'\n\n    App =\n      Models: {}\n      Collections: {}\n      Views: {}\n\n    class App.Models.Fuga extends Backbone.Model\n\n      initialize: (obj) ->\n        @name = obj.name\n\n    class App.Collections.Fugas extends Backbone.Collection\n\n      model: App.Models.Fuga\n\n    class App.Views.FugaView extends Backbone.View\n\n      initialize: ->\n        @listenTo(@collection, 'sync', @render)\n        @collection.fetch()\n\n      render: ->\n\n    App.initialize = ->\n\n\n    if Object.freeze? then Object.freeze App else App\n)\n```\n\n## \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30c6\u30b9\u30c8\u3059\u308bspec\u4f8b\n\n```coffeescript:devel/test/coffee/hoge/fuga-spec.coffee\nrequire(['js/hoge/fuga', 'backbone', 'mocha', 'chai', 'sinon'], (App, Backbone, mocha, chai, sinon) ->\n  'use strict'\n\n  mocha.ui 'bdd'\n\n  chai.should()\n\n  describe 'App', ->\n    it 'App.Models.Fuga\u306fBackbone.Model\u3092\u7d99\u627f', ->\n      App.Models.Fuga.prototype.should.be.an.instanceof Backbone.Model\n    it 'App.Collections.Fugas\u306fBackbone.Collection\u3092\u7d99\u627f', ->\n      App.Collections.Fugas.prototype.should.be.an.instanceof Backbone.Collection\n    it 'App.Views.FugaView\u306fBackbone.View\u3092\u7d99\u627f', ->\n      App.Views.FugaView.prototype.should.be.an.instanceof Backbone.View\n\n  describe 'App.Models.Fuga', ->\n\n    fuga = null\n    before ->\n      fuga = new App.Models.Fuga({name: 'fuga'})\n\n    it 'fuga\u306ename\u304cfuga', ->\n      fuga.name.should.be.equals 'fuga'\n\n  describe 'App.View.FugaView', ->\n\n    it '\u521d\u671f\u5316\u6642\u306bcollection\u3092fetch\u3059\u308b', ->\n      iamspy = new App.Collections.Fugas()\n      iamspy.fetch = sinon.spy()\n      new App.Views.FugaView collection: iamspy\n      iamspy.fetch.called.should.be.true\n\n  mocha.run()\n\n)\n```\n\n## mocha\u3067\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306ejade\u30c6\u30f3\u30d7\u30ec\n\n```jade:template.jade\ndoctype 5\nhtml\n  head\n    title (^q^) < #{target} \u306e\u3066\u3059\u3068\n    link(rel='stylesheet', href='/static/vendors/mocha/mocha.css')\n    link(rel='stylesheet', href='/devel/test/css/style.css')\n\n  body\n    div(class='title')\n      h1 (^q^) < #{target} \u306e\u3066\u3059\u3068\n    div(id='mocha')\n    script(src='/static/js/config.js')\n    script(src='/devel/test/js/spec-config.js')\n    script(src='/static/vendors/requirejs/require.js')\n    script(src='/devel/test/js/#{target}-spec.js')\n```\n\n## \u30c6\u30b9\u30c8\u7d50\u679c\u306e\u30b5\u30f3\u30d7\u30eb\u753b\u50cf\n\n![grunt-tdd.png](https://qiita-image-store.s3.amazonaws.com/0/5806/a13ddc90-7b7a-c85e-f530-ddb9661d002c.png)\n\n\n\n\n", "tags": ["bower", "grunt", "CoffeeScript", "RequireJS", "mocha"]}