{"context": " More than 1 year has passed since last update.A/B\u30c6\u30b9\u30c8\u306e\u8a55\u4fa1\u3092\u7c21\u5358\u306b\u30d6\u30e9\u30a6\u30b6\u4e0a\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3044\u3002\u3068\u3044\u3046\u3053\u3068\u3067\u5b9f\u88c5\u3057\u3066\u307f\u305f\u3002\n\u305d\u3046\u3044\u3048\u3070Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u3082\u30ab\u30a42\u4e57\u691c\u5b9a\u306f\u3067\u304d\u306a\u3044\u306e\u306d\u3002\n\u3053\u308c\u3092\u4f7f\u3048\u3070\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u5024\u3092\u6301\u3063\u3066\u304d\u3066\u7c21\u5358\u306b\u691c\u5b9a\u3067\u304d\u308b\u304b\u3082\u3002\n\nA/B\u30c6\u30b9\u30c8\u306e\u6280\u8853\u7684\u6574\u7406\nA/B\u30c6\u30b9\u30c8\uff082\u7fa4\u306e\u6bd4\u7387\u306e\u5dee\u306e\u691c\u5b9a\uff09\u3092\u3059\u308b\u3068\u304d\u3001\u6bd4\u7387\u3092\u6271\u3046\u306e\u30672\u9805\u5206\u5e03\u3092\u4f7f\u3046\u65b9\u6cd5\u3082\u3042\u308b\u304c\u3001\u30af\u30ed\u30b9\u8868\u3067\u6271\u3046\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\u305f\u3068\u3048\u3070\n\n\n\ncreative\nimp\nclick\n\n\n\n\nA\n$x_0$\n$x_1$\n\n\nB\n$x_2$\n$x_3$\n\n\n\n\u306b\u304a\u3044\u3066\n\u30af\u30ea\u30a8\u30a4\u30c6\u30a3\u30d6A\u3068B\u3068\u3067CTR\u304c\u5909\u308f\u3089\u306a\u3044\n\n\u3059\u306a\u308f\u3061\n\u30af\u30ea\u30a8\u30a4\u30c6\u30a3\u30d6\u306e\u9055\u3044\uff08\u884c\uff09\u3068\u30af\u30ea\u30c3\u30af\u306e\u3057\u3084\u3059\u3055\uff08\u5217\uff09\u306f\u72ec\u7acb\n\n\u304b\u3069\u3046\u304b\u3092\u691c\u5b9a\u3057\u305f\u3044\u3002\u4e00\u822c\u306b\u691c\u5b9a\u3067\u7528\u3044\u3089\u308c\u308b\u30af\u30ed\u30b9\u8868\u306f\n\n\n\n\u30b0\u30eb\u30fc\u30d7\n\u25cb\u25cb\u3059\u308b\n\u25cb\u25cb\u3057\u306a\u3044\n\n\n\n\nA\n\n\n\n\nB\n\n\n\n\n\n\u3068\u3044\u3046\u5f62\u5f0f\u306b\u306a\u308b\u306e\u3067\u3001\n\u30af\u30ea\u30c3\u30af\u306e\u3057\u3084\u3059\u3055\u306f\u300c\u30af\u30ea\u30c3\u30af\u3059\u308b or \u30af\u30ea\u30c3\u30af\u3057\u306a\u3044\u300d\u3060\u304b\u3089\n\n\n\ncreative\n\u30af\u30ea\u30c3\u30af\u3059\u308b\n\u30af\u30ea\u30c3\u30af\u3057\u306a\u3044\nimp\uff08\u5468\u8fba\u5ea6\u6570\uff09\n\n\n\n\nA\n$x_0-x_1$\n$x_1$\n$x_0$\n\n\nB\n$x_2-x_3$\n$x_3$\n$x_2$\n\n\n\n\u3068\u3044\u3046\u30af\u30ed\u30b9\u8868\u306e\u72ec\u7acb\u6027\u306e\u691c\u5b9a\u3092\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\n\u5b9f\u88c5\n/**\n * Returns p-value of x.\n * @param {Array} x [[nTrial1, nOccurrence1], [nTrial2, nOccurrence2]]\n * @returns {Number} p-value\n */\nfunction getChisq(x){\n\n    if(x !== undefined){\n\n        // Observations\n        var o = [\n            x[0][0] - x[0][1],\n            x[0][1],\n            x[1][0] - x[1][1],\n            x[1][1],\n        ];\n\n        var s = o[0]+o[1]+o[2]+o[3];\n\n        // Expectations\n        var e = [\n            (o[0]+o[1]) * (o[0]+o[2]) / s,\n            (o[0]+o[1]) * (o[1]+o[3]) / s,\n            (o[2]+o[3]) * (o[0]+o[2]) / s,\n            (o[2]+o[3]) * (o[1]+o[3]) / s,\n        ];\n\n        var chisq = 0;\n        for (i=0; i<=3; i++){\n            chisq += (o[i] - e[i]) * (o[i] - e[i]) / e[i];\n        }\n\n    return chisq;\n\n    }\n}\n\n// Cumulative distribution function of Normal distribution\n// See http://qiita.com/gigamori/items/e17e6f9faffb78822c56\nfunction cdf(x) {\n\n    // constants\n    var p  =  0.2316419;\n    var b1 =  0.31938153;\n    var b2 = -0.356563782;\n    var b3 =  1.781477937;\n    var b4 = -1.821255978;\n    var b5 =  1.330274429;\n\n    var t = 1 / (1 + p * Math.abs(x));\n    var Z = Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n    var y = 1 - Z * ((((b5 * t + b4) * t + b3) * t + b2) * t + b1) * t;\n\n    return (x > 0) ? y : 1 - y;\n}\n\n// Example\ncdf(Math.sqrt(getChisq([[10000,100],[5000,45]])));\n\ncdf()\u306f\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\u3002\u81ea\u7531\u5ea61\u306e\u30ab\u30a42\u4e57\u5206\u5e03\u306f\u5e73\u65b9\u6839\u304c\u7247\u5074\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306b\u306a\u308b\u306e\u3067cdf(Math.sqrt(...)\u3068\u3057\u3066\u3044\u308b\u3002\nhttp://qiita.com/gigamori/items/e17e6f9faffb78822c56\n\nGoogle\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067AB\u30c6\u30b9\u30c8\n2x2\u306e\u30bb\u30eb\u3092\u6307\u5b9a\u3057\u3066\u5b9f\u884c\u3059\u308c\u3070OK\uff01\nvar values = SpreadsheetApp.getActiveSheet().getRange('A1:B2').getValues();\nvar p = cdf(Math.sqrt(getChisq(values)));\nLogger.log(p);\n\nA/B\u30c6\u30b9\u30c8\u306e\u8a55\u4fa1\u3092\u7c21\u5358\u306b\u30d6\u30e9\u30a6\u30b6\u4e0a\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3044\u3002\u3068\u3044\u3046\u3053\u3068\u3067\u5b9f\u88c5\u3057\u3066\u307f\u305f\u3002\n\u305d\u3046\u3044\u3048\u3070Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067\u3082\u30ab\u30a42\u4e57\u691c\u5b9a\u306f\u3067\u304d\u306a\u3044\u306e\u306d\u3002\n\u3053\u308c\u3092\u4f7f\u3048\u3070\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u5024\u3092\u6301\u3063\u3066\u304d\u3066\u7c21\u5358\u306b\u691c\u5b9a\u3067\u304d\u308b\u304b\u3082\u3002\n\n## A/B\u30c6\u30b9\u30c8\u306e\u6280\u8853\u7684\u6574\u7406\n\nA/B\u30c6\u30b9\u30c8\uff082\u7fa4\u306e\u6bd4\u7387\u306e\u5dee\u306e\u691c\u5b9a\uff09\u3092\u3059\u308b\u3068\u304d\u3001\u6bd4\u7387\u3092\u6271\u3046\u306e\u30672\u9805\u5206\u5e03\u3092\u4f7f\u3046\u65b9\u6cd5\u3082\u3042\u308b\u304c\u3001\u30af\u30ed\u30b9\u8868\u3067\u6271\u3046\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\n\u305f\u3068\u3048\u3070\n\n|creative|imp  |click|\n|:------:|:---:|:---:|\n| A      |$x_0$|$x_1$|\n| B      |$x_2$|$x_3$|\n\n\u306b\u304a\u3044\u3066\n\n    \u30af\u30ea\u30a8\u30a4\u30c6\u30a3\u30d6A\u3068B\u3068\u3067CTR\u304c\u5909\u308f\u3089\u306a\u3044\n\n\u3059\u306a\u308f\u3061\n\n    \u30af\u30ea\u30a8\u30a4\u30c6\u30a3\u30d6\u306e\u9055\u3044\uff08\u884c\uff09\u3068\u30af\u30ea\u30c3\u30af\u306e\u3057\u3084\u3059\u3055\uff08\u5217\uff09\u306f\u72ec\u7acb\n\n\u304b\u3069\u3046\u304b\u3092\u691c\u5b9a\u3057\u305f\u3044\u3002\u4e00\u822c\u306b\u691c\u5b9a\u3067\u7528\u3044\u3089\u308c\u308b\u30af\u30ed\u30b9\u8868\u306f\n\n|\u30b0\u30eb\u30fc\u30d7|\u25cb\u25cb\u3059\u308b|\u25cb\u25cb\u3057\u306a\u3044|\n|:-----:|:----:|:-----:|\n| A     |      |       |\n| B     |      |       |\n\n\u3068\u3044\u3046\u5f62\u5f0f\u306b\u306a\u308b\u306e\u3067\u3001\n\u30af\u30ea\u30c3\u30af\u306e\u3057\u3084\u3059\u3055\u306f\u300c\u30af\u30ea\u30c3\u30af\u3059\u308b or \u30af\u30ea\u30c3\u30af\u3057\u306a\u3044\u300d\u3060\u304b\u3089\n\n|creative|\u30af\u30ea\u30c3\u30af\u3059\u308b|\u30af\u30ea\u30c3\u30af\u3057\u306a\u3044|imp\uff08\u5468\u8fba\u5ea6\u6570\uff09|\n|:------:|:---------:|:-----------:|:------------:|\n| A      | $x_0-x_1$ |    $x_1$    | $x_0$        |\n| B      | $x_2-x_3$ |    $x_3$    | $x_2$        |\n\n\u3068\u3044\u3046\u30af\u30ed\u30b9\u8868\u306e\u72ec\u7acb\u6027\u306e\u691c\u5b9a\u3092\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\n## \u5b9f\u88c5\n\n```js\n/**\n * Returns p-value of x.\n * @param {Array} x [[nTrial1, nOccurrence1], [nTrial2, nOccurrence2]]\n * @returns {Number} p-value\n */\nfunction getChisq(x){\n\n\tif(x !== undefined){\n\n\t\t// Observations\n\t\tvar o = [\n\t\t\tx[0][0] - x[0][1],\n\t\t\tx[0][1],\n\t\t\tx[1][0] - x[1][1],\n\t\t\tx[1][1],\n\t\t];\n\n\t\tvar s = o[0]+o[1]+o[2]+o[3];\n\n\t\t// Expectations\n\t\tvar e = [\n\t\t\t(o[0]+o[1]) * (o[0]+o[2]) / s,\n\t\t\t(o[0]+o[1]) * (o[1]+o[3]) / s,\n\t\t\t(o[2]+o[3]) * (o[0]+o[2]) / s,\n\t\t\t(o[2]+o[3]) * (o[1]+o[3]) / s,\n\t\t];\n\n\t\tvar chisq = 0;\n\t\tfor (i=0; i<=3; i++){\n\t\t\tchisq += (o[i] - e[i]) * (o[i] - e[i]) / e[i];\n\t\t}\n\n\treturn chisq;\n\n\t}\n}\n\n// Cumulative distribution function of Normal distribution\n// See http://qiita.com/gigamori/items/e17e6f9faffb78822c56\nfunction cdf(x) {\n\n    // constants\n    var p  =  0.2316419;\n    var b1 =  0.31938153;\n    var b2 = -0.356563782;\n    var b3 =  1.781477937;\n    var b4 = -1.821255978;\n    var b5 =  1.330274429;\n\n    var t = 1 / (1 + p * Math.abs(x));\n    var Z = Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n    var y = 1 - Z * ((((b5 * t + b4) * t + b3) * t + b2) * t + b1) * t;\n\n    return (x > 0) ? y : 1 - y;\n}\n\n// Example\ncdf(Math.sqrt(getChisq([[10000,100],[5000,45]])));\n```\n\n`cdf()`\u306f\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\u3002\u81ea\u7531\u5ea61\u306e\u30ab\u30a42\u4e57\u5206\u5e03\u306f\u5e73\u65b9\u6839\u304c\u7247\u5074\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306b\u306a\u308b\u306e\u3067`cdf(Math.sqrt(...)`\u3068\u3057\u3066\u3044\u308b\u3002\nhttp://qiita.com/gigamori/items/e17e6f9faffb78822c56\n\n\n## Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3067AB\u30c6\u30b9\u30c8\n\n2x2\u306e\u30bb\u30eb\u3092\u6307\u5b9a\u3057\u3066\u5b9f\u884c\u3059\u308c\u3070OK\uff01\n\n```js\nvar values = SpreadsheetApp.getActiveSheet().getRange('A1:B2').getValues();\nvar p = cdf(Math.sqrt(getChisq(values)));\nLogger.log(p);\n```\n", "tags": ["JavaScript", "statistics", "\u7d71\u8a08\u5b66"]}