{"context": " More than 1 year has passed since last update.\u305f\u3068\u3048\u3070\u3001 app/models/hoge.coffee \u3092\u7de8\u96c6\u3057\u305f\u3068\u304d\u306b\u3001 test/app/models/hoge_test.coffee \u3060\u3051\u3001\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u305f\u3044\u3068\u304d\u3063\u3066\u3042\u308a\u307e\u3059\u3088\u306d\u3002\u81ea\u5206\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3084\u3063\u3066\u3044\u307e\u3059\u3002\nGruntfile.coffee\nmodule.exports = (grunt) ->\n  grunt.initConfig\n    pkg: '<json:package.json>'\n\n    mochacli:\n      options:\n        timeout: 3000\n        ui: 'bdd'\n        reporter: 'spec'\n        compilers: ['coffee:coffee-script']\n      app:\n        src: 'test/app/**/*_test.coffee'\n\n    watch:\n      test:\n        options:\n          spawn: false\n        files: [\n          'app/**/*.coffee'\n          'test/app/**/*.coffee'\n        ]\n\n  grunt.loadTasks 'tasks'\n  grunt.loadNpmTasks 'grunt-mocha-cli'\n  grunt.loadNpmTasks 'grunt-contrib-watch'\n\ntasks/watch-test.coffee\nfs = require 'fs'\n_ = require 'lodash'\n\nmodule.exports = (grunt) ->\n  lastModified = 0\n\n  runAllTests = _.throttle ->\n    grunt.task.run 'mochacli:app'\n  , 30000\n\n  grunt.event.on 'watch', _.throttle((action, filepath, target) ->\n    return unless target is 'test'\n\n    currentTime = new Date().getTime()\n    if currentTime - lastModified < 2000\n      runAllTests()\n      return\n    lastModified = currentTime\n\n    if _.startsWith(filepath, 'app')\n      testpath = 'test/' + filepath.replace(/\\.coffee$/, '_test.coffee')\n    else\n      testpath = filepath\n    return unless fs.existsSync(testpath)\n\n    grunt.config 'mochacli.changed.src', testpath\n    grunt.task.run 'mochacli:changed'\n  ), 200\n\n\u77ed\u3044\u9593\u9694\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3059\u308b\u3068\u3001\u30c6\u30b9\u30c8\u5168\u5b9f\u884c\u3055\u308c\u305f\u308a\u3001Git \u3067 branch \u3092\u5207\u308a\u66ff\u3048\u305f\u308a\u3057\u305f\u3068\u304d\u306b\u3001\u305f\u304f\u3055\u3093\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u3001_.throttle \u3067\u5b9f\u884c\u9593\u9694\u3092\u7d5e\u3063\u3066\u308b\u306e\u304c\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002\n\u305f\u3068\u3048\u3070\u3001 `app/models/hoge.coffee` \u3092\u7de8\u96c6\u3057\u305f\u3068\u304d\u306b\u3001 `test/app/models/hoge_test.coffee` \u3060\u3051\u3001\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u3057\u305f\u3044\u3068\u304d\u3063\u3066\u3042\u308a\u307e\u3059\u3088\u306d\u3002\u81ea\u5206\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3084\u3063\u3066\u3044\u307e\u3059\u3002\n\nGruntfile.coffee\n\n~~~coffeescript\nmodule.exports = (grunt) ->\n  grunt.initConfig\n    pkg: '<json:package.json>'\n\n    mochacli:\n      options:\n        timeout: 3000\n        ui: 'bdd'\n        reporter: 'spec'\n        compilers: ['coffee:coffee-script']\n      app:\n        src: 'test/app/**/*_test.coffee'\n\n    watch:\n      test:\n        options:\n          spawn: false\n        files: [\n          'app/**/*.coffee'\n          'test/app/**/*.coffee'\n        ]\n\n  grunt.loadTasks 'tasks'\n  grunt.loadNpmTasks 'grunt-mocha-cli'\n  grunt.loadNpmTasks 'grunt-contrib-watch'\n~~~\n\ntasks/watch-test.coffee\n\n~~~coffeescript\nfs = require 'fs'\n_ = require 'lodash'\n\nmodule.exports = (grunt) ->\n  lastModified = 0\n\n  runAllTests = _.throttle ->\n    grunt.task.run 'mochacli:app'\n  , 30000\n\n  grunt.event.on 'watch', _.throttle((action, filepath, target) ->\n    return unless target is 'test'\n\n    currentTime = new Date().getTime()\n    if currentTime - lastModified < 2000\n      runAllTests()\n      return\n    lastModified = currentTime\n\n    if _.startsWith(filepath, 'app')\n      testpath = 'test/' + filepath.replace(/\\.coffee$/, '_test.coffee')\n    else\n      testpath = filepath\n    return unless fs.existsSync(testpath)\n\n    grunt.config 'mochacli.changed.src', testpath\n    grunt.task.run 'mochacli:changed'\n  ), 200\n~~~\n\n\u77ed\u3044\u9593\u9694\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3059\u308b\u3068\u3001\u30c6\u30b9\u30c8\u5168\u5b9f\u884c\u3055\u308c\u305f\u308a\u3001Git \u3067 branch \u3092\u5207\u308a\u66ff\u3048\u305f\u308a\u3057\u305f\u3068\u304d\u306b\u3001\u305f\u304f\u3055\u3093\u30c6\u30b9\u30c8\u304c\u5b9f\u884c\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u3001_.throttle \u3067\u5b9f\u884c\u9593\u9694\u3092\u7d5e\u3063\u3066\u308b\u306e\u304c\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002", "tags": ["Node.js", "grunt"]}