{"context": "\n\n\u306f\u3058\u3081\u306b\nOpenStack\u3067NFV\u3092\u5b9f\u73fe\u3059\u308bTacker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u307e\u3057\u305f\u3002Tacker\u306f\u60c5\u5831\u304c\u5c11\u306a\u3081\u3067\u3001\u516c\u5f0f\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806\u901a\u308a\u306b\u884c\u3063\u305f\u3089\u30cf\u30de\u3063\u305f\u305f\u3081\u3001\u79c1\u306e\u74b0\u5883\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u6210\u529f\u3057\u305f\u3068\u304d\u306e\u624b\u9806\u3092\u30e1\u30e2\u3068\u3057\u3066\u307e\u3068\u3081\u307e\u3059\u3002\n\nNFV\u3068Tacker\u306b\u3064\u3044\u3066\nNFV(Network Functions Virtualization)\u306f\u3001ETSI\uff08\u6b27\u5dde\u96fb\u6c17\u901a\u4fe1\u6a19\u6e96\u5316\u6a5f\u69cb\uff09\u304c\u5b9a\u3081\u308b\u901a\u4fe1\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4eee\u60f3\u5316\u3059\u308b\u305f\u3081\u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u5b9a\u3081\u305f\u57fa\u672c\u4ed5\u69d8\u3067\u3001NTT\u3084KDDI\u3068\u3044\u3063\u305f\u901a\u4fe1\u4e8b\u696d\u8005\u306b\u5927\u304d\u304f\u6ce8\u76ee\u3055\u308c\u3066\u3044\u307e\u3059\u3002NFV\u3092\u6d3b\u7528\u3059\u308b\u3068\u3001VM\u7fa4\u3084\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7fa4\u3092\u30bb\u30c3\u30c8\u306b\u3057\u305f\u4e00\u62ec\u30c7\u30d7\u30ed\u30a4\u3084\u524a\u9664\u304c\u30ef\u30f3\u30b9\u30c8\u30c3\u30d7\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u3057\u3066Tacker\u306f\u3001OpenStack\u4e0a\u3067NFV\u3092\u5b9f\u73fe\u3059\u308b\uff08Nova\u3084Neturon\u306e\u3088\u3046\u306a\uff09\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u3059\u3002NFV\u95a2\u9023\u3067\u306f\u3059\u3067\u306b\u4f55\u7a2e\u985e\u304b\u306eOSS\u88fd\u54c1\u304c\u5b58\u5728\u3057\u307e\u3059\u304c\u3001OpenStack\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3068\u3044\u3046\u77e5\u540d\u5ea6\u3092\u8003\u3048\u308b\u3068\u3001Tacker\u306fNFV\u95a2\u9023\u306e\u672c\u547d\u306b\u306a\u308a\u305d\u3046\u3067\u3059\u3002\nTacker\u3068OpenStack\u306e\u95a2\u4fc2\u3092\u7c21\u5358\u306b\u8868\u3059\u3068\u4e0b\u56f3\u306b\u306a\u308a\u307e\u3059\u3002Tacker\u306fNFVO\uff08\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\uff09\u3068VNFM\uff08VNF\u306e\u7ba1\u7406\uff09\u306e\u6a5f\u80fd\u3092\u62c5\u5f53\u3057\u307e\u3059\u3002\n\n\n\u69cb\u7bc9\u30e1\u30e2\n\u3053\u3061\u3089\u3067\u4f5c\u6210\u3057\u305fPackstack\u306b\u3088\u308bAllInOne\u74b0\u5883\u306bTacker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\nVirtualBox\u3067\u4f5c\u6210\u3057\u305fCentOS7.2\u306eVM\uff08\u56f3\u306e\u9ec4\u8272\u90e8\u5206\uff09\u306bOpenStack\u3092\u69cb\u7bc9\nOpenStack\u306fPackstack\u3067AllInOne\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nCentOS7.2\u306eVM\u306f\u81ea\u5b85LAN\u306b\u30d6\u30ea\u30c3\u30b8\u63a5\u7d9a\uff08\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\uff09\n\u4eca\u56de\u306fCentOS7.2\u306eVM\u306bTacker\u3092\u8ffd\u52a0\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n\n1. \u4e8b\u524d\u6e96\u5099\nTacker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u4f7f\u7528\u3059\u308bopenstack-config\u30b3\u30de\u30f3\u30c9\u3084pip\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n# yum -y install openstack-utils\n# yum -y install python-pip git\n\nextension_drivers\u306bport_security\u3092\u8ffd\u52a0\u3057\u3066\u3001\u3044\u3063\u305f\u3093\u518d\u8d77\u52d5\u3059\u308b\u3002\n# cd /etc/neutron/plugins/ml2\n# openstack-config --set ml2_conf.ini ml2 extension_drivers port_security\n\n# reboot\n\nadmin\u6a29\u9650\u3092\u6301\u3064admin\u4ee5\u5916\u306e\u30e6\u30fc\u30b6\u304c\u30d5\u30ec\u30fc\u30d0\u30fc\u3092\u4f5c\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u3001\"resource_types:OS::Nova::Flavor\"\u3092\"role:admin\"\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n# vi /etc/heat/policy.json\n\n\npolicy.json\n    \"resource_types:OS::Nova::Flavor\": \"role:admin\"\n\n\n\n2. Tacker\u7528\u306e\u30e6\u30fc\u30b6\u3084\u30b5\u30fc\u30d3\u30b9\u306e\u4f5c\u6210\nOpenStack\u306e\u4ed6\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3068\u540c\u3058\u3088\u3046\u306b\u3001Tacker\u7528DB\u3092\u4f5c\u6210\u3059\u308b\u3002\n# mysql -u root\n> CREATE DATABASE tacker;\n> GRANT ALL PRIVILEGES ON tacker.* TO 'tacker'@'localhost' IDENTIFIED BY 'password';\n> GRANT ALL PRIVILEGES ON tacker.* TO 'tacker'@'%' IDENTIFIED BY 'password';\n> exit\n\nTacker\u306e\u30e6\u30fc\u30b6\u3084\u30b5\u30fc\u30d3\u30b9\u3092\u767b\u9332\u3059\u308b\u3002Heat\u304b\u3089VNF\u3092\u30c7\u30d7\u30ed\u30a4\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u3001heat_stack_owner\u6a29\u9650\u3082\u8ffd\u52a0\u3059\u308b\u3002\n# cd /root\n# source ./keystonerc_admin\n# openstack user create --password password tacker\n# openstack role add --project services --user tacker admin\n# openstack role add --project services --user tacker heat_stack_owner\n# openstack service create --name tacker --description \"Tacker Project\" nfv-orchestration\n# openstack endpoint create --region RegionOne --publicurl 'http://192.168.0.159:9890/' --adminurl 'http://192.168.0.159:9890/'  --internalurl 'http://192.168.0.159:9890/' `openstack service show -f value -c id tacker`\n\n\n3. Tacker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n3.1 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nNewton\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n# mkdir /root/work\n# cd /root/work\n# git clone -b stable/newton https://github.com/openstack/tacker\n# cd tacker\n# pip install -r requirements.txt\n# python setup.py install\n# mkdir /var/log/tacker\n\n\n3.2 \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\nTacker\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n# cd /usr/etc/tacker\n# vi tacker.conf\n\n\ntacker.conf\n[DEFAULT]\nauth_strategy = keystone\npolicy_file = /usr/etc/tacker/policy.json\ndebug = False\nuse_syslog = False\nbind_host = <HOSTADDR>\nbind_port = 9890\nservice_plugins = nfvo,vnfm\nstate_path = /var/lib/mysql/tacker\n\n[nfvo]\nvim_drivers = openstack\n\n[keystone_authtoken]\nmemcached_servers = 11211\nregion_name = RegionOne\nauth_type = password\nusername = tacker\nproject_name = services\npassword = password\nauth_url = http://<HOSTADDR>:35357\nauth_uri = http://<HOSTADDR>:5000\n\n[agent]\nroot_helper = sudo /usr/bin/tacker-rootwrap /usr/etc/tacker/rootwrap.conf\n\n[database]\nconnection = mysql://tacker:password@127.0.0.1:3306/tacker?charset=utf8\n\n[tacker]\nmonitor_driver = ping,http_ping\n\n\nTacker\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u90e8\u5206\u306b\u3001OpenStack\u306eController Node\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3059\u308b\u3002\n# sed -i -e 's/<HOSTADDR>/192.168.0.159/g' tacker.conf\n\ntacker.conf\u304b\u3089Tacker\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3002\n# tacker-db-manage --config-file /usr/etc/tacker/tacker.conf upgrade head\n\n\n3.3 \u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\nTacker\u8d77\u52d5\u7528\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3002\n# cd /root/work/tacker\n# vi tacker-server.service\n\n\ntacker-server.service\n[Unit]\nDescription=\"tacker-server\"\n\n[Service]\nRestart=always\nRestartSec=5\n\n# Set the RUNBIN environment variable\nEnvironment='RUNBIN=\"/usr/bin/tacker-server\"'\n\n# Change directory to service users home\nWorkingDirectory=\"/var/lib/tacker\"\n\n# Pre start actions\nExecStartPre=\\\n  /bin/mkdir -p \"/var/run/tacker-server\" ;\\\n  /bin/chown root:root \"/var/run/tacker-server\" ;\\\n  /bin/mkdir -p \"/var/lock/tacker-server\" ;\\\n  /bin/chown root:root \"/var/lock/tacker-server\" ;\\\n\nPermissionsStartOnly=yes\nUser=root\n\n# Run the start up job\nExecStart=\"/usr/bin/tacker-server\" --config-file /usr/etc/tacker/tacker.conf --log-file /var/log/tacker/tacker-server.log\n\nKillMode=process\n\n[Install]\nWantedBy=multi-user.target\n\n\nTacker\u3092\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\u8d77\u52d5\u3059\u308b\u3002\n# cp tacker-server.service /usr/lib/systemd/system/\n# systemctl enable tacker-server.service\n# systemctl start tacker-server.service\n\nTacker\u306e\u30ed\u30b0\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n# vi logrotate.d_tacker\n\n\ntacker.log\n/var/log/tacker/tacker.log\n{\n    daily\n    dateext\n    missingok\n    rotate 62\n    compress\n    delaycompress\n    copytruncate\n    minsize 100k\n}\n\n\n# cp logrotate.d_tacker /etc/logrotate.d/tacker\n\n\n3.4 Tacker Client\u3068Tacker Horizon\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nTacker Client\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n# cd /root/work\n# git clone -b stable/newton https://github.com/openstack/python-tackerclient\n# cd python-tackerclient/\n# python setup.py install\n\nTacker Horizon\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n# cd /root/work\n# git clone -b stable/newton https://github.com/openstack/tacker-horizon\n# cd tacker-horizon/\n# python setup.py install\n# cp openstack_dashboard_extensions/* /usr/share/openstack-dashboard/openstack_dashboard/enabled/\n# systemctl restart httpd.service\n# systemctl restart openstack-heat-engine.service\n\n\n3.5 Tacker\u4f7f\u7528\u524d\u306e\u6e96\u5099\n\u4ee5\u964d\u306f\u8ffd\u52a0\u3057\u305ftacker\u30a2\u30ab\u30a6\u30f3\u30c8\u3067Tacker\u3092\u64cd\u4f5c\u3059\u308b\u3002\ntacker\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u74b0\u5883\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n# vi /root/keystonerc_tacker\n\n\u4ee5\u4e0b\u3092\u8a18\u8ff0\u3059\u308b\uff08OS_AUTH_URL\u306eIP\u30a2\u30c9\u30ec\u30b9\u306fKeystone\u306eIP\u30a2\u30c9\u30ec\u30b9\uff09\u3002\nunset OS_SERVICE_TOKEN\nexport OS_USERNAME=tacker\nexport OS_PASSWORD=password\nexport PS1='[\\u@\\h \\W(keystone_tacker)]\\$ '\nexport OS_AUTH_URL=http://192.168.0.159:5000/v2.0\n\nexport OS_TENANT_NAME=services\nexport OS_IDENTITY_API_VERSION=2.0\n\ntacker\u30a2\u30ab\u30a6\u30f3\u30c8\u7528\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3059\u308b\u3002\n# source /root/keystonerc_tacker\n\n# openstack network create net_mgmt\n# openstack subnet create net_mgmt_subnet \\\n --subnet-range 10.0.0.0/24 \\\n --allocation-pool start=10.0.0.21,end=10.0.0.100 \\\n --gateway 10.0.0.1 \\\n --network net_mgmt\n\n# openstack router create net_mgmt_router\n# neutron router-gateway-set net_mgmt_router public\n# neutron router-interface-add net_mgmt_router net_mgmt_subnet\n\n\n4. Tacker\u306e\u52d5\u4f5c\u78ba\u8a8d\n\u5b9f\u969b\u306bTacker\u3092\u64cd\u4f5c\u3057\u3001\u6b63\u5e38\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u305f\u304b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n4.1 VIM(OpenStack)\u306e\u767b\u9332\nTacker\u3068OpenStack\u304c\u9023\u643a\u3067\u304d\u308b\u3088\u3046\u3001Tacker\u306bVIM(OpenStack)\u3092\u767b\u9332\u3059\u308b\u3002\n\n\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306btacker\u30a2\u30ab\u30a6\u30f3\u30c8\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\u306fpassword\uff09\u3067\u30ed\u30b0\u30a4\u30f3\nNFV\u2192NFV ORCHESTRATION\u2192Register VIM\u3092\u9078\u629e\n\u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u4ee5\u4e0b\u3092\u5165\u529b\u3057\u3066\u300cRegister VIM\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n\n\n\u540d\u524d=Default VIM\n\u8aac\u660e=Default VIM\nAuth URL=(Keystone\u306eURL)\u3000\u3053\u3053\u3067\u306f\u300chttp://192.168.0.159:5000\u300d\n\nUsername=tacker\n\u30d1\u30b9\u30ef\u30fc\u30c9=password\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d=services\n\u30c9\u30e1\u30a4\u30f3\u540d=default\nDefault\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\n\n\n\n\n\n4.2 VNFD\u306e\u767b\u9332\nVNF\u306e\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3068\u306a\u308bVNFD\u3092\u4f5c\u6210\u3059\u308b\u3002\n\u4efb\u610f\u306e\u5834\u6240\u3067VNFD1.yaml\u3092\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067\u4f5c\u6210\u3059\u308b\u3002\n\nVNFD1.yaml\ntosca_definitions_version: tosca_simple_profile_for_nfv_1_0_0\n\ndescription: VNFD1\n\nmetadata:\n  template_name: sample-tosca-vnfd\n\ntopology_template:\n  node_templates:\n    VDU1:\n      type: tosca.nodes.nfv.VDU.Tacker\n      properties:\n        image: cirros\n        flavor: m1.tiny\n\n    CP1:\n      type: tosca.nodes.nfv.CP.Tacker\n      properties:\n        management: true\n        anti_spoofing_protection: false\n      requirements:\n        - virtualLink:\n            node: VL1\n        - virtualBinding:\n            node: VDU1\n\n    VL1:\n      type: tosca.nodes.nfv.VL\n      properties:\n        network_name: net_mgmt\n        vendor: Tacker\n\n\nVNF Catalog\u306b\u3066VNFD1.yaml\u3092\u767b\u9332\u3059\u308b\u3002\n\nNFV\u2192VNF MANAGEMENT\u2192VNF Catalog\u3092\u9078\u629e\n\u300c+Onboard VNF\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n\u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u4ee5\u4e0b\u3092\u5165\u529b\u3057\u3066\u300cOnBoard VNF\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n\n\n\u540d\u524d=VNFD1\n\u8aac\u660e=VNFD1\nTOSCA Template Source=TOSCA Template File\u3092\u9078\u629e\nTOSCA Template File=\u5148\u307b\u3069\u4f5c\u6210\u3057\u305fVNFD1.yaml\u3092\u9078\u629e\n\n\n\n\n\n4.3 VNF\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\n\u4f5c\u6210\u3057\u305fVNFD\u304b\u3089VNF\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u751f\u6210\u3059\u308b\u3002\n\nNFV\u2192VNF MANAGEMENT\u2192VNF Manager\u3092\u9078\u629e\n\u300c+Deploy VNF\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n\u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u4ee5\u4e0b\u3092\u5165\u529b\u3057\u3066\u300cDeploy VNF\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n\n\nVNF Name=VNF1\n\u8aac\u660e=VNF1\nVNF Catalog Name=VNFD1\u3092\u9078\u629e\nVIM Name=Default VIM\u3092\u9078\u629e\n\n\n\n\n\n4.4 VNF\u306e\u8d77\u52d5\u78ba\u8a8d\n\u751f\u6210\u3057\u305fVNF\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u6b63\u3057\u304f\u8d77\u52d5\u3067\u304d\u305f\u304b\u78ba\u8a8d\u3059\u308b\u3002\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u2192\u30b3\u30f3\u30d4\u30e5\u30fc\u30c8\u2192\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u9078\u629e\n\u4e0b\u56f3\u306e\u3088\u3046\u306bcirros\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5b9f\u884c\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308c\u3070OK\n\n\n# \u306f\u3058\u3081\u306b\nOpenStack\u3067NFV\u3092\u5b9f\u73fe\u3059\u308bTacker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u307f\u307e\u3057\u305f\u3002Tacker\u306f\u60c5\u5831\u304c\u5c11\u306a\u3081\u3067\u3001\u516c\u5f0f\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u624b\u9806\u901a\u308a\u306b\u884c\u3063\u305f\u3089\u30cf\u30de\u3063\u305f\u305f\u3081\u3001\u79c1\u306e\u74b0\u5883\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u6210\u529f\u3057\u305f\u3068\u304d\u306e\u624b\u9806\u3092\u30e1\u30e2\u3068\u3057\u3066\u307e\u3068\u3081\u307e\u3059\u3002\n\n# NFV\u3068Tacker\u306b\u3064\u3044\u3066\nNFV(Network Functions Virtualization)\u306f\u3001ETSI\uff08\u6b27\u5dde\u96fb\u6c17\u901a\u4fe1\u6a19\u6e96\u5316\u6a5f\u69cb\uff09\u304c\u5b9a\u3081\u308b\u901a\u4fe1\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4eee\u60f3\u5316\u3059\u308b\u305f\u3081\u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u5b9a\u3081\u305f\u57fa\u672c\u4ed5\u69d8\u3067\u3001NTT\u3084KDDI\u3068\u3044\u3063\u305f\u901a\u4fe1\u4e8b\u696d\u8005\u306b\u5927\u304d\u304f\u6ce8\u76ee\u3055\u308c\u3066\u3044\u307e\u3059\u3002NFV\u3092\u6d3b\u7528\u3059\u308b\u3068\u3001VM\u7fa4\u3084\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7fa4\u3092\u30bb\u30c3\u30c8\u306b\u3057\u305f\u4e00\u62ec\u30c7\u30d7\u30ed\u30a4\u3084\u524a\u9664\u304c\u30ef\u30f3\u30b9\u30c8\u30c3\u30d7\u3067\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u305d\u3057\u3066Tacker\u306f\u3001OpenStack\u4e0a\u3067NFV\u3092\u5b9f\u73fe\u3059\u308b\uff08Nova\u3084Neturon\u306e\u3088\u3046\u306a\uff09\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u3059\u3002NFV\u95a2\u9023\u3067\u306f\u3059\u3067\u306b\u4f55\u7a2e\u985e\u304b\u306eOSS\u88fd\u54c1\u304c\u5b58\u5728\u3057\u307e\u3059\u304c\u3001OpenStack\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3068\u3044\u3046\u77e5\u540d\u5ea6\u3092\u8003\u3048\u308b\u3068\u3001Tacker\u306fNFV\u95a2\u9023\u306e\u672c\u547d\u306b\u306a\u308a\u305d\u3046\u3067\u3059\u3002\n\nTacker\u3068OpenStack\u306e\u95a2\u4fc2\u3092\u7c21\u5358\u306b\u8868\u3059\u3068\u4e0b\u56f3\u306b\u306a\u308a\u307e\u3059\u3002Tacker\u306fNFVO\uff08\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\uff09\u3068VNFM\uff08VNF\u306e\u7ba1\u7406\uff09\u306e\u6a5f\u80fd\u3092\u62c5\u5f53\u3057\u307e\u3059\u3002\n\n![OpenStack\u3068tacker.png](https://qiita-image-store.s3.amazonaws.com/0/94561/a769201b-17af-4219-3fb0-846d1cdb1cd8.png)\n\n\n# \u69cb\u7bc9\u30e1\u30e2\n[\u3053\u3061\u3089](http://qiita.com/koyamaru3/items/e8882a4e98d1f7aeda23)\u3067\u4f5c\u6210\u3057\u305fPackstack\u306b\u3088\u308bAllInOne\u74b0\u5883\u306bTacker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n![\u69cb\u6210(tacker)_r2.png](https://qiita-image-store.s3.amazonaws.com/0/94561/c0f9a44b-4e66-4f23-f3ff-28724454b24c.png)\n\n- VirtualBox\u3067\u4f5c\u6210\u3057\u305fCentOS7.2\u306eVM\uff08\u56f3\u306e\u9ec4\u8272\u90e8\u5206\uff09\u306bOpenStack\u3092\u69cb\u7bc9\n- OpenStack\u306fPackstack\u3067AllInOne\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n- CentOS7.2\u306eVM\u306f\u81ea\u5b85LAN\u306b\u30d6\u30ea\u30c3\u30b8\u63a5\u7d9a\uff08\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\uff09\n- **\u4eca\u56de\u306fCentOS7.2\u306eVM\u306bTacker\u3092\u8ffd\u52a0\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b**\n\n\n##1. \u4e8b\u524d\u6e96\u5099\nTacker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u4f7f\u7528\u3059\u308bopenstack-config\u30b3\u30de\u30f3\u30c9\u3084pip\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n```\n# yum -y install openstack-utils\n# yum -y install python-pip git\n```\n\nextension_drivers\u306bport_security\u3092\u8ffd\u52a0\u3057\u3066\u3001\u3044\u3063\u305f\u3093\u518d\u8d77\u52d5\u3059\u308b\u3002\n\n```\n# cd /etc/neutron/plugins/ml2\n# openstack-config --set ml2_conf.ini ml2 extension_drivers port_security\n\n# reboot\n```\n\nadmin\u6a29\u9650\u3092\u6301\u3064admin\u4ee5\u5916\u306e\u30e6\u30fc\u30b6\u304c\u30d5\u30ec\u30fc\u30d0\u30fc\u3092\u4f5c\u6210\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u3001\"resource_types:OS::Nova::Flavor\"\u3092\"role:admin\"\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\n```\n# vi /etc/heat/policy.json\n```\n\n```json:policy.json\n    \"resource_types:OS::Nova::Flavor\": \"role:admin\"\n```\n\n##2. Tacker\u7528\u306e\u30e6\u30fc\u30b6\u3084\u30b5\u30fc\u30d3\u30b9\u306e\u4f5c\u6210\nOpenStack\u306e\u4ed6\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3068\u540c\u3058\u3088\u3046\u306b\u3001Tacker\u7528DB\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n# mysql -u root\n> CREATE DATABASE tacker;\n> GRANT ALL PRIVILEGES ON tacker.* TO 'tacker'@'localhost' IDENTIFIED BY 'password';\n> GRANT ALL PRIVILEGES ON tacker.* TO 'tacker'@'%' IDENTIFIED BY 'password';\n> exit\n```\n\nTacker\u306e\u30e6\u30fc\u30b6\u3084\u30b5\u30fc\u30d3\u30b9\u3092\u767b\u9332\u3059\u308b\u3002Heat\u304b\u3089VNF\u3092\u30c7\u30d7\u30ed\u30a4\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u3001heat_stack_owner\u6a29\u9650\u3082\u8ffd\u52a0\u3059\u308b\u3002\n\n```\n# cd /root\n# source ./keystonerc_admin\n# openstack user create --password password tacker\n# openstack role add --project services --user tacker admin\n# openstack role add --project services --user tacker heat_stack_owner\n# openstack service create --name tacker --description \"Tacker Project\" nfv-orchestration\n# openstack endpoint create --region RegionOne --publicurl 'http://192.168.0.159:9890/' --adminurl 'http://192.168.0.159:9890/'  --internalurl 'http://192.168.0.159:9890/' `openstack service show -f value -c id tacker`\n```\n\n##3. Tacker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n###3.1 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nNewton\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```\n# mkdir /root/work\n# cd /root/work\n# git clone -b stable/newton https://github.com/openstack/tacker\n# cd tacker\n# pip install -r requirements.txt\n# python setup.py install\n# mkdir /var/log/tacker\n```\n\n###3.2 \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\nTacker\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n# cd /usr/etc/tacker\n# vi tacker.conf\n```\n\n```tacker.conf\n[DEFAULT]\nauth_strategy = keystone\npolicy_file = /usr/etc/tacker/policy.json\ndebug = False\nuse_syslog = False\nbind_host = <HOSTADDR>\nbind_port = 9890\nservice_plugins = nfvo,vnfm\nstate_path = /var/lib/mysql/tacker\n\n[nfvo]\nvim_drivers = openstack\n\n[keystone_authtoken]\nmemcached_servers = 11211\nregion_name = RegionOne\nauth_type = password\nusername = tacker\nproject_name = services\npassword = password\nauth_url = http://<HOSTADDR>:35357\nauth_uri = http://<HOSTADDR>:5000\n\n[agent]\nroot_helper = sudo /usr/bin/tacker-rootwrap /usr/etc/tacker/rootwrap.conf\n\n[database]\nconnection = mysql://tacker:password@127.0.0.1:3306/tacker?charset=utf8\n\n[tacker]\nmonitor_driver = ping,http_ping\n```\n\nTacker\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e<HOSTADDR>\u90e8\u5206\u306b\u3001OpenStack\u306eController Node\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u5909\u66f4\u3059\u308b\u3002\n\n```\n# sed -i -e 's/<HOSTADDR>/192.168.0.159/g' tacker.conf\n```\n\ntacker.conf\u304b\u3089Tacker\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n# tacker-db-manage --config-file /usr/etc/tacker/tacker.conf upgrade head\n```\n\n###3.3 \u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\nTacker\u8d77\u52d5\u7528\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n# cd /root/work/tacker\n# vi tacker-server.service\n```\n\n```tacker-server.service\n[Unit]\nDescription=\"tacker-server\"\n\n[Service]\nRestart=always\nRestartSec=5\n\n# Set the RUNBIN environment variable\nEnvironment='RUNBIN=\"/usr/bin/tacker-server\"'\n\n# Change directory to service users home\nWorkingDirectory=\"/var/lib/tacker\"\n\n# Pre start actions\nExecStartPre=\\\n  /bin/mkdir -p \"/var/run/tacker-server\" ;\\\n  /bin/chown root:root \"/var/run/tacker-server\" ;\\\n  /bin/mkdir -p \"/var/lock/tacker-server\" ;\\\n  /bin/chown root:root \"/var/lock/tacker-server\" ;\\\n\nPermissionsStartOnly=yes\nUser=root\n\n# Run the start up job\nExecStart=\"/usr/bin/tacker-server\" --config-file /usr/etc/tacker/tacker.conf --log-file /var/log/tacker/tacker-server.log\n\nKillMode=process\n\n[Install]\nWantedBy=multi-user.target\n```\n\nTacker\u3092\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\u8d77\u52d5\u3059\u308b\u3002\n\n```\n# cp tacker-server.service /usr/lib/systemd/system/\n# systemctl enable tacker-server.service\n# systemctl start tacker-server.service\n```\n\nTacker\u306e\u30ed\u30b0\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n# vi logrotate.d_tacker\n```\n\n```tacker.log\n/var/log/tacker/tacker.log\n{\n    daily\n    dateext\n    missingok\n    rotate 62\n    compress\n    delaycompress\n    copytruncate\n    minsize 100k\n}\n```\n\n```\n# cp logrotate.d_tacker /etc/logrotate.d/tacker\n```\n\n###3.4 Tacker Client\u3068Tacker Horizon\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nTacker Client\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```\n# cd /root/work\n# git clone -b stable/newton https://github.com/openstack/python-tackerclient\n# cd python-tackerclient/\n# python setup.py install\n```\n\nTacker Horizon\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```\n# cd /root/work\n# git clone -b stable/newton https://github.com/openstack/tacker-horizon\n# cd tacker-horizon/\n# python setup.py install\n# cp openstack_dashboard_extensions/* /usr/share/openstack-dashboard/openstack_dashboard/enabled/\n# systemctl restart httpd.service\n# systemctl restart openstack-heat-engine.service\n```\n\n###3.5 Tacker\u4f7f\u7528\u524d\u306e\u6e96\u5099\n\n\u4ee5\u964d\u306f\u8ffd\u52a0\u3057\u305ftacker\u30a2\u30ab\u30a6\u30f3\u30c8\u3067Tacker\u3092\u64cd\u4f5c\u3059\u308b\u3002\ntacker\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u74b0\u5883\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n# vi /root/keystonerc_tacker\n```\n\n\u4ee5\u4e0b\u3092\u8a18\u8ff0\u3059\u308b\uff08OS_AUTH_URL\u306eIP\u30a2\u30c9\u30ec\u30b9\u306fKeystone\u306eIP\u30a2\u30c9\u30ec\u30b9\uff09\u3002\n\n```keystonerc_tacker\nunset OS_SERVICE_TOKEN\nexport OS_USERNAME=tacker\nexport OS_PASSWORD=password\nexport PS1='[\\u@\\h \\W(keystone_tacker)]\\$ '\nexport OS_AUTH_URL=http://192.168.0.159:5000/v2.0\n\nexport OS_TENANT_NAME=services\nexport OS_IDENTITY_API_VERSION=2.0\n```\n\ntacker\u30a2\u30ab\u30a6\u30f3\u30c8\u7528\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n# source /root/keystonerc_tacker\n\n# openstack network create net_mgmt\n# openstack subnet create net_mgmt_subnet \\\n --subnet-range 10.0.0.0/24 \\\n --allocation-pool start=10.0.0.21,end=10.0.0.100 \\\n --gateway 10.0.0.1 \\\n --network net_mgmt\n\n# openstack router create net_mgmt_router\n# neutron router-gateway-set net_mgmt_router public\n# neutron router-interface-add net_mgmt_router net_mgmt_subnet\n```\n\n\n##4. Tacker\u306e\u52d5\u4f5c\u78ba\u8a8d\n\u5b9f\u969b\u306bTacker\u3092\u64cd\u4f5c\u3057\u3001\u6b63\u5e38\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u305f\u304b\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n###4.1 VIM(OpenStack)\u306e\u767b\u9332\nTacker\u3068OpenStack\u304c\u9023\u643a\u3067\u304d\u308b\u3088\u3046\u3001Tacker\u306bVIM(OpenStack)\u3092\u767b\u9332\u3059\u308b\u3002\n\n- \u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306btacker\u30a2\u30ab\u30a6\u30f3\u30c8\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\u306fpassword\uff09\u3067\u30ed\u30b0\u30a4\u30f3\n- NFV\u2192NFV ORCHESTRATION\u2192Register VIM\u3092\u9078\u629e\n- \u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u4ee5\u4e0b\u3092\u5165\u529b\u3057\u3066\u300cRegister VIM\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n    - \u540d\u524d=Default VIM\n    - \u8aac\u660e=Default VIM\n    - Auth URL=(Keystone\u306eURL)\u3000\u3053\u3053\u3067\u306f\u300chttp://192.168.0.159:5000\u300d\n    - Username=tacker\n    - \u30d1\u30b9\u30ef\u30fc\u30c9=password\n    - \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d=services\n    - \u30c9\u30e1\u30a4\u30f3\u540d=default\n    - Default\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\n\n![tacker_01.png](https://qiita-image-store.s3.amazonaws.com/0/94561/9d45ef2a-de69-1711-a657-183c0da2d408.png)\n\n\n###4.2 VNFD\u306e\u767b\u9332\nVNF\u306e\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3068\u306a\u308bVNFD\u3092\u4f5c\u6210\u3059\u308b\u3002\n\u4efb\u610f\u306e\u5834\u6240\u3067VNFD1.yaml\u3092\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067\u4f5c\u6210\u3059\u308b\u3002\n\n```VNFD1.yaml\ntosca_definitions_version: tosca_simple_profile_for_nfv_1_0_0\n\ndescription: VNFD1\n\nmetadata:\n  template_name: sample-tosca-vnfd\n\ntopology_template:\n  node_templates:\n    VDU1:\n      type: tosca.nodes.nfv.VDU.Tacker\n      properties:\n        image: cirros\n        flavor: m1.tiny\n\n    CP1:\n      type: tosca.nodes.nfv.CP.Tacker\n      properties:\n        management: true\n        anti_spoofing_protection: false\n      requirements:\n        - virtualLink:\n            node: VL1\n        - virtualBinding:\n            node: VDU1\n\n    VL1:\n      type: tosca.nodes.nfv.VL\n      properties:\n        network_name: net_mgmt\n        vendor: Tacker\n```\n\nVNF Catalog\u306b\u3066VNFD1.yaml\u3092\u767b\u9332\u3059\u308b\u3002\n\n- NFV\u2192VNF MANAGEMENT\u2192VNF Catalog\u3092\u9078\u629e\n- \u300c+Onboard VNF\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n- \u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u4ee5\u4e0b\u3092\u5165\u529b\u3057\u3066\u300cOnBoard VNF\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n    - \u540d\u524d=VNFD1\n    - \u8aac\u660e=VNFD1\n    - TOSCA Template Source=TOSCA Template File\u3092\u9078\u629e\n    - TOSCA Template File=\u5148\u307b\u3069\u4f5c\u6210\u3057\u305fVNFD1.yaml\u3092\u9078\u629e\n \n![tacker_02.png](https://qiita-image-store.s3.amazonaws.com/0/94561/5d1847ff-413c-352c-6c18-3b6d050cac5f.png)\n\n###4.3 VNF\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\n\u4f5c\u6210\u3057\u305fVNFD\u304b\u3089VNF\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u751f\u6210\u3059\u308b\u3002\n\n- NFV\u2192VNF MANAGEMENT\u2192VNF Manager\u3092\u9078\u629e\n- \u300c+Deploy VNF\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n- \u30c0\u30a4\u30a2\u30ed\u30b0\u3067\u4ee5\u4e0b\u3092\u5165\u529b\u3057\u3066\u300cDeploy VNF\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\n    - VNF Name=VNF1\n    - \u8aac\u660e=VNF1\n    - VNF Catalog Name=VNFD1\u3092\u9078\u629e\n    - VIM Name=Default VIM\u3092\u9078\u629e\n\n![tacker_03.png](https://qiita-image-store.s3.amazonaws.com/0/94561/da5bf73d-25da-2384-468d-e6d073bb37fd.png)\n\n\n\n###4.4 VNF\u306e\u8d77\u52d5\u78ba\u8a8d\n\u751f\u6210\u3057\u305fVNF\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u6b63\u3057\u304f\u8d77\u52d5\u3067\u304d\u305f\u304b\u78ba\u8a8d\u3059\u308b\u3002\n\n- \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u2192\u30b3\u30f3\u30d4\u30e5\u30fc\u30c8\u2192\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u9078\u629e\n- \u4e0b\u56f3\u306e\u3088\u3046\u306bcirros\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5b9f\u884c\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308c\u3070OK\n\n![tacker_04.png](https://qiita-image-store.s3.amazonaws.com/0/94561/7a4f5314-7e08-ecc1-8371-e0de2ce1dccf.png)\n\n", "tags": ["openstack", "Packstack", "centos7", "tacker"]}