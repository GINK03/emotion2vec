{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nJScript\u3067\u300cExcel.Application\u300d\u3092\u89e3\u8aac\u3057\u3088\u3046\u3068\u601d\u3063\u305f\u3093\u3067\u3059\u304c\n\u3044\u304b\u3093\u305b\u3093\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u3068\u30e1\u30bd\u30c3\u30c9\u304c\u591a\u3059\u304e\u3067\u3057\u305f\n\u305d\u308c\u304b\u3089\u5185\u5bb9\u3092\u7a81\u304d\u8a70\u3081\u3066\u3044\u304f\u3068\u3001JScript\u3063\u3066\u3044\u3046\u3088\u308aVBA\u306a\u3093\u3058\u3083\u306a\u3044\u304b\n\u3068\u3044\u3046\u7591\u5ff5\u304c\u767a\u751f\u3057\u307e\u3057\u305f\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u4f5c\u3063\u3066\u3001\u305d\u308c\u3092\u89e3\u8aac\u3057\u3066\u3044\u304d\u307e\u3059\n\n\u30b5\u30f3\u30d7\u30eb\n\u4ee5\u4e0b\u306e\u3088\u3046\u306aExcel\u30d5\u30a1\u30a4\u30eb\u304c\u8907\u6570\u3042\u308a\u307e\u3059\n\n\n\n\nA\nB\n\n\n\n\n1\n\u5e97\u8217\u540d\n\u5e97\u8217A\n\n\n2\n\u308a\u3093\u3054\n100\n\n\n3\n\u307f\u304b\u3093\n100\n\n\n4\n\u3076\u3069\u3046\n100\n\n\n\n\u3053\u308c\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5f62\u306b\u3057\u3066Excel\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n\n\n\nA\nB\nC\nD\nE\n\n\n\n\n1\n\u5e97\u8217\u540d\n\u5e97\u8217A\n\u5e97\u8217B\n\u5e97\u8217C\n\u5408\u8a08\n\n\n2\n\u308a\u3093\u3054\n10\n100\n1000\n1110\n\n\n3\n\u307f\u304b\u3093\n20\n200\n2000\n2220\n\n\n4\n\u3076\u3069\u3046\n30\n300\n3000\n3330\n\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\nfunction logic(out, files) {\n    // \u30e1\u30c3\u30bb\u30fc\u30b8\n    var msg = \"\";\n    // Excel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    var excel = null;\n    try {\n        // Excel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n        var excel = new ActiveXObject(\"Excel.Application\");\n        // \u30c7\u30d0\u30c3\u30b0\u7528\uff08\u8868\u793a\uff09\n        //excel.Visible = true;\n        // \u51fa\u529bWorkbook\n        var outBook = null;\n        try {\n            // \u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n            outBook = excel.Workbooks.Add();\n            // \u633f\u5165\u5217\n            var col = 1;\n            // \u633f\u5165\u30b7\u30fc\u30c8\u53d6\u5f97\n            var outSheet = excel.Sheets(1);\n            // \u521d\u671f\u5024\u8a2d\u5b9a\n            outSheet.Cells(1, col).Value = \"\u5e97\u8217\u540d\";\n            outSheet.Cells(2, col).Value = \"\u308a\u3093\u3054\";\n            outSheet.Cells(3, col).Value = \"\u307f\u304b\u3093\";\n            outSheet.Cells(4, col).Value = \"\u3076\u3069\u3046\";\n            outSheet.Name = \"\u96c6\u8a08\";\n            // \u633f\u5165\u5217\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n            col++;\n            // \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n            var book = null;\n            // \u30d5\u30a1\u30a4\u30eb\u6570\u5206\u30eb\u30fc\u30d7\n            for (var i = 0; i < files.length; i++) {\n                try {\n                    // \u8aad\u307f\u53d6\u308a\u5c02\u7528\u3067\u958b\u304f\n                    book = excel.Workbooks.Open(files[i], 0, true);\n                    // 1\u30b7\u30fc\u30c8\u76ee\u3092\u53d6\u5f97\n                    var sheet = book.Sheets(1);\n                    // \u30c7\u30fc\u30bf\u6700\u5927\u884c\u53d6\u5f97\n                    var maxrow = sheet.Cells(1, 1).SpecialCells(11).Row;\n                    // \u30c7\u30fc\u30bf\u6700\u5927\u5217\u53d6\u5f97\n                    var maxcol = sheet.Cells(1, 1).SpecialCells(11).Column;\n                    // \u30b7\u30fc\u30c8\u30b5\u30a4\u30ba\u30c1\u30a7\u30c3\u30af\n                    if (maxrow >= 4 && maxcol >= 2) {\n                        // \u30c7\u30fc\u30bf\u8ee2\u8a18\n                        outSheet.Cells(1, col).Value = sheet.Cells(1, 2);\n                        outSheet.Cells(2, col).Value = sheet.Cells(2, 2);\n                        outSheet.Cells(3, col).Value = sheet.Cells(3, 2);\n                        outSheet.Cells(4, col).Value = sheet.Cells(4, 2);\n                    }\n                } catch (e) {\n                    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n                    msg += \"\\\"\" + files[i] + \"\\\" Error(\" + (e.number & 0xFFFF) + \"):\" + e.message + \"\\n\";\n                } finally {\n                    // Workbook\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\n                    if (book != null) {\n                        // Workbook\u3092\u9589\u3058\u308b\n                        book.Close(false);\n                        book = null;\n                    }\n                }\n                // \u633f\u5165\u5217\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n                col++;\n            }\n            // \u5408\u8a08\u95a2\u6570\u8a2d\u5b9a\n            outSheet.Cells(1, col).Value = \"\u5408\u8a08\";\n            outSheet.Cells(2, col).Formula = \"=SUM(B2:\" + outSheet.Cells(2, col - 1).Address(false, false) + \")\";\n            outSheet.Cells(3, col).Formula = \"=SUM(B3:\" + outSheet.Cells(3, col - 1).Address(false, false) + \")\";\n            outSheet.Cells(4, col).Formula = \"=SUM(B4:\" + outSheet.Cells(4, col - 1).Address(false, false) + \")\";\n            // \u7f6b\u7dda\n            var range = outSheet.Range(outSheet.Cells(1, 1), outSheet.Cells(4, col));\n            // \u7f6b\u7dda\u7528\u5909\u6570\uff08\u5de6\uff1a7\u3001\u4e0a\uff1a8\u3001\u4e0b\uff1a9\u3001\u53f3\uff1a10\u3001\u6c34\u5e73\u7dda\uff1a11\u3001\u5782\u76f4\u7dda\uff1a12\uff09\n            var lines = [7, 8, 9, 10, 11, 12];\n            // \u7f6b\u7dda\u3092\u5f15\u304f\n            for (var i = 0; i < lines.length; i++) {\n                var border = range.Borders(lines[i]);\n                border.LineStyle = 1;\n            }\n            // \u5217\u306e\u5e45\u3092\u63c3\u3048\u308b\n            range.ColumnWidth = 20;\n            //range.Columns.AutoFit(); // \u81ea\u52d5\u3067\u3084\u308b\u5834\u5408\n            // \u4e92\u63db\u6027\u30c1\u30a7\u30c3\u30af\u30aa\u30d5\n            outBook.CheckCompatibility = false;\n            // \u8b66\u544a\u30c0\u30a4\u30a2\u30ed\u30b0\u30aa\u30d5\n            excel.DisplayAlerts = false;\n            // \u4fdd\u5b58\n            outBook.SaveAs(out);\n        } catch (e) {\n            // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n            msg += \"\\\"\" + out + \"\\\" Error(\" + (e.number & 0xFFFF) + \"):\" + e.message + \"\\n\";\n        } finally {\n            // Workbook\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\n            if (outBook != null) {\n                // \u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306f\u7121\u8996\n                excel.CutCopyMode = false;\n                // Workbook\u3092\u9589\u3058\u308b\n                outBook.Close(false);\n                outBook = null;\n            }\n        }\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        msg += \"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message + \"\\n\";\n        // Excel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\n        if (excel != null) {\n            // \u898b\u3048\u306a\u3044\u3068\u56f0\u308b\u306e\u3067\u3001\u8868\u793a\n            excel.Visible = true;\n        }\n    } finally {\n        // Excel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\n        if (excel != null) {\n            // \u8b66\u544a\u30c0\u30a4\u30a2\u30ed\u30b0\u8868\u793a\n            excel.DisplayAlerts = true;\n            // Excel\u3092\u9589\u3058\u308b\n            excel.Quit();\n            excel = null;\n        }\n    }\n    return msg;\n}\n\n\u5f15\u6570out\u306f\u3001\u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3067\u3059\n\u5f15\u6570files\u306f\u3001\u5bfe\u79f0\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u914d\u5217\u3067\u3059\n\n\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\n\u30c7\u30fc\u30bf\u304c\u5b58\u5728\u3057\u3066\u3044\u308b\u304b\u3092\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u3067\u5224\u65ad\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u70ba\u3001\u5b58\u5728\u3057\u3066\u3044\u308b\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u3092\u4e88\u3081\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\nsheet.Cells(1, 1).SpecialCells(11)\u306e\u300c11\u300d\u306f\n\u300cxlCellTypeLastCell\u300d\uff08\u4f7f\u308f\u308c\u305f\u30bb\u30eb\u7bc4\u56f2\u5185\u306e\u6700\u5f8c\u306e\u30bb\u30eb\u3002\uff09\u3067\u3059\u3002\n\n\u30a2\u30c9\u30ec\u30b9\n\u96c6\u8a08\u95a2\u6570\uff08SUM\uff09\u3092\u4f7f\u3046\u306b\u3042\u305f\u308a\u3001A1\u53c2\u7167\u5f62\u5f0f\u3067\u30bb\u30eb\u306e\u30a2\u30c9\u30ec\u30b9\u304c\u5fc5\u8981\u3068\u306a\u308b\u70ba\noutSheet.Cells(2, col - 1).Address(false, false)\n\u3068\u3044\u3063\u305f\u95a2\u6570\u3067\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u7f6b\u7dda\n\u7f6b\u7dda\u306e\u8a2d\u5b9a\u3067\u659c\u3081\u7dda\u4ee5\u5916\u3059\u3079\u3066\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\nvar border = range.Borders(lines[i]);\n\n\n\n\u540d\u524d\n\u5024\n\u8aac\u660e\n\n\n\n\nxlDiagonalDown\n5\n\u659c\u3081\n\n\nxlDiagonalUp\n6\n\u659c\u3081\n\n\nxlEdgeBottom\n9\n\u4e0b\u90e8\n\n\nxlEdgeLeft\n7\n\u5de6\u90e8\n\n\nxlEdgeRight\n10\n\u53f3\u90e8\n\n\nxlEdgeTop\n8\n\u4e0a\u90e8\n\n\nxlInsideHorizontal\n12\n\u6c34\u5e73\n\n\nxlInsideVertical\n11\n\u5782\u76f4\n\n\n\n\u307e\u305f\u3001\u5b9f\u7dda\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\nborder.LineStyle = 1;\n\n\n\n\u540d\u524d\n\u5024\n\u8aac\u660e\n\n\n\n\nxlContinuous\n1\n\u5b9f\u7dda\n\n\nxlDash\n-4115\n\u7834\u7dda\n\n\nxlDashDot\n4\n\u4e00\u70b9\u9396\u7dda\n\n\nxlDashDotDot\n5\n\u30cb\u70b9\u9396\u7dda\n\n\nxlDot\n-4118\n\u70b9\u7dda\n\n\nxlDouble\n-4119\n2 \u672c\u7dda\n\n\nxlLineStyleNone\n-4142\n\u7dda\u306a\u3057\n\n\nxlSlantDashDot\n13\n\u659c\u7834\u7dda\n\n\n\n\n\u4fdd\u5b58\n\u4fdd\u5b58\u6642\u306b\u8b66\u544a\u7cfb\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u51fa\u308b\u3068\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u505c\u6b62\u3057\u3066\u3057\u307e\u3046\u306e\u3067\n\u4e00\u65e6\u3001\u8b66\u544a\u7cfb\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u51fa\u306a\u3044\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n// \u4e92\u63db\u6027\u30c1\u30a7\u30c3\u30af\u30aa\u30d5\noutBook.CheckCompatibility = false;\n// \u8b66\u544a\u30c0\u30a4\u30a2\u30ed\u30b0\u30aa\u30d5\nexcel.DisplayAlerts = false;\n\n\u305f\u3060\u3001\u305d\u306e\u307e\u307e\u3060\u3068\u6b21\u306b\u958b\u3044\u3066\u3082\u8b66\u544a\u304c\u3067\u306a\u3044\u307e\u307e\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\nExcel\u3092\u9589\u3058\u308b\u6642\u306b\u89e3\u9664\u3057\u307e\u3059\u3002\n(\u4e92\u63db\u6027\u306f\u3001\u5f8c\u306b\u4f9d\u5b58\u3057\u306a\u3044\uff09\n// \u8b66\u544a\u30c0\u30a4\u30a2\u30ed\u30b0\u8868\u793a\nexcel.DisplayAlerts = true;\n\n\n## \u306f\u3058\u3081\u306b\n\nJScript\u3067\u300cExcel.Application\u300d\u3092\u89e3\u8aac\u3057\u3088\u3046\u3068\u601d\u3063\u305f\u3093\u3067\u3059\u304c\n\u3044\u304b\u3093\u305b\u3093\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u3068\u30e1\u30bd\u30c3\u30c9\u304c\u591a\u3059\u304e\u3067\u3057\u305f\n\n\u305d\u308c\u304b\u3089\u5185\u5bb9\u3092\u7a81\u304d\u8a70\u3081\u3066\u3044\u304f\u3068\u3001JScript\u3063\u3066\u3044\u3046\u3088\u308aVBA\u306a\u3093\u3058\u3083\u306a\u3044\u304b\n\u3068\u3044\u3046\u7591\u5ff5\u304c\u767a\u751f\u3057\u307e\u3057\u305f\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u4f5c\u3063\u3066\u3001\u305d\u308c\u3092\u89e3\u8aac\u3057\u3066\u3044\u304d\u307e\u3059\n\n## \u30b5\u30f3\u30d7\u30eb\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306aExcel\u30d5\u30a1\u30a4\u30eb\u304c\u8907\u6570\u3042\u308a\u307e\u3059\n\n||A|B|\n|:--:|:--:|:--:|\n|1|\u5e97\u8217\u540d|\u5e97\u8217A|\n|2|\u308a\u3093\u3054|100|\n|3|\u307f\u304b\u3093|100|\n|4|\u3076\u3069\u3046|100|\n\n\u3053\u308c\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5f62\u306b\u3057\u3066Excel\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n||A|B|C|D|E|\n|:--:|:--:|:--:|:--:|:--:|:--:|\n|1|\u5e97\u8217\u540d|\u5e97\u8217A|\u5e97\u8217B|\u5e97\u8217C|\u5408\u8a08|\n|2|\u308a\u3093\u3054|10|100|1000|1110|\n|3|\u307f\u304b\u3093|20|200|2000|2220|\n|4|\u3076\u3069\u3046|30|300|3000|3330|\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\n\n```js\nfunction logic(out, files) {\n    // \u30e1\u30c3\u30bb\u30fc\u30b8\n    var msg = \"\";\n    // Excel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    var excel = null;\n    try {\n        // Excel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n        var excel = new ActiveXObject(\"Excel.Application\");\n        // \u30c7\u30d0\u30c3\u30b0\u7528\uff08\u8868\u793a\uff09\n        //excel.Visible = true;\n        // \u51fa\u529bWorkbook\n        var outBook = null;\n        try {\n            // \u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n            outBook = excel.Workbooks.Add();\n            // \u633f\u5165\u5217\n            var col = 1;\n            // \u633f\u5165\u30b7\u30fc\u30c8\u53d6\u5f97\n            var outSheet = excel.Sheets(1);\n            // \u521d\u671f\u5024\u8a2d\u5b9a\n            outSheet.Cells(1, col).Value = \"\u5e97\u8217\u540d\";\n            outSheet.Cells(2, col).Value = \"\u308a\u3093\u3054\";\n            outSheet.Cells(3, col).Value = \"\u307f\u304b\u3093\";\n            outSheet.Cells(4, col).Value = \"\u3076\u3069\u3046\";\n            outSheet.Name = \"\u96c6\u8a08\";\n            // \u633f\u5165\u5217\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n            col++;\n            // \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n            var book = null;\n            // \u30d5\u30a1\u30a4\u30eb\u6570\u5206\u30eb\u30fc\u30d7\n            for (var i = 0; i < files.length; i++) {\n                try {\n                    // \u8aad\u307f\u53d6\u308a\u5c02\u7528\u3067\u958b\u304f\n                    book = excel.Workbooks.Open(files[i], 0, true);\n                    // 1\u30b7\u30fc\u30c8\u76ee\u3092\u53d6\u5f97\n                    var sheet = book.Sheets(1);\n                    // \u30c7\u30fc\u30bf\u6700\u5927\u884c\u53d6\u5f97\n                    var maxrow = sheet.Cells(1, 1).SpecialCells(11).Row;\n                    // \u30c7\u30fc\u30bf\u6700\u5927\u5217\u53d6\u5f97\n                    var maxcol = sheet.Cells(1, 1).SpecialCells(11).Column;\n                    // \u30b7\u30fc\u30c8\u30b5\u30a4\u30ba\u30c1\u30a7\u30c3\u30af\n                    if (maxrow >= 4 && maxcol >= 2) {\n                        // \u30c7\u30fc\u30bf\u8ee2\u8a18\n                        outSheet.Cells(1, col).Value = sheet.Cells(1, 2);\n                        outSheet.Cells(2, col).Value = sheet.Cells(2, 2);\n                        outSheet.Cells(3, col).Value = sheet.Cells(3, 2);\n                        outSheet.Cells(4, col).Value = sheet.Cells(4, 2);\n                    }\n                } catch (e) {\n                    // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n                    msg += \"\\\"\" + files[i] + \"\\\" Error(\" + (e.number & 0xFFFF) + \"):\" + e.message + \"\\n\";\n                } finally {\n                    // Workbook\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\n                    if (book != null) {\n                        // Workbook\u3092\u9589\u3058\u308b\n                        book.Close(false);\n                        book = null;\n                    }\n                }\n                // \u633f\u5165\u5217\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n                col++;\n            }\n            // \u5408\u8a08\u95a2\u6570\u8a2d\u5b9a\n            outSheet.Cells(1, col).Value = \"\u5408\u8a08\";\n            outSheet.Cells(2, col).Formula = \"=SUM(B2:\" + outSheet.Cells(2, col - 1).Address(false, false) + \")\";\n            outSheet.Cells(3, col).Formula = \"=SUM(B3:\" + outSheet.Cells(3, col - 1).Address(false, false) + \")\";\n            outSheet.Cells(4, col).Formula = \"=SUM(B4:\" + outSheet.Cells(4, col - 1).Address(false, false) + \")\";\n            // \u7f6b\u7dda\n            var range = outSheet.Range(outSheet.Cells(1, 1), outSheet.Cells(4, col));\n            // \u7f6b\u7dda\u7528\u5909\u6570\uff08\u5de6\uff1a7\u3001\u4e0a\uff1a8\u3001\u4e0b\uff1a9\u3001\u53f3\uff1a10\u3001\u6c34\u5e73\u7dda\uff1a11\u3001\u5782\u76f4\u7dda\uff1a12\uff09\n            var lines = [7, 8, 9, 10, 11, 12];\n            // \u7f6b\u7dda\u3092\u5f15\u304f\n            for (var i = 0; i < lines.length; i++) {\n                var border = range.Borders(lines[i]);\n                border.LineStyle = 1;\n            }\n            // \u5217\u306e\u5e45\u3092\u63c3\u3048\u308b\n            range.ColumnWidth = 20;\n            //range.Columns.AutoFit(); // \u81ea\u52d5\u3067\u3084\u308b\u5834\u5408\n            // \u4e92\u63db\u6027\u30c1\u30a7\u30c3\u30af\u30aa\u30d5\n            outBook.CheckCompatibility = false;\n            // \u8b66\u544a\u30c0\u30a4\u30a2\u30ed\u30b0\u30aa\u30d5\n            excel.DisplayAlerts = false;\n            // \u4fdd\u5b58\n            outBook.SaveAs(out);\n        } catch (e) {\n            // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n            msg += \"\\\"\" + out + \"\\\" Error(\" + (e.number & 0xFFFF) + \"):\" + e.message + \"\\n\";\n        } finally {\n            // Workbook\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\n            if (outBook != null) {\n                // \u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306f\u7121\u8996\n                excel.CutCopyMode = false;\n                // Workbook\u3092\u9589\u3058\u308b\n                outBook.Close(false);\n                outBook = null;\n            }\n        }\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        msg += \"Error(\" + (e.number & 0xFFFF) + \"):\" + e.message + \"\\n\";\n        // Excel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\n        if (excel != null) {\n            // \u898b\u3048\u306a\u3044\u3068\u56f0\u308b\u306e\u3067\u3001\u8868\u793a\n            excel.Visible = true;\n        }\n    } finally {\n        // Excel\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\n        if (excel != null) {\n            // \u8b66\u544a\u30c0\u30a4\u30a2\u30ed\u30b0\u8868\u793a\n            excel.DisplayAlerts = true;\n            // Excel\u3092\u9589\u3058\u308b\n            excel.Quit();\n            excel = null;\n        }\n    }\n    return msg;\n}\n```\n\n\u5f15\u6570out\u306f\u3001\u51fa\u529b\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3067\u3059\n\u5f15\u6570files\u306f\u3001\u5bfe\u79f0\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u914d\u5217\u3067\u3059\n\n#### \u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\n\n\u30c7\u30fc\u30bf\u304c\u5b58\u5728\u3057\u3066\u3044\u308b\u304b\u3092\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u3067\u5224\u65ad\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u70ba\u3001\u5b58\u5728\u3057\u3066\u3044\u308b\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u3092\u4e88\u3081\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\n`sheet.Cells(1, 1).SpecialCells(11)`\u306e\u300c11\u300d\u306f\n\u300cxlCellTypeLastCell\u300d\uff08\u4f7f\u308f\u308c\u305f\u30bb\u30eb\u7bc4\u56f2\u5185\u306e\u6700\u5f8c\u306e\u30bb\u30eb\u3002\uff09\u3067\u3059\u3002\n\n#### \u30a2\u30c9\u30ec\u30b9\n\n\u96c6\u8a08\u95a2\u6570\uff08SUM\uff09\u3092\u4f7f\u3046\u306b\u3042\u305f\u308a\u3001A1\u53c2\u7167\u5f62\u5f0f\u3067\u30bb\u30eb\u306e\u30a2\u30c9\u30ec\u30b9\u304c\u5fc5\u8981\u3068\u306a\u308b\u70ba\n`outSheet.Cells(2, col - 1).Address(false, false)`\n\u3068\u3044\u3063\u305f\u95a2\u6570\u3067\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n#### \u7f6b\u7dda\n\n\u7f6b\u7dda\u306e\u8a2d\u5b9a\u3067\u659c\u3081\u7dda\u4ee5\u5916\u3059\u3079\u3066\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n`var border = range.Borders(lines[i]);`\n\n|\u540d\u524d|\u5024|\u8aac\u660e|\n|:--|:--:|:--|\n|xlDiagonalDown|5|\u659c\u3081|\n|xlDiagonalUp|6|\u659c\u3081|\n|xlEdgeBottom|9|\u4e0b\u90e8|\n|xlEdgeLeft|7|\u5de6\u90e8|\n|xlEdgeRight|10|\u53f3\u90e8|\n|xlEdgeTop|8|\u4e0a\u90e8|\n|xlInsideHorizontal|12|\u6c34\u5e73|\n|xlInsideVertical|11|\u5782\u76f4|\n\n\u307e\u305f\u3001\u5b9f\u7dda\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n`border.LineStyle = 1;`\n\n|\u540d\u524d|\u5024|\u8aac\u660e|\n|:--|:--:|:--|\n|xlContinuous|1|\u5b9f\u7dda|\n|xlDash|-4115|\u7834\u7dda|\n|xlDashDot|4|\u4e00\u70b9\u9396\u7dda|\n|xlDashDotDot|5|\u30cb\u70b9\u9396\u7dda|\n|xlDot|-4118|\u70b9\u7dda|\n|xlDouble|-4119|2 \u672c\u7dda|\n|xlLineStyleNone|-4142|\u7dda\u306a\u3057|\n|xlSlantDashDot|13|\u659c\u7834\u7dda|\n\n#### \u4fdd\u5b58\n\n\u4fdd\u5b58\u6642\u306b\u8b66\u544a\u7cfb\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u304c\u51fa\u308b\u3068\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u505c\u6b62\u3057\u3066\u3057\u307e\u3046\u306e\u3067\n\u4e00\u65e6\u3001\u8b66\u544a\u7cfb\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u51fa\u306a\u3044\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```js\n// \u4e92\u63db\u6027\u30c1\u30a7\u30c3\u30af\u30aa\u30d5\noutBook.CheckCompatibility = false;\n// \u8b66\u544a\u30c0\u30a4\u30a2\u30ed\u30b0\u30aa\u30d5\nexcel.DisplayAlerts = false;\n```\n\n\u305f\u3060\u3001\u305d\u306e\u307e\u307e\u3060\u3068\u6b21\u306b\u958b\u3044\u3066\u3082\u8b66\u544a\u304c\u3067\u306a\u3044\u307e\u307e\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\nExcel\u3092\u9589\u3058\u308b\u6642\u306b\u89e3\u9664\u3057\u307e\u3059\u3002\n(\u4e92\u63db\u6027\u306f\u3001\u5f8c\u306b\u4f9d\u5b58\u3057\u306a\u3044\uff09\n\n```js\n// \u8b66\u544a\u30c0\u30a4\u30a2\u30ed\u30b0\u8868\u793a\nexcel.DisplayAlerts = true;\n```\n\n", "tags": ["JScript", "Excel"]}