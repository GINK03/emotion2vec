{"context": " More than 1 year has passed since last update.\n\n\u975e\u540c\u671f\u51e6\u7406\u3092\u540c\u671f\u7684\u306b\u5b9f\u884c\u306e\u30e1\u30e2\uff08\u6539\uff09\n\n\u8a8d\u8a3c\ngoogle APIs\u306e\u30ed\u30fc\u30c9\nAPI\u306e\u4f7f\u7528\n\n\u3092\u9010\u6b21\u5b9f\u884c\u3002\n\ngapi.js\n        function prms_gapi_auth(){\n            var df = $.Deferred();\n            gapi.auth.authorize(\n            {client_id: constants.gapi.client_id, scope: 'https://www.googleapis.com/auth/drive', immediate: true}, function(res){\n                if(!gapi.auth || !gapi.auth.getToken()){\n                     df.reject(\"gapi.auth not exists\");\n                }\n                for(var i=0;i<10000;i++){\n                    var s = \"aaaa\";\n                    s+=\"bbbbb\";\n                }\n                console.log(\"auth success\");\n                df.resolve(res);\n            }\n            );\n            return df.promise();\n        }\n\n        function prms_gapi_load_by(api,v){\n            var df = $.Deferred();\n            gapi.client.setApiKey(constants.gapi.api_key);\n            gapi.client.load(api, v, function(){\n                console.log(\"load success:\" + api);\n                df.resolve(\"loaded:\" + api);\n                });\n            return df.promise();\n        }\n        /*\n         * google drive file list( filter:folder id )\n         */\n        function list_files_with(cond){\n            var df = $.Deferred();\n            var initialRequest = gapi.client.drive.files.list(\n                {q:\"'0B3pnnGKgIx1uWlZrY3RiTHBHcTA' in parents\"}\n            );\n           initialRequest.execute(function(resp){\n            var cache = {};\n            console.log(resp.items);\n\n              $(resp.items).each(function(ix,v){\n                    cache[v.id] = v;\n                });\n               console.log(cache);\n               df.resolve(cache);\n            });\n           return df.promise();\n        }\n        /**\n         * google drive sdk (create folder sample)\n         */\n        function createFolder(folderName){\n            var body = {\n              'title': folderName,\n              'mimeType': \"application/vnd.google-apps.folder\"\n            };\n            var request = gapi.client.drive.files.insert({\n              'resource': body\n            });\n            request.execute(function(resp) {\n              console.log('Folder ID: ' + resp.id);\n            });\n        }\n\n        function load_APIs(){\n            prms_gapi_auth().done(function(res){\n                console.log(\"auth callback\");\n                $.when(prms_gapi_load_by(\"drive\",\"v2\")).then(function(data){\n                    //\u4e8b\u524d\u6761\u4ef6\uff1a authorize \u304c\u5b8c\u4e86    \n                    console.log(data);\n                })    \n            });\n        }\n\n\n\u975e\u540c\u671f\u51e6\u7406\u3092\u540c\u671f\u7684\u306b\u5b9f\u884c\u306e\u30e1\u30e2\uff08\u6539\uff09\n===================================\n\n1. \u8a8d\u8a3c\n2. google APIs\u306e\u30ed\u30fc\u30c9\n3. API\u306e\u4f7f\u7528\n\n\u3092\u9010\u6b21\u5b9f\u884c\u3002\n\n```gapi.js\n        function prms_gapi_auth(){\n            var df = $.Deferred();\n            gapi.auth.authorize(\n            {client_id: constants.gapi.client_id, scope: 'https://www.googleapis.com/auth/drive', immediate: true}, function(res){\n                if(!gapi.auth || !gapi.auth.getToken()){\n                     df.reject(\"gapi.auth not exists\");\n                }\n                for(var i=0;i<10000;i++){\n                    var s = \"aaaa\";\n                    s+=\"bbbbb\";\n                }\n                console.log(\"auth success\");\n                df.resolve(res);\n            }\n            );\n            return df.promise();\n        }\n        \n        function prms_gapi_load_by(api,v){\n            var df = $.Deferred();\n            gapi.client.setApiKey(constants.gapi.api_key);\n            gapi.client.load(api, v, function(){\n                console.log(\"load success:\" + api);\n                df.resolve(\"loaded:\" + api);\n                });\n            return df.promise();\n        }\n        /*\n         * google drive file list( filter:folder id )\n         */\n        function list_files_with(cond){\n            var df = $.Deferred();\n            var initialRequest = gapi.client.drive.files.list(\n                {q:\"'0B3pnnGKgIx1uWlZrY3RiTHBHcTA' in parents\"}\n            );\n           initialRequest.execute(function(resp){\n            var cache = {};\n            console.log(resp.items);\n\n              $(resp.items).each(function(ix,v){\n                    cache[v.id] = v;\n                });\n               console.log(cache);\n               df.resolve(cache);\n            });\n           return df.promise();\n        }\n        /**\n         * google drive sdk (create folder sample)\n         */\n        function createFolder(folderName){\n            var body = {\n              'title': folderName,\n              'mimeType': \"application/vnd.google-apps.folder\"\n            };\n            var request = gapi.client.drive.files.insert({\n              'resource': body\n            });\n            request.execute(function(resp) {\n              console.log('Folder ID: ' + resp.id);\n            });\n        }\n        \n        function load_APIs(){\n            prms_gapi_auth().done(function(res){\n                console.log(\"auth callback\");\n                $.when(prms_gapi_load_by(\"drive\",\"v2\")).then(function(data){\n                    //\u4e8b\u524d\u6761\u4ef6\uff1a authorize \u304c\u5b8c\u4e86    \n                    console.log(data);\n                })    \n            });\n        }\n```\n        ", "tags": ["jQuery", "googleapi"]}