{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u3000\u672cTips\u3067\u306f\u3001\u7a7a\u6e2f\u9593\u6d41\u901a\u91cf\u306b\u3064\u3044\u3066\u53ef\u8996\u5316\u3059\u308b\u4e8b\u4f8b\u3092\u3054\u7d39\u4ecb\u3057\u3066\u3044\u307e\u3059\u3002\u7a7a\u6e2f\u9593\u6d41\u901a\u91cf\u306b\u306f\u3001\u51fa\u767a\u7a7a\u6e2f\u3068\u5230\u7740\u7a7a\u6e2f\u306e\u65c5\u5ba2\u6570\u306a\u3069\u306e\u60c5\u5831\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002\u30c7\u30fc\u30bf\u306f\u3001\u56fd\u571f\u4ea4\u901a\u7701\u306e\u56fd\u571f\u6570\u5024\u60c5\u5831\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30c7\u30fc\u30bf\u306e\u4ed5\u69d8\u306f\u3001\u56fd\u571f\u6570\u5024\u60c5\u5831\uff08\u7a7a\u6e2f\u9593\u6d41\u901a\u91cf\uff09\u88fd\u54c1\u4ed5\u69d8\u66f8 \u7b2c 1.1 \u7248\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\u30b0\u30e9\u30d5\u5316\u307e\u3067\u306e\u51e6\u7406\u306e\u6d41\u308c\u306f\u6b21\u306e\u901a\u308a\u3067\u3059\u3002\n\n\nXML \u30d1\u30fc\u30b9\n\nR\n# \u30ef\u30fc\u30ad\u30f3\u30b0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30bb\u30c3\u30c8\nsetwd( \"\u30ef\u30fc\u30ad\u30f3\u30b0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\" )\n# \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f(\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f)\nlibrary( XML )           # XML\u30d5\u30a1\u30a4\u30eb\u3092\u30d1\u30fc\u30b9\u3059\u308b\n# XML\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30b9\ndoc <- xmlInternalTreeParse( \"S10b-14.xml\" )\n# \u53d6\u308a\u51fa\u3059\u8981\u7d20\u306e XPath \u3092\u5b9a\u7fa9\ndepAportXPath  <- \"/ksj:Dataset/ksj:BetAport/ksj:depAport\"  # \u51fa\u767a\u7a7a\u6e2f\u540d\narrAportXPath  <- \"/ksj:Dataset/ksj:BetAport/ksj:arrAport\"  # \u5230\u7740\u7a7a\u6e2f\u540d\nnumOfPassXPath <- \"/ksj:Dataset/ksj:BetAport/ksj:numOfPass\" # \u65c5\u5ba2\u6570\n# xpathSApply \u3067\u8981\u7d20\u306e\u5024\u3092\u53d6\u308a\u51fa\u3059\ndepAport  <- xpathSApply( doc, depAportXPath, xmlValue )    # \u51fa\u767a\u7a7a\u6e2f\u540d\narrAport  <- xpathSApply( doc, arrAportXPath, xmlValue )    # \u5230\u7740\u7a7a\u6e2f\u540d\nnumOfPass <- xpathSApply( doc, numOfPassXPath, xmlValue )   # \u65c5\u5ba2\u6570\n# \u65c5\u5ba2\u6570\u304c\u5168\u3066\u306e\u8981\u7d20\u306b\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u3001\u5b58\u5728\u3059\u308b\u8981\u7d20\u3060\u3051\u306b\u7d5e\u308a\u8fbc\u3080\nairDataFrame <- as.data.frame( cbind(depAport[1:length( numOfPass )], arrAport[1:length( numOfPass )], numOfPass[1:length( numOfPass )]))\n\n\n\n\u30af\u30ed\u30b9\u96c6\u8a08\n\nR\n# \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f(\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f)\nlibrary( reshape2 )      # \u30af\u30ed\u30b9\u96c6\u8a08\u3059\u308b\n# \u30af\u30ed\u30b9\u96c6\u8a08\u306e\u6e96\u5099\nmeltAir <- melt( airDataFrame, id.vars = c( \"V1\", \"V2\" ), measure.vars = \"V3\", variable.name = \"vName\", value.name = \"vValue\" )\n# \u6570\u5024\u306b\u5909\u63db\u3059\u308b(\u5f15\u6570 'type' (character) \u304c\u4e0d\u6b63\u3067\u3059\u3001\u306e\u30a8\u30e9\u30fc\u3092\u56de\u907f\u3059\u308b\u305f\u3081)\nmeltAir$vValue <- type.convert( meltAir$vValue )\n# \u30af\u30ed\u30b9\u96c6\u8a08\u3059\u308b\ntransitionAir  <- acast( meltAir, V1~V2 , value.var=\"vValue\", sum )\n\n\n\u3000\u3053\u306e\u51e6\u7406\u306b\u3088\u308b\u30af\u30ed\u30b9\u96c6\u8a08\u306e\u30a4\u30e1\u30fc\u30b8\u306f\u6b21\u306e\u901a\u308a\u3067\u3059\u3002\n\n\n\u30b0\u30e9\u30d5\u63cf\u753b\n\n\u30b0\u30e9\u30d5\u63cf\u753b\u306e\u6e96\u5099\n\nR\n# \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f(\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f)\nlibrary( Gmisc )         # \u72b6\u614b\u9077\u79fb\u3092\u30d7\u30ed\u30c3\u30c8\u3059\u308b\nlibrary( grid )          # \u30e6\u30cb\u30c3\u30c8\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nlibrary( RColorBrewer )  # \u30ab\u30e9\u30fc\u30d1\u30ec\u30c3\u30c8\u3092\u4f7f\u7528\u3059\u308b\n# \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30bb\u30c3\u30c8\nmain              <- c( \"\u56fd\u5185\u7a7a\u6e2f\u306e\u65c5\u5ba2\u6570\" )\nbox_label         <- c( \"\u51fa\u767a\u7a7a\u6e2f\u540d\", \"\u5230\u7740\u7a7a\u6e2f\u540d\" )\ntxt_start_clr     <- c( \"black\", \"white\" )\ntxt_end_clr       <- c( \"black\", \"white\" )\noutput_perc       <- function( txt, n ) sprintf( \"%s:%.0f%%\", txt, n )\nbox_txt           <- cbind( mapply( output_perc, txt = c( rownames( transitionAir )), n = prop.table( rowSums( transitionAir ))*100 ), mapply( output_perc, txt = c( colnames( transitionAir )), n = prop.table( colSums( transitionAir ))*100 ))\nfill_start_box    <- brewer.pal( n = 6, name = \"Paired\" )[5:6]\nfill_end_box      <- brewer.pal( n = 6, name = \"Paired\" )[5:6]\noverlap_add_width <- 1.2\ntype_of_arrow     <- \"gradient\"\nmax_lwd           <- unit(20, \"mm\")\ncex               <- 5\n\n\n\n\u30b0\u30e9\u30d5\u3092\u63cf\u753b\u3059\u308b\n\nR\npng( \"plot1.png\", width = 1000, height = 4000 )\ntransitionPlot( transitionAir, cex = cex, main = main, box_label = box_label, box_txt = box_txt,txt_start_clr = txt_start_clr, txt_end_clr = txt_end_clr, fill_start_box = fill_start_box, fill_end_box =fill_end_box, overlap_add_width = overlap_add_width, type_of_arrow = type_of_arrow, max_lwd = max_lwd )\ndev.off()\n\n\n\n\u30b0\u30e9\u30d5\u306e\u30b5\u30f3\u30d7\u30eb\n\n\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\nIntroduction to transitionPlot by MAX GORDON\ntransitionPlot function by MAX GORDON\n# \u306f\u3058\u3081\u306b\n\u3000\u672cTips\u3067\u306f\u3001\u7a7a\u6e2f\u9593\u6d41\u901a\u91cf\u306b\u3064\u3044\u3066\u53ef\u8996\u5316\u3059\u308b\u4e8b\u4f8b\u3092\u3054\u7d39\u4ecb\u3057\u3066\u3044\u307e\u3059\u3002\u7a7a\u6e2f\u9593\u6d41\u901a\u91cf\u306b\u306f\u3001\u51fa\u767a\u7a7a\u6e2f\u3068\u5230\u7740\u7a7a\u6e2f\u306e\u65c5\u5ba2\u6570\u306a\u3069\u306e\u60c5\u5831\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002\u30c7\u30fc\u30bf\u306f\u3001\u56fd\u571f\u4ea4\u901a\u7701\u306e[\u56fd\u571f\u6570\u5024\u60c5\u5831](http://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-S10b-v1_1.html)\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30c7\u30fc\u30bf\u306e\u4ed5\u69d8\u306f\u3001[\u56fd\u571f\u6570\u5024\u60c5\u5831\uff08\u7a7a\u6e2f\u9593\u6d41\u901a\u91cf\uff09\u88fd\u54c1\u4ed5\u69d8\u66f8 \u7b2c 1.1 \u7248](http://nlftp.mlit.go.jp/ksj/gml/product_spec/KS-PS-S10b-v1_1.pdf)\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\u30b0\u30e9\u30d5\u5316\u307e\u3067\u306e\u51e6\u7406\u306e\u6d41\u308c\u306f\u6b21\u306e\u901a\u308a\u3067\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/106773/2f784986-7da3-bf81-8db8-ac96cffdf450.png)\n\n# XML \u30d1\u30fc\u30b9\n\n```R:R\n# \u30ef\u30fc\u30ad\u30f3\u30b0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30bb\u30c3\u30c8\nsetwd( \"\u30ef\u30fc\u30ad\u30f3\u30b0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\" )\n# \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f(\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f)\nlibrary( XML )           # XML\u30d5\u30a1\u30a4\u30eb\u3092\u30d1\u30fc\u30b9\u3059\u308b\n# XML\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30b9\ndoc <- xmlInternalTreeParse( \"S10b-14.xml\" )\n# \u53d6\u308a\u51fa\u3059\u8981\u7d20\u306e XPath \u3092\u5b9a\u7fa9\ndepAportXPath  <- \"/ksj:Dataset/ksj:BetAport/ksj:depAport\"  # \u51fa\u767a\u7a7a\u6e2f\u540d\narrAportXPath  <- \"/ksj:Dataset/ksj:BetAport/ksj:arrAport\"  # \u5230\u7740\u7a7a\u6e2f\u540d\nnumOfPassXPath <- \"/ksj:Dataset/ksj:BetAport/ksj:numOfPass\" # \u65c5\u5ba2\u6570\n# xpathSApply \u3067\u8981\u7d20\u306e\u5024\u3092\u53d6\u308a\u51fa\u3059\ndepAport  <- xpathSApply( doc, depAportXPath, xmlValue )    # \u51fa\u767a\u7a7a\u6e2f\u540d\narrAport  <- xpathSApply( doc, arrAportXPath, xmlValue )    # \u5230\u7740\u7a7a\u6e2f\u540d\nnumOfPass <- xpathSApply( doc, numOfPassXPath, xmlValue )   # \u65c5\u5ba2\u6570\n# \u65c5\u5ba2\u6570\u304c\u5168\u3066\u306e\u8981\u7d20\u306b\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u3001\u5b58\u5728\u3059\u308b\u8981\u7d20\u3060\u3051\u306b\u7d5e\u308a\u8fbc\u3080\nairDataFrame <- as.data.frame( cbind(depAport[1:length( numOfPass )], arrAport[1:length( numOfPass )], numOfPass[1:length( numOfPass )]))\n```\n\n# \u30af\u30ed\u30b9\u96c6\u8a08\n\n```R:R\n# \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f(\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f)\nlibrary( reshape2 )      # \u30af\u30ed\u30b9\u96c6\u8a08\u3059\u308b\n# \u30af\u30ed\u30b9\u96c6\u8a08\u306e\u6e96\u5099\nmeltAir <- melt( airDataFrame, id.vars = c( \"V1\", \"V2\" ), measure.vars = \"V3\", variable.name = \"vName\", value.name = \"vValue\" )\n# \u6570\u5024\u306b\u5909\u63db\u3059\u308b(\u5f15\u6570 'type' (character) \u304c\u4e0d\u6b63\u3067\u3059\u3001\u306e\u30a8\u30e9\u30fc\u3092\u56de\u907f\u3059\u308b\u305f\u3081)\nmeltAir$vValue <- type.convert( meltAir$vValue )\n# \u30af\u30ed\u30b9\u96c6\u8a08\u3059\u308b\ntransitionAir  <- acast( meltAir, V1~V2 , value.var=\"vValue\", sum )\n```\n\n\u3000\u3053\u306e\u51e6\u7406\u306b\u3088\u308b\u30af\u30ed\u30b9\u96c6\u8a08\u306e\u30a4\u30e1\u30fc\u30b8\u306f\u6b21\u306e\u901a\u308a\u3067\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/106773/ee1d1be8-33a5-3c9c-fb0a-54703b1d913f.png)\n\n# \u30b0\u30e9\u30d5\u63cf\u753b\n### \u30b0\u30e9\u30d5\u63cf\u753b\u306e\u6e96\u5099\n```R:R\n# \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u8aad\u307f\u8fbc\u307f(\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f)\nlibrary( Gmisc )         # \u72b6\u614b\u9077\u79fb\u3092\u30d7\u30ed\u30c3\u30c8\u3059\u308b\nlibrary( grid )          # \u30e6\u30cb\u30c3\u30c8\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nlibrary( RColorBrewer )  # \u30ab\u30e9\u30fc\u30d1\u30ec\u30c3\u30c8\u3092\u4f7f\u7528\u3059\u308b\n# \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30bb\u30c3\u30c8\nmain              <- c( \"\u56fd\u5185\u7a7a\u6e2f\u306e\u65c5\u5ba2\u6570\" )\nbox_label         <- c( \"\u51fa\u767a\u7a7a\u6e2f\u540d\", \"\u5230\u7740\u7a7a\u6e2f\u540d\" )\ntxt_start_clr     <- c( \"black\", \"white\" )\ntxt_end_clr       <- c( \"black\", \"white\" )\noutput_perc       <- function( txt, n ) sprintf( \"%s:%.0f%%\", txt, n )\nbox_txt           <- cbind( mapply( output_perc, txt = c( rownames( transitionAir )), n = prop.table( rowSums( transitionAir ))*100 ), mapply( output_perc, txt = c( colnames( transitionAir )), n = prop.table( colSums( transitionAir ))*100 ))\nfill_start_box    <- brewer.pal( n = 6, name = \"Paired\" )[5:6]\nfill_end_box      <- brewer.pal( n = 6, name = \"Paired\" )[5:6]\noverlap_add_width <- 1.2\ntype_of_arrow     <- \"gradient\"\nmax_lwd           <- unit(20, \"mm\")\ncex               <- 5\n```\n\n### \u30b0\u30e9\u30d5\u3092\u63cf\u753b\u3059\u308b\n```R:R\npng( \"plot1.png\", width = 1000, height = 4000 )\ntransitionPlot( transitionAir, cex = cex, main = main, box_label = box_label, box_txt = box_txt,txt_start_clr = txt_start_clr, txt_end_clr = txt_end_clr, fill_start_box = fill_start_box, fill_end_box =fill_end_box, overlap_add_width = overlap_add_width, type_of_arrow = type_of_arrow, max_lwd = max_lwd )\ndev.off()\n```\n\n# \u30b0\u30e9\u30d5\u306e\u30b5\u30f3\u30d7\u30eb\n![image](https://qiita-image-store.s3.amazonaws.com/0/106773/9a01d4e6-f2e5-9f79-17e1-37e356e9281b.png)\n\n\n# \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n[Introduction to transitionPlot](https://cran.r-project.org/web/packages/Gmisc/vignettes/transitionPlot.html) by MAX GORDON\n[transitionPlot function] (http://gforge.se/2013/06/visualizing-transitions-with-the-transitionplot-function/) by MAX GORDON\n", "tags": ["R", "analytics", "statistics", "bigdata", "opendata"]}