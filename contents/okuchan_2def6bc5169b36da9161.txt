{"context": "Canvas \u3092\u4f7f\u3063\u3066\u3001\u753b\u50cf\u3092\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5909\u63db\u3059\u308b\u65b9\u6cd5\u3067\u3059\u3002\n\u51e6\u7406\u306e\u6d41\u308c\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\nCanvas \u306b\u5143\u753b\u50cf\u3092\u63cf\u753b\u3059\u308b\nCanvas \u4e0a\u3067\u753b\u50cf\u3092\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5909\u63db\u3059\u308b\n\u5909\u63db\u3057\u305f\u753b\u50cf\u3092 base64 \u5f62\u5f0f\u3067\u66f8\u304d\u51fa\u3059\n\u753b\u50cf\u306e src \u5c5e\u6027\u3092\u66f8\u304d\u63db\u3048\u308b\n\n\n\u30bd\u30fc\u30b9\n\napp.js\n$(window).load(function() {\n    $(\"img\").each(function() {\n\n        // \u30ad\u30e3\u30f3\u30d0\u30b9\u306b\u753b\u50cf\u3092\u63cf\u753b\u3059\u308b\n        var canvas = document.createElement(\"canvas\");\n        var ctx = canvas.getContext(\"2d\");\n        var img = new Image();\n        img.src = $(this).attr(\"src\");\n        canvas.width = img.width;\n        canvas.height = img.height;\n        ctx.drawImage(img, 0, 0);\n\n        // \u753b\u50cf\u306e\u5404\u30d4\u30af\u30bb\u30eb\u3092\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5909\u63db\u3059\u308b\n        var pixels = ctx.getImageData(0, 0, canvas.width, canvas.height);\n        for (var y = 0; y < pixels.height; y++) {\n            for (var x = 0; x < pixels.width; x++) {\n                var i = (y * 4) * pixels.width + x * 4;\n                var rgb = parseInt((pixels.data[i] + pixels.data[i + 1] + pixels.data[i + 2]) / 3, 10);\n                pixels.data[i] = rgb;\n                pixels.data[i + 1] = rgb;\n                pixels.data[i + 2] = rgb;\n            }\n        }\n        ctx.putImageData(pixels, 0, 0, 0, 0, pixels.width, pixels.height);\n\n        // \u753b\u50cf\u3092\u5dee\u3057\u66ff\u3048\u308b\n        $(this).attr(\"src\", canvas.toDataURL());\n    });\n});\n\n\n\nindex.html\n<!DOCTYPE html>\n<html lang=\"ja\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"></script>\n    <script src=\"js/app.js\"></script>\n    <title>Image to Grayscale</title>\n</head>\n<body>\n    <p><img src=\"img/photo_1.jpg\"></p>\n    <p><img src=\"img/photo_2.jpg\"></p>\n    <p><img src=\"img/photo_3.jpg\"></p>\n</body>\n</html>\n\n\n\n\u7d50\u679c\n\nCanvas \u3092\u4f7f\u3063\u3066\u3001\u753b\u50cf\u3092\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5909\u63db\u3059\u308b\u65b9\u6cd5\u3067\u3059\u3002\n\u51e6\u7406\u306e\u6d41\u308c\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n1. Canvas \u306b\u5143\u753b\u50cf\u3092\u63cf\u753b\u3059\u308b\n2. Canvas \u4e0a\u3067\u753b\u50cf\u3092\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5909\u63db\u3059\u308b\n3. \u5909\u63db\u3057\u305f\u753b\u50cf\u3092 base64 \u5f62\u5f0f\u3067\u66f8\u304d\u51fa\u3059\n4. \u753b\u50cf\u306e src \u5c5e\u6027\u3092\u66f8\u304d\u63db\u3048\u308b\n\n# \u30bd\u30fc\u30b9\n\n```js:app.js\n$(window).load(function() {\n\t$(\"img\").each(function() {\n\n\t\t// \u30ad\u30e3\u30f3\u30d0\u30b9\u306b\u753b\u50cf\u3092\u63cf\u753b\u3059\u308b\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tvar img = new Image();\n\t\timg.src = $(this).attr(\"src\");\n\t\tcanvas.width = img.width;\n\t\tcanvas.height = img.height;\n\t\tctx.drawImage(img, 0, 0);\n\n\t\t// \u753b\u50cf\u306e\u5404\u30d4\u30af\u30bb\u30eb\u3092\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5909\u63db\u3059\u308b\n\t\tvar pixels = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\tfor (var y = 0; y < pixels.height; y++) {\n\t\t\tfor (var x = 0; x < pixels.width; x++) {\n\t\t\t\tvar i = (y * 4) * pixels.width + x * 4;\n\t\t\t\tvar rgb = parseInt((pixels.data[i] + pixels.data[i + 1] + pixels.data[i + 2]) / 3, 10);\n\t\t\t\tpixels.data[i] = rgb;\n\t\t\t\tpixels.data[i + 1] = rgb;\n\t\t\t\tpixels.data[i + 2] = rgb;\n\t\t\t}\n\t\t}\n\t\tctx.putImageData(pixels, 0, 0, 0, 0, pixels.width, pixels.height);\n\n\t\t// \u753b\u50cf\u3092\u5dee\u3057\u66ff\u3048\u308b\n\t\t$(this).attr(\"src\", canvas.toDataURL());\n\t});\n});\n```\n\n```html:index.html\n<!DOCTYPE html>\n<html lang=\"ja\">\n<head>\n\t<meta charset=\"UTF-8\">\n\t<meta name=\"viewport\" content=\"width=device-width\">\n\t<script src=\"https://code.jquery.com/jquery-1.12.4.min.js\"></script>\n\t<script src=\"js/app.js\"></script>\n\t<title>Image to Grayscale</title>\n</head>\n<body>\n\t<p><img src=\"img/photo_1.jpg\"></p>\n\t<p><img src=\"img/photo_2.jpg\"></p>\n\t<p><img src=\"img/photo_3.jpg\"></p>\n</body>\n</html>\n```\n\n# \u7d50\u679c\n\n![grayscale.png](https://qiita-image-store.s3.amazonaws.com/0/129344/8a5f26ae-b4b4-7c68-e91a-009dc4981c64.png)\n", "tags": ["canvas", "JavaScript"]}