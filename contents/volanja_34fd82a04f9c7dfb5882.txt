{"tags": ["Redmine"], "context": " More than 1 year has passed since last update.\u6700\u8fd1\u3001Redmine\u306e\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u304d\u76f4\u3057\u305f\u306e\u3067\u30e1\u30e2\u3002\n\u4ee5\u524d\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3053\u3061\u3089(2014\u5e742\u6708\u7248)\n\n\u5bfe\u8c61\n\nCentOS 6.x\n\n\n\u5909\u66f4\u70b9\nrbenv\u306e\u30d5\u30eb\u30d1\u30b9\u6307\u5b9a\u3057\u3066\u3044\u305f\u306e\u3067\u3001\u5b9f\u884c\u524d\u306bPATH\u3092\u8a2d\u5b9a\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u5909\u66f4\u524d\nCMD=\"/home/redmine/.rbenv/shims/bundle exec unicorn_rails -D -c ${APP_ROOT}/config/unicorn.rb -E ${RAILS_ENV}\"\n\n\n\u5909\u66f4\u5f8c\nRuby\u3092/home/redmine\u914d\u4e0b\u306brbenv\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u304b\u3001root\u6a29\u9650\u3067\u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u304b\u5224\u65ad\u3057\u3066PATH\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30e6\u30fc\u30b6\u540d\u306fredmine\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u9069\u5f53\u306b\u8aad\u307f\u66ff\u3048\u307e\u3059\u3002\n# set PATH\nif [ -e '/home/redmine/.rbenv' ]; then # use rbenv\n  PATH=$PATH:/home/redmine/.rbenv/shims\nelif [ -e '/usr/local/bin' ]; then # use root system\n  PATH=$PATH:/usr/local/bin\nfi\n\nCMD=\"bundle exec unicorn_rails -D -c ${APP_ROOT}/config/unicorn.rb -E ${RAILS_ENV}\"\n\n\n\u5168\u6587\n#! /bin/sh\n\n# chkconfig: - 85 15\n\n### BEGIN INIT INFO\n# Provides:          redmine\n# Required-Start:    $local_fs $remote_fs $network $syslog\n# Required-Stop:     $local_fs $remote_fs $network $syslog\n# Default-Start:     2 3 4 5\n# Default-Stop:      0 1 6\n# Short-Description: Redmine Project management software\n# Description:       Redmine Project management software\n### END INIT INFO\n\n# Source function library.\n. /etc/rc.d/init.d/functions\n\n### Environment variables\nRAILS_ENV=\"production\"\n\n# Feel free to change any of the following variables for your app:\nAPP_ROOT=/home/redmine/redmine\nAPP_USER=\"redmine\"\nPID=${APP_ROOT}/tmp/pids/unicorn.pid\nCMD=\"bundle exec unicorn_rails -D -c ${APP_ROOT}/config/unicorn.rb -E ${RAILS_ENV}\"\nINIT_CONF=${APP_ROOT}/config/init.conf\naction=\"$1\"\nRETVAL=0\nprog=\"redmine\"\n# set PATH\nif [ -e '/home/redmine/.rbenv' ]; then # use rbenv\n  PATH=$PATH:/home/redmine/.rbenv/shims\nelif [ -e '/usr/local/bin' ]; then # use root system\n  PATH=$PATH:/usr/local/bin\nfi\n\n\ntest -f \"${INIT_CONF}\" && . ${INIT_CONF}\n\ncd ${APP_ROOT} || exit 1\n\nstart(){\n  echo -n $\"Starting $prog: \"\n  daemon --pidfile=${PID} --user=${APP_USER} \"cd ${APP_ROOT} && ${CMD}\" \n  RETVAL=$?\n  echo\n}\n\nstop(){\n  echo -n $\"Stopping $prog: \"\n  killproc -p ${PID} ${prog} -QUIT\n  RETVAL=$?\n  echo\n}\n\nrh_status() {\n    status -p ${PID} ${prog}\n}\n\nforce_stop(){\n  echo -n $\"Force-Stopping $prog: \"\n  killproc -p ${PID} ${prog} -TERM\n  RETVAL=$?\n  echo\n}\n\nreload(){\n  echo -n $\"Reloading $prog: \"\n  killproc -p ${PID} ${prog} -HUP\n  RETVAL=$?\n  echo\n}\n\nupgrade(){\n  old_pid=${PID}.oldbin\n  echo -n $\"Staring new master $prog: \"\n  killproc -p ${PID} ${prog} -USR2\n  RETVAL=$?\n  echo\n  sleep 2\n  if [ -f ${old_pid} -a -f ${PID} ]; then\n      echo -n $\"Graceful shutdown of old $prog: \"\n      killproc -p ${old_pid} ${prog} -QUIT\n      RETVAL=$?\n      echo \n  else\n      echo $\"Upgrade failed!\"\n      return 1\n  fi\n}\n\nreopen_logs(){\n  echo -n $\"ReOpening Logs $prog: \"\n  killproc -p ${PID} ${prog} -USR1\n  RETVAL=$?\n  echo\n}\n\ncase $action in\nstart)\n  start\n  ;;\nstop)\n  stop\n  ;;\nstatus)\n  rh_status\n  ;;\nrestart)\n  stop\n  sleep 2\n  start\n  ;;\nreload)\n  reload\n  ;;\nupgrade)\n  upgrade\n  ;;\nforce-stop)\n  force_stop\n  ;;\nreopen-logs)\n  reopen_logs\n  ;;\n*)\n  echo >&2 \"Usage: $0 <start|stop|restart|reload|upgrade|force-stop|reopen-logs>\"\n  exit 1\n  ;;\nesac\nexit 0\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n\n\u6700\u8fd1\u3001Redmine\u306e\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u304d\u76f4\u3057\u305f\u306e\u3067\u30e1\u30e2\u3002\n\u4ee5\u524d\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f[\u3053\u3061\u3089(2014\u5e742\u6708\u7248)](http://qiita.com/volanja/items/383fcd6d2d2e14792723)\n\n## \u5bfe\u8c61\n+ CentOS 6.x\n\n## \u5909\u66f4\u70b9\nrbenv\u306e\u30d5\u30eb\u30d1\u30b9\u6307\u5b9a\u3057\u3066\u3044\u305f\u306e\u3067\u3001\u5b9f\u884c\u524d\u306bPATH\u3092\u8a2d\u5b9a\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n### \u5909\u66f4\u524d\n\n```\nCMD=\"/home/redmine/.rbenv/shims/bundle exec unicorn_rails -D -c ${APP_ROOT}/config/unicorn.rb -E ${RAILS_ENV}\"\n```\n\n### \u5909\u66f4\u5f8c\n\nRuby\u3092`/home/redmine`\u914d\u4e0b\u306brbenv\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u304b\u3001root\u6a29\u9650\u3067\u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u304b\u5224\u65ad\u3057\u3066PATH\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30e6\u30fc\u30b6\u540d\u306f`redmine`\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u9069\u5f53\u306b\u8aad\u307f\u66ff\u3048\u307e\u3059\u3002\n\n```\n# set PATH\nif [ -e '/home/redmine/.rbenv' ]; then # use rbenv\n  PATH=$PATH:/home/redmine/.rbenv/shims\nelif [ -e '/usr/local/bin' ]; then # use root system\n  PATH=$PATH:/usr/local/bin\nfi\n\nCMD=\"bundle exec unicorn_rails -D -c ${APP_ROOT}/config/unicorn.rb -E ${RAILS_ENV}\"\n```\n\n## \u5168\u6587\n\n```bash\n#! /bin/sh\n\n# chkconfig: - 85 15\n\n### BEGIN INIT INFO\n# Provides:          redmine\n# Required-Start:    $local_fs $remote_fs $network $syslog\n# Required-Stop:     $local_fs $remote_fs $network $syslog\n# Default-Start:     2 3 4 5\n# Default-Stop:      0 1 6\n# Short-Description: Redmine Project management software\n# Description:       Redmine Project management software\n### END INIT INFO\n\n# Source function library.\n. /etc/rc.d/init.d/functions\n\n### Environment variables\nRAILS_ENV=\"production\"\n\n# Feel free to change any of the following variables for your app:\nAPP_ROOT=/home/redmine/redmine\nAPP_USER=\"redmine\"\nPID=${APP_ROOT}/tmp/pids/unicorn.pid\nCMD=\"bundle exec unicorn_rails -D -c ${APP_ROOT}/config/unicorn.rb -E ${RAILS_ENV}\"\nINIT_CONF=${APP_ROOT}/config/init.conf\naction=\"$1\"\nRETVAL=0\nprog=\"redmine\"\n# set PATH\nif [ -e '/home/redmine/.rbenv' ]; then # use rbenv\n  PATH=$PATH:/home/redmine/.rbenv/shims\nelif [ -e '/usr/local/bin' ]; then # use root system\n  PATH=$PATH:/usr/local/bin\nfi\n\n\ntest -f \"${INIT_CONF}\" && . ${INIT_CONF}\n\ncd ${APP_ROOT} || exit 1\n\nstart(){\n  echo -n $\"Starting $prog: \"\n  daemon --pidfile=${PID} --user=${APP_USER} \"cd ${APP_ROOT} && ${CMD}\" \n  RETVAL=$?\n  echo\n}\n\nstop(){\n  echo -n $\"Stopping $prog: \"\n  killproc -p ${PID} ${prog} -QUIT\n  RETVAL=$?\n  echo\n}\n\nrh_status() {\n    status -p ${PID} ${prog}\n}\n\nforce_stop(){\n  echo -n $\"Force-Stopping $prog: \"\n  killproc -p ${PID} ${prog} -TERM\n  RETVAL=$?\n  echo\n}\n\nreload(){\n  echo -n $\"Reloading $prog: \"\n  killproc -p ${PID} ${prog} -HUP\n  RETVAL=$?\n  echo\n}\n\nupgrade(){\n  old_pid=${PID}.oldbin\n  echo -n $\"Staring new master $prog: \"\n  killproc -p ${PID} ${prog} -USR2\n  RETVAL=$?\n  echo\n  sleep 2\n  if [ -f ${old_pid} -a -f ${PID} ]; then\n      echo -n $\"Graceful shutdown of old $prog: \"\n      killproc -p ${old_pid} ${prog} -QUIT\n      RETVAL=$?\n      echo \n  else\n      echo $\"Upgrade failed!\"\n      return 1\n  fi\n}\n\nreopen_logs(){\n  echo -n $\"ReOpening Logs $prog: \"\n  killproc -p ${PID} ${prog} -USR1\n  RETVAL=$?\n  echo\n}\n\ncase $action in\nstart)\n  start\n  ;;\nstop)\n  stop\n  ;;\nstatus)\n  rh_status\n  ;;\nrestart)\n  stop\n  sleep 2\n  start\n  ;;\nreload)\n  reload\n  ;;\nupgrade)\n  upgrade\n  ;;\nforce-stop)\n  force_stop\n  ;;\nreopen-logs)\n  reopen_logs\n  ;;\n*)\n  echo >&2 \"Usage: $0 <start|stop|restart|reload|upgrade|force-stop|reopen-logs>\"\n  exit 1\n  ;;\nesac\nexit 0\n\n```\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n"}