{"tags": ["JavaScript", "\u6570\u5b66"], "context": "Google Spreadsheet\u306a\u3069\u3067\u300c\u30c8\u30ec\u30f3\u30c9\u30e9\u30a4\u30f3\u300d\u3092\u5f15\u304f\u969b\u306b\u5229\u7528\u3055\u308c\u308b\u8a08\u7b97\u3002\n\u5168\u30c7\u30fc\u30bf\u304b\u3089\u3001\u8aa4\u5dee\u306e2\u4e57\u304c\u6700\u5c0f\u306b\u306a\u308b\u3088\u3046\u306b\u30e9\u30a4\u30f3\u3092\u5f15\u304f\u65b9\u6cd5\u30fb\u30fb\u3089\u3057\u3044\u3002\n\u8a08\u7b97\u5f0f\u306f\u4ee5\u4e0b\u3002\uff08Wikipedia\u304b\u3089\u5f15\u7528\uff09\na = \\frac{n\\sum_{k=1}^{n}x_ky_k - \\sum_{k=1}^{n}x_k\\sum_{k=1}^{n}y_k}{n\\sum_{k=1}^{n}x^2_k - (\\sum_{k=1}^{n}x_k)^2}\n$${a = \\frac{n\\sum_{k=1}^{n}x_ky_k - \\sum_{k=1}^{n}x_k\\sum_{k=1}^{n}y_k}{n\\sum_{k=1}^{n}x^2_k - (\\sum_{k=1}^{n}x_k)^2}\n}$$\nb = \\frac{\\sum_{k=1}^{n}x^2_k\\sum_{k=1}^{n}y_k - \\sum_{k=1}^{n}x_ky_k\\sum_{k=1}^{n}x_k}{n\\sum_{k=1}^{n}x^2_k - (\\sum_{k=1}^{n}x_k)^2}\n$${b = \\frac{\\sum_{k=1}^{n}x^2_k\\sum_{k=1}^{n}y_k - \\sum_{k=1}^{n}x_ky_k\\sum_{k=1}^{n}x_k}{n\\sum_{k=1}^{n}x^2_k - (\\sum_{k=1}^{n}x_k)^2}\n}$$\n\u4e0a\u8a18 $a$, $b$ \u3092\u7b97\u51fa\u3057\u3001 $y = ax +b$ \u3068\u3044\u3046\u5f62\u306b\u3057\u3066\u5229\u7528\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u8a08\u7b97\u5f0f\u306e\u5c0e\u304d\u65b9\u306f\u3053\u3061\u3089\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\uff08\u6700\u5c0f\u4e8c\u4e57\u6cd5\uff09\n\u305f\u3060\u3001\u4f8b\u306b\u51fa\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3068\u3001\u6700\u5f8c\u306b\n\n\u6700\u521d\u306b\u793a\u3057\u305f\u306e\u30c7\u30fc\u30bf\u306b\u3064\u3044\u3066\u8a08\u7b97\u3057\u3066\u307f\u308b\u3068\n\n\u3067\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u6570\u5024\u304c\u3069\u3046\u3084\u3089\u9055\u3046\u3063\u307d\u3044\u306e\u3067\u6ce8\u610f\u3067\u3059\u3002\uff08\u5225\u306e\u30b5\u30a4\u30c8\u3067\u30c7\u30fc\u30bf\u5165\u308c\u3066\u307f\u305f\u3089\u9055\u3046\u6570\u5024\u304c\u51fa\u305f\uff09\n\u307e\u305f\u3001\u6700\u5f8c\u306b\u5c0e\u304d\u51fa\u3055\u308c\u3066\u3044\u308b\u6570\u5f0f\u3082Wikipedia\u306b\u8f09\u3063\u3066\u3044\u308b\u306e\u3068\u82e5\u5e72\u9055\u3044\u307e\u3057\u305f\u3002\n(function (ns) {\n    'use strict';\n\n    function sum(data, func) {\n        var val = 0;\n        for (var i = 0; i < data.length; i++) {\n            val += func(data[i]);\n        }\n        return val;\n    }\n\n    function leastSquare(data) {\n\n        var N = data.length;\n\n        var sumX = sum(data, function (item) {\n            return item[0];\n        });\n\n        var sumX2 = sum(data, function (item) {\n            return item[0] * item[0];\n        });\n\n        var sumY = sum(data, function (item) {\n            return item[1];\n        });\n\n        var sumXY = sum(data, function (item) {\n            return item[0] * item[1];\n        });\n\n\n        var a, b;\n\n        var denominator = (N * sumX2) - Math.pow(sumX, 2);\n\n        var molecule1 = (N * sumXY) - (sumX * sumY);\n        a = molecule1 / denominator;\n\n        var molecule2 = (sumX2 * sumY) - (sumXY * sumX);\n        b = molecule2 / denominator;\n\n        return {\n            a: a,\n            b: b\n        };\n    }\n\n    ns.leastSquare = leastSquare;\n\n}(window));\n\n\u3053\u308c\u3092\u4f7f\u3063\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a08\u7b97\u3057\u307e\u3059\u3002\nvar data = [\n    [1.2, 2.2],\n    [2.1, 3.8],\n    [3.3, 5.6],\n    [4.1, 7.1],\n    [5, 8.8]\n];\n\nvar test = leastSquare(data);\nconsole.log(test); // => Object {a: 1.7142239515780355, b: 0.1173367920449656}\n\n\n\u53c2\u8003\n\n\u30c7\u30fc\u30bf\u3092\u5165\u308c\u308b\u3068\u8a08\u7b97\u3057\u3066\u304f\u308c\u308b\u30b5\u30a4\u30c8\n\n\nGoogle Spreadsheet\u306a\u3069\u3067\u300c\u30c8\u30ec\u30f3\u30c9\u30e9\u30a4\u30f3\u300d\u3092\u5f15\u304f\u969b\u306b\u5229\u7528\u3055\u308c\u308b\u8a08\u7b97\u3002\n\u5168\u30c7\u30fc\u30bf\u304b\u3089\u3001\u8aa4\u5dee\u306e2\u4e57\u304c\u6700\u5c0f\u306b\u306a\u308b\u3088\u3046\u306b\u30e9\u30a4\u30f3\u3092\u5f15\u304f\u65b9\u6cd5\u30fb\u30fb\u3089\u3057\u3044\u3002\n\n\u8a08\u7b97\u5f0f\u306f\u4ee5\u4e0b\u3002\uff08[Wikipedia](https://ja.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%97%E6%B3%95)\u304b\u3089\u5f15\u7528\uff09\n\n```math\na = \\frac{n\\sum_{k=1}^{n}x_ky_k - \\sum_{k=1}^{n}x_k\\sum_{k=1}^{n}y_k}{n\\sum_{k=1}^{n}x^2_k - (\\sum_{k=1}^{n}x_k)^2}\n```\n\n```math\nb = \\frac{\\sum_{k=1}^{n}x^2_k\\sum_{k=1}^{n}y_k - \\sum_{k=1}^{n}x_ky_k\\sum_{k=1}^{n}x_k}{n\\sum_{k=1}^{n}x^2_k - (\\sum_{k=1}^{n}x_k)^2}\n```\n\n\u4e0a\u8a18 $a$, $b$ \u3092\u7b97\u51fa\u3057\u3001 $y = ax +b$ \u3068\u3044\u3046\u5f62\u306b\u3057\u3066\u5229\u7528\u3057\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u8a08\u7b97\u5f0f\u306e\u5c0e\u304d\u65b9\u306f\u3053\u3061\u3089\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\uff08[\u6700\u5c0f\u4e8c\u4e57\u6cd5](http://akita-nct.jp/yamamoto/lecture/2007/5E_comp_app/interpolation/interpolation_html/node4.html)\uff09\n\u305f\u3060\u3001\u4f8b\u306b\u51fa\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3068\u3001\u6700\u5f8c\u306b\n\n>\u6700\u521d\u306b\u793a\u3057\u305f\u306e\u30c7\u30fc\u30bf\u306b\u3064\u3044\u3066\u8a08\u7b97\u3057\u3066\u307f\u308b\u3068\n\n\u3067\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u6570\u5024\u304c\u3069\u3046\u3084\u3089\u9055\u3046\u3063\u307d\u3044\u306e\u3067\u6ce8\u610f\u3067\u3059\u3002\uff08\u5225\u306e\u30b5\u30a4\u30c8\u3067\u30c7\u30fc\u30bf\u5165\u308c\u3066\u307f\u305f\u3089\u9055\u3046\u6570\u5024\u304c\u51fa\u305f\uff09\n\u307e\u305f\u3001\u6700\u5f8c\u306b\u5c0e\u304d\u51fa\u3055\u308c\u3066\u3044\u308b\u6570\u5f0f\u3082Wikipedia\u306b\u8f09\u3063\u3066\u3044\u308b\u306e\u3068\u82e5\u5e72\u9055\u3044\u307e\u3057\u305f\u3002\n\n```js\n(function (ns) {\n    'use strict';\n\n    function sum(data, func) {\n        var val = 0;\n        for (var i = 0; i < data.length; i++) {\n            val += func(data[i]);\n        }\n        return val;\n    }\n\n    function leastSquare(data) {\n\n        var N = data.length;\n\n        var sumX = sum(data, function (item) {\n            return item[0];\n        });\n\n        var sumX2 = sum(data, function (item) {\n            return item[0] * item[0];\n        });\n\n        var sumY = sum(data, function (item) {\n            return item[1];\n        });\n\n        var sumXY = sum(data, function (item) {\n            return item[0] * item[1];\n        });\n\n\n        var a, b;\n\n        var denominator = (N * sumX2) - Math.pow(sumX, 2);\n\n        var molecule1 = (N * sumXY) - (sumX * sumY);\n        a = molecule1 / denominator;\n\n        var molecule2 = (sumX2 * sumY) - (sumXY * sumX);\n        b = molecule2 / denominator;\n\n        return {\n            a: a,\n            b: b\n        };\n    }\n\n    ns.leastSquare = leastSquare;\n\n}(window));\n```\n\n\u3053\u308c\u3092\u4f7f\u3063\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a08\u7b97\u3057\u307e\u3059\u3002\n\n```js\nvar data = [\n    [1.2, 2.2],\n    [2.1, 3.8],\n    [3.3, 5.6],\n    [4.1, 7.1],\n    [5, 8.8]\n];\n\nvar test = leastSquare(data);\nconsole.log(test); // => Object {a: 1.7142239515780355, b: 0.1173367920449656}\n```\n\n\n## \u53c2\u8003\n\n- [\u30c7\u30fc\u30bf\u3092\u5165\u308c\u308b\u3068\u8a08\u7b97\u3057\u3066\u304f\u308c\u308b\u30b5\u30a4\u30c8](http://www.claygear.com/webservice/lmscalc)\n"}