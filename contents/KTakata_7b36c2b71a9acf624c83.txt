{"tags": ["FactoryGirl", "RSpec", "Rails", "Ruby"], "context": "\n\n\u74b0\u5883\n\nOS(Windows7)\nruby (2.0.0p648)\nrails (4.2.7.1)\nrspec-rails (3.5.2)\npoltergeist (1.12.0)\ndatabase_cleaner (1.5.3)\ncapybara (2.11.0)\nlaunchy (2.4.3)\n\n\n\u4f5c\u6210\u3057\u305f\u3044\u30c7\u30fc\u30bf\nProject\nTracker\nIssue\n\u4e0a\u4e8c\u3064(Project, Tracker)\u306f\u7279\u306b\u554f\u984c\u306a\u304b\u3063\u305f\u3051\u3069\u4e0b(Issue)\u3092\u4f5c\u6210\u3059\u308b\u306e\u306b\u4e0d\u899a\u3092\u53d6\u308a\u307e\u3057\u305f...\n\n\u624b\u98061 \u5404Factory\u3092\u4f5c\u3063\u3066\u3044\u304f\n\nproject.rb\nFactoryGirl.define do\n    factory :project do\n        name 'Project'\n        description 'Test Project'\n        homepage  ''\n        is_public true\n        sequence(:identifier) { |n| \"identifier#{n}\" }\n        parent_id nil\n        status 1\n    end\nend\n\n\n\n\ntracker.rb\nFactoryGirl.define do\n    factory :bug_tracker, class: Tracker do\n        name '\u30d0\u30b0'\n        is_in_chlog true\n        sequence(:position, &:to_s)\n        is_in_roadmap true\n        fields_bits 0\n    end\nend\n\n\n\nissue.rb\nFactoryGirl.define do\n    factory :open_issue, class: Issue do\n        sequence(:id, &:to_s)\n        subject \"\u672a\u5b8c\u4e86\u30c1\u30b1\u30c3\u30c8\"\n        description \"\"\n        due_date nil\n        category_id nil\n        status_id 1\n        assigned_to_id nil\n        priority_id 1\n        fixed_version_id nil\n        author_id 5\n        lock_version 0\n        done_ratio 0\n        estimated_hours nil\n        parent_id nil\n        root_id 9\n        lft 1\n        rgt 2\n        is_private false\n        closed_on nil\n    end\nend\n\n\n\n\u624b\u98062 \u5fc5\u8981\u306a\u95a2\u9023\u30c7\u30fc\u30bf\u306eFactory\u3092\u4f5c\u6210\n\n\u4f5c\u6210\u3059\u308b\u30c7\u30fc\u30bf\n\nIssueStatus\nIssuePriority\nUser\n\n\nissue_status.rb\nFactoryGirl.define do\n    factory :open_issue_status, class: IssueStatus do\n        sequence(:id, &:to_s)\n        name '\u65b0\u898f'\n        is_closed false\n        position 1\n        default_done_ratio nil\n    end\nend\n\n\n\nissue_priority.rb\nFactoryGirl.define do\n    factory :priority, class: IssuePriority do\n        sequence(:id, &:to_s)\n        name 'priority'\n        position 0\n        is_default true\n        type 'IssuePriority'\n        active true\n        project_id nil\n        parent_id nil\n        position_name 'default'\n    end\nend\n\n\n\nuser.rb\nFactoryGirl.define do\n    factory :user do\n        firstname 'John'\n        lastname 'Doe'\n        mail 'john@example.net'\n        status 1\n        login 'john'\n        hashed_password '(\u7565)'\n        admin false\n    end\nend\n\n\n\n\u624b\u98063 \u3044\u3056\u4f5c\u6210\n\ntest.rb\nlet!(:user) { FactoryGirl.create(:user) }\nlet!(:open_issue_status) { FactoryGirl.create(:open_issue_status) }\nlet!(:tracker) { FactoryGirl.create(:task_tracker, default_status_id: open_issue_status.id, position: 1) }\n\nlet!(:fst_project) { FactoryGirl.create(:project, trackers: [tracker]) }\nlet!(:sec_project) { FactoryGirl.create(:project, parent_id: fst_project.id, trackers: [tracker]) }\nlet!(:priority1) { FactoryGirl.create(:priority, project_id: fst_project.id) }\nlet!(:priority2) { FactoryGirl.create(:priority, project_id: sec_project.id) }\nlet!(:open_issue) { FactoryGirl.create(:open_issue, project_id: thd_project.id, tracker_id: tracker.id, priority_id: priority.id, author_id: user.id) }\n\n\n\n\u305d\u306e\u4ed6\n\u624b\u98063\u3067Project\u306bIssue\u3092\u7d10\u4ed8\u3051\u308b\u969b\u306b\u3001\u767b\u9332\u3067\u304d\u308bTracker\u3092\u6307\u5b9a\u3057\u3066\u304a\u304b\u306a\u3044\u3068\u4e0b\u8a18\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\nActiveRecord::RecordInvalid:\nValidation failed: Tracker is not included in the list\n\n\u3053\u308c\u304c\u308f\u304b\u3089\u306a\u304f\u3066\u5c0f\u4e00\u6642\u9593\u60a9\u3093\u3060...\n# \u74b0\u5883\n- OS(Windows7)\n- ruby (2.0.0p648)\n- rails (4.2.7.1)\n- rspec-rails (3.5.2)\n- poltergeist (1.12.0)\n- database_cleaner (1.5.3)\n- capybara (2.11.0)\n- launchy (2.4.3)\n\n# \u4f5c\u6210\u3057\u305f\u3044\u30c7\u30fc\u30bf\nProject\nTracker\nIssue\n\u4e0a\u4e8c\u3064(Project, Tracker)\u306f\u7279\u306b\u554f\u984c\u306a\u304b\u3063\u305f\u3051\u3069\u4e0b(Issue)\u3092\u4f5c\u6210\u3059\u308b\u306e\u306b\u4e0d\u899a\u3092\u53d6\u308a\u307e\u3057\u305f...\n\n\n## \u624b\u98061 \u5404Factory\u3092\u4f5c\u3063\u3066\u3044\u304f\n\n``` project.rb\nFactoryGirl.define do\n    factory :project do\n        name 'Project'\n        description 'Test Project'\n        homepage  ''\n        is_public true\n        sequence(:identifier) { |n| \"identifier#{n}\" }\n        parent_id nil\n        status 1\n    end\nend\n\n```\n\n``` tracker.rb\nFactoryGirl.define do\n    factory :bug_tracker, class: Tracker do\n        name '\u30d0\u30b0'\n        is_in_chlog true\n        sequence(:position, &:to_s)\n        is_in_roadmap true\n        fields_bits 0\n    end\nend\n```\n\n``` issue.rb\nFactoryGirl.define do\n    factory :open_issue, class: Issue do\n        sequence(:id, &:to_s)\n        subject \"\u672a\u5b8c\u4e86\u30c1\u30b1\u30c3\u30c8\"\n        description \"\"\n        due_date nil\n        category_id nil\n        status_id 1\n        assigned_to_id nil\n        priority_id 1\n        fixed_version_id nil\n        author_id 5\n        lock_version 0\n        done_ratio 0\n        estimated_hours nil\n        parent_id nil\n        root_id 9\n        lft 1\n        rgt 2\n        is_private false\n        closed_on nil\n    end\nend\n```\n\n## \u624b\u98062 \u5fc5\u8981\u306a\u95a2\u9023\u30c7\u30fc\u30bf\u306eFactory\u3092\u4f5c\u6210\n\n### \u4f5c\u6210\u3059\u308b\u30c7\u30fc\u30bf\n\n- IssueStatus\n- IssuePriority\n- User\n\n``` issue_status.rb\nFactoryGirl.define do\n    factory :open_issue_status, class: IssueStatus do\n        sequence(:id, &:to_s)\n        name '\u65b0\u898f'\n        is_closed false\n        position 1\n        default_done_ratio nil\n    end\nend\n```\n\n``` issue_priority.rb\nFactoryGirl.define do\n    factory :priority, class: IssuePriority do\n        sequence(:id, &:to_s)\n        name 'priority'\n        position 0\n        is_default true\n        type 'IssuePriority'\n        active true\n        project_id nil\n        parent_id nil\n        position_name 'default'\n    end\nend\n```\n\n``` user.rb\nFactoryGirl.define do\n    factory :user do\n        firstname 'John'\n        lastname 'Doe'\n        mail 'john@example.net'\n        status 1\n        login 'john'\n        hashed_password '(\u7565)'\n        admin false\n    end\nend\n```\n\n## \u624b\u98063 \u3044\u3056\u4f5c\u6210\n\n``` ruby:test.rb\nlet!(:user) { FactoryGirl.create(:user) }\nlet!(:open_issue_status) { FactoryGirl.create(:open_issue_status) }\nlet!(:tracker) { FactoryGirl.create(:task_tracker, default_status_id: open_issue_status.id, position: 1) }\n\nlet!(:fst_project) { FactoryGirl.create(:project, trackers: [tracker]) }\nlet!(:sec_project) { FactoryGirl.create(:project, parent_id: fst_project.id, trackers: [tracker]) }\nlet!(:priority1) { FactoryGirl.create(:priority, project_id: fst_project.id) }\nlet!(:priority2) { FactoryGirl.create(:priority, project_id: sec_project.id) }\nlet!(:open_issue) { FactoryGirl.create(:open_issue, project_id: thd_project.id, tracker_id: tracker.id, priority_id: priority.id, author_id: user.id) }\n```\n\n## \u305d\u306e\u4ed6\n\u624b\u98063\u3067Project\u306bIssue\u3092\u7d10\u4ed8\u3051\u308b\u969b\u306b\u3001\u767b\u9332\u3067\u304d\u308bTracker\u3092\u6307\u5b9a\u3057\u3066\u304a\u304b\u306a\u3044\u3068\u4e0b\u8a18\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\n\n```\nActiveRecord::RecordInvalid:\nValidation failed: Tracker is not included in the list\n```\n\n\u3053\u308c\u304c\u308f\u304b\u3089\u306a\u304f\u3066\u5c0f\u4e00\u6642\u9593\u60a9\u3093\u3060...\n"}