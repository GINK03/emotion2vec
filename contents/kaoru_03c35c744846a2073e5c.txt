{"tags": ["nginx", "C\u8a00\u8a9e"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u76ee\u6a19\nHello world ! \u3092\u8868\u793a\u3059\u308b\u3002\u4ed6\u306f\u4f55\u3082\u3057\u306a\u3044\u3002\n\n\u3084\u3063\u305f\u3053\u3068\n\n\u307e\u305a\u306fconfig\u3092\u7528\u610f\u3059\u308b\n\n\nconfig\nngx_addon_name=ngx_http_hello_world_module\nHTTP_MODULES=\"$HTTP_MODULES ngx_http_hello_world_module\"\nNGX_ADDON_SRCS=\"$NGX_ADDON_SRCS $ngx_addon_dir/ngx_http_hello_world_module.c\"\n\n\n\n\u5b9f\u88c5\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\n\n\nngx_http_hello_world_module.c\n#include <ngx_config.h>\n#include <ngx_core.h>\n#include <ngx_http.h>\n\nstatic char *ngx_http_hello_world(ngx_conf_t *cf, ngx_command_t *cmd, void *conf);\n\nstatic ngx_command_t ngx_http_hello_world_module_commands[] = {\n    {\n         ngx_string(\"ngx_hello_world\"),\n         NGX_HTTP_LOC_CONF|NGX_CONF_NOARGS,\n         ngx_http_hello_world,\n         0,\n         0,\n         NULL,\n    },\n\n    ngx_null_command,\n};\n\nstatic ngx_http_module_t  ngx_http_hello_world_module_ctx = {\n    NULL,                          /* preconfiguration */\n    NULL,                          /* postconfiguration */\n\n    NULL,                          /* create main configuration */\n    NULL,                          /* init main configuration */\n\n    NULL,                          /* create server configuration */\n    NULL,                          /* merge server configuration */\n\n    NULL,                          /* create location configuration */\n    NULL,                          /* merge location configuration */\n};\n\n\nngx_module_t  ngx_http_hello_world_module = {\n    NGX_MODULE_V1,\n    &ngx_http_hello_world_module_ctx, /* module context */\n    ngx_http_hello_world_module_commands,   /* module directives */\n    NGX_HTTP_MODULE,               /* module type */\n    NULL,                          /* init master */\n    NULL,                          /* init module */\n    NULL,                          /* init process */\n    NULL,                          /* init thread */\n    NULL,                          /* exit thread */\n    NULL,                          /* exit process */\n    NULL,                          /* exit master */\n    NGX_MODULE_V1_PADDING\n};\n\nstatic ngx_str_t  text_plain_type = ngx_string(\"text/plain\");\nstatic u_char hello_world[] =  \"Hello world !\";\n\nstatic ngx_int_t ngx_http_hello_world_handler(ngx_http_request_t *r)\n{\n    ngx_http_complex_value_t  cv;\n\n    if (! (r->method & (NGX_HTTP_GET|NGX_HTTP_HEAD))) {\n        return NGX_HTTP_NOT_ALLOWED;\n    }\n\n    ngx_memzero(&cv, sizeof(ngx_http_complex_value_t));\n\n    cv.value.len = sizeof(hello_world) - 1;\n    cv.value.data = hello_world;\n\n    return ngx_http_send_response(r, NGX_HTTP_OK, &text_plain_type, &cv);\n}\n\n\nstatic char *ngx_http_hello_world(ngx_conf_t *cf, ngx_command_t *cmd, void *conf)\n{\n    ngx_http_core_loc_conf_t  *clcf;\n\n    clcf = ngx_http_conf_get_module_loc_conf(cf, ngx_http_core_module);\n    clcf->handler = ngx_http_hello_world_handler;\n\n    return NGX_CONF_OK;\n}\n\n\n\n\u30d3\u30eb\u30c9\u3057\u3066\u307f\u308b\n./configure --add-module=<THIS MODULE DIRECTORY>\nmake\nmake install\n\n\n\u8a2d\u5b9a\u3059\u308b\nconf/nginx.conf\u306b\u4ee5\u4e0b\u306e\u884c\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n        location = /hello-world {\n            ngx_hello_world;\n        }\n\n\n\u52d5\u304b\u3057\u3066\u307f\u308b\n./sbin/nginx -t\n./sbin/nginx\nwget http://localhost:10080/hello-world\n\n\u3067\u304d\u307e\u3057\u305f\u30fc\uff01\n\n\u53c2\u8003\u306b\u306a\u3063\u305f\u3082\u306e\nhttp://www.evanmiller.org/nginx-modules-guide.html\n\u76ee\u6a19\n======\n\nHello world ! \u3092\u8868\u793a\u3059\u308b\u3002\u4ed6\u306f\u4f55\u3082\u3057\u306a\u3044\u3002\n\n\u3084\u3063\u305f\u3053\u3068\n======\n\n* \u307e\u305a\u306fconfig\u3092\u7528\u610f\u3059\u308b\n\n```mf:config\nngx_addon_name=ngx_http_hello_world_module\nHTTP_MODULES=\"$HTTP_MODULES ngx_http_hello_world_module\"\nNGX_ADDON_SRCS=\"$NGX_ADDON_SRCS $ngx_addon_dir/ngx_http_hello_world_module.c\"\n```\n\n* \u5b9f\u88c5\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\n\n```c:ngx_http_hello_world_module.c\n#include <ngx_config.h>\n#include <ngx_core.h>\n#include <ngx_http.h>\n\nstatic char *ngx_http_hello_world(ngx_conf_t *cf, ngx_command_t *cmd, void *conf);\n\nstatic ngx_command_t ngx_http_hello_world_module_commands[] = {\n    {\n         ngx_string(\"ngx_hello_world\"),\n         NGX_HTTP_LOC_CONF|NGX_CONF_NOARGS,\n         ngx_http_hello_world,\n         0,\n         0,\n         NULL,\n    },\n\n    ngx_null_command,\n};\n\nstatic ngx_http_module_t  ngx_http_hello_world_module_ctx = {\n    NULL,                          /* preconfiguration */\n    NULL,                          /* postconfiguration */\n\n    NULL,                          /* create main configuration */\n    NULL,                          /* init main configuration */\n\n    NULL,                          /* create server configuration */\n    NULL,                          /* merge server configuration */\n\n    NULL,                          /* create location configuration */\n    NULL,                          /* merge location configuration */\n};\n\n\nngx_module_t  ngx_http_hello_world_module = {\n    NGX_MODULE_V1,\n    &ngx_http_hello_world_module_ctx, /* module context */\n    ngx_http_hello_world_module_commands,   /* module directives */\n    NGX_HTTP_MODULE,               /* module type */\n    NULL,                          /* init master */\n    NULL,                          /* init module */\n    NULL,                          /* init process */\n    NULL,                          /* init thread */\n    NULL,                          /* exit thread */\n    NULL,                          /* exit process */\n    NULL,                          /* exit master */\n    NGX_MODULE_V1_PADDING\n};\n\nstatic ngx_str_t  text_plain_type = ngx_string(\"text/plain\");\nstatic u_char hello_world[] =  \"Hello world !\";\n\nstatic ngx_int_t ngx_http_hello_world_handler(ngx_http_request_t *r)\n{\n    ngx_http_complex_value_t  cv;\n\n    if (! (r->method & (NGX_HTTP_GET|NGX_HTTP_HEAD))) {\n        return NGX_HTTP_NOT_ALLOWED;\n    }\n\n    ngx_memzero(&cv, sizeof(ngx_http_complex_value_t));\n\n    cv.value.len = sizeof(hello_world) - 1;\n    cv.value.data = hello_world;\n\n    return ngx_http_send_response(r, NGX_HTTP_OK, &text_plain_type, &cv);\n}\n\n\nstatic char *ngx_http_hello_world(ngx_conf_t *cf, ngx_command_t *cmd, void *conf)\n{\n    ngx_http_core_loc_conf_t  *clcf;\n\n    clcf = ngx_http_conf_get_module_loc_conf(cf, ngx_http_core_module);\n    clcf->handler = ngx_http_hello_world_handler;\n\n    return NGX_CONF_OK;\n}\n```\n\n\u30d3\u30eb\u30c9\u3057\u3066\u307f\u308b\n=====\n\n```bash\n./configure --add-module=<THIS MODULE DIRECTORY>\nmake\nmake install\n```\n\n\u8a2d\u5b9a\u3059\u308b\n=====\n\nconf/nginx.conf\u306b\u4ee5\u4e0b\u306e\u884c\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\n        location = /hello-world {\n            ngx_hello_world;\n        }\n```\n\n\u52d5\u304b\u3057\u3066\u307f\u308b\n=====\n\n```bash\n./sbin/nginx -t\n./sbin/nginx\nwget http://localhost:10080/hello-world\n```\n\n\u3067\u304d\u307e\u3057\u305f\u30fc\uff01\n\n\u53c2\u8003\u306b\u306a\u3063\u305f\u3082\u306e\n======\n\nhttp://www.evanmiller.org/nginx-modules-guide.html\n"}