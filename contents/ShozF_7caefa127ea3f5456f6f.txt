{"tags": ["Python", "BeautifulSoup", "python2.7"], "context": " More than 1 year has passed since last update.XML/HTML\u304b\u3089\u62bd\u51fa\u3057\u305f\u3044\u90e8\u5206\u306b\u7279\u5fb4\u306e\u3042\u308b\u30bf\u30b0\u304c\u3042\u308c\u3070\u3001BeautifulSoup\u306f\u305d\u306e\u30bf\u30b0\u3092\u30ad\u30fc\u30ef\u30fc\u30c9\u306b\u63a2\u7d22\u3067\u304d\u308b\u306e\u3067\u5927\u304d\u306a\u5a01\u529b\u3092\u767a\u63ee\u3057\u307e\u3059\u3002\u3067\u3059\u304c\u3001\u305d\u306e\u69d8\u306a\u7279\u5fb4\u306e\u3042\u308b\u30bf\u30b0\u304c\u7121\u3044\u5834\u5408\u306f\u3001\u30eb\u30fc\u30c8\u30fb\u30bf\u30b0\u304b\u3089\u76ee\u7684\u306e\u30bf\u30b0\u307e\u3067\u9806\u306b\u30bf\u30b0\u3092\u8fbf\u3063\u3066\u3044\u304f\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002BeautifulSoup\u306fXPATH\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u3053\u306e\u624b\u306e\u63a2\u7d22\u304c\u3061\u3087\u3063\u3068\u82e6\u624b\u3067\u3059\u3002\n\u305d\u3053\u3067\u3001\u7c21\u6613\u7684\u306apath\u6307\u5b9a\u3067\u30bf\u30b0\u3092\u6c7a\u3081\u6253\u3061\u3059\u308b\u6a5f\u80fd\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nPATH\u306e\u6307\u5b9a\u65b9\u6cd5\n(1)\u57fa\u672c\u5f62 - \u30bf\u30b0\u306e\u8981\u7d20\u540d\u3092'/'\u3067\u533a\u5207\u3063\u3066\u9806\u306b\u4e26\u3079\u307e\u3059\n\u3000\u3000html/body/table/tr/td\n\u3000\u3000\u3000\"body\u306e\u4e0b\u306e\u6700\u521d\u306etable\u306e\u4e0b\u306e\u6700\u521d\u306etr\u306e\u4e0b\u306e\u6700\u521d\u306etd\"\n(2)\u5144\u5f1f\u30bf\u30b0\u306e\u9078\u629e - \u62bd\u51fa\u3057\u305f\u3044\u30bf\u30b0\u304c\u51fa\u73fe\u3059\u308b\u9806\u756an(1\uff5e)\u3092'[n]'\u3067\u6307\u5b9a\u3057\u307e\u3059\n\u3000\u3000html/body/table[1]/tr[3]/td\n\u3000\u3000\u3000\"body\u306e\u4e0b\u306e\u4e00\u3064\u76ee\u306etable\u306e\u4e0b\u306e3\u3064\u76ee\u306etr\u306e\u4e0b\u306e\u6700\u521d\u306etd\" \n\nb4_path.py\nfrom bs4 import BeautifulSoup\nimport re\n\n#<SUBROUTINE>###################################################################\n# Function:     \u4efb\u610f\u30bf\u30b0\u306e\u30eb\u30fc\u30c8\u30bf\u30b0\u3092\u6c42\u3081\u308b\n################################################################################\ndef root(self):\n    if self.name == u'[document]':\n        return self\n    else:\n        return [node for node in self.parents][-1]\n\nBeautifulSoup.root = root\n\n#<SUBROUTINE>###################################################################\n# Function:     \u7c21\u6613PATH\u3067\u6307\u5b9a\u3057\u305f\u7279\u5b9a\u306e\u30bf\u30b0\u3092\u53d6\u308a\u51fa\u3059\n# \n################################################################################\ndef path(self, path):\n    re_siblings = re.compile(r'(\\w+)\\[(\\d+)\\]')\n\n    if path[0] == '/':\n        node = self.root()\n    else:\n        node = self\n\n    path = path.strip('/')\n    for arrow in path.split('/'):\n        if arrow == 'tbody':\n            continue\n\n        match = re_siblings.match(arrow)\n        if match:\n            arrow = match.group(1)\n            num   = int(match.group(2))-1\n            node  = node.find_all(arrow, recursive=False)[num]\n        else:\n            node  = getattr(node, arrow)\n    return node\n\nBeautifulSoup.path = path\n\n#<TEST>#########################################################################\n# Function:     \u30c6\u30b9\u30c8\u30eb\u30fc\u30c1\u30f3\n################################################################################\nif __name__ == '__main__':\n    soup = BeautifulSoup(\"\"\"\n<html><head><title>The Dormouse's story</title></head>\n<body>\n<p class=\"title\"><b>The Dormouse's story</b></p>\n\n<p class=\"story\">Once upon a time there were three little sisters; and their names were\n<a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\">Elsie</a>,\n<a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\">Lacie</a> and\n<a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\">Tillie</a>;\nand they lived at the bottom of a well.</p>\n\n<p class=\"story\">...</p>\n\"\"\")\n\n    print soup.path('/html/body/p[2]/a[1]').prettify()\n\n\nXML/HTML\u304b\u3089\u62bd\u51fa\u3057\u305f\u3044\u90e8\u5206\u306b\u7279\u5fb4\u306e\u3042\u308b\u30bf\u30b0\u304c\u3042\u308c\u3070\u3001BeautifulSoup\u306f\u305d\u306e\u30bf\u30b0\u3092\u30ad\u30fc\u30ef\u30fc\u30c9\u306b\u63a2\u7d22\u3067\u304d\u308b\u306e\u3067\u5927\u304d\u306a\u5a01\u529b\u3092\u767a\u63ee\u3057\u307e\u3059\u3002\u3067\u3059\u304c\u3001\u305d\u306e\u69d8\u306a\u7279\u5fb4\u306e\u3042\u308b\u30bf\u30b0\u304c\u7121\u3044\u5834\u5408\u306f\u3001\u30eb\u30fc\u30c8\u30fb\u30bf\u30b0\u304b\u3089\u76ee\u7684\u306e\u30bf\u30b0\u307e\u3067\u9806\u306b\u30bf\u30b0\u3092\u8fbf\u3063\u3066\u3044\u304f\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002BeautifulSoup\u306fXPATH\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u3053\u306e\u624b\u306e\u63a2\u7d22\u304c\u3061\u3087\u3063\u3068\u82e6\u624b\u3067\u3059\u3002\n\n\u305d\u3053\u3067\u3001\u7c21\u6613\u7684\u306apath\u6307\u5b9a\u3067\u30bf\u30b0\u3092\u6c7a\u3081\u6253\u3061\u3059\u308b\u6a5f\u80fd\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n**PATH\u306e\u6307\u5b9a\u65b9\u6cd5**\n(1)\u57fa\u672c\u5f62 - \u30bf\u30b0\u306e\u8981\u7d20\u540d\u3092'/'\u3067\u533a\u5207\u3063\u3066\u9806\u306b\u4e26\u3079\u307e\u3059\n\u3000\u3000html/body/table/tr/td\n\u3000\u3000\u3000\"body\u306e\u4e0b\u306e\u6700\u521d\u306etable\u306e\u4e0b\u306e\u6700\u521d\u306etr\u306e\u4e0b\u306e\u6700\u521d\u306etd\"\n\n(2)\u5144\u5f1f\u30bf\u30b0\u306e\u9078\u629e - \u62bd\u51fa\u3057\u305f\u3044\u30bf\u30b0\u304c\u51fa\u73fe\u3059\u308b\u9806\u756an(1\uff5e)\u3092'[n]'\u3067\u6307\u5b9a\u3057\u307e\u3059\n\u3000\u3000html/body/table[1]/tr[3]/td\n\u3000\u3000\u3000\"body\u306e\u4e0b\u306e\u4e00\u3064\u76ee\u306etable\u306e\u4e0b\u306e3\u3064\u76ee\u306etr\u306e\u4e0b\u306e\u6700\u521d\u306etd\" \n\n\n```python:b4_path.py\nfrom bs4 import BeautifulSoup\nimport re\n\n#<SUBROUTINE>###################################################################\n# Function:     \u4efb\u610f\u30bf\u30b0\u306e\u30eb\u30fc\u30c8\u30bf\u30b0\u3092\u6c42\u3081\u308b\n################################################################################\ndef root(self):\n    if self.name == u'[document]':\n        return self\n    else:\n        return [node for node in self.parents][-1]\n\nBeautifulSoup.root = root\n\n#<SUBROUTINE>###################################################################\n# Function:     \u7c21\u6613PATH\u3067\u6307\u5b9a\u3057\u305f\u7279\u5b9a\u306e\u30bf\u30b0\u3092\u53d6\u308a\u51fa\u3059\n# \n################################################################################\ndef path(self, path):\n    re_siblings = re.compile(r'(\\w+)\\[(\\d+)\\]')\n\n    if path[0] == '/':\n        node = self.root()\n    else:\n        node = self\n\n    path = path.strip('/')\n    for arrow in path.split('/'):\n        if arrow == 'tbody':\n            continue\n\n        match = re_siblings.match(arrow)\n        if match:\n            arrow = match.group(1)\n            num   = int(match.group(2))-1\n            node  = node.find_all(arrow, recursive=False)[num]\n        else:\n            node  = getattr(node, arrow)\n    return node\n    \nBeautifulSoup.path = path\n\n#<TEST>#########################################################################\n# Function:     \u30c6\u30b9\u30c8\u30eb\u30fc\u30c1\u30f3\n################################################################################\nif __name__ == '__main__':\n    soup = BeautifulSoup(\"\"\"\n<html><head><title>The Dormouse's story</title></head>\n<body>\n<p class=\"title\"><b>The Dormouse's story</b></p>\n\n<p class=\"story\">Once upon a time there were three little sisters; and their names were\n<a href=\"http://example.com/elsie\" class=\"sister\" id=\"link1\">Elsie</a>,\n<a href=\"http://example.com/lacie\" class=\"sister\" id=\"link2\">Lacie</a> and\n<a href=\"http://example.com/tillie\" class=\"sister\" id=\"link3\">Tillie</a>;\nand they lived at the bottom of a well.</p>\n\n<p class=\"story\">...</p>\n\"\"\")\n\n    print soup.path('/html/body/p[2]/a[1]').prettify()\n```\n"}