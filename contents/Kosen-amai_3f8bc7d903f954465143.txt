{"tags": ["PowerShell", "ActiveDirectory"], "context": "\n\n \u30b3\u30fc\u30c9\n\n\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u8868\u793a\nImport-Module ActiveDirectory\n\n# \u5168\u30e6\u30fc\u30b6\u30fc\u3092\u8868\u793a\nGet-ADUser -Filter * -Properties * | \n    Select-Object displayName,name,enabled,sAMAccountName,userPrincipalName,emailAddress,canonicalName | \n    Out-GridView\n\n# \"User\"\u3067\u59cb\u307e\u308b\u30e6\u30fc\u30b6\u30fc\u3092\u8868\u793a\nGet-ADUser -Filter {sAMAccountName -like \"User*\"} -Properties * | \n    Select-Object displayName,name,enabled,sAMAccountName,userPrincipalName,emailAddress,canonicalName | \n    Out-GridView\n\n\n\n\u30b0\u30eb\u30fc\u30d7\u60c5\u5831\u8868\u793a\nImport-Module ActiveDirectory\n\n# \u5168\u30b0\u30eb\u30fc\u30d7\u3092\u8868\u793a\nGet-ADGroup -Filter * -Properties * | \n    Select-Object displayName,name,sAMAccountName,GroupCategory,GroupScope,mail,member | \n    Out-GridView\n\n\n\n\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\nImport-Module ActiveDirectory\n\n<#\n\u30e6\u30fc\u30b6\u30fc\u300cADUser001\u300d\u306e\u4f5c\u6210\n\u3000\u3000\u25a1\u30e6\u30fc\u30b6\u30fc\u306f\u6b21\u56de\u30ed\u30b0\u30aa\u30f3\u6642\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u304c\u5fc5\u8981\n\u3000\u3000\u25a1\u30e6\u30fc\u30b6\u30fc\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\u3067\u304d\u306a\u3044\n\u3000\u3000\u25a0\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u7121\u671f\u9650\u306b\u3059\u308b\n\u3000\u3000\u25a1\u30a2\u30ab\u30a6\u30f3\u30c8\u306f\u7121\u52b9\n#>\n$password1 = ConvertTo-SecureString -AsPlainText \"akuD3!%fjzi0lnQ#\" -Force\nNew-ADUser -Name ADUser001 -DisplayName \u30e6\u30fc\u30b6\u30fc1 -ChangePasswordAtLogon $false -CannotChangePassword $false -PasswordNeverExpires $true -Enabled $true -AccountPassword $password1 -Description \"\u25cb\u25cb\u7528\u306e\u30e6\u30fc\u30b6\u30fc\"\n\n\n# OU\u4f5c\u6210\nNew-ADOrganizationalUnit -Name TestOU -ProtectedFromActidentalDeletion $true\n# \u5927\u91cf\u306b\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\uff08TestUser_00001\uff5eTestUser_15000\uff09\n$password2 = ConvertTo-SecureString -AsPlainText \"test#pswd123%zo0Ol1i\" -Force\n1..15000 | ForEach-Object {\n    [string]$userName = \"TestUser_{0:D5}\" -f $_\n    [string]$dispName = \"\u30c6\u30b9\u30c8\u30e6\u30fc\u30b6\u2015_{0:D5}\" -f $_\n\n    New-ADUser -Name $userName -DisplayName $dispName -Path \"OU=TestOU,DC=testDc,DC=local\"  -ChangePasswordAtLogon $false -CannotChangePassword $false -PasswordNeverExpires $true -Enabled $true -AccountPassword $password2 -Description \"\u30c6\u30b9\u30c8\u7528\u306e\u30e6\u30fc\u30b6\u30fc\"\n}\n\n\n\n\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\nImport-Module ActiveDirectory\n\n# \u30b0\u30eb\u30fc\u30d7\u306e\u4f5c\u6210\nNew-ADGroup -Name Group001 -DisplayName \u30b0\u30eb\u30fc\u30d71 -GroupScope Universal -GroupCategory Security -Description \"\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\"\nNew-ADGroup -Name Group002 -DisplayName \u30b0\u30eb\u30fc\u30d72 -GroupScope Global -GroupCategory Distribution -Description \"\u30b0\u30ed\u30fc\u30d0\u30eb\u914d\u5e03\u30b0\u30eb\u30fc\u30d7\"\nNew-ADGroup -Name Group003 -DisplayName \u30b0\u30eb\u30fc\u30d73 -sAMAccountName SAM_Group003 -OtherAttribute @{'mail'='group003mail@hoge.piyo.jp'; 'mailNickName'='nnGroup003'} -GroupScope Universal -GroupCategory Security\n\n# \u30b0\u30eb\u30fc\u30d7\u3078\u306e\u30e1\u30f3\u30d0\u8ffd\u52a0\nAdd-ADGroupMember -Identity Group001 -Members User_A, User_B\n\n\n\n \u53c2\u8003\u30b5\u30a4\u30c8\n\nGet-ADUser - TechNet\nGet-ADGroup - TechNet\nNew-ADOrganizationalUnit - TechNet\nNew-ADUser - TechNet\nNew-ADGroup - TechNet\nAdd-ADGroupMember - TechNet\n\n# <i class=\"fa fa-file-text-o\" style=\"font-size:1em;\"></i> \u30b3\u30fc\u30c9\n\n```PowerShell:\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u8868\u793a\nImport-Module ActiveDirectory\n\n# \u5168\u30e6\u30fc\u30b6\u30fc\u3092\u8868\u793a\nGet-ADUser -Filter * -Properties * | \n    Select-Object displayName,name,enabled,sAMAccountName,userPrincipalName,emailAddress,canonicalName | \n    Out-GridView\n\n# \"User\"\u3067\u59cb\u307e\u308b\u30e6\u30fc\u30b6\u30fc\u3092\u8868\u793a\nGet-ADUser -Filter {sAMAccountName -like \"User*\"} -Properties * | \n    Select-Object displayName,name,enabled,sAMAccountName,userPrincipalName,emailAddress,canonicalName | \n    Out-GridView\n```\n\n```PowerShell:\u30b0\u30eb\u30fc\u30d7\u60c5\u5831\u8868\u793a\nImport-Module ActiveDirectory\n\n# \u5168\u30b0\u30eb\u30fc\u30d7\u3092\u8868\u793a\nGet-ADGroup -Filter * -Properties * | \n    Select-Object displayName,name,sAMAccountName,GroupCategory,GroupScope,mail,member | \n    Out-GridView\n```\n\n```PowerShell:\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\nImport-Module ActiveDirectory\n\n<#\n\u30e6\u30fc\u30b6\u30fc\u300cADUser001\u300d\u306e\u4f5c\u6210\n\u3000\u3000\u25a1\u30e6\u30fc\u30b6\u30fc\u306f\u6b21\u56de\u30ed\u30b0\u30aa\u30f3\u6642\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u304c\u5fc5\u8981\n\u3000\u3000\u25a1\u30e6\u30fc\u30b6\u30fc\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\u3067\u304d\u306a\u3044\n\u3000\u3000\u25a0\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u7121\u671f\u9650\u306b\u3059\u308b\n\u3000\u3000\u25a1\u30a2\u30ab\u30a6\u30f3\u30c8\u306f\u7121\u52b9\n#>\n$password1 = ConvertTo-SecureString -AsPlainText \"akuD3!%fjzi0lnQ#\" -Force\nNew-ADUser -Name ADUser001 -DisplayName \u30e6\u30fc\u30b6\u30fc1 -ChangePasswordAtLogon $false -CannotChangePassword $false -PasswordNeverExpires $true -Enabled $true -AccountPassword $password1 -Description \"\u25cb\u25cb\u7528\u306e\u30e6\u30fc\u30b6\u30fc\"\n\n\n# OU\u4f5c\u6210\nNew-ADOrganizationalUnit -Name TestOU -ProtectedFromActidentalDeletion $true\n# \u5927\u91cf\u306b\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\uff08TestUser_00001\uff5eTestUser_15000\uff09\n$password2 = ConvertTo-SecureString -AsPlainText \"test#pswd123%zo0Ol1i\" -Force\n1..15000 | ForEach-Object {\n    [string]$userName = \"TestUser_{0:D5}\" -f $_\n    [string]$dispName = \"\u30c6\u30b9\u30c8\u30e6\u30fc\u30b6\u2015_{0:D5}\" -f $_\n\n    New-ADUser -Name $userName -DisplayName $dispName -Path \"OU=TestOU,DC=testDc,DC=local\"  -ChangePasswordAtLogon $false -CannotChangePassword $false -PasswordNeverExpires $true -Enabled $true -AccountPassword $password2 -Description \"\u30c6\u30b9\u30c8\u7528\u306e\u30e6\u30fc\u30b6\u30fc\"\n}\n```\n\n```PowerShell:\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\nImport-Module ActiveDirectory\n\n# \u30b0\u30eb\u30fc\u30d7\u306e\u4f5c\u6210\nNew-ADGroup -Name Group001 -DisplayName \u30b0\u30eb\u30fc\u30d71 -GroupScope Universal -GroupCategory Security -Description \"\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\"\nNew-ADGroup -Name Group002 -DisplayName \u30b0\u30eb\u30fc\u30d72 -GroupScope Global -GroupCategory Distribution -Description \"\u30b0\u30ed\u30fc\u30d0\u30eb\u914d\u5e03\u30b0\u30eb\u30fc\u30d7\"\nNew-ADGroup -Name Group003 -DisplayName \u30b0\u30eb\u30fc\u30d73 -sAMAccountName SAM_Group003 -OtherAttribute @{'mail'='group003mail@hoge.piyo.jp'; 'mailNickName'='nnGroup003'} -GroupScope Universal -GroupCategory Security\n\n# \u30b0\u30eb\u30fc\u30d7\u3078\u306e\u30e1\u30f3\u30d0\u8ffd\u52a0\nAdd-ADGroupMember -Identity Group001 -Members User_A, User_B\n```\n\n# <i class=\"fa fa-book\" style=\"font-size:1em;\"></i> \u53c2\u8003\u30b5\u30a4\u30c8\n* [Get-ADUser - TechNet](https://technet.microsoft.com/ja-jp/library/ee617241.aspx)\n* [Get-ADGroup - TechNet](https://technet.microsoft.com/ja-jp/library/ee617196.aspx)\n* [New-ADOrganizationalUnit - TechNet](https://technet.microsoft.com/ja-jp/library/ee617237.aspx)\n* [New-ADUser - TechNet](https://technet.microsoft.com/ja-jp/library/ee617253.aspx)\n* [New-ADGroup - TechNet](https://technet.microsoft.com/ja-jp/library/ee617258.aspx)\n* [Add-ADGroupMember - TechNet](https://technet.microsoft.com/ja-jp/library/ee617210.aspx)\n"}