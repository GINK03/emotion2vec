{"context": " More than 1 year has passed since last update.\n\n\u304d\u3063\u304b\u3051\n\u5148\u6708CloudFront\u306e\u30a2\u30af\u30bb\u30b9\u6570\u306a\u3069\u306fCloudWatch\u3067\u898b\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3057\u304b\u3057S3\u306e\u30a2\u30af\u30bb\u30b9\u72b6\u6cc1\u306f\u305d\u306e\u3088\u3046\u306aMetrics\u304c\u306a\u304f\u3001\u30ed\u30b0\u3092\u89e3\u6790\u3059\u308b\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u30a2\u30af\u30bb\u30b9\u898f\u6a21\u304c\u5c0f\u3055\u304f\u3066EMR\u3092\u6301\u3061\u51fa\u3059\u307b\u3069\u5927\u3052\u3055\u3067\u306f\u306a\u3044\u5834\u5408\u3001lambda\u3067\u51e6\u7406\u3059\u308c\u3070\u697d\u306b\u53ef\u8996\u5316\u307e\u3067\u6301\u3063\u3066\u884c\u3051\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u8003\u3048\u307e\u3057\u305f\u3002\n\n\u5b9f\u88c5\nlambda2cw\n\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304cPUT\u3055\u308c\u305f\u6642\u306b\u30d5\u30c3\u30af\u3057\u3066\u3001\u30ed\u30b0\u3092\u89e3\u6790\u3057\u3066CloudWatch\u306e\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\u3068\u3057\u3066PutMericData\u3092\u884c\u3044\u307e\u3059\u3002\n\u60f3\u5b9a\u3068\u3057\u3066\u306f\u3001bucket\u5185\u306elogs/ \u304b\u3089\u59cb\u307e\u308b\u30ad\u30fc\u304c\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30c7\u30e2\n\n\u8ca0\u8377\u3092\u767a\u751f\n\u9069\u5f53\u306bab\u3067\u8ca0\u8377\u3092\u304b\u3051\u307e\u3059\u3002\n$ while [ 1 ] ; do ( ab -c 4 -n $(echo $[ $RANDOM % 100 ]) http://lambda2cw.s3-us-west-2.amazonaws.com/index.html & ); sleep 60 ; done\n\n\n\u30ed\u30fc\u30ab\u30eb\u5b9f\u884c\n$ node invoke.js input.json\nlambda2cw Started\nprocessing s3://lambda2cw/logs/2014-12-07-20-17-45-0C579438788F858B\n20 metrics pushed. 46 left\n20 metrics pushed. 26 left\n20 metrics pushed. 6 left\n6 metrics pushed. 0 left\nSUCCESS undefined\n\n\nlambda\u4e0a\u3067\u5b9f\u884c\n2014-12-08 06:18:22 UTC 2014-12-08T06:18:22.723Z    6alf80tr75guxrdo    lambda2cw Started \n2014-12-08 06:18:24 UTC START RequestId: 18e0b9ed-7ea2-11e4-bae6-95e15fd35a15 \n2014-12-08 06:18:24 UTC 2014-12-08T06:18:24.262Z    18e0b9ed-7ea2-11e4-bae6-95e15fd35a15    processing s3://lambda2cw/logs/2014-12-08-06-18-18-EF79DF76713F7118 \n2014-12-08 06:18:25 UTC 2014-12-08T06:18:25.563Z    18e0b9ed-7ea2-11e4-bae6-95e15fd35a15    20 metrics pushed. 38 left \n2014-12-08 06:18:26 UTC 2014-12-08T06:18:26.742Z    18e0b9ed-7ea2-11e4-bae6-95e15fd35a15    20 metrics pushed. 18 left \n2014-12-08 06:18:27 UTC 2014-12-08T06:18:27.903Z    18e0b9ed-7ea2-11e4-bae6-95e15fd35a15    18 metrics pushed. 0 left \n2014-12-08 06:18:27 UTC END RequestId: 18e0b9ed-7ea2-11e4-bae6-95e15fd35a15 \n2014-12-08 06:18:27 UTC REPORT RequestId: 18e0b9ed-7ea2-11e4-bae6-95e15fd35a15  Duration: 3798.96 ms    Billed Duration: 3800 ms Memory Size: 128 MB    Max Memory Used: 18 MB  \n\n\nCloudWatch\u306e\u30b0\u30e9\u30d5\u3092\u78ba\u8a8d\n\n# \u304d\u3063\u304b\u3051\n[\u5148\u6708CloudFront\u306e\u30a2\u30af\u30bb\u30b9\u6570\u306a\u3069\u306fCloudWatch\u3067\u898b\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002](http://aws.typepad.com/aws_japan/2014/11/cloudfront-up-trends-metrics-stats.html)\n\n\u3057\u304b\u3057S3\u306e\u30a2\u30af\u30bb\u30b9\u72b6\u6cc1\u306f\u305d\u306e\u3088\u3046\u306aMetrics\u304c\u306a\u304f\u3001\u30ed\u30b0\u3092\u89e3\u6790\u3059\u308b\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u30a2\u30af\u30bb\u30b9\u898f\u6a21\u304c\u5c0f\u3055\u304f\u3066EMR\u3092\u6301\u3061\u51fa\u3059\u307b\u3069\u5927\u3052\u3055\u3067\u306f\u306a\u3044\u5834\u5408\u3001lambda\u3067\u51e6\u7406\u3059\u308c\u3070\u697d\u306b\u53ef\u8996\u5316\u307e\u3067\u6301\u3063\u3066\u884c\u3051\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u8003\u3048\u307e\u3057\u305f\u3002\n\n# \u5b9f\u88c5\n[lambda2cw](https://gist.github.com/j3tm0t0/cac294821526e323cc03)\n\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u304cPUT\u3055\u308c\u305f\u6642\u306b\u30d5\u30c3\u30af\u3057\u3066\u3001\u30ed\u30b0\u3092\u89e3\u6790\u3057\u3066CloudWatch\u306e\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\u3068\u3057\u3066PutMericData\u3092\u884c\u3044\u307e\u3059\u3002\n\u60f3\u5b9a\u3068\u3057\u3066\u306f\u3001bucket\u5185\u306elogs/ \u304b\u3089\u59cb\u307e\u308b\u30ad\u30fc\u304c\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3068\u306a\u308a\u307e\u3059\u3002\n\n# \u30c7\u30e2\n\n## \u8ca0\u8377\u3092\u767a\u751f\n\u9069\u5f53\u306bab\u3067\u8ca0\u8377\u3092\u304b\u3051\u307e\u3059\u3002\n\n```\n$ while [ 1 ] ; do ( ab -c 4 -n $(echo $[ $RANDOM % 100 ]) http://lambda2cw.s3-us-west-2.amazonaws.com/index.html & ); sleep 60 ; done\n```\n\n## \u30ed\u30fc\u30ab\u30eb\u5b9f\u884c\n\n```\n$ node invoke.js input.json\nlambda2cw Started\nprocessing s3://lambda2cw/logs/2014-12-07-20-17-45-0C579438788F858B\n20 metrics pushed. 46 left\n20 metrics pushed. 26 left\n20 metrics pushed. 6 left\n6 metrics pushed. 0 left\nSUCCESS undefined\n```\n\n## lambda\u4e0a\u3067\u5b9f\u884c\n\n```\n2014-12-08 06:18:22 UTC\t2014-12-08T06:18:22.723Z\t6alf80tr75guxrdo\tlambda2cw Started \n2014-12-08 06:18:24 UTC\tSTART RequestId: 18e0b9ed-7ea2-11e4-bae6-95e15fd35a15 \n2014-12-08 06:18:24 UTC\t2014-12-08T06:18:24.262Z\t18e0b9ed-7ea2-11e4-bae6-95e15fd35a15\tprocessing s3://lambda2cw/logs/2014-12-08-06-18-18-EF79DF76713F7118 \n2014-12-08 06:18:25 UTC\t2014-12-08T06:18:25.563Z\t18e0b9ed-7ea2-11e4-bae6-95e15fd35a15\t20 metrics pushed. 38 left \n2014-12-08 06:18:26 UTC\t2014-12-08T06:18:26.742Z\t18e0b9ed-7ea2-11e4-bae6-95e15fd35a15\t20 metrics pushed. 18 left \n2014-12-08 06:18:27 UTC\t2014-12-08T06:18:27.903Z\t18e0b9ed-7ea2-11e4-bae6-95e15fd35a15\t18 metrics pushed. 0 left \n2014-12-08 06:18:27 UTC\tEND RequestId: 18e0b9ed-7ea2-11e4-bae6-95e15fd35a15 \n2014-12-08 06:18:27 UTC\tREPORT RequestId: 18e0b9ed-7ea2-11e4-bae6-95e15fd35a15\tDuration: 3798.96 ms\tBilled Duration: 3800 ms Memory Size: 128 MB\tMax Memory Used: 18 MB\t\n```\n\n## CloudWatch\u306e\u30b0\u30e9\u30d5\u3092\u78ba\u8a8d\n![Graph](http://g.s3w.jp/ab7a873b.png \"CloudWatch\")\n", "tags": ["S3", "CloudWatch", "lambda", "AWS"]}