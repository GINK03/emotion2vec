{"context": "\n\n\u306f\u3058\u3081\u306b\n\nSpringBoot 1.3.5\u3067\u66f8\u304d\u76f4\u3057\u307e\u3057\u305f\u3002\nSpringFramework\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u3067\u5229\u7528\u3055\u308c\u3001\u67af\u308c\u305f\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306a\u306e\u3067\u54c1\u8cea\u7684\u306b\u3082\u5b89\u5fc3\u611f\u304c\u3042\u308a\u307e\u3059\u3057\u3001Spring\u3068Spring\u306e\u30b5\u30d6\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6a5f\u80fd\u306f\u975e\u5e38\u306b\u591a\u5c90\u306b\u6e21\u308a\u307e\u3059\u3002\nSpringBoot\u306f\u79c1\u306e\u3088\u3046\u306bSpring\u306b\u8a73\u3057\u304f\u306a\u304f\u3066\u3082\u7c21\u5358\u306bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nSpringFramework\u306e\u60c5\u5831\u306fWeb\u4e0a\u306b\u6ca2\u5c71\u5b58\u5728\u3057\u307e\u3059\u304c\u3001Spring\u521d\u5fc3\u8005\u306b\u306f\u3069\u308c\u304c\u3069\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u5229\u7528\u3067\u304d\u308b\u3053\u3068\u306a\u306e\u304b\u304c\u308f\u304b\u308a\u306b\u304f\u304f\u6238\u60d1\u3046\u3053\u3068\u304c\u591a\u3044\u306e\u3067\u3059\u3002\u305d\u3053\u3067\u3001\u4eca\u56de\u52c9\u5f37\u3057\u305f\u3053\u3068\u3092\u691c\u7d22\u3057\u3084\u3059\u3044\u3088\u3046\u306b\uff11\u30da\u30fc\u30b8\u306b\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f\u3002\n\u3067\u304d\u308b\u3060\u3051\u516c\u5f0f\u30b5\u30a4\u30c8\u3078\u306e\u53c2\u7167\u3092\u8cbc\u3063\u3066\u3042\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u63a2\u3059\u7cf8\u53e3\u304c\u308f\u304b\u308b\u3068\u826f\u3044\u3068\u601d\u3063\u305f\u306e\u3067\u63a2\u3057\u65b9\u3082\u3067\u304d\u308b\u3060\u3051\u8a18\u8f09\u3057\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n\u81ea\u5206\u306e\u30e1\u30e2\u7684\u306a\u611f\u3058\u3067\u8a18\u8f09\u3057\u3066\u3044\u308b\u306e\u3067\u8a18\u8f09\u304c\u8352\u3044\u3068\u3053\u308d\u306f\u3054\u5bb9\u8d66\u304f\u3060\u3055\u3044\u3002\u9593\u9055\u3044\u306a\u3069\u3042\u308c\u3070\u3054\u6307\u6458\u3044\u305f\u3060\u3051\u308c\u3070\u52a9\u304b\u308a\u307e\u3059\u3002\n\n\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff082016/6/8\u8ffd\u8a18\uff09\n\n\u30b5\u30f3\u30d7\u30eb\u304c\u3042\u3063\u305f\u65b9\u304c\u3088\u3055\u305d\u3046\u306a\u306e\u3067\u3001\u7c21\u5358\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u30ed\u30b0\u30a4\u30f3\u30fb\u30ed\u30b0\u30a2\u30a6\u30c8\u3001\u30e6\u30fc\u30b6\u767b\u9332\u3001iTunesSearchAPI\u3092\u4f7f\u3063\u305f\u7c21\u5358\u306a\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u304c\u53c2\u8003\u306b\u306a\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u3061\u3089\u30821.3.5\u306b\u5408\u308f\u305b\u3066\u4fee\u6b63\u3057\u307e\u3057\u305f\u3002\nhttps://github.com/uzresk/springboot-samples.git\n\n\nSpringBoot\u3068\u306f\uff1f\n\n\u8a2d\u5b9a\u697d\u3005Spring\uff1dSpringBoot\u3068\u3044\u3046\u611f\u3058\u3002\u7169\u308f\u3057\u3044\u8a2d\u5b9a\u3092\u884c\u308f\u305aSpring\u304c\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\u521d\u671f\u8a2d\u5b9a\u306fMaven or Gradle\u3067pom\u3092\u304b\u3051\u3070\u5b8c\u4e86\u3002\u4f9d\u5b58\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u304a\u3059\u3059\u3081\u306e\u7d44\u307f\u5408\u308f\u305b\u306f\u81ea\u52d5\u3067\u6c7a\u307e\u308a\u307e\u3059\u3002\nSpring\u306e\u57fa\u672c\u7684\u306a\u8a2d\u5b9a\u306f\u81ea\u52d5\u3067\u884c\u308f\u308c\u307e\u3059\u3002web.xml\u3059\u3089\u7121\u304f\u306a\u308a\u307e\u3059\u3002\nAP\u30b5\u30fc\u30d0\u306fEmbededTomcat\u5229\u7528\u3057\u3066\u304a\u308a\u3001\u30c7\u30d7\u30ed\u30a4\u306fwar\u3067\u306f\u306a\u304fjar\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3059\u3002\uff08\u8d77\u52d5\u306fjava -jar xx.jar\u3067\u884c\u3044\u307e\u3059\u3002\uff09\nTomcat\u304c\u5acc\u306a\u65b9\u306fJetty\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u753b\u9762\u306e\u958b\u767a\u306b\u306fJSP\u306f\u63a8\u5968\u3055\u308c\u307e\u305b\u3093\u3002Thymeleaf,Velocity\u306a\u3069\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nhttp://docs.spring.io/spring-boot/docs/1.3.5.RELEASE/reference/htmlsingle/#boot-features-spring-mvc-template-engines\nJSPs should be avoided if possible, there are several known limitations when using them with embedded servlet containers.\n\n\n\n\n\u524d\u63d0\uff08\u74b0\u5883\uff09\n\nJava8\nMaven3.0.4\nSpringBoot1.3.5\n\n\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\nThymeleaf(\u65e5\u672c\u8a9e\u8a33)\nSpringBoot\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u30ac\u30a4\u30c9\uff08\u82f1\u8a9e\uff09\n\n\n\u306f\u3058\u3081\u306b\u8a2d\u5b9a\u3057\u305f\u3044\u3082\u306e\n\n\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092scan\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5909\u66f4\u3059\u308b\u3002\n\nscan\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u3064\u3044\u3066\u306f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fSpringBoot\u3092\u8d77\u52d5\u3059\u308b\u30af\u30e9\u30b9\u914d\u4e0b\u304c\u81ea\u52d5\u3067\u30b9\u30ad\u30e3\u30f3\u3055\u308c\u307e\u3059\u304c\u3001\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u30b9\u30ad\u30e3\u30f3\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u79c1\u306e\u5834\u5408\u306fComponent\u306fWeb,Batch\u3067\u305d\u308c\u305e\u308c\u4f5c\u6210\u3057\u3001Entity\u3001Repository\u306fWeb,Batch\u3067\u5171\u7528\u3057\u305f\u304b\u3063\u305f\u306e\u3067\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u305f\u3002\n\nComponent\n\n@ComponentScan(basePackages = \"org.xxx\")\n\n\n\nJpaRepository\n\n@EnableJpaRepositories(basePackages = \"org.xxx.repository\")\n\n\n\nEntity\u30af\u30e9\u30b9\n\n@EntityScan(basePackages = \"org.xxx.entity\")\n\n\n\u307e\u3068\u3081\u3066\u66f8\u304f\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n\nApp.java\n@EnableAutoConfiguration\n@ComponentScan(basePackages = \"org.xxx\")\n@EnableJpaRepositories(basePackages = \"org.xxx.repository\")\n@EntityScan(basePackages = \"org.xxx.entity\")\npublic class App {\n  \u30fb\u30fb\u30fb\n}\n\n\n\n\u30ed\u30b0\u306e\u8a2d\u5b9a\n\nslf4j+logback\u3092\u4f7f\u3046\u306e\u304c\u4fbf\u5229\u3067\u3057\u3087\u3046\u3002log4j\u3068\u5927\u5dee\u306a\u3044\u306e\u3067\u3059\u3093\u306a\u308a\u5165\u308c\u308b\u306f\u305a\u3067\u3059\u3002sfl4j+logback\u3092\u6291\u3048\u308b\u306b\u306f\u3053\u3061\u3089\u306eURL\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n\npom\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\u5fc5\u8981\u306b\u5fdc\u3058\u3066jcl\u3068\u304b\u3092\u3064\u3063\u3053\u307f\u307e\u3059\u3002\nslf4j+logback\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5229\u7528\u53ef\u80fd\u3067\u3059\u306e\u3067\u3001pom\u306e\u5909\u66f4\u306f\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n\u3042\u3068\u306flogback.xml\u3092resource\u914d\u4e0b\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002logback.xml\u306f\u9069\u5f53\u306b\u3002\u4e00\u756a\u30b7\u30f3\u30d7\u30eb\u306a\u4f8b\u3092\u4e0a\u3052\u3066\u304a\u304d\u307e\u3059\u3002\n\n\nlogback.xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE logback>\n<configuration>\n    <include resource=\"org/springframework/boot/logging/logback/base.xml\"/>\n    <logger name=\"com.amazonaws\" level=\"INFO\"/>\n    <logger name=\"org.hibernate\" level=\"ERROR\"/>\n    <logger name=\"org.springframework\" level=\"INFO\"/>\n    <logger name=\"org.thymeleaf\" level=\"INFO\"/>\n</configuration>\n\n\n\nimport\u3057\u3066\u3044\u308bbase.xml\u3092\u898b\u308b\u3068\u308f\u304b\u308a\u307e\u3059\u304c\u3001java\u306e\u30b7\u30b9\u30c6\u30e0\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u4f7f\u3046\u3053\u3068\u3067\u30d5\u30a1\u30a4\u30eb\u306e\u51fa\u529b\u5834\u6240\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n-Dlogging.file=/var/log/my.log\n\n\n\u305d\u306e\u307b\u304b\u3001log.path\u306a\u3069\u306e\u8a2d\u5b9a\u3082\u3042\u308a\u307e\u3059\u306e\u3067\u53c2\u8003\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u53c2\u8003\uff1a66.1 Configure Logback for logging\n\n\n\n\u30ed\u30b0\u306e\u8a2d\u5b9a - logback.xml\u306e\u5dee\u3057\u66ff\u3048\n\nlogback\u306f\u901a\u5e38-Dlogback.configurationFile=/foo/bar/logback.xml\u3068\u3059\u308c\u3070\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5dee\u3057\u66ff\u3048\u304c\u3067\u304d\u307e\u3059\u304c\u3001SpringBoot\u3067\u306f\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u30d7\u30ed\u30d1\u30c6\u30a3\u306f\u7121\u52b9\u5316\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u305d\u3093\u306a\u3068\u304d\u306f\u3053\u3093\u306a\u98a8\u306b\u3057\u307e\u3059\u3002\n-Dlogging.config=/foo/bar/logback.xml\n\n\n\n\n\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092UTF-8\u306b\u3059\u308b\u3002\n\nFiter\u306e\u8a2d\u5b9a\u3092\u5f53\u521d\u8a18\u8f09\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001Spring Boot 1.2\u304b\u3089\u306f\u81ea\u52d5\u3067CharacterEncodingFilter\u304c\u767b\u9332\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u7279\u306b\u8a2d\u5b9a\u306f\u4e0d\u8981\u3067\u3059\u3002\n\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0 on AWS\n\nAWS\u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8003\u3048\u3066\u307f\u305f\u7d50\u679c\u3001DynamoDB\u304c\u3088\u3055\u305d\u3046\u306a\u306e\u3067\u8a66\u3057\u3066\u307f\u305f\u3002\n\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u3092\u585e\u3050\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u306b\u306f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u671b\u307e\u3057\u304f\u306a\u3044\u60c5\u5831\u304c\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u8868\u793a\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\u8a2d\u5b9a\u3059\u308b\u4e00\u3064\u306e\u65b9\u6cd5\u306ftemplates\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u76f4\u4e0b\u306berror.html\u3092\u7f6e\u304f\u3053\u3068\u3067\u3059\u3002\u3053\u308c\u3067\u3069\u3093\u306a\u30a8\u30e9\u30fc\u3067\u3082error.html\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u3088\u308a\u7d30\u304b\u3044\u5236\u5fa1\u306fErrorMvcAutoConfiguration\u3092\u30aa\u30fc\u30d0\u30e9\u30a4\u30c9\u3057\u3066\u5b9f\u73fe\u3057\u307e\u3059\u3002\n\u53c2\u8003\uff1a70.2 Customize the \u2018whitelabel\u2019 error page\n\n\n\n\u958b\u767a\u6642\u306b\u8a2d\u5b9a\u3059\u308b\u3082\u306e\n\nThymeleaf\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092OFF\u306b\u3059\u308b\u3002\n\nThymeleaf\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u52b9\u3044\u3066\u3044\u308b\u3068\u5909\u66f4\u3057\u305f\u3042\u3068\u5373\u53cd\u6620\u3055\u308c\u307e\u305b\u3093\u3002\u958b\u767a\u6642\u306b\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u3092OFF\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u53c2\u8003\uff1ahttp://docs.spring.io/spring-boot/docs/current/reference/html/howto-hotswapping.html#howto-reload-thymeleaf-content\n\n\n\napplication.yml\nspring.thymeleaf.cache: false\n\n\n\n\u30db\u30c3\u30c8\u30c7\u30d7\u30ed\u30a4\n\nSpringBoot\u3067\u3082Seasar\u3067\u8a00\u3046\u3068\u3053\u308d\u306e\u30db\u30c3\u30c8\u30c7\u30d7\u30ed\u30a4\u3067\u304d\u307e\u3059\u3002\n\u53c2\u8003\uff1a72.6 Reload Java classes without restarting the container\n\n\n\nspring-loaded\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nhttps://github.com/spring-projects/spring-loaded\n\n\nEclipse\u3067\u958b\u767a\u3057\u3066\u3044\u308b\u6642\u306b\u306f\u3001SpringBoot\u8d77\u52d5\u6642\u306e\u5b9f\u884c\u69cb\u6210\u306eVM\u5f15\u6570\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n-javaagent:/springloaded-1.2.1.RELEASE.jar -noverify\n\n\n\n\nspring loaded\u306f\u307e\u3060\u307e\u3060\u767a\u5c55\u9014\u4e0a\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u826f\u304f\u4e0a\u304c\u308b\u306e\u3067\u30de\u30e1\u306b\u30b5\u30a4\u30c8\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3066\u6700\u65b0\u7248\u3092\u9069\u7528\u3057\u307e\u3057\u3087\u3046\u3002\nmaven\u3067\u5b9f\u884c\u3059\u308b\u5834\u5408\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306bpom\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n\npom.xml\n                <dependencies>\n                    <dependency>\n                        <groupId>org.springframework</groupId>\n                        <artifactId>springloaded</artifactId>\n                        <version>1.2.1.RELEASE</version>\n                    </dependency>\n                </dependencies>\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u5207\u308a\u66ff\u3048\u308b\n\n\u79c1\u306e\u5834\u5408\u306f\u3001\u4f1a\u793e\u3067\u306f\u30ed\u30fc\u30ab\u30eb\u306ePostgreSQL\u3001\u5bb6\u3067\u306fSSLVPN\u7d4c\u7531\u3067AWS\u306ePostgreSQL(RDS\uff09\u3002\u3068\u3044\u3046\u611f\u3058\u3067\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\u901a\u5e38\u306e\u958b\u767a\u6642\u3067\u3082\u958b\u767a\u30fb\u30b9\u30c6\u30fc\u30b8\u30f3\u30b0\u30fb\u672c\u756a\u3068\u304b\u3067\u8a2d\u5b9a\u3092\u5207\u308a\u66ff\u3048\u305f\u3044\u3067\u3059\u3088\u306d\u3002\u305d\u3046\u3044\u3068\u304d\u306fProfile\u3092\u4f7f\u3044\u307e\u3059\u3002\napplication.yml\u3067\u306f\u3001---\u3067\u533a\u5207\u308a\u3002profiles:\u306b\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n\napplication.yml\nspring:\n    profiles: dev-aws\n    thymeleaf:\n        cache: false\n    datasource:\n        url: jdbc:postgresql://foobar:5432/cmp\n        username: foo\n        password: bar\n    jpa:\n        database-platform: org.hibernate.dialect.PostgreSQLDialect\n---\nspring:\n    profiles: production\n    thymeleaf:\n        cache: true\n    datasource:\n        url: jdbc:postgresql://hogehoge:5432/cmp\n        username: foo\n        password: bar\n    jpa:\n        database-platform: org.hibernate.dialect.PostgreSQLDialect\n\n\n\n\u3042\u3068\u306fVM\u5f15\u6570(-Dspring.profiles.active)\u306b\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u66f8\u3044\u3066SpringBoot\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\ncommand.sh\njava -Dspring.profiles.active=production -jar /home/ec2-user/XXX-0.0.1-SNAPSHOT.jar &\n\n\n\n\u753b\u9762\u7cfb\u306e\u5b9f\u88c5\n\n\u8a2d\u5b9a\u306e\u65b9\u6cd5\n\nPOM\u3092\u7de8\u96c6\u3057\u3001spring mvc\u3068thymeleaf\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u3052\u307e\u3059\u3002\n\n\npom.xml\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-thymeleaf</artifactId>\n        </dependency>\n\n\n\n\u5024\u3092\u8868\u793a\u3059\u308b\n\ncontroller.java\nmodel.addAttribute(\"hoge\", hoge);\n\n\n\nthymeleaf.template\n<span th:text=\"${hoge}\"></span>\n\n\n\n\u30cd\u30b9\u30c8\u3055\u308c\u305f\u5024\u3092\u8868\u793a\u3059\u308b\n\u4e0b\u8a18\u306e\u4f8b\u3067\u306ffoo\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306bgetBar()\u3068\u3044\u3046Getter\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\nthymeleaf.template\n<span th:text=\"${foo.bar}\"></span>\n\n\n\n\u65e5\u4ed8\u3092\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3059\u308b\u3002\n\nthymeleaf.template\n${#dates.format([java.util.Date\u30aa\u30d6\u30b8\u30a7\u30af\u30c8], 'yyyy/MM/dd')}\n\n\n\nList\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8868\u793a\u3057\u305f\u3044\u3002\n\ncontroller.java\nList<Image> images = new ArrayList<Image>();\nmodel.addAttribute(\"images\", images);\n\n\n\nthymeleaf.template\n<tr th:each=\"image : ${images}\">\n  <td th:text=\"${image.name}\">test1</td>\n  <td th:text=\"${image.description}\">test1</td>\n  <td th:text=\"${image.imageId}\">test1</td>\n  <td th:text=\"${image.state}\">test1</td>\n  <td th:text=\"${image.architecture}\">test1</td>\n  <td th:text=\"${image.imageType}\">test1</td>\n</tr>\n\n\n\nMap\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8868\u793a\u3057\u305f\u3044\u3002\n\n\u5e74\u306e\u30d7\u30eb\u30c0\u30a6\u30f3\u3092\u4f5c\u308b\u4f8b\u3092\u4f7f\u3063\u3066\u8aac\u660e\u3057\u307e\u3059\u3002Map\u306e\u4e2d\u306b2014:2014\u3068\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002get\u3084keySet\u306a\u3069\u306f\u305d\u306e\u307e\u307e\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\n\nthymeleaf.template\n<select th:field=\"*{year}\" class=\"selectpicker\" data-width=\"75px\">\n  <option th:each=\"key : ${years.keySet()}\"\n          th:value=\"${key}\"\n          th:text=\"${years.get(key)}\">pulldown</option>\n</select>\n\n\n\nSession\u306b\u3042\u308b\u30ad\u30fc\u306e\u5b58\u5728\u6709\u7121\u3067\u30dc\u30bf\u30f3\u306e\u8868\u793a\u975e\u8868\u793a\u3092\u5236\u5fa1\u3059\u308b\u3002\n\nthymeleaf\u3067\u3082JSP\u306e\u3088\u3046\u306b\u6697\u9ed9\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u3042\u308a\u307e\u3059\u3002session\u4e0a\u306bfoo\u3068\u3044\u3046\u30ad\u30fc\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306b\u306e\u307f\u300c\u53d6\u6d88\u300d\u30ea\u30f3\u30af\u3092\u8868\u793a\u3059\u308b\u306b\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\nthymeleaf.template\n<a th:if=\"${session.containsKey('foo')}\" th:href=\"@{/hoge}\">\n    <button type=\"button\"  class=\"btn btn-danger\">\u53d6\u6d88</button>\n</a>\n\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9001\u308a\u305f\u3044\u30fb\u53d7\u3051\u53d6\u308a\u305f\u3044\n\nGET\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9001\u308b\u3002\n\n\nthymeleaf.template\n<a th:href=\"@{/foo/bar(hoge=${hoge},fuga=true)}\">\n    <button type=\"button\"  class=\"btn btn-success\">\u30dc\u30bf\u30f3\u540d</button>\n</a> \n\n\n\nController\u3067GET\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u53d7\u3051\u53d6\u308b\u3002\n\n\nController.java\n@RequestMapping(value = \"/foo/bar\", method = RequestMethod.GET)\nString images(@RequestParam String hoge,\n              @RequestParam String fuga) {\n\n\n\nForm\u3092\u4f7f\u3063\u3066\u5024\u306e\u53d6\u5f97\u3092\u884c\u3046(POST)\n\nAController\u3067\u306f\u5bfe\u5fdc\u3059\u308bForm\u3092\u5ba3\u8a00\u3057\u3066\u304a\u304d\u3001\u521d\u671f\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n@ModelAttribute\u3067\u5ba3\u8a00\u3055\u308c\u305f\u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u6642\u306b\u81ea\u52d5\u3067\u547c\u3070\u308c\u307e\u3059\u3002\uff08\u30e1\u30bd\u30c3\u30c9\u540d\u306f\u4efb\u610f\u3067\u3001@ModelAttribute\u304c\u4ed8\u3044\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u304c\u91cd\u8981\u3067\u3059\u3002\uff09\uff09\n\n\nAController.java\n@ModelAttribute\nHogeForm setUpForm() {\n    return new HogeForm();\n}\n\n@RequestMapping(value = \"/hoge\", method = RequestMethod.GET)\nString hoge(HogeForm form) {\n  // \u521d\u671f\u5024\u3092\u8a2d\u5b9a\n  form.setName('name');\n}\n\n\n\nthymeleaf.template\n<form class=\"form\" th:action=\"@{/hoge/confirm}\" th:object=\"${hogeForm}\" method=\"POST\">\n  <button type=\"submit\" id=\"submit\" class=\"btn btn-primary\">\u30dc\u30bf\u30f3\u540d</button>\n</form>\n\n\nPOST\u3055\u308c\u305f\u5024\u306fBController\u306e\u5f15\u6570\u306b\u81ea\u52d5\u3067\u5165\u308a\u307e\u3059\u3002\n\nBController.java\n@RequestMapping(value = \"/hoge/confirm\", method = RequestMethod.POST)\nString hogeConfirm(HogeForm form) {\n  System.out.println(form.getName());\n}\n\n\n\n\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u3002\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u306b\u5024\u3092\u5f15\u304d\u6e21\u3059\u3002\n\n\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u306b\u306f\u3001Controller\u306e\u8fd4\u5374\u5024\u306eprefix\u306bredirect:\u3068\u4ed8\u3051\u308b\u3060\u3051\u3067\u3059\u3002\nreturn \"redirect:/foo/bar\"\n\n\n\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u306b\u5024\u3092\u6e21\u3059\u306b\u306fRedirectAttributes\u3092\u4f7f\u3044\u307e\u3059\u3002\u3053\u308c\u3092\u4f7f\u3046\u3068\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u3067model\u306b\u5024\u3092\u518d\u5ea6\u30bb\u30c3\u30c8\u3059\u308b\u5fc5\u8981\u3082\u306a\u3044\u306e\u3067\u4fbf\u5229\u3067\u3059\u306d\u3002\n\n\nController.java\n    @RequestMapping(value = \"/to\", method = RequestMethod.GET)\n    String to(Model model, @RequestParam String foo,\n            @RequestParam String bar,\n            RedirectAttributes attributes) {\n        attributes.addFlashAttribute(\"CompleteMessage\", completeMessage);\n                return \"redirect:/hoge\";\n        }\n\n\n\n\n\u5358\u9805\u76ee\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u88c5\u3057\u305f\u3044\u3002\n\n\u5358\u9805\u76ee\u30c1\u30a7\u30c3\u30af\u306fForm\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308b\u3053\u3068\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306fBean Validation\u306e\u5b9f\u88c5\u3067\u3042\u308bhibernate validator\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u4ed8\u4e0e\u3067\u304d\u308b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u3092\u53c2\u7167\nhttps://access.redhat.com/documentation/ja-JP/JBoss_Enterprise_Application_Platform/5/html-single/Hibernate_Validator_Reference_Guide/index.html#validator-defineconstraints-builtin\n\n\nForm.java\n@Data\n@NoArgsConstructor\npublic class ReserveForm implements Serializable {\n\n    public static final long serialVersionUID = 1L;\n\n    @NotEmpty\n    private String hour;\n\n    @NotEmpty\n    private String minutes;\n}\n\n\n\n\u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u306eForm\u306e\u524d\u306b@Validated\u3092\u4ed8\u3051\u308b\u3053\u3068\u3067\u30c1\u30a7\u30c3\u30af\u304c\u52d5\u304d\u307e\u3059\u3002\n\u5165\u529b\u30c1\u30a7\u30c3\u30af\u306e\u7d50\u679c\u306fBindingResult\u306b\u5165\u308a\u307e\u3059\u3002\u3053\u306e\u4f8b\u3067\u306f\u5165\u529b\u30c1\u30a7\u30c3\u30af\u3067\u30a8\u30e9\u30fc\u306b\u6210\u3063\u305f\u3089\u5165\u529b\u753b\u9762\u306b\u623b\u3057\u3066\u3044\u307e\u3059\u3002\n\u3010\u8981\u6ce8\u610f\u3011BindingResult\u306fForm\u306e\u3059\u3050\u5f8c\u308d\u306b\u8a18\u8f09\u3057\u306a\u3044\u3068\u52d5\u304d\u307e\u305b\u3093\u3002\n\n\nController.java\n@RequestMapping(value = \"reserveAMI/complete\", method = RequestMethod.POST)\nString reserveAMIComplete(@Validated AwsAMIReserveForm form,\nBindingResult result, Model model) {\n\n        // \u5165\u529b\u30c1\u30a7\u30c3\u30af\n        if (result.hasErrors()) {\n            createDropDownList(model);\n            return \"input\";\n        }\n}\n\n\n\n\n@NotNull/@NotEmpty/@NotBlank\u306e\u9055\u3044\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u5b58\u5728\u3059\u308b\u306e\u306b\u5024\u304c\u306a\u3044\u3002\u305d\u3093\u306a\u5834\u5408\u306f@NotEmpty\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u8a73\u7d30\u306f\u3053\u3061\u3089\u306e\u30da\u30fc\u30b8\u306b\u307e\u3068\u307e\u3063\u3066\u3044\u307e\u3059\u3002\n\n\n\u76f8\u95a2\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u88c5\u3057\u305f\u3044\u3002\n\ncontroller\u3067Injection\u3059\u308b\u306e\u3067\u3001\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8(@Component)\u3068\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002\nvalidate\u30e1\u30bd\u30c3\u30c9\u3067\u306fForm\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30ad\u30e3\u30b9\u30c8\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002\nrejectValue\u306e\u7b2c\u4e00\u5f15\u6570\u306f\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3002\u7b2c\u4e8c\u5f15\u6570\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u30b3\u30fc\u30c9\u3002\u7b2c\u4e09\u5f15\u6570\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u30b3\u30fc\u30c9\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u53d6\u5f97\u3067\u304d\u306a\u304b\u3063\u305f\u5834\u5408\u306b\u8868\u793a\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u306a\u308a\u307e\u3059\u3002\n\u7b2c\u4e00\u5f15\u6570\u3068\u306a\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u306b\u5bfe\u5fdc\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u306fForm\u306b\u5b58\u5728\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n\u76f8\u95a2\u30c1\u30a7\u30c3\u30af\u30af\u30e9\u30b9.java\n@Component\npublic class AccountValidator implements Validator {\n\n    @Override\n    public boolean supports(Class<?> clazz) {\n        return AccountCreateForm.class.isAssignableFrom(clazz);\n    }\n\n    @Override\n    public void validate(Object target, Errors errors) {\n\n        AccountCreateForm form = (AccountCreateForm) target;\n\n                //\u5165\u529b\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u88c5\n                \u30fb\u30fb\u30fb\n\n                // \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u57cb\u3081\u8fbc\u307f\n        errors.rejectValue(\"accountId\",\n                \"AccountValidator.duplicateAccountId\", \"\u30e1\u30c3\u30bb\u30fc\u30b8\");\n    }\n}\n\n\n\n\nValidator\u3092Controller\u306bInjection\u3057\u3066\u3001initBinder\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\nvalidator\u3092WebDataBinder\u306badd\u3057\u3066\u304a\u304f\u3053\u3068\u3067\u3001\u5358\u9805\u76ee\u30c1\u30a7\u30c3\u30af\u304c\u52d5\u304f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u76f8\u95a2\u30c1\u30a7\u30c3\u30af\u3082\u52d5\u304d\u307e\u3059\u3002\n\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u4ed5\u65b9\u306b\u3064\u3044\u3066\u306f\u5358\u9805\u76ee\u30c1\u30a7\u30c3\u30af\u3068\u540c\u69d8\u306a\u306e\u3067\u5272\u611b\u3057\u307e\u3059\u3002\n\n\ncontroller.java\n\n    @Autowired\n    AccountValidator accountValidator;\n\n    @InitBinder\n    public void initBinder(WebDataBinder binder) {\n        binder.addValidators(accountValidator);\n    }\n\n\n\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u305f\u3044\n\n\u30de\u30cb\u30e5\u30a2\u30eb\u304b\u3089\u5f15\u7528\u3057\u307e\u3059\u3002\nthymeleaf\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3059\u308b\u306b\u306f#\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n<p th:utext=\"#{home.welcome}\">Welcome to our grocery store!</p>\n\n\n\u5f15\u6570\u4ed8\u304d\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\n\n<p th:utext=\"#{home.welcome(${session.user.name})}\">\n  Welcome to our grocery store, Sebastian Pepper!\n</p>\n\n\n\u5165\u529b\u30c1\u30a7\u30c3\u30af\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u5909\u66f4\u3057\u305f\u3044\u3002\n\nsrc/main/resuorce/ValidationMessages_ja.properties\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u30e1\u30c3\u30bb\u30fc\u30b8ID\u3092\u30aa\u30fc\u30d0\u30e9\u30a4\u30c9\u3057\u307e\u3059\u3002\n\n\n\u30b5\u30fc\u30d0\u5074\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4f5c\u308a\u305f\u3044\u3002\n\n\u30b5\u30fc\u30d0\u5074\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4f5c\u3063\u3066\u30ed\u30b0\u3084\u753b\u9762\u306b\u8868\u793a\u3057\u305f\u3044\u30b1\u30fc\u30b9\u3067\u4f7f\u3044\u307e\u3059\u3002Controller\u3067\u306e\u5b9f\u88c5\u3092\u4f8b\u306b\u3068\u308a\u307e\u3059\u3002\nMessageSource\u3092injection\u3057\u307e\u3059\u3002\n\n    @Autowired\n    MessageSource messageSource;\n\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u30ad\u30fc\u3001\u5f15\u6570\u3002\u7b2c\u4e09\u5f15\u6570\u306b\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3001\u7b2c\u56db\u5f15\u6570\u306b\u306f\u30ed\u30b1\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nmessageSource.getMessage(\"messageId\",\n             new String[] { argument },\n             \"defaultMessage\", Locale.JAPAN);\n\n\n\u30a8\u30e9\u30fc\u306e\u5b58\u5728\u6709\u7121\u3092\u5224\u5b9a\u3057\u305f\u3044\n\n\u30a8\u30e9\u30fc\u304c\u5b58\u5728\u3057\u305f\u5834\u5408\u753b\u9762\u4e0a\u90e8\u306b\u5171\u901a\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3060\u3057\u305f\u3044\u3002\u3068\u3044\u3046\u3068\u304d\u306b\u306f\u4e0b\u8a18\u3092\u57cb\u3081\u8fbc\u307f\u307e\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u3067\u306f\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u3089\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30ad\u30fccommon.error\u306b\u7d10\u4ed8\u304f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\nthymeleaf.template\n        <div th:if=\"${#fields.hasErrors('all')}\" class=\"alert alert-danger\">\n           <p th:text=\"#{common.error}\">ErrorMessage</p>\n        </div>\n\n\n\n\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u6a2a\u306b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u305f\u3044\n\n\u30c6\u30ad\u30b9\u30c8\u306e\u6a2a\u306b\u4e0b\u8a18\u3092\u57cb\u3081\u8fbc\u307f\u307e\u3059\u3002\uff08\u5225\u306bspan\u3067\u3042\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\uff09\n\u30b5\u30f3\u30d7\u30eb\u3067\u306freserveType\u3068\u3044\u3046\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a8\u30e9\u30fc\u304c\u3042\u3063\u305f\u3089\u305d\u308c\u306b\u7d10\u4ed8\u304f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3059\u308b\u5834\u5408\u306e\u8a18\u8f09\u65b9\u6cd5\u3067\u3059\u3002\n\n\nthymeleaf.template\n<span th:if=\"${#fields.hasErrors('reserveType')}\" class=\"text-danger\" th:errors=\"*{reserveType}\">Error</span>\n\n\n\n\u30a8\u30e9\u30fc\u6642\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u30b9\u30bf\u30a4\u30eb\u3092\u5909\u3048\u305f\u3044\n\n\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u306e\u67a0\u306f\u8d64\u304f\u3057\u305f\u3044\u3002\u306a\u3069\u306e\u5834\u5408\u306f\u4e0b\u8a18\u3092\u57cb\u3081\u8fbc\u307f\u307e\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u3067\u306ftwitter bootstrap\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002hoge\u3068\u3044\u3046\u9805\u76ee\u304c\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u5834\u5408\u306bform-group\u306e\u30af\u30e9\u30b9\u540d\u3092\u5909\u66f4\u3057\u3066\u3044\u307e\u3059\u3002\n\n\nthymeleaf.template\n      <div class=\"form-group\" th:classappend=\"${#fields.hasErrors('hoge')}? 'has-error has-feedback'\">\n        <label for=\"cron\">\u9805\u76ee\u540d</label>\n        <input type=\"text\" id=\"hoge\" name=\"hoge\" th:field=\"*{hoge}\" class=\"form-control\" style=\"width:75px;\"/>\n      </div>\n\n\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n\n\u8a2d\u5b9a\n\n\u8a8d\u8a3c\u30fb\u8a8d\u53ef\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\u306b\u306fSpringSecurity\u3092\u5229\u7528\u3057\u307e\u3059\u3002\npom\u3092\u7de8\u96c6\u3059\u308b\u3060\u3051\u3067\u5229\u7528\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002springsecurity\u3068\u5408\u308f\u305b\u3066\u3001thymeleaf\u3067springsecurity\u306e\u6a5f\u80fd\u3092\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\npom.xml\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-security</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.thymeleaf.extras</groupId>\n            <artifactId>thymeleaf-extras-springsecurity3</artifactId>\n        </dependency>\n\n\n\n\u8a8d\u8a3c\n\n\u30ed\u30b0\u30a4\u30f3\u5468\u308a\u306e\u8a2d\u5b9a\u306fWebSecurityConfigurerAdapter\u3092\u7d99\u627f\u3057\u305fConfiguration\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u304c\u5168\u3066\u3067\u3059\u3002\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3053\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u3084\u3063\u3066\u307e\u3059\u3002\n\n\n\u8a8d\u8a3c\u304c\u5fc5\u8981\u306a\u30da\u30fc\u30b8\u3067\u8a8d\u8a3c\u3055\u308c\u3066\u306a\u304b\u3063\u305f\u3089/loginForm\u306b\u98db\u3070\u3059\u3002\n\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u306f/loginForm\n\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u308b\u3068accountId\u3068password\u304c/login\u306bPOST\u3055\u308c\u308b\u3002\n\u30ed\u30b0\u30a4\u30f3\u304c\u6210\u529f\u3057\u305f\u3089/top\u306b\u98db\u3070\u3059\u3002\nlogin\u30a8\u30e9\u30fc\u306e\u5834\u5408\u306f/loginForm?error\u306b\u98db\u3070\u3059\u3002\n\u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\u306f/logout\u3002\u30ed\u30b0\u30a2\u30a6\u30c8\u6210\u529f\u5f8c\u306f/loginForm\u306b\u98db\u3070\u3059\u3002\n\n\nAuthenticationConfiguration\u306f\u8a8d\u8a3c\u51e6\u7406\u6642\u306epasswordEncoder\u3092\u4f5c\u3063\u3066\u6e21\u3057\u3066\u3042\u3052\u3066\u307e\u3059\u3002\n\n\nSecurityConfig.java\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http.authorizeRequests().antMatchers(\"/loginForm\").permitAll()\n                .anyRequest().authenticated();\n\n        http.formLogin().loginProcessingUrl(\"/login\").loginPage(\"/loginForm\")\n                .failureUrl(\"/loginForm?error\").defaultSuccessUrl(\"/top\", true)\n                .usernameParameter(\"accountid\").passwordParameter(\"password\")\n                .and();\n\n        http.logout()\n                .logoutRequestMatcher(new AntPathRequestMatcher(\"/logout**\"))\n                .logoutSuccessUrl(\"/loginForm\");\n\n    }\n\n    @Configuration\n    static class AuthenticationConfiguration extends\n            GlobalAuthenticationConfigurerAdapter {\n\n        @Autowired\n        UserDetailsService userDetailsService;\n\n        @Bean\n        PasswordEncoder passwordEncoder() {\n            return new BCryptPasswordEncoder();\n        }\n\n        @Override\n        public void init(AuthenticationManagerBuilder auth) throws Exception {\n            auth.userDetailsService(userDetailsService).passwordEncoder(\n                    passwordEncoder());\n        }\n    }\n}\n\n\n\n\u9759\u7684\u30b3\u30f3\u30c6\u30f3\u30c4\u306f\u8a8d\u53ef\u306e\u5bfe\u8c61\u304b\u3089\u9664\u5916\u3057\u305f\u3044\n        @Override\n        public void configure(WebSecurity web) throws Exception {\n            web.ignoring().antMatchers(\"/css/**\", \"/js/**\",\"/fonts/**\", \"/img/**\");\n        }\n\n\n\n\u8a8d\u8a3c\u60c5\u5831\u306b\u4efb\u610f\u306e\u60c5\u5831\u3092\u57cb\u3081\u305f\u3044\n\n\u8a8d\u8a3c\u51e6\u7406\u5f8c\u306b\u30e6\u30fc\u30b6\u306b\u7d10\u4ed8\u304f\u4ed8\u5c5e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u3069\u3053\u304b\u3089\u3067\u3082\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3044\u3067\u3059\u3088\u306d\u3002\n\n\nUser\u3092\u7d99\u627f\u3057\u305f\u5165\u308c\u7269\u3092\u4f5c\u6210\u3059\u308b\u3002 \nUserDetailService\u3092\u7d99\u627f\u3057\u305f\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n\n\u3053\u3053\u3067\u306fRepository\u3092\u4f7f\u3063\u3066\u30a2\u30ab\u30a6\u30f3\u30c8ID\u306b\u7d10\u4ed8\u304f\u60c5\u5831\u3092\u53d6\u5f97\u5f8cUserDetails\u3068\u3057\u3066\u8fd4\u5374\u3057\u3066\u3044\u307e\u3059\n\n\nLoginAccountDetails.java\npublic class LoginAccountDetails extends User {\n\n    private static final long serialVersionUID = 1L;\n\n    @Getter\n    private final Account account;\n\n    @Getter\n    private final AccountInfo accountInfo;\n\n    public LoginAccountDetails(Account account, AccountInfo accountInfo) {\n        super(account.getAccountId(), account.getPassword(), AuthorityUtils\n                .createAuthorityList(\"USER\"));\n        this.account = account;\n        this.accountInfo = accountInfo != null ? accountInfo : new AccountInfo();\n    }\n}\n\n\n\n\nLoginAccountDetailService.java\n@Service\npublic class LoginAccountDetailService implements UserDetailsService {\n\n    @Autowired\n    AccountRepository accountRepository;\n\n    @Autowired\n    AccountInfoRepository accountInfoRepository;\n\n    @Override\n    public UserDetails loadUserByUsername(String accountId)\n            throws UsernameNotFoundException {\n        Account account = accountRepository.findOne(accountId);\n        if (account == null) {\n            throw new UsernameNotFoundException(\"Account is not found\");\n        }\n        AccountInfo accountInfo = accountInfoRepository\n                .findOne(new AccountInfoPk(accountId));\n        return new LoginAccountDetails(account, accountInfo);\n    }\n}\n\n\n\n\u8a8d\u8a3c\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\nController\u3067\u8a8d\u8a3c\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f@AuthenticationPrincipal\u3092\u4ed8\u4e0e\u3057\u305f\u5f15\u6570\u3092\u4e0e\u3048\u3066\u3042\u3052\u308b\u3060\u3051\u3067\u3059\u3002\norg.springframework.security.web.bind.annotation.AuthenticationPrincipal\u306fdeprecated\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u3001org.springframework.security.core.annotation.AuthenticationPrincipal\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\n\n\ncontroller.java\n    @RequestMapping(value = \"images\", method = RequestMethod.GET)\n    String images(@RequestParam String instanceId,\n            @AuthenticationPrincipal LoginAccountDetails loginAccountDetails,\n            Model model) {\n\n\n\n\n\u30ed\u30fc\u30eb\u3092\u4f7f\u3063\u305f\u8868\u793a\u5236\u5fa1\n\nsec:authorize=\"hasRole('\u30ed\u30fc\u30eb\u540d')\"\u3092\u4f7f\u3046\u3068\u30ed\u30fc\u30eb\u3092\u6301\u3063\u3066\u3044\u308b\u30e6\u30fc\u30b6\u306b\u3057\u304b\u305d\u306e\u30bb\u30af\u30b7\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n\nlayout.html\n        <div id=\"navbar\" class=\"navbar navbar-inverse\" sec:authorize=\"hasRole('USER')\">\n            <div class=\"container\">\n             \u30fb\u30fb\u30fb\n            </div>\n        </div>\n\n\n\nSession Fixation\u5bfe\u7b56\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u5f8c\u306b\u30bb\u30c3\u30b7\u30e7\u30f3ID\u306f\u81ea\u52d5\u3067\u5909\u66f4\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u6b63\u3057\u304f\u306f\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u60c5\u5831\u3092\u5f15\u304d\u7d99\u3044\u3067\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u5909\u66f4\u3057\u3066\u3044\u307e\u3059\u3002\n\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u60c5\u5831\u3092\u5f15\u304d\u7d99\u304c\u305a\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u5909\u66f4\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n// \u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u5909\u66f4\u3057\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u65b0\u3057\u304f\u4f5c\u308a\u76f4\u3059\nhttp.sessionManagement().sessionFixation().newSession();\n\n\nSpringBoot\u3067TOTP\u3092\u5229\u7528\u3057\u305fMFA\u3001Facebook/Twitter\u30ed\u30b0\u30a4\u30f3\u3092\u5b9f\u88c5\u3057\u305f\u3044\n\nJava(SpringBoot)\u3067TOTP(Time-based One-time Password),twitter/facebook\u30ed\u30b0\u30a4\u30f3\u3092\u5b9f\u73fe\u3059\u308b\n\u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u306e\u8ffd\u52a0\u65b9\u6cd5\u306b\u3064\u3044\u3066\u3082\u8a18\u8f09\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30fb\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\n\n\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u306e\u8a2d\u5b9a\n\napplication.yml\u306eHOST,PORT,DATABASE,USERNAME,PASSWORD\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002Database\u306e\u65b9\u8a00\u3092\u5438\u53ce\u3059\u308b\u305f\u3081\u306eDiarect\u3082\u5408\u308f\u305b\u3066\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4e0b\u8a18\u306fPostgreSQL\u306e\u4f8b\u3067\u3059\u3002\n\nspring:\n    datasource:\n        url: jdbc:postgresql://HOST:PORT/DATABASE\n        username: USERNAME\n        password: PASSWORD\n    jpa:\n        database-platform: org.hibernate.dialect.PostgreSQLDialect\n\n\n\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5883\u754c\n\n\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308b\u3053\u3068\u3067\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5883\u754c\u3092\u8a2d\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u975e\u30c1\u30a7\u30c3\u30af\u4f8b\u5916(RuntimeException)\u304c\u767a\u751f\u3057\u306a\u3044\u3068\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3057\u307e\u305b\u3093\u3002\u4f8b\u3048\u3070Exception\u3092\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u5168\u3066\u304cthrow\u3055\u308c\u305f\u6642\u306b\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3059\u308b\u306b\u306f\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u5f15\u6570\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u307e\u3059\u3002\n\n\nXXXService.java\n@Component\n@Transactional(rollbackOn = Exception.class)\npublic class AwsEbsService extends ReservationService {\n \u30fb\u30fb\u30fb\n}\n\n\n\nJPA\n\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8URL\nhttp://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/htmlsingle/#boot-features-jpa-and-spring-data\n\nJPA\u306e\u521d\u671f\u8a2d\u5b9a\n\nPOM\u306b\u8ffd\u8a18\u3059\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\n\npom.xml\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-jpa</artifactId>\n</dependency>\n\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306eCRUD\n\nPrimaryKey\u3067\u306eCRUD\u306fEntity\u3092\u4f5c\u308b\u2192Repository\u3092\u4f5c\u308b\u3002\u3067\u5b8c\u4e86\u3067\u3059\u3002\u5236\u7d04\u306a\u3069\u306f\u5168\u3066Entity\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u5b9f\u73fe\u3057\u307e\u3059\u3057\u3001Repository\u3082\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5207\u308b\u3060\u3051\u3067\u3059\u3002\nJPA\u306e\u4ed5\u69d8\u306b\u5247\u3063\u3066\u3044\u308b\u306e\u3067\u3053\u3053\u3067\u4f5c\u3063\u305fEntity\u306f\u5b9f\u88c5\u304c\u5909\u308f\u3063\u3066\u3082\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002(JavaEE7\u306eJPA\u5b9f\u88c5\u3067\u3042\u308bEclipseLink\u3067\u3082\u52d5\u304d\u307e\u3059\uff09\nEntity\u30af\u30e9\u30b9\u306e\u4f8b(lombok\u3092\u4f7f\u7528\uff09\u306f\u3053\u3061\u3089\u3002\u4ed8\u4e0e\u3059\u308b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306f[\u3053\u3061\u3089]\u304c\u53c2\u8003\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002(http://otndnld.oracle.co.jp/products/ias/toplink/jpa/resources/toplink-jpa-annotations.html)\n\n\nAccount.java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\n@Entity\n@Table(name=\"account\")\npublic class Account implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    /** \u30a2\u30ab\u30a6\u30f3\u30c8ID */\n    @Id\n    @Column(name = \"account_id\")\n    private String accountId;\n\n    /** \u30d1\u30b9\u30ef\u30fc\u30c9 */\n    @Column(name = \"password\")\n    private String password;\n\n    /** \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9 */\n    @Column(name = \"mail\")\n    private String mail;\n\n}\n\n\n\nRepository\u306fJpaRepository\u3092\u7d99\u627f\u3057\u305f\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3067\u3059\u3002\u7d99\u627f\u3059\u308b\u3060\u3051\u3067CRUD\u306e\u64cd\u4f5c\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nJPA\u3092\u3088\u304f\u77e5\u3089\u306a\u3044\u4eba\u306f\u81ea\u5206\u3067SQL\u66f8\u3044\u3066\u30b4\u30ea\u30b4\u30ea\u3084\u308b\u306e\u3068\u5c11\u3057\u9055\u3046\u306e\u3067Repository\u3067\u306e\u64cd\u4f5c\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3093\u3067\u52c9\u5f37\u3057\u3066\u304a\u304f\u3053\u3068\u3002\nhttp://terasolunaorg.github.io/guideline/public_review/ArchitectureInDetail/DataAccessJpa.html#repository\n\n\nRepositry.java\n@Repository\npublic interface AccountRepository extends JpaRepository<Account, String> {\n\n}\n\n\n\n\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\n\n\u8d77\u52d5\u3059\u308b\u30dd\u30fc\u30c8\u3092\u5909\u66f4\u3059\u308b\u3002\n\nembedded tomcat\u306e\u8d77\u52d5\u3059\u308b\u30dd\u30fc\u30c8\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nserver:\nport: 18080\n\n\n\n\n\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\nspring boot\u3092\u8d77\u52d5\u3055\u305b\u308b\u3068\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u307e\u305b\u3093\u3002\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u306b/app\u304c\u4ed8\u4e0e\u3055\u308c\u3001RequestMapping\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306ePrefix\u306b\u81ea\u52d5\u3067\u4ed8\u4e0e\u3055\u308c\u52d5\u304d\u307e\u3059\u3002\nserver:\ncontextPath: /app\n\n\n\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306f\u8a2d\u5b9a\u3055\u308c\u307e\u305b\u3093\u3002\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u3088\u308d\u3057\u304f\u306a\u3044\u306e\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u5358\u4f4d\u306f\u79d2\u3067\u3059\u3002\nserver:\nsession-timeout: 900\n\n\n\n\n\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u88c5\u3057\u305f\u3044\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304b\u3089\u306e\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u306f\u3044\u3064\u3082\u7c21\u5358\u306aServlet\u3092\u4f5c\u3063\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3084\u691c\u7d22\u30a8\u30f3\u30b8\u30f3\u304c\u751f\u304d\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u3044\u307e\u3057\u305f\u3002Spring-Actuator\u3092\u4f7f\u3048\u3070\u5b9f\u88c5\u304c\u4e0d\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\u53c2\u8003\uff1ahttp://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#production-ready-health\n\n\n\npom.xml\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n\n\n\napplication.yml\nmanagement:\n    contextPath: /management\n    port: 8081\n    security.enabled: false\n\n\n\n\u3053\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u3068port8081\u306e/management\u3068\u3044\u3046\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u306bactuator\u304c\u7a3c\u50cd\u3057\u307e\u3059\u3002\u3053\u306e\u72b6\u614b\u3067\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u306eURL\u3092\u53e9\u3044\u3066\u307f\u307e\u3059\u3002\n\nhttp://localhost:8081/management/health\n\n{\"status\":\"UP\",\"database\":\"PostgreSQL\",\"hello\":1}\n\n\n\u3068\u3044\u3046\u3053\u3068\u3067LB\u304b\u3089\u306fUP\u3068\u3044\u3046\u6587\u5b57\u304c\u5165\u3063\u3066\u3044\u308b\u304b\u5426\u304b\u3067\u5224\u65ad\u3059\u308c\u3070\u826f\u3055\u305d\u3046\u3067\u3059\u306d\u3002\n\n\n\u8d77\u52d5\u30fb\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\n\n\u3053\u308c\u307e\u3067\u306f\u81ea\u524d\u3067sh\u3092\u4f5c\u3063\u3066\u3044\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001init.d service\u3068\u3057\u3066\u52d5\u304f\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u7d20\u6674\u3089\u3057\u3044\uff01\n/etc/init.d/myapp\u306b\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308a\u307e\u3059\u3002\n\nsudo ln -s /var/myapp/myapp.jar /etc/init.d/myapp\n\n\n\u30e9\u30f3\u30ec\u30d9\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nchkconfig myapp on\n\n\n\u8d77\u52d5\u3057\u307e\u3059\u3002\n\nservice myapp start\n\n\n\u74b0\u5883\u5909\u6570\u3084VM\u306e\u5f15\u6570\u306b\u3064\u3044\u3066\u306fjar\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306bconf\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\u3059\u308b\u3060\u3051\u3067OK\u3067\u3059\u3002\n\n\nmyapp.conf\nAPP_NAME=cmp-web\nPID_FOLDER=/var/run/cmp-web\n\numask 002\n\nJAVA_OPTS=\"-Dspring.profiles.active=production -Dlog.path=/var/log/cmp-web\"\n\n\n\n\u756a\u5916\u7de8\n\nSpringBoot\u3067\u8d77\u52d5\u3059\u308btomcat\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u5909\u3048\u305f\u3044\n\n\nSpringBoot\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u5909\u3048\u305f\u304f\u306a\u3044\u3093\u3060\u3051\u3069tomcat\u306e\u30de\u30a4\u30ca\u30fc\u30d0\u30fc\u30b8\u30e7\u30f3\u3060\u3051\u306f\u8106\u5f31\u6027\u306b\u5bfe\u3059\u308b\u5bfe\u5fdc\u304c\u3055\u308c\u305f\u3082\u306e\u306b\u5909\u66f4\u3057\u305f\u3044\u3002\u3068\u3044\u3046\u5834\u5408\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u3092\u3069\u3046\u305e\n\n\n\nwar\u3067\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u3044\u3002\n\n\n74.1 Create a deployable war file\u306b\u8a18\u8f09\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u79c1\u306e\u74b0\u5883\u3067\u306f\u305d\u308c\u3060\u3051\u3067\u306f\u4e0a\u624b\u304f\u3044\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\npom\u306epackaging\u3092war\u306b\u3057\u307e\u3059\u3002\n\n\npom.xml\n<packaging>jar</packaging>\n\n\n\nSpringBoot\u3092\u8d77\u52d5\u3059\u308b\u30af\u30e9\u30b9\u3092SpringBootServletInitializer\u3092\u7d99\u627f\u3055\u305b\u3001configure\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\nApp.java\npublic class App extends SpringBootServletInitializer {\n\n    private static Log logger = new Log(App.class);\n\n    public static void main(String[] args) throws Exception {\n        ApplicationContext ctx = SpringApplication.run(App.class, args);\n\n        String[] beanNames = ctx.getBeanDefinitionNames();\n        Arrays.sort(beanNames);\n        for (String beanName : beanNames) {\n            logger.info(beanName);\n        }\n    }\n\n    @Override\n    protected SpringApplicationBuilder configure(\n            SpringApplicationBuilder application) {\n\n        return application.sources(App.class);\n    }\n\n}\n\n\n\nstarter-tomcat\u306escope\u3092provided\u306b\u3057\u307e\u3059\u3002\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-tomcat</artifactId>\n            <scope>provided</scope>\n        </dependency>\n\n\n\u3053\u308c\u3060\u3051\u3067\u4e0a\u624b\u304f\u3044\u304f\u306f\u305a\u3067\u3059\u304c\u79c1\u306e\u5834\u5408\u306f\uff12\u3064\u624b\u9806\u3092\u8db3\u3057\u307e\u3057\u305f\u3002\n\uff11\uff0e warplugin\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u3001web.xml\u304c\u7121\u304f\u3066\u3082\u30a8\u30e9\u30fc\u306b\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u304a\u304f\u3002\n\n            <plugin>\n                <artifactId>maven-war-plugin</artifactId>\n                <version>2.4</version>\n                <configuration>\n                    <failOnMissingWebXml>false</failOnMissingWebXml>\n                </configuration>\n            </plugin>\n\n\uff12\uff0espring-boot-starter-actuator\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3059\u308b\u3002\n\nSpringBoot\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u3082\u306e\u3092\u63a2\u3057\u305f\u3044\u3002\n\n\u8a2d\u5b9a\u306f\u30af\u30e9\u30b9\u30d1\u30b9\u76f4\u4e0b\u306eapplication.properties\u304bapplication.yml\u3067\u884c\u3044\u307e\u3059\u3002\n\u3069\u3061\u3089\u3092\u4f7f\u3046\u304b\u306b\u3064\u3044\u3066\u306f\u304a\u597d\u307f\u3067\u3059\u3002(\u500b\u4eba\u7684\u306b\u306fYAML\u306e\u307b\u3046\u304c\u898b\u3084\u3059\u304f\u3066\u826f\u3044\u6c17\u304c\u3057\u3066\u307e\u3059\uff09\n\u3053\u306e\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\u306b\u8a18\u8f09\u3055\u308c\u3066\u304a\u3089\u305a\u3001\u8a2d\u5b9a\u3067\u304d\u308b\u3082\u306e\u306b\u3064\u3044\u3066\u306fSpringBoot Common application properties\u3092\u53c2\u7167\u3057\u3066\u304b\u3089\u30b0\u30b0\u308b\u3068\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n\n\nh2 database\u3092\u7c21\u5358\u306b\u4f7f\u3044\u305f\u3044\n\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306a\u3069\u3092\u4f5c\u308b\u3068\u304d\u306bDB\u3092\u5916\u306b\u7528\u610f\u3059\u308b\u306e\u9762\u5012\u3067\u3059\u3088\u306d\u3002\n\u305d\u3046\u3044\u3046\u3068\u304d\u306fh2\u3092\u4f7f\u3046\u3068\u4fbf\u5229\u3067\u3059\u3002SpringBoot1.3.0M4\u304b\u3089\u306f\u3088\u308a\u7c21\u5358\u306b\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\npom\u306b\u4f9d\u5b58\u95a2\u4fc2\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\n\n\npom.xml\n        <dependency>\n            <groupId>com.h2database</groupId>\n            <artifactId>h2</artifactId>\n            <scope>runtime</scope>\n        </dependency>\n\n\n\napplication.yml\u306b\u8a2d\u5b9a\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\u57fa\u672c\u7684\u306b\u3053\u308c\u3060\u3051\u3067DB\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\n\napplication.yml\n  h2:\n    console:\n      enabled: true\n      path: /h2-console\n\n\n\nh2-console\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u306b\u306f\u3001\u307e\u305aServletRegistrationBean\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n@Configuration\npublic class WebConfiguration {\n\n    ServletRegistrationBean h2servletRegistration() {\n        ServletRegistrationBean registrationBean = new ServletRegistrationBean(new WebServlet());\n        registrationBean.addUrlMappings(\"/h2-console\");\n        return registrationBean;\n    }\n}\n\n\nSpringSecurity\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306fHttpSecurity\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n~~~~ \u7565 ~~~~\n        protected void configure(HttpSecurity http) throws Exception {\n            http.authorizeRequests().antMatchers(\"/loginForm\").permitAll().antMatchers(\"/h2-console/**\").permitAll()\n                    .anyRequest().fullyAuthenticated();\n~~~~ \u7565 ~~~~\n                }\n}\n\n\n\u3053\u3046\u3059\u308b\u3053\u3068\u3067h2-console\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\nhttp://DOMAIN:PORT/app_name/h2-console\n\n\n\u3053\u306e\u4ed6h2-console\u306b\u8a8d\u8a3c\u3092\u4ed8\u3051\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\u3053\u308c\u3089\u306e\u8a2d\u5b9a\u306b\u3064\u3044\u3066\u306f29.4 Using H2\u2019s web console\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\n# \u306f\u3058\u3081\u306b\n\n* **SpringBoot 1.3.5\u3067\u66f8\u304d\u76f4\u3057\u307e\u3057\u305f\u3002**\n\n* SpringFramework\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u3067\u5229\u7528\u3055\u308c\u3001\u67af\u308c\u305f\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306a\u306e\u3067\u54c1\u8cea\u7684\u306b\u3082\u5b89\u5fc3\u611f\u304c\u3042\u308a\u307e\u3059\u3057\u3001[Spring\u3068Spring\u306e\u30b5\u30d6\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6a5f\u80fd](http://spring.io/docs)\u306f\u975e\u5e38\u306b\u591a\u5c90\u306b\u6e21\u308a\u307e\u3059\u3002\n* SpringBoot\u306f\u79c1\u306e\u3088\u3046\u306bSpring\u306b\u8a73\u3057\u304f\u306a\u304f\u3066\u3082\u7c21\u5358\u306bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n* SpringFramework\u306e\u60c5\u5831\u306fWeb\u4e0a\u306b\u6ca2\u5c71\u5b58\u5728\u3057\u307e\u3059\u304c\u3001Spring\u521d\u5fc3\u8005\u306b\u306f\u3069\u308c\u304c\u3069\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u5229\u7528\u3067\u304d\u308b\u3053\u3068\u306a\u306e\u304b\u304c\u308f\u304b\u308a\u306b\u304f\u304f\u6238\u60d1\u3046\u3053\u3068\u304c\u591a\u3044\u306e\u3067\u3059\u3002\u305d\u3053\u3067\u3001\u4eca\u56de\u52c9\u5f37\u3057\u305f\u3053\u3068\u3092\u691c\u7d22\u3057\u3084\u3059\u3044\u3088\u3046\u306b\uff11\u30da\u30fc\u30b8\u306b\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f\u3002\n* \u3067\u304d\u308b\u3060\u3051\u516c\u5f0f\u30b5\u30a4\u30c8\u3078\u306e\u53c2\u7167\u3092\u8cbc\u3063\u3066\u3042\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u63a2\u3059\u7cf8\u53e3\u304c\u308f\u304b\u308b\u3068\u826f\u3044\u3068\u601d\u3063\u305f\u306e\u3067\u63a2\u3057\u65b9\u3082\u3067\u304d\u308b\u3060\u3051\u8a18\u8f09\u3057\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n* \u81ea\u5206\u306e\u30e1\u30e2\u7684\u306a\u611f\u3058\u3067\u8a18\u8f09\u3057\u3066\u3044\u308b\u306e\u3067\u8a18\u8f09\u304c\u8352\u3044\u3068\u3053\u308d\u306f\u3054\u5bb9\u8d66\u304f\u3060\u3055\u3044\u3002\u9593\u9055\u3044\u306a\u3069\u3042\u308c\u3070\u3054\u6307\u6458\u3044\u305f\u3060\u3051\u308c\u3070\u52a9\u304b\u308a\u307e\u3059\u3002\n\n# \u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff082016/6/8\u8ffd\u8a18\uff09\n\n* \u30b5\u30f3\u30d7\u30eb\u304c\u3042\u3063\u305f\u65b9\u304c\u3088\u3055\u305d\u3046\u306a\u306e\u3067\u3001\u7c21\u5358\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u30ed\u30b0\u30a4\u30f3\u30fb\u30ed\u30b0\u30a2\u30a6\u30c8\u3001\u30e6\u30fc\u30b6\u767b\u9332\u3001iTunesSearchAPI\u3092\u4f7f\u3063\u305f\u7c21\u5358\u306a\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u304c\u53c2\u8003\u306b\u306a\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n* \u3053\u3061\u3089\u30821.3.5\u306b\u5408\u308f\u305b\u3066\u4fee\u6b63\u3057\u307e\u3057\u305f\u3002\n* https://github.com/uzresk/springboot-samples.git\n\n# SpringBoot\u3068\u306f\uff1f\n\n* \u8a2d\u5b9a\u697d\u3005Spring\uff1dSpringBoot\u3068\u3044\u3046\u611f\u3058\u3002\u7169\u308f\u3057\u3044\u8a2d\u5b9a\u3092\u884c\u308f\u305aSpring\u304c\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n* \u521d\u671f\u8a2d\u5b9a\u306fMaven or Gradle\u3067pom\u3092\u304b\u3051\u3070\u5b8c\u4e86\u3002\u4f9d\u5b58\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u304a\u3059\u3059\u3081\u306e\u7d44\u307f\u5408\u308f\u305b\u306f\u81ea\u52d5\u3067\u6c7a\u307e\u308a\u307e\u3059\u3002\n* Spring\u306e\u57fa\u672c\u7684\u306a\u8a2d\u5b9a\u306f\u81ea\u52d5\u3067\u884c\u308f\u308c\u307e\u3059\u3002web.xml\u3059\u3089\u7121\u304f\u306a\u308a\u307e\u3059\u3002\n* AP\u30b5\u30fc\u30d0\u306fEmbededTomcat\u5229\u7528\u3057\u3066\u304a\u308a\u3001\u30c7\u30d7\u30ed\u30a4\u306fwar\u3067\u306f\u306a\u304fjar\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3059\u3002\uff08\u8d77\u52d5\u306fjava -jar xx.jar\u3067\u884c\u3044\u307e\u3059\u3002\uff09\n* Tomcat\u304c\u5acc\u306a\u65b9\u306fJetty\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n* \u753b\u9762\u306e\u958b\u767a\u306b\u306fJSP\u306f\u63a8\u5968\u3055\u308c\u307e\u305b\u3093\u3002Thymeleaf,Velocity\u306a\u3069\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nhttp://docs.spring.io/spring-boot/docs/1.3.5.RELEASE/reference/htmlsingle/#boot-features-spring-mvc-template-engines\n<pre>\nJSPs should be avoided if possible, there are several known limitations when using them with embedded servlet containers.\n</pre>\n\n\n# \u524d\u63d0\uff08\u74b0\u5883\uff09\n\n* Java8\n* Maven3.0.4\n* SpringBoot1.3.5\n\n# \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\n* [Thymeleaf(\u65e5\u672c\u8a9e\u8a33)](http://www.thymeleaf.org/doc/tutorials/2.1/usingthymeleaf_ja.html)\n* [SpringBoot\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u30ac\u30a4\u30c9\uff08\u82f1\u8a9e\uff09](http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/)\n\n# \u306f\u3058\u3081\u306b\u8a2d\u5b9a\u3057\u305f\u3044\u3082\u306e\n\n## \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092scan\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5909\u66f4\u3059\u308b\u3002\n\n* scan\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u3064\u3044\u3066\u306f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fSpringBoot\u3092\u8d77\u52d5\u3059\u308b\u30af\u30e9\u30b9\u914d\u4e0b\u304c\u81ea\u52d5\u3067\u30b9\u30ad\u30e3\u30f3\u3055\u308c\u307e\u3059\u304c\u3001\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u30b9\u30ad\u30e3\u30f3\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n* \u79c1\u306e\u5834\u5408\u306fComponent\u306fWeb,Batch\u3067\u305d\u308c\u305e\u308c\u4f5c\u6210\u3057\u3001Entity\u3001Repository\u306fWeb,Batch\u3067\u5171\u7528\u3057\u305f\u304b\u3063\u305f\u306e\u3067\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u305f\u3002\n* Component\n<pre>\n@ComponentScan(basePackages = \"org.xxx\")\n</pre>\n\n* JpaRepository\n<pre>\n@EnableJpaRepositories(basePackages = \"org.xxx.repository\")\n</pre>\n\n* Entity\u30af\u30e9\u30b9\n<pre>\n@EntityScan(basePackages = \"org.xxx.entity\")\n</pre>\n\n* \u307e\u3068\u3081\u3066\u66f8\u304f\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n```App.java\n@EnableAutoConfiguration\n@ComponentScan(basePackages = \"org.xxx\")\n@EnableJpaRepositories(basePackages = \"org.xxx.repository\")\n@EntityScan(basePackages = \"org.xxx.entity\")\npublic class App {\n  \u30fb\u30fb\u30fb\n}\n```\n\n## \u30ed\u30b0\u306e\u8a2d\u5b9a\n\n* slf4j+logback\u3092\u4f7f\u3046\u306e\u304c\u4fbf\u5229\u3067\u3057\u3087\u3046\u3002log4j\u3068\u5927\u5dee\u306a\u3044\u306e\u3067\u3059\u3093\u306a\u308a\u5165\u308c\u308b\u306f\u305a\u3067\u3059\u3002sfl4j+logback\u3092\u6291\u3048\u308b\u306b\u306f[\u3053\u3061\u3089\u306eURL](http://www.slf4j.org/images/concrete-bindings.png \"slf4j+logback\")\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n* ~~pom\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002~~\u5fc5\u8981\u306b\u5fdc\u3058\u3066jcl\u3068\u304b\u3092\u3064\u3063\u3053\u307f\u307e\u3059\u3002\n<pre>\nslf4j+logback\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5229\u7528\u53ef\u80fd\u3067\u3059\u306e\u3067\u3001pom\u306e\u5909\u66f4\u306f\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093\u3002\n</pre>\n* \u3042\u3068\u306flogback.xml\u3092resource\u914d\u4e0b\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002logback.xml\u306f\u9069\u5f53\u306b\u3002\u4e00\u756a\u30b7\u30f3\u30d7\u30eb\u306a\u4f8b\u3092\u4e0a\u3052\u3066\u304a\u304d\u307e\u3059\u3002\n\n```logback.xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE logback>\n<configuration>\n\t<include resource=\"org/springframework/boot/logging/logback/base.xml\"/>\n\t<logger name=\"com.amazonaws\" level=\"INFO\"/>\n\t<logger name=\"org.hibernate\" level=\"ERROR\"/>\n\t<logger name=\"org.springframework\" level=\"INFO\"/>\n\t<logger name=\"org.thymeleaf\" level=\"INFO\"/>\n</configuration>\n```\n* import\u3057\u3066\u3044\u308bbase.xml\u3092\u898b\u308b\u3068\u308f\u304b\u308a\u307e\u3059\u304c\u3001java\u306e\u30b7\u30b9\u30c6\u30e0\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u4f7f\u3046\u3053\u3068\u3067\u30d5\u30a1\u30a4\u30eb\u306e\u51fa\u529b\u5834\u6240\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n<pre>\n-Dlogging.file=/var/log/my.log\n</pre>\n* \u305d\u306e\u307b\u304b\u3001log.path\u306a\u3069\u306e\u8a2d\u5b9a\u3082\u3042\u308a\u307e\u3059\u306e\u3067\u53c2\u8003\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n* \u53c2\u8003\uff1a[66.1 Configure Logback for logging](http://docs.spring.io/spring-boot/docs/current/reference/html/howto-logging.html#howto-configure-logback-for-loggin)\n\n## \u30ed\u30b0\u306e\u8a2d\u5b9a - logback.xml\u306e\u5dee\u3057\u66ff\u3048\n\n* logback\u306f\u901a\u5e38-Dlogback.configurationFile=/foo/bar/logback.xml\u3068\u3059\u308c\u3070\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5dee\u3057\u66ff\u3048\u304c\u3067\u304d\u307e\u3059\u304c\u3001SpringBoot\u3067\u306f\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u30d7\u30ed\u30d1\u30c6\u30a3\u306f\u7121\u52b9\u5316\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n* \u305d\u3093\u306a\u3068\u304d\u306f\u3053\u3093\u306a\u98a8\u306b\u3057\u307e\u3059\u3002\n<pre>\n-Dlogging.config=/foo/bar/logback.xml\n</pre>\n\n## \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092UTF-8\u306b\u3059\u308b\u3002\n\n* Fiter\u306e\u8a2d\u5b9a\u3092\u5f53\u521d\u8a18\u8f09\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001Spring Boot 1.2\u304b\u3089\u306f\u81ea\u52d5\u3067CharacterEncodingFilter\u304c\u767b\u9332\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u7279\u306b\u8a2d\u5b9a\u306f\u4e0d\u8981\u3067\u3059\u3002\n\n## \u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0 on AWS\n\n* [AWS\u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8003\u3048\u3066\u307f\u305f\u7d50\u679c\u3001DynamoDB\u304c\u3088\u3055\u305d\u3046\u306a\u306e\u3067\u8a66\u3057\u3066\u307f\u305f\u3002](http://qiita.com/uzresk/items/13228e86f20deda753a3)\n\n## \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u3092\u585e\u3050\n\n* \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u306b\u306f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u671b\u307e\u3057\u304f\u306a\u3044\u60c5\u5831\u304c\u8a18\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u8868\u793a\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n* \u8a2d\u5b9a\u3059\u308b\u4e00\u3064\u306e\u65b9\u6cd5\u306ftemplates\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u76f4\u4e0b\u306berror.html\u3092\u7f6e\u304f\u3053\u3068\u3067\u3059\u3002\u3053\u308c\u3067\u3069\u3093\u306a\u30a8\u30e9\u30fc\u3067\u3082error.html\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n* \u3088\u308a\u7d30\u304b\u3044\u5236\u5fa1\u306fErrorMvcAutoConfiguration\u3092\u30aa\u30fc\u30d0\u30e9\u30a4\u30c9\u3057\u3066\u5b9f\u73fe\u3057\u307e\u3059\u3002\n* \u53c2\u8003\uff1a[70.2 Customize the \u2018whitelabel\u2019 error page](http://docs.spring.io/spring-boot/docs/current/reference/html/howto-actuator.html#howto-customize-the-whitelabel-error-page)\n\n# \u958b\u767a\u6642\u306b\u8a2d\u5b9a\u3059\u308b\u3082\u306e\n\n## Thymeleaf\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092OFF\u306b\u3059\u308b\u3002\n\n* Thymeleaf\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u52b9\u3044\u3066\u3044\u308b\u3068\u5909\u66f4\u3057\u305f\u3042\u3068\u5373\u53cd\u6620\u3055\u308c\u307e\u305b\u3093\u3002\u958b\u767a\u6642\u306b\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u3092OFF\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n* \u53c2\u8003\uff1ahttp://docs.spring.io/spring-boot/docs/current/reference/html/howto-hotswapping.html#howto-reload-thymeleaf-content\n\n```application.yml\nspring.thymeleaf.cache: false\n```\n\n## \u30db\u30c3\u30c8\u30c7\u30d7\u30ed\u30a4\n\n* SpringBoot\u3067\u3082Seasar\u3067\u8a00\u3046\u3068\u3053\u308d\u306e\u30db\u30c3\u30c8\u30c7\u30d7\u30ed\u30a4\u3067\u304d\u307e\u3059\u3002\n* \u53c2\u8003\uff1a[72.6 Reload Java classes without restarting the container](http://docs.spring.io/spring-boot/docs/current/reference/html/howto-hotswapping.html#howto-reload-java-classes-without-restarting)\n\n1. spring-loaded\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n<pre>\nhttps://github.com/spring-projects/spring-loaded\n</pre>\n2. Eclipse\u3067\u958b\u767a\u3057\u3066\u3044\u308b\u6642\u306b\u306f\u3001SpringBoot\u8d77\u52d5\u6642\u306e\u5b9f\u884c\u69cb\u6210\u306eVM\u5f15\u6570\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n<pre>\n-javaagent:/springloaded-1.2.1.RELEASE.jar -noverify\n</pre>\n\n* spring loaded\u306f\u307e\u3060\u307e\u3060\u767a\u5c55\u9014\u4e0a\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u826f\u304f\u4e0a\u304c\u308b\u306e\u3067\u30de\u30e1\u306b\u30b5\u30a4\u30c8\u3092\u30c1\u30a7\u30c3\u30af\u3057\u3066\u6700\u65b0\u7248\u3092\u9069\u7528\u3057\u307e\u3057\u3087\u3046\u3002\n* maven\u3067\u5b9f\u884c\u3059\u308b\u5834\u5408\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306bpom\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n```pom.xml\n                <dependencies>\n                \t<dependency>\n                \t\t<groupId>org.springframework</groupId>\n                \t\t<artifactId>springloaded</artifactId>\n                \t\t<version>1.2.1.RELEASE</version>\n                \t</dependency>\n                </dependencies>\n```\n\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u5207\u308a\u66ff\u3048\u308b\n\n* \u79c1\u306e\u5834\u5408\u306f\u3001\u4f1a\u793e\u3067\u306f\u30ed\u30fc\u30ab\u30eb\u306ePostgreSQL\u3001\u5bb6\u3067\u306fSSLVPN\u7d4c\u7531\u3067AWS\u306ePostgreSQL(RDS\uff09\u3002\u3068\u3044\u3046\u611f\u3058\u3067\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n* \u901a\u5e38\u306e\u958b\u767a\u6642\u3067\u3082\u958b\u767a\u30fb\u30b9\u30c6\u30fc\u30b8\u30f3\u30b0\u30fb\u672c\u756a\u3068\u304b\u3067\u8a2d\u5b9a\u3092\u5207\u308a\u66ff\u3048\u305f\u3044\u3067\u3059\u3088\u306d\u3002\u305d\u3046\u3044\u3068\u304d\u306fProfile\u3092\u4f7f\u3044\u307e\u3059\u3002\n* application.yml\u3067\u306f\u3001---\u3067\u533a\u5207\u308a\u3002profiles:\u306b\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n``` application.yml\nspring:\n    profiles: dev-aws\n    thymeleaf:\n        cache: false\n    datasource:\n        url: jdbc:postgresql://foobar:5432/cmp\n        username: foo\n        password: bar\n    jpa:\n        database-platform: org.hibernate.dialect.PostgreSQLDialect\n---\nspring:\n    profiles: production\n    thymeleaf:\n        cache: true\n    datasource:\n        url: jdbc:postgresql://hogehoge:5432/cmp\n        username: foo\n        password: bar\n    jpa:\n        database-platform: org.hibernate.dialect.PostgreSQLDialect\n```\n\n* \u3042\u3068\u306fVM\u5f15\u6570(-Dspring.profiles.active)\u306b\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u66f8\u3044\u3066SpringBoot\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```command.sh\njava -Dspring.profiles.active=production -jar /home/ec2-user/XXX-0.0.1-SNAPSHOT.jar &\n```\n\n\n# \u753b\u9762\u7cfb\u306e\u5b9f\u88c5\n\n## \u8a2d\u5b9a\u306e\u65b9\u6cd5\n\n* POM\u3092\u7de8\u96c6\u3057\u3001spring mvc\u3068thymeleaf\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u3052\u307e\u3059\u3002\n\n``` pom.xml\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-web</artifactId>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-thymeleaf</artifactId>\n\t\t</dependency>\n```\n\n## \u5024\u3092\u8868\u793a\u3059\u308b\n\n``` controller.java\nmodel.addAttribute(\"hoge\", hoge);\n```\n\n``` thymeleaf.template\n<span th:text=\"${hoge}\"></span>\n```\n\n## \u30cd\u30b9\u30c8\u3055\u308c\u305f\u5024\u3092\u8868\u793a\u3059\u308b\n\n\u4e0b\u8a18\u306e\u4f8b\u3067\u306ffoo\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306bgetBar()\u3068\u3044\u3046Getter\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n``` thymeleaf.template\n<span th:text=\"${foo.bar}\"></span>\n```\n\n## \u65e5\u4ed8\u3092\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3059\u308b\u3002\n\n```thymeleaf.template\n${#dates.format([java.util.Date\u30aa\u30d6\u30b8\u30a7\u30af\u30c8], 'yyyy/MM/dd')}\n```\n\n## List\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8868\u793a\u3057\u305f\u3044\u3002\n\n``` controller.java\nList<Image> images = new ArrayList<Image>();\nmodel.addAttribute(\"images\", images);\n```\n\n``` thymeleaf.template\n<tr th:each=\"image : ${images}\">\n  <td th:text=\"${image.name}\">test1</td>\n  <td th:text=\"${image.description}\">test1</td>\n  <td th:text=\"${image.imageId}\">test1</td>\n  <td th:text=\"${image.state}\">test1</td>\n  <td th:text=\"${image.architecture}\">test1</td>\n  <td th:text=\"${image.imageType}\">test1</td>\n</tr>\n```\n\n## Map\u5185\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u8868\u793a\u3057\u305f\u3044\u3002\n\n* \u5e74\u306e\u30d7\u30eb\u30c0\u30a6\u30f3\u3092\u4f5c\u308b\u4f8b\u3092\u4f7f\u3063\u3066\u8aac\u660e\u3057\u307e\u3059\u3002Map<String,String>\u306e\u4e2d\u306b2014:2014\u3068\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002get\u3084keySet\u306a\u3069\u306f\u305d\u306e\u307e\u307e\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\n``` thymeleaf.template\n<select th:field=\"*{year}\" class=\"selectpicker\" data-width=\"75px\">\n  <option th:each=\"key : ${years.keySet()}\"\n          th:value=\"${key}\"\n          th:text=\"${years.get(key)}\">pulldown</option>\n</select>\n```\n\n## Session\u306b\u3042\u308b\u30ad\u30fc\u306e\u5b58\u5728\u6709\u7121\u3067\u30dc\u30bf\u30f3\u306e\u8868\u793a\u975e\u8868\u793a\u3092\u5236\u5fa1\u3059\u308b\u3002\n\n* thymeleaf\u3067\u3082JSP\u306e\u3088\u3046\u306b\u6697\u9ed9\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u3042\u308a\u307e\u3059\u3002session\u4e0a\u306bfoo\u3068\u3044\u3046\u30ad\u30fc\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306b\u306e\u307f\u300c\u53d6\u6d88\u300d\u30ea\u30f3\u30af\u3092\u8868\u793a\u3059\u308b\u306b\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n``` thymeleaf.template\n<a th:if=\"${session.containsKey('foo')}\" th:href=\"@{/hoge}\">\n    <button type=\"button\"  class=\"btn btn-danger\">\u53d6\u6d88</button>\n</a>\n```\n\n## \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9001\u308a\u305f\u3044\u30fb\u53d7\u3051\u53d6\u308a\u305f\u3044\n\n* GET\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9001\u308b\u3002\n\n``` thymeleaf.template\n<a th:href=\"@{/foo/bar(hoge=${hoge},fuga=true)}\">\n    <button type=\"button\"  class=\"btn btn-success\">\u30dc\u30bf\u30f3\u540d</button>\n</a> \n```\n\n* Controller\u3067GET\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u53d7\u3051\u53d6\u308b\u3002\n\n``` Controller.java\n@RequestMapping(value = \"/foo/bar\", method = RequestMethod.GET)\nString images(@RequestParam String hoge,\n              @RequestParam String fuga) {\n```\n\n## Form\u3092\u4f7f\u3063\u3066\u5024\u306e\u53d6\u5f97\u3092\u884c\u3046(POST)\n\n* AController\u3067\u306f\u5bfe\u5fdc\u3059\u308bForm\u3092\u5ba3\u8a00\u3057\u3066\u304a\u304d\u3001\u521d\u671f\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n* @ModelAttribute\u3067\u5ba3\u8a00\u3055\u308c\u305f\u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u6642\u306b\u81ea\u52d5\u3067\u547c\u3070\u308c\u307e\u3059\u3002\uff08\u30e1\u30bd\u30c3\u30c9\u540d\u306f\u4efb\u610f\u3067\u3001@ModelAttribute\u304c\u4ed8\u3044\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u304c\u91cd\u8981\u3067\u3059\u3002\uff09\uff09\n\n``` AController.java\n@ModelAttribute\nHogeForm setUpForm() {\n\treturn new HogeForm();\n}\n\n@RequestMapping(value = \"/hoge\", method = RequestMethod.GET)\nString hoge(HogeForm form) {\n  // \u521d\u671f\u5024\u3092\u8a2d\u5b9a\n  form.setName('name');\n}\n```\n\n``` thymeleaf.template\n<form class=\"form\" th:action=\"@{/hoge/confirm}\" th:object=\"${hogeForm}\" method=\"POST\">\n  <button type=\"submit\" id=\"submit\" class=\"btn btn-primary\">\u30dc\u30bf\u30f3\u540d</button>\n</form>\n```\n\nPOST\u3055\u308c\u305f\u5024\u306fBController\u306e\u5f15\u6570\u306b\u81ea\u52d5\u3067\u5165\u308a\u307e\u3059\u3002\n\n``` BController.java\n@RequestMapping(value = \"/hoge/confirm\", method = RequestMethod.POST)\nString hogeConfirm(HogeForm form) {\n  System.out.println(form.getName());\n}\n```\n\n## \u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u3002\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u306b\u5024\u3092\u5f15\u304d\u6e21\u3059\u3002\n\n* \u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3059\u308b\u306b\u306f\u3001Controller\u306e\u8fd4\u5374\u5024\u306eprefix\u306bredirect:\u3068\u4ed8\u3051\u308b\u3060\u3051\u3067\u3059\u3002\n<pre>\nreturn \"redirect:/foo/bar\"\n</pre>\n* \u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u306b\u5024\u3092\u6e21\u3059\u306b\u306fRedirectAttributes\u3092\u4f7f\u3044\u307e\u3059\u3002\u3053\u308c\u3092\u4f7f\u3046\u3068\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u3067model\u306b\u5024\u3092\u518d\u5ea6\u30bb\u30c3\u30c8\u3059\u308b\u5fc5\u8981\u3082\u306a\u3044\u306e\u3067\u4fbf\u5229\u3067\u3059\u306d\u3002\n\n```Controller.java\n\t@RequestMapping(value = \"/to\", method = RequestMethod.GET)\n\tString to(Model model, @RequestParam String foo,\n\t\t\t@RequestParam String bar,\n\t\t\tRedirectAttributes attributes) {\n\t\tattributes.addFlashAttribute(\"CompleteMessage\", completeMessage);\n                return \"redirect:/hoge\";\n        }\n\n```\n\n## \u5358\u9805\u76ee\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u88c5\u3057\u305f\u3044\u3002\n\n* \u5358\u9805\u76ee\u30c1\u30a7\u30c3\u30af\u306fForm\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308b\u3053\u3068\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n* \u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306fBean Validation\u306e\u5b9f\u88c5\u3067\u3042\u308bhibernate validator\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n* \u4ed8\u4e0e\u3067\u304d\u308b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u3092\u53c2\u7167\n* https://access.redhat.com/documentation/ja-JP/JBoss_Enterprise_Application_Platform/5/html-single/Hibernate_Validator_Reference_Guide/index.html#validator-defineconstraints-builtin\n\n``` Form.java\n@Data\n@NoArgsConstructor\npublic class ReserveForm implements Serializable {\n\t\n\tpublic static final long serialVersionUID = 1L;\n\n\t@NotEmpty\n\tprivate String hour;\n\n\t@NotEmpty\n\tprivate String minutes;\n}\n```\n\n* \u30e1\u30bd\u30c3\u30c9\u306e\u5f15\u6570\u306eForm\u306e\u524d\u306b@Validated\u3092\u4ed8\u3051\u308b\u3053\u3068\u3067\u30c1\u30a7\u30c3\u30af\u304c\u52d5\u304d\u307e\u3059\u3002\n* \u5165\u529b\u30c1\u30a7\u30c3\u30af\u306e\u7d50\u679c\u306fBindingResult\u306b\u5165\u308a\u307e\u3059\u3002\u3053\u306e\u4f8b\u3067\u306f\u5165\u529b\u30c1\u30a7\u30c3\u30af\u3067\u30a8\u30e9\u30fc\u306b\u6210\u3063\u305f\u3089\u5165\u529b\u753b\u9762\u306b\u623b\u3057\u3066\u3044\u307e\u3059\u3002\n* \u3010\u8981\u6ce8\u610f\u3011BindingResult\u306fForm\u306e\u3059\u3050\u5f8c\u308d\u306b\u8a18\u8f09\u3057\u306a\u3044\u3068\u52d5\u304d\u307e\u305b\u3093\u3002\n\n``` Controller.java\n@RequestMapping(value = \"reserveAMI/complete\", method = RequestMethod.POST)\nString reserveAMIComplete(@Validated AwsAMIReserveForm form,\nBindingResult result, Model model) {\n\n\t\t// \u5165\u529b\u30c1\u30a7\u30c3\u30af\n\t\tif (result.hasErrors()) {\n\t\t\tcreateDropDownList(model);\n\t\t\treturn \"input\";\n\t\t}\n}\n\n```\n\n## @NotNull/@NotEmpty/@NotBlank\u306e\u9055\u3044\n\n* \u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u5b58\u5728\u3059\u308b\u306e\u306b\u5024\u304c\u306a\u3044\u3002\u305d\u3093\u306a\u5834\u5408\u306f@NotEmpty\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n* \u8a73\u7d30\u306f[\u3053\u3061\u3089\u306e\u30da\u30fc\u30b8](http://n-agetsuma.hatenablog.com/entry/2012/10/14/010410)\u306b\u307e\u3068\u307e\u3063\u3066\u3044\u307e\u3059\u3002\n\n## \u76f8\u95a2\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u88c5\u3057\u305f\u3044\u3002\n\n* controller\u3067Injection\u3059\u308b\u306e\u3067\u3001\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8(@Component)\u3068\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002\n* validate\u30e1\u30bd\u30c3\u30c9\u3067\u306fForm\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30ad\u30e3\u30b9\u30c8\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002\n* rejectValue\u306e\u7b2c\u4e00\u5f15\u6570\u306f\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3002\u7b2c\u4e8c\u5f15\u6570\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u30b3\u30fc\u30c9\u3002\u7b2c\u4e09\u5f15\u6570\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u30b3\u30fc\u30c9\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u53d6\u5f97\u3067\u304d\u306a\u304b\u3063\u305f\u5834\u5408\u306b\u8868\u793a\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u306a\u308a\u307e\u3059\u3002\n* \u7b2c\u4e00\u5f15\u6570\u3068\u306a\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u306b\u5bfe\u5fdc\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u306fForm\u306b\u5b58\u5728\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n``` \u76f8\u95a2\u30c1\u30a7\u30c3\u30af\u30af\u30e9\u30b9.java\n@Component\npublic class AccountValidator implements Validator {\n\n\t@Override\n\tpublic boolean supports(Class<?> clazz) {\n\t\treturn AccountCreateForm.class.isAssignableFrom(clazz);\n\t}\n\n\t@Override\n\tpublic void validate(Object target, Errors errors) {\n\n\t\tAccountCreateForm form = (AccountCreateForm) target;\n\n                //\u5165\u529b\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u88c5\n                \u30fb\u30fb\u30fb\n\n                // \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u57cb\u3081\u8fbc\u307f\n\t\terrors.rejectValue(\"accountId\",\n\t\t\t\t\"AccountValidator.duplicateAccountId\", \"\u30e1\u30c3\u30bb\u30fc\u30b8\");\n\t}\n}\n\n```\n\n* Validator\u3092Controller\u306bInjection\u3057\u3066\u3001initBinder\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n* validator\u3092WebDataBinder\u306badd\u3057\u3066\u304a\u304f\u3053\u3068\u3067\u3001\u5358\u9805\u76ee\u30c1\u30a7\u30c3\u30af\u304c\u52d5\u304f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u76f8\u95a2\u30c1\u30a7\u30c3\u30af\u3082\u52d5\u304d\u307e\u3059\u3002\n* \u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u4ed5\u65b9\u306b\u3064\u3044\u3066\u306f\u5358\u9805\u76ee\u30c1\u30a7\u30c3\u30af\u3068\u540c\u69d8\u306a\u306e\u3067\u5272\u611b\u3057\u307e\u3059\u3002\n\n``` controller.java\n\n\t@Autowired\n\tAccountValidator accountValidator;\n\n\t@InitBinder\n\tpublic void initBinder(WebDataBinder binder) {\n\t\tbinder.addValidators(accountValidator);\n\t}\n\n```\n\n## \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u305f\u3044\n\n* \u30de\u30cb\u30e5\u30a2\u30eb\u304b\u3089\u5f15\u7528\u3057\u307e\u3059\u3002\n* thymeleaf\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3059\u308b\u306b\u306f#\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```\n<p th:utext=\"#{home.welcome}\">Welcome to our grocery store!</p>\n```\n\n* \u5f15\u6570\u4ed8\u304d\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\n\n```\n<p th:utext=\"#{home.welcome(${session.user.name})}\">\n  Welcome to our grocery store, Sebastian Pepper!\n</p>\n```\n\n## \u5165\u529b\u30c1\u30a7\u30c3\u30af\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u5909\u66f4\u3057\u305f\u3044\u3002\n\n* src/main/resuorce/ValidationMessages_ja.properties\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n* \u30e1\u30c3\u30bb\u30fc\u30b8ID\u3092\u30aa\u30fc\u30d0\u30e9\u30a4\u30c9\u3057\u307e\u3059\u3002\n\n## \u30b5\u30fc\u30d0\u5074\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4f5c\u308a\u305f\u3044\u3002\n\n* \u30b5\u30fc\u30d0\u5074\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4f5c\u3063\u3066\u30ed\u30b0\u3084\u753b\u9762\u306b\u8868\u793a\u3057\u305f\u3044\u30b1\u30fc\u30b9\u3067\u4f7f\u3044\u307e\u3059\u3002Controller\u3067\u306e\u5b9f\u88c5\u3092\u4f8b\u306b\u3068\u308a\u307e\u3059\u3002\n* MessageSource\u3092injection\u3057\u307e\u3059\u3002\n\n```\n\t@Autowired\n\tMessageSource messageSource;\n```\n\n* \u30e1\u30c3\u30bb\u30fc\u30b8\u30ad\u30fc\u3001\u5f15\u6570\u3002\u7b2c\u4e09\u5f15\u6570\u306b\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3001\u7b2c\u56db\u5f15\u6570\u306b\u306f\u30ed\u30b1\u30fc\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```\nmessageSource.getMessage(\"messageId\",\n\t\t\t new String[] { argument },\n\t\t\t \"defaultMessage\", Locale.JAPAN);\n```\n\n## \u30a8\u30e9\u30fc\u306e\u5b58\u5728\u6709\u7121\u3092\u5224\u5b9a\u3057\u305f\u3044\n\n* \u30a8\u30e9\u30fc\u304c\u5b58\u5728\u3057\u305f\u5834\u5408\u753b\u9762\u4e0a\u90e8\u306b\u5171\u901a\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3060\u3057\u305f\u3044\u3002\u3068\u3044\u3046\u3068\u304d\u306b\u306f\u4e0b\u8a18\u3092\u57cb\u3081\u8fbc\u307f\u307e\u3059\u3002\n* \u30b5\u30f3\u30d7\u30eb\u3067\u306f\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u3089\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30ad\u30fccommon.error\u306b\u7d10\u4ed8\u304f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\n``` thymeleaf.template\n        <div th:if=\"${#fields.hasErrors('all')}\" class=\"alert alert-danger\">\n           <p th:text=\"#{common.error}\">ErrorMessage</p>\n        </div>\n```\n\n## \u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u6a2a\u306b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u305f\u3044\n\n* \u30c6\u30ad\u30b9\u30c8\u306e\u6a2a\u306b\u4e0b\u8a18\u3092\u57cb\u3081\u8fbc\u307f\u307e\u3059\u3002\uff08\u5225\u306bspan\u3067\u3042\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\uff09\n* \u30b5\u30f3\u30d7\u30eb\u3067\u306freserveType\u3068\u3044\u3046\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a8\u30e9\u30fc\u304c\u3042\u3063\u305f\u3089\u305d\u308c\u306b\u7d10\u4ed8\u304f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3059\u308b\u5834\u5408\u306e\u8a18\u8f09\u65b9\u6cd5\u3067\u3059\u3002\n\n``` thymeleaf.template\n<span th:if=\"${#fields.hasErrors('reserveType')}\" class=\"text-danger\" th:errors=\"*{reserveType}\">Error</span>\n```\n\n## \u30a8\u30e9\u30fc\u6642\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u30b9\u30bf\u30a4\u30eb\u3092\u5909\u3048\u305f\u3044\n\n* \u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u306e\u67a0\u306f\u8d64\u304f\u3057\u305f\u3044\u3002\u306a\u3069\u306e\u5834\u5408\u306f\u4e0b\u8a18\u3092\u57cb\u3081\u8fbc\u307f\u307e\u3059\u3002\n* \u30b5\u30f3\u30d7\u30eb\u3067\u306ftwitter bootstrap\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002hoge\u3068\u3044\u3046\u9805\u76ee\u304c\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u5834\u5408\u306bform-group\u306e\u30af\u30e9\u30b9\u540d\u3092\u5909\u66f4\u3057\u3066\u3044\u307e\u3059\u3002\n\n``` thymeleaf.template\n      <div class=\"form-group\" th:classappend=\"${#fields.hasErrors('hoge')}? 'has-error has-feedback'\">\n        <label for=\"cron\">\u9805\u76ee\u540d</label>\n        <input type=\"text\" id=\"hoge\" name=\"hoge\" th:field=\"*{hoge}\" class=\"form-control\" style=\"width:75px;\"/>\n      </div>\n\n```\n\n# \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n\n## \u8a2d\u5b9a\n\n* \u8a8d\u8a3c\u30fb\u8a8d\u53ef\u51e6\u7406\u3092\u5b9f\u88c5\u3059\u308b\u306b\u306fSpringSecurity\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n* pom\u3092\u7de8\u96c6\u3059\u308b\u3060\u3051\u3067\u5229\u7528\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002springsecurity\u3068\u5408\u308f\u305b\u3066\u3001thymeleaf\u3067springsecurity\u306e\u6a5f\u80fd\u3092\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```pom.xml\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-security</artifactId>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.thymeleaf.extras</groupId>\n\t\t\t<artifactId>thymeleaf-extras-springsecurity3</artifactId>\n\t\t</dependency>\n```\n\n## \u8a8d\u8a3c\n\n* \u30ed\u30b0\u30a4\u30f3\u5468\u308a\u306e\u8a2d\u5b9a\u306fWebSecurityConfigurerAdapter\u3092\u7d99\u627f\u3057\u305fConfiguration\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u304c\u5168\u3066\u3067\u3059\u3002\n* \u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3053\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u3084\u3063\u3066\u307e\u3059\u3002\n\n1. \u8a8d\u8a3c\u304c\u5fc5\u8981\u306a\u30da\u30fc\u30b8\u3067\u8a8d\u8a3c\u3055\u308c\u3066\u306a\u304b\u3063\u305f\u3089/loginForm\u306b\u98db\u3070\u3059\u3002\n2. \u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u306f/loginForm\n3. \u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u308b\u3068accountId\u3068password\u304c/login\u306bPOST\u3055\u308c\u308b\u3002\n4. \u30ed\u30b0\u30a4\u30f3\u304c\u6210\u529f\u3057\u305f\u3089/top\u306b\u98db\u3070\u3059\u3002\n5. login\u30a8\u30e9\u30fc\u306e\u5834\u5408\u306f/loginForm?error\u306b\u98db\u3070\u3059\u3002\n6. \u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\u306f/logout\u3002\u30ed\u30b0\u30a2\u30a6\u30c8\u6210\u529f\u5f8c\u306f/loginForm\u306b\u98db\u3070\u3059\u3002\n\n* AuthenticationConfiguration\u306f\u8a8d\u8a3c\u51e6\u7406\u6642\u306epasswordEncoder\u3092\u4f5c\u3063\u3066\u6e21\u3057\u3066\u3042\u3052\u3066\u307e\u3059\u3002\n\n``` SecurityConfig.java\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n\t@Override\n\tprotected void configure(HttpSecurity http) throws Exception {\n\t\thttp.authorizeRequests().antMatchers(\"/loginForm\").permitAll()\n\t\t\t\t.anyRequest().authenticated();\n\n\t\thttp.formLogin().loginProcessingUrl(\"/login\").loginPage(\"/loginForm\")\n\t\t\t\t.failureUrl(\"/loginForm?error\").defaultSuccessUrl(\"/top\", true)\n\t\t\t\t.usernameParameter(\"accountid\").passwordParameter(\"password\")\n\t\t\t\t.and();\n\n\t\thttp.logout()\n\t\t\t\t.logoutRequestMatcher(new AntPathRequestMatcher(\"/logout**\"))\n\t\t\t\t.logoutSuccessUrl(\"/loginForm\");\n\n\t}\n\n\t@Configuration\n\tstatic class AuthenticationConfiguration extends\n\t\t\tGlobalAuthenticationConfigurerAdapter {\n\n\t\t@Autowired\n\t\tUserDetailsService userDetailsService;\n\n\t\t@Bean\n\t\tPasswordEncoder passwordEncoder() {\n\t\t\treturn new BCryptPasswordEncoder();\n\t\t}\n\n\t\t@Override\n\t\tpublic void init(AuthenticationManagerBuilder auth) throws Exception {\n\t\t\tauth.userDetailsService(userDetailsService).passwordEncoder(\n\t\t\t\t\tpasswordEncoder());\n\t\t}\n\t}\n}\n```\n\n## \u9759\u7684\u30b3\u30f3\u30c6\u30f3\u30c4\u306f\u8a8d\u53ef\u306e\u5bfe\u8c61\u304b\u3089\u9664\u5916\u3057\u305f\u3044\n\n```\n\t\t@Override\n\t\tpublic void configure(WebSecurity web) throws Exception {\n\t\t\tweb.ignoring().antMatchers(\"/css/**\", \"/js/**\",\"/fonts/**\", \"/img/**\");\n\t\t}\n\n```\n\n## \u8a8d\u8a3c\u60c5\u5831\u306b\u4efb\u610f\u306e\u60c5\u5831\u3092\u57cb\u3081\u305f\u3044\n\n* \u8a8d\u8a3c\u51e6\u7406\u5f8c\u306b\u30e6\u30fc\u30b6\u306b\u7d10\u4ed8\u304f\u4ed8\u5c5e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u3069\u3053\u304b\u3089\u3067\u3082\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3044\u3067\u3059\u3088\u306d\u3002\n\n1. User\u3092\u7d99\u627f\u3057\u305f\u5165\u308c\u7269\u3092\u4f5c\u6210\u3059\u308b\u3002 \n2. UserDetailService\u3092\u7d99\u627f\u3057\u305f\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n* \u3053\u3053\u3067\u306fRepository\u3092\u4f7f\u3063\u3066\u30a2\u30ab\u30a6\u30f3\u30c8ID\u306b\u7d10\u4ed8\u304f\u60c5\u5831\u3092\u53d6\u5f97\u5f8cUserDetails\u3068\u3057\u3066\u8fd4\u5374\u3057\u3066\u3044\u307e\u3059\n\n```LoginAccountDetails.java\npublic class LoginAccountDetails extends User {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\t@Getter\n\tprivate final Account account;\n\n\t@Getter\n\tprivate final AccountInfo accountInfo;\n\t\n\tpublic LoginAccountDetails(Account account, AccountInfo accountInfo) {\n\t\tsuper(account.getAccountId(), account.getPassword(), AuthorityUtils\n\t\t\t\t.createAuthorityList(\"USER\"));\n\t\tthis.account = account;\n\t\tthis.accountInfo = accountInfo != null ? accountInfo : new AccountInfo();\n\t}\n}\n\n```\n\n``` LoginAccountDetailService.java\n@Service\npublic class LoginAccountDetailService implements UserDetailsService {\n\n\t@Autowired\n\tAccountRepository accountRepository;\n\n\t@Autowired\n\tAccountInfoRepository accountInfoRepository;\n\n\t@Override\n\tpublic UserDetails loadUserByUsername(String accountId)\n\t\t\tthrows UsernameNotFoundException {\n\t\tAccount account = accountRepository.findOne(accountId);\n\t\tif (account == null) {\n\t\t\tthrow new UsernameNotFoundException(\"Account is not found\");\n\t\t}\n\t\tAccountInfo accountInfo = accountInfoRepository\n\t\t\t\t.findOne(new AccountInfoPk(accountId));\n\t\treturn new LoginAccountDetails(account, accountInfo);\n\t}\n}\n```\n\n## \u8a8d\u8a3c\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\n* Controller\u3067\u8a8d\u8a3c\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f@AuthenticationPrincipal\u3092\u4ed8\u4e0e\u3057\u305f\u5f15\u6570\u3092\u4e0e\u3048\u3066\u3042\u3052\u308b\u3060\u3051\u3067\u3059\u3002\n* org.springframework.security.web.bind.annotation.AuthenticationPrincipal\u306fdeprecated\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306e\u3067\u3001org.springframework.security.core.annotation.AuthenticationPrincipal\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\n\n```controller.java\n\t@RequestMapping(value = \"images\", method = RequestMethod.GET)\n\tString images(@RequestParam String instanceId,\n\t\t\t@AuthenticationPrincipal LoginAccountDetails loginAccountDetails,\n\t\t\tModel model) {\n\n```\n\n## \u30ed\u30fc\u30eb\u3092\u4f7f\u3063\u305f\u8868\u793a\u5236\u5fa1\n\n* sec:authorize=\"hasRole('\u30ed\u30fc\u30eb\u540d')\"\u3092\u4f7f\u3046\u3068\u30ed\u30fc\u30eb\u3092\u6301\u3063\u3066\u3044\u308b\u30e6\u30fc\u30b6\u306b\u3057\u304b\u305d\u306e\u30bb\u30af\u30b7\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n``` layout.html\n        <div id=\"navbar\" class=\"navbar navbar-inverse\" sec:authorize=\"hasRole('USER')\">\n            <div class=\"container\">\n             \u30fb\u30fb\u30fb\n            </div>\n        </div>\n```\n\n## Session Fixation\u5bfe\u7b56\n\n* \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u5f8c\u306b\u30bb\u30c3\u30b7\u30e7\u30f3ID\u306f\u81ea\u52d5\u3067\u5909\u66f4\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u6b63\u3057\u304f\u306f\u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u60c5\u5831\u3092\u5f15\u304d\u7d99\u3044\u3067\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u5909\u66f4\u3057\u3066\u3044\u307e\u3059\u3002\n* \u30bb\u30c3\u30b7\u30e7\u30f3\u306e\u60c5\u5831\u3092\u5f15\u304d\u7d99\u304c\u305a\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u5909\u66f4\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```\n// \u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u5909\u66f4\u3057\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u65b0\u3057\u304f\u4f5c\u308a\u76f4\u3059\nhttp.sessionManagement().sessionFixation().newSession();\n```\n\n## SpringBoot\u3067TOTP\u3092\u5229\u7528\u3057\u305fMFA\u3001Facebook/Twitter\u30ed\u30b0\u30a4\u30f3\u3092\u5b9f\u88c5\u3057\u305f\u3044\n\n* [Java(SpringBoot)\u3067TOTP(Time-based One-time Password),twitter/facebook\u30ed\u30b0\u30a4\u30f3\u3092\u5b9f\u73fe\u3059\u308b](http://qiita.com/uzresk/items/03308cf1c24ee1576b7d)\n* \u8a8d\u8a3c\u30d7\u30ed\u30d0\u30a4\u30c0\u306e\u8ffd\u52a0\u65b9\u6cd5\u306b\u3064\u3044\u3066\u3082\u8a18\u8f09\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30fb\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\n\n## \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u306e\u8a2d\u5b9a\n\n* application.yml\u306eHOST,PORT,DATABASE,USERNAME,PASSWORD\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002Database\u306e\u65b9\u8a00\u3092\u5438\u53ce\u3059\u308b\u305f\u3081\u306eDiarect\u3082\u5408\u308f\u305b\u3066\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u4e0b\u8a18\u306fPostgreSQL\u306e\u4f8b\u3067\u3059\u3002\n\n```\nspring:\n    datasource:\n        url: jdbc:postgresql://HOST:PORT/DATABASE\n        username: USERNAME\n        password: PASSWORD\n    jpa:\n        database-platform: org.hibernate.dialect.PostgreSQLDialect\n```\n\n## \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5883\u754c\n\n* \u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u308b\u3053\u3068\u3067\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5883\u754c\u3092\u8a2d\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n* \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u975e\u30c1\u30a7\u30c3\u30af\u4f8b\u5916(RuntimeException)\u304c\u767a\u751f\u3057\u306a\u3044\u3068\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3057\u307e\u305b\u3093\u3002\u4f8b\u3048\u3070Exception\u3092\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u5168\u3066\u304cthrow\u3055\u308c\u305f\u6642\u306b\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3059\u308b\u306b\u306f\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306b\u5f15\u6570\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u307e\u3059\u3002\n\n``` XXXService.java\n@Component\n@Transactional(rollbackOn = Exception.class)\npublic class AwsEbsService extends ReservationService {\n \u30fb\u30fb\u30fb\n}\n```\n\n# JPA\n\n## \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8URL\n\nhttp://docs.spring.io/spring-boot/docs/1.2.2.RELEASE/reference/htmlsingle/#boot-features-jpa-and-spring-data\n\n## JPA\u306e\u521d\u671f\u8a2d\u5b9a\n\n* POM\u306b\u8ffd\u8a18\u3059\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\n``` pom.xml\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-data-jpa</artifactId>\n</dependency>\n```\n\n### \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306eCRUD\n\n* PrimaryKey\u3067\u306eCRUD\u306fEntity\u3092\u4f5c\u308b\u2192Repository\u3092\u4f5c\u308b\u3002\u3067\u5b8c\u4e86\u3067\u3059\u3002\u5236\u7d04\u306a\u3069\u306f\u5168\u3066Entity\u306e\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u3067\u5b9f\u73fe\u3057\u307e\u3059\u3057\u3001Repository\u3082\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5207\u308b\u3060\u3051\u3067\u3059\u3002\n* JPA\u306e\u4ed5\u69d8\u306b\u5247\u3063\u3066\u3044\u308b\u306e\u3067\u3053\u3053\u3067\u4f5c\u3063\u305fEntity\u306f\u5b9f\u88c5\u304c\u5909\u308f\u3063\u3066\u3082\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002(JavaEE7\u306eJPA\u5b9f\u88c5\u3067\u3042\u308bEclipseLink\u3067\u3082\u52d5\u304d\u307e\u3059\uff09\n* Entity\u30af\u30e9\u30b9\u306e\u4f8b(lombok\u3092\u4f7f\u7528\uff09\u306f\u3053\u3061\u3089\u3002\u4ed8\u4e0e\u3059\u308b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306f[\u3053\u3061\u3089]\u304c\u53c2\u8003\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002(http://otndnld.oracle.co.jp/products/ias/toplink/jpa/resources/toplink-jpa-annotations.html)\n\n```Account.java\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\n@Entity\n@Table(name=\"account\")\npublic class Account implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\t/** \u30a2\u30ab\u30a6\u30f3\u30c8ID */\n\t@Id\n\t@Column(name = \"account_id\")\n\tprivate String accountId;\n\n\t/** \u30d1\u30b9\u30ef\u30fc\u30c9 */\n\t@Column(name = \"password\")\n\tprivate String password;\n\n\t/** \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9 */\n\t@Column(name = \"mail\")\n\tprivate String mail;\n\n}\n```\n\n* Repository\u306fJpaRepository\u3092\u7d99\u627f\u3057\u305f\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3067\u3059\u3002\u7d99\u627f\u3059\u308b\u3060\u3051\u3067CRUD\u306e\u64cd\u4f5c\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n* JPA\u3092\u3088\u304f\u77e5\u3089\u306a\u3044\u4eba\u306f\u81ea\u5206\u3067SQL\u66f8\u3044\u3066\u30b4\u30ea\u30b4\u30ea\u3084\u308b\u306e\u3068\u5c11\u3057\u9055\u3046\u306e\u3067Repository\u3067\u306e\u64cd\u4f5c\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3093\u3067\u52c9\u5f37\u3057\u3066\u304a\u304f\u3053\u3068\u3002\n* http://terasolunaorg.github.io/guideline/public_review/ArchitectureInDetail/DataAccessJpa.html#repository\n\n``` Repositry.java\n@Repository\npublic interface AccountRepository extends JpaRepository<Account, String> {\n\n}\n```\n\n\n# \u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\n\n## \u8d77\u52d5\u3059\u308b\u30dd\u30fc\u30c8\u3092\u5909\u66f4\u3059\u308b\u3002\n\n* embedded tomcat\u306e\u8d77\u52d5\u3059\u308b\u30dd\u30fc\u30c8\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n<pre>\nserver:\n    port: 18080\n</pre>\n\n\n## \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n* spring boot\u3092\u8d77\u52d5\u3055\u305b\u308b\u3068\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u307e\u305b\u3093\u3002\n* \u4e0b\u8a18\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u306b/app\u304c\u4ed8\u4e0e\u3055\u308c\u3001RequestMapping\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u306ePrefix\u306b\u81ea\u52d5\u3067\u4ed8\u4e0e\u3055\u308c\u52d5\u304d\u307e\u3059\u3002\n<pre>\nserver:\n    contextPath: /app\n</pre>\n\n## \u30bb\u30c3\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n* \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306f\u8a2d\u5b9a\u3055\u308c\u307e\u305b\u3093\u3002\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u3088\u308d\u3057\u304f\u306a\u3044\u306e\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u5358\u4f4d\u306f\u79d2\u3067\u3059\u3002\n<pre>\nserver:\n    session-timeout: 900\n</pre>\n\n## \u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u88c5\u3057\u305f\u3044\n\n* \u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304b\u3089\u306e\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u306f\u3044\u3064\u3082\u7c21\u5358\u306aServlet\u3092\u4f5c\u3063\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3084\u691c\u7d22\u30a8\u30f3\u30b8\u30f3\u304c\u751f\u304d\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u3044\u307e\u3057\u305f\u3002Spring-Actuator\u3092\u4f7f\u3048\u3070\u5b9f\u88c5\u304c\u4e0d\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n* \u53c2\u8003\uff1ahttp://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#production-ready-health\n\n``` pom.xml\n\t    <dependency>\n\t        <groupId>org.springframework.boot</groupId>\n\t        <artifactId>spring-boot-starter-actuator</artifactId>\n\t    </dependency>\n```\n\n```application.yml\nmanagement:\n    contextPath: /management\n    port: 8081\n    security.enabled: false\n```\n\n* \u3053\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\u3068port8081\u306e/management\u3068\u3044\u3046\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30d1\u30b9\u306bactuator\u304c\u7a3c\u50cd\u3057\u307e\u3059\u3002\u3053\u306e\u72b6\u614b\u3067\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u306eURL\u3092\u53e9\u3044\u3066\u307f\u307e\u3059\u3002\n\n``` \u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30afURL\nhttp://localhost:8081/management/health\n```\n\n``` \u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u7d50\u679c\n{\"status\":\"UP\",\"database\":\"PostgreSQL\",\"hello\":1}\n```\n\n* \u3068\u3044\u3046\u3053\u3068\u3067LB\u304b\u3089\u306fUP\u3068\u3044\u3046\u6587\u5b57\u304c\u5165\u3063\u3066\u3044\u308b\u304b\u5426\u304b\u3067\u5224\u65ad\u3059\u308c\u3070\u826f\u3055\u305d\u3046\u3067\u3059\u306d\u3002\n\n## \u8d77\u52d5\u30fb\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\n\n* \u3053\u308c\u307e\u3067\u306f\u81ea\u524d\u3067sh\u3092\u4f5c\u3063\u3066\u3044\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001init.d service\u3068\u3057\u3066\u52d5\u304f\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u7d20\u6674\u3089\u3057\u3044\uff01\n* /etc/init.d/myapp\u306b\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308a\u307e\u3059\u3002\n\n```\nsudo ln -s /var/myapp/myapp.jar /etc/init.d/myapp\n```\n\n* \u30e9\u30f3\u30ec\u30d9\u30eb\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```\nchkconfig myapp on\n```\n\n* \u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\nservice myapp start\n```\n\n* \u74b0\u5883\u5909\u6570\u3084VM\u306e\u5f15\u6570\u306b\u3064\u3044\u3066\u306fjar\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306bconf\u30d5\u30a1\u30a4\u30eb\u3092\u914d\u7f6e\u3059\u308b\u3060\u3051\u3067OK\u3067\u3059\u3002\n\n```myapp.conf\nAPP_NAME=cmp-web\nPID_FOLDER=/var/run/cmp-web\n\numask 002\n\nJAVA_OPTS=\"-Dspring.profiles.active=production -Dlog.path=/var/log/cmp-web\"\n```\n\n# \u756a\u5916\u7de8\n\n## [SpringBoot\u3067\u8d77\u52d5\u3059\u308btomcat\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u5909\u3048\u305f\u3044](http://qiita.com/uzresk/items/4f9a0390d729d7b32b87)\n\n* SpringBoot\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u5909\u3048\u305f\u304f\u306a\u3044\u3093\u3060\u3051\u3069tomcat\u306e\u30de\u30a4\u30ca\u30fc\u30d0\u30fc\u30b8\u30e7\u30f3\u3060\u3051\u306f\u8106\u5f31\u6027\u306b\u5bfe\u3059\u308b\u5bfe\u5fdc\u304c\u3055\u308c\u305f\u3082\u306e\u306b\u5909\u66f4\u3057\u305f\u3044\u3002\u3068\u3044\u3046\u5834\u5408\u306f[\u3053\u3061\u3089\u306e\u8a18\u4e8b\u3092\u3069\u3046\u305e](http://qiita.com/uzresk/items/4f9a0390d729d7b32b87)\n\n## war\u3067\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u3044\u3002\n\n* [74.1 Create a deployable war file](http://docs.spring.io/spring-boot/docs/1.3.5.RELEASE/reference/htmlsingle/#howto-create-a-deployable-war-file)\u306b\u8a18\u8f09\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u79c1\u306e\u74b0\u5883\u3067\u306f\u305d\u308c\u3060\u3051\u3067\u306f\u4e0a\u624b\u304f\u3044\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n* pom\u306epackaging\u3092war\u306b\u3057\u307e\u3059\u3002\n\n```pom.xml\n<packaging>jar</packaging>\n```\n\n* SpringBoot\u3092\u8d77\u52d5\u3059\u308b\u30af\u30e9\u30b9\u3092SpringBootServletInitializer\u3092\u7d99\u627f\u3055\u305b\u3001configure\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n```App.java\npublic class App extends SpringBootServletInitializer {\n\n\tprivate static Log logger = new Log(App.class);\n\n\tpublic static void main(String[] args) throws Exception {\n\t\tApplicationContext ctx = SpringApplication.run(App.class, args);\n\n\t\tString[] beanNames = ctx.getBeanDefinitionNames();\n\t\tArrays.sort(beanNames);\n\t\tfor (String beanName : beanNames) {\n\t\t\tlogger.info(beanName);\n\t\t}\n\t}\n\n\t@Override\n\tprotected SpringApplicationBuilder configure(\n\t\t\tSpringApplicationBuilder application) {\n\n\t\treturn application.sources(App.class);\n\t}\n\n}\n```\n\n* starter-tomcat\u306escope\u3092provided\u306b\u3057\u307e\u3059\u3002\n\n```\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-tomcat</artifactId>\n\t\t\t<scope>provided</scope>\n\t\t</dependency>\n```\n\n* \u3053\u308c\u3060\u3051\u3067\u4e0a\u624b\u304f\u3044\u304f\u306f\u305a\u3067\u3059\u304c\u79c1\u306e\u5834\u5408\u306f\uff12\u3064\u624b\u9806\u3092\u8db3\u3057\u307e\u3057\u305f\u3002\n\uff11\uff0e warplugin\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u3001web.xml\u304c\u7121\u304f\u3066\u3082\u30a8\u30e9\u30fc\u306b\u3057\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u304a\u304f\u3002\n\n```\n\t\t\t<plugin>\n\t\t\t\t<artifactId>maven-war-plugin</artifactId>\n\t\t\t\t<version>2.4</version>\n\t\t\t\t<configuration>\n\t\t\t\t\t<failOnMissingWebXml>false</failOnMissingWebXml>\n\t\t\t\t</configuration>\n\t\t\t</plugin>\n```\n\n\uff12\uff0espring-boot-starter-actuator\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3059\u308b\u3002\n\n## SpringBoot\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u3082\u306e\u3092\u63a2\u3057\u305f\u3044\u3002\n\n* \u8a2d\u5b9a\u306f\u30af\u30e9\u30b9\u30d1\u30b9\u76f4\u4e0b\u306eapplication.properties\u304bapplication.yml\u3067\u884c\u3044\u307e\u3059\u3002\n* \u3069\u3061\u3089\u3092\u4f7f\u3046\u304b\u306b\u3064\u3044\u3066\u306f\u304a\u597d\u307f\u3067\u3059\u3002(\u500b\u4eba\u7684\u306b\u306fYAML\u306e\u307b\u3046\u304c\u898b\u3084\u3059\u304f\u3066\u826f\u3044\u6c17\u304c\u3057\u3066\u307e\u3059\uff09\n* \u3053\u306e\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\u306b\u8a18\u8f09\u3055\u308c\u3066\u304a\u3089\u305a\u3001\u8a2d\u5b9a\u3067\u304d\u308b\u3082\u306e\u306b\u3064\u3044\u3066\u306f[SpringBoot Common application properties](http://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html)\u3092\u53c2\u7167\u3057\u3066\u304b\u3089\u30b0\u30b0\u308b\u3068\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n\n## h2 database\u3092\u7c21\u5358\u306b\u4f7f\u3044\u305f\u3044\n\n* \u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306a\u3069\u3092\u4f5c\u308b\u3068\u304d\u306bDB\u3092\u5916\u306b\u7528\u610f\u3059\u308b\u306e\u9762\u5012\u3067\u3059\u3088\u306d\u3002\n* \u305d\u3046\u3044\u3046\u3068\u304d\u306fh2\u3092\u4f7f\u3046\u3068\u4fbf\u5229\u3067\u3059\u3002SpringBoot1.3.0M4\u304b\u3089\u306f\u3088\u308a\u7c21\u5358\u306b\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n* pom\u306b\u4f9d\u5b58\u95a2\u4fc2\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\n\n```pom.xml\n\t\t<dependency>\n\t\t\t<groupId>com.h2database</groupId>\n\t\t\t<artifactId>h2</artifactId>\n\t\t\t<scope>runtime</scope>\n\t\t</dependency>\n```\n\n* application.yml\u306b\u8a2d\u5b9a\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\u57fa\u672c\u7684\u306b\u3053\u308c\u3060\u3051\u3067DB\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\n```application.yml\n  h2:\n    console:\n      enabled: true\n      path: /h2-console\n```\n\n* h2-console\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u306b\u306f\u3001\u307e\u305aServletRegistrationBean\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n```\n@Configuration\npublic class WebConfiguration {\n\n\tServletRegistrationBean h2servletRegistration() {\n\t\tServletRegistrationBean registrationBean = new ServletRegistrationBean(new WebServlet());\n\t\tregistrationBean.addUrlMappings(\"/h2-console\");\n\t\treturn registrationBean;\n\t}\n}\n```\n\n* SpringSecurity\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306fHttpSecurity\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n~~~~ \u7565 ~~~~\n\t\tprotected void configure(HttpSecurity http) throws Exception {\n\t\t\thttp.authorizeRequests().antMatchers(\"/loginForm\").permitAll().antMatchers(\"/h2-console/**\").permitAll()\n\t\t\t\t\t.anyRequest().fullyAuthenticated();\n~~~~ \u7565 ~~~~\n                }\n}\n```\n\n* \u3053\u3046\u3059\u308b\u3053\u3068\u3067h2-console\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\nhttp://DOMAIN:PORT/app_name/h2-console\n```\n\n* \u3053\u306e\u4ed6h2-console\u306b\u8a8d\u8a3c\u3092\u4ed8\u3051\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\u3053\u308c\u3089\u306e\u8a2d\u5b9a\u306b\u3064\u3044\u3066\u306f[29.4 Using H2\u2019s web console](http://docs.spring.io/spring-boot/docs/1.3.5.RELEASE/reference/htmlsingle/#boot-features-sql-h2-console)\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n", "tags": ["spring-boot", "Java", "Thymeleaf", "spring", "spring-security-core"]}