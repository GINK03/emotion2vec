{"context": "\n\ngolang\u3067ImageMagick\u3092\u89e6\u308a\u305f\u3044\n\u3053\u308c\u4f7f\u3046\u3002\nhttps://github.com/gographics/imagick\ndebian\u306a\u4eba\u306f libmagickwand-dev \u304c\u5fc5\u8981\u306a\u306e\u3067\u5165\u308c\u3066\u304a\u304f\u3002\nredhat\u306a\u4eba\u306f ImageMagick-devel \u3053\u3063\u3061\u3002\nMagickWand \u306e API \u30e9\u30c3\u30d1\u30fc\u306a\u306e\u3067\u57fa\u672c\u4ed6\u3068\u4e00\u7dd2\u3002\n\u306a\u306e\u3067\u3044\u3063\u305f\u3093\u4ed6\u306e\u8a00\u8a9e(php\u3068\u304b)\u3067\u8a66\u3057\u3066\u304b\u3089golang\u306b\u66f8\u304d\u4e0b\u3059\u3068\u3044\u3044\u304b\u3093\u3058\u3002\n\n\u30b5\u30f3\u30d7\u30eb\n\n\nbase.jpg \u306e\u4e0a\u306b\n\noverlay.png \u3092 100x100 \u306b\u30ea\u30b5\u30a4\u30ba\u3057\u3066\n\u3069\u771f\u3093\u4e2d\u306b\u4e57\u305b\u3066\n\npng \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\nstdout \u306b\u51fa\u529b\u3059\u308b\n\u3068\u540c\u6642\u306b out.png \u306b\u3082\u51fa\u529b\n\npackage main\n\nimport (\n    \"fmt\"\n    \"os\"\n\n    \"github.com/gographics/imagick/imagick\"\n)\n\nfunc main() {\n    imagick.Initialize()\n    defer imagick.Terminate()\n\n    // \u4e0b\u5730\n    mw1 := imagick.NewMagickWand()\n    defer mw1.Destroy()\n    err := mw1.ReadImage(\"base.jpg\")\n    if err != nil {\n        panic(err)\n    }\n    w1 := mw1.GetImageWidth()\n    h1 := mw1.GetImageHeight()\n\n    // \u4e0a\u30e2\u30ce\n    mw2 := imagick.NewMagickWand()\n    defer mw2.Destroy()\n    err = mw2.ReadImage(\"overlay.png\")\n    if err != nil {\n        panic(err)\n    }\n    // \u30ea\u30b5\u30a4\u30ba\u3057\u3066\n    err = mw2.ResizeImage(100, 100, imagick.FILTER_POINT, 0)\n    if err != nil {\n        panic(err)\n    }\n    w2 := mw2.GetImageWidth()\n    h2 := mw2.GetImageHeight()\n\n    // \u3069\u771f\u3093\u4e2d\u306b\u4e57\u305b\u308b\n    err = mw1.CompositeImage(mw2, mw2.GetImageCompose(), int((w1-w2)/2), int((h1-h2)/2))\n    if err != nil {\n        panic(err)\n    }\n\n    err = mw1.SetFormat(\"png\")\n    if err != nil {\n        panic(err)\n    }\n    // stdout\u306b\u5410\u304f\n    blob := mw1.GetImageBlob()\n    os.Stdout.Write(blob)\n\n    // \u30d5\u30a1\u30a4\u30eb\u306b\u3082\u5410\u304f\n    mw1.WriteImage(\"out.png\")\n\n    fmt.Fprintln(os.Stderr, \"FINISH!!\")\n}\n\n# golang\u3067ImageMagick\u3092\u89e6\u308a\u305f\u3044\n\n\u3053\u308c\u4f7f\u3046\u3002\nhttps://github.com/gographics/imagick\n\ndebian\u306a\u4eba\u306f `libmagickwand-dev` \u304c\u5fc5\u8981\u306a\u306e\u3067\u5165\u308c\u3066\u304a\u304f\u3002\nredhat\u306a\u4eba\u306f `ImageMagick-devel` \u3053\u3063\u3061\u3002\n\n[MagickWand](http://www.imagemagick.org/script/magick-wand.php) \u306e API \u30e9\u30c3\u30d1\u30fc\u306a\u306e\u3067\u57fa\u672c\u4ed6\u3068\u4e00\u7dd2\u3002\n\u306a\u306e\u3067\u3044\u3063\u305f\u3093\u4ed6\u306e\u8a00\u8a9e(php\u3068\u304b)\u3067\u8a66\u3057\u3066\u304b\u3089golang\u306b\u66f8\u304d\u4e0b\u3059\u3068\u3044\u3044\u304b\u3093\u3058\u3002\n\n## \u30b5\u30f3\u30d7\u30eb\n\n* `base.jpg` \u306e\u4e0a\u306b\n* `overlay.png` \u3092 `100x100` \u306b\u30ea\u30b5\u30a4\u30ba\u3057\u3066\n* \u3069\u771f\u3093\u4e2d\u306b\u4e57\u305b\u3066\n* `png` \u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\n* stdout \u306b\u51fa\u529b\u3059\u308b\n* \u3068\u540c\u6642\u306b `out.png` \u306b\u3082\u51fa\u529b\n\n```go\npackage main\n\nimport (\n\t\"fmt\"\n\t\"os\"\n\n\t\"github.com/gographics/imagick/imagick\"\n)\n\nfunc main() {\n\timagick.Initialize()\n\tdefer imagick.Terminate()\n\n\t// \u4e0b\u5730\n\tmw1 := imagick.NewMagickWand()\n\tdefer mw1.Destroy()\n\terr := mw1.ReadImage(\"base.jpg\")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tw1 := mw1.GetImageWidth()\n\th1 := mw1.GetImageHeight()\n\n\t// \u4e0a\u30e2\u30ce\n\tmw2 := imagick.NewMagickWand()\n\tdefer mw2.Destroy()\n\terr = mw2.ReadImage(\"overlay.png\")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\t// \u30ea\u30b5\u30a4\u30ba\u3057\u3066\n\terr = mw2.ResizeImage(100, 100, imagick.FILTER_POINT, 0)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tw2 := mw2.GetImageWidth()\n\th2 := mw2.GetImageHeight()\n\n\t// \u3069\u771f\u3093\u4e2d\u306b\u4e57\u305b\u308b\n\terr = mw1.CompositeImage(mw2, mw2.GetImageCompose(), int((w1-w2)/2), int((h1-h2)/2))\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\terr = mw1.SetFormat(\"png\")\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\t// stdout\u306b\u5410\u304f\n\tblob := mw1.GetImageBlob()\n\tos.Stdout.Write(blob)\n\n\t// \u30d5\u30a1\u30a4\u30eb\u306b\u3082\u5410\u304f\n\tmw1.WriteImage(\"out.png\")\n\n\tfmt.Fprintln(os.Stderr, \"FINISH!!\")\n}\n```\n", "tags": ["golang", "ImageMagick", "Go"]}