{"context": "\n\n\u6570\u5024\u89e3\u6cd5\n\\frac { 1 }{ { c }^{ 2 } } \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } \n1c2\u22022u(x,y,t)\u2202t2=\u22022u(x,y,t)\u2202x2+\u22022u(x,y,t)\u2202y2{\\frac { 1 }{ { c }^{ 2 } } \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } \n}\n\u4eca\u56de\u306f\u3001\u4e8c\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u3092\u5dee\u5206\u6cd5\u306b\u3066\u6570\u5024\u7a4d\u5206\u3092\u8a66\u307f\u307e\u3059\u3002\n\u4e8c\u6b21\u5143\u7a0b\u5ea6\u3067\u3057\u305f\u3089\u3001\u4e00\u822c\u7684\u306a\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u306a\u3089\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u306b\u305d\u306e\u6642\u9593\u767a\u5c55\u3092\u89b3\u5bdf\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u3068\u3066\u3082\u697d\u3057\u3044\u3067\u3059\u3002\n\u5c0e\u51fa\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\n\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u306e\u5c0e\u51fa\uff08\u5f26\u306e\u904b\u52d5\uff09 - Qiita\n\n\u5f0f\u5909\u5f62\n\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u306b\u6570\u5024\u8a08\u7b97\u3055\u305b\u308b\u305f\u3081\u306b\u306f\u3001\u3042\u308b\u7a0b\u5ea6\u6642\u9593(t)\u3068\u7a7a\u9593(x)\u3092\u7d30\u304b\u304f\u533a\u5207\u3063\u3066\u9032\u3081\u308b\u3088\u3046\u306a\u5f0f\u3092\u6e96\u5099\u3057\u3066\u3042\u3052\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u307e\u305a\u306f\u7a7a\u9593\u306e\u307b\u3046\u3067\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u8003\u3048\u65b9\u304c\u4f7f\u3048\u307e\u3059\u3002\u3053\u308c\u3092\u5dee\u5206\u6cd5\u3068\u3044\u3044\u307e\u3059\u3002\n\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }{ x } } \\cong \\frac { u(x,y,t)-u(x-\u22bfx,y,t) }{ \u22bfx } \\\\ \\frac { { \\partial  }u(x,y,t) }{ { \\partial  }{ x } } \\cong \\frac { u(x+\u22bfx,y,t)-u(x,y,t) }{ \u22bfx } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } \\cong \\frac { \\frac { u(x+\u22bfx,y,t)-u(x,y,t) }{ \u22bfx } -\\frac { u(x,y,t)-u(x-\u22bfx,y,t) }{ \u22bfx }  }{ \u22bfx } =\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } \n\u2202u(x,y,t)\u2202x\u2245u(x,y,t)\u2212u(x\u2212\u22bfx,y,t)\u22bfx\u2202u(x,y,t)\u2202x\u2245u(x+\u22bfx,y,t)\u2212u(x,y,t)\u22bfx\u22022u(x,y,t)\u2202x2\u2245u(x+\u22bfx,y,t)\u2212u(x,y,t)\u22bfx\u2212u(x,y,t)\u2212u(x\u2212\u22bfx,y,t)\u22bfx\u22bfx=u(x\u2212\u22bfx,y,t)\u22122u(x,y,t)+u(x+\u22bfx,y,t)\u22bfx2{\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }{ x } } \\cong \\frac { u(x,y,t)-u(x-\u22bfx,y,t) }{ \u22bfx } \\\\ \\frac { { \\partial  }u(x,y,t) }{ { \\partial  }{ x } } \\cong \\frac { u(x+\u22bfx,y,t)-u(x,y,t) }{ \u22bfx } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } \\cong \\frac { \\frac { u(x+\u22bfx,y,t)-u(x,y,t) }{ \u22bfx } -\\frac { u(x,y,t)-u(x-\u22bfx,y,t) }{ \u22bfx }  }{ \u22bfx } =\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } \n}\n\u4e00\u756a\u4e0b\u306e\u5f0f\u3082\u3001\u4e0a\u306e\u5f0f\u3068\u7d50\u5c40\u306e\u3068\u3053\u308d\u540c\u3058\u3053\u3068\u3092\u3084\u3063\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u3001\u5f0f\u304b\u3089\u4f4d\u7f6e\u306b\u5bfe\u3059\u308b\u4e8c\u968e\u5fae\u5206\u3092\u6d88\u53bb\u3057\u307e\u3059\u3002\n\\frac { 1 }{ { c }^{ 2 } } \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } +\\frac { u(x,y-\u22bfy,t)-2u(x,y,t)+u(x,y+\u22bfy,t) }{ { \u22bfy }^{ 2 } } )\n1c2\u22022u(x,y,t)\u2202t2=\u22022u(x,y,t)\u2202x2+\u22022u(x,y,t)\u2202y2\u22022u(x,y,t)\u2202t2=c2(u(x\u2212\u22bfx,y,t)\u22122u(x,y,t)+u(x+\u22bfx,y,t)\u22bfx2+u(x,y\u2212\u22bfy,t)\u22122u(x,y,t)+u(x,y+\u22bfy,t)\u22bfy2){\\frac { 1 }{ { c }^{ 2 } } \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } +\\frac { u(x,y-\u22bfy,t)-2u(x,y,t)+u(x,y+\u22bfy,t) }{ { \u22bfy }^{ 2 } } )\n}\n\u3053\u3053\u3067\u3001\u22bfx=\u22bfy\u3060\u3068\u3044\u3046\u3053\u3068\u306b\u3057\u3066\u3001\u53f3\u8fba\u3092\u6574\u7406\u3057\u307e\u3059\u3002\n\n\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } +\\frac { u(x,y-\u22bfx,t)-2u(x,y,t)+u(x,y+\u22bfx,t) }{ { \u22bfx }^{ 2 } } )\\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }\\frac { u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) }{ { \u22bfx }^{ 2 } } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \n\n\u22022u(x,y,t)\u2202t2=c2(u(x\u2212\u22bfx,y,t)\u22122u(x,y,t)+u(x+\u22bfx,y,t)\u22bfx2+u(x,y\u2212\u22bfx,t)\u22122u(x,y,t)+u(x,y+\u22bfx,t)\u22bfx2)\u22022u(x,y,t)\u2202t2=c2u(x\u2212\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y\u2212\u22bfx,t)+u(x,y+\u22bfx,t)\u22124u(x,y,t)\u22bfx2\u22022u(x,y,t)\u2202t2=c2\u22bfx2{u(x\u2212\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y\u2212\u22bfx,t)+u(x,y+\u22bfx,t)\u22124u(x,y,t)}{\n\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } +\\frac { u(x,y-\u22bfx,t)-2u(x,y,t)+u(x,y+\u22bfx,t) }{ { \u22bfx }^{ 2 } } )\\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }\\frac { u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) }{ { \u22bfx }^{ 2 } } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \n\n}\n\u3068\u3060\u3044\u3076\u5f0f\u304c\u7c21\u5358\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3053\u3053\u3067\u3055\u3089\u306b\u5de6\u8fba\u3092\u540c\u3058\u65b9\u6cd5\u3067\u6574\u7406\u3057\u307e\u3059\u3002\n\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ \\frac { u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft) }{ { \u22bft }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft)=\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ u(x,y,t+\u22bft)=2u(x,y,t)-u(x,y,t-\u22bft)+\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \n\u22022u(x,y,t)\u2202t2=c2\u22bfx2{u(x\u2212\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y\u2212\u22bfx,t)+u(x,y+\u22bfx,t)\u22124u(x,y,t)}u(x,y,t\u2212\u22bft)\u22122u(x,y,t)+u(x,y,t+\u22bft)\u22bft2=c2\u22bfx2{u(x\u2212\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y\u2212\u22bfx,t)+u(x,y+\u22bfx,t)\u22124u(x,y,t)}u(x,y,t\u2212\u22bft)\u22122u(x,y,t)+u(x,y,t+\u22bft)=\u22bft2c2\u22bfx2{u(x\u2212\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y\u2212\u22bfx,t)+u(x,y+\u22bfx,t)\u22124u(x,y,t)}u(x,y,t+\u22bft)=2u(x,y,t)\u2212u(x,y,t\u2212\u22bft)+\u22bft2c2\u22bfx2{u(x\u2212\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y\u2212\u22bfx,t)+u(x,y+\u22bfx,t)\u22124u(x,y,t)}{\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ \\frac { u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft) }{ { \u22bft }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft)=\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ u(x,y,t+\u22bft)=2u(x,y,t)-u(x,y,t-\u22bft)+\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \n}\n\u3053\u308c\u3067\u6e96\u5099\u306f\u6574\u3044\u307e\u3057\u305f\u3002\n\n\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\n\u3055\u3066\u3001\u4e0a\u8a18\u306e\u5f0f\u5c55\u958b\u306b\u3088\u3063\u3066\u3001u(x,y,t)\u306e\u4e8c\u6b21\u5143\u914d\u5217\u3068\u3001u(x,y,t-\u22bft)\u306e\u4e8c\u6b21\u5143\u914d\u5217\u304c\u3042\u308c\u3070\u3001\n\u9069\u5f53\u306a\u521d\u671f\u5024\u3092\u5b9a\u3081\u3001\u3069\u3093\u3069\u3093\u6642\u9593\u767a\u5c55\u3055\u305b\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u7aef\u3063\u3053\u306e\u51e6\u7406\u304c\u6c17\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u7c21\u5358\u306b\u3001\u7aef\u3063\u3053\u4e00\u30de\u30b9\u306f\u51e6\u7406\u3057\u306a\u3044\u3067\u5e38\u306b0\u3067\u3042\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\u3053\u306e\u7aef\u3063\u3053\u306e\u51e6\u7406\u3092\u8003\u3048\u308b\u3068\u304d\u306e\u898f\u5247\u3092\u5883\u754c\u6761\u4ef6\u3068\u547c\u3073\u3001\u5e38\u306b0\u306e\u521d\u671f\u5024\u306b\u56fa\u5b9a\u3057\u3066\u3057\u307e\u3046\u3088\u3046\u306a\u3082\u306e\u3092\u30c7\u30a3\u30ea\u30af\u30ec\u5883\u754c\u6761\u4ef6\u3068\u547c\u3076\u305d\u3046\u3067\u3059\u3002\u4e00\u65b9\u521d\u671f\u72b6\u614b\u3092\u6c7a\u3081\u308b\u898f\u5247\u3092\u521d\u671f\u6761\u4ef6\u3068\u547c\u3073\u307e\u3059\u3002\uff08\u3053\u306e\u8fba\u3042\u307e\u308a\u81ea\u4fe1\u304c\u3042\u308a\u307e\u305b\u3093\uff09\n\u6570\u5b66\u7684\u306b\u306f\u7a4d\u5206\u5b9a\u6570\u306e\u78ba\u5b9a\u304c\u76ee\u7684\u3067\u3059\u3002\n\u3053\u308c\u3092\u8e0f\u307e\u3048\u3066C++\u30b3\u30fc\u30c9\u306b\u7d20\u76f4\u306b\u843d\u3068\u3057\u8fbc\u3080\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u6570\u5f0f\u3092\u3057\u3063\u304b\u308a\u6574\u7406\u3059\u308b\u3053\u3068\u3067\u3001\u52b9\u7387\u306e\u826f\u3044\u30b3\u30fc\u30c9\u306b\u843d\u3068\u3057\u8fbc\u307f\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\n\n#include <glm/glm.hpp>\n#include <glm/ext.hpp>\n\nclass WaveSolver {\npublic:\n    WaveSolver() {\n        _u_cur.resize(kWaveGrid * kWaveGrid);\n        _u_new.resize(kWaveGrid * kWaveGrid);\n        _u_pre.resize(kWaveGrid * kWaveGrid);\n        this->reset();\n    }\n    void reset() {\n        auto gauss = [](float x, float sigma) {\n            return 1.0f / glm::sqrt(glm::two_pi<float>()) * sigma * glm::exp(-x * x / (2.0f * sigma * sigma));\n        };\n\n        int cx1 = kWaveGrid / 3;\n        int cy1 = kWaveGrid / 3;\n        int cx2 = kWaveGrid * 2 / 3;\n        int cy2 = kWaveGrid * 2 / 3;\n        for (int x = 1; x < kWaveGrid - 1; ++x) {\n            for (int y = 1; y < kWaveGrid - 1; ++y) {\n                int index = this->valueIndex(x, y);\n                float value = 0.0f;\n\n                {\n                    float norm = glm::distance(glm::vec2(x, y), glm::vec2(cx1, cy1));\n                    value += gauss(norm, 3.0f) * 20.0f;\n                }\n                {\n                    float norm = glm::distance(glm::vec2(x, y), glm::vec2(cx2, cy2));\n                    value += gauss(norm, 3.0f) * 20.0f;\n                }\n\n                _u_cur[index] = value;\n            }\n        }\n\n        _u_pre = _u_new = _u_cur;\n    }\n    void step() {\n        float deltaX = float(kWaveWidth) / float(kWaveGrid);\n        float deltaT = 1.0f / 60.0f;\n        float c = 2.0f;\n        float mul = deltaT * deltaT * c * c / (deltaX * deltaX);\n        for (int x = 1; x < kWaveGrid - 1; ++x) {\n            for (int y = 1; y < kWaveGrid - 1; ++y) {\n                int index = this->valueIndex(x, y);\n\n                float uL = _u_cur[this->valueIndex(x - 1, y)];\n                float uR = _u_cur[this->valueIndex(x + 1, y)];\n                float uT = _u_cur[this->valueIndex(x, y - 1)];\n                float uB = _u_cur[this->valueIndex(x, y + 1)];\n\n                float u_pre = _u_pre[index];\n                float u = _u_cur[index];\n                _u_new[index] = u + u - u_pre + mul * (-4.0f * u + uL + uR + uT + uB);\n            }\n        }\n\n        std::swap(_u_pre, _u_cur);\n        std::swap(_u_cur, _u_new);\n    }\n\n    enum {\n        kWaveGrid = 300,\n        kWaveWidth = 100\n    };\n\n    int valueIndex(int x, int y) const {\n        return y * kWaveGrid + x;\n    }\n    float value(int x, int y) const {\n        return _u_cur[valueIndex(x, y)];\n    }\n    int widthN() const {\n        return kWaveGrid;\n    }\n    int heightN() const {\n        return kWaveGrid;\n    }\n\n    float width() const {\n        return kWaveWidth;\n    }\n    float height() const {\n        return kWaveWidth;\n    }\nprivate:\n    std::vector<float> _u_pre;\n    std::vector<float> _u_cur;\n    std::vector<float> _u_new;\n};\n\n\n\u672c\u8cea\u7684\u306a\u30b3\u30fc\u30c9\u306fstep\u95a2\u6570\u306e\u4e2d\u306e\u4e00\u90e8\u306e\u884c\u3060\u3051\u3067\u3001\u3042\u3068\u306f\u3055\u3057\u3066\u91cd\u8981\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u3053\u308c\u3092\u30d3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba\u3059\u308b\u3068\u3001\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u304d\u308c\u3044\u3067\u3059\u306d\uff01\n\n\n\u6e1b\u8870\n\u3088\u304f\u3042\u308a\u3075\u308c\u305f\u73fe\u8c61\u3068\u3057\u3066\u3001\u6e1b\u8870\u304c\u3042\u308a\u307e\u3059\u3002\u6e1b\u8870\u3092\u8003\u616e\u306b\u3044\u308c\u308b\u3068\u3001\u5916\u529b\u306a\u3069\u304c\u52a0\u308f\u3089\u306a\u3044\u9650\u308a\u3001\u3044\u305a\u308c\u6ce2\u306e\u9ad8\u3055\u304c\u6e1b\u3063\u3066\u3044\u304d\u6700\u5f8c\u306b\u306f0\u306b\u53ce\u675f\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f\u7269\u7406\u7684\u306a\u6839\u62e0\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u901f\u5ea6\u306b\u6bd4\u4f8b\u3059\u308b\u6e1b\u8870\u9805\uff08\u5b9a\u6570k\u3068\u3057\u3066\uff09\u3092\u5165\u308c\u3066\u307f\u307e\u3059\u3002\u7c98\u6027\u62b5\u6297\u306e\u3088\u3046\u306a\u8003\u3048\u65b9\u3067\u3059\u3002\n\u3053\u308c\u3092\u307b\u3068\u3093\u3069\u4e0a\u8a18\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u304c\u3001\u6700\u5f8c\u306e\u9805\u3060\u3051\u5c11\u3057\u5909\u308f\u3063\u3066\u304d\u307e\u3059\u3002\n\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } )-k\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }t } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }t } \\\\ \\frac { u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft) }{ { \u22bft }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\\frac { u(x,y,t)-u(x,y,t-\u22bft) }{ \u22bft } \\\\ u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft)=\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\u22bft\\{ u(x,y,t)-u(x,y,t-\u22bft)\\} \\\\ u(x,y,t+\u22bft)=2u(x,y,t)-u(x,y,t-\u22bft)+\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\u22bft\\{ u(x,y,t)-u(x,y,t-\u22bft)\\} \n\n{\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } )-k\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }t } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }t } \\\\ \\frac { u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft) }{ { \u22bft }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\\frac { u(x,y,t)-u(x,y,t-\u22bft) }{ \u22bft } \\\\ u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft)=\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\u22bft\\{ u(x,y,t)-u(x,y,t-\u22bft)\\} \\\\ u(x,y,t+\u22bft)=2u(x,y,t)-u(x,y,t-\u22bft)+\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\u22bft\\{ u(x,y,t)-u(x,y,t-\u22bft)\\} \n\n}{\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } )-k\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }t } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }t } \\\\ \\frac { u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft) }{ { \u22bft }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\\frac { u(x,y,t)-u(x,y,t-\u22bft) }{ \u22bft } \\\\ u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft)=\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\u22bft\\{ u(x,y,t)-u(x,y,t-\u22bft)\\} \\\\ u(x,y,t+\u22bft)=2u(x,y,t)-u(x,y,t-\u22bft)+\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\u22bft\\{ u(x,y,t)-u(x,y,t-\u22bft)\\} \n\n}\n\u30d7\u30ed\u30b0\u30e9\u30e0\u5074\u3082\u8a72\u5f53\u7b87\u6240\u3060\u3051\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u307e\u3059\u3002\n\nint index = this->valueIndex(x, y);\n\nfloat uL = _u_cur[this->valueIndex(x - 1, y)];\nfloat uR = _u_cur[this->valueIndex(x + 1, y)];\nfloat uT = _u_cur[this->valueIndex(x, y - 1)];\nfloat uB = _u_cur[this->valueIndex(x, y + 1)];\n\nfloat u_pre = _u_pre[index];\nfloat u = _u_cur[index];\n\nfloat k = 0.1f;\nfloat damp = - k * deltaT * (u - u_pre);\n_u_new[index] = u + u - u_pre + mul * (-4.0f * u + uL + uR + uT + uB) + damp;\n\n\n\u3053\u3061\u3089\u3082\u30d3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba\u3059\u308b\u3068\u78ba\u304b\u306b\u3044\u3044\u304b\u3093\u3058\u306b\u6e1b\u8870\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u662f\u975e\u307f\u306a\u3055\u3093\u3082\u8272\u3005\u6570\u5f0f\u3084\u3089\u30b3\u30fc\u30c9\u3084\u3089\u3092\u3044\u3058\u3063\u3066\u697d\u3057\u3093\u3067\u307f\u3066\u306f\u3044\u304b\u304c\u3067\u3057\u3087\u3046\u304b\n## \u6570\u5024\u89e3\u6cd5\n\n```math\n\\frac { 1 }{ { c }^{ 2 } } \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } \n```\n\n\u4eca\u56de\u306f\u3001\u4e8c\u6b21\u5143\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u3092\u5dee\u5206\u6cd5\u306b\u3066\u6570\u5024\u7a4d\u5206\u3092\u8a66\u307f\u307e\u3059\u3002\n\u4e8c\u6b21\u5143\u7a0b\u5ea6\u3067\u3057\u305f\u3089\u3001\u4e00\u822c\u7684\u306a\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u306a\u3089\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u306b\u305d\u306e\u6642\u9593\u767a\u5c55\u3092\u89b3\u5bdf\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u3001\u3068\u3066\u3082\u697d\u3057\u3044\u3067\u3059\u3002\n\n\u5c0e\u51fa\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\n[\u6ce2\u52d5\u65b9\u7a0b\u5f0f\u306e\u5c0e\u51fa\uff08\u5f26\u306e\u904b\u52d5\uff09 - Qiita](http://qiita.com/Ushio@github/items/51158ce9cd8155f119d0)\n\n## \u5f0f\u5909\u5f62\n\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u306b\u6570\u5024\u8a08\u7b97\u3055\u305b\u308b\u305f\u3081\u306b\u306f\u3001\u3042\u308b\u7a0b\u5ea6\u6642\u9593(t)\u3068\u7a7a\u9593(x)\u3092\u7d30\u304b\u304f\u533a\u5207\u3063\u3066\u9032\u3081\u308b\u3088\u3046\u306a\u5f0f\u3092\u6e96\u5099\u3057\u3066\u3042\u3052\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u307e\u305a\u306f\u7a7a\u9593\u306e\u307b\u3046\u3067\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u8003\u3048\u65b9\u304c\u4f7f\u3048\u307e\u3059\u3002\u3053\u308c\u3092\u5dee\u5206\u6cd5\u3068\u3044\u3044\u307e\u3059\u3002\n\n```math\n\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }{ x } } \\cong \\frac { u(x,y,t)-u(x-\u22bfx,y,t) }{ \u22bfx } \\\\ \\frac { { \\partial  }u(x,y,t) }{ { \\partial  }{ x } } \\cong \\frac { u(x+\u22bfx,y,t)-u(x,y,t) }{ \u22bfx } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } \\cong \\frac { \\frac { u(x+\u22bfx,y,t)-u(x,y,t) }{ \u22bfx } -\\frac { u(x,y,t)-u(x-\u22bfx,y,t) }{ \u22bfx }  }{ \u22bfx } =\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } \n```\n\n\u4e00\u756a\u4e0b\u306e\u5f0f\u3082\u3001\u4e0a\u306e\u5f0f\u3068\u7d50\u5c40\u306e\u3068\u3053\u308d\u540c\u3058\u3053\u3068\u3092\u3084\u3063\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u3001\u5f0f\u304b\u3089\u4f4d\u7f6e\u306b\u5bfe\u3059\u308b\u4e8c\u968e\u5fae\u5206\u3092\u6d88\u53bb\u3057\u307e\u3059\u3002\n\n```math\n\\frac { 1 }{ { c }^{ 2 } } \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } +\\frac { u(x,y-\u22bfy,t)-2u(x,y,t)+u(x,y+\u22bfy,t) }{ { \u22bfy }^{ 2 } } )\n```\n\n\u3053\u3053\u3067\u3001\u22bfx=\u22bfy\u3060\u3068\u3044\u3046\u3053\u3068\u306b\u3057\u3066\u3001\u53f3\u8fba\u3092\u6574\u7406\u3057\u307e\u3059\u3002\n\n```math\n\n\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { u(x-\u22bfx,y,t)-2u(x,y,t)+u(x+\u22bfx,y,t) }{ { \u22bfx }^{ 2 } } +\\frac { u(x,y-\u22bfx,t)-2u(x,y,t)+u(x,y+\u22bfx,t) }{ { \u22bfx }^{ 2 } } )\\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }\\frac { u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) }{ { \u22bfx }^{ 2 } } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \n\n```\n\n\u3068\u3060\u3044\u3076\u5f0f\u304c\u7c21\u5358\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3053\u3053\u3067\u3055\u3089\u306b\u5de6\u8fba\u3092\u540c\u3058\u65b9\u6cd5\u3067\u6574\u7406\u3057\u307e\u3059\u3002\n\n```math\n\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ \\frac { u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft) }{ { \u22bft }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft)=\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \\\\ u(x,y,t+\u22bft)=2u(x,y,t)-u(x,y,t-\u22bft)+\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} \n```\n\n\u3053\u308c\u3067\u6e96\u5099\u306f\u6574\u3044\u307e\u3057\u305f\u3002\n\n## \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\n\u3055\u3066\u3001\u4e0a\u8a18\u306e\u5f0f\u5c55\u958b\u306b\u3088\u3063\u3066\u3001u(x,y,t)\u306e\u4e8c\u6b21\u5143\u914d\u5217\u3068\u3001u(x,y,t-\u22bft)\u306e\u4e8c\u6b21\u5143\u914d\u5217\u304c\u3042\u308c\u3070\u3001\n\u9069\u5f53\u306a\u521d\u671f\u5024\u3092\u5b9a\u3081\u3001\u3069\u3093\u3069\u3093\u6642\u9593\u767a\u5c55\u3055\u305b\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u7aef\u3063\u3053\u306e\u51e6\u7406\u304c\u6c17\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u7c21\u5358\u306b\u3001\u7aef\u3063\u3053\u4e00\u30de\u30b9\u306f\u51e6\u7406\u3057\u306a\u3044\u3067\u5e38\u306b0\u3067\u3042\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\u3053\u306e\u7aef\u3063\u3053\u306e\u51e6\u7406\u3092\u8003\u3048\u308b\u3068\u304d\u306e\u898f\u5247\u3092**\u5883\u754c\u6761\u4ef6**\u3068\u547c\u3073\u3001\u5e38\u306b0\u306e\u521d\u671f\u5024\u306b\u56fa\u5b9a\u3057\u3066\u3057\u307e\u3046\u3088\u3046\u306a\u3082\u306e\u3092\u30c7\u30a3\u30ea\u30af\u30ec\u5883\u754c\u6761\u4ef6\u3068\u547c\u3076\u305d\u3046\u3067\u3059\u3002\u4e00\u65b9\u521d\u671f\u72b6\u614b\u3092\u6c7a\u3081\u308b\u898f\u5247\u3092**\u521d\u671f\u6761\u4ef6**\u3068\u547c\u3073\u307e\u3059\u3002\uff08\u3053\u306e\u8fba\u3042\u307e\u308a\u81ea\u4fe1\u304c\u3042\u308a\u307e\u305b\u3093\uff09\n\u6570\u5b66\u7684\u306b\u306f\u7a4d\u5206\u5b9a\u6570\u306e\u78ba\u5b9a\u304c\u76ee\u7684\u3067\u3059\u3002\n\n\u3053\u308c\u3092\u8e0f\u307e\u3048\u3066C++\u30b3\u30fc\u30c9\u306b\u7d20\u76f4\u306b\u843d\u3068\u3057\u8fbc\u3080\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u6570\u5f0f\u3092\u3057\u3063\u304b\u308a\u6574\u7406\u3059\u308b\u3053\u3068\u3067\u3001\u52b9\u7387\u306e\u826f\u3044\u30b3\u30fc\u30c9\u306b\u843d\u3068\u3057\u8fbc\u307f\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\n```cpp\n\n\n#include <glm/glm.hpp>\n#include <glm/ext.hpp>\n\nclass WaveSolver {\npublic:\n\tWaveSolver() {\n\t\t_u_cur.resize(kWaveGrid * kWaveGrid);\n\t\t_u_new.resize(kWaveGrid * kWaveGrid);\n\t\t_u_pre.resize(kWaveGrid * kWaveGrid);\n\t\tthis->reset();\n\t}\n\tvoid reset() {\n\t\tauto gauss = [](float x, float sigma) {\n\t\t\treturn 1.0f / glm::sqrt(glm::two_pi<float>()) * sigma * glm::exp(-x * x / (2.0f * sigma * sigma));\n\t\t};\n\n\t\tint cx1 = kWaveGrid / 3;\n\t\tint cy1 = kWaveGrid / 3;\n\t\tint cx2 = kWaveGrid * 2 / 3;\n\t\tint cy2 = kWaveGrid * 2 / 3;\n\t\tfor (int x = 1; x < kWaveGrid - 1; ++x) {\n\t\t\tfor (int y = 1; y < kWaveGrid - 1; ++y) {\n\t\t\t\tint index = this->valueIndex(x, y);\n\t\t\t\tfloat value = 0.0f;\n\n\t\t\t\t{\n\t\t\t\t\tfloat norm = glm::distance(glm::vec2(x, y), glm::vec2(cx1, cy1));\n\t\t\t\t\tvalue += gauss(norm, 3.0f) * 20.0f;\n\t\t\t\t}\n\t\t\t\t{\n\t\t\t\t\tfloat norm = glm::distance(glm::vec2(x, y), glm::vec2(cx2, cy2));\n\t\t\t\t\tvalue += gauss(norm, 3.0f) * 20.0f;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t_u_cur[index] = value;\n\t\t\t}\n\t\t}\n\n\t\t_u_pre = _u_new = _u_cur;\n\t}\n\tvoid step() {\n\t\tfloat deltaX = float(kWaveWidth) / float(kWaveGrid);\n\t\tfloat deltaT = 1.0f / 60.0f;\n\t\tfloat c = 2.0f;\n\t\tfloat mul = deltaT * deltaT * c * c / (deltaX * deltaX);\n\t\tfor (int x = 1; x < kWaveGrid - 1; ++x) {\n\t\t\tfor (int y = 1; y < kWaveGrid - 1; ++y) {\n\t\t\t\tint index = this->valueIndex(x, y);\n\n\t\t\t\tfloat uL = _u_cur[this->valueIndex(x - 1, y)];\n\t\t\t\tfloat uR = _u_cur[this->valueIndex(x + 1, y)];\n\t\t\t\tfloat uT = _u_cur[this->valueIndex(x, y - 1)];\n\t\t\t\tfloat uB = _u_cur[this->valueIndex(x, y + 1)];\n\n\t\t\t\tfloat u_pre = _u_pre[index];\n\t\t\t\tfloat u = _u_cur[index];\n\t\t\t\t_u_new[index] = u + u - u_pre + mul * (-4.0f * u + uL + uR + uT + uB);\n\t\t\t}\n\t\t}\n\n\t\tstd::swap(_u_pre, _u_cur);\n\t\tstd::swap(_u_cur, _u_new);\n\t}\n\n\tenum {\n\t\tkWaveGrid = 300,\n\t\tkWaveWidth = 100\n\t};\n\n\tint valueIndex(int x, int y) const {\n\t\treturn y * kWaveGrid + x;\n\t}\n\tfloat value(int x, int y) const {\n\t\treturn _u_cur[valueIndex(x, y)];\n\t}\n\tint widthN() const {\n\t\treturn kWaveGrid;\n\t}\n\tint heightN() const {\n\t\treturn kWaveGrid;\n\t}\n\n\tfloat width() const {\n\t\treturn kWaveWidth;\n\t}\n\tfloat height() const {\n\t\treturn kWaveWidth;\n\t}\nprivate:\n\tstd::vector<float> _u_pre;\n\tstd::vector<float> _u_cur;\n\tstd::vector<float> _u_new;\n};\n\n```\n\n\u672c\u8cea\u7684\u306a\u30b3\u30fc\u30c9\u306fstep\u95a2\u6570\u306e\u4e2d\u306e\u4e00\u90e8\u306e\u884c\u3060\u3051\u3067\u3001\u3042\u3068\u306f\u3055\u3057\u3066\u91cd\u8981\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n\u3053\u308c\u3092\u30d3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba\u3059\u308b\u3068\u3001\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u304d\u308c\u3044\u3067\u3059\u306d\uff01\n![Animation.gif](https://qiita-image-store.s3.amazonaws.com/0/8588/93fd32c7-e458-a59a-ab3f-5d1195e1e459.gif)\n\n\n# \u6e1b\u8870\n\u3088\u304f\u3042\u308a\u3075\u308c\u305f\u73fe\u8c61\u3068\u3057\u3066\u3001\u6e1b\u8870\u304c\u3042\u308a\u307e\u3059\u3002\u6e1b\u8870\u3092\u8003\u616e\u306b\u3044\u308c\u308b\u3068\u3001\u5916\u529b\u306a\u3069\u304c\u52a0\u308f\u3089\u306a\u3044\u9650\u308a\u3001\u3044\u305a\u308c\u6ce2\u306e\u9ad8\u3055\u304c\u6e1b\u3063\u3066\u3044\u304d\u6700\u5f8c\u306b\u306f0\u306b\u53ce\u675f\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f\u7269\u7406\u7684\u306a\u6839\u62e0\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u901f\u5ea6\u306b\u6bd4\u4f8b\u3059\u308b\u6e1b\u8870\u9805\uff08\u5b9a\u6570k\u3068\u3057\u3066\uff09\u3092\u5165\u308c\u3066\u307f\u307e\u3059\u3002\u7c98\u6027\u62b5\u6297\u306e\u3088\u3046\u306a\u8003\u3048\u65b9\u3067\u3059\u3002\n\u3053\u308c\u3092\u307b\u3068\u3093\u3069\u4e0a\u8a18\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u304c\u3001\u6700\u5f8c\u306e\u9805\u3060\u3051\u5c11\u3057\u5909\u308f\u3063\u3066\u304d\u307e\u3059\u3002\n\n```math\n\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } ={ c }^{ 2 }(\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ x }^{ 2 } } +\\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }y^{ 2 } } )-k\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }t } \\\\ \\frac { { \\partial  }^{ 2 }u(x,y,t) }{ { \\partial  }{ t }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\\frac { { \\partial  }u(x,y,t) }{ { \\partial  }t } \\\\ \\frac { u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft) }{ { \u22bft }^{ 2 } } =\\frac { { c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\\frac { u(x,y,t)-u(x,y,t-\u22bft) }{ \u22bft } \\\\ u(x,y,t-\u22bft)-2u(x,y,t)+u(x,y,t+\u22bft)=\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\u22bft\\{ u(x,y,t)-u(x,y,t-\u22bft)\\} \\\\ u(x,y,t+\u22bft)=2u(x,y,t)-u(x,y,t-\u22bft)+\\frac { { { \u22bft }^{ 2 }c }^{ 2 } }{ { \u22bfx }^{ 2 } } \\left\\{ u(x-\u22bfx,y,t)+u(x+\u22bfx,y,t)+u(x,y-\u22bfx,t)+u(x,y+\u22bfx,t)-4u(x,y,t) \\right\\} -k\u22bft\\{ u(x,y,t)-u(x,y,t-\u22bft)\\} \n\n```\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u5074\u3082\u8a72\u5f53\u7b87\u6240\u3060\u3051\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u307e\u3059\u3002\n\n```cpp\n\nint index = this->valueIndex(x, y);\n\nfloat uL = _u_cur[this->valueIndex(x - 1, y)];\nfloat uR = _u_cur[this->valueIndex(x + 1, y)];\nfloat uT = _u_cur[this->valueIndex(x, y - 1)];\nfloat uB = _u_cur[this->valueIndex(x, y + 1)];\n\nfloat u_pre = _u_pre[index];\nfloat u = _u_cur[index];\n\nfloat k = 0.1f;\nfloat damp = - k * deltaT * (u - u_pre);\n_u_new[index] = u + u - u_pre + mul * (-4.0f * u + uL + uR + uT + uB) + damp;\n\n```\n\n\u3053\u3061\u3089\u3082\u30d3\u30b8\u30e5\u30a2\u30e9\u30a4\u30ba\u3059\u308b\u3068\u78ba\u304b\u306b\u3044\u3044\u304b\u3093\u3058\u306b\u6e1b\u8870\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n![Animation2.gif](https://qiita-image-store.s3.amazonaws.com/0/8588/21f134e3-db7d-95ad-ac0e-4d3d825f1ec8.gif)\n\n\u662f\u975e\u307f\u306a\u3055\u3093\u3082\u8272\u3005\u6570\u5f0f\u3084\u3089\u30b3\u30fc\u30c9\u3084\u3089\u3092\u3044\u3058\u3063\u3066\u697d\u3057\u3093\u3067\u307f\u3066\u306f\u3044\u304b\u304c\u3067\u3057\u3087\u3046\u304b\n", "tags": ["C++", "\u6570\u5024\u8a08\u7b97"]}