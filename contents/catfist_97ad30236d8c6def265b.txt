{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u3057\u3066\u5229\u7528\n\n\n\u5f15\u6570\u3068\u3057\u3066off\u304c\u4e0e\u3048\u3089\u308c\u305f\u5834\u5408\u306e\u307f\u63a5\u7d9a\u89e3\u9664\n\n\n\nblueutil\u3067Bluetooth\u3092\u6709\u52b9\u5316\n\nnetworksetup -getinfo\u3067\u63a5\u7d9a\u72b6\u6cc1\u3092\u78ba\u8a8d\n\n\n\u65e2\u306b\u63a5\u7d9a\u3057\u3066\u3044\u308b\u306e\u306b\u63a5\u7d9a\u3057\u3088\u3046\u3068\u3059\u308b\u3001\u307e\u305f\u306f\u672a\u63a5\u7d9a\u306a\u306e\u306b\u89e3\u9664\u3057\u3088\u3046\u3068\u3059\u308b\u5834\u5408\u3001\u51e6\u7406\u3092\u5b9f\u884c\u3057\u306a\u3044\n\n\nGUI\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u3067MenuExtra\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u63a5\u7d9a\u3092On/Off\n\n\n\u5229\u7528\u65b9\u6cd5\n$ osascript ~/bin/osascript/btconnect.scpt\n$ osascript ~/bin/osascript/btconnect.scpt off\n\n\n\u30b3\u30fc\u30c9\n\nbtconnect.scpt\n------------------------------------------\n-- [Description]\n-- Activate bluetooth with 'blueutil'.\n-- Connect or disconnect bluetooth tethering of iPhone.\n-- Reffer : http://d.hatena.ne.jp/zariganitosh/20100119/1263886959\n------------------------------------------\n\nproperty DeviceName : \"MyiPhone\" -- \u89aa\u6a5f\u3067\u8a2d\u5b9a\u3057\u305f\u30c7\u30d0\u30a4\u30b9\u540d\u3092\u6307\u5b9a\n\n-- Process\non run argv\n    set MenuOpt to \"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3078\u63a5\u7d9a\"\n    try\n        if (first item of argv) is \"off\" then set MenuOpt to \"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089\u63a5\u7d9a\u89e3\u9664\"\n    end try\n    -- return result\n    do shell script \"/usr/local/bin/blueutil on\"\n    repeat\n        if (do shell script \"/usr/local/bin/blueutil status | cut -d' ' -f2\") is \"on\" then exit \n        delay 0.2\n    end repeat\n    if (do shell script \"networksetup -getinfo 'Bluetooth PAN' | grep -q 'Ethernet Address: (null)'; echo $?\") is \"0\" then\n        set Porpose to \"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3078\u63a5\u7d9a\"\n    else\n        set Porpose to \"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089\u63a5\u7d9a\u89e3\u9664\"\n    end if\n    if MenuOpt = Porpose then click_menu_extra(\"bluetooth/\" & DeviceName & \"/\" & MenuOpt)\nend run\n\n-- Hundler\non split(sourceText, separator)\n    if sourceText = \"\" then return {}\n    set oldDelimiters to AppleScript's text item delimiters\n    set AppleScript's text item delimiters to {separator}\n    set theList to text items of sourceText\n    set AppleScript's text item delimiters to oldDelimiters\n    return theList\nend split\non number_from(str)\n    try\n        str as number\n        on error\n        str\n    end try\nend number_from\non click_menu_extra(menu_path)\n    if menu_path is \"\" then\n        error \"menu_path \u304c\u5165\u529b\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\"\n    end if\n    set mp to split(menu_path, \"/\")\n    tell application \"System Events\"\n        tell process \"SystemUIServer\"\n            set frontmost to true\n            click (menu bar 1's first menu bar item whose attribute \"AXDescription\"'s value is (mp's item 1))\n            repeat with i from 2 to mp's length\n                click (result's menu 1's menu item (my number_from(mp's item i)))\n            end repeat\n            delay 0.1 --\u9023\u7d9a\u3057\u3066\u30e1\u30cb\u30e5\u30fc\u3092\u64cd\u4f5c\u3059\u308b\u6642\u3001\u3072\u3068\u547c\u5438\u5fc5\u8981\n        end tell\n    end tell\nend click_menu_extra\n\n\n\n## \u6982\u8981\n* \u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u3057\u3066\u5229\u7528\n\t* \u5f15\u6570\u3068\u3057\u3066`off`\u304c\u4e0e\u3048\u3089\u308c\u305f\u5834\u5408\u306e\u307f\u63a5\u7d9a\u89e3\u9664\n* [blueutil](https://github.com/toy/blueutil)\u3067Bluetooth\u3092\u6709\u52b9\u5316\n* `networksetup -getinfo`\u3067\u63a5\u7d9a\u72b6\u6cc1\u3092\u78ba\u8a8d\n\t* \u65e2\u306b\u63a5\u7d9a\u3057\u3066\u3044\u308b\u306e\u306b\u63a5\u7d9a\u3057\u3088\u3046\u3068\u3059\u308b\u3001\u307e\u305f\u306f\u672a\u63a5\u7d9a\u306a\u306e\u306b\u89e3\u9664\u3057\u3088\u3046\u3068\u3059\u308b\u5834\u5408\u3001\u51e6\u7406\u3092\u5b9f\u884c\u3057\u306a\u3044\n* GUI\u30b9\u30af\u30ea\u30d7\u30c6\u30a3\u30f3\u30b0\u3067MenuExtra\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u63a5\u7d9a\u3092On/Off\n\n## \u5229\u7528\u65b9\u6cd5\n\n```sh\n$ osascript ~/bin/osascript/btconnect.scpt\n$ osascript ~/bin/osascript/btconnect.scpt off\n```\n\n## \u30b3\u30fc\u30c9\n\n```btconnect.scpt\n------------------------------------------\n-- [Description]\n-- Activate bluetooth with 'blueutil'.\n-- Connect or disconnect bluetooth tethering of iPhone.\n-- Reffer : http://d.hatena.ne.jp/zariganitosh/20100119/1263886959\n------------------------------------------\n\nproperty DeviceName : \"MyiPhone\" -- \u89aa\u6a5f\u3067\u8a2d\u5b9a\u3057\u305f\u30c7\u30d0\u30a4\u30b9\u540d\u3092\u6307\u5b9a\n\n-- Process\non run argv\n\tset MenuOpt to \"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3078\u63a5\u7d9a\"\n\ttry\n\t\tif (first item of argv) is \"off\" then set MenuOpt to \"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089\u63a5\u7d9a\u89e3\u9664\"\n\tend try\n\t-- return result\n\tdo shell script \"/usr/local/bin/blueutil on\"\n\trepeat\n\t\tif (do shell script \"/usr/local/bin/blueutil status | cut -d' ' -f2\") is \"on\" then exit \n\t\tdelay 0.2\n\tend repeat\n\tif (do shell script \"networksetup -getinfo 'Bluetooth PAN' | grep -q 'Ethernet Address: (null)'; echo $?\") is \"0\" then\n\t\tset Porpose to \"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3078\u63a5\u7d9a\"\n\telse\n\t\tset Porpose to \"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089\u63a5\u7d9a\u89e3\u9664\"\n\tend if\n\tif MenuOpt = Porpose then click_menu_extra(\"bluetooth/\" & DeviceName & \"/\" & MenuOpt)\nend run\n\n-- Hundler\non split(sourceText, separator)\n\tif sourceText = \"\" then return {}\n\tset oldDelimiters to AppleScript's text item delimiters\n\tset AppleScript's text item delimiters to {separator}\n\tset theList to text items of sourceText\n\tset AppleScript's text item delimiters to oldDelimiters\n\treturn theList\nend split\non number_from(str)\n\ttry\n\t\tstr as number\n\t\ton error\n\t\tstr\n\tend try\nend number_from\non click_menu_extra(menu_path)\n\tif menu_path is \"\" then\n\t\terror \"menu_path \u304c\u5165\u529b\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\"\n\tend if\n\tset mp to split(menu_path, \"/\")\n\ttell application \"System Events\"\n\t\ttell process \"SystemUIServer\"\n\t\t\tset frontmost to true\n\t\t\tclick (menu bar 1's first menu bar item whose attribute \"AXDescription\"'s value is (mp's item 1))\n\t\t\trepeat with i from 2 to mp's length\n\t\t\t\tclick (result's menu 1's menu item (my number_from(mp's item i)))\n\t\t\tend repeat\n\t\t\tdelay 0.1 --\u9023\u7d9a\u3057\u3066\u30e1\u30cb\u30e5\u30fc\u3092\u64cd\u4f5c\u3059\u308b\u6642\u3001\u3072\u3068\u547c\u5438\u5fc5\u8981\n\t\tend tell\n\tend tell\nend click_menu_extra\n```\n\n", "tags": ["ShellScript", "AppleScript"]}