{"context": " More than 1 year has passed since last update.\n\n\u3084\u3063\u305f\u3053\u3068\nSIMD.js\u3067\u3069\u306e\u304f\u3089\u3044\u9ad8\u901f\u5316\u3067\u304d\u308b\u306e\u304b\u3001\u7c21\u5358\u306a\u753b\u50cf\u51e6\u7406\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u3084\u308b\u3053\u3068\u306f\u5358\u7d14\u3067\u3001Canvas\u304b\u3089\u53d6\u5f97\u3057\u305fRGBA\u3092YUV\u306b\u5909\u63db\u3057\u305f\u5f8c\u306b\u30ac\u30f3\u30de\u88dc\u6b63\u3092\u639b\u3051\u3001YUV\u304b\u3089RGBA\u306b\u623b\u3059\u3060\u3051\u3067\u3059\u3002\u30ac\u30f3\u30de\u88dc\u6b63\u306fLUT\u3092\u5f53\u3066\u308b\u3060\u3051\u3067SIMD\u306b\u4e57\u305b\u3089\u308c\u306a\u3044\u306e\u3067\u3001RGBA/YUV\u5909\u63db\u304cSIMD\u5316\u306e\u5bfe\u8c61\u3068\u306a\u308a\u307e\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305aRGBA\u304b\u3089YUV\u3078\u306e\u5909\u63db\u3060\u3051SIMD\u5316\u3057\u307e\u3057\u305f\u3002\nWindows 10 + Firefox Nightly 47.0a1\u3067\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002Edge\u3067\u3082\u8a2d\u5b9a\u3092\u5909\u3048\u308b\u3068SIMD\u304c\u4f7f\u3048\u308b\u306e\u3067\u3059\u304c\u3001\u30d3\u30c3\u30c8\u30b7\u30d5\u30c8\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u52d5\u304b\u306a\u3044\u3067\u3059\u3002\n\u30bd\u30fc\u30b9: https://github.com/arenahito/simdjs-example\n\u30c7\u30e2: http://arenahito.github.io/simdjs-example/\n\nSIMD\u5316\u524d\n\u307e\u305a\u306f\u3001SIMD\u306a\u3057\u3067\u4f5c\u308a\u307e\u3059\u3002\nRGBA\u304b\u3089YUV\u306b\u5909\u63db\u3059\u308b\u3060\u3051\u3067\u3059\u304c\u3001YUV\u3092\u52a0\u5de5\u3057\u3084\u3059\u3044\u3088\u3046\u306bPlaner\u5f62\u5f0f\u3068\u3057\u3066\u3044\u307e\u3059\u3002RGBA\u2192RGBA\u2192\u2026\u2026\u304b\u3089YYY\u2026\u2026\u2192UUU\u2026\u2026\u2192VVV\u2026\u2026\u3068\u306a\u308a\u307e\u3059\u3002\n\u3042\u3068\u3001Alpha\u306f\u3044\u3089\u306a\u3044\u306e\u3067\u6368\u3066\u3066\u3044\u307e\u3059\u3002YUV\u304b\u3089RGBA\u306b\u623b\u3059\u3068\u304d\u306f\u56fa\u5b9a\u5024\u3092\u8a2d\u5b9a\u3059\u308b\u611f\u3058\u3067\u3002\nfunction convertRgbaToYuv(rgba, width, height, output) {\n  var imageSize = width * height;\n\n  for (var y = 0; y < height; y++) {\n    var rgbaOffsetY = y * width * 4;\n    var yuvOffsetBaseY = y * width;\n\n    for (var x = 0; x < width; x++) {\n      var rgbaOffset = rgbaOffsetY + x * 4;\n      var yuvOffsetBase = yuvOffsetBaseY + x;\n\n      var r = rgba[rgbaOffset + 0];\n      var g = rgba[rgbaOffset + 1];\n      var b = rgba[rgbaOffset + 2];\n      output[yuvOffsetBase + imageSize * 0] = (306 * r + 601 * g + 117 * b) >> 10;\n      output[yuvOffsetBase + imageSize * 1] = (-173 * r - 339 * g + 512 * b + 131072) >> 10;\n      output[yuvOffsetBase + imageSize * 2] = (512 * r - 429 * g - 83 * b + 131072) >> 10;\n    }\n  }\n}\n\n\nSIMD\u5316\u5f8c\nSIMD\u5316\u3057\u3066\u307f\u307e\u3059\u3002\nInt32x4\u306bRGB\u306e3\u30d0\u30a4\u30c8\u3092\u4e57\u305b\u3066YUV\u306b\u5909\u63db\u3057\u307e\u3059\u30021\u30d0\u30a4\u30c8\u5206\u4f59\u3063\u3066\u3044\u308b\u4e0a\u306b\u30013\u4e26\u5217\u3060\u3068\u6027\u80fd\u306b\u671f\u5f85\u3067\u304d\u306a\u3044\u3093\u3058\u3083\u30fb\u30fb\u30fb\u3068\u304b\u8a00\u3063\u3066\u306f\u3044\u3051\u307e\u305b\u3093\u3002\nRGB\u2192Y\u3001RGB\u2192U\u3001RGB\u2192V\u3068\u8a08\u7b97\u3059\u308b\u306e\u3067\u306f\u7121\u304f\u3001RGB\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\u8a08\u7b97\u3057\u305f\u5f8c\u306b\u8db3\u3057\u8fbc\u307f\u307e\u3059\u3002\u3053\u3046\u3057\u306a\u3044\u3068\u52a0\u7b97\u51e6\u7406\u306bSIMD\u3092\u4f7f\u3048\u306a\u3044\u306e\u3067\u3002\nfunction convertRgbaToYuvSimd(rgba, width, height, output) {\n  var imageSize = width * height;\n  var arrayYUV = new Int32Array(4);\n\n  var vR0 = SIMD.Int32x4(306, -173, 512, 0);\n  var vG0 = SIMD.Int32x4(601, -339, -429, 0);\n  var vB0 = SIMD.Int32x4(117, 512, -83, 0);\n  var vUVOffset = SIMD.Int32x4(0, 131072, 131072, 0);\n\n  for (var y = 0; y < height; y++) {\n    var rgbaOffsetY = y * width * 4;\n    var yuvOffsetBaseY = y * width;\n\n    for (var x = 0; x < width; x++) {\n      var rgbaOffset = rgbaOffsetY + x * 4;\n      var yuvOffsetBase = yuvOffsetBaseY + x;\n\n      var r = rgba[rgbaOffset + 0];\n      var g = rgba[rgbaOffset + 1];\n      var b = rgba[rgbaOffset + 2];\n\n      var vR1 = SIMD.Int32x4.mul(SIMD.Int32x4.splat(r), vR0);\n      var vG1 = SIMD.Int32x4.mul(SIMD.Int32x4.splat(g), vG0);\n      var vB1 = SIMD.Int32x4.mul(SIMD.Int32x4.splat(b), vB0);\n\n      var vRGB1 = SIMD.Int32x4.add(vR1, vG1);\n      var vRGB2 = SIMD.Int32x4.add(vRGB1, vB1);\n      var vRGB3 = SIMD.Int32x4.add(vRGB2, vUVOffset);\n      var vRGB4 = SIMD.Int32x4.shiftRightByScalar(vRGB3, 10);\n\n      SIMD.Int32x4.store(arrayYUV, 0, vRGB4);\n      output[yuvOffsetBase + imageSize * 0] = arrayYUV[0];\n      output[yuvOffsetBase + imageSize * 1] = arrayYUV[1];\n      output[yuvOffsetBase + imageSize * 2] = arrayYUV[2];\n    }\n  }\n}\n\n\n\u8a66\u3057\u3066\u307f\u3066\nRGBA\u304b\u3089YUV\u306b10\u56de\u5909\u63db\u3059\u308b\u306e\u306b\u639b\u304b\u3063\u305f\u6642\u9593\u3092\u6e2c\u3063\u3066\u307f\u307e\u3057\u305f\u3002SIMD\u306a\u3057145ms\u3001SIMD\u3042\u308a170ms\u3002\u307e\u3042\u3001\u3042\u307e\u308a\u52b9\u7387\u7684\u306bSIMD\u5316\u51fa\u6765\u3066\u306a\u3044\u3067\u3059\u3057\u30fb\u30fb\u30fb\u3002\n\u51e6\u7406\u6027\u80fd\u306f\u304a\u3044\u3066\u304a\u304f\u3068\u3057\u3066\u3001\u305d\u3082\u305d\u3082\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u6a5f\u80fd\u304c\u8ca7\u5f31\u306a\u306e\u3067\u4f7f\u3044\u3065\u3089\u3044\u3067\u3059\u3002SSE\u3068\u304b\u306eIntel\u7cfb\u306e\u306f\u4f7f\u3063\u305f\u3053\u3068\u304c\u7121\u3044\u306e\u3067\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001Neon\u3068\u540c\u3058\u304f\u3089\u3044\u306e\u6a5f\u80fd\u306f\u6b32\u3057\u3044\u306a\u3068\u3002\n\n# \u3084\u3063\u305f\u3053\u3068\n[SIMD.js](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SIMD)\u3067\u3069\u306e\u304f\u3089\u3044\u9ad8\u901f\u5316\u3067\u304d\u308b\u306e\u304b\u3001\u7c21\u5358\u306a\u753b\u50cf\u51e6\u7406\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u3084\u308b\u3053\u3068\u306f\u5358\u7d14\u3067\u3001Canvas\u304b\u3089\u53d6\u5f97\u3057\u305fRGBA\u3092YUV\u306b\u5909\u63db\u3057\u305f\u5f8c\u306b\u30ac\u30f3\u30de\u88dc\u6b63\u3092\u639b\u3051\u3001YUV\u304b\u3089RGBA\u306b\u623b\u3059\u3060\u3051\u3067\u3059\u3002\u30ac\u30f3\u30de\u88dc\u6b63\u306fLUT\u3092\u5f53\u3066\u308b\u3060\u3051\u3067SIMD\u306b\u4e57\u305b\u3089\u308c\u306a\u3044\u306e\u3067\u3001RGBA/YUV\u5909\u63db\u304cSIMD\u5316\u306e\u5bfe\u8c61\u3068\u306a\u308a\u307e\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305aRGBA\u304b\u3089YUV\u3078\u306e\u5909\u63db\u3060\u3051SIMD\u5316\u3057\u307e\u3057\u305f\u3002\n\nWindows 10 + [Firefox Nightly](https://nightly.mozilla.org/) 47.0a1\u3067\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002Edge\u3067\u3082\u8a2d\u5b9a\u3092\u5909\u3048\u308b\u3068SIMD\u304c\u4f7f\u3048\u308b\u306e\u3067\u3059\u304c\u3001\u30d3\u30c3\u30c8\u30b7\u30d5\u30c8\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u52d5\u304b\u306a\u3044\u3067\u3059\u3002\n\n\u30bd\u30fc\u30b9: [https://github.com/arenahito/simdjs-example](https://github.com/arenahito/simdjs-example)\n\u30c7\u30e2: [http://arenahito.github.io/simdjs-example/](http://arenahito.github.io/simdjs-example/)\n\n# SIMD\u5316\u524d\n\u307e\u305a\u306f\u3001SIMD\u306a\u3057\u3067\u4f5c\u308a\u307e\u3059\u3002\nRGBA\u304b\u3089YUV\u306b\u5909\u63db\u3059\u308b\u3060\u3051\u3067\u3059\u304c\u3001YUV\u3092\u52a0\u5de5\u3057\u3084\u3059\u3044\u3088\u3046\u306bPlaner\u5f62\u5f0f\u3068\u3057\u3066\u3044\u307e\u3059\u3002RGBA\u2192RGBA\u2192\u2026\u2026\u304b\u3089YYY\u2026\u2026\u2192UUU\u2026\u2026\u2192VVV\u2026\u2026\u3068\u306a\u308a\u307e\u3059\u3002\n\u3042\u3068\u3001Alpha\u306f\u3044\u3089\u306a\u3044\u306e\u3067\u6368\u3066\u3066\u3044\u307e\u3059\u3002YUV\u304b\u3089RGBA\u306b\u623b\u3059\u3068\u304d\u306f\u56fa\u5b9a\u5024\u3092\u8a2d\u5b9a\u3059\u308b\u611f\u3058\u3067\u3002\n\n```js\nfunction convertRgbaToYuv(rgba, width, height, output) {\n  var imageSize = width * height;\n\n  for (var y = 0; y < height; y++) {\n    var rgbaOffsetY = y * width * 4;\n    var yuvOffsetBaseY = y * width;\n\n    for (var x = 0; x < width; x++) {\n      var rgbaOffset = rgbaOffsetY + x * 4;\n      var yuvOffsetBase = yuvOffsetBaseY + x;\n\n      var r = rgba[rgbaOffset + 0];\n      var g = rgba[rgbaOffset + 1];\n      var b = rgba[rgbaOffset + 2];\n      output[yuvOffsetBase + imageSize * 0] = (306 * r + 601 * g + 117 * b) >> 10;\n      output[yuvOffsetBase + imageSize * 1] = (-173 * r - 339 * g + 512 * b + 131072) >> 10;\n      output[yuvOffsetBase + imageSize * 2] = (512 * r - 429 * g - 83 * b + 131072) >> 10;\n    }\n  }\n}\n```\n\n# SIMD\u5316\u5f8c\nSIMD\u5316\u3057\u3066\u307f\u307e\u3059\u3002\nInt32x4\u306bRGB\u306e3\u30d0\u30a4\u30c8\u3092\u4e57\u305b\u3066YUV\u306b\u5909\u63db\u3057\u307e\u3059\u30021\u30d0\u30a4\u30c8\u5206\u4f59\u3063\u3066\u3044\u308b\u4e0a\u306b\u30013\u4e26\u5217\u3060\u3068\u6027\u80fd\u306b\u671f\u5f85\u3067\u304d\u306a\u3044\u3093\u3058\u3083\u30fb\u30fb\u30fb\u3068\u304b\u8a00\u3063\u3066\u306f\u3044\u3051\u307e\u305b\u3093\u3002\nRGB\u2192Y\u3001RGB\u2192U\u3001RGB\u2192V\u3068\u8a08\u7b97\u3059\u308b\u306e\u3067\u306f\u7121\u304f\u3001RGB\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\u8a08\u7b97\u3057\u305f\u5f8c\u306b\u8db3\u3057\u8fbc\u307f\u307e\u3059\u3002\u3053\u3046\u3057\u306a\u3044\u3068\u52a0\u7b97\u51e6\u7406\u306bSIMD\u3092\u4f7f\u3048\u306a\u3044\u306e\u3067\u3002\n\n```js\nfunction convertRgbaToYuvSimd(rgba, width, height, output) {\n  var imageSize = width * height;\n  var arrayYUV = new Int32Array(4);\n\n  var vR0 = SIMD.Int32x4(306, -173, 512, 0);\n  var vG0 = SIMD.Int32x4(601, -339, -429, 0);\n  var vB0 = SIMD.Int32x4(117, 512, -83, 0);\n  var vUVOffset = SIMD.Int32x4(0, 131072, 131072, 0);\n\n  for (var y = 0; y < height; y++) {\n    var rgbaOffsetY = y * width * 4;\n    var yuvOffsetBaseY = y * width;\n\n    for (var x = 0; x < width; x++) {\n      var rgbaOffset = rgbaOffsetY + x * 4;\n      var yuvOffsetBase = yuvOffsetBaseY + x;\n\n      var r = rgba[rgbaOffset + 0];\n      var g = rgba[rgbaOffset + 1];\n      var b = rgba[rgbaOffset + 2];\n\n      var vR1 = SIMD.Int32x4.mul(SIMD.Int32x4.splat(r), vR0);\n      var vG1 = SIMD.Int32x4.mul(SIMD.Int32x4.splat(g), vG0);\n      var vB1 = SIMD.Int32x4.mul(SIMD.Int32x4.splat(b), vB0);\n\n      var vRGB1 = SIMD.Int32x4.add(vR1, vG1);\n      var vRGB2 = SIMD.Int32x4.add(vRGB1, vB1);\n      var vRGB3 = SIMD.Int32x4.add(vRGB2, vUVOffset);\n      var vRGB4 = SIMD.Int32x4.shiftRightByScalar(vRGB3, 10);\n\n      SIMD.Int32x4.store(arrayYUV, 0, vRGB4);\n      output[yuvOffsetBase + imageSize * 0] = arrayYUV[0];\n      output[yuvOffsetBase + imageSize * 1] = arrayYUV[1];\n      output[yuvOffsetBase + imageSize * 2] = arrayYUV[2];\n    }\n  }\n}\n```\n\n# \u8a66\u3057\u3066\u307f\u3066\nRGBA\u304b\u3089YUV\u306b10\u56de\u5909\u63db\u3059\u308b\u306e\u306b\u639b\u304b\u3063\u305f\u6642\u9593\u3092\u6e2c\u3063\u3066\u307f\u307e\u3057\u305f\u3002SIMD\u306a\u3057145ms\u3001SIMD\u3042\u308a170ms\u3002\u307e\u3042\u3001\u3042\u307e\u308a\u52b9\u7387\u7684\u306bSIMD\u5316\u51fa\u6765\u3066\u306a\u3044\u3067\u3059\u3057\u30fb\u30fb\u30fb\u3002\n\n\u51e6\u7406\u6027\u80fd\u306f\u304a\u3044\u3066\u304a\u304f\u3068\u3057\u3066\u3001\u305d\u3082\u305d\u3082\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u6a5f\u80fd\u304c\u8ca7\u5f31\u306a\u306e\u3067\u4f7f\u3044\u3065\u3089\u3044\u3067\u3059\u3002SSE\u3068\u304b\u306eIntel\u7cfb\u306e\u306f\u4f7f\u3063\u305f\u3053\u3068\u304c\u7121\u3044\u306e\u3067\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001[Neon](http://www.arm.com/ja/products/processors/technologies/neon.php)\u3068\u540c\u3058\u304f\u3089\u3044\u306e\u6a5f\u80fd\u306f\u6b32\u3057\u3044\u306a\u3068\u3002\n", "tags": ["SIMD", "SIMD.js", "JavaScript"]}