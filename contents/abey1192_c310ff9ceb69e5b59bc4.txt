{"context": " More than 1 year has passed since last update.Ember.js \u306b\u8208\u5473\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u304a\u8a66\u3057\u3067\u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c0\u30fc\u307f\u305f\u3044\u306a\u3082\u306e\u3092\u4f5c\u3063\u3066\u307f\u3088\u3046\u304b\u3068\u601d\u3044\u307e\u3059\u3002\ndrop files here\u3063\u3066\u66f8\u3044\u3066\u3042\u308b\u5834\u6240\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3068\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3055\u308c\u3001upload\u30dc\u30bf\u30f3\u3067\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u304b\u3093\u3058\u3067\u3059\u3002\nJavaScript\u306f\u3042\u307e\u308a\u4f7f\u3044\u6163\u308c\u3066\u3044\u306a\u3044\u306e\u3068\u3001\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u306eMVC\u3068\u306f\u3061\u3087\u3063\u3068\u30cb\u30e5\u30a2\u30f3\u30b9\u304c\u9055\u3046\u3063\u307d\u3044\u3068\u3053\u308d\u306b\u60a9\u3093\u3060\u308a\u3057\u307e\u3057\u305f\uff08\u3044\u307e\u3060\u306b\u3088\u304f\u308f\u304b\u3063\u3066\u3044\u306a\u3044)\n\u30dd\u30a4\u30f3\u30c8\u306f Route\u3001Model\u3001Controller\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c Convension over Configuration\u3067\u7d50\u3073\u3064\u3044\u3066\u3044\u308b\u3063\u3066\u6240\u306a\u306e\u304b\u306a\u30fc\u3063\u3066\u601d\u3044\u307e\u3057\u305f\u3002\n\nindex.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta http-equiv=\"Content-type\" content=\"text/html; charset=utf-8\">\n    <script type='text/javascript' src='jquery.1.10.2.js'></script>\n    <script type='text/javascript' src='handlebars.js'></script>\n    <script type='text/javascript' src='ember.js'></script>\n    <script type='text/javascript' src='ember-data.js'></script>\n    <script type=\"text/javascript\" src='uploader.js'></script>\n  </head>\n\n  <style type=\"text/css\" media=\"screen\">\n    .drop-area {\n      width: 100%; height: 150px; background-color: #ddd; border: 1px solid #ccc;\n    }\n  </style>\n\n  <body>\n    <script type=\"text/x-handlebars\">\n      <h3>file uploader</h3>\n      {{outlet}}\n    </script>\n\n    <script type=\"text/x-handlebars\" data-template-name='files'>\n      {{#view Uploader.DropAreaView class='drop-area'}}\n        drop files here...\n      {{/view}}\n\n      <button {{action 'upload'}}> upload files. </button>\n      <br />\n      <table>\n        {{#each file in content}}\n          <tr>\n            <td>{{file.file.name}}</td>\n            <td><button {{action 'remove' file}}>remove</button></td>\n          </tr>\n        {{/each}}\n      </table>\n    </script>\n  </body>\n\n</html>\n\n\n\nuploader.js\n// create application\nUploader = Ember.Application.create({});\n\n//\nUploader.Store = DS.Store.extend({\n  revision: 12,\n  adapter: 'DS.FixtureAdapter'\n});\n\n//\nUploader.File = DS.Model.extend({\n  file: DS.attr('file')\n});\n\nUploader.File.FIXTURES = [];\n\n// files\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067 FilesController\u304c\u4f7f\u308f\u308c\u308b\u3089\u3057\u3044\nUploader.FilesController = Ember.ArrayController.extend({\n  actions: {\n    upload: function() {\n      // \u672c\u5f53\u306f Store\u3092\u4f7f\u3046\u3079\u304d\u306a\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3051\u3069\u3001\u9762\u5012\u3060\u3063\u305f\u306e\u3067\n      // FormData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u3063\u3066POST\u3059\u308b\n      var content = this.get('content');\n      var form = new FormData();\n\n      for(var idx = 0; idx < content.length; ++idx) {\n        var file = content.objectAt(idx);\n        form.append('files[]', file.get('file'));\n      }\n\n      var xhr = new XMLHttpRequest();\n      xhr.open('post', 'http://localhost:3000/uploader/files');\n      xhr.send(form);\n    },\n\n    addFiles: function(files) {\n      var content = this.get('content');\n      var store = this.get('store');\n\n      for(var idx = 0; idx < files.length; ++idx) {\n        var record = store.createRecord('file', {\n          file: files[idx]\n        });\n        content.pushObject(record);\n      }\n    },\n\n    remove: function(file) {\n      var content = this.get('content');\n      content.removeObject(file);\n    }\n  }\n});\n\n// \u30c9\u30ed\u30c3\u30d7\u3059\u308bView\u306e\u5b9a\u7fa9\u3002\nUploader.DropAreaView = Ember.View.extend({\n  attributeBindings: ['draggable'], // tag \u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u306b draggable='true'\u3092\u8ffd\u52a0\u3059\u308b\n  draggable: 'true',                       //\n\n  // \u666e\u901a\u306eDnD\u30a4\u30d9\u30f3\u30c8\n  drop: function(event) {\n    event.preventDefault();\n\n    var files = event.originalEvent.dataTransfer.files;\n    this.get('controller').send('addFiles', files);\n    return this._super(event);\n  },\n\n  dragEnter: function(event) {\n    event.preventDefault();\n    return true;\n  },\n\n  dragOver: function(event) {\n    event.preventDefault();\n    return false;\n  }\n});\n\n// \u4eca\u56de\u306fController\u3067\u5168\u3066\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u6271\u3046\u306e\u3067 Route\u306f\u4f5c\u3089\u306a\u304b\u3063\u305f\n\n// URI / \u3092 files \u306b\u30de\u30c3\u30d7\u3059\u308b\u3002 data-template-name='files'\u304c\u63cf\u753b\u3055\u308c\u308b\nUploader.Router.map(function() {\n  this.resource('files', { path: '/' });\n});\n\n\n\nEmber.js \u306b\u8208\u5473\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u304a\u8a66\u3057\u3067\u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c0\u30fc\u307f\u305f\u3044\u306a\u3082\u306e\u3092\u4f5c\u3063\u3066\u307f\u3088\u3046\u304b\u3068\u601d\u3044\u307e\u3059\u3002\ndrop files here\u3063\u3066\u66f8\u3044\u3066\u3042\u308b\u5834\u6240\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3068\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3055\u308c\u3001upload\u30dc\u30bf\u30f3\u3067\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u304b\u3093\u3058\u3067\u3059\u3002\n\nJavaScript\u306f\u3042\u307e\u308a\u4f7f\u3044\u6163\u308c\u3066\u3044\u306a\u3044\u306e\u3068\u3001\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u306eMVC\u3068\u306f\u3061\u3087\u3063\u3068\u30cb\u30e5\u30a2\u30f3\u30b9\u304c\u9055\u3046\u3063\u307d\u3044\u3068\u3053\u308d\u306b\u60a9\u3093\u3060\u308a\u3057\u307e\u3057\u305f\uff08\u3044\u307e\u3060\u306b\u3088\u304f\u308f\u304b\u3063\u3066\u3044\u306a\u3044)\n\n\u30dd\u30a4\u30f3\u30c8\u306f Route\u3001Model\u3001Controller\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c Convension over Configuration\u3067\u7d50\u3073\u3064\u3044\u3066\u3044\u308b\u3063\u3066\u6240\u306a\u306e\u304b\u306a\u30fc\u3063\u3066\u601d\u3044\u307e\u3057\u305f\u3002\n\n~~~html:index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta http-equiv=\"Content-type\" content=\"text/html; charset=utf-8\">\n    <script type='text/javascript' src='jquery.1.10.2.js'></script>\n    <script type='text/javascript' src='handlebars.js'></script>\n    <script type='text/javascript' src='ember.js'></script>\n    <script type='text/javascript' src='ember-data.js'></script>\n    <script type=\"text/javascript\" src='uploader.js'></script>\n  </head>\n\n  <style type=\"text/css\" media=\"screen\">\n    .drop-area {\n      width: 100%; height: 150px; background-color: #ddd; border: 1px solid #ccc;\n    }\n  </style>\n\n  <body>\n    <script type=\"text/x-handlebars\">\n      <h3>file uploader</h3>\n      {{outlet}}\n    </script>\n\n    <script type=\"text/x-handlebars\" data-template-name='files'>\n      {{#view Uploader.DropAreaView class='drop-area'}}\n        drop files here...\n      {{/view}}\n\n      <button {{action 'upload'}}> upload files. </button>\n      <br />\n      <table>\n        {{#each file in content}}\n          <tr>\n            <td>{{file.file.name}}</td>\n            <td><button {{action 'remove' file}}>remove</button></td>\n          </tr>\n        {{/each}}\n      </table>\n    </script>\n  </body>\n\n</html>\n~~~\n\n~~~javascript:uploader.js\n// create application\nUploader = Ember.Application.create({});\n\n//\nUploader.Store = DS.Store.extend({\n  revision: 12,\n  adapter: 'DS.FixtureAdapter'\n});\n\n//\nUploader.File = DS.Model.extend({\n  file: DS.attr('file')\n});\n\nUploader.File.FIXTURES = [];\n\n// files\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067 FilesController\u304c\u4f7f\u308f\u308c\u308b\u3089\u3057\u3044\nUploader.FilesController = Ember.ArrayController.extend({\n  actions: {\n    upload: function() {\n      // \u672c\u5f53\u306f Store\u3092\u4f7f\u3046\u3079\u304d\u306a\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3051\u3069\u3001\u9762\u5012\u3060\u3063\u305f\u306e\u3067\n      // FormData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u3063\u3066POST\u3059\u308b\n      var content = this.get('content');\n      var form = new FormData();\n\n      for(var idx = 0; idx < content.length; ++idx) {\n        var file = content.objectAt(idx);\n        form.append('files[]', file.get('file'));\n      }\n\n      var xhr = new XMLHttpRequest();\n      xhr.open('post', 'http://localhost:3000/uploader/files');\n      xhr.send(form);\n    },\n\n    addFiles: function(files) {\n      var content = this.get('content');\n      var store = this.get('store');\n\n      for(var idx = 0; idx < files.length; ++idx) {\n        var record = store.createRecord('file', {\n          file: files[idx]\n        });\n        content.pushObject(record);\n      }\n    },\n\n    remove: function(file) {\n      var content = this.get('content');\n      content.removeObject(file);\n    }\n  }\n});\n\n// \u30c9\u30ed\u30c3\u30d7\u3059\u308bView\u306e\u5b9a\u7fa9\u3002\nUploader.DropAreaView = Ember.View.extend({\n  attributeBindings: ['draggable'], // tag \u30a2\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8\u306b draggable='true'\u3092\u8ffd\u52a0\u3059\u308b\n  draggable: 'true',                       //\n\n  // \u666e\u901a\u306eDnD\u30a4\u30d9\u30f3\u30c8\n  drop: function(event) {\n    event.preventDefault();\n\n    var files = event.originalEvent.dataTransfer.files;\n    this.get('controller').send('addFiles', files);\n    return this._super(event);\n  },\n\n  dragEnter: function(event) {\n    event.preventDefault();\n    return true;\n  },\n  \n  dragOver: function(event) {\n    event.preventDefault();\n    return false;\n  }\n});\n\n// \u4eca\u56de\u306fController\u3067\u5168\u3066\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u6271\u3046\u306e\u3067 Route\u306f\u4f5c\u3089\u306a\u304b\u3063\u305f\n\n// URI / \u3092 files \u306b\u30de\u30c3\u30d7\u3059\u308b\u3002 data-template-name='files'\u304c\u63cf\u753b\u3055\u308c\u308b\nUploader.Router.map(function() {\n  this.resource('files', { path: '/' });\n});\n\n~~~", "tags": ["Ember.js1.0.0"]}