{"tags": ["NSD", "dns", "archLinux", "bind", "unbound"], "context": " More than 1 year has passed since last update.\n\nNSD\u3068\u306f\nNSD\u306f\u30b7\u30f3\u30d7\u30eb\u304b\u3064\u9ad8\u901f\u306a\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u306eDNS\u30b3\u30f3\u30c6\u30f3\u30c4\u30b5\u30fc\u30d0\u3067\u3059\u3002\nDNS\u30b5\u30fc\u30d0\u3068\u3057\u3066\u306fBIND\u304c\u6709\u540d\u3067\u3059\u304c\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3001\u30b5\u30a4\u30ba\u3001\u8a2d\u5b9a\u306e\u9762\u3067\u8efd\u91cf\u306a\u306e\u304c\u5229\u70b9\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u304a\u3001DNS\u30ad\u30e3\u30c3\u30b7\u30e5\u30b5\u30fc\u30d0\u3068\u3057\u3066\u306e\u6a5f\u80fd\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u540c\u3058\u958b\u767a\u5143\u306b\u3088\u308bUnbound\u304c\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\n\u76ee\u6a19\u3068\u6e96\u5099\n\n\u76ee\u6a19\nIPv4\u306b\u9650\u5b9a\u3057\u305f\u3001\u6b63\u5f15\u304d\u3068\u9006\u5f15\u304d\u3092\u884c\u3048\u308b\u3054\u304f\u57fa\u790e\u7684\u306aDNS\u30b3\u30f3\u30c6\u30f3\u30c4\u30b5\u30fc\u30d0\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\u3002\n\n\u74b0\u5883\n\u3055\u304f\u3089VPS + ArchLinux\n\n\u6e96\u5099\nArchLinux\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3067\u3001\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u307e\u308f\u308a\u306e\u8a2d\u5b9a\u3082\u7d42\u308f\u3063\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\u8a2d\u5b9a\u4f8b\u3067\u306f\u30c9\u30e1\u30a4\u30f3\u3092 example.com \u3001IP\u30a2\u30c9\u30ec\u30b9\u3092 100.150.200.250 \u3068\u3057\u307e\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u8a2d\u5b9a\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npacman -Sy nsd\n\nNSD\u306e\u8a2d\u5b9a\n\u8a2d\u5b9a\u30b5\u30f3\u30d7\u30eb\u3092\u30b3\u30d4\u30fc\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\ncp /etc/nsd/nsd.conf.sample /etc/nsd/nsd.conf\nnano /etc/nsd.conf\ndo-ip6: no\n\nzonesdir: \"/etc/nsd/zone\"\n\n//\u6b63\u5f15\u304d\nzone:\n\u3000\u3000name: \u201cexample.com\u201d\n\u3000\u3000zonefile: \u201cexample.com.zone\u201d\n\n//\u9006\u5f15\u304d\nzone:\n\u3000\u3000name: 200.150.100.in-addr.arpa\n\u3000\u3000zonefile: 200.150.100.in-addr.arpa.zone\n\nIP\u30a2\u30c9\u30ec\u30b9\u3092\u53cd\u8ee2\u3055\u305b\u305f\u3082\u306e\u3092\u9006\u5f15\u304d\u306e\u30be\u30fc\u30f3\u3068\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\nRFC\u3067\u898f\u5b9a\u3055\u308c\u305f\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306b\u306a\u308a\u307e\u3059\u3002BIND\u3067\u4f7f\u7528\u3057\u3066\u3044\u308b\u3082\u306e\u3082\u4f7f\u3048\u308b\u306f\u305a\u3067\u3059\u3002\nmkdir /etc/nsd/zone\n\n\u6b63\u5f15\u304d\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\nnano /etc/nsd/zone/example.com.zone\n$TTL 3600\n\n@ IN SOA ns.example.com. root.example.com. (\n        201xxxxx ;Serial \u6709\u52b9\u306a\u958b\u59cb\u65e5\n        3600 ;Refresh\n        900 ;Retry\n        3600000 ;Expire\n        3600 ) ;Minimum\nIN NS ns.example.com. ;\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u30fc\nexample.com. IN MX 10 mail.example.com. ;\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u30fc\n@ IN A 100.150.200.250\nmail IN A 100.150.200.250\n\n\n\u9006\u5f15\u304d\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\nnano /etc/nsd/zone/200.150.100.in-addr.arpa.zone\n$TTL 3600\n@ IN SOA ns.example.com. root.example.com. (\n       201xxxxx ;Serial\n        3600 ;Refresh\n        900 ;Retry\n        3600000 ;Expire\n        3600 ) ;Minimum\nIN NS ns.example.com.\nIN A 255.255.254.0 ;\u30b5\u30d6\u30cd\u30c3\u30c8\u30de\u30b9\u30af\n100 IN PTR ns.example.com.\n100 IN PTR mail.example.com.\n\n\nNSD\u306e\u8d77\u52d5\nsystemctl start nsd\nsystemctl enable nsd\n\n##NSD\u3068\u306f\n\n[NSD](http://www.nlnetlabs.nl/projects/nsd/)\u306f\u30b7\u30f3\u30d7\u30eb\u304b\u3064\u9ad8\u901f\u306a\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u306eDNS\u30b3\u30f3\u30c6\u30f3\u30c4\u30b5\u30fc\u30d0\u3067\u3059\u3002\nDNS\u30b5\u30fc\u30d0\u3068\u3057\u3066\u306f[BIND](http://www.isc.org/downloads/bind/)\u304c\u6709\u540d\u3067\u3059\u304c\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3001\u30b5\u30a4\u30ba\u3001\u8a2d\u5b9a\u306e\u9762\u3067\u8efd\u91cf\u306a\u306e\u304c\u5229\u70b9\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u306a\u304a\u3001DNS\u30ad\u30e3\u30c3\u30b7\u30e5\u30b5\u30fc\u30d0\u3068\u3057\u3066\u306e\u6a5f\u80fd\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u540c\u3058\u958b\u767a\u5143\u306b\u3088\u308b[Unbound](https://unbound.net/)\u304c\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\n##\u76ee\u6a19\u3068\u6e96\u5099\n\n###\u76ee\u6a19\n\nIPv4\u306b\u9650\u5b9a\u3057\u305f\u3001\u6b63\u5f15\u304d\u3068\u9006\u5f15\u304d\u3092\u884c\u3048\u308b\u3054\u304f\u57fa\u790e\u7684\u306aDNS\u30b3\u30f3\u30c6\u30f3\u30c4\u30b5\u30fc\u30d0\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\u3002\n\n###\u74b0\u5883\n\n\u3055\u304f\u3089VPS + ArchLinux\n\n###\u6e96\u5099\n\nArchLinux\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3067\u3001\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u307e\u308f\u308a\u306e\u8a2d\u5b9a\u3082\u7d42\u308f\u3063\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\u8a2d\u5b9a\u4f8b\u3067\u306f\u30c9\u30e1\u30a4\u30f3\u3092 *example.com* \u3001IP\u30a2\u30c9\u30ec\u30b9\u3092 *100.150.200.250* \u3068\u3057\u307e\u3059\u3002\n\n##\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u8a2d\u5b9a\n\n###\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```pacman -Sy nsd```\n\n###NSD\u306e\u8a2d\u5b9a\n\n\u8a2d\u5b9a\u30b5\u30f3\u30d7\u30eb\u3092\u30b3\u30d4\u30fc\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n```cp /etc/nsd/nsd.conf.sample /etc/nsd/nsd.conf```\n\n```nano /etc/nsd.conf```\n\n```\ndo-ip6: no\n\nzonesdir: \"/etc/nsd/zone\"\n\n//\u6b63\u5f15\u304d\nzone:\n\u3000\u3000name: \u201cexample.com\u201d\n\u3000\u3000zonefile: \u201cexample.com.zone\u201d\n\n//\u9006\u5f15\u304d\nzone:\n\u3000\u3000name: 200.150.100.in-addr.arpa\n\u3000\u3000zonefile: 200.150.100.in-addr.arpa.zone\n```\n\nIP\u30a2\u30c9\u30ec\u30b9\u3092\u53cd\u8ee2\u3055\u305b\u305f\u3082\u306e\u3092\u9006\u5f15\u304d\u306e\u30be\u30fc\u30f3\u3068\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n###\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\nRFC\u3067\u898f\u5b9a\u3055\u308c\u305f\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306b\u306a\u308a\u307e\u3059\u3002BIND\u3067\u4f7f\u7528\u3057\u3066\u3044\u308b\u3082\u306e\u3082\u4f7f\u3048\u308b\u306f\u305a\u3067\u3059\u3002\n\n```mkdir /etc/nsd/zone```\n\n####\u6b63\u5f15\u304d\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\n\n```nano /etc/nsd/zone/example.com.zone```\n\n```\n$TTL 3600\n\n@ IN SOA ns.example.com. root.example.com. (\n        201xxxxx ;Serial \u6709\u52b9\u306a\u958b\u59cb\u65e5\n        3600 ;Refresh\n        900 ;Retry\n        3600000 ;Expire\n        3600 ) ;Minimum\nIN NS ns.example.com. ;\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u30fc\nexample.com. IN MX 10 mail.example.com. ;\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u30fc\n@ IN A 100.150.200.250\nmail IN A 100.150.200.250\n```\n\n####\u9006\u5f15\u304d\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\n\n```nano /etc/nsd/zone/200.150.100.in-addr.arpa.zone```\n\n```\n$TTL 3600\n@ IN SOA ns.example.com. root.example.com. (\n       201xxxxx ;Serial\n        3600 ;Refresh\n        900 ;Retry\n        3600000 ;Expire\n        3600 ) ;Minimum\nIN NS ns.example.com.\nIN A 255.255.254.0 ;\u30b5\u30d6\u30cd\u30c3\u30c8\u30de\u30b9\u30af\n100 IN PTR ns.example.com.\n100 IN PTR mail.example.com.\n```\n\n###NSD\u306e\u8d77\u52d5\n\n```\nsystemctl start nsd\nsystemctl enable nsd\n```\n"}