{"context": " More than 1 year has passed since last update.\u3084\u3063\u3068\u6765\u307e\u3057\u305f\u306d! \u5b09\u3057\u3055\u3068\u52e2\u3044\u3067\u8a18\u4e8b\u66f8\u304d\u307e\u3059w\n\n\n2014\u5e7411\u670827\u65e5 \u5f85\u671b\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u4e00\u89a7\u306e\u53d6\u5f97\u7528\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u304c\u5b9f\u88c5\u3055\u308c\u307e\u3057\u305f\n\u5272\u3068\u9577\u3044\u9053\u306e\u308a\u3067\u3057\u305f\u306d\u7b11\ntwitter\u306a\u3069\u3067\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u5207\u671b\u306e\u58f0\u304c\u3042\u308a\u307e\u3057\u305f\u7b11\n\n\u4e2d\u306e\u4eba\u306f\u9811\u5f35\u3063\u3066\u305f\u3093\u3067\u3057\u3087\u3046\u306d :)\nhttp://developer.chatwork.com/ja/changelogs.html\n\u4eca\u307e\u3067\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u53d6\u5f97API\u304c\u7121\u304b\u3063\u305f\u306e\u3067Hubot+Slack\u3067\u3088\u304f\u3042\u308bBot\u306b\u30ea\u30d7\u30e9\u30a4\u3092\u9001\u308b\u3068\u8fd4\u4fe1\u3057\u3066\u304f\u308c\u308b\u307f\u305f\u3044\u306a\u3053\u3068\u304c\u51fa\u6765\u306a\u304b\u3063\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u3053\u308c\u3067\u3084\u3063\u3068\u305d\u3046\u3044\u3063\u305f\u5b9f\u88c5\u3082\u51fa\u6765\u305d\u3046\u3067\u3059\u3002\n\n\u3055\u3063\u305d\u304f\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\nhttp://developer.chatwork.com/ja/endpoint_rooms.html#GET-rooms-room_id-messages\n\n\n\u30b5\u30f3\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\n\u3068\u308a\u3042\u3048\u305a\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u307f\u307e\u3059\u3002\ncurl -X GET -H \"X-ChatWorkToken: \u81ea\u5206\u306eAPI\u30c8\u30fc\u30af\u30f3\" \"https://api.chatwork.com/v1/rooms/{room_id}/messages?force=0\"\n\n\u3044\u3044\u611f\u3058\u306b\u8fd4\u3063\u3066\u6765\u3066\u304f\u308c\u307e\u3057\u305f\u3002\n\nNode.js\u304b\u3089\u547c\u3073\u51fa\u3057\u3066\u307f\u307e\u3059\u3002\n\u524d\u306b\u66f8\u3044\u305f\u8a18\u4e8b(Chatwork\u306e\u5b9a\u671f\u9023\u7d61\u3092\u81ea\u52d5\u5316\uff01Chatwork API\u3092\u4f7f\u3063\u3066\u696d\u52d9\u52b9\u7387\u5316\u3057\u3066\u307f\u305f\u3002)\u3092\u53c2\u8003\u306b\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\u3068\u308a\u3042\u3048\u305aGET\u3059\u308b\u3060\u3051\u306a\u306e\u3067\u30b7\u30f3\u30d7\u30eb\u306a\u30b3\u30fc\u30c9\u3067\u3059\u306d\u3002\n\ncw.js\nvar request = require('request');\nvar room_id = '\u53d6\u5f97\u3059\u308b\u30eb\u30fc\u30e0\u306eID';\n\nvar options = {\n    url: 'https://api.chatwork.com/v1/rooms/'+room_id+'/messages?force=1',\n    headers: {\n        'X-ChatWorkToken': 'API\u30ad\u30fc'\n    },\n    json: true\n};\n\nrequest.get(options, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n        console.log(body);\n    }else{\n        console.log('error: '+ response.statusCode);\n    }\n});\n\n\n\u5b9f\u884c\u3057\u3066\u307f\u308b\u3002\n$ npm i request\n$ node cw\n\n node cw                                                                                                                                            \n[ { message_id: 455021086,\n    account: \n     { account_id: 933649,\n       name: '\u83c5\u539f \u306e\u3073\u3059\u3051',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/381/381489.rsz.png' },\n    body: '[info][title][dtext:chatroom_groupchat_created][/title][dtext:chatroom_chatname_is]\u30de\u30b7\u30e5\u30de\u30ed\u738b\u56fd[dtext:chatroom_set]\\n\\n[dtext:chatroom_member_is][piconname:768003],[piconname:933649],[piconname:1090960][dtext:chatroom_added][/info]',\n    send_time: 1415621317,\n    update_time: 0 },\n  { message_id: 455021936,\n    account: \n     { account_id: 1090960,\n       name: '\u4e2d\u6751 \u5927\u9a0e(\u307e\u308dC)',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/509/509281.rsz.jpg' },\n    body: '\u5916\u90e8\u5411\u3051\u306b\u3042\u306a\u305f\u3060\u3051\u306e\u30ab\u30e1\u30e9\u30a2\u30d7\u30ea\u8b1b\u5ea7\u3092\u958b\u3044\u3066\u307f\u305f\u3044',\n    send_time: 1415621378,\n    update_time: 1415621476 },\n  { message_id: 455023372,\n    account: \n     { account_id: 933649,\n       name: '\u83c5\u539f \u306e\u3073\u3059\u3051',\n\u30fb\n\u30fb\n\u30fb\n\u30fb\n\n\u304a\u304a\u304a\u3002\u53d6\u5f97\u51fa\u6765\u307e\u3057\u305f\u306d!\n\n\u30c7\u30fc\u30bf\u3092\u5c11\u3057\u307f\u3066\u307f\u308b\n\n\u3053\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3084\u308a\u53d6\u308a\u306ejson\u30c7\u30fc\u30bf\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u2193\n{ message_id: 472495511,\n    account: \n     { account_id: 768003,\n       name: '\u698e\u672c \u9e97',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/563/563430.rsz.jpg' },\n    body: 'hoge hoge,',\n    send_time: 1417109200,\n    update_time: 0 },\n  { message_id: 472495614,\n    account: \n     { account_id: 768003,\n       name: '\u698e\u672c \u9e97',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/563/563430.rsz.jpg' },\n    body: '[To:933649] \u83c5\u539f \u306e\u3073\u3059\u3051\u3055\u3093\\n\\n\u306e\u3073\u3059\u3051\u3055\u3093\\n\u30ea\u30b9\u3068\u8868\u793a\u3092\u6a2a\u4e26\u3073\u306b\u3059\u308bcss\u304c\u3046\u307e\u304f\u53cd\u6620\u3055\u308c\u306a\u3044\u306e\u3067\u3059\u304c\u4f55\u6545\u3067\u3057\u3087\u3046\u2026',\n    send_time: 1417109244,\n    update_time: 0 },\n  { message_id: 472495664,\n    account: \n     { account_id: 933649,\n       name: '\u83c5\u539f \u306e\u3073\u3059\u3051',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/381/381489.rsz.png' },\n    body: '\u30ea\u30b9',\n    send_time: 1417109271,\n    update_time: 0 },\n  { message_id: 4724956\n\n\n\u500b\u4eba\u7684\u306a\u611f\u60f3\u3067\u3059\u3051\u3069\u3001 \u8ab0\u304b\u5b9b\u306e\u6295\u7a3f[To:xxxx]\u306e\u5834\u5408\u3092\u8b58\u5225\u3059\u308b\u30d5\u30e9\u30b0\u304c\u3042\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u306d\u3002\n\n\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u30ab\u30f3\u30bf\u30f3\u306a\u30aa\u30a6\u30e0\u8fd4\u3057BOT\u3092\u4f5c\u3063\u3066\u307f\u305f\nchatwork\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u76e3\u8996\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u30675\u79d2\u306b\u4e00\u56de\u30c1\u30a7\u30c3\u30af\u3059\u308b\u611f\u3058\u306b\u3057\u3066\u307f\u307e\u3059\u3002\nAPI\u306e\u5229\u7528\u5236\u9650\u306f\u73fe\u6642\u70b9\u30675\u5206\u3042\u305f\u308a100\u56de\u307e\u3067\u3089\u3057\u3044\u306e\u30675\u79d21\u56de\u304f\u3089\u3044\u306a\u5927\u4e08\u592b\u304b\u306a\u3002\nhttp://developer.chatwork.com/ja/endpoints.html\n\nforce=0\u3067\u5dee\u5206\u3092\u53d6\u5f97\u51fa\u6765\u307e\u3059\u3002\nmessage\u306eAPI\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306eforce\u306e\u5024\u30920\u306b\u3059\u308c\u3070\u5dee\u5206\u3060\u3051\u53d6\u308c\u307e\u3059\u3002\n1\u3060\u3068\u6700\u65b0100\u4ef6\u3089\u3057\u3044\u3067\u3059\u3002\n\n\u307e\u305a\u306f\u76e3\u8996\u90e8\u5206\u3092\u4f5c\u308a\u307e\u3059\n\ncw.js\nvar request = require('request');\nvar room_id = '\u53d6\u5f97\u3059\u308b\u30eb\u30fc\u30e0\u306eID';\n\nvar options = {\n    url: 'https://api.chatwork.com/v1/rooms/'+room_id+'/messages?force=0', //force\u306e\u5024\u3092\u5909\u66f4\n    headers: {\n        'X-ChatWorkToken': 'API\u30ad\u30fc'\n    },\n    json: true\n};\n\nfunction getMes(cb){\n    request.get(options, function (error, response, body) {\n        if (!error && response.statusCode == 200) {\n            cb(body);\n        }else{\n            console.log('error: '+ response.statusCode);\n            cb(false);\n        }\n    });\n}\n\n//5\u79d2\u306b\u4e00\u56de\u5b9f\u884c\nsetInterval(function(){\n    getMes(function(data){\n        if(!data)return;\n        console.log('check:',data);\n    });\n},5000);\n\n\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n$ node cw\n\nerror: 204\nerror: 204\ncheck: [ { message_id: 472495344,\n    account: \n     { account_id: 933649,\n       name: '\u83c5\u539f \u306e\u3073\u3059\u3051',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/381/381489.rsz.png' },\n    body: '\u3066\u3059\u3068',\n    send_time: 1417109111,\n    update_time: 0 } ]\n\n\u672a\u8aad\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u7121\u3044\u3068\u304d\u306f error: 204\u3092\u8fd4\u3057\u307e\u3059\u304c\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3059\u308b\u3068\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\n\u6295\u7a3f\u90e8\u5206\u3092\u8ffd\u52a0\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u81ea\u5206\u5b9b\u304b\u3069\u3046\u304b\n\u4f8b\u3048\u3070[To:1138752] LIG\u5b50(ligco)\u3055\u3093\\n\u3053\u3093\u3070\u3093\u308f'\u3053\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3060\u3068\ndata.body\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u898b\u3066\u81ea\u5206(BOT)\u5b9b\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u3001[To:xxxxxxxx]\u306e\u90e8\u5206\u3067\u5224\u5b9a\u3057\u3088\u3046\u3068\u3057\u307e\u3057\u305f\u304c\u3001\u7279\u5b9a\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u5bfe\u3059\u308b\u8fd4\u4fe1\u3060\u3068[rp aid=1138752 to=25970759-472498006]\u3068\u3044\u3063\u305f\u5f62\u306b\u306a\u308a\u8907\u96d1\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u3007\u3007\u3055\u3093\u3068\u3044\u3046\u90e8\u5206\u3092\u5229\u7528\u3057\u307e\u3057\u305f\u3002\n\n\u307e\u3068\u3081\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\u203b\u6025\u3044\u3067\u66f8\u3044\u305f\u306e\u3067\u5272\u3068\u96d1(\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u591a\u3044\u3068\u304b\u62bd\u8c61\u5316\u3057\u3066\u306a\u3044\u3068\u304b)\u3067\u3059\u304c\u304a\u8a31\u3057\u4e0b\u3055\u3044\n\u30aa\u30a6\u30e0\u8fd4\u3057\u306b\u3057\u3088\u3046\u3068\u601d\u3063\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u5206\u304b\u308a\u6613\u3044\u3088\u3046\u306b\u6587\u5b57\u5217\u53cd\u8ee2\u304f\u3089\u3044\u3057\u3088\u3046\u3068\u601d\u3063\u305f\u306e\u3067\u6587\u5b57\u5217\u53cd\u8ee2\u3092\u3057\u3066\u8fd4\u3057\u3066\u3044\u307e\u3059\u7b11\n\ncw.js\nvar request = require('request');\nvar room_id = '\u53d6\u5f97\u3059\u308b\u30eb\u30fc\u30e0\u306eID';\nvar options = {\n    headers: {\n        'X-ChatWorkToken': 'API\u30ad\u30fc'\n    },\n    from: [],\n    json: true\n};\n\nfunction getMes(cb){\n    options.url = 'https://api.chatwork.com/v1/rooms/'+room_id+'/messages?force=0';\n    request.get(options, function (error, response, body) {\n        if (!error && response.statusCode == 200) {\n            cb(body);\n        }else{\n            console.log('error: '+ response.statusCode);\n            cb(false);\n        }\n    });\n}\n\nfunction postMes(message, cb){\n    options.url = 'https://api.chatwork.com/v1/rooms/'+room_id+'/messages';\n    options.form = { body: message };\n    request.post(options, function (error, response, body) {\n        if (!error && response.statusCode == 200) {\n            cb(body);\n        }else{\n            console.log('error: '+ response.statusCode);\n            cb(false);\n        }\n    });\n}\n\n//var TO = '[To:1138752]';\nvar TO = 'LIG\u5b50(ligco)\u3055\u3093'; //\u540d\u524d\u306e\u90e8\u5206\u306e\u65b9\u304c\u4f7f\u3048\u308b\u304b\u3082\n\nsetInterval(function(){\n    //\u30e1\u30c3\u30bb\u30fc\u30b8\u53d6\u5f97\n    getMes(function(data){\n        if(!data)return;\n        console.log('check:',data);\n\n        //\u672a\u8aad\u30e1\u30c3\u30bb\u30fc\u30b8\u5206\u7e70\u308a\u8fd4\u3057\n        for(var i = 0, len = data.length; i < len; i++){\n            //BOT\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u5b9b\u306e\u5834\u5408\u51e6\u7406\u3092\u3059\u308b\n            if(data[i].body.indexOf(TO) != -1){\n\n                var tmp = data[i].body.split(TO);\n                var mes = tmp[1]; //[To:xxxx]\u306e\u90e8\u5206\u4ee5\u5916\u306e\u672c\u6587\n                mes = mes.split(\"\").reverse().join(\"\"); //\u672c\u6587\u53cd\u8ee2\n                //\u30e1\u30c3\u30bb\u30fc\u30b8\u6295\u7a3f\n                postMes(mes, function(data){\n                    if(!data)return;\n                    console.log(data);\n                });\n            }\n        }\n    });\n},5000);\n\n\n\u5b9f\u884c\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n\u307e\u3060\u307e\u3060\u6539\u826f\u3059\u3079\u304d\u70b9\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u305d\u308c\u3063\u307d\u3044\u3082\u306e\u304c\u51fa\u6765\u307e\u3057\u305f\u3002\n\u6700\u8fd1\u306fSlack\u3067ChatOps\u304c\u4eba\u6c17\u3067\u3059\u304c\u3001ChatWork\u3067\u3082\u540c\u3058\u69d8\u306a\u3053\u3068\u304c\u51fa\u6765\u305d\u3046\u3067\u3059\u306d\u3002\n\u4eca\u5f8cAPI\u306e\u6539\u826f\u306b\u671f\u5f85\u3067\u3059\u306d :)\n\u305d\u308c\u3067\u306f\u3002\n\n\u3084\u3063\u3068\u6765\u307e\u3057\u305f\u306d! \u5b09\u3057\u3055\u3068\u52e2\u3044\u3067\u8a18\u4e8b\u66f8\u304d\u307e\u3059w\n\n![](http://i.gyazo.com/40ca3f7bbb01f43aa1435e3f1ba03a5b.gif)\n\n\n\n## 2014\u5e7411\u670827\u65e5 \u5f85\u671b\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u4e00\u89a7\u306e\u53d6\u5f97\u7528\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u304c\u5b9f\u88c5\u3055\u308c\u307e\u3057\u305f\n\n\u5272\u3068\u9577\u3044\u9053\u306e\u308a\u3067\u3057\u305f\u306d\u7b11\n\ntwitter\u306a\u3069\u3067\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u5207\u671b\u306e\u58f0\u304c\u3042\u308a\u307e\u3057\u305f\u7b11\n![](http://i.gyazo.com/02aec6cf8b09603d1de9d1250b175800.png)\n\n\u4e2d\u306e\u4eba\u306f\u9811\u5f35\u3063\u3066\u305f\u3093\u3067\u3057\u3087\u3046\u306d :)\nhttp://developer.chatwork.com/ja/changelogs.html\n\n\u4eca\u307e\u3067\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u53d6\u5f97API\u304c\u7121\u304b\u3063\u305f\u306e\u3067Hubot+Slack\u3067\u3088\u304f\u3042\u308b`Bot\u306b\u30ea\u30d7\u30e9\u30a4\u3092\u9001\u308b\u3068\u8fd4\u4fe1\u3057\u3066\u304f\u308c\u308b`\u307f\u305f\u3044\u306a\u3053\u3068\u304c\u51fa\u6765\u306a\u304b\u3063\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u3053\u308c\u3067\u3084\u3063\u3068\u305d\u3046\u3044\u3063\u305f\u5b9f\u88c5\u3082\u51fa\u6765\u305d\u3046\u3067\u3059\u3002\n\n## \u3055\u3063\u305d\u304f\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\nhttp://developer.chatwork.com/ja/endpoint_rooms.html#GET-rooms-room_id-messages\n\n![](http://i.gyazo.com/bb88cb41c5734b396fca0585ce6b3e27.png)\n\n###\u30b5\u30f3\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\n\u3068\u308a\u3042\u3048\u305a\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u307f\u307e\u3059\u3002\n\n```\ncurl -X GET -H \"X-ChatWorkToken: \u81ea\u5206\u306eAPI\u30c8\u30fc\u30af\u30f3\" \"https://api.chatwork.com/v1/rooms/{room_id}/messages?force=0\"\n```\n\n\u3044\u3044\u611f\u3058\u306b\u8fd4\u3063\u3066\u6765\u3066\u304f\u308c\u307e\u3057\u305f\u3002\n\n### Node.js\u304b\u3089\u547c\u3073\u51fa\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u524d\u306b\u66f8\u3044\u305f\u8a18\u4e8b([Chatwork\u306e\u5b9a\u671f\u9023\u7d61\u3092\u81ea\u52d5\u5316\uff01Chatwork API\u3092\u4f7f\u3063\u3066\u696d\u52d9\u52b9\u7387\u5316\u3057\u3066\u307f\u305f\u3002](http://liginc.co.jp/web/programming/node-js/123719))\u3092\u53c2\u8003\u306b\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\n\u3068\u308a\u3042\u3048\u305aGET\u3059\u308b\u3060\u3051\u306a\u306e\u3067\u30b7\u30f3\u30d7\u30eb\u306a\u30b3\u30fc\u30c9\u3067\u3059\u306d\u3002\n\n```cw.js\nvar request = require('request');\nvar room_id = '\u53d6\u5f97\u3059\u308b\u30eb\u30fc\u30e0\u306eID';\n\nvar options = {\n    url: 'https://api.chatwork.com/v1/rooms/'+room_id+'/messages?force=1',\n    headers: {\n        'X-ChatWorkToken': 'API\u30ad\u30fc'\n    },\n    json: true\n};\n\nrequest.get(options, function (error, response, body) {\n    if (!error && response.statusCode == 200) {\n        console.log(body);\n    }else{\n        console.log('error: '+ response.statusCode);\n    }\n});\n```\n\n\u5b9f\u884c\u3057\u3066\u307f\u308b\u3002\n\n```\n$ npm i request\n$ node cw\n\n node cw                                                                                                                                            \n[ { message_id: 455021086,\n    account: \n     { account_id: 933649,\n       name: '\u83c5\u539f \u306e\u3073\u3059\u3051',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/381/381489.rsz.png' },\n    body: '[info][title][dtext:chatroom_groupchat_created][/title][dtext:chatroom_chatname_is]\u30de\u30b7\u30e5\u30de\u30ed\u738b\u56fd[dtext:chatroom_set]\\n\\n[dtext:chatroom_member_is][piconname:768003],[piconname:933649],[piconname:1090960][dtext:chatroom_added][/info]',\n    send_time: 1415621317,\n    update_time: 0 },\n  { message_id: 455021936,\n    account: \n     { account_id: 1090960,\n       name: '\u4e2d\u6751 \u5927\u9a0e(\u307e\u308dC)',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/509/509281.rsz.jpg' },\n    body: '\u5916\u90e8\u5411\u3051\u306b\u3042\u306a\u305f\u3060\u3051\u306e\u30ab\u30e1\u30e9\u30a2\u30d7\u30ea\u8b1b\u5ea7\u3092\u958b\u3044\u3066\u307f\u305f\u3044',\n    send_time: 1415621378,\n    update_time: 1415621476 },\n  { message_id: 455023372,\n    account: \n     { account_id: 933649,\n       name: '\u83c5\u539f \u306e\u3073\u3059\u3051',\n\u30fb\n\u30fb\n\u30fb\n\u30fb\n```\n\n\u304a\u304a\u304a\u3002\u53d6\u5f97\u51fa\u6765\u307e\u3057\u305f\u306d!\n\n##\u30c7\u30fc\u30bf\u3092\u5c11\u3057\u307f\u3066\u307f\u308b\n\n![](http://i.gyazo.com/8e25dc173c63e9462af9450f7e051fbe.png)\n\n\u3053\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3084\u308a\u53d6\u308a\u306ejson\u30c7\u30fc\u30bf\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u2193\n\n```\n{ message_id: 472495511,\n    account: \n     { account_id: 768003,\n       name: '\u698e\u672c \u9e97',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/563/563430.rsz.jpg' },\n    body: 'hoge hoge,',\n    send_time: 1417109200,\n    update_time: 0 },\n  { message_id: 472495614,\n    account: \n     { account_id: 768003,\n       name: '\u698e\u672c \u9e97',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/563/563430.rsz.jpg' },\n    body: '[To:933649] \u83c5\u539f \u306e\u3073\u3059\u3051\u3055\u3093\\n\\n\u306e\u3073\u3059\u3051\u3055\u3093\\n\u30ea\u30b9\u3068\u8868\u793a\u3092\u6a2a\u4e26\u3073\u306b\u3059\u308bcss\u304c\u3046\u307e\u304f\u53cd\u6620\u3055\u308c\u306a\u3044\u306e\u3067\u3059\u304c\u4f55\u6545\u3067\u3057\u3087\u3046\u2026',\n    send_time: 1417109244,\n    update_time: 0 },\n  { message_id: 472495664,\n    account: \n     { account_id: 933649,\n       name: '\u83c5\u539f \u306e\u3073\u3059\u3051',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/381/381489.rsz.png' },\n    body: '\u30ea\u30b9',\n    send_time: 1417109271,\n    update_time: 0 },\n  { message_id: 4724956\n\n```\n\n\u500b\u4eba\u7684\u306a\u611f\u60f3\u3067\u3059\u3051\u3069\u3001 \u8ab0\u304b\u5b9b\u306e\u6295\u7a3f[To:xxxx]\u306e\u5834\u5408\u3092\u8b58\u5225\u3059\u308b\u30d5\u30e9\u30b0\u304c\u3042\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u306d\u3002\n\n##\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u30ab\u30f3\u30bf\u30f3\u306a\u30aa\u30a6\u30e0\u8fd4\u3057BOT\u3092\u4f5c\u3063\u3066\u307f\u305f\n\nchatwork\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u76e3\u8996\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u30675\u79d2\u306b\u4e00\u56de\u30c1\u30a7\u30c3\u30af\u3059\u308b\u611f\u3058\u306b\u3057\u3066\u307f\u307e\u3059\u3002\n\nAPI\u306e\u5229\u7528\u5236\u9650\u306f\u73fe\u6642\u70b9\u3067`5\u5206\u3042\u305f\u308a100\u56de\u307e\u3067`\u3089\u3057\u3044\u306e\u30675\u79d21\u56de\u304f\u3089\u3044\u306a\u5927\u4e08\u592b\u304b\u306a\u3002\n\nhttp://developer.chatwork.com/ja/endpoints.html\n\n### force=0\u3067\u5dee\u5206\u3092\u53d6\u5f97\u51fa\u6765\u307e\u3059\u3002\nmessage\u306eAPI\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306eforce\u306e\u5024\u30920\u306b\u3059\u308c\u3070\u5dee\u5206\u3060\u3051\u53d6\u308c\u307e\u3059\u3002\n1\u3060\u3068\u6700\u65b0100\u4ef6\u3089\u3057\u3044\u3067\u3059\u3002\n\n### \u307e\u305a\u306f\u76e3\u8996\u90e8\u5206\u3092\u4f5c\u308a\u307e\u3059\n\n```cw.js\nvar request = require('request');\nvar room_id = '\u53d6\u5f97\u3059\u308b\u30eb\u30fc\u30e0\u306eID';\n\nvar options = {\n    url: 'https://api.chatwork.com/v1/rooms/'+room_id+'/messages?force=0', //force\u306e\u5024\u3092\u5909\u66f4\n    headers: {\n        'X-ChatWorkToken': 'API\u30ad\u30fc'\n    },\n    json: true\n};\n\nfunction getMes(cb){\n    request.get(options, function (error, response, body) {\n        if (!error && response.statusCode == 200) {\n            cb(body);\n        }else{\n            console.log('error: '+ response.statusCode);\n            cb(false);\n        }\n    });\n}\n\n//5\u79d2\u306b\u4e00\u56de\u5b9f\u884c\nsetInterval(function(){\n    getMes(function(data){\n        if(!data)return;\n        console.log('check:',data);\n    });\n},5000);\n\n```\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$ node cw\n\nerror: 204\nerror: 204\ncheck: [ { message_id: 472495344,\n    account: \n     { account_id: 933649,\n       name: '\u83c5\u539f \u306e\u3073\u3059\u3051',\n       avatar_image_url: 'https://tky-chat-work-appdata.s3.amazonaws.com/avatar/381/381489.rsz.png' },\n    body: '\u3066\u3059\u3068',\n    send_time: 1417109111,\n    update_time: 0 } ]\n```\n\n\u672a\u8aad\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u7121\u3044\u3068\u304d\u306f `error: 204`\u3092\u8fd4\u3057\u307e\u3059\u304c\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3059\u308b\u3068\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n![](http://i.gyazo.com/f1c8adfa3e2334412b0c79d734e5eb60.gif)\n\n### \u6295\u7a3f\u90e8\u5206\u3092\u8ffd\u52a0\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\n\n####\u81ea\u5206\u5b9b\u304b\u3069\u3046\u304b\n\n\u4f8b\u3048\u3070`[To:1138752] LIG\u5b50(ligco)\u3055\u3093\\n\u3053\u3093\u3070\u3093\u308f'`\u3053\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3060\u3068\ndata.body\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u898b\u3066\u81ea\u5206(BOT)\u5b9b\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3060\u3063\u305f\u306e\u3067\u3001`[To:xxxxxxxx]`\u306e\u90e8\u5206\u3067\u5224\u5b9a\u3057\u3088\u3046\u3068\u3057\u307e\u3057\u305f\u304c\u3001\u7279\u5b9a\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u5bfe\u3059\u308b\u8fd4\u4fe1\u3060\u3068`[rp aid=1138752 to=25970759-472498006]`\u3068\u3044\u3063\u305f\u5f62\u306b\u306a\u308a\u8907\u96d1\u305d\u3046\u3060\u3063\u305f\u306e\u3067`\u3007\u3007\u3055\u3093`\u3068\u3044\u3046\u90e8\u5206\u3092\u5229\u7528\u3057\u307e\u3057\u305f\u3002\n\n####\u307e\u3068\u3081\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n\u203b\u6025\u3044\u3067\u66f8\u3044\u305f\u306e\u3067\u5272\u3068\u96d1(\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u591a\u3044\u3068\u304b\u62bd\u8c61\u5316\u3057\u3066\u306a\u3044\u3068\u304b)\u3067\u3059\u304c\u304a\u8a31\u3057\u4e0b\u3055\u3044\n\n\u30aa\u30a6\u30e0\u8fd4\u3057\u306b\u3057\u3088\u3046\u3068\u601d\u3063\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u5206\u304b\u308a\u6613\u3044\u3088\u3046\u306b\u6587\u5b57\u5217\u53cd\u8ee2\u304f\u3089\u3044\u3057\u3088\u3046\u3068\u601d\u3063\u305f\u306e\u3067\u6587\u5b57\u5217\u53cd\u8ee2\u3092\u3057\u3066\u8fd4\u3057\u3066\u3044\u307e\u3059\u7b11\n\n```cw.js\nvar request = require('request');\nvar room_id = '\u53d6\u5f97\u3059\u308b\u30eb\u30fc\u30e0\u306eID';\nvar options = {\n    headers: {\n        'X-ChatWorkToken': 'API\u30ad\u30fc'\n    },\n    from: [],\n    json: true\n};\n\nfunction getMes(cb){\n    options.url = 'https://api.chatwork.com/v1/rooms/'+room_id+'/messages?force=0';\n    request.get(options, function (error, response, body) {\n        if (!error && response.statusCode == 200) {\n            cb(body);\n        }else{\n            console.log('error: '+ response.statusCode);\n            cb(false);\n        }\n    });\n}\n\nfunction postMes(message, cb){\n    options.url = 'https://api.chatwork.com/v1/rooms/'+room_id+'/messages';\n    options.form = { body: message };\n    request.post(options, function (error, response, body) {\n        if (!error && response.statusCode == 200) {\n            cb(body);\n        }else{\n            console.log('error: '+ response.statusCode);\n            cb(false);\n        }\n    });\n}\n\n//var TO = '[To:1138752]';\nvar TO = 'LIG\u5b50(ligco)\u3055\u3093'; //\u540d\u524d\u306e\u90e8\u5206\u306e\u65b9\u304c\u4f7f\u3048\u308b\u304b\u3082\n\nsetInterval(function(){\n\t//\u30e1\u30c3\u30bb\u30fc\u30b8\u53d6\u5f97\n    getMes(function(data){\n        if(!data)return;\n        console.log('check:',data);\n\n        //\u672a\u8aad\u30e1\u30c3\u30bb\u30fc\u30b8\u5206\u7e70\u308a\u8fd4\u3057\n        for(var i = 0, len = data.length; i < len; i++){\n            //BOT\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u5b9b\u306e\u5834\u5408\u51e6\u7406\u3092\u3059\u308b\n            if(data[i].body.indexOf(TO) != -1){\n\n                var tmp = data[i].body.split(TO);\n                var mes = tmp[1]; //[To:xxxx]\u306e\u90e8\u5206\u4ee5\u5916\u306e\u672c\u6587\n                mes = mes.split(\"\").reverse().join(\"\"); //\u672c\u6587\u53cd\u8ee2\n                //\u30e1\u30c3\u30bb\u30fc\u30b8\u6295\u7a3f\n                postMes(mes, function(data){\n                    if(!data)return;\n                    console.log(data);\n                });\n            }\n        }\n    });\n},5000);\n```\n\n\u5b9f\u884c\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n![](http://i.gyazo.com/40ca3f7bbb01f43aa1435e3f1ba03a5b.gif)\n\n\u307e\u3060\u307e\u3060\u6539\u826f\u3059\u3079\u304d\u70b9\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u305d\u308c\u3063\u307d\u3044\u3082\u306e\u304c\u51fa\u6765\u307e\u3057\u305f\u3002\n\n\u6700\u8fd1\u306fSlack\u3067ChatOps\u304c\u4eba\u6c17\u3067\u3059\u304c\u3001ChatWork\u3067\u3082\u540c\u3058\u69d8\u306a\u3053\u3068\u304c\u51fa\u6765\u305d\u3046\u3067\u3059\u306d\u3002\n\n\u4eca\u5f8cAPI\u306e\u6539\u826f\u306b\u671f\u5f85\u3067\u3059\u306d :)\n\n\u305d\u308c\u3067\u306f\u3002\n", "tags": ["chatwork", "Node.js", "ChatOps", "JavaScript"]}