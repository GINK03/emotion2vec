{"context": "\n\nnginx\u3067\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u898b\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\ndefault.conf\u8fba\u308a\u306bserver\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3092\u4f75\u8a18\u3002\n\n/etc/nginx/conf.d/default.conf\nserver {\n    listen 80;\n    server_name localhost;\n    location /nginx_status {\n        stub_status on;\n        access_log off;\n        allow 127.0.0.1;\n        deny all;\n    }\n}\n\n\nnginx\u306e\u518d\u8d77\u52d5\u3002\n$ sudo service nginx restate\n\n\nlocalhost\u304c\u5ba3\u8a00\u3055\u308c\u3066\u3044\u305f\u5834\u5408\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u5834\u5408\u3002\nnginx: [warn] conflicting server name \"localhost\" on 0.0.0.0:80, ignored\nnginx \u3092\u505c\u6b62\u4e2d:                                            [  OK  ]\nnginx \u3092\u8d77\u52d5\u4e2d: nginx: [warn] conflicting server name \"localhost\" on 0.0.0.0:\n\n/nginx_status\u3060\u3051\u8a18\u8f09\u3002\n\n/etc/nginx/conf.d/default.conf\n    location /nginx_status {\n        stub_status on;\n        access_log off;\n        allow 127.0.0.1;\n        deny all;\n    }\n\n\n\n\u52d5\u4f5c\u8a66\u9a13\n\u52d5\u3044\u3066\u3044\u308b\u304b\u8a66\u9a13\u3002\n$ curl http://localhost/nginx_status\nActive connections: 707\nserver accepts handled requests\n 4155 4155 8582\nReading: 0 Writing: 7 Waiting: 700\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u6709\u52b9\u5316\u3002\n$ cd /etc/munin/plugins\n$ sudo ln -s /usr/share/munin/plugins/nginx_request ./\n$ sudo ln -s /usr/share/munin/plugins/nginx_status ./\n\nmunis-node\u306e\u518d\u8d77\u52d5\u3002\n$ sudo service munis-node restart\n\n\u76e3\u8996\u5143\u30db\u30b9\u30c8\u304b\u3089\u78ba\u8a8d\u3002\n$ telnet muninnode.example.com 4949\nTrying xxx.xxx.xxx.xxx...\nConnected to muninnode.example.com.\nEscape character is '^]'.\n# munin node at localhost.localdomain\nfetch nginx_request\nrequest.value 20956\nfetch nginx_status\ntotal.value 649\nreading.value 0\nwriting.value 8\n\n\u5b8c\u4e86\uff01\n# nginx\u3067\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u898b\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\ndefault.conf\u8fba\u308a\u306bserver\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3092\u4f75\u8a18\u3002\n\n```conf:/etc/nginx/conf.d/default.conf\nserver {\n    listen 80;\n    server_name localhost;\n    location /nginx_status {\n        stub_status on;\n        access_log off;\n        allow 127.0.0.1;\n        deny all;\n    }\n}\n```\n\nnginx\u306e\u518d\u8d77\u52d5\u3002\n\n```bash\n$ sudo service nginx restate\n```\n\n# localhost\u304c\u5ba3\u8a00\u3055\u308c\u3066\u3044\u305f\u5834\u5408\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u5834\u5408\u3002\n\n```\nnginx: [warn] conflicting server name \"localhost\" on 0.0.0.0:80, ignored\nnginx \u3092\u505c\u6b62\u4e2d:                                            [  OK  ]\nnginx \u3092\u8d77\u52d5\u4e2d: nginx: [warn] conflicting server name \"localhost\" on 0.0.0.0:\n```\n\n/nginx_status\u3060\u3051\u8a18\u8f09\u3002\n\n```conf:/etc/nginx/conf.d/default.conf\n    location /nginx_status {\n        stub_status on;\n        access_log off;\n        allow 127.0.0.1;\n        deny all;\n    }\n```\n\n# \u52d5\u4f5c\u8a66\u9a13\n\n\u52d5\u3044\u3066\u3044\u308b\u304b\u8a66\u9a13\u3002\n\n```bash\n$ curl http://localhost/nginx_status\nActive connections: 707\nserver accepts handled requests\n 4155 4155 8582\nReading: 0 Writing: 7 Waiting: 700\n```\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u6709\u52b9\u5316\u3002\n\n```bash\n$ cd /etc/munin/plugins\n$ sudo ln -s /usr/share/munin/plugins/nginx_request ./\n$ sudo ln -s /usr/share/munin/plugins/nginx_status ./\n```\n\nmunis-node\u306e\u518d\u8d77\u52d5\u3002\n\n```bash\n$ sudo service munis-node restart\n```\n\n\u76e3\u8996\u5143\u30db\u30b9\u30c8\u304b\u3089\u78ba\u8a8d\u3002\n\n```bash\n$ telnet muninnode.example.com 4949\nTrying xxx.xxx.xxx.xxx...\nConnected to muninnode.example.com.\nEscape character is '^]'.\n# munin node at localhost.localdomain\nfetch nginx_request\nrequest.value 20956\nfetch nginx_status\ntotal.value 649\nreading.value 0\nwriting.value 8\n```\n\n\u5b8c\u4e86\uff01\n", "tags": ["nginx", "Munin"]}