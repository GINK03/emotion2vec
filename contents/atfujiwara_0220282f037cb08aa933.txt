{"context": "\u5148\u65e5\u3001InfluxDB v1.2\u304c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u3001\u30b5\u30d6\u30af\u30a8\u30ea\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u65e9\u901f\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nInfluxDB 1.2 released with subqueries and 50% better write throughput on larger hardware\n\n\u30b5\u30d6\u30af\u30a8\u30ea\u3068\u306f\nv1.1\u307e\u3067\u306eInfluxDB\u3067\u306f\u3001SQL\u30e9\u30a4\u30af\u306b\u8907\u6570\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u5024\u3092\u8a08\u7b97\u3067\u304d\u308b\u3082\u306e\u306e\u3001\u96c6\u8a08\u95a2\u6570\u306e\u4e2d\u306b\u306f\u5358\u4e00\u306e\u5024\u3057\u304b\u66f8\u304f\u3053\u3068\u304c\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u3002\no select value1 * 100 from ... # OK\n\nx select mean(value1 * 100) from ... \u3000   # \u95a2\u6570\u306e\u4e2d\u306b\u306f\u8a08\u7b97\u5f0f\u3092\u66f8\u3051\u306a\u3044\no select mean(value1) * 100 from ... \u3000   # \u3053\u308c\u306fOK\n\nx select mean(value1 * value2) from ...\no select mean(value1) * mean(value2) from ... # \u95a2\u6570\u306e\u7d50\u679c\u3092\u8a08\u7b97\u306f\u3067\u304d\u308b\u304c\u3084\u308a\u305f\u3044\u306e\u306f\u30b3\u30ec\u30b8\u30e3\u30ca\u30a4\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306a\u8a08\u7b97\u3092\u884c\u3046\u5834\u5408\u3001\u5f93\u6765\u306f(value1 * value2)\u306e\u30af\u30a8\u30ea\u306e\u8a08\u7b97\u7d50\u679c\u3092\u4e00\u65e6measurement\u3068\u3057\u3066\u4fdd\u5b58\u3057\u3001\u305d\u306e\u7d50\u679c\u306b\u5bfe\u3057\u3066\u518d\u5ea6\u30af\u30a8\u30ea\u3092\u304b\u3051\u3066\u5e73\u5747\u3092\u53d6\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3092\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u3057\u304b\u3057v1.2\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u305f\u30b5\u30d6\u30af\u30a8\u30ea\u3092\u4f7f\u3046\u3068\u3001\u540c\u7b49\u306e\u3053\u3068\u304c1\u56de\u306e\u30af\u30a8\u30ea\u3067\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\nselect mean(value) from (select value1 * value2 from ...)\n\n\n\u4f7f\u7528\u4f8b\u305d\u306e1: \u52a0\u91cd\u5e73\u5747\n\u307e\u305a\u306f\u4e0a\u8a18\u3067\u4f8b\u306b\u6319\u3052\u305f\u3088\u3046\u306a\u52a0\u91cd\u5e73\u5747\u3092\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u306f\u4e0b\u8a18\u306e\u3068\u304a\u308a\u3002(\u8868\u793a\u3092\u898b\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u3001precision rfc3339\u3068\u3057\u3066\u3044\u307e\u3059)\n> select * from sample_data\nname: sample_data\ntime       count host  value\n----       ----- ----  -----\n2017-01-26T00:00:00Z 33    host1 0.1686618\n2017-01-26T00:00:00Z 10    host2 0.772844364\n2017-01-26T00:01:00Z 60    host1 0.025078533\n2017-01-26T00:01:00Z 86    host2 0.589876001\n2017-01-26T00:02:00Z 28    host1 0.795133127\n2017-01-26T00:02:00Z 41    host2 0.801407917\n2017-01-26T00:03:00Z 91    host1 0.081822447\n2017-01-26T00:03:00Z 90    host2 0.765902936\n2017-01-26T00:04:00Z 61    host1 0.51287518\n2017-01-26T00:04:00Z 38    host2 0.53270741\n2017-01-26T00:05:00Z 51    host1 0.060094054\n2017-01-26T00:05:00Z 79    host2 0.128055132\n2017-01-26T00:06:00Z 72    host1 0.190071427\n2017-01-26T00:06:00Z 35    host2 0.005363927\n2017-01-26T00:07:00Z 25    host1 0.211173586\n2017-01-26T00:07:00Z 61    host2 0.194961101\n2017-01-26T00:08:00Z 41    host1 0.211522929\n2017-01-26T00:08:00Z 16    host2 0.022634187\n2017-01-26T00:09:00Z 75    host1 0.131138756\n2017-01-26T00:09:00Z 89    host2 0.819108491\n\ncount\u3092\u3001\u5404value\u306b\u5bfe\u3059\u308b\u91cd\u307f\u5024\u3068\u3059\u308b\u3068\u3001\u91cd\u307f\u4ed8\u3051\u3057\u305f\u5024(value * count)\u306f\u554f\u984c\u306a\u304f\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n> select host, value * count as weighed_value from sample_data\nname: sample_data\ntime                 host  weighed_value\n----                 ----  -------------\n2017-01-26T00:00:00Z host1 5.5658394\n2017-01-26T00:00:00Z host2 7.72844364\n2017-01-26T00:01:00Z host1 1.50471198\n2017-01-26T00:01:00Z host2 50.729336086\n2017-01-26T00:02:00Z host1 22.263727556000003\n2017-01-26T00:02:00Z host2 32.857724597\n2017-01-26T00:03:00Z host1 7.445842677000001\n2017-01-26T00:03:00Z host2 68.93126424\n2017-01-26T00:04:00Z host1 31.28538598\n2017-01-26T00:04:00Z host2 20.24288158\n2017-01-26T00:05:00Z host1 3.064796754\n2017-01-26T00:05:00Z host2 10.116355427999999\n2017-01-26T00:06:00Z host1 13.685142743999998\n2017-01-26T00:06:00Z host2 0.187737445\n2017-01-26T00:07:00Z host1 5.27933965\n2017-01-26T00:07:00Z host2 11.892627161\n2017-01-26T00:08:00Z host1 8.672440089\n2017-01-26T00:08:00Z host2 0.362146992\n2017-01-26T00:09:00Z host1 9.8354067\n2017-01-26T00:09:00Z host2 72.900655699\n\n\u3053\u3053\u304b\u3089\u3001\u5404\u6642\u523b\u306b\u304a\u3051\u308b\u5168\u30db\u30b9\u30c8\u9593\u306e\u5e73\u5747\u5024\u306f\u3001\u5143\u306e\u30af\u30a8\u30ea\u3092from\u53e5\u306b\u3044\u308c\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n> select mean(*) from (select host, value * count as weighed_value from sample_data) where time >= '2017-01-26T00:00:00Z' and time < '2017-01-26T00:10:00Z' group by time(1m)\nname: sample_data\ntime                 mean_weighed_value\n----                 ------------------\n2017-01-26T00:00:00Z 6.64714152\n2017-01-26T00:01:00Z 26.117024033000003\n2017-01-26T00:02:00Z 27.560726076500004\n2017-01-26T00:03:00Z 38.1885534585\n2017-01-26T00:04:00Z 25.76413378\n2017-01-26T00:05:00Z 6.590576090999999\n2017-01-26T00:06:00Z 6.936440094499999\n2017-01-26T00:07:00Z 8.5859834055\n2017-01-26T00:08:00Z 4.5172935405\n2017-01-26T00:09:00Z 41.368031199499995\n\n\u305d\u308c\u305e\u308c\u306e\u6642\u523b\u306b\u304a\u3044\u3066\u3001host1\u3068host2\u306e\u5e73\u5747\u5024\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u5404\u30db\u30b9\u30c8\u6bce\u306b10\u5206\u9593\u306e\u5e73\u5747\u5024\u3082\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3057\u3066\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n> select mean(*) from (select host, value * count as weighed_value from sample_data) where time >= '2017-01-26T00:00:00Z' and time < '2017-01-26T00:10:00Z' group by time(10m),host\nname: sample_data\ntags: host=host1\ntime                 mean_new_value\n----                 --------------\n2017-01-26T00:00:00Z 10.860263353000002\n\nname: sample_data\ntags: host=host2\ntime                 mean_new_value\n----                 --------------\n2017-01-26T00:00:00Z 27.5949172868\n\n\n\u4f7f\u7528\u4f8b\u305d\u306e2: \u7d2f\u7a4d\u5024\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u7b49\u3092SNMP\u3067\u53d6\u5f97\u3059\u308b\u3068\u7d2f\u7a4d\u5024\u3068\u3057\u3066\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3059\u304c\u3001\u3053\u308c\u3082InfluxDB\u3067\u306f\u6271\u3044\u3065\u3089\u3044\u30c7\u30fc\u30bf\u3067\u3057\u305f\u3002\n> select * from sample_data\nname: sample_data\ntime                 host  value\n----                 ----  -----\n2017-01-25T23:59:00Z host1 0\n2017-01-25T23:59:00Z host2 0\n2017-01-26T00:00:00Z host1 0.380175335\n2017-01-26T00:00:00Z host2 0.654674526\n2017-01-26T00:01:00Z host1 0.548469287\n2017-01-26T00:01:00Z host2 1.518483451\n2017-01-26T00:02:00Z host1 0.912088251\n2017-01-26T00:02:00Z host2 1.618768565\n2017-01-26T00:03:00Z host1 1.024910481\n2017-01-26T00:03:00Z host2 1.661952017\n2017-01-26T00:04:00Z host1 1.194558728\n2017-01-26T00:04:00Z host2 2.532767878\n2017-01-26T00:05:00Z host1 1.518409392\n2017-01-26T00:05:00Z host2 3.402324839\n2017-01-26T00:06:00Z host1 1.603926464\n2017-01-26T00:06:00Z host2 4.058450398\n2017-01-26T00:07:00Z host1 2.06296154\n2017-01-26T00:07:00Z host2 4.794882977\n2017-01-26T00:08:00Z host1 2.408185365\n2017-01-26T00:08:00Z host2 4.902904745\n2017-01-26T00:09:00Z host1 3.351145834\n2017-01-26T00:09:00Z host2 4.915808337\n\nderivative\u95a2\u6570\u3092\u4f7f\u3046\u3068\u5dee\u5206\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\u304c\u3001\u305d\u306e\u7d50\u679c\u3092\u3055\u3089\u306b\u96c6\u8a08\u3059\u308b\u3001\u3068\u3044\u3046\u4e8b\u304c\u5f93\u6765\u306f\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n> select derivative(value,1m) from sample_data group by host\nname: sample_data\ntags: host=host1\ntime                 derivative\n----                 ----------\n2017-01-26T00:00:00Z 0.380175335\n2017-01-26T00:01:00Z 0.16829395199999997\n2017-01-26T00:02:00Z 0.36361896400000004\n2017-01-26T00:03:00Z 0.11282223000000002\n2017-01-26T00:04:00Z 0.16964824700000003\n2017-01-26T00:05:00Z 0.32385066399999984\n2017-01-26T00:06:00Z 0.08551707200000003\n2017-01-26T00:07:00Z 0.45903507599999993\n2017-01-26T00:08:00Z 0.34522382500000015\n2017-01-26T00:09:00Z 0.942960469\n\nname: sample_data\ntags: host=host2\ntime                 derivative\n----                 ----------\n2017-01-26T00:00:00Z 0.654674526\n2017-01-26T00:01:00Z 0.8638089250000001\n2017-01-26T00:02:00Z 0.10028511400000006\n2017-01-26T00:03:00Z 0.043183451999999845\n2017-01-26T00:04:00Z 0.8708158610000001\n2017-01-26T00:05:00Z 0.8695569609999998\n2017-01-26T00:06:00Z 0.6561255589999999\n2017-01-26T00:07:00Z 0.7364325790000006\n2017-01-26T00:08:00Z 0.10802176799999952\n2017-01-26T00:09:00Z 0.012903591999999797\n\n\u8907\u6570\u30db\u30b9\u30c8\u304c\u3042\u308b\u4e2d\u3067\u3001\u6700\u5927\u3001\u6700\u5c0f\u306e\u5024\u3092\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u3001\u30b5\u30d6\u30af\u30a8\u30ea\u3092\u4f7f\u3046\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304f\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n> select max(derivative) as max, min(derivative) as min from (select derivative(value,1m) from sample_data group by host) where time >= '2017-01-26T00:00:00Z' and time < '2017-01-27T00:00:00Z' group by time(1m) fill(none)\nname: sample_data\ntime                 max                 min\n----                 ---                 ---\n2017-01-26T00:00:00Z 0.654674526         0.380175335\n2017-01-26T00:01:00Z 0.8638089250000001  0.16829395199999997\n2017-01-26T00:02:00Z 0.36361896400000004 0.10028511400000006\n2017-01-26T00:03:00Z 0.11282223000000002 0.043183451999999845\n2017-01-26T00:04:00Z 0.8708158610000001  0.16964824700000003\n2017-01-26T00:05:00Z 0.8695569609999998  0.32385066399999984\n2017-01-26T00:06:00Z 0.6561255589999999  0.08551707200000003\n2017-01-26T00:07:00Z 0.7364325790000006  0.45903507599999993\n2017-01-26T00:08:00Z 0.34522382500000015 0.10802176799999952\n2017-01-26T00:09:00Z 0.942960469         0.012903591999999797\n\n\u307e\u305f\u3001\u5404\u30db\u30b9\u30c8\u6bce\u306b\u300110\u5206\u9593\u306e\u6700\u5927\u5024\u3001\u6700\u5c0f\u5024\u3082\u53d6\u5f97\u53ef\u80fd\u3067\u3059\u3002\n> select max(derivative) as max, min(derivative) as min from (select derivative(value,1m) from sample_data group by host) where time >= '2017-01-26T00:00:00Z' and time < '2017-01-27T00:00:00Z' group by time(10m),host fill(none)\nname: sample_data\ntags: host=host1\ntime                 max         min\n----                 ---         ---\n2017-01-26T00:00:00Z 0.942960469 0.08551707200000003\n\nname: sample_data\ntags: host=host2\ntime                 max                min\n----                 ---                ---\n2017-01-26T00:00:00Z 0.8708158610000001 0.012903591999999797\n\n\u5148\u65e5\u3001InfluxDB v1.2\u304c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u3001\u30b5\u30d6\u30af\u30a8\u30ea\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u65e9\u901f\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n[InfluxDB 1.2 released with subqueries and 50% better write throughput on larger hardware]\n(https://www.influxdata.com/influxdb-1-2-released-with-subqueries-and-50-better-write-performance-on-larger-hardware/)\n\n# \u30b5\u30d6\u30af\u30a8\u30ea\u3068\u306f\n\nv1.1\u307e\u3067\u306eInfluxDB\u3067\u306f\u3001SQL\u30e9\u30a4\u30af\u306b\u8907\u6570\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u5024\u3092\u8a08\u7b97\u3067\u304d\u308b\u3082\u306e\u306e\u3001\u96c6\u8a08\u95a2\u6570\u306e\u4e2d\u306b\u306f\u5358\u4e00\u306e\u5024\u3057\u304b\u66f8\u304f\u3053\u3068\u304c\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n```\no select value1 * 100 from ... # OK\n\nx select mean(value1 * 100) from ... \u3000   # \u95a2\u6570\u306e\u4e2d\u306b\u306f\u8a08\u7b97\u5f0f\u3092\u66f8\u3051\u306a\u3044\no select mean(value1) * 100 from ... \u3000   # \u3053\u308c\u306fOK\n\nx select mean(value1 * value2) from ...\no select mean(value1) * mean(value2) from ... # \u95a2\u6570\u306e\u7d50\u679c\u3092\u8a08\u7b97\u306f\u3067\u304d\u308b\u304c\u3084\u308a\u305f\u3044\u306e\u306f\u30b3\u30ec\u30b8\u30e3\u30ca\u30a4\n```\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306a\u8a08\u7b97\u3092\u884c\u3046\u5834\u5408\u3001\u5f93\u6765\u306f`(value1 * value2)`\u306e\u30af\u30a8\u30ea\u306e\u8a08\u7b97\u7d50\u679c\u3092\u4e00\u65e6measurement\u3068\u3057\u3066\u4fdd\u5b58\u3057\u3001\u305d\u306e\u7d50\u679c\u306b\u5bfe\u3057\u3066\u518d\u5ea6\u30af\u30a8\u30ea\u3092\u304b\u3051\u3066\u5e73\u5747\u3092\u53d6\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3092\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u3057\u304b\u3057v1.2\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u305f\u30b5\u30d6\u30af\u30a8\u30ea\u3092\u4f7f\u3046\u3068\u3001\u540c\u7b49\u306e\u3053\u3068\u304c1\u56de\u306e\u30af\u30a8\u30ea\u3067\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\nselect mean(value) from (select value1 * value2 from ...)\n```\n\n# \u4f7f\u7528\u4f8b\u305d\u306e1: \u52a0\u91cd\u5e73\u5747\n\u307e\u305a\u306f\u4e0a\u8a18\u3067\u4f8b\u306b\u6319\u3052\u305f\u3088\u3046\u306a\u52a0\u91cd\u5e73\u5747\u3092\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u306f\u4e0b\u8a18\u306e\u3068\u304a\u308a\u3002(\u8868\u793a\u3092\u898b\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u3001`precision rfc3339`\u3068\u3057\u3066\u3044\u307e\u3059)\n\n```\n> select * from sample_data\nname: sample_data\ntime       count host  value\n----       ----- ----  -----\n2017-01-26T00:00:00Z 33    host1 0.1686618\n2017-01-26T00:00:00Z 10    host2 0.772844364\n2017-01-26T00:01:00Z 60    host1 0.025078533\n2017-01-26T00:01:00Z 86    host2 0.589876001\n2017-01-26T00:02:00Z 28    host1 0.795133127\n2017-01-26T00:02:00Z 41    host2 0.801407917\n2017-01-26T00:03:00Z 91    host1 0.081822447\n2017-01-26T00:03:00Z 90    host2 0.765902936\n2017-01-26T00:04:00Z 61    host1 0.51287518\n2017-01-26T00:04:00Z 38    host2 0.53270741\n2017-01-26T00:05:00Z 51    host1 0.060094054\n2017-01-26T00:05:00Z 79    host2 0.128055132\n2017-01-26T00:06:00Z 72    host1 0.190071427\n2017-01-26T00:06:00Z 35    host2 0.005363927\n2017-01-26T00:07:00Z 25    host1 0.211173586\n2017-01-26T00:07:00Z 61    host2 0.194961101\n2017-01-26T00:08:00Z 41    host1 0.211522929\n2017-01-26T00:08:00Z 16    host2 0.022634187\n2017-01-26T00:09:00Z 75    host1 0.131138756\n2017-01-26T00:09:00Z 89    host2 0.819108491\n```\n\ncount\u3092\u3001\u5404value\u306b\u5bfe\u3059\u308b\u91cd\u307f\u5024\u3068\u3059\u308b\u3068\u3001\u91cd\u307f\u4ed8\u3051\u3057\u305f\u5024(`value * count`)\u306f\u554f\u984c\u306a\u304f\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n\n```\n> select host, value * count as weighed_value from sample_data\nname: sample_data\ntime                 host  weighed_value\n----                 ----  -------------\n2017-01-26T00:00:00Z host1 5.5658394\n2017-01-26T00:00:00Z host2 7.72844364\n2017-01-26T00:01:00Z host1 1.50471198\n2017-01-26T00:01:00Z host2 50.729336086\n2017-01-26T00:02:00Z host1 22.263727556000003\n2017-01-26T00:02:00Z host2 32.857724597\n2017-01-26T00:03:00Z host1 7.445842677000001\n2017-01-26T00:03:00Z host2 68.93126424\n2017-01-26T00:04:00Z host1 31.28538598\n2017-01-26T00:04:00Z host2 20.24288158\n2017-01-26T00:05:00Z host1 3.064796754\n2017-01-26T00:05:00Z host2 10.116355427999999\n2017-01-26T00:06:00Z host1 13.685142743999998\n2017-01-26T00:06:00Z host2 0.187737445\n2017-01-26T00:07:00Z host1 5.27933965\n2017-01-26T00:07:00Z host2 11.892627161\n2017-01-26T00:08:00Z host1 8.672440089\n2017-01-26T00:08:00Z host2 0.362146992\n2017-01-26T00:09:00Z host1 9.8354067\n2017-01-26T00:09:00Z host2 72.900655699\n```\n\n\u3053\u3053\u304b\u3089\u3001\u5404\u6642\u523b\u306b\u304a\u3051\u308b\u5168\u30db\u30b9\u30c8\u9593\u306e\u5e73\u5747\u5024\u306f\u3001\u5143\u306e\u30af\u30a8\u30ea\u3092from\u53e5\u306b\u3044\u308c\u3066\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n\n```\n> select mean(*) from (select host, value * count as weighed_value from sample_data) where time >= '2017-01-26T00:00:00Z' and time < '2017-01-26T00:10:00Z' group by time(1m)\nname: sample_data\ntime                 mean_weighed_value\n----                 ------------------\n2017-01-26T00:00:00Z 6.64714152\n2017-01-26T00:01:00Z 26.117024033000003\n2017-01-26T00:02:00Z 27.560726076500004\n2017-01-26T00:03:00Z 38.1885534585\n2017-01-26T00:04:00Z 25.76413378\n2017-01-26T00:05:00Z 6.590576090999999\n2017-01-26T00:06:00Z 6.936440094499999\n2017-01-26T00:07:00Z 8.5859834055\n2017-01-26T00:08:00Z 4.5172935405\n2017-01-26T00:09:00Z 41.368031199499995\n```\n\n\u305d\u308c\u305e\u308c\u306e\u6642\u523b\u306b\u304a\u3044\u3066\u3001host1\u3068host2\u306e\u5e73\u5747\u5024\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u5404\u30db\u30b9\u30c8\u6bce\u306b10\u5206\u9593\u306e\u5e73\u5747\u5024\u3082\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3057\u3066\u8a08\u7b97\u3067\u304d\u307e\u3059\u3002\n\n```\n> select mean(*) from (select host, value * count as weighed_value from sample_data) where time >= '2017-01-26T00:00:00Z' and time < '2017-01-26T00:10:00Z' group by time(10m),host\nname: sample_data\ntags: host=host1\ntime                 mean_new_value\n----                 --------------\n2017-01-26T00:00:00Z 10.860263353000002\n\nname: sample_data\ntags: host=host2\ntime                 mean_new_value\n----                 --------------\n2017-01-26T00:00:00Z 27.5949172868\n```\n\n# \u4f7f\u7528\u4f8b\u305d\u306e2: \u7d2f\u7a4d\u5024\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u7b49\u3092SNMP\u3067\u53d6\u5f97\u3059\u308b\u3068\u7d2f\u7a4d\u5024\u3068\u3057\u3066\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3059\u304c\u3001\u3053\u308c\u3082InfluxDB\u3067\u306f\u6271\u3044\u3065\u3089\u3044\u30c7\u30fc\u30bf\u3067\u3057\u305f\u3002\n\n```\n> select * from sample_data\nname: sample_data\ntime                 host  value\n----                 ----  -----\n2017-01-25T23:59:00Z host1 0\n2017-01-25T23:59:00Z host2 0\n2017-01-26T00:00:00Z host1 0.380175335\n2017-01-26T00:00:00Z host2 0.654674526\n2017-01-26T00:01:00Z host1 0.548469287\n2017-01-26T00:01:00Z host2 1.518483451\n2017-01-26T00:02:00Z host1 0.912088251\n2017-01-26T00:02:00Z host2 1.618768565\n2017-01-26T00:03:00Z host1 1.024910481\n2017-01-26T00:03:00Z host2 1.661952017\n2017-01-26T00:04:00Z host1 1.194558728\n2017-01-26T00:04:00Z host2 2.532767878\n2017-01-26T00:05:00Z host1 1.518409392\n2017-01-26T00:05:00Z host2 3.402324839\n2017-01-26T00:06:00Z host1 1.603926464\n2017-01-26T00:06:00Z host2 4.058450398\n2017-01-26T00:07:00Z host1 2.06296154\n2017-01-26T00:07:00Z host2 4.794882977\n2017-01-26T00:08:00Z host1 2.408185365\n2017-01-26T00:08:00Z host2 4.902904745\n2017-01-26T00:09:00Z host1 3.351145834\n2017-01-26T00:09:00Z host2 4.915808337\n```\n\n`derivative`\u95a2\u6570\u3092\u4f7f\u3046\u3068\u5dee\u5206\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\u304c\u3001\u305d\u306e\u7d50\u679c\u3092\u3055\u3089\u306b\u96c6\u8a08\u3059\u308b\u3001\u3068\u3044\u3046\u4e8b\u304c\u5f93\u6765\u306f\u51fa\u6765\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n```\n> select derivative(value,1m) from sample_data group by host\nname: sample_data\ntags: host=host1\ntime                 derivative\n----                 ----------\n2017-01-26T00:00:00Z 0.380175335\n2017-01-26T00:01:00Z 0.16829395199999997\n2017-01-26T00:02:00Z 0.36361896400000004\n2017-01-26T00:03:00Z 0.11282223000000002\n2017-01-26T00:04:00Z 0.16964824700000003\n2017-01-26T00:05:00Z 0.32385066399999984\n2017-01-26T00:06:00Z 0.08551707200000003\n2017-01-26T00:07:00Z 0.45903507599999993\n2017-01-26T00:08:00Z 0.34522382500000015\n2017-01-26T00:09:00Z 0.942960469\n\nname: sample_data\ntags: host=host2\ntime                 derivative\n----                 ----------\n2017-01-26T00:00:00Z 0.654674526\n2017-01-26T00:01:00Z 0.8638089250000001\n2017-01-26T00:02:00Z 0.10028511400000006\n2017-01-26T00:03:00Z 0.043183451999999845\n2017-01-26T00:04:00Z 0.8708158610000001\n2017-01-26T00:05:00Z 0.8695569609999998\n2017-01-26T00:06:00Z 0.6561255589999999\n2017-01-26T00:07:00Z 0.7364325790000006\n2017-01-26T00:08:00Z 0.10802176799999952\n2017-01-26T00:09:00Z 0.012903591999999797\n```\n\n\u8907\u6570\u30db\u30b9\u30c8\u304c\u3042\u308b\u4e2d\u3067\u3001\u6700\u5927\u3001\u6700\u5c0f\u306e\u5024\u3092\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u3001\u30b5\u30d6\u30af\u30a8\u30ea\u3092\u4f7f\u3046\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304f\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n```\n> select max(derivative) as max, min(derivative) as min from (select derivative(value,1m) from sample_data group by host) where time >= '2017-01-26T00:00:00Z' and time < '2017-01-27T00:00:00Z' group by time(1m) fill(none)\nname: sample_data\ntime                 max                 min\n----                 ---                 ---\n2017-01-26T00:00:00Z 0.654674526         0.380175335\n2017-01-26T00:01:00Z 0.8638089250000001  0.16829395199999997\n2017-01-26T00:02:00Z 0.36361896400000004 0.10028511400000006\n2017-01-26T00:03:00Z 0.11282223000000002 0.043183451999999845\n2017-01-26T00:04:00Z 0.8708158610000001  0.16964824700000003\n2017-01-26T00:05:00Z 0.8695569609999998  0.32385066399999984\n2017-01-26T00:06:00Z 0.6561255589999999  0.08551707200000003\n2017-01-26T00:07:00Z 0.7364325790000006  0.45903507599999993\n2017-01-26T00:08:00Z 0.34522382500000015 0.10802176799999952\n2017-01-26T00:09:00Z 0.942960469         0.012903591999999797\n```\n\n\u307e\u305f\u3001\u5404\u30db\u30b9\u30c8\u6bce\u306b\u300110\u5206\u9593\u306e\u6700\u5927\u5024\u3001\u6700\u5c0f\u5024\u3082\u53d6\u5f97\u53ef\u80fd\u3067\u3059\u3002\n\n```\n> select max(derivative) as max, min(derivative) as min from (select derivative(value,1m) from sample_data group by host) where time >= '2017-01-26T00:00:00Z' and time < '2017-01-27T00:00:00Z' group by time(10m),host fill(none)\nname: sample_data\ntags: host=host1\ntime                 max         min\n----                 ---         ---\n2017-01-26T00:00:00Z 0.942960469 0.08551707200000003\n\nname: sample_data\ntags: host=host2\ntime                 max                min\n----                 ---                ---\n2017-01-26T00:00:00Z 0.8708158610000001 0.012903591999999797\n```\n\n", "tags": ["influxdb"]}