{"context": "\n\n\u6982\u8981\nMirantis OpenStack 9.0(\u4ee5\u4e0b\u3001MOS9.0) \u4e0a\u3067\u3001LBaaS(V2) \u6a5f\u80fd\u304c\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u624b\u9806\n\nFuel LBaaS Plugin \u306e\u6e96\u5099\nMOS9.0 \u306b\u5bfe\u5fdc\u3057\u305f LBaaS Plugin \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u6e96\u5099\u3057\u307e\u3059\u3002\n\u3053\u3061\u3089\u304b\u3089\u4f5c\u6210\u6e08\u307f\u306e\u3082\u306e\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u304b\u3001\n\u4ee5\u4e0b\u306e\u624b\u9806\u306b\u5f93\u3063\u3066\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u4f5c\u6210\n\u306f\u3058\u3081\u306b\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30d3\u30eb\u30c9\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nfuel-plugin-builder \u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u3001Fuel Plugin \u306e\u30d3\u30eb\u30c9\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\n$ sudo apt-get update\n$ sudo apt-get install createrepo rpm dpkg-dev\n$ sudo apt-get install git\n\n$ sudo easy_install pip\n$ sudo pip install fuel-plugin-builder\n\n\u4f5c\u696d\u7528PC\uff08\u4eca\u56de\u306f Ubuntu \u3092\u4f7f\u7528\uff09\u306b\u63a5\u7d9a\u3057\u3001GitHub \u304b\u3089 9.0 \u30d6\u30e9\u30f3\u30c1\u306e\u30af\u30ed\u30fc\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n$ cd\n$ git clone https://github.com/openstack/fuel-plugin-neutron-lbaas\nCloning into 'fuel-plugin-neutron-lbaas'...\nremote: Counting objects: 94, done.\nremote: Compressing objects: 100% (14/14), done.\nremote: Total 94 (delta 2), reused 0 (delta 0), pack-reused 78\nUnpacking objects: 100% (94/94), done.\nChecking connectivity... done.\n\n\u30fb\u30d3\u30eb\u30c9\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n$ cd\n$ fpb --build ./fuel-plugin-neutron-lbaas/\nPlugin is built\n\nrpm \u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ ls -al ./fuel-plugin-neutron-lbaas/*.rpm\n-rw-rw-r-- 1 ubuntu ubuntu 17086 Aug 23 05:08 ./fuel-plugin-neutron-lbaas/lbaas-1.0-1.0.3-1.noarch.rpm\n\n\nFuel LBaaS Plugin \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4f5c\u6210\u3057\u305f rpm \u30d5\u30a1\u30a4\u30eb\u3092 Fuel Master \u3078\u914d\u7f6e\u3057\u305f\u5f8c\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# fuel plugins --install lbaas-1.0-1.0.3-1.noarch.rpm\nLoaded plugins: fastestmirror, priorities\nExamining lbaas-1.0-1.0.3-1.noarch.rpm: lbaas-1.0-1.0.3-1.noarch\nMarking lbaas-1.0-1.0.3-1.noarch.rpm to be installed\nResolving Dependencies\n--> Running transaction check\n---> Package lbaas-1.0.noarch 0:1.0.3-1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n=================================================================================================================================================\n Package                        Arch                        Version                         Repository                                      Size\n=================================================================================================================================================\nInstalling:\n lbaas-1.0                      noarch                      1.0.3-1                         /lbaas-1.0-1.0.3-1.noarch                       25 k\n\nTransaction Summary\n=================================================================================================================================================\nInstall  1 Package\n\nTotal size: 25 k\nInstalled size: 25 k\nDownloading packages:\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  Installing : lbaas-1.0-1.0.3-1.noarch                                                                                                      1/1\n  Verifying  : lbaas-1.0-1.0.3-1.noarch                                                                                                      1/1\n\nInstalled:\n  lbaas-1.0.noarch 0:1.0.3-1\n\nComplete!\nPlugin lbaas-1.0-1.0.3-1.noarch.rpm was successfully installed.\n\nFuel LBaaS Plugin \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u6b63\u5e38\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u3066\u3044\u308b\u5834\u5408\u3001Fuel \u30d7\u30e9\u30b0\u30a4\u30f3\u4e00\u89a7\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n# fuel plugins\nid | name  | version | package_version | releases\n---+-------+---------+-----------------+--------------------\n1  | lbaas | 1.0.3   | 3.0.0           | ubuntu (mitaka-9.0)\n\nFuel \u30b3\u30f3\u30bd\u30fc\u30eb\u306e [PLUGINS] \u30bf\u30d6\u3092\u958b\u304d\u3001\u4ee5\u4e0b\u306e\u901a\u308a\u8868\u793a\u3055\u308c\u3066\u308c\u3070\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\n\u203b MOS \u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u7b49\u3067\u5229\u7528\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u3001\u611f\u5606\u7b26(!)\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u6b63\u5e38\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\nEnvironment \u753b\u9762\u306e [Settings]-[Other] \u306b \"LBaaS plugin for Neutron\" \u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\n\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3066\u304b\u3089\u30c7\u30d7\u30ed\u30a4\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\n\n\nLBaaS \u8a2d\u5b9a\n\n\u8a2d\u5b9a\u78ba\u8a8d\nneutron.conf \u306b LBaaS \u95a2\u9023\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n# grep \"lbaas\" /etc/neutron/neutron.conf\nservice_plugins =neutron.services.l3_router.l3_router_plugin.L3RouterPlugin,neutron.services.metering.metering_plugin.MeteringPlugin,neutron_lbaas.services.loadbalancer.plugin.LoadBalancerPluginv2\nservice_provider=LOADBALANCERV2:Haproxy:neutron_lbaas.drivers.haproxy.plugin_driver.HaproxyOnHostPluginDriver:default\n\nneutron \u306e\u30b5\u30fc\u30d3\u30b9\u30d7\u30ed\u30d0\u30a4\u30c0\u3068\u3057\u3066\u3001LOADBALANCERV2\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n# neutron service-provider-list\n+----------------+---------+---------+\n| service_type   | name    | default |\n+----------------+---------+---------+\n| LOADBALANCERV2 | haproxy | True    |\n+----------------+---------+---------+\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\n\nLBaaS V2\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u8a2d\u5b9a\nLoad Balancer \u306e\u4f5c\u6210\u3092\u884c\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001private-subnet \u304b\u3089\u30a2\u30af\u30bb\u30b9\u3092\u53d7\u3051\u4ed8\u3051\u308b\u60f3\u5b9a\u3067\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n# neutron lbaas-loadbalancer-create --name lb-test private_network_subnet\n\n\u4f5c\u6210\u3057\u305f\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304c\u4ee5\u4e0b\u306e\u72b6\u614b\u3068\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\noperating_status: \"ONLINE\" \u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\nprovisioning_status: \"ACTIVE\" \u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\nvip_address: \u6307\u5b9a\u3057\u305f\u30b5\u30d6\u30cd\u30c3\u30c8\u306e IP \u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308b\u3053\u3068\n\n# neutron lbaas-loadbalancer-show lb-test\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| admin_state_up      | True                                 |\n| description         |                                      |\n| id                  | 2e9bdc22-a12b-400c-b9c2-7d11aca04ba8 |\n| listeners           |                                      |\n| name                | lb-test                              |\n| operating_status    | ONLINE                               |\n| pools               |                                      |\n| provider            | haproxy                              |\n| provisioning_status | ACTIVE                               |\n| tenant_id           | 8933cf2d02004242bebeefa933146b70     |\n| vip_address         | 10.16.0.3                            |\n| vip_port_id         | f9f98325-6a11-4414-ba23-99ee65c2745f |\n| vip_subnet_id       | 6c022960-6447-49be-8be3-3029e3ce2634 |\n+---------------------+--------------------------------------+\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u8a2d\u5b9a\n\u4f5c\u6210\u3057\u305f\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30fc\u30c8\u306b\u8a2d\u5b9a\u3059\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u4f5c\u6210\u3092\u884c\u3044\u307e\u3059\u3002\n\u307e\u305a\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3057\u3001\u4ee5\u4e0b\u306e\u901a\u308a\u30eb\u30fc\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\n\nDIRECTION\nPROTOCOL\nPORT RANGE MIN\nPORT RANGE MAX\nREMOTE IP PREFIX\n\n\n\n\n\u53d7\u4fe1\ntcp\n80\n80\n0.0.0.0/0\n\n\n\u53d7\u4fe1\ntcp\n443\n443\n0.0.0.0/0\n\n\n\u53d7\u4fe1\nicmp\n-\n-\n-\n\n\n\n# neutron security-group-create sg-lb-test\n\n# neutron security-group-rule-create \\\n  --direction ingress \\\n  --protocol tcp \\\n  --port-range-min 80 \\\n  --port-range-max 80 \\\n  --remote-ip-prefix 0.0.0.0/0 \\\n  sg-lb-test\n\n# neutron security-group-rule-create \\\n  --direction ingress \\\n  --protocol tcp \\\n  --port-range-min 443 \\\n  --port-range-max 443 \\\n  --remote-ip-prefix 0.0.0.0/0 \\\n  sg-lb-test\n\n# neutron security-group-rule-create \\\n  --direction ingress \\\n  --protocol icmp \\\n  sg-lb-test\n\n\u4f5c\u6210\u3057\u305f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# neutron security-group-list --name  sg-lb-test\n+--------------------------------------+------------+-----------------------------------------------------+\n| id                                   | name       | security_group_rules                                |\n+--------------------------------------+------------+-----------------------------------------------------+\n| 75f25159-8239-44dc-b60b-d0a00973fb2e | sg-lb-test | egress, IPv4                                        |\n|                                      |            | egress, IPv6                                        |\n|                                      |            | ingress, IPv4, 443/tcp, remote_ip_prefix: 0.0.0.0/0 |\n|                                      |            | ingress, IPv4, 80/tcp, remote_ip_prefix: 0.0.0.0/0  |\n|                                      |            | ingress, IPv4, icmp                                 |\n+--------------------------------------+------------+-----------------------------------------------------+\n\n\u4f5c\u6210\u3057\u305f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30fc\u30c8\u306b\u95a2\u9023\u4ed8\u3051\u3057\u307e\u3059\u3002\n\u203b \u5f15\u6570\u3067\u6307\u5b9a\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30fc\u30c8\u304c\u77e5\u308a\u305f\u3044\u5834\u5408\u306f\u3001\n\u00a0\u00a0\u00a0\u00a0\"lbaas-loadbalancer-show\" \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3001\"vip_port_id\" \u306e\u5024\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n# neutron port-update --security-group sg-lb-test f9f98325-6a11-4414-ba23-99ee65c2745f\nUpdated port: f9f98325-6a11-4414-ba23-99ee65c2745f\n\n\"security_groups\" \u9805\u76ee\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7 ID \u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# neutron port-show f9f98325-6a11-4414-ba23-99ee65c2745f -F name  -F security_groups\n+-----------------+---------------------------------------------------+\n| Field           | Value                                             |\n+-----------------+---------------------------------------------------+\n| name            | loadbalancer-2e9bdc22-a12b-400c-b9c2-7d11aca04ba8 |\n| security_groups | 75f25159-8239-44dc-b60b-d0a00973fb2e              |\n+-----------------+---------------------------------------------------+\n\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u307e\u3067\u306e\u758e\u901a\u78ba\u8a8d\n\u3053\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3078\u884c\u304f\u524d\u306b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u307e\u3067\u306e\u758e\u901a\u3092 ping \u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n$ ping -c 3 192.168.1.22\n\n\nListener \u306e\u8a2d\u5b9a\nLoad Balancer \u304c ONLINE \u306e\u72b6\u614b\u3067\u3001HTTP Listener \u3068 HTTPS Listener \u3092\u305d\u308c\u305e\u308c\u4f5c\u6210\u3057\u307e\u3059\u3002\n# neutron lbaas-listener-create \\\n  --name listener-test-http \\\n  --loadbalancer lb-test \\\n  --protocol HTTP \\\n  --protocol-port 80\n\n# neutron lbaas-listener-create \\\n  --name listener-test-https \\\n  --loadbalancer lb-test \\\n  --protocol HTTPS \\\n  --protocol-port 443\n\n# neutron lbaas-listener-list\n+--------------------------------------+-----------------+---------------------+----------+---------------+----------------+\n| id                                   | default_pool_id | name                | protocol | protocol_port | admin_state_up |\n+--------------------------------------+-----------------+---------------------+----------+---------------+----------------+\n| bc3f818e-285b-4f22-99de-528c34638011 |                 | listener-test-http  | HTTP     |            80 | True           |\n| df8692f8-a3d8-4e50-bada-df0fab37f348 |                 | listener-test-https | HTTPS    |           443 | True           |\n+--------------------------------------+-----------------+---------------------+----------+---------------+----------------+\n\n\nPool \u306e\u8a2d\u5b9a\n\u7d9a\u3051\u3066 HTTP \u3068 HTTPS \u306e Pool \u3092\u305d\u308c\u305e\u308c\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u3001HTTP \u306f \"ROUND_ROBIN\"\u3001HTTPS \u306f \"LEAST_CONNECTIONS\" \u3068\u3057\u3066\u3044\u307e\u3059\u3002\n# neutron lbaas-pool-create \\\n  --name pool-test-http \\\n  --lb-algorithm ROUND_ROBIN \\\n  --listener listener-test-http \\\n  --protocol HTTP\n\n# neutron lbaas-pool-create \\\n  --name pool-test-https \\\n  --lb-algorithm LEAST_CONNECTIONS \\\n  --listener listener-test-https \\\n  --protocol HTTPS\n\n# neutron lbaas-pool-list\n+--------------------------------------+-----------------+----------+----------------+\n| id                                   | name            | protocol | admin_state_up |\n+--------------------------------------+-----------------+----------+----------------+\n| 45207ead-24b2-4802-a873-6351603f7945 | pool-test-https | HTTPS    | True           |\n| c13a05b7-ca6d-4b1f-a008-0936d3d086f6 | pool-test-http  | HTTP     | True           |\n+--------------------------------------+-----------------+----------+----------------+\n\n\nMember \u306e\u8a2d\u5b9a\nHTTP \u306e\u30d7\u30fc\u30eb\u30e1\u30f3\u30d0\u3092\u4f5c\u6210\u3057\u3001HTTP \u306e\u30d7\u30fc\u30eb(pool-test-http)\u3068\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002\n# neutron lbaas-member-create \\\n  --subnet private_network_subnet \\\n  --address 10.16.0.8 \\\n  --protocol-port 80 \\\n  pool-test-http\n# neutron lbaas-member-create \\\n  --subnet private_network_subnet \\\n  --address 10.16.0.9 \\\n  --protocol-port 80 \\\n  pool-test-http\n\n# neutron lbaas-member-list pool-test-http\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n| id                                   | name | address   | protocol_port | weight | subnet_id                            | admin_state_up |\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n| 94eaaa07-d9de-4c76-8a12-458f678ba016 |      | 10.16.0.8 |            80 |      1 | 6c022960-6447-49be-8be3-3029e3ce2634 | True           |\n| 9433d8b7-d341-4a4e-86df-3d642586960b |      | 10.16.0.9 |            80 |      1 | 6c022960-6447-49be-8be3-3029e3ce2634 | True           |\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n\nHTTPS \u306e\u30d7\u30fc\u30eb\u30e1\u30f3\u30d0\u3082\u540c\u69d8\u306b\u3001\u4f5c\u6210\u3057\u305f\u5f8c\u3001HTTPS \u306e\u30d7\u30fc\u30eb(pool-test-https)\u3068\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002\n# neutron lbaas-member-create \\\n  --subnet private_network_subnet \\\n  --address 10.16.0.8 \\\n  --protocol-port 443 \\\n  pool-test-https\n# neutron lbaas-member-create \\\n  --subnet private_network_subnet \\\n  --address 10.16.0.9 \\\n  --protocol-port 443 \\\n  pool-test-https\n\n# neutron lbaas-member-list pool-test-https\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n| id                                   | name | address   | protocol_port | weight | subnet_id                            | admin_state_up |\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n| 9f558822-ad80-4a62-bb53-2d93ffa2afcf |      | 10.16.0.8 |           443 |      1 | 6c022960-6447-49be-8be3-3029e3ce2634 | True           |\n| a5431ccb-a0e6-4d2f-a950-ddc520b41071 |      | 10.16.0.9 |           443 |      1 | 6c022960-6447-49be-8be3-3029e3ce2634 | True           |\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n\n\nHealth Monitor \u8a2d\u5b9a\n\u63a5\u7d9a\u3067\u304d\u306a\u3044 Member \u3092\u30d7\u30fc\u30eb\u304b\u3089\u9664\u5916\u3059\u308b\u3088\u3046\u306b\u3001Health Monitor \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u306e\u5024\u306f\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7279\u6027\u3084\u30b5\u30fc\u30d3\u30b9\u30ec\u30d9\u30eb\u306b\u5408\u308f\u305b\u3066\u3001\u4efb\u610f\u306e\u5024\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n# neutron lbaas-healthmonitor-create \\\n  --delay 5 \\\n  --max-retries 2 \\\n  --timeout 10 \\\n  --type HTTP \\\n  --pool pool-test-http\n\n# neutron lbaas-healthmonitor-create \\\n  --delay 5 \\\n  --max-retries 2 \\\n  --timeout 10 \\\n  --type HTTPS \\\n  --pool pool-test-https\n\n# neutron lbaas-healthmonitor-list\n+--------------------------------------+------+-------+----------------+\n| id                                   | name | type  | admin_state_up |\n+--------------------------------------+------+-------+----------------+\n| dfd8c872-c5fd-49f1-9c1e-01eb4c1195ed |      | HTTP  | True           |\n| e0dde485-0495-4447-afa4-6d20a24bdcd9 |      | HTTPS | True           |\n+--------------------------------------+------+-------+----------------+\n\n\nFloating IP \u306e\u5272\u308a\u5f53\u3066\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304c\u3001\u30d1\u30d6\u30ea\u30c3\u30af\u307e\u305f\u306f\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u5916\u90e8\u304b\u3089\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e VIP \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3084\u9694\u96e2\u3055\u308c\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u305d\u306e\u307e\u307e\u3067\u306f\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u306e\u5834\u5408\u3001\"neutron floatingip-associate\" \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066 Floating IP \u3092\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306b\u5272\u308a\u5f53\u3066\u308b\u3053\u3068\u3067\u3001\n\u5916\u90e8\u304b\u3089\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e VIP \u3078\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n### neutron floatingip-associate <\u5272\u308a\u5f53\u3066\u308b Floating IP \u306e ID> <\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u30dd\u30fc\u30c8 ID>\n\n# neutron floatingip-associate 357d04e6-e658-4969-9f53-3966fb36d858 f9f98325-6a11-4414-ba23-99ee65c2745f\nAssociated floating IP 357d04e6-e658-4969-9f53-3966fb36d858\n\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u7d71\u8a08\u60c5\u5831\u306e\u53d6\u5f97\nLBaaS v2 agent \u306f\u3001\u4ee5\u4e0b\u306e\uff14\u3064\u306e\u9805\u76ee\u306b\u3064\u3044\u3066\u3001\u305d\u308c\u305e\u308c\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304b\u3089\uff16\u79d2\u3054\u3068\u306b\u7d71\u8a08\u60c5\u5831\u3092\u53ce\u96c6\u3057\u307e\u3059\u3002\n\nactive_connections\nbytes_in\nbytes_out\ntotal_connections\n\n\"lbaas-loadbalancer-stats\" \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u308c\u3089\u306e\u5024\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n# neutron lbaas-loadbalancer-stats lb-test\n+--------------------+-------+\n| Field              | Value |\n+--------------------+-------+\n| active_connections | 0     |\n| bytes_in           | 234   |\n| bytes_out          | 35292 |\n| total_connections  | 3     |\n+--------------------+-------+\n\n\"active_connections\" \u306e\u30ab\u30a6\u30f3\u30c8\u5024\u306f\u3001\u30c7\u30fc\u30bf\u53d6\u5f97\u6642\u70b9\u3067\u3001\u30a2\u30af\u30c6\u30a3\u30d6\u3068\u306a\u3063\u3066\u3044\u308b\u7dcf\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u3067\u3001\n\u4ed6\u306e\uff13\u3064\u306e\u9805\u76ee\u306b\u3064\u3044\u3066\u306f\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304c\u8d77\u52d5\u3057\u3066\u304b\u3089\u306e\u7d2f\u7a4d\u5024\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u5099\u8003\nUI \u306e\u8a2d\u5b9a\u65b9\u6cd5\u306b\u3064\u3044\u3066\u306f\u3001\u78ba\u8a8d\u3067\u304d\u6b21\u7b2c\u8ffd\u8a18\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n2016/08/29\n\u516c\u5f0f\u306e GitHub\u306b\u3066\u3001MOS9.0\u5bfe\u5fdc\u304c\u3055\u308c\u305f\u3088\u3046\u306a\u306e\u3067\u3001URL \u3092\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\nHorizon \u306e\u30e1\u30cb\u30e5\u30fc\u306b\u3064\u3044\u3066\u306f\u3001\u5909\u308f\u3089\u305a\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n\u53c2\u8003 URL\n[GitHub] fuel-plugin-neutron-lbaas\n- https://github.com/openstack/fuel-plugin-neutron-lbaas\n[GitHub] fuel-plugin-neutron-lbaas (Qiita\u30d6\u30ed\u30b0\u7528)\n- https://github.com/falcon39/fuel-plugins/tree/master/fuel-plugin-neutron-lbaas\n[\u516c\u5f0f\u30de\u30cb\u30e5\u30a2\u30eb]\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5as a Service (LBaaS)\n- http://docs.openstack.org/mitaka/ja/networking-guide/adv-config-lbaas.html\n# \u6982\u8981\nMirantis OpenStack 9.0(\u4ee5\u4e0b\u3001MOS9.0) \u4e0a\u3067\u3001LBaaS(V2) \u6a5f\u80fd\u304c\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u624b\u9806\n\n## Fuel LBaaS Plugin \u306e\u6e96\u5099\nMOS9.0 \u306b\u5bfe\u5fdc\u3057\u305f LBaaS Plugin \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u6e96\u5099\u3057\u307e\u3059\u3002\n[\u3053\u3061\u3089](https://github.com/falcon39/openstack-plugins/blob/master/fuel-plugin-neutron-lbaas/lbaas-1.0-1.0.3-1.noarch.rpm)\u304b\u3089\u4f5c\u6210\u6e08\u307f\u306e\u3082\u306e\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u304b\u3001\n\u4ee5\u4e0b\u306e\u624b\u9806\u306b\u5f93\u3063\u3066\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n### \u30d1\u30c3\u30b1\u30fc\u30b8\u4f5c\u6210\n\u306f\u3058\u3081\u306b\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30d3\u30eb\u30c9\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nfuel-plugin-builder \u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u3001Fuel Plugin \u306e\u30d3\u30eb\u30c9\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\n\n```bash\n$ sudo apt-get update\n$ sudo apt-get install createrepo rpm dpkg-dev\n$ sudo apt-get install git\n\n$ sudo easy_install pip\n$ sudo pip install fuel-plugin-builder\n```\n\n\u4f5c\u696d\u7528PC\uff08\u4eca\u56de\u306f Ubuntu \u3092\u4f7f\u7528\uff09\u306b\u63a5\u7d9a\u3057\u3001[GitHub](https://github.com/openstack/fuel-plugin-neutron-lbaas) \u304b\u3089 `9.0` \u30d6\u30e9\u30f3\u30c1\u306e\u30af\u30ed\u30fc\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash\n$ cd\n$ git clone https://github.com/openstack/fuel-plugin-neutron-lbaas\nCloning into 'fuel-plugin-neutron-lbaas'...\nremote: Counting objects: 94, done.\nremote: Compressing objects: 100% (14/14), done.\nremote: Total 94 (delta 2), reused 0 (delta 0), pack-reused 78\nUnpacking objects: 100% (94/94), done.\nChecking connectivity... done.\n```\n\n\u30fb\u30d3\u30eb\u30c9\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\n```bash\n$ cd\n$ fpb --build ./fuel-plugin-neutron-lbaas/\nPlugin is built\n```\n\nrpm \u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$ ls -al ./fuel-plugin-neutron-lbaas/*.rpm\n-rw-rw-r-- 1 ubuntu ubuntu 17086 Aug 23 05:08 ./fuel-plugin-neutron-lbaas/lbaas-1.0-1.0.3-1.noarch.rpm\n```\n\n## Fuel LBaaS Plugin \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4f5c\u6210\u3057\u305f rpm \u30d5\u30a1\u30a4\u30eb\u3092 Fuel Master \u3078\u914d\u7f6e\u3057\u305f\u5f8c\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# fuel plugins --install lbaas-1.0-1.0.3-1.noarch.rpm\nLoaded plugins: fastestmirror, priorities\nExamining lbaas-1.0-1.0.3-1.noarch.rpm: lbaas-1.0-1.0.3-1.noarch\nMarking lbaas-1.0-1.0.3-1.noarch.rpm to be installed\nResolving Dependencies\n--> Running transaction check\n---> Package lbaas-1.0.noarch 0:1.0.3-1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n=================================================================================================================================================\n Package                        Arch                        Version                         Repository                                      Size\n=================================================================================================================================================\nInstalling:\n lbaas-1.0                      noarch                      1.0.3-1                         /lbaas-1.0-1.0.3-1.noarch                       25 k\n\nTransaction Summary\n=================================================================================================================================================\nInstall  1 Package\n\nTotal size: 25 k\nInstalled size: 25 k\nDownloading packages:\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  Installing : lbaas-1.0-1.0.3-1.noarch                                                                                                      1/1\n  Verifying  : lbaas-1.0-1.0.3-1.noarch                                                                                                      1/1\n\nInstalled:\n  lbaas-1.0.noarch 0:1.0.3-1\n\nComplete!\nPlugin lbaas-1.0-1.0.3-1.noarch.rpm was successfully installed.\n```\n\nFuel LBaaS Plugin \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u6b63\u5e38\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u3066\u3044\u308b\u5834\u5408\u3001Fuel \u30d7\u30e9\u30b0\u30a4\u30f3\u4e00\u89a7\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```\n# fuel plugins\nid | name  | version | package_version | releases\n---+-------+---------+-----------------+--------------------\n1  | lbaas | 1.0.3   | 3.0.0           | ubuntu (mitaka-9.0)\n```\n\nFuel \u30b3\u30f3\u30bd\u30fc\u30eb\u306e [PLUGINS] \u30bf\u30d6\u3092\u958b\u304d\u3001\u4ee5\u4e0b\u306e\u901a\u308a\u8868\u793a\u3055\u308c\u3066\u308c\u3070\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\n<font color=\"red\">\u203b MOS \u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u7b49\u3067\u5229\u7528\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u3001\u611f\u5606\u7b26(!)\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002</font>\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/129198/713b1e44-4422-294b-8640-892b865a1b59.jpeg\" width=900px></img>\n\n\u6b63\u5e38\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\nEnvironment \u753b\u9762\u306e [Settings]-[Other] \u306b \"LBaaS plugin for Neutron\" \u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\n\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u3066\u304b\u3089\u30c7\u30d7\u30ed\u30a4\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/129198/3b1455f6-551d-18f4-25ce-6c0513d63ad0.jpeg\" width=900px></img>\n\n# LBaaS \u8a2d\u5b9a\n## \u8a2d\u5b9a\u78ba\u8a8d\nneutron.conf \u306b LBaaS \u95a2\u9023\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```\n# grep \"lbaas\" /etc/neutron/neutron.conf\nservice_plugins =neutron.services.l3_router.l3_router_plugin.L3RouterPlugin,neutron.services.metering.metering_plugin.MeteringPlugin,neutron_lbaas.services.loadbalancer.plugin.LoadBalancerPluginv2\nservice_provider=LOADBALANCERV2:Haproxy:neutron_lbaas.drivers.haproxy.plugin_driver.HaproxyOnHostPluginDriver:default\n```\n\nneutron \u306e\u30b5\u30fc\u30d3\u30b9\u30d7\u30ed\u30d0\u30a4\u30c0\u3068\u3057\u3066\u3001`LOADBALANCERV2`\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```\n# neutron service-provider-list\n+----------------+---------+---------+\n| service_type   | name    | default |\n+----------------+---------+---------+\n| LOADBALANCERV2 | haproxy | True    |\n+----------------+---------+---------+\n```\n\n# \u52d5\u4f5c\u78ba\u8a8d\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/129198/8a99ca62-1e1e-6c9c-75d0-2e945a438ac8.png\" width=\"800px\"></img>\n\n## LBaaS V2\n###\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u8a2d\u5b9a\nLoad Balancer \u306e\u4f5c\u6210\u3092\u884c\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001`private-subnet` \u304b\u3089\u30a2\u30af\u30bb\u30b9\u3092\u53d7\u3051\u4ed8\u3051\u308b\u60f3\u5b9a\u3067\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\n# neutron lbaas-loadbalancer-create --name lb-test private_network_subnet\n```\n\n\u4f5c\u6210\u3057\u305f\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304c\u4ee5\u4e0b\u306e\u72b6\u614b\u3068\u306a\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n- operating_status: \"ONLINE\" \u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\n- provisioning_status: \"ACTIVE\" \u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\n- vip_address: \u6307\u5b9a\u3057\u305f\u30b5\u30d6\u30cd\u30c3\u30c8\u306e IP \u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308b\u3053\u3068\n\n```\n# neutron lbaas-loadbalancer-show lb-test\n+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| admin_state_up      | True                                 |\n| description         |                                      |\n| id                  | 2e9bdc22-a12b-400c-b9c2-7d11aca04ba8 |\n| listeners           |                                      |\n| name                | lb-test                              |\n| operating_status    | ONLINE                               |\n| pools               |                                      |\n| provider            | haproxy                              |\n| provisioning_status | ACTIVE                               |\n| tenant_id           | 8933cf2d02004242bebeefa933146b70     |\n| vip_address         | 10.16.0.3                            |\n| vip_port_id         | f9f98325-6a11-4414-ba23-99ee65c2745f |\n| vip_subnet_id       | 6c022960-6447-49be-8be3-3029e3ce2634 |\n+---------------------+--------------------------------------+\n```\n\n### \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u8a2d\u5b9a\n\u4f5c\u6210\u3057\u305f\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30fc\u30c8\u306b\u8a2d\u5b9a\u3059\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u4f5c\u6210\u3092\u884c\u3044\u307e\u3059\u3002\n\u307e\u305a\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3057\u3001\u4ee5\u4e0b\u306e\u901a\u308a\u30eb\u30fc\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n|DIRECTION|PROTOCOL|PORT RANGE MIN|PORT RANGE MAX|REMOTE IP PREFIX|\n|:--|:--|:--|:--|:--|\n|\u53d7\u4fe1|tcp|80|80|0.0.0.0/0|\n|\u53d7\u4fe1|tcp|443|443|0.0.0.0/0|\n|\u53d7\u4fe1|icmp|-|-|-|\n\n```\n# neutron security-group-create sg-lb-test\n\n# neutron security-group-rule-create \\\n  --direction ingress \\\n  --protocol tcp \\\n  --port-range-min 80 \\\n  --port-range-max 80 \\\n  --remote-ip-prefix 0.0.0.0/0 \\\n  sg-lb-test\n\n# neutron security-group-rule-create \\\n  --direction ingress \\\n  --protocol tcp \\\n  --port-range-min 443 \\\n  --port-range-max 443 \\\n  --remote-ip-prefix 0.0.0.0/0 \\\n  sg-lb-test\n\n# neutron security-group-rule-create \\\n  --direction ingress \\\n  --protocol icmp \\\n  sg-lb-test\n```\n\n\u4f5c\u6210\u3057\u305f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# neutron security-group-list --name  sg-lb-test\n+--------------------------------------+------------+-----------------------------------------------------+\n| id                                   | name       | security_group_rules                                |\n+--------------------------------------+------------+-----------------------------------------------------+\n| 75f25159-8239-44dc-b60b-d0a00973fb2e | sg-lb-test | egress, IPv4                                        |\n|                                      |            | egress, IPv6                                        |\n|                                      |            | ingress, IPv4, 443/tcp, remote_ip_prefix: 0.0.0.0/0 |\n|                                      |            | ingress, IPv4, 80/tcp, remote_ip_prefix: 0.0.0.0/0  |\n|                                      |            | ingress, IPv4, icmp                                 |\n+--------------------------------------+------------+-----------------------------------------------------+\n```\n\n\u4f5c\u6210\u3057\u305f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30fc\u30c8\u306b\u95a2\u9023\u4ed8\u3051\u3057\u307e\u3059\u3002\n<font color=\"blue\">\u203b \u5f15\u6570\u3067\u6307\u5b9a\u3059\u308b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30dd\u30fc\u30c8\u304c\u77e5\u308a\u305f\u3044\u5834\u5408\u306f\u3001\n&nbsp;&nbsp;&nbsp;&nbsp;\"lbaas-loadbalancer-show\" \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3001\"vip_port_id\" \u306e\u5024\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002</font>\n\n```\n# neutron port-update --security-group sg-lb-test f9f98325-6a11-4414-ba23-99ee65c2745f\nUpdated port: f9f98325-6a11-4414-ba23-99ee65c2745f\n```\n\n\"security_groups\" \u9805\u76ee\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7 ID \u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# neutron port-show f9f98325-6a11-4414-ba23-99ee65c2745f -F name  -F security_groups\n+-----------------+---------------------------------------------------+\n| Field           | Value                                             |\n+-----------------+---------------------------------------------------+\n| name            | loadbalancer-2e9bdc22-a12b-400c-b9c2-7d11aca04ba8 |\n| security_groups | 75f25159-8239-44dc-b60b-d0a00973fb2e              |\n+-----------------+---------------------------------------------------+\n```\n\n###\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u307e\u3067\u306e\u758e\u901a\u78ba\u8a8d\n\u3053\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u3078\u884c\u304f\u524d\u306b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u307e\u3067\u306e\u758e\u901a\u3092 ping \u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n$ ping -c 3 192.168.1.22\n```\n\n### Listener \u306e\u8a2d\u5b9a\nLoad Balancer \u304c ONLINE \u306e\u72b6\u614b\u3067\u3001HTTP Listener \u3068 HTTPS Listener \u3092\u305d\u308c\u305e\u308c\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n# neutron lbaas-listener-create \\\n  --name listener-test-http \\\n  --loadbalancer lb-test \\\n  --protocol HTTP \\\n  --protocol-port 80\n\n# neutron lbaas-listener-create \\\n  --name listener-test-https \\\n  --loadbalancer lb-test \\\n  --protocol HTTPS \\\n  --protocol-port 443\n\n# neutron lbaas-listener-list\n+--------------------------------------+-----------------+---------------------+----------+---------------+----------------+\n| id                                   | default_pool_id | name                | protocol | protocol_port | admin_state_up |\n+--------------------------------------+-----------------+---------------------+----------+---------------+----------------+\n| bc3f818e-285b-4f22-99de-528c34638011 |                 | listener-test-http  | HTTP     |            80 | True           |\n| df8692f8-a3d8-4e50-bada-df0fab37f348 |                 | listener-test-https | HTTPS    |           443 | True           |\n+--------------------------------------+-----------------+---------------------+----------+---------------+----------------+\n```\n\n### Pool \u306e\u8a2d\u5b9a\n\u7d9a\u3051\u3066 HTTP \u3068 HTTPS \u306e Pool \u3092\u305d\u308c\u305e\u308c\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u3001HTTP \u306f \"ROUND_ROBIN\"\u3001HTTPS \u306f \"LEAST_CONNECTIONS\" \u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\n# neutron lbaas-pool-create \\\n  --name pool-test-http \\\n  --lb-algorithm ROUND_ROBIN \\\n  --listener listener-test-http \\\n  --protocol HTTP\n\n# neutron lbaas-pool-create \\\n  --name pool-test-https \\\n  --lb-algorithm LEAST_CONNECTIONS \\\n  --listener listener-test-https \\\n  --protocol HTTPS\n\n# neutron lbaas-pool-list\n+--------------------------------------+-----------------+----------+----------------+\n| id                                   | name            | protocol | admin_state_up |\n+--------------------------------------+-----------------+----------+----------------+\n| 45207ead-24b2-4802-a873-6351603f7945 | pool-test-https | HTTPS    | True           |\n| c13a05b7-ca6d-4b1f-a008-0936d3d086f6 | pool-test-http  | HTTP     | True           |\n+--------------------------------------+-----------------+----------+----------------+\n```\n\n### Member \u306e\u8a2d\u5b9a\nHTTP \u306e\u30d7\u30fc\u30eb\u30e1\u30f3\u30d0\u3092\u4f5c\u6210\u3057\u3001HTTP \u306e\u30d7\u30fc\u30eb(pool-test-http)\u3068\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002\n\n```\n# neutron lbaas-member-create \\\n  --subnet private_network_subnet \\\n  --address 10.16.0.8 \\\n  --protocol-port 80 \\\n  pool-test-http\n# neutron lbaas-member-create \\\n  --subnet private_network_subnet \\\n  --address 10.16.0.9 \\\n  --protocol-port 80 \\\n  pool-test-http\n\n# neutron lbaas-member-list pool-test-http\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n| id                                   | name | address   | protocol_port | weight | subnet_id                            | admin_state_up |\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n| 94eaaa07-d9de-4c76-8a12-458f678ba016 |      | 10.16.0.8 |            80 |      1 | 6c022960-6447-49be-8be3-3029e3ce2634 | True           |\n| 9433d8b7-d341-4a4e-86df-3d642586960b |      | 10.16.0.9 |            80 |      1 | 6c022960-6447-49be-8be3-3029e3ce2634 | True           |\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n```\n\nHTTPS \u306e\u30d7\u30fc\u30eb\u30e1\u30f3\u30d0\u3082\u540c\u69d8\u306b\u3001\u4f5c\u6210\u3057\u305f\u5f8c\u3001HTTPS \u306e\u30d7\u30fc\u30eb(pool-test-https)\u3068\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002\n\n```\n# neutron lbaas-member-create \\\n  --subnet private_network_subnet \\\n  --address 10.16.0.8 \\\n  --protocol-port 443 \\\n  pool-test-https\n# neutron lbaas-member-create \\\n  --subnet private_network_subnet \\\n  --address 10.16.0.9 \\\n  --protocol-port 443 \\\n  pool-test-https\n\n# neutron lbaas-member-list pool-test-https\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n| id                                   | name | address   | protocol_port | weight | subnet_id                            | admin_state_up |\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n| 9f558822-ad80-4a62-bb53-2d93ffa2afcf |      | 10.16.0.8 |           443 |      1 | 6c022960-6447-49be-8be3-3029e3ce2634 | True           |\n| a5431ccb-a0e6-4d2f-a950-ddc520b41071 |      | 10.16.0.9 |           443 |      1 | 6c022960-6447-49be-8be3-3029e3ce2634 | True           |\n+--------------------------------------+------+-----------+---------------+--------+--------------------------------------+----------------+\n```\n\n### Health Monitor \u8a2d\u5b9a\n\u63a5\u7d9a\u3067\u304d\u306a\u3044 Member \u3092\u30d7\u30fc\u30eb\u304b\u3089\u9664\u5916\u3059\u308b\u3088\u3046\u306b\u3001Health Monitor \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u306e\u5024\u306f\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7279\u6027\u3084\u30b5\u30fc\u30d3\u30b9\u30ec\u30d9\u30eb\u306b\u5408\u308f\u305b\u3066\u3001\u4efb\u610f\u306e\u5024\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\n# neutron lbaas-healthmonitor-create \\\n  --delay 5 \\\n  --max-retries 2 \\\n  --timeout 10 \\\n  --type HTTP \\\n  --pool pool-test-http\n\n# neutron lbaas-healthmonitor-create \\\n  --delay 5 \\\n  --max-retries 2 \\\n  --timeout 10 \\\n  --type HTTPS \\\n  --pool pool-test-https\n\n# neutron lbaas-healthmonitor-list\n+--------------------------------------+------+-------+----------------+\n| id                                   | name | type  | admin_state_up |\n+--------------------------------------+------+-------+----------------+\n| dfd8c872-c5fd-49f1-9c1e-01eb4c1195ed |      | HTTP  | True           |\n| e0dde485-0495-4447-afa4-6d20a24bdcd9 |      | HTTPS | True           |\n+--------------------------------------+------+-------+----------------+\n```\n\n### Floating IP \u306e\u5272\u308a\u5f53\u3066\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304c\u3001\u30d1\u30d6\u30ea\u30c3\u30af\u307e\u305f\u306f\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\u5916\u90e8\u304b\u3089\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e VIP \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3057\u304b\u3057\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3084\u9694\u96e2\u3055\u308c\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u305d\u306e\u307e\u307e\u3067\u306f\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u306e\u5834\u5408\u3001\"neutron floatingip-associate\" \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066 Floating IP \u3092\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306b\u5272\u308a\u5f53\u3066\u308b\u3053\u3068\u3067\u3001\n\u5916\u90e8\u304b\u3089\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e VIP \u3078\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```\n### neutron floatingip-associate <\u5272\u308a\u5f53\u3066\u308b Floating IP \u306e ID> <\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u30dd\u30fc\u30c8 ID>\n\n# neutron floatingip-associate 357d04e6-e658-4969-9f53-3966fb36d858 f9f98325-6a11-4414-ba23-99ee65c2745f\nAssociated floating IP 357d04e6-e658-4969-9f53-3966fb36d858\n```\n\n### \u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306e\u7d71\u8a08\u60c5\u5831\u306e\u53d6\u5f97\nLBaaS v2 agent \u306f\u3001\u4ee5\u4e0b\u306e\uff14\u3064\u306e\u9805\u76ee\u306b\u3064\u3044\u3066\u3001\u305d\u308c\u305e\u308c\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304b\u3089\uff16\u79d2\u3054\u3068\u306b\u7d71\u8a08\u60c5\u5831\u3092\u53ce\u96c6\u3057\u307e\u3059\u3002\n\n- active_connections\n- bytes_in\n- bytes_out\n- total_connections\n\n\"lbaas-loadbalancer-stats\" \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u308c\u3089\u306e\u5024\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```\n# neutron lbaas-loadbalancer-stats lb-test\n+--------------------+-------+\n| Field              | Value |\n+--------------------+-------+\n| active_connections | 0     |\n| bytes_in           | 234   |\n| bytes_out          | 35292 |\n| total_connections  | 3     |\n+--------------------+-------+\n```\n\"active_connections\" \u306e\u30ab\u30a6\u30f3\u30c8\u5024\u306f\u3001\u30c7\u30fc\u30bf\u53d6\u5f97\u6642\u70b9\u3067\u3001\u30a2\u30af\u30c6\u30a3\u30d6\u3068\u306a\u3063\u3066\u3044\u308b\u7dcf\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u3067\u3001\n\u4ed6\u306e\uff13\u3064\u306e\u9805\u76ee\u306b\u3064\u3044\u3066\u306f\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u304c\u8d77\u52d5\u3057\u3066\u304b\u3089\u306e\u7d2f\u7a4d\u5024\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\n# \u5099\u8003\nUI \u306e\u8a2d\u5b9a\u65b9\u6cd5\u306b\u3064\u3044\u3066\u306f\u3001\u78ba\u8a8d\u3067\u304d\u6b21\u7b2c\u8ffd\u8a18\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n## 2016/08/29\n[\u516c\u5f0f\u306e GitHub](https://github.com/openstack/fuel-plugin-neutron-lbaas)\u306b\u3066\u3001MOS9.0\u5bfe\u5fdc\u304c\u3055\u308c\u305f\u3088\u3046\u306a\u306e\u3067\u3001URL \u3092\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\nHorizon \u306e\u30e1\u30cb\u30e5\u30fc\u306b\u3064\u3044\u3066\u306f\u3001\u5909\u308f\u3089\u305a\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n\n# \u53c2\u8003 URL\n[GitHub] fuel-plugin-neutron-lbaas\n- https://github.com/openstack/fuel-plugin-neutron-lbaas\n\n[GitHub] fuel-plugin-neutron-lbaas (Qiita\u30d6\u30ed\u30b0\u7528)\n- https://github.com/falcon39/fuel-plugins/tree/master/fuel-plugin-neutron-lbaas\n\n[\u516c\u5f0f\u30de\u30cb\u30e5\u30a2\u30eb]\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5as a Service (LBaaS)\n- http://docs.openstack.org/mitaka/ja/networking-guide/adv-config-lbaas.html\n\n", "tags": ["mirantis", "openstack", "LBaaS"]}