{"context": "\n\nimage\u304c\u306a\u3044\u5834\u5408\n\nspec/mailers/email_spec.rb\nlet(:mail) { described_class.send_email(user)}\nit 'assigns activation url' do\n  url = something_url(user)\n  expect(mail.body.encoded).to have_link(t('activate'), href: url)\nend\n\n\n\n\n\u753b\u50cf\u3092\u5165\u308c\u308b\n\napp/helpers/email_helper.rb\nmodule EmailHelper\n  def email_image_tag(image, options = {})\n    image_tag email_image_url(image), options\n  end\n\n  def email_image_url(image)\n    attachments[image] = File.read Rails.root.join(\"app/assets/images/#{image}\")\n    attachments[image].url\n  end\nend\n\n\n\napp/views/user_mailer/send_mail.haml\n...\n= email_image_tag('test.png') # app/assets/image/test.png\n...\n\n\n\u753b\u50cf\u3092\u5165\u308c\u308b\u3068Content-type\u304c\u5909\u308f\u3063\u3066\u3057\u307e\u3044\u3001\u4e0a\u8a18\u306eURL\u306e\u30c6\u30b9\u30c8\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\n\n\u89e3\u6c7a\u65b9\u6cd5\n\nspec/supports/email_helper.rb\nmodule EmailHelper\n  def get_message_part(mail, content_type)\n    mail.body.parts.find { |p| p.content_type.match content_type }\n        .body.raw_source\n  end\nend\n\n\n\n\nspec/mailers/email_spec.rb\ninclude EmailHelper\nlet(:mail) { described_class.send_email(user)}\nlet(:msg) { get_message_part mail, /html/ }\nit 'assigns activation url' do\n  url = something_url(user)\n  expect(msg).to have_link(t('activate'), href: url)\nend\n\n\n\n## image\u304c\u306a\u3044\u5834\u5408\n\n```rb:spec/mailers/email_spec.rb\nlet(:mail) { described_class.send_email(user)}\nit 'assigns activation url' do\n  url = something_url(user)\n  expect(mail.body.encoded).to have_link(t('activate'), href: url)\nend\n\n```\n\n## \u753b\u50cf\u3092\u5165\u308c\u308b\n\n```rb:app/helpers/email_helper.rb\nmodule EmailHelper\n  def email_image_tag(image, options = {})\n    image_tag email_image_url(image), options\n  end\n\n  def email_image_url(image)\n    attachments[image] = File.read Rails.root.join(\"app/assets/images/#{image}\")\n    attachments[image].url\n  end\nend\n```\n\n\n```rb:app/views/user_mailer/send_mail.haml\n...\n= email_image_tag('test.png') # app/assets/image/test.png\n...\n```\n\n\u753b\u50cf\u3092\u5165\u308c\u308b\u3068Content-type\u304c\u5909\u308f\u3063\u3066\u3057\u307e\u3044\u3001\u4e0a\u8a18\u306eURL\u306e\u30c6\u30b9\u30c8\u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\n\n## \u89e3\u6c7a\u65b9\u6cd5\n\n```rb:spec/supports/email_helper.rb\nmodule EmailHelper\n  def get_message_part(mail, content_type)\n    mail.body.parts.find { |p| p.content_type.match content_type }\n        .body.raw_source\n  end\nend\n\n```\n\n```rb:spec/mailers/email_spec.rb\ninclude EmailHelper\nlet(:mail) { described_class.send_email(user)}\nlet(:msg) { get_message_part mail, /html/ }\nit 'assigns activation url' do\n  url = something_url(user)\n  expect(msg).to have_link(t('activate'), href: url)\nend\n\n```\n", "tags": ["Rails", "Mailer", "image", "RSpec"]}