{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\nRSense\u3068\u672c\u8a18\u4e8b\u306e\u76ee\u7684\n\n\u3054\u5b58\u3058\u306e\u901a\u308a\u3001\u9ad8\u6a5f\u80fd\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u306b\u7279\u5316\u3057\u305fRuby\u306e\u305f\u3081\u306e\u958b\u767a\u63f4\u52a9\u30c4\u30fc\u30eb\u3067\u3059\u3002\u4e16\u306e\u4e2d\u306b\u306fWindows\u3057\u304b\u4f7f\u3048\u306a\u3044\u4f7f\u308f\u306a\u3044\u306b\u3082\u304b\u304b\u308f\u3089\u305a\u3001Ruby\u306b\u624b\u3092\u304b\u3051\u308b\u65b9\u3082\u591a\u304f\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u3059\u3002\n\u305d\u3093\u306a\u65b9\u306e\u624b\u52a9\u3051\u306b\u306a\u308c\u3070\u3068\u601d\u3044\u307e\u3057\u305f\u304c\u3001\u304a\u304b\u3057\u306a\u3068\u3053\u308d\u3067\u6642\u9593\u304c\u304b\u304b\u308a\u3001Windows\u306b\u304a\u3044\u3066Ruby\u3092\u4f7f\u3063\u3066\u3044\u304f\u4e0a\u306e\u9762\u5012\u306a\u3068\u3053\u308d\u3070\u3063\u304b\u308a\u306b\u3072\u3063\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u3001\u672a\u5b8c\u3067\u3059\u3002\u968f\u6642\u8ffd\u8a18\u3057\u3066\u3044\u304d\u307e\u3059orz\n\n\n\u624b\u5143\u306e\u74b0\u5883\u3092\u78ba\u8a8d\n\n>ruby -v\nruby 1.9.3p125 (2012-02-16) [i386-mswin32_100]\n> systeminfo.exe\nOS \u540d:                  Microsoft Windows 7 Professional\nOS \u30d0\u30fc\u30b8\u30e7\u30f3:          6.1.7601 Service Pack 1 \u30d3\u30eb\u30c9 7601\nOS \u88fd\u9020\u5143:              Microsoft Corporation\n(snip)\n\u30b7\u30b9\u30c6\u30e0\u306e\u7a2e\u985e:         x64-based PC\n\u30d7\u30ed\u30bb\u30c3\u30b5:             1 \u30d7\u30ed\u30bb\u30c3\u30b5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3067\u3059\u3002\n                        [01]: Intel64 Family 6 Model 42 Stepping 7 GenuineIntel~3301 Mhz\n\n\n\u307e\u305a\u306fRSense \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n\n\u516c\u958b\u5148\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nz:/tmp/20120711/rsense-0.3 \u306b\u89e3\u51cd\u3057\u305f\u3068\u3057\u3066\u9032\u3081\u307e\u3059\n\n\n\u3053\u3053\u3067\u5927\u304d\u306a\u904e\u3061\nRSense\u3092\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\u767b\u9332\u3057\u3001\u6577\u5c45\u3092\u4f4e\u304f\u3057\u3088\u3046\u3068\u601d\u3063\u305f\u3068\u3053\u308d\u304c\u5927\u304d\u306a\u904e\u3061\u3067\u3057\u305f\u3002\n\u307e\u305a\u3001rsense \u30e6\u30fc\u30b6\u30fc\u30ba\u30de\u30cb\u30e5\u30a2\u30eb\u306b\u6cbf\u3063\u3066\u4f5c\u696d\u3057\u307e\u3059\u3002\n\ngem \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n> gem install win32-service\nFetching: win32-api-1.4.8.gem (100%)\nBuilding native extensions.  This could take a while...\nERROR:  Error installing win32-service:\n        ERROR: Failed to build gem native extension.\n    C:/App/ruby_1_9_3_p125/bin/ruby.exe extconf.rb\n\nchecking for strncpy_s()... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\nProvided configuration options:\n        --with-opt-dir\n\n\u3042\u3042\u3001\u305d\u3046\u3067\u3057\u305f\u305d\u3046\u3067\u3057\u305f\u3002\u30b3\u30f3\u30d1\u30a4\u30eb\u74b0\u5883\u304c\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u305d\u3053\u3067\u3001Microsoft\u516c\u958b\u5148\u304b\u3089 vc_web.exe\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001Visual C++ 2010 Express \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u305d\u3053\u305d\u3053\u6642\u9593\u3092\u8981\u3057\u307e\u3059\u3002\u9014\u4e2d\u3067\u5bdd\u3066\u307e\u3057\u305f\u3002\n[Microsoft Visual Stdio 2010 Express]-[Visual Studio \u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8]\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\nSetting environment for using Microsoft Visual Studio 2010 x86 tools.\nC:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\VC>\ncd c:\\App\\ruby_1_9_3_p125\\bin>\nc:\\App\\ruby_1_9_3_p125\\bin>gem install win32-service\nBuilding native extensions.  This could take a while...\nFetching: windows-api-0.4.1.gem (100%)\nFetching: windows-pr-1.2.1.gem (100%)\nFetching: win32-service-0.7.2.gem (100%)\nBuilding native extensions.  This could take a while...\nSuccessfully installed win32-api-1.4.8\nSuccessfully installed windows-api-0.4.1\nSuccessfully installed windows-pr-1.2.1\nSuccessfully installed win32-service-0.7.2\n4 gems installed\nInstalling ri documentation for win32-api-1.4.8...\nInstalling ri documentation for windows-api-0.4.1...\nInstalling ri documentation for windows-pr-1.2.1...\nInstalling ri documentation for win32-service-0.7.2...\nInstalling RDoc documentation for win32-api-1.4.8...\nInstalling RDoc documentation for windows-api-0.4.1...\nInstalling RDoc documentation for windows-pr-1.2.1...\nInstalling RDoc documentation for win32-service-0.7.2...\n\n\u7121\u4e8b\u6210\u529f\u3067\u3059\u3002Windows\u74b0\u5883\u306b\u304a\u3044\u3066extconf.rb\u95a2\u9023\u3067\u5931\u6557\u3059\u308b\u5834\u5408\u306f\u5927\u62b5\u3053\u308c\u3067\u4f55\u3068\u304b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u3067\u3082nokogiri\u306fcygwin\u304bmingw\u3067\u3057\u304b\u30c0\u30e1\u3063\u307d\u3044\u3067\u3059\u3002\n\nWindows\u306e\u30b5\u30fc\u30d3\u30b9\u306b\u767b\u9332\n\n> ruby bin\\rsense service create\nC:/App/ruby_1_9_3_p125/lib/ruby/gems/1.9.1/gems/windows-pr-1.2.1/lib/windows/err\nor.rb:435:in `strip': invalid byte sequence in US-ASCII (ArgumentError)\n        from C:/App/ruby_1_9_3_p125/lib/ruby/gems/1.9.1/gems/windows-pr-1.2.1/li\nb/windows/error.rb:435:in `get_last_error'\n        from C:/App/ruby_1_9_3_p125/lib/ruby/gems/1.9.1/gems/win32-service-0.7.2\n/lib/win32/service.rb:368:in `initialize'\n        from bin/rsense:228:in `new'\n        from bin/rsense:228:in `exec_command'\n        from bin/rsense:288:in `process'\n        from bin/rsense:297:in `<main>'\n\nwindows-pr-1.2.1/lib/windows/error.rb\u3092\u898b\u308b\u3068\u30011.9\u7cfb\u306e\u30a8\u30f3\u30b3\u30fc\u30c9\u307d\u3044\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3044\u308b\u69d8\u5b50\u3002\u3053\u3053\u3067\u76ee\u7684\u3092\u898b\u5931\u3044\u306a\u304c\u3089\u9069\u5f53\u306b\u5bfe\u51e6\u3002\n\nwindows-pr-1.2.1/lib/windows/error.rb\ndef get_last_error(err_num = GetLastError.call)\n  buf   = 0.chr * 260\n  flags = FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_ARGUMENT_ARRAY\n  FormatMessageA.call(flags, 0, err_num, 0, buf, buf.size, 0)\n  #buf.strip\n  buf\nend\n\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u767b\u9332\u306b\u5931\u6557\u3057\u3066\u3044\u308b\u306e\u306fUAC\u95a2\u9023\u3060\u308d\u3046\u3068\u8003\u3048\u3001\u7ba1\u7406\u8005\u6a29\u9650\u3067\u8d77\u52d5\u3057\u305fcmd.exe\u304b\u3089\u5b9f\u884c\u3057\u305f\u3068\u3053\u308d\u6210\u529f\u3067\u3059\u3002\n\n> ruby bin\\rsense service create\n>sc query rsense\nSERVICE_NAME: rsense\n        TYPE               : 10  WIN32_OWN_PROCESS\n        STATE              : 1  STOPPED\n        WIN32_EXIT_CODE    : 1077  (0x435)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x0\n        WAIT_HINT          : 0x0\n\n\u3067\u3082\u8d77\u52d5\u3057\u306a\u3044\u3002\n\nnet start RSense\n\u30b7\u30b9\u30c6\u30e0 \u30a8\u30e9\u30fc 2 \u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\u6307\u5b9a\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\n\n\u307e\u305a\u306fWindows\u30b5\u30fc\u30d3\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u304b\u3089\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u3092\u78ba\u8a8d\u3002\n\nrubyw.exe z:/tmp/20120711/rsense-0.3/bin/rsense --config=C:\\home\\tamoot/.rsense\n\nrubyw.exe\u304c\u30d5\u30eb\u30d1\u30b9\u3067\u306f\u306a\u3044+PATH\u304c\u901a\u3063\u3066\u3044\u306a\u3044\u305f\u3081\u3001rubyw.exe\u304c\u898b\u3064\u304b\u3089\u305a\u5931\u6557\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\u30bd\u30fc\u30b9\u304b\u3089\u3082\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n\nwin32-service-0.7.2/lib/win32/service.rb\nwhen 'create'\n  path = Pathname.new(@rsense_home).realpath\n  command = Shellwords.unshellwords %W(rubyw.exe #{path}/bin/rsense --config=#@config service daemon)\n  Win32::Service.create(:service_name       => SERVICE_NAME,\n                        :service_type       => Win32::Service::WIN32_OWN_PROCESS,\n                        :description        => 'RSense Service',\n                        :start_type         => Win32::Service::DEMAND_START,\n                        :binary_path_name   => command,\n                        :display_name       => 'RSense')\n\n\nrubyw.exe\u306b\u3064\u3044\u3066\u3068\u308a\u3042\u3048\u305a\u30d5\u30eb\u30d1\u30b9\u8a18\u8f09\u3057\u3001\u518d\u5ea6\u30b5\u30fc\u30d3\u30b9\u767b\u9332\u30fb\u8d77\u52d5\u306f\u6210\u529f\u3057\u307e\u3057\u305f\uff01(\u9577\u304b\u3063\u305f)\n\u3067\u306f\u3053\u3053\u3067\u7126\u3089\u305a\u3001\u958b\u3044\u3066\u3044\u308b\u30dd\u30fc\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nz:\\tmp\\20120711\\rsense-0.3>tasklist /v | findstr rubyw\nrubyw.exe                     3332 Services                   0     10,184 K Unk\nnown         NT AUTHORITY\\SYSTEM                                     0:00:02 N/A\nz:\\tmp\\20120711\\rsense-0.3>netstat -aon | findstr 3332\nTCP    127.0.0.1:11831        0.0.0.0:0              LISTENING       3332\n\n\u3042\u308c?11831\u30dd\u30fc\u30c8\u304c\u958b\u3044\u3066\u3044\u308b\u3002\u30bd\u30fc\u30b9\u3092\u898b\u3066\u3082\u300111831\u3068\u3044\u3046\u6307\u5b9a\u306f\u7121\u3044\u306a\u30fb\u30fb\u30fb\u6848\u306e\u5b9a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u304b\u3089\u3064\u306a\u304c\u3063\u3066\u3044\u306a\u3044\u69d8\u5b50\u3002\n\u3068\u3053\u3053\u3067\u4f53\u529b\u304c\u5207\u308c\u307e\u3057\u305f\u3002\u4eca\u5f8c\u8ffd\u8a18\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u3053\u3053\u307e\u3067\u306e\u307e\u3068\u3081\n\nRSense\u81ea\u4f53\u306f\u7c21\u5358\nRuby 1.9.3 + Windows\u3067\u30b5\u30fc\u30d3\u30b9\u767b\u9332\u3057\u3088\u3046\u3068\u601d\u3046\u3068\u3061\u3087\u3063\u3068\u9762\u5012\n\n\n\u8aac\u660e\u3057\u3066\u306a\u3044\u3068\u3053\u308d\nWindows\u3067RSense\u3092\u5229\u7528\u53ef\u80fd\u306a\u30a8\u30c7\u30a3\u30bf\u9054\n\ngvim, emacs: \u30e6\u30fc\u30b6\u30fc\u30de\u30cb\u30e5\u30a2\u30eb\n\nxyzzy: Ruby\u958b\u767a\u652f\u63f4\u30c4\u30fc\u30ebRSense\u3092xyzzy\u304b\u3089\u4f7f\u3063\u3066\u307f\u305f\u306e\u5dfb\n\n\u79c0\u4e38: Ruby\u958b\u767a\u652f\u63f4\u30c4\u30fc\u30ebRSense\u3092\u79c0\u4e38\u304b\u3089\u4f7f\u3063\u3066\u307f\u305f\u306e\u5dfb\n\nredcar: \u30d7\u30e9\u30b0\u30a4\u30f3\n\n\nRSense\u5c0e\u5165\u306e\u6577\u5c45\u3092\u4e0b\u3052\u3066\u3001\u793e\u5185\u3067\u4f7f\u3063\u3066\u3082\u3089\u3048\u308c\u3070\u30b3\u30d4\u30da\u5168\u76db\u671f\u306e\u73fe\u5728\u3088\u308a\u306f\u30de\u30b7\u306b\u306a\u308b\u306e\u306b\u306a\u30fc\u3068\u601d\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n# \u306f\u3058\u3081\u306b\n\n## RSense\u3068\u672c\u8a18\u4e8b\u306e\u76ee\u7684\n\n* \u3054\u5b58\u3058\u306e\u901a\u308a\u3001\u9ad8\u6a5f\u80fd\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u306b\u7279\u5316\u3057\u305fRuby\u306e\u305f\u3081\u306e\u958b\u767a\u63f4\u52a9\u30c4\u30fc\u30eb\u3067\u3059\u3002\u4e16\u306e\u4e2d\u306b\u306fWindows\u3057\u304b\u4f7f\u3048\u306a\u3044\u4f7f\u308f\u306a\u3044\u306b\u3082\u304b\u304b\u308f\u3089\u305a\u3001Ruby\u306b\u624b\u3092\u304b\u3051\u308b\u65b9\u3082\u591a\u304f\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u3059\u3002\n* \u305d\u3093\u306a\u65b9\u306e\u624b\u52a9\u3051\u306b\u306a\u308c\u3070\u3068\u601d\u3044\u307e\u3057\u305f\u304c\u3001\u304a\u304b\u3057\u306a\u3068\u3053\u308d\u3067\u6642\u9593\u304c\u304b\u304b\u308a\u3001Windows\u306b\u304a\u3044\u3066Ruby\u3092\u4f7f\u3063\u3066\u3044\u304f\u4e0a\u306e\u9762\u5012\u306a\u3068\u3053\u308d\u3070\u3063\u304b\u308a\u306b\u3072\u3063\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u3001\u672a\u5b8c\u3067\u3059\u3002\u968f\u6642\u8ffd\u8a18\u3057\u3066\u3044\u304d\u307e\u3059orz\n\n## \u624b\u5143\u306e\u74b0\u5883\u3092\u78ba\u8a8d\n\n\n> &gt;ruby -v\n> ruby 1.9.3p125 (2012-02-16) [i386-mswin32_100]\n\n> &gt; systeminfo.exe\n> OS \u540d:                  Microsoft Windows 7 Professional\n> OS \u30d0\u30fc\u30b8\u30e7\u30f3:          6.1.7601 Service Pack 1 \u30d3\u30eb\u30c9 7601\n> OS \u88fd\u9020\u5143:              Microsoft Corporation\n> (snip)\n> \u30b7\u30b9\u30c6\u30e0\u306e\u7a2e\u985e:         x64-based PC\n> \u30d7\u30ed\u30bb\u30c3\u30b5:             1 \u30d7\u30ed\u30bb\u30c3\u30b5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u3067\u3059\u3002\n>                         [01]: Intel64 Family 6 Model 42 Stepping 7 GenuineIntel~3301 Mhz\n\n\n## \u307e\u305a\u306fRSense \u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n* [\u516c\u958b\u5148](http://cx4a.org/software/rsense/index.ja.html)\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n* z:/tmp/20120711/rsense-0.3 \u306b\u89e3\u51cd\u3057\u305f\u3068\u3057\u3066\u9032\u3081\u307e\u3059\n\n# \u3053\u3053\u3067\u5927\u304d\u306a\u904e\u3061\n\nRSense\u3092\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\u767b\u9332\u3057\u3001\u6577\u5c45\u3092\u4f4e\u304f\u3057\u3088\u3046\u3068\u601d\u3063\u305f\u3068\u3053\u308d\u304c\u5927\u304d\u306a\u904e\u3061\u3067\u3057\u305f\u3002\n\n\n\u307e\u305a\u3001[rsense \u30e6\u30fc\u30b6\u30fc\u30ba\u30de\u30cb\u30e5\u30a2\u30eb](http://cx4a.org/software/rsense/manual.ja.html#Windows)\u306b\u6cbf\u3063\u3066\u4f5c\u696d\u3057\u307e\u3059\u3002\n\n## gem \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n> &gt; gem install win32-service\n> Fetching: win32-api-1.4.8.gem (100%)\n> Building native extensions.  This could take a while...\n> ERROR:  Error installing win32-service:\n>         ERROR: Failed to build gem native extension.\n> \n>         C:/App/ruby_1_9_3_p125/bin/ruby.exe extconf.rb\n> checking for strncpy_s()... *** extconf.rb failed ***\n> Could not create Makefile due to some reason, probably lack of\n> necessary libraries and/or headers.  Check the mkmf.log file for more\n> details.  You may need configuration options.\n> \n> Provided configuration options:\n>         --with-opt-dir\n\n\u3042\u3042\u3001\u305d\u3046\u3067\u3057\u305f\u305d\u3046\u3067\u3057\u305f\u3002\u30b3\u30f3\u30d1\u30a4\u30eb\u74b0\u5883\u304c\u3042\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n\u305d\u3053\u3067\u3001[Microsoft\u516c\u958b\u5148](http://www.microsoft.com/ja-jp/dev/express/default.aspx)\u304b\u3089 vc_web.exe\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001Visual C++ 2010 Express \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u305d\u3053\u305d\u3053\u6642\u9593\u3092\u8981\u3057\u307e\u3059\u3002\u9014\u4e2d\u3067\u5bdd\u3066\u307e\u3057\u305f\u3002\n\n[Microsoft Visual Stdio 2010 Express]-[Visual Studio \u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8]\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n> Setting environment for using Microsoft Visual Studio 2010 x86 tools.\n> \n> C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\VC>\n> cd c:\\App\\ruby_1_9_3_p125\\bin>\n> c:\\App\\ruby_1_9_3_p125\\bin>gem install win32-service\n> Building native extensions.  This could take a while...\n> Fetching: windows-api-0.4.1.gem (100%)\n> Fetching: windows-pr-1.2.1.gem (100%)\n> Fetching: win32-service-0.7.2.gem (100%)\n> Building native extensions.  This could take a while...\n> Successfully installed win32-api-1.4.8\n> Successfully installed windows-api-0.4.1\n> Successfully installed windows-pr-1.2.1\n> Successfully installed win32-service-0.7.2\n> 4 gems installed\n> Installing ri documentation for win32-api-1.4.8...\n> Installing ri documentation for windows-api-0.4.1...\n> Installing ri documentation for windows-pr-1.2.1...\n> Installing ri documentation for win32-service-0.7.2...\n> Installing RDoc documentation for win32-api-1.4.8...\n> Installing RDoc documentation for windows-api-0.4.1...\n> Installing RDoc documentation for windows-pr-1.2.1...\n> Installing RDoc documentation for win32-service-0.7.2...\n\n\u7121\u4e8b\u6210\u529f\u3067\u3059\u3002Windows\u74b0\u5883\u306b\u304a\u3044\u3066extconf.rb\u95a2\u9023\u3067\u5931\u6557\u3059\u308b\u5834\u5408\u306f\u5927\u62b5\u3053\u308c\u3067\u4f55\u3068\u304b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u3067\u3082nokogiri\u306fcygwin\u304bmingw\u3067\u3057\u304b\u30c0\u30e1\u3063\u307d\u3044\u3067\u3059\u3002\n\n## Windows\u306e\u30b5\u30fc\u30d3\u30b9\u306b\u767b\u9332\n\n> &gt; ruby bin\\rsense service create\n> C:/App/ruby_1_9_3_p125/lib/ruby/gems/1.9.1/gems/windows-pr-1.2.1/lib/windows/err\n> or.rb:435:in \\`strip': invalid byte sequence in US-ASCII (ArgumentError)\n>         from C:/App/ruby_1_9_3_p125/lib/ruby/gems/1.9.1/gems/windows-pr-1.2.1/li\n> b/windows/error.rb:435:in \\`get_last_error'\n>         from C:/App/ruby_1_9_3_p125/lib/ruby/gems/1.9.1/gems/win32-service-0.7.2\n> /lib/win32/service.rb:368:in \\`initialize'\n>         from bin/rsense:228:in \\`new'\n>         from bin/rsense:228:in \\`exec_command'\n>         from bin/rsense:288:in \\`process'\n>         from bin/rsense:297:in \\`&lt;main&gt;'\n\nwindows-pr-1.2.1/lib/windows/error.rb\u3092\u898b\u308b\u3068\u30011.9\u7cfb\u306e\u30a8\u30f3\u30b3\u30fc\u30c9\u307d\u3044\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3044\u308b\u69d8\u5b50\u3002\u3053\u3053\u3067\u76ee\u7684\u3092\u898b\u5931\u3044\u306a\u304c\u3089\u9069\u5f53\u306b\u5bfe\u51e6\u3002\n\n```ruby:windows-pr-1.2.1/lib/windows/error.rb\ndef get_last_error(err_num = GetLastError.call)\n  buf   = 0.chr * 260\n  flags = FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_ARGUMENT_ARRAY\n  FormatMessageA.call(flags, 0, err_num, 0, buf, buf.size, 0)\n  #buf.strip\n  buf\nend\n```\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u767b\u9332\u306b\u5931\u6557\u3057\u3066\u3044\u308b\u306e\u306fUAC\u95a2\u9023\u3060\u308d\u3046\u3068\u8003\u3048\u3001\u7ba1\u7406\u8005\u6a29\u9650\u3067\u8d77\u52d5\u3057\u305fcmd.exe\u304b\u3089\u5b9f\u884c\u3057\u305f\u3068\u3053\u308d\u6210\u529f\u3067\u3059\u3002\n\n> &gt; ruby bin\\rsense service create\n> &gt;sc query rsense\n> \n> SERVICE_NAME: rsense\n>         TYPE               : 10  WIN32_OWN_PROCESS\n>         STATE              : 1  STOPPED\n>         WIN32_EXIT_CODE    : 1077  (0x435)\n>         SERVICE_EXIT_CODE  : 0  (0x0)\n>         CHECKPOINT         : 0x0\n>         WAIT_HINT          : 0x0\n\n\u3067\u3082\u8d77\u52d5\u3057\u306a\u3044\u3002\n\n> net start RSense\n> \u30b7\u30b9\u30c6\u30e0 \u30a8\u30e9\u30fc 2 \u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n> \n> \u6307\u5b9a\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\n\n\n\u307e\u305a\u306fWindows\u30b5\u30fc\u30d3\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u304b\u3089\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570\u3092\u78ba\u8a8d\u3002\n\n> rubyw.exe z:/tmp/20120711/rsense-0.3/bin/rsense --config=C:\\home\\tamoot/.rsense\n\nrubyw.exe\u304c\u30d5\u30eb\u30d1\u30b9\u3067\u306f\u306a\u3044+PATH\u304c\u901a\u3063\u3066\u3044\u306a\u3044\u305f\u3081\u3001rubyw.exe\u304c\u898b\u3064\u304b\u3089\u305a\u5931\u6557\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u30bd\u30fc\u30b9\u304b\u3089\u3082\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002\n\n```ruby:win32-service-0.7.2/lib/win32/service.rb\nwhen 'create'\n  path = Pathname.new(@rsense_home).realpath\n  command = Shellwords.unshellwords %W(rubyw.exe #{path}/bin/rsense --config=#@config service daemon)\n  Win32::Service.create(:service_name       => SERVICE_NAME,\n                        :service_type       => Win32::Service::WIN32_OWN_PROCESS,\n                        :description        => 'RSense Service',\n                        :start_type         => Win32::Service::DEMAND_START,\n                        :binary_path_name   => command,\n                        :display_name       => 'RSense')\n```\n\nrubyw.exe\u306b\u3064\u3044\u3066\u3068\u308a\u3042\u3048\u305a\u30d5\u30eb\u30d1\u30b9\u8a18\u8f09\u3057\u3001\u518d\u5ea6\u30b5\u30fc\u30d3\u30b9\u767b\u9332\u30fb\u8d77\u52d5\u306f\u6210\u529f\u3057\u307e\u3057\u305f\uff01(\u9577\u304b\u3063\u305f)\n\n\u3067\u306f\u3053\u3053\u3067\u7126\u3089\u305a\u3001\u958b\u3044\u3066\u3044\u308b\u30dd\u30fc\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n> z:\\tmp\\20120711\\rsense-0.3>tasklist /v | findstr rubyw\n> rubyw.exe                     3332 Services                   0     10,184 K Unk\n> nown         NT AUTHORITY\\SYSTEM                                     0:00:02 N/A\n> z:\\tmp\\20120711\\rsense-0.3>netstat -aon | findstr 3332\n> TCP    127.0.0.1:11831        0.0.0.0:0              LISTENING       3332\n\n\u3042\u308c?11831\u30dd\u30fc\u30c8\u304c\u958b\u3044\u3066\u3044\u308b\u3002\u30bd\u30fc\u30b9\u3092\u898b\u3066\u3082\u300111831\u3068\u3044\u3046\u6307\u5b9a\u306f\u7121\u3044\u306a\u30fb\u30fb\u30fb\u6848\u306e\u5b9a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u304b\u3089\u3064\u306a\u304c\u3063\u3066\u3044\u306a\u3044\u69d8\u5b50\u3002\n\n\u3068\u3053\u3053\u3067\u4f53\u529b\u304c\u5207\u308c\u307e\u3057\u305f\u3002\u4eca\u5f8c\u8ffd\u8a18\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n# \u3053\u3053\u307e\u3067\u306e\u307e\u3068\u3081\n\n* RSense\u81ea\u4f53\u306f\u7c21\u5358\n* Ruby 1.9.3 + Windows\u3067\u30b5\u30fc\u30d3\u30b9\u767b\u9332\u3057\u3088\u3046\u3068\u601d\u3046\u3068\u3061\u3087\u3063\u3068\u9762\u5012\n\n\n## \u8aac\u660e\u3057\u3066\u306a\u3044\u3068\u3053\u308d\n\nWindows\u3067RSense\u3092\u5229\u7528\u53ef\u80fd\u306a\u30a8\u30c7\u30a3\u30bf\u9054\n\n* gvim, emacs: [\u30e6\u30fc\u30b6\u30fc\u30de\u30cb\u30e5\u30a2\u30eb](http://cx4a.org/software/rsense/manual.ja.html#Emacs.E6.8B.A1.E5.BC.B5.E3.81.AE.E3.82.A4.E3.83.B3.E3.82.B9.E3.83.88.E3.83.BC.E3.83.AB)\n* xyzzy: [Ruby\u958b\u767a\u652f\u63f4\u30c4\u30fc\u30ebRSense\u3092xyzzy\u304b\u3089\u4f7f\u3063\u3066\u307f\u305f\u306e\u5dfb](http://d.hatena.ne.jp/aike/20100418)\n* \u79c0\u4e38: [Ruby\u958b\u767a\u652f\u63f4\u30c4\u30fc\u30ebRSense\u3092\u79c0\u4e38\u304b\u3089\u4f7f\u3063\u3066\u307f\u305f\u306e\u5dfb](http://d.hatena.ne.jp/aike/20100325)\n* redcar: [\u30d7\u30e9\u30b0\u30a4\u30f3](https://github.com/Samsinite/rsense)\n\nRSense\u5c0e\u5165\u306e\u6577\u5c45\u3092\u4e0b\u3052\u3066\u3001\u793e\u5185\u3067\u4f7f\u3063\u3066\u3082\u3089\u3048\u308c\u3070\u30b3\u30d4\u30da\u5168\u76db\u671f\u306e\u73fe\u5728\u3088\u308a\u306f\u30de\u30b7\u306b\u306a\u308b\u306e\u306b\u306a\u30fc\u3068\u601d\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n", "tags": ["Ruby", "\u958b\u767a\u74b0\u5883", "AdventCalendar", "Windows"]}