{"context": "\n\n\u6982\u8981\nraspberry pi 1 model b\u306e\u3001node-red\u3067\u3001\u30b2\u30fc\u30e0\u3057\u3066\u307f\u305f\u3002\n\u4ed5\u639b\u3051\u306f\u3001\n\u3000\u307e\u305a\u3001jsdo\u3067\u30d7\u30ed\u30c8\u30bf\u30a4\u30d4\u30f3\u30b0\u3002\n\u3000\u5165\u529b\u306f\u3001\u30b9\u30a4\u30c3\u30c1\uff11\u500b\u3001\u8868\u793a\u306f\u3001OLED\u3002\n\u3000\u30d5\u30ed\u30fc\u5185\u3067\u30b9\u30b3\u30fc\u30d7\u306a\u5909\u6570\u3001content.flow\u4f7f\u3063\u3066\u308b\u3002\n\u3000exec \u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3001python\u306b\u5f15\u6570\u3092\u4e0e\u3048\u3066\u308b\u3002\n\n\u958b\u767a\u74b0\u5883\nraspberry pi 1 model b\nraspbian 2016_09_23 jessie lite\n\n\u5199\u771f\n\n\n\u52d5\u753b\nhttps://www.youtube.com/watch?v=YQItdvvzN2M\n\n\u30d7\u30ed\u30c8\u30bf\u30a4\u30d4\u30f3\u30b0\nhttp://jsdo.it/ohisama1/Qt7D\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n[{\"id\":\"2f69734f.48286c\",\"type\":\"exec\",\"z\":\"4f4f703e.a2a9d\",\"command\":\"sudo python /home/pi/py/pong.py\",\"addpay\":true,\"append\":\"\",\"useSpawn\":\"\",\"timer\":\"\",\"name\":\"pong\",\"x\":128,\"y\":1576.5,\"wires\":[[\"ec949010.86b94\"],[],[]]},{\"id\":\"11c22c0f.285334\",\"type\":\"rpi-gpio in\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"gpio17\",\"pin\":\"11\",\"intype\":\"up\",\"debounce\":\"200\",\"read\":true,\"x\":67,\"y\":1183,\"wires\":[[\"7d016083.ab7d8\"]]},{\"id\":\"fa3ed4cc.c6ce88\",\"type\":\"inject\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"\",\"topic\":\"\",\"payload\":\"\",\"payloadType\":\"date\",\"repeat\":\"\",\"crontab\":\"\",\"once\":false,\"x\":103,\"y\":1298,\"wires\":[[\"4e61184f.06e028\",\"d6368de3.d8471\"]]},{\"id\":\"4e61184f.06e028\",\"type\":\"function\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"setup\",\"func\":\"context.flow.set('x', 64);\\ncontext.flow.set('y', 0);\\ncontext.flow.set('dx', -4);\\ncontext.flow.set('dy', -4);\\ncontext.flow.set('z', 54);\\ncontext.flow.set('pressed', 1);\\ncontext.flow.set('game', 1);\\nreturn msg;\",\"outputs\":1,\"noerr\":0,\"x\":272,\"y\":1299,\"wires\":[[\"e60ff8b.ae56608\"]]},{\"id\":\"e60ff8b.ae56608\",\"type\":\"switch\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"owari\",\"property\":\"game\",\"propertyType\":\"flow\",\"rules\":[{\"t\":\"eq\",\"v\":\"1\",\"vt\":\"num\"},{\"t\":\"neq\",\"v\":\"1\",\"vt\":\"num\"}],\"checkall\":\"true\",\"outputs\":2,\"x\":202,\"y\":1386,\"wires\":[[\"a38ac590.71af58\"],[\"7fd95f20.43153\",\"92a7c74a.5a0e68\"]]},{\"id\":\"a38ac590.71af58\",\"type\":\"function\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"press check\",\"func\":\"var pressed = context.flow.get('pressed') || 0;\\nvar x = context.flow.get('x') || 0;\\nvar y = context.flow.get('y') || 0;\\nvar dx = context.flow.get('dx') || 0;\\nvar dy = context.flow.get('dy') || 0;\\nvar z = context.flow.get('z') || 0;\\n\\nif (x + dx > 128 - 3 || x + dx < 3)\\n{\\n    dx = -dx;\\n}\\nif (y + dy < 3)\\n{\\n    dy = -dy;\\n}\\nelse if (y + dy > 64 - 3)\\n{\\n    if (x > z && x < z + 20)\\n    {\\n        dy = -dy;\\n    }\\n    else\\n    {\\n        context.flow.set('game', 0);\\n        msg.payload = [\\\"stop\\\"];\\n    }\\n}\\nif (pressed == '0' && z < 128 - 20) \\n{\\n    z += 6;\\n}\\nelse if (z > 0) \\n{\\n    z -= 6;\\n}\\nx += dx;\\ny += dy;    \\ncontext.flow.set('x', x);\\ncontext.flow.set('y', y);\\ncontext.flow.set('dx', dx);\\ncontext.flow.set('dy', dy);\\ncontext.flow.set('z', z);\\nmsg.payload = [x, y, z];\\nreturn msg;\\n\\n\",\"outputs\":1,\"noerr\":0,\"x\":133,\"y\":1491,\"wires\":[[\"2f69734f.48286c\"]]},{\"id\":\"7fd95f20.43153\",\"type\":\"debug\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"\",\"active\":true,\"console\":\"false\",\"complete\":\"false\",\"x\":401,\"y\":1406,\"wires\":[]},{\"id\":\"7d016083.ab7d8\",\"type\":\"function\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"pressed\",\"func\":\"var v = msg.payload;\\ncontext.flow.set('pressed', v);\\nreturn msg;\",\"outputs\":1,\"noerr\":0,\"x\":272,\"y\":1186,\"wires\":[[\"7fd95f20.43153\"]]},{\"id\":\"ec949010.86b94\",\"type\":\"delay\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"\",\"pauseType\":\"delay\",\"timeout\":\"50\",\"timeoutUnits\":\"milliseconds\",\"rate\":\"1\",\"rateUnits\":\"second\",\"randomFirst\":\"1\",\"randomLast\":\"5\",\"randomUnits\":\"seconds\",\"drop\":false,\"x\":334,\"y\":1556,\"wires\":[[\"e60ff8b.ae56608\"]]},{\"id\":\"d6368de3.d8471\",\"type\":\"exec\",\"z\":\"4f4f703e.a2a9d\",\"command\":\"sudo aplay /home/pi/start.wav\",\"addpay\":true,\"append\":\"\",\"useSpawn\":\"\",\"timer\":\"\",\"name\":\"start\",\"x\":364,\"y\":1246.5,\"wires\":[[],[],[]]},{\"id\":\"92a7c74a.5a0e68\",\"type\":\"exec\",\"z\":\"4f4f703e.a2a9d\",\"command\":\"sudo aplay /home/pi/game0.wav\",\"addpay\":true,\"append\":\"\",\"useSpawn\":\"\",\"timer\":\"\",\"name\":\"over\",\"x\":393,\"y\":1358.5,\"wires\":[[],[],[]]}]\n\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nimport smbus\nimport sys\n\nargs = sys.argv\nlist = [int(item) for item in args[1].split(\",\")]\nx = list[0]\ny = list[1]\nz = list[2]\npx = [0] * 128 * 64\npx[x + 128 * y] = 1\npx[x + 1 + 128 * y] = 1\npx[x + 2 + 128 * y] = 1\npx[x + 128 + 128 * y] = 1\npx[x + 129 + 128 * y] = 1\npx[x + 130 + 128 * y] = 1\npx[x + 256 + 128 * y] = 1\npx[x + 257 + 128 * y] = 1\npx[x + 258 + 128 * y] = 1\nfor i in range(20):\n    for j in range(3):\n        px[z + i + 128 * (j + 61)] = 1\noled = smbus.SMBus(1)\nlist0 = [0x21, 0, 127, 0x22, 0, 7]\nfor k in list0:\n    block = []\n    block.append(k)\n    oled.write_i2c_block_data(0x3c, 0x0, block)\nstep = 1024\nbuf = [0] * 8 * step\nof = [0, 128, 256, 384, 512, 640, 768, 896]\nw = 128\nj = 0\nfor y in range(0, 8 * step, step):\n    i = y + w - 1\n    while i >= y:\n        buf[j] = (px[i] & 0x01) | (px[i + of[1]] & 0x01) << 1 | (px[i + of[2]] & 0x01) << 2 | (px[i + of[3]] & 0x01) << 3 | (px[i + of[4]] & 0x01) << 4 | (px[i + of[5]] & 0x01) << 5 | (px[i + of[6]] & 0x01) << 6 | (px[i + of[7]] & 0x01) << 7\n        i -= 1\n        j += 1\nfor i in range(64):\n    block = []\n    for j in range(16):\n        b = i * 16 + j\n        block.append(buf[b])\n    oled.write_i2c_block_data(0x3c, 0x40, block)\nprint(\"ok\")\n\n\n#\u6982\u8981\nraspberry pi 1 model b\u306e\u3001node-red\u3067\u3001\u30b2\u30fc\u30e0\u3057\u3066\u307f\u305f\u3002\n\u4ed5\u639b\u3051\u306f\u3001\n\u3000\u307e\u305a\u3001jsdo\u3067\u30d7\u30ed\u30c8\u30bf\u30a4\u30d4\u30f3\u30b0\u3002\n\u3000\u5165\u529b\u306f\u3001\u30b9\u30a4\u30c3\u30c1\uff11\u500b\u3001\u8868\u793a\u306f\u3001OLED\u3002\n\u3000\u30d5\u30ed\u30fc\u5185\u3067\u30b9\u30b3\u30fc\u30d7\u306a\u5909\u6570\u3001content.flow\u4f7f\u3063\u3066\u308b\u3002\n\u3000exec \u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3001python\u306b\u5f15\u6570\u3092\u4e0e\u3048\u3066\u308b\u3002\n\n#\u958b\u767a\u74b0\u5883\nraspberry pi 1 model b\nraspbian 2016_09_23 jessie lite\n\n#\u5199\u771f\n![MVC-013S.JPG](https://qiita-image-store.s3.amazonaws.com/0/18104/d05b1914-4486-5638-44fe-0db4780c3eb7.jpeg)\n\n\n#\u52d5\u753b\nhttps://www.youtube.com/watch?v=YQItdvvzN2M\n\n#\u30d7\u30ed\u30c8\u30bf\u30a4\u30d4\u30f3\u30b0\nhttp://jsdo.it/ohisama1/Qt7D\n\n#\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n![pong.JPG](https://qiita-image-store.s3.amazonaws.com/0/18104/49ffe4ca-6c1f-1ef9-457b-6edb6de36c91.jpeg)\n\n\n```\n[{\"id\":\"2f69734f.48286c\",\"type\":\"exec\",\"z\":\"4f4f703e.a2a9d\",\"command\":\"sudo python /home/pi/py/pong.py\",\"addpay\":true,\"append\":\"\",\"useSpawn\":\"\",\"timer\":\"\",\"name\":\"pong\",\"x\":128,\"y\":1576.5,\"wires\":[[\"ec949010.86b94\"],[],[]]},{\"id\":\"11c22c0f.285334\",\"type\":\"rpi-gpio in\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"gpio17\",\"pin\":\"11\",\"intype\":\"up\",\"debounce\":\"200\",\"read\":true,\"x\":67,\"y\":1183,\"wires\":[[\"7d016083.ab7d8\"]]},{\"id\":\"fa3ed4cc.c6ce88\",\"type\":\"inject\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"\",\"topic\":\"\",\"payload\":\"\",\"payloadType\":\"date\",\"repeat\":\"\",\"crontab\":\"\",\"once\":false,\"x\":103,\"y\":1298,\"wires\":[[\"4e61184f.06e028\",\"d6368de3.d8471\"]]},{\"id\":\"4e61184f.06e028\",\"type\":\"function\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"setup\",\"func\":\"context.flow.set('x', 64);\\ncontext.flow.set('y', 0);\\ncontext.flow.set('dx', -4);\\ncontext.flow.set('dy', -4);\\ncontext.flow.set('z', 54);\\ncontext.flow.set('pressed', 1);\\ncontext.flow.set('game', 1);\\nreturn msg;\",\"outputs\":1,\"noerr\":0,\"x\":272,\"y\":1299,\"wires\":[[\"e60ff8b.ae56608\"]]},{\"id\":\"e60ff8b.ae56608\",\"type\":\"switch\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"owari\",\"property\":\"game\",\"propertyType\":\"flow\",\"rules\":[{\"t\":\"eq\",\"v\":\"1\",\"vt\":\"num\"},{\"t\":\"neq\",\"v\":\"1\",\"vt\":\"num\"}],\"checkall\":\"true\",\"outputs\":2,\"x\":202,\"y\":1386,\"wires\":[[\"a38ac590.71af58\"],[\"7fd95f20.43153\",\"92a7c74a.5a0e68\"]]},{\"id\":\"a38ac590.71af58\",\"type\":\"function\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"press check\",\"func\":\"var pressed = context.flow.get('pressed') || 0;\\nvar x = context.flow.get('x') || 0;\\nvar y = context.flow.get('y') || 0;\\nvar dx = context.flow.get('dx') || 0;\\nvar dy = context.flow.get('dy') || 0;\\nvar z = context.flow.get('z') || 0;\\n\\nif (x + dx > 128 - 3 || x + dx < 3)\\n{\\n    dx = -dx;\\n}\\nif (y + dy < 3)\\n{\\n    dy = -dy;\\n}\\nelse if (y + dy > 64 - 3)\\n{\\n    if (x > z && x < z + 20)\\n    {\\n        dy = -dy;\\n    }\\n    else\\n    {\\n        context.flow.set('game', 0);\\n        msg.payload = [\\\"stop\\\"];\\n    }\\n}\\nif (pressed == '0' && z < 128 - 20) \\n{\\n    z += 6;\\n}\\nelse if (z > 0) \\n{\\n    z -= 6;\\n}\\nx += dx;\\ny += dy;    \\ncontext.flow.set('x', x);\\ncontext.flow.set('y', y);\\ncontext.flow.set('dx', dx);\\ncontext.flow.set('dy', dy);\\ncontext.flow.set('z', z);\\nmsg.payload = [x, y, z];\\nreturn msg;\\n\\n\",\"outputs\":1,\"noerr\":0,\"x\":133,\"y\":1491,\"wires\":[[\"2f69734f.48286c\"]]},{\"id\":\"7fd95f20.43153\",\"type\":\"debug\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"\",\"active\":true,\"console\":\"false\",\"complete\":\"false\",\"x\":401,\"y\":1406,\"wires\":[]},{\"id\":\"7d016083.ab7d8\",\"type\":\"function\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"pressed\",\"func\":\"var v = msg.payload;\\ncontext.flow.set('pressed', v);\\nreturn msg;\",\"outputs\":1,\"noerr\":0,\"x\":272,\"y\":1186,\"wires\":[[\"7fd95f20.43153\"]]},{\"id\":\"ec949010.86b94\",\"type\":\"delay\",\"z\":\"4f4f703e.a2a9d\",\"name\":\"\",\"pauseType\":\"delay\",\"timeout\":\"50\",\"timeoutUnits\":\"milliseconds\",\"rate\":\"1\",\"rateUnits\":\"second\",\"randomFirst\":\"1\",\"randomLast\":\"5\",\"randomUnits\":\"seconds\",\"drop\":false,\"x\":334,\"y\":1556,\"wires\":[[\"e60ff8b.ae56608\"]]},{\"id\":\"d6368de3.d8471\",\"type\":\"exec\",\"z\":\"4f4f703e.a2a9d\",\"command\":\"sudo aplay /home/pi/start.wav\",\"addpay\":true,\"append\":\"\",\"useSpawn\":\"\",\"timer\":\"\",\"name\":\"start\",\"x\":364,\"y\":1246.5,\"wires\":[[],[],[]]},{\"id\":\"92a7c74a.5a0e68\",\"type\":\"exec\",\"z\":\"4f4f703e.a2a9d\",\"command\":\"sudo aplay /home/pi/game0.wav\",\"addpay\":true,\"append\":\"\",\"useSpawn\":\"\",\"timer\":\"\",\"name\":\"over\",\"x\":393,\"y\":1358.5,\"wires\":[[],[],[]]}]\n\n```\n\n#\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n```\nimport smbus\nimport sys\n\nargs = sys.argv\nlist = [int(item) for item in args[1].split(\",\")]\nx = list[0]\ny = list[1]\nz = list[2]\npx = [0] * 128 * 64\npx[x + 128 * y] = 1\npx[x + 1 + 128 * y] = 1\npx[x + 2 + 128 * y] = 1\npx[x + 128 + 128 * y] = 1\npx[x + 129 + 128 * y] = 1\npx[x + 130 + 128 * y] = 1\npx[x + 256 + 128 * y] = 1\npx[x + 257 + 128 * y] = 1\npx[x + 258 + 128 * y] = 1\nfor i in range(20):\n    for j in range(3):\n        px[z + i + 128 * (j + 61)] = 1\noled = smbus.SMBus(1)\nlist0 = [0x21, 0, 127, 0x22, 0, 7]\nfor k in list0:\n    block = []\n    block.append(k)\n    oled.write_i2c_block_data(0x3c, 0x0, block)\nstep = 1024\nbuf = [0] * 8 * step\nof = [0, 128, 256, 384, 512, 640, 768, 896]\nw = 128\nj = 0\nfor y in range(0, 8 * step, step):\n    i = y + w - 1\n    while i >= y:\n        buf[j] = (px[i] & 0x01) | (px[i + of[1]] & 0x01) << 1 | (px[i + of[2]] & 0x01) << 2 | (px[i + of[3]] & 0x01) << 3 | (px[i + of[4]] & 0x01) << 4 | (px[i + of[5]] & 0x01) << 5 | (px[i + of[6]] & 0x01) << 6 | (px[i + of[7]] & 0x01) << 7\n        i -= 1\n        j += 1\nfor i in range(64):\n    block = []\n    for j in range(16):\n        b = i * 16 + j\n        block.append(buf[b])\n    oled.write_i2c_block_data(0x3c, 0x40, block)\nprint(\"ok\")\n\n```\n\n\n\n", "tags": ["RaspberryPi", "node-red", "game", "oled", "Python"]}