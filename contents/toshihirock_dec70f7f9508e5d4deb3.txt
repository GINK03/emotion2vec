{"context": " More than 1 year has passed since last update.AWS\u306eVPC\u5185\u3067\u4f7f\u308f\u308c\u3066\u3044\u308b\u5185\u90e8\u306e\u540d\u524d\u89e3\u6c7a\u3092bind\u304b\u3089Route53\u306ePrivate DNS\u5bfe\u5fdc\u3078\u306e\u79fb\u884c\u3092\u3059\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u3084\u3063\u305f\u3053\u3068\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u305f\u6642\u306e\u4f5c\u696d\u30e1\u30e2\u3002\n\n\u6e96\u5099\nCloudFormation\u3067VPC\u7a7a\u9593\u3092\u5225\u3067\u4f5c\u3063\u3066\u304a\u304f\n\u4ee5\u524d\u306e\u8a18\u4e8b\u306e\u3082\u306e\u3092\u5229\u7528\u3002\nVPC S3\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u4f7f\u3063\u3066\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30b5\u30d6\u30cd\u30c3\u30c8\u304b\u3089S3\u3078\u63a5\u7d9a\u3059\u308b\n\nbind\u3067\u540d\u524d\u89e3\u6c7a\u3057\u3066\u307f\u308b\n\nEC2\u4e0a\u3067\u5185\u90e8\u5411\u3051DNS\u3092\u69cb\u7bc9\u3057\u3066\u307f\u308b\n\n\u65b0\u898f\u306bEC2\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u672cEC2\u306b\u8a2d\u5b9a\u3059\u308bSecurityGroup\u306eInbound\u3067DNS(UDP)\u3068DNS(TCP)\u306e\u63a5\u7d9a\u8a31\u53ef\u3092\u884c\u3046\u8a2d\u5b9a\u306b\u3057\u3066\u4e0b\u3055\u3044\u3002\nhttpd\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u78ba\u8a8d\n$ sudo yum update -y\n$ sudo yum install httpd -y\n$ echo \"hogeee\" | sudo tee /var/www/html/index.html\n$ sudo service httpd start\n$ sudo chkconfig httpd on\n$ curl http://localhost\nhogeee\n\nbind\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3057\u3001\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n$sudo yum install bind -y\n$sudo cp /etc/named.conf /etc/named.conf.org\n\nnamed.conf\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n172.31.22.115 \u306e\u90e8\u5206\u306f\u81ea\u8eab\u306eEC2\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n/etc/named.conf\noptions {\n- listen-on port 53 { 127.0.0.1; };\n+ listen-on port 53 { 127.0.0.1; 172.31.22.115};\n\n- allow-query     { localhost; };\n+ allow-query     { any; };\n\n+ forwarders {  8.8.8.8; 8.8.4.4; };\n+ forward only;\n};\n\n+ zone \"example.com\" IN {\n+  type master;\n+  file \"master.example.com\";\n+ };\n\n\n\u6b21\u306b\u4e0a\u8a18\u304b\u3089\u53c2\u7167\u3059\u308bmaster.example.com\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n/var/named/master.example.com\n$TTL 43200\nexample.com.     IN      SOA    help.example.com. ns01.example.com. (\n                            1 ; serial\n                            21600      ; refresh (6 hours)\n                            7200       ; retry (2 hours)\n                            1209600    ; expire (2 weeks)\n                            43200)      ; minimum (12 hours)\n\nexample.com.            NS      ns01.example.com.\nns01                    A       [EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306ePrivateIP]\nwww                    A       [EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306ePublicIP]\n\n\nbind\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n$sudo service named start\n\nresolve.conf\u3092\u5909\u66f4\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u306ebind\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n$sudo cp /etc/resolv.conf /etc/resolv.conf.org\n\n\n/etc/resolve.conf\nsearch ap-northeast-1.compute.internal\nnameserver 127.0.0.1\n\n\nresolve.conf\u304c\u518d\u8d77\u52d5\u6642\u306b\u52dd\u624b\u306b\u66f8\u304d\u63db\u308f\u3089\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306bPEERDNS=yes\u3092PEERDNS=no\u306b\u5909\u66f4\u3057\u307e\u3059\nAmazon EC2(Linux)\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u3067\u30cf\u30de\u3063\u305f\u3068\u304d\u306b\u898b\u308b\u30e1\u30e2\n$sudo sed -i 's/PEERDNS=yes/PEERDNS=NO/g' /etc/sysconfig/network-scripts/ifcfg-eth0\n\n\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$host ns01.example.com\nns01.example.com has address 172.31.18.72\n\n$ curl http://www.example.com\nhogeee\n\n\n\u4ed6\u306eEC2\u304b\u3089\u306e\u78ba\u8a8d\n\u65b0\u898f\u306bEC2\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nssh\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u4ee5\u4e0b\u306e\u5bfe\u5fdc\u3092\u884c\u3044\u307e\u3059\u3002\nresolve.conf\u306e\u8a2d\u5b9a\u3002\n$sudo cp /etc/resolv.conf /etc/resolv.conf.org\n\n\n/etc/resolve.conf\nsearch ap-northeast-1.compute.internal\nnameserver {bind\u3092\u8a2d\u5b9a\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u306eprivate ip}\n\n\nresolve.conf\u304c\u81ea\u52d5\u3067\u5909\u308f\u3089\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u3002\n$sudo sed -i 's/PEERDNS=yes/PEERDNS=NO/g' /etc/sysconfig/network-scripts/ifcfg-eth0\n\n\u78ba\u8a8d\u3002\n$host www.example.com\nwww.example.com has address 54.64.244.146\n\n$url http://www.example.com\nhogeee\n\n\u554f\u984c\u306a\u3051\u308c\u3070\u3001bind\u304c\u5165\u3063\u3066\u3044\u306a\u3044\u30b5\u30fc\u30d0\u30fc\u306fterminate\u3057\u307e\u3059\u3002\nbind\u304c\u5165\u3063\u3066\u3044\u308b\u30b5\u30fc\u30d0\u30fc\u3067\u306f\u4ee5\u4e0b\u3092\u884c\u3044\u307e\u3059\u3002\n\nbind\u30b5\u30fc\u30d3\u30b9\u306e\u505c\u6b62\nresolve.conf\u3068ifcfg-eth0\u306e\u8a2d\u5b9a\u3092\u5143\u306b\u623b\u3059\n\n\nbind\u306e\u60c5\u5831\u3092Route53\u306b\u624b\u52d5\u3067\u79fb\u884c\u3059\u308b\nRoute53\u7de8\uff5ePrivate DNS\uff5e\nRoute53\u3067HostedZones\u3092\u65b0\u898f\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nDomainName->example.com\nType->PrivateHostedZone for Amzon VPC\nVPC ID->CloudFormation\u3067\u4f5c\u6210\u3057\u305fVPC\n\n\u6b21\u306bA\u30ec\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nName->www.example.com\n\nType->IPv4 address\nValue->{httpd\u30b5\u30fc\u30d0\u30fc\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP}\n\nVPC\u3067DHCP options set\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002ap-northeast-1.compute.internal\u3068example.com\u3068\u306e\u9593\u306e\u30b9\u30da\u30fc\u30b9\u306b\u6ce8\u610f\u3002\n\nDomain name->ap-northeast-1.compute.internal example.com\nDomain name servers->AmazonProvidedDNS\n\n\u4f5c\u6210\u3057\u305fDHCP options set\u3092VPC\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001VPC\u3067\u4ee5\u4e0b\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nDNS resolution=yes\nDNS hostname=yes\n\nEC2(httpd)\u3092reboot\u3057\u3001ssh\u30ed\u30b0\u30a4\u30f3\u3057\u3001resolve.conf\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n/etc/resolve.conf\n; generated by /sbin/dhclient-script\nsearch ap-northeast-1.compute.internal example.com\nnameserver 10.1.0.2\n\n\nRoute53\u3092\u4f7f\u3063\u3066\u540d\u524d\u89e3\u6c7a\u304c\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$host www.example.com\nwww.example.com has address 10.1.11.189\n\n$curl www.example.com\nhogeee\n\n\u540d\u524d\u304c\u5f15\u3051\u3066Web\u30b5\u30a4\u30c8\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\nimport\u6a5f\u80fd\u3092\u4f7f\u3063\u3066Bind\u304b\u3089Route53\u3078\u79fb\u884c\u3059\u308b\nAmazon Route 53(DNS\u30b5\u30fc\u30d3\u30b9)\u306bBIND\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\nA\u30ec\u30b3\u30fc\u30c9\u304c\u6570\u4ef6\u3067\u3042\u308c\u3070\u3001\u624b\u52d5\u3067\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u4ef6\u6570\u304c\u591a\u3044\u5834\u5408\u306b\u5927\u5909\u3067\u3059\u3002\n\u4e0a\u8a18\u306b\u5bfe\u5fdc\u3067\u304d\u308b\u3088\u3046\u306bbind\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u308a\u8fbc\u3081\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u305d\u306e\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\u306a\u304a\u3001SOA\u3068NS\u30ec\u30b3\u30fc\u30c9\u306f\u5bfe\u5fdc\u5916\u306e\u3088\u3046\u3067\u3059\uff08import\u306e\u969b\u306b\u3042\u3063\u3066\u3082\u826f\u3044\u304c\u7121\u8996\u3055\u308c\u308b\uff09\n\u307e\u3059\u3001\u5148\u307b\u3069\u767b\u9332\u3057\u305fRoute53\u306eA\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u6b21\u306bEC2\u306bssh\u30ed\u30b0\u30a4\u30f3\u3057\u3001\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$curl http://www.example.com\ncurl: (6) Could not resolve host: www.example.com\n\n\u6b21\u306b\u5148\u307b\u3069bind\u3092\u7acb\u3066\u305f\u30b5\u30fc\u30d0\u30fc\u306e/var/named/master.example.com\u306e\u5185\u5bb9\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\u306a\u304a\n\nmaster.example.com\nns01                    A       {Private IP}\n\n\n\u3068\u3044\u3046\u90e8\u5206\u306fbind\u306e\u30db\u30b9\u30c8\u540d\u3060\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u4e0d\u8981\u3068\u306a\u308b\u306e\u3067\u3053\u306e\u884c\u306f\u524a\u9664\u3057\u307e\u3059\u3002\n\u4e0a\u8a18\u30b3\u30d4\u30fc\u3057\u305f\u3082\u306e\u3092\u3000Import Zone File \u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u307e\u3059\u3002\n\u5b8c\u4e86\u3059\u308b\u3068A\u30ec\u30b3\u30fc\u30c9\u304c1\u4ef6\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u3042\u3068EC2\u4e0a\u3067nslookup www.example.com\u3067\u540d\u524d\u5f15\u304d\u51fa\u6765\u308b\u304b\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u3046\u307e\u3044\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u3002\u3002\u305f\u3060\u3057\u3001reboot\u3057\u3066\u304b\u3089\u3060\u3068\u3046\u307e\u304f\u3067\u304d\u307e\u3057\u305f\u3002(\u3042\u3093\u307e\u308a\u8a73\u3057\u304f\u306a\u3044\u306e\u3067\u3059\u304c\u3001Linux\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067DNS\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u3057\u306a\u3044\u306e\u3067\u3059\u3050\u306b\u53cd\u6620\u3055\u308c\u308b\u3068\u601d\u3063\u305f\u306e\u3067\u3059\u304c\uff09\u8a66\u3057\u3066\u307e\u305b\u3093\u304c\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u518d\u8d77\u52d5\u306a\u3069\u3067\u3082\u3067\u304d\u305f\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n$curl http://www.example.com\nhoge\n\nAWS\u306eVPC\u5185\u3067\u4f7f\u308f\u308c\u3066\u3044\u308b\u5185\u90e8\u306e\u540d\u524d\u89e3\u6c7a\u3092bind\u304b\u3089Route53\u306ePrivate DNS\u5bfe\u5fdc\u3078\u306e\u79fb\u884c\u3092\u3059\u308b\u5fc5\u8981\u304c\u3042\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u3084\u3063\u305f\u3053\u3068\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u305f\u6642\u306e\u4f5c\u696d\u30e1\u30e2\u3002\n\n# \u6e96\u5099\n\nCloudFormation\u3067VPC\u7a7a\u9593\u3092\u5225\u3067\u4f5c\u3063\u3066\u304a\u304f\n\n\u4ee5\u524d\u306e\u8a18\u4e8b\u306e\u3082\u306e\u3092\u5229\u7528\u3002\n\n[VPC S3\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u4f7f\u3063\u3066\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30b5\u30d6\u30cd\u30c3\u30c8\u304b\u3089S3\u3078\u63a5\u7d9a\u3059\u308b](http://qiita.com/toshihirock/items/2ba42aed00a3331b8e7d)\n\n# bind\u3067\u540d\u524d\u89e3\u6c7a\u3057\u3066\u307f\u308b\n\n+ [EC2\u4e0a\u3067\u5185\u90e8\u5411\u3051DNS\u3092\u69cb\u7bc9\u3057\u3066\u307f\u308b](http://qiita.com/mechamogera/items/574de60310fb19e088ca)\n\n\u65b0\u898f\u306bEC2\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u672cEC2\u306b\u8a2d\u5b9a\u3059\u308bSecurityGroup\u306eInbound\u3067DNS(UDP)\u3068DNS(TCP)\u306e\u63a5\u7d9a\u8a31\u53ef\u3092\u884c\u3046\u8a2d\u5b9a\u306b\u3057\u3066\u4e0b\u3055\u3044\u3002\n\nhttpd\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u78ba\u8a8d\n\n```\n$ sudo yum update -y\n$ sudo yum install httpd -y\n$ echo \"hogeee\" | sudo tee /var/www/html/index.html\n$ sudo service httpd start\n$ sudo chkconfig httpd on\n$ curl http://localhost\nhogeee\n```\n\nbind\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3057\u3001\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n```\n$sudo yum install bind -y\n$sudo cp /etc/named.conf /etc/named.conf.org\n```\n\n`named.conf`\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n**172.31.22.115** \u306e\u90e8\u5206\u306f\u81ea\u8eab\u306eEC2\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\u306b\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n```lang:/etc/named.conf\noptions {\n- listen-on port 53 { 127.0.0.1; };\n+ listen-on port 53 { 127.0.0.1; 172.31.22.115};\n\n- allow-query     { localhost; };\n+ allow-query     { any; };\n\n+ forwarders {  8.8.8.8; 8.8.4.4; };\n+ forward only;\n};\n\n+ zone \"example.com\" IN {\n+  type master;\n+  file \"master.example.com\";\n+ };\n```\n\n\u6b21\u306b\u4e0a\u8a18\u304b\u3089\u53c2\u7167\u3059\u308b`master.example.com`\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```lang:/var/named/master.example.com\n$TTL 43200\nexample.com.     IN      SOA    help.example.com. ns01.example.com. (\n                            1 ; serial\n                            21600      ; refresh (6 hours)\n                            7200       ; retry (2 hours)\n                            1209600    ; expire (2 weeks)\n                            43200)      ; minimum (12 hours)\n\nexample.com.            NS      ns01.example.com.\nns01                    A       [EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306ePrivateIP]\nwww                    A       [EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306ePublicIP]\n```\n\nbind\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash\n$sudo service named start\n```\n\nresolve.conf\u3092\u5909\u66f4\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u306ebind\u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```bash\n$sudo cp /etc/resolv.conf /etc/resolv.conf.org\n```\n\n```lang:/etc/resolve.conf\nsearch ap-northeast-1.compute.internal\nnameserver 127.0.0.1\n```\nresolve.conf\u304c\u518d\u8d77\u52d5\u6642\u306b\u52dd\u624b\u306b\u66f8\u304d\u63db\u308f\u3089\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b`PEERDNS=yes`\u3092`PEERDNS=no`\u306b\u5909\u66f4\u3057\u307e\u3059\n\n[Amazon EC2(Linux)\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8a2d\u5b9a\u3067\u30cf\u30de\u3063\u305f\u3068\u304d\u306b\u898b\u308b\u30e1\u30e2](http://dev.classmethod.jp/cloud/ec2-linux-network-conf-tips/)\n\n```bash\n$sudo sed -i 's/PEERDNS=yes/PEERDNS=NO/g' /etc/sysconfig/network-scripts/ifcfg-eth0\n```\n\n\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$host ns01.example.com\nns01.example.com has address 172.31.18.72\n\n$ curl http://www.example.com\nhogeee\n```\n\n# \u4ed6\u306eEC2\u304b\u3089\u306e\u78ba\u8a8d\n\n\u65b0\u898f\u306bEC2\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nssh\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u4ee5\u4e0b\u306e\u5bfe\u5fdc\u3092\u884c\u3044\u307e\u3059\u3002\n\nresolve.conf\u306e\u8a2d\u5b9a\u3002\n\n```bash\n$sudo cp /etc/resolv.conf /etc/resolv.conf.org\n```\n\n```lang:/etc/resolve.conf\nsearch ap-northeast-1.compute.internal\nnameserver {bind\u3092\u8a2d\u5b9a\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u306eprivate ip}\n```\n\nresolve.conf\u304c\u81ea\u52d5\u3067\u5909\u308f\u3089\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u3002\n\n```bash\n$sudo sed -i 's/PEERDNS=yes/PEERDNS=NO/g' /etc/sysconfig/network-scripts/ifcfg-eth0\n```\n\n\u78ba\u8a8d\u3002\n\n```bash\n$host www.example.com\nwww.example.com has address 54.64.244.146\n\n$url http://www.example.com\nhogeee\n```\n\n\u554f\u984c\u306a\u3051\u308c\u3070\u3001bind\u304c\u5165\u3063\u3066\u3044\u306a\u3044\u30b5\u30fc\u30d0\u30fc\u306fterminate\u3057\u307e\u3059\u3002\n\nbind\u304c\u5165\u3063\u3066\u3044\u308b\u30b5\u30fc\u30d0\u30fc\u3067\u306f\u4ee5\u4e0b\u3092\u884c\u3044\u307e\u3059\u3002\n\n+ bind\u30b5\u30fc\u30d3\u30b9\u306e\u505c\u6b62\n+ resolve.conf\u3068ifcfg-eth0\u306e\u8a2d\u5b9a\u3092\u5143\u306b\u623b\u3059\n\n# bind\u306e\u60c5\u5831\u3092Route53\u306b\u624b\u52d5\u3067\u79fb\u884c\u3059\u308b\n\n[Route53\u7de8\uff5ePrivate DNS\uff5e](http://recipe.kc-cloud.jp/archives/7545)\n\nRoute53\u3067HostedZones\u3092\u65b0\u898f\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n+ DomainName->example.com\n+ Type->PrivateHostedZone for Amzon VPC\n+ VPC ID->CloudFormation\u3067\u4f5c\u6210\u3057\u305fVPC\n\n\u6b21\u306bA\u30ec\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n+ Name->www.example.com\n+ Type->IPv4 address\n+ Value->{httpd\u30b5\u30fc\u30d0\u30fc\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP}\n\nVPC\u3067DHCP options set\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002ap-northeast-1.compute.internal\u3068example.com\u3068\u306e\u9593\u306e\u30b9\u30da\u30fc\u30b9\u306b\u6ce8\u610f\u3002\n\n+ Domain name->ap-northeast-1.compute.internal example.com\n+ Domain name servers->AmazonProvidedDNS\n\n\u4f5c\u6210\u3057\u305fDHCP options set\u3092VPC\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u307e\u305f\u3001VPC\u3067\u4ee5\u4e0b\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n+ DNS resolution=yes\n+ DNS hostname=yes\n\nEC2(httpd)\u3092reboot\u3057\u3001ssh\u30ed\u30b0\u30a4\u30f3\u3057\u3001`resolve.conf`\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```/etc/resolve.conf\n; generated by /sbin/dhclient-script\nsearch ap-northeast-1.compute.internal example.com\nnameserver 10.1.0.2\n```\n\nRoute53\u3092\u4f7f\u3063\u3066\u540d\u524d\u89e3\u6c7a\u304c\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$host www.example.com\nwww.example.com has address 10.1.11.189\n\n$curl www.example.com\nhogeee\n```\n\n\u540d\u524d\u304c\u5f15\u3051\u3066Web\u30b5\u30a4\u30c8\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n# import\u6a5f\u80fd\u3092\u4f7f\u3063\u3066Bind\u304b\u3089Route53\u3078\u79fb\u884c\u3059\u308b\n\n[Amazon Route 53(DNS\u30b5\u30fc\u30d3\u30b9)\u306bBIND\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b](http://dev.classmethod.jp/etc/route53-import-zone-file/)\n\nA\u30ec\u30b3\u30fc\u30c9\u304c\u6570\u4ef6\u3067\u3042\u308c\u3070\u3001\u624b\u52d5\u3067\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u4ef6\u6570\u304c\u591a\u3044\u5834\u5408\u306b\u5927\u5909\u3067\u3059\u3002\n\n\u4e0a\u8a18\u306b\u5bfe\u5fdc\u3067\u304d\u308b\u3088\u3046\u306bbind\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u308a\u8fbc\u3081\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u305d\u306e\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u306a\u304a\u3001SOA\u3068NS\u30ec\u30b3\u30fc\u30c9\u306f\u5bfe\u5fdc\u5916\u306e\u3088\u3046\u3067\u3059\uff08import\u306e\u969b\u306b\u3042\u3063\u3066\u3082\u826f\u3044\u304c\u7121\u8996\u3055\u308c\u308b\uff09\n\n\u307e\u3059\u3001\u5148\u307b\u3069\u767b\u9332\u3057\u305fRoute53\u306eA\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\n\u6b21\u306bEC2\u306bssh\u30ed\u30b0\u30a4\u30f3\u3057\u3001\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$curl http://www.example.com\ncurl: (6) Could not resolve host: www.example.com\n```\n\n\u6b21\u306b\u5148\u307b\u3069bind\u3092\u7acb\u3066\u305f\u30b5\u30fc\u30d0\u30fc\u306e`/var/named/master.example.com`\u306e\u5185\u5bb9\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\n\u306a\u304a\n\n```master.example.com\nns01                    A       {Private IP}\n```\n\n\u3068\u3044\u3046\u90e8\u5206\u306fbind\u306e\u30db\u30b9\u30c8\u540d\u3060\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u4e0d\u8981\u3068\u306a\u308b\u306e\u3067\u3053\u306e\u884c\u306f\u524a\u9664\u3057\u307e\u3059\u3002\n\n\u4e0a\u8a18\u30b3\u30d4\u30fc\u3057\u305f\u3082\u306e\u3092\u3000**Import Zone File** \u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u3066\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u307e\u3059\u3002\n\n\n\u5b8c\u4e86\u3059\u308b\u3068A\u30ec\u30b3\u30fc\u30c9\u304c1\u4ef6\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u3042\u3068EC2\u4e0a\u3067`nslookup www.example.com`\u3067\u540d\u524d\u5f15\u304d\u51fa\u6765\u308b\u304b\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u3046\u307e\u3044\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u3002\u3002\u305f\u3060\u3057\u3001reboot\u3057\u3066\u304b\u3089\u3060\u3068\u3046\u307e\u304f\u3067\u304d\u307e\u3057\u305f\u3002(\u3042\u3093\u307e\u308a\u8a73\u3057\u304f\u306a\u3044\u306e\u3067\u3059\u304c\u3001Linux\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067DNS\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u3057\u306a\u3044\u306e\u3067\u3059\u3050\u306b\u53cd\u6620\u3055\u308c\u308b\u3068\u601d\u3063\u305f\u306e\u3067\u3059\u304c\uff09\u8a66\u3057\u3066\u307e\u305b\u3093\u304c\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u518d\u8d77\u52d5\u306a\u3069\u3067\u3082\u3067\u304d\u305f\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n```bash\n$curl http://www.example.com\nhoge\n```\n", "tags": ["AWS", "bind", "route53"]}