{"context": " More than 1 year has passed since last update.\n\nApp Transport Security(ATS) \u3068\u306f\nApple \u306e\u30b5\u30fc\u30d0\u5074\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u57fa\u6e96\u3002\nApple \u57fa\u6e96\u3092\u6e80\u305f\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u30b5\u30fc\u30d0\u63a5\u7d9a\u3067\u304d\u305a\u3001 An SSL error has occurred and a secure connection to the server cannot be made. \u307f\u305f\u3044\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u3002\n\n\u53c2\u8003\n\n\n[iOS 9] iOS 9 \u3067\u8ffd\u52a0\u3055\u308c\u305f App Transport Security \u306e\u6982\u8981 \uff5c Developers.IO\n\u63a5\u7d9a\u5148\u304cATS (App Transport Security)\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u304b\u3001\u307e\u305f\u306f\u4f8b\u5916\u306e\u8a2d\u5b9a\u3092nscurl\u30b3\u30de\u30f3\u30c9\u3067\u7c21\u5358\u306b\u8abf\u3079\u308b - 24/7 twenty-four seven\n\n\n\n\n\u8a2d\u5b9a\u3067\u56de\u907f\n\nhook \u3092\u4f5c\u6210\n\u8a2d\u5b9a\u3067\u56de\u907f\u3067\u304d\u308b\u305f\u3081\u3001Hooks Guide - Apache Cordova \u3092\u4f7f\u3044\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\u3002\nhook \u306f Cordova \u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u3001\u7279\u5b9a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3067\u304d\u308b\u4ed5\u7d44\u307f\u3002\n\u4eca\u56de\u306f after_prepare \u306b shell \u3092\u66f8\u3044\u305f\u3002\n\nproject_root/hooks/after_prepare/ios9-transport-security.sh\n#!/bin/bash\n\nPLIST=platforms/ios/*/*-Info.plist\n\ncat << EOF |\nAdd :NSAppTransportSecurity dict\nAdd :NSAppTransportSecurity:NSExceptionDomains dict\nAdd :NSAppTransportSecurity:NSExceptionDomains:dev.example.com dict\nAdd :NSAppTransportSecurity:NSExceptionDomains:dev.example.com:NSExceptionAllowsInsecureHTTPLoads bool YES\nAdd :NSAppTransportSecurity:NSExceptionDomains:dev.example.com:NSExceptionRequiresForwardSecrecy bool NO\nAdd :NSAppTransportSecurity:NSExceptionDomains:dev.example.com:NSExceptionMinimumTLSVersion string TLSv1.0\nAdd :NSAppTransportSecurity:NSExceptionDomains:production.example.com dict\nAdd :NSAppTransportSecurity:NSExceptionDomains:production.example.com:NSExceptionAllowsInsecureHTTPLoads bool YES\nAdd :NSAppTransportSecurity:NSExceptionDomains:production.example.com:NSExceptionRequiresForwardSecrecy bool NO\nAdd :NSAppTransportSecurity:NSExceptionDomains:production.example.com:NSExceptionMinimumTLSVersion string TLSv1.0\nEOF\nwhile read line\ndo\n    /usr/libexec/PlistBuddy -c \"$line\" $PLIST\ndone\n\ntrue\n\n\u306a\u304a\u3001 config.xml \u306b\u306f \u4ee5\u4e0b\u306e whitelist \u3092\u8a2d\u5b9a\u3057\u3066\u3042\u308b\u3002\n  <access origin=\"http://*.example.com\"/>\n  <access origin=\"https://*.example.com\"/>\n\n\ncordova prepare \u5f8c\u306e info.plist \u306e\u7d50\u679c\n..\u7565..\n    <key>NSAppTransportSecurity</key>\n    <dict>\n      <key>NSExceptionDomains</key>\n      <dict>\n        <key>example.com</key>\n        <dict>\n          <key>NSIncludesSubdomains</key>\n          <true/>\n        </dict>\n        <key>dev.example.com</key>\n        <dict>\n          <key>NSExceptionAllowsInsecureHTTPLoads</key>\n          <true/>\n          <key>NSExceptionMinimumTLSVersion</key>\n          <string>TLSv1.0</string>\n          <key>NSExceptionRequiresForwardSecrecy</key>\n          <false/>\n        </dict>\n        <key>production.example.com</key>\n        <dict>\n          <key>NSExceptionAllowsInsecureHTTPLoads</key>\n          <true/>\n          <key>NSExceptionMinimumTLSVersion</key>\n          <string>TLSv1.0</string>\n          <key>NSExceptionRequiresForwardSecrecy</key>\n          <false/>\n        </dict>\n      </dict>\n    </dict>\n..\u7565..\n\n\nPlugin \u3067\u56de\u907f\u3082\u3067\u304d\u308b\uff1f\nleecrossley/cordova-plugin-transport-security \u3068\u3044\u3046 plugin \u3082\u51fa\u3066\u3044\u3066\u3001 NSExceptionAllowsInsecureHTTPLoads \u3060\u3051\u3060\u3063\u305f\u3089\u3053\u308c\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n\u305f\u3060\u3057\u81ea\u5206\u306e\u5834\u5408\u306f\u3001\u7279\u5b9a\u306e URL \u3060\u3051\u306e\u8a2d\u5b9a\u3092\u3057\u305f\u304b\u3063\u305f\u306e\u3067\u3001\u4e0a\u8a18 Plugin \u3067\u306f\u30c0\u30e1\u3060\u3063\u305f\u3002\n\nhook \u3092\u4f5c\u3063\u305f\u7406\u7531\nPlugin \u306b NSExceptionDomains \u306e\u8a2d\u5b9a\u3092\u66f8\u304f\u3068\u3001access origin \u3068\u7af6\u5408\u3057\u3066\u3057\u307e\u3046\u3088\u3046\u3067\u3001 access origin \u304c\u512a\u5148\u3057\u3066\u4e0a\u66f8\u304d\u3057\u3066\u3057\u307e\u3046\uff1f\u3088\u3046\u306a\u73fe\u8c61\u304c\u8d77\u304d\u305f\u3002\n\u3053\u308c\u3067\u3060\u3044\u3076\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3057\u307e\u3063\u305f\u3002\n\u672c\u6765\u306a\u3089\u3070 Plugin \u306b <config-file target=\"*-Info.plist\" parent=\"NSAppTransportSecurity\"> \u3092\u66f8\u304f\u306e\u304c\u7b4b\u3060\u3068\u601d\u3046\u3001\u305f\u3060\u305d\u3046\u3059\u308b\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u306e\u3067 shell \u3092\u66f8\u3044\u305f\u6b21\u7b2c\u3002\n## App Transport Security(ATS) \u3068\u306f\n\nApple \u306e\u30b5\u30fc\u30d0\u5074\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u57fa\u6e96\u3002\nApple \u57fa\u6e96\u3092\u6e80\u305f\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u30b5\u30fc\u30d0\u63a5\u7d9a\u3067\u304d\u305a\u3001 `An SSL error has occurred and a secure connection to the server cannot be made.` \u307f\u305f\u3044\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u308b\u3002\n\n* \u53c2\u8003\n    * [[iOS 9] iOS 9 \u3067\u8ffd\u52a0\u3055\u308c\u305f App Transport Security \u306e\u6982\u8981 \uff5c Developers.IO](http://dev.classmethod.jp/smartphone/iphone/ios-9-intro-ats/)\n    * [\u63a5\u7d9a\u5148\u304cATS (App Transport Security)\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u304b\u3001\u307e\u305f\u306f\u4f8b\u5916\u306e\u8a2d\u5b9a\u3092nscurl\u30b3\u30de\u30f3\u30c9\u3067\u7c21\u5358\u306b\u8abf\u3079\u308b - 24/7 twenty-four seven](http://blog.kishikawakatsumi.com/entry/2015/10/19/121257)\n\n## \u8a2d\u5b9a\u3067\u56de\u907f\n\n### hook \u3092\u4f5c\u6210\n\n\u8a2d\u5b9a\u3067\u56de\u907f\u3067\u304d\u308b\u305f\u3081\u3001[Hooks Guide - Apache Cordova](https://cordova.apache.org/docs/en/5.1.1/guide/appdev/hooks/) \u3092\u4f7f\u3044\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\u3002\nhook \u306f Cordova \u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u3001\u7279\u5b9a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3067\u304d\u308b\u4ed5\u7d44\u307f\u3002\n\u4eca\u56de\u306f after_prepare \u306b shell \u3092\u66f8\u3044\u305f\u3002\n\n#### project_root/hooks/after_prepare/ios9-transport-security.sh\n\n```\n#!/bin/bash\n\nPLIST=platforms/ios/*/*-Info.plist\n\ncat << EOF |\nAdd :NSAppTransportSecurity dict\nAdd :NSAppTransportSecurity:NSExceptionDomains dict\nAdd :NSAppTransportSecurity:NSExceptionDomains:dev.example.com dict\nAdd :NSAppTransportSecurity:NSExceptionDomains:dev.example.com:NSExceptionAllowsInsecureHTTPLoads bool YES\nAdd :NSAppTransportSecurity:NSExceptionDomains:dev.example.com:NSExceptionRequiresForwardSecrecy bool NO\nAdd :NSAppTransportSecurity:NSExceptionDomains:dev.example.com:NSExceptionMinimumTLSVersion string TLSv1.0\nAdd :NSAppTransportSecurity:NSExceptionDomains:production.example.com dict\nAdd :NSAppTransportSecurity:NSExceptionDomains:production.example.com:NSExceptionAllowsInsecureHTTPLoads bool YES\nAdd :NSAppTransportSecurity:NSExceptionDomains:production.example.com:NSExceptionRequiresForwardSecrecy bool NO\nAdd :NSAppTransportSecurity:NSExceptionDomains:production.example.com:NSExceptionMinimumTLSVersion string TLSv1.0\nEOF\nwhile read line\ndo\n    /usr/libexec/PlistBuddy -c \"$line\" $PLIST\ndone\n\ntrue\n```\n\n\u306a\u304a\u3001 config.xml \u306b\u306f \u4ee5\u4e0b\u306e whitelist \u3092\u8a2d\u5b9a\u3057\u3066\u3042\u308b\u3002\n\n```\n  <access origin=\"http://*.example.com\"/>\n  <access origin=\"https://*.example.com\"/>\n```\n\n## cordova prepare \u5f8c\u306e info.plist \u306e\u7d50\u679c\n\n\n```\n..\u7565..\n    <key>NSAppTransportSecurity</key>\n    <dict>\n      <key>NSExceptionDomains</key>\n      <dict>\n        <key>example.com</key>\n        <dict>\n          <key>NSIncludesSubdomains</key>\n          <true/>\n        </dict>\n        <key>dev.example.com</key>\n        <dict>\n          <key>NSExceptionAllowsInsecureHTTPLoads</key>\n          <true/>\n          <key>NSExceptionMinimumTLSVersion</key>\n          <string>TLSv1.0</string>\n          <key>NSExceptionRequiresForwardSecrecy</key>\n          <false/>\n        </dict>\n        <key>production.example.com</key>\n        <dict>\n          <key>NSExceptionAllowsInsecureHTTPLoads</key>\n          <true/>\n          <key>NSExceptionMinimumTLSVersion</key>\n          <string>TLSv1.0</string>\n          <key>NSExceptionRequiresForwardSecrecy</key>\n          <false/>\n        </dict>\n      </dict>\n    </dict>\n..\u7565..\n```\n\n\n## Plugin \u3067\u56de\u907f\u3082\u3067\u304d\u308b\uff1f\n\n[leecrossley/cordova-plugin-transport-security](https://github.com/leecrossley/cordova-plugin-transport-security) \u3068\u3044\u3046 plugin \u3082\u51fa\u3066\u3044\u3066\u3001 NSExceptionAllowsInsecureHTTPLoads \u3060\u3051\u3060\u3063\u305f\u3089\u3053\u308c\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n\n\u305f\u3060\u3057\u81ea\u5206\u306e\u5834\u5408\u306f\u3001\u7279\u5b9a\u306e URL \u3060\u3051\u306e\u8a2d\u5b9a\u3092\u3057\u305f\u304b\u3063\u305f\u306e\u3067\u3001\u4e0a\u8a18 Plugin \u3067\u306f\u30c0\u30e1\u3060\u3063\u305f\u3002\n\n## hook \u3092\u4f5c\u3063\u305f\u7406\u7531\n\nPlugin \u306b NSExceptionDomains \u306e\u8a2d\u5b9a\u3092\u66f8\u304f\u3068\u3001`access origin` \u3068\u7af6\u5408\u3057\u3066\u3057\u307e\u3046\u3088\u3046\u3067\u3001 `access origin` \u304c\u512a\u5148\u3057\u3066\u4e0a\u66f8\u304d\u3057\u3066\u3057\u307e\u3046\uff1f\u3088\u3046\u306a\u73fe\u8c61\u304c\u8d77\u304d\u305f\u3002\n\u3053\u308c\u3067\u3060\u3044\u3076\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3057\u307e\u3063\u305f\u3002\n\n\u672c\u6765\u306a\u3089\u3070 Plugin \u306b `<config-file target=\"*-Info.plist\" parent=\"NSAppTransportSecurity\">` \u3092\u66f8\u304f\u306e\u304c\u7b4b\u3060\u3068\u601d\u3046\u3001\u305f\u3060\u305d\u3046\u3059\u308b\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u306e\u3067 shell \u3092\u66f8\u3044\u305f\u6b21\u7b2c\u3002\n", "tags": ["Cordova", "iOS"]}