{"context": " More than 1 year has passed since last update.\u4ee5\u4e0b\u306etest-script.sh\u306e\u3088\u3046\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u3063\u3066\u3001Capistrano3\u3067\n$ cap test execute_script\n\n\u3057\u3066Vagrant\u3067\u4f5c\u6210\u3057\u305f\u4eee\u60f3\u30de\u30b7\u30f3\u3067\u5b9f\u884c\u3059\u308b\u3068\u3001\ntest-project $ cap test execute_script\nINFO [035ec69f] Running /usr/bin/env cd capistrano-test; pwd as vagrant@127.0.0.1\nDEBUG [035ec69f] Command: cd capistrano-test; pwd\nText will be echoed in the clear. Please install the HighLine or Termios libraries to suppress echoed text.\nEnter passphrase for /Users/kazuhirokomoda/.ssh/id_rsa:\nDEBUG [035ec69f]    /home/vagrant/capistrano-test\nINFO [035ec69f] Finished in 7.728 seconds with exit status 0 (successful).\nDEBUG [4d80d295] Running /usr/bin/env sh ~/capistrano-test/test-script.sh as vagrant@127.0.0.1\nDEBUG [4d80d295] Command: sh ~/capistrano-test/test-script.sh\nDEBUG [4d80d295]    Is it OK to continue? :  (y/n)?\ny\nn\ny\n...\u52d5\u304b\u306a\u3044\n\n\u307f\u305f\u3044\u306b\nIs it OK to continue? :\n\n\u306e\u8868\u793a\u304c\u51fa\u305f\u5f8c\u3067\u6bce\u56de\u6b62\u307e\u308a\u3001\u30e6\u30fc\u30b6\u306e\u5165\u529b\u3092\u53d7\u3051\u4ed8\u3051\u3066\u304f\u308c\u306a\u3044\u3002\n\u3053\u3046\u3044\u3046\u30e6\u30fc\u30b6\u5165\u529b\u3092\u5f85\u3064\u30b9\u30af\u30ea\u30d7\u30c8\u3092Capistrano\u3067\u5b9f\u884c\u3059\u308b\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044\u3067\u3059\u3002\n*\u8a2d\u5b9a\u7b49\u306f\u3053\u306e\u30da\u30fc\u30b8\u3092\u53c2\u8003\u3002\nhttp://labs.gree.jp/blog/2013/12/10084/\n\ntest-script.sh\n#!/bin/sh\n\naskYesOrNo() {\n    while true ; do\n        read -p \"$1 (y/n)?\" answer\n        case $answer in\n            [yY] | [yY]es | YES )\n                return 0;;\n            [nN] | [nN]o | NO )\n                return 1;;\n            * ) echo \"Please answer yes or no.\";;\n        esac\n    done\n}\n\naskYesOrNo \"Is it OK to continue? : \"\nif [ $? -eq 0 ]; then\n    # the return value of the shell script is obtained by `$?`, which means terminate code\n    echo \"nice!\"\nelse\n    echo \"boo...\"\nfi\n\n\n\ndeploy.rb\n# \u524d\u7565\n# a task\ndesc \"execute a script on a web server\"\ntask :execute_script do\n  on roles(:web) do\n    execute \"cd capistrano-test; pwd\"\n    output = capture \"sh ~/capistrano-test/test-script.sh\"\n    info output\n  end\nend\n# \u5f8c\u7565\n\n\n\ndeploy/test.rb\nset :stage, :test\n\nserver '127.0.0.1', port: 2222, user: 'vagrant', roles: %w{web app db}, ssh_options: {\n  #keys: %w(~/.ssh/authorized_keys),\n  #forward_agent: true,\n  #auth_methods: %w(publickey)\n}\n\n\n\u4ee5\u4e0b\u306etest-script.sh\u306e\u3088\u3046\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u3063\u3066\u3001Capistrano3\u3067\n\n```bash\n$ cap test execute_script\n```\n\u3057\u3066Vagrant\u3067\u4f5c\u6210\u3057\u305f\u4eee\u60f3\u30de\u30b7\u30f3\u3067\u5b9f\u884c\u3059\u308b\u3068\u3001\n\n```bash\ntest-project $ cap test execute_script\nINFO [035ec69f] Running /usr/bin/env cd capistrano-test; pwd as vagrant@127.0.0.1\nDEBUG [035ec69f] Command: cd capistrano-test; pwd\nText will be echoed in the clear. Please install the HighLine or Termios libraries to suppress echoed text.\nEnter passphrase for /Users/kazuhirokomoda/.ssh/id_rsa:\nDEBUG [035ec69f] \t/home/vagrant/capistrano-test\nINFO [035ec69f] Finished in 7.728 seconds with exit status 0 (successful).\nDEBUG [4d80d295] Running /usr/bin/env sh ~/capistrano-test/test-script.sh as vagrant@127.0.0.1\nDEBUG [4d80d295] Command: sh ~/capistrano-test/test-script.sh\nDEBUG [4d80d295] \tIs it OK to continue? :  (y/n)?\ny\nn\ny\n...\u52d5\u304b\u306a\u3044\n```\n\u307f\u305f\u3044\u306b\n\n```bash\nIs it OK to continue? :\n```\n\u306e\u8868\u793a\u304c\u51fa\u305f\u5f8c\u3067\u6bce\u56de\u6b62\u307e\u308a\u3001\u30e6\u30fc\u30b6\u306e\u5165\u529b\u3092\u53d7\u3051\u4ed8\u3051\u3066\u304f\u308c\u306a\u3044\u3002\n\u3053\u3046\u3044\u3046\u30e6\u30fc\u30b6\u5165\u529b\u3092\u5f85\u3064\u30b9\u30af\u30ea\u30d7\u30c8\u3092Capistrano\u3067\u5b9f\u884c\u3059\u308b\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044\u3067\u3059\u3002\n\n\n*\u8a2d\u5b9a\u7b49\u306f\u3053\u306e\u30da\u30fc\u30b8\u3092\u53c2\u8003\u3002\nhttp://labs.gree.jp/blog/2013/12/10084/\n\n\n```bash:test-script.sh\n#!/bin/sh\n\naskYesOrNo() {\n    while true ; do\n        read -p \"$1 (y/n)?\" answer\n        case $answer in\n            [yY] | [yY]es | YES )\n                return 0;;\n            [nN] | [nN]o | NO )\n                return 1;;\n            * ) echo \"Please answer yes or no.\";;\n        esac\n    done\n}\n\naskYesOrNo \"Is it OK to continue? : \"\nif [ $? -eq 0 ]; then\n    # the return value of the shell script is obtained by `$?`, which means terminate code\n    echo \"nice!\"\nelse\n    echo \"boo...\"\nfi\n```\n\n\n```rb:deploy.rb\n# \u524d\u7565\n# a task\ndesc \"execute a script on a web server\"\ntask :execute_script do\n  on roles(:web) do\n    execute \"cd capistrano-test; pwd\"\n    output = capture \"sh ~/capistrano-test/test-script.sh\"\n    info output\n  end\nend\n# \u5f8c\u7565\n```\n\n```rb:deploy/test.rb\nset :stage, :test\n\nserver '127.0.0.1', port: 2222, user: 'vagrant', roles: %w{web app db}, ssh_options: {\n  #keys: %w(~/.ssh/authorized_keys),\n  #forward_agent: true,\n  #auth_methods: %w(publickey)\n}\n```\n", "tags": ["capistrano3"]}