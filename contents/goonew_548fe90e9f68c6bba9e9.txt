{"context": "\u3053\u308c\u306f\u300c\u6587\u5b57\u5217\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0 Advent Calendar 2016\u300d23\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u524d\u56de\u306e\u8a18\u4e8b\u306f@okateim\u306b\u3088\u308b\u300cRange minimum Query\u300d\u3067\u3057\u305f\uff0e\n\u6b21\u56de\u306e\u8a18\u4e8b\u306f@kgoto\u306b\u3088\u308b\u300c\u306a\u305c12\u670821\u65e5\u304c\u56de\u6587\u306e\u65e5\u306a\u306e\u304b\u3092\u8003\u3048\u3066\u307f\u305f\u300d\u3067\u3059\uff0e\n\n\u306f\u3058\u3081\u306b\ngoonew\u3067\u3059\uff0e\u6587\u5b57\u5217\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff0c\u7279\u306b\u6587\u5b57\u5217\u306b\u5bfe\u3059\u308b\u7d22\u5f15\u306b\u3064\u3044\u3066\u7814\u7a76\u3057\u3066\u3044\u307e\u3059\uff0e\n\u3088\u304f\u77e5\u3089\u308c\u305f\u5168\u6587\u7d22\u5f15\u3068\u3057\u3066\uff0cSuffix tree(\u63a5\u5c3e\u8f9e\u6728)\u3068Suffix array\uff08\u63a5\u5c3e\u8f9e\u914d\u5217\uff09\u304c\u5b58\u5728\u3057\u307e\u3059\uff0e\u4e21\u8005\u306e\u3044\u3044\u3068\u3053\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3068Suffix tray\u3068\u547c\u3070\u308c\u308b\u7d22\u5f15\u306b\u306a\u308a\uff0c\u30a4\u30ab\u3059\uff08\u30af\u30a8\u30ea\u6642\u9593\u8a08\u7b97\u91cf\u304c\u6539\u5584\u3055\u308c\u308b\uff09\uff0c\u3068\u3044\u3046\u8ad6\u6587\u7d39\u4ecb\u304c\u3053\u306e\u8a18\u4e8b\u3067\u3059\uff0e\n\u8a72\u5f53\u3059\u308b\u8ad6\u6587\u306f\nRichard Cole, Tsvi Kopelowitz and Moshe Lewenstein. Suffix trays and Suffix Trists: Structures for Faster Text Indexing.  Algorithmica 72(2), 450-466, 2015.\n\u3067\u3059[1]\uff0e\u56fd\u969b\u4f1a\u8b70\u7248\u306fICALP2006\u306b\u901a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\uff0e\n\u672c\u8a18\u4e8b\u306e\u4ed6\u306b\uff0cSuffix tray\u3092\u7d39\u4ecb\u3057\u305f\u3082\u306e\u3068\u3057\u3066\uff0c\n- Erik Demaine\u306e\u8b1b\u7fa9\u52d5\u753b\n- Oren Weimann\u306e\u8b1b\u7fa9\u8cc7\u6599(pdf)\n\u7b49\u304c\u5b58\u5728\u3057\u307e\u3059\uff0e\n\u3053\u306e\u8a18\u4e8b\u306b\u306fSuffix tray\u3092\u89e3\u8aac\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u77e5\u8b58\u3068\u3057\u3066\uff0c\u4ee5\u4e0b\u306e\u4e8b\u9805\u306b\u3064\u3044\u3066\u306e\u7c21\u5358\u306a\u89e3\u8aac\u304c\u3042\u308a\u307e\u3059\uff0e\n- Suffix tree\n- Suffix array\n- LCP array\n\u3084\u3063\u3066\u3044\u304d\u307e\u3057\u3087\u3046\uff0e\n\n\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u30fb\u5168\u6587\u7d22\u5f15\n\u30c6\u30ad\u30b9\u30c8$T$\u306e\u4e2d\u304b\u3089\u30d1\u30bf\u30fc\u30f3$P$\u3092\u63a2\u3059\u554f\u984c\u3092\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3068\u547c\u3073\u307e\u3059\uff0e\n\u4ee5\u4e0b\u306e\u30c6\u30ad\u30b9\u30c8$T$\u304b\u3089\u30d1\u30bf\u30fc\u30f3$P = $ \"\u9c1b\u9c2f\u9b66\" \u3092\u63a2\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n\u30c6\u30ad\u30b9\u30c8$T = $ \"\u9bc6\u9c2f\u9c3b\u9c2f\u9c3b\u9b66\u9c1b\u9c2f\u9b5e\u9b5e\u9c1b\u9b66\u9c1b\u9b66\u9c1b\u9b66\u9c1b\u9b66\u9b66\u9c2f\u9c2f\u9bc6\u9c2f\u9c3b\u9c2f\u9c3b\u9b66\u9c1b\u9c2f\u9b5e\u9b5e\u9c1b\u9b66\u9c1b\u9b66\u9c1b\u9c2f\u9b66\u9c1b\u9b66\u9b66\u9c2f\u9c2f\"\n\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u304b\uff1f \u3053\u3046\u3044\u3046\u611f\u3058\u306e\u554f\u984c\u3067\u3059\uff0e\n\u30c6\u30ad\u30b9\u30c8$T$\u306e\u9577\u3055\u3092$n$\uff0c\u30d1\u30bf\u30fc\u30f3\u6587\u5b57\u5217$P$\u306e\u9577\u3055\u3092$m$\u3068\u3059\u308b\u3068\uff0cKMP\u306e\u3088\u3046\u306a\u30c6\u30ad\u30b9\u30c8\u3092\u3059\u3079\u3066\u8210\u3081\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067$O(n + m)$\u6642\u9593\u3067\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u5165\u529b\u30c6\u30ad\u30b9\u30c8\u306b\u5bfe\u3057\u524d\u51e6\u7406\u3092\u884c\u3044\uff0c\u5168\u6587\u7d22\u5f15\u3068\u547c\u3070\u308c\u308b\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3067\uff0c\u3053\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u3088\u308a\u9ad8\u901f\u306b\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\nSuffix tree\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092$O(m \\log \\sigma)$\u6642\u9593\uff0c\nSuffix array(+ LCP array)\u306f$O(m + \\log n)$\u6642\u9593\u3067\u89e3\u304d\u307e\u3059\uff0e\n\u305d\u308c\u3089\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3068$O(m + \\log \\sigma)$\u3092\u9054\u6210\u3067\u304d\u308b\u3068\u3044\u3046\u306e\u304cSuffix tray\u3067\u3059\uff0e\n$\\sigma$\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u30b5\u30a4\u30ba\uff08\u6587\u5b57\u306e\u7a2e\u985e\u6570\uff09\u3067\uff0c$n$\u3092\u8d85\u3048\u306a\u3044\u3067\u3059\uff0e\n\u3064\u307e\u308a\uff0c\u3088\u308a\u901f\u304f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u89e3\u3051\u308b\u308f\u3051\u3067\u3059\uff0e\n\u6c17\u6301\u3061\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u304b\uff1f\n\u4ee5\u4e0b\u3067\uff0cSuffix tree\u3068Suffix array\uff0cSuffix tray\u306e\u9806\u3067\u7d39\u4ecb\u3057\u307e\u3059\uff0e\n\uff08\u7279\u306b\uff0c\u30d1\u30bf\u30fc\u30f3\u304c\u5b58\u5728\u3059\u308b\u304b\u5426\u304b\u3092yes/no\u3067\u8fd4\u3059\u554f\u984c\u306fmember query\u3068\u547c\u3070\u308c\u307e\u3059\uff0e\u4ed6\u306b\uff0c\u51fa\u73fe\u56de\u6570\u3092\u8fd4\u3059count\u3084\u51fa\u73fe\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u8fd4\u3059locate\u306a\u3069\u304c\u3042\u308a\u307e\u3059\uff0e\u4ee5\u964d\u306fmember query\u3092\u8003\u3048\u307e\u3059\uff0e\uff09\n\nSuffix Tree\n\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u30b5\u30a4\u30ba\uff08\u6587\u5b57\u30b7\u30f3\u30dc\u30eb\u306e\u7a2e\u985e\u6570\uff09$\\sigma$\uff0c\u9577\u3055$n$\u306e\u30c6\u30ad\u30b9\u30c8$T$\u3092\u8003\u3048\u307e\u3059\uff0e1\n\u30c6\u30ad\u30b9\u30c8$T$\u306b\u5bfe\u3059\u308bSuffix tree\u306f\uff0c$T$\u306e\u3059\u3079\u3066\u306e\u63a5\u5c3e\u8f9e\u3092\u6839\u304b\u3089\u306e\u30d1\u30b9\u3067\u8868\u73fe\u3057\u305f\u30b3\u30f3\u30d1\u30af\u30c8\u30c8\u30e9\u30a4\u3067\u3059\uff0e\n\uff08\u6587\u5b57\u5217$T$\u306e\u63a5\u5c3e\u8f9e\u3068\u306f\uff0c$T$\u3092\u5148\u982d\u304b\u30890\u6587\u5b57\u4ee5\u4e0a\u524a\u3063\u305f\u3082\u306e\u3067\u3059\uff0e\uff09\n\u4ee5\u4e0b\u306e\u56f3\u304c\u305d\u308c\u3067\u3059\uff0e\n\n\u30b3\u30f3\u30d1\u30af\u30c8\u30c8\u30e9\u30a4\u3068\u3044\u3046\u306e\u306f\uff0c\u679d\u306b\u6587\u5b57\u5217\u304c\u3064\u3044\u305f\u6839\u4ed8\u304d\u6728\u3067\uff0c\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6e80\u305f\u3059\u3082\u306e\u3067\u3059\uff0e\n- \u6839\u3092\u9664\u304f\u5168\u3066\u306e\u5185\u90e8\u30ce\u30fc\u30c9\u306f2\u3064\u4ee5\u4e0a\u306e\u5b50\u30ce\u30fc\u30c9\u3092\u6301\u3064\uff0e\n- \u3042\u308b\u5185\u90e8\u30ce\u30fc\u30c9$v$\u304c\u6301\u3064outgoing edge (\u5b50\u30ce\u30fc\u30c9\u3078\u306e\u8fba)\u306b\u3064\u3044\u3066\u3044\u308b\u30e9\u30d9\u30eb\u306e\u5148\u982d\u6587\u5b57\u306f\u3059\u3079\u3066\u7570\u306a\u308b\uff0e\n\u3044\u3044\u3067\u3059\u306d\uff0e\nSuffix tree\u306b\u5fc5\u8981\u306a\u9818\u57df\u8a08\u7b97\u91cf\u3092\u8003\u3048\u307e\u3059\uff0e\u7d50\u8ad6\u304b\u3089\u3044\u3046\u3068$O(n)$ words\u3067\u3059\uff0e\n\u8a3c\u660e\u306e\u30b9\u30b1\u30c3\u30c1\u3060\u3051\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\uff0e\u8449\u30ce\u30fc\u30c9\u306e\u500b\u6570\u306f\u9ad8\u3005$n$\u500b\u3067\u3059\uff0e\u30b3\u30f3\u30d1\u30af\u30c8\u30e9\u30a4\u306e\u5b9a\u7fa9\u3088\u308a\uff0c\u5404\u5185\u90e8\u30ce\u30fc\u30c9\u306f\uff12\u3064\u4ee5\u4e0a\u306e\u5b50\u3092\u6301\u3064\u306e\u3067\uff0c\u5185\u90e8\u30ce\u30fc\u30c9\u306e\u500b\u6570\u306f\u6700\u5927$n-1$\u500b\u3060\u3068\u308f\u304b\u308a\u307e\u3059\uff0e\u3088\u3063\u3066\u30ce\u30fc\u30c9\u306e\u500b\u6570\u306f$O(n)$\u500b\uff0c\u3057\u305f\u304c\u3063\u3066\u8fba\u306e\u672c\u6570\u3082$O(n)$\u672c\u306b\u306a\u308a\u307e\u3059\uff0e\u30e9\u30d9\u30eb\u306e\u7dcf\u6587\u5b57\u5217\u9577\u306f$O(n^2)$\u306b\u898b\u3048\u307e\u3059\u304c\uff0c\u5404\u679d\u30e9\u30d9\u30eb\u306f\u5165\u529b\u30c6\u30ad\u30b9\u30c8$T$\u4e0a\u306e\u53c2\u7167\u3067\u8868\u73fe\u3067\u304d\u307e\u3059\uff0e\u4f8b\u3048\u3070\u4e0a\u306e\u56f3\u306b\u304a\u3051\u308b$coa$\u3068\u3044\u3046\u679d\u30e9\u30d9\u30eb\u306f\uff0c$T$\u306e$3$\u756a\u76ee\u304b\u3089$5$\u756a\u76ee\u307e\u3067\u306e\u6587\u5b57\u5217\u3068\u8868\u73fe\u3067\u304d\u308b\u306e\u3067\uff0c\u679d\u30e9\u30d9\u30eb\u306f\u6574\u6570\uff12\u3064\u3067\u8868\u73fe\u3067\u304d\u307e\u3059\uff0e\u305d\u3093\u306a\u308f\u3051\u3067\u307e\u3068\u3081\u3066$O(n)$ words\u3067\u3059\uff0e\u3053\u3093\u306a\u611f\u3058\u3067\u3059\uff0e\n\u3053\u306e\u63a5\u5c3e\u8f9e\u6728\u3092\u5165\u529b\u306b\u5bfe\u3057\u3066\u7dda\u5f62\u6642\u9593\u3067\u69cb\u7bc9\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u77e5\u3089\u308c\u3066\u3044\u307e\u3059[2]\uff0e\nSuffix tree\u4e0a\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306e\u30af\u30a8\u30ea\u3092\u304b\u3051\u307e\u3057\u3087\u3046\uff0e\n\u30d1\u30bf\u30fc\u30f3$P$\u304c\u5b58\u5728\u3059\u308b\u304b\u3069\u3046\u304b\u3092\u8abf\u3079\u305f\u3044\u3068\u304d\u306f\uff0c\u6839\u304b\u3089\u30d1\u30bf\u30fc\u30f3$P$\u3067\u6728\u3092\u8fbf\u308c\u3070\u826f\u3044\u3060\u3051\u3067\u3059\uff0e\n$m$\u6587\u5b57\u8fbf\u308b\u306e\u306b\u5fc5\u8981\u306a\u6642\u9593\u306f$O(m \\log \\sigma)$\u6642\u9593\u3067\u3059\uff0e\n\n\u306a\u305c log \u03c3 ?\n\u601d\u3044\u51fa\u3057\u3066\u304a\u304f\u3068\uff0c$\\sigma$\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u30b5\u30a4\u30ba\uff08\u6587\u5b57\u30b7\u30f3\u30dc\u30eb\u306e\u7a2e\u985e\u6570\uff09\u3067\u3059\uff0e\nSuffix tree\u4e0a\u3092$m$\u6587\u5b57\u8fbf\u308b\u306e\u306b\u306f$O(m)$\u6642\u9593\u3067\u6e08\u307f\u305d\u3046\u3067\u3059\u304c\uff0c\u5404\u30ce\u30fc\u30c9\u304b\u3089\u51fa\u3066\u3044\u308b\u6700\u5927$\\sigma$\u500b\u306e\u679d\u304b\u3089\uff0c\u9069\u5207\u306a\u3082\u306e\u3092\u9078\u3076\u306e\u306b\uff12\u5206\u63a2\u7d22\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\uff0c\u6bce\u56de$O(\\log \\sigma)$\u6642\u9593\u304b\u304b\u308a\u307e\u3059\uff0e\uff08\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306b\u5168\u9806\u5e8f\u95a2\u4fc2\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u4eee\u5b9a\uff0e\uff09\n\u3053\u308c\u3092\u56de\u907f\u3059\u308b\u7b56\u3068\u3057\u3066\uff0c\u5404\u30ce\u30fc\u30c9\u306b\u9577\u3055$\\sigma$\u306e\u914d\u5217\u3092\u6301\u305f\u305b\uff0c\u5bfe\u5fdc\u3059\u308b\u5b50\u30ce\u30fc\u30c9\u3078\u5b9a\u6570\u6642\u9593\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u304c\uff0cSuffix tree\u306e\u9818\u57df\u8a08\u7b97\u91cf\u306f$O(n\\sigma)$ words\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\uff0e\n\u5225\u306e\u7b56\u3068\u3057\u3066\uff0c\u6587\u5b57\u3092key\u3068\u3057\u3066\u5bfe\u5fdc\u3059\u308b\u5b50\u30ce\u30fc\u30c9\u3092value\u306b\u3082\u3064\u8f9e\u66f8\uff08\u30cf\u30c3\u30b7\u30e5\uff09\u3092\u5404\u30ce\u30fc\u30c9\u306b\u6301\u305f\u305b\u308b\u65b9\u6cd5\u304c\u8003\u3048\u3089\u308c\u307e\u3059\uff0e\u3053\u308c\u306a\u3089\u3070\u5b9a\u6570\u6642\u9593\u30fb\u5b9a\u6570\u9818\u57df\u3067\u5b50\u30ce\u30fc\u30c9\u3078\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u3067\u3059\uff0e\u3057\u304b\u3057\u306a\u304c\u3089Deterministic\u306a\u8f9e\u66f8\u3060\u3068\u69cb\u7bc9\u306b$O(n \\; min( \\log \\sigma, \\log \\log n ))$\u6642\u9593\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3059[3]\uff0e\uff08Randomized\u306a\u8f9e\u66f8\u3092\u7528\u3044\u308c\u3070\uff0c\u7dda\u5f62\u6642\u9593\u3067\u69cb\u7bc9\u53ef\u80fd\u3067\u3059\uff0e\uff09\n\u307e\u3068\u3081\u308b\u3068\uff0cSuffix tree\u3092\u7dda\u5f62\u9818\u57df\u30fb\u7dda\u5f62\u6642\u9593\u3067\u69cb\u7bc9\u3059\u308b\u5834\u5408\uff0c\u6700\u60aa\u6c7a\u5b9a\u6027\u6642\u9593$O(m \\log \\sigma)$\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\nSuffix Array\nSuffix array\u306f\uff0c\u4e0e\u3048\u3089\u308c\u305f\u5165\u529b\u30c6\u30ad\u30b9\u30c8$T$\u306e\u3059\u3079\u3066\u306e\u63a5\u5c3e\u8f9e\u3092\u30bd\u30fc\u30c8\u3057\uff0c\u305d\u306e\u30bd\u30fc\u30c8\u7d50\u679c\u3092\u6dfb\u5b57\u756a\u53f7\u306e\u914d\u5217\u3068\u3057\u3066\u6301\u3064\u3082\u306e\u3067\u3059\uff0e\n\u4ee5\u4e0b\u306e\u56f3\u3092\u307f\u3066\u304f\u3060\u3055\u3044\uff0e\n\nSuffix array\u306e\u9818\u57df\u8a08\u7b97\u91cf\u306f\uff0c$n$\u500b\u306e\u6574\u6570\u304c\u4e26\u3093\u3067\u3044\u308b\u3060\u3051\u306a\u306e\u3067$O(n)$ words\u3067\u3059\uff0e\n\u307e\u305f\uff0c\u3053\u306e\u914d\u5217\u3092$O(n)$\u6642\u9593\u3067\u69cb\u7bc9\u3067\u304d\u308b\u3053\u3068\u304c\u77e5\u3089\u308c\u3066\u3044\u307e\u3059[4,5,6]\uff0e\nSuffix array\u4e0a\u3067\uff0c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306e\u30af\u30a8\u30ea\u3092\u304b\u3051\u307e\u3057\u3087\u3046\uff0e\n\u3042\u308b\u30d1\u30bf\u30fc\u30f3$P$\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\uff0cSuffix array\u4e0a\u306b\u5bfe\u5fdc\u3059\u308b\u7bc4\u56f2\u304c\u5b58\u5728\u3059\u308b\u306f\u305a\u3067\u3059\uff0e\n\u4ee5\u4e0b\u306e\u56f3\u3092\u307f\u3066\u304f\u3060\u3055\u3044\uff0e\n\n\u914d\u5217\u4e0a\u306e\uff12\u5206\u63a2\u7d22\u3067\u9054\u6210\u3059\u308b\u3060\u3051\u3067\u3059\uff0e\n\u3064\u307e\u308a$O(m \\log n)$\u6642\u9593\u3067\u3059\uff0e\n$\\log n$\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u306e\u304c\u8f9b\u3044\u611f\u3058\u306a\u306e\u3067\uff0c\u6b21\u306e\u7bc0\u3067\u6539\u5584\u3057\u307e\u3059\uff0e\n\nLCP Array\nSuffix array\u4e0a\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u9ad8\u901f\u306b\u884c\u3046\u305f\u3081\u306b\uff0cLCP array (Longest Common Prefix Array\uff0c\u6700\u9577\u5171\u901a\u63a5\u982d\u8f9e\u914d\u5217)\u3068\u3044\u3046\u3082\u306e\u3092\u8003\u3048\u307e\u3059\uff0e\nLCP array\u3068\u306f\uff0cSuffix array\u4e0a\u3067\u96a3\u3042\u3046\u63a5\u5c3e\u8f9e\u306e\u5171\u901a\u63a5\u982d\u8f9e\u306e\u9577\u3055\u3092\u683c\u7d0d\u3057\u305f\u914d\u5217\u3067\u3059\uff0e\u4ee5\u4e0b\u306e\u56f3\u3092\u898b\u3066\u304f\u3060\u3055\u3044\uff0e\u3061\u306a\u307f\u306bSuffix array\u3088\u308a\u7dda\u5f62\u6642\u9593\u3067\u6c42\u3081\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u77e5\u3089\u308c\u3066\u3044\u307e\u3059[7]\uff0e\n\nSuffix array\u3068LCP array\u3092\u4f7f\u3063\u3066\u9ad8\u901f\u306b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u884c\u3046\u65b9\u6cd5\u306f\uff0cechizen_tm\u6c0f\u306e\u30d6\u30ed\u30b0\u8a18\u4e8b\u3067\u8a73\u3057\u304f\u89e3\u8aac\u3055\u308c\u3066\u3044\u307e\u30592\uff0e\u306e\u3067\uff0c\u305d\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n\u53c2\u7167\u3057\u307e\u3057\u305f\u304b?? \u305d\u3093\u306a\u308f\u3051\u3067\uff0cLCP array\u3092\u7528\u3044\u308b\u3053\u3068\u3067$O(m + \\log n)$\u6642\u9593\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\uff0e\u3088\u304b\u3063\u305f\u3067\u3059\u306d\uff0e\n\u8a08\u7b97\u91cf\u306e$O(m + \\log n)$\u6642\u9593\u306b\u3064\u3044\u3066\uff0c\u6700\u521d\u306e\u9805$m$\u306f\u30d1\u30bf\u30fc\u30f3\u9577\u306b\u3088\u308b\u3082\u306e\u3067\u3042\u308a\uff0c$\\log n$\u306e\u9805\u306f\u9577\u3055$n$\u306e\u7bc4\u56f2\u3092\uff12\u5206\u63a2\u7d22\u3059\u308b\u306e\u306b\u304b\u304b\u308b\u30b3\u30b9\u30c8\u3068\u3044\u3046\u3053\u3068\u3067\u3059\uff0e\u5c11\u3057\u3042\u3068\u3067\u4f7f\u3044\u307e\u3059\uff0e\n\nSuffix Tray\n\u3053\u3053\u307e\u3067\u3067\uff0cSuffix tree\u3068Suffix array\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u898b\u3066\u304d\u307e\u3057\u305f\uff0e\nSuffix tray\u306fCole\u3089\u306b\u3088\u3063\u3066\u63d0\u6848\u3055\u308c\u305f\uff0cSuffix tree\u3068Suffix array\u3092\u7d44\u307f\u5408\u308f\u305b\u305f\u30c7\u30fc\u30bf\u69cb\u9020\u3067\u3059[1]\uff0e\u9818\u57df\u306f$O(n)$ words\u3067\u5909\u308f\u3089\u305a\uff0c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u6700\u60aa\u6c7a\u5b9a\u6642\u9593$O(m + \\log \\sigma)$\u3067\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\u3068\u308a\u3042\u3048\u305a\uff0c\u96d1\u306bSuffix tree\u3068Suffix array\u3092\u7d44\u307f\u5408\u308f\u305b\u307e\u3057\u3087\u3046\uff0e\nSuffix tree\u306e\u679d\u304c\u5148\u982d\u30e9\u30d9\u30eb\u3067\u30bd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u4eee\u5b9a\u3059\u308b\u3068\uff0c\nSuffix tree\u306e\u8449\u30ce\u30fc\u30c9\u306fSuffix array\u3068\u5bfe\u5fdc\u3057\u307e\u3059\uff0e\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3059\uff0e\n\nSuffix tree\u306e\u30af\u30a8\u30ea\u6642\u9593\u304c$O(n \\log \\sigma)$\u3067\u3042\u308b\u7406\u7531\u306f\uff0c\n\u6700\u5927$\\sigma$\u500b\u3042\u308b\u679d\u304b\u3089\u6b63\u3057\u3044\u3082\u306e\u3092\uff12\u5206\u63a2\u7d22\u3067\u9078\u629e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u304b\u3089\u3067\u3057\u305f\uff0e\u305d\u308c\u3092\u56de\u907f\u3059\u308b\u65b9\u6cd5\u3068\u3057\u3066\uff0c\u5404\u30ce\u30fc\u30c9\u304c\u9577\u3055$\\sigma$\u306e\u914d\u5217\u3092\u6301\u3061\uff0c\u5b9a\u6570\u6642\u9593\u3067\u5bfe\u5fdc\u3059\u308b\u30ce\u30fc\u30c9\u3078\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3057\u305f\u304c\uff0c\u9818\u57df\u8a08\u7b97\u91cf\u306f$O(n \\sigma)$ words\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\uff0e\n\u305d\u308c\u306a\u3089\u3070\uff0cSuffix tree\u3092\u4e0a\u624b\u306b\u9593\u5f15\u3044\u3066\u30ce\u30fc\u30c9\u6570\u3092$O(n / \\sigma)$\u500b\u306b\u3057\u3066\u3042\u3052\u308c\u3070\uff0c\u305f\u3068\u3048\u5404\u30ce\u30fc\u30c9\u304c$\\sigma$\u30b5\u30a4\u30ba\u306e\u914d\u5217\u3092\u6301\u3063\u305f\u3068\u3057\u3066\u3082\u7dda\u5f62\u9818\u57df\u3067\u6e08\u307f\u307e\u3059\uff0e\u9593\u5f15\u3044\u305f\u5206\u306fSuffix array\u3067\u88dc\u3046\u3053\u3068\u3067\u30af\u30a8\u30ea\u3092\u89e3\u304d\u307e\u3059\uff0e\u3053\u308c\u304cSuffix tray\u306e\u57fa\u672c\u7684\u306a\u30a2\u30a4\u30c7\u30a2\u3067\u3059\uff0e\n\u6b21\u306e\u7bc0\u3067\u9593\u5f15\u304d\u65b9\u3092\u898b\u3066\u3044\u304d\u307e\u3059\uff0e\n\nHeavy Node Decomposition\nSuffix tree\u4e0a\u306e\u30ce\u30fc\u30c9$v$\u304c\u4ee5\u4e0b\u3092\u6e80\u305f\u3059\u3068\u304d\uff0c$v$\u3092$\\sigma$\u30ce\u30fc\u30c9\u3068\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\n- $v$\u3092\u6839\u3068\u3059\u308b\u90e8\u5206\u6728\u306b\u542b\u307e\u308c\u308b\u8449\u304c$\\sigma$\u500b\u4ee5\u4e0a\u3067\u3042\u308b\uff0e\n$\\sigma$\u30ce\u30fc\u30c9\u306fHeavy node\u3068\u547c\u3070\u308c\u308b\u3053\u3068\u3082\u3042\u308a\u307e\u3059\uff0e\n\u307e\u305f$\\sigma$\u30ce\u30fc\u30c9\u3067\u306a\u3044\u3082\u306e\u3092Light\u30ce\u30fc\u30c9\u3068\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\n$\\sigma$\u30ce\u30fc\u30c9\u3092\u3055\u3089\u306b\u4ee5\u4e0b\u306e\uff13\u3064\u306e\u30bf\u30a4\u30d7\u306b\u5206\u985e\u3057\u307e\u3059\uff0e\n- $\\sigma$ leaf: \u3059\u3079\u3066\u306e\u5b50\u30ce\u30fc\u30c9\u304c$\\sigma$\u30ce\u30fc\u30c9\u3067\u306a\u3044\uff0e\n- branching $\\sigma$\u30ce\u30fc\u30c9: 2\u3064\u4ee5\u4e0a\u306e$\\sigma$\u30ce\u30fc\u30c9\u3092\u5b50\u30ce\u30fc\u30c9\u3068\u3057\u3066\u6301\u3064\uff0e\n- non-branching $\\sigma$\u30ce\u30fc\u30c9: \u4e0a\u8a182\u3064\u306b\u8a72\u5f53\u3057\u306a\u3044$\\sigma$\u30ce\u30fc\u30c9\uff0e\nSuffix tree\u306e\u5404\u30ce\u30fc\u30c9\u3092\u30bf\u30a4\u30d7\u5206\u3051\u3057\u305f\u4f8b\u3092\u4ee5\u4e0b\u306b\u793a\u3057\u307e\u3059\uff0e\u8ad6\u6587[1]\u3067\u7528\u3044\u3089\u308c\u3066\u3044\u308b\u4f8b\u3068\u540c\u3058\u3082\u306e\u3067\u3059\uff0e\n\n\u3053\u3046\u3057\u3066\u5f97\u3089\u308c\u305fbranching$\\sigma$\u30ce\u30fc\u30c9\u3067\u3059\u304c\uff0c\nSuffix tree\u4e0a\u306b$O(n / \\sigma)$\u500b\u3057\u304b\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\uff0e\n\u7406\u7531\u3068\u3057\u3066\u306f\uff0c$\\sigma$ leaf\u304c\u9ad8\u3005$(n / \\sigma)$\u500b\u3057\u304b\u5b58\u5728\u3057\u306a\u3044\u304b\u3089\u3067\u3059\uff0e\uff08$\\sigma$\u30ce\u30fc\u30c9\u306e\u5b9a\u7fa9\u3092\u601d\u3044\u51fa\u3059\u3068\uff0c\u90e8\u5206\u6728\u306e\u8449\u30ce\u30fc\u30c9\u306e\u6570\u304c$\\sigma$\u500b\u4ee5\u4e0a\u3067\u3057\u305f\uff0e\uff09\n\u3053\u306e\u5206\u89e3\u3092\uff0c\u3044\u307e\u79c1\u304c\u52dd\u624b\u306bHeavy node decomposition\u3068\u540d\u4ed8\u3051\u307e\u3057\u305f\uff0e\u6700\u8fd1\u3044\u308d\u3044\u308d\u4f7f\u308f\u308c\u3066\u3044\u307e\u30593\uff0e\nbranching$\\sigma$\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u306f\uff0c\u30b5\u30a4\u30ba$\\sigma$\u306e\u914d\u5217\u3092\u3082\u305f\u305b\uff0c$O(1)$\u6642\u9593\u3067\u306e\u5b50\u30ce\u30fc\u30c9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u5b9f\u73fe\u3057\u307e\u3059\uff0e\n\u305d\u308c\u4ee5\u5916\u306e\u30ce\u30fc\u30c9\u306b\u95a2\u3057\u3066\u306f\uff0c\u5b50\u30ce\u30fc\u30c9\u3068\u3057\u3066\u9ad8\u30051\u3064\u306e$\\sigma$\u30ce\u30fc\u30c9\u3068$\\sigma$\u500b\u4ee5\u4e0b\u306eLight\u30ce\u30fc\u30c9\u3057\u304b\u3082\u305f\u306a\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\uff0eLight\u30ce\u30fc\u30c9\u306e\u96c6\u5408\u306f2\u3064\u306eSuffix interval\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff08\u4ee5\u4e0b\u306e\u56f3\u3092\u898b\u3066\u304f\u3060\u3055\u3044\uff09\uff0e\u30e9\u30d9\u30eb\u3092\u3082\u3064\u5b50\u306f\uff11\u3064\u3060\u3051\u3067\u3059\uff0e\u3064\u307e\u308a\uff0c\u9069\u5207\u306a\u679d\u3092\u9078\u3076\u306e\u306b\u5fc5\u8981\u306a\u30b3\u30b9\u30c8\u306f$O(1)$\u3067\u3059\uff0e\n\n\nSuffix Interval\n\u4e0a\u8a18\u306e\u56f3\u3067\u306f\uff0c\u6839\u30ce\u30fc\u30c9\u304b\u3089\u5bfe\u5fdc\u3059\u308bSuffix interval\u307e\u3067$O(m)$\u6642\u9593\u3067\u5230\u9054\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\nSuffix interval\u306fSuffix array\u306e\u3042\u308b\u7bc4\u56f2\u3067\u3059\uff0e\u3053\u306eInterval\u306e\u6700\u5927\u9577\u3092\u8003\u3048\u3066\u307f\u307e\u3059\uff0e$O(\\sigma ^2)$\u30b5\u30a4\u30ba\u3067\u3059\uff0e\u306a\u305c\u304b\u3068\u3044\u3046\u3068\uff0c\u3042\u308b$\\sigma$\u30ce\u30fc\u30c9\u306f\uff0c\u6700\u5927$\\sigma$\u500b\u306e$light$\u30ce\u30fc\u30c9\u3092\u6301\u3061\u307e\u3059\uff0e$light$\u30ce\u30fc\u30c9\u306e\u5b9a\u7fa9\u306f\uff0c\u81ea\u5206\u81ea\u8eab\u3092\u6839\u3068\u3059\u308b\u90e8\u5206\u6728\u306e\u8449\u30ce\u30fc\u30c9\u304c$\\sigma$\u500b\u672a\u6e80\u306e\u30ce\u30fc\u30c9\u3067\u3057\u305f\uff0e\u3088\u3063\u3066\uff0c$\\sigma$\u500b\u306eLight\u30ce\u30fc\u30c9\u304c\u5404\u3005$\\sigma$\u500b\u306e\u8449\u3092\u6301\u3064\u3068\u3057\u3066\uff0cSuffix Interval\u306f\u3082\u3068\u3082\u3068\u306e\u8449\u30ce\u30fc\u30c9\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u304b\u3089\uff0c\u6700\u5927$\\sigma ^2$\u30b5\u30a4\u30ba\u306eInterval\u3092\u3082\u3064\u3053\u3068\u306b\u306a\u308a\u307e\u3059\uff0e\nSuffix array\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306b\u304b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092\u601d\u3044\u51fa\u3059\u3068\uff0c$O(\u30d1\u30bf\u30fc\u30f3\u9577 + \\log (Interval\u9577))$\u3067\u3057\u305f\uff0e\n\u3064\u307e\u308a\uff0cSuffix tray\u306eInterval\u5185\u3067\u306e\u691c\u7d22\u6642\u9593\u8a08\u7b97\u91cf\u306f$O(m + \\log \\sigma ^2) = O(m + \\log \\sigma)$\u306b\u306a\u308a\u307e\u3059\uff0e\nSuffix tray\u306e\u6839\u304b\u3089\u30d1\u30bf\u30fc\u30f3$P$\u306b\u5bfe\u5fdc\u3059\u308bInterval\u307e\u3067\u306f$O(m)$\u3067\u5230\u9054\u3067\u304d\u307e\u3059\u304b\u3089\uff0c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306f\u5408\u8a08\u3067$O(m) + O(m + \\log \\sigma) = O(m + \\log \\sigma)$\u6642\u9593\u3067\u3059\uff01\u3084\u3063\u305f\u3042\uff0eSuffix tree\u3084Suffix array\u3088\u308a\u3082\uff08\u7406\u8ad6\u4e0a\uff09\u901f\u304f\u306a\u308a\u307e\u3057\u305f\uff01\n\u3061\u306a\u307f\u306b\u69cb\u7bc9\u3082\u7dda\u5f62\u6642\u9593\u3067\u3059\uff0eSuffix tree\uff0cSuffix array\u3068\u3082\u306b\u7dda\u5f62\u6642\u9593\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3057\uff0c\u306a\u3093\u3068\u306a\u304f\u305d\u3093\u306a\u6c17\u304c\u3057\u307e\u3059\u306d\uff0e\n\n\u7d50\u8ad6\n\u305d\u3093\u306a\u308f\u3051\u3067\uff0cSuffix tray\u306f\u7dda\u5f62\u6642\u9593\u30fb\u7dda\u5f62\u9818\u57df\u3067\u69cb\u7bc9\u3067\u304d\uff0c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092$O(m + \\log \\sigma)$\u6700\u60aa\u6c7a\u5b9a\u6642\u9593\u3067\u30b5\u30dd\u30fc\u30c8\u3057\u307e\u3059\uff0e\u3061\u306a\u307f\u306b\u540c\u8ad6\u6587\u3067\u306f\uff0cSuffix array\u306e\u90e8\u5206\u3092Linked list\u306b\u5909\u66f4\u3057\u30aa\u30f3\u30e9\u30a4\u30f3\u69cb\u7bc9\u3092\u53ef\u80fd\u306b\u3057\u305fSuffix trist\u3082\u7d39\u4ecb\u3055\u308c\u3066\u3044\u307e\u3059\uff0e\n\u65e5\u672c\u6642\u9593\u3060\u3068\u30af\u30ea\u30b9\u30de\u30b9\u304c\u7d42\u308f\u3063\u3066\u304a\u308a\uff0c\u30a2\u30c9\u30d9\u30f3\u30c8\u30ab\u30ec\u30f3\u30c0\u30fc\u7684\u306b\u306f\u9045\u523b\u3067\u3059\u304c\uff0c\u30a2\u30e1\u30ea\u30ab\u9818\u30b5\u30e2\u30a2\u3067\u306f\u307e\u3060\uff12\uff15\u65e5\u306a\u306e\u3067\uff0c\u3053\u308c\u306b\u3066\u3088\u3057\u3068\u3057\u307e\u3059\uff0e\n\u30e1\u30ea\u30fc\u30af\u30ea\u30b9\u30de\u30b9\uff0e\u3081\u3067\u305f\u3044\u3067\u3059\u306d\uff0e\n\n\u53c2\u8003\u6587\u732e\n[1] Richard Cole, Tsvi Kopelowitz and Moshe Lewenstein. Suffix Trays and Suffix Trists: Structures for Faster Text Indexing.  Algorithmica 72(2), 450-466, 2015.\n[2] Martin Farach-Colton, Paolo Ferragina and S. Muthukrishnan. On the sorting-complexity of suffix tree construction. J. ACM 47(6), 987-1011, 2000.\n[3] Milan Ruzic. Constructing Efficient Dictionaries in Close to Sorting Time. In Proc. ICALP (1), 84-95, 2008.\n[4] Juha K\u00e4rkk\u00e4inen, Peter Sanders, Stefan Burkhardt. Linear work suffix array construction. In J. of the ACM, 53(6), 918-936, 2006.\n[5] Dong Kyue Kim, Jeong Seop Sim, Heejin Park, Kunsoo Park. Constructing suffix arrays in linear time. J. Discrete Algorithms, 3(2-4), 126-142, 2005.\n[6] Pang Ko, Srinivas Aluru. Space efficient linear time construction of suffix arrays. J. Discrete Algorithms, 3(2-4), 143-156, 2005.\n[7] Toru Kasai, Gunho Lee, Hiroki Arimura, Setsuo Arikawa and Kunsoo Park. Linear-Time Longest-Common-Prefix Computation in Suffix Arrays and Its Applications. In Proc. CPM2001, 181-192, 2001.\n[8] Udi Manber, Eugene W. Myers. Suffix arrays: A new method for on-line string searches. SIAM J. on Computing, 22(5), 935-948, 1993.\n[9] Fischer, J., Gawrychowski, P. Alphabet-dependent string searching with wexponential search trees. In Proc. CPM2015, 160\u2013171, 2015.\n[10] Takuya Takagi, Shunsuke Inenaga, Hiroki Arimura. Fully-online Construction of Suffix Trees for Multiple Texts. In Proc. CPM2016, 22:1-22:13, 2016.\n\n\n\n\n\u6587\u5b57\u5217\u5927\u597d\u304d\u4eba\u9593\u306e\u305f\u3081\u306b\u66f8\u3044\u3066\u304a\u304f\u3068\uff0c\u6574\u6570\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u3092\u4eee\u5b9a\u3057\u307e\u3059\uff0e\u6587\u5b57\u5217\u5927\u597d\u304d\u4eba\u9593\u4ee5\u5916\u306f\u7121\u8996\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\u00a0\u21a9\n\n\n\u8a72\u5f53\u8a18\u4e8b\u3067\u306fLCP array\u4e0a\u3067RmQ\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u3067\u4efb\u610f\u306e2\u3064\u306e\u63a5\u5c3e\u8f9e\u306eLCP\u9577\u3092\u5b9a\u6570\u6642\u9593\u3067\u6c42\u3081\u3066\u3044\u307e\u3059\uff0eRmQ\u3092\u7528\u3044\u306a\u3044\u65b9\u6cd5\u304c[8]\u3067\u7d39\u4ecb\u3055\u308c\u3066\u307e\u3059\uff0eSuffix array\u4e0a\u306e\u63a2\u7d22\u3067\u805e\u304b\u308c\u308b\u533a\u9593\u306e\u7a2e\u985e\u306f\uff0c\u5e45\uff11\u306e\u533a\u9593\u304c$n$\u500b\uff0c\u5e452\u306e\u533a\u9593\u304c$n/2$\u500b\uff0c\u5e454\u306e\u533a\u9593\u304c$n/4$\u500b...\u3068\u3044\u3046\u611f\u3058\u306a\u306e\u3067\uff0c\u9ad8\u3005$2n$\u500b\u3057\u304b\u3042\u308a\u307e\u305b\u3093\uff0e\u305d\u306e\u305f\u3081\uff0c\u8ad6\u6587[8]\u3067\u306f\u5fc5\u8981\u306a$2n$\u500b\u306eLCP\u5024\u3092\u3059\u3079\u3066\u8a08\u7b97\u3057\u3066\u3044\u307e\u3059\uff0e[8]\u3067\u306f$O(n \\log n)$\u6642\u9593\u304b\u304b\u308b\u3068\u3055\u308c\u3066\u3044\u307e\u3059\u304c\uff0c\u5b9f\u969b\u306f$O(n)$\u6642\u9593\u3067\u8a08\u7b97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\u7d50\u5c40RmQ\u3082[8]\u306e\u65b9\u6cd5\u3082\u8a08\u7b97\u91cf\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u304c\uff0c\u4e00\u5ea6\u8a08\u7b97\u3057\u3066\u3057\u307e\u3048\u3070\u914d\u5217\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3060\u3051\u306e[8]\u306e\u307b\u3046\u304c\u9ad8\u901f\u3060\u3068\u601d\u3044\u307e\u3059\uff0e\u00a0\u21a9\n\n\nWexponential Search tree[9]\u306a\u3069\u304c\u3042\u308a\u307e\u3059\uff0e\u307e\u305f\uff0cHeavy node decomposition\u4e0a\u3067Suffix tree oracle\u3068\u547c\u3070\u308c\u308b\u30c7\u30fc\u30bf\u69cb\u9020\u304c\u63d0\u6848\u3055\u308c\u3066\u304a\u308a[1, 9]\uff0c\u305d\u306evariant\u304c\u6587\u5b57\u5217\u96c6\u5408\u306b\u5bfe\u3059\u308bSuffix tree\u306e\u30aa\u30f3\u30e9\u30a4\u30f3\u69cb\u7bc9\u306a\u3069\u306b\u5229\u7528\u3055\u308c\u3066\u3044\u307e\u3059[10]\uff0e\u00a0\u21a9\n\n\n\n\u3053\u308c\u306f[\u300c\u6587\u5b57\u5217\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0 Advent Calendar 2016\u300d](http://qiita.com/advent-calendar/2016/str)23\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n\u524d\u56de\u306e\u8a18\u4e8b\u306f@okateim\u306b\u3088\u308b[\u300cRange minimum Query\u300d](http://qiita.com/okateim/items/e2f4a734db4e5f90e410)\u3067\u3057\u305f\uff0e\n\u6b21\u56de\u306e\u8a18\u4e8b\u306f@kgoto\u306b\u3088\u308b[\u300c\u306a\u305c12\u670821\u65e5\u304c\u56de\u6587\u306e\u65e5\u306a\u306e\u304b\u3092\u8003\u3048\u3066\u307f\u305f\u300d](http://qiita.com/kgoto/items/d63f6b0f91d632b49709)\u3067\u3059\uff0e\n\n# \u306f\u3058\u3081\u306b\ngoonew\u3067\u3059\uff0e\u6587\u5b57\u5217\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff0c\u7279\u306b\u6587\u5b57\u5217\u306b\u5bfe\u3059\u308b\u7d22\u5f15\u306b\u3064\u3044\u3066\u7814\u7a76\u3057\u3066\u3044\u307e\u3059\uff0e\n\n\u3088\u304f\u77e5\u3089\u308c\u305f\u5168\u6587\u7d22\u5f15\u3068\u3057\u3066\uff0cSuffix tree(\u63a5\u5c3e\u8f9e\u6728)\u3068Suffix array\uff08\u63a5\u5c3e\u8f9e\u914d\u5217\uff09\u304c\u5b58\u5728\u3057\u307e\u3059\uff0e\u4e21\u8005\u306e\u3044\u3044\u3068\u3053\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3068Suffix tray\u3068\u547c\u3070\u308c\u308b\u7d22\u5f15\u306b\u306a\u308a\uff0c\u30a4\u30ab\u3059\uff08\u30af\u30a8\u30ea\u6642\u9593\u8a08\u7b97\u91cf\u304c\u6539\u5584\u3055\u308c\u308b\uff09\uff0c\u3068\u3044\u3046\u8ad6\u6587\u7d39\u4ecb\u304c\u3053\u306e\u8a18\u4e8b\u3067\u3059\uff0e\n\n\u8a72\u5f53\u3059\u308b\u8ad6\u6587\u306f\nRichard Cole, Tsvi Kopelowitz and Moshe Lewenstein. Suffix trays and Suffix Trists: Structures for Faster Text Indexing.  Algorithmica 72(2), 450-466, 2015.\n\u3067\u3059[1]\uff0e\u56fd\u969b\u4f1a\u8b70\u7248\u306fICALP2006\u306b\u901a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\uff0e\n\n\u672c\u8a18\u4e8b\u306e\u4ed6\u306b\uff0cSuffix tray\u3092\u7d39\u4ecb\u3057\u305f\u3082\u306e\u3068\u3057\u3066\uff0c\n- [Erik Demaine\u306e\u8b1b\u7fa9\u52d5\u753b](https://www.youtube.com/watch?v=NinWEPPrkDQ)\n- [Oren Weimann\u306e\u8b1b\u7fa9\u8cc7\u6599(pdf)](https://courses.csail.mit.edu/6.851/spring07/scribe/lec09.pdf)\n\u7b49\u304c\u5b58\u5728\u3057\u307e\u3059\uff0e\n\n\u3053\u306e\u8a18\u4e8b\u306b\u306fSuffix tray\u3092\u89e3\u8aac\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u77e5\u8b58\u3068\u3057\u3066\uff0c\u4ee5\u4e0b\u306e\u4e8b\u9805\u306b\u3064\u3044\u3066\u306e\u7c21\u5358\u306a\u89e3\u8aac\u304c\u3042\u308a\u307e\u3059\uff0e\n- Suffix tree\n- Suffix array\n- LCP array\n\n\u3084\u3063\u3066\u3044\u304d\u307e\u3057\u3087\u3046\uff0e\n\n# \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u30fb\u5168\u6587\u7d22\u5f15\n\n\u30c6\u30ad\u30b9\u30c8$T$\u306e\u4e2d\u304b\u3089\u30d1\u30bf\u30fc\u30f3$P$\u3092\u63a2\u3059\u554f\u984c\u3092\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3068\u547c\u3073\u307e\u3059\uff0e\n\u4ee5\u4e0b\u306e\u30c6\u30ad\u30b9\u30c8$T$\u304b\u3089\u30d1\u30bf\u30fc\u30f3$P = $ \"\u9c1b\u9c2f\u9b66\" \u3092\u63a2\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n\n\u30c6\u30ad\u30b9\u30c8$T = $ \"\u9bc6\u9c2f\u9c3b\u9c2f\u9c3b\u9b66\u9c1b\u9c2f\u9b5e\u9b5e\u9c1b\u9b66\u9c1b\u9b66\u9c1b\u9b66\u9c1b\u9b66\u9b66\u9c2f\u9c2f\u9bc6\u9c2f\u9c3b\u9c2f\u9c3b\u9b66\u9c1b\u9c2f\u9b5e\u9b5e\u9c1b\u9b66\u9c1b\u9b66\u9c1b\u9c2f\u9b66\u9c1b\u9b66\u9b66\u9c2f\u9c2f\"\n\n\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u304b\uff1f \u3053\u3046\u3044\u3046\u611f\u3058\u306e\u554f\u984c\u3067\u3059\uff0e\n\n\u30c6\u30ad\u30b9\u30c8$T$\u306e\u9577\u3055\u3092$n$\uff0c\u30d1\u30bf\u30fc\u30f3\u6587\u5b57\u5217$P$\u306e\u9577\u3055\u3092$m$\u3068\u3059\u308b\u3068\uff0c[KMP](https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)\u306e\u3088\u3046\u306a\u30c6\u30ad\u30b9\u30c8\u3092\u3059\u3079\u3066\u8210\u3081\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067$O(n + m)$\u6642\u9593\u3067\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\n\u5165\u529b\u30c6\u30ad\u30b9\u30c8\u306b\u5bfe\u3057\u524d\u51e6\u7406\u3092\u884c\u3044\uff0c\u5168\u6587\u7d22\u5f15\u3068\u547c\u3070\u308c\u308b\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3067\uff0c\u3053\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u3088\u308a\u9ad8\u901f\u306b\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\nSuffix tree\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092$O(m \\log \\sigma)$\u6642\u9593\uff0c\nSuffix array(+ LCP array)\u306f$O(m + \\log n)$\u6642\u9593\u3067\u89e3\u304d\u307e\u3059\uff0e\n\u305d\u308c\u3089\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3068$O(m + \\log \\sigma)$\u3092\u9054\u6210\u3067\u304d\u308b\u3068\u3044\u3046\u306e\u304cSuffix tray\u3067\u3059\uff0e\n$\\sigma$\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u30b5\u30a4\u30ba\uff08\u6587\u5b57\u306e\u7a2e\u985e\u6570\uff09\u3067\uff0c$n$\u3092\u8d85\u3048\u306a\u3044\u3067\u3059\uff0e\n\u3064\u307e\u308a\uff0c\u3088\u308a\u901f\u304f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u89e3\u3051\u308b\u308f\u3051\u3067\u3059\uff0e\n\u6c17\u6301\u3061\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u304b\uff1f\n\n\u4ee5\u4e0b\u3067\uff0cSuffix tree\u3068Suffix array\uff0cSuffix tray\u306e\u9806\u3067\u7d39\u4ecb\u3057\u307e\u3059\uff0e\n\n\uff08\u7279\u306b\uff0c\u30d1\u30bf\u30fc\u30f3\u304c\u5b58\u5728\u3059\u308b\u304b\u5426\u304b\u3092yes/no\u3067\u8fd4\u3059\u554f\u984c\u306fmember query\u3068\u547c\u3070\u308c\u307e\u3059\uff0e\u4ed6\u306b\uff0c\u51fa\u73fe\u56de\u6570\u3092\u8fd4\u3059count\u3084\u51fa\u73fe\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u8fd4\u3059locate\u306a\u3069\u304c\u3042\u308a\u307e\u3059\uff0e\u4ee5\u964d\u306fmember query\u3092\u8003\u3048\u307e\u3059\uff0e\uff09\n\n# Suffix Tree\n\n\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u30b5\u30a4\u30ba\uff08\u6587\u5b57\u30b7\u30f3\u30dc\u30eb\u306e\u7a2e\u985e\u6570\uff09$\\sigma$\uff0c\u9577\u3055$n$\u306e\u30c6\u30ad\u30b9\u30c8$T$\u3092\u8003\u3048\u307e\u3059\uff0e[^1]\n[^1]: \u6587\u5b57\u5217\u5927\u597d\u304d\u4eba\u9593\u306e\u305f\u3081\u306b\u66f8\u3044\u3066\u304a\u304f\u3068\uff0c\u6574\u6570\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u3092\u4eee\u5b9a\u3057\u307e\u3059\uff0e\u6587\u5b57\u5217\u5927\u597d\u304d\u4eba\u9593\u4ee5\u5916\u306f\u7121\u8996\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n\n\u30c6\u30ad\u30b9\u30c8$T$\u306b\u5bfe\u3059\u308bSuffix tree\u306f\uff0c$T$\u306e\u3059\u3079\u3066\u306e\u63a5\u5c3e\u8f9e\u3092\u6839\u304b\u3089\u306e\u30d1\u30b9\u3067\u8868\u73fe\u3057\u305f\u30b3\u30f3\u30d1\u30af\u30c8\u30c8\u30e9\u30a4\u3067\u3059\uff0e\n\uff08\u6587\u5b57\u5217$T$\u306e\u63a5\u5c3e\u8f9e\u3068\u306f\uff0c$T$\u3092\u5148\u982d\u304b\u30890\u6587\u5b57\u4ee5\u4e0a\u524a\u3063\u305f\u3082\u306e\u3067\u3059\uff0e\uff09\n\u4ee5\u4e0b\u306e\u56f3\u304c\u305d\u308c\u3067\u3059\uff0e\n\n![suffixtray_zu.002.jpeg](https://qiita-image-store.s3.amazonaws.com/0/11939/919898c8-238b-fba3-fe0a-899cd2f60853.jpeg)\n\n\u30b3\u30f3\u30d1\u30af\u30c8\u30c8\u30e9\u30a4\u3068\u3044\u3046\u306e\u306f\uff0c\u679d\u306b\u6587\u5b57\u5217\u304c\u3064\u3044\u305f\u6839\u4ed8\u304d\u6728\u3067\uff0c\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6e80\u305f\u3059\u3082\u306e\u3067\u3059\uff0e\n- \u6839\u3092\u9664\u304f\u5168\u3066\u306e\u5185\u90e8\u30ce\u30fc\u30c9\u306f2\u3064\u4ee5\u4e0a\u306e\u5b50\u30ce\u30fc\u30c9\u3092\u6301\u3064\uff0e\n- \u3042\u308b\u5185\u90e8\u30ce\u30fc\u30c9$v$\u304c\u6301\u3064outgoing edge (\u5b50\u30ce\u30fc\u30c9\u3078\u306e\u8fba)\u306b\u3064\u3044\u3066\u3044\u308b\u30e9\u30d9\u30eb\u306e\u5148\u982d\u6587\u5b57\u306f\u3059\u3079\u3066\u7570\u306a\u308b\uff0e\n\n\u3044\u3044\u3067\u3059\u306d\uff0e\nSuffix tree\u306b\u5fc5\u8981\u306a\u9818\u57df\u8a08\u7b97\u91cf\u3092\u8003\u3048\u307e\u3059\uff0e\u7d50\u8ad6\u304b\u3089\u3044\u3046\u3068$O(n)$ words\u3067\u3059\uff0e\n\u8a3c\u660e\u306e\u30b9\u30b1\u30c3\u30c1\u3060\u3051\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\uff0e\u8449\u30ce\u30fc\u30c9\u306e\u500b\u6570\u306f\u9ad8\u3005$n$\u500b\u3067\u3059\uff0e\u30b3\u30f3\u30d1\u30af\u30c8\u30e9\u30a4\u306e\u5b9a\u7fa9\u3088\u308a\uff0c\u5404\u5185\u90e8\u30ce\u30fc\u30c9\u306f\uff12\u3064\u4ee5\u4e0a\u306e\u5b50\u3092\u6301\u3064\u306e\u3067\uff0c\u5185\u90e8\u30ce\u30fc\u30c9\u306e\u500b\u6570\u306f\u6700\u5927$n-1$\u500b\u3060\u3068\u308f\u304b\u308a\u307e\u3059\uff0e\u3088\u3063\u3066\u30ce\u30fc\u30c9\u306e\u500b\u6570\u306f$O(n)$\u500b\uff0c\u3057\u305f\u304c\u3063\u3066\u8fba\u306e\u672c\u6570\u3082$O(n)$\u672c\u306b\u306a\u308a\u307e\u3059\uff0e\u30e9\u30d9\u30eb\u306e\u7dcf\u6587\u5b57\u5217\u9577\u306f$O(n^2)$\u306b\u898b\u3048\u307e\u3059\u304c\uff0c\u5404\u679d\u30e9\u30d9\u30eb\u306f\u5165\u529b\u30c6\u30ad\u30b9\u30c8$T$\u4e0a\u306e\u53c2\u7167\u3067\u8868\u73fe\u3067\u304d\u307e\u3059\uff0e\u4f8b\u3048\u3070\u4e0a\u306e\u56f3\u306b\u304a\u3051\u308b$coa$\u3068\u3044\u3046\u679d\u30e9\u30d9\u30eb\u306f\uff0c$T$\u306e$3$\u756a\u76ee\u304b\u3089$5$\u756a\u76ee\u307e\u3067\u306e\u6587\u5b57\u5217\u3068\u8868\u73fe\u3067\u304d\u308b\u306e\u3067\uff0c\u679d\u30e9\u30d9\u30eb\u306f\u6574\u6570\uff12\u3064\u3067\u8868\u73fe\u3067\u304d\u307e\u3059\uff0e\u305d\u3093\u306a\u308f\u3051\u3067\u307e\u3068\u3081\u3066$O(n)$ words\u3067\u3059\uff0e\u3053\u3093\u306a\u611f\u3058\u3067\u3059\uff0e\n\n\u3053\u306e\u63a5\u5c3e\u8f9e\u6728\u3092\u5165\u529b\u306b\u5bfe\u3057\u3066\u7dda\u5f62\u6642\u9593\u3067\u69cb\u7bc9\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u77e5\u3089\u308c\u3066\u3044\u307e\u3059[2]\uff0e\n\nSuffix tree\u4e0a\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306e\u30af\u30a8\u30ea\u3092\u304b\u3051\u307e\u3057\u3087\u3046\uff0e\n\u30d1\u30bf\u30fc\u30f3$P$\u304c\u5b58\u5728\u3059\u308b\u304b\u3069\u3046\u304b\u3092\u8abf\u3079\u305f\u3044\u3068\u304d\u306f\uff0c\u6839\u304b\u3089\u30d1\u30bf\u30fc\u30f3$P$\u3067\u6728\u3092\u8fbf\u308c\u3070\u826f\u3044\u3060\u3051\u3067\u3059\uff0e\n$m$\u6587\u5b57\u8fbf\u308b\u306e\u306b\u5fc5\u8981\u306a\u6642\u9593\u306f$O(m \\log \\sigma)$\u6642\u9593\u3067\u3059\uff0e\n\n## \u306a\u305c log \u03c3 ?\n\n\u601d\u3044\u51fa\u3057\u3066\u304a\u304f\u3068\uff0c$\\sigma$\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u30b5\u30a4\u30ba\uff08\u6587\u5b57\u30b7\u30f3\u30dc\u30eb\u306e\u7a2e\u985e\u6570\uff09\u3067\u3059\uff0e\nSuffix tree\u4e0a\u3092$m$\u6587\u5b57\u8fbf\u308b\u306e\u306b\u306f$O(m)$\u6642\u9593\u3067\u6e08\u307f\u305d\u3046\u3067\u3059\u304c\uff0c\u5404\u30ce\u30fc\u30c9\u304b\u3089\u51fa\u3066\u3044\u308b\u6700\u5927$\\sigma$\u500b\u306e\u679d\u304b\u3089\uff0c\u9069\u5207\u306a\u3082\u306e\u3092\u9078\u3076\u306e\u306b\uff12\u5206\u63a2\u7d22\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\uff0c\u6bce\u56de$O(\\log \\sigma)$\u6642\u9593\u304b\u304b\u308a\u307e\u3059\uff0e\uff08\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306b\u5168\u9806\u5e8f\u95a2\u4fc2\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u4eee\u5b9a\uff0e\uff09\n\n\u3053\u308c\u3092\u56de\u907f\u3059\u308b\u7b56\u3068\u3057\u3066\uff0c\u5404\u30ce\u30fc\u30c9\u306b\u9577\u3055$\\sigma$\u306e\u914d\u5217\u3092\u6301\u305f\u305b\uff0c\u5bfe\u5fdc\u3059\u308b\u5b50\u30ce\u30fc\u30c9\u3078\u5b9a\u6570\u6642\u9593\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u304c\uff0cSuffix tree\u306e\u9818\u57df\u8a08\u7b97\u91cf\u306f$O(n\\sigma)$ words\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\uff0e\n\u5225\u306e\u7b56\u3068\u3057\u3066\uff0c\u6587\u5b57\u3092key\u3068\u3057\u3066\u5bfe\u5fdc\u3059\u308b\u5b50\u30ce\u30fc\u30c9\u3092value\u306b\u3082\u3064\u8f9e\u66f8\uff08\u30cf\u30c3\u30b7\u30e5\uff09\u3092\u5404\u30ce\u30fc\u30c9\u306b\u6301\u305f\u305b\u308b\u65b9\u6cd5\u304c\u8003\u3048\u3089\u308c\u307e\u3059\uff0e\u3053\u308c\u306a\u3089\u3070\u5b9a\u6570\u6642\u9593\u30fb\u5b9a\u6570\u9818\u57df\u3067\u5b50\u30ce\u30fc\u30c9\u3078\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u3067\u3059\uff0e\u3057\u304b\u3057\u306a\u304c\u3089Deterministic\u306a\u8f9e\u66f8\u3060\u3068\u69cb\u7bc9\u306b$O(n \\; min( \\log \\sigma, \\log \\log n ))$\u6642\u9593\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3059[3]\uff0e\uff08Randomized\u306a\u8f9e\u66f8\u3092\u7528\u3044\u308c\u3070\uff0c\u7dda\u5f62\u6642\u9593\u3067\u69cb\u7bc9\u53ef\u80fd\u3067\u3059\uff0e\uff09\n\n\u307e\u3068\u3081\u308b\u3068\uff0cSuffix tree\u3092\u7dda\u5f62\u9818\u57df\u30fb\u7dda\u5f62\u6642\u9593\u3067\u69cb\u7bc9\u3059\u308b\u5834\u5408\uff0c\u6700\u60aa\u6c7a\u5b9a\u6027\u6642\u9593$O(m \\log \\sigma)$\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\n# Suffix Array\n\nSuffix array\u306f\uff0c\u4e0e\u3048\u3089\u308c\u305f\u5165\u529b\u30c6\u30ad\u30b9\u30c8$T$\u306e\u3059\u3079\u3066\u306e\u63a5\u5c3e\u8f9e\u3092\u30bd\u30fc\u30c8\u3057\uff0c\u305d\u306e\u30bd\u30fc\u30c8\u7d50\u679c\u3092\u6dfb\u5b57\u756a\u53f7\u306e\u914d\u5217\u3068\u3057\u3066\u6301\u3064\u3082\u306e\u3067\u3059\uff0e\n\n\u4ee5\u4e0b\u306e\u56f3\u3092\u307f\u3066\u304f\u3060\u3055\u3044\uff0e\n\n![suffixtray_zu.003.jpeg](https://qiita-image-store.s3.amazonaws.com/0/11939/076473dc-4f6e-ef18-a298-5d50ea9e7e4f.jpeg)\n\nSuffix array\u306e\u9818\u57df\u8a08\u7b97\u91cf\u306f\uff0c$n$\u500b\u306e\u6574\u6570\u304c\u4e26\u3093\u3067\u3044\u308b\u3060\u3051\u306a\u306e\u3067$O(n)$ words\u3067\u3059\uff0e\n\u307e\u305f\uff0c\u3053\u306e\u914d\u5217\u3092$O(n)$\u6642\u9593\u3067\u69cb\u7bc9\u3067\u304d\u308b\u3053\u3068\u304c\u77e5\u3089\u308c\u3066\u3044\u307e\u3059[4,5,6]\uff0e\n\nSuffix array\u4e0a\u3067\uff0c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306e\u30af\u30a8\u30ea\u3092\u304b\u3051\u307e\u3057\u3087\u3046\uff0e\n\u3042\u308b\u30d1\u30bf\u30fc\u30f3$P$\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\uff0cSuffix array\u4e0a\u306b\u5bfe\u5fdc\u3059\u308b\u7bc4\u56f2\u304c\u5b58\u5728\u3059\u308b\u306f\u305a\u3067\u3059\uff0e\n\u4ee5\u4e0b\u306e\u56f3\u3092\u307f\u3066\u304f\u3060\u3055\u3044\uff0e\n\n![suffixarray_naivematching.jpeg](https://qiita-image-store.s3.amazonaws.com/0/11939/0bb7ce0b-056c-eb14-6929-878724254d21.jpeg)\n\n\u914d\u5217\u4e0a\u306e\uff12\u5206\u63a2\u7d22\u3067\u9054\u6210\u3059\u308b\u3060\u3051\u3067\u3059\uff0e\n\u3064\u307e\u308a$O(m \\log n)$\u6642\u9593\u3067\u3059\uff0e\n$\\log n$\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u306e\u304c\u8f9b\u3044\u611f\u3058\u306a\u306e\u3067\uff0c\u6b21\u306e\u7bc0\u3067\u6539\u5584\u3057\u307e\u3059\uff0e\n\n## LCP Array\n\nSuffix array\u4e0a\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u9ad8\u901f\u306b\u884c\u3046\u305f\u3081\u306b\uff0cLCP array (Longest Common Prefix Array\uff0c\u6700\u9577\u5171\u901a\u63a5\u982d\u8f9e\u914d\u5217)\u3068\u3044\u3046\u3082\u306e\u3092\u8003\u3048\u307e\u3059\uff0e\nLCP array\u3068\u306f\uff0cSuffix array\u4e0a\u3067\u96a3\u3042\u3046\u63a5\u5c3e\u8f9e\u306e\u5171\u901a\u63a5\u982d\u8f9e\u306e\u9577\u3055\u3092\u683c\u7d0d\u3057\u305f\u914d\u5217\u3067\u3059\uff0e\u4ee5\u4e0b\u306e\u56f3\u3092\u898b\u3066\u304f\u3060\u3055\u3044\uff0e\u3061\u306a\u307f\u306bSuffix array\u3088\u308a\u7dda\u5f62\u6642\u9593\u3067\u6c42\u3081\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u77e5\u3089\u308c\u3066\u3044\u307e\u3059[7]\uff0e\n\n![suffixtray_zu.006.jpeg](https://qiita-image-store.s3.amazonaws.com/0/11939/c04ecc44-3e45-1149-6d4c-0861c457c9d0.jpeg)\n\nSuffix array\u3068LCP array\u3092\u4f7f\u3063\u3066\u9ad8\u901f\u306b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u884c\u3046\u65b9\u6cd5\u306f\uff0c[echizen_tm\u6c0f\u306e\u30d6\u30ed\u30b0\u8a18\u4e8b\u3067\u8a73\u3057\u304f\u89e3\u8aac\u3055\u308c\u3066\u3044\u307e\u3059](http://d.hatena.ne.jp/echizen_tm/20110728/1311871765)[^2]\uff0e\u306e\u3067\uff0c\u305d\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n\u53c2\u7167\u3057\u307e\u3057\u305f\u304b?? \u305d\u3093\u306a\u308f\u3051\u3067\uff0cLCP array\u3092\u7528\u3044\u308b\u3053\u3068\u3067$O(m + \\log n)$\u6642\u9593\u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u8a08\u7b97\u3067\u304d\u307e\u3059\uff0e\u3088\u304b\u3063\u305f\u3067\u3059\u306d\uff0e\n[^2]: \u8a72\u5f53\u8a18\u4e8b\u3067\u306fLCP array\u4e0a\u3067RmQ\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u3067\u4efb\u610f\u306e2\u3064\u306e\u63a5\u5c3e\u8f9e\u306eLCP\u9577\u3092\u5b9a\u6570\u6642\u9593\u3067\u6c42\u3081\u3066\u3044\u307e\u3059\uff0eRmQ\u3092\u7528\u3044\u306a\u3044\u65b9\u6cd5\u304c[8]\u3067\u7d39\u4ecb\u3055\u308c\u3066\u307e\u3059\uff0eSuffix array\u4e0a\u306e\u63a2\u7d22\u3067\u805e\u304b\u308c\u308b\u533a\u9593\u306e\u7a2e\u985e\u306f\uff0c\u5e45\uff11\u306e\u533a\u9593\u304c$n$\u500b\uff0c\u5e452\u306e\u533a\u9593\u304c$n/2$\u500b\uff0c\u5e454\u306e\u533a\u9593\u304c$n/4$\u500b...\u3068\u3044\u3046\u611f\u3058\u306a\u306e\u3067\uff0c\u9ad8\u3005$2n$\u500b\u3057\u304b\u3042\u308a\u307e\u305b\u3093\uff0e\u305d\u306e\u305f\u3081\uff0c\u8ad6\u6587[8]\u3067\u306f\u5fc5\u8981\u306a$2n$\u500b\u306eLCP\u5024\u3092\u3059\u3079\u3066\u8a08\u7b97\u3057\u3066\u3044\u307e\u3059\uff0e[8]\u3067\u306f$O(n \\log n)$\u6642\u9593\u304b\u304b\u308b\u3068\u3055\u308c\u3066\u3044\u307e\u3059\u304c\uff0c\u5b9f\u969b\u306f$O(n)$\u6642\u9593\u3067\u8a08\u7b97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\u7d50\u5c40RmQ\u3082[8]\u306e\u65b9\u6cd5\u3082\u8a08\u7b97\u91cf\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u304c\uff0c\u4e00\u5ea6\u8a08\u7b97\u3057\u3066\u3057\u307e\u3048\u3070\u914d\u5217\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3060\u3051\u306e[8]\u306e\u307b\u3046\u304c\u9ad8\u901f\u3060\u3068\u601d\u3044\u307e\u3059\uff0e\n\n\u8a08\u7b97\u91cf\u306e$O(m + \\log n)$\u6642\u9593\u306b\u3064\u3044\u3066\uff0c\u6700\u521d\u306e\u9805$m$\u306f\u30d1\u30bf\u30fc\u30f3\u9577\u306b\u3088\u308b\u3082\u306e\u3067\u3042\u308a\uff0c$\\log n$\u306e\u9805\u306f\u9577\u3055$n$\u306e\u7bc4\u56f2\u3092\uff12\u5206\u63a2\u7d22\u3059\u308b\u306e\u306b\u304b\u304b\u308b\u30b3\u30b9\u30c8\u3068\u3044\u3046\u3053\u3068\u3067\u3059\uff0e\u5c11\u3057\u3042\u3068\u3067\u4f7f\u3044\u307e\u3059\uff0e\n\n# Suffix Tray\n\n\u3053\u3053\u307e\u3067\u3067\uff0cSuffix tree\u3068Suffix array\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u898b\u3066\u304d\u307e\u3057\u305f\uff0e\nSuffix tray\u306fCole\u3089\u306b\u3088\u3063\u3066\u63d0\u6848\u3055\u308c\u305f\uff0cSuffix tree\u3068Suffix array\u3092\u7d44\u307f\u5408\u308f\u305b\u305f\u30c7\u30fc\u30bf\u69cb\u9020\u3067\u3059[1]\uff0e\u9818\u57df\u306f$O(n)$ words\u3067\u5909\u308f\u3089\u305a\uff0c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u6700\u60aa\u6c7a\u5b9a\u6642\u9593$O(m + \\log \\sigma)$\u3067\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\n\n\u3068\u308a\u3042\u3048\u305a\uff0c\u96d1\u306bSuffix tree\u3068Suffix array\u3092\u7d44\u307f\u5408\u308f\u305b\u307e\u3057\u3087\u3046\uff0e\nSuffix tree\u306e\u679d\u304c\u5148\u982d\u30e9\u30d9\u30eb\u3067\u30bd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u4eee\u5b9a\u3059\u308b\u3068\uff0c\nSuffix tree\u306e\u8449\u30ce\u30fc\u30c9\u306fSuffix array\u3068\u5bfe\u5fdc\u3057\u307e\u3059\uff0e\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3059\uff0e\n\n![suffixtray_zu.008.jpeg](https://qiita-image-store.s3.amazonaws.com/0/11939/d80722f6-7e59-53dd-1b47-3eec4503c9b6.jpeg)\n\nSuffix tree\u306e\u30af\u30a8\u30ea\u6642\u9593\u304c$O(n \\log \\sigma)$\u3067\u3042\u308b\u7406\u7531\u306f\uff0c\n\u6700\u5927$\\sigma$\u500b\u3042\u308b\u679d\u304b\u3089\u6b63\u3057\u3044\u3082\u306e\u3092\uff12\u5206\u63a2\u7d22\u3067\u9078\u629e\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u304b\u3089\u3067\u3057\u305f\uff0e\u305d\u308c\u3092\u56de\u907f\u3059\u308b\u65b9\u6cd5\u3068\u3057\u3066\uff0c\u5404\u30ce\u30fc\u30c9\u304c\u9577\u3055$\\sigma$\u306e\u914d\u5217\u3092\u6301\u3061\uff0c\u5b9a\u6570\u6642\u9593\u3067\u5bfe\u5fdc\u3059\u308b\u30ce\u30fc\u30c9\u3078\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3057\u305f\u304c\uff0c\u9818\u57df\u8a08\u7b97\u91cf\u306f$O(n \\sigma)$ words\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\uff0e\n\u305d\u308c\u306a\u3089\u3070\uff0cSuffix tree\u3092\u4e0a\u624b\u306b\u9593\u5f15\u3044\u3066\u30ce\u30fc\u30c9\u6570\u3092$O(n / \\sigma)$\u500b\u306b\u3057\u3066\u3042\u3052\u308c\u3070\uff0c\u305f\u3068\u3048\u5404\u30ce\u30fc\u30c9\u304c$\\sigma$\u30b5\u30a4\u30ba\u306e\u914d\u5217\u3092\u6301\u3063\u305f\u3068\u3057\u3066\u3082\u7dda\u5f62\u9818\u57df\u3067\u6e08\u307f\u307e\u3059\uff0e\u9593\u5f15\u3044\u305f\u5206\u306fSuffix array\u3067\u88dc\u3046\u3053\u3068\u3067\u30af\u30a8\u30ea\u3092\u89e3\u304d\u307e\u3059\uff0e\u3053\u308c\u304cSuffix tray\u306e\u57fa\u672c\u7684\u306a\u30a2\u30a4\u30c7\u30a2\u3067\u3059\uff0e\n\n\u6b21\u306e\u7bc0\u3067\u9593\u5f15\u304d\u65b9\u3092\u898b\u3066\u3044\u304d\u307e\u3059\uff0e\n\n## Heavy Node Decomposition\n\nSuffix tree\u4e0a\u306e\u30ce\u30fc\u30c9$v$\u304c\u4ee5\u4e0b\u3092\u6e80\u305f\u3059\u3068\u304d\uff0c$v$\u3092$\\sigma$\u30ce\u30fc\u30c9\u3068\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\n- $v$\u3092\u6839\u3068\u3059\u308b\u90e8\u5206\u6728\u306b\u542b\u307e\u308c\u308b\u8449\u304c$\\sigma$\u500b\u4ee5\u4e0a\u3067\u3042\u308b\uff0e\n$\\sigma$\u30ce\u30fc\u30c9\u306fHeavy node\u3068\u547c\u3070\u308c\u308b\u3053\u3068\u3082\u3042\u308a\u307e\u3059\uff0e\n\u307e\u305f$\\sigma$\u30ce\u30fc\u30c9\u3067\u306a\u3044\u3082\u306e\u3092Light\u30ce\u30fc\u30c9\u3068\u5b9a\u7fa9\u3057\u307e\u3059\uff0e\n\n$\\sigma$\u30ce\u30fc\u30c9\u3092\u3055\u3089\u306b\u4ee5\u4e0b\u306e\uff13\u3064\u306e\u30bf\u30a4\u30d7\u306b\u5206\u985e\u3057\u307e\u3059\uff0e\n- $\\sigma$ leaf: \u3059\u3079\u3066\u306e\u5b50\u30ce\u30fc\u30c9\u304c$\\sigma$\u30ce\u30fc\u30c9\u3067\u306a\u3044\uff0e\n- branching $\\sigma$\u30ce\u30fc\u30c9: 2\u3064\u4ee5\u4e0a\u306e$\\sigma$\u30ce\u30fc\u30c9\u3092\u5b50\u30ce\u30fc\u30c9\u3068\u3057\u3066\u6301\u3064\uff0e\n- non-branching $\\sigma$\u30ce\u30fc\u30c9: \u4e0a\u8a182\u3064\u306b\u8a72\u5f53\u3057\u306a\u3044$\\sigma$\u30ce\u30fc\u30c9\uff0e\n\nSuffix tree\u306e\u5404\u30ce\u30fc\u30c9\u3092\u30bf\u30a4\u30d7\u5206\u3051\u3057\u305f\u4f8b\u3092\u4ee5\u4e0b\u306b\u793a\u3057\u307e\u3059\uff0e\u8ad6\u6587[1]\u3067\u7528\u3044\u3089\u308c\u3066\u3044\u308b\u4f8b\u3068\u540c\u3058\u3082\u306e\u3067\u3059\uff0e\n![suffixtray_zu.001.jpeg](https://qiita-image-store.s3.amazonaws.com/0/11939/ae42abc1-f7d6-ea17-39d1-0522bf3dff88.jpeg)\n\n\u3053\u3046\u3057\u3066\u5f97\u3089\u308c\u305fbranching$\\sigma$\u30ce\u30fc\u30c9\u3067\u3059\u304c\uff0c\nSuffix tree\u4e0a\u306b$O(n / \\sigma)$\u500b\u3057\u304b\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\uff0e\n\u7406\u7531\u3068\u3057\u3066\u306f\uff0c$\\sigma$ leaf\u304c\u9ad8\u3005$(n / \\sigma)$\u500b\u3057\u304b\u5b58\u5728\u3057\u306a\u3044\u304b\u3089\u3067\u3059\uff0e\uff08$\\sigma$\u30ce\u30fc\u30c9\u306e\u5b9a\u7fa9\u3092\u601d\u3044\u51fa\u3059\u3068\uff0c\u90e8\u5206\u6728\u306e\u8449\u30ce\u30fc\u30c9\u306e\u6570\u304c$\\sigma$\u500b\u4ee5\u4e0a\u3067\u3057\u305f\uff0e\uff09\n\u3053\u306e\u5206\u89e3\u3092\uff0c\u3044\u307e\u79c1\u304c\u52dd\u624b\u306bHeavy node decomposition\u3068\u540d\u4ed8\u3051\u307e\u3057\u305f\uff0e\u6700\u8fd1\u3044\u308d\u3044\u308d\u4f7f\u308f\u308c\u3066\u3044\u307e\u3059[^3]\uff0e\n[^3]: Wexponential Search tree[9]\u306a\u3069\u304c\u3042\u308a\u307e\u3059\uff0e\u307e\u305f\uff0cHeavy node decomposition\u4e0a\u3067Suffix tree oracle\u3068\u547c\u3070\u308c\u308b\u30c7\u30fc\u30bf\u69cb\u9020\u304c\u63d0\u6848\u3055\u308c\u3066\u304a\u308a[1, 9]\uff0c\u305d\u306evariant\u304c\u6587\u5b57\u5217\u96c6\u5408\u306b\u5bfe\u3059\u308bSuffix tree\u306e\u30aa\u30f3\u30e9\u30a4\u30f3\u69cb\u7bc9\u306a\u3069\u306b\u5229\u7528\u3055\u308c\u3066\u3044\u307e\u3059[10]\uff0e\n\nbranching$\\sigma$\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u306f\uff0c\u30b5\u30a4\u30ba$\\sigma$\u306e\u914d\u5217\u3092\u3082\u305f\u305b\uff0c$O(1)$\u6642\u9593\u3067\u306e\u5b50\u30ce\u30fc\u30c9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u5b9f\u73fe\u3057\u307e\u3059\uff0e\n\u305d\u308c\u4ee5\u5916\u306e\u30ce\u30fc\u30c9\u306b\u95a2\u3057\u3066\u306f\uff0c\u5b50\u30ce\u30fc\u30c9\u3068\u3057\u3066\u9ad8\u30051\u3064\u306e$\\sigma$\u30ce\u30fc\u30c9\u3068$\\sigma$\u500b\u4ee5\u4e0b\u306eLight\u30ce\u30fc\u30c9\u3057\u304b\u3082\u305f\u306a\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\uff0eLight\u30ce\u30fc\u30c9\u306e\u96c6\u5408\u306f2\u3064\u306eSuffix interval\u3067\u8868\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff08\u4ee5\u4e0b\u306e\u56f3\u3092\u898b\u3066\u304f\u3060\u3055\u3044\uff09\uff0e\u30e9\u30d9\u30eb\u3092\u3082\u3064\u5b50\u306f\uff11\u3064\u3060\u3051\u3067\u3059\uff0e\u3064\u307e\u308a\uff0c\u9069\u5207\u306a\u679d\u3092\u9078\u3076\u306e\u306b\u5fc5\u8981\u306a\u30b3\u30b9\u30c8\u306f$O(1)$\u3067\u3059\uff0e\n\n![suffixtray_zu.002.jpeg](https://qiita-image-store.s3.amazonaws.com/0/11939/9c74bb97-1362-abaf-1679-4ced89e33bae.jpeg)\n\n## Suffix Interval\n\u4e0a\u8a18\u306e\u56f3\u3067\u306f\uff0c\u6839\u30ce\u30fc\u30c9\u304b\u3089\u5bfe\u5fdc\u3059\u308bSuffix interval\u307e\u3067$O(m)$\u6642\u9593\u3067\u5230\u9054\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff0e\nSuffix interval\u306fSuffix array\u306e\u3042\u308b\u7bc4\u56f2\u3067\u3059\uff0e\u3053\u306eInterval\u306e\u6700\u5927\u9577\u3092\u8003\u3048\u3066\u307f\u307e\u3059\uff0e$O(\\sigma ^2)$\u30b5\u30a4\u30ba\u3067\u3059\uff0e\u306a\u305c\u304b\u3068\u3044\u3046\u3068\uff0c\u3042\u308b$\\sigma$\u30ce\u30fc\u30c9\u306f\uff0c\u6700\u5927$\\sigma$\u500b\u306e$light$\u30ce\u30fc\u30c9\u3092\u6301\u3061\u307e\u3059\uff0e$light$\u30ce\u30fc\u30c9\u306e\u5b9a\u7fa9\u306f\uff0c\u81ea\u5206\u81ea\u8eab\u3092\u6839\u3068\u3059\u308b\u90e8\u5206\u6728\u306e\u8449\u30ce\u30fc\u30c9\u304c$\\sigma$\u500b\u672a\u6e80\u306e\u30ce\u30fc\u30c9\u3067\u3057\u305f\uff0e\u3088\u3063\u3066\uff0c$\\sigma$\u500b\u306eLight\u30ce\u30fc\u30c9\u304c\u5404\u3005$\\sigma$\u500b\u306e\u8449\u3092\u6301\u3064\u3068\u3057\u3066\uff0cSuffix Interval\u306f\u3082\u3068\u3082\u3068\u306e\u8449\u30ce\u30fc\u30c9\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u304b\u3089\uff0c\u6700\u5927$\\sigma ^2$\u30b5\u30a4\u30ba\u306eInterval\u3092\u3082\u3064\u3053\u3068\u306b\u306a\u308a\u307e\u3059\uff0e\n\nSuffix array\u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306b\u304b\u304b\u308b\u6642\u9593\u8a08\u7b97\u91cf\u3092\u601d\u3044\u51fa\u3059\u3068\uff0c$O(\u30d1\u30bf\u30fc\u30f3\u9577 + \\log (Interval\u9577))$\u3067\u3057\u305f\uff0e\n\u3064\u307e\u308a\uff0cSuffix tray\u306eInterval\u5185\u3067\u306e\u691c\u7d22\u6642\u9593\u8a08\u7b97\u91cf\u306f$O(m + \\log \\sigma ^2) = O(m + \\log \\sigma)$\u306b\u306a\u308a\u307e\u3059\uff0e\nSuffix tray\u306e\u6839\u304b\u3089\u30d1\u30bf\u30fc\u30f3$P$\u306b\u5bfe\u5fdc\u3059\u308bInterval\u307e\u3067\u306f$O(m)$\u3067\u5230\u9054\u3067\u304d\u307e\u3059\u304b\u3089\uff0c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u306f\u5408\u8a08\u3067$O(m) + O(m + \\log \\sigma) = O(m + \\log \\sigma)$\u6642\u9593\u3067\u3059\uff01\u3084\u3063\u305f\u3042\uff0eSuffix tree\u3084Suffix array\u3088\u308a\u3082\uff08\u7406\u8ad6\u4e0a\uff09\u901f\u304f\u306a\u308a\u307e\u3057\u305f\uff01\n\n\u3061\u306a\u307f\u306b\u69cb\u7bc9\u3082\u7dda\u5f62\u6642\u9593\u3067\u3059\uff0eSuffix tree\uff0cSuffix array\u3068\u3082\u306b\u7dda\u5f62\u6642\u9593\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3057\uff0c\u306a\u3093\u3068\u306a\u304f\u305d\u3093\u306a\u6c17\u304c\u3057\u307e\u3059\u306d\uff0e\n\n# \u7d50\u8ad6\n\n\u305d\u3093\u306a\u308f\u3051\u3067\uff0cSuffix tray\u306f\u7dda\u5f62\u6642\u9593\u30fb\u7dda\u5f62\u9818\u57df\u3067\u69cb\u7bc9\u3067\u304d\uff0c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092$O(m + \\log \\sigma)$\u6700\u60aa\u6c7a\u5b9a\u6642\u9593\u3067\u30b5\u30dd\u30fc\u30c8\u3057\u307e\u3059\uff0e\u3061\u306a\u307f\u306b\u540c\u8ad6\u6587\u3067\u306f\uff0cSuffix array\u306e\u90e8\u5206\u3092Linked list\u306b\u5909\u66f4\u3057\u30aa\u30f3\u30e9\u30a4\u30f3\u69cb\u7bc9\u3092\u53ef\u80fd\u306b\u3057\u305fSuffix trist\u3082\u7d39\u4ecb\u3055\u308c\u3066\u3044\u307e\u3059\uff0e\n\n\u65e5\u672c\u6642\u9593\u3060\u3068\u30af\u30ea\u30b9\u30de\u30b9\u304c\u7d42\u308f\u3063\u3066\u304a\u308a\uff0c\u30a2\u30c9\u30d9\u30f3\u30c8\u30ab\u30ec\u30f3\u30c0\u30fc\u7684\u306b\u306f\u9045\u523b\u3067\u3059\u304c\uff0c\u30a2\u30e1\u30ea\u30ab\u9818\u30b5\u30e2\u30a2\u3067\u306f\u307e\u3060\uff12\uff15\u65e5\u306a\u306e\u3067\uff0c\u3053\u308c\u306b\u3066\u3088\u3057\u3068\u3057\u307e\u3059\uff0e\n\u30e1\u30ea\u30fc\u30af\u30ea\u30b9\u30de\u30b9\uff0e\u3081\u3067\u305f\u3044\u3067\u3059\u306d\uff0e\n\n\n# \u53c2\u8003\u6587\u732e\n[1] Richard Cole, Tsvi Kopelowitz and Moshe Lewenstein. Suffix Trays and Suffix Trists: Structures for Faster Text Indexing.  Algorithmica 72(2), 450-466, 2015.\n[2] Martin Farach-Colton, Paolo Ferragina and S. Muthukrishnan. On the sorting-complexity of suffix tree construction. J. ACM 47(6), 987-1011, 2000.\n[3] Milan Ruzic. Constructing Efficient Dictionaries in Close to Sorting Time. In Proc. ICALP (1), 84-95, 2008.\n[4] Juha K\u00e4rkk\u00e4inen, Peter Sanders, Stefan Burkhardt. Linear work suffix array construction. In J. of the ACM, 53(6), 918-936, 2006.\n[5] Dong Kyue Kim, Jeong Seop Sim, Heejin Park, Kunsoo Park. Constructing suffix arrays in linear time. J. Discrete Algorithms, 3(2-4), 126-142, 2005.\n[6] Pang Ko, Srinivas Aluru. Space efficient linear time construction of suffix arrays. J. Discrete Algorithms, 3(2-4), 143-156, 2005.\n[7] Toru Kasai, Gunho Lee, Hiroki Arimura, Setsuo Arikawa and Kunsoo Park. Linear-Time Longest-Common-Prefix Computation in Suffix Arrays and Its Applications. In Proc. CPM2001, 181-192, 2001.\n[8] Udi Manber, Eugene W. Myers. Suffix arrays: A new method for on-line string searches. SIAM J. on Computing, 22(5), 935-948, 1993.\n[9] Fischer, J., Gawrychowski, P. Alphabet-dependent string searching with wexponential search trees. In Proc. CPM2015, 160\u2013171, 2015.\n[10] Takuya Takagi, Shunsuke Inenaga, Hiroki Arimura. Fully-online Construction of Suffix Trees for Multiple Texts. In Proc. CPM2016, 22:1-22:13, 2016.\n\n\n", "tags": ["\u6587\u5b57\u5217", "\u30c7\u30fc\u30bf\u69cb\u9020"]}