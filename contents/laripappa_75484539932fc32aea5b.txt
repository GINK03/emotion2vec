{"context": "d3.js\u306f\u3001\u30c7\u30fc\u30bf\u30c9\u30ea\u30d6\u30f3\u3067\u8272\u3005\u304b\u3063\u3053\u3044\u3044\u30b0\u30e9\u30d5\u306a\u3069\u304c\u66f8\u3051\u308bJavascript\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066\u6709\u540d\u3067\u3059\u3002 \u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u3001IoT\u30bb\u30f3\u30b5\u30fc\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c1\u30e3\u30fc\u30c8\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\u7d20\u4eba\u306a\u306e\u3067\u3001\u30b3\u30fc\u30c9\u306b\u306f\u554f\u984c\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u305d\u306e\u969b\u306f\u3054\u6307\u6458\u3044\u305f\u3060\u3051\u308b\u3068\u5e78\u3044\u3067\u3059><\n\nIoT\u30c7\u30d0\u30a4\u30b9\u3068\u306e\u63a5\u7d9a/\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\n\u30c7\u30d0\u30a4\u30b9\u3092\u4f7f\u3063\u3066\u3044\u308b\u304b\u306f\u5177\u4f53\u7684\u306b\u306f\u8aac\u660e\u3057\u307e\u305b\u3093\u3002\u5404\u3005\u306e\u30c7\u30d0\u30a4\u30b9\u6bce\u306b\u3057\u304b\u308b\u3079\u304d\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u304f\u3060\u3055\u3044\u3002 \u79c1\u304c\u4f7f\u7528\u3057\u3066\u3044\u308b\u30c7\u30d0\u30a4\u30b9\u306f\u3001GET\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u3084\u308b\u3068\u30bb\u30f3\u30b5\u30fc\u306e\u5024\u3092\u8fd4\u3057\u3066\u304f\u308c\u307e\u3059\u3002 \u5177\u4f53\u7684\u306b\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n const url = \"hogehoge\";\n var xhr = new XMLHttpRequest();\n xhr.addEventListener('error', function() {\n      alert(\"Not establish connection\");\n      // \u30a8\u30e9\u30fc\u51e6\u7406\n       });\n\nxhr.addEventListener('loadend', function() {\n   if (xhr.status === 200 && xhr.readyState === 4) {\n      const res = parseFloat(xhr.responseText);\n      const now = new Date();\n      dataset.push({\n         time: now,\n         val: res\n         });\n    else {\n       console.error(xhr.status + ' ' + xhr.statusText);\n    }\n});\n\nxhr.open(\"GET\", url + '/brightness', false);\n// \u3053\u3053\u3067\u306f\u30bb\u30f3\u30b5\u30fc\u306e\u3046\u3061\u306e\u7167\u5ea6\u30bb\u30f3\u30b5\u30fc\u3092\u4f7f\u3063\u305f\u3068\u3057\u307e\u3059\nxhr.send(null);\n// \u672c\u6765\u306f\u975e\u540c\u671f\u3067\u9001\u3063\u305f\u65b9\u304c\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u7c21\u5358\u306e\u305f\u3081\u306b\u540c\u671f\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u3042\u3052\u307e\u3059\nxhr.send(null);\n\n\nd3.js\u306e\u4f7f\u7528\nd3.js\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\u3053\u3053\u3067\u306f\u3001\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306e\u91cf\u304c\u591a\u3044\u3001d3.js\u306eversion3\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\nCDN\u3067\u7528\u3044\u308b\u306b\u306f\u6b21\u306e\u3088\u3046\u306b\u52a0\u3048\u308b\u3060\u3051\u3067\u5927\u4e08\u592b\u3067\u3059\u3002\n<script src=\"https://d3js.org/d3.v3.min.js\"></script>\n\n\u307e\u305a\u306f\u30b0\u30e9\u30d5\u306e\u63cf\u753b\u306e\u5143\u3068\u306a\u308b\u3082\u306e\u306e\u5ba3\u8a00\u3067\u3059\u3002\nvar margin = {\n            top: 30,\n            right: 50,\n            bottom: 30,\n            left: 50\n        };\nvar width = 600 - margin.left - margin.right;\nvar height = 500 - margin.top - margin.bottom;\nvar xScale = d3.time.scale()\n            .range([0, width]);\n//x\u8ef8\u306f\u6642\u9593\u306e\u30b9\u30b1\u30fc\u30eb\u306b\u306a\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\n\nvar yScale = d3.scale.linear()\n            .range([height, 0]);\n\n\nvar xAxis = d3.svg.axis()\n            .scale(xScale)\n            .orient(\"bottom\")\n            .tickFormat(d3.time.format('%M:%S'));\n\nvar yAxis = d3.svg.axis()\n            .scale(yScale)\n            .orient(\"left\");\n\n// \u7dda\u306e\u5b9a\u7fa9\nvar line = d3.svg.line()\n            .x(function(d) {\n                return xScale(d.time);\n            })\n            .y(function(d) {\n                return yScale(d.val);\n            })\n            .interpolate(\"cardinal\");\n            // \u70b9\u306e\u9593\u306e\u88dc\u9593\u3092cardinal\u306b\u8a2d\u5b9a\n\n// svg\u306e\u5b9a\u7fa9\nvar svg = d3.selectAll(\"#d3graph\").append(\"svg\")\n// \u3053\u306ed3\u306eselectAll\u30e1\u30bd\u30c3\u30c9\u306b\u3088\u308a\u3001\u57fa\u3068\u306a\u308bHTML\u306e <div id=\"d3graph\"> </div>\u306a\u308b\u8981\u7d20\u3092\u5f15\u3063\u5f35\u3063\u3066\u304d\u307e\u3059\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\n\u3053\u308c\u3067\u5927\u4f53\u306e\u63cf\u753b\u306f\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u305d\u306e\u3042\u3068\u306f\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u304f\u308b\u305f\u3073\u306b\u63cf\u753b\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4ed8\u3051\u8db3\u305b\u3070\u5b8c\u4e86\u3067\u3059\u3002\n function update() {\n            if (dataset.length > 20) {\n                dataset.shift();\n                // \u30c7\u30fc\u30bf\u6570\u304c20\u3092\u8d85\u3048\u305f\u3089\u5165\u3063\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092\u6d88\u3057\u307e\u3059        \n            }\n            svg.selectAll(\"path\").remove();\n            // xy\u8ef8\u524a\u9664\n            svg.selectAll(\"g\").remove();\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000// \u7dda\u306e\u524a\u9664\n\n            xScale.domain(d3.extent(dataset, function(d) {\n                return d.time;\n            }));\n            yScale.domain(d3.extent(dataset, function(d) {\n                 return d.val;\n             })).nice();\n            //xy\u8ef8\u305d\u308c\u305e\u308c\u306e\u30c9\u30e1\u30a4\u30f3\u3092dataset\u306emin, max\u306e\u7bc4\u56f2\u306b\u53ce\u3081\u307e\u3059\n\n            svg.append(\"g\")\n                .attr(\"class\", \"y axis\")\n                .call(yAxis)\n                .append(\"text\")\n                .attr(\"y\", -10)\n                .attr(\"x\", 10)\n                .style(\"text-anchor\", \"end\")\n                .text(\"\u5024\");\n            // y\u8ef8\u306e\u518d\u63cf\u753b\n\n            svg.append(\"g\")\n                .attr(\"class\", \"x axis\")\n                .call(xAxis)\n                .attr(\"transform\", \"translate(0,\" + height + \")\")\n            // x\u8ef8\u306e\u518d\u63cf\u753b\n\n            // path\u8981\u7d20\u3092svg\u306b\u8868\u793a\u3057\u3001\u6298\u308c\u7dda\u30b0\u30e9\u30d5\u3092\u8a2d\u5b9a\n            svg.append(\"path\")\n                .datum(dataset)\n           // line\u3068dataset\u306ebind\n                .attr(\"fill\", \"none\")\n                .attr(\"stroke\", \"steelblue\")\n                .attr(\"stroke-linejoin\", \"round\")\n                .attr(\"stroke-linecap\", \"round\")\n                .attr(\"stroke-width\", 1.5)\n                .attr(\"d\", line);\n        };\n\n\n\u3053\u306eupdate()\u3092\u5b9a\u671f\u7684\u306b\u7e70\u308a\u8fd4\u3057\u3066\u3042\u3052\u308c\u3070\u63cf\u753b\u5b8c\u4e86\u3067\u3059\u3002\n\u5ff5\u306e\u305f\u3081\u3001\u8cbc\u308a\u4ed8\u3051\u308b\u3060\u3051\u3067\u4f7f\u3048\u308bHTML\u3092\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u8cbc\u3063\u3066\u304a\u304d\u307e\u3059\u3002\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <style type=\"text/css\">\n        .axis text {\n            font: 10px sans-serif;\n        }\n        .axis path {\n            opacity: 0.1;\n            stroke: #000;\n            stroke-width: 0.1;\n            shape-rendering: crispEdges;\n        }\n        .axis line {\n            stroke: #000;\n            stroke-width: 1;\n            shape-rendering: crispEdges;\n        }\n        .line {\n            fill: none;\n            stroke: DarkGreen;\n            stroke-width: 1.5px;\n        }\n    </style>\n</head>\n\n<body>\n        <div id=\"d3graph\"></div>\n    <script src=\"http://d3js.org/d3.v3.min.js\"></script>\n    <script>\n        window.addEventListener(\"loaded\", update, false);\n\n        var dataset = [];\n\n        function generateData() {\n            const now = new Date();\n            const data = {\n                time: now,\n                val: Math.random() * 10\n            };\n            dataset.push(data)\n        }\n\n        var margin = {\n            top: 30,\n            right: 50,\n            bottom: 30,\n            left: 50\n        };\n        var width = 600 - margin.left - margin.right;\n        var height = 500 - margin.top - margin.bottom;\n\n        var xScale = d3.time.scale()\n            .range([0, width]);\n\n        var yScale = d3.scale.linear()\n            .range([height, 0])\n            .domain([0, 10]);\n\n        var xAxis = d3.svg.axis()\n            .scale(xScale)\n            .orient(\"bottom\")\n            .ticks(10)\n            .tickFormat(d3.time.format('%M:%S'));\n\n        var yAxis = d3.svg.axis()\n            .scale(yScale)\n            .orient(\"left\");\n\n        var line = d3.svg.line()\n            .x(function(d) {\n                return xScale(d.time);\n            })\n            .y(function(d) {\n                return yScale(d.val);\n            })\n            .interpolate(\"cardinal\");\n\n        var svg = d3.selectAll(\"#d3graph\").append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        function update() {\n            if (dataset.length > width / 20) {\n                dataset.shift();\n            }\n            svg.selectAll(\"path\").remove();\n            svg.selectAll(\"g\").remove();\n\n            xScale.domain(d3.extent(dataset, function(d) {\n                return d.time;\n            }));\n             yScale.domain(d3.extent(dataset, function(d) {\n                 return d.val;\n             })).nice();\n\n            svg.append(\"g\")\n                .attr(\"class\", \"y axis\")\n                .call(yAxis)\n                .append(\"text\")\n                .attr(\"y\", -10)\n                .attr(\"x\", 10)\n                .style(\"text-anchor\", \"end\")\n                .text(\"\u5024\");\n\n            svg.append(\"g\")\n                .attr(\"class\", \"x axis\")\n                .call(xAxis)\n                .attr(\"transform\", \"translate(0,\" + height + \")\")\n\n\n            svg.append(\"path\")\n                .datum(dataset)\n                .attr(\"fill\", \"none\")\n                .attr(\"stroke\", \"steelblue\")\n                .attr(\"stroke-linejoin\", \"round\")\n                .attr(\"stroke-linecap\", \"round\")\n                .attr(\"stroke-width\", 1.5)\n                .attr(\"d\", line);\n        };\n\n        setInterval(generateData, 500);\n        setInterval(update, 500);\n    </script>\n</body>\n</html>\n\n\n[d3.js](https://d3js.org)\u306f\u3001\u30c7\u30fc\u30bf\u30c9\u30ea\u30d6\u30f3\u3067\u8272\u3005\u304b\u3063\u3053\u3044\u3044\u30b0\u30e9\u30d5\u306a\u3069\u304c\u66f8\u3051\u308bJavascript\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066\u6709\u540d\u3067\u3059\u3002 \u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u3001IoT\u30bb\u30f3\u30b5\u30fc\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30c1\u30e3\u30fc\u30c8\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\u7d20\u4eba\u306a\u306e\u3067\u3001\u30b3\u30fc\u30c9\u306b\u306f\u554f\u984c\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u305d\u306e\u969b\u306f\u3054\u6307\u6458\u3044\u305f\u3060\u3051\u308b\u3068\u5e78\u3044\u3067\u3059><\n\n# IoT\u30c7\u30d0\u30a4\u30b9\u3068\u306e\u63a5\u7d9a/\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\n\n\u30c7\u30d0\u30a4\u30b9\u3092\u4f7f\u3063\u3066\u3044\u308b\u304b\u306f\u5177\u4f53\u7684\u306b\u306f\u8aac\u660e\u3057\u307e\u305b\u3093\u3002\u5404\u3005\u306e\u30c7\u30d0\u30a4\u30b9\u6bce\u306b\u3057\u304b\u308b\u3079\u304d\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u304f\u3060\u3055\u3044\u3002 \u79c1\u304c\u4f7f\u7528\u3057\u3066\u3044\u308b\u30c7\u30d0\u30a4\u30b9\u306f\u3001GET\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u3084\u308b\u3068\u30bb\u30f3\u30b5\u30fc\u306e\u5024\u3092\u8fd4\u3057\u3066\u304f\u308c\u307e\u3059\u3002 \u5177\u4f53\u7684\u306b\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```Javascipt\n const url = \"hogehoge\";\n var xhr = new XMLHttpRequest();\n xhr.addEventListener('error', function() {\n      alert(\"Not establish connection\");\n      // \u30a8\u30e9\u30fc\u51e6\u7406\n       });\n\nxhr.addEventListener('loadend', function() {\n   if (xhr.status === 200 && xhr.readyState === 4) {\n      const res = parseFloat(xhr.responseText);\n      const now = new Date();\n      dataset.push({\n         time: now,\n         val: res\n         });\n    else {\n       console.error(xhr.status + ' ' + xhr.statusText);\n    }\n});\n\nxhr.open(\"GET\", url + '/brightness', false);\n// \u3053\u3053\u3067\u306f\u30bb\u30f3\u30b5\u30fc\u306e\u3046\u3061\u306e\u7167\u5ea6\u30bb\u30f3\u30b5\u30fc\u3092\u4f7f\u3063\u305f\u3068\u3057\u307e\u3059\nxhr.send(null);\n// \u672c\u6765\u306f\u975e\u540c\u671f\u3067\u9001\u3063\u305f\u65b9\u304c\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u7c21\u5358\u306e\u305f\u3081\u306b\u540c\u671f\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u3042\u3052\u307e\u3059\nxhr.send(null);\n```\n\n\n# d3.js\u306e\u4f7f\u7528\n[d3.js](https://d3js.org)\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\u3053\u3053\u3067\u306f\u3001\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306e\u91cf\u304c\u591a\u3044\u3001d3.js\u306eversion3\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\nCDN\u3067\u7528\u3044\u308b\u306b\u306f\u6b21\u306e\u3088\u3046\u306b\u52a0\u3048\u308b\u3060\u3051\u3067\u5927\u4e08\u592b\u3067\u3059\u3002\n\n\n```HTML\n<script src=\"https://d3js.org/d3.v3.min.js\"></script>\n```\n\n\n\u307e\u305a\u306f\u30b0\u30e9\u30d5\u306e\u63cf\u753b\u306e\u5143\u3068\u306a\u308b\u3082\u306e\u306e\u5ba3\u8a00\u3067\u3059\u3002\n\n```javascript\nvar margin = {\n            top: 30,\n            right: 50,\n            bottom: 30,\n            left: 50\n        };\nvar width = 600 - margin.left - margin.right;\nvar height = 500 - margin.top - margin.bottom;\nvar xScale = d3.time.scale()\n            .range([0, width]);\n//x\u8ef8\u306f\u6642\u9593\u306e\u30b9\u30b1\u30fc\u30eb\u306b\u306a\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\n\nvar yScale = d3.scale.linear()\n            .range([height, 0]);\n            \n\nvar xAxis = d3.svg.axis()\n            .scale(xScale)\n            .orient(\"bottom\")\n            .tickFormat(d3.time.format('%M:%S'));\n\nvar yAxis = d3.svg.axis()\n            .scale(yScale)\n            .orient(\"left\");\n\n// \u7dda\u306e\u5b9a\u7fa9\nvar line = d3.svg.line()\n            .x(function(d) {\n                return xScale(d.time);\n            })\n            .y(function(d) {\n                return yScale(d.val);\n            })\n            .interpolate(\"cardinal\");\n            // \u70b9\u306e\u9593\u306e\u88dc\u9593\u3092cardinal\u306b\u8a2d\u5b9a\n\n// svg\u306e\u5b9a\u7fa9\nvar svg = d3.selectAll(\"#d3graph\").append(\"svg\")\n// \u3053\u306ed3\u306eselectAll\u30e1\u30bd\u30c3\u30c9\u306b\u3088\u308a\u3001\u57fa\u3068\u306a\u308bHTML\u306e <div id=\"d3graph\"> </div>\u306a\u308b\u8981\u7d20\u3092\u5f15\u3063\u5f35\u3063\u3066\u304d\u307e\u3059\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n```\n\n\u3053\u308c\u3067\u5927\u4f53\u306e\u63cf\u753b\u306f\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u305d\u306e\u3042\u3068\u306f\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u304f\u308b\u305f\u3073\u306b\u63cf\u753b\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4ed8\u3051\u8db3\u305b\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\n\n```Javascript\n function update() {\n            if (dataset.length > 20) {\n                dataset.shift();\n                // \u30c7\u30fc\u30bf\u6570\u304c20\u3092\u8d85\u3048\u305f\u3089\u5165\u3063\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092\u6d88\u3057\u307e\u3059        \n            }\n            svg.selectAll(\"path\").remove();\n            // xy\u8ef8\u524a\u9664\n            svg.selectAll(\"g\").remove();\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000// \u7dda\u306e\u524a\u9664\n\n            xScale.domain(d3.extent(dataset, function(d) {\n                return d.time;\n            }));\n            yScale.domain(d3.extent(dataset, function(d) {\n                 return d.val;\n             })).nice();\n            //xy\u8ef8\u305d\u308c\u305e\u308c\u306e\u30c9\u30e1\u30a4\u30f3\u3092dataset\u306emin, max\u306e\u7bc4\u56f2\u306b\u53ce\u3081\u307e\u3059\n\n            svg.append(\"g\")\n                .attr(\"class\", \"y axis\")\n                .call(yAxis)\n                .append(\"text\")\n                .attr(\"y\", -10)\n                .attr(\"x\", 10)\n                .style(\"text-anchor\", \"end\")\n                .text(\"\u5024\");\n\t\t\t// y\u8ef8\u306e\u518d\u63cf\u753b\n\n            svg.append(\"g\")\n                .attr(\"class\", \"x axis\")\n                .call(xAxis)\n                .attr(\"transform\", \"translate(0,\" + height + \")\")\n\t\t\t// x\u8ef8\u306e\u518d\u63cf\u753b\n\n            // path\u8981\u7d20\u3092svg\u306b\u8868\u793a\u3057\u3001\u6298\u308c\u7dda\u30b0\u30e9\u30d5\u3092\u8a2d\u5b9a\n            svg.append(\"path\")\n                .datum(dataset)\n           // line\u3068dataset\u306ebind\n                .attr(\"fill\", \"none\")\n                .attr(\"stroke\", \"steelblue\")\n                .attr(\"stroke-linejoin\", \"round\")\n                .attr(\"stroke-linecap\", \"round\")\n                .attr(\"stroke-width\", 1.5)\n                .attr(\"d\", line);\n        };\n\n```\n\u3053\u306eupdate()\u3092\u5b9a\u671f\u7684\u306b\u7e70\u308a\u8fd4\u3057\u3066\u3042\u3052\u308c\u3070\u63cf\u753b\u5b8c\u4e86\u3067\u3059\u3002\n\u5ff5\u306e\u305f\u3081\u3001\u8cbc\u308a\u4ed8\u3051\u308b\u3060\u3051\u3067\u4f7f\u3048\u308bHTML\u3092\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u8cbc\u3063\u3066\u304a\u304d\u307e\u3059\u3002\n\n\n```HTML\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <style type=\"text/css\">\n        .axis text {\n            font: 10px sans-serif;\n        }\n        .axis path {\n            opacity: 0.1;\n            stroke: #000;\n            stroke-width: 0.1;\n            shape-rendering: crispEdges;\n        }\n        .axis line {\n            stroke: #000;\n            stroke-width: 1;\n            shape-rendering: crispEdges;\n        }\n        .line {\n            fill: none;\n            stroke: DarkGreen;\n            stroke-width: 1.5px;\n        }\n    </style>\n</head>\n\n<body>\n        <div id=\"d3graph\"></div>\n    <script src=\"http://d3js.org/d3.v3.min.js\"></script>\n    <script>\n        window.addEventListener(\"loaded\", update, false);\n\n        var dataset = [];\n\n        function generateData() {\n            const now = new Date();\n            const data = {\n                time: now,\n                val: Math.random() * 10\n            };\n            dataset.push(data)\n        }\n\n        var margin = {\n            top: 30,\n            right: 50,\n            bottom: 30,\n            left: 50\n        };\n        var width = 600 - margin.left - margin.right;\n        var height = 500 - margin.top - margin.bottom;\n\n        var xScale = d3.time.scale()\n            .range([0, width]);\n\n        var yScale = d3.scale.linear()\n            .range([height, 0])\n            .domain([0, 10]);\n\n        var xAxis = d3.svg.axis()\n            .scale(xScale)\n            .orient(\"bottom\")\n            .ticks(10)\n            .tickFormat(d3.time.format('%M:%S'));\n\n        var yAxis = d3.svg.axis()\n            .scale(yScale)\n            .orient(\"left\");\n\n        var line = d3.svg.line()\n            .x(function(d) {\n                return xScale(d.time);\n            })\n            .y(function(d) {\n                return yScale(d.val);\n            })\n            .interpolate(\"cardinal\");\n\n        var svg = d3.selectAll(\"#d3graph\").append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        function update() {\n            if (dataset.length > width / 20) {\n                dataset.shift();\n            }\n            svg.selectAll(\"path\").remove();\n            svg.selectAll(\"g\").remove();\n\n            xScale.domain(d3.extent(dataset, function(d) {\n                return d.time;\n            }));\n             yScale.domain(d3.extent(dataset, function(d) {\n                 return d.val;\n             })).nice();\n\n            svg.append(\"g\")\n                .attr(\"class\", \"y axis\")\n                .call(yAxis)\n                .append(\"text\")\n                .attr(\"y\", -10)\n                .attr(\"x\", 10)\n                .style(\"text-anchor\", \"end\")\n                .text(\"\u5024\");\n\n            svg.append(\"g\")\n                .attr(\"class\", \"x axis\")\n                .call(xAxis)\n                .attr(\"transform\", \"translate(0,\" + height + \")\")\n\n\n            svg.append(\"path\")\n                .datum(dataset)\n                .attr(\"fill\", \"none\")\n                .attr(\"stroke\", \"steelblue\")\n                .attr(\"stroke-linejoin\", \"round\")\n                .attr(\"stroke-linecap\", \"round\")\n                .attr(\"stroke-width\", 1.5)\n                .attr(\"d\", line);\n        };\n\n        setInterval(generateData, 500);\n        setInterval(update, 500);\n    </script>\n</body>\n</html>\n\n```\n", "tags": ["IoT", "JavaScript", "d3.js"]}