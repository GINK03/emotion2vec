{"context": "\u3042\u307e\u308a\u4e0a\u624b\u304f\u3067\u304d\u3066\u3044\u306a\u3044\u3002\n\n\u4f7f\u7528\u3059\u308b\u30c7\u30fc\u30bf\nmpg\u3092displ\u3068hwy\u306e\u95a2\u4fc2\u3092drv\u6bce\u306b\u30d7\u30ed\u30c3\u30c8\u3059\u308b\u3002\np <- ggplot(mpg, aes(displ, hwy)) +\n  geom_point() +\n  facet_wrap(~drv) +\n  theme_bw() +\n  theme(panel.grid = element_blank()) +\n  geom_smooth(method = \"lm\")\n\n\ntableGrob\u3092\u4f5c\u6210\u3059\u308b\ndrv\u3067\u5206\u5272\u3057\u3066\u56de\u5e30\u3057\u3066\u5207\u7247\u3068\u50be\u304d\u3092\u53d6\u308a\u51fa\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30ec\u30fc\u30e0\u306b\u3057\u3066tableGrob\u3092\u4f5c\u6210\u3059\u308b\u3002\ntpar = list(bg_params = list(fill = \"gray\", alpha = 0.8)) # \u8868\u306e\u5916\u89b3\u30d1\u30e9\u30e1\u30fc\u30bf\ntg <- mpg %>%\n  split(.$drv) %>%\n  purrr::map(., ~ (lm(hwy ~ displ, data = .) %>% broom::tidy())[1:2]) %>%\n  purrr::map(., ~ data.frame(coef =  round(.[2], 1),\n                             row.names = c(\"(Intercept)\", \"displ\"))) %>%\n  purrr::map(., tableGrob,\n             theme = ttheme_minimal(\n               base_size = 10,\n               padding = unit(c(2, 2), \"mm\"),\n               core = tpar,\n               colhead = tpar,\n               rowhead = tpar\n             ))\n\n\n\u30d7\u30ed\u30c3\u30c8\u3059\u308b\n## gtable\u306e\u4f5c\u6210\ng <- ggplot_gtable(ggplot_build(p))\n\n## facets\u306e\u53d6\u5f97\nfacets <- grep(\"panel\", g$layout$name)\n\n## tableGrob\u3092\u66f8\u304d\u8fbc\u3080\ng2 <- with(g$layout[facets, ],\n           gtable_add_grob(g, tg,\n                           t=t, l=l))\nplot(g2)\n\n\n\u4f4d\u7f6e\u306e\u8abf\u6574\u304c\u3067\u304d\u306a\u3044\u2026\u3002\n\n\u53c2\u8003\n\nr - Annotate specific area of ggplot2 facet backgrounds with images of a specified size - Stack Overflow\ntidyverse\u8133\u306b\u306a\u3063\u3066\u968e\u5c64\u69cb\u9020\u306e\u3042\u308b\u30c7\u30fc\u30bf\u30d5\u30ec\u30fc\u30e0\u3092\u4f7f\u3044\u3053\u306a\u305d\u3046\n\n\u3042\u307e\u308a\u4e0a\u624b\u304f\u3067\u304d\u3066\u3044\u306a\u3044\u3002\n\n# \u4f7f\u7528\u3059\u308b\u30c7\u30fc\u30bf\n\nmpg\u3092displ\u3068hwy\u306e\u95a2\u4fc2\u3092drv\u6bce\u306b\u30d7\u30ed\u30c3\u30c8\u3059\u308b\u3002\n\n```r\np <- ggplot(mpg, aes(displ, hwy)) +\n  geom_point() +\n  facet_wrap(~drv) +\n  theme_bw() +\n  theme(panel.grid = element_blank()) +\n  geom_smooth(method = \"lm\")\n```\n\n# tableGrob\u3092\u4f5c\u6210\u3059\u308b\n\ndrv\u3067\u5206\u5272\u3057\u3066\u56de\u5e30\u3057\u3066\u5207\u7247\u3068\u50be\u304d\u3092\u53d6\u308a\u51fa\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30ec\u30fc\u30e0\u306b\u3057\u3066tableGrob\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```r\ntpar = list(bg_params = list(fill = \"gray\", alpha = 0.8)) # \u8868\u306e\u5916\u89b3\u30d1\u30e9\u30e1\u30fc\u30bf\ntg <- mpg %>%\n  split(.$drv) %>%\n  purrr::map(., ~ (lm(hwy ~ displ, data = .) %>% broom::tidy())[1:2]) %>%\n  purrr::map(., ~ data.frame(coef =  round(.[2], 1),\n                             row.names = c(\"(Intercept)\", \"displ\"))) %>%\n  purrr::map(., tableGrob,\n             theme = ttheme_minimal(\n               base_size = 10,\n               padding = unit(c(2, 2), \"mm\"),\n               core = tpar,\n               colhead = tpar,\n               rowhead = tpar\n             ))\n```\n\n# \u30d7\u30ed\u30c3\u30c8\u3059\u308b\n\n```r\n## gtable\u306e\u4f5c\u6210\ng <- ggplot_gtable(ggplot_build(p))\n\n## facets\u306e\u53d6\u5f97\nfacets <- grep(\"panel\", g$layout$name)\n\n## tableGrob\u3092\u66f8\u304d\u8fbc\u3080\ng2 <- with(g$layout[facets, ],\n           gtable_add_grob(g, tg,\n                           t=t, l=l))\nplot(g2)\n```\n\n![Rplot.png](https://qiita-image-store.s3.amazonaws.com/0/109348/f0eb671f-d34b-036f-b023-d78d22afa6fe.png)\n\n\u4f4d\u7f6e\u306e\u8abf\u6574\u304c\u3067\u304d\u306a\u3044\u2026\u3002\n\n# \u53c2\u8003\n\n- [r - Annotate specific area of ggplot2 facet backgrounds with images of a specified size - Stack Overflow](http://stackoverflow.com/questions/31987096/annotate-specific-area-of-ggplot2-facet-backgrounds-with-images-of-a-specified-s)\n- [tidyverse\u8133\u306b\u306a\u3063\u3066\u968e\u5c64\u69cb\u9020\u306e\u3042\u308b\u30c7\u30fc\u30bf\u30d5\u30ec\u30fc\u30e0\u3092\u4f7f\u3044\u3053\u306a\u305d\u3046](https://suryu.me/post/r_advent_calendar_day3/)\n", "tags": ["R", "ggplot2"]}