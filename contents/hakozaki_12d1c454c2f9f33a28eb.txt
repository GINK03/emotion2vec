{"tags": ["OpenID", "OAuth2.0", "OpenAM", "\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3", "\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3"], "context": "\n\n\u672c\u5f53\u306b\u30e1\u30e2\u3002\u305f\u3060\u306e\u30e1\u30e2\u3002\n\u3061\u3083\u3093\u3068\u3057\u305f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306f\u3042\u308b\u304c\u3001\u8a8d\u8a3c\u3068\u30c8\u30fc\u30af\u30f3\u3060\u3051\u306a\u3089\u3053\u3063\u3061\u304c\u65e9\u304f\u601d\u3044\u51fa\u305b\u308b\u3002\n\u5bfe\u8c61\u30d0\u30fc\u30b8\u30e7\u30f3\u306f12.0/13.0\u3060\u304c\u4ed6\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3082\u65b0\u3057\u3081\u3067\u3042\u308c\u3070\u52d5\u304f\u3068\u601d\u308f\u308c\u308b\u3002\n\u898b\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u306b\u4e00\u90e8\u610f\u56f3\u7684\u306b\u6539\u884c\u3092\u5165\u308c\u3066\u3044\u308b\u3002\n\n\u524d\u63d0\u6761\u4ef6\n\n\n\nItem\nThis Sample Value\n\n\n\n\nsite\nwww.openamtest.com\n\n\nport\n18080\n\n\nclient_id\ntestApp1\n\n\nclient_secret\nsecret_pass\n\n\nuser\nfoo@test.co.jp\n\n\npassword\npassword\n\n\n\n\n\uff11\uff0e\u30e6\u30fc\u30b6ID\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u8a8d\u8a3c\u3059\u308b\n\nPOST\ncurl -X POST \n\u3000-H \"X-OpenAM-Username: foo@test.co.jp\" \n\u3000-H \"X-OpenAM-Password: password\" \n\u3000-H \"Content-Type: application/json\" \n\u3000-d '' \n  -k -v http://www.openamtest.com:18080/openam/json/authenticate?realm=/\n\n\n\nRESPONSE\n{\"tokenId\":\"AQIC5wM2LY4Sfczs5OLZQZ2lRqhvuAR7KXGFDaSNOJKZNLI.*AAJTSQACMDIAAlNLABQtNjU2NDkxMjEyOTI1OTU4ODY3NAACUzEAAA..*\"\n,\"successUrl\":\"/openam/console\"} \n\n\n\n\uff12\uff0etokenId \u3067 code \u3092\u53d6\u5f97\n\nPOST\ncurl -X POST \n  -H \"Cookie:iPlanetDirectoryPro=AQIC5wM2LY4Sfczs5OLZQZ2lRqhvuAR7KXGFDaSNOJKZNLI.*AAJTSQACMDIAAlNLABQtNjU2NDkxMjEyOTI1OTU4ODY3NAACUzEAAA..*\" \n  -H \"Content-Type: application/x-www-form-urlencoded\" \n  -H \"Cache-Control: no-cache\" \n  -d 'response_type=code&scope=openid%20profile%20qualified%20email&client_id=testApp1&redirect_uri=http://www.openamtest.com:18080&save_consent=1&decision=Allow' \n  -k -v http://www.openamtest.com:18080/openam/oauth2/authorize?realm=/\n\n\n\nRESPONSE\nLocation: http://www.openamtest.com:18080\n?scope=email%20openid%20qualified%20profile&code=5f4574a6-f004-41d7-bd1a-ac7f271d06eb\n\n\n\n\uff13\uff0ecode \u3067 access_token \u3092\u53d6\u5f97\ncurl -X POST \n  -H \"Cache-Control: no-cache\" \n  -d 'client_id=testApp1&client_secret=secret_pass&grant_type=authorization_code&realm=/&code=5f4574a6-f004-41d7-bd1a-ac7f271d06eb&redirect_uri=http://www.openamtest.com:18080' \n  -k -v http://www.openamtest.com:18080/openam/oauth2/access_token\n\n\nRESPONSE\n{\n\"scope\":\"email openid profile qualified\",\n\"expires_in\":3599,\"token_type\":\"Bearer\",\n\"refresh_token\":\"771a40c4-ba85-4257-902c-2155e18390b2\",\n\"id_token\":\"eyAidHlwIjogIkpXVCIsICJhbGciOiAiUlMyNTYiLCAia2lkIjogIlN5bExDNk5qdDFLR1FrdEQ5TXQrMHpjZVF\nTVT0iIH0.eyAiZXhwIjogMTQ2NDY4NDcxOCwgInN1YiI6ICJ0ZXN0QGluZm9tYXJ0LmNvLmpwIiwgImF6cCI6ICJ0ZXN0QXBwMSI\nsICJpc3MiOiAiaHR0cDovL3d3dzEuc2dpbmZvbWFydC5jby5qcDoxODA4MC9vcGVuYW0vb2F1dGgyIiwgImlhdCI6IDE0NjQ2ODE\nxMTgsICJjX2hhc2giOiAiaEFRb1h2U3FlVG5nc08wVVYyNFEwdyIgfQ.K5t9lz_GgE5wP7TRQVVPJyJqz5x2z161CjuItUkLRPBt\nYX8wl8z-R2J3iQUEyajgxCrJWFe2pThLeoULumzhj4oM9v1CHJb0bLTs7pWKeUZ5mFIHvkrDPDIU7kUXAXLt-dtDzmKADGVt3JoM\nb8B9B9hp5c5csjkmkCcbSMPRzFc\",\n\"access_token\":\"07c20200-0ac4-483a-bc16-4ba8cf1ebf11\" \n}\n\n\n\n\uff14\uff0eaccess_token \u3067 userinfo \u3092\u53d6\u5f97\nurl -X POST \n  -H \"Authorization: Bearer 07c20200-0ac4-483a-bc16-4ba8cf1ebf11\" \n  -d '' \n  -k -v http://www.openamtest.com:18080/openam/oauth2/userinfo\n\n\nRESPONSE\uff1csub\u306f\u5bfe\u8c61\u306e\u8a8d\u8a3c\u30b7\u30b9\u30c6\u30e0\u4f9d\u5b58\u3001\u3053\u3053\u3067\u306f\u30e1\u30a2\u30c9\u3092\u305d\u306e\u307e\u307e\u5229\u7528\uff1e\n{\n \"sub\":\"foo@test.co.jp\",\n \"phone_number\":\"090-0000-0000\",\n \"address\":{\"formatted\":\"\u6771\u4eac\u90fd\u8db3\u7acb\u533a\u30fb\u30fb\u30fb\"},\n \"email\":\"foo@test.co.jp\",\n \"name\":\"\u30c6\u30b9\u30c8 \u30bf\u30ed\u30a6\",\n \"family_name\":\"\u30c6\u30b9\u30c8\",\n \"given_name\":\"\u30bf\u30ed\u30a6\",\n \"qualified\":\"anyQualifiedNamedValue\" \n}\n\n\n\n\uff15\uff0erefresh_token \u3067 access_token\u3092\u518d\u53d6\u5f97\ncurl -X POST \n  -H \"Cache-Control: no-cache\" \n  -d 'client_id=testApp1&client_secret=secret_pass&grant_type=refresh_token&refresh_token=771a40c4-ba85-4257-902c-2155e18390b2' \n  -k -v http://www.openamtest.com:18080/openam/oauth2/access_token\n\n\nRESPONSE\n{\n\"scope\":\"email openid profile qualified\",\n\"expires_in\":3599,\n\"token_type\":\"Bearer\",\n\"refresh_token\":\"1fbcc0b3-f524-4cfa-9dd5-39e5226b9843\",\n\"id_token\":\"eyAidHlwIjogIkpXVCIsICJhbGciOiAiUlMyNTYiLCAia2lkIjogIlN5bE\nxDNk5qdDFLR1FrdEQ5TXQrMHpjZVFTVT0iIH0.eyAiZXhwIjogMTQ2NDY4NjQ4NCwgInN1\nYiI6ICJ0ZXN0QGluZm9tYXJ0LmNvLmpwIiwgImF6cCI6ICJ0ZXN0QXBwMSIsICJpc3MiOi\nAiaHR0cDovL3d3dzEuc2dpbmZvbWFydC5jby5qcDoxODA4MC9vcGVuYW0vb2F1dGgyIiwg\nImlhdCI6IDE0NjQ2ODI4ODQgfQ.UuAETq1iC3EarHH0YOXbrJxxSgnshwMeu52-mHYVqRG\n1lGFpnXWzAzhl5OLfXg1f_10IO06O3nl7rRU1ZKCBjhK97LYEipF3C_cieuUDw7zx31ABv\n6bYeN_A6Mi3x1ogqaIxOIiLSlQ0Knk9X4XNseZ6PzDMdVHehC7Wk5BHHiU\",\n\"access_token\":\"bceb5fa5-a7a2-45e8-86b5-9bb34f92c2bc\" \n}\n\n\n## \u672c\u5f53\u306b\u30e1\u30e2\u3002\u305f\u3060\u306e\u30e1\u30e2\u3002\n\u3061\u3083\u3093\u3068\u3057\u305f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306f\u3042\u308b\u304c\u3001\u8a8d\u8a3c\u3068\u30c8\u30fc\u30af\u30f3\u3060\u3051\u306a\u3089\u3053\u3063\u3061\u304c\u65e9\u304f\u601d\u3044\u51fa\u305b\u308b\u3002\n\u5bfe\u8c61\u30d0\u30fc\u30b8\u30e7\u30f3\u306f12.0/13.0\u3060\u304c\u4ed6\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3082\u65b0\u3057\u3081\u3067\u3042\u308c\u3070\u52d5\u304f\u3068\u601d\u308f\u308c\u308b\u3002\n\u898b\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u306b\u4e00\u90e8\u610f\u56f3\u7684\u306b\u6539\u884c\u3092\u5165\u308c\u3066\u3044\u308b\u3002\n\n### \u524d\u63d0\u6761\u4ef6\n| Item | This Sample Value |\n|:-----------|------------:|\n| site | www.openamtest.com|\n| port | 18080|\n| client_id | testApp1|\n| client_secret | secret_pass|\n| user | foo@test.co.jp|\n| password | password|\n\n### \uff11\uff0e\u30e6\u30fc\u30b6ID\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3067\u8a8d\u8a3c\u3059\u308b\n\n```shell-session:POST\ncurl -X POST \n\u3000-H \"X-OpenAM-Username: foo@test.co.jp\" \n\u3000-H \"X-OpenAM-Password: password\" \n\u3000-H \"Content-Type: application/json\" \n\u3000-d '' \n  -k -v http://www.openamtest.com:18080/openam/json/authenticate?realm=/\n```\n\n```json:RESPONSE\n{\"tokenId\":\"AQIC5wM2LY4Sfczs5OLZQZ2lRqhvuAR7KXGFDaSNOJKZNLI.*AAJTSQACMDIAAlNLABQtNjU2NDkxMjEyOTI1OTU4ODY3NAACUzEAAA..*\"\n,\"successUrl\":\"/openam/console\"} \n```\n\n### \uff12\uff0etokenId \u3067 code \u3092\u53d6\u5f97\n\n```shell-session:POST\ncurl -X POST \n  -H \"Cookie:iPlanetDirectoryPro=AQIC5wM2LY4Sfczs5OLZQZ2lRqhvuAR7KXGFDaSNOJKZNLI.*AAJTSQACMDIAAlNLABQtNjU2NDkxMjEyOTI1OTU4ODY3NAACUzEAAA..*\" \n  -H \"Content-Type: application/x-www-form-urlencoded\" \n  -H \"Cache-Control: no-cache\" \n  -d 'response_type=code&scope=openid%20profile%20qualified%20email&client_id=testApp1&redirect_uri=http://www.openamtest.com:18080&save_consent=1&decision=Allow' \n  -k -v http://www.openamtest.com:18080/openam/oauth2/authorize?realm=/\n```\n\n```json:RESPONSE\nLocation: http://www.openamtest.com:18080\n?scope=email%20openid%20qualified%20profile&code=5f4574a6-f004-41d7-bd1a-ac7f271d06eb\n```\n\n### \uff13\uff0ecode \u3067 access_token \u3092\u53d6\u5f97\n\n```shell-session:\ncurl -X POST \n  -H \"Cache-Control: no-cache\" \n  -d 'client_id=testApp1&client_secret=secret_pass&grant_type=authorization_code&realm=/&code=5f4574a6-f004-41d7-bd1a-ac7f271d06eb&redirect_uri=http://www.openamtest.com:18080' \n  -k -v http://www.openamtest.com:18080/openam/oauth2/access_token\n```\n\n```json:RESPONSE\n{\n\"scope\":\"email openid profile qualified\",\n\"expires_in\":3599,\"token_type\":\"Bearer\",\n\"refresh_token\":\"771a40c4-ba85-4257-902c-2155e18390b2\",\n\"id_token\":\"eyAidHlwIjogIkpXVCIsICJhbGciOiAiUlMyNTYiLCAia2lkIjogIlN5bExDNk5qdDFLR1FrdEQ5TXQrMHpjZVF\nTVT0iIH0.eyAiZXhwIjogMTQ2NDY4NDcxOCwgInN1YiI6ICJ0ZXN0QGluZm9tYXJ0LmNvLmpwIiwgImF6cCI6ICJ0ZXN0QXBwMSI\nsICJpc3MiOiAiaHR0cDovL3d3dzEuc2dpbmZvbWFydC5jby5qcDoxODA4MC9vcGVuYW0vb2F1dGgyIiwgImlhdCI6IDE0NjQ2ODE\nxMTgsICJjX2hhc2giOiAiaEFRb1h2U3FlVG5nc08wVVYyNFEwdyIgfQ.K5t9lz_GgE5wP7TRQVVPJyJqz5x2z161CjuItUkLRPBt\nYX8wl8z-R2J3iQUEyajgxCrJWFe2pThLeoULumzhj4oM9v1CHJb0bLTs7pWKeUZ5mFIHvkrDPDIU7kUXAXLt-dtDzmKADGVt3JoM\nb8B9B9hp5c5csjkmkCcbSMPRzFc\",\n\"access_token\":\"07c20200-0ac4-483a-bc16-4ba8cf1ebf11\" \n}\n```\n\n### \uff14\uff0eaccess_token \u3067 userinfo \u3092\u53d6\u5f97\n\n```shell-session:\nurl -X POST \n  -H \"Authorization: Bearer 07c20200-0ac4-483a-bc16-4ba8cf1ebf11\" \n  -d '' \n  -k -v http://www.openamtest.com:18080/openam/oauth2/userinfo\n```\n\n```json:RESPONSE\uff1csub\u306f\u5bfe\u8c61\u306e\u8a8d\u8a3c\u30b7\u30b9\u30c6\u30e0\u4f9d\u5b58\u3001\u3053\u3053\u3067\u306f\u30e1\u30a2\u30c9\u3092\u305d\u306e\u307e\u307e\u5229\u7528\uff1e\n{\n \"sub\":\"foo@test.co.jp\",\n \"phone_number\":\"090-0000-0000\",\n \"address\":{\"formatted\":\"\u6771\u4eac\u90fd\u8db3\u7acb\u533a\u30fb\u30fb\u30fb\"},\n \"email\":\"foo@test.co.jp\",\n \"name\":\"\u30c6\u30b9\u30c8 \u30bf\u30ed\u30a6\",\n \"family_name\":\"\u30c6\u30b9\u30c8\",\n \"given_name\":\"\u30bf\u30ed\u30a6\",\n \"qualified\":\"anyQualifiedNamedValue\" \n}\n```\n\n### \uff15\uff0erefresh_token \u3067 access_token\u3092\u518d\u53d6\u5f97\n\n```shell-session:\ncurl -X POST \n  -H \"Cache-Control: no-cache\" \n  -d 'client_id=testApp1&client_secret=secret_pass&grant_type=refresh_token&refresh_token=771a40c4-ba85-4257-902c-2155e18390b2' \n  -k -v http://www.openamtest.com:18080/openam/oauth2/access_token\n```\n\n```json:RESPONSE\n{\n\"scope\":\"email openid profile qualified\",\n\"expires_in\":3599,\n\"token_type\":\"Bearer\",\n\"refresh_token\":\"1fbcc0b3-f524-4cfa-9dd5-39e5226b9843\",\n\"id_token\":\"eyAidHlwIjogIkpXVCIsICJhbGciOiAiUlMyNTYiLCAia2lkIjogIlN5bE\nxDNk5qdDFLR1FrdEQ5TXQrMHpjZVFTVT0iIH0.eyAiZXhwIjogMTQ2NDY4NjQ4NCwgInN1\nYiI6ICJ0ZXN0QGluZm9tYXJ0LmNvLmpwIiwgImF6cCI6ICJ0ZXN0QXBwMSIsICJpc3MiOi\nAiaHR0cDovL3d3dzEuc2dpbmZvbWFydC5jby5qcDoxODA4MC9vcGVuYW0vb2F1dGgyIiwg\nImlhdCI6IDE0NjQ2ODI4ODQgfQ.UuAETq1iC3EarHH0YOXbrJxxSgnshwMeu52-mHYVqRG\n1lGFpnXWzAzhl5OLfXg1f_10IO06O3nl7rRU1ZKCBjhK97LYEipF3C_cieuUDw7zx31ABv\n6bYeN_A6Mi3x1ogqaIxOIiLSlQ0Knk9X4XNseZ6PzDMdVHehC7Wk5BHHiU\",\n\"access_token\":\"bceb5fa5-a7a2-45e8-86b5-9bb34f92c2bc\" \n}\n```\n\n\n\n"}