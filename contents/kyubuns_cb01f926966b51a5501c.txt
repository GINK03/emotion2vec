{"context": " More than 1 year has passed since last update.Unity\u754c\u9688\u30679sliced sprite\u3068\u547c\u3070\u308c\u3066\u3044\u308b9patch\u3060\u304b9slice\u3060\u304b\u306e\u753b\u50cf\u3092\n\u81ea\u52d5\u3067\u751f\u6210\u3057\u3066\u304f\u308c\u308bruby\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n(\u3053\u306e\u8a18\u4e8b\u3067\u306f9sliced sprite\u3063\u3066\u547c\u3073\u307e\u3059\u3002)\n9sliced sprite\u3063\u3066\u4f55\uff1f\u3063\u3066\u4eba\u306f\u3053\u306e\u8fba\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\nhttps://github.com/kyubuns/onion_ring\n\n\u4f55\u304c\u51fa\u6765\u308b\u306e\uff1f\n\u3053\u3046\u3044\u3046\u753b\u50cf\u3092\u3064\u3063\u3053\u3080\u3068\n\n\u3053\u3046\u3044\u3046\u753b\u50cf\u304c\u51fa\u3066\u304d\u307e\u3059\u3002\n\n\u3055\u3089\u306b\u3001[23, 0, 21, 0]\u3068\u3044\u3046border\u306e\u5024\u3092\u5f97\u3089\u308c\u307e\u3059\u3002\n\uff08left, top, right, bottom)\n\u5de6\u304b\u308923px, \u53f3\u304b\u308921px\u307e\u3067\u3092\u4f7f\u3063\u3066\u3001\u305d\u306e\u9593\u3092\u4f38\u3070\u3057\u3066\u306d\u3002\u3063\u3066\u3044\u3046\u6307\u5b9a\u3067\u3059\u3002\n\u3053\u3046\u3044\u3046\u753b\u50cf\u3092\u3064\u3063\u3053\u3080\u3068\n\n\u3053\u3046\u306a\u308a\u307e\u3059\u3002\n\n\n\u4f7f\u3044\u65b9\n\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067Gem\u3068\u304b\u306b\u306a\u3063\u3066\u306a\u3044\u3067\u3059\u3002\n\u8981\u671b\u304c\u3042\u308c\u3070\u30fb\u30fb\u30fb\n\nsample.rb\nborder = OnionRing::run('before.png', 'after.png')\n\n\n\u3053\u308c\u3060\u3051\u3002\n\nUnity\u5b9f\u7528\u4f8b\n\u3053\u3053\u304b\u3089Unity\u306e\u8a71\u3092\u3057\u307e\u3059\uff01\n\nsample.rb\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u307e\u3068\u3082\u306b\u52d5\u304f\u304b\u8a66\u3057\u3066\u306a\u3044\u306e\u3067\u5bdf\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nslice_borders = []\nslice_borders.push(['after1', OnionRing::run('before1.png', 'after1.png')])\nslice_borders.push(['after2', OnionRing::run('before2.png', 'after2.png')])\n# \u3055\u3089\u306b\u3053\u3053\u3067after1.png, after2.png\u3092\u3001TexturePacker\u3067\u307e\u3068\u3081\u3066\u3001hoge_atlas.png\u306b\u4fdd\u5b58\u3068\u304b\u3059\u308b\u3068\u4fbf\u5229\u3002\n\nslice_borders_text = slice_borders.map{|line| line.flatten.join(',')}.join(\"\\n\")\nFile.write(\"hoge_atlas_border.txt\", slice_borders_text)\ncp hoge_atlas_border.txt UnityProject/Assets/Resources/Hoge/\n\n\n\u3053\u3093\u306a\u304b\u3093\u3058\u306b\u3001\u5c0f\u3055\u304f\u3057\u305f\u753b\u50cf + border\u306e\u5024\u3092\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001Unity\u306eResources\u4ee5\u4e0b\u3068\u304b\u3001\u307e\u3042\u9069\u5f53\u306a\u5834\u6240\u306b\u30b3\u30d4\u30fc\u3082\u3057\u307e\u3059\u3002\n\nAtlasBorderSetter.cs\nusing UnityEditor;\nusing System.IO;\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class BorderSetter : AssetPostprocessor\n{\n    public override int GetPostprocessOrder() { return 200; } // TexturePacker\u304c100\n\n    static void OnPostprocessAllAssets (string[] importedAssets, string[] deletedAssets, string[] movedAssets, string[] movedFromAssetPaths)\n    {\n        foreach (var asset in importedAssets)\n        {\n            if(!asset.EndsWith(\"_border.txt\")) continue;\n            string pathToTexture = asset.Replace(\"_border.txt\", \".png\");\n            if(File.Exists(pathToTexture)) AssetDatabase.ImportAsset(pathToTexture, ImportAssetOptions.ForceUpdate);\n        }\n    }\n\n    void OnPreprocessTexture ()\n    {\n        TextureImporter importer = assetImporter as TextureImporter;\n\n        string pathToData = assetPath.Replace(\".png\", \"_border.txt\");\n        if (File.Exists(pathToData)) updateSpriteMetaData(importer, pathToData);\n    }\n\n    static void updateSpriteMetaData (TextureImporter importer, string pathToData)\n    {\n        string[] dataFileContent = File.ReadAllLines(pathToData);\n        var borders = new Dictionary<string, Vector4>();\n        foreach(var line in dataFileContent)\n        {\n            var elements = line.Split(',');\n            var name = elements[0];\n            var left = int.Parse(elements[1]);\n            var top = int.Parse(elements[2]);\n            var right = int.Parse(elements[3]);\n            var bottom = int.Parse(elements[4]);\n            borders[name] = new Vector4(left, bottom, right, top);\n        }\n\n        var metaList = new List<SpriteMetaData> ();\n        for(int i = 0; i<importer.spritesheet.Length; ++i)\n        {\n            var sprite = importer.spritesheet[i];\n            sprite.border = borders[sprite.name];\n            metaList.Add(sprite);\n        }\n\n        importer.spritesheet = metaList.ToArray();\n    }\n}\n\n\n\u5f8c\u306f\u3001\u2191\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092Unity\u306eEditor\u4ee5\u4e0b\u306b\u7f6e\u3044\u3066\u304a\u304f\u3068\u3001\u81ea\u52d5\u7684\u306bborder\u306e\u8a2d\u5b9a\u307e\u3067\u3057\u3066\u304f\u308c\u307e\u3059\uff01\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\nhttps://github.com/kyubuns/onion_ring\n\n\u3042\u3068\u304c\u304d\n\u81ea\u52d5\u7684\u306b9slice sprite\u753b\u50cf\u3092\u751f\u6210\u3057\u3066\u304f\u308c\u308b\u30c4\u30fc\u30eb\u3092\u63a2\u3057\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u3069\u3046\u3082\u898b\u5f53\u305f\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u81ea\u5206\u3067\u4f5c\u3063\u3061\u3083\u3044\u307e\u3057\u305f\u3002\n\u610f\u898b\u30fb\u8981\u671b\u306a\u3069\u306ftwitter\u3084\u3001\u3053\u3053\u306e\u30b3\u30e1\u30f3\u30c8\u6b04\u307e\u3067\u304a\u6c17\u8efd\u306b\u3069\u3046\u305e\uff01\nruby\u529b\u4f4e\u3044\u306e\u3067\u30b3\u30fc\u30c9\u3078\u306e\u3064\u3063\u3053\u307f\u3082\u304a\u5f85\u3061\u3057\u3066\u307e\u3059\u3002\n\n\u304a\u307e\u3051\n\nUnity\u754c\u9688\u30679sliced sprite\u3068\u547c\u3070\u308c\u3066\u3044\u308b9patch\u3060\u304b9slice\u3060\u304b\u306e\u753b\u50cf\u3092\n\u81ea\u52d5\u3067\u751f\u6210\u3057\u3066\u304f\u308c\u308bruby\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n(\u3053\u306e\u8a18\u4e8b\u3067\u306f9sliced sprite\u3063\u3066\u547c\u3073\u307e\u3059\u3002)\n\n9sliced sprite\u3063\u3066\u4f55\uff1f\u3063\u3066\u4eba\u306f[\u3053\u306e\u8fba](https://helpx.adobe.com/jp/fireworks/kb/7092.html)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n# \u30ea\u30dd\u30b8\u30c8\u30ea\n\nhttps://github.com/kyubuns/onion_ring\n\n# \u4f55\u304c\u51fa\u6765\u308b\u306e\uff1f\n\n\u3053\u3046\u3044\u3046\u753b\u50cf\u3092\u3064\u3063\u3053\u3080\u3068\n![before.png](https://raw.githubusercontent.com/kyubuns/onion_ring/master/sample/before.png)\n\n\u3053\u3046\u3044\u3046\u753b\u50cf\u304c\u51fa\u3066\u304d\u307e\u3059\u3002\n![after.png](https://raw.githubusercontent.com/kyubuns/onion_ring/master/sample/after.png)\n\n\u3055\u3089\u306b\u3001[23, 0, 21, 0]\u3068\u3044\u3046border\u306e\u5024\u3092\u5f97\u3089\u308c\u307e\u3059\u3002\n\uff08left, top, right, bottom)\n\u5de6\u304b\u308923px, \u53f3\u304b\u308921px\u307e\u3067\u3092\u4f7f\u3063\u3066\u3001\u305d\u306e\u9593\u3092\u4f38\u3070\u3057\u3066\u306d\u3002\u3063\u3066\u3044\u3046\u6307\u5b9a\u3067\u3059\u3002\n\n\u3053\u3046\u3044\u3046\u753b\u50cf\u3092\u3064\u3063\u3053\u3080\u3068\n![before.png](https://qiita-image-store.s3.amazonaws.com/0/6459/2ca24278-be41-0a19-8803-bb231ab30fee.png)\n\n\u3053\u3046\u306a\u308a\u307e\u3059\u3002\n![after.png](https://qiita-image-store.s3.amazonaws.com/0/6459/0df36154-50e3-dd20-f5e4-d1ebfa37a881.png)\n\n\n# \u4f7f\u3044\u65b9\n\n\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067Gem\u3068\u304b\u306b\u306a\u3063\u3066\u306a\u3044\u3067\u3059\u3002\n\u8981\u671b\u304c\u3042\u308c\u3070\u30fb\u30fb\u30fb\n\n```sample.rb\nborder = OnionRing::run('before.png', 'after.png')\n```\n\u3053\u308c\u3060\u3051\u3002\n\n# Unity\u5b9f\u7528\u4f8b\n\n\u3053\u3053\u304b\u3089Unity\u306e\u8a71\u3092\u3057\u307e\u3059\uff01\n\n```sample.rb\n# \u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u307e\u3068\u3082\u306b\u52d5\u304f\u304b\u8a66\u3057\u3066\u306a\u3044\u306e\u3067\u5bdf\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nslice_borders = []\nslice_borders.push(['after1', OnionRing::run('before1.png', 'after1.png')])\nslice_borders.push(['after2', OnionRing::run('before2.png', 'after2.png')])\n# \u3055\u3089\u306b\u3053\u3053\u3067after1.png, after2.png\u3092\u3001TexturePacker\u3067\u307e\u3068\u3081\u3066\u3001hoge_atlas.png\u306b\u4fdd\u5b58\u3068\u304b\u3059\u308b\u3068\u4fbf\u5229\u3002\n\nslice_borders_text = slice_borders.map{|line| line.flatten.join(',')}.join(\"\\n\")\nFile.write(\"hoge_atlas_border.txt\", slice_borders_text)\ncp hoge_atlas_border.txt UnityProject/Assets/Resources/Hoge/\n```\n\n\u3053\u3093\u306a\u304b\u3093\u3058\u306b\u3001\u5c0f\u3055\u304f\u3057\u305f\u753b\u50cf + border\u306e\u5024\u3092\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001Unity\u306eResources\u4ee5\u4e0b\u3068\u304b\u3001\u307e\u3042\u9069\u5f53\u306a\u5834\u6240\u306b\u30b3\u30d4\u30fc\u3082\u3057\u307e\u3059\u3002\n\n```AtlasBorderSetter.cs\nusing UnityEditor;\nusing System.IO;\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class BorderSetter : AssetPostprocessor\n{\n\tpublic override int GetPostprocessOrder() { return 200; } // TexturePacker\u304c100\n\t\n\tstatic void OnPostprocessAllAssets (string[] importedAssets, string[] deletedAssets, string[] movedAssets, string[] movedFromAssetPaths)\n\t{\n\t\tforeach (var asset in importedAssets)\n\t\t{\n\t\t\tif(!asset.EndsWith(\"_border.txt\")) continue;\n\t\t\tstring pathToTexture = asset.Replace(\"_border.txt\", \".png\");\n\t\t\tif(File.Exists(pathToTexture)) AssetDatabase.ImportAsset(pathToTexture, ImportAssetOptions.ForceUpdate);\n\t\t}\n\t}\n\t\n\tvoid OnPreprocessTexture ()\n\t{\n\t\tTextureImporter importer = assetImporter as TextureImporter;\n\n\t\tstring pathToData = assetPath.Replace(\".png\", \"_border.txt\");\n\t\tif (File.Exists(pathToData)) updateSpriteMetaData(importer, pathToData);\n\t}\n\t\n\tstatic void updateSpriteMetaData (TextureImporter importer, string pathToData)\n\t{\n\t\tstring[] dataFileContent = File.ReadAllLines(pathToData);\n\t\tvar borders = new Dictionary<string, Vector4>();\n\t\tforeach(var line in dataFileContent)\n\t\t{\n\t\t\tvar elements = line.Split(',');\n\t\t\tvar name = elements[0];\n\t\t\tvar left = int.Parse(elements[1]);\n\t\t\tvar top = int.Parse(elements[2]);\n\t\t\tvar right = int.Parse(elements[3]);\n\t\t\tvar bottom = int.Parse(elements[4]);\n\t\t\tborders[name] = new Vector4(left, bottom, right, top);\n\t\t}\n\t\t\n\t\tvar metaList = new List<SpriteMetaData> ();\n\t\tfor(int i = 0; i<importer.spritesheet.Length; ++i)\n\t\t{\n\t\t\tvar sprite = importer.spritesheet[i];\n\t\t\tsprite.border = borders[sprite.name];\n\t\t\tmetaList.Add(sprite);\n\t\t}\n\t\t\n\t\timporter.spritesheet = metaList.ToArray();\n\t}\n}\n```\n\n\u5f8c\u306f\u3001\u2191\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092Unity\u306eEditor\u4ee5\u4e0b\u306b\u7f6e\u3044\u3066\u304a\u304f\u3068\u3001\u81ea\u52d5\u7684\u306bborder\u306e\u8a2d\u5b9a\u307e\u3067\u3057\u3066\u304f\u308c\u307e\u3059\uff01\n\n# \u30ea\u30dd\u30b8\u30c8\u30ea\n\nhttps://github.com/kyubuns/onion_ring\n\n# \u3042\u3068\u304c\u304d\n\n\u81ea\u52d5\u7684\u306b9slice sprite\u753b\u50cf\u3092\u751f\u6210\u3057\u3066\u304f\u308c\u308b\u30c4\u30fc\u30eb\u3092\u63a2\u3057\u305f\u3093\u3067\u3059\u3051\u3069\u3001\u3069\u3046\u3082\u898b\u5f53\u305f\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u81ea\u5206\u3067\u4f5c\u3063\u3061\u3083\u3044\u307e\u3057\u305f\u3002\n\u610f\u898b\u30fb\u8981\u671b\u306a\u3069\u306f[twitter](http://twitter.com/kyubuns)\u3084\u3001\u3053\u3053\u306e\u30b3\u30e1\u30f3\u30c8\u6b04\u307e\u3067\u304a\u6c17\u8efd\u306b\u3069\u3046\u305e\uff01\nruby\u529b\u4f4e\u3044\u306e\u3067\u30b3\u30fc\u30c9\u3078\u306e\u3064\u3063\u3053\u307f\u3082\u304a\u5f85\u3061\u3057\u3066\u307e\u3059\u3002\n\n# \u304a\u307e\u3051\n\n<blockquote class=\"twitter-tweet\" lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">. <a href=\"https://twitter.com/kyubuns\">@kyubuns</a> \u304c\u81ea\u52d5 9 slicer \u3092\u4f5c\u3063\u3066\u304f\u308c\u305f\u3093\u3060\u3051\u3069\u3001\u3053\u306e\u753b\u50cf\u304c\u3053\u3046\u306a\u3063\u3066\u3001\u76ee\u304b\u3089\u9c57\u3067\u3042\u308b (\u3061\u306a\u307f\u306b\u6b63\u3057\u3044) <a href=\"https://t.co/sJVNvxmtVo\">https://t.co/sJVNvxmtVo</a> <a href=\"http://t.co/Ug7V3QqmxN\">pic.twitter.com/Ug7V3QqmxN</a></p>&mdash; Yoshihiro Shindo (@beinteractive) <a href=\"https://twitter.com/beinteractive/status/599153712959860739\">2015, 5\u6708 15</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n", "tags": ["Unity", "Web", "Ruby"]}