{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nMac\u3067\u30ed\u30fc\u30ab\u30eb\u306e\u30c6\u30b9\u30c8\u74b0\u5883\u3092\u81ea\u52d5\u69cb\u7bc9\u3057\u305f\u3044\u306a\u30fc\u3068\u601d\u3044\u3001\u624b\u3092\u51fa\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u521d\u5fc3\u8005\u306a\u306e\u3067\u3001\u3067\u304d\u308b\u9650\u308a\u30b7\u30f3\u30d7\u30eb\u306a\u69cb\u6210\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u8a66\u3057\u3066\u307f\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n\u4e8b\u524d\u6e96\u5099\n\n\u307e\u305a\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nVirtualBox\uff1aVirtualBox 4.3.26\nDownload VirtualBox\n\nVagrant\uff1aVagrant 1.7.2\nDownload Vagrant\n\nChef\uff1aChef Development Kit Version: 0.4.0\nDownload Chef\n\n\n\n\u5fc5\u8981\u306a Vagrant \u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\n$ vagrant plugin install vagrant-omnibus\n$ vagrant plugin install vagrant-chef-zero\n$ vagrant plugin install vagrant-vbox-snapshot\n\n\nvagrant-omnibus\uff1a\u30b2\u30b9\u30c8 OS \u306b Chef \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u30d7\u30e9\u30b0\u30a4\u30f3\nvagrant-chef-zero\uff1aVagrant \u304b\u3089 Chef Zero Server \u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\nvagrant-vbox-snapshot\uff1aVagrant \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u7ba1\u7406\u3059\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\n\n\n\u69cb\u7bc9\u3057\u3066\u307f\u308b\n\nVagrantFile \u306e\u4f5c\u6210\n\u307e\u305a\u306f\u3001\u3072\u306a\u5f62\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u77ed\u6642\u9593\u3067\u4eee\u60f3\u74b0\u5883\u3092\u4f5c\u308a\u305f\u3044\u306e\u3067\u3001Box \u3068\u547c\u3070\u308c\u308b\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e CentOS6.4 \u3092\u4f7f\u3046\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n$ mkdir test_centos64\n$ cd test_centos64\n$ vagrant init test_centos64 http://developer.nrel.gov/downloads/vagrant-boxes/CentOS-6.4-x86_64-v20131103.box\n\n\u305d\u3046\u3059\u308b\u3068 Vagrantfile \u304c\u4f5c\u6210\u3055\u308c\u3001\u4e2d\u8eab\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\nVagrantfile\nVagrant.configure(2) do |config|\n  \u30fb\u30fb\u30fb\n  config.vm.box = \"test_centos64\"\n  config.vm.box_url = \"http://developer.nrel.gov/downloads/vagrant-boxes/CentOS-6.4-x86_64-v20131103.box\"\n  \u30fb\u30fb\u30fb\nend\n\n\n\nconfig.vm.box\uff1a\u81ea\u5206\u306e box \u306e\u540d\u524d\u3068\u3057\u3066 box \u306e\u5185\u5bb9\u304c\u5206\u304b\u308b\u3088\u3046\u306a\u6587\u5b57\u5217\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nconfig.vm.box_url\uff1aBox \u306e URL \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u53c2\u7167\uff1ahttp://www.vagrantbox.es/\n\n\n\u3053\u308c\u3089\u306e\u8a18\u8ff0\u304c\u3042\u308b\u3068\u3001\u30ed\u30fc\u30ab\u30eb\u306e Box \u306b\"test_centos64\"\u3068\u3044\u3046 Box \u304c\u3042\u308b\u5834\u5408\u3001\u30ed\u30fc\u30ab\u30eb\u306e Box \u304c\u4f7f\u308f\u308c\u3001\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u6307\u5b9a\u3057\u305f URL \u304b\u3089 Box \u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u306b\u914d\u7f6e\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u7d9a\u3044\u3066\u3001Vagrantfile \u306b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3057\u307e\u3059\n\nVagrantfile\nVagrant.configure(2) do |config|\n  \u30fb\u30fb\u30fb\n  config.vm.network :private_network, ip:\"192.168.33.20\"\n  \u30fb\u30fb\u30fb\nend\n\n\n\u3053\u308c\u306f\u5225\u306b\u8a2d\u5b9a\u3057\u306a\u304f\u3066\u3082\u3044\u3044\u3051\u3069\u3001\u628a\u63e1\u3057\u3066\u304a\u304d\u305f\u3044\u306e\u3067\u3001\u9069\u5f53\u306b\u3002\n\u3053\u3053\u307e\u3067\u304d\u305f\u3089\u3001\u4e00\u5ea6\u4eee\u60f3\u30de\u30b7\u30f3\u304c\u8d77\u52d5\u3067\u304d\u308b\u304b\u78ba\u304b\u3081\u3066\u307f\u307e\u3059\u3002\n$ vagrant up\n\n\u8d77\u52d5\u3067\u304d\u305f\u3089\u3001\u30b2\u30b9\u30c8 OS \u306b\u63a5\u7d9a\u3057\u3066\u307f\u307e\u3059\n$ vagrant ssh\n\n\u7121\u4e8b\u306b\u63a5\u7d9aOK\uff01\n\u554f\u984c\u306a\u304f\u63a5\u7d9a\u3067\u304d\u305f\u3089\u3001\u30b2\u30b9\u30c8 OS \u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u3044\u308d\u3044\u308d\u8a66\u3059\u305f\u3081\u306b\u3082 Vagrant \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3068\u3063\u3066\u304a\u304f\n\u521d\u671f\u72b6\u614b\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3002\u3053\u308c\u3067\u56f0\u3063\u305f\u3089\u521d\u671f\u72b6\u614b\u306b\u623b\u305b\u307e\u3059\u3002\n# \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u4f5c\u6210\n$ vagrant snapshot take test_centos64-init\n# \u78ba\u8a8d\n$ vagrant snapshot list\n\n\n\u30b2\u30b9\u30c8 OS \u306bChef\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nVagrantfile \u306b\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3088\u3046\u306b\u4e0b\u8a18\u8a2d\u5b9a\u3092\u8ffd\u52a0\n\nVagrantfile\nVagrant.configure(2) do |config|\n  \u30fb\u30fb\u30fb\n  config.omnibus.chef_version=:latest\n  \u30fb\u30fb\u30fb\nend\n\n\n\u8d77\u52d5\u4e2d\u306e\u30b2\u30b9\u30c8 OS \u306b provisioners \u3092\u5b9f\u884c\n$ vagrant provision\n\n\nChef \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u3068\u308a\u3042\u3048\u305a\u30d5\u30a1\u30a4\u30eb\u306e\u96db\u5f62\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n$ chef generate repo chef-repo\n$ tree\n.\n\u251c\u2500\u2500 Vagrantfile\n\u2514\u2500\u2500 chef-repo\n    \u251c\u2500\u2500 LICENSE\n    \u251c\u2500\u2500 README.md\n    \u251c\u2500\u2500 Rakefile\n    \u251c\u2500\u2500 certificates\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 chefignore\n    \u251c\u2500\u2500 config\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 rake.rb\n    \u251c\u2500\u2500 cookbooks\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 data_bags\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 environments\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u2514\u2500\u2500 roles\n        \u2514\u2500\u2500 README.md\n\n\nBerksfile \u3092\u4f5c\u6210\nBerkshelf \u3092\u4f7f\u3063\u3066 cookbook \u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b Berksfile \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ cd chef-repo\n$ vi Berksfile\n\n\u4eca\u56de\u306f\u304a\u8a66\u3057\u3068\u3044\u3046\u3053\u3068\u3067\u3001github \u4e0a\u306b\u516c\u958b\u3055\u308c\u3066\u3044\u308b timezone \u3092\u5909\u66f4\u3059\u308b cookbook \u3092\u5229\u7528\u3057\u3066\u307f\u307e\u3059\u30021\n\nBerksfile\nsource \"https://supermarket.chef.io\"\n\ncookbook 'timezone-ii', git: \"https://github.com/L2G/timezone-ii.git\"\n\n\ncookbooks \u914d\u4e0b\u306b cookbook \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ berks vendor cookbooks\n$ cd ..\n$ tree\n.\n\u251c\u2500\u2500 Vagrantfile\n\u2514\u2500\u2500 chef-repo\n    \u251c\u2500\u2500 Berksfile\n    \u251c\u2500\u2500 Berksfile.lock\n    \u251c\u2500\u2500 LICENSE\n    \u251c\u2500\u2500 README.md\n    \u251c\u2500\u2500 Rakefile\n    \u251c\u2500\u2500 certificates\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 chefignore\n    \u251c\u2500\u2500 config\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 rake.rb\n    \u251c\u2500\u2500 cookbooks\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 timezone-ii\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 Gemfile\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 Gemfile.lock\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 LICENSE\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 README.md\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 Thorfile\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 attributes\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 default.rb\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 chefignore\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 files\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 default\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0     \u2514\u2500\u2500 tests\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0         \u2514\u2500\u2500 minitest\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0             \u2514\u2500\u2500 default_test.rb\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 metadata.json\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 recipes\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 amazon.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 debian.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 default.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 fedora.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 linux-generic.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 pld.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 rhel.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 rhel7.rb\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 spec\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 attributes_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 recipes\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 amazon_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 debian_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 default_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 fedora_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 linux-generic_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 pld_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 rhel7_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 rhel_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 spec_helper.rb\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 templates\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 amazon\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 clock.erb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 centos\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 clock.erb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 default\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 timezone.conf.erb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 pld\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 timezone.conf.erb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 redhat\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0     \u2514\u2500\u2500 clock.erb\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 test\n    \u2502\u00a0\u00a0         \u2514\u2500\u2500 integration\n    \u2502\u00a0\u00a0             \u251c\u2500\u2500 default\n    \u2502\u00a0\u00a0             \u2502\u00a0\u00a0 \u2514\u2500\u2500 bats\n    \u2502\u00a0\u00a0             \u2502\u00a0\u00a0     \u251c\u2500\u2500 date_output.bats\n    \u2502\u00a0\u00a0             \u2502\u00a0\u00a0     \u251c\u2500\u2500 debian.bats\n    \u2502\u00a0\u00a0             \u2502\u00a0\u00a0     \u2514\u2500\u2500 etc_localtime.bats\n    \u2502\u00a0\u00a0             \u2514\u2500\u2500 helpers\n    \u2502\u00a0\u00a0                 \u2514\u2500\u2500 bats\n    \u2502\u00a0\u00a0                     \u2514\u2500\u2500 helper.bash\n    \u251c\u2500\u2500 data_bags\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 environments\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u2514\u2500\u2500 roles\n        \u2514\u2500\u2500 README.md\n\n\nVagrant \u3068 Chef \u3092\u9023\u643a\u3057\u307e\u3059\n\u8abf\u3079\u3066\u307f\u305f\u3051\u3069\u3001\u3044\u307e\u3044\u3061\u3069\u3046\u7ba1\u7406\u3059\u308b\u306e\u304c\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u306a\u306e\u304b\u308f\u304b\u3089\u306a\u3044\u3002\n\u5171\u901a\u7cfb\u306e cookbook \u306f roles \u3067 run_list \u3057\u3061\u3083\u3046\u65b9\u91dd\u3068\u3057\u3066\u4f5c\u3063\u3066\u307f\u308b\u3002\n$ vi chef-repo/roles/common.json\n\n\ncommon.json\n{\n  \"name\": \"common\",\n  \"chef_type\": \"role\",\n  \"json_class\": \"Chef::Role\",\n  \"default_attributes\": {\n    \"tz\": \"Asia/Tokyo\"\n  },\n  \"run_list\": [\n    \"recipe[timezone-ii::rhel]\"\n  ]\n}\n\n\n\u305f\u3060\u3001roles \u3067 run_list \u306f\u30a2\u30f3\u30c1\u30d1\u30bf\u30fc\u30f3\u306b\u8a72\u5f53\u3057\u3066\u3057\u307e\u3046\u306e\u304b\u3082\u3002\u3002\u30022\nVagrantfile \u306b\u4e0b\u8a18\u3092\u8ffd\u52a0\u3057\u307e\u3059\n$ vi Vagrantfile\n\n\nVagrantfile\nVagrant.configure(2) do |config|\n  \u30fb\u30fb\u30fb\n  config.vm.provision \"chef_zero\" do |chef|\n    chef.cookbooks_path = \"./chef-repo/cookbooks\"\n    chef.roles_path = \"chef-repo/roles\"\n    chef.add_role \"common\"\n  end\n  \u30fb\u30fb\u30fb\nend\n\n\n\u8d77\u52d5\u4e2d\u306e\u30b2\u30b9\u30c8 OS \u3092\u518d\u8d77\u52d5\u3057\u3066 provisioners \u3092\u5b9f\u884c\n$ rm .vagrant/machines/default/virtualbox/synced_folders\n$ vagrant reload --provision\n\n\u30d0\u30b0\u3089\u3057\u304f\u3001\u901a\u5e38\u306e provisioners \u3092\u5b9f\u884c\u3060\u3068\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3053\u308c\u3067\u3001\u30b2\u30b9\u30c8 OS \u8d77\u52d5\u6642\u306b recipe \u304c\u5b9f\u884c\u3055\u308c\u3001timezone \u304c\"Asia/Tokyo\"\u306b\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u3002\n\n\u307e\u3060\u307e\u3060\u521d\u5fc3\u8005\u306a\u306e\u3067\u3001\n\u4eca\u5f8c\u3001\u81ea\u4f5c recipe \u3092\u4f5c\u3063\u3066\u307f\u305f\u308a\u3001knife \u4f7f\u3063\u3066\u307f\u305f\u308a\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8/\u30b5\u30fc\u30d0\u30fc\u69cb\u6210\u306b\u3057\u3066\u307f\u305f\u308a\u3001\u6700\u7d42\u7684\u306b\u306f Docker \u3042\u305f\u308a\u306b\u3082\u624b\u3092\u51fa\u3057\u3066\u3001\u3088\u308a\u7406\u89e3\u3092\u6df1\u3081\u3066\u3044\u3051\u308c\u3070\u306a\u3068\u3002\n\n\n\n\n\n2015/03/20\u6642\u70b9\u3067\u306f\u3001https://supermarket.chef.io \u306b\u306f\u6700\u65b0\u306e timezone-ii \u304c\u30a2\u30c3\u30d7\u3055\u308c\u3066\u3044\u306a\u304f\u3066\u3001 CentOs \u3060\u3068 /etc/sysconfig/clock \u306f\u66f4\u65b0\u3055\u308c\u306a\u3044\u307f\u305f\u3044\u3067\u3059\u3002\u00a0\u21a9\n\n\n[\u548c\u8a33]ChefConf 2013: Beginner Chef Antipatterns\u00a0\u21a9\n\n\n\n# \u306f\u3058\u3081\u306b\nMac\u3067\u30ed\u30fc\u30ab\u30eb\u306e\u30c6\u30b9\u30c8\u74b0\u5883\u3092\u81ea\u52d5\u69cb\u7bc9\u3057\u305f\u3044\u306a\u30fc\u3068\u601d\u3044\u3001\u624b\u3092\u51fa\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u521d\u5fc3\u8005\u306a\u306e\u3067\u3001\u3067\u304d\u308b\u9650\u308a\u30b7\u30f3\u30d7\u30eb\u306a\u69cb\u6210\u3067\u3001\u3068\u308a\u3042\u3048\u305a\u8a66\u3057\u3066\u307f\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n# \u4e8b\u524d\u6e96\u5099\n\n## \u307e\u305a\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n- VirtualBox\uff1aVirtualBox 4.3.26  \n[Download VirtualBox](https://www.virtualbox.org/wiki/Downloads)\n- Vagrant\uff1aVagrant 1.7.2  \n[Download Vagrant](http://www.vagrantup.com/download-archive/v1.7.2.html)\n- Chef\uff1aChef Development Kit Version: 0.4.0  \n[Download Chef](https://downloads.chef.io/chef-dk/mac/#/0.4.0)\n\n## \u5fc5\u8981\u306a Vagrant \u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\n```\n$ vagrant plugin install vagrant-omnibus\n$ vagrant plugin install vagrant-chef-zero\n$ vagrant plugin install vagrant-vbox-snapshot\n```\n\n- vagrant-omnibus\uff1a\u30b2\u30b9\u30c8 OS \u306b Chef \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u30d7\u30e9\u30b0\u30a4\u30f3\n- vagrant-chef-zero\uff1aVagrant \u304b\u3089 Chef Zero Server \u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\n- vagrant-vbox-snapshot\uff1aVagrant \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u7ba1\u7406\u3059\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\n\n# \u69cb\u7bc9\u3057\u3066\u307f\u308b\n\n### VagrantFile \u306e\u4f5c\u6210\n\n\u307e\u305a\u306f\u3001\u3072\u306a\u5f62\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u77ed\u6642\u9593\u3067\u4eee\u60f3\u74b0\u5883\u3092\u4f5c\u308a\u305f\u3044\u306e\u3067\u3001Box \u3068\u547c\u3070\u308c\u308b\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e CentOS6.4 \u3092\u4f7f\u3046\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n```bash\n$ mkdir test_centos64\n$ cd test_centos64\n$ vagrant init test_centos64 http://developer.nrel.gov/downloads/vagrant-boxes/CentOS-6.4-x86_64-v20131103.box\n```\n\n\u305d\u3046\u3059\u308b\u3068 Vagrantfile \u304c\u4f5c\u6210\u3055\u308c\u3001\u4e2d\u8eab\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n```vim:Vagrantfile\nVagrant.configure(2) do |config|\n  \u30fb\u30fb\u30fb\n  config.vm.box = \"test_centos64\"\n  config.vm.box_url = \"http://developer.nrel.gov/downloads/vagrant-boxes/CentOS-6.4-x86_64-v20131103.box\"\n  \u30fb\u30fb\u30fb\nend\n```\n- config.vm.box\uff1a\u81ea\u5206\u306e box \u306e\u540d\u524d\u3068\u3057\u3066 box \u306e\u5185\u5bb9\u304c\u5206\u304b\u308b\u3088\u3046\u306a\u6587\u5b57\u5217\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n- config.vm.box_url\uff1aBox \u306e URL \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002  \n\u53c2\u7167\uff1ahttp://www.vagrantbox.es/\n\n\u3053\u308c\u3089\u306e\u8a18\u8ff0\u304c\u3042\u308b\u3068\u3001\u30ed\u30fc\u30ab\u30eb\u306e Box \u306b\"test_centos64\"\u3068\u3044\u3046 Box \u304c\u3042\u308b\u5834\u5408\u3001\u30ed\u30fc\u30ab\u30eb\u306e Box \u304c\u4f7f\u308f\u308c\u3001\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u6307\u5b9a\u3057\u305f URL \u304b\u3089 Box \u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u306b\u914d\u7f6e\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u7d9a\u3044\u3066\u3001Vagrantfile \u306b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\u3057\u307e\u3059\n\n```vim:Vagrantfile\nVagrant.configure(2) do |config|\n  \u30fb\u30fb\u30fb\n  config.vm.network :private_network, ip:\"192.168.33.20\"\n  \u30fb\u30fb\u30fb\nend\n```\n\u3053\u308c\u306f\u5225\u306b\u8a2d\u5b9a\u3057\u306a\u304f\u3066\u3082\u3044\u3044\u3051\u3069\u3001\u628a\u63e1\u3057\u3066\u304a\u304d\u305f\u3044\u306e\u3067\u3001\u9069\u5f53\u306b\u3002\n\n\u3053\u3053\u307e\u3067\u304d\u305f\u3089\u3001\u4e00\u5ea6\u4eee\u60f3\u30de\u30b7\u30f3\u304c\u8d77\u52d5\u3067\u304d\u308b\u304b\u78ba\u304b\u3081\u3066\u307f\u307e\u3059\u3002\n\n```bash\n$ vagrant up\n```\n\n\u8d77\u52d5\u3067\u304d\u305f\u3089\u3001\u30b2\u30b9\u30c8 OS \u306b\u63a5\u7d9a\u3057\u3066\u307f\u307e\u3059\n\n```bash\n$ vagrant ssh\n```\n\n\u7121\u4e8b\u306b\u63a5\u7d9aOK\uff01\n\u554f\u984c\u306a\u304f\u63a5\u7d9a\u3067\u304d\u305f\u3089\u3001\u30b2\u30b9\u30c8 OS \u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n### \u3044\u308d\u3044\u308d\u8a66\u3059\u305f\u3081\u306b\u3082 Vagrant \u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3068\u3063\u3066\u304a\u304f\n\n\u521d\u671f\u72b6\u614b\u3092\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3002\u3053\u308c\u3067\u56f0\u3063\u305f\u3089\u521d\u671f\u72b6\u614b\u306b\u623b\u305b\u307e\u3059\u3002\n\n```bash\n# \u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u4f5c\u6210\n$ vagrant snapshot take test_centos64-init\n# \u78ba\u8a8d\n$ vagrant snapshot list\n```\n\n### \u30b2\u30b9\u30c8 OS \u306bChef\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nVagrantfile \u306b\u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3088\u3046\u306b\u4e0b\u8a18\u8a2d\u5b9a\u3092\u8ffd\u52a0\n\n```vim:Vagrantfile\nVagrant.configure(2) do |config|\n  \u30fb\u30fb\u30fb\n  config.omnibus.chef_version=:latest\n  \u30fb\u30fb\u30fb\nend\n```\n\n\u8d77\u52d5\u4e2d\u306e\u30b2\u30b9\u30c8 OS \u306b provisioners \u3092\u5b9f\u884c\n\n```bash\n$ vagrant provision\n```\n\n### Chef \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\n\u3068\u308a\u3042\u3048\u305a\u30d5\u30a1\u30a4\u30eb\u306e\u96db\u5f62\u3092\u751f\u6210\u3057\u307e\u3059\u3002\n\n```bash\n$ chef generate repo chef-repo\n$ tree\n.\n\u251c\u2500\u2500 Vagrantfile\n\u2514\u2500\u2500 chef-repo\n    \u251c\u2500\u2500 LICENSE\n    \u251c\u2500\u2500 README.md\n    \u251c\u2500\u2500 Rakefile\n    \u251c\u2500\u2500 certificates\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 chefignore\n    \u251c\u2500\u2500 config\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 rake.rb\n    \u251c\u2500\u2500 cookbooks\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 data_bags\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 environments\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u2514\u2500\u2500 roles\n        \u2514\u2500\u2500 README.md\n```\n\n### Berksfile \u3092\u4f5c\u6210\n\nBerkshelf \u3092\u4f7f\u3063\u3066 cookbook \u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b Berksfile \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash\n$ cd chef-repo\n$ vi Berksfile\n```\n\n\u4eca\u56de\u306f\u304a\u8a66\u3057\u3068\u3044\u3046\u3053\u3068\u3067\u3001github \u4e0a\u306b\u516c\u958b\u3055\u308c\u3066\u3044\u308b timezone \u3092\u5909\u66f4\u3059\u308b cookbook \u3092\u5229\u7528\u3057\u3066\u307f\u307e\u3059\u3002[^1]\n\n```vi:Berksfile\nsource \"https://supermarket.chef.io\"\n\ncookbook 'timezone-ii', git: \"https://github.com/L2G/timezone-ii.git\"\n```\n\ncookbooks \u914d\u4e0b\u306b cookbook \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ berks vendor cookbooks\n$ cd ..\n$ tree\n.\n\u251c\u2500\u2500 Vagrantfile\n\u2514\u2500\u2500 chef-repo\n    \u251c\u2500\u2500 Berksfile\n    \u251c\u2500\u2500 Berksfile.lock\n    \u251c\u2500\u2500 LICENSE\n    \u251c\u2500\u2500 README.md\n    \u251c\u2500\u2500 Rakefile\n    \u251c\u2500\u2500 certificates\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 chefignore\n    \u251c\u2500\u2500 config\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 rake.rb\n    \u251c\u2500\u2500 cookbooks\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 timezone-ii\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 Gemfile\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 Gemfile.lock\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 LICENSE\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 README.md\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 Thorfile\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 attributes\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 default.rb\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 chefignore\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 files\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 default\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0     \u2514\u2500\u2500 tests\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0         \u2514\u2500\u2500 minitest\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0             \u2514\u2500\u2500 default_test.rb\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 metadata.json\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 recipes\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 amazon.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 debian.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 default.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 fedora.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 linux-generic.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 pld.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 rhel.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 rhel7.rb\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 spec\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 attributes_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 recipes\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 amazon_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 debian_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 default_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 fedora_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 linux-generic_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 pld_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 rhel7_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 rhel_spec.rb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 spec_helper.rb\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 templates\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 amazon\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 clock.erb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 centos\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 clock.erb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 default\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 timezone.conf.erb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u251c\u2500\u2500 pld\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 timezone.conf.erb\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 redhat\n    \u2502\u00a0\u00a0     \u2502\u00a0\u00a0     \u2514\u2500\u2500 clock.erb\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 test\n    \u2502\u00a0\u00a0         \u2514\u2500\u2500 integration\n    \u2502\u00a0\u00a0             \u251c\u2500\u2500 default\n    \u2502\u00a0\u00a0             \u2502\u00a0\u00a0 \u2514\u2500\u2500 bats\n    \u2502\u00a0\u00a0             \u2502\u00a0\u00a0     \u251c\u2500\u2500 date_output.bats\n    \u2502\u00a0\u00a0             \u2502\u00a0\u00a0     \u251c\u2500\u2500 debian.bats\n    \u2502\u00a0\u00a0             \u2502\u00a0\u00a0     \u2514\u2500\u2500 etc_localtime.bats\n    \u2502\u00a0\u00a0             \u2514\u2500\u2500 helpers\n    \u2502\u00a0\u00a0                 \u2514\u2500\u2500 bats\n    \u2502\u00a0\u00a0                     \u2514\u2500\u2500 helper.bash\n    \u251c\u2500\u2500 data_bags\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u251c\u2500\u2500 environments\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 README.md\n    \u2514\u2500\u2500 roles\n        \u2514\u2500\u2500 README.md\n```\n\n### Vagrant \u3068 Chef \u3092\u9023\u643a\u3057\u307e\u3059\n\n\u8abf\u3079\u3066\u307f\u305f\u3051\u3069\u3001\u3044\u307e\u3044\u3061\u3069\u3046\u7ba1\u7406\u3059\u308b\u306e\u304c\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u306a\u306e\u304b\u308f\u304b\u3089\u306a\u3044\u3002\n\u5171\u901a\u7cfb\u306e cookbook \u306f roles \u3067 run_list \u3057\u3061\u3083\u3046\u65b9\u91dd\u3068\u3057\u3066\u4f5c\u3063\u3066\u307f\u308b\u3002\n\n```bash\n$ vi chef-repo/roles/common.json\n```\n\n```vim:common.json\n{\n  \"name\": \"common\",\n  \"chef_type\": \"role\",\n  \"json_class\": \"Chef::Role\",\n  \"default_attributes\": {\n    \"tz\": \"Asia/Tokyo\"\n  },\n  \"run_list\": [\n    \"recipe[timezone-ii::rhel]\"\n  ]\n}\n```\n\u305f\u3060\u3001roles \u3067 run_list \u306f\u30a2\u30f3\u30c1\u30d1\u30bf\u30fc\u30f3\u306b\u8a72\u5f53\u3057\u3066\u3057\u307e\u3046\u306e\u304b\u3082\u3002\u3002\u3002[^2]\n\nVagrantfile \u306b\u4e0b\u8a18\u3092\u8ffd\u52a0\u3057\u307e\u3059\n\n```bash\n$ vi Vagrantfile\n```\n\n```vim:Vagrantfile\nVagrant.configure(2) do |config|\n  \u30fb\u30fb\u30fb\n  config.vm.provision \"chef_zero\" do |chef|\n    chef.cookbooks_path = \"./chef-repo/cookbooks\"\n    chef.roles_path = \"chef-repo/roles\"\n    chef.add_role \"common\"\n  end\n  \u30fb\u30fb\u30fb\nend\n```\n\n\u8d77\u52d5\u4e2d\u306e\u30b2\u30b9\u30c8 OS \u3092\u518d\u8d77\u52d5\u3057\u3066 provisioners \u3092\u5b9f\u884c\n\n```bash\n$ rm .vagrant/machines/default/virtualbox/synced_folders\n$ vagrant reload --provision\n```\n\u30d0\u30b0\u3089\u3057\u304f\u3001**\u901a\u5e38\u306e provisioners \u3092\u5b9f\u884c\u3060\u3068\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002**\n\n\u3053\u308c\u3067\u3001\u30b2\u30b9\u30c8 OS \u8d77\u52d5\u6642\u306b recipe \u304c\u5b9f\u884c\u3055\u308c\u3001timezone \u304c\"Asia/Tokyo\"\u306b\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u3002\n\n****\n\u307e\u3060\u307e\u3060\u521d\u5fc3\u8005\u306a\u306e\u3067\u3001\n\u4eca\u5f8c\u3001\u81ea\u4f5c recipe \u3092\u4f5c\u3063\u3066\u307f\u305f\u308a\u3001knife \u4f7f\u3063\u3066\u307f\u305f\u308a\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8/\u30b5\u30fc\u30d0\u30fc\u69cb\u6210\u306b\u3057\u3066\u307f\u305f\u308a\u3001\u6700\u7d42\u7684\u306b\u306f Docker \u3042\u305f\u308a\u306b\u3082\u624b\u3092\u51fa\u3057\u3066\u3001\u3088\u308a\u7406\u89e3\u3092\u6df1\u3081\u3066\u3044\u3051\u308c\u3070\u306a\u3068\u3002\n\n****\n[^1]: 2015/03/20\u6642\u70b9\u3067\u306f\u3001https://supermarket.chef.io \u306b\u306f\u6700\u65b0\u306e timezone-ii \u304c\u30a2\u30c3\u30d7\u3055\u308c\u3066\u3044\u306a\u304f\u3066\u3001 **CentOs \u3060\u3068 /etc/sysconfig/clock \u306f\u66f4\u65b0\u3055\u308c\u306a\u3044\u307f\u305f\u3044\u3067\u3059\u3002**\n\n[^2]: [[\u548c\u8a33]ChefConf 2013: Beginner Chef Antipatterns](http://www.creationline.com/lab/3080)\n", "tags": ["vagrant1.7.2", "chef", "chef-zero", "Berkshelf"]}