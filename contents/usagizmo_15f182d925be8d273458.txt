{"context": "DigitalOcean \u3092\u5229\u7528\u3057\u305fLAMP\u30c6\u30b9\u30c8\u30b5\u30fc\u30d0\u306e\u69cb\u7bc9\u65b9\u6cd5\u3067\u3059\u3002\n\u3082\u3057\u672c\u756a\u904b\u7528\u3092\u3059\u308b\u5834\u5408\u306b\u306f root \u3067\u306eSSH\u30ed\u30b0\u30a4\u30f3\u3092\u7981\u6b62\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30c9\u30ed\u30c3\u30d7\u30ec\u30c3\u30c8\u306e\u4f5c\u6210\n\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u53c2\u8003\u306b\u3001\u30c9\u30ed\u30c3\u30d7\u30ec\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nChoose an image > One-click Apps > LAMP on 16.04\nChoose a size > $5 / mo\nChoose a datacenter region > Singapore\nAdd your SSH keys > <\u81ea\u5206\u306e\u516c\u958b\u9375\u3092\u9078\u629e>\nFinalize and create > Choose a hostname > <\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u540d-\u6848\u4ef6\u540d>\n\n\nSSH\u3067\u306e\u30a2\u30af\u30bb\u30b9\n\u4f5c\u6210\u3057\u305f\u30c9\u30ed\u30c3\u30d7\u30ec\u30c3\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u78ba\u8a8d\u3057\u3066\u3001Terminal (iTerm) \u304b\u3089SSH\u63a5\u7d9a\u3092\u3057\u307e\u3059\u3002\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8PC\nvi ~/.ssh/config\n...\n# \u8ffd\u52a0\nHost rabi  # SSH\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u540d\u3068\u3057\u3066\u5229\u7528/\u9069\u5b9c\u5909\u66f4\n  HostName <IP Address>\n  User root\n  IdentityFile ~/.ssh/id_rsa\n\nssh rabi  # SSH\u63a5\u7d9a\n\n\n\u5fc5\u8981\u3067\u3042\u308c\u3070\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306e\u305f\u3081\u306b\u3001\u4e0a\u8a18\u3068\u540c\u69d8\u306e\u8a2d\u5b9a\u3092SFTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u3082\u884c\u3063\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\npublic/ \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4ee5\u4e0b\u3092\u540c\u671f\u3055\u305b\u308b\u904b\u7528\u3067\u3042\u308c\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30de\u30f3\u30c9\u3067\u6e08\u307e\u305b\u3066\u3082\u3044\u3044\u3067\u3059\u30021\n# rsync <\u30b3\u30d4\u30fc\u5143> <\u30b3\u30d4\u30fc\u5148>\nrsync -av --delete --exclude=\".*\" public/ rabi:/var/www/html/\n\n\u203b \u30b3\u30d4\u30fc\u5143\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u672b\u5c3e\u30b9\u30e9\u30c3\u30b7\u30e5\u306f\u5fc5\u9808\n\u53c2\u8003: http://www.itmedia.co.jp/enterprise/articles/0804/21/news013.html\n\u4ee5\u4e0b\u3088\u308a\u3001SSH\u3067\u63a5\u7d9a\u3057\u305f\u30db\u30b9\u30c8PC\u3067\u306e\u64cd\u4f5c\u3068\u306a\u308a\u307e\u3059\u3002\n\nSSH\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3092\u4e0d\u53ef\u306b\u3059\u308b\n\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3092\u4e0d\u53ef\u306b\u3057\u3001\u516c\u958b\u9375\u8a8d\u8a3c\u306e\u307f\u53d7\u3051\u4ed8\u3051\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n/etc/ssh/sshd_config\n- PasswordAuthentication yes\n+ PasswordAuthentication no \n\n\nservice ssh restart  # sshd \u306e\u518d\u8d77\u52d5\n\n\n\u30d9\u30fc\u30b7\u30c3\u30af\u8a8d\u8a3c\n\n.htaccess \u306e\u8a2d\u5b9a\n\u4ee5\u4e0b\u306e .htaccess \u30d5\u30a1\u30a4\u30eb\u3092\u30b5\u30fc\u30d0\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n/var/www/html/.htaccess\n<Files ~ \"^\\.(htaccess|htpasswd)$\">\ndeny from all\n</Files>\nOptions -Indexes\nAuthUserFile /var/www/html/.htpasswd\n# AuthGroupFile /dev/null\nAuthName \"Please enter your ID and password\"\nAuthType Basic\nrequire valid-user \norder deny,allow\n\n\n\u4f5c\u6210\u5143: .htaccess Editor\n\u203b AuthGroupFile \u306e\u884c\u306f\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\uff08\u307e\u305f\u306f\u524a\u9664\uff09\u304c\u5fc5\u8981\u3067\u3059\n\n.htpasswd \u306e\u8a2d\u5b9a\napt-get install apache2-utils\nhtpasswd -c /var/www/html/.htpasswd <\u30e6\u30fc\u30b6\u540d>\n\n\n.htaccess \u306e\u6709\u52b9\u5316\n\n/etc/apache2/apache2.conf\n<Directory /var/www/>\n        Options Indexes FollowSymLinks\n-       AllowOverride None\n+       AllowOverride All\n        Require all granted\n</Directory>\n\n\n\nApache \u306e\u518d\u8d77\u52d5\nservice apache2 restart\n\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\n\n\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u6a5f\u80fd\u3092\u5229\u7528\u3059\u308b\u5834\u5408\n.htaccess \u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u51e6\u7406\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\nsudo a2enmod rewrite  # mod_rewrite \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u6709\u52b9\u5316\nservice apache2 restart\n\n\n\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u5834\u5408\n\n/etc/apache2/apache2.conf\n<Directory /var/www/>\n        Options Indexes FollowSymLinks\n        AllowOverride All\n        Require all granted\n+       LogLevel rewrite:trace8  # trace[\u6570\u5b57] \u306e\u5024\u306f\u8abf\u7bc0\n</Directory>\n\n\n\u53c2\u8003: Apache HTTP \u30b5\u30fc\u30d0 \u30d0\u30fc\u30b8\u30e7\u30f3 2.4 > LogLevel\nservice apache2 restart\ntail -f /var/log/apache2/error.log  # \u30a8\u30e9\u30fc\u30ed\u30b0\u3092\u76e3\u8996\n\n\nSSI \u3092\u5229\u7528\u3059\u308b\u5834\u5408\nsudo a2enmod include  # mod_include \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u6709\u52b9\u5316\n# \u2191 \u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3068\u540c\u3058\u610f\u5473\n# ln -s /etc/apache2/mods-available/include.conf /etc/apache2/mods-enabled/include.conf\n# ln -s /etc/apache2/mods-available/include.load /etc/apache2/mods-enabled/include.load\n\nservice apache2 restart\n\n\nSSL \u3092\u5229\u7528\u3059\u308b\u5834\u5408\nsudo a2enmod ssl  # SSL \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u6709\u52b9\u5316\nsudo service apache2 restart\n\nLet's Encrypt \u3092\u5229\u7528\u3057\u305f\u5834\u5408\n\n/etc/apache2/sites-available/default-ssl.conf\n- ServerAdmin webmaster@localhost\n+ ServerAdmin <\u7ba1\u7406\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9>\n...\n- SSLCertificateFile      /etc/ssl/certs/ssl-cert-snakeoil.pem\n+ SSLCertificateFile     /etc/letsencrypt/archive/<\u30c9\u30e1\u30a4\u30f3\u540d>/fullchain1.pem\n- SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key\n+ SSLCertificateKeyFile    /etc/letsencrypt/archive/<\u30c9\u30e1\u30a4\u30f3\u540d>/privkey1.pem\n\n\nsudo a2ensite default-ssl.conf  # SSL\u7528\u8a2d\u5b9a\u306e\u6709\u52b9\u5316\nsudo service apache2 restart\n\n\n\n\n\n[\u6240\u6709\u8005:\u30b0\u30eb\u30fc\u30d7] \u3082\u540c\u671f\u3055\u308c\u308b\u306e\u3067\u7559\u610f\u00a0\u21a9\n\n\n\n[DigitalOcean](https://cloud.digitalocean.com/droplets) \u3092\u5229\u7528\u3057\u305fLAMP\u30c6\u30b9\u30c8\u30b5\u30fc\u30d0\u306e\u69cb\u7bc9\u65b9\u6cd5\u3067\u3059\u3002\n\u3082\u3057\u672c\u756a\u904b\u7528\u3092\u3059\u308b\u5834\u5408\u306b\u306f root \u3067\u306eSSH\u30ed\u30b0\u30a4\u30f3\u3092\u7981\u6b62\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n## \u30c9\u30ed\u30c3\u30d7\u30ec\u30c3\u30c8\u306e\u4f5c\u6210\n\n\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u53c2\u8003\u306b\u3001\u30c9\u30ed\u30c3\u30d7\u30ec\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- Choose an image > One-click Apps > LAMP on 16.04\n- Choose a size > $5 / mo\n- Choose a datacenter region > Singapore\n- Add your SSH keys > <\u81ea\u5206\u306e\u516c\u958b\u9375\u3092\u9078\u629e>\n- Finalize and create > Choose a hostname > <\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u540d-\u6848\u4ef6\u540d>\n\n## SSH\u3067\u306e\u30a2\u30af\u30bb\u30b9\n\n\u4f5c\u6210\u3057\u305f\u30c9\u30ed\u30c3\u30d7\u30ec\u30c3\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u78ba\u8a8d\u3057\u3066\u3001Terminal (iTerm) \u304b\u3089SSH\u63a5\u7d9a\u3092\u3057\u307e\u3059\u3002\n\n```sh:\u30af\u30e9\u30a4\u30a2\u30f3\u30c8PC\nvi ~/.ssh/config\n...\n# \u8ffd\u52a0\nHost rabi  # SSH\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u540d\u3068\u3057\u3066\u5229\u7528/\u9069\u5b9c\u5909\u66f4\n  HostName <IP Address>\n  User root\n  IdentityFile ~/.ssh/id_rsa\n\nssh rabi  # SSH\u63a5\u7d9a\n```\n\n\u5fc5\u8981\u3067\u3042\u308c\u3070\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306e\u305f\u3081\u306b\u3001\u4e0a\u8a18\u3068\u540c\u69d8\u306e\u8a2d\u5b9a\u3092SFTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u3082\u884c\u3063\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\n`public/` \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4ee5\u4e0b\u3092\u540c\u671f\u3055\u305b\u308b\u904b\u7528\u3067\u3042\u308c\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30de\u30f3\u30c9\u3067\u6e08\u307e\u305b\u3066\u3082\u3044\u3044\u3067\u3059\u3002[^group]\n\n[^group]: [\u6240\u6709\u8005:\u30b0\u30eb\u30fc\u30d7] \u3082\u540c\u671f\u3055\u308c\u308b\u306e\u3067\u7559\u610f\n\n```\n# rsync <\u30b3\u30d4\u30fc\u5143> <\u30b3\u30d4\u30fc\u5148>\nrsync -av --delete --exclude=\".*\" public/ rabi:/var/www/html/\n```\n\n\u203b \u30b3\u30d4\u30fc\u5143\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u672b\u5c3e\u30b9\u30e9\u30c3\u30b7\u30e5\u306f\u5fc5\u9808\n\u53c2\u8003: http://www.itmedia.co.jp/enterprise/articles/0804/21/news013.html\n\n\u4ee5\u4e0b\u3088\u308a\u3001SSH\u3067\u63a5\u7d9a\u3057\u305f\u30db\u30b9\u30c8PC\u3067\u306e\u64cd\u4f5c\u3068\u306a\u308a\u307e\u3059\u3002\n\n## SSH\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3092\u4e0d\u53ef\u306b\u3059\u308b\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3092\u4e0d\u53ef\u306b\u3057\u3001\u516c\u958b\u9375\u8a8d\u8a3c\u306e\u307f\u53d7\u3051\u4ed8\u3051\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```diff:/etc/ssh/sshd_config\n- PasswordAuthentication yes\n+ PasswordAuthentication no \n```\n\n```sh\nservice ssh restart  # sshd \u306e\u518d\u8d77\u52d5\n```\n\n## \u30d9\u30fc\u30b7\u30c3\u30af\u8a8d\u8a3c\n\n### .htaccess \u306e\u8a2d\u5b9a\n\n\u4ee5\u4e0b\u306e .htaccess \u30d5\u30a1\u30a4\u30eb\u3092\u30b5\u30fc\u30d0\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n```/var/www/html/.htaccess\n<Files ~ \"^\\.(htaccess|htpasswd)$\">\ndeny from all\n</Files>\nOptions -Indexes\nAuthUserFile /var/www/html/.htpasswd\n# AuthGroupFile /dev/null\nAuthName \"Please enter your ID and password\"\nAuthType Basic\nrequire valid-user \norder deny,allow\n```\n\n\u4f5c\u6210\u5143: [.htaccess Editor](http://www.htaccesseditor.com)\n\u203b AuthGroupFile \u306e\u884c\u306f\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\uff08\u307e\u305f\u306f\u524a\u9664\uff09\u304c\u5fc5\u8981\u3067\u3059\n\n### .htpasswd \u306e\u8a2d\u5b9a\n\n```\napt-get install apache2-utils\nhtpasswd -c /var/www/html/.htpasswd <\u30e6\u30fc\u30b6\u540d>\n```\n\n### .htaccess \u306e\u6709\u52b9\u5316\n\n```diff:/etc/apache2/apache2.conf\n<Directory /var/www/>\n        Options Indexes FollowSymLinks\n-       AllowOverride None\n+       AllowOverride All\n        Require all granted\n</Directory>\n```\n\n### Apache \u306e\u518d\u8d77\u52d5\n\n```sh\nservice apache2 restart\n```\n\n## \u30aa\u30d7\u30b7\u30e7\u30f3\n\n### \u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u6a5f\u80fd\u3092\u5229\u7528\u3059\u308b\u5834\u5408\n\n.htaccess \u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u51e6\u7406\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n```sh\nsudo a2enmod rewrite  # mod_rewrite \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u6709\u52b9\u5316\nservice apache2 restart\n```\n\n#### \u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u306e\u30ed\u30b0\u3092\u78ba\u8a8d\u3059\u308b\u5834\u5408\n\n```diff:/etc/apache2/apache2.conf\n<Directory /var/www/>\n        Options Indexes FollowSymLinks\n        AllowOverride All\n        Require all granted\n+       LogLevel rewrite:trace8  # trace[\u6570\u5b57] \u306e\u5024\u306f\u8abf\u7bc0\n</Directory>\n```\n\n\u53c2\u8003: [Apache HTTP \u30b5\u30fc\u30d0 \u30d0\u30fc\u30b8\u30e7\u30f3 2.4 > LogLevel](https://httpd.apache.org/docs/2.4/mod/core.html#loglevel)\n\n```sh\nservice apache2 restart\ntail -f /var/log/apache2/error.log  # \u30a8\u30e9\u30fc\u30ed\u30b0\u3092\u76e3\u8996\n```\n\n### SSI \u3092\u5229\u7528\u3059\u308b\u5834\u5408\n\n```sh\nsudo a2enmod include  # mod_include \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u6709\u52b9\u5316\n# \u2191 \u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3068\u540c\u3058\u610f\u5473\n# ln -s /etc/apache2/mods-available/include.conf /etc/apache2/mods-enabled/include.conf\n# ln -s /etc/apache2/mods-available/include.load /etc/apache2/mods-enabled/include.load\n\nservice apache2 restart\n```\n\n### SSL \u3092\u5229\u7528\u3059\u308b\u5834\u5408\n\n```sh\nsudo a2enmod ssl  # SSL \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u6709\u52b9\u5316\nsudo service apache2 restart\n```\n\n[Let's Encrypt](https://letsencrypt.jp/usage/#GetCertificate) \u3092\u5229\u7528\u3057\u305f\u5834\u5408\n\n```diff:/etc/apache2/sites-available/default-ssl.conf\n- ServerAdmin webmaster@localhost\n+ ServerAdmin <\u7ba1\u7406\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9>\n...\n- SSLCertificateFile      /etc/ssl/certs/ssl-cert-snakeoil.pem\n+ SSLCertificateFile     /etc/letsencrypt/archive/<\u30c9\u30e1\u30a4\u30f3\u540d>/fullchain1.pem\n- SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key\n+ SSLCertificateKeyFile    /etc/letsencrypt/archive/<\u30c9\u30e1\u30a4\u30f3\u540d>/privkey1.pem\n```\n\n```sh\nsudo a2ensite default-ssl.conf  # SSL\u7528\u8a2d\u5b9a\u306e\u6709\u52b9\u5316\nsudo service apache2 restart\n```\n", "tags": ["DigitalOcean", "Ubuntu", "ubuntu16.04", "lamp"]}