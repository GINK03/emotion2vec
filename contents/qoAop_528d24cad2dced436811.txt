{"context": "sqlite\u3063\u3066\u95a2\u6570\u5c11\u306a\u3044\u3067\u3059\u3088\u306d...\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\n\u3053\u3093\u306aCSV\u306a\u30d5\u30a3\u30fc\u30eb\u30c9\u30c7\u30fc\u30bf\u3092...\n\n\n\n\nkey\ncsv\n\n\n\n\nkey1\nthis,is,a,pen\n\n\nkey2\nhello,world\n\n\nkey3\nI,am,a,boy\n\n\n\n\n\u3053\u3093\u306a\u98a8\u306b\u6574\u5f62\u3057\u305f\u3044\u3093\u3067\u3059\u3002\n\n\n\n\nkey\nvalue\n\n\n\n\nkey1\nthis\n\n\nkey1\nis\n\n\nkey1\na\n\n\nkey1\npen\n\n\nkey2\nhello\n\n\nkey2\nworld\n\n\nkey3\nI\n\n\nkey3\nam\n\n\nkey3\na\n\n\nkey3\nboy\n\n\n\n\nSQL\nWITH RECURSIVE\u3063\u3066\u306e\u304c\u30df\u30bd\u3067\u3059\u306d\u3002\n-- \u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\nCREATE TABLE KV(key TEXT,val TEXT);\n\n-- \u30c7\u30fc\u30bf\u8a2d\u5b9a\nINSERT INTO KV(key,val) VALUES\n(\"key1\",\"this,is,a,pen\"),\n(\"key2\",\"hello,world\"),\n(\"key3\",\"I,am,a,boy\");\n\n-- \u30af\u30a8\u30ea\u30fc\nWITH RECURSIVE split(KEY,idx,fld,remain) AS\n  (SELECT KEY,\n          instr(val,',') AS idx,\n          substr(val,1,instr(val,',')-1) AS fld,\n          substr(val, instr(val,',')+1)||',' AS remain\n   FROM KV\n   UNION ALL SELECT KEY,\n                    instr(remain,',') AS idx,\n                    substr(remain,1,instr(remain,',')-1) AS fld,\n                    substr(remain, instr(remain,',')+1) AS remain\n   FROM split\n   WHERE remain != '' )\nSELECT KEY,\n       fld\nFROM split\nORDER BY KEY ASC;\n\n\n\u5b9f\u884c\u7d50\u679c\n\u3067\u304d\u307e\u3057\u305f\uff01\nsqlite> select * from KV;\nkey         val\n----------  -------------\nkey1        this,is,a,pen\nkey2        hello,world\nkey3        I,am,a,boy\nsqlite>\nsqlite> WITH RECURSIVE split(KEY,idx,fld,remain) AS\n   ...>   (SELECT KEY,\n   ...>           instr(val,',') AS idx,\n   ...>           substr(val,1,instr(val,',')-1) AS fld,\n   ...>           substr(val, instr(val,',')+1)||',' AS remain\n   ...>    FROM KV\n   ...>    UNION ALL SELECT KEY,\n   ...>                     instr(remain,',') AS idx,\n   ...>                     substr(remain,1,instr(remain,',')-1) AS fld,\n   ...>                     substr(remain, instr(remain,',')+1) AS remain\n   ...>    FROM split\n   ...>    WHERE remain != '' )\n   ...> SELECT KEY,\n   ...>        fld\n   ...> FROM split\n   ...> ORDER BY KEY ASC;\nKEY         fld\n----------  ----------\nkey1        this\nkey1        is\nkey1        a\nkey1        pen\nkey2        hello\nkey2        world\nkey3        I\nkey3        am\nkey3        a\nkey3        boy\nsqlite>\nsqlite>\n\n\nsqlite\u3063\u3066\u95a2\u6570\u5c11\u306a\u3044\u3067\u3059\u3088\u306d...\n\n## \u3084\u308a\u305f\u3044\u3053\u3068\n\n- \u3053\u3093\u306aCSV\u306a\u30d5\u30a3\u30fc\u30eb\u30c9\u30c7\u30fc\u30bf\u3092...\n\n|key|csv|\n|:---:|:----------|\n|key1|this,is,a,pen|\n|key2|hello,world|\n|key3|I,am,a,boy|\n\n- \u3053\u3093\u306a\u98a8\u306b\u6574\u5f62\u3057\u305f\u3044\u3093\u3067\u3059\u3002\n\n|key|value|\n|:---:|:----------|\n|key1|this|\n|key1|is|\n|key1|a|\n|key1|pen|\n|key2|hello|\n|key2|world|\n|key3|I|\n|key3|am|\n|key3|a|\n|key3|boy|\n\n## SQL\n\nWITH RECURSIVE\u3063\u3066\u306e\u304c\u30df\u30bd\u3067\u3059\u306d\u3002\n\n```SQL\n-- \u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\nCREATE TABLE KV(key TEXT,val TEXT);\n\n-- \u30c7\u30fc\u30bf\u8a2d\u5b9a\nINSERT INTO KV(key,val) VALUES\n(\"key1\",\"this,is,a,pen\"),\n(\"key2\",\"hello,world\"),\n(\"key3\",\"I,am,a,boy\");\n\n-- \u30af\u30a8\u30ea\u30fc\nWITH RECURSIVE split(KEY,idx,fld,remain) AS\n  (SELECT KEY,\n          instr(val,',') AS idx,\n          substr(val,1,instr(val,',')-1) AS fld,\n          substr(val, instr(val,',')+1)||',' AS remain\n   FROM KV\n   UNION ALL SELECT KEY,\n                    instr(remain,',') AS idx,\n                    substr(remain,1,instr(remain,',')-1) AS fld,\n                    substr(remain, instr(remain,',')+1) AS remain\n   FROM split\n   WHERE remain != '' )\nSELECT KEY,\n       fld\nFROM split\nORDER BY KEY ASC;\n```\n\n## \u5b9f\u884c\u7d50\u679c\n\n\u3067\u304d\u307e\u3057\u305f\uff01\n\n```shell\nsqlite> select * from KV;\nkey         val\n----------  -------------\nkey1        this,is,a,pen\nkey2        hello,world\nkey3        I,am,a,boy\nsqlite>\nsqlite> WITH RECURSIVE split(KEY,idx,fld,remain) AS\n   ...>   (SELECT KEY,\n   ...>           instr(val,',') AS idx,\n   ...>           substr(val,1,instr(val,',')-1) AS fld,\n   ...>           substr(val, instr(val,',')+1)||',' AS remain\n   ...>    FROM KV\n   ...>    UNION ALL SELECT KEY,\n   ...>                     instr(remain,',') AS idx,\n   ...>                     substr(remain,1,instr(remain,',')-1) AS fld,\n   ...>                     substr(remain, instr(remain,',')+1) AS remain\n   ...>    FROM split\n   ...>    WHERE remain != '' )\n   ...> SELECT KEY,\n   ...>        fld\n   ...> FROM split\n   ...> ORDER BY KEY ASC;\nKEY         fld\n----------  ----------\nkey1        this\nkey1        is\nkey1        a\nkey1        pen\nkey2        hello\nkey2        world\nkey3        I\nkey3        am\nkey3        a\nkey3        boy\nsqlite>\nsqlite>\n```\n\n", "tags": ["SQLite3"]}