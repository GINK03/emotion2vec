{"tags": ["GoogleAppsScript", "garoon", "Cybozu", "Slack", "\u521d\u5fc3\u8005"], "context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u4eca\u56de\u81ea\u5206\u304c\u4f5c\u6210\u3057\u305f\u3082\u306e\u306fGaroon API\u3092\u5229\u7528\u3057\u3066Garoon\u306b\u767b\u9332\u3057\u3066\u3042\u308b\u63b2\u793a\u677f\u306e\u6700\u65b0\u306e\u5185\u5bb9\u3092\u53d6\u5f97\u3057\u3066\u3001\u305d\u306e\u5024\u3092Slack\u306b\u306a\u3052\u308b\u3068\u3044\u3046\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u3053\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306fGoogle Apps Script\u306e\u30c8\u30ea\u30ac\u30fc\u3092\u5229\u7528\u3057\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u309230\u5206\u3054\u3068\u306b\u7e70\u308a\u8fd4\u3057\u3066\u3044\u308b\u306e\u3067\u653e\u7f6e\u3057\u3066\u3044\u3066\u3082\u52dd\u624b\u306bSlack\u306b\u6295\u3052\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u6ce8\u610f\n\u203b\u3053\u306e\u8a18\u4e8b\u3067\u306fGoogle Apps Script(\u4ee5\u4e0b\u3001GAS)\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\u203b\u3053\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u77e5\u308a\u5408\u3044\u3068\u3068\u3082\u306b\u4f5c\u6210\u3057\u305f\u3082\u306e\u3067\u3059\u3002\u4f3c\u305f\u3088\u3046\u306a\u30d7\u30ed\u30b0\u30e9\u30e0\u3092Qiita\u5185\u3067\u898b\u304b\u3051\u305f\u3089\u5bdf\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u203bXML\u306e\u77e5\u8b580\u306e\u72b6\u614b\u304b\u3089\u59cb\u3081\u305f\u306e\u3067\u304a\u304b\u3057\u3044\u90e8\u5206\u3082\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u203b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3060\u3051\u898b\u305f\u3044\u65b9\u306f\u307e\u3068\u3081\u306e\u90e8\u5206\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\u203b\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u304b\u3089\u5b9f\u884c\u3059\u308b\u304b\u3001\u30c8\u30ea\u30ac\u30fc\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u203btry~catch()\u306ecatch()\u90e8\u5206\u4ee5\u5916\u306eLogger.log()\u306f\u5024\u78ba\u8a8d\u306b\u4f7f\u7528\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u3064\u3044\u3067\u306b\u8c46\u77e5\u8b58\n\nChrome\u3092\u4f7f\u7528\u4e2d\u306bF3\u3092\u62bc\u3059\u3068\u53f3\u4e0a\u306b\u691c\u7d22\u6b04\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u51fa\u3066\u304d\u307e\u3059\u3002\u305d\u3053\u306b\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3059\u308b\u3068\u8a72\u5f53\u3059\u308b\u30ad\u30fc\u30ef\u30fc\u30c9\u304c\u8272\u4ed8\u3051\u3055\u308c\u5206\u304b\u308a\u3084\u3059\u304f\u306a\u308a\u3001\u5024\u306e\u78ba\u8a8d\u306a\u3069\u306b\u4fbf\u5229\u3067\u3059\u3002\nXML\u306eRequest\u3068Response\u3060\u3051\u3092\u8a66\u3057\u3066\u307f\u305f\u3044\u65b9\u306fChrome\u306e\u62e1\u5f35\u6a5f\u80fd\u306e\u300cAdvanced REST client\u300d\u304c\u304a\u30b9\u30b9\u30e1\u3067\u3059\u3002URL\u3068POST\u3068Payload\u3068Content-Type\u306e\u300capplication/XML\u300d\u3092\u6307\u5b9a\u3057\u3066Request\u3059\u308c\u3070\u7c21\u5358\u306bResponse\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\u500b\u4eba\u7684\u306b\u4f7f\u3063\u305f\u6a5f\u80fd\u3092\u7c21\u5358\u306b\u66f8\u304d\u307e\u3057\u305f\u3002GAS\u304c\u521d\u898b\u306e\u65b9\u306f\u3064\u3044\u3067\u306b\u898b\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\nGAS\uff08GoogleAppsScript\uff09\u3067\u4f7f\u3063\u305f\u6a5f\u80fd\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u8aac\u660e\n\n\n\n\n\u30ac\u30eb\u30fc\u30f3API\nCybouz\u682a\u5f0f\u4f1a\u793e\u306e\u300cGaroon API\u300d\u3092\u5229\u7528\u3057\u307e\u3057\u305f\u3002Garoon API\u306f\u300cGaroon\u300d\u3068\u3044\u3046\u30b0\u30eb\u30fc\u30d7\u30a6\u30a7\u30a2\u306b\u5bfe\u3057\u3066\u30e6\u30fc\u30b6\u306e\u767b\u9332\u3084\u524a\u9664\u3001\u5024\u306e\u53d6\u5f97\u7b49\u3092\u53ef\u80fd\u306b\u3057\u305f\u3082\u306e\u3067\u3001\u4eca\u56de\u306f\u63b2\u793a\u677f\u306e\u53d6\u5f97\u306e\u305f\u3081\u306b\u5229\u7528\u3057\u307e\u3057\u305f\u3002\u5229\u7528\u3059\u308b\u969b\u306e\u6ce8\u610f\u70b9\u3068\u3057\u3066Garoon API\u306f\u300cREST API\u65b9\u5f0f\u300d\u3067\u306f\u306a\u304f\u300cSOAP API\u65b9\u5f0f\u300d\u3067\u3059\u306e\u3067\u30c7\u30fc\u30bf\u306e\u9001\u4fe1\u65b9\u6cd5\u7b49\u306b\u6c17\u3092\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\u3002\n\u8a73\u3057\u304f\u306f\u3053\u308c\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nGaroon\u3068\u306f\n\n\nhttps://garoon.cybozu.co.jp/\n\n\nGaroon API\u306e\u6982\u8981\u3000(XML\u3084WSDL\u306b\u3064\u3044\u3066\u7406\u89e3\u3057\u3066\u306a\u3044\u3068\u82e6\u6226\u3059\u308b\u3068\u601d\u3044\u307e\u3059\u3002)\n\n\nhttps://cybozudev.zendesk.com/hc/ja/categories/2001577604\n\n\nSOAP API\u306e\u5171\u901a\u4ed5\u69d8\n\n\nhttps://cybozudev.zendesk.com/hc/ja/articles/202228464-SOAP-API%E3%81%AE%E5%85%B1%E9%80%9A%E4%BB%95%E6%A7%98\n\n\n\nAPI\u306e\u6982\u8981\u306b\u3082\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u304cSOAP API\u306e\u5b9a\u7fa9\u306f\u306e\u9001\u4fe1\u306e\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u304c\u305d\u308c\u305e\u308c\u4e0b\u8a18\u306eURL\u306bWSDL\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u306f\u300cGaroon on cybozu.com\u300d\u306eURL\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\nGaroon\u306eWSDL\u306b\u306fAPI\u306e\u5b9a\u7fa9\u3084NameSpace\u3001\u30b9\u30ad\u30fc\u30de\u7b49\u306b\u3064\u3044\u3066\u66f8\u304b\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u5b8c\u5168\u306b\u7406\u89e3\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u8aac\u660e\u306f\u3053\u306e\u7a0b\u5ea6\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nGaroon on cybozu.com\uff1a\n https://\uff08\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d\uff09.cybozu.com/g/index.csp?WSDL\n\u30d1\u30c3\u30b1\u30fc\u30b8\u7248 Windows \u74b0\u5883\uff1a\n http://\uff08\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u306e IP \u30a2\u30c9\u30ec\u30b9\u307e\u305f\u306f\u30db\u30b9\u30c8\u540d\uff09/scripts/\uff08\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u8b58\u5225\u5b50\uff09/grn.exe?WSDL\n\u30d1\u30c3\u30b1\u30fc\u30b8\u7248 Linux \u74b0\u5883\uff1a\n http://\uff08\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u306e IP \u30a2\u30c9\u30ec\u30b9\u307e\u305f\u306f\u30db\u30b9\u30c8\u540d\uff09/cgi-bin/\uff08\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u8b58\u5225\u5b50\uff09/grn.cgi?WSDL\n\n\n\nCybouz\u306b\u9001\u4fe1\u3059\u308bXML\u306epayload\u90e8\u5206\u3092\u4f5c\u6210\n\u6ce8\u610f\uff09\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u307e\u3068\u3081\u3067\u306f\u6700\u5f8c\u306eSlack\u306b\u6295\u3052\u308b\u30e1\u30bd\u30c3\u30c9\u306e\u624b\u524d\u306b\u8a18\u8ff0\u3057\u3066\u3044\u307e\u3059\u3002\n\u3000\u3000\u3000XML\u306e\u9001\u4fe1\u3068\u53d6\u5f97\u3092\u7406\u89e3\u3057\u3066\u3044\u306a\u3044\u3068\u4f55\u3082\u3067\u304d\u306a\u3044\u306e\u3067\u5148\u306b\u8aac\u660e\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305a\u6700\u521d\u306bXML\u30d5\u30a1\u30a4\u30eb\u306f\u5927\u307e\u304b\u306b\u3044\u3046\u3068Header\u90e8\u5206\u3068payload\u90e8\u5206\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u4eca\u56de\u306fHeader\u90e8\u5206\u306f\u8a18\u8ff0\u305b\u305aCybouz\u306b\u9001\u308bXML\u306epayload\u90e8\u5206\u306e\u307f\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\npayload\u3068\u306f\u9001\u4fe1\u3059\u308bXML\u306eBody\u306e\u3088\u3046\u306a\u3082\u306e\u3060\u3068\u601d\u3063\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u5927\u4e08\u592b\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u3067\u306f\u300cAPI\u6a5f\u80fd\u540d\u300d\u3068\u305d\u308c\u306b\u4ed8\u968f\u3059\u308b\u300cParameter\u30bf\u30b0\u300d\u3092\u4ee3\u5165\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u4f7f\u3044\u307e\u308f\u3057\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u9001\u4fe1\u65b9\u6cd5\u306e\u6307\u5b9a\u306f\u6b21\u306e\u300c\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u300d\u306e\u300cUrlFetchApp.fetch(url, options)\u300d\u3068\u3044\u3046\u30b3\u30fc\u30c9\u90e8\u5206\u3067\u8aac\u660e\u3057\u3066\u3044\u308b\u306e\u3067\u305d\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3053\u306e\u30bd\u30fc\u30b9\u306eXML\u6587\u306f'(\u30b7\u30f3\u30b0\u30eb\u30af\u30a9\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3)\u3067\u56f2\u307f\u3001+\u3067\u6b21\u306e\u884c\u306b\u7e4b\u3052\u3066\u3044\u307e\u3059\u3002\u6b63\u898f\u8868\u73fe\u306b\u3059\u308b\u305f\u3081\\ (\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5)\u53c8\u306f\uffe5\u30de\u30fc\u30af\u3092\"(\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3)\u306e\u524d\u306b\u5165\u308c\u3001\"(\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3)\u3092\u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u3066\u3044\u307e\u3059\u3002\n\ncreateXML()\n/**\n *Cybouz\u306b\u9001\u308bXML\u306epayload\u90e8\u5206\u3092\u4f5c\u6210\n *@param {payload}  payload(\u30c7\u30fc\u30bf\u672c\u4f53)\n *\n **/\n//()\u306e\u4e2d\u306b\u306f'\u4f7f\u3044\u305f\u3044API\u6a5f\u80fd\u540d'\u3068'\uff1cparameter\uff1e\u90e8\u5206'\u3092\u4ee3\u5165\u3057\u3066\u3044\u308b\u3002\nfunction createXML(API,parameters){\n    //xmlns\u7b49(Attribute)\u306e\u524d\u306b\u306f\u30b9\u30da\u30fc\u30b9or\u6539\u884c\u304c\u5fc5\u8981\u306a\u306e\u3067\u6ce8\u610f\n    var payload ='<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>'+\n'<SOAP-ENV:Envelope xmlns:SOAP-ENV=\\\"http://www.w3.org/2003/05/soap-envelope\\\"'+\n ' xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"'+\n ' xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"'+\n ' xmlns:SOAP-ENC=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\"'+\n ' xmlns:base_services=\\\"http://wsdl.cybozu.co.jp/base/2008\\\">'+\n '<SOAP-ENV:Header>'+\n  '<Action SOAP-ENV:mustUnderstand=\\\"1\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2003/03/addressing\\\">'+\n   API+\n  '</Action>'+\n  '<Security xmlns:wsu=\\\"http://schemas.xmlsoap.org/ws/2002/07/utility\\\"'+\n  'SOAP-ENV:mustUnderstand=\\\"1\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2002/12/secext\\\">'+\n   '<UsernameToken wsu:Id=\\\"id\\\">'+\n    '<Username>\u767b\u9332\u540d</Username>'+\n    '<Password>\u30d1\u30b9\u30ef\u30fc\u30c9</Password>'+\n   '</UsernameToken>'+\n  '</Security>'+\n  '<Timestamp SOAP-ENV:mustUnderstand=\\\"1\\\" Id=\\\"id\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2002/07/utility\\\">'+\n   '<Created>2010-08-12T14:45:00Z</Created>'+\n   '<Expires>2037-08-12T14:45:00Z</Expires>'+\n  '</Timestamp>'+\n  '<Locale>jp</Locale>'+\n '</SOAP-ENV:Header>'+\n '<SOAP-ENV:Body>'+\n  '<'+API+'>'+\n    parameters+\n  '</'+API+'>'+\n '</SOAP-ENV:Body>'+\n'</SOAP-ENV:Envelope>'\n\n  return payload;\n}\n\n\n\ncreateXML\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\n\u307e\u305a\u5f15\u6570\u3068\u3057\u3066'\u4f7f\u3044\u305f\u3044API\u6a5f\u80fd\u540d'\u3068'\uff1cparameter\uff1e\u90e8\u5206'\u3092\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e2\u3064\u306f\uff1cAction\uff1e\u30bf\u30b0\u3068\uff1cSOAP-ENV:Body\uff1e\u306e\u4e2d\u3067\u4f7f\u3044\u307e\u3059\u3002\u7406\u7531\u3068\u3057\u3066\u306f\u4f7f\u3044\u305f\u3044API\u6a5f\u80fd\u3054\u3068\u306b\u8a18\u8ff0\u3059\u308b\u5024\u304c\u5909\u5316\u3059\u308b\u305f\u3081\u5f15\u6570\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\uff1cUsernameToken\uff1e\u30bf\u30b0\u3068\uff1cTimestamp\uff1e\u30bf\u30b0\u3092\u5909\u66f4\u3057\u3066\u3044\u306a\u3044\u306e\u3067payload\u3067\u5909\u66f4\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u306e\u306f\u3053\u306e\uff12\u3064\u3060\u3051\u3067\u3059\u3002\n\u6642\u9593\u306e\u300c2015-10-28T01:00:21.159Z\u300d\u3068\u3044\u3046\u8868\u8a18\u306b\u3064\u3044\u3066\u306f\u6b21\u306e\u300c\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u300d\u306b\u3066\u8aac\u660e\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u4f8b\uff09\u63b2\u793a\u677f\u306e\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\u306eXML\u306e\u4e00\u90e8\u5206\n\n<Action SOAP-ENV:mustUnderstand=\"1\"\n  xmlns=\"http://schemas.xmlsoap.org/ws/2003/03/addressing\">\n   NotificationGetNotificationVersions\n</Action>\n\n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\n\n<SOAP-ENV:Body>\n  <NotificationGetNotificationVersions>\n    <parameters start=\"2015-10-28T01:00:21.159Z\" end=\"2015-10-29T13:00:21.159Z\" module_id=\"grn.bulletin\">\n      <notification_item version=\"0\">\n        <notification_id module_id=\"grn.bulletin\" item=\"-1\"/>\n      </notification_item>\n    </parameters>\n  <NotificationGetNotificationVersions>\n <SOAP-ENV:Body>\n\n\n\n\n\u63b2\u793a\u677f\u306e\u6700\u65b0\u306e\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\n\u203b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3059\u308b\u969b\u306f\u3053\u306e\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u304b\u3089\u5b9f\u884c\u3059\u308c\u3070Slack\u306b\u6295\u3052\u308b\u3068\u3053\u308d\u307e\u3067\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u3067\u306f\u6307\u5b9a\u3057\u305f\u6642\u9593\u5185\u306e\u63b2\u793a\u677fID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u6700\u521d\u306b\u73fe\u5728\u6642\u523b\u3092\u53d6\u5f97\u3057\u306630\u5206\u4ee5\u5185\u306e\u63b2\u793a\u677fID\u3092\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\nBulletinRequest()\n\n/**BulletinRequest()\n *  \u6307\u5b9a\u3057\u305f\u65e5\u6642\u5185\u306e\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\n *  NotificationGetNotificationVersions\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n *  @param {notification_items} \u914d\u5217:\u901a\u77e5id\u304c\u4e2d\u306b\u3042\u308b\n */\nfunction BulletinRequest() {\n  //\u2193\u73fe\u5728\u6642\u523b\u3092\u53d6\u5f97\u3057\u3066ISO-8601 \u62e1\u5f35\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\n  var startdate = new Date(),//\u65e5\u672c\u306e\u73fe\u5728\u65e5\u6642\u3092\u30df\u30ea\u79d2\u307e\u3067\u53d6\u5f97\n      enddate = new Date();\n  startdate.setMinutes(startdate.getMinutes()-30);//\u958b\u59cb\u65e5\u6642\u309230\u5206\u524d\u306b\u3059\u308b\n//  Logger.log('\u958b\u59cb\u65e5\u6642(\u65e5\u672c\u6642\u9593):'+startdate);\n\n  //ISO \u65e5\u4ed8\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\u2193\n  startdate = startdate.toISOString();//\u958b\u59cb\u65e5\u6642//\u4e16\u754c\u6a19\u6e96\u6642\n  enddate = enddate.toISOString();//\u7d42\u4e86\u65e5\u6642//\u4e16\u754c\u6a19\u6e96\u6642\n\n//  Logger.log('\u958b\u59cb\u65e5\u6642(ISO\u5f62\u5f0f):'+startdate);\n//  Logger.log('\u7d42\u4e86\u65e5\u6642(ISO\u5f62\u5f0f):'+enddate);\n\n  //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n  //API\u540d(\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'NotificationGetNotificationVersions';\n  //\u65e5\u6642\u6307\u5b9a,\u6a5f\u80fd\u540d(\u63b2\u793a\u677f),\u30d0\u30fc\u30b8\u30e7\u30f3\u6307\u5b9a(0=\u5168\u3066\u306e\u30d0\u30fc\u30b8\u30e7\u30f3)\u306a\u3069\u3092\u884c\u3046\n  var parameters = '<parameters start=\\\"' + startdate + '\\\" end=\\\"' + enddate + '\\\" module_id=\\\"grn.bulletin\\\">'+\n      '<notification_item version=\\\"0\\\">'+\n        '<notification_id module_id=\\\"grn.bulletin\\\" item=\\\"-1\\\"/>'+//item=-1\u306b\u3059\u308b\u3053\u3068\u3067\u5fc5\u305a\uff11\u756a\u76ee\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\n      '</notification_item>'+\n    '</parameters>';\n\n  //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n  var payload = createXML(API,parameters);\n\n  //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n  var options = {\n    \"method\": \"post\",\n    \"contextType\": \"application/soap+xml\",\n    \"muteHttpExceptions\": true,\n    \"payload\": payload\n  };\n\n  //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066notification\u90e8\u5206\u304c\u9055\u3046\n  var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/notification/api.csp?\";\n\n  try {\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n    var response = UrlFetchApp.fetch(url, options);\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n    var doc = XmlService.parse(response.getContentText());\n\n    //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,\u901a\u77e5\u306e\u914d\u5217\u3092\u53d6\u5f97\n    var notification_items = doc\n      .getRootElement()\n      .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n      .getChild('NotificationGetNotificationVersionsResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/notification/2008'))\n      .getChild('returns', XmlService.getNamespace(''))\n      .getChildren('notification_item');\n\n    //\u63b2\u793a\u677f\u306e\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306b\u914d\u5217\u3092\u9001\u308b\u3002\n    BulletinGetTopicByIds(notification_items);\n\n\n  } catch (e) {\n    Logger.log(e);\n  }\n}\n\n\n\n\nBulletinRequest\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\nGaroon\u306b\u6642\u9593\u3092\u9001\u4fe1\u3059\u308b\u969b\u306fISO\u65e5\u4ed8\u5f62\u5f0f\u3068\u3044\u3046\u3082\u306e\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u307e\u305a\u6700\u521d\u306b\u300c.toISOString()\u300d\u3092\u4f7f\u3044\u5909\u63db\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u3067\u5909\u63db\u3059\u308b\u3068\u65e5\u672c\u6642\u9593\u3060\u3063\u305f\u3082\u306e\u306fISO\u5f62\u5f0f\u3067\u4e16\u754c\u6a19\u6e96\u6642\u306b\u5909\u308f\u308a\u307e\u3059\u3002\n\u6b21\u306b\u5909\u6570API\u306b\u6a5f\u80fd\u540d\u3092\u3001\u5909\u6570parameters\u306b\u6b32\u3057\u3044\u5024\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u4f8b\uff09\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u66f4\u65b0\u901a\u77e5\u306e\u5834\u5408\n\n  //API\u540d(\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'NotificationGetNotificationVersions';\n  //\u65e5\u6642\u6307\u5b9a,\u6a5f\u80fd\u540d(\u8a72\u5f53\u3059\u308b\u540d\u524d\u3092\u8a18\u8ff0),\u30d0\u30fc\u30b8\u30e7\u30f3\u6307\u5b9a(0=\u5168\u3066\u306e\u30d0\u30fc\u30b8\u30e7\u30f3)\u306a\u3069\u3092\u884c\u3046\n  var parameters = '<parameters start=\\\"' + startdate + '\\\" end=\\\"' + enddate + '\\\" module_id=\\\"grn.message\\\">'+\n      '<notification_item version=\\\"0\\\">'+\n        '<notification_id module_id=\\\"grn.message\\\" item=\\\"34\\\"/>'+\n      '</notification_item>'+\n    '</parameters>';\n\n\n\n\u4f8b\u306e\u5834\u5408\u306fparameter\u306eversion\u6307\u5b9a\u3067\u306f\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u5165\u529b\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u53d6\u5f97\u3059\u308b\u5024\u304c\u5909\u5316\u3059\u308b\u3088\u3046\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u6b8b\u5ff5\u306a\u304c\u3089\u81ea\u5206\u306f\u7406\u89e3\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u5168\u4ef6\u53d6\u5f97\u3059\u308b\u5f62\u306b\u3057\u3066\u3044\u307e\u3059\u3002\nBulletinRequest\u30e1\u30bd\u30c3\u30c9\u306eparameter\u3057\u3066\u3044\u3067\u306fitem = -1\u3000\u3068\u3057\u3066\u3044\u307e\u3059\u304c\u3053\u308c\u3092\u3084\u308b\u3068\u5fc5\u305a\u6700\u521d\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u306e\u3067\u305d\u308c\u3092\u9664\u5916\u3057\u3066\u3044\u307e\u3059\u3002\u672c\u6765\u306a\u3089Response\u306e\u4e2d\u3067\u95a2\u4fc2\u306e\u306a\u3044\u5024\u306e\u307foperation=\"remove\"\u3068\u306a\u308b\u306e\u3067if\u6587\u3067\u9664\u5916\u3059\u3079\u304d\u3060\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u554f\u984c\u306a\u304f\u52d5\u3044\u305f\u305f\u3081\u4eca\u56de\u306fif\u6587\u3067\u306f\u9664\u5916\u3057\u3066\u304a\u308a\u307e\u305b\u3093\u3002\n\nXML\u9001\u4fe1(UrlFetchApp)\n\u5909\u6570payload\u306bcreateXML()\u306e\u8fd4\u308a\u5024\u3092\u4ee3\u5165\u3057\u3001\u5909\u6570options\u306b\u9023\u60f3\u914d\u5217\u3067\u4ee3\u5165\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u5f8c\u306b\u5909\u6570url\u306b\u81ea\u5206\u306e\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d\u304c\u5165\u3063\u305fURL\u3092\u4ee3\u5165,UrlFetchApp.fetch()\u3067\u9001\u4fe1\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306e\u8a73\u7d30\u306f\u672b\u5c3e\u306e\u300c\u305d\u306e\u4ed6\u306b\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\u300d\u3067Google\u304c\u7d39\u4ecb\u3057\u3066\u3044\u307e\u3059\u3002\n\ngetChild(),getChildren\u306b\u3064\u3044\u3066\nUrlFetchApp.fetch()\u3067\u53d6\u5f97\u3057\u305f\u5834\u5408\u306fBody\u304b\u3089\u9806\u306b\u5358\u6570\u306e\u5834\u5408\u306f.Child()\u304b\u8907\u6570\u306e\u5834\u5408\u306f.Children()\u3067\u9806\u306b\u53d6\u5f97\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\nResponse\u306e\u4f8b\u6587\u304c\u307f\u305f\u3044\u65b9\u306fResponse\u30b5\u30f3\u30d7\u30eb\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u305d\u3057\u3066\u3001\u6700\u7d42\u7684\u306b\u53d6\u5f97\u3057\u305f\u5024\u3092\u6b21\u306e\u30e1\u30bd\u30c3\u30c9\u300cBulletinGetTopicByIds()\u300d\u306b\u6e21\u3057\u307e\u3059\u3002\n\n\u63b2\u793a\u677fID\u3092\u4f7f\u3044\u8a73\u7d30\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u3067\u306f\u300cBulletinRequest()\u300d\u304b\u3089\u9001\u3089\u308c\u3066\u304d\u305f\u5024\u304b\u3089\u63b2\u793a\u677fid\u3092\u4f7f\u3044\u3001\u8a72\u5f53\u3059\u308b\u63b2\u793a\u677f\u306e\u8a73\u7d30\u60c5\u5831\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\nBulletinGetTopicById()\n\n/**\n *  \u63b2\u793a\u677f\u306e\u8a73\u7d30\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n *  @param  {name}           \u30e6\u30fc\u30b6\u540d\n *  @param  {category_name}  \u30ab\u30c6\u30b4\u30ea\u540d\n *  @param  {subject}        \u30bf\u30a4\u30c8\u30eb\u540d\n *  @param  {GaroonLink}     \u63b2\u793a\u677fURL\n */\n/**BulletinGetTopicByIds()\n *  \u6307\u5b9a\u3057\u305f\u63b2\u793a\u677fID\u3068\u4e00\u81f4\u3057\u305f\u63b2\u793a\u677f\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\n *  BulletinGetTopicByIds\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n */\nfunction BulletinGetTopicByIds(notification_items) {\n  //\u901a\u77e5id\u3068\u63b2\u793a\u677fid\u3092\u5b9a\u7fa9\n  var notification_id,\n      topic_id;\n\n  //\u901a\u77e5\u306e\u914d\u5217\u3092\u5229\u7528\u3057\u3001for\u6587\u3067topic_id\u3054\u3068\u306e\u63b2\u793a\u677f\u306e\u8a73\u7d30\u3092\u53d6\u5f97\n  //\u6700\u521d\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u306e\u30670\u3067\u306f\u306a\u304f1\u304b\u3089\n  for (var i = 1; i < notification_items.length; i++) {\n    notification_id = notification_items[i].getChild('notification_id');\n    topic_id = notification_id.getAttribute('item').getValue();\n\n//    Logger.log('topic_id(\u78ba\u8a8d):'+topic_id);\n\n    //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n    //API\u540d(\u63b2\u793a\u677f\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n    var API = 'BulletinGetTopicByIds';\n    //\u63b2\u793a\u677fid\u6307\u5b9a\u3084\u4e0b\u66f8\u304d\u304b\u3069\u3046\u304b\u5224\u5b9a(is_draft)\u306a\u3069\u3092\u884c\u3046\n    var parameters = '<parameters>'+\n        '<topics xmlns=\\\"\\\" topic_id=\\\"'+topic_id+'\\\" is_draft=\\\"false\\\"></topics>'+\n      '</parameters>';\n\n    //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n    var payload = createXML(API,parameters);\n    //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n    var options = {\n        \"method\": \"post\",\n        \"contextType\": \"application/soap+xml\",\n        \"muteHttpExceptions\": true,\n        \"payload\": payload\n    };\n    //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066bulletin\u90e8\u5206\u304c\u9055\u3046\n    var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\";\n\n    try {\n      //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n      var response = UrlFetchApp.fetch(url, options);\n      //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n      var doc = XmlService.parse(response.getContentText());\n\n      //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,\u63b2\u793a\u677f\u306eid\u3092\u53d6\u5f97\n      var bulletin = doc\n          .getRootElement()\n          .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n          .getChild('BulletinGetTopicByIdsResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/bulletin/2008'))\n          .getChild('returns', XmlService.getNamespace(''))\n          .getChild('topic');\n\n      //category_id , \u30bf\u30a4\u30c8\u30eb , \u30e6\u30fc\u30b6\u540d\u53d6\u5f97\n      var category_id = bulletin.getAttribute(\"category_id\").getValue(),\n          subject = bulletin.getAttribute(\"subject\").getValue(),\n          name = bulletin.getChild('creator',XmlService.getNamespace('http://schemas.cybozu.co.jp/bulletin/2008'))\n          .getAttribute(\"name\").getValue(),\n          //categories\u53d6\u5f97\n          categories =CategoriesRequest(),\n          category_name;\n\n      //catgory_name\u53d6\u5f97\n      for (var j = 0; j < categories.length; j++) {\n        //category_id\u304c\u4e00\u81f4\u3059\u308c\u3070category_name\u3092\u4ee3\u5165\n        if(category_id == categories[j][0]){\n          category_name = categories[j][1];\n        }\n      }\n\n//      //\u30ed\u30b0\n//      Logger.log('topic_id(\u518d\u78ba\u8a8d):'+bulletin.getAttribute(\"id\").getValue());\n//      Logger.log('\u30ab\u30c6\u30b4\u30ea:'+category_id);\n//      Logger.log('\u30ab\u30c6\u30b4\u30ea\u540d:'+category_name);\n//      Logger.log('\u30b5\u30d6\u30b8\u30a7\u30af\u30c8:'+subject);\n//      Logger.log('\u540d\u524d:'+name);\n\n      //\u53d6\u5f97\u3057\u305f\u5024\u3067\u30ea\u30f3\u30af\u7528URL\u3092\u4f5c\u6210\n      var GaroonLink = 'https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/bulletin/view.csp?cid='+category_id+'&aid='+topic_id;\n//      Logger.log('\u30ea\u30f3\u30af:'+GaroonLink);\n\n    } catch (e) {\n      Logger.log(e);\n    }\n\n       /**\n        * Slack\u306b\u30e1\u30fc\u30eb\u306e\u4e2d\u8eab\u3092\u6295\u3052\u308b\n        */\n        sendHttpPostSlack(\n          \" ```\u5dee\u51fa\u4eba:\"+ name +\"\\n\u30ab\u30c6\u30b4\u30ea:\"+category_name+\"\\n\u30bf\u30a4\u30c8\u30eb:\"+ subject +\"\\n\" + GaroonLink + \"\\n``` \",\n          \"\u3051\u3044\u3058\u3070\u3093\u3057\u3085\u3068\u304f\u3093\"); //\u5f15\u6570username\uff08\u597d\u304d\u306a\u540d\u524d\u3092\u8a18\u8ff0\uff09\n\n   }//for\u6587\u306e\u7d42\u308f\u308a\n}\n\n\n\nBulletinGetTopicByIds\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\n\u3053\u3053\u306fBulletinRequest\u30e1\u30bd\u30c3\u30c9\u3067\u3084\u3063\u305f\u3053\u3068\u3092API\u306e\u6a5f\u80fd\u306b\u5408\u308f\u305b\u3066\u66f8\u304d\u63db\u3048\u305f\u611f\u3058\u3067\u3059\u3002\u30b3\u30e1\u30f3\u30c8\u3082\u5165\u308c\u305f\u306e\u3067\u8a66\u305b\u3070\u3060\u3044\u305f\u3044\u5206\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u308c\u4ee5\u5916\u306e\u9055\u3044\u306f\u4e0b\u8a18\u306b\u8a72\u5f53\u3059\u308b\u90e8\u5206\u3067\u300cCategoriesRequest\u300d\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3044\u30ab\u30c6\u30b4\u30ea\u540d\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u306e\u3068\u3001\n//categories\u53d6\u5f97\ncategories =CategoriesRequest(),\ncategory_name;\n\n//catgory_name\u53d6\u5f97\nfor (var j = 0; j < categories.length; j++) {\n  //category_id\u304c\u4e00\u81f4\u3059\u308c\u3070category_name\u3092\u4ee3\u5165\n  if(category_id == categories[j][0]){\n    category_name = categories[j][1];\n  }\n}\n\n\u30e1\u30bd\u30c3\u30c9\u306e\u6700\u5f8c\u306b\u300csendHttpPostSlack\u300d\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3044Slack\u306b\u8868\u793a\u3059\u308b\u5185\u5bb9\u3092\u6295\u3052\u308b\u3068\u3053\u308d\u304c\u5927\u304d\u304f\u9055\u3044\u307e\u3059\u3002\n/**\n * Slack\u306b\u30e1\u30fc\u30eb\u306e\u4e2d\u8eab\u3092\u6295\u3052\u308b\n */\nsendHttpPostSlack(\n  \" ```\u5dee\u51fa\u4eba:\"+ name +\"\\n\u30ab\u30c6\u30b4\u30ea:\"+category_name+\"\\n\u30bf\u30a4\u30c8\u30eb:\"+ subject +\"\\n\" + GaroonLink + \"\\n``` \",\n \"\u3051\u3044\u3058\u3070\u3093\u3057\u3085\u3068\u304f\u3093\"); //\u5f15\u6570username\uff08\u597d\u304d\u306a\u540d\u524d\u3092\u8a18\u8ff0\uff09\n\n\n\n\u63b2\u793a\u677f\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\n\u30ab\u30c6\u30b4\u30ea\u540d\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u3060\u3051\u306b\u4f5c\u308a\u307e\u3057\u305f\u3002\u591a\u6b21\u5143\u914d\u5217\u3067\u5024\u3092\u8fd4\u3059\u306e\u3067\u914d\u5217\u3068\u9593\u9055\u3048\u306a\u3044\u3088\u3046\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\nCategoriesRequest()\n\n/**CategoriesRequest()\n *  \u63b2\u793a\u677f\u306e\u30ab\u30c6\u30b4\u30ea\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\n *  BulletinGetCategories\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n *  @param {category_id}    \u30ab\u30c6\u30b4\u30eaID\n *  @param {category_name}  \u30ab\u30c6\u30b4\u30ea\u540d\n * \n */\nfunction CategoriesRequest(){\n  //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n  //API\u540d(\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'BulletinGetCategories';\n  //\u65e5\u6642\u6307\u5b9a,\u6a5f\u80fd\u540d(\u63b2\u793a\u677f),\u30d0\u30fc\u30b8\u30e7\u30f3\u6307\u5b9a(0=\u5168\u3066\u306e\u30d0\u30fc\u30b8\u30e7\u30f3)\u306a\u3069\u3092\u884c\u3046\n  var parameters = ' ';\n\n  //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n  var payload = createXML(API,parameters);\n\n  //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n  var options = {\n    \"method\": \"post\",\n    \"contextType\": \"application/soap+xml\",\n    \"muteHttpExceptions\": true,\n    \"payload\": payload\n  };\n\n  //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066notification\u90e8\u5206\u304c\u9055\u3046\n  var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\";\n\n  try {\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n    var response = UrlFetchApp.fetch(url, options);\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n    var doc = XmlService.parse(response.getContentText());\n\n    //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,root\u3092\u53d6\u5f97\n    var root = doc\n      .getRootElement()\n      .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n      .getChild('BulletinGetCategoriesResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/bulletin/2008'))\n      .getChild('returns', XmlService.getNamespace(''))\n      .getChild('categories')\n      .getChild('root');\n\n//    Logger.log(root+\"\u30eb\u30fc\u30c8\");\n\n    //category_params\u3092\u591a\u6b21\u5143\u914d\u5217\u306b\u3057\u3066\u914d\u5217\u3092\u8ffd\u52a0\n    //\u30ab\u30c6\u30b4\u30ea\u306e\u30eb\u30fc\u30c8\u306e\u982d\u3092\u53d6\u5f97\uff08\u4ed6\u306f\u30eb\u30fc\u30c8\u306e\u4e2d\u306b\u5b58\u5728\uff09\n    var root_category = [root.getAttribute('id').getValue(),root.getChild('name').getText()],\n        category_params =[root_category];\n\n//    Logger.log(category_params[0]);\n\n    //root\u306e\u4e0b\u304b\u3089category(\u914d\u5217)\u3092\u53d6\u5f97\n    var category = root\n     .getChild('categories')\n     .getChildren('category');\n\n//    Logger.log(category);\n\n    //category_params\u306b\u5165\u308c\u308b\u5909\u6570\n    var category_id,\n        category_name;\n\n    //category_id,category_name\u3092\u914d\u5217\u306b\u3057\u3066category_params\u306b\u5165\u308c\u308b\n    for (var i = 0; i < category.length; i++) {\n      category_id = category[i].getAttribute('id').getValue();\n      category_name = category[i].getChild('name').getText();\n\n//      Logger.log('ID:'+category_id);\n//      Logger.log('NAME:'+category_name);\n\n      category_params[i+1] = [category_id,category_name];\n\n    }//for\u6587\u7d42\u308f\u308a\n\n\n//    //\u30ed\u30b0\u78ba\u8a8d\u7528for\u6587\n//    for (var i = 0; i < category_params.length; i++) {\n//        Logger.log('CATEGORY:'+category_params[i]);\n//    }\n\n\n\n  } catch (e) {\n    Logger.log(e);\n  }\n  //\u591a\u6b21\u5143\u914d\u5217\u3092\u30ea\u30bf\u30fc\u30f3\n  return category_params;\n}\n\n\n\nCategoriesRequest\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\nSlack\u306b\u5024\u3092\u6295\u3052\u305f\u6642\u306b\u5185\u5bb9\u304c\u5206\u304b\u308a\u3065\u3089\u3044\u306a\u3068\u601d\u3063\u3066\u5f8c\u304b\u3089\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\u30ab\u30c6\u30b4\u30ea\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\u969b\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u4e0d\u8981\u306a\u306e\u3067parameters\u306f\u6307\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u5f8c\u8ff0\u306e\u300cResponse\u30b5\u30f3\u30d7\u30eb\u300d\u3092\u898b\u308c\u3070\u308f\u304b\u308a\u307e\u3059\u304c\u300cBulletinGetCategories\u300d\u306fResponse\u304c\u3081\u3093\u3069\u304f\u3055\u3044\u3067\u3059\u3002\u30eb\u30fc\u30c8\u30ab\u30c6\u30b4\u30ea\u306e\u4e2d\u306b\u30ab\u30c6\u30b4\u30ea\u304c\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u4e00\u5ea6\u5148\u982d\u306e\u30eb\u30fc\u30c8\u306eID\u3068Name\u3092\u53d6\u5f97\u3057\u3066\u304b\u3089\u305d\u306e\u4e0b\u306e\u30ab\u30c6\u30b4\u30ea\u3092for\u6587\u3067\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\u591a\u6b21\u5143\u914d\u5217\u306b\u3057\u3066\u8ffd\u52a0\u3057\u3066\u3044\u308b\u306e\u3067\u53d6\u308a\u51fa\u3059\u969b\u306e\u51e6\u7406\u306b\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\nSlack\u306b\u306a\u3052\u308b\n\nsendHttpPostSlack()\n\n/**\n * \u691c\u7d22\u3067\u30d2\u30c3\u30c8\u3057\u305f\u30e1\u30fc\u30eb\u304b\u3089\u53d6\u308a\u51fa\u3057\u305f\u30c7\u30fc\u30bf\uff08message\uff09\u3068username\u3092\u5f15\u6570\u306b\u3057\n * JSON\u578b\u306b\u30ad\u30e3\u30b9\u30c8\u3057incoming webhocks\u306eurl\u306b\u30c7\u30fc\u30bf\u3092\u6295\u3052\u308b\u95a2\u6570\n *\n * @param {String} message \u63b2\u793a\u677f\u306e\u5185\u5bb9\n * @param {String} username Slack\u3067\u8868\u793a\u3055\u308c\u308bBot\u306e\u540d\u524d\n */\nfunction sendHttpPostSlack(message, username) {\n  //incoming Webhocks\u3067\u53d6\u5f97\u3057\u305furl\u3092\u8a18\u8ff0\n\u3000var postUrl_slack = \"incoming Webhocks\u3067\u53d6\u5f97\u3057\u305furl\";\n\n  //\u6295\u7a3f\u3057\u305f\u3044slack\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n  var postChannel = \"#\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\";\n\n  var jsonData = {\n    \"channel\": postChannel,\n    \"username\": username,\n    \"text\": message\n  };\n\n  var payload = JSON.stringify(jsonData);\n\n  var options = {\n    \"method\": \"post\",\n    \"contentType\": \"application/json\",\n    \"payload\": payload\n  };\n\n  UrlFetchApp.fetch(postUrl_slack, options); //incoming webhocks\u306b\u30ea\u30af\u30a8\u30b9\u30c8\n}\n\n\n\nCategoriesRequest\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\n\u4f5c\u6210\u3057\u305fmessage\u3068\u30c1\u30e3\u30f3\u30cd\u30eb\u540d,username\u3092json\u30c7\u30fc\u30bf\u306b\u5909\u63db\u3057payload\u306b\u3001options\u306b\u9001\u4fe1\u65b9\u6cd5\u3068payload\u3092\u8a2d\u5b9a\u3057\u3001Slack\u3067\u8a2d\u5b9a\u3057\u305f\u3068\u304d\u306b\u5f97\u3089\u308c\u305furl\u3068\u3068\u3082\u306bUrlFetchApp.fetch()\u3067\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002\n\u3053\u308c\u3092\u4f7f\u3046\u305f\u3081\u306b\u306fSlack\u306bincoming webhocks\u3092\u5165\u308c\u3066\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u305d\u3046\u3067\u3059\u3002\n\u3053\u306e\u8fba\u308a\u306f\u77e5\u308a\u5408\u3044\u304c\u4f5c\u6210\u3057\u305f\u90e8\u5206\u306a\u306e\u3067\u81ea\u5206\u3067\u3082100%\u306f\u7406\u89e3\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u4e00\u7dd2\u306b\u306e\u305b\u307e\u3057\u305f\u3002\n\n\u307e\u3068\u3081\n\u5168\u90e8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\n\n\u6700\u65b0\u63b2\u793a\u677f\u53d6\u5f97\u30d7\u30ed\u30b0\u30e9\u30e0\n\n//\u95a2\u6570BulletinRequest\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n//\u73fe\u5728\u306f\u30c8\u30ea\u30ac\u30fc\u309230\u5206\u3054\u3068\u306b\u8a2d\u5b9a\u3057\u3066\u307e\u3059\u3002\n//XML\u306epayload\u306e username,Password,Created,Expires\u306e\u90e8\u5206\u306f\u73fe\u5728\u306f\u5909\u6570\u306b\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n//Logger.log()\u306f\u78ba\u8a8d\u7528\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\n//\n//\n\n/**BulletinRequest()\n *  \u6307\u5b9a\u3057\u305f\u65e5\u6642\u5185\u306e\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\n *  NotificationGetNotificationVersions\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n *  @param {notification_items} \u914d\u5217:\u901a\u77e5id\u304c\u4e2d\u306b\u3042\u308b\n */\nfunction BulletinRequest() {\n  //\u2193\u73fe\u5728\u6642\u523b\u3092\u53d6\u5f97\u3057\u3066ISO-8601 \u62e1\u5f35\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\n  var startdate = new Date(),//\u65e5\u672c\u306e\u73fe\u5728\u65e5\u6642\u3092\u30df\u30ea\u79d2\u307e\u3067\u53d6\u5f97\n      enddate = new Date();\n  startdate.setMinutes(startdate.getMinutes()-30);//\u958b\u59cb\u65e5\u6642\u309230\u5206\u524d\u306b\u3059\u308b\n//  Logger.log('\u958b\u59cb\u65e5\u6642(\u65e5\u672c\u6642\u9593):'+startdate);\n\n  //ISO \u65e5\u4ed8\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\u2193\n  startdate = startdate.toISOString();//\u958b\u59cb\u65e5\u6642//\u4e16\u754c\u6a19\u6e96\u6642\n  enddate = enddate.toISOString();//\u7d42\u4e86\u65e5\u6642//\u4e16\u754c\u6a19\u6e96\u6642\n\n//  Logger.log('\u958b\u59cb\u65e5\u6642(ISO\u5f62\u5f0f):'+startdate);\n//  Logger.log('\u7d42\u4e86\u65e5\u6642(ISO\u5f62\u5f0f):'+enddate);\n\n  //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n  //API\u540d(\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'NotificationGetNotificationVersions';\n  //\u65e5\u6642\u6307\u5b9a,\u6a5f\u80fd\u540d(\u63b2\u793a\u677f),\u30d0\u30fc\u30b8\u30e7\u30f3\u6307\u5b9a(0=\u5168\u3066\u306e\u30d0\u30fc\u30b8\u30e7\u30f3)\u306a\u3069\u3092\u884c\u3046\n  var parameters = '<parameters start=\\\"' + startdate + '\\\" end=\\\"' + enddate + '\\\" module_id=\\\"grn.bulletin\\\">'+\n      '<notification_item version=\\\"0\\\">'+\n        '<notification_id module_id=\\\"grn.bulletin\\\" item=\\\"-1\\\"/>'+//item=-1\u306b\u3059\u308b\u3053\u3068\u3067\u5fc5\u305a\uff11\u756a\u76ee\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\n      '</notification_item>'+\n    '</parameters>';\n\n  //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n  var payload = createXML(API,parameters);\n\n  //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n  var options = {\n    \"method\": \"post\",\n    \"contextType\": \"application/soap+xml\",\n    \"muteHttpExceptions\": true,\n    \"payload\": payload\n  };\n\n  //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066notification\u90e8\u5206\u304c\u9055\u3046\n  var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/notification/api.csp?\";\n\n  try {\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n    var response = UrlFetchApp.fetch(url, options);\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n    var doc = XmlService.parse(response.getContentText());\n\n    //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,\u901a\u77e5\u306e\u914d\u5217\u3092\u53d6\u5f97\n    var notification_items = doc\n      .getRootElement()\n      .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n      .getChild('NotificationGetNotificationVersionsResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/notification/2008'))\n      .getChild('returns', XmlService.getNamespace(''))\n      .getChildren('notification_item');\n\n    //\u63b2\u793a\u677f\u306e\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306b\u914d\u5217\u3092\u9001\u308b\u3002\n    BulletinGetTopicByIds(notification_items);\n\n\n  } catch (e) {\n    Logger.log(e);\n  }\n}\n\n\n/**\n *  \u63b2\u793a\u677f\u306e\u8a73\u7d30\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n *  @param  {name}           \u30e6\u30fc\u30b6\u540d\n *  @param  {category_name}  \u30ab\u30c6\u30b4\u30ea\u540d\n *  @param  {subject}        \u30bf\u30a4\u30c8\u30eb\u540d\n *  @param  {GaroonLink}     \u63b2\u793a\u677fURL\n */\n/**BulletinGetTopicByIds()\n *  \u6307\u5b9a\u3057\u305f\u63b2\u793a\u677fID\u3068\u4e00\u81f4\u3057\u305f\u63b2\u793a\u677f\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\n *  BulletinGetTopicByIds\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n */\nfunction BulletinGetTopicByIds(notification_items) {\n  //\u901a\u77e5id\u3068\u63b2\u793a\u677fid\u3092\u5b9a\u7fa9\n  var notification_id,\n      topic_id;\n\n  //\u901a\u77e5\u306e\u914d\u5217\u3092\u5229\u7528\u3057\u3001for\u6587\u3067topic_id\u3054\u3068\u306e\u63b2\u793a\u677f\u306e\u8a73\u7d30\u3092\u53d6\u5f97\n  //\u6700\u521d\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u306e\u30670\u3067\u306f\u306a\u304f1\u304b\u3089\n  for (var i = 1; i < notification_items.length; i++) {\n    notification_id = notification_items[i].getChild('notification_id');\n    topic_id = notification_id.getAttribute('item').getValue();\n\n//    Logger.log('topic_id(\u78ba\u8a8d):'+topic_id);\n\n    //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n    //API\u540d(\u63b2\u793a\u677f\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n    var API = 'BulletinGetTopicByIds';\n    //\u63b2\u793a\u677fid\u6307\u5b9a\u3084\u4e0b\u66f8\u304d\u304b\u3069\u3046\u304b\u5224\u5b9a(is_draft)\u306a\u3069\u3092\u884c\u3046\n    var parameters = '<parameters>'+\n        '<topics xmlns=\\\"\\\" topic_id=\\\"'+topic_id+'\\\" is_draft=\\\"false\\\"></topics>'+\n      '</parameters>';\n\n    //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n    var payload = createXML(API,parameters);\n    //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n    var options = {\n        \"method\": \"post\",\n        \"contextType\": \"application/soap+xml\",\n        \"muteHttpExceptions\": true,\n        \"payload\": payload\n    };\n    //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066bulletin\u90e8\u5206\u304c\u9055\u3046\n    var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\";\n\n    try {\n      //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n      var response = UrlFetchApp.fetch(url, options);\n      //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n      var doc = XmlService.parse(response.getContentText());\n\n      //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,\u63b2\u793a\u677f\u306eid\u3092\u53d6\u5f97\n      var bulletin = doc\n          .getRootElement()\n          .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n          .getChild('BulletinGetTopicByIdsResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/bulletin/2008'))\n          .getChild('returns', XmlService.getNamespace(''))\n          .getChild('topic');\n\n      //category_id , \u30bf\u30a4\u30c8\u30eb , \u30e6\u30fc\u30b6\u540d\u53d6\u5f97\n      var category_id = bulletin.getAttribute(\"category_id\").getValue(),\n          subject = bulletin.getAttribute(\"subject\").getValue(),\n          name = bulletin.getChild('creator',XmlService.getNamespace('http://schemas.cybozu.co.jp/bulletin/2008'))\n          .getAttribute(\"name\").getValue(),\n          //categories\u53d6\u5f97\n          categories =CategoriesRequest(),\n          category_name;\n\n      //catgory_name\u53d6\u5f97\n      for (var j = 0; j < categories.length; j++) {\n        //category_id\u304c\u4e00\u81f4\u3059\u308c\u3070category_name\u3092\u4ee3\u5165\n        if(category_id == categories[j][0]){\n          category_name = categories[j][1];\n        }\n      }\n\n//      //\u30ed\u30b0\n//      Logger.log('topic_id(\u518d\u78ba\u8a8d):'+bulletin.getAttribute(\"id\").getValue());\n//      Logger.log('\u30ab\u30c6\u30b4\u30ea:'+category_id);\n//      Logger.log('\u30ab\u30c6\u30b4\u30ea\u540d:'+category_name);\n//      Logger.log('\u30b5\u30d6\u30b8\u30a7\u30af\u30c8:'+subject);\n//      Logger.log('\u540d\u524d:'+name);\n\n      //\u53d6\u5f97\u3057\u305f\u5024\u3067\u30ea\u30f3\u30af\u7528URL\u3092\u4f5c\u6210\n      var GaroonLink = 'https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/bulletin/view.csp?cid='+category_id+'&aid='+topic_id;\n//      Logger.log('\u30ea\u30f3\u30af:'+GaroonLink);\n\n    } catch (e) {\n      Logger.log(e);\n    }\n\n       /**\n        * Slack\u306b\u30e1\u30fc\u30eb\u306e\u4e2d\u8eab\u3092\u6295\u3052\u308b\n        */\n        sendHttpPostSlack(\n          \" ```\u5dee\u51fa\u4eba:\"+ name +\"\\n\u30ab\u30c6\u30b4\u30ea:\"+category_name+\"\\n\u30bf\u30a4\u30c8\u30eb:\"+ subject +\"\\n\" + GaroonLink + \"\\n``` \",\n          \"\u3051\u3044\u3058\u3070\u3093\u3057\u3085\u3068\u304f\u3093\"); //\u5f15\u6570username\uff08\u597d\u304d\u306a\u540d\u524d\u3092\u8a18\u8ff0\uff09\n\n   }//for\u6587\u306e\u7d42\u308f\u308a\n}\n\n\n\n\n/**CategoriesRequest()\n *  \u63b2\u793a\u677f\u306e\u30ab\u30c6\u30b4\u30ea\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\n *  BulletinGetCategories\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n *  @param {category_id}    \u30ab\u30c6\u30b4\u30eaID\n *  @param {category_name}  \u30ab\u30c6\u30b4\u30ea\u540d\n * \n */\nfunction CategoriesRequest(){\n  //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n  //API\u540d(\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'BulletinGetCategories';\n  //BulletinGetCategories\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u306eparameter\u306f\u4e0d\u8981\n  var parameters = ' ';\n\n  //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n  var payload = createXML(API,parameters);\n\n  //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n  var options = {\n    \"method\": \"post\",\n    \"contextType\": \"application/soap+xml\",\n    \"muteHttpExceptions\": true,\n    \"payload\": payload\n  };\n\n  //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066bulletin\u90e8\u5206\u304c\u9055\u3046\n  var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\";\n\n  try {\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n    var response = UrlFetchApp.fetch(url, options);\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n    var doc = XmlService.parse(response.getContentText());\n\n    //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,root\u3092\u53d6\u5f97\n    var root = doc\n      .getRootElement()\n      .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n      .getChild('BulletinGetCategoriesResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/bulletin/2008'))\n      .getChild('returns', XmlService.getNamespace(''))\n      .getChild('categories')\n      .getChild('root');\n\n//    Logger.log(root+\"\u30eb\u30fc\u30c8\");\n\n    //category_params\u3092\u591a\u6b21\u5143\u914d\u5217\u306b\u3057\u3066\u914d\u5217\u3092\u8ffd\u52a0\n    //\u30ab\u30c6\u30b4\u30ea\u306e\u30eb\u30fc\u30c8\u306e\u982d\u3092\u53d6\u5f97\uff08\u4ed6\u306f\u30eb\u30fc\u30c8\u306e\u4e2d\u306b\u5b58\u5728\uff09\n    var root_category = [root.getAttribute('id').getValue(),root.getChild('name').getText()],\n        category_params =[root_category];\n\n//    Logger.log(category_params[0]);\n\n    //root\u306e\u4e0b\u304b\u3089category(\u914d\u5217)\u3092\u53d6\u5f97\n    var category = root\n     .getChild('categories')\n     .getChildren('category');\n\n//    Logger.log(category);\n\n    //category_params\u306b\u5165\u308c\u308b\u5909\u6570\n    var category_id,\n        category_name;\n\n    //category_id,category_name\u3092\u914d\u5217\u306b\u3057\u3066category_params\u306b\u5165\u308c\u308b\n    for (var i = 0; i < category.length; i++) {\n      category_id = category[i].getAttribute('id').getValue();\n      category_name = category[i].getChild('name').getText();\n\n//      Logger.log('ID:'+category_id);\n//      Logger.log('NAME:'+category_name);\n\n      category_params[i+1] = [category_id,category_name];\n\n    }//for\u6587\u7d42\u308f\u308a\n\n\n//    //\u30ed\u30b0\u78ba\u8a8d\u7528for\u6587\n//    for (var i = 0; i < category_params.length; i++) {\n//        Logger.log('CATEGORY:'+category_params[i]);\n//    }\n\n\n\n  } catch (e) {\n    Logger.log(e);\n  }\n  //\u591a\u6b21\u5143\u914d\u5217\u3092\u30ea\u30bf\u30fc\u30f3\n  return category_params;\n}\n\n\n\n\n\n\n\n/**\n *Cybouz\u306b\u9001\u308bXML\u306epayload\u90e8\u5206\u3092\u4f5c\u6210\n *@param {payload}  payload(\u30c7\u30fc\u30bf\u672c\u4f53)\n *\n **/\nfunction createXML(API,parameters){\n    //xmlns\u306e\u524d\u306b\u306f\u30b9\u30da\u30fc\u30b9or\u6539\u884c\u304c\u5fc5\u8981\u306a\u306e\u3067\u6ce8\u610f\n    var payload ='<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>'+\n'<SOAP-ENV:Envelope xmlns:SOAP-ENV=\\\"http://www.w3.org/2003/05/soap-envelope\\\"'+\n ' xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"'+\n ' xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"'+\n ' xmlns:SOAP-ENC=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\"'+\n ' xmlns:base_services=\\\"http://wsdl.cybozu.co.jp/base/2008\\\">'+\n '<SOAP-ENV:Header>'+\n  '<Action SOAP-ENV:mustUnderstand=\\\"1\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2003/03/addressing\\\">'+\n   API+\n  '</Action>'+\n  '<Security xmlns:wsu=\\\"http://schemas.xmlsoap.org/ws/2002/07/utility\\\"'+\n  'SOAP-ENV:mustUnderstand=\\\"1\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2002/12/secext\\\">'+\n   '<UsernameToken wsu:Id=\\\"id\\\">'+\n    '<Username>UserName</Username>'+\n    '<Password>Password</Password>'+\n   '</UsernameToken>'+\n  '</Security>'+\n  '<Timestamp SOAP-ENV:mustUnderstand=\\\"1\\\" Id=\\\"id\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2002/07/utility\\\">'+\n   '<Created>2010-08-12T14:45:00Z</Created>'+\n   '<Expires>2037-08-12T14:45:00Z</Expires>'+\n  '</Timestamp>'+\n  '<Locale>jp</Locale>'+\n '</SOAP-ENV:Header>'+\n '<SOAP-ENV:Body>'+\n  '<'+API+'>'+\n    parameters+\n  '</'+API+'>'+\n '</SOAP-ENV:Body>'+\n'</SOAP-ENV:Envelope>'\n\n  return payload;\n}\n\n\n/**\n * \u691c\u7d22\u3067\u30d2\u30c3\u30c8\u3057\u305f\u30e1\u30fc\u30eb\u304b\u3089\u53d6\u308a\u51fa\u3057\u305f\u30c7\u30fc\u30bf\uff08message\uff09\u3068username\u3092\u5f15\u6570\u306b\u3057\n * JSON\u578b\u306b\u30ad\u30e3\u30b9\u30c8\u3057incoming webhocks\u306eurl\u306b\u30c7\u30fc\u30bf\u3092\u6295\u3052\u308b\u95a2\u6570\n *\n * @param {String} message \u63b2\u793a\u677f\u306e\u5185\u5bb9\n * @param {String} username Slack\u3067\u8868\u793a\u3055\u308c\u308bBot\u306e\u540d\u524d\n */\nfunction sendHttpPostSlack(message, username) {\n  //incoming Webhocks\u3067\u53d6\u5f97\u3057\u305furl\u3092\u8a18\u8ff0\n\u3000var postUrl_slack = \"incoming Webhocks\u3067\u53d6\u5f97\u3057\u305furl\";\n\n  //\u6295\u7a3f\u3057\u305f\u3044slack\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n  var postChannel = \"#\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\";\n\n  var jsonData = {\n    \"channel\": postChannel,\n    \"username\": username,\n    \"text\": message\n  };\n\n  var payload = JSON.stringify(jsonData);\n\n  var options = {\n    \"method\": \"post\",\n    \"contentType\": \"application/json\",\n    \"payload\": payload\n  };\n\n  UrlFetchApp.fetch(postUrl_slack, options); //incoming webhocks\u306b\u30ea\u30af\u30a8\u30b9\u30c8\n}\n\n\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u4ee5\u4e0a\u3067\u3059\u3002\n\n\u4f5c\u3063\u3066\u307f\u3066\n\u4eca\u56de\u59cb\u3081\u305f\u5f53\u521d\u306f\u4e3b\u306a\u77e5\u8b58\u304cJava\u3060\u3051\u306e\u72b6\u614b\u3067\u56db\u82e6\u516b\u82e6\u3057\u306a\u304c\u3089\u4f5c\u6210\u3057\u3066\u3044\u307e\u3057\u305f\u3002XML\u3084\u30ac\u30eb\u30fc\u30f3API\u306b\u3064\u3044\u3066\u8abf\u3079\u306a\u304c\u3089\u3084\u308a\u307e\u3057\u305f\u304c\u300c\u30ac\u30eb\u30fc\u30f3API\u306e\u6982\u8981\u300d\u3084\u300cSOAP API\u306e\u5171\u901a\u4ed5\u69d8\u300d\u306e\u30b5\u30a4\u30c8\u3092\u898b\u3066\u3082\u4f55\u304c\u4f55\u3060\u304b\u308f\u304b\u3089\u305a\u4e00\u9031\u9593\u307b\u3069XML\u306e\u9001\u4fe1\u65b9\u6cd5\u3092\u4e2d\u5fc3\u306b\u8272\u3005\u3068\u8abf\u3079\u3066\u3044\u307e\u3057\u305f\u3002XML\u306e\u9001\u4fe1\u65b9\u6cd5\u3055\u3048\u5206\u304b\u308c\u3070\u9001\u4fe1\u3057\u305f\u5024\u3092\u53d6\u5f97\u3057\u3066Slack\u306b\u307e\u305f\u9001\u308b\u3060\u3051\u3067\u3057\u305f\u306e\u3067\u6bd4\u8f03\u7684\u5bb9\u6613\u306b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u305f\u611f\u3058\u3067\u3059\u306d\u3002\n\u3084\u3063\u3066\u307f\u3066\u601d\u3063\u305f\u306e\u306f\u81ea\u5206\u306e\u4e2d\u3067\u4e00\u756a\u306e\u9b3c\u9580\u3060\u3063\u305fXML\u306e\u9001\u4fe1\u3068\u53d6\u5f97\u3055\u3048\u51fa\u6765\u308c\u3070\u5f8c\u306f\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u304b\u3058\u3063\u305f\u4e8b\u306e\u3042\u308b\u4eba\u306a\u3089\u8ab0\u3067\u3082\u7c21\u5358\u306b\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u3048\u308b\u306f\u305a\u3067\u3059\u3002\u30ac\u30eb\u30fc\u30f3API\u3092\u7d39\u4ecb\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u306f\u5c11\u306a\u3044\u306e\u3067\u3053\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u898b\u3066\u304f\u3060\u3055\u3063\u305f\u65b9\u304c\u65b0\u305f\u306b\u4f7f\u3044\u59cb\u3081\u3066\u304f\u3060\u3055\u308c\u3070\u6bb5\u3005\u3068\u5e83\u304c\u3063\u3066\u3044\u304f\u3093\u3058\u3083\u306a\u3044\u304b\u306a\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\u86c7\u8db3\u3067\u3059\u304c\u2026\n\u3053\u308c\u3088\u308a\u4e0b\u306f\u30ab\u30c6\u30b4\u30ea\u4e00\u89a7\u306eRequest\u30b5\u30f3\u30d7\u30eb\u3068Response\u30b5\u30f3\u30d7\u30eb\u3068\u305d\u306e\u4ed6\u306e\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u30b5\u30a4\u30c8\u306b\u3064\u3044\u3066\u3067\u3059\u3002\u8208\u5473\u304c\u3042\u3063\u305f\u3089\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\nRequest\u30b5\u30f3\u30d7\u30eb\n\u203b\u4e0b\u306eURL\u306ebulletin\u306e\u90e8\u5206\u306f\u81ea\u5206\u304c\u4f7f\u3044\u305f\u3044API\u306e\u6a5f\u80fd\u540d\nhttps://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\nPOST\nContent-Type \u306f application/XML\n\n\u4f8b\uff09\u30ab\u30c6\u30b4\u30ea\u4e00\u89a7request\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://www.w3.org/2003/05/soap-envelope\"\n xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"\n xmlns:base_services=\"http://wsdl.cybozu.co.jp/base/2008\">\n  <SOAP-ENV:Header>\n    <Action SOAP-ENV:mustUnderstand=\"1\"\n     xmlns=\"http://schemas.xmlsoap.org/ws/2003/03/addressing\">\n      BulletinGetCategories\n    </Action>\n    <Security xmlns:wsu=\"http://schemas.xmlsoap.org/ws/2002/07/utility\"\n     SOAP-ENV:mustUnderstand=\"1\"\n     xmlns=\"http://schemas.xmlsoap.org/ws/2002/12/secext\">\n      <UsernameToken wsu:Id=\"id\">\n        <Username>UserName</Username>\n        <Password>Password</Password>\n      </UsernameToken>\n    </Security>\n    <Timestamp SOAP-ENV:mustUnderstand=\"1\" Id=\"id\"\n     xmlns=\"http://schemas.xmlsoap.org/ws/2002/07/utility\">\n      <Created>2010-08-12T14:45:00Z</Created>\n      <Expires>2030-08-12T14:45:00Z</Expires>\n    </Timestamp>\n    <Locale>jp</Locale>\n  </SOAP-ENV:Header>\n  <SOAP-ENV:Body>\n    <BulletinGetCategories>\n    </BulletinGetCategories>\n  </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>\n\n\n\nResponse\u30b5\u30f3\u30d7\u30eb\n\n\u4f8b\uff09\u30ab\u30c6\u30b4\u30ea\u4e00\u89a7Response\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<soap:Envelope>\n <soap:Header>\n  <vendor>Cybozu</vendor>\n  <product>Garoon</product>\n  <product_type>2</product_type>\n  <version>4.2.0</version>\n  <apiversion>1.6.0</apiversion>\n </soap:Header>\n <soap:Body>\n  <bulletin:BulletinGetCategoriesResponse>\n   <returns>\n    <categories>\n     <root id=\"1\" code=\"ROOT_CATEGORY\">\n      <name>ABCBBS</name>\n      <description />\n      <creator_id />\n      <creator_login_name />\n      <creator_display_name>Administrator</creator_display_name>\n      <create_time>2015-02-13T16:31:26+0900</create_time>\n      <modifier_id>2</modifier_id>\n      <modifier_login_name>UserName</modifier_login_name>\n      <modifier_display_name>UserName</modifier_display_name>\n      <modify_time>2015-06-16T09:48:02+0900</modify_time>\n      <categories parent_id=\"1\" parent_code=\"ROOT_CATEGORY\">\n       <category id=\"2\" code=\"557f706728fa62.97945938\" list_index=\"2147483647\">\n        <name>\u52e4\u6020\u95a2\u9023</name>\n        <description />\n        <creator_id>2</creator_id>\n        <creator_login_name>UserName</creator_login_name>\n        <creator_display_name>UserName</creator_display_name>\n        <create_time>2015-06-16T09:40:26+0900</create_time>\n        <modifier_id>2</modifier_id>\n        <modifier_login_name>UserName</modifier_login_name>\n        <modifier_display_name>UserName</modifier_display_name>\n        <modify_time>2015-06-16T09:40:26+0900</modify_time>\n       </category>\n       <category id=\"3\" code=\"557f707d39b4a4.08727840\" list_index=\"2147483647\">\n        <name>News\u30fb\u60c5\u5831\u9023\u643a\u7b49</name>\n        <description />\n        <creator_id>2</creator_id>\n        <creator_login_name>UserName</creator_login_name>\n        <creator_display_name>UserName</creator_display_name>\n        <create_time>2015-06-16T09:41:24+0900</create_time>\n        <modifier_id>2</modifier_id>\n        <modifier_login_name>UserName</modifier_login_name>\n        <modifier_display_name>UserName</modifier_display_name>\n        <modify_time>2015-06-16T09:42:21+0900</modify_time>\n       </category>\n      </categories>\n     </root>\n    </categories>\n   </returns>\n  </bulletin:BulletinGetCategoriesResponse>\n </soap:Body>\n</soap:Envelope>\n\n\n\n\u4e0a\u8a18\u306e\u5834\u5408\u3067\u300ccategory\u300d\u3092\u53d6\u5f97\u3059\u308b\u969b\u306b.getChildren()\u3092\u4f7f\u3046\u3068\u914d\u5217\u3067\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\u52e4\u6020\u95a2\u9023category\u306e\u4e2d\u306e\u300cid\u300d\u3084\u300cname\u300d\u3092\u53d6\u5f97\u3059\u308b\u969b\u306f\u305d\u308c\u305e\u308c\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n      category_id = category[0].getAttribute('id').getValue();\n      category_name = category[0].getChild('name').getText();\n\n\n\u305d\u306e\u4ed6\u306b\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\n\nGoogle Developers UrlFetchApp\n\n\nhttps://developers.google.com/apps-script/reference/url-fetch/url-fetch-app#fetch(String,Object)\n\n\nGoogle Developers XmlService\n\n\nhttps://developers.google.com/apps-script/reference/xml-service/xml-service\n\n\n\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u65b9\u306eGitHub\n\n\n\nhttps://gist.github.com/hagino3000/1145727 \n\n\n\n#\u306f\u3058\u3081\u306b\n\n\u4eca\u56de\u81ea\u5206\u304c\u4f5c\u6210\u3057\u305f\u3082\u306e\u306fGaroon API\u3092\u5229\u7528\u3057\u3066Garoon\u306b\u767b\u9332\u3057\u3066\u3042\u308b\u63b2\u793a\u677f\u306e\u6700\u65b0\u306e\u5185\u5bb9\u3092\u53d6\u5f97\u3057\u3066\u3001\u305d\u306e\u5024\u3092Slack\u306b\u306a\u3052\u308b\u3068\u3044\u3046\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u3053\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306fGoogle Apps Script\u306e\u30c8\u30ea\u30ac\u30fc\u3092\u5229\u7528\u3057\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u309230\u5206\u3054\u3068\u306b\u7e70\u308a\u8fd4\u3057\u3066\u3044\u308b\u306e\u3067\u653e\u7f6e\u3057\u3066\u3044\u3066\u3082\u52dd\u624b\u306bSlack\u306b\u6295\u3052\u3066\u304f\u308c\u307e\u3059\u3002\n\n##\u6ce8\u610f\n\u203b\u3053\u306e\u8a18\u4e8b\u3067\u306fGoogle Apps Script(\u4ee5\u4e0b\u3001GAS)\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\n\u203b\u3053\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u77e5\u308a\u5408\u3044\u3068\u3068\u3082\u306b\u4f5c\u6210\u3057\u305f\u3082\u306e\u3067\u3059\u3002\u4f3c\u305f\u3088\u3046\u306a\u30d7\u30ed\u30b0\u30e9\u30e0\u3092Qiita\u5185\u3067\u898b\u304b\u3051\u305f\u3089\u5bdf\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u203bXML\u306e\u77e5\u8b580\u306e\u72b6\u614b\u304b\u3089\u59cb\u3081\u305f\u306e\u3067\u304a\u304b\u3057\u3044\u90e8\u5206\u3082\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u203b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3060\u3051\u898b\u305f\u3044\u65b9\u306f\u307e\u3068\u3081\u306e\u90e8\u5206\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\u203b\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u304b\u3089\u5b9f\u884c\u3059\u308b\u304b\u3001\u30c8\u30ea\u30ac\u30fc\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u203btry~catch()\u306ecatch()\u90e8\u5206\u4ee5\u5916\u306eLogger.log()\u306f\u5024\u78ba\u8a8d\u306b\u4f7f\u7528\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\n\n##\u3064\u3044\u3067\u306b\u8c46\u77e5\u8b58\n - Chrome\u3092\u4f7f\u7528\u4e2d\u306bF3\u3092\u62bc\u3059\u3068\u53f3\u4e0a\u306b\u691c\u7d22\u6b04\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u51fa\u3066\u304d\u307e\u3059\u3002\u305d\u3053\u306b\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3059\u308b\u3068\u8a72\u5f53\u3059\u308b\u30ad\u30fc\u30ef\u30fc\u30c9\u304c\u8272\u4ed8\u3051\u3055\u308c\u5206\u304b\u308a\u3084\u3059\u304f\u306a\u308a\u3001\u5024\u306e\u78ba\u8a8d\u306a\u3069\u306b\u4fbf\u5229\u3067\u3059\u3002\n - XML\u306eRequest\u3068Response\u3060\u3051\u3092\u8a66\u3057\u3066\u307f\u305f\u3044\u65b9\u306fChrome\u306e\u62e1\u5f35\u6a5f\u80fd\u306e\u300cAdvanced REST client\u300d\u304c\u304a\u30b9\u30b9\u30e1\u3067\u3059\u3002URL\u3068POST\u3068Payload\u3068Content-Type\u306e\u300capplication/XML\u300d\u3092\u6307\u5b9a\u3057\u3066Request\u3059\u308c\u3070\u7c21\u5358\u306bResponse\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n - \u500b\u4eba\u7684\u306b\u4f7f\u3063\u305f\u6a5f\u80fd\u3092\u7c21\u5358\u306b\u66f8\u304d\u307e\u3057\u305f\u3002GAS\u304c\u521d\u898b\u306e\u65b9\u306f\u3064\u3044\u3067\u306b\u898b\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n  - [GAS\uff08GoogleAppsScript\uff09\u3067\u4f7f\u3063\u305f\u6a5f\u80fd\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u8aac\u660e](http://qiita.com/y-ebihara/items/e10ebfe9d1a4842f2e90)\n\n\n\n##\u30ac\u30eb\u30fc\u30f3API\nCybouz\u682a\u5f0f\u4f1a\u793e\u306e\u300cGaroon API\u300d\u3092\u5229\u7528\u3057\u307e\u3057\u305f\u3002Garoon API\u306f\u300cGaroon\u300d\u3068\u3044\u3046\u30b0\u30eb\u30fc\u30d7\u30a6\u30a7\u30a2\u306b\u5bfe\u3057\u3066\u30e6\u30fc\u30b6\u306e\u767b\u9332\u3084\u524a\u9664\u3001\u5024\u306e\u53d6\u5f97\u7b49\u3092\u53ef\u80fd\u306b\u3057\u305f\u3082\u306e\u3067\u3001\u4eca\u56de\u306f\u63b2\u793a\u677f\u306e\u53d6\u5f97\u306e\u305f\u3081\u306b\u5229\u7528\u3057\u307e\u3057\u305f\u3002\u5229\u7528\u3059\u308b\u969b\u306e\u6ce8\u610f\u70b9\u3068\u3057\u3066Garoon API\u306f\u300cREST API\u65b9\u5f0f\u300d\u3067\u306f\u306a\u304f\u300cSOAP API\u65b9\u5f0f\u300d\u3067\u3059\u306e\u3067\u30c7\u30fc\u30bf\u306e\u9001\u4fe1\u65b9\u6cd5\u7b49\u306b\u6c17\u3092\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\u3002\n\u8a73\u3057\u304f\u306f\u3053\u308c\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- Garoon\u3068\u306f\n - https://garoon.cybozu.co.jp/\n- Garoon API\u306e\u6982\u8981\u3000(XML\u3084WSDL\u306b\u3064\u3044\u3066\u7406\u89e3\u3057\u3066\u306a\u3044\u3068\u82e6\u6226\u3059\u308b\u3068\u601d\u3044\u307e\u3059\u3002)\n - https://cybozudev.zendesk.com/hc/ja/categories/2001577604\n- SOAP API\u306e\u5171\u901a\u4ed5\u69d8\n - https://cybozudev.zendesk.com/hc/ja/articles/202228464-SOAP-API%E3%81%AE%E5%85%B1%E9%80%9A%E4%BB%95%E6%A7%98\n\nAPI\u306e\u6982\u8981\u306b\u3082\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u304cSOAP API\u306e\u5b9a\u7fa9\u306f\u306e\u9001\u4fe1\u306e\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u304c\u305d\u308c\u305e\u308c\u4e0b\u8a18\u306eURL\u306bWSDL\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u306f\u300cGaroon on cybozu.com\u300d\u306eURL\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\nGaroon\u306eWSDL\u306b\u306fAPI\u306e\u5b9a\u7fa9\u3084NameSpace\u3001\u30b9\u30ad\u30fc\u30de\u7b49\u306b\u3064\u3044\u3066\u66f8\u304b\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u5b8c\u5168\u306b\u7406\u89e3\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u8aac\u660e\u306f\u3053\u306e\u7a0b\u5ea6\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\nGaroon on cybozu.com\uff1a\n https://\uff08\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d\uff09.cybozu.com/g/index.csp?WSDL\n\u30d1\u30c3\u30b1\u30fc\u30b8\u7248 Windows \u74b0\u5883\uff1a\n http://\uff08\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u306e IP \u30a2\u30c9\u30ec\u30b9\u307e\u305f\u306f\u30db\u30b9\u30c8\u540d\uff09/scripts/\uff08\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u8b58\u5225\u5b50\uff09/grn.exe?WSDL\n\u30d1\u30c3\u30b1\u30fc\u30b8\u7248 Linux \u74b0\u5883\uff1a\n http://\uff08\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u306e IP \u30a2\u30c9\u30ec\u30b9\u307e\u305f\u306f\u30db\u30b9\u30c8\u540d\uff09/cgi-bin/\uff08\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u8b58\u5225\u5b50\uff09/grn.cgi?WSDL\n\n```\n\n#Cybouz\u306b\u9001\u4fe1\u3059\u308bXML\u306epayload\u90e8\u5206\u3092\u4f5c\u6210\n\u6ce8\u610f\uff09\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u307e\u3068\u3081\u3067\u306f\u6700\u5f8c\u306eSlack\u306b\u6295\u3052\u308b\u30e1\u30bd\u30c3\u30c9\u306e\u624b\u524d\u306b\u8a18\u8ff0\u3057\u3066\u3044\u307e\u3059\u3002\n\u3000\u3000\u3000XML\u306e\u9001\u4fe1\u3068\u53d6\u5f97\u3092\u7406\u89e3\u3057\u3066\u3044\u306a\u3044\u3068\u4f55\u3082\u3067\u304d\u306a\u3044\u306e\u3067\u5148\u306b\u8aac\u660e\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u307e\u305a\u6700\u521d\u306bXML\u30d5\u30a1\u30a4\u30eb\u306f\u5927\u307e\u304b\u306b\u3044\u3046\u3068Header\u90e8\u5206\u3068payload\u90e8\u5206\u306b\u5206\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u4eca\u56de\u306fHeader\u90e8\u5206\u306f\u8a18\u8ff0\u305b\u305aCybouz\u306b\u9001\u308bXML\u306epayload\u90e8\u5206\u306e\u307f\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\npayload\u3068\u306f\u9001\u4fe1\u3059\u308bXML\u306eBody\u306e\u3088\u3046\u306a\u3082\u306e\u3060\u3068\u601d\u3063\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u5927\u4e08\u592b\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u3067\u306f\u300cAPI\u6a5f\u80fd\u540d\u300d\u3068\u305d\u308c\u306b\u4ed8\u968f\u3059\u308b\u300cParameter\u30bf\u30b0\u300d\u3092\u4ee3\u5165\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u4f7f\u3044\u307e\u308f\u3057\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u9001\u4fe1\u65b9\u6cd5\u306e\u6307\u5b9a\u306f\u6b21\u306e\u300c\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u300d\u306e\u300cUrlFetchApp.fetch(url, options)\u300d\u3068\u3044\u3046\u30b3\u30fc\u30c9\u90e8\u5206\u3067\u8aac\u660e\u3057\u3066\u3044\u308b\u306e\u3067\u305d\u3061\u3089\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3053\u306e\u30bd\u30fc\u30b9\u306eXML\u6587\u306f'(\u30b7\u30f3\u30b0\u30eb\u30af\u30a9\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3)\u3067\u56f2\u307f\u3001+\u3067\u6b21\u306e\u884c\u306b\u7e4b\u3052\u3066\u3044\u307e\u3059\u3002\u6b63\u898f\u8868\u73fe\u306b\u3059\u308b\u305f\u3081\\ (\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5)\u53c8\u306f\uffe5\u30de\u30fc\u30af\u3092\"(\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3)\u306e\u524d\u306b\u5165\u308c\u3001\"(\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3)\u3092\u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n```lang:createXML()\n/**\n *Cybouz\u306b\u9001\u308bXML\u306epayload\u90e8\u5206\u3092\u4f5c\u6210\n *@param {payload}  payload(\u30c7\u30fc\u30bf\u672c\u4f53)\n *\n **/\n//()\u306e\u4e2d\u306b\u306f'\u4f7f\u3044\u305f\u3044API\u6a5f\u80fd\u540d'\u3068'\uff1cparameter\uff1e\u90e8\u5206'\u3092\u4ee3\u5165\u3057\u3066\u3044\u308b\u3002\nfunction createXML(API,parameters){\n    //xmlns\u7b49(Attribute)\u306e\u524d\u306b\u306f\u30b9\u30da\u30fc\u30b9or\u6539\u884c\u304c\u5fc5\u8981\u306a\u306e\u3067\u6ce8\u610f\n    var payload ='<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>'+\n'<SOAP-ENV:Envelope xmlns:SOAP-ENV=\\\"http://www.w3.org/2003/05/soap-envelope\\\"'+\n ' xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"'+\n ' xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"'+\n ' xmlns:SOAP-ENC=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\"'+\n ' xmlns:base_services=\\\"http://wsdl.cybozu.co.jp/base/2008\\\">'+\n '<SOAP-ENV:Header>'+\n  '<Action SOAP-ENV:mustUnderstand=\\\"1\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2003/03/addressing\\\">'+\n   API+\n  '</Action>'+\n  '<Security xmlns:wsu=\\\"http://schemas.xmlsoap.org/ws/2002/07/utility\\\"'+\n  'SOAP-ENV:mustUnderstand=\\\"1\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2002/12/secext\\\">'+\n   '<UsernameToken wsu:Id=\\\"id\\\">'+\n    '<Username>\u767b\u9332\u540d</Username>'+\n    '<Password>\u30d1\u30b9\u30ef\u30fc\u30c9</Password>'+\n   '</UsernameToken>'+\n  '</Security>'+\n  '<Timestamp SOAP-ENV:mustUnderstand=\\\"1\\\" Id=\\\"id\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2002/07/utility\\\">'+\n   '<Created>2010-08-12T14:45:00Z</Created>'+\n   '<Expires>2037-08-12T14:45:00Z</Expires>'+\n  '</Timestamp>'+\n  '<Locale>jp</Locale>'+\n '</SOAP-ENV:Header>'+\n '<SOAP-ENV:Body>'+\n  '<'+API+'>'+\n    parameters+\n  '</'+API+'>'+\n '</SOAP-ENV:Body>'+\n'</SOAP-ENV:Envelope>'\n  \n  return payload;\n}\n```\n####createXML\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\n\u307e\u305a\u5f15\u6570\u3068\u3057\u3066'\u4f7f\u3044\u305f\u3044API\u6a5f\u80fd\u540d'\u3068'\uff1cparameter\uff1e\u90e8\u5206'\u3092\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e2\u3064\u306f\uff1cAction\uff1e\u30bf\u30b0\u3068\uff1cSOAP-ENV:Body\uff1e\u306e\u4e2d\u3067\u4f7f\u3044\u307e\u3059\u3002\u7406\u7531\u3068\u3057\u3066\u306f\u4f7f\u3044\u305f\u3044API\u6a5f\u80fd\u3054\u3068\u306b\u8a18\u8ff0\u3059\u308b\u5024\u304c\u5909\u5316\u3059\u308b\u305f\u3081\u5f15\u6570\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\uff1cUsernameToken\uff1e\u30bf\u30b0\u3068\uff1cTimestamp\uff1e\u30bf\u30b0\u3092\u5909\u66f4\u3057\u3066\u3044\u306a\u3044\u306e\u3067payload\u3067\u5909\u66f4\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u306e\u306f\u3053\u306e\uff12\u3064\u3060\u3051\u3067\u3059\u3002\n\u6642\u9593\u306e\u300c2015-10-28T01:00:21.159Z\u300d\u3068\u3044\u3046\u8868\u8a18\u306b\u3064\u3044\u3066\u306f\u6b21\u306e\u300c\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u300d\u306b\u3066\u8aac\u660e\u3057\u3066\u3044\u307e\u3059\u3002\n\n```lang:\u4f8b\uff09\u63b2\u793a\u677f\u306e\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u5834\u5408\u306eXML\u306e\u4e00\u90e8\u5206\n\n<Action SOAP-ENV:mustUnderstand=\"1\"\n  xmlns=\"http://schemas.xmlsoap.org/ws/2003/03/addressing\">\n   NotificationGetNotificationVersions\n</Action>\n\n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\n\n<SOAP-ENV:Body>\n  <NotificationGetNotificationVersions>\n    <parameters start=\"2015-10-28T01:00:21.159Z\" end=\"2015-10-29T13:00:21.159Z\" module_id=\"grn.bulletin\">\n      <notification_item version=\"0\">\n        <notification_id module_id=\"grn.bulletin\" item=\"-1\"/>\n      </notification_item>\n    </parameters>\n  <NotificationGetNotificationVersions>\n <SOAP-ENV:Body>\n\n```\n#\u63b2\u793a\u677f\u306e\u6700\u65b0\u306e\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\n\u203b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3059\u308b\u969b\u306f\u3053\u306e\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u304b\u3089\u5b9f\u884c\u3059\u308c\u3070Slack\u306b\u6295\u3052\u308b\u3068\u3053\u308d\u307e\u3067\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u306e\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u3067\u306f\u6307\u5b9a\u3057\u305f\u6642\u9593\u5185\u306e\u63b2\u793a\u677fID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u6700\u521d\u306b\u73fe\u5728\u6642\u523b\u3092\u53d6\u5f97\u3057\u306630\u5206\u4ee5\u5185\u306e\u63b2\u793a\u677fID\u3092\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\n```lang:BulletinRequest()\n\n/**BulletinRequest()\n *  \u6307\u5b9a\u3057\u305f\u65e5\u6642\u5185\u306e\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\n *  NotificationGetNotificationVersions\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n *  @param {notification_items} \u914d\u5217:\u901a\u77e5id\u304c\u4e2d\u306b\u3042\u308b\n */\nfunction BulletinRequest() {\n  //\u2193\u73fe\u5728\u6642\u523b\u3092\u53d6\u5f97\u3057\u3066ISO-8601 \u62e1\u5f35\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\n  var startdate = new Date(),//\u65e5\u672c\u306e\u73fe\u5728\u65e5\u6642\u3092\u30df\u30ea\u79d2\u307e\u3067\u53d6\u5f97\n      enddate = new Date();\n  startdate.setMinutes(startdate.getMinutes()-30);//\u958b\u59cb\u65e5\u6642\u309230\u5206\u524d\u306b\u3059\u308b\n//  Logger.log('\u958b\u59cb\u65e5\u6642(\u65e5\u672c\u6642\u9593):'+startdate);\n  \n  //ISO \u65e5\u4ed8\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\u2193\n  startdate = startdate.toISOString();//\u958b\u59cb\u65e5\u6642//\u4e16\u754c\u6a19\u6e96\u6642\n  enddate = enddate.toISOString();//\u7d42\u4e86\u65e5\u6642//\u4e16\u754c\u6a19\u6e96\u6642\n  \n//  Logger.log('\u958b\u59cb\u65e5\u6642(ISO\u5f62\u5f0f):'+startdate);\n//  Logger.log('\u7d42\u4e86\u65e5\u6642(ISO\u5f62\u5f0f):'+enddate);\n  \n  //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n  //API\u540d(\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'NotificationGetNotificationVersions';\n  //\u65e5\u6642\u6307\u5b9a,\u6a5f\u80fd\u540d(\u63b2\u793a\u677f),\u30d0\u30fc\u30b8\u30e7\u30f3\u6307\u5b9a(0=\u5168\u3066\u306e\u30d0\u30fc\u30b8\u30e7\u30f3)\u306a\u3069\u3092\u884c\u3046\n  var parameters = '<parameters start=\\\"' + startdate + '\\\" end=\\\"' + enddate + '\\\" module_id=\\\"grn.bulletin\\\">'+\n      '<notification_item version=\\\"0\\\">'+\n        '<notification_id module_id=\\\"grn.bulletin\\\" item=\\\"-1\\\"/>'+//item=-1\u306b\u3059\u308b\u3053\u3068\u3067\u5fc5\u305a\uff11\u756a\u76ee\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\n      '</notification_item>'+\n    '</parameters>';\n  \n  //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n  var payload = createXML(API,parameters);\n  \n  //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n  var options = {\n    \"method\": \"post\",\n    \"contextType\": \"application/soap+xml\",\n    \"muteHttpExceptions\": true,\n    \"payload\": payload\n  };\n\n  //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066notification\u90e8\u5206\u304c\u9055\u3046\n  var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/notification/api.csp?\";\n  \n  try {\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n    var response = UrlFetchApp.fetch(url, options);\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n    var doc = XmlService.parse(response.getContentText());\n    \n    //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,\u901a\u77e5\u306e\u914d\u5217\u3092\u53d6\u5f97\n    var notification_items = doc\n      .getRootElement()\n      .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n      .getChild('NotificationGetNotificationVersionsResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/notification/2008'))\n      .getChild('returns', XmlService.getNamespace(''))\n      .getChildren('notification_item');\n    \n    //\u63b2\u793a\u677f\u306e\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306b\u914d\u5217\u3092\u9001\u308b\u3002\n    BulletinGetTopicByIds(notification_items);\n    \n    \n  } catch (e) {\n    Logger.log(e);\n  }\n}\n\n```\n\n####BulletinRequest\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\nGaroon\u306b\u6642\u9593\u3092\u9001\u4fe1\u3059\u308b\u969b\u306fISO\u65e5\u4ed8\u5f62\u5f0f\u3068\u3044\u3046\u3082\u306e\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u307e\u305a\u6700\u521d\u306b\u300c.toISOString()\u300d\u3092\u4f7f\u3044\u5909\u63db\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u3067\u5909\u63db\u3059\u308b\u3068\u65e5\u672c\u6642\u9593\u3060\u3063\u305f\u3082\u306e\u306fISO\u5f62\u5f0f\u3067\u4e16\u754c\u6a19\u6e96\u6642\u306b\u5909\u308f\u308a\u307e\u3059\u3002\n\u6b21\u306b\u5909\u6570API\u306b\u6a5f\u80fd\u540d\u3092\u3001\u5909\u6570parameters\u306b\u6b32\u3057\u3044\u5024\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```lang:\u4f8b\uff09\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u66f4\u65b0\u901a\u77e5\u306e\u5834\u5408\n\n  //API\u540d(\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'NotificationGetNotificationVersions';\n  //\u65e5\u6642\u6307\u5b9a,\u6a5f\u80fd\u540d(\u8a72\u5f53\u3059\u308b\u540d\u524d\u3092\u8a18\u8ff0),\u30d0\u30fc\u30b8\u30e7\u30f3\u6307\u5b9a(0=\u5168\u3066\u306e\u30d0\u30fc\u30b8\u30e7\u30f3)\u306a\u3069\u3092\u884c\u3046\n  var parameters = '<parameters start=\\\"' + startdate + '\\\" end=\\\"' + enddate + '\\\" module_id=\\\"grn.message\\\">'+\n      '<notification_item version=\\\"0\\\">'+\n        '<notification_id module_id=\\\"grn.message\\\" item=\\\"34\\\"/>'+\n      '</notification_item>'+\n    '</parameters>';\n\n```\n\u4f8b\u306e\u5834\u5408\u306fparameter\u306eversion\u6307\u5b9a\u3067\u306f\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u5165\u529b\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u53d6\u5f97\u3059\u308b\u5024\u304c\u5909\u5316\u3059\u308b\u3088\u3046\u3067\u3059\u3002\u3057\u304b\u3057\u3001\u6b8b\u5ff5\u306a\u304c\u3089\u81ea\u5206\u306f\u7406\u89e3\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u5168\u4ef6\u53d6\u5f97\u3059\u308b\u5f62\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\nBulletinRequest\u30e1\u30bd\u30c3\u30c9\u306eparameter\u3057\u3066\u3044\u3067\u306fitem = -1\u3000\u3068\u3057\u3066\u3044\u307e\u3059\u304c\u3053\u308c\u3092\u3084\u308b\u3068\u5fc5\u305a\u6700\u521d\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u306e\u3067\u305d\u308c\u3092\u9664\u5916\u3057\u3066\u3044\u307e\u3059\u3002\u672c\u6765\u306a\u3089Response\u306e\u4e2d\u3067\u95a2\u4fc2\u306e\u306a\u3044\u5024\u306e\u307foperation=\"remove\"\u3068\u306a\u308b\u306e\u3067if\u6587\u3067\u9664\u5916\u3059\u3079\u304d\u3060\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u554f\u984c\u306a\u304f\u52d5\u3044\u305f\u305f\u3081\u4eca\u56de\u306fif\u6587\u3067\u306f\u9664\u5916\u3057\u3066\u304a\u308a\u307e\u305b\u3093\u3002\n\n#####XML\u9001\u4fe1(UrlFetchApp)\n\u5909\u6570payload\u306bcreateXML()\u306e\u8fd4\u308a\u5024\u3092\u4ee3\u5165\u3057\u3001\u5909\u6570options\u306b\u9023\u60f3\u914d\u5217\u3067\u4ee3\u5165\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u5f8c\u306b\u5909\u6570url\u306b\u81ea\u5206\u306e\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d\u304c\u5165\u3063\u305fURL\u3092\u4ee3\u5165,UrlFetchApp.fetch()\u3067\u9001\u4fe1\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306e\u8a73\u7d30\u306f\u672b\u5c3e\u306e\u300c\u305d\u306e\u4ed6\u306b\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\u300d\u3067Google\u304c\u7d39\u4ecb\u3057\u3066\u3044\u307e\u3059\u3002\n\n#####getChild(),getChildren\u306b\u3064\u3044\u3066\nUrlFetchApp.fetch()\u3067\u53d6\u5f97\u3057\u305f\u5834\u5408\u306fBody\u304b\u3089\u9806\u306b\u5358\u6570\u306e\u5834\u5408\u306f.Child()\u304b\u8907\u6570\u306e\u5834\u5408\u306f.Children()\u3067\u9806\u306b\u53d6\u5f97\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\nResponse\u306e\u4f8b\u6587\u304c\u307f\u305f\u3044\u65b9\u306fResponse\u30b5\u30f3\u30d7\u30eb\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u305d\u3057\u3066\u3001\u6700\u7d42\u7684\u306b\u53d6\u5f97\u3057\u305f\u5024\u3092\u6b21\u306e\u30e1\u30bd\u30c3\u30c9\u300cBulletinGetTopicByIds()\u300d\u306b\u6e21\u3057\u307e\u3059\u3002\n\n\n\n\n\n\n#\u63b2\u793a\u677fID\u3092\u4f7f\u3044\u8a73\u7d30\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u3067\u306f\u300cBulletinRequest()\u300d\u304b\u3089\u9001\u3089\u308c\u3066\u304d\u305f\u5024\u304b\u3089\u63b2\u793a\u677fid\u3092\u4f7f\u3044\u3001\u8a72\u5f53\u3059\u308b\u63b2\u793a\u677f\u306e\u8a73\u7d30\u60c5\u5831\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```lang:BulletinGetTopicById()\n\n/**\n *  \u63b2\u793a\u677f\u306e\u8a73\u7d30\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n *  @param  {name}           \u30e6\u30fc\u30b6\u540d\n *  @param  {category_name}  \u30ab\u30c6\u30b4\u30ea\u540d\n *  @param  {subject}        \u30bf\u30a4\u30c8\u30eb\u540d\n *  @param  {GaroonLink}     \u63b2\u793a\u677fURL\n */\n/**BulletinGetTopicByIds()\n *  \u6307\u5b9a\u3057\u305f\u63b2\u793a\u677fID\u3068\u4e00\u81f4\u3057\u305f\u63b2\u793a\u677f\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\n *  BulletinGetTopicByIds\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n */\nfunction BulletinGetTopicByIds(notification_items) {\n  //\u901a\u77e5id\u3068\u63b2\u793a\u677fid\u3092\u5b9a\u7fa9\n  var notification_id,\n      topic_id;\n      \n  //\u901a\u77e5\u306e\u914d\u5217\u3092\u5229\u7528\u3057\u3001for\u6587\u3067topic_id\u3054\u3068\u306e\u63b2\u793a\u677f\u306e\u8a73\u7d30\u3092\u53d6\u5f97\n  //\u6700\u521d\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u306e\u30670\u3067\u306f\u306a\u304f1\u304b\u3089\n  for (var i = 1; i < notification_items.length; i++) {\n    notification_id = notification_items[i].getChild('notification_id');\n    topic_id = notification_id.getAttribute('item').getValue();\n    \n//    Logger.log('topic_id(\u78ba\u8a8d):'+topic_id);\n          \n    //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n    //API\u540d(\u63b2\u793a\u677f\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n    var API = 'BulletinGetTopicByIds';\n    //\u63b2\u793a\u677fid\u6307\u5b9a\u3084\u4e0b\u66f8\u304d\u304b\u3069\u3046\u304b\u5224\u5b9a(is_draft)\u306a\u3069\u3092\u884c\u3046\n    var parameters = '<parameters>'+\n        '<topics xmlns=\\\"\\\" topic_id=\\\"'+topic_id+'\\\" is_draft=\\\"false\\\"></topics>'+\n      '</parameters>';\n    \n    //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n    var payload = createXML(API,parameters);\n    //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n    var options = {\n        \"method\": \"post\",\n        \"contextType\": \"application/soap+xml\",\n        \"muteHttpExceptions\": true,\n        \"payload\": payload\n    };\n    //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066bulletin\u90e8\u5206\u304c\u9055\u3046\n    var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\";\n  \n    try {\n      //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n      var response = UrlFetchApp.fetch(url, options);\n      //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n      var doc = XmlService.parse(response.getContentText());\n      \n      //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,\u63b2\u793a\u677f\u306eid\u3092\u53d6\u5f97\n      var bulletin = doc\n          .getRootElement()\n          .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n          .getChild('BulletinGetTopicByIdsResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/bulletin/2008'))\n          .getChild('returns', XmlService.getNamespace(''))\n          .getChild('topic');\n      \n      //category_id , \u30bf\u30a4\u30c8\u30eb , \u30e6\u30fc\u30b6\u540d\u53d6\u5f97\n      var category_id = bulletin.getAttribute(\"category_id\").getValue(),\n          subject = bulletin.getAttribute(\"subject\").getValue(),\n          name = bulletin.getChild('creator',XmlService.getNamespace('http://schemas.cybozu.co.jp/bulletin/2008'))\n          .getAttribute(\"name\").getValue(),\n          //categories\u53d6\u5f97\n          categories =CategoriesRequest(),\n          category_name;\n      \n      //catgory_name\u53d6\u5f97\n      for (var j = 0; j < categories.length; j++) {\n        //category_id\u304c\u4e00\u81f4\u3059\u308c\u3070category_name\u3092\u4ee3\u5165\n        if(category_id == categories[j][0]){\n          category_name = categories[j][1];\n        }\n      }\n      \n//      //\u30ed\u30b0\n//      Logger.log('topic_id(\u518d\u78ba\u8a8d):'+bulletin.getAttribute(\"id\").getValue());\n//      Logger.log('\u30ab\u30c6\u30b4\u30ea:'+category_id);\n//      Logger.log('\u30ab\u30c6\u30b4\u30ea\u540d:'+category_name);\n//      Logger.log('\u30b5\u30d6\u30b8\u30a7\u30af\u30c8:'+subject);\n//      Logger.log('\u540d\u524d:'+name);\n      \n      //\u53d6\u5f97\u3057\u305f\u5024\u3067\u30ea\u30f3\u30af\u7528URL\u3092\u4f5c\u6210\n      var GaroonLink = 'https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/bulletin/view.csp?cid='+category_id+'&aid='+topic_id;\n//      Logger.log('\u30ea\u30f3\u30af:'+GaroonLink);\n      \n    } catch (e) {\n      Logger.log(e);\n    }\n          \n       /**\n        * Slack\u306b\u30e1\u30fc\u30eb\u306e\u4e2d\u8eab\u3092\u6295\u3052\u308b\n        */\n        sendHttpPostSlack(\n          \" ```\u5dee\u51fa\u4eba:\"+ name +\"\\n\u30ab\u30c6\u30b4\u30ea:\"+category_name+\"\\n\u30bf\u30a4\u30c8\u30eb:\"+ subject +\"\\n\" + GaroonLink + \"\\n``` \",\n          \"\u3051\u3044\u3058\u3070\u3093\u3057\u3085\u3068\u304f\u3093\"); //\u5f15\u6570username\uff08\u597d\u304d\u306a\u540d\u524d\u3092\u8a18\u8ff0\uff09\n    \n   }//for\u6587\u306e\u7d42\u308f\u308a\n}\n```\n####BulletinGetTopicByIds\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\n\u3053\u3053\u306fBulletinRequest\u30e1\u30bd\u30c3\u30c9\u3067\u3084\u3063\u305f\u3053\u3068\u3092API\u306e\u6a5f\u80fd\u306b\u5408\u308f\u305b\u3066\u66f8\u304d\u63db\u3048\u305f\u611f\u3058\u3067\u3059\u3002\u30b3\u30e1\u30f3\u30c8\u3082\u5165\u308c\u305f\u306e\u3067\u8a66\u305b\u3070\u3060\u3044\u305f\u3044\u5206\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u308c\u4ee5\u5916\u306e\u9055\u3044\u306f\u4e0b\u8a18\u306b\u8a72\u5f53\u3059\u308b\u90e8\u5206\u3067\u300cCategoriesRequest\u300d\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3044\u30ab\u30c6\u30b4\u30ea\u540d\u3092\u53d6\u5f97\u3057\u3066\u3044\u308b\u306e\u3068\u3001\n\n```\n//categories\u53d6\u5f97\ncategories =CategoriesRequest(),\ncategory_name;\n\n//catgory_name\u53d6\u5f97\nfor (var j = 0; j < categories.length; j++) {\n  //category_id\u304c\u4e00\u81f4\u3059\u308c\u3070category_name\u3092\u4ee3\u5165\n  if(category_id == categories[j][0]){\n    category_name = categories[j][1];\n  }\n}\n```\n\u30e1\u30bd\u30c3\u30c9\u306e\u6700\u5f8c\u306b\u300csendHttpPostSlack\u300d\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3044Slack\u306b\u8868\u793a\u3059\u308b\u5185\u5bb9\u3092\u6295\u3052\u308b\u3068\u3053\u308d\u304c\u5927\u304d\u304f\u9055\u3044\u307e\u3059\u3002\n\n```\n/**\n * Slack\u306b\u30e1\u30fc\u30eb\u306e\u4e2d\u8eab\u3092\u6295\u3052\u308b\n */\nsendHttpPostSlack(\n  \" ```\u5dee\u51fa\u4eba:\"+ name +\"\\n\u30ab\u30c6\u30b4\u30ea:\"+category_name+\"\\n\u30bf\u30a4\u30c8\u30eb:\"+ subject +\"\\n\" + GaroonLink + \"\\n``` \",\n \"\u3051\u3044\u3058\u3070\u3093\u3057\u3085\u3068\u304f\u3093\"); //\u5f15\u6570username\uff08\u597d\u304d\u306a\u540d\u524d\u3092\u8a18\u8ff0\uff09\n    \n```\n\n#\u63b2\u793a\u677f\u306e\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\n\u30ab\u30c6\u30b4\u30ea\u540d\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u3060\u3051\u306b\u4f5c\u308a\u307e\u3057\u305f\u3002\u591a\u6b21\u5143\u914d\u5217\u3067\u5024\u3092\u8fd4\u3059\u306e\u3067\u914d\u5217\u3068\u9593\u9055\u3048\u306a\u3044\u3088\u3046\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\n```lang:CategoriesRequest()\n\n/**CategoriesRequest()\n *  \u63b2\u793a\u677f\u306e\u30ab\u30c6\u30b4\u30ea\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\n *  BulletinGetCategories\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n *  @param {category_id}    \u30ab\u30c6\u30b4\u30eaID\n *  @param {category_name}  \u30ab\u30c6\u30b4\u30ea\u540d\n * \n */\nfunction CategoriesRequest(){\n  //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n  //API\u540d(\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'BulletinGetCategories';\n  //\u65e5\u6642\u6307\u5b9a,\u6a5f\u80fd\u540d(\u63b2\u793a\u677f),\u30d0\u30fc\u30b8\u30e7\u30f3\u6307\u5b9a(0=\u5168\u3066\u306e\u30d0\u30fc\u30b8\u30e7\u30f3)\u306a\u3069\u3092\u884c\u3046\n  var parameters = ' ';\n  \n  //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n  var payload = createXML(API,parameters);\n  \n  //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n  var options = {\n    \"method\": \"post\",\n    \"contextType\": \"application/soap+xml\",\n    \"muteHttpExceptions\": true,\n    \"payload\": payload\n  };\n\n  //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066notification\u90e8\u5206\u304c\u9055\u3046\n  var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\";\n  \n  try {\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n    var response = UrlFetchApp.fetch(url, options);\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n    var doc = XmlService.parse(response.getContentText());\n    \n    //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,root\u3092\u53d6\u5f97\n    var root = doc\n      .getRootElement()\n      .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n      .getChild('BulletinGetCategoriesResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/bulletin/2008'))\n      .getChild('returns', XmlService.getNamespace(''))\n      .getChild('categories')\n      .getChild('root');\n    \n//    Logger.log(root+\"\u30eb\u30fc\u30c8\");\n    \n    //category_params\u3092\u591a\u6b21\u5143\u914d\u5217\u306b\u3057\u3066\u914d\u5217\u3092\u8ffd\u52a0\n    //\u30ab\u30c6\u30b4\u30ea\u306e\u30eb\u30fc\u30c8\u306e\u982d\u3092\u53d6\u5f97\uff08\u4ed6\u306f\u30eb\u30fc\u30c8\u306e\u4e2d\u306b\u5b58\u5728\uff09\n    var root_category = [root.getAttribute('id').getValue(),root.getChild('name').getText()],\n        category_params =[root_category];\n    \n//    Logger.log(category_params[0]);\n    \n    //root\u306e\u4e0b\u304b\u3089category(\u914d\u5217)\u3092\u53d6\u5f97\n    var category = root\n     .getChild('categories')\n     .getChildren('category');\n    \n//    Logger.log(category);\n    \n    //category_params\u306b\u5165\u308c\u308b\u5909\u6570\n    var category_id,\n        category_name;\n    \n    //category_id,category_name\u3092\u914d\u5217\u306b\u3057\u3066category_params\u306b\u5165\u308c\u308b\n    for (var i = 0; i < category.length; i++) {\n      category_id = category[i].getAttribute('id').getValue();\n      category_name = category[i].getChild('name').getText();\n      \n//      Logger.log('ID:'+category_id);\n//      Logger.log('NAME:'+category_name);\n      \n      category_params[i+1] = [category_id,category_name];\n      \n    }//for\u6587\u7d42\u308f\u308a\n    \n    \n//    //\u30ed\u30b0\u78ba\u8a8d\u7528for\u6587\n//    for (var i = 0; i < category_params.length; i++) {\n//        Logger.log('CATEGORY:'+category_params[i]);\n//    }\n\n    \n    \n  } catch (e) {\n    Logger.log(e);\n  }\n  //\u591a\u6b21\u5143\u914d\u5217\u3092\u30ea\u30bf\u30fc\u30f3\n  return category_params;\n}\n```\n####CategoriesRequest\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\nSlack\u306b\u5024\u3092\u6295\u3052\u305f\u6642\u306b\u5185\u5bb9\u304c\u5206\u304b\u308a\u3065\u3089\u3044\u306a\u3068\u601d\u3063\u3066\u5f8c\u304b\u3089\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\u30ab\u30c6\u30b4\u30ea\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\u969b\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u4e0d\u8981\u306a\u306e\u3067parameters\u306f\u6307\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u5f8c\u8ff0\u306e\u300cResponse\u30b5\u30f3\u30d7\u30eb\u300d\u3092\u898b\u308c\u3070\u308f\u304b\u308a\u307e\u3059\u304c\u300cBulletinGetCategories\u300d\u306fResponse\u304c\u3081\u3093\u3069\u304f\u3055\u3044\u3067\u3059\u3002\u30eb\u30fc\u30c8\u30ab\u30c6\u30b4\u30ea\u306e\u4e2d\u306b\u30ab\u30c6\u30b4\u30ea\u304c\u5165\u3063\u3066\u3044\u308b\u306e\u3067\u4e00\u5ea6\u5148\u982d\u306e\u30eb\u30fc\u30c8\u306eID\u3068Name\u3092\u53d6\u5f97\u3057\u3066\u304b\u3089\u305d\u306e\u4e0b\u306e\u30ab\u30c6\u30b4\u30ea\u3092for\u6587\u3067\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\u591a\u6b21\u5143\u914d\u5217\u306b\u3057\u3066\u8ffd\u52a0\u3057\u3066\u3044\u308b\u306e\u3067\u53d6\u308a\u51fa\u3059\u969b\u306e\u51e6\u7406\u306b\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n#Slack\u306b\u306a\u3052\u308b\n\n```lang:sendHttpPostSlack()\n\n/**\n * \u691c\u7d22\u3067\u30d2\u30c3\u30c8\u3057\u305f\u30e1\u30fc\u30eb\u304b\u3089\u53d6\u308a\u51fa\u3057\u305f\u30c7\u30fc\u30bf\uff08message\uff09\u3068username\u3092\u5f15\u6570\u306b\u3057\n * JSON\u578b\u306b\u30ad\u30e3\u30b9\u30c8\u3057incoming webhocks\u306eurl\u306b\u30c7\u30fc\u30bf\u3092\u6295\u3052\u308b\u95a2\u6570\n *\n * @param {String} message \u63b2\u793a\u677f\u306e\u5185\u5bb9\n * @param {String} username Slack\u3067\u8868\u793a\u3055\u308c\u308bBot\u306e\u540d\u524d\n */\nfunction sendHttpPostSlack(message, username) {\n  //incoming Webhocks\u3067\u53d6\u5f97\u3057\u305furl\u3092\u8a18\u8ff0\n\u3000var postUrl_slack = \"incoming Webhocks\u3067\u53d6\u5f97\u3057\u305furl\";\n  \n  //\u6295\u7a3f\u3057\u305f\u3044slack\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n  var postChannel = \"#\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\";\n\n  var jsonData = {\n    \"channel\": postChannel,\n    \"username\": username,\n    \"text\": message\n  };\n  \n  var payload = JSON.stringify(jsonData);\n  \n  var options = {\n    \"method\": \"post\",\n    \"contentType\": \"application/json\",\n    \"payload\": payload\n  };\n  \n  UrlFetchApp.fetch(postUrl_slack, options); //incoming webhocks\u306b\u30ea\u30af\u30a8\u30b9\u30c8\n}\n```\n\n####CategoriesRequest\u30e1\u30bd\u30c3\u30c9\u306e\u89e3\u8aac\n\u4f5c\u6210\u3057\u305fmessage\u3068\u30c1\u30e3\u30f3\u30cd\u30eb\u540d,username\u3092json\u30c7\u30fc\u30bf\u306b\u5909\u63db\u3057payload\u306b\u3001options\u306b\u9001\u4fe1\u65b9\u6cd5\u3068payload\u3092\u8a2d\u5b9a\u3057\u3001Slack\u3067\u8a2d\u5b9a\u3057\u305f\u3068\u304d\u306b\u5f97\u3089\u308c\u305furl\u3068\u3068\u3082\u306bUrlFetchApp.fetch()\u3067\u9001\u4fe1\u3057\u307e\u3057\u305f\u3002\n\u3053\u308c\u3092\u4f7f\u3046\u305f\u3081\u306b\u306fSlack\u306bincoming webhocks\u3092\u5165\u308c\u3066\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u305d\u3046\u3067\u3059\u3002\n\u3053\u306e\u8fba\u308a\u306f\u77e5\u308a\u5408\u3044\u304c\u4f5c\u6210\u3057\u305f\u90e8\u5206\u306a\u306e\u3067\u81ea\u5206\u3067\u3082100%\u306f\u7406\u89e3\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u4e00\u7dd2\u306b\u306e\u305b\u307e\u3057\u305f\u3002\n\n#\u307e\u3068\u3081\n\u5168\u90e8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\n\n```lang:\u6700\u65b0\u63b2\u793a\u677f\u53d6\u5f97\u30d7\u30ed\u30b0\u30e9\u30e0\n\n//\u95a2\u6570BulletinRequest\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n//\u73fe\u5728\u306f\u30c8\u30ea\u30ac\u30fc\u309230\u5206\u3054\u3068\u306b\u8a2d\u5b9a\u3057\u3066\u307e\u3059\u3002\n//XML\u306epayload\u306e username,Password,Created,Expires\u306e\u90e8\u5206\u306f\u73fe\u5728\u306f\u5909\u6570\u306b\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n//Logger.log()\u306f\u78ba\u8a8d\u7528\u306e\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\n//\n//\n\n/**BulletinRequest()\n *  \u6307\u5b9a\u3057\u305f\u65e5\u6642\u5185\u306e\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\n *  NotificationGetNotificationVersions\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n *  @param {notification_items} \u914d\u5217:\u901a\u77e5id\u304c\u4e2d\u306b\u3042\u308b\n */\nfunction BulletinRequest() {\n  //\u2193\u73fe\u5728\u6642\u523b\u3092\u53d6\u5f97\u3057\u3066ISO-8601 \u62e1\u5f35\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\n  var startdate = new Date(),//\u65e5\u672c\u306e\u73fe\u5728\u65e5\u6642\u3092\u30df\u30ea\u79d2\u307e\u3067\u53d6\u5f97\n      enddate = new Date();\n  startdate.setMinutes(startdate.getMinutes()-30);//\u958b\u59cb\u65e5\u6642\u309230\u5206\u524d\u306b\u3059\u308b\n//  Logger.log('\u958b\u59cb\u65e5\u6642(\u65e5\u672c\u6642\u9593):'+startdate);\n  \n  //ISO \u65e5\u4ed8\u5f62\u5f0f\u306b\u5909\u63db\u3059\u308b\u2193\n  startdate = startdate.toISOString();//\u958b\u59cb\u65e5\u6642//\u4e16\u754c\u6a19\u6e96\u6642\n  enddate = enddate.toISOString();//\u7d42\u4e86\u65e5\u6642//\u4e16\u754c\u6a19\u6e96\u6642\n  \n//  Logger.log('\u958b\u59cb\u65e5\u6642(ISO\u5f62\u5f0f):'+startdate);\n//  Logger.log('\u7d42\u4e86\u65e5\u6642(ISO\u5f62\u5f0f):'+enddate);\n  \n  //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n  //API\u540d(\u66f4\u65b0\u901a\u77e5\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'NotificationGetNotificationVersions';\n  //\u65e5\u6642\u6307\u5b9a,\u6a5f\u80fd\u540d(\u63b2\u793a\u677f),\u30d0\u30fc\u30b8\u30e7\u30f3\u6307\u5b9a(0=\u5168\u3066\u306e\u30d0\u30fc\u30b8\u30e7\u30f3)\u306a\u3069\u3092\u884c\u3046\n  var parameters = '<parameters start=\\\"' + startdate + '\\\" end=\\\"' + enddate + '\\\" module_id=\\\"grn.bulletin\\\">'+\n      '<notification_item version=\\\"0\\\">'+\n        '<notification_id module_id=\\\"grn.bulletin\\\" item=\\\"-1\\\"/>'+//item=-1\u306b\u3059\u308b\u3053\u3068\u3067\u5fc5\u305a\uff11\u756a\u76ee\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\n      '</notification_item>'+\n    '</parameters>';\n  \n  //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n  var payload = createXML(API,parameters);\n  \n  //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n  var options = {\n    \"method\": \"post\",\n    \"contextType\": \"application/soap+xml\",\n    \"muteHttpExceptions\": true,\n    \"payload\": payload\n  };\n\n  //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066notification\u90e8\u5206\u304c\u9055\u3046\n  var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/notification/api.csp?\";\n  \n  try {\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n    var response = UrlFetchApp.fetch(url, options);\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n    var doc = XmlService.parse(response.getContentText());\n    \n    //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,\u901a\u77e5\u306e\u914d\u5217\u3092\u53d6\u5f97\n    var notification_items = doc\n      .getRootElement()\n      .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n      .getChild('NotificationGetNotificationVersionsResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/notification/2008'))\n      .getChild('returns', XmlService.getNamespace(''))\n      .getChildren('notification_item');\n    \n    //\u63b2\u793a\u677f\u306e\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u306b\u914d\u5217\u3092\u9001\u308b\u3002\n    BulletinGetTopicByIds(notification_items);\n    \n    \n  } catch (e) {\n    Logger.log(e);\n  }\n}\n\n\n/**\n *  \u63b2\u793a\u677f\u306e\u8a73\u7d30\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n *  @param  {name}           \u30e6\u30fc\u30b6\u540d\n *  @param  {category_name}  \u30ab\u30c6\u30b4\u30ea\u540d\n *  @param  {subject}        \u30bf\u30a4\u30c8\u30eb\u540d\n *  @param  {GaroonLink}     \u63b2\u793a\u677fURL\n */\n/**BulletinGetTopicByIds()\n *  \u6307\u5b9a\u3057\u305f\u63b2\u793a\u677fID\u3068\u4e00\u81f4\u3057\u305f\u63b2\u793a\u677f\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\n *  BulletinGetTopicByIds\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n */\nfunction BulletinGetTopicByIds(notification_items) {\n  //\u901a\u77e5id\u3068\u63b2\u793a\u677fid\u3092\u5b9a\u7fa9\n  var notification_id,\n      topic_id;\n      \n  //\u901a\u77e5\u306e\u914d\u5217\u3092\u5229\u7528\u3057\u3001for\u6587\u3067topic_id\u3054\u3068\u306e\u63b2\u793a\u677f\u306e\u8a73\u7d30\u3092\u53d6\u5f97\n  //\u6700\u521d\u306b\u95a2\u4fc2\u306e\u306a\u3044\u5024\u304c\u6765\u308b\u306e\u30670\u3067\u306f\u306a\u304f1\u304b\u3089\n  for (var i = 1; i < notification_items.length; i++) {\n    notification_id = notification_items[i].getChild('notification_id');\n    topic_id = notification_id.getAttribute('item').getValue();\n    \n//    Logger.log('topic_id(\u78ba\u8a8d):'+topic_id);\n          \n    //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n    //API\u540d(\u63b2\u793a\u677f\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n    var API = 'BulletinGetTopicByIds';\n    //\u63b2\u793a\u677fid\u6307\u5b9a\u3084\u4e0b\u66f8\u304d\u304b\u3069\u3046\u304b\u5224\u5b9a(is_draft)\u306a\u3069\u3092\u884c\u3046\n    var parameters = '<parameters>'+\n        '<topics xmlns=\\\"\\\" topic_id=\\\"'+topic_id+'\\\" is_draft=\\\"false\\\"></topics>'+\n      '</parameters>';\n    \n    //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n    var payload = createXML(API,parameters);\n    //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n    var options = {\n        \"method\": \"post\",\n        \"contextType\": \"application/soap+xml\",\n        \"muteHttpExceptions\": true,\n        \"payload\": payload\n    };\n    //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066bulletin\u90e8\u5206\u304c\u9055\u3046\n    var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\";\n  \n    try {\n      //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n      var response = UrlFetchApp.fetch(url, options);\n      //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n      var doc = XmlService.parse(response.getContentText());\n      \n      //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,\u63b2\u793a\u677f\u306eid\u3092\u53d6\u5f97\n      var bulletin = doc\n          .getRootElement()\n          .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n          .getChild('BulletinGetTopicByIdsResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/bulletin/2008'))\n          .getChild('returns', XmlService.getNamespace(''))\n          .getChild('topic');\n      \n      //category_id , \u30bf\u30a4\u30c8\u30eb , \u30e6\u30fc\u30b6\u540d\u53d6\u5f97\n      var category_id = bulletin.getAttribute(\"category_id\").getValue(),\n          subject = bulletin.getAttribute(\"subject\").getValue(),\n          name = bulletin.getChild('creator',XmlService.getNamespace('http://schemas.cybozu.co.jp/bulletin/2008'))\n          .getAttribute(\"name\").getValue(),\n          //categories\u53d6\u5f97\n          categories =CategoriesRequest(),\n          category_name;\n      \n      //catgory_name\u53d6\u5f97\n      for (var j = 0; j < categories.length; j++) {\n        //category_id\u304c\u4e00\u81f4\u3059\u308c\u3070category_name\u3092\u4ee3\u5165\n        if(category_id == categories[j][0]){\n          category_name = categories[j][1];\n        }\n      }\n      \n//      //\u30ed\u30b0\n//      Logger.log('topic_id(\u518d\u78ba\u8a8d):'+bulletin.getAttribute(\"id\").getValue());\n//      Logger.log('\u30ab\u30c6\u30b4\u30ea:'+category_id);\n//      Logger.log('\u30ab\u30c6\u30b4\u30ea\u540d:'+category_name);\n//      Logger.log('\u30b5\u30d6\u30b8\u30a7\u30af\u30c8:'+subject);\n//      Logger.log('\u540d\u524d:'+name);\n      \n      //\u53d6\u5f97\u3057\u305f\u5024\u3067\u30ea\u30f3\u30af\u7528URL\u3092\u4f5c\u6210\n      var GaroonLink = 'https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/bulletin/view.csp?cid='+category_id+'&aid='+topic_id;\n//      Logger.log('\u30ea\u30f3\u30af:'+GaroonLink);\n      \n    } catch (e) {\n      Logger.log(e);\n    }\n          \n       /**\n        * Slack\u306b\u30e1\u30fc\u30eb\u306e\u4e2d\u8eab\u3092\u6295\u3052\u308b\n        */\n        sendHttpPostSlack(\n          \" ```\u5dee\u51fa\u4eba:\"+ name +\"\\n\u30ab\u30c6\u30b4\u30ea:\"+category_name+\"\\n\u30bf\u30a4\u30c8\u30eb:\"+ subject +\"\\n\" + GaroonLink + \"\\n``` \",\n          \"\u3051\u3044\u3058\u3070\u3093\u3057\u3085\u3068\u304f\u3093\"); //\u5f15\u6570username\uff08\u597d\u304d\u306a\u540d\u524d\u3092\u8a18\u8ff0\uff09\n    \n   }//for\u6587\u306e\u7d42\u308f\u308a\n}\n\n\n\n\n/**CategoriesRequest()\n *  \u63b2\u793a\u677f\u306e\u30ab\u30c6\u30b4\u30ea\u8a73\u7d30\u3092\u53d6\u5f97\u3059\u308b\n *  BulletinGetCategories\u3068\u3044\u3046\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u7528\u3002\n *  @param {category_id}    \u30ab\u30c6\u30b4\u30eaID\n *  @param {category_name}  \u30ab\u30c6\u30b4\u30ea\u540d\n * \n */\nfunction CategoriesRequest(){\n  //API\u3067\u53d6\u5f97\u3059\u308b\u5024\u3092\u6c7a\u3081\u308b\n  //API\u540d(\u30ab\u30c6\u30b4\u30ea\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u80fd\u540d)\n  var API = 'BulletinGetCategories';\n  //BulletinGetCategories\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u306eparameter\u306f\u4e0d\u8981\n  var parameters = ' ';\n  \n  //createXML\u30e1\u30bd\u30c3\u30c9\u304b\u3089XML\u306epayload\u90e8\u5206\u3092\u53d6\u5f97\n  var payload = createXML(API,parameters);\n  \n  //\u9001\u4fe1\u65b9\u6cd5\u3092\u5b9a\u7fa9\n  var options = {\n    \"method\": \"post\",\n    \"contextType\": \"application/soap+xml\",\n    \"muteHttpExceptions\": true,\n    \"payload\": payload\n  };\n\n  //\u4f7f\u7528\u3059\u308b\u6a5f\u80fd\u306b\u3088\u3063\u3066bulletin\u90e8\u5206\u304c\u9055\u3046\n  var url = \"https://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\";\n  \n  try {\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\n    var response = UrlFetchApp.fetch(url, options);\n    //\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\u3059\u308b\n    var doc = XmlService.parse(response.getContentText());\n    \n    //\u30ce\u30fc\u30c9\u89e3\u6790\u3057,root\u3092\u53d6\u5f97\n    var root = doc\n      .getRootElement()\n      .getChild('Body', XmlService.getNamespace('http://www.w3.org/2003/05/soap-envelope'))\n      .getChild('BulletinGetCategoriesResponse', XmlService.getNamespace('http://wsdl.cybozu.co.jp/bulletin/2008'))\n      .getChild('returns', XmlService.getNamespace(''))\n      .getChild('categories')\n      .getChild('root');\n    \n//    Logger.log(root+\"\u30eb\u30fc\u30c8\");\n    \n    //category_params\u3092\u591a\u6b21\u5143\u914d\u5217\u306b\u3057\u3066\u914d\u5217\u3092\u8ffd\u52a0\n    //\u30ab\u30c6\u30b4\u30ea\u306e\u30eb\u30fc\u30c8\u306e\u982d\u3092\u53d6\u5f97\uff08\u4ed6\u306f\u30eb\u30fc\u30c8\u306e\u4e2d\u306b\u5b58\u5728\uff09\n    var root_category = [root.getAttribute('id').getValue(),root.getChild('name').getText()],\n        category_params =[root_category];\n    \n//    Logger.log(category_params[0]);\n    \n    //root\u306e\u4e0b\u304b\u3089category(\u914d\u5217)\u3092\u53d6\u5f97\n    var category = root\n     .getChild('categories')\n     .getChildren('category');\n    \n//    Logger.log(category);\n    \n    //category_params\u306b\u5165\u308c\u308b\u5909\u6570\n    var category_id,\n        category_name;\n    \n    //category_id,category_name\u3092\u914d\u5217\u306b\u3057\u3066category_params\u306b\u5165\u308c\u308b\n    for (var i = 0; i < category.length; i++) {\n      category_id = category[i].getAttribute('id').getValue();\n      category_name = category[i].getChild('name').getText();\n      \n//      Logger.log('ID:'+category_id);\n//      Logger.log('NAME:'+category_name);\n      \n      category_params[i+1] = [category_id,category_name];\n      \n    }//for\u6587\u7d42\u308f\u308a\n    \n    \n//    //\u30ed\u30b0\u78ba\u8a8d\u7528for\u6587\n//    for (var i = 0; i < category_params.length; i++) {\n//        Logger.log('CATEGORY:'+category_params[i]);\n//    }\n\n    \n    \n  } catch (e) {\n    Logger.log(e);\n  }\n  //\u591a\u6b21\u5143\u914d\u5217\u3092\u30ea\u30bf\u30fc\u30f3\n  return category_params;\n}\n\n\n\n\n\n\n\n/**\n *Cybouz\u306b\u9001\u308bXML\u306epayload\u90e8\u5206\u3092\u4f5c\u6210\n *@param {payload}  payload(\u30c7\u30fc\u30bf\u672c\u4f53)\n *\n **/\nfunction createXML(API,parameters){\n    //xmlns\u306e\u524d\u306b\u306f\u30b9\u30da\u30fc\u30b9or\u6539\u884c\u304c\u5fc5\u8981\u306a\u306e\u3067\u6ce8\u610f\n    var payload ='<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>'+\n'<SOAP-ENV:Envelope xmlns:SOAP-ENV=\\\"http://www.w3.org/2003/05/soap-envelope\\\"'+\n ' xmlns:xsd=\\\"http://www.w3.org/2001/XMLSchema\\\"'+\n ' xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"'+\n ' xmlns:SOAP-ENC=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\"'+\n ' xmlns:base_services=\\\"http://wsdl.cybozu.co.jp/base/2008\\\">'+\n '<SOAP-ENV:Header>'+\n  '<Action SOAP-ENV:mustUnderstand=\\\"1\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2003/03/addressing\\\">'+\n   API+\n  '</Action>'+\n  '<Security xmlns:wsu=\\\"http://schemas.xmlsoap.org/ws/2002/07/utility\\\"'+\n  'SOAP-ENV:mustUnderstand=\\\"1\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2002/12/secext\\\">'+\n   '<UsernameToken wsu:Id=\\\"id\\\">'+\n    '<Username>UserName</Username>'+\n    '<Password>Password</Password>'+\n   '</UsernameToken>'+\n  '</Security>'+\n  '<Timestamp SOAP-ENV:mustUnderstand=\\\"1\\\" Id=\\\"id\\\"'+\n  ' xmlns=\\\"http://schemas.xmlsoap.org/ws/2002/07/utility\\\">'+\n   '<Created>2010-08-12T14:45:00Z</Created>'+\n   '<Expires>2037-08-12T14:45:00Z</Expires>'+\n  '</Timestamp>'+\n  '<Locale>jp</Locale>'+\n '</SOAP-ENV:Header>'+\n '<SOAP-ENV:Body>'+\n  '<'+API+'>'+\n    parameters+\n  '</'+API+'>'+\n '</SOAP-ENV:Body>'+\n'</SOAP-ENV:Envelope>'\n  \n  return payload;\n}\n\n\n/**\n * \u691c\u7d22\u3067\u30d2\u30c3\u30c8\u3057\u305f\u30e1\u30fc\u30eb\u304b\u3089\u53d6\u308a\u51fa\u3057\u305f\u30c7\u30fc\u30bf\uff08message\uff09\u3068username\u3092\u5f15\u6570\u306b\u3057\n * JSON\u578b\u306b\u30ad\u30e3\u30b9\u30c8\u3057incoming webhocks\u306eurl\u306b\u30c7\u30fc\u30bf\u3092\u6295\u3052\u308b\u95a2\u6570\n *\n * @param {String} message \u63b2\u793a\u677f\u306e\u5185\u5bb9\n * @param {String} username Slack\u3067\u8868\u793a\u3055\u308c\u308bBot\u306e\u540d\u524d\n */\nfunction sendHttpPostSlack(message, username) {\n  //incoming Webhocks\u3067\u53d6\u5f97\u3057\u305furl\u3092\u8a18\u8ff0\n\u3000var postUrl_slack = \"incoming Webhocks\u3067\u53d6\u5f97\u3057\u305furl\";\n  \n  //\u6295\u7a3f\u3057\u305f\u3044slack\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n  var postChannel = \"#\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\";\n\n  var jsonData = {\n    \"channel\": postChannel,\n    \"username\": username,\n    \"text\": message\n  };\n  \n  var payload = JSON.stringify(jsonData);\n  \n  var options = {\n    \"method\": \"post\",\n    \"contentType\": \"application/json\",\n    \"payload\": payload\n  };\n  \n  UrlFetchApp.fetch(postUrl_slack, options); //incoming webhocks\u306b\u30ea\u30af\u30a8\u30b9\u30c8\n}\n\n```\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u4ee5\u4e0a\u3067\u3059\u3002\n\n#\u4f5c\u3063\u3066\u307f\u3066\n\u4eca\u56de\u59cb\u3081\u305f\u5f53\u521d\u306f\u4e3b\u306a\u77e5\u8b58\u304cJava\u3060\u3051\u306e\u72b6\u614b\u3067\u56db\u82e6\u516b\u82e6\u3057\u306a\u304c\u3089\u4f5c\u6210\u3057\u3066\u3044\u307e\u3057\u305f\u3002XML\u3084\u30ac\u30eb\u30fc\u30f3API\u306b\u3064\u3044\u3066\u8abf\u3079\u306a\u304c\u3089\u3084\u308a\u307e\u3057\u305f\u304c\u300c\u30ac\u30eb\u30fc\u30f3API\u306e\u6982\u8981\u300d\u3084\u300cSOAP API\u306e\u5171\u901a\u4ed5\u69d8\u300d\u306e\u30b5\u30a4\u30c8\u3092\u898b\u3066\u3082\u4f55\u304c\u4f55\u3060\u304b\u308f\u304b\u3089\u305a\u4e00\u9031\u9593\u307b\u3069XML\u306e\u9001\u4fe1\u65b9\u6cd5\u3092\u4e2d\u5fc3\u306b\u8272\u3005\u3068\u8abf\u3079\u3066\u3044\u307e\u3057\u305f\u3002XML\u306e\u9001\u4fe1\u65b9\u6cd5\u3055\u3048\u5206\u304b\u308c\u3070\u9001\u4fe1\u3057\u305f\u5024\u3092\u53d6\u5f97\u3057\u3066Slack\u306b\u307e\u305f\u9001\u308b\u3060\u3051\u3067\u3057\u305f\u306e\u3067\u6bd4\u8f03\u7684\u5bb9\u6613\u306b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u305f\u611f\u3058\u3067\u3059\u306d\u3002\n\u3084\u3063\u3066\u307f\u3066\u601d\u3063\u305f\u306e\u306f\u81ea\u5206\u306e\u4e2d\u3067\u4e00\u756a\u306e\u9b3c\u9580\u3060\u3063\u305fXML\u306e\u9001\u4fe1\u3068\u53d6\u5f97\u3055\u3048\u51fa\u6765\u308c\u3070\u5f8c\u306f\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u304b\u3058\u3063\u305f\u4e8b\u306e\u3042\u308b\u4eba\u306a\u3089\u8ab0\u3067\u3082\u7c21\u5358\u306b\u30ac\u30eb\u30fc\u30f3API\u3092\u4f7f\u3048\u308b\u306f\u305a\u3067\u3059\u3002\u30ac\u30eb\u30fc\u30f3API\u3092\u7d39\u4ecb\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u306f\u5c11\u306a\u3044\u306e\u3067\u3053\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u898b\u3066\u304f\u3060\u3055\u3063\u305f\u65b9\u304c\u65b0\u305f\u306b\u4f7f\u3044\u59cb\u3081\u3066\u304f\u3060\u3055\u308c\u3070\u6bb5\u3005\u3068\u5e83\u304c\u3063\u3066\u3044\u304f\u3093\u3058\u3083\u306a\u3044\u304b\u306a\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n\n\n\n\n\n\n\u86c7\u8db3\u3067\u3059\u304c\u2026\n\u3053\u308c\u3088\u308a\u4e0b\u306f\u30ab\u30c6\u30b4\u30ea\u4e00\u89a7\u306eRequest\u30b5\u30f3\u30d7\u30eb\u3068Response\u30b5\u30f3\u30d7\u30eb\u3068\u305d\u306e\u4ed6\u306e\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u30b5\u30a4\u30c8\u306b\u3064\u3044\u3066\u3067\u3059\u3002\u8208\u5473\u304c\u3042\u3063\u305f\u3089\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\n#Request\u30b5\u30f3\u30d7\u30eb\n\u203b\u4e0b\u306eURL\u306ebulletin\u306e\u90e8\u5206\u306f\u81ea\u5206\u304c\u4f7f\u3044\u305f\u3044API\u306e\u6a5f\u80fd\u540d\nhttps://\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540d.cybozu.com/g/cbpapi/bulletin/api.csp?\nPOST\nContent-Type \u306f application/XML\n\n```lang:\u4f8b\uff09\u30ab\u30c6\u30b4\u30ea\u4e00\u89a7request\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://www.w3.org/2003/05/soap-envelope\"\n xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\"\n xmlns:base_services=\"http://wsdl.cybozu.co.jp/base/2008\">\n  <SOAP-ENV:Header>\n    <Action SOAP-ENV:mustUnderstand=\"1\"\n     xmlns=\"http://schemas.xmlsoap.org/ws/2003/03/addressing\">\n      BulletinGetCategories\n    </Action>\n    <Security xmlns:wsu=\"http://schemas.xmlsoap.org/ws/2002/07/utility\"\n     SOAP-ENV:mustUnderstand=\"1\"\n     xmlns=\"http://schemas.xmlsoap.org/ws/2002/12/secext\">\n      <UsernameToken wsu:Id=\"id\">\n        <Username>UserName</Username>\n        <Password>Password</Password>\n      </UsernameToken>\n    </Security>\n    <Timestamp SOAP-ENV:mustUnderstand=\"1\" Id=\"id\"\n     xmlns=\"http://schemas.xmlsoap.org/ws/2002/07/utility\">\n      <Created>2010-08-12T14:45:00Z</Created>\n      <Expires>2030-08-12T14:45:00Z</Expires>\n    </Timestamp>\n    <Locale>jp</Locale>\n  </SOAP-ENV:Header>\n  <SOAP-ENV:Body>\n    <BulletinGetCategories>\n    </BulletinGetCategories>\n  </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>\n```\n#Response\u30b5\u30f3\u30d7\u30eb\n\n```lang:\u4f8b\uff09\u30ab\u30c6\u30b4\u30ea\u4e00\u89a7Response\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<soap:Envelope>\n <soap:Header>\n  <vendor>Cybozu</vendor>\n  <product>Garoon</product>\n  <product_type>2</product_type>\n  <version>4.2.0</version>\n  <apiversion>1.6.0</apiversion>\n </soap:Header>\n <soap:Body>\n  <bulletin:BulletinGetCategoriesResponse>\n   <returns>\n    <categories>\n     <root id=\"1\" code=\"ROOT_CATEGORY\">\n      <name>ABCBBS</name>\n      <description />\n      <creator_id />\n      <creator_login_name />\n      <creator_display_name>Administrator</creator_display_name>\n      <create_time>2015-02-13T16:31:26+0900</create_time>\n      <modifier_id>2</modifier_id>\n      <modifier_login_name>UserName</modifier_login_name>\n      <modifier_display_name>UserName</modifier_display_name>\n      <modify_time>2015-06-16T09:48:02+0900</modify_time>\n      <categories parent_id=\"1\" parent_code=\"ROOT_CATEGORY\">\n       <category id=\"2\" code=\"557f706728fa62.97945938\" list_index=\"2147483647\">\n        <name>\u52e4\u6020\u95a2\u9023</name>\n        <description />\n        <creator_id>2</creator_id>\n        <creator_login_name>UserName</creator_login_name>\n        <creator_display_name>UserName</creator_display_name>\n        <create_time>2015-06-16T09:40:26+0900</create_time>\n        <modifier_id>2</modifier_id>\n        <modifier_login_name>UserName</modifier_login_name>\n        <modifier_display_name>UserName</modifier_display_name>\n        <modify_time>2015-06-16T09:40:26+0900</modify_time>\n       </category>\n       <category id=\"3\" code=\"557f707d39b4a4.08727840\" list_index=\"2147483647\">\n        <name>News\u30fb\u60c5\u5831\u9023\u643a\u7b49</name>\n        <description />\n        <creator_id>2</creator_id>\n        <creator_login_name>UserName</creator_login_name>\n        <creator_display_name>UserName</creator_display_name>\n        <create_time>2015-06-16T09:41:24+0900</create_time>\n        <modifier_id>2</modifier_id>\n        <modifier_login_name>UserName</modifier_login_name>\n        <modifier_display_name>UserName</modifier_display_name>\n        <modify_time>2015-06-16T09:42:21+0900</modify_time>\n       </category>\n      </categories>\n     </root>\n    </categories>\n   </returns>\n  </bulletin:BulletinGetCategoriesResponse>\n </soap:Body>\n</soap:Envelope>\n\n```\n\u4e0a\u8a18\u306e\u5834\u5408\u3067\u300ccategory\u300d\u3092\u53d6\u5f97\u3059\u308b\u969b\u306b.getChildren()\u3092\u4f7f\u3046\u3068\u914d\u5217\u3067\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\u52e4\u6020\u95a2\u9023category\u306e\u4e2d\u306e\u300cid\u300d\u3084\u300cname\u300d\u3092\u53d6\u5f97\u3059\u308b\u969b\u306f\u305d\u308c\u305e\u308c\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n```\n      category_id = category[0].getAttribute('id').getValue();\n      category_name = category[0].getChild('name').getText();\n```\n\n#\u305d\u306e\u4ed6\u306b\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\n - Google Developers UrlFetchApp\n  - https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app#fetch(String,Object)\n - Google Developers XmlService\n  - https://developers.google.com/apps-script/reference/xml-service/xml-service\n - \u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u65b9\u306eGitHub\n  - https://gist.github.com/hagino3000/1145727 \n"}