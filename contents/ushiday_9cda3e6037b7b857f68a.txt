{"context": " More than 1 year has passed since last update.\u5148\u65e5IBM i\u306eTR3\uff08\u30c6\u30af\u30ce\u30ed\u30b8\u30fc\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\uff09\u304c\u3001\u767a\u8868\u3055\u308c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u307e\u3057\u305f\u3002\n\u305d\u306e\u4e2d\u3067\u3001SQL\u6587\u306b\u3066LIMIT OFFSET\u304c\u4f7f\u3048\u308b\u69d8\u306b\u306a\u3063\u305f\u3068\u6709\u3063\u305f\u306e\u3067\u3001\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u30b5\u30f3\u30d7\u30eb\u306f\u4ee5\u4e0b\u306e\u30bd\u30fc\u30b9\u3067\u3059\n\nSQLFET1.rpgle\n     H DATEDIT(*YMD)\n     H COPYRIGHT('(C) CHUBU SYSTEM CO,.LTD 1996 - ')\n      /IF DEFINED(*CRTBNDRPG)\n     H DFTACTGRP(*NO) ACTGRP(*CALLER)\n      /ENDIF\n     D*-----<<\u30e1\u30a4\u30f3\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u30fb\u30d7\u30ed\u30c8\u30bf\u30a4\u30d7\u5b9a\u7fa9>>-----*\n     D*-----<<\u30b5\u30d6\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u30fb\u30d7\u30ed\u30c8\u30bf\u30a4\u30d7>>-----*\n     D OPEN_CURSOR     PR              N\n     D FETCH_CURSOR    PR              N\n     D CLOSE_CURSOR    PR              N\n     D*-----<<\u5909\u6570>>-----*\n     D******************************************************************\n     D*\n     C*-\u0082-----------------------------------------------------------------*\n     C*-\u0082--------<<  FREE FORMAT                                 >>-------*\n     C*-\u0082-----------------------------------------------------------------*\n      /FREE\n\n           // 1\u884c\u305a\u3064\u306eFETCH (NEXT:\u9806\u8aad\u307f)\n           IF NOT OPEN_CURSOR() ;\n              // OPEN ERROR DEFINED\n               DSPLY ('CURSOR OPEN ERROR')  ;\n           ELSE ;\n               DOW FETCH_CURSOR() ;\n               ENDDO ;\n               CLOSE_CURSOR() ;\n           ENDIF ;\n\n           *INLR = *ON ;\n           RETURN      ;\n\n      /END-FREE\n\n     P****************************************************************\n     P** < OPEN_CURSOR  > :\u30ab\u30fc\u30bd\u30eb\u30aa\u30fc\u30d7\u30f3\u51e6\u7406                   **\n     P**------------------------------------------------------------**\n     P**          RETURN  : *ON=\u6b63\u5e38\u30aa\u30fc\u30d7\u30f3,*OFF=\u30a8\u30e9\u30fc        **\n     P**------------------------------------------------------------**\n     P****************************************************************\n     P OPEN_CURSOR     B\n     D OPEN_CURSOR     PI              N\n     D*<\u5909\u6570>\n     D RETURN_VAR      S               N\n      /FREE\n\n              //\u30ab\u30fc\u30bd\u30eb\u5b9a\u7fa9\n              EXEC SQL        DECLARE C1 CURSOR FOR\n                              SELECT *\n                              FROM USHIDA/ITEM\n                              ORDER BY CODE\n                              LIMIT 10 OFFSET 5 ;\n\n              //\u30ab\u30fc\u30bd\u30eb\u30aa\u30fc\u30d7\u30f3\n              EXEC SQL        OPEN C1           ;\n              IF SQLSTT = '00000' ;   // 00000:\u64cd\u4f5c\u6b63\u5e38\u7d42\u4e86\n                   RETURN_VAR = *ON ;\n              ELSE  ;\n                   RETURN_VAR = *OFF;\n              ENDIF ;\n\n              RETURN RETURN_VAR ;\n\n      /END-FREE\n     P                 E\n     P****************************************************************\n     P** < FETCH_CURSOR > :\u30ab\u30fc\u30bd\u30eb\u8aad\u53d6\u51e6\u7406                       **\n     P**------------------------------------------------------------**\n     P**          RETURN  : *ON=\u6b63\u5e38\u8aad\u53d6,*OFF=\uff25\uff2f\uff26\u53c8\u306f\u30a8\u30e9\u30fc  **\n     P**------------------------------------------------------------**\n     P****************************************************************\n     P FETCH_CURSOR    B\n     D FETCH_CURSOR    PI              N\n     D*<\u5909\u6570>\n     D RETURN_VAR      S               N\n     D ROW           E DS                  EXTNAME(ITEM)\n     D                                     QUALIFIED\n     D LINE            S             40A\n      /FREE\n\n              //\u30ab\u30fc\u30bd\u30eb\u8aad\u307f\u8fbc\u307f\n              EXEC SQL        FETCH NEXT FROM C1 INTO :ROW ;\n              SELECT ;\n              WHEN SQLSTT = '00000' ;   // 00000:\u64cd\u4f5c\u6b63\u5e38\u7d42\u4e86\n                  LINE =  %CHAR(ROW.CODE) + ' ' +  ROW.NAME    ;\n                  DSPLY ( LINE  )  ;\n                  RETURN_VAR = *ON  ;\n              WHEN SQLSTT = '02000' ;   // 02000:\uff25\uff2f\uff26\n               // DSPLY (SQLSTT)  ;\n                  RETURN_VAR = *OFF ;\n              OTHER ;                           //\n               // DSPLY (SQLSTT)  ;\n                  RETURN_VAR = *OFF ;\n              ENDSL ;\n\n              RETURN RETURN_VAR ;\n\n      /END-FREE\n     P                 E\n     P****************************************************************\n     P** < CLOSE_CURSOR > :\u30ab\u30fc\u30bd\u30eb\u30af\u30ed\u30fc\u30ba\u51e6\u7406                   **\n     P**------------------------------------------------------------**\n     P**          RETURN  : *ON=\u6b63\u5e38\u30af\u30ed\u30fc\u30ba.*OFF=\u30a8\u30e9\u30fc        **\n     P**------------------------------------------------------------**\n     P****************************************************************\n     P CLOSE_CURSOR    B\n     D CLOSE_CURSOR    PI              N\n     D*<\u5909\u6570>\n     D RETURN_VAR      S               N\n      /FREE\n              //\u30ab\u30fc\u30bd\u30eb\u30af\u30ed\u30fc\u30ba\n              EXEC SQL        CLOSE C1          ;\n              SELECT ;\n              WHEN SQLSTT = '00000' ;   // 00000:\u64cd\u4f5c\u6b63\u5e38\u7d42\u4e86\n                  RETURN_VAR = *ON  ;\n              OTHER ;                           //\n                  RETURN_VAR = *OFF ;\n              ENDSL ;\n\n              RETURN RETURN_VAR ;\n\n      /END-FREE\n     P                 E \n\n\n\u25cfSQLRPG\u5b9f\u884c\u7d50\u679c\u306e\u753b\u9762\u30b7\u30e7\u30c3\u30c8\n\n\u958b\u59cb\u30b3\u30fc\u30c9\u304c6\u304b\u308910\u4ef6\u53d6\u5f97\u51fa\u6765\u3066\u3044\u308b\u306e\u3067\u3001RPG\u3067\u4f7f\u3048\u3066\u307e\u3059\u3002\ni\u30ca\u30d3\u3067\u3082\u4f7f\u3048\u307e\u3057\u305f\u304c\u3001STRSQL\u3067\u306f\u4f55\u6545\u304bLIMIT\u306e\u307f\u3067OFFSET\u3092\u6307\u5b9a\u3059\u308b\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nWeb\u3067\u4f7f\u7528\u3059\u308b\u6642\u306f\u3001\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u30e9\u30c3\u30d7\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u610f\u8b58\u3057\u306a\u3044\u3067\u3059\u304c\u3002\n\u25cfi\u30ca\u30d3\u306e\u5b9f\u884c\u753b\u9762\n\n\u25cfSTRSQL\u306e\u5b9f\u884c\u753b\u9762\n\n\u5148\u65e5IBM i\u306eTR3\uff08\u30c6\u30af\u30ce\u30ed\u30b8\u30fc\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\uff09\u304c\u3001\u767a\u8868\u3055\u308c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u307e\u3057\u305f\u3002\n\u305d\u306e\u4e2d\u3067\u3001SQL\u6587\u306b\u3066LIMIT OFFSET\u304c\u4f7f\u3048\u308b\u69d8\u306b\u306a\u3063\u305f\u3068\u6709\u3063\u305f\u306e\u3067\u3001\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u30b5\u30f3\u30d7\u30eb\u306f\u4ee5\u4e0b\u306e\u30bd\u30fc\u30b9\u3067\u3059\n\n```ILE-RPG:SQLFET1.rpgle\n     H DATEDIT(*YMD)\n     H COPYRIGHT('(C) CHUBU SYSTEM CO,.LTD 1996 - ')\n      /IF DEFINED(*CRTBNDRPG)\n     H DFTACTGRP(*NO) ACTGRP(*CALLER)\n      /ENDIF\n     D*-----<<\u30e1\u30a4\u30f3\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u30fb\u30d7\u30ed\u30c8\u30bf\u30a4\u30d7\u5b9a\u7fa9>>-----*\n     D*-----<<\u30b5\u30d6\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u30fb\u30d7\u30ed\u30c8\u30bf\u30a4\u30d7>>-----*\n     D OPEN_CURSOR     PR              N\n     D FETCH_CURSOR    PR              N\n     D CLOSE_CURSOR    PR              N\n     D*-----<<\u5909\u6570>>-----*\n     D******************************************************************\n     D*\n     C*-\u0082-----------------------------------------------------------------*\n     C*-\u0082--------<<  FREE FORMAT                                 >>-------*\n     C*-\u0082-----------------------------------------------------------------*\n      /FREE\n\n           // 1\u884c\u305a\u3064\u306eFETCH (NEXT:\u9806\u8aad\u307f)\n           IF NOT OPEN_CURSOR() ;\n              // OPEN ERROR DEFINED\n               DSPLY ('CURSOR OPEN ERROR')  ;\n           ELSE ;\n               DOW FETCH_CURSOR() ;\n               ENDDO ;\n               CLOSE_CURSOR() ;\n           ENDIF ;\n\n           *INLR = *ON ;\n           RETURN      ;\n\n      /END-FREE\n\n     P****************************************************************\n     P** < OPEN_CURSOR  > :\u30ab\u30fc\u30bd\u30eb\u30aa\u30fc\u30d7\u30f3\u51e6\u7406                   **\n     P**------------------------------------------------------------**\n     P**          RETURN  : *ON=\u6b63\u5e38\u30aa\u30fc\u30d7\u30f3,*OFF=\u30a8\u30e9\u30fc        **\n     P**------------------------------------------------------------**\n     P****************************************************************\n     P OPEN_CURSOR     B\n     D OPEN_CURSOR     PI              N\n     D*<\u5909\u6570>\n     D RETURN_VAR      S               N\n      /FREE\n\n              //\u30ab\u30fc\u30bd\u30eb\u5b9a\u7fa9\n              EXEC SQL        DECLARE C1 CURSOR FOR\n                              SELECT *\n                              FROM USHIDA/ITEM\n                              ORDER BY CODE\n                              LIMIT 10 OFFSET 5 ;\n\n              //\u30ab\u30fc\u30bd\u30eb\u30aa\u30fc\u30d7\u30f3\n              EXEC SQL        OPEN C1           ;\n              IF SQLSTT = '00000' ;   // 00000:\u64cd\u4f5c\u6b63\u5e38\u7d42\u4e86\n                   RETURN_VAR = *ON ;\n              ELSE  ;\n                   RETURN_VAR = *OFF;\n              ENDIF ;\n\n              RETURN RETURN_VAR ;\n\n      /END-FREE\n     P                 E\n     P****************************************************************\n     P** < FETCH_CURSOR > :\u30ab\u30fc\u30bd\u30eb\u8aad\u53d6\u51e6\u7406                       **\n     P**------------------------------------------------------------**\n     P**          RETURN  : *ON=\u6b63\u5e38\u8aad\u53d6,*OFF=\uff25\uff2f\uff26\u53c8\u306f\u30a8\u30e9\u30fc  **\n     P**------------------------------------------------------------**\n     P****************************************************************\n     P FETCH_CURSOR    B\n     D FETCH_CURSOR    PI              N\n     D*<\u5909\u6570>\n     D RETURN_VAR      S               N\n     D ROW           E DS                  EXTNAME(ITEM)\n     D                                     QUALIFIED\n     D LINE            S             40A\n      /FREE\n\n              //\u30ab\u30fc\u30bd\u30eb\u8aad\u307f\u8fbc\u307f\n              EXEC SQL        FETCH NEXT FROM C1 INTO :ROW ;\n              SELECT ;\n              WHEN SQLSTT = '00000' ;   // 00000:\u64cd\u4f5c\u6b63\u5e38\u7d42\u4e86\n                  LINE =  %CHAR(ROW.CODE) + ' ' +  ROW.NAME    ;\n                  DSPLY ( LINE  )  ;\n                  RETURN_VAR = *ON  ;\n              WHEN SQLSTT = '02000' ;   // 02000:\uff25\uff2f\uff26\n               // DSPLY (SQLSTT)  ;\n                  RETURN_VAR = *OFF ;\n              OTHER ;                           //\n               // DSPLY (SQLSTT)  ;\n                  RETURN_VAR = *OFF ;\n              ENDSL ;\n\n              RETURN RETURN_VAR ;\n\n      /END-FREE\n     P                 E\n     P****************************************************************\n     P** < CLOSE_CURSOR > :\u30ab\u30fc\u30bd\u30eb\u30af\u30ed\u30fc\u30ba\u51e6\u7406                   **\n     P**------------------------------------------------------------**\n     P**          RETURN  : *ON=\u6b63\u5e38\u30af\u30ed\u30fc\u30ba.*OFF=\u30a8\u30e9\u30fc        **\n     P**------------------------------------------------------------**\n     P****************************************************************\n     P CLOSE_CURSOR    B\n     D CLOSE_CURSOR    PI              N\n     D*<\u5909\u6570>\n     D RETURN_VAR      S               N\n      /FREE\n              //\u30ab\u30fc\u30bd\u30eb\u30af\u30ed\u30fc\u30ba\n              EXEC SQL        CLOSE C1          ;\n              SELECT ;\n              WHEN SQLSTT = '00000' ;   // 00000:\u64cd\u4f5c\u6b63\u5e38\u7d42\u4e86\n                  RETURN_VAR = *ON  ;\n              OTHER ;                           //\n                  RETURN_VAR = *OFF ;\n              ENDSL ;\n\n              RETURN RETURN_VAR ;\n\n      /END-FREE\n     P                 E \n```\n\n\u25cfSQLRPG\u5b9f\u884c\u7d50\u679c\u306e\u753b\u9762\u30b7\u30e7\u30c3\u30c8\n![2015-12-01_134150.png](https://qiita-image-store.s3.amazonaws.com/0/100029/62e92119-bc6c-8831-4736-6c7801b3c8c1.png)\n\n\n\u958b\u59cb\u30b3\u30fc\u30c9\u304c6\u304b\u308910\u4ef6\u53d6\u5f97\u51fa\u6765\u3066\u3044\u308b\u306e\u3067\u3001RPG\u3067\u4f7f\u3048\u3066\u307e\u3059\u3002\ni\u30ca\u30d3\u3067\u3082\u4f7f\u3048\u307e\u3057\u305f\u304c\u3001STRSQL\u3067\u306f\u4f55\u6545\u304bLIMIT\u306e\u307f\u3067OFFSET\u3092\u6307\u5b9a\u3059\u308b\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nWeb\u3067\u4f7f\u7528\u3059\u308b\u6642\u306f\u3001\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u30e9\u30c3\u30d7\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u610f\u8b58\u3057\u306a\u3044\u3067\u3059\u304c\u3002\n\n\u25cfi\u30ca\u30d3\u306e\u5b9f\u884c\u753b\u9762\n![2015-12-01_135036.png](https://qiita-image-store.s3.amazonaws.com/0/100029/ef3bbad6-4469-3bc5-c0b0-8fafa6e73937.png)\n\n\u25cfSTRSQL\u306e\u5b9f\u884c\u753b\u9762\n![2015-12-01_135155.png](https://qiita-image-store.s3.amazonaws.com/0/100029/f6a21446-7203-8d65-d36d-58075e3ca9ba.png)\n", "tags": ["IBMi", "RPG", "db2", "SQL"]}