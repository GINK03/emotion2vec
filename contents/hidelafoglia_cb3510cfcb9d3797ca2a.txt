{"tags": ["Xamarin", "Mac", "CoreAnimation"], "context": " More than 1 year has passed since last update.\nWindow\u3092\u3086\u3089\u3059\u4e8b\u306f\u3067\u304d\u308b\u304c\u6b62\u3081\u65b9\u304c\u3088\u304f\u308f\u304b\u3089\u306a\u3044\n\nWindowDidLoad() \u3067\u3086\u3089\u3059:\n\n    public partial class MainWindowController : MonoMac.AppKit.NSWindowController\n    {\n        //....\n\n        public override void WindowDidLoad ()\n        {\n            base.WindowDidLoad ();\n\n            Shake();\n        }\n\n\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u30bb\u30c3\u30c8\u3057\u3066\u3001 Window\u3092\u79fb\u52d5\u3059\u308b\u3068\u63fa\u308c\u308b\u3002\n\n        void Shake()\n        {\n            var key = new NSString (@\"frameOrigin\");\n            var animation = CreateShakeAnimation (this.Window.Frame);\n            var animations =  NSDictionary.FromObjectAndKey (animation, key);\n\n            Window.Animations = animations;\n\n            ((NSWindow)this.Window.Animator).SetFrameOrigin(\n                Window.Frame.Location); \n\n        }\n\n\u3086\u3089\u3059\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n\n        CAKeyFrameAnimation CreateShakeAnimation(\n            RectangleF frame, \n            int shakes = 100,\n            float swing = 0.02f,\n            float duration = 10.0f\n        )\n        {\n            var shakePath = new CGPath();\n\n            shakePath.MoveToPoint(frame.GetMinX(), frame.GetMinY());\n\n            for (int index = 0; index < shakes; index++)\n            {\n                shakePath.CGPathAddLineToPoint(\n                    frame.GetMinX() - frame.Size.Width * swing, frame.GetMinY());\n\n                shakePath.CGPathAddLineToPoint(\n                    frame.GetMinX() + frame.Size.Width * swing, frame.GetMinY());\n            }\n\n            shakePath.CloseSubpath();\n\n            return new CAKeyFrameAnimation () {\n                Path = shakePath,\n                Duration = duration\n            };\n        }\n\n\n\n- Window\u3092\u3086\u3089\u3059\u4e8b\u306f\u3067\u304d\u308b\u304c\u6b62\u3081\u65b9\u304c\u3088\u304f\u308f\u304b\u3089\u306a\u3044\n\nWindowDidLoad() \u3067\u3086\u3089\u3059:\n\n~~~csharp\n\n\tpublic partial class MainWindowController : MonoMac.AppKit.NSWindowController\n\t{\n\t    //....\n\n\t\tpublic override void WindowDidLoad ()\n\t\t{\n\t\t\tbase.WindowDidLoad ();\n\n            Shake();\n\t\t}\n~~~\n\n\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u3063\u3066\u30bb\u30c3\u30c8\u3057\u3066\u3001 Window\u3092\u79fb\u52d5\u3059\u308b\u3068\u63fa\u308c\u308b\u3002\n\n~~~csharp\n\t\t\t\t\n        void Shake()\n\t\t{\n\t\t\tvar key = new NSString (@\"frameOrigin\");\n\t\t\tvar animation = CreateShakeAnimation (this.Window.Frame);\n\t\t\tvar animations =  NSDictionary.FromObjectAndKey (animation, key);\n\n\t\t\tWindow.Animations = animations;\n\n\t\t\t((NSWindow)this.Window.Animator).SetFrameOrigin(\n\t\t\t\tWindow.Frame.Location);\t\n\t\t\t\t\t\t\t\t\t\t\n\t\t}\n~~~\n\n\u3086\u3089\u3059\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306e\u4f5c\u6210\n\n~~~ csharp\n\n\t\tCAKeyFrameAnimation CreateShakeAnimation(\n\t\t\tRectangleF frame, \n\t\t\tint shakes = 100,\n\t\t\tfloat swing = 0.02f,\n\t\t\tfloat duration = 10.0f\n\t\t)\n\t\t{\n\t\t\tvar shakePath = new CGPath();\n\n\t\t\tshakePath.MoveToPoint(frame.GetMinX(), frame.GetMinY());\n\n\t\t\tfor (int index = 0; index < shakes; index++)\n\t\t\t{\n\t\t\t\tshakePath.CGPathAddLineToPoint(\n\t\t\t\t\tframe.GetMinX() - frame.Size.Width * swing, frame.GetMinY());\n\n\t\t\t\tshakePath.CGPathAddLineToPoint(\n\t\t\t\t\tframe.GetMinX() + frame.Size.Width * swing, frame.GetMinY());\n\t\t\t}\n\n\t\t\tshakePath.CloseSubpath();\n\n\t\t\treturn new CAKeyFrameAnimation () {\n\t\t\t\tPath = shakePath,\n\t\t\t\tDuration = duration\n\t\t\t};\n\t\t}\n\n~~~\n\t\t\n"}