{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nRuby\u3092\u4f7f\u7528\u3057\u3066\u7c21\u5358\u306bSQLServer\u306e\u30b9\u30c8\u30a2\u30c9\u3092\u547c\u3073\u51fa\u3059\u3002\n\n\u3084\u308a\u305f\u3044\u3053\u3068\nRuby\u3092\u4f7f\u7528\u3057\u3066SQLServer\u306e\u30b9\u30c8\u30a2\u30c9(usp_read_m_user)\u3092\u4f7f\u7528\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u30de\u30b9\u30bf\u3092\u53c2\u7167\u3059\u308b\u3002\nm_user\u306e\u30c6\u30fc\u30d6\u30eb\u69cb\u9020\n\n\n\nUserID\nUserName\n\n\n\n\n00000001\n\u85e4\u6cbc\u609f\n\n\n00000002\n\u96db\u6708\u52a0\u4ee3\n\n\n\n\n\u74b0\u5883\n\nWindows 8.1 \nRuby 2.1.5p273\nSQLServer 2008R2\nactiverecord-sqlserver-adapter (3.2.12)\ntiny_tds (0.6.1 x86-mingw32)\n\n1.\u30b9\u30c8\u30a2\u30c9\n\n\u30b9\u30c8\u30a2\u30c9\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u30fc\nCREATE PROCEDURE [dbo].[usp_read_m_user]\n@UserId nvarchar(10)\nAS\nBEGIN\n    SELECT * FROM m_user\n    WHERE UserID = @UserID;\nEND\n\n\n2.GemFile\n\nGemFile\nsource \"https://rubygems.org\"\n\ngem 'activerecord-sqlserver-adapter', '3.2.12'\ngem 'tiny_tds', '0.6.1'\n\n\n3.database.yml\n\ndatabase.yml\ndevelopment:\n  adapter:  \"sqlserver\"\n  host:     \"\u30db\u30b9\u30c8\u540d(\u7aef\u672b\u540d,IP\u30a2\u30c9\u30ec\u30b9\u7b49)\"\n  username: \"\u30e6\u30fc\u30b6\u30fc\u540d\"\n  password: \"\u30d1\u30b9\u30ef\u30fc\u30c9\"\n  database: \"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\"\n\n\n4.\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\n\napp.rb\n# coding:utf-8\nrequire 'activerecord-sqlserver-adapter'\nrequire 'tiny_tds'\n\nActiveRecord::Base.configurations = YAML.load_file('database.yml')\nActiveRecord::Base.establish_connection(:development)\nuse ActiveRecord::ConnectionAdapters::ConnectionManagement\n\ndef readData\n    rtns = ActiveRecord::Base.execute_procedure :usp_read_m_user, UserId: '00000002'\n    rtns.each do |r|\n        r.each{|key,value|\n            puts key,value\n        }\n    end\nend\n\n\n\n\u69cb\u6587\nActiveRecord::Base.execute_procedure :\u30b9\u30c8\u30a2\u30c9\u540d, \u30d1\u30e9\u30e1\u30fc\u30bf1, \u30d1\u30e9\u30e1\u30fc\u30bf2, \u30d1\u30e9\u30e1\u30fc\u30bf3\n\u53c8\u306f\nActiveRecord::Base.execute_procedure :\u30b9\u30c8\u30a2\u30c9\u540d, named: \u30d1\u30e9\u30e1\u30fc\u30bf\n5.\u5b9f\u884c\u7d50\u679c\n\n\u53c2\u8003:activerecord-sqlserver-adapter\n##\u6982\u8981\nRuby\u3092\u4f7f\u7528\u3057\u3066\u7c21\u5358\u306bSQLServer\u306e\u30b9\u30c8\u30a2\u30c9\u3092\u547c\u3073\u51fa\u3059\u3002\n##\u3084\u308a\u305f\u3044\u3053\u3068\nRuby\u3092\u4f7f\u7528\u3057\u3066SQLServer\u306e\u30b9\u30c8\u30a2\u30c9(usp_read_m_user)\u3092\u4f7f\u7528\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u30de\u30b9\u30bf\u3092\u53c2\u7167\u3059\u308b\u3002\n\nm_user\u306e\u30c6\u30fc\u30d6\u30eb\u69cb\u9020\n\n| UserID | UserName |\n|:-----------|------------:|\n| 00000001     |      \u85e4\u6cbc\u609f |\n| 00000002     |    \u96db\u6708\u52a0\u4ee3| \n\n##\u74b0\u5883\n* Windows 8.1 \n* Ruby 2.1.5p273\n* SQLServer 2008R2\n* activerecord-sqlserver-adapter (3.2.12)\n* tiny_tds (0.6.1 x86-mingw32)\n\n1.\u30b9\u30c8\u30a2\u30c9\n\n```tsql:\u30b9\u30c8\u30a2\u30c9\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u30fc\nCREATE PROCEDURE [dbo].[usp_read_m_user]\n@UserId nvarchar(10)\nAS\nBEGIN\n\tSELECT * FROM m_user\n\tWHERE UserID = @UserID;\nEND\n```\n\n2.GemFile\n\n```ruby:GemFile\nsource \"https://rubygems.org\"\n\ngem 'activerecord-sqlserver-adapter', '3.2.12'\ngem 'tiny_tds', '0.6.1'\n```\n\n3.database.yml\n\n```ruby:database.yml\ndevelopment:\n  adapter:  \"sqlserver\"\n  host:     \"\u30db\u30b9\u30c8\u540d(\u7aef\u672b\u540d,IP\u30a2\u30c9\u30ec\u30b9\u7b49)\"\n  username: \"\u30e6\u30fc\u30b6\u30fc\u540d\"\n  password: \"\u30d1\u30b9\u30ef\u30fc\u30c9\"\n  database: \"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\"\n```\n\n4.\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\n\n```ruby:app.rb\n# coding:utf-8\nrequire 'activerecord-sqlserver-adapter'\nrequire 'tiny_tds'\n\nActiveRecord::Base.configurations = YAML.load_file('database.yml')\nActiveRecord::Base.establish_connection(:development)\nuse ActiveRecord::ConnectionAdapters::ConnectionManagement\n\ndef readData\n    rtns = ActiveRecord::Base.execute_procedure :usp_read_m_user, UserId: '00000002'\n\trtns.each do |r|\n\t\tr.each{|key,value|\n\t\t\tputs key,value\n\t\t}\n\tend\nend\n```\n####\u69cb\u6587\n**ActiveRecord::Base.execute_procedure :\u30b9\u30c8\u30a2\u30c9\u540d, \u30d1\u30e9\u30e1\u30fc\u30bf1, \u30d1\u30e9\u30e1\u30fc\u30bf2, \u30d1\u30e9\u30e1\u30fc\u30bf3**\n\u53c8\u306f\n**ActiveRecord::Base.execute_procedure :\u30b9\u30c8\u30a2\u30c9\u540d, named: \u30d1\u30e9\u30e1\u30fc\u30bf**\n\n5.\u5b9f\u884c\u7d50\u679c\n\n![\u540d\u79f0\u672a\u8a2d\u5b9a-1.jpg](https://qiita-image-store.s3.amazonaws.com/0/29940/c51df1ec-84ce-5c4c-ae42-766db39cb4de.jpeg)\n\n\u53c2\u8003:[activerecord-sqlserver-adapter](https://github.com/rails-sqlserver/activerecord-sqlserver-adapter \"activerecord-sqlserver-adapter\")\n\n", "tags": ["Ruby2.1.5", "SQLServer2008R2", "Windows8.1", "Transact-SQL"]}