{"tags": ["shell", "awk", "ShellScript"], "context": " More than 1 year has passed since last update.awk\u306e\u52c9\u5f37\u3092\u3057\u3066\u3044\u308b\u3068\u3001\u30b7\u30a7\u30eb\u64cd\u4f5c\u8ab2\u984c (cut, sort, uniq \u306a\u3069\u3067\u96c6\u8a08\u3092\u884c\u3046) \u8a2d\u554f\u7de8\u3092\u898b\u3064\u3051\u305f\u306e\u3067\u51fa\u6765\u308b\u3060\u3051awk\u3092\u4f7f\u3063\u3066\u89e3\u3044\u3066\u307f\u305f\u3002\n\n\u554f\u984c\u30d5\u30a1\u30a4\u30eb\nserver1,1343363124,30,/video.php\nserver2,1343363110,20,/profile.php\nserver3,1343363115,7,/login.php\nserver1,1343363105,8,/profile.php\nserver2,1343363205,35,/profile.php\nserver2,1343363110,20,/profile.php\nserver3,1343363205,30,/login.php\nserver4,1343363225,12,/video.php\nserver1,1343363265,7,/video.php\n\n\n\u554f1 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\n\u30d5\u30a1\u30a4\u30eb\u5168\u4f53\u306e\u8868\u793a\n\n$ awk '{print}' sample\n\n\n\u554f2 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30b5\u30fc\u30d0\u30fc\u540d\u3068\u30a2\u30af\u30bb\u30b9\u5148\u3060\u3051\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\nserver1,/video.php \nserver2,/profile.php\nserver2,/login.php  \nserver1,/profile.php \nserver2,/profile.php \nserver2,/profile.php\nserver3,/login.php \nserver4,/video.php \nserver1,/video.php \n\n$ awk -F '[,]' '{print $1, $4}' sample\n\n\n\u554f3 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089server4\u306e\u884c\u3060\u3051\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\nserver4,1343363225,12,/video.php \n\n$ awk '/server4/' sample\n\n\n\u554f4 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u884c\u6570\u3092\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\n9\n\n$ awk '{print}' sample | wc -l\n\n\n\u554f5 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u30b5\u30fc\u30d0\u30fc\u540d\u3001\u30e6\u30fc\u30b6\u30fcID\u306e\u6607\u9806\u30675\u884c\u3060\u3051\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\nserver1,1343363265,7,/video.php\nserver1,1343363105,8,/profile.php\nserver1,1343363124,30,/video.php\nserver2,1343363110,20,/profile.php\nserver2,1343363110,20,/profile.php\n\n$ sort -k1,1 -k3,3n -t\",\" sample | awk 'NR<6'\n\n\n\u554f6 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u91cd\u8907\u884c\u304c\u3042\u308b\u3002\u91cd\u8907\u884c\u306f\u307e\u3068\u3081\u3066\u6570\u3048\u884c\u6570\u3092\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c\uff1a\n8\n\n\u88dc\u8db3\uff1a\nhoge,30\nfoo,20\nhoge,30 \n\u3060\u3063\u305f\u3089\uff12\u884c\u3068\u6570\u3048\u308b\u3002\n\n$ awk '{a[$0]=$0} END {print length(a)}' sample\n\n\n\u554f7 \u3053\u306e\u30ed\u30b0\u306eUU(\u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc)\u6570\u3092\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c\uff1a   6\n$ awk -F'[,]' '{print $3}' sample | sort | uniq | wc -l\n\n$ awk -F'[,]' '{print $3}' sample | awk '{a[$0] = $0} END {print length(a)}'\n\n\n\u554f8 \u3053\u306e\u30ed\u30b0\u306e\u30a2\u30af\u30bb\u30b9\u5148\u3054\u3068\u306b\u30a2\u30af\u30bb\u30b9\u6570\u3092\u6570\u3048\u4e0a\u4f4d1\u3064\u3092\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c\uff1a 4 /profile.php \n$ awk -F'[,]' '{print $4}' sample | sort | uniq -c | sort -rn | head -1\n\n\n\u554f9 \u3053\u306e\u30ed\u30b0\u306eserver\u3068\u3044\u3046\u6587\u5b57\u5217\u3092xxx\u3068\u3044\u3046\u6587\u5b57\u5217\u306b\u5909\u3048\u3001\u30b5\u30fc\u30d0\u30fc\u6bce\u306e\u30a2\u30af\u30bb\u30b9\u6570\u3092\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c\uff1a\n3 xxx1\n3 xxx2\n2 xxx3\n1 xxx4\n\n$ awk -F'[,]' '{print $1}' sample | awk 'sub(/server/,\"xxx\")' | sort | uniq -c\n\n\n\u554f10 \u3053\u306e\u30ed\u30b0\u306e\u30e6\u30fc\u30b6\u30fcID\u304c10\u4ee5\u4e0a\u306e\u4eba\u306e\u30e6\u30cb\u30fc\u30af\u306a\u30e6\u30fc\u30b6\u30fcID\u3092\u30e6\u30fc\u30b6\u30fcID\u3067\u30bd\u30fc\u30c8\u3057\u3066\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\n12\n20\n30\n35\n\n$ awk -F'[,]' '{print $3}' sample | awk '$0>10 {print}' | sort | uniq\n\n\nawk\u306e\u52c9\u5f37\u3092\u3057\u3066\u3044\u308b\u3068\u3001[\u30b7\u30a7\u30eb\u64cd\u4f5c\u8ab2\u984c (cut, sort, uniq \u306a\u3069\u3067\u96c6\u8a08\u3092\u884c\u3046) \u8a2d\u554f\u7de8](http://d.hatena.ne.jp/Yamashiro0217/20120727/1343371036)\u3092\u898b\u3064\u3051\u305f\u306e\u3067\u51fa\u6765\u308b\u3060\u3051awk\u3092\u4f7f\u3063\u3066\u89e3\u3044\u3066\u307f\u305f\u3002\n\n###\u554f\u984c\u30d5\u30a1\u30a4\u30eb\n\n```sample\nserver1,1343363124,30,/video.php\nserver2,1343363110,20,/profile.php\nserver3,1343363115,7,/login.php\nserver1,1343363105,8,/profile.php\nserver2,1343363205,35,/profile.php\nserver2,1343363110,20,/profile.php\nserver3,1343363205,30,/login.php\nserver4,1343363225,12,/video.php\nserver1,1343363265,7,/video.php\n```\n\n\n###\u554f1 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3057\u308d\n\n```\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\n\u30d5\u30a1\u30a4\u30eb\u5168\u4f53\u306e\u8868\u793a\n```\n\n```awk\n$ awk '{print}' sample\n```\n\n\n###\u554f2 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30b5\u30fc\u30d0\u30fc\u540d\u3068\u30a2\u30af\u30bb\u30b9\u5148\u3060\u3051\u8868\u793a\u3057\u308d\n\n```\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\nserver1,/video.php \nserver2,/profile.php\nserver2,/login.php  \nserver1,/profile.php \nserver2,/profile.php \nserver2,/profile.php\nserver3,/login.php \nserver4,/video.php \nserver1,/video.php \n```\n\n```awk\n$ awk -F '[,]' '{print $1, $4}' sample\n```\n\n\n###\u554f3 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089server4\u306e\u884c\u3060\u3051\u8868\u793a\u3057\u308d\n\n```\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\nserver4,1343363225,12,/video.php \n```\n\n```awk\n$ awk '/server4/' sample\n```\n\n###\u554f4 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u884c\u6570\u3092\u8868\u793a\u3057\u308d\n\n```\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\n9\n```\n\n```awk\n$ awk '{print}' sample | wc -l\n```\n\n###\u554f5 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u30b5\u30fc\u30d0\u30fc\u540d\u3001\u30e6\u30fc\u30b6\u30fcID\u306e\u6607\u9806\u30675\u884c\u3060\u3051\u8868\u793a\u3057\u308d\n\n```\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\nserver1,1343363265,7,/video.php\nserver1,1343363105,8,/profile.php\nserver1,1343363124,30,/video.php\nserver2,1343363110,20,/profile.php\nserver2,1343363110,20,/profile.php\n```\n\n```awk\n$ sort -k1,1 -k3,3n -t\",\" sample | awk 'NR<6'\n```\n\n\n\n###\u554f6 \u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u91cd\u8907\u884c\u304c\u3042\u308b\u3002\u91cd\u8907\u884c\u306f\u307e\u3068\u3081\u3066\u6570\u3048\u884c\u6570\u3092\u8868\u793a\u3057\u308d\n```\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c\uff1a\n8\n\n\u88dc\u8db3\uff1a\nhoge,30\nfoo,20\nhoge,30 \n\u3060\u3063\u305f\u3089\uff12\u884c\u3068\u6570\u3048\u308b\u3002\n```\n\n```awk\n$ awk '{a[$0]=$0} END {print length(a)}' sample\n```\n\n\n###\u554f7 \u3053\u306e\u30ed\u30b0\u306eUU(\u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc)\u6570\u3092\u8868\u793a\u3057\u308d\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c\uff1a\t6\n\n```awk\n$ awk -F'[,]' '{print $3}' sample | sort | uniq | wc -l\n\n$ awk -F'[,]' '{print $3}' sample | awk '{a[$0] = $0} END {print length(a)}'\n```\n\n\n###\u554f8 \u3053\u306e\u30ed\u30b0\u306e\u30a2\u30af\u30bb\u30b9\u5148\u3054\u3068\u306b\u30a2\u30af\u30bb\u30b9\u6570\u3092\u6570\u3048\u4e0a\u4f4d1\u3064\u3092\u8868\u793a\u3057\u308d\n\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c\uff1a 4 /profile.php \n\n```awk\n$ awk -F'[,]' '{print $4}' sample | sort | uniq -c | sort -rn | head -1\n```\n\n\n###\u554f9 \u3053\u306e\u30ed\u30b0\u306eserver\u3068\u3044\u3046\u6587\u5b57\u5217\u3092xxx\u3068\u3044\u3046\u6587\u5b57\u5217\u306b\u5909\u3048\u3001\u30b5\u30fc\u30d0\u30fc\u6bce\u306e\u30a2\u30af\u30bb\u30b9\u6570\u3092\u8868\u793a\u3057\u308d\n```\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c\uff1a\n3 xxx1\n3 xxx2\n2 xxx3\n1 xxx4\n```\n\n```awk\n$ awk -F'[,]' '{print $1}' sample | awk 'sub(/server/,\"xxx\")' | sort | uniq -c\n```\n\n###\u554f10 \u3053\u306e\u30ed\u30b0\u306e\u30e6\u30fc\u30b6\u30fcID\u304c10\u4ee5\u4e0a\u306e\u4eba\u306e\u30e6\u30cb\u30fc\u30af\u306a\u30e6\u30fc\u30b6\u30fcID\u3092\u30e6\u30fc\u30b6\u30fcID\u3067\u30bd\u30fc\u30c8\u3057\u3066\u8868\u793a\u3057\u308d\n\n```\n\u60f3\u5b9a\u671f\u5f85\u7d50\u679c:\n12\n20\n30\n35\n```\n```awk\n$ awk -F'[,]' '{print $3}' sample | awk '$0>10 {print}' | sort | uniq\n```\n"}