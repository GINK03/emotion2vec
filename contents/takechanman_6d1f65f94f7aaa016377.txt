{"context": "NMF\u306f\u6b21\u5143\u524a\u6e1b\u306e\u624b\u6cd5\u3067\u3042\u308a\uff64\u30ec\u30b3\u30e1\u30f3\u30c9\u306e\u7cbe\u5ea6\u3092\u9ad8\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u3044\u308f\u308c\u3066\u3044\u307e\u3059\u3002\n\u6a5f\u4f1a\u5b66\u7fd2\u30e9\u30a4\u30d6\u30e9\u30ea\u306escikit-learn\u3067\u3082NMF\u3092\u7c21\u5358\u306b\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f\uff64\u5177\u4f53\u4f8b\u3092\u7528\u3044\u3066\u8a66\u3057\u3066\uff64NMF\u3092\u76f4\u611f\u7684\u306b\u7406\u89e3\u3059\u308b\u3053\u3068\u304c\u76ee\u7684\u3067\u3059\u3002\n\u300cMatrix Factorization\u3068\u306f\u300d\u3068\u3044\u3046\u8a18\u4e8b\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n\nNMF\u3068\u306f\n\u30ec\u30b3\u30e1\u30f3\u30c9\u3068\u3057\u3066\u306eMatrix Factorization\u306b\u3064\u3044\u3066\u3056\u3063\u304f\u308a\u3068\u7406\u89e3\u3059\u308b\u306b\u306f\uff64\u82f1\u8a9e\u3067\u3059\u304c\uff64\u4ee5\u4e0b\u306e\u8cc7\u6599\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\nMatrix Factorization Techniques For Recommender Systems\n\u3053\u306e\u30b9\u30e9\u30a4\u30c9\u306b\u3042\u308b\u56f3\u3092\u5f15\u7528\u3057\u306a\u304c\u3089\u8efd\u304f\u30a4\u30e1\u30fc\u30b8\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\nNMF\u306e\u624b\u6cd5\u304c\u4e00\u8e8d\u6709\u540d\u306b\u306a\u3063\u305f\uff64Netflix Prize\u3092\u60f3\u5b9a\u3057\uff64\u30e6\u30fc\u30b6\u30fc\u3068\u305d\u306e\u4eba\u304c\u3069\u306e\u52d5\u753b\u306b\u4f55\u70b9\u306e\u8a55\u4fa1\u3092\u3064\u3051\u305f\u304b\u3092\u8868\u3059\u884c\u5217\u304c\u4e0e\u3048\u3089\u308c\u308b\u3068\u3057\u307e\u3059(\u5de6\u306eRating Matrix\u3068\u3044\u3046\u884c\u5217)\u3002\u30e6\u30fc\u30b6\u30fc\u304c\u52d5\u753b\u3092\u8a55\u4fa1\u3057\u305f\u5834\u5408\u306f1\u304b\u30895\u3067\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4ed8\u3051\u304c\uff64\u8a55\u4fa1\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u306f0\u304c\u5165\u529b\u5165\u3063\u3066\u3044\u307e\u3059\u30020\u304c\u5165\u3063\u3066\u3044\u308b\u306e\u304c\u3053\u306e\u554f\u984c\u306e\u809d\u3067\uff64\u3053\u306e0\u306e\u672c\u5f53\u306e\u5024\u3092\u4e88\u6e2c\u3057\u307e\u3059\u3002\n\u3053\u306eRating Matrix\u3092\u300c\u7279\u5fb4\u00d7\u30e6\u30fc\u30b6\u30fc\u300d\uff64\u300c\u7279\u5fb4\u00d7\u6620\u753b\u300d\u3068\u3044\u30462\u3064\u306e\u884c\u5217\u306b\u5206\u89e3\u3057\u307e\u3059\u3002\n\u3059\u3054\u304f\u3059\u3054\u304f\u304a\u304a\u3056\u3063\u3071\u306b\u3044\u3046\u3068\uff64\u3046\u307e\u304f\u884c\u5217\u5206\u89e3\u3092\u3059\u308b\u624b\u6cd5\u304cNMF\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u305cnon-negative\u304c\u3044\u3044\u306e\u304b\uff64\u4ed6\u306e\u884c\u5217\u5206\u89e3\u624b\u6cd5\u3067\u3042\u308b\u7279\u7570\u5024\u5206\u89e3(SVG)\u306b\u6bd4\u3079\u3066\u4f55\u304c\u3088\u3044\u306e\u304b\u306b\u3064\u3044\u3066\u306f\uff64\u9700\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3057\u305f\u3089\u66f8\u304d\u307e\u3059\u3002\n\n\nNMF\u306e\u5b9a\u5f0f\u5316\nRR\\mathbf{R}:Rating Matrix\nPP\\mathbf{P}:User Feature Matrix\nQQ\\mathbf{Q}:Movie Feature Matrix\n\u3068\u3057\u305f\u3068\u304d\uff64RR\\mathbf{R}\u3068 P\u00d7QTP\u00d7QT\\mathbf{P} \\times \\mathbf{Q}^T \u306e\u8aa4\u5dee\u304c\u5c0f\u3055\u304f\u306a\u308b\u3088\u3046\u306b\u5206\u89e3\u3057\u307e\u3059\u3002\n\\mathbf{R} \\approx \\mathbf{P} \\times \\mathbf{Q}^T = \\hat{\\mathbf{R}}\nR\u2248P\u00d7QT=\u02c6RR\u2248P\u00d7QT=R^{\\mathbf{R} \\approx \\mathbf{P} \\times \\mathbf{Q}^T = \\hat{\\mathbf{R}}\n}\n\u8aa4\u5dee\u306fe2ije2ije_{ij}^2\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\ne_{ij}^2 = (r_{ij} - \\hat{r}_{ij})^2 = (r_{ij} - \\sum_{k=1}^K{p_{ik}q_{kj}})^2\n\ne2ij=(rij\u2212\u02c6rij)2=(rij\u2212K\u2211k=1pikqkj)2{\ne_{ij}^2 = (r_{ij} - \\hat{r}_{ij})^2 = (r_{ij} - \\sum_{k=1}^K{p_{ik}q_{kj}})^2\n\n}\n\u305f\u3060\u3057\uff64\u8fd1\u4f3c\u3057\u305f\u02c6R \\hat{\\mathbf{R}} \u306e\u8981\u7d20\u306f\u4ee5\u4e0b\n\\hat{r}_{ij} = p_i^T q_j = \\sum_{k=1}^k{p_{ik}q_{kj}}\n\u02c6rij=pTiqj=k\u2211k=1pikqkj{\\hat{r}_{ij} = p_i^T q_j = \\sum_{k=1}^k{p_{ik}q_{kj}}\n}\n\nscikit-learn\u3067\u306e\u5b9f\u88c5\n\u7c21\u5358\u306b\u304b\u3051\u307e\u3059\u3002\n\u4f8b\u3048\u3070\uff64\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u884c\u5217\u3092R\uff64\u7279\u5fb4\u306e\u6b21\u5143\u30922\u3068\u3057\u305f\u5834\u5408\u306e\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\nfrom sklearn.decomposition import NMF\nmodel = NMF(n_components=2, init='random', random_state=0) # n_components\u3067\u7279\u5fb4\u306e\u6b21\u5143\u3092\u6307\u5b9a\nP = model.fit_transform(R) # \u5b66\u7fd2\nQ = model.components_\n\n\n\u5177\u4f53\u4f8b\nR\u3092\u6b21\u306e\u3088\u3046\u306a5\u00d74\u884c\u5217\u3060\u3068\u3057\u307e\u3059\u3002\u3053\u306e\u884c\u5217\u306e\u6570\u5b57\u306f\uff64\u3053\u306e\u30b5\u30a4\u30c8\u3067\u5229\u7528\u3055\u308c\u3066\u3044\u308b\u4f8b\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\n\n\n\nD1\nD2\nD3\nD4\n\n\n\n\nU1\n5\n3\n-\n1\n\n\nU2\n4\n-\n-\n1\n\n\nU3\n1\n1\n-\n5\n\n\nU4\n1\n-\n-\n4\n\n\nU5\n-\n1\n5\n4\n\n\n\nfrom sklearn.decomposition import NMF\nimport numpy as np\n\n# 0\u306e\u90e8\u5206\u306f\u672a\u77e5\nR = np.array([\n        [5, 3, 0, 1],\n        [4, 0, 0, 1],\n        [1, 1, 0, 5],\n        [1, 0, 0, 4],\n        [0, 1, 5, 4],\n        ]\n    )\n\n# \u7279\u5fb4\u306e\u6b21\u5143k\u30921\u304b\u30893\u307e\u3067\u5909\u3048\u3066\u307f\u308b\nfor k in range(1,4):\n    model = NMF(n_components=k, init='random', random_state=0)\n    P = model.fit_transform(R)\n    Q = model.components_\n    print(\"****************************\")\n    print(\"k:\",k)\n    print(\"P\u306f\")\n    print(P)\n    print(\"Q^T\u306f\")\n    print(Q)\n    print(\"P\u00d7Q^T\u306f\")\n    print(np.dot(P,Q))\n    print(\"R-P\u00d7Q^T\u306f\")\n    print(model.reconstruction_err_ )\n\n\u51fa\u529b\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n****************************\nk: 1\nP\u306f\n[[ 0.95446553]\n [ 0.64922245]\n [ 1.12694515]\n [ 0.87376625]\n [ 1.18572187]]\nQ^T\u306f\n[[ 1.96356213  1.0846958   1.24239928  3.24322704]]\nP\u00d7Q^T\u306f\n[[ 1.87415238  1.03530476  1.18582729  3.09554842]\n [ 1.27478862  0.70420887  0.8065935   2.10557581]\n [ 2.21282681  1.22239267  1.40011583  3.65493896]\n [ 1.71569432  0.94777058  1.08556656  2.83382232]\n [ 2.32823857  1.28614754  1.47314     3.84556523]]\nR-P\u00d7Q^T\u306f\n7.511859871919941\n****************************\nk: 2\nP\u306f\n[[ 0.          1.69547254]\n [ 0.          1.13044637]\n [ 1.38593123  0.42353044]\n [ 1.08595617  0.3165454 ]\n [ 2.01891156  0.        ]]\nQ^T\u306f\n[[ 0.          0.32199795  1.40668938  2.58501889]\n [ 3.09992487  1.17556787  0.          0.85823043]]\nP\u00d7Q^T\u306f\n[[ 5.25583751  1.99314304  0.          1.45510614]\n [ 3.50429883  1.32891643  0.          0.97018348]\n [ 1.31291255  0.9441558   1.94957474  3.94614513]\n [ 0.98126695  0.72179626  1.52760301  3.0788861 ]\n [ 0.          0.65008539  2.83998144  5.21892451]]\nR-P\u00d7Q^T\u306f\n4.2765298341191516\n****************************\nk: 3\nP\u306f\n[[ 0.08750151  2.03662182  0.52066139]\n [ 0.          1.32090927  0.59992585]\n [ 0.04491053  0.44753619  3.4215759 ]\n [ 0.          0.3221337   2.75625987]\n [ 2.6249395   0.          0.91559966]]\nQ^T\u306f\n[[ 0.          0.38636917  1.90213535  1.02176621]\n [ 2.62017626  1.02934221  0.          0.08629708]\n [ 0.          0.02388804  0.          1.43875694]]\nP\u00d7Q^T\u306f\n[[ 5.33630814  2.14262626  0.16643971  1.0142658 ]\n [ 3.4610151   1.37399871  0.          0.97713811]\n [ 1.17262369  0.55975468  0.08542591  5.00732522]\n [ 0.84404708  0.39742747  0.          3.99338722]\n [ 0.          1.03606758  4.99299022  3.99939987]]\nR-P\u00d7Q^T\u306f\n1.8626938982246695\n\n\n\u89b3\u6e2c\u884c\u5217R\u306f\uff645\u00d74 \u306e\u884c\u5217\u3067\u3057\u305f\u3002\nk\u3092\u3044\u308d\u3044\u308d\u5909\u3048\u3066\u8a66\u3057\u305f\u6642\u306b\uff64P\u304c5\u00d7k\u306e\u884c\u5217\uff64Q^T\u304ck\u00d74\u306e\u884c\u5217\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305f\uff64P\u00d7Q^T \u3067\u306f\uff64R\u3067\u306f0\u3067\u3042\u3063\u305f\u3068\u3053\u308d\u304c\u63a8\u6e2c\u3055\u308c\u3066\u304a\u308a\uff64\u4f8b\u3048\u3070k=2\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u02c6R \\hat{\\mathbf{R}} \u304c\u5b8c\u6210\u3057\u3066\u3044\u307e\u3059\u3002(\u592a\u5b57\u304c\u4e88\u6e2c\u3055\u308c\u305f\u90e8\u5206)\n\n\n\n\nD1\nD2\nD3\nD4\n\n\n\n\nU1\n5.25\n1.99\n0.\n1.45\n\n\nU2\n3.50\n1.32\n0.\n0.97\n\n\nU3\n1.31\n0.94\n1.94\n3.94\n\n\nU4\n0.98\n0.72\n1.52\n3.07\n\n\nU5\n0.\n0.65\n2.83\n5.21\n\n\n\n\uff4b\u3092\u3069\u306e\u5024\u306b\u3059\u308b\u304b\u306f\u96e3\u3057\u3044\u554f\u984c\u3067\u3042\u308a\uff64\u5165\u529b\u30c7\u30fc\u30bf(R)\u306b\u4f9d\u5b58\u3059\u308b\u3068\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\nk\u3092\u5927\u304d\u304f\u3059\u308c\u3070\uff64R-P\u00d7Q^T \u306f\u5c0f\u3055\u304f\u306a\u308a\uff64\u30e2\u30c7\u30eb\u306e\u8907\u96d1\u5ea6\u306f\u9ad8\u304f\u306a\u308b\u3002\n\u9006\u306bk\u3092\u5c0f\u3055\u304f\u3059\u308c\u3070\uff64R-P\u00d7Q^T \u306f\u5927\u304d\u304f\u306a\u308a\uff64\u30e2\u30c7\u30eb\u306e\u8907\u96d1\u5ea6\u306f\u4f4e\u304f\u306a\u308b\u3002\n\n\u4eca\u56de\u306e\u5834\u5408\uff64\u3069\u306ek\u304c\u3088\u3044\u3068\u5224\u65ad\u3059\u308b\u306b\u306f\u3069\u3046\u3059\u308c\u3070\u3088\u3044\u306e\u3067\u3057\u3087\u3046\u304b\u3002(\u3054\u5b58\u3058\u306e\u65b9\u3054\u6559\u6388\u304f\u3060\u3055\u3044)\n\n\u30ea\u30f3\u30af\n\nscikit learn \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\n\nhttp://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html\n\n\n\nMatrix Factorization\u3068\u306f(\u308f\u304b\u308a\u3084\u3059\u3044qiita)\n\nhttp://qiita.com/ysekky/items/c81ff24da0390a74fc6c\n\n\n\nMatrix Factorization Techniques For Recommender Systems(\u308f\u304b\u308a\u3084\u3059\u3044\u30b9\u30e9\u30a4\u30c9\n\n https://hpi.de/fileadmin/user_upload/fachgebiete/naumann/lehre/SS2011/Collaborative_Filtering/pres1-matrixfactorization.pdf\n\n\n\n\nNMF\u306f\u6b21\u5143\u524a\u6e1b\u306e\u624b\u6cd5\u3067\u3042\u308a\uff64\u30ec\u30b3\u30e1\u30f3\u30c9\u306e\u7cbe\u5ea6\u3092\u9ad8\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u3044\u308f\u308c\u3066\u3044\u307e\u3059\u3002\n\u6a5f\u4f1a\u5b66\u7fd2\u30e9\u30a4\u30d6\u30e9\u30ea\u306e`scikit-learn`\u3067\u3082NMF\u3092\u7c21\u5358\u306b\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f\uff64\u5177\u4f53\u4f8b\u3092\u7528\u3044\u3066\u8a66\u3057\u3066\uff64NMF\u3092\u76f4\u611f\u7684\u306b\u7406\u89e3\u3059\u308b\u3053\u3068\u304c\u76ee\u7684\u3067\u3059\u3002\n[\u300cMatrix Factorization\u3068\u306f\u300d](http://qiita.com/ysekky/items/c81ff24da0390a74fc6c)\u3068\u3044\u3046\u8a18\u4e8b\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n## NMF\u3068\u306f\n\n\u30ec\u30b3\u30e1\u30f3\u30c9\u3068\u3057\u3066\u306eMatrix Factorization\u306b\u3064\u3044\u3066\u3056\u3063\u304f\u308a\u3068\u7406\u89e3\u3059\u308b\u306b\u306f\uff64\u82f1\u8a9e\u3067\u3059\u304c\uff64\u4ee5\u4e0b\u306e\u8cc7\u6599\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n[Matrix Factorization Techniques For Recommender Systems](https://hpi.de/fileadmin/user_upload/fachgebiete/naumann/lehre/SS2011/Collaborative_Filtering/pres1-matrixfactorization.pdf)\n\n\u3053\u306e\u30b9\u30e9\u30a4\u30c9\u306b\u3042\u308b\u56f3\u3092\u5f15\u7528\u3057\u306a\u304c\u3089\u8efd\u304f\u30a4\u30e1\u30fc\u30b8\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\nNMF\u306e\u624b\u6cd5\u304c\u4e00\u8e8d\u6709\u540d\u306b\u306a\u3063\u305f\uff64Netflix Prize\u3092\u60f3\u5b9a\u3057\uff64\u30e6\u30fc\u30b6\u30fc\u3068\u305d\u306e\u4eba\u304c\u3069\u306e\u52d5\u753b\u306b\u4f55\u70b9\u306e\u8a55\u4fa1\u3092\u3064\u3051\u305f\u304b\u3092\u8868\u3059\u884c\u5217\u304c\u4e0e\u3048\u3089\u308c\u308b\u3068\u3057\u307e\u3059(\u5de6\u306eRating Matrix\u3068\u3044\u3046\u884c\u5217)\u3002\u30e6\u30fc\u30b6\u30fc\u304c\u52d5\u753b\u3092\u8a55\u4fa1\u3057\u305f\u5834\u5408\u306f1\u304b\u30895\u3067\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4ed8\u3051\u304c\uff64\u8a55\u4fa1\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u306f0\u304c\u5165\u529b\u5165\u3063\u3066\u3044\u307e\u3059\u30020\u304c\u5165\u3063\u3066\u3044\u308b\u306e\u304c\u3053\u306e\u554f\u984c\u306e\u809d\u3067\uff64\u3053\u306e0\u306e\u672c\u5f53\u306e\u5024\u3092\u4e88\u6e2c\u3057\u307e\u3059\u3002\n\u3053\u306eRating Matrix\u3092\u300c\u7279\u5fb4\u00d7\u30e6\u30fc\u30b6\u30fc\u300d\uff64\u300c\u7279\u5fb4\u00d7\u6620\u753b\u300d\u3068\u3044\u30462\u3064\u306e\u884c\u5217\u306b\u5206\u89e3\u3057\u307e\u3059\u3002\n\u3059\u3054\u304f\u3059\u3054\u304f\u304a\u304a\u3056\u3063\u3071\u306b\u3044\u3046\u3068\uff64\u3046\u307e\u304f\u884c\u5217\u5206\u89e3\u3092\u3059\u308b\u624b\u6cd5\u304cNMF\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u305cnon-negative\u304c\u3044\u3044\u306e\u304b\uff64\u4ed6\u306e\u884c\u5217\u5206\u89e3\u624b\u6cd5\u3067\u3042\u308b\u7279\u7570\u5024\u5206\u89e3(SVG)\u306b\u6bd4\u3079\u3066\u4f55\u304c\u3088\u3044\u306e\u304b\u306b\u3064\u3044\u3066\u306f\uff64\u9700\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3057\u305f\u3089\u66f8\u304d\u307e\u3059\u3002\n\n![Screen Shot 2016-12-23 at 01.21.41.png](https://qiita-image-store.s3.amazonaws.com/0/99549/355e4d1f-f7c8-435d-e436-7b865bc6e964.png)\n## NMF\u306e\u5b9a\u5f0f\u5316\n\n$\\mathbf{R}$:Rating Matrix\n$\\mathbf{P}$:User Feature Matrix\n$\\mathbf{Q}$:Movie Feature Matrix\n\u3068\u3057\u305f\u3068\u304d\uff64$\\mathbf{R}$\u3068 $\\mathbf{P} \\times \\mathbf{Q}^T$ \u306e\u8aa4\u5dee\u304c\u5c0f\u3055\u304f\u306a\u308b\u3088\u3046\u306b\u5206\u89e3\u3057\u307e\u3059\u3002\n\n\n```math\n\\mathbf{R} \\approx \\mathbf{P} \\times \\mathbf{Q}^T = \\hat{\\mathbf{R}}\n```\n\u8aa4\u5dee\u306f$e_{ij}^2$\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```math\n\ne_{ij}^2 = (r_{ij} - \\hat{r}_{ij})^2 = (r_{ij} - \\sum_{k=1}^K{p_{ik}q_{kj}})^2\n\n```\n\u305f\u3060\u3057\uff64\u8fd1\u4f3c\u3057\u305f$ \\hat{\\mathbf{R}} $\u306e\u8981\u7d20\u306f\u4ee5\u4e0b\n\n```math\n\\hat{r}_{ij} = p_i^T q_j = \\sum_{k=1}^k{p_{ik}q_{kj}}\n```\n## scikit-learn\u3067\u306e\u5b9f\u88c5\n\n\u7c21\u5358\u306b\u304b\u3051\u307e\u3059\u3002\n\u4f8b\u3048\u3070\uff64\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u884c\u5217\u3092R\uff64\u7279\u5fb4\u306e\u6b21\u5143\u30922\u3068\u3057\u305f\u5834\u5408\u306e\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\n\n```python\nfrom sklearn.decomposition import NMF\nmodel = NMF(n_components=2, init='random', random_state=0) # n_components\u3067\u7279\u5fb4\u306e\u6b21\u5143\u3092\u6307\u5b9a\nP = model.fit_transform(R) # \u5b66\u7fd2\nQ = model.components_\n```\n\n## \u5177\u4f53\u4f8b\nR\u3092\u6b21\u306e\u3088\u3046\u306a5\u00d74\u884c\u5217\u3060\u3068\u3057\u307e\u3059\u3002\u3053\u306e\u884c\u5217\u306e\u6570\u5b57\u306f\uff64[\u3053\u306e\u30b5\u30a4\u30c8](http://www.quuxlabs.com/blog/2010/09/matrix-factorization-a-simple-tutorial-and-implementation-in-python/)\u3067\u5229\u7528\u3055\u308c\u3066\u3044\u308b\u4f8b\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\n\n|  | D1 | D2 |D3|D4|\n|:-----------:|:------------:|:------------:|:------------:|:------------:|\n| U1      |       5 |  3 |-|1|\n| U2     | 4 | -  |-|1|\n| U3      |  1|  1   |-|5|\n| U4      |  1 |  - |-|4|\n| U5      |  -| 1   |5|4|\n\n\n\n``` python\nfrom sklearn.decomposition import NMF\nimport numpy as np\n\n# 0\u306e\u90e8\u5206\u306f\u672a\u77e5\nR = np.array([\n        [5, 3, 0, 1],\n        [4, 0, 0, 1],\n        [1, 1, 0, 5],\n        [1, 0, 0, 4],\n        [0, 1, 5, 4],\n        ]\n    )\n\n# \u7279\u5fb4\u306e\u6b21\u5143k\u30921\u304b\u30893\u307e\u3067\u5909\u3048\u3066\u307f\u308b\nfor k in range(1,4):\n    model = NMF(n_components=k, init='random', random_state=0)\n    P = model.fit_transform(R)\n    Q = model.components_\n    print(\"****************************\")\n    print(\"k:\",k)\n    print(\"P\u306f\")\n    print(P)\n    print(\"Q^T\u306f\")\n    print(Q)\n    print(\"P\u00d7Q^T\u306f\")\n    print(np.dot(P,Q))\n    print(\"R-P\u00d7Q^T\u306f\")\n    print(model.reconstruction_err_ )\n```\n\n\n\n\u51fa\u529b\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n``` \n****************************\nk: 1\nP\u306f\n[[ 0.95446553]\n [ 0.64922245]\n [ 1.12694515]\n [ 0.87376625]\n [ 1.18572187]]\nQ^T\u306f\n[[ 1.96356213  1.0846958   1.24239928  3.24322704]]\nP\u00d7Q^T\u306f\n[[ 1.87415238  1.03530476  1.18582729  3.09554842]\n [ 1.27478862  0.70420887  0.8065935   2.10557581]\n [ 2.21282681  1.22239267  1.40011583  3.65493896]\n [ 1.71569432  0.94777058  1.08556656  2.83382232]\n [ 2.32823857  1.28614754  1.47314     3.84556523]]\nR-P\u00d7Q^T\u306f\n7.511859871919941\n****************************\nk: 2\nP\u306f\n[[ 0.          1.69547254]\n [ 0.          1.13044637]\n [ 1.38593123  0.42353044]\n [ 1.08595617  0.3165454 ]\n [ 2.01891156  0.        ]]\nQ^T\u306f\n[[ 0.          0.32199795  1.40668938  2.58501889]\n [ 3.09992487  1.17556787  0.          0.85823043]]\nP\u00d7Q^T\u306f\n[[ 5.25583751  1.99314304  0.          1.45510614]\n [ 3.50429883  1.32891643  0.          0.97018348]\n [ 1.31291255  0.9441558   1.94957474  3.94614513]\n [ 0.98126695  0.72179626  1.52760301  3.0788861 ]\n [ 0.          0.65008539  2.83998144  5.21892451]]\nR-P\u00d7Q^T\u306f\n4.2765298341191516\n****************************\nk: 3\nP\u306f\n[[ 0.08750151  2.03662182  0.52066139]\n [ 0.          1.32090927  0.59992585]\n [ 0.04491053  0.44753619  3.4215759 ]\n [ 0.          0.3221337   2.75625987]\n [ 2.6249395   0.          0.91559966]]\nQ^T\u306f\n[[ 0.          0.38636917  1.90213535  1.02176621]\n [ 2.62017626  1.02934221  0.          0.08629708]\n [ 0.          0.02388804  0.          1.43875694]]\nP\u00d7Q^T\u306f\n[[ 5.33630814  2.14262626  0.16643971  1.0142658 ]\n [ 3.4610151   1.37399871  0.          0.97713811]\n [ 1.17262369  0.55975468  0.08542591  5.00732522]\n [ 0.84404708  0.39742747  0.          3.99338722]\n [ 0.          1.03606758  4.99299022  3.99939987]]\nR-P\u00d7Q^T\u306f\n1.8626938982246695\n\n```\n\n\u89b3\u6e2c\u884c\u5217R\u306f\uff645\u00d74 \u306e\u884c\u5217\u3067\u3057\u305f\u3002\nk\u3092\u3044\u308d\u3044\u308d\u5909\u3048\u3066\u8a66\u3057\u305f\u6642\u306b\uff64P\u304c5\u00d7k\u306e\u884c\u5217\uff64Q^T\u304ck\u00d74\u306e\u884c\u5217\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u307e\u305f\uff64P\u00d7Q^T \u3067\u306f\uff64R\u3067\u306f0\u3067\u3042\u3063\u305f\u3068\u3053\u308d\u304c\u63a8\u6e2c\u3055\u308c\u3066\u304a\u308a\uff64\u4f8b\u3048\u3070k=2\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a$ \\hat{\\mathbf{R}} $\u304c\u5b8c\u6210\u3057\u3066\u3044\u307e\u3059\u3002(\u592a\u5b57\u304c\u4e88\u6e2c\u3055\u308c\u305f\u90e8\u5206)\n\n\n|  | D1 | D2 |D3|D4|\n|:-----------:|:------------:|:------------:|:------------:|:------------:|\n| U1      |  5.25 | 1.99 |**0.**|1.45|\n| U2     | 3.50 | **1.32**  |**0.**|0.97|\n| U3      |  1.31|  0.94   |**1.94**|3.94|\n| U4      |  0.98 |  **0.72** |**1.52**|3.07|\n| U5      |  **0.**| 0.65  |2.83|5.21|\n\n\n\uff4b\u3092\u3069\u306e\u5024\u306b\u3059\u308b\u304b\u306f\u96e3\u3057\u3044\u554f\u984c\u3067\u3042\u308a\uff64\u5165\u529b\u30c7\u30fc\u30bf(R)\u306b\u4f9d\u5b58\u3059\u308b\u3068\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n* k\u3092\u5927\u304d\u304f\u3059\u308c\u3070\uff64R-P\u00d7Q^T \u306f\u5c0f\u3055\u304f\u306a\u308a\uff64\u30e2\u30c7\u30eb\u306e\u8907\u96d1\u5ea6\u306f\u9ad8\u304f\u306a\u308b\u3002\n* \u9006\u306bk\u3092\u5c0f\u3055\u304f\u3059\u308c\u3070\uff64R-P\u00d7Q^T \u306f\u5927\u304d\u304f\u306a\u308a\uff64\u30e2\u30c7\u30eb\u306e\u8907\u96d1\u5ea6\u306f\u4f4e\u304f\u306a\u308b\u3002\n\n\u4eca\u56de\u306e\u5834\u5408\uff64\u3069\u306ek\u304c\u3088\u3044\u3068\u5224\u65ad\u3059\u308b\u306b\u306f\u3069\u3046\u3059\u308c\u3070\u3088\u3044\u306e\u3067\u3057\u3087\u3046\u304b\u3002(\u3054\u5b58\u3058\u306e\u65b9\u3054\u6559\u6388\u304f\u3060\u3055\u3044)\n\n## \u30ea\u30f3\u30af\n* scikit learn \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\t* http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html\n* Matrix Factorization\u3068\u306f(\u308f\u304b\u308a\u3084\u3059\u3044qiita)\n    * http://qiita.com/ysekky/items/c81ff24da0390a74fc6c\n\n* Matrix Factorization Techniques For Recommender Systems(\u308f\u304b\u308a\u3084\u3059\u3044\u30b9\u30e9\u30a4\u30c9\n    *  https://hpi.de/fileadmin/user_upload/fachgebiete/naumann/lehre/SS2011/Collaborative_Filtering/pres1-matrixfactorization.pdf\n", "tags": ["scikit-learn", "Python", "Matrix", "Recommendation", "MachineLearning"]}