{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\n\u3075\u3068\u4ed5\u4e8b\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u3092\u5834\u5408\u306b\u3088\u3063\u3066\u30b4\u30cb\u30e7\u30b4\u30cb\u30e7\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u304f\u3066\u3001VisualStudio\u306e\u30a2\u30c9\u30a4\u30f3\u304c\u3042\u3063\u305f\u3089\u6357\u308b\u306e\u306b\u306a\u3068\u3044\u3046\u6848\u4ef6\u304c\u3042\u3063\u305f\u306e\u3067\u4f5c\u308a\u65b9\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u3002\n\u304a\u305d\u3089\u304f\u3001VS2013\u3067\u3082\u4f5c\u308a\u65b9\u306f\u307b\u307c\u4e00\u7dd2\u304b\u3068\u3002VS2008\u3067\u4f5c\u3063\u305f\u3082\u306e\u3092\u305d\u306e\u307e\u307e\u4f7f\u3046\u3053\u3068\u306f\u51fa\u6765\u306a\u3044\u307f\u305f\u3044\u3002\n\n\n\u4f5c\u308a\u65b9\n\nVisualStudio\u2192\u30d5\u30a1\u30a4\u30eb\u2192\u65b0\u898f\u4f5c\u6210\u2192\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u2192\u62e1\u5f35\u6a5f\u80fd\u2192VisualStudio\u30a2\u30c9\u30a4\u30f3\u3092\u30af\u30ea\u30c3\u30af\n\n\u30a2\u30c9\u30a4\u30f3\u4f5c\u6210\u30a6\u30a3\u30b6\u30fc\u30c9\u304c\u958b\u59cb\u3055\u308c\u307e\u3059(\u697d\u3061\u3093\uff01)\n\n\u8a00\u8a9e\u3092\u9078\u3073\u307e\u3059\u3002\u3082\u3061\u308d\u3093\u50d5\u306fC#\u4ee5\u5916\u306f\u9078\u3073\u307e\u305b\u3093( \u00b4\u2200\uff40)\n\n\u4f55\u3092\u8a00\u3063\u3066\u308b\u304b\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3068\u308a\u3042\u3048\u305a\u5168\u90e8\u9078\u629e\u3057\u307e\u3059\u3002\n\n\u51fa\u6765\u305f\uff3c(^o^)\uff0f\n\n\u5f8c\u306f\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u30ac\u30ea\u30ac\u30ea\u66f8\u3044\u3066\u3044\u304f\u3060\u3051\u3067\u3059\u3002(\u3048\u3063\n\n\n\u7c21\u5358\u306b\u30c7\u30d0\u30c3\u30b0\u30fb\u4f5c\u6210\u306e\u6d41\u308c\n\n\u4f5c\u6210\u3057\u305f\u30a2\u30c9\u30a4\u30f3\u3092\u5b9f\u884c[\u30c4\u30fc\u30eb\u2192(\u3055\u3063\u304d\u3064\u3051\u305f\u30a2\u30c9\u30a4\u30f3\u540d)]\u3057\u3066\u307f\u308b\u3068\u3001\u65b0\u3057\u3044VisualStudio\u304c\u958b\u304d\u307e\u3059\u3002\n\u3068\u308a\u3042\u3048\u305a\u3001\u30a2\u30c9\u30a4\u30f3\u306eConnect.cs\u306eExec\u306b\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\u3092\u5f35\u3063\u3066\u30a2\u30c9\u30a4\u30f3\u3092\u5b9f\u884c\u3057\u3066\u307f\u308b\u3068\u3001Exec\u304c\u547c\u3070\u308c\u308b\u306e\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\u4ed6\u306b\u3001\u30a2\u30c9\u30a4\u30f3\u304c\u63a5\u7d9a\u3055\u308c\u305f\u6642\u306b\u547c\u3070\u308c\u308bOnConnection\u3084\u30a2\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u305f\u6642\u306eOnDisconnection\u306a\u3069\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u304c\u5e7e\u3064\u304b\u7528\u610f\u3055\u308c\u3066\u308b\u3002\n\u3042\u3068\u306f\u3044\u3044\u611f\u3058\u306b\u30b3\u30fc\u30c9\u3092\u30ac\u30ea\u30ac\u30ea\u66f8\u3044\u305f\u3089\u5b8c\u6210\uff3c(^o^)\uff0f\n\n\nForm\u3092\u4f5c\u308a\u305f\u3044\u5834\u5408\n\n\u53c2\u7167\u8ffd\u52a0\n\n\n\u30d5\u30a9\u30fc\u30e0\u8ffd\u52a0\n\n\u30d5\u30a9\u30fc\u30e0\u751f\u6210\n\n\nconnetc.cs\nusing System.Windows.Forms;\nnamespace MyAddin1\n{\n\n    public class Connect : IDTExtensibility2, IDTCommandTarget\n    {\n        public Connect()\n        {\n        }\n\n\n        public void Exec(string commandName, vsCommandExecOption executeOption, ref object varIn, ref object varOut, ref bool handled)\n        {\n            handled = false;\n            if(executeOption == vsCommandExecOption.vsCommandExecOptionDoDefault)\n            {\n                if(commandName == \"MyAddin1.Connect.MyAddin1\")\n                {\n                    handled = true;\n\n                    // \u30d5\u30a9\u30fc\u30e0\u751f\u6210\u30fb\u8868\u793a\n                    Form1 form = new Form1();\n                    form.Show();\n                    // \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u3092\u5f04\u308a\u305f\u3044\u306e\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u6e21\u3057\u3066\u304a\u304f(Form1\u306b\u95a2\u6570\u8ffd\u52a0)\n                    form.SetDTE(_applicationObject);\n\n\n                    return;\n                }\n            }\n        }\n        private DTE2 _applicationObject;\n        private AddIn _addInInstance;\n\n\n\n\n\u30a2\u30c9\u30a4\u30f3\u3092\u5b9f\u884c\u3057\u305f\u3089\u3053\u3093\u306a\u611f\u3058\u3002\n\n\n\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\u3092\u30a2\u30c9\u30a4\u30f3\u304b\u3089\u5909\u3048\u3066\u307f\u308b\n\nconnetc.cs\n        private void button1_Click(object sender, EventArgs e)\n        {\n\n\n            // \u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\n            SolutionBuild2 sb = (SolutionBuild2)_DTE.Solution.SolutionBuild;\n            Project startupProj;\n            string msg = \"\";\n\n            foreach (String item in (Array)sb.StartupProjects)\n            {\n                msg += item;\n            }\n            startupProj = _DTE.Solution.Item(msg);\n\n            Configuration activeConfiguration = startupProj.ConfigurationManager.ActiveConfiguration;\n\n\n            // \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u53d6\u5f97\n            EnvDTE.Properties configProps = activeConfiguration.Properties;\n\n            // \u30b3\u30f3\u30d5\u30a3\u30b0\u4e00\u89a7\u3092\u51fa\u529b\n            foreach (EnvDTE.Property p in configProps)\n            {\n                Debug.Print(p.Name);\n            }\n\n            // \u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u5909\u66f4\u3057\u3066\u307f\u308b\n            EnvDTE.Property prop;\n            prop = configProps.Item(\"Command\");\n            prop.Value = \"-window\";\n\n        }\n\n\n\n\n\u305d\u306e\u4ed6\u30e1\u30e2\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u4f9d\u5b58\u3057\u306a\u3044VC\u56fa\u6709\u306e\u8a2d\u5b9a\uff1f\u306fProject\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Microsoft.VisualStudio.VCProjectEngine\u306eVCProject\u306b\u30ad\u30e3\u30b9\u30c8\u3057\u3066\u8fbf\u3089\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u307f\u305f\u3044\u3002\u9762\u5012\u3002\u3002\u3002\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u3082\u4f7f\u3048\u308b\u30a2\u30c9\u30a4\u30f3\u3063\u3066\u306e\u304c\u4f5c\u308c\u308b\u306e\u3067\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u306e\u30d3\u30eb\u30c9\u3057\u3066\u3082\u4f7f\u3048\u305d\u3046\uff1f(\u8abf\u67fb\u4e2d)\n\u30a2\u30c9\u30a4\u30f3\u306e\u914d\u5e03\nhttp://www.atmarkit.co.jp/fdotnet/special/vsaddinintro03/vsaddinintro03_01.html\n\n# \u306f\u3058\u3081\u306b\n\n* \u3075\u3068\u4ed5\u4e8b\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u3092\u5834\u5408\u306b\u3088\u3063\u3066\u30b4\u30cb\u30e7\u30b4\u30cb\u30e7\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u304f\u3066\u3001VisualStudio\u306e\u30a2\u30c9\u30a4\u30f3\u304c\u3042\u3063\u305f\u3089\u6357\u308b\u306e\u306b\u306a\u3068\u3044\u3046\u6848\u4ef6\u304c\u3042\u3063\u305f\u306e\u3067\u4f5c\u308a\u65b9\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u3002\n\n* \u304a\u305d\u3089\u304f\u3001VS2013\u3067\u3082\u4f5c\u308a\u65b9\u306f\u307b\u307c\u4e00\u7dd2\u304b\u3068\u3002VS2008\u3067\u4f5c\u3063\u305f\u3082\u306e\u3092\u305d\u306e\u307e\u307e\u4f7f\u3046\u3053\u3068\u306f\u51fa\u6765\u306a\u3044\u307f\u305f\u3044\u3002\n\n# \u4f5c\u308a\u65b9\n1. VisualStudio\u2192\u30d5\u30a1\u30a4\u30eb\u2192\u65b0\u898f\u4f5c\u6210\u2192\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u2192\u62e1\u5f35\u6a5f\u80fd\u2192VisualStudio\u30a2\u30c9\u30a4\u30f3\u3092\u30af\u30ea\u30c3\u30af\n![Addin00.png](https://qiita-image-store.s3.amazonaws.com/0/31791/dbab9fcd-4170-5f17-1e82-579fd5976bc4.png)\n\n2. \u30a2\u30c9\u30a4\u30f3\u4f5c\u6210\u30a6\u30a3\u30b6\u30fc\u30c9\u304c\u958b\u59cb\u3055\u308c\u307e\u3059(\u697d\u3061\u3093\uff01)\n![Addin01.png](https://qiita-image-store.s3.amazonaws.com/0/31791/a1fe691e-9ad3-f9a4-6bea-5f6fa9f89876.png)\n\n\n3. \u8a00\u8a9e\u3092\u9078\u3073\u307e\u3059\u3002\u3082\u3061\u308d\u3093\u50d5\u306fC#\u4ee5\u5916\u306f\u9078\u3073\u307e\u305b\u3093( \u00b4\u2200\uff40)\n![Addin02.png](https://qiita-image-store.s3.amazonaws.com/0/31791/afb2b1c0-6464-72a7-dd9b-ca5e62141d28.png)\n\n\n4. \u4f55\u3092\u8a00\u3063\u3066\u308b\u304b\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3068\u308a\u3042\u3048\u305a\u5168\u90e8\u9078\u629e\u3057\u307e\u3059\u3002\n![Addin03.png](https://qiita-image-store.s3.amazonaws.com/0/31791/c511eaa1-6c0d-7a43-5cde-4e7c3f153e4c.png)\n\n5. \u51fa\u6765\u305f\uff3c(^o^)\uff0f\n![Addin05.png](https://qiita-image-store.s3.amazonaws.com/0/31791/8fe173b7-43b3-fcc4-7a54-11060dfa0ee1.png)\n\n6. \u5f8c\u306f\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u30ac\u30ea\u30ac\u30ea\u66f8\u3044\u3066\u3044\u304f\u3060\u3051\u3067\u3059\u3002(\u3048\u3063\n\n\n# \u7c21\u5358\u306b\u30c7\u30d0\u30c3\u30b0\u30fb\u4f5c\u6210\u306e\u6d41\u308c\n1. \u4f5c\u6210\u3057\u305f\u30a2\u30c9\u30a4\u30f3\u3092\u5b9f\u884c[\u30c4\u30fc\u30eb\u2192(\u3055\u3063\u304d\u3064\u3051\u305f\u30a2\u30c9\u30a4\u30f3\u540d)]\u3057\u3066\u307f\u308b\u3068\u3001\u65b0\u3057\u3044VisualStudio\u304c\u958b\u304d\u307e\u3059\u3002\n2. \u3068\u308a\u3042\u3048\u305a\u3001\u30a2\u30c9\u30a4\u30f3\u306eConnect.cs\u306eExec\u306b\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\u3092\u5f35\u3063\u3066\u30a2\u30c9\u30a4\u30f3\u3092\u5b9f\u884c\u3057\u3066\u307f\u308b\u3068\u3001Exec\u304c\u547c\u3070\u308c\u308b\u306e\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002\u4ed6\u306b\u3001\u30a2\u30c9\u30a4\u30f3\u304c\u63a5\u7d9a\u3055\u308c\u305f\u6642\u306b\u547c\u3070\u308c\u308bOnConnection\u3084\u30a2\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u305f\u6642\u306eOnDisconnection\u306a\u3069\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u304c\u5e7e\u3064\u304b\u7528\u610f\u3055\u308c\u3066\u308b\u3002\n3. \u3042\u3068\u306f\u3044\u3044\u611f\u3058\u306b\u30b3\u30fc\u30c9\u3092\u30ac\u30ea\u30ac\u30ea\u66f8\u3044\u305f\u3089\u5b8c\u6210\uff3c(^o^)\uff0f\n\n## Form\u3092\u4f5c\u308a\u305f\u3044\u5834\u5408\n* \u53c2\u7167\u8ffd\u52a0\n![Addin06.png](https://qiita-image-store.s3.amazonaws.com/0/31791/bc60c372-0213-60e2-5e6e-1b67dac3b1d1.png)\n![Addin07.png](https://qiita-image-store.s3.amazonaws.com/0/31791/ab946fc6-d237-f5f7-ee84-a36b6e7d929b.png)\n\n* \u30d5\u30a9\u30fc\u30e0\u8ffd\u52a0\n![Addin08.png](https://qiita-image-store.s3.amazonaws.com/0/31791/f1e896a8-b8b2-e925-5053-9b2d1a9e3390.png)\n\n* \u30d5\u30a9\u30fc\u30e0\u751f\u6210\n\n```ruby:connetc.cs\nusing System.Windows.Forms;\nnamespace MyAddin1\n{\n\n\tpublic class Connect : IDTExtensibility2, IDTCommandTarget\n\t{\n\t\tpublic Connect()\n\t\t{\n\t\t}\n\n          \n\t\tpublic void Exec(string commandName, vsCommandExecOption executeOption, ref object varIn, ref object varOut, ref bool handled)\n\t\t{\n\t\t\thandled = false;\n\t\t\tif(executeOption == vsCommandExecOption.vsCommandExecOptionDoDefault)\n\t\t\t{\n\t\t\t\tif(commandName == \"MyAddin1.Connect.MyAddin1\")\n\t\t\t\t{\n\t\t\t\t\thandled = true;\n\n\t\t\t\t\t// \u30d5\u30a9\u30fc\u30e0\u751f\u6210\u30fb\u8868\u793a\n\t\t\t\t\tForm1 form = new Form1();\n\t\t\t\t\tform.Show();\n\t\t\t\t\t// \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a\u3092\u5f04\u308a\u305f\u3044\u306e\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u6e21\u3057\u3066\u304a\u304f(Form1\u306b\u95a2\u6570\u8ffd\u52a0)\n\t\t\t\t\tform.SetDTE(_applicationObject);\n\n\t\t\t\t\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprivate DTE2 _applicationObject;\n\t\tprivate AddIn _addInInstance;\n\n```\n\n* \u30a2\u30c9\u30a4\u30f3\u3092\u5b9f\u884c\u3057\u305f\u3089\u3053\u3093\u306a\u611f\u3058\u3002\n![Addin09.png](https://qiita-image-store.s3.amazonaws.com/0/31791/ef5c5978-cd76-dce3-daac-53d94649017d.png)\n\n\n\n## \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\u3092\u30a2\u30c9\u30a4\u30f3\u304b\u3089\u5909\u3048\u3066\u307f\u308b\n\n```ruby:connetc.cs\n        private void button1_Click(object sender, EventArgs e)\n        {\n\n\n\t\t\t// \u30b9\u30bf\u30fc\u30c8\u30a2\u30c3\u30d7\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u53d6\u5f97\n\t\t\tSolutionBuild2 sb = (SolutionBuild2)_DTE.Solution.SolutionBuild;\n\t\t\tProject startupProj;\n\t\t\tstring msg = \"\";\n\n\t\t\tforeach (String item in (Array)sb.StartupProjects)\n\t\t\t{\n\t\t\t\tmsg += item;\n\t\t\t}\n\t\t\tstartupProj = _DTE.Solution.Item(msg);\n\t\t\t\n\t\t\tConfiguration activeConfiguration = startupProj.ConfigurationManager.ActiveConfiguration;\n\n\n\t\t\t// \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u53d6\u5f97\n\t\t\tEnvDTE.Properties configProps = activeConfiguration.Properties;\n\n\t\t\t// \u30b3\u30f3\u30d5\u30a3\u30b0\u4e00\u89a7\u3092\u51fa\u529b\n\t\t\tforeach (EnvDTE.Property p in configProps)\n\t\t\t{\n\t\t\t\tDebug.Print(p.Name);\n\t\t\t}\n\n\t\t\t// \u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u5909\u66f4\u3057\u3066\u307f\u308b\n\t\t\tEnvDTE.Property prop;\n\t\t\tprop = configProps.Item(\"Command\");\n\t\t\tprop.Value = \"-window\";\n\n\t\t}\n\n```\n\n\n## \u305d\u306e\u4ed6\u30e1\u30e2\n* \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u4f9d\u5b58\u3057\u306a\u3044VC\u56fa\u6709\u306e\u8a2d\u5b9a\uff1f\u306fProject\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092Microsoft.VisualStudio.VCProjectEngine\u306eVCProject\u306b\u30ad\u30e3\u30b9\u30c8\u3057\u3066\u8fbf\u3089\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u307f\u305f\u3044\u3002\u9762\u5012\u3002\u3002\u3002\n\n* \u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u3067\u3082\u4f7f\u3048\u308b\u30a2\u30c9\u30a4\u30f3\u3063\u3066\u306e\u304c\u4f5c\u308c\u308b\u306e\u3067\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u306e\u30d3\u30eb\u30c9\u3057\u3066\u3082\u4f7f\u3048\u305d\u3046\uff1f(\u8abf\u67fb\u4e2d)\n\n* \u30a2\u30c9\u30a4\u30f3\u306e\u914d\u5e03\nhttp://www.atmarkit.co.jp/fdotnet/special/vsaddinintro03/vsaddinintro03_01.html\n", "tags": ["VisualStudio"]}