{"context": "\n\n\u5b9f\u73fe\u3057\u305f\u3044\u3053\u3068\n\u8907\u6570\u306e\u30b5\u30fc\u30d0\u9593\u3067\u4efb\u610f\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u540c\u671f\uff08\u53cc\u65b9\u5411\uff09\u3057\u305f\u3044\n\n\u74b0\u5883\n\n\u30b5\u30fc\u30d0\uff11\n\n\nOS\uff1aCentOS release 6.5 (Final)\nip\uff1a10.102.55.101\u3068\u3057\u307e\u3059\u3002\n\n\n\u30b5\u30fc\u30d0\uff12\n\n\nOS\uff1aCentOS release 6.8 (Final)\nip\uff1a10.102.55.103\u3068\u3057\u307e\u3059\u3002\n\n\n\u540c\u671f\u3057\u305f\u3044\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n\n\n/opt/share\n\n\nrsync\n\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\uff1aVersion 3.0.6  protocol version 30\nrsync \u3092 \u30c7\u30fc\u30e2\u30f3\u30e2\u30fc\u30c9\u3067\u52d5\u4f5c\u3055\u305b\u3001rsyncd(\u30b5\u30fc\u30d0)\u3068\u3057\u3066\u5229\u7528\u3059\u308b\n\n\nlsyncd\n\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\uff1aVersion: 2.1.5\n\n\nxinetd\n\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\uff1aVersion 2.3.14 libwrap loadavg\n\n\n\n\n\u524d\u63d0\n1.\u540c\u3058\u30bf\u30a4\u30e0\u30b5\u30fc\u30d0\u3067\u3001\u6642\u523b\u304c\u540c\u671f\u3067\u304d\u3066\u3044\u308b\u3053\u3068!\n2.rsyncd\u306f\u3001xinetd\u306e\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\u4f7f\u7528\u3059\u308b\n\nrsync\u3068\u306f\uff1f\n\u30b5\u30fc\u30d0\u9593\u3067\u30d5\u30a1\u30a4\u30eb\u3001\u30c7\u30a3\u30ec\u30c8\u30ea\u3092\u540c\u671f\u3055\u305b\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u30b3\u30de\u30f3\u30c9\n\u30c7\u30fc\u30e2\u30f3\u30e2\u30fc\u30c9\u3067\u52d5\u4f5c\u3055\u305b\u308b\u3053\u3068\u3067\u3001rsyncd(\u30b5\u30fc\u30d0)\u3068\u3057\u3066\u5229\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\n\nlsyncd\u3068\u306f\uff1f\ninotify (\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u30a4\u30d9\u30f3\u30c8\u3092\u76e3\u8996\u3059\u308bLinux\u30ab\u30fc\u30cd\u30eb\u306eAPI ) \u3067 \u540c\u671f\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u65b0\u898f\u4f5c\u6210\u3001\u66f4\u65b0\u3001\u524a\u9664\u306a\u3069\u306e\u5909\u5316\u3092\u691c\u51fa\u3057\u305f\u3089\u3001\u6307\u5b9a\u3057\u305f\u65b9\u5f0f\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3001rsync\uff09\u3067 \u540c\u671f\u5148\u306e\u30d5\u30a1\u30a4\u30eb\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u66f4\u65b0\u3092\u81ea\u52d5\u3067\u884c\u3046\u3082\u306e\u3067\u3059\u3002\n\n\u4f5c\u696d\u306e\u6d41\u308c\n\u4eca\u56de\u306f\u3001\u53cc\u65b9\u5411\u540c\u671f\u3092\u5b9f\u73fe\u3057\u305f\u3044\u306e\u3067\u3001\u540c\u3058\u30bb\u30c3\u30c6\u30a3\u30f3\u30b0\u3092\uff12\u3064\u306e\u30b5\u30fc\u30d0\u3067\u884c\u3044\u307e\u3059\u3002\n1.rsync lsyncd xinetd\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install rsync lsyncd xinetd\n\n*\u5fc5\u8981\u306b\u5fdc\u3058\u3066Lua\u306e\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum -y install libxml2-devel lua-devel lua-static\n\n2.Lua\u306e\u74b0\u5883\u5909\u6570\u8a2d\u5b9a\n\u4eca\u56de\u306f\u3001root\u306e.bash_profile\u306b\u8ffd\u52a0\n\n/root/.bash_profile\nexport LUA_CFLAGS='-I/usr/include -lm -ldl'\nexport LUA_LIBS='/usr/lib/liblua.a'\n\n\n2.\u30b3\u30d4\u30fc\u5148\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\n# mkdir /opt/share\n\n3.\u30b3\u30d4\u30fc\u5148\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6a29\u9650\u5909\u66f4\n# chown nobody:nobody /opt/share\n\n4.rsync\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\u3068\u7de8\u96c6\n\n\u30b5\u30fc\u30d01(10.102.55.101\u5074)\n\n\n/etc/rsyncd.conf\nuid = root\ngid = root\nlog file = /var/log/rsyncd.log\npid file = /var/run/rsyncd.pid\n\n[share]\npath=/opt/share\nhosts allow = 10.102.55.103\nread only = no\n\n\n\n\u30b5\u30fc\u30d02(10.102.55.103\u5074)\n\n\n/etc/rsyncd.conf\nuid = root\ngid = root\nlog file = /var/log/rsyncd.log\npid file = /var/run/rsyncd.pid\n\n[share]\npath=/opt/share\nhosts allow = 10.102.55.101\nread only = no\n\n\n5.lsyncd\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n*settings\u306e\u3068\u3053\u308d\u306b=\u306f\u4e0d\u8981\n\n/etc/lsyncd.conf\n\u00d7 settings = {\n\u25cb settings {\n\n\n\n\u30b5\u30fc\u30d01(10.102.55.101\u5074)\n\n\n/etc/lsyncd.conf\nsettings {\n        logfile    = \"/var/log/lsyncd.log\",\n        statusFile = \"/tmp/lsyncd.stat\",\n        statusInterval = 1,\n}\nsync{\n        default.rsync,\n        delay = 0,\n        source=\"/opt/share/\",\n        target=\"10.102.55.103:/opt/share/\",\n        delete=\"running\",\n        rsync  = {\n                archive = true,\n                links   = true,\n                update  = true,\n                verbose = true\n        }\n}\n\n\n\n\u30b5\u30fc\u30d02(10.102.55.103\u5074)\n\n\n/etc/lsyncd.conf\nsettings {\n        logfile    = \"/var/log/lsyncd.log\",\n        statusFile = \"/tmp/lsyncd.stat\",\n        statusInterval = 1,\n}\nsync{\n        default.rsync,\n        delay = 0,\n        source=\"/opt/share/\",\n        target=\"10.102.55.101:/opt/share/\",\n        delete=\"running\",\n        rsync  = {\n                archive = true,\n                links   = true,\n                update  = true,\n                verbose = true\n        }\n}\n\n\n6.RSA\u9375\u30da\u30a2(\u516c\u958b\u9375\uff0f\u79d8\u5bc6\u9375)\u4f5c\u6210\n# ssh-keygen -t rsa -N \"\"\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/root/.ssh/id_rsa):\n\n\u3053\u306e\u5f8c\u3001\u7a7aEnter\n7.RSA\u9375(\u516c\u958b\u9375)\u3092\u5bfe\u5411\u30b5\u30fc\u30d0\u3078\u30b3\u30d4\u30fc\n\n\u30b5\u30fc\u30d01 \u2192 \u30b5\u30fc\u30d02\u3078\n\n# scp .ssh/id_rsa.pub 10.102.55.103:/root/.ssh/authorized_keys2\n\n\n\u30b5\u30fc\u30d02 \u2192 \u30b5\u30fc\u30d01\u3078\n\n# scp .ssh/id_rsa.pub 10.102.55.101:/root/.ssh/authorized_keys2\n\n\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3001sshd\u3067\u3001\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u4f7f\u7528\u306e\u307f\u3092\u8a31\u53ef\n\nMatch Address 10.102.55.*\n  PasswordAuthentication yes\n  PermitRootLogin without-password\n  X11Forwarding yes\n\n# /etc/rc.d/init.d/sshd restart\nsshd \u3092\u505c\u6b62\u4e2d:                                             [  OK  ]\nsshd \u3092\u8d77\u52d5\u4e2d:                                             [  OK  ]\n\n5.xinetd\u8d77\u52d5\n# /etc/rc.d/init.d/xinetd restart\nxinetd \u3092\u505c\u6b62\u4e2d:                                           [  NG  ]\nxinetd \u3092\u8d77\u52d5\u4e2d:                                           [  OK  ]\n\n7.rsync\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u3068\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n# chkconfig rsync on\n\n8.lsyncd\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u3068\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n# chkconfig --add lsyncd\n# chkconfig lsyncd on\n# chkconfig\nlsyncd          0:off   1:off   2:on    3:on    4:on    5:on    6:off\nxinetd          0:off   1:off   2:off   3:on    4:on    5:on    6:off\n\nxinetd \u30d9\u30fc\u30b9\u306e\u30b5\u30fc\u30d3\u30b9:\n        rsync:          on\n\n\u4ee5\u4e0a\u306e\u4f5c\u696d\u3067\u30c7\u30fc\u30bf\u304c\u540c\u671f\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n#\u5b9f\u73fe\u3057\u305f\u3044\u3053\u3068\n\u8907\u6570\u306e\u30b5\u30fc\u30d0\u9593\u3067\u4efb\u610f\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u540c\u671f\uff08\u53cc\u65b9\u5411\uff09\u3057\u305f\u3044\n\n#\u74b0\u5883\n- \u30b5\u30fc\u30d0\uff11\n    - OS\uff1aCentOS release 6.5 (Final)\n    - ip\uff1a10.102.55.101\u3068\u3057\u307e\u3059\u3002\n- \u30b5\u30fc\u30d0\uff12\n    - OS\uff1aCentOS release 6.8 (Final)\n    - ip\uff1a10.102.55.103\u3068\u3057\u307e\u3059\u3002\n- \u540c\u671f\u3057\u305f\u3044\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n    - /opt/share\n- rsync\n    - \u30d0\u30fc\u30b8\u30e7\u30f3\uff1aVersion 3.0.6  protocol version 30\n    - rsync \u3092 \u30c7\u30fc\u30e2\u30f3\u30e2\u30fc\u30c9\u3067\u52d5\u4f5c\u3055\u305b\u3001rsyncd(\u30b5\u30fc\u30d0)\u3068\u3057\u3066\u5229\u7528\u3059\u308b\n- lsyncd\n    - \u30d0\u30fc\u30b8\u30e7\u30f3\uff1aVersion: 2.1.5\n- xinetd\n    - \u30d0\u30fc\u30b8\u30e7\u30f3\uff1aVersion 2.3.14 libwrap loadavg\n\n#\u524d\u63d0\n**1.\u540c\u3058\u30bf\u30a4\u30e0\u30b5\u30fc\u30d0\u3067\u3001\u6642\u523b\u304c\u540c\u671f\u3067\u304d\u3066\u3044\u308b\u3053\u3068!**\n**2.rsyncd\u306f\u3001xinetd\u306e\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\u4f7f\u7528\u3059\u308b**\n\n#rsync\u3068\u306f\uff1f\n\u30b5\u30fc\u30d0\u9593\u3067\u30d5\u30a1\u30a4\u30eb\u3001\u30c7\u30a3\u30ec\u30c8\u30ea\u3092\u540c\u671f\u3055\u305b\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u30b3\u30de\u30f3\u30c9\n\u30c7\u30fc\u30e2\u30f3\u30e2\u30fc\u30c9\u3067\u52d5\u4f5c\u3055\u305b\u308b\u3053\u3068\u3067\u3001rsyncd(\u30b5\u30fc\u30d0)\u3068\u3057\u3066\u5229\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\n\n#lsyncd\u3068\u306f\uff1f\ninotify (\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u30a4\u30d9\u30f3\u30c8\u3092\u76e3\u8996\u3059\u308bLinux\u30ab\u30fc\u30cd\u30eb\u306eAPI ) \u3067 \u540c\u671f\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u65b0\u898f\u4f5c\u6210\u3001\u66f4\u65b0\u3001\u524a\u9664\u306a\u3069\u306e\u5909\u5316\u3092\u691c\u51fa\u3057\u305f\u3089\u3001\u6307\u5b9a\u3057\u305f\u65b9\u5f0f\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3001rsync\uff09\u3067 \u540c\u671f\u5148\u306e\u30d5\u30a1\u30a4\u30eb\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u66f4\u65b0\u3092\u81ea\u52d5\u3067\u884c\u3046\u3082\u306e\u3067\u3059\u3002\n\n#\u4f5c\u696d\u306e\u6d41\u308c\n\u4eca\u56de\u306f\u3001\u53cc\u65b9\u5411\u540c\u671f\u3092\u5b9f\u73fe\u3057\u305f\u3044\u306e\u3067\u3001\u540c\u3058\u30bb\u30c3\u30c6\u30a3\u30f3\u30b0\u3092\uff12\u3064\u306e\u30b5\u30fc\u30d0\u3067\u884c\u3044\u307e\u3059\u3002\n\n1.rsync lsyncd xinetd\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum install rsync lsyncd xinetd\n```\n\n*\u5fc5\u8981\u306b\u5fdc\u3058\u3066Lua\u306e\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum -y install libxml2-devel lua-devel lua-static\n```\n\n2.Lua\u306e\u74b0\u5883\u5909\u6570\u8a2d\u5b9a\n\u4eca\u56de\u306f\u3001root\u306e.bash_profile\u306b\u8ffd\u52a0\n\n```/root/.bash_profile\nexport LUA_CFLAGS='-I/usr/include -lm -ldl'\nexport LUA_LIBS='/usr/lib/liblua.a'\n```\n\n2.\u30b3\u30d4\u30fc\u5148\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\n\n```\n# mkdir /opt/share\n```\n\n3.\u30b3\u30d4\u30fc\u5148\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u6a29\u9650\u5909\u66f4\n\n```\n# chown nobody:nobody /opt/share\n```\n\n4.rsync\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\u3068\u7de8\u96c6\n\n\n- \u30b5\u30fc\u30d01(10.102.55.101\u5074)\n\n```/etc/rsyncd.conf\nuid = root\ngid = root\nlog file = /var/log/rsyncd.log\npid file = /var/run/rsyncd.pid\n \n[share]\npath=/opt/share\nhosts allow = 10.102.55.103\nread only = no\n```\n\n- \u30b5\u30fc\u30d02(10.102.55.103\u5074)\n\n```/etc/rsyncd.conf\nuid = root\ngid = root\nlog file = /var/log/rsyncd.log\npid file = /var/run/rsyncd.pid\n \n[share]\npath=/opt/share\nhosts allow = 10.102.55.101\nread only = no\n```\n\n5.lsyncd\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n*settings\u306e\u3068\u3053\u308d\u306b=\u306f\u4e0d\u8981\n\n```/etc/lsyncd.conf\n\u00d7 settings = {\n\u25cb settings {\n```\n\n- \u30b5\u30fc\u30d01(10.102.55.101\u5074)\n\n```/etc/lsyncd.conf\nsettings {\n        logfile    = \"/var/log/lsyncd.log\",\n        statusFile = \"/tmp/lsyncd.stat\",\n        statusInterval = 1,\n}\nsync{\n        default.rsync,\n        delay = 0,\n        source=\"/opt/share/\",\n        target=\"10.102.55.103:/opt/share/\",\n        delete=\"running\",\n        rsync  = {\n                archive = true,\n                links   = true,\n                update  = true,\n                verbose = true\n        }\n}\n```\n\n- \u30b5\u30fc\u30d02(10.102.55.103\u5074)\n\n```/etc/lsyncd.conf\nsettings {\n        logfile    = \"/var/log/lsyncd.log\",\n        statusFile = \"/tmp/lsyncd.stat\",\n        statusInterval = 1,\n}\nsync{\n        default.rsync,\n        delay = 0,\n        source=\"/opt/share/\",\n        target=\"10.102.55.101:/opt/share/\",\n        delete=\"running\",\n        rsync  = {\n                archive = true,\n                links   = true,\n                update  = true,\n                verbose = true\n        }\n}\n```\n\n6.RSA\u9375\u30da\u30a2(\u516c\u958b\u9375\uff0f\u79d8\u5bc6\u9375)\u4f5c\u6210\n\n```\n# ssh-keygen -t rsa -N \"\"\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/root/.ssh/id_rsa):\n```\n\n\u3053\u306e\u5f8c\u3001\u7a7aEnter\n\n7.RSA\u9375(\u516c\u958b\u9375)\u3092\u5bfe\u5411\u30b5\u30fc\u30d0\u3078\u30b3\u30d4\u30fc\n\n- \u30b5\u30fc\u30d01 \u2192 \u30b5\u30fc\u30d02\u3078\n\n```\n# scp .ssh/id_rsa.pub 10.102.55.103:/root/.ssh/authorized_keys2\n```\n\n- \u30b5\u30fc\u30d02 \u2192 \u30b5\u30fc\u30d01\u3078\n\n```\n# scp .ssh/id_rsa.pub 10.102.55.101:/root/.ssh/authorized_keys2\n```\n\n   - \u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3001sshd\u3067\u3001\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u4f7f\u7528\u306e\u307f\u3092\u8a31\u53ef\n\n```/etc/ssh/sshd_config\nMatch Address 10.102.55.*\n  PasswordAuthentication yes\n  PermitRootLogin without-password\n  X11Forwarding yes\n```\n\n```\n# /etc/rc.d/init.d/sshd restart\nsshd \u3092\u505c\u6b62\u4e2d:                                             [  OK  ]\nsshd \u3092\u8d77\u52d5\u4e2d:                                             [  OK  ]\n```\n\n5.xinetd\u8d77\u52d5\n\n```\n# /etc/rc.d/init.d/xinetd restart\nxinetd \u3092\u505c\u6b62\u4e2d:                                           [  NG  ]\nxinetd \u3092\u8d77\u52d5\u4e2d:                                           [  OK  ]\n```\n7.rsync\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u3068\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n\n```\n# chkconfig rsync on\n```\n\n8.lsyncd\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u3068\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n\n```\n# chkconfig --add lsyncd\n# chkconfig lsyncd on\n# chkconfig\nlsyncd          0:off   1:off   2:on    3:on    4:on    5:on    6:off\nxinetd          0:off   1:off   2:off   3:on    4:on    5:on    6:off\n\nxinetd \u30d9\u30fc\u30b9\u306e\u30b5\u30fc\u30d3\u30b9:\n        rsync:          on\n```\n\n\u4ee5\u4e0a\u306e\u4f5c\u696d\u3067\u30c7\u30fc\u30bf\u304c\u540c\u671f\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n", "tags": ["CentOS6.5", "CentOS", "rsync", "lsyncd"]}