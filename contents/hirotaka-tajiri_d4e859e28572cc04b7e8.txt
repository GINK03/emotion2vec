{"context": "\n\n\u6982\u8981\nnginx\u306erpm\u3067ldap\u8a8d\u8a3c\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3082\u306e\u304c\u3001\u898b\u3064\u304b\u3089\u306a\u3044\u306e\u3067\u3001\u81ea\u5206\u3067ldap\u5bfe\u5fdc\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7d44\u307f\u8fbc\u3093\u3067\u3001source\u3088\u308a\u30d3\u30eb\u30c9\u3057\u3066\u3044\u304f\u3001\u524d\u306e\u8a18\u4e8b\u3067\u69cb\u7bc9\u3057\u305f\u30b5\u30fc\u30d0\u30fc \u306bitamae\u3067\u9069\u7528\u3059\u308b\u306e\u3067\u3001rpm\u3068\u30ea\u30dd\u30b8\u30c8\u30ea\u4f5c\u6210\u3059\u308b\n\n\u524d\u6e96\u5099\n\n\u5fc5\u8981\u306a\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u53d6\u5f97\nnginx\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u3088\u308a Mainline version \u306e \nnginx-1.11.3.tar.gz\nnginx-1.11.3.tar.gz.asc\n\u3068\u3001\nnginx-auth-ldap \u306e git\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u30af\u30ed\u30fc\u30f3\u3092\u3059\u308b\n\n\u30d3\u30eb\u30c9\u7528\u30b5\u30fc\u30d0\u30fc\u3067\u4e00\u9023\u306e\u4f5c\u696d\u3092\u884c\u3046\n\u307e\u305f\u3001\u7279\u5225\u306a\u6307\u793a\u304c\u7121\u3044\u9650\u308a\u306f\u3001\u30d3\u30eb\u30c9\u4f5c\u696d\u306f\u4e00\u822c\u30e6\u30fc\u30b6\u30fc\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u884c\u3044\u3001root\u3067\u306f\u884c\u308f\u306a\u3044\u3053\u3068\u306a\u305c\u306a\u3089\u3070\u3001\u9014\u4e2d\u306e\u4f5c\u696d\u3067\u5931\u6557\u3057\u305f\u6642\u306b\u3001\u30b7\u30b9\u30c6\u30e0\u306b\u5b9f\u969b\u306e\u8ffd\u52a0\u306a\u3069\u304c\u884c\u308f\u308c\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3092\u78ba\u4fdd\u3059\u308b\u305f\u3081\n\n(root\u30e6\u30fc\u30b6\u30fc\u3067)\u30d3\u30eb\u30c9\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u307e\u3068\u3081\u3066\u8ffd\u52a0\u3059\u308b\n\n# root\u30e6\u30fc\u30b6\u30fc\u3067\u30d3\u30eb\u30c9\u7528\u306e\u958b\u767a\u30c4\u30fc\u30eb\u30b0\u30eb\u30fc\u30d7\u3092\u307e\u3068\u3081\u3066\u8ffd\u52a0\u3059\u308b\nsudo yum groupinstall \"Development Tools\"\nsudo yum install createrepo\n\n\n(root\u30e6\u30fc\u30b6\u30fc\u3067)\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u4fdd\u5b58\u30c7\u30a3\u30ec\u30af\u30c8\u30ea[rpm_src]\u3092\u4f5c\u6210\u3057\u3001(\u30d3\u30eb\u30c9\u30e6\u30fc\u30b6\u30fc\u3067)\u5fc5\u8981\u306a\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u96c6\u3081\u308b\n\n\n# root\u30e6\u30fc\u30b6\u30fc\u3067\u5143\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092766\u306b\u5909\u66f4\nsudo mkdir /usr/local/src/rpm_src\nsudo chmod 766 /usr/local/src/rpm_src\ncd /usr/local/src/rpm_src\n\n# \u30d3\u30eb\u30c9\u30e6\u30fc\u30b6\u30fc\u3067\u5404\u30d1\u30c3\u30b1\u30fc\u30b8\u7528\u306e\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u96c6\u3081\u308b\nmkdir nginx\ncd nginx\nwget  https://nginx.org/download/nginx-1.11.3.tar.gz\nwget\u3000https://nginx.org/download/nginx-1.11.3.tar.gz.asc\ngit  clone https://github.com/kvspb/nginx-auth-ldap.git\n\n\nnginx\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u95a2\u3057\u3066\u3001\u6539\u7ac4\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3046\n\nsudo gpg --verify nginx-1.11.3.tar.gz.asc \n\n#=> gpg: 2016\u5e7407\u670826\u65e5 22\u664259\u520649\u79d2 JST\u306bRSA\u9375ID A1C052F8\u3067\u65bd\u3055\u308c\u305f\u7f72\u540d\n#=> gpg: \"Maxim Dounin <mdounin@mdounin.ru>\"\u304b\u3089\u306e\u6b63\u3057\u3044\u7f72\u540d\n#=> gpg: *\u8b66\u544a*: \u3053\u306e\u9375\u306f\u4fe1\u7528\u3067\u304d\u308b\u7f72\u540d\u3067\u8a3c\u660e\u3055\u308c\u3066\u3044\u307e\u305b\u3093!\n#=> gpg:       \u3053\u306e\u7f72\u540d\u304c\u6240\u6709\u8005\u306e\u3082\u306e\u304b\u3069\u3046\u304b\u306e\u691c\u8a3c\u624b\u6bb5\u304c\u3042\u308a\u307e\u305b\u3093\u3002\n#=> \u4e3b\u9375\u306e\u30d5\u30a3\u30f3\u30ac\u30fc\u30fb\u30d7\u30ea\u30f3\u30c8: B0F4 2533 73F8 F6F5 10D4  2178 520A #=> 9993 A1C0 52F8\n\n\u7f72\u540d\u8005\u304cnginx\u306e\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30b5\u30a4\u30c8\u306b\u3042\u308b\u3001Maxim Dounin\u6c0f\u306a\u306e\u3067\u554f\u984c\u306a\u3057\u3001git\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u95a2\u3057\u3066\u306f\u3001git\u306a\u306e\u3067\u554f\u984c\u306a\u3057\u3068\u3059\u308b\n\n\u4eca\u5f8c\u306e\u4f5c\u696d\u306e\u305f\u3081\u306bnginx-auth-ldap\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3001tar.gz\u30d5\u30a1\u30a4\u30eb\u306b\u307e\u3068\u3081\u308b\n\ntar -zcf nginx-auth-ldap.tar.gz nginx-auth-ldap\n\n\ntar.gz \u306b\u307e\u3068\u3081\u305f\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u4f7f\u3044\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u901a\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3\u306fnginx\u306e\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30b5\u30a4\u30c8\u306eMain line\u306eConfigure Arguments\u306b\u3059\u308b\n\n# \u30d3\u30eb\u30c9\u306e\u30c1\u30a7\u30c3\u30af\u306f /tmp \u3067\u884c\u3046\ntar -zxf nginx-1.11.3.tar.gz -C /tmp\ntar -zxf nginx-auth-ldap.tar.gz -C /tmp/nginx-1.11.3/\n\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u5c55\u958b\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u306b\u79fb\u52d5\u3057\u3001configure\u3059\u308b\ncd /tmp/nginx-1.11.3\n\nLDFLAGS=\"-L/usr/lib64\" \\\n\"./configure\" \\\n\"--prefix=/etc/nginx\" \\\n\"--sbin-path=/usr/sbin/nginx\" \\\n\"--conf-path=/etc/nginx/nginx.conf\" \\\n\"--error-log-path=/var/log/nginx/error.log\" \\\n\"--http-log-path=/var/log/nginx/access.log\" \\\n\"--pid-path=/var/run/nginx.pid\" \\\n\"--lock-path=/var/run/nginx.lock\" \\\n\"--http-client-body-temp-path=/var/cache/nginx/client_temp\" \\\n\"--http-proxy-temp-path=/var/cache/nginx/proxy_temp\" \\\n\"--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp\" \\\n\"--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp\" \\\n\"--http-scgi-temp-path=/var/cache/nginx/scgi_temp\" \\\n\"--user=nginx\" \\\n\"--group=nginx\" \\\n\"--with-http_ssl_module\" \\\n\"--with-http_realip_module\" \\\n\"--with-http_addition_module\" \\\n\"--with-http_sub_module\" \\\n\"--with-http_dav_module\" \\\n\"--with-http_flv_module\" \\\n\"--with-http_mp4_module\" \\\n\"--with-http_gunzip_module\" \\\n\"--with-http_gzip_static_module\" \\\n\"--with-http_random_index_module\" \\\n\"--with-http_secure_link_module\" \\\n\"--with-http_stub_status_module\" \\\n\"--with-http_auth_request_module\" \\\n\"--with-threads\" \\\n\"--with-stream\" \\\n\"--with-stream_ssl_module\" \\\n\"--with-http_slice_module\" \\\n\"--with-mail\" \\\n\"--with-mail_ssl_module\" \\\n\"--with-file-aio\" \\\n\"--with-http_v2_module\" \\\n\"--with-ipv6\" \\\n\"--add-module=nginx-auth-ldap\"\n\n# configure \u304c\u901a\u308c\u3070\u3001make\u307e\u3067\u3059\u3059\u3081\u308b\nmake\n\nMain line\u306eConfigure Arguments\u306b\u52a0\u3048\u3001\u660e\u78ba\u306b64bit\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u3059\u308b\u305f\u3081\u306b\u3001LDFLAGS=\"-L/usr/lib64\" \u3068ldap\u5bfe\u5fdc\u306e\u305f\u3081\u306b\u3001--add-module=nginx-auth-ldap \u3092\u8ffd\u52a0\u3059\u308b\n\nrpm\u4f5c\u6210\u306e\u672c\u4f5c\u696d\n\nrpm\u30d3\u30eb\u30c9\u30e6\u30fc\u30b6\u30fc\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3001rpm\u5316\u4f5c\u696d\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n\ncd\nmkdir rpmbuild\ncd rpmbuild\nmkdir BUILD  BUILDROOT  RPMS  SOURCES  SPECS  SRPMS\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30d5\u30a1\u30a4\u30eb\u4ee5\u5916\u3092rpm\u306b\u542b\u3081\u308b\u5834\u5408\u306b\u306f\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6e96\u5099\u3059\u308b\n\n\u672c\u4ef6\u3067\u306f\u3001\u30bd\u30fc\u30b9\u304b\u3089\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u306a\u3044\u3001\u30ed\u30b0\u30ed\u30fc\u30c6\u30fc\u30c8\u7528\u306e\u30d5\u30a1\u30a4\u30eb(nginx)\u3068\u3001systemctl\u7528\u306e\u30d5\u30a1\u30a4\u30eb(nginx.service) \u3092rpm\u5316\u3059\u308b\u30bd\u30fc\u30b9\u985e\u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3059\u308b\n  (\u672c\u4ef6\u3060\u3068 /usr/local/src/rpm_src/nginx \u5185\u306b\u4f5c\u6210)\n\nnginx\n/var/log/nginx/*log {\n    create 0644 nginx nginx\n    daily\n    rotate 5\n    missingok\n    notifempty\n    compress\n    sharedscripts\n    postrotate\n        /bin/kill -HUP `cat /var/run/nginx.pid` 2>/dev/null\n    endscript\n}\n\n\n\nnginx.service\n[Unit]\nDescription=The nginx HTTP server\nAfter=network.target remote-fs.target nss-lookup.target\n\n[Service]\nType=forking\nPIDFile=/run/nginx.pid\nExecStartPre=/usr/bin/rm -f /run/nginx.pid\nExecStartPre=/usr/sbin/nginx -t\nExecStart=/usr/sbin/nginx\nExecReload=/bin/kill -s HUP $MAINPID\nKillMode=process\nKillSignal=SIGQUIT\nTimeoutStopSec=5\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n\n\n\nrpm\u4f5c\u6210\u306e\u305f\u3081\u306b\u3001spec\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\nrpm\u5316\u3059\u308b\u30bd\u30fc\u30b9\u985e\u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3059\u308b\u3068\u3088\u3044\n(\u672c\u4ef6\u3060\u3068 /usr/local/src/rpm_src/nginx \u5185\u306b\u4f5c\u6210)\n\u307e\u305f\u3001\u672c\u4ef6\u3067\u306fnginx\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u304c\u3001\u81ea\u5206\u3067\u4f5c\u6210\u3057\u305fnginx\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u3001\u4ed6\u304c\u4f5c\u6210\u3057\u305fnginx\u3068\u3092\u533a\u5225\u3059\u308b\u305f\u3081\u306b\u3001nginx_myrpm\u3068\u3057\u3066\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3059\u308b\n\nnginx_myrpm.spec\nSummary: Nginx webserver (with ssl, ldap-auth)\nName: nginx_myrpm\nVersion: 1.11.3\nRelease: 1.el7\nLicense: BSD-like\nGroup: Web-server-environment\nSource0: nginx-1.11.3.tar.gz\nSource1: nginx-auth-ldap.tar.gz\nSource2: nginx\nSource3: nginx.service\nBuildRoot: %{_tmppath}/%{name}-%{version}-buildroot\nBuildRequires: openldap-devel,openssl-devel,zlib-devel,pcre-devel\nRequires: openldap,openssl,zlib,pcre\nConflicts: nginx\n\n%description\nnginx webserver with ssl, ldap-auth\n\n%prep\n[ -d $RPM_BUILD_ROOT ] && rm -rf $RPM_BUILD_ROOT;\n\n%setup -a 1 -q -n nginx-%{version}\n\n%build\n[ -d $RPM_BUILD_ROOT ] && rm -rf $RPM_BUILD_ROOT;\nLDFLAGS=\"-L/usr/lib64\" \\\n\"./configure\" \\\n\"--prefix=/etc/nginx\" \\\n\"--sbin-path=/usr/sbin/nginx\" \\\n\"--conf-path=/etc/nginx/nginx.conf\" \\\n\"--error-log-path=/var/log/nginx/error.log\" \\\n\"--http-log-path=/var/log/nginx/access.log\" \\\n\"--pid-path=/var/run/nginx.pid\" \\\n\"--lock-path=/var/run/nginx.lock\" \\\n\"--http-client-body-temp-path=/var/cache/nginx/client_temp\" \\\n\"--http-proxy-temp-path=/var/cache/nginx/proxy_temp\" \\\n\"--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp\" \\\n\"--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp\" \\\n\"--http-scgi-temp-path=/var/cache/nginx/scgi_temp\" \\\n\"--user=nginx\" \\\n\"--group=nginx\" \\\n\"--with-http_ssl_module\" \\\n\"--with-http_realip_module\" \\\n\"--with-http_addition_module\" \\\n\"--with-http_sub_module\" \\\n\"--with-http_dav_module\" \\\n\"--with-http_flv_module\" \\\n\"--with-http_mp4_module\" \\\n\"--with-http_gunzip_module\" \\\n\"--with-http_gzip_static_module\" \\\n\"--with-http_random_index_module\" \\\n\"--with-http_secure_link_module\" \\\n\"--with-http_stub_status_module\" \\\n\"--with-http_auth_request_module\" \\\n\"--with-threads\" \\\n\"--with-stream\" \\\n\"--with-stream_ssl_module\" \\\n\"--with-http_slice_module\" \\\n\"--with-mail\" \\\n\"--with-mail_ssl_module\" \\\n\"--with-file-aio\" \\\n\"--with-http_v2_module\" \\\n\"--with-ipv6\" \\\n\"--add-module=nginx-auth-ldap\"\nmake\n\n%install\n[ -d $RPM_BUILD_ROOT ] && rm -rf $RPM_BUILD_ROOT;\nmake install DESTDIR=${RPM_BUILD_ROOT}\nmkdir -p ${RPM_BUILD_ROOT}/etc/logrotate.d/\nmkdir -p ${RPM_BUILD_ROOT}/usr/lib/systemd/system/\nmkdir -p ${RPM_BUILD_ROOT}/var/lib/nginx/tmp\nmkdir -p ${RPM_BUILD_ROOT}/var/log/nginx\nmkdir -p ${RPM_BUILD_ROOT}/var/cache/nginx\ninstall -m 644 %{SOURCE2} ${RPM_BUILD_ROOT}/etc/logrotate.d/\ninstall -m 755 %{SOURCE3} ${RPM_BUILD_ROOT}/usr/lib/systemd/system/\n\n%clean\n[ -d $RPM_BUILD_ROOT ] && rm -rf $RPM_BUILD_ROOT;\n\n%pre\ngroupadd nginx\nuseradd nginx -g nginx -s /sbin/nologin -d /etc/nginx -c \"Nginx web server\"\n\n%postun\nuserdel nginx -rf\n\n%files\n%defattr(644,nginx,nginx)\n   /etc/logrotate.d/nginx\n   /etc/nginx/fastcgi.conf\n   /etc/nginx/fastcgi.conf.default\n   /etc/nginx/fastcgi_params\n   /etc/nginx/fastcgi_params.default\n   /etc/nginx/html/50x.html\n   /etc/nginx/html/index.html\n   /etc/nginx/koi-utf\n   /etc/nginx/koi-win\n   /etc/nginx/mime.types\n   /etc/nginx/mime.types.default\n   /etc/nginx/nginx.conf\n   /etc/nginx/nginx.conf.default\n   /etc/nginx/scgi_params\n   /etc/nginx/scgi_params.default\n   /etc/nginx/uwsgi_params\n   /etc/nginx/uwsgi_params.default\n   /etc/nginx/win-utf\n   /var/lib/nginx\n   /var/lib/nginx/tmp\n   /var/log/nginx\n   /var/cache/nginx/\n%defattr(755,nginx,nginx)\n   /usr/lib/systemd/system/nginx.service\n   /usr/sbin/nginx\n\n%changelog\n* Thu Sep 8 2016 Hirotaka Tajiri <ganryu_koziro@excite.co.jp> 1-11-3.1\n- first build\n\n\n\n\u25c7spec\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306e\u8aac\u660e \n \u25bc \u5192\u982d\u90e8\u5206(\u74b0\u5883\u5909\u6570\u306a\u3069)\n\n\n\n\u9805\u76ee\n\u5185\u5bb9\n\n\n\n\nSummary:\nrpm\u306e\u6982\u8981\u8aac\u660e\n\n\nName:\nrpm\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\n\n\nVersion:\nrpm\u306e\u30d9\u30fc\u30b9\u306b\u306a\u308b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\n\n\nRelease:\nrpm\u306e\u30ea\u30ea\u30fc\u30b9\u756a\u53f7\n\n\nLicense:\nrpm\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\n\n\nGroup:\nrpm\u306e\u30b0\u30eb\u30fc\u30d7(yum groupinstall\u6642\u306b\u5fc5\u8981)\n\n\nSource(n):\nrpm\u5316\u4f5c\u696d\u3067\u4f7f\u7528\u3059\u308b\u30d5\u30a1\u30a4\u30eb\n\n\nBuildRoot:\n\u4f5c\u696d\u5834\u6240 %{_tmppath}/%{name}-%{version}-buildroot \u3067OK\n\n\nBuildRequires:\nrpm\u5316\u4f5c\u696d\u6642\u306b\u5fc5\u8981\u306b\u306a\u308b\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\n\n\nRequires:\n\u4f5c\u6210\u3057\u305frpm\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u540c\u6642\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\n\n\nConflicts:\n\u540c\u6642\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u306a\u3044\u5171\u5b58\u4e0d\u53ef\u30d1\u30c3\u30b1\u30fc\u30b8\n\n\n\n\u25bc \u672c\u4f53\u90e8\u5206\n\u25bd %description\n\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5185\u5bb9\u8aac\u660e\n\n\u25bd %prep\n\u672c\u4f5c\u696d\u524d\u306b\u5b9f\u884c\u3055\u308c\u308b\u3001\u4e88\u5099\u4f5c\u696d\u3002\u672c\u4ef6\u3067\u306f $RPM_BUILD_ROOT \u306e\u521d\u671f\u5316\u3092\u884c\u3046\n\n\u25bd %setup \n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u5c55\u958b\u3092\u304a\u3053\u306a\u3046\n\u610f\u5473\u3068\u3057\u3066\u306f\u3001 \n%setup -q \u3067 \nSOURCE0 \u3092 ~/rpmbuild/BUILD \u3078\u5c55\u958b\u3057\u3001\ncd ~/rpmbuild/BUILD/[Name]-[VERSION] \u3059\u308b\n(-q \u306f\u5c55\u958b\u304c\u30b5\u30a4\u30ec\u30f3\u30c8\u30e2\u30fc\u30c9\u3068\u3044\u3046\u610f\u5473)\n\u672c\u4ef6\u3067\u306f\u3001\n%setup -a 1 -q -n nginx-%{version} \u3067\nSOURCE0 \u3092 ~/rpmbuild/BUILD \u3078\u30b5\u30a4\u30ec\u30f3\u30c8\u30e2\u30fc\u30c9\u3067\u5c55\u958b\u3057\u3000\n-a 1 \u3067 SOURCE1 \u3092\u5c55\u958b\u5f8c\u306e\u4e2d\u306b\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u5c55\u958b\u3057 \n-n \u3067 cd\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u3092\u3000~/rpmbuild/BUILD/[Name]-[VERSION]\n\u3067\u306f\u306a\u304f\u3001~/rpmbuild/BUILD/nginx-[VERSION] \u306b\u3059\u308b\u3068\u6307\u5b9a\u3057\u3066\u3044\u308b\n\n\u25bd %build\nconfigure \u304b\u3089 make \u307e\u3067\u306e\u3084\u308a\u65b9\u3092\u8a18\u8f09\u3059\u308b\n\n\u25bd %install\nrpm\u5316\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u914d\u7f6e\n\u901a\u5e38\u3068\u304a\u308amake install\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3068\nconfigure\u3067\u6307\u5b9a\u3057\u305f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5148\u306b\u76f4\u63a5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3001\nrpm\u30d5\u30a1\u30a4\u30eb\u4f5c\u696d\u5834\u6240 \\${RPM_BUILD_ROOT} \u306b\u914d\u7f6e\u3055\u308c\u306a\u3044\n\u305d\u306e\u305f\u3081\u3001make install DESTDIR=\\${RPM_BUILD_ROOT} \n\u3068\u6307\u5b9a\u3057\u3066\u3001\\${RPM_BUILD_ROOT}\u4ee5\u4e0b\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\u307e\u305f\u3001make install\u3067\u306a\u304f\u3001\u76f4\u63a5\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u914d\u7f6e\u3059\u308b\u5834\u5408\u306b\u306f\nmkdir -p \\${RPM_BUILD_ROOT}/etc/logrotate.d/ \u3084\ninstall -m 644 %{SOURCE2} \\${RPM_BUILD_ROOT}/etc/logrotate.d/\n\u3067\u914d\u7f6e\u3059\u308b\n\n\u25bd %clean\nrpm\u5316\u4f5c\u696d\u5f8c\u51e6\u7406\u3092\u8a18\u8f09\u3059\u308b\n\n\u25bd %pre\n\u4f5c\u6210\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306e\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u524d\u4f5c\u696d\u3092\u8a18\u8f09\u3059\u308b\n\u672c\u4ef6\u3067\u306f\u3001nginx\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u3092\u8a18\u8f09\u3057\u3066\u3044\u308b\n\n\u25bd %postun\n\u4f5c\u6210\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306e\u5f8c\u51e6\u7406\u3092\u8a18\u8f09\u3059\u308b\n\u672c\u4ef6\u3067\u306f\u3001nginx\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u30a2\u30ab\u30a6\u30f3\u30c8\u524a\u9664\u3092\u8a18\u8f09\u3057\u3066\u3044\u308b\n\n\u25bd %files\u3000%defattr\nrpm\u5316\u914d\u7f6e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea \\${RPM_BUILD_ROOT} \u306b\u914d\u7f6e\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u81ea\u52d5\u7684\u306b\nrpm\u5316\u3055\u308c\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u3001rpm\u306b\u542b\u3080\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u6307\u5b9a\u3059\u308b\n\u307e\u305f\u3001%defattr\u3067\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30aa\u30fc\u30ca\u30fc,\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u307e\u3068\u3081\u3066\u6307\u5b9a\u3059\u308b\n\n\nspec\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u30bd\u30fc\u30b9\u985e\u3001spec\u30d5\u30a1\u30a4\u30eb\u306e\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3059\u308b\n\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3059\u308b\nln -s /usr/local/src/rpm_src/nginx/nginx ~/rpmbuild/SOURCES/\nln -s /usr/local/src/rpm_src/nginx/nginx.service ~/rpmbuild/SOURCES/\nln -s /usr/local/src/rpm_src/nginx/nginx-auth-ldap.tar.gz ~/rpmbuild/SOURCES/\nln -s /usr/local/src/rpm_src/nginx/nginx-1.11.3.tar.gz ~/rpmbuild/SOURCES/\n# spec\u30d5\u30a1\u30a4\u30eb\nln -s /usr/local/src/rpm_src/nginx/nginx_myrpm.spec ~/rpmbuild/SPECS\n\n\nrpmbuild\u30b3\u30de\u30f3\u30c9\u3067rpm\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n\u7d30\u304b\u3044bpmbuild\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u8a73\u3057\u3044\u8aac\u660e\u306f\u5272\u611b\ncd ~/rpmbuild/SPECS\n\n# rpm\u4f5c\u6210\nrpmbuild -bb nginx_myrpm.spec\n\n\nrpm\u306e\u78ba\u8a8d\u4f5c\u696d\n\n\u30a8\u30e9\u30fc\u3067\u30b9\u30c8\u30c3\u30d7\u3057\u306a\u3051\u308c\u3070\u3001\u4f5c\u6210\u7d42\u4e86\u3057\u3066\u3044\u308b\u306e\u3067\u3001rpm\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u78ba\u8a8d\u3092\u884c\u3046\n# 64bit\u30d1\u30c3\u30b1\u30fc\u30b8\u306a\u306e\u3067~/rpmbuild/RPMS/x86_64\u306b\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\ncd ~/rpmbuild/RPMS/x86_64\n\n# rpm \u30a4\u30f3\u30d5\u30a9\u30e1\u30fc\u30b7\u30e7\u30f3\u306e\u78ba\u8a8d\nrpm -qpi nginx_myrpm-1.11.3-1.el7.x86_64.rpm \n\n# rpm\u542b\u6709\u30d5\u30a1\u30a4\u30eb\u306e\u78ba\u8a8d\nrpm -qpl nginx_myrpm-1.11.3-1.el7.x86_64.rpm \n\n\nyum\u30ea\u30dd\u30b8\u30c8\u30ea\u5316\n\u4f5c\u6210\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u3092\u3001\u72ec\u81ea\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u8ffd\u52a0\u3059\u308b\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u5143\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\n\n\u30d3\u30eb\u30c9\u5143\u30b5\u30fc\u30d0\u30fc\u3067\u3042\u308a\u3001itamae\u5b9f\u884c\u30b5\u30fc\u30d0\u30fc\u3067\u3042\u308b\u3001centos7\u2212admin \u306b\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n# root\u3067\u30ea\u30dd\u30b8\u30c8\u30ea\u5143\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\nsu -\nmkdir -p /var/lib/myrepo_dir/el7\n\n\nrpm\u30d5\u30a1\u30a4\u30eb\u3092\u30ea\u30dd\u30b8\u30c8\u30ea\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30b3\u30d4\u30fc\u3057\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u5316\u3059\u308b\n\n# root\u3067\u30b3\u30d4\u30fc\nsu -\ncd /var/lib/myrepo_dir/el7\nmkdir x86_64\n\n# rpm\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc(\u30d3\u30eb\u30c9\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3092xxx\u3068\u4eee\u5b9a\u3059\u308b)\ncp /home/xxx/rpmbuild/RPMS/x86_64/nginx_myrpm-1.11.3-1.el7.x86_64.rpm x86_64/\n\n# \u30ea\u30dd\u30b8\u30c8\u30ea\u5316\ncreaterepo .\n\n# \u78ba\u8a8d\nls\n#=> repodata  x86_64 \u3068\u306a\u3063\u3066\u3044\u308b\u7b48\n\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u3092web\u516c\u958b\u3059\u308b(LAN\u5185\u306e\u307f)\n\n\u3000\u3000centos7\u2212admin\u306enginx\u306b\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\n\nnginx.conf\n\n    # \u30ea\u30dd\u30b8\u30c8\u30ea\u7528\u306evirtualhost\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\n    server {\n        listen                    0.0.0.0:80;\n        server_name               centos7-admin;\n        server_tokens             off;\n        root                      /var/lib/myrepo_dir/;\n        charset                   utf-8;\n        allow                     192.168.56.0/24;\n        allow                     127.0.0.1;\n        deny                      all;\n    }\n\n\nLAN\u5185\u306e\u516c\u958b\u306b\u9650\u5b9a\u3059\u308b\u306e\u3067\u3001\u30a2\u30af\u30bb\u30b9IP\u5236\u9650\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n\ncentos7-admin\u306enginx\u3092\u518d\u8d77\u52d5\u3055\u305b\u3001virtualhost\u306e\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\n\n  # restart\n  sudo systemctl restart nginx.service\n\n  # \u518d\u8d77\u52d5\u78ba\u8a8d\n  ps ax|grep nginx\n\n\n\u30aa\u30ea\u30b8\u30ca\u30eb\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\n\n\u516c\u958b\u8a2d\u5b9a\u3057\u305f\u30ea\u30dd\u30b8\u30c8\u30ea\u3092 myrepo \u3068\u3044\u3046\u540d\u524d\u3067\u3001OS\u306b\u8ffd\u52a0\u3059\u308b\n  vi /etc/yum.repos.d/myrepo.repo\n\n\nmyrepo.repo\n[myrepo]\nname=my repository\n#baseurl=file:///var/lib/myrepo_dir\nbaseurl=http://centos7-admin/el7/\nenabled=1\ngpgcheck=0\n\n\n\nyum\u3067\u691c\u7d22\u3057\u3066\u307f\u308b\n\nyum search nginx_myrpm\n\n#=> \u8aad\u307f\u8fbc\u3093\u3060\u30d7\u30e9\u30b0\u30a4\u30f3:fastestmirror, langpacks\n#=> Loading mirror speeds from cached hostfile\n#=>  * base: www.ftp.ne.jp\n#=>  * extras: www.ftp.ne.jp\n#=>  * updates: www.ftp.ne.jp\n#=> =========================== N/S matched: nginx_myrpm ===========================\n#=> nginx_myrpm.x86_64 : Nginx webserver (with ssl, ldap-auth)\n#=> \n#=>   Name and summary matches only, use \"search all\" for everything.\n\n# \u6982\u8981\nnginx\u306erpm\u3067ldap\u8a8d\u8a3c\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3082\u306e\u304c\u3001\u898b\u3064\u304b\u3089\u306a\u3044\u306e\u3067\u3001\u81ea\u5206\u3067ldap\u5bfe\u5fdc\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7d44\u307f\u8fbc\u3093\u3067\u3001source\u3088\u308a\u30d3\u30eb\u30c9\u3057\u3066\u3044\u304f\u3001[\u524d\u306e\u8a18\u4e8b\u3067\u69cb\u7bc9\u3057\u305f\u30b5\u30fc\u30d0\u30fc](http://qiita.com/hirotaka-tajiri/items/c89725cffd0edb046aaa) \u306bitamae\u3067\u9069\u7528\u3059\u308b\u306e\u3067\u3001rpm\u3068\u30ea\u30dd\u30b8\u30c8\u30ea\u4f5c\u6210\u3059\u308b\n\n# \u524d\u6e96\u5099\n\n## \u5fc5\u8981\u306a\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u53d6\u5f97\nnginx\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u3088\u308a Mainline version \u306e \n[nginx-1.11.3.tar.gz](https://nginx.org/download/nginx-1.11.3.tar.gz)\n[nginx-1.11.3.tar.gz.asc](https://nginx.org/download/nginx-1.11.3.tar.gz.asc)\n\u3068\u3001\nnginx-auth-ldap \u306e [git\u30ea\u30dd\u30b8\u30c8\u30ea](https://github.com/kvspb/nginx-auth-ldap.git)\u306e\u30af\u30ed\u30fc\u30f3\u3092\u3059\u308b\n\n---\n\n**\u30d3\u30eb\u30c9\u7528\u30b5\u30fc\u30d0\u30fc\u3067\u4e00\u9023\u306e\u4f5c\u696d\u3092\u884c\u3046**\n*\u307e\u305f\u3001\u7279\u5225\u306a\u6307\u793a\u304c\u7121\u3044\u9650\u308a\u306f\u3001\u30d3\u30eb\u30c9\u4f5c\u696d\u306f\u4e00\u822c\u30e6\u30fc\u30b6\u30fc\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u884c\u3044\u3001root\u3067\u306f\u884c\u308f\u306a\u3044\u3053\u3068\u306a\u305c\u306a\u3089\u3070\u3001\u9014\u4e2d\u306e\u4f5c\u696d\u3067\u5931\u6557\u3057\u305f\u6642\u306b\u3001\u30b7\u30b9\u30c6\u30e0\u306b\u5b9f\u969b\u306e\u8ffd\u52a0\u306a\u3069\u304c\u884c\u308f\u308c\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3092\u78ba\u4fdd\u3059\u308b\u305f\u3081*\n\n- (root\u30e6\u30fc\u30b6\u30fc\u3067)\u30d3\u30eb\u30c9\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u307e\u3068\u3081\u3066\u8ffd\u52a0\u3059\u308b\n\n```shell-session\n# root\u30e6\u30fc\u30b6\u30fc\u3067\u30d3\u30eb\u30c9\u7528\u306e\u958b\u767a\u30c4\u30fc\u30eb\u30b0\u30eb\u30fc\u30d7\u3092\u307e\u3068\u3081\u3066\u8ffd\u52a0\u3059\u308b\nsudo yum groupinstall \"Development Tools\"\nsudo yum install createrepo\n```\n\n- (root\u30e6\u30fc\u30b6\u30fc\u3067)\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u4fdd\u5b58\u30c7\u30a3\u30ec\u30af\u30c8\u30ea[rpm_src]\u3092\u4f5c\u6210\u3057\u3001(\u30d3\u30eb\u30c9\u30e6\u30fc\u30b6\u30fc\u3067)\u5fc5\u8981\u306a\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u96c6\u3081\u308b\n\n```shell-session\n\n# root\u30e6\u30fc\u30b6\u30fc\u3067\u5143\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092766\u306b\u5909\u66f4\nsudo mkdir /usr/local/src/rpm_src\nsudo chmod 766 /usr/local/src/rpm_src\ncd /usr/local/src/rpm_src\n\n# \u30d3\u30eb\u30c9\u30e6\u30fc\u30b6\u30fc\u3067\u5404\u30d1\u30c3\u30b1\u30fc\u30b8\u7528\u306e\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u96c6\u3081\u308b\nmkdir nginx\ncd nginx\nwget  https://nginx.org/download/nginx-1.11.3.tar.gz\nwget\u3000https://nginx.org/download/nginx-1.11.3.tar.gz.asc\ngit  clone https://github.com/kvspb/nginx-auth-ldap.git\n```\n\n- nginx\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u95a2\u3057\u3066\u3001\u6539\u7ac4\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3046\n\n```shell-session\nsudo gpg --verify nginx-1.11.3.tar.gz.asc \n\n#=> gpg: 2016\u5e7407\u670826\u65e5 22\u664259\u520649\u79d2 JST\u306bRSA\u9375ID A1C052F8\u3067\u65bd\u3055\u308c\u305f\u7f72\u540d\n#=> gpg: \"Maxim Dounin <mdounin@mdounin.ru>\"\u304b\u3089\u306e\u6b63\u3057\u3044\u7f72\u540d\n#=> gpg: *\u8b66\u544a*: \u3053\u306e\u9375\u306f\u4fe1\u7528\u3067\u304d\u308b\u7f72\u540d\u3067\u8a3c\u660e\u3055\u308c\u3066\u3044\u307e\u305b\u3093!\n#=> gpg:       \u3053\u306e\u7f72\u540d\u304c\u6240\u6709\u8005\u306e\u3082\u306e\u304b\u3069\u3046\u304b\u306e\u691c\u8a3c\u624b\u6bb5\u304c\u3042\u308a\u307e\u305b\u3093\u3002\n#=> \u4e3b\u9375\u306e\u30d5\u30a3\u30f3\u30ac\u30fc\u30fb\u30d7\u30ea\u30f3\u30c8: B0F4 2533 73F8 F6F5 10D4  2178 520A #=> 9993 A1C0 52F8\n```\n\n\u7f72\u540d\u8005\u304cnginx\u306e\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30b5\u30a4\u30c8\u306b\u3042\u308b\u3001Maxim Dounin\u6c0f\u306a\u306e\u3067\u554f\u984c\u306a\u3057\u3001git\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u95a2\u3057\u3066\u306f\u3001git\u306a\u306e\u3067\u554f\u984c\u306a\u3057\u3068\u3059\u308b\n\n- \u4eca\u5f8c\u306e\u4f5c\u696d\u306e\u305f\u3081\u306bnginx-auth-ldap\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3001tar.gz\u30d5\u30a1\u30a4\u30eb\u306b\u307e\u3068\u3081\u308b\n\n```shell-session\ntar -zcf nginx-auth-ldap.tar.gz nginx-auth-ldap\n```\n\n- tar.gz \u306b\u307e\u3068\u3081\u305f\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u4f7f\u3044\u30b3\u30f3\u30d1\u30a4\u30eb\u304c\u901a\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3\u306fnginx\u306e\u30aa\u30d5\u30a3\u30b7\u30e3\u30eb\u30b5\u30a4\u30c8\u306eMain line\u306e[Configure Arguments](https://nginx.org/en/linux_packages.html#mainline)\u306b\u3059\u308b\n\n\n```shell-session\n# \u30d3\u30eb\u30c9\u306e\u30c1\u30a7\u30c3\u30af\u306f /tmp \u3067\u884c\u3046\ntar -zxf nginx-1.11.3.tar.gz -C /tmp\ntar -zxf nginx-auth-ldap.tar.gz -C /tmp/nginx-1.11.3/\n\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u5c55\u958b\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u306b\u79fb\u52d5\u3057\u3001configure\u3059\u308b\ncd /tmp/nginx-1.11.3\n\nLDFLAGS=\"-L/usr/lib64\" \\\n\"./configure\" \\\n\"--prefix=/etc/nginx\" \\\n\"--sbin-path=/usr/sbin/nginx\" \\\n\"--conf-path=/etc/nginx/nginx.conf\" \\\n\"--error-log-path=/var/log/nginx/error.log\" \\\n\"--http-log-path=/var/log/nginx/access.log\" \\\n\"--pid-path=/var/run/nginx.pid\" \\\n\"--lock-path=/var/run/nginx.lock\" \\\n\"--http-client-body-temp-path=/var/cache/nginx/client_temp\" \\\n\"--http-proxy-temp-path=/var/cache/nginx/proxy_temp\" \\\n\"--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp\" \\\n\"--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp\" \\\n\"--http-scgi-temp-path=/var/cache/nginx/scgi_temp\" \\\n\"--user=nginx\" \\\n\"--group=nginx\" \\\n\"--with-http_ssl_module\" \\\n\"--with-http_realip_module\" \\\n\"--with-http_addition_module\" \\\n\"--with-http_sub_module\" \\\n\"--with-http_dav_module\" \\\n\"--with-http_flv_module\" \\\n\"--with-http_mp4_module\" \\\n\"--with-http_gunzip_module\" \\\n\"--with-http_gzip_static_module\" \\\n\"--with-http_random_index_module\" \\\n\"--with-http_secure_link_module\" \\\n\"--with-http_stub_status_module\" \\\n\"--with-http_auth_request_module\" \\\n\"--with-threads\" \\\n\"--with-stream\" \\\n\"--with-stream_ssl_module\" \\\n\"--with-http_slice_module\" \\\n\"--with-mail\" \\\n\"--with-mail_ssl_module\" \\\n\"--with-file-aio\" \\\n\"--with-http_v2_module\" \\\n\"--with-ipv6\" \\\n\"--add-module=nginx-auth-ldap\"\n\n# configure \u304c\u901a\u308c\u3070\u3001make\u307e\u3067\u3059\u3059\u3081\u308b\nmake\n```\n\nMain line\u306eConfigure Arguments\u306b\u52a0\u3048\u3001\u660e\u78ba\u306b64bit\u30b3\u30f3\u30d1\u30a4\u30eb\u306b\u3059\u308b\u305f\u3081\u306b\u3001LDFLAGS=\"-L/usr/lib64\" \u3068ldap\u5bfe\u5fdc\u306e\u305f\u3081\u306b\u3001--add-module=nginx-auth-ldap \u3092\u8ffd\u52a0\u3059\u308b\n\n# rpm\u4f5c\u6210\u306e\u672c\u4f5c\u696d\n\n- rpm\u30d3\u30eb\u30c9\u30e6\u30fc\u30b6\u30fc\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3001rpm\u5316\u4f5c\u696d\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n\n```shell-session\ncd\nmkdir rpmbuild\ncd rpmbuild\nmkdir BUILD  BUILDROOT  RPMS  SOURCES  SPECS  SRPMS\n```\n- \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304b\u3089\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30d5\u30a1\u30a4\u30eb\u4ee5\u5916\u3092rpm\u306b\u542b\u3081\u308b\u5834\u5408\u306b\u306f\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6e96\u5099\u3059\u308b\n   \n   \u672c\u4ef6\u3067\u306f\u3001\u30bd\u30fc\u30b9\u304b\u3089\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u306a\u3044\u3001\u30ed\u30b0\u30ed\u30fc\u30c6\u30fc\u30c8\u7528\u306e\u30d5\u30a1\u30a4\u30eb(nginx)\u3068\u3001systemctl\u7528\u306e\u30d5\u30a1\u30a4\u30eb(nginx.service) \u3092rpm\u5316\u3059\u308b\u30bd\u30fc\u30b9\u985e\u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3059\u308b\n  (\u672c\u4ef6\u3060\u3068 /usr/local/src/rpm_src/nginx \u5185\u306b\u4f5c\u6210)\n\n ```sh:nginx\n/var/log/nginx/*log {\n    create 0644 nginx nginx\n    daily\n    rotate 5\n    missingok\n    notifempty\n    compress\n    sharedscripts\n    postrotate\n        /bin/kill -HUP `cat /var/run/nginx.pid` 2>/dev/null\n    endscript\n}\n ```\n ```sh:nginx.service\n[Unit]\nDescription=The nginx HTTP server\nAfter=network.target remote-fs.target nss-lookup.target\n\n[Service]\nType=forking\nPIDFile=/run/nginx.pid\nExecStartPre=/usr/bin/rm -f /run/nginx.pid\nExecStartPre=/usr/sbin/nginx -t\nExecStart=/usr/sbin/nginx\nExecReload=/bin/kill -s HUP $MAINPID\nKillMode=process\nKillSignal=SIGQUIT\nTimeoutStopSec=5\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n ```\n  \n\n- rpm\u4f5c\u6210\u306e\u305f\u3081\u306b\u3001spec\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\nrpm\u5316\u3059\u308b\u30bd\u30fc\u30b9\u985e\u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3059\u308b\u3068\u3088\u3044\n(\u672c\u4ef6\u3060\u3068 /usr/local/src/rpm_src/nginx \u5185\u306b\u4f5c\u6210)\n\u307e\u305f\u3001\u672c\u4ef6\u3067\u306fnginx\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u304c\u3001\u81ea\u5206\u3067\u4f5c\u6210\u3057\u305fnginx\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3068\u3001\u4ed6\u304c\u4f5c\u6210\u3057\u305fnginx\u3068\u3092\u533a\u5225\u3059\u308b\u305f\u3081\u306b\u3001nginx_myrpm\u3068\u3057\u3066\u4f5c\u6210\u3059\u308b\u3053\u3068\u306b\u3059\u308b\n\n```spec:nginx_myrpm.spec\nSummary: Nginx webserver (with ssl, ldap-auth)\nName: nginx_myrpm\nVersion: 1.11.3\nRelease: 1.el7\nLicense: BSD-like\nGroup: Web-server-environment\nSource0: nginx-1.11.3.tar.gz\nSource1: nginx-auth-ldap.tar.gz\nSource2: nginx\nSource3: nginx.service\nBuildRoot: %{_tmppath}/%{name}-%{version}-buildroot\nBuildRequires: openldap-devel,openssl-devel,zlib-devel,pcre-devel\nRequires: openldap,openssl,zlib,pcre\nConflicts: nginx\n\n%description\nnginx webserver with ssl, ldap-auth\n\n%prep\n[ -d $RPM_BUILD_ROOT ] && rm -rf $RPM_BUILD_ROOT;\n\n%setup -a 1 -q -n nginx-%{version}\n\n%build\n[ -d $RPM_BUILD_ROOT ] && rm -rf $RPM_BUILD_ROOT;\nLDFLAGS=\"-L/usr/lib64\" \\\n\"./configure\" \\\n\"--prefix=/etc/nginx\" \\\n\"--sbin-path=/usr/sbin/nginx\" \\\n\"--conf-path=/etc/nginx/nginx.conf\" \\\n\"--error-log-path=/var/log/nginx/error.log\" \\\n\"--http-log-path=/var/log/nginx/access.log\" \\\n\"--pid-path=/var/run/nginx.pid\" \\\n\"--lock-path=/var/run/nginx.lock\" \\\n\"--http-client-body-temp-path=/var/cache/nginx/client_temp\" \\\n\"--http-proxy-temp-path=/var/cache/nginx/proxy_temp\" \\\n\"--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp\" \\\n\"--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp\" \\\n\"--http-scgi-temp-path=/var/cache/nginx/scgi_temp\" \\\n\"--user=nginx\" \\\n\"--group=nginx\" \\\n\"--with-http_ssl_module\" \\\n\"--with-http_realip_module\" \\\n\"--with-http_addition_module\" \\\n\"--with-http_sub_module\" \\\n\"--with-http_dav_module\" \\\n\"--with-http_flv_module\" \\\n\"--with-http_mp4_module\" \\\n\"--with-http_gunzip_module\" \\\n\"--with-http_gzip_static_module\" \\\n\"--with-http_random_index_module\" \\\n\"--with-http_secure_link_module\" \\\n\"--with-http_stub_status_module\" \\\n\"--with-http_auth_request_module\" \\\n\"--with-threads\" \\\n\"--with-stream\" \\\n\"--with-stream_ssl_module\" \\\n\"--with-http_slice_module\" \\\n\"--with-mail\" \\\n\"--with-mail_ssl_module\" \\\n\"--with-file-aio\" \\\n\"--with-http_v2_module\" \\\n\"--with-ipv6\" \\\n\"--add-module=nginx-auth-ldap\"\nmake\n\n%install\n[ -d $RPM_BUILD_ROOT ] && rm -rf $RPM_BUILD_ROOT;\nmake install DESTDIR=${RPM_BUILD_ROOT}\nmkdir -p ${RPM_BUILD_ROOT}/etc/logrotate.d/\nmkdir -p ${RPM_BUILD_ROOT}/usr/lib/systemd/system/\nmkdir -p ${RPM_BUILD_ROOT}/var/lib/nginx/tmp\nmkdir -p ${RPM_BUILD_ROOT}/var/log/nginx\nmkdir -p ${RPM_BUILD_ROOT}/var/cache/nginx\ninstall -m 644 %{SOURCE2} ${RPM_BUILD_ROOT}/etc/logrotate.d/\ninstall -m 755 %{SOURCE3} ${RPM_BUILD_ROOT}/usr/lib/systemd/system/\n\n%clean\n[ -d $RPM_BUILD_ROOT ] && rm -rf $RPM_BUILD_ROOT;\n\n%pre\ngroupadd nginx\nuseradd nginx -g nginx -s /sbin/nologin -d /etc/nginx -c \"Nginx web server\"\n\n%postun\nuserdel nginx -rf\n\n%files\n%defattr(644,nginx,nginx)\n   /etc/logrotate.d/nginx\n   /etc/nginx/fastcgi.conf\n   /etc/nginx/fastcgi.conf.default\n   /etc/nginx/fastcgi_params\n   /etc/nginx/fastcgi_params.default\n   /etc/nginx/html/50x.html\n   /etc/nginx/html/index.html\n   /etc/nginx/koi-utf\n   /etc/nginx/koi-win\n   /etc/nginx/mime.types\n   /etc/nginx/mime.types.default\n   /etc/nginx/nginx.conf\n   /etc/nginx/nginx.conf.default\n   /etc/nginx/scgi_params\n   /etc/nginx/scgi_params.default\n   /etc/nginx/uwsgi_params\n   /etc/nginx/uwsgi_params.default\n   /etc/nginx/win-utf\n   /var/lib/nginx\n   /var/lib/nginx/tmp\n   /var/log/nginx\n   /var/cache/nginx/\n%defattr(755,nginx,nginx)\n   /usr/lib/systemd/system/nginx.service\n   /usr/sbin/nginx\n\n%changelog\n* Thu Sep 8 2016 Hirotaka Tajiri <ganryu_koziro@excite.co.jp> 1-11-3.1\n- first build\n\n```\n\n\u25c7spec\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306e\u8aac\u660e \n \u25bc \u5192\u982d\u90e8\u5206(\u74b0\u5883\u5909\u6570\u306a\u3069)\n\n| \u9805\u76ee | \u5185\u5bb9 |\n|:--------:|:-------------|\n| Summary: | rpm\u306e\u6982\u8981\u8aac\u660e   |\n| Name:    | rpm\u30d1\u30c3\u30b1\u30fc\u30b8\u540d |\n| Version: | rpm\u306e\u30d9\u30fc\u30b9\u306b\u306a\u308b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u30d0\u30fc\u30b8\u30e7\u30f3 |\n| Release: | rpm\u306e\u30ea\u30ea\u30fc\u30b9\u756a\u53f7 | \n| License: | rpm\u306e\u30e9\u30a4\u30bb\u30f3\u30b9 | \n| Group: | rpm\u306e\u30b0\u30eb\u30fc\u30d7(yum groupinstall\u6642\u306b\u5fc5\u8981) | \n| Source(n): | rpm\u5316\u4f5c\u696d\u3067\u4f7f\u7528\u3059\u308b\u30d5\u30a1\u30a4\u30eb | \n| BuildRoot: | \u4f5c\u696d\u5834\u6240 %{_tmppath}/%{name}-%{version}-buildroot \u3067OK |\n| BuildRequires: | rpm\u5316\u4f5c\u696d\u6642\u306b\u5fc5\u8981\u306b\u306a\u308b\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8 | \n| Requires: | \u4f5c\u6210\u3057\u305frpm\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u540c\u6642\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8 | \n| Conflicts: | \u540c\u6642\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u306a\u3044\u5171\u5b58\u4e0d\u53ef\u30d1\u30c3\u30b1\u30fc\u30b8 | \n \n \u25bc \u672c\u4f53\u90e8\u5206\n\n  \u25bd %description\n  \n    \u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u5185\u5bb9\u8aac\u660e\n\n  \u25bd %prep\n\n    \u672c\u4f5c\u696d\u524d\u306b\u5b9f\u884c\u3055\u308c\u308b\u3001\u4e88\u5099\u4f5c\u696d\u3002\u672c\u4ef6\u3067\u306f $RPM_BUILD_ROOT \u306e\u521d\u671f\u5316\u3092\u884c\u3046\n\n  \u25bd %setup \n\n    \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u5c55\u958b\u3092\u304a\u3053\u306a\u3046\n    \u610f\u5473\u3068\u3057\u3066\u306f\u3001 \n    %setup -q \u3067 \n    SOURCE0 \u3092 ~/rpmbuild/BUILD \u3078\u5c55\u958b\u3057\u3001\n    cd ~/rpmbuild/BUILD/[Name]-[VERSION] \u3059\u308b\n    (-q \u306f\u5c55\u958b\u304c\u30b5\u30a4\u30ec\u30f3\u30c8\u30e2\u30fc\u30c9\u3068\u3044\u3046\u610f\u5473)\n    \u672c\u4ef6\u3067\u306f\u3001\n    %setup -a 1 -q -n nginx-%{version} \u3067\n    SOURCE0 \u3092 ~/rpmbuild/BUILD \u3078\u30b5\u30a4\u30ec\u30f3\u30c8\u30e2\u30fc\u30c9\u3067\u5c55\u958b\u3057\u3000\n    -a 1 \u3067 SOURCE1 \u3092\u5c55\u958b\u5f8c\u306e\u4e2d\u306b\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u5c55\u958b\u3057 \n    -n \u3067 cd\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u540d\u3092\u3000~/rpmbuild/BUILD/[Name]-[VERSION]\n    \u3067\u306f\u306a\u304f\u3001~/rpmbuild/BUILD/nginx-[VERSION] \u306b\u3059\u308b\u3068\u6307\u5b9a\u3057\u3066\u3044\u308b\n\n  \u25bd %build\n \n    configure \u304b\u3089 make \u307e\u3067\u306e\u3084\u308a\u65b9\u3092\u8a18\u8f09\u3059\u308b\n\n  \u25bd %install\n\n    rpm\u5316\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u914d\u7f6e\n    \u901a\u5e38\u3068\u304a\u308amake install\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3068\n    configure\u3067\u6307\u5b9a\u3057\u305f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5148\u306b\u76f4\u63a5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3001\n    rpm\u30d5\u30a1\u30a4\u30eb\u4f5c\u696d\u5834\u6240 \\${RPM_BUILD_ROOT} \u306b\u914d\u7f6e\u3055\u308c\u306a\u3044\n    \u305d\u306e\u305f\u3081\u3001make install DESTDIR=\\${RPM_BUILD_ROOT} \n    \u3068\u6307\u5b9a\u3057\u3066\u3001\\${RPM_BUILD_ROOT}\u4ee5\u4e0b\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n    \u307e\u305f\u3001make install\u3067\u306a\u304f\u3001\u76f4\u63a5\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u914d\u7f6e\u3059\u308b\u5834\u5408\u306b\u306f\n    mkdir -p \\${RPM_BUILD_ROOT}/etc/logrotate.d/ \u3084\n    install -m 644 %{SOURCE2} \\${RPM_BUILD_ROOT}/etc/logrotate.d/\n    \u3067\u914d\u7f6e\u3059\u308b\n\n  \u25bd %clean\n\n    rpm\u5316\u4f5c\u696d\u5f8c\u51e6\u7406\u3092\u8a18\u8f09\u3059\u308b\n\n  \u25bd %pre\n  \n    \u4f5c\u6210\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306e\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u524d\u4f5c\u696d\u3092\u8a18\u8f09\u3059\u308b\n    \u672c\u4ef6\u3067\u306f\u3001nginx\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u3092\u8a18\u8f09\u3057\u3066\u3044\u308b\n\n  \u25bd %postun\n\n    \u4f5c\u6210\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306e\u5f8c\u51e6\u7406\u3092\u8a18\u8f09\u3059\u308b\n    \u672c\u4ef6\u3067\u306f\u3001nginx\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u30a2\u30ab\u30a6\u30f3\u30c8\u524a\u9664\u3092\u8a18\u8f09\u3057\u3066\u3044\u308b\n\n  \u25bd %files\u3000%defattr\n\n    rpm\u5316\u914d\u7f6e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea \\${RPM_BUILD_ROOT} \u306b\u914d\u7f6e\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u81ea\u52d5\u7684\u306b\n    rpm\u5316\u3055\u308c\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u3001rpm\u306b\u542b\u3080\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u6307\u5b9a\u3059\u308b\n    \u307e\u305f\u3001%defattr\u3067\u3001\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30aa\u30fc\u30ca\u30fc,\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3092\u307e\u3068\u3081\u3066\u6307\u5b9a\u3059\u308b\n\n- spec\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u30bd\u30fc\u30b9\u985e\u3001spec\u30d5\u30a1\u30a4\u30eb\u306e\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3059\u308b\n\n```shell-session\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3059\u308b\nln -s /usr/local/src/rpm_src/nginx/nginx ~/rpmbuild/SOURCES/\nln -s /usr/local/src/rpm_src/nginx/nginx.service ~/rpmbuild/SOURCES/\nln -s /usr/local/src/rpm_src/nginx/nginx-auth-ldap.tar.gz ~/rpmbuild/SOURCES/\nln -s /usr/local/src/rpm_src/nginx/nginx-1.11.3.tar.gz ~/rpmbuild/SOURCES/\n# spec\u30d5\u30a1\u30a4\u30eb\nln -s /usr/local/src/rpm_src/nginx/nginx_myrpm.spec ~/rpmbuild/SPECS\n```\n\n- rpmbuild\u30b3\u30de\u30f3\u30c9\u3067rpm\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\n\n   \u7d30\u304b\u3044bpmbuild\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u8a73\u3057\u3044\u8aac\u660e\u306f\u5272\u611b\n\n```shell-session\ncd ~/rpmbuild/SPECS\n\n# rpm\u4f5c\u6210\nrpmbuild -bb nginx_myrpm.spec\n```\n\n- rpm\u306e\u78ba\u8a8d\u4f5c\u696d\n\n  \u30a8\u30e9\u30fc\u3067\u30b9\u30c8\u30c3\u30d7\u3057\u306a\u3051\u308c\u3070\u3001\u4f5c\u6210\u7d42\u4e86\u3057\u3066\u3044\u308b\u306e\u3067\u3001rpm\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u78ba\u8a8d\u3092\u884c\u3046\n\n```shell-session\n# 64bit\u30d1\u30c3\u30b1\u30fc\u30b8\u306a\u306e\u3067~/rpmbuild/RPMS/x86_64\u306b\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\ncd ~/rpmbuild/RPMS/x86_64\n\n# rpm \u30a4\u30f3\u30d5\u30a9\u30e1\u30fc\u30b7\u30e7\u30f3\u306e\u78ba\u8a8d\nrpm -qpi nginx_myrpm-1.11.3-1.el7.x86_64.rpm \n\n# rpm\u542b\u6709\u30d5\u30a1\u30a4\u30eb\u306e\u78ba\u8a8d\nrpm -qpl nginx_myrpm-1.11.3-1.el7.x86_64.rpm \n```\n\n# yum\u30ea\u30dd\u30b8\u30c8\u30ea\u5316\n\n\u4f5c\u6210\u3057\u305frpm\u30d5\u30a1\u30a4\u30eb\u3092\u3001\u72ec\u81ea\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u8ffd\u52a0\u3059\u308b\n\n- \u30ea\u30dd\u30b8\u30c8\u30ea\u5143\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4f5c\u6210\n\n \u30d3\u30eb\u30c9\u5143\u30b5\u30fc\u30d0\u30fc\u3067\u3042\u308a\u3001itamae\u5b9f\u884c\u30b5\u30fc\u30d0\u30fc\u3067\u3042\u308b\u3001centos7\u2212admin \u306b\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n\n```shell-session\n# root\u3067\u30ea\u30dd\u30b8\u30c8\u30ea\u5143\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\nsu -\nmkdir -p /var/lib/myrepo_dir/el7\n```\n\n- rpm\u30d5\u30a1\u30a4\u30eb\u3092\u30ea\u30dd\u30b8\u30c8\u30ea\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30b3\u30d4\u30fc\u3057\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u5316\u3059\u308b\n\n```shell-session\n# root\u3067\u30b3\u30d4\u30fc\nsu -\ncd /var/lib/myrepo_dir/el7\nmkdir x86_64\n\n# rpm\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc(\u30d3\u30eb\u30c9\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u3092xxx\u3068\u4eee\u5b9a\u3059\u308b)\ncp /home/xxx/rpmbuild/RPMS/x86_64/nginx_myrpm-1.11.3-1.el7.x86_64.rpm x86_64/\n\n# \u30ea\u30dd\u30b8\u30c8\u30ea\u5316\ncreaterepo .\n\n# \u78ba\u8a8d\nls\n#=> repodata  x86_64 \u3068\u306a\u3063\u3066\u3044\u308b\u7b48\n```\n\n- \u30ea\u30dd\u30b8\u30c8\u30ea\u3092web\u516c\u958b\u3059\u308b(LAN\u5185\u306e\u307f)\n\n\u3000\u3000centos7\u2212admin\u306enginx\u306b\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\n\n   ```shell-session:nginx.conf\n \n    # \u30ea\u30dd\u30b8\u30c8\u30ea\u7528\u306evirtualhost\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3059\u308b\n    server {\n        listen                    0.0.0.0:80;\n        server_name               centos7-admin;\n        server_tokens             off;\n        root                      /var/lib/myrepo_dir/;\n        charset                   utf-8;\n        allow                     192.168.56.0/24;\n        allow                     127.0.0.1;\n        deny                      all;\n    }\n   ```\n\n   LAN\u5185\u306e\u516c\u958b\u306b\u9650\u5b9a\u3059\u308b\u306e\u3067\u3001\u30a2\u30af\u30bb\u30b9IP\u5236\u9650\u306e\u8a2d\u5b9a\u3092\u3059\u308b\n   \n- centos7-admin\u306enginx\u3092\u518d\u8d77\u52d5\u3055\u305b\u3001virtualhost\u306e\u8a2d\u5b9a\u3092\u53cd\u6620\u3055\u305b\u308b\n\n  ```shell-session\n  # restart\n  sudo systemctl restart nginx.service\n\n  # \u518d\u8d77\u52d5\u78ba\u8a8d\n  ps ax|grep nginx\n  ```\n- \u30aa\u30ea\u30b8\u30ca\u30eb\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\n\n  \u516c\u958b\u8a2d\u5b9a\u3057\u305f\u30ea\u30dd\u30b8\u30c8\u30ea\u3092 myrepo \u3068\u3044\u3046\u540d\u524d\u3067\u3001OS\u306b\u8ffd\u52a0\u3059\u308b\n\n  ```shell-session\n  vi /etc/yum.repos.d/myrepo.repo\n  ```\n\n```shell-session:myrepo.repo\n[myrepo]\nname=my repository\n#baseurl=file:///var/lib/myrepo_dir\nbaseurl=http://centos7-admin/el7/\nenabled=1\ngpgcheck=0\n```\n- yum\u3067\u691c\u7d22\u3057\u3066\u307f\u308b\n\n```shell-session\nyum search nginx_myrpm\n\n#=> \u8aad\u307f\u8fbc\u3093\u3060\u30d7\u30e9\u30b0\u30a4\u30f3:fastestmirror, langpacks\n#=> Loading mirror speeds from cached hostfile\n#=>  * base: www.ftp.ne.jp\n#=>  * extras: www.ftp.ne.jp\n#=>  * updates: www.ftp.ne.jp\n#=> =========================== N/S matched: nginx_myrpm ===========================\n#=> nginx_myrpm.x86_64 : Nginx webserver (with ssl, ldap-auth)\n#=> \n#=>   Name and summary matches only, use \"search all\" for everything.\n```\n\n \n", "tags": ["LDAP", "nginx", "rpm", "centos7"]}