{"tags": ["Windows", "\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3", "VBScript"], "context": "\u5927\u91cf\u306ePC\u3092\u65b0\u898f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u969b\u306b\u4e0d\u8981\u306a\u30d7\u30ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30bd\u30d5\u30c8\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u306e\u304c\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u3001\u30d0\u30c3\u30c1\u304b\u3089\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3002\n'\n' \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n'\n'  \u203bmsiexec\u306e\u5834\u5408\u306f\u7ba1\u7406\u8005\u6a29\u9650\u3067\u5b9f\u884c\n'\n' \u4f7f\u3044\u65b9\uff1a\n'   \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u8868\u793a\n'     cscript uninst.bat show [\u540d\u524d]\n'   \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\n'     cscript uninst.bat uninstall [\u540d\u524d]\n'\n' \u623b\u308a\u5024\uff1a\n'   0 = \u6210\u529f\n'   1 = \u5f15\u6570\u304c\u4e0d\u6b63\n'   2 = \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5931\u6557\n'\n\n'========================================\n' Function RegGetUninstStr(<\u30ec\u30b8\u30b9\u30c8\u30ea\u306e\u30d1\u30b9>, <\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d>)\n'   \u6307\u5b9a\u3055\u308c\u305f\u30ec\u30b8\u30b9\u30c8\u30ea\u304b\u3089\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u53d6\u5f97\n'========================================\nFunction RegGetUninstStr(strRegSoft, strAppName)\n    '\u30ec\u30b8\u30b9\u30c8\u30ea\u306e\u30b5\u30d6\u30ad\u30fc\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u3001\n    'WMI\u306eStdRegProv\u3092\u4f7f\u7528\u3059\u308b\n    Set objReg = GetObject(\"winmgmts://./root/default:StdRegProv\")\n\n    Const HKLM = &H80000002\n\n    '\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30e9\u60c5\u5831\u306e\u5834\u6240\n    strBaseKey = strRegSoft & \"Microsoft\\Windows\\CurrentVersion\\Uninstall\\\"\n\n    '\u30ec\u30b8\u30b9\u30c8\u30ea\u30d1\u30b9\u304b\u3089\u3001\u30b5\u30d6\u30ad\u30fc\u3092\u53d6\u5f97\n    objReg.EnumKey HKLM, strBaseKey, arrSubKeys\n\n    '\u30b5\u30d6\u30ad\u30fc\u304b\u3089\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u691c\u7d22\n    RegGetUninstStr = \"\"\n    For Each strSubKey In arrSubKeys\n        '\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\u3092\u53d6\u5f97\n        intRet = objReg.GetStringValue(HKLM, strBaseKey & strSubKey, _\n        \"DisplayName\", strValue)\n        If intRet <> 0 Then\n            intRet = objReg.GetStringValue(HKLM, strBaseKey & strSubKey, _\n            \"QuietDisplayName\", strValue)\n        End If\n        '\u6307\u5b9a\u3055\u308c\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3042\u308c\u3070..\n        If strValue <> \"\" Then\n            If strValue = strAppName Then\n                '\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u53d6\u5f97\n                intRet = objReg.GetStringValue(HKLM, strBaseKey & strSubKey, _\n                \"UninstallString\", strUninst)\n                If strUninst <> \"\" Then\n                    '\u623b\u308a\u5024\u306b\u30bb\u30c3\u30c8\u3057\u3066\u691c\u7d22\u7d42\u4e86\n                    RegGetUninstStr = strUninst\n                    Exit For\n                End If\n            End If\n        End If\n    Next\nEnd Function\n\n'========================================\n' Function UninstallString(<\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d>)\n'   \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u53d6\u5f97\n'========================================\nFunction UninstallString(strAppName)\n    '64bit\u7528\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u53d6\u5f97\n    strVal = RegGetUninstStr(\"Software\\\", strAppName)\n    '\u898b\u3064\u304b\u3089\u306a\u3051\u308c\u307032bit\u7528\u30a2\u30d7\u30ea\u304b\u3089\u691c\u7d22\n    If strVal = \"\" Then\n        strVal = RegGetUninstStr(\"Software\\Wow6432Node\\\", strAppName)\n    End If\n    '\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u8fd4\u3059\n    UninstallString = strVal\nEnd Function\n\n'========================================\n' Sudo <\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u540d>, <\u5f15\u6570>\n'   \u7ba1\u7406\u8005\u6a29\u9650\u3067\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n'========================================\nSub Sudo(strCmd, strArg)\n    ' \u7ba1\u7406\u8005\u6a29\u9650\u30c1\u30a7\u30c3\u30af\n    flagPermitted = false\n    Set objWMI = GetObject(\"winmgmts:\" & \"{impersonationLevel=impersonate}!\\\\.\\root\\cimv2\")\n    Set osInfo = objWMI.ExecQuery(\"SELECT * FROM Win32_OperatingSystem\")\n    For Each os in osInfo\n        If left(os.Version, 3) >= 6.0 Then\n            flagPermitted = true\n        End If\n    Next\n\n    ' \u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u53d6\u5f97\n    Set objWShell = WScript.CreateObject(\"WScript.Shell\")\n    strCD = objWShell.CurrentDirectory\n\n    ' \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n    Set objApp = WScript.CreateObject(\"Shell.Application\") \n    If flagPermitted Then\n        ' \u6a29\u9650\u304c\u7121\u3044\u306e\u3067\u6607\u683c\u3057\u3066\u5b9f\u884c\n        objApp.ShellExecute strCmd, strArg, strCD, \"runas\", 1\n    Else\n        ' \u6a29\u9650\u304c\u3042\u308b\u306e\u3067\u305d\u306e\u307e\u307e\u5b9f\u884c\n        objApp.ShellExecute strCmd, strArg, strCD, \"\", 1\n    End If\nEnd Sub\n\n'========================================\n' Run <\u5b9f\u884c\u30b3\u30de\u30f3\u30c9(\u5f15\u6570\u4ed8\u304d)>\n'   \u4e00\u822c\u30e6\u30fc\u30b6\u30fc\u6a29\u9650\u3067\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n'========================================\nSub Run(strCmd)\n    Set objShell = WScript.CreateObject(\"WScript.Shell\")\n    if Left(strCmd, 1) = \"\"\"\" Then\n        '\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217\u304c\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u62ec\u3089\u308c\u3066\u3044\u308c\u3070\u305d\u306e\u307e\u307e\u5b9f\u884c\n        objShell.Run strCmd, 1, TRUE\n    Else\n        '\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217\u3092\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u62ec\u3063\u3066\u5b9f\u884c\n        objShell.Run \"\"\"\" & strCmd & \"\"\"\", 1, TRUE\n    End If\nEnd Sub\n\n'========================================\n' \u30e1\u30a4\u30f3\n'========================================\n'\u5f15\u6570\u30c1\u30a7\u30c3\u30af\nIf WScript.Arguments.Count < 2 Then\n    ' \u5f15\u6570\u304c\u4e0d\u6b63\n    WScript.Quit(1)\nEnd If\n\n'\u5b9f\u884c\u3059\u308b\u51e6\u7406\u306e\u9078\u629e\nSelect Case UCase(WScript.Arguments(0))\n    Case \"UNINSTALL\"\n        '\u300c\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b9f\u884c\u300d\u3092\u9078\u629e\n        flagRun = true\n    Case \"SHOW\"\n        '\u300c\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u8868\u793a\u300d\u3092\u9078\u629e\n        flagRun = false\n    Case Else\n        ' \u5f15\u6570\u304c\u4e0d\u6b63\n        WScript.Quit(1)\nEnd Select\n\n'\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\u53d6\u5f97\nstrAppName = WScript.Arguments(1)\n\nIf flagRun Then\n    WScript.echo \"\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u958b\u59cb: \" & strAppName\nElse\n    WScript.echo \"\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9: \" & strAppName\nEnd If\nstrVal = UninstallString(strAppName)\nIf strVal <> \"\" Then\n    '\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30e9\u304c\u898b\u3064\u304b\u3063\u305f\n    Set objFS = WScript.CreateObject(\"Scripting.FileSystemObject\")\n\n    '\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u30b3\u30de\u30f3\u30c9\u540d\u3068\u5f15\u6570\u306b\u5206\u5272\n    ' \u203bmsiexec\u304b\u3069\u3046\u304b\u3092\u8abf\u3079\u308b\u3060\u3051\u306a\u306e\u3067\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u306f\u4e0d\u8981\n    aryStr = Split(strVal, \" \", 2)\n    strCmd = aryStr(0)\n    strArg = aryStr(1)\n\n    '\u30b3\u30de\u30f3\u30c9\u306b\u3088\u3063\u3066\u51e6\u7406\u3092\u5207\u308a\u66ff\u3048(MSIEXEC\u304b\u305d\u308c\u4ee5\u5916)\n    If StrComp(objFS.getBaseName(strCmd), \"msiexec\", 1) = 0 Then\n        '\u30b3\u30de\u30f3\u30c9\u304c MSIEXEC \u3060\u3063\u305f\n        If StrComp(Left(strArg, 2), \"/X\", 1) = 0 Then\n            '\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u306a\u306e\u3067\u30aa\u30d7\u30b7\u30e7\u30f3\u8ffd\u52a0(\u30ea\u30bb\u30c3\u30c8\u306a\u3057\u3001\u78ba\u8a8d\u306a\u3057)\n            strArg = strArg & \" /norestart /qn\"\n        ElseIf StrComp(Left(strArg, 2), \"/I\", 1) = 0 Then\n            '\u69cb\u6210\u30b3\u30de\u30f3\u30c9\u306a\u306e\u3067\u30b3\u30de\u30f3\u30c9\u3092\u66f8\u304d\u63db\u3048\u3066\u30aa\u30d7\u30b7\u30e7\u30f3\u8ffd\u52a0(\u30ea\u30bb\u30c3\u30c8\u306a\u3057\u3001\u78ba\u8a8d\u306a\u3057)\n            strArg = \"/X\" & Mid(strArg, 3) & \" /norestart /qn\"\n        Else\n            '\u4e0d\u660e\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u306a\u306e\u3067\u305d\u306e\u307e\u307e\u5b9f\u884c\n        End If\n        If flagRun Then\n            'MSIEXEC\u306f\u7ba1\u7406\u8005\u6a29\u9650\u3067\u5b9f\u884c\n            Sudo strCmd, strArg\n        Else\n            '\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\n            WScript.echo strCmd & \" \" & strArg\n            WScript.Quit(0)\n        End If\n    Else\n        ' \u305d\u306e\u4ed6\n        If flagRun Then\n            ' \u4e00\u822c\u30e6\u30fc\u30b6\u30fc\u6a29\u9650\u3067\u5b9f\u884c\n            Run strVal\n        Else\n            '\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\n            WScript.echo strVal\n            WScript.Quit(0)\n        End If\n    End If\n\n    ' \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c1\u30a7\u30c3\u30af\n    strVal = UninstallString(strAppName)\n    If strVal = \"\" Then\n        ' \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\n        WScript.Quit(0)\n    Else\n        ' \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5931\u6557\n        WScript.Quit(2)\n    End If\nElse\n    ' \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30e9\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\n    WScript.Quit(0)\nEnd If\n\n\u5927\u91cf\u306ePC\u3092\u65b0\u898f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u969b\u306b\u4e0d\u8981\u306a\u30d7\u30ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30bd\u30d5\u30c8\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u306e\u304c\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u3001\u30d0\u30c3\u30c1\u304b\u3089\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3002\n\n```vbnet\n'\n' \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n'\n'  \u203bmsiexec\u306e\u5834\u5408\u306f\u7ba1\u7406\u8005\u6a29\u9650\u3067\u5b9f\u884c\n'\n' \u4f7f\u3044\u65b9\uff1a\n'   \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u8868\u793a\n'     cscript uninst.bat show [\u540d\u524d]\n'   \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\n'     cscript uninst.bat uninstall [\u540d\u524d]\n'\n' \u623b\u308a\u5024\uff1a\n'   0 = \u6210\u529f\n'   1 = \u5f15\u6570\u304c\u4e0d\u6b63\n'   2 = \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5931\u6557\n'\n\n'========================================\n' Function RegGetUninstStr(<\u30ec\u30b8\u30b9\u30c8\u30ea\u306e\u30d1\u30b9>, <\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d>)\n'   \u6307\u5b9a\u3055\u308c\u305f\u30ec\u30b8\u30b9\u30c8\u30ea\u304b\u3089\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u53d6\u5f97\n'========================================\nFunction RegGetUninstStr(strRegSoft, strAppName)\n\t'\u30ec\u30b8\u30b9\u30c8\u30ea\u306e\u30b5\u30d6\u30ad\u30fc\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u3001\n\t'WMI\u306eStdRegProv\u3092\u4f7f\u7528\u3059\u308b\n\tSet objReg = GetObject(\"winmgmts://./root/default:StdRegProv\")\n\n\tConst HKLM = &H80000002\n\n\t'\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30e9\u60c5\u5831\u306e\u5834\u6240\n\tstrBaseKey = strRegSoft & \"Microsoft\\Windows\\CurrentVersion\\Uninstall\\\"\n\n\t'\u30ec\u30b8\u30b9\u30c8\u30ea\u30d1\u30b9\u304b\u3089\u3001\u30b5\u30d6\u30ad\u30fc\u3092\u53d6\u5f97\n\tobjReg.EnumKey HKLM, strBaseKey, arrSubKeys\n\n\t'\u30b5\u30d6\u30ad\u30fc\u304b\u3089\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u691c\u7d22\n\tRegGetUninstStr = \"\"\n\tFor Each strSubKey In arrSubKeys\n\t\t'\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\u3092\u53d6\u5f97\n\t\tintRet = objReg.GetStringValue(HKLM, strBaseKey & strSubKey, _\n\t\t\"DisplayName\", strValue)\n\t\tIf intRet <> 0 Then\n\t\t\tintRet = objReg.GetStringValue(HKLM, strBaseKey & strSubKey, _\n\t\t\t\"QuietDisplayName\", strValue)\n\t\tEnd If\n\t\t'\u6307\u5b9a\u3055\u308c\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3042\u308c\u3070..\n\t\tIf strValue <> \"\" Then\n\t\t\tIf strValue = strAppName Then\n\t\t\t\t'\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u53d6\u5f97\n\t\t\t\tintRet = objReg.GetStringValue(HKLM, strBaseKey & strSubKey, _\n\t\t\t\t\"UninstallString\", strUninst)\n\t\t\t\tIf strUninst <> \"\" Then\n\t\t\t\t\t'\u623b\u308a\u5024\u306b\u30bb\u30c3\u30c8\u3057\u3066\u691c\u7d22\u7d42\u4e86\n\t\t\t\t\tRegGetUninstStr = strUninst\n\t\t\t\t\tExit For\n\t\t\t\tEnd If\n\t\t\tEnd If\n\t\tEnd If\n\tNext\nEnd Function\n\n'========================================\n' Function UninstallString(<\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d>)\n'   \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u53d6\u5f97\n'========================================\nFunction UninstallString(strAppName)\n\t'64bit\u7528\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u53d6\u5f97\n\tstrVal = RegGetUninstStr(\"Software\\\", strAppName)\n\t'\u898b\u3064\u304b\u3089\u306a\u3051\u308c\u307032bit\u7528\u30a2\u30d7\u30ea\u304b\u3089\u691c\u7d22\n\tIf strVal = \"\" Then\n\t\tstrVal = RegGetUninstStr(\"Software\\Wow6432Node\\\", strAppName)\n\tEnd If\n\t'\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u8fd4\u3059\n\tUninstallString = strVal\nEnd Function\n\n'========================================\n' Sudo <\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u540d>, <\u5f15\u6570>\n'   \u7ba1\u7406\u8005\u6a29\u9650\u3067\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n'========================================\nSub Sudo(strCmd, strArg)\n\t' \u7ba1\u7406\u8005\u6a29\u9650\u30c1\u30a7\u30c3\u30af\n\tflagPermitted = false\n\tSet objWMI = GetObject(\"winmgmts:\" & \"{impersonationLevel=impersonate}!\\\\.\\root\\cimv2\")\n\tSet osInfo = objWMI.ExecQuery(\"SELECT * FROM Win32_OperatingSystem\")\n\tFor Each os in osInfo\n\t\tIf left(os.Version, 3) >= 6.0 Then\n\t\t\tflagPermitted = true\n\t\tEnd If\n\tNext\n\n\t' \u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u53d6\u5f97\n\tSet objWShell = WScript.CreateObject(\"WScript.Shell\")\n\tstrCD = objWShell.CurrentDirectory\n\n\t' \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n\tSet objApp = WScript.CreateObject(\"Shell.Application\") \n\tIf flagPermitted Then\n\t\t' \u6a29\u9650\u304c\u7121\u3044\u306e\u3067\u6607\u683c\u3057\u3066\u5b9f\u884c\n\t\tobjApp.ShellExecute strCmd, strArg, strCD, \"runas\", 1\n\tElse\n\t\t' \u6a29\u9650\u304c\u3042\u308b\u306e\u3067\u305d\u306e\u307e\u307e\u5b9f\u884c\n\t\tobjApp.ShellExecute strCmd, strArg, strCD, \"\", 1\n\tEnd If\nEnd Sub\n\n'========================================\n' Run <\u5b9f\u884c\u30b3\u30de\u30f3\u30c9(\u5f15\u6570\u4ed8\u304d)>\n'   \u4e00\u822c\u30e6\u30fc\u30b6\u30fc\u6a29\u9650\u3067\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n'========================================\nSub Run(strCmd)\n\tSet objShell = WScript.CreateObject(\"WScript.Shell\")\n\tif Left(strCmd, 1) = \"\"\"\" Then\n\t\t'\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217\u304c\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u62ec\u3089\u308c\u3066\u3044\u308c\u3070\u305d\u306e\u307e\u307e\u5b9f\u884c\n\t\tobjShell.Run strCmd, 1, TRUE\n\tElse\n\t\t'\u30b3\u30de\u30f3\u30c9\u6587\u5b57\u5217\u3092\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u62ec\u3063\u3066\u5b9f\u884c\n\t\tobjShell.Run \"\"\"\" & strCmd & \"\"\"\", 1, TRUE\n\tEnd If\nEnd Sub\n\n'========================================\n' \u30e1\u30a4\u30f3\n'========================================\n'\u5f15\u6570\u30c1\u30a7\u30c3\u30af\nIf WScript.Arguments.Count < 2 Then\n\t' \u5f15\u6570\u304c\u4e0d\u6b63\n\tWScript.Quit(1)\nEnd If\n\n'\u5b9f\u884c\u3059\u308b\u51e6\u7406\u306e\u9078\u629e\nSelect Case UCase(WScript.Arguments(0))\n\tCase \"UNINSTALL\"\n\t\t'\u300c\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b9f\u884c\u300d\u3092\u9078\u629e\n\t\tflagRun = true\n\tCase \"SHOW\"\n\t\t'\u300c\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u8868\u793a\u300d\u3092\u9078\u629e\n\t\tflagRun = false\n\tCase Else\n\t\t' \u5f15\u6570\u304c\u4e0d\u6b63\n\t\tWScript.Quit(1)\nEnd Select\n\n'\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u540d\u53d6\u5f97\nstrAppName = WScript.Arguments(1)\n\nIf flagRun Then\n\tWScript.echo \"\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u958b\u59cb: \" & strAppName\nElse\n\tWScript.echo \"\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9: \" & strAppName\nEnd If\nstrVal = UninstallString(strAppName)\nIf strVal <> \"\" Then\n\t'\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30e9\u304c\u898b\u3064\u304b\u3063\u305f\n\tSet objFS = WScript.CreateObject(\"Scripting.FileSystemObject\")\n\n\t'\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u30b3\u30de\u30f3\u30c9\u540d\u3068\u5f15\u6570\u306b\u5206\u5272\n\t' \u203bmsiexec\u304b\u3069\u3046\u304b\u3092\u8abf\u3079\u308b\u3060\u3051\u306a\u306e\u3067\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u306f\u4e0d\u8981\n\taryStr = Split(strVal, \" \", 2)\n\tstrCmd = aryStr(0)\n\tstrArg = aryStr(1)\n\n\t'\u30b3\u30de\u30f3\u30c9\u306b\u3088\u3063\u3066\u51e6\u7406\u3092\u5207\u308a\u66ff\u3048(MSIEXEC\u304b\u305d\u308c\u4ee5\u5916)\n\tIf StrComp(objFS.getBaseName(strCmd), \"msiexec\", 1) = 0 Then\n\t\t'\u30b3\u30de\u30f3\u30c9\u304c MSIEXEC \u3060\u3063\u305f\n\t\tIf StrComp(Left(strArg, 2), \"/X\", 1) = 0 Then\n\t\t\t'\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u306a\u306e\u3067\u30aa\u30d7\u30b7\u30e7\u30f3\u8ffd\u52a0(\u30ea\u30bb\u30c3\u30c8\u306a\u3057\u3001\u78ba\u8a8d\u306a\u3057)\n\t\t\tstrArg = strArg & \" /norestart /qn\"\n\t\tElseIf StrComp(Left(strArg, 2), \"/I\", 1) = 0 Then\n\t\t\t'\u69cb\u6210\u30b3\u30de\u30f3\u30c9\u306a\u306e\u3067\u30b3\u30de\u30f3\u30c9\u3092\u66f8\u304d\u63db\u3048\u3066\u30aa\u30d7\u30b7\u30e7\u30f3\u8ffd\u52a0(\u30ea\u30bb\u30c3\u30c8\u306a\u3057\u3001\u78ba\u8a8d\u306a\u3057)\n\t\t\tstrArg = \"/X\" & Mid(strArg, 3) & \" /norestart /qn\"\n\t\tElse\n\t\t\t'\u4e0d\u660e\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u306a\u306e\u3067\u305d\u306e\u307e\u307e\u5b9f\u884c\n\t\tEnd If\n\t\tIf flagRun Then\n\t\t\t'MSIEXEC\u306f\u7ba1\u7406\u8005\u6a29\u9650\u3067\u5b9f\u884c\n\t\t\tSudo strCmd, strArg\n\t\tElse\n\t\t\t'\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\n\t\t\tWScript.echo strCmd & \" \" & strArg\n\t\t\tWScript.Quit(0)\n\t\tEnd If\n\tElse\n\t\t' \u305d\u306e\u4ed6\n\t\tIf flagRun Then\n\t\t\t' \u4e00\u822c\u30e6\u30fc\u30b6\u30fc\u6a29\u9650\u3067\u5b9f\u884c\n\t\t\tRun strVal\n\t\tElse\n\t\t\t'\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b3\u30de\u30f3\u30c9\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\n\t\t\tWScript.echo strVal\n\t\t\tWScript.Quit(0)\n\t\tEnd If\n\tEnd If\n\n\t' \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c1\u30a7\u30c3\u30af\n\tstrVal = UninstallString(strAppName)\n\tIf strVal = \"\" Then\n\t\t' \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\n\t\tWScript.Quit(0)\n\tElse\n\t\t' \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5931\u6557\n\t\tWScript.Quit(2)\n\tEnd If\nElse\n\t' \u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30e9\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\n\tWScript.Quit(0)\nEnd If\n```\n"}