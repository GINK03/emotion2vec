{"tags": ["MyRocks", "MySQL", "mysql5.6", "Facebook"], "context": "Facebook\u306fMySQL\u7528\u306e\u65b0\u3057\u3044\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u300cMyRocks\u300d\u3092\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u3067\u516c\u958b\u3057\u307e\u3057\u305f\u3002\nhttp://www.publickey1.jp/blog/16/facebookmysqlmyrocks.html\nMyRocks\u306f\u3001InnoDB\u304c\u30d5\u30e9\u30c3\u30b7\u30e5\u30b9\u30c8\u30ec\u30fc\u30b8\u3068\u7d44\u307f\u5408\u308f\u305b\u305f\u3068\u304d\u306b\u66f8\u304d\u8fbc\u307e\u308c\u308b\u30c7\u30fc\u30bf\u91cf\u306e\u52b9\u7387\u6027\u3092\u6539\u5584\u3059\u308b\u305f\u3081\u306bFacebook\u304c\u53d6\u308a\u7d44\u3093\u3060\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u3067\u3059\u3002\n2013\u5e74\u306b\u30ad\u30fc\u30d0\u30ea\u30e5\u30fc\u30b9\u30c8\u30a2\u3068\u3057\u3066\u516c\u958b\u3057\u305fRocksDB\u3092MySQL\u306b\u7d71\u5408\u3055\u305b\u305f\u3082\u306e\u3092\u57fa\u76e4\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\u30b9\u30c8\u30ec\u30fc\u30b8\u52b9\u7387\u306e\u9762\u3067\u975e\u5e38\u306b\u512a\u308c\u3066\u3044\u3066\u3001\u5727\u7e2e\u6a5f\u80fd\u3092\u7528\u3044\u305fInnoDB\u3068\u306e\u6bd4\u8f03\u3067\u3082MyRocks\u306f\u66f8\u304d\u8fbc\u307e\u308c\u308b\u30c7\u30fc\u30bf\u91cf\u304c\u5727\u5012\u7684\u306b\u5c0f\u3055\u3044\u305d\u3046\u306a\u3002\n\u3046\u3080\u3001\u6c17\u306b\u306a\u308b\u3002\u3066\u306a\u308f\u3051\u3067\u65e9\u901f\u8a66\u3057\u3066\u307f\u307e\u3057\u3087\u3046(\u261d \u055e\u0a0a \u055e)\u261d\nMyRocks\u3092\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u306ffacebook\u306egithub\u306ewiki\u306b\u8a18\u8f09\u3057\u3066\u3042\u308a\u307e\u3059\u3002\nhttps://github.com/facebook/mysql-5.6/wiki/Getting-Started-with-MyRocks\nMySQL\u3092\u30bd\u30fc\u30b9\u304b\u3089\u843d\u3068\u3057\u3066\u30d3\u30eb\u30c9\u3059\u308b\u5f62\u3067\u3059\u306d\u3002\n\u3053\u308c\u306b\u5f93\u3063\u3066\u3084\u3063\u3066\u3082\u826f\u3044\u3093\u3067\u3059\u304c\u3001\u3001\n\u3082\u3046\u3061\u3087\u3063\u3068\u3055\u304f\u3063\u3068\u8a66\u3057\u305f\u3044\u306a\u301c\u3069\u3063\u304b\u306bMyRocks\u306eDocker\u30a4\u30e1\u30fc\u30b8\u8ee2\u304c\u3063\u3066\u306a\u3044\u304b\u306a\u301c  \n\u3068\u601d\u3063\u305f\u3089\u30db\u30f3\u30c8\u306b\u3042\u308a\u307e\u3057\u305f  \nhttps://www.percona.com/blog/2016/09/06/myrocks-docker-images/\nperconadb\u3055\u3093\u304c\u4f5c\u3063\u3066\u304f\u308c\u3066\u307e\u3057\u305f\u306d\u3002\u611f\u8b1d\uff01\n\u3067\u306f\u3067\u306fDocker\u30a4\u30e1\u30fc\u30b8\u3092\u843d\u3068\u3057\u3066\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\u65e2\u306bDocker for Mac\u3092\u5165\u308c\u3066\u3042\u308b\u524d\u63d0\u3067\nDocker\u30ec\u30b8\u30b9\u30c8\u30ea\u304b\u3089\u306eDocker\u30a4\u30e1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u3057\u307e\u3059\u3002\ndocker pull perconalab/myrocks\n\n\u5b8c\u4e86\u3057\u305f\u3089\u30a4\u30e1\u30fc\u30b8\u304b\u3089\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\ndocker run -d --name myr -P  perconalab/myrocks\n\n\u305d\u3057\u3066\u624b\u9806\u901a\u308aMac\u304b\u3089mysql\u30b3\u30de\u30f3\u30c9\u3067\u63a5\u7d9a\nmysql -h127.0.0.1\nRROR 1130 (HY000): Host 'gateway' is not allowed to connect to this MySQL server\n\n\u30fb\u30fb\u3093\u3093\uff1f\u666e\u901a\u306b\u30a8\u30e9\u3063\u305f(*\u00b4\u0434\uff40)\u3000\u63a5\u7d9a\u8a31\u53ef\u304c\u3055\u308c\u3066\u306a\u3044\u3067\u3059\u306d\n\u4ed5\u65b9\u306a\u3044\u304b\u3089\u30b3\u30f3\u30c6\u30ca\u306b\u5165\u3063\u3066\u63a5\u7d9a\n(mysql\u30b3\u30de\u30f3\u30c9\u306e\u30d1\u30b9\u304c\u901a\u3063\u3066\u306a\u304b\u3063\u305f\u306e\u3067\u5f8c\u3067\u901a\u3059\u3053\u3068\u306b\u3057\u307e\u3059)\n$ docker exec -it  myr bash\n[root@84e0d99b1244 /]# /usr/local/mysql/bin/mysql\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 7\nServer version: 5.6.27 Source distribution\n\nCopyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n\n\u63a5\u7d9a\u3057\u305f\u3089MyRocks\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u304c\u5b58\u5728\u3059\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002\nmysql> show engines;\n+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n| Engine     | Support | Comment                                                        | Transactions | XA   | Savepoints |\n+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n| ROCKSDB    | DEFAULT | RocksDB storage engine                                         | YES          | YES  | YES        |\n| MRG_MYISAM | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO         |\n| MyISAM     | YES     | MyISAM storage engine                                          | NO           | NO   | NO         |\n| BLACKHOLE  | YES     | /dev/null storage engine (anything you write to it disappears) | NO           | NO   | NO         |\n| CSV        | YES     | CSV storage engine                                             | NO           | NO   | NO         |\n| MEMORY     | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO         |\n| ARCHIVE    | YES     | Archive storage engine                                         | NO           | NO   | NO         |\n| FEDERATED  | NO      | Federated MySQL storage engine                                 | NULL         | NULL | NULL       |\n| InnoDB     | NO      | Supports transactions, row-level locking, and foreign keys     | NULL         | NULL | NULL       |\n+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n\nROCKSDB\u304c\u3042\u3063\u305f\u3089OK\u3067\u3059  \n\u3053\u3053\u3067\u518d\u3073github\u306ewiki\u306b\u623b\u308a\u3001wiki\u306b\u66f8\u3044\u3066\u3042\u308b\u901a\u308a\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\n\nCREATE TABLE `linktable` (\n `id1` bigint(20) unsigned NOT NULL DEFAULT '0',\n `id1_type` int(10) unsigned NOT NULL DEFAULT '0',\n `id2` bigint(20) unsigned NOT NULL DEFAULT '0',\n `id2_type` int(10) unsigned NOT NULL DEFAULT '0',\n `link_type` bigint(20) unsigned NOT NULL DEFAULT '0',\n `visibility` tinyint(3) NOT NULL DEFAULT '0',\n `data` varchar(255) NOT NULL DEFAULT '',\n `time` bigint(20) unsigned NOT NULL DEFAULT '0',\n `version` int(11) unsigned NOT NULL DEFAULT '0',\n PRIMARY KEY (link_type, `id1`,`id2`) COMMENT 'cf_link_pk',\n KEY `id1_type` (`id1`,`link_type`,`visibility`,`time`,`version`,`data`) COMMENT 'rev:cf_link_id1_type'\n) ENGINE=RocksDB DEFAULT COLLATE=latin1_bin; \n\n\u4e00\u5fdc\u30c6\u30fc\u30d6\u30eb\u60c5\u5831\u306e\u78ba\u8a8d\u3002\nmysql> show table status \\G\n*************************** 1. row ***************************\n           Name: linktable\n         Engine: ROCKSDB\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u7de8\u306a\u306e\u3067\u3053\u3053\u307e\u3067\uff01\n\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u53d6\u3063\u305f\u308a\u3068\u304b\u306f\u307e\u305f\u5f8c\u65e5\u3068\u3044\u3046\u3053\u3068\u3067\u3002\nFacebook\u306fMySQL\u7528\u306e\u65b0\u3057\u3044\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u300cMyRocks\u300d\u3092\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u3067\u516c\u958b\u3057\u307e\u3057\u305f\u3002\nhttp://www.publickey1.jp/blog/16/facebookmysqlmyrocks.html\n\nMyRocks\u306f\u3001InnoDB\u304c\u30d5\u30e9\u30c3\u30b7\u30e5\u30b9\u30c8\u30ec\u30fc\u30b8\u3068\u7d44\u307f\u5408\u308f\u305b\u305f\u3068\u304d\u306b\u66f8\u304d\u8fbc\u307e\u308c\u308b\u30c7\u30fc\u30bf\u91cf\u306e\u52b9\u7387\u6027\u3092\u6539\u5584\u3059\u308b\u305f\u3081\u306bFacebook\u304c\u53d6\u308a\u7d44\u3093\u3060\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u3067\u3059\u3002\n2013\u5e74\u306b\u30ad\u30fc\u30d0\u30ea\u30e5\u30fc\u30b9\u30c8\u30a2\u3068\u3057\u3066\u516c\u958b\u3057\u305fRocksDB\u3092MySQL\u306b\u7d71\u5408\u3055\u305b\u305f\u3082\u306e\u3092\u57fa\u76e4\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u30b9\u30c8\u30ec\u30fc\u30b8\u52b9\u7387\u306e\u9762\u3067\u975e\u5e38\u306b\u512a\u308c\u3066\u3044\u3066\u3001\u5727\u7e2e\u6a5f\u80fd\u3092\u7528\u3044\u305fInnoDB\u3068\u306e\u6bd4\u8f03\u3067\u3082MyRocks\u306f\u66f8\u304d\u8fbc\u307e\u308c\u308b\u30c7\u30fc\u30bf\u91cf\u304c\u5727\u5012\u7684\u306b\u5c0f\u3055\u3044\u305d\u3046\u306a\u3002\n\n\u3046\u3080\u3001\u6c17\u306b\u306a\u308b\u3002\u3066\u306a\u308f\u3051\u3067\u65e9\u901f\u8a66\u3057\u3066\u307f\u307e\u3057\u3087\u3046(\u261d \u055e\u0a0a \u055e)\u261d\n\nMyRocks\u3092\u4f7f\u7528\u3059\u308b\u65b9\u6cd5\u306ffacebook\u306egithub\u306ewiki\u306b\u8a18\u8f09\u3057\u3066\u3042\u308a\u307e\u3059\u3002\nhttps://github.com/facebook/mysql-5.6/wiki/Getting-Started-with-MyRocks\n\nMySQL\u3092\u30bd\u30fc\u30b9\u304b\u3089\u843d\u3068\u3057\u3066\u30d3\u30eb\u30c9\u3059\u308b\u5f62\u3067\u3059\u306d\u3002\n\n\u3053\u308c\u306b\u5f93\u3063\u3066\u3084\u3063\u3066\u3082\u826f\u3044\u3093\u3067\u3059\u304c\u3001\u3001\n\u3082\u3046\u3061\u3087\u3063\u3068\u3055\u304f\u3063\u3068\u8a66\u3057\u305f\u3044\u306a\u301c\u3069\u3063\u304b\u306bMyRocks\u306eDocker\u30a4\u30e1\u30fc\u30b8\u8ee2\u304c\u3063\u3066\u306a\u3044\u304b\u306a\u301c :kissing: \n\u3068\u601d\u3063\u305f\u3089\u30db\u30f3\u30c8\u306b\u3042\u308a\u307e\u3057\u305f :raised_hands: \nhttps://www.percona.com/blog/2016/09/06/myrocks-docker-images/\n\nperconadb\u3055\u3093\u304c\u4f5c\u3063\u3066\u304f\u308c\u3066\u307e\u3057\u305f\u306d\u3002\u611f\u8b1d\uff01\n\n\u3067\u306f\u3067\u306fDocker\u30a4\u30e1\u30fc\u30b8\u3092\u843d\u3068\u3057\u3066\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u65e2\u306bDocker for Mac\u3092\u5165\u308c\u3066\u3042\u308b\u524d\u63d0\u3067\nDocker\u30ec\u30b8\u30b9\u30c8\u30ea\u304b\u3089\u306eDocker\u30a4\u30e1\u30fc\u30b8\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u3057\u307e\u3059\u3002\n\n```\ndocker pull perconalab/myrocks\n```\n\n\u5b8c\u4e86\u3057\u305f\u3089\u30a4\u30e1\u30fc\u30b8\u304b\u3089\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\ndocker run -d --name myr -P  perconalab/myrocks\n```\n\n\u305d\u3057\u3066\u624b\u9806\u901a\u308aMac\u304b\u3089mysql\u30b3\u30de\u30f3\u30c9\u3067\u63a5\u7d9a\n\n```\nmysql -h127.0.0.1\nRROR 1130 (HY000): Host 'gateway' is not allowed to connect to this MySQL server\n```\n\u30fb\u30fb\u3093\u3093\uff1f\u666e\u901a\u306b\u30a8\u30e9\u3063\u305f(*\u00b4\u0434\uff40)\u3000\u63a5\u7d9a\u8a31\u53ef\u304c\u3055\u308c\u3066\u306a\u3044\u3067\u3059\u306d\n\u4ed5\u65b9\u306a\u3044\u304b\u3089\u30b3\u30f3\u30c6\u30ca\u306b\u5165\u3063\u3066\u63a5\u7d9a\n(mysql\u30b3\u30de\u30f3\u30c9\u306e\u30d1\u30b9\u304c\u901a\u3063\u3066\u306a\u304b\u3063\u305f\u306e\u3067\u5f8c\u3067\u901a\u3059\u3053\u3068\u306b\u3057\u307e\u3059)\n\n```\n$ docker exec -it  myr bash\n[root@84e0d99b1244 /]# /usr/local/mysql/bin/mysql\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 7\nServer version: 5.6.27 Source distribution\n\nCopyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n```\n\u63a5\u7d9a\u3057\u305f\u3089MyRocks\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u304c\u5b58\u5728\u3059\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002\n\n```\nmysql> show engines;\n+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n| Engine     | Support | Comment                                                        | Transactions | XA   | Savepoints |\n+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n| ROCKSDB    | DEFAULT | RocksDB storage engine                                         | YES          | YES  | YES        |\n| MRG_MYISAM | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO         |\n| MyISAM     | YES     | MyISAM storage engine                                          | NO           | NO   | NO         |\n| BLACKHOLE  | YES     | /dev/null storage engine (anything you write to it disappears) | NO           | NO   | NO         |\n| CSV        | YES     | CSV storage engine                                             | NO           | NO   | NO         |\n| MEMORY     | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO         |\n| ARCHIVE    | YES     | Archive storage engine                                         | NO           | NO   | NO         |\n| FEDERATED  | NO      | Federated MySQL storage engine                                 | NULL         | NULL | NULL       |\n| InnoDB     | NO      | Supports transactions, row-level locking, and foreign keys     | NULL         | NULL | NULL       |\n+------------+---------+----------------------------------------------------------------+--------------+------+------------+\n```\n\n\nROCKSDB\u304c\u3042\u3063\u305f\u3089OK\u3067\u3059 :+1: \n\n\u3053\u3053\u3067\u518d\u3073github\u306e[wiki](https://github.com/facebook/mysql-5.6/wiki/Getting-Started-with-MyRocks)\u306b\u623b\u308a\u3001wiki\u306b\u66f8\u3044\u3066\u3042\u308b\u901a\u308a\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\n\n```sql\n\nCREATE TABLE `linktable` (\n `id1` bigint(20) unsigned NOT NULL DEFAULT '0',\n `id1_type` int(10) unsigned NOT NULL DEFAULT '0',\n `id2` bigint(20) unsigned NOT NULL DEFAULT '0',\n `id2_type` int(10) unsigned NOT NULL DEFAULT '0',\n `link_type` bigint(20) unsigned NOT NULL DEFAULT '0',\n `visibility` tinyint(3) NOT NULL DEFAULT '0',\n `data` varchar(255) NOT NULL DEFAULT '',\n `time` bigint(20) unsigned NOT NULL DEFAULT '0',\n `version` int(11) unsigned NOT NULL DEFAULT '0',\n PRIMARY KEY (link_type, `id1`,`id2`) COMMENT 'cf_link_pk',\n KEY `id1_type` (`id1`,`link_type`,`visibility`,`time`,`version`,`data`) COMMENT 'rev:cf_link_id1_type'\n) ENGINE=RocksDB DEFAULT COLLATE=latin1_bin; \n```\n\n\u4e00\u5fdc\u30c6\u30fc\u30d6\u30eb\u60c5\u5831\u306e\u78ba\u8a8d\u3002\n\n```\nmysql> show table status \\G\n*************************** 1. row ***************************\n           Name: linktable\n         Engine: ROCKSDB\n```\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u7de8\u306a\u306e\u3067\u3053\u3053\u307e\u3067\uff01\n\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u3092\u53d6\u3063\u305f\u308a\u3068\u304b\u306f\u307e\u305f\u5f8c\u65e5\u3068\u3044\u3046\u3053\u3068\u3067\u3002\n"}