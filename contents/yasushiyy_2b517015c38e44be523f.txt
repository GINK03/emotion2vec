{"context": " More than 1 year has passed since last update.1\u79d2\u5358\u4f4d\u3068\u304b\u3067\u3001\u5b9a\u671f\u7684\u306bSQL\u3092\u5b9f\u884c\u3057\u305f\u3044\u3068\u304d\u306e\u3084\u308a\u65b9\u3002\n\nsesw.sh\n#!/bin/sh\n\ncd `dirname $0`\n\nLOCKFILE=.lock_sesw_`date \"+%m%d%H%M%S\"`\nrm -f .lock_sesw_*\ntouch $LOCKFILE\ntrap \"echo terminated; rm -f $LOCKFILE; exit 0\" INT\n\nsesw()\n{\n  echo \"connect / as sysdba\"\n  echo \"set pages 9999\"\n  echo \"set lines 200\"\n  echo \"set feedback off\"\n  while [ -f $LOCKFILE ]\n  do\n    cat << EOF\ncol TIME      for a10\ncol SID       for 9999\ncol MACHINE   for a15 trunc\ncol PROGRAM   for a15 trunc\ncol MODULE    for a15 trunc\ncol SQL_ID    for a15\ncol COMMAND   for 999\ncol EVENT     for a30 trunc\ncol SIW       for 999\n\nSELECT to_char(sysdate, 'mmddhh24miss') TIME\n     , sid\n     , machine\n     , program\n     , module\n     , sql_id\n     , command\n     , event\n     , seconds_in_wait SIW\n  FROM v\\$session\n WHERE wait_class != 'Idle'\n ORDER BY event, p1;\nEOF\n    sleep 1\n  done\n}\n\nsesw | sqlplus -s /nolog\n\n\n\u4e0a\u306e\u4f8b\u3060\u3068\u3001DB\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u30bb\u30c3\u30b7\u30e7\u30f3\u60c5\u5831\u3092\u5b9a\u671f\u7684\u306b\u51fa\u529b\u3057\u307e\u3059\u304c\u3001\u3069\u306eSQL\u306b\u7f6e\u304d\u63db\u3048\u3066\u3082\u3088\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002v\\$\u30d3\u30e5\u30fc\u306e\u5834\u5408\u3001\u300c\\$\u300d\u306e\u30a8\u30b9\u30b1\u30fc\u30d7\u3060\u3051\u306f\u5fd8\u308c\u305a\u306b\u3002\n\u3053\u306e\u3042\u305f\u308a\u306b\u3082\u5e7e\u3064\u304b\u4e0a\u3052\u3066\u3044\u307e\u3059\u3002\nhttps://github.com/yasushiyy/orashell/blob/master/sesw.sh\nhttps://github.com/yasushiyy/orashell/blob/master/seswsmall.sh\nhttps://github.com/yasushiyy/orashell/blob/master/sesw9i.sh\n1\u79d2\u5358\u4f4d\u3068\u304b\u3067\u3001\u5b9a\u671f\u7684\u306bSQL\u3092\u5b9f\u884c\u3057\u305f\u3044\u3068\u304d\u306e\u3084\u308a\u65b9\u3002\n\n```sesw.sh\n#!/bin/sh\n\ncd `dirname $0`\n\nLOCKFILE=.lock_sesw_`date \"+%m%d%H%M%S\"`\nrm -f .lock_sesw_*\ntouch $LOCKFILE\ntrap \"echo terminated; rm -f $LOCKFILE; exit 0\" INT\n\nsesw()\n{\n  echo \"connect / as sysdba\"\n  echo \"set pages 9999\"\n  echo \"set lines 200\"\n  echo \"set feedback off\"\n  while [ -f $LOCKFILE ]\n  do\n    cat << EOF\ncol TIME      for a10\ncol SID       for 9999\ncol MACHINE   for a15 trunc\ncol PROGRAM   for a15 trunc\ncol MODULE    for a15 trunc\ncol SQL_ID    for a15\ncol COMMAND   for 999\ncol EVENT     for a30 trunc\ncol SIW       for 999\n\nSELECT to_char(sysdate, 'mmddhh24miss') TIME\n     , sid\n     , machine\n     , program\n     , module\n     , sql_id\n     , command\n     , event\n     , seconds_in_wait SIW\n  FROM v\\$session\n WHERE wait_class != 'Idle'\n ORDER BY event, p1;\nEOF\n    sleep 1\n  done\n}\n\nsesw | sqlplus -s /nolog\n```\n\n\u4e0a\u306e\u4f8b\u3060\u3068\u3001DB\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u30bb\u30c3\u30b7\u30e7\u30f3\u60c5\u5831\u3092\u5b9a\u671f\u7684\u306b\u51fa\u529b\u3057\u307e\u3059\u304c\u3001\u3069\u306eSQL\u306b\u7f6e\u304d\u63db\u3048\u3066\u3082\u3088\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002v\\$\u30d3\u30e5\u30fc\u306e\u5834\u5408\u3001\u300c\\$\u300d\u306e\u30a8\u30b9\u30b1\u30fc\u30d7\u3060\u3051\u306f\u5fd8\u308c\u305a\u306b\u3002\n\n\u3053\u306e\u3042\u305f\u308a\u306b\u3082\u5e7e\u3064\u304b\u4e0a\u3052\u3066\u3044\u307e\u3059\u3002\nhttps://github.com/yasushiyy/orashell/blob/master/sesw.sh\nhttps://github.com/yasushiyy/orashell/blob/master/seswsmall.sh\nhttps://github.com/yasushiyy/orashell/blob/master/sesw9i.sh\n\n", "tags": ["oracle", "shell"]}