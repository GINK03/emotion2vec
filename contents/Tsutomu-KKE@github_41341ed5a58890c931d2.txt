{"context": " More than 1 year has passed since last update.\n\n \u4f55\u3092\u3059\u308b\u306e\u304b\n\u4e88\u7d04\u304c\u3044\u3063\u3071\u3044\u306e\u7e41\u76db\u30ec\u30b9\u30c8\u30e9\u30f3\u306e\u30aa\u30fc\u30ca\u30fc\u304b\u3089\u3001\u58f2\u4e0a\u3092\u6700\u5927\u5316\u3057\u3066\u6b32\u3057\u3044\u3068\u983c\u307e\u308c\u307e\u3057\u305f\u3002\n1\u65e5\u5206\u306e\u4e88\u7d04\u5019\u88dc\u306b\u5bfe\u3057\u3001\u3069\u308c\u3092OK\u306b\u3057\u3066\u3001\u3069\u308c\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u306b\u3059\u308b\u304b\u3092\u6c42\u3081\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306a\u554f\u984c\u3082\u7d44\u5408\u305b\u6700\u9069\u5316\u3067\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4e88\u7d04\u306f\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u6642\u9593\u3068\u4eba\u6570\u3068\u5358\u4fa1\u304c\u308f\u304b\u3063\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n1\u884c\u304c1\u3064\u306e\u4e88\u7d04\u306b\u5bfe\u5fdc\u3057\u3001[\u958b\u59cb\u6642\u523b]\u306b[\u4eba\u6570]\u3060\u3051\u6765\u5e97\u3057\u3001[\u4e88\u7d04\u6642\u9593]\u306e\u6642\u9593\u3092\u304b\u3051\u3066\u98df\u4e8b\u3057\u3066\u3001[\u5358\u4fa1]\u00d7[\u4eba\u6570]\u6255\u3063\u3066\u5e30\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n\n\n\u958b\u59cb\u6642\u523b\n\u4e88\u7d04\u6642\u9593\n\u4eba\u6570\n\u5358\u4fa1\n\n\n0\n13\n2\n2\n2000\n\n\n1\n11\n1\n3\n2800\n\n\n2\n16\n3\n3\n2800\n\n\n...\n...\n...\n...\n...\n\n\n\n \u5ea7\u5e2d\u306b\u3064\u3044\u3066\n\u30ec\u30b9\u30c8\u30e9\u30f3\u306e\u5ea7\u5e2d\u306f\u30012\u4eba\u30c6\u30fc\u30d6\u30eb\u00d74 \u30684\u4eba\u30c6\u30fc\u30d6\u30eb\u00d72\u306e16\u4eba\u307e\u3067\u5ea7\u308c\u307e\u3059\u3002\n\n\u307e\u305f\u30012\u4eba\u30c6\u30fc\u30d6\u30eb\u540c\u58eb\u30684\u4eba\u30c6\u30fc\u30d6\u30eb\u540c\u58eb\u306f\u3001\u304f\u3063\u3064\u3051\u3066\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u304f\u3063\u3064\u3051\u65b9(\u4ee5\u4e0b\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\u3068\u3088\u3076)\u306f\u4ee5\u4e0b\u306e13\u901a\u308a\u3067\u3059\u3002(\u756a\u53f7\u306f\u30c6\u30fc\u30d6\u30eb\u756a\u53f7)\n[0]\n[1]\n[2]\n[3]\n[4]\n[5]\n[0, 1]\n[1, 2]\n[2, 3]\n[4, 5]\n[0, 1, 2]\n[1, 2, 3]\n[0, 1, 2, 3]\n\n\n \u5b9a\u5f0f\u5316\n\n\n$\\mbox{objective}$\n$\\sum_i{\\sum_j{\u4eba\u6570_i \u5358\u4fa1_i x_{ij}}}$\n\u7dcf\u58f2\u4e0a\n\n\n$\\mbox{variables}$\n$x_{ij} \\in \\{0, 1\\} ~ \\forall i, j$\n\u4e88\u7d04$i$\u304c\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7$j$\u3092\u4f7f\u3046\u304b\u3069\u3046\u304b\n\n\n$\\mbox{subject to}$\n$\\sum_j{x_{ij}} \\le 1 ~ \\forall i$\n\u4f55\u308c\u304b\u306e\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\n\n\n$\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7j\u306e\u5ea7\u5e2d\u6570 \\lt \u4e88\u7d04i\u306e\u4eba\u6570\u306e\u3068\u304d$\n\u4eba\u6570\u5236\u9650\n\n$x_{ij} = 0 ~ \\forall i, j$\n\u540c\u30c6\u30fc\u30d6\u30eb\u540c\u6642\u523b\u306b\u306f\u30011\u7d44\u3057\u304b\u4e88\u7d04\u53d7\u5165\u3067\u304d\u306a\u3044\n\n\u305f\u3060\u3057\u3001\u6dfb\u5b57\u306e\u610f\u5473\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3068\u3057\u307e\u3059\u3002\ni: \u4e88\u7d04\nj: \u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\ns: \u30c6\u30fc\u30d6\u30eb\nt: \u6642\u523b\n\n\n Python\u3067\u89e3\u304f\n\u307e\u305a\u3001\u4e88\u7d04\u8868(a)\u3092\u4e71\u6570\u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n\npython\nimport numpy as np, numpy.random as rnd, pandas as pd, matplotlib.pyplot as plt\nfrom pulp import *\ndef addvar(lowBound=0, count=[0], *args, **kwargs):\n    count[0] += 1\n    return LpVariable('v%d' % count[0], lowBound=lowBound, *args, **kwargs)\nrnd.seed(5)\na = pd.DataFrame([(rnd.randint(10, 17), rnd.choice([1, 2, 2, 3]),\n      max(1, min(8, int(rnd.lognormal(1.2, 0.5)))), rnd.randint(10, 16) * 200)\n      for _ in range(60)], columns=['\u958b\u59cb\u6642\u523b', '\u4e88\u7d04\u6642\u9593', '\u4eba\u6570', '\u5358\u4fa1'])\ncap = [2, 2, 2, 2, 4, 4] # \u30c6\u30fc\u30d6\u30eb\u5225\u5ea7\u5e2d\u6570\nsps = [[0], [1], [2], [3], [4], [5], [0, 1], [1, 2], [2, 3],\n       [4, 5], [0, 1, 2], [1, 2, 3], [0, 1, 2, 3]] # \u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\u5225\u30c6\u30fc\u30d6\u30eb\u30ea\u30b9\u30c8\nns, nt = len(sps), 19 - 10 # \u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\u6570\u3001\u6642\u523b\u6570\n\n\n\u5b9a\u5f0f\u5316\u3057\u3066\u89e3\u304d\u307e\u3059\u3002\n\npython\nm = LpProblem(sense=LpMaximize) # \u6570\u7406\u30e2\u30c7\u30eb\np = [[[] for t in range(nt)] for _ in range(6)] # \u30c6\u30fc\u30d6\u30eb\u5225\u6642\u523b\u5225\u5909\u6570\u30ea\u30b9\u30c8\na['Var'] = [[addvar(cat=LpBinary) for j in range(ns)] for i, r in a.iterrows()]\nm += lpDot(a.\u4eba\u6570 * a.\u5358\u4fa1, a.Var.apply(lpSum)) # \u76ee\u7684\u95a2\u6570(\u7dcf\u58f2\u4e0a)\nfor i, r in a.iterrows():\n    m += lpSum(r.Var) <= 1 # \u4f55\u308c\u304b\u306e\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\n    for j, sp in enumerate(sps):\n        if sum(cap[s] for s in sp) < r.\u4eba\u6570:\n            m += r.Var[j] == 0 # \u4eba\u6570\u5236\u9650\n        for s in sp:\n            for t in range(r.\u4e88\u7d04\u6642\u9593):\n                p[s][r.\u958b\u59cb\u6642\u523b - 10 + t].append(r.Var[j])\nfor s in range(6):\n    for t in range(nt):\n        if p[s][t]:\n            m += lpSum(p[s][t]) <= 1 # \u540c\u30c6\u30fc\u30d6\u30eb\u540c\u6642\u523b\u306b\u306f\u30011\u7d44\u3057\u304b\u4e88\u7d04\u53d7\u5165\u3067\u304d\u306a\u3044\nm.solve()\na['Val'] = a.Var.apply(lambda v: int(value(lpDot(range(1, ns+1), v))))\nprint('%s %d\u4eba %.2f \u4e07\u5186' % (LpStatus[m.status],\n    sum(a[a.Val > 0].\u4eba\u6570), value(m.objective) / 10000))\n>>>\nOptimal 83\u4eba 20.44 \u4e07\u5186\n\n\n\u58f2\u4e0a\u306f20\u4e07\u5f37\u3067\u3059\u306d\u3002\u6210\u7acb\u3057\u305f\u4e88\u7d04\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\npython\nprint('\u6642\u9593 \u4eba\u6570 \u6599\u91d1 \u30c6\u30fc\u30d6\u30eb')\nfor i, r in a.iterrows():\n    if r.Val:\n        print('%2d-%2d %d %d %s' % (r.\u958b\u59cb\u6642\u523b, r.\u958b\u59cb\u6642\u523b + r.\u4e88\u7d04\u6642\u9593 - 1,\n                                    r.\u4eba\u6570, r.\u4eba\u6570 * r.\u5358\u4fa1, sps[r.Val-1]))\n>>>\n\u6642\u9593 \u4eba\u6570 \u6599\u91d1 \u30c6\u30fc\u30d6\u30eb\n11-11 3 8400 [2, 3]\n16-18 3 8400 [5]\n13-13 4 11200 [4]\n16-17 2 4800 [2]\n16-17 4 11200 [4]\n12-12 3 7200 [5]\n14-15 8 20800 [4, 5]\n14-14 2 4800 [2]\n10-10 1 3000 [0]\n16-18 2 6000 [3]\n15-15 8 16000 [0, 1, 2, 3]\n11-11 3 8400 [0, 1]\n10-10 2 4000 [4]\n11-12 4 9600 [4]\n16-18 4 8000 [0, 1]\n13-13 2 5600 [0]\n12-12 6 13200 [1, 2, 3]\n10-11 4 8000 [5]\n10-10 3 6600 [1, 2]\n13-13 4 10400 [5]\n13-13 2 6000 [1]\n13-13 4 10400 [2, 3]\n14-14 2 5200 [3]\n14-14 3 7200 [0, 1]\n\n\n\u4ee5\u4e0a\n# <i class='fa fa-beer' /> \u4f55\u3092\u3059\u308b\u306e\u304b\n\u4e88\u7d04\u304c\u3044\u3063\u3071\u3044\u306e\u7e41\u76db\u30ec\u30b9\u30c8\u30e9\u30f3\u306e\u30aa\u30fc\u30ca\u30fc\u304b\u3089\u3001**\u58f2\u4e0a\u3092\u6700\u5927\u5316\u3057\u3066\u6b32\u3057\u3044**\u3068\u983c\u307e\u308c\u307e\u3057\u305f\u3002\n1\u65e5\u5206\u306e\u4e88\u7d04\u5019\u88dc\u306b\u5bfe\u3057\u3001\u3069\u308c\u3092OK\u306b\u3057\u3066\u3001\u3069\u308c\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u306b\u3059\u308b\u304b\u3092\u6c42\u3081\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306a\u554f\u984c\u3082[\u7d44\u5408\u305b\u6700\u9069\u5316](http://qiita.com/Tsutomu-KKE@github/items/bfbf4c185ed7004b5721)\u3067\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u4e88\u7d04\u306f\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u6642\u9593\u3068\u4eba\u6570\u3068\u5358\u4fa1\u304c\u308f\u304b\u3063\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n1\u884c\u304c1\u3064\u306e\u4e88\u7d04\u306b\u5bfe\u5fdc\u3057\u3001[\u958b\u59cb\u6642\u523b]\u306b[\u4eba\u6570]\u3060\u3051\u6765\u5e97\u3057\u3001[\u4e88\u7d04\u6642\u9593]\u306e\u6642\u9593\u3092\u304b\u3051\u3066\u98df\u4e8b\u3057\u3066\u3001[\u5358\u4fa1]\u00d7[\u4eba\u6570]\u6255\u3063\u3066\u5e30\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n<table>\n<tr><td></td><td>\u958b\u59cb\u6642\u523b</td><td>\u4e88\u7d04\u6642\u9593</td><td>\u4eba\u6570</td><td>\u5358\u4fa1</td></tr>\n<tr><td>0</td><td>13</td><td>2</td><td>2</td><td>2000</td></tr>\n<tr><td>1</td><td>11</td><td>1</td><td>3</td><td>2800</td></tr>\n<tr><td>2</td><td>16</td><td>3</td><td>3</td><td>2800</td></tr>\n<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>\n</table>\n\n# <i class='fa fa-beer' /> \u5ea7\u5e2d\u306b\u3064\u3044\u3066\n\u30ec\u30b9\u30c8\u30e9\u30f3\u306e\u5ea7\u5e2d\u306f\u30012\u4eba\u30c6\u30fc\u30d6\u30eb\u00d74 \u30684\u4eba\u30c6\u30fc\u30d6\u30eb\u00d72\u306e16\u4eba\u307e\u3067\u5ea7\u308c\u307e\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/13955/b2e31934-3d27-f8b8-71d9-3635c798f91c.png)\n\n\u307e\u305f\u30012\u4eba\u30c6\u30fc\u30d6\u30eb\u540c\u58eb\u30684\u4eba\u30c6\u30fc\u30d6\u30eb\u540c\u58eb\u306f\u3001\u304f\u3063\u3064\u3051\u3066\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u304f\u3063\u3064\u3051\u65b9(\u4ee5\u4e0b\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\u3068\u3088\u3076)\u306f\u4ee5\u4e0b\u306e13\u901a\u308a\u3067\u3059\u3002(\u756a\u53f7\u306f\u30c6\u30fc\u30d6\u30eb\u756a\u53f7)\n\n    [0]\n    [1]\n    [2]\n    [3]\n    [4]\n    [5]\n    [0, 1]\n    [1, 2]\n    [2, 3]\n    [4, 5]\n    [0, 1, 2]\n    [1, 2, 3]\n    [0, 1, 2, 3]\n\n# <i class='fa fa-beer' /> \u5b9a\u5f0f\u5316\n\n<table>\n<tr><td>$\\mbox{objective}$</td><td>$\\sum_i{\\sum_j{\u4eba\u6570_i \u5358\u4fa1_i x_{ij}}}$</td><td>\u7dcf\u58f2\u4e0a</td></tr>\n<tr><td>$\\mbox{variables}$</td><td>$x_{ij} \\in \\{0, 1\\} ~ \\forall i, j$</td><td>\u4e88\u7d04$i$\u304c\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7$j$\u3092\u4f7f\u3046\u304b\u3069\u3046\u304b</td></tr>\n<tr><td rowspan=\"4\">$\\mbox{subject to}$</td><td>$\\sum_j{x_{ij}} \\le 1 ~ \\forall i$</td><td>\u4f55\u308c\u304b\u306e\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7</td></tr>\n<tr><td>$\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7j\u306e\u5ea7\u5e2d\u6570 \\lt \u4e88\u7d04i\u306e\u4eba\u6570\u306e\u3068\u304d$</td><td rowspan=\"2\">\u4eba\u6570\u5236\u9650</td></tr>\n<tr><td>$x_{ij} = 0 ~ \\forall i, j$</td></tr>\n<tr><td colspan=\"2\">\u540c\u30c6\u30fc\u30d6\u30eb\u540c\u6642\u523b\u306b\u306f\u30011\u7d44\u3057\u304b\u4e88\u7d04\u53d7\u5165\u3067\u304d\u306a\u3044</td></tr>\n</table>\n\n\u305f\u3060\u3057\u3001\u6dfb\u5b57\u306e\u610f\u5473\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3068\u3057\u307e\u3059\u3002\n\n    i: \u4e88\u7d04\n    j: \u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\n    s: \u30c6\u30fc\u30d6\u30eb\n    t: \u6642\u523b\n\n# <i class='fa fa-beer' /> Python\u3067\u89e3\u304f\n\n\u307e\u305a\u3001\u4e88\u7d04\u8868(a)\u3092\u4e71\u6570\u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```py3:python\nimport numpy as np, numpy.random as rnd, pandas as pd, matplotlib.pyplot as plt\nfrom pulp import *\ndef addvar(lowBound=0, count=[0], *args, **kwargs):\n    count[0] += 1\n    return LpVariable('v%d' % count[0], lowBound=lowBound, *args, **kwargs)\nrnd.seed(5)\na = pd.DataFrame([(rnd.randint(10, 17), rnd.choice([1, 2, 2, 3]),\n      max(1, min(8, int(rnd.lognormal(1.2, 0.5)))), rnd.randint(10, 16) * 200)\n      for _ in range(60)], columns=['\u958b\u59cb\u6642\u523b', '\u4e88\u7d04\u6642\u9593', '\u4eba\u6570', '\u5358\u4fa1'])\ncap = [2, 2, 2, 2, 4, 4] # \u30c6\u30fc\u30d6\u30eb\u5225\u5ea7\u5e2d\u6570\nsps = [[0], [1], [2], [3], [4], [5], [0, 1], [1, 2], [2, 3],\n       [4, 5], [0, 1, 2], [1, 2, 3], [0, 1, 2, 3]] # \u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\u5225\u30c6\u30fc\u30d6\u30eb\u30ea\u30b9\u30c8\nns, nt = len(sps), 19 - 10 # \u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\u6570\u3001\u6642\u523b\u6570\n```\n\n\u5b9a\u5f0f\u5316\u3057\u3066\u89e3\u304d\u307e\u3059\u3002\n\n```py3:python\nm = LpProblem(sense=LpMaximize) # \u6570\u7406\u30e2\u30c7\u30eb\np = [[[] for t in range(nt)] for _ in range(6)] # \u30c6\u30fc\u30d6\u30eb\u5225\u6642\u523b\u5225\u5909\u6570\u30ea\u30b9\u30c8\na['Var'] = [[addvar(cat=LpBinary) for j in range(ns)] for i, r in a.iterrows()]\nm += lpDot(a.\u4eba\u6570 * a.\u5358\u4fa1, a.Var.apply(lpSum)) # \u76ee\u7684\u95a2\u6570(\u7dcf\u58f2\u4e0a)\nfor i, r in a.iterrows():\n    m += lpSum(r.Var) <= 1 # \u4f55\u308c\u304b\u306e\u30c6\u30fc\u30d6\u30eb\u30b0\u30eb\u30fc\u30d7\n    for j, sp in enumerate(sps):\n        if sum(cap[s] for s in sp) < r.\u4eba\u6570:\n            m += r.Var[j] == 0 # \u4eba\u6570\u5236\u9650\n        for s in sp:\n            for t in range(r.\u4e88\u7d04\u6642\u9593):\n                p[s][r.\u958b\u59cb\u6642\u523b - 10 + t].append(r.Var[j])\nfor s in range(6):\n    for t in range(nt):\n        if p[s][t]:\n            m += lpSum(p[s][t]) <= 1 # \u540c\u30c6\u30fc\u30d6\u30eb\u540c\u6642\u523b\u306b\u306f\u30011\u7d44\u3057\u304b\u4e88\u7d04\u53d7\u5165\u3067\u304d\u306a\u3044\nm.solve()\na['Val'] = a.Var.apply(lambda v: int(value(lpDot(range(1, ns+1), v))))\nprint('%s %d\u4eba %.2f \u4e07\u5186' % (LpStatus[m.status],\n    sum(a[a.Val > 0].\u4eba\u6570), value(m.objective) / 10000))\n>>>\nOptimal 83\u4eba 20.44 \u4e07\u5186\n```\n\n\u58f2\u4e0a\u306f20\u4e07\u5f37\u3067\u3059\u306d\u3002\u6210\u7acb\u3057\u305f\u4e88\u7d04\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n```py3:python\nprint('\u6642\u9593 \u4eba\u6570 \u6599\u91d1 \u30c6\u30fc\u30d6\u30eb')\nfor i, r in a.iterrows():\n    if r.Val:\n        print('%2d-%2d %d %d %s' % (r.\u958b\u59cb\u6642\u523b, r.\u958b\u59cb\u6642\u523b + r.\u4e88\u7d04\u6642\u9593 - 1,\n                                    r.\u4eba\u6570, r.\u4eba\u6570 * r.\u5358\u4fa1, sps[r.Val-1]))\n>>>\n\u6642\u9593 \u4eba\u6570 \u6599\u91d1 \u30c6\u30fc\u30d6\u30eb\n11-11 3 8400 [2, 3]\n16-18 3 8400 [5]\n13-13 4 11200 [4]\n16-17 2 4800 [2]\n16-17 4 11200 [4]\n12-12 3 7200 [5]\n14-15 8 20800 [4, 5]\n14-14 2 4800 [2]\n10-10 1 3000 [0]\n16-18 2 6000 [3]\n15-15 8 16000 [0, 1, 2, 3]\n11-11 3 8400 [0, 1]\n10-10 2 4000 [4]\n11-12 4 9600 [4]\n16-18 4 8000 [0, 1]\n13-13 2 5600 [0]\n12-12 6 13200 [1, 2, 3]\n10-11 4 8000 [5]\n10-10 3 6600 [1, 2]\n13-13 4 10400 [5]\n13-13 2 6000 [1]\n13-13 4 10400 [2, 3]\n14-14 2 5200 [3]\n14-14 3 7200 [0, 1]\n```\n\n\u4ee5\u4e0a\n", "tags": ["\u7d44\u5408\u305b\u6700\u9069\u5316", "\u6700\u9069\u5316", "\u6570\u5b66", "Python"]}