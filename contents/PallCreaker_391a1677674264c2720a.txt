{"context": "\n\n\u4ed5\u69d8\n\nAWS\u306e\u4ed5\u69d8\n\n\nt2.micro\n\n\n\n\n\u5b9f\u88c5\n\u30dd\u30c1\u30dd\u30c1\u3057\u3066\u3001\u30b5\u30fc\u30d0\u30fc\u306b\u5165\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d(sudo yum update)\u3002\n\u203b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3067\u300122\u756a\u306f\u3001myIP\u3067\u3002\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 80\u756a\u304c\u3001anyway\u306b\u3057\u306a\u3044\u3068Nginx\u304c\u52d5\u304b\u306a\u3044\u305e\uff01\uff01\uff01\n\u305d\u3053\u304b\u3089\u3001\n[ec2-user@ip-172-31-35-121 ~]$ git -v\n-bash: git: \u30b3\u30de\u30f3\u30c9\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\n[ec2-user@ip-172-31-35-121 ~]$ ruby -v\nruby 2.0.0p451 (2014-02-24 revision 45167) [x86_64-linux]\n[ec2-user@ip-172-31-35-121 ~]$ $ sudo yum install -y gcc-c++ patch readline readline-devel zlib zlib-devel libyaml-devel libffi-devel openssl-devel make bzip2 autoconf automake libtool bison git\n......\n....\n..\n.\n[ec2-user@ip-172-31-35-121 ~]$ git --version\ngit version 1.8.3.1\n\n\u6b21\u306b\u3001rbenv\u3092\u5165\u308c\u308b\u3002\n\n1. ruby-build\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncd\ngit clone git://github.com/sstephenson/ruby-build.git\ncd ruby-build\nsudo ./install.sh\n\n\n2.rbenv, ruby\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncd\ngit clone git://github.com/sstephenson/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' >> ~/.bash_profile\necho 'eval \"$(rbenv init -)\"' >> ~/.bash_profile\nsource ~/.bashrc\nexec $SHELL -l\nrbenv install -l\nrbenv install 2.1.0;rbenv rehash\nrbenv global 2.1.0\n\n\n\u7d50\u679c\n[ec2-user@ip-172-31-11-135 ~]$ ruby -v\nruby 2.1.0p0 (2013-12-25 revision 44422) [x86_64-linux]\n[ec2-user@ip-172-31-11-135 ~]$ which gem\n~/.rbenv/shims/gem\n[ec2-user@ip-172-31-11-135 ~]$ which ruby\n~/.rbenv/shims/ruby\n[ec2-user@ip-172-31-11-135 ~]$\n\n\n3.bundle \u5165\u308c\u308b\n[ec2-user@ip-172-31-35-121 ~]$ bundle list\n-bash: bundle: \u30b3\u30de\u30f3\u30c9\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\n[ec2-user@ip-172-31-35-121 ~]$ gem install bundler --no-rdoc --no-ri\nFetching: bundler-1.6.3.gem (100%)\nSuccessfully installed bundler-1.6.3\n1 gem installed\n[ec2-user@ip-172-31-35-121 ~]$ gem list\n\n*** LOCAL GEMS ***\n\nbigdecimal (1.2.3)\nbundler (1.6.3)\nio-console (0.4.2)\njson (1.8.1)\nminitest (4.7.5)\npsych (2.0.2)\nrake (10.1.0)\nrdoc (4.1.0)\ntest-unit (2.1.0.0)\n[ec2-user@ip-172-31-35-121 ~]$ sudo rbenv rehash\n[ec2-user@ip-172-31-35-121 ~]$ ll\n\u5408\u8a08 0\n\n\n4. rails \u5165\u308c\u308b\n[ec2-user@ip-172-31-11-135 ~]$ gem install rails\n[ec2-user@ip-172-31-11-135 ~]$ rbenv rehash\n[ec2-user@ip-172-31-11-135 ~]$ rails -v\nrails 4.1.4\n[ec2-user@ip-172-31-11-135 ~]$ which rails\n~/.rbenv/shims/\n\n\n5.sqlite3\u3044\u308c\u308b\n$ sudo yum install sqlite-devel\n$ gem install sqlite3;rbenv rehash\n\n\n5`.mysql \u3092\u5165\u308c\u308b\n[ec2-user@ip- ~]$ sudo yum install mysql-server mysql-devel\n[ec2-user@ip- ~]$ sudo service mysqld start\nInitializing MySQL database:  Installing MySQL system tables...\nOK\nFilling help tables...\nOK\n\nTo start mysqld at boot time you have to copy\nsupport-files/mysql.server to the right place for your system\n\nPLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !\nTo do so, start the server, then issue the following commands:\n\n/usr/bin/mysqladmin -u root password 'new-password'\n/usr/bin/mysqladmin -u root -h ip-172-31-1-139 password 'new-password'\n\nAlternatively you can run:\n/usr/bin/mysql_secure_installation\n\nwhich will also give you the option of removing the test\ndatabases and anonymous user created by default.  This is\nstrongly recommended for production servers.\n\nSee the manual for more instructions.\n\nYou can start the MySQL daemon with:\ncd /usr ; /usr/bin/mysqld_safe &\n\nYou can test the MySQL daemon with mysql-test-run.pl\ncd /usr/mysql-test ; perl mysql-test-run.pl\n\nPlease report any problems at http://bugs.mysql.com/\n\n                                                           [  OK  ]\nStarting mysqld:                                           [  OK  ]\n[ec2-user@ip- ~]$ mysqladmin -u root password 'new-password!!'\n[ec2-user@ip- ~]$ mysql -u root -p\u3000#\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u78ba\u8a8d\n\n\n6.unicorn\u3092\u5165\u308c\u308b\u3002\n\u3053\u308c\u306f\u3001gemfile\u306b\n\nvi Gemfile\ngem 'unicorn'\u3092\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\nbundle install --path vender/bundle\n\n\n7. rails\u306e\u78ba\u8a8d\nrails server\ncurl -I localhost:3000\n\n\n8. unicorn\u3092\u5165\u308c\u308b\ncd myapp\nvi config/unicorn.conf\n# \u4e2d\u8eab\nworker_processes 2\nlisten '/tmp/unicorn.sock'\nstderr_path File.expand_path('unicorn.log', File.dirname(__FILE__) + '/../log')\nstdout_path File.expand_path('unicorn.log', File.dirname(__FILE__) + '/../log')\npreload_app true\n\n\n9.nginx\u3092\u5165\u308c\u308b\nsudo yum -y install nginx\n\n\n10.nginx\u306e\u78ba\u8a8d\nsudo /etc/init.d/nginx start\n# http://xxx.compute.amazon.com/\n# Welcome to nginx on the Amazon Linux AMI!\u3068\u51fa\u308c\u3070\u6210\u529f\nsudo /etc/init.d/nginx stop\n# \u516c\u958b\u30d1\u30b9 /usr/share/ngin/html/\n\n\n11.nginx\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\nsudo vi /etc/nginx/nginx.conf\n\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    upstream unicornapp {\n        server unix:/tmp/unicorn.sock;\n    }\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n        location / {\n            proxy_pass http://unicornapp;\n        }\n    }\n}\n\n\u7de8\u96c6\u5f8c\u3002\n\nsudo /etc/init.d/nginx stop\nsudo /etc/init.d/nginx start\n\n\u3067\u30d6\u30e9\u30a6\u30b6\u3092\u898b\u308b\u3002\n\u203bnginx \u3068unicorn\u306e\u8a73\u7d30\u306e\u8a2d\u5b9a\u306f\u3001\u307e\u305f\u4eca\u5ea6\u3002\n\n\u53c2\u8003\n\n\u7121\u6599\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d0EC2\u306bRuby,\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u624b\u9806\u307e\u3068\u3081\nAmazonLinux\u306brbenv\u3067ruby\u3092\u5165\u308c\u3066\u307f\u308b\n\n\u306eEC2\u4e0a\u3067+Unicorn+Nginx\u3092\u5b9f\u73fe\u3059\u308b \u2190\u307b\u307c\u3053\u308c\n\n## \u4ed5\u69d8\n\n* AWS\u306e\u4ed5\u69d8\n * t2.micro\n\n\n## \u5b9f\u88c5\n\u30dd\u30c1\u30dd\u30c1\u3057\u3066\u3001\u30b5\u30fc\u30d0\u30fc\u306b\u5165\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d(sudo yum update)\u3002\n\u203b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3067\u300122\u756a\u306f\u3001myIP\u3067\u3002\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 80\u756a\u304c\u3001anyway\u306b\u3057\u306a\u3044\u3068Nginx\u304c\u52d5\u304b\u306a\u3044\u305e\uff01\uff01\uff01\n\u305d\u3053\u304b\u3089\u3001\n\n```\n[ec2-user@ip-172-31-35-121 ~]$ git -v\n-bash: git: \u30b3\u30de\u30f3\u30c9\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\n[ec2-user@ip-172-31-35-121 ~]$ ruby -v\nruby 2.0.0p451 (2014-02-24 revision 45167) [x86_64-linux]\n[ec2-user@ip-172-31-35-121 ~]$ $ sudo yum install -y gcc-c++ patch readline readline-devel zlib zlib-devel libyaml-devel libffi-devel openssl-devel make bzip2 autoconf automake libtool bison git\n......\n....\n..\n.\n[ec2-user@ip-172-31-35-121 ~]$ git --version\ngit version 1.8.3.1\n```\n\n\u6b21\u306b\u3001rbenv\u3092\u5165\u308c\u308b\u3002\n\n### 1. ruby-build\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\ncd\ngit clone git://github.com/sstephenson/ruby-build.git\ncd ruby-build\nsudo ./install.sh\n```\n\n### 2.rbenv, ruby\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\ncd\ngit clone git://github.com/sstephenson/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' >> ~/.bash_profile\necho 'eval \"$(rbenv init -)\"' >> ~/.bash_profile\nsource ~/.bashrc\nexec $SHELL -l\nrbenv install -l\nrbenv install 2.1.0;rbenv rehash\nrbenv global 2.1.0\n```\n\n### \u7d50\u679c\n```\n[ec2-user@ip-172-31-11-135 ~]$ ruby -v\nruby 2.1.0p0 (2013-12-25 revision 44422) [x86_64-linux]\n[ec2-user@ip-172-31-11-135 ~]$ which gem\n~/.rbenv/shims/gem\n[ec2-user@ip-172-31-11-135 ~]$ which ruby\n~/.rbenv/shims/ruby\n[ec2-user@ip-172-31-11-135 ~]$\n```\n\n### 3.bundle \u5165\u308c\u308b\n```\n[ec2-user@ip-172-31-35-121 ~]$ bundle list\n-bash: bundle: \u30b3\u30de\u30f3\u30c9\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\n[ec2-user@ip-172-31-35-121 ~]$ gem install bundler --no-rdoc --no-ri\nFetching: bundler-1.6.3.gem (100%)\nSuccessfully installed bundler-1.6.3\n1 gem installed\n[ec2-user@ip-172-31-35-121 ~]$ gem list\n\n*** LOCAL GEMS ***\n\nbigdecimal (1.2.3)\nbundler (1.6.3)\nio-console (0.4.2)\njson (1.8.1)\nminitest (4.7.5)\npsych (2.0.2)\nrake (10.1.0)\nrdoc (4.1.0)\ntest-unit (2.1.0.0)\n[ec2-user@ip-172-31-35-121 ~]$ sudo rbenv rehash\n[ec2-user@ip-172-31-35-121 ~]$ ll\n\u5408\u8a08 0\n```\n\n### 4. rails \u5165\u308c\u308b\n```\n[ec2-user@ip-172-31-11-135 ~]$ gem install rails\n[ec2-user@ip-172-31-11-135 ~]$ rbenv rehash\n[ec2-user@ip-172-31-11-135 ~]$ rails -v\nrails 4.1.4\n[ec2-user@ip-172-31-11-135 ~]$ which rails\n~/.rbenv/shims/\n```\n\n### 5.sqlite3\u3044\u308c\u308b\n```\n$ sudo yum install sqlite-devel\n$ gem install sqlite3;rbenv rehash\n```\n\n###5`.mysql \u3092\u5165\u308c\u308b\n```\n[ec2-user@ip- ~]$ sudo yum install mysql-server mysql-devel\n[ec2-user@ip- ~]$ sudo service mysqld start\nInitializing MySQL database:  Installing MySQL system tables...\nOK\nFilling help tables...\nOK\n\nTo start mysqld at boot time you have to copy\nsupport-files/mysql.server to the right place for your system\n\nPLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !\nTo do so, start the server, then issue the following commands:\n\n/usr/bin/mysqladmin -u root password 'new-password'\n/usr/bin/mysqladmin -u root -h ip-172-31-1-139 password 'new-password'\n\nAlternatively you can run:\n/usr/bin/mysql_secure_installation\n\nwhich will also give you the option of removing the test\ndatabases and anonymous user created by default.  This is\nstrongly recommended for production servers.\n\nSee the manual for more instructions.\n\nYou can start the MySQL daemon with:\ncd /usr ; /usr/bin/mysqld_safe &\n\nYou can test the MySQL daemon with mysql-test-run.pl\ncd /usr/mysql-test ; perl mysql-test-run.pl\n\nPlease report any problems at http://bugs.mysql.com/\n\n                                                           [  OK  ]\nStarting mysqld:                                           [  OK  ]\n[ec2-user@ip- ~]$ mysqladmin -u root password 'new-password!!'\n[ec2-user@ip- ~]$ mysql -u root -p\u3000#\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u304b\u78ba\u8a8d\n```\n### 6.unicorn\u3092\u5165\u308c\u308b\u3002\n\u3053\u308c\u306f\u3001gemfile\u306b\n```\nvi Gemfile\ngem 'unicorn'\u3092\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\nbundle install --path vender/bundle\n```\n\n### 7. rails\u306e\u78ba\u8a8d\n```\nrails server\ncurl -I localhost:3000\n```\n\n### 8. unicorn\u3092\u5165\u308c\u308b\n```\ncd myapp\nvi config/unicorn.conf\n# \u4e2d\u8eab\nworker_processes 2\nlisten '/tmp/unicorn.sock'\nstderr_path File.expand_path('unicorn.log', File.dirname(__FILE__) + '/../log')\nstdout_path File.expand_path('unicorn.log', File.dirname(__FILE__) + '/../log')\npreload_app true\n```\n\n### 9.nginx\u3092\u5165\u308c\u308b\n```\nsudo yum -y install nginx\n```\n\n### 10.nginx\u306e\u78ba\u8a8d\n```\nsudo /etc/init.d/nginx start\n# http://xxx.compute.amazon.com/\n# Welcome to nginx on the Amazon Linux AMI!\u3068\u51fa\u308c\u3070\u6210\u529f\nsudo /etc/init.d/nginx stop\n# \u516c\u958b\u30d1\u30b9 /usr/share/ngin/html/\n```\n\n### 11.nginx\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6\n```\nsudo vi /etc/nginx/nginx.conf\n```\n\n```\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    upstream unicornapp {\n        server unix:/tmp/unicorn.sock;\n    }\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n        location / {\n            proxy_pass http://unicornapp;\n        }\n    }\n}\n```\n\u7de8\u96c6\u5f8c\u3002\n```\nsudo /etc/init.d/nginx stop\nsudo /etc/init.d/nginx start\n```\n\u3067\u30d6\u30e9\u30a6\u30b6\u3092\u898b\u308b\u3002\n\n\n\u203bnginx \u3068unicorn\u306e\u8a73\u7d30\u306e\u8a2d\u5b9a\u306f\u3001\u307e\u305f\u4eca\u5ea6\u3002\n\n\n\n### \u53c2\u8003\n - [\u7121\u6599\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d0EC2\u306bRuby,\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u624b\u9806\u307e\u3068\u3081](http://www.sakc.jp/blog/archives/32865)\n - [AmazonLinux\u306brbenv\u3067ruby\u3092\u5165\u308c\u3066\u307f\u308b](https://github.com/mechamogera/MyTips/wiki/AmazonLinux%E3%81%ABrbenv%E3%81%A7ruby%E3%82%92%E5%85%A5%E3%82%8C%E3%81%A6%E3%81%BF%E3%82%8B)\n - [\u306eEC2\u4e0a\u3067+Unicorn+Nginx\u3092\u5b9f\u73fe\u3059\u308b](https://gist.github.com/honjo2/5023446) \u2190\u307b\u307c\u3053\u308c\n", "tags": ["Ruby2.1", "Rails4.1", "nginx1.4", "unicorn4.8"]}