{"tags": ["IDCF\u30af\u30e9\u30a6\u30c9", "cloud-init0.7.7", "SnappyUbuntuCore15.04", "OVA", "Ubuntu"], "context": " More than 1 year has passed since last update.2015-01-14\u306b\u5f85\u671b\u306eSnappy Ubuntu Core\u306eOVA\u30a4\u30e1\u30fc\u30b8\u304c\u516c\u958b\u3055\u308c\u307e\u3057\u305f\u3002\u4ee5\u524d\u306fVMware\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u3068\u304d\u306f\u304b\u306a\u308a\u9762\u5012\u3067\u3001\u91ce\u826fOVA\u30a4\u30e1\u30fc\u30b8\u306e\u30d3\u30eb\u30c9\u306b\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u304c\u5fc5\u8981\u3067\u3057\u305f\u3002\n\nqemu-img\u30b3\u30de\u30f3\u30c9\u3067QCOW2\u30a4\u30e1\u30fc\u30b8\u3092VMDK\u5f62\u5f0f\u3059\u308b\nVMX\u30d5\u30a1\u30a4\u30eb\u3092\u30de\u30cb\u30e5\u30a2\u30eb\u3067\u8a18\u8ff0\u3059\u308b\novftool\u30b3\u30de\u30f3\u30c9\u3067VMX\u30d5\u30a1\u30a4\u30eb\u304b\u3089OVA\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\n\n\u516c\u5f0f\u306eOVA\u306b\u306fcloud-init\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u306a\u306e\u3067\u3001cloud-config.yml\u3092userdata\u3068\u3057\u3066\u4f7f\u3048\u3070\u3001IDCF\u30af\u30e9\u30a6\u30c9\u3067\u3082Snappy Ubuntu Core\u304c\u7c21\u5358\u306b\u4f7f\u3048\u307e\u3059\u3002\n\nOVA\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u4f5c\u6210\nSnappy Ubuntu Core now on the hypervisor of your choice with OVA\u306e\u30da\u30fc\u30b8\u306b\u3042\u308blatest OVA image\u306e\u30ea\u30f3\u30af\u304b\u3089OVA\u306eURL\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d\u3001\u8aac\u660e\u3001URL\u3001OS\u30bf\u30a4\u30d7\u4ee5\u5916\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3059\u3002OS\u30bf\u30a4\u30d7\u306f\u4e00\u756a\u8fd1\u3044Ubuntu 12.04 (64bit)\u3092\u9078\u3073\u307e\u3057\u305f\u3002\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d: \u4efb\u610f\n\u8aac\u660e: \u4efb\u610f\nURL: http://cloud-images.ubuntu.com/snappy/devel/core/current/devel-core-amd64-cloud.ova\n\n\u30be\u30fc\u30f3: tesla\n\u30cf\u30a4\u30d1\u30fc\u30d0\u30a4\u30b6\u30fc: VMware\nOS\u30bf\u30a4\u30d7: Ubuntu 12.04 (64bit)\n\u30d5\u30a9\u30fc\u30de\u30c3\u30c8: OVA\n\u30a8\u30af\u30b9\u30dd\u30fc\u30c8: \u6709\u52b9\n\u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8: \u6709\u52b9\n\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30b9\u30b1\u30fc\u30eb: \u6709\u52b9\n\u30eb\u30fc\u30c8\u30c7\u30a3\u30b9\u30af\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9: scsi\nNIC\u30a2\u30c0\u30d7\u30bf: Vmxnet3\n\u30ad\u30fc\u30dc\u30fc\u30c9: Japanese\n\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4f5c\u6210\n\n\u6700\u5c0f\u8a2d\u5b9a\u306ecloud-config\nSnappy Ubuntu Core\u306fCoreOS\u3068\u540c\u3058\u3088\u3046\u306bcloud-config\u3092\u4f7f\u3063\u3066\u8d77\u52d5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002cloud-config\u3092\u4f7f\u308f\u306a\u304f\u3066\u3082\u8d77\u52d5\u306f\u3067\u304d\u307e\u3059\u304c\u3001\u5916\u90e8\u304b\u3089\u306eSSH\u63a5\u7d9a\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3057\u304b\u4f7f\u3048\u307e\u305b\u3093\u3002\u4eca\u56de\u306f\u6700\u5c0f\u8a2d\u5b9a\u306ecloud-config\u3092\u4f7f\u3044\u307e\u3059\u3002\n\ncloud-config.yml\n#cloud-config\nsnappy:\n  ssh_enabled: True\n\n\n\n\u5fc5\u8981\u306a\u60c5\u5831\u306e\u53d6\u5f97\n\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u6642\u306b\u5fc5\u8981\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092IDCF\u30af\u30e9\u30a6\u30c9\u306eCLI\u3092\u4f7f\u3044\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nlistTemplates: \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306eid\u3092\u53d6\u5f97\nlistZones: \u30be\u30fc\u30f3\u306eid\u3092\u53d6\u5f97\nlistServiceOfferings: \u4eee\u60f3\u30de\u30b7\u30f3\u30b5\u30a4\u30ba\u306eid\u3092\u53d6\u5f97\nlistSSHKeyPairs: SSH\u516c\u958b\u9375\u306e\u540d\u524d\u3092\u53d6\u5f97\n\nSnappy Ubuntu Core\u306b\u306fCloud-init\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u307e\u3059\u3002IDCF\u30af\u30e9\u30a6\u30c9\u304c\u63a1\u7528\u3057\u3066\u3044\u308bCloudStack\u3092DataSource\u3068\u3057\u3066\u81ea\u52d5\u7684\u306b\u8a8d\u8b58\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u6307\u5b9a\u3057\u305f\u540d\u524d\u306eSSH\u516c\u958b\u9375\u3092ubuntu\u30e6\u30fc\u30b6\u30fc\u306eauthorized_keys\u306b\u767b\u9332\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3053\u308c\u306f\u304b\u306a\u308a\u4fbf\u5229\u3067\u3059\u3002\n\u307e\u305fAPI\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u4ee5\u4e0b\u306e\u60c5\u5831\u3092\u30dd\u30fc\u30bf\u30eb\u306e\u753b\u9762\u304b\u3089\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\nIDCF_COMPUTE_HOST: \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\n\nIDCF_COMPUTE_API_KEY: API\u30ad\u30fc\n\nIDCF_COMPUTE_SECRET_KEY: \u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\n\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u4f5c\u6210\u306ePython\u30b9\u30af\u30ea\u30d7\u30c8\nIDCF\u30af\u30e9\u30a6\u30c9\u306eCLI\u30c4\u30fc\u30eb\u306fPython\u3067\u66f8\u3044\u3066\u3044\u308b\u306e\u3067\u3001Python\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066import\u3067\u304d\u307e\u3059\u3002cloud-config\u306fuserdata\u3068\u3057\u3066BASE64\u3067\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u3066\u304b\u3089\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u4f7f\u3044\u307e\u3059\u3002\n\ndeploy.py\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport base64\nfrom idcf.compute import Compute\n\ndef main():\n    rawuserdata = '''#cloud-config\nsnappy:\n  ssh_enabled: True\n'''\n    userdata = base64.b64encode(rawuserdata)\n    client = Compute(\n        host='\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8',\n        api_key='API\u30ad\u30fc',\n        secret_key='\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc',\n        debug=True)\n\n    retval = client.deployVirtualMachine(\n        keypair='SSH\u516c\u958b\u9375\u306e\u540d\u524d',\n        serviceofferingid='\u4eee\u60f3\u30de\u30b7\u30f3\u30b5\u30a4\u30ba\u306eID',\n        templateid='\u767b\u9332\u3057\u305fOVA\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306eID',\n        zoneid='\u30be\u30fc\u30f3\u306eID',\n        name='\u4efb\u610f\u306ehostname',\n        userdata=userdata)\n\n    print(retval)\n\nif __name__ == \"__main__\":\n    main()\n\n\n\nPython\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\n\u4eee\u60f3\u30de\u30b7\u30f3\u304c\u4f5c\u6210\u3055\u308c\u308b\u307e\u3067\u6570\u5206\u5f85\u3061\u307e\u3059\u3002SSH\u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3059\u308b\u307e\u3067\u306b\u521d\u56de\u8a2d\u5b9a\u304c\u5165\u308b\u305f\u3081\u3001\u30dd\u30fc\u30bf\u30eb\u753b\u9762\u3067\u72b6\u614b\u304cRunning\u306b\u306a\u3063\u3066\u3044\u3066\u3082SSH\u3067\u63a5\u7d9a\u3067\u304d\u308b\u307e\u3067\u3055\u3089\u306b\u6570\u5206\u5fc5\u8981\u3067\u3059\u3002\u30b3\u30f3\u30bd\u30fc\u30eb\u3067login\u5f85\u6a5f\u306b\u306a\u308b\u307e\u3067\u3057\u3070\u3089\u304f\u5f85\u3061\u307e\u3059\u3002\n\nSSH\u516c\u958b\u9375\u8a8d\u8a3c\u3067\u30ed\u30b0\u30a4\u30f3\n\u30a2\u30ab\u30a6\u30f3\u30c8\u5185\u306e\u5225\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u304b\u3089\u3001\u307e\u305f\u306f\u3001\u30d1\u30d6\u30ea\u30c3\u30af\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u3066SSH\u516c\u958b\u9375\u8a8d\u8a3c\u3067\u63a5\u7d9a\u3057\u307e\u3059\u3002\n$ ssh -A ubuntu@snappy \nWelcome to Ubuntu Vivid Vervet (development branch) (GNU/Linux 3.18.0-9-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com/\n\nThe programs included with the Ubuntu system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\napplicable law.\n\nWelcome to the Ubuntu Core rolling development release.\n\n * See https://ubuntu.com/snappy\n\nIt's a brave new world here in snappy Ubuntu Core! This machine\ndoes not use apt-get or deb packages. Please see 'snappy --help'\nfor app installation and transactional updates.\n\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\nubuntu@snappy:~$\n\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\u306a\u3069\nOS\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ cat /etc/lsb-release\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=15.04\nDISTRIB_CODENAME=vivid\nDISTRIB_DESCRIPTION=\"Ubuntu Vivid Vervet (development branch)\"\n\nubuntu-core\u306fedge 144\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u3066\u6700\u65b0\u306e\u72b6\u614b\u3067\u3059\u3002\n$ snappy versions\nPart         Tag   Installed  Available  Fingerprint     Active\nubuntu-core  edge  144        -          395812b6615109  *\nThis command needs root, please run with sudo\n$ snappy update-versions\n0 updated components are available with your current stability settings.\n\nsnappy\u30b3\u30de\u30f3\u30c9\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3059\u3002\n$ snappy --version\n0.1\n\n\u307e\u3060frameworks\u3082apps\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n$ snappy info\nrelease: ubuntu-core/devel\nframeworks:\napps:\n\n\nDocker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3068\u308a\u3042\u3048\u305aDocker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002Snappy Ubuntu Core\u3067\u306fDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u3068\u3066\u3082\u7c21\u5358\u306a\u306e\u3067\u3059\u3050\u306b\u4f7f\u3044\u59cb\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n$ snappy search docker\nPart    Version    Description\ndocker  1.3.3.001  The docker app deployment mechanism\n$ sudo snappy install docker\ndocker      4 MB     [===================================================================]    OK\nPart    Tag   Installed  Available  Fingerprint     Active\ndocker  edge  1.3.3.001  -          60b98945e5fc1d  *\nReboot to use the new ubuntu-core.\n$ sudo snappy versions\nPart         Tag   Installed  Available  Fingerprint     Active\nubuntu-core  edge  144        -          395812b6615109  *\ndocker       edge  1.3.3.001  -          60b98945e5fc1d  *\nReboot to use the new ubuntu-core.\n\n\n\u30a2\u30d7\u30ea\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30b5\u30f3\u30d7\u30eb\u306ehello-world\u30a2\u30d7\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ sudo snappy install hello-world\nhello-world     31 kB     [==============================================================]    OK\nPart         Tag   Installed  Available  Fingerprint     Active\nhello-world  edge  1.0.5      -          3e8b192e18907d  *\nReboot to use the new ubuntu-core.\n\n\u5148\u307b\u3069\u306edocker\u306fframeworks\u3001hello-world\u30a2\u30d7\u30ea\u306fapps\u3068\u3057\u3066\u30ec\u30a4\u30a2\u3067\u533a\u5225\u3055\u308c\u307e\u3059\u3002\n$ snappy info\nrelease: ubuntu-core/devel\nframeworks: docker\napps: hello-world\n\nHello World!\u3092\u8868\u793a\u3059\u308b\u3060\u3051\u306e\u30a2\u30d7\u30ea\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3057\u305f\u3002\n$ which hello-world.echo\n/home/ubuntu/snappy-bin/hello-world.echo\n$ hello-world.echo\nHello World!\n\n2015-01-14\u306b\u5f85\u671b\u306eSnappy Ubuntu Core\u306e[OVA\u30a4\u30e1\u30fc\u30b8\u304c\u516c\u958b](https://insights.ubuntu.com/2015/01/15/snappy-ubuntu-core-now-on-the-hypervisor-of-your-choice-with-ova/)\u3055\u308c\u307e\u3057\u305f\u3002\u4ee5\u524d\u306fVMware\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u3068\u304d\u306f\u304b\u306a\u308a\u9762\u5012\u3067\u3001\u91ce\u826fOVA\u30a4\u30e1\u30fc\u30b8\u306e\u30d3\u30eb\u30c9\u306b\u6b21\u306e\u30b9\u30c6\u30c3\u30d7\u304c\u5fc5\u8981\u3067\u3057\u305f\u3002\n\n1. qemu-img\u30b3\u30de\u30f3\u30c9\u3067QCOW2\u30a4\u30e1\u30fc\u30b8\u3092VMDK\u5f62\u5f0f\u3059\u308b\n2. VMX\u30d5\u30a1\u30a4\u30eb\u3092\u30de\u30cb\u30e5\u30a2\u30eb\u3067\u8a18\u8ff0\u3059\u308b\n3. ovftool\u30b3\u30de\u30f3\u30c9\u3067VMX\u30d5\u30a1\u30a4\u30eb\u304b\u3089OVA\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\n\n\u516c\u5f0f\u306eOVA\u306b\u306fcloud-init\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u306a\u306e\u3067\u3001cloud-config.yml\u3092userdata\u3068\u3057\u3066\u4f7f\u3048\u3070\u3001IDCF\u30af\u30e9\u30a6\u30c9\u3067\u3082Snappy Ubuntu Core\u304c\u7c21\u5358\u306b\u4f7f\u3048\u307e\u3059\u3002\n\n<!-- more -->\n\n## OVA\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u4f5c\u6210\n\n[Snappy Ubuntu Core now on the hypervisor of your choice with OVA](https://insights.ubuntu.com/2015/01/15/snappy-ubuntu-core-now-on-the-hypervisor-of-your-choice-with-ova/)\u306e\u30da\u30fc\u30b8\u306b\u3042\u308b[latest OVA image](http://cloud-images.ubuntu.com/snappy/devel/core/current/devel-core-amd64-cloud.ova)\u306e\u30ea\u30f3\u30af\u304b\u3089OVA\u306eURL\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d\u3001\u8aac\u660e\u3001URL\u3001OS\u30bf\u30a4\u30d7\u4ee5\u5916\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3059\u3002OS\u30bf\u30a4\u30d7\u306f\u4e00\u756a\u8fd1\u3044`Ubuntu 12.04 (64bit)`\u3092\u9078\u3073\u307e\u3057\u305f\u3002\n\n* \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u540d: \u4efb\u610f\n* \u8aac\u660e: \u4efb\u610f\n* URL: http://cloud-images.ubuntu.com/snappy/devel/core/current/devel-core-amd64-cloud.ova\n* \u30be\u30fc\u30f3: tesla\n* \u30cf\u30a4\u30d1\u30fc\u30d0\u30a4\u30b6\u30fc: VMware\n* OS\u30bf\u30a4\u30d7: Ubuntu 12.04 (64bit)\n* \u30d5\u30a9\u30fc\u30de\u30c3\u30c8: OVA\n* \u30a8\u30af\u30b9\u30dd\u30fc\u30c8: \u6709\u52b9\n* \u30d1\u30b9\u30ef\u30fc\u30c9\u30ea\u30bb\u30c3\u30c8: \u6709\u52b9\n* \u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30b9\u30b1\u30fc\u30eb: \u6709\u52b9\n* \u30eb\u30fc\u30c8\u30c7\u30a3\u30b9\u30af\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9: scsi\n* NIC\u30a2\u30c0\u30d7\u30bf: Vmxnet3\n* \u30ad\u30fc\u30dc\u30fc\u30c9: Japanese\n\n\n## \u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4f5c\u6210\n\n### \u6700\u5c0f\u8a2d\u5b9a\u306ecloud-config\n\nSnappy Ubuntu Core\u306fCoreOS\u3068\u540c\u3058\u3088\u3046\u306bcloud-config\u3092\u4f7f\u3063\u3066\u8d77\u52d5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002cloud-config\u3092\u4f7f\u308f\u306a\u304f\u3066\u3082\u8d77\u52d5\u306f\u3067\u304d\u307e\u3059\u304c\u3001\u5916\u90e8\u304b\u3089\u306eSSH\u63a5\u7d9a\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3057\u304b\u4f7f\u3048\u307e\u305b\u3093\u3002\u4eca\u56de\u306f\u6700\u5c0f\u8a2d\u5b9a\u306ecloud-config\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n``` yaml:cloud-config.yml\n#cloud-config\nsnappy:\n  ssh_enabled: True\n```\n\n### \u5fc5\u8981\u306a\u60c5\u5831\u306e\u53d6\u5f97\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u6642\u306b\u5fc5\u8981\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092IDCF\u30af\u30e9\u30a6\u30c9\u306eCLI\u3092\u4f7f\u3044\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n* listTemplates: \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306eid\u3092\u53d6\u5f97\n* listZones: \u30be\u30fc\u30f3\u306eid\u3092\u53d6\u5f97\n* listServiceOfferings: \u4eee\u60f3\u30de\u30b7\u30f3\u30b5\u30a4\u30ba\u306eid\u3092\u53d6\u5f97\n* listSSHKeyPairs: SSH\u516c\u958b\u9375\u306e\u540d\u524d\u3092\u53d6\u5f97\n\nSnappy Ubuntu Core\u306b\u306fCloud-init\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u307e\u3059\u3002IDCF\u30af\u30e9\u30a6\u30c9\u304c\u63a1\u7528\u3057\u3066\u3044\u308bCloudStack\u3092DataSource\u3068\u3057\u3066\u81ea\u52d5\u7684\u306b\u8a8d\u8b58\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u6307\u5b9a\u3057\u305f\u540d\u524d\u306eSSH\u516c\u958b\u9375\u3092ubuntu\u30e6\u30fc\u30b6\u30fc\u306e`authorized_keys`\u306b\u767b\u9332\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3053\u308c\u306f\u304b\u306a\u308a\u4fbf\u5229\u3067\u3059\u3002\n\n\u307e\u305fAPI\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306a\u4ee5\u4e0b\u306e\u60c5\u5831\u3092\u30dd\u30fc\u30bf\u30eb\u306e\u753b\u9762\u304b\u3089\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n* `IDCF_COMPUTE_HOST`: \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\n* `IDCF_COMPUTE_API_KEY`: API\u30ad\u30fc\n* `IDCF_COMPUTE_SECRET_KEY`: \u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\n\n### \u4eee\u60f3\u30de\u30b7\u30f3\u4f5c\u6210\u306ePython\u30b9\u30af\u30ea\u30d7\u30c8\n\nIDCF\u30af\u30e9\u30a6\u30c9\u306eCLI\u30c4\u30fc\u30eb\u306fPython\u3067\u66f8\u3044\u3066\u3044\u308b\u306e\u3067\u3001Python\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u3057\u3066import\u3067\u304d\u307e\u3059\u3002cloud-config\u306fuserdata\u3068\u3057\u3066BASE64\u3067\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u3066\u304b\u3089\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u4f7f\u3044\u307e\u3059\u3002\n\n\n``` python:deploy.py\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport base64\nfrom idcf.compute import Compute\n\ndef main():\n    rawuserdata = '''#cloud-config\nsnappy:\n  ssh_enabled: True\n'''\n    userdata = base64.b64encode(rawuserdata)\n    client = Compute(\n        host='\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8',\n        api_key='API\u30ad\u30fc',\n        secret_key='\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc',\n        debug=True)\n\n    retval = client.deployVirtualMachine(\n        keypair='SSH\u516c\u958b\u9375\u306e\u540d\u524d',\n        serviceofferingid='\u4eee\u60f3\u30de\u30b7\u30f3\u30b5\u30a4\u30ba\u306eID',\n        templateid='\u767b\u9332\u3057\u305fOVA\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306eID',\n        zoneid='\u30be\u30fc\u30f3\u306eID',\n        name='\u4efb\u610f\u306ehostname',\n        userdata=userdata)\n\n    print(retval)\n\nif __name__ == \"__main__\":\n    main()\n```\n\n### Python\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\n\n\u4eee\u60f3\u30de\u30b7\u30f3\u304c\u4f5c\u6210\u3055\u308c\u308b\u307e\u3067\u6570\u5206\u5f85\u3061\u307e\u3059\u3002SSH\u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3059\u308b\u307e\u3067\u306b\u521d\u56de\u8a2d\u5b9a\u304c\u5165\u308b\u305f\u3081\u3001\u30dd\u30fc\u30bf\u30eb\u753b\u9762\u3067\u72b6\u614b\u304cRunning\u306b\u306a\u3063\u3066\u3044\u3066\u3082SSH\u3067\u63a5\u7d9a\u3067\u304d\u308b\u307e\u3067\u3055\u3089\u306b\u6570\u5206\u5fc5\u8981\u3067\u3059\u3002\u30b3\u30f3\u30bd\u30fc\u30eb\u3067login\u5f85\u6a5f\u306b\u306a\u308b\u307e\u3067\u3057\u3070\u3089\u304f\u5f85\u3061\u307e\u3059\u3002\n\n### SSH\u516c\u958b\u9375\u8a8d\u8a3c\u3067\u30ed\u30b0\u30a4\u30f3\n\n\u30a2\u30ab\u30a6\u30f3\u30c8\u5185\u306e\u5225\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u304b\u3089\u3001\u307e\u305f\u306f\u3001\u30d1\u30d6\u30ea\u30c3\u30af\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u3066SSH\u516c\u958b\u9375\u8a8d\u8a3c\u3067\u63a5\u7d9a\u3057\u307e\u3059\u3002\n\n``` bash\n$ ssh -A ubuntu@snappy \nWelcome to Ubuntu Vivid Vervet (development branch) (GNU/Linux 3.18.0-9-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com/\n\nThe programs included with the Ubuntu system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\napplicable law.\n\nWelcome to the Ubuntu Core rolling development release.\n\n * See https://ubuntu.com/snappy\n\nIt's a brave new world here in snappy Ubuntu Core! This machine\ndoes not use apt-get or deb packages. Please see 'snappy --help'\nfor app installation and transactional updates.\n\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\nubuntu@snappy:~$\n```\n\n### \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\u306a\u3069\n\nOS\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n``` bash\n$ cat /etc/lsb-release\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=15.04\nDISTRIB_CODENAME=vivid\nDISTRIB_DESCRIPTION=\"Ubuntu Vivid Vervet (development branch)\"\n```\n\nubuntu-core\u306fedge 144\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u3066\u6700\u65b0\u306e\u72b6\u614b\u3067\u3059\u3002\n\n``` bash\n$ snappy versions\nPart         Tag   Installed  Available  Fingerprint     Active\nubuntu-core  edge  144        -          395812b6615109  *\nThis command needs root, please run with sudo\n$ snappy update-versions\n0 updated components are available with your current stability settings.\n```\n\nsnappy\u30b3\u30de\u30f3\u30c9\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3059\u3002\n\n``` bash\n$ snappy --version\n0.1\n```\n\n\u307e\u3060frameworks\u3082apps\u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\n``` bash\n$ snappy info\nrelease: ubuntu-core/devel\nframeworks:\napps:\n```\n### Docker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3068\u308a\u3042\u3048\u305aDocker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002Snappy Ubuntu Core\u3067\u306fDocker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u3068\u3066\u3082\u7c21\u5358\u306a\u306e\u3067\u3059\u3050\u306b\u4f7f\u3044\u59cb\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n``` bash\n$ snappy search docker\nPart    Version    Description\ndocker  1.3.3.001  The docker app deployment mechanism\n$ sudo snappy install docker\ndocker      4 MB     [===================================================================]    OK\nPart    Tag   Installed  Available  Fingerprint     Active\ndocker  edge  1.3.3.001  -          60b98945e5fc1d  *\nReboot to use the new ubuntu-core.\n$ sudo snappy versions\nPart         Tag   Installed  Available  Fingerprint     Active\nubuntu-core  edge  144        -          395812b6615109  *\ndocker       edge  1.3.3.001  -          60b98945e5fc1d  *\nReboot to use the new ubuntu-core.\n```\n\n### \u30a2\u30d7\u30ea\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30b5\u30f3\u30d7\u30eb\u306ehello-world\u30a2\u30d7\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n``` bash\n$ sudo snappy install hello-world\nhello-world     31 kB     [==============================================================]    OK\nPart         Tag   Installed  Available  Fingerprint     Active\nhello-world  edge  1.0.5      -          3e8b192e18907d  *\nReboot to use the new ubuntu-core.\n```\n\n\u5148\u307b\u3069\u306edocker\u306fframeworks\u3001hello-world\u30a2\u30d7\u30ea\u306fapps\u3068\u3057\u3066\u30ec\u30a4\u30a2\u3067\u533a\u5225\u3055\u308c\u307e\u3059\u3002\n\n``` bash\n$ snappy info\nrelease: ubuntu-core/devel\nframeworks: docker\napps: hello-world\n```\n \nHello World!\u3092\u8868\u793a\u3059\u308b\u3060\u3051\u306e\u30a2\u30d7\u30ea\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3057\u305f\u3002\n \n``` bash\n$ which hello-world.echo\n/home/ubuntu/snappy-bin/hello-world.echo\n$ hello-world.echo\nHello World!\n```\n"}