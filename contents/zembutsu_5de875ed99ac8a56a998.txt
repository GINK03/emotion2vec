{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nTeraform \u306f\u3001\u30a4\u30f3\u30d5\u30e9\u306e\u30b3\u30fc\u30c9\u5316(Infrastructure as code)\u3092\u5b9f\u73fe\u3059\u3079\u304f\u3001\u30a4\u30f3\u30d5\u30e9\u306e\u69cb\u7bc9\u30fb\u5909\u66f4\u30fb\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u3092\u3001\u5b89\u5168\u304b\u3064\u52b9\u7387\u7684\u306b\u884c\u3046\u305f\u3081\u306e\u30c4\u30fc\u30eb\u3002Vagrant\u3001Serf\u3001Consul \u7b49\u3092\u63d0\u4f9b\u3059\u308b HashiCorp \u304c\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u3067\u63d0\u4f9b\u3057\u3066\u3044\u308b\u3002\n\u672c\u7a3f\u306f\u3001Teraform \u304c\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u4e8b\u696d\u8005(provider)\u306e\uff11\u3064\u3067\u3042\u308b Amazon Web Services (AWS)\u306e\u3046\u3061\u3001EC2 \u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7(Security Groups) \u306e\u8ffd\u52a0\u30fb\u524a\u9664\u3092\u884c\u3046\u305f\u3081\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u3042\u308b\u3002\n\u672c\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u901a\u3057\u3001Terraform \u3092\u4f7f\u3063\u305f\u30a4\u30f3\u30d5\u30e9\u306e\u30b3\u30fc\u30c9\u5316\u306b\u5bfe\u3059\u308b\u7406\u89e3\u3092\u6df1\u3081\u308b\u4e8b\u3092\u76ee\u7684\u3068\u3059\u308b\u3002\n\n\u53c2\u8003\uff1aTerraform\u5165\u9580 \u65e5\u672c\u8a9e\u8a33 - Qiita\n\n\nhttp://qiita.com/zembutsu/items/84f5478701c5391df537\n\n\n\n\u306a\u304a\u3001S3 \u3092\u4f7f\u3063\u305f\u30d0\u30b1\u30c3\u30c8\u306e\u4f5c\u6210\u30fb\u524a\u9664\u3092\u884c\u3046\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u5225\u9014\u7528\u610f\u3057\u3066\u3044\u308b\u3002\u30b7\u30f3\u30d7\u30eb\u306b Terraform \u3092 AWS \u3067\u4f7f\u3046\u4e8b\u3092\u76ee\u7684\u3068\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u5229\u7528\u3092\u63a8\u5968\u3059\u308b\u3002\n\nTerraform\u3067AWS S3\u30d0\u30b1\u30c3\u30c8\u3092\u64cd\u4f5c - Qiita\n\n\nhttp://qiita.com/zembutsu/items/8a8f2b6b8d74e7b8fee5\n\n\n\n\n\u4f5c\u696d\u306e\u6d41\u308c\n\nTerraform \u306e\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u7528\u306e\u30ea\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092 Terraform \u3067\u4f5c\u6210\nAWS \u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30fb\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u78ba\u8a8d\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u5909\u66f4\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u524a\u9664\n\nTerraform \u3092\u4f7f\u3046\u306b\u3042\u305f\u308a\u3001\u65e2\u5b58\u306e\u30a4\u30f3\u30d5\u30e9\u74b0\u5883\u306b\u5bfe\u3057\u3066\u4f55\u3089\u8a2d\u5b9a\u3092\u52a0\u3048\u308b\u5fc5\u8981\u306f\u7121\u3044\u3002Terraform \u306f\u3001\u65e2\u5b58\u306e\u8a2d\u5b9a\u3092\u8aad\u307f\u8fbc\u3080\u3082\u306e\u3067\u306f\u306a\u304f\u3001\u3042\u304f\u307e\u3067\u73fe\u72b6\u306b\u5bfe\u3059\u308b\u5909\u66f4\u3057\u304b\u7ba1\u7406\u3057\u306a\u3044\u3002\n\nAWS \u3068\u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u6307\u5b9a\nTerraform \u306e\u5b9f\u884c\u6642\u3001\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b\u62e1\u5f35\u5b50 *.tf \u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u3002AWS \u306b\u63a5\u7d9a\u3059\u308b\u306b\u3042\u305f\u308a\u3001\u307e\u305a\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3068\u3001\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3092\u8a18\u8ff0\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\u3002\u30a8\u30c7\u30a3\u30bf\u7b49\u3067 vi aws_region_tokyo.tf \u30d5\u30a1\u30a4\u30eb\uff08\u4f8b\uff09\u3092\u4f5c\u6210\u3059\u308b\u3002\n\naws_region_tokyo.tf\nprovider \"aws\" {\n    access_key = \"\u81ea\u5206\u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\"\n    secret_key = \"\u81ea\u5206\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\"\n    region = \"ap-northeast-1\"\n    #region = \"us-east-1\"\n}\n\n\nprovider \u306f Teraform \u304c\u53d6\u308a\u6271\u3046\u3053\u3068\u306e\u3067\u304d\u308b\u30b5\u30fc\u30d3\u30b9\u63d0\u4f9b\u8005\uff08\u4e8b\u696d\u8005\uff09\uff1d\u30d7\u30ed\u30d0\u30a4\u30c0\u306e\u6307\u5b9a\u3067\u3042\u308b\u3002provider \"aws\" \u3068\u306f\u3001\u4e8b\u696d\u8005\u3068\u3057\u3066\u306e AWS \u3092\u4f7f\u3046\u4e8b\u3092\u660e\u793a\u3057\u3066\u3044\u308b\u3002`version 0.1.0 \u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u306e\u306f\u3001AWS\u3001CloudFlare\u3001Consul\u3001DigialOcean\u3001DNSimple\u3001Heroku \u3067\u3042\u308b\u3002\u3053\u308c\u3089\u306f\u30d7\u30e9\u30b0\u30a4\u30f3\u5f62\u5f0f\u3067\u62e1\u5f35\u53ef\u80fd\u3067\u3042\u308a\u3001IRC \u3084 issue \u3067\u306f\u3001OpenStack \u3084 VMware \u5bfe\u5fdc\u304c\u8b70\u8ad6\u3055\u308c\u3066\u3044\u308b \u3002\n\u306a\u304a\u3001\u3053\u3053\u3067\u306f\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3(ap-northeast-1)\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u3001region \u306e\u6307\u5b9a\u306f ap-northeast-1 \u3068\u3057\u305f\u3002\u3053\u3053\u306f\u4efb\u610f\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u308b\u306e\u3067\u3001us-east-1 \u7b49\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\u306a\u304a\u3001# \u3092\u4ed8\u3051\u308b\u3068\u30b3\u30e1\u30f3\u30c8\u6271\u3044\u3068\u306a\u308b\u3002\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\u6b21\u306b aws_security_group.tf \u306a\u3069\u3001\u62e1\u5f35\u5b50\u304c .tf \u3067 Terraform \u304c\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3068\u8b58\u5225\u3067\u304d\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\naws_security_group.tf\nresource \"aws_security_group\" \"allow_all\" {\n    name = \"allow_all\"\n    ingress {\n        from_port = 0\n        to_port = 65535\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    description = \"full open ><;\"\n}\n\n\n\u3053\u308c\u306f\u3001resource\u30ea\u30bd\u30fc\u30b9\u3068\u3057\u3066\u3001aws_security_group(EC2\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7)\u3092\u6307\u5b9a\u3057\u3001\u30ea\u30bd\u30fc\u30b9\u540d\u79f0\u304c allow_all\u3067\u3042\u308b\u4e8b\u3092\u793a\u3059\u3002\u305d\u3057\u3066\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3042\u308b\u3002\n\n\nname = AWS \u4e0a\u306e\u5b9f\u969b\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u540d\u79f0\n\ningress = inbound \u5074\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u6307\u5b9a\n\n\n\nfrom_port = \u958b\u59cb\u30dd\u30fc\u30c8\n\nto_port = \u7d42\u4e86\u30dd\u30fc\u30c8\n\nprotocol = \u30d7\u30ed\u30c8\u30b3\u30eb\n\ncidr_blocks = \u8a31\u53ef\u3059\u308b CIDR\n\n\n\ndescription = \u8aac\u660e\u5206\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001Terraform \u3092\u5b9f\u884c\u3059\u308b\u306e\u306b\u5fc5\u8981\u306a\u306e\u306f\u3001provider (\u30d7\u30ed\u30d0\u30a4\u30c0) \u3068 resoruce (\u30ea\u30bd\u30fc\u30b9)\u306e\u6307\u5b9a\u3067\u3042\u308b\u3002\u3053\u3053\u3067\u306f\u3001AWS \u3068\u3044\u3046\u30d7\u30ed\u30d0\u30a4\u30c0\u3068\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u306e\u5404\u30ea\u30bd\u30fc\u30b9\u3092\u6307\u5b9a\u3057\u305f\u3002\n\nTerraform \u306e build \u3067\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\n\nplan (\u8a08\u753b)\n\u6b21\u306b\u3001\u5b9f\u969b\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3059\u308b\u3002Terraform \u3067\u306f\u3001\u5b9f\u884c\uff08\u30a4\u30f3\u30d5\u30e9\u306b\u5bfe\u3059\u308b\u9069\u7528 apply ) \u306e\u524d\u306b\u3001\u8a08\u753b plan \u3092\u884c\u3044\u3001\u5909\u66f4\u5185\u5bb9\u3092\u78ba\u8a8d\u3059\u308b\u4e8b\u304c\u3067\u304d\u308b\uff08plan \u3092\u884c\u308f\u305a apply \u3092\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3060\u304c\u3001\u4f5c\u696d\u524d\u306e\u78ba\u8a8d\u3068\u3044\u3046\u610f\u5473\u3067\u306f\u3001 plan \u3092\u5b9f\u884c\u3059\u3079\u304d\u3060\u308d\u3046\uff09\u3002\n\u5148\u306e aws_region_tokyo.tf \u3068 aws_security_group.tf \u304c\u5c55\u958b\u3055\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u3001\u30b3\u30de\u30f3\u30c9 terraform plan\u3092\u5b9f\u884c\u3059\u308b\u3002\n$ ./terraform plan\nRefreshing Terraform state prior to plan...\n\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n+ aws_security_group.allow_all\n    description:             \"\" => \"full open ><;\"\n    ingress.#:               \"\" => \"1\"\n    ingress.0.cidr_blocks.#: \"\" => \"1\"\n    ingress.0.cidr_blocks.0: \"\" => \"0.0.0.0/0\"\n    ingress.0.from_port:     \"\" => \"0\"\n    ingress.0.protocol:      \"\" => \"tcp\"\n    ingress.0.to_port:       \"\" => \"65535\"\n    name:                    \"\" => \"allow_all\"\n    owner_id:                \"\" => \"<computed>\"\n    vpc_id:                  \"\" => \"<computed>\"\n\n\u5b9f\u884c\u3059\u308b\u3068 + (\u30ea\u30bd\u30fc\u30b9\u306e\u8ffd\u52a0) \u3068\u3057\u3066\u3001aws_security_group \u30ea\u30bd\u30fc\u30b9\u306e\u3001\u30ea\u30bd\u30fc\u30b9\u540d\u79f0 allow_all\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u4e8b\u304c\u5206\u304b\u308b\u3002\u3053\u306e\u6bb5\u968e\u3067\u306f plan \u306a\u306e\u3067\u3001\u5909\u66f4\u306e\"\u8a08\u753b\"\u3092\u610f\u5473\u3057\u3066\u304a\u308a\u3001\u5b9f\u969b\u306e\u51e6\u7406\u306f\u884c\u308f\u308c\u3066\u3044\u306a\u3044\u3002description: \u4ee5\u4e0b\u306e\u884c\u306f\u4f5c\u696d\u5185\u5bb9\u3067\u3042\u308a\u3001\"\" (\u7a7a\u767d\u306e\u9805\u76ee) => \u5909\u66f4\u5f8c\u306e\u5185\u5bb9 \u3092\u610f\u5473\u3057\u3066\u3044\u308b\u3002\u4eca\u56de\u306f\u521d\u56de\u5b9f\u884c\u6642\u306a\u306e\u3067\u3001\"\" => \"\u65b0\u898f\u9805\u76ee\" \u304c\u4e26\u3093\u3067\u3044\u308b\u3002\n\u306a\u304a\u3001\u7e70\u308a\u8fd4\u3057\u3068\u306a\u308b\u304c\u3001Terraform \u304c\u6307\u5b9a\u3059\u308b\u306e\u306f\u300c\u5909\u66f4\u3092\u884c\u3044\u305f\u3044\u5185\u5bb9\u300d\u3060\u3051\u3067\u3042\u308b\u3002\u305d\u306e\u305f\u3081\u3001\u65e2\u5b58\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u53d6\u308a\u8fbc\u307f\u4f5c\u696d\u3084\u3001\u65e2\u5b58\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u5b9a\u7fa9\u3092\u884c\u3046\u5fc5\u8981\u306f\u306a\u3044\u3002\n\napply (\u9069\u7528)\n\u5909\u66f4\u5185\u5bb9\u304c\u60f3\u5b9a\u901a\u308a\u3067\u3042\u308c\u3070\u3001terraform apply \u3092\u5b9f\u884c\u3057\u3066\u8a2d\u5b9a\u3092\u9069\u7528\u3059\u308b\u3002\u306a\u304a\u3001\u30b3\u30de\u30f3\u30c9\u3092\u5165\u529b\u3057\u305f\u77ac\u9593\u3001\u5373\u5ea7\u306b\u51e6\u7406\u304c\u9032\u884c\u3059\u308b\u3002\u4ee5\u4e0b\u306f allow_all \u3068\u3044\u3046\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210(apply)\u3057\u3066\u3044\u308b\u4f8b\u3067\u3042\u308b\u3002\naws_security_group.allow_all: Creating...\n  description:             \"\" => \"full open ><;\"\n  ingress.#:               \"\" => \"1\"\n  ingress.0.cidr_blocks.#: \"\" => \"1\"\n  ingress.0.cidr_blocks.0: \"\" => \"0.0.0.0/0\"\n  ingress.0.from_port:     \"\" => \"0\"\n  ingress.0.protocol:      \"\" => \"tcp\"\n  ingress.0.to_port:       \"\" => \"65535\"\n  name:                    \"\" => \"allow_all\"\naws_security_group.allow_all: Creation complete\n\nApply complete! Resources: 1 added, 0 changed, 0 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\n\u6ce8\u76ee\u3059\u3079\u304d\u306f Apply complete! (\u9069\u7528\u5b8c\u4e86)\u3068\u30011 added \u3068\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u70b9\u3067\u3042\u308b\u3002\u3053\u3053\u3067\u306f\uff11\u3064\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002\n\u3053\u306e\u6642\u70b9\u3067\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089 AWS \u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u6307\u5b9a\u3057\u305f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u4e8b\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002EC2 Dashborad \u306e Security Gropus \u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n\u4e0a\u56f3\u3088\u3046\u306b show_all \u3068\u3044\u3046\u540d\u79f0\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\n\u307e\u305f\u3001\u30d6\u30e9\u30a6\u30b6\u306b\u30a2\u30af\u30bb\u30b9\u3057\u306a\u304f\u3066\u3082\u3001\u3069\u306e\u3088\u3046\u306a\u51e6\u7406\u3092\u9032\u884c\u3057\u305f\u304b\u306f show \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u78ba\u8a8d\u3067\u304d\u308b\u3002\n$ ./terraform show ./terraform.tfstate\naws_security_group.allow_all:\n  id = sg-e9362be8\n  description = full open ><;\n  ingress.# = 1\n  ingress.0.cidr_blocks.# = 1\n  ingress.0.cidr_blocks.0 = 0.0.0.0/0\n  ingress.0.from_port = 0\n  ingress.0.protocol = tcp\n  ingress.0.to_port = 65535\n  name = allow_all\n  owner_id = 091177877630\n  vpc_id =\n\n\u3053\u3053\u3067\u3001owner_id \u306a\u3069\u3001\u5148\u307b\u3069\u306f \"<computed>\" \u3068\u306a\u3063\u3066\u3044\u305f\u5834\u6240\u306b\u5177\u4f53\u7684\u306a\u6570\u5024\u304c\u5165\u3063\u3066\u3044\u308b\u4e8b\u304c\u5206\u304b\u308b\u3002\u3053\u308c\u304c EC2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\u3067\u3042\u308c\u3070\u3001IP \u30a2\u30c9\u30ec\u30b9\u306a\u3069\u3001\u52d5\u7684\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u308b\u60c5\u5831\u304c\u53cd\u6620\u3055\u308c\u308b\u306e\u3067\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u5f8c\u306b\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\u3059\u308b\u624b\u9806\u3092\u7701\u304f\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\n\n\u30ea\u30bd\u30fc\u30b9(\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7)\u306e\u524a\u9664\n\u30ea\u30bd\u30fc\u30b9\u3092\u524a\u9664\u3059\u308b\u306b\u306f\uff12\u3064\u306e\u65b9\u6cd5\u304c\u3042\u308b\u3002aws_security_group.tf.tf \u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6d88\u3059\u304b\u3001aws_security_group.tf.tf \u306e\u5185\u5bb9\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u3067\u3042\u308b\u3002\n\u3053\u3053\u3067\u306f\u3001aws_security_group.tf.tf \u3092 aws_security_group.tf.bakup \u3068\u540d\u79f0\u5909\u66f4\u3059\u308b\u3002terraform \u304c\u8a8d\u8b58\u3067\u304d\u308b\u306e\u306f\u3001aws_region_tokyo.tf \u306e\u307f\u3068\u306a\u308a\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306b\u5bfe\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u60c5\u5831\u306f\uff08Terraform \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4e0a\uff09\u5b58\u5728\u3057\u306a\u304f\u306a\u308b\u3002\n$ mv aws_security_group.tf aws_security_group.tf.bakup\n\n\u3053\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u306f\u3001terraform plan \u3092\u5b9f\u884c\u3059\u308b\u3002\n$ ./terraform plan\nRefreshing Terraform state prior to plan...\n\naws_security_group.allow_all: Refreshing state... (ID: sg-e9362be8)\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n- aws_security_group.allow_all\n\n\n\u3053\u308c\u306f\u3001\u73fe\u5728\u306e AWS \u4e0a\u306e\u30ea\u30bd\u30fc\u30b9\u3068\u3001\u624b\u5143\u306e terraform \u304c\u51e6\u7406\u3057\u305f\u5185\u5bb9\u3092\u6bd4\u8f03\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u5dee\u5206\u3068\u3057\u3066 aws_security_group.allow_all \u3068\u3044\u3046\u30ea\u30bd\u30fc\u30b9\u3092 - (\u524a\u9664) \u3059\u308b\u4e8b\u3092\u610f\u5473\u3057\u3066\u3044\u308b\uff08\u5b9f\u969b\u306b\u306f\u3001\u8907\u6570\u306e\u30ea\u30bd\u30fc\u30b9\u306e\u8ffd\u52a0\u30fb\u524a\u9664\u3092\u540c\u6642\u306b\u884c\u3046\u4e8b\u304c\u3067\u304d\u308b\u3002\u307e\u305f\u51e6\u7406\u306e\u512a\u5148\u4ed8\u3051\u3092\u884c\u3046\u4e8b\u3082\u53ef\u80fd\u3002\u8a73\u3057\u304f\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u53c2\u7167\uff09\u3002\n\u30ea\u30bd\u30fc\u30b9\u524a\u9664\u3092\u9069\u7528\u3059\u308b\u306b\u306f terraform apply \u3092\u5b9f\u884c\u3059\u308b\u3002\naws_security_group.allow_all: Refreshing state... (ID: sg-e9362be8)\naws_security_group.allow_all: Destroying...\naws_security_group.allow_all: Destruction complete\n\nApply complete! Resources: 0 added, 0 changed, 1 destroyed.\n\n\u3053\u306e\u3088\u3046\u306b 1 destroyed \u3068\u8868\u793a\u3055\u308c\u3001\u5bfe\u8c61\u30ea\u30bd\u30fc\u30b9\u3001\u4eca\u56de\u306e\u4f8b\u3067\u306f\uff11\u3064\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u7834\u68c4\u3055\u308c\u305f\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\u3053\u3053\u3067\u518d\u3073\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30fb\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u5bfe\u8c61\u3068\u306a\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u524a\u9664\u3055\u308c\u3066\u3044\u308b\u4e8b\u304c\u308f\u304b\u308b\u3002\n\u3042\u308b\u3044\u306f\u3001show \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u3082\u3001\u540c\u69d8\u306b\u30ea\u30bd\u30fc\u30b9\u304c\u5b58\u5728\u3057\u3066\u3044\u306a\u3044\u4e8b\u304c\u78ba\u8a8d\u51fa\u6765\u308b\u3002\n$ ./terraform show ./terraform.tfstate\nThe state file is empty. No resources are represented.\n\n\n\u30ea\u30bd\u30fc\u30b9\u306e\u518d\u8a2d\u5b9a\u3068\u5909\u66f4\n\u30ea\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308c\u3070\u3001\u4ed6\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u3063\u305f\u308a\u3001\u3042\u308b\u3044\u306f\u5225\u306e AWS \u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u3082\u3001\u540c\u69d8\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u8ffd\u52a0\u51fa\u6765\u308b\u3002\u8a2d\u5b9a\u3092\u5fa9\u65e7\u3055\u305b\u308b\u306b\u306f\u3001\u5148\u307b\u3069\u540d\u79f0\u5909\u66f4\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u5143\u306b\u5dee\u3057\u623b\u3059\u3002\n$ mv aws_security_group.tf.bakup aws_security_group.tf\n\n\u305d\u308c\u304b\u3089 plan apply \u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u518d\u3073\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u8a2d\u5b9a\u304c\u5fa9\u5e30\u3057\u3066\u3044\u308b\u3002\u3053\u306e\u60c5\u5831\u306f AWS \u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3082\u78ba\u8a8d\u51fa\u6765\u308b\u3002\n$ ./terraform plan\n$ ./terraform apply\n\n\u3053\u306e\u3088\u3046\u306b Terraform \u3092\u4f7f\u3048\u3070\u3001\u8a2d\u5b9a\u306e\u9069\u7528\u30fb\u5909\u66f4\u304c\u7c21\u5358\u306b\u884c\u3048\u308b\u3002\u307e\u305f\u672c\u756a\u74b0\u5883\u3067\u5b9f\u884c\u3059\u308b\u524d\u306b\u3001\u30c6\u30b9\u30c8\u74b0\u5883\u3067\u306e\u9069\u7528\u8a66\u9a13\u3082\u3001\u6bd4\u8f03\u7684\u7c21\u5358\u306b\u884c\u3048\u308b\u3068\u8a00\u3048\u308b\u3060\u308d\u3046\u3002\n\u6b21\u306b\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u8a2d\u5b9a\u5909\u66f4\u3092\u8a66\u307f\u308b\u3002\u73fe\u5728\u306e\u30dd\u30ea\u30b7\u30fc\u306f\u5168\u3066\u306e\u30dd\u30fc\u30c8\u3092\u89e3\u653e\u3059\u308b\u3082\u306e\u3067\u3042\u308a\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u304c\u61f8\u5ff5\u3055\u308c\u308b\u3002\n\u3053\u308c\u3092 SSH (TCP:22) \u3068 HTTP (TCP:80) \u306e\u307f\u306b\u5909\u66f4\u3059\u308b\u3002aws_security_group.tf \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\naws_security_group.tf\nresource \"aws_security_group\" \"allow_all\" {\n    name = \"allow_ssh_and_tcp\"\n    ingress {\n        from_port = 22\n        to_port = 22\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    ingress {\n        from_port = 80\n        to_port = 80\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    description = \"allow tcp 22 and 80\"\n}\n\n\n\u5bfe\u8c61\u3068\u306a\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u540d\u306f allow_all \u306e\u307e\u307e\u3060\u304c\u3001ingress \u3068\u3044\u3046 inbound \u5074\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u66f8\u304d\u63db\u3048\u3066\u3044\u308b\u3002\u307e\u305f\u3001\u30b0\u30eb\u30fc\u30d7\u540d\u79f0 name \u3092\u66f8\u304d\u63db\u3048\u308b\u3068\u3001terraform \u306f\u30ea\u30bd\u30fc\u30b9\u306b\u5bfe\u3059\u308b\u66f4\u65b0\u3092\u884c\u3046\u306e\u3067\u306f\u306a\u304f\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u524a\u9664\u30fb\u518d\u8ffd\u52a0\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3002\nTerraform \u3067\u8a2d\u5b9a\u3092\u9069\u7528\u3059\u308b\u524d\u306b\u3001\u4f8b\u306b\u3088\u3063\u3066 terraform plan \u30b3\u30de\u30f3\u30c9\u3067\u3001\u5909\u66f4\u5185\u5bb9\u3092\u4e8b\u524d\u78ba\u8a8d\u3059\u308b\u3002\n$ ./terraform plan\nRefreshing Terraform state prior to plan...\n\naws_security_group.allow_all: Refreshing state... (ID: sg-25302d24)\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n-/+ aws_security_group.allow_all\n    description:             \"full open ><;\" => \"allow tcp 22 and 80\"\n    ingress.#:               \"1\" => \"2\"\n    ingress.0.from_port:     \"0\" => \"22\"\n    ingress.0.to_port:       \"65535\" => \"22\"\n    ingress.1.cidr_blocks.#: \"\" => \"1\"\n    ingress.1.cidr_blocks.0: \"\" => \"0.0.0.0/0\"\n    ingress.1.from_port:     \"\" => \"80\"\n    ingress.1.protocol:      \"\" => \"tcp\"\n    ingress.1.to_port:       \"\" => \"80\"\n    name:                    \"allow_all\" => \"allow_ssh_and_http\" (forces new resource)\n    owner_id:                \"091177877630\" => \"<computed>\"\n    vpc_id:                  \"\" => \"<computed>\"\n\n\u4eca\u5ea6\u306f\u3001Terraform \u306e\u30ea\u30bd\u30fc\u30b9aws_security_group.allow_all \u306b\u5bfe\u3057\u3001 -(\u524a\u9664) \u3068 +(\u8ffd\u52a0) \u3092\u8a08\u753b\u3057\u3066\u3044\u308b\u5909\u66f4\u3092\u884c\u304a\u3046\u3068\u3059\u308b\u3068\u3001(force new resource) \u3068\u8868\u793a\u3055\u308c\u3001\u5bfe\u8c61\u30ea\u30bd\u30fc\u30b9\u306b\u5bfe\u3059\u308b\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3046\u306e\u3067\u306f\u306a\u304f\u3001Terraform \u306f\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u524a\u9664\u30fb\u8ffd\u52a0\u3092\u5b9f\u65bd\u3057\u3066\u3044\u308b\u3068\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3002\n\u5185\u5bb9\u306b\u554f\u984c\u304c\u7121\u3051\u308c\u3070\u3001\u5b9f\u969b\u306b\u8a2d\u5b9a\u3092\u53cd\u6620(apply)\u3059\u308b\u3002\n$ ./terraform apply\naws_security_group.allow_all: Refreshing state... (ID: sg-25302d24)\naws_security_group.allow_all: Destroying...\naws_security_group.allow_all: Destruction complete\naws_security_group.allow_all: Modifying...\n  description:             \"full open ><;\" => \"allow tcp 22 and 80\"\n  ingress.#:               \"1\" => \"2\"\n  ingress.0.from_port:     \"0\" => \"22\"\n  ingress.0.to_port:       \"65535\" => \"22\"\n  ingress.1.cidr_blocks.#: \"\" => \"1\"\n  ingress.1.cidr_blocks.0: \"\" => \"0.0.0.0/0\"\n  ingress.1.from_port:     \"\" => \"80\"\n  ingress.1.protocol:      \"\" => \"tcp\"\n  ingress.1.to_port:       \"\" => \"80\"\n  name:                    \"allow_all\" => \"allow_ssh_and_http\"\naws_security_group.allow_all: Modifications complete\n\nApply complete! Resources: 0 added, 1 changed, 1 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\nState path: terraform.tfstate\n\n\u3053\u308c\u3067\u30d6\u30e9\u30a6\u30b6\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u53e4\u3044\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306f\u524a\u9664\u3055\u308c\u3001\u65b0\u305f\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n\u307e\u305f\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3067\u78ba\u8a8d\u3067\u304d\u308b\u5909\u66f4\u5185\u5bb9\u3084\u3001Group ID \u306f\u3001terraform show \u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u304c\u53ef\u80fd\u3067\u3042\u308b\u3002\n$ ./terraform show ./terraform.tfstate\naws_security_group.allow_all:\n  id = sg-c3302dc2\n  description = allow tcp 22 and 80\n  ingress.# = 2\n  ingress.0.cidr_blocks.# = 1\n  ingress.0.cidr_blocks.0 = 0.0.0.0/0\n  ingress.0.from_port = 22\n  ingress.0.protocol = tcp\n  ingress.0.to_port = 22\n  ingress.1.cidr_blocks.# = 1\n  ingress.1.cidr_blocks.0 = 0.0.0.0/0\n  ingress.1.from_port = 80\n  ingress.1.protocol = tcp\n  ingress.1.to_port = 80\n  name = allow_ssh_and_http\n  owner_id = 091177877630\n  vpc_id =\n\n\u306a\u304a\u3001Terraform \u306e\u6a5f\u80fd\u3068\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u66f4\u65b0\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3002\u3057\u304b\u3057\u3001\u73fe\u6642\u70b9\u306e AWS \u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u306f\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u30ea\u30bd\u30fc\u30b9\u5909\u66f4\uff08inbound\u30eb\u30fc\u30eb\u306e\u5909\u66f4\uff09\u306b\u306f\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u3002\n\n\u88dc\u8db3\nTeffarom \u304c\u884c\u3046\u306e\u306f\u3001\u3042\u304f\u307e\u3067\u30a4\u30f3\u30d5\u30e9\u306b\u95a2\u3059\u308b\u5b9a\u7fa9\u3068\u51e6\u7406\u3067\u3042\u308a\u3001\u9ad8\u5ea6\u306a\u64cd\u4f5c\u3092\u884c\u3046\u4e8b\u304c\u3067\u304d\u306a\u3044\u3002\u305d\u306e\u3088\u3046\u306a\u51e6\u7406\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u3001CLI \u3084 API \u4f7f\u3063\u305f\u64cd\u4f5c\u3092\u63a8\u5968\u3059\u308b\u3002\u52a0\u3048\u3066\u3001\u73fe\u6642\u70b9\u306f\u958b\u767a\u4e2d\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u305f\u3081\u3001\u672a\u5b9f\u88c5\u306e\u9805\u76ee\u3082\u591a\u304f\u3001\u5168\u3066\u306e\u4f5c\u696d\u3092 Terrafrom \u304c\u884c\u3048\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u3002\u305d\u308c\u3067\u3082\u3001\u74b0\u5883\u69cb\u7bc9\u3084\u30c6\u30b9\u30c8\u306b\u304a\u3044\u3066\u3001Terraform \u3092\u4f7f\u3048\u308b\u5834\u6240\u304c\u3042\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u308f\u308c\u308b\u3002\n\n\u53c2\u8003\n\n\nProvider: AWS - Terraform\n\nhttp://www.terraform.io/docs/providers/aws/index.html\n\n\n\nAWS: aws_security_group - Terraform\n\nhttp://www.terraform.io/docs/providers/aws/r/security_group.html\n\n\n\n# \u6982\u8981\n[Teraform](http://terraform.io/) \u306f\u3001\u30a4\u30f3\u30d5\u30e9\u306e\u30b3\u30fc\u30c9\u5316(Infrastructure as code)\u3092\u5b9f\u73fe\u3059\u3079\u304f\u3001\u30a4\u30f3\u30d5\u30e9\u306e\u69cb\u7bc9\u30fb\u5909\u66f4\u30fb\u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\u3092\u3001\u5b89\u5168\u304b\u3064\u52b9\u7387\u7684\u306b\u884c\u3046\u305f\u3081\u306e\u30c4\u30fc\u30eb\u3002Vagrant\u3001Serf\u3001Consul \u7b49\u3092\u63d0\u4f9b\u3059\u308b [HashiCorp](http://www.hashicorp.com/) \u304c\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u3067\u63d0\u4f9b\u3057\u3066\u3044\u308b\u3002\n\n\u672c\u7a3f\u306f\u3001Teraform \u304c\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u4e8b\u696d\u8005(provider)\u306e\uff11\u3064\u3067\u3042\u308b Amazon Web Services (AWS)\u306e\u3046\u3061\u3001EC2 \u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7(Security Groups) \u306e\u8ffd\u52a0\u30fb\u524a\u9664\u3092\u884c\u3046\u305f\u3081\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u3042\u308b\u3002\n\n\u672c\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u901a\u3057\u3001Terraform \u3092\u4f7f\u3063\u305f\u30a4\u30f3\u30d5\u30e9\u306e\u30b3\u30fc\u30c9\u5316\u306b\u5bfe\u3059\u308b\u7406\u89e3\u3092\u6df1\u3081\u308b\u4e8b\u3092\u76ee\u7684\u3068\u3059\u308b\u3002\n\n* \u53c2\u8003\uff1aTerraform\u5165\u9580 \u65e5\u672c\u8a9e\u8a33 - Qiita\n * http://qiita.com/zembutsu/items/84f5478701c5391df537\n\n\u306a\u304a\u3001S3 \u3092\u4f7f\u3063\u305f\u30d0\u30b1\u30c3\u30c8\u306e\u4f5c\u6210\u30fb\u524a\u9664\u3092\u884c\u3046\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u5225\u9014\u7528\u610f\u3057\u3066\u3044\u308b\u3002\u30b7\u30f3\u30d7\u30eb\u306b Terraform \u3092 AWS \u3067\u4f7f\u3046\u4e8b\u3092\u76ee\u7684\u3068\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u5229\u7528\u3092\u63a8\u5968\u3059\u308b\u3002\n\n* Terraform\u3067AWS S3\u30d0\u30b1\u30c3\u30c8\u3092\u64cd\u4f5c - Qiita\n * http://qiita.com/zembutsu/items/8a8f2b6b8d74e7b8fee5\n\n## \u4f5c\u696d\u306e\u6d41\u308c\n\n* Terraform \u306e\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u7528\u306e\u30ea\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n* \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092 Terraform \u3067\u4f5c\u6210\n* AWS \u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30fb\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u78ba\u8a8d\n* \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u5909\u66f4\n* \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u524a\u9664\n\nTerraform \u3092\u4f7f\u3046\u306b\u3042\u305f\u308a\u3001\u65e2\u5b58\u306e\u30a4\u30f3\u30d5\u30e9\u74b0\u5883\u306b\u5bfe\u3057\u3066\u4f55\u3089\u8a2d\u5b9a\u3092\u52a0\u3048\u308b\u5fc5\u8981\u306f\u7121\u3044\u3002Terraform \u306f\u3001\u65e2\u5b58\u306e\u8a2d\u5b9a\u3092\u8aad\u307f\u8fbc\u3080\u3082\u306e\u3067\u306f\u306a\u304f\u3001\u3042\u304f\u307e\u3067\u73fe\u72b6\u306b\u5bfe\u3059\u308b\u5909\u66f4\u3057\u304b\u7ba1\u7406\u3057\u306a\u3044\u3002\n\n### AWS \u3068\u30ea\u30fc\u30b8\u30e7\u30f3\u306e\u6307\u5b9a\n\nTerraform \u306e\u5b9f\u884c\u6642\u3001\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308b\u62e1\u5f35\u5b50 `*.tf` \u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u3002AWS \u306b\u63a5\u7d9a\u3059\u308b\u306b\u3042\u305f\u308a\u3001\u307e\u305a\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3068\u3001\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\u3092\u8a18\u8ff0\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\u3002\u30a8\u30c7\u30a3\u30bf\u7b49\u3067 `vi aws_region_tokyo.tf` \u30d5\u30a1\u30a4\u30eb\uff08\u4f8b\uff09\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```file:aws_region_tokyo.tf\nprovider \"aws\" {\n    access_key = \"\u81ea\u5206\u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\"\n    secret_key = \"\u81ea\u5206\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\"\n    region = \"ap-northeast-1\"\n    #region = \"us-east-1\"\n}\n```\n\n`provider` \u306f Teraform \u304c\u53d6\u308a\u6271\u3046\u3053\u3068\u306e\u3067\u304d\u308b\u30b5\u30fc\u30d3\u30b9\u63d0\u4f9b\u8005\uff08\u4e8b\u696d\u8005\uff09\uff1d\u30d7\u30ed\u30d0\u30a4\u30c0\u306e\u6307\u5b9a\u3067\u3042\u308b\u3002`provider \"aws\"` \u3068\u306f\u3001\u4e8b\u696d\u8005\u3068\u3057\u3066\u306e AWS \u3092\u4f7f\u3046\u4e8b\u3092\u660e\u793a\u3057\u3066\u3044\u308b\u3002`version 0.1.0 \u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u306e\u306f\u3001AWS\u3001CloudFlare\u3001Consul\u3001DigialOcean\u3001DNSimple\u3001Heroku \u3067\u3042\u308b\u3002\u3053\u308c\u3089\u306f\u30d7\u30e9\u30b0\u30a4\u30f3\u5f62\u5f0f\u3067\u62e1\u5f35\u53ef\u80fd\u3067\u3042\u308a\u3001IRC \u3084 issue \u3067\u306f\u3001OpenStack \u3084 VMware \u5bfe\u5fdc\u304c\u8b70\u8ad6\u3055\u308c\u3066\u3044\u308b \u3002\n\n\u306a\u304a\u3001\u3053\u3053\u3067\u306f\u6771\u4eac\u30ea\u30fc\u30b8\u30e7\u30f3(ap-northeast-1)\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u3001`region` \u306e\u6307\u5b9a\u306f `ap-northeast-1` \u3068\u3057\u305f\u3002\u3053\u3053\u306f\u4efb\u610f\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u308b\u306e\u3067\u3001`us-east-1` \u7b49\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\u306a\u304a\u3001`#` \u3092\u4ed8\u3051\u308b\u3068\u30b3\u30e1\u30f3\u30c8\u6271\u3044\u3068\u306a\u308b\u3002\n\n## \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\n\u6b21\u306b `aws_security_group.tf` \u306a\u3069\u3001\u62e1\u5f35\u5b50\u304c `.tf` \u3067 Terraform \u304c\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3068\u8b58\u5225\u3067\u304d\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```file:aws_security_group.tf\nresource \"aws_security_group\" \"allow_all\" {\n    name = \"allow_all\"\n    ingress {\n        from_port = 0\n        to_port = 65535\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    description = \"full open ><;\"\n}\n```\n\n\u3053\u308c\u306f\u3001`resource`\u30ea\u30bd\u30fc\u30b9\u3068\u3057\u3066\u3001`aws_security_group`(EC2\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7)\u3092\u6307\u5b9a\u3057\u3001\u30ea\u30bd\u30fc\u30b9\u540d\u79f0\u304c `allow_all`\u3067\u3042\u308b\u4e8b\u3092\u793a\u3059\u3002\u305d\u3057\u3066\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3042\u308b\u3002\n\n * `name` = AWS \u4e0a\u306e\u5b9f\u969b\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u540d\u79f0\n * `ingress` = inbound \u5074\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u6307\u5b9a\n  * `from_port` = \u958b\u59cb\u30dd\u30fc\u30c8\n  * `to_port` = \u7d42\u4e86\u30dd\u30fc\u30c8\n  * `protocol` = \u30d7\u30ed\u30c8\u30b3\u30eb\n  * `cidr_blocks` = \u8a31\u53ef\u3059\u308b CIDR\n * `description` = \u8aac\u660e\u5206\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001Terraform \u3092\u5b9f\u884c\u3059\u308b\u306e\u306b\u5fc5\u8981\u306a\u306e\u306f\u3001`provider` (\u30d7\u30ed\u30d0\u30a4\u30c0) \u3068 `resoruce` (\u30ea\u30bd\u30fc\u30b9)\u306e\u6307\u5b9a\u3067\u3042\u308b\u3002\u3053\u3053\u3067\u306f\u3001AWS \u3068\u3044\u3046\u30d7\u30ed\u30d0\u30a4\u30c0\u3068\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u306e\u5404\u30ea\u30bd\u30fc\u30b9\u3092\u6307\u5b9a\u3057\u305f\u3002\n\n## Terraform \u306e build \u3067\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u4f5c\u6210\n\n### plan (\u8a08\u753b)\n\n\u6b21\u306b\u3001\u5b9f\u969b\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210\u3059\u308b\u3002Terraform \u3067\u306f\u3001\u5b9f\u884c\uff08\u30a4\u30f3\u30d5\u30e9\u306b\u5bfe\u3059\u308b\u9069\u7528 `apply` ) \u306e\u524d\u306b\u3001\u8a08\u753b `plan` \u3092\u884c\u3044\u3001\u5909\u66f4\u5185\u5bb9\u3092\u78ba\u8a8d\u3059\u308b\u4e8b\u304c\u3067\u304d\u308b\uff08`plan` \u3092\u884c\u308f\u305a `apply` \u3092\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3060\u304c\u3001\u4f5c\u696d\u524d\u306e\u78ba\u8a8d\u3068\u3044\u3046\u610f\u5473\u3067\u306f\u3001 `plan` \u3092\u5b9f\u884c\u3059\u3079\u304d\u3060\u308d\u3046\uff09\u3002\n\n\u5148\u306e `aws_region_tokyo.tf` \u3068 `aws_security_group.tf` \u304c\u5c55\u958b\u3055\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u3001\u30b3\u30de\u30f3\u30c9 `terraform plan`\u3092\u5b9f\u884c\u3059\u308b\u3002\n\n```\n$ ./terraform plan\nRefreshing Terraform state prior to plan...\n\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n+ aws_security_group.allow_all\n    description:             \"\" => \"full open ><;\"\n    ingress.#:               \"\" => \"1\"\n    ingress.0.cidr_blocks.#: \"\" => \"1\"\n    ingress.0.cidr_blocks.0: \"\" => \"0.0.0.0/0\"\n    ingress.0.from_port:     \"\" => \"0\"\n    ingress.0.protocol:      \"\" => \"tcp\"\n    ingress.0.to_port:       \"\" => \"65535\"\n    name:                    \"\" => \"allow_all\"\n    owner_id:                \"\" => \"<computed>\"\n    vpc_id:                  \"\" => \"<computed>\"\n```\n\n\u5b9f\u884c\u3059\u308b\u3068 `+` (\u30ea\u30bd\u30fc\u30b9\u306e\u8ffd\u52a0) \u3068\u3057\u3066\u3001`aws_security_group` \u30ea\u30bd\u30fc\u30b9\u306e\u3001\u30ea\u30bd\u30fc\u30b9\u540d\u79f0 `allow_all`\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u4e8b\u304c\u5206\u304b\u308b\u3002\u3053\u306e\u6bb5\u968e\u3067\u306f `plan` \u306a\u306e\u3067\u3001\u5909\u66f4\u306e\"\u8a08\u753b\"\u3092\u610f\u5473\u3057\u3066\u304a\u308a\u3001\u5b9f\u969b\u306e\u51e6\u7406\u306f\u884c\u308f\u308c\u3066\u3044\u306a\u3044\u3002`description:` \u4ee5\u4e0b\u306e\u884c\u306f\u4f5c\u696d\u5185\u5bb9\u3067\u3042\u308a\u3001`\"\"` (\u7a7a\u767d\u306e\u9805\u76ee) => `\u5909\u66f4\u5f8c\u306e\u5185\u5bb9` \u3092\u610f\u5473\u3057\u3066\u3044\u308b\u3002\u4eca\u56de\u306f\u521d\u56de\u5b9f\u884c\u6642\u306a\u306e\u3067\u3001`\"\" => \"\u65b0\u898f\u9805\u76ee\"` \u304c\u4e26\u3093\u3067\u3044\u308b\u3002\n\n\u306a\u304a\u3001\u7e70\u308a\u8fd4\u3057\u3068\u306a\u308b\u304c\u3001Terraform \u304c\u6307\u5b9a\u3059\u308b\u306e\u306f\u300c\u5909\u66f4\u3092\u884c\u3044\u305f\u3044\u5185\u5bb9\u300d\u3060\u3051\u3067\u3042\u308b\u3002\u305d\u306e\u305f\u3081\u3001\u65e2\u5b58\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u53d6\u308a\u8fbc\u307f\u4f5c\u696d\u3084\u3001\u65e2\u5b58\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u5b9a\u7fa9\u3092\u884c\u3046\u5fc5\u8981\u306f\u306a\u3044\u3002\n\n### apply (\u9069\u7528)\n\n\u5909\u66f4\u5185\u5bb9\u304c\u60f3\u5b9a\u901a\u308a\u3067\u3042\u308c\u3070\u3001`terraform apply` \u3092\u5b9f\u884c\u3057\u3066\u8a2d\u5b9a\u3092\u9069\u7528\u3059\u308b\u3002\u306a\u304a\u3001\u30b3\u30de\u30f3\u30c9\u3092\u5165\u529b\u3057\u305f\u77ac\u9593\u3001\u5373\u5ea7\u306b\u51e6\u7406\u304c\u9032\u884c\u3059\u308b\u3002\u4ee5\u4e0b\u306f `allow_all` \u3068\u3044\u3046\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u6210(apply)\u3057\u3066\u3044\u308b\u4f8b\u3067\u3042\u308b\u3002\n\n```\naws_security_group.allow_all: Creating...\n  description:             \"\" => \"full open ><;\"\n  ingress.#:               \"\" => \"1\"\n  ingress.0.cidr_blocks.#: \"\" => \"1\"\n  ingress.0.cidr_blocks.0: \"\" => \"0.0.0.0/0\"\n  ingress.0.from_port:     \"\" => \"0\"\n  ingress.0.protocol:      \"\" => \"tcp\"\n  ingress.0.to_port:       \"\" => \"65535\"\n  name:                    \"\" => \"allow_all\"\naws_security_group.allow_all: Creation complete\n\nApply complete! Resources: 1 added, 0 changed, 0 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n```\n\n\u6ce8\u76ee\u3059\u3079\u304d\u306f `Apply complete!` (\u9069\u7528\u5b8c\u4e86)\u3068\u3001`1 added` \u3068\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u70b9\u3067\u3042\u308b\u3002\u3053\u3053\u3067\u306f\uff11\u3064\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002\n\n\u3053\u306e\u6642\u70b9\u3067\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089 AWS \u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u6307\u5b9a\u3057\u305f\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u4e8b\u304c\u78ba\u8a8d\u3067\u304d\u308b\u3002`EC2 Dashborad` \u306e `Security Gropus` \u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n![terraform_ec2_secutirygroup-01.png](https://qiita-image-store.s3.amazonaws.com/0/13002/f975eb91-fa2e-4c53-7331-7a3a635a9443.png)\n\n\u4e0a\u56f3\u3088\u3046\u306b `show_all` \u3068\u3044\u3046\u540d\u79f0\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\n\n\u307e\u305f\u3001\u30d6\u30e9\u30a6\u30b6\u306b\u30a2\u30af\u30bb\u30b9\u3057\u306a\u304f\u3066\u3082\u3001\u3069\u306e\u3088\u3046\u306a\u51e6\u7406\u3092\u9032\u884c\u3057\u305f\u304b\u306f `show` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n```\n$ ./terraform show ./terraform.tfstate\naws_security_group.allow_all:\n  id = sg-e9362be8\n  description = full open ><;\n  ingress.# = 1\n  ingress.0.cidr_blocks.# = 1\n  ingress.0.cidr_blocks.0 = 0.0.0.0/0\n  ingress.0.from_port = 0\n  ingress.0.protocol = tcp\n  ingress.0.to_port = 65535\n  name = allow_all\n  owner_id = 091177877630\n  vpc_id =\n```\n\n\u3053\u3053\u3067\u3001`owner_id` \u306a\u3069\u3001\u5148\u307b\u3069\u306f `\"<computed>\"` \u3068\u306a\u3063\u3066\u3044\u305f\u5834\u6240\u306b\u5177\u4f53\u7684\u306a\u6570\u5024\u304c\u5165\u3063\u3066\u3044\u308b\u4e8b\u304c\u5206\u304b\u308b\u3002\u3053\u308c\u304c `EC2` \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\u3067\u3042\u308c\u3070\u3001IP \u30a2\u30c9\u30ec\u30b9\u306a\u3069\u3001\u52d5\u7684\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u308b\u60c5\u5831\u304c\u53cd\u6620\u3055\u308c\u308b\u306e\u3067\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u5f8c\u306b\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\u3059\u308b\u624b\u9806\u3092\u7701\u304f\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\n\n### \u30ea\u30bd\u30fc\u30b9(\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7)\u306e\u524a\u9664\n\n\u30ea\u30bd\u30fc\u30b9\u3092\u524a\u9664\u3059\u308b\u306b\u306f\uff12\u3064\u306e\u65b9\u6cd5\u304c\u3042\u308b\u3002`aws_security_group.tf.tf` \u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6d88\u3059\u304b\u3001`aws_security_group.tf.tf` \u306e\u5185\u5bb9\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u3067\u3042\u308b\u3002\n\n\u3053\u3053\u3067\u306f\u3001`aws_security_group.tf.tf` \u3092 `aws_security_group.tf.bakup` \u3068\u540d\u79f0\u5909\u66f4\u3059\u308b\u3002terraform \u304c\u8a8d\u8b58\u3067\u304d\u308b\u306e\u306f\u3001`aws_region_tokyo.tf` \u306e\u307f\u3068\u306a\u308a\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306b\u5bfe\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u60c5\u5831\u306f\uff08Terraform \u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4e0a\uff09\u5b58\u5728\u3057\u306a\u304f\u306a\u308b\u3002\n\n```\n$ mv aws_security_group.tf aws_security_group.tf.bakup\n```\n\n\u3053\u306e\u72b6\u614b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306b\u306f\u3001`terraform plan` \u3092\u5b9f\u884c\u3059\u308b\u3002\n\n```\n$ ./terraform plan\nRefreshing Terraform state prior to plan...\n\naws_security_group.allow_all: Refreshing state... (ID: sg-e9362be8)\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n- aws_security_group.allow_all\n\n```\n\n\u3053\u308c\u306f\u3001\u73fe\u5728\u306e AWS \u4e0a\u306e\u30ea\u30bd\u30fc\u30b9\u3068\u3001\u624b\u5143\u306e terraform \u304c\u51e6\u7406\u3057\u305f\u5185\u5bb9\u3092\u6bd4\u8f03\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u5dee\u5206\u3068\u3057\u3066 `aws_security_group.allow_all` \u3068\u3044\u3046\u30ea\u30bd\u30fc\u30b9\u3092 `-` (\u524a\u9664) \u3059\u308b\u4e8b\u3092\u610f\u5473\u3057\u3066\u3044\u308b\uff08\u5b9f\u969b\u306b\u306f\u3001\u8907\u6570\u306e\u30ea\u30bd\u30fc\u30b9\u306e\u8ffd\u52a0\u30fb\u524a\u9664\u3092\u540c\u6642\u306b\u884c\u3046\u4e8b\u304c\u3067\u304d\u308b\u3002\u307e\u305f\u51e6\u7406\u306e\u512a\u5148\u4ed8\u3051\u3092\u884c\u3046\u4e8b\u3082\u53ef\u80fd\u3002\u8a73\u3057\u304f\u306f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u53c2\u7167\uff09\u3002\n\n\u30ea\u30bd\u30fc\u30b9\u524a\u9664\u3092\u9069\u7528\u3059\u308b\u306b\u306f `terraform apply` \u3092\u5b9f\u884c\u3059\u308b\u3002\n\n```\naws_security_group.allow_all: Refreshing state... (ID: sg-e9362be8)\naws_security_group.allow_all: Destroying...\naws_security_group.allow_all: Destruction complete\n\nApply complete! Resources: 0 added, 0 changed, 1 destroyed.\n```\n\n\u3053\u306e\u3088\u3046\u306b `1 destroyed` \u3068\u8868\u793a\u3055\u308c\u3001\u5bfe\u8c61\u30ea\u30bd\u30fc\u30b9\u3001\u4eca\u56de\u306e\u4f8b\u3067\u306f\uff11\u3064\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u7834\u68c4\u3055\u308c\u305f\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n\u3053\u3053\u3067\u518d\u3073\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30fb\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u5bfe\u8c61\u3068\u306a\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u524a\u9664\u3055\u308c\u3066\u3044\u308b\u4e8b\u304c\u308f\u304b\u308b\u3002\n\n\u3042\u308b\u3044\u306f\u3001`show` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u3082\u3001\u540c\u69d8\u306b\u30ea\u30bd\u30fc\u30b9\u304c\u5b58\u5728\u3057\u3066\u3044\u306a\u3044\u4e8b\u304c\u78ba\u8a8d\u51fa\u6765\u308b\u3002\n\n```\n$ ./terraform show ./terraform.tfstate\nThe state file is empty. No resources are represented.\n```\n\n### \u30ea\u30bd\u30fc\u30b9\u306e\u518d\u8a2d\u5b9a\u3068\u5909\u66f4\n\n\u30ea\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u304c\u3042\u308c\u3070\u3001\u4ed6\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u3063\u305f\u308a\u3001\u3042\u308b\u3044\u306f\u5225\u306e AWS \u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u3082\u3001\u540c\u69d8\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u8ffd\u52a0\u51fa\u6765\u308b\u3002\u8a2d\u5b9a\u3092\u5fa9\u65e7\u3055\u305b\u308b\u306b\u306f\u3001\u5148\u307b\u3069\u540d\u79f0\u5909\u66f4\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u5143\u306b\u5dee\u3057\u623b\u3059\u3002\n\n```\n$ mv aws_security_group.tf.bakup aws_security_group.tf\n```\n\n\u305d\u308c\u304b\u3089 `plan` `apply` \u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u518d\u3073\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u8a2d\u5b9a\u304c\u5fa9\u5e30\u3057\u3066\u3044\u308b\u3002\u3053\u306e\u60c5\u5831\u306f AWS \u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3082\u78ba\u8a8d\u51fa\u6765\u308b\u3002\n\n```\n$ ./terraform plan\n$ ./terraform apply\n```\n\n\u3053\u306e\u3088\u3046\u306b Terraform \u3092\u4f7f\u3048\u3070\u3001\u8a2d\u5b9a\u306e\u9069\u7528\u30fb\u5909\u66f4\u304c\u7c21\u5358\u306b\u884c\u3048\u308b\u3002\u307e\u305f\u672c\u756a\u74b0\u5883\u3067\u5b9f\u884c\u3059\u308b\u524d\u306b\u3001\u30c6\u30b9\u30c8\u74b0\u5883\u3067\u306e\u9069\u7528\u8a66\u9a13\u3082\u3001\u6bd4\u8f03\u7684\u7c21\u5358\u306b\u884c\u3048\u308b\u3068\u8a00\u3048\u308b\u3060\u308d\u3046\u3002\n\n\u6b21\u306b\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u8a2d\u5b9a\u5909\u66f4\u3092\u8a66\u307f\u308b\u3002\u73fe\u5728\u306e\u30dd\u30ea\u30b7\u30fc\u306f\u5168\u3066\u306e\u30dd\u30fc\u30c8\u3092\u89e3\u653e\u3059\u308b\u3082\u306e\u3067\u3042\u308a\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u304c\u61f8\u5ff5\u3055\u308c\u308b\u3002\n\n\u3053\u308c\u3092 `SSH` (TCP:22) \u3068 `HTTP` (TCP:80) \u306e\u307f\u306b\u5909\u66f4\u3059\u308b\u3002`aws_security_group.tf` \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001\u6b21\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\u3002\n\n```file:aws_security_group.tf\nresource \"aws_security_group\" \"allow_all\" {\n    name = \"allow_ssh_and_tcp\"\n    ingress {\n        from_port = 22\n        to_port = 22\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    ingress {\n        from_port = 80\n        to_port = 80\n        protocol = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n    }\n    description = \"allow tcp 22 and 80\"\n}\n```\n\n\u5bfe\u8c61\u3068\u306a\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u540d\u306f `allow_all` \u306e\u307e\u307e\u3060\u304c\u3001`ingress` \u3068\u3044\u3046 inbound \u5074\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30eb\u30fc\u30eb\u3092\u66f8\u304d\u63db\u3048\u3066\u3044\u308b\u3002\u307e\u305f\u3001\u30b0\u30eb\u30fc\u30d7\u540d\u79f0 `name` \u3092\u66f8\u304d\u63db\u3048\u308b\u3068\u3001terraform \u306f\u30ea\u30bd\u30fc\u30b9\u306b\u5bfe\u3059\u308b\u66f4\u65b0\u3092\u884c\u3046\u306e\u3067\u306f\u306a\u304f\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u524a\u9664\u30fb\u518d\u8ffd\u52a0\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3002\n\nTerraform \u3067\u8a2d\u5b9a\u3092\u9069\u7528\u3059\u308b\u524d\u306b\u3001\u4f8b\u306b\u3088\u3063\u3066 `terraform plan` \u30b3\u30de\u30f3\u30c9\u3067\u3001\u5909\u66f4\u5185\u5bb9\u3092\u4e8b\u524d\u78ba\u8a8d\u3059\u308b\u3002\n\n```\n$ ./terraform plan\nRefreshing Terraform state prior to plan...\n\naws_security_group.allow_all: Refreshing state... (ID: sg-25302d24)\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n-/+ aws_security_group.allow_all\n    description:             \"full open ><;\" => \"allow tcp 22 and 80\"\n    ingress.#:               \"1\" => \"2\"\n    ingress.0.from_port:     \"0\" => \"22\"\n    ingress.0.to_port:       \"65535\" => \"22\"\n    ingress.1.cidr_blocks.#: \"\" => \"1\"\n    ingress.1.cidr_blocks.0: \"\" => \"0.0.0.0/0\"\n    ingress.1.from_port:     \"\" => \"80\"\n    ingress.1.protocol:      \"\" => \"tcp\"\n    ingress.1.to_port:       \"\" => \"80\"\n    name:                    \"allow_all\" => \"allow_ssh_and_http\" (forces new resource)\n    owner_id:                \"091177877630\" => \"<computed>\"\n    vpc_id:                  \"\" => \"<computed>\"\n```\n\n\u4eca\u5ea6\u306f\u3001Terraform \u306e\u30ea\u30bd\u30fc\u30b9`aws_security_group.allow_all` \u306b\u5bfe\u3057\u3001 `-`(\u524a\u9664) \u3068 `+`(\u8ffd\u52a0) \u3092\u8a08\u753b\u3057\u3066\u3044\u308b\u5909\u66f4\u3092\u884c\u304a\u3046\u3068\u3059\u308b\u3068\u3001`(force new resource)` \u3068\u8868\u793a\u3055\u308c\u3001\u5bfe\u8c61\u30ea\u30bd\u30fc\u30b9\u306b\u5bfe\u3059\u308b\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3046\u306e\u3067\u306f\u306a\u304f\u3001Terraform \u306f\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u524a\u9664\u30fb\u8ffd\u52a0\u3092\u5b9f\u65bd\u3057\u3066\u3044\u308b\u3068\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3002\n\n\u5185\u5bb9\u306b\u554f\u984c\u304c\u7121\u3051\u308c\u3070\u3001\u5b9f\u969b\u306b\u8a2d\u5b9a\u3092\u53cd\u6620(apply)\u3059\u308b\u3002\n\n```\n$ ./terraform apply\naws_security_group.allow_all: Refreshing state... (ID: sg-25302d24)\naws_security_group.allow_all: Destroying...\naws_security_group.allow_all: Destruction complete\naws_security_group.allow_all: Modifying...\n  description:             \"full open ><;\" => \"allow tcp 22 and 80\"\n  ingress.#:               \"1\" => \"2\"\n  ingress.0.from_port:     \"0\" => \"22\"\n  ingress.0.to_port:       \"65535\" => \"22\"\n  ingress.1.cidr_blocks.#: \"\" => \"1\"\n  ingress.1.cidr_blocks.0: \"\" => \"0.0.0.0/0\"\n  ingress.1.from_port:     \"\" => \"80\"\n  ingress.1.protocol:      \"\" => \"tcp\"\n  ingress.1.to_port:       \"\" => \"80\"\n  name:                    \"allow_all\" => \"allow_ssh_and_http\"\naws_security_group.allow_all: Modifications complete\n\nApply complete! Resources: 0 added, 1 changed, 1 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\nState path: terraform.tfstate\n```\n\n\u3053\u308c\u3067\u30d6\u30e9\u30a6\u30b6\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u53e4\u3044\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306f\u524a\u9664\u3055\u308c\u3001\u65b0\u305f\u306b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n![terraform_ec2_secutirygroup-02.png](https://qiita-image-store.s3.amazonaws.com/0/13002/acaf4434-c31c-5909-5ecb-230779d2178a.png)\n\n\u307e\u305f\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3067\u78ba\u8a8d\u3067\u304d\u308b\u5909\u66f4\u5185\u5bb9\u3084\u3001`Group ID` \u306f\u3001`terraform show` \u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u304c\u53ef\u80fd\u3067\u3042\u308b\u3002\n\n```\n$ ./terraform show ./terraform.tfstate\naws_security_group.allow_all:\n  id = sg-c3302dc2\n  description = allow tcp 22 and 80\n  ingress.# = 2\n  ingress.0.cidr_blocks.# = 1\n  ingress.0.cidr_blocks.0 = 0.0.0.0/0\n  ingress.0.from_port = 22\n  ingress.0.protocol = tcp\n  ingress.0.to_port = 22\n  ingress.1.cidr_blocks.# = 1\n  ingress.1.cidr_blocks.0 = 0.0.0.0/0\n  ingress.1.from_port = 80\n  ingress.1.protocol = tcp\n  ingress.1.to_port = 80\n  name = allow_ssh_and_http\n  owner_id = 091177877630\n  vpc_id =\n```\n\n\u306a\u304a\u3001Terraform \u306e\u6a5f\u80fd\u3068\u3057\u3066\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u66f4\u65b0\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3002\u3057\u304b\u3057\u3001\u73fe\u6642\u70b9\u306e AWS \u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u306f\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u30ea\u30bd\u30fc\u30b9\u5909\u66f4\uff08inbound\u30eb\u30fc\u30eb\u306e\u5909\u66f4\uff09\u306b\u306f\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u3002\n\n### \u88dc\u8db3\n\nTeffarom \u304c\u884c\u3046\u306e\u306f\u3001\u3042\u304f\u307e\u3067\u30a4\u30f3\u30d5\u30e9\u306b\u95a2\u3059\u308b\u5b9a\u7fa9\u3068\u51e6\u7406\u3067\u3042\u308a\u3001\u9ad8\u5ea6\u306a\u64cd\u4f5c\u3092\u884c\u3046\u4e8b\u304c\u3067\u304d\u306a\u3044\u3002\u305d\u306e\u3088\u3046\u306a\u51e6\u7406\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u3001CLI \u3084 API \u4f7f\u3063\u305f\u64cd\u4f5c\u3092\u63a8\u5968\u3059\u308b\u3002\u52a0\u3048\u3066\u3001\u73fe\u6642\u70b9\u306f\u958b\u767a\u4e2d\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u305f\u3081\u3001\u672a\u5b9f\u88c5\u306e\u9805\u76ee\u3082\u591a\u304f\u3001\u5168\u3066\u306e\u4f5c\u696d\u3092 Terrafrom \u304c\u884c\u3048\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u3002\u305d\u308c\u3067\u3082\u3001\u74b0\u5883\u69cb\u7bc9\u3084\u30c6\u30b9\u30c8\u306b\u304a\u3044\u3066\u3001Terraform \u3092\u4f7f\u3048\u308b\u5834\u6240\u304c\u3042\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u308f\u308c\u308b\u3002\n\n## \u53c2\u8003\n\n* Provider: AWS - Terraform\n * http://www.terraform.io/docs/providers/aws/index.html\n\n* AWS: aws_security_group - Terraform\n * http://www.terraform.io/docs/providers/aws/r/security_group.html\n\n\n", "tags": ["Terraform"]}