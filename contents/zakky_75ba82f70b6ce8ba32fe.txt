{"tags": ["aws-cli", "acm", "CloudFront", "awscli", "AWS"], "context": "\u3053\u308c\u306fAWS Certificate Manager (ACM)\u5165\u9580\u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599\u306e\u4e00\u90e8\u3067\u3059\u3002\n\u6700\u521d\u304b\u3089\u7d9a\u3051\u3066\u884c\u3063\u3066\u3044\u308b\u5834\u5408\u300c0.\u6e96\u5099\u300d\u306e\u5404\u9805\u306f\u4f5c\u696d\u4e0d\u8981\u3067\u3059\u3002\u7b2c1\u9805\u3078\u9032\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n\n0. \u6e96\u5099\n\n0.1. \u30c9\u30e1\u30a4\u30f3\u540d\u306e\u5909\u6570\u3078\u306e\u683c\u7d0d\n\u5909\u6570\u3078\u30c9\u30e1\u30a4\u30f3\u540d\u3092\u683c\u7d0d\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f example.tk \u3068\u3057\u307e\u3059\u3002\u81ea\u5206\u306e\u30c9\u30e1\u30a4\u30f3\u540d\u306b\u8aad\u307f\u66ff\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30b3\u30de\u30f3\u30c9\nDOMAINNAME=\"example.tk\" && echo ${DOMAINNAME}\n\n\n\n\u7d50\u679c(\u4f8b)\n      example.tk\n\n\n\n0.2. \u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3ID\u306e\u5909\u6570\u3078\u306e\u683c\u7d0d\n\n\u30b3\u30de\u30f3\u30c9\nCF_DIST_ID=`aws cloudfront list-distributions \\\n --query DistributionList.Items[].Id --output text` && echo ${CF_DIST_ID}\n\n\n\n\u7d50\u679c(\u4f8b)\n      EQSY786QZ6BPJ\n\n\n\n1. CloudFront\u306e\u524a\u9664\n\n1.1. \u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u7121\u52b9\u5316\u306e\u305f\u3081\u306eJSON\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u7a3c\u50cd\u3057\u3066\u3044\u308b\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u3092\u524a\u9664\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\u3053\u306e\u305f\u3081\u3001\u307e\u305a\u306f\u7121\u52b9\u306b\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u7121\u52b9\u306b\u8a2d\u5b9a\u5909\u66f4\u3059\u308b\u305f\u3081\u306eJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\ncat << EOF > ./cfd.json\n{\n  \"Comment\": \"\",\n  \"CacheBehaviors\": {\n      \"Quantity\": 0\n  },\n  \"Logging\": {\n      \"Bucket\": \"\",\n      \"Prefix\": \"\",\n      \"Enabled\": false,\n      \"IncludeCookies\": false\n  },\n  \"WebACLId\": \"\",\n  \"Origins\": {\n      \"Items\": [\n          {\n              \"OriginPath\": \"\",\n              \"S3OriginConfig\": {\n                  \"OriginAccessIdentity\": \"\"\n              },\n              \"Id\": \"www.${DOMAINNAME}\",\n              \"DomainName\": \"www.${DOMAINNAME}.s3.amazonaws.com\",\n              \"CustomHeaders\": {\n                \"Quantity\": 0\n              }\n          }\n      ],\n      \"Quantity\": 1\n  },\n  \"DefaultRootObject\": \"\",\n  \"PriceClass\": \"PriceClass_All\",\n  \"Enabled\": false,\n  \"DefaultCacheBehavior\": {\n      \"TrustedSigners\": {\n          \"Enabled\": false,\n          \"Quantity\": 0\n      },\n      \"TargetOriginId\": \"www.${DOMAINNAME}\",\n      \"ViewerProtocolPolicy\": \"allow-all\",\n      \"ForwardedValues\": {\n          \"Headers\": {\n              \"Quantity\": 0\n          },\n          \"Cookies\": {\n              \"Forward\": \"none\"\n          },\n          \"QueryStringCacheKeys\": {\n              \"Quantity\": 0\n          },\n          \"QueryString\": true\n      },\n      \"MaxTTL\": 31536000,\n      \"SmoothStreaming\": false,\n      \"DefaultTTL\": 86400,\n      \"AllowedMethods\": {\n          \"Items\": [\n              \"HEAD\",\n              \"GET\"\n          ],\n          \"CachedMethods\": {\n              \"Items\": [\n                  \"HEAD\",\n                  \"GET\"\n              ],\n              \"Quantity\": 2\n          },\n          \"Quantity\": 2\n      },\n      \"Compress\": false,\n      \"MinTTL\": 3600\n  },\n  \"CallerReference\": \"www.${DOMAINNAME}\",\n  \"ViewerCertificate\": {\n      \"CloudFrontDefaultCertificate\": true,\n      \"MinimumProtocolVersion\": \"SSLv3\"\n  },\n  \"CustomErrorResponses\": {\n      \"Quantity\": 0\n  },\n  \"HttpVersion\": \"http2\",\n  \"Restrictions\": {\n      \"GeoRestriction\": {\n          \"RestrictionType\": \"none\",\n          \"Quantity\": 0\n      }\n  },\n  \"Aliases\": {\n      \"Quantity\": 0\n  }\n}\nEOF\ncat ./cfd.json\n\n\n\n\u7d50\u679c(\u4f8b)\n      {\n        \"Comment\": \"\",\n        \"CacheBehaviors\": {\n            \"Quantity\": 0\n        },\n        \"Logging\": {\n            \"Bucket\": \"\",\n            \"Prefix\": \"\",\n            \"Enabled\": false,\n            \"IncludeCookies\": false\n        },\n        \"WebACLId\": \"\",\n        \"Origins\": {\n            \"Items\": [\n                {\n                    \"OriginPath\": \"\",\n                    \"S3OriginConfig\": {\n                        \"OriginAccessIdentity\": \"\"\n                    },\n                    \"Id\": \"www.example.tk\",\n                    \"DomainName\": \"www.example.tk.s3.amazonaws.com\",\n                    \"CustomHeaders\": {\n                      \"Quantity\": 0\n                    }\n                }\n            ],\n            \"Quantity\": 1\n        },\n        \"DefaultRootObject\": \"\",\n        \"PriceClass\": \"PriceClass_All\",\n        \"Enabled\": false,\n        \"DefaultCacheBehavior\": {\n            \"TrustedSigners\": {\n                \"Enabled\": false,\n                \"Quantity\": 0\n            },\n            \"TargetOriginId\": \"www.example.tk\",\n            \"ViewerProtocolPolicy\": \"allow-all\",\n            \"ForwardedValues\": {\n                \"Headers\": {\n                    \"Quantity\": 0\n                },\n                \"Cookies\": {\n                    \"Forward\": \"none\"\n                },\n                \"QueryStringCacheKeys\": {\n                    \"Quantity\": 0\n                },\n                \"QueryString\": true\n            },\n            \"MaxTTL\": 31536000,\n            \"SmoothStreaming\": false,\n            \"DefaultTTL\": 86400,\n            \"AllowedMethods\": {\n                \"Items\": [\n                    \"HEAD\",\n                    \"GET\"\n                ],\n                \"CachedMethods\": {\n                    \"Items\": [\n                        \"HEAD\",\n                        \"GET\"\n                    ],\n                    \"Quantity\": 2\n                },\n                \"Quantity\": 2\n            },\n            \"Compress\": false,\n            \"MinTTL\": 3600\n        },\n        \"CallerReference\": \"www.example.tk\",\n        \"ViewerCertificate\": {\n            \"CloudFrontDefaultCertificate\": true,\n            \"MinimumProtocolVersion\": \"SSLv3\"\n        },\n        \"CustomErrorResponses\": {\n            \"Quantity\": 0\n        },\n        \"HttpVersion\": \"http2\",\n        \"Restrictions\": {\n            \"GeoRestriction\": {\n                \"RestrictionType\": \"none\",\n                \"Quantity\": 0\n            }\n        },\n        \"Aliases\": {\n            \"Quantity\": 0\n        }\n      }\n\n\nJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u3089\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u58ca\u308c\u3066\u306a\u3044\u304b\u5fc5\u305a\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\njsonlint -q cfd.json\n\n\n\n\u7d50\u679c\n      \u8fd4\u308a\u5024\u306a\u3057\n\n\n\n1.2. ETAG\u306e\u53d6\u5f97\nCloudFront\u306fETAG\u3068\u547c\u3070\u308c\u308b\u73fe\u6642\u70b9\u3092\u793a\u3059\u4e00\u610f\u6027\u306eID\u304c\u5909\u66f4\u3042\u308b\u3054\u3068\u306b\u5909\u5316\u3057\u307e\u3059\u3002\n\u3053\u306e\u305f\u3081\u3001\u5909\u66f4\u3092\u884c\u3046\u969b\u306f\u73fe\u5728\u306eETAG\u3092\u90fd\u5ea6\u53d6\u5f97\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\nETAG=`aws cloudfront get-distribution \\\n --id ${CF_DIST_ID} --query ETag --output text` && echo ${ETAG}\n\n\n\n\u7d50\u679c(\u4f8b)\n      E2RGD6G83K3B8Q\n\n\n\n1.3. \u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u306e\u7121\u52b9\u5316\n\n\u30b3\u30de\u30f3\u30c9\naws cloudfront update-distribution --id ${CF_DIST_ID} \\\n --if-match ${ETAG} --distribution-config file://cfd.json\n\n\n\n\u7d50\u679c(\u4f8b)\n      {\n          \"Distribution\": {\n              \"Status\": \"InProgress\",\n              \"DomainName\": \"d3plx1x2hvysv9.cloudfront.net\",\n              \"InProgressInvalidationBatches\": 0,\n              \"DistributionConfig\": {\n                  \"Comment\": \"\",\n                  \"CacheBehaviors\": {\n                      \"Quantity\": 0\n                  },\n                  \"IsIPV6Enabled\": true,\n                  \"Logging\": {\n                      \"Bucket\": \"\",\n                      \"Prefix\": \"\",\n                      \"Enabled\": false,\n                      \"IncludeCookies\": false\n                  },\n                  \"WebACLId\": \"\",\n                  \"Origins\": {\n                      \"Items\": [\n                          {\n                              \"S3OriginConfig\": {\n                                  \"OriginAccessIdentity\": \"\"\n                              },\n                              \"OriginPath\": \"\",\n                              \"CustomHeaders\": {\n                                  \"Quantity\": 0\n                              },\n                              \"Id\": \"www.example.tk\",\n                              \"DomainName\": \"www.example.tk.s3.amazonaws.com\"\n                          }\n                      ],\n                      \"Quantity\": 1\n                  },\n                  \"DefaultRootObject\": \"\",\n                  \"PriceClass\": \"PriceClass_All\",\n                  \"Enabled\": false,\n                  \"DefaultCacheBehavior\": {\n                      \"TrustedSigners\": {\n                          \"Enabled\": false,\n                          \"Quantity\": 0\n                      },\n                      \"TargetOriginId\": \"www.example.tk\",\n                      \"ViewerProtocolPolicy\": \"allow-all\",\n                      \"ForwardedValues\": {\n                          \"Headers\": {\n                              \"Quantity\": 0\n                          },\n                          \"Cookies\": {\n                              \"Forward\": \"none\"\n                          },\n                          \"QueryStringCacheKeys\": {\n                              \"Quantity\": 0\n                          },\n                          \"QueryString\": true\n                      },\n                      \"MaxTTL\": 31536000,\n                      \"SmoothStreaming\": false,\n                      \"DefaultTTL\": 86400,\n                      \"AllowedMethods\": {\n                          \"Items\": [\n                              \"HEAD\",\n                              \"GET\"\n                          ],\n                          \"CachedMethods\": {\n                              \"Items\": [\n                                  \"HEAD\",\n                                  \"GET\"\n                              ],\n                              \"Quantity\": 2\n                          },\n                          \"Quantity\": 2\n                      },\n                      \"MinTTL\": 3600,\n                      \"Compress\": false\n                  },\n                  \"CallerReference\": \"www.example.tk\",\n                  \"ViewerCertificate\": {\n                      \"CloudFrontDefaultCertificate\": true,\n                      \"MinimumProtocolVersion\": \"SSLv3\",\n                      \"CertificateSource\": \"cloudfront\"\n                  },\n                  \"CustomErrorResponses\": {\n                      \"Quantity\": 0\n                  },\n                  \"HttpVersion\": \"http2\",\n                  \"Restrictions\": {\n                      \"GeoRestriction\": {\n                          \"RestrictionType\": \"none\",\n                          \"Quantity\": 0\n                      }\n                  },\n                  \"Aliases\": {\n                      \"Quantity\": 0\n                  }\n              },\n              \"ActiveTrustedSigners\": {\n                  \"Enabled\": false,\n                  \"Quantity\": 0\n              },\n              \"LastModifiedTime\": \"2016-11-05T06:40:52.996Z\",\n              \"Id\": \"EXCSDJOUKJB7M\",\n              \"ARN\": \"arn:aws:cloudfront::777777777777:distribution/EXCSDJOUKJB7M\"\n          },\n          \"ETag\": \"EYOPEK5P7XOW4\"\n      }\n\n\n\n1.4. CloudFront\u306e\u30c7\u30d7\u30ed\u30a4\u5b8c\u4e86\u3092\u5f85\u3064\n\n\u30b3\u30de\u30f3\u30c9\naws cloudfront wait distribution-deployed --id ${CF_DIST_ID}\n\n\n\n\u7d50\u679c\n      \u8fd4\u308a\u5024\u306a\u3057\n\n\n\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u5e30\u3063\u3066\u304f\u308b\u307e\u3067\u3053\u308c\u306f\uff12\uff10\uff5e\uff13\uff10\u5206\u3050\u3089\u3044\u304b\u304b\u308a\u307e\u3059\u3002\n\u307f\u3093\u306a\u3067\u30d3\u30fc\u30eb\u3067\u3082\u98f2\u307f\u306a\u304c\u3089\u4e80\u7530\u3055\u3093\u3092\u56f2\u3093\u3067\u5f85\u3061\u307e\u3057\u3087\u3046\u3002\n\uff08\u4e16\u754c\u5404\u5730\u306e\u30a8\u30c3\u30c2\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3078\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3059\uff09\nwait\u30b3\u30de\u30f3\u30c9\u306b\u306f\u5f85\u3066\u308b\u9650\u754c\u304c\u5b58\u5728\u3057\u3001\u4e07\u4e00\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3057\u3066\nWaiter DistributionDeployed failed: Max attempts exceeded\n\u3068\u3044\u3046\u51fa\u529b\u304c\u8fd4\u3063\u3066\u6765\u305f\u3089\u30b3\u30de\u30f3\u30c9\u3092\u518d\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n1.5. ETAG\u306e\u53d6\u5f97\nETAG\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u518d\u5ea6\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\nETAG=`aws cloudfront get-distribution \\\n --id ${CF_DIST_ID} --query ETag --output text` && echo ${ETAG}\n\n\n\n\u7d50\u679c(\u4f8b)\n      EYOPEK5P7XOW4\n\n\n\n1.6. \u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u306e\u524a\u9664\n\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u524a\u9664\u306e\u6e96\u5099\u304c\u6574\u3044\u307e\u3057\u305f\u3002\n\n\u30b3\u30de\u30f3\u30c9\naws cloudfront delete-distribution --id ${CF_DIST_ID} --if-match ${ETAG}\n\n\n\n\u7d50\u679c\n      \u8fd4\u308a\u5024\u306a\u3057\n\n\n\n1.7. \u524a\u9664\u3055\u308c\u305f\u304b\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws cloudfront list-distributions\n\n\n\n\u7d50\u679c\n      \u8fd4\u308a\u5024\u306a\u3057\n\n\n\u3053\u308c\u306f<A HREF=\"http://qiita.com/zakky/items/29cf8095f6faa24f216b\" target=_blank>AWS Certificate Manager (ACM)\u5165\u9580\u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599</A>\u306e\u4e00\u90e8\u3067\u3059\u3002\n\u6700\u521d\u304b\u3089\u7d9a\u3051\u3066\u884c\u3063\u3066\u3044\u308b\u5834\u5408\u300c0.\u6e96\u5099\u300d\u306e\u5404\u9805\u306f\u4f5c\u696d\u4e0d\u8981\u3067\u3059\u3002<A HREF=\"#1-cloudfront\u306e\u524a\u9664\">\u7b2c1\u9805\u3078\u9032\u3093\u3067\u304f\u3060\u3055\u3044</A>\u3002\n\n0. \u6e96\u5099\n=======\n\n0.1. \u30c9\u30e1\u30a4\u30f3\u540d\u306e\u5909\u6570\u3078\u306e\u683c\u7d0d\n---------------\n\n\u5909\u6570\u3078\u30c9\u30e1\u30a4\u30f3\u540d\u3092\u683c\u7d0d\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f example.tk \u3068\u3057\u307e\u3059\u3002\u81ea\u5206\u306e\u30c9\u30e1\u30a4\u30f3\u540d\u306b\u8aad\u307f\u66ff\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\nDOMAINNAME=\"example.tk\" && echo ${DOMAINNAME}\n```\n\n```text:\u7d50\u679c(\u4f8b):\n      example.tk\n```\n\n0.2. \u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3ID\u306e\u5909\u6570\u3078\u306e\u683c\u7d0d\n---------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\nCF_DIST_ID=`aws cloudfront list-distributions \\\n --query DistributionList.Items[].Id --output text` && echo ${CF_DIST_ID}\n```\n```text:\u7d50\u679c(\u4f8b):\n      EQSY786QZ6BPJ\n```\n\n\n1. CloudFront\u306e\u524a\u9664\n=================\n\n1.1. \u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u7121\u52b9\u5316\u306e\u305f\u3081\u306eJSON\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n---------------\n\n\u7a3c\u50cd\u3057\u3066\u3044\u308b\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u3092\u524a\u9664\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\u3053\u306e\u305f\u3081\u3001\u307e\u305a\u306f\u7121\u52b9\u306b\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u7121\u52b9\u306b\u8a2d\u5b9a\u5909\u66f4\u3059\u308b\u305f\u3081\u306eJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\ncat << EOF > ./cfd.json\n{\n  \"Comment\": \"\",\n  \"CacheBehaviors\": {\n      \"Quantity\": 0\n  },\n  \"Logging\": {\n      \"Bucket\": \"\",\n      \"Prefix\": \"\",\n      \"Enabled\": false,\n      \"IncludeCookies\": false\n  },\n  \"WebACLId\": \"\",\n  \"Origins\": {\n      \"Items\": [\n          {\n              \"OriginPath\": \"\",\n              \"S3OriginConfig\": {\n                  \"OriginAccessIdentity\": \"\"\n              },\n              \"Id\": \"www.${DOMAINNAME}\",\n              \"DomainName\": \"www.${DOMAINNAME}.s3.amazonaws.com\",\n              \"CustomHeaders\": {\n                \"Quantity\": 0\n              }\n          }\n      ],\n      \"Quantity\": 1\n  },\n  \"DefaultRootObject\": \"\",\n  \"PriceClass\": \"PriceClass_All\",\n  \"Enabled\": false,\n  \"DefaultCacheBehavior\": {\n      \"TrustedSigners\": {\n          \"Enabled\": false,\n          \"Quantity\": 0\n      },\n      \"TargetOriginId\": \"www.${DOMAINNAME}\",\n      \"ViewerProtocolPolicy\": \"allow-all\",\n      \"ForwardedValues\": {\n          \"Headers\": {\n              \"Quantity\": 0\n          },\n          \"Cookies\": {\n              \"Forward\": \"none\"\n          },\n          \"QueryStringCacheKeys\": {\n              \"Quantity\": 0\n          },\n          \"QueryString\": true\n      },\n      \"MaxTTL\": 31536000,\n      \"SmoothStreaming\": false,\n      \"DefaultTTL\": 86400,\n      \"AllowedMethods\": {\n          \"Items\": [\n              \"HEAD\",\n              \"GET\"\n          ],\n          \"CachedMethods\": {\n              \"Items\": [\n                  \"HEAD\",\n                  \"GET\"\n              ],\n              \"Quantity\": 2\n          },\n          \"Quantity\": 2\n      },\n      \"Compress\": false,\n      \"MinTTL\": 3600\n  },\n  \"CallerReference\": \"www.${DOMAINNAME}\",\n  \"ViewerCertificate\": {\n      \"CloudFrontDefaultCertificate\": true,\n      \"MinimumProtocolVersion\": \"SSLv3\"\n  },\n  \"CustomErrorResponses\": {\n      \"Quantity\": 0\n  },\n  \"HttpVersion\": \"http2\",\n  \"Restrictions\": {\n      \"GeoRestriction\": {\n          \"RestrictionType\": \"none\",\n          \"Quantity\": 0\n      }\n  },\n  \"Aliases\": {\n      \"Quantity\": 0\n  }\n}\nEOF\ncat ./cfd.json\n```\n```text:\u7d50\u679c(\u4f8b):\n      {\n        \"Comment\": \"\",\n        \"CacheBehaviors\": {\n            \"Quantity\": 0\n        },\n        \"Logging\": {\n            \"Bucket\": \"\",\n            \"Prefix\": \"\",\n            \"Enabled\": false,\n            \"IncludeCookies\": false\n        },\n        \"WebACLId\": \"\",\n        \"Origins\": {\n            \"Items\": [\n                {\n                    \"OriginPath\": \"\",\n                    \"S3OriginConfig\": {\n                        \"OriginAccessIdentity\": \"\"\n                    },\n                    \"Id\": \"www.example.tk\",\n                    \"DomainName\": \"www.example.tk.s3.amazonaws.com\",\n                    \"CustomHeaders\": {\n                      \"Quantity\": 0\n                    }\n                }\n            ],\n            \"Quantity\": 1\n        },\n        \"DefaultRootObject\": \"\",\n        \"PriceClass\": \"PriceClass_All\",\n        \"Enabled\": false,\n        \"DefaultCacheBehavior\": {\n            \"TrustedSigners\": {\n                \"Enabled\": false,\n                \"Quantity\": 0\n            },\n            \"TargetOriginId\": \"www.example.tk\",\n            \"ViewerProtocolPolicy\": \"allow-all\",\n            \"ForwardedValues\": {\n                \"Headers\": {\n                    \"Quantity\": 0\n                },\n                \"Cookies\": {\n                    \"Forward\": \"none\"\n                },\n                \"QueryStringCacheKeys\": {\n                    \"Quantity\": 0\n                },\n                \"QueryString\": true\n            },\n            \"MaxTTL\": 31536000,\n            \"SmoothStreaming\": false,\n            \"DefaultTTL\": 86400,\n            \"AllowedMethods\": {\n                \"Items\": [\n                    \"HEAD\",\n                    \"GET\"\n                ],\n                \"CachedMethods\": {\n                    \"Items\": [\n                        \"HEAD\",\n                        \"GET\"\n                    ],\n                    \"Quantity\": 2\n                },\n                \"Quantity\": 2\n            },\n            \"Compress\": false,\n            \"MinTTL\": 3600\n        },\n        \"CallerReference\": \"www.example.tk\",\n        \"ViewerCertificate\": {\n            \"CloudFrontDefaultCertificate\": true,\n            \"MinimumProtocolVersion\": \"SSLv3\"\n        },\n        \"CustomErrorResponses\": {\n            \"Quantity\": 0\n        },\n        \"HttpVersion\": \"http2\",\n        \"Restrictions\": {\n            \"GeoRestriction\": {\n                \"RestrictionType\": \"none\",\n                \"Quantity\": 0\n            }\n        },\n        \"Aliases\": {\n            \"Quantity\": 0\n        }\n      }\n```\n\nJSON\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u305f\u3089\u3001\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u58ca\u308c\u3066\u306a\u3044\u304b\u5fc5\u305a\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\njsonlint -q cfd.json\n```\n```text:\u7d50\u679c:\n      \u8fd4\u308a\u5024\u306a\u3057\n```\n\n1.2. ETAG\u306e\u53d6\u5f97\n---------------\n\nCloudFront\u306fETAG\u3068\u547c\u3070\u308c\u308b\u73fe\u6642\u70b9\u3092\u793a\u3059\u4e00\u610f\u6027\u306eID\u304c\u5909\u66f4\u3042\u308b\u3054\u3068\u306b\u5909\u5316\u3057\u307e\u3059\u3002\n\u3053\u306e\u305f\u3081\u3001\u5909\u66f4\u3092\u884c\u3046\u969b\u306f\u73fe\u5728\u306eETAG\u3092\u90fd\u5ea6\u53d6\u5f97\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\nETAG=`aws cloudfront get-distribution \\\n --id ${CF_DIST_ID} --query ETag --output text` && echo ${ETAG}\n```\n```text:\u7d50\u679c(\u4f8b):\n      E2RGD6G83K3B8Q\n```\n\n1.3. \u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u306e\u7121\u52b9\u5316\n---------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws cloudfront update-distribution --id ${CF_DIST_ID} \\\n --if-match ${ETAG} --distribution-config file://cfd.json\n```\n```text:\u7d50\u679c(\u4f8b):\n      {\n          \"Distribution\": {\n              \"Status\": \"InProgress\",\n              \"DomainName\": \"d3plx1x2hvysv9.cloudfront.net\",\n              \"InProgressInvalidationBatches\": 0,\n              \"DistributionConfig\": {\n                  \"Comment\": \"\",\n                  \"CacheBehaviors\": {\n                      \"Quantity\": 0\n                  },\n                  \"IsIPV6Enabled\": true,\n                  \"Logging\": {\n                      \"Bucket\": \"\",\n                      \"Prefix\": \"\",\n                      \"Enabled\": false,\n                      \"IncludeCookies\": false\n                  },\n                  \"WebACLId\": \"\",\n                  \"Origins\": {\n                      \"Items\": [\n                          {\n                              \"S3OriginConfig\": {\n                                  \"OriginAccessIdentity\": \"\"\n                              },\n                              \"OriginPath\": \"\",\n                              \"CustomHeaders\": {\n                                  \"Quantity\": 0\n                              },\n                              \"Id\": \"www.example.tk\",\n                              \"DomainName\": \"www.example.tk.s3.amazonaws.com\"\n                          }\n                      ],\n                      \"Quantity\": 1\n                  },\n                  \"DefaultRootObject\": \"\",\n                  \"PriceClass\": \"PriceClass_All\",\n                  \"Enabled\": false,\n                  \"DefaultCacheBehavior\": {\n                      \"TrustedSigners\": {\n                          \"Enabled\": false,\n                          \"Quantity\": 0\n                      },\n                      \"TargetOriginId\": \"www.example.tk\",\n                      \"ViewerProtocolPolicy\": \"allow-all\",\n                      \"ForwardedValues\": {\n                          \"Headers\": {\n                              \"Quantity\": 0\n                          },\n                          \"Cookies\": {\n                              \"Forward\": \"none\"\n                          },\n                          \"QueryStringCacheKeys\": {\n                              \"Quantity\": 0\n                          },\n                          \"QueryString\": true\n                      },\n                      \"MaxTTL\": 31536000,\n                      \"SmoothStreaming\": false,\n                      \"DefaultTTL\": 86400,\n                      \"AllowedMethods\": {\n                          \"Items\": [\n                              \"HEAD\",\n                              \"GET\"\n                          ],\n                          \"CachedMethods\": {\n                              \"Items\": [\n                                  \"HEAD\",\n                                  \"GET\"\n                              ],\n                              \"Quantity\": 2\n                          },\n                          \"Quantity\": 2\n                      },\n                      \"MinTTL\": 3600,\n                      \"Compress\": false\n                  },\n                  \"CallerReference\": \"www.example.tk\",\n                  \"ViewerCertificate\": {\n                      \"CloudFrontDefaultCertificate\": true,\n                      \"MinimumProtocolVersion\": \"SSLv3\",\n                      \"CertificateSource\": \"cloudfront\"\n                  },\n                  \"CustomErrorResponses\": {\n                      \"Quantity\": 0\n                  },\n                  \"HttpVersion\": \"http2\",\n                  \"Restrictions\": {\n                      \"GeoRestriction\": {\n                          \"RestrictionType\": \"none\",\n                          \"Quantity\": 0\n                      }\n                  },\n                  \"Aliases\": {\n                      \"Quantity\": 0\n                  }\n              },\n              \"ActiveTrustedSigners\": {\n                  \"Enabled\": false,\n                  \"Quantity\": 0\n              },\n              \"LastModifiedTime\": \"2016-11-05T06:40:52.996Z\",\n              \"Id\": \"EXCSDJOUKJB7M\",\n              \"ARN\": \"arn:aws:cloudfront::777777777777:distribution/EXCSDJOUKJB7M\"\n          },\n          \"ETag\": \"EYOPEK5P7XOW4\"\n      }\n```\n\n1.4. CloudFront\u306e\u30c7\u30d7\u30ed\u30a4\u5b8c\u4e86\u3092\u5f85\u3064\n-----------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws cloudfront wait distribution-deployed --id ${CF_DIST_ID}\n```\n```text:\u7d50\u679c:\n      \u8fd4\u308a\u5024\u306a\u3057\n```\n\n\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u5e30\u3063\u3066\u304f\u308b\u307e\u3067\u3053\u308c\u306f\uff12\uff10\uff5e\uff13\uff10\u5206\u3050\u3089\u3044\u304b\u304b\u308a\u307e\u3059\u3002\n\u307f\u3093\u306a\u3067\u30d3\u30fc\u30eb\u3067\u3082\u98f2\u307f\u306a\u304c\u3089\u4e80\u7530\u3055\u3093\u3092\u56f2\u3093\u3067\u5f85\u3061\u307e\u3057\u3087\u3046\u3002\n\uff08\u4e16\u754c\u5404\u5730\u306e\u30a8\u30c3\u30c2\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3078\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3059\uff09\n\nwait\u30b3\u30de\u30f3\u30c9\u306b\u306f\u5f85\u3066\u308b\u9650\u754c\u304c\u5b58\u5728\u3057\u3001\u4e07\u4e00\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3057\u3066\nWaiter DistributionDeployed failed: Max attempts exceeded\n\u3068\u3044\u3046\u51fa\u529b\u304c\u8fd4\u3063\u3066\u6765\u305f\u3089\u30b3\u30de\u30f3\u30c9\u3092\u518d\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n1.5. ETAG\u306e\u53d6\u5f97\n---------------\n\nETAG\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u518d\u5ea6\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\nETAG=`aws cloudfront get-distribution \\\n --id ${CF_DIST_ID} --query ETag --output text` && echo ${ETAG}\n```\n```text:\u7d50\u679c(\u4f8b):\n      EYOPEK5P7XOW4\n```\n\n1.6. \u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u306e\u524a\u9664\n-----------------\n\n\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u524a\u9664\u306e\u6e96\u5099\u304c\u6574\u3044\u307e\u3057\u305f\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws cloudfront delete-distribution --id ${CF_DIST_ID} --if-match ${ETAG}\n```\n```text:\u7d50\u679c:\n      \u8fd4\u308a\u5024\u306a\u3057\n```\n\n1.7. \u524a\u9664\u3055\u308c\u305f\u304b\u78ba\u8a8d\n-----------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\naws cloudfront list-distributions\n```\n```text:\u7d50\u679c:\n      \u8fd4\u308a\u5024\u306a\u3057\n```\n\n"}