{"context": "Hello World!\u3068\u3044\u3046html\u3092\u8fd4\u3059\uff0bS3\u306b\u4f55\u304b\u66f8\u304d\u51fa\u305b\u308b\u3053\u3068\u3060\u3051\u78ba\u8a8d\u3057\u305f\u3068\u304d\u306e\u899a\u66f8\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install httpd\n\n\n\u8a2d\u5b9a\n/etc/httpd/conf/httpd.conf\n\u3092\u7de8\u96c6\n\nOptions \u306b ExecCGI\u3092\u8ffd\u52a0\nDirectoryIndex \u306b index.py\u3092\u8ffd\u52a0\nAddHandler cgi-script \u306b.py\u3092\u8ffd\u52a0\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n/var/www/html/\n\u306bindex.py\u3092\u3064\u304f\u3063\u3066\u30b3\u30fc\u30c9\u66f8\u304f\n$ chmod 755 index.py\n\u3057\u3066\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3002\nboto3\u4f7f\u3046\u306e\u3067\u5165\u308c\u308b\n$ sudo pip install boto3\n\n\u66f8\u3044\u305f\u30b3\u30fc\u30c9\n\uff08BucketName\u306f\u81ea\u5206\u306e\u30d0\u30b1\u30c3\u30c8\u540d\u306b\u66f8\u304d\u63db\u3048\uff09\n\nindex.py\n#!/usr/bin/python\n# coding:utf-8\n\nimport boto3\nimport logging\nimport datetime\nimport cgi\nimport uuid\n\ndef main():\n\n    now_s = datetime.datetime.now().strftime('%Y.%m.%d-%H:%M:%S')\n    messge = \"no-message\"\n    field = cgi.FieldStorage() # \u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u306bmessage\u304c\u3042\u308c\u3070\u4f7f\u3046\n    if field.has_key('message'):\n        message = field['message'].value\n\n    # html\n    print \"Content-Type: text/html\\n\"\n    print \"Hello World!\"\n\n    # S3\n    s3 = boto3.resource('s3')\n    key = 'test-folder/{0}-{1}.txt'.format(now_s, uuid.uuid4())\n    s3.meta.client.put_object(Bucket='BucketName', Key=key, Body=message)\n\n    # log\n    handler = logging.StreamHandler()\n    handler.setFormatter(logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s'))\n    logger = logging.getLogger()\n    logger.addHandler(handler)\n    logger.setLevel(logging.INFO)\n\n    logger.error(message)\n    logger.info(message)\n\nif __name__ == \"__main__\":\n    main()\n\n\n\n\nApache Start\n$ service httpd start\n\n\u78ba\u8a8d\nhttp\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u3066\u3001\u4ee5\u4e0b\u304c\u78ba\u8a8d\u3067\u304d\u308c\u3070OK\u3002\n\n\u5fdc\u7b54\u304c200\u3067\u3001Hello World!\u3068\u3044\u3046html\u304c\u8fd4\u308b\u3002\nS3\u306e\u6307\u5b9a\u3057\u305f\u30d0\u30b1\u30c3\u30c8\u306etest-folder\u306b\u300c\u65e5\u4ed8\uff0b\u65e5\u6642\uff0buid.txt\u300d\u307f\u305f\u3044\u306a\u540d\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u3066\u3044\u308b\u3002\n\u30ed\u30b0\u51fa\u529b\u3067\u304d\u3066\u3044\u308b\u3002\n\n\n\u305d\u306e\u4ed6\nPost\u3055\u308c\u305fBody\u3092\u53d6\u5f97\u3057\u305f\u3044\u3068\u304d\u3001\u305d\u308c\u304c\u30d5\u30a3\u30fc\u30eb\u30c9\u3068\u3057\u3066\u58ca\u308c\u3066\u305f\u308a\u751f\u30c7\u30fc\u30bf\u3060\u3068cgi.FieldStorage\u304b\u3089\u53d6\u308c\u305a\u3001not indexable\u30a8\u30e9\u30fc\u3067\u308b\u3002sys.stdin.read()\u306a\u3089\u3068\u308c\u305f\u3002\nHow to parse the \u201crequest body\u201d using python CGI?\nHello World!\u3068\u3044\u3046html\u3092\u8fd4\u3059\uff0bS3\u306b\u4f55\u304b\u66f8\u304d\u51fa\u305b\u308b\u3053\u3068\u3060\u3051\u78ba\u8a8d\u3057\u305f\u3068\u304d\u306e\u899a\u66f8\u3002\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ sudo yum install httpd\n```\n\n# \u8a2d\u5b9a\n\n/etc/httpd/conf/httpd.conf\n\u3092\u7de8\u96c6\n\n - Options \u306b ExecCGI\u3092\u8ffd\u52a0\n - DirectoryIndex \u306b index.py\u3092\u8ffd\u52a0\n - AddHandler cgi-script \u306b.py\u3092\u8ffd\u52a0\n\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n/var/www/html/\n\u306bindex.py\u3092\u3064\u304f\u3063\u3066\u30b3\u30fc\u30c9\u66f8\u304f\n\n```$ chmod 755 index.py```\n\u3057\u3066\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n\nboto3\u4f7f\u3046\u306e\u3067\u5165\u308c\u308b\n```$ sudo pip install boto3```\n\n## \u66f8\u3044\u305f\u30b3\u30fc\u30c9\n\uff08BucketName\u306f\u81ea\u5206\u306e\u30d0\u30b1\u30c3\u30c8\u540d\u306b\u66f8\u304d\u63db\u3048\uff09\n\n``` index.py\n#!/usr/bin/python\n# coding:utf-8\n\nimport boto3\nimport logging\nimport datetime\nimport cgi\nimport uuid\n\ndef main():\n\n    now_s = datetime.datetime.now().strftime('%Y.%m.%d-%H:%M:%S')\n    messge = \"no-message\"\n    field = cgi.FieldStorage() # \u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u306bmessage\u304c\u3042\u308c\u3070\u4f7f\u3046\n    if field.has_key('message'):\n        message = field['message'].value\n\n    # html\n    print \"Content-Type: text/html\\n\"\n    print \"Hello World!\"\n\n    # S3\n    s3 = boto3.resource('s3')\n    key = 'test-folder/{0}-{1}.txt'.format(now_s, uuid.uuid4())\n    s3.meta.client.put_object(Bucket='BucketName', Key=key, Body=message)\n\n    # log\n    handler = logging.StreamHandler()\n    handler.setFormatter(logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s'))\n    logger = logging.getLogger()\n    logger.addHandler(handler)\n    logger.setLevel(logging.INFO)\n\n    logger.error(message)\n    logger.info(message)\n\nif __name__ == \"__main__\":\n    main()\n\n```\n\n\n# Apache Start\n\n```$ service httpd start```\n\n\n# \u78ba\u8a8d\n\nhttp\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u3066\u3001\u4ee5\u4e0b\u304c\u78ba\u8a8d\u3067\u304d\u308c\u3070OK\u3002\n\n - \u5fdc\u7b54\u304c200\u3067\u3001Hello World!\u3068\u3044\u3046html\u304c\u8fd4\u308b\u3002\n - S3\u306e\u6307\u5b9a\u3057\u305f\u30d0\u30b1\u30c3\u30c8\u306etest-folder\u306b\u300c\u65e5\u4ed8\uff0b\u65e5\u6642\uff0buid.txt\u300d\u307f\u305f\u3044\u306a\u540d\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u3067\u304d\u3066\u3044\u308b\u3002\n - \u30ed\u30b0\u51fa\u529b\u3067\u304d\u3066\u3044\u308b\u3002\n\n# \u305d\u306e\u4ed6\n\nPost\u3055\u308c\u305fBody\u3092\u53d6\u5f97\u3057\u305f\u3044\u3068\u304d\u3001\u305d\u308c\u304c\u30d5\u30a3\u30fc\u30eb\u30c9\u3068\u3057\u3066\u58ca\u308c\u3066\u305f\u308a\u751f\u30c7\u30fc\u30bf\u3060\u3068cgi.FieldStorage\u304b\u3089\u53d6\u308c\u305a\u3001not indexable\u30a8\u30e9\u30fc\u3067\u308b\u3002sys.stdin.read()\u306a\u3089\u3068\u308c\u305f\u3002\n\n[How to parse the \u201crequest body\u201d using python CGI?](http://stackoverflow.com/questions/3836828/how-to-parse-the-request-body-using-python-cgi)\n", "tags": ["EC2", "Python", "Apache", "boto3"]}