{"context": " More than 1 year has passed since last update.2015/06/25\n\nMVC\nModel View Controller \u3067 MVC.\nAjax \u306e\u7df4\u7fd2\u3082\u517c\u306d\u3066\u66f8\u3044\u3066\u307f\u307e\u3057\u305f.\n\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068 URL \u306e\u5185\u5bb9\u3092\u30c6\u30ad\u30b9\u30c8\u30a8\u30ea\u30a2\u306b\u8868\u793a\u3057\u307e\u3059. \u305d\u308c\u3060\u3051\u3067\u3059.\n\u5909\u306a\u3068\u3053\u308d\u3042\u3063\u305f\u3089\u6559\u3048\u3066\u304f\u3060\u3055\u3044.\n\nModel - \u901a\u4fe1\u3092\u62c5\u5f53.\nView - UI\u3092\u62c5\u5f53.\nController - Model \u3068 View \u3092\u4ef2\u4ecb.\n\n\u30e6\u30fc\u30b6\u304c\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068 View \u306f Controller \u306b \u901a\u4fe1\u958b\u59cb\u3092\u901a\u77e5\u3057, Controller \u306f Model \u306b\u901a\u4fe1\u958b\u59cb\u3092\u8981\u6c42\u3057\u307e\u3059.\nModel \u306f XMLHttpRequest \u3067\u901a\u4fe1\u3092\u958b\u59cb\u3057, \u5b8c\u4e86\u3057\u305f\u3089 Controller \u306b\u901a\u77e5\u3068\u4e00\u7dd2\u306b\u901a\u4fe1\u5185\u5bb9\u3092\u6e21\u3057\u307e\u3059.\nController \u306f Model \u304b\u3089\u306e\u901a\u4fe1\u5185\u5bb9\u3092 View \u306b\u6e21\u3057, View \u306f\u30c6\u30ad\u30b9\u30c8\u30a8\u30ea\u30a2\u306b\u901a\u4fe1\u5185\u5bb9\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059.\n\n\nmvc-ajax.js\n(function() {\n\n// Main\n\nwindow.onload = function() {\n    var model = new Model();\n    var view = new View();\n    var controller = new Controller();\n\n    model.setController(controller);\n    view.setController(controller);\n\n    controller.setModel(model);\n    controller.setView(view);\n}\n\n// Controller\n// - Model\n// - View\n\nfunction Controller() {\n    this.model_ = {};\n    this.view_ = {};\n}\n\nController.prototype = {\n    setModel: function(model) {\n        this.model_ = model;\n    },\n\n    setView: function(view) {\n        this.view_ = view;\n    },\n\n    noticeStart: function(path) {\n        console.log(\"Controller: Got a start notice\");\n        this.model_.requestRead(path);\n    },\n\n    noticeEndOfRead: function(result) {\n        console.log(\"Controller: Got a end of read notice\");\n        if (result == null) {\n            this.view_.setResult(\"Failed to read\");\n        } else {\n            this.view_.setResult(result);\n        }\n    },\n};\n\n// Model\n// - Controller\n// - Ajax\n\nfunction Model() {\n    this.controller_ = {};\n    this.stream_ = new XMLHttpRequest();\n}\n\nModel.prototype = {\n    setController: function(controller) {\n        this.controller_ = controller;\n    },\n\n    requestRead: function(path) {\n        console.log(\"Model: Got a request of read\");\n        var self = this;\n\n        self.stream_.open(\"GET\", path, true);\n        self.stream_.onload = function() {\n            console.log(\"Model: End of read\");\n            if (self.stream_.readyState === 4 && self.stream_.status == 200) {\n                self.controller_.noticeEndOfRead(self.stream_.responseText);\n            } else {\n                self.controller_.noticeEndOfRead(null);\n            }\n        };\n        self.stream_.send(null);\n    },\n};\n\n// View\n// - Controller\n// - Start button\n// - URL line edit\n// - Result edit\n\nfunction View() {\n    this.controller_ = {};\n\n    this.bttnStart_ = document.createElement(\"input\");\n    this.bttnStart_.type = \"button\";\n    this.bttnStart_.value = \"Start\";\n\n    this.editUrl_ = document.createElement(\"input\");\n    this.editUrl_.type = \"input\";\n    this.editUrl_.value = window.location.href;\n    this.editUrl_.size = \"40\";\n\n    this.editResult_ = document.createElement(\"textarea\");\n    this.editResult_.rows = \"15\";\n    this.editResult_.cols = \"50\";\n\n    this.newLine_ = document.createElement(\"br\");\n\n    this.parent_ = document.getElementsByTagName(\"body\")[0];\n    this.parent_.appendChild(this.editUrl_);\n    this.parent_.appendChild(this.bttnStart_);\n    this.parent_.appendChild(this.newLine_);\n    this.parent_.appendChild(this.editResult_);\n\n    // Set events\n    var self = this;\n\n    self.bttnStart_.addEventListener(\"click\", function() {\n        console.log(\"View: Got a request of start\");\n        var path = self.editUrl_.value;\n        // TODO: Check path\n        self.controller_.noticeStart(path);\n    });\n}\n\nView.prototype = {\n    setController: function(controller) {\n        this.controller_ = controller;\n    },\n\n    setResult: function(result) {\n        console.log(\"View: Set result\");\n        this.editResult_.value = result;\n    },\n};\n\n}());\n\n\n\n\n\u53c2\u8003\nMVC\u30e2\u30c7\u30eb\n\u3053\u308c\u3067\u3067\u304d\u308b\uff01 \u30af\u30ed\u30b9\u30d6\u30e9\u30a6\u30b6JavaScript\u5165\u9580 - \u7b2c12\u56de\u3000XMLHttpRequest\u5165\u9580\n2015/06/25\n\n# MVC\n\nModel View Controller \u3067 MVC.\nAjax \u306e\u7df4\u7fd2\u3082\u517c\u306d\u3066\u66f8\u3044\u3066\u307f\u307e\u3057\u305f.\n\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068 URL \u306e\u5185\u5bb9\u3092\u30c6\u30ad\u30b9\u30c8\u30a8\u30ea\u30a2\u306b\u8868\u793a\u3057\u307e\u3059. \u305d\u308c\u3060\u3051\u3067\u3059.\n\u5909\u306a\u3068\u3053\u308d\u3042\u3063\u305f\u3089\u6559\u3048\u3066\u304f\u3060\u3055\u3044.\n\n1. Model - \u901a\u4fe1\u3092\u62c5\u5f53.\n2. View - UI\u3092\u62c5\u5f53.\n3. Controller - Model \u3068 View \u3092\u4ef2\u4ecb.\n\n\u30e6\u30fc\u30b6\u304c\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068 View \u306f Controller \u306b \u901a\u4fe1\u958b\u59cb\u3092\u901a\u77e5\u3057, Controller \u306f Model \u306b\u901a\u4fe1\u958b\u59cb\u3092\u8981\u6c42\u3057\u307e\u3059.\nModel \u306f XMLHttpRequest \u3067\u901a\u4fe1\u3092\u958b\u59cb\u3057, \u5b8c\u4e86\u3057\u305f\u3089 Controller \u306b\u901a\u77e5\u3068\u4e00\u7dd2\u306b\u901a\u4fe1\u5185\u5bb9\u3092\u6e21\u3057\u307e\u3059.\nController \u306f Model \u304b\u3089\u306e\u901a\u4fe1\u5185\u5bb9\u3092 View \u306b\u6e21\u3057, View \u306f\u30c6\u30ad\u30b9\u30c8\u30a8\u30ea\u30a2\u306b\u901a\u4fe1\u5185\u5bb9\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059.\n  \n  \n![sample.gif](https://qiita-image-store.s3.amazonaws.com/0/41479/757a2934-1fcf-9882-4cbf-f6e5d7bb2bf6.gif)\n  \n  \n```js:mvc-ajax.js\n(function() {\n\n// Main\n\nwindow.onload = function() {\n\tvar model = new Model();\n\tvar view = new View();\n\tvar controller = new Controller();\n\n\tmodel.setController(controller);\n\tview.setController(controller);\n\n\tcontroller.setModel(model);\n\tcontroller.setView(view);\n}\n\n// Controller\n// - Model\n// - View\n\nfunction Controller() {\n\tthis.model_ = {};\n\tthis.view_ = {};\n}\n\nController.prototype = {\n\tsetModel: function(model) {\n\t\tthis.model_ = model;\n\t},\n\n\tsetView: function(view) {\n\t\tthis.view_ = view;\n\t},\n\n\tnoticeStart: function(path) {\n\t\tconsole.log(\"Controller: Got a start notice\");\n\t\tthis.model_.requestRead(path);\n\t},\n\n\tnoticeEndOfRead: function(result) {\n\t\tconsole.log(\"Controller: Got a end of read notice\");\n\t\tif (result == null) {\n\t\t\tthis.view_.setResult(\"Failed to read\");\n\t\t} else {\n\t\t\tthis.view_.setResult(result);\n\t\t}\n\t},\n};\n\n// Model\n// - Controller\n// - Ajax\n\nfunction Model() {\n\tthis.controller_ = {};\n\tthis.stream_ = new XMLHttpRequest();\n}\n\nModel.prototype = {\n\tsetController: function(controller) {\n\t\tthis.controller_ = controller;\n\t},\n\n\trequestRead: function(path) {\n\t\tconsole.log(\"Model: Got a request of read\");\n\t\tvar self = this;\n\n\t\tself.stream_.open(\"GET\", path, true);\n\t\tself.stream_.onload = function() {\n\t\t\tconsole.log(\"Model: End of read\");\n\t\t\tif (self.stream_.readyState === 4 && self.stream_.status == 200) {\n\t\t\t\tself.controller_.noticeEndOfRead(self.stream_.responseText);\n\t\t\t} else {\n\t\t\t\tself.controller_.noticeEndOfRead(null);\n\t\t\t}\n\t\t};\n\t\tself.stream_.send(null);\n\t},\n};\n\n// View\n// - Controller\n// - Start button\n// - URL line edit\n// - Result edit\n\nfunction View() {\n\tthis.controller_ = {};\n\n\tthis.bttnStart_ = document.createElement(\"input\");\n\tthis.bttnStart_.type = \"button\";\n\tthis.bttnStart_.value = \"Start\";\n\n\tthis.editUrl_ = document.createElement(\"input\");\n\tthis.editUrl_.type = \"input\";\n\tthis.editUrl_.value = window.location.href;\n\tthis.editUrl_.size = \"40\";\n\n\tthis.editResult_ = document.createElement(\"textarea\");\n\tthis.editResult_.rows = \"15\";\n\tthis.editResult_.cols = \"50\";\n\n\tthis.newLine_ = document.createElement(\"br\");\n\n\tthis.parent_ = document.getElementsByTagName(\"body\")[0];\n\tthis.parent_.appendChild(this.editUrl_);\n\tthis.parent_.appendChild(this.bttnStart_);\n\tthis.parent_.appendChild(this.newLine_);\n\tthis.parent_.appendChild(this.editResult_);\n\n\t// Set events\n\tvar self = this;\n\n\tself.bttnStart_.addEventListener(\"click\", function() {\n\t\tconsole.log(\"View: Got a request of start\");\n\t\tvar path = self.editUrl_.value;\n\t\t// TODO: Check path\n\t\tself.controller_.noticeStart(path);\n\t});\n}\n\nView.prototype = {\n\tsetController: function(controller) {\n\t\tthis.controller_ = controller;\n\t},\n\n\tsetResult: function(result) {\n\t\tconsole.log(\"View: Set result\");\n\t\tthis.editResult_.value = result;\n\t},\n};\n\n}());\n\n```\n\n## \u53c2\u8003\n\n[MVC\u30e2\u30c7\u30eb](http://www7.ocn.ne.jp/~fishbone/mvc/)\n[\u3053\u308c\u3067\u3067\u304d\u308b\uff01 \u30af\u30ed\u30b9\u30d6\u30e9\u30a6\u30b6JavaScript\u5165\u9580 - \u7b2c12\u56de\u3000XMLHttpRequest\u5165\u9580](http://gihyo.jp/dev/serial/01/crossbrowser-javascript/0012)\n", "tags": ["Chrome", "Ajax", "JavaScript", "mvc", "\u30b3\u30fc\u30c9\u30ec\u30d3\u30e5\u30fc"]}