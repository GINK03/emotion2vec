{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u4e0b\u8a18\u306e\u8a18\u4e8b\u306b\u611f\u5316\u3055\u308c\u3001\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u69cb\u7bc9\u3092 Bash -> Itamae \u306b\u79fb\u884c\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u7b2c\u4e00\u6bb5\u968e\u3068\u3057\u3066\u3001Homebrew\u5468\u308a\u304b\u3089\u624b\u3064\u3051\u3001\u78ba\u8a8d\u306f Serverspec \u3067\u884c\u3044\u307e\u3057\u305f\u3002\n\u53c2\u8003: OSX\u306eHomebrew\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u306e\u3092itamae\u3067\u3084\u308b\u3088\u3046\u306b\u3057\u305f\n5/27\u8ffd\u8a18: \u5c11\u3057\u524d\u306bgem\u30ea\u30ea\u30fc\u30b9\u3057\u305f\u306e\u3067\u3001\u3054\u6d3b\u7528\u304f\u3060\u3055\u3044\nhttps://rubygems.org/gems/itamae-plugin-recipe-homebrew\n\n\u524d\u63d0\u6761\u4ef6\n\nMac\u74b0\u5883\n\n\n\u5b9f\u65bd\n\nGemfile\u3092\u7528\u610f\u3059\u308b\n\nGemfile\nsource \"https://rubygems.org\"\n\ngem \"itamae\"\ngem \"serverspec\"\ngem \"rake\"\n\n# \u4ee5\u4e0b\u306fGuard\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\ngem \"guard-rspec\"\ngem \"terminal-notifier\"\ngem \"terminal-notifier-guard\"\n\n\n\nbundle install\u3059\u308b\n$ bundle install --path vendor/bundle\n\n\n\u30ce\u30fc\u30c9\u3092\u7528\u610f\u3059\u308b 1\n\n\nnodes/local.yml\nbrew:\n  enable_update: false\n  enable_upgrade: false\n  add_repositories:\n    - homebrew/dupes\n    - homebrew/versions\n    - homebrew/binary\n    - peco/peco\n    - motemen/ghq\n  install_packages:\n    - brew-cask\n    - coreutils\n    - findutils\n    - zsh\n    - bash\n    - vim\n    - tmux\n    - git\n    - hub\n    - tig\n    - ghq\n    - imagemagick\n    - wget\n    - rsync\n    - curl\n    - tree\n    - openssl\n    - libyaml\n    - readline\n    - markdown\n    - jq\n    - peco\n    - ctags\n    - z\n    - rbenv\n    - ruby-build\n  install_apps:\n    - atom\n    - alfred\n    - google-chrome\n    - iterm2\n    - skype\n    - slack\n    - virtualbox\n    - vagrant\n    - vagrant-manager\n    - google-japanese-ime\n    - dash\n    - github\n    - dropbox\n    - xtrafinder\n    - appcleaner\n    - caffeine\n\n\n\n\u30ec\u30b7\u30d4\u3092\u7528\u610f\u3059\u308b\n\nrecipes/brew.rb\nBREW_INSTALL_URL = \"https://raw.githubusercontent.com/Homebrew/install/master/install\"\n\n# Update brew\nenable_update = node[\"brew\"][\"enable_update\"] ? node[\"brew\"][\"enable_update\"] : false\nif enable_update\n  execute \"Update brew\" do\n    command \"brew update\"\n  end\nelse\n  Logger.info('Execution skipped Update brew because of not true enable_update')\nend\n\n# Upgrade brew\nenable_upgrade = node[\"brew\"][\"enable_upgrade\"] ? node[\"brew\"][\"enable_upgrade\"] : false\nif enable_upgrade\n  execute \"Upgrade brew\" do\n    command \"brew upgrade\"\n  end\nelse\n  Logger.info('Execution skipped Upgrade brew because of not true enable_upgrade')\nend\n\n# Install brew\nexecute \"Install brew\" do\n  command \"ruby -e \\\"$(curl -fsSL #{BREW_INSTALL_URL})\\\"\"\n  not_if \"test $(which brew)\"\nend\n\n# Add Repository\nnode[\"brew\"][\"add_repositories\"].each do |repo|\n  execute \"Add Repository\" do\n    command \"brew tap #{repo}\"\n    not_if \"brew tap | grep -q '#{repo}'\"\n  end\nend\n\n# Install bin packages\nnode[\"brew\"][\"install_packages\"].each do |package|\n  execute \"Install bin packages\" do\n    command \"brew install #{package}\"\n    not_if \"brew list | grep -q #{package}\"\n  end\nend\n\n# Install apps\nnode[\"brew\"][\"install_apps\"].each do |app|\n  execute \"Install apps\" do\n    command \"brew cask install #{app} --appdir=\\\"/Applications\\\"\"\n    not_if \"brew cask list | grep -q #{app}\"\n  end\nend\n\n# Setup alfred\nexecute \"Setup alfred\" do\n  command \"brew cask alfred link\"\nend\n\n\n\nItamae\u3092\u5b9f\u884c\u3059\u308b 2\n\n$ bundle exec itamae local recipes/brew.rb -y nodes/local.yml -l debug \n\n\n\u78ba\u8a8d\n\nspec\u3092\u7528\u610f\u3059\u308b\n\nspec/localhost/brew_spec.rb\nrequire \"spec_helper\"\nrequire \"yaml\"\n\nnodes_dir_path = File.expand_path(File.dirname(__FILE__) << \"/../../nodes\")\nnode = YAML.load_file(\"#{nodes_dir_path}/local.yml\")\n\ndescribe command \"test $(which brew)\" do\n  its(:exit_status) { should eq 0 }\nend\n\nnode[\"brew\"][\"add_repositories\"].each do |repo|\n  describe command \"brew tap | grep -q '#{repo}'\" do\n    its(:exit_status) { should eq 0 }\n  end\nend\n\nnode[\"brew\"][\"install_packages\"].each do |package|\n  describe command \"brew list | grep -q #{package}\" do\n    its(:exit_status) { should eq 0 }\n  end\nend\n\nnode[\"brew\"][\"install_apps\"].each do |app|\n  describe command \"brew cask list | grep -q #{app}\" do\n    its(:exit_status) { should eq 0 }\n  end\nend\n\n\n\nServerspec\u3092\u5b9f\u884c\u3059\u308b\nbundle exec rake spec\n\n\n\u5099\u8003\n\u90fd\u5ea6\u78ba\u8a8d\u3057\u306a\u304c\u3089\u9032\u3081\u308b\u5834\u5408\u306f Guard \u3092\u8d77\u52d5\u3057\u3066\u304a\u304f\u3068\u3001\u308f\u3056\u308f\u3056\u30b3\u30de\u30f3\u30c9\u3092\u53e9\u304b\u306a\u304f\u3066\u3082Serverspec\u304c\u8d70\u308b\u306e\u3067\u6357\u308a\u307e\u3059\u3002\u4e00\u5fdcGuardfile\u3068\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u3092\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\u3053\u306e\u8fba\u308a\u306f\u3001\u30b5\u30fc\u30d0/\u30a4\u30f3\u30d5\u30e9\u5fb9\u5e95\u653b\u7565\u3092\u5408\u308f\u305b\u3066\u8aad\u3093\u3067\u304a\u304f\u3068\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\nGuardfile\nguard :rspec, cmd: 'bundle exec rspec' do\n  watch(%r{^spec/.+_spec\\.rb$})\n  watch('spec/spec_helper.rb')  { \"spec\" }\nend\n\n\n\nguard\u306e\u5b9f\u884c\n$ bundle exec guard\n\n\n\n\u6700\u7d42\u7684\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\n$ tree .\n.\n\u251c\u2500\u2500 Gemfile\n\u251c\u2500\u2500 Gemfile.lock\n\u251c\u2500\u2500 Guardfile\n\u251c\u2500\u2500 Rakefile\n\u251c\u2500\u2500 nodes\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 local.yml\n\u251c\u2500\u2500 recipes\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 brew.rb\n\u251c\u2500\u2500 spec\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 localhost\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 brew_spec.rb\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 spec_helper.rb\n\u2514\u2500\u2500 vendor\n    \u2514\u2500\u2500 bundle\n\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\nhttps://github.com/fukuiretu/fukuiretu-sandbox/tree/master/local_setup\n\n\u304a\u308f\u308a\u306b\n\nItamae, Serverspec\u6700\u9ad8\n\nServerspec\u672c\u8aad\u3093\u3067\u304a\u304f\u3068\u8272\u3005\u826f\u3055\u305d\u3046\uff08\u304b\u304f\u3044\u3046\u81ea\u5206\u3082\u8cb7\u3063\u305f\u3051\u3069\u307e\u3060\u8aad\u4e86\u3067\u304d\u3066\u306a\u3044\u3067\u3059\uff09\n\u4eca\u56de\u306fexecute\u30ea\u30bd\u30fc\u30b9\u3057\u304b\u4f7f\u7528\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001Itamae\u306b\u4ed6\u306b\u3069\u3093\u306a\u30ea\u30bd\u30fc\u30b9\u304c\u3042\u308b\u306e\u304b\u77e5\u308a\u305f\u3044\u5834\u5408\u306f\u3001\u5408\u308f\u305b\u3066\u4ee5\u524d\u79c1\u304c\u30dd\u30b9\u30c8\u3057\u305fItamae\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\u3082\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\n\u6b21\u306fzsh\u5468\u308a\u306e\u8a2d\u5b9a\u3092Itamae\u306b\u79fb\u884c\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\n\n\n\n\n\n\u30ce\u30fc\u30c9\u306fjson\u3067\u3082\u5b9a\u7fa9\u53ef\u80fd\u3067\u3059\u00a0\u21a9\n\n\n-l debug\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u597d\u307f\u3067\u00a0\u21a9\n\n\n\n# \u306f\u3058\u3081\u306b\n\u4e0b\u8a18\u306e\u8a18\u4e8b\u306b\u611f\u5316\u3055\u308c\u3001\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u69cb\u7bc9\u3092 Bash -> [**Itamae**](http://itamae.kitchen/) \u306b\u79fb\u884c\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u7b2c\u4e00\u6bb5\u968e\u3068\u3057\u3066\u3001[Homebrew](http://brew.sh/index_ja.html)\u5468\u308a\u304b\u3089\u624b\u3064\u3051\u3001\u78ba\u8a8d\u306f [**Serverspec**](http://serverspec.org/) \u3067\u884c\u3044\u307e\u3057\u305f\u3002\n\n\u53c2\u8003: [OSX\u306eHomebrew\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u306e\u3092itamae\u3067\u3084\u308b\u3088\u3046\u306b\u3057\u305f](http://sugamasao.hatenablog.com/entry/2015/01/11/163243)\n\n5/27\u8ffd\u8a18: \u5c11\u3057\u524d\u306bgem\u30ea\u30ea\u30fc\u30b9\u3057\u305f\u306e\u3067\u3001\u3054\u6d3b\u7528\u304f\u3060\u3055\u3044\nhttps://rubygems.org/gems/itamae-plugin-recipe-homebrew\n\n\n# \u524d\u63d0\u6761\u4ef6\n* Mac\u74b0\u5883\n\n\n\n# \u5b9f\u65bd\n### Gemfile\u3092\u7528\u610f\u3059\u308b\n\n```ruby:Gemfile\nsource \"https://rubygems.org\"\n\ngem \"itamae\"\ngem \"serverspec\"\ngem \"rake\"\n\n# \u4ee5\u4e0b\u306fGuard\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\ngem \"guard-rspec\"\ngem \"terminal-notifier\"\ngem \"terminal-notifier-guard\"\n```\n\n### bundle install\u3059\u308b\n\n```bash\n$ bundle install --path vendor/bundle\n```\n\n### \u30ce\u30fc\u30c9\u3092\u7528\u610f\u3059\u308b [^1]\n\n[^1]: \u30ce\u30fc\u30c9\u306fjson\u3067\u3082\u5b9a\u7fa9\u53ef\u80fd\u3067\u3059\n\n```yaml:nodes/local.yml\nbrew:\n  enable_update: false\n  enable_upgrade: false\n  add_repositories:\n    - homebrew/dupes\n    - homebrew/versions\n    - homebrew/binary\n    - peco/peco\n    - motemen/ghq\n  install_packages:\n    - brew-cask\n    - coreutils\n    - findutils\n    - zsh\n    - bash\n    - vim\n    - tmux\n    - git\n    - hub\n    - tig\n    - ghq\n    - imagemagick\n    - wget\n    - rsync\n    - curl\n    - tree\n    - openssl\n    - libyaml\n    - readline\n    - markdown\n    - jq\n    - peco\n    - ctags\n    - z\n    - rbenv\n    - ruby-build\n  install_apps:\n    - atom\n    - alfred\n    - google-chrome\n    - iterm2\n    - skype\n    - slack\n    - virtualbox\n    - vagrant\n    - vagrant-manager\n    - google-japanese-ime\n    - dash\n    - github\n    - dropbox\n    - xtrafinder\n    - appcleaner\n    - caffeine\n```\n\n\n\n### \u30ec\u30b7\u30d4\u3092\u7528\u610f\u3059\u308b\n\n```ruby:recipes/brew.rb\nBREW_INSTALL_URL = \"https://raw.githubusercontent.com/Homebrew/install/master/install\"\n\n# Update brew\nenable_update = node[\"brew\"][\"enable_update\"] ? node[\"brew\"][\"enable_update\"] : false\nif enable_update\n  execute \"Update brew\" do\n    command \"brew update\"\n  end\nelse\n  Logger.info('Execution skipped Update brew because of not true enable_update')\nend\n\n# Upgrade brew\nenable_upgrade = node[\"brew\"][\"enable_upgrade\"] ? node[\"brew\"][\"enable_upgrade\"] : false\nif enable_upgrade\n  execute \"Upgrade brew\" do\n    command \"brew upgrade\"\n  end\nelse\n  Logger.info('Execution skipped Upgrade brew because of not true enable_upgrade')\nend\n\n# Install brew\nexecute \"Install brew\" do\n  command \"ruby -e \\\"$(curl -fsSL #{BREW_INSTALL_URL})\\\"\"\n  not_if \"test $(which brew)\"\nend\n\n# Add Repository\nnode[\"brew\"][\"add_repositories\"].each do |repo|\n  execute \"Add Repository\" do\n    command \"brew tap #{repo}\"\n    not_if \"brew tap | grep -q '#{repo}'\"\n  end\nend\n\n# Install bin packages\nnode[\"brew\"][\"install_packages\"].each do |package|\n  execute \"Install bin packages\" do\n    command \"brew install #{package}\"\n    not_if \"brew list | grep -q #{package}\"\n  end\nend\n\n# Install apps\nnode[\"brew\"][\"install_apps\"].each do |app|\n  execute \"Install apps\" do\n    command \"brew cask install #{app} --appdir=\\\"/Applications\\\"\"\n    not_if \"brew cask list | grep -q #{app}\"\n  end\nend\n\n# Setup alfred\nexecute \"Setup alfred\" do\n  command \"brew cask alfred link\"\nend\n```\n\n### Itamae\u3092\u5b9f\u884c\u3059\u308b [^2]\n\n[^2]: `-l debug`\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u597d\u307f\u3067\n\n```bash\n$ bundle exec itamae local recipes/brew.rb -y nodes/local.yml -l debug \n```\n\n\n\n# \u78ba\u8a8d\n### spec\u3092\u7528\u610f\u3059\u308b\n\n```ruby:spec/localhost/brew_spec.rb\nrequire \"spec_helper\"\nrequire \"yaml\"\n\nnodes_dir_path = File.expand_path(File.dirname(__FILE__) << \"/../../nodes\")\nnode = YAML.load_file(\"#{nodes_dir_path}/local.yml\")\n\ndescribe command \"test $(which brew)\" do\n  its(:exit_status) { should eq 0 }\nend\n\nnode[\"brew\"][\"add_repositories\"].each do |repo|\n  describe command \"brew tap | grep -q '#{repo}'\" do\n    its(:exit_status) { should eq 0 }\n  end\nend\n\nnode[\"brew\"][\"install_packages\"].each do |package|\n  describe command \"brew list | grep -q #{package}\" do\n    its(:exit_status) { should eq 0 }\n  end\nend\n\nnode[\"brew\"][\"install_apps\"].each do |app|\n  describe command \"brew cask list | grep -q #{app}\" do\n    its(:exit_status) { should eq 0 }\n  end\nend\n```\n\n### Serverspec\u3092\u5b9f\u884c\u3059\u308b\n```bash\nbundle exec rake spec\n```\n\n##### \u5099\u8003\n\u90fd\u5ea6\u78ba\u8a8d\u3057\u306a\u304c\u3089\u9032\u3081\u308b\u5834\u5408\u306f [**Guard**](https://github.com/guard/guard) \u3092\u8d77\u52d5\u3057\u3066\u304a\u304f\u3068\u3001\u308f\u3056\u308f\u3056\u30b3\u30de\u30f3\u30c9\u3092\u53e9\u304b\u306a\u304f\u3066\u3082Serverspec\u304c\u8d70\u308b\u306e\u3067\u6357\u308a\u307e\u3059\u3002\u4e00\u5fdcGuardfile\u3068\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u3092\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\u3053\u306e\u8fba\u308a\u306f\u3001[\u30b5\u30fc\u30d0/\u30a4\u30f3\u30d5\u30e9\u5fb9\u5e95\u653b\u7565](http://gihyo.jp/book/2014/978-4-7741-6768-8)\u3092\u5408\u308f\u305b\u3066\u8aad\u3093\u3067\u304a\u304f\u3068\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n```ruby:Guardfile\nguard :rspec, cmd: 'bundle exec rspec' do\n  watch(%r{^spec/.+_spec\\.rb$})\n  watch('spec/spec_helper.rb')  { \"spec\" }\nend\n```\n\n```bash:guard\u306e\u5b9f\u884c\n$ bundle exec guard\n```\n\n\n\n# \u6700\u7d42\u7684\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\n```bash\n$ tree .\n.\n\u251c\u2500\u2500 Gemfile\n\u251c\u2500\u2500 Gemfile.lock\n\u251c\u2500\u2500 Guardfile\n\u251c\u2500\u2500 Rakefile\n\u251c\u2500\u2500 nodes\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 local.yml\n\u251c\u2500\u2500 recipes\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 brew.rb\n\u251c\u2500\u2500 spec\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 localhost\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 brew_spec.rb\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 spec_helper.rb\n\u2514\u2500\u2500 vendor\n    \u2514\u2500\u2500 bundle\n```\n\n\n\n# \u30ea\u30dd\u30b8\u30c8\u30ea\nhttps://github.com/fukuiretu/fukuiretu-sandbox/tree/master/local_setup\n\n\n\n# \u304a\u308f\u308a\u306b\n* Itamae, Serverspec\u6700\u9ad8\n* [Serverspec\u672c](http://www.oreilly.co.jp/books/9784873117096/)\u8aad\u3093\u3067\u304a\u304f\u3068\u8272\u3005\u826f\u3055\u305d\u3046\uff08\u304b\u304f\u3044\u3046\u81ea\u5206\u3082\u8cb7\u3063\u305f\u3051\u3069\u307e\u3060\u8aad\u4e86\u3067\u304d\u3066\u306a\u3044\u3067\u3059:bow:\uff09\n* \u4eca\u56de\u306f`execute`\u30ea\u30bd\u30fc\u30b9\u3057\u304b\u4f7f\u7528\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001Itamae\u306b\u4ed6\u306b\u3069\u3093\u306a\u30ea\u30bd\u30fc\u30b9\u304c\u3042\u308b\u306e\u304b\u77e5\u308a\u305f\u3044\u5834\u5408\u306f\u3001\u5408\u308f\u305b\u3066\u4ee5\u524d\u79c1\u304c\u30dd\u30b9\u30c8\u3057\u305f[Itamae\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8](http://qiita.com/r82/items/170aa956731f2ffb5715)\u3082\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\n* \u6b21\u306fzsh\u5468\u308a\u306e\u8a2d\u5b9a\u3092Itamae\u306b\u79fb\u884c\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\n", "tags": ["serverspec", "homebrew", "itamae"]}