{"context": " More than 1 year has passed since last update.HTTPS\u30aa\u30f3\u30ea\u30fc\u306eRails\u306e\u30a2\u30d7\u30ea\uff08Redmin\u306a\u3069\uff09\u3067Apache\u3092\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u306b\u3057\u305f\u5834\u5408\u3001\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u304cHTTP\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002\u3002\u3002\n\u3053\u308c\u3092\u5bfe\u51e6\u3059\u308b\u306b\u306fRequestHeader\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067Apache\u304b\u3089\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u3078\u306eX_FORWARDED_PROTO\u30d8\u30c3\u30c0\u3092\u4ed8\u4e0e\u3055\u305b\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\nApache\u306e\u5834\u5408\nRequestHeader set X_FORWARDED_PROTO 'https'\n\u8a2d\u5b9a\u4f8b\uff09\n\nApache\u3067Redmin\u306e\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7HTTPS\u30aa\u30f3\u30ea\u30fc\u306b\u3059\u308b\n<VirtualHost *:443>\n    # SSL \u306e\u7d30\u304b\u3044\u8a2d\u5b9a\uff08\uff3e\uff3e\uff1b\n    RequestHeader set X_FORWARDED_PROTO 'https'\n    ProxyPass /rails http://localhost:3000/rails\n    ProxyPassReverse /rails http://localhost:3000/rails\n</VirtualHost>\n\n\n\u53c2\u8003\nhttp://webos-goodies.jp/archives/51261261.html\n\nNginx\u306e\u5834\u5408\nproxy_set_header X-Forwarded-Proto https;\n\u8a2d\u5b9a\u4f8b)\nupstream backend {\n  server unix:/data/apps/current/tmp/sockets/unicorn.sock max_fails=3 fail_timeout=10s;\n}\n location / {\n    proxy_set_header Host $http_host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-Host $host;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto https;\n    if (!-f $request_filename) { proxy_pass http://backend; }\n  }\n\n\u53c2\u8003\nnginx \u3067 SSL\u89e3\u304d\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u306a\u8a2d\u5b9a\u306e\u304a\u4f5c\u6cd5 - Qiita\nHTTPS\u30aa\u30f3\u30ea\u30fc\u306eRails\u306e\u30a2\u30d7\u30ea\uff08Redmin\u306a\u3069\uff09\u3067Apache\u3092\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u306b\u3057\u305f\u5834\u5408\u3001\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u304cHTTP\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002\u3002\u3002\n\n\u3053\u308c\u3092\u5bfe\u51e6\u3059\u308b\u306b\u306fRequestHeader\u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067Apache\u304b\u3089\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u3078\u306eX_FORWARDED_PROTO\u30d8\u30c3\u30c0\u3092\u4ed8\u4e0e\u3055\u305b\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\nApache\u306e\u5834\u5408\n------------------------------------\n\n**RequestHeader set X_FORWARDED_PROTO 'https'**\n\n\u8a2d\u5b9a\u4f8b\uff09\n\n```shell:Apache\u3067Redmin\u306e\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7HTTPS\u30aa\u30f3\u30ea\u30fc\u306b\u3059\u308b\n<VirtualHost *:443>\n    # SSL \u306e\u7d30\u304b\u3044\u8a2d\u5b9a\uff08\uff3e\uff3e\uff1b\n    RequestHeader set X_FORWARDED_PROTO 'https'\n    ProxyPass /rails http://localhost:3000/rails\n    ProxyPassReverse /rails http://localhost:3000/rails\n</VirtualHost>\n```\n\n\u53c2\u8003\n[http://webos-goodies.jp/archives/51261261.html](http://webos-goodies.jp/archives/51261261.html)\n\n\nNginx\u306e\u5834\u5408\n----------------------------------\n\n**proxy_set_header X-Forwarded-Proto https;**\n\n\u8a2d\u5b9a\u4f8b)\n\n```\nupstream backend {\n  server unix:/data/apps/current/tmp/sockets/unicorn.sock max_fails=3 fail_timeout=10s;\n}\n location / {\n    proxy_set_header Host $http_host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-Host $host;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto https;\n    if (!-f $request_filename) { proxy_pass http://backend; }\n  }\n```\n\n\u53c2\u8003\n[nginx \u3067 SSL\u89e3\u304d\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u306a\u8a2d\u5b9a\u306e\u304a\u4f5c\u6cd5 - Qiita](http://qiita.com/ywatai@github/items/a179186a458a42b3c7f0)\n", "tags": ["Apache", "Rails", "Redmine", "nginx"]}