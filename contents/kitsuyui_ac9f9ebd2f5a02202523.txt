{"tags": ["JavaScript", "jXA", "AppleScript", "OSX"], "context": " More than 1 year has passed since last update.\u6700\u8fd1 YouTube \u3067\u52d5\u753b\u3092\u898b\u59cb\u3081\u305f\u3089 iTunes \u3092\u6b62\u3081\u305f\u3044\uff01\n\u3068\u601d\u3063\u305f\u306e\u3067\u3001 JXA \u3067\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u307f\u305f\u3002\n\u3082\u3061\u308d\u3093\u9006\u306b\u3001 YouTube \u3067\u518d\u751f\u4e2d\u3067\u306a\u3044\u5834\u5408\u306f iTunes \u3092\u518d\u751f\u3057\u59cb\u3081\u308b\u3002\n\nautotunes\n#!/usr/bin/env osascript -l JavaScript\n\nvar executeJS = {\n    // http://qiita.com/zakuroishikuro/items/194223d63b0f95ab7a63\n    'Google Chrome': function (app, tab, fnStr) {\n        return app.execute(tab, {'javascript': fnStr});\n    },\n    'Safari': function (app, tab, fn) {\n        return app.doJavaScript(fnStr, {'in': tab});\n    }\n};\n\nfunction main () {\n    var iTunes = Application('iTunes');\n    if (someAppYouTubePlaying()) {\n        iTunes.stop();\n    } else {\n        iTunes.play();\n    }\n}\n\nmain();\n\nfunction someAppYouTubePlaying() {\n    var browserNames = Object.keys(executeJS);\n    return selectActiveApps(browserNames).some(function (app) {\n        return app.windows().some(function (window) {\n            return window.tabs().some(function (tab) {\n                return youtubePlaying(app, window, tab);\n            });\n        });\n    });\n}\n\nfunction selectActiveApps(appNames) {\n    var se = Application('System Events');\n    return se.processes().reduce(function (actives, app) {\n        var appName = app.name();\n        if (appNames.indexOf(appName) > -1) {\n            actives.push(Application(appName));\n        }\n        return actives;\n    }, []);\n}\n\nfunction youtubePlaying(app, window, tab) {\n    var js = '(' + isYoutubePlaying.toString() + ')();';\n    return executeJS[app.name()](app, tab, js); \n}\n\nfunction isYoutubePlaying() {\n    // This function will be running on browser (client side JS).\n    // https://developers.google.com/youtube/js_api_reference\n    const STOP = 0;\n    const PAUSE = 2;\n    if (!String(window.location).match(/https?:\\/\\/www\\.youtube\\.com/)) {\n        return false;\n    }\n    var player = document.getElementById('movie_player');\n    if (!player) {\n        return false;\n    }\n    if ([STOP, PAUSE].indexOf(player.getPlayerState()) > -1) {\n        return false;\n    }\n    return true;\n}\n\n\n\n\u4f7f\u3044\u65b9\n\u5b9f\u884c\u6a29\u9650\u3092\u3064\u3051\u3066\u5b9f\u884c\u3059\u308b\u3060\u3051\u3002\n$ chmod +x ./autotunes\n$ ./autotunes\n\n\u81ea\u5206\u306f\u3001\u3053\u308c\u3092\u3055\u3089\u306b\u5b9a\u671f\u7684\u306b\u5b9f\u884c\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u306b\u3001\u30d1\u30b9\u3092\u901a\u3057\u3066\n\u3053\u3093\u306a\u611f\u3058\u306e Bash \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u3066\u3001\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3002\n1 \u79d2\u304a\u304d\u3002\n#!/usr/bin/env bash\nset -euo pipefail\n\nwhile sleep 1\ndo\n    autotunes\ndone\n\nSafari \u3068 Google Chrome \u3067\u306e\u5dee\u7570\u306e\u5438\u53ce\u306f\u2193\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u3002\nJXA\u3067Safari, Chrome, Firefox\u3092\u64cd\u4f5c\u3059\u308b\u969b\u306e\u9055\u3044\n\u5de5\u592b\u6b21\u7b2c\u3067\u4ed6\u306e\u30d6\u30e9\u30a6\u30b6\u3084\u4ed6\u306e\u52d5\u753b\u518d\u751f\u30b5\u30a4\u30c8\u30fb\u4ed6\u306e\u97f3\u58f0\u30d7\u30ec\u30a4\u30e4\u30fc\u3067\u3082\u3067\u304d\u308b\uff08\u305f\u3076\u3093\uff09\u2026\u2026\uff01\n\u6700\u8fd1 YouTube \u3067\u52d5\u753b\u3092\u898b\u59cb\u3081\u305f\u3089 iTunes \u3092\u6b62\u3081\u305f\u3044\uff01\n\u3068\u601d\u3063\u305f\u306e\u3067\u3001 JXA \u3067\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u307f\u305f\u3002\n\n\u3082\u3061\u308d\u3093\u9006\u306b\u3001 YouTube \u3067\u518d\u751f\u4e2d\u3067\u306a\u3044\u5834\u5408\u306f iTunes \u3092\u518d\u751f\u3057\u59cb\u3081\u308b\u3002\n\n```javascript:autotunes\n#!/usr/bin/env osascript -l JavaScript\n\nvar executeJS = {\n    // http://qiita.com/zakuroishikuro/items/194223d63b0f95ab7a63\n    'Google Chrome': function (app, tab, fnStr) {\n        return app.execute(tab, {'javascript': fnStr});\n    },\n    'Safari': function (app, tab, fn) {\n        return app.doJavaScript(fnStr, {'in': tab});\n    }\n};\n\nfunction main () {\n    var iTunes = Application('iTunes');\n    if (someAppYouTubePlaying()) {\n        iTunes.stop();\n    } else {\n        iTunes.play();\n    }\n}\n\nmain();\n\nfunction someAppYouTubePlaying() {\n    var browserNames = Object.keys(executeJS);\n    return selectActiveApps(browserNames).some(function (app) {\n        return app.windows().some(function (window) {\n            return window.tabs().some(function (tab) {\n                return youtubePlaying(app, window, tab);\n            });\n        });\n    });\n}\n\nfunction selectActiveApps(appNames) {\n    var se = Application('System Events');\n    return se.processes().reduce(function (actives, app) {\n        var appName = app.name();\n        if (appNames.indexOf(appName) > -1) {\n            actives.push(Application(appName));\n        }\n        return actives;\n    }, []);\n}\n\nfunction youtubePlaying(app, window, tab) {\n    var js = '(' + isYoutubePlaying.toString() + ')();';\n    return executeJS[app.name()](app, tab, js); \n}\n\nfunction isYoutubePlaying() {\n    // This function will be running on browser (client side JS).\n    // https://developers.google.com/youtube/js_api_reference\n    const STOP = 0;\n    const PAUSE = 2;\n    if (!String(window.location).match(/https?:\\/\\/www\\.youtube\\.com/)) {\n        return false;\n    }\n    var player = document.getElementById('movie_player');\n    if (!player) {\n        return false;\n    }\n    if ([STOP, PAUSE].indexOf(player.getPlayerState()) > -1) {\n        return false;\n    }\n    return true;\n}\n```\n\n# \u4f7f\u3044\u65b9\n\n\u5b9f\u884c\u6a29\u9650\u3092\u3064\u3051\u3066\u5b9f\u884c\u3059\u308b\u3060\u3051\u3002\n\n```shell-session\n$ chmod +x ./autotunes\n$ ./autotunes\n```\n\n\u81ea\u5206\u306f\u3001\u3053\u308c\u3092\u3055\u3089\u306b\u5b9a\u671f\u7684\u306b\u5b9f\u884c\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u306b\u3001\u30d1\u30b9\u3092\u901a\u3057\u3066\n\u3053\u3093\u306a\u611f\u3058\u306e Bash \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u3066\u3001\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3002\n1 \u79d2\u304a\u304d\u3002\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nwhile sleep 1\ndo\n    autotunes\ndone\n```\n\nSafari \u3068 Google Chrome \u3067\u306e\u5dee\u7570\u306e\u5438\u53ce\u306f\u2193\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u3002\n[JXA\u3067Safari, Chrome, Firefox\u3092\u64cd\u4f5c\u3059\u308b\u969b\u306e\u9055\u3044](http://qiita.com/zakuroishikuro/items/194223d63b0f95ab7a63)\n\n\n\u5de5\u592b\u6b21\u7b2c\u3067\u4ed6\u306e\u30d6\u30e9\u30a6\u30b6\u3084\u4ed6\u306e\u52d5\u753b\u518d\u751f\u30b5\u30a4\u30c8\u30fb\u4ed6\u306e\u97f3\u58f0\u30d7\u30ec\u30a4\u30e4\u30fc\u3067\u3082\u3067\u304d\u308b\uff08\u305f\u3076\u3093\uff09\u2026\u2026\uff01\n"}