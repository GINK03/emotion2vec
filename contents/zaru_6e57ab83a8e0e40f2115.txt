{"tags": ["jQuery", "jsonp", "JSON"], "context": " More than 1 year has passed since last update.\u5fd8\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u307e\u3068\u3081\u3066\u304a\u304f\u3002\n\n\u6c17\u3092\u3064\u3051\u308b\u3053\u3068\n\n\u57fa\u672c\u7684\u306b jsonp \u3067\u3042\u308c\u3070\u52d5\u304f\njson + \u30e2\u30c0\u30f3\u30d6\u30e9\u30a6\u30b6\u306f\u3001Access-Control-Allow-Origin\u3092\u8a2d\u5b9a\u3059\u308c\u3070\u52d5\u304f\njson + IE8,9\u3067\u306f\u3001XDomainRequest\u3092\u4f7f\u3048\u3070\u52d5\u304f\nIE6,7\u306f\u6b7b\u4ea1\uff08\u3082\u3046\u3044\u3044\u3088\u306d\uff09\n\u30d7\u30ed\u30c8\u30b3\u30eb(http|https) / FQDN / \u30dd\u30fc\u30c8\u756a\u53f7\u3001\u3044\u305a\u308c\u304b\u304c\u9055\u3046\u5834\u5408\u3001\u30af\u30ed\u30b9\u30c9\u30e1\u30a4\u30f3\nBASIC\u8a8d\u8a3c\u304c\u3042\u308b\u3068\u3001\u5225\u9014\u5bfe\u5fdc\u304c\u5fc5\u8981\uff08\u5f8c\u8ff0\uff09\n\n\nJSON\u7de8\n\n\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\njson\u3092\u8fd4\u3059\u30b5\u30fc\u30d0\u5074\u306bAccess-Control-Allow-Origin\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n<?php\n    header('Access-Control-Allow-Origin: *');\n    header('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept');\n\n    // CakePHP\u306e\u5834\u5408\n    $this->header('Access-Control-Allow-Origin: *');\n    $this->header('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept');\n\n\nBASIC\u8a8d\u8a3c\u3092\u3057\u3066\u3044\u308b\u5834\u5408\n\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u8a31\u53ef\u3059\u308b\u3068\u3044\u3051\u308b\u304c\u3001Origin\u306b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306f\u6307\u5b9a\u3067\u304d\u306a\u3044\u3002\n<?php\n    header('Access-Control-Allow-Origin: http://example.com');\n    header('Access-Allow-Control-Credentials: true');\n    header('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept, Authorization');\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\n\njQuery\u7248\n\najax.js\n// IE8,9\u3067XMLHttpRequest\u306e\u4ee3\u308f\u308a\u306bXDomainRequest\u3092\u4f7f\u3046\n(function( jQuery ) {\n\nif ( window.XDomainRequest ) {\n    jQuery.ajaxTransport(function( s ) {\n        if ( s.crossDomain && s.async ) {\n            if ( s.timeout ) {\n                s.xdrTimeout = s.timeout;\n                delete s.timeout;\n            }\n            var xdr;\n            return {\n                send: function( _, complete ) {\n                    function callback( status, statusText, responses, responseHeaders ) {\n                        xdr.onload = xdr.onerror = xdr.ontimeout = xdr.onprogress = jQuery.noop;\n                        xdr = undefined;\n                        complete( status, statusText, responses, responseHeaders );\n                    }\n                    xdr = new XDomainRequest();\n                    xdr.open( s.type, s.url );\n                    xdr.onload = function() {\n                        callback( 200, \"OK\", { text: xdr.responseText }, \"Content-Type: \" + xdr.contentType );\n                    };\n                    xdr.onerror = function() {\n                        callback( 404, \"Not Found\" );\n                    };\n                    xdr.onprogress = function() {};\n                    if ( s.xdrTimeout ) {\n                        xdr.ontimeout = function() {\n                            callback( 0, \"timeout\" );\n                        };\n                        xdr.timeout = s.xdrTimeout;\n                    }\n                    xdr.send( ( s.hasContent && s.data ) || null );\n                },\n                abort: function() {\n                    if ( xdr ) {\n                        xdr.onerror = jQuery.noop();\n                        xdr.abort();\n                    }\n                }\n            };\n        }\n    });\n}\n})( jQuery );\n\njQuery.getJSON('http://example.com/search.json',\n    {\n        'hoge': 'piyo'\n    },\n    function (data) {\n        console.log(data);\n    }\n});\n\n\n\u53c2\u7167 : https://github.com/tlianza/ajaxHooks/blob/master/src/ajax/xdr.js\n\nJavaScript\u7248\n\najax.js\nfunction createCORSRequest(method, url) {\n    var xhr = new XMLHttpRequest();\n    if (\"withCredentials\" in xhr) {\n        xhr.open(method, url, true);\n    } else if (typeof XDomainRequest != \"undefined\") {\n        xhr = new XDomainRequest();\n        xhr.open(method, url);\n    } else {\n        xhr = null;\n    }\n    return xhr;\n}\n\nvar xhr = createCORSRequest('GET', 'http://example.com/search.json');\nif (!xhr) {\n    throw new Error('CORS not supported');\n}\nxhr.onload = function(){};\nxhr.onerror = function(){};\nxhr.send();\n\n\n\u53c2\u7167 : http://www.html5rocks.com/en/tutorials/cors/\n\nJSONP\u7de8\njsonp\u306e\u5834\u5408\u3001\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u3067\u306fjsonp\u5f62\u5f0f\u3067\u8fd4\u3059\u3060\u3051\u3067\u7279\u306b\u8a2d\u5b9a\u306f\u5fc5\u8981\u306a\u3044\u3002\u305f\u3060\u3057\u3001json\u3068\u9055\u3044JavaScript\u306e\u30b3\u30fc\u30c9\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u3067\u76f4\u63a5\u5b9f\u884c\u3059\u308b\u305f\u3081\u3001jsonp\u306e\u63d0\u4f9bAPI\u306b\u60aa\u610f\u306e\u3042\u308b\u30b3\u30fc\u30c9\u304c\u542b\u307e\u308c\u3066\u3044\u305f\u5834\u5408\u306f\u6050\u308d\u3057\u3044\u3053\u3068\u306b\u306a\u308b\u3002callback\u3067\u6307\u5b9a\u3067\u304d\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5236\u9650\u3059\u308b\u306a\u3069\u3001\u3042\u308b\u7a0b\u5ea6\u306e\u5de5\u592b\u304c\u5fc5\u8981\u3002\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\n\njQuery\u7248\n\najax.js\njQuery.getJSON('http://example.com/search.json?callback=?',\n    {\n        'hoge': 'piyo'\n    },\n    function (data) {\n        console.log(data);\n    }\n});\n\n\ncalback=?\u3068\u3059\u308b\u3053\u3068\u3067\u3001jQuery\u304c\u52dd\u624b\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u540d\u3092\u751f\u6210\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304f\u308c\u308b\u3002\n\nJavaScript\u7248\n\najax.js\nvar target = document.createElement('script');\ntarget.charset = 'utf-8';\ntarget.src = 'http://example.com/search.json?callback=hoge';\ndocument.body.appendChild(target);\n\nfunction hoge(result) {\n    console.log(result);\n}\n\n\n\n\u5fd8\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u307e\u3068\u3081\u3066\u304a\u304f\u3002\n\n# \u6c17\u3092\u3064\u3051\u308b\u3053\u3068\n\n- \u57fa\u672c\u7684\u306b jsonp \u3067\u3042\u308c\u3070\u52d5\u304f\n- json + \u30e2\u30c0\u30f3\u30d6\u30e9\u30a6\u30b6\u306f\u3001Access-Control-Allow-Origin\u3092\u8a2d\u5b9a\u3059\u308c\u3070\u52d5\u304f\n- json + IE8,9\u3067\u306f\u3001XDomainRequest\u3092\u4f7f\u3048\u3070\u52d5\u304f\n- IE6,7\u306f\u6b7b\u4ea1\uff08\u3082\u3046\u3044\u3044\u3088\u306d\uff09\n- \u30d7\u30ed\u30c8\u30b3\u30eb(http|https) / FQDN / \u30dd\u30fc\u30c8\u756a\u53f7\u3001\u3044\u305a\u308c\u304b\u304c\u9055\u3046\u5834\u5408\u3001\u30af\u30ed\u30b9\u30c9\u30e1\u30a4\u30f3\n- BASIC\u8a8d\u8a3c\u304c\u3042\u308b\u3068\u3001\u5225\u9014\u5bfe\u5fdc\u304c\u5fc5\u8981\uff08\u5f8c\u8ff0\uff09\n\n# JSON\u7de8\n\n## \u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\n\njson\u3092\u8fd4\u3059\u30b5\u30fc\u30d0\u5074\u306bAccess-Control-Allow-Origin\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n```php\n<?php\n\theader('Access-Control-Allow-Origin: *');\n\theader('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept');\n\n\t// CakePHP\u306e\u5834\u5408\n\t$this->header('Access-Control-Allow-Origin: *');\n\t$this->header('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept');\n```\n\n### BASIC\u8a8d\u8a3c\u3092\u3057\u3066\u3044\u308b\u5834\u5408\n\n\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u8a31\u53ef\u3059\u308b\u3068\u3044\u3051\u308b\u304c\u3001Origin\u306b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306f\u6307\u5b9a\u3067\u304d\u306a\u3044\u3002\n\n```php\n<?php\n\theader('Access-Control-Allow-Origin: http://example.com');\n\theader('Access-Allow-Control-Credentials: true');\n\theader('Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept, Authorization');\n```\n\n\n## \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\n\n### jQuery\u7248\n\n```ajax.js\n// IE8,9\u3067XMLHttpRequest\u306e\u4ee3\u308f\u308a\u306bXDomainRequest\u3092\u4f7f\u3046\n(function( jQuery ) {\n\nif ( window.XDomainRequest ) {\n\tjQuery.ajaxTransport(function( s ) {\n\t\tif ( s.crossDomain && s.async ) {\n\t\t\tif ( s.timeout ) {\n\t\t\t\ts.xdrTimeout = s.timeout;\n\t\t\t\tdelete s.timeout;\n\t\t\t}\n\t\t\tvar xdr;\n\t\t\treturn {\n\t\t\t\tsend: function( _, complete ) {\n\t\t\t\t\tfunction callback( status, statusText, responses, responseHeaders ) {\n\t\t\t\t\t\txdr.onload = xdr.onerror = xdr.ontimeout = xdr.onprogress = jQuery.noop;\n\t\t\t\t\t\txdr = undefined;\n\t\t\t\t\t\tcomplete( status, statusText, responses, responseHeaders );\n\t\t\t\t\t}\n\t\t\t\t\txdr = new XDomainRequest();\n\t\t\t\t\txdr.open( s.type, s.url );\n\t\t\t\t\txdr.onload = function() {\n\t\t\t\t\t\tcallback( 200, \"OK\", { text: xdr.responseText }, \"Content-Type: \" + xdr.contentType );\n\t\t\t\t\t};\n\t\t\t\t\txdr.onerror = function() {\n\t\t\t\t\t\tcallback( 404, \"Not Found\" );\n\t\t\t\t\t};\n\t\t\t\t\txdr.onprogress = function() {};\n\t\t\t\t\tif ( s.xdrTimeout ) {\n\t\t\t\t\t\txdr.ontimeout = function() {\n\t\t\t\t\t\t\tcallback( 0, \"timeout\" );\n\t\t\t\t\t\t};\n\t\t\t\t\t\txdr.timeout = s.xdrTimeout;\n\t\t\t\t\t}\n\t\t\t\t\txdr.send( ( s.hasContent && s.data ) || null );\n\t\t\t\t},\n\t\t\t\tabort: function() {\n\t\t\t\t\tif ( xdr ) {\n\t\t\t\t\t\txdr.onerror = jQuery.noop();\n\t\t\t\t\t\txdr.abort();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t});\n}\n})( jQuery );\n\njQuery.getJSON('http://example.com/search.json',\n\t{\n\t\t'hoge': 'piyo'\n\t},\n\tfunction (data) {\n\t\tconsole.log(data);\n\t}\n});\n```\n\n\u53c2\u7167 : https://github.com/tlianza/ajaxHooks/blob/master/src/ajax/xdr.js\n\n### JavaScript\u7248\n\n```ajax.js\nfunction createCORSRequest(method, url) {\n\tvar xhr = new XMLHttpRequest();\n\tif (\"withCredentials\" in xhr) {\n\t\txhr.open(method, url, true);\n\t} else if (typeof XDomainRequest != \"undefined\") {\n\t\txhr = new XDomainRequest();\n\t\txhr.open(method, url);\n\t} else {\n\t\txhr = null;\n\t}\n\treturn xhr;\n}\n\nvar xhr = createCORSRequest('GET', 'http://example.com/search.json');\nif (!xhr) {\n\tthrow new Error('CORS not supported');\n}\nxhr.onload = function(){};\nxhr.onerror = function(){};\nxhr.send();\n```\n\n\u53c2\u7167 : http://www.html5rocks.com/en/tutorials/cors/\n\n# JSONP\u7de8\n\njsonp\u306e\u5834\u5408\u3001\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u3067\u306fjsonp\u5f62\u5f0f\u3067\u8fd4\u3059\u3060\u3051\u3067\u7279\u306b\u8a2d\u5b9a\u306f\u5fc5\u8981\u306a\u3044\u3002\u305f\u3060\u3057\u3001json\u3068\u9055\u3044JavaScript\u306e\u30b3\u30fc\u30c9\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u3067\u76f4\u63a5\u5b9f\u884c\u3059\u308b\u305f\u3081\u3001jsonp\u306e\u63d0\u4f9bAPI\u306b\u60aa\u610f\u306e\u3042\u308b\u30b3\u30fc\u30c9\u304c\u542b\u307e\u308c\u3066\u3044\u305f\u5834\u5408\u306f\u6050\u308d\u3057\u3044\u3053\u3068\u306b\u306a\u308b\u3002callback\u3067\u6307\u5b9a\u3067\u304d\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5236\u9650\u3059\u308b\u306a\u3069\u3001\u3042\u308b\u7a0b\u5ea6\u306e\u5de5\u592b\u304c\u5fc5\u8981\u3002\n\n## \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\n\n### jQuery\u7248\n\n```ajax.js\njQuery.getJSON('http://example.com/search.json?callback=?',\n\t{\n\t\t'hoge': 'piyo'\n\t},\n\tfunction (data) {\n\t\tconsole.log(data);\n\t}\n});\n```\n\ncalback=?\u3068\u3059\u308b\u3053\u3068\u3067\u3001jQuery\u304c\u52dd\u624b\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u540d\u3092\u751f\u6210\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304f\u308c\u308b\u3002\n\n### JavaScript\u7248\n\n```ajax.js\nvar target = document.createElement('script');\ntarget.charset = 'utf-8';\ntarget.src = 'http://example.com/search.json?callback=hoge';\ndocument.body.appendChild(target);\n\nfunction hoge(result) {\n\tconsole.log(result);\n}\n```\n\n"}