{"tags": ["Redmine2.5.1", "Ruby2.1.0", "CentOS6.5", "nginx1.6.0"], "context": "\n\nCentOS 6.5\u306bRedmine 2.5.1\u3092nginx+Unicorn\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066SSL\u5c0e\u5165(GitLab\u3068\u5171\u5b58)\n\u4ee5\u524d\u306b\u5165\u308c\u305f\u30b5\u30fc\u30d0\u30fc\u306bjenkins\u3092\u5171\u5b58\u3055\u305b\u308b\u3002\nCentOS 6.5\u306bGitLab 6.8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068SSL\u5c0e\u5165\nhttp://qiita.com/narumi888/items/da664ce0aca5373fd9aa\n\u65e2\u306bGitLab\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3002\nhttps://IP\u30a2\u30c9\u30ec\u30b9/redmine\n\n\u74b0\u5883\u306f2014/4/25\u6642\u70b9\u3067\u5168\u3066\u6700\u65b0\u306e\u3082\u306e\u3092\u4f7f\u7528\u3002\nCentOS:6.5\nRedmine:2.5.1\nRuby:2.1.0\nnginx:1.6.0\n\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\n\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\nRedmine 2.5\u3092CentOS 6.5\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u624b\u9806\nhttp://blog.redmine.jp/articles/2_5/installation_centos/\nCentOS 6.3\u306bRedmine + Unicorn + nginx\u306a\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u624b\u9806\nhttp://qiita.com/s-yamaz@github/items/5b32919ea33caddbca82\n\nSELinux\u3092\u7121\u52b9\u306b\u3059\u308b\n# vi /etc/sysconfig/selinux\n\nSELINUX=disabled\n\n\u518d\u8d77\u52d5\u3002\n# reboot\n\n\u7121\u52b9\u3092\u78ba\u8a8d\u3002\n# getenforce\nDisabled\n\n\n\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u767b\u9332\n# rpm -Uvh  http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n\nepel\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u306e\u3092\u78ba\u8a8d\u3002\n# yum repolist\nepel             Extra Packages for Enterprise Linux 6 - x86_64\n\n\n\u958b\u767a\u30c4\u30fc\u30eb(C\u30b3\u30f3\u30d1\u30a4\u30e9\u7b49)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30ed\u30b0\u7121\u3057\u3067\u9577\u3044\u306e\u3067\u6ce8\u610f\u3002\n# yum groupinstall \"Development Tools\" \n\n\nRuby\u306e\u30d3\u30eb\u30c9\u306b\u5fc5\u8981\u306a\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install openssl-devel readline-devel zlib-devel curl-devel libyaml-devel\n\n\nMySQL\u3068\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum  install mysql-server mysql-devel\n\n\nmageMagick\u3068\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u30fb\u65e5\u672c\u8a9e\u30d5\u30a9\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install ImageMagick ImageMagick-devel ipa-pgothic-fonts\n\n\nRuby\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# cd /tmp\n# wget http://ftp.ruby-lang.org/pub/ruby/ruby-2.1.0.tar.gz\n# tar zxvf ruby-2.1.0.tar.gz\n# cd ruby-2.1.0\n# ./configure\n# make\n# make install\n# gem install bundler\n\n\nbundler\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# gem install bundler\n\n\nMySQL\u306e\u8a2d\u5b9a\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u30ad\u30e3\u30e9\u30af\u30bf\u30bb\u30c3\u30c8\u3092utf8\u306b\u8a2d\u5b9a\n# vi /etc/my.cnf\n\n[mysqld]\ncharacter-set-server=utf8\n\n[mysql]\ndefault-character-set=utf8\n\n\nMySQL\u306e\u8d77\u52d5\u304a\u3088\u3073\u81ea\u52d5\u8d77\u52d5\u306e\u8a2d\u5b9a\n# service mysqld start\n# chkconfig mysqld on\n\n\n/etc/my.cnf \u3078\u306e\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u306e\u78ba\u8a8d\ncharacter_sets_dir \u4ee5\u5916\u306e\u5024\u304c\u3059\u3079\u3066 utf8 \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n# mysql -uroot\nmysql> show variables like 'character_set%';\n+--------------------------+----------------------------+\n| Variable_name            | Value                      |\n+--------------------------+----------------------------+\n| character_set_client     | utf8                       |\n| character_set_connection | utf8                       |\n| character_set_database   | utf8                       |\n| character_set_filesystem | binary                     |\n| character_set_results    | utf8                       |\n| character_set_server     | utf8                       |\n| character_set_system     | utf8                       |\n| character_sets_dir       | /usr/share/mysql/charsets/ |\n+--------------------------+----------------------------+\n8 rows in set (0.00 sec)\nmysql> exit\n\n\nroot\u30e6\u30fc\u30b6\u30fc\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u30fb\u533f\u540d\u30e6\u30fc\u30b6\u30fc\u524a\u9664\u307b\u304b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5411\u4e0a\nMySQL\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5411\u4e0a\u306e\u305f\u3081\u306b\u3001\u521d\u671f\u8a2d\u5b9a\u30c4\u30fc\u30eb mysql_secure_installation \u3092\u5b9f\u884c\u3002\nroot\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8a2d\u5b9a\u3084\u4e0d\u8981\u306a\u30e6\u30fc\u30b6\u30fc\u30fb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u524a\u9664\u3002\nmysql_secure_installation\n      :\n    (\u4e2d\u7565)\n      :\nEnter current password for root (enter for none):   (\u305d\u306e\u307e\u307eEnter\u30ad\u30fc\u3092\u62bc\u3059)\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] y\nNew password:   (MySQL\u306eroot\u30e6\u30fc\u30b6\u30fc\u306b\u65b0\u305f\u306b\u8a2d\u5b9a\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b)\nRe-enter new password:   (\u65b0\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u518d\u5165\u529b)\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n      :\n    (\u4e2d\u7565)\n      :\nRemove anonymous users? [Y/n] y  (\u533f\u540d\u30e6\u30fc\u30b6\u30fc\u3092\u524a\u9664)\n ... Success!\n      :\n    (\u4e2d\u7565)\n      :\nDisallow root login remotely? [Y/n] y  (root\u30e6\u30fc\u30b6\u30fc\u306e\u63a5\u7d9a\u5143\u3092localhost\u306b\u9650\u5b9a)\n ... Success!\n      :\n    (\u4e2d\u7565)\n      :\nRemove test database and access to it? [Y/n] y  (test\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u524a\u9664)\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n      :\n    (\u4e2d\u7565)\n      :\nReload privilege tables now? [Y/n] y  (\u3053\u308c\u307e\u3067\u306e\u5909\u66f4\u3092\u76f4\u3061\u306b\u9069\u7528)\n ... Success!\n\n\nRedmine\u7528\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u4efb\u610f\u3067\u8a2d\u5b9a\u3002\nmysql -uroot -p\nmysql> create database db_redmine default character set utf8;\nmysql> grant all on db_redmine.* to user_redmine@localhost identified by '\u30d1\u30b9\u30ef\u30fc\u30c9';\nmysql> flush privileges;\nmysql> exit;\n\n\nRedmine\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u4efb\u610f\u306e\u5834\u6240\u306b\u914d\u7f6e\n# cd /tmp\n# wget http://www.redmine.org/releases/redmine-2.5.1.tar.gz\n# tar xvf redmine-2.5.1.tar.gz\n# mv redmine-2.5.1 /var/lib/redmine\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u63a5\u7d9a\u8a2d\u5b9a\ndatabase.yml\u3092\u4f5c\u6210\u3002\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306fDB\u4f5c\u6210\u6642\u306e\u7269\u3092\u8a2d\u5b9a\u3002\n# vi /var/lib/redmine/config/database.yml\n\nproduction:\n  adapter: mysql2\n  database: db_redmine\n  host: localhost\n  username: user_redmine\n  password: \u30d1\u30b9\u30ef\u30fc\u30c9\n  encoding: utf8\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb config/configuration.yml \u306e\u4f5c\u6210\nRedmine\u304b\u3089\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u3078\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3084\n\u65e5\u672c\u8a9e\u30d5\u30a9\u30f3\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u8a18\u8ff0\u3057\u305f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u7ba1\u5834\u6240\u3084\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u6697\u53f7\u5316\u306a\u3069\u3082\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n# vi /var/lib/redmine/config/configuration.yml\n\nproduction:\n  email_delivery:\n    delivery_method: :smtp\n    smtp_settings:\n      address: \"localhost\" \n      port: 25\n      domain: 'example.com'\n\n  rmagick_font_path: /usr/share/fonts/ipa-pgothic/ipagp.ttf\n\n\nGem\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u5fc5\u8981\u3068\u3059\u308bGem\u3092\u4e00\u62ec\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\nbundle install --without development test\n\n\nRedmine\u306e\u521d\u671f\u8a2d\u5b9a\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n# bundle exec rake generate_secret_token\n# RAILS_ENV=production bundle exec rake db:migrate\n\n\nUnicorn\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nGemfile.local\u3092\u4f5c\u6210\u3057\u4ee5\u4e0b\u3092\u8a18\u8ff0\u3002\n# vi /var/lib/redmine/Gemfile.local\n\ngem 'unicorn'\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n# bundle install\n\n\nUnicorn\u306e\u8a2d\u5b9a\u3068\u30b5\u30fc\u30d3\u30b9\u5316\n\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u5909\u66f4\u3002\nunicorn\u8d77\u52d5\u6642\u306b --path /redmine\u3092\u4ed8\u52a0\u3059\u308b\u3068\nENV['RAILS_RELATIVE_URL_ROOT']\u306b/redmine\u304c\u5165\u308b\u305f\u3081\n/redmine\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3001\n# vi /var/lib/redmine/config.ru\n\nrequire ::File.expand_path('../config/environment',  __FILE__)\n\nif ENV['RAILS_RELATIVE_URL_ROOT']\n  map ENV['RAILS_RELATIVE_URL_ROOT'] do\n    run RedmineApp::Application\n  end\nelse\n  run RedmineApp::Application\nend\n\n\n\u306f\u307e\u308a\u70b9\nworking_directory\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d1\u30b9\u306b\u3057\u306a\u3044\u3068\u3001\n\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u306e\u3067\u4fee\u6b63\u3002\n# vi /var/lib/redmine/config/unicorn.rb \n\nworking_directory '/var/lib/redmine'\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8a18\u8ff0\u3057\u3066\u914d\u7f6e\u3002\n# vi /etc/init.d/redmine\n\nunicorn\u8d77\u52d5\u6642\u306b\u4e0a\u8ff0\u306e--path /redmine\u3092\u4ed8\u52a0\u3002\nMySQL\u3088\u308a\u8d77\u52d5\u304c\u9045\u304b\u3063\u305f\u305f\u3081\u8d77\u52d5\u9806\u5e8f\u3092\u8a2d\u5b9a\u3002\n#!/bin/sh\n\n# REDMINE\n# Maintainer: @narumi\n# Authors: narumi\n\n### BEGIN INIT INFO\n# Provides:          redmine\n# Required-Start:    $local_fs $remote_fs $network $syslog redis-server\n# Required-Stop:     $local_fs $remote_fs $network $syslog\n# Default-Start:     2 3 4 5\n# Default-Stop:      0 1 6\n# Short-Description: Redmine\n# Description:       Redmine\n# chkconfig: - 75 25\n### END INIT INFO\n\nexport PATH=/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin\n\nAPP_NAME=redmine\nAPP_ROOT=\"/var/lib/$APP_NAME\" \nAPP_PATH=\"/redmine\" \nCONFIGS=\"$APP_ROOT/config/unicorn.rb\" \nPID=\"$APP_ROOT/tmp/unicorn.pid\" \nENV=production\nPORT=5001\n\nUNICORN_OPTS=\"-D -E $ENV -c $CONFIGS --path $APP_PATH -p $PORT\" \n\nstart()\n{\n  if [ -e $PID ]; then\n    echo \"$APP_NAME already started\";\n    exit 1;\n  fi\n  echo \"start $APP_NAME\";\n  cd $APP_ROOT\n  bundle exec unicorn_rails $UNICORN_OPTS\n}\n\nstop()\n{\n  if [ ! -e $PID ]; then\n    echo \"$APP_NAME not started\";\n    exit 1;\n  fi\n  echo \"stop $APP_NAME\";\n  kill -QUIT `cat ${PID}`\n  rm -f $PID\n}\n\nforce_stop()\n{\n  if [ ! -e $PID ]; then\n    echo \"$APP_NAME not started\";\n    exit 1;\n  fi\n  echo \"stop $APP_NAME\";\n  kill -TERM `cat ${PID}`\n  rm -f $PID\n}\n\nreload()\n{\n  if [ ! -e $PID ]; then\n    echo \"$APP_NAME not started\";\n    start\n    exit 0;\n  fi\n  echo \"reload $APP_NAME\";\n  kill -HUP `cat ${PID}`\n}\n\nrestart()\n{\n  stop\n  start\n}\n\ncase \"$1\" in\n  start)\n    start\n    ;;\n  stop)\n    stop\n    ;;\n  force-stop)\n    force_stop\n    ;;\n  reload)\n    reload\n    ;;\n  restart)\n    restart\n    ;;\n  *)\n    echo \"Syntax Error: release [start|stop|force-stop|reload|restart]\" \n    ;;\nesac\n\nexit\n\n\n\u6a29\u9650\u3092\u8a2d\u5b9a\u3002\n# chmod 755 /etc/init.d/redmine\n\n\n\u30b5\u30fc\u30d3\u30b9\u767b\u9332\n# chkconfig --add redmine\n# chkconfig redmine on\n# chkconfig --list redmine\nredmine         0:off   1:off   2:on    3:on    4:on    5:on    6:off\n\n\n\u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\n# service redmine start\n\n\nnginx\u306e\u8a2d\u5b9a\n\u4ee5\u4e0b\u3067Nginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u308b\u4e8b\u3092\u524d\u63d0\u3002\nCentOS 6.5\u306bGitLab 6.8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068SSL\u5c0e\u5165\nhttp://qiita.com/narumi888/items/da664ce0aca5373fd9aa\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u66f4\u65b0\n# vi/etc/nginx/conf/gitlab\n\n\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3002\n# ADD\nupstream redmine {\n  server unix:/var/lib/redmine/tmp/unicorn.sock fail_timeout=0;\n}\nserver\u30d6\u30ed\u30c3\u30af\u306b\u4ee5\u4e0b\u3092\u8ffd\u52a0\u3002\n\nserver {\n    # ADD\n    # redmine\n    location ~ /redmine {\n        root /var/lib/redmine/public;\n        if (-f $request_filename) {\n            break;\n        }\n\n        proxy_read_timeout 300; # Some requests take more than 30 seconds.\n        proxy_connect_timeout 300; # Some requests take more than 30 seconds.\n        proxy_redirect     off;\n\n        proxy_set_header   X-Forwarded-Proto $scheme;\n        proxy_set_header   Host              $http_host;\n        proxy_set_header   X-Real-IP         $remote_addr;\n        proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;\n        proxy_set_header   Host $host;\n\n        proxy_pass         http://redmine;\n\n        access_log  /var/log/nginx/redmine_access.log;\n        error_log   /var/log/nginx/redmine_error.log;\n    }\n}\n\n\n\u518d\u8d77\u52d5\u3002\n# /etc/init.d/nginx restart\n\n\nRedmine\u3078\u30a2\u30af\u30bb\u30b9\n\u4ee5\u4e0b\u306eURL\u3067Redmine\u306e\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u3002\nhttps://IP\u30a2\u30c9\u30ec\u30b9/redmine\n\n\u521d\u671f\u306eID\u3068\u30d1\u30b9\u306f\u4ee5\u4e0b\u3002\nID:admin\nPASS:admin\n\n\n\u521d\u671f\u8a2d\u5b9a\n\u4e0b\u8a18\u3092\u53c2\u7167\u3002\nRedmine\u3092\u4f7f\u3044\u59cb\u3081\u308b\u305f\u3081\u306e\u521d\u671f\u8a2d\u5b9a\nhttp://redmine.jp/tech_note/first-step/admin/\n#CentOS 6.5\u306bRedmine 2.5.1\u3092nginx+Unicorn\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066SSL\u5c0e\u5165(GitLab\u3068\u5171\u5b58)\n\n\u4ee5\u524d\u306b\u5165\u308c\u305f\u30b5\u30fc\u30d0\u30fc\u306bjenkins\u3092\u5171\u5b58\u3055\u305b\u308b\u3002\n<b>CentOS 6.5\u306bGitLab 6.8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068SSL\u5c0e\u5165</b>\nhttp://qiita.com/narumi888/items/da664ce0aca5373fd9aa\n\n\u65e2\u306bGitLab\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3002\n\n```\nhttps://IP\u30a2\u30c9\u30ec\u30b9/redmine\n```\n\n\u74b0\u5883\u306f2014/4/25\u6642\u70b9\u3067\u5168\u3066\u6700\u65b0\u306e\u3082\u306e\u3092\u4f7f\u7528\u3002\nCentOS:6.5\nRedmine:2.5.1\nRuby:2.1.0\nnginx:1.6.0\n\n\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\n\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n<b>Redmine 2.5\u3092CentOS 6.5\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u624b\u9806</b>\nhttp://blog.redmine.jp/articles/2_5/installation_centos/\n<b>CentOS 6.3\u306bRedmine + Unicorn + nginx\u306a\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u624b\u9806</b>\nhttp://qiita.com/s-yamaz@github/items/5b32919ea33caddbca82\n\n##SELinux\u3092\u7121\u52b9\u306b\u3059\u308b\n\n```\n# vi /etc/sysconfig/selinux\n\nSELINUX=disabled\n```\n\n\u518d\u8d77\u52d5\u3002\n\n```\n# reboot\n```\n\n\u7121\u52b9\u3092\u78ba\u8a8d\u3002\n\n```\n# getenforce\nDisabled\n```\n\n##\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n###\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u767b\u9332\n\n```\n# rpm -Uvh  http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n```\n\nepel\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u306e\u3092\u78ba\u8a8d\u3002\n\n```\n# yum repolist\nepel             Extra Packages for Enterprise Linux 6 - x86_64\n```\n\n###\u958b\u767a\u30c4\u30fc\u30eb(C\u30b3\u30f3\u30d1\u30a4\u30e9\u7b49)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30ed\u30b0\u7121\u3057\u3067\u9577\u3044\u306e\u3067\u6ce8\u610f\u3002\n\n```\n# yum groupinstall \"Development Tools\" \n```\n\n###Ruby\u306e\u30d3\u30eb\u30c9\u306b\u5fc5\u8981\u306a\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum install openssl-devel readline-devel zlib-devel curl-devel libyaml-devel\n```\n\n###MySQL\u3068\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum  install mysql-server mysql-devel\n```\n\n###mageMagick\u3068\u30d8\u30c3\u30c0\u30d5\u30a1\u30a4\u30eb\u30fb\u65e5\u672c\u8a9e\u30d5\u30a9\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# yum install ImageMagick ImageMagick-devel ipa-pgothic-fonts\n```\n\n##Ruby\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# cd /tmp\n# wget http://ftp.ruby-lang.org/pub/ruby/ruby-2.1.0.tar.gz\n# tar zxvf ruby-2.1.0.tar.gz\n# cd ruby-2.1.0\n# ./configure\n# make\n# make install\n# gem install bundler\n```\n\n###bundler\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# gem install bundler\n```\n\n##MySQL\u306e\u8a2d\u5b9a\n\n###\u30c7\u30d5\u30a9\u30eb\u30c8\u30ad\u30e3\u30e9\u30af\u30bf\u30bb\u30c3\u30c8\u3092utf8\u306b\u8a2d\u5b9a\n\n```\n# vi /etc/my.cnf\n\n[mysqld]\ncharacter-set-server=utf8\n\n[mysql]\ndefault-character-set=utf8\n```\n\n###MySQL\u306e\u8d77\u52d5\u304a\u3088\u3073\u81ea\u52d5\u8d77\u52d5\u306e\u8a2d\u5b9a\n\n```\n# service mysqld start\n# chkconfig mysqld on\n```\n\n###/etc/my.cnf \u3078\u306e\u8a2d\u5b9a\u304c\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u306e\u78ba\u8a8d\ncharacter_sets_dir \u4ee5\u5916\u306e\u5024\u304c\u3059\u3079\u3066 utf8 \u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n```\n# mysql -uroot\nmysql> show variables like 'character_set%';\n+--------------------------+----------------------------+\n| Variable_name            | Value                      |\n+--------------------------+----------------------------+\n| character_set_client     | utf8                       |\n| character_set_connection | utf8                       |\n| character_set_database   | utf8                       |\n| character_set_filesystem | binary                     |\n| character_set_results    | utf8                       |\n| character_set_server     | utf8                       |\n| character_set_system     | utf8                       |\n| character_sets_dir       | /usr/share/mysql/charsets/ |\n+--------------------------+----------------------------+\n8 rows in set (0.00 sec)\nmysql> exit\n```\n\n###root\u30e6\u30fc\u30b6\u30fc\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u30fb\u533f\u540d\u30e6\u30fc\u30b6\u30fc\u524a\u9664\u307b\u304b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5411\u4e0a\n\nMySQL\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5411\u4e0a\u306e\u305f\u3081\u306b\u3001\u521d\u671f\u8a2d\u5b9a\u30c4\u30fc\u30eb mysql_secure_installation \u3092\u5b9f\u884c\u3002\nroot\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8a2d\u5b9a\u3084\u4e0d\u8981\u306a\u30e6\u30fc\u30b6\u30fc\u30fb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u524a\u9664\u3002\n\n```\nmysql_secure_installation\n      :\n    (\u4e2d\u7565)\n      :\nEnter current password for root (enter for none):   (\u305d\u306e\u307e\u307eEnter\u30ad\u30fc\u3092\u62bc\u3059)\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] y\nNew password:   (MySQL\u306eroot\u30e6\u30fc\u30b6\u30fc\u306b\u65b0\u305f\u306b\u8a2d\u5b9a\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b)\nRe-enter new password:   (\u65b0\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u518d\u5165\u529b)\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n      :\n    (\u4e2d\u7565)\n      :\nRemove anonymous users? [Y/n] y  (\u533f\u540d\u30e6\u30fc\u30b6\u30fc\u3092\u524a\u9664)\n ... Success!\n      :\n    (\u4e2d\u7565)\n      :\nDisallow root login remotely? [Y/n] y  (root\u30e6\u30fc\u30b6\u30fc\u306e\u63a5\u7d9a\u5143\u3092localhost\u306b\u9650\u5b9a)\n ... Success!\n      :\n    (\u4e2d\u7565)\n      :\nRemove test database and access to it? [Y/n] y  (test\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u524a\u9664)\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n      :\n    (\u4e2d\u7565)\n      :\nReload privilege tables now? [Y/n] y  (\u3053\u308c\u307e\u3067\u306e\u5909\u66f4\u3092\u76f4\u3061\u306b\u9069\u7528)\n ... Success!\n```\n\n##Redmine\u7528\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u4efb\u610f\u3067\u8a2d\u5b9a\u3002\n\n```\nmysql -uroot -p\nmysql> create database db_redmine default character set utf8;\nmysql> grant all on db_redmine.* to user_redmine@localhost identified by '\u30d1\u30b9\u30ef\u30fc\u30c9';\nmysql> flush privileges;\nmysql> exit;\n```\n\n##Redmine\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n###\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u4efb\u610f\u306e\u5834\u6240\u306b\u914d\u7f6e\n\n```\n# cd /tmp\n# wget http://www.redmine.org/releases/redmine-2.5.1.tar.gz\n# tar xvf redmine-2.5.1.tar.gz\n# mv redmine-2.5.1 /var/lib/redmine\n```\n\n###\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u63a5\u7d9a\u8a2d\u5b9a\n\ndatabase.yml\u3092\u4f5c\u6210\u3002\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306fDB\u4f5c\u6210\u6642\u306e\u7269\u3092\u8a2d\u5b9a\u3002\n\n```\n# vi /var/lib/redmine/config/database.yml\n\nproduction:\n  adapter: mysql2\n  database: db_redmine\n  host: localhost\n  username: user_redmine\n  password: \u30d1\u30b9\u30ef\u30fc\u30c9\n  encoding: utf8\n```\n\n###\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb config/configuration.yml \u306e\u4f5c\u6210\n\nRedmine\u304b\u3089\u30e1\u30fc\u30eb\u30b5\u30fc\u30d0\u3078\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3084\n\u65e5\u672c\u8a9e\u30d5\u30a9\u30f3\u30c8\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u3092\u8a18\u8ff0\u3057\u305f\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3002\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u7ba1\u5834\u6240\u3084\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u6697\u53f7\u5316\u306a\u3069\u3082\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n\n```\n# vi /var/lib/redmine/config/configuration.yml\n\nproduction:\n  email_delivery:\n    delivery_method: :smtp\n    smtp_settings:\n      address: \"localhost\" \n      port: 25\n      domain: 'example.com'\n\n  rmagick_font_path: /usr/share/fonts/ipa-pgothic/ipagp.ttf\n```\n\n###Gem\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u5fc5\u8981\u3068\u3059\u308bGem\u3092\u4e00\u62ec\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\n```\nbundle install --without development test\n```\n\n###Redmine\u306e\u521d\u671f\u8a2d\u5b9a\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n\n```\n# bundle exec rake generate_secret_token\n# RAILS_ENV=production bundle exec rake db:migrate\n```\n\n\n##Unicorn\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nGemfile.local\u3092\u4f5c\u6210\u3057\u4ee5\u4e0b\u3092\u8a18\u8ff0\u3002\n\n```\n# vi /var/lib/redmine/Gemfile.local\n\ngem 'unicorn'\n```\n\n###\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\n```\n# bundle install\n```\n\n###Unicorn\u306e\u8a2d\u5b9a\u3068\u30b5\u30fc\u30d3\u30b9\u5316\n\n\u30b5\u30d6\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u5909\u66f4\u3002\nunicorn\u8d77\u52d5\u6642\u306b --path /redmine\u3092\u4ed8\u52a0\u3059\u308b\u3068\nENV['RAILS_RELATIVE_URL_ROOT']\u306b/redmine\u304c\u5165\u308b\u305f\u3081\n/redmine\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3001\n\n```\n# vi /var/lib/redmine/config.ru\n\nrequire ::File.expand_path('../config/environment',  __FILE__)\n\nif ENV['RAILS_RELATIVE_URL_ROOT']\n  map ENV['RAILS_RELATIVE_URL_ROOT'] do\n    run RedmineApp::Application\n  end\nelse\n  run RedmineApp::Application\nend\n```\n\n###\u306f\u307e\u308a\u70b9\n\nworking_directory\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d1\u30b9\u306b\u3057\u306a\u3044\u3068\u3001\n\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u306e\u3067\u4fee\u6b63\u3002\n\n```\n# vi /var/lib/redmine/config/unicorn.rb \n\nworking_directory '/var/lib/redmine'\n```\n\n##\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\n\n###\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8a18\u8ff0\u3057\u3066\u914d\u7f6e\u3002\n\n```\n# vi /etc/init.d/redmine\n```\n\nunicorn\u8d77\u52d5\u6642\u306b\u4e0a\u8ff0\u306e--path /redmine\u3092\u4ed8\u52a0\u3002\nMySQL\u3088\u308a\u8d77\u52d5\u304c\u9045\u304b\u3063\u305f\u305f\u3081\u8d77\u52d5\u9806\u5e8f\u3092\u8a2d\u5b9a\u3002\n\n```\n#!/bin/sh\n\n# REDMINE\n# Maintainer: @narumi\n# Authors: narumi\n\n### BEGIN INIT INFO\n# Provides:          redmine\n# Required-Start:    $local_fs $remote_fs $network $syslog redis-server\n# Required-Stop:     $local_fs $remote_fs $network $syslog\n# Default-Start:     2 3 4 5\n# Default-Stop:      0 1 6\n# Short-Description: Redmine\n# Description:       Redmine\n# chkconfig: - 75 25\n### END INIT INFO\n\nexport PATH=/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin\n\nAPP_NAME=redmine\nAPP_ROOT=\"/var/lib/$APP_NAME\" \nAPP_PATH=\"/redmine\" \nCONFIGS=\"$APP_ROOT/config/unicorn.rb\" \nPID=\"$APP_ROOT/tmp/unicorn.pid\" \nENV=production\nPORT=5001\n\nUNICORN_OPTS=\"-D -E $ENV -c $CONFIGS --path $APP_PATH -p $PORT\" \n\nstart()\n{\n  if [ -e $PID ]; then\n    echo \"$APP_NAME already started\";\n    exit 1;\n  fi\n  echo \"start $APP_NAME\";\n  cd $APP_ROOT\n  bundle exec unicorn_rails $UNICORN_OPTS\n}\n\nstop()\n{\n  if [ ! -e $PID ]; then\n    echo \"$APP_NAME not started\";\n    exit 1;\n  fi\n  echo \"stop $APP_NAME\";\n  kill -QUIT `cat ${PID}`\n  rm -f $PID\n}\n\nforce_stop()\n{\n  if [ ! -e $PID ]; then\n    echo \"$APP_NAME not started\";\n    exit 1;\n  fi\n  echo \"stop $APP_NAME\";\n  kill -TERM `cat ${PID}`\n  rm -f $PID\n}\n\nreload()\n{\n  if [ ! -e $PID ]; then\n    echo \"$APP_NAME not started\";\n    start\n    exit 0;\n  fi\n  echo \"reload $APP_NAME\";\n  kill -HUP `cat ${PID}`\n}\n\nrestart()\n{\n  stop\n  start\n}\n\ncase \"$1\" in\n  start)\n    start\n    ;;\n  stop)\n    stop\n    ;;\n  force-stop)\n    force_stop\n    ;;\n  reload)\n    reload\n    ;;\n  restart)\n    restart\n    ;;\n  *)\n    echo \"Syntax Error: release [start|stop|force-stop|reload|restart]\" \n    ;;\nesac\n\nexit\n```\n\n###\u6a29\u9650\u3092\u8a2d\u5b9a\u3002\n\n```\n# chmod 755 /etc/init.d/redmine\n```\n\n\n###\u30b5\u30fc\u30d3\u30b9\u767b\u9332\n\n```\n# chkconfig --add redmine\n# chkconfig redmine on\n# chkconfig --list redmine\nredmine         0:off   1:off   2:on    3:on    4:on    5:on    6:off\n```\n\n###\u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\n\n```\n# service redmine start\n```\n\n##nginx\u306e\u8a2d\u5b9a\n\n\u4ee5\u4e0b\u3067Nginx\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u8a2d\u5b9a\u3092\u884c\u3063\u3066\u3044\u308b\u4e8b\u3092\u524d\u63d0\u3002\n<b>CentOS 6.5\u306bGitLab 6.8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068SSL\u5c0e\u5165</b>\nhttp://qiita.com/narumi888/items/da664ce0aca5373fd9aa\n\n###\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u66f4\u65b0\n\n```\n# vi/etc/nginx/conf/gitlab\n```\n\n\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3002\n\n```\n# ADD\nupstream redmine {\n  server unix:/var/lib/redmine/tmp/unicorn.sock fail_timeout=0;\n}\nserver\u30d6\u30ed\u30c3\u30af\u306b\u4ee5\u4e0b\u3092\u8ffd\u52a0\u3002\n\nserver {\n    # ADD\n    # redmine\n    location ~ /redmine {\n        root /var/lib/redmine/public;\n        if (-f $request_filename) {\n            break;\n        }\n\n        proxy_read_timeout 300; # Some requests take more than 30 seconds.\n        proxy_connect_timeout 300; # Some requests take more than 30 seconds.\n        proxy_redirect     off;\n\n        proxy_set_header   X-Forwarded-Proto $scheme;\n        proxy_set_header   Host              $http_host;\n        proxy_set_header   X-Real-IP         $remote_addr;\n        proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;\n        proxy_set_header   Host $host;\n\n        proxy_pass         http://redmine;\n\n        access_log  /var/log/nginx/redmine_access.log;\n        error_log   /var/log/nginx/redmine_error.log;\n    }\n}\n```\n\n###\u518d\u8d77\u52d5\u3002\n\n```\n# /etc/init.d/nginx restart\n```\n\n##Redmine\u3078\u30a2\u30af\u30bb\u30b9\n\n\u4ee5\u4e0b\u306eURL\u3067Redmine\u306e\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n\n```\nhttps://IP\u30a2\u30c9\u30ec\u30b9/redmine\n```\n\n\u521d\u671f\u306eID\u3068\u30d1\u30b9\u306f\u4ee5\u4e0b\u3002\n\n```\nID:admin\nPASS:admin\n```\n\n##\u521d\u671f\u8a2d\u5b9a\n\n\u4e0b\u8a18\u3092\u53c2\u7167\u3002\n\n<b>Redmine\u3092\u4f7f\u3044\u59cb\u3081\u308b\u305f\u3081\u306e\u521d\u671f\u8a2d\u5b9a</b>\nhttp://redmine.jp/tech_note/first-step/admin/\n"}