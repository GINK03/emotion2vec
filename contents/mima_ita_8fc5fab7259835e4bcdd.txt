{"context": " More than 1 year has passed since last update.\u901a\u4fe1\u3092\u884c\u306a\u3046\u969b\u306b\u3001JavaScript\u306eescape\u95a2\u6570\u306f\u82f1\u6570\u5b57\u4ee5\u5916\u306e\u8a18\u53f7\u3084\u65e5\u672c\u8a9e\u3092\uff0521\u3068\u304b\uff05u3044\u3068\u3044\u3046\u30b3\u30fc\u30c9\u306b\u5909\u63db\u3057\u3066\u304f\u308c\u308b\u3002\n\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u3067\u306f\u3001VBA\u3067esacape\u51e6\u7406\u3092\u884c\u3046\u30b5\u30f3\u30d7\u30eb\u3092\u793a\u3057\u3066\u3044\u308b\u3002\nhttp://www.xtremevbtalk.com/showthread.php?t=152882\n\u6b8b\u5ff5\u306a\u3053\u3068\u306b\u3001\u3053\u306e\u30b5\u30f3\u30d7\u30eb\u306f\u65e5\u672c\u8a9e\u306a\u3069\u306eUNICODE\u306b\u3064\u3044\u3066\u306f\u8003\u616e\u3055\u308c\u3066\u3044\u306a\u3044\u3002\u305d\u3053\u3067\u3001\u4e0a\u8a18\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u5143\u306b\u65e5\u672c\u8a9e\u5bfe\u5fdc\u3057\u305f\u3082\u306e\u3092\u4ee5\u4e0b\u306b\u793a\u3059\u3002\nOption Explicit\n\n'*\n'* \u7279\u6b8a\u6587\u5b57\u3092\u30a8\u30b9\u30b1\u30fc\u30d7\u3059\u308b\n'* \u53c2\u8003\uff1a\n'* http://www.xtremevbtalk.com/showthread.php?t=152882\n'* @param[in] StringToEncode \u6587\u5b57\n'* @return \u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u305f\u6587\u5b57 Unicode\u306e\u5834\u5408\u306f%u\n'*\nPublic Function escape(ByVal StringToEncode As String) As String\n    Dim i As Integer\n    Dim acode As Integer\n    Dim char As String\n\n    escape = StringToEncode\n\n    For i = Len(escape) To 1 Step -1\n        acode = AscW(Mid$(escape, i, 1))\n        Select Case acode\n            Case 48 To 57, 65 To 90, 97 To 122\n                ' don't touch alphanumeric chars\n\n            Case 32\n                ' replace space\n                escape = Left$(escape, i - 1) & \"%20\" & Mid$(escape, i + 1)\n\n            Case Else\n                ' replace punctuation chars with \"%hex\"\n                char = Hex$(acode)\n                If Len(char) > 2 Then\n                    If Len(char) = 3 Then\n                        char = \"0\" & char\n                    End If\n                    escape = Left$(escape, i - 1) & \"%u\" & char & Mid$(escape, i + 1)\n                Else\n                    If Len(char) = 1 Then\n                        char = \"0\" & char\n                    End If\n                    escape = Left$(escape, i - 1) & \"%\" & char & Mid$(escape, i + 1)\n                End If\n        End Select\n    Next\nEnd Function\n'* http://www.xtremevbtalk.com/showthread.php?t=152882\nPublic Function unescape(ByVal StringToDecode As String) As String\n    Dim i As Long\n    Dim acode As Integer, sTmp As String\n    unescape = StringToDecode\n\n    If InStr(1, unescape, \"%\") = 0 Then\n         Exit Function\n    End If\n    For i = Len(unescape) To 1 Step -1\n        acode = Asc(Mid$(unescape, i, 1))\n        Select Case acode\n            Case 48 To 57, 65 To 90, 97 To 122\n                ' don't touch alphanumeric chars\n                DoEvents\n\n            Case 37: ' Decode % value\n                If Mid$(unescape, i + 1, 1) = \"u\" Then\n                    sTmp = CStr(CLng(\"&H\" & Mid$(unescape, i + 2, 4)))\n                    If IsNumeric(sTmp) Then\n                        unescape = Left$(unescape, i - 1) & ChrW$(CInt(\"&H\" & Mid$(unescape, i + 2, 4))) & Mid$(unescape, i + 6)\n                    End If\n                Else\n                    sTmp = CStr(CLng(\"&H\" & Mid$(unescape, i + 1, 2)))\n                    If IsNumeric(sTmp) Then\n                        unescape = Left$(unescape, i - 1) & ChrW$(CInt(\"&H\" & Mid$(unescape, i + 1, 2))) & Mid$(unescape, i + 3)\n                    End If\n                End If\n        End Select\n    Next\nEnd Function\n\n\n\u5b9f\u884c\u4f8b:\n?escape(\"\u3042\u305f\u3057\u306f\u304b\u3053\u3081abcdefg%#?<>*+[]<>/\\'\"\"\")\n%u3042%u305F%u3057%u306F%u304B%u3053%u3081abcdefg%25%23%3F%3C%3E%2A%2B%5B%5D%3C%3E%2F%5C%27%22\n\n?unescape(\"%u3042%u305F%u3057%u306F%u304B%u3053%u3081abcdefg%25%23%3F%3C%3E%2A%2B%5B%5D%3C%3E%2F%5C%27%22\")\n\u3042\u305f\u3057\u306f\u304b\u3053\u3081abcdefg%#?<>*+[]<>/\\'\"\n\n\u901a\u4fe1\u3092\u884c\u306a\u3046\u969b\u306b\u3001JavaScript\u306eescape\u95a2\u6570\u306f\u82f1\u6570\u5b57\u4ee5\u5916\u306e\u8a18\u53f7\u3084\u65e5\u672c\u8a9e\u3092\uff0521\u3068\u304b\uff05u3044\u3068\u3044\u3046\u30b3\u30fc\u30c9\u306b\u5909\u63db\u3057\u3066\u304f\u308c\u308b\u3002\n\n\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u3067\u306f\u3001VBA\u3067esacape\u51e6\u7406\u3092\u884c\u3046\u30b5\u30f3\u30d7\u30eb\u3092\u793a\u3057\u3066\u3044\u308b\u3002\nhttp://www.xtremevbtalk.com/showthread.php?t=152882\n\n\u6b8b\u5ff5\u306a\u3053\u3068\u306b\u3001\u3053\u306e\u30b5\u30f3\u30d7\u30eb\u306f\u65e5\u672c\u8a9e\u306a\u3069\u306eUNICODE\u306b\u3064\u3044\u3066\u306f\u8003\u616e\u3055\u308c\u3066\u3044\u306a\u3044\u3002\u305d\u3053\u3067\u3001\u4e0a\u8a18\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u5143\u306b\u65e5\u672c\u8a9e\u5bfe\u5fdc\u3057\u305f\u3082\u306e\u3092\u4ee5\u4e0b\u306b\u793a\u3059\u3002\n\n```vbnet\nOption Explicit\n\n'*\n'* \u7279\u6b8a\u6587\u5b57\u3092\u30a8\u30b9\u30b1\u30fc\u30d7\u3059\u308b\n'* \u53c2\u8003\uff1a\n'* http://www.xtremevbtalk.com/showthread.php?t=152882\n'* @param[in] StringToEncode \u6587\u5b57\n'* @return \u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u305f\u6587\u5b57 Unicode\u306e\u5834\u5408\u306f%u\n'*\nPublic Function escape(ByVal StringToEncode As String) As String\n    Dim i As Integer\n    Dim acode As Integer\n    Dim char As String\n \n    escape = StringToEncode\n \n    For i = Len(escape) To 1 Step -1\n        acode = AscW(Mid$(escape, i, 1))\n        Select Case acode\n            Case 48 To 57, 65 To 90, 97 To 122\n                ' don't touch alphanumeric chars\n \n            Case 32\n                ' replace space\n                escape = Left$(escape, i - 1) & \"%20\" & Mid$(escape, i + 1)\n \n            Case Else\n                ' replace punctuation chars with \"%hex\"\n                char = Hex$(acode)\n                If Len(char) > 2 Then\n                    If Len(char) = 3 Then\n                        char = \"0\" & char\n                    End If\n                    escape = Left$(escape, i - 1) & \"%u\" & char & Mid$(escape, i + 1)\n                Else\n                    If Len(char) = 1 Then\n                        char = \"0\" & char\n                    End If\n                    escape = Left$(escape, i - 1) & \"%\" & char & Mid$(escape, i + 1)\n                End If\n        End Select\n    Next\nEnd Function\n'* http://www.xtremevbtalk.com/showthread.php?t=152882\nPublic Function unescape(ByVal StringToDecode As String) As String\n    Dim i As Long\n    Dim acode As Integer, sTmp As String\n    unescape = StringToDecode\n \n    If InStr(1, unescape, \"%\") = 0 Then\n         Exit Function\n    End If\n    For i = Len(unescape) To 1 Step -1\n        acode = Asc(Mid$(unescape, i, 1))\n        Select Case acode\n            Case 48 To 57, 65 To 90, 97 To 122\n                ' don't touch alphanumeric chars\n                DoEvents\n \n            Case 37: ' Decode % value\n                If Mid$(unescape, i + 1, 1) = \"u\" Then\n                    sTmp = CStr(CLng(\"&H\" & Mid$(unescape, i + 2, 4)))\n                    If IsNumeric(sTmp) Then\n                        unescape = Left$(unescape, i - 1) & ChrW$(CInt(\"&H\" & Mid$(unescape, i + 2, 4))) & Mid$(unescape, i + 6)\n                    End If\n                Else\n                    sTmp = CStr(CLng(\"&H\" & Mid$(unescape, i + 1, 2)))\n                    If IsNumeric(sTmp) Then\n                        unescape = Left$(unescape, i - 1) & ChrW$(CInt(\"&H\" & Mid$(unescape, i + 1, 2))) & Mid$(unescape, i + 3)\n                    End If\n                End If\n        End Select\n    Next\nEnd Function\n\n```\n\n\n\u5b9f\u884c\u4f8b:\n\n```\n?escape(\"\u3042\u305f\u3057\u306f\u304b\u3053\u3081abcdefg%#?<>*+[]<>/\\'\"\"\")\n%u3042%u305F%u3057%u306F%u304B%u3053%u3081abcdefg%25%23%3F%3C%3E%2A%2B%5B%5D%3C%3E%2F%5C%27%22\n\n?unescape(\"%u3042%u305F%u3057%u306F%u304B%u3053%u3081abcdefg%25%23%3F%3C%3E%2A%2B%5B%5D%3C%3E%2F%5C%27%22\")\n\u3042\u305f\u3057\u306f\u304b\u3053\u3081abcdefg%#?<>*+[]<>/\\'\"\n```\n", "tags": ["VBA"]}