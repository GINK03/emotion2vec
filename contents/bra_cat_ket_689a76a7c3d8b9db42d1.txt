{"context": "\u4e00\u90e8\u9593\u9055\u3044\u304c\u3042\u308a\u307e\u3059\u3001\u672c\u6587\u4e2d\u3067\u3082\u660e\u8a18\u3057\u307e\u3057\u305f\u304c\u6700\u521d\u306e\u7d42\u4e86\u6761\u4ef6\u306fInt \u3092\u8986\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u6700\u5f8c\u306b\u8a02\u6b63\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u3068\u3088\u308a\u53b3\u3057\u3044quickCheck \u306e\u7d50\u679c\u3082\u8f09\u305b\u3066\u304a\u304d\u307e\u3057\u305f\u3002\nHaskell Advent Calendar 2016 \u306e10\u65e5\u76ee\u3067\u3059\u3002\n\u53bb\u5e74\u306f\u773a\u3081\u3066\u3044\u308b\u3060\u3051\u3060\u3063\u305f\u306e\u3067\u4eca\u56de\u67a0\u53d6\u308c\u305f\u306e\u5b09\u3057\u3044\u3067\u3059\uff01\n\u30ec\u30d9\u30eb\u5206\u3051\u7684\u306b\u306fAdvanced Beginner \u306e\u4e00\u4eba\u304c\u540c\u3058\u304f\u3089\u3044\u306e\u30ec\u30d9\u30eb\u306e\u4eba\u306b\u5411\u3051\u3066\u66f8\u3044\u3066\u308b\u3064\u3082\u308a\u3067\u3059\u3001\u3084\u3084\u5185\u5bb9\u306b\u521d\u7b49\u6574\u6570\u8ad6\u304c\u542b\u307e\u308c\u307e\u3059\u3002\n\u3042\u308f\u3088\u304f\u3070\u3088\u308a\u8a73\u3057\u3044\u4eba\u306b\u30c8\u30f3\u30c6\u30f3\u30ab\u30f3\u30ab\u30f3\u3068\u76f4\u3057\u3066\u3044\u305f\u3060\u304d\u305f\u3044\u611f\u3058\u3067\u3059\u304c\u3002\n\n\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\n\u96fb\u5353\u306a\u3069\u3067(1/3) \u306e\u8a08\u7b97\u3092\u3057\u305f\u5f8c\u3001\u7b54\u3048\u306b3 \u3092\u639b\u3051\u305f\u3053\u3068\u304c\u3042\u308b\u4eba\u3001\u305d\u3057\u3066\u305d\u306e\u3068\u304d1 \u306b\u623b\u3089\u306a\u304b\u3063\u305f\u7d4c\u9a13\u3042\u308b\u4eba\u3082\u304d\u3063\u3068\u591a\u3044\u3053\u3068\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306e\u8a71\u306f\u305d\u308c\u306b\u3061\u3087\u3063\u3068\u95a2\u4fc2\u3057\u3066\u3044\u308b\u3001\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u4f53\n\u4eca\u56de\u306f\u4f53\u3092\u53d6\u308a\u4e0a\u3052\u307e\u3059\u3001\u4f53\u3068\u8a00\u3046\u306e\u306f\u3044\u308f\u3086\u308b\u56db\u5247\u6f14\u7b97\u306b\u9589\u3058\u3066\u3044\u308b\u4ee3\u6570\u4f53\u7cfb\u306e\u3053\u3068\u3067\u3059\u306d\u3002\n\u3084\u3084\u8a73\u3057\u304f\u8a00\u3046\u3068\u74b0\u306e\u3046\u3061\u3001\u96f6\u5143(0)\u4ee5\u5916\u304c\u639b\u3051\u7b97\u306b\u5bfe\u3059\u308b\u9006\u5143\u3092\u6301\u3063\u3066\u3044\u308b\u3088\u3046\u306a\u3082\u306e\u3001\u305d\u308c\u3092\u4f53\u3068\u547c\u3073\u307e\u3059\u3002\n\u5272\u308a\u7b97\u304c\u5b89\u5168\u306b\u884c\u3048\u308b\u74b0\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u306d\u3002\n\u7279\u306b\u8208\u5473\u304c\u3042\u308b\u306e\u304c\n\\mathbb{Q}\nQ{\\mathbb{Q}\n}\n\u3067\u8868\u3055\u308c\u308b\u6709\u7406\u6570\u4f53\u3084\u3001\u305d\u308c\u3092\u9023\u7d9a\u5316\u3057\u305f\n\\mathbb{R}\nR{\\mathbb{R}\n}\n\u306a\u308b\u5b9f\u6570\u4f53\u3001\u305d\u3057\u3066\u4ee3\u6570\u9589\u4f53\u3067\u3042\u308b\u8907\u7d20\u6570\u4f53\n\\mathbb{C}\nC{\\mathbb{C}\n}\n\u3068\u3044\u3046\u306e\u304c\u30a2\u30ea\u307e\u3059\u3002\n\u30b0\u30ec\u30d6\u30ca\u30fc\u57fa\u5e95\u3067\u6700\u8fd1\u6709\u540d\u306a\u3053\u306e\u672c\u3067\u306f\u8272\u3005\u306a\u8a3c\u660e\u306e\u70ba\u306eC\\mathbb{C}\u3001\uff08\u9023\u7d9a\u7684\u306a\uff09\u7d75\u3084\u30b0\u30e9\u30d5\u3092\u63cf\u3044\u305f\u308a\u3059\u308b\u70ba\u306eR\\mathbb{R}\u3001\u305d\u3057\u3066\u8a08\u7b97\u6a5f\u306e\u4e2d\u3067\u306fQ\\mathbb{Q}\u3068\u3044\u3046\u66f8\u304d\u65b9\u3092\u3057\u3066\u3044\u305f\u306e\u304c\u5370\u8c61\u7684\u3067\u3059\u3002\n\n\u6709\u7406\u6570\u306e\u8a08\u7b97\u306f\u30b3\u30b9\u30c8\u304c\u9ad8\u3044\uff1f\n\u4f8b\u3048\u3070\u8a08\u7b97\u6a5f\u306e\u4e2d\u3067\u7d20\u6734\u306b\u5272\u308a\u7b97\u3092\u3059\u308b\u3068\u5927\u304d\u304f\u60c5\u5831\u3092\u640d\u306a\u3046\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u306e\u306f\u7686\u3055\u3093\u3054\u5b58\u77e5\u3060\u3068\u601d\u3044\u307e\u3059\u3001\u4e0a\u3067\u3042\u3052\u305f\u96fb\u5353\u306e\u4f8b\u304c\u305d\u308c\u306b\u5f53\u305f\u308a\u307e\u3059\u3002\n\u8a00\u3046\u307e\u3067\u3082\u7121\u3044\u3053\u3068\u3067\u3059\u304c\u3001\u8a08\u7b97\u6a5f\u4e0a\u3067\u7121\u9650\u306e\u7cbe\u5ea6\u3067\u5272\u308a\u7b97\u3092\u884c\u3046\u3053\u3068\u306f\u7d20\u6734\u306b\u306f\u7121\u7406\u3067\u3001\u4f8b\u3048\u3070\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306b\u4e38\u3081\u3066\u8a08\u7b97\u3059\u308b\u3068\u666e\u901a\u306f\u671b\u3080\u7d50\u679c\u3067\u306f\u7121\u3044\u3082\u306e\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u7d20\u6734\u306a\u89e3\u6c7a\u7b56\u306f\u3001Int \u3092\u4e8c\u3064\u53d6\u3063\u3066\u304d\u305f\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u578b\u3067\u6709\u7406\u6570\u3092\u8868\u73fe\u3059\u308b\u3068\u3044\u3046\u65b9\u6cd5\u3067\u3059\u3002\n\u3053\u308c\u306f\u307e\u3041\u3046\u307e\u304f\u3044\u304d\u307e\u3059\u3001\u3057\u304b\u3057\u8a08\u7b97\u306e\u9014\u4e2d\u3067\u5206\u6bcd\u5206\u5b50\u306eInt \u304c\u6841\u843d\u3061\u3057\u3066\u306a\u3044\u3053\u3068\u306f\u4e00\u822c\u306b\u306f\u4fdd\u969c\u3055\u308c\u307e\u305b\u3093\u3002\n\u305f\u3068\u3048\u5165\u529b\u3068\u51fa\u529b\u306e\u578b\u304cInt \u3067\u3042\u3063\u3066\u3082\u3001\u4e2d\u9593\u8868\u73fe\u304c\u6841\u843d\u3061\u3057\u3066\u3044\u308c\u3070\u7d50\u679c\u306f\u671b\u3093\u3067\u3044\u305f\u3082\u306e\u3067\u306f\u306a\u3044\u3082\u306e\u304c\u5f97\u3089\u308c\u308b\u3053\u3068\u306b\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u308f\u3051\u3067\u3001\u3053\u308c\u306f\u56f0\u308b\u308f\u3051\u3067\u3059\u3002\n\u3082\u3061\u308d\u3093\u4efb\u610f\u5236\u5ea6\u306eInteger \u3092\u4f7f\u3046\u3068\u3044\u3046\u624b\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3001\u3001\u9045\u304f\u30b3\u30b9\u30c8\u304c\u304b\u3055\u3080\u3053\u3068\u306f\u5bb9\u6613\u306b\u60f3\u50cf\u3067\u304d\u307e\u3059\u3002\n\u79c1\u81ea\u8eab\u304c\u5b9a\u91cf\u7684\u306b\u78ba\u8a8d\u3057\u305f\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u30a2\u30ec\u3067\u3059\u304c\u3001\u5272\u308a\u7b97\u3001\u3055\u3089\u306b\u8a00\u3048\u3070\uff08\u639b\u3051\u7b97\u306b\u5bfe\u3059\u308b\uff09\u9006\u5143\u306e\u8a08\u7b97\u3092\u771f\u9762\u76ee\u306b\u53d6\u308a\u6271\u304a\u3046\u3068\u601d\u3046\u3068\u30b9\u30da\u30fc\u30b9\u3092\u55b0\u3046\u3068\u8a00\u3046\u306e\u306f\u306a\u3093\u3068\u306a\u304f\u611f\u3058\u3066\u3082\u3089\u3048\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3068\u3044\u3046\u308f\u3051\u3067\n\u3053\u3053\u3067\u53d6\u308a\u4e0a\u3052\u308b\u306e\u306f\u4ee5\u524d\u306e\u8a18\u4e8b\u3067\u53d6\u308a\u4e0a\u3052\u305f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u7d39\u4ecb\u3068\u305d\u308c\u3092\u4e0a\u624b\u306b\u4f7f\u3063\u305f\u6709\u7406\u6570\u5fa9\u5143\u65b9\u6cd5\u3067\u3059\u3002\n\u8a73\u7d30\u306fP. S. Wang, \"A p-adic algorithm for univariate partial fractions\", (1981)\u3042\u308b\u3044\u306fP. S. Wang, M. J. T. Guy, and J. H. Davenport, \"p-adic reconstruction of rational numbers\" (1982)\u306a\u3069\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u305d\u308c\u306b\u4ed8\u968f\u3057\u3066\u6709\u9650\u4f53\u3092\u30e1\u30a4\u30f3\u306b\u53d6\u308a\u4e0a\u3052\u307e\u3059\u3002\n\u304b\u3044\u3064\u307e\u3093\u3067\u8a00\u3044\u307e\u3059\u3068\u3001\u5168\u3066\u306e\u6f14\u7b97\u3092Int \u306e\u4e0a\uff08\u5b9f\u306f\u3055\u3089\u306b\u3082\u3063\u3068\u300c\u5b89\u5168\u300d\u306a\u9818\u57df\uff09\u3067\u884c\u3063\u3066\u3001\u5143\u306e\u6709\u7406\u6570\u3092\u5fa9\u5143\u3059\u308b\u65b9\u6cd5\u306e\u3054\u7d39\u4ecb\u3067\u3059\u3002\n\u52dd\u624b\u306b\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3055\u308c\u305f\u6841\u843d\u3061\u3068\u547c\u3093\u3067\u3044\u307e\u3059\u304c\u3001\u3042\u308b\u610f\u5473\u6841\u843d\u3061\u3057\u306a\u3044\u74b0\u5883\u3068\u3082\u8a00\u3048\u307e\u3059\u3002\n\n\u74b0\u3068\u4f53\n\u3044\u304d\u306a\u308a\u8131\u7dda\u8a71\u3067\u3059\u304c\u3001\u4f53\u3068\u805e\u3044\u3066\u7686\u3055\u3093\u4f55\u3092\u60f3\u50cf\u3055\u308c\u307e\u3059\u304b\uff1f\n\u3053\u308c\u306f\u66f8\u304d\u8a00\u8449\u3060\u304b\u3089\u51fa\u6765\u308b\u3053\u3068\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u3053\u306e\u6f22\u5b57\u306f\u300c\u305f\u3044\u300d\u3068\u8aad\u307e\u308c\u307e\u3059\u3002\n(\u6b8b\u5ff5\u306a\u304c\u3089\u30bf\u30a4\u30c8\u30eb\u306e\u3088\u3046\u306b\u74b0\u3068\u304f\u3063\u3064\u3051\u3066\u3057\u307e\u3046\u3068\u8aa4\u8aad\u3057\u3066\u3044\u305f\u3060\u3051\u308b\u6a5f\u4f1a\u306f\u6e1b\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u304c\uff09\n\u56f0\u3063\u305f\u3053\u3068\u306b\u82f1\u8a9e\u3067\u306ffields \u3068\u306a\u308a\u7269\u7406\u306e\u754c\u9688\u3067\u306f\u306a\u304b\u306a\u304b\u4f53\u3068\u3057\u3066\u76f8\u624b\u306b\u4f1d\u308f\u3089\u305a\u3082\u3069\u304b\u3057\u3044\u6c17\u6301\u3061\u306b\u306a\u308b\u306e\u3067\u3059\u3001\u3061\u306a\u307f\u306b\u7269\u7406\u5c4b\u304cfields \u3068\u3044\u3046\u3068\u307e\u3041\u9593\u9055\u3044\u306a\u304f\u300c\u5834\u300d\u3060\u3068\u601d\u308f\u308c\u308b\u306e\u3067\u6709\u9650\u4f53\u3092\u6307\u3057\u305f\u304f\u3066finite fields \u3068\u3044\u3046\u3068\u5927\u4f53\u7686\u306a\u306b\u304b\u30a8\u30ad\u30be\u30c1\u30c3\u30af\u306a\u3082\u306e\u3060\u3068\u8aa4\u89e3\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u96c6\u5408\u3068\u6f14\u7b97\uff08\u4ee3\u6570\u69cb\u9020\uff09\n\u96c6\u5408\u306b\u69cb\u9020\u3092\u5165\u308c\u305f\u3082\u306e\u306e\u3046\u3061\u3001\u5272\u5408\u4fbf\u5229\u306a\u3082\u306e\u306b\u5927\u4f53\u540d\u524d\u304c\u4ed8\u3044\u3066\u3044\u307e\u3059\u3001\u4f8b\u3048\u3070\u7fa4\u3001\u74b0\u3001\u4f53\u306a\u3069\u3002\n\u5e73\u305f\u304f\u8a00\u3048\u3070\u7fa4\u3068\u306f\u96c6\u5408\u306b\uff08\u6027\u8cea\u306e\u826f\u3044\uff09\u639b\u3051\u7b97\u306e\u69cb\u9020\u304c\u5165\u3063\u3066\u3044\u308b\u3082\u306e\u3067\u3001\u74b0\u306f\u639b\u3051\u7b97\u3068\u8db3\u3057\u7b97\u3001\u4f53\u306f\u56db\u5247\u6f14\u7b97\u304c\u5165\u3063\u305f\u3082\u306e\u3068\u8a00\u3046\u611f\u3058\u306b\u3002\nHaskeller \u306e\u7686\u3055\u3093\u306f\u3055\u3089\u306b\u30e2\u30ce\u30a4\u30c9\u3082\u3054\u5b58\u77e5\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3001\u3042\u3068\u306f\u570f\u3068\u304b\u3082\u3002\n\u4e0a\u3067\u6319\u3052\u305f\u6709\u7406\u6570\u4f53\u3001\u5b9f\u6570\u4f53\u305d\u3057\u3066\u8907\u7d20\u6570\u4f53\u306f\uff08\u6fc3\u5ea6\u306f\u7570\u306a\u308a\u307e\u3059\u304c\uff09\u7121\u9650\u96c6\u5408\u306b\u4f53\u306e\u69cb\u9020\u304c\u5165\u3063\u3066\u3044\u308b\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n\u8aa4\u89e3\u3092\u6050\u308c\u305a\u306b\u8a00\u3048\u3070\u3001\u96fb\u5353\u306e\u6841\u843d\u3061\u554f\u984c\u306f\u6709\u7406\u6570\u4f53\u306e\u6fc3\u5ea6\u304c\u7121\u9650\u3060\u3068\u3044\u3046\u3053\u3068\u306b\u8d77\u56e0\u3057\u307e\u3059\u3001\u5f93\u3063\u3066\u6709\u9650\u306a\u4f53\u304c\u3042\u308c\u3070\u3082\u3057\u304b\u3057\u305f\u3089\u3001\u3001\u3001\u3068\u3044\u3046\u306e\u304c\u5e0c\u671b\u3067\u3042\u308a\u3001\u4eca\u56de\u306e\u8a71\u306e\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u306a\u304c\u308b\u308f\u3051\u3067\u3059\u3002\n\n\u5270\u4f59\u74b0\n\u6709\u9650\u306a\u74b0\u3068\u3044\u3046\u306e\u306f\u5272\u5408\u7c21\u5358\u306b\u898b\u3064\u304b\u308b\u3082\u306e\u3067\u3059\u3001\u305f\u3068\u3048\u3070\u3042\u308b\u6b63\u306e\u6574\u6570\u306b\u7740\u76ee\u3057\u305f\u4f59\u308a\u306e\u8a08\u7b97\u304c\u74b0\u306e\u69cb\u9020\u3092\u53d6\u308b\u3053\u3068\u306f\u77e5\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u4f8b\u3048\u30706 \u3067\u5272\u3063\u305f\u4f59\u308a\u3067\u3082\u3063\u3066\u7121\u9650\u500b\u306e\u6574\u6570\u3092\u5206\u985e\u3059\u308b\u3068\u306a\u3093\u3068\u8981\u7d20\u304c6 \u500b\u3057\u304b\u306a\u3044\u6709\u9650\u306e\u74b0\u304c\u51fa\u6765\u307e\u3059\u3001\u3053\u308c\u304c\u5270\u4f59\u74b0\uff08\u3042\u308b\u3044\u306f\u5546\u74b0\uff09\u3068\u8a00\u308f\u308c\u308b\u3082\u306e\u3067\n\\mathbb{Z}_6\nZ6{\\mathbb{Z}_6\n}\n\u3068\u3053\u3053\u3067\u306f\u8868\u3057\u307e\u3059\u3002\n\u96c6\u5408\u3068\u3057\u3066\u306f\n\\{0,1,2,3,4,5\\}\n{0,1,2,3,4,5}{\\{0,1,2,3,4,5\\}\n}\n\u3060\u3068\u601d\u3063\u305f\u3089\u826f\u304f\u3001\u8db3\u3057\u7b97\u5f15\u304d\u7b97\u305d\u3057\u3066\u639b\u3051\u7b97\u306f\u3059\u3079\u3066\u666e\u901a\u306b\u5b9f\u884c\u3057\u305f\u5f8cmod6\\mod 6 \u3092\u3068\u308b\u3068\u3044\u3046\u98a8\u306b\u7d04\u675f\u3059\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3001\u4f8b\u3048\u3070\n1+2 == 3 \\mod 6 \\\\\n4+5 == 3 \\mod 6 \\\\\n1-5 == 2 \\mod 6 \\\\\n3*4 == 0 \\mod 6\n1+2==3mod64+5==3mod61\u22125==2mod63\u22174==0mod6{1+2 == 3 \\mod 6 \\\\\n4+5 == 3 \\mod 6 \\\\\n1-5 == 2 \\mod 6 \\\\\n3*4 == 0 \\mod 6\n}\n\u306a\u3069\u3002\n\u3055\u3066\u3053\u3053\u3067\u3053\u306e\u5270\u4f59\u74b0\u3092\u4f53\u306b\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u304b\u3069\u3046\u304b\uff1f\u3068\u3044\u3046\u306e\u304c\u6d6e\u304b\u3073\u3046\u308b\u7591\u554f\u3067\u3059\u3002\n\u305d\u308c\u304c\u51fa\u6765\u308c\u3070\u7b2c\u4e00\u30b9\u30c6\u30c3\u30d7\u30af\u30ea\u30a2\u3067\u3059\u304c\u305d\u306e\u524d\u306b\u9053\u5177\u3092\u4e00\u3064\u7528\u610f\u3057\u307e\u3059\u3002\n\n\u6700\u5927\u516c\u7d04\u6570(gcd)\n\u305d\u3046\u6700\u5927\u516c\u7d04\u6570\u3001\u8a9e\u5442\u304c\u826f\u304f\u3066\u899a\u3048\u308b\u306e\u306f\u899a\u3048\u305f\u306e\u3067\u3059\u304c\u6700\u5c0f\u516c\u500d\u6570\u3068\u3044\u3064\u3082\u3054\u3063\u3061\u3083\u306b\u306a\u3063\u3066\u3057\u307e\u3042\u308c\u3067\u3059\u3001\u79c1\u3060\u3051\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3002\n\u6700\u5927\u516c\u7d04\u6570\u3092\u6c42\u3081\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u53e4\u304f\u304b\u3089\u77e5\u3089\u308c\u3066\u3044\u3066wiki\u306b\u306f\u5927\u5909\u76f4\u89b3\u7684\u306a\u7d20\u6575\u306a\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3082\u7f6e\u3044\u3066\u3042\u308a\u307e\u3057\u305f\u3002\n\u5b9f\u88c5\u3082\u7c21\u5358\u3067\u81ea\u524d\u3067\u3082\u66f8\u3051\u307e\u3059\u3001\u3088\u304f\u6f14\u7fd2\u554f\u984c\u306a\u3069\u306b\u306a\u308b\u306e\u3067\u306f\u7121\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\u7d30\u304b\u3044\u3053\u3068\u3092\u8a00\u3046\u3068\u79c1\u306f\u5927\u5c0f\u5224\u5b9a\u3001\u7b49\u53f7\u5224\u5b9a\u3001\u305d\u3057\u3066\u5f15\u304d\u7b97\u3060\u3051\u3067\u306e\u518d\u5e30\u7684\u306a\u5b9a\u7fa9\u306e\u65b9\u304c\u898b\u901a\u3057\u304c\u826f\u304f\u3066\u597d\u304d\u3067\u3059\u3001\u3053\u308c\u304c\u4e0a\u8a18\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306b\u76f8\u5f53\u3057\u3066\u3044\u308b\u3084\u3064\u3067\u3059\u3002\n\u4ee5\u524d\u306b\u3053\u3053\u3067\u89e3\u3044\u305f\u3088\u3046\u306b\u6700\u5927\u516c\u7d04\u6570\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\n\nmyGCD.lhs\n> myGCD :: Integral a => a -> a -> a\n> myGCD a b\n>   | b < 0 = myGCD a (-b)\n> myGCD a b\n>  | a == b = a\n>  | b >  a = myGCD b a\n>  | b <  a = myGCD (a-b) b \n\n\n\u5927\u304d\u3044\u65b9\u304b\u3089\u5c0f\u3055\u3044\u65b9\u3092\u5f15\u304d\u7d9a\u3051\u3066\u884c\u3063\u305f\u3089\u3088\u3044\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3001\u7d42\u4e86\u5224\u5b9a\u306f\u4e21\u8005\u304c\u7b49\u3057\u304f\u306a\u3063\u305f\u3068\u304d\u3067\u3059\u3001\u3042\u308b\u3044\u306f\u3082\u3046\u4e00\u5ea6\u9069\u7528\u3055\u305b\u3066\u5c0f\u3055\u3044\u307b\u3046\u304c\u96f6\u3067\u3082\u5927\u4e08\u592b\u3002\n\nB\u00e9zout \u306e\u88dc\u984c\n\u3055\u3066\u3053\u3053\u3067\u91cd\u8981\u306a\u88dc\u984c\u3092\u4e00\u3064\u3001\u4efb\u610f\u306e\u6574\u6570a, b \u3068\u305d\u308c\u3089\u306e\u6700\u5927\u516c\u7d04\u6570\u306e\u9593\u306b\u4ee5\u4e0b\u306e\u7b49\u53f7\u3092\u6e80\u305f\u3059x, y \u304c\u5b58\u5728\u3057\u307e\u3059\u3002\n\u3059\u306a\u308f\u3061\n\\forall a,b \\in \\mathbb{Z}, \\exists x,y \\in \\mathbb{Z}, s.t. \\\\\na*x+b*y == \\gcd(a,b)\n\u2200a,b\u2208Z,\u2203x,y\u2208Z,s.t.a\u2217x+b\u2217y==gcd{\\forall a,b \\in \\mathbb{Z}, \\exists x,y \\in \\mathbb{Z}, s.t. \\\\\na*x+b*y == \\gcd(a,b)\n}\n\u4ee5\u524d\u3053\u3053\u3067\u53d6\u308a\u4e0a\u3052\u305f\u3053\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u3053\u306e\u4e8c\u6574\u6570x, y \u3092\u69cb\u6210\u7684\u306b\u4f5c\u308b\u65b9\u6cd5\u3068\u3057\u3066\u77e5\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\nHaskeller \u306e\u65b9\u306b\u306f\uff08\u578b\u306b\u306f\uff1f\uff09\u5b9f\u7269\u306e\u30b3\u30fc\u30c9\u306e\u65b9\u304c\u53ef\u8aad\u6027\u304c\u9ad8\u3044\u3053\u3068\u3060\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\u307e\u305a\u5b9f\u7269\u3092\u3070\u3002\n\nexGCD.lhs\n> exGCD' :: Integral n => n -> n -> ([n], [n], [n], [n])\n> exGCD' a b = (qs, rs, ss, ts)\n>   where\n>     qs = zipWith quot rs (tail rs)\n>     rs = takeUntil (==0) r'\n>     r' = steps a b\n>     ss = steps 1 0\n>     ts = steps 0 1\n>     steps a b = rr\n>       where rr@(_:rs) = a:b: zipWith (-) rr (zipWith (*) qs rs)\n>         \n> takeUntil :: (a -> Bool) -> [a] -> [a]\n> takeUntil p = foldr func []\n>   where\n>     func x xs \n>       | p x       = []\n>       | otherwise = x : xs\n>\n> -- a*x + b*y = gcd a b\n> exGcd a b = (g, x, y)\n>   where\n>     (_,r,s,t) = exGCD' a b\n>     g = last r\n>     x = last . init $ s\n>     y = last . init $ t\n\n\n\u4eca\u56de\u306f\u3053\u306e\u300c\u88dc\u52a9\u95a2\u6570\u300d\u3068\u601d\u308f\u308c\u3066\u305fexGCD'\u3068\u305d\u306e\u300c\u526f\u7523\u7269\u300d\u3067\u3042\u308b\u6574\u6570\u30ea\u30b9\u30c8\u305f\u3061\u304c\u4eca\u56de\u306e\u8a71\u306e\u9053\u5177\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u8a3c\u660e\u3001\u306e\u524d\u306b\n\u3069\u3046\u3044\u3046\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304b\u3068\u3044\u3046\u3068\u3001\u521d\u671f\u6761\u4ef6\u3068\u3057\u3066\n\n(r_0,s_0,t_0) := (a,1,0) \\\\\n(r_1,s_1,t_1) := (b,0,1)\n\n{\n(r_0,s_0,t_0) := (a,1,0) \\\\\n(r_1,s_1,t_1) := (b,0,1)\n\n}{\n(r_0,s_0,t_0) := (a,1,0) \\\\\n(r_1,s_1,t_1) := (b,0,1)\n\n}\n\u3055\u3089\u306b\n\nq_i := quot(r_{i-2}, r_{i-1})\n\n{\nq_i := quot(r_{i-2}, r_{i-1})\n\n}{\nq_i := quot(r_{i-2}, r_{i-1})\n\n}\n\u3068\u3057\u307e\u3059\u3001\u3064\u307e\u308a\u4f59\u308a\u3067\u3059\u3001\u4f8b\u3048\u3070\n\nquot(12,5) = 2\n\n{\nquot(12,5) = 2\n\n}{\nquot(12,5) = 2\n\n}\n\u3042\u3068\u306f\u518d\u5e30\u7684\u306b\n\nr_i := r_{i-2} - q_i * r_{i-1} \\\\\ns_i := s_{i-2} - q_i * s_{i-1} \\\\\nt_i := t_{i-2} - q_i * t_{i-1} \\\\\n\n{\nr_i := r_{i-2} - q_i * r_{i-1} \\\\\ns_i := s_{i-2} - q_i * s_{i-1} \\\\\nt_i := t_{i-2} - q_i * t_{i-1} \\\\\n\n}{\nr_i := r_{i-2} - q_i * r_{i-1} \\\\\ns_i := s_{i-2} - q_i * s_{i-1} \\\\\nt_i := t_{i-2} - q_i * t_{i-1} \\\\\n\n}\n\u3068\u5b9a\u7fa9\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u505c\u6b62\u6761\u4ef6\u306f\n\nr_k = 0\n\n{\nr_k = 0\n\n}{\nr_k = 0\n\n}\n\u3068\u306a\u308b\u3053\u3068\u3068\u3057\u307e\u3059\u3002\n\n\u8a3c\u660e\n\u4f55\u3092\u8a3c\u660e\u3059\u308b\u304b\u3068\u3044\u3046\u3068\u3001\u305d\u3046\u3001B\u00e9zout \u306e\u88dc\u984c\u3067\u3059\u3002\n\\forall a,b \\in \\mathbb{Z}, \\exists x,y \\in \\mathbb{Z}, s.t. \\\\\na*x+b*y == \\gcd(a,b)\n{\\forall a,b \\in \\mathbb{Z}, \\exists x,y \\in \\mathbb{Z}, s.t. \\\\\na*x+b*y == \\gcd(a,b)\n}{\\forall a,b \\in \\mathbb{Z}, \\exists x,y \\in \\mathbb{Z}, s.t. \\\\\na*x+b*y == \\gcd(a,b)\n}\n\u3059\u306a\u308f\u3061\u4efb\u610f\u306e\u6574\u6570a,b \u306b\u5bfe\u3057\u3066 a*x+b*y == \\gcd(a,b)  a*x+b*y == \\gcd(a,b)  \u306a\u308b\u4e8c\u6574\u6570x,y \u3068gcd(a,b)gcd(a,b) \u3092\u3001\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u69cb\u6210\u7684\u306b\u4f5c\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3088\uff01\u3068\u3044\u3046\u306e\u304c\u4e3b\u5f35\u3067\u3059\u3002\n\u3053\u3053\u3067\u306fa>ba>b \u3092\u4eee\u5b9a\u3057\u307e\u3059\u3001\u3053\u308c\u306f\u7279\u306b\u610f\u5473\u306e\u3042\u308b\u4eee\u5b9a\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u4e00\u822c\u6027\u306f\u5931\u308f\u306a\u3044\u3001\u5358\u306b\u7c21\u4fbf\u6027\u306e\u305f\u3081\u3067\u3059\u3002\n\u307e\u305a\u59cb\u3081\u306b\u3053\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u505c\u6b62\u6027\u3092\u8ff0\u3079\u306d\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\u5b9a\u7fa9\u3088\u308a\nr_i := r_{i-2} - q_i * r_{i-1}\n{r_i := r_{i-2} - q_i * r_{i-1}\n}{r_i := r_{i-2} - q_i * r_{i-1}\n}\n\u3053\u306e\u6570\u5217r_ir_i\u306f\u5358\u8abf\u306b\u6e1b\u5c11\u3059\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3001\u3053\u3053\u3067a>ba>b\u304c\u751f\u304d\u308b\u308f\u3051\u3067\u3059\u3002\n\u505c\u6b62\u6761\u4ef6\u306fr=0r=0\u306a\u306e\u3067\u3001\u3044\u3064\u304b\u5fc5\u305a\u30d2\u30c3\u30c8\u3059\u308b\u306e\u3067\u505c\u6b62\u6027\u306f\u5927\u4e08\u592b\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3001\u3059\u306a\u308f\u3061\u6709\u9650\u56de\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u6b62\u307e\u308a\u307e\u3059\u3002\n\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3092kk\u3068\u3057\u307e\u3059\u3001\u3059\u306a\u308f\u3061r_k = 0r_k = 0\u3002\n\u6b21\u306b\u5404\u30b9\u30c6\u30c3\u30d7\u3067\u306err\u306e\u6319\u52d5\u3092\u898b\u307e\u3057\u3087\u3046\u3002\n\u5272\u308a\u7b97\u306e\u904e\u7a0b\u3067\n\n\\gcd(r_{i-1}, r_i) = \\gcd(r_{i-1}, r_{i-2} - q_i*r_{i-1}) \\\\\n= \\gcd(r_{i-1}, r_{i-2})\n\n{\n\\gcd(r_{i-1}, r_i) = \\gcd(r_{i-1}, r_{i-2} - q_i*r_{i-1}) \\\\\n= \\gcd(r_{i-1}, r_{i-2})\n\n}{\n\\gcd(r_{i-1}, r_i) = \\gcd(r_{i-1}, r_{i-2} - q_i*r_{i-1}) \\\\\n= \\gcd(r_{i-1}, r_{i-2})\n\n}\n\u3068\u306a\u308b\u3053\u3068\u304b\u3089\u3001\n\n\\gcd(a,b) = \\gcd(r_0, r_1) = ... = \\gcd(r_{k-1},r_k=0)\n\n{\n\\gcd(a,b) = \\gcd(r_0, r_1) = ... = \\gcd(r_{k-1},r_k=0)\n\n}{\n\\gcd(a,b) = \\gcd(r_0, r_1) = ... = \\gcd(r_{k-1},r_k=0)\n\n}\n\u304c\u5206\u304b\u308a\u307e\u3059\u3001\u3059\u306a\u308f\u3061\n\n\\gcd(a,b) = r_{k-1}\n\n{\n\\gcd(a,b) = r_{k-1}\n\n}{\n\\gcd(a,b) = r_{k-1}\n\n}\n\u6b21\u306b\u5404\u30b9\u30c6\u30c3\u30d7\u3067B\u00e9zout \u6052\u7b49\u5f0f\u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u3001\u306f\u8aad\u8005\u306e\u65b9\u3078\u306e\u6f14\u7fd2\u3068\u3057\u307e\u3057\u3087\u3046\uff1a\n\na*s_i + b * t_i = r_i\n\n{\na*s_i + b * t_i = r_i\n\n}{\na*s_i + b * t_i = r_i\n\n}\n\u3053\u308c\u3089\u3092\u5408\u308f\u305b\u3066\n\n\\gcd(a,b) = r_{k-1} = a*s_{k-1} + b*t_{k-1}\n\n{\n\\gcd(a,b) = r_{k-1} = a*s_{k-1} + b*t_{k-1}\n\n}{\n\\gcd(a,b) = r_{k-1} = a*s_{k-1} + b*t_{k-1}\n\n}\n\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\u3001\u3059\u306a\u308f\u3061\u6700\u5927\u516c\u7d04\u6570\u3068x=s_{k-1}, y=t_{k-1}x=s_{k-1}, y=t_{k-1}\u304c\u69cb\u6210\u7684\u306b\u5f97\u3089\u308c\u305f\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\n\u9006\u5143\n\u3053\u3053\u304b\u3089\u306f\\gcd\\gcd \u3092\u4f7f\u3046\u7acb\u5834\u306b\u4ee3\u308f\u308a\u307e\u3059\u3002\n\u3082\u3057\u4e8c\u6574\u6570a, b \u304c\u4e92\u3044\u306b\u7d20\u306a\u3089\u3070\\gcd(a,b) == 1\\gcd(a,b) == 1\u3092\u6e80\u305f\u3057\u307e\u3059\u3001\u3055\u3089\u306b\u3053\u306e\u6642B\u00e9zout \u306e\u88dc\u984c\u304b\u3089\uff08\u3042\u308b\u3044\u306f\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304b\u3089\uff09\na*x+b*y == \\gcd(a,b) == 1\n{a*x+b*y == \\gcd(a,b) == 1\n}{a*x+b*y == \\gcd(a,b) == 1\n}\n\u306a\u308b\u4e8c\u6574\u6570x, y\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u306e\u3068\u304d\u4f8b\u3048\u3070\u5270\u4f59\u74b0\\mathbb{Z}_b\\mathbb{Z}_b\u306e\u4e0a\u3067\u8003\u3048\u3066\u307f\u308b\u3068\n1 == a*x+b*y \\mod b \\\\\n1 == a*x \\mod b\n{1 == a*x+b*y \\mod b \\\\\n1 == a*x \\mod b\n}{1 == a*x+b*y \\mod b \\\\\n1 == a*x \\mod b\n}\n\u3068\u306a\u308a\u3001\u306a\u3093\u3068\u5270\u4f59\u74b0\\mathbb{Z}_b\\mathbb{Z}_b\u306e\u4e0a\u3067\u306fx \\mod bx \\mod b \u304ca \\mod ba \\mod b \u306e\uff08\u639b\u3051\u7b97\u306b\u5bfe\u3059\u308b\uff09\u9006\u5143\u3068\u306a\u308b\u308f\u3051\u3067\u3059\u3002\n\u4f8b\u3048\u3070\nPrelude> gcd 6 1\n1\nPrelude> gcd 6 5\n1\n\n\u306a\u3069\u304b\u3089\\mathbb{Z}_6\\mathbb{Z}_6\u3067\u306f1 \u306f 1\u306e\u9006\u5143\u30675 \u306f5 \u306e\u9006\u5143\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n1*1 == 1 \\\\\n5*5 == 4*6+1  \n\n{\n1*1 == 1 \\\\\n5*5 == 4*6+1  \n\n}{\n1*1 == 1 \\\\\n5*5 == 4*6+1  \n\n}\n\u3057\u304b\u3057\u6b8b\u308a\u306e2,3,4 \u306f\u9006\u5143\u3092\u6301\u305f\u306a\u3044\u3053\u3068\u304c\u5206\u304b\u308b\u306e\u3067\\mathbb{Z}_6\\mathbb{Z}_6 \u306f\u4f53\u306b\u306a\u3089\u306a\u3044\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n\u7d20\u6570\u4f53\n\u4e8c\u6574\u6570a,b \u304c\u4e92\u3044\u306b\u7d20\u306a\u3089\u3070a \\mod ba \\mod b \u306e\u9006\u5143\u304c\u5b58\u5728\u3057\u3001\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u5247\u308c\u3070\u305d\u306e\u5019\u88dcx \u304c\u5f97\u3089\u308c\u3001\u3042\u3068\u306fx \\mod bx \\mod b\u3092\u8a08\u7b97\u3059\u308c\u3070\u826f\u3044\u3068\u8a00\u3046\u306e\u304c\u30df\u30bd\u3067\u3059\u3002\n\u7d20\u6570p \u306b\u5bfe\u3057\u3066\\mathbb{Z}_p\\mathbb{Z}_p\u3092\u8003\u3048\u308b\u3068\u3001\u3053\u306e\u8981\u7d20\n\\{0,1 \\cdots (p-1)\\}\n{\\{0,1 \\cdots (p-1)\\}\n}{\\{0,1 \\cdots (p-1)\\}\n}\n\u306e\u51850 \u3092\u9664\u304f\u5168\u3066\u306e\u5143a \u306b\u95a2\u3057\u3066\n\\gcd(a,p) == 1, a=1,2\\cdots (p-1)\n{\\gcd(a,p) == 1, a=1,2\\cdots (p-1)\n}{\\gcd(a,p) == 1, a=1,2\\cdots (p-1)\n}\n\u304c\u6210\u308a\u7acb\u3064\u306e\u3067\u3001\u3053\u306e\u7d20\u6570\u74b0\u306f\u4f53\u306b\u306a\u308b\uff01\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u4f8b\u3048\u3070\\mathbb{Z}_5\\mathbb{Z}_5\u3084\\mathbb{Z}_7\\mathbb{Z}_7\u304c\u4f53\u306b\u306a\u308b\u3053\u3068\u306f\nPrelude> map (gcd 5) [1..4]\n[1,1,1,1]\nPrelude> map (gcd 7) [1..6]\n[1,1,1,1,1,1]\n\n\u304b\u3089\u5206\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3001\u554f\u984c\u306f\\gcd\\gcd\u3060\u3051\u3067\u306f\u9006\u5143\u306f\u3055\u3063\u3071\u308a\u5206\u304b\u3089\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u304c\u3001\u6211\u3005\u306b\u306f\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u3042\u308a\u307e\u3059\uff01\u3057\u305f\u304c\u3063\u3066\n*Ffield> map (exGCD 5) [1..4]\n[(1,0,1),(1,1,-2),(1,-1,2),(1,1,-1)]\n*Ffield> (-2) `mod` 5\n3\n*Ffield> 2 `mod` 5\n2\n*Ffield> (-1) `mod` 5\n4\n\n\u306a\u3069\u304b\u3089\n1^{-1} == 1 \\mod 5 \\\\\n2^{-1} == 3 \\mod 5 \\\\\n3^{-1} == 2 \\mod 5 \\\\\n4^{-1} == 4 \\mod 5 \n{1^{-1} == 1 \\mod 5 \\\\\n2^{-1} == 3 \\mod 5 \\\\\n3^{-1} == 2 \\mod 5 \\\\\n4^{-1} == 4 \\mod 5 \n}{1^{-1} == 1 \\mod 5 \\\\\n2^{-1} == 3 \\mod 5 \\\\\n3^{-1} == 2 \\mod 5 \\\\\n4^{-1} == 4 \\mod 5 \n}\n\u304c\u5206\u304b\u308a\u307e\u3059\u3001\u771f\u3093\u4e2d\u306e\u4e8c\u7d44\u306f\n2*3 == 5 + 1\n{2*3 == 5 + 1\n}{2*3 == 5 + 1\n}\n\u304b\u3089\u7406\u89e3\u3057\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\\mathbb{Z}_7\\mathbb{Z}_7\u3067\u306f\n*Ffield> map (exGCD 7) [1..6]\n[(1,0,1),(1,1,-3),(1,1,-2),(1,-1,2),(1,-2,3),(1,1,-1)]\n*Ffield> map (\\(_,_,c) -> c) it\n[1,-3,-2,2,3,-1]\n*Ffield> map (`mod` 7) it\n[1,4,5,2,3,6]\n\n\u304b\u3089\n1^{-1} == 1 \\mod 7 \\\\\n2^{-1} == 4 \\mod 7 \\\\\n3^{-1} == 5 \\mod 7 \\\\\n4^{-1} == 2 \\mod 7 \\\\\n5^{-1} == 3 \\mod 7 \\\\\n6^{-1} == 6 \\mod 7 \n{1^{-1} == 1 \\mod 7 \\\\\n2^{-1} == 4 \\mod 7 \\\\\n3^{-1} == 5 \\mod 7 \\\\\n4^{-1} == 2 \\mod 7 \\\\\n5^{-1} == 3 \\mod 7 \\\\\n6^{-1} == 6 \\mod 7 \n}{1^{-1} == 1 \\mod 7 \\\\\n2^{-1} == 4 \\mod 7 \\\\\n3^{-1} == 5 \\mod 7 \\\\\n4^{-1} == 2 \\mod 7 \\\\\n5^{-1} == 3 \\mod 7 \\\\\n6^{-1} == 6 \\mod 7 \n}\n\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n\u62e1\u5f35\u3055\u308c\u305f$\\mod$\n\u666e\u901a\u306e\\mod p\\mod p \u306f\u6574\u6570\u3092\u53d6\u3063\u3066\u6574\u6570\u3092\u8fd4\u3059\u95a2\u6570\u3067\u3059\u3001\u3059\u306a\u308f\u3061\n- \\mod p :: \\mathbb{Z} \\to \\mathbb{Z}_p\n{- \\mod p :: \\mathbb{Z} \\to \\mathbb{Z}_p\n}{- \\mod p :: \\mathbb{Z} \\to \\mathbb{Z}_p\n}\n\u3068\u3044\u3046\"\u578b\"\u3092\u53d6\u308b\u3068\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\u3053\u3053\u3067\u3053\u306e\u5b9a\u7fa9\u57df\u3092\u6709\u7406\u6570\u307e\u3067\u62e1\u5f35\u3057\u3066\u304a\u304d\u307e\u3059\u3001\u3059\u306a\u308f\u3061\nq=\\frac{n}{d} \\mapsto (q \\mod p) := (a \\times ?(b^{-1} \\mod p)) \\mod p\n{q=\\frac{n}{d} \\mapsto (q \\mod p) := (a \\times ?(b^{-1} \\mod p)) \\mod p\n}{q=\\frac{n}{d} \\mapsto (q \\mod p) := (a \\times ?(b^{-1} \\mod p)) \\mod p\n}\n\u3067\u6709\u7406\u6570q \u306e\\mod p\\mod p \u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\n? :: \\mathbb{Z}_p \\to \\mathbb{Z}\n{? :: \\mathbb{Z}_p \\to \\mathbb{Z}\n}{? :: \\mathbb{Z}_p \\to \\mathbb{Z}\n}\n\u306f\u81ea\u7136\u306a\u5305\u542b\u3042\u308b\u3044\u306f\u5fd8\u5374\u95a2\u6570\u3067\u3001\\mathbb{Z}_p\\mathbb{Z}_p\u306e\u69cb\u9020\u3092\u5fd8\u308c\u3066\u305f\u3060\u306e\u6574\u6570\u3060\u3068\u601d\u3044\u307e\u3057\u3087\u3046\u3001\u3068\u3044\u3046\u95a2\u6570\u3067\u3059\u3002\n\u4eca\u56de\u306e\u30df\u30c3\u30b7\u30e7\u30f3\u306f\u3053\u306e\\mathbb{Z}_p\\mathbb{Z}_p \u306e\u5143\u3067\u3042\u308b\u3001\u3059\u306a\u308f\u3061\n0 \\leq a \\leq (p-1)\n{0 \\leq a \\leq (p-1)\n}{0 \\leq a \\leq (p-1)\n}\n\u3092\u6e80\u305f\u3059\u3001\u300c\u6709\u7406\u6570q \u306e\\mod p\\mod p \u3067\u306e\u50cf\u300d\u304b\u3089\u5143\u306eq \u3092\u63a8\u6e2c\u3057\u307e\u3057\u3087\u3046\u3001\u3068\u3044\u3046\u8a71\u3067\u3059\u3002\n\n\u6709\u7406\u6570\u306e\u5fa9\u5143\uff08\u7d20\u6734\u306a\u65b9\u6cd5\uff09\n\u3055\u3066\u62e1\u5f35\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u526f\u7523\u7269\u3068\u3057\u3066\u793a\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3082\u306e\u3068\u3057\u3066\u3001\u5404\u30b9\u30c6\u30c3\u30d7ii \u306b\u304a\u3044\u3066Bezout \u306e\u6052\u7b49\u5f0f\u304c \u6210\u308a\u7acb\u3064\u3068\u3044\u3046\u306e\u304c\u3042\u308a\u307e\u3059\u3002\na* s_i + b*t_i = r_i\n{a* s_i + b*t_i = r_i\n}{a* s_i + b*t_i = r_i\n}\n\n\u7d20\u6734\u306a\u63a8\u6e2c\n\u3053\u3053\u3067\u6211\u3005\u306e\u554f\u984c\u8a2d\u5b9a\u3068\u3057\u3066b=pb=p \u3092\u7d20\u6570\u3068\u3057\u3066\u3068\u308a\u3001\u304b\u3064aa \u306f\u30bf\u30fc\u30b2\u30c3\u30c8\u306e\u6709\u7406\u6570\u306eZ_pZ_p \u306e\u4e0a\u3067\u306e\u50cf\u3060\u3068\u3057\u307e\u3059\u3001\u3059\u306a\u308f\u3061\na = (q \\mod p)\n{a = (q \\mod p)\n}{a = (q \\mod p)\n}\n\u3053\u306e\u6642\u5404\u30b9\u30c6\u30c3\u30d7\u3067\u306eBezout \u6052\u7b49\u5f0f\u306e\u4e21\u8fba\u3092Z_pZ_p \u3067\u8003\u3048\u308b\u3068\na * s_i = r_i \\mod p\n{a * s_i = r_i \\mod p\n}{a * s_i = r_i \\mod p\n}\n\u5f93\u3063\u3066\na = (\\frac{n}{d} \\mod p )\n{a = (\\frac{n}{d} \\mod p )\n}{a = (\\frac{n}{d} \\mod p )\n}\n\u306fZ_pZ_p \u306e\u4e0a\u3067\n(\\frac{n}{d} \\mod p) = r_i * {s_i}^{-1} \\mod p\n\n\u3092\u6e80\u305f\u3059\u3053\u3068\u304b\u3089 \\frac{n}{d}\\frac{n}{d}\u306f\u5404\u30b9\u30c6\u30c3\u30d7\u3067\n\\frac{s_i}{r_i}\n{\\frac{s_i}{r_i}\n}{\\frac{s_i}{r_i}\n}\n\u3068\"\u63a8\u6e2c\u3055\u308c\u308b\"\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\n\u3053\u3053\u3067Wang \u304c\u793a\u3057\u305f\u306e\u306f\ns_i^2,r_i^2 \\lessapprox p\n{s_i^2,r_i^2 \\lessapprox p\n}{s_i^2,r_i^2 \\lessapprox p\n}\n\u306a\u308b\u30b9\u30c6\u30c3\u30d7ii \u306b\u304a\u3044\u3066\u5143\u306e\u6709\u7406\u6570\u306f\nq = \\frac{s_i}{r_i}\n{q = \\frac{s_i}{r_i}\n}{q = \\frac{s_i}{r_i}\n}\n\u3067\u3042\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n\u554f\u984c\u70b9\n\u3053\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u554f\u984c\u70b9\u306f\u63a8\u6e2c\u306e\u7cbe\u5ea6\u304c\ns_i^2,r_i^2 \\lessapprox p\n{s_i^2,r_i^2 \\lessapprox p\n}{s_i^2,r_i^2 \\lessapprox p\n}\n\u3068\u3044\u3046\u6761\u4ef6\u306e\u305b\u3044\u3067\u5e73\u65b9\u6839\u3067\u6291\u3048\u3089\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u70b9\u3067\u3059\u3002\n\u4f8b\u3048\u3070\u7d20\u6570\u3068\u3057\u306610007\u3092\u53d6\u3063\u305f\u3068\u3059\u308c\u3070\u63a8\u6e2c\u3067\u304d\u308b\u6709\u7406\u6570\u306f\u5206\u6bcd\u5206\u5b50\u3068\u3082\u306b10^210^2\u7a0b\u5ea6\u307e\u3067\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u3068\u6709\u7406\u6570\u306e\u5fa9\u5143\n\u4e3b\u5f35\u3068\u8a3c\u660e\u306fwiki\u306e\u8a72\u5f53\u30da\u30fc\u30b8\u306b\u4efb\u305b\u308b\u3068\u3057\u307e\u3059\u3002\n\u30df\u30bd\u306f\uff12\u3064\u306e\u4e92\u3044\u306b\u7d20\u306ap_1,p_2p_1,p_2\uff08\u7d20\u6570\u3067\u306a\u304f\u3066\u3082\u3001\u4e92\u3044\u306b\u7d20\u306a\u3089ok\uff09\u304c\u3042\u3063\u3066\u3001\u304b\u3064Z_{p_1}Z_{p_1}\u3068Z_{p_2}Z_{p_2}\u306e\u4e0a\u3067\u306e\u5024\n\na_1 = (q \\mod p_1) \\\\\na_2 = (q \\mod p_1)\n\n{\na_1 = (q \\mod p_1) \\\\\na_2 = (q \\mod p_1)\n\n}{\na_1 = (q \\mod p_1) \\\\\na_2 = (q \\mod p_1)\n\n}\n\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u308c\u3070\n\na = (q \\mod p_1*p_2)\n\n{\na = (q \\mod p_1*p_2)\n\n}{\na = (q \\mod p_1*p_2)\n\n}\n\u306a\u308baa \u3092\u305f\u3060\uff11\u3064\u6c7a\u3081\u3066\u3042\u3052\u3089\u308c\u308b\u3068\u3044\u3046\u70b9\u306b\u3064\u304d\u307e\u3059\u3002\n\n\u554f\u984c\u8a2d\u5b9a\n\u307e\u305a\u6bd4\u8f03\u7684\u5927\u304d\u306a\u7d20\u6570\u3092\u5e7e\u3064\u304b\u7528\u610f\u3057\u3066\u304a\u304d\u307e\u3059\u3001\u4f8b\u3048\u3070\nPrelude Data.Numbers.Primes> take 10 $ dropWhile (<10^4) primes\n[10007,10009,10037,10039,10061,10067,10069,10079,10091,10093]\n\n\u305d\u308c\u305e\u308c\u306e\u7d20\u6570\u306b\u304a\u3051\u308b\u5546\u4f53Z_pZ_p \u306b\u5bfe\u3057\u3066\n(a_1, p_1)\\\\\n(a_2, p_2)\\\\\n\\vdots\n{(a_1, p_1)\\\\\n(a_2, p_2)\\\\\n\\vdots\n}{(a_1, p_1)\\\\\n(a_2, p_2)\\\\\n\\vdots\n}\n\u306a\u308b\u30c7\u30fc\u30bf\u304c\u3042\u308b\u3068\u3057\u307e\u3059\u3001\u306a\u3093\u3067\u3053\u3093\u306a\u3082\u3093\u3092\u8003\u3048\u308b\u306e\uff1f\u305d\u308c\u306f\u6700\u5f8c\u306b\u5c11\u3057\u3060\u3051\u66f8\u304d\u307e\u3059\u304c\u307e\u3041\u305d\u3046\u3044\u3046\u554f\u984c\u8a2d\u5b9a\u3060\u3068\u601d\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\u5358\u306a\u308b\u6709\u7406\u6570\u306e\u8a08\u7b97\u306a\u3089\u6574\u6570\u3092\uff12\u3064\u5206\u3068\u308b\u30c7\u30fc\u30bf\u578b\u306b\u3001\u8272\u3005\u3075\u3055\u308f\u3057\u3044\u6f14\u7b97\u3092\u5c0e\u5165\u3057\u3066\u3042\u3052\u305f\u3089\u3044\u3044\u3060\u3051\u306a\u306e\u3067\u3053\u3093\u306a\u8cea\u9762\u5012\u304f\u3055\u3044\u3053\u3068\u3092\u8003\u3048\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u3053\u3053\u3067\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u306e\u5b9a\u7406\u306b\u3088\u308a\u6700\u521d\u306e\uff12\u3064\u306e\u50cf\u3068\u7d20\u6570\u304b\u3089\u65b0\u305f\u306b\n\n(a,p_1*p_2)\n\n{\n(a,p_1*p_2)\n\n}{\n(a,p_1*p_2)\n\n}\n\u306a\u308b\u30c7\u30fc\u30bf\u3092\u4f5c\u308a\u307e\u3059\u3001aa \u306e\u30ec\u30b7\u30d4\u306fwiki\u306e\u8a72\u5f53\u30da\u30fc\u30b8\u53c2\u7167\u306e\u3053\u3068\u3002\n\u3053\u306e\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u62e1\u5f35\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306b\u304b\u3051\u307e\u3059\u3068\u4eca\u5ea6\u306f\u5206\u6bcd\u5206\u5b50\u3068\u3082\u306b\ns_i^2,r_i^2 \\lessapprox (p_1*p_2)\n{s_i^2,r_i^2 \\lessapprox (p_1*p_2)\n}{s_i^2,r_i^2 \\lessapprox (p_1*p_2)\n}\n\u3068\u3044\u3046\u7bc4\u56f2\u3067\u6c7a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3067\u8db3\u3089\u306a\u3051\u308c\u3070\u66f4\u306b\u3082\u3046\u4e00\u3064\u7d20\u6570\u3092\u53d6\u3063\u3066\u304d\u3066\ns_i^2,r_i^2 \\lessapprox (p_1*p_2*p_3)\n{s_i^2,r_i^2 \\lessapprox (p_1*p_2*p_3)\n}{s_i^2,r_i^2 \\lessapprox (p_1*p_2*p_3)\n}\n\u3068\u3044\u3046\u98a8\u306b\u3069\u3093\u3069\u3093\u5236\u9650\u3092\u3086\u308b\u304f\u3057\u3066\u3044\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u79c1\u306e\u74b0\u5883\uff08\u3059\u306a\u308f\u3061\u7d20\u6570\u3068\u3057\u306610^4 \u7a0b\u5ea6\u306e\u3082\u306e\u304b\u3089\u53d6\u3063\u305f\u5834\u5408\uff09\u306a\u3089\u3070\u4e0a\u8a18\u306e\u7d20\u6570\u306a\u30894\u3064\u304b5\u3064\u304b\u53d6\u308c\u3070Int \u306b\u304a\u3044\u3066\u5145\u5206\u306a\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002 \nPrelude> maxBound :: Int\n9223372036854775807\nPrelude> 2^63 -1\n9223372036854775807\nPrelude> logBase 10 it\n18.964889726830812\n\n\u5f93\u3063\u3066\u4f8b\u3048\u30703\u3064\u53d6\u3063\u3066\u5fa9\u5143\u3057\u305f\u5024\u30684\u3064\u306e\u5024\u3001\u305d\u3057\u30665\u3064\u306e\u5024\u304c\u4e00\u81f4\u3057\u3066\u3044\u308c\u3070\u5b9f\u7528\u4e0a\u30e6\u30cb\u30fc\u30af\u306b\u5143\u306e\u6709\u7406\u6570\u304c\u5fa9\u5143\u3067\u304d\u3066\u308b\u3068\u3057\u3066\u826f\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002 \n\u3053\u308c\u306f\u5618\u3067\u3059\u3001\u6700\u5f8c\u306b\u8ffd\u8a18\u3067\u8a02\u6b63\u3055\u308c\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\u30aa\u30fc\u30c0\u30fc\u306e\u8aad\u307f\u3068\u3057\u3066\u306f\ns_i^2,r_i^2 \\lessapprox (p_1*\\cdots)\n{s_i^2,r_i^2 \\lessapprox (p_1*\\cdots)\n}{s_i^2,r_i^2 \\lessapprox (p_1*\\cdots)\n}\n\u306e\u53f3\u8fba\u304cInt \u306e\u6700\u5927\u5024\u306e\u4e8c\u4e57\u3092\u4e0a\u304b\u3089\u6291\u3048\u305f\u3089\u826f\u3044\u306e\u3067\u3001\u3059\u306a\u308f\u306110 \u500b\u304c\u76ee\u5b89\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u305c\u306a\u3089\np_1, \\cdots \\in o(10^4)\n{p_1, \\cdots \\in o(10^4)\n}{p_1, \\cdots \\in o(10^4)\n}\n\u3068\u53d6\u3063\u305f\u7d20\u6570\u3068\nPrelude> logBase 10 (2^63-1)\n18.964889726830812\n\n\u3092\u6bd4\u3079\u305f\u3089\u826f\u3044\u306e\u3067\u3001\u5927\u4f5310\u500b\u306e\u7a4d\u3067Int \u3092\u30ab\u30d0\u30fc\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\n\u6709\u7406\u6570\u306e\u5fa9\u5143\n\u4ee5\u4e0b\u304c\u4eca\u56de\u306e\u30b3\u30fc\u30c9\u306e\u5168\u666f\u306b\u306a\u308a\u307e\u3059\u3001\u7121\u4e8bquickCheck \u3082\u901a\u308a\u307e\u3057\u305f\u3002\n\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u306e\u8a08\u7b97\u306e\u3068\u3053\u308d\u3060\u3051IntegerInteger \u3092\u4f7f\u3063\u3066\u307e\u3059\u304c\u3001\u305d\u308c\u4ee5\u5916\u306e\u6f14\u7b97\u306f\u57fa\u672c\u7684\u306b\u30de\u30b7\u30f3\u30b5\u30a4\u30ba\u306eIntInt \u3067\u51fa\u6765\u308b\u306e\u304c\u30df\u30bd\u3067\u3059\u3002\n\n> module Ffield where\n\n> import Data.Ratio \n> import Data.Maybe\n> import Data.Numbers.Primes\n> import Test.QuickCheck\n\n> coprime :: Integral a => a -> a -> Bool\n> coprime a b = gcd a b == 1\n\nConsider a finite ring\n  Z_n := [0..(n-1)]\nof some Int number.\nIf any non-zero element has its multiplication inverse, then the ring is a field:\n\n> -- Our target should be in Int.\n> isField :: Int -> Bool\n> isField = isPrime\n\n> exGCD' :: (Integral n) => n -> n -> ([n], [n], [n], [n])\n> exGCD' a b = (qs, rs, ss, ts)\n>   where\n>     qs = zipWith quot rs (tail rs)\n>     rs = takeUntil (==0) r'\n>     r' = steps a b\n>     ss = steps 1 0\n>     ts = steps 0 1\n>     steps a b = rr\n>       where \n>         rr@(_:rs) = a:b: zipWith (-) rr (zipWith (*) qs rs)\n>\n> takeUntil :: (a -> Bool) -> [a] -> [a]\n> takeUntil p = foldr func []\n>   where\n>     func x xs \n>       | p x       = []\n>       | otherwise = x : xs\n>\n> -- a*x + b*y = gcd a b\n> exGCD :: Integral t => t -> t -> (t, t, t)\n> exGCD a b = (g, x, y)\n>   where\n>     (_,r,s,t) = exGCD' a b\n>     g = last r\n>     x = last . init $ s\n>     y = last . init $ t\n>\n> -- a^{-1} (in Z_p) == a `inversep` p\n> inversep :: Integral a => a -> a -> Maybe a -- We also use in CRT.\n> a `inversep` p = let (g,x,_) = exGCD a p in\n>   if (g == 1) \n>     then Just (x `mod` p) -- g==1 <=> coprime a p\n>     else Nothing\n>\n> inversesp :: Int -> [Maybe Int]\n> inversesp p = map (`inversep` p) [1..(p-1)]\n>\n> -- A map from Q to Z_p.\n> -- p should be prime.\n> modp :: Ratio Int -> Int -> Maybe Int\n> q `modp` p \n>   | coprime b p = Just $ (a * (bi `mod` p)) `mod` p\n>   | otherwise   = Nothing\n>   where\n>     (a,b)   = (numerator q, denominator q)\n>     Just bi = b `inversep` p\n>\n> -- This is guess function without Chinese Reminder Theorem.\n> guess :: Integral t => \n>          (Maybe t, t)       -- (q `modp` p, p)\n>       -> Maybe (Ratio t, t)\n> guess (Nothing, _) = Nothing\n> guess (Just a, p) = let (_,rs,ss,_) = exGCD' a p in\n>   Just (select rs ss p, p)\n>     where\n>       select :: Integral t => [t] -> [t] -> t -> Ratio t\n>       select [] _ _ = 0%1\n>       select (r:rs) (s:ss) p\n>         | s /= 0 && r*r <= p && s*s <= p = r%s\n>         | otherwise = select rs ss p\n>\n> -- Hard code of big primes\n> bigPrimes :: [Int]\n> bigPrimes = take 10 $ dropWhile (<10^4) primes\n> -- bigPrimes = take 10 $ dropWhile (<10^6) primes\n> -- 10 is just for \"practical\" reason.\n\n  *Ffield> let knownData q = zip (map (modp q) bigPrimes) bigPrimes\n  *Ffield> let ds = knownData (12%13)\n  *Ffield> map guess ds\n  [Just (12 % 13,10007)\n  ,Just (12 % 13,10009)\n  ,Just (12 % 13,10037)\n  ,Just (12 % 13,10039) ..\n\n  *Ffield> let ds = knownData (112%113)\n  *Ffield> map guess ds\n  [Just ((-39) % 50,10007)\n  ,Just ((-41) % 48,10009)\n  ,Just ((-69) % 20,10037)\n  ,Just ((-71) % 18,10039) ..\n\n--\nChinese Remainder Theorem, and its usage\n\n> imagesAndPrimes :: Ratio Int -> [(Maybe Int, Int)]\n> imagesAndPrimes q = zip (map (modp q) bigPrimes) bigPrimes\n\nOur data is a list of the type\n  [(Maybe Int, Int)]\nIn order to use CRT, we should cast its type.\n\n> toInteger2 :: [(Maybe Int, Int)] -> [(Maybe Integer, Integer)]\n> toInteger2 = map helper\n>   where \n>     helper (x,y) = (fmap toInteger x, toInteger y)\n>\n> crtRec':: Integral a => (Maybe a, a) -> (Maybe a, a) -> (Maybe a, a)\n> crtRec' (Nothing,p) (_,q)       = (Nothing, p*q)\n> crtRec' (_,p)       (Nothing,q) = (Nothing, p*q)\n> crtRec' (Just a1,p1) (Just a2,p2) = (Just a,p)\n>   where\n>     a = (a1*p2*m2 + a2*p1*m1) `mod` p\n>     Just m1 = p1 `inversep` p2 \n>     Just m2 = p2 `inversep` p1\n>     p = p1*p2\n>\n> matches3 :: Eq a => [Maybe (a,b)] -> Maybe (a,b)\n> matches3  (b1@(Just (q1,p1)):bb@((Just (q2,_)):(Just (q3,_)):_))\n>   | q1==q2 && q2==q3 = b1\n>   | otherwise        = matches3 bb\n> matches3 _ = Nothing\n\n  *Ffield> let ds = imagesAndPrimes (1123%1135)\n  *Ffield> map guess ds\n  [Just (25 % 52,10007)\n  ,Just ((-81) % 34,10009)\n  ,Just ((-88) % 63,10037) ..\n\n  *Ffield> matches3 it\n  Nothing\n\n  *Ffield> scanl1 crtRec' ds\n\n  *Ffield> scanl1 crtRec' . toInteger2 $ ds\n  [(Just 3272,10007)\n  ,(Just 14913702,100160063)\n  ,(Just 298491901442,1005306552331) ..\n\n  *Ffield> map guess it\n  [Just (25 % 52,10007)\n  ,Just (1123 % 1135,100160063)\n  ,Just (1123 % 1135,1005306552331)\n  ,Just (1123 % 1135,10092272478850909) ..\n\n  *Ffield> matches3 it\n  Just (1123 % 1135,100160063)\n\nThe final reconstruction function takes a list of Z_p values and returns the three times matched guess.\n\n> reconstruct :: [(Maybe Int, Int)] -> Maybe (Ratio Integer, Integer)\n> reconstruct = matches3 . map guess . scanl1 crtRec' . toInteger2\n\n--\n\n> aux :: [(Maybe Int, Int)] -> Ratio Int\n> aux = fromRational . fst . fromJust . reconstruct\n>\n> prop_rec :: Ratio Int -> Bool\n> prop_rec q = q == aux ds\n>   where\n>     ds = imagesAndPrimes q\n\n  *Ffield> quickCheck prop_rec \n  +++ OK, passed 100 tests.\n\n\n\n\u7d42\u308f\u308a\u306b\n\u6700\u521d\u306b\u8ff0\u3079\u305f\u3088\u3046\u306b\u3001Int \u3067\u4e0e\u3048\u3089\u308c\u305f\u6570\u5b57\u3067\u3082\u6f14\u7b97\u306e\u9014\u4e2d\u3067\u6841\u843d\u3061\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\nPrelude> let a = maxBound :: Int\nPrelude> a\n9223372036854775807\nPrelude> a*2 :: Int\n-2\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u6841\u843d\u3061\u3057\u305f\u5834\u5408\u672c\u8cea\u7684\u306a\u60c5\u5831\u306f\u5b8c\u5168\u306b\u6d88\u3048\u3066\u3057\u307e\u3046\u308f\u3051\u3067\u3059\u304c\u3001\u7d20\u6570\u4f53\u3068\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u3092\u7d44\u307f\u5408\u308f\u305b\u3001\u304b\u3064\u4e8c\u9805\u6f14\u7b97\u306e\u969b\u306b\u6bce\u56de\\mod\\mod \u3092\u65bd\u3059\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3055\u308c\u305f\u6841\u843d\u3061\u74b0\u5883\u304c\u5b9f\u73fe\u3055\u308c\u308b\u308f\u3051\u3067\u3059\u3002\n\u3042\u308b\u3044\u306f\u5143\u304b\u3089\u8981\u7d20\u304c\u6709\u9650\u500b\u306a\u306e\u3067\u6841\u843d\u3061\u300c\u3057\u306a\u3044\u300d\u74b0\u5883\u3068\u3044\u3063\u3066\u3082\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u3053\u3067\u53d6\u308a\u4e0a\u3052\u305f\u65b9\u6cd5\u306f\u6f14\u7b97\u306f\u5168\u3066\u5b89\u4fa1\u306a\u6709\u9650\u7cbe\u5ea6\u306eInt \u306e\u4e0a\u3067\u884c\u3044\u3001\u6700\u5f8c\u5fa9\u5143\u4f5c\u696d\u306e\u6642\u3060\u3051\u4efb\u610f\u7cbe\u5ea6\u306eInteger \u3067\u884c\u3046\u3068\u3044\u3046\u65b9\u6cd5\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u3057\u305f\u304c\u3063\u3066\u3001\u5168\u6f14\u7b97\u3092\u4efb\u610f\u5236\u5ea6\u306e\u6709\u7406\u6570Ratio Integer \u3067\u884c\u3046\u3088\u308a\u5b89\u4fa1\u3067\u3042\u308a\u305d\u3046\u306a\u96f0\u56f2\u6c17\u3092\u611f\u3058\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4e00\u4f53\u3069\u3046\u3057\u3066\uff1f\n\u3053\u3053\u3067\u3069\u3046\u3044\u3046\u554f\u984c\u3092\u8003\u3048\u305f\u304b\u3068\u3044\u3046\u3068\u3001\u5b9f\u306f\u6709\u7406\u6570\u4fc2\u6570\u306e\u591a\u9805\u5f0f\nf :: Q \\to Q\n{f :: Q \\to Q\n}{f :: Q \\to Q\n}\n\u306a\u3069\u3092\uff08\u6211\u3005\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\uff09\u8003\u3048\u3066\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001\u3053\u306e\u3068\u304dff \u304c\u30d6\u30e9\u30c3\u30af\u30dc\u30c3\u30af\u30b9\u3067\u4e0e\u3048\u3089\u308c\u3066\u3044\u3066\u4fc2\u6570\u306a\u3069\u3092\u77e5\u308a\u5f97\u306a\u3044\u72b6\u6cc1\u306b\u7f6e\u304b\u308c\u3066\u308b\u3068\u3057\u307e\u3059\u3002\n\uff08\u4f8b\u3048\u3070\u96e2\u6563\u70b9\u306b\u304a\u3051\u308bff \u306e\u5024\u3060\u3051\u77e5\u3063\u3066\u308b\uff08\u30b0\u30e9\u30d5\u304c\u4e0e\u3048\u3089\u308c\u3066\u308b\uff09\u3068\u304b\uff09\n\u591a\u9805\u5f0f\u306a\u3089\u30cb\u30e5\u30fc\u30c8\u30f3\u88dc\u9593\u3068\u304b\u3001\u6709\u7406\u95a2\u6570\u3067\u3082Thiele \u306e\u65b9\u6cd5\u306a\u3069\u304c\u77e5\u3089\u308c\u3066\u3044\u3066\u3001\u5341\u5206\u306a\u70b9\u3092\u4e0e\u3048\u3055\u3048\u3059\u308c\u3070\u4fc2\u6570\u3092\u6c7a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u88dc\u5b8c\u6cd5\u3092Int \u3067\u304d\u307e\u308b\u6709\u7406\u6570\u3067\u3084\u308b\u3068\u9014\u4e2d\u3067\u6841\u843d\u3061\u3068\u304b\u304c\u6016\u3044\u306e\u3067\u3001\u3044\u308d\u3093\u306a\u6709\u9650\u4f53Z_p$ \u306e\u4e0a\u3067\u884c\u3044\u3001\u7d50\u679c\u5404\u4fc2\u6570\u306e\n(a_1, p_1)\\\\\n(a_2, p_2)\\\\\n\\vdots\n{(a_1, p_1)\\\\\n(a_2, p_2)\\\\\n\\vdots\n}{(a_1, p_1)\\\\\n(a_2, p_2)\\\\\n\\vdots\n}\n\u306a\u308b\u30c7\u30fc\u30bf\u304c\u5f97\u3089\u308c\u3066\u3044\u308b\u3001\u3068\u3044\u3046\u72b6\u6cc1\u3092\u60f3\u5b9a\u3057\u3066\u307e\u3059\u3002\nZ_pZ_p \u3067\u3082\u3082\u3061\u308d\u3093  \\mod  \\mod  \u306e\u305b\u3044\u3067\u6841\u843d\u3061\u3057\u3066\u3044\u308b\u3068\u3044\u3048\u3070\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u304d\u3061\u3093\u3068\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u304d\u3061\u3093\u3068\u6709\u7406\u6570\u4fc2\u6570\u3092\u5fa9\u5143\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3001\u3068\u3044\u3046\u5bf8\u6cd5\u3067\u3059\u3002\n\n\u8ffd\u8a18\n\u4f55\u306e\u6c17\u306a\u3057\u306bquickCheck \u3092\u4f55\u5ea6\u304b\u30bf\u30a4\u30d7\u3057\u3066\u60a6\u306b\u5165\u3063\u3066\u307e\u3057\u305f\u3089\u3001\u6642\u6298\u3053\u3051\u308b\u3053\u3068\u304c\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\u4f8b\u3048\u3070\n> quickCheck prop_rec \n*** Failed! Exception: 'Maybe.fromJust: Nothing' (after 9 tests and 1 shrink): \n56307372244017 % 5226552907916\n\n\u3053\u308c\u306f\n> 2^2*10009*130546331\n5226552907916\n\n\u3068\u3044\u3046\u3053\u3068\u304b\u3089\u308f\u304b\u308b\u3088\u3046\u306bZ_ {10009}Z_ {10009} \u306e\u4e0a\u3067\u306f\\frac{1}{0}\\frac{1}{0} \u306e\u578b\u3092\u3057\u305f\u4e0d\u5b9a\u5f62\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3001\u3044\u308f\u3070\u30d5\u30a7\u30a4\u30af\u306e\u7121\u9650\u5927\u3067\u3059\u3002\n\u3057\u305f\u304c\u3063\u3066\u4e0b\u51e6\u7406\u3068\u3057\u3066Nothing \u3092\u53d6\u308a\u9664\u3044\u3066\u304a\u3051\u3070\u5927\u4e08\u592b\u3002\u3002\u3002\u3068\u601d\u3044\u307e\u3057\u305f\u304c\u3001\u3053\u308c\u306f\u5618\u3067\u3057\u305f\u3002\n\u3082\u3061\u308d\u3093Nothing \u3092\u53d6\u308a\u9664\u304f\u51e6\u7406\u3082\u5927\u4e8b\u3067\u3059\u304c\u4e00\u756a\u5927\u4e8b\u306a\u306e\u306fInt \u3092\u8986\u3046\u3053\u3068\u3067\u3001\u3053\u306e\u305f\u3081\u306b\u306f10\u56de\u306e\u5408\u81f4\u304c\u5fc5\u8981\u3067\u3059\u3002\n\uff08\u3053\u306e10 \u3068\u3044\u3046\u6570\u5b57\u306f\u79c1\u306e\u7d20\u6570\u306e\u30c1\u30e7\u30a4\u30b9\u3068Int \u306e\u6700\u5927\u5024\u306b\u3088\u3063\u3066\u6c7a\u307e\u3063\u3066\u3044\u307e\u3059\u3002\uff09\n> reconstruct :: [(Maybe Int, Int)] -> Maybe (Ratio Integer)\n> reconstruct = matches 10 . makeList\n>   where\n>     matches n (a:as)\n>       | all (a==) $ take (n-1) as = a\n>       | otherwise                     = matches n as\n>     makeList = map (fmap fst . guess) . scanl1 crtRec' . toInteger2 . filter (isJust . fst)\n\n--\n\n> prop_rec :: Ratio Int -> Bool\n> prop_rec q = Just q == answer\n>   where\n>    answer :: Maybe (Ratio Int)\n>    answer = fmap fromRational . reconstruct $ ds\n>    ds = imagesAndPrimes q\n\n  *Ffield> quickCheckWith stdArgs { maxSuccess = 100000 } prop_rec \n  +++ OK, passed 100000 tests.\n\n\u5ff5\u306e\u305f\u3081\u591a\u3081\u306b\u53d6\u308a\u307e\u3057\u305f\u304c\u3001\u4eca\u5ea6\u3053\u305d\u5927\u4e08\u592b\u306a\u306f\u305a\u3067\u3059\u3002\n\u4e00\u90e8\u9593\u9055\u3044\u304c\u3042\u308a\u307e\u3059\u3001\u672c\u6587\u4e2d\u3067\u3082\u660e\u8a18\u3057\u307e\u3057\u305f\u304c\u6700\u521d\u306e\u7d42\u4e86\u6761\u4ef6\u306fInt \u3092\u8986\u3063\u3066\u3044\u307e\u305b\u3093\u3002\n\u6700\u5f8c\u306b\u8a02\u6b63\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u3068\u3088\u308a\u53b3\u3057\u3044quickCheck \u306e\u7d50\u679c\u3082\u8f09\u305b\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n\n[Haskell Advent Calendar 2016](http://qiita.com/advent-calendar/2016/haskell) \u306e10\u65e5\u76ee\u3067\u3059\u3002\n\n\u53bb\u5e74\u306f\u773a\u3081\u3066\u3044\u308b\u3060\u3051\u3060\u3063\u305f\u306e\u3067\u4eca\u56de\u67a0\u53d6\u308c\u305f\u306e\u5b09\u3057\u3044\u3067\u3059\uff01\n[\u30ec\u30d9\u30eb\u5206\u3051](http://qiita.com/lotz/items/0d68c8440d1f362d0c32)\u7684\u306b\u306fAdvanced Beginner \u306e\u4e00\u4eba\u304c\u540c\u3058\u304f\u3089\u3044\u306e\u30ec\u30d9\u30eb\u306e\u4eba\u306b\u5411\u3051\u3066\u66f8\u3044\u3066\u308b\u3064\u3082\u308a\u3067\u3059\u3001\u3084\u3084\u5185\u5bb9\u306b\u521d\u7b49\u6574\u6570\u8ad6\u304c\u542b\u307e\u308c\u307e\u3059\u3002\n\u3042\u308f\u3088\u304f\u3070\u3088\u308a\u8a73\u3057\u3044\u4eba\u306b\u30c8\u30f3\u30c6\u30f3\u30ab\u30f3\u30ab\u30f3\u3068\u76f4\u3057\u3066\u3044\u305f\u3060\u304d\u305f\u3044\u611f\u3058\u3067\u3059\u304c\u3002\n\n#\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\n\u96fb\u5353\u306a\u3069\u3067(1/3) \u306e\u8a08\u7b97\u3092\u3057\u305f\u5f8c\u3001\u7b54\u3048\u306b3 \u3092\u639b\u3051\u305f\u3053\u3068\u304c\u3042\u308b\u4eba\u3001\u305d\u3057\u3066\u305d\u306e\u3068\u304d1 \u306b\u623b\u3089\u306a\u304b\u3063\u305f\u7d4c\u9a13\u3042\u308b\u4eba\u3082\u304d\u3063\u3068\u591a\u3044\u3053\u3068\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306e\u8a71\u306f\u305d\u308c\u306b\u3061\u3087\u3063\u3068\u95a2\u4fc2\u3057\u3066\u3044\u308b\u3001\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n##\u4f53\n\u4eca\u56de\u306f\u4f53\u3092\u53d6\u308a\u4e0a\u3052\u307e\u3059\u3001\u4f53\u3068\u8a00\u3046\u306e\u306f\u3044\u308f\u3086\u308b\u56db\u5247\u6f14\u7b97\u306b\u9589\u3058\u3066\u3044\u308b\u4ee3\u6570\u4f53\u7cfb\u306e\u3053\u3068\u3067\u3059\u306d\u3002\n\u3084\u3084\u8a73\u3057\u304f\u8a00\u3046\u3068\u74b0\u306e\u3046\u3061\u3001\u96f6\u5143(0)\u4ee5\u5916\u304c\u639b\u3051\u7b97\u306b\u5bfe\u3059\u308b\u9006\u5143\u3092\u6301\u3063\u3066\u3044\u308b\u3088\u3046\u306a\u3082\u306e\u3001\u305d\u308c\u3092\u4f53\u3068\u547c\u3073\u307e\u3059\u3002\n\u5272\u308a\u7b97\u304c\u5b89\u5168\u306b\u884c\u3048\u308b\u74b0\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u306d\u3002\n\u7279\u306b\u8208\u5473\u304c\u3042\u308b\u306e\u304c\n\n```math\n\\mathbb{Q}\n```\n\n\u3067\u8868\u3055\u308c\u308b\u6709\u7406\u6570\u4f53\u3084\u3001\u305d\u308c\u3092\u9023\u7d9a\u5316\u3057\u305f\n\n```math\n\\mathbb{R}\n```\n\n\u306a\u308b\u5b9f\u6570\u4f53\u3001\u305d\u3057\u3066\u4ee3\u6570\u9589\u4f53\u3067\u3042\u308b\u8907\u7d20\u6570\u4f53\n\n```math\n\\mathbb{C}\n```\n\n\u3068\u3044\u3046\u306e\u304c\u30a2\u30ea\u307e\u3059\u3002\n[\u30b0\u30ec\u30d6\u30ca\u30fc\u57fa\u5e95\u3067\u6700\u8fd1\u6709\u540d\u306a\u3053\u306e\u672c](http://www.springer.com/us/book/9781441922571)\u3067\u306f\u8272\u3005\u306a\u8a3c\u660e\u306e\u70ba\u306e$\\mathbb{C}$\u3001\uff08\u9023\u7d9a\u7684\u306a\uff09\u7d75\u3084\u30b0\u30e9\u30d5\u3092\u63cf\u3044\u305f\u308a\u3059\u308b\u70ba\u306e$\\mathbb{R}$\u3001\u305d\u3057\u3066\u8a08\u7b97\u6a5f\u306e\u4e2d\u3067\u306f$\\mathbb{Q}$\u3068\u3044\u3046\u66f8\u304d\u65b9\u3092\u3057\u3066\u3044\u305f\u306e\u304c\u5370\u8c61\u7684\u3067\u3059\u3002\n\n##\u6709\u7406\u6570\u306e\u8a08\u7b97\u306f\u30b3\u30b9\u30c8\u304c\u9ad8\u3044\uff1f\n\u4f8b\u3048\u3070\u8a08\u7b97\u6a5f\u306e\u4e2d\u3067\u7d20\u6734\u306b\u5272\u308a\u7b97\u3092\u3059\u308b\u3068\u5927\u304d\u304f\u60c5\u5831\u3092\u640d\u306a\u3046\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u306e\u306f\u7686\u3055\u3093\u3054\u5b58\u77e5\u3060\u3068\u601d\u3044\u307e\u3059\u3001\u4e0a\u3067\u3042\u3052\u305f\u96fb\u5353\u306e\u4f8b\u304c\u305d\u308c\u306b\u5f53\u305f\u308a\u307e\u3059\u3002\n\u8a00\u3046\u307e\u3067\u3082\u7121\u3044\u3053\u3068\u3067\u3059\u304c\u3001\u8a08\u7b97\u6a5f\u4e0a\u3067\u7121\u9650\u306e\u7cbe\u5ea6\u3067\u5272\u308a\u7b97\u3092\u884c\u3046\u3053\u3068\u306f\u7d20\u6734\u306b\u306f\u7121\u7406\u3067\u3001\u4f8b\u3048\u3070\u6d6e\u52d5\u5c0f\u6570\u70b9\u6570\u306b\u4e38\u3081\u3066\u8a08\u7b97\u3059\u308b\u3068\u666e\u901a\u306f\u671b\u3080\u7d50\u679c\u3067\u306f\u7121\u3044\u3082\u306e\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u7d20\u6734\u306a\u89e3\u6c7a\u7b56\u306f\u3001Int \u3092\u4e8c\u3064\u53d6\u3063\u3066\u304d\u305f\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u578b\u3067\u6709\u7406\u6570\u3092\u8868\u73fe\u3059\u308b\u3068\u3044\u3046\u65b9\u6cd5\u3067\u3059\u3002\n\u3053\u308c\u306f\u307e\u3041\u3046\u307e\u304f\u3044\u304d\u307e\u3059\u3001\u3057\u304b\u3057\u8a08\u7b97\u306e\u9014\u4e2d\u3067\u5206\u6bcd\u5206\u5b50\u306eInt \u304c\u6841\u843d\u3061\u3057\u3066\u306a\u3044\u3053\u3068\u306f\u4e00\u822c\u306b\u306f\u4fdd\u969c\u3055\u308c\u307e\u305b\u3093\u3002\n\u305f\u3068\u3048\u5165\u529b\u3068\u51fa\u529b\u306e\u578b\u304cInt \u3067\u3042\u3063\u3066\u3082\u3001\u4e2d\u9593\u8868\u73fe\u304c\u6841\u843d\u3061\u3057\u3066\u3044\u308c\u3070\u7d50\u679c\u306f\u671b\u3093\u3067\u3044\u305f\u3082\u306e\u3067\u306f\u306a\u3044\u3082\u306e\u304c\u5f97\u3089\u308c\u308b\u3053\u3068\u306b\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u308f\u3051\u3067\u3001\u3053\u308c\u306f\u56f0\u308b\u308f\u3051\u3067\u3059\u3002\n\u3082\u3061\u308d\u3093\u4efb\u610f\u5236\u5ea6\u306eInteger \u3092\u4f7f\u3046\u3068\u3044\u3046\u624b\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3001\u3001\u9045\u304f\u30b3\u30b9\u30c8\u304c\u304b\u3055\u3080\u3053\u3068\u306f\u5bb9\u6613\u306b\u60f3\u50cf\u3067\u304d\u307e\u3059\u3002\n\n\u79c1\u81ea\u8eab\u304c\u5b9a\u91cf\u7684\u306b\u78ba\u8a8d\u3057\u305f\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u30a2\u30ec\u3067\u3059\u304c\u3001\u5272\u308a\u7b97\u3001\u3055\u3089\u306b\u8a00\u3048\u3070\uff08\u639b\u3051\u7b97\u306b\u5bfe\u3059\u308b\uff09\u9006\u5143\u306e\u8a08\u7b97\u3092\u771f\u9762\u76ee\u306b\u53d6\u308a\u6271\u304a\u3046\u3068\u601d\u3046\u3068\u30b9\u30da\u30fc\u30b9\u3092\u55b0\u3046\u3068\u8a00\u3046\u306e\u306f\u306a\u3093\u3068\u306a\u304f\u611f\u3058\u3066\u3082\u3089\u3048\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n##\u3068\u3044\u3046\u308f\u3051\u3067\n\u3053\u3053\u3067\u53d6\u308a\u4e0a\u3052\u308b\u306e\u306f[\u4ee5\u524d\u306e\u8a18\u4e8b\u3067\u53d6\u308a\u4e0a\u3052\u305f](http://qiita.com/bra_cat_ket/items/205c19611e21f3d422b7)\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u7d39\u4ecb\u3068\u305d\u308c\u3092\u4e0a\u624b\u306b\u4f7f\u3063\u305f\u6709\u7406\u6570\u5fa9\u5143\u65b9\u6cd5\u3067\u3059\u3002\n\u8a73\u7d30\u306f[P. S. Wang, \"A p-adic algorithm for univariate partial fractions\", (1981)](https://www.researchgate.net/publication/234827892_A_p-adic_algorithm_for_univariate_partial_fractions)\u3042\u308b\u3044\u306f[P. S. Wang, M. J. T. Guy, and J. H. Davenport, \"p-adic reconstruction of rational numbers\" (1982)](http://www.cecm.sfu.ca/~mmonagan/teaching/TopicsinCA13/GuyDavenWang.pdf)\u306a\u3069\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u305d\u308c\u306b\u4ed8\u968f\u3057\u3066\u6709\u9650\u4f53\u3092\u30e1\u30a4\u30f3\u306b\u53d6\u308a\u4e0a\u3052\u307e\u3059\u3002\n\n\u304b\u3044\u3064\u307e\u3093\u3067\u8a00\u3044\u307e\u3059\u3068\u3001\u5168\u3066\u306e\u6f14\u7b97\u3092Int \u306e\u4e0a\uff08\u5b9f\u306f\u3055\u3089\u306b\u3082\u3063\u3068\u300c\u5b89\u5168\u300d\u306a\u9818\u57df\uff09\u3067\u884c\u3063\u3066\u3001\u5143\u306e\u6709\u7406\u6570\u3092\u5fa9\u5143\u3059\u308b\u65b9\u6cd5\u306e\u3054\u7d39\u4ecb\u3067\u3059\u3002\n\u52dd\u624b\u306b\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3055\u308c\u305f\u6841\u843d\u3061\u3068\u547c\u3093\u3067\u3044\u307e\u3059\u304c\u3001\u3042\u308b\u610f\u5473\u6841\u843d\u3061\u3057\u306a\u3044\u74b0\u5883\u3068\u3082\u8a00\u3048\u307e\u3059\u3002\n\n\n#\u74b0\u3068\u4f53\n\u3044\u304d\u306a\u308a\u8131\u7dda\u8a71\u3067\u3059\u304c\u3001\u4f53\u3068\u805e\u3044\u3066\u7686\u3055\u3093\u4f55\u3092\u60f3\u50cf\u3055\u308c\u307e\u3059\u304b\uff1f\n\u3053\u308c\u306f\u66f8\u304d\u8a00\u8449\u3060\u304b\u3089\u51fa\u6765\u308b\u3053\u3068\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u3053\u306e\u6f22\u5b57\u306f\u300c\u305f\u3044\u300d\u3068\u8aad\u307e\u308c\u307e\u3059\u3002\n(\u6b8b\u5ff5\u306a\u304c\u3089\u30bf\u30a4\u30c8\u30eb\u306e\u3088\u3046\u306b\u74b0\u3068\u304f\u3063\u3064\u3051\u3066\u3057\u307e\u3046\u3068\u8aa4\u8aad\u3057\u3066\u3044\u305f\u3060\u3051\u308b\u6a5f\u4f1a\u306f\u6e1b\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u304c\uff09\n\u56f0\u3063\u305f\u3053\u3068\u306b\u82f1\u8a9e\u3067\u306ffields \u3068\u306a\u308a\u7269\u7406\u306e\u754c\u9688\u3067\u306f\u306a\u304b\u306a\u304b\u4f53\u3068\u3057\u3066\u76f8\u624b\u306b\u4f1d\u308f\u3089\u305a\u3082\u3069\u304b\u3057\u3044\u6c17\u6301\u3061\u306b\u306a\u308b\u306e\u3067\u3059\u3001\u3061\u306a\u307f\u306b\u7269\u7406\u5c4b\u304cfields \u3068\u3044\u3046\u3068\u307e\u3041\u9593\u9055\u3044\u306a\u304f\u300c\u5834\u300d\u3060\u3068\u601d\u308f\u308c\u308b\u306e\u3067\u6709\u9650\u4f53\u3092\u6307\u3057\u305f\u304f\u3066finite fields \u3068\u3044\u3046\u3068\u5927\u4f53\u7686\u306a\u306b\u304b\u30a8\u30ad\u30be\u30c1\u30c3\u30af\u306a\u3082\u306e\u3060\u3068\u8aa4\u89e3\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n##\u96c6\u5408\u3068\u6f14\u7b97\uff08\u4ee3\u6570\u69cb\u9020\uff09\n\u96c6\u5408\u306b\u69cb\u9020\u3092\u5165\u308c\u305f\u3082\u306e\u306e\u3046\u3061\u3001\u5272\u5408\u4fbf\u5229\u306a\u3082\u306e\u306b\u5927\u4f53\u540d\u524d\u304c\u4ed8\u3044\u3066\u3044\u307e\u3059\u3001\u4f8b\u3048\u3070\u7fa4\u3001\u74b0\u3001\u4f53\u306a\u3069\u3002\n\u5e73\u305f\u304f\u8a00\u3048\u3070\u7fa4\u3068\u306f\u96c6\u5408\u306b\uff08\u6027\u8cea\u306e\u826f\u3044\uff09\u639b\u3051\u7b97\u306e\u69cb\u9020\u304c\u5165\u3063\u3066\u3044\u308b\u3082\u306e\u3067\u3001\u74b0\u306f\u639b\u3051\u7b97\u3068\u8db3\u3057\u7b97\u3001\u4f53\u306f\u56db\u5247\u6f14\u7b97\u304c\u5165\u3063\u305f\u3082\u306e\u3068\u8a00\u3046\u611f\u3058\u306b\u3002\nHaskeller \u306e\u7686\u3055\u3093\u306f\u3055\u3089\u306b\u30e2\u30ce\u30a4\u30c9\u3082\u3054\u5b58\u77e5\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3001\u3042\u3068\u306f\u570f\u3068\u304b\u3082\u3002\n\u4e0a\u3067\u6319\u3052\u305f\u6709\u7406\u6570\u4f53\u3001\u5b9f\u6570\u4f53\u305d\u3057\u3066\u8907\u7d20\u6570\u4f53\u306f\uff08\u6fc3\u5ea6\u306f\u7570\u306a\u308a\u307e\u3059\u304c\uff09\u7121\u9650\u96c6\u5408\u306b\u4f53\u306e\u69cb\u9020\u304c\u5165\u3063\u3066\u3044\u308b\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n\u8aa4\u89e3\u3092\u6050\u308c\u305a\u306b\u8a00\u3048\u3070\u3001\u96fb\u5353\u306e\u6841\u843d\u3061\u554f\u984c\u306f\u6709\u7406\u6570\u4f53\u306e\u6fc3\u5ea6\u304c\u7121\u9650\u3060\u3068\u3044\u3046\u3053\u3068\u306b\u8d77\u56e0\u3057\u307e\u3059\u3001\u5f93\u3063\u3066\u6709\u9650\u306a\u4f53\u304c\u3042\u308c\u3070\u3082\u3057\u304b\u3057\u305f\u3089\u3001\u3001\u3001\u3068\u3044\u3046\u306e\u304c\u5e0c\u671b\u3067\u3042\u308a\u3001\u4eca\u56de\u306e\u8a71\u306e\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u306a\u304c\u308b\u308f\u3051\u3067\u3059\u3002\n\n##\u5270\u4f59\u74b0\n\u6709\u9650\u306a\u74b0\u3068\u3044\u3046\u306e\u306f\u5272\u5408\u7c21\u5358\u306b\u898b\u3064\u304b\u308b\u3082\u306e\u3067\u3059\u3001\u305f\u3068\u3048\u3070\u3042\u308b\u6b63\u306e\u6574\u6570\u306b\u7740\u76ee\u3057\u305f\u4f59\u308a\u306e\u8a08\u7b97\u304c\u74b0\u306e\u69cb\u9020\u3092\u53d6\u308b\u3053\u3068\u306f\u77e5\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u4f8b\u3048\u30706 \u3067\u5272\u3063\u305f\u4f59\u308a\u3067\u3082\u3063\u3066\u7121\u9650\u500b\u306e\u6574\u6570\u3092\u5206\u985e\u3059\u308b\u3068\u306a\u3093\u3068\u8981\u7d20\u304c6 \u500b\u3057\u304b\u306a\u3044\u6709\u9650\u306e\u74b0\u304c\u51fa\u6765\u307e\u3059\u3001\u3053\u308c\u304c\u5270\u4f59\u74b0\uff08\u3042\u308b\u3044\u306f\u5546\u74b0\uff09\u3068\u8a00\u308f\u308c\u308b\u3082\u306e\u3067\n\n```math\n\\mathbb{Z}_6\n```\n\n\u3068\u3053\u3053\u3067\u306f\u8868\u3057\u307e\u3059\u3002\n\u96c6\u5408\u3068\u3057\u3066\u306f\n\n```math\n\\{0,1,2,3,4,5\\}\n```\n\n\u3060\u3068\u601d\u3063\u305f\u3089\u826f\u304f\u3001\u8db3\u3057\u7b97\u5f15\u304d\u7b97\u305d\u3057\u3066\u639b\u3051\u7b97\u306f\u3059\u3079\u3066\u666e\u901a\u306b\u5b9f\u884c\u3057\u305f\u5f8c$\\mod 6$ \u3092\u3068\u308b\u3068\u3044\u3046\u98a8\u306b\u7d04\u675f\u3059\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3001\u4f8b\u3048\u3070\n\n```math\n1+2 == 3 \\mod 6 \\\\\n4+5 == 3 \\mod 6 \\\\\n1-5 == 2 \\mod 6 \\\\\n3*4 == 0 \\mod 6\n```\n\n\u306a\u3069\u3002\n\u3055\u3066\u3053\u3053\u3067\u3053\u306e\u5270\u4f59\u74b0\u3092\u4f53\u306b\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u304b\u3069\u3046\u304b\uff1f\u3068\u3044\u3046\u306e\u304c\u6d6e\u304b\u3073\u3046\u308b\u7591\u554f\u3067\u3059\u3002\n\u305d\u308c\u304c\u51fa\u6765\u308c\u3070\u7b2c\u4e00\u30b9\u30c6\u30c3\u30d7\u30af\u30ea\u30a2\u3067\u3059\u304c\u305d\u306e\u524d\u306b\u9053\u5177\u3092\u4e00\u3064\u7528\u610f\u3057\u307e\u3059\u3002\n\n##\u6700\u5927\u516c\u7d04\u6570(gcd)\n\u305d\u3046\u6700\u5927\u516c\u7d04\u6570\u3001\u8a9e\u5442\u304c\u826f\u304f\u3066\u899a\u3048\u308b\u306e\u306f\u899a\u3048\u305f\u306e\u3067\u3059\u304c\u6700\u5c0f\u516c\u500d\u6570\u3068\u3044\u3064\u3082\u3054\u3063\u3061\u3083\u306b\u306a\u3063\u3066\u3057\u307e\u3042\u308c\u3067\u3059\u3001\u79c1\u3060\u3051\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3002\n\u6700\u5927\u516c\u7d04\u6570\u3092\u6c42\u3081\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u53e4\u304f\u304b\u3089\u77e5\u3089\u308c\u3066\u3044\u3066[wiki](https://ja.wikipedia.org/wiki/\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u4e92\u9664\u6cd5)\u306b\u306f\u5927\u5909\u76f4\u89b3\u7684\u306a\u7d20\u6575\u306a[\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3](https://ja.wikipedia.org/wiki/\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u4e92\u9664\u6cd5#/media/File:Euclidean_algorithm_252_105_animation_flipped.gif)\u3082\u7f6e\u3044\u3066\u3042\u308a\u307e\u3057\u305f\u3002\n\u5b9f\u88c5\u3082\u7c21\u5358\u3067\u81ea\u524d\u3067\u3082\u66f8\u3051\u307e\u3059\u3001\u3088\u304f[\u6f14\u7fd2\u554f\u984c](https://wiki.haskell.org/99_questions/Solutions/32)\u306a\u3069\u306b\u306a\u308b\u306e\u3067\u306f\u7121\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\u7d30\u304b\u3044\u3053\u3068\u3092\u8a00\u3046\u3068\u79c1\u306f\u5927\u5c0f\u5224\u5b9a\u3001\u7b49\u53f7\u5224\u5b9a\u3001\u305d\u3057\u3066\u5f15\u304d\u7b97\u3060\u3051\u3067\u306e\u518d\u5e30\u7684\u306a\u5b9a\u7fa9\u306e\u65b9\u304c\u898b\u901a\u3057\u304c\u826f\u304f\u3066\u597d\u304d\u3067\u3059\u3001\u3053\u308c\u304c\u4e0a\u8a18\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u306b\u76f8\u5f53\u3057\u3066\u3044\u308b\u3084\u3064\u3067\u3059\u3002\n\u4ee5\u524d\u306b[\u3053\u3053](http://qiita.com/bra_cat_ket/items/b5baf5e162f64b68f48a#32-\u6700\u5927\u516c\u7d04\u6570\u3092\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u4e92\u9664\u6cd5\u3092\u4f7f\u3063\u3066\u6c42\u3081\u3088)\u3067\u89e3\u3044\u305f\u3088\u3046\u306b\u6700\u5927\u516c\u7d04\u6570\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\n\n```myGCD.lhs\n> myGCD :: Integral a => a -> a -> a\n> myGCD a b\n>   | b < 0 = myGCD a (-b)\n> myGCD a b\n>  | a == b = a\n>  | b >  a = myGCD b a\n>  | b <  a = myGCD (a-b) b \n```\n\n\u5927\u304d\u3044\u65b9\u304b\u3089\u5c0f\u3055\u3044\u65b9\u3092\u5f15\u304d\u7d9a\u3051\u3066\u884c\u3063\u305f\u3089\u3088\u3044\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3001\u7d42\u4e86\u5224\u5b9a\u306f\u4e21\u8005\u304c\u7b49\u3057\u304f\u306a\u3063\u305f\u3068\u304d\u3067\u3059\u3001\u3042\u308b\u3044\u306f\u3082\u3046\u4e00\u5ea6\u9069\u7528\u3055\u305b\u3066\u5c0f\u3055\u3044\u307b\u3046\u304c\u96f6\u3067\u3082\u5927\u4e08\u592b\u3002\n\n##B\u00e9zout \u306e\u88dc\u984c\n\u3055\u3066\u3053\u3053\u3067\u91cd\u8981\u306a\u88dc\u984c\u3092\u4e00\u3064\u3001\u4efb\u610f\u306e\u6574\u6570a, b \u3068\u305d\u308c\u3089\u306e\u6700\u5927\u516c\u7d04\u6570\u306e\u9593\u306b\u4ee5\u4e0b\u306e\u7b49\u53f7\u3092\u6e80\u305f\u3059x, y \u304c\u5b58\u5728\u3057\u307e\u3059\u3002\n\u3059\u306a\u308f\u3061\n\n```math\n\\forall a,b \\in \\mathbb{Z}, \\exists x,y \\in \\mathbb{Z}, s.t. \\\\\na*x+b*y == \\gcd(a,b)\n```\n\n\u4ee5\u524d[\u3053\u3053](http://qiita.com/bra_cat_ket/items/205c19611e21f3d422b7)\u3067\u53d6\u308a\u4e0a\u3052\u305f\u3053\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u3053\u306e\u4e8c\u6574\u6570x, y \u3092\u69cb\u6210\u7684\u306b\u4f5c\u308b\u65b9\u6cd5\u3068\u3057\u3066\u77e5\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n##\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\nHaskeller \u306e\u65b9\u306b\u306f\uff08\u578b\u306b\u306f\uff1f\uff09\u5b9f\u7269\u306e\u30b3\u30fc\u30c9\u306e\u65b9\u304c\u53ef\u8aad\u6027\u304c\u9ad8\u3044\u3053\u3068\u3060\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\u307e\u305a\u5b9f\u7269\u3092\u3070\u3002\n\n```exGCD.lhs\n> exGCD' :: Integral n => n -> n -> ([n], [n], [n], [n])\n> exGCD' a b = (qs, rs, ss, ts)\n>   where\n>     qs = zipWith quot rs (tail rs)\n>     rs = takeUntil (==0) r'\n>     r' = steps a b\n>     ss = steps 1 0\n>     ts = steps 0 1\n>     steps a b = rr\n>       where rr@(_:rs) = a:b: zipWith (-) rr (zipWith (*) qs rs)\n>         \n> takeUntil :: (a -> Bool) -> [a] -> [a]\n> takeUntil p = foldr func []\n>   where\n>     func x xs \n>       | p x       = []\n>       | otherwise = x : xs\n>\n> -- a*x + b*y = gcd a b\n> exGcd a b = (g, x, y)\n>   where\n>     (_,r,s,t) = exGCD' a b\n>     g = last r\n>     x = last . init $ s\n>     y = last . init $ t\n```\n\n\u4eca\u56de\u306f\u3053\u306e\u300c\u88dc\u52a9\u95a2\u6570\u300d\u3068\u601d\u308f\u308c\u3066\u305fexGCD'\u3068\u305d\u306e\u300c\u526f\u7523\u7269\u300d\u3067\u3042\u308b\u6574\u6570\u30ea\u30b9\u30c8\u305f\u3061\u304c\u4eca\u56de\u306e\u8a71\u306e\u9053\u5177\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n##\u8a3c\u660e\u3001\u306e\u524d\u306b\n\u3069\u3046\u3044\u3046\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304b\u3068\u3044\u3046\u3068\u3001\u521d\u671f\u6761\u4ef6\u3068\u3057\u3066\n\n```math\n\n(r_0,s_0,t_0) := (a,1,0) \\\\\n(r_1,s_1,t_1) := (b,0,1)\n\n```\n\n\u3055\u3089\u306b\n\n```math\n\nq_i := quot(r_{i-2}, r_{i-1})\n\n```\n\n\u3068\u3057\u307e\u3059\u3001\u3064\u307e\u308a\u4f59\u308a\u3067\u3059\u3001\u4f8b\u3048\u3070\n\n```math\n\nquot(12,5) = 2\n\n```\n\n\u3042\u3068\u306f\u518d\u5e30\u7684\u306b\n\n```math\n\nr_i := r_{i-2} - q_i * r_{i-1} \\\\\ns_i := s_{i-2} - q_i * s_{i-1} \\\\\nt_i := t_{i-2} - q_i * t_{i-1} \\\\\n\n```\n\u3068\u5b9a\u7fa9\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u505c\u6b62\u6761\u4ef6\u306f\n\n```math\n\nr_k = 0\n\n```\n\n\u3068\u306a\u308b\u3053\u3068\u3068\u3057\u307e\u3059\u3002\n\n##\u8a3c\u660e\n\u4f55\u3092\u8a3c\u660e\u3059\u308b\u304b\u3068\u3044\u3046\u3068\u3001\u305d\u3046\u3001B\u00e9zout \u306e\u88dc\u984c\u3067\u3059\u3002\n\n```math\n\\forall a,b \\in \\mathbb{Z}, \\exists x,y \\in \\mathbb{Z}, s.t. \\\\\na*x+b*y == \\gcd(a,b)\n```\n\n\u3059\u306a\u308f\u3061\u4efb\u610f\u306e\u6574\u6570a,b \u306b\u5bfe\u3057\u3066$ a*x+b*y == \\gcd(a,b) $ \u306a\u308b\u4e8c\u6574\u6570x,y \u3068$gcd(a,b)$ \u3092\u3001\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u69cb\u6210\u7684\u306b\u4f5c\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3088\uff01\u3068\u3044\u3046\u306e\u304c\u4e3b\u5f35\u3067\u3059\u3002\n\n\u3053\u3053\u3067\u306f$a>b$ \u3092\u4eee\u5b9a\u3057\u307e\u3059\u3001\u3053\u308c\u306f\u7279\u306b\u610f\u5473\u306e\u3042\u308b\u4eee\u5b9a\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u4e00\u822c\u6027\u306f\u5931\u308f\u306a\u3044\u3001\u5358\u306b\u7c21\u4fbf\u6027\u306e\u305f\u3081\u3067\u3059\u3002\n\u307e\u305a\u59cb\u3081\u306b\u3053\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u505c\u6b62\u6027\u3092\u8ff0\u3079\u306d\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\u5b9a\u7fa9\u3088\u308a\n\n```math \nr_i := r_{i-2} - q_i * r_{i-1}\n```\n\n\u3053\u306e\u6570\u5217$r_i$\u306f\u5358\u8abf\u306b\u6e1b\u5c11\u3059\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3001\u3053\u3053\u3067$a>b$\u304c\u751f\u304d\u308b\u308f\u3051\u3067\u3059\u3002\n\u505c\u6b62\u6761\u4ef6\u306f$r=0$\u306a\u306e\u3067\u3001\u3044\u3064\u304b\u5fc5\u305a\u30d2\u30c3\u30c8\u3059\u308b\u306e\u3067\u505c\u6b62\u6027\u306f\u5927\u4e08\u592b\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3001\u3059\u306a\u308f\u3061\u6709\u9650\u56de\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u6b62\u307e\u308a\u307e\u3059\u3002\n\u3053\u306e\u30b9\u30c6\u30c3\u30d7\u3092$k$\u3068\u3057\u307e\u3059\u3001\u3059\u306a\u308f\u3061$r_k = 0$\u3002\n\n\u6b21\u306b\u5404\u30b9\u30c6\u30c3\u30d7\u3067\u306e$r$\u306e\u6319\u52d5\u3092\u898b\u307e\u3057\u3087\u3046\u3002\n\u5272\u308a\u7b97\u306e\u904e\u7a0b\u3067\n\n```math\n\n\\gcd(r_{i-1}, r_i) = \\gcd(r_{i-1}, r_{i-2} - q_i*r_{i-1}) \\\\\n= \\gcd(r_{i-1}, r_{i-2})\n\n```\n\n\u3068\u306a\u308b\u3053\u3068\u304b\u3089\u3001\n\n```math\n\n\\gcd(a,b) = \\gcd(r_0, r_1) = ... = \\gcd(r_{k-1},r_k=0)\n\n```\n\n\u304c\u5206\u304b\u308a\u307e\u3059\u3001\u3059\u306a\u308f\u3061\n\n```math\n\n\\gcd(a,b) = r_{k-1}\n\n```\n\n\u6b21\u306b\u5404\u30b9\u30c6\u30c3\u30d7\u3067B\u00e9zout \u6052\u7b49\u5f0f\u304c\u6210\u308a\u7acb\u3064\u3053\u3068\u3001\u306f\u8aad\u8005\u306e\u65b9\u3078\u306e\u6f14\u7fd2\u3068\u3057\u307e\u3057\u3087\u3046\uff1a\n\n```math\n\na*s_i + b * t_i = r_i\n\n```\n\n\u3053\u308c\u3089\u3092\u5408\u308f\u305b\u3066\n\n```math\n\n\\gcd(a,b) = r_{k-1} = a*s_{k-1} + b*t_{k-1}\n\n```\n\n\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\u3001\u3059\u306a\u308f\u3061\u6700\u5927\u516c\u7d04\u6570\u3068$x=s_{k-1}, y=t_{k-1}$\u304c\u69cb\u6210\u7684\u306b\u5f97\u3089\u308c\u305f\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\n\n\n##\u9006\u5143\n\u3053\u3053\u304b\u3089\u306f$\\gcd$ \u3092\u4f7f\u3046\u7acb\u5834\u306b\u4ee3\u308f\u308a\u307e\u3059\u3002\n\n\u3082\u3057\u4e8c\u6574\u6570a, b \u304c\u4e92\u3044\u306b\u7d20\u306a\u3089\u3070$\\gcd(a,b) == 1$\u3092\u6e80\u305f\u3057\u307e\u3059\u3001\u3055\u3089\u306b\u3053\u306e\u6642B\u00e9zout \u306e\u88dc\u984c\u304b\u3089\uff08\u3042\u308b\u3044\u306f\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304b\u3089\uff09\n\n```math\na*x+b*y == \\gcd(a,b) == 1\n```\n\n\u306a\u308b\u4e8c\u6574\u6570x, y\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u306e\u3068\u304d\u4f8b\u3048\u3070\u5270\u4f59\u74b0$\\mathbb{Z}_b$\u306e\u4e0a\u3067\u8003\u3048\u3066\u307f\u308b\u3068\n\n```math\n1 == a*x+b*y \\mod b \\\\\n1 == a*x \\mod b\n```\n\n\u3068\u306a\u308a\u3001\u306a\u3093\u3068\u5270\u4f59\u74b0$\\mathbb{Z}_b$\u306e\u4e0a\u3067\u306f$x \\mod b$ \u304c$a \\mod b$ \u306e\uff08\u639b\u3051\u7b97\u306b\u5bfe\u3059\u308b\uff09\u9006\u5143\u3068\u306a\u308b\u308f\u3051\u3067\u3059\u3002\n\n\u4f8b\u3048\u3070\n\n```\nPrelude> gcd 6 1\n1\nPrelude> gcd 6 5\n1\n```\n\n\u306a\u3069\u304b\u3089$\\mathbb{Z}_6$\u3067\u306f1 \u306f 1\u306e\u9006\u5143\u30675 \u306f5 \u306e\u9006\u5143\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n```math\n\n1*1 == 1 \\\\\n5*5 == 4*6+1  \n\n```\n\n\u3057\u304b\u3057\u6b8b\u308a\u306e2,3,4 \u306f\u9006\u5143\u3092\u6301\u305f\u306a\u3044\u3053\u3068\u304c\u5206\u304b\u308b\u306e\u3067$\\mathbb{Z}_6$ \u306f\u4f53\u306b\u306a\u3089\u306a\u3044\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n##\u7d20\u6570\u4f53\n\u4e8c\u6574\u6570a,b \u304c\u4e92\u3044\u306b\u7d20\u306a\u3089\u3070$a \\mod b$ \u306e\u9006\u5143\u304c\u5b58\u5728\u3057\u3001\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u5247\u308c\u3070\u305d\u306e\u5019\u88dcx \u304c\u5f97\u3089\u308c\u3001\u3042\u3068\u306f$x \\mod b$\u3092\u8a08\u7b97\u3059\u308c\u3070\u826f\u3044\u3068\u8a00\u3046\u306e\u304c\u30df\u30bd\u3067\u3059\u3002\n\n\u7d20\u6570p \u306b\u5bfe\u3057\u3066$\\mathbb{Z}_p$\u3092\u8003\u3048\u308b\u3068\u3001\u3053\u306e\u8981\u7d20\n\n```math\n\\{0,1 \\cdots (p-1)\\}\n```\n\n\u306e\u51850 \u3092\u9664\u304f\u5168\u3066\u306e\u5143a \u306b\u95a2\u3057\u3066\n\n```math\n\\gcd(a,p) == 1, a=1,2\\cdots (p-1)\n```\n\n\u304c\u6210\u308a\u7acb\u3064\u306e\u3067\u3001\u3053\u306e\u7d20\u6570\u74b0\u306f\u4f53\u306b\u306a\u308b\uff01\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u4f8b\u3048\u3070$\\mathbb{Z}_5$\u3084$\\mathbb{Z}_7$\u304c\u4f53\u306b\u306a\u308b\u3053\u3068\u306f\n\n```\nPrelude> map (gcd 5) [1..4]\n[1,1,1,1]\nPrelude> map (gcd 7) [1..6]\n[1,1,1,1,1,1]\n```\n\n\u304b\u3089\u5206\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3001\u554f\u984c\u306f$\\gcd$\u3060\u3051\u3067\u306f\u9006\u5143\u306f\u3055\u3063\u3071\u308a\u5206\u304b\u3089\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u304c\u3001\u6211\u3005\u306b\u306f\u62e1\u5f35\u3055\u308c\u305f\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u304c\u3042\u308a\u307e\u3059\uff01\u3057\u305f\u304c\u3063\u3066\n\n```\n*Ffield> map (exGCD 5) [1..4]\n[(1,0,1),(1,1,-2),(1,-1,2),(1,1,-1)]\n*Ffield> (-2) `mod` 5\n3\n*Ffield> 2 `mod` 5\n2\n*Ffield> (-1) `mod` 5\n4\n```\n\n\u306a\u3069\u304b\u3089\n\n```math\n1^{-1} == 1 \\mod 5 \\\\\n2^{-1} == 3 \\mod 5 \\\\\n3^{-1} == 2 \\mod 5 \\\\\n4^{-1} == 4 \\mod 5 \n```\n\n\u304c\u5206\u304b\u308a\u307e\u3059\u3001\u771f\u3093\u4e2d\u306e\u4e8c\u7d44\u306f\n\n```math\n2*3 == 5 + 1\n```\n\n\u304b\u3089\u7406\u89e3\u3057\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n$\\mathbb{Z}_7$\u3067\u306f\n\n```\n*Ffield> map (exGCD 7) [1..6]\n[(1,0,1),(1,1,-3),(1,1,-2),(1,-1,2),(1,-2,3),(1,1,-1)]\n*Ffield> map (\\(_,_,c) -> c) it\n[1,-3,-2,2,3,-1]\n*Ffield> map (`mod` 7) it\n[1,4,5,2,3,6]\n```\n\n\u304b\u3089\n\n```math\n1^{-1} == 1 \\mod 7 \\\\\n2^{-1} == 4 \\mod 7 \\\\\n3^{-1} == 5 \\mod 7 \\\\\n4^{-1} == 2 \\mod 7 \\\\\n5^{-1} == 3 \\mod 7 \\\\\n6^{-1} == 6 \\mod 7 \n```\n\n\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n##\u62e1\u5f35\u3055\u308c\u305f$\\mod$\n\u666e\u901a\u306e$\\mod p$ \u306f\u6574\u6570\u3092\u53d6\u3063\u3066\u6574\u6570\u3092\u8fd4\u3059\u95a2\u6570\u3067\u3059\u3001\u3059\u306a\u308f\u3061\n\n```math\n- \\mod p :: \\mathbb{Z} \\to \\mathbb{Z}_p\n```\n\n\u3068\u3044\u3046\"\u578b\"\u3092\u53d6\u308b\u3068\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\u3053\u3053\u3067\u3053\u306e\u5b9a\u7fa9\u57df\u3092\u6709\u7406\u6570\u307e\u3067\u62e1\u5f35\u3057\u3066\u304a\u304d\u307e\u3059\u3001\u3059\u306a\u308f\u3061\n\n```math\nq=\\frac{n}{d} \\mapsto (q \\mod p) := (a \\times ?(b^{-1} \\mod p)) \\mod p\n```\n\n\u3067\u6709\u7406\u6570q \u306e$\\mod p$ \u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n\u3053\u3053\u3067\n\n```math\n? :: \\mathbb{Z}_p \\to \\mathbb{Z}\n```\n\n\u306f\u81ea\u7136\u306a\u5305\u542b\u3042\u308b\u3044\u306f\u5fd8\u5374\u95a2\u6570\u3067\u3001$\\mathbb{Z}_p$\u306e\u69cb\u9020\u3092\u5fd8\u308c\u3066\u305f\u3060\u306e\u6574\u6570\u3060\u3068\u601d\u3044\u307e\u3057\u3087\u3046\u3001\u3068\u3044\u3046\u95a2\u6570\u3067\u3059\u3002\n\n\u4eca\u56de\u306e\u30df\u30c3\u30b7\u30e7\u30f3\u306f\u3053\u306e$\\mathbb{Z}_p$ \u306e\u5143\u3067\u3042\u308b\u3001\u3059\u306a\u308f\u3061\n\n```math\n0 \\leq a \\leq (p-1)\n```\n\n\u3092\u6e80\u305f\u3059\u3001\u300c\u6709\u7406\u6570q \u306e$\\mod p$ \u3067\u306e\u50cf\u300d\u304b\u3089\u5143\u306eq \u3092\u63a8\u6e2c\u3057\u307e\u3057\u3087\u3046\u3001\u3068\u3044\u3046\u8a71\u3067\u3059\u3002\n\n#\u6709\u7406\u6570\u306e\u5fa9\u5143\uff08\u7d20\u6734\u306a\u65b9\u6cd5\uff09\n\u3055\u3066\u62e1\u5f35\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306e\u526f\u7523\u7269\u3068\u3057\u3066\u793a\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3082\u306e\u3068\u3057\u3066\u3001\u5404\u30b9\u30c6\u30c3\u30d7$i$ \u306b\u304a\u3044\u3066Bezout \u306e\u6052\u7b49\u5f0f\u304c \u6210\u308a\u7acb\u3064\u3068\u3044\u3046\u306e\u304c\u3042\u308a\u307e\u3059\u3002\n\n```math\na* s_i + b*t_i = r_i\n```\n\n##\u7d20\u6734\u306a\u63a8\u6e2c\n\u3053\u3053\u3067\u6211\u3005\u306e\u554f\u984c\u8a2d\u5b9a\u3068\u3057\u3066$b=p$ \u3092\u7d20\u6570\u3068\u3057\u3066\u3068\u308a\u3001\u304b\u3064$a$ \u306f\u30bf\u30fc\u30b2\u30c3\u30c8\u306e\u6709\u7406\u6570\u306e$Z_p$ \u306e\u4e0a\u3067\u306e\u50cf\u3060\u3068\u3057\u307e\u3059\u3001\u3059\u306a\u308f\u3061\n\n```math\na = (q \\mod p)\n```\n\n\u3053\u306e\u6642\u5404\u30b9\u30c6\u30c3\u30d7\u3067\u306eBezout \u6052\u7b49\u5f0f\u306e\u4e21\u8fba\u3092$Z_p$ \u3067\u8003\u3048\u308b\u3068\n\n```math\na * s_i = r_i \\mod p\n```\n\n\u5f93\u3063\u3066\n\n```math\na = (\\frac{n}{d} \\mod p )\n```\n\n\u306f$Z_p$ \u306e\u4e0a\u3067\n\n```\n(\\frac{n}{d} \\mod p) = r_i * {s_i}^{-1} \\mod p\n```\n\u3092\u6e80\u305f\u3059\u3053\u3068\u304b\u3089 $\\frac{n}{d}$\u306f\u5404\u30b9\u30c6\u30c3\u30d7\u3067\n\n```math\n\\frac{s_i}{r_i}\n```\n\n\u3068\"\u63a8\u6e2c\u3055\u308c\u308b\"\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\n\u3053\u3053\u3067Wang \u304c\u793a\u3057\u305f\u306e\u306f\n\n```math\ns_i^2,r_i^2 \\lessapprox p\n```\n\n\u306a\u308b\u30b9\u30c6\u30c3\u30d7$i$ \u306b\u304a\u3044\u3066\u5143\u306e\u6709\u7406\u6570\u306f\n\n```math\nq = \\frac{s_i}{r_i}\n```\n\n\u3067\u3042\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n##\u554f\u984c\u70b9\n\u3053\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u554f\u984c\u70b9\u306f\u63a8\u6e2c\u306e\u7cbe\u5ea6\u304c\n\n```math\ns_i^2,r_i^2 \\lessapprox p\n```\n\n\u3068\u3044\u3046\u6761\u4ef6\u306e\u305b\u3044\u3067\u5e73\u65b9\u6839\u3067\u6291\u3048\u3089\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u70b9\u3067\u3059\u3002\n\n\u4f8b\u3048\u3070\u7d20\u6570\u3068\u3057\u3066[10007](https://primes.utm.edu/curios/page.php/10007.html)\u3092\u53d6\u3063\u305f\u3068\u3059\u308c\u3070\u63a8\u6e2c\u3067\u304d\u308b\u6709\u7406\u6570\u306f\u5206\u6bcd\u5206\u5b50\u3068\u3082\u306b$10^2$\u7a0b\u5ea6\u307e\u3067\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n#\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u3068\u6709\u7406\u6570\u306e\u5fa9\u5143\n\u4e3b\u5f35\u3068\u8a3c\u660e\u306f[wiki\u306e\u8a72\u5f53\u30da\u30fc\u30b8](https://ja.wikipedia.org/wiki/\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406)\u306b\u4efb\u305b\u308b\u3068\u3057\u307e\u3059\u3002\n\u30df\u30bd\u306f\uff12\u3064\u306e\u4e92\u3044\u306b\u7d20\u306a$p_1,p_2$\uff08\u7d20\u6570\u3067\u306a\u304f\u3066\u3082\u3001\u4e92\u3044\u306b\u7d20\u306a\u3089ok\uff09\u304c\u3042\u3063\u3066\u3001\u304b\u3064$Z_{p_1}$\u3068$Z_{p_2}$\u306e\u4e0a\u3067\u306e\u5024\n\n```math\n\na_1 = (q \\mod p_1) \\\\\na_2 = (q \\mod p_1)\n\n```\n\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u308c\u3070\n\n```math\n\na = (q \\mod p_1*p_2)\n\n```\n\u306a\u308b$a$ \u3092\u305f\u3060\uff11\u3064\u6c7a\u3081\u3066\u3042\u3052\u3089\u308c\u308b\u3068\u3044\u3046\u70b9\u306b\u3064\u304d\u307e\u3059\u3002\n\n\n##\u554f\u984c\u8a2d\u5b9a\n\u307e\u305a\u6bd4\u8f03\u7684\u5927\u304d\u306a\u7d20\u6570\u3092\u5e7e\u3064\u304b\u7528\u610f\u3057\u3066\u304a\u304d\u307e\u3059\u3001\u4f8b\u3048\u3070\n\n```\nPrelude Data.Numbers.Primes> take 10 $ dropWhile (<10^4) primes\n[10007,10009,10037,10039,10061,10067,10069,10079,10091,10093]\n```\n\n\u305d\u308c\u305e\u308c\u306e\u7d20\u6570\u306b\u304a\u3051\u308b\u5546\u4f53$Z_p$ \u306b\u5bfe\u3057\u3066\n\n```math\n(a_1, p_1)\\\\\n(a_2, p_2)\\\\\n\\vdots\n```\n\n\u306a\u308b\u30c7\u30fc\u30bf\u304c\u3042\u308b\u3068\u3057\u307e\u3059\u3001\u306a\u3093\u3067\u3053\u3093\u306a\u3082\u3093\u3092\u8003\u3048\u308b\u306e\uff1f\u305d\u308c\u306f\u6700\u5f8c\u306b\u5c11\u3057\u3060\u3051\u66f8\u304d\u307e\u3059\u304c\u307e\u3041\u305d\u3046\u3044\u3046\u554f\u984c\u8a2d\u5b9a\u3060\u3068\u601d\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\u5358\u306a\u308b\u6709\u7406\u6570\u306e\u8a08\u7b97\u306a\u3089\u6574\u6570\u3092\uff12\u3064\u5206\u3068\u308b\u30c7\u30fc\u30bf\u578b\u306b\u3001\u8272\u3005\u3075\u3055\u308f\u3057\u3044\u6f14\u7b97\u3092\u5c0e\u5165\u3057\u3066\u3042\u3052\u305f\u3089\u3044\u3044\u3060\u3051\u306a\u306e\u3067\u3053\u3093\u306a\u8cea\u9762\u5012\u304f\u3055\u3044\u3053\u3068\u3092\u8003\u3048\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u3053\u3053\u3067\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u306e\u5b9a\u7406\u306b\u3088\u308a\u6700\u521d\u306e\uff12\u3064\u306e\u50cf\u3068\u7d20\u6570\u304b\u3089\u65b0\u305f\u306b\n\n```math\n\n(a,p_1*p_2)\n\n```\n\n\u306a\u308b\u30c7\u30fc\u30bf\u3092\u4f5c\u308a\u307e\u3059\u3001$a$ \u306e\u30ec\u30b7\u30d4\u306f[wiki\u306e\u8a72\u5f53\u30da\u30fc\u30b8](https://ja.wikipedia.org/wiki/\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406)\u53c2\u7167\u306e\u3053\u3068\u3002\n\u3053\u306e\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u62e1\u5f35\u30e6\u30fc\u30af\u30ea\u30c3\u30c9\u306b\u304b\u3051\u307e\u3059\u3068\u4eca\u5ea6\u306f\u5206\u6bcd\u5206\u5b50\u3068\u3082\u306b\n\n```math\ns_i^2,r_i^2 \\lessapprox (p_1*p_2)\n```\n\n\u3068\u3044\u3046\u7bc4\u56f2\u3067\u6c7a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3067\u8db3\u3089\u306a\u3051\u308c\u3070\u66f4\u306b\u3082\u3046\u4e00\u3064\u7d20\u6570\u3092\u53d6\u3063\u3066\u304d\u3066\n\n```math\ns_i^2,r_i^2 \\lessapprox (p_1*p_2*p_3)\n```\n\n\u3068\u3044\u3046\u98a8\u306b\u3069\u3093\u3069\u3093\u5236\u9650\u3092\u3086\u308b\u304f\u3057\u3066\u3044\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n ~~\u4f8b\u3048\u3070\u79c1\u306e\u74b0\u5883\uff08\u3059\u306a\u308f\u3061\u7d20\u6570\u3068\u3057\u306610^4 \u7a0b\u5ea6\u306e\u3082\u306e\u304b\u3089\u53d6\u3063\u305f\u5834\u5408\uff09\u306a\u3089\u3070\u4e0a\u8a18\u306e\u7d20\u6570\u306a\u30894\u3064\u304b5\u3064\u304b\u53d6\u308c\u3070Int \u306b\u304a\u3044\u3066\u5145\u5206\u306a\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002~~ \n\n```\nPrelude> maxBound :: Int\n9223372036854775807\nPrelude> 2^63 -1\n9223372036854775807\nPrelude> logBase 10 it\n18.964889726830812\n```\n\n ~~\u5f93\u3063\u3066\u4f8b\u3048\u30703\u3064\u53d6\u3063\u3066\u5fa9\u5143\u3057\u305f\u5024\u30684\u3064\u306e\u5024\u3001\u305d\u3057\u30665\u3064\u306e\u5024\u304c\u4e00\u81f4\u3057\u3066\u3044\u308c\u3070\u5b9f\u7528\u4e0a\u30e6\u30cb\u30fc\u30af\u306b\u5143\u306e\u6709\u7406\u6570\u304c\u5fa9\u5143\u3067\u304d\u3066\u308b\u3068\u3057\u3066\u826f\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002~~ \n\n\u3053\u308c\u306f\u5618\u3067\u3059\u3001\u6700\u5f8c\u306b\u8ffd\u8a18\u3067\u8a02\u6b63\u3055\u308c\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\u30aa\u30fc\u30c0\u30fc\u306e\u8aad\u307f\u3068\u3057\u3066\u306f\n\n```math\ns_i^2,r_i^2 \\lessapprox (p_1*\\cdots)\n```\n\n\u306e\u53f3\u8fba\u304cInt \u306e\u6700\u5927\u5024\u306e\u4e8c\u4e57\u3092\u4e0a\u304b\u3089\u6291\u3048\u305f\u3089\u826f\u3044\u306e\u3067\u3001\u3059\u306a\u308f\u306110 \u500b\u304c\u76ee\u5b89\u306b\u306a\u308a\u307e\u3059\u3002\n\u306a\u305c\u306a\u3089\n\n```math\np_1, \\cdots \\in o(10^4)\n```\n\n\u3068\u53d6\u3063\u305f\u7d20\u6570\u3068\n\n```\nPrelude> logBase 10 (2^63-1)\n18.964889726830812\n```\n\n\u3092\u6bd4\u3079\u305f\u3089\u826f\u3044\u306e\u3067\u3001\u5927\u4f5310\u500b\u306e\u7a4d\u3067Int \u3092\u30ab\u30d0\u30fc\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\n\n##\u6709\u7406\u6570\u306e\u5fa9\u5143\n\u4ee5\u4e0b\u304c\u4eca\u56de\u306e\u30b3\u30fc\u30c9\u306e\u5168\u666f\u306b\u306a\u308a\u307e\u3059\u3001\u7121\u4e8bquickCheck \u3082\u901a\u308a\u307e\u3057\u305f\u3002\n\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u306e\u8a08\u7b97\u306e\u3068\u3053\u308d\u3060\u3051$Integer$ \u3092\u4f7f\u3063\u3066\u307e\u3059\u304c\u3001\u305d\u308c\u4ee5\u5916\u306e\u6f14\u7b97\u306f\u57fa\u672c\u7684\u306b\u30de\u30b7\u30f3\u30b5\u30a4\u30ba\u306e$Int$ \u3067\u51fa\u6765\u308b\u306e\u304c\u30df\u30bd\u3067\u3059\u3002\n\n```lhs\n\n> module Ffield where\n\n> import Data.Ratio \n> import Data.Maybe\n> import Data.Numbers.Primes\n> import Test.QuickCheck\n\n> coprime :: Integral a => a -> a -> Bool\n> coprime a b = gcd a b == 1\n\nConsider a finite ring\n  Z_n := [0..(n-1)]\nof some Int number.\nIf any non-zero element has its multiplication inverse, then the ring is a field:\n\n> -- Our target should be in Int.\n> isField :: Int -> Bool\n> isField = isPrime\n\n> exGCD' :: (Integral n) => n -> n -> ([n], [n], [n], [n])\n> exGCD' a b = (qs, rs, ss, ts)\n>   where\n>     qs = zipWith quot rs (tail rs)\n>     rs = takeUntil (==0) r'\n>     r' = steps a b\n>     ss = steps 1 0\n>     ts = steps 0 1\n>     steps a b = rr\n>       where \n>         rr@(_:rs) = a:b: zipWith (-) rr (zipWith (*) qs rs)\n>\n> takeUntil :: (a -> Bool) -> [a] -> [a]\n> takeUntil p = foldr func []\n>   where\n>     func x xs \n>       | p x       = []\n>       | otherwise = x : xs\n>\n> -- a*x + b*y = gcd a b\n> exGCD :: Integral t => t -> t -> (t, t, t)\n> exGCD a b = (g, x, y)\n>   where\n>     (_,r,s,t) = exGCD' a b\n>     g = last r\n>     x = last . init $ s\n>     y = last . init $ t\n>\n> -- a^{-1} (in Z_p) == a `inversep` p\n> inversep :: Integral a => a -> a -> Maybe a -- We also use in CRT.\n> a `inversep` p = let (g,x,_) = exGCD a p in\n>   if (g == 1) \n>     then Just (x `mod` p) -- g==1 <=> coprime a p\n>     else Nothing\n>\n> inversesp :: Int -> [Maybe Int]\n> inversesp p = map (`inversep` p) [1..(p-1)]\n>\n> -- A map from Q to Z_p.\n> -- p should be prime.\n> modp :: Ratio Int -> Int -> Maybe Int\n> q `modp` p \n>   | coprime b p = Just $ (a * (bi `mod` p)) `mod` p\n>   | otherwise   = Nothing\n>   where\n>     (a,b)   = (numerator q, denominator q)\n>     Just bi = b `inversep` p\n>\n> -- This is guess function without Chinese Reminder Theorem.\n> guess :: Integral t => \n>          (Maybe t, t)       -- (q `modp` p, p)\n>       -> Maybe (Ratio t, t)\n> guess (Nothing, _) = Nothing\n> guess (Just a, p) = let (_,rs,ss,_) = exGCD' a p in\n>   Just (select rs ss p, p)\n>     where\n>       select :: Integral t => [t] -> [t] -> t -> Ratio t\n>       select [] _ _ = 0%1\n>       select (r:rs) (s:ss) p\n>         | s /= 0 && r*r <= p && s*s <= p = r%s\n>         | otherwise = select rs ss p\n>\n> -- Hard code of big primes\n> bigPrimes :: [Int]\n> bigPrimes = take 10 $ dropWhile (<10^4) primes\n> -- bigPrimes = take 10 $ dropWhile (<10^6) primes\n> -- 10 is just for \"practical\" reason.\n\n  *Ffield> let knownData q = zip (map (modp q) bigPrimes) bigPrimes\n  *Ffield> let ds = knownData (12%13)\n  *Ffield> map guess ds\n  [Just (12 % 13,10007)\n  ,Just (12 % 13,10009)\n  ,Just (12 % 13,10037)\n  ,Just (12 % 13,10039) ..\n\n  *Ffield> let ds = knownData (112%113)\n  *Ffield> map guess ds\n  [Just ((-39) % 50,10007)\n  ,Just ((-41) % 48,10009)\n  ,Just ((-69) % 20,10037)\n  ,Just ((-71) % 18,10039) ..\n\n--\nChinese Remainder Theorem, and its usage\n \n> imagesAndPrimes :: Ratio Int -> [(Maybe Int, Int)]\n> imagesAndPrimes q = zip (map (modp q) bigPrimes) bigPrimes\n \nOur data is a list of the type\n  [(Maybe Int, Int)]\nIn order to use CRT, we should cast its type.\n\n> toInteger2 :: [(Maybe Int, Int)] -> [(Maybe Integer, Integer)]\n> toInteger2 = map helper\n>   where \n>     helper (x,y) = (fmap toInteger x, toInteger y)\n>\n> crtRec':: Integral a => (Maybe a, a) -> (Maybe a, a) -> (Maybe a, a)\n> crtRec' (Nothing,p) (_,q)       = (Nothing, p*q)\n> crtRec' (_,p)       (Nothing,q) = (Nothing, p*q)\n> crtRec' (Just a1,p1) (Just a2,p2) = (Just a,p)\n>   where\n>     a = (a1*p2*m2 + a2*p1*m1) `mod` p\n>     Just m1 = p1 `inversep` p2 \n>     Just m2 = p2 `inversep` p1\n>     p = p1*p2\n>\n> matches3 :: Eq a => [Maybe (a,b)] -> Maybe (a,b)\n> matches3  (b1@(Just (q1,p1)):bb@((Just (q2,_)):(Just (q3,_)):_))\n>   | q1==q2 && q2==q3 = b1\n>   | otherwise        = matches3 bb\n> matches3 _ = Nothing\n\n  *Ffield> let ds = imagesAndPrimes (1123%1135)\n  *Ffield> map guess ds\n  [Just (25 % 52,10007)\n  ,Just ((-81) % 34,10009)\n  ,Just ((-88) % 63,10037) ..\n\n  *Ffield> matches3 it\n  Nothing\n\n  *Ffield> scanl1 crtRec' ds\n\n  *Ffield> scanl1 crtRec' . toInteger2 $ ds\n  [(Just 3272,10007)\n  ,(Just 14913702,100160063)\n  ,(Just 298491901442,1005306552331) ..\n\n  *Ffield> map guess it\n  [Just (25 % 52,10007)\n  ,Just (1123 % 1135,100160063)\n  ,Just (1123 % 1135,1005306552331)\n  ,Just (1123 % 1135,10092272478850909) ..\n\n  *Ffield> matches3 it\n  Just (1123 % 1135,100160063)\n\nThe final reconstruction function takes a list of Z_p values and returns the three times matched guess.\n\n> reconstruct :: [(Maybe Int, Int)] -> Maybe (Ratio Integer, Integer)\n> reconstruct = matches3 . map guess . scanl1 crtRec' . toInteger2\n\n--\n\n> aux :: [(Maybe Int, Int)] -> Ratio Int\n> aux = fromRational . fst . fromJust . reconstruct\n>\n> prop_rec :: Ratio Int -> Bool\n> prop_rec q = q == aux ds\n>   where\n>     ds = imagesAndPrimes q\n\n  *Ffield> quickCheck prop_rec \n  +++ OK, passed 100 tests.\n\n```\n\n\n#\u7d42\u308f\u308a\u306b\n\u6700\u521d\u306b\u8ff0\u3079\u305f\u3088\u3046\u306b\u3001Int \u3067\u4e0e\u3048\u3089\u308c\u305f\u6570\u5b57\u3067\u3082\u6f14\u7b97\u306e\u9014\u4e2d\u3067\u6841\u843d\u3061\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\n```\nPrelude> let a = maxBound :: Int\nPrelude> a\n9223372036854775807\nPrelude> a*2 :: Int\n-2\n```\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u6841\u843d\u3061\u3057\u305f\u5834\u5408\u672c\u8cea\u7684\u306a\u60c5\u5831\u306f\u5b8c\u5168\u306b\u6d88\u3048\u3066\u3057\u307e\u3046\u308f\u3051\u3067\u3059\u304c\u3001\u7d20\u6570\u4f53\u3068\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u3092\u7d44\u307f\u5408\u308f\u305b\u3001\u304b\u3064\u4e8c\u9805\u6f14\u7b97\u306e\u969b\u306b\u6bce\u56de$\\mod$ \u3092\u65bd\u3059\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3055\u308c\u305f\u6841\u843d\u3061\u74b0\u5883\u304c\u5b9f\u73fe\u3055\u308c\u308b\u308f\u3051\u3067\u3059\u3002\n\u3042\u308b\u3044\u306f\u5143\u304b\u3089\u8981\u7d20\u304c\u6709\u9650\u500b\u306a\u306e\u3067\u6841\u843d\u3061\u300c\u3057\u306a\u3044\u300d\u74b0\u5883\u3068\u3044\u3063\u3066\u3082\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3053\u3053\u3067\u53d6\u308a\u4e0a\u3052\u305f\u65b9\u6cd5\u306f\u6f14\u7b97\u306f\u5168\u3066\u5b89\u4fa1\u306a\u6709\u9650\u7cbe\u5ea6\u306eInt \u306e\u4e0a\u3067\u884c\u3044\u3001\u6700\u5f8c\u5fa9\u5143\u4f5c\u696d\u306e\u6642\u3060\u3051\u4efb\u610f\u7cbe\u5ea6\u306eInteger \u3067\u884c\u3046\u3068\u3044\u3046\u65b9\u6cd5\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u3057\u305f\u304c\u3063\u3066\u3001\u5168\u6f14\u7b97\u3092\u4efb\u610f\u5236\u5ea6\u306e\u6709\u7406\u6570Ratio Integer \u3067\u884c\u3046\u3088\u308a\u5b89\u4fa1\u3067\u3042\u308a\u305d\u3046\u306a\u96f0\u56f2\u6c17\u3092\u611f\u3058\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n##\u4e00\u4f53\u3069\u3046\u3057\u3066\uff1f\n\u3053\u3053\u3067\u3069\u3046\u3044\u3046\u554f\u984c\u3092\u8003\u3048\u305f\u304b\u3068\u3044\u3046\u3068\u3001\u5b9f\u306f\u6709\u7406\u6570\u4fc2\u6570\u306e\u591a\u9805\u5f0f\n\n```math\nf :: Q \\to Q\n```\n\n\u306a\u3069\u3092\uff08\u6211\u3005\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\uff09\u8003\u3048\u3066\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001\u3053\u306e\u3068\u304d$f$ \u304c\u30d6\u30e9\u30c3\u30af\u30dc\u30c3\u30af\u30b9\u3067\u4e0e\u3048\u3089\u308c\u3066\u3044\u3066\u4fc2\u6570\u306a\u3069\u3092\u77e5\u308a\u5f97\u306a\u3044\u72b6\u6cc1\u306b\u7f6e\u304b\u308c\u3066\u308b\u3068\u3057\u307e\u3059\u3002\n\uff08\u4f8b\u3048\u3070\u96e2\u6563\u70b9\u306b\u304a\u3051\u308b$f$ \u306e\u5024\u3060\u3051\u77e5\u3063\u3066\u308b\uff08\u30b0\u30e9\u30d5\u304c\u4e0e\u3048\u3089\u308c\u3066\u308b\uff09\u3068\u304b\uff09\n\u591a\u9805\u5f0f\u306a\u3089[\u30cb\u30e5\u30fc\u30c8\u30f3\u88dc\u9593](https://ja.wikipedia.org/wiki/\u30cb\u30e5\u30fc\u30c8\u30f3\u88dc\u9593)\u3068\u304b\u3001\u6709\u7406\u95a2\u6570\u3067\u3082Thiele \u306e\u65b9\u6cd5\u306a\u3069\u304c\u77e5\u3089\u308c\u3066\u3044\u3066\u3001\u5341\u5206\u306a\u70b9\u3092\u4e0e\u3048\u3055\u3048\u3059\u308c\u3070\u4fc2\u6570\u3092\u6c7a\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u88dc\u5b8c\u6cd5\u3092Int \u3067\u304d\u307e\u308b\u6709\u7406\u6570\u3067\u3084\u308b\u3068\u9014\u4e2d\u3067\u6841\u843d\u3061\u3068\u304b\u304c\u6016\u3044\u306e\u3067\u3001\u3044\u308d\u3093\u306a\u6709\u9650\u4f53Z_p$ \u306e\u4e0a\u3067\u884c\u3044\u3001\u7d50\u679c\u5404\u4fc2\u6570\u306e\n\n```math\n(a_1, p_1)\\\\\n(a_2, p_2)\\\\\n\\vdots\n```\n\n\u306a\u308b\u30c7\u30fc\u30bf\u304c\u5f97\u3089\u308c\u3066\u3044\u308b\u3001\u3068\u3044\u3046\u72b6\u6cc1\u3092\u60f3\u5b9a\u3057\u3066\u307e\u3059\u3002\n$Z_p$ \u3067\u3082\u3082\u3061\u308d\u3093 $ \\mod $ \u306e\u305b\u3044\u3067\u6841\u843d\u3061\u3057\u3066\u3044\u308b\u3068\u3044\u3048\u3070\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u304d\u3061\u3093\u3068\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u4e2d\u56fd\u306e\u5270\u4f59\u5b9a\u7406\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u304d\u3061\u3093\u3068\u6709\u7406\u6570\u4fc2\u6570\u3092\u5fa9\u5143\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3001\u3068\u3044\u3046\u5bf8\u6cd5\u3067\u3059\u3002\n\n# \u8ffd\u8a18\n\u4f55\u306e\u6c17\u306a\u3057\u306bquickCheck \u3092\u4f55\u5ea6\u304b\u30bf\u30a4\u30d7\u3057\u3066\u60a6\u306b\u5165\u3063\u3066\u307e\u3057\u305f\u3089\u3001\u6642\u6298\u3053\u3051\u308b\u3053\u3068\u304c\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3057\u305f\u3002\n\u4f8b\u3048\u3070\n\n```\n> quickCheck prop_rec \n*** Failed! Exception: 'Maybe.fromJust: Nothing' (after 9 tests and 1 shrink): \n56307372244017 % 5226552907916\n```\n\n\u3053\u308c\u306f\n\n```\n> 2^2*10009*130546331\n5226552907916\n```\n\n\u3068\u3044\u3046\u3053\u3068\u304b\u3089\u308f\u304b\u308b\u3088\u3046\u306b$Z_ {10009}$ \u306e\u4e0a\u3067\u306f$\\frac{1}{0}$ \u306e\u578b\u3092\u3057\u305f\u4e0d\u5b9a\u5f62\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3001\u3044\u308f\u3070\u30d5\u30a7\u30a4\u30af\u306e\u7121\u9650\u5927\u3067\u3059\u3002\n\u3057\u305f\u304c\u3063\u3066\u4e0b\u51e6\u7406\u3068\u3057\u3066Nothing \u3092\u53d6\u308a\u9664\u3044\u3066\u304a\u3051\u3070\u5927\u4e08\u592b\u3002\u3002\u3002\u3068\u601d\u3044\u307e\u3057\u305f\u304c\u3001\u3053\u308c\u306f\u5618\u3067\u3057\u305f\u3002\n\u3082\u3061\u308d\u3093Nothing \u3092\u53d6\u308a\u9664\u304f\u51e6\u7406\u3082\u5927\u4e8b\u3067\u3059\u304c\u4e00\u756a\u5927\u4e8b\u306a\u306e\u306fInt \u3092\u8986\u3046\u3053\u3068\u3067\u3001\u3053\u306e\u305f\u3081\u306b\u306f10\u56de\u306e\u5408\u81f4\u304c\u5fc5\u8981\u3067\u3059\u3002\n\uff08\u3053\u306e10 \u3068\u3044\u3046\u6570\u5b57\u306f\u79c1\u306e\u7d20\u6570\u306e\u30c1\u30e7\u30a4\u30b9\u3068Int \u306e\u6700\u5927\u5024\u306b\u3088\u3063\u3066\u6c7a\u307e\u3063\u3066\u3044\u307e\u3059\u3002\uff09\n\n```lhs\n> reconstruct :: [(Maybe Int, Int)] -> Maybe (Ratio Integer)\n> reconstruct = matches 10 . makeList\n>   where\n>     matches n (a:as)\n>       | all (a==) $ take (n-1) as = a\n>       | otherwise                     = matches n as\n>     makeList = map (fmap fst . guess) . scanl1 crtRec' . toInteger2 . filter (isJust . fst)\n\n--\n\n> prop_rec :: Ratio Int -> Bool\n> prop_rec q = Just q == answer\n>   where\n>    answer :: Maybe (Ratio Int)\n>    answer = fmap fromRational . reconstruct $ ds\n>    ds = imagesAndPrimes q\n\n  *Ffield> quickCheckWith stdArgs { maxSuccess = 100000 } prop_rec \n  +++ OK, passed 100000 tests.\n```\n\n\u5ff5\u306e\u305f\u3081\u591a\u3081\u306b\u53d6\u308a\u307e\u3057\u305f\u304c\u3001\u4eca\u5ea6\u3053\u305d\u5927\u4e08\u592b\u306a\u306f\u305a\u3067\u3059\u3002\n", "tags": ["Haskell", "\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0", "\u6570\u5b66"]}