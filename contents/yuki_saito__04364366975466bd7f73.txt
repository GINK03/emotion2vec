{"context": "\n\n1.AeroSpike\nKVS\u306e\u4e00\u3064\u3002KVS\u306eKVS\u3068\u3044\u3063\u305f\u611f\u3058\u3002\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u578b\u3067\u306f\u306a\u3044\u3002\n\u4ef6\u6570\u53d6\u5f97\u3057\u305f\u308a\u3001ttl\u53d6\u5f97\u3057\u305f\u308a\u3059\u308b\u3068\u304d\u304c\u3042\u308b\u306e\u3067\u30c1\u30e7\u30c3\u30c8Lua\u30b3\u30fc\u30c9\u3092\u6b8b\u3057\u3066\u304a\u304f\u3002\nttl\u306f\u6700\u8fd1\u306eAeroSpikeClient\u3060\u3068\u3001getTtl\u3068\u304b\u3067\u53d6\u5f97\u3067\u304d\u3066\u3057\u307e\u3046\u304c\u3001\u3053\u308c\u3092\u4f5c\u3063\u305f\u306e\u306f\n\u7d50\u69cb\u524d\uff08\u305d\u3046\u3044\u3046\u306e\u304c\u7121\u304b\u3063\u305f\u6642\u4ee3\u306e\u304a\u8a71\uff09\u3002\nshow set\u3067\u4ef6\u6570\u898b\u308c\u308b\u3058\u3083\u3093\u3002\u3068\u601d\u3063\u3066\u30b5\u30dd\u30fc\u30c8\u306b\u805e\u3044\u305f\u3089\u305d\u308c\u306f\u4e00\u81f4\u3057\u3066\u3044\u308b\u304b\u602a\u3057\u3044\u3002\n\u3068\u306e\u3053\u3068\u3060\u3063\u305f\u3002\u5f8c\u306f\u3001\u8907\u6570\u53f0\u904b\u7528\u3057\u3066\u3044\u305f\u3089\u5408\u8a08\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u304b\u3089\u9762\u5012\u3002\n\n2.test.lua\u3092\u4f5c\u308b\n\ntest.lua\nfunction count(s)\n    function mapper(rec)\n            return 1\n    end\n    local function reducer(v1, v2)\n        return v1 + v2\n    end\n    return s : map(mapper) : reduce(reducer)\nend\n\n\nfunction getttl(rec)\n\n        if aerospike:exists(rec) then\n                ttl = record.ttl(rec)\n                return string.format(\"rec ttl = %d\", ttl)\n        end\n\nend\n\n\n\n\u4ef6\u6570\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u3068\u3001ttl\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u3092\u5b9a\u7fa9\n\n3.aql\u30b3\u30de\u30f3\u30c9\u6253\u3064\u3002\naql\nset LUA_USERPATH  'lua_code'\nregister module '/home/xxxxxxx/test.lua'\nset TIMEOUT 100000\n\n4.\u5b9f\u884c\n\n4.1\u4ef6\u6570\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\nAGGREGATE test.count() ON xxxx.hogehoge\nxxxx:\u30b9\u30ad\u30fc\u30de\nhogehoge:\u30c6\u30fc\u30d6\u30eb\u540d\n\n4.2TTL\u3092\u78ba\u8a8d\u3057\u305f\u3044\u5834\u5408\nEXECUTE test.getttl() on xxxx.hogehoge where PK='1'\nPK\u306fKey\u3092\u6307\u5b9a\n\n5.module\u3092remove\u3059\u308b\u5834\u5408\nremove module test.lua\n#1.AeroSpike\nKVS\u306e\u4e00\u3064\u3002KVS\u306eKVS\u3068\u3044\u3063\u305f\u611f\u3058\u3002\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u578b\u3067\u306f\u306a\u3044\u3002\n\n\u4ef6\u6570\u53d6\u5f97\u3057\u305f\u308a\u3001ttl\u53d6\u5f97\u3057\u305f\u308a\u3059\u308b\u3068\u304d\u304c\u3042\u308b\u306e\u3067\u30c1\u30e7\u30c3\u30c8Lua\u30b3\u30fc\u30c9\u3092\u6b8b\u3057\u3066\u304a\u304f\u3002\nttl\u306f\u6700\u8fd1\u306eAeroSpikeClient\u3060\u3068\u3001getTtl\u3068\u304b\u3067\u53d6\u5f97\u3067\u304d\u3066\u3057\u307e\u3046\u304c\u3001\u3053\u308c\u3092\u4f5c\u3063\u305f\u306e\u306f\n\u7d50\u69cb\u524d\uff08\u305d\u3046\u3044\u3046\u306e\u304c\u7121\u304b\u3063\u305f\u6642\u4ee3\u306e\u304a\u8a71\uff09\u3002\n\nshow set\u3067\u4ef6\u6570\u898b\u308c\u308b\u3058\u3083\u3093\u3002\u3068\u601d\u3063\u3066\u30b5\u30dd\u30fc\u30c8\u306b\u805e\u3044\u305f\u3089\u305d\u308c\u306f\u4e00\u81f4\u3057\u3066\u3044\u308b\u304b\u602a\u3057\u3044\u3002\n\u3068\u306e\u3053\u3068\u3060\u3063\u305f\u3002\u5f8c\u306f\u3001\u8907\u6570\u53f0\u904b\u7528\u3057\u3066\u3044\u305f\u3089\u5408\u8a08\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u304b\u3089\u9762\u5012\u3002\n\n#2.test.lua\u3092\u4f5c\u308b\n\n```lua:test.lua\nfunction count(s)\n    function mapper(rec)\n            return 1\n    end\n    local function reducer(v1, v2)\n        return v1 + v2\n    end\n    return s : map(mapper) : reduce(reducer)\nend\n\n\nfunction getttl(rec)\n\n        if aerospike:exists(rec) then\n                ttl = record.ttl(rec)\n                return string.format(\"rec ttl = %d\", ttl)\n        end\n\nend\n\n```\n\n\u4ef6\u6570\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u3068\u3001ttl\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u3092\u5b9a\u7fa9\n\n#3.aql\u30b3\u30de\u30f3\u30c9\u6253\u3064\u3002\naql\nset LUA_USERPATH  'lua_code'\nregister module '/home/xxxxxxx/test.lua'\nset TIMEOUT 100000\n\n#4.\u5b9f\u884c\n\n##4.1\u4ef6\u6570\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\nAGGREGATE test.count() ON xxxx.hogehoge\nxxxx:\u30b9\u30ad\u30fc\u30de\nhogehoge:\u30c6\u30fc\u30d6\u30eb\u540d\n\n##4.2TTL\u3092\u78ba\u8a8d\u3057\u305f\u3044\u5834\u5408\nEXECUTE test.getttl() on xxxx.hogehoge where PK='1'\nPK\u306fKey\u3092\u6307\u5b9a\n\n#5.module\u3092remove\u3059\u308b\u5834\u5408\nremove module test.lua\n", "tags": ["Aerospike", "KVS", "bigdata"]}