{"context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\uff1aPowershell\u306e\u6b63\u898f\u8868\u73fe\u3068\u7f6e\u63db\u306e\u7fd2\u5f97\n\n\u6700\u7d42\u7684\u306b\u4f5c\u308b\u3082\u306e\n\n\nC:\\work\\\u914d\u4e0b\u306e\u69d8\u3005\u306a\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306b\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u3001C:\\work2\\\u914d\u4e0b\u306bmove\u3057\u3066\u96c6\u3081\u308b\n\n\nmove\u5148\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u91cd\u8907\u3057\u305f\u5834\u5408\u3001\u300c\u30d5\u30a1\u30a4\u30eb\u540d_\u901a\u756a.\u62e1\u5f35\u5b50\u300d\u306b\u30ea\u30cd\u30fc\u30e0\u3059\u308b \n\n\n\n\n\n\n\u203b\u66f8\u304d\u306f\u3058\u30812016/1/1\u3000\u5b8c\u4e86\u4e88\u5b9a2016/1/3\n\n\n\nPowershell\u306b\u89aa\u3057\u3080\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5bc4\u308a\u9053\u3001\u8131\u7dda\u3082\u305f\u304f\u3055\u3093\u3057\u307e\u3059\n\n$FROM = \"C:\\work\"\n$MOVETO = \"C:\\work2\"\n\n#\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30ea\u30b9\u30c8\u53d6\u5f97\n$DIR_ = dir ${FROM}\n#\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30ea\u30b9\u30c8\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u53d6\u5f97\n$FILENM = ${DIR_}.name\n#\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30ea\u30b9\u30c8\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u30d5\u30eb\u30d1\u30b9\u4e00\u89a7\u53d6\u5f97\n$FULLNM = ${DIR_}.fullname\n\n\n# if\u6587\u3067\u3001-match\u6f14\u7b97\u5b50\u3092\u7528\u3044\u3001\u6b63\u898f\u8868\u73fe\u306b\u3088\u308b\u6587\u5b57\u5217\u691c\u7d22 \nforeach ($i in $FILENM) {\n\n  # ^ = \u53f3\u306e\u6587\u5b57\u304c\u884c\u982d\u306b\u306a\u308b\u4f4d\u7f6e\u6761\u4ef6\u3092\u8868\u3059\u7279\u6b8a\u6587\u5b57\n  # $ = \u5de6\u306e\u6587\u5b57\u304c\u884c\u672b\u306b\u306a\u308b\u4f4d\u7f6e\u6761\u4ef6\u3092\u8868\u3059\u7279\u6b8a\u6587\u5b57\n\n    # \u4f8b\uff1a\u6587\u5b57\u5217\"yamamoto\"\u300c\u3060\u3051\u300d\u306b\u30de\u30c3\u30c1\u3055\u305b\u308b\u5834\u5408\n    # if ( $i -match ^yamamoto$){\u51e6\u7406}\n\n\n  # . = \u4efb\u610f\u306e1\u6587\u5b57\u3092\u8868\u3059\u7279\u6b8a\u6587\u5b57\n  # * = \u7e70\u308a\u8fd4\u3057\u3092\u8868\u3059\u7279\u6b8a\u6587\u5b57\n  # \\ = \u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57\n    # \u300c.txt\u300d\u306e\u5834\u5408\u306f\u300c\\.txt\u300d\u3068\u66f8\u3044\u3066\u3001\u7279\u6b8a\u6587\u5b57\u306e\u610f\u5473\u3092\u6d88\u3059\n\n    # \u4f8b\uff1a\u300c.txt\u300d\u306e\u62e1\u5f35\u5b50\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3059\u3079\u3066\u306b\u30de\u30c3\u30c1\u3055\u305b\u308b\u5834\u5408\n    # if ( $i -match ^.*\\.txt$){\u51e6\u7406}\n\n\n  # \\s = \u7a7a\u767d\u306e\u6b63\u898f\u8868\u73fe\n  # \\S = \u7a7a\u767d\u4ee5\u5916\u306e\u6b63\u898f\u8868\u73fe\n  if ( ${i} -match \"^.*\\S\\.txt$\") {\n  write ${i}\n  }\n}\n    # \u62e1\u5f35\u5b50\u3092\u9664\u3044\u305f1\u756a\u5f8c\u308d\u306e\u6587\u5b57\u304c\u7a7a\u767d\u306e\u5834\u5408\u3001\u30de\u30c3\u30c1\u3057\u306a\u3044\n      # \"AAAAA.txt\"\u306b\u30de\u30c3\u30c1\u3057\u3001\"AAAA .txt\"\u306b\u306f\u30de\u30c3\u30c1\u3057\u306a\u3044\n    # \\s\u306f\u53cd\u5bfe\n\u3000    # \"AAAA .txt\"\u306b\u30de\u30c3\u30c1\u3057\u3001\"AAAAA.txt\"\u306b\u306f\u30de\u30c3\u30c1\u3057\u306a\u3044\n\n\n\n\nforeach ($i in $FILENM) {\n\n  # \\w = \u5358\u8a9e\n  # \\W = \u5358\u8a9e\u4ee5\u5916\n  if ( \"${i}\" -match \"^.*\\W..txt$\") {\n  write ${i}\n  }\n}\n\n\n\n\nforeach ($i in $FILENM) {\n\n  # \\b = \u5358\u8a9e\u306e\u5883\u754c\n  # \\B = \u5358\u8a9e\u306e\u5883\u754c\u3067\u306f\u306a\u3044\u3053\u3068\u3092\u793a\u3059\n  if ( \"${i}\" -match \"^.*\\b..txt$\") {\n  write ${i}\n  }\n}\n\n\n\n\nforeach ($i in $FILENM) {\n\n\n  # {n} = \u76f4\u524d\u306e\u6587\u5b57\u306en\u56de\u306e\u7e70\u308a\u8fd4\u3057 \u3053\u306e\u3070\u3042\u3044\u306f\u300c.(\u4efb\u610f\u306e\u6587\u5b57)\u300d\u30923\u56de\n  if ( \"${i}\" -match \"^.{3}.txt$\") {\n  write ${i}\n  }\n}\n#ren $i ${i}_1.txt\n#}\n###\n\n\n\n\n\n\n\u3054\u3061\u3083\u3054\u3061\u3083\u3057\u3066\u304d\u305f\u306e\u3067\u4f5c\u308a\u76f4\u3057\n\n\n\n# \u3084\u308a\u305f\u3044\u3053\u3068\n  # C:\\work\\\u914d\u4e0b\u306e\u69d8\u3005\u306a\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306b\u3042\u308b\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u3001C:\\work2\\\u914d\u4e0b\u306bmove\u3057\u3066\u96c6\u3081\u308b\n  # move\u5148\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u91cd\u8907\u3057\u305f\u5834\u5408\u3001\u300c\u30d5\u30a1\u30a4\u30eb\u540d_\u901a\u756a.\u62e1\u5f35\u5b50\u300d\u306b\u30ea\u30cd\u30fc\u30e0\u3059\u308b\n\n\n# \u691c\u7d22\u30c9\u30e9\u30a4\u30d6\u30d1\u30b9\n$DRIVE = \"C:\"\n# \u691c\u7d22\u306e\u6700\u4e0a\u4f4d\u3068\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3000\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u5e30\u7684\u306b\u63a2\u3057\u307e\u3059\n$FROM = \"\\work\"\n\n# \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\u5148\n$MOVETO = \"C:\\work2\"\n\n# \u691c\u7d22\n$DIR_ = dir -Recurse ${DRIVE}${FROM}\n  # \u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u53d6\u5f97\n  $FILENM = ${DIR_}.name\n  # \u30d5\u30eb\u30cd\u30fc\u30e0\u3067\u53d6\u5f97\n  $FULLNM = ${DIR_}.fullname\n\n\n\n\nforeach ($i in $FULLNM) {\n\n  # \u30d5\u30a1\u30a4\u30eb\u540d\u306bb\u3068c\u3092\u9806\u4e0d\u540c\u306b\u542b\u3080\u5834\u5408\u3092\u691c\u51fa\u3057\u3066\u307f\u308b\n  # if (($i -match \"${DRIVE}\\${FROM}(\\\\.*)*\\\\.*b.*c.*\\.(.)*$\") -or ($i -match \"${DRIVE}\\${FROM}(\\\\.*)*\\\\.*c.*b.*\\.(.)*$\")) {\n  # write $i\n  # \u62e1\u5f35\u5b50\u306e\u524d\u306b\u300c_1\u300d\u3068\u3064\u3051\u3066\u30ea\u30cd\u30fc\u30e0\u3057\u3066\u307f\u308b\n  #  dir ${i} | rename-item -newname { $_.name -replace '\\.(.)*','_1$&' }\n  #}\n\n  #\u4e0a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066switch\u6587\u3067\u66f8\u3044\u3066\u307f\u308b\n  switch -regex ($i) {\n  \"${DRIVE}\\${FROM}(\\\\.*)*\\\\.*b.*c.*\\.(.)*$\" {\n  write $i\n  }\n  \"${DRIVE}\\${FROM}(\\\\.*)*\\\\.*c.*b.*\\.(.)*$\" {\n  write $i\n  }\n  }\n  dir ${i} | rename-item -newname { $_.name -replace '\\.(.)*','_1$&' }\n  }\n}\n\n\n\n\n\n\u3054\u3061\u3083\u3054\u3061\u3083\u3057\u3066\u304d\u305f\u306e\u3067\u4f5c\u308a\u76f4\u3057\uff12\n\n\u3060\u3044\u3076\u60dc\u3057\u3044\u3068\u3053\u308d\u307e\u3067\u304d\u305f\n\n\n  # C:\\work\\\u914d\u4e0b\u306e\u69d8\u3005\u306a\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306b\u3042\u308b\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u3001C:\\work2\\\u914d\u4e0b\u306bmove\u3057\u3066\u96c6\u3081\u308b\n  # move\u5148\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u91cd\u8907\u3057\u305f\u5834\u5408\u3001\u300c\u30d5\u30a1\u30a4\u30eb\u540d_\u901a\u756a.\u62e1\u5f35\u5b50\u300d\u306b\u30ea\u30cd\u30fc\u30e0\u3059\u308b\n\n# \u691c\u7d22\u30c9\u30e9\u30a4\u30d6\u30d1\u30b9\n$DRIVE = \"C:\"\n# \u691c\u7d22\u306e\u6700\u4e0a\u4f4d\u3068\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3000\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u5e30\u7684\u306b\u63a2\u3057\u307e\u3059\n$FROM = \"\\work\"\n\n# \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\u5148\n$MOVETO = \"C:\\work2\"\n\n# \u691c\u7d22\n$DIR_ = dir -file -Recurse ${DRIVE}${FROM}\n  # \u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u53d6\u5f97\n  $FILENM = ${DIR_}.name\n  # \u30d5\u30eb\u30cd\u30fc\u30e0\u3067\u53d6\u5f97\n  $FULLNM = ${DIR_}.fullname\n\n  # \u91cd\u8907\u30d5\u30a1\u30a4\u30eb\u540d\u30ab\u30a6\u30f3\u30c8\u7528\u30cf\u30c3\u30b7\u30e5\n  $count = @{}\n\nforeach ($i in $FULLNM) {\n$fullpass = $i\n$filename = &{split-path \"$i\" -leaf}\n\n$count.$filename += 1\n$counter = $count.$filename\n\n  if (\"$counter\" -ge 2) {\n  dir ${i} | rename-item -newname { $_.name -replace '\\.(.)*','_xxxx$&' }\n  }\n}\n\n\n\n\n\n\u21d3\u21d3\u3010\u6210\u529f\u30112016/1/2 21:14\u3000\u5b8c\u4e86\n\n  # C:\\work\\\u914d\u4e0b\u306e\u69d8\u3005\u306a\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306b\u3042\u308b\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u3001C:\\work2\\\u914d\u4e0b\u306bmove\u3057\u3066\u96c6\u3081\u308b\n  # move\u5148\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u91cd\u8907\u3057\u305f\u5834\u5408\u3001\u300c\u30d5\u30a1\u30a4\u30eb\u540d_\u901a\u756a.\u62e1\u5f35\u5b50\u300d\u306b\u30ea\u30cd\u30fc\u30e0\u3059\u308b\n\n\n# \u691c\u7d22\u30c9\u30e9\u30a4\u30d6\u30d1\u30b9\n$DRIVE = \"C:\"\n\n# \u691c\u7d22\u306e\u6700\u4e0a\u4f4d\u3068\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3000\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u5e30\u7684\u306b\u63a2\u3057\u307e\u3059\n$FROM = \"\\work\"\n\n# \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\u5148\n$MOVETO = \"C:\\work2\"\n\n\n\n\n# \u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\n\n  # DIR\u7d50\u679c\u3092\u5909\u6570\u683c\u7d0d\n  $DIR_ = dir -file -Recurse ${DRIVE}${FROM}\n\n  # DIR\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u3092\u53d6\u5f97\n  $FILENM = ${DIR_}.name\n\n  # DIR\u304b\u3089\u30d5\u30eb\u30d1\u30b9(X:\\xxxx\\xxxx.xxxx)\u3067\u53d6\u5f97\u3000\n  $FULLNM = ${DIR_}.fullname\n\n\n\n\n# \u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u304b\u3089\u3001\u91cd\u8907\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u30ea\u30cd\u30fc\u30e0\u3059\u308b\n  # \u30d5\u30a1\u30a4\u30eb\u540d\u30ab\u30a6\u30f3\u30c8\u7528\u306b\u7a7a\u30cf\u30c3\u30b7\u30e5\u4f5c\u6210\n  $count = @{}\n\n  # \u30d5\u30eb\u30d1\u30b9(X:\\xxxx\\xxxx.xxxx)\u3067\u53d6\u5f97\u3057\u305f\u5168\u968e\u5c64\u306b\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u30011\u884c\u305a\u3064\u8aad\u307f\u8fbc\u307f\n  foreach ($i in $FULLNM) {\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5909\u6570\u683c\u7d0d\n    $filename = &{split-path \"$i\" -leaf}\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u62e1\u5f35\u5b50\u306a\u3057\u3067\u5909\u6570\u683c\u7d0d\n    $noextent = [System.IO.Path]::GetFileNameWithoutExtension($i)\n\n    # \u62e1\u5f35\u5b50\u306e\u307f\u3092\u5909\u6570\u683c\u7d0d\n    $extent = [System.IO.Path]::GetExtension($i)\n\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d1\u3064\u3092\u30ad\u30fc\u306b\u3057\u3066\u3001\u5024\u30921\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\n    $count.$filename += 1\n\n    # \u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u6570\u3092\u5909\u6570\u683c\u7d0d\n    $counter = ${count}.${filename}\n\n    # \u91cd\u8907\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u3001\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u6570\u5b57\u304c2\u4ee5\u4e0a\u306b\u306a\u308b\n    if (\"$counter\" -ge 2) {\n\n      # \u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u6570\u5b57\u3092\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u4ed8\u756a\u3057\u30ea\u30cd\u30fc\u30e0\n      # \u30d5\u30a1\u30a4\u30eb\u540d(\u30d5\u30eb\u30d1\u30b9) \u2192 \u30d5\u30a1\u30a4\u30eb\u540d(\u62e1\u5f35\u5b50\u306a\u3057)_\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u6570_\u62e1\u5f35\u5b50\n      ren ${i} -newname ${noextent}_${counter}_${extent}\n\n    } \n  }\n\n\n\n\n# \u30ea\u30cd\u30fc\u30e0\u3057\u305f\u5f8c\u306b\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u518d\u53d6\u5f97\u3059\u308b\n\n  # DIR\u7d50\u679c\u3092\u5909\u6570\u683c\u7d0d\n  $DIR2_ = dir -file -Recurse ${DRIVE}${FROM}\n\n  # DIR\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u3092\u53d6\u5f97\n  $FILENM2 = ${DIR2_}.name\n\n  # DIR\u304b\u3089\u30d5\u30eb\u30d1\u30b9(X:\\xxxx\\xxxx.xxxx)\u3067\u53d6\u5f97\u3000\n  $FULLNM2 = ${DIR2_}.fullname\n\n\n\n\n# move\u3059\u308b\n  foreach ($i in $FULLNM2) {\n  mv -Path $i -Destination $MOVETO\n  }\n\n\n\n\n\n\n\n\n\u21d3\u21d3\u3010\u8ffd\u52a0\u8981\u4ef6\u3011\u66f8\u304d\u59cb\u3081\uff1a1/3 12:20\u3000\u5b8c\u4e86\u4e88\u5b9a\uff1a\uff5e1/3\u4e2d\n\n\u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u30c6\u30ad\u30b9\u30c8\u306e\u5834\u5408\u3001\u4e2d\u8eab\u3092\u8aad\u307f\u8fbc\u3093\u3067\u51e6\u7406\u3059\u308b\n\n\n\u300c:\u300d\u3092\u30c7\u30ea\u30df\u30bf\u306b\u3057\u3066\u30011\u8981\u7d20\u76ee\u30682\u8981\u7d20\u76ee\u3092\u53d6\u308a\u51fa\u3059\n\u6b63\u898f\u8868\u73fe\u3092\u7528\u3044\u3066\u7f6e\u63db\u3092\u884c\u3046\n\n\n\n\n\u3000\u3000\u3000\u3000\u21d2\u21d2\u3010\u5b8c\u4e86\u30112016/1/3 15:02\u3000\u21d3\u21d3\n\n\n\n\n# \u691c\u7d22\u30c9\u30e9\u30a4\u30d6\u30d1\u30b9\n$DRIVE = \"C:\"\n\n# \u691c\u7d22\u306e\u6700\u4e0a\u4f4d\u3068\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3000\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u5e30\u7684\u306b\u63a2\u3057\u307e\u3059\n$FROM = \"\\work\"\n\n# \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\u5148\n$MOVETO = \"C:\\work2\"\n\n\n\n\n# \u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\n\n  # DIR\u7d50\u679c\u3092\u5909\u6570\u683c\u7d0d\n  $DIR_ = dir -file -Recurse ${DRIVE}${FROM}\n\n  # DIR\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u3092\u53d6\u5f97\n  $FILENM = ${DIR_}.name\n\n  # DIR\u304b\u3089\u30d5\u30eb\u30d1\u30b9(X:\\xxxx\\xxxx.xxxx)\u3067\u53d6\u5f97\u3000\n  $FULLNM = ${DIR_}.fullname\n\n\n\n# \u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306b\u3042\u308b\"ccc\"\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u7a7a\u767d(\"\")\u306b\u7f6e\u63db\u3059\u308b(1/3\u8ffd\u52a0)\n  foreach ($i in $FULLNM2){\n\n  # Get-Content(gc)\u3067\u8aad\u307f\u8fbc\u3093\u30601\u884c\u76ee($i)\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n  $readfile = &{gc $i}\n\n  # \u6b63\u898f\u8868\u73fe\u3067\u7f6e\u63db\n  # \"ccc\"\u306f\u6b63\u898f\u8868\u73fe\u3067\"\\bccc\\b\"\u3000(\\b\u306f\u5358\u8a9e\u306e\u5883\u754c)\n  # \u203b\u30a8\u30b9\u30b1\u30fc\u30d7\u30b7\u30fc\u30b1\u30f3\u30b9\u306f\u4e0d\u8981\u3000(Perl\u3067\u3044\u3046\u3068\u3053\u308d\u306e\\Q\"string\"\\E)\n    ## \u3064\u307e\u308a\u3001\"ccbc\"\u306a\u3069\u306f\u3001\u691c\u7d22\u7d50\u679c\u306b\u542b\u307e\u308c\u305a\u3001\u7d14\u7c8b\u306a\"ccc\"\u304c\u7f6e\u63db\u5bfe\u8c61\u3068\u306a\u308b\n  $renamed = $readfile -replace \"\\bccc\\b\",\"\"\n\n  # \u7f6e\u63db\u7d50\u679c\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u4e0a\u66f8\u304d\u3059\u308b\n  $renamed >$i\n  }\n\n\n  # \u300c:\u300d\u3092\u30c7\u30ea\u30df\u30bf\u306b\u3057\u3066\u533a\u5207\u308b\n  foreach ($i in ${FULLNM}){\n\n  # Get-Content(gc)\u3067\u8aad\u307f\u8fbc\u3093\u30601\u884c\u76ee($i)\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n  $readfile = &{gc $i}\n\n  # split\u95a2\u6570\u306b\u6e21\u3057\u3066\u300c:\u300d\u3067\u533a\u5207\u308b\n  $nocolon = $readfile.Split(\":\")\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u62e1\u5f35\u5b50\u306a\u3057\u3067\u5909\u6570\u683c\u7d0d\n    $noextent = [System.IO.Path]::GetFileNameWithoutExtension($i)\n\n    # \u62e1\u5f35\u5b50\u306e\u307f\u3092\u5909\u6570\u683c\u7d0d\n    $extent = [System.IO.Path]::GetExtension($i)\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u30d1\u30b9\u306e\u307f\u53d6\u5f97\n    $pass_ = [System.IO.Path]::GetDirectoryName($i)\n\n  # \u4fdd\u5b58\uff1a\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\\\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u540d_nocolon_\u62e1\u5f35\u5b50\n  $nocolon >\"${pass_}\\${noextent}_nocolon_${extent}\"\n  }\n\n# \u76ee\u7684\uff1aPowershell\u306e\u6b63\u898f\u8868\u73fe\u3068\u7f6e\u63db\u306e\u7fd2\u5f97\n* \u6700\u7d42\u7684\u306b\u4f5c\u308b\u3082\u306e\n  * C:\\work\\\u914d\u4e0b\u306e\u69d8\u3005\u306a\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306b\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u3092\u3001C:\\work2\\\u914d\u4e0b\u306bmove\u3057\u3066\u96c6\u3081\u308b\n     * move\u5148\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u91cd\u8907\u3057\u305f\u5834\u5408\u3001\u300c\u30d5\u30a1\u30a4\u30eb\u540d_\u901a\u756a.\u62e1\u5f35\u5b50\u300d\u306b\u30ea\u30cd\u30fc\u30e0\u3059\u308b \n\n##\u203b\u66f8\u304d\u306f\u3058\u30812016/1/1\u3000\u5b8c\u4e86\u4e88\u5b9a2016/1/3\n</br>\n</br>\n####Powershell\u306b\u89aa\u3057\u3080\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5bc4\u308a\u9053\u3001\u8131\u7dda\u3082\u305f\u304f\u3055\u3093\u3057\u307e\u3059\n\n```ps1\n\n$FROM = \"C:\\work\"\n$MOVETO = \"C:\\work2\"\n\n#\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30ea\u30b9\u30c8\u53d6\u5f97\n$DIR_ = dir ${FROM}\n#\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30ea\u30b9\u30c8\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u53d6\u5f97\n$FILENM = ${DIR_}.name\n#\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30ea\u30b9\u30c8\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u30d5\u30eb\u30d1\u30b9\u4e00\u89a7\u53d6\u5f97\n$FULLNM = ${DIR_}.fullname\n\n\n# if\u6587\u3067\u3001-match\u6f14\u7b97\u5b50\u3092\u7528\u3044\u3001\u6b63\u898f\u8868\u73fe\u306b\u3088\u308b\u6587\u5b57\u5217\u691c\u7d22 \nforeach ($i in $FILENM) {\n\n  # ^ = \u53f3\u306e\u6587\u5b57\u304c\u884c\u982d\u306b\u306a\u308b\u4f4d\u7f6e\u6761\u4ef6\u3092\u8868\u3059\u7279\u6b8a\u6587\u5b57\n  # $ = \u5de6\u306e\u6587\u5b57\u304c\u884c\u672b\u306b\u306a\u308b\u4f4d\u7f6e\u6761\u4ef6\u3092\u8868\u3059\u7279\u6b8a\u6587\u5b57\n\n    # \u4f8b\uff1a\u6587\u5b57\u5217\"yamamoto\"\u300c\u3060\u3051\u300d\u306b\u30de\u30c3\u30c1\u3055\u305b\u308b\u5834\u5408\n    # if ( $i -match ^yamamoto$){\u51e6\u7406}\n\n\n  # . = \u4efb\u610f\u306e1\u6587\u5b57\u3092\u8868\u3059\u7279\u6b8a\u6587\u5b57\n  # * = \u7e70\u308a\u8fd4\u3057\u3092\u8868\u3059\u7279\u6b8a\u6587\u5b57\n  # \\ = \u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57\n    # \u300c.txt\u300d\u306e\u5834\u5408\u306f\u300c\\.txt\u300d\u3068\u66f8\u3044\u3066\u3001\u7279\u6b8a\u6587\u5b57\u306e\u610f\u5473\u3092\u6d88\u3059\n\n    # \u4f8b\uff1a\u300c.txt\u300d\u306e\u62e1\u5f35\u5b50\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3059\u3079\u3066\u306b\u30de\u30c3\u30c1\u3055\u305b\u308b\u5834\u5408\n    # if ( $i -match ^.*\\.txt$){\u51e6\u7406}\n\n\n  # \\s = \u7a7a\u767d\u306e\u6b63\u898f\u8868\u73fe\n  # \\S = \u7a7a\u767d\u4ee5\u5916\u306e\u6b63\u898f\u8868\u73fe\n  if ( ${i} -match \"^.*\\S\\.txt$\") {\n  write ${i}\n  }\n}\n    # \u62e1\u5f35\u5b50\u3092\u9664\u3044\u305f1\u756a\u5f8c\u308d\u306e\u6587\u5b57\u304c\u7a7a\u767d\u306e\u5834\u5408\u3001\u30de\u30c3\u30c1\u3057\u306a\u3044\n      # \"AAAAA.txt\"\u306b\u30de\u30c3\u30c1\u3057\u3001\"AAAA .txt\"\u306b\u306f\u30de\u30c3\u30c1\u3057\u306a\u3044\n    # \\s\u306f\u53cd\u5bfe\n\u3000    # \"AAAA .txt\"\u306b\u30de\u30c3\u30c1\u3057\u3001\"AAAAA.txt\"\u306b\u306f\u30de\u30c3\u30c1\u3057\u306a\u3044\n\n\n\n\nforeach ($i in $FILENM) {\n\n  # \\w = \u5358\u8a9e\n  # \\W = \u5358\u8a9e\u4ee5\u5916\n  if ( \"${i}\" -match \"^.*\\W..txt$\") {\n  write ${i}\n  }\n}\n\n\n\n\nforeach ($i in $FILENM) {\n\n  # \\b = \u5358\u8a9e\u306e\u5883\u754c\n  # \\B = \u5358\u8a9e\u306e\u5883\u754c\u3067\u306f\u306a\u3044\u3053\u3068\u3092\u793a\u3059\n  if ( \"${i}\" -match \"^.*\\b..txt$\") {\n  write ${i}\n  }\n}\n\n\n\n\nforeach ($i in $FILENM) {\n\n\n  # {n} = \u76f4\u524d\u306e\u6587\u5b57\u306en\u56de\u306e\u7e70\u308a\u8fd4\u3057 \u3053\u306e\u3070\u3042\u3044\u306f\u300c.(\u4efb\u610f\u306e\u6587\u5b57)\u300d\u30923\u56de\n  if ( \"${i}\" -match \"^.{3}.txt$\") {\n  write ${i}\n  }\n}\n#ren $i ${i}_1.txt\n#}\n###\n\n\n\n```\n</br>\n\n##\u3054\u3061\u3083\u3054\u3061\u3083\u3057\u3066\u304d\u305f\u306e\u3067\u4f5c\u308a\u76f4\u3057\n\n\n```ps1\n\n\n\n# \u3084\u308a\u305f\u3044\u3053\u3068\n  # C:\\work\\\u914d\u4e0b\u306e\u69d8\u3005\u306a\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306b\u3042\u308b\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u3001C:\\work2\\\u914d\u4e0b\u306bmove\u3057\u3066\u96c6\u3081\u308b\n  # move\u5148\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u91cd\u8907\u3057\u305f\u5834\u5408\u3001\u300c\u30d5\u30a1\u30a4\u30eb\u540d_\u901a\u756a.\u62e1\u5f35\u5b50\u300d\u306b\u30ea\u30cd\u30fc\u30e0\u3059\u308b\n\n\n# \u691c\u7d22\u30c9\u30e9\u30a4\u30d6\u30d1\u30b9\n$DRIVE = \"C:\"\n# \u691c\u7d22\u306e\u6700\u4e0a\u4f4d\u3068\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3000\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u5e30\u7684\u306b\u63a2\u3057\u307e\u3059\n$FROM = \"\\work\"\n\n# \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\u5148\n$MOVETO = \"C:\\work2\"\n\n# \u691c\u7d22\n$DIR_ = dir -Recurse ${DRIVE}${FROM}\n  # \u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u53d6\u5f97\n  $FILENM = ${DIR_}.name\n  # \u30d5\u30eb\u30cd\u30fc\u30e0\u3067\u53d6\u5f97\n  $FULLNM = ${DIR_}.fullname\n\n\n\n\nforeach ($i in $FULLNM) {\n\n  # \u30d5\u30a1\u30a4\u30eb\u540d\u306bb\u3068c\u3092\u9806\u4e0d\u540c\u306b\u542b\u3080\u5834\u5408\u3092\u691c\u51fa\u3057\u3066\u307f\u308b\n  # if (($i -match \"${DRIVE}\\${FROM}(\\\\.*)*\\\\.*b.*c.*\\.(.)*$\") -or ($i -match \"${DRIVE}\\${FROM}(\\\\.*)*\\\\.*c.*b.*\\.(.)*$\")) {\n  # write $i\n  # \u62e1\u5f35\u5b50\u306e\u524d\u306b\u300c_1\u300d\u3068\u3064\u3051\u3066\u30ea\u30cd\u30fc\u30e0\u3057\u3066\u307f\u308b\n  #  dir ${i} | rename-item -newname { $_.name -replace '\\.(.)*','_1$&' }\n  #}\n  \n  #\u4e0a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066switch\u6587\u3067\u66f8\u3044\u3066\u307f\u308b\n  switch -regex ($i) {\n  \"${DRIVE}\\${FROM}(\\\\.*)*\\\\.*b.*c.*\\.(.)*$\" {\n  write $i\n  }\n  \"${DRIVE}\\${FROM}(\\\\.*)*\\\\.*c.*b.*\\.(.)*$\" {\n  write $i\n  }\n  }\n  dir ${i} | rename-item -newname { $_.name -replace '\\.(.)*','_1$&' }\n  }\n}\n\n\n```\n</br>\n\n##\u3054\u3061\u3083\u3054\u3061\u3083\u3057\u3066\u304d\u305f\u306e\u3067\u4f5c\u308a\u76f4\u3057\uff12\n\n* \u3060\u3044\u3076\u60dc\u3057\u3044\u3068\u3053\u308d\u307e\u3067\u304d\u305f\n\n```ps1\n\n  # C:\\work\\\u914d\u4e0b\u306e\u69d8\u3005\u306a\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306b\u3042\u308b\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u3001C:\\work2\\\u914d\u4e0b\u306bmove\u3057\u3066\u96c6\u3081\u308b\n  # move\u5148\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u91cd\u8907\u3057\u305f\u5834\u5408\u3001\u300c\u30d5\u30a1\u30a4\u30eb\u540d_\u901a\u756a.\u62e1\u5f35\u5b50\u300d\u306b\u30ea\u30cd\u30fc\u30e0\u3059\u308b\n\n# \u691c\u7d22\u30c9\u30e9\u30a4\u30d6\u30d1\u30b9\n$DRIVE = \"C:\"\n# \u691c\u7d22\u306e\u6700\u4e0a\u4f4d\u3068\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3000\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u5e30\u7684\u306b\u63a2\u3057\u307e\u3059\n$FROM = \"\\work\"\n\n# \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\u5148\n$MOVETO = \"C:\\work2\"\n\n# \u691c\u7d22\n$DIR_ = dir -file -Recurse ${DRIVE}${FROM}\n  # \u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u53d6\u5f97\n  $FILENM = ${DIR_}.name\n  # \u30d5\u30eb\u30cd\u30fc\u30e0\u3067\u53d6\u5f97\n  $FULLNM = ${DIR_}.fullname\n\n  # \u91cd\u8907\u30d5\u30a1\u30a4\u30eb\u540d\u30ab\u30a6\u30f3\u30c8\u7528\u30cf\u30c3\u30b7\u30e5\n  $count = @{}\n\nforeach ($i in $FULLNM) {\n$fullpass = $i\n$filename = &{split-path \"$i\" -leaf}\n\n$count.$filename += 1\n$counter = $count.$filename\n\n  if (\"$counter\" -ge 2) {\n  dir ${i} | rename-item -newname { $_.name -replace '\\.(.)*','_xxxx$&' }\n  }\n}\n\n\n```\n</br>\n\n#\u21d3\u21d3\u3010\u6210\u529f\u30112016/1/2 21:14\u3000\u5b8c\u4e86\n\n</br>\n\n\n```ps1\n  # C:\\work\\\u914d\u4e0b\u306e\u69d8\u3005\u306a\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306b\u3042\u308b\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u3001C:\\work2\\\u914d\u4e0b\u306bmove\u3057\u3066\u96c6\u3081\u308b\n  # move\u5148\u3067\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u91cd\u8907\u3057\u305f\u5834\u5408\u3001\u300c\u30d5\u30a1\u30a4\u30eb\u540d_\u901a\u756a.\u62e1\u5f35\u5b50\u300d\u306b\u30ea\u30cd\u30fc\u30e0\u3059\u308b\n\n\n# \u691c\u7d22\u30c9\u30e9\u30a4\u30d6\u30d1\u30b9\n$DRIVE = \"C:\"\n\n# \u691c\u7d22\u306e\u6700\u4e0a\u4f4d\u3068\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3000\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u5e30\u7684\u306b\u63a2\u3057\u307e\u3059\n$FROM = \"\\work\"\n\n# \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\u5148\n$MOVETO = \"C:\\work2\"\n\n\n\n\n# \u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\n\n  # DIR\u7d50\u679c\u3092\u5909\u6570\u683c\u7d0d\n  $DIR_ = dir -file -Recurse ${DRIVE}${FROM}\n\n  # DIR\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u3092\u53d6\u5f97\n  $FILENM = ${DIR_}.name\n\n  # DIR\u304b\u3089\u30d5\u30eb\u30d1\u30b9(X:\\xxxx\\xxxx.xxxx)\u3067\u53d6\u5f97\u3000\n  $FULLNM = ${DIR_}.fullname\n\n\n\n\n# \u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u304b\u3089\u3001\u91cd\u8907\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u30ea\u30cd\u30fc\u30e0\u3059\u308b\n  # \u30d5\u30a1\u30a4\u30eb\u540d\u30ab\u30a6\u30f3\u30c8\u7528\u306b\u7a7a\u30cf\u30c3\u30b7\u30e5\u4f5c\u6210\n  $count = @{}\n\n  # \u30d5\u30eb\u30d1\u30b9(X:\\xxxx\\xxxx.xxxx)\u3067\u53d6\u5f97\u3057\u305f\u5168\u968e\u5c64\u306b\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u30011\u884c\u305a\u3064\u8aad\u307f\u8fbc\u307f\n  foreach ($i in $FULLNM) {\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5909\u6570\u683c\u7d0d\n    $filename = &{split-path \"$i\" -leaf}\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u62e1\u5f35\u5b50\u306a\u3057\u3067\u5909\u6570\u683c\u7d0d\n    $noextent = [System.IO.Path]::GetFileNameWithoutExtension($i)\n\n    # \u62e1\u5f35\u5b50\u306e\u307f\u3092\u5909\u6570\u683c\u7d0d\n    $extent = [System.IO.Path]::GetExtension($i)\n\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d1\u3064\u3092\u30ad\u30fc\u306b\u3057\u3066\u3001\u5024\u30921\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\n    $count.$filename += 1\n\n    # \u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u6570\u3092\u5909\u6570\u683c\u7d0d\n    $counter = ${count}.${filename}\n\n    # \u91cd\u8907\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u3001\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u6570\u5b57\u304c2\u4ee5\u4e0a\u306b\u306a\u308b\n    if (\"$counter\" -ge 2) {\n\n      # \u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u6570\u5b57\u3092\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u4ed8\u756a\u3057\u30ea\u30cd\u30fc\u30e0\n      # \u30d5\u30a1\u30a4\u30eb\u540d(\u30d5\u30eb\u30d1\u30b9) \u2192 \u30d5\u30a1\u30a4\u30eb\u540d(\u62e1\u5f35\u5b50\u306a\u3057)_\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3057\u305f\u6570_\u62e1\u5f35\u5b50\n      ren ${i} -newname ${noextent}_${counter}_${extent}\n\n    } \n  }\n\n\n\n\n# \u30ea\u30cd\u30fc\u30e0\u3057\u305f\u5f8c\u306b\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u518d\u53d6\u5f97\u3059\u308b\n\n  # DIR\u7d50\u679c\u3092\u5909\u6570\u683c\u7d0d\n  $DIR2_ = dir -file -Recurse ${DRIVE}${FROM}\n\n  # DIR\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u3092\u53d6\u5f97\n  $FILENM2 = ${DIR2_}.name\n\n  # DIR\u304b\u3089\u30d5\u30eb\u30d1\u30b9(X:\\xxxx\\xxxx.xxxx)\u3067\u53d6\u5f97\u3000\n  $FULLNM2 = ${DIR2_}.fullname\n\n\n\n\n# move\u3059\u308b\n  foreach ($i in $FULLNM2) {\n  mv -Path $i -Destination $MOVETO\n  }\n\n\n\n\n\n```\n</br>\n\n#\u21d3\u21d3\u3010\u8ffd\u52a0\u8981\u4ef6\u3011\u66f8\u304d\u59cb\u3081\uff1a1/3 12:20\u3000\u5b8c\u4e86\u4e88\u5b9a\uff1a\uff5e1/3\u4e2d\n* \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u30c6\u30ad\u30b9\u30c8\u306e\u5834\u5408\u3001\u4e2d\u8eab\u3092\u8aad\u307f\u8fbc\u3093\u3067\u51e6\u7406\u3059\u308b\n * \u300c:\u300d\u3092\u30c7\u30ea\u30df\u30bf\u306b\u3057\u3066\u30011\u8981\u7d20\u76ee\u30682\u8981\u7d20\u76ee\u3092\u53d6\u308a\u51fa\u3059\n * \u6b63\u898f\u8868\u73fe\u3092\u7528\u3044\u3066\u7f6e\u63db\u3092\u884c\u3046\n\n#\u3000\u3000\u3000\u3000\u21d2\u21d2\u3010\u5b8c\u4e86\u30112016/1/3 15:02\u3000\u21d3\u21d3\n</br>\n\n```ps1\n\n\n\n# \u691c\u7d22\u30c9\u30e9\u30a4\u30d6\u30d1\u30b9\n$DRIVE = \"C:\"\n\n# \u691c\u7d22\u306e\u6700\u4e0a\u4f4d\u3068\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3000\u3053\u306e\u30d5\u30a9\u30eb\u30c0\u914d\u4e0b\u306e\u5168\u30d5\u30a1\u30a4\u30eb\u3092\u518d\u5e30\u7684\u306b\u63a2\u3057\u307e\u3059\n$FROM = \"\\work\"\n\n# \u691c\u7d22\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\u5148\n$MOVETO = \"C:\\work2\"\n\n\n\n\n# \u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\n\n  # DIR\u7d50\u679c\u3092\u5909\u6570\u683c\u7d0d\n  $DIR_ = dir -file -Recurse ${DRIVE}${FROM}\n\n  # DIR\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u540d\u4e00\u89a7\u3092\u53d6\u5f97\n  $FILENM = ${DIR_}.name\n\n  # DIR\u304b\u3089\u30d5\u30eb\u30d1\u30b9(X:\\xxxx\\xxxx.xxxx)\u3067\u53d6\u5f97\u3000\n  $FULLNM = ${DIR_}.fullname\n\n\n\n# \u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306b\u3042\u308b\"ccc\"\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u7a7a\u767d(\"\")\u306b\u7f6e\u63db\u3059\u308b(1/3\u8ffd\u52a0)\n  foreach ($i in $FULLNM2){\n\n  # Get-Content(gc)\u3067\u8aad\u307f\u8fbc\u3093\u30601\u884c\u76ee($i)\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n  $readfile = &{gc $i}\n\n  # \u6b63\u898f\u8868\u73fe\u3067\u7f6e\u63db\n  # \"ccc\"\u306f\u6b63\u898f\u8868\u73fe\u3067\"\\bccc\\b\"\u3000(\\b\u306f\u5358\u8a9e\u306e\u5883\u754c)\n  # \u203b\u30a8\u30b9\u30b1\u30fc\u30d7\u30b7\u30fc\u30b1\u30f3\u30b9\u306f\u4e0d\u8981\u3000(Perl\u3067\u3044\u3046\u3068\u3053\u308d\u306e\\Q\"string\"\\E)\n    ## \u3064\u307e\u308a\u3001\"ccbc\"\u306a\u3069\u306f\u3001\u691c\u7d22\u7d50\u679c\u306b\u542b\u307e\u308c\u305a\u3001\u7d14\u7c8b\u306a\"ccc\"\u304c\u7f6e\u63db\u5bfe\u8c61\u3068\u306a\u308b\n  $renamed = $readfile -replace \"\\bccc\\b\",\"\"\n\n  # \u7f6e\u63db\u7d50\u679c\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u4e0a\u66f8\u304d\u3059\u308b\n  $renamed >$i\n  }\n\n  \n  # \u300c:\u300d\u3092\u30c7\u30ea\u30df\u30bf\u306b\u3057\u3066\u533a\u5207\u308b\n  foreach ($i in ${FULLNM}){\n\n  # Get-Content(gc)\u3067\u8aad\u307f\u8fbc\u3093\u30601\u884c\u76ee($i)\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n  $readfile = &{gc $i}\n\n  # split\u95a2\u6570\u306b\u6e21\u3057\u3066\u300c:\u300d\u3067\u533a\u5207\u308b\n  $nocolon = $readfile.Split(\":\")\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u62e1\u5f35\u5b50\u306a\u3057\u3067\u5909\u6570\u683c\u7d0d\n    $noextent = [System.IO.Path]::GetFileNameWithoutExtension($i)\n\n    # \u62e1\u5f35\u5b50\u306e\u307f\u3092\u5909\u6570\u683c\u7d0d\n    $extent = [System.IO.Path]::GetExtension($i)\n\n    # \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u30d1\u30b9\u306e\u307f\u53d6\u5f97\n    $pass_ = [System.IO.Path]::GetDirectoryName($i)\n\n  # \u4fdd\u5b58\uff1a\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\\\u5143\u306e\u30d5\u30a1\u30a4\u30eb\u540d_nocolon_\u62e1\u5f35\u5b50\n  $nocolon >\"${pass_}\\${noextent}_nocolon_${extent}\"\n  }\n", "tags": ["PowerShell", ".NETFramework"]}