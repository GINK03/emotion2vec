{"context": "\n\n\u5c0e\u51fa\nFeguson-Coons \u66f2\u7dda \u3067\u901f\u5ea6\u3092\u6307\u5b9a\u3059\u308b\u4ee3\u308f\u308a\u306b 2 \u3064\u306e\u5236\u5fa1\u70b9 \u2192p1\\vec{p}_{1} \u3068 \u2192p2\\vec{p}_{2} \u3092\u6307\u5b9a\u3059\u308b\u66f2\u7dda\u3067\n\\begin{align}\n                \\vec{p}_{1} &= \\vec{p}_\\mathrm{begin} + \\frac{1}{3} \\vec{v}_\\mathrm{begin} \\\\\n\\Leftrightarrow \\vec{v}_\\mathrm{begin} &= 3 (\\vec{p}_{1} - \\vec{p}_\\mathrm{begin}) \\\\\n                \\vec{p}_{2} &= \\vec{p}_\\mathrm{end} - \\frac{1}{3} \\vec{v}_\\mathrm{end} \\\\\n\\Leftrightarrow \\vec{v}_\\mathrm{end}  &= 3 (\\vec{p}_\\mathrm{end} - \\vec{p}_{2})\n\\end{align}\n\u2192p1=\u2192pbegin+13\u2192vbegin\u21d4\u2192vbegin=3(\u2192p1\u2212\u2192pbegin)\u2192p2=\u2192pend\u221213\u2192vend\u21d4\u2192vend=3(\u2192pend\u2212\u2192p2){\\begin{align}\n                \\vec{p}_{1} &= \\vec{p}_\\mathrm{begin} + \\frac{1}{3} \\vec{v}_\\mathrm{begin} \\\\\n\\Leftrightarrow \\vec{v}_\\mathrm{begin} &= 3 (\\vec{p}_{1} - \\vec{p}_\\mathrm{begin}) \\\\\n                \\vec{p}_{2} &= \\vec{p}_\\mathrm{end} - \\frac{1}{3} \\vec{v}_\\mathrm{end} \\\\\n\\Leftrightarrow \\vec{v}_\\mathrm{end}  &= 3 (\\vec{p}_\\mathrm{end} - \\vec{p}_{2})\n\\end{align}\n}\n\u3068\u5b9a\u7fa9\u3055\u308c\u308b\u3002\u305d\u306e\u307e\u307e\u5f0f\u306b\u4ee3\u5165\u3057\u3066\u6574\u7406\u3059\u308b\u3068\n\\begin{align}\n\\vec{p}_\\mathrm{B}(t)\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       2 &  1 &  1 & -2 \\\\\n      -3 & -2 & -1 &  3 \\\\\n       0 &  1 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{v}_\\mathrm{begin} \\\\\n      \\vec{v}_\\mathrm{end} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       2 &  1 &  1 & -2 \\\\\n      -3 & -2 & -1 &  3 \\\\\n       0 &  1 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       1 &  0 &  0 &  0 \\\\\n      -3 &  3 &  0 &  0 \\\\\n       0 &  0 & -3 &  3 \\\\\n       0 &  0 &  0 &  1 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_\\mathrm{1} \\\\\n      \\vec{p}_\\mathrm{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n      -1 &  3 & -3 &  1 \\\\\n       3 & -6 &  3 &  0 \\\\\n      -3 &  3 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_{1} \\\\\n      \\vec{p}_{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n\n &= \\left[ \\begin{array}{cccc}\n         -t^{3} + 3 t^{2} - 3 t + 1  &\n      3 ( t^{3} - 2 t^{2} +   t    ) &\n      3 (-t^{3} +   t^{2}          ) &\n          t^{3}\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_{1} \\\\\n      \\vec{p}_{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &=         (1 - t)^{3} \\vec{p}_\\mathrm{begin}\n  + 3 t     (1 - t)^{2} \\vec{p}_{1}\n  + 3 t^{2} (1 - t)     \\vec{p}_{2}\n  +   t^{3}             \\vec{p}_\\mathrm{end}\n\\end{align}\n\u2192pB(t)=[t3t2t1][211\u22122\u22123\u22122\u22121301001000][\u2192pbegin\u2192vbegin\u2192vend\u2192pend]=[t3t2t1][211\u22122\u22123\u22122\u22121301001000][1000\u2212330000\u2212330001][\u2192pbegin\u2192p1\u2192p2\u2192pend]=[t3t2t1][\u221213\u2212313\u2212630\u221233001000][\u2192pbegin\u2192p1\u2192p2\u2192pend]=[\u2212t3+3t2\u22123t+13(t3\u22122t2+t)3(\u2212t3+t2)t3][\u2192pbegin\u2192p1\u2192p2\u2192pend]=(1\u2212t)3\u2192pbegin+3t(1\u2212t)2\u2192p1+3t2(1\u2212t)\u2192p2+t3\u2192pend{\\begin{align}\n\\vec{p}_\\mathrm{B}(t)\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       2 &  1 &  1 & -2 \\\\\n      -3 & -2 & -1 &  3 \\\\\n       0 &  1 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{v}_\\mathrm{begin} \\\\\n      \\vec{v}_\\mathrm{end} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       2 &  1 &  1 & -2 \\\\\n      -3 & -2 & -1 &  3 \\\\\n       0 &  1 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       1 &  0 &  0 &  0 \\\\\n      -3 &  3 &  0 &  0 \\\\\n       0 &  0 & -3 &  3 \\\\\n       0 &  0 &  0 &  1 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_\\mathrm{1} \\\\\n      \\vec{p}_\\mathrm{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n      -1 &  3 & -3 &  1 \\\\\n       3 & -6 &  3 &  0 \\\\\n      -3 &  3 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_{1} \\\\\n      \\vec{p}_{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n\n &= \\left[ \\begin{array}{cccc}\n         -t^{3} + 3 t^{2} - 3 t + 1  &\n      3 ( t^{3} - 2 t^{2} +   t    ) &\n      3 (-t^{3} +   t^{2}          ) &\n          t^{3}\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_{1} \\\\\n      \\vec{p}_{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &=         (1 - t)^{3} \\vec{p}_\\mathrm{begin}\n  + 3 t     (1 - t)^{2} \\vec{p}_{1}\n  + 3 t^{2} (1 - t)     \\vec{p}_{2}\n  +   t^{3}             \\vec{p}_\\mathrm{end}\n\\end{align}\n}\n\u3068\u306a\u308b\u3002\u2192p0=\u2192pbegin\\vec{p}_{0} = \\vec{p}_\\mathrm{begin} \u304a\u3088\u3073 \u2192p3=\u2192pend\\vec{p}_{3} = \\vec{p}_\\mathrm{end} \u3068\u304a\u304f\u3068\n\\vec{p}_\\mathrm{B}(t) = \\sum_{i=0}^{3} {}_{3}C_{i} t^{i} (1-t)^{3-i} \\vec{p}_{i}\n\u2192pB(t)=3\u2211i=03Citi(1\u2212t)3\u2212i\u2192pi{\\vec{p}_\\mathrm{B}(t) = \\sum_{i=0}^{3} {}_{3}C_{i} t^{i} (1-t)^{3-i} \\vec{p}_{i}\n}\n\u3068\u306a\u308a\u3001\u6b21\u6570\u3092 3 \u304b\u3089 nn \u306b\u4e00\u822c\u5316\u3059\u308b\u3068\n\\vec{p}_\\mathrm{B}(t) = \\sum_{i=0}^{n} = {}_{n}C_{i} t^{i} (1-t)^{n-i} \\vec{p}_{i}\n\u2192pB(t)=n\u2211i=0=nCiti(1\u2212t)n\u2212i\u2192pi{\\vec{p}_\\mathrm{B}(t) = \\sum_{i=0}^{n} = {}_{n}C_{i} t^{i} (1-t)^{n-i} \\vec{p}_{i}\n}\n\u3068\u306a\u308b\u3002\u3053\u3053\u3067 nCm=n!m!(n\u2212m)!_{n} C_{m} = \\frac{n!}{m!(n-m)!} \u3067\u3042\u308b\u3002\n\n\u70b9\u5217\u3078\u306e\u5f53\u3066\u306f\u3081\nFeguson-Coons \u66f2\u7dda \u3068\u540c\u69d8\u306e\u624b\u9806\u3067\u3067\u304d\u308b\u3002\n\u70b9\u5217 (\u2192xi)ni=1(\\vec{x}_{i})_{i=1}^{n} \u304c\u5165\u529b\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3066\u3044\u308b\u3068\u304d\u4e09\u6b21 B\u00e9zier \u66f2\u7dda\u3092\u5f53\u3066\u306f\u3081\u308b\u3002\u305f\u3060\u3057\u3001\u66f2\u7dda\u4e0a\u306e\u70b9\u3092 \u2192pB(t)\\vec{p}_{B}(t) \u3068\u3057\u305f\u3068\u304d\u3001\u2192xi=\u2192pB(i\u22121n\u22121)\\vec{x}_{i} = \\vec{p}_\\mathrm{B}(\\frac{i-1}{n-1}) \u3068\u306a\u308b\u3068\u3059\u308b\u3002\u3064\u307e\u308a\u59cb\u70b9\u3068\u7d42\u70b9\u3092\u3001\u305d\u308c\u305e\u308c \u2192pB(0)=\u2192p0=\u2192x1\\vec{p}_{B}(0) = \\vec{p}_{0} = \\vec{x}_{1} \u3068 \u2192pB(1)=\u2192pn=\u2192xn\\vec{p}_{B}(1) = \\vec{p}_{n} = \\vec{x}_{n} \u3068\u3059\u308b\u3002\n\u70b9\u5217\u304b\u3089 \u2192p1\\vec{p}_{1} \u3068 \u2192p2\\vec{p}_{2} \u3092\u6c42\u3081\u308b\u3002ti=i\u22121n\u22121t_{i} = \\frac{i-1}{n-1} \u3068\u3059\u308b\u3068\n\\begin{align}\n\\vec{x}_{i} &= \\vec{p}_\\mathrm{B}\\left(t_{i} \\right) \\\\\n\\Leftrightarrow \\vec{x}_{i}\n &=             (1 - t_{i})^{3} \\vec{x}_{1}\n  + 3 t_{i}     (1 - t_{i})^{2} \\vec{p}_{1}\n  + 3 t_{i}^{2} (1 - t_{i})     \\vec{p}_{2}\n  +   t_{i}^{3}                 \\vec{x}_{n} \\\\\n\n\\Leftrightarrow \\vec{x}_{i} - (1 - t_{i})^{3} \\vec{x}_{1} - t_{i}^{3} \\vec{x}_{n}\n &= 3 t_{i} (1 - t_{i})^{2} \\vec{p}_{1} + 3 t_{i}^{2} (1 - t_{i}) \\vec{p}_{2}\n\\end{align}\n\u2192xi=\u2192pB(ti)\u21d4\u2192xi=(1\u2212ti)3\u2192x1+3ti(1\u2212ti)2\u2192p1+3t2i(1\u2212ti)\u2192p2+t3i\u2192xn\u21d4\u2192xi\u2212(1\u2212ti)3\u2192x1\u2212t3i\u2192xn=3ti(1\u2212ti)2\u2192p1+3t2i(1\u2212ti)\u2192p2{\\begin{align}\n\\vec{x}_{i} &= \\vec{p}_\\mathrm{B}\\left(t_{i} \\right) \\\\\n\\Leftrightarrow \\vec{x}_{i}\n &=             (1 - t_{i})^{3} \\vec{x}_{1}\n  + 3 t_{i}     (1 - t_{i})^{2} \\vec{p}_{1}\n  + 3 t_{i}^{2} (1 - t_{i})     \\vec{p}_{2}\n  +   t_{i}^{3}                 \\vec{x}_{n} \\\\\n\n\\Leftrightarrow \\vec{x}_{i} - (1 - t_{i})^{3} \\vec{x}_{1} - t_{i}^{3} \\vec{x}_{n}\n &= 3 t_{i} (1 - t_{i})^{2} \\vec{p}_{1} + 3 t_{i}^{2} (1 - t_{i}) \\vec{p}_{2}\n\\end{align}\n}\n\u3053\u3053\u3067 \u2192bi=\u2192xi\u2212(1\u2212ti)3\u2192x1\u2212t3i\u2192xn\\vec{b}_{i} = \\vec{x}_{i} - (1 - t_{i})^{3} \\vec{x}_{1} - t_{i}^{3} \\vec{x}_{n} \u3068\u304a\u304f\u3002\n\\begin{align}\n\\Leftrightarrow \\vec{b}_{i} &= t_{i} (1 - t_{i})^{2} \\vec{p}_{1} + t_{i}^{2} (1 - t_{i}) \\vec{p}_{2} \\\\\n\\Leftrightarrow \\vec{b}_{i}^{\\top}\n &= \\left[ \\begin{array}{cc}\n      3 t_{i} (1 - t_{i})^{2} &\n      3 t_{i}^{2} (1 - t_{i})\n    \\end{array} \\right]\n    \\left[ \\begin{array}{cc}\n      p_{1}^{x} & p_{1}^{y} \\\\\n      p_{2}^{x} & p_{2}^{y}\n    \\end{array} \\right]\n\\end{align}\n\u21d4\u2192bi=ti(1\u2212ti)2\u2192p1+t2i(1\u2212ti)\u2192p2\u21d4\u2192b\u22a4i=[3ti(1\u2212ti)23t2i(1\u2212ti)][px1py1px2py2]{\\begin{align}\n\\Leftrightarrow \\vec{b}_{i} &= t_{i} (1 - t_{i})^{2} \\vec{p}_{1} + t_{i}^{2} (1 - t_{i}) \\vec{p}_{2} \\\\\n\\Leftrightarrow \\vec{b}_{i}^{\\top}\n &= \\left[ \\begin{array}{cc}\n      3 t_{i} (1 - t_{i})^{2} &\n      3 t_{i}^{2} (1 - t_{i})\n    \\end{array} \\right]\n    \\left[ \\begin{array}{cc}\n      p_{1}^{x} & p_{1}^{y} \\\\\n      p_{2}^{x} & p_{2}^{y}\n    \\end{array} \\right]\n\\end{align}\n}\n\u3053\u3053\u3067\n\\begin{align}\n\\vec{a}_{i} &= \\left[ \\begin{array}{c}\n    3 t_{i} (1 - t_{i})^{2} \\\\\n    3 t_{i}^{2} (1 - t_{i})\n  \\end{array} \\right] \\\\\nX^{\\top} &= \\left[ \\begin{array}{cc}\n    p_{1}^{x} & p_{1}^{y} \\\\\n    p_{2}^{x} & p_{2}^{y}\n  \\end{array} \\right]\n\\Leftrightarrow X = \\left[ \\begin{array}{cc}\n    \\vec{p}_{1} & \\vec{p}_{2}\n  \\end{array} \\right] \\\\\n\\end{align}\n\u2192ai=[3ti(1\u2212ti)23t2i(1\u2212ti)]X\u22a4=[px1py1px2py2]\u21d4X=[\u2192p1\u2192p2]{\\begin{align}\n\\vec{a}_{i} &= \\left[ \\begin{array}{c}\n    3 t_{i} (1 - t_{i})^{2} \\\\\n    3 t_{i}^{2} (1 - t_{i})\n  \\end{array} \\right] \\\\\nX^{\\top} &= \\left[ \\begin{array}{cc}\n    p_{1}^{x} & p_{1}^{y} \\\\\n    p_{2}^{x} & p_{2}^{y}\n  \\end{array} \\right]\n\\Leftrightarrow X = \\left[ \\begin{array}{cc}\n    \\vec{p}_{1} & \\vec{p}_{2}\n  \\end{array} \\right] \\\\\n\\end{align}\n}\n\u3068\u304a\u304f\u3002\n\\begin{align}\n\\Leftrightarrow \\vec{b}_{i}^{\\top} &= \\vec{a}_{i}^{\\top} X^{\\top}\n\\end{align}\n\u21d4\u2192b\u22a4i=\u2192a\u22a4iX\u22a4{\\begin{align}\n\\Leftrightarrow \\vec{b}_{i}^{\\top} &= \\vec{a}_{i}^{\\top} X^{\\top}\n\\end{align}\n}\n\u5217\u30d9\u30af\u30c8\u30eb \u2192ai\\vec{a}_{i} \u3092 nn \u500b\u306a\u3089\u3079\u305f\u884c\u5217\u3092 AA\u3001\u540c\u69d8\u306b \u2192bi\\vec{b}_{i} \u3092 nn \u500b\u306a\u3089\u3079\u305f\u884c\u5217\u3092 BB \u3068\u3059\u308b\u3068\n\\begin{align}\n\\Leftrightarrow A^{\\top} X^{\\top} &= B^{\\top} \\\\\n\\Leftrightarrow X A &= B \\\\\n\\Leftrightarrow X A A^{\\top} &= B A^{\\top} \\\\\n\\Leftrightarrow X &= B A^{\\top} (A A^{\\top})^{-1} \\\\\n\\end{align}\n\u21d4A\u22a4X\u22a4=B\u22a4\u21d4XA=B\u21d4XAA\u22a4=BA\u22a4\u21d4X=BA\u22a4(AA\u22a4)\u22121{\\begin{align}\n\\Leftrightarrow A^{\\top} X^{\\top} &= B^{\\top} \\\\\n\\Leftrightarrow X A &= B \\\\\n\\Leftrightarrow X A A^{\\top} &= B A^{\\top} \\\\\n\\Leftrightarrow X &= B A^{\\top} (A A^{\\top})^{-1} \\\\\n\\end{align}\n}\n\u3068\u3057\u3066 \u2192p1\\vec{p}_{1} \u3068 \u2192p2\\vec{p}_{2} \u304c\u6c42\u307e\u308b\u3002AA\u22a4A A^{\\top} \u306f 2D \u306a\u3089 2 \u884c 2 \u5217\u306e\u884c\u5217\u30013D \u306a\u3089 3 \u884c 3 \u5217\u306e\u884c\u5217\u306a\u306e\u3067\u7c21\u5358\u306b\u89e3\u3051\u308b\u3002\n\n\u5b9f\u88c5\nGist (\u30c7\u30e2)\n\n\u53c2\u8003\u6587\u732e\n\n3\u6b21\u66f2\u7dda\n\n# \u5c0e\u51fa\n\n[`Feguson-Coons` \u66f2\u7dda](http://qiita.com/skitaoka/items/cbed9afc514b72e7c3f9) \u3067\u901f\u5ea6\u3092\u6307\u5b9a\u3059\u308b\u4ee3\u308f\u308a\u306b 2 \u3064\u306e\u5236\u5fa1\u70b9 $\\vec{p}\\_{1}$ \u3068 $\\vec{p}\\_{2}$ \u3092\u6307\u5b9a\u3059\u308b\u66f2\u7dda\u3067\n\n```math\n\\begin{align}\n                \\vec{p}_{1} &= \\vec{p}_\\mathrm{begin} + \\frac{1}{3} \\vec{v}_\\mathrm{begin} \\\\\n\\Leftrightarrow \\vec{v}_\\mathrm{begin} &= 3 (\\vec{p}_{1} - \\vec{p}_\\mathrm{begin}) \\\\\n                \\vec{p}_{2} &= \\vec{p}_\\mathrm{end} - \\frac{1}{3} \\vec{v}_\\mathrm{end} \\\\\n\\Leftrightarrow \\vec{v}_\\mathrm{end}  &= 3 (\\vec{p}_\\mathrm{end} - \\vec{p}_{2})\n\\end{align}\n```\n\n\u3068\u5b9a\u7fa9\u3055\u308c\u308b\u3002\u305d\u306e\u307e\u307e\u5f0f\u306b\u4ee3\u5165\u3057\u3066\u6574\u7406\u3059\u308b\u3068\n\n```math\n\\begin{align}\n\\vec{p}_\\mathrm{B}(t)\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       2 &  1 &  1 & -2 \\\\\n      -3 & -2 & -1 &  3 \\\\\n       0 &  1 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{v}_\\mathrm{begin} \\\\\n      \\vec{v}_\\mathrm{end} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       2 &  1 &  1 & -2 \\\\\n      -3 & -2 & -1 &  3 \\\\\n       0 &  1 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n       1 &  0 &  0 &  0 \\\\\n      -3 &  3 &  0 &  0 \\\\\n       0 &  0 & -3 &  3 \\\\\n       0 &  0 &  0 &  1 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_\\mathrm{1} \\\\\n      \\vec{p}_\\mathrm{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &= \\left[ \\begin{array}{cccc} t^{3} & t^{2} & t & 1 \\end{array} \\right]\n    \\left[ \\begin{array}{cccc}\n      -1 &  3 & -3 &  1 \\\\\n       3 & -6 &  3 &  0 \\\\\n      -3 &  3 &  0 &  0 \\\\\n       1 &  0 &  0 &  0 \\\\\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_{1} \\\\\n      \\vec{p}_{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n\n &= \\left[ \\begin{array}{cccc}\n         -t^{3} + 3 t^{2} - 3 t + 1  &\n      3 ( t^{3} - 2 t^{2} +   t    ) &\n      3 (-t^{3} +   t^{2}          ) &\n          t^{3}\n    \\end{array} \\right]\n    \\left[ \\begin{array}{c}\n      \\vec{p}_\\mathrm{begin} \\\\\n      \\vec{p}_{1} \\\\\n      \\vec{p}_{2} \\\\\n      \\vec{p}_\\mathrm{end}\n    \\end{array} \\right] \\\\\n &=         (1 - t)^{3} \\vec{p}_\\mathrm{begin}\n  + 3 t     (1 - t)^{2} \\vec{p}_{1}\n  + 3 t^{2} (1 - t)     \\vec{p}_{2}\n  +   t^{3}             \\vec{p}_\\mathrm{end}\n\\end{align}\n```\n\n\u3068\u306a\u308b\u3002$\\vec{p}\\_{0} = \\vec{p}\\_\\mathrm{begin}$ \u304a\u3088\u3073 $\\vec{p}\\_{3} = \\vec{p}\\_\\mathrm{end}$ \u3068\u304a\u304f\u3068\n\n```math\n\\vec{p}_\\mathrm{B}(t) = \\sum_{i=0}^{3} {}_{3}C_{i} t^{i} (1-t)^{3-i} \\vec{p}_{i}\n```\n\n\u3068\u306a\u308a\u3001\u6b21\u6570\u3092 3 \u304b\u3089 $n$ \u306b\u4e00\u822c\u5316\u3059\u308b\u3068\n\n```math\n\\vec{p}_\\mathrm{B}(t) = \\sum_{i=0}^{n} = {}_{n}C_{i} t^{i} (1-t)^{n-i} \\vec{p}_{i}\n```\n\n\u3068\u306a\u308b\u3002\u3053\u3053\u3067 $\\_{n} C\\_{m} = \\frac{n!}{m!(n-m)!}$ \u3067\u3042\u308b\u3002\n\n# \u70b9\u5217\u3078\u306e\u5f53\u3066\u306f\u3081\n\n[`Feguson-Coons` \u66f2\u7dda](http://qiita.com/skitaoka/items/cbed9afc514b72e7c3f9) \u3068\u540c\u69d8\u306e\u624b\u9806\u3067\u3067\u304d\u308b\u3002\n\n\u70b9\u5217 $(\\vec{x}\\_{i})\\_{i=1}^{n}$ \u304c\u5165\u529b\u3068\u3057\u3066\u4e0e\u3048\u3089\u308c\u3066\u3044\u308b\u3068\u304d\u4e09\u6b21 `B\u00e9zier` \u66f2\u7dda\u3092\u5f53\u3066\u306f\u3081\u308b\u3002\u305f\u3060\u3057\u3001\u66f2\u7dda\u4e0a\u306e\u70b9\u3092 $\\vec{p}\\_{B}(t)$ \u3068\u3057\u305f\u3068\u304d\u3001$\\vec{x}\\_{i} = \\vec{p}\\_\\mathrm{B}(\\frac{i-1}{n-1})$ \u3068\u306a\u308b\u3068\u3059\u308b\u3002\u3064\u307e\u308a\u59cb\u70b9\u3068\u7d42\u70b9\u3092\u3001\u305d\u308c\u305e\u308c $\\vec{p}\\_{B}(0) = \\vec{p}\\_{0} = \\vec{x}\\_{1}$ \u3068 $\\vec{p}\\_{B}(1) = \\vec{p}\\_{n} = \\vec{x}\\_{n}$ \u3068\u3059\u308b\u3002\n\n\u70b9\u5217\u304b\u3089 $\\vec{p}\\_{1}$ \u3068 $\\vec{p}_{2}$ \u3092\u6c42\u3081\u308b\u3002$t\\_{i} = \\frac{i-1}{n-1}$ \u3068\u3059\u308b\u3068\n\n```math\n\\begin{align}\n\\vec{x}_{i} &= \\vec{p}_\\mathrm{B}\\left(t_{i} \\right) \\\\\n\\Leftrightarrow \\vec{x}_{i}\n &=             (1 - t_{i})^{3} \\vec{x}_{1}\n  + 3 t_{i}     (1 - t_{i})^{2} \\vec{p}_{1}\n  + 3 t_{i}^{2} (1 - t_{i})     \\vec{p}_{2}\n  +   t_{i}^{3}                 \\vec{x}_{n} \\\\\n\n\\Leftrightarrow \\vec{x}_{i} - (1 - t_{i})^{3} \\vec{x}_{1} - t_{i}^{3} \\vec{x}_{n}\n &= 3 t_{i} (1 - t_{i})^{2} \\vec{p}_{1} + 3 t_{i}^{2} (1 - t_{i}) \\vec{p}_{2}\n\\end{align}\n```\n\n\u3053\u3053\u3067 $\\vec{b}\\_{i} = \\vec{x}\\_{i} - (1 - t\\_{i})^{3} \\vec{x}\\_{1} - t\\_{i}^{3} \\vec{x}\\_{n}$ \u3068\u304a\u304f\u3002\n\n```math\n\\begin{align}\n\\Leftrightarrow \\vec{b}_{i} &= t_{i} (1 - t_{i})^{2} \\vec{p}_{1} + t_{i}^{2} (1 - t_{i}) \\vec{p}_{2} \\\\\n\\Leftrightarrow \\vec{b}_{i}^{\\top}\n &= \\left[ \\begin{array}{cc}\n      3 t_{i} (1 - t_{i})^{2} &\n      3 t_{i}^{2} (1 - t_{i})\n    \\end{array} \\right]\n    \\left[ \\begin{array}{cc}\n      p_{1}^{x} & p_{1}^{y} \\\\\n      p_{2}^{x} & p_{2}^{y}\n    \\end{array} \\right]\n\\end{align}\n```\n\n\u3053\u3053\u3067\n\n```math\n\\begin{align}\n\\vec{a}_{i} &= \\left[ \\begin{array}{c}\n    3 t_{i} (1 - t_{i})^{2} \\\\\n    3 t_{i}^{2} (1 - t_{i})\n  \\end{array} \\right] \\\\\nX^{\\top} &= \\left[ \\begin{array}{cc}\n    p_{1}^{x} & p_{1}^{y} \\\\\n    p_{2}^{x} & p_{2}^{y}\n  \\end{array} \\right]\n\\Leftrightarrow X = \\left[ \\begin{array}{cc}\n    \\vec{p}_{1} & \\vec{p}_{2}\n  \\end{array} \\right] \\\\\n\\end{align}\n```\n\n\u3068\u304a\u304f\u3002\n\n```math\n\\begin{align}\n\\Leftrightarrow \\vec{b}_{i}^{\\top} &= \\vec{a}_{i}^{\\top} X^{\\top}\n\\end{align}\n```\n\n\u5217\u30d9\u30af\u30c8\u30eb $\\vec{a}\\_{i}$ \u3092 $n$ \u500b\u306a\u3089\u3079\u305f\u884c\u5217\u3092 $A$\u3001\u540c\u69d8\u306b $\\vec{b}\\_{i}$ \u3092 $n$ \u500b\u306a\u3089\u3079\u305f\u884c\u5217\u3092 $B$ \u3068\u3059\u308b\u3068\n\n```math\n\\begin{align}\n\\Leftrightarrow A^{\\top} X^{\\top} &= B^{\\top} \\\\\n\\Leftrightarrow X A &= B \\\\\n\\Leftrightarrow X A A^{\\top} &= B A^{\\top} \\\\\n\\Leftrightarrow X &= B A^{\\top} (A A^{\\top})^{-1} \\\\\n\\end{align}\n```\n\n\u3068\u3057\u3066 $\\vec{p}\\_{1}$ \u3068 $\\vec{p}\\_{2}$ \u304c\u6c42\u307e\u308b\u3002$A A^{\\top}$ \u306f 2D \u306a\u3089 2 \u884c 2 \u5217\u306e\u884c\u5217\u30013D \u306a\u3089 3 \u884c 3 \u5217\u306e\u884c\u5217\u306a\u306e\u3067\u7c21\u5358\u306b\u89e3\u3051\u308b\u3002\n\n## \u5b9f\u88c5\n\n[Gist](https://gist.github.com/skitaoka/27c898d31139d911debf6fdb58a471f5) ([\u30c7\u30e2](https://gist.githack.com/skitaoka/27c898d31139d911debf6fdb58a471f5/raw/97134a6578d93b64bb2297ec94a2ba21589ceb22/bezier.html))\n\n# \u53c2\u8003\u6587\u732e\n\n0. [3\u6b21\u66f2\u7dda](http://t-pot.com/program/2_3rdcurve/index.html)\n", "tags": ["\u6570\u5b66", "3DCG"]}