{"tags": ["laravel", "DataTables"], "context": "\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u306f\u3069\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u3067\u3082\u591a\u304b\u308c\u5c11\u306a\u304b\u308c\u4f7f\u308f\u308c\u308b\u3067\u3057\u3087\u3046\u3002\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u306e\u8ffd\u52a0\u30fb\u524a\u9664\u30fb\u66f4\u65b0\u306fAdmin\u5f79\u5272\u5411\u3051\u306e\u6a5f\u80fd\u3060\u304b\u3089\u4e00\u822c\u7684\u306a\u30e6\u30fc\u30b6\u30fc\u306f\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u306f\u305a\u304c\u306a\u3044\u3067\u3059\u304c\u4eba\u6570\u306f\u5c11\u306a\u3044\u305f\u3081\u91cd\u8981\u6a5f\u80fd\u3067\u306f\u306a\u3044\u3068\u601d\u3044\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u3092\u6271\u3046\u306e\u306f\u305f\u3060\uff11\u3064\u30c6\u30fc\u30d6\u30eb\u3067\u30ec\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u30fb\u524a\u9664\u30fb\u66f4\u65b0\u3068\u3044\u3046\u57fa\u672c\u7684\u306a\u64cd\u4f5c\u3067\u96e3\u3057\u304f\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u901a\u5e38\u306f\u30de\u30b9\u30bf\u30fc\u30c6\u30fc\u30d6\u30eb\u306e\u6570\u306f\u7d50\u69cb\u591a\u3044\u3060\u3057\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\u306f\u7d71\u4e00\u3067\u306f\u306a\u3044\u306e\u3067\u3082\u3057\u6570\u30fb\u69cb\u6210\u3092\u3088\u305d\u306b\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u7684\u306b\u7de8\u96c6\u3067\u304d\u308c\u3070\u30d9\u30b9\u30c8\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\u50d5\u306fLaravel\u3092\u52c9\u5f37\u3059\u308b\u521d\u5fc3\u8005\u3067\u4f53\u9a13\u3057\u306a\u304c\u3089\u4ee5\u964d\u306e\u3088\u3046\u306a\u30a4\u30e1\u30fc\u30b8\u306e\u901a\u308a\u306e\u6a5f\u80fd\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\uff1a\n- \u30de\u30b9\u30bf\u30fc\u30c6\u30fc\u30d6\u30eb\u306e\u540d\u524d\u3092SelectBox\u304b\u3089\u9078\u629e\u3059\u308c\u3070\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\u3092\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u53d6\u5f97\u3057\u3066Datatable\u3092\u69cb\u7bc9\u3059\u308b\n- Editor DataTable\u3092\u7528\u3044\u3066\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u81ea\u4f53\u3092\u7de8\u96c6\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\nDatatable\u306e\u8ffd\u52a0\u305f\u306f\u5225\u6295\u7a3f\u3067\u8ff0\u3079\u307e\u3057\u305f\u306e\u3067\u4eca\u56de\u306fEditor\u3068\u3044\u3046Datatable\u306e\u91cd\u8981\u306a\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u91cd\u3093\u3058\u3066\u8a71\u3055\u305b\u3066\u3082\u3089\u304a\u3046\u3068\u601d\u3044\u307e\u3059\n\n\n\u958b\u767a\u624b\u9806\n\nDatatables\n\u81ea\u3089\u30af\u30e9\u30a4\u30a8\u30f3\u30c8\u3084\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306e\u3092\u5b9f\u88c5\u3059\u308b\u306e\u306f\u5148\u65e5\u306e\u6295\u7a3f\u3067\u8aac\u660e\u3057\u307e\u3057\u305f\u3051\u3069\u672c\u6295\u7a3f\u306f\u3082\u3063\u3068\u7c21\u5358\u306a\u65b9\u3092\u7d39\u4ecb\u81f4\u3057\u307e\u3059\u3002Yajra\u3055\u3093\u3068\u3044\u3046\u4eba\u306fDatatable\u306b\u3064\u3066\u306e\u3088\u304f\u64cd\u4f5c\u3092\u30d1\u30c3\u30b1\u30fc\u30b8\u3057\u3066\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u5316\u306b\u3057\u3066\u304f\u308c\u3066\u3082\u3063\u3068\u7c21\u5358\u306a\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\u8a73\u7d30\u306f\u4ee5\u4e0b\u306e\u30ea\u30f3\u30af\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n-> Yajra box\n\u4eca\u56de\u306e\u4f8b\u4f5c\u308c\u308b\u305f\u3081Yajra\u3055\u3093\u304c\u4f5c\u3063\u3066\u304f\u308c\u305f\u521d\u5fc3\u8005\u5411\u3051\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306b\u5f93\u3063\u3066\u5b9f\u65bd\u3057\u3066\u3044\u304f\u3002\n-> Yajra Box Tutorial for Starter \n\nDataTables Editor\n\u4ee5\u4e0a\u3082\u8a00\u3044\u307e\u3057\u305f\u3051\u3069Editor\u306fDatatables\u306e\u4e00\u3064\u306e\u9762\u767d\u3044\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002Plugin\u306a\u306e\u3067DataTable\u306b\u542b\u3081\u3089\u308c\u308b\u3068\u306f\u9650\u308a\u307e\u305b\u3093\u3002\u300cpublic/plugins/datatables\u300d\u306beditor\u304c\u5b58\u5728\u3057\u306a\u3044\u304b\u306e\u78ba\u8a8d\u306f\u5fc5\u8981\u3067\u3082\u3057\u306a\u304b\u3063\u305f\u3089\u4ee5\u4e0b\u306e\u30ea\u30f3\u30af\u3092\u30a2\u30af\u30bb\u30b9\u3057\u3066\u8ffd\u52a0\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u306f\u5fc5\u8981\u3067\u3059\u3002PHP/.Net/JS\u306e\u305d\u308c\u305e\u308c\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u304c\u3042\u308a\u307e\u3059\u304c\u4eca\u56de\u306fLaravel\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u4f7f\u7528\u3059\u308b\u3064\u3082\u308a\u3067\u3059\u306e\u3067PHP\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n->Datatables Editor\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fDatatables\u3068Editor\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u7528\u3067\u304d\u308b\u305f\u3081\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\n<link rel=\"stylesheet\" type=\"text/css\" href=\"{{ asset('/plugins/datatables/DataTables-1.10.12/css/jquery.dataTables.css')}}\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"{{ asset('/plugins/datatables/Editor-PHP-1.5.6/css/editor.dataTables.css')}}\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"{{ asset('/plugins/datatables/Select-1.2.0/css/select.dataTables.min.css')}}\">\n\n<script type=\"text/javascript\" src=\"{{ asset('/plugins/datatables/DataTables-1.10.12/js/jquery.dataTables.min.js')}}\"></script>\n<script type=\"text/javascript\" src=\"{{ asset('/plugins/datatables/Editor-PHP-1.5.6/js/dataTables.editor.js')}}\"></script>\n<script type=\"text/javascript\" src=\"{{ asset('/plugins/datatables/Select-1.2.0/js/dataTables.select.js')}}\"></script>\n\n\n\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u7de8\u96c6\u753b\u9762\n\u307e\u305a\u306f\u4ee5\u4e0a\u306e\u30a4\u30e1\u30fc\u30b8\u3088\u3046\u306a\u753b\u9762\u3092blade\u3067\u4f5c\u308a\u307e\u3059\u3002\n\nsettings_master.php\n@section('main-content')\n\n<div class=\"box box-info\" id=\"main-box\" name=\"main-box\">\n    <div class=\"box-header with-border\">\n        <h3 class=\"box-title\"><i class=\"fa fa-cog\"></i>{{trans('pg_system_master.box.lblTitle')}}</h3>\n        <div class=\"box-tools pull-right\">\n        </div>\n    </div>\n    <div class=\"box-body\">\n        <div class=\"row\">\n            <div class=\"col-md-6\">\n                <div class=\"form-group\">\n                      <label for=\"optMasterTable\" class=\"col-sm-3 control-label\">Master Table</label>\n                      <div class=\"col-sm-9\">\n                           <select class=\"form-control select2\" id = \"optMasterTable\" name =\"optMasterTable\" style=\"width: 100%;\">\n                                @foreach($lstMasterTableNames as $mstTableName)\n                                    <option value=\"{{$mstTableName->name}}\">{{$mstTableName->name}}</option>\n                                @endforeach\n                           </select>\n                      </div>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"table-responsive\" name=\"tableDiv\" id=\"tableDiv\">\n            <table class=\"table table-striped table-bordered table-hover display\" id=\"master-table\" name =\"master-table\">\n                <thead>\n\n                </thead>\n            </table>\n        </div>  \n    </div>\n    <div class=\"box-footer clearfix\">\n        <a href=\"#\" id='btnCreate' name='btnCreate'\n            class=\"btn btn-sm btn-success btn-flat pull-right\">{{trans('pg_system_master.box.btnCreate')}}</a> \n    </div>\n</div>\n\n@endsection \n\n\n\u898b\u3089\u308c\u305f\u901a\u308a\u306b\u753b\u9762\u306e\u4e0a\u3067\u7a7a\u767d\u306etable\u3068SelectBox\u306f\u5b9a\u7fa9\u3057\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u30fc\u3067\u958b\u3044\u3066\u898b\u3093\u305f\u3089\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u304f\u308b\u306f\u305a\u3002SelectBox\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u306f\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u6301\u3063\u3066\u304f\u308b\u306e\u3067\u30b5\u30fc\u30d0\u30fc\u306e\u51e6\u7406\u306f\u5b9f\u88c5\u3055\u308c\u3066\u5c45\u306a\u3044\u9650\u308a\u52d5\u3051\u306a\u3044\u306e\u3092option\u306e\u3068\u3053\u308d\u898b\u3066\u898b\u305f\u3089\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u3067\u306f\u30b5\u30fc\u30d0\u30fc\u306e\u51e6\u7406\u3092\u5f04\u3063\u3066\u898b\u307e\u3057\u3087\u3046\u3002\n\nroutes.php\nRoute::get('settings/master', ['as' => 'systems.settings.master', 'uses' => 'MasterDataController@index']);\n\n\n\nMasterDataController.php\npublic function index(Request $request) {\n    $lstMasterTableNames = DB::select ( 'SELECT TABLE_NAME as name FROM INFORMATION_SCHEMA.TABLES \n                                           WHERE \n                                                TABLE_SCHEMA=\"MySchema\" \n                                                AND (TABLE_NAME LIKE \"mst%\")\n                                                AND TABLE_TYPE=\"BASE TABLE\"\n                                           ORDER BY TABLE_NAME ASC\n                                         ' );\n        return View::make ( 'settings_master' )->with ( 'lstMasterTableNames', $lstMasterTableNames );\n}\n\n\n\n\u5206\u5225\u3057\u3084\u3059\u3044\u305f\u3081\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u306e\u30c6\u30fc\u30d6\u30eb\u540d\u306f\u300cmst\u300d\u3092\u982d\u306b\u3064\u3051\u3066\u547d\u540d\u898f\u7d04\u306b\u3059\u308b\u3002\nSchema\u540d\u306f\u4eee\u306b\u300cMySchema\u300d\u3068\u3057\u3066\u3044\u308b\u304c\u5b9f\u88c5\u3059\u308b\u3068\u304d\u306b\u81ea\u5206\u304c\u4f7f\u3063\u3066\u3044\u308bSchema\u540d\u3092\u5165\u308c\u66ff\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\u4f7f\u3063\u3066\u3044\u305fSQL\u306f\u305f\u3060Schema\u30c6\u30fc\u30d6\u30eb\u3092\u898b\u3066\u53d6\u5f97\u3057\u305f\u3044\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u53d6\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u3053\u3053\u307e\u3067\u884c\u3051\u3070\u30d6\u30e9\u30a6\u30b6\u30fc\u3067\u958b\u3044\u305f\u3089SelectBox\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u306f\u30de\u30b9\u30bf\u30fc\u30c6\u30fc\u30d6\u30eb\u540d\u304c\u5165\u308c\u3089\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\u9078\u629e\u3057\u3066\u898b\u305f\u3089\u4e0b\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u8868\u793a\u306f\u4f55\u3082\u5909\u308f\u3089\u306a\u3044\u3067\u8584\u3063\u307a\u3089\u306a\u301c\u3068\u601d\u3063\u3066\u3044\u308b\u4eba\u306f\u5c45\u306a\u3044\u306e\u3067\u3059\u304b\uff1f\uff08\u7b11\n\n\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u3092\u7de8\u96c6\u3059\u308b\u6a5f\u80fd\n\u9078\u629e\u3057\u305f\u30c6\u30fc\u30d6\u30eb\u540d\u306e\u5185\u5bb9\u306f\u8868\u793a\u3055\u308c\u308b\u305f\u3081\uff12\u3064\u306e\u4f5c\u696d\u306f\u5fc5\u8981\n- \u2460\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5143\u306b\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\uff08Field\u540d\uff09\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066Datatble\u3092\u69cb\u7bc9\u3059\u308b\u3053\u3068\n- \u2461\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5143\u306b\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u3066Datatable\u304c\u308f\u304b\u3089\u308c\u308b\u5f62\u306b\u5909\u63db\u3057\u3066\u30af\u30e9\u30a4\u30a8\u30f3\u30c8\u306b\u8fd4\u3059\u3002\n\u2460\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\u60c5\u5831\u3092\u53d6\u5f97\n\nMasterDataController.php\npublic function schema(Request $request) {\n        $tableName = strtoupper ( $request->input ( 'table_name' ) );\n        $className = Config::get ( 'constants.MASTER_TABLES.' . $tableName . '.CLASS' );\n        Log::debug ( $className );\n        try {\n            $model = new $className ();\n            $fillables = $model->getFillable ();\n            $fields = array ();\n            foreach ( $fillables as $fillable ) {\n                $field = array ();\n                $field ['label'] = $model->getColumnLabelByName ( $fillable );\n                $field ['name'] = $fillable;\n                $fields [] = $field;\n            }\n            $ret = json_encode ( [ \n                    'success' => true,\n                    'fields'  => $fields,\n                    'columns' => $model->getColumnsSetting () \n            ] );\n            return $ret;\n        } catch ( Exception $e ) {\n            return json_encode ( [ \n                    'success' => false,\n                    'message' => $e->getMessage () \n            ] );\n        }\n    }\n\n\n\nconfig\u00a5constants.php\n'MASTER_TABLES'=>\n        [\n\n            'MSTBRANCHES'=>[\n                    'NAME'  => 'Branches',\n                    'CLASS' => 'App\\\\Models\\\\Branch'\n            ],\n            'MSTCHANNELS'=>[\n                    'NAME'  => 'Branches',\n                    'CLASS' => 'App\\\\Models\\\\Channel'\n            ],\n            'MSTCOMPANIES'=>[\n                        'NAME'  => 'Companies',\n                        'CLASS' => 'App\\\\Models\\\\Company'\n            ],\n            'MSTDEPARTMENTS'=>[\n                        'NAME'  => 'Departments',\n                        'CLASS' => 'App\\\\Models\\\\Department'\n            ],\n        ]\n\n\n\u4f55\u305d\u308c!!!\u3061\u3087\u3063\u3068\u8aac\u660e\u3055\u305b\u3066\u304f\u3060\u3055\u3044\n\n\u6301\u3063\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5143\u306b\u69cb\u6210\u60c5\u5831\u3092\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306bSchema\u60c5\u5831\u306e\u3088\u3046\u306bRawQuery\u4f7f\u3063\u3066\u53d6\u308c\u308b\u306f\u305a\u304c\u305b\u3063\u304b\u304f\u30e2\u30c7\u30eb\u3092\u3064\u304f\u3063\u305f\u306e\u306b\u4f7f\u308f\u306a\u3044\u306e\u306f\u52ff\u4f53\u7121\u3044\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u305d\u308c\u306b\u7de8\u96c6\u53ef\u80fd\u306e\u5185\u5bb9\u3060\u3051\u3092\u7de8\u96c6\u3055\u305b\u308b\u306e\u3067\u3042\u308b\u65b9\u6cd5\u3067\u30c6\u30fc\u30d6\u30eb\u540d\u304b\u3089\u8a72\u5f53Model\u306b\u5909\u63db\u3067\u304d\u308c\u3070fillable\u3084guarded\u5c5e\u6027\u3092\u898b\u308b\u3060\u3051\u3067\u3044\u3044\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\u305d\u3046\u3044\u3046\u308f\u3051\u3067\u3061\u3087\u3063\u3068\u920d\u3044\u65b9\u6cd5\u304b\u3082\u77e5\u308a\u307e\u305b\u3093\u304cconfig\u3067\u30c6\u30fc\u30d6\u30eb\u540d\u301c\u30e2\u30c7\u30fc\u30eb\u30af\u30e9\u30b9\u540d\u306e\u95a2\u4fc2\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\nfield\u540d\u306f\u305d\u306e\u307e\u307e\u753b\u9762\u3067\u8868\u793a\u3059\u308b\u306e\u306f\u826f\u304f\u306a\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u306e\u3067Field\u540d\u304b\u3089\u8868\u793a\u7528\u306e\u30c6\u30ad\u30b9\u30c8\u306b\u5909\u63db\u3059\u308b\u95a2\u6570\u3092\u6e96\u5099\u3057\u3066\u304a\u304f\uff08getColumnLabelByName)\n\u30ad\u30fc\u70b9\u306f\u300c$model = new $className ();\u300d\u3067\u3059\u3002PHP\u3067\u306f\u305d\u3046\u3044\u3046\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u308a\u65b9\u306f\u53ef\u80fd\u3067\u3059\u306e\u3067\u3059\u3054\u304f\u4fbf\u5229\u3067\u3059\u3002\n\nschema()\u306e\u8fd4\u5374\u30c7\u30fc\u30bf\u306fDatatable\u306b\u3082Editor\u30d7\u30e9\u30b0\u30a4\u30f3\u306b\u3082\u4f7f\u308f\u308c\u307e\u3059\u3002\u3068\u3089\u3048\u305a\n\n<script type=\"text/javascript\">\n\nvar masterTable;\nvar masterTableEditor;\n\n$(document).ready(function(){\n $.ajaxSetup({\n        headers: {\n            'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n        }\n     });\n     var tableName =  $('#optMasterTable').select2('val');\n     $.ajax({\n            type: 'GET',\n            url:  '{!! route(\"api.master.schema\") !!}' + '?table_name=' + tableName,\n            beforeSend : function(xhr, settings){\n              $('#main-box').append('<div class=\"overlay\" id =\"spin\" name = \"spin\"><i class=\"fa fa-refresh fa-spin\"></i></div>');              \n            }, \n            complete: function(xhr, textStatus){\n              $('#spin').remove();\n            },\n            success: function(d) {\n                var result = jQuery.parseJSON(d);\n\n                if(masterTable){\n                    masterTable.destroy();\n                    $('#tableDiv').empty(); // empty in case the columns change\n\n                    /*\n                    *Create <thead></thead>\n                    */\n                    var fields = result.fields;\n                    var columns  = result.columns;\n\n                    var htmlTable = '<table class=\"table table-striped table-bordered table-hover display\" id=\"master-table\" name =\"master-table\">';\n                    htmlTable += '<thead>';\n                    htmlTable += '<tr>';\n                    columns.forEach(function(column){\n                        htmlTable += '<th>' + column.label + '</th>';\n                    });\n                    htmlTable += '</tr>';\n                    htmlTable += '</thead>';\n                    htmlTable += '</table>';\n\n                    $('#tableDiv').append(htmlTable);\n\n                }\n                masterTable = $('#master-table').DataTable({\n                    lengthChange: false,\n                    responsive: true,\n                    processing: true,\n                    serverSide: true,\n                    ajax: {\n                        url: '{!! route(\"api.master.datatables\") !!}' + '?table_name=' + tableName,\n                        method : 'GET'\n                    },    \n                    dom: 'Bfrtip',\n                    columns: result.columns,\n                    select:  true,\n                    aoColumnDefs: [\n                                    { 'bSortable': false, 'aTargets': [0, 1 , 4, 5] }   ,\n                                    { 'className': \"dt-center\", \"aTargets\": [0,1,2,3,4,5,6] },\n                    ],\n                    initComplete: function(settings, json) {\n                        $searchBox = $(\".dataTables_filter input[type='search']\");\n                        $searchBox.addClass('form-control input-sm');\n                        $searchBox.attr(\"placeholder\", \"Type here to search\");\n                        $('.dataTables_filter label').get(0).firstChild.nodeValue = \"\";\n                        $('.dataTables_filter').addClass('col-sm-6');\n                    },\n                });\n                masterTableEditor = new $.fn.dataTable.Editor( {\n                    ajax: {\n                        url: '{{route(\"api.master.crud\")}}',\n                        data: function (form) {\n                         form.table_name = $('#optMasterTable').select2('val');\n                         return form;\n                        },\n                        method: 'POST',\n                    },\n                    table: '#master-table',\n                    idSrc: \"id\",\n                    fields: result.fields,\n                } );\n                $('#master-table').on( 'click', 'tbody td.editable', function (e) {\n                    masterTableEditor.inline( this );\n                } );\n\n                $('#master-table').on( 'click', 'tbody a.remove', function (e) {\n                    masterTableEditor\n                        .title( '{{trans(\"pg_system_master.dialog.delete.title\")}}')\n                        .message( '{{trans(\"pg_system_master.dialog.delete.message\")}}' )\n                        .buttons( { \"label\": \"{{trans('pg_system_master.dialog.delete.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n                        .remove( $(this).closest('tr') );\n                } );\n\n                $('#master-table').on( 'click', 'tbody a.edit', function (e) {\n                    masterTableEditor\n                        .title( \"{{trans('pg_system_master.dialog.edit.title')}}\" )\n                        .buttons( { \"label\": \"{{trans('pg_system_master.dialog.edit.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n                        .edit($(this).closest('tr'));\n                } );\n            },\n            error : function(data){\n                $('#spin').remove();\n            }\n        });\n\n        $('#optMasterTable').on('change', function (e) {\n             var tableName = $('#optMasterTable').select2('val');\n\n             $.ajax({\n                    type: 'GET',\n                    url:  '{!! route(\"api.master.schema\") !!}' + '?table_name=' + tableName,\n                    beforeSend : function(xhr, settings){\n                          $('#main-box').append('<div class=\"overlay\" id =\"spin\" name = \"spin\"><i class=\"fa fa-refresh fa-spin\"></i></div>');              \n                    }, \n                    complete: function(xhr, textStatus){\n                          $('#spin').remove();\n                    },\n                    success: function(data) {\n                        var result = jQuery.parseJSON(data);\n\n                        /*\n                        * Clear table\n                        */\n                        masterTable.destroy();\n                        $('#tableDiv').empty(); // empty in case the columns change\n                        /*\n                        *Create <thead></thead>\n                        */\n                        var fields = result.fields;\n                        var columns  = result.columns;\n\n                        var htmlTable = '<table class=\"table table-striped table-bordered table-hover display\" id=\"master-table\" name =\"master-table\">';\n                        htmlTable += '<thead>';\n                        htmlTable += '<tr>';\n                        columns.forEach(function(column){\n                            htmlTable += '<th>' + column.label + '</th>';\n                        });\n                        htmlTable += '</tr>';\n                        htmlTable += '</thead>';\n                        htmlTable += '</table>';\n\n                        $('#tableDiv').append(htmlTable);\n\n                        masterTable = $('#master-table').DataTable({\n                            lengthChange: false,\n                            responsive: true,\n                            processing: true,\n                            serverSide: true,\n                            ajax: {\n                                url: '{!! route(\"api.master.datatables\") !!}' + '?table_name=' + tableName,\n                                method : 'GET'\n                            },    \n                            dom: 'Bfrtip',\n                            columns: columns,\n                            select:  true,\n                            aoColumnDefs: [\n                                            { 'bSortable': false, 'aTargets': [0, 1 , 4, 5] }   ,\n                                            { 'className': \"dt-center\", \"aTargets\": [0,1,2,3,4,5,6] },\n                            ],\n                            initComplete: function(settings, json) {\n                                $searchBox = $(\".dataTables_filter input[type='search']\");\n                                $searchBox.addClass('form-control input-sm');\n                                $searchBox.attr(\"placeholder\", \"Type here to search\");\n                                $('.dataTables_filter label').get(0).firstChild.nodeValue = \"\";\n                                $('.dataTables_filter').addClass('col-sm-6');\n                            },\n                        });\n                        /*\n                        *  Update the tables editor\n                        */\n                        masterTableEditor.clear();\n                        masterTableEditor.add(fields);\n                        $('#master-table').on( 'click', 'tbody td.editable', function (e) {\n                            masterTableEditor.inline( this );\n                        } );\n                        $('#master-table').on( 'click', 'tbody a.remove', function (e) {\n                            masterTableEditor\n                                .title( '{{trans(\"pg_system_master.dialog.delete.title\")}}')\n                                .message( '{{trans(\"pg_system_master.dialog.delete.message\")}}' )\n                                .buttons( { \"label\": \"{{trans('pg_system_master.dialog.delete.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n                                .remove( $(this).closest('tr') );\n                        } );\n\n                        $('#master-table').on( 'click', 'tbody a.edit', function (e) {\n                            masterTableEditor\n                                .title( \"{{trans('pg_system_master.dialog.edit.title')}}\" )\n                                .buttons( { \"label\": \"{{trans('pg_system_master.dialog.edit.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n                                .edit($(this).closest('tr'));\n                        } );\n                        /*\n                        fields.forEach(function(field){\n                            console.log(field);\n                            tableEditor.add(field);\n                        });\n                        */\n\n                    },\n                    error : function(data){\n                        $('#spin').remove();\n                    }\n                });\n\n         });\n\n        $('#btnCreate').on( 'click', function () {\n            masterTableEditor\n                .title( \"{{trans('pg_system_master.dialog.create.title')}}\" )\n                .buttons( { \"label\": \"{{trans('pg_system_master.dialog.create.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n                .create();\n        } );\n\n}); \n</script>\n\n\nroutes.php\n\n    Route::get('master/datatables', ['as' => 'api.master.datatables', 'uses' => 'Systems\\MasterDataController@datatables']);\n\n    Route::post('master/crud', ['as' => 'api.master.crud', 'uses' => 'Systems\\MasterDataController@postProcess']);\n\n    Route::get('master/schema', ['as' => 'api.master.schema', 'uses' => 'Systems\\MasterDataController@schema']);\n\n\n\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8\n- \u521d\u671f\u5316\u3055\u308c\u305fDatatable\u3092\u30b5\u30a4\u30c9\u521d\u671f\u5316\u3059\u308b\u306e\u306f\u3060\u3081\u3067\u3059\u306e\u3067\u9078\u629e\u80a2\u3092\u5909\u3048\u308b\u3068destroy()\u3057\u3066\u5b8c\u5168\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u76f4\u3055\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\nmasterTable.destroy();\n                        $('#tableDiv').empty(); // empty in case the columns change\n\n                        var fields = result.fields;\n                        var columns  = result.columns;\n\n                        var htmlTable = '<table class=\"table table-striped table-bordered table-hover display\" id=\"master-table\" name =\"master-table\">';\n                        htmlTable += '<thead>';\n                        htmlTable += '<tr>';\n                        columns.forEach(function(column){\n                            htmlTable += '<th>' + column.label + '</th>';\n                        });\n                        htmlTable += '</tr>';\n                        htmlTable += '</thead>';\n                        htmlTable += '</table>';\n\n\nEditor\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u521d\u671f\u5316. \u7de8\u96c6\u3059\u308b\u3068\u304d\u30c6\u30fc\u30d6\u30eb\u540d\u306f\u5fc5\u8981\u3067\u3059\u306e\u3067\u9001\u4fe1\u3059\u308b\u30c7\u30fc\u30bf\u306b\u52a0\u3048\u3066\u9078\u629e\u3057\u305f\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5165\u308c\u3066\u304a\u304f\u3002\n\n\nmasterTableEditor = new $.fn.dataTable.Editor( {\n                    ajax: {\n                        url: '{{route(\"api.master.crud\")}}',\n                        data: function (form) {\n                         form.table_name = $('#optMasterTable').select2('val');\n                         return form;\n                        },\n                        method: 'POST',\n                    },\n                    table: '#master-table',\n                    idSrc: \"id\",\n                    fields: result.fields,\n                } );\n\n\nDatatable\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u63d0\u4f9b\u3059\u308b\u30ed\u30b8\u30c3\u30af\u306f\u4ee5\u4e0b\u3067\u3059\u3002\u898b\u305f\u901a\u308a\u3001Yajra\u306b\u63d0\u4f9b\u3057\u3066\u3082\u3089\u3063\u305f\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u3092\u4f7f\u3048\u3070\u30b3\u30fc\u30c9\u306f\u77ed\u7e2e\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\nMasterDataController.php\nuse Yajra\\Datatables\\Datatables;\n\npublic function datatables(Request $request) {\n        $tableName = strtoupper ( $request->input ( 'table_name' ) );\n\n        $className = Config::get ( 'constants.MASTER_TABLES.' . $tableName . '.CLASS' );\n\n        $model = new $className ();\n\n        $columnList = $model->getColumnList ();\n        $objs = $className::select ( $columnList );\n        if (in_array ( 'ordering', $columnList )) {\n            $objs = $objs->orderBy ( 'ordering' );\n        }\n\n        return Datatables::of ( $objs )->addColumn ( 'action', function ($obj) {\n            $html = '<div class=\"tools\"><a href=\"#\" class=\"edit btn btn-xs btn-primary\"><i class=\"fa fa-edit\"></i></a>';\n            $html .= '&nbsp<a href=\"#\" class=\"remove btn btn-xs btn-danger\"><i class=\"fa fa-trash-o\"></i></a></div>';\n            return $html;\n        } )->make ( true );\n    }\n\n\n\n\u65b0\u3057\u3044\u30e2\u30c7\u30fc\u30eb\n\u4ee5\u4e0a\u306e\u8aac\u660e\u306e\u901a\u308a\u306bLaravel\u306b\u63d0\u4f9b\u3057\u3066\u3082\u3089\u3063\u3066\u3044\u308b\u30e2\u30c7\u30eb\u306b\u52a0\u3048\u3066Datatable\u304c\u5206\u304b\u308c\u308b\u305f\u3081\u305d\u306e\u30e2\u30c7\u30eb\u3092\u7d99\u627f\u3057\u3066\u3044\u304f\u3064\u304b\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\nGlobalModel.php\n\nuse Illuminate\\Database\\Eloquent\\Model;\n\nuse DB;\n\nclass GlobalModel extends Model\n{\n\n        //\u753b\u9762\u3067\u51fa\u3066\u304f\u308b\u30c6\u30ad\u30b9\u30c8\n    protected $labels;\n\n        //order\u3067\u304d\u308b\u9805\u76ee\u540d\n    protected $orderable;\n\n\u3000\u3000\u3000\u3000//\u691c\u7d22\u3067\u304d\u308b\u9805\u76ee\u540d\n    protected $searchable;\n    //\u30c7\u30fc\u30bf\u30c1\u30a7\u30c3\u30af\u30eb\u30fc\u30eb\n    protected $rules;\n    //Customize\u30e1\u30c3\u30bb\u30fc\u30b8\n    protected $messages;\n\n    public function getColumnLabelByName($column){\n        return $this->labels[$column];\n    }\n    public function getColumnList(){\n        $columns = DB::select('SELECT column_name AS name FROM INFORMATION_SCHEMA.COLUMNS\n                                           WHERE TABLE_NAME = :table_name', ['table_name'=> $this->getTable()]);\n        $columnNames = array();\n        foreach($columns as $column){\n            if (in_array($column->name, $this->hidden)){\n                continue;\n            }\n            $columnNames[]= $column->name;\n        }    \n        return $columnNames;\n    }\n    public function getColumnsSetting(){\n\n        $columnSettings = array();\n        /*\n         * Get all the columns\n         */     \n        $columns = DB::select('SELECT column_name AS name FROM INFORMATION_SCHEMA.COLUMNS\n                                           WHERE TABLE_NAME = :table_name', ['table_name'=> $this->getTable()]);\n        foreach($columns as $column){\n            if (in_array($column->name, $this->hidden)){\n                continue;\n            }\n            $setting = array();\n            $setting['data'] =  $column->name;\n            $setting['name'] =  $column->name;\n            $setting['label'] =  $this->getColumnLabelByName($column->name);\n            $setting['className'] = 'dt-center';\n            if (in_array($column->name, $this->fillable) || !in_array($column->name, $this->guarded)){\n                $setting['className'] .= ' editable';\n            }\n            if (in_array($column->name, $this->orderable)){\n                $setting['orderable']= true;\n            }else{\n                $setting['orderable']= false;\n            }\n            if (in_array($column->name, $this->searchable)){\n                $setting['searchable']= true;\n            }else{\n                $setting['searchable']= false;\n            }\n            $columnSettings[] = $setting;\n        }\n        $columnSettings[] = array( 'data'=> 'action', 'name'=> 'action', 'label'=>'Action', 'orderable'=> false, 'searchable'=> false);\n        return $columnSettings;\n    }\n\n    public function getValidationRules($action)\n    {\n        if($this->rules){\n            return $this->rules[$action];\n        }else\n            return [];\n    }\n\n}\n\n\n\u305d\u308c\u3067config\u3067\u6307\u5b9a\u3057\u305f\u30e2\u30c7\u30eb\u306e\u306f\u4ee5\u4e0a\u306e\u3082\u306e\u3092\u7d99\u627f\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\n\nBranch.php\n\nuse App\\Models\\GlobalModel;\n\nclass Branch extends GlobalModel\n{\n    protected $table   = 'mstBranches';\n\n    protected $primaryKey = 'id';\n\n    protected $guarded  = ['id','created_at','updated_at'];\n\n    protected $fillable = ['name','display','ordering'];\n\n    protected $labels = [\n            'id' => 'ID',\n            'name'=> 'Property',\n            'display' => 'CSS Display',\n            'ordering'=> 'Display Order',\n            'created_at' => 'Created At',\n            'updated_at' => 'Updated At',\n    ];\n\n    protected $orderable  = ['name', 'ordering', 'created_at','updated_at'];\n\n    protected $searchable = ['name'];\n\n}\n\n\n\n\nInline Editor\u306e\u51e6\u7406\ncrud\u3068\u3044\u3046\u30eb\u30fc\u30c8\u306fEditor\u3067\u30c7\u30fc\u30bf\u7de8\u96c6\u3055\u308c\u305f\u3068\u304d\u306b\u547c\u3073\u51fa\u3055\u308c\u307e\u3059\u3002Editor\u30d7\u30e9\u30b0\u30a4\u30f3\u81ea\u4f53\u306f\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u30af\u30e9\u30b9\u6301\u3063\u3066\u3044\u307e\u3059\u304cLaravel\u306b\u30a4\u30f3\u30c6\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u306e\u306f\u7d50\u69cb\u624b\u9593\u304b\u304b\u308a\u307e\u3059\u306e\u3067\u4eca\u56de\u50d5\u306f\u81ea\u3089\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3092\u7c21\u5358\u306b\u4f5c\u308a\u307e\u3057\u305f\u3002\u8aac\u660e\u3057\u305f\u3089\u9577\u304f\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u8208\u5473\u3092\u6301\u3063\u3066\u3044\u308b\u65b9\u306f\u307e\u305a\u8a66\u3057\u3066\u898b\u3066\u304f\u308c\u3066\u3001\u4e0d\u660e\u306a\u3068\u3053\u308d\u304c\u3042\u308c\u3070\u30b3\u30e1\u30f3\u30c8\u3067\u76f8\u8ac7\u3057\u307e\u3057\u3087\u3046\n\nprivate function process(Request $request) {\n        Log::info ( 'Begin private function process' );\n\n        Log::debug ( $request );\n\n        $action = $request->input ( 'action' );\n\n        $tableName = strtoupper ( $request->input ( 'table_name' ) );\n\n        $model = Config::get ( 'constants.MASTER_TABLES.' . $tableName . '.CLASS' );\n\n        $data = $request->input ( 'data' );\n\n        $modelType = gettype ( $model );\n        if ($modelType != 'string') {\n            return json_encode ( [ \n                    'error' => 'System Error: Model name is not string, ' . $modelType . ' given.' \n            ] );\n        } else {\n            if ($action == 'create') {\n\n                $ids = array_keys($data);\n\n                $row = $data[$ids[0]];\n\n                $instance = new $model();\n\n                $validator = Validator::make($row, $instance->getValidationRules($action));\n\n\n                if ($validator->fails()) {\n                    $msgError = array();\n                    $messages = $validator->errors();\n                    $msgKeys = $messages->keys();\n                    foreach ($msgKeys as $msgKey) {\n                        $msgError[] =\n                        array(\n                                'name' => $msgKey,\n                                'status' => $messages->get($msgKey)\n                        );\n                    }\n                    return  json_encode([ 'fieldErrors' => $msgError ]);\n                } else {\n                    try {\n                        $record = $model::firstOrNew ( $row );\n\n                        $record->save ();\n\n                        $resSuccessful = [ ];\n\n                        $resSuccessful [] = $record->toArray ();\n\n                        return json_encode ( [ \n                                'data' => $resSuccessful \n                        ] );\n                    } catch ( Exception $e ) {\n                        Log::debug ( $e->getMessage () );\n                        return json_encode ( [ \n                                'error' => $e->getMessage () \n                        ] );\n                    }\n                }\n            } else if ($action == 'edit') {\n\n                Log::info ( 'Action = edit' );\n\n                $keys = array_keys($data);\n\n                $instance = new $model();\n\n                foreach($keys as $key){\n\n                    $row = $data[$key];\n\n                    $row['id'] = $key;\n\n                    $validator = Validator::make($row, $instance->getValidationRules($action));\n\n                    if ($validator->fails()) {\n                        $msgError = array();\n                        $messages = $validator->errors();\n                        $msgKeys = $messages->keys();\n                        foreach ($msgKeys as $msgKey) {\n                            $msgError[] =\n                            array(\n                                    'name' => $msgKey,\n                                    'status' => $messages->get($msgKey)\n                            );\n                        }\n                        Log::debug($msgError);\n                        return  json_encode([ 'fieldErrors' => $msgError ]);\n                    }\n                }\n\n                try {\n\n                    $resSuccessful = array ();\n                    foreach ( $data as $id => $content ) {\n                        $obj = $model::find ( $id );\n                        $obj->update ( $content );\n                        $resSuccessful [] = $obj->toArray ();\n                    }\n\n                    return json_encode ( array (\n                            'data' => $resSuccessful \n                    ) );\n                } catch ( Exception $e ) {\n                    Log::debug($e->getMessage ()) ;\n                    return json_encode ( [ \n                            'error' => $e->getMessage () \n                    ] );\n                }\n            } else if ($action == 'remove') {\n\n                $keys = array_keys($data);\n\n                $instance = new $model();\n\n                foreach($keys as $key){\n\n                    $row = $data[$key];\n\n                    $row['id'] = $key;\n\n                    $validator = Validator::make($row, $instance->getValidationRules($action));\n\n                    if ($validator->fails()) {\n                        $msgError = array();\n                        $messages = $validator->errors();\n                        $msgKeys = $messages->keys();\n                        foreach ($msgKeys as $msgKey) {\n                            $msgError[] =\n                            array(\n                                    'name' => $msgKey,\n                                    'status' => $messages->get($msgKey)\n                            );\n                        }\n                        return  json_encode(array('fieldErrors' => $msgError));\n                    }\n                }\n\n                try {\n                    foreach ( $data as $id => $content ) {\n                        $obj = $model::find ( $id );\n                        if ($obj) {\n                            $obj->delete ();\n                        }\n                    }\n                    return json_encode ( [ \n                            'data' => [ ] \n                    ] );\n                } catch ( Exception $e ) {\n                    return json_encode ( [ \n                            'error' => $e->getMessage () \n                    ] );\n                }\n            } else {\n                return json_encode(array (\n                        'error' => 'System Error: Variable passed to DT Editor is not a valid Eloquent Builder' \n                ));\n            }\n        }\n    }\n    public function postProcess(Request $request) {\n        Log::info ( 'begin postProcess' );\n\n        /*\n         * Check input parameters\n         */\n\n        if (! $request->has ( 'action' )) {\n            return json_encode ( [ \n                    'error' => 'System Error: Action is missing' \n            ] );\n        }\n\n        if (! $request->has ( 'table_name' )) {\n            return json_encode ( [ \n                    'error' => 'System Error: Table name is missing' \n            ] );\n        }\n\n        if (! $request->has ( 'data' )) {\n            return json_encode ( [ \n                    'error' => 'System Error: Data content is missing' \n            ] );\n        }\n\n        $returnArray = $this->process ( $request );\n\n        Log::debug($returnArray);\n\n        Log::info ( 'End postProcess' );\n\n        return $returnArray;\n    }\n\n\n\u7d50\u8ad6\n\u7d50\u69cb\u3044\u3044\u611f\u3058\u306e\u30de\u30b9\u30bf\u30fc\u7de8\u96c6\u6a5f\u80fd\u306f\u51fa\u6765\u4e0a\u304c\u308a\u301c\n\n\n\n#\u3084\u308a\u305f\u3044\u3053\u3068\n\n\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u306f\u3069\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u3067\u3082\u591a\u304b\u308c\u5c11\u306a\u304b\u308c\u4f7f\u308f\u308c\u308b\u3067\u3057\u3087\u3046\u3002\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u306e\u8ffd\u52a0\u30fb\u524a\u9664\u30fb\u66f4\u65b0\u306fAdmin\u5f79\u5272\u5411\u3051\u306e\u6a5f\u80fd\u3060\u304b\u3089\u4e00\u822c\u7684\u306a\u30e6\u30fc\u30b6\u30fc\u306f\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u306f\u305a\u304c\u306a\u3044\u3067\u3059\u304c\u4eba\u6570\u306f\u5c11\u306a\u3044\u305f\u3081\u91cd\u8981\u6a5f\u80fd\u3067\u306f\u306a\u3044\u3068\u601d\u3044\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u3092\u6271\u3046\u306e\u306f\u305f\u3060\uff11\u3064\u30c6\u30fc\u30d6\u30eb\u3067\u30ec\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u30fb\u524a\u9664\u30fb\u66f4\u65b0\u3068\u3044\u3046\u57fa\u672c\u7684\u306a\u64cd\u4f5c\u3067\u96e3\u3057\u304f\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u901a\u5e38\u306f\u30de\u30b9\u30bf\u30fc\u30c6\u30fc\u30d6\u30eb\u306e\u6570\u306f\u7d50\u69cb\u591a\u3044\u3060\u3057\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\u306f\u7d71\u4e00\u3067\u306f\u306a\u3044\u306e\u3067\u3082\u3057\u6570\u30fb\u69cb\u6210\u3092\u3088\u305d\u306b\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u7684\u306b\u7de8\u96c6\u3067\u304d\u308c\u3070\u30d9\u30b9\u30c8\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\n\u50d5\u306fLaravel\u3092\u52c9\u5f37\u3059\u308b\u521d\u5fc3\u8005\u3067\u4f53\u9a13\u3057\u306a\u304c\u3089\u4ee5\u964d\u306e\u3088\u3046\u306a\u30a4\u30e1\u30fc\u30b8\u306e\u901a\u308a\u306e\u6a5f\u80fd\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\uff1a\n- \u30de\u30b9\u30bf\u30fc\u30c6\u30fc\u30d6\u30eb\u306e\u540d\u524d\u3092SelectBox\u304b\u3089\u9078\u629e\u3059\u308c\u3070\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\u3092\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u53d6\u5f97\u3057\u3066[Datatable](datatables.net)\u3092\u69cb\u7bc9\u3059\u308b\n- [Editor DataTable](editor.datatables.net)\u3092\u7528\u3044\u3066\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u81ea\u4f53\u3092\u7de8\u96c6\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n\nDatatable\u306e\u8ffd\u52a0\u305f\u306f\u5225\u6295\u7a3f\u3067\u8ff0\u3079\u307e\u3057\u305f\u306e\u3067\u4eca\u56de\u306fEditor\u3068\u3044\u3046Datatable\u306e\u91cd\u8981\u306a\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u91cd\u3093\u3058\u3066\u8a71\u3055\u305b\u3066\u3082\u3089\u304a\u3046\u3068\u601d\u3044\u307e\u3059\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-02 10.10.22.png](https://qiita-image-store.s3.amazonaws.com/0/139068/1fe599ce-952e-3ca8-ea62-5b55f92628a4.png)\n\n#\u958b\u767a\u624b\u9806\n\n##Datatables \n\n\u81ea\u3089\u30af\u30e9\u30a4\u30a8\u30f3\u30c8\u3084\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u306e\u3092\u5b9f\u88c5\u3059\u308b\u306e\u306f\u5148\u65e5\u306e\u6295\u7a3f\u3067\u8aac\u660e\u3057\u307e\u3057\u305f\u3051\u3069\u672c\u6295\u7a3f\u306f\u3082\u3063\u3068\u7c21\u5358\u306a\u65b9\u3092\u7d39\u4ecb\u81f4\u3057\u307e\u3059\u3002Yajra\u3055\u3093\u3068\u3044\u3046\u4eba\u306fDatatable\u306b\u3064\u3066\u306e\u3088\u304f\u64cd\u4f5c\u3092\u30d1\u30c3\u30b1\u30fc\u30b8\u3057\u3066\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u5316\u306b\u3057\u3066\u304f\u308c\u3066\u3082\u3063\u3068\u7c21\u5358\u306a\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\u8a73\u7d30\u306f\u4ee5\u4e0b\u306e\u30ea\u30f3\u30af\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n-> [Yajra box](https://datatables.yajrabox.com)\n\n\u4eca\u56de\u306e\u4f8b\u4f5c\u308c\u308b\u305f\u3081Yajra\u3055\u3093\u304c\u4f5c\u3063\u3066\u304f\u308c\u305f\u521d\u5fc3\u8005\u5411\u3051\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306b\u5f93\u3063\u3066\u5b9f\u65bd\u3057\u3066\u3044\u304f\u3002\n\n-> [Yajra Box Tutorial for Starter](https://datatables.yajrabox.com/starter) \n\n##DataTables Editor\n\n\u4ee5\u4e0a\u3082\u8a00\u3044\u307e\u3057\u305f\u3051\u3069Editor\u306fDatatables\u306e\u4e00\u3064\u306e\u9762\u767d\u3044\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002Plugin\u306a\u306e\u3067DataTable\u306b\u542b\u3081\u3089\u308c\u308b\u3068\u306f\u9650\u308a\u307e\u305b\u3093\u3002\u300cpublic/plugins/datatables\u300d\u306beditor\u304c\u5b58\u5728\u3057\u306a\u3044\u304b\u306e\u78ba\u8a8d\u306f\u5fc5\u8981\u3067\u3082\u3057\u306a\u304b\u3063\u305f\u3089\u4ee5\u4e0b\u306e\u30ea\u30f3\u30af\u3092\u30a2\u30af\u30bb\u30b9\u3057\u3066\u8ffd\u52a0\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u306f\u5fc5\u8981\u3067\u3059\u3002PHP/.Net/JS\u306e\u305d\u308c\u305e\u308c\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u304c\u3042\u308a\u307e\u3059\u304c\u4eca\u56de\u306fLaravel\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u4f7f\u7528\u3059\u308b\u3064\u3082\u308a\u3067\u3059\u306e\u3067PHP\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n->[Datatables Editor] (https://editor.datatables.net/download/index)\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305fDatatables\u3068Editor\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u7528\u3067\u304d\u308b\u305f\u3081\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\n```css+php\n\n<link rel=\"stylesheet\" type=\"text/css\" href=\"{{ asset('/plugins/datatables/DataTables-1.10.12/css/jquery.dataTables.css')}}\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"{{ asset('/plugins/datatables/Editor-PHP-1.5.6/css/editor.dataTables.css')}}\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"{{ asset('/plugins/datatables/Select-1.2.0/css/select.dataTables.min.css')}}\">\n```\n\n```js\n<script type=\"text/javascript\" src=\"{{ asset('/plugins/datatables/DataTables-1.10.12/js/jquery.dataTables.min.js')}}\"></script>\n<script type=\"text/javascript\" src=\"{{ asset('/plugins/datatables/Editor-PHP-1.5.6/js/dataTables.editor.js')}}\"></script>\n<script type=\"text/javascript\" src=\"{{ asset('/plugins/datatables/Select-1.2.0/js/dataTables.select.js')}}\"></script>\n```\n\n##\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u7de8\u96c6\u753b\u9762\n\n\u307e\u305a\u306f\u4ee5\u4e0a\u306e\u30a4\u30e1\u30fc\u30b8\u3088\u3046\u306a\u753b\u9762\u3092blade\u3067\u4f5c\u308a\u307e\u3059\u3002\n\n```settings_master.php\n@section('main-content')\n\n<div class=\"box box-info\" id=\"main-box\" name=\"main-box\">\n\t<div class=\"box-header with-border\">\n\t\t<h3 class=\"box-title\"><i class=\"fa fa-cog\"></i>{{trans('pg_system_master.box.lblTitle')}}</h3>\n\t\t<div class=\"box-tools pull-right\">\n        </div>\n\t</div>\n\t<div class=\"box-body\">\n\t\t<div class=\"row\">\n\t\t\t<div class=\"col-md-6\">\n\t\t\t\t<div class=\"form-group\">\n\t                  <label for=\"optMasterTable\" class=\"col-sm-3 control-label\">Master Table</label>\n\t                  <div class=\"col-sm-9\">\n\t\t\t\t           <select class=\"form-control select2\" id = \"optMasterTable\" name =\"optMasterTable\" style=\"width: 100%;\">\n\t\t\t\t\t\t\t\t@foreach($lstMasterTableNames as $mstTableName)\n\t\t\t\t\t\t\t\t\t<option value=\"{{$mstTableName->name}}\">{{$mstTableName->name}}</option>\n\t\t\t\t\t\t\t\t@endforeach\n\t\t\t\t           </select>\n\t                  </div>\n\t            </div>\n            </div>\n\t\t</div>\n                \n\t\t<div class=\"table-responsive\" name=\"tableDiv\" id=\"tableDiv\">\n\t\t\t<table class=\"table table-striped table-bordered table-hover display\" id=\"master-table\" name =\"master-table\">\n\t\t        <thead>\n\t\t            \n\t\t        </thead>\n\t\t    </table>\n\t\t</div>  \n\t</div>\n\t<div class=\"box-footer clearfix\">\n\t\t<a href=\"#\" id='btnCreate' name='btnCreate'\n\t\t\tclass=\"btn btn-sm btn-success btn-flat pull-right\">{{trans('pg_system_master.box.btnCreate')}}</a> \n\t</div>\n</div>\n\n@endsection \n```\n\n\u898b\u3089\u308c\u305f\u901a\u308a\u306b\u753b\u9762\u306e\u4e0a\u3067\u7a7a\u767d\u306etable\u3068SelectBox\u306f\u5b9a\u7fa9\u3057\u307e\u3057\u305f\u3002\u30d6\u30e9\u30a6\u30b6\u30fc\u3067\u958b\u3044\u3066\u898b\u3093\u305f\u3089\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u304f\u308b\u306f\u305a\u3002SelectBox\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u306f\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u6301\u3063\u3066\u304f\u308b\u306e\u3067\u30b5\u30fc\u30d0\u30fc\u306e\u51e6\u7406\u306f\u5b9f\u88c5\u3055\u308c\u3066\u5c45\u306a\u3044\u9650\u308a\u52d5\u3051\u306a\u3044\u306e\u3092option\u306e\u3068\u3053\u308d\u898b\u3066\u898b\u305f\u3089\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u3067\u306f\u30b5\u30fc\u30d0\u30fc\u306e\u51e6\u7406\u3092\u5f04\u3063\u3066\u898b\u307e\u3057\u3087\u3046\u3002\n\n```routes.php\nRoute::get('settings/master', ['as' => 'systems.settings.master', 'uses' => 'MasterDataController@index']);\n```\n\n```MasterDataController.php\npublic function index(Request $request) {\n\t$lstMasterTableNames = DB::select ( 'SELECT TABLE_NAME as name FROM INFORMATION_SCHEMA.TABLES \n\t\t\t\t\t\t\t\t\t\t   WHERE \n\t\t\t\t\t\t\t\t\t\t\t\tTABLE_SCHEMA=\"MySchema\" \n\t\t\t\t                           \t\tAND (TABLE_NAME LIKE \"mst%\")\n\t\t\t\t        \t\t\t\t\t\tAND TABLE_TYPE=\"BASE TABLE\"\n\t\t\t\t                           ORDER BY TABLE_NAME ASC\n\t\t\t\t\t\t\t\t\t\t ' );\n\t\treturn View::make ( 'settings_master' )->with ( 'lstMasterTableNames', $lstMasterTableNames );\n}\n```\n\n- \u5206\u5225\u3057\u3084\u3059\u3044\u305f\u3081\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u306e\u30c6\u30fc\u30d6\u30eb\u540d\u306f\u300cmst\u300d\u3092\u982d\u306b\u3064\u3051\u3066\u547d\u540d\u898f\u7d04\u306b\u3059\u308b\u3002\n- Schema\u540d\u306f\u4eee\u306b\u300cMySchema\u300d\u3068\u3057\u3066\u3044\u308b\u304c\u5b9f\u88c5\u3059\u308b\u3068\u304d\u306b\u81ea\u5206\u304c\u4f7f\u3063\u3066\u3044\u308bSchema\u540d\u3092\u5165\u308c\u66ff\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n- \u4f7f\u3063\u3066\u3044\u305fSQL\u306f\u305f\u3060Schema\u30c6\u30fc\u30d6\u30eb\u3092\u898b\u3066\u53d6\u5f97\u3057\u305f\u3044\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u53d6\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u3053\u3053\u307e\u3067\u884c\u3051\u3070\u30d6\u30e9\u30a6\u30b6\u30fc\u3067\u958b\u3044\u305f\u3089SelectBox\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u306f\u30de\u30b9\u30bf\u30fc\u30c6\u30fc\u30d6\u30eb\u540d\u304c\u5165\u308c\u3089\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\u9078\u629e\u3057\u3066\u898b\u305f\u3089\u4e0b\u306e\u30c6\u30fc\u30d6\u30eb\u306e\u8868\u793a\u306f\u4f55\u3082\u5909\u308f\u3089\u306a\u3044\u3067\u8584\u3063\u307a\u3089\u306a\u301c\u3068\u601d\u3063\u3066\u3044\u308b\u4eba\u306f\u5c45\u306a\u3044\u306e\u3067\u3059\u304b\uff1f\uff08\u7b11\n\n##\u30de\u30b9\u30bf\u30fc\u30c7\u30fc\u30bf\u3092\u7de8\u96c6\u3059\u308b\u6a5f\u80fd\n\n\u9078\u629e\u3057\u305f\u30c6\u30fc\u30d6\u30eb\u540d\u306e\u5185\u5bb9\u306f\u8868\u793a\u3055\u308c\u308b\u305f\u3081\uff12\u3064\u306e\u4f5c\u696d\u306f\u5fc5\u8981\n- \u2460\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5143\u306b\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\uff08Field\u540d\uff09\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066Datatble\u3092\u69cb\u7bc9\u3059\u308b\u3053\u3068\n- \u2461\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5143\u306b\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u3066Datatable\u304c\u308f\u304b\u3089\u308c\u308b\u5f62\u306b\u5909\u63db\u3057\u3066\u30af\u30e9\u30a4\u30a8\u30f3\u30c8\u306b\u8fd4\u3059\u3002\n\n\u2460\u30c6\u30fc\u30d6\u30eb\u306e\u69cb\u6210\u60c5\u5831\u3092\u53d6\u5f97\n\n```MasterDataController.php\npublic function schema(Request $request) {\n\t\t$tableName = strtoupper ( $request->input ( 'table_name' ) );\n\t\t$className = Config::get ( 'constants.MASTER_TABLES.' . $tableName . '.CLASS' );\n\t\tLog::debug ( $className );\n\t\ttry {\n\t\t\t$model = new $className ();\n\t\t\t$fillables = $model->getFillable ();\n\t\t\t$fields = array ();\n\t\t\tforeach ( $fillables as $fillable ) {\n\t\t\t\t$field = array ();\n\t\t\t\t$field ['label'] = $model->getColumnLabelByName ( $fillable );\n\t\t\t\t$field ['name'] = $fillable;\n\t\t\t\t$fields [] = $field;\n\t\t\t}\n\t\t\t$ret = json_encode ( [ \n\t\t\t\t\t'success' => true,\n\t\t\t\t\t'fields'  => $fields,\n\t\t\t\t\t'columns' => $model->getColumnsSetting () \n\t\t\t] );\n\t\t\treturn $ret;\n\t\t} catch ( Exception $e ) {\n\t\t\treturn json_encode ( [ \n\t\t\t\t\t'success' => false,\n\t\t\t\t\t'message' => $e->getMessage () \n\t\t\t] );\n\t\t}\n\t}\n```\n\n```config\u00a5constants.php\n'MASTER_TABLES'=>\n\t\t[\n\t\t\t\n\t\t\t'MSTBRANCHES'=>[\n\t\t\t\t\t'NAME'  => 'Branches',\n\t\t\t\t\t'CLASS' => 'App\\\\Models\\\\Branch'\n\t\t\t],\n\t\t\t'MSTCHANNELS'=>[\n\t\t\t\t\t'NAME'  => 'Branches',\n\t\t\t\t\t'CLASS' => 'App\\\\Models\\\\Channel'\n\t\t\t],\n\t\t\t'MSTCOMPANIES'=>[\n\t\t\t\t\t\t'NAME'  => 'Companies',\n\t\t\t\t\t\t'CLASS' => 'App\\\\Models\\\\Company'\n\t\t\t],\n\t\t\t'MSTDEPARTMENTS'=>[\n\t\t\t\t\t\t'NAME'  => 'Departments',\n\t\t\t\t\t\t'CLASS' => 'App\\\\Models\\\\Department'\n\t\t\t],\n\t\t]\n```\n\u4f55\u305d\u308c!!!\u3061\u3087\u3063\u3068\u8aac\u660e\u3055\u305b\u3066\u304f\u3060\u3055\u3044\n\n- \u6301\u3063\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5143\u306b\u69cb\u6210\u60c5\u5831\u3092\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306bSchema\u60c5\u5831\u306e\u3088\u3046\u306bRawQuery\u4f7f\u3063\u3066\u53d6\u308c\u308b\u306f\u305a\u304c\u305b\u3063\u304b\u304f\u30e2\u30c7\u30eb\u3092\u3064\u304f\u3063\u305f\u306e\u306b\u4f7f\u308f\u306a\u3044\u306e\u306f\u52ff\u4f53\u7121\u3044\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u305d\u308c\u306b\u7de8\u96c6\u53ef\u80fd\u306e\u5185\u5bb9\u3060\u3051\u3092\u7de8\u96c6\u3055\u305b\u308b\u306e\u3067\u3042\u308b\u65b9\u6cd5\u3067\u30c6\u30fc\u30d6\u30eb\u540d\u304b\u3089\u8a72\u5f53Model\u306b\u5909\u63db\u3067\u304d\u308c\u3070fillable\u3084guarded\u5c5e\u6027\u3092\u898b\u308b\u3060\u3051\u3067\u3044\u3044\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\u305d\u3046\u3044\u3046\u308f\u3051\u3067\u3061\u3087\u3063\u3068\u920d\u3044\u65b9\u6cd5\u304b\u3082\u77e5\u308a\u307e\u305b\u3093\u304cconfig\u3067\u30c6\u30fc\u30d6\u30eb\u540d\u301c\u30e2\u30c7\u30fc\u30eb\u30af\u30e9\u30b9\u540d\u306e\u95a2\u4fc2\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n- field\u540d\u306f\u305d\u306e\u307e\u307e\u753b\u9762\u3067\u8868\u793a\u3059\u308b\u306e\u306f\u826f\u304f\u306a\u3044\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u306e\u3067Field\u540d\u304b\u3089\u8868\u793a\u7528\u306e\u30c6\u30ad\u30b9\u30c8\u306b\u5909\u63db\u3059\u308b\u95a2\u6570\u3092\u6e96\u5099\u3057\u3066\u304a\u304f\uff08getColumnLabelByName)\n- \u30ad\u30fc\u70b9\u306f\u300c$model = new $className ();\u300d\u3067\u3059\u3002PHP\u3067\u306f\u305d\u3046\u3044\u3046\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u308a\u65b9\u306f\u53ef\u80fd\u3067\u3059\u306e\u3067\u3059\u3054\u304f\u4fbf\u5229\u3067\u3059\u3002\n\nschema()\u306e\u8fd4\u5374\u30c7\u30fc\u30bf\u306fDatatable\u306b\u3082Editor\u30d7\u30e9\u30b0\u30a4\u30f3\u306b\u3082\u4f7f\u308f\u308c\u307e\u3059\u3002\u3068\u3089\u3048\u305a\n\n```js\n\n<script type=\"text/javascript\">\n\nvar masterTable;\nvar masterTableEditor;\n\n$(document).ready(function(){\n $.ajaxSetup({\n\t    headers: {\n\t        'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n\t    }\n\t });\n     var tableName =  $('#optMasterTable').select2('val');\n     $.ajax({\n\t        type: 'GET',\n\t        url:  '{!! route(\"api.master.schema\") !!}' + '?table_name=' + tableName,\n\t        beforeSend : function(xhr, settings){\n\t\t      $('#main-box').append('<div class=\"overlay\" id =\"spin\" name = \"spin\"><i class=\"fa fa-refresh fa-spin\"></i></div>');              \n\t\t    }, \n\t\t    complete: function(xhr, textStatus){\n\t\t      $('#spin').remove();\n\t\t    },\n\t        success: function(d) {\n\t\t        var result = jQuery.parseJSON(d);\n\n\t\t        if(masterTable){\n\t\t        \tmasterTable.destroy();\n\t\t        \t$('#tableDiv').empty(); // empty in case the columns change\n\t\t       \n\t\t\t\t\t/*\n\t\t\t\t\t*Create <thead></thead>\n\t\t\t\t\t*/\n\t\t\t\t\tvar fields = result.fields;\n\t\t\t\t\tvar columns  = result.columns;\n\t\t\t\t\t\n\t\t\t\t\tvar htmlTable = '<table class=\"table table-striped table-bordered table-hover display\" id=\"master-table\" name =\"master-table\">';\n\t\t\t\t\thtmlTable += '<thead>';\n\t\t\t\t\thtmlTable += '<tr>';\n\t\t\t\t\tcolumns.forEach(function(column){\n\t\t\t\t\t\thtmlTable += '<th>' + column.label + '</th>';\n\t\t\t\t\t});\n\t\t\t\t\thtmlTable += '</tr>';\n\t\t\t\t\thtmlTable += '</thead>';\n\t\t\t\t\thtmlTable += '</table>';\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t$('#tableDiv').append(htmlTable);\n\n\t\t        }\n\t\t        masterTable = $('#master-table').DataTable({\n\t    \t\t\tlengthChange: false,\n\t    \t\t\tresponsive: true,\n\t    \t        processing: true,\n\t    \t        serverSide: true,\n\t    \t        ajax: {\n\t    \t\t        url: '{!! route(\"api.master.datatables\") !!}' + '?table_name=' + tableName,\n\t    \t\t        method : 'GET'\n\t    \t        },    \n\t    \t        dom: 'Bfrtip',\n\t    \t        columns: result.columns,\n\t    \t        select:  true,\n\t                aoColumnDefs: [\n\t             \t\t\t\t\t{ 'bSortable': false, 'aTargets': [0, 1 , 4, 5] }\t,\n\t             \t\t\t\t  \t{ 'className': \"dt-center\", \"aTargets\": [0,1,2,3,4,5,6] },\n\t             \t],\n\t             \tinitComplete: function(settings, json) {\n\t            \t\t$searchBox = $(\".dataTables_filter input[type='search']\");\n\t            \t\t$searchBox.addClass('form-control input-sm');\n\t            \t\t$searchBox.attr(\"placeholder\", \"Type here to search\");\n\t            \t\t$('.dataTables_filter label').get(0).firstChild.nodeValue = \"\";\n\t            \t\t$('.dataTables_filter').addClass('col-sm-6');\n\t\t\t\t  \t},\n\t    \t    });\n\t\t        masterTableEditor = new $.fn.dataTable.Editor( {\n\t\t            ajax: {\n\t\t                url: '{{route(\"api.master.crud\")}}',\n\t\t                data: function (form) {\n\t\t               \t form.table_name = $('#optMasterTable').select2('val');\n\t\t               \t return form;\n\t\t                },\n\t\t                method: 'POST',\n\t\t            },\n\t\t            table: '#master-table',\n\t\t            idSrc: \"id\",\n\t\t            fields: result.fields,\n\t\t        } );\n\t\t        $('#master-table').on( 'click', 'tbody td.editable', function (e) {\n\t\t        \tmasterTableEditor.inline( this );\n\t\t        } );\n\t\t       \n\t\t   \t    $('#master-table').on( 'click', 'tbody a.remove', function (e) {\n\t\t   \t    \tmasterTableEditor\n\t\t   \t            .title( '{{trans(\"pg_system_master.dialog.delete.title\")}}')\n\t\t   \t            .message( '{{trans(\"pg_system_master.dialog.delete.message\")}}' )\n\t\t   \t            .buttons( { \"label\": \"{{trans('pg_system_master.dialog.delete.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n\t\t   \t            .remove( $(this).closest('tr') );\n\t\t   \t    } );\n\n\t\t   \t    $('#master-table').on( 'click', 'tbody a.edit', function (e) {\n\t\t   \t    \tmasterTableEditor\n\t\t   \t            .title( \"{{trans('pg_system_master.dialog.edit.title')}}\" )\n\t\t   \t            .buttons( { \"label\": \"{{trans('pg_system_master.dialog.edit.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n\t\t   \t            .edit($(this).closest('tr'));\n\t\t   \t    } );\n\t        },\n\t        error : function(data){\n\t        \t$('#spin').remove();\n\t        }\n\t \t});\n    \n    \t$('#optMasterTable').on('change', function (e) {\n\t     \t var tableName = $('#optMasterTable').select2('val');\n\n    \t\t $.ajax({\n    \t\t        type: 'GET',\n    \t\t        url:  '{!! route(\"api.master.schema\") !!}' + '?table_name=' + tableName,\n    \t\t        beforeSend : function(xhr, settings){\n    \t\t\t\t      $('#main-box').append('<div class=\"overlay\" id =\"spin\" name = \"spin\"><i class=\"fa fa-refresh fa-spin\"></i></div>');              \n    \t\t\t\t}, \n    \t\t\t\tcomplete: function(xhr, textStatus){\n    \t\t\t\t      $('#spin').remove();\n    \t\t\t\t},\n    \t\t        success: function(data) {\n        \t\t        var result = jQuery.parseJSON(data);\n        \t\t        \n        \t\t        /*\n        \t\t        * Clear table\n        \t\t        */\n        \t\t        masterTable.destroy();\n        \t\t        $('#tableDiv').empty(); // empty in case the columns change\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t*Create <thead></thead>\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tvar fields = result.fields;\n\t\t\t\t\t\tvar columns  = result.columns;\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar htmlTable = '<table class=\"table table-striped table-bordered table-hover display\" id=\"master-table\" name =\"master-table\">';\n\t\t\t\t\t\thtmlTable += '<thead>';\n\t\t\t\t\t\thtmlTable += '<tr>';\n\t\t\t\t\t\tcolumns.forEach(function(column){\n\t\t\t\t\t\t\thtmlTable += '<th>' + column.label + '</th>';\n\t\t\t\t\t\t});\n\t\t\t\t\t\thtmlTable += '</tr>';\n\t\t\t\t\t\thtmlTable += '</thead>';\n\t\t\t\t\t\thtmlTable += '</table>';\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t$('#tableDiv').append(htmlTable);\n        \t\t \t\t\n\t\t\t\t\t\tmasterTable = $('#master-table').DataTable({\n    \t\t    \t\t\tlengthChange: false,\n    \t\t    \t\t\tresponsive: true,\n    \t\t    \t        processing: true,\n    \t\t    \t        serverSide: true,\n    \t\t    \t        ajax: {\n    \t\t    \t\t        url: '{!! route(\"api.master.datatables\") !!}' + '?table_name=' + tableName,\n    \t\t    \t\t        method : 'GET'\n    \t\t    \t        },    \n    \t\t    \t        dom: 'Bfrtip',\n    \t\t    \t        columns: columns,\n    \t\t    \t        select:  true,\n    \t\t                aoColumnDefs: [\n    \t\t             \t\t\t\t\t{ 'bSortable': false, 'aTargets': [0, 1 , 4, 5] }\t,\n    \t\t             \t\t\t\t  \t{ 'className': \"dt-center\", \"aTargets\": [0,1,2,3,4,5,6] },\n    \t\t             \t],\n    \t\t             \tinitComplete: function(settings, json) {\n    \t\t            \t\t$searchBox = $(\".dataTables_filter input[type='search']\");\n    \t\t            \t\t$searchBox.addClass('form-control input-sm');\n    \t\t            \t\t$searchBox.attr(\"placeholder\", \"Type here to search\");\n    \t\t            \t\t$('.dataTables_filter label').get(0).firstChild.nodeValue = \"\";\n    \t\t            \t\t$('.dataTables_filter').addClass('col-sm-6');\n    \t\t\t\t\t  \t},\n    \t\t    \t    });\n    \t\t    \t    /*\n    \t\t    \t    *  Update the tables editor\n    \t\t    \t    */\n    \t\t    \t    masterTableEditor.clear();\n    \t\t    \t    masterTableEditor.add(fields);\n    \t\t    \t    $('#master-table').on( 'click', 'tbody td.editable', function (e) {\n    \t\t    \t    \tmasterTableEditor.inline( this );\n    \t\t    \t    } );\n    \t\t    \t    $('#master-table').on( 'click', 'tbody a.remove', function (e) {\n    \t\t    \t    \tmasterTableEditor\n    \t\t    \t            .title( '{{trans(\"pg_system_master.dialog.delete.title\")}}')\n    \t\t    \t            .message( '{{trans(\"pg_system_master.dialog.delete.message\")}}' )\n    \t\t    \t            .buttons( { \"label\": \"{{trans('pg_system_master.dialog.delete.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n    \t\t    \t            .remove( $(this).closest('tr') );\n    \t\t    \t    } );\n\n    \t\t    \t    $('#master-table').on( 'click', 'tbody a.edit', function (e) {\n    \t\t    \t    \tmasterTableEditor\n    \t\t    \t            .title( \"{{trans('pg_system_master.dialog.edit.title')}}\" )\n    \t\t    \t            .buttons( { \"label\": \"{{trans('pg_system_master.dialog.edit.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n    \t\t    \t            .edit($(this).closest('tr'));\n    \t\t    \t    } );\n    \t\t    \t    /*\n\t\t\t\t\t\tfields.forEach(function(field){\n\t\t\t\t\t\t\tconsole.log(field);\n\t\t\t\t\t\t\ttableEditor.add(field);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t*/\n    \t\t        \t\n    \t\t        },\n    \t\t        error : function(data){\n    \t\t        \t$('#spin').remove();\n    \t\t        }\n    \t\t    });\n\n    \t });\n\t    \n\t    $('#btnCreate').on( 'click', function () {\n\t    \tmasterTableEditor\n\t            .title( \"{{trans('pg_system_master.dialog.create.title')}}\" )\n\t            .buttons( { \"label\": \"{{trans('pg_system_master.dialog.create.btnOK')}}\", \"fn\": function () { masterTableEditor.submit() } } )\n\t            .create();\n\t    } );\n    \n});\t\n</script>\n```\n\n```routes.php\n\n\tRoute::get('master/datatables', ['as' => 'api.master.datatables', 'uses' => 'Systems\\MasterDataController@datatables']);\n\t\n\tRoute::post('master/crud', ['as' => 'api.master.crud', 'uses' => 'Systems\\MasterDataController@postProcess']);\n\t\n\tRoute::get('master/schema', ['as' => 'api.master.schema', 'uses' => 'Systems\\MasterDataController@schema']);\n```\n\n*\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8*\n- \u521d\u671f\u5316\u3055\u308c\u305fDatatable\u3092\u30b5\u30a4\u30c9\u521d\u671f\u5316\u3059\u308b\u306e\u306f\u3060\u3081\u3067\u3059\u306e\u3067\u9078\u629e\u80a2\u3092\u5909\u3048\u308b\u3068destroy()\u3057\u3066\u5b8c\u5168\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308a\u76f4\u3055\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n \n```js\n\nmasterTable.destroy();\n                        $('#tableDiv').empty(); // empty in case the columns change\n                       \n                        var fields = result.fields;\n                        var columns  = result.columns;\n\n                        var htmlTable = '<table class=\"table table-striped table-bordered table-hover display\" id=\"master-table\" name =\"master-table\">';\n                        htmlTable += '<thead>';\n                        htmlTable += '<tr>';\n                        columns.forEach(function(column){\n                            htmlTable += '<th>' + column.label + '</th>';\n                        });\n                        htmlTable += '</tr>';\n                        htmlTable += '</thead>';\n                        htmlTable += '</table>';\n```\n- Editor\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u521d\u671f\u5316. \u7de8\u96c6\u3059\u308b\u3068\u304d\u30c6\u30fc\u30d6\u30eb\u540d\u306f\u5fc5\u8981\u3067\u3059\u306e\u3067\u9001\u4fe1\u3059\u308b\u30c7\u30fc\u30bf\u306b\u52a0\u3048\u3066\u9078\u629e\u3057\u305f\u30c6\u30fc\u30d6\u30eb\u540d\u3092\u5165\u308c\u3066\u304a\u304f\u3002\n\n```js\n\nmasterTableEditor = new $.fn.dataTable.Editor( {\n                    ajax: {\n                        url: '{{route(\"api.master.crud\")}}',\n                        data: function (form) {\n                         form.table_name = $('#optMasterTable').select2('val');\n                         return form;\n                        },\n                        method: 'POST',\n                    },\n                    table: '#master-table',\n                    idSrc: \"id\",\n                    fields: result.fields,\n                } );\n```\n\n- Datatable\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u63d0\u4f9b\u3059\u308b\u30ed\u30b8\u30c3\u30af\u306f\u4ee5\u4e0b\u3067\u3059\u3002\u898b\u305f\u901a\u308a\u3001Yajra\u306b\u63d0\u4f9b\u3057\u3066\u3082\u3089\u3063\u305f\u30e9\u30a4\u30d6\u30e9\u30ea\u30fc\u3092\u4f7f\u3048\u3070\u30b3\u30fc\u30c9\u306f\u77ed\u7e2e\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n```MasterDataController.php\nuse Yajra\\Datatables\\Datatables;\n\npublic function datatables(Request $request) {\n\t\t$tableName = strtoupper ( $request->input ( 'table_name' ) );\n\t\t\n\t\t$className = Config::get ( 'constants.MASTER_TABLES.' . $tableName . '.CLASS' );\n\t\t\n\t\t$model = new $className ();\n\t\t\n\t\t$columnList = $model->getColumnList ();\n\t\t$objs = $className::select ( $columnList );\n\t\tif (in_array ( 'ordering', $columnList )) {\n\t\t\t$objs = $objs->orderBy ( 'ordering' );\n\t\t}\n\t\t\n\t\treturn Datatables::of ( $objs )->addColumn ( 'action', function ($obj) {\n\t\t\t$html = '<div class=\"tools\"><a href=\"#\" class=\"edit btn btn-xs btn-primary\"><i class=\"fa fa-edit\"></i></a>';\n\t\t\t$html .= '&nbsp<a href=\"#\" class=\"remove btn btn-xs btn-danger\"><i class=\"fa fa-trash-o\"></i></a></div>';\n\t\t\treturn $html;\n\t\t} )->make ( true );\n\t}\n```\n###\u65b0\u3057\u3044\u30e2\u30c7\u30fc\u30eb\n\n\u4ee5\u4e0a\u306e\u8aac\u660e\u306e\u901a\u308a\u306bLaravel\u306b\u63d0\u4f9b\u3057\u3066\u3082\u3089\u3063\u3066\u3044\u308b\u30e2\u30c7\u30eb\u306b\u52a0\u3048\u3066Datatable\u304c\u5206\u304b\u308c\u308b\u305f\u3081\u305d\u306e\u30e2\u30c7\u30eb\u3092\u7d99\u627f\u3057\u3066\u3044\u304f\u3064\u304b\u306e\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```GlobalModel.php\n\nuse Illuminate\\Database\\Eloquent\\Model;\n\nuse DB;\n\nclass GlobalModel extends Model\n{\n    \n        //\u753b\u9762\u3067\u51fa\u3066\u304f\u308b\u30c6\u30ad\u30b9\u30c8\n\tprotected $labels;\n\t\n        //order\u3067\u304d\u308b\u9805\u76ee\u540d\n\tprotected $orderable;\n\t\n\u3000\u3000\u3000\u3000//\u691c\u7d22\u3067\u304d\u308b\u9805\u76ee\u540d\n\tprotected $searchable;\n\t//\u30c7\u30fc\u30bf\u30c1\u30a7\u30c3\u30af\u30eb\u30fc\u30eb\n\tprotected $rules;\n\t//Customize\u30e1\u30c3\u30bb\u30fc\u30b8\n\tprotected $messages;\n\t    \n    public function getColumnLabelByName($column){\n    \treturn $this->labels[$column];\n    }\n    public function getColumnList(){\n    \t$columns = DB::select('SELECT column_name AS name FROM INFORMATION_SCHEMA.COLUMNS\n\t\t\t\t\t\t\t\t\t\t   WHERE TABLE_NAME = :table_name', ['table_name'=> $this->getTable()]);\n    \t$columnNames = array();\n    \tforeach($columns as $column){\n    \t\tif (in_array($column->name, $this->hidden)){\n    \t\t\tcontinue;\n    \t\t}\n    \t\t$columnNames[]= $column->name;\n    \t}\t \n    \treturn $columnNames;\n    }\n    public function getColumnsSetting(){\n    \t\n    \t$columnSettings = array();\n\t\t/*\n\t\t * Get all the columns\n\t\t */    \t\n    \t$columns = DB::select('SELECT column_name AS name FROM INFORMATION_SCHEMA.COLUMNS\n\t\t\t\t\t\t\t\t\t\t   WHERE TABLE_NAME = :table_name', ['table_name'=> $this->getTable()]);\n    \tforeach($columns as $column){\n    \t\tif (in_array($column->name, $this->hidden)){\n    \t\t\tcontinue;\n    \t\t}\n    \t\t$setting = array();\n    \t\t$setting['data'] =  $column->name;\n    \t\t$setting['name'] =  $column->name;\n    \t\t$setting['label'] =  $this->getColumnLabelByName($column->name);\n    \t\t$setting['className'] = 'dt-center';\n    \t\tif (in_array($column->name, $this->fillable) || !in_array($column->name, $this->guarded)){\n    \t\t\t$setting['className'] .= ' editable';\n    \t\t}\n    \t\tif (in_array($column->name, $this->orderable)){\n    \t\t\t$setting['orderable']= true;\n    \t\t}else{\n    \t\t\t$setting['orderable']= false;\n    \t\t}\n    \t\tif (in_array($column->name, $this->searchable)){\n    \t\t\t$setting['searchable']= true;\n    \t\t}else{\n    \t\t\t$setting['searchable']= false;\n    \t\t}\n    \t\t$columnSettings[] = $setting;\n    \t}\n    \t$columnSettings[] = array( 'data'=> 'action', 'name'=> 'action', 'label'=>'Action', 'orderable'=> false, 'searchable'=> false);\n    \treturn $columnSettings;\n    }\n    \n    public function getValidationRules($action)\n    {\n    \tif($this->rules){\n    \t\treturn $this->rules[$action];\n    \t}else\n    \t\treturn [];\n    }\n    \n}\n```\n\n\u305d\u308c\u3067config\u3067\u6307\u5b9a\u3057\u305f\u30e2\u30c7\u30eb\u306e\u306f\u4ee5\u4e0a\u306e\u3082\u306e\u3092\u7d99\u627f\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\n\n```Branch.php\n\nuse App\\Models\\GlobalModel;\n\nclass Branch extends GlobalModel\n{\n    protected $table   = 'mstBranches';\n    \n\tprotected $primaryKey = 'id';\n\t\n\tprotected $guarded  = ['id','created_at','updated_at'];\n\t\n\tprotected $fillable = ['name','display','ordering'];\n\t\n\tprotected $labels = [\n\t\t\t'id' => 'ID',\n\t\t\t'name'=> 'Property',\n\t\t\t'display' => 'CSS Display',\n\t\t\t'ordering'=> 'Display Order',\n\t\t\t'created_at' => 'Created At',\n\t\t\t'updated_at' => 'Updated At',\n\t];\n\t\n\tprotected $orderable  = ['name', 'ordering', 'created_at','updated_at'];\n\t\n\tprotected $searchable = ['name'];\n\t\t\n}\n\n```\n\n###Inline Editor\u306e\u51e6\u7406\n\ncrud\u3068\u3044\u3046\u30eb\u30fc\u30c8\u306fEditor\u3067\u30c7\u30fc\u30bf\u7de8\u96c6\u3055\u308c\u305f\u3068\u304d\u306b\u547c\u3073\u51fa\u3055\u308c\u307e\u3059\u3002Editor\u30d7\u30e9\u30b0\u30a4\u30f3\u81ea\u4f53\u306f\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u30af\u30e9\u30b9\u6301\u3063\u3066\u3044\u307e\u3059\u304cLaravel\u306b\u30a4\u30f3\u30c6\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3059\u308b\u306e\u306f\u7d50\u69cb\u624b\u9593\u304b\u304b\u308a\u307e\u3059\u306e\u3067\u4eca\u56de\u50d5\u306f\u81ea\u3089\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3092\u7c21\u5358\u306b\u4f5c\u308a\u307e\u3057\u305f\u3002\u8aac\u660e\u3057\u305f\u3089\u9577\u304f\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u8208\u5473\u3092\u6301\u3063\u3066\u3044\u308b\u65b9\u306f\u307e\u305a\u8a66\u3057\u3066\u898b\u3066\u304f\u308c\u3066\u3001\u4e0d\u660e\u306a\u3068\u3053\u308d\u304c\u3042\u308c\u3070\u30b3\u30e1\u30f3\u30c8\u3067\u76f8\u8ac7\u3057\u307e\u3057\u3087\u3046\n\n```php\n\nprivate function process(Request $request) {\n\t\tLog::info ( 'Begin private function process' );\n\t\t\n\t\tLog::debug ( $request );\n\t\t\n\t\t$action = $request->input ( 'action' );\n\t\t\n\t\t$tableName = strtoupper ( $request->input ( 'table_name' ) );\n\t\t\n\t\t$model = Config::get ( 'constants.MASTER_TABLES.' . $tableName . '.CLASS' );\n\t\t\n\t\t$data = $request->input ( 'data' );\n\t\t\n\t\t$modelType = gettype ( $model );\n\t\tif ($modelType != 'string') {\n\t\t\treturn json_encode ( [ \n\t\t\t\t\t'error' => 'System Error: Model name is not string, ' . $modelType . ' given.' \n\t\t\t] );\n\t\t} else {\n\t\t\tif ($action == 'create') {\n\t\t\t\t\n\t\t\t\t$ids = array_keys($data);\n\t\t\t\t\n\t\t\t\t$row = $data[$ids[0]];\n\t\t\t\t\t\t\t\t\n\t\t\t\t$instance = new $model();\n\t\t\t\t\n\t\t\t\t$validator = Validator::make($row, $instance->getValidationRules($action));\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tif ($validator->fails()) {\n\t\t\t\t\t$msgError = array();\n\t\t\t\t\t$messages = $validator->errors();\n\t\t\t\t\t$msgKeys = $messages->keys();\n\t\t\t\t\tforeach ($msgKeys as $msgKey) {\n\t\t\t\t\t\t$msgError[] =\n\t\t\t\t\t\tarray(\n\t\t\t\t\t\t\t\t'name' => $msgKey,\n\t\t\t\t\t\t\t\t'status' => $messages->get($msgKey)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn \tjson_encode([ 'fieldErrors' => $msgError ]);\n\t\t\t\t} else {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t$record = $model::firstOrNew ( $row );\n\t\t\t\t\t\t\n\t\t\t\t\t\t$record->save ();\n\t\t\t\t\t\t\n\t\t\t\t\t\t$resSuccessful = [ ];\n\t\t\t\t\t\t\n\t\t\t\t\t\t$resSuccessful [] = $record->toArray ();\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn json_encode ( [ \n\t\t\t\t\t\t\t\t'data' => $resSuccessful \n\t\t\t\t\t\t] );\n\t\t\t\t\t} catch ( Exception $e ) {\n\t\t\t\t\t\tLog::debug ( $e->getMessage () );\n\t\t\t\t\t\treturn json_encode ( [ \n\t\t\t\t\t\t\t\t'error' => $e->getMessage () \n\t\t\t\t\t\t] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if ($action == 'edit') {\n\t\t\t\t\n\t\t\t\tLog::info ( 'Action = edit' );\n\t\t\t\t\n\t\t\t\t$keys = array_keys($data);\n\t\t\t\t\n\t\t\t\t$instance = new $model();\n\t\t\t\t\n\t\t\t\tforeach($keys as $key){\n\t\t\t\t\t\t\n\t\t\t\t\t$row = $data[$key];\n\t\t\t\t\t\n\t\t\t\t\t$row['id'] = $key;\n\t\t\t\t\t\t\n\t\t\t\t\t$validator = Validator::make($row, $instance->getValidationRules($action));\n\t\t\t\t\t\n\t\t\t\t\tif ($validator->fails()) {\n\t\t\t\t\t\t$msgError = array();\n\t\t\t\t\t\t$messages = $validator->errors();\n\t\t\t\t\t\t$msgKeys = $messages->keys();\n\t\t\t\t\t\tforeach ($msgKeys as $msgKey) {\n\t\t\t\t\t\t\t$msgError[] =\n\t\t\t\t\t\t\tarray(\n\t\t\t\t\t\t\t\t\t'name' => $msgKey,\n\t\t\t\t\t\t\t\t\t'status' => $messages->get($msgKey)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tLog::debug($msgError);\n\t\t\t\t\t\treturn \tjson_encode([ 'fieldErrors' => $msgError ]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\t\n\t\t\t\t\t$resSuccessful = array ();\n\t\t\t\t\tforeach ( $data as $id => $content ) {\n\t\t\t\t\t\t$obj = $model::find ( $id );\n\t\t\t\t\t\t$obj->update ( $content );\n\t\t\t\t\t\t$resSuccessful [] = $obj->toArray ();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn json_encode ( array (\n\t\t\t\t\t\t\t'data' => $resSuccessful \n\t\t\t\t\t) );\n\t\t\t\t} catch ( Exception $e ) {\n\t\t\t\t\tLog::debug($e->getMessage ()) ;\n\t\t\t\t\treturn json_encode ( [ \n\t\t\t\t\t\t\t'error' => $e->getMessage () \n\t\t\t\t\t] );\n\t\t\t\t}\n\t\t\t} else if ($action == 'remove') {\n\t\t\t\t\n\t\t\t\t$keys = array_keys($data);\n\t\t\t\t\n\t\t\t\t$instance = new $model();\n\t\t\t\t\n\t\t\t\tforeach($keys as $key){\n\t\t\t\t\t\t\n\t\t\t\t\t$row = $data[$key];\n\t\t\t\t\t\n\t\t\t\t\t$row['id'] = $key;\n\t\t\t\t\t\t\n\t\t\t\t\t$validator = Validator::make($row, $instance->getValidationRules($action));\n\t\t\t\t\t\n\t\t\t\t\tif ($validator->fails()) {\n\t\t\t\t\t\t$msgError = array();\n\t\t\t\t\t\t$messages = $validator->errors();\n\t\t\t\t\t\t$msgKeys = $messages->keys();\n\t\t\t\t\t\tforeach ($msgKeys as $msgKey) {\n\t\t\t\t\t\t\t$msgError[] =\n\t\t\t\t\t\t\tarray(\n\t\t\t\t\t\t\t\t\t'name' => $msgKey,\n\t\t\t\t\t\t\t\t\t'status' => $messages->get($msgKey)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn \tjson_encode(array('fieldErrors' => $msgError));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tforeach ( $data as $id => $content ) {\n\t\t\t\t\t\t$obj = $model::find ( $id );\n\t\t\t\t\t\tif ($obj) {\n\t\t\t\t\t\t\t$obj->delete ();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn json_encode ( [ \n\t\t\t\t\t\t\t'data' => [ ] \n\t\t\t\t\t] );\n\t\t\t\t} catch ( Exception $e ) {\n\t\t\t\t\treturn json_encode ( [ \n\t\t\t\t\t\t\t'error' => $e->getMessage () \n\t\t\t\t\t] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn json_encode(array (\n\t\t\t\t\t\t'error' => 'System Error: Variable passed to DT Editor is not a valid Eloquent Builder' \n\t\t\t\t));\n\t\t\t}\n\t\t}\n\t}\n\tpublic function postProcess(Request $request) {\n\t\tLog::info ( 'begin postProcess' );\n\t\t\n\t\t/*\n\t\t * Check input parameters\n\t\t */\n\t\t\n\t\tif (! $request->has ( 'action' )) {\n\t\t\treturn json_encode ( [ \n\t\t\t\t\t'error' => 'System Error: Action is missing' \n\t\t\t] );\n\t\t}\n\t\t\n\t\tif (! $request->has ( 'table_name' )) {\n\t\t\treturn json_encode ( [ \n\t\t\t\t\t'error' => 'System Error: Table name is missing' \n\t\t\t] );\n\t\t}\n\t\t\n\t\tif (! $request->has ( 'data' )) {\n\t\t\treturn json_encode ( [ \n\t\t\t\t\t'error' => 'System Error: Data content is missing' \n\t\t\t] );\n\t\t}\n\t\t\n\t\t$returnArray = $this->process ( $request );\n\t\t\n\t\tLog::debug($returnArray);\n\t\t\n\t\tLog::info ( 'End postProcess' );\n\t\t\n\t\treturn $returnArray;\n\t}\n```\n#\u7d50\u8ad6\n\u7d50\u69cb\u3044\u3044\u611f\u3058\u306e\u30de\u30b9\u30bf\u30fc\u7de8\u96c6\u6a5f\u80fd\u306f\u51fa\u6765\u4e0a\u304c\u308a\u301c\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-02 17.08.00.png](https://qiita-image-store.s3.amazonaws.com/0/139068/47ddb985-6c93-b1ff-f4c6-ca4a4d16ccd7.png)\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-02 17.08.10.png](https://qiita-image-store.s3.amazonaws.com/0/139068/1aed28e7-bc00-7d91-5d62-bf9391beafae.png)\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-02 17.08.20.png](https://qiita-image-store.s3.amazonaws.com/0/139068/53fb905d-b367-7358-c773-c2fbe1236d1a.png)\n\n\n"}