{"context": " More than 1 year has passed since last update.FileList\u306e\u4e2d\u3067\u547c\u3093\u3067\u3044\u308bGetFilePathList\u95a2\u6570\u306b\u9069\u5207\u306b\u5f15\u6570\u3092\u6e21\u3057\u3066\u3042\u3052\u3066\u304f\u3060\u3055\u3044\u3002\n\u7b2c1\u5f15\u6570\u3067\u6307\u5b9a\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u3092\u518d\u5e30\u7684\u306b\u691c\u7d22\u3057\u3001\u7b2c2\u5f15\u6570\u3067\u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb(\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9OK)\n\u3092\u3001\u30b7\u30fc\u30c8\u306b\u5168\u90e8\u66f8\u304d\u51fa\u3057\u307e\u3059\u3002\nOption Explicit\n\nSub FileList()\n    Dim Files As Variant\n    Files = GetFilePathList(\"c:\\Samples\", \"*.pdf\")\n\n    Range(Cells(1, \"A\"), Cells(UBound(Files, 2), \"B\")) _\n        = Application.WorksheetFunction.Transpose(Files)\nEnd Sub\n\nPrivate Function GetFilePathList(Path As String, Target As String) As Variant\n    Dim FSO As Object, Folder As Variant, File As Variant\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n\n    Dim Files() As Variant\n    ReDim Preserve Files(1, 0)\n\n    For Each Folder In FSO.GetFolder(Path).SubFolders\n        Dim SubFiles() As Variant\n        SubFiles = GetFilePathList(Folder.Path, Target)\n\n        Dim FromIndex As Integer\n        Dim ToIndex As Integer\n\n        FromIndex = UBound(Files, 2)\n        ToIndex = FromIndex + UBound(SubFiles, 2)\n        ReDim Preserve Files(1, ToIndex)\n        Dim i As Integer\n        For i = FromIndex To ToIndex\n            Files(0, i) = SubFiles(0, i - FromIndex)\n            Files(1, i) = SubFiles(1, i - FromIndex)\n        Next i\n    Next Folder\n\n\n    For Each File In FSO.GetFolder(Path).Files\n        If File.Name Like Target Then\n            ReDim Preserve Files(1, UBound(Files, 2) + 1)\n            Files(0, UBound(Files, 2) - 1) = File.ParentFolder\n            Files(1, UBound(Files, 2) - 1) = File.Name\n        End If\n    Next File\n\n    GetFilePathList = Files\nEnd Function\n\n\n\u53c2\u8003\u30b5\u30a4\u30c8\nOffice Tanaka(1)\nOffice Tanaka(2)\nhiroaki's Lab\nFileList\u306e\u4e2d\u3067\u547c\u3093\u3067\u3044\u308b`GetFilePathList`\u95a2\u6570\u306b\u9069\u5207\u306b\u5f15\u6570\u3092\u6e21\u3057\u3066\u3042\u3052\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u7b2c1\u5f15\u6570\u3067\u6307\u5b9a\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u3092\u518d\u5e30\u7684\u306b\u691c\u7d22\u3057\u3001\u7b2c2\u5f15\u6570\u3067\u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb(\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9OK)\n\u3092\u3001\u30b7\u30fc\u30c8\u306b\u5168\u90e8\u66f8\u304d\u51fa\u3057\u307e\u3059\u3002\n\n```vb\nOption Explicit\n\nSub FileList()\n    Dim Files As Variant\n    Files = GetFilePathList(\"c:\\Samples\", \"*.pdf\")\n    \n    Range(Cells(1, \"A\"), Cells(UBound(Files, 2), \"B\")) _\n        = Application.WorksheetFunction.Transpose(Files)\nEnd Sub\n\nPrivate Function GetFilePathList(Path As String, Target As String) As Variant\n    Dim FSO As Object, Folder As Variant, File As Variant\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    \n    \n    Dim Files() As Variant\n    ReDim Preserve Files(1, 0)\n    \n    For Each Folder In FSO.GetFolder(Path).SubFolders\n        Dim SubFiles() As Variant\n        SubFiles = GetFilePathList(Folder.Path, Target)\n        \n        Dim FromIndex As Integer\n        Dim ToIndex As Integer\n        \n        FromIndex = UBound(Files, 2)\n        ToIndex = FromIndex + UBound(SubFiles, 2)\n        ReDim Preserve Files(1, ToIndex)\n        Dim i As Integer\n        For i = FromIndex To ToIndex\n            Files(0, i) = SubFiles(0, i - FromIndex)\n            Files(1, i) = SubFiles(1, i - FromIndex)\n        Next i\n    Next Folder\n    \n    \n    For Each File In FSO.GetFolder(Path).Files\n        If File.Name Like Target Then\n            ReDim Preserve Files(1, UBound(Files, 2) + 1)\n            Files(0, UBound(Files, 2) - 1) = File.ParentFolder\n            Files(1, UBound(Files, 2) - 1) = File.Name\n        End If\n    Next File\n    \n    GetFilePathList = Files\nEnd Function\n```\n\n## \u53c2\u8003\u30b5\u30a4\u30c8\n[Office Tanaka(1)](http://officetanaka.net/excel/vba/tips/tips36.htm)\n[Office Tanaka(2)](http://officetanaka.net/excel/vba/filesystemobject/file.htm)\n[hiroaki's Lab](http://hiroakis-lab.net/entries/entry/121?type=date)\n", "tags": ["ExcelVBA"]}