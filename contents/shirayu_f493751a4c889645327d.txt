{"context": "\n\n\u6982\u8981 (Abstract)\nwercker\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ec\u30dd\u30b8\u30c8\u30ea\u3067\u3082\u7121\u6599\u3067CI\u3067\u304d\u307e\u3059\uff0e\nOn wercker, you can construct CI environments at no charge even for private repositories.\n\u3053\u306e\u8a18\u4e8b\u3067\u306fwercker\u3067bitbucket.org\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u306aGo\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3046\u65b9\u6cd5\u3092\u8ff0\u3079\u307e\u3059\uff0e\nThis post explains how to use private Go libraries on bitbucket.org on wercker.\n\n\u554f\u984c (Problem)\n\u4ee5\u4e0b\u306f\u3042\u308bGo\u30d7\u30ed\u30b0\u30e9\u30e0\u306ewercker.yml\u306e\u4f8b\u3067\u3059\uff0e\nThis is a sample of wercker.yml of a Go program.\n\nwercker.yml\nbox: golang:1.5\n\nbuild:\n    steps:\n        - setup-go-workspace\n        - script:\n            name: go build\n            code: |\n                go get -t ./...\n                go build ./...\n\n\n\u305d\u306eGo\u30ec\u30dd\u30b8\u30c8\u30ea\u3067\uff0c\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ec\u30dd\u30b8\u30c8\u30ea\u306e\u30e9\u30a4\u30d6\u30e9\u30eabitbucket.org/yourname/a-private-go-library\u3092\u4f7f\u3063\u3066\u3044\u308b\u3068\u6b21\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3057\u307e\u3044\u307e\u3059\uff0e\nYou will have the following error, if you use the library on private repository bitbucket.org/yourname/a-private-go-library in the Go program.\n\n go build\nCommand cancelled due to error\npackage bitbucket.org/yourname/a-go-program: https://api.bitbucket.org/1.0/repositories/yourname/a-private-go-library: 403 FORBIDDEN\n\n\n\u5bfe\u7b56 (Solution)\n\n\nwercker\u306e\u7ba1\u7406\u753b\u9762\u3067SSH\u9375\u3092\u4f5c\u308a\u307e\u3059 (Create a SSH key on wercker setting page)\n\n\u9375\u306e\u540d\u524d\u306f\u4f55\u3067\u3082\u826f\u3044\u3067\u3059\u3000(Any key name is OK.)\n\u4ee5\u4e0b\u3067\u306fFOO_KEY\u3068\u540d\u524d\u3092\u3064\u3051\u307e\u3057\u305f (Sample: FOO_KEY)\n\n\n\n\nPublic key\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059 (Copy the public key)\n\n\nbitbucket.org/yourname/a-private-go-library\u306e\u8a2d\u5b9a\u753b\u9762\u3092\u958b\u3044\u3066\u9375\u3092\u8ffd\u52a0\u3057\u307e\u3059 (Add the key on the setting page for bitbucket.org/yourname/a-private-go-library)\n\n\n\u30e9\u30d9\u30eb\u306e\u540d\u524d\u306f\u4f55\u3067\u3082\u826f\u3044\u3067\u3059\u3000(Any label name is OK.)\n\n\nwercker.yml\u3092\u6b21\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059 (Fix wercker.yml in the following way)\n\n\nwercker.yml\nbox: golang:1.5\n\nbuild:\n    steps:\n        - add-ssh-key:\n            keyname: FOO_KEY\n            host: bitbucket.org\n        - add-to-known_hosts:\n            hostname: bitbucket.org\n            fingerprint: 35:ee:d7:b8:ef:d7:79:e2:c6:43:9e:ab:40:6f:50:74\n        - setup-go-workspace\n        - script:\n            name: Clone private packages\n            code: |-\n              git clone git@bbitbucket.org/yourname/a-private-go-library.git $GOPATH/src/bitbucket.org/yourname/a-private-go-library\n        - script:\n            name: go build\n            code: |\n                go get -t ./...\n                go build ./...\n\n\n\u3053\u308c\u3067\u7d42\u308f\u308a\u3067\u3059\nThat's all !\n# \u6982\u8981 (Abstract)\n[wercker](http://wercker.com/)\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ec\u30dd\u30b8\u30c8\u30ea\u3067\u3082\u7121\u6599\u3067CI\u3067\u304d\u307e\u3059\uff0e\nOn [wercker](http://wercker.com/), you can construct CI environments at no charge even for private repositories.\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306fwercker\u3067``bitbucket.org``\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u306aGo\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3046\u65b9\u6cd5\u3092\u8ff0\u3079\u307e\u3059\uff0e\nThis post explains how to use private Go libraries on ``bitbucket.org`` on wercker.\n\n# \u554f\u984c (Problem)\n\u4ee5\u4e0b\u306f\u3042\u308bGo\u30d7\u30ed\u30b0\u30e9\u30e0\u306e``wercker.yml``\u306e\u4f8b\u3067\u3059\uff0e\nThis is a sample of ``wercker.yml`` of a Go program.\n\n```wercker.yml\nbox: golang:1.5\n\nbuild:\n    steps:\n        - setup-go-workspace\n        - script:\n            name: go build\n            code: |\n                go get -t ./...\n                go build ./...\n```\n\n\u305d\u306eGo\u30ec\u30dd\u30b8\u30c8\u30ea\u3067\uff0c\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ec\u30dd\u30b8\u30c8\u30ea\u306e\u30e9\u30a4\u30d6\u30e9\u30ea``bitbucket.org/yourname/a-private-go-library``\u3092\u4f7f\u3063\u3066\u3044\u308b\u3068\u6b21\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3057\u307e\u3044\u307e\u3059\uff0e\nYou will have the following error, if you use the library on private repository ``bitbucket.org/yourname/a-private-go-library`` in the Go program.\n\n\n## :x: go build\n```\nCommand cancelled due to error\npackage bitbucket.org/yourname/a-go-program: https://api.bitbucket.org/1.0/repositories/yourname/a-private-go-library: 403 FORBIDDEN\n```\n\n# \u5bfe\u7b56 (Solution)\n\n1. wercker\u306e\u7ba1\u7406\u753b\u9762\u3067SSH\u9375\u3092\u4f5c\u308a\u307e\u3059 (Create a SSH key on wercker setting page)\n    - \u9375\u306e\u540d\u524d\u306f\u4f55\u3067\u3082\u826f\u3044\u3067\u3059\u3000(Any key name is OK.)\n    - \u4ee5\u4e0b\u3067\u306f``FOO_KEY``\u3068\u540d\u524d\u3092\u3064\u3051\u307e\u3057\u305f (Sample: ``FOO_KEY``)\n![0.png](https://qiita-image-store.s3.amazonaws.com/0/50725/69d7fa5f-06fc-9f8a-2c66-0d6defc2a8d6.png)\n\n2. Public key\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059 (Copy the public key)\n![0-2.png](https://qiita-image-store.s3.amazonaws.com/0/50725/cba49e1e-2185-658e-9771-f294d52aa10c.png)\n\n3. ``bitbucket.org/yourname/a-private-go-library``\u306e\u8a2d\u5b9a\u753b\u9762\u3092\u958b\u3044\u3066\u9375\u3092\u8ffd\u52a0\u3057\u307e\u3059 (Add the key on the setting page for ``bitbucket.org/yourname/a-private-go-library``)\n![1.png](https://qiita-image-store.s3.amazonaws.com/0/50725/4629ec9e-efb2-3ef9-5e24-8d43f166eb3b.png)\n    - \u30e9\u30d9\u30eb\u306e\u540d\u524d\u306f\u4f55\u3067\u3082\u826f\u3044\u3067\u3059\u3000(Any label name is OK.)\n\n4. ``wercker.yml``\u3092\u6b21\u306e\u3088\u3046\u306b\u4fee\u6b63\u3057\u307e\u3059 (Fix ``wercker.yml`` in the following way)\n\n```wercker.yml\nbox: golang:1.5\n\nbuild:\n    steps:\n        - add-ssh-key:\n            keyname: FOO_KEY\n            host: bitbucket.org\n        - add-to-known_hosts:\n            hostname: bitbucket.org\n            fingerprint: 35:ee:d7:b8:ef:d7:79:e2:c6:43:9e:ab:40:6f:50:74\n        - setup-go-workspace\n        - script:\n            name: Clone private packages\n            code: |-\n              git clone git@bbitbucket.org/yourname/a-private-go-library.git $GOPATH/src/bitbucket.org/yourname/a-private-go-library\n        - script:\n            name: go build\n            code: |\n                go get -t ./...\n                go build ./...\n```\n\n\u3053\u308c\u3067\u7d42\u308f\u308a\u3067\u3059\nThat's all !\n", "tags": ["wercker", "golang", "Go"]}