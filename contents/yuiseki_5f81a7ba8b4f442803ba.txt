{"context": " More than 1 year has passed since last update.\u96fb\u8eca\u304c\u3061\u3083\u3093\u3068\u52d5\u3044\u3066\u308b\u304b\u3092\u30b3\u30fc\u30c9\u3067\u30c1\u30a7\u30c3\u30af\u3057\u305f\u3044\u6642\u7528\nGoogle\u691c\u7d22\u3067\u300c\u8def\u7dda\u540d\u3000\u904b\u884c\u60c5\u5831\u300d\u3068\u691c\u7d22\u3057\u305f\u3068\u304d\u306e\u7d50\u679c\u3092\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3059\u308b\u30c6\u30b9\u30c8\n\ngoogle-train.rb\n# -*- encoding: UTF-8 -*-\nrequire 'cgi'\nrequire 'open-uri'\nrequire 'nokogiri'\nrequire 'date'\nrequire 'json'\n\ndef get(word)\n  base = \"http://www.google.co.jp/search?num=1&lr=lang_ja&oe=utf-8&q=\"\n  url = \"#{base}#{CGI.escape(word+\" \u904b\u884c\u60c5\u5831\")}\"\n  html = open(url, 'User-Agent' => 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.52 Safari/536.5').read\n  doc = Nokogiri(html)\n  # \u904b\u884c\u60c5\u5831\u306ftable\u306b\u306a\u3063\u3066\u3044\u308b\n  table_data = doc.css('.obcontainer').css('table td')\n  # table td\u3092\u4e00\u884c\u3054\u3068\u306b\u914d\u5217\u306b\u3059\u308b\n  info_a = table_data.to_a.map!{|data| data.text}\n  # \u6700\u5f8c\u306e\u4e00\u884c\u306f\u6700\u7d42\u66f4\u65b0\u6642\u523b\u3067\u3042\u308b\n  begin\n    unixtime = DateTime.strptime(info_a[-1], \"%m\u6708%d\u65e5%H\u6642%M\u5206\u66f4\u65b0\").to_time.to_i\n  rescue\n    # Google\u3067\u904b\u884c\u60c5\u5831\u304c\u51fa\u3066\u3053\u306a\u3044\u8def\u7dda\u540d\u3060\u3068\u3053\u3053\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\n    p word+\" \u306fGoogle\u3067\u8abf\u3079\u3089\u308c\u307e\u305b\u3093\"\n  end \n  text = info_a[0..-2].join(\"\")\n\n  normal = false\n  type = nil \n  if info_a.size === 2 and info_a[0].sub(word, \"\") === \"\u306b\u9045\u308c\u306e\u60c5\u5831\u306f\u3042\u308a\u307e\u305b\u3093\u3002\"\n    # \u554f\u984c\u306e\u306a\u3044\u3068\u304d\u306f\u4e00\u884c\u76ee\u306b\u300c\uff08\u8def\u7dda\u540d\uff09\u306b\u9045\u308c\u306e\u60c5\u5831\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u300d\u3068\u8868\u793a\u3055\u308c\u308b\n    normal = true\n  else\n    # \u554f\u984c\u306e\u3042\u308b\u3068\u304d\u306f\u4e00\u884c\u76ee\u306e\u3010\u3011\u306b\u904b\u884c\u969c\u5bb3\u306e\u7a2e\u985e\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\n    info_a[0] =~ /^\u3010(.*)\u3011/u\n    type = $1\n  end \n  info = {unixtime:unixtime, text:text, is_normal:normal, type:type}\nend\n\nlines = JSON.parse(open(\"lines.json\").read)[\"response\"][\"line\"]\nlines.each do |word|\n  result = get(word)\n  p result if result[:is_normal] == false\n  sleep 1\nend\n\n\nhttp://express.heartrails.com/api.html#line\n\u306e\u30c7\u30fc\u30bf\u3092\u3082\u3068\u306b\u3001Google\u691c\u7d22\u3067\u904b\u884c\u60c5\u5831\u304c\u51fa\u3066\u3053\u306a\u3044\u8def\u7dda\u540d\u3092\u4fee\u6b63\u3057\u305f\u6771\u4eac\u90fd\u5185\u306e\u8def\u7dda\u540d\u4e00\u89a7\n\nlines.json\n{\"response\":{\"line\":[\"JR\u4e2d\u592e\u7dda\",\"JR\u4e2d\u592e\u672c\u7dda\",\"JR\u4e94\u65e5\u5e02\u7dda\",\"JR\u4eac\u6d5c\u6771\u5317\u7dda\",\"JR\u4eac\u8449\u7dda\",\"JR\u516b\u9ad8\u7dda\",\"JR\u5357\u6b66\u7dda\",\"JR\u57fc\u4eac\u7dda\",\"JR\u5b87\u90fd\u5bae\u7dda\",\"JR\u5c71\u624b\u7dda\",\"JR\u5e38\u78d0\u7dda\",\"JR\u6771\u6d77\u9053\u672c\u7dda\",\"JR\u6a2a\u6d5c\u7dda\",\"JR\u6a2a\u9808\u8cc0\u7dda\",\"JR\u6b66\u8535\u91ce\u7dda\",\"JR\u6e58\u5357\u65b0\u5bbf\u30e9\u30a4\u30f3\",\"JR\u7dcf\u6b66\u7dda\",\"JR\u9752\u6885\u7dda\",\"JR\u9ad8\u5d0e\u7dda\",\"\u3064\u304f\u3070\u30a8\u30af\u30b9\u30d7\u30ec\u30b9\",\"\u4e0a\u8d8a\u65b0\u5e79\u7dda\",\"\u4eac\u6210\u62bc\u4e0a\u7dda\",\"\u4eac\u6210\u672c\u7dda\",\"\u4eac\u6210\u91d1\u753a\u7dda\",\"\u4eac\u6025\u7a7a\u6e2f\u7dda\",\"\u4eac\u6025\u672c\u7dda\",\"\u4eac\u738b\u7dda\",\"\u4eac\u738b\u65b0\u7dda\",\"\u4eac\u738b\u4e95\u306e\u982d\u7dda\",\"\u4eac\u738b\u76f8\u6a21\u539f\u7dda\",\"\u4eac\u738b\u9ad8\u5c3e\u7dda\",\"\u4eac\u738b\u52d5\u7269\u5712\u7dda\",\"\u4eac\u738b\u7af6\u99ac\u5834\u7dda\",\"\u5317\u7dcf\u7dda\",\"\u5c0f\u7530\u6025\u591a\n\u6469\u7dda\",\"\u5c0f\u7530\u6025\u5c0f\u7530\u539f\u7dda\",\"\u3086\u308a\u304b\u3082\u3081\u7dda\",\"\u308a\u3093\u304b\u3044\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u4e38\u30ce\u5185\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u5343\u4ee3\u7530\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u534a\u8535\u9580\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u5357\u5317\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u65e5\u6bd4\u8c37\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u6709\u697d\u753a\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u6771\u897f\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u9280\u5ea7\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u526f\u90fd\u5fc3\u7dda\",\"\u6771\u4eac\u30e2\u30ce\u30ec\u30fc\u30eb\u7dda\",\"\u6771\u5317\u65b0\u5e79\u7dda\",\"\u6771\u6025\u4e16\u7530\u8c37\u7dda\",\"\u6771\u6025\u591a\u6469\u5ddd\u7dda\",\"\u6771\u6025\u5927\u4e95\u753a>\u7dda\",\"\u6771\u6025\u6771\u6a2a\u7dda\",\"\u6771\u6025\u6c60\u4e0a\u7dda\",\"\u6771\u6025\u7530\u5712\u90fd\u5e02\u7dda\",\"\u6771\u6025\u76ee\u9ed2\u7dda\",\"\u6771\u6b66\u4e80\u6238\u7dda\",\"\u6771\u6b66\u4f0a\u52e2\u5d0e\u7dda\",\"\u6771\u6b66\u5927\u5e2b\u7dda\",\"\u6771\u6b66\u6771\u4e0a\u7dda\",\"\u6771\u6d77\u9053\u65b0\u5e79\u7dda\",\"\u897f\u6b66\u56fd\u5206\u5bfa\u7dda\",\"\u897f\u6b66\u591a\u6469>\u5ddd\u7dda\",\"\u897f\u6b66\u591a\u6469\u6e56\u7dda\",\"\u897f\u6b66\u5c71\u53e3\u7dda\",\"\u897f\u6b66\u62dd\u5cf6\u7dda\",\"\u897f\u6b66\u65b0\u5bbf\u7dda\",\"\u897f\u6b66\u6709\u697d\u753a\u7dda\",\"\u897f\u6b66\u6c60\u888b\u7dda\",\"\u897f\u6b66\u897f\u6b66\u5712\u7dda\",\"\u897f\u6b66\u8c4a\u5cf6\u7dda\",\"\u90fd\u55b6\u4e09\u7530\u7dda\",\"\u90fd\u55b6\u5927\u6c5f\u6238\u7dda\",\"\u90fd\u55b6\u65b0\u5bbf>\u7dda\",\"\u90fd\u55b6\u6d45\u8349\u7dda\",\"\u90fd\u96fb\u8352\u5ddd\u7dda\",\"\u9577\u91ce\u65b0\u5e79\u7dda\",\"\u65e5\u66ae\u91cc\u30fb\u820e\u4eba\u30e9\u30a4\u30ca\u30fc\"]}}\n\n\n\u96fb\u8eca\u304c\u3061\u3083\u3093\u3068\u52d5\u3044\u3066\u308b\u304b\u3092\u30b3\u30fc\u30c9\u3067\u30c1\u30a7\u30c3\u30af\u3057\u305f\u3044\u6642\u7528\nGoogle\u691c\u7d22\u3067\u300c\u8def\u7dda\u540d\u3000\u904b\u884c\u60c5\u5831\u300d\u3068\u691c\u7d22\u3057\u305f\u3068\u304d\u306e\u7d50\u679c\u3092\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u3059\u308b\u30c6\u30b9\u30c8\n\n```ruby:google-train.rb\n# -*- encoding: UTF-8 -*-\nrequire 'cgi'\nrequire 'open-uri'\nrequire 'nokogiri'\nrequire 'date'\nrequire 'json'\n\ndef get(word)\n  base = \"http://www.google.co.jp/search?num=1&lr=lang_ja&oe=utf-8&q=\"\n  url = \"#{base}#{CGI.escape(word+\" \u904b\u884c\u60c5\u5831\")}\"\n  html = open(url, 'User-Agent' => 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.52 Safari/536.5').read\n  doc = Nokogiri(html)\n  # \u904b\u884c\u60c5\u5831\u306ftable\u306b\u306a\u3063\u3066\u3044\u308b\n  table_data = doc.css('.obcontainer').css('table td')\n  # table td\u3092\u4e00\u884c\u3054\u3068\u306b\u914d\u5217\u306b\u3059\u308b\n  info_a = table_data.to_a.map!{|data| data.text}\n  # \u6700\u5f8c\u306e\u4e00\u884c\u306f\u6700\u7d42\u66f4\u65b0\u6642\u523b\u3067\u3042\u308b\n  begin\n    unixtime = DateTime.strptime(info_a[-1], \"%m\u6708%d\u65e5%H\u6642%M\u5206\u66f4\u65b0\").to_time.to_i\n  rescue\n    # Google\u3067\u904b\u884c\u60c5\u5831\u304c\u51fa\u3066\u3053\u306a\u3044\u8def\u7dda\u540d\u3060\u3068\u3053\u3053\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\n    p word+\" \u306fGoogle\u3067\u8abf\u3079\u3089\u308c\u307e\u305b\u3093\"\n  end \n  text = info_a[0..-2].join(\"\")\n\n  normal = false\n  type = nil \n  if info_a.size === 2 and info_a[0].sub(word, \"\") === \"\u306b\u9045\u308c\u306e\u60c5\u5831\u306f\u3042\u308a\u307e\u305b\u3093\u3002\"\n    # \u554f\u984c\u306e\u306a\u3044\u3068\u304d\u306f\u4e00\u884c\u76ee\u306b\u300c\uff08\u8def\u7dda\u540d\uff09\u306b\u9045\u308c\u306e\u60c5\u5831\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u300d\u3068\u8868\u793a\u3055\u308c\u308b\n    normal = true\n  else\n    # \u554f\u984c\u306e\u3042\u308b\u3068\u304d\u306f\u4e00\u884c\u76ee\u306e\u3010\u3011\u306b\u904b\u884c\u969c\u5bb3\u306e\u7a2e\u985e\u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\n    info_a[0] =~ /^\u3010(.*)\u3011/u\n    type = $1\n  end \n  info = {unixtime:unixtime, text:text, is_normal:normal, type:type}\nend\n\nlines = JSON.parse(open(\"lines.json\").read)[\"response\"][\"line\"]\nlines.each do |word|\n  result = get(word)\n  p result if result[:is_normal] == false\n  sleep 1\nend\n```\n\nhttp://express.heartrails.com/api.html#line\n\u306e\u30c7\u30fc\u30bf\u3092\u3082\u3068\u306b\u3001Google\u691c\u7d22\u3067\u904b\u884c\u60c5\u5831\u304c\u51fa\u3066\u3053\u306a\u3044\u8def\u7dda\u540d\u3092\u4fee\u6b63\u3057\u305f\u6771\u4eac\u90fd\u5185\u306e\u8def\u7dda\u540d\u4e00\u89a7\n\n```javascript:lines.json\n{\"response\":{\"line\":[\"JR\u4e2d\u592e\u7dda\",\"JR\u4e2d\u592e\u672c\u7dda\",\"JR\u4e94\u65e5\u5e02\u7dda\",\"JR\u4eac\u6d5c\u6771\u5317\u7dda\",\"JR\u4eac\u8449\u7dda\",\"JR\u516b\u9ad8\u7dda\",\"JR\u5357\u6b66\u7dda\",\"JR\u57fc\u4eac\u7dda\",\"JR\u5b87\u90fd\u5bae\u7dda\",\"JR\u5c71\u624b\u7dda\",\"JR\u5e38\u78d0\u7dda\",\"JR\u6771\u6d77\u9053\u672c\u7dda\",\"JR\u6a2a\u6d5c\u7dda\",\"JR\u6a2a\u9808\u8cc0\u7dda\",\"JR\u6b66\u8535\u91ce\u7dda\",\"JR\u6e58\u5357\u65b0\u5bbf\u30e9\u30a4\u30f3\",\"JR\u7dcf\u6b66\u7dda\",\"JR\u9752\u6885\u7dda\",\"JR\u9ad8\u5d0e\u7dda\",\"\u3064\u304f\u3070\u30a8\u30af\u30b9\u30d7\u30ec\u30b9\",\"\u4e0a\u8d8a\u65b0\u5e79\u7dda\",\"\u4eac\u6210\u62bc\u4e0a\u7dda\",\"\u4eac\u6210\u672c\u7dda\",\"\u4eac\u6210\u91d1\u753a\u7dda\",\"\u4eac\u6025\u7a7a\u6e2f\u7dda\",\"\u4eac\u6025\u672c\u7dda\",\"\u4eac\u738b\u7dda\",\"\u4eac\u738b\u65b0\u7dda\",\"\u4eac\u738b\u4e95\u306e\u982d\u7dda\",\"\u4eac\u738b\u76f8\u6a21\u539f\u7dda\",\"\u4eac\u738b\u9ad8\u5c3e\u7dda\",\"\u4eac\u738b\u52d5\u7269\u5712\u7dda\",\"\u4eac\u738b\u7af6\u99ac\u5834\u7dda\",\"\u5317\u7dcf\u7dda\",\"\u5c0f\u7530\u6025\u591a\n\u6469\u7dda\",\"\u5c0f\u7530\u6025\u5c0f\u7530\u539f\u7dda\",\"\u3086\u308a\u304b\u3082\u3081\u7dda\",\"\u308a\u3093\u304b\u3044\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u4e38\u30ce\u5185\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u5343\u4ee3\u7530\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u534a\u8535\u9580\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u5357\u5317\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u65e5\u6bd4\u8c37\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u6709\u697d\u753a\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u6771\u897f\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u9280\u5ea7\u7dda\",\"\u6771\u4eac\u30e1\u30c8\u30ed\u526f\u90fd\u5fc3\u7dda\",\"\u6771\u4eac\u30e2\u30ce\u30ec\u30fc\u30eb\u7dda\",\"\u6771\u5317\u65b0\u5e79\u7dda\",\"\u6771\u6025\u4e16\u7530\u8c37\u7dda\",\"\u6771\u6025\u591a\u6469\u5ddd\u7dda\",\"\u6771\u6025\u5927\u4e95\u753a>\u7dda\",\"\u6771\u6025\u6771\u6a2a\u7dda\",\"\u6771\u6025\u6c60\u4e0a\u7dda\",\"\u6771\u6025\u7530\u5712\u90fd\u5e02\u7dda\",\"\u6771\u6025\u76ee\u9ed2\u7dda\",\"\u6771\u6b66\u4e80\u6238\u7dda\",\"\u6771\u6b66\u4f0a\u52e2\u5d0e\u7dda\",\"\u6771\u6b66\u5927\u5e2b\u7dda\",\"\u6771\u6b66\u6771\u4e0a\u7dda\",\"\u6771\u6d77\u9053\u65b0\u5e79\u7dda\",\"\u897f\u6b66\u56fd\u5206\u5bfa\u7dda\",\"\u897f\u6b66\u591a\u6469>\u5ddd\u7dda\",\"\u897f\u6b66\u591a\u6469\u6e56\u7dda\",\"\u897f\u6b66\u5c71\u53e3\u7dda\",\"\u897f\u6b66\u62dd\u5cf6\u7dda\",\"\u897f\u6b66\u65b0\u5bbf\u7dda\",\"\u897f\u6b66\u6709\u697d\u753a\u7dda\",\"\u897f\u6b66\u6c60\u888b\u7dda\",\"\u897f\u6b66\u897f\u6b66\u5712\u7dda\",\"\u897f\u6b66\u8c4a\u5cf6\u7dda\",\"\u90fd\u55b6\u4e09\u7530\u7dda\",\"\u90fd\u55b6\u5927\u6c5f\u6238\u7dda\",\"\u90fd\u55b6\u65b0\u5bbf>\u7dda\",\"\u90fd\u55b6\u6d45\u8349\u7dda\",\"\u90fd\u96fb\u8352\u5ddd\u7dda\",\"\u9577\u91ce\u65b0\u5e79\u7dda\",\"\u65e5\u66ae\u91cc\u30fb\u820e\u4eba\u30e9\u30a4\u30ca\u30fc\"]}}\n```", "tags": ["Ruby", "Nokogiri", "google", "\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0"]}