{"context": "\n\n\u74b0\u5883\n$ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 14.04.5 LTS\nRelease:        14.04\nCodename:       trusty\n\n$ uname -srvmo\nLinux 4.4.0-45-generic #66~14.04.1-Ubuntu SMP Wed Oct 19 15:05:38 UTC 2016 x86_64 GNU/Linux\n\n$ cat /proc/meminfo | grep ^Mem\nMemTotal:       16306348 kB\nMemFree:         4981548 kB\nMemAvailable:   12620380 kB\n\n\n\u53c2\u8003\n\ngalexrt/zulip - Docker Hub\ngalexrt/docker-zulip: Zulip Server as a Docker Image\nInstallation on Ubuntu - Docker\nInstall Docker Compose - Docker\n\n\n\u6e96\u5099\n\ndocker\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30ea\u30dd\u30b8\u30c8\u30ea\u8a2d\u5b9a\n$ sudo aptitude update\n$ sudo aptitude install apt-transport-https ca-certificates\n$ sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D\n$ echo \"deb https://apt.dockerproject.org/repo ubuntu-trusty main\" | sudo tee /etc/apt/sources.list.d/docker.list\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo aptitude update\n$ apt-cache policy docker-engine\n$ sudo aptitutde install docker-engine\n\n\u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\n$ sudo service docker start\n\n\u30e6\u30fc\u30b6\u3092docker\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\n$ sudo gpasswd -a $USER docker\n\n\ndocker-compose\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ndocker-compose\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\u203b\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30b3\u30d4\u30fc\u3059\u308b\u3060\u3051\u3067\u30b5\u30fc\u30d0\u306e\u5f15\u8d8a\u3057\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3001\u30d0\u30a4\u30ca\u30ea\u3092\u7f6e\u304f\u3060\u3051\u3067\u4f7f\u3048\u308b\u3088\u3046\u306a\u30c4\u30fc\u30eb\u306f\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u7f6e\u304f\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n$ curl -L https://github.com/docker/compose/releases/download/1.8.1/docker-compose-`uname -s`-`uname -m` > ~/bin/docker-compose\n$ chmod +x ~/bin/docker-compose\n\n$ docker-compose -v\ndocker-compose version 1.8.1, build 878cff1\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\ndocker-zulip\u30b3\u30fc\u30c9\u53d6\u5f97\n$ cd ~/git\n$ git clone https://github.com/galexrt/docker-zulip.git\n\n\ndocker-zulip\u8a2d\u5b9a\u5909\u66f4\nSETTING_NOREPLY_EMAIL_ADDRESS \u304c noreply@example.com \u306e\u307e\u307e\u3060\u3068\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u4e2d\u65ad\u3055\u308c\u308b\u3051\u3069\u3001\u4ed6\u306f\u4f55\u3082\u30c1\u30a7\u30c3\u30af\u3055\u308c\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\u8a66\u3057\u306b\u4f7f\u3063\u3066\u307f\u308b\u3060\u3051\u306a\u306e\u3067 example.com \u3092 home.local \u306b\u7f6e\u304d\u63db\u3048\u308b\u306e\u3068\u30dd\u30fc\u30c8\u756a\u53f7\u306e\u5909\u66f4\u3060\u3051\u306b\u3057\u307e\u3057\u305f\u3002\n$ cd docker-zulip\n$ sed -i 's/example\\.com/home.local/g' docker-compose.yml\n$ sed -i 's/80:80/10080:80/g' docker-compose.yml\n$ sed -i 's/443:443/10443:443/g' docker-compose.yml\n\n--- a/docker-compose.yml\n+++ b/docker-compose.yml\n@@ -23,8 +23,8 @@ redis:\n zulip:\n   image: \"quay.io/galexrt/zulip:1.4.2\"\n   ports:\n-    - \"80:80\"\n-    - \"443:443\"\n+    - \"10080:80\"\n+    - \"10443:443\"\n   links:\n     - database\n     - memcached\n@@ -41,17 +41,17 @@ zulip:\n     SECRETS_email_password: \"123456789\"\n     SECRETS_rabbitmq_password: \"zulip\"\n     SECRETS_secret_key: \"REPLCAE_WITH_SECURE_SECRET_KEY\"\n-    SETTING_EXTERNAL_HOST: \"example.com\"\n-    SETTING_ZULIP_ADMINISTRATOR: \"admin@example.com\"\n-    SETTING_ADMIN_DOMAIN: \"example.com\"\n-    SETTING_NOREPLY_EMAIL_ADDRESS: \"noreply@example.com\"\n-    SETTING_DEFAULT_FROM_EMAIL: \"Zulip <noreply@example.com>\"\n-    SETTING_EMAIL_HOST: \"smtp.example.com\"\n-    SETTING_EMAIL_HOST_USER: \"noreply@example.com\"\n+    SETTING_EXTERNAL_HOST: \"home.local\"\n+    SETTING_ZULIP_ADMINISTRATOR: \"admin@home.local\"\n+    SETTING_ADMIN_DOMAIN: \"home.local\"\n+    SETTING_NOREPLY_EMAIL_ADDRESS: \"noreply@home.local\"\n+    SETTING_DEFAULT_FROM_EMAIL: \"Zulip <noreply@home.local>\"\n+    SETTING_EMAIL_HOST: \"smtp.home.local\"\n+    SETTING_EMAIL_HOST_USER: \"noreply@home.local\"\n     SETTING_ALLOWED_HOSTS: \"[ '*', '127.0.0.2' ]\"\n     ZULIP_AUTH_BACKENDS: \"EmailAuthBackend\"\n-    ZULIP_USER_EMAIL: \"example@example.com\"\n+    ZULIP_USER_EMAIL: \"example@home.local\"\n     ZULIP_USER_PASS: \"zulip\"\n-    ZULIP_USER_DOMAIN: \"example.com\"\n+    ZULIP_USER_DOMAIN: \"home.local\"\n   volumes:\n     - \"/opt/docker/zulip/zulip:/data:rw\"\n\n\ndocker-zulip\u5b9f\u884c\n$ docker-compose up\n\nCreating dockerzulip_redis_1\nCreating dockerzulip_memcached_1\nCreating dockerzulip_rabbitmq_1\nCreating dockerzulip_database_1\nCreating dockerzulip_zulip_1\nAttaching to dockerzulip_redis_1, dockerzulip_memcached_1, dockerzulip_rabbitmq_1, dockerzulip_database_1, dockerzulip_zulip_1\n\n\u226a\u7701\u7565\u226b\n\nrabbitmq_1   |\nrabbitmq_1   | =INFO REPORT==== 6-Nov-2016::01:46:20 ===\nrabbitmq_1   | accepting AMQP connection <0.513.0> (172.17.0.5:40066 -> 172.17.0.4:5672)\nrabbitmq_1   |\nrabbitmq_1   | =INFO REPORT==== 6-Nov-2016::01:46:20 ===\nrabbitmq_1   | accepting AMQP connection <0.522.0> (172.17.0.5:40068 -> 172.17.0.4:5672)\nzulip_1      | 2016-11-06 01:46:21,104 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:21,151 INFO spawned: 'zulip-deliver-enqueued-emails' with pid 306\nzulip_1      | 2016-11-06 01:46:21,481 INFO exited: zulip-postsetup-create_user (exit status 0; expected)\nzulip_1      | 2016-11-06 01:46:21,903 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:22,906 INFO spawned: 'zulip-deliver-enqueued-emails' with pid 311\nzulip_1      | 2016-11-06 01:46:23,872 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:26,644 INFO spawned: 'zulip-deliver-enqueued-emails' with pid 316\nzulip_1      | 2016-11-06 01:46:27,639 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:31,643 INFO spawned: 'zulip-deliver-enqueued-emails' with pid 321\nzulip_1      | 2016-11-06 01:46:32,626 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:33,628 INFO gave up: zulip-deliver-enqueued-emails entered FATAL state, too many start retries too quickly\n\nFATAL\u304c\u51fa\u3066\u3044\u308b\u306e\u304c\u6c17\u306b\u306a\u308b\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u52d5\u304d\u307e\u3057\u305f\u3002\nhttps://192.168.0.200:10443/\n\ndocker-compose.yml\u3067\u8a2d\u5b9a\u3057\u305fZULIP_USER_EMAIL\u3001ZULIP_USER_PASS\u3067\u30e6\u30fc\u30b6\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u304c\u3001\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u5c11\u3057\u8abf\u3079\u3066\u307f\u305f\u3068\u3053\u308d\u3001\u3069\u3046\u3084\u3089\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8ff0\u3057\u305f\u30e6\u30fc\u30b6\u306f\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u3088\u3046\u3002\u30ec\u30eb\u30e0\u3092\u4f5c\u6210\u3057\u3066\u304a\u304b\u306a\u3044\u3068\u30e6\u30fc\u30b6\u4f5c\u6210\u304c\u5931\u6557\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u30ec\u30eb\u30e0\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u51e6\u7406\u304c\u3069\u3053\u306b\u3082\u898b\u5f53\u305f\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u30ec\u30eb\u30e0\u306e\u4f5c\u6210\u3068\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u306e\u767b\u9332\u306f\u624b\u52d5\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30ec\u30eb\u30e0\u306e\u4f5c\u6210\u3068\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u306e\u767b\u9332\n# zulip\u30b3\u30f3\u30c6\u30ca\u306b\u63a5\u7d9a\n$ docker exec -it dockerzulip_zulip_1 /bin/bash\nroot# su - zulip\n$ cd deployments/current\n\n# \u30ec\u30eb\u30e0\u4f5c\u6210\n$ ./manage.py create_realm --domain=home.local --name='home'\n\n# \u30e6\u30fc\u30b6\u4f5c\u6210\n$ ./manage.py create_user --this-user-has-accepted-the-tos --domain home.local zulip@home.local 'Zulip'\n\n# \u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\n$ ./manage.py changepassword zulip@home.local\n\n# \u7ba1\u7406\u8005\u6a29\u9650\u4ed8\u4e0e\n$ ./manage.py knight -f zulip@home.local\n\n\u4f5c\u6210\u3057\u305f\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u3067\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\nhttps://192.168.0.200:10443/\n\n\ndocker-zulip\u524a\u9664\ndocker-compose\u306f\u7ba1\u7406\u5bfe\u8c61\u306e\u8907\u6570\u306e\u30b3\u30f3\u30c6\u30ca\u306e\u505c\u6b62\u304b\u3089\u524a\u9664\u307e\u3067\u3092\u30b3\u30de\u30f3\u30c9\u4e00\u767a\u3067\u884c\u3063\u3066\u304f\u308c\u308b\u306e\u3067\u4fbf\u5229\u3067\u3059\u3002\u30c7\u30fc\u30bf\u306f\u30db\u30b9\u30c8\u5074\u306b\u4fdd\u7ba1\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u3053\u308c\u306e\u524a\u9664\u3082\u884c\u3044\u307e\u3059\u3002\n$ docker-compose down\n$ sudo rm -rf /opt/docker/zulip\n\n\n\u611f\u60f3\n\u30c7\u30fc\u30bf\u3092\u30db\u30b9\u30c8\u4e0a\u306b\u4fdd\u7ba1\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u308b\u305f\u3081\u3001zulip\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3059\u308b\u5834\u5408\u306f\u30b3\u30f3\u30c6\u30ca\u3092\u5165\u308c\u66ff\u3048\u308b\u3060\u3051\u3067\u6e08\u307f\u3001\u904b\u7528\u304c\u3068\u3066\u3082\u697d\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u306a\u3044\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u74b0\u5883\u3067zulip\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3053\u308c\u3057\u304b\u306a\u3044\u3068\u3044\u3063\u305f\u611f\u3058\u3002\n\n\u304a\u307e\u3051\nzulip\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u539f\u56e0\u3092\u8abf\u3079\u305f\u3068\u304d\u306e\u30e1\u30e2\u3068\u304b\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5185\u5bb9\u78ba\u8a8d\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\n$ docker exec -it dockerzulip_zulip_1 /bin/bash\nroot# psql -h database -U zulip\n\n# \u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\nzulip=> \\d\n\nWARNING: terminal is not fully functional\n                           List of relations\n Schema |                    Name                    |   Type   | Owner\n--------+--------------------------------------------+----------+-------\n zulip  | auth_group                                 | table    | zulip\n zulip  | auth_group_id_seq                          | sequence | zulip\n zulip  | auth_group_permissions                     | table    | zulip\n zulip  | auth_group_permissions_id_seq              | sequence | zulip\n zulip  | auth_permission                            | table    | zulip\n zulip  | auth_permission_id_seq                     | sequence | zulip\n zulip  | confirmation_confirmation                  | table    | zulip\n zulip  | confirmation_confirmation_id_seq           | sequence | zulip\n zulip  | confirmation_realmcreationkey              | table    | zulip\n zulip  | confirmation_realmcreationkey_id_seq       | sequence | zulip\n zulip  | django_content_type                        | table    | zulip\n zulip  | django_content_type_id_seq                 | sequence | zulip\n zulip  | django_migrations                          | table    | zulip\n zulip  | django_migrations_id_seq                   | sequence | zulip\n zulip  | django_session                             | table    | zulip\n zulip  | django_site                                | table    | zulip\n zulip  | django_site_id_seq                         | sequence | zulip\n zulip  | fts_update_log                             | table    | zulip\n zulip  | fts_update_log_id_seq                      | sequence | zulip\n zulip  | guardian_groupobjectpermission             | table    | zulip\n zulip  | guardian_groupobjectpermission_id_seq      | sequence | zulip\n zulip  | guardian_userobjectpermission              | table    | zulip\n zulip  | guardian_userobjectpermission_id_seq       | sequence | zulip\n zulip  | third_party_api_results                    | table    | zulip\n zulip  | zerver_attachment                          | table    | zulip\n zulip  | zerver_attachment_id_seq                   | sequence | zulip\n zulip  | zerver_attachment_messages                 | table    | zulip\n zulip  | zerver_attachment_messages_id_seq          | sequence | zulip\n zulip  | zerver_client                              | table    | zulip\n zulip  | zerver_client_id_seq                       | sequence | zulip\n zulip  | zerver_defaultstream                       | table    | zulip\n zulip  | zerver_defaultstream_id_seq                | sequence | zulip\n zulip  | zerver_huddle                              | table    | zulip\n zulip  | zerver_huddle_id_seq                       | sequence | zulip\n zulip  | zerver_message                             | table    | zulip\n zulip  | zerver_message_id_seq                      | sequence | zulip\n zulip  | zerver_preregistrationuser                 | table    | zulip\n zulip  | zerver_preregistrationuser_id_seq          | sequence | zulip\n zulip  | zerver_preregistrationuser_streams         | table    | zulip\n zulip  | zerver_preregistrationuser_streams_id_seq  | sequence | zulip\n zulip  | zerver_pushdevicetoken                     | table    | zulip\n zulip  | zerver_pushdevicetoken_id_seq              | sequence | zulip\n zulip  | zerver_realm                               | table    | zulip\n zulip  | zerver_realm_id_seq                        | sequence | zulip\n zulip  | zerver_realmalias                          | table    | zulip\n zulip  | zerver_realmalias_id_seq                   | sequence | zulip\n zulip  | zerver_realmemoji                          | table    | zulip\n zulip  | zerver_realmemoji_id_seq                   | sequence | zulip\n zulip  | zerver_realmfilter                         | table    | zulip\n zulip  | zerver_realmfilter_id_seq                  | sequence | zulip\n zulip  | zerver_recipient                           | table    | zulip\n zulip  | zerver_recipient_id_seq                    | sequence | zulip\n zulip  | zerver_referral                            | table    | zulip\n zulip  | zerver_referral_id_seq                     | sequence | zulip\n zulip  | zerver_scheduledjob                        | table    | zulip\n zulip  | zerver_scheduledjob_id_seq                 | sequence | zulip\n zulip  | zerver_stream                              | table    | zulip\n zulip  | zerver_stream_id_seq                       | sequence | zulip\n zulip  | zerver_subscription                        | table    | zulip\n zulip  | zerver_subscription_id_seq                 | sequence | zulip\n zulip  | zerver_useractivity                        | table    | zulip\n zulip  | zerver_useractivity_id_seq                 | sequence | zulip\n zulip  | zerver_useractivityinterval                | table    | zulip\n zulip  | zerver_useractivityinterval_id_seq         | sequence | zulip\n zulip  | zerver_usermessage                         | table    | zulip\n zulip  | zerver_usermessage_id_seq                  | sequence | zulip\n zulip  | zerver_userpresence                        | table    | zulip\n zulip  | zerver_userpresence_id_seq                 | sequence | zulip\n zulip  | zerver_userprofile                         | table    | zulip\n zulip  | zerver_userprofile_groups                  | table    | zulip\n zulip  | zerver_userprofile_groups_id_seq           | sequence | zulip\n zulip  | zerver_userprofile_id_seq                  | sequence | zulip\n zulip  | zerver_userprofile_user_permissions        | table    | zulip\n zulip  | zerver_userprofile_user_permissions_id_seq | sequence | zulip\n(74 rows)\n\n\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u7ba1\u7406\u3057\u3066\u3044\u308b\u3068\u601d\u308f\u308c\u308b\u30c6\u30fc\u30d6\u30eb\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3059\u308b\u3002\uff08\u30d5\u30a3\u30fc\u30eb\u30c9\u306f \\d zerver_userprofile\u3067\u8abf\u3079\u305f\uff09\n# \u30e6\u30fc\u30b6\u4e00\u89a7\nzulip=> select email,domain from zerver_userprofile,zerver_realm where zerver_userprofile.realm_id=zerver_realm.id;\n\n            email             |   domain\n------------------------------+------------\n emailgateway@zulip.com       | zulip.com\n welcome-bot@zulip.com        | zulip.com\n notification-bot@zulip.com   | zulip.com\n nagios-send-bot@zulip.com    | zulip.com\n nagios-receive-bot@zulip.com | zulip.com\n feedback@zulip.com           | zulip.com\n(6 rows)\n\n\u30ec\u30eb\u30e0\u306e\u4e00\u89a7\u3092\u78ba\u8a8d\u3059\u308b\u3002\nzulip=> select domain,name from zerver_realm;\n\n   domain   | name\n------------+------\n zulip.com  |\n(1 rows)\n\ndocker-compose.yml\u3067\u8a2d\u5b9a\u3057\u305fZULIP_USER_DOMAIN\u3001ZULIP_USER_EMAIL\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u5206\u304b\u3063\u305f\u3002\ndocker-zulip\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u3067ZULIP_USER_DOMAIN\u3001ZULIP_USER_EMAIL\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u7b87\u6240\u3092\u8abf\u3079\u308b\u3002\n$ grep -R '\\(ZULIP_USER_DOMAIN\\|ZULIP_USER_EMAIL\\)' .\n\n./includes/createZulipAdmin.sh:if [ ! -z \"$ZULIP_USER_CREATION_ENABLED\" ] && ([ -z \"$ZULIP_USER_DOMAIN\" ] || [ -z \"$ZULIP_USER_EMAIL\" ]); then\n./includes/createZulipAdmin.sh:    realm = get_realm('$ZULIP_USER_DOMAIN')\n./includes/createZulipAdmin.sh:    create_user('$ZULIP_USER_EMAIL', '$ZULIP_USER_PASS', realm, '$ZULIP_USER_FULLNAME', email_to_username('$ZULIP_USER_EMAIL'))\n./includes/createZulipAdmin.sh:User = get_user_profile_by_email(email='$ZULIP_USER_EMAIL')\n./kubernetes/zulip-rc.yml:        - name: ZULIP_USER_EMAIL\n./kubernetes/zulip-rc.yml:        - name: ZULIP_USER_DOMAIN\n./docker-entrypoint.sh:export ZULIP_USER_DOMAIN=\"${ZULIP_USER_DOMAIN:-$(echo $SETTING_EXTERNAL_HOST)}\"\n./docker-entrypoint.sh:export ZULIP_USER_EMAIL=\"${ZULIP_USER_EMAIL:-}\"\n./docker-compose.yml:    ZULIP_USER_EMAIL: \"example@home.local\"\n./docker-compose.yml:    ZULIP_USER_DOMAIN: \"home.local\"\n\n./includes/createZulipAdmin.sh\u3067\u30e6\u30fc\u30b6\u4f5c\u6210\u3092\u884c\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\nmanager.py \u3067\u30e6\u30fc\u30b6\u4f5c\u6210\u3059\u308b\u969b\u306b--domain\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3053\u3068\u304b\u3089\u3001\u30e6\u30fc\u30b6\u4f5c\u6210\u306e\u524d\u306b\u30c9\u30e1\u30a4\u30f3\uff08realm\uff09\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u306f\u305a\u3060\u304c\u3001realm = get_realm('$ZULIP_USER_DOMAIN')\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u51e6\u7406\u304c\u3042\u308b\u3060\u3051\u3067\u3001\u30c9\u30e1\u30a4\u30f3\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u500b\u6240\u304c\u306a\u3044\u3002\n\u30c9\u30e1\u30a4\u30f3\u53d6\u5f97\u306b\u5931\u6557\u3057\u305f\u3089\u30c9\u30e1\u30a4\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3068\u3044\u3046\u51e6\u7406\u304c\u5fc5\u8981\u3068\u601d\u308f\u308c\u308b\u3002\n\u74b0\u5883\n====\n\n```sh\n$ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 14.04.5 LTS\nRelease:        14.04\nCodename:       trusty\n```\n```sh\n$ uname -srvmo\nLinux 4.4.0-45-generic #66~14.04.1-Ubuntu SMP Wed Oct 19 15:05:38 UTC 2016 x86_64 GNU/Linux\n```\n```sh\n$ cat /proc/meminfo | grep ^Mem\nMemTotal:       16306348 kB\nMemFree:         4981548 kB\nMemAvailable:   12620380 kB\n```\n\n\u53c2\u8003\n====\n\n* [galexrt/zulip - Docker Hub](https://hub.docker.com/r/galexrt/zulip/)\n* [galexrt/docker-zulip: Zulip Server as a Docker Image](https://github.com/galexrt/docker-zulip)\n* [Installation on Ubuntu - Docker](https://docs.docker.com/engine/installation/linux/ubuntulinux/)\n* [Install Docker Compose - Docker](https://docs.docker.com/compose/install/)\n\n\n\u6e96\u5099\n====\n\n### docker\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u8a2d\u5b9a\n\n```sh\n$ sudo aptitude update\n$ sudo aptitude install apt-transport-https ca-certificates\n$ sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D\n$ echo \"deb https://apt.dockerproject.org/repo ubuntu-trusty main\" | sudo tee /etc/apt/sources.list.d/docker.list\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```sh\n$ sudo aptitude update\n$ apt-cache policy docker-engine\n$ sudo aptitutde install docker-engine\n```\n\n\u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\n\n```sh\n$ sudo service docker start\n```\n\n\u30e6\u30fc\u30b6\u3092docker\u30b0\u30eb\u30fc\u30d7\u306b\u8ffd\u52a0\n\n```sh\n$ sudo gpasswd -a $USER docker\n```\n\n### docker-compose\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\ndocker-compose\u3092\u4f7f\u7528\u3059\u308b\u306e\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\u203b\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30b3\u30d4\u30fc\u3059\u308b\u3060\u3051\u3067\u30b5\u30fc\u30d0\u306e\u5f15\u8d8a\u3057\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3001\u30d0\u30a4\u30ca\u30ea\u3092\u7f6e\u304f\u3060\u3051\u3067\u4f7f\u3048\u308b\u3088\u3046\u306a\u30c4\u30fc\u30eb\u306f\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u7f6e\u304f\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```sh\n$ curl -L https://github.com/docker/compose/releases/download/1.8.1/docker-compose-`uname -s`-`uname -m` > ~/bin/docker-compose\n$ chmod +x ~/bin/docker-compose\n```\n```sh\n$ docker-compose -v\ndocker-compose version 1.8.1, build 878cff1\n```\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n============\n\n### docker-zulip\u30b3\u30fc\u30c9\u53d6\u5f97\n\n```sh\n$ cd ~/git\n$ git clone https://github.com/galexrt/docker-zulip.git\n```\n\n### docker-zulip\u8a2d\u5b9a\u5909\u66f4\n\nSETTING_NOREPLY_EMAIL_ADDRESS \u304c `noreply@example.com` \u306e\u307e\u307e\u3060\u3068\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u4e2d\u65ad\u3055\u308c\u308b\u3051\u3069\u3001\u4ed6\u306f\u4f55\u3082\u30c1\u30a7\u30c3\u30af\u3055\u308c\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\u8a66\u3057\u306b\u4f7f\u3063\u3066\u307f\u308b\u3060\u3051\u306a\u306e\u3067 example.com \u3092 home.local \u306b\u7f6e\u304d\u63db\u3048\u308b\u306e\u3068\u30dd\u30fc\u30c8\u756a\u53f7\u306e\u5909\u66f4\u3060\u3051\u306b\u3057\u307e\u3057\u305f\u3002\n\n```sh\n$ cd docker-zulip\n$ sed -i 's/example\\.com/home.local/g' docker-compose.yml\n$ sed -i 's/80:80/10080:80/g' docker-compose.yml\n$ sed -i 's/443:443/10443:443/g' docker-compose.yml\n```\n```diff\n--- a/docker-compose.yml\n+++ b/docker-compose.yml\n@@ -23,8 +23,8 @@ redis:\n zulip:\n   image: \"quay.io/galexrt/zulip:1.4.2\"\n   ports:\n-    - \"80:80\"\n-    - \"443:443\"\n+    - \"10080:80\"\n+    - \"10443:443\"\n   links:\n     - database\n     - memcached\n@@ -41,17 +41,17 @@ zulip:\n     SECRETS_email_password: \"123456789\"\n     SECRETS_rabbitmq_password: \"zulip\"\n     SECRETS_secret_key: \"REPLCAE_WITH_SECURE_SECRET_KEY\"\n-    SETTING_EXTERNAL_HOST: \"example.com\"\n-    SETTING_ZULIP_ADMINISTRATOR: \"admin@example.com\"\n-    SETTING_ADMIN_DOMAIN: \"example.com\"\n-    SETTING_NOREPLY_EMAIL_ADDRESS: \"noreply@example.com\"\n-    SETTING_DEFAULT_FROM_EMAIL: \"Zulip <noreply@example.com>\"\n-    SETTING_EMAIL_HOST: \"smtp.example.com\"\n-    SETTING_EMAIL_HOST_USER: \"noreply@example.com\"\n+    SETTING_EXTERNAL_HOST: \"home.local\"\n+    SETTING_ZULIP_ADMINISTRATOR: \"admin@home.local\"\n+    SETTING_ADMIN_DOMAIN: \"home.local\"\n+    SETTING_NOREPLY_EMAIL_ADDRESS: \"noreply@home.local\"\n+    SETTING_DEFAULT_FROM_EMAIL: \"Zulip <noreply@home.local>\"\n+    SETTING_EMAIL_HOST: \"smtp.home.local\"\n+    SETTING_EMAIL_HOST_USER: \"noreply@home.local\"\n     SETTING_ALLOWED_HOSTS: \"[ '*', '127.0.0.2' ]\"\n     ZULIP_AUTH_BACKENDS: \"EmailAuthBackend\"\n-    ZULIP_USER_EMAIL: \"example@example.com\"\n+    ZULIP_USER_EMAIL: \"example@home.local\"\n     ZULIP_USER_PASS: \"zulip\"\n-    ZULIP_USER_DOMAIN: \"example.com\"\n+    ZULIP_USER_DOMAIN: \"home.local\"\n   volumes:\n     - \"/opt/docker/zulip/zulip:/data:rw\"\n```\n\n\n### docker-zulip\u5b9f\u884c\n\n```sh\n$ docker-compose up\n```\n```shell-session\nCreating dockerzulip_redis_1\nCreating dockerzulip_memcached_1\nCreating dockerzulip_rabbitmq_1\nCreating dockerzulip_database_1\nCreating dockerzulip_zulip_1\nAttaching to dockerzulip_redis_1, dockerzulip_memcached_1, dockerzulip_rabbitmq_1, dockerzulip_database_1, dockerzulip_zulip_1\n\n\u226a\u7701\u7565\u226b\n\nrabbitmq_1   |\nrabbitmq_1   | =INFO REPORT==== 6-Nov-2016::01:46:20 ===\nrabbitmq_1   | accepting AMQP connection <0.513.0> (172.17.0.5:40066 -> 172.17.0.4:5672)\nrabbitmq_1   |\nrabbitmq_1   | =INFO REPORT==== 6-Nov-2016::01:46:20 ===\nrabbitmq_1   | accepting AMQP connection <0.522.0> (172.17.0.5:40068 -> 172.17.0.4:5672)\nzulip_1      | 2016-11-06 01:46:21,104 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:21,151 INFO spawned: 'zulip-deliver-enqueued-emails' with pid 306\nzulip_1      | 2016-11-06 01:46:21,481 INFO exited: zulip-postsetup-create_user (exit status 0; expected)\nzulip_1      | 2016-11-06 01:46:21,903 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:22,906 INFO spawned: 'zulip-deliver-enqueued-emails' with pid 311\nzulip_1      | 2016-11-06 01:46:23,872 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:26,644 INFO spawned: 'zulip-deliver-enqueued-emails' with pid 316\nzulip_1      | 2016-11-06 01:46:27,639 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:31,643 INFO spawned: 'zulip-deliver-enqueued-emails' with pid 321\nzulip_1      | 2016-11-06 01:46:32,626 INFO exited: zulip-deliver-enqueued-emails (exit status 1; not expected)\nzulip_1      | 2016-11-06 01:46:33,628 INFO gave up: zulip-deliver-enqueued-emails entered FATAL state, too many start retries too quickly\n```\n\nFATAL\u304c\u51fa\u3066\u3044\u308b\u306e\u304c\u6c17\u306b\u306a\u308b\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u52d5\u304d\u307e\u3057\u305f\u3002\nhttps://192.168.0.200:10443/\n![image](https://qiita-image-store.s3.amazonaws.com/0/14474/396e78ea-a352-adf8-9435-175a6ee9b4f1.png)\n\ndocker-compose.yml\u3067\u8a2d\u5b9a\u3057\u305fZULIP_USER_EMAIL\u3001ZULIP_USER_PASS\u3067\u30e6\u30fc\u30b6\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u304c\u3001\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u5c11\u3057\u8abf\u3079\u3066\u307f\u305f\u3068\u3053\u308d\u3001\u3069\u3046\u3084\u3089\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8ff0\u3057\u305f\u30e6\u30fc\u30b6\u306f\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u3088\u3046\u3002\u30ec\u30eb\u30e0\u3092\u4f5c\u6210\u3057\u3066\u304a\u304b\u306a\u3044\u3068\u30e6\u30fc\u30b6\u4f5c\u6210\u304c\u5931\u6557\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u30ec\u30eb\u30e0\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u51e6\u7406\u304c\u3069\u3053\u306b\u3082\u898b\u5f53\u305f\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n**\u30ec\u30eb\u30e0\u306e\u4f5c\u6210\u3068\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u306e\u767b\u9332\u306f\u624b\u52d5\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002**\n\n### \u30ec\u30eb\u30e0\u306e\u4f5c\u6210\u3068\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u306e\u767b\u9332\n\n```sh\n# zulip\u30b3\u30f3\u30c6\u30ca\u306b\u63a5\u7d9a\n$ docker exec -it dockerzulip_zulip_1 /bin/bash\nroot# su - zulip\n$ cd deployments/current\n\n# \u30ec\u30eb\u30e0\u4f5c\u6210\n$ ./manage.py create_realm --domain=home.local --name='home'\n\n# \u30e6\u30fc\u30b6\u4f5c\u6210\n$ ./manage.py create_user --this-user-has-accepted-the-tos --domain home.local zulip@home.local 'Zulip'\n\n# \u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\n$ ./manage.py changepassword zulip@home.local\n\n# \u7ba1\u7406\u8005\u6a29\u9650\u4ed8\u4e0e\n$ ./manage.py knight -f zulip@home.local\n```\n\n\u4f5c\u6210\u3057\u305f\u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u3067\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\nhttps://192.168.0.200:10443/\n![image](https://qiita-image-store.s3.amazonaws.com/0/14474/82d55cb6-578d-ea27-f7ff-6c59aaf85e21.png)\n\n### docker-zulip\u524a\u9664\n\ndocker-compose\u306f\u7ba1\u7406\u5bfe\u8c61\u306e\u8907\u6570\u306e\u30b3\u30f3\u30c6\u30ca\u306e\u505c\u6b62\u304b\u3089\u524a\u9664\u307e\u3067\u3092\u30b3\u30de\u30f3\u30c9\u4e00\u767a\u3067\u884c\u3063\u3066\u304f\u308c\u308b\u306e\u3067\u4fbf\u5229\u3067\u3059\u3002\u30c7\u30fc\u30bf\u306f\u30db\u30b9\u30c8\u5074\u306b\u4fdd\u7ba1\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u3053\u308c\u306e\u524a\u9664\u3082\u884c\u3044\u307e\u3059\u3002\n\n```sh\n$ docker-compose down\n$ sudo rm -rf /opt/docker/zulip\n```\n\n\u611f\u60f3\n====\n\n\u30c7\u30fc\u30bf\u3092\u30db\u30b9\u30c8\u4e0a\u306b\u4fdd\u7ba1\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u308b\u305f\u3081\u3001zulip\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3059\u308b\u5834\u5408\u306f\u30b3\u30f3\u30c6\u30ca\u3092\u5165\u308c\u66ff\u3048\u308b\u3060\u3051\u3067\u6e08\u307f\u3001\u904b\u7528\u304c\u3068\u3066\u3082\u697d\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u306a\u3044\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u74b0\u5883\u3067zulip\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3053\u308c\u3057\u304b\u306a\u3044\u3068\u3044\u3063\u305f\u611f\u3058\u3002\n\n\n\u304a\u307e\u3051\n======\n\nzulip\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u539f\u56e0\u3092\u8abf\u3079\u305f\u3068\u304d\u306e\u30e1\u30e2\u3068\u304b\u3002\n\n### \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5185\u5bb9\u78ba\u8a8d\n\n```sh\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\n$ docker exec -it dockerzulip_zulip_1 /bin/bash\nroot# psql -h database -U zulip\n```\n\n```psql\n# \u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\nzulip=> \\d\n```\n```shell-session\nWARNING: terminal is not fully functional\n                           List of relations\n Schema |                    Name                    |   Type   | Owner\n--------+--------------------------------------------+----------+-------\n zulip  | auth_group                                 | table    | zulip\n zulip  | auth_group_id_seq                          | sequence | zulip\n zulip  | auth_group_permissions                     | table    | zulip\n zulip  | auth_group_permissions_id_seq              | sequence | zulip\n zulip  | auth_permission                            | table    | zulip\n zulip  | auth_permission_id_seq                     | sequence | zulip\n zulip  | confirmation_confirmation                  | table    | zulip\n zulip  | confirmation_confirmation_id_seq           | sequence | zulip\n zulip  | confirmation_realmcreationkey              | table    | zulip\n zulip  | confirmation_realmcreationkey_id_seq       | sequence | zulip\n zulip  | django_content_type                        | table    | zulip\n zulip  | django_content_type_id_seq                 | sequence | zulip\n zulip  | django_migrations                          | table    | zulip\n zulip  | django_migrations_id_seq                   | sequence | zulip\n zulip  | django_session                             | table    | zulip\n zulip  | django_site                                | table    | zulip\n zulip  | django_site_id_seq                         | sequence | zulip\n zulip  | fts_update_log                             | table    | zulip\n zulip  | fts_update_log_id_seq                      | sequence | zulip\n zulip  | guardian_groupobjectpermission             | table    | zulip\n zulip  | guardian_groupobjectpermission_id_seq      | sequence | zulip\n zulip  | guardian_userobjectpermission              | table    | zulip\n zulip  | guardian_userobjectpermission_id_seq       | sequence | zulip\n zulip  | third_party_api_results                    | table    | zulip\n zulip  | zerver_attachment                          | table    | zulip\n zulip  | zerver_attachment_id_seq                   | sequence | zulip\n zulip  | zerver_attachment_messages                 | table    | zulip\n zulip  | zerver_attachment_messages_id_seq          | sequence | zulip\n zulip  | zerver_client                              | table    | zulip\n zulip  | zerver_client_id_seq                       | sequence | zulip\n zulip  | zerver_defaultstream                       | table    | zulip\n zulip  | zerver_defaultstream_id_seq                | sequence | zulip\n zulip  | zerver_huddle                              | table    | zulip\n zulip  | zerver_huddle_id_seq                       | sequence | zulip\n zulip  | zerver_message                             | table    | zulip\n zulip  | zerver_message_id_seq                      | sequence | zulip\n zulip  | zerver_preregistrationuser                 | table    | zulip\n zulip  | zerver_preregistrationuser_id_seq          | sequence | zulip\n zulip  | zerver_preregistrationuser_streams         | table    | zulip\n zulip  | zerver_preregistrationuser_streams_id_seq  | sequence | zulip\n zulip  | zerver_pushdevicetoken                     | table    | zulip\n zulip  | zerver_pushdevicetoken_id_seq              | sequence | zulip\n zulip  | zerver_realm                               | table    | zulip\n zulip  | zerver_realm_id_seq                        | sequence | zulip\n zulip  | zerver_realmalias                          | table    | zulip\n zulip  | zerver_realmalias_id_seq                   | sequence | zulip\n zulip  | zerver_realmemoji                          | table    | zulip\n zulip  | zerver_realmemoji_id_seq                   | sequence | zulip\n zulip  | zerver_realmfilter                         | table    | zulip\n zulip  | zerver_realmfilter_id_seq                  | sequence | zulip\n zulip  | zerver_recipient                           | table    | zulip\n zulip  | zerver_recipient_id_seq                    | sequence | zulip\n zulip  | zerver_referral                            | table    | zulip\n zulip  | zerver_referral_id_seq                     | sequence | zulip\n zulip  | zerver_scheduledjob                        | table    | zulip\n zulip  | zerver_scheduledjob_id_seq                 | sequence | zulip\n zulip  | zerver_stream                              | table    | zulip\n zulip  | zerver_stream_id_seq                       | sequence | zulip\n zulip  | zerver_subscription                        | table    | zulip\n zulip  | zerver_subscription_id_seq                 | sequence | zulip\n zulip  | zerver_useractivity                        | table    | zulip\n zulip  | zerver_useractivity_id_seq                 | sequence | zulip\n zulip  | zerver_useractivityinterval                | table    | zulip\n zulip  | zerver_useractivityinterval_id_seq         | sequence | zulip\n zulip  | zerver_usermessage                         | table    | zulip\n zulip  | zerver_usermessage_id_seq                  | sequence | zulip\n zulip  | zerver_userpresence                        | table    | zulip\n zulip  | zerver_userpresence_id_seq                 | sequence | zulip\n zulip  | zerver_userprofile                         | table    | zulip\n zulip  | zerver_userprofile_groups                  | table    | zulip\n zulip  | zerver_userprofile_groups_id_seq           | sequence | zulip\n zulip  | zerver_userprofile_id_seq                  | sequence | zulip\n zulip  | zerver_userprofile_user_permissions        | table    | zulip\n zulip  | zerver_userprofile_user_permissions_id_seq | sequence | zulip\n(74 rows)\n```\n\n\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u7ba1\u7406\u3057\u3066\u3044\u308b\u3068\u601d\u308f\u308c\u308b\u30c6\u30fc\u30d6\u30eb\u306e\u5185\u5bb9\u3092\u78ba\u8a8d\u3059\u308b\u3002\uff08\u30d5\u30a3\u30fc\u30eb\u30c9\u306f `\\d zerver_userprofile`\u3067\u8abf\u3079\u305f\uff09\n\n```psql\n# \u30e6\u30fc\u30b6\u4e00\u89a7\nzulip=> select email,domain from zerver_userprofile,zerver_realm where zerver_userprofile.realm_id=zerver_realm.id;\n```\n```shell-session\n            email             |   domain\n------------------------------+------------\n emailgateway@zulip.com       | zulip.com\n welcome-bot@zulip.com        | zulip.com\n notification-bot@zulip.com   | zulip.com\n nagios-send-bot@zulip.com    | zulip.com\n nagios-receive-bot@zulip.com | zulip.com\n feedback@zulip.com           | zulip.com\n(6 rows)\n```\n\n\u30ec\u30eb\u30e0\u306e\u4e00\u89a7\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n```psql\nzulip=> select domain,name from zerver_realm;\n```\n```shell-session\n   domain   | name\n------------+------\n zulip.com  |\n(1 rows)\n```\n\ndocker-compose.yml\u3067\u8a2d\u5b9a\u3057\u305fZULIP_USER_DOMAIN\u3001ZULIP_USER_EMAIL\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u5206\u304b\u3063\u305f\u3002\n\ndocker-zulip\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u3067ZULIP_USER_DOMAIN\u3001ZULIP_USER_EMAIL\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u7b87\u6240\u3092\u8abf\u3079\u308b\u3002\n\n```sh\n$ grep -R '\\(ZULIP_USER_DOMAIN\\|ZULIP_USER_EMAIL\\)' .\n```\n```shell-session\n./includes/createZulipAdmin.sh:if [ ! -z \"$ZULIP_USER_CREATION_ENABLED\" ] && ([ -z \"$ZULIP_USER_DOMAIN\" ] || [ -z \"$ZULIP_USER_EMAIL\" ]); then\n./includes/createZulipAdmin.sh:    realm = get_realm('$ZULIP_USER_DOMAIN')\n./includes/createZulipAdmin.sh:    create_user('$ZULIP_USER_EMAIL', '$ZULIP_USER_PASS', realm, '$ZULIP_USER_FULLNAME', email_to_username('$ZULIP_USER_EMAIL'))\n./includes/createZulipAdmin.sh:User = get_user_profile_by_email(email='$ZULIP_USER_EMAIL')\n./kubernetes/zulip-rc.yml:        - name: ZULIP_USER_EMAIL\n./kubernetes/zulip-rc.yml:        - name: ZULIP_USER_DOMAIN\n./docker-entrypoint.sh:export ZULIP_USER_DOMAIN=\"${ZULIP_USER_DOMAIN:-$(echo $SETTING_EXTERNAL_HOST)}\"\n./docker-entrypoint.sh:export ZULIP_USER_EMAIL=\"${ZULIP_USER_EMAIL:-}\"\n./docker-compose.yml:    ZULIP_USER_EMAIL: \"example@home.local\"\n./docker-compose.yml:    ZULIP_USER_DOMAIN: \"home.local\"\n```\n\n`./includes/createZulipAdmin.sh`\u3067\u30e6\u30fc\u30b6\u4f5c\u6210\u3092\u884c\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n`manager.py` \u3067\u30e6\u30fc\u30b6\u4f5c\u6210\u3059\u308b\u969b\u306b`--domain`\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3053\u3068\u304b\u3089\u3001\u30e6\u30fc\u30b6\u4f5c\u6210\u306e\u524d\u306b\u30c9\u30e1\u30a4\u30f3\uff08realm\uff09\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u306f\u305a\u3060\u304c\u3001`realm = get_realm('$ZULIP_USER_DOMAIN')`\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u51e6\u7406\u304c\u3042\u308b\u3060\u3051\u3067\u3001\u30c9\u30e1\u30a4\u30f3\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u500b\u6240\u304c\u306a\u3044\u3002\n\n\u30c9\u30e1\u30a4\u30f3\u53d6\u5f97\u306b\u5931\u6557\u3057\u305f\u3089\u30c9\u30e1\u30a4\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3068\u3044\u3046\u51e6\u7406\u304c\u5fc5\u8981\u3068\u601d\u308f\u308c\u308b\u3002\n", "tags": ["Zulip", "\u30c1\u30e3\u30c3\u30c8", "docker", "docker-compose"]}