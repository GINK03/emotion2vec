{"tags": ["AdventCalendar", "\u30cf\u30a4\u30d6\u30ea\u30c3\u30c9\u30a2\u30d7\u30ea", "monaca", "jsonp"], "context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u30a2\u30d7\u30ea\u304b\u3089\u3001\u5916\u90e8\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u305f\u3044\u5834\u5408\u306eJSONP\u7de8\u3002\n\nJSONP\u3068\u306f\n\u901a\u5e38\u3001\u7570\u306a\u308b\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u3057\u3066Ajax\u901a\u4fe1\u3092\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u6012\u3089\u308c\u308b\u3002\n\u3053\u308c\u3092\u30af\u30ed\u30b9\u30c9\u30e1\u30a4\u30f3\u5236\u7d04\u3068\u3044\u3046\u3002\nXMLHttpRequest cannot load http://exampleexample.com/. \nNo 'Access-Control-Allow-Origin' header is present on the requested resource.\nOrigin 'https://example.com/' is therefore not allowed access.\n\n\u305d\u308c\u3067\u3082\u5916\u90e8\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u308b\u306e\u306f\u4e0d\u53ef\u6b20\u306a\u306e\u3067\u3001\nhttp://example.com/jsonp_project/JsonpServlet?callback=displayCustomer\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306aURL\u3067\u30a2\u30af\u30bb\u30b9\u3057\u305f\u6642\u306b\u3001\ncallback\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306e\u5024\u3092\u30b5\u30fc\u30d0\u30fc\u5074\u3067\u53d7\u3051\u53d6\u308a\u3001\ndisplayCustomer([{\"age\":16,\"name\":\"\u30c6\u30b9\u30c8\u592a\u90ce\"}])\n\n\u306e\u3088\u3046\u306aJavaScript\u306e\u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u5f62\u5f0f\u3067\u30b5\u30fc\u30d0\u30fc\u5074\u304b\u3089JSON\u30c7\u30fc\u30bf\u8fd4\u3063\u3066\u304f\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\u3002\ndisplayCustomer\u304c\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u547c\u3073\u51fa\u3057\u305f\u3044JavaScript\u306e\u95a2\u6570\u540d\u3068\u306a\u3063\u3066\u3044\u308b\u3002\n\u3053\u306e\u95a2\u6570\u540d\u306f\u4efb\u610f\u306e\u3082\u306e\u306b\u3057\u3066\u3001callback\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3068\u3057\u3066\u8a2d\u5b9a\u3057\u3068\u3051\u3070\u3088\u3044\u3002\n\u53d7\u3051\u53d6\u3063\u305f\u30c7\u30fc\u30bf\u3092\n<script>\n  displayCustomer([{\"age\":16,\"name\":\"\u30c6\u30b9\u30c8\u592a\u90ce\"}])\n</script>\n\n\u306a\u611f\u3058\u3067\u753b\u9762\u5074\u306b\u8ffd\u52a0\u3057\u3066\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u5b9a\u7fa9\u3057\u3066\u3042\u308bJavaScript\u306e\u95a2\u6570\uff08\u3053\u306e\u5834\u5408displayCustomer\uff09\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001\u5916\u90e8\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u305f\u4e0a\u3067\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3068\u3044\u3046\u306e\u304cJSONP\u3002\nscript\u30bf\u30b0\u304c\u5916\u90e8\u306e\u30bd\u30fc\u30b9\u3092\u8aad\u307f\u8fbc\u307f\u3053\u3081\u308b\u3053\u3068\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u3002\n\n\u624b\u9806\n\u30b5\u30fc\u30d0\u30fc\u5074\u3067JSON\u5f62\u5f0f\u306b\u3066\u30c7\u30fc\u30bf\u3092\u8fd4\u3059\u3088\u3046\u306b\u3059\u308b\u3002\n\u4eca\u56de\u306f\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3067\u9069\u5f53\u306b\u4f5c\u3063\u305f\u30c7\u30fc\u30bf\u3092JSON\u3067\u8fd4\u3059\u3088\u3046\u306b\u5b9f\u88c5\u3002\n\u5b9f\u969b\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u3066\n\nservlet\n@WebServlet(name = \"JsonpServlet\", urlPatterns = {\"/JsonpServlet\"})\npublic class JsonpServlet extends HttpServlet {\n\n    protected void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        response.setContentType(\"text/html;charset=UTF-8\");\n\n        // URL\u304b\u3089callback\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5024\u3092\u53d6\u5f97\n        String callback = request.getParameter(\"callback\");\n\n        Customer[] customers = {\n            new Customer(\"\u30c6\u30b9\u30c8\u592a\u90ce\", 16)\n        };\n\n        // JSON\u306b\u30a8\u30f3\u30b3\u30fc\u30c9\n        String jsonText = JSON.encode(customers);\n\n        String responseData = \"\";\n        if(callback == null || \"\".equals(callback)){\n            responseData = jsonText;\n        }else{\n            // \u3053\u3053\u3067\u95a2\u6570\u540d(JSON)\u306e\u5f62\u5f0f\u3067\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u8fd4\u3059\u3088\u3046\u306b\u8a2d\u5b9a\n            responseData = callback + \"(\" + jsonText + \")\";\n        }\n\n        response.setCharacterEncoding(\"UTF-8\");\n        PrintWriter out = response.getWriter();\n        out.print(responseData);\n    }\n}\n\n\n\u753b\u9762\u306f\u30dc\u30bf\u30f3\u304c\u3042\u3063\u3066\u3001\u305d\u308c\u3092\u62bc\u3057\u305f\u3089JS\u306e\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u306e\u307f\u3002\n\nhtml\n<ons-page>\n    <ons-toolbar>\n        <div class=\"center\">AjaxJSON</div>\n    </ons-toolbar>\n\n    <div style=\"text-align: center\">\n        <br>\n        <ons-button onclick=\"addScript()\">\n            JSONP\n        </ons-button>\n\n        <div id=\"ajax\"></div>\n    </div>\n</ons-page>\n\n\ncallback\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u547c\u3073\u305f\u3044JS\u95a2\u6570\u306e\u540d\u524d\u3092\u6307\u5b9a\u3002\n\njs\n// \u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u305f\u6642\u306b\u30c7\u30fc\u30bf\u3092\u53d7\u3051\u53d6\u3063\u3066script\u30bf\u30b0\u3068\u3057\u3066\u753b\u9762\u306b\u8ffd\u52a0\nfunction addScript(){\n    var script = document.createElement('script');\n    script.src = 'http://example.com/jsonp_project/JsonpServlet?callback=displayCustomer';\n    document.body.appendChild(script);\n}\n\n// \u4e0a\u8a18\u3067\u300c\u95a2\u6570\u540d(JSON)\u300d\u306e\u5f62\u5f0f\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u8ffd\u52a0\u3055\u308c\u3001\u3053\u308c\u304c\u547c\u3070\u308c\u308b\nfunction displayCustomer(data){\n    for(i = 0; i < data.length; i++){\n        $(\"#ajax\").append(\"<div>\" + data[i].name + \"</div>\");\n    }\n}\n\n\n\n\u5b9f\u884c\u7d50\u679c\n\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3059\u308b\u3068\u30dc\u30bf\u30f3\u306e\u4e0b\u306b\u53d6\u5f97\u3057\u305f\u30c7\u30fc\u30bf\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n\n\n\u307e\u3068\u3081\n\u6c17\u8c61\u60c5\u5831API\u306e\u3088\u3046\u306aJSONP\u3092\u63d0\u4f9b\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3046\u3044\u3046\u3068\u3053\u308d\u306eAPI\u3092\u5229\u7528\u3057\u305f\u308a\u3001\u30b5\u30fc\u30d0\u30fc\u5074\u3067\u3044\u3044\u611f\u3058\u306b\u8fd4\u3059\u3088\u3046\u306b\u3057\u305f\u3089\u3044\u3044\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n# \u306f\u3058\u3081\u306b\n\u30a2\u30d7\u30ea\u304b\u3089\u3001\u5916\u90e8\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u308a\u305f\u3044\u5834\u5408\u306eJSONP\u7de8\u3002\n\n# JSONP\u3068\u306f\n\u901a\u5e38\u3001\u7570\u306a\u308b\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u3057\u3066Ajax\u901a\u4fe1\u3092\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u6012\u3089\u308c\u308b\u3002\n\u3053\u308c\u3092\u30af\u30ed\u30b9\u30c9\u30e1\u30a4\u30f3\u5236\u7d04\u3068\u3044\u3046\u3002\n\n```\nXMLHttpRequest cannot load http://exampleexample.com/. \nNo 'Access-Control-Allow-Origin' header is present on the requested resource.\nOrigin 'https://example.com/' is therefore not allowed access.\n```\n\n\u305d\u308c\u3067\u3082\u5916\u90e8\u306e\u30b5\u30fc\u30d0\u30fc\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u308b\u306e\u306f\u4e0d\u53ef\u6b20\u306a\u306e\u3067\u3001\n\n```\nhttp://example.com/jsonp_project/JsonpServlet?callback=displayCustomer\n```\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306aURL\u3067\u30a2\u30af\u30bb\u30b9\u3057\u305f\u6642\u306b\u3001\n`callback`\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306e\u5024\u3092\u30b5\u30fc\u30d0\u30fc\u5074\u3067\u53d7\u3051\u53d6\u308a\u3001\n\n```\ndisplayCustomer([{\"age\":16,\"name\":\"\u30c6\u30b9\u30c8\u592a\u90ce\"}])\n```\n\n\u306e\u3088\u3046\u306aJavaScript\u306e\u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u5f62\u5f0f\u3067\u30b5\u30fc\u30d0\u30fc\u5074\u304b\u3089JSON\u30c7\u30fc\u30bf\u8fd4\u3063\u3066\u304f\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\u3002\n`displayCustomer`\u304c\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u547c\u3073\u51fa\u3057\u305f\u3044JavaScript\u306e\u95a2\u6570\u540d\u3068\u306a\u3063\u3066\u3044\u308b\u3002\n\u3053\u306e\u95a2\u6570\u540d\u306f\u4efb\u610f\u306e\u3082\u306e\u306b\u3057\u3066\u3001callback\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3068\u3057\u3066\u8a2d\u5b9a\u3057\u3068\u3051\u3070\u3088\u3044\u3002\n\u53d7\u3051\u53d6\u3063\u305f\u30c7\u30fc\u30bf\u3092\n\n```html\n<script>\n  displayCustomer([{\"age\":16,\"name\":\"\u30c6\u30b9\u30c8\u592a\u90ce\"}])\n</script>\n```\n\n\u306a\u611f\u3058\u3067\u753b\u9762\u5074\u306b\u8ffd\u52a0\u3057\u3066\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u5b9a\u7fa9\u3057\u3066\u3042\u308bJavaScript\u306e\u95a2\u6570\uff08\u3053\u306e\u5834\u5408displayCustomer\uff09\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001\u5916\u90e8\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u305f\u4e0a\u3067\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3068\u3044\u3046\u306e\u304cJSONP\u3002\n\nscript\u30bf\u30b0\u304c\u5916\u90e8\u306e\u30bd\u30fc\u30b9\u3092\u8aad\u307f\u8fbc\u307f\u3053\u3081\u308b\u3053\u3068\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u3002\n\n# \u624b\u9806\n\u30b5\u30fc\u30d0\u30fc\u5074\u3067JSON\u5f62\u5f0f\u306b\u3066\u30c7\u30fc\u30bf\u3092\u8fd4\u3059\u3088\u3046\u306b\u3059\u308b\u3002\n\u4eca\u56de\u306f\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u3067\u9069\u5f53\u306b\u4f5c\u3063\u305f\u30c7\u30fc\u30bf\u3092JSON\u3067\u8fd4\u3059\u3088\u3046\u306b\u5b9f\u88c5\u3002\n\u5b9f\u969b\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u3066\n\n```java:servlet\n@WebServlet(name = \"JsonpServlet\", urlPatterns = {\"/JsonpServlet\"})\npublic class JsonpServlet extends HttpServlet {\n\n    protected void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        response.setContentType(\"text/html;charset=UTF-8\");\n        \n        // URL\u304b\u3089callback\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5024\u3092\u53d6\u5f97\n        String callback = request.getParameter(\"callback\");\n        \n        Customer[] customers = {\n            new Customer(\"\u30c6\u30b9\u30c8\u592a\u90ce\", 16)\n        };\n        \n        // JSON\u306b\u30a8\u30f3\u30b3\u30fc\u30c9\n        String jsonText = JSON.encode(customers);\n        \n        String responseData = \"\";\n        if(callback == null || \"\".equals(callback)){\n            responseData = jsonText;\n        }else{\n            // \u3053\u3053\u3067\u95a2\u6570\u540d(JSON)\u306e\u5f62\u5f0f\u3067\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u8fd4\u3059\u3088\u3046\u306b\u8a2d\u5b9a\n            responseData = callback + \"(\" + jsonText + \")\";\n        }\n        \n        response.setCharacterEncoding(\"UTF-8\");\n        PrintWriter out = response.getWriter();\n        out.print(responseData);\n    }\n}\n```\n\n\u753b\u9762\u306f\u30dc\u30bf\u30f3\u304c\u3042\u3063\u3066\u3001\u305d\u308c\u3092\u62bc\u3057\u305f\u3089JS\u306e\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u306e\u307f\u3002\n\n```html:html\n<ons-page>\n    <ons-toolbar>\n        <div class=\"center\">AjaxJSON</div>\n    </ons-toolbar>\n\n    <div style=\"text-align: center\">\n        <br>\n        <ons-button onclick=\"addScript()\">\n            JSONP\n        </ons-button>\n        \n        <div id=\"ajax\"></div>\n    </div>\n</ons-page>\n```\n\ncallback\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u547c\u3073\u305f\u3044JS\u95a2\u6570\u306e\u540d\u524d\u3092\u6307\u5b9a\u3002\n\n```js:js\n// \u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u305f\u6642\u306b\u30c7\u30fc\u30bf\u3092\u53d7\u3051\u53d6\u3063\u3066script\u30bf\u30b0\u3068\u3057\u3066\u753b\u9762\u306b\u8ffd\u52a0\nfunction addScript(){\n    var script = document.createElement('script');\n    script.src = 'http://example.com/jsonp_project/JsonpServlet?callback=displayCustomer';\n    document.body.appendChild(script);\n}\n\n// \u4e0a\u8a18\u3067\u300c\u95a2\u6570\u540d(JSON)\u300d\u306e\u5f62\u5f0f\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u8ffd\u52a0\u3055\u308c\u3001\u3053\u308c\u304c\u547c\u3070\u308c\u308b\nfunction displayCustomer(data){\n    for(i = 0; i < data.length; i++){\n        $(\"#ajax\").append(\"<div>\" + data[i].name + \"</div>\");\n    }\n}\n```\n\n# \u5b9f\u884c\u7d50\u679c\n\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3059\u308b\u3068\u30dc\u30bf\u30f3\u306e\u4e0b\u306b\u53d6\u5f97\u3057\u305f\u30c7\u30fc\u30bf\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-12-08 17.08.44.png](https://qiita-image-store.s3.amazonaws.com/0/48912/da86a92c-9885-b4b8-5926-455a7da3eedf.png)\n\n# \u307e\u3068\u3081\n[\u6c17\u8c61\u60c5\u5831API](http://developer.yahoo.co.jp/webapi/map/openlocalplatform/v1/weather.html)\u306e\u3088\u3046\u306aJSONP\u3092\u63d0\u4f9b\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u304c\u3042\u308b\u306e\u3067\u3001\u305d\u3046\u3044\u3046\u3068\u3053\u308d\u306eAPI\u3092\u5229\u7528\u3057\u305f\u308a\u3001\u30b5\u30fc\u30d0\u30fc\u5074\u3067\u3044\u3044\u611f\u3058\u306b\u8fd4\u3059\u3088\u3046\u306b\u3057\u305f\u3089\u3044\u3044\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n"}