{"tags": ["cakephp2", "PHP", "hatenabookmark", "CakePHP"], "context": "\n\n\u306f\u3058\u3081\u306b\nAPI\u3092\u521d\u3081\u3066\u4f7f\u3063\u305f\u3068\u3044\u3046\u3060\u3051\u306e\u30e1\u30e2\u66f8\u304d\u3067\u3059\u3002\nfile_get_contents\u3067\u53d6\u308c\u3070\u3044\u3044\u3093\u3060\u3001\u3068\u3044\u3046\u3060\u3051\u3067\u3059\u3002\n\u307b\u3068\u3093\u3069Syncer\u3055\u3093\u306e\u30b3\u30fc\u30c9\u3092\u30d1\u30af\u2026\u2026\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\n\uff08https://syncer.jp/hatebu-api-matome\uff09\nCakePHP\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f2.9.1\u3067\u3059\u3002\n\n\u30b3\u30fc\u30c9\n\nController/HatebuController.php\n<?php\n\nApp::uses('AppController', 'Controller');\n\nclass HatebuController extends AppController {\n\n    public $uses = null; // Model\u4f7f\u308f\u306a\u3044\n\n    public function index() {\n\n        // \u30c1\u30a7\u30c3\u30af\u3059\u308bURL\n        $target_url = $this->request->data('target_url');\n\n        // JSON\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n        $count = @file_get_contents( \n            'http://api.b.st-hatena.com/entry.count?url='\n            . rawurlencode( $target_url )\n        );\n\n        // \u30c7\u30fc\u30bf\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f0\u6271\u3044\n        if( !isset($count) || empty($count) ) {\n            $count = 0;\n        }\n\n        // View\u306b\u5024\u3092\u6e21\u3059\n        $this->set(compact('target_url','count'));\n    }\n\n}\n\n\n\nView/Hatebu/index.ctp\n\n<h2>\u306f\u3066\u306a\u30d6\u30c3\u30af\u30de\u30fc\u30af\u7dcf\u6570\u30ab\u30a6\u30f3\u30bf\u30fc</h2>\n\n<?php\n    echo $this->Form->create(false,array(\n        'type' => 'post',\n    ));\n    echo $this->Form->input('target_url',array(\n        'type' => 'url',\n        'label' => 'URL (http://\u307e\u305f\u306fhttps://\u304b\u3089\u5165\u529b)',\n    ));\n\n    echo $this->Form->submit('Submit');\n    echo $this->Form->end();\n?>\n\n<br><br>\n\n<h3>URL : <?php echo $target_url; ?></h3>\n<h3>\u7d50\u679c\u306f [ <?php echo $count ?> ] \u4ef6\u3067\u3059</h3>\n\n\n\u4ee5\u4e0a\u3067\u3059\n# \u306f\u3058\u3081\u306b\nAPI\u3092\u521d\u3081\u3066\u4f7f\u3063\u305f\u3068\u3044\u3046\u3060\u3051\u306e\u30e1\u30e2\u66f8\u304d\u3067\u3059\u3002\nfile_get_contents\u3067\u53d6\u308c\u3070\u3044\u3044\u3093\u3060\u3001\u3068\u3044\u3046\u3060\u3051\u3067\u3059\u3002\n\n\u307b\u3068\u3093\u3069Syncer\u3055\u3093\u306e\u30b3\u30fc\u30c9\u3092\u30d1\u30af\u2026\u2026\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\n\uff08https://syncer.jp/hatebu-api-matome\uff09\n\nCakePHP\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f2.9.1\u3067\u3059\u3002\n\n# \u30b3\u30fc\u30c9\n\n```php:Controller/HatebuController.php\n<?php\n\nApp::uses('AppController', 'Controller');\n\nclass HatebuController extends AppController {\n\n\tpublic $uses = null; // Model\u4f7f\u308f\u306a\u3044\n\n\tpublic function index() {\n\n\t\t// \u30c1\u30a7\u30c3\u30af\u3059\u308bURL\n\t\t$target_url = $this->request->data('target_url');\n\n\t\t// JSON\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n\t\t$count = @file_get_contents( \n\t\t\t'http://api.b.st-hatena.com/entry.count?url='\n\t\t\t. rawurlencode( $target_url )\n\t\t);\n\n\t\t// \u30c7\u30fc\u30bf\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f0\u6271\u3044\n\t\tif( !isset($count) || empty($count) ) {\n\t\t\t$count = 0;\n\t\t}\n\t\t\n\t\t// View\u306b\u5024\u3092\u6e21\u3059\n\t\t$this->set(compact('target_url','count'));\n\t}\n\t\n}\n```\n\n\n```php:View/Hatebu/index.ctp\n\n<h2>\u306f\u3066\u306a\u30d6\u30c3\u30af\u30de\u30fc\u30af\u7dcf\u6570\u30ab\u30a6\u30f3\u30bf\u30fc</h2>\n\n<?php\n\techo $this->Form->create(false,array(\n\t\t'type' => 'post',\n\t));\n\techo $this->Form->input('target_url',array(\n\t\t'type' => 'url',\n\t\t'label' => 'URL (http://\u307e\u305f\u306fhttps://\u304b\u3089\u5165\u529b)',\n\t));\n\n\techo $this->Form->submit('Submit');\n\techo $this->Form->end();\n?>\n\n<br><br>\n\n<h3>URL : <?php echo $target_url; ?></h3>\n<h3>\u7d50\u679c\u306f [ <?php echo $count ?> ] \u4ef6\u3067\u3059</h3>\n```\n\n\u4ee5\u4e0a\u3067\u3059\n"}