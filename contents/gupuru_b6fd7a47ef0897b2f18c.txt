{"context": "BotFramework\u306eMembersAdded\u3092\u4f7f\u3046\u3068\u3001Slack\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u306b\u65b0\u3057\u304f\u5165\u3063\u3066\u304d\u305f\u4eba\u306b\u6328\u62f6\u3067\u304d\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u5c11\u3057\u3084\u3063\u3066\u307f\u307e\u3057\u305f(^O^)v\n\u203bMembersAdded\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u3053\u3061\u3089\n\n\u5165\u3063\u3066\u304d\u305f\u4eba\u306b\u6328\u62f6\nvar restify = require('restify');\nvar builder = require('botbuilder');\n\nvar server = restify.createServer();\nserver.listen(process.env.port || process.env.PORT || 3978, function () {\n   console.log('%s listening to %s', server.name, server.url); \n});\n\nvar connector = new builder.ChatConnector({\n    appId: 'ID',\n    appPassword: 'PASSWORD'\n});\nvar bot = new builder.UniversalBot(connector);\nserver.post('/api/messages', connector.listen());\n\n// \u3053\u3053\u3067\u5165\u3063\u3066\u304d\u305f\u4e8b\u3092\u53d6\u5f97\u3057\u3066\u3001\u6328\u62f6\nbot.on('conversationUpdate', function (message) {\n    if (message.membersAdded) {\n        var membersAdded = message.membersAdded\n            .map((m) => {\n                var isSelf = m.id === message.address.bot.id;\n                return (isSelf ? message.address.bot.name : m.name);\n            })\n            .join(', ');\n\n        var reply = new builder.Message()\n            .address(message.address)\n            .text('\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u305b\u30fc ' + membersAdded + ' \u3055\u3093');\n        bot.send(reply);\n    }\n});\n\n\n\n\n\u9000\u51fa\u3057\u305f\u6642\u306b\u6328\u62f6\n\u9000\u51fa\u6642\u306fmembersRemoved\u3092\u4f7f\u3046\u3068\u3001\u53d6\u308c\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n  if (message.membersRemoved) {\n        var membersRemoved = message.membersRemoved\n            .map((m) => {\n                var isSelf = m.id === message.address.bot.id;\n                return (isSelf ? message.address.bot.name : m.name);\n            })\n            .join(', ');\n\n        var reply = new builder.Message()\n            .address(message.address)\n            .text('\u3070\u3044\u3070\u30fc\u3044' + membersRemoved);\n        bot.send(reply);\n  }\n\n\nBotFramework\u306e`MembersAdded`\u3092\u4f7f\u3046\u3068\u3001Slack\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u306b**\u65b0\u3057\u304f\u5165\u3063\u3066\u304d\u305f\u4eba\u306b\u6328\u62f6\u3067\u304d\u308b**\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u5c11\u3057\u3084\u3063\u3066\u307f\u307e\u3057\u305f(^O^)v\n\u203b`MembersAdded`\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f[\u3053\u3061\u3089](https://docs.botframework.com/en-us/csharp/builder/sdkreference/activities.html)\n\n## \u5165\u3063\u3066\u304d\u305f\u4eba\u306b\u6328\u62f6\n\n```js\nvar restify = require('restify');\nvar builder = require('botbuilder');\n\nvar server = restify.createServer();\nserver.listen(process.env.port || process.env.PORT || 3978, function () {\n   console.log('%s listening to %s', server.name, server.url); \n});\n  \nvar connector = new builder.ChatConnector({\n    appId: 'ID',\n    appPassword: 'PASSWORD'\n});\nvar bot = new builder.UniversalBot(connector);\nserver.post('/api/messages', connector.listen());\n\n// \u3053\u3053\u3067\u5165\u3063\u3066\u304d\u305f\u4e8b\u3092\u53d6\u5f97\u3057\u3066\u3001\u6328\u62f6\nbot.on('conversationUpdate', function (message) {\n    if (message.membersAdded) {\n        var membersAdded = message.membersAdded\n            .map((m) => {\n                var isSelf = m.id === message.address.bot.id;\n                return (isSelf ? message.address.bot.name : m.name);\n            })\n            .join(', ');\n\n        var reply = new builder.Message()\n            .address(message.address)\n            .text('\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u305b\u30fc ' + membersAdded + ' \u3055\u3093');\n        bot.send(reply);\n    }\n});\n\n```\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-10-11 0.57.27.png](https://qiita-image-store.s3.amazonaws.com/0/53996/f6fb1d0c-a4ea-5b5f-0ae2-797cfb8ba972.png)\n\n## \u9000\u51fa\u3057\u305f\u6642\u306b\u6328\u62f6\n\n\u9000\u51fa\u6642\u306f`membersRemoved`\u3092\u4f7f\u3046\u3068\u3001\u53d6\u308c\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\n```js\n  if (message.membersRemoved) {\n        var membersRemoved = message.membersRemoved\n            .map((m) => {\n                var isSelf = m.id === message.address.bot.id;\n                return (isSelf ? message.address.bot.name : m.name);\n            })\n            .join(', ');\n\n        var reply = new builder.Message()\n            .address(message.address)\n            .text('\u3070\u3044\u3070\u30fc\u3044' + membersRemoved);\n        bot.send(reply);\n  }\n```\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-10-11 1.09.24.png](https://qiita-image-store.s3.amazonaws.com/0/53996/3c402d66-519d-b382-a431-ba48cb763d57.png)\n\n\n", "tags": ["BotFramework", "Slack", "bot"]}