{"context": "\n\u52d5\u4f5c\u74b0\u5883\nC++ Builder XE4\nWindows 7 pro (32bit)\n.NET Framework: v4.5.1\u3092\u6709\u52b9\u5316\n\n\nVarToDateTime\u306e\u8ffd\u52a0\u5143\u53f7\u3078\u306e\u5bfe\u5fdc\u306b\u3064\u3044\u3066 @ Delphi freeml\n\n\u524d\u6e96\u5099\n\u30ec\u30b8\u30b9\u30c8\u30ea\u306b\u65b0\u3057\u3044\u5143\u53f7\u3092\u767b\u9332\u3059\u308b\u3002\n\u300c\u5b87\u5b99_\u5b87_Uchyu_U\u300d\u3068\u3057\u305f\u3002\n\n\nv0.1 > \u30a8\u30e9\u30fc\n\ncode\nFormatDateTime()\u3068VarToDateTime()\u3067\u5b9f\u88c5\u3002\n\nUnit1.cpp\n//---------------------------------------------------------------------------\n\n#include <vcl.h>\n#pragma hdrstop\n\n#include \"Unit1.h\"\n//---------------------------------------------------------------------------\n#pragma package(smart_init)\n#pragma resource \"*.dfm\"\nTForm1 *Form1;\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner)\n    : TForm(Owner)\n{\n}\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n    TDateTime startdt = VarToDateTime(\"2017/01/11 12:30:45\");\n\n    String strdt = FormatDateTime(L\"ggee\u5e74mm\u6708dd\u65e5\", startdt);\n    OutputDebugString(strdt.c_str());\n    int nop1=1;\n\n    TDateTime backdt = VarToDateTime(strdt);\n    int nop2=1;\n\n    OutputDebugString( DateTimeToStr(backdt).c_str() );\n}\n//---------------------------------------------------------------------------\n\n\n\n\u5b9f\u884c\nFormatDateTime()\u306e\u90e8\u5206\u3067\u306f\u30ec\u30b8\u30b9\u30c8\u30ea\u306e\u60c5\u5831\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3002\nVarToDateTime()\u306e\u90e8\u5206\u3067\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u3002\n\n\n\u95a2\u9023\u60c5\u5831\nhttps://social.msdn.microsoft.com/Forums/ja-JP/a93ec79d-69a5-4bb7-ae5d-a8aabfdcb9dd/systemglobalizationcultureinfo?forum=netfxgeneralja\n\u3092\u898b\u308b\u3068\n\n\u3068\u8aac\u660e\u3055\u308c\u3066\u3044\u308b\u3068\u304a\u308a\u3067\u3001Windows 7\u4ee5\u964d\u3067\u306e\u30cd\u30a4\u30c6\u30a3\u30d6\u30a2\u30d7\u30ea\u3082\u3057\u304f\u306f.NET 4.0\u3092\u4f7f\u7528\u3057\u305f\u5834\u5408\u306b\u3057\u304b\u6a5f\u80fd\u3057\u307e\u305b\u3093\u3002\u624b\u5143\u3067\u30ec\u30b8\u30b9\u30c8\u30ea\u8a2d\u5b9a\u3057\u3066\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001Windows 10 + .NET 3.5\u3067\u306f\u3084\u306f\u308a\u65b0\u3057\u3044\u5143\u53f7\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3067\u3057\u305f\u3002\uff08Windows 10 + .NET 4\u4ee5\u964d\u3067\u306f\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\uff09\n\nC++ Builder XE4\u3067\u5b9f\u88c5\u3057\u305f\u3082\u306e\u306f\u3001.NET Framework\u3068\u306f\u95a2\u4fc2\u306a\u3044\u306e\u304b\u3068\u601d\u3063\u3066\u3044\u308b\u3002\n\u305d\u306e\u305f\u3081\u3001\u4e0a\u8a18\u306e\u30b3\u30e1\u30f3\u30c8\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u305f\u30ec\u30b8\u30b9\u30c8\u30ea\u306e\u6587\u5b57\u5217\u306f\u4f7f\u308f\u308c\u3066\u3044\u306a\u3044\uff08\u304b\u6b63\u3057\u304f\u52d5\u4f5c\u3057\u306a\u3044\uff09\u306e\u3060\u308d\u3046\u3002\n\nv0.2 > \u81ea\u524d\u5909\u63db\n\nUnit1.cpp\n//---------------------------------------------------------------------------\n\n#include <vcl.h>\n#pragma hdrstop\n\n#include <DateUtils.hpp>\n#include \"Unit1.h\"\n//---------------------------------------------------------------------------\n#pragma package(smart_init)\n#pragma resource \"*.dfm\"\nTForm1 *Form1;\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner)\n    : TForm(Owner)\n{\n}\n//---------------------------------------------------------------------------\n\nstatic const TDate kDate_startNewEra = VarToDateTime(\"2016/01/01\");\n\n\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n    TDateTime startdt = VarToDateTime(\"2017/01/11 12:30:45\");\n\n    String strdt = FormatDateTime(L\"ggee\u5e74mm\u6708dd\u65e5\", startdt);\n    OutputDebugString(strdt.c_str());\n\n    TDateTime backdt;\n    try {\n        backdt = VarToDateTime(strdt);\n    } catch (...) {\n        // Not (.NET Framework 4 or native)\n        String wrk = strdt.SubString(3, MAXINT); // \u5143\u53f72\u6587\u5b57\u3092\u9664\u53bb\n        int startYear = kDate_startNewEra.FormatString(L\"YYYY\").ToInt();\n        int addYear = startYear - 2000 - 1;\n        backdt = VarToDateTime(wrk);\n        backdt = IncYear(backdt, addYear);\n    }\n\n    OutputDebugString( DateTimeToStr(backdt).c_str() );\n}\n//---------------------------------------------------------------------------\n\n\n\n\u7d50\u679c\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: \u5b87\u5b9902\u5e7401\u670811\u65e5 \u30d7\u30ed\u30bb\u30b9 Project1.exe (3668)\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: 2017/01/11 \u30d7\u30ed\u30bb\u30b9 Project1.exe (3668)\n\n\n\u529b\u6280\u3067\u5909\u63db\u3067\u304d\u305f\u3002\n\u3082\u3063\u3068\u826f\u3044\u5b9f\u88c5\u306f\u4ed6\u8005\u306b\u3086\u305a\u308b\u3002\n```txt:\u52d5\u4f5c\u74b0\u5883\nC++ Builder XE4\nWindows 7 pro (32bit)\n.NET Framework: v4.5.1\u3092\u6709\u52b9\u5316\n```\n\n[VarToDateTime\u306e\u8ffd\u52a0\u5143\u53f7\u3078\u306e\u5bfe\u5fdc\u306b\u3064\u3044\u3066 @ Delphi freeml](http://www.freeml.com/delphi-users/4593/latest?sid=46c711ee17489f134fc0bc32bd8b690a5dad010a349e7ef04e94cd702ac30e47c3753b9c2502aa1fb421efa786fc40e988546774b3ced08f5dc9b0de1b88700d)\n\n## \u524d\u6e96\u5099\n\n\u30ec\u30b8\u30b9\u30c8\u30ea\u306b\u65b0\u3057\u3044\u5143\u53f7\u3092\u767b\u9332\u3059\u308b\u3002\n\u300c\u5b87\u5b99_\u5b87_Uchyu_U\u300d\u3068\u3057\u305f\u3002\n\n![qiita.png](https://qiita-image-store.s3.amazonaws.com/0/32870/642fb503-f1d2-4c38-74e7-5964a625679a.png)\n\n## v0.1 > \u30a8\u30e9\u30fc\n\n### code \n\nFormatDateTime()\u3068VarToDateTime()\u3067\u5b9f\u88c5\u3002\n\n```Unit1.cpp\n//---------------------------------------------------------------------------\n\n#include <vcl.h>\n#pragma hdrstop\n\n#include \"Unit1.h\"\n//---------------------------------------------------------------------------\n#pragma package(smart_init)\n#pragma resource \"*.dfm\"\nTForm1 *Form1;\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner)\n\t: TForm(Owner)\n{\n}\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\tTDateTime startdt = VarToDateTime(\"2017/01/11 12:30:45\");\n\n\tString strdt = FormatDateTime(L\"ggee\u5e74mm\u6708dd\u65e5\", startdt);\n\tOutputDebugString(strdt.c_str());\n\tint nop1=1;\n\n\tTDateTime backdt = VarToDateTime(strdt);\n\tint nop2=1;\n\n\tOutputDebugString( DateTimeToStr(backdt).c_str() );\n}\n//---------------------------------------------------------------------------\n```\n\n### \u5b9f\u884c\n\nFormatDateTime()\u306e\u90e8\u5206\u3067\u306f\u30ec\u30b8\u30b9\u30c8\u30ea\u306e\u60c5\u5831\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3002\nVarToDateTime()\u306e\u90e8\u5206\u3067\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u3068\u306a\u3063\u305f\u3002\n\n![qiita.png](https://qiita-image-store.s3.amazonaws.com/0/32870/d4626462-dc97-9339-5fd0-83c596851201.png)\n\n### \u95a2\u9023\u60c5\u5831\n\nhttps://social.msdn.microsoft.com/Forums/ja-JP/a93ec79d-69a5-4bb7-ae5d-a8aabfdcb9dd/systemglobalizationcultureinfo?forum=netfxgeneralja\n\u3092\u898b\u308b\u3068\n\n> \u3068\u8aac\u660e\u3055\u308c\u3066\u3044\u308b\u3068\u304a\u308a\u3067\u3001Windows 7\u4ee5\u964d\u3067\u306e\u30cd\u30a4\u30c6\u30a3\u30d6\u30a2\u30d7\u30ea\u3082\u3057\u304f\u306f.NET 4.0\u3092\u4f7f\u7528\u3057\u305f\u5834\u5408\u306b\u3057\u304b\u6a5f\u80fd\u3057\u307e\u305b\u3093\u3002\u624b\u5143\u3067\u30ec\u30b8\u30b9\u30c8\u30ea\u8a2d\u5b9a\u3057\u3066\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001Windows 10 + .NET 3.5\u3067\u306f\u3084\u306f\u308a\u65b0\u3057\u3044\u5143\u53f7\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3067\u3057\u305f\u3002\uff08Windows 10 + .NET 4\u4ee5\u964d\u3067\u306f\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\uff09\n\nC++ Builder XE4\u3067\u5b9f\u88c5\u3057\u305f\u3082\u306e\u306f\u3001.NET Framework\u3068\u306f\u95a2\u4fc2\u306a\u3044\u306e\u304b\u3068\u601d\u3063\u3066\u3044\u308b\u3002\n\u305d\u306e\u305f\u3081\u3001\u4e0a\u8a18\u306e\u30b3\u30e1\u30f3\u30c8\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u305f\u30ec\u30b8\u30b9\u30c8\u30ea\u306e\u6587\u5b57\u5217\u306f\u4f7f\u308f\u308c\u3066\u3044\u306a\u3044\uff08\u304b\u6b63\u3057\u304f\u52d5\u4f5c\u3057\u306a\u3044\uff09\u306e\u3060\u308d\u3046\u3002\n\n\n## v0.2 > \u81ea\u524d\u5909\u63db\n\n```Unit1.cpp\n//---------------------------------------------------------------------------\n\n#include <vcl.h>\n#pragma hdrstop\n\n#include <DateUtils.hpp>\n#include \"Unit1.h\"\n//---------------------------------------------------------------------------\n#pragma package(smart_init)\n#pragma resource \"*.dfm\"\nTForm1 *Form1;\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner)\n\t: TForm(Owner)\n{\n}\n//---------------------------------------------------------------------------\n\nstatic const TDate kDate_startNewEra = VarToDateTime(\"2016/01/01\");\n\n\nvoid __fastcall TForm1::Button1Click(TObject *Sender)\n{\n\tTDateTime startdt = VarToDateTime(\"2017/01/11 12:30:45\");\n\n\tString strdt = FormatDateTime(L\"ggee\u5e74mm\u6708dd\u65e5\", startdt);\n\tOutputDebugString(strdt.c_str());\n\n\tTDateTime backdt;\n\ttry {\n\t\tbackdt = VarToDateTime(strdt);\n\t} catch (...) {\n\t\t// Not (.NET Framework 4 or native)\n\t\tString wrk = strdt.SubString(3, MAXINT); // \u5143\u53f72\u6587\u5b57\u3092\u9664\u53bb\n\t\tint startYear = kDate_startNewEra.FormatString(L\"YYYY\").ToInt();\n\t\tint addYear = startYear - 2000 - 1;\n\t\tbackdt = VarToDateTime(wrk);\n\t\tbackdt = IncYear(backdt, addYear);\n\t}\n\n\tOutputDebugString( DateTimeToStr(backdt).c_str() );\n}\n//---------------------------------------------------------------------------\n```\n\n```txt:\u7d50\u679c\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: \u5b87\u5b9902\u5e7401\u670811\u65e5 \u30d7\u30ed\u30bb\u30b9 Project1.exe (3668)\n\u30c7\u30d0\u30c3\u30b0\u51fa\u529b: 2017/01/11 \u30d7\u30ed\u30bb\u30b9 Project1.exe (3668)\n```\n\n\u529b\u6280\u3067\u5909\u63db\u3067\u304d\u305f\u3002\n\n\u3082\u3063\u3068\u826f\u3044\u5b9f\u88c5\u306f\u4ed6\u8005\u306b\u3086\u305a\u308b\u3002\n\n\n\n\n", "tags": ["cppBuilder", "TDateTime", ".NETFramework"]}