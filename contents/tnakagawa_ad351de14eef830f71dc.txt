{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u524d\u56de\u3001\u524d\u3005\u56de\u3001\u524d\u3005\u3005\u56de\u3092\u8e0f\u307e\u3048\u306a\u3093\u3068\u304b\u5b8c\u6210\uff1f\u307e\u3060\u307e\u3060\u6539\u826f\u306e\u4f59\u5730\u306f\u3042\u308b\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u30fb\u30fb\u30fb\n\n\u6a5f\u80fd\n\n\u5c65\u6b74\u306f\uff15\u4ef6\n\u5c65\u6b74\u304c\u4fdd\u5b58\u3055\u308c\u308b\n\u30c6\u30f3\u30d7\u30ec\u3082\u5909\u66f4\u53ef\u80fd\n\u30a4\u30f3\u30dd\u30fc\u30c8\u3001\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u53ef\u80fd\uff08localStorage\u304c\u524a\u9664\u3055\u308c\u3066\u3082\u5927\u4e08\u592b\u306a\u3088\u3046\u306b\uff09\n\n\n\u30bd\u30fc\u30b9\n\nCreateMail.html\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>\u30e1\u30fc\u30eb\u4f5c\u6210</title>\n    <style>\n            * {\n                font-family: MS Gothic;\n                font-size: 10.5pt;\n            }\n            html {\n                overflow-y: scroll;\n            }\n            button {\n                padding: 0.5em 1em;\n                border-radius: 5px;\n            }\n            input {\n                width: 99%;\n                height: 2em;\n                border-radius: 3px;\n                border: none;\n            }\n            select {\n                width: 100%;\n                height: 2em;\n                border-radius: 3px;\n            }\n            textarea {\n                border-radius: 3px;\n                border: none;\n            }\n            td {\n                border: 1px gray solid;\n                text-align: center;\n                border-radius: 3px;\n            }\n            #option {\n                color: gray;\n                margin: 1em 0em;\n                cursor: pointer;\n                -moz-user-select: none;\n                -webkit-user-select: none;\n                -ms-user-select: none;\n                vertical-align: middle;\n                display: table-cell;\n                height: 1.5em;\n            }\n            #template {\n                color: gray;\n                margin: 1em 0em;\n                cursor: pointer;\n                -moz-user-select: none;\n                -webkit-user-select: none;\n                -ms-user-select: none;\n            }\n            #main {\n                width: 800px;\n                margin-right: auto;\n                margin-left: auto;\n            }\n            #templateicon,#optionicon {\n                border: solid gray 1px;\n                border-radius: 3px;\n            }\n    </style>\n    <script>\n        var LOCAL_STORAGE_KEY = \"createmailinfo\";\n        var MAX_HISTORY_LENGTH = 5;\n        var info = {\n            subject : \"[__category__]__who__[__mmdd__]\",\n            body : \"\u5404\u4f4d\\n\\n\u304a\u75b2\u308c\u69d8\u3067\u3059\u3002\\n\\n\u672c\u65e5(__mmdd__)__hhmm__\u9803\u3001__who__\u3088\u308a\u96fb\u8a71\u9023\u7d61\u304c\u3042\u308a\u3001\\n\"\n                + \"__reason____category__\u3068\u306e\u3053\u3068\u3067\u3059\u3002\\n\\n\u4ee5\u4e0a\u3001\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3044\u305f\u3057\u307e\u3059\u3002\\n\",\n            hist : {\n                toaddr : [],\n                who : [],\n                category : [\"\u9045\u523b\", \"\u5168\u4f11\", \"\u534a\u4f11\"],\n                reason : [],\n            }\n        }\n        var reader = null;\n        function init() {\n            document.getElementById(\"createbtn\").addEventListener(\"click\", createEmail, true);\n            document.getElementById(\"resetbtn\").addEventListener(\"click\", reload, true);\n            document.getElementById(\"registbtn\").addEventListener(\"click\", registTemplate, true);\n            document.getElementById(\"option\").addEventListener(\"click\", toggleOption, true);\n            document.getElementById(\"template\").addEventListener(\"click\", toggleOption, true);\n            document.getElementById(\"importbtn\").addEventListener(\"click\", importHistory, true);\n            document.getElementById(\"exportbtn\").addEventListener(\"click\", exportHistory, true);\n            document.getElementById(\"removebtn\").addEventListener(\"click\", removeStorage, true);\n            document.getElementById(\"importfile\").addEventListener(\"change\", importFile, true);\n            document.getElementById(\"mmdd\").value = getFormatDate(\"yyyy-mm-dd\");\n            document.getElementById(\"hhmm\").value = getFormatDate(\"HH:MM\");\n            document.getElementById(\"mmdd\").addEventListener(\"change\", changeSubBody, true);\n            document.getElementById(\"hhmm\").addEventListener(\"change\", changeSubBody, true);\n            document.getElementById(\"who\").addEventListener(\"input\", changeSubBody, true);\n            document.getElementById(\"category\").addEventListener(\"input\", changeSubBody, true);\n            document.getElementById(\"reason\").addEventListener(\"input\", changeSubBody, true);\n            getInfoData();\n            document.getElementById(\"templatesubject\").value = info.subject;\n            document.getElementById(\"templatebody\").value = info.body;\n            setInfo();\n            changeSubBody();\n            reader = new FileReader();\n            reader.onload = loadedFile;\n        }\n        function createEmail(event) {\n            var toaddr = document.getElementById(\"toaddr\").value;\n            var subject = document.getElementById(\"subject\").value;\n            var body = document.getElementById(\"body\").value;\n            var message = \"\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067\u3001\" + toaddr + \"\u5b9b\u306e\u30e1\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u304c\u3088\u308d\u3057\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\\n\"\n                + \"\u984c\u540d:\" + subject + \"\\n=====\u672c\u6587\u3000\u3053\u3053\u304b\u3089=====\\n\" + body + \"\\n=====\u672c\u6587\u3000\u3053\u3053\u307e\u3067=====\";\n            if (confirm(message)) {\n                location.href = \"mailto:\" + encodeURIComponent(toaddr) + \"?subject=\" + encodeURIComponent(subject) + \"&body=\" + encodeURIComponent(body);\n                var data = {\n                    toaddr : document.getElementById(\"toaddr\").value,\n                    who : document.getElementById(\"who\").value,\n                    category : document.getElementById(\"category\").value,\n                    reason : document.getElementById(\"reason\").value,\n                };\n                for (var key in data) {\n                    if (data[key]) {\n                        var array = [data[key]];\n                        for (var i = 0; i < info.hist[key].length; i++) {\n                            if (i > MAX_HISTORY_LENGTH) {\n                                break;\n                            }\n                            if (data[key] !== info.hist[key][i]) {\n                                array.push(info.hist[key][i]);\n                            }\n                        }\n                        info.hist[key] = array;\n                    }\n                }\n                setInfo();\n                setInfoData();\n            }\n        }\n        function registTemplate(event) {\n            var subject = document.getElementById(\"templatesubject\").value;\n            var body = document.getElementById(\"templatebody\").value;\n            var message = \"\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u767b\u9332\u3057\u307e\u3059\u304c\u3088\u308d\u3057\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\\n\"\n                + \"\u203b\u203b\u203b\u3000\u767b\u9332\u5f8c\u3001\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u3002\u3000\u203b\u203b\u203b\\n\"\n                + \"\u984c\u540d:\" + subject\n                + \"\\n=====\u672c\u6587\u3000\u3053\u3053\u304b\u3089=====\\n\" + body + \"\\n=====\u672c\u6587\u3000\u3053\u3053\u307e\u3067=====\\n\";\n            if (confirm(message)) {\n                info.body = body;\n                info.subject = subject;\n                setInfoData();\n                reload();\n            }\n        }\n        function changeSubBody(event) {\n            var data = {\n                mmdd : (\"\" + document.getElementById(\"mmdd\").value).split(\"-\").join(\"/\").substring(5),\n                hhmm : document.getElementById(\"hhmm\").value,\n                who : document.getElementById(\"who\").value,\n                category : document.getElementById(\"category\").value,\n                reason : document.getElementById(\"reason\").value,\n            };\n            var subject = info.subject;\n            var body = info.body;\n            for (var key in data) {\n                subject = subject.split(\"__\" + key + \"__\").join(data[key]);\n                body = body.split(\"__\" + key + \"__\").join(data[key]);\n            }\n            document.getElementById(\"subject\").value = subject;\n            document.getElementById(\"body\").value = body;\n        }\n        function setInfo() {\n            for (var key in info.hist) {\n                var element = document.getElementById(key + \"list\");\n                while (element.firstChild) { element.removeChild(element.firstChild); }\n                var val = info.hist[key];\n                if (val.length > 0) {\n                    for (var i = 0; i < val.length; i++) {\n                        var option = document.createElement(\"option\");\n                        option.setAttribute(\"value\", val[i]);\n                        element.appendChild(option);\n                    }\n                }\n            }\n        }\n        function setInfoData() {\n            localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(info));\n        }\n        function getInfoData(target) {\n            var data =  target;\n            if (!data) {\n                data = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n            }\n            if (data) {\n                for (var key in info.hist) {\n                    try {\n                        var item = data.hist[key];\n                        if (item) {\n                            var array = [];\n                            info.hist[key] = array.concat(item);\n                        }\n                    } catch(e) {\n                        console.log(e.message);\n                    }\n                }\n                if (data.subject) {\n                    info.subject = \"\" + data.subject;\n                }\n                if (data.body) {\n                    info.body = \"\" + data.body;\n                }\n            }\n        }\n        function toggleOption(event) {\n            try {\n                var id = event.currentTarget.id;\n                var disp = document.getElementById(id + \"content\").style.display;\n                if (disp === \"none\") {\n                    document.getElementById(id + \"icon\").innerHTML = \"\uff0d\";\n                    document.getElementById(id + \"content\").style.display = \"block\";\n                } else {\n                    document.getElementById(id + \"icon\").innerHTML = \"\uff0b\";\n                    document.getElementById(id + \"content\").style.display = \"none\";\n                }\n                event.stopPropagation();\n            } catch(e) {\n                console.log(e.message);\n            }\n        }\n        function removeStorage(event) {\n            if (confirm(\"\u5c65\u6b74\u3092\u5168\u3066\u6d88\u3057\u307e\u3059\u304c\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\")) {\n                localStorage.removeItem(LOCAL_STORAGE_KEY);\n                reload();\n            }\n        }\n        function importHistory(event) {\n            document.getElementById(\"importfile\").click();\n        }\n        function importFile(event) {\n            var file = event.target.files[0];\n            reader.readAsText(file);\n        }\n        function loadedFile(event) {\n            var data = JSON.parse(event.target.result);\n            getInfoData(data);\n            setInfoData();\n            reload();\n        }\n        function exportHistory(event) {\n            var blob = new Blob([ JSON.stringify(info, null, \"\\t\") ], {\"type\": \"application/json\"});\n            var url = URL.createObjectURL(blob);\n            var a = document.getElementById(\"exportlink\");\n            a.setAttribute(\"download\", LOCAL_STORAGE_KEY + \"_\" + getFormatDate(\"yyyymmddHHMMss\") + \".json\");\n            a.href = url;\n            a.click();\n            URL.revokeObjectURL(url);\n            a.href = null;\n        }\n        function getFormatDate(target) {\n            var format = null;\n            if (target) {\n                var now = new Date();\n                var yyyy = now.getFullYear();\n                var mm = (now.getMonth() < 9) ? (\"0\" + (now.getMonth() + 1)) :  (\"\" + (now.getMonth() + 1));\n                var dd = (now.getDate() < 10) ? (\"0\" + now.getDate()) :  (\"\" + now.getDate());\n                var HH = (now.getHours() < 10) ? (\"0\" + now.getHours()) :  (\"\" + now.getHours());\n                var MM = (now.getMinutes() < 10) ? (\"0\" + now.getMinutes()) :  (\"\" + now.getMinutes());\n                var ss = (now.getSeconds() < 10) ? (\"0\" + now.getSeconds()) :  (\"\" + now.getSeconds());\n                format = target;\n                format = format.split(\"yyyy\").join(yyyy);\n                format = format.split(\"mm\").join(mm);\n                format = format.split(\"dd\").join(dd);\n                format = format.split(\"HH\").join(HH);\n                format = format.split(\"MM\").join(MM);\n                format = format.split(\"ss\").join(ss);\n            }\n            return format;\n        }\n        function reload() {\n            location.reload();\n        }\n        window.onload = init;\n    </script>\n</head>\n<body>\n    <div id=\"main\">\n        <table>\n            <tr><td style=\"width: 80px\">\u5b9b\u5148</td><td style=\"width: 400px\">\n                <input id=\"toaddr\" type=\"text\" list=\"toaddrlist\" value=\"\" placeholder=\"----- \u9001\u4fe1\u5148\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4f8b\uff09test@sample.com -----\" />\n                <datalist id=\"toaddrlist\"></datalist>\n            </td></tr>\n            <tr><td>\u6708\u65e5</td><td><input id=\"mmdd\" type=\"date\" value=\"\" /></td></tr>\n            <tr><td>\u6642\u5206</td><td><input id=\"hhmm\" type=\"time\" value=\"\" /></td></tr>\n            <tr><td>\u8ab0\uff1f</td><td>\n                <input id=\"who\" type=\"text\" list=\"wholist\" placeholder=\"----- \u5bfe\u8c61\u8005\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4f8b\uff09\u9234\u6728\u3055\u3093 -----\" />\n                <datalist id=\"wholist\"></datalist>\n            </td></tr>\n            <tr><td>\u533a\u5206</td><td>\n                <input id=\"category\" type=\"text\" list=\"categorylist\" placeholder=\"----- \u4f11\u6687\u533a\u5206\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4f8b\uff09\u9045\u523b -----\" />\n                <datalist id=\"categorylist\"></datalist>\n            </td></tr>\n            <tr><td>\u7406\u7531</td><td>\n                <input id=\"reason\" type=\"text\" placeholder=\"----- \u7406\u7531\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4f8b\uff09\u96fb\u8eca\u9045\u5ef6\u306e\u70ba\u300130\u5206\u307b\u3069 -----\" list=\"reasonlist\" />\n                <datalist id=\"reasonlist\"></datalist>\n            </td></tr>\n            <tr><td>\u984c\u540d</td><td><input id=\"subject\" type=\"text\" value=\"\" placeholder=\"----- \u30e1\u30fc\u30eb\u306e\u984c\u540d\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002 -----\" /></td></tr>\n            <tr><td>\u672c\u6587</td><td><textarea id=\"body\" cols=\"80\" rows=\"12\"  placeholder=\"----- \u30e1\u30fc\u30eb\u306e\u672c\u6587\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002 -----\"></textarea></td></tr>\n            <tr><td style=\"border: none; text-align: right;\" colspan=\"2\">\n                <button id=\"resetbtn\">\u30ea\u30bb\u30c3\u30c8</button>\n                <button id=\"createbtn\">\u30e1\u30fc\u30eb\u4f5c\u6210</button>\n            </td></tr>\n        </table>\n        <div id=\"template\">\n            <span id=\"templateicon\">\uff0b</span>\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n        </div>\n        <div id=\"templatecontent\" style=\"display: none;\">\n            <table>\n                <tr><td style=\"width: 80px\">\u5b9b\u5148</td><td style=\"width: 400px\">\n                    <input id=\"templatesubject\" type=\"text\" value=\"\" placeholder=\"----- \u30e1\u30fc\u30eb\u306e\u984c\u540d\uff08\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\uff09\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002 -----\" />\n                </td></tr>\n                <tr><td>\u672c\u6587</td><td><textarea id=\"templatebody\" cols=\"80\" rows=\"12\"  placeholder=\"----- \u30e1\u30fc\u30eb\u306e\u672c\u6587\uff08\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\uff09\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002 -----\"></textarea></td></tr>\n                <tr><td style=\"border: none; text-align: right;\" colspan=\"2\">\n                    <button id=\"registbtn\">\u767b\u9332</button>\n                </td></tr>\n            </table>\n        </div>\n        <div id=\"option\">\n            <span id=\"optionicon\">\uff0b</span>\u30aa\u30d7\u30b7\u30e7\u30f3\n        </div>\n        <div id=\"optioncontent\" style=\"display: none;\">\n            <button id=\"importbtn\">\u30a4\u30f3\u30dd\u30fc\u30c8</button><span id=\"importarea\" style=\"display: none;\"><input id=\"importfile\" type=\"file\"></span>\n            <button id=\"exportbtn\">\u30a8\u30af\u30b9\u30dd\u30fc\u30c8</button><a id=\"exportlink\" download=\"\"></a>\n            <button id=\"removebtn\">\u30b9\u30c8\u30ec\u30fc\u30b8\u524a\u9664</button>\n        </div>\n    </div>\n</body>\n</html>\n\n\n\n\u3055\u3044\u3054\u306b\n\u30ed\u30fc\u30ab\u30ebHTML\u3067\u3082\u6848\u5916\u30a2\u30d7\u30ea\u3063\u3066\u4f5c\u308c\u308b\u3093\u3067\u3059\u306a\u3041\n##\u306f\u3058\u3081\u306b\n\n[\u524d\u56de](http://qiita.com/tnakagawa/items/b7df12d7ff35269c01fa)\u3001[\u524d\u3005\u56de](http://qiita.com/tnakagawa/items/69be0fe53c830782bb8d)\u3001[\u524d\u3005\u3005\u56de](http://qiita.com/tnakagawa/items/b4a4160f13fcbcf66f83)\u3092\u8e0f\u307e\u3048\u306a\u3093\u3068\u304b\u5b8c\u6210\uff1f\u307e\u3060\u307e\u3060\u6539\u826f\u306e\u4f59\u5730\u306f\u3042\u308b\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u30fb\u30fb\u30fb\n\n##\u6a5f\u80fd\n\n- \u5c65\u6b74\u306f\uff15\u4ef6\n- \u5c65\u6b74\u304c\u4fdd\u5b58\u3055\u308c\u308b\n- \u30c6\u30f3\u30d7\u30ec\u3082\u5909\u66f4\u53ef\u80fd\n- \u30a4\u30f3\u30dd\u30fc\u30c8\u3001\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u53ef\u80fd\uff08localStorage\u304c\u524a\u9664\u3055\u308c\u3066\u3082\u5927\u4e08\u592b\u306a\u3088\u3046\u306b\uff09\n\n\n##\u30bd\u30fc\u30b9\n\n```html:CreateMail.html\n<!DOCTYPE html>\n<html>\n<head>\n\t<meta charset=\"utf-8\">\n\t<title>\u30e1\u30fc\u30eb\u4f5c\u6210</title>\n\t<style>\n\t\t\t* {\n\t\t\t\tfont-family: MS Gothic;\n\t\t\t\tfont-size: 10.5pt;\n\t\t\t}\n\t\t\thtml {\n\t\t\t\toverflow-y: scroll;\n\t\t\t}\n\t\t\tbutton {\n\t\t\t\tpadding: 0.5em 1em;\n\t\t\t\tborder-radius: 5px;\n\t\t\t}\n\t\t\tinput {\n\t\t\t\twidth: 99%;\n\t\t\t\theight: 2em;\n\t\t\t\tborder-radius: 3px;\n\t\t\t\tborder: none;\n\t\t\t}\n\t\t\tselect {\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 2em;\n\t\t\t\tborder-radius: 3px;\n\t\t\t}\n\t\t\ttextarea {\n\t\t\t\tborder-radius: 3px;\n\t\t\t\tborder: none;\n\t\t\t}\n\t\t\ttd {\n\t\t\t\tborder: 1px gray solid;\n\t\t\t\ttext-align: center;\n\t\t\t\tborder-radius: 3px;\n\t\t\t}\n\t\t\t#option {\n\t\t\t\tcolor: gray;\n\t\t\t\tmargin: 1em 0em;\n\t\t\t\tcursor: pointer;\n\t\t\t\t-moz-user-select: none;\n\t\t\t\t-webkit-user-select: none;\n\t\t\t\t-ms-user-select: none;\n\t\t\t\tvertical-align: middle;\n\t\t\t\tdisplay: table-cell;\n\t\t\t\theight: 1.5em;\n\t\t\t}\n\t\t\t#template {\n\t\t\t\tcolor: gray;\n\t\t\t\tmargin: 1em 0em;\n\t\t\t\tcursor: pointer;\n\t\t\t\t-moz-user-select: none;\n\t\t\t\t-webkit-user-select: none;\n\t\t\t\t-ms-user-select: none;\n\t\t\t}\n\t\t\t#main {\n\t\t\t\twidth: 800px;\n\t\t\t\tmargin-right: auto;\n\t\t\t\tmargin-left: auto;\n\t\t\t}\n\t\t\t#templateicon,#optionicon {\n\t\t\t\tborder: solid gray 1px;\n\t\t\t\tborder-radius: 3px;\n\t\t\t}\n\t</style>\n\t<script>\n\t\tvar LOCAL_STORAGE_KEY = \"createmailinfo\";\n\t\tvar MAX_HISTORY_LENGTH = 5;\n\t\tvar info = {\n\t\t\tsubject : \"[__category__]__who__[__mmdd__]\",\n\t\t\tbody : \"\u5404\u4f4d\\n\\n\u304a\u75b2\u308c\u69d8\u3067\u3059\u3002\\n\\n\u672c\u65e5(__mmdd__)__hhmm__\u9803\u3001__who__\u3088\u308a\u96fb\u8a71\u9023\u7d61\u304c\u3042\u308a\u3001\\n\"\n\t\t\t\t+ \"__reason____category__\u3068\u306e\u3053\u3068\u3067\u3059\u3002\\n\\n\u4ee5\u4e0a\u3001\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3044\u305f\u3057\u307e\u3059\u3002\\n\",\n\t\t\thist : {\n\t\t\t\ttoaddr : [],\n\t\t\t\twho : [],\n\t\t\t\tcategory : [\"\u9045\u523b\", \"\u5168\u4f11\", \"\u534a\u4f11\"],\n\t\t\t\treason : [],\n\t\t\t}\n\t\t}\n\t\tvar reader = null;\n\t\tfunction init() {\n\t\t\tdocument.getElementById(\"createbtn\").addEventListener(\"click\", createEmail, true);\n\t\t\tdocument.getElementById(\"resetbtn\").addEventListener(\"click\", reload, true);\n\t\t\tdocument.getElementById(\"registbtn\").addEventListener(\"click\", registTemplate, true);\n\t\t\tdocument.getElementById(\"option\").addEventListener(\"click\", toggleOption, true);\n\t\t\tdocument.getElementById(\"template\").addEventListener(\"click\", toggleOption, true);\n\t\t\tdocument.getElementById(\"importbtn\").addEventListener(\"click\", importHistory, true);\n\t\t\tdocument.getElementById(\"exportbtn\").addEventListener(\"click\", exportHistory, true);\n\t\t\tdocument.getElementById(\"removebtn\").addEventListener(\"click\", removeStorage, true);\n\t\t\tdocument.getElementById(\"importfile\").addEventListener(\"change\", importFile, true);\n\t\t\tdocument.getElementById(\"mmdd\").value = getFormatDate(\"yyyy-mm-dd\");\n\t\t\tdocument.getElementById(\"hhmm\").value = getFormatDate(\"HH:MM\");\n\t\t\tdocument.getElementById(\"mmdd\").addEventListener(\"change\", changeSubBody, true);\n\t\t\tdocument.getElementById(\"hhmm\").addEventListener(\"change\", changeSubBody, true);\n\t\t\tdocument.getElementById(\"who\").addEventListener(\"input\", changeSubBody, true);\n\t\t\tdocument.getElementById(\"category\").addEventListener(\"input\", changeSubBody, true);\n\t\t\tdocument.getElementById(\"reason\").addEventListener(\"input\", changeSubBody, true);\n\t\t\tgetInfoData();\n\t\t\tdocument.getElementById(\"templatesubject\").value = info.subject;\n\t\t\tdocument.getElementById(\"templatebody\").value = info.body;\n\t\t\tsetInfo();\n\t\t\tchangeSubBody();\n\t\t\treader = new FileReader();\n\t\t\treader.onload = loadedFile;\n\t\t}\n\t\tfunction createEmail(event) {\n\t\t\tvar toaddr = document.getElementById(\"toaddr\").value;\n\t\t\tvar subject = document.getElementById(\"subject\").value;\n\t\t\tvar body = document.getElementById(\"body\").value;\n\t\t\tvar message = \"\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067\u3001\" + toaddr + \"\u5b9b\u306e\u30e1\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u304c\u3088\u308d\u3057\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\\n\"\n\t\t\t\t+ \"\u984c\u540d:\" + subject + \"\\n=====\u672c\u6587\u3000\u3053\u3053\u304b\u3089=====\\n\" + body + \"\\n=====\u672c\u6587\u3000\u3053\u3053\u307e\u3067=====\";\n\t\t\tif (confirm(message)) {\n\t\t\t\tlocation.href = \"mailto:\" + encodeURIComponent(toaddr) + \"?subject=\" + encodeURIComponent(subject) + \"&body=\" + encodeURIComponent(body);\n\t\t\t\tvar data = {\n\t\t\t\t\ttoaddr : document.getElementById(\"toaddr\").value,\n\t\t\t\t\twho : document.getElementById(\"who\").value,\n\t\t\t\t\tcategory : document.getElementById(\"category\").value,\n\t\t\t\t\treason : document.getElementById(\"reason\").value,\n\t\t\t\t};\n\t\t\t\tfor (var key in data) {\n\t\t\t\t\tif (data[key]) {\n\t\t\t\t\t\tvar array = [data[key]];\n\t\t\t\t\t\tfor (var i = 0; i < info.hist[key].length; i++) {\n\t\t\t\t\t\t\tif (i > MAX_HISTORY_LENGTH) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (data[key] !== info.hist[key][i]) {\n\t\t\t\t\t\t\t\tarray.push(info.hist[key][i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinfo.hist[key] = array;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsetInfo();\n\t\t\t\tsetInfoData();\n\t\t\t}\n\t\t}\n\t\tfunction registTemplate(event) {\n\t\t\tvar subject = document.getElementById(\"templatesubject\").value;\n\t\t\tvar body = document.getElementById(\"templatebody\").value;\n\t\t\tvar message = \"\u4ee5\u4e0b\u306e\u5185\u5bb9\u3067\u3001\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u767b\u9332\u3057\u307e\u3059\u304c\u3088\u308d\u3057\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\\n\"\n\t\t\t\t+ \"\u203b\u203b\u203b\u3000\u767b\u9332\u5f8c\u3001\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u3002\u3000\u203b\u203b\u203b\\n\"\n\t\t\t\t+ \"\u984c\u540d:\" + subject\n\t\t\t\t+ \"\\n=====\u672c\u6587\u3000\u3053\u3053\u304b\u3089=====\\n\" + body + \"\\n=====\u672c\u6587\u3000\u3053\u3053\u307e\u3067=====\\n\";\n\t\t\tif (confirm(message)) {\n\t\t\t\tinfo.body = body;\n\t\t\t\tinfo.subject = subject;\n\t\t\t\tsetInfoData();\n\t\t\t\treload();\n\t\t\t}\n\t\t}\n\t\tfunction changeSubBody(event) {\n\t\t\tvar data = {\n\t\t\t\tmmdd : (\"\" + document.getElementById(\"mmdd\").value).split(\"-\").join(\"/\").substring(5),\n\t\t\t\thhmm : document.getElementById(\"hhmm\").value,\n\t\t\t\twho : document.getElementById(\"who\").value,\n\t\t\t\tcategory : document.getElementById(\"category\").value,\n\t\t\t\treason : document.getElementById(\"reason\").value,\n\t\t\t};\n\t\t\tvar subject = info.subject;\n\t\t\tvar body = info.body;\n\t\t\tfor (var key in data) {\n\t\t\t\tsubject = subject.split(\"__\" + key + \"__\").join(data[key]);\n\t\t\t\tbody = body.split(\"__\" + key + \"__\").join(data[key]);\n\t\t\t}\n\t\t\tdocument.getElementById(\"subject\").value = subject;\n\t\t\tdocument.getElementById(\"body\").value = body;\n\t\t}\n\t\tfunction setInfo() {\n\t\t\tfor (var key in info.hist) {\n\t\t\t\tvar element = document.getElementById(key + \"list\");\n\t\t\t\twhile (element.firstChild) { element.removeChild(element.firstChild); }\n\t\t\t\tvar val = info.hist[key];\n\t\t\t\tif (val.length > 0) {\n\t\t\t\t\tfor (var i = 0; i < val.length; i++) {\n\t\t\t\t\t\tvar option = document.createElement(\"option\");\n\t\t\t\t\t\toption.setAttribute(\"value\", val[i]);\n\t\t\t\t\t\telement.appendChild(option);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction setInfoData() {\n\t\t\tlocalStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(info));\n\t\t}\n\t\tfunction getInfoData(target) {\n\t\t\tvar data =  target;\n\t\t\tif (!data) {\n\t\t\t\tdata = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n\t\t\t}\n\t\t\tif (data) {\n\t\t\t\tfor (var key in info.hist) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar item = data.hist[key];\n\t\t\t\t\t\tif (item) {\n\t\t\t\t\t\t\tvar array = [];\n\t\t\t\t\t\t\tinfo.hist[key] = array.concat(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(e.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (data.subject) {\n\t\t\t\t\tinfo.subject = \"\" + data.subject;\n\t\t\t\t}\n\t\t\t\tif (data.body) {\n\t\t\t\t\tinfo.body = \"\" + data.body;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction toggleOption(event) {\n\t\t\ttry {\n\t\t\t\tvar id = event.currentTarget.id;\n\t\t\t\tvar disp = document.getElementById(id + \"content\").style.display;\n\t\t\t\tif (disp === \"none\") {\n\t\t\t\t\tdocument.getElementById(id + \"icon\").innerHTML = \"\uff0d\";\n\t\t\t\t\tdocument.getElementById(id + \"content\").style.display = \"block\";\n\t\t\t\t} else {\n\t\t\t\t\tdocument.getElementById(id + \"icon\").innerHTML = \"\uff0b\";\n\t\t\t\t\tdocument.getElementById(id + \"content\").style.display = \"none\";\n\t\t\t\t}\n\t\t\t\tevent.stopPropagation();\n\t\t\t} catch(e) {\n\t\t\t\tconsole.log(e.message);\n\t\t\t}\n\t\t}\n\t\tfunction removeStorage(event) {\n\t\t\tif (confirm(\"\u5c65\u6b74\u3092\u5168\u3066\u6d88\u3057\u307e\u3059\u304c\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\")) {\n\t\t\t\tlocalStorage.removeItem(LOCAL_STORAGE_KEY);\n\t\t\t\treload();\n\t\t\t}\n\t\t}\n\t\tfunction importHistory(event) {\n\t\t\tdocument.getElementById(\"importfile\").click();\n\t\t}\n\t\tfunction importFile(event) {\n\t\t\tvar file = event.target.files[0];\n\t\t\treader.readAsText(file);\n\t\t}\n\t\tfunction loadedFile(event) {\n\t\t\tvar data = JSON.parse(event.target.result);\n\t\t\tgetInfoData(data);\n\t\t\tsetInfoData();\n\t\t\treload();\n\t\t}\n\t\tfunction exportHistory(event) {\n\t\t\tvar blob = new Blob([ JSON.stringify(info, null, \"\\t\") ], {\"type\": \"application/json\"});\n\t\t\tvar url = URL.createObjectURL(blob);\n\t\t\tvar a = document.getElementById(\"exportlink\");\n\t\t\ta.setAttribute(\"download\", LOCAL_STORAGE_KEY + \"_\" + getFormatDate(\"yyyymmddHHMMss\") + \".json\");\n\t\t\ta.href = url;\n\t\t\ta.click();\n\t\t\tURL.revokeObjectURL(url);\n\t\t\ta.href = null;\n\t\t}\n\t\tfunction getFormatDate(target) {\n\t\t\tvar format = null;\n\t\t\tif (target) {\n\t\t\t\tvar now = new Date();\n\t\t\t\tvar yyyy = now.getFullYear();\n\t\t\t\tvar mm = (now.getMonth() < 9) ? (\"0\" + (now.getMonth() + 1)) :  (\"\" + (now.getMonth() + 1));\n\t\t\t\tvar dd = (now.getDate() < 10) ? (\"0\" + now.getDate()) :  (\"\" + now.getDate());\n\t\t\t\tvar HH = (now.getHours() < 10) ? (\"0\" + now.getHours()) :  (\"\" + now.getHours());\n\t\t\t\tvar MM = (now.getMinutes() < 10) ? (\"0\" + now.getMinutes()) :  (\"\" + now.getMinutes());\n\t\t\t\tvar ss = (now.getSeconds() < 10) ? (\"0\" + now.getSeconds()) :  (\"\" + now.getSeconds());\n\t\t\t\tformat = target;\n\t\t\t\tformat = format.split(\"yyyy\").join(yyyy);\n\t\t\t\tformat = format.split(\"mm\").join(mm);\n\t\t\t\tformat = format.split(\"dd\").join(dd);\n\t\t\t\tformat = format.split(\"HH\").join(HH);\n\t\t\t\tformat = format.split(\"MM\").join(MM);\n\t\t\t\tformat = format.split(\"ss\").join(ss);\n\t\t\t}\n\t\t\treturn format;\n\t\t}\n\t\tfunction reload() {\n\t\t\tlocation.reload();\n\t\t}\n\t\twindow.onload = init;\n\t</script>\n</head>\n<body>\n\t<div id=\"main\">\n\t\t<table>\n\t\t\t<tr><td style=\"width: 80px\">\u5b9b\u5148</td><td style=\"width: 400px\">\n\t\t\t\t<input id=\"toaddr\" type=\"text\" list=\"toaddrlist\" value=\"\" placeholder=\"----- \u9001\u4fe1\u5148\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4f8b\uff09test@sample.com -----\" />\n\t\t\t\t<datalist id=\"toaddrlist\"></datalist>\n\t\t\t</td></tr>\n\t\t\t<tr><td>\u6708\u65e5</td><td><input id=\"mmdd\" type=\"date\" value=\"\" /></td></tr>\n\t\t\t<tr><td>\u6642\u5206</td><td><input id=\"hhmm\" type=\"time\" value=\"\" /></td></tr>\n\t\t\t<tr><td>\u8ab0\uff1f</td><td>\n\t\t\t\t<input id=\"who\" type=\"text\" list=\"wholist\" placeholder=\"----- \u5bfe\u8c61\u8005\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4f8b\uff09\u9234\u6728\u3055\u3093 -----\" />\n\t\t\t\t<datalist id=\"wholist\"></datalist>\n\t\t\t</td></tr>\n\t\t\t<tr><td>\u533a\u5206</td><td>\n\t\t\t\t<input id=\"category\" type=\"text\" list=\"categorylist\" placeholder=\"----- \u4f11\u6687\u533a\u5206\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4f8b\uff09\u9045\u523b -----\" />\n\t\t\t\t<datalist id=\"categorylist\"></datalist>\n\t\t\t</td></tr>\n\t\t\t<tr><td>\u7406\u7531</td><td>\n\t\t\t\t<input id=\"reason\" type=\"text\" placeholder=\"----- \u7406\u7531\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4f8b\uff09\u96fb\u8eca\u9045\u5ef6\u306e\u70ba\u300130\u5206\u307b\u3069 -----\" list=\"reasonlist\" />\n\t\t\t\t<datalist id=\"reasonlist\"></datalist>\n\t\t\t</td></tr>\n\t\t\t<tr><td>\u984c\u540d</td><td><input id=\"subject\" type=\"text\" value=\"\" placeholder=\"----- \u30e1\u30fc\u30eb\u306e\u984c\u540d\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002 -----\" /></td></tr>\n\t\t\t<tr><td>\u672c\u6587</td><td><textarea id=\"body\" cols=\"80\" rows=\"12\"  placeholder=\"----- \u30e1\u30fc\u30eb\u306e\u672c\u6587\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002 -----\"></textarea></td></tr>\n\t\t\t<tr><td style=\"border: none; text-align: right;\" colspan=\"2\">\n\t\t\t\t<button id=\"resetbtn\">\u30ea\u30bb\u30c3\u30c8</button>\n\t\t\t\t<button id=\"createbtn\">\u30e1\u30fc\u30eb\u4f5c\u6210</button>\n\t\t\t</td></tr>\n\t\t</table>\n\t\t<div id=\"template\">\n\t\t\t<span id=\"templateicon\">\uff0b</span>\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\t\t</div>\n\t\t<div id=\"templatecontent\" style=\"display: none;\">\n\t\t\t<table>\n\t\t\t\t<tr><td style=\"width: 80px\">\u5b9b\u5148</td><td style=\"width: 400px\">\n\t\t\t\t\t<input id=\"templatesubject\" type=\"text\" value=\"\" placeholder=\"----- \u30e1\u30fc\u30eb\u306e\u984c\u540d\uff08\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\uff09\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002 -----\" />\n\t\t\t\t</td></tr>\n\t\t\t\t<tr><td>\u672c\u6587</td><td><textarea id=\"templatebody\" cols=\"80\" rows=\"12\"  placeholder=\"----- \u30e1\u30fc\u30eb\u306e\u672c\u6587\uff08\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\uff09\u3092\u8a18\u5165\u3057\u3066\u304f\u3060\u3055\u3044\u3002 -----\"></textarea></td></tr>\n\t\t\t\t<tr><td style=\"border: none; text-align: right;\" colspan=\"2\">\n\t\t\t\t\t<button id=\"registbtn\">\u767b\u9332</button>\n\t\t\t\t</td></tr>\n\t\t\t</table>\n\t\t</div>\n\t\t<div id=\"option\">\n\t\t\t<span id=\"optionicon\">\uff0b</span>\u30aa\u30d7\u30b7\u30e7\u30f3\n\t\t</div>\n\t\t<div id=\"optioncontent\" style=\"display: none;\">\n\t\t\t<button id=\"importbtn\">\u30a4\u30f3\u30dd\u30fc\u30c8</button><span id=\"importarea\" style=\"display: none;\"><input id=\"importfile\" type=\"file\"></span>\n\t\t\t<button id=\"exportbtn\">\u30a8\u30af\u30b9\u30dd\u30fc\u30c8</button><a id=\"exportlink\" download=\"\"></a>\n\t\t\t<button id=\"removebtn\">\u30b9\u30c8\u30ec\u30fc\u30b8\u524a\u9664</button>\n\t\t</div>\n\t</div>\n</body>\n</html>\n```\n\n##\u3055\u3044\u3054\u306b\n\n\u30ed\u30fc\u30ab\u30ebHTML\u3067\u3082\u6848\u5916\u30a2\u30d7\u30ea\u3063\u3066\u4f5c\u308c\u308b\u3093\u3067\u3059\u306a\u3041\n\n", "tags": ["HTML5", "JavaScript", "localStorage"]}