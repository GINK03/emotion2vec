{"context": " More than 1 year has passed since last update.\u5927\u91cf\u306eWord\u3001Excel,PPT\u3092PDF\u306b\u5909\u63db\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u4ed5\u4e8b\u304c\u3042\u308b\u3002\n\u3057\u304b\u3082\u3001\u5168\u90e8\u304c\u5b8c\u6210\u3057\u3066\u308b\u308f\u3051\u3058\u3083\u306a\u3044\u306e\u3067\u3001\u4fee\u6b63\u306b\u5fdc\u3058\u3066\u518d\u5ea6\u30ea\u30ea\u30fc\u30b9\u30fb\u30fb\u30fb\u3002\n\u81ea\u52d5\u5316\u3059\u308b\u306b\u304d\u307e\u3063\u3066\u307e\u3059\u3002\n\n\u4e0b\u6e96\u5099\n\n\n\ntarget directory\ntarget filename\ndestination directory\ndestination filename\noptions\n\n\n\n\n\n\u3063\u3066\u5f62\u3067\u30b7\u30fc\u30c8\u3092\u4f5c\u3063\u3066\u304a\u304f\u3002\n\nOptions for Word\n\n\n\ntarget directory\ntarget filename\ndestination directory\ndestination filename\nfromPage\ntoPage\n\n\n\n\n\nfromPage\u304c0\u306a\u3089\u3001\u5168\u90e8\u51fa\u529b\u3002\u305d\u3046\u3067\u306a\u3051\u308c\u3070\u3001\u6307\u5b9a\u3057\u305f\u30da\u30fc\u30b8\u7bc4\u56f2\u3060\u3051PDF\u51fa\u529b\u3002\n\nOptions for Excel\n\n\n\ntarget directory\ntarget filename\ndestination directory\ndestination filename\ntargetSheet\n\n\n\n\n\n\nOptions for PowerPoint\n\n\n\ntarget directory\ntarget filename\ndestination directory\ndestination filename\nfromPage\ntoPage\noutputFormat\n\n\n\n\n\noutputFormat={Note,Slide}\nSlide\u306b\u3059\u308b\u3068\u30012in1\u306b\u306a\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\n\n\u30de\u30af\u30ed\nExcel VBA\u3067\u3059\u3002\nOption Explicit\n\n\n' 2014/05/08 kencoba\n\nPublic Sub ToPDF()\n    Dim i As Integer\n    i = 2\n\n    With Worksheets(\"Sheet1\")\n\n    Do While .Cells(i, 2).Value <> \"\"\n\n        Dim inputDir As String\n        Dim inputFile As String\n        Dim outputDir As String\n        Dim outputFile As String\n\n        inputDir = .Cells(i, 1)\n        inputFile = .Cells(i, 2)\n        outputDir = .Cells(i, 3)\n        outputFile = .Cells(i, 4)\n\n        Dim target As String\n        Dim destination As String\n\n        target = inputDir & \"\\\" & inputFile\n        destination = outputDir & \"\\\" & outputFile\n\n        Dim fs As Object\n        Set fs = CreateObject(\"Scripting.FileSystemObject\")\n\n\n        Dim targetSheet As String\n        Dim fromPage As Integer\n        Dim toPage As Integer\n        Dim outputFormat As String\n\n\n        If LCase(fs.GetExtensionName(target)) = \"xls\" Or _\n            LCase(fs.GetExtensionName(target)) = \"xlsx\" Then\n\n            targetSheet = .Cells(i, 5)\n\n            Call Excel2PDF(target, destination, targetSheet)\n\n        ElseIf LCase(fs.GetExtensionName(target)) = \"doc\" Or _\n               LCase(fs.GetExtensionName(target)) = \"docx\" Then\n\n            fromPage = .Cells(i, 5)\n            toPage = .Cells(i, 6)\n\n            Call Word2PDF(target, destination, fromPage, toPage)\n\n        ElseIf LCase(fs.GetExtensionName(target)) = \"ppt\" Or _\n               LCase(fs.GetExtensionName(target)) = \"pptx\" Then\n\n            fromPage = .Cells(i, 5)\n            toPage = .Cells(i, 6)\n            outputFormat = .Cells(i, 7)\n\n            Call PPT2PDF(target, destination, fromPage, toPage, outputFormat)\n\n        End If\n\n        i = i + 1\n    Loop\n\n    End With\n\nEnd Sub\n\nPrivate Sub Word2PDF(ByRef target As String, ByRef destination As String, ByVal fromPage As Integer, ByVal toPage As Integer)\n  Dim wordObj As Word.Application\n  Set wordObj = CreateObject(\"Word.Application\")\n  wordObj.Visible = True\n\n  Dim doc As Word.Document\n  Set doc = wordObj.Documents.Open(target)\n\n  If fromPage = 0 Then\n      doc.ExportAsFixedFormat _\n          OutputFileName:=destination, _\n          ExportFormat:=wdExportFormatPDF\n  Else\n      doc.ExportAsFixedFormat _\n          OutputFileName:=destination, _\n          ExportFormat:=wdExportFormatPDF, _\n          Range:=wdExportFromTo, _\n          From:=fromPage, _\n          To:=toPage\n  End If\n\n  wordObj.Documents.Close\n\n  wordObj.Quit\n  Set wordObj = Nothing\nEnd Sub\n\nPrivate Sub Excel2PDF(ByRef target As String, ByRef destination As String, ByVal targetSheet As String)\n  Dim excelObj As Excel.Application\n  Set excelObj = CreateObject(\"Excel.Application\")\n  excelObj.Visible = True\n\n  Dim book As Excel.Workbook\n  Set book = excelObj.Workbooks.Open(target)\n\n  Dim xlSheet As Excel.Worksheet\n  Set xlSheet = book.Worksheets(targetSheet)\n\n  xlSheet.ExportAsFixedFormat xlTypePDF, destination, xlQualityStandard\n\n  book.Close\n\n  excelObj.Quit\n  Set excelObj = Nothing\nEnd Sub\n\nPrivate Sub PPT2PDF(ByRef target As String, ByRef destination As String, ByVal fromPage As Integer, ByVal toPage As Integer, ByVal outputFormat As String)\n  Dim pptObj As PowerPoint.Application\n  Set pptObj = CreateObject(\"PowerPoint.Application\")\n  pptObj.Visible = True\n\n  Dim pres As PowerPoint.Presentation\n  Set pres = pptObj.Presentations.Open(target)\n\n  Dim prng As PrintRange\n  pres.PrintOptions.Ranges.ClearAll\n  Set prng = pres.PrintOptions.Ranges.Add(fromPage, toPage)\n\n  If outputFormat = \"Note\" Then\n        pres.ExportAsFixedFormat _\n            Path:=destination, _\n            FixedFormatType:=ppFixedFormatTypePDF, _\n            outputType:=ppPrintOutputNotesPages, _\n            PrintHiddenSlides:=msoTrue, _\n            PrintRange:=prng\n  ElseIf outputFormat = \"Slide\" Then\n        pres.ExportAsFixedFormat _\n            Path:=destination, _\n            FixedFormatType:=ppFixedFormatTypePDF, _\n            outputType:=ppPrintOutputTwoSlideHandouts, _\n            FrameSlides:=msoTrue, _\n            PrintHiddenSlides:=msoTrue, _\n            PrintRange:=prng\n  End If\n\n  pres.Close\n\n  pptObj.Quit\n  Set pptObj = Nothing\nEnd Sub\n\n\n\u5927\u91cf\u306eWord\u3001Excel,PPT\u3092PDF\u306b\u5909\u63db\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u4ed5\u4e8b\u304c\u3042\u308b\u3002\n\u3057\u304b\u3082\u3001\u5168\u90e8\u304c\u5b8c\u6210\u3057\u3066\u308b\u308f\u3051\u3058\u3083\u306a\u3044\u306e\u3067\u3001\u4fee\u6b63\u306b\u5fdc\u3058\u3066\u518d\u5ea6\u30ea\u30ea\u30fc\u30b9\u30fb\u30fb\u30fb\u3002\n\u81ea\u52d5\u5316\u3059\u308b\u306b\u304d\u307e\u3063\u3066\u307e\u3059\u3002\n\n# \u4e0b\u6e96\u5099\n\n|target directory|target filename|destination directory|destination filename| options|\n----|----|----|----|----\n\n\u3063\u3066\u5f62\u3067\u30b7\u30fc\u30c8\u3092\u4f5c\u3063\u3066\u304a\u304f\u3002\n## Options for Word\n|target directory|target filename|destination directory|destination filename| fromPage|toPage|\n----|----|----|----|----|----\n\nfromPage\u304c0\u306a\u3089\u3001\u5168\u90e8\u51fa\u529b\u3002\u305d\u3046\u3067\u306a\u3051\u308c\u3070\u3001\u6307\u5b9a\u3057\u305f\u30da\u30fc\u30b8\u7bc4\u56f2\u3060\u3051PDF\u51fa\u529b\u3002\n\n## Options for Excel\n|target directory|target filename|destination directory|destination filename| targetSheet|\n----|----|----|----|----\n\n## Options for PowerPoint\n|target directory|target filename|destination directory|destination filename| fromPage|toPage| outputFormat|\n----|----|----|----|----|----|----\n\noutputFormat={Note,Slide}\n\nSlide\u306b\u3059\u308b\u3068\u30012in1\u306b\u306a\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\n\n# \u30de\u30af\u30ed\n\nExcel VBA\u3067\u3059\u3002\n\n```vbnet\nOption Explicit\n\n\n' 2014/05/08 kencoba\n\nPublic Sub ToPDF()\n    Dim i As Integer\n    i = 2\n    \n    With Worksheets(\"Sheet1\")\n    \n    Do While .Cells(i, 2).Value <> \"\"\n        \n        Dim inputDir As String\n        Dim inputFile As String\n        Dim outputDir As String\n        Dim outputFile As String\n        \n        inputDir = .Cells(i, 1)\n        inputFile = .Cells(i, 2)\n        outputDir = .Cells(i, 3)\n        outputFile = .Cells(i, 4)\n        \n        Dim target As String\n        Dim destination As String\n        \n        target = inputDir & \"\\\" & inputFile\n        destination = outputDir & \"\\\" & outputFile\n        \n        Dim fs As Object\n        Set fs = CreateObject(\"Scripting.FileSystemObject\")\n        \n        \n        Dim targetSheet As String\n        Dim fromPage As Integer\n        Dim toPage As Integer\n        Dim outputFormat As String\n        \n        \n        If LCase(fs.GetExtensionName(target)) = \"xls\" Or _\n            LCase(fs.GetExtensionName(target)) = \"xlsx\" Then\n               \n            targetSheet = .Cells(i, 5)\n               \n            Call Excel2PDF(target, destination, targetSheet)\n               \n        ElseIf LCase(fs.GetExtensionName(target)) = \"doc\" Or _\n               LCase(fs.GetExtensionName(target)) = \"docx\" Then\n            \n            fromPage = .Cells(i, 5)\n            toPage = .Cells(i, 6)\n            \n            Call Word2PDF(target, destination, fromPage, toPage)\n            \n        ElseIf LCase(fs.GetExtensionName(target)) = \"ppt\" Or _\n               LCase(fs.GetExtensionName(target)) = \"pptx\" Then\n            \n            fromPage = .Cells(i, 5)\n            toPage = .Cells(i, 6)\n            outputFormat = .Cells(i, 7)\n            \n            Call PPT2PDF(target, destination, fromPage, toPage, outputFormat)\n            \n        End If\n        \n        i = i + 1\n    Loop\n    \n    End With\n    \nEnd Sub\n\nPrivate Sub Word2PDF(ByRef target As String, ByRef destination As String, ByVal fromPage As Integer, ByVal toPage As Integer)\n  Dim wordObj As Word.Application\n  Set wordObj = CreateObject(\"Word.Application\")\n  wordObj.Visible = True\n\n  Dim doc As Word.Document\n  Set doc = wordObj.Documents.Open(target)\n  \n  If fromPage = 0 Then\n      doc.ExportAsFixedFormat _\n          OutputFileName:=destination, _\n          ExportFormat:=wdExportFormatPDF\n  Else\n      doc.ExportAsFixedFormat _\n          OutputFileName:=destination, _\n          ExportFormat:=wdExportFormatPDF, _\n          Range:=wdExportFromTo, _\n          From:=fromPage, _\n          To:=toPage\n  End If\n  \n  wordObj.Documents.Close\n\n  wordObj.Quit\n  Set wordObj = Nothing\nEnd Sub\n\nPrivate Sub Excel2PDF(ByRef target As String, ByRef destination As String, ByVal targetSheet As String)\n  Dim excelObj As Excel.Application\n  Set excelObj = CreateObject(\"Excel.Application\")\n  excelObj.Visible = True\n\n  Dim book As Excel.Workbook\n  Set book = excelObj.Workbooks.Open(target)\n  \n  Dim xlSheet As Excel.Worksheet\n  Set xlSheet = book.Worksheets(targetSheet)\n\n  xlSheet.ExportAsFixedFormat xlTypePDF, destination, xlQualityStandard\n\n  book.Close\n\n  excelObj.Quit\n  Set excelObj = Nothing\nEnd Sub\n\nPrivate Sub PPT2PDF(ByRef target As String, ByRef destination As String, ByVal fromPage As Integer, ByVal toPage As Integer, ByVal outputFormat As String)\n  Dim pptObj As PowerPoint.Application\n  Set pptObj = CreateObject(\"PowerPoint.Application\")\n  pptObj.Visible = True\n\n  Dim pres As PowerPoint.Presentation\n  Set pres = pptObj.Presentations.Open(target)\n  \n  Dim prng As PrintRange\n  pres.PrintOptions.Ranges.ClearAll\n  Set prng = pres.PrintOptions.Ranges.Add(fromPage, toPage)\n\n  If outputFormat = \"Note\" Then\n        pres.ExportAsFixedFormat _\n            Path:=destination, _\n            FixedFormatType:=ppFixedFormatTypePDF, _\n            outputType:=ppPrintOutputNotesPages, _\n            PrintHiddenSlides:=msoTrue, _\n            PrintRange:=prng\n  ElseIf outputFormat = \"Slide\" Then\n        pres.ExportAsFixedFormat _\n            Path:=destination, _\n            FixedFormatType:=ppFixedFormatTypePDF, _\n            outputType:=ppPrintOutputTwoSlideHandouts, _\n            FrameSlides:=msoTrue, _\n            PrintHiddenSlides:=msoTrue, _\n            PrintRange:=prng\n  End If\n\n  pres.Close\n\n  pptObj.Quit\n  Set pptObj = Nothing\nEnd Sub\n\n```\n", "tags": ["ExcelVBA"]}