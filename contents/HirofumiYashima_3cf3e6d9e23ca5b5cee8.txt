{"tags": ["R", "\u6642\u7cfb\u5217\u89e3\u6790", "\u30c7\u30fc\u30bf\u5206\u6790", "\u7d71\u8a08\u5b66", "statistics"], "context": " More than 1 year has passed since last update.\n\n\uff08 \u95a2\u9023\u8a18\u4e8b \uff09\n\n\n\u6295\u7a3f\u8005 Qiita\u8a18\u4e8b (2014/05/09) \u300c\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u5206\u6790\u306e\u521d\u5fc3\u8005\u306b\u5fc5\u305a\u77e5\u3063\u3066\u3082\u3089\u3044\u305f\u3044\u91cd\u8981\u30dd\u30a4\u30f3\u30c8\uff1a\u56de\u5e30\u5206\u6790 \u30fb\u76f8\u95a2\u95a2\u4fc2\u5206\u6790\u3092\u884c\u3046\u524d\u306b\u5fc5\u305a\u3084\u308b\u3079\u304d\u3053\u3068\uff08\u30c7\u30fc\u30bf\u306e\u5f62\u306e\u30c1\u30a7\u30c3\u30af\u3068\u5909\u5f62\uff09\u300d\n\n\n\n\u7528\u610f\u3057\u305f\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u304c\u3001\uff08\u305d\u306e\u307e\u307e\u306e\u5f62\u3067\uff09\u30c7\u30fc\u30bf\u89e3\u6790\u306b\u4f7f\u3063\u3066\u554f\u984c\u306a\u3044\u30c7\u30fc\u30bf\u306a\u306e\u304b\u3001\u305d\u308c\u3068\u3082 \u975e\u5b9a\u5e38\u904e\u7a0b\u306e\u30c7\u30fc\u30bf\u306e\u305f\u3081\u3001N\u6b21\u306e\u968e\u5dee\u7cfb\u5217\u30c7\u30fc\u30bf\u306b\u5909\u3048\u3066\u304b\u3089\uff08diff(data, N)\uff09 \u30c7\u30fc\u30bf\u5206\u6790\u306b\u3064\u304b\u308f\u306a\u3044\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u7d50\u679c\u304c\u4fe1\u983c\u3067\u304d\u306a\u3044\u6570\u5024\u306b\u306a\u308b\u5371\u306a\u3044\u30c7\u30fc\u30bf\u306a\u306e\u304b\u3001\u5358\u4f4d\u6839\u691c\u5b9a adf.test()\u3092\u81ea\u52d5\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3001\u305d\u306e\u30c7\u30fc\u30bf\u306e\u53d6\u308a\u6271\u3044\u65b9\u3092\u6559\u3048\u3066\u304f\u308c\u308b\u95a2\u6570\u3092\u81ea\u4f5c\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\n\u3010 ADF\u691c\u5b9a (ADF test) \u3068\u306f \u3011\n\n\n\u5e30\u7121\u4eee\u8aac (Null hypothesis)\uff1a a = 1\n\u203b\u300c\u30c7\u30fc\u30bf\u306f\u975e\u5b9a\u5e38\u904e\u7a0b\u3067\u3042\u308b\u300d\n\nADF\u691c\u5b9a\u3092\u884c\u3063\u305f\u7d50\u679c\u3001p\u5024\u304c 5%\u57fa\u6e96\u306a\u3069\u3001\u8a2d\u5b9a\u3057\u305f\u6709\u610f\u6c34\u6e96\u3088\u308a\u5c0f\u3055\u3044\u6570\u5024\u3067\u3042\u308c\u3070\u3001\u5e30\u7121\u4eee\u8aac\u306f\u68c4\u5374\u3055\u308c\u308b\n\u3010\u89e3\u91c8\u3011\u691c\u5b9a\u3057\u305f\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306f\u3001\u300c\u975e\u5b9a\u5e38\u30c7\u30fc\u30bf\u3067\u3042\u308b\u3068\u306f\u3044\u3044\u304d\u308c\u306a\u3044\u300d\n\n\n\u3010 \u6642\u7cfb\u5217\u30c7\u30fc\u30bf \u304c\u305d\u306e\u307e\u307e\u3067\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u3048\u308b\u72b6\u614b\u304b\u3001N\u6b21\u306e\u968e\u5dee\u3092\u53d6\u308b\u5fc5\u8981\u3042\u308b\u304b\u3092\u81ea\u52d5\u5224\u5b9a\u3059\u308b\u95a2\u6570 \u3011\n\n\n\uff08\u95a2\u6570\u306e\u4ed5\u69d8\uff09\n\n\n\n\u5f15\u6570 : \u4f7f\u7528\u6642\u7cfb\u5217\u30c7\u30fc\u30bf \u3068 \u5358\u4f4d\u6839\u691c\u5b9a\u306e\u6709\u610f\u6c34\u6e96\u5024\uff080.05\u306a\u3069\uff09\n\n\u8fd4\u308a\u5024 : \u30c7\u30fc\u30bf\u304c\u5b9a\u5e38\u904e\u7a0b\u304b\u3001\u975e\u5b9a\u5e38\u904e\u7a0b\u304b\u306e\u5224\u5b9a\u7d50\u679c\u3002\u975e\u5b9a\u5e38\u306e\u5834\u5408\u3001\u4f55\u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u5b9a\u5e38\u306b\u306a\u308b\u304b\u306e\u6b21\u6570\u3002\uff0810\u6b21\u306e\u968e\u5dee\u3092\u3068\u3063\u305f\u4e0a\u3067 adf.test()\u3057\u3066\u3082\u975e\u5b9a\u5e38\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u65e8\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\uff09\n\n\nR\nunit_root_check_2 <- function(data, criteria) {\n  require(tseries)\n  result <- adf.test(UKgas)\n\n  p_value <- result$p.value\n  i <- 0\n\n  if (p_value < as.numeric(criteria)) \n    message <- '\u3053\u306e\u30c7\u30fc\u30bf\u3092\u3053\u306e\u307e\u307e\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3057\u3066\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002'\n  else {\n     result_renewed <- as.list(NULL)\n\n     while(p_value > as.numeric(criteria)) \n       {\n            i <- i+1\n            result_renewed <- adf.test(diff(data, i))\n            p_value <- result_renewed$p.value\n            if (i==11) {message <- '\u968e\u5dee\u309210\u671f\u9593\u307e\u3067\u3068\u3063\u3066\u3082\u975e\u5b9a\u5e38\u3067\u3057\u305f\u3002\u3053\u306e\u30c7\u30fc\u30bf\u306f\u5206\u6790\u306b\u5411\u3044\u3066\u3044\u307e\u305b\u3093\u3002'\n                        break\n                        }\n            else message <- paste('\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001', i, '\u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002')\n       }\n  }\n  return(list(message=message, lag_order=i))\n}\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\nmode(unit_root_check_2)\n\n[1] \"function\"\n\nstr(unit_root_check_2)\n\nfunction (data, criteria)  \n - attr(*, \"srcref\")=Class 'srcref'  atomic [1:8] 1 22 25 1 22 1 1 25\n  .. ..- attr(*, \"srcfile\")=Classes 'srcfilecopy', 'srcfile' <environment: 0x0d5e187c> \n\n\n\n\u3010 \u95a2\u6570\u306e\u52d5\u4f5c\u78ba\u8a8d \u3011\n\n( \u5b9f\u884c\u30b3\u30fc\u30c9 )\n\nR\ntseries_data = UKgas\nsignificance_level = 0.05\n\ncheck_result <- unit_root_check_2(tseries_data, significance_level)\nprint(check_result)\n\nprint(mode(check_result))\nprint(str(check_result))\n\nprint(check_result$message)\nprint(check_result$lag_order)\n\n\n\uff08 \u5b9f\u884c\u7d50\u679c )\n> check_result <- unit_root_check_2(tseries_data, significance_level)\nWarning message:\nIn adf.test(diff(data, i)) : p-value smaller than printed p-value\n\n> print(check_result)\n$message\n[1] \"\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001 1 \u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\"\n\n$lag_order\n[1] 1\n\n> \n> print(mode(check_result))\n[1] \"list\"\n\n> print(str(check_result))\nList of 2\n $ message  : chr \"\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001 1 \u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\"\n $ lag_order: num 1\nNULL\n> \n> print(check_result$message)\n[1] \"\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001 1 \u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\"\n> print(check_result$lag_order)\n[1] 1\n\n\n\u3010 \u4ee5\u4e0a \u3011\n\n\n\n\uff08 \u4ee5\u4e0b\u3001\u53c2\u8003 \uff09\n\n\nR\nrequire(tseries)\n\n# ts.plot(UKgas)\n\nadf.test(UKgas)\n# Augmented Dickey-Fuller Test\n# data:  UKgas\n# Dickey-Fuller = -1.6079, Lag order = 4, p-value = 0.7393\n# alternative hypothesis: stationary\n\nadf.result <- adf.test(UKgas)\nmode(adf.result)\n\n# [1] \"list\"\n\nstr(adf.result)\n# List of 6\n#  $ statistic  : Named num -1.61\n#   ..- attr(*, \"names\")= chr \"Dickey-Fuller\"\n#  $ parameter  : Named num 4\n#   ..- attr(*, \"names\")= chr \"Lag order\"\n#  $ alternative: chr \"stationary\"\n#  $ p.value    : num 0.739\n#  $ method     : chr \"Augmented Dickey-Fuller Test\"\n#  $ data.name  : chr \"UKgas\"\n#  - attr(*, \"class\")= chr \"htest\"\n\nadf.result$p.value\n# [1] 0.7392833\n\n\n\n###__\uff08 \u95a2\u9023\u8a18\u4e8b \uff09__\n#### __[\u6295\u7a3f\u8005 Qiita\u8a18\u4e8b (2014/05/09) \u300c\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u5206\u6790\u306e\u521d\u5fc3\u8005\u306b\u5fc5\u305a\u77e5\u3063\u3066\u3082\u3089\u3044\u305f\u3044\u91cd\u8981\u30dd\u30a4\u30f3\u30c8\uff1a\u56de\u5e30\u5206\u6790 \u30fb\u76f8\u95a2\u95a2\u4fc2\u5206\u6790\u3092\u884c\u3046\u524d\u306b\u5fc5\u305a\u3084\u308b\u3079\u304d\u3053\u3068\uff08\u30c7\u30fc\u30bf\u306e\u5f62\u306e\u30c1\u30a7\u30c3\u30af\u3068\u5909\u5f62\uff09\u300d](http://qiita.com/HirofumiYashima/items/b6dabe412c868d271410)__\n\n___\n\n#### __\u7528\u610f\u3057\u305f\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u304c\u3001\uff08\u305d\u306e\u307e\u307e\u306e\u5f62\u3067\uff09\u30c7\u30fc\u30bf\u89e3\u6790\u306b\u4f7f\u3063\u3066\u554f\u984c\u306a\u3044\u30c7\u30fc\u30bf\u306a\u306e\u304b\u3001\u305d\u308c\u3068\u3082 \u975e\u5b9a\u5e38\u904e\u7a0b\u306e\u30c7\u30fc\u30bf\u306e\u305f\u3081\u3001N\u6b21\u306e\u968e\u5dee\u7cfb\u5217\u30c7\u30fc\u30bf\u306b\u5909\u3048\u3066\u304b\u3089\uff08diff(data, N)\uff09 \u30c7\u30fc\u30bf\u5206\u6790\u306b\u3064\u304b\u308f\u306a\u3044\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u7d50\u679c\u304c\u4fe1\u983c\u3067\u304d\u306a\u3044\u6570\u5024\u306b\u306a\u308b\u5371\u306a\u3044\u30c7\u30fc\u30bf\u306a\u306e\u304b\u3001\u5358\u4f4d\u6839\u691c\u5b9a adf.test()\u3092\u81ea\u52d5\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3001\u305d\u306e\u30c7\u30fc\u30bf\u306e\u53d6\u308a\u6271\u3044\u65b9\u3092\u6559\u3048\u3066\u304f\u308c\u308b\u95a2\u6570\u3092\u81ea\u4f5c\u3057\u3066\u307f\u307e\u3057\u305f\u3002__\n\n### __\u3010 ADF\u691c\u5b9a (ADF test) \u3068\u306f \u3011__\n\n* \u5e30\u7121\u4eee\u8aac (Null hypothesis)\uff1a a = 1\n \u203b\u300c\u30c7\u30fc\u30bf\u306f\u975e\u5b9a\u5e38\u904e\u7a0b\u3067\u3042\u308b\u300d\n\nADF\u691c\u5b9a\u3092\u884c\u3063\u305f\u7d50\u679c\u3001_p_\u5024\u304c 5%\u57fa\u6e96\u306a\u3069\u3001\u8a2d\u5b9a\u3057\u305f\u6709\u610f\u6c34\u6e96\u3088\u308a\u5c0f\u3055\u3044\u6570\u5024\u3067\u3042\u308c\u3070\u3001\u5e30\u7121\u4eee\u8aac\u306f\u68c4\u5374\u3055\u308c\u308b\n\u3010\u89e3\u91c8\u3011\u691c\u5b9a\u3057\u305f\u6642\u7cfb\u5217\u30c7\u30fc\u30bf\u306f\u3001\u300c\u975e\u5b9a\u5e38\u30c7\u30fc\u30bf\u3067\u3042\u308b\u3068\u306f\u3044\u3044\u304d\u308c\u306a\u3044\u300d\n\n___\n\n## __\u3010 \u6642\u7cfb\u5217\u30c7\u30fc\u30bf \u304c\u305d\u306e\u307e\u307e\u3067\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u3048\u308b\u72b6\u614b\u304b\u3001N\u6b21\u306e\u968e\u5dee\u3092\u53d6\u308b\u5fc5\u8981\u3042\u308b\u304b\u3092\u81ea\u52d5\u5224\u5b9a\u3059\u308b\u95a2\u6570 \u3011__\n\n#### __\uff08\u95a2\u6570\u306e\u4ed5\u69d8\uff09__\n* __\u5f15\u6570__ : \u4f7f\u7528\u6642\u7cfb\u5217\u30c7\u30fc\u30bf \u3068 \u5358\u4f4d\u6839\u691c\u5b9a\u306e\u6709\u610f\u6c34\u6e96\u5024\uff080.05\u306a\u3069\uff09\n* __\u8fd4\u308a\u5024__ : \u30c7\u30fc\u30bf\u304c\u5b9a\u5e38\u904e\u7a0b\u304b\u3001\u975e\u5b9a\u5e38\u904e\u7a0b\u304b\u306e\u5224\u5b9a\u7d50\u679c\u3002\u975e\u5b9a\u5e38\u306e\u5834\u5408\u3001\u4f55\u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u5b9a\u5e38\u306b\u306a\u308b\u304b\u306e\u6b21\u6570\u3002\uff0810\u6b21\u306e\u968e\u5dee\u3092\u3068\u3063\u305f\u4e0a\u3067 adf.test()\u3057\u3066\u3082\u975e\u5b9a\u5e38\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u65e8\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\uff09\n\n\n```{R:R}\nunit_root_check_2 <- function(data, criteria) {\n  require(tseries)\n  result <- adf.test(UKgas)\n  \n  p_value <- result$p.value\n  i <- 0\n  \n  if (p_value < as.numeric(criteria)) \n    message <- '\u3053\u306e\u30c7\u30fc\u30bf\u3092\u3053\u306e\u307e\u307e\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3057\u3066\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002'\n  else {\n     result_renewed <- as.list(NULL)\n         \n     while(p_value > as.numeric(criteria)) \n       {\n            i <- i+1\n            result_renewed <- adf.test(diff(data, i))\n            p_value <- result_renewed$p.value\n            if (i==11) {message <- '\u968e\u5dee\u309210\u671f\u9593\u307e\u3067\u3068\u3063\u3066\u3082\u975e\u5b9a\u5e38\u3067\u3057\u305f\u3002\u3053\u306e\u30c7\u30fc\u30bf\u306f\u5206\u6790\u306b\u5411\u3044\u3066\u3044\u307e\u305b\u3093\u3002'\n                        break\n                        }\n            else message <- paste('\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001', i, '\u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002')\n       }\n  }\n  return(list(message=message, lag_order=i))\n}\n```\n\n### __\u52d5\u4f5c\u78ba\u8a8d__\n\n```\nmode(unit_root_check_2)\n```\n\n\n```\n[1] \"function\"\n```\n\n\n```\nstr(unit_root_check_2)\n```\n\n\n```\nfunction (data, criteria)  \n - attr(*, \"srcref\")=Class 'srcref'  atomic [1:8] 1 22 25 1 22 1 1 25\n  .. ..- attr(*, \"srcfile\")=Classes 'srcfilecopy', 'srcfile' <environment: 0x0d5e187c> \n```\n\n___\n\n### __\u3010 \u95a2\u6570\u306e\u52d5\u4f5c\u78ba\u8a8d \u3011__\n\n__( \u5b9f\u884c\u30b3\u30fc\u30c9 )__\n\n```{R:R}\ntseries_data = UKgas\nsignificance_level = 0.05\n\ncheck_result <- unit_root_check_2(tseries_data, significance_level)\nprint(check_result)\n\nprint(mode(check_result))\nprint(str(check_result))\n\nprint(check_result$message)\nprint(check_result$lag_order)\n```\n\n\n__\uff08 \u5b9f\u884c\u7d50\u679c )__\n\n```\n> check_result <- unit_root_check_2(tseries_data, significance_level)\nWarning message:\nIn adf.test(diff(data, i)) : p-value smaller than printed p-value\n\n> print(check_result)\n$message\n[1] \"\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001 1 \u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\"\n\n$lag_order\n[1] 1\n\n> \n> print(mode(check_result))\n[1] \"list\"\n\n> print(str(check_result))\nList of 2\n $ message  : chr \"\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001 1 \u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\"\n $ lag_order: num 1\nNULL\n> \n> print(check_result$message)\n[1] \"\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001 1 \u6b21\u306e\u968e\u5dee\u3092\u3068\u308b\u3068\u3001\u30c7\u30fc\u30bf\u5206\u6790\u306b\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\"\n> print(check_result$lag_order)\n[1] 1\n```\n\n\n\n## __\u3010 \u4ee5\u4e0a \u3011__\n\n___\n\n## __\uff08 \u4ee5\u4e0b\u3001\u53c2\u8003 \uff09__\n\n\n```{R:R}\nrequire(tseries)\n\n# ts.plot(UKgas)\n\nadf.test(UKgas)\n# Augmented Dickey-Fuller Test\n# data:  UKgas\n# Dickey-Fuller = -1.6079, Lag order = 4, p-value = 0.7393\n# alternative hypothesis: stationary\n\nadf.result <- adf.test(UKgas)\nmode(adf.result)\n\n# [1] \"list\"\n\nstr(adf.result)\n# List of 6\n#  $ statistic  : Named num -1.61\n#   ..- attr(*, \"names\")= chr \"Dickey-Fuller\"\n#  $ parameter  : Named num 4\n#   ..- attr(*, \"names\")= chr \"Lag order\"\n#  $ alternative: chr \"stationary\"\n#  $ p.value    : num 0.739\n#  $ method     : chr \"Augmented Dickey-Fuller Test\"\n#  $ data.name  : chr \"UKgas\"\n#  - attr(*, \"class\")= chr \"htest\"\n\nadf.result$p.value\n# [1] 0.7392833\n```\n\n"}