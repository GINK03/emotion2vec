{"context": " More than 1 year has passed since last update.Puppet\u306e\u6587\u6cd5\u30c1\u30a7\u30c3\u30af\u307e\u3068\u3081\u3002\n\u30de\u30cb\u30d5\u30a7\u30b9\u30c8(pp)\u3068\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8(erb)\u3068Hiera(yaml)\u3002\npuppet\u5b9f\u884c\u6642\u30a8\u30e9\u30fc\u3060\u3068\u3001\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30a8\u30e9\u30fc\u304c\u539f\u56e0\u306a\u306e\u304c\u5206\u304b\u308a\u306b\u304f\u3044\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u30e1\u30e2\u3002\n\n\u30de\u30cb\u30d5\u30a7\u30b9\u30c8(pp)\n\n*.pp\npuppet parser validate example.pp\n\n\n\u30a8\u30e9\u30fc\u4f8b\n[root@web01 manifests]# puppet parser validate site.pp\nError: Could not parse for environment production: Syntax error at '}' at /etc/puppet/manifests/site.pp:9\n\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8(erb)\n\n*.erb\nerb -P -x -T '-' example.erb | ruby -c\n\n\n\u30a8\u30e9\u30fc\u4f8b\n<% %>\u3092\u9589\u3058\u5fd8\u308c\u305f\u4f8b\u3067\u3059\u304c\u3001\u3069\u306e\u884c\u304c\u30a8\u30e9\u30fc\u304b\u5206\u304b\u3089\u306a\u3044\u3002\u3002\u3002\u58ca\u308c\u3066\u3044\u306a\u3044\u304b\u306e\u30c1\u30a7\u30c3\u30af\u3050\u3089\u3044\uff1f\n[root@web01 web01]# erb -P -x -T '-' httpd.conf.erb | ruby -c\n-:59: syntax error, unexpected *\nInclude conf.modules.d/*.conf\n                        ^\n-:105: syntax error, unexpected '<', expecting end-of-input\n<Directory />\n ^\n\n\nHiera(yaml)\n\n*.yaml\nruby -e \"require 'yaml'; YAML.load_file('example.yaml')\"\n\n\n\u30a8\u30e9\u30fc\u4f8b\n[root@web01 hieradata]# ruby -e \"require 'yaml'; YAML.load_file('example.yaml')\"\n/usr/share/ruby/psych.rb:205:in `parse': (example.yaml): could not find expected ':' while scanning a simple key at line 8 column 1 (Psych::SyntaxError)\n    from /usr/share/ruby/psych.rb:205:in `parse_stream'\n    from /usr/share/ruby/psych.rb:153:in `parse'\n    from /usr/share/ruby/psych.rb:129:in `load'\n    from /usr/share/ruby/psych.rb:299:in `block in load_file'\n    from /usr/share/ruby/psych.rb:299:in `open'\n    from /usr/share/ruby/psych.rb:299:in `load_file'\n    from -e:1:in `<main>'\n\n\n\u4e00\u62ec\u30c1\u30a7\u30c3\u30af\nfind\u30b3\u30de\u30f3\u30c9\u7d50\u679c\u3067\u3001\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u30eb\u30fc\u30d7\u5b9f\u884c\u3057\u3066\u4e00\u62ec\u30c1\u30a7\u30c3\u30af\u3002\n\n*.pp\nfind /etc/puppet/ -name \"*.pp\" | while read file; do echo \"--- file=$file\"; puppet parser validate \"$file\"; done\n\n\n\n*.erb\nfind /etc/puppet/modules/ -name \"*.erb\" | while read file; do echo \"--- file=$file\"; erb -P -x -T '-' \"$file\" | ruby -c ; done\n\n\n\n*.yaml\nfind /etc/puppet/hieradata/ -name \"*.yaml\" | while read file; do echo \"--- file=$file\"; ruby -e \"require 'yaml'; YAML.load_file('$file')\"; done\n\n\n\n\u53c2\u8003\n\nhttps://puppetlabs.com/blog/verifying-puppet-checking-syntax-and-writing-automated-tests\nhttps://docs.puppetlabs.com/puppet/latest/reference/lang_template.html\nhttps://ask.puppetlabs.com/question/11000/does-puppet-provide-a-validationsyntax-checker-for-hiera/\n\nPuppet\u306e\u6587\u6cd5\u30c1\u30a7\u30c3\u30af\u307e\u3068\u3081\u3002\n\u30de\u30cb\u30d5\u30a7\u30b9\u30c8(pp)\u3068\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8(erb)\u3068Hiera(yaml)\u3002\npuppet\u5b9f\u884c\u6642\u30a8\u30e9\u30fc\u3060\u3068\u3001\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\u30a8\u30e9\u30fc\u304c\u539f\u56e0\u306a\u306e\u304c\u5206\u304b\u308a\u306b\u304f\u3044\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u30e1\u30e2\u3002\n\n#\u30de\u30cb\u30d5\u30a7\u30b9\u30c8(pp)\n\n```bash:*.pp\npuppet parser validate example.pp\n```\n\n\u30a8\u30e9\u30fc\u4f8b\n\n```text:\n[root@web01 manifests]# puppet parser validate site.pp\nError: Could not parse for environment production: Syntax error at '}' at /etc/puppet/manifests/site.pp:9\n```\n\n\n#\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8(erb)\n\n```bash:*.erb\nerb -P -x -T '-' example.erb | ruby -c\n```\n\n\u30a8\u30e9\u30fc\u4f8b\n<% %>\u3092\u9589\u3058\u5fd8\u308c\u305f\u4f8b\u3067\u3059\u304c\u3001\u3069\u306e\u884c\u304c\u30a8\u30e9\u30fc\u304b\u5206\u304b\u3089\u306a\u3044\u3002\u3002\u3002\u58ca\u308c\u3066\u3044\u306a\u3044\u304b\u306e\u30c1\u30a7\u30c3\u30af\u3050\u3089\u3044\uff1f\n\n```text:\n[root@web01 web01]# erb -P -x -T '-' httpd.conf.erb | ruby -c\n-:59: syntax error, unexpected *\nInclude conf.modules.d/*.conf\n                        ^\n-:105: syntax error, unexpected '<', expecting end-of-input\n<Directory />\n ^\n```\n\n#Hiera(yaml)\n\n```bash:*.yaml\nruby -e \"require 'yaml'; YAML.load_file('example.yaml')\"\n```\n\n\u30a8\u30e9\u30fc\u4f8b\n\n```text:\n[root@web01 hieradata]# ruby -e \"require 'yaml'; YAML.load_file('example.yaml')\"\n/usr/share/ruby/psych.rb:205:in `parse': (example.yaml): could not find expected ':' while scanning a simple key at line 8 column 1 (Psych::SyntaxError)\n\tfrom /usr/share/ruby/psych.rb:205:in `parse_stream'\n\tfrom /usr/share/ruby/psych.rb:153:in `parse'\n\tfrom /usr/share/ruby/psych.rb:129:in `load'\n\tfrom /usr/share/ruby/psych.rb:299:in `block in load_file'\n\tfrom /usr/share/ruby/psych.rb:299:in `open'\n\tfrom /usr/share/ruby/psych.rb:299:in `load_file'\n\tfrom -e:1:in `<main>'\n```\n\n# \u4e00\u62ec\u30c1\u30a7\u30c3\u30af\nfind\u30b3\u30de\u30f3\u30c9\u7d50\u679c\u3067\u3001\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u30eb\u30fc\u30d7\u5b9f\u884c\u3057\u3066\u4e00\u62ec\u30c1\u30a7\u30c3\u30af\u3002\n\n```bash:*.pp\nfind /etc/puppet/ -name \"*.pp\" | while read file; do echo \"--- file=$file\"; puppet parser validate \"$file\"; done\n```\n\n```bash:*.erb\nfind /etc/puppet/modules/ -name \"*.erb\" | while read file; do echo \"--- file=$file\"; erb -P -x -T '-' \"$file\" | ruby -c ; done\n```\n\n```bash:*.yaml\nfind /etc/puppet/hieradata/ -name \"*.yaml\" | while read file; do echo \"--- file=$file\"; ruby -e \"require 'yaml'; YAML.load_file('$file')\"; done\n```\n\n# \u53c2\u8003\n\n- https://puppetlabs.com/blog/verifying-puppet-checking-syntax-and-writing-automated-tests\n- https://docs.puppetlabs.com/puppet/latest/reference/lang_template.html\n- https://ask.puppetlabs.com/question/11000/does-puppet-provide-a-validationsyntax-checker-for-hiera/\n", "tags": ["Puppet"]}