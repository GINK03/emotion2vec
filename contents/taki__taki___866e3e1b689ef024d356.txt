{"context": "\u8ad6\u6587\u3092\u8aad\u3093\u3067\u3044\u305f\u3089ELM\uff01ELM\uff01\u3068\u4f55\u56de\u3082\u898b\u305f\u306e\u3067Google\u691c\u7d22\u3059\u308b\u3068\u30c7\u30f3\u30bd\u30fcIT\u30e9\u30dc\u30e9\u30c8\u30ea\u306e\u6280\u8853\u30d6\u30ed\u30b0\u304c\u30d2\u30c3\u30c8\u3057\u307e\u3057\u305f\u3002\n\nDenso IT Laboratory \u6280\u8853\u30d6\u30ed\u30b0 Extreme Learning Machine\n\n\u5b9f\u88c5\u304c\u7c21\u5358\u3068\u66f8\u3044\u3066\u3042\u3063\u305f\u306e\u3067\u3001\u66f8\u3044\u3066\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002Julia\u306f0.4.6\u3001\u30b0\u30e9\u30d5\u306fPyPlot\u3001\u4ed6\u306b\u306f\u4f55\u3082\u4f7f\u3063\u3066\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nusing PyPlot\n\n# \u8a13\u7df4\u30c7\u30fc\u30bf\nx = -10:0.1:10\nN = length(x)\ny = sinc(x)\nX = [ones(N) x]\nM = 2\n\n# \u6d3b\u6027\u5316\u95a2\u6570\nsigmoid(x) = 1 ./ (1 .+ exp(-x))\n\n# \u96a0\u308c\u30ce\u30fc\u30c9\u6570\nL = 64\n\n# \u30b0\u30e9\u30d5\u3092\u63cf\u304f (\u8a13\u7df4\u30c7\u30fc\u30bf)\nplot(x, y, \"r--\")\nsavefig(\"correct.png\")\n\n# ELM STEP1: \u30e9\u30f3\u30c0\u30e0\u306b\u4f5c\u6210\na = rand(L, M)\nb = rand(L)\n\n# ELM STEP2: \u96a0\u308c\u5c64\u306e\u51fa\u529b\u884c\u5217H\u3092\u751f\u6210\nH = zeros(N, L)\nfor i=1:N, l=1:L\n    H[i, l] = sigmoid( a[l, :]'*x[i,:] + b[l] )[1]\nend\n\n# ELM STEP3: T=H\u03b2\u306e\u89e3\u3092\u6c42\u3081\u308b\n\u03b2 = pinv(H) * y\n\n# \u4e88\u6e2c\u3059\u308b\ny_pred = zeros(N)\nfor i=1:N\n    for l=1:L\n        y_pred[i] += \u03b2[l] * sigmoid( a[l, :]' * x[i, :] + b[l] )[1]\n    end\nend\n\n# \u4e88\u6e2c\u3068\u6b63\u89e3\u3092\u91cd\u306d\u3066\u63cf\u304f\nplot(x, y, \"r--\")\nplot(x, y_pred, \"b--\")\nsavefig(\"compare_L=$L.png\")\n\n\n\u96a0\u308c\u5c64\u306e\u30ce\u30fc\u30c9\u6570L\u309264\u3067\u8a66\u3059\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3060\u3044\u305f\u3044\u4e00\u81f4\u3057\u3066\u307e\u3059\u306d\uff08\u7279\u306b\u30b3\u30e1\u30f3\u30c8\u304c\u306a\u3044\uff09\u3002\n\nL\u306e\u6570\u3092\u5909\u3048\u3066\u8a66\u3057\u305f\u3082\u306e\u30922\u3064\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n1. sinc(x)\\mathrm{sinc}(x)\n2. sin(0.5x+cos(sin(x))\\sin(0.5x + \\cos(\\sin(x))\n\n\n\u8ad6\u6587\u3092\u8aad\u3093\u3067\u3044\u305f\u3089ELM\uff01ELM\uff01\u3068\u4f55\u56de\u3082\u898b\u305f\u306e\u3067Google\u691c\u7d22\u3059\u308b\u3068\u30c7\u30f3\u30bd\u30fcIT\u30e9\u30dc\u30e9\u30c8\u30ea\u306e\u6280\u8853\u30d6\u30ed\u30b0\u304c\u30d2\u30c3\u30c8\u3057\u307e\u3057\u305f\u3002\n\n- [Denso IT Laboratory \u6280\u8853\u30d6\u30ed\u30b0 Extreme Learning Machine](https://tech.d-itlab.co.jp/ml/229/)\n\n\u5b9f\u88c5\u304c\u7c21\u5358\u3068\u66f8\u3044\u3066\u3042\u3063\u305f\u306e\u3067\u3001\u66f8\u3044\u3066\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002Julia\u306f0.4.6\u3001\u30b0\u30e9\u30d5\u306fPyPlot\u3001\u4ed6\u306b\u306f\u4f55\u3082\u4f7f\u3063\u3066\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n```julia\nusing PyPlot\n\n# \u8a13\u7df4\u30c7\u30fc\u30bf\nx = -10:0.1:10\nN = length(x)\ny = sinc(x)\nX = [ones(N) x]\nM = 2\n\n# \u6d3b\u6027\u5316\u95a2\u6570\nsigmoid(x) = 1 ./ (1 .+ exp(-x))\n\n# \u96a0\u308c\u30ce\u30fc\u30c9\u6570\nL = 64\n\n# \u30b0\u30e9\u30d5\u3092\u63cf\u304f (\u8a13\u7df4\u30c7\u30fc\u30bf)\nplot(x, y, \"r--\")\nsavefig(\"correct.png\")\n\n# ELM STEP1: \u30e9\u30f3\u30c0\u30e0\u306b\u4f5c\u6210\na = rand(L, M)\nb = rand(L)\n\n# ELM STEP2: \u96a0\u308c\u5c64\u306e\u51fa\u529b\u884c\u5217H\u3092\u751f\u6210\nH = zeros(N, L)\nfor i=1:N, l=1:L\n    H[i, l] = sigmoid( a[l, :]'*x[i,:] + b[l] )[1]\nend\n\n# ELM STEP3: T=H\u03b2\u306e\u89e3\u3092\u6c42\u3081\u308b\n\u03b2 = pinv(H) * y\n\n# \u4e88\u6e2c\u3059\u308b\ny_pred = zeros(N)\nfor i=1:N\n    for l=1:L\n        y_pred[i] += \u03b2[l] * sigmoid( a[l, :]' * x[i, :] + b[l] )[1]\n    end\nend\n\n# \u4e88\u6e2c\u3068\u6b63\u89e3\u3092\u91cd\u306d\u3066\u63cf\u304f\nplot(x, y, \"r--\")\nplot(x, y_pred, \"b--\")\nsavefig(\"compare_L=$L.png\")\n\n```\n\n\u96a0\u308c\u5c64\u306e\u30ce\u30fc\u30c9\u6570L\u309264\u3067\u8a66\u3059\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3060\u3044\u305f\u3044\u4e00\u81f4\u3057\u3066\u307e\u3059\u306d\uff08\u7279\u306b\u30b3\u30e1\u30f3\u30c8\u304c\u306a\u3044\uff09\u3002\n\n![compare_L=64.png](https://qiita-image-store.s3.amazonaws.com/0/7181/d208bf0f-b95e-683f-6b0a-90c5cc985e76.png)\n\nL\u306e\u6570\u3092\u5909\u3048\u3066\u8a66\u3057\u305f\u3082\u306e\u30922\u3064\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n1. $\\mathrm{sinc}(x)$\n2. $\\sin(0.5x + \\cos(\\sin(x))$\n\n![compare_sinc.png](https://qiita-image-store.s3.amazonaws.com/0/7181/2e380cf0-2fc0-8e77-2a0c-e7f484f0e8ed.png)\n\n![compare_cos_sin.png](https://qiita-image-store.s3.amazonaws.com/0/7181/0876df20-66fd-a17f-44dc-eb9ad79ba527.png)\n\n\n\n\n\n", "tags": ["Julia", "MachineLearning"]}