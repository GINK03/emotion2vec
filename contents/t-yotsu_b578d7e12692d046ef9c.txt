{"context": "GCP\u306eCloud Pub/Sub\u3092\u4f7f\u3063\u3066Message\u306ePulish\u3068Subscribe\u3092\u3057\u3066\u307f\u308b\u3002\nCloud PubSub\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u516c\u5f0f\u30da\u30fc\u30b8\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u3002\nhttps://cloud.google.com/pubsub/overview\n\u610f\u8a33\u3057\u305f\u3082\u306e\u3092\u4ee5\u4e0b\u306b\u307e\u3068\u3081\u308b\u3002\u56f3\u306a\u3069\u306f\u516c\u5f0f\u30da\u30fc\u30b8\u304b\u3089\u5f15\u7528\u3002\nCloud Pub/Sub\u306f\u30b9\u30b1\u30fc\u30e9\u30d6\u30eb\u3067\u30d5\u30ec\u30ad\u30b7\u30d6\u30eb\u3001\u305d\u3057\u3066\u4fe1\u983c\u6027\u306e\u3042\u308b\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3002\u591a\u5bfe\u591a\u306e\u975e\u540c\u671f\u30e1\u30c3\u30bb\u30fc\u30b8\u30b0\u30f3\u30b0\u306b\u3088\u3063\u3066\u30bb\u30ad\u30e5\u30a2\u3067\u9ad8\u53ef\u7528\u6027\u306e\u3042\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u958b\u767a\u3067\u304d\u308b\u3002\n\u30d1\u30d6\u30ea\u30c3\u30b7\u30e3\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4f5c\u6210\u3057Topic\u3078\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u3002\n\u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fTopic\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3002\n1\u5bfe\u591a\u3084\u591a\u5bfe1\u3001\u591a\u5bfe\u591a\u306e\u30b3\u30df\u30e5\u30cb\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u53ef\u80fd\u3067\u3042\u308b\u3002\n\nPub/Sub\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u6d41\u308c\u306f\u4e0b\u56f3\u306e\u3068\u304a\u308a\u3067\u3042\u308b\u3002\n\n\n\u30d1\u30d6\u30ea\u30c3\u30b7\u30e3\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u30c8\u30d4\u30c3\u30af\u3092\u751f\u6210\u3057\u3001\u30c8\u30d4\u30c3\u30af\u3078\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u3002\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u30da\u30a4\u30ed\u30fc\u30c9\u3068\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5c5e\u6027\u3092\u542b\u3080\u3002\n\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u304b\u3089ack\u304c\u8fd4\u3055\u308c\u308b\u307e\u3067message store\u306b\u4fdd\u7ba1\u3055\u308c\u308b\u3002\nPub/Sub\u30b5\u30fc\u30d3\u30b9\u306f\u30c8\u30d4\u30c3\u30af\u304b\u3089\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u5404\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\u3002\u5404\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092Pub/Sub\u304b\u3089\u306ePush\u3082\u3057\u304f\u306f\u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u304b\u3089\u306ePull\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u53d6\u308b\u3002\n\u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u53d6\u308a\u3001ack\u3092Pub/Sub\u30b5\u30fc\u30d3\u30b9\u3078\u8fd4\u3059\n\u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u304b\u3089ack\u304c\u8fd4\u3055\u308c\u308b\u3068\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30ad\u30e5\u30fc\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u524a\u9664\u3055\u308c\u308b\u3002\n\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u767b\u9332\u3001\u53d6\u5f97\u3001\u524a\u9664\nPub/Sub\u306eAPI\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\nhttps://cloud.google.com/sdk/gcloud/reference/alpha/pubsub/\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u767b\u9332\n$ sudo gcloud components install alpha\n$ sudo gcloud components install pubsub-emulator\n\nGCP\u30b3\u30f3\u30bd\u30fc\u30eb\u7d4c\u7531\u3067Cloud Pub/Sub\u306e\u30c8\u30d4\u30c3\u30af\u30da\u30fc\u30b8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001 \u30c8\u30d4\u30c3\u30af\u3092\u4f5c\u6210\u3059\u308b\u3002\n$ gcloud alpha pubsub topics create projects/{\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d}/topics/XXXX\n\n\n\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306e\u767b\u9332\n$ gcloud alpha pubsub subscriptions create projects/{\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d}/subscriptions/YYYY --topic projects/{\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d}/topics/XXXX --topic-project \uff5b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff5d\n\n\n\u30c8\u30d4\u30c3\u30af\u3078\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u767b\u9332\n$ gcloud alpha pubsub topics publish {\u30c8\u30d4\u30c3\u30af\u540d} '{\"message\":\"Hello World!\"}'\n1 message(s) published.\n - messageId: \u30e1\u30c3\u30bb\u30fc\u30b8ID\n\n\n\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092pull\n$ gcloud alpha pubsub subscriptions pull \uff5b\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d\uff5d \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            DATA            \u2502   MESSAGE_ID   \u2502 ATTRIBUTES \u2502                                                       \n                      ACK_ID                                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 {\"message\":\"Hello World!\"} \u2502 35010637313331 \u2502            \u2502 M0VBXkASTDoGRElTK0MLKlgRTgQhIT4wPkVTRFAGFixdRkhRNxkIaF\nEOT14jPzUgKEUSAAgUBXx9cV9UdV1YGgdRDRlyfGRwawxCUwVMBypVWxENQGx-SwRUDRhye2JyaVsQAgFEe7DsyqM8Zhs9XxJLLD5-MQ \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\nACK ID\u3092\u6307\u5b9a\u3057\u3066\u30c8\u30d4\u30c3\u30af\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u524a\u9664\u3059\u308b\u3002\n$ gcloud alpha pubsub subscriptions ack {\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d}\u3000\uff5bACK ID\uff5d\n1 message(s) acknowledged for subscription xxx\n\n$ gcloud alpha pubsub subscriptions pull {\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d}\nListed 0 items.\n\n\n\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u304b\u3089PULL\u3059\u308b\u3068\u304d\u306b\u81ea\u52d5\u3067ACK\u3092\u8fd4\u3057\u3066\u524a\u9664\u3059\u308b\u3002\n$ gcloud alpha pubsub subscriptions pull --auto-ack {\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d} \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            DATA            \u2502   MESSAGE_ID   \u2502 ATTRIBUTES \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 {\"message\":\"Hello World!\"} \u2502 35009734804951 \u2502            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n$ gcloud alpha pubsub subscriptions pull --auto-ack \uff5b\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d\uff5d\nListed 0 items.\n\nGCP\u306eCloud Pub/Sub\u3092\u4f7f\u3063\u3066Message\u306ePulish\u3068Subscribe\u3092\u3057\u3066\u307f\u308b\u3002\n\nCloud PubSub\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u516c\u5f0f\u30da\u30fc\u30b8\u306b\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u3002\nhttps://cloud.google.com/pubsub/overview\n\u610f\u8a33\u3057\u305f\u3082\u306e\u3092\u4ee5\u4e0b\u306b\u307e\u3068\u3081\u308b\u3002\u56f3\u306a\u3069\u306f\u516c\u5f0f\u30da\u30fc\u30b8\u304b\u3089\u5f15\u7528\u3002\n\nCloud Pub/Sub\u306f\u30b9\u30b1\u30fc\u30e9\u30d6\u30eb\u3067\u30d5\u30ec\u30ad\u30b7\u30d6\u30eb\u3001\u305d\u3057\u3066\u4fe1\u983c\u6027\u306e\u3042\u308b\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u30f3\u30b0\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3002\u591a\u5bfe\u591a\u306e\u975e\u540c\u671f\u30e1\u30c3\u30bb\u30fc\u30b8\u30b0\u30f3\u30b0\u306b\u3088\u3063\u3066\u30bb\u30ad\u30e5\u30a2\u3067\u9ad8\u53ef\u7528\u6027\u306e\u3042\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u958b\u767a\u3067\u304d\u308b\u3002\n\u30d1\u30d6\u30ea\u30c3\u30b7\u30e3\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u4f5c\u6210\u3057Topic\u3078\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u3002\n\u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306fTopic\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u3002\n1\u5bfe\u591a\u3084\u591a\u5bfe1\u3001\u591a\u5bfe\u591a\u306e\u30b3\u30df\u30e5\u30cb\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u53ef\u80fd\u3067\u3042\u308b\u3002\n\n![many-to-many.png](https://qiita-image-store.s3.amazonaws.com/0/95399/dc876728-2d0d-f760-9392-adb6c8875ca0.png)\n\nPub/Sub\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u6d41\u308c\u306f\u4e0b\u56f3\u306e\u3068\u304a\u308a\u3067\u3042\u308b\u3002\n![pub_sub_flow.png](https://qiita-image-store.s3.amazonaws.com/0/95399/c2671e5d-8250-67cd-2e4b-27f0124fce65.png)\n\n1. \u30d1\u30d6\u30ea\u30c3\u30b7\u30e3\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u30c8\u30d4\u30c3\u30af\u3092\u751f\u6210\u3057\u3001\u30c8\u30d4\u30c3\u30af\u3078\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u3002\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u30da\u30a4\u30ed\u30fc\u30c9\u3068\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5c5e\u6027\u3092\u542b\u3080\u3002\n2. \u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u304b\u3089ack\u304c\u8fd4\u3055\u308c\u308b\u307e\u3067message store\u306b\u4fdd\u7ba1\u3055\u308c\u308b\u3002\n3. Pub/Sub\u30b5\u30fc\u30d3\u30b9\u306f\u30c8\u30d4\u30c3\u30af\u304b\u3089\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u5404\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\u3002\u5404\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092Pub/Sub\u304b\u3089\u306ePush\u3082\u3057\u304f\u306f\u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u304b\u3089\u306ePull\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u53d6\u308b\u3002\n4. \u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u53d6\u308a\u3001ack\u3092Pub/Sub\u30b5\u30fc\u30d3\u30b9\u3078\u8fd4\u3059\n5. \u30b5\u30d6\u30b9\u30af\u30e9\u30a4\u30d0\u30fc\u304b\u3089ack\u304c\u8fd4\u3055\u308c\u308b\u3068\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u30ad\u30e5\u30fc\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u524a\u9664\u3055\u308c\u308b\u3002\n\n# \u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u767b\u9332\u3001\u53d6\u5f97\u3001\u524a\u9664\nPub/Sub\u306eAPI\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\nhttps://cloud.google.com/sdk/gcloud/reference/alpha/pubsub/\n\n### \u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u767b\u9332\n\n```\n$ sudo gcloud components install alpha\n$ sudo gcloud components install pubsub-emulator\n```\nGCP\u30b3\u30f3\u30bd\u30fc\u30eb\u7d4c\u7531\u3067Cloud Pub/Sub\u306e\u30c8\u30d4\u30c3\u30af\u30da\u30fc\u30b8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001 \u30c8\u30d4\u30c3\u30af\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n$ gcloud alpha pubsub topics create projects/{\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d}/topics/XXXX\n```\n\n### \u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u306e\u767b\u9332\n\n```\n$ gcloud alpha pubsub subscriptions create projects/{\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d}/subscriptions/YYYY --topic projects/{\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d}/topics/XXXX --topic-project \uff5b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\uff5d\n```\n\n### \u30c8\u30d4\u30c3\u30af\u3078\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u767b\u9332\n\n```\n$ gcloud alpha pubsub topics publish {\u30c8\u30d4\u30c3\u30af\u540d} '{\"message\":\"Hello World!\"}'\n1 message(s) published.\n - messageId: \u30e1\u30c3\u30bb\u30fc\u30b8ID\n```\n\n### \u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092pull\n\n```\n$ gcloud alpha pubsub subscriptions pull \uff5b\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d\uff5d \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            DATA            \u2502   MESSAGE_ID   \u2502 ATTRIBUTES \u2502                                                       \n                      ACK_ID                                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 {\"message\":\"Hello World!\"} \u2502 35010637313331 \u2502            \u2502 M0VBXkASTDoGRElTK0MLKlgRTgQhIT4wPkVTRFAGFixdRkhRNxkIaF\nEOT14jPzUgKEUSAAgUBXx9cV9UdV1YGgdRDRlyfGRwawxCUwVMBypVWxENQGx-SwRUDRhye2JyaVsQAgFEe7DsyqM8Zhs9XxJLLD5-MQ \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n### ACK ID\u3092\u6307\u5b9a\u3057\u3066\u30c8\u30d4\u30c3\u30af\u304b\u3089\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u524a\u9664\u3059\u308b\u3002\n```\n$ gcloud alpha pubsub subscriptions ack {\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d}\u3000\uff5bACK ID\uff5d\n1 message(s) acknowledged for subscription xxx\n\n$ gcloud alpha pubsub subscriptions pull {\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d}\nListed 0 items.\n```\n\n### \u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u304b\u3089PULL\u3059\u308b\u3068\u304d\u306b\u81ea\u52d5\u3067ACK\u3092\u8fd4\u3057\u3066\u524a\u9664\u3059\u308b\u3002\n\n```\n$ gcloud alpha pubsub subscriptions pull --auto-ack {\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d} \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            DATA            \u2502   MESSAGE_ID   \u2502 ATTRIBUTES \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 {\"message\":\"Hello World!\"} \u2502 35009734804951 \u2502            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n$ gcloud alpha pubsub subscriptions pull --auto-ack \uff5b\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u540d\uff5d\nListed 0 items.\n```\n\n\n\n\n", "tags": ["GoogleCloudPlatform", "PubSub"]}