{"context": " More than 1 year has passed since last update.\n\nOverview\nUbuntu 12.04\u74b0\u5883\u4e0b\u308414.04\u74b0\u5883\u4e0b\u3067\u3001bugspots\u3092\u52d5\u304b\u305d\u3046\u3068\u3057\u305f\u6642\u306b\u30cf\u30de\u3063\u305f\u306e\u3067\u3001\u30e1\u30e2\u3002\n\u4e00\u90e8\u3001patch\u3057\u3066\u52d5\u304b\u3057\u307e\u3057\u305f\u3002\u3002\u3002\u3002\n(\u4e0b\u66f8\u304d\u306b\u3057\u3066\u304a\u3044\u305f\u307e\u307e\u3060\u3063\u305f\u306e\u3067\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067post\u3057\u3066\u304a\u304d\u307e\u3059...)\n\ndepended modules\n$ sudo apt-get install ruby-dev\n$ sudo apt-get install cmake\n\n\nbugspots\n$ sudo gem install bugspots\n\n\npatch for bugspots\n\n/var/lib/gems/1.9.1/gems/bugspots-0.2.1/lib/bugspots/scanner.rb\n  def self.scan(repo, branch = \"master\", depth = 500, regex = nil)\n..snip..\n    repo = Rugged::Repository.new(repo)\n-    unless repo.branches.each_name(:local).sort.find { |b| b == branch }\n-      raise ArgumentError, \"no such branch in the repo: #{branch}\"\n-    end\n+    head = nil\n+    repo.branches.each_name do |a|\n+      if a == branch then\n+        head = repo.branches[a].name\n+      end\n+    end\n+    if head == nil then\n+      puts \"ERROR: no such branch in the repo: #{branch}\"\n+      puts \"\"\n+      puts \"Available branches :\"\n+      repo.branches.each_name do |a|\n+   puts a\n+      end\n+      exit(-1)\n+    end\n\n    walker = Rugged::Walker.new(repo)\n    walker.sorting(Rugged::SORT_TOPO | Rugged::SORT_REVERSE)\n-   walker.push(repo.branches[branch].target)\n+   walker.push(repo.branches[head].target)\n    walker.each do |commit|\n+     row = commit.message.split(\"\\n\")\n-     if commit.message =~ regex\n+     if row[0].strip =~ regex\n\n\n\n\u5b9f\u884c\u7d50\u679c\n~/work/android-6.0.0_r26/system/vold$ bugspots . -r '^(?!am |[Mm]erge ).*[fF]ix' -b aosp/master\nScanning . repo\n    Found 62 bugfix commits, with 32 hotspots:\n\n    Fixes:\n        - vold2: Fix a mb -> sector conversion refactor bug\n        - vold2: Fix issue with destroying / unmounting asec\n        - vold: Fix share status argument off by one\n        - vold: Fix a few bugs\n        - vold: Fix format argument bug\n        - vold: Fix devmapper/ptmx fd leak, and give asec unmount more time\n        - vold: fix infinite loop when failing to unmount a busy container in unmountVolume()\n        - vold: Fix uninitialized mountpoint bug\n        - vold: Bugfixes & cleanups\n        - vold: Fix argument validation for volume commands\n        - Fix loop_info/loop_info64 impedance mismatch\n        - Fixes for devices with internal FAT file system:\n        - More fixes for internal FAT partitions:\n        - vold: fix an offset one bug that makes partition 4 unusable\n        - fix double closing file descriptors\n        - Fix to display the proper percentage complete during encryption.\n        - Fix cryptfs to work with a raw block device for key storage\n        - Fix to not return a bogus decryption error when a device is not encrypted.\n        - Fix vdc to add sequence number for NativeConectorDaemon\n        - Fix truncation of ASEC ids\n        - Fix truncation of ASEC ids\n        - Fix a typo in cryptfs.c\n        - Fix encryption on certain devices\n        - Fix encryption on certain devices\n        - Another fix for encryption\n        - Fix vold's use of readdir_r(3).\n        - Fix issue #7503920: Log spew from vold\n        - Fix calls to logwrap\n        - Fix compiling warnings\n        - Fix a typo in a comment\n        - Fix spelling.\n        - vold: fix potential socket leak\n        - Fix crash in vold\n        - DO NOT MERGE. Fix crash in vold\n        - vold: fix warnings for 64-bit\n        - vold: fix errors inside ALOGV\n        - Fix setfield/getfield\n        - vdc: fix segfault\n        - Fix encryption on Nakasi\n        - Fixed bugs with ASEC filesystem.\n        - Fix encryption on Nakasi\n        - Fix vold %lld to PRId64.\n        - Fix an accidental PRId64 to PRIx64.\n        - Fix failure erasing SD in Factory reset\n        - fstrim: fix typo in log message for FIDTRIM case\n        - Fix Vold to properly handle full-disk file systems\n        - Fix Shamus bricked by encryption upgrade\n        - Fix encrypt-and-wipe\n        - Fix error in clocks leading to devices staying unlocked\n        - Fix alignment of buffer used for dm_ioctl.\n        - Remove unused local variable to fix the build\n        - Fix missing #includes in system/vold.\n        - Fix memory leak in upgrade_crypt_ftr\n        - crytpfs: fix clobbering of crypto info on keymaster failure\n        - Fixed type mismatch for ioctl(BLKGETSIZE)\n        - Fix 64 bit builds.\n        - Fix destroy ordering bug; add debug flag.\n        - Fix signed issue with hex conversion.\n        - Fix problem that reading/writing crypto footers wasn't identity\n        - DO NOT MERGE Fix problem that reading/writing crypto footers wasn't identity\n        - Fix erroneous comment in secdiscard.cpp, plus style fixes.\n        - Fix ioctl parameter\n\n    Hotspots:\n        1.3139 - cryptfs.c\n        0.6781 - Utils.cpp\n        0.4932 - Ext4Crypt.cpp\n        0.4142 - Disk.cpp\n        0.3171 - VolumeManager.cpp\n        0.3099 - secdiscard.cpp\n        0.2164 - fstrim.c\n        0.2139 - main.cpp\n        0.2059 - Fat.cpp\n        0.2026 - VoldUtil.h\n        0.2000 - Loop.cpp\n        0.2000 - Loop.h\n        0.2000 - VoldUtil.c\n        0.1250 - DirectVolume.cpp\n        0.1240 - Android.mk\n        0.0660 - DirectVolume.h\n        0.0495 - Volume.cpp\n        0.0494 - Ext4.cpp\n        0.0435 - Ext4.h\n        0.0383 - vdc.c\n        0.0142 - NetlinkManager.cpp\n        0.0053 - CommandListener.cpp\n        0.0033 - Devmapper.cpp\n        0.0001 - logwrapper.c\n        0.0001 - Volume.h\n        0.0000 - CommandListener.h\n        0.0000 - Devmapper.h\n        0.0000 - VolumeManager.h\n        0.0000 - hash.h\n        0.0000 - md5.c\n        0.0000 - md5.h\n        0.0000 - ProcessKiller.c\n\n# Overview\n\nUbuntu 12.04\u74b0\u5883\u4e0b\u308414.04\u74b0\u5883\u4e0b\u3067\u3001bugspots\u3092\u52d5\u304b\u305d\u3046\u3068\u3057\u305f\u6642\u306b\u30cf\u30de\u3063\u305f\u306e\u3067\u3001\u30e1\u30e2\u3002\n\u4e00\u90e8\u3001patch\u3057\u3066\u52d5\u304b\u3057\u307e\u3057\u305f\u3002\u3002\u3002\u3002\n(\u4e0b\u66f8\u304d\u306b\u3057\u3066\u304a\u3044\u305f\u307e\u307e\u3060\u3063\u305f\u306e\u3067\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067post\u3057\u3066\u304a\u304d\u307e\u3059...)\n\n# depended modules\n\n```\n$ sudo apt-get install ruby-dev\n$ sudo apt-get install cmake\n```\n\n# bugspots\n\n```\n$ sudo gem install bugspots\n```\n\n# patch for bugspots\n\n```/var/lib/gems/1.9.1/gems/bugspots-0.2.1/lib/bugspots/scanner.rb\n  def self.scan(repo, branch = \"master\", depth = 500, regex = nil)\n..snip..\n    repo = Rugged::Repository.new(repo)\n-    unless repo.branches.each_name(:local).sort.find { |b| b == branch }\n-      raise ArgumentError, \"no such branch in the repo: #{branch}\"\n-    end\n+    head = nil\n+    repo.branches.each_name do |a|\n+      if a == branch then\n+        head = repo.branches[a].name\n+      end\n+    end\n+    if head == nil then\n+      puts \"ERROR: no such branch in the repo: #{branch}\"\n+      puts \"\"\n+      puts \"Available branches :\"\n+      repo.branches.each_name do |a|\n+\tputs a\n+      end\n+      exit(-1)\n+    end\n\n    walker = Rugged::Walker.new(repo)\n    walker.sorting(Rugged::SORT_TOPO | Rugged::SORT_REVERSE)\n-   walker.push(repo.branches[branch].target)\n+   walker.push(repo.branches[head].target)\n    walker.each do |commit|\n+     row = commit.message.split(\"\\n\")\n-     if commit.message =~ regex\n+     if row[0].strip =~ regex\n```\n\n# \u5b9f\u884c\u7d50\u679c\n\n```\n~/work/android-6.0.0_r26/system/vold$ bugspots . -r '^(?!am |[Mm]erge ).*[fF]ix' -b aosp/master\nScanning . repo\n\tFound 62 bugfix commits, with 32 hotspots:\n\n\tFixes:\n\t\t- vold2: Fix a mb -> sector conversion refactor bug\n\t\t- vold2: Fix issue with destroying / unmounting asec\n\t\t- vold: Fix share status argument off by one\n\t\t- vold: Fix a few bugs\n\t\t- vold: Fix format argument bug\n\t\t- vold: Fix devmapper/ptmx fd leak, and give asec unmount more time\n\t\t- vold: fix infinite loop when failing to unmount a busy container in unmountVolume()\n\t\t- vold: Fix uninitialized mountpoint bug\n\t\t- vold: Bugfixes & cleanups\n\t\t- vold: Fix argument validation for volume commands\n\t\t- Fix loop_info/loop_info64 impedance mismatch\n\t\t- Fixes for devices with internal FAT file system:\n\t\t- More fixes for internal FAT partitions:\n\t\t- vold: fix an offset one bug that makes partition 4 unusable\n\t\t- fix double closing file descriptors\n\t\t- Fix to display the proper percentage complete during encryption.\n\t\t- Fix cryptfs to work with a raw block device for key storage\n\t\t- Fix to not return a bogus decryption error when a device is not encrypted.\n\t\t- Fix vdc to add sequence number for NativeConectorDaemon\n\t\t- Fix truncation of ASEC ids\n\t\t- Fix truncation of ASEC ids\n\t\t- Fix a typo in cryptfs.c\n\t\t- Fix encryption on certain devices\n\t\t- Fix encryption on certain devices\n\t\t- Another fix for encryption\n\t\t- Fix vold's use of readdir_r(3).\n\t\t- Fix issue #7503920: Log spew from vold\n\t\t- Fix calls to logwrap\n\t\t- Fix compiling warnings\n\t\t- Fix a typo in a comment\n\t\t- Fix spelling.\n\t\t- vold: fix potential socket leak\n\t\t- Fix crash in vold\n\t\t- DO NOT MERGE. Fix crash in vold\n\t\t- vold: fix warnings for 64-bit\n\t\t- vold: fix errors inside ALOGV\n\t\t- Fix setfield/getfield\n\t\t- vdc: fix segfault\n\t\t- Fix encryption on Nakasi\n\t\t- Fixed bugs with ASEC filesystem.\n\t\t- Fix encryption on Nakasi\n\t\t- Fix vold %lld to PRId64.\n\t\t- Fix an accidental PRId64 to PRIx64.\n\t\t- Fix failure erasing SD in Factory reset\n\t\t- fstrim: fix typo in log message for FIDTRIM case\n\t\t- Fix Vold to properly handle full-disk file systems\n\t\t- Fix Shamus bricked by encryption upgrade\n\t\t- Fix encrypt-and-wipe\n\t\t- Fix error in clocks leading to devices staying unlocked\n\t\t- Fix alignment of buffer used for dm_ioctl.\n\t\t- Remove unused local variable to fix the build\n\t\t- Fix missing #includes in system/vold.\n\t\t- Fix memory leak in upgrade_crypt_ftr\n\t\t- crytpfs: fix clobbering of crypto info on keymaster failure\n\t\t- Fixed type mismatch for ioctl(BLKGETSIZE)\n\t\t- Fix 64 bit builds.\n\t\t- Fix destroy ordering bug; add debug flag.\n\t\t- Fix signed issue with hex conversion.\n\t\t- Fix problem that reading/writing crypto footers wasn't identity\n\t\t- DO NOT MERGE Fix problem that reading/writing crypto footers wasn't identity\n\t\t- Fix erroneous comment in secdiscard.cpp, plus style fixes.\n\t\t- Fix ioctl parameter\n\n\tHotspots:\n\t\t1.3139 - cryptfs.c\n\t\t0.6781 - Utils.cpp\n\t\t0.4932 - Ext4Crypt.cpp\n\t\t0.4142 - Disk.cpp\n\t\t0.3171 - VolumeManager.cpp\n\t\t0.3099 - secdiscard.cpp\n\t\t0.2164 - fstrim.c\n\t\t0.2139 - main.cpp\n\t\t0.2059 - Fat.cpp\n\t\t0.2026 - VoldUtil.h\n\t\t0.2000 - Loop.cpp\n\t\t0.2000 - Loop.h\n\t\t0.2000 - VoldUtil.c\n\t\t0.1250 - DirectVolume.cpp\n\t\t0.1240 - Android.mk\n\t\t0.0660 - DirectVolume.h\n\t\t0.0495 - Volume.cpp\n\t\t0.0494 - Ext4.cpp\n\t\t0.0435 - Ext4.h\n\t\t0.0383 - vdc.c\n\t\t0.0142 - NetlinkManager.cpp\n\t\t0.0053 - CommandListener.cpp\n\t\t0.0033 - Devmapper.cpp\n\t\t0.0001 - logwrapper.c\n\t\t0.0001 - Volume.h\n\t\t0.0000 - CommandListener.h\n\t\t0.0000 - Devmapper.h\n\t\t0.0000 - VolumeManager.h\n\t\t0.0000 - hash.h\n\t\t0.0000 - md5.c\n\t\t0.0000 - md5.h\n\t\t0.0000 - ProcessKiller.c\n```\n", "tags": ["bugspot", "bug", "prediction", "Git", "aosp"]}