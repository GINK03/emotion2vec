{"context": "\n\n\u52d5\u4f5c\u74b0\u5883\n\nWindows 7/10\nExcel(Office) 2010/2016\u3067\u78ba\u8a8d\n\n\uff08\u4e00\u90e8Excel\u7279\u6709\u306e\u5224\u5b9a\u3082\u3042\u308b\u306e\u3067\u3001Access VBA\u7b49\u3067\u78ba\u8a8d\u306e\u969b\u306fIsError\u7b49\u306e\u5224\u5b9a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\n\u4e3b\u306a\u6a5f\u80fd\n\n\u3042\u3089\u3086\u308b\u5024(Variant\u578b)\u306b\u5024\u304c\u7121\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3067\u304d\u308b\n\u5fdc\u7528\u3068\u3057\u3066\u3001InputBox\u306e\u5165\u529b\u5224\u5b9a\uff08\u30ad\u30e3\u30f3\u30bb\u30eb\u3001\u7a7a\u6b04\u306e\u307e\u307eOK\uff09\u306b\u5bfe\u5fdc\n\u5024\u306a\u3057\u6642\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u51fa\u529b\uff08\u6307\u5b9a\u7121\u3057\u306a\u3089MsgBox\u8868\u793a, \u30e1\u30c3\u30bb\u30fc\u30b8\u6307\u5b9a\u53ef\u80fd\uff09\n\u6709\u52b9\u65e5\u4ed8\u306e\u5224\u5b9a\u3082\u884c\u3048\u308b(DateUtil.bas\u306b\u3066)\n\n\n\u88dc\u8db3\n\n\u8fd1\u65e5\u4e2d\u306bGitHub\u306b\u6295\u7a3f\u4e88\u5b9a\n\u30b3\u30e1\u30f3\u30c8\u3067\u306e\u8aac\u660e\u304c\u4e0d\u8db3\u3057\u3066\u3044\u308b\uff08\u7279\u306bDateUtil.bas\uff09\u306e\u3067\u3001GitHub\u306b\u6b63\u5f0f\u7248\u3092\u6295\u7a3f\u3057\u305f\u969b\u306b\u66f4\u65b0\u3057\u307e\u3059\u3002\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n\u4eca\u56de\u306e\u30e1\u30a4\u30f3\uff08\u5171\u901a\u95a2\u6570\uff09\n\nCommon.bas\n' \u5165\u529b\u5024\u306e\u5224\u5b9a(IsNoValue\u3067\u7d50\u679c\u3092\u5224\u5b9a)\nPublic Function GetInputValue(ByRef val As Variant, _\n        ByVal promptStr As String, ByVal errMsgStr As String, _\n        ByVal defaultValue As Variant) As Boolean\n    val = InputBox(promptStr)\n    GetInputValue = Not IsNoValue(val, errMsgStr)\n\n    If GetInputValue = False Then\n        val = defaultValue\n    End If\nEnd Function\n\n' \u4eca\u56de\u306e\u30e1\u30a4\u30f3\u6a5f\u80fd\uff08\u5024\u306a\u3057\u306e\u5224\u5b9a\u3092\u4e26\u3079\u305f\u3082\u306e\uff09\nPublic Function IsNoValue(ByRef val As Variant, _\n        Optional ByVal errMsgStr As String = \"\u7121\u52b9\u306a\u5024\u3067\u3059\", _\n        Optional ByVal viewMsg As Boolean = True) As Boolean\n    On Error GoTo Err\n    Dim dateStr As String\n    Call PrintValueInfo(val)\n\n    IsNoValue = False\n\n    If VarType(val) = vbString Then\n        IsNoValue = False\n\n        'InputBox\u7a7a\u6b04OK\u6642, str = \"\"(NG)\n        '\u5024\u306e\u3042\u308b\u6587\u5b57\u5217\u306a\u3089\n        If val = \"\" Or Len(val) = 0 Then    \n            IsNoValue = True\n        End If\n    '(NG) TypeName=\"Nothing\"\u3067\u5224\u5b9a\uff08\u672c\u5f53\u306bNothing\u3060\u3068Is Nothing\u3067\u306f\u5224\u5b9a\u4e0d\u53ef\uff09\n    ElseIf IsNothing(val) Then  \n        IsNoValue = True\n    ElseIf IsEmpty(val) Then    '\u521d\u671f\u5316\u3055\u308c\u3066\u3044\u306a\u3044\u5024(NG)\n        IsNoValue = True\n    ElseIf IsMissing(val) Then  'Optional\u5909\u6570\u3067\u5024\u304c\u306a\u3044\u3068\u304d\uff08\u7a7a\u6587\u5b57\u3092\u5165\u308c\u308b\uff09(NG)\n        val = \"\"\n        IsNoValue = True\n    ElseIf IsError(val) Then    '\u30a8\u30e9\u30fc\u5024\u306e\u3068\u304d\uff08\u7a7a\u6587\u5b57\u3092\u5165\u308c\u308b\uff09(NG)\n        val = \"\"\n        IsNoValue = True\n    ElseIf IsNumeric(val) Then  '\u6570\u5024(OK)\n        IsNoValue = False\n    ElseIf IsDate(val) Then     '\u65e5\u4ed8\u30c7\u30fc\u30bf\u306e\u3068\u304d(OK)\n        val = CDate(val)\n        IsNoValue = False\n    ElseIf StrPtr(val) = 0 Then 'InputBox\u30ad\u30e3\u30f3\u30bb\u30eb\u6642(NG)\n        IsNoValue = True\n    ElseIf IsNull(val) Then     '\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u7a7a\n        IsNoValue = True\n    ElseIf val = \"\" Then        'InputBox\u7a7a\u6b04OK\u6642, str = \"\"\n        IsNoValue = True\n    ElseIf Len(val) = 0 Then    '\u7a7a\u6587\u5b57\u5217\n        IsNoValue = True\n    End If\n\n    If IsNoValue = False Then\n        '\u6709\u52b9\u306a\u65e5\u4ed8\u304b\u5224\u5b9a\n        If IsDate(val) = False Then\n            dateStr = CStr(val)\n            If IsDateStr(dateStr) = True Then\n                val = CDate(dateStr)\n            End If\n        End If\n    ElseIf IsArray(val) Then\n        Debug.Print \"Array: Len(\" & UBound(val) & \")\"\n    ElseIf viewMsg = True Then\n        MsgBox errMsgStr\n    End If\n    Call PrintValueInfo(val, IsNoValue)\n    Exit Function\nErr:\n    IsNoValue = True\n    Call PrintValueInfo(val, IsNoValue)\n    MsgBox errMsgStr & vbCrLf & Err.Number & \": \" & Err.Description\nEnd Function\n\n' TypeName\u3067Is Nothing\u5224\u5b9a\nPublic Function IsNothing(ByVal objvar As Variant) As Boolean\n    IsNothing = (TypeName(objvar) = \"Nothing\")\nEnd Function\n\n' \u30c7\u30d0\u30c3\u30b0\u7528\nPrivate Sub PrintValueInfo(ByVal val As Variant, Optional ByVal result As String = \"\")\n    Dim valStr As String\n    If IsNothing(val) Then\n        valStr = \"\"\n    Else\n        valStr = CStr(val)\n    End If\n\n    If Len(valStr) > 29 Then\n        valStr = Left(valStr, 29) & \"...\"\n    End If\n\n    Debug.Print \"TypeName(val): \" & TypeName(val) & \" = \" & _\n                    IIf(TypeName(val) = \"Nothing\", \"Nothing\", valStr) & _\n                    IIf(result = \"\", \"\", \"(\" & result & \")\")\nEnd Sub\n\n\n\n\u88dc\u52a9\u95a2\u6570\u3068\u3057\u3066\u3001\u65e5\u4ed8\u306e\u6c4e\u7528\u95a2\u6570\n\u203b\u4e00\u90e8\u629c\u7c8b\u3057\u305f\u3082\u306e\u3067\u3059\uff08\u4eca\u5f8c\u6539\u826f\u4e88\u5b9a\uff09\n\nDateUtil.bas\nPublic Function IsDateStr(ByRef dateStr As String, Optional askConv As Boolean = True) As Boolean\n    On Error GoTo Err\n    Dim formatStr As String\n    Dim HasColon As Boolean, HasSlash As Boolean\n    IsDateStr = False\n    formatStr = \"\"\n\n    HasColon = InStr(1, dateStr, DATE_COLON) > 0\n    HasSlash = InStr(1, dateStr, DATE_SLASH) > 0\n\n    dateStr = Replace(dateStr, DATE_SLASH, \"\")\n    dateStr = Replace(dateStr, DATE_COLON, \"\")\n    dateStr = Replace(dateStr, \" \", \"\")\n\n    If IsNumeric(dateStr) Then\n        Select Case Len(dateStr)\n            Case 8\n                formatStr = \"@@@@/@@/@@\"\n            Case 13\n                formatStr = \"@@@@/@@/@@ @:@@:@@\"\n            Case 14\n                formatStr = \"@@@@/@@/@@ @@:@@:@@\"\n            Case 5\n                If HasColon Then\n                    formatStr = \"@:@@:@@\"\n                Else\n                    GoTo Err\n                End If\n            Case 6\n                If HasSlash Then\n                    formatStr = \"@@@@/@@\"\n                ElseIf HasColon Then\n                    formatStr = \"@@:@@:@@\"\n                Else\n                    formatStr = \"@@@@/@@\"\n                End If\n            Case Else\n                GoTo Err\n        End Select\n\n        Debug.Print \"formatStr: \" & formatStr\n        If askConv = False Then\n            dateStr = format(dateStr, formatStr)\n            Debug.Print \"dateStr: \" & dateStr\n            IsDateStr = True\n\n            Exit Function\n        ElseIf MsgBox(\"\u65e5\u4ed8\u578b\u306b\u5909\u63db\u3057\u307e\u3059\u304b\uff1f\", vbYesNo) = vbYes Then\n            dateStr = format(dateStr, formatStr)\n            Debug.Print \"dateStr: \" & dateStr\n            IsDateStr = True\n\n            Exit Function\n        End If\n    End If\n    Exit Function\nErr:\n\nEnd Function\n\n\n#\u52d5\u4f5c\u74b0\u5883\n\n- Windows 7/10\n- Excel(Office) 2010/2016\u3067\u78ba\u8a8d\n\n\uff08\u4e00\u90e8Excel\u7279\u6709\u306e\u5224\u5b9a\u3082\u3042\u308b\u306e\u3067\u3001Access VBA\u7b49\u3067\u78ba\u8a8d\u306e\u969b\u306fIsError\u7b49\u306e\u5224\u5b9a\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066\u304f\u3060\u3055\u3044\uff09\n\n#\u4e3b\u306a\u6a5f\u80fd\n\n- \u3042\u3089\u3086\u308b\u5024(Variant\u578b)\u306b\u5024\u304c\u7121\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3067\u304d\u308b\n- \u5fdc\u7528\u3068\u3057\u3066\u3001InputBox\u306e\u5165\u529b\u5224\u5b9a\uff08\u30ad\u30e3\u30f3\u30bb\u30eb\u3001\u7a7a\u6b04\u306e\u307e\u307eOK\uff09\u306b\u5bfe\u5fdc\n- \u5024\u306a\u3057\u6642\u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u51fa\u529b\uff08\u6307\u5b9a\u7121\u3057\u306a\u3089MsgBox\u8868\u793a, \u30e1\u30c3\u30bb\u30fc\u30b8\u6307\u5b9a\u53ef\u80fd\uff09\n- \u6709\u52b9\u65e5\u4ed8\u306e\u5224\u5b9a\u3082\u884c\u3048\u308b(DateUtil.bas\u306b\u3066)\n\n##\u88dc\u8db3\n\n- \u8fd1\u65e5\u4e2d\u306bGitHub\u306b\u6295\u7a3f\u4e88\u5b9a\n- \u30b3\u30e1\u30f3\u30c8\u3067\u306e\u8aac\u660e\u304c\u4e0d\u8db3\u3057\u3066\u3044\u308b\uff08\u7279\u306bDateUtil.bas\uff09\u306e\u3067\u3001GitHub\u306b\u6b63\u5f0f\u7248\u3092\u6295\u7a3f\u3057\u305f\u969b\u306b\u66f4\u65b0\u3057\u307e\u3059\u3002\n\n#\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n##\u4eca\u56de\u306e\u30e1\u30a4\u30f3\uff08\u5171\u901a\u95a2\u6570\uff09\n\n```VB.Net:Common.bas\n' \u5165\u529b\u5024\u306e\u5224\u5b9a(IsNoValue\u3067\u7d50\u679c\u3092\u5224\u5b9a)\nPublic Function GetInputValue(ByRef val As Variant, _\n        ByVal promptStr As String, ByVal errMsgStr As String, _\n        ByVal defaultValue As Variant) As Boolean\n    val = InputBox(promptStr)\n    GetInputValue = Not IsNoValue(val, errMsgStr)\n    \n    If GetInputValue = False Then\n        val = defaultValue\n    End If\nEnd Function\n\n' \u4eca\u56de\u306e\u30e1\u30a4\u30f3\u6a5f\u80fd\uff08\u5024\u306a\u3057\u306e\u5224\u5b9a\u3092\u4e26\u3079\u305f\u3082\u306e\uff09\nPublic Function IsNoValue(ByRef val As Variant, _\n        Optional ByVal errMsgStr As String = \"\u7121\u52b9\u306a\u5024\u3067\u3059\", _\n        Optional ByVal viewMsg As Boolean = True) As Boolean\n    On Error GoTo Err\n    Dim dateStr As String\n    Call PrintValueInfo(val)\n    \n    IsNoValue = False\n    \n    If VarType(val) = vbString Then\n        IsNoValue = False\n        \n        'InputBox\u7a7a\u6b04OK\u6642, str = \"\"(NG)\n        '\u5024\u306e\u3042\u308b\u6587\u5b57\u5217\u306a\u3089\n        If val = \"\" Or Len(val) = 0 Then    \n            IsNoValue = True\n        End If\n    '(NG) TypeName=\"Nothing\"\u3067\u5224\u5b9a\uff08\u672c\u5f53\u306bNothing\u3060\u3068Is Nothing\u3067\u306f\u5224\u5b9a\u4e0d\u53ef\uff09\n    ElseIf IsNothing(val) Then  \n        IsNoValue = True\n    ElseIf IsEmpty(val) Then    '\u521d\u671f\u5316\u3055\u308c\u3066\u3044\u306a\u3044\u5024(NG)\n        IsNoValue = True\n    ElseIf IsMissing(val) Then  'Optional\u5909\u6570\u3067\u5024\u304c\u306a\u3044\u3068\u304d\uff08\u7a7a\u6587\u5b57\u3092\u5165\u308c\u308b\uff09(NG)\n        val = \"\"\n        IsNoValue = True\n    ElseIf IsError(val) Then    '\u30a8\u30e9\u30fc\u5024\u306e\u3068\u304d\uff08\u7a7a\u6587\u5b57\u3092\u5165\u308c\u308b\uff09(NG)\n        val = \"\"\n        IsNoValue = True\n    ElseIf IsNumeric(val) Then  '\u6570\u5024(OK)\n        IsNoValue = False\n    ElseIf IsDate(val) Then     '\u65e5\u4ed8\u30c7\u30fc\u30bf\u306e\u3068\u304d(OK)\n        val = CDate(val)\n        IsNoValue = False\n    ElseIf StrPtr(val) = 0 Then 'InputBox\u30ad\u30e3\u30f3\u30bb\u30eb\u6642(NG)\n        IsNoValue = True\n    ElseIf IsNull(val) Then     '\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u7a7a\n        IsNoValue = True\n    ElseIf val = \"\" Then        'InputBox\u7a7a\u6b04OK\u6642, str = \"\"\n        IsNoValue = True\n    ElseIf Len(val) = 0 Then    '\u7a7a\u6587\u5b57\u5217\n        IsNoValue = True\n    End If\n    \n    If IsNoValue = False Then\n        '\u6709\u52b9\u306a\u65e5\u4ed8\u304b\u5224\u5b9a\n        If IsDate(val) = False Then\n            dateStr = CStr(val)\n            If IsDateStr(dateStr) = True Then\n                val = CDate(dateStr)\n            End If\n        End If\n    ElseIf IsArray(val) Then\n        Debug.Print \"Array: Len(\" & UBound(val) & \")\"\n    ElseIf viewMsg = True Then\n        MsgBox errMsgStr\n    End If\n    Call PrintValueInfo(val, IsNoValue)\n    Exit Function\nErr:\n    IsNoValue = True\n    Call PrintValueInfo(val, IsNoValue)\n    MsgBox errMsgStr & vbCrLf & Err.Number & \": \" & Err.Description\nEnd Function\n\n' TypeName\u3067Is Nothing\u5224\u5b9a\nPublic Function IsNothing(ByVal objvar As Variant) As Boolean\n    IsNothing = (TypeName(objvar) = \"Nothing\")\nEnd Function\n\n' \u30c7\u30d0\u30c3\u30b0\u7528\nPrivate Sub PrintValueInfo(ByVal val As Variant, Optional ByVal result As String = \"\")\n    Dim valStr As String\n    If IsNothing(val) Then\n        valStr = \"\"\n    Else\n        valStr = CStr(val)\n    End If\n    \n    If Len(valStr) > 29 Then\n        valStr = Left(valStr, 29) & \"...\"\n    End If\n        \n    Debug.Print \"TypeName(val): \" & TypeName(val) & \" = \" & _\n                    IIf(TypeName(val) = \"Nothing\", \"Nothing\", valStr) & _\n                    IIf(result = \"\", \"\", \"(\" & result & \")\")\nEnd Sub\n```\n\n##\u88dc\u52a9\u95a2\u6570\u3068\u3057\u3066\u3001\u65e5\u4ed8\u306e\u6c4e\u7528\u95a2\u6570\n**\u203b\u4e00\u90e8\u629c\u7c8b\u3057\u305f\u3082\u306e\u3067\u3059**\uff08\u4eca\u5f8c\u6539\u826f\u4e88\u5b9a\uff09\n\n```VB.net:DateUtil.bas\nPublic Function IsDateStr(ByRef dateStr As String, Optional askConv As Boolean = True) As Boolean\n    On Error GoTo Err\n    Dim formatStr As String\n    Dim HasColon As Boolean, HasSlash As Boolean\n    IsDateStr = False\n    formatStr = \"\"\n    \n    HasColon = InStr(1, dateStr, DATE_COLON) > 0\n    HasSlash = InStr(1, dateStr, DATE_SLASH) > 0\n    \n    dateStr = Replace(dateStr, DATE_SLASH, \"\")\n    dateStr = Replace(dateStr, DATE_COLON, \"\")\n    dateStr = Replace(dateStr, \" \", \"\")\n    \n    If IsNumeric(dateStr) Then\n        Select Case Len(dateStr)\n            Case 8\n                formatStr = \"@@@@/@@/@@\"\n            Case 13\n                formatStr = \"@@@@/@@/@@ @:@@:@@\"\n            Case 14\n                formatStr = \"@@@@/@@/@@ @@:@@:@@\"\n            Case 5\n                If HasColon Then\n                    formatStr = \"@:@@:@@\"\n                Else\n                    GoTo Err\n                End If\n            Case 6\n                If HasSlash Then\n                    formatStr = \"@@@@/@@\"\n                ElseIf HasColon Then\n                    formatStr = \"@@:@@:@@\"\n                Else\n                    formatStr = \"@@@@/@@\"\n                End If\n            Case Else\n                GoTo Err\n        End Select\n        \n        Debug.Print \"formatStr: \" & formatStr\n        If askConv = False Then\n            dateStr = format(dateStr, formatStr)\n            Debug.Print \"dateStr: \" & dateStr\n            IsDateStr = True\n            \n            Exit Function\n        ElseIf MsgBox(\"\u65e5\u4ed8\u578b\u306b\u5909\u63db\u3057\u307e\u3059\u304b\uff1f\", vbYesNo) = vbYes Then\n            dateStr = format(dateStr, formatStr)\n            Debug.Print \"dateStr: \" & dateStr\n            IsDateStr = True\n            \n            Exit Function\n        End If\n    End If\n    Exit Function\nErr:\n\nEnd Function\n```\n", "tags": ["ExcelVBA", "VBA"]}