{"context": " More than 1 year has passed since last update.PRML 3.1.1\u306b\u8a18\u8f09\u306e\u6b63\u898f\u65b9\u7a0b\u5f0f\u3092\u4f7f\u3063\u3066\u3001\u30ac\u30a6\u30b9\u57fa\u5e95\u3092\u7528\u3044\u305f\u7dda\u5f62\u57fa\u5e95\u95a2\u6570\u30e2\u30c7\u30eb\u306e\u4fc2\u6570w\u3092\u63a8\u5b9a\u3057\u3001\u30e2\u30c7\u30eb\u306e\u56f3\u3092\u66f8\u304d\u307e\u3059\u3002\n\nset.seed(0)\nx<-seq(0.05,1,0.1)\nt<-sin(2*pi*x)+rnorm(10,0,0.5)\nt<-matrix(t,nrow=length(t))\nM=4\nbase<-function(m,x) {\n#       r<-x^m                          #\u591a\u9805\u5f0f\u57fa\u5e95\u306e\u5834\u5408\n        r<-exp(-(x-(m-1)/(M-2))^2/(2*0.2^2))    #\u30ac\u30a6\u30b9\u57fa\u5e95\u306e\u5834\u5408\n        r[m == 0]<-1                    # w0\u3092\u30d0\u30a4\u30a2\u30b9\u9805\u3068\u3059\u308b\u305f\u3081\u03c60=1\n        r\n}\nmakePhi<-function(M) {\n        A <- matrix(nrow=length(x),ncol=M)\n        for (i in 1:length(x)) {\n                for (j in 0:(M-1)) {\n                        A[i,1+j] <- base(j,x[i])\n                }\n        }\n        A\n}\nxrange=c(-0.5,1.5)\nyrange=c(-2,2)\nphi<-makePhi(M)\nw<-solve(t(phi) %*% phi) %*% t(phi) %*% t\nw\nestimate<-function(x){\n        i <- 0:(M-1)\n        (sapply(x,function(xn){ (sum(w * base(i, xn))) } )) # (w[1]+w[2]*base(1,x)+w[3]*base(2,x)...)\n}\nplot(x,t,xlim=xrange,ylim=yrange)\npar(new=T)\ncurve(estimate,type=\"l\",xlim=xrange,ylim=yrange)\n\nPRML 3.1.1\u306b\u8a18\u8f09\u306e\u6b63\u898f\u65b9\u7a0b\u5f0f\u3092\u4f7f\u3063\u3066\u3001\u30ac\u30a6\u30b9\u57fa\u5e95\u3092\u7528\u3044\u305f\u7dda\u5f62\u57fa\u5e95\u95a2\u6570\u30e2\u30c7\u30eb\u306e\u4fc2\u6570w\u3092\u63a8\u5b9a\u3057\u3001\u30e2\u30c7\u30eb\u306e\u56f3\u3092\u66f8\u304d\u307e\u3059\u3002\n\n![](https://dl.dropbox.com/sh/cwfemibvr7gk4cy/yNaYbqZdmx/2.NormalEquation.png)\n\n```r\n\u0001\u0001set.seed(0)\nx<-seq(0.05,1,0.1)\nt<-sin(2*pi*x)+rnorm(10,0,0.5)\nt<-matrix(t,nrow=length(t))\nM=4\nbase<-function(m,x) {\n#       r<-x^m                          #\u591a\u9805\u5f0f\u57fa\u5e95\u306e\u5834\u5408\n        r<-exp(-(x-(m-1)/(M-2))^2/(2*0.2^2))    #\u30ac\u30a6\u30b9\u57fa\u5e95\u306e\u5834\u5408\n        r[m == 0]<-1                    # w0\u3092\u30d0\u30a4\u30a2\u30b9\u9805\u3068\u3059\u308b\u305f\u3081\u03c60=1\n        r\n}\nmakePhi<-function(M) {\n        A <- matrix(nrow=length(x),ncol=M)\n        for (i in 1:length(x)) {\n                for (j in 0:(M-1)) {\n                        A[i,1+j] <- base(j,x[i])\n                }\n        }\n        A\n}\nxrange=c(-0.5,1.5)\nyrange=c(-2,2)\nphi<-makePhi(M)\nw<-solve(t(phi) %*% phi) %*% t(phi) %*% t\nw\nestimate<-function(x){\n        i <- 0:(M-1)\n        (sapply(x,function(xn){ (sum(w * base(i, xn))) } )) # (w[1]+w[2]*base(1,x)+w[3]*base(2,x)...)\n}\nplot(x,t,xlim=xrange,ylim=yrange)\npar(new=T)\ncurve(estimate,type=\"l\",xlim=xrange,ylim=yrange)\n```\n", "tags": ["PRML", "R"]}