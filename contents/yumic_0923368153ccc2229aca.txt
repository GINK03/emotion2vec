{"context": " More than 1 year has passed since last update.MFC\u3067\u306e\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u4f5c\u6210\u306b\u3066\u3001\u3084\u3063\u305f\u3053\u3068\u3092\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u4f5c\u6210\n\u30ef\u30fc\u30ab\u30fc\u30b9\u30ec\u30c3\u30c9\u304c\u7d42\u4e86\u3057\u305f\u3089\u5bfe\u5fdc\u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u51e6\u7406\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\u7528\u610f\u3059\u308b\u3082\u306e\n\n\u30b9\u30ec\u30c3\u30c9\u95a2\u6570\uff08\u5236\u5fa1\u95a2\u6570\uff09\nstatic UINT ThreadProc(LPVOID pParam);\n\u30b9\u30ec\u30c3\u30c9\u51e6\u7406\u672c\u4f53\u95a2\u6570\nvoid ThreadProc();\n\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u5f8c\u51e6\u7406\u95a2\u6570\nafx_msg LRESULT OnCompleteLoadXML(WPARAM wParam, LPARAM lParam );\n\u30b9\u30ec\u30c3\u30c9\u7528\u5909\u6570\uff1aCWinThread\u578b\n\n\n\u4f5c\u6210\u624b\u9806\n\n\u30b9\u30ec\u30c3\u30c9\u958b\u59cb\u51e6\u7406\u5b9f\u88c5\n\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u51e6\u7406\u5b9f\u88c5\n\n\u307e\u305a\u30d8\u30c3\u30c0\u30fc\u306f\u3053\u306e\u901a\u308a\u3002\n\nMyDlg.h\n\nclass CmyDialog : public CDialog\n{\n//\uff5e\u3082\u308d\u3082\u308d\u7701\u7565\n\n/*\u5909\u6570*/\nprivate:\n    CWinThread* pThread;\n\n/*\u95a2\u6570*/\nprivate:\n    void collationReserve();\n    void displayResultScreen();\n\npublic:\n    static UINT ThreadProc(LPVOID pParam);\n    void ThreadProc();\n    afx_msg LRESULT OnCompleteLoadXML(WPARAM wParam, LPARAM lParam );\n};\n\n\n\n1.\u30b9\u30ec\u30c3\u30c9\u958b\u59cb\u51e6\u7406\u5b9f\u88c5\nMFC\u306e\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u306fAfxBeginThread\u95a2\u6570\u3067\u958b\u59cb\u3067\u304d\u307e\u3059\u3002\n\u305d\u308c\u305e\u308c\u306e\u95a2\u6570\u306b\u3064\u3044\u3066\u3002\n\n\u30b9\u30ec\u30c3\u30c9\u95a2\u6570\uff08\u5236\u5fa1\u95a2\u6570\uff09\n\n\nMyDlg.cpp\nUINT CmyDialog::ThreadProc(LPVOID pParam){\n    CmyDialog* pFileView = dynamic_cast<CmyDialog*>(reinterpret_cast<CWnd*>(pParam));\n    if (pFileView)\n    {\n        pFileView->ThreadProc();\n    }\n    return 0;\n}\n\n\n\u30b9\u30ec\u30c3\u30c9\u95a2\u6570\u3067\u306f\u30e1\u30f3\u30d0\u95a2\u6570\u304c\u547c\u3073\u51fa\u305b\u306a\u3044\u305f\u3081\u3001\u51e6\u7406\u672c\u4f53\u95a2\u6570\u3092\u5225\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u30b9\u30ec\u30c3\u30c9\u51e6\u7406\u672c\u4f53\n\n\nMyDlg.cpp\nvoid CmyDialog::ThreadProc()\n{\n    collationReserve();\n    //AfxGetMainWnd()->SendMessage(WM_USER_COMPLETE_LOAD_XML, (WPARAM)&firstIndex, (LPARAM)firstFilePath.GetString() );\n    this->PostMessageA(WM_USER_COMPLETE_LOAD_XML);\n}\n\n\n\u51e6\u7406\u306e\u6700\u5f8c\u306bSendMessage\u95a2\u6570\u304bPostMessage\u95a2\u6570\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308a\u307e\u3059\u3002\u3053\u308c\u3067\u30ef\u30fc\u30ab\u30fc\u30b9\u30ec\u30c3\u30c9\u306e\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u305f\u3053\u3068\u3092\u5143\u30b9\u30ec\u30c3\u30c9\u306b\u77e5\u3089\u305b\u307e\u3059\u3002\n\n\u30b9\u30ec\u30c3\u30c9\u958b\u59cb\u95a2\u6570\uff1aAfxBeginThread\n\n\nMyDlg.cpp\npThread = AfxBeginThread(ThreadProc, (LPVOID)this, THREAD_PRIORITY_NORMAL, 0, CREATE_SUSPENDED , NULL);\nASSERT(pThread);\nif (pThread)\n{\n    pThread->m_pMainWnd = this;\n    pThread->m_bAutoDelete = TRUE;\n    // \u30b9\u30ec\u30c3\u30c9\u51e6\u7406\u306e\u958b\u59cb\n    pThread->ResumeThread();\n}\n\n\n\u305d\u306e\u307e\u307e\u547c\u3073\u51fa\u3057\u3066\u3082\u30b9\u30ec\u30c3\u30c9\u306f\u958b\u59cb\u3057\u307e\u3059\u304c\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u306b\u51e6\u7406\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\n2.\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u51e6\u7406\u5b9f\u88c5\n\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u6642\u306e\u51e6\u7406\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u30de\u30c3\u30d7\u767b\u9332\n\n\nMyDlg.cpp\nBEGIN_MESSAGE_MAP(CmyDialog, CDialog)\n    ON_BN_CLICKED(IDC_BUTTON1, &CmyDialog::OnBnClickedButton1)\n    ON_WM_SHOWWINDOW()\n    ON_WM_PAINT()\n    ON_MESSAGE(WM_USER_COMPLETE_LOAD_XML, CmyDialog::OnCompleteLoadXML)// UserMessage\nEND_MESSAGE_MAP()\n\n\n\uff08cpp\u30d5\u30a1\u30a4\u30eb\u5185\u306b\u3042\u308b\uff09\u30e1\u30c3\u30bb\u30fc\u30b8\u30de\u30c3\u30d7\u5185\u306b\u8ffd\u8a18\u3057\u307e\u3059\u3002\n\n\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u5f8c\u51e6\u7406\u95a2\u6570\n\n\nMyDlg.cpp\nafx_msg LRESULT CmyDialog::OnCompleteLoadXML(WPARAM wParam, LPARAM lParam )\n{\n    displayResultScreen();\n    //delete pThread;\n\n    return 0;\n}\n\n\n\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u5f8c\u306b\u884c\u3046\u51e6\u7406\u3092\u95a2\u6570\u5185\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n\u53c2\u8003\nhttp://simplestar.syuriken.jp/tips/MFC_0010_HowToUseThread.html\nhttp://oissu2.blog77.fc2.com/blog-entry-18.html\n\nMFC\u3067\u306e\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u4f5c\u6210\u306b\u3066\u3001\u3084\u3063\u305f\u3053\u3068\u3092\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\n\n##\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u4f5c\u6210\n\u30ef\u30fc\u30ab\u30fc\u30b9\u30ec\u30c3\u30c9\u304c\u7d42\u4e86\u3057\u305f\u3089\u5bfe\u5fdc\u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u51e6\u7406\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n###\u7528\u610f\u3059\u308b\u3082\u306e\n\n- \u30b9\u30ec\u30c3\u30c9\u95a2\u6570\uff08\u5236\u5fa1\u95a2\u6570\uff09\nstatic UINT ThreadProc(LPVOID pParam);\n- \u30b9\u30ec\u30c3\u30c9\u51e6\u7406\u672c\u4f53\u95a2\u6570\nvoid ThreadProc();\n- \u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u5f8c\u51e6\u7406\u95a2\u6570\nafx_msg LRESULT OnCompleteLoadXML(WPARAM wParam, LPARAM lParam );\n- \u30b9\u30ec\u30c3\u30c9\u7528\u5909\u6570\uff1aCWinThread\u578b\n\n\n###\u4f5c\u6210\u624b\u9806\n\n1. \u30b9\u30ec\u30c3\u30c9\u958b\u59cb\u51e6\u7406\u5b9f\u88c5\n2. \u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u51e6\u7406\u5b9f\u88c5\n\n\u307e\u305a\u30d8\u30c3\u30c0\u30fc\u306f\u3053\u306e\u901a\u308a\u3002\n\n```MyDlg.h\n\nclass CmyDialog : public CDialog\n{\n//\uff5e\u3082\u308d\u3082\u308d\u7701\u7565\n\n/*\u5909\u6570*/\nprivate:\n\tCWinThread* pThread;\n\n/*\u95a2\u6570*/\nprivate:\n\tvoid collationReserve();\n\tvoid displayResultScreen();\n\npublic:\n\tstatic UINT ThreadProc(LPVOID pParam);\n\tvoid ThreadProc();\n\tafx_msg LRESULT OnCompleteLoadXML(WPARAM wParam, LPARAM lParam );\n};\n```\n\n####1.\u30b9\u30ec\u30c3\u30c9\u958b\u59cb\u51e6\u7406\u5b9f\u88c5\nMFC\u306e\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u306fAfxBeginThread\u95a2\u6570\u3067\u958b\u59cb\u3067\u304d\u307e\u3059\u3002\n\u305d\u308c\u305e\u308c\u306e\u95a2\u6570\u306b\u3064\u3044\u3066\u3002\n\n\n* \u30b9\u30ec\u30c3\u30c9\u95a2\u6570\uff08\u5236\u5fa1\u95a2\u6570\uff09\n\n```MyDlg.cpp\nUINT CmyDialog::ThreadProc(LPVOID pParam){\n    CmyDialog* pFileView = dynamic_cast<CmyDialog*>(reinterpret_cast<CWnd*>(pParam));\n    if (pFileView)\n    {\n\t\tpFileView->ThreadProc();\n    }\n    return 0;\n}\n```\n\n\u30b9\u30ec\u30c3\u30c9\u95a2\u6570\u3067\u306f\u30e1\u30f3\u30d0\u95a2\u6570\u304c\u547c\u3073\u51fa\u305b\u306a\u3044\u305f\u3081\u3001\u51e6\u7406\u672c\u4f53\u95a2\u6570\u3092\u5225\u306b\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n* \u30b9\u30ec\u30c3\u30c9\u51e6\u7406\u672c\u4f53\n\n```MyDlg.cpp\nvoid CmyDialog::ThreadProc()\n{\n\tcollationReserve();\n\t//AfxGetMainWnd()->SendMessage(WM_USER_COMPLETE_LOAD_XML, (WPARAM)&firstIndex, (LPARAM)firstFilePath.GetString() );\n\tthis->PostMessageA(WM_USER_COMPLETE_LOAD_XML);\n}\n```\n\n\u51e6\u7406\u306e\u6700\u5f8c\u306bSendMessage\u95a2\u6570\u304bPostMessage\u95a2\u6570\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308a\u307e\u3059\u3002\u3053\u308c\u3067\u30ef\u30fc\u30ab\u30fc\u30b9\u30ec\u30c3\u30c9\u306e\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u305f\u3053\u3068\u3092\u5143\u30b9\u30ec\u30c3\u30c9\u306b\u77e5\u3089\u305b\u307e\u3059\u3002\n\n* \u30b9\u30ec\u30c3\u30c9\u958b\u59cb\u95a2\u6570\uff1aAfxBeginThread\n\n```MyDlg.cpp\npThread = AfxBeginThread(ThreadProc, (LPVOID)this, THREAD_PRIORITY_NORMAL, 0, CREATE_SUSPENDED , NULL);\nASSERT(pThread);\nif (pThread)\n{\n\tpThread->m_pMainWnd = this;\n\tpThread->m_bAutoDelete = TRUE;\n\t// \u30b9\u30ec\u30c3\u30c9\u51e6\u7406\u306e\u958b\u59cb\n\tpThread->ResumeThread();\n}\n```\n\n\u305d\u306e\u307e\u307e\u547c\u3073\u51fa\u3057\u3066\u3082\u30b9\u30ec\u30c3\u30c9\u306f\u958b\u59cb\u3057\u307e\u3059\u304c\u8a2d\u5b9a\u3092\u884c\u3046\u305f\u3081\u306b\u51e6\u7406\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\n####2.\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u51e6\u7406\u5b9f\u88c5\n\n\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u6642\u306e\u51e6\u7406\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n* \u30e1\u30c3\u30bb\u30fc\u30b8\u30de\u30c3\u30d7\u767b\u9332\n\n```MyDlg.cpp\nBEGIN_MESSAGE_MAP(CmyDialog, CDialog)\n\tON_BN_CLICKED(IDC_BUTTON1, &CmyDialog::OnBnClickedButton1)\n\tON_WM_SHOWWINDOW()\n\tON_WM_PAINT()\n\tON_MESSAGE(WM_USER_COMPLETE_LOAD_XML, CmyDialog::OnCompleteLoadXML)// UserMessage\nEND_MESSAGE_MAP()\n```\n\n\uff08cpp\u30d5\u30a1\u30a4\u30eb\u5185\u306b\u3042\u308b\uff09\u30e1\u30c3\u30bb\u30fc\u30b8\u30de\u30c3\u30d7\u5185\u306b\u8ffd\u8a18\u3057\u307e\u3059\u3002\n\n* \u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u5f8c\u51e6\u7406\u95a2\u6570\n\n```MyDlg.cpp\nafx_msg LRESULT CmyDialog::OnCompleteLoadXML(WPARAM wParam, LPARAM lParam )\n{\n\tdisplayResultScreen();\n\t//delete pThread;\n\n\treturn 0;\n}\n```\n\n\u30b9\u30ec\u30c3\u30c9\u7d42\u4e86\u5f8c\u306b\u884c\u3046\u51e6\u7406\u3092\u95a2\u6570\u5185\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n\n##\u53c2\u8003\nhttp://simplestar.syuriken.jp/tips/MFC_0010_HowToUseThread.html\nhttp://oissu2.blog77.fc2.com/blog-entry-18.html\n\n", "tags": ["MFC", "C++", "VisualStudio2008"]}