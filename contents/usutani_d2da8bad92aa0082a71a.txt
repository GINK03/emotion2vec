{"context": " More than 1 year has passed since last update.\u74b0\u5883\n\nRuby 2.1\nRails 4.2.0\nMySQL\nnginx and Unicorn\n\n\u53c2\u8003\n\nDeploying Ruby on Rails Applications to AWS OpsWorks\nChef \u30c6\u3099\u30d5\u309a\u30ed\u30a4\u30d5\u30c3\u30af\u306e\u4f7f\u7528 - AWS OpsWorks\nRails 4.2 \u5199\u7d4c\u7528\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\n\n\u30b5\u30f3\u30d7\u30eb\n\nhttps://github.com/usutani/store_rails420 branch: opsworks\n\n\nRails\u30a2\u30d7\u30ea\u306e\u6e96\u5099\n\nopsworks\u30d6\u30e9\u30f3\u30c1\u306e\u4f5c\u6210\nRails\u30a2\u30d7\u30ea\u306bOpsWorks\u7528\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4f8b\uff1a\u79c1\u306fRails 4.2 \u5199\u7d4c\u7528\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092\u30af\u30ed\u30fc\u30f3\u3057\u3001OpsWorks\u7528\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\ngit checkout -b opsworks\n\n\nGem\u306e\u8ffd\u52a0\nGemfile\u306bMySQL\u63a5\u7d9a\u7528\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\ngem 'mysql2', '~> 0.3.18'\n\ntherubyracer\u3068unicorn\u884c\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u5916\u3057\u3001Gem\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\ngem 'therubyracer', platforms: :ruby\ngem 'unicorn'\n\n\n\u30a2\u30bb\u30c3\u30c8\u306e\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\ndeploy/before_symlink.rb\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u3001\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u30b9\u30c6\u30fc\u30b8\u306e\u524d\u306b\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\nmkdir deploy\nvi deploy/before_symlink.rb\n\n\ndeploy/before_symlink.rb\nrun \"cd #{release_path} && RAILS_ENV=production bundle exec rake assets:precompile\"\n\n\n\nGitHub\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u53cd\u6620\nbundle install\ngit add -A\ngit commit -m OpsWorks\ngit push origin opsworks\n\n\nOpsWorks\u306e\u8a2d\u5b9a\n\nStack\n\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306e\u307e\u307e\u3067\u3001Name\u3060\u3051\u5165\u529b\u3057\u3001\u300cAdd Stack\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u307e\u3059\u3002\n\nAmazon Linux 2014.09\n\n\nLayers\nRails App Server\n\nRuby version 2.1\n\nRails stack nginx and Unicorn\n\nRubyGems version 2.2.2\n\nBundler version 1.7.4\n\n\nMySQL\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\n\n\nInstances\nRails App Server, MySQL\n\nt2.small \u306a\u3069\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n\nApps\nApplication Source\n\nRepository URL https://github.com/usutani/store_rails420.git\n\nBranch/Revision opsworks\n\n\nEnvironment Variables\n\nSECRET_KEY_BASE Protected value\n\n\n\uff08\u53c2\u8003\uff09Mac\uff1abundle exec rake secret | pbcopy\u3067\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\nDeployments\n\nMigrate database YES\n\nAdvanced >> Custom Chef JSON\n\n\u30a2\u30d7\u30ea\u540dstore_rails420\u3092\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n{\n  \"deploy\":\n  {\n    \"store_rails420\":\n    {\n      \"database\":\n      {\n        \"adapter\": \"mysql2\"\n      }\n    }\n  }\n}\n\n\n**\u74b0\u5883**\n\n- Ruby 2.1\n- Rails 4.2.0\n- MySQL\n- nginx and Unicorn\n\n**\u53c2\u8003**\n\n- [Deploying Ruby on Rails Applications to AWS OpsWorks](http://ruby.awsblog.com/post/Tx7FQMT084INCR/)\n- [Chef \u30c6\u3099\u30d5\u309a\u30ed\u30a4\u30d5\u30c3\u30af\u306e\u4f7f\u7528 - AWS OpsWorks](http://docs.aws.amazon.com/ja_jp/opsworks/latest/userguide/workingcookbook-extend-hooks.html)\n- [Rails 4.2 \u5199\u7d4c\u7528\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea](http://qiita.com/usutani/items/2194b55cf1b975cf528d)\n\n**\u30b5\u30f3\u30d7\u30eb**\n\n- [https://github.com/usutani/store_rails420 branch: **opsworks**](https://github.com/usutani/store_rails420/tree/opsworks)\n\n# Rails\u30a2\u30d7\u30ea\u306e\u6e96\u5099\n## opsworks\u30d6\u30e9\u30f3\u30c1\u306e\u4f5c\u6210\nRails\u30a2\u30d7\u30ea\u306bOpsWorks\u7528\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4f8b\uff1a\u79c1\u306f[Rails 4.2 \u5199\u7d4c\u7528\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea](http://qiita.com/usutani/items/2194b55cf1b975cf528d)\u3092\u30af\u30ed\u30fc\u30f3\u3057\u3001OpsWorks\u7528\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n```bash\ngit checkout -b opsworks\n```\n\n## Gem\u306e\u8ffd\u52a0\nGemfile\u306bMySQL\u63a5\u7d9a\u7528\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```Gemfile\ngem 'mysql2', '~> 0.3.18'\n```\n\ntherubyracer\u3068unicorn\u884c\u306e\u30b3\u30e1\u30f3\u30c8\u3092\u5916\u3057\u3001Gem\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n\n```Gemfile\ngem 'therubyracer', platforms: :ruby\ngem 'unicorn'\n```\n\n## \u30a2\u30bb\u30c3\u30c8\u306e\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\ndeploy/before_symlink.rb\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u3001\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u30b9\u30c6\u30fc\u30b8\u306e\u524d\u306b\u30d7\u30ea\u30b3\u30f3\u30d1\u30a4\u30eb\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash\nmkdir deploy\nvi deploy/before_symlink.rb\n```\n\n```deploy/before_symlink.rb\nrun \"cd #{release_path} && RAILS_ENV=production bundle exec rake assets:precompile\"\n```\n\n## GitHub\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u53cd\u6620\n\n```bash\nbundle install\ngit add -A\ngit commit -m OpsWorks\ngit push origin opsworks\n```\n\n# OpsWorks\u306e\u8a2d\u5b9a\n## Stack\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306e\u307e\u307e\u3067\u3001Name\u3060\u3051\u5165\u529b\u3057\u3001\u300cAdd Stack\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u307e\u3059\u3002\n\n- Amazon Linux 2014.09\n\n## Layers\n**Rails App Server**\n\n- Ruby version ```2.1```\n- Rails stack ```nginx and Unicorn```\n- RubyGems version ```2.2.2```\n- Bundler version ```1.7.4```\n\n**MySQL**\n\n- \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\n\n## Instances\n\n**Rails App Server, MySQL**\n\n- t2.small \u306a\u3069\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n## Apps\n**Application Source**\n\n- Repository URL ```https://github.com/usutani/store_rails420.git```\n- Branch/Revision ```opsworks```\n\n**Environment Variables**\n\n- SECRET_KEY_BASE **Protected value**\n\n\uff08\u53c2\u8003\uff09Mac\uff1a```bundle exec rake secret | pbcopy```\u3067\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\n## Deployments\n\n- Migrate database **YES**\n- Advanced >> Custom Chef JSON\n\n\u30a2\u30d7\u30ea\u540d```store_rails420```\u3092\u7f6e\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\n```json\n{\n  \"deploy\":\n  {\n    \"store_rails420\":\n    {\n      \"database\":\n      {\n        \"adapter\": \"mysql2\"\n      }\n    }\n  }\n}\n```\n\n\n", "tags": ["AWS", "opsworks", "Rails"]}