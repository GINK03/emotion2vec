{"context": "\n\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306b\u3064\u3044\u3066\n\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u3001Redshift\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u3068\u305d\u306e\u30af\u30e9\u30b9\u30bf\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u767a\u884c\u3059\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\u30af\u30a8\u30ea\u306e\u767a\u884c\u306b\u306f\u3001\u300cpsql\u300d\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u672c\u624b\u9806\u3067\u306f\u3001Amazon Linux\u4e0a\u3078\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u5229\u7528\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\n\u524d\u63d0\u6761\u4ef6\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306f\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3057\u305f\u3002\n\n\u30b3\u30de\u30f3\u30c9\naws --version\n\n\n\n\u7d50\u679c\naws-cli/1.10.23 Python/2.7.10 Linux/4.4.5-15.26.amzn1.x86_64 botocore/1.4.14\n\n\n\n\u5fc5\u8981\u306a\u6a29\u9650\n\u4f5c\u696d\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u6a29\u9650\u3092\u6709\u3057\u305fIAM\u30e6\u30fc\u30b6\u3082\u3057\u304f\u306fIAM\u30ed\u30fc\u30eb\u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nEC2\u306b\u5bfe\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nRedShift\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nIAM\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nS3\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\nSTS\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n\n\n0. \u6e96\u5099\n\n\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\n\n\u30b3\u30de\u30f3\u30c9\nexport AWS_DEFAULT_REGION='ap-northeast-1'\n\n\n\n\u8cc7\u683c\u60c5\u5831\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws configure list\n\n\n\n\u7d50\u679c\nName                    Value             Type    Location\n----                    -----             ----    --------\nprofile                <not set>             None    None\naccess_key     ****************RDPA         iam-role\nsecret_key     ****************9GA8         iam-role\nregion           ap-northeast-1              env    AWS_DEFAULT_REGION\n\n\n\n1. EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u524a\u9664\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n    INSTANCE_ID: ${INSTANCE_ID}\n\nETX\n\n\n\n\u7d50\u679c\ni-********\n\n\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-instances --instance-ids ${INSTANCE_ID}\n\n\n\n\u7d50\u679c\n\uff08\u7701\u7565\uff09\n\n\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 terminate-instances --instance-ids ${INSTANCE_ID}\n\n\n\n\u7d50\u679c\n{\n    \"TerminatingInstances\": [\n        {\n            \"InstanceId\": \"i-7b972de4\",\n            \"CurrentState\": {\n                \"Code\": 32,\n                \"Name\": \"shutting-down\"\n            },\n            \"PreviousState\": {\n                \"Code\": 16,\n                \"Name\": \"running\"\n            }\n        }\n    ]\n}\n\n\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\nState\u304cterminated\u3067\u3042\u308c\u3070OK\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-instances --instance-ids ${INSTANCE_ID}\n\n\n\n\u7d50\u679c\n{\n    \"Reservations\": [\n        {\n            \"OwnerId\": \"************\",\n            \"ReservationId\": \"r-********\",\n            \"Groups\": [],\n            \"Instances\": [\n                {\n                    \"Monitoring\": {\n                        \"State\": \"disabled\"\n                    },\n                    \"PublicDnsName\": \"\",\n                    \"Platform\": \"windows\",\n                    \"State\": {\n                        \"Code\": 48,\n                        \"Name\": \"terminated\"\n                    },\n                    \"EbsOptimized\": false,\n                    \"LaunchTime\": \"2015-10-17T13:28:19.000Z\",\n                    \"ProductCodes\": [],\n                    \"StateTransitionReason\": \"User initiated (2015-10-17 16:00:38 GMT)\",\n                    \"InstanceId\": \"i-********\",\n                    \"ImageId\": \"ami-4623a846\",\n                    \"PrivateDnsName\": \"\",\n                    \"KeyName\": \"UserManagementServer\",\n                    \"SecurityGroups\": [],\n                    \"ClientToken\": \"\",\n                    \"InstanceType\": \"t2.medium\",\n                    \"NetworkInterfaces\": [],\n                    \"Placement\": {\n                        \"Tenancy\": \"default\",\n                        \"GroupName\": \"\",\n                        \"AvailabilityZone\": \"us-west-2a\"\n                    },\n                    \"Hypervisor\": \"xen\",\n                    \"BlockDeviceMappings\": [],\n                    \"Architecture\": \"x86_64\",\n                    \"StateReason\": {\n                        \"Message\": \"Client.UserInitiatedShutdown: User initiated shutdown\",\n                        \"Code\": \"Client.UserInitiatedShutdown\"\n                    },\n                    \"RootDeviceName\": \"/dev/sda1\",\n                    \"VirtualizationType\": \"hvm\",\n                    \"RootDeviceType\": \"ebs\",\n                    \"AmiLaunchIndex\": 0\n                }\n            ]\n        }\n    ]\n}\n\n\n\n2. \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304a\u3088\u3073IAM\u30ed\u30fc\u30eb\u306e\u524a\u9664\n\n\u78ba\u8a8d\uff08\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\uff09\n\n\u30b3\u30de\u30f3\u30c9\naws iam get-instance-profile --instance-profile-name ${ROLE_NAME}\n\n\n\n\u7d50\u679c\n{\n    \"InstanceProfile\": {\n        \"InstanceProfileId\": \"A********************\",\n        \"Roles\": [\n            {\n                \"AssumeRolePolicyDocument\": {\n                    \"Version\": \"2012-10-17\",\n                    \"Statement\": [\n                        {\n                            \"Action\": \"sts:AssumeRole\",\n                            \"Principal\": {\n                                \"Service\": \"ec2.amazonaws.com\"\n                            },\n                            \"Effect\": \"Allow\",\n                            \"Sid\": \"\"\n                        }\n                    ]\n                },\n                \"RoleId\": \"A********************\",\n                \"CreateDate\": \"2016-04-28T10:35:37Z\",\n                \"RoleName\": \"redshift-role\",\n                \"Path\": \"/\",\n                \"Arn\": \"arn:aws:iam::************:role/redshift-role\"\n            }\n        ],\n        \"CreateDate\": \"2016-04-28T10:36:30Z\",\n        \"InstanceProfileName\": \"redshift-role\",\n        \"Path\": \"/\",\n        \"Arn\": \"arn:aws:iam::************:instance-profile/redshift-role\"\n    }\n}\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304b\u3089IAM\u30ed\u30fc\u30eb\u3092\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws iam remove-role-from-instance-profile \\\n  --instance-profile-name ${ROLE_NAME} \\\n  --role-name ${ROLE_NAME}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws iam delete-instance-profile --instance-profile-name ${ROLE_NAME}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws iam get-instance-profile --instance-profile-name ${ROLE_NAME}\n\n\n\n\u7d50\u679c\nA client error (NoSuchEntity) occurred when calling the GetInstanceProfile operation: Instance Profile redshift-role cannot be found.\n\n\n\n\u78ba\u8a8d\uff08IAM Role\uff09\n\n\u30b3\u30de\u30f3\u30c9\naws iam list-attached-role-policies --role-name ${ROLE_NAME}\n\n\n\n\u7d50\u679c\n{\n    \"AttachedPolicies\": [\n        {\n            \"PolicyName\": \"AmazonS3FullAccess\",\n            \"PolicyArn\": \"arn:aws:iam::aws:policy/AmazonS3FullAccess\"\n        },\n        {\n            \"PolicyName\": \"AmazonRedshiftFullAccess\",\n            \"PolicyArn\": \"arn:aws:iam::aws:policy/AmazonRedshiftFullAccess\"\n        }\n    ]\n}\n\n\n\n\u30dd\u30ea\u30b7\u30fc\u3092\u30c7\u30bf\u30c3\u30c1\n\n\u30b3\u30de\u30f3\u30c9\naws iam detach-role-policy --role-name ${ROLE_NAME} --policy-arn ${S3_POLICY_ARN}\naws iam detach-role-policy --role-name ${ROLE_NAME} --policy-arn ${RS_POLICY_ARN}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\nIAM Role\u3092\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws iam delete-role --role-name ${ROLE_NAME}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\nIAM Role\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws iam list-attached-role-policies --role-name ${ROLE_NAME}\n\n\n\n\u7d50\u679c\nA client error (NoSuchEntity) occurred when calling the ListAttachedRolePolicies operation: Role redshift-role does not exist.\n\n\n\n3. Key Pair\u304a\u3088\u3073\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n\n\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-key-pairs --key-names ${KEY_PAIR_NAME}\n\nls -al ~/.ssh | grep ${KEY_MATERIAL_FILE}\n\n\n\n\u7d50\u679c\n{\n    \"KeyPairs\": [\n        {\n            \"KeyName\": \"Redshift\",\n            \"KeyFingerprint\": \"**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**\"\n        }\n    ]\n}\n\n\n\n\u7d50\u679c\n-rw------- 1 ec2-user ec2-user 1671 Apr 28 10:30 redshift.pem\n\n\n\nKey Pair\u304a\u3088\u3073\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 delete-key-pair --key-name ${KEY_PAIR_NAME}\n\nrm ~/.ssh/${KEY_MATERIAL_FILE}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\nKey Pair\u304a\u3088\u3073\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-key-pairs --key-names ${KEY_PAIR_NAME}\n\nls -al ~/.ssh | grep ${KEY_MATERIAL_FILE}\n\n\n\n\u7d50\u679c\nA client error (InvalidKeyPair.NotFound) occurred when calling the DescribeKeyPairs operation: The key pair 'Redshift' does not exist\n\n\n\n4. VPC\u304a\u3088\u3073VPC\u306b\u95a2\u9023\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u306e\u524a\u9664\nManagement Console\u304b\u3089VPC\u3092\u524a\u9664\u3059\u308b\u3068\u3001\u95a2\u9023\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u3082\u4e00\u62ec\u3067\u524a\u9664\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u6642\u9593\u304c\u7121\u3044\u65b9\u306f\u3001Management Console\u304b\u3089\u524a\u9664\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-security-groups --group-ids ${SG_ID_SSH}\naws ec2 describe-security-groups --group-ids ${SG_ID_REDSHIFT}\n\n\n\n\u7d50\u679c\n{\n    \"SecurityGroups\": [\n        {\n            \"IpPermissionsEgress\": [\n                {\n                    \"IpProtocol\": \"-1\",\n                    \"IpRanges\": [\n                        {\n                            \"CidrIp\": \"0.0.0.0/0\"\n                        }\n                    ],\n                    \"UserIdGroupPairs\": [],\n                    \"PrefixListIds\": []\n                }\n            ],\n            \"Description\": \"JAWS-UG CLI at Co-Edo\",\n            \"IpPermissions\": [\n                {\n                    \"PrefixListIds\": [],\n                    \"FromPort\": 22,\n                    \"IpRanges\": [\n                        {\n                            \"CidrIp\": \"0.0.0.0/0\"\n                        }\n                    ],\n                    \"ToPort\": 22,\n                    \"IpProtocol\": \"tcp\",\n                    \"UserIdGroupPairs\": []\n                }\n            ],\n            \"GroupName\": \"SSH\",\n            \"VpcId\": \"vpc-********\",\n            \"OwnerId\": \"************\",\n            \"GroupId\": \"sg-********\"\n        }\n    ]\n}\n\n\n\n\u7d50\u679c\n{\n    \"SecurityGroups\": [\n        {\n            \"IpPermissionsEgress\": [\n                {\n                    \"IpProtocol\": \"-1\",\n                    \"IpRanges\": [\n                        {\n                            \"CidrIp\": \"0.0.0.0/0\"\n                        }\n                    ],\n                    \"UserIdGroupPairs\": [],\n                    \"PrefixListIds\": []\n                }\n            ],\n            \"Description\": \"JAWS-UG CLI at Co-Edo\",\n            \"IpPermissions\": [\n                {\n                    \"PrefixListIds\": [],\n                    \"FromPort\": 5439,\n                    \"IpRanges\": [\n                        {\n                            \"CidrIp\": \"**.**.**.**/32\"\n                        }\n                    ],\n                    \"ToPort\": 5439,\n                    \"IpProtocol\": \"tcp\",\n                    \"UserIdGroupPairs\": []\n                }\n            ],\n            \"GroupName\": \"Redshift\",\n            \"VpcId\": \"vpc-********\",\n            \"OwnerId\": \"************\",\n            \"GroupId\": \"sg-********\"\n        }\n    ]\n}\n\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 delete-security-group --group-id ${SG_ID_REDSHIFT}\naws ec2 delete-security-group --group-id ${SG_ID_SSH}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-security-groups --group-ids ${SG_ID_REDSHIFT}\naws ec2 describe-security-groups --group-ids ${SG_ID_SSH}\n\n\n\n\u7d50\u679c\nA client error (InvalidGroup.NotFound) occurred when calling the DescribeSecurityGroups operation: The security group 'sg-********' does not exist\n\nA client error (InvalidGroup.NotFound) occurred when calling the DescribeSecurityGroups operation: The security group 'sg-********' does not exist\n\n\n\n\u30b5\u30d6\u30cd\u30c3\u30c8\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-subnets --subnet-ids ${SUBNET_A_ID}\n\n\n\n\u7d50\u679c\n{\n    \"Subnets\": [\n        {\n            \"VpcId\": \"vpc-********\",\n            \"CidrBlock\": \"10.0.0.0/24\",\n            \"MapPublicIpOnLaunch\": false,\n            \"DefaultForAz\": false,\n            \"State\": \"available\",\n            \"AvailabilityZone\": \"ap-northeast-1a\",\n            \"SubnetId\": \"subnet-********\",\n            \"AvailableIpAddressCount\": 251\n        }\n    ]\n}\n\n\n\n\u30b5\u30d6\u30cd\u30c3\u30c8\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 delete-subnet --subnet-id ${SUBNET_A_ID}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\n\u30b5\u30d6\u30cd\u30c3\u30c8\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-subnets --subnet-ids ${SUBNET_A_ID}\n\n\n\n\u7d50\u679c\nA client error (InvalidSubnetID.NotFound) occurred when calling the DescribeSubnets operation: The subnet ID 'subnet-********' does not exist\n\n\n\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-internet-gateways --internet-gateway-ids ${IGW_ID}\n\n\n\n\u7d50\u679c\n{\n    \"InternetGateways\": [\n        {\n            \"Tags\": [],\n            \"InternetGatewayId\": \"igw-********\",\n            \"Attachments\": [\n                {\n                    \"State\": \"available\",\n                    \"VpcId\": \"vpc-********\"\n                }\n            ]\n        }\n    ]\n}\n\n\n\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3092VPC\u304b\u3089\u30c7\u30bf\u30c3\u30c1\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 detach-internet-gateway --internet-gateway-id ${IGW_ID} --vpc-id ${VPC_ID}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u304cVPC\u304b\u3089\u30c7\u30bf\u30c3\u30c1\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-internet-gateways --internet-gateway-ids ${IGW_ID}\n\n\n\n\u7d50\u679c\n{\n    \"InternetGateways\": [\n        {\n            \"Tags\": [],\n            \"InternetGatewayId\": \"igw-********\",\n            \"Attachments\": []\n        }\n    ]\n}\n\n\n\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3092\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 delete-internet-gateway --internet-gateway-id ${IGW_ID}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-internet-gateways --internet-gateway-ids ${IGW_ID}\n\n\n\n\u7d50\u679c\nA client error (InvalidInternetGatewayID.NotFound) occurred when calling the DescribeInternetGateways operation: The internetGateway ID 'igw-********' does not exist\n\n\n\nVPC\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-vpcs --vpc-ids ${VPC_ID}\n\n\n\n\u7d50\u679c\n{\n    \"Vpcs\": [\n        {\n            \"VpcId\": \"vpc-********\",\n            \"InstanceTenancy\": \"default\",\n            \"State\": \"available\",\n            \"DhcpOptionsId\": \"dopt-********\",\n            \"CidrBlock\": \"10.0.0.0/16\",\n            \"IsDefault\": false\n        }\n    ]\n}\n\n\n\nVPC\u306e\u524a\u9664\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 delete-vpc --vpc-id ${VPC_ID}\n\n\n\n\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n\n\n\nVPC\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\naws ec2 describe-vpcs --vpc-ids ${VPC_ID}\n\n\n\n\u7d50\u679c\nA client error (InvalidVpcID.NotFound) occurred when calling the DescribeVpcs operation: The vpc ID 'vpc-********' does not exist\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n# \u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306b\u3064\u3044\u3066\n- \u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u3001Redshift\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u3068\u305d\u306e\u30af\u30e9\u30b9\u30bf\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u767a\u884c\u3059\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u4f5c\u6210\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n- \u30af\u30a8\u30ea\u306e\u767a\u884c\u306b\u306f\u3001\u300cpsql\u300d\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u672c\u624b\u9806\u3067\u306f\u3001Amazon Linux\u4e0a\u3078\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u5229\u7528\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\n# \u524d\u63d0\u6761\u4ef6\n\n## \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u306f\u4ee5\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3057\u305f\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws --version\n```\n\n```text:\u7d50\u679c\naws-cli/1.10.23 Python/2.7.10 Linux/4.4.5-15.26.amzn1.x86_64 botocore/1.4.14\n```\n\n## \u5fc5\u8981\u306a\u6a29\u9650\n\n\u4f5c\u696d\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u4ee5\u4e0b\u306e\u6a29\u9650\u3092\u6709\u3057\u305fIAM\u30e6\u30fc\u30b6\u3082\u3057\u304f\u306fIAM\u30ed\u30fc\u30eb\u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- EC2\u306b\u5bfe\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- RedShift\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- IAM\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- S3\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n- STS\u306b\u95a2\u3059\u308b\u30d5\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u6a29\u9650\n\n\n# 0. \u6e96\u5099\n\n## \u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\n\n```bash:\u30b3\u30de\u30f3\u30c9\nexport AWS_DEFAULT_REGION='ap-northeast-1'\n```\n\n## \u8cc7\u683c\u60c5\u5831\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws configure list\n```\n\n```text:\u7d50\u679c\nName                    Value             Type    Location\n----                    -----             ----    --------\nprofile                <not set>             None    None\naccess_key     ****************RDPA         iam-role\nsecret_key     ****************9GA8         iam-role\nregion           ap-northeast-1              env    AWS_DEFAULT_REGION\n```\n\n\n\n# 1. EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u524a\u9664\n\n## \u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\ncat << ETX\n\n    INSTANCE_ID: ${INSTANCE_ID}\n\nETX\n```\n\n```text:\u7d50\u679c\ni-********\n```\n\n## EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-instances --instance-ids ${INSTANCE_ID}\n```\n\n```text:\u7d50\u679c\n\uff08\u7701\u7565\uff09\n```\n\n## EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 terminate-instances --instance-ids ${INSTANCE_ID}\n```\n\n```json:\u7d50\u679c\n{\n    \"TerminatingInstances\": [\n        {\n            \"InstanceId\": \"i-7b972de4\",\n            \"CurrentState\": {\n                \"Code\": 32,\n                \"Name\": \"shutting-down\"\n            },\n            \"PreviousState\": {\n                \"Code\": 16,\n                \"Name\": \"running\"\n            }\n        }\n    ]\n}\n```\n\n## EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\nState\u304cterminated\u3067\u3042\u308c\u3070OK\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-instances --instance-ids ${INSTANCE_ID}\n```\n\n```json:\u7d50\u679c\n{\n    \"Reservations\": [\n        {\n            \"OwnerId\": \"************\",\n            \"ReservationId\": \"r-********\",\n            \"Groups\": [],\n            \"Instances\": [\n                {\n                    \"Monitoring\": {\n                        \"State\": \"disabled\"\n                    },\n                    \"PublicDnsName\": \"\",\n                    \"Platform\": \"windows\",\n                    \"State\": {\n                        \"Code\": 48,\n                        \"Name\": \"terminated\"\n                    },\n                    \"EbsOptimized\": false,\n                    \"LaunchTime\": \"2015-10-17T13:28:19.000Z\",\n                    \"ProductCodes\": [],\n                    \"StateTransitionReason\": \"User initiated (2015-10-17 16:00:38 GMT)\",\n                    \"InstanceId\": \"i-********\",\n                    \"ImageId\": \"ami-4623a846\",\n                    \"PrivateDnsName\": \"\",\n                    \"KeyName\": \"UserManagementServer\",\n                    \"SecurityGroups\": [],\n                    \"ClientToken\": \"\",\n                    \"InstanceType\": \"t2.medium\",\n                    \"NetworkInterfaces\": [],\n                    \"Placement\": {\n                        \"Tenancy\": \"default\",\n                        \"GroupName\": \"\",\n                        \"AvailabilityZone\": \"us-west-2a\"\n                    },\n                    \"Hypervisor\": \"xen\",\n                    \"BlockDeviceMappings\": [],\n                    \"Architecture\": \"x86_64\",\n                    \"StateReason\": {\n                        \"Message\": \"Client.UserInitiatedShutdown: User initiated shutdown\",\n                        \"Code\": \"Client.UserInitiatedShutdown\"\n                    },\n                    \"RootDeviceName\": \"/dev/sda1\",\n                    \"VirtualizationType\": \"hvm\",\n                    \"RootDeviceType\": \"ebs\",\n                    \"AmiLaunchIndex\": 0\n                }\n            ]\n        }\n    ]\n}\n```\n\n# 2. \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304a\u3088\u3073IAM\u30ed\u30fc\u30eb\u306e\u524a\u9664\n\n## \u78ba\u8a8d\uff08\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\uff09\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam get-instance-profile --instance-profile-name ${ROLE_NAME}\n```\n\n```json:\u7d50\u679c\n{\n    \"InstanceProfile\": {\n        \"InstanceProfileId\": \"A********************\",\n        \"Roles\": [\n            {\n                \"AssumeRolePolicyDocument\": {\n                    \"Version\": \"2012-10-17\",\n                    \"Statement\": [\n                        {\n                            \"Action\": \"sts:AssumeRole\",\n                            \"Principal\": {\n                                \"Service\": \"ec2.amazonaws.com\"\n                            },\n                            \"Effect\": \"Allow\",\n                            \"Sid\": \"\"\n                        }\n                    ]\n                },\n                \"RoleId\": \"A********************\",\n                \"CreateDate\": \"2016-04-28T10:35:37Z\",\n                \"RoleName\": \"redshift-role\",\n                \"Path\": \"/\",\n                \"Arn\": \"arn:aws:iam::************:role/redshift-role\"\n            }\n        ],\n        \"CreateDate\": \"2016-04-28T10:36:30Z\",\n        \"InstanceProfileName\": \"redshift-role\",\n        \"Path\": \"/\",\n        \"Arn\": \"arn:aws:iam::************:instance-profile/redshift-role\"\n    }\n}\n```\n\n## \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304b\u3089IAM\u30ed\u30fc\u30eb\u3092\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam remove-role-from-instance-profile \\\n  --instance-profile-name ${ROLE_NAME} \\\n  --role-name ${ROLE_NAME}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n## \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam delete-instance-profile --instance-profile-name ${ROLE_NAME}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n\n## \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam get-instance-profile --instance-profile-name ${ROLE_NAME}\n```\n\n```text:\u7d50\u679c\nA client error (NoSuchEntity) occurred when calling the GetInstanceProfile operation: Instance Profile redshift-role cannot be found.\n```\n\n## \u78ba\u8a8d\uff08IAM Role\uff09\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam list-attached-role-policies --role-name ${ROLE_NAME}\n```\n\n```json:\u7d50\u679c\n{\n    \"AttachedPolicies\": [\n        {\n            \"PolicyName\": \"AmazonS3FullAccess\",\n            \"PolicyArn\": \"arn:aws:iam::aws:policy/AmazonS3FullAccess\"\n        },\n        {\n            \"PolicyName\": \"AmazonRedshiftFullAccess\",\n            \"PolicyArn\": \"arn:aws:iam::aws:policy/AmazonRedshiftFullAccess\"\n        }\n    ]\n}\n```\n\n## \u30dd\u30ea\u30b7\u30fc\u3092\u30c7\u30bf\u30c3\u30c1\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam detach-role-policy --role-name ${ROLE_NAME} --policy-arn ${S3_POLICY_ARN}\naws iam detach-role-policy --role-name ${ROLE_NAME} --policy-arn ${RS_POLICY_ARN}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n## IAM Role\u3092\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam delete-role --role-name ${ROLE_NAME}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n\n## IAM Role\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws iam list-attached-role-policies --role-name ${ROLE_NAME}\n```\n\n```text:\u7d50\u679c\nA client error (NoSuchEntity) occurred when calling the ListAttachedRolePolicies operation: Role redshift-role does not exist.\n```\n\n# 3. Key Pair\u304a\u3088\u3073\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n\n## \u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-key-pairs --key-names ${KEY_PAIR_NAME}\n\nls -al ~/.ssh | grep ${KEY_MATERIAL_FILE}\n```\n\n```json:\u7d50\u679c\n{\n    \"KeyPairs\": [\n        {\n            \"KeyName\": \"Redshift\",\n            \"KeyFingerprint\": \"**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:**\"\n        }\n    ]\n}\n```\n\n```text:\u7d50\u679c\n-rw------- 1 ec2-user ec2-user 1671 Apr 28 10:30 redshift.pem\n```\n\n## Key Pair\u304a\u3088\u3073\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 delete-key-pair --key-name ${KEY_PAIR_NAME}\n\nrm ~/.ssh/${KEY_MATERIAL_FILE}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n## Key Pair\u304a\u3088\u3073\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-key-pairs --key-names ${KEY_PAIR_NAME}\n\nls -al ~/.ssh | grep ${KEY_MATERIAL_FILE}\n```\n\n```text:\u7d50\u679c\nA client error (InvalidKeyPair.NotFound) occurred when calling the DescribeKeyPairs operation: The key pair 'Redshift' does not exist\n```\n\n# 4. VPC\u304a\u3088\u3073VPC\u306b\u95a2\u9023\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u306e\u524a\u9664\n\nManagement Console\u304b\u3089VPC\u3092\u524a\u9664\u3059\u308b\u3068\u3001\u95a2\u9023\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u3082\u4e00\u62ec\u3067\u524a\u9664\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u6642\u9593\u304c\u7121\u3044\u65b9\u306f\u3001Management Console\u304b\u3089\u524a\u9664\u3057\u307e\u3057\u3087\u3046\u3002\n\n## \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-security-groups --group-ids ${SG_ID_SSH}\naws ec2 describe-security-groups --group-ids ${SG_ID_REDSHIFT}\n```\n\n```json:\u7d50\u679c\n{\n    \"SecurityGroups\": [\n        {\n            \"IpPermissionsEgress\": [\n                {\n                    \"IpProtocol\": \"-1\",\n                    \"IpRanges\": [\n                        {\n                            \"CidrIp\": \"0.0.0.0/0\"\n                        }\n                    ],\n                    \"UserIdGroupPairs\": [],\n                    \"PrefixListIds\": []\n                }\n            ],\n            \"Description\": \"JAWS-UG CLI at Co-Edo\",\n            \"IpPermissions\": [\n                {\n                    \"PrefixListIds\": [],\n                    \"FromPort\": 22,\n                    \"IpRanges\": [\n                        {\n                            \"CidrIp\": \"0.0.0.0/0\"\n                        }\n                    ],\n                    \"ToPort\": 22,\n                    \"IpProtocol\": \"tcp\",\n                    \"UserIdGroupPairs\": []\n                }\n            ],\n            \"GroupName\": \"SSH\",\n            \"VpcId\": \"vpc-********\",\n            \"OwnerId\": \"************\",\n            \"GroupId\": \"sg-********\"\n        }\n    ]\n}\n```\n\n```json:\u7d50\u679c\n{\n    \"SecurityGroups\": [\n        {\n            \"IpPermissionsEgress\": [\n                {\n                    \"IpProtocol\": \"-1\",\n                    \"IpRanges\": [\n                        {\n                            \"CidrIp\": \"0.0.0.0/0\"\n                        }\n                    ],\n                    \"UserIdGroupPairs\": [],\n                    \"PrefixListIds\": []\n                }\n            ],\n            \"Description\": \"JAWS-UG CLI at Co-Edo\",\n            \"IpPermissions\": [\n                {\n                    \"PrefixListIds\": [],\n                    \"FromPort\": 5439,\n                    \"IpRanges\": [\n                        {\n                            \"CidrIp\": \"**.**.**.**/32\"\n                        }\n                    ],\n                    \"ToPort\": 5439,\n                    \"IpProtocol\": \"tcp\",\n                    \"UserIdGroupPairs\": []\n                }\n            ],\n            \"GroupName\": \"Redshift\",\n            \"VpcId\": \"vpc-********\",\n            \"OwnerId\": \"************\",\n            \"GroupId\": \"sg-********\"\n        }\n    ]\n}\n```\n\n## \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 delete-security-group --group-id ${SG_ID_REDSHIFT}\naws ec2 delete-security-group --group-id ${SG_ID_SSH}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n## \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-security-groups --group-ids ${SG_ID_REDSHIFT}\naws ec2 describe-security-groups --group-ids ${SG_ID_SSH}\n```\n\n```text:\u7d50\u679c\nA client error (InvalidGroup.NotFound) occurred when calling the DescribeSecurityGroups operation: The security group 'sg-********' does not exist\n\nA client error (InvalidGroup.NotFound) occurred when calling the DescribeSecurityGroups operation: The security group 'sg-********' does not exist\n```\n\n## \u30b5\u30d6\u30cd\u30c3\u30c8\u306e\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-subnets --subnet-ids ${SUBNET_A_ID}\n```\n\n```json:\u7d50\u679c\n{\n    \"Subnets\": [\n        {\n            \"VpcId\": \"vpc-********\",\n            \"CidrBlock\": \"10.0.0.0/24\",\n            \"MapPublicIpOnLaunch\": false,\n            \"DefaultForAz\": false,\n            \"State\": \"available\",\n            \"AvailabilityZone\": \"ap-northeast-1a\",\n            \"SubnetId\": \"subnet-********\",\n            \"AvailableIpAddressCount\": 251\n        }\n    ]\n}\n```\n\n## \u30b5\u30d6\u30cd\u30c3\u30c8\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 delete-subnet --subnet-id ${SUBNET_A_ID}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n## \u30b5\u30d6\u30cd\u30c3\u30c8\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-subnets --subnet-ids ${SUBNET_A_ID}\n```\n\n```text:\u7d50\u679c\nA client error (InvalidSubnetID.NotFound) occurred when calling the DescribeSubnets operation: The subnet ID 'subnet-********' does not exist\n```\n\n## \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306e\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-internet-gateways --internet-gateway-ids ${IGW_ID}\n```\n\n```json:\u7d50\u679c\n{\n    \"InternetGateways\": [\n        {\n            \"Tags\": [],\n            \"InternetGatewayId\": \"igw-********\",\n            \"Attachments\": [\n                {\n                    \"State\": \"available\",\n                    \"VpcId\": \"vpc-********\"\n                }\n            ]\n        }\n    ]\n}\n```\n\n## \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3092VPC\u304b\u3089\u30c7\u30bf\u30c3\u30c1\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 detach-internet-gateway --internet-gateway-id ${IGW_ID} --vpc-id ${VPC_ID}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n## \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u304cVPC\u304b\u3089\u30c7\u30bf\u30c3\u30c1\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-internet-gateways --internet-gateway-ids ${IGW_ID}\n```\n\n```json:\u7d50\u679c\n{\n    \"InternetGateways\": [\n        {\n            \"Tags\": [],\n            \"InternetGatewayId\": \"igw-********\",\n            \"Attachments\": []\n        }\n    ]\n}\n```\n\n## \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3092\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 delete-internet-gateway --internet-gateway-id ${IGW_ID}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n## \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-internet-gateways --internet-gateway-ids ${IGW_ID}\n```\n\n```text:\u7d50\u679c\nA client error (InvalidInternetGatewayID.NotFound) occurred when calling the DescribeInternetGateways operation: The internetGateway ID 'igw-********' does not exist\n```\n\n## VPC\u306e\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-vpcs --vpc-ids ${VPC_ID}\n```\n\n```json:\u7d50\u679c\n{\n    \"Vpcs\": [\n        {\n            \"VpcId\": \"vpc-********\",\n            \"InstanceTenancy\": \"default\",\n            \"State\": \"available\",\n            \"DhcpOptionsId\": \"dopt-********\",\n            \"CidrBlock\": \"10.0.0.0/16\",\n            \"IsDefault\": false\n        }\n    ]\n}\n```\n\n## VPC\u306e\u524a\u9664\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 delete-vpc --vpc-id ${VPC_ID}\n```\n\n```text:\u7d50\u679c\n\uff08\u8fd4\u5024\u7121\u3057\uff09\n```\n\n## VPC\u304c\u524a\u9664\u3055\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\n\n```bash:\u30b3\u30de\u30f3\u30c9\naws ec2 describe-vpcs --vpc-ids ${VPC_ID}\n```\n\n```text:\u7d50\u679c\nA client error (InvalidVpcID.NotFound) occurred when calling the DescribeVpcs operation: The vpc ID 'vpc-********' does not exist\n```\n\n\u4ee5\u4e0a\u3067\u3059\u3002\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u3002\n", "tags": ["AWS", "aws-cli", "redshift"]}