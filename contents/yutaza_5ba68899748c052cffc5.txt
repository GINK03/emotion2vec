{"context": "Node.js\u3092\u4f7f\u3063\u3066\u3001\u30b0\u30eb\u30fc\u30d7\u30c1\u30e3\u30c3\u30c8\u304c\u3067\u304d\u308b\u30c1\u30e3\u30c3\u30c8\u30b5\u30fc\u30d0\u3092\u958b\u767a\u3057\u305f\u6642\u306e\u6700\u4f4e\u9650\u30e1\u30e2\u3067\u3059\u3002\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\n\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u3092\u4f5c\u3063\u3066\u3001\u30b0\u30eb\u30fc\u30d7\u3067\u30c1\u30e3\u30c3\u30c8\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n\u30b5\u30fc\u30d0\u90e8\u5206\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u90e8\u5206\u3092\u5207\u308a\u5206\u3051\u308b\n\n\n\u30b5\u30fc\u30d0\u90e8\u5206\u306e\u5b9f\u88c5\napp.js\nvar io = require('socket.io')(3000);\n\n/**\n * connection\n */\nio.sockets.on('connection', function (socket) {\n\n  /**\n   * disconnect\n   */\n  socket.on('disconnect', function () {\n    socket.leave(socket.data.room);\n  });\n\n  /**\n   * \u30e1\u30f3\u30d0\u30fc\u3092\u8ffd\u52a0\u3000\n   */\n  socket.on('add:member', function(data) {\n    socket.data = data;\n    socket.join(data.room);\n    io.sockets.to(socket.data.room).emit('insert:message', socket.data.message);\n  });\n\n  /**\n   * \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u633f\u5165\n   */\n  socket.on('insert:message', function (data) {\n    io.sockets.to(socket.data.room).emit('insert:message', data.message);\n  });\n\n});\n\n\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u306b\u5165\u5834\nsocket.join(\"\u30eb\u30fc\u30e0ID\");\n\n\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u5185\u306b\u3044\u308b\u30e1\u30f3\u30d0\u30fc\u306e\u307f\u306b\u901a\u77e5\nio.sockets.to(\"\u30eb\u30fc\u30e0ID\").emit('insert:message', \"\u30e1\u30c3\u30bb\u30fc\u30b8\");\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u90e8\u5206\u306e\u5b9f\u88c5\nindex.html\n<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<title>\u30c1\u30e3\u30c3\u30c8\u30b5\u30f3\u30d7\u30eb</title>\n<meta charset=\"utf-8\">\n<meta name=\"description\" content=\"\">\n<meta name=\"author\" content=\"\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n</head>\n<body>\n\n  <input type=\"text\" id=\"message_input\" style=\"width:200px;\" />\n  <button onclick=\"sendMessage();\">\u9001\u4fe1</button>\n  <div id=\"message\"></div>\n\n<script src=\"https://cdn.socket.io/socket.io-1.4.5.js\"></script>\n<script>\nfunction sendMessage() {\n  var textInput = document.getElementById('message_input');\n  socket.emit('insert:message', {message: textInput.value});\n  textInput.value = '';\n}\nfunction print(text) {\n  document.getElementById('message').innerHTML += text + '<br>';\n}\nvar socket = io.connect('ws://localhost:3000');\nsocket.on('connect', function () {\n  var id = socket.io.engine.id;\n  var rooms = ['room1', 'room2'];\n  var rand = Math.floor( Math.random() * 100 ) % 2;\n  document.getElementById('message').innerHTML = '';\n  socket.emit('add:member', {room: rooms[rand], message: 'join room: ' + rooms[rand]});\n});\nsocket.on('insert:message', function (message) {\n  print(JSON.stringify(message));\n});\n</script>\n\n</body>\n</html>\n\n\n\u307e\u3068\u3081\n\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u3084\u308a\u3068\u308a\u306f\u3001json\u5f62\u5f0f\u306b\u3057\u3066\u304a\u304f\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u90e8\u5206\u3067\u8abf\u6574\u304c\u3067\u304d\u308b\u3002\n\n\u30b5\u30f3\u30d7\u30eb\nhttps://github.com/yutaza/chat-server-sample\n\nNode.js\u3092\u4f7f\u3063\u3066\u3001\u30b0\u30eb\u30fc\u30d7\u30c1\u30e3\u30c3\u30c8\u304c\u3067\u304d\u308b\u30c1\u30e3\u30c3\u30c8\u30b5\u30fc\u30d0\u3092\u958b\u767a\u3057\u305f\u6642\u306e\u6700\u4f4e\u9650\u30e1\u30e2\u3067\u3059\u3002\n\n# \u3084\u308a\u305f\u3044\u3053\u3068\n- \u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u3092\u4f5c\u3063\u3066\u3001\u30b0\u30eb\u30fc\u30d7\u3067\u30c1\u30e3\u30c3\u30c8\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n- \u30b5\u30fc\u30d0\u90e8\u5206\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u90e8\u5206\u3092\u5207\u308a\u5206\u3051\u308b\n\n# \u30b5\u30fc\u30d0\u90e8\u5206\u306e\u5b9f\u88c5\n\napp.js\n\n```\nvar io = require('socket.io')(3000);\n\n/**\n * connection\n */\nio.sockets.on('connection', function (socket) {\n\n  /**\n   * disconnect\n   */\n  socket.on('disconnect', function () {\n    socket.leave(socket.data.room);\n  });\n\n  /**\n   * \u30e1\u30f3\u30d0\u30fc\u3092\u8ffd\u52a0\u3000\n   */\n  socket.on('add:member', function(data) {\n    socket.data = data;\n    socket.join(data.room);\n    io.sockets.to(socket.data.room).emit('insert:message', socket.data.message);\n  });\n\n  /**\n   * \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u633f\u5165\n   */\n  socket.on('insert:message', function (data) {\n    io.sockets.to(socket.data.room).emit('insert:message', data.message);\n  });\n\n});\n```\n\n\n\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u306b\u5165\u5834\n\n```\nsocket.join(\"\u30eb\u30fc\u30e0ID\");\n```\n\n\n\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u5185\u306b\u3044\u308b\u30e1\u30f3\u30d0\u30fc\u306e\u307f\u306b\u901a\u77e5\n\n```\nio.sockets.to(\"\u30eb\u30fc\u30e0ID\").emit('insert:message', \"\u30e1\u30c3\u30bb\u30fc\u30b8\");\n```\n\n\n# \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u90e8\u5206\u306e\u5b9f\u88c5\n\nindex.html\n\n```\n<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<title>\u30c1\u30e3\u30c3\u30c8\u30b5\u30f3\u30d7\u30eb</title>\n<meta charset=\"utf-8\">\n<meta name=\"description\" content=\"\">\n<meta name=\"author\" content=\"\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n</head>\n<body>\n\n  <input type=\"text\" id=\"message_input\" style=\"width:200px;\" />\n  <button onclick=\"sendMessage();\">\u9001\u4fe1</button>\n  <div id=\"message\"></div>\n\n<script src=\"https://cdn.socket.io/socket.io-1.4.5.js\"></script>\n<script>\nfunction sendMessage() {\n  var textInput = document.getElementById('message_input');\n  socket.emit('insert:message', {message: textInput.value});\n  textInput.value = '';\n}\nfunction print(text) {\n  document.getElementById('message').innerHTML += text + '<br>';\n}\nvar socket = io.connect('ws://localhost:3000');\nsocket.on('connect', function () {\n  var id = socket.io.engine.id;\n  var rooms = ['room1', 'room2'];\n  var rand = Math.floor( Math.random() * 100 ) % 2;\n  document.getElementById('message').innerHTML = '';\n  socket.emit('add:member', {room: rooms[rand], message: 'join room: ' + rooms[rand]});\n});\nsocket.on('insert:message', function (message) {\n  print(JSON.stringify(message));\n});\n</script>\n\n</body>\n</html>\n```\n\n\n# \u307e\u3068\u3081\n\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u3084\u308a\u3068\u308a\u306f\u3001json\u5f62\u5f0f\u306b\u3057\u3066\u304a\u304f\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u90e8\u5206\u3067\u8abf\u6574\u304c\u3067\u304d\u308b\u3002\n\n## \u30b5\u30f3\u30d7\u30eb\nhttps://github.com/yutaza/chat-server-sample\n\n\n\n\n", "tags": ["JavaScript", "Socket.io", "Node.js"]}