{"context": " More than 1 year has passed since last update.\u307e\u3060\u5168\u7136\u5b9f\u9a13\u4e2d\n\n\u76ee\u7684\nPC\u7528\u3068mobile\u7528\u3092\u5225\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3057\u305f\u3044\u3068\u304b\n\u7ba1\u7406\u30c4\u30fc\u30eb\u3092\u5225\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3057\u305f\u3044\u3068\u304b\n\u305d\u3046\u3044\u3046\u6642\u306bEngine\u3092\u4f7f\u3046\u3068model\u306e\u5171\u6709\u304c\u3057\u3084\u3059\u3044\u3002\n(\u304b\u3082\u3057\u308c\u306a\u3044)\n\n\u57fa\u672c\u7684\u306aEngine\u306e\u3064\u304f\u308a\u304b\u305f\nrails plugin new my_engine --mountable\nbin/rails g model hoge\n\n\u751f\u6210\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u3044\u3064\u3082\u3069\u304a\u308a\u5f04\u308c\u3070\u304ak\n\nRSpec\u3068FactoryGirl \u3092\u4f7f\u3046\n\u666e\u901a\u306bgemspec\u306bgem\u3092\u8ffd\u52a0\u3057\u305f\u3042\u3068 lib/my_engine/engine.rb \u306b\u4ee5\u4e0b\u3092\u8ffd\u52a0\u3057\u3066\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u304crspec\u3068factory_girl\u3092\u4f7f\u3046\u3088\u3046\u306b\u3059\u308b\n  class Engine < ::Rails::Engine\n    config.generators do |g|\n      g.test_framework :rspec, fixtures: false\n      g.fixture_replacement :factory_girl, dir: 'spec/factories'\n    end\n  end\n\n\u3053\u308c\u3067\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3092\u5b9f\u884c\u3059\u308b\u3068\n$bin/rails g model user\n  invoke  active_record\n  create  db/migrate/20141104193453_create_my_engine_users.rb\n  create    app/models/my_engine/user.rb\n  invoke    rspec\n  create      spec/models/my_engine/user_spec.rb\n  invoke      factory_girl\n  create        spec/factories/my_engine_users.rb\n\n\u306a\u611f\u3058\u306b\u306a\u308b\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089factory\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n\u305d\u306e\u307e\u307e\u3067\u306fEngine\u3092\u5229\u7528\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089factory\u304c\u898b\u3048\u306a\u3044\u3002\nEngine\u306e\u4e2d\u3067FactoryGirl\u306b\u30d5\u30a1\u30a4\u30eb\u306e\u3042\u308a\u304b\u3092\u6559\u3048\u308b\u3002\n  class Engine < ::Rails::Engine\n    initializer 'my_engine.factories', after: 'factory_girl.set_factory_paths' do\n      FactoryGirl.definition_file_paths.unshift File.expand_path('../../spec/factories', __FILE__)\n    end\n  end\n\nFactoryGirl(Rails)\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u306f factory_girl.set_factory_paths \u304c\u81ea\u52d5\u3067\u547c\u3070\u308c\u308b\u306e\u3067\u3001\u305d\u306e\u5f8c\u306b\u30b3\u30fc\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\nFactoryGirl\u3092\u4f7f\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\u306e\u3067\u5b89\u5fc3\u3002\n\n\u554f\u984c\u70b9 / \u7591\u554f\u70b9\n\u307e\u3060\u3088\u304f\u308f\u304b\u3089\u3093\u3068\u3053\u308d\n\nRelation\u306f\u3069\u3046\u306a\u308b\u306e\n\u7279\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\u6761\u4ef6\u3092\u8ffd\u52a0\u3057\u305f\u308a\u3057\u305f\u3044\u3068\u304d\u306a\u3069\nEngine\u306emodel\u3092\u62e1\u5f35\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\u3082\u3068\u3082\u3068\u306e\u30b3\u30fc\u30c9\u304c\nclass MyEngine::User\n  has_many :articles\nend\n\nclass MyEngine::Article\n  belongs_to :user\nend\n\n\u306a\u611f\u3058\u306e\u6642\u3001\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\nclass User < MyEngine::User\n  default_scope { where(:banned, false) }\nend\n\nclass Article < MyEngine::Article\n  default_scope { where(:draft, false) }\nend\n\n\u3068\u3084\u3063\u305f\u3068\u304d\u3001 User.first.articles \u306f MyEngine::Article \u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u3060\u3002\n\u3088\u3063\u3066Article\u3067\u8a2d\u5b9a\u3057\u305fdefault_scope\u306f\u52b9\u304b\u306a\u3044\u3002\nEngine\u306emodel\u3092\u62e1\u5f35\u3057\u3066\u4f7f\u3044\u305f\u3044\u3068\u304d\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u306e\u3060\u308d\u3046\u304b?\n\n\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u3092\u4f5c\u308b\n\n\nrelation\u3092\u5b9a\u7fa9\u3057\u76f4\u3059? \u3081\u3093\u3069\u3044\nfactory\u3082\u5b9a\u7fa9\u3057\u306a\u304a\u3057\u306b\u306a\u308b?\n\n\nMyEngine::User \u3092\u62e1\u5f35\u3059\u308b?\n\n\n\u305d\u306e\u5834\u5408\u3069\u3053\u306b\u66f8\u304f? initializer\u304c\u592a\u308b\n\u305d\u3082\u305d\u3082MyEngine::User\u306fEngine\u306e\u4e2d\u306e\u30b3\u30fc\u30c9\u3057\u304b\u898b\u306b\u884c\u304b\u306a\u3044\nMyEngine::User \u304c\u30ed\u30fc\u30c9\u3055\u308c\u305f\u3089\u62e1\u5f35\u306e\u30b3\u30fc\u30c9\u304c\u8d70\u308b\u3088\u3046\u306binitializer\u3067\u304c\u3093\u3070\u308b?\n\n\n\u305d\u3082\u305d\u3082Engine\u306e\u30e2\u30c7\u30eb\u3092\u62e1\u5f35\u306a\u3093\u3066\u8003\u3048\u3066\u306f\u3044\u3051\u306a\u3044\nfactory\u306f\u3069\u3046\u3059\u308b?\n\n\nfactory\u306e\u518d\u5b9a\u7fa9\u3067\u304d\u306a\u3044\u306e\u8f9b\u3044\n\n\n\n\u307e\u3060\u5168\u7136\u5b9f\u9a13\u4e2d\n\n## \u76ee\u7684\n\nPC\u7528\u3068mobile\u7528\u3092\u5225\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3057\u305f\u3044\u3068\u304b\n\u7ba1\u7406\u30c4\u30fc\u30eb\u3092\u5225\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3057\u305f\u3044\u3068\u304b\n\u305d\u3046\u3044\u3046\u6642\u306bEngine\u3092\u4f7f\u3046\u3068model\u306e\u5171\u6709\u304c\u3057\u3084\u3059\u3044\u3002\n(\u304b\u3082\u3057\u308c\u306a\u3044)\n\n### \u57fa\u672c\u7684\u306aEngine\u306e\u3064\u304f\u308a\u304b\u305f\n\n    rails plugin new my_engine --mountable\n    bin/rails g model hoge\n\n\u751f\u6210\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u3044\u3064\u3082\u3069\u304a\u308a\u5f04\u308c\u3070\u304ak\n\n### RSpec\u3068FactoryGirl \u3092\u4f7f\u3046\n\n\u666e\u901a\u306bgemspec\u306bgem\u3092\u8ffd\u52a0\u3057\u305f\u3042\u3068 `lib/my_engine/engine.rb` \u306b\u4ee5\u4e0b\u3092\u8ffd\u52a0\u3057\u3066\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u304crspec\u3068factory_girl\u3092\u4f7f\u3046\u3088\u3046\u306b\u3059\u308b\n\n```rb\n  class Engine < ::Rails::Engine\n    config.generators do |g|\n      g.test_framework :rspec, fixtures: false\n      g.fixture_replacement :factory_girl, dir: 'spec/factories'\n    end\n  end\n```\n \n\u3053\u308c\u3067\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3092\u5b9f\u884c\u3059\u308b\u3068\n\n    $bin/rails g model user\n      invoke  active_record\n      create  db/migrate/20141104193453_create_my_engine_users.rb\n      create    app/models/my_engine/user.rb\n      invoke    rspec\n      create      spec/models/my_engine/user_spec.rb\n      invoke      factory_girl\n      create        spec/factories/my_engine_users.rb\n\n\u306a\u611f\u3058\u306b\u306a\u308b\n\n### \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089factory\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n\n\u305d\u306e\u307e\u307e\u3067\u306fEngine\u3092\u5229\u7528\u3059\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089factory\u304c\u898b\u3048\u306a\u3044\u3002\nEngine\u306e\u4e2d\u3067FactoryGirl\u306b\u30d5\u30a1\u30a4\u30eb\u306e\u3042\u308a\u304b\u3092\u6559\u3048\u308b\u3002\n\n```rb\n  class Engine < ::Rails::Engine\n    initializer 'my_engine.factories', after: 'factory_girl.set_factory_paths' do\n      FactoryGirl.definition_file_paths.unshift File.expand_path('../../spec/factories', __FILE__)\n    end\n  end\n```\n\nFactoryGirl(Rails)\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u306f `factory_girl.set_factory_paths` \u304c\u81ea\u52d5\u3067\u547c\u3070\u308c\u308b\u306e\u3067\u3001\u305d\u306e\u5f8c\u306b\u30b3\u30fc\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3002\nFactoryGirl\u3092\u4f7f\u3063\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\u306e\u3067\u5b89\u5fc3\u3002\n\n## \u554f\u984c\u70b9 / \u7591\u554f\u70b9\n\n\u307e\u3060\u3088\u304f\u308f\u304b\u3089\u3093\u3068\u3053\u308d\n\n### Relation\u306f\u3069\u3046\u306a\u308b\u306e\n\n\u7279\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\u6761\u4ef6\u3092\u8ffd\u52a0\u3057\u305f\u308a\u3057\u305f\u3044\u3068\u304d\u306a\u3069\nEngine\u306emodel\u3092\u62e1\u5f35\u3059\u308b\u3053\u3068\u306b\u306a\u308b\u3002\n\n\u3082\u3068\u3082\u3068\u306e\u30b3\u30fc\u30c9\u304c\n\n```rb\nclass MyEngine::User\n  has_many :articles\nend\n\nclass MyEngine::Article\n  belongs_to :user\nend\n```\n\n\u306a\u611f\u3058\u306e\u6642\u3001\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\n\n```rb\nclass User < MyEngine::User\n  default_scope { where(:banned, false) }\nend\n\nclass Article < MyEngine::Article\n  default_scope { where(:draft, false) }\nend\n```\n\n\u3068\u3084\u3063\u305f\u3068\u304d\u3001 User.first.articles \u306f MyEngine::Article \u3092\u53c2\u7167\u3059\u308b\u3088\u3046\u3060\u3002\n\u3088\u3063\u3066Article\u3067\u8a2d\u5b9a\u3057\u305fdefault_scope\u306f\u52b9\u304b\u306a\u3044\u3002\nEngine\u306emodel\u3092\u62e1\u5f35\u3057\u3066\u4f7f\u3044\u305f\u3044\u3068\u304d\u306f\u3069\u3046\u3059\u308c\u3070\u3044\u3044\u306e\u3060\u308d\u3046\u304b?\n\n- \u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u3092\u4f5c\u308b\n    - relation\u3092\u5b9a\u7fa9\u3057\u76f4\u3059? \u3081\u3093\u3069\u3044\n    - factory\u3082\u5b9a\u7fa9\u3057\u306a\u304a\u3057\u306b\u306a\u308b?\n- MyEngine::User \u3092\u62e1\u5f35\u3059\u308b?\n    - \u305d\u306e\u5834\u5408\u3069\u3053\u306b\u66f8\u304f? initializer\u304c\u592a\u308b\n    - \u305d\u3082\u305d\u3082MyEngine::User\u306fEngine\u306e\u4e2d\u306e\u30b3\u30fc\u30c9\u3057\u304b\u898b\u306b\u884c\u304b\u306a\u3044\n    - MyEngine::User \u304c\u30ed\u30fc\u30c9\u3055\u308c\u305f\u3089\u62e1\u5f35\u306e\u30b3\u30fc\u30c9\u304c\u8d70\u308b\u3088\u3046\u306binitializer\u3067\u304c\u3093\u3070\u308b?\n- \u305d\u3082\u305d\u3082Engine\u306e\u30e2\u30c7\u30eb\u3092\u62e1\u5f35\u306a\u3093\u3066\u8003\u3048\u3066\u306f\u3044\u3051\u306a\u3044\n- factory\u306f\u3069\u3046\u3059\u308b?\n    - factory\u306e\u518d\u5b9a\u7fa9\u3067\u304d\u306a\u3044\u306e\u8f9b\u3044\n\n", "tags": ["Rails4", "ActiveRecord", "Ruby"]}