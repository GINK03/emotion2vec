{"tags": ["beats", "Kafka", "Linux", "influxdb", "fluentd"], "context": "\n\n\u306f\u3058\u3081\u306b\n\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\u306e\u3053\u3068\u3092\u8a66\u3057\u3066\u307f\u305f\u3002\nInfluxDB\u306f\u3001\u30c7\u30fc\u30bf\u6295\u5165\u6642\u306bInfluxDB Line Protocol\u304b\u3001\u3082\u3057\u304f\u306f\u30cd\u30b9\u30c8\u3055\u308c\u3066\u3044\u306a\u3044Json\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3002\u3057\u304b\u3057\u3001Metricbeat\u3067\u51fa\u529b\u3055\u308c\u308b\u30c7\u30fc\u30bf\u306f\u30cd\u30b9\u30c8\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001Fluentd\u3092\u4f7f\u3063\u3066\u30cd\u30b9\u30c8\u3055\u308c\u3066\u306a\u3044Json\u5f62\u5f0f\u306b\u6574\u5f62\u3057\u3066InfluxDB\u306b\u5165\u308c\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3092\u3084\u3063\u3066\u307f\u305f\u3002\nMetricbeat\u306fv5.0.0\u3092\u3001InfluxDB\u306fv1.0.0\u3092\u4f7f\u3063\u305f\u3002\n\n\u5bfe\u8c61\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\nmetricbeat.yml\u5185\u306e\u3001cpu\u3001load\u3001diskio\u3001filesystem\u3001memory\u3001network\u306e\u9805\u76ee\u3092\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3068\u3057\u3066\u4f7f\u3063\u3066\u307f\u305f\u3002\n\n/etc/metricbeat/metricbeat.yml\n#------------------------------- System Module -------------------------------\n- module: system\n  metricsets:\n    # CPU stats\n    - cpu\n\n    # System Load stats\n    - load\n\n    # Per CPU core stats\n    #- core\n\n    # IO stats\n    - diskio\n\n    # Per filesystem stats\n    - filesystem\n\n    # File system summary stats\n    #- fsstat\n\n    # Memory stats\n    - memory\n\n    # Network stats\n    - network\n\n    # Per process stats\n    #- process\n\n\n\u51fa\u529b\u3055\u308c\u308b\u30c7\u30fc\u30bf\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306aJson\u306e\u5f62\u5f0f\u3067\u51fa\u529b\u3055\u308c\u308b\u3002\u3053\u306eJson\u306f\u3001load\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4f8b\u3067\u3042\u308b\u3002\n{\n    \"@timestamp\": \"2016-05-23T08:05:34.853Z\",\n    \"beat\": {\n        \"hostname\": \"host.example.com\",\n        \"name\": \"host.example.com\"\n    },\n    \"metricset\": {\n        \"host\": \"localhost\",\n        \"module\": \"system\",\n        \"name\": \"load\",\n        \"rtt\": 115\n    },\n    \"system\": {\n        \"load\": {\n            \"1\": 1.09,\n            \"15\": 0.49,\n            \"5\": 0.65,\n            \"norm\": {\n                \"1\": 0.545,\n                \"15\": 0.245,\n                \"5\": 0.325\n            }\n        }\n    },\n    \"type\": \"metricsets\"\n}\n\n\u51fa\u5178: https://www.elastic.co/guide/en/beats/metricbeat/master/metricbeat-metricset-system-load.html\n\n\u30c7\u30fc\u30bf\u306e\u4e2d\u7d99\nMetricbeat\u306e\u30c7\u30fc\u30bf\u306f\u3001\u4e00\u65e6Kafka\u306b\u8ee2\u9001\u3059\u308b\u3002Fluentd\u3092Kafka Consumer\u3068\u3057\u3066\u5229\u7528\u3059\u308b\u3002Fluentd\u3067\u3001\u30c7\u30fc\u30bf\u3092Consume\u3057\u3064\u3064\u3001\u6574\u5f62\u3057\u3066\u3001InfluxDB\u306b\u7a81\u3063\u8fbc\u3080\u3002\n\u4eca\u56de\u4f7f\u3063\u305fKafka\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u3001v0.10.0\u3067\u3042\u308b\u3002\u3088\u3063\u3066\u3001metricbeat.yml\u5185\u3067\u306f\u3001\u4f7f\u7528\u3057\u3066\u3044\u308bKafka\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8a18\u8f09\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n/etc/metricbeat/metricbeat.yml\n  # Kafka version metricbeat is assumed to run against. Defaults to the oldest\n  # supported stable version (currently version 0.8.2.0)\n  version: 0.10.0\n\n\n\n\u30c7\u30fc\u30bf\u306e\u6574\u5f62\nFluentd\u306f\u3001Kafka\u304b\u3089\u306eConsume\u3068\u30c7\u30fc\u30bf\u306e\u6574\u5f62\u3001\u53ca\u3073InfluxDB\u3078\u306e\u8ee2\u9001\u306b\u4f7f\u3063\u305f\u3002Fluentd\u306econf\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u306b\u3059\u308b\u3002\n<source>\n  @type kafka_group\n  brokers kafkabroker001:9092,kafkabroker002:9092\n  consumer_group consumer_group_001\n  topics metrics-topic\n  format json\n</source>\n\n<match metrics-topic>\n  @type record_reformer\n  tag ${record['metricset']['name']}\n  enable_ruby true\n  auto_typecast true\n</match>\n\n<match cpu>\n  @type record_reformer\n  tag beat_cpu\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    user_pct          ${record['system']['cpu']['user']['pct'].to_f}\n    system_pct        ${record['system']['cpu']['system']['pct'].to_f}\n    nice_pct          ${record['system']['cpu']['nice']['pct'].to_f}\n    steal_pct         ${record['system']['cpu']['steal']['pct'].to_f}\n    idle_pct          ${record['system']['cpu']['idle']['pct'].to_f}\n    iowait_pct        ${record['system']['cpu']['iowait']['pct'].to_f}\n    irq_pct           ${record['system']['cpu']['irq']['pct'].to_f}\n    softirq_pct       ${record['system']['cpu']['softirq']['pct'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match memory>\n  @type record_reformer\n  tag beat_memory\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    actual_free       ${record['system']['memory']['actual']['free'].to_f}\n    actual_used_bytes ${record['system']['memory']['actual']['used']['bytes'].to_f}\n    actual_used_pct   ${record['system']['memory']['actual']['used']['pct'].to_f}\n    free              ${record['system']['memory']['free'].to_f}\n    swap_free         ${record['system']['memory']['swap']['free'].to_f}\n    swap_total        ${record['system']['memory']['swap']['total'].to_f}\n    swap_used_bytes   ${record['system']['memory']['swap']['used']['bytes'].to_f}\n    swap_used_pct     ${record['system']['memory']['swap']['used']['pct'].to_f}\n    total             ${record['system']['memory']['total'].to_f}\n    used_bytes        ${record['system']['memory']['used']['bytes'].to_f}\n    used_pct          ${record['system']['memory']['used']['pct'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match load>\n  @type record_reformer\n  tag beat_load\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    load_1            ${record['system']['load']['1'].to_f}\n    load_15           ${record['system']['load']['15'].to_f}\n    load_5            ${record['system']['load']['5'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match diskio>\n  @type record_reformer\n  tag beat_diskio\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    io_time           ${record['system']['diskio']['io']['time'].to_f}\n    name              ${record['system']['diskio']['name'].to_f}\n    read_bytes        ${record['system']['diskio']['read']['bytes'].to_f}\n    read_count        ${record['system']['diskio']['read']['count'].to_f}\n    read_time         ${record['system']['diskio']['read']['time'].to_f}\n    write_bytes       ${record['system']['diskio']['write']['bytes'].to_f}\n    write_count       ${record['system']['diskio']['write']['count'].to_f}\n    write_time        ${record['system']['diskio']['write']['time'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match filesystem>\n  @type record_reformer\n  tag beat_filesystem\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    available         ${record['system']['filesystem']['available'].to_f}\n    device_name       ${record['system']['filesystem']['device_name'].to_f}\n    files             ${record['system']['filesystem']['files'].to_f}\n    free              ${record['system']['filesystem']['free'].to_f}\n    free_files        ${record['system']['filesystem']['free_files'].to_f}\n    mount_point       ${record['system']['filesystem']['mount_point'].to_f}\n    total             ${record['system']['filesystem']['total'].to_f}\n    used_bytes        ${record['system']['filesystem']['used']['bytes'].to_f}\n    used_pct          ${record['system']['filesystem']['used']['pct'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match network>\n  @type record_reformer\n  tag beat_network\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    name              ${record['system']['network']['name'].to_f}\n    in_bytes          ${record['system']['network']['in']['bytes'].to_f}\n    in_dropped        ${record['system']['network']['in']['dropped'].to_f}\n    in_errors         ${record['system']['network']['in']['errors'].to_f}\n    in_packets        ${record['system']['network']['in']['packets'].to_f}\n    out_bytes         ${record['system']['network']['out']['bytes'].to_f}\n    out_dropped       ${record['system']['network']['out']['dropped'].to_f}\n    out_errors        ${record['system']['network']['out']['errors'].to_f}\n    out_packets       ${record['system']['network']['out']['packets'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match beat_cpu beat_memory beat_load beat_diskio beat_filesystem beat_network>\n  @type influxdb\n  host influxdb001\n  port 8086\n  dbname metrics_db\n  user kafka\n  password kafka\n  use_ssl false\n  verify_ssl false\n  tag_keys [\"host\"]\n  time_precision s\n  flush_interval 10s\n</match>\n\n\u3061\u3087\u3063\u3068\u30cf\u30de\u3063\u305f\u70b9\u3068\u3057\u3066\u306f\u3001record_reformer\u306e\u4e2d\u3067tag\u540d\u3092\u4ed8\u3051\u66ff\u3048\u3066\u3042\u3052\u306a\u3044\u3068Fluentd\u304c\u7121\u9650\u30eb\u30fc\u30d7\u306b\u9665\u308b\u3001\u3068\u3044\u3046\u70b9\u3067\u3042\u308b\u3002\n\n\u30c0\u30e1\u306a\u4f8b\n<match cpu>\n  @type record_reformer\n  tag cpu\n\n\n\ntag\u4ed8\u3051\u66ff\u3048\n<match cpu>\n  @type record_reformer\n  tag beat_cpu\n\n\nInfluxDB\u306b\u306f\u3001beat_XXX\u3068\u3044\u3046\u540d\u524d\u3067Measurement\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\n\n\u304a\u308f\u308a\u306b\nMetricbeat v5\u304c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u305f\u306e\u3067\u3001\u3075\u3068\u601d\u3044\u7acb\u3063\u3066\u3084\u3063\u3066\u307f\u305f\u6b21\u7b2c\u3067\u3042\u308b\u3002\u305d\u308c\u306b\u3057\u3066\u3082\u3001\u30cd\u30b9\u30c8\u3055\u308c\u305fJson\u3092\u6574\u5f62\u3059\u308b\u3082\u3063\u3068\u3044\u3044\u65b9\u6cd5\u306f\u306a\u3044\u3082\u306e\u3060\u308d\u3046\u304b...\n# \u306f\u3058\u3081\u306b\n\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\u306e\u3053\u3068\u3092\u8a66\u3057\u3066\u307f\u305f\u3002\n\nInfluxDB\u306f\u3001\u30c7\u30fc\u30bf\u6295\u5165\u6642\u306bInfluxDB Line Protocol\u304b\u3001\u3082\u3057\u304f\u306f\u30cd\u30b9\u30c8\u3055\u308c\u3066\u3044\u306a\u3044Json\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3002\u3057\u304b\u3057\u3001Metricbeat\u3067\u51fa\u529b\u3055\u308c\u308b\u30c7\u30fc\u30bf\u306f\u30cd\u30b9\u30c8\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001Fluentd\u3092\u4f7f\u3063\u3066\u30cd\u30b9\u30c8\u3055\u308c\u3066\u306a\u3044Json\u5f62\u5f0f\u306b\u6574\u5f62\u3057\u3066InfluxDB\u306b\u5165\u308c\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3092\u3084\u3063\u3066\u307f\u305f\u3002\n\nMetricbeat\u306fv5.0.0\u3092\u3001InfluxDB\u306fv1.0.0\u3092\u4f7f\u3063\u305f\u3002\n\n# \u5bfe\u8c61\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\n`metricbeat.yml`\u5185\u306e\u3001cpu\u3001load\u3001diskio\u3001filesystem\u3001memory\u3001network\u306e\u9805\u76ee\u3092\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3068\u3057\u3066\u4f7f\u3063\u3066\u307f\u305f\u3002\n\n```yaml:/etc/metricbeat/metricbeat.yml\n#------------------------------- System Module -------------------------------\n- module: system\n  metricsets:\n    # CPU stats\n    - cpu\n\n    # System Load stats\n    - load\n\n    # Per CPU core stats\n    #- core\n\n    # IO stats\n    - diskio\n\n    # Per filesystem stats\n    - filesystem\n\n    # File system summary stats\n    #- fsstat\n\n    # Memory stats\n    - memory\n\n    # Network stats\n    - network\n\n    # Per process stats\n    #- process\n```\n\n\u51fa\u529b\u3055\u308c\u308b\u30c7\u30fc\u30bf\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306aJson\u306e\u5f62\u5f0f\u3067\u51fa\u529b\u3055\u308c\u308b\u3002\u3053\u306eJson\u306f\u3001load\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4f8b\u3067\u3042\u308b\u3002\n\n```json\n{\n    \"@timestamp\": \"2016-05-23T08:05:34.853Z\",\n    \"beat\": {\n        \"hostname\": \"host.example.com\",\n        \"name\": \"host.example.com\"\n    },\n    \"metricset\": {\n        \"host\": \"localhost\",\n        \"module\": \"system\",\n        \"name\": \"load\",\n        \"rtt\": 115\n    },\n    \"system\": {\n        \"load\": {\n            \"1\": 1.09,\n            \"15\": 0.49,\n            \"5\": 0.65,\n            \"norm\": {\n                \"1\": 0.545,\n                \"15\": 0.245,\n                \"5\": 0.325\n            }\n        }\n    },\n    \"type\": \"metricsets\"\n}\n```\n\n\u51fa\u5178: https://www.elastic.co/guide/en/beats/metricbeat/master/metricbeat-metricset-system-load.html\n\n\n# \u30c7\u30fc\u30bf\u306e\u4e2d\u7d99\nMetricbeat\u306e\u30c7\u30fc\u30bf\u306f\u3001\u4e00\u65e6Kafka\u306b\u8ee2\u9001\u3059\u308b\u3002Fluentd\u3092Kafka Consumer\u3068\u3057\u3066\u5229\u7528\u3059\u308b\u3002Fluentd\u3067\u3001\u30c7\u30fc\u30bf\u3092Consume\u3057\u3064\u3064\u3001\u6574\u5f62\u3057\u3066\u3001InfluxDB\u306b\u7a81\u3063\u8fbc\u3080\u3002\n\n\u4eca\u56de\u4f7f\u3063\u305fKafka\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u3001v0.10.0\u3067\u3042\u308b\u3002\u3088\u3063\u3066\u3001`metricbeat.yml`\u5185\u3067\u306f\u3001\u4f7f\u7528\u3057\u3066\u3044\u308bKafka\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8a18\u8f09\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n```yaml:/etc/metricbeat/metricbeat.yml\n  # Kafka version metricbeat is assumed to run against. Defaults to the oldest\n  # supported stable version (currently version 0.8.2.0)\n  version: 0.10.0\n```\n\n# \u30c7\u30fc\u30bf\u306e\u6574\u5f62\nFluentd\u306f\u3001Kafka\u304b\u3089\u306eConsume\u3068\u30c7\u30fc\u30bf\u306e\u6574\u5f62\u3001\u53ca\u3073InfluxDB\u3078\u306e\u8ee2\u9001\u306b\u4f7f\u3063\u305f\u3002Fluentd\u306econf\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u306b\u3059\u308b\u3002\n\n```apache\n<source>\n  @type kafka_group\n  brokers kafkabroker001:9092,kafkabroker002:9092\n  consumer_group consumer_group_001\n  topics metrics-topic\n  format json\n</source>\n\n<match metrics-topic>\n  @type record_reformer\n  tag ${record['metricset']['name']}\n  enable_ruby true\n  auto_typecast true\n</match>\n\n<match cpu>\n  @type record_reformer\n  tag beat_cpu\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    user_pct          ${record['system']['cpu']['user']['pct'].to_f}\n    system_pct        ${record['system']['cpu']['system']['pct'].to_f}\n    nice_pct          ${record['system']['cpu']['nice']['pct'].to_f}\n    steal_pct         ${record['system']['cpu']['steal']['pct'].to_f}\n    idle_pct          ${record['system']['cpu']['idle']['pct'].to_f}\n    iowait_pct        ${record['system']['cpu']['iowait']['pct'].to_f}\n    irq_pct           ${record['system']['cpu']['irq']['pct'].to_f}\n    softirq_pct       ${record['system']['cpu']['softirq']['pct'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match memory>\n  @type record_reformer\n  tag beat_memory\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    actual_free       ${record['system']['memory']['actual']['free'].to_f}\n    actual_used_bytes ${record['system']['memory']['actual']['used']['bytes'].to_f}\n    actual_used_pct   ${record['system']['memory']['actual']['used']['pct'].to_f}\n    free              ${record['system']['memory']['free'].to_f}\n    swap_free         ${record['system']['memory']['swap']['free'].to_f}\n    swap_total        ${record['system']['memory']['swap']['total'].to_f}\n    swap_used_bytes   ${record['system']['memory']['swap']['used']['bytes'].to_f}\n    swap_used_pct     ${record['system']['memory']['swap']['used']['pct'].to_f}\n    total             ${record['system']['memory']['total'].to_f}\n    used_bytes        ${record['system']['memory']['used']['bytes'].to_f}\n    used_pct          ${record['system']['memory']['used']['pct'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match load>\n  @type record_reformer\n  tag beat_load\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    load_1            ${record['system']['load']['1'].to_f}\n    load_15           ${record['system']['load']['15'].to_f}\n    load_5            ${record['system']['load']['5'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match diskio>\n  @type record_reformer\n  tag beat_diskio\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    io_time           ${record['system']['diskio']['io']['time'].to_f}\n    name              ${record['system']['diskio']['name'].to_f}\n    read_bytes        ${record['system']['diskio']['read']['bytes'].to_f}\n    read_count        ${record['system']['diskio']['read']['count'].to_f}\n    read_time         ${record['system']['diskio']['read']['time'].to_f}\n    write_bytes       ${record['system']['diskio']['write']['bytes'].to_f}\n    write_count       ${record['system']['diskio']['write']['count'].to_f}\n    write_time        ${record['system']['diskio']['write']['time'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match filesystem>\n  @type record_reformer\n  tag beat_filesystem\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    available         ${record['system']['filesystem']['available'].to_f}\n    device_name       ${record['system']['filesystem']['device_name'].to_f}\n    files             ${record['system']['filesystem']['files'].to_f}\n    free              ${record['system']['filesystem']['free'].to_f}\n    free_files        ${record['system']['filesystem']['free_files'].to_f}\n    mount_point       ${record['system']['filesystem']['mount_point'].to_f}\n    total             ${record['system']['filesystem']['total'].to_f}\n    used_bytes        ${record['system']['filesystem']['used']['bytes'].to_f}\n    used_pct          ${record['system']['filesystem']['used']['pct'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match network>\n  @type record_reformer\n  tag beat_network\n  enable_ruby true\n  auto_typecast true\n  renew_record true\n  <record>\n    host              ${record['beat']['hostname']}\n    name              ${record['system']['network']['name'].to_f}\n    in_bytes          ${record['system']['network']['in']['bytes'].to_f}\n    in_dropped        ${record['system']['network']['in']['dropped'].to_f}\n    in_errors         ${record['system']['network']['in']['errors'].to_f}\n    in_packets        ${record['system']['network']['in']['packets'].to_f}\n    out_bytes         ${record['system']['network']['out']['bytes'].to_f}\n    out_dropped       ${record['system']['network']['out']['dropped'].to_f}\n    out_errors        ${record['system']['network']['out']['errors'].to_f}\n    out_packets       ${record['system']['network']['out']['packets'].to_f}\n    time              ${Time.parse(record['@timestamp']).to_i}\n  </record>\n</match>\n\n<match beat_cpu beat_memory beat_load beat_diskio beat_filesystem beat_network>\n  @type influxdb\n  host influxdb001\n  port 8086\n  dbname metrics_db\n  user kafka\n  password kafka\n  use_ssl false\n  verify_ssl false\n  tag_keys [\"host\"]\n  time_precision s\n  flush_interval 10s\n</match>\n```\n\n\u3061\u3087\u3063\u3068\u30cf\u30de\u3063\u305f\u70b9\u3068\u3057\u3066\u306f\u3001record_reformer\u306e\u4e2d\u3067tag\u540d\u3092\u4ed8\u3051\u66ff\u3048\u3066\u3042\u3052\u306a\u3044\u3068Fluentd\u304c\u7121\u9650\u30eb\u30fc\u30d7\u306b\u9665\u308b\u3001\u3068\u3044\u3046\u70b9\u3067\u3042\u308b\u3002\n\n```apache:\u30c0\u30e1\u306a\u4f8b\n<match cpu>\n  @type record_reformer\n  tag cpu\n```\n\n```apache:tag\u4ed8\u3051\u66ff\u3048\n<match cpu>\n  @type record_reformer\n  tag beat_cpu\n```\n\nInfluxDB\u306b\u306f\u3001beat_XXX\u3068\u3044\u3046\u540d\u524d\u3067Measurement\u304c\u4f5c\u6210\u3055\u308c\u308b\u3002\n\n# \u304a\u308f\u308a\u306b\nMetricbeat v5\u304c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u305f\u306e\u3067\u3001\u3075\u3068\u601d\u3044\u7acb\u3063\u3066\u3084\u3063\u3066\u307f\u305f\u6b21\u7b2c\u3067\u3042\u308b\u3002\u305d\u308c\u306b\u3057\u3066\u3082\u3001\u30cd\u30b9\u30c8\u3055\u308c\u305fJson\u3092\u6574\u5f62\u3059\u308b\u3082\u3063\u3068\u3044\u3044\u65b9\u6cd5\u306f\u306a\u3044\u3082\u306e\u3060\u308d\u3046\u304b...\n"}