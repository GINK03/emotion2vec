{"context": " More than 1 year has passed since last update.\n\n\u554f\u984c\nRxSwift \u3067\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u6271\u3063\u3066\u3044\u308b\u3068 UIAlertController \u3082\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u8fd4\u3057\u3066\u6b32\u3057\u3044\u3068\u601d\u3046\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u305f\u3068\u3048\u3070\u3001UITableViewCell \u3092\u524a\u9664\u3059\u308b\u30a4\u30d9\u30f3\u30c8\u304d\u3063\u304b\u3051\u3067 \u78ba\u8a8d\u306e\u305f\u3081\u306e ActionSheet \u3092\u8868\u793a\u3059\u308b\u3068\u304d\u3067\u3059\u3002\n\u30bb\u30eb\u306b\u5bfe\u3059\u308b\u5165\u529b\u306f Observable \u3067\u30a4\u30d9\u30f3\u30c8\u53d7\u3051\u53d6\u308a\u3067\u304d\u307e\u3059\u304c ActionSheet \u306b\u5bfe\u3059\u308b\u5165\u529b\u306f UIAlertController \u3060\u3068 Observable \u3067\u53d7\u3051\u53d6\u308a\u3067\u304d\u307e\u305b\u3093\u3002\n        tableView.rx_itemDeleted  //  \u30bb\u30eb\u524a\u9664\u306e\u30a4\u30d9\u30f3\u30c8\u3092 Observable \u3068\u3057\u3066\u53d7\u3051\u3068\u308b\n            .asObservable()\n            .subscribeNext { [unowned self] (indexPath) in\n                let alert = UIAlertController(title:\"Are you sure?\",\u3000message: \"\", preferredStyle: .ActionSheet)\n                let removeAction = UIAlertAction(title: \"Delete\", style: .Destructive) { [unowned self] _ in\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 // Delete \u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u305f\u3068\u304d\u306e\u51e6\u7406 ..\n                }\n                alert.addAction(removeAction)\n                presentViewController(alert, animated: true, completion: nil)  // ActionSheet \u3092\u8868\u793a\n        }.addDisposableTo(disposeBag)\n\n\u3053\u3053\u3067\u3001Delete \u30dc\u30bf\u30f3\u62bc\u4e0b\u306e\u30a4\u30d9\u30f3\u30c8\u3092 Observable \u3068\u3057\u3066\u53d7\u3051\u53d6\u3063\u3066 rx_itemDeleted \u306e Observable \u3068 flatMap \u3057\u305f\u5f62\u3067\u51e6\u7406\u3092\u8a18\u8ff0\u3057\u305f\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n\u89e3\u6c7a\u65b9\u6cd5\nActionSheet \u306b\u5bfe\u3059\u308b\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u53d7\u3051\u53d6\u308b\u65b9\u6cd5\u306f RxSwift/RxExample \u306e\u30b3\u30fc\u30c9\u306e\u306a\u304b\u306b\u3042\u308a\u307e\u3057\u305f\u3002\n\nfunc promptFor<Action : CustomStringConvertible>(message: String, cancelAction: Action, actions: [Action]) -> Observable<Action> {\n\nhttps://github.com/ReactiveX/RxSwift/blob/1c47f0a79231f889a6c954023d857a3b5344ac88/RxExample/RxExample/Services/Wireframe.swift#L58\n\n\u3053\u308c\u3092 UIViewController \u306e extension \u306b\u5b9f\u88c5\u3057\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066 \u6700\u521d\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092 flatMap \u3067\u66f8\u304d\u76f4\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059: \n        tableView.rx_itemDeleted\n            .asObservable()\n            .flatMap { [unowned self] (indexPath) -> Observable<(Action, NSIndexPath)> in\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000// promptFor \u306f ActionSheet \u3092\u8868\u793a\u3057\u30fb\u5165\u529b\u3092 Observable \u3067\u8fd4\u3059\n                return self.promptFor(UIAlertController(title: \"Are you sure?\",\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 message: \"\",\u3000preferredStyle: .ActionSheet), // ActionSheet \u306b\u306f ..\n                        cancelAction: Action.Cancel(\"Cancel\"),       // \u30ad\u30e3\u30f3\u30bb\u30eb\u30dc\u30bf\u30f3\u3068 ..\n                        actions: [Action.Confirm(\"OK\")])             // OK \u30dc\u30bf\u30f3 \u3092\u914d\u7f6e\n                    .asObservable()\n                    .flatMap { Observable.just(($0, indexPath)) }\n            } \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000// flatMap \u3067\u5225\u306e Observable \u3078\u3068\u5909\u63db \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000.flatMap { [unowned self] (action, index) -> Observable<Model> in\n                switch action {\n                case .Confirm:  // \u5165\u529b\u304c \"OK\" \u306e\u3068\u304d\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 // Delete \u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u305f\u3068\u304d\u306e\u51e6\u7406 ..\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 }\n            }.subscribeNext { _ in return }\n            .addDisposableTo(disposeBag)\n\nActionSheet \u3092\u8868\u793a\u3057\u30fb\u5165\u529b\u3092 Observable \u3067\u8fd4\u3059\u30e1\u30bd\u30c3\u30c9(promptFor)\u306e\u5b9f\u88c5\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059: \n    func promptFor<Action : CustomStringConvertible>(alert: UIAlertController,\n        cancelAction: Action, actions: [Action]) -> Observable<Action> {\n\n        return Observable.create { [unowned self] observer in\n\n            alert.addAction(UIAlertAction(title: cancelAction.description, style: .Cancel) { _ in\n                observer.on(.Next(cancelAction))\n            })\n\n            for action in actions {\n                alert.addAction(UIAlertAction(title: action.description, style: .Default) { _ in\n                    observer.on(.Next(action))\n                })\n            }\n\n            self.presentViewController(alert, animated: true, completion: nil)\n\n            return AnonymousDisposable {\n                alert.dismissViewControllerAnimated(false, completion: nil)\n            }\n        }\n    }\n\n\u306a\u304a\u3001ActionSheet \u306e\u5165\u529b\u7d50\u679c\u306f \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3068\u3057\u3066\u8a18\u8ff0\u3057\u305f\u304b\u3063\u305f\u306e\u3067  enum (Action ) \u3068\u3057\u3066\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059: \n    enum Action: CustomStringConvertible {\n        case Cancel(String)\n        case Confirm(String)\n        var description: String {\n            switch self {\n            case .Cancel(let title): return title\n            case .Confirm(let title): return title\n            }\n        }\n    }\n\n\n\u307e\u3068\u3081\nRxSwift \u3092\u4f7f\u3063\u3066 UIAlertController \u306b\u5bfe\u3059\u308b\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u8fd4\u3059\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nRxCocoa \u3067\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u6271\u3063\u3066\u3044\u308b\u5834\u5408\u3084 Observable \u3092\u8fd4\u3059 API \u3092\u307b\u304b\u306b\u3082\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u306f ActionSheet \u306e\u5165\u529b\u3082 Observable \u3068\u3057\u3066\u7d44\u307f\u5408\u308f\u305b\u3089\u308c\u308b\u306e\u3067 \u898b\u901a\u3057\u304c\u3088\u304f\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\u4e0a\u8a18\u306e promptFor(:cancelAction:actions) \u3068 \u30c6\u30ad\u30b9\u30c8\u30d5\u30a3\u30fc\u30eb\u30c9\u4ed8\u304d\u306e inputFor(:inputAction:cancelAction:) \u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092 gist \u306b\u7f6e\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\nkumapo/UIViewController+AlertPresentable.swift\nhttps://gist.github.com/kumapo/1e2803dcb122538d6bfb\n\n# \u554f\u984c\n\nRxSwift \u3067\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u6271\u3063\u3066\u3044\u308b\u3068 UIAlertController \u3082\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u8fd4\u3057\u3066\u6b32\u3057\u3044\u3068\u601d\u3046\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u305f\u3068\u3048\u3070\u3001UITableViewCell \u3092\u524a\u9664\u3059\u308b\u30a4\u30d9\u30f3\u30c8\u304d\u3063\u304b\u3051\u3067 \u78ba\u8a8d\u306e\u305f\u3081\u306e ActionSheet \u3092\u8868\u793a\u3059\u308b\u3068\u304d\u3067\u3059\u3002\n\u30bb\u30eb\u306b\u5bfe\u3059\u308b\u5165\u529b\u306f Observable \u3067\u30a4\u30d9\u30f3\u30c8\u53d7\u3051\u53d6\u308a\u3067\u304d\u307e\u3059\u304c ActionSheet \u306b\u5bfe\u3059\u308b\u5165\u529b\u306f UIAlertController \u3060\u3068 Observable \u3067\u53d7\u3051\u53d6\u308a\u3067\u304d\u307e\u305b\u3093\u3002\n\n```\n        tableView.rx_itemDeleted  //  \u30bb\u30eb\u524a\u9664\u306e\u30a4\u30d9\u30f3\u30c8\u3092 Observable \u3068\u3057\u3066\u53d7\u3051\u3068\u308b\n            .asObservable()\n            .subscribeNext { [unowned self] (indexPath) in\n\t\t\t    let alert = UIAlertController(title:\"Are you sure?\",\u3000message: \"\", preferredStyle: .ActionSheet)\n \t\t\t    let removeAction = UIAlertAction(title: \"Delete\", style: .Destructive) { [unowned self] _ in\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 // Delete \u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u305f\u3068\u304d\u306e\u51e6\u7406 ..\n\t\t\t    }\n \t\t       \talert.addAction(removeAction)\n \t\t       \tpresentViewController(alert, animated: true, completion: nil)  // ActionSheet \u3092\u8868\u793a\n        }.addDisposableTo(disposeBag)\n```\n\n\u3053\u3053\u3067\u3001Delete \u30dc\u30bf\u30f3\u62bc\u4e0b\u306e\u30a4\u30d9\u30f3\u30c8\u3092 Observable \u3068\u3057\u3066\u53d7\u3051\u53d6\u3063\u3066 rx_itemDeleted \u306e Observable \u3068 flatMap \u3057\u305f\u5f62\u3067\u51e6\u7406\u3092\u8a18\u8ff0\u3057\u305f\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n# \u89e3\u6c7a\u65b9\u6cd5\n\nActionSheet \u306b\u5bfe\u3059\u308b\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u53d7\u3051\u53d6\u308b\u65b9\u6cd5\u306f [RxSwift/RxExample](https://github.com/ReactiveX/RxSwift/tree/1c47f0a79231f889a6c954023d857a3b5344ac88/RxExample) \u306e\u30b3\u30fc\u30c9\u306e\u306a\u304b\u306b\u3042\u308a\u307e\u3057\u305f\u3002\n\n>     func promptFor<Action : CustomStringConvertible>(message: String, cancelAction: Action, actions: [Action]) -> Observable<Action> {\n> https://github.com/ReactiveX/RxSwift/blob/1c47f0a79231f889a6c954023d857a3b5344ac88/RxExample/RxExample/Services/Wireframe.swift#L58\n\n\u3053\u308c\u3092 UIViewController \u306e extension \u306b\u5b9f\u88c5\u3057\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066 \u6700\u521d\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092 flatMap \u3067\u66f8\u304d\u76f4\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059: \n\n```\n        tableView.rx_itemDeleted\n            .asObservable()\n            .flatMap { [unowned self] (indexPath) -> Observable<(Action, NSIndexPath)> in\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000// promptFor \u306f ActionSheet \u3092\u8868\u793a\u3057\u30fb\u5165\u529b\u3092 Observable \u3067\u8fd4\u3059\n                return self.promptFor(UIAlertController(title: \"Are you sure?\",\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 message: \"\",\u3000preferredStyle: .ActionSheet), // ActionSheet \u306b\u306f ..\n                        cancelAction: Action.Cancel(\"Cancel\"),       // \u30ad\u30e3\u30f3\u30bb\u30eb\u30dc\u30bf\u30f3\u3068 ..\n                        actions: [Action.Confirm(\"OK\")])             // OK \u30dc\u30bf\u30f3 \u3092\u914d\u7f6e\n                    .asObservable()\n                    .flatMap { Observable.just(($0, indexPath)) }\n            } \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000// flatMap \u3067\u5225\u306e Observable \u3078\u3068\u5909\u63db \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000.flatMap { [unowned self] (action, index) -> Observable<Model> in\n                switch action {\n                case .Confirm:  // \u5165\u529b\u304c \"OK\" \u306e\u3068\u304d\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 // Delete \u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3057\u305f\u3068\u304d\u306e\u51e6\u7406 ..\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 }\n            }.subscribeNext { _ in return }\n            .addDisposableTo(disposeBag)\n```\n\nActionSheet \u3092\u8868\u793a\u3057\u30fb\u5165\u529b\u3092 Observable \u3067\u8fd4\u3059\u30e1\u30bd\u30c3\u30c9(`promptFor`)\u306e\u5b9f\u88c5\u306f\u6b21\u306e\u3068\u304a\u308a\u3067\u3059: \n\n```\n    func promptFor<Action : CustomStringConvertible>(alert: UIAlertController,\n        cancelAction: Action, actions: [Action]) -> Observable<Action> {\n        \n        return Observable.create { [unowned self] observer in\n            \n            alert.addAction(UIAlertAction(title: cancelAction.description, style: .Cancel) { _ in\n                observer.on(.Next(cancelAction))\n            })\n            \n            for action in actions {\n                alert.addAction(UIAlertAction(title: action.description, style: .Default) { _ in\n                    observer.on(.Next(action))\n                })\n            }\n            \n            self.presentViewController(alert, animated: true, completion: nil)\n            \n            return AnonymousDisposable {\n                alert.dismissViewControllerAnimated(false, completion: nil)\n            }\n        }\n    }\n```\n\n\u306a\u304a\u3001ActionSheet \u306e\u5165\u529b\u7d50\u679c\u306f \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3068\u3057\u3066\u8a18\u8ff0\u3057\u305f\u304b\u3063\u305f\u306e\u3067  enum (`Action` ) \u3068\u3057\u3066\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059: \n\n```\n    enum Action: CustomStringConvertible {\n        case Cancel(String)\n        case Confirm(String)\n        var description: String {\n            switch self {\n            case .Cancel(let title): return title\n            case .Confirm(let title): return title\n            }\n        }\n    }\n```\n\n# \u307e\u3068\u3081\n\nRxSwift \u3092\u4f7f\u3063\u3066 UIAlertController \u306b\u5bfe\u3059\u308b\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u8fd4\u3059\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\nRxCocoa \u3067\u5165\u529b\u3092 Observable \u3068\u3057\u3066\u6271\u3063\u3066\u3044\u308b\u5834\u5408\u3084 Observable \u3092\u8fd4\u3059 API \u3092\u307b\u304b\u306b\u3082\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u306f ActionSheet \u306e\u5165\u529b\u3082 Observable \u3068\u3057\u3066\u7d44\u307f\u5408\u308f\u305b\u3089\u308c\u308b\u306e\u3067 \u898b\u901a\u3057\u304c\u3088\u304f\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n\u4e0a\u8a18\u306e `promptFor(:cancelAction:actions)` \u3068 \u30c6\u30ad\u30b9\u30c8\u30d5\u30a3\u30fc\u30eb\u30c9\u4ed8\u304d\u306e `inputFor(:inputAction:cancelAction:)` \u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092 gist \u306b\u7f6e\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n> kumapo/UIViewController+AlertPresentable.swift\n> https://gist.github.com/kumapo/1e2803dcb122538d6bfb\n", "tags": ["Swift", "RxSwift", "iOS"]}