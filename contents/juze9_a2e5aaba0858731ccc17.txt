{"context": "\n\n\u306f\u3058\u3081\u306b\nProxmox VE\u3067Gmail\u3092\u9001\u308d\u3046\u3068\u3057\u305f\u306e\u3067\u3059\u304c\u3001gmail notifications over ssl 587 port\u306e\u901a\u308a\u3067\u306fSASL\u3067\u5f15\u3063\u304b\u304b\u3063\u305f\u306e\u3067\u3001\u3046\u307e\u304f\u3044\u3063\u305f\u624b\u9806\u3092\u66f8\u304d\u6b8b\u3057\u307e\u3059\u3002\n\npostfix\u3001libsasl2-modules\u304a\u3088\u3073sasl2-bin\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\napt-get install -y postfix libsasl2-modules sasl2-bin\n\n\n/etc/postfix/main.cf\u3092\u66f8\u304d\u63db\u3048\nrelayhost = [smtp.gmail.com]:587 #\u30d5\u30a9\u30fc\u30e9\u30e0\u3067\u306f\u4f55\u3082\u66f8\u304b\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u3053\u3046\u3057\u3066\u3044\u307e\u3059\uff08\u6d88\u3059\u691c\u8a3c\u306f\u3057\u3066\u3044\u307e\u305b\u3093\uff09\u3002\n\n\n/etc/postfix/main.cf\u306b\u8ffd\u52a0\nsmtp_sender_dependent_authentication = yes\nsender_dependent_relayhost_maps = hash:/etc/postfix/sender_relayhost.hash\n\nsmtp_sasl_auth_enable = yes\nsmtp_sasl_password_maps = hash:/etc/postfix/sasl_auth.hash\nsmtp_sasl_security_options = noanonymous #\u30d5\u30a9\u30fc\u30e9\u30e0\u3067\u306fnoplaintext, noanonymous\u3067\u3059\u304c\u3001SASL\u3067\u5f15\u3063\u304b\u304b\u308a\u307e\u3057\u305f\u3002\n\nsmtp_use_tls = yes\nsmtp_tls_CAfile = /etc/ssl/certs/ca-certificates.crt\n\n\n/etc/postfix/sasl_auth.hash\u3092\u4f5c\u6210\nuser@gmail.com user@gmail.com:password\n\n#default\n[smtp.gmail.com]:587 user@gmail.com:password #\u30d5\u30a9\u30fc\u30e9\u30e0\u3067\u306f\u3053\u306e\u884c\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u3053\u3046\u3057\u3066\u3044\u307e\u3059\uff08\u6d88\u3059\u691c\u8a3c\u306f\u3057\u3066\u3044\u307e\u305b\u3093\uff09\u3002\n\n\n/etc/postfix/sender_relayhost.hash\u3092\u4f5c\u6210\nuser@gmail.com [smtp.gmail.com]:587\n\n\n\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u8a2d\u5b9a\u30fb\u8a2d\u5b9a\u53cd\u6620\npostmap /etc/postfix/sasl_auth.hash\npostmap /etc/postfix/sender_relayhost.hash\n\nchmod u=rw,g=,o= /etc/postfix/sasl_auth.hash\nchmod u=rw,g=,o= /etc/postfix/sasl_auth.hash.db\n\npostfix reload\n\n\n\u30c6\u30b9\u30c8\ndate | mail -s test user@gmail.com\n\n\n\u30ed\u30b0\u306e\u78ba\u8a8d\ntail -n 10 /var/log/mail.log\n\n\n\u305d\u306e\u4ed6\nProxmox VE\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u8981\u6c42\u3055\u308c\u307e\u3059\u304c\u3001\u305d\u308c\u306fPAM\u3067root\u30e6\u30fc\u30b6\u30fc\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3068\u3057\u3066\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u305f\u3081root\u30e6\u30fc\u30b6\u30fc\u306b\u30e1\u30fc\u30eb\u3092\u9001\u308c\u3070\u305d\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u9001\u3089\u308c\u308b\u306f\u305a\u3067\u3059\u3002\ndate | mail -s test root@hostname.local\n\n\u304b\u3089\u304f\u308a\u3068\u3057\u3066\u306f/root/.forward\u306b/usr/bin/pvemailforward\u3092\u8aad\u3080\u3088\u3046\u306b\u66f8\u304b\u308c\u3066\u304a\u308a\u3001pvemailforward\u3067PAM\u3092\u8aad\u307f\u306b\u3044\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n#\u306f\u3058\u3081\u306b\nProxmox VE\u3067Gmail\u3092\u9001\u308d\u3046\u3068\u3057\u305f\u306e\u3067\u3059\u304c\u3001[gmail notifications over ssl 587 port](https://forum.proxmox.com/threads/gmail-notifications-over-ssl-587-port.26451/#post-132769)\u306e\u901a\u308a\u3067\u306fSASL\u3067\u5f15\u3063\u304b\u304b\u3063\u305f\u306e\u3067\u3001\u3046\u307e\u304f\u3044\u3063\u305f\u624b\u9806\u3092\u66f8\u304d\u6b8b\u3057\u307e\u3059\u3002\n\n#postfix\u3001libsasl2-modules\u304a\u3088\u3073sasl2-bin\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\napt-get install -y postfix libsasl2-modules sasl2-bin\n```\n\n#/etc/postfix/main.cf\u3092\u66f8\u304d\u63db\u3048\n```\nrelayhost = [smtp.gmail.com]:587 #\u30d5\u30a9\u30fc\u30e9\u30e0\u3067\u306f\u4f55\u3082\u66f8\u304b\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u3053\u3046\u3057\u3066\u3044\u307e\u3059\uff08\u6d88\u3059\u691c\u8a3c\u306f\u3057\u3066\u3044\u307e\u305b\u3093\uff09\u3002\n```\n\n#/etc/postfix/main.cf\u306b\u8ffd\u52a0\n```\nsmtp_sender_dependent_authentication = yes\nsender_dependent_relayhost_maps = hash:/etc/postfix/sender_relayhost.hash\n\nsmtp_sasl_auth_enable = yes\nsmtp_sasl_password_maps = hash:/etc/postfix/sasl_auth.hash\nsmtp_sasl_security_options = noanonymous #\u30d5\u30a9\u30fc\u30e9\u30e0\u3067\u306fnoplaintext, noanonymous\u3067\u3059\u304c\u3001SASL\u3067\u5f15\u3063\u304b\u304b\u308a\u307e\u3057\u305f\u3002\n\nsmtp_use_tls = yes\nsmtp_tls_CAfile = /etc/ssl/certs/ca-certificates.crt\n```\n\n#/etc/postfix/sasl_auth.hash\u3092\u4f5c\u6210\n```\nuser@gmail.com user@gmail.com:password\n\n#default\n[smtp.gmail.com]:587 user@gmail.com:password #\u30d5\u30a9\u30fc\u30e9\u30e0\u3067\u306f\u3053\u306e\u884c\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u3053\u3046\u3057\u3066\u3044\u307e\u3059\uff08\u6d88\u3059\u691c\u8a3c\u306f\u3057\u3066\u3044\u307e\u305b\u3093\uff09\u3002\n```\n\n#/etc/postfix/sender_relayhost.hash\u3092\u4f5c\u6210\n```\nuser@gmail.com [smtp.gmail.com]:587\n```\n\n#\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u8a2d\u5b9a\u30fb\u8a2d\u5b9a\u53cd\u6620\n```\npostmap /etc/postfix/sasl_auth.hash\npostmap /etc/postfix/sender_relayhost.hash\n\nchmod u=rw,g=,o= /etc/postfix/sasl_auth.hash\nchmod u=rw,g=,o= /etc/postfix/sasl_auth.hash.db\n\npostfix reload\n```\n\n#\u30c6\u30b9\u30c8\n```\ndate | mail -s test user@gmail.com\n```\n\n#\u30ed\u30b0\u306e\u78ba\u8a8d\n```\ntail -n 10 /var/log/mail.log\n```\n\n#\u305d\u306e\u4ed6\nProxmox VE\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u8981\u6c42\u3055\u308c\u307e\u3059\u304c\u3001\u305d\u308c\u306fPAM\u3067root\u30e6\u30fc\u30b6\u30fc\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3068\u3057\u3066\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u305f\u3081root\u30e6\u30fc\u30b6\u30fc\u306b\u30e1\u30fc\u30eb\u3092\u9001\u308c\u3070\u305d\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u9001\u3089\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\n```\ndate | mail -s test root@hostname.local\n```\n\u304b\u3089\u304f\u308a\u3068\u3057\u3066\u306f/root/.forward\u306b/usr/bin/pvemailforward\u3092\u8aad\u3080\u3088\u3046\u306b\u66f8\u304b\u308c\u3066\u304a\u308a\u3001pvemailforward\u3067PAM\u3092\u8aad\u307f\u306b\u3044\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n", "tags": ["proxmox"]}