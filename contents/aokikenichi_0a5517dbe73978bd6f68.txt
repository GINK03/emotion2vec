{"context": "\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\n\n\u306e\u7ae0\u672b\u554f\u984c\u3067\u300c\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3092\u7528\u3044\u3066\u300d\u3068\u3042\u308b\u3082\u306e\u3092R\u3067\u89e3\u3044\u3066\u3044\u307e\u3059\u3002\n* \u30b5\u30dd\u30fc\u30c8\u30b5\u30a4\u30c8\uff08\u30c7\u30fc\u30bf\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\uff09\n\n1.3\nwn<-function(m, s) {\n  df<-rnorm(100, mean = m, sd = sqrt(s))\n  plot(df, type = 'l', main = sprintf('\u03bc=%d, \u03c3=%d', m, s))\n  abline(h = as.integer(min(df)):as.integer(max(df)), col = 'gray', lty = 2)\n}\n\nset.seed(1)\npar(mfrow = c(3, 2))\npar(mar = c(2, 2, 2, 0.5))\nwn(0, 1)\nwn(2, 1)\nwn(-2, 1)\nwn(0, 2)\nwn(0, 3)\nwn(2, 2)\n\n\n\n1.5\ndata<-read.table(\"economicdata.txt\", header=T)\ndata.ts<-ts(data[,2:7],start=c(1975,1),frequency=12)\n\n\n(1)\n\npar(mfrow=c(3,2))\npar(mar = c(2, 3, 2, 0.5))\nts.plot(data.ts[,1], xlab=\"\", ylab=\"\", ylim=c(0,3500), main=\"TOPIX\")\nts.plot(data.ts[,2], xlab=\"\", ylab=\"\", ylim=c(0,120), main=\"\u5b9f\u52b9\u70ba\u66ff\u30ec\u30fc\u30c8\")\nts.plot(data.ts[,3], xlab=\"\", ylab=\"\", ylim=c(0,120), main=\"\u9271\u5de5\u696d\u751f\u7523\u6307\u6570\")\nts.plot(data.ts[,4], xlab=\"\", ylab=\"\", ylim=c(0,120), main=\"CPI\")\nts.plot(data.ts[,5], xlab=\"\", ylab=\"\", ylim=c(0,6), main=\"\u5931\u696d\u7387\")\nts.plot(data.ts[,6], xlab=\"\", ylab=\"\", ylim=c(0,14), main=\"\u30b3\u30fc\u30eb\u30ec\u30fc\u30c8\")\n\n\n\n(2)(3)\npar(mfrow=c(3,1))\ntopix.d<-diff(log(data$topix))\ntopix.d.ts<-ts(topix.d*100,start=c(1975,1),frequency=12)\nts.plot(topix.d.ts, ylim=c(-20,15), main=\"TOPIX\")\nabline(h=seq(-20,15,5), col=\"gray\", lty=2)\nexrate.d<-diff(log(data$exrate))\nexrate.d.ts<-ts(exrate.d*100,start=c(1975,1),frequency=12)\nts.plot(exrate.d.ts, ylim=c(-8,12), main=\"\u5b9f\u52b9\u70ba\u66ff\u30ec\u30fc\u30c8\")\nabline(h=seq(-8,12,2), col=\"gray\", lty=2)\nindprod.d<-diff(log(data$indprod))\nindprod.d.ts<-ts(indprod.d*100,start=c(1975,1),frequency=12)\nts.plot(indprod.d.ts, ylim=c(-5,5), main=\"\u9271\u5de5\u696d\u751f\u7523\u6307\u6570\")\nabline(h=-5:5, col=\"gray\", lty=2)\n\n\n\n(4)\npar(mfrow=c(1,1))\npar(mar = c(3, 3, 3, 3))\nacf(diff(log(data$indprod)), xlim=c(1,20), ylim=c(-0.5,0.5))\nlag=seq(1,10)\nbox.t<-apply(as.matrix(lag),1,function(x) {tmp=Box.test(diff(log(data$indprod)),type=\"Ljung\", lag=x); return(c(tmp$statistic, tmp$p.value))})\nout<-data.frame(matrix(box.t[1,], nrow=1))\nout<-rbind(out, box.t[2,])\ncolnames(out)<-lag\nrownames(out)<-c('Q(m)', 'P')\nout\n\n\n                1            2            3            4            5\nQ(m) 3.420025e+01 3.976335e+01 5.039731e+01 5.180377e+01 5.190793e+01\nP    4.972263e-09 2.320056e-09 6.574763e-11 1.516132e-10 5.634492e-10\n                6            7            8            9           10\nQ(m) 5.445974e+01 5.446017e+01 5.745610e+01 5.793698e+01 5.884316e+01\nP    5.958688e-10 1.907042e-09 1.466964e-09 3.342017e-09 5.995413e-09\n\n\n(5)\ncf(diff(log(data$topix)), xlim=c(1,20), ylim=c(-0.5,0.5))\nbox.t<-apply(as.matrix(lag),1,function(x) {tmp=Box.test(diff(log(data$topix)),type=\"Ljung\", lag=x); return(c(tmp$statistic, tmp$p.value))})\nout<-data.frame(matrix(box.t[1,], nrow=1))\nout<-rbind(out, box.t[2,])\ncolnames(out)<-lag\nrownames(out)<-c('Q(m)', 'P')\nout\n\n\n                1            2            3            4            5\nQ(m) 3.467592e+01 3.638552e+01 3.684399e+01 3.855135e+01 3.891405e+01\nP    3.894192e-09 1.255984e-08 4.964713e-08 8.622952e-08 2.471338e-07\n                6            7            8            9           10\nQ(m) 3.987178e+01 3.996513e+01 4.019884e+01 4.442465e+01 4.596921e+01\nP    4.827198e-07 1.278282e-06 2.941722e-06 1.178549e-06 1.452777e-06\n\n\u21d2 \u6b21\u306f \u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\u7ae0\u672b\u554f\u984c\u3092R\u3067\u89e3\u304f\uff0d\u7b2c2\u7ae0ARMA\u904e\u7a0b\uff0d \u3078\n<a href=\"https://www.amazon.co.jp/%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90-%E7%B5%B1%E8%A8%88%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%83%BC-%E6%B2%96%E6%9C%AC-%E7%AB%9C%E7%BE%A9/dp/4254127928/ref=as_li_ss_tl?ie=UTF8&qid=1478165293&sr=8-1&keywords=%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90&linkCode=ll1&tag=aokikenichi-22&linkId=b4fb2bc3209ec5a8b2d381d8955f2486\">\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f</a>\n<a href=\"https://www.amazon.co.jp/%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90-%E7%B5%B1%E8%A8%88%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%83%BC-%E6%B2%96%E6%9C%AC-%E7%AB%9C%E7%BE%A9/dp/4254127928/ref=as_li_ss_il?ie=UTF8&qid=1478165293&sr=8-1&keywords=%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90&linkCode=li2&tag=aokikenichi-22&linkId=53c071200e6bc21d9723dd3a5f926476\" target=\"_blank\"><img border=\"0\" src=\"//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4254127928&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=aokikenichi-22\" ></a><img src=\"https://ir-jp.amazon-adsystem.com/e/ir?t=aokikenichi-22&l=li2&o=9&a=4254127928\" width=\"1\" height=\"1\" border=\"0\" alt=\"\" style=\"border:none !important; margin:0px !important;\" />\n\u306e\u7ae0\u672b\u554f\u984c\u3067\u300c\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3092\u7528\u3044\u3066\u300d\u3068\u3042\u308b\u3082\u306e\u3092R\u3067\u89e3\u3044\u3066\u3044\u307e\u3059\u3002\n* [\u30b5\u30dd\u30fc\u30c8\u30b5\u30a4\u30c8\uff08\u30c7\u30fc\u30bf\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\uff09](http://www.geocities.jp/tatsuyoshi_okimoto/books/tsa.html)\n\n#1.3\n```r\nwn<-function(m, s) {\n  df<-rnorm(100, mean = m, sd = sqrt(s))\n  plot(df, type = 'l', main = sprintf('\u03bc=%d, \u03c3=%d', m, s))\n  abline(h = as.integer(min(df)):as.integer(max(df)), col = 'gray', lty = 2)\n}\n\nset.seed(1)\npar(mfrow = c(3, 2))\npar(mar = c(2, 2, 2, 0.5))\nwn(0, 1)\nwn(2, 1)\nwn(-2, 1)\nwn(0, 2)\nwn(0, 3)\nwn(2, 2)\n```\n![1_1.3.png](https://qiita-image-store.s3.amazonaws.com/0/116049/dcff4439-0b7c-982e-e31f-7706bfdd7240.png)\n\n#1.5\n```r\ndata<-read.table(\"economicdata.txt\", header=T)\ndata.ts<-ts(data[,2:7],start=c(1975,1),frequency=12)\n```\n\n* (1)\n\n```r\npar(mfrow=c(3,2))\npar(mar = c(2, 3, 2, 0.5))\nts.plot(data.ts[,1], xlab=\"\", ylab=\"\", ylim=c(0,3500), main=\"TOPIX\")\nts.plot(data.ts[,2], xlab=\"\", ylab=\"\", ylim=c(0,120), main=\"\u5b9f\u52b9\u70ba\u66ff\u30ec\u30fc\u30c8\")\nts.plot(data.ts[,3], xlab=\"\", ylab=\"\", ylim=c(0,120), main=\"\u9271\u5de5\u696d\u751f\u7523\u6307\u6570\")\nts.plot(data.ts[,4], xlab=\"\", ylab=\"\", ylim=c(0,120), main=\"CPI\")\nts.plot(data.ts[,5], xlab=\"\", ylab=\"\", ylim=c(0,6), main=\"\u5931\u696d\u7387\")\nts.plot(data.ts[,6], xlab=\"\", ylab=\"\", ylim=c(0,14), main=\"\u30b3\u30fc\u30eb\u30ec\u30fc\u30c8\")\n```\n![1_1.5.1.png](https://qiita-image-store.s3.amazonaws.com/0/116049/7abaf536-be01-ab0e-b77f-d22b207ead8c.png)\n\n##(2)(3)\n```r\npar(mfrow=c(3,1))\ntopix.d<-diff(log(data$topix))\ntopix.d.ts<-ts(topix.d*100,start=c(1975,1),frequency=12)\nts.plot(topix.d.ts, ylim=c(-20,15), main=\"TOPIX\")\nabline(h=seq(-20,15,5), col=\"gray\", lty=2)\nexrate.d<-diff(log(data$exrate))\nexrate.d.ts<-ts(exrate.d*100,start=c(1975,1),frequency=12)\nts.plot(exrate.d.ts, ylim=c(-8,12), main=\"\u5b9f\u52b9\u70ba\u66ff\u30ec\u30fc\u30c8\")\nabline(h=seq(-8,12,2), col=\"gray\", lty=2)\nindprod.d<-diff(log(data$indprod))\nindprod.d.ts<-ts(indprod.d*100,start=c(1975,1),frequency=12)\nts.plot(indprod.d.ts, ylim=c(-5,5), main=\"\u9271\u5de5\u696d\u751f\u7523\u6307\u6570\")\nabline(h=-5:5, col=\"gray\", lty=2)\n```\n![1_1.5.2_3.png](https://qiita-image-store.s3.amazonaws.com/0/116049/c1e84a69-263c-aee6-99a6-cff17a4c885f.png)\n\n#(4)\n```r\npar(mfrow=c(1,1))\npar(mar = c(3, 3, 3, 3))\nacf(diff(log(data$indprod)), xlim=c(1,20), ylim=c(-0.5,0.5))\nlag=seq(1,10)\nbox.t<-apply(as.matrix(lag),1,function(x) {tmp=Box.test(diff(log(data$indprod)),type=\"Ljung\", lag=x); return(c(tmp$statistic, tmp$p.value))})\nout<-data.frame(matrix(box.t[1,], nrow=1))\nout<-rbind(out, box.t[2,])\ncolnames(out)<-lag\nrownames(out)<-c('Q(m)', 'P')\nout\n```\n![1_1.5.4.png](https://qiita-image-store.s3.amazonaws.com/0/116049/cfdd49fd-4edf-d089-44ed-6713386f93a6.png)\n\n```r\n                1            2            3            4            5\nQ(m) 3.420025e+01 3.976335e+01 5.039731e+01 5.180377e+01 5.190793e+01\nP    4.972263e-09 2.320056e-09 6.574763e-11 1.516132e-10 5.634492e-10\n                6            7            8            9           10\nQ(m) 5.445974e+01 5.446017e+01 5.745610e+01 5.793698e+01 5.884316e+01\nP    5.958688e-10 1.907042e-09 1.466964e-09 3.342017e-09 5.995413e-09\n```\n\n#(5)\n```r\ncf(diff(log(data$topix)), xlim=c(1,20), ylim=c(-0.5,0.5))\nbox.t<-apply(as.matrix(lag),1,function(x) {tmp=Box.test(diff(log(data$topix)),type=\"Ljung\", lag=x); return(c(tmp$statistic, tmp$p.value))})\nout<-data.frame(matrix(box.t[1,], nrow=1))\nout<-rbind(out, box.t[2,])\ncolnames(out)<-lag\nrownames(out)<-c('Q(m)', 'P')\nout\n```\n![1_1.5.5.png](https://qiita-image-store.s3.amazonaws.com/0/116049/2cd75a0b-cf6c-d813-31a4-2a1ee1f9d373.png)\n\n```r\n                1            2            3            4            5\nQ(m) 3.467592e+01 3.638552e+01 3.684399e+01 3.855135e+01 3.891405e+01\nP    3.894192e-09 1.255984e-08 4.964713e-08 8.622952e-08 2.471338e-07\n                6            7            8            9           10\nQ(m) 3.987178e+01 3.996513e+01 4.019884e+01 4.442465e+01 4.596921e+01\nP    4.827198e-07 1.278282e-06 2.941722e-06 1.178549e-06 1.452777e-06\n```\n\n\u21d2 \u6b21\u306f [\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\u7ae0\u672b\u554f\u984c\u3092R\u3067\u89e3\u304f\uff0d\u7b2c2\u7ae0ARMA\u904e\u7a0b\uff0d](http://qiita.com/aokikenichi/items/2394b088c16fb1067d34) \u3078\n", "tags": ["\u6642\u7cfb\u5217\u89e3\u6790", "R"]}