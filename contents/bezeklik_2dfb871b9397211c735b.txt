{"tags": ["CentOS7", "tripwire2.4.3.1", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"], "context": "\n\nTripwire\n\u5546\u7528\u5316\u3055\u308c\u305f\u3068\u3044\u3046\u8a18\u8ff0\u304c\u591a\u3044\u304c\u3001\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u7248\u306f GPLv2+ \u30e9\u30a4\u30bb\u30f3\u30b9\u3067\u5229\u7528\u53ef\u80fd\u3002\n\nHIDS\nTripwire \u4ee5\u5916\u306e\u4e3b\u306a HIDS \u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n\nAFICK 3.5.2 (2016/08/05) - SourceForge \u306b rpm \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3042\u308b\u3002\n\nAIDE 0.16 (2016/07/25) - CentOS \u306e Base \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\nOSSEC 2.9_beta5 (2016/04/26) - inotify \u5bfe\u5fdc\u3002Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\nSamhain 4.2.0 (2016/10/13) - inotify \u5bfe\u5fdc\u3002\n\nTripwire 2.4.3.1 (2016/04/24)- EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nEPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306e\u8ffd\u52a0\nyum install epel-release\n\n\nTripwire\nyum install tripwire\n\n\nkey\ntripwire-setup-keyfiles\n\n\n\u521d\u671f\u5316\ntripwire --init\n\nWarning: File system error. \u304c\u51fa\u529b\u3055\u308c\u307e\u304f\u308b\u3002\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3088\u3046\u3060\u3002\n\n\u30c1\u30a7\u30c3\u30af\ntripwire --check\n\n\n\u51fa\u529b\u4f8b\nOpen Source Tripwire(R) 2.4.3.1 Integrity Check Report\n\nReport generated by:          root\nReport created on:            2016\u5e7408\u670827\u65e5 04\u664209\u520649\u79d2\nDatabase last updated on:     Never\n\n===============================================================================\nReport Summary:\n===============================================================================\n\nHost name:                    localhost.localdomain\nHost IP address:              127.0.0.1\nHost ID:                      None\nPolicy file used:             /etc/tripwire/tw.pol\nConfiguration file used:      /etc/tripwire/tw.cfg\nDatabase file used:           /var/lib/tripwire/localhost.localdomain.twd\nCommand line used:            tripwire --check\n\n===============================================================================\nRule Summary:\n===============================================================================\n\n-------------------------------------------------------------------------------\n  Section: Unix File System\n-------------------------------------------------------------------------------\n\n  Rule Name                       Severity Level    Added    Removed  Modified\n  ---------                       --------------    -----    -------  --------\n  User binaries                   66                0        0        0\n  Tripwire Binaries               100               0        0        0\n  Critical configuration files    100               0        0        0\n  Libraries                       66                0        0        0\n  Operating System Utilities      100               0        0        0\n  Critical system boot files      100               0        0        0\n  File System and Disk Administraton Programs\n                                  100               0        0        0\n  Kernel Administration Programs  100               0        0        0\n  Networking Programs             100               0        0        0\n  System Administration Programs  100               0        0        0\n  Hardware and Device Control Programs\n                                  100               0        0        0\n  System Information Programs     100               0        0        0\n  Application Information Programs\n                                  100               0        0        0\n  Shell Related Programs          100               0        0        0\n  Critical Utility Sym-Links      100               0        0        0\n  Shell Binaries                  100               0        0        0\n* Tripwire Data Files             100               1        0        0\n  System boot changes             100               0        0        0\n  OS executables and libraries    100               0        0        0\n  Security Control                100               0        0        0\n  Login Scripts                   100               0        0        0\n* Root config files               100               0        0        2\n  Invariant Directories           66                0        0        0\n  Temporary directories           33                0        0        0\n  Critical devices                100               0        0        0\n\nTotal objects scanned:  39112\nTotal violations found:  3\n\n===============================================================================\nObject Summary:\n===============================================================================\n\n-------------------------------------------------------------------------------\n# Section: Unix File System\n-------------------------------------------------------------------------------\n\n-------------------------------------------------------------------------------\nRule Name: Tripwire Data Files (/var/lib/tripwire)\nSeverity Level: 100\n-------------------------------------------------------------------------------\n\nAdded:\n\"/var/lib/tripwire/localhost.localdomain.twd\"\n\n-------------------------------------------------------------------------------\nRule Name: Root config files (/root)\nSeverity Level: 100\n-------------------------------------------------------------------------------\n\nModified:\n\"/root\"\n\"/root/.viminfo\"\n\n===============================================================================\nError Report:\n===============================================================================\n\n-------------------------------------------------------------------------------\n  Section: Unix File System\n-------------------------------------------------------------------------------\n\n1.   File system error.\n     Filename: /usr/sbin/fixrmtab\n(\u7701\u7565)\n163. File system error.\n     Filename: /proc/pci\n\n-------------------------------------------------------------------------------\n*** End of report ***\n\nOpen Source Tripwire 2.4 Portions copyright 2000 Tripwire, Inc. Tripwire is a registered\ntrademark of Tripwire, Inc. This software comes with ABSOLUTELY NO WARRANTY;\nfor details use --version. This is free software which may be redistributed\nor modified only under certain conditions; see COPYING for details.\nAll rights reserved.\nIntegrity check complete.\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\n/etc/tripwire/twcfg.txt\nROOT                   =/usr/sbin\nPOLFILE                =/etc/tripwire/tw.pol\nDBFILE                 =/var/lib/tripwire/$(HOSTNAME).twd\nREPORTFILE             =/var/lib/tripwire/report/$(HOSTNAME)-$(DATE).twr\nSITEKEYFILE            =/etc/tripwire/site.key\nLOCALKEYFILE           =/etc/tripwire/$(HOSTNAME)-local.key\nEDITOR                 =/bin/vi\nLATEPROMPTING          =false\nLOOSEDIRECTORYCHECKING =false\nMAILNOVIOLATIONS       =true\nEMAILREPORTLEVEL       =3\nREPORTLEVEL            =3\nMAILMETHOD             =SENDMAIL\nSYSLOGREPORTING        =false\nMAILPROGRAM            =/usr/sbin/sendmail -oi -t\n\n\n\n/etc/cron.daily/tripwire-check\n#!/bin/sh\nHOST_NAME=`uname -n`\nif [ ! -e /var/lib/tripwire/${HOST_NAME}.twd ] ; then\n        echo \"****    Error: Tripwire database for ${HOST_NAME} not found.    ****\"\n        echo \"**** Run \"/etc/tripwire/twinstall.sh\" and/or \"tripwire --init\". ****\"\nelse\n        test -f /etc/tripwire/tw.cfg &&  /usr/sbin/tripwire --check\nfi\n\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n\nPHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin\nDoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1\nLinux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV\nLinux Malware Detect\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Samhain\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Tripwire\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nessus\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto\nLinux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis\n\n# Tripwire\n\u5546\u7528\u5316\u3055\u308c\u305f\u3068\u3044\u3046\u8a18\u8ff0\u304c\u591a\u3044\u304c\u3001\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u7248\u306f GPLv2+ \u30e9\u30a4\u30bb\u30f3\u30b9\u3067\u5229\u7528\u53ef\u80fd\u3002\n\n# HIDS\nTripwire \u4ee5\u5916\u306e\u4e3b\u306a HIDS \u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n* [AFICK](http://qiita.com/bezeklik/items/298dafd2aeb053b4ca88) 3.5.2 (2016/08/05) - SourceForge \u306b rpm \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3042\u308b\u3002\n* [AIDE](http://qiita.com/bezeklik/items/d144d77a3e54cd35c06b) 0.16 (2016/07/25) - CentOS \u306e Base \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n* [OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38) 2.9_beta5 (2016/04/26) - inotify \u5bfe\u5fdc\u3002Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n* [Samhain](http://qiita.com/bezeklik/items/6b7fb75f1a37b0fc41a2) 4.2.0 (2016/10/13) - inotify \u5bfe\u5fdc\u3002\n* [Tripwire](http://qiita.com/bezeklik/items/2dfb871b9397211c735b) 2.4.3.1 (2016/04/24)- EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n## EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306e\u8ffd\u52a0\n```bash\nyum install epel-release\n```\n## Tripwire\n```bash\nyum install tripwire\n```\n\n## key\n```bash\ntripwire-setup-keyfiles\n```\n# \u521d\u671f\u5316\n```bash\ntripwire --init\n```\n`Warning: File system error.` \u304c\u51fa\u529b\u3055\u308c\u307e\u304f\u308b\u3002\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\u3057\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3088\u3046\u3060\u3002\n\n# \u30c1\u30a7\u30c3\u30af\n```bash\ntripwire --check\n```\n```text:\u51fa\u529b\u4f8b\nOpen Source Tripwire(R) 2.4.3.1 Integrity Check Report\n\nReport generated by:          root\nReport created on:            2016\u5e7408\u670827\u65e5 04\u664209\u520649\u79d2\nDatabase last updated on:     Never\n\n===============================================================================\nReport Summary:\n===============================================================================\n\nHost name:                    localhost.localdomain\nHost IP address:              127.0.0.1\nHost ID:                      None\nPolicy file used:             /etc/tripwire/tw.pol\nConfiguration file used:      /etc/tripwire/tw.cfg\nDatabase file used:           /var/lib/tripwire/localhost.localdomain.twd\nCommand line used:            tripwire --check\n\n===============================================================================\nRule Summary:\n===============================================================================\n\n-------------------------------------------------------------------------------\n  Section: Unix File System\n-------------------------------------------------------------------------------\n\n  Rule Name                       Severity Level    Added    Removed  Modified\n  ---------                       --------------    -----    -------  --------\n  User binaries                   66                0        0        0\n  Tripwire Binaries               100               0        0        0\n  Critical configuration files    100               0        0        0\n  Libraries                       66                0        0        0\n  Operating System Utilities      100               0        0        0\n  Critical system boot files      100               0        0        0\n  File System and Disk Administraton Programs\n                                  100               0        0        0\n  Kernel Administration Programs  100               0        0        0\n  Networking Programs             100               0        0        0\n  System Administration Programs  100               0        0        0\n  Hardware and Device Control Programs\n                                  100               0        0        0\n  System Information Programs     100               0        0        0\n  Application Information Programs\n                                  100               0        0        0\n  Shell Related Programs          100               0        0        0\n  Critical Utility Sym-Links      100               0        0        0\n  Shell Binaries                  100               0        0        0\n* Tripwire Data Files             100               1        0        0\n  System boot changes             100               0        0        0\n  OS executables and libraries    100               0        0        0\n  Security Control                100               0        0        0\n  Login Scripts                   100               0        0        0\n* Root config files               100               0        0        2\n  Invariant Directories           66                0        0        0\n  Temporary directories           33                0        0        0\n  Critical devices                100               0        0        0\n\nTotal objects scanned:  39112\nTotal violations found:  3\n\n===============================================================================\nObject Summary:\n===============================================================================\n\n-------------------------------------------------------------------------------\n# Section: Unix File System\n-------------------------------------------------------------------------------\n\n-------------------------------------------------------------------------------\nRule Name: Tripwire Data Files (/var/lib/tripwire)\nSeverity Level: 100\n-------------------------------------------------------------------------------\n\nAdded:\n\"/var/lib/tripwire/localhost.localdomain.twd\"\n\n-------------------------------------------------------------------------------\nRule Name: Root config files (/root)\nSeverity Level: 100\n-------------------------------------------------------------------------------\n\nModified:\n\"/root\"\n\"/root/.viminfo\"\n\n===============================================================================\nError Report:\n===============================================================================\n\n-------------------------------------------------------------------------------\n  Section: Unix File System\n-------------------------------------------------------------------------------\n\n1.   File system error.\n     Filename: /usr/sbin/fixrmtab\n(\u7701\u7565)\n163. File system error.\n     Filename: /proc/pci\n\n-------------------------------------------------------------------------------\n*** End of report ***\n\nOpen Source Tripwire 2.4 Portions copyright 2000 Tripwire, Inc. Tripwire is a registered\ntrademark of Tripwire, Inc. This software comes with ABSOLUTELY NO WARRANTY;\nfor details use --version. This is free software which may be redistributed\nor modified only under certain conditions; see COPYING for details.\nAll rights reserved.\nIntegrity check complete.\n```\n\n# \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n```ini:/etc/tripwire/twcfg.txt\nROOT                   =/usr/sbin\nPOLFILE                =/etc/tripwire/tw.pol\nDBFILE                 =/var/lib/tripwire/$(HOSTNAME).twd\nREPORTFILE             =/var/lib/tripwire/report/$(HOSTNAME)-$(DATE).twr\nSITEKEYFILE            =/etc/tripwire/site.key\nLOCALKEYFILE           =/etc/tripwire/$(HOSTNAME)-local.key\nEDITOR                 =/bin/vi\nLATEPROMPTING          =false\nLOOSEDIRECTORYCHECKING =false\nMAILNOVIOLATIONS       =true\nEMAILREPORTLEVEL       =3\nREPORTLEVEL            =3\nMAILMETHOD             =SENDMAIL\nSYSLOGREPORTING        =false\nMAILPROGRAM            =/usr/sbin/sendmail -oi -t\n```\n```bash:/etc/cron.daily/tripwire-check\n#!/bin/sh\nHOST_NAME=`uname -n`\nif [ ! -e /var/lib/tripwire/${HOST_NAME}.twd ] ; then\n        echo \"****    Error: Tripwire database for ${HOST_NAME} not found.    ****\"\n        echo \"**** Run \"/etc/tripwire/twinstall.sh\" and/or \"tripwire --init\". ****\"\nelse\n        test -f /etc/tripwire/tw.cfg &&  /usr/sbin/tripwire --check\nfi\n```\n\n# \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n* [PHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin](http://qiita.com/bezeklik/items/5e8b1f76465e39dc6cd0)\n* [DoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1](http://qiita.com/bezeklik/items/6d86a162e278f576e4ca)\n* [Linux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV](http://qiita.com/bezeklik/items/4696e15c889ffff6bc41)\n* [Linux Malware Detect](http://qiita.com/bezeklik/items/43a7d4fce6bc23fe84d3)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)](http://qiita.com/bezeklik/items/bc7affef8afe7c63f2ce)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit](http://qiita.com/bezeklik/items/7964ce67f1a1363b694e)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK](http://qiita.com/bezeklik/items/298dafd2aeb053b4ca88)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE](http://qiita.com/bezeklik/items/d144d77a3e54cd35c06b)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Samhain](http://qiita.com/bezeklik/items/6b7fb75f1a37b0fc41a2)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Tripwire](http://qiita.com/bezeklik/items/2dfb871b9397211c735b)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS](http://qiita.com/bezeklik/items/a64cad37eb03a1db2de4)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nessus](http://qiita.com/bezeklik/items/d6feb569fb5e4d639332)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto](http://qiita.com/bezeklik/items/12643654dc0c45f4eb29)\n* [Linux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis](http://qiita.com/bezeklik/items/cf9be2deb546c69123e7)\n"}