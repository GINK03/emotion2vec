{"tags": ["docker", "CentOS", "dockerfile"], "context": " More than 1 year has passed since last update.\n\n\u74b0\u5883\n\u305d\u306e1\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u65b9\u6cd5\u3001\u305d\u306e2\u3067\u30b3\u30f3\u30c6\u30ca\u304c\u3069\u3093\u306a\u72b6\u614b\u306b\u3042\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\n\u7d9a\u304f\u305d\u306e3\u3067\u306fregistry\u304b\u3089\u53d6\u5f97\u3057\u3066\u304d\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u3082\u3068\u306b\u81ea\u5206\u3060\u3051\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3092\u66f8\u304d\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u74b0\u5883\u3067Docker\u306e\u57fa\u672c\u64cd\u4f5c\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\n\n\u9805\u76ee\n\u4eca\u56de\u306e\u30b7\u30b9\u30c6\u30e0\n\n\n\n\nOS\nCentOS 7.0 (on VirtualBox)\n\n\nDocker\ndocker-1.3.2\n\n\n\n\nDockerfile\u304b\u3089\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u308b\n\u81ea\u5206\u3060\u3051\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u306b\u306fDockerfile\u3092\u7528\u3044\u308b\u306e\u304c\u7c21\u5358\u306a\u65b9\u6cd5\u3067\u3059\u3002\nDocker\u306b\u306fdocker build\u3068\u3044\u3046Dockerfile\u3092\u8aad\u307f\u8fbc\u3093\u3067\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u308b\u30b3\u30de\u30f3\u30c9\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e1\u3067\u306fbash\u3092\u8d77\u52d5\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u5185\u3067Ruby\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3001Web\u30b5\u30fc\u30d0\u3092\u7acb\u3066\u307e\u3057\u305f\u3002\n\u3053\u3053\u3067\u306f\u5177\u4f53\u4f8b\u3068\u3057\u3066\u305d\u308c\u3068\u540c\u3058\u3053\u3068\u3092Dockerfile\u3092\u4f7f\u3063\u3066\u5b9f\u73fe\u3057\u307e\u3059\u3002\n\nDockerfile\u4f5c\u6210\n# \"#\"\u3067\u59cb\u307e\u308b\u884c\u306f\u30b3\u30e1\u30f3\u30c8\u884c\u3068\u307f\u306a\u3055\u308c\u307e\u3059\u3002\n# Dockerfile\u306f\u5fc5\u305a\u30d9\u30fc\u30b9\u3068\u306a\u308b\u30a4\u30e1\u30fc\u30b8\u3092\u6307\u5b9a\u3059\u308bFROM\u304b\u3089\u66f8\u304d\u307e\u3059\u3002\nFROM ubuntu:14.04\n\n# MAINTAINER\u306b\u306f\u6587\u5b57\u901a\u308aDockerfile\u4f5c\u6210\u8005\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\nMAINTAINER smile-0yen smile0yen.1024@gmail.com\n\n# RUN\u306f\u6307\u5b9a\u3055\u308c\u305f\u30b3\u30de\u30f3\u30c9\u3092\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\nRUN apt-get install ruby -y\n\n# EXPOSE\u306f\u30b3\u30f3\u30c6\u30ca\u306e\u5916\u306b\u5bfe\u3057\u3066\u958b\u304f\u30dd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n# \u89aa\u30db\u30b9\u30c8\u306e\u3069\u306e\u30dd\u30fc\u30c8\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3059\u308b\u304b\u306f\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b\u6c7a\u5b9a\u3057\u307e\u3059\u3002\nEXPOSE 8080\n\n# WORKDIR\u306b\u3088\u3063\u3066\u3053\u306e\u884c\u4ee5\u964d\u306eRUN\u53ca\u3073CMD\u3092\u5b9f\u884c\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\nWORKDIR /opt\n\n# CMD\u306b\u306f\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3057\u305f\u3042\u3068\u306b\u5b9f\u884c\u3055\u308c\u308b\u30b3\u30de\u30f3\u30c9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nCMD ruby -run -e httpd . -p 8080\n\nDockerfile\u5185\u3067\u306e\u547d\u4ee4\u306f\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3(Instruction)\u3068\u547c\u3070\u308c\u307e\u3059\u3002\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u306a\u8a18\u8ff0\u304c\u7279\u5fb4\u3067\u3059\u3002\n\u5927\u6587\u5b57\u3067\u3042\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u53ef\u8aad\u6027\u306e\u305f\u3081\u306b\u5168\u3066\u5927\u6587\u5b57\u3067\u66f8\u304f\u3053\u3068\u304c\u63a8\u5968\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n\n\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\n\u8aac\u660e\n\n\n\n\nFROM <\u30a4\u30e1\u30fc\u30b8>:<\u30bf\u30b0>\n\u30d9\u30fc\u30b9\u3068\u306a\u308b\u30a4\u30e1\u30fc\u30b8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002Dockerfile\u306e\u5148\u982d\u306f\u5fc5\u305aFROM\u3067\u59cb\u3081\u307e\u3059\u3002\n\n\nMAINTAINER <\u540d\u524d>\n\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u8005\u3092\u660e\u793a\u3057\u307e\u3059\u3002\u6307\u5b9a\u3059\u308b\u3068\u30a4\u30e1\u30fc\u30b8\u5185\u306bAuthor\u60c5\u5831\u3068\u3057\u3066\u8a18\u9332\u3055\u308c\u307e\u3059\u3002\n\n\nRUN <\u30b3\u30de\u30f3\u30c9>\n\u4efb\u610f\u306e\u30b3\u30de\u30f3\u30c9\u3092/bin/sh -c\u306b\u6e21\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002/bin/sh\u304c\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306b\u306a\u3044\u5834\u5408\u306a\u3069exec\u5f62\u5f0f\u3067\uff08\uff0a\uff09\u3067\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\n\nCMD <\u30b3\u30de\u30f3\u30c9>\n\u30b3\u30de\u30f3\u30c9\u3092/bin/sh -c\u306b\u6e21\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002\u305f\u3060\u3057\u3001docker run\u3067\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3059\u308b\u969b\u306b\u5225\u306e\u30b3\u30de\u30f3\u30c9\u3092\u6e21\u3057\u305f\u3068\u304d\u306b\u306fCMD\u306f\u305d\u3061\u3089\u3067\u4e0a\u66f8\u304d\u3055\u308c\u308b\u305f\u3081\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002\u306a\u304a\u3001CMD\u306f1\u3064\u306bDockerfile\u306b\u3064\u304d1\u56de\u3057\u304b\u6307\u5b9a\u3067\u304d\u307e\u305b\u3093\u3002/bin/sh\u3092\u4f7f\u3044\u305f\u304f\u306a\u3044\u5834\u5408\u306fexec\u5f62\u5f0f\uff08\uff0a\uff09\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\nENTRYPOINT\u3000<\u30b3\u30de\u30f3\u30c9>\nCMD\u3068\u540c\u69d8\u306b\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b\u5b9f\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u3053\u3061\u3089\u306fdocker run\u3067\u6e21\u3055\u308c\u305f\u5225\u306e\u30b3\u30de\u30f3\u30c9\u3067\u4e0a\u66f8\u304d\u3055\u308c\u307e\u305b\u3093\u3002docker run\u3067\u6e21\u3055\u308c\u305f\u30b3\u30de\u30f3\u30c9\u306fENTRYPOINT\u3067\u6307\u5b9a\u3057\u305f\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u308d\u3078\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u3057\u3066\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002CMD\u3068ENTRYPOINT\u3092\u3069\u3061\u3089\u3082\u6307\u5b9a\u3057\u305f\u5834\u5408\u3001CMD\u306e\u5024\u306fENTRYPOINT\u3067\u6307\u5b9a\u3057\u305f\u30b3\u30de\u30f3\u30c9\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5f15\u6570\u3068\u89e3\u91c8\u3055\u308c\u307e\u3059\u3002/bin/sh\u3067\u8d77\u52d5\u3055\u308c\u305f\u304f\u306a\u3044\u5834\u5408exec\u5f62\u5f0f\uff08\uff0a\uff09\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\nEXPOSE <\u30dd\u30fc\u30c8\u756a\u53f7>\n\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b\u5185\u90e8\u3067LISTEN\u3059\u308b\u30dd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u89aa\u30db\u30b9\u30c8\u3078\u306e\u30dd\u30fc\u30c8\u30de\u30c3\u30d4\u30f3\u30b0\u306f\u8d77\u52d5\u6642\u306b\u5225\u9014\u6307\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002Dockerfile\u5185\u3067\u89aa\u306e\u30dd\u30fc\u30c8\u3092\u4e88\u3081\u6307\u5b9a\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\n\n\nENV <\u5909\u6570\u540d> <\u5024>\n\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\nWORKDIR <\u30c7\u30a3\u30ec\u30af\u30c8\u30ea>\n\nDockerfile\u5185\u3067RUN, CMD, ENTRYPOINT\u3088\u308a\u524d\u306b\u66f8\u304f\u3068\u305d\u308c\u3089\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305fENV\u306e\u3042\u3068\u306b\u66f8\u3051\u3070ENV\u3067\u8a2d\u5b9a\u3057\u305f\u74b0\u5883\u5909\u6570\u3092\u53c2\u7167\u3067\u304d\u307e\u3059\u3002\n\n\nUSER <\u30e6\u30fc\u30b6\u30fc>\n\nDockerfile\u5185\u3067RUN, CMD, ENTRYPOINT\u3088\u308a\u524d\u306b\u66f8\u304f\u3068\u305d\u308c\u3089\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\u30e6\u30fc\u30b6\u30fc\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\nVOLUME <\u30c7\u30a3\u30ec\u30af\u30c8\u30ea>\n\u3053\u306e\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3067\u30de\u30a6\u30f3\u30c8\u30dd\u30a4\u30f3\u30c8\u3092\u6307\u5b9a\u3057\u3066\u304a\u304f\u3068\u3001\u305d\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u89aa\u30db\u30b9\u30c8\u3084\u4ed6\u306e\u30b3\u30f3\u30c6\u30ca\u3068\u5171\u6709\u3067\u304d\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\nADD <\u30b3\u30d4\u30fc\u5143> <\u30b3\u30d4\u30fc\u5148>\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001\u30d5\u30a1\u30a4\u30eb\uff08\u8907\u6570\u53ef\uff09\u3092\u30b3\u30f3\u30c6\u30ca\u5185\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\u30b3\u30d4\u30fc\u5143\u306fdocker build\u5b9f\u884c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u306e\u76f8\u5bfe\u30d1\u30b9\uff08\u305f\u3060\u3057\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u4e0d\u53ef\uff09\u3001\u30b3\u30d4\u30fc\u5148\u306f\u30b3\u30f3\u30c6\u30ca\u5185\u306e\u7d76\u5bfe\u30d1\u30b9\u3067\u3059\u3002\u6307\u5b9a\u306b\u306f\u6b63\u898f\u8868\u73fe\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002\u6b21\u306eCOPY\u3068\u7570\u306a\u308a\u30b3\u30d4\u30fc\u5143\u306bURL\u3082\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u7279\u5b9a\u306e\u5f62\u5f0f(identity, gzip, bzip2, xz)\u3067\u5727\u7e2e\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u30b3\u30d4\u30fc\u5143\u306e\u5834\u5408\u306f\u89e3\u51cd\u3057\u3066\u304b\u3089\u30b3\u30f3\u30c6\u30ca\u5185\u306b\u8a2d\u7f6e\u3057\u307e\u3059\u3002\n\n\nCOPY <\u30b3\u30d4\u30fc\u5143> <\u30b3\u30d4\u30fc\u5148>\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001\u30d5\u30a1\u30a4\u30eb\uff08\u8907\u6570\u53ef\uff09\u3092\u30b3\u30f3\u30c6\u30ca\u5185\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\u30b3\u30d4\u30fc\u5143\u306fdocker build\u5b9f\u884c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u306e\u76f8\u5bfe\u30d1\u30b9\uff08\u305f\u3060\u3057\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u4e0d\u53ef\uff09\u3001\u30b3\u30d4\u30fc\u5148\u306f\u30b3\u30f3\u30c6\u30ca\u5185\u306e\u7d76\u5bfe\u30d1\u30b9\u3067\u3059\u3002\u6307\u5b9a\u306b\u306f\u6b63\u898f\u8868\u73fe\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\n\nONBUILD <\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3>\n\nDockerfile\u3067build\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u30d9\u30fc\u30b9\u306b\u65b0\u305f\u306b\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u308b\u3068\u304d\u5b9f\u884c\u3057\u305f\u3044\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3092\u4e88\u3081\u66f8\u3044\u3066\u304a\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\n\uff08\uff0a\uff09exec\u5f62\u5f0f\uff1a <\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3> [ \"\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\",\"\u5f15\u65701\",\"\u5f15\u65702\" ]\u306e\u5f62\u5f0f\u3002\n\u3000\u3000\u3000\u4f8b.  RUN [\"/bin/bash\", \"-c\", \"echo hello\"]\n\n\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210(docker build)\n\u5b9f\u884c\u4f8b\nDockerfile\u304b\u3089\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u308b\u306b\u306fdocker build -t <\u30a4\u30e1\u30fc\u30b8\u540d:\u30bf\u30b0> <Dockerfile\u30d1\u30b9>\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\n-t\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4f5c\u6210\u3059\u308b\u30a4\u30e1\u30fc\u30b8\u306b\u540d\u524d\u3068\u30bf\u30b0\u3092\u3064\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30b3\u30de\u30f3\u30c9\u306e\u6700\u5f8c\u306b\u306fDockerfile\u306e\u7f6e\u304b\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306bDockerfile\u304c\u7f6e\u3044\u3066\u3042\u308b\u60f3\u5b9a\u3067\u300c.\u300d\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n$ sudo docker build -t web_server .\n\n\u5b9f\u884c\u7d50\u679c\u78ba\u8a8d\n\u6307\u5b9a\u3057\u305f\u540d\u79f0web_server\u3067\u65b0\u305f\u306b\u30a4\u30e1\u30fc\u30b8\u304c\u3067\u304d\u305f\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n$ sudo docker images\nREPOSITORY           TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nweb_server           latest              455927c8e660        10 minutes ago      210 MB\n(\u4ee5\u4e0b\u7565)\n\n\n\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\n\u65e9\u901f\u4f5c\u6210\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u5143\u306b\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u3067\u3059\u3002\n$ sudo docker run -d -v /tmp/docker:/opt -p 80:8080 web_server\n\n/tmp/docker/test.txt\u3078\u4f55\u304b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8a18\u8f09\u3057\u3066\u3001\u8d77\u52d5\u3057\u305f\u30b5\u30fc\u30d0\u3078\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\nhttp://localhost:8888/test.txt\n\uff0a\u30dd\u30fc\u30c88888\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u306f\u4eca\u56de\u306e\u74b0\u5883\u3067\u306fCentOS 7\u304c\u8d77\u52d5\u3057\u3066\u3044\u308bVM\u306e80\u30928888\u3078\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u3066\u3044\u308b\u305f\u3081\u3002\n\n\u305d\u306e1\u3068\u540c\u69d8\u306bWeb\u30b5\u30fc\u30d0\u3078\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u304c\u78ba\u8a8d\u3067\u304d\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n\u305d\u306e2\u3067\u898b\u305f\u3088\u3046\u306bdocker logs\u30b3\u30de\u30f3\u30c9\u3067\u30ed\u30b0\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u306f\u8d77\u52d5\u4e2d\u306e\u30b3\u30f3\u30c6\u30ca\u306eID\u3092\u78ba\u8a8d\u3002\n$ sudo docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                  NAMES\nfb5df2b423ea        web_server:latest   \"/bin/sh -c 'ruby -r   18 minutes ago      Up 18 minutes       0.0.0.0:80->8080/tcp   boring_hopper\n\nID\u3092\u6307\u5b9a\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u5185\u306e\u30ed\u30b0\u51fa\u529b\u3092\u898b\u308b\u3068\u78ba\u304b\u306b\u5148\u307b\u3069\u306e\u30a2\u30af\u30bb\u30b9\u304c\u8a18\u9332\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\n$ sudo docker logs --tail=\"3\" fb5df\n[2015-01-13 15:14:11] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true\n10.0.2.2 - - [13/Jan/2015:15:14:11 UTC] \"GET /test.txt HTTP/1.1\" 304 0\n- -> /test.txt\n\n\n\u30a4\u30e1\u30fc\u30b8\u306e\u4e2d\u8eab\u3092\u78ba\u8a8d\u3059\u308b\n\n\u30a4\u30e1\u30fc\u30b8\u306e\u66f4\u65b0\u5c65\u6b74\u3092\u78ba\u8a8d\u3059\u308b docker history\n\u30a4\u30e1\u30fc\u30b8\u306f\u30d9\u30fc\u30b9\u3068\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3068\u306e\u5dee\u5206\u3092\u7a4d\u307f\u91cd\u306d\u3066\u4f5c\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u3053\u3068\u3092\u7aef\u7684\u306b\u78ba\u8a8d\u3059\u308b\u306b\u306fdocker history <\u30a4\u30e1\u30fc\u30b8>\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u5b9f\u884c\u4f8b\n$ sudo docker history web_server\n\n\u5b9f\u884c\u4f8b\u7d50\u679c\n\u3053\u308c\u307e\u3067\u306e\u5909\u66f4\u306e\u6b74\u53f2\u304c\u5168\u3066\u8a18\u9332\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u4f5c\u6210\u6642\u306e\u30b3\u30de\u30f3\u30c9\u304c\u9014\u4e2d\u3067\u5207\u3089\u308c\u3066\u3044\u307e\u3059\u304c\n\u30aa\u30d7\u30b7\u30e7\u30f3--no-trunc\u3092\u3064\u3051\u308b\u3068\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u5168\u4f53\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n$ sudo docker history web_server\nIMAGE               CREATED             CREATED BY                                      SIZE\n455927c8e660        3 days ago          /bin/sh -c #(nop) CMD [/bin/sh -c ruby -run -   0 B\n9307eadf28da        3 days ago          /bin/sh -c #(nop) WORKDIR /opt                  0 B\nc2bbe183f761        3 days ago          /bin/sh -c #(nop) EXPOSE map[8080/tcp:{}]       0 B\nc75722c696c8        3 days ago          /bin/sh -c apt-get install ruby -y              17.29 MB\ne82e1a53528e        3 days ago          /bin/sh -c #(nop) MAINTAINER smile-0yen smile   0 B\ned5a78b7b42b        3 weeks ago         /bin/sh -c #(nop) CMD [/bin/bash]               0 B\n8c4b1edcceea        3 weeks ago         /bin/sh -c sed -i 's/^#\\s*\\(deb.*universe\\)$/   1.895 kB\n9a4594fe74ea        3 weeks ago         /bin/sh -c echo '#!/bin/sh' > /usr/sbin/polic   194.5 kB\nfe95bf7d5f50        3 weeks ago         /bin/sh -c #(nop) ADD file:c032cb16120c7533b5   192.5 MB\n511136ea3c5a        19 months ago                                                       0 B\n\n--no-trunc\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u305f\u5834\u5408\n$ sudo docker history --no-trunc web_server\nIMAGE                                                              CREATED             CREATED BY                                                                                         SIZE\n455927c8e6600f79ba6dda8e03709051a251a1dfb96f634b95959e8bfb0d5174   3 days ago          /bin/sh -c #(nop) CMD [/bin/sh -c ruby -run -e httpd . -p 8080]                                    0 B\n9307eadf28dadd4f21ea14024343c69de924d6766494fa73015aec8daf43ae1f   3 days ago          /bin/sh -c #(nop) WORKDIR /opt                                                                     0 B\nc2bbe183f7613773d0dc03670730acc2def499e85efa97074132698918a739d8   3 days ago          /bin/sh -c #(nop) EXPOSE map[8080/tcp:{}]                                                          0 B\nc75722c696c8ecb42d8d9fc31f0b260845b881a59cc7881fe1761fc7360ba776   3 days ago          /bin/sh -c apt-get install ruby -y                                                                 17.29 MB\ne82e1a53528eaf869bca0a16ea9423853c077d06b0b1bfccfdd6a207790281f2   3 days ago          /bin/sh -c #(nop) MAINTAINER smile-0yen smile0yen.1024@gmail.com                                   0 B\ned5a78b7b42bde1e3e4c2996e02da778882dca78f8919cbd0deb6694803edec3   3 weeks ago         /bin/sh -c #(nop) CMD [/bin/bash]                                                                  0 B\n8c4b1edcceea5c11f0a43de6c990036cffbd63f5590cba0075042c66cd90d948   3 weeks ago         /bin/sh -c sed -i 's/^#\\s*\\(deb.*universe\\)$/\\1/g' /etc/apt/sources.list                           1.895 kB\n9a4594fe74ea4c14e642b871556f1460f6d332350bf3c772e76ed0059444ff19   3 weeks ago         /bin/sh -c echo '#!/bin/sh' > /usr/sbin/policy-rc.d                                                && echo 'exit 101' >> /usr/sbin/policy-rc.d    && chmod +x /usr/sbin/policy-rc.d                        && dpkg-divert --local --rename --add /sbin/initctl    && cp -a /usr/sbin/policy-rc.d /sbin/initctl    && sed -i 's/^exit.*/exit 0/' /sbin/initctl                        && echo 'force-unsafe-io' > /etc/dpkg/dpkg.cfg.d/docker-apt-speedup                        && echo 'DPkg::Post-Invoke { \"rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\"; };' > /etc/apt/apt.conf.d/docker-clean    && echo 'APT::Update::Post-Invoke { \"rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\"; };' >> /etc/apt/apt.conf.d/docker-clean    && echo 'Dir::Cache::pkgcache \"\"; Dir::Cache::srcpkgcache \"\";' >> /etc/apt/apt.conf.d/docker-clean                        && echo 'Acquire::Languages \"none\";' > /etc/apt/apt.conf.d/docker-no-languages                        && echo 'Acquire::GzipIndexes \"true\"; Acquire::CompressionTypes::Order:: \"gz\";' > /etc/apt/apt.conf.d/docker-gzip-indexes   194.5 kB\nfe95bf7d5f5090fdaf5c5d442f9f05211f9cb338107a41ff10c7a46be4be2dea   3 weeks ago         /bin/sh -c #(nop) ADD file:c032cb16120c7533b582d0c03b3e19314915f7674c000eda0cd36853005a880e in /   192.5 MB\n511136ea3c5a64f264b78b5433614aec563103b4d4702f3ba7d4d2698e22c158   19 months ago                                                                                                          0 B\n\n\n\u30a4\u30e1\u30fc\u30b8\u306e\u8a73\u7d30\u3092\u78ba\u8a8d\u3059\u308b docker inspect\n\u30a4\u30e1\u30fc\u30b8\u306b\u8a18\u9332\u3055\u308c\u3066\u3044\u308b\u8a73\u7d30\u306a\u60c5\u5831\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306fdocker inspect <\u30a4\u30e1\u30fc\u30b8>\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u3042\u307e\u308a\u4f7f\u3046\u3053\u3068\u306f\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u5168\u3066\u306e\u8a2d\u5b9a\u60c5\u5831\u3092JSON\u5f62\u5f0f\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u306e\u3067\u4fbf\u5229\u3067\u3059\u3002\n\u5b9f\u884c\u4f8b\n$ sudo docker inspect web_server\n\n\u5b9f\u884c\u4f8b\u7d50\u679c\n[{\n    \"Architecture\": \"amd64\",\n    \"Author\": \"smile-0yen smile0yen.1024@gmail.com\",\n    \"Comment\": \"\",\n    \"Config\": {\n        \"AttachStderr\": false,\n        \"AttachStdin\": false,\n        \"AttachStdout\": false,\n        \"Cmd\": [\n            \"/bin/sh\",\n            \"-c\",\n            \"ruby -run -e httpd . -p 8080\"\n        ],\n        \"CpuShares\": 0,\n        \"Cpuset\": \"\",\n        \"Domainname\": \"\",\n        \"Entrypoint\": null,\n        \"Env\": [\n            \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\n        ],\n        \"ExposedPorts\": {\n            \"8080/tcp\": {}\n        },\n\uff08\u4ee5\u4e0b\u7565\uff09\n\n\n\u307e\u3068\u3081\n\n\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\u306e\u57fa\u672c\u306fDockerfile\u3078\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3092\u66f8\u3044\u3066docker build -t <\u30a4\u30e1\u30fc\u30b8\u540d:\u30bf\u30b0> <Dockerfile\u30d1\u30b9>\n\n\nDockerfile\u306b\u3088\u3063\u3066\u30a4\u30e1\u30fc\u30b8\u3092\u30b3\u30fc\u30c9\u3068\u3057\u3066\u7ba1\u7406\u3067\u304d\u308b\u3002\n\u30a4\u30e1\u30fc\u30b8\u306e\u5909\u66f4\u5c65\u6b74\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306fdocker history <\u30a4\u30e1\u30fc\u30b8>\u3002\n\u30a4\u30e1\u30fc\u30b8\u306e\u8a73\u7d30\u60c5\u5831\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306fdocker inspect <\u30a4\u30e1\u30fc\u30b8>\u3002\n\n\n## \u74b0\u5883\n\n[\u305d\u306e1](http://qiita.com/smile-0yen/items/c6957b951ca0fdb8acc7)\u3067\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\u65b9\u6cd5\u3001[\u305d\u306e2](http://qiita.com/smile-0yen/items/4a35ea9f0279f4d85c42)\u3067\u30b3\u30f3\u30c6\u30ca\u304c\u3069\u3093\u306a\u72b6\u614b\u306b\u3042\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\n\u7d9a\u304f\u305d\u306e3\u3067\u306fregistry\u304b\u3089\u53d6\u5f97\u3057\u3066\u304d\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u3082\u3068\u306b\u81ea\u5206\u3060\u3051\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3092\u66f8\u304d\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306e\u74b0\u5883\u3067Docker\u306e\u57fa\u672c\u64cd\u4f5c\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n| \u9805\u76ee | \u4eca\u56de\u306e\u30b7\u30b9\u30c6\u30e0 |\n|:---|:---|\n| OS | CentOS 7.0 (on VirtualBox) |\n| Docker | docker-1.3.2 | \n\n## Dockerfile\u304b\u3089\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u308b\n\n\u81ea\u5206\u3060\u3051\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u306b\u306f`Dockerfile`\u3092\u7528\u3044\u308b\u306e\u304c\u7c21\u5358\u306a\u65b9\u6cd5\u3067\u3059\u3002\nDocker\u306b\u306f`docker build`\u3068\u3044\u3046`Dockerfile`\u3092\u8aad\u307f\u8fbc\u3093\u3067\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u308b\u30b3\u30de\u30f3\u30c9\u304c\u3042\u308a\u307e\u3059\u3002\n\n[\u305d\u306e1](http://qiita.com/smile-0yen/items/c6957b951ca0fdb8acc7)\u3067\u306fbash\u3092\u8d77\u52d5\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u5185\u3067Ruby\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3001Web\u30b5\u30fc\u30d0\u3092\u7acb\u3066\u307e\u3057\u305f\u3002\n\u3053\u3053\u3067\u306f\u5177\u4f53\u4f8b\u3068\u3057\u3066\u305d\u308c\u3068\u540c\u3058\u3053\u3068\u3092`Dockerfile`\u3092\u4f7f\u3063\u3066\u5b9f\u73fe\u3057\u307e\u3059\u3002\n\n### Dockerfile\u4f5c\u6210\n\n```\n# \"#\"\u3067\u59cb\u307e\u308b\u884c\u306f\u30b3\u30e1\u30f3\u30c8\u884c\u3068\u307f\u306a\u3055\u308c\u307e\u3059\u3002\n# Dockerfile\u306f\u5fc5\u305a\u30d9\u30fc\u30b9\u3068\u306a\u308b\u30a4\u30e1\u30fc\u30b8\u3092\u6307\u5b9a\u3059\u308bFROM\u304b\u3089\u66f8\u304d\u307e\u3059\u3002\nFROM ubuntu:14.04\n\n# MAINTAINER\u306b\u306f\u6587\u5b57\u901a\u308aDockerfile\u4f5c\u6210\u8005\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\nMAINTAINER smile-0yen smile0yen.1024@gmail.com\n\n# RUN\u306f\u6307\u5b9a\u3055\u308c\u305f\u30b3\u30de\u30f3\u30c9\u3092\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u4fdd\u5b58\u3057\u307e\u3059\u3002\nRUN apt-get install ruby -y\n\n# EXPOSE\u306f\u30b3\u30f3\u30c6\u30ca\u306e\u5916\u306b\u5bfe\u3057\u3066\u958b\u304f\u30dd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n# \u89aa\u30db\u30b9\u30c8\u306e\u3069\u306e\u30dd\u30fc\u30c8\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3059\u308b\u304b\u306f\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b\u6c7a\u5b9a\u3057\u307e\u3059\u3002\nEXPOSE 8080\n\n# WORKDIR\u306b\u3088\u3063\u3066\u3053\u306e\u884c\u4ee5\u964d\u306eRUN\u53ca\u3073CMD\u3092\u5b9f\u884c\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\nWORKDIR /opt\n\n# CMD\u306b\u306f\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3057\u305f\u3042\u3068\u306b\u5b9f\u884c\u3055\u308c\u308b\u30b3\u30de\u30f3\u30c9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nCMD ruby -run -e httpd . -p 8080\n```\n\n`Dockerfile`\u5185\u3067\u306e\u547d\u4ee4\u306f\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3(Instruction)\u3068\u547c\u3070\u308c\u307e\u3059\u3002\u975e\u5e38\u306b\u30b7\u30f3\u30d7\u30eb\u306a\u8a18\u8ff0\u304c\u7279\u5fb4\u3067\u3059\u3002\n\u5927\u6587\u5b57\u3067\u3042\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u53ef\u8aad\u6027\u306e\u305f\u3081\u306b\u5168\u3066\u5927\u6587\u5b57\u3067\u66f8\u304f\u3053\u3068\u304c\u63a8\u5968\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n|\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3|\u8aac\u660e\n|:---|:---|\n| FROM <\u30a4\u30e1\u30fc\u30b8>:<\u30bf\u30b0>| \u30d9\u30fc\u30b9\u3068\u306a\u308b\u30a4\u30e1\u30fc\u30b8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002<br>`Dockerfile`\u306e\u5148\u982d\u306f\u5fc5\u305aFROM\u3067\u59cb\u3081\u307e\u3059\u3002 |\n| MAINTAINER <\u540d\u524d> | \u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u8005\u3092\u660e\u793a\u3057\u307e\u3059\u3002\u6307\u5b9a\u3059\u308b\u3068\u30a4\u30e1\u30fc\u30b8\u5185\u306b<br>`Author`\u60c5\u5831\u3068\u3057\u3066\u8a18\u9332\u3055\u308c\u307e\u3059\u3002 |\n| RUN <\u30b3\u30de\u30f3\u30c9> | \u4efb\u610f\u306e\u30b3\u30de\u30f3\u30c9\u3092`/bin/sh -c`\u306b\u6e21\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002<br>`/bin/sh`\u304c\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306b\u306a\u3044\u5834\u5408\u306a\u3069`exec`\u5f62\u5f0f\u3067\uff08\uff0a\uff09\u3067<br>\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002 |\n| CMD <\u30b3\u30de\u30f3\u30c9> | \u30b3\u30de\u30f3\u30c9\u3092`/bin/sh -c`\u306b\u6e21\u3057\u3066\u30b3\u30f3\u30c6\u30ca**\u8d77\u52d5\u6642\u306b**\u5b9f\u884c\u3057\u307e\u3059\u3002<br>\u305f\u3060\u3057\u3001`docker run`\u3067\u30b3\u30f3\u30c6\u30ca\u3092\u8d77\u52d5\u3059\u308b\u969b\u306b\u5225\u306e\u30b3\u30de\u30f3\u30c9\u3092<br>\u6e21\u3057\u305f\u3068\u304d\u306b\u306fCMD\u306f\u305d\u3061\u3089\u3067**\u4e0a\u66f8\u304d\u3055\u308c\u308b**\u305f\u3081\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002<br>\u306a\u304a\u3001CMD\u306f1\u3064\u306bDockerfile\u306b\u3064\u304d1\u56de\u3057\u304b\u6307\u5b9a\u3067\u304d\u307e\u305b\u3093\u3002<br>`/bin/sh`\u3092\u4f7f\u3044\u305f\u304f\u306a\u3044\u5834\u5408\u306fexec\u5f62\u5f0f\uff08\uff0a\uff09\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002 |\n| ENTRYPOINT\u3000<\u30b3\u30de\u30f3\u30c9> | CMD\u3068\u540c\u69d8\u306b\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b\u5b9f\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002<br>\u3053\u3061\u3089\u306f`docker run`\u3067\u6e21\u3055\u308c\u305f\u5225\u306e\u30b3\u30de\u30f3\u30c9\u3067**\u4e0a\u66f8\u304d\u3055\u308c\u307e\u305b\u3093**\u3002<br>`docker run`\u3067\u6e21\u3055\u308c\u305f\u30b3\u30de\u30f3\u30c9\u306fENTRYPOINT\u3067\u6307\u5b9a\u3057\u305f\u30b3\u30de\u30f3\u30c9\u306e<br>\u5f8c\u308d\u3078**\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u3057\u3066\u8ffd\u52a0**\u3055\u308c\u307e\u3059\u3002<br>CMD\u3068ENTRYPOINT\u3092\u3069\u3061\u3089\u3082\u6307\u5b9a\u3057\u305f\u5834\u5408\u3001CMD\u306e\u5024\u306f<br>ENTRYPOINT\u3067\u6307\u5b9a\u3057\u305f\u30b3\u30de\u30f3\u30c9\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5f15\u6570\u3068\u89e3\u91c8\u3055\u308c\u307e\u3059\u3002<br>`/bin/sh`\u3067\u8d77\u52d5\u3055\u308c\u305f\u304f\u306a\u3044\u5834\u5408exec\u5f62\u5f0f\uff08\uff0a\uff09\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002 |\n| EXPOSE <\u30dd\u30fc\u30c8\u756a\u53f7>| \u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b\u5185\u90e8\u3067LISTEN\u3059\u308b\u30dd\u30fc\u30c8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002<br>\u89aa\u30db\u30b9\u30c8\u3078\u306e\u30dd\u30fc\u30c8\u30de\u30c3\u30d4\u30f3\u30b0\u306f\u8d77\u52d5\u6642\u306b\u5225\u9014\u6307\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002<br>Dockerfile\u5185\u3067\u89aa\u306e\u30dd\u30fc\u30c8\u3092\u4e88\u3081\u6307\u5b9a\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002 |\n| ENV <\u5909\u6570\u540d> <\u5024>| \u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002 |\n| WORKDIR <\u30c7\u30a3\u30ec\u30af\u30c8\u30ea>| `Dockerfile`\u5185\u3067RUN, CMD, ENTRYPOINT\u3088\u308a\u524d\u306b\u66f8\u304f\u3068<br>\u305d\u308c\u3089\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002<br>\u307e\u305fENV\u306e\u3042\u3068\u306b\u66f8\u3051\u3070ENV\u3067\u8a2d\u5b9a\u3057\u305f\u74b0\u5883\u5909\u6570\u3092\u53c2\u7167\u3067\u304d\u307e\u3059\u3002|\n| USER <\u30e6\u30fc\u30b6\u30fc> | `Dockerfile`\u5185\u3067RUN, CMD, ENTRYPOINT\u3088\u308a\u524d\u306b\u66f8\u304f\u3068<br>\u305d\u308c\u3089\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\u30e6\u30fc\u30b6\u30fc\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002 |\n| VOLUME <\u30c7\u30a3\u30ec\u30af\u30c8\u30ea> | \u3053\u306e\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3067\u30de\u30a6\u30f3\u30c8\u30dd\u30a4\u30f3\u30c8\u3092\u6307\u5b9a\u3057\u3066\u304a\u304f\u3068\u3001<br>\u305d\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u89aa\u30db\u30b9\u30c8\u3084\u4ed6\u306e\u30b3\u30f3\u30c6\u30ca\u3068\u5171\u6709\u3067\u304d\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002|\n| ADD <\u30b3\u30d4\u30fc\u5143> <\u30b3\u30d4\u30fc\u5148>  |\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001\u30d5\u30a1\u30a4\u30eb\uff08\u8907\u6570\u53ef\uff09\u3092\u30b3\u30f3\u30c6\u30ca\u5185\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002<br>\u30b3\u30d4\u30fc\u5143\u306f`docker build`\u5b9f\u884c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u306e\u76f8\u5bfe\u30d1\u30b9<br>\uff08\u305f\u3060\u3057\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u4e0d\u53ef\uff09\u3001\u30b3\u30d4\u30fc\u5148\u306f\u30b3\u30f3\u30c6\u30ca\u5185\u306e<br>\u7d76\u5bfe\u30d1\u30b9\u3067\u3059\u3002\u6307\u5b9a\u306b\u306f\u6b63\u898f\u8868\u73fe\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002<br>\u6b21\u306eCOPY\u3068\u7570\u306a\u308a\u30b3\u30d4\u30fc\u5143\u306bURL\u3082\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u7279\u5b9a\u306e\u5f62\u5f0f<br>(identity, gzip, bzip2, xz)\u3067\u5727\u7e2e\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u30b3\u30d4\u30fc\u5143\u306e\u5834\u5408\u306f<br>\u89e3\u51cd\u3057\u3066\u304b\u3089\u30b3\u30f3\u30c6\u30ca\u5185\u306b\u8a2d\u7f6e\u3057\u307e\u3059\u3002 |\n| COPY <\u30b3\u30d4\u30fc\u5143> <\u30b3\u30d4\u30fc\u5148> |\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3001\u30d5\u30a1\u30a4\u30eb\uff08\u8907\u6570\u53ef\uff09\u3092\u30b3\u30f3\u30c6\u30ca\u5185\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002<br>\u30b3\u30d4\u30fc\u5143\u306f`docker build`\u5b9f\u884c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u306e\u76f8\u5bfe\u30d1\u30b9<br>\uff08\u305f\u3060\u3057\u89aa\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u4e0d\u53ef\uff09\u3001\u30b3\u30d4\u30fc\u5148\u306f\u30b3\u30f3\u30c6\u30ca\u5185\u306e<br>\u7d76\u5bfe\u30d1\u30b9\u3067\u3059\u3002\u6307\u5b9a\u306b\u306f\u6b63\u898f\u8868\u73fe\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002 |\n| ONBUILD <\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3> | `Dockerfile`\u3067`build`\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u30d9\u30fc\u30b9\u306b\u65b0\u305f\u306b\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u308b\u3068\u304d<br>\u5b9f\u884c\u3057\u305f\u3044\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3092\u4e88\u3081\u66f8\u3044\u3066\u304a\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 |\n\n\uff08\uff0a\uff09exec\u5f62\u5f0f\uff1a `<\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3> [ \"\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\",\"\u5f15\u65701\",\"\u5f15\u65702\" ]`\u306e\u5f62\u5f0f\u3002\n\u3000\u3000\u3000\u4f8b.  `RUN [\"/bin/bash\", \"-c\", \"echo hello\"]`\n\n### \u30a4\u30e1\u30fc\u30b8\u4f5c\u6210(docker build)\n\n**\u5b9f\u884c\u4f8b**\n`Dockerfile`\u304b\u3089\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u308b\u306b\u306f`docker build -t <\u30a4\u30e1\u30fc\u30b8\u540d:\u30bf\u30b0> <Dockerfile\u30d1\u30b9>`\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n- `-t`\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u4f5c\u6210\u3059\u308b\u30a4\u30e1\u30fc\u30b8\u306b\u540d\u524d\u3068\u30bf\u30b0\u3092\u3064\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n- \u30b3\u30de\u30f3\u30c9\u306e\u6700\u5f8c\u306b\u306f`Dockerfile`\u306e\u7f6e\u304b\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002<br>\u4eca\u56de\u306f\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b`Dockerfile`\u304c\u7f6e\u3044\u3066\u3042\u308b\u60f3\u5b9a\u3067\u300c.\u300d\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n```\n$ sudo docker build -t web_server .\n```\n\n**\u5b9f\u884c\u7d50\u679c\u78ba\u8a8d**\n\u6307\u5b9a\u3057\u305f\u540d\u79f0web_server\u3067\u65b0\u305f\u306b\u30a4\u30e1\u30fc\u30b8\u304c\u3067\u304d\u305f\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```\n$ sudo docker images\nREPOSITORY           TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\nweb_server           latest              455927c8e660        10 minutes ago      210 MB\n(\u4ee5\u4e0b\u7565)\n```\n\n### \u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\n\u65e9\u901f\u4f5c\u6210\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u5143\u306b\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u3067\u3059\u3002\n\n```\n$ sudo docker run -d -v /tmp/docker:/opt -p 80:8080 web_server\n```\n\n`/tmp/docker/test.txt`\u3078\u4f55\u304b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8a18\u8f09\u3057\u3066\u3001\u8d77\u52d5\u3057\u305f\u30b5\u30fc\u30d0\u3078\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\nhttp://localhost:8888/test.txt\n\uff0a\u30dd\u30fc\u30c88888\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u306f\u4eca\u56de\u306e\u74b0\u5883\u3067\u306fCentOS 7\u304c\u8d77\u52d5\u3057\u3066\u3044\u308bVM\u306e80\u30928888\u3078\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3057\u3066\u3044\u308b\u305f\u3081\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-01-17 11.36.01.png](https://qiita-image-store.s3.amazonaws.com/0/61318/dd53b278-4ea0-bf51-c42c-43fbfdee5ceb.png)\n[\u305d\u306e1](http://qiita.com/smile-0yen/items/c6957b951ca0fdb8acc7)\u3068\u540c\u69d8\u306bWeb\u30b5\u30fc\u30d0\u3078\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u304c\u78ba\u8a8d\u3067\u304d\u308c\u3070\u6210\u529f\u3067\u3059\u3002\n[\u305d\u306e2](http://qiita.com/smile-0yen/items/4a35ea9f0279f4d85c42)\u3067\u898b\u305f\u3088\u3046\u306b`docker logs`\u30b3\u30de\u30f3\u30c9\u3067\u30ed\u30b0\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u306f\u8d77\u52d5\u4e2d\u306e\u30b3\u30f3\u30c6\u30ca\u306eID\u3092\u78ba\u8a8d\u3002\n\n```\n$ sudo docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                  NAMES\nfb5df2b423ea        web_server:latest   \"/bin/sh -c 'ruby -r   18 minutes ago      Up 18 minutes       0.0.0.0:80->8080/tcp   boring_hopper\n```\n\nID\u3092\u6307\u5b9a\u3057\u3066\u30b3\u30f3\u30c6\u30ca\u5185\u306e\u30ed\u30b0\u51fa\u529b\u3092\u898b\u308b\u3068\u78ba\u304b\u306b\u5148\u307b\u3069\u306e\u30a2\u30af\u30bb\u30b9\u304c\u8a18\u9332\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\n\n```\n$ sudo docker logs --tail=\"3\" fb5df\n[2015-01-13 15:14:11] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true\n10.0.2.2 - - [13/Jan/2015:15:14:11 UTC] \"GET /test.txt HTTP/1.1\" 304 0\n- -> /test.txt\n```\n\n## \u30a4\u30e1\u30fc\u30b8\u306e\u4e2d\u8eab\u3092\u78ba\u8a8d\u3059\u308b\n\n### \u30a4\u30e1\u30fc\u30b8\u306e\u66f4\u65b0\u5c65\u6b74\u3092\u78ba\u8a8d\u3059\u308b docker history\n\n\u30a4\u30e1\u30fc\u30b8\u306f\u30d9\u30fc\u30b9\u3068\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u3068\u306e\u5dee\u5206\u3092\u7a4d\u307f\u91cd\u306d\u3066\u4f5c\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u3053\u3068\u3092\u7aef\u7684\u306b\u78ba\u8a8d\u3059\u308b\u306b\u306f`docker history <\u30a4\u30e1\u30fc\u30b8>`\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n**\u5b9f\u884c\u4f8b**\n\n```\n$ sudo docker history web_server\n```\n\n**\u5b9f\u884c\u4f8b\u7d50\u679c**\n\u3053\u308c\u307e\u3067\u306e\u5909\u66f4\u306e\u6b74\u53f2\u304c\u5168\u3066\u8a18\u9332\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u4f5c\u6210\u6642\u306e\u30b3\u30de\u30f3\u30c9\u304c\u9014\u4e2d\u3067\u5207\u3089\u308c\u3066\u3044\u307e\u3059\u304c\n\u30aa\u30d7\u30b7\u30e7\u30f3`--no-trunc`\u3092\u3064\u3051\u308b\u3068\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\u5168\u4f53\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```\n$ sudo docker history web_server\nIMAGE               CREATED             CREATED BY                                      SIZE\n455927c8e660        3 days ago          /bin/sh -c #(nop) CMD [/bin/sh -c ruby -run -   0 B\n9307eadf28da        3 days ago          /bin/sh -c #(nop) WORKDIR /opt                  0 B\nc2bbe183f761        3 days ago          /bin/sh -c #(nop) EXPOSE map[8080/tcp:{}]       0 B\nc75722c696c8        3 days ago          /bin/sh -c apt-get install ruby -y              17.29 MB\ne82e1a53528e        3 days ago          /bin/sh -c #(nop) MAINTAINER smile-0yen smile   0 B\ned5a78b7b42b        3 weeks ago         /bin/sh -c #(nop) CMD [/bin/bash]               0 B\n8c4b1edcceea        3 weeks ago         /bin/sh -c sed -i 's/^#\\s*\\(deb.*universe\\)$/   1.895 kB\n9a4594fe74ea        3 weeks ago         /bin/sh -c echo '#!/bin/sh' > /usr/sbin/polic   194.5 kB\nfe95bf7d5f50        3 weeks ago         /bin/sh -c #(nop) ADD file:c032cb16120c7533b5   192.5 MB\n511136ea3c5a        19 months ago                                                       0 B\n```\n\n**`--no-trunc`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u305f\u5834\u5408**\n\n```\n$ sudo docker history --no-trunc web_server\nIMAGE                                                              CREATED             CREATED BY                                                                                         SIZE\n455927c8e6600f79ba6dda8e03709051a251a1dfb96f634b95959e8bfb0d5174   3 days ago          /bin/sh -c #(nop) CMD [/bin/sh -c ruby -run -e httpd . -p 8080]                                    0 B\n9307eadf28dadd4f21ea14024343c69de924d6766494fa73015aec8daf43ae1f   3 days ago          /bin/sh -c #(nop) WORKDIR /opt                                                                     0 B\nc2bbe183f7613773d0dc03670730acc2def499e85efa97074132698918a739d8   3 days ago          /bin/sh -c #(nop) EXPOSE map[8080/tcp:{}]                                                          0 B\nc75722c696c8ecb42d8d9fc31f0b260845b881a59cc7881fe1761fc7360ba776   3 days ago          /bin/sh -c apt-get install ruby -y                                                                 17.29 MB\ne82e1a53528eaf869bca0a16ea9423853c077d06b0b1bfccfdd6a207790281f2   3 days ago          /bin/sh -c #(nop) MAINTAINER smile-0yen smile0yen.1024@gmail.com                                   0 B\ned5a78b7b42bde1e3e4c2996e02da778882dca78f8919cbd0deb6694803edec3   3 weeks ago         /bin/sh -c #(nop) CMD [/bin/bash]                                                                  0 B\n8c4b1edcceea5c11f0a43de6c990036cffbd63f5590cba0075042c66cd90d948   3 weeks ago         /bin/sh -c sed -i 's/^#\\s*\\(deb.*universe\\)$/\\1/g' /etc/apt/sources.list                           1.895 kB\n9a4594fe74ea4c14e642b871556f1460f6d332350bf3c772e76ed0059444ff19   3 weeks ago         /bin/sh -c echo '#!/bin/sh' > /usr/sbin/policy-rc.d                                                && echo 'exit 101' >> /usr/sbin/policy-rc.d    && chmod +x /usr/sbin/policy-rc.d                        && dpkg-divert --local --rename --add /sbin/initctl    && cp -a /usr/sbin/policy-rc.d /sbin/initctl    && sed -i 's/^exit.*/exit 0/' /sbin/initctl                        && echo 'force-unsafe-io' > /etc/dpkg/dpkg.cfg.d/docker-apt-speedup                        && echo 'DPkg::Post-Invoke { \"rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\"; };' > /etc/apt/apt.conf.d/docker-clean    && echo 'APT::Update::Post-Invoke { \"rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\"; };' >> /etc/apt/apt.conf.d/docker-clean    && echo 'Dir::Cache::pkgcache \"\"; Dir::Cache::srcpkgcache \"\";' >> /etc/apt/apt.conf.d/docker-clean                        && echo 'Acquire::Languages \"none\";' > /etc/apt/apt.conf.d/docker-no-languages                        && echo 'Acquire::GzipIndexes \"true\"; Acquire::CompressionTypes::Order:: \"gz\";' > /etc/apt/apt.conf.d/docker-gzip-indexes   194.5 kB\nfe95bf7d5f5090fdaf5c5d442f9f05211f9cb338107a41ff10c7a46be4be2dea   3 weeks ago         /bin/sh -c #(nop) ADD file:c032cb16120c7533b582d0c03b3e19314915f7674c000eda0cd36853005a880e in /   192.5 MB\n511136ea3c5a64f264b78b5433614aec563103b4d4702f3ba7d4d2698e22c158   19 months ago                                                                                                          0 B\n```\n\n### \u30a4\u30e1\u30fc\u30b8\u306e\u8a73\u7d30\u3092\u78ba\u8a8d\u3059\u308b docker inspect\n\n\u30a4\u30e1\u30fc\u30b8\u306b\u8a18\u9332\u3055\u308c\u3066\u3044\u308b\u8a73\u7d30\u306a\u60c5\u5831\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f`docker inspect <\u30a4\u30e1\u30fc\u30b8>`\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u3042\u307e\u308a\u4f7f\u3046\u3053\u3068\u306f\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u5168\u3066\u306e\u8a2d\u5b9a\u60c5\u5831\u3092JSON\u5f62\u5f0f\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u306e\u3067\u4fbf\u5229\u3067\u3059\u3002\n\n**\u5b9f\u884c\u4f8b**\n\n```\n$ sudo docker inspect web_server\n```\n\n**\u5b9f\u884c\u4f8b\u7d50\u679c**\n\n```\n[{\n    \"Architecture\": \"amd64\",\n    \"Author\": \"smile-0yen smile0yen.1024@gmail.com\",\n    \"Comment\": \"\",\n    \"Config\": {\n        \"AttachStderr\": false,\n        \"AttachStdin\": false,\n        \"AttachStdout\": false,\n        \"Cmd\": [\n            \"/bin/sh\",\n            \"-c\",\n            \"ruby -run -e httpd . -p 8080\"\n        ],\n        \"CpuShares\": 0,\n        \"Cpuset\": \"\",\n        \"Domainname\": \"\",\n        \"Entrypoint\": null,\n        \"Env\": [\n            \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\n        ],\n        \"ExposedPorts\": {\n            \"8080/tcp\": {}\n        },\n\uff08\u4ee5\u4e0b\u7565\uff09\n```\n\n## \u307e\u3068\u3081\n\n- \u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\u306e\u57fa\u672c\u306f`Dockerfile`\u3078\u30a4\u30f3\u30b9\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3092\u66f8\u3044\u3066<br>`docker build -t <\u30a4\u30e1\u30fc\u30b8\u540d:\u30bf\u30b0> <Dockerfile\u30d1\u30b9>`\n- `Dockerfile`\u306b\u3088\u3063\u3066\u30a4\u30e1\u30fc\u30b8\u3092\u30b3\u30fc\u30c9\u3068\u3057\u3066\u7ba1\u7406\u3067\u304d\u308b\u3002\n- \u30a4\u30e1\u30fc\u30b8\u306e\u5909\u66f4\u5c65\u6b74\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f`docker history <\u30a4\u30e1\u30fc\u30b8>`\u3002\n- \u30a4\u30e1\u30fc\u30b8\u306e\u8a73\u7d30\u60c5\u5831\u3092\u78ba\u8a8d\u3059\u308b\u306b\u306f`docker inspect <\u30a4\u30e1\u30fc\u30b8>`\u3002\n"}