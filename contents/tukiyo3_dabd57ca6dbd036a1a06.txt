{"tags": ["PHP", "snippets"], "context": "\n\nmake test\u304c\u5927\u91cf\u306eFAIL\u306e\u5834\u5408\u3001selinux\u304c\u7121\u52b9\u3092\u78ba\u8a8d\n\n/etc/selinux/config\n\nSELINUX=disabled\nreboot\n\n\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u53d6\u5f97\nfunction get_file_list($path = './files/') {\n        $files = array();\n        foreach (scandir($path) as $key=>$val) {\n                if (substr($val,-3) != \"png\") continue;\n                $files[] = $val;\n        }\n        return $files;\n}\n\n\nUserAgent\u5224\u5b9a\n\n\u30ac\u30e9\u30b1\u30fc\u3068IE6\u301c10\u3092\u9664\u5916\u3057\u305f\u3044\u5834\u5408\u3001UserAgent\u306b Gecko \u304c\u7121\u3044\u3053\u3068\u3067\u5224\u5b9a\u3059\u308c\u3070\u3088\u3055\u305d\u3046 - Qiita\n\nfunction is_office() {\n    $office = array(\"192.168.10.2\",\"22.22.22.22\");\n    if (! in_array($_SERVER['REMOTE_ADDR'], $office)) {\n        return false;\n    }\n    return true;\n}\n\n\n\u30d5\u30a1\u30a4\u30eb\u306eupload\n\n\u7d20\u306ephp\n\nPHP: POST method uploads - Manual\n\ntmp\u30d5\u30a9\u30eb\u30c0\u3092777\u3067\u4f5c\u3063\u3066\u304a\u304f\u3002\n\nindex.html\n<form action=\"upload.php\" method=\"post\" enctype=\"multipart/form-data\">\n  <input type=\"file\" name=\"file\" />\n  <input type=submit />\n</form>\n\n\n\nupload.php\n<?php\nif ($file = $_FILES['file']) {\n    $target = __DIR__ . \"/tmp/\" . $file['name'];\n    move_uploaded_file($file['tmp_name'], $target);\n    echo \"upload success.\";\n} else {\n    echo \"upload failure.\";\n}\n\n\n\ndropzone.js\n\nDropzone.js\n\n\ngit clone https://github.com/enyo/dropzone.git\n\n\nindexdropzone.php\n<link rel=\"stylesheet\" type=\"text/css\" href=\"dropzone/dist/basic.css\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"dropzone/dist/dropzone.css\">\n<script src=\"dropzone/dist/dropzone.js\"></script>\n\n<ul>\n<?php\necho sprintf(\"<li>upload limit: %s\", ini_get(\"upload_max_filesize\"));\necho sprintf(\"<li>post limit: %s\", ini_get(\"post_max_size\"));\n?>\n</ul>\n\n<form action=\"upload.php\" class=\"dropzone\">\n    <div id=\"dropzone\"></div>\n</form>\n\n\nupload.php \u306f\u4e0a\u3067\u6e96\u5099\u3057\u305f\u3082\u306e\u3067\u3088\u3044\u3002\n\u30c9\u30e9\u30b0\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\u3067upload\u304c\u5b8c\u4e86\u3059\u308b\u3002\n\n\n\u65e5\u4ed8\u3092\u66dc\u65e5\u306b\u5909\u63db\n\nPHP: date - Manual\n\n$yymmdd = \"2015-12-23\";\n\n$weekno = date(\"N\", strtotime($yymmdd))-1;\n$weeks = array(\"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"sat\", \"sun\");\necho $weeks[$weekno];\n\n\n\u4e00\u9031\u9593\u5f8c\u306e\u65e5\u4ed8\u53d6\u5f97\n$dtime = strtotime(\"+1 week\");\necho date(\"Y-m-d\" ,$dtime);\n\n\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\n\nPHP: session_save_path - Manual\nCookie\u3068\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u3061\u3083\u3093\u3068\u7406\u89e3\u3059\u308b(PHP) - Qiita\n\n\nsession\u306f\u4ee5\u4e0b\u306b\u4fdd\u5b58\u3055\u308c\u308b\n$ grep session.save_path /etc/php5/cli/php.ini\n;session.save_path = \"/var/lib/php5/sessions\"\n\n\n\n\n/var/lib/php5/sessions/\n\nsess_FIXED\n\n\nPHP - \u53c2\u8003\u306b\u306a\u3089\u306a\u3044\u307b\u3069\u30b7\u30f3\u30d7\u30eb\u306a\u63b2\u793a\u677f - Qiita\u306e\u4e00\u90e8\u3092\u629c\u7c8b\u3059\u308b\u3068\n\n\nFIXED\u3068\u3044\u3046ID\u3092\u6307\u5b9a\nsession_id('FIXED');\n\n\n\u3053\u3046\u3059\u308b\u3068 /var/lib/php5/sessions/sess_FIXED\u306b\u30c7\u30fc\u30bf\u304c\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5f62\u5f0f\u3067\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\n/var/lib/php5/sessions/sess_FIXED\nlog|a:5:{i:0;s:3:\"\u304a\";i:1;s:3:\"\u3048\";i:2;s:3:\"\u3046\";i:3;s:3:\"\u3044\";i:4;s:6:\"\u3042\u3042\";}#\n\n\nsession_start();\nif (($msg = (string)filter_input(INPUT_POST, 'msg')) !== '') {\n  $_SESSION['log'][] = $msg;\n  $_SESSION['log'] = array_slice($_SESSION['log'], -100);\n\n\nmemcached\u3092\u5229\u7528\u3057\u3066\u3001\u8907\u6570\u30b5\u30fc\u30d0\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u5171\u6709\u5316 | \u30ca\u30d3\u3055\u3093\u306e\u65e5\u8a18\u3068\u304b\u3002\nPHP\u30bb\u30c3\u30b7\u30e7\u30f3\u3092memcached\u3067\u7ba1\u7406\u3059\u308b\u4ef6 - Qiita\n#9 php\u306esession store\u3092redis\u306b\u3059\u308b - rrreeeyyy.com\n\n\u305d\u306e\u4ed6\u30e1\u30e2\n\n\u5225\u30b5\u30a4\u30c8\u3067\u3042\u308b\u306a\u3089Cookie\u304c\u4f7f\u3048\u306a\u3044\u3002\n\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540c\u58eb\u306a\u3089\u3001\u6709\u52b9\u7bc4\u56f2\u3092\u540c\u4e00\u30c9\u30e1\u30a4\u30f3\u307e\u3067\u8a31\u305b\u3070\u3088\u3044...\n\u72ec\u81ea\u306e\u30c9\u30e1\u30a4\u30f3\u306a\u3089\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30ec\u30f3\u30bf\u30eb\u30b5\u30fc\u30d0\u306a\u3069\u3067\u306f\u6709\u308a\u5f97\u306a\u3044\n\u30bb\u30c3\u30b7\u30e7\u30f3\u60c5\u5831\u3092\u30af\u30c3\u30ad\u30fc\u306b\u6301\u305f\u305b\u308b\u306a\u308aNFS\u3084\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u6301\u305f\u305b\u308b\n\n\n\n## make test\u304c\u5927\u91cf\u306eFAIL\u306e\u5834\u5408\u3001selinux\u304c\u7121\u52b9\u3092\u78ba\u8a8d\n\n* /etc/selinux/config\n\n`SELINUX=disabled`\nreboot\n\n## \u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u53d6\u5f97\n\n```php:\nfunction get_file_list($path = './files/') {\n        $files = array();\n        foreach (scandir($path) as $key=>$val) {\n                if (substr($val,-3) != \"png\") continue;\n                $files[] = $val;\n        }\n        return $files;\n}\n```\n\n# UserAgent\u5224\u5b9a\n\n* [\u30ac\u30e9\u30b1\u30fc\u3068IE6\u301c10\u3092\u9664\u5916\u3057\u305f\u3044\u5834\u5408\u3001UserAgent\u306b Gecko \u304c\u7121\u3044\u3053\u3068\u3067\u5224\u5b9a\u3059\u308c\u3070\u3088\u3055\u305d\u3046 - Qiita](http://qiita.com/tukiyo3/items/a1b3dea2cd19f93a07e1)\n\n```php\nfunction is_office() {\n\t$office = array(\"192.168.10.2\",\"22.22.22.22\");\n\tif (! in_array($_SERVER['REMOTE_ADDR'], $office)) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n```\n\n# \u30d5\u30a1\u30a4\u30eb\u306eupload\n\n## \u7d20\u306ephp\n\n* [PHP: POST method uploads - Manual](http://php.net/manual/en/features.file-upload.post-method.php#example-354)\n\ntmp\u30d5\u30a9\u30eb\u30c0\u3092777\u3067\u4f5c\u3063\u3066\u304a\u304f\u3002\n\n```html:index.html\n<form action=\"upload.php\" method=\"post\" enctype=\"multipart/form-data\">\n  <input type=\"file\" name=\"file\" />\n  <input type=submit />\n</form>\n```\n\n```php:upload.php\n<?php\nif ($file = $_FILES['file']) {\n    $target = __DIR__ . \"/tmp/\" . $file['name'];\n    move_uploaded_file($file['tmp_name'], $target);\n    echo \"upload success.\";\n} else {\n    echo \"upload failure.\";\n}\n```\n\n\n## dropzone.js\n\n* [Dropzone.js](http://www.dropzonejs.com/#installation)\n\n![Selection_011.png](https://qiita-image-store.s3.amazonaws.com/0/25728/a5f5e617-a107-bebf-5a14-c151f8306ea9.png)\n\n\n```bash:\ngit clone https://github.com/enyo/dropzone.git\n```\n\n```html:indexdropzone.php\n<link rel=\"stylesheet\" type=\"text/css\" href=\"dropzone/dist/basic.css\">\n<link rel=\"stylesheet\" type=\"text/css\" href=\"dropzone/dist/dropzone.css\">\n<script src=\"dropzone/dist/dropzone.js\"></script>\n\n<ul>\n<?php\necho sprintf(\"<li>upload limit: %s\", ini_get(\"upload_max_filesize\"));\necho sprintf(\"<li>post limit: %s\", ini_get(\"post_max_size\"));\n?>\n</ul>\n\n<form action=\"upload.php\" class=\"dropzone\">\n    <div id=\"dropzone\"></div>\n</form>\n```\n\nupload.php \u306f\u4e0a\u3067\u6e96\u5099\u3057\u305f\u3082\u306e\u3067\u3088\u3044\u3002\n\u30c9\u30e9\u30b0\u30a2\u30f3\u30c9\u30c9\u30ed\u30c3\u30d7\u3067upload\u304c\u5b8c\u4e86\u3059\u308b\u3002\n\n----\n\n# \u65e5\u4ed8\u3092\u66dc\u65e5\u306b\u5909\u63db\n\n* [PHP: date - Manual](http://php.net/manual/ja/function.date.php)\n\n```php:\n$yymmdd = \"2015-12-23\";\n\n$weekno = date(\"N\", strtotime($yymmdd))-1;\n$weeks = array(\"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"sat\", \"sun\");\necho $weeks[$weekno];\n```\n\n## \u4e00\u9031\u9593\u5f8c\u306e\u65e5\u4ed8\u53d6\u5f97\n\n```php:\n$dtime = strtotime(\"+1 week\");\necho date(\"Y-m-d\" ,$dtime);\n```\n\n----\n\n# \u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\n\n* [PHP: session_save_path - Manual](http://php.net/manual/ja/function.session-save-path.php)\n* [Cookie\u3068\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u3061\u3083\u3093\u3068\u7406\u89e3\u3059\u308b(PHP) - Qiita](http://qiita.com/hiroshi_takezawa/items/07136ad74127999df271)\n\n```bash:session\u306f\u4ee5\u4e0b\u306b\u4fdd\u5b58\u3055\u308c\u308b\n$ grep session.save_path /etc/php5/cli/php.ini\n;session.save_path = \"/var/lib/php5/sessions\"\n```\n\n* /var/lib/php5/sessions/\n  * sess_FIXED\n \n* [PHP - \u53c2\u8003\u306b\u306a\u3089\u306a\u3044\u307b\u3069\u30b7\u30f3\u30d7\u30eb\u306a\u63b2\u793a\u677f - Qiita](http://qiita.com/fernet/items/dbe469195647ff591a27)\u306e\u4e00\u90e8\u3092\u629c\u7c8b\u3059\u308b\u3068\n\n```php:FIXED\u3068\u3044\u3046ID\u3092\u6307\u5b9a\nsession_id('FIXED');\n```\n\n\u3053\u3046\u3059\u308b\u3068 `/var/lib/php5/sessions/sess_FIXED`\u306b\u30c7\u30fc\u30bf\u304c\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5f62\u5f0f\u3067\u4fdd\u5b58\u3055\u308c\u308b\u3002\n\n```bash:/var/lib/php5/sessions/sess_FIXED\nlog|a:5:{i:0;s:3:\"\u304a\";i:1;s:3:\"\u3048\";i:2;s:3:\"\u3046\";i:3;s:3:\"\u3044\";i:4;s:6:\"\u3042\u3042\";}#\n```\n\n```php:\nsession_start();\nif (($msg = (string)filter_input(INPUT_POST, 'msg')) !== '') {\n  $_SESSION['log'][] = $msg;\n  $_SESSION['log'] = array_slice($_SESSION['log'], -100);\n```\n\n* [memcached\u3092\u5229\u7528\u3057\u3066\u3001\u8907\u6570\u30b5\u30fc\u30d0\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u5171\u6709\u5316 | \u30ca\u30d3\u3055\u3093\u306e\u65e5\u8a18\u3068\u304b\u3002](http://navi-local.com/article/memcached%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%80%81%E8%A4%87%E6%95%B0%E3%82%B5%E3%83%BC%E3%83%90%E3%81%AE%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E5%85%B1%E6%9C%89%E5%8C%96/)\n* [PHP\u30bb\u30c3\u30b7\u30e7\u30f3\u3092memcached\u3067\u7ba1\u7406\u3059\u308b\u4ef6 - Qiita](http://qiita.com/supertaihei02/items/53e36252afa3ea157d38)\n* [#9 php\u306esession store\u3092redis\u306b\u3059\u308b - rrreeeyyy.com](http://rrreeeyyy.com/blog/2012/06/12/9-php-session-store-redis/)\n\n* \u305d\u306e\u4ed6\u30e1\u30e2\n    * \u5225\u30b5\u30a4\u30c8\u3067\u3042\u308b\u306a\u3089Cookie\u304c\u4f7f\u3048\u306a\u3044\u3002\n    * \u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\u540c\u58eb\u306a\u3089\u3001\u6709\u52b9\u7bc4\u56f2\u3092\u540c\u4e00\u30c9\u30e1\u30a4\u30f3\u307e\u3067\u8a31\u305b\u3070\u3088\u3044...\n    * \u72ec\u81ea\u306e\u30c9\u30e1\u30a4\u30f3\u306a\u3089\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30ec\u30f3\u30bf\u30eb\u30b5\u30fc\u30d0\u306a\u3069\u3067\u306f\u6709\u308a\u5f97\u306a\u3044\n    * \u30bb\u30c3\u30b7\u30e7\u30f3\u60c5\u5831\u3092\u30af\u30c3\u30ad\u30fc\u306b\u6301\u305f\u305b\u308b\u306a\u308aNFS\u3084\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u6301\u305f\u305b\u308b\n"}