{"tags": ["ShellScript", "Mac", "boot2docker", "proxy", "netcat"], "context": " More than 1 year has passed since last update.\n\ntl;dr\n\n\u8d77\u52d5\n# 8080\u306b\u6765\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u3092192.168.59.103:8080\u306b\u6d41\u3059\n# \u30ea\u30af\u30a8\u30b9\u30c8\u4fdd\u5b58\u5148: outgoing.log\n# \u30ec\u30b9\u30dd\u30f3\u30b9\u4fdd\u5b58\u5148: incoming.log\nwhile :; do [[ -p fifo ]] || mkfifo fifo && nc -l 8080 < fifo | tee outgoing.log | nc 192.168.59.103 8080 | tee fifo > incoming.log; done\n# ^C\u3067\u7d42\u4e86\n\n\n\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\n\nBoot2Docker\u3067nginx\u3092\u8d77\u52d5\u3057\u3066\u624b\u5143\u306e\u30b9\u30de\u30db\u304b\u3089\u30a2\u30af\u30bb\u30b9\n# nginx\u8d77\u52d5\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\ndocker run -d --name nginx -p 8080:80 -v $DIR_PATH_DOCUMENT_ROOT:/usr/share/nginx/html:ro nginx\n\n# \u30d7\u30ed\u30ad\u30b7\u958b\u59cb\nwhile :; do [[ -p fifo ]] || mkfifo fifo && nc -l 8080 < fifo | tee outgoing.log | nc `boot2docker ip` 8080 | tee fifo > incoming.log; done\n\n#### \u5225\u306e\u30b7\u30a7\u30eb\u3092\u958b\u304f\n# \u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u3067LISTEN\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\nnetstat -anf inet | grep LISTEN | grep 8080\n\n# \u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u306eIP\u3092\u78ba\u8a8d\nLOCAL_IP=`ifconfig en0 | grep \"inet[^6]\" | cut -d\" \" -f2`\n\n# \u30a2\u30af\u30bb\u30b9\u5148\u30a2\u30c9\u30ec\u30b9\u3092\u8868\u793a\necho http://$LOCAL_IP/\n\nPC\u3068\u30b9\u30de\u30db\u304c\u540c\u3058LAN\u306b\u63a5\u7d9a\u3057\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nPC\u306eChrome\u3067\u958b\u3051\u3070\u3001\u30b9\u30de\u30db\u306eChrome\u306e\u5c65\u6b74\u304b\u3089\u3001PC\u3067\u958b\u3044\u305f\u30a2\u30c9\u30ec\u30b9\u3092\u958b\u304f\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n\u53c2\u8003URL\nhttp://notes.tweakblogs.net/blog/7955/using-netcat-to-build-a-simple-tcp-proxy-in-linux.html\n# tl;dr\n\n## \u8d77\u52d5\n\n```\n# 8080\u306b\u6765\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u3092192.168.59.103:8080\u306b\u6d41\u3059\n# \u30ea\u30af\u30a8\u30b9\u30c8\u4fdd\u5b58\u5148: outgoing.log\n# \u30ec\u30b9\u30dd\u30f3\u30b9\u4fdd\u5b58\u5148: incoming.log\nwhile :; do [[ -p fifo ]] || mkfifo fifo && nc -l 8080 < fifo | tee outgoing.log | nc 192.168.59.103 8080 | tee fifo > incoming.log; done\n# ^C\u3067\u7d42\u4e86\n```\n\n# \u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\n## Boot2Docker\u3067nginx\u3092\u8d77\u52d5\u3057\u3066\u624b\u5143\u306e\u30b9\u30de\u30db\u304b\u3089\u30a2\u30af\u30bb\u30b9\n\n```\n# nginx\u8d77\u52d5\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\ndocker run -d --name nginx -p 8080:80 -v $DIR_PATH_DOCUMENT_ROOT:/usr/share/nginx/html:ro nginx\n\n# \u30d7\u30ed\u30ad\u30b7\u958b\u59cb\nwhile :; do [[ -p fifo ]] || mkfifo fifo && nc -l 8080 < fifo | tee outgoing.log | nc `boot2docker ip` 8080 | tee fifo > incoming.log; done\n\n#### \u5225\u306e\u30b7\u30a7\u30eb\u3092\u958b\u304f\n# \u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u3067LISTEN\u3057\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\nnetstat -anf inet | grep LISTEN | grep 8080\n\n# \u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u306eIP\u3092\u78ba\u8a8d\nLOCAL_IP=`ifconfig en0 | grep \"inet[^6]\" | cut -d\" \" -f2`\n\n# \u30a2\u30af\u30bb\u30b9\u5148\u30a2\u30c9\u30ec\u30b9\u3092\u8868\u793a\necho http://$LOCAL_IP/\n```\nPC\u3068\u30b9\u30de\u30db\u304c\u540c\u3058LAN\u306b\u63a5\u7d9a\u3057\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nPC\u306eChrome\u3067\u958b\u3051\u3070\u3001\u30b9\u30de\u30db\u306eChrome\u306e\u5c65\u6b74\u304b\u3089\u3001PC\u3067\u958b\u3044\u305f\u30a2\u30c9\u30ec\u30b9\u3092\u958b\u304f\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n# \u53c2\u8003URL\nhttp://notes.tweakblogs.net/blog/7955/using-netcat-to-build-a-simple-tcp-proxy-in-linux.html\n"}