{"tags": ["Rails4", "pow"], "context": " More than 1 year has passed since last update.\n\npow\u304c\u4f7f\u3048\u306a\u304f\u3066\u8a70\u307e\u308b(\u89e3\u6c7a\u7de8\uff09\u30fb\u30fb\u30fb\u3001\u304c\u89e3\u6c7a\u3057\u3066\u306a\u304b\u3063\u305f\u554f\u984c\n\u30dd\u30fc\u30c8\u306b20559\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u307e\u305f\u52d5\u304b\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u30fb\u30fb\u30fb\u3002\n\u518d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u8272\u3005\u3068\u78ba\u8a8d\u3067\u3059\u3002\n$ launchctl list | grep -i pow\nPID    status   Label\n407     0       cx.pow.powd\n-       0       com.apple.powerchime\n\ncx.pow.firewall\u306e\u30c7\u30fc\u30e2\u30f3\u304c\u52d5\u3044\u3066\u306a\u3044\u307f\u305f\u3044\u3001\n\u3063\u3068\u601d\u3044\u304d\u3084\u3069\u3046\u3084\u3089\u30c7\u30fc\u30e2\u30f3\u306b\u3082\u7a2e\u985e\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\u53c2\u8003\u30b5\u30a4\u30c8\nlaunchctl list\u30b3\u30de\u30f3\u30c9\u3067\u3067\u3066\u304f\u308b\u3082\u306e\u306froot\u6a29\u9650\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\u3082\u306e\u3067\u3001\nroot\u6a29\u9650\u3067\u52d5\u3044\u3066\u3044\u308b\u30c7\u30fc\u30e2\u30f3\u9054\u3092\u307f\u305f\u3051\u308c\u3070sudo launchctl list\u30b3\u30de\u30f3\u30c9\u3067\u898b\u3089\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n$ sudo launchctl list\u3000| grep -i pow\nPID    status   Label\n48  0   com.apple.powerd\n-   0   cx.pow.firewall\n-   0   com.apple.powerd.swd\n\nPID\u306b\u756a\u53f7\u304c\u3042\u308b\u3082\u306e\u306f\u8d77\u52d5\u3057\u3066\u3044\u3066\u3001status\u304c0\u306a\u3089\u6b63\u5e38\u306e\u3088\u3046\u3067\u3059\u3002\ncx.pow.firewall\u306ePID\u304c\u306a\u3044\u306e\u3067\u52d5\u3044\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\u53c2\u8003\u30b5\u30a4\u30c8\n\u3044\u3064\u3082\u306epowder config\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3002\ndstPort      80\nhttpPort     20559\ndnsPort      20560\ntimeout      900\nworkers      2\ndomains      dev\nextDomains\n\n\u3053\u3053\u306edstPort\u306e\u30dd\u30fc\u30c8\u756a\u53f7\u306f\u3001\n\n~/.powconfig\nexport POW_DOMAINS=dev\nexport POW_DST_PORT=80\n\n\n\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u5909\u66f4\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\u306a\u304f\u3066\u3082\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u304c\u5165\u308b\u306e\u3067\u554f\u984c\u306a\u3044\u3067\u3059\u3002\n\u6700\u5f8c\u306bcx.pow.firewall.plist\u30c7\u30fc\u30e2\u30f3\u306e\u78ba\u8a8d\u3002\n/Library/LaunchDaemons/cx.pow.firewall.plist\n\ncx.pow.firewall.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n        <key>Label</key>\n        <string>cx.pow.firewall</string>\n        <key>ProgramArguments</key>\n        <array>\n                <string>/bin/sh</string>\n                <string>-c</string>\n                <string>\n                  sysctl -w net.inet.ip.forwarding=1;\n                  echo \"rdr pass proto tcp from any to any port {80,20559} -> 127.0.0.1 port 20559\" | pfctl -a \"com.apple/250.PowFirewall\" -Ef -\n                </string>\n        </array>\n        <key>RunAtLoad</key>\n        <true/>\n        <key>UserName</key>\n        <string>root</string>\n</dict>\n</plist>\n\n\n\"rdr pass proto tcp from any to any port {80,20559} -> 127.0.0.1 port 20559\"\n\u3053\u3053\u306fdstPort\u3068\u540c\u3058\u30dd\u30fc\u30c8\u3092\u6307\u3057\u3066\u3044\u308c\u3070\u5927\u4e08\u592b\u3063\u307d\u3044\u3067\u3059\u3002\n\ncx.pow.firewall\u30c7\u30fc\u30e2\u30f3\u3092\u8d77\u3053\u3059\n\u53c2\u8003\u30b5\u30a4\u30c8\n\nlaunchctl \u306e\u4f7f\u7528\u4f8b\nOS \u30d6\u30fc\u30c8\u6642\u306b launchd \u304c load \u3057\u3066\u3044\u308b\u30b8\u30e7\u30d6\u306f\u3001root \u6a29\u9650\u3067\u64cd\u4f5c\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nLaunchDaemon \u306e\u8d77\u52d5\u65b9\u6cd5\nlaunchctl \u30b3\u30de\u30f3\u30c9\u3067 launchd.plist \u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30c9\u3059\u308b\u3002\nload, unload \u3059\u308b\u3068\u304d\u306f launchd.plist \u306e\u6307\u5b9a\u3092\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\uff08\u30d5\u30eb\u30d1\u30b9\uff09\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u3053\u3053\u306b\u5f53\u3066\u306f\u307e\u308b\u3068\u601d\u3046\u306e\u3067\u3001\n$ sudo launchctl load /Library/LaunchDaemons/cx.pow.firewall.plist\n\u3092\u5b9f\u884c\u3002\n/Library/LaunchDaemons/cx.pow.firewall.plist: Operation already in progress\n\u3093\u301c\u3001\u3082\u3046\u52d5\u3044\u3066\u308b\u3088\u7684\u306a\u610f\u5473\uff1f\u3067\u3059\u304b\u306d\u3002\n\u518d\u5ea6\u78ba\u8a8d\u3002\n$ sudo launchctl list\u3000| grep -i pow\nPID    status   Label\n48  0   com.apple.powerd\n-   0   cx.pow.firewall\n-   0   com.apple.powerd.swd\n\nPID\u304c\u4ed8\u3044\u3066\u306a\u3044\u306e\u3067\u6e96\u5099\u306f\u3067\u304d\u3066\u3044\u3066\u3082\u3001\u52d5\u3044\u3066\u306a\u3044\u3063\u307d\u3044\u3067\u3059\u306d\u3002\npowder open\u3057\u3066\u3082\u30dd\u30fc\u30c820559\u3092\u3064\u3051\u306a\u3044\u3068\u52d5\u304b\u305a\u30fb\u30fb\u30fb\u3002\n\u3061\u3087\u3063\u3068\u6642\u9593\u5207\u308c\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\nlaunchctl\u30b3\u30de\u30f3\u30c9\u306b\u3064\u3044\u3066\u6b21\u306f\u8abf\u3079\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n## pow\u304c\u4f7f\u3048\u306a\u304f\u3066\u8a70\u307e\u308b(\u89e3\u6c7a\u7de8\uff09\u30fb\u30fb\u30fb\u3001\u304c\u89e3\u6c7a\u3057\u3066\u306a\u304b\u3063\u305f\u554f\u984c\n\n\u30dd\u30fc\u30c8\u306b20559\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u307e\u305f\u52d5\u304b\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u30fb\u30fb\u30fb\u3002\n\u518d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u8272\u3005\u3068\u78ba\u8a8d\u3067\u3059\u3002\n\n```\n$ launchctl list | grep -i pow\nPID    status   Label\n407    \t0    \tcx.pow.powd\n-     \t0    \tcom.apple.powerchime\n```\n\ncx.pow.firewall\u306e\u30c7\u30fc\u30e2\u30f3\u304c\u52d5\u3044\u3066\u306a\u3044\u307f\u305f\u3044\u3001\n\u3063\u3068\u601d\u3044\u304d\u3084\u3069\u3046\u3084\u3089\u30c7\u30fc\u30e2\u30f3\u306b\u3082\u7a2e\u985e\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n[\u53c2\u8003\u30b5\u30a4\u30c8](http://d.hatena.ne.jp/kanonji/20100621/1277075926)\n\n`launchctl list`\u30b3\u30de\u30f3\u30c9\u3067\u3067\u3066\u304f\u308b\u3082\u306e\u306froot\u6a29\u9650\u3092\u5fc5\u8981\u3068\u3057\u306a\u3044\u3082\u306e\u3067\u3001\nroot\u6a29\u9650\u3067\u52d5\u3044\u3066\u3044\u308b\u30c7\u30fc\u30e2\u30f3\u9054\u3092\u307f\u305f\u3051\u308c\u3070`sudo launchctl list`\u30b3\u30de\u30f3\u30c9\u3067\u898b\u3089\u308c\u308b\u3088\u3046\u3067\u3059\u3002\n\n```\n$ sudo launchctl list\u3000| grep -i pow\nPID    status   Label\n48\t0\tcom.apple.powerd\n-\t0\tcx.pow.firewall\n-\t0\tcom.apple.powerd.swd\n```\n\nPID\u306b\u756a\u53f7\u304c\u3042\u308b\u3082\u306e\u306f\u8d77\u52d5\u3057\u3066\u3044\u3066\u3001status\u304c0\u306a\u3089\u6b63\u5e38\u306e\u3088\u3046\u3067\u3059\u3002\n`cx.pow.firewall`\u306ePID\u304c\u306a\u3044\u306e\u3067\u52d5\u3044\u3066\u3044\u306a\u3044\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n[\u53c2\u8003\u30b5\u30a4\u30c8](https://monkeying11.wordpress.com/2011/08/10/macports%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/)\n\n\u3044\u3064\u3082\u306e`powder config`\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3002\n\n```\ndstPort      80\nhttpPort     20559\ndnsPort      20560\ntimeout      900\nworkers      2\ndomains      dev\nextDomains\n```\n\n\u3053\u3053\u306edstPort\u306e\u30dd\u30fc\u30c8\u756a\u53f7\u306f\u3001\n\n```lang:~/.powconfig\nexport POW_DOMAINS=dev\nexport POW_DST_PORT=80\n```\n\n\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u5909\u66f4\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\u306a\u304f\u3066\u3082\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u304c\u5165\u308b\u306e\u3067\u554f\u984c\u306a\u3044\u3067\u3059\u3002\n\n\u6700\u5f8c\u306bcx.pow.firewall.plist\u30c7\u30fc\u30e2\u30f3\u306e\u78ba\u8a8d\u3002\n\n/Library/LaunchDaemons/cx.pow.firewall.plist\n\n```lang:cx.pow.firewall.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n        <key>Label</key>\n        <string>cx.pow.firewall</string>\n        <key>ProgramArguments</key>\n        <array>\n                <string>/bin/sh</string>\n                <string>-c</string>\n                <string>\n                  sysctl -w net.inet.ip.forwarding=1;\n                  echo \"rdr pass proto tcp from any to any port {80,20559} -> 127.0.0.1 port 20559\" | pfctl -a \"com.apple/250.PowFirewall\" -Ef -\n                </string>\n        </array>\n        <key>RunAtLoad</key>\n        <true/>\n        <key>UserName</key>\n        <string>root</string>\n</dict>\n</plist>\n```\n\n`\"rdr pass proto tcp from any to any port {80,20559} -> 127.0.0.1 port 20559\"`\n\u3053\u3053\u306fdstPort\u3068\u540c\u3058\u30dd\u30fc\u30c8\u3092\u6307\u3057\u3066\u3044\u308c\u3070\u5927\u4e08\u592b\u3063\u307d\u3044\u3067\u3059\u3002\n\n## `cx.pow.firewall`\u30c7\u30fc\u30e2\u30f3\u3092\u8d77\u3053\u3059\n\n[\u53c2\u8003\u30b5\u30a4\u30c8](http://www.maruko2.com/mw/LaunchDaemons_(launchctl,_launchd.plist)_%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9)\n\n\n> launchctl \u306e\u4f7f\u7528\u4f8b\nOS \u30d6\u30fc\u30c8\u6642\u306b launchd \u304c load \u3057\u3066\u3044\u308b\u30b8\u30e7\u30d6\u306f\u3001root \u6a29\u9650\u3067\u64cd\u4f5c\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nLaunchDaemon \u306e\u8d77\u52d5\u65b9\u6cd5\nlaunchctl \u30b3\u30de\u30f3\u30c9\u3067 launchd.plist \u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30c9\u3059\u308b\u3002\nload, unload \u3059\u308b\u3068\u304d\u306f launchd.plist \u306e\u6307\u5b9a\u3092\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\uff08\u30d5\u30eb\u30d1\u30b9\uff09\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u3053\u3053\u306b\u5f53\u3066\u306f\u307e\u308b\u3068\u601d\u3046\u306e\u3067\u3001\n`$ sudo launchctl load /Library/LaunchDaemons/cx.pow.firewall.plist`\n\u3092\u5b9f\u884c\u3002\n\n`/Library/LaunchDaemons/cx.pow.firewall.plist: Operation already in progress`\n\u3093\u301c\u3001\u3082\u3046\u52d5\u3044\u3066\u308b\u3088\u7684\u306a\u610f\u5473\uff1f\u3067\u3059\u304b\u306d\u3002\n\u518d\u5ea6\u78ba\u8a8d\u3002\n\n```\n$ sudo launchctl list\u3000| grep -i pow\nPID    status   Label\n48\t0\tcom.apple.powerd\n-\t0\tcx.pow.firewall\n-\t0\tcom.apple.powerd.swd\n```\n\nPID\u304c\u4ed8\u3044\u3066\u306a\u3044\u306e\u3067\u6e96\u5099\u306f\u3067\u304d\u3066\u3044\u3066\u3082\u3001\u52d5\u3044\u3066\u306a\u3044\u3063\u307d\u3044\u3067\u3059\u306d\u3002\n`powder open`\u3057\u3066\u3082\u30dd\u30fc\u30c820559\u3092\u3064\u3051\u306a\u3044\u3068\u52d5\u304b\u305a\u30fb\u30fb\u30fb\u3002\n\n\u3061\u3087\u3063\u3068\u6642\u9593\u5207\u308c\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\nlaunchctl\u30b3\u30de\u30f3\u30c9\u306b\u3064\u3044\u3066\u6b21\u306f\u8abf\u3079\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n"}