{"context": " More than 1 year has passed since last update.\n\nTomcat \u306e\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u53d6\u5f97\u3057\u3066\u3001\u3054\u306b\u3087\u3054\u306b\u3087\u3057\u305f\uff5e\u3044\uff01\n\u3053\u3093\u306a\u3093\u3067\u826f\u3044\u306e\u3067\u3057\u3087\u3046\u304b\u306d...?\n\u3053\u308c\u3060\u3051\u3060\u3068\u4f7f\u3048\u306a\u30fc\u3044\u3082\u306e\u3060\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u4f55\u304b\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3068\u4f7f\u3048\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\u3068\u308a\u3042\u3048\u305a\u3001Tomcat 6.0.43 \u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\u3067\u3059\u3002\n\nget_tomcat_sid.sh\n#!/bin/bash\n\n###\n# usage\n# ./get_tomcat_sid.sh -h host -p port context user password\n###\n\nHOST=localhost\nPORT=8080\n\nwhile getopts :h:p: OPT\ndo\n    case ${OPT} in\n    h)\n        HOST=${OPTARG}\n        ;;\n    p)\n        PORT=${OPTARG}\n        ;;\n    esac\ndone\n\nshift $((OPTIND - 1))\n\nCONTEXT=$1\nUSER=$2\nPASSWORD=$3\n\n#echo ${HOST}\n#echo ${PORT}\n#echo ${CONTEXT}\n#echo ${USER}\n#echo ${PASSWORD}\n\nBASIC_AUTH=$(echo -n \"${USER}:${PASSWORD}\" | base64)\n\nURL_MANAGER=\"http://${HOST}:${PORT}/manager/html\"\nHEADER_AUTH=\"Authorization:Basic ${BASIC_AUTH}\"\n\nTOKEN=\"$(curl -s \"${URL_MANAGER}\" -H \"${HEADER_AUTH}\" | grep \"sessions.*path=/${CONTEXT}\")\"\n\n#echo ${TOKEN}\n\nJSESSIONID=$(echo \"${TOKEN}\" | sed 's/.*jsessionid=\\(.*\\)?path.*/\\1/')\nCSRF_NONCE=$(echo \"${TOKEN}\" | sed 's/.*CSRF_NONCE=\\(.*\\)\".*/\\1/')\n\necho \"JSESSIONID=${JSESSIONID}\"\necho \"CSRF_NONCE=${CSRF_NONCE}\"\n\nURL=\"${URL_MANAGER}/sessions?path=/${CONTEXT}&org.apache.catalina.filters.CSRF_NONCE=${CSRF_NONCE}\"\nHEADER_COOKIE=\"Cookie: JSESSIONID=${JSESSIONID}\"\n\n# curl -vs \u3060\u3068\u3001\u30d8\u30c3\u30c0\u6bd4\u8f03\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u305f\ncurl -s \"${URL}\" -H \"${HEADER_AUTH}\" -H \"${HEADER_COOKIE}\" | grep sessionIds | sed -e 's/^.*value=\"\\(.*\\)\".*\\/>.*$/\\1/' > sidlist\n\n# \u3042\u3068\u306f\u3001sidlist \u3092\u3088\u3057\u306a\u306b\u3002\n\n\n#Tomcat \u306e\u30bb\u30c3\u30b7\u30e7\u30f3ID\u3092\u53d6\u5f97\u3057\u3066\u3001\u3054\u306b\u3087\u3054\u306b\u3087\u3057\u305f\uff5e\u3044\uff01\n\u3053\u3093\u306a\u3093\u3067\u826f\u3044\u306e\u3067\u3057\u3087\u3046\u304b\u306d...?\n\u3053\u308c\u3060\u3051\u3060\u3068\u4f7f\u3048\u306a\u30fc\u3044\u3082\u306e\u3060\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u4f55\u304b\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3068\u4f7f\u3048\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\u3068\u308a\u3042\u3048\u305a\u3001Tomcat 6.0.43 \u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\u3067\u3059\u3002\n\n```bash:get_tomcat_sid.sh\n#!/bin/bash\n\n###\n# usage\n# ./get_tomcat_sid.sh -h host -p port context user password\n###\n\nHOST=localhost\nPORT=8080\n\nwhile getopts :h:p: OPT\ndo\n    case ${OPT} in\n    h)\n        HOST=${OPTARG}\n        ;;\n    p)\n        PORT=${OPTARG}\n        ;;\n    esac\ndone\n\nshift $((OPTIND - 1))\n\nCONTEXT=$1\nUSER=$2\nPASSWORD=$3\n\n#echo ${HOST}\n#echo ${PORT}\n#echo ${CONTEXT}\n#echo ${USER}\n#echo ${PASSWORD}\n\nBASIC_AUTH=$(echo -n \"${USER}:${PASSWORD}\" | base64)\n\nURL_MANAGER=\"http://${HOST}:${PORT}/manager/html\"\nHEADER_AUTH=\"Authorization:Basic ${BASIC_AUTH}\"\n\nTOKEN=\"$(curl -s \"${URL_MANAGER}\" -H \"${HEADER_AUTH}\" | grep \"sessions.*path=/${CONTEXT}\")\"\n\n#echo ${TOKEN}\n\nJSESSIONID=$(echo \"${TOKEN}\" | sed 's/.*jsessionid=\\(.*\\)?path.*/\\1/')\nCSRF_NONCE=$(echo \"${TOKEN}\" | sed 's/.*CSRF_NONCE=\\(.*\\)\".*/\\1/')\n\necho \"JSESSIONID=${JSESSIONID}\"\necho \"CSRF_NONCE=${CSRF_NONCE}\"\n\nURL=\"${URL_MANAGER}/sessions?path=/${CONTEXT}&org.apache.catalina.filters.CSRF_NONCE=${CSRF_NONCE}\"\nHEADER_COOKIE=\"Cookie: JSESSIONID=${JSESSIONID}\"\n\n# curl -vs \u3060\u3068\u3001\u30d8\u30c3\u30c0\u6bd4\u8f03\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u305f\ncurl -s \"${URL}\" -H \"${HEADER_AUTH}\" -H \"${HEADER_COOKIE}\" | grep sessionIds | sed -e 's/^.*value=\"\\(.*\\)\".*\\/>.*$/\\1/' > sidlist\n\n# \u3042\u3068\u306f\u3001sidlist \u3092\u3088\u3057\u306a\u306b\u3002\n```\n", "tags": ["Bash", "Tomcat", "AdventCalendar"]}