{"context": " More than 1 year has passed since last update.\n\n\u4e00\u8a00\u307e\u3068\u3081\ncounter \u578b\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\n\n\u8aac\u660e\n\nincrement/decrement \u3057\u305f\u3044\n\u3088\u304f\u3042\u308b\u4f8b\u3060\u3068\u3001PV\u3068\u304b\u30c4\u30a4\u30fc\u30c8\u6570\u3068\u304b\u304a\u6c17\u306b\u5165\u308a\u6570\u3068\u304b\u3002\n\u5358\u7d14\u306b\u6570\u3092\u4fdd\u6301\u3057\u3066\u3044\u308b\u3060\u3051\u306e\u30ab\u30e9\u30e0\u304c\u307b\u3057\u3044\u3053\u3068\u3063\u3066\u3088\u304f\u3042\u308a\u307e\u3059\u3088\u306d\u3002\n\u4f8b\u3048\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c6\u30fc\u30d6\u30eb\uff08ColumnFamily\uff09\u3092\u4f5c\u308a\u307e\u3059\u3002\nCREATE TABLE page_view_counts(\n  pv int,\n  url_name varchar,\n  page_name varchar,\n  PRIMARY KEY (url_name, page_name)\n);\n\n\u306f\u3044\u3001\u305d\u3053\u306e MySQL \u306b\u6163\u308c\u3066\u308b\u3042\u306a\u305f\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30af\u30a8\u30ea\u66f8\u3051\u3070\u3044\u3044\u3058\u3083\u3093\u3063\u3066\u601d\u3044\u307e\u3057\u305f\u304b\uff1f\nUPDATE page_view_counts\n SET pv = pv + 1\n WHERE url_name='www.datastax.com' AND page_name='home';\n\n\u7518\u3044\u3067\u3059\u3002CQL\u306f\u305d\u3093\u306a\u306b\u512a\u3057\u304f\u306a\u3044\u3067\u3059\u3002\nUPDATE page_view_counts SET pv = pv + 1 WHERE url_name='www.datastax.com' AND page_name='home';\n-> Bad Request: Invalid operation (pv = pv + 1) for non counter column legion\n\n\u6012\u3089\u308c\u3061\u3083\u3046\u3093\u3067\u3059\u306d\u3002\n\u3053\u308c\u3067\u306f\u3001 pv \u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3059\u308b\u305f\u3081\u3060\u3051\u306b\u308f\u3056\u308f\u3056\u73fe\u5728\u306e pv \u3092 select \u3057\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u3082\u51fa\u3066\u308b\u3088\u3046\u306b counter \u3068\u3044\u3046\u30c7\u30fc\u30bf\u30bf\u30a4\u30d7\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\nCREATE TABLE counterks.page_view_counts(\n  pv counter, // \u30b3\u30ec\n  url_name varchar,\n  page_name varchar,\n  PRIMARY KEY (url_name, page_name)\n);\n\n\u3082\u3046\u4e00\u5ea6\u3002\nUPDATE page_view_counts SET pv = pv + 1 WHERE url_name='www.datastax.com' AND page_name='home';\n-> OK\n\n\n\u53c2\u8003\nhttp://docs.datastax.com/en/cql/3.0/cql/cql_using/use_counter_t.html\n# \u4e00\u8a00\u307e\u3068\u3081\n\n`counter` \u578b\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\n\n# \u8aac\u660e\n## increment/decrement \u3057\u305f\u3044\n\n\u3088\u304f\u3042\u308b\u4f8b\u3060\u3068\u3001PV\u3068\u304b\u30c4\u30a4\u30fc\u30c8\u6570\u3068\u304b\u304a\u6c17\u306b\u5165\u308a\u6570\u3068\u304b\u3002\n\u5358\u7d14\u306b\u6570\u3092\u4fdd\u6301\u3057\u3066\u3044\u308b\u3060\u3051\u306e\u30ab\u30e9\u30e0\u304c\u307b\u3057\u3044\u3053\u3068\u3063\u3066\u3088\u304f\u3042\u308a\u307e\u3059\u3088\u306d\u3002\n\n\u4f8b\u3048\u3070\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c6\u30fc\u30d6\u30eb\uff08ColumnFamily\uff09\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n```\nCREATE TABLE page_view_counts(\n  pv int,\n  url_name varchar,\n  page_name varchar,\n  PRIMARY KEY (url_name, page_name)\n);\n```\n\n\u306f\u3044\u3001\u305d\u3053\u306e MySQL \u306b\u6163\u308c\u3066\u308b\u3042\u306a\u305f\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30af\u30a8\u30ea\u66f8\u3051\u3070\u3044\u3044\u3058\u3083\u3093\u3063\u3066\u601d\u3044\u307e\u3057\u305f\u304b\uff1f\n\n```\nUPDATE page_view_counts\n SET pv = pv + 1\n WHERE url_name='www.datastax.com' AND page_name='home';\n```\n\n\u7518\u3044\u3067\u3059\u3002CQL\u306f\u305d\u3093\u306a\u306b\u512a\u3057\u304f\u306a\u3044\u3067\u3059\u3002\n\n```\nUPDATE page_view_counts SET pv = pv + 1 WHERE url_name='www.datastax.com' AND page_name='home';\n-> Bad Request: Invalid operation (pv = pv + 1) for non counter column legion\n```\n\n\u6012\u3089\u308c\u3061\u3083\u3046\u3093\u3067\u3059\u306d\u3002\n\u3053\u308c\u3067\u306f\u3001 `pv` \u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3059\u308b\u305f\u3081\u3060\u3051\u306b\u308f\u3056\u308f\u3056\u73fe\u5728\u306e `pv` \u3092 `select` \u3057\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n \n\n\u305d\u3053\u3067\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306b\u3082\u51fa\u3066\u308b\u3088\u3046\u306b `counter` \u3068\u3044\u3046\u30c7\u30fc\u30bf\u30bf\u30a4\u30d7\u3092\u4f7f\u3044\u307e\u3057\u3087\u3046\u3002\n\n```\nCREATE TABLE counterks.page_view_counts(\n  pv counter, // \u30b3\u30ec\n  url_name varchar,\n  page_name varchar,\n  PRIMARY KEY (url_name, page_name)\n);\n```\n\n\u3082\u3046\u4e00\u5ea6\u3002\n\n```\nUPDATE page_view_counts SET pv = pv + 1 WHERE url_name='www.datastax.com' AND page_name='home';\n-> OK\n```\n\n# \u53c2\u8003\n\nhttp://docs.datastax.com/en/cql/3.0/cql/cql_using/use_counter_t.html\n", "tags": ["Cassandra2.0"]}