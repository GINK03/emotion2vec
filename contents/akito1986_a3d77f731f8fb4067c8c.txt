{"context": " More than 1 year has passed since last update.nginx\u306e\u30ed\u30b0\u3092fluentd\u3092\u7528\u3044\u3066TreasureData\u306b\u5165\u308c\u3066\u307f\u305f\u306e\u3067\u30e1\u30e2\u3057\u3066\u304a\u304f\u3002\n\n\u80cc\u666f\nTreasureData\u3092\u4f7f\u3063\u3066\u307f\u305f\u3067\u66f8\u3044\u305f\u306e\u3060\u304c\u3001\u8981\u306f\u30ed\u30b0\u306e\u7ba1\u7406\u304c\u9762\u5012\u3067\u3001\u5bb9\u91cf\u3068\u304b\u306e\u30ed\u30b0\u7ba1\u7406\u3092\u305b\u305a\u306b\u30ed\u30b0\u3092\u8caf\u3081\u305f\u3044\uff01\u3063\u3066\u306e\u304c\u3084\u308a\u305f\u3044\u3053\u3068\u3002\n\u305d\u308c\u3067\u7e01\u3042\u3063\u3066\u4e0a\u306e\u3084\u308a\u305f\u3044\u3053\u3068\u304cTreasureData\u3092\u4f7f\u3063\u3066\u3067\u304d\u308b\u304b\u3092\u78ba\u304b\u3081\u3066\u307f\u305f\u3063\u3066\u611f\u3058\u3002\n\u4ee5\u4e0b\u74b0\u5883\u60c5\u5831\u3002\n\nubuntu: 12.04\nruby: 2.1.2p95\ngem: 2.2.2\nnginx: nginx/1.1.19\n\nTreasureData\u306eAPI\u30ad\u30fc\u306f\u53d6\u5f97\u6e08\u307f\u3067\u3042\u308b\u3053\u3068\u3092\u524d\u63d0\u3068\u3059\u308b\u3002\nTreasureData\u3092\u4f7f\u3063\u3066\u307f\u305f\u3092\u53c2\u7167\u3002\n\nfluentd(td-agent)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067fluentd\u306e\u5b89\u5b9a\u7248\u3067\u3042\u308btd-agent\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\ninstall_td-agent\n$ curl -L http://toolbelt.treasuredata.com/sh/install-ubuntu-precise.sh | sh\n$ sudo td-agent --version\ntd-agent 0.10.50\n\n\n\nDB\u4f5c\u6210\n\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u5148\u306eDB\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\nTD Tool Belt\u3067TreasureData\u306b\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3002\n\nlogin_td\n$ td account -f\nEnter your Treasure Data credentials.\nEmail: ${my_addr}\nPassword (typing will be hidden): ${my_passwd} \nAuthenticated successfully.\nUse 'td db:create <db_name>' to create a database.\n$\n\n\nDB\u3092\u4f5c\u6210\u3059\u308b\u3002\n\ncreate_db\n$ td db:create nginx\n\n\n\ntd-agent\u306e\u8a2d\u5b9a\ntd-agent\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306enginx\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u304f\u308c\u3066\u308b\u3063\u307d\u3044\u306e\u3067\u8a2d\u5b9a\u306f\u7c21\u5358\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b/etc/td-agent/td-agent.conf\u3092\u7de8\u96c6\u3002\n\ntd-agent.conf\n# Tailing the Nginx Log\n<source>\n  type tail\n  path /var/log/nginx/access.log\n  pos_file /var/log/td-agent/nginx-access.pos\n  tag td.nginx.access\n  format nginx\n</source>\n\n# Treasure Data Input and Output\n<match td.*.*>\n  type tdlog\n  apikey ${my_td_api_key}\n  auto_create_table\n  buffer_type file\n  buffer_path /var/log/td-agent/buffer/td\n  endpoint ${td_endpoint}\n  flush_interval 10s\n  use_ssl true\n</match>\n\n\n\u4e0a\u8a18\u306e\u610f\u5473\u3067\u3059\u304c\u3001source type\u3067tail\u3092\u6307\u5b9a\u3057\u3066\u304a\u308a\u65b0\u898f\u3067\u8ffd\u52a0\u3055\u308c\u305f\u3082\u306e\u3092\u5bfe\u8c61\u3068\u3057\u3066\u3044\u308b\u3002\nsource path\u306f\u76e3\u8996\u5bfe\u8c61\u306e\u30d1\u30b9\u3001source tag\u3067\u30bf\u30b0\u4ed8\u3051\u3092\u3057\u3066\u3044\u307e\u3059\u3002td.nginx.access\u306fTreasureData\u4e0a\u306enginx\u3068\u3044\u3046DB\u306eaccess\u3068\u3044\u3046\u30c6\u30fc\u30d6\u30eb\u306b\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3059\u308b\u3053\u3068\u3092\u610f\u5473\u3059\u308b\u3002\nmatch\u306e\u65b9\u3067\u306fendpoint\u3067TreasureData\u306eAPI\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u6307\u5b9a\u3059\u308b\u3002AWS\u306e\u5834\u5408\u3060\u3068https://api.treasuredata.com\u3068\u306a\u308b\u3002\nflush_interval\u3067\u30c7\u30fc\u30bf\u9001\u51fa\u9593\u9694\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u30a4\u30f3\u30dd\u30fc\u30c8\n\u307e\u305a\u306fnginx\u3092\u8d77\u52d5\u3059\u308b\u3002\n\nstart_nginx\n$ sudo rm /var/log/nginx/access.log # \u524a\u9664\u3057\u3066\u304a\u304f\u3002\n$ sudo service nginx start\n\n\n\u6b21\u306btd-agent\u306e\u8d77\u52d5\u3002\n\nstart_td-agent\n$ sudo /etc/init.d/td-agent start\n\n\nnginx\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3002\n\u5ff5\u306e\u305f\u30815\u56de\u3002\n\ncurl\n$ curl http://localhost\n$ curl http://localhost\n$ curl http://localhost\n$ curl http://localhost\n$ curl http://localhost\n$ sleep 10\n\n\n\ncheck_log\n$ sudo cat /var/log/nginx/access.log\n127.0.0.1 - - [14/Aug/2014:01:26:09 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n127.0.0.1 - - [14/Aug/2014:01:26:11 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n127.0.0.1 - - [14/Aug/2014:01:26:12 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n127.0.0.1 - - [14/Aug/2014:01:26:12 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n127.0.0.1 - - [14/Aug/2014:01:26:13 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n\n\n\n\u30a4\u30f3\u30dd\u30fc\u30c8\u78ba\u8a8d\n\u30a4\u30f3\u30dd\u30fc\u30c8\u78ba\u8a8d\u3002\n5\u4ef6\u306e\u30c7\u30fc\u30bf\u304c\u30a4\u30f3\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\ncheck_import_data\n$ td table:list nginx\n+----------+--------+------+-------+--------+---------------------------+---------------------------+-----------------------------------------------------------------------------------------------------------------------------+\n| Database | Table  | Type | Count | Size   | Last import               | Last log timestamp        | Schema                                                                                                                      |\n+----------+--------+------+-------+--------+---------------------------+---------------------------+-----------------------------------------------------------------------------------------------------------------------------+\n| nginx    | access | log  | 5     | 0.0 GB | 2014-08-14 01:26:13 +0900 | 2014-08-14 01:26:13 +0900 | host:string, path:string, method:string, referer:string, code:string, remote:string, agent:string, user:string, size:string |\n+----------+--------+------+-------+--------+---------------------------+---------------------------+-----------------------------------------------------------------------------------------------------------------------------+\n\n\n\u5185\u5bb9\u3082\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\ntd_query\n$ td query -w -t hive -d nginx \"SELECT * FROM access\"\n+------+------+--------+---------+------+-----------+-----------------------------------------------------------------------------------------------------+------+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+\n| host | path | method | referer | code | remote    | agent                                                                                               | user | size | v                                                                                                                                                                                                                                                | time       |\n+------+------+--------+---------+------+-----------+-----------------------------------------------------------------------------------------------------+------+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"time\":\"1407947169\",\"remote\":\"127.0.0.1\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947169 |\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"remote\":\"127.0.0.1\",\"time\":\"1407947171\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947171 |\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"remote\":\"127.0.0.1\",\"time\":\"1407947172\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947172 |\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"remote\":\"127.0.0.1\",\"time\":\"1407947172\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947172 |\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"remote\":\"127.0.0.1\",\"time\":\"1407947173\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947173 |\n+------+------+--------+---------+------+-----------+-----------------------------------------------------------------------------------------------------+------+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+\n5 rows in set\n\n\n\u3075\u3080\u3075\u3080\u3001\u3061\u3083\u3093\u3068\u5404\u30ab\u30e9\u30e0\u306b\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u308b\u3063\u307d\u3044\u3002\n\u6b21\u56de\u306f\u72ec\u81ea\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u30ed\u30b0\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u8a2d\u5b9a\u306b\u3064\u3044\u3066\u8a18\u8f09\u3059\u308b\u3064\u3082\u308a\u3002\n\u304a\u3057\u307e\u3044\u3002\n\nnginx\u306e\u30ed\u30b0\u3092fluentd\u3092\u7528\u3044\u3066TreasureData\u306b\u5165\u308c\u3066\u307f\u305f\u306e\u3067\u30e1\u30e2\u3057\u3066\u304a\u304f\u3002\n\n## \u80cc\u666f\n[TreasureData\u3092\u4f7f\u3063\u3066\u307f\u305f](http://qiita.com/akito1986/items/4c83ff492ed4b390ad50)\u3067\u66f8\u3044\u305f\u306e\u3060\u304c\u3001\u8981\u306f\u30ed\u30b0\u306e\u7ba1\u7406\u304c\u9762\u5012\u3067\u3001\u5bb9\u91cf\u3068\u304b\u306e\u30ed\u30b0\u7ba1\u7406\u3092\u305b\u305a\u306b\u30ed\u30b0\u3092\u8caf\u3081\u305f\u3044\uff01\u3063\u3066\u306e\u304c\u3084\u308a\u305f\u3044\u3053\u3068\u3002\n\n\u305d\u308c\u3067\u7e01\u3042\u3063\u3066\u4e0a\u306e\u3084\u308a\u305f\u3044\u3053\u3068\u304cTreasureData\u3092\u4f7f\u3063\u3066\u3067\u304d\u308b\u304b\u3092\u78ba\u304b\u3081\u3066\u307f\u305f\u3063\u3066\u611f\u3058\u3002\n\n\u4ee5\u4e0b\u74b0\u5883\u60c5\u5831\u3002\n\n* ubuntu: 12.04\n* ruby: 2.1.2p95\n* gem: 2.2.2\n* nginx: nginx/1.1.19\n\nTreasureData\u306eAPI\u30ad\u30fc\u306f\u53d6\u5f97\u6e08\u307f\u3067\u3042\u308b\u3053\u3068\u3092\u524d\u63d0\u3068\u3059\u308b\u3002\n[TreasureData\u3092\u4f7f\u3063\u3066\u307f\u305f](http://qiita.com/akito1986/items/4c83ff492ed4b390ad50)\u3092\u53c2\u7167\u3002\n\n## fluentd(td-agent)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067fluentd\u306e\u5b89\u5b9a\u7248\u3067\u3042\u308btd-agent\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```cmd:install_td-agent\n$ curl -L http://toolbelt.treasuredata.com/sh/install-ubuntu-precise.sh | sh\n$ sudo td-agent --version\ntd-agent 0.10.50\n```\n\n## DB\u4f5c\u6210\n\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u5148\u306eDB\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\n\n`TD Tool Belt`\u3067TreasureData\u306b\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3002\n\n```cmd:login_td\n$ td account -f\nEnter your Treasure Data credentials.\nEmail: ${my_addr}\nPassword (typing will be hidden): ${my_passwd} \nAuthenticated successfully.\nUse 'td db:create <db_name>' to create a database.\n$\n```\n\nDB\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```cmd:create_db\n$ td db:create nginx\n```\n\n\n## td-agent\u306e\u8a2d\u5b9a\ntd-agent\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306enginx\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u304f\u308c\u3066\u308b\u3063\u307d\u3044\u306e\u3067\u8a2d\u5b9a\u306f\u7c21\u5358\u3002\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b`/etc/td-agent/td-agent.conf`\u3092\u7de8\u96c6\u3002\n\n```conf:td-agent.conf\n# Tailing the Nginx Log\n<source>\n  type tail\n  path /var/log/nginx/access.log\n  pos_file /var/log/td-agent/nginx-access.pos\n  tag td.nginx.access\n  format nginx\n</source>\n\n# Treasure Data Input and Output\n<match td.*.*>\n  type tdlog\n  apikey ${my_td_api_key}\n  auto_create_table\n  buffer_type file\n  buffer_path /var/log/td-agent/buffer/td\n  endpoint ${td_endpoint}\n  flush_interval 10s\n  use_ssl true\n</match>\n```\n\u4e0a\u8a18\u306e\u610f\u5473\u3067\u3059\u304c\u3001`source type`\u3067tail\u3092\u6307\u5b9a\u3057\u3066\u304a\u308a\u65b0\u898f\u3067\u8ffd\u52a0\u3055\u308c\u305f\u3082\u306e\u3092\u5bfe\u8c61\u3068\u3057\u3066\u3044\u308b\u3002\n`source path`\u306f\u76e3\u8996\u5bfe\u8c61\u306e\u30d1\u30b9\u3001`source tag`\u3067\u30bf\u30b0\u4ed8\u3051\u3092\u3057\u3066\u3044\u307e\u3059\u3002`td.nginx.access`\u306fTreasureData\u4e0a\u306e`nginx`\u3068\u3044\u3046DB\u306e`access`\u3068\u3044\u3046\u30c6\u30fc\u30d6\u30eb\u306b\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3059\u308b\u3053\u3068\u3092\u610f\u5473\u3059\u308b\u3002\n\n`match`\u306e\u65b9\u3067\u306f`endpoint`\u3067TreasureData\u306eAPI\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u6307\u5b9a\u3059\u308b\u3002AWS\u306e\u5834\u5408\u3060\u3068`https://api.treasuredata.com`\u3068\u306a\u308b\u3002\n`flush_interval`\u3067\u30c7\u30fc\u30bf\u9001\u51fa\u9593\u9694\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n## \u30c7\u30fc\u30bf\u30a4\u30f3\u30dd\u30fc\u30c8\n\u307e\u305a\u306fnginx\u3092\u8d77\u52d5\u3059\u308b\u3002\n\n```cmd:start_nginx\n$ sudo rm /var/log/nginx/access.log # \u524a\u9664\u3057\u3066\u304a\u304f\u3002\n$ sudo service nginx start\n```\n\n\u6b21\u306btd-agent\u306e\u8d77\u52d5\u3002\n\n```cmd:start_td-agent\n$ sudo /etc/init.d/td-agent start\n```\n\nnginx\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3002\n\u5ff5\u306e\u305f\u30815\u56de\u3002\n\n```cmd:curl\n$ curl http://localhost\n$ curl http://localhost\n$ curl http://localhost\n$ curl http://localhost\n$ curl http://localhost\n$ sleep 10\n```\n\n```cmd:check_log\n$ sudo cat /var/log/nginx/access.log\n127.0.0.1 - - [14/Aug/2014:01:26:09 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n127.0.0.1 - - [14/Aug/2014:01:26:11 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n127.0.0.1 - - [14/Aug/2014:01:26:12 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n127.0.0.1 - - [14/Aug/2014:01:26:12 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n127.0.0.1 - - [14/Aug/2014:01:26:13 +0900] \"GET / HTTP/1.1\" 404 169 \"-\" \"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"\n```\n\n## \u30a4\u30f3\u30dd\u30fc\u30c8\u78ba\u8a8d\n\n\u30a4\u30f3\u30dd\u30fc\u30c8\u78ba\u8a8d\u3002\n5\u4ef6\u306e\u30c7\u30fc\u30bf\u304c\u30a4\u30f3\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308b\u3002\n\n```cmd:check_import_data\n$ td table:list nginx\n+----------+--------+------+-------+--------+---------------------------+---------------------------+-----------------------------------------------------------------------------------------------------------------------------+\n| Database | Table  | Type | Count | Size   | Last import               | Last log timestamp        | Schema                                                                                                                      |\n+----------+--------+------+-------+--------+---------------------------+---------------------------+-----------------------------------------------------------------------------------------------------------------------------+\n| nginx    | access | log  | 5     | 0.0 GB | 2014-08-14 01:26:13 +0900 | 2014-08-14 01:26:13 +0900 | host:string, path:string, method:string, referer:string, code:string, remote:string, agent:string, user:string, size:string |\n+----------+--------+------+-------+--------+---------------------------+---------------------------+-----------------------------------------------------------------------------------------------------------------------------+\n```\n\n\u5185\u5bb9\u3082\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\n```cmd:td_query\n$ td query -w -t hive -d nginx \"SELECT * FROM access\"\n+------+------+--------+---------+------+-----------+-----------------------------------------------------------------------------------------------------+------+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+\n| host | path | method | referer | code | remote    | agent                                                                                               | user | size | v                                                                                                                                                                                                                                                | time       |\n+------+------+--------+---------+------+-----------+-----------------------------------------------------------------------------------------------------+------+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"time\":\"1407947169\",\"remote\":\"127.0.0.1\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947169 |\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"remote\":\"127.0.0.1\",\"time\":\"1407947171\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947171 |\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"remote\":\"127.0.0.1\",\"time\":\"1407947172\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947172 |\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"remote\":\"127.0.0.1\",\"time\":\"1407947172\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947172 |\n| -    | /    | GET    | -       | 404  | 127.0.0.1 | curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3 | -    | 169  | {\"host\":\"-\",\"user\":\"-\",\"path\":\"/\",\"referer\":\"-\",\"method\":\"GET\",\"code\":\"404\",\"size\":\"169\",\"remote\":\"127.0.0.1\",\"time\":\"1407947173\",\"agent\":\"curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\"} | 1407947173 |\n+------+------+--------+---------+------+-----------+-----------------------------------------------------------------------------------------------------+------+------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+\n5 rows in set\n```\n\u3075\u3080\u3075\u3080\u3001\u3061\u3083\u3093\u3068\u5404\u30ab\u30e9\u30e0\u306b\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u308b\u3063\u307d\u3044\u3002\n\n\u6b21\u56de\u306f\u72ec\u81ea\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u30ed\u30b0\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u8a2d\u5b9a\u306b\u3064\u3044\u3066\u8a18\u8f09\u3059\u308b\u3064\u3082\u308a\u3002\n\n\u304a\u3057\u307e\u3044\u3002\n", "tags": ["TreasureData", "fluentd", "log", "nginx"]}