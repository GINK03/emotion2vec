{"context": "\n\nLynis\nhttps://cisofy.com/lynis/\n\u6700\u65b0\u7248\u306f 2016/08/23 \u30ea\u30ea\u30fc\u30b9\u306e Lynis 2.3.3 1 \u306b\u306a\u308b\u3002\n2015 Top Security Tools as Voted by ToolsWatch.org Readers \u30672\u4f4d\u3092\u7372\u5f97\u3057\u3066\u3044\u308b\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nCISOfy Software\ncat << \"_EOF_\" >> /etc/yum.repos.d/cisofy-lynis.repo\n[lynis]\nname=CISOfy Software - Lynis package\nbaseurl=https://packages.cisofy.com/community/lynis/rpm/\nenabled=1\ngpgkey=https://packages.cisofy.com/keys/cisofy-software-rpms-public.key\ngpgcheck=1\n_EOF_\nyum install lynis\n\n\u6700\u65b0\u7248\u306e Lynis 2.3.3 \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\n\nEPEL\nepel \u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u304c\u3001\u305d\u306e\u5834\u5408 2016/03/18 \u30ea\u30ea\u30fc\u30b9\u306e Lynis 2.2.0 \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3002\nyum install epel-release\nyum install lynis\n\n\nEPEL Testing\nepel-testing \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u5229\u7528\u3059\u308b\u3068 Lynis 2.3.2 \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u3002\nyum install epel-release\nyum install lynis --enablerepo=epel-testing\n\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\nepel \u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3068 pam \u3068 systemd \u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u306e\u3067 GitHub \u304b\u3089\u5165\u624b\u3059\u308b\u3002 plugins \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3059\u308c\u3070\u81ea\u52d5\u3067\u8a8d\u8b58\u3059\u308b\u305f\u3081\u7279\u306b\u8a2d\u5b9a\u306e\u5909\u66f4\u306f\u5fc5\u8981\u306a\u3044\u3002\ncurl -s https://raw.githubusercontent.com/CISOfy/lynis/master/plugins/{plugin_systemd_phase1} -o /usr/share/lynis/plugins/#1\ncurl -s https://raw.githubusercontent.com/CISOfy/lynis/master/plugins/{plugin_pam_phase1} -o /usr/share/lynis/plugins/#1\n\n\n\u65e5\u672c\u8a9e\u5bfe\u5fdc\ncurl -s https://raw.githubusercontent.com/CISOfy/lynis/master/db/languages/{ja} -o /usr/share/lynis/db/languages/#1\n\n\u62d9\u8a33\u306e\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u30de\u30fc\u30b8\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3088\u3051\u308c\u3070\u5229\u7528\u3057\u3066\u6b32\u3057\u3044\u3002Lynis 2.3.3 \u304b\u3089\u540c\u68b1\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u691c\u67fb\n\n\u901a\u5e38\u30e2\u30fc\u30c9\nlynis audit system\n\n\n\u51fa\u529b\u4f8b\n[ Lynis 2.3.3 ]\n\n################################################################################\n  Lynis comes with ABSOLUTELY NO WARRANTY. This is free software, and you are\n  welcome to redistribute it under the terms of the GNU General Public License.\n  See the LICENSE file for details about using this software.\n\n  2007-2016, CISOfy - https://cisofy.com/lynis/\n  Enterprise support available (compliance, plugins, interface and tools)\n################################################################################\n\n\n[+] Initializing program\n------------------------------------\n  - Detecting OS...                                           [ DONE ]\n  - Checking profiles...                                      [ DONE ]\n  - Detecting language and localization                       [ ja ]\n.\n.\n.\n================================================================================\n\n  Lynis security scan details:\n\n  Hardening index : 68 [#############       ]\n  Tests performed : 210\n  Plugins enabled : 2\n\n  Components:\n  - Firewall               [V]\n  - Malware scanner        [X]\n\n  Lynis Modules:\n  - Compliance Status      [?]\n  - Security Audit         [V]\n  - Vulnerability Scan     [V]\n\n  Files:\n  - Test and debug information      : /var/log/lynis.log\n  - Report data                     : /var/log/lynis-report.dat\n\n================================================================================\n\n  Lynis 2.3.3\n\n  Auditing, system hardening, and compliance for UNIX-based systems\n  (Linux, macOS, BSD, and others)\n\n  2007-2016, CISOfy - https://cisofy.com/lynis/\n  Enterprise support available (compliance, plugins, interface and tools)\n\n================================================================================\n\n  [TIP]: Enhance Lynis audits by adding your settings to custom.prf (see /etc/lynis/default.prf for all settings)\n\n\n\n\u8a73\u7d30\u30e2\u30fc\u30c9\nlynis audit system --verbose\n\n--verbose \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u308b\u3068\u8a73\u7d30\u3092\u51fa\u529b\u3057\u3066\u304f\u308c\u308b\u3002\u5177\u4f53\u7684\u306b\u306f\u4ee5\u4e0b\u306e\u5dee\u5206\u304c\u751f\u3058\u305f\u3002\n41a42,46\n> [+] Program Details\n> ------------------------------------\n>   - Verbose mode                                              [ YES ]\n>   - Debug mode                                                [ NO ]\n>\n129a135\n>   - Querying FFS/UFS mount points (fstab)                     [ NONE ]\n137a144\n>   - /var/tmp is not bound to /tmp                             [ INFO ]\n152a160,161\n>   - Checking default DNS search domain                        [ NONE ]\n>   - Checking /etc/resolv.conf options                         [ NONE ]\n154a164,168\n>   - Checking nscd status                                      [ NOT FOUND ]\n>   - Checking Unbound status                                   [ NOT FOUND ]\n>   - Checking BIND status                                      [ NOT FOUND ]\n>   - Checking PowerDNS status                                  [ NOT FOUND ]\n>   - Checking ypbind status                                    [ NOT FOUND ]\n291a306\n>   - Checking atd status                                       [ NOT RUNNING ]\n327a343,350\n>     - AFICK                                                   [ NOT FOUND ]\n>     - AIDE                                                    [ NOT FOUND ]\n>     - Osiris                                                  [ NOT FOUND ]\n>     - Samhain                                                 [ NOT FOUND ]\n>     - Tripwire                                                [ NOT FOUND ]\n>     - OSSEC                                                   [ NOT FOUND ]\n>     - mtree                                                   [ NOT FOUND ]\n>     - osquery daemon (syscheck)                               [ NOT FOUND ]\n\n\n\u691c\u67fb\u7d50\u679c\nCentOS 7.2.1511 (1608-01) \u306e minimal \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e yum update \u6e08\u307f\u30c7\u30d5\u30a9\u30eb\u30c8\u72b6\u614b\u3067\u306f\u4ee5\u4e0b\u306e\u5185\u5bb9\u304c\u51fa\u529b\u3055\u308c\u305f\u3002\n\nWarnings (1):\n\nFound mail_name in SMTP banner, and/or mail_name contains 'Postfix' MAIL-8818\n\n\n\nSuggestions (35):\n\nConfigure minimum password age in /etc/login.defs AUTH-9286\n\nConfigure maximum password age in /etc/login.defs AUTH-9286\n\nDefault umask in /etc/profile could be more strict like 027 AUTH-9328\n\nTo decrease the impact of a full /home file system, place /home on a separated partition FILE-6310\n\nTo decrease the impact of a full /tmp file system, place /tmp on a separated partition FILE-6310\n\nTo decrease the impact of a full /var file system, place /var on a separated partition FILE-6310\n\nDisable drivers like USB storage when not used, to prevent unauthorized storage or data theft STRG-1840\n\nDisable drivers like firewire storage when not used, to prevent unauthorized storage or data theft STRG-1846\n\nSplit resolving between localhost and the hostname of the system NAME-4406\n\nInstall package 'yum-utils' for better consistency checking of the package database PKGS-7384\n\nInstall ARP monitoring software like arpwatch NETW-3032\n\nYou are advised to hide the mail_name (option: smtpd_banner) from your postfix configuration. Use postconf -e or change your main.cf file (/etc/postfix/main.cf) MAIL-8818\n\nCheck iptables rules to see which rules are currently not used FIRE-4513\n\nConsider hardening SSH configuration SSH-7408\n\nDetails: AllowTcpForwarding (YES --> NO)\nDetails: ClientAliveCountMax (3 --> 2)\nDetails: Compression (DELAYED --> NO)\nDetails: LogLevel (INFO --> VERBOSE)\nDetails: MaxAuthTries (6 --> 1)\nDetails: MaxSessions (10 --> 2)\nDetails: PermitRootLogin (YES --> NO)\nDetails: Port (22 --> )\nDetails: TCPKeepAlive (YES --> NO)\nDetails: UseDNS (YES --> NO)\nDetails: X11Forwarding (YES --> NO)\nDetails: AllowAgentForwarding (YES --> NO)\n\n\nAdd a legal banner to /etc/issue, to warn unauthorized users BANN-7126\n\nAdd legal banner to /etc/issue.net, to warn unauthorized users BANN-7130\n\nEnable process accounting ACCT-9622\n\nEnable sysstat to collect accounting (no results) ACCT-9626\n\nAudit daemon is enabled with an empty ruleset. Disable the daemon or define rules ACCT-9630\n\nInstall a file integrity tool to monitor changes to critical and sensitive files FINT-4350\n\nDetermine if automation tools are present for system management TOOL-5002\n\nOne or more sysctl values differ from the scan profile and could be tweaked KRNL-6000\n\nHarden compilers like restricting access to root user only HRDN-7222\n\nHarden the system by installing at least one malware scanner, to perform periodic file system scans HRDN-7230\n\n\n\n\u5bfe\u5fdc\n\nWarnings\n\n\nSMTP banner \u306b 'Postfix' \u3092\u542b\u3080 mail_name \u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f\nsed -i.org \"s/#smtpd_banner = \\$myhostname ESMTP \\$mail_name$/smtpd_banner = \\$myhostname ESMTP/\" /etc/postfix/main.cf\n\n/etc/postfix/main.cf \u306b smtpd_banner = $myhostname ESMTP \u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\niptables \u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u30ed\u30fc\u30c9\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u6709\u52b9\u306a\u30eb\u30fc\u30eb\u304c\u3042\u308a\u307e\u305b\u3093\n\n\nSuggestions\n\n\n/etc/login.defs \u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u4e0d\u53ef\u80fd\u671f\u9593\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\nsed -i.org 's/PASS_MIN_DAYS\\t0/PASS_MIN_DAYS\\t1/' /etc/login.defs\n\nPASS_MIN_DAYS \u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\u3057\u3066\u304b\u3089\u6b21\u306b\u5909\u66f4\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u307e\u3067\u306e\u6700\u77ed\u65e5\u6570\u3002\n\n\n/etc/login.defs \u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\nsed -i 's/PASS_MAX_DAYS\\t99999/PASS_MAX_DAYS\\t3650/' /etc/login.defs\n\n\n\n/etc/profile \u306e\u30c7\u30d5\u30a9\u30eb\u30c8 umask \u306f 027 \u306a\u3069\u3088\u308a\u53b3\u3057\u304f\u8a2d\u5b9a\u3067\u304d\u307e\u3059\nsed -i \"s/umask 002/umask 027/\" /etc/profile\nsed -i \"s/umask 022/umask 027/\" /etc/profile\n\numask\u5024 027 \u306f\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306e 740 \u306b\u5bfe\u5fdc\u3059\u308b\u3002\n\n\n/home \u306e\u5bb9\u91cf\u8d85\u904e\u6642\u306e\u5f71\u97ff\u3092\u6e1b\u3089\u3059\u305f\u3081\u306b /home \u3092\u5225\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u7f6e\u3044\u3066\u304f\u3060\u3055\u3044\n/tmp \u306e\u5bb9\u91cf\u8d85\u904e\u6642\u306e\u5f71\u97ff\u3092\u6e1b\u3089\u3059\u305f\u3081\u306b /tmp \u3092\u5225\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u7f6e\u3044\u3066\u304f\u3060\u3055\u3044\n/var \u306e\u5bb9\u91cf\u8d85\u904e\u6642\u306e\u5f71\u97ff\u3092\u6e1b\u3089\u3059\u305f\u3081\u306b /var \u3092\u5225\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u7f6e\u3044\u3066\u304f\u3060\u3055\u3044\n6.10.4.5. \u63a8\u5968\u3055\u308c\u308b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u8a2d\u5b9a\u30b9\u30ad\u30fc\u30e0 - RHEL7 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30ac\u30a4\u30c9\n9.15.5. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u8a2d\u5b9a\u306b\u95a2\u3059\u308b\u63a8\u5968 - RHEL6 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30ac\u30a4\u30c9\n\n\n\u4e0d\u6b63\u306a\u30b9\u30c8\u30ec\u30fc\u30b8\u3084\u30c7\u30fc\u30bf\u7a83\u76d7\u3092\u9632\u3050\u305f\u3081\u306b USB \u30b9\u30c8\u30ec\u30fc\u30b8\u306a\u3069\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u7121\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044\necho \"blacklist usb-storage\" > /etc/modprobe.d/blacklist-usbstorage.conf\n\n\n\n\u4e0d\u6b63\u306a\u30b9\u30c8\u30ec\u30fc\u30b8\u3084\u30c7\u30fc\u30bf\u7a83\u76d7\u3092\u9632\u3050\u305f\u3081\u306b firewire \u30b9\u30c8\u30ec\u30fc\u30b8\u306a\u3069\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u7121\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044\necho \"blacklist firewire_core\" > /etc/modprobe.d/blacklist-firewire.conf\necho \"blacklist firewire_ohci\" >> /etc/modprobe.d/blacklist-firewire.conf\n\n\n\nlocalhost \u3068\u30b7\u30b9\u30c6\u30e0\u306e hostname \u306e\u89e3\u6c7a\u3092\u5206\u96e2\u3057\u3066\u304f\u3060\u3055\u3044\nsed -i '/::1/s/^/#/' /etc/hosts\n\n::1 \u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3059\u308b\u3068 Suggestion \u306b\u51fa\u306a\u304f\u306f\u306a\u308b\u304c\u2026\u3002\n\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c1\u30a7\u30c3\u30af\u306e\u3088\u308a\u826f\u3044\u4e00\u8cab\u6027\u3092\u4fdd\u3064\u305f\u3081\u306b 'yum-utils' \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u3060\u3055\u3044\nyum install yum-utils\n\n\n\narpwatch \u306e\u3088\u3046\u306a ARP \u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u3060\u3055\u3044\nyum install arpwatch\nsystemctl enable arpwatch\nsystemctl start arpwatch\n\n\nYou are advised to hide the mail_name (option: smtpd_banner) from your postfix configuration. Use postconf -e or change your main.cf file (/etc/postfix/main.cf)\n\nSSH \u306e\u8a2d\u5b9a\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u3092\u691c\u8a0e\u3057\u3066\u304f\u3060\u3055\u3044\ncp -a /etc/ssh/sshd_config{,.org}\n\n\n\nDetails: AllowTcpForwarding (YES --> NO)\nsed -i 's/#AllowTcpForwarding yes/AllowTcpForwarding no/' /etc/ssh/sshd_config\n\n\n\nDetails: ClientAliveCountMax (3 --> 2)\nsed -i 's/#ClientAliveCountMax 3/ClientAliveCountMax 2/' /etc/ssh/sshd_config\n\n\n\nDetails: Compression (DELAYED --> NO)\nsed -i 's/#Compression delayed/Compression no/' /etc/ssh/sshd_config\n\n\n\nDetails: LogLevel (INFO --> VERBOSE)\nsed -i 's/#LogLevel INFO/LogLevel VERBOSE/' /etc/ssh/sshd_config\n\n\n\nDetails: MaxAuthTries (6 --> 1)\nsed -i 's/#MaxAuthTries 6/MaxAuthTries 1/' /etc/ssh/sshd_config\n\n\n\nDetails: MaxSessions (10 --> 2)\nsed -i 's/#MaxSessions 10/MaxSessions 2/' /etc/ssh/sshd_config\n\n\n\nDetails: PermitRootLogin (YES --> NO)\nsed -i 's/#PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config\n\n\n\nDetails: Port (22 --> )\nsed -i 's/#Port 22/Port 10022/' /etc/ssh/sshd_config\n\n\n\nDetails: TCPKeepAlive (YES --> NO)\nsed -i 's/#TCPKeepAlive yes/TCPKeepAlive no/' /etc/ssh/sshd_config\n\n\n\nDetails: UseDNS (YES --> NO)\nsed -i 's/#UseDNS yes/UseDNS no/' /etc/ssh/sshd_config\n\n\n\nDetails: X11Forwarding (YES --> NO)\nsed -i 's/X11Forwarding yes/X11Forwarding no/' /etc/ssh/sshd_config\n\n\n\nDetails: AllowAgentForwarding (YES --> NO)\nsed -i 's/#AllowAgentForwarding yes/AllowAgentForwarding no/' /etc/ssh/sshd_config\n\n\n\n\n\n\u4e0d\u6b63\u30e6\u30fc\u30b6\u30fc\u306b\u8b66\u544a\u3059\u308b\u305f\u3081\u306b legal banner \u3092 /etc/issue \u306b\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\n(echo; echo \"Unauthorized access to this machine is prohibited.\"; echo \"Disconnect now if you are not an authorized user.\"; echo) > /etc/issue\n\n\n\n\u4e0d\u6b63\u30e6\u30fc\u30b6\u30fc\u306b\u8b66\u544a\u3059\u308b\u305f\u3081\u306b legal banner \u3092 /etc/issue.net \u306b\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\n(echo; echo \"Unauthorized access to this machine is prohibited.\"; echo \"Disconnect now if you are not an authorized user.\"; echo) > /etc/issue.net\n\n\n\n\u30d7\u30ed\u30bb\u30b9\u30a2\u30ab\u30a6\u30f3\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044\nyum install psacct\nsystemctl enable psacct\nsystemctl start psacct\n\nlastcomm \u30b3\u30de\u30f3\u30c9\u3067\u5c65\u6b74\u3092\u51fa\u529b\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\n\u30a2\u30ab\u30a6\u30f3\u30c6\u30a3\u30f3\u30b0\u3092\u53ce\u96c6\u3059\u308b\u305f\u3081\u306b sysstat \u3092\u6709\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044 (no results)\nyum install sysstat\n\n\n\nAudit \u30c7\u30fc\u30e2\u30f3\u304c\u7a7a\u306e\u30eb\u30fc\u30eb\u30bb\u30c3\u30c8\u3067\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u30c7\u30fc\u30e2\u30f3\u3092\u7121\u52b9\u306b\u3059\u308b\u304b\u3001\u30eb\u30fc\u30eb\u3092\u5b9a\u7fa9\u3057\u3066\u304f\u3060\u3055\u3044\necho '-a exit,always -F arch=b64 -F euid=0 -S execve' >> /etc/audit/audit.rules\necho '-a exit,always -F arch=b32 -F euid=0 -S execve' >> /etc/audit/audit.rules\nservice auditd restart\n\nsystemctl restart auditd \u3092\u5b9f\u884c\u3059\u308b\u3068 Failed to restart auditd.service: Operation refused, unit auditd.service may be requested by dependency only. \u3068\u8a00\u308f\u308c\u3066\u5931\u6557\u3059\u308b\u306e\u3067 service \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3046\u30022\n7.5. Audit \u30eb\u30fc\u30eb\u306e\u5b9a\u7fa9\n\n\n\u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u306e\u81ea\u52d5\u5316\u30c4\u30fc\u30eb\u304c\u3042\u308c\u3070\u6c7a\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\nyum install puppet-server\nsystemctl enable puppetmaster\nsystemctl start puppetmaster\n\nyum install salt-master\nsystemctl enable salt-master\nsystemctl start salt-master\n\npuppetmaster \u304b salt-master \u306e\u3044\u305a\u308c\u304b\u3002\n\n\n1\u3064\u4ee5\u4e0a\u306e sysctl \u306e\u5024\u304c\u30b9\u30ad\u30e3\u30f3\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3068\u7570\u306a\u308a\u8abf\u6574\u306e\u4f59\u5730\u304c\u3042\u308a\u307e\u3059\nlynis --quick --verbose --tests KRNL-6000\ngrep \"different value\" /var/log/lynis.log | awk '{ gsub(\"Expected\",\"\"); gsub(\",\",\"\"); print $6 $16 }'\ngrep \"different value\" /var/log/lynis.log | awk '{ gsub(\"Expected\",\"\"); gsub(\",\",\"\"); print $6 $16 }' >> /etc/sysctl.conf\nsysctl -p\n\n\n\nroot \u30e6\u30fc\u30b6\u30fc\u306e\u307f\u306b\u30a2\u30af\u30bb\u30b9\u3092\u5236\u9650\u3059\u308b\u306a\u3069\u30b3\u30f3\u30d1\u30a4\u30e9\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u5f37\u5316\u3057\u3066\u304f\u3060\u3055\u3044\nlynis --quick --verbose --tests HRDN-7222\ngrep \"world executable\" /var/log/lynis.log | awk '{ print $5 }' | xargs ls -l\ngrep \"world executable\" /var/log/lynis.log | awk '{ print $5 }' | xargs chmod 700\n\n\n\n\u5b9a\u671f\u7684\u306a\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u30b9\u30ad\u30e3\u30f3\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u3001\u5c11\u306a\u304f\u3068\u3082\u4e00\u3064\u306e\u30de\u30eb\u30a6\u30a7\u30a2\u30b9\u30ad\u30e3\u30ca\u30fc\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u3067\u30b7\u30b9\u30c6\u30e0\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u3057\u3066\u304f\u3060\u3055\u3044\n\n\u7dcf\u5408\u30a6\u30a4\u30eb\u30b9\u691c\u51fa\n\n\nClamAV \u307e\u305f\u306f\u5546\u7528\u306e\u4ee3\u66ff\u88fd\u54c1\n\n\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\n\nRootkit Hunter (rkhunter)\nChkrootkit\nOSSEC\n\n\nWeb\u30b5\u30fc\u30d0\u30fc\u7528\u30de\u30eb\u30a6\u30a7\u30a2\u691c\u51fa\n\nLinux Malware Detect (LMD)\n\n\n\n\n\u5bfe\u7b56\u307e\u3068\u3081\nsed -i.org \"s/#smtpd_banner = \\$myhostname ESMTP \\$mail_name$/smtpd_banner = \\$myhostname ESMTP/\" /etc/postfix/main.cf\nsed -i.org 's/PASS_MIN_DAYS\\t0/PASS_MIN_DAYS\\t1/' /etc/login.defs\nsed -i 's/PASS_MAX_DAYS\\t99999/PASS_MAX_DAYS\\t3650/' /etc/login.defs\nsed -i.org \"s/umask 002/umask 027/\" /etc/profile\nsed -i \"s/umask 022/umask 027/\" /etc/profile\necho \"blacklist usb-storage\" > /etc/modprobe.d/blacklist-usbstorage.conf\necho \"blacklist firewire_core\" > /etc/modprobe.d/blacklist-firewire.conf\necho \"blacklist firewire_ohci\" >> /etc/modprobe.d/blacklist-firewire.conf\nsed -i '/::1/s/^/#/' /etc/hosts\nyum install yum-utils arpwatch psacct sysstat\nsystemctl enable arpwatch psacct\nsystemctl start arpwatch psacct\nsed -i.org 's/#AllowTcpForwarding yes/AllowTcpForwarding no/' /etc/ssh/sshd_config\nsed -i 's/#ClientAliveCountMax 3/ClientAliveCountMax 2/' /etc/ssh/sshd_config\nsed -i 's/#Compression delayed/Compression no/' /etc/ssh/sshd_config\nsed -i 's/#LogLevel INFO/LogLevel VERBOSE/' /etc/ssh/sshd_config\nsed -i 's/#MaxAuthTries 6/MaxAuthTries 1/' /etc/ssh/sshd_config\nsed -i 's/#MaxSessions 10/MaxSessions 2/' /etc/ssh/sshd_config\nsed -i 's/#PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config\nsed -i 's/#Port 22/Port 10022/' /etc/ssh/sshd_config\nsed -i 's/#TCPKeepAlive yes/TCPKeepAlive no/' /etc/ssh/sshd_config\nsed -i 's/#UseDNS yes/UseDNS no/' /etc/ssh/sshd_config\nsed -i 's/X11Forwarding yes/X11Forwarding no/' /etc/ssh/sshd_config\nsed -i 's/#AllowAgentForwarding yes/AllowAgentForwarding no/' /etc/ssh/sshd_config\n(echo; echo \"Unauthorized access to this machine is prohibited.\"; echo \"Disconnect now if you are not an authorized user.\"; echo) > /etc/issue\n(echo; echo \"Unauthorized access to this machine is prohibited.\"; echo \"Disconnect now if you are not an authorized user.\"; echo) > /etc/issue.net\nlynis --quick --verbose --tests KRNL-6000\ngrep \"different value\" /var/log/lynis.log | awk '{ gsub(\"Expected\",\"\"); gsub(\",\",\"\"); print $6 $16 }'\ngrep \"different value\" /var/log/lynis.log | awk '{ gsub(\"Expected\",\"\"); gsub(\",\",\"\"); print $6 $16 }' >> /etc/sysctl.conf\nsysctl -p\nlynis --quick --verbose --tests HRDN-7222\ngrep \"world executable\" /var/log/lynis.log | awk '{ print $5 }' | xargs ls -l\ngrep \"world executable\" /var/log/lynis.log | awk '{ print $5 }' | xargs chmod 700\nyum install epel-release\nyum install rkhunter unhide\nrkhunter -c --rwo --sk\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n\nPHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin\nDoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1\nLinux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV\nLinux Malware Detect\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto\nLinux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis\n\n\n\n\n\nhttps://cisofy.com/changelog/lynis/2.3.3/\u00a0\u21a9\n\n\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1026648\u00a0\u21a9\n\n\n\n# Lynis\nhttps://cisofy.com/lynis/\n\u6700\u65b0\u7248\u306f 2016/08/23 \u30ea\u30ea\u30fc\u30b9\u306e **Lynis 2.3.3** [^version] \u306b\u306a\u308b\u3002\n[2015 Top Security Tools as Voted by ToolsWatch.org Readers](http://www.toolswatch.org/2016/02/2015-top-security-tools-as-voted-by-toolswatch-org-readers/) \u30672\u4f4d\u3092\u7372\u5f97\u3057\u3066\u3044\u308b\u3002\n\n[^version]: https://cisofy.com/changelog/lynis/2.3.3/\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n## CISOfy Software\n```bash\ncat << \"_EOF_\" >> /etc/yum.repos.d/cisofy-lynis.repo\n[lynis]\nname=CISOfy Software - Lynis package\nbaseurl=https://packages.cisofy.com/community/lynis/rpm/\nenabled=1\ngpgkey=https://packages.cisofy.com/keys/cisofy-software-rpms-public.key\ngpgcheck=1\n_EOF_\nyum install lynis\n```\n\u6700\u65b0\u7248\u306e **Lynis 2.3.3** \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\n\n## EPEL\nepel \u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u304c\u3001\u305d\u306e\u5834\u5408 2016/03/18 \u30ea\u30ea\u30fc\u30b9\u306e **Lynis 2.2.0** \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3002\n\n```bash\nyum install epel-release\nyum install lynis\n```\n\n## EPEL Testing\nepel-testing \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u5229\u7528\u3059\u308b\u3068 **Lynis 2.3.2** \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u3002\n\n```bash\nyum install epel-release\nyum install lynis --enablerepo=epel-testing\n```\n\n## \u30d7\u30e9\u30b0\u30a4\u30f3\nepel \u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3068 pam \u3068 systemd \u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u306e\u3067 GitHub \u304b\u3089\u5165\u624b\u3059\u308b\u3002 plugins \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3059\u308c\u3070\u81ea\u52d5\u3067\u8a8d\u8b58\u3059\u308b\u305f\u3081\u7279\u306b\u8a2d\u5b9a\u306e\u5909\u66f4\u306f\u5fc5\u8981\u306a\u3044\u3002\n\n```bash\ncurl -s https://raw.githubusercontent.com/CISOfy/lynis/master/plugins/{plugin_systemd_phase1} -o /usr/share/lynis/plugins/#1\ncurl -s https://raw.githubusercontent.com/CISOfy/lynis/master/plugins/{plugin_pam_phase1} -o /usr/share/lynis/plugins/#1\n```\n\n## \u65e5\u672c\u8a9e\u5bfe\u5fdc\n```bash\ncurl -s https://raw.githubusercontent.com/CISOfy/lynis/master/db/languages/{ja} -o /usr/share/lynis/db/languages/#1\n```\n\n\u62d9\u8a33\u306e\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u30de\u30fc\u30b8\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3088\u3051\u308c\u3070\u5229\u7528\u3057\u3066\u6b32\u3057\u3044\u3002Lynis 2.3.3 \u304b\u3089\u540c\u68b1\u3055\u308c\u3066\u3044\u308b\u3002\n\n# \u691c\u67fb\n## \u901a\u5e38\u30e2\u30fc\u30c9\n```bash\nlynis audit system\n```\n```text:\u51fa\u529b\u4f8b\n[ Lynis 2.3.3 ]\n\n################################################################################\n  Lynis comes with ABSOLUTELY NO WARRANTY. This is free software, and you are\n  welcome to redistribute it under the terms of the GNU General Public License.\n  See the LICENSE file for details about using this software.\n\n  2007-2016, CISOfy - https://cisofy.com/lynis/\n  Enterprise support available (compliance, plugins, interface and tools)\n################################################################################\n\n\n[+] Initializing program\n------------------------------------\n  - Detecting OS...                                           [ DONE ]\n  - Checking profiles...                                      [ DONE ]\n  - Detecting language and localization                       [ ja ]\n.\n.\n.\n================================================================================\n\n  Lynis security scan details:\n\n  Hardening index : 68 [#############       ]\n  Tests performed : 210\n  Plugins enabled : 2\n\n  Components:\n  - Firewall               [V]\n  - Malware scanner        [X]\n\n  Lynis Modules:\n  - Compliance Status      [?]\n  - Security Audit         [V]\n  - Vulnerability Scan     [V]\n\n  Files:\n  - Test and debug information      : /var/log/lynis.log\n  - Report data                     : /var/log/lynis-report.dat\n\n================================================================================\n\n  Lynis 2.3.3\n\n  Auditing, system hardening, and compliance for UNIX-based systems\n  (Linux, macOS, BSD, and others)\n\n  2007-2016, CISOfy - https://cisofy.com/lynis/\n  Enterprise support available (compliance, plugins, interface and tools)\n\n================================================================================\n\n  [TIP]: Enhance Lynis audits by adding your settings to custom.prf (see /etc/lynis/default.prf for all settings)\n```\n\n## \u8a73\u7d30\u30e2\u30fc\u30c9\n```bash\nlynis audit system --verbose\n```\n`--verbose` \u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u308b\u3068\u8a73\u7d30\u3092\u51fa\u529b\u3057\u3066\u304f\u308c\u308b\u3002\u5177\u4f53\u7684\u306b\u306f\u4ee5\u4e0b\u306e\u5dee\u5206\u304c\u751f\u3058\u305f\u3002\n\n```\n41a42,46\n> [+] Program Details\n> ------------------------------------\n>   - Verbose mode                                              [ YES ]\n>   - Debug mode                                                [ NO ]\n>\n129a135\n>   - Querying FFS/UFS mount points (fstab)                     [ NONE ]\n137a144\n>   - /var/tmp is not bound to /tmp                             [ INFO ]\n152a160,161\n>   - Checking default DNS search domain                        [ NONE ]\n>   - Checking /etc/resolv.conf options                         [ NONE ]\n154a164,168\n>   - Checking nscd status                                      [ NOT FOUND ]\n>   - Checking Unbound status                                   [ NOT FOUND ]\n>   - Checking BIND status                                      [ NOT FOUND ]\n>   - Checking PowerDNS status                                  [ NOT FOUND ]\n>   - Checking ypbind status                                    [ NOT FOUND ]\n291a306\n>   - Checking atd status                                       [ NOT RUNNING ]\n327a343,350\n>     - AFICK                                                   [ NOT FOUND ]\n>     - AIDE                                                    [ NOT FOUND ]\n>     - Osiris                                                  [ NOT FOUND ]\n>     - Samhain                                                 [ NOT FOUND ]\n>     - Tripwire                                                [ NOT FOUND ]\n>     - OSSEC                                                   [ NOT FOUND ]\n>     - mtree                                                   [ NOT FOUND ]\n>     - osquery daemon (syscheck)                               [ NOT FOUND ]\n```\n\n# \u691c\u67fb\u7d50\u679c\nCentOS 7.2.1511 (1608-01) \u306e minimal \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e `yum update` \u6e08\u307f\u30c7\u30d5\u30a9\u30eb\u30c8\u72b6\u614b\u3067\u306f\u4ee5\u4e0b\u306e\u5185\u5bb9\u304c\u51fa\u529b\u3055\u308c\u305f\u3002\n## Warnings (1):\n* Found mail_name in SMTP banner, and/or mail_name contains 'Postfix' [MAIL-8818](https://cisofy.com/controls/MAIL-8818/)\n\n## Suggestions (35):\n  * Configure minimum password age in /etc/login.defs [AUTH-9286](https://cisofy.com/controls/AUTH-9286/)\n  * Configure maximum password age in /etc/login.defs [AUTH-9286](https://cisofy.com/controls/AUTH-9286/)\n  * Default umask in /etc/profile could be more strict like 027 [AUTH-9328](https://cisofy.com/controls/AUTH-9328/)\n  * To decrease the impact of a full /home file system, place /home on a separated partition [FILE-6310](https://cisofy.com/controls/FILE-6310/)\n  * To decrease the impact of a full /tmp file system, place /tmp on a separated partition [FILE-6310](https://cisofy.com/controls/FILE-6310/)\n  * To decrease the impact of a full /var file system, place /var on a separated partition [FILE-6310](https://cisofy.com/controls/FILE-6310/)\n  * Disable drivers like USB storage when not used, to prevent unauthorized storage or data theft [STRG-1840](https://cisofy.com/controls/STRG-1840/)\n  * Disable drivers like firewire storage when not used, to prevent unauthorized storage or data theft [STRG-1846](https://cisofy.com/controls/STRG-1846/)\n  * Split resolving between localhost and the hostname of the system [NAME-4406](https://cisofy.com/controls/NAME-4406/)\n  * Install package 'yum-utils' for better consistency checking of the package database [PKGS-7384](https://cisofy.com/controls/PKGS-7384/)\n  * Install ARP monitoring software like arpwatch [NETW-3032](https://cisofy.com/controls/NETW-3032/)\n  * You are advised to hide the mail_name (option: smtpd_banner) from your postfix configuration. Use postconf -e or change your main.cf file (/etc/postfix/main.cf) [MAIL-8818](https://cisofy.com/controls/MAIL-8818/)\n  * Check iptables rules to see which rules are currently not used [FIRE-4513](https://cisofy.com/controls/FIRE-4513/)\n  * Consider hardening SSH configuration [SSH-7408](https://cisofy.com/controls/SSH-7408/)\n    - Details: AllowTcpForwarding (YES --> NO)\n    - Details: ClientAliveCountMax (3 --> 2)\n    - Details: Compression (DELAYED --> NO)\n    - Details: LogLevel (INFO --> VERBOSE)\n    - Details: MaxAuthTries (6 --> 1)\n    - Details: MaxSessions (10 --> 2)\n    - Details: PermitRootLogin (YES --> NO)\n    - Details: Port (22 --> )\n    - Details: TCPKeepAlive (YES --> NO)\n    - Details: UseDNS (YES --> NO)\n    - Details: X11Forwarding (YES --> NO)\n    - Details: AllowAgentForwarding (YES --> NO)\n  * Add a legal banner to /etc/issue, to warn unauthorized users [BANN-7126](https://cisofy.com/controls/BANN-7126/)\n  * Add legal banner to /etc/issue.net, to warn unauthorized users [BANN-7130](https://cisofy.com/controls/BANN-7130/)\n  * Enable process accounting [ACCT-9622](https://cisofy.com/controls/ACCT-9622/)\n  * Enable sysstat to collect accounting (no results) [ACCT-9626](https://cisofy.com/controls/ACCT-9626/)\n  * Audit daemon is enabled with an empty ruleset. Disable the daemon or define rules [ACCT-9630](https://cisofy.com/controls/ACCT-9630/)\n  * Install a file integrity tool to monitor changes to critical and sensitive files [FINT-4350](https://cisofy.com/controls/FINT-4350/)\n  * Determine if automation tools are present for system management [TOOL-5002](https://cisofy.com/controls/TOOL-5002/)\n  * One or more sysctl values differ from the scan profile and could be tweaked [KRNL-6000](https://cisofy.com/controls/KRNL-6000/)\n  * Harden compilers like restricting access to root user only [HRDN-7222](https://cisofy.com/controls/HRDN-7222/)\n  * Harden the system by installing at least one malware scanner, to perform periodic file system scans [HRDN-7230](https://cisofy.com/controls/HRDN-7230/)\n\n# \u5bfe\u5fdc\n## Warnings\n1. **SMTP banner \u306b 'Postfix' \u3092\u542b\u3080 mail_name \u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f**\n\n    ```bash\n    sed -i.org \"s/#smtpd_banner = \\$myhostname ESMTP \\$mail_name$/smtpd_banner = \\$myhostname ESMTP/\" /etc/postfix/main.cf\n    ```\n    /etc/postfix/main.cf \u306b `smtpd_banner = $myhostname ESMTP` \u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n\n2. **iptables \u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u30ed\u30fc\u30c9\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u6709\u52b9\u306a\u30eb\u30fc\u30eb\u304c\u3042\u308a\u307e\u305b\u3093**\n\n## Suggestions\n99. **/etc/login.defs \u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u5909\u66f4\u4e0d\u53ef\u80fd\u671f\u9593\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    sed -i.org 's/PASS_MIN_DAYS\\t0/PASS_MIN_DAYS\\t1/' /etc/login.defs\n    ```\n\n    `PASS_MIN_DAYS` \u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5909\u66f4\u3057\u3066\u304b\u3089\u6b21\u306b\u5909\u66f4\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u307e\u3067\u306e\u6700\u77ed\u65e5\u6570\u3002\n\n99. **/etc/login.defs \u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u6709\u52b9\u671f\u9650\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    sed -i 's/PASS_MAX_DAYS\\t99999/PASS_MAX_DAYS\\t3650/' /etc/login.defs\n    ```\n\n99. **/etc/profile \u306e\u30c7\u30d5\u30a9\u30eb\u30c8 umask \u306f 027 \u306a\u3069\u3088\u308a\u53b3\u3057\u304f\u8a2d\u5b9a\u3067\u304d\u307e\u3059**\n\n    ```bash\n    sed -i \"s/umask 002/umask 027/\" /etc/profile\n    sed -i \"s/umask 022/umask 027/\" /etc/profile\n    ```\n    umask\u5024 `027` \u306f\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306e `740` \u306b\u5bfe\u5fdc\u3059\u308b\u3002\n\n\n99. **/home \u306e\u5bb9\u91cf\u8d85\u904e\u6642\u306e\u5f71\u97ff\u3092\u6e1b\u3089\u3059\u305f\u3081\u306b /home \u3092\u5225\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u7f6e\u3044\u3066\u304f\u3060\u3055\u3044\n/tmp \u306e\u5bb9\u91cf\u8d85\u904e\u6642\u306e\u5f71\u97ff\u3092\u6e1b\u3089\u3059\u305f\u3081\u306b /tmp \u3092\u5225\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u7f6e\u3044\u3066\u304f\u3060\u3055\u3044\n/var \u306e\u5bb9\u91cf\u8d85\u904e\u6642\u306e\u5f71\u97ff\u3092\u6e1b\u3089\u3059\u305f\u3081\u306b /var \u3092\u5225\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u7f6e\u3044\u3066\u304f\u3060\u3055\u3044**\n\n    [6.10.4.5. \u63a8\u5968\u3055\u308c\u308b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u8a2d\u5b9a\u30b9\u30ad\u30fc\u30e0 - RHEL7 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30ac\u30a4\u30c9](https://access.redhat.com/documentation/ja-JP/Red_Hat_Enterprise_Linux/7/html/Installation_Guide/sect-disk-partitioning-setup-x86.html#sect-recommended-partitioning-scheme-x86)\n    [9.15.5. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u8a2d\u5b9a\u306b\u95a2\u3059\u308b\u63a8\u5968 - RHEL6 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30ac\u30a4\u30c9](https://access.redhat.com/documentation/ja-JP/Red_Hat_Enterprise_Linux/6/html/Installation_Guide/s2-diskpartrecommend-x86.html)\n    \n\n99. **\u4e0d\u6b63\u306a\u30b9\u30c8\u30ec\u30fc\u30b8\u3084\u30c7\u30fc\u30bf\u7a83\u76d7\u3092\u9632\u3050\u305f\u3081\u306b USB \u30b9\u30c8\u30ec\u30fc\u30b8\u306a\u3069\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u7121\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    echo \"blacklist usb-storage\" > /etc/modprobe.d/blacklist-usbstorage.conf\n    ```\n\n99. **\u4e0d\u6b63\u306a\u30b9\u30c8\u30ec\u30fc\u30b8\u3084\u30c7\u30fc\u30bf\u7a83\u76d7\u3092\u9632\u3050\u305f\u3081\u306b firewire \u30b9\u30c8\u30ec\u30fc\u30b8\u306a\u3069\u306e\u30c9\u30e9\u30a4\u30d0\u30fc\u3092\u4f7f\u308f\u306a\u3044\u5834\u5408\u306f\u7121\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044**\n\n\n    ```bash\n    echo \"blacklist firewire_core\" > /etc/modprobe.d/blacklist-firewire.conf\n    echo \"blacklist firewire_ohci\" >> /etc/modprobe.d/blacklist-firewire.conf\n    ```\n\n99. **localhost \u3068\u30b7\u30b9\u30c6\u30e0\u306e hostname \u306e\u89e3\u6c7a\u3092\u5206\u96e2\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    sed -i '/::1/s/^/#/' /etc/hosts\n    ```\n\n    `::1` \u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3059\u308b\u3068 Suggestion \u306b\u51fa\u306a\u304f\u306f\u306a\u308b\u304c\u2026\u3002\n\n99. **\u30d1\u30c3\u30b1\u30fc\u30b8\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c1\u30a7\u30c3\u30af\u306e\u3088\u308a\u826f\u3044\u4e00\u8cab\u6027\u3092\u4fdd\u3064\u305f\u3081\u306b 'yum-utils' \u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    yum install yum-utils\n    ```\n\n99. **arpwatch \u306e\u3088\u3046\u306a ARP \u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    yum install arpwatch\n    systemctl enable arpwatch\n    systemctl start arpwatch\n    ```\n\n99. **You are advised to hide the mail_name (option: smtpd_banner) from your postfix configuration. Use postconf -e or change your main.cf file (/etc/postfix/main.cf)**\n\n\n99. **SSH \u306e\u8a2d\u5b9a\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u3092\u691c\u8a0e\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    cp -a /etc/ssh/sshd_config{,.org}\n    ```\n\n    99. Details: AllowTcpForwarding (YES --> NO)\n\n        ```bash\n        sed -i 's/#AllowTcpForwarding yes/AllowTcpForwarding no/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: ClientAliveCountMax (3 --> 2)\n\n        ```bash\n        sed -i 's/#ClientAliveCountMax 3/ClientAliveCountMax 2/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: Compression (DELAYED --> NO)\n\n        ```bash\n        sed -i 's/#Compression delayed/Compression no/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: LogLevel (INFO --> VERBOSE)\n\n        ```bash\n        sed -i 's/#LogLevel INFO/LogLevel VERBOSE/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: MaxAuthTries (6 --> 1)\n\n        ```bash\n        sed -i 's/#MaxAuthTries 6/MaxAuthTries 1/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: MaxSessions (10 --> 2)\n\n        ```bash\n        sed -i 's/#MaxSessions 10/MaxSessions 2/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: PermitRootLogin (YES --> NO)\n\n        ```bash\n        sed -i 's/#PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: Port (22 --> )\n\n        ```bash\n        sed -i 's/#Port 22/Port 10022/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: TCPKeepAlive (YES --> NO)\n\n        ```bash\n        sed -i 's/#TCPKeepAlive yes/TCPKeepAlive no/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: UseDNS (YES --> NO)\n\n        ```bash\n        sed -i 's/#UseDNS yes/UseDNS no/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: X11Forwarding (YES --> NO)\n\n        ```bash\n        sed -i 's/X11Forwarding yes/X11Forwarding no/' /etc/ssh/sshd_config\n        ````\n\n    99. Details: AllowAgentForwarding (YES --> NO)\n\n        ```bash\n        sed -i 's/#AllowAgentForwarding yes/AllowAgentForwarding no/' /etc/ssh/sshd_config\n        ````\n\n99. **\u4e0d\u6b63\u30e6\u30fc\u30b6\u30fc\u306b\u8b66\u544a\u3059\u308b\u305f\u3081\u306b legal banner \u3092 /etc/issue \u306b\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    (echo; echo \"Unauthorized access to this machine is prohibited.\"; echo \"Disconnect now if you are not an authorized user.\"; echo) > /etc/issue\n    ```\n\n99. **\u4e0d\u6b63\u30e6\u30fc\u30b6\u30fc\u306b\u8b66\u544a\u3059\u308b\u305f\u3081\u306b legal banner \u3092 /etc/issue.net \u306b\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    (echo; echo \"Unauthorized access to this machine is prohibited.\"; echo \"Disconnect now if you are not an authorized user.\"; echo) > /etc/issue.net\n    ```\n\n99. **\u30d7\u30ed\u30bb\u30b9\u30a2\u30ab\u30a6\u30f3\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    yum install psacct\n    systemctl enable psacct\n    systemctl start psacct\n    ```\n\n    `lastcomm` \u30b3\u30de\u30f3\u30c9\u3067\u5c65\u6b74\u3092\u51fa\u529b\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n99. **\u30a2\u30ab\u30a6\u30f3\u30c6\u30a3\u30f3\u30b0\u3092\u53ce\u96c6\u3059\u308b\u305f\u3081\u306b sysstat \u3092\u6709\u52b9\u306b\u3057\u3066\u304f\u3060\u3055\u3044 (no results)**\n\n    ```bash\n    yum install sysstat\n    ```\n\n99. **Audit \u30c7\u30fc\u30e2\u30f3\u304c\u7a7a\u306e\u30eb\u30fc\u30eb\u30bb\u30c3\u30c8\u3067\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u30c7\u30fc\u30e2\u30f3\u3092\u7121\u52b9\u306b\u3059\u308b\u304b\u3001\u30eb\u30fc\u30eb\u3092\u5b9a\u7fa9\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    echo '-a exit,always -F arch=b64 -F euid=0 -S execve' >> /etc/audit/audit.rules\n    echo '-a exit,always -F arch=b32 -F euid=0 -S execve' >> /etc/audit/audit.rules\n    service auditd restart\n    ```\n\n    `systemctl restart auditd` \u3092\u5b9f\u884c\u3059\u308b\u3068 `Failed to restart auditd.service: Operation refused, unit auditd.service may be requested by dependency only.` \u3068\u8a00\u308f\u308c\u3066\u5931\u6557\u3059\u308b\u306e\u3067 `service` \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3046\u3002[^auditd]\n\n    [7.5. Audit \u30eb\u30fc\u30eb\u306e\u5b9a\u7fa9](https://access.redhat.com/documentation/ja-JP/Red_Hat_Enterprise_Linux/6/html/Security_Guide/sec-Defining_Audit_Rules_and_Controls.html)\n\n[^auditd]: https://bugzilla.redhat.com/show_bug.cgi?id=1026648\n\n99. **\u30b7\u30b9\u30c6\u30e0\u7ba1\u7406\u306e\u81ea\u52d5\u5316\u30c4\u30fc\u30eb\u304c\u3042\u308c\u3070\u6c7a\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    yum install puppet-server\n    systemctl enable puppetmaster\n    systemctl start puppetmaster\n    ```\n\n    ```bash\n    yum install salt-master\n    systemctl enable salt-master\n    systemctl start salt-master\n    ```\n\n    puppetmaster \u304b salt-master \u306e\u3044\u305a\u308c\u304b\u3002\n\n99. **1\u3064\u4ee5\u4e0a\u306e sysctl \u306e\u5024\u304c\u30b9\u30ad\u30e3\u30f3\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3068\u7570\u306a\u308a\u8abf\u6574\u306e\u4f59\u5730\u304c\u3042\u308a\u307e\u3059**\n\n    ```bash\n    lynis --quick --verbose --tests KRNL-6000\n    grep \"different value\" /var/log/lynis.log | awk '{ gsub(\"Expected\",\"\"); gsub(\",\",\"\"); print $6 $16 }'\n    grep \"different value\" /var/log/lynis.log | awk '{ gsub(\"Expected\",\"\"); gsub(\",\",\"\"); print $6 $16 }' >> /etc/sysctl.conf\n    sysctl -p\n    ```\n\n99. **root \u30e6\u30fc\u30b6\u30fc\u306e\u307f\u306b\u30a2\u30af\u30bb\u30b9\u3092\u5236\u9650\u3059\u308b\u306a\u3069\u30b3\u30f3\u30d1\u30a4\u30e9\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u5f37\u5316\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ```bash\n    lynis --quick --verbose --tests HRDN-7222\n    grep \"world executable\" /var/log/lynis.log | awk '{ print $5 }' | xargs ls -l\n    grep \"world executable\" /var/log/lynis.log | awk '{ print $5 }' | xargs chmod 700\n    ```\n\n99. **\u5b9a\u671f\u7684\u306a\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u30b9\u30ad\u30e3\u30f3\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u3001\u5c11\u306a\u304f\u3068\u3082\u4e00\u3064\u306e\u30de\u30eb\u30a6\u30a7\u30a2\u30b9\u30ad\u30e3\u30ca\u30fc\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u3067\u30b7\u30b9\u30c6\u30e0\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u3057\u3066\u304f\u3060\u3055\u3044**\n\n    ##### \u7dcf\u5408\u30a6\u30a4\u30eb\u30b9\u691c\u51fa\n    * [ClamAV](http://qiita.com/bezeklik/items/4696e15c889ffff6bc41) \u307e\u305f\u306f\u5546\u7528\u306e\u4ee3\u66ff\u88fd\u54c1\n\n    ##### \u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\n    * [Rootkit Hunter (rkhunter)](http://qiita.com/bezeklik/items/bc7affef8afe7c63f2ce)\n    * [Chkrootkit](http://qiita.com/bezeklik/items/7964ce67f1a1363b694e)\n    * [OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38)\n\n    ##### Web\u30b5\u30fc\u30d0\u30fc\u7528\u30de\u30eb\u30a6\u30a7\u30a2\u691c\u51fa\n    * [Linux Malware Detect (LMD)](http://qiita.com/bezeklik/items/43a7d4fce6bc23fe84d3)\n\n# \u5bfe\u7b56\u307e\u3068\u3081\n```bash\nsed -i.org \"s/#smtpd_banner = \\$myhostname ESMTP \\$mail_name$/smtpd_banner = \\$myhostname ESMTP/\" /etc/postfix/main.cf\nsed -i.org 's/PASS_MIN_DAYS\\t0/PASS_MIN_DAYS\\t1/' /etc/login.defs\nsed -i 's/PASS_MAX_DAYS\\t99999/PASS_MAX_DAYS\\t3650/' /etc/login.defs\nsed -i.org \"s/umask 002/umask 027/\" /etc/profile\nsed -i \"s/umask 022/umask 027/\" /etc/profile\necho \"blacklist usb-storage\" > /etc/modprobe.d/blacklist-usbstorage.conf\necho \"blacklist firewire_core\" > /etc/modprobe.d/blacklist-firewire.conf\necho \"blacklist firewire_ohci\" >> /etc/modprobe.d/blacklist-firewire.conf\nsed -i '/::1/s/^/#/' /etc/hosts\nyum install yum-utils arpwatch psacct sysstat\nsystemctl enable arpwatch psacct\nsystemctl start arpwatch psacct\nsed -i.org 's/#AllowTcpForwarding yes/AllowTcpForwarding no/' /etc/ssh/sshd_config\nsed -i 's/#ClientAliveCountMax 3/ClientAliveCountMax 2/' /etc/ssh/sshd_config\nsed -i 's/#Compression delayed/Compression no/' /etc/ssh/sshd_config\nsed -i 's/#LogLevel INFO/LogLevel VERBOSE/' /etc/ssh/sshd_config\nsed -i 's/#MaxAuthTries 6/MaxAuthTries 1/' /etc/ssh/sshd_config\nsed -i 's/#MaxSessions 10/MaxSessions 2/' /etc/ssh/sshd_config\nsed -i 's/#PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config\nsed -i 's/#Port 22/Port 10022/' /etc/ssh/sshd_config\nsed -i 's/#TCPKeepAlive yes/TCPKeepAlive no/' /etc/ssh/sshd_config\nsed -i 's/#UseDNS yes/UseDNS no/' /etc/ssh/sshd_config\nsed -i 's/X11Forwarding yes/X11Forwarding no/' /etc/ssh/sshd_config\nsed -i 's/#AllowAgentForwarding yes/AllowAgentForwarding no/' /etc/ssh/sshd_config\n(echo; echo \"Unauthorized access to this machine is prohibited.\"; echo \"Disconnect now if you are not an authorized user.\"; echo) > /etc/issue\n(echo; echo \"Unauthorized access to this machine is prohibited.\"; echo \"Disconnect now if you are not an authorized user.\"; echo) > /etc/issue.net\nlynis --quick --verbose --tests KRNL-6000\ngrep \"different value\" /var/log/lynis.log | awk '{ gsub(\"Expected\",\"\"); gsub(\",\",\"\"); print $6 $16 }'\ngrep \"different value\" /var/log/lynis.log | awk '{ gsub(\"Expected\",\"\"); gsub(\",\",\"\"); print $6 $16 }' >> /etc/sysctl.conf\nsysctl -p\nlynis --quick --verbose --tests HRDN-7222\ngrep \"world executable\" /var/log/lynis.log | awk '{ print $5 }' | xargs ls -l\ngrep \"world executable\" /var/log/lynis.log | awk '{ print $5 }' | xargs chmod 700\nyum install epel-release\nyum install rkhunter unhide\nrkhunter -c --rwo --sk\n```\n\n# \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n* [PHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin](http://qiita.com/bezeklik/items/5e8b1f76465e39dc6cd0)\n* [DoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1](http://qiita.com/bezeklik/items/6d86a162e278f576e4ca)\n* [Linux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV](http://qiita.com/bezeklik/items/4696e15c889ffff6bc41)\n* [Linux Malware Detect](http://qiita.com/bezeklik/items/43a7d4fce6bc23fe84d3)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)](http://qiita.com/bezeklik/items/bc7affef8afe7c63f2ce)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit](http://qiita.com/bezeklik/items/7964ce67f1a1363b694e)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK](http://qiita.com/bezeklik/items/298dafd2aeb053b4ca88)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE](http://qiita.com/bezeklik/items/d144d77a3e54cd35c06b)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS](http://qiita.com/bezeklik/items/a64cad37eb03a1db2de4)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto](http://qiita.com/bezeklik/items/12643654dc0c45f4eb29)\n* [Linux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis](http://qiita.com/bezeklik/items/cf9be2deb546c69123e7)\n", "tags": ["Lynis2.2.0, 2.3.2", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3", "CentOS5, 6, 7", "Linux"]}