{"context": " More than 1 year has passed since last update.roo\u3067\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u6271\u3046\u3068\u304d\u306b\u4f7f\u3063\u305f\u3002\n\n\u6587\u5b57\u5217\u304b\u3089\u6570\u5024\u306b\u5909\u63db\ncell_addr\u306b\u6587\u5b57\u5217\u3092\u5165\u308c\u3066\u5b9f\u884c\u3059\u308b\u3068\u884c\u756a\u53f7\u3068\u5217\u756a\u53f7\u304c\u53d6\u308c\u308b\u3002\n[cell_addr[/\\d+/].to_i,cell_addr[/[A-Z]+/].chars.inject(0){|a,b|a*26+('A'..'Z').find_index(b)+1}]\n\n\u30e1\u30bd\u30c3\u30c9\u5316\u3057\u3066\u4f7f\u3046\u3068\u3053\u3093\u306a\u611f\u3058\u3002\ndef cell_addr_str_to_num(cell_addr)\n  [cell_addr[/\\d+/].to_i,cell_addr[/[A-Z]+/].chars.inject(0){|a,b|a*26+('A'..'Z').find_index(b)+1}]\nend\n\ncell_addr_str_to_num(\"A1\")    # => [ 1,  1]\ncell_addr_str_to_num(\"AB12\")  # => [12, 28]\n\n# \u884c\u756a\u53f7\u3068\u5217\u756a\u53f7\u3092\u5225\u3005\u306b\u53d6\u308b\u3068\u304d\nrow, col = cell_addr_str_to_num(\"B3\")\nrow                           # => 3\ncol                           # => 2\n\n\n\u6570\u5024\u304b\u3089\u6587\u5b57\u5217\u306b\u5909\u63db\nrow, col\u306b\u6570\u5024\u3092\u5165\u308c\u3066\u5b9f\u884c\u3059\u308b\u3068\u6587\u5b57\u5217\u304c\u53d6\u308c\u308b\u3002\ncol.to_s(26).chars.map{|a|('A'..'Z').to_a[a.to_i(26)-1]}.join+row.to_s\n\n\u30e1\u30bd\u30c3\u30c9\u5316\u3057\u3066\u4f7f\u3046\u3068\u3053\u3093\u306a\u611f\u3058\u3002\ndef cell_addr_num_to_str(row, col)\n  col.to_s(26).chars.map{|a|('A'..'Z').to_a[a.to_i(26)-1]}.join+row.to_s\nend\n\ncell_addr_num_to_str(1, 1)    # => \"A1\"\ncell_addr_num_to_str(12, 28)  # => \"AB12\"\n\n# \u884c\u756a\u53f7\u3068\u5217\u756a\u53f7\u3092\u914d\u5217\u3067\u6e21\u3059\u3068\u304d\naddr = [3, 2]\ncell_addr_num_to_str(*addr)   # => \"B3\"\n\n[roo](http://roo.rubyforge.org)\u3067\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u6271\u3046\u3068\u304d\u306b\u4f7f\u3063\u305f\u3002\n\n\u6587\u5b57\u5217\u304b\u3089\u6570\u5024\u306b\u5909\u63db\n====================\n\n`cell_addr`\u306b\u6587\u5b57\u5217\u3092\u5165\u308c\u3066\u5b9f\u884c\u3059\u308b\u3068\u884c\u756a\u53f7\u3068\u5217\u756a\u53f7\u304c\u53d6\u308c\u308b\u3002\n\n```rb\n[cell_addr[/\\d+/].to_i,cell_addr[/[A-Z]+/].chars.inject(0){|a,b|a*26+('A'..'Z').find_index(b)+1}]\n```\n\n\u30e1\u30bd\u30c3\u30c9\u5316\u3057\u3066\u4f7f\u3046\u3068\u3053\u3093\u306a\u611f\u3058\u3002\n\n```rb\ndef cell_addr_str_to_num(cell_addr)\n  [cell_addr[/\\d+/].to_i,cell_addr[/[A-Z]+/].chars.inject(0){|a,b|a*26+('A'..'Z').find_index(b)+1}]\nend\n\ncell_addr_str_to_num(\"A1\")    # => [ 1,  1]\ncell_addr_str_to_num(\"AB12\")  # => [12, 28]\n\n# \u884c\u756a\u53f7\u3068\u5217\u756a\u53f7\u3092\u5225\u3005\u306b\u53d6\u308b\u3068\u304d\nrow, col = cell_addr_str_to_num(\"B3\")\nrow                           # => 3\ncol                           # => 2\n```\n\n\u6570\u5024\u304b\u3089\u6587\u5b57\u5217\u306b\u5909\u63db\n====================\n\n`row`, `col`\u306b\u6570\u5024\u3092\u5165\u308c\u3066\u5b9f\u884c\u3059\u308b\u3068\u6587\u5b57\u5217\u304c\u53d6\u308c\u308b\u3002\n\n```rb\ncol.to_s(26).chars.map{|a|('A'..'Z').to_a[a.to_i(26)-1]}.join+row.to_s\n```\n\n\u30e1\u30bd\u30c3\u30c9\u5316\u3057\u3066\u4f7f\u3046\u3068\u3053\u3093\u306a\u611f\u3058\u3002\n\n```rb\ndef cell_addr_num_to_str(row, col)\n  col.to_s(26).chars.map{|a|('A'..'Z').to_a[a.to_i(26)-1]}.join+row.to_s\nend\n\ncell_addr_num_to_str(1, 1)    # => \"A1\"\ncell_addr_num_to_str(12, 28)  # => \"AB12\"\n\n# \u884c\u756a\u53f7\u3068\u5217\u756a\u53f7\u3092\u914d\u5217\u3067\u6e21\u3059\u3068\u304d\naddr = [3, 2]\ncell_addr_num_to_str(*addr)   # => \"B3\"\n```\n", "tags": ["Ruby", "Excel", "Roo", "spreadsheet"]}