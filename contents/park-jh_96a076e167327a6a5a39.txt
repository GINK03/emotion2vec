{"context": "\n\n\u95a2\u9023\u8a18\u4e8b\n\nChef\u3092\u4f7f\u3063\u3066\u3088\u308a\u52b9\u7387\u7684\u306b\u30b5\u30fc\u30d0\u3092\u7ba1\u7406\u3057\u3088\u3046\u3002\u307e\u305a\u306f\u7528\u8a9e\u304b\u3089\nBerkshelf\u3092\u4f7f\u3063\u3066\u5916\u90e8\u30af\u30c3\u30af\u30d6\u30c3\u30af\u3092\u30ce\u30fc\u30c9\u306b\u9069\u7528\u3059\u308b\u3002\n\u30af\u30c3\u30af\u30d6\u30c3\u30af\u3092\u4f5c\u6210\u3057\u3066\u30ce\u30fc\u30c9\u306b\u9069\u7528\u3059\u308b\u3002- \u305d\u306e\uff11\n\u30af\u30c3\u30af\u30d6\u30c3\u30af\u3092\u4f5c\u6210\u3057\u3066\u30ce\u30fc\u30c9\u306b\u9069\u7528\u3059\u308b\u3002- \u305d\u306e\uff12\nChef\u3067CentOS 6.7 + rbenv + ruby 2.3.0\u306e\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u3002\nChef\u3067CentOS 6.7 + Vim 7.4 + lua\u3092\u8a2d\u7f6e\u3059\u308b\u3002\nChef\u3067Vim\u30d7\u30e9\u30b0\u30a4\u30f3\u30de\u30cd\u30fc\u30b8\u30e3\u30fcNeoBundle\u3092\u8a2d\u7f6e\u3059\u308b\u3002\nChef\u306e\u30ec\u30b7\u30d4\u3092\u30c7\u30d0\u30c3\u30b0\u3057\u3066\u307f\u3088\u3046\u3002\nChef\u3067CentOS 6.7 + nginx\u3092\u8a2d\u7f6e\u3059\u308b\u3002- \u5916\u90e8\u30af\u30c3\u30af\u30d6\u30c3\u30af\nChef\u3067CentOS 6.7 + nginx\u3092\u8a2d\u7f6e\u3059\u308b\u3002- \u30ab\u30b9\u30bf\u30e0\u30af\u30c3\u30af\u30d6\u30c3\u30af\nChef\u3067CentOS 6.7 + nodejs + npm\u3092\u8a2d\u7f6e\u3059\u308b\u3002\nChef\u3067Vim\u30d7\u30e9\u30b0\u30a4\u30f3\u30de\u30cd\u30fc\u30b8\u30e3\u30fcvim-plug\u3092\u8a2d\u7f6e\u3059\u308b\u3002\nohai\u306e\u30ab\u30b9\u30bf\u30e0\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f5c\u3063\u3066\u307f\u3088\u3046\u3002\nChef Solo\u304b\u3089Chef Zero\u3078\nChef\u3067nginx + php(php-fpm) + mariadb + wordpress\u3092\u8a2d\u7f6e\u3059\u308b\u3002\n\n\n\u81ea\u4f5c\u3057\u305fvim-plugin\u30ec\u30b7\u30d4\u306e\u4e0d\u5177\u5408\n\n\u524d\u56de\u306e\u8a18\u4e8b\u3067\u5f8c\u5473\u304c\u60aa\u304b\u3063\u305f\u4e0d\u5177\u5408\u3092\u89e3\u6d88\u3057\u305f\u306e\u3067\u66f8\u3044\u3066\u307f\u308b\u3002\nChef\u3067\u306fchef-shell\u3068\u3044\u3046irb\u3092\u63d0\u4f9b\u3057\u3066\u3044\u308b\u3002\u3053\u308c\u3092\u4f7f\u3063\u3066\u30c7\u30d0\u30c3\u30b0\u3057\u3066\u307f\u3088\u3046\u3002\nchef-shell\u306e\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u3050\u3050\u3063\u3066\u307f\u305f\u304c\u3001\u8a73\u7d30\u306a\u4f7f\u3044\u65b9\u304c\u51fa\u3066\u6765\u306a\u3044\u3002\nChef\u306e\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3068\u6b21\u306e\u30b5\u30a4\u30c8\u304c\u53c2\u8003\u306b\u306a\u3063\u305f\u3002\n\n\nhttps://docs.chef.io/chef_shell.html\nhttp://blog.jonliv.es/blog/2012/02/07/chef-development-with-shef/\nhttp://stevendanna.github.io/blog/2012/01/28/shef-debugging-tips-1/\n\n\n\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4ee5\u5916\u306e\u53c2\u8003\u30b5\u30a4\u30c8\u306f\u5c11\u3057\u53e4\u3044\u306e\u3067\u3001shef\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u304c\u3001\u73fe\u5728\u306fchef-shell\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\nchef-shell\uff08\u65e7shef\uff09\n\nchef-shell\u306fchef-solo\u3084chef-client\u74b0\u5883\u3067\u4f7f\u3046\u3082\u306e\u3067\u3042\u308b\u3002\n\u30db\u30b9\u30c8\uff08\u30ec\u30b7\u30d4\u3092\u6271\u3046\u30ed\u30fc\u30ab\u30eb\u7aef\u672b\uff09\u3067\u306f\u306a\u304f\u30b2\u30b9\u30c8\uff08\u30ce\u30fc\u30c9\uff09\u3067\u5b9f\u884c\u3059\u308b\u3002\n\n\n\u8d77\u52d5\n\n\u308f\u304b\u3089\u306a\u3044\u3068\u56f0\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\u3060\u3051\u6697\u8a18\u3057\u3066\u304a\u304f\u3002\n\n\n-s\uff1achef-solo\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\n-z\uff1achef-client\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\n-a\uff1a\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30f3\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\n-c\uff1a\u4f7f\u7528\u3059\u308b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n-j\uff1achef-solo\u30e2\u30fc\u30c9\u306e\u307f\u6709\u52b9\u3067run_list\u3092\u542b\u3080Node\u306eAttribute\u3068\u3057\u3066\u4f7f\u3046JSON\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\n\n\nhelp\u3092\u5165\u529b\u3059\u308b\u3068\u30b3\u30de\u30f3\u30c9\u3068\u305d\u306e\u8aac\u660e\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n\u7d42\u4e86\u3057\u305f\u3044\u5834\u5408\u306fexit\u3092\u5165\u529b\u3059\u308b\u3002\n\n$ cd chef-solo\n$ chef-shell -s -c solo.rb -j dna.json\n\nloading configuration: solo.rb\nSession type: solo\nLoading...done.\n\nThis is the chef-shell.\n Chef Version: 12.7.2\n http://www.chef.io/\n http://docs.chef.io/\n\nrun `help' for help, `exit' or ^D to quit.\n\nOhai2u vagrant@dev!\nchef (12.7.2)>\n\n\n\u30ec\u30b7\u30d4\u30e2\u30fc\u30c9\n\n\u30ec\u30b7\u30d4\u3092\u78ba\u8a8d\u3059\u308b\u3068\u304d\u4f7f\u3046\u3002\ninclude_recipe\u3092\u4f7f\u3063\u3066\u554f\u984c\u304c\u3042\u308b\u30ec\u30b7\u30d4\u3092\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3059\u308b\u3002\nrun_chef\u3067\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3057\u305f\u30ec\u30b7\u30d4\u3092\u5b9f\u884c\u3059\u308b\u3002\n\u3059\u3053\u3057\u9577\u3044\u304cdirectory\u90e8\u5206\u306b\u554f\u984c\u304c\u3042\u308b\u3053\u3068\u306f\u3059\u3050\u308f\u304b\u3063\u305f\u3002\nnode['user']\u304c\u8aad\u307f\u8fbc\u307e\u308c\u3066\u306a\u3044\u3002\n\nchef (12.7.2)> recipe_mode\nchef:recipe (12.7.2)> include_recipe \"vim-plugin::default\"\nchef:recipe (12.7.2)> run_chef\n[2016-02-25T11:51:33+00:00] INFO: Processing directory[/home//.vim] action create (vim-plugin::default line 10)\n[2016-02-25T11:51:33+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:51:33+00:00] DEBUG: Provider for action create on resource directory[/home//.vim] is Chef::Provider::Directory\n\n================================================================================\nError executing action `create` on resource 'directory[/home//.vim]'\n================================================================================\n\nChef::Exceptions::InsufficientPermissions\n-----------------------------------------\nCannot create directory[/home//.vim] at /home//.vim due to insufficient permissions\n\nResource Declaration:\n---------------------\n# In /home/vagrant/chef-solo/cookbooks-3/vim-plugin/recipes/default.rb\n\n 10: directory \"/home/#{node['user']}/.vim\" do\n 11:   owner node['user']\n 12:   group node['group']\n 13:   mode '0755'\n 14:   action :create\n 15: end\n 16:\n\nCompiled Resource:\n------------------\n# Declared in /home/vagrant/chef-solo/cookbooks-3/vim-plugin/recipes/default.rb:10:in `from_file'\n\ndirectory(\"/home//.vim\") do\n  action [:create]\n  retries 0\n  retry_delay 2\n  default_guard_interpreter :default\n  path \"/home//.vim\"\n  declared_type :directory\n  cookbook_name :\"vim-plugin\"\n  recipe_name \"default\"\n  mode \"0755\"\nend\n\n[2016-02-25T11:51:33+00:00] INFO: Running queued delayed notifications before re-raising exception\nChef::Exceptions::InsufficientPermissions: directory[/home//.vim] (vim-plugin::default line 10) had an error: Chef::Exceptions::InsufficientPermissions: Cannot create directory[/home//.vim] at /home//.vim due to insufficient permissions\n\n... snip ...\n\n\nsolo.rb\n\nchef-solo\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3002chef-client\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306fclient.rb\u3067\u3042\u308b\u3002\nsolo.rb\u3092\u78ba\u8a8d\u3057\u305f\u3089\u3001environment\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\uff08_default\uff09\u306b\u306a\u3063\u3066\u3044\u305f\u3002\nuser\u3084group\u306a\u3069\u306eattribute\u306fenvironments\uff08development.json\uff09\u306b\u4fdd\u6301\u3057\u3066\u3044\u308b\u3002\nnode\uff08dev.json\uff09\u306echef_environment\u3082development\u306b\u8a2d\u5b9a\u3057\u305f\u304c\u305d\u308c\u304c\u9069\u7528\u3055\u308c\u3066\u306a\u3044\u3002\n\n[vagrant@dev chef-solo]$ cat solo.rb\nnode_name \"dev\"\n\nbase = File.expand_path('..', __FILE__)\n\nnodes_path                File.join(base, 'nodes')\nrole_path                 File.join(base, 'roles')\ndata_bag_path             File.join(base, 'data_bags')\nencrypted_data_bag_secret File.join(base, 'data_bag_key')\nenvironment_path          File.join(base, 'environments')\nenvironment               \"_default\"\nssl_verify_mode           :verify_peer\n\ncookbook_path []\ncookbook_path << File.join(base, 'cookbooks-1') # /Users/devnote/Documents/study/chef/vendor/bundle/ruby/2.2.0/gems/knife-solo-0.5.1/lib/knife-solo/resources/patch_cookbooks\ncookbook_path << File.join(base, 'cookbooks-2') # /Users/devnote/Documents/study/chef/cookbooks\ncookbook_path << File.join(base, 'cookbooks-3') # /Users/devnote/Documents/study/chef/site-cookbooks\n\n\nsolo.rb\u306e_default\u3092development\u3067\u4fee\u6b63\u3057\u305f\u3002\n\n$ sed -i -e \"s/_default/development/g\" solo.rb\n$ cat solo.rb\nnode_name \"dev\"\n\nbase = File.expand_path('..', __FILE__)\n\nnodes_path                File.join(base, 'nodes')\nrole_path                 File.join(base, 'roles')\ndata_bag_path             File.join(base, 'data_bags')\nencrypted_data_bag_secret File.join(base, 'data_bag_key')\nenvironment_path          File.join(base, 'environments')\nenvironment               \"development\"\nssl_verify_mode           :verify_peer\n\ncookbook_path []\ncookbook_path << File.join(base, 'cookbooks-1') # /Users/devnote/Documents/study/chef/vendor/bundle/ruby/2.2.0/gems/knife-solo-0.5.1/lib/knife-solo/resources/patch_cookbooks\ncookbook_path << File.join(base, 'cookbooks-2') # /Users/devnote/Documents/study/chef/cookbooks\ncookbook_path << File.join(base, 'cookbooks-3') # /Users/devnote/Documents/study/chef/site-cookbooks\n\n\n\u30ec\u30b7\u30d4\u30e2\u30fc\u30c9\u3067\u3082\u3046\u4e00\u5ea6\u78ba\u8a8d\u3057\u305f\u3089\u3001\u4eca\u5ea6\u306f\u6b63\u5e38\u306b\u5b9f\u884c\u3055\u308c\u305f\u3002\n\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u554f\u984c\u304c\u306a\u3044\u3002\n\nchef:recipe (12.7.2)> include_recipe \"vim-plugin::default\"\nchef:recipe (12.7.2)> run_chef\n[2016-02-25T11:57:55+00:00] INFO: Processing directory[/home/vagrant/.vim] action create (vim-plugin::default line 10)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action create on resource directory[/home/vagrant/.vim] is Chef::Provider::Directory\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing directory[/home/vagrant/.vim/backup] action create (vim-plugin::default line 18)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action create on resource directory[/home/vagrant/.vim/backup] is Chef::Provider::Directory\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing directory[/home/vagrant/.vim/bundle] action create (vim-plugin::default line 18)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action create on resource directory[/home/vagrant/.vim/bundle] is Chef::Provider::Directory\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing directory[/home/vagrant/.vim/swap] action create (vim-plugin::default line 18)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action create on resource directory[/home/vagrant/.vim/swap] is Chef::Provider::Directory\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing execute[install neobundle] action run (vim-plugin::default line 26)\n[2016-02-25T11:57:55+00:00] DEBUG: Skipping execute[install neobundle] due to not_if ruby block\n[2016-02-25T11:57:55+00:00] INFO: Processing cookbook_file[/home/vagrant/.vimrc_scss_indent] action create (vim-plugin::default line 36)\n[2016-02-25T11:57:55+00:00] DEBUG: cookbook_file[/home/vagrant/.vimrc_scss_indent] checksumming file at /home/vagrant/.vimrc_scss_indent.\n[2016-02-25T11:57:55+00:00] DEBUG: cookbook_file[/home/vagrant/.vimrc_scss_indent] staging /home/vagrant/chef-solo/cookbooks-3/vim-plugin/files/default/.vimrc_scss_indent to /home/vagrant/..vimrc_scss_indent20160225-6651-1b7m1of\n[2016-02-25T11:57:55+00:00] DEBUG: calculating checksum of /home/vagrant/..vimrc_scss_indent20160225-6651-1b7m1of to compare with 05be8b3325aa3c67568c37216114a0a530a55dc9d199d7476a82d306b969222e\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing cookbook_file[/home/vagrant/.vimrc] action create (vim-plugin::default line 36)\n[2016-02-25T11:57:55+00:00] DEBUG: cookbook_file[/home/vagrant/.vimrc] checksumming file at /home/vagrant/.vimrc.\n[2016-02-25T11:57:55+00:00] DEBUG: cookbook_file[/home/vagrant/.vimrc] staging /home/vagrant/chef-solo/cookbooks-3/vim-plugin/files/default/.vimrc to /home/vagrant/..vimrc20160225-6651-1i2xivg\n[2016-02-25T11:57:55+00:00] DEBUG: calculating checksum of /home/vagrant/..vimrc20160225-6651-1i2xivg to compare with bd258180199e8ac6b76be5c6de6067e4396d5563490666a932ebe1bfc02e0133\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing execute[install vim plugin via neobundle] action run (vim-plugin::default line 43)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic execute resource enabled on node include: [Chef::Provider::Execute]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action run on resource execute[install vim plugin via neobundle] is Chef::Provider::Execute\nnot found in 'runtimepath': \"ftdetect/*.vim\"\nnot found in 'runtimepath': \"colors/mopkai.vim\"\nError detected while processing /home/vagrant/.vimrc:\nline  707:\nE185: Cannot find color scheme 'mopkai'\n[neobundle] command AlpacaTagsSet is not found.\n[neobundle] Update started: (2016/02/25 11:57:55)\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\n[neobundle] ( 1/65) [                    ] vimproc.vim\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\n\n... snip ...\n\nneobundle] (65/65) [====================] vim-haml\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\n[neobundle] (65/65): |vim-haml| Updated\n[neobundle]\n[neobundle] Installed bundles:\n[neobundle]   vimproc.vim\n\n... snip ...\n\n[neobundle]   vim-haml\n[neobundle] Update done: (2016/02/25 12:01:06)\n[2016-02-25T12:01:06+00:00] INFO: execute[install vim plugin via neobundle] ran successfully\n => true\nchef:recipe (12.7.2)>\n\n\nknife-solo\u3092\u5b9f\u884c\u3059\u308b\u3068\u304d\u3001-E\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u304d\u3067Environments\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\nknife-solo\u3092\u4f7f\u3046\u305f\u3073\u306b-E\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u306a\u3044\u3068_default\u3067\u6307\u5b9a\u3055\u308c\u3066\u3057\u307e\u3046\u3002\n\u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\n\n\nvagrant destroy\nvagrant up\nbin/knife solo bootstrap dev -E development\n\n\n\u3057\u304b\u3057\u3001\u4eca\u5ea6\u3082neoinstall\u51e6\u7406\u304c\u65e9\u304b\u3063\u305f\u3002\u30ce\u30fc\u30c9\u3092\u8abf\u3079\u305f\u304c\u3084\u306f\u308a\u8a2d\u7f6e\u3055\u308c\u3066\u306a\u3044\u3002\n\n\nscript\u51e6\u7406\n\n\u554f\u984c\u70b9\n\n\u30ea\u30bd\u30fc\u30b9\u5185\u3067\u5b9a\u7fa9\u3057\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u306froot\u6a29\u9650\u3067\u5b9f\u884c\u3055\u308c\u308b\u3002\nuser\u3001group\u3001environment\u3092\u6307\u5b9a\u3059\u308b\u3068\u305d\u306e\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\u3055\u308c\u308b\u3068\u601d\u3063\u3066\u3044\u305f\u304c\u3001\u305d\u3046\u3067\u306f\u306a\u3044\u307f\u305f\u3044\u3060\u3002\n\u305d\u3057\u3066\u3001vim\u3092tarball\u3067\u8a2d\u7f6e\u3057\u3066\u3082yum\u3067\u8a2d\u7f6e\u3057\u306a\u3044\u3068\u5b9f\u884c\u3059\u308b\u3068\u304d\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u3002\n\nvim: command not found\n\n\n\u89e3\u6c7a\u7b56\n\n\u6700\u7d42\u7684\u306b\u306f\u6b21\u306e\u3088\u3046\u306b\u5909\u66f4\u3057\u305f\u3002\n\n\nyum\u3067\u3082vim\u3092\u8a2d\u7f6e\u3059\u308b\u3002\u3057\u304b\u3057\u3001vim\u3092\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f\u4ee5\u524dtarball\u3067\u8a2d\u7f6e\u3055\u308c\u305fvim\u304c\u512a\u5148\u3055\u308c\u308b\u3002\uff08/usr/local/bin\u304c\u512a\u5148\u3055\u308c\u308b\u305f\u3081\uff09\n\u30e6\u30fc\u30b6\u3092\u6307\u5b9a\u3057\u3066\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3002\n\u5b9f\u884c\u304c\u7d42\u308f\u3063\u305f\u3089.vim-neoinstalled\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3059\u308b\u3002\n.vim-neoinstalled\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306b\u9650\u3063\u3066\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\n\npackage 'vim' do\n  action :installl\nend\n\n... snip ...\n\nexecute 'install vim plugin via neobundle' do\n  user node['user']\n  group node['group']\n  cwd \"/home/#{node['user']}\"\n  environment 'HOME' => \"/home/#{node['user']}\"\n  command \"sudo -u #{node['user']} /home/#{node['user']}/.vim/bundle/neobundle.vim/bin/neoinstall 1>.vim-neoinstalled 2>.vim-neoinstalled\" \n  not_if { File.exists?(\"/home/#{node['user']}/.vim-neoinstalled\") }\nend\n\n\n\u6700\u7d42\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3059\u308b\n\n\nbreakpoint\uff08\u8ffd\u8a18\uff09\n\n\u4eca\u5ea6\u306fscript\u306b\u306f\u554f\u984c\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u4f7f\u3063\u3066\u3044\u306a\u3044\u304c\u4f7f\u3044\u65b9\u3060\u3051\u7c21\u5358\u306b\u66f8\u3044\u3066\u304a\u304f\u3002\nrecipe\u5185\u306bbreakpoint\u3092\u8a2d\u5b9a\u3059\u308b\u3002\nchef-shell\u306b\u3066run_chef\u3092\u5b9f\u884c\u3059\u308b\u3068breakpoint\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3068\u3053\u308d\u3067\u6b62\u307e\u308b\u3002\n\u9032\u307f\u305f\u3044\u3068\u304d\u306fchef_run.resume\u3092\u5165\u529b\u3059\u308b\u3002\n\nbreakpoint \"before bash 'install vim plugin via neobundle'\" do\n  action :break\nend\n\n\n\u611f\u60f3\n\nChef\u306f\u96e3\u3057\u3044\u3002\n\u65e5\u672c\u8a9e\u306e\u672c\u304c\u5c11\u306a\u3044\u3002\u5165\u9580\u66f8\u306b\u306f\u304b\u306a\u308a\u3044\u3044\u826f\u66f8\u304c2\u518a\u3042\u308b\u304c\u3001\u3082\u3063\u3068\u77e5\u308a\u305f\u3044\u5834\u5408\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u4f9d\u5b58\u3059\u308b\u3057\u304b\u306a\u3044\u3002\u307e\u3042\u5f53\u305f\u308a\u524d\u3060\u306a\u3002\n\n\n\u53c2\u8003\n\nhttps://github.com/Shougo/neobundle.vim\n\nhttps://docs.chef.io/chef_shell.html \nChef\u6d3b\u7528\u30ac\u30a4\u30c9\nChef\u5b9f\u8df5\u5165\u9580\n\n\n## \u95a2\u9023\u8a18\u4e8b\n\n* [Chef\u3092\u4f7f\u3063\u3066\u3088\u308a\u52b9\u7387\u7684\u306b\u30b5\u30fc\u30d0\u3092\u7ba1\u7406\u3057\u3088\u3046\u3002\u307e\u305a\u306f\u7528\u8a9e\u304b\u3089](http://qiita.com/park-jh/items/9e2e358d2e82a7736cf7)\n* [Berkshelf\u3092\u4f7f\u3063\u3066\u5916\u90e8\u30af\u30c3\u30af\u30d6\u30c3\u30af\u3092\u30ce\u30fc\u30c9\u306b\u9069\u7528\u3059\u308b\u3002](http://qiita.com/park-jh/items/751464a4cc6d8abcd6fd)\n* [\u30af\u30c3\u30af\u30d6\u30c3\u30af\u3092\u4f5c\u6210\u3057\u3066\u30ce\u30fc\u30c9\u306b\u9069\u7528\u3059\u308b\u3002- \u305d\u306e\uff11](http://qiita.com/park-jh/items/8d641809850b5930d39c)\n* [\u30af\u30c3\u30af\u30d6\u30c3\u30af\u3092\u4f5c\u6210\u3057\u3066\u30ce\u30fc\u30c9\u306b\u9069\u7528\u3059\u308b\u3002- \u305d\u306e\uff12](http://qiita.com/park-jh/items/88237342cfd202e6893f)\n* [Chef\u3067CentOS 6.7 + rbenv + ruby 2.3.0\u306e\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u3002](http://qiita.com/park-jh/items/f249a18793899f2eb4bf)\n* [Chef\u3067CentOS 6.7 + Vim 7.4 + lua\u3092\u8a2d\u7f6e\u3059\u308b\u3002](http://qiita.com/park-jh/items/371d179d5e71618a1f14)\n* [Chef\u3067Vim\u30d7\u30e9\u30b0\u30a4\u30f3\u30de\u30cd\u30fc\u30b8\u30e3\u30fcNeoBundle\u3092\u8a2d\u7f6e\u3059\u308b\u3002](http://qiita.com/park-jh/items/ec09e40f9b4aaf9fedfd)\n* Chef\u306e\u30ec\u30b7\u30d4\u3092\u30c7\u30d0\u30c3\u30b0\u3057\u3066\u307f\u3088\u3046\u3002\n* [Chef\u3067CentOS 6.7 + nginx\u3092\u8a2d\u7f6e\u3059\u308b\u3002- \u5916\u90e8\u30af\u30c3\u30af\u30d6\u30c3\u30af](http://qiita.com/park-jh/items/3013c49494e524fced31)\n* [Chef\u3067CentOS 6.7 + nginx\u3092\u8a2d\u7f6e\u3059\u308b\u3002- \u30ab\u30b9\u30bf\u30e0\u30af\u30c3\u30af\u30d6\u30c3\u30af](http://qiita.com/park-jh/items/43451cea21ee1724c24b)\n* [Chef\u3067CentOS 6.7 + nodejs + npm\u3092\u8a2d\u7f6e\u3059\u308b\u3002](http://qiita.com/park-jh/items/96089e7e1c97b0fe3a6c)\n* [Chef\u3067Vim\u30d7\u30e9\u30b0\u30a4\u30f3\u30de\u30cd\u30fc\u30b8\u30e3\u30fcvim-plug\u3092\u8a2d\u7f6e\u3059\u308b\u3002](http://qiita.com/park-jh/items/ba27ad412ce9926fd94d)\n* [ohai\u306e\u30ab\u30b9\u30bf\u30e0\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f5c\u3063\u3066\u307f\u3088\u3046\u3002](http://qiita.com/park-jh/items/34be55abb7c63b36cddb)\n* [Chef Solo\u304b\u3089Chef Zero\u3078](http://qiita.com/park-jh/items/44c249c9de768c53b423)\n* [Chef\u3067nginx + php(php-fpm) + mariadb + wordpress\u3092\u8a2d\u7f6e\u3059\u308b\u3002](http://qiita.com/park-jh/items/7515e47dddc38257a454)\n\n## \u81ea\u4f5c\u3057\u305fvim-plugin\u30ec\u30b7\u30d4\u306e\u4e0d\u5177\u5408\n\n* \u524d\u56de\u306e\u8a18\u4e8b\u3067\u5f8c\u5473\u304c\u60aa\u304b\u3063\u305f\u4e0d\u5177\u5408\u3092\u89e3\u6d88\u3057\u305f\u306e\u3067\u66f8\u3044\u3066\u307f\u308b\u3002\n* Chef\u3067\u306fchef-shell\u3068\u3044\u3046irb\u3092\u63d0\u4f9b\u3057\u3066\u3044\u308b\u3002\u3053\u308c\u3092\u4f7f\u3063\u3066\u30c7\u30d0\u30c3\u30b0\u3057\u3066\u307f\u3088\u3046\u3002\n* chef-shell\u306e\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u3050\u3050\u3063\u3066\u307f\u305f\u304c\u3001\u8a73\u7d30\u306a\u4f7f\u3044\u65b9\u304c\u51fa\u3066\u6765\u306a\u3044\u3002\n* Chef\u306e\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3068\u6b21\u306e\u30b5\u30a4\u30c8\u304c\u53c2\u8003\u306b\u306a\u3063\u305f\u3002\n  - https://docs.chef.io/chef_shell.html\n  - http://blog.jonliv.es/blog/2012/02/07/chef-development-with-shef/\n  - http://stevendanna.github.io/blog/2012/01/28/shef-debugging-tips-1/\n* \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4ee5\u5916\u306e\u53c2\u8003\u30b5\u30a4\u30c8\u306f\u5c11\u3057\u53e4\u3044\u306e\u3067\u3001shef\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u304c\u3001\u73fe\u5728\u306fchef-shell\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n## chef-shell\uff08\u65e7shef\uff09\n\n* chef-shell\u306fchef-solo\u3084chef-client\u74b0\u5883\u3067\u4f7f\u3046\u3082\u306e\u3067\u3042\u308b\u3002\n* \u30db\u30b9\u30c8\uff08\u30ec\u30b7\u30d4\u3092\u6271\u3046\u30ed\u30fc\u30ab\u30eb\u7aef\u672b\uff09\u3067\u306f\u306a\u304f\u30b2\u30b9\u30c8\uff08\u30ce\u30fc\u30c9\uff09\u3067\u5b9f\u884c\u3059\u308b\u3002\n\n### \u8d77\u52d5\n\n* \u308f\u304b\u3089\u306a\u3044\u3068\u56f0\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\u3060\u3051\u6697\u8a18\u3057\u3066\u304a\u304f\u3002\n  - -s\uff1achef-solo\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\n  - -z\uff1achef-client\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\n  - -a\uff1a\u30b9\u30bf\u30f3\u30c9\u30a2\u30ed\u30f3\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\n  - -c\uff1a\u4f7f\u7528\u3059\u308b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n  - -j\uff1achef-solo\u30e2\u30fc\u30c9\u306e\u307f\u6709\u52b9\u3067run_list\u3092\u542b\u3080Node\u306eAttribute\u3068\u3057\u3066\u4f7f\u3046JSON\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\n* help\u3092\u5165\u529b\u3059\u308b\u3068\u30b3\u30de\u30f3\u30c9\u3068\u305d\u306e\u8aac\u660e\u304c\u8868\u793a\u3055\u308c\u308b\u3002\n* \u7d42\u4e86\u3057\u305f\u3044\u5834\u5408\u306fexit\u3092\u5165\u529b\u3059\u308b\u3002\n\n```sh\n$ cd chef-solo\n$ chef-shell -s -c solo.rb -j dna.json\n\nloading configuration: solo.rb\nSession type: solo\nLoading...done.\n\nThis is the chef-shell.\n Chef Version: 12.7.2\n http://www.chef.io/\n http://docs.chef.io/\n\nrun `help' for help, `exit' or ^D to quit.\n\nOhai2u vagrant@dev!\nchef (12.7.2)>\n```\n\n### \u30ec\u30b7\u30d4\u30e2\u30fc\u30c9\n\n* \u30ec\u30b7\u30d4\u3092\u78ba\u8a8d\u3059\u308b\u3068\u304d\u4f7f\u3046\u3002\n* include_recipe\u3092\u4f7f\u3063\u3066\u554f\u984c\u304c\u3042\u308b\u30ec\u30b7\u30d4\u3092\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3059\u308b\u3002\n* run_chef\u3067\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\u3057\u305f\u30ec\u30b7\u30d4\u3092\u5b9f\u884c\u3059\u308b\u3002\n* \u3059\u3053\u3057\u9577\u3044\u304cdirectory\u90e8\u5206\u306b\u554f\u984c\u304c\u3042\u308b\u3053\u3068\u306f\u3059\u3050\u308f\u304b\u3063\u305f\u3002\n* node['user']\u304c\u8aad\u307f\u8fbc\u307e\u308c\u3066\u306a\u3044\u3002\n\n```sh\nchef (12.7.2)> recipe_mode\nchef:recipe (12.7.2)> include_recipe \"vim-plugin::default\"\nchef:recipe (12.7.2)> run_chef\n[2016-02-25T11:51:33+00:00] INFO: Processing directory[/home//.vim] action create (vim-plugin::default line 10)\n[2016-02-25T11:51:33+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:51:33+00:00] DEBUG: Provider for action create on resource directory[/home//.vim] is Chef::Provider::Directory\n\n================================================================================\nError executing action `create` on resource 'directory[/home//.vim]'\n================================================================================\n\nChef::Exceptions::InsufficientPermissions\n-----------------------------------------\nCannot create directory[/home//.vim] at /home//.vim due to insufficient permissions\n\nResource Declaration:\n---------------------\n# In /home/vagrant/chef-solo/cookbooks-3/vim-plugin/recipes/default.rb\n\n 10: directory \"/home/#{node['user']}/.vim\" do\n 11:   owner node['user']\n 12:   group node['group']\n 13:   mode '0755'\n 14:   action :create\n 15: end\n 16:\n\nCompiled Resource:\n------------------\n# Declared in /home/vagrant/chef-solo/cookbooks-3/vim-plugin/recipes/default.rb:10:in `from_file'\n\ndirectory(\"/home//.vim\") do\n  action [:create]\n  retries 0\n  retry_delay 2\n  default_guard_interpreter :default\n  path \"/home//.vim\"\n  declared_type :directory\n  cookbook_name :\"vim-plugin\"\n  recipe_name \"default\"\n  mode \"0755\"\nend\n\n[2016-02-25T11:51:33+00:00] INFO: Running queued delayed notifications before re-raising exception\nChef::Exceptions::InsufficientPermissions: directory[/home//.vim] (vim-plugin::default line 10) had an error: Chef::Exceptions::InsufficientPermissions: Cannot create directory[/home//.vim] at /home//.vim due to insufficient permissions\n\n... snip ...\n```\n\n### solo.rb\n\n* chef-solo\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3002chef-client\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306fclient.rb\u3067\u3042\u308b\u3002\n* solo.rb\u3092\u78ba\u8a8d\u3057\u305f\u3089\u3001environment\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\uff08_default\uff09\u306b\u306a\u3063\u3066\u3044\u305f\u3002\n* user\u3084group\u306a\u3069\u306eattribute\u306fenvironments\uff08development.json\uff09\u306b\u4fdd\u6301\u3057\u3066\u3044\u308b\u3002\n* node\uff08dev.json\uff09\u306echef_environment\u3082development\u306b\u8a2d\u5b9a\u3057\u305f\u304c\u305d\u308c\u304c\u9069\u7528\u3055\u308c\u3066\u306a\u3044\u3002\n\n```sh\n[vagrant@dev chef-solo]$ cat solo.rb\nnode_name \"dev\"\n\nbase = File.expand_path('..', __FILE__)\n\nnodes_path                File.join(base, 'nodes')\nrole_path                 File.join(base, 'roles')\ndata_bag_path             File.join(base, 'data_bags')\nencrypted_data_bag_secret File.join(base, 'data_bag_key')\nenvironment_path          File.join(base, 'environments')\nenvironment               \"_default\"\nssl_verify_mode           :verify_peer\n\ncookbook_path []\ncookbook_path << File.join(base, 'cookbooks-1') # /Users/devnote/Documents/study/chef/vendor/bundle/ruby/2.2.0/gems/knife-solo-0.5.1/lib/knife-solo/resources/patch_cookbooks\ncookbook_path << File.join(base, 'cookbooks-2') # /Users/devnote/Documents/study/chef/cookbooks\ncookbook_path << File.join(base, 'cookbooks-3') # /Users/devnote/Documents/study/chef/site-cookbooks\n```\n\n* solo.rb\u306e_default\u3092development\u3067\u4fee\u6b63\u3057\u305f\u3002\n\n```sh\n$ sed -i -e \"s/_default/development/g\" solo.rb\n$ cat solo.rb\nnode_name \"dev\"\n\nbase = File.expand_path('..', __FILE__)\n\nnodes_path                File.join(base, 'nodes')\nrole_path                 File.join(base, 'roles')\ndata_bag_path             File.join(base, 'data_bags')\nencrypted_data_bag_secret File.join(base, 'data_bag_key')\nenvironment_path          File.join(base, 'environments')\nenvironment               \"development\"\nssl_verify_mode           :verify_peer\n\ncookbook_path []\ncookbook_path << File.join(base, 'cookbooks-1') # /Users/devnote/Documents/study/chef/vendor/bundle/ruby/2.2.0/gems/knife-solo-0.5.1/lib/knife-solo/resources/patch_cookbooks\ncookbook_path << File.join(base, 'cookbooks-2') # /Users/devnote/Documents/study/chef/cookbooks\ncookbook_path << File.join(base, 'cookbooks-3') # /Users/devnote/Documents/study/chef/site-cookbooks\n```\n\n* \u30ec\u30b7\u30d4\u30e2\u30fc\u30c9\u3067\u3082\u3046\u4e00\u5ea6\u78ba\u8a8d\u3057\u305f\u3089\u3001\u4eca\u5ea6\u306f\u6b63\u5e38\u306b\u5b9f\u884c\u3055\u308c\u305f\u3002\n* \u30b9\u30af\u30ea\u30d7\u30c8\u306f\u554f\u984c\u304c\u306a\u3044\u3002\n\n```sh\nchef:recipe (12.7.2)> include_recipe \"vim-plugin::default\"\nchef:recipe (12.7.2)> run_chef\n[2016-02-25T11:57:55+00:00] INFO: Processing directory[/home/vagrant/.vim] action create (vim-plugin::default line 10)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action create on resource directory[/home/vagrant/.vim] is Chef::Provider::Directory\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing directory[/home/vagrant/.vim/backup] action create (vim-plugin::default line 18)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action create on resource directory[/home/vagrant/.vim/backup] is Chef::Provider::Directory\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing directory[/home/vagrant/.vim/bundle] action create (vim-plugin::default line 18)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action create on resource directory[/home/vagrant/.vim/bundle] is Chef::Provider::Directory\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing directory[/home/vagrant/.vim/swap] action create (vim-plugin::default line 18)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic directory resource enabled on node include: [Chef::Provider::Directory]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action create on resource directory[/home/vagrant/.vim/swap] is Chef::Provider::Directory\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing execute[install neobundle] action run (vim-plugin::default line 26)\n[2016-02-25T11:57:55+00:00] DEBUG: Skipping execute[install neobundle] due to not_if ruby block\n[2016-02-25T11:57:55+00:00] INFO: Processing cookbook_file[/home/vagrant/.vimrc_scss_indent] action create (vim-plugin::default line 36)\n[2016-02-25T11:57:55+00:00] DEBUG: cookbook_file[/home/vagrant/.vimrc_scss_indent] checksumming file at /home/vagrant/.vimrc_scss_indent.\n[2016-02-25T11:57:55+00:00] DEBUG: cookbook_file[/home/vagrant/.vimrc_scss_indent] staging /home/vagrant/chef-solo/cookbooks-3/vim-plugin/files/default/.vimrc_scss_indent to /home/vagrant/..vimrc_scss_indent20160225-6651-1b7m1of\n[2016-02-25T11:57:55+00:00] DEBUG: calculating checksum of /home/vagrant/..vimrc_scss_indent20160225-6651-1b7m1of to compare with 05be8b3325aa3c67568c37216114a0a530a55dc9d199d7476a82d306b969222e\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing cookbook_file[/home/vagrant/.vimrc] action create (vim-plugin::default line 36)\n[2016-02-25T11:57:55+00:00] DEBUG: cookbook_file[/home/vagrant/.vimrc] checksumming file at /home/vagrant/.vimrc.\n[2016-02-25T11:57:55+00:00] DEBUG: cookbook_file[/home/vagrant/.vimrc] staging /home/vagrant/chef-solo/cookbooks-3/vim-plugin/files/default/.vimrc to /home/vagrant/..vimrc20160225-6651-1i2xivg\n[2016-02-25T11:57:55+00:00] DEBUG: calculating checksum of /home/vagrant/..vimrc20160225-6651-1i2xivg to compare with bd258180199e8ac6b76be5c6de6067e4396d5563490666a932ebe1bfc02e0133\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_mode == current_mode, not updating mode\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_uid == current_uid, not updating owner\n[2016-02-25T11:57:55+00:00] DEBUG: Found target_gid == current_gid, not updating group\n[2016-02-25T11:57:55+00:00] INFO: Processing execute[install vim plugin via neobundle] action run (vim-plugin::default line 43)\n[2016-02-25T11:57:55+00:00] DEBUG: Providers for generic execute resource enabled on node include: [Chef::Provider::Execute]\n[2016-02-25T11:57:55+00:00] DEBUG: Provider for action run on resource execute[install vim plugin via neobundle] is Chef::Provider::Execute\nnot found in 'runtimepath': \"ftdetect/*.vim\"\nnot found in 'runtimepath': \"colors/mopkai.vim\"\nError detected while processing /home/vagrant/.vimrc:\nline  707:\nE185: Cannot find color scheme 'mopkai'\n[neobundle] command AlpacaTagsSet is not found.\n[neobundle] Update started: (2016/02/25 11:57:55)\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\n[neobundle] ( 1/65) [                    ] vimproc.vim\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\n\n... snip ...\n\nneobundle] (65/65) [====================] vim-haml\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\nnot found in 'runtimepath': \"autoload/vimproc.vim\"\n[neobundle] (65/65): |vim-haml| Updated\n[neobundle]\n[neobundle] Installed bundles:\n[neobundle]   vimproc.vim\n\n... snip ...\n\n[neobundle]   vim-haml\n[neobundle] Update done: (2016/02/25 12:01:06)\n[2016-02-25T12:01:06+00:00] INFO: execute[install vim plugin via neobundle] ran successfully\n => true\nchef:recipe (12.7.2)>\n```\n\n* knife-solo\u3092\u5b9f\u884c\u3059\u308b\u3068\u304d\u3001-E\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u304d\u3067Environments\u3092\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n* knife-solo\u3092\u4f7f\u3046\u305f\u3073\u306b-E\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u4ed8\u3051\u306a\u3044\u3068_default\u3067\u6307\u5b9a\u3055\u308c\u3066\u3057\u307e\u3046\u3002\n* \u6700\u521d\u304b\u3089\u3084\u308a\u76f4\u3057\n  - vagrant destroy\n  - vagrant up\n  - bin/knife solo bootstrap dev -E development\n* \u3057\u304b\u3057\u3001\u4eca\u5ea6\u3082neoinstall\u51e6\u7406\u304c\u65e9\u304b\u3063\u305f\u3002\u30ce\u30fc\u30c9\u3092\u8abf\u3079\u305f\u304c\u3084\u306f\u308a\u8a2d\u7f6e\u3055\u308c\u3066\u306a\u3044\u3002\n\n## script\u51e6\u7406\n\n### \u554f\u984c\u70b9\n\n* \u30ea\u30bd\u30fc\u30b9\u5185\u3067\u5b9a\u7fa9\u3057\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u306froot\u6a29\u9650\u3067\u5b9f\u884c\u3055\u308c\u308b\u3002\n* user\u3001group\u3001environment\u3092\u6307\u5b9a\u3059\u308b\u3068\u305d\u306e\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\u3055\u308c\u308b\u3068\u601d\u3063\u3066\u3044\u305f\u304c\u3001\u305d\u3046\u3067\u306f\u306a\u3044\u307f\u305f\u3044\u3060\u3002\n* \u305d\u3057\u3066\u3001vim\u3092tarball\u3067\u8a2d\u7f6e\u3057\u3066\u3082yum\u3067\u8a2d\u7f6e\u3057\u306a\u3044\u3068\u5b9f\u884c\u3059\u308b\u3068\u304d\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u3002\n\n```sh\nvim: command not found\n```\n\n### \u89e3\u6c7a\u7b56\n\n* \u6700\u7d42\u7684\u306b\u306f\u6b21\u306e\u3088\u3046\u306b\u5909\u66f4\u3057\u305f\u3002\n  - yum\u3067\u3082vim\u3092\u8a2d\u7f6e\u3059\u308b\u3002\u3057\u304b\u3057\u3001vim\u3092\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f\u4ee5\u524dtarball\u3067\u8a2d\u7f6e\u3055\u308c\u305fvim\u304c\u512a\u5148\u3055\u308c\u308b\u3002\uff08/usr/local/bin\u304c\u512a\u5148\u3055\u308c\u308b\u305f\u3081\uff09\n  - \u30e6\u30fc\u30b6\u3092\u6307\u5b9a\u3057\u3066\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3002\n  - \u5b9f\u884c\u304c\u7d42\u308f\u3063\u305f\u3089.vim-neoinstalled\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u751f\u6210\u3059\u308b\u3002\n  - .vim-neoinstalled\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306b\u9650\u3063\u3066\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n```ruby\npackage 'vim' do\n  action :installl\nend\n\n... snip ...\n\nexecute 'install vim plugin via neobundle' do\n  user node['user']\n  group node['group']\n  cwd \"/home/#{node['user']}\"\n  environment 'HOME' => \"/home/#{node['user']}\"\n  command \"sudo -u #{node['user']} /home/#{node['user']}/.vim/bundle/neobundle.vim/bin/neoinstall 1>.vim-neoinstalled 2>.vim-neoinstalled\" \n  not_if { File.exists?(\"/home/#{node['user']}/.vim-neoinstalled\") }\nend\n```\n\n* [\u6700\u7d42\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u78ba\u8a8d\u3059\u308b](https://github.com/devtopia/chef/tree/vim-plugin)\n\n## breakpoint\uff08\u8ffd\u8a18\uff09\n\n* \u4eca\u5ea6\u306fscript\u306b\u306f\u554f\u984c\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u4f7f\u3063\u3066\u3044\u306a\u3044\u304c\u4f7f\u3044\u65b9\u3060\u3051\u7c21\u5358\u306b\u66f8\u3044\u3066\u304a\u304f\u3002\n* recipe\u5185\u306bbreakpoint\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n* chef-shell\u306b\u3066run_chef\u3092\u5b9f\u884c\u3059\u308b\u3068breakpoint\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3068\u3053\u308d\u3067\u6b62\u307e\u308b\u3002\n* \u9032\u307f\u305f\u3044\u3068\u304d\u306fchef_run.resume\u3092\u5165\u529b\u3059\u308b\u3002\n\n```ruby\nbreakpoint \"before bash 'install vim plugin via neobundle'\" do\n  action :break\nend\n```\n\n## \u611f\u60f3\n\n* Chef\u306f\u96e3\u3057\u3044\u3002\n* \u65e5\u672c\u8a9e\u306e\u672c\u304c\u5c11\u306a\u3044\u3002\u5165\u9580\u66f8\u306b\u306f\u304b\u306a\u308a\u3044\u3044\u826f\u66f8\u304c2\u518a\u3042\u308b\u304c\u3001\u3082\u3063\u3068\u77e5\u308a\u305f\u3044\u5834\u5408\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u4f9d\u5b58\u3059\u308b\u3057\u304b\u306a\u3044\u3002\u307e\u3042\u5f53\u305f\u308a\u524d\u3060\u306a\u3002\n\n## \u53c2\u8003\n\n* https://github.com/Shougo/neobundle.vim\n* https://docs.chef.io/chef_shell.html \n* Chef\u6d3b\u7528\u30ac\u30a4\u30c9\n* Chef\u5b9f\u8df5\u5165\u9580\n", "tags": ["chef-shell", "neobundle", "Vim", "shef", "chef"]}