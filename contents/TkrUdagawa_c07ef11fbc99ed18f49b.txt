{"context": "\u3053\u306e\u8a18\u4e8b\u306f Jubatus Advent Calendar \u306e2\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\nJubatus advent calendar 2\u65e5\u76ee\u304b\u3089\u306fJubatus\u306b\u642d\u8f09\u3055\u308c\u3066\u3044\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u7d39\u4ecb\u3082\u517c\u306d\u3066\u3001jubatus-example\u3092\u9806\u756a\u306b\u5168\u3066\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\njubatus-example\u3068\u306f\ngithub\u306e\u3053\u3061\u3089\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u3001Jubatus\u3092\u4f7f\u3063\u305f\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b0\u30e9\u30e0\u96c6\u3067\u3059\u3002\nREADME\u306b\u66f8\u3044\u3066\u3042\u308b\u901a\u308a\u3001\u73fe\u57288\u7a2e\u306e\u6a5f\u68b0\u5b66\u7fd2\u30a8\u30f3\u30b8\u30f3\u306b\u3064\u3044\u3066\u300117\u7a2e\u306eexample\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u30a8\u30f3\u30b8\u30f3\u3092\u52d5\u304b\u3059\u3060\u3051\u306e\u5358\u7d14\u306a\u3082\u306e\u304b\u3089\u3001\u5c11\u3005\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5206\u6790\u3092\u884c\u3046\u3082\u306e\u307e\u3067\u69d8\u3005\u3067\u3059\u3002\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a00\u8a9e\u3082C++/Python/Ruby/Java\u306e4\u7a2e\u306e\u8a00\u8a9e\u3067\u5b9f\u88c5\u3055\u308c\u305f\u3082\u306e\u304c\u3042\u308a\u307e\u3059\u3002\n# \u6b6f\u629c\u3051\u306b\u306a\u3063\u3066\u3044\u308b\u3082\u306e\u3082\u591a\u3044\u306e\u3067\u3001\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u304a\u5f85\u3061\u3057\u3066\u307e\u3059\uff01\n\u4eca\u56de\u306f\u552f\u4e00\u5168\u3066\u306eexample\u304c\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308bPython\u306eexample\u3092\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u5f8c\u7de8\u3067\u6271\u3046malware classification\u306fc++\u3060\u3051\u3001winequality\u306fruby\u3060\u3051\u3067\u3057\u305f\u3002\u3054\u3081\u3093\u306a\u3055\u3044\u3002\n\n\u524d\u7de8\u3067\u5b9f\u884c\u3059\u308bexample\n\u524d\u7de8\u306e\u4eca\u65e5\u306f\u5358\u7d14\u306aexample\u3092\u4e2d\u5fc3\u306b\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002(\u62ec\u5f27\u5185\u306f\u4f7f\u7528\u3059\u308b\u6a5f\u68b0\u5b66\u7fd2\u30a8\u30f3\u30b8\u30f3)\n- shogun (classifier)\n- gender (classifier)\n- movielens (recommender)\n- npb_similar_player (recommender)\n\n\u74b0\u5883\n\u4eca\u56de\u306eexample\u306e\u5b9f\u884c\u306f\u5168\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u74b0\u5883\u3067\u884c\u3044\u307e\u3059\u3002\n\n\n\n\u9805\u76ee\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306a\u3069\n\n\n\n\nOS\nubuntu 14.04\n\n\nJubatus version\n1.0.0 (apt\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\n\n\nPython\n3.5.2\n\n\n\n\n\u6e96\u5099\n\njubatus\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a\n\u4eca\u56de\u306fjubatus\u3092apt\u3067\u5165\u308c\u308b\u306e\u3067\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u767b\u9332, apt-get, \u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n$ echo \"deb http://download.jubat.us/apt/ubuntu/trusty binary/\" | tee /etc/apt/sources.list.d/jubatus.list\n$ apt-get update\n$ apt-get install jubatus\n$ source /opt/jubatus/profile\n\n\njubatus python \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npip \u3067jubatus\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\npip install jubatus\n\n\njubatus-example\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\njubatus-example\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092clone\u3057\u3066\u304d\u307e\u3059\u3002\ngit clone http://github.com/jubatus/jubatus-example.git\n\n\u4ee5\u4e0a\u3067\u6e96\u5099\u306f\u7d42\u308f\u308a\u3067\u3059\u3002\n\nshogun\n\u6700\u521d\u306b\u52d5\u304b\u3059\u306e\u306fclassifier\u306eexample \"shogun\" \u3067\u3059\u3002\n\u3053\u306eexample\u3067\u306f\u6b74\u4ee3\u5c06\u8ecd\u306e\u540d\u524d\u3092jubatus\u306b\u5b66\u7fd2\u3055\u305b\u3001\u65b0\u305f\u306b\u5165\u529b\u3055\u308c\u305f\u540d\u524d\u304c\u3069\u306e\u5c06\u8ecd\u5bb6\u3063\u307d\u3044\u304b\u3092\u5206\u985e\u3057\u307e\u3059\u3002\n\n\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\n\njubatus \u30b5\u30fc\u30d0\u306e\u8d77\u52d5\n\u306f\u3058\u3081\u306bjubatus\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3055\u305b\u307e\u3059\u3002\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\u306b\u306f\u4f7f\u7528\u3059\u308b\u30a8\u30f3\u30b8\u30f3\u306b\u5408\u308f\u305b\u305fjuba{hoge} \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u5206\u985e\u5668\u306e\u5834\u5408\u306fjubaclassifier\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\u3053\u306e\u6642\u3001\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u6307\u5b9a\u304c\u5fc5\u9808\u3068\u306a\u308a\u307e\u3059\u3002\u4eca\u56de\u306fjubatus-example/shogun \u306e\u4e0b\u306b\u3042\u308bshogun.json\u3092\u4f7f\u3044\u307e\u3059\u3002\n$ jubaclassifier -f shogun.json\n2016-11-30 19:50:32,691 21212 INFO  [server_util.cpp:429] starting jubaclassifier 1.0.0 RPC server at 10.0.2.15:9199                                                                                                                   \n    pid                  : 21212\n    user                 : TkrUdagawa\n    mode                 : standalone mode\n    timeout              : 10\n    thread               : 2\n    datadir              : /tmp\n    logdir               : \n    log config           : \n    zookeeper            : \n    name                 : \n    interval sec         : 16\n    interval count       : 512\n    zookeeper timeout    : 10\n    interconnect timeout : 10\n\n2016-11-30 19:50:32,691 21212 INFO  [server_util.cpp:165] load config from local file: /home/TkrUdagawa/jubatus-example/shogun/shogun.json\n2016-11-30 19:50:32,692 21212 INFO  [classifier_serv.cpp:115] config loaded: {\n  \"method\": \"AROW\",\n  \"converter\": {\n    \"num_filter_types\": {},\n    \"num_filter_rules\": [],\n    \"string_filter_types\": {},\n    \"string_filter_rules\": [],\n    \"num_types\": {},\n    \"num_rules\": [],\n    \"string_types\": {\n      \"unigram\": { \"method\": \"ngram\", \"char_num\": \"1\" }\n    },\n    \"string_rules\": [\n      { \"key\": \"*\", \"type\": \"unigram\", \"sample_weight\": \"bin\", \"global_weight\": \"bin\" }\n    ]\n  },\n  \"parameter\": {\n    \"regularization_weight\" : 1.0\n  }\n}\n\n2016-11-30 19:50:32,692 21212 INFO  [server_helper.hpp:226] start listening at port 9199\n2016-11-30 19:50:32,692 21212 INFO  [server_helper.hpp:233] jubaclassifier RPC server startup\n\n\n\u6b63\u3057\u304fjubatus\u30b5\u30fc\u30d0\u304c\u8d77\u52d5\u3057\u3066\u3044\u308c\u3070\u4e0a\u8a18\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u3001jubatus\u30b5\u30fc\u30d0\u304c9199\u30dd\u30fc\u30c8\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u4ed8\u3051\u59cb\u3081\u307e\u3059\u3002\nconfig\u306e\u610f\u5473\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u30c7\u30fc\u30bf\u5909\u63db\u3084\u30af\u30e9\u30a4\u30a2\u30f3\u30c8API\u306a\u3069\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\u3056\u3063\u304f\u308a\u3068\u3057\u305f\u89e3\u8aac\u3092\u3059\u308b\u3068\u3001classifier\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306bAROW\u3092\u6307\u5b9a\u3001\u6587\u5b57\u5217\u306e\u7279\u5fb4\u304c\u4e0e\u3048\u3089\u308c\u305f\u30891\u6587\u5b571\u6587\u5b57\u5358\u4f4d\u3067\u5b66\u7fd2\u3059\u308b\u3001\u3068\u3044\u3046\u8a2d\u5b9a\u3092\u4e0e\u3048\u3066\u3044\u307e\u3059\u3002\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u884c\njubatus-example/shogun/python \u306e\u4e0b\u306b\u3042\u308bshogun.py\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ python shogun.py\n\u5fb3\u5ddd \u6176\u559c\n\u8db3\u5229 \u7fa9\u662d\n\u5317\u6761 \u5b88\u6642\n\n\u7121\u4e8b\u306b\u540d\u5b57\u3068\u540d\u524d\u306e\u5bfe\u5fdc\u304c\u3068\u308c\u305f\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u3061\u3087\u3063\u3068\u3057\u305f\u89e3\u8aac\n\u3053\u306eexample\u3067\u306f\n1. \u5c06\u8ecd\u306e\u540d\u5b57\u3092\u30e9\u30d9\u30eb\u3001\u540d\u524d\u3092\u30c7\u30fc\u30bf\u3068\u3057\u3066jubatus\u306b\u5b66\u7fd2\n2. \u540d\u524d\u3060\u3051\u3092jubatus\u306b\u4e0e\u3048\u3066\u5206\u985e\n\u3068\u3044\u3046\u3053\u3068\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n1.\u306e\u51e6\u7406\u304cshogun.py\u306etrain\u30e1\u30bd\u30c3\u30c9\u30012.\u306e\u51e6\u7406\u304cshogun.py\u306epredict\u30e1\u30bd\u30c3\u30c9\u3067\u884c\u308f\u308c\u307e\u3059\u3002\n1. \u5b66\u7fd2\ndef train(client):\n    # prepare training data\n    # predict the last ones (that are commented out)\n    train_data = [  # \u5b66\u7fd2\u306b\u7528\u3044\u308b\u30c7\u30fc\u30bf\u3092(\u30e9\u30d9\u30eb\u3001Datum)\u306e\u30bf\u30d7\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u4f5c\u308b\n        ('\u5fb3\u5ddd', Datum({'name': '\u5bb6\u5eb7'})),\n        ('\u5fb3\u5ddd', Datum({'name': '\u79c0\u5fe0'})),\n        ....(\u4e2d\u7565)       \n        ('\u5317\u6761', Datum({'name': '\u9ad8\u6642'})),\n        ('\u5317\u6761', Datum({'name': '\u8c9e\u9855'})),\n        # (u'\u5317\u6761', Datum({'name': u'\u5b88\u6642'})),  \n    ]\n    random.shuffle(train_data)\n    client.train(train_data)  # jubatus\u306b\u5b66\u7fd2\u3055\u305b\u308b\n\n\u3053\u3053\u3067\u51fa\u3066\u304f\u308bDatum(\u3067\u30fc\u305f\u3080)\u3068\u3044\u3046\u30c7\u30fc\u30bf\u578b\u304cJubatus\u3067\u4f7f\u308f\u308c\u308b\u7279\u6709\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u306b\u306a\u308a\u307e\u3059\u3002\nDatum\u306fkey-value\u578b\u306e\u69cb\u9020\u3092\u3082\u3063\u3066\u304a\u308a\u3001\u6570\u5024\u7279\u5fb4\u3001\u6587\u5b57\u5217\u7279\u5fb4\u3001\u30d0\u30a4\u30ca\u30ea\u7279\u5fb4\u306e3\u7a2e\u985e\u306e\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u4f8b\u3067\u306f {'name':'\u5bb6\u5eb7'} \u306e\u3088\u3046\u306b\u6587\u5b57\u5217\u7279\u5fb4\u30921\u3064\u3057\u304b\u6e21\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001{'name':'\u5bb6\u5eb7', 'stroke': 21}\u306a\u3069\u306e\u3088\u3046\u306b\u6570\u5024\u304cvalue\u3068\u306a\u308b\u3082\u306e\u3092\u6e21\u3059\u3068\u6570\u5024\u7279\u5fb4\u91cf\u3092\u542b\u3080Datum\u3092\u3064\u304f\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u4f5c\u6210\u3057\u305fDatum\u3068\u30e9\u30d9\u30eb\u306e\u30bf\u30d7\u30eb\u306e\u30ea\u30b9\u30c8\u3092train\u30e1\u30bd\u30c3\u30c9\u306b\u6e21\u3059\u3053\u3068\u3067\u5b66\u7fd2\u304c\u3067\u304d\u307e\u3059\u3002\n2. \u5206\u985e\ndef predict(client):\n    # predict the last shogun\n    data = [ # \u5206\u6790\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u3092Datum\u306e\u30ea\u30b9\u30c8\u3067\u4f5c\u308b\n        Datum({'name': '\u6176\u559c'}),\n        Datum({'name': '\u7fa9\u662d'}),\n        Datum({'name': '\u5b88\u6642'}),\n    ]\n    for d in data:\n        res = client.classify([d]) # jubatus\u3067\u5206\u6790\n        # get the predicted shogun name\n        shogun_name = max(res[0], key = lambda x: x.score).label # \u5206\u6790\u7d50\u679c\u306e\u3046\u3061\u6700\u3082\u30b9\u30b3\u30a2\u306e\u9ad8\u3044\u30e9\u30d9\u30eb\u3092\u53d6\u5f97\n        first_name = d.string_values[0][1]\n        _output('{0} {1}\\n'.format(shogun_name, first_name))\n\n\u5206\u985e\u3059\u308b\u3068\u304d\u306fDatum\u306e\u30ea\u30b9\u30c8\u3092\u4f5c\u308a\u3001classify\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\u8fd4\u308a\u5024\u306fclassifier\u304c\u899a\u3048\u3066\u3044\u308b\u5168\u3066\u306e\u30e9\u30d9\u30eb\u306b\u3064\u3044\u3066\u306e\u30b9\u30b3\u30a2\u306b\u306a\u308a\u307e\u3059\u3002\n\u3057\u305f\u304c\u3063\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u3001\u6700\u3082\u9ad8\u3044\u30b9\u30b3\u30a2\u306e\u30e9\u30d9\u30eb\u3092\u629c\u304d\u51fa\u3059\u51e6\u7406\u3092\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\ngender\n\u6b21\u306b\u5b9f\u884c\u3059\u308b\u306e\u306f\u540c\u3058\u304fclassifier\u306eexample \"gender\" \u3067\u3059\u3002\n\u3053\u306eexample\u3067\u306fmale, female\u3068\u3044\u3046\u30e9\u30d9\u30eb\u3068\u3001\u9aea\u306e\u9577\u3055hair\u3001 \u4e0a\u534a\u8eab\u306e\u670d\u88c5top\u3001\u4e0b\u534a\u8eab\u306e\u670d\u88c5bottom\u3001\u8eab\u9577height\u3068\u3044\u3063\u305f\u7279\u5fb4\u3092\u5b66\u7fd2\u3055\u305b\u3001\u7537\u6027\u3092\u5973\u6027\u306e\u7279\u5fb4\u3092jubatus\u306b\u5206\u985e\u3055\u305b\u307e\u3059\u3002\n\n\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\n\njubatus\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\nshogun\u3068\u540c\u69d8\u3001\u307e\u305a\u306fjubatus\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\u4eca\u56de\u3082\u5206\u985e\u5668\u306a\u306e\u3067jubaclassifier\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ jubaclassifier -f gender.json &\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u884c\n\u7d9a\u3044\u3066jubatus-example/gender/python \u306b\u3042\u308b\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0gender.py\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ python gender.py\nfemale: 0.061350\nmale: 0.367799\n------\nfemale: 0.600048\nmale: -0.372206\n------\n\n\u3061\u3083\u3093\u3068\u52d5\u4f5c\u3059\u308c\u3070\u7537\u6027(male)\u3001\u5973\u6027(female)\u305d\u308c\u305e\u308c\u306e\u30e9\u30d9\u30eb\u306e\u30b9\u30b3\u30a2\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n\u3061\u3087\u3063\u3068\u3057\u305f\u89e3\u8aac\n\u3053\u306eexample\u3067\u306fjubatus\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u3092\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002\ntrain_data = [\n    ('male',   Datum({'hair': 'short', 'top': 'sweater', 'bottom': 'jeans', 'height': 1.70})),\n    ('female', Datum({'hair': 'long',  'top': 'shirt',   'bottom': 'skirt', 'height': 1.56})),\n    ('male',   Datum({'hair': 'short', 'top': 'jacket',  'bottom': 'chino', 'height': 1.65})),\n    ('female', Datum({'hair': 'short', 'top': 'T shirt', 'bottom': 'jeans', 'height': 1.72})),\n    ('male',   Datum({'hair': 'long',  'top': 'T shirt', 'bottom': 'jeans', 'height': 1.82})),\n    ('female', Datum({'hair': 'long',  'top': 'jacket',  'bottom': 'skirt', 'height': 1.43})),\n#    ('male',   Datum({'hair': 'short', 'top': 'jacket',  'bottom': 'jeans', 'height': 1.76})),\n#    ('female', Datum({'hair': 'long',  'top': 'sweater', 'bottom': 'skirt', 'height': 1.52})),\n    ]\n\nmale\u3001female\u306e\u30b5\u30f3\u30d7\u30eb\u305d\u308c\u305e\u308c3\u3064\u305a\u3064\u7528\u610f\u3057\u3001\u3069\u306e\u7279\u5fb4\u304c\u3069\u306e\u7a0b\u5ea6\u5206\u985e\u306b\u5bc4\u4e0e\u3059\u308b\u304b\u3092Jubatus\u306b\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002\nhair long\u306ffemale\u306b\u73fe\u308c\u3084\u3059\u3044\u3001\u3068\u304bbottom skirt\u306fmale\u306b\u306f\u73fe\u308c\u3066\u3044\u306a\u3044\u3001\u306a\u3069\u30c7\u30fc\u30bf\u304b\u3089\u5206\u985e\u306e\u898f\u5247\u3092\u5b66\u3093\u3067\u3044\u304d\u307e\u3059\u3002\n\u5206\u6790\u3055\u305b\u3066\u3044\u308b\u30c7\u30fc\u30bf\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\u3002\ntest_data = [\n    Datum({'hair': 'short', 'top': 'T shirt', 'bottom': 'jeans', 'height': 1.81}),\n    Datum({'hair': 'long',  'top': 'shirt',   'bottom': 'skirt', 'height': 1.50}),\n]\n\n\u3053\u306e\u5206\u6790\u30c7\u30fc\u30bf\u304c\u305d\u308c\u305e\u308cmale\u3068\u5206\u985e\u3067\u304d\u308b\u304bfemale\u3068\u5206\u985e\u3067\u304d\u308b\u304bjubatus\u304c\u30b9\u30b3\u30a2\u3092\u3064\u3051\u3066\u8fd4\u3057\u3066\u304d\u3066\u3044\u307e\u3059\u3002\n\u30b9\u30b3\u30a2\u304c\u9ad8\u3044\u307b\u3069\u305d\u306e\u30e9\u30d9\u30eb\u3068\u8a00\u3048\u307e\u3059\u3002\u5148\u307b\u3069\u5b9f\u884c\u3057\u305f\u4f8b\u3067\u306f1\u756a\u76ee\u306e\u30c7\u30fc\u30bf\u306fmale\u3063\u307d\u3044\u30012\u756a\u76ee\u306e\u30c7\u30fc\u30bf\u306ffemale\u3063\u307d\u3044\u3068\u3044\u3046\u7d50\u679c\u304c\u5f97\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092\u5b66\u7fd2\u3055\u305b\u3066\u307f\u305f\u308a\u3001\u5206\u6790\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u3092\u5897\u3084\u3057\u3066\u307f\u305f\u308a\u3057\u3066\u3044\u308d\u3044\u308d\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\nmovielens\n\u6b21\u306b\u52d5\u304b\u3059example\u306fmovielens\u3067\u3059\u3002\n\u4eca\u5ea6\u306fjubatus\u306erecommender\u3092\u4f7f\u3063\u305fexample\u306b\u306a\u308a\u307e\u3059\u3002\nrecommender\u306f\u5b66\u7fd2\u3057\u305f\u30c7\u30fc\u30bf\u304b\u3089\u985e\u4f3c\u3057\u305f\u30c7\u30fc\u30bf\u3092\u898b\u3064\u3051\u3066\u304f\u308b\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001\u985e\u4f3c\u3057\u305f\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u3001\u30c7\u30fc\u30bf\u4e2d\u306e\u6b20\u640d\u3057\u305f\u5024\u306e\u88dc\u5b8c\u3059\u308b\u6a5f\u80fd\u3082\u3042\u3063\u305f\u308a\u3057\u307e\u3059\u3002\n\u3053\u306eexample\u3067\u306f\u6620\u753b\u306e\u8a55\u4fa1\u30c7\u30fc\u30bf\u3092\u96c6\u3081\u305f\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8movielens\u3092\u4f7f\u3063\u3066\u3001\u6620\u753b\u306e\u597d\u307f\u304c\u4f3c\u3066\u3044\u308b\u30e6\u30fc\u30b6\u3092\u898b\u3064\u3051\u307e\u3059\u3002\n\n\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\n\n\u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\u306f\u3058\u3081\u306b\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nREADME\u306b\u6cbf\u3063\u3066dat \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e2d\u306b\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nmkdir dat\ncd dat\nwget http://www.grouplens.org/system/files/ml-100k.zip\nunzip ml-100k.zip\ncd ..\n\n\njubatus\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\n\u3064\u3065\u3044\u3066jubatus\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002shogun, gender\u3068\u306f\u7570\u306a\u308a\u3001\u4eca\u5ea6\u306fjubarecommender\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ jubarecommender -f config.json\n2016-12-01 13:53:17,302 5336 INFO  [server_util.cpp:429] starting jubarecommender 1.0.0 RPC server at 10.0.2.15:9199\n    pid                  : 5336\n    user                 : TkrUdagawa\n    mode                 : standalone mode\n    timeout              : 10\n    thread               : 2\n    datadir              : /tmp\n    logdir               : \n    log config           : \n    zookeeper            : \n    name                 : \n    interval sec         : 16\n    interval count       : 512\n    zookeeper timeout    : 10\n    interconnect timeout : 10\n\n2016-12-01 13:53:17,304 5336 INFO  [server_util.cpp:165] load config from local file: /home/TkrUdagawa/jubatus-example/movielens/config.json\n2016-12-01 13:53:17,304 5336 INFO  [recommender_serv.cpp:118] config loaded: {\n  \"converter\" : {\n    \"string_filter_types\": {},\n    \"string_filter_rules\":[],\n    \"num_filter_types\": {},\n    \"num_filter_rules\": [],\n    \"string_types\": {},\n    \"string_rules\":[\n      {\"key\" : \"*\", \"type\" : \"str\", \"sample_weight\":\"bin\", \"global_weight\" : \"bin\"}\n    ],\n    \"num_types\": {},\n    \"num_rules\": [\n      {\"key\" : \"*\", \"type\" : \"num\"}\n    ]\n  },\n  \"parameter\" : {\n    \"hash_num\" : 128\n    },\n  \"method\": \"lsh\"\n}\n\n2016-12-01 13:53:17,305 5336 INFO  [server_helper.hpp:226] start listening at port 9199\n2016-12-01 13:53:17,306 5336 INFO  [server_helper.hpp:233] jubarecommender RPC server startup\n\n\n\nconfig\u306emethod\u304c\u4eca\u5ea6\u306flsh\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306fjubarecommender\u3067\u5229\u7528\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067Locality Sensitive Hash \u3068\u3044\u3046\u65b9\u6cd5\u3092\u4f7f\u3046\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u8a73\u7d30\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8API\u3084\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0 \u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5b9f\u884c\njubatus-example/movielens/python \u306b\u3042\u308b\u5b66\u7fd2\u7528\u30b9\u30af\u30ea\u30d7\u30c8ml_update.py\u3068\u5206\u6790\u7528\u30b9\u30af\u30ea\u30d7\u30c8ml_analysis.py\u3092\u9806\u306b\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n$ python ml_update.py\n0\n1000\n2000\n(\u4e2d\u7565)\n99000\n\n$ python ml_analysis.py\nuser  0  is similar to : []\nuser  1  is similar to : ['id_with_score{id: 1, score: 1.0}', 'id_with_score{id: 59, score: 0.765625}', 'id_with_score{id: 561, score: 0.765625}', 'id_with_score{id: 757, score: 0.75}', 'id_with_score{id: 64, score: 0.75}', ...\nuser  2  is similar to : ['id_with_score{id: 2, score: 1.0}', 'id_with_score{id: 701, score: 0.7421875}', 'id_with_score{id: 768, score: 0.71875}', 'id_with_score{id: 624, score: 0.71875}', 'id_with_score{id: 937, score: 0.7109375}, ...\n...\nuser  942  is similar to : ['id_with_score{id: 942, score: 1.0}', 'id_with_score{id: 91, score: 0.703125}', 'id_with_score{id: 724, score: 0.703125}', 'id_with_score{id: 668, score: 0.6953125}',\n\n\u30e6\u30fc\u30b61\u304b\u3089\u30e6\u30fc\u30b6942\u307e\u3067\u305d\u308c\u305e\u308c\u985e\u4f3c\u5ea6\u304c\u9ad8\u3044\u30e6\u30fc\u30b6\u306eID\u3068\u30b9\u30b3\u30a2\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u4f8b\u3048\u3070\u30e6\u30fc\u30b61\u306f\u30e6\u30fc\u30b659\u3068\u6700\u3082\u985e\u4f3c\u3057\u3066\u3044\u3066\u3001\u985e\u4f3c\u30b9\u30b3\u30a2\u306f0.765625\u3067\u3059\u3002jubarecommender\u306e\u4ed5\u69d8\u4e0a\u3001\u8fd4\u5374\u5024\u306b\u81ea\u5206\u81ea\u8eab\u304c\u542b\u307e\u308c\u308b\u305f\u3081\u3001\u6700\u3082\u985e\u4f3c\u5ea6\u304c\u9ad8\u3044\u76f8\u624b\u3068\u3057\u3066\u81ea\u5206\u81ea\u8eab\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u307e\u305f\u3001\u6700\u521d\u306e\u884c\u3067\u30e6\u30fc\u30b60\u306e\u7d50\u679c\u304c\u7a7a\u306a\u306e\u306f\u3001\u5b58\u5728\u3057\u306a\u3044\u30e6\u30fc\u30b6ID\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u767a\u884c\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u305f\u3081\u3067\u3059\uff08\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d0\u30b0\u3067\u3059\uff09\u3002\n\n\u3061\u3087\u3063\u3068\u3057\u305f\u89e3\u8aac\n\u89e3\u51cd\u3057\u305fdat/ml-100k/\u306e\u4e2d\u3092\u898b\u3066\u3082\u3089\u3048\u3070\u308f\u304b\u308a\u307e\u3059\u304c\u3001\u3053\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u4e2d\u306b\u306f\u4f55\u7a2e\u985e\u304b\u306e\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\u4eca\u56de\u306eexample\u3067\u306fu.data\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306fuser_id, item_id, rating, timestamp\u306e\u7d44\u3001\u3064\u307e\u308a\u3001\u8ab0\u304c\u3069\u306e\u6620\u753b\u306b\u3069\u3093\u306a\u8a55\u4fa1\u3092\u3044\u3064\u3064\u3051\u305f\u306e\u304b\u3001\u306e\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3057\u305ftsv\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\u5b66\u7fd2\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4e2d\u3067\u306f\u3053\u306e\u30c7\u30fc\u30bf\u3092\u9806\u756a\u306b\u8aad\u307f\u8fbc\u307f\u8ab0\u304c\u3069\u306e\u6620\u753b\u306b\u3069\u3093\u306a\u8a55\u4fa1\u3092\u3064\u3051\u305f\u306e\u304b\u3092\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\nml_update.py\nfor line in open('../dat/ml-100k/u.data'):\n    userid, movieid, rating, mtime = line[:-1].split('\\t')\n    datum = Datum({str(movieid): float(rating)})\n    recommender.update_row(userid, datum)\n\n\nDatum\u3092\u4f5c\u6210\u3059\u308b\u3068\u304d\u306b\u306f\u6620\u753b\u306e\u30bf\u30a4\u30c8\u30eb\u3092key, \u6620\u753b\u306b\u5bfe\u3059\u308b\u8a55\u4fa1(1 ~ 5)\u3092value\u3068\u3057\u3066\u4e0e\u3048\u3066\u3044\u307e\u3059\u3002\u6b21\u306b\u3001recommender.update_row(userid, datum)\u3068\u3044\u3046\u30e1\u30bd\u30c3\u30c9\u3067jubatus\u306b\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002update_row\u306f\u7b2c\u4e00\u5f15\u6570\u306b\u5b66\u7fd2\u3055\u305b\u308b\u884c\u306eID, \u7b2c\u4e8c\u5f15\u6570\u306b\u5b66\u7fd2\u3055\u305b\u308bDatum\u3092\u4e0e\u3048\u307e\u3059\u3002ID\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306b\u306f\u65b0\u305f\u306b\u305d\u306eID\u304c\u8ffd\u52a0\u3055\u308c\u3001datum\u306e\u4e2d\u8eab\u304c\u5b66\u7fd2\u3055\u308c\u307e\u3059\u3002\u65e2\u306bID\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3001datum\u306e\u4e2d\u8eab\u304c\u8ffd\u8a18\u3055\u308c\u3066\u3044\u304d\u307e\u3059\u3002\n\u5206\u6790\u3092\u884c\u3046\u969b\u306b\u306frecommender.similar_row_from_id\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u3066\u3044\u307e\u3059\u3002\n\nml_analysis.py\nfor i in range(0,943):\n    sr = recommender.similar_row_from_id(str(i) , 10);\n    print(\"user \", str(i),  \" is similar to :\", list(map(str, sr)))\n\n\n\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u7b2c\u4e00\u5f15\u6570\u306b\u5b66\u7fd2\u6e08\u307f\u306eID\u3092\u6307\u5b9a\u3057\u3001\u7b2c\u4e8c\u5f15\u6570\u306b\u8fd4\u3059\u70b9\u306e\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u3053\u306eexample\u3067\u306f\u30e6\u30fc\u30b60\u304b\u3089\u30e6\u30fc\u30b6942\u307e\u3067\u9806\u756a\u306b\u3001\u985e\u4f3c\u3057\u3066\u3044\u308b\u30e6\u30fc\u30b610\u4eba\u3092\u63a2\u3057\u3066\u304d\u3066\u3044\u307e\u3059\u3002\n\u8fd1\u508d\u70b9\u3092\u63a2\u3059\u65b9\u6cd5\u306fjubatus\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u30d5\u30a1\u30a4\u30eb\u3067\u6307\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n  \"parameter\" : {\n    \"hash_num\" : 128\n    },\n  \"method\": \"lsh\"\n\n\u4eca\u56de\u7528\u3044\u3066\u3044\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u306f\u30c7\u30fc\u30bf\u70b9\u3092128bit\u306e\u30d3\u30c3\u30c8\u30d9\u30af\u30c8\u30eb\u306b\u62bc\u3057\u3064\u3076\u3057\u3066\u985e\u4f3c\u5ea6\u306e\u8a08\u7b97\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u306ehash_num\u3092\u5909\u3048\u305f\u308a\u3001method\u3092\u9055\u3046\u3082\u306e\u306b\u3057\u305f\u308a\u3059\u308b\u3068\u307e\u305f\u9055\u3046\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\n\nnpb_similar_player\n\u7d9a\u3044\u3066\u306fnpb_similar_player\u3092\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u308c\u306f\u4f3c\u3066\u3044\u308b\u30d7\u30ed\u91ce\u7403\u9078\u624b\u3092\u63a2\u3059recommender\u306eexample\u3067\u3059\u3002\n\u30c7\u30fc\u30bf\u306f\u30d7\u30ed\u91ce\u7403\u30c7\u30fc\u30bffreak(http://baseball-data.com/)\u304b\u3089\u53d6\u5f97\u3057\u305f\u91ce\u624b\u306e\u6210\u7e3e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u3044\u307e\u3059\u3002\n\n\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\n\njubatus\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\n$ jubarecommender -f npb_similar_player.json\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5b9f\u884c\njubatus-example/npb_similar_player/python\u306eupdate.py\u3068analyze.py\u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n$ python update.py\n$ python analyze.py\nplayer \u5c71\u7530\u54f2\u4eba is similar to : \u5c71\u7530\u54f2\u4eba, \u7cf8\u4e95\u5609\u7537, \u9ce5\u8c37\u656c\nplayer \u4eca\u5bae\u5065\u592a is similar to : \u4eca\u5bae\u5065\u592a, \u8352\u6728\u96c5\u535a, \u6e21\u8fba\u76f4\u4eba\nplayer \u83ca\u6c60\u6dbc\u4ecb is similar to : \u83ca\u6c60\u6dbc\u4ecb, \u85e4\u7530\u4e00\u4e5f, \u9234\u6728\u5927\u5730\nplayer \u9ce5\u8c37\u656c is similar to : \u9ce5\u8c37\u656c, \u4e38\u4f73\u6d69, \u5e73\u7530\u826f\u4ecb\n...\nplayer \u837b\u91ce\u8cb4\u53f8 is similar to : \u837b\u91ce\u8cb4\u53f8, \u7247\u5ca1\u6cbb\u5927, \u8352\u6ce2\u7fd4\n\n\u5b66\u7fd2\u3068\u5206\u6790\u304c\u3046\u307e\u304f\u3044\u304f\u3068\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306b\u985e\u4f3c\u3057\u305f\u9078\u624b\u306e\u540d\u524d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b(normalize plugin version)\n\u3053\u306eexample\u3067\u306f\u6570\u5024\u30c7\u30fc\u30bf\u306e\u6b63\u898f\u5316\u3092\u884c\u3046\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30db\u30fc\u30e0\u30e9\u30f3\u3001\u6253\u70b9\u3001\u6253\u7387\u306a\u3069\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u304c\u5927\u5e45\u306b\u7570\u306a\u308b\u30c7\u30fc\u30bf\u304c\u6df7\u3056\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u6b63\u898f\u5316\u3057\u305f\u307b\u3046\u304c\u6b63\u3057\u3044\u7d50\u679c\u304c\u5f97\u3089\u308c\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u6b63\u898f\u5316\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30d3\u30eb\u30c9\n\u6b63\u898f\u5316\u30d7\u30e9\u30b0\u30a4\u30f3\u306fjubatus-example/npb_similar_player/normalize_plugin\u306b\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067plugin\u306e\u30d3\u30eb\u30c9\u3092\u884c\u3063\u305f\u3042\u3068\u3001jubatus\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n$ cd jubatus-example/npb_similar_player/normalize_plugin\n$ ./waf configure\n$ ./waf build\n$ cp build/src/*.so /opt/jubatus/lib/jubatus/plugin/\n\n\u6ce8\uff1a\u3053\u306ewaf\u306fpython3\u7cfb\u3067\u306f\u52d5\u304d\u307e\u305b\u3093\u3002\u3002\u3002\n\njubatus\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\n\u4eca\u5ea6\u306fnpb_similar_player.plugin.json\u3092\u4f7f\u3063\u3066jubatus\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n$ jubarecommender -f npb_similar_player.plugin.json\n\n\u30b3\u30f3\u30d5\u30a3\u30b0\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nnum_type \u3067\u72ec\u81ea\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8aad\u307f\u8fbc\u3093\u30602\u7a2e\u985e\u306e\u7279\u5fb4\u62bd\u51fa\u65b9\u6cd5\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001num_rules\u3067\u3069\u306ekey\u304c\u6765\u305f\u3089\u3069\u306e\u7279\u5fb4\u62bd\u51fa\u3092\u884c\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\nnpb_similar_player.plugin.json\n{\n  \"method\": \"inverted_index\",\n  \"converter\": {\n    \"string_filter_types\": {},\n    \"string_filter_rules\": [],\n    \"num_filter_types\": {},\n    \"num_filter_rules\": [],\n    \"string_types\": {},\n    \"string_rules\": [],\n    \"num_types\": {\n      \"HOMERUN\": {\n        \"method\": \"dynamic\",\n        \"path\": \"libnormalize_num_feature.so\",\n        \"function\": \"create\",\n        \"max\": \"25.0\",\n        \"min\": \"0.0\"\n      },\n      \"BASE\": {\n        \"method\": \"dynamic\",\n        \"path\": \"libnormalize_num_feature.so\",\n        \"function\": \"create\",\n        \"max\": \"100.0\",\n        \"min\": \"0.0\"\n      }\n    },\n    \"num_rules\": [\n      {\"key\" : \"*\u7387\", \"type\" : \"num\"},\n      {\"key\" : \"\u672c\u5841\u6253\", \"type\" : \"HOMERUN\"},\n      {\"key\" : \"\u5b89\u6253\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u6253\u70b9\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u76d7\u5841\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u56db\u7403\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u4e09\u632f\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u72a0\u6253\", \"type\" : \"BASE\"}\n    ]\n  },\n  \"parameter\": {}\n}\n\n\n\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5b9f\u884c\n$ python update.py\n$ python analyze.py\nplayer \u5c71\u7530\u54f2\u4eba is similar to : \u5c71\u7530\u54f2\u4eba, \u30d0\u30eb\u30c7\u30a3\u30ea\u30b9, \u6751\u7530\u4fee\u4e00\nplayer \u4eca\u5bae\u5065\u592a is similar to : \u4eca\u5bae\u5065\u592a, \u5c71\u5d0e\u61b2\u6674, \u4f0a\u85e4\u5149\nplayer \u83ca\u6c60\u6dbc\u4ecb is similar to : \u83ca\u6c60\u6dbc\u4ecb, \u7247\u5ca1\u6cbb\u5927, \u85e4\u7530\u4e00\u4e5f\nplayer \u9ce5\u8c37\u656c is similar to : \u9ce5\u8c37\u656c, \u89d2\u4e2d\u52dd\u4e5f, \u5ca1\u5cf6\u8c6a\u90ce\n...\nplayer \u837b\u91ce\u8cb4\u53f8 is similar to : \u837b\u91ce\u8cb4\u53f8, \u5ddd\u7aef\u5d07\u7fa9, \u8352\u6ce2\u7fd4\n\n\u5148\u307b\u3069\u3068\u7d50\u679c\u304c\u5909\u308f\u3063\u3066\u3044\u307e\u3059\u306d\u3002\n\n\u3061\u3087\u3063\u3068\u3057\u305f\u89e3\u8aac\n\u5927\u4f53\u306f\u5148\u307b\u3069\u306emovielens\u3068\u540c\u69d8\u3067\u3059\u3002csv\u30d5\u30a1\u30a4\u30eb\u3092\u9806\u756a\u306b\u8aad\u307f\u8fbc\u3093\u3067Datum\u3092\u4f5c\u308a\u3001update_row\u3067\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\nupdate.py\n   for line in open('../dat/baseball.csv'):\n        pname, team, bave, games, pa, atbat, hit, homerun, runsbat, stolen, bob, hbp, strikeout, sacrifice, dp, slg, obp, ops, rc27, xr27 = line[:-1].split(',')\n        d = Datum({\n          \"\u30c1\u30fc\u30e0\": team,\n          \"\u6253\u7387\": float(bave),\n          \"\u8a66\u5408\u6570\": float(games),\n          \"\u6253\u5e2d\": float(pa),\n          \"\u6253\u6570\": float(atbat),\n          \"\u5b89\u6253\": float(hit),\n          \"\u672c\u5841\u6253\": float(homerun),\n          \"\u6253\u70b9\": float(runsbat),\n          \"\u76d7\u5841\": float(stolen),\n          \"\u56db\u7403\": float(bob),\n          \"\u6b7b\u7403\": float(hbp),\n          \"\u4e09\u632f\": float(strikeout),\n          \"\u72a0\u6253\": float(sacrifice),\n          \"\u4f75\u6bba\u6253\": float(dp),\n          \"\u9577\u6253\u7387\": float(slg),\n          \"\u51fa\u5841\u7387\": float(obp),\n          \"OPS\": float(ops),\n          \"RC27\": float(rc27),\n          \"XR27\": float(xr27)\n          })\n        recommender.update_row(pname, d)\n\n\n\u5206\u6790\u3059\u308b\u3068\u304d\u306f\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u9078\u624b\u540d\u3092\u53d6\u3063\u3066\u304d\u3066\u3001similar_row_from_id\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\nanalyze.py\n    for line in codecs.open('../dat/baseball.csv', 'r', 'utf-8'):\n      pname, team, bave, games, pa, atbat, hit, homerun, runsbat, stolen, bob, hbp, strikeout, sacrifice, dp, slg, obp, ops, rc27, xr27 = line[:-1].split(',')\n      sr = recommender.similar_row_from_id(pname , 4)\n\n\n\u7279\u5fb4\u62bd\u51fa\u65b9\u6cd5\u306fjubatus\u306e\u30b5\u30fc\u30d0\u5074\u3067\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u6b63\u898f\u5316\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u3046\u5834\u5408\u3082\u4f7f\u308f\u306a\u3044\u5834\u5408\u3082\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u5074\u306b\u306f\u5909\u66f4\u3042\u308a\u307e\u305b\u3093\u3002\n\u8a18\u4e8b\u304c\u9577\u304f\u306a\u3063\u3066\u304d\u305f\u306e\u3067\u4e00\u65e6\u533a\u5207\u308a\u307e\u3059\u3002\n\u660e\u65e5\u3082\u50d5\u304cjubatus-example\u3092\u52d5\u304b\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u306f [Jubatus Advent Calendar](http://qiita.com/advent-calendar/2016/jubatus) \u306e2\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\nJubatus advent calendar 2\u65e5\u76ee\u304b\u3089\u306fJubatus\u306b\u642d\u8f09\u3055\u308c\u3066\u3044\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u7d39\u4ecb\u3082\u517c\u306d\u3066\u3001jubatus-example\u3092\u9806\u756a\u306b\u5168\u3066\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n# jubatus-example\u3068\u306f\n\ngithub\u306e[\u3053\u3061\u3089](https://github.com/jubatus/jubatus-example)\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u3001Jubatus\u3092\u4f7f\u3063\u305f\u30b5\u30f3\u30d7\u30eb\u30d7\u30ed\u30b0\u30e9\u30e0\u96c6\u3067\u3059\u3002\nREADME\u306b\u66f8\u3044\u3066\u3042\u308b\u901a\u308a\u3001\u73fe\u57288\u7a2e\u306e\u6a5f\u68b0\u5b66\u7fd2\u30a8\u30f3\u30b8\u30f3\u306b\u3064\u3044\u3066\u300117\u7a2e\u306eexample\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u30a8\u30f3\u30b8\u30f3\u3092\u52d5\u304b\u3059\u3060\u3051\u306e\u5358\u7d14\u306a\u3082\u306e\u304b\u3089\u3001\u5c11\u3005\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5206\u6790\u3092\u884c\u3046\u3082\u306e\u307e\u3067\u69d8\u3005\u3067\u3059\u3002\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a00\u8a9e\u3082C++/Python/Ruby/Java\u306e4\u7a2e\u306e\u8a00\u8a9e\u3067\u5b9f\u88c5\u3055\u308c\u305f\u3082\u306e\u304c\u3042\u308a\u307e\u3059\u3002\n\\# \u6b6f\u629c\u3051\u306b\u306a\u3063\u3066\u3044\u308b\u3082\u306e\u3082\u591a\u3044\u306e\u3067\u3001\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u304a\u5f85\u3061\u3057\u3066\u307e\u3059\uff01\n~~\u4eca\u56de\u306f\u552f\u4e00\u5168\u3066\u306eexample\u304c\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308bPython\u306eexample\u3092\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002~~\n\u5f8c\u7de8\u3067\u6271\u3046malware classification\u306fc++\u3060\u3051\u3001winequality\u306fruby\u3060\u3051\u3067\u3057\u305f\u3002\u3054\u3081\u3093\u306a\u3055\u3044\u3002\n\n# \u524d\u7de8\u3067\u5b9f\u884c\u3059\u308bexample\n\n\u524d\u7de8\u306e\u4eca\u65e5\u306f\u5358\u7d14\u306aexample\u3092\u4e2d\u5fc3\u306b\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002(\u62ec\u5f27\u5185\u306f\u4f7f\u7528\u3059\u308b\u6a5f\u68b0\u5b66\u7fd2\u30a8\u30f3\u30b8\u30f3)\n- shogun (classifier)\n- gender (classifier)\n- movielens (recommender)\n- npb_similar_player (recommender)\n\n\n# \u74b0\u5883\n\u4eca\u56de\u306eexample\u306e\u5b9f\u884c\u306f\u5168\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u74b0\u5883\u3067\u884c\u3044\u307e\u3059\u3002\n\n|\u9805\u76ee            | \u30d0\u30fc\u30b8\u30e7\u30f3\u306a\u3069             |\n|----------------|--------------------------|\n|OS              | ubuntu 14.04             |\n|Jubatus version | 1.0.0 (apt\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb) |\n|Python          | 3.5.2                    | \n\n\n\n\n# \u6e96\u5099\n## jubatus\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a\n\u4eca\u56de\u306fjubatus\u3092apt\u3067\u5165\u308c\u308b\u306e\u3067\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u767b\u9332, apt-get, \u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n\n```\n$ echo \"deb http://download.jubat.us/apt/ubuntu/trusty binary/\" | tee /etc/apt/sources.list.d/jubatus.list\n$ apt-get update\n$ apt-get install jubatus\n$ source /opt/jubatus/profile\n``` \n\n## jubatus python \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npip \u3067jubatus\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\n\n```\npip install jubatus\n```\n\n\n## jubatus-example\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\njubatus-example\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092clone\u3057\u3066\u304d\u307e\u3059\u3002\n\n```\ngit clone http://github.com/jubatus/jubatus-example.git\n```\n\n\u4ee5\u4e0a\u3067\u6e96\u5099\u306f\u7d42\u308f\u308a\u3067\u3059\u3002\n\n# shogun\n\u6700\u521d\u306b\u52d5\u304b\u3059\u306e\u306fclassifier\u306eexample \"shogun\" \u3067\u3059\u3002\n\u3053\u306eexample\u3067\u306f\u6b74\u4ee3\u5c06\u8ecd\u306e\u540d\u524d\u3092jubatus\u306b\u5b66\u7fd2\u3055\u305b\u3001\u65b0\u305f\u306b\u5165\u529b\u3055\u308c\u305f\u540d\u524d\u304c\u3069\u306e\u5c06\u8ecd\u5bb6\u3063\u307d\u3044\u304b\u3092\u5206\u985e\u3057\u307e\u3059\u3002\n\n## \u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\n\n### jubatus \u30b5\u30fc\u30d0\u306e\u8d77\u52d5\n\u306f\u3058\u3081\u306bjubatus\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3055\u305b\u307e\u3059\u3002\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\u306b\u306f\u4f7f\u7528\u3059\u308b\u30a8\u30f3\u30b8\u30f3\u306b\u5408\u308f\u305b\u305f`juba{hoge}` \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u5206\u985e\u5668\u306e\u5834\u5408\u306f`jubaclassifier`\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\u3053\u306e\u6642\u3001\u30b5\u30fc\u30d0\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u6307\u5b9a\u304c\u5fc5\u9808\u3068\u306a\u308a\u307e\u3059\u3002\u4eca\u56de\u306fjubatus-example/shogun \u306e\u4e0b\u306b\u3042\u308bshogun.json\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```\n$ jubaclassifier -f shogun.json\n2016-11-30 19:50:32,691 21212 INFO  [server_util.cpp:429] starting jubaclassifier 1.0.0 RPC server at 10.0.2.15:9199                                                                                                                   \n    pid                  : 21212\n    user                 : TkrUdagawa\n    mode                 : standalone mode\n    timeout              : 10\n    thread               : 2\n    datadir              : /tmp\n    logdir               : \n    log config           : \n    zookeeper            : \n    name                 : \n    interval sec         : 16\n    interval count       : 512\n    zookeeper timeout    : 10\n    interconnect timeout : 10\n\n2016-11-30 19:50:32,691 21212 INFO  [server_util.cpp:165] load config from local file: /home/TkrUdagawa/jubatus-example/shogun/shogun.json\n2016-11-30 19:50:32,692 21212 INFO  [classifier_serv.cpp:115] config loaded: {\n  \"method\": \"AROW\",\n  \"converter\": {\n    \"num_filter_types\": {},\n    \"num_filter_rules\": [],\n    \"string_filter_types\": {},\n    \"string_filter_rules\": [],\n    \"num_types\": {},\n    \"num_rules\": [],\n    \"string_types\": {\n      \"unigram\": { \"method\": \"ngram\", \"char_num\": \"1\" }\n    },\n    \"string_rules\": [\n      { \"key\": \"*\", \"type\": \"unigram\", \"sample_weight\": \"bin\", \"global_weight\": \"bin\" }\n    ]\n  },\n  \"parameter\": {\n    \"regularization_weight\" : 1.0\n  }\n}\n\n2016-11-30 19:50:32,692 21212 INFO  [server_helper.hpp:226] start listening at port 9199\n2016-11-30 19:50:32,692 21212 INFO  [server_helper.hpp:233] jubaclassifier RPC server startup\n\n```\n\n\u6b63\u3057\u304fjubatus\u30b5\u30fc\u30d0\u304c\u8d77\u52d5\u3057\u3066\u3044\u308c\u3070\u4e0a\u8a18\u306e\u3088\u3046\u306a\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u3001jubatus\u30b5\u30fc\u30d0\u304c9199\u30dd\u30fc\u30c8\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u4ed8\u3051\u59cb\u3081\u307e\u3059\u3002\nconfig\u306e\u610f\u5473\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e[\u30c7\u30fc\u30bf\u5909\u63db](http://jubat.us/ja/fv_convert.html)\u3084[\u30af\u30e9\u30a4\u30a2\u30f3\u30c8API](http://jubat.us/ja/api/api_classifier.html#configuration)\u306a\u3069\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\u3056\u3063\u304f\u308a\u3068\u3057\u305f\u89e3\u8aac\u3092\u3059\u308b\u3068\u3001classifier\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b`AROW`\u3092\u6307\u5b9a\u3001\u6587\u5b57\u5217\u306e\u7279\u5fb4\u304c\u4e0e\u3048\u3089\u308c\u305f\u30891\u6587\u5b571\u6587\u5b57\u5358\u4f4d\u3067\u5b66\u7fd2\u3059\u308b\u3001\u3068\u3044\u3046\u8a2d\u5b9a\u3092\u4e0e\u3048\u3066\u3044\u307e\u3059\u3002\n\n### \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u884c\njubatus-example/shogun/python \u306e\u4e0b\u306b\u3042\u308bshogun.py\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n$ python shogun.py\n\u5fb3\u5ddd \u6176\u559c\n\u8db3\u5229 \u7fa9\u662d\n\u5317\u6761 \u5b88\u6642\n```\n\n\u7121\u4e8b\u306b\u540d\u5b57\u3068\u540d\u524d\u306e\u5bfe\u5fdc\u304c\u3068\u308c\u305f\u7d50\u679c\u304c\u51fa\u529b\u3055\u308c\u307e\u3057\u305f\u3002\n\n### \u3061\u3087\u3063\u3068\u3057\u305f\u89e3\u8aac\n\u3053\u306eexample\u3067\u306f\n1. \u5c06\u8ecd\u306e\u540d\u5b57\u3092\u30e9\u30d9\u30eb\u3001\u540d\u524d\u3092\u30c7\u30fc\u30bf\u3068\u3057\u3066jubatus\u306b\u5b66\u7fd2\n2. \u540d\u524d\u3060\u3051\u3092jubatus\u306b\u4e0e\u3048\u3066\u5206\u985e\n\n\u3068\u3044\u3046\u3053\u3068\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n1.\u306e\u51e6\u7406\u304cshogun.py\u306etrain\u30e1\u30bd\u30c3\u30c9\u30012.\u306e\u51e6\u7406\u304cshogun.py\u306epredict\u30e1\u30bd\u30c3\u30c9\u3067\u884c\u308f\u308c\u307e\u3059\u3002\n\n```\n1. \u5b66\u7fd2\ndef train(client):\n    # prepare training data\n    # predict the last ones (that are commented out)\n    train_data = [  # \u5b66\u7fd2\u306b\u7528\u3044\u308b\u30c7\u30fc\u30bf\u3092(\u30e9\u30d9\u30eb\u3001Datum)\u306e\u30bf\u30d7\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u4f5c\u308b\n        ('\u5fb3\u5ddd', Datum({'name': '\u5bb6\u5eb7'})),\n        ('\u5fb3\u5ddd', Datum({'name': '\u79c0\u5fe0'})),\n        ....(\u4e2d\u7565)       \n        ('\u5317\u6761', Datum({'name': '\u9ad8\u6642'})),\n        ('\u5317\u6761', Datum({'name': '\u8c9e\u9855'})),\n        # (u'\u5317\u6761', Datum({'name': u'\u5b88\u6642'})),  \n    ]\n    random.shuffle(train_data)\n    client.train(train_data)  # jubatus\u306b\u5b66\u7fd2\u3055\u305b\u308b\n```\n\n\u3053\u3053\u3067\u51fa\u3066\u304f\u308bDatum(\u3067\u30fc\u305f\u3080)\u3068\u3044\u3046\u30c7\u30fc\u30bf\u578b\u304cJubatus\u3067\u4f7f\u308f\u308c\u308b\u7279\u6709\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u306b\u306a\u308a\u307e\u3059\u3002\nDatum\u306fkey-value\u578b\u306e\u69cb\u9020\u3092\u3082\u3063\u3066\u304a\u308a\u3001\u6570\u5024\u7279\u5fb4\u3001\u6587\u5b57\u5217\u7279\u5fb4\u3001\u30d0\u30a4\u30ca\u30ea\u7279\u5fb4\u306e3\u7a2e\u985e\u306e\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u4f8b\u3067\u306f `{'name':'\u5bb6\u5eb7'}` \u306e\u3088\u3046\u306b\u6587\u5b57\u5217\u7279\u5fb4\u30921\u3064\u3057\u304b\u6e21\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001`{'name':'\u5bb6\u5eb7', 'stroke': 21}`\u306a\u3069\u306e\u3088\u3046\u306b\u6570\u5024\u304cvalue\u3068\u306a\u308b\u3082\u306e\u3092\u6e21\u3059\u3068\u6570\u5024\u7279\u5fb4\u91cf\u3092\u542b\u3080Datum\u3092\u3064\u304f\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u3053\u3067\u4f5c\u6210\u3057\u305fDatum\u3068\u30e9\u30d9\u30eb\u306e\u30bf\u30d7\u30eb\u306e\u30ea\u30b9\u30c8\u3092`train`\u30e1\u30bd\u30c3\u30c9\u306b\u6e21\u3059\u3053\u3068\u3067\u5b66\u7fd2\u304c\u3067\u304d\u307e\u3059\u3002\n\n```\n2. \u5206\u985e\ndef predict(client):\n    # predict the last shogun\n    data = [ # \u5206\u6790\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u3092Datum\u306e\u30ea\u30b9\u30c8\u3067\u4f5c\u308b\n        Datum({'name': '\u6176\u559c'}),\n        Datum({'name': '\u7fa9\u662d'}),\n        Datum({'name': '\u5b88\u6642'}),\n    ]\n    for d in data:\n        res = client.classify([d]) # jubatus\u3067\u5206\u6790\n        # get the predicted shogun name\n        shogun_name = max(res[0], key = lambda x: x.score).label # \u5206\u6790\u7d50\u679c\u306e\u3046\u3061\u6700\u3082\u30b9\u30b3\u30a2\u306e\u9ad8\u3044\u30e9\u30d9\u30eb\u3092\u53d6\u5f97\n        first_name = d.string_values[0][1]\n        _output('{0} {1}\\n'.format(shogun_name, first_name))\n```\n\n\u5206\u985e\u3059\u308b\u3068\u304d\u306fDatum\u306e\u30ea\u30b9\u30c8\u3092\u4f5c\u308a\u3001`classify`\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\u8fd4\u308a\u5024\u306fclassifier\u304c\u899a\u3048\u3066\u3044\u308b\u5168\u3066\u306e\u30e9\u30d9\u30eb\u306b\u3064\u3044\u3066\u306e\u30b9\u30b3\u30a2\u306b\u306a\u308a\u307e\u3059\u3002\n\u3057\u305f\u304c\u3063\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u3001\u6700\u3082\u9ad8\u3044\u30b9\u30b3\u30a2\u306e\u30e9\u30d9\u30eb\u3092\u629c\u304d\u51fa\u3059\u51e6\u7406\u3092\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\n# gender\n\u6b21\u306b\u5b9f\u884c\u3059\u308b\u306e\u306f\u540c\u3058\u304fclassifier\u306eexample \"gender\" \u3067\u3059\u3002\n\u3053\u306eexample\u3067\u306fmale, female\u3068\u3044\u3046\u30e9\u30d9\u30eb\u3068\u3001\u9aea\u306e\u9577\u3055`hair`\u3001 \u4e0a\u534a\u8eab\u306e\u670d\u88c5`top`\u3001\u4e0b\u534a\u8eab\u306e\u670d\u88c5`bottom`\u3001\u8eab\u9577`height`\u3068\u3044\u3063\u305f\u7279\u5fb4\u3092\u5b66\u7fd2\u3055\u305b\u3001\u7537\u6027\u3092\u5973\u6027\u306e\u7279\u5fb4\u3092jubatus\u306b\u5206\u985e\u3055\u305b\u307e\u3059\u3002\n\n## \u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\n### jubatus\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\nshogun\u3068\u540c\u69d8\u3001\u307e\u305a\u306fjubatus\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\u4eca\u56de\u3082\u5206\u985e\u5668\u306a\u306e\u3067`jubaclassifier`\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n$ jubaclassifier -f gender.json &\n```\n\n### \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u884c\n\n\u7d9a\u3044\u3066jubatus-example/gender/python \u306b\u3042\u308b\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0gender.py\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n$ python gender.py\nfemale: 0.061350\nmale: 0.367799\n------\nfemale: 0.600048\nmale: -0.372206\n------\n```\n\n\u3061\u3083\u3093\u3068\u52d5\u4f5c\u3059\u308c\u3070\u7537\u6027(male)\u3001\u5973\u6027(female)\u305d\u308c\u305e\u308c\u306e\u30e9\u30d9\u30eb\u306e\u30b9\u30b3\u30a2\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n### \u3061\u3087\u3063\u3068\u3057\u305f\u89e3\u8aac\n\n\u3053\u306eexample\u3067\u306fjubatus\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u3092\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\n```\ntrain_data = [\n    ('male',   Datum({'hair': 'short', 'top': 'sweater', 'bottom': 'jeans', 'height': 1.70})),\n    ('female', Datum({'hair': 'long',  'top': 'shirt',   'bottom': 'skirt', 'height': 1.56})),\n    ('male',   Datum({'hair': 'short', 'top': 'jacket',  'bottom': 'chino', 'height': 1.65})),\n    ('female', Datum({'hair': 'short', 'top': 'T shirt', 'bottom': 'jeans', 'height': 1.72})),\n    ('male',   Datum({'hair': 'long',  'top': 'T shirt', 'bottom': 'jeans', 'height': 1.82})),\n    ('female', Datum({'hair': 'long',  'top': 'jacket',  'bottom': 'skirt', 'height': 1.43})),\n#    ('male',   Datum({'hair': 'short', 'top': 'jacket',  'bottom': 'jeans', 'height': 1.76})),\n#    ('female', Datum({'hair': 'long',  'top': 'sweater', 'bottom': 'skirt', 'height': 1.52})),\n    ]\n```\n\nmale\u3001female\u306e\u30b5\u30f3\u30d7\u30eb\u305d\u308c\u305e\u308c3\u3064\u305a\u3064\u7528\u610f\u3057\u3001\u3069\u306e\u7279\u5fb4\u304c\u3069\u306e\u7a0b\u5ea6\u5206\u985e\u306b\u5bc4\u4e0e\u3059\u308b\u304b\u3092Jubatus\u306b\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002\nhair long\u306ffemale\u306b\u73fe\u308c\u3084\u3059\u3044\u3001\u3068\u304bbottom skirt\u306fmale\u306b\u306f\u73fe\u308c\u3066\u3044\u306a\u3044\u3001\u306a\u3069\u30c7\u30fc\u30bf\u304b\u3089\u5206\u985e\u306e\u898f\u5247\u3092\u5b66\u3093\u3067\u3044\u304d\u307e\u3059\u3002\n\n\u5206\u6790\u3055\u305b\u3066\u3044\u308b\u30c7\u30fc\u30bf\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\u3002\n\n```\ntest_data = [\n    Datum({'hair': 'short', 'top': 'T shirt', 'bottom': 'jeans', 'height': 1.81}),\n    Datum({'hair': 'long',  'top': 'shirt',   'bottom': 'skirt', 'height': 1.50}),\n]\n```\n\n\u3053\u306e\u5206\u6790\u30c7\u30fc\u30bf\u304c\u305d\u308c\u305e\u308cmale\u3068\u5206\u985e\u3067\u304d\u308b\u304bfemale\u3068\u5206\u985e\u3067\u304d\u308b\u304bjubatus\u304c\u30b9\u30b3\u30a2\u3092\u3064\u3051\u3066\u8fd4\u3057\u3066\u304d\u3066\u3044\u307e\u3059\u3002\n\u30b9\u30b3\u30a2\u304c\u9ad8\u3044\u307b\u3069\u305d\u306e\u30e9\u30d9\u30eb\u3068\u8a00\u3048\u307e\u3059\u3002\u5148\u307b\u3069\u5b9f\u884c\u3057\u305f\u4f8b\u3067\u306f1\u756a\u76ee\u306e\u30c7\u30fc\u30bf\u306fmale\u3063\u307d\u3044\u30012\u756a\u76ee\u306e\u30c7\u30fc\u30bf\u306ffemale\u3063\u307d\u3044\u3068\u3044\u3046\u7d50\u679c\u304c\u5f97\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092\u5b66\u7fd2\u3055\u305b\u3066\u307f\u305f\u308a\u3001\u5206\u6790\u5bfe\u8c61\u306e\u30c7\u30fc\u30bf\u3092\u5897\u3084\u3057\u3066\u307f\u305f\u308a\u3057\u3066\u3044\u308d\u3044\u308d\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n# movielens\n\u6b21\u306b\u52d5\u304b\u3059example\u306fmovielens\u3067\u3059\u3002\n\u4eca\u5ea6\u306fjubatus\u306erecommender\u3092\u4f7f\u3063\u305fexample\u306b\u306a\u308a\u307e\u3059\u3002\nrecommender\u306f\u5b66\u7fd2\u3057\u305f\u30c7\u30fc\u30bf\u304b\u3089\u985e\u4f3c\u3057\u305f\u30c7\u30fc\u30bf\u3092\u898b\u3064\u3051\u3066\u304f\u308b\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001\u985e\u4f3c\u3057\u305f\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u3001\u30c7\u30fc\u30bf\u4e2d\u306e\u6b20\u640d\u3057\u305f\u5024\u306e\u88dc\u5b8c\u3059\u308b\u6a5f\u80fd\u3082\u3042\u3063\u305f\u308a\u3057\u307e\u3059\u3002\n\n\u3053\u306eexample\u3067\u306f\u6620\u753b\u306e\u8a55\u4fa1\u30c7\u30fc\u30bf\u3092\u96c6\u3081\u305f\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8[movielens](http://grouplens.org/datasets/movielens/)\u3092\u4f7f\u3063\u3066\u3001\u6620\u753b\u306e\u597d\u307f\u304c\u4f3c\u3066\u3044\u308b\u30e6\u30fc\u30b6\u3092\u898b\u3064\u3051\u307e\u3059\u3002\n\n## \u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\n\n### \u30c7\u30fc\u30bf\u306e\u6e96\u5099\n\u306f\u3058\u3081\u306b\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nREADME\u306b\u6cbf\u3063\u3066dat \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u4e2d\u306b\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n```\nmkdir dat\ncd dat\nwget http://www.grouplens.org/system/files/ml-100k.zip\nunzip ml-100k.zip\ncd ..\n```\n\n### jubatus\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\n\u3064\u3065\u3044\u3066jubatus\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002shogun, gender\u3068\u306f\u7570\u306a\u308a\u3001\u4eca\u5ea6\u306f`jubarecommender`\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n$ jubarecommender -f config.json\n2016-12-01 13:53:17,302 5336 INFO  [server_util.cpp:429] starting jubarecommender 1.0.0 RPC server at 10.0.2.15:9199\n    pid                  : 5336\n    user                 : TkrUdagawa\n    mode                 : standalone mode\n    timeout              : 10\n    thread               : 2\n    datadir              : /tmp\n    logdir               : \n    log config           : \n    zookeeper            : \n    name                 : \n    interval sec         : 16\n    interval count       : 512\n    zookeeper timeout    : 10\n    interconnect timeout : 10\n\n2016-12-01 13:53:17,304 5336 INFO  [server_util.cpp:165] load config from local file: /home/TkrUdagawa/jubatus-example/movielens/config.json\n2016-12-01 13:53:17,304 5336 INFO  [recommender_serv.cpp:118] config loaded: {\n  \"converter\" : {\n    \"string_filter_types\": {},\n    \"string_filter_rules\":[],\n    \"num_filter_types\": {},\n    \"num_filter_rules\": [],\n    \"string_types\": {},\n    \"string_rules\":[\n      {\"key\" : \"*\", \"type\" : \"str\", \"sample_weight\":\"bin\", \"global_weight\" : \"bin\"}\n    ],\n    \"num_types\": {},\n    \"num_rules\": [\n      {\"key\" : \"*\", \"type\" : \"num\"}\n    ]\n  },\n  \"parameter\" : {\n    \"hash_num\" : 128\n    },\n  \"method\": \"lsh\"\n}\n\n2016-12-01 13:53:17,305 5336 INFO  [server_helper.hpp:226] start listening at port 9199\n2016-12-01 13:53:17,306 5336 INFO  [server_helper.hpp:233] jubarecommender RPC server startup\n\n\n```\nconfig\u306e`method`\u304c\u4eca\u5ea6\u306flsh\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306fjubarecommender\u3067\u5229\u7528\u3059\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067Locality Sensitive Hash \u3068\u3044\u3046\u65b9\u6cd5\u3092\u4f7f\u3046\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u8a73\u7d30\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e[\u30af\u30e9\u30a4\u30a2\u30f3\u30c8API](http://jubat.us/ja/api/api_regression.html)\u3084[\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0](http://jubat.us/ja/method.html#recommender) \u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n\n### \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5b9f\u884c\n`jubatus-example/movielens/python` \u306b\u3042\u308b\u5b66\u7fd2\u7528\u30b9\u30af\u30ea\u30d7\u30c8ml_update.py\u3068\u5206\u6790\u7528\u30b9\u30af\u30ea\u30d7\u30c8ml_analysis.py\u3092\u9806\u306b\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```\n$ python ml_update.py\n0\n1000\n2000\n(\u4e2d\u7565)\n99000\n\n$ python ml_analysis.py\nuser  0  is similar to : []\nuser  1  is similar to : ['id_with_score{id: 1, score: 1.0}', 'id_with_score{id: 59, score: 0.765625}', 'id_with_score{id: 561, score: 0.765625}', 'id_with_score{id: 757, score: 0.75}', 'id_with_score{id: 64, score: 0.75}', ...\nuser  2  is similar to : ['id_with_score{id: 2, score: 1.0}', 'id_with_score{id: 701, score: 0.7421875}', 'id_with_score{id: 768, score: 0.71875}', 'id_with_score{id: 624, score: 0.71875}', 'id_with_score{id: 937, score: 0.7109375}, ...\n...\nuser  942  is similar to : ['id_with_score{id: 942, score: 1.0}', 'id_with_score{id: 91, score: 0.703125}', 'id_with_score{id: 724, score: 0.703125}', 'id_with_score{id: 668, score: 0.6953125}',\n```\n\n\u30e6\u30fc\u30b61\u304b\u3089\u30e6\u30fc\u30b6942\u307e\u3067\u305d\u308c\u305e\u308c\u985e\u4f3c\u5ea6\u304c\u9ad8\u3044\u30e6\u30fc\u30b6\u306eID\u3068\u30b9\u30b3\u30a2\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u4f8b\u3048\u3070\u30e6\u30fc\u30b61\u306f\u30e6\u30fc\u30b659\u3068\u6700\u3082\u985e\u4f3c\u3057\u3066\u3044\u3066\u3001\u985e\u4f3c\u30b9\u30b3\u30a2\u306f0.765625\u3067\u3059\u3002jubarecommender\u306e\u4ed5\u69d8\u4e0a\u3001\u8fd4\u5374\u5024\u306b\u81ea\u5206\u81ea\u8eab\u304c\u542b\u307e\u308c\u308b\u305f\u3081\u3001\u6700\u3082\u985e\u4f3c\u5ea6\u304c\u9ad8\u3044\u76f8\u624b\u3068\u3057\u3066\u81ea\u5206\u81ea\u8eab\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u307e\u305f\u3001\u6700\u521d\u306e\u884c\u3067\u30e6\u30fc\u30b60\u306e\u7d50\u679c\u304c\u7a7a\u306a\u306e\u306f\u3001\u5b58\u5728\u3057\u306a\u3044\u30e6\u30fc\u30b6ID\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u3092\u767a\u884c\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u305f\u3081\u3067\u3059\uff08\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d0\u30b0\u3067\u3059\uff09\u3002\n\n### \u3061\u3087\u3063\u3068\u3057\u305f\u89e3\u8aac\n\n\u89e3\u51cd\u3057\u305fdat/ml-100k/\u306e\u4e2d\u3092\u898b\u3066\u3082\u3089\u3048\u3070\u308f\u304b\u308a\u307e\u3059\u304c\u3001\u3053\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e\u4e2d\u306b\u306f\u4f55\u7a2e\u985e\u304b\u306e\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u3044\u307e\u3059\u3002\u4eca\u56de\u306eexample\u3067\u306f`u.data`\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306fuser_id, item_id, rating, timestamp\u306e\u7d44\u3001\u3064\u307e\u308a\u3001\u8ab0\u304c\u3069\u306e\u6620\u753b\u306b\u3069\u3093\u306a\u8a55\u4fa1\u3092\u3044\u3064\u3064\u3051\u305f\u306e\u304b\u3001\u306e\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3057\u305ftsv\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n\u5b66\u7fd2\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u4e2d\u3067\u306f\u3053\u306e\u30c7\u30fc\u30bf\u3092\u9806\u756a\u306b\u8aad\u307f\u8fbc\u307f\u8ab0\u304c\u3069\u306e\u6620\u753b\u306b\u3069\u3093\u306a\u8a55\u4fa1\u3092\u3064\u3051\u305f\u306e\u304b\u3092\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\n```python:ml_update.py\nfor line in open('../dat/ml-100k/u.data'):\n    userid, movieid, rating, mtime = line[:-1].split('\\t')\n    datum = Datum({str(movieid): float(rating)})\n    recommender.update_row(userid, datum)\n```\n\nDatum\u3092\u4f5c\u6210\u3059\u308b\u3068\u304d\u306b\u306f\u6620\u753b\u306e\u30bf\u30a4\u30c8\u30eb\u3092key, \u6620\u753b\u306b\u5bfe\u3059\u308b\u8a55\u4fa1(1 ~ 5)\u3092value\u3068\u3057\u3066\u4e0e\u3048\u3066\u3044\u307e\u3059\u3002\u6b21\u306b\u3001`recommender.update_row(userid, datum)`\u3068\u3044\u3046\u30e1\u30bd\u30c3\u30c9\u3067jubatus\u306b\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002`update_row`\u306f\u7b2c\u4e00\u5f15\u6570\u306b\u5b66\u7fd2\u3055\u305b\u308b\u884c\u306eID, \u7b2c\u4e8c\u5f15\u6570\u306b\u5b66\u7fd2\u3055\u305b\u308bDatum\u3092\u4e0e\u3048\u307e\u3059\u3002ID\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306b\u306f\u65b0\u305f\u306b\u305d\u306eID\u304c\u8ffd\u52a0\u3055\u308c\u3001datum\u306e\u4e2d\u8eab\u304c\u5b66\u7fd2\u3055\u308c\u307e\u3059\u3002\u65e2\u306bID\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3001datum\u306e\u4e2d\u8eab\u304c\u8ffd\u8a18\u3055\u308c\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u5206\u6790\u3092\u884c\u3046\u969b\u306b\u306f`recommender.similar_row_from_id`\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3057\u3066\u3044\u307e\u3059\u3002\n\n```python:ml_analysis.py\nfor i in range(0,943):\n    sr = recommender.similar_row_from_id(str(i) , 10);\n    print(\"user \", str(i),  \" is similar to :\", list(map(str, sr)))\n```\n\n\u3053\u306e\u30e1\u30bd\u30c3\u30c9\u306f\u7b2c\u4e00\u5f15\u6570\u306b\u5b66\u7fd2\u6e08\u307f\u306eID\u3092\u6307\u5b9a\u3057\u3001\u7b2c\u4e8c\u5f15\u6570\u306b\u8fd4\u3059\u70b9\u306e\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u3053\u306eexample\u3067\u306f\u30e6\u30fc\u30b60\u304b\u3089\u30e6\u30fc\u30b6942\u307e\u3067\u9806\u756a\u306b\u3001\u985e\u4f3c\u3057\u3066\u3044\u308b\u30e6\u30fc\u30b610\u4eba\u3092\u63a2\u3057\u3066\u304d\u3066\u3044\u307e\u3059\u3002\n\n\u8fd1\u508d\u70b9\u3092\u63a2\u3059\u65b9\u6cd5\u306fjubatus\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u30d5\u30a1\u30a4\u30eb\u3067\u6307\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n```\n  \"parameter\" : {\n    \"hash_num\" : 128\n    },\n  \"method\": \"lsh\"\n```\n\n\u4eca\u56de\u7528\u3044\u3066\u3044\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u306f\u30c7\u30fc\u30bf\u70b9\u3092128bit\u306e\u30d3\u30c3\u30c8\u30d9\u30af\u30c8\u30eb\u306b\u62bc\u3057\u3064\u3076\u3057\u3066\u985e\u4f3c\u5ea6\u306e\u8a08\u7b97\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e`hash_num`\u3092\u5909\u3048\u305f\u308a\u3001`method`\u3092\u9055\u3046\u3082\u306e\u306b\u3057\u305f\u308a\u3059\u308b\u3068\u307e\u305f\u9055\u3046\u7d50\u679c\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\n\n# npb_similar_player\n\n\u7d9a\u3044\u3066\u306fnpb_similar_player\u3092\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3053\u308c\u306f\u4f3c\u3066\u3044\u308b\u30d7\u30ed\u91ce\u7403\u9078\u624b\u3092\u63a2\u3059recommender\u306eexample\u3067\u3059\u3002\n\u30c7\u30fc\u30bf\u306f\u30d7\u30ed\u91ce\u7403\u30c7\u30fc\u30bffreak(http://baseball-data.com/)\u304b\u3089\u53d6\u5f97\u3057\u305f\u91ce\u624b\u306e\u6210\u7e3e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u3044\u307e\u3059\u3002\n\n## \u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\n\n### jubatus\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\n\n```\n$ jubarecommender -f npb_similar_player.json\n```\n\n### \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5b9f\u884c\njubatus-example/npb_similar_player/python\u306eupdate.py\u3068analyze.py\u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```\n$ python update.py\n$ python analyze.py\nplayer \u5c71\u7530\u54f2\u4eba is similar to : \u5c71\u7530\u54f2\u4eba, \u7cf8\u4e95\u5609\u7537, \u9ce5\u8c37\u656c\nplayer \u4eca\u5bae\u5065\u592a is similar to : \u4eca\u5bae\u5065\u592a, \u8352\u6728\u96c5\u535a, \u6e21\u8fba\u76f4\u4eba\nplayer \u83ca\u6c60\u6dbc\u4ecb is similar to : \u83ca\u6c60\u6dbc\u4ecb, \u85e4\u7530\u4e00\u4e5f, \u9234\u6728\u5927\u5730\nplayer \u9ce5\u8c37\u656c is similar to : \u9ce5\u8c37\u656c, \u4e38\u4f73\u6d69, \u5e73\u7530\u826f\u4ecb\n...\nplayer \u837b\u91ce\u8cb4\u53f8 is similar to : \u837b\u91ce\u8cb4\u53f8, \u7247\u5ca1\u6cbb\u5927, \u8352\u6ce2\u7fd4\n```\n\n\u5b66\u7fd2\u3068\u5206\u6790\u304c\u3046\u307e\u304f\u3044\u304f\u3068\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306b\u985e\u4f3c\u3057\u305f\u9078\u624b\u306e\u540d\u524d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\n## \u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b(normalize plugin version)\n\u3053\u306eexample\u3067\u306f\u6570\u5024\u30c7\u30fc\u30bf\u306e\u6b63\u898f\u5316\u3092\u884c\u3046\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u5b9f\u88c5\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30db\u30fc\u30e0\u30e9\u30f3\u3001\u6253\u70b9\u3001\u6253\u7387\u306a\u3069\u30c7\u30fc\u30bf\u306e\u7bc4\u56f2\u304c\u5927\u5e45\u306b\u7570\u306a\u308b\u30c7\u30fc\u30bf\u304c\u6df7\u3056\u3063\u3066\u3044\u308b\u305f\u3081\u3001\u6b63\u898f\u5316\u3057\u305f\u307b\u3046\u304c\u6b63\u3057\u3044\u7d50\u679c\u304c\u5f97\u3089\u308c\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n### \u6b63\u898f\u5316\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30d3\u30eb\u30c9\n\u6b63\u898f\u5316\u30d7\u30e9\u30b0\u30a4\u30f3\u306fjubatus-example/npb_similar_player/normalize_plugin\u306b\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067plugin\u306e\u30d3\u30eb\u30c9\u3092\u884c\u3063\u305f\u3042\u3068\u3001jubatus\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n```\n$ cd jubatus-example/npb_similar_player/normalize_plugin\n$ ./waf configure\n$ ./waf build\n$ cp build/src/*.so /opt/jubatus/lib/jubatus/plugin/\n```\n\n**\u6ce8\uff1a\u3053\u306ewaf\u306fpython3\u7cfb\u3067\u306f\u52d5\u304d\u307e\u305b\u3093\u3002\u3002\u3002**\n\n\n### jubatus\u30b5\u30fc\u30d0\u306e\u8d77\u52d5\n\u4eca\u5ea6\u306f`npb_similar_player.plugin.json`\u3092\u4f7f\u3063\u3066jubatus\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n$ jubarecommender -f npb_similar_player.plugin.json\n```\n\n\u30b3\u30f3\u30d5\u30a3\u30b0\u30d5\u30a1\u30a4\u30eb\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n`num_type` \u3067\u72ec\u81ea\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8aad\u307f\u8fbc\u3093\u30602\u7a2e\u985e\u306e\u7279\u5fb4\u62bd\u51fa\u65b9\u6cd5\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001`num_rules`\u3067\u3069\u306ekey\u304c\u6765\u305f\u3089\u3069\u306e\u7279\u5fb4\u62bd\u51fa\u3092\u884c\u3046\u304b\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```None:npb_similar_player.plugin.json\n{\n  \"method\": \"inverted_index\",\n  \"converter\": {\n    \"string_filter_types\": {},\n    \"string_filter_rules\": [],\n    \"num_filter_types\": {},\n    \"num_filter_rules\": [],\n    \"string_types\": {},\n    \"string_rules\": [],\n    \"num_types\": {\n      \"HOMERUN\": {\n        \"method\": \"dynamic\",\n        \"path\": \"libnormalize_num_feature.so\",\n        \"function\": \"create\",\n        \"max\": \"25.0\",\n        \"min\": \"0.0\"\n      },\n      \"BASE\": {\n        \"method\": \"dynamic\",\n        \"path\": \"libnormalize_num_feature.so\",\n        \"function\": \"create\",\n        \"max\": \"100.0\",\n        \"min\": \"0.0\"\n      }\n    },\n    \"num_rules\": [\n      {\"key\" : \"*\u7387\", \"type\" : \"num\"},\n      {\"key\" : \"\u672c\u5841\u6253\", \"type\" : \"HOMERUN\"},\n      {\"key\" : \"\u5b89\u6253\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u6253\u70b9\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u76d7\u5841\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u56db\u7403\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u4e09\u632f\", \"type\" : \"BASE\"},\n      {\"key\" : \"\u72a0\u6253\", \"type\" : \"BASE\"}\n    ]\n  },\n  \"parameter\": {}\n}\n\n```\n\n### \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5b9f\u884c\n\n```\n$ python update.py\n$ python analyze.py\nplayer \u5c71\u7530\u54f2\u4eba is similar to : \u5c71\u7530\u54f2\u4eba, \u30d0\u30eb\u30c7\u30a3\u30ea\u30b9, \u6751\u7530\u4fee\u4e00\nplayer \u4eca\u5bae\u5065\u592a is similar to : \u4eca\u5bae\u5065\u592a, \u5c71\u5d0e\u61b2\u6674, \u4f0a\u85e4\u5149\nplayer \u83ca\u6c60\u6dbc\u4ecb is similar to : \u83ca\u6c60\u6dbc\u4ecb, \u7247\u5ca1\u6cbb\u5927, \u85e4\u7530\u4e00\u4e5f\nplayer \u9ce5\u8c37\u656c is similar to : \u9ce5\u8c37\u656c, \u89d2\u4e2d\u52dd\u4e5f, \u5ca1\u5cf6\u8c6a\u90ce\n...\nplayer \u837b\u91ce\u8cb4\u53f8 is similar to : \u837b\u91ce\u8cb4\u53f8, \u5ddd\u7aef\u5d07\u7fa9, \u8352\u6ce2\u7fd4\n```\n\n\u5148\u307b\u3069\u3068\u7d50\u679c\u304c\u5909\u308f\u3063\u3066\u3044\u307e\u3059\u306d\u3002\n\n## \u3061\u3087\u3063\u3068\u3057\u305f\u89e3\u8aac\n\u5927\u4f53\u306f\u5148\u307b\u3069\u306emovielens\u3068\u540c\u69d8\u3067\u3059\u3002csv\u30d5\u30a1\u30a4\u30eb\u3092\u9806\u756a\u306b\u8aad\u307f\u8fbc\u3093\u3067Datum\u3092\u4f5c\u308a\u3001`update_row`\u3067\u5b66\u7fd2\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\n```python:update.py\n   for line in open('../dat/baseball.csv'):\n        pname, team, bave, games, pa, atbat, hit, homerun, runsbat, stolen, bob, hbp, strikeout, sacrifice, dp, slg, obp, ops, rc27, xr27 = line[:-1].split(',')\n        d = Datum({\n          \"\u30c1\u30fc\u30e0\": team,\n          \"\u6253\u7387\": float(bave),\n          \"\u8a66\u5408\u6570\": float(games),\n          \"\u6253\u5e2d\": float(pa),\n          \"\u6253\u6570\": float(atbat),\n          \"\u5b89\u6253\": float(hit),\n          \"\u672c\u5841\u6253\": float(homerun),\n          \"\u6253\u70b9\": float(runsbat),\n          \"\u76d7\u5841\": float(stolen),\n          \"\u56db\u7403\": float(bob),\n          \"\u6b7b\u7403\": float(hbp),\n          \"\u4e09\u632f\": float(strikeout),\n          \"\u72a0\u6253\": float(sacrifice),\n          \"\u4f75\u6bba\u6253\": float(dp),\n          \"\u9577\u6253\u7387\": float(slg),\n          \"\u51fa\u5841\u7387\": float(obp),\n          \"OPS\": float(ops),\n          \"RC27\": float(rc27),\n          \"XR27\": float(xr27)\n          })\n        recommender.update_row(pname, d)\n```\n\n\u5206\u6790\u3059\u308b\u3068\u304d\u306f\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u9078\u624b\u540d\u3092\u53d6\u3063\u3066\u304d\u3066\u3001`similar_row_from_id`\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\n```python:analyze.py\n    for line in codecs.open('../dat/baseball.csv', 'r', 'utf-8'):\n      pname, team, bave, games, pa, atbat, hit, homerun, runsbat, stolen, bob, hbp, strikeout, sacrifice, dp, slg, obp, ops, rc27, xr27 = line[:-1].split(',')\n      sr = recommender.similar_row_from_id(pname , 4)\n```\n\n\u7279\u5fb4\u62bd\u51fa\u65b9\u6cd5\u306fjubatus\u306e\u30b5\u30fc\u30d0\u5074\u3067\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u6b63\u898f\u5316\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u3046\u5834\u5408\u3082\u4f7f\u308f\u306a\u3044\u5834\u5408\u3082\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u5074\u306b\u306f\u5909\u66f4\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n\u8a18\u4e8b\u304c\u9577\u304f\u306a\u3063\u3066\u304d\u305f\u306e\u3067\u4e00\u65e6\u533a\u5207\u308a\u307e\u3059\u3002\n\u660e\u65e5\u3082\u50d5\u304cjubatus-example\u3092\u52d5\u304b\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\n", "tags": ["jubatus", "MachineLearning", "\u6a5f\u68b0\u5b66\u7fd2"]}