{"context": "bitcoin-cli\u306esendtoaddress\u306a\u3069\u306e\u6a19\u6e96\u9001\u91d1\u30b3\u30de\u30f3\u30c9\u3067\u7269\u8db3\u308a\u306a\u3044\u65b9\u5411\u3051\u3067\u3059\u3002\n\u7279\u5b9a\u306eUTXO\u304b\u3089\u9001\u91d1\u3057\u305f\u3044\u3068\u304d\u306b\u4fbf\u5229\u3067\u3059\u3002\n\u3086\u304f\u3086\u304f\u306f\u3001P2SH\uff08\u30b9\u30af\u30ea\u30d7\u30c8\u30cf\u30c3\u30b7\u30e5\uff09\u5b9b\u306e\u9001\u91d1\u3092\u72d9\u3044\u305f\u3044\u306e\u3067\u3059\u304c\u3001\u307e\u305a\u306f\u5b66\u7fd2\u306e\u305f\u3081\u306bP2PKH\uff08\u516c\u958b\u9375\u30cf\u30c3\u30b7\u30e5\uff09\u5b9b\u306eUTXO\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u74b0\u5883\n\nBitcoind: 0.12.1\nOpenassets-ruby: 0.4.8\nRuby: 2.2.2\n\nOpenassets-ruby\u306f\u3001bitcoin\u306eapi\u30b3\u30fc\u30eb\u306e\u305f\u3081\u306b\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u76f4\u63a5bitcoin-api\u3092\u4f7f\u3046\u65b9\u306f\u4e0d\u8981\u3067\u3059\u3002\n\u53c2\u8003\u3000\u2192\u3000http://qiita.com/osada/items/50fc76959e6730603417\n\n\u4f5c\u308a\u305f\u3044\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\nA\u3055\u3093\uff081BTC\u4fdd\u6709\uff09\u3001B\u3055\u3093\uff081BTC\u4fdd\u6709\uff09\u306e2\u540d\u304b\u3089\u3001C\u3055\u3093\u306b\u9001\u91d1\uff081.999BTC\uff09\u3059\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3002\n\u306a\u304a\u3001A\u3055\u3093\u3001B\u3055\u3093\u306e\u79d8\u5bc6\u9375\u306f\u540c\u4e00\u306e\u30de\u30b7\u30f3\u306b\u3042\u308b\u3082\u306e\u3068\u3059\u308b\u3002\n\n\u521d\u671f\u8a2d\u5b9a\n\u5fc5\u8981\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30ed\u30fc\u30c9\u3057\u3066\u3001bitcoind\u306b\u63a5\u7d9a\u3059\u308bAPI\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3002\n\u203b\u4ee5\u964d\u3001irb\u3067\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\nrequire 'bitcoin'\nrequire 'openassets'\nrequire 'pp'\n\n# testnet\u306e\u304a\u307e\u3058\u306a\u3044\nBitcoin.network = :testnet3\n\n### use zero confirmation\noa_api = OpenAssets::Api.new({:network => 'testnet',\n:provider => 'bitcoind', :cache => 'testnet.db',\n:dust_limit => 600, :default_fees => 10000,\n:min_confirmation => 0, :max_confirmation => 9999999,\n:rpc => {:user => 'osada', :password => 'password', :schema => 'http',\n:port => 18332, :host => 'localhost'}})\n\n\n\n\u9001\u91d1\u306b\u4f7f\u3046UTXO\u6307\u5b9a\n\u9001\u91d1\u306b\u4f7f\u7528\u3059\u308bUTXO\u3092\u6307\u5b9a\u3002\n# \u9001\u4fe1\u8005A\u3055\u3093\u306eUTXO # 1 BTC\nA_addr           = 'mt22rKhAonbqfvyqSW5qRFnZwi1WyYFczv'\n\n# UTXO\u3092\u6307\u5b9a\u3059\u308b\u305f\u3081\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3ID\u3068\u51fa\u529b\u90e8\uff08vout\uff09\u306e\u756a\u53f7\nA_prev_txid      = 'b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56'\nA_prev_out_index = 0\n\n\n# \u9001\u4fe1\u8005B\u3055\u3093\u306eUTXO # 1 BTC\nB_addr           = 'mhARub16mC2cP8si8PprPM8Z8UTvYdGDLr'\n\nB_prev_txid      = 'b971714785ec66f852b79f0a5d2784f73110d6ff5a331fcdd58109463ecdaaff'\nB_prev_out_index = 0\n\n\n\u53d7\u4fe1\u8005\u306e\u6307\u5b9a\n# C\u3055\u3093\u306e\u30a2\u30c9\u30ec\u30b9\nC_addr           = 'mt22rKhAonbqfvyqSW5qRFnZwi1WyYFczv'\n\n\n\u79d8\u5bc6\u9375\u306e\u5165\u624b\uff08vin\u691c\u8a3c&\u7f72\u540d\u7528\uff09\n# A\u3055\u3093\u306e\u79d8\u5bc6\u9375\uff08bitcoin-api\u304b\u3089\u5165\u624b\uff09\nA_priv_key = oa_api.provider.dumpprivkey(A_addr)\n# => \"cSkArVdNo1X9roQrCmnhZ3ifhzs7zF3cbhUHPCvjLoQXncNuBNYZ\" \n\n# Key\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5909\u63db\nA_key_obj = Bitcoin::Key.from_base58(A_priv_key)\n# => #<Bitcoin::Key:0x007ff8fda7f0a0 @key=#<OpenSSL::PKey::EC:0x007ff8fda7f050 @group=nil>, @pubkey_compressed=true> \n\n# B\u3055\u3093\u306e\u79d8\u5bc6\u9375\uff08bitcoin-api\u304b\u3089\u5165\u624b\nB_priv_key = oa_api.provider.dumpprivkey(B_addr)\n# => \"cTvh2ijnwt79QSfZKrYmDvAhByamNKCppG6PeBM38fYrgj67Qmai\" \n\n# \u540c\u69d8\u306b\u3001Key\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5909\u63db\nB_key_obj = Bitcoin::Key.from_base58(B_priv_key)\n# => #<Bitcoin::Key:0x007ff8fe9b1410 @key=#<OpenSSL::PKey::EC:0x007ff8fe9b13c0 @group=nil>, @pubkey_compressed=true> \n\n\n\u6307\u5b9a\u3057\u305fUTXO\u3092\u542b\u3080\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u5165\u624b\n# \u4e0a\u3067\u6307\u5b9a\u3057\u305ftxid\u304b\u3089\u3001hex\u5f62\u5f0f\u3067\u5165\u624b\nA_prev_tx_bin = oa_api.provider.getrawtransaction(A_prev_txid)\n# => \"01000000019c30b660df70bc4e327152e97073197621084967e1b1441a3c1641bfb2f3c867010000006a47304402207e05c734e8396c820779f292f475859342fccc3cd2f76f34efa32d02229738a402201f667162b42eb200e78d8c770cff9ce03433e01c1ae5d428a9123efe2eaa2ee7012103175ad13ad982e37c4aad5f426942d94c74ae2d4d85cc3bea13fef44c2acd3a01feffffff0200e1f505000000001976a91489216031ab89482495974a49f40a38f835d3739388ac6c0f1a1e010000001976a914deb8a31e71cf0d8af4e4270396408edb58091bcf88ac4a000000\" \n\n# hex\u5f62\u5f0f\u304b\u3089\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nA_prev_tx = Bitcoin::Protocol::Tx.new(A_prev_tx_bin.htb)\n# => #<Bitcoin::Protocol::Tx:0x007ff8fe9c98a8 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fe9c93d0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fe9c9240 @value=4799991660, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fe9c9678 @prev_out_hash=\"\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\", @prev_out_index=1, @script_sig_length=106, @script_sig=\"G0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=74, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\\x01\\x00\\x00\\x00jG0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xACl\\x0F\\x1A\\x1E\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xACJ\\x00\\x00\\x00\", @hash=\"b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56\"> \n\n# \u540c\u69d8\u306bB\u3055\u3093\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\nB_prev_tx_bin = oa_api.provider.getrawtransaction(B_prev_txid)\n# => \"01000000015eaff9fe4026c3c0b278b8bcebdb0d0d056c81c17dc37bbc628a1fd8f40881b6010000006b483045022100c5eda7ce4189f678a0498e15bc629e7088824dafdb0b8dfabf524816c4dacebb022008db321cf7652ce0b1f77e00296727075ca392dce54beb219dcd02b23964ce8a01210351c046666efaf58a6255994c66ffc2b8dcae8b0cd31f13166c39f5eceb41f783feffffff0200e1f505000000001976a914120e90f5177de616964c2cbb5d40311547d419e888ac1c2a2e12010000001976a914e310b8e8fef8506c6cfd34169f6904e6d0c9cd5688ac77000000\" \n\n# \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5316\nB_prev_tx = Bitcoin::Protocol::Tx.new(B_prev_tx_bin.htb)\n# => #<Bitcoin::Protocol::Tx:0x007ff8fb8ffe98 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fb8ff9c0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fb8ff830 @value=4599982620, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xE3\\x10\\xB8\\xE8\\xFE\\xF8Pll\\xFD4\\x16\\x9Fi\\x04\\xE6\\xD0\\xC9\\xCDV\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fb8ffc90 @prev_out_hash=\"^\\xAF\\xF9\\xFE@&\\xC3\\xC0\\xB2x\\xB8\\xBC\\xEB\\xDB\\r\\r\\x05l\\x81\\xC1}\\xC3{\\xBCb\\x8A\\x1F\\xD8\\xF4\\b\\x81\\xB6\", @prev_out_index=1, @script_sig_length=107, @script_sig=\"H0E\\x02!\\x00\\xC5\\xED\\xA7\\xCEA\\x89\\xF6x\\xA0I\\x8E\\x15\\xBCb\\x9Ep\\x88\\x82M\\xAF\\xDB\\v\\x8D\\xFA\\xBFRH\\x16\\xC4\\xDA\\xCE\\xBB\\x02 \\b\\xDB2\\x1C\\xF7e,\\xE0\\xB1\\xF7~\\x00)g'\\a\\\\\\xA3\\x92\\xDC\\xE5K\\xEB!\\x9D\\xCD\\x02\\xB29d\\xCE\\x8A\\x01!\\x03Q\\xC0Ffn\\xFA\\xF5\\x8AbU\\x99Lf\\xFF\\xC2\\xB8\\xDC\\xAE\\x8B\\f\\xD3\\x1F\\x13\\x16l9\\xF5\\xEC\\xEBA\\xF7\\x83\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=119, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01^\\xAF\\xF9\\xFE@&\\xC3\\xC0\\xB2x\\xB8\\xBC\\xEB\\xDB\\r\\r\\x05l\\x81\\xC1}\\xC3{\\xBCb\\x8A\\x1F\\xD8\\xF4\\b\\x81\\xB6\\x01\\x00\\x00\\x00kH0E\\x02!\\x00\\xC5\\xED\\xA7\\xCEA\\x89\\xF6x\\xA0I\\x8E\\x15\\xBCb\\x9Ep\\x88\\x82M\\xAF\\xDB\\v\\x8D\\xFA\\xBFRH\\x16\\xC4\\xDA\\xCE\\xBB\\x02 \\b\\xDB2\\x1C\\xF7e,\\xE0\\xB1\\xF7~\\x00)g'\\a\\\\\\xA3\\x92\\xDC\\xE5K\\xEB!\\x9D\\xCD\\x02\\xB29d\\xCE\\x8A\\x01!\\x03Q\\xC0Ffn\\xFA\\xF5\\x8AbU\\x99Lf\\xFF\\xC2\\xB8\\xDC\\xAE\\x8B\\f\\xD3\\x1F\\x13\\x16l9\\xF5\\xEC\\xEBA\\xF7\\x83\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\\x1C*.\\x12\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xE3\\x10\\xB8\\xE8\\xFE\\xF8Pll\\xFD4\\x16\\x9Fi\\x04\\xE6\\xD0\\xC9\\xCDV\\x88\\xACw\\x00\\x00\\x00\", @hash=\"b971714785ec66f852b79f0a5d2784f73110d6ff5a331fcdd58109463ecdaaff\"> \n\n\n\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u69cb\u7bc9\nBuilder\u30af\u30e9\u30b9\u3092\u4f7f\u3046\u3068\u4fbf\u5229\u3002\n# Builder\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\ntx_bldr = Bitcoin::Builder::TxBuilder.new\n# => #<Bitcoin::Builder::TxBuilder:0x007ff8fe9a19e8 @tx=#<Bitcoin::Protocol::Tx:0x007ff8fe9a19c0 @scripts=[], @out=[], @in=[], @lock_time=0, @ver=1, @enable_bitcoinconsensus=false>, @ins=[], @outs=[]> \n\n\n\u5165\u529b\u90e8\uff08vin\uff09\u4f5c\u6210\n# A\u3055\u3093\u306evin\u3002\u4ee5\u4e0b3\u3064\u306e\u30d6\u30ed\u30c3\u30af\u3092input\u30e1\u30bd\u30c3\u30c9\u306b\u5f15\u6570\u6e21\u3057\u3057\u3066\u3001\u767b\u9332\u3059\u308b\u3002\ntx_bldr.input do |i|\n  i.prev_out A_prev_tx\n  i.prev_out_index A_prev_out_index\n  i.signature_key A_key_obj\nend\n#  => [#<Bitcoin::Builder::TxInBuilder:0x007ff8fb8edbf8 @txin=#<Bitcoin::Protocol::TxIn:0x007ff8fb8edbd0 @prev_out_hash=nil, @prev_out_index=nil, @script_sig_length=0, @script_sig=\"\", @sequence=\"\\xFF\\xFF\\xFF\\xFF\">, @prev_out_hash=\"V\\xEB#\\xE7\\e5\\x8B\\xE3#\\xDE\\x1Au\\x10\\x80\\xD4~\\x81\\xAA\\x1F\\xAFI\\x19p\\xF9\\xE8\\xBF\\xBC\\xD2t\\xBA\\xBD\\xB1\", @prev_out_index=0, @prev_tx=#<Bitcoin::Protocol::Tx:0x007ff8fe9c98a8 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fe9c93d0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fe9c9240 @value=4799991660, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fe9c9678 @prev_out_hash=\"\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\", @prev_out_index=1, @script_sig_length=106, @script_sig=\"G0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=74, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\\x01\\x00\\x00\\x00jG0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xACl\\x0F\\x1A\\x1E\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xACJ\\x00\\x00\\x00\", @hash=\"b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56\", @binary_hash=\"V\\xEB#\\xE7\\e5\\x8B\\xE3#\\xDE\\x1Au\\x10\\x80\\xD4~\\x81\\xAA\\x1F\\xAFI\\x19p\\xF9\\xE8\\xBF\\xBC\\xD2t\\xBA\\xBD\\xB1\">, @prev_out_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\", @key=#<Bitcoin::Key:0x007ff8fda7f0a0 @key=#<OpenSSL::PKey::EC:0x007ff8fda7f050 @group=nil>, @pubkey_compressed=true>>] \n\n# B\u3055\u3093\u306evin\ntx_bldr.input do |i|\n  i.prev_out B_prev_tx\n  i.prev_out_index B_prev_out_index\n  i.signature_key B_key_obj\nend\n# => [#<Bitcoin::Builder::TxInBuilder:0x007ff8fb8edbf8 @txin=#<Bitcoin::Protocol::TxIn:0x007ff8fb8edbd0 @prev_out_hash=nil, @prev_out_index=nil, @script_sig_length=0, @script_sig=\"\", @sequence=\"\\xFF\\xFF\\xFF\\xFF\">, @prev_out_hash=\"V\\xEB#\\xE7\\e5\\x8B\\xE3#\\xDE\\x1Au\\x10\\x80\\xD4~\\x81\\xAA\\x1F\\xAFI\\x19p\\xF9\\xE8\\xBF\\xBC\\xD2t\\xBA\\xBD\\xB1\", @prev_out_index=0, @prev_tx=#<Bitcoin::Protocol::Tx:0x007ff8fe9c98a8 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fe9c93d0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fe9c9240 @value=4799991660, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fe9c9678 @prev_out_hash=\"\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\", @prev_out_index=1, @script_sig_length=106, @script_sig=\"G0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=74, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\\x01\\x00\\x00\\x00jG0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xACl\\x0F\\x1A\\x1E\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xACJ\\x00\\x00\\x00\", @hash=\"b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56\", @binary_hash=\"V\\xEB#\\xE7\\e5\\x8B\\xE3#\\xDE\\x1Au\\x10\\x80\\xD4~\\x81\\xAA\\x1F\\xAFI\\x19p\\xF9\\xE8\\xBF\\xBC\\xD2t\\xBA\\xBD\\xB1\">, @prev_out_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\", @key=#<Bitcoin::Key:0x007ff8fda7f0a0 @key=#<OpenSSL::PKey::EC:0x007ff8fda7f050 @group=nil>, @pubkey_compressed=true>>, #<Bitcoin::Builder::TxInBuilder:0x007ff8fda55cf0 @txin=#<Bitcoin::Protocol::TxIn:0x007ff8fda55cc8 @prev_out_hash=nil, @prev_out_index=nil, @script_sig_length=0, @script_sig=\"\", @sequence=\"\\xFF\\xFF\\xFF\\xFF\">, @prev_out_hash=\"\\xFF\\xAA\\xCD>F\\t\\x81\\xD5\\xCD\\x1F3Z\\xFF\\xD6\\x101\\xF7\\x84']\\n\\x9F\\xB7R\\xF8f\\xEC\\x85Gqq\\xB9\", @prev_out_index=0, @prev_tx=#<Bitcoin::Protocol::Tx:0x007ff8fb8ffe98 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fb8ff9c0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fb8ff830 @value=4599982620, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xE3\\x10\\xB8\\xE8\\xFE\\xF8Pll\\xFD4\\x16\\x9Fi\\x04\\xE6\\xD0\\xC9\\xCDV\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fb8ffc90 @prev_out_hash=\"^\\xAF\\xF9\\xFE@&\\xC3\\xC0\\xB2x\\xB8\\xBC\\xEB\\xDB\\r\\r\\x05l\\x81\\xC1}\\xC3{\\xBCb\\x8A\\x1F\\xD8\\xF4\\b\\x81\\xB6\", @prev_out_index=1, @script_sig_length=107, @script_sig=\"H0E\\x02!\\x00\\xC5\\xED\\xA7\\xCEA\\x89\\xF6x\\xA0I\\x8E\\x15\\xBCb\\x9Ep\\x88\\x82M\\xAF\\xDB\\v\\x8D\\xFA\\xBFRH\\x16\\xC4\\xDA\\xCE\\xBB\\x02 \\b\\xDB2\\x1C\\xF7e,\\xE0\\xB1\\xF7~\\x00)g'\\a\\\\\\xA3\\x92\\xDC\\xE5K\\xEB!\\x9D\\xCD\\x02\\xB29d\\xCE\\x8A\\x01!\\x03Q\\xC0Ffn\\xFA\\xF5\\x8AbU\\x99Lf\\xFF\\xC2\\xB8\\xDC\\xAE\\x8B\\f\\xD3\\x1F\\x13\\x16l9\\xF5\\xEC\\xEBA\\xF7\\x83\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=119, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01^\\xAF\\xF9\\xFE@&\\xC3\\xC0\\xB2x\\xB8\\xBC\\xEB\\xDB\\r\\r\\x05l\\x81\\xC1}\\xC3{\\xBCb\\x8A\\x1F\\xD8\\xF4\\b\\x81\\xB6\\x01\\x00\\x00\\x00kH0E\\x02!\\x00\\xC5\\xED\\xA7\\xCEA\\x89\\xF6x\\xA0I\\x8E\\x15\\xBCb\\x9Ep\\x88\\x82M\\xAF\\xDB\\v\\x8D\\xFA\\xBFRH\\x16\\xC4\\xDA\\xCE\\xBB\\x02 \\b\\xDB2\\x1C\\xF7e,\\xE0\\xB1\\xF7~\\x00)g'\\a\\\\\\xA3\\x92\\xDC\\xE5K\\xEB!\\x9D\\xCD\\x02\\xB29d\\xCE\\x8A\\x01!\\x03Q\\xC0Ffn\\xFA\\xF5\\x8AbU\\x99Lf\\xFF\\xC2\\xB8\\xDC\\xAE\\x8B\\f\\xD3\\x1F\\x13\\x16l9\\xF5\\xEC\\xEBA\\xF7\\x83\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\\x1C*.\\x12\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xE3\\x10\\xB8\\xE8\\xFE\\xF8Pll\\xFD4\\x16\\x9Fi\\x04\\xE6\\xD0\\xC9\\xCDV\\x88\\xACw\\x00\\x00\\x00\", @hash=\"b971714785ec66f852b79f0a5d2784f73110d6ff5a331fcdd58109463ecdaaff\", @binary_hash=\"\\xFF\\xAA\\xCD>F\\t\\x81\\xD5\\xCD\\x1F3Z\\xFF\\xD6\\x101\\xF7\\x84']\\n\\x9F\\xB7R\\xF8f\\xEC\\x85Gqq\\xB9\">, @prev_out_script=\"v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\", @key=#<Bitcoin::Key:0x007ff8fe9b1410 @key=#<OpenSSL::PKey::EC:0x007ff8fe9b13c0 @group=nil>, @pubkey_compressed=true>>] \n\n\n\u51fa\u529b\u90e8\uff08vout\uff09\u4f5c\u6210\ntx_bldr.output do |o|\n  o.value 199900000 # 1.999 BTC in satoshis\n  o.script {|s| s.recipient C_addr }\nend\n# => [#<Bitcoin::Builder::TxOutBuilder:0x007ff8fda35b80 @txout=#<Bitcoin::Protocol::TxOut:0x007ff8fda35b58 @value=199900000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\", @redeem_script=nil>>] \n\n\n\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u751f\u6210\n\u9001\u4fe1\u3059\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092Builder\u304b\u3089\u751f\u6210\u3059\u308b\n# bitcoin-api\u3092\u901a\u3057\u3066\u9001\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3001Tx\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u3059\u308b\uff0816\u9032\u6570\u8868\u793a\uff09\nserialized_tx = tx_bldr.tx.to_payload.bth\n# => \"010000000256eb23e71b358be323de1a751080d47e81aa1faf491970f9e8bfbcd274babdb1000000006a4730440220119b4da202ef11446671d0b518b9b5d269aadcff77e16c277da93d5a0d8370cd02200377b8306d44b4cd3503a5f65b0db125c8864412cdba8981d9b258e334529c0c012103ad69651a245138ca3c528e37c31d87bed1ef56e203017fbebbedb368e0a96e36ffffffffffaacd3e460981d5cd1f335affd61031f784275d0a9fb752f866ec85477171b9000000006a47304402205c473c35077ed55eab402fee296cbcc450805719b094f3b4f8d3733c681fbb2e02206ec3aa738026d0463d9b1558bbfab404226480a80a08936741c0fe97d5eab0df01210274dbebf96a69dceb21967a98ae2a21df20b7075ddf5ab3d43fe5c4f06ce0c105ffffffff01603bea0b000000001976a91489216031ab89482495974a49f40a38f835d3739388ac00000000\" \n\n# \u5ff5\u306e\u305f\u3081\u3001\u4e2d\u8eab\u3092\u898b\u308b\u3068\u30012\u3064\u306evin\u30681\u3064\u306evout\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\npp tx_bldr.tx.to_hash\n# =>\n{\"hash\"=>\"2b68e73759e1857c3771b4a138f34202d621073d88ec8542ab1e143a527a7241\",\n \"ver\"=>1,\n \"vin_sz\"=>2,\n \"vout_sz\"=>1,\n \"lock_time\"=>0,\n \"size\"=>338,\n \"in\"=>\n  [{\"prev_out\"=>\n     {\"hash\"=>\n       \"b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56\",\n      \"n\"=>0},\n    \"scriptSig\"=>\n     \"30440220119b4da202ef11446671d0b518b9b5d269aadcff77e16c277da93d5a0d8370cd02200377b8306d44b4cd3503a5f65b0db125c8864412cdba8981d9b258e334529c0c01 03ad69651a245138ca3c528e37c31d87bed1ef56e203017fbebbedb368e0a96e36\"},\n   {\"prev_out\"=>\n     {\"hash\"=>\n       \"b971714785ec66f852b79f0a5d2784f73110d6ff5a331fcdd58109463ecdaaff\",\n      \"n\"=>0},\n    \"scriptSig\"=>\n     \"304402205c473c35077ed55eab402fee296cbcc450805719b094f3b4f8d3733c681fbb2e02206ec3aa738026d0463d9b1558bbfab404226480a80a08936741c0fe97d5eab0df01 0274dbebf96a69dceb21967a98ae2a21df20b7075ddf5ab3d43fe5c4f06ce0c105\"}],\n \"out\"=>\n  [{\"value\"=>\"1.99900000\",\n    \"scriptPubKey\"=>\n     \"OP_DUP OP_HASH160 89216031ab89482495974a49f40a38f835d37393 OP_EQUALVERIFY OP_CHECKSIG\"}]}\n\n\n\u9001\u4fe1\u5b9f\u884c\nbitcoin-api\u306esendrawtransaction\u3092\u4f7f\u3063\u3066\u5b9f\u884c\u3059\u308b\noa_api.provider.sendrawtransaction(serialized_tx)\n\n\n\u65e2\u77e5\u306e\u30a8\u30e9\u30fc\n\n\u53d6\u6271\u3044\u4e0d\u53ef\u306eUTXO\n\u30de\u30a4\u30cb\u30f3\u30b0\u306b\u3088\u3063\u3066\u5f97\u3089\u308c\u305fUTXO\uff08\u4ee5\u4e0b\u306b\u4f8b\u793a\uff09\u3092\u4f7f\u3046\u6642\u306b\u306f\u3001\u7f72\u540d\u306b\u5931\u6557\u3057\u307e\u3059\u3002\n\uff08\u5b9f\u52d9\u4e0a\u307b\u3068\u3093\u3069\u767a\u751f\u3057\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u5ff5\u306e\u305f\u3081\u3002\uff09\n  \"vout\": [\n    {\n      \"value\": 50.00000000,\n      \"n\": 0,\n      \"scriptPubKey\": {\n        \"asm\": \"026fab0d63cf13d6bc57ace182033115a3acf91b6aa70ca70cd7ff753edc9f97de OP_CHECKSIG\",\n        \"hex\": \"21026fab0d63cf13d6bc57ace182033115a3acf91b6aa70ca70cd7ff753edc9f97deac\",\n        \"reqSigs\": 1,\n        \"type\": \"pubkey\",\n        \"addresses\": [\n          \"mpESE8kLTy3AjuydTCNPrfMT1m5WjucZbX\"\n        ]\n      }\n    }\n  ]\n\nscriptPubKey\u3092\u898b\u308b\u3068\u3001\u4ed6\u306e\u305d\u308c\u3068\u9055\u3044\u307e\u3059\u3002\u3088\u3063\u3066\u3001Builder\u306e\u7f72\u540d\u6a5f\u80fd\u3092\u4f7f\u3063\u305f\u6642\u306b\u3001\u7f72\u540d\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3002\ntx = tx_bldr.tx\n# =>RuntimeError: Signature error\n\n\nP2SH\n\u73fe\u5728\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u3001P2SH\u306e\u7f72\u540d\u306f\u30de\u30eb\u30c1\u30b7\u30b0\u306e\u307f\u30b5\u30dd\u30fc\u30c8\u3002\u30de\u30eb\u30c1\u30b7\u30b0\u4ee5\u5916\u306eRedeemScript\u3092\u66f8\u3044\u3066\u3044\u308b\u5834\u5408\u306f\u3001P2SH\u3068\u5224\u5b9a\u3055\u308c\u305a\u306b\u3001\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n\n\u30a8\u30e9\u30fc\nRuntimeError: Script type must be hash160, pubkey or multisig\nbuilder.rb:228:in `sig_hash_and_all_keys_exist?'\n\n\nP2SH\u306e\u7f72\u540d\u306f\u624b\u52d5\u3067\u4f5c\u308b\u5fc5\u8981\u3042\u308a\u3002\n\n\u3042\u3068\u304c\u304d\n\u81ea\u5206\u3067\u7f72\u540d\u3092\u4f5c\u308a\u305f\u3044\u3068\u304d\u3084\u3001P2SH\u3092\u4f7f\u3046\u3068\u304d\u306e\u7f72\u540d\uff08\u691c\u8a3c\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u3001scriptSig + scriptPubKey\u3067\u306a\u3044\u5834\u5408\uff09\u3092\u3057\u305f\u3044\u3068\u304d\u306f\u3001Builder\u3067\u306f\u5bfe\u5fdc\u3067\u304d\u306a\u3044\u3002\n\u6b21\u56de\uff08\uff1f\uff09\u306f\u3001\u305d\u306e\u5834\u5408\u306e\u7f72\u540d\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\uff082016-07-06\u66f4\u65b0\uff09\u3000\u6b21\u56de\u4f5c\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\nP2SH\u3068P2PKH\u5b9b\u306eUTXO\u3092\u4f7f\u3063\u305f\u9001\u91d1\u304b\u3089\u5b66\u3076Bitcoin\u306e\u7f72\u540d\u306e\u4ed5\u7d44\u307f\nhttp://qiita.com/osada/items/6d91ccff2b0cb4d34e29\n\n\u53c2\u8003\n\nP2SH\u3092\u4f7f\u3044\u3053\u306a\u3059\nhttp://qiita.com/osada/items/fe970427474f4326e9ae\n\nscriptSig\u3068scriptPubKey\u306e\u9055\u3044\nhttp://bitcoin.stackexchange.com/questions/8250/what-is-relation-between-scriptsig-and-scriptpubkey\n\n\nbitcoin-cli\u306esendtoaddress\u306a\u3069\u306e\u6a19\u6e96\u9001\u91d1\u30b3\u30de\u30f3\u30c9\u3067\u7269\u8db3\u308a\u306a\u3044\u65b9\u5411\u3051\u3067\u3059\u3002\n\u7279\u5b9a\u306eUTXO\u304b\u3089\u9001\u91d1\u3057\u305f\u3044\u3068\u304d\u306b\u4fbf\u5229\u3067\u3059\u3002\n\n\u3086\u304f\u3086\u304f\u306f\u3001P2SH\uff08\u30b9\u30af\u30ea\u30d7\u30c8\u30cf\u30c3\u30b7\u30e5\uff09\u5b9b\u306e\u9001\u91d1\u3092\u72d9\u3044\u305f\u3044\u306e\u3067\u3059\u304c\u3001\u307e\u305a\u306f\u5b66\u7fd2\u306e\u305f\u3081\u306bP2PKH\uff08\u516c\u958b\u9375\u30cf\u30c3\u30b7\u30e5\uff09\u5b9b\u306eUTXO\u3092\u4f7f\u3063\u3066\u307f\u307e\u3059\u3002\n\n# \u74b0\u5883\n* Bitcoind: 0.12.1\n* Openassets-ruby: 0.4.8\n* Ruby: 2.2.2\n\nOpenassets-ruby\u306f\u3001bitcoin\u306eapi\u30b3\u30fc\u30eb\u306e\u305f\u3081\u306b\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u76f4\u63a5bitcoin-api\u3092\u4f7f\u3046\u65b9\u306f\u4e0d\u8981\u3067\u3059\u3002\n\n\u53c2\u8003\u3000\u2192\u3000http://qiita.com/osada/items/50fc76959e6730603417\n\n# \u4f5c\u308a\u305f\u3044\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\n\nA\u3055\u3093\uff081BTC\u4fdd\u6709\uff09\u3001B\u3055\u3093\uff081BTC\u4fdd\u6709\uff09\u306e2\u540d\u304b\u3089\u3001C\u3055\u3093\u306b\u9001\u91d1\uff081.999BTC\uff09\u3059\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3002\n\u306a\u304a\u3001A\u3055\u3093\u3001B\u3055\u3093\u306e\u79d8\u5bc6\u9375\u306f\u540c\u4e00\u306e\u30de\u30b7\u30f3\u306b\u3042\u308b\u3082\u306e\u3068\u3059\u308b\u3002\n\n# \u521d\u671f\u8a2d\u5b9a\n\n\u5fc5\u8981\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30ed\u30fc\u30c9\u3057\u3066\u3001bitcoind\u306b\u63a5\u7d9a\u3059\u308bAPI\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3002\n\u203b\u4ee5\u964d\u3001irb\u3067\u5b9f\u884c\u3059\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```rb\nrequire 'bitcoin'\nrequire 'openassets'\nrequire 'pp'\n\n# testnet\u306e\u304a\u307e\u3058\u306a\u3044\nBitcoin.network = :testnet3\n\n### use zero confirmation\noa_api = OpenAssets::Api.new({:network => 'testnet',\n:provider => 'bitcoind', :cache => 'testnet.db',\n:dust_limit => 600, :default_fees => 10000,\n:min_confirmation => 0, :max_confirmation => 9999999,\n:rpc => {:user => 'osada', :password => 'password', :schema => 'http',\n:port => 18332, :host => 'localhost'}})\n\n```\n\n# \u9001\u91d1\u306b\u4f7f\u3046UTXO\u6307\u5b9a\n\n\u9001\u91d1\u306b\u4f7f\u7528\u3059\u308bUTXO\u3092\u6307\u5b9a\u3002\n\n```rb\n# \u9001\u4fe1\u8005A\u3055\u3093\u306eUTXO # 1 BTC\nA_addr           = 'mt22rKhAonbqfvyqSW5qRFnZwi1WyYFczv'\n\n# UTXO\u3092\u6307\u5b9a\u3059\u308b\u305f\u3081\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3ID\u3068\u51fa\u529b\u90e8\uff08vout\uff09\u306e\u756a\u53f7\nA_prev_txid      = 'b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56'\nA_prev_out_index = 0\n\n\n# \u9001\u4fe1\u8005B\u3055\u3093\u306eUTXO # 1 BTC\nB_addr           = 'mhARub16mC2cP8si8PprPM8Z8UTvYdGDLr'\n\nB_prev_txid      = 'b971714785ec66f852b79f0a5d2784f73110d6ff5a331fcdd58109463ecdaaff'\nB_prev_out_index = 0\n```\n\n# \u53d7\u4fe1\u8005\u306e\u6307\u5b9a\n\n```rb\n# C\u3055\u3093\u306e\u30a2\u30c9\u30ec\u30b9\nC_addr           = 'mt22rKhAonbqfvyqSW5qRFnZwi1WyYFczv'\n```\n\n# \u79d8\u5bc6\u9375\u306e\u5165\u624b\uff08vin\u691c\u8a3c&\u7f72\u540d\u7528\uff09\n\n```rb\n# A\u3055\u3093\u306e\u79d8\u5bc6\u9375\uff08bitcoin-api\u304b\u3089\u5165\u624b\uff09\nA_priv_key = oa_api.provider.dumpprivkey(A_addr)\n# => \"cSkArVdNo1X9roQrCmnhZ3ifhzs7zF3cbhUHPCvjLoQXncNuBNYZ\" \n\n# Key\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5909\u63db\nA_key_obj = Bitcoin::Key.from_base58(A_priv_key)\n# => #<Bitcoin::Key:0x007ff8fda7f0a0 @key=#<OpenSSL::PKey::EC:0x007ff8fda7f050 @group=nil>, @pubkey_compressed=true> \n\n# B\u3055\u3093\u306e\u79d8\u5bc6\u9375\uff08bitcoin-api\u304b\u3089\u5165\u624b\nB_priv_key = oa_api.provider.dumpprivkey(B_addr)\n# => \"cTvh2ijnwt79QSfZKrYmDvAhByamNKCppG6PeBM38fYrgj67Qmai\" \n\n# \u540c\u69d8\u306b\u3001Key\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5909\u63db\nB_key_obj = Bitcoin::Key.from_base58(B_priv_key)\n# => #<Bitcoin::Key:0x007ff8fe9b1410 @key=#<OpenSSL::PKey::EC:0x007ff8fe9b13c0 @group=nil>, @pubkey_compressed=true> \n```\n\n# \u6307\u5b9a\u3057\u305fUTXO\u3092\u542b\u3080\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u5165\u624b\n\n```rb\n# \u4e0a\u3067\u6307\u5b9a\u3057\u305ftxid\u304b\u3089\u3001hex\u5f62\u5f0f\u3067\u5165\u624b\nA_prev_tx_bin = oa_api.provider.getrawtransaction(A_prev_txid)\n# => \"01000000019c30b660df70bc4e327152e97073197621084967e1b1441a3c1641bfb2f3c867010000006a47304402207e05c734e8396c820779f292f475859342fccc3cd2f76f34efa32d02229738a402201f667162b42eb200e78d8c770cff9ce03433e01c1ae5d428a9123efe2eaa2ee7012103175ad13ad982e37c4aad5f426942d94c74ae2d4d85cc3bea13fef44c2acd3a01feffffff0200e1f505000000001976a91489216031ab89482495974a49f40a38f835d3739388ac6c0f1a1e010000001976a914deb8a31e71cf0d8af4e4270396408edb58091bcf88ac4a000000\" \n\n# hex\u5f62\u5f0f\u304b\u3089\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\nA_prev_tx = Bitcoin::Protocol::Tx.new(A_prev_tx_bin.htb)\n# => #<Bitcoin::Protocol::Tx:0x007ff8fe9c98a8 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fe9c93d0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fe9c9240 @value=4799991660, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fe9c9678 @prev_out_hash=\"\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\", @prev_out_index=1, @script_sig_length=106, @script_sig=\"G0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=74, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\\x01\\x00\\x00\\x00jG0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xACl\\x0F\\x1A\\x1E\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xACJ\\x00\\x00\\x00\", @hash=\"b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56\"> \n\n# \u540c\u69d8\u306bB\u3055\u3093\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\nB_prev_tx_bin = oa_api.provider.getrawtransaction(B_prev_txid)\n# => \"01000000015eaff9fe4026c3c0b278b8bcebdb0d0d056c81c17dc37bbc628a1fd8f40881b6010000006b483045022100c5eda7ce4189f678a0498e15bc629e7088824dafdb0b8dfabf524816c4dacebb022008db321cf7652ce0b1f77e00296727075ca392dce54beb219dcd02b23964ce8a01210351c046666efaf58a6255994c66ffc2b8dcae8b0cd31f13166c39f5eceb41f783feffffff0200e1f505000000001976a914120e90f5177de616964c2cbb5d40311547d419e888ac1c2a2e12010000001976a914e310b8e8fef8506c6cfd34169f6904e6d0c9cd5688ac77000000\" \n\n# \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5316\nB_prev_tx = Bitcoin::Protocol::Tx.new(B_prev_tx_bin.htb)\n# => #<Bitcoin::Protocol::Tx:0x007ff8fb8ffe98 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fb8ff9c0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fb8ff830 @value=4599982620, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xE3\\x10\\xB8\\xE8\\xFE\\xF8Pll\\xFD4\\x16\\x9Fi\\x04\\xE6\\xD0\\xC9\\xCDV\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fb8ffc90 @prev_out_hash=\"^\\xAF\\xF9\\xFE@&\\xC3\\xC0\\xB2x\\xB8\\xBC\\xEB\\xDB\\r\\r\\x05l\\x81\\xC1}\\xC3{\\xBCb\\x8A\\x1F\\xD8\\xF4\\b\\x81\\xB6\", @prev_out_index=1, @script_sig_length=107, @script_sig=\"H0E\\x02!\\x00\\xC5\\xED\\xA7\\xCEA\\x89\\xF6x\\xA0I\\x8E\\x15\\xBCb\\x9Ep\\x88\\x82M\\xAF\\xDB\\v\\x8D\\xFA\\xBFRH\\x16\\xC4\\xDA\\xCE\\xBB\\x02 \\b\\xDB2\\x1C\\xF7e,\\xE0\\xB1\\xF7~\\x00)g'\\a\\\\\\xA3\\x92\\xDC\\xE5K\\xEB!\\x9D\\xCD\\x02\\xB29d\\xCE\\x8A\\x01!\\x03Q\\xC0Ffn\\xFA\\xF5\\x8AbU\\x99Lf\\xFF\\xC2\\xB8\\xDC\\xAE\\x8B\\f\\xD3\\x1F\\x13\\x16l9\\xF5\\xEC\\xEBA\\xF7\\x83\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=119, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01^\\xAF\\xF9\\xFE@&\\xC3\\xC0\\xB2x\\xB8\\xBC\\xEB\\xDB\\r\\r\\x05l\\x81\\xC1}\\xC3{\\xBCb\\x8A\\x1F\\xD8\\xF4\\b\\x81\\xB6\\x01\\x00\\x00\\x00kH0E\\x02!\\x00\\xC5\\xED\\xA7\\xCEA\\x89\\xF6x\\xA0I\\x8E\\x15\\xBCb\\x9Ep\\x88\\x82M\\xAF\\xDB\\v\\x8D\\xFA\\xBFRH\\x16\\xC4\\xDA\\xCE\\xBB\\x02 \\b\\xDB2\\x1C\\xF7e,\\xE0\\xB1\\xF7~\\x00)g'\\a\\\\\\xA3\\x92\\xDC\\xE5K\\xEB!\\x9D\\xCD\\x02\\xB29d\\xCE\\x8A\\x01!\\x03Q\\xC0Ffn\\xFA\\xF5\\x8AbU\\x99Lf\\xFF\\xC2\\xB8\\xDC\\xAE\\x8B\\f\\xD3\\x1F\\x13\\x16l9\\xF5\\xEC\\xEBA\\xF7\\x83\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\\x1C*.\\x12\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xE3\\x10\\xB8\\xE8\\xFE\\xF8Pll\\xFD4\\x16\\x9Fi\\x04\\xE6\\xD0\\xC9\\xCDV\\x88\\xACw\\x00\\x00\\x00\", @hash=\"b971714785ec66f852b79f0a5d2784f73110d6ff5a331fcdd58109463ecdaaff\"> \n```\n\n# \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u69cb\u7bc9\n\nBuilder\u30af\u30e9\u30b9\u3092\u4f7f\u3046\u3068\u4fbf\u5229\u3002\n\n```rb\n# Builder\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\ntx_bldr = Bitcoin::Builder::TxBuilder.new\n# => #<Bitcoin::Builder::TxBuilder:0x007ff8fe9a19e8 @tx=#<Bitcoin::Protocol::Tx:0x007ff8fe9a19c0 @scripts=[], @out=[], @in=[], @lock_time=0, @ver=1, @enable_bitcoinconsensus=false>, @ins=[], @outs=[]> \n```\n\n## \u5165\u529b\u90e8\uff08vin\uff09\u4f5c\u6210\n\n```rb\n# A\u3055\u3093\u306evin\u3002\u4ee5\u4e0b3\u3064\u306e\u30d6\u30ed\u30c3\u30af\u3092input\u30e1\u30bd\u30c3\u30c9\u306b\u5f15\u6570\u6e21\u3057\u3057\u3066\u3001\u767b\u9332\u3059\u308b\u3002\ntx_bldr.input do |i|\n  i.prev_out A_prev_tx\n  i.prev_out_index A_prev_out_index\n  i.signature_key A_key_obj\nend\n#  => [#<Bitcoin::Builder::TxInBuilder:0x007ff8fb8edbf8 @txin=#<Bitcoin::Protocol::TxIn:0x007ff8fb8edbd0 @prev_out_hash=nil, @prev_out_index=nil, @script_sig_length=0, @script_sig=\"\", @sequence=\"\\xFF\\xFF\\xFF\\xFF\">, @prev_out_hash=\"V\\xEB#\\xE7\\e5\\x8B\\xE3#\\xDE\\x1Au\\x10\\x80\\xD4~\\x81\\xAA\\x1F\\xAFI\\x19p\\xF9\\xE8\\xBF\\xBC\\xD2t\\xBA\\xBD\\xB1\", @prev_out_index=0, @prev_tx=#<Bitcoin::Protocol::Tx:0x007ff8fe9c98a8 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fe9c93d0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fe9c9240 @value=4799991660, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fe9c9678 @prev_out_hash=\"\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\", @prev_out_index=1, @script_sig_length=106, @script_sig=\"G0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=74, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\\x01\\x00\\x00\\x00jG0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xACl\\x0F\\x1A\\x1E\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xACJ\\x00\\x00\\x00\", @hash=\"b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56\", @binary_hash=\"V\\xEB#\\xE7\\e5\\x8B\\xE3#\\xDE\\x1Au\\x10\\x80\\xD4~\\x81\\xAA\\x1F\\xAFI\\x19p\\xF9\\xE8\\xBF\\xBC\\xD2t\\xBA\\xBD\\xB1\">, @prev_out_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\", @key=#<Bitcoin::Key:0x007ff8fda7f0a0 @key=#<OpenSSL::PKey::EC:0x007ff8fda7f050 @group=nil>, @pubkey_compressed=true>>] \n\n# B\u3055\u3093\u306evin\ntx_bldr.input do |i|\n  i.prev_out B_prev_tx\n  i.prev_out_index B_prev_out_index\n  i.signature_key B_key_obj\nend\n# => [#<Bitcoin::Builder::TxInBuilder:0x007ff8fb8edbf8 @txin=#<Bitcoin::Protocol::TxIn:0x007ff8fb8edbd0 @prev_out_hash=nil, @prev_out_index=nil, @script_sig_length=0, @script_sig=\"\", @sequence=\"\\xFF\\xFF\\xFF\\xFF\">, @prev_out_hash=\"V\\xEB#\\xE7\\e5\\x8B\\xE3#\\xDE\\x1Au\\x10\\x80\\xD4~\\x81\\xAA\\x1F\\xAFI\\x19p\\xF9\\xE8\\xBF\\xBC\\xD2t\\xBA\\xBD\\xB1\", @prev_out_index=0, @prev_tx=#<Bitcoin::Protocol::Tx:0x007ff8fe9c98a8 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fe9c93d0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fe9c9240 @value=4799991660, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fe9c9678 @prev_out_hash=\"\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\", @prev_out_index=1, @script_sig_length=106, @script_sig=\"G0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=74, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01\\x9C0\\xB6`\\xDFp\\xBCN2qR\\xE9ps\\x19v!\\bIg\\xE1\\xB1D\\x1A<\\x16A\\xBF\\xB2\\xF3\\xC8g\\x01\\x00\\x00\\x00jG0D\\x02 ~\\x05\\xC74\\xE89l\\x82\\ay\\xF2\\x92\\xF4u\\x85\\x93B\\xFC\\xCC<\\xD2\\xF7o4\\xEF\\xA3-\\x02\\\"\\x978\\xA4\\x02 \\x1Ffqb\\xB4.\\xB2\\x00\\xE7\\x8D\\x8Cw\\f\\xFF\\x9C\\xE043\\xE0\\x1C\\x1A\\xE5\\xD4(\\xA9\\x12>\\xFE.\\xAA.\\xE7\\x01!\\x03\\x17Z\\xD1:\\xD9\\x82\\xE3|J\\xAD_BiB\\xD9Lt\\xAE-M\\x85\\xCC;\\xEA\\x13\\xFE\\xF4L*\\xCD:\\x01\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xACl\\x0F\\x1A\\x1E\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xDE\\xB8\\xA3\\x1Eq\\xCF\\r\\x8A\\xF4\\xE4'\\x03\\x96@\\x8E\\xDBX\\t\\e\\xCF\\x88\\xACJ\\x00\\x00\\x00\", @hash=\"b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56\", @binary_hash=\"V\\xEB#\\xE7\\e5\\x8B\\xE3#\\xDE\\x1Au\\x10\\x80\\xD4~\\x81\\xAA\\x1F\\xAFI\\x19p\\xF9\\xE8\\xBF\\xBC\\xD2t\\xBA\\xBD\\xB1\">, @prev_out_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\", @key=#<Bitcoin::Key:0x007ff8fda7f0a0 @key=#<OpenSSL::PKey::EC:0x007ff8fda7f050 @group=nil>, @pubkey_compressed=true>>, #<Bitcoin::Builder::TxInBuilder:0x007ff8fda55cf0 @txin=#<Bitcoin::Protocol::TxIn:0x007ff8fda55cc8 @prev_out_hash=nil, @prev_out_index=nil, @script_sig_length=0, @script_sig=\"\", @sequence=\"\\xFF\\xFF\\xFF\\xFF\">, @prev_out_hash=\"\\xFF\\xAA\\xCD>F\\t\\x81\\xD5\\xCD\\x1F3Z\\xFF\\xD6\\x101\\xF7\\x84']\\n\\x9F\\xB7R\\xF8f\\xEC\\x85Gqq\\xB9\", @prev_out_index=0, @prev_tx=#<Bitcoin::Protocol::Tx:0x007ff8fb8ffe98 @scripts=[], @out=[#<Bitcoin::Protocol::TxOut:0x007ff8fb8ff9c0 @value=100000000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\">, #<Bitcoin::Protocol::TxOut:0x007ff8fb8ff830 @value=4599982620, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\xE3\\x10\\xB8\\xE8\\xFE\\xF8Pll\\xFD4\\x16\\x9Fi\\x04\\xE6\\xD0\\xC9\\xCDV\\x88\\xAC\">], @in=[#<Bitcoin::Protocol::TxIn:0x007ff8fb8ffc90 @prev_out_hash=\"^\\xAF\\xF9\\xFE@&\\xC3\\xC0\\xB2x\\xB8\\xBC\\xEB\\xDB\\r\\r\\x05l\\x81\\xC1}\\xC3{\\xBCb\\x8A\\x1F\\xD8\\xF4\\b\\x81\\xB6\", @prev_out_index=1, @script_sig_length=107, @script_sig=\"H0E\\x02!\\x00\\xC5\\xED\\xA7\\xCEA\\x89\\xF6x\\xA0I\\x8E\\x15\\xBCb\\x9Ep\\x88\\x82M\\xAF\\xDB\\v\\x8D\\xFA\\xBFRH\\x16\\xC4\\xDA\\xCE\\xBB\\x02 \\b\\xDB2\\x1C\\xF7e,\\xE0\\xB1\\xF7~\\x00)g'\\a\\\\\\xA3\\x92\\xDC\\xE5K\\xEB!\\x9D\\xCD\\x02\\xB29d\\xCE\\x8A\\x01!\\x03Q\\xC0Ffn\\xFA\\xF5\\x8AbU\\x99Lf\\xFF\\xC2\\xB8\\xDC\\xAE\\x8B\\f\\xD3\\x1F\\x13\\x16l9\\xF5\\xEC\\xEBA\\xF7\\x83\", @sequence=\"\\xFE\\xFF\\xFF\\xFF\">], @lock_time=119, @ver=1, @enable_bitcoinconsensus=false, @payload=\"\\x01\\x00\\x00\\x00\\x01^\\xAF\\xF9\\xFE@&\\xC3\\xC0\\xB2x\\xB8\\xBC\\xEB\\xDB\\r\\r\\x05l\\x81\\xC1}\\xC3{\\xBCb\\x8A\\x1F\\xD8\\xF4\\b\\x81\\xB6\\x01\\x00\\x00\\x00kH0E\\x02!\\x00\\xC5\\xED\\xA7\\xCEA\\x89\\xF6x\\xA0I\\x8E\\x15\\xBCb\\x9Ep\\x88\\x82M\\xAF\\xDB\\v\\x8D\\xFA\\xBFRH\\x16\\xC4\\xDA\\xCE\\xBB\\x02 \\b\\xDB2\\x1C\\xF7e,\\xE0\\xB1\\xF7~\\x00)g'\\a\\\\\\xA3\\x92\\xDC\\xE5K\\xEB!\\x9D\\xCD\\x02\\xB29d\\xCE\\x8A\\x01!\\x03Q\\xC0Ffn\\xFA\\xF5\\x8AbU\\x99Lf\\xFF\\xC2\\xB8\\xDC\\xAE\\x8B\\f\\xD3\\x1F\\x13\\x16l9\\xF5\\xEC\\xEBA\\xF7\\x83\\xFE\\xFF\\xFF\\xFF\\x02\\x00\\xE1\\xF5\\x05\\x00\\x00\\x00\\x00\\x19v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\\x1C*.\\x12\\x01\\x00\\x00\\x00\\x19v\\xA9\\x14\\xE3\\x10\\xB8\\xE8\\xFE\\xF8Pll\\xFD4\\x16\\x9Fi\\x04\\xE6\\xD0\\xC9\\xCDV\\x88\\xACw\\x00\\x00\\x00\", @hash=\"b971714785ec66f852b79f0a5d2784f73110d6ff5a331fcdd58109463ecdaaff\", @binary_hash=\"\\xFF\\xAA\\xCD>F\\t\\x81\\xD5\\xCD\\x1F3Z\\xFF\\xD6\\x101\\xF7\\x84']\\n\\x9F\\xB7R\\xF8f\\xEC\\x85Gqq\\xB9\">, @prev_out_script=\"v\\xA9\\x14\\x12\\x0E\\x90\\xF5\\x17}\\xE6\\x16\\x96L,\\xBB]@1\\x15G\\xD4\\x19\\xE8\\x88\\xAC\", @key=#<Bitcoin::Key:0x007ff8fe9b1410 @key=#<OpenSSL::PKey::EC:0x007ff8fe9b13c0 @group=nil>, @pubkey_compressed=true>>] \n```\n\n## \u51fa\u529b\u90e8\uff08vout\uff09\u4f5c\u6210\n```rb\ntx_bldr.output do |o|\n  o.value 199900000 # 1.999 BTC in satoshis\n  o.script {|s| s.recipient C_addr }\nend\n# => [#<Bitcoin::Builder::TxOutBuilder:0x007ff8fda35b80 @txout=#<Bitcoin::Protocol::TxOut:0x007ff8fda35b58 @value=199900000, @pk_script_length=25, @pk_script=\"v\\xA9\\x14\\x89!`1\\xAB\\x89H$\\x95\\x97JI\\xF4\\n8\\xF85\\xD3s\\x93\\x88\\xAC\", @redeem_script=nil>>] \n```\n\n# \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u751f\u6210\n\n\u9001\u4fe1\u3059\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092Builder\u304b\u3089\u751f\u6210\u3059\u308b\n\n```rb\n# bitcoin-api\u3092\u901a\u3057\u3066\u9001\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3001Tx\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u3059\u308b\uff0816\u9032\u6570\u8868\u793a\uff09\nserialized_tx = tx_bldr.tx.to_payload.bth\n# => \"010000000256eb23e71b358be323de1a751080d47e81aa1faf491970f9e8bfbcd274babdb1000000006a4730440220119b4da202ef11446671d0b518b9b5d269aadcff77e16c277da93d5a0d8370cd02200377b8306d44b4cd3503a5f65b0db125c8864412cdba8981d9b258e334529c0c012103ad69651a245138ca3c528e37c31d87bed1ef56e203017fbebbedb368e0a96e36ffffffffffaacd3e460981d5cd1f335affd61031f784275d0a9fb752f866ec85477171b9000000006a47304402205c473c35077ed55eab402fee296cbcc450805719b094f3b4f8d3733c681fbb2e02206ec3aa738026d0463d9b1558bbfab404226480a80a08936741c0fe97d5eab0df01210274dbebf96a69dceb21967a98ae2a21df20b7075ddf5ab3d43fe5c4f06ce0c105ffffffff01603bea0b000000001976a91489216031ab89482495974a49f40a38f835d3739388ac00000000\" \n\n# \u5ff5\u306e\u305f\u3081\u3001\u4e2d\u8eab\u3092\u898b\u308b\u3068\u30012\u3064\u306evin\u30681\u3064\u306evout\u304c\u5b58\u5728\u3059\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\npp tx_bldr.tx.to_hash\n# =>\n{\"hash\"=>\"2b68e73759e1857c3771b4a138f34202d621073d88ec8542ab1e143a527a7241\",\n \"ver\"=>1,\n \"vin_sz\"=>2,\n \"vout_sz\"=>1,\n \"lock_time\"=>0,\n \"size\"=>338,\n \"in\"=>\n  [{\"prev_out\"=>\n     {\"hash\"=>\n       \"b1bdba74d2bcbfe8f9701949af1faa817ed48010751ade23e38b351be723eb56\",\n      \"n\"=>0},\n    \"scriptSig\"=>\n     \"30440220119b4da202ef11446671d0b518b9b5d269aadcff77e16c277da93d5a0d8370cd02200377b8306d44b4cd3503a5f65b0db125c8864412cdba8981d9b258e334529c0c01 03ad69651a245138ca3c528e37c31d87bed1ef56e203017fbebbedb368e0a96e36\"},\n   {\"prev_out\"=>\n     {\"hash\"=>\n       \"b971714785ec66f852b79f0a5d2784f73110d6ff5a331fcdd58109463ecdaaff\",\n      \"n\"=>0},\n    \"scriptSig\"=>\n     \"304402205c473c35077ed55eab402fee296cbcc450805719b094f3b4f8d3733c681fbb2e02206ec3aa738026d0463d9b1558bbfab404226480a80a08936741c0fe97d5eab0df01 0274dbebf96a69dceb21967a98ae2a21df20b7075ddf5ab3d43fe5c4f06ce0c105\"}],\n \"out\"=>\n  [{\"value\"=>\"1.99900000\",\n    \"scriptPubKey\"=>\n     \"OP_DUP OP_HASH160 89216031ab89482495974a49f40a38f835d37393 OP_EQUALVERIFY OP_CHECKSIG\"}]}\n```\n\n# \u9001\u4fe1\u5b9f\u884c\nbitcoin-api\u306esendrawtransaction\u3092\u4f7f\u3063\u3066\u5b9f\u884c\u3059\u308b\n\n```rb\noa_api.provider.sendrawtransaction(serialized_tx)\n```\n\n# \u65e2\u77e5\u306e\u30a8\u30e9\u30fc\n## \u53d6\u6271\u3044\u4e0d\u53ef\u306eUTXO\n\u30de\u30a4\u30cb\u30f3\u30b0\u306b\u3088\u3063\u3066\u5f97\u3089\u308c\u305fUTXO\uff08\u4ee5\u4e0b\u306b\u4f8b\u793a\uff09\u3092\u4f7f\u3046\u6642\u306b\u306f\u3001\u7f72\u540d\u306b\u5931\u6557\u3057\u307e\u3059\u3002\n\uff08\u5b9f\u52d9\u4e0a\u307b\u3068\u3093\u3069\u767a\u751f\u3057\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u5ff5\u306e\u305f\u3081\u3002\uff09\n\n```\n  \"vout\": [\n    {\n      \"value\": 50.00000000,\n      \"n\": 0,\n      \"scriptPubKey\": {\n        \"asm\": \"026fab0d63cf13d6bc57ace182033115a3acf91b6aa70ca70cd7ff753edc9f97de OP_CHECKSIG\",\n        \"hex\": \"21026fab0d63cf13d6bc57ace182033115a3acf91b6aa70ca70cd7ff753edc9f97deac\",\n        \"reqSigs\": 1,\n        \"type\": \"pubkey\",\n        \"addresses\": [\n          \"mpESE8kLTy3AjuydTCNPrfMT1m5WjucZbX\"\n        ]\n      }\n    }\n  ]\n```\n\nscriptPubKey\u3092\u898b\u308b\u3068\u3001\u4ed6\u306e\u305d\u308c\u3068\u9055\u3044\u307e\u3059\u3002\u3088\u3063\u3066\u3001Builder\u306e\u7f72\u540d\u6a5f\u80fd\u3092\u4f7f\u3063\u305f\u6642\u306b\u3001\u7f72\u540d\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3002\n\n```rb\ntx = tx_bldr.tx\n# =>RuntimeError: Signature error\n```\n\n## P2SH\n\n\u73fe\u5728\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u3001P2SH\u306e\u7f72\u540d\u306f\u30de\u30eb\u30c1\u30b7\u30b0\u306e\u307f\u30b5\u30dd\u30fc\u30c8\u3002\u30de\u30eb\u30c1\u30b7\u30b0\u4ee5\u5916\u306eRedeemScript\u3092\u66f8\u3044\u3066\u3044\u308b\u5834\u5408\u306f\u3001P2SH\u3068\u5224\u5b9a\u3055\u308c\u305a\u306b\u3001\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n\n```text:\u30a8\u30e9\u30fc\nRuntimeError: Script type must be hash160, pubkey or multisig\nbuilder.rb:228:in `sig_hash_and_all_keys_exist?'\n```\n\nP2SH\u306e\u7f72\u540d\u306f\u624b\u52d5\u3067\u4f5c\u308b\u5fc5\u8981\u3042\u308a\u3002\n\n# \u3042\u3068\u304c\u304d\n\n\u81ea\u5206\u3067\u7f72\u540d\u3092\u4f5c\u308a\u305f\u3044\u3068\u304d\u3084\u3001P2SH\u3092\u4f7f\u3046\u3068\u304d\u306e\u7f72\u540d\uff08\u691c\u8a3c\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u3001scriptSig + scriptPubKey\u3067\u306a\u3044\u5834\u5408\uff09\u3092\u3057\u305f\u3044\u3068\u304d\u306f\u3001Builder\u3067\u306f\u5bfe\u5fdc\u3067\u304d\u306a\u3044\u3002\n\n\u6b21\u56de\uff08\uff1f\uff09\u306f\u3001\u305d\u306e\u5834\u5408\u306e\u7f72\u540d\u65b9\u6cd5\u3092\u3054\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n\uff082016-07-06\u66f4\u65b0\uff09\u3000\u6b21\u56de\u4f5c\u3092\u66f8\u304d\u307e\u3057\u305f\u3002\nP2SH\u3068P2PKH\u5b9b\u306eUTXO\u3092\u4f7f\u3063\u305f\u9001\u91d1\u304b\u3089\u5b66\u3076Bitcoin\u306e\u7f72\u540d\u306e\u4ed5\u7d44\u307f\nhttp://qiita.com/osada/items/6d91ccff2b0cb4d34e29\n\n# \u53c2\u8003\n* P2SH\u3092\u4f7f\u3044\u3053\u306a\u3059\nhttp://qiita.com/osada/items/fe970427474f4326e9ae\n* scriptSig\u3068scriptPubKey\u306e\u9055\u3044\nhttp://bitcoin.stackexchange.com/questions/8250/what-is-relation-between-scriptsig-and-scriptpubkey\n", "tags": ["Ruby", "Bitcoin", "OpenAssets"]}