{"context": " More than 1 year has passed since last update.Stan\u306e\u7df4\u7fd2\u304c\u3066\u3089\u3001\u304a\u306a\u3058\u307f\u306eiris\u30c7\u30fc\u30bf\u3067\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u63a8\u5b9a\u3057\u3066\u307f\u305f\u3002\n\u4eca\u56de\u4f5c\u6210\u3057\u305f\u30e2\u30c7\u30eb\u306firis\u306eSpecies\u3092\u4e88\u6e2c\u3059\u308b\u591a\u30af\u30e9\u30b9\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\u3002\u56de\u5e30\u4fc2\u6570\u306e\u4e8b\u524d\u5206\u5e03\u306f\u5e73\u57470\u306e\u6b63\u898f\u5206\u5e03\u3068\u3057\u305f\uff08\u3053\u3046\u3059\u308b\u3068L2\u6b63\u5247\u5316\u3068\u540c\u7b49\u306e\u52b9\u679c\u304c\u5f97\u3089\u308c\u308b\uff09\u3002\n\u306a\u304a\u3001\u6b63\u898f\u5206\u5e03\u306e\u5206\u6563\u306e\u4e8b\u524d\u5206\u5e03\u306b\u306f\u534a\u30b3\u30fc\u30b7\u30fc\u5206\u5e03\u3092\u4f7f\u3046\u3002\u30b5\u30f3\u30d7\u30eb\u6570\u304c\u5c11\u306a\u3044\u3068\u304d\u306f\u9006\u30ac\u30f3\u30de\u5206\u5e03\u3092\u7121\u60c5\u5831\u4e8b\u524d\u5206\u5e03\u3068\u3057\u3066\u4f7f\u3046\u3068\u4e0d\u90fd\u5408\u304c\u3042\u308b\u3089\u3057\u3044\u306e\u3067\u3002\uff08\u3067\u3082iris\u306e\u30b5\u30f3\u30d7\u30eb\u6570\u306f150\u306a\u306e\u3067\u9006\u30ac\u30f3\u30de\u5206\u5e03\u306e\u307e\u307e\u3067\u3082\u5927\u4e08\u592b\u304b\u3082\uff1f\uff09 \u8ffd\u8a18: Gelman\u306e\u8ad6\u6587\u3092\u30c1\u30e9\u898b\u3057\u305f\u3089\u9006\u30ac\u30f3\u30de\u5206\u5e03\u3092\u4f7f\u3063\u3066\u554f\u984c\u306b\u306a\u308b\u30b1\u30fc\u30b9\u306f\u300c\u30b0\u30eb\u30fc\u30d7\u30ec\u30d9\u30eb\u306e\u52b9\u679c\u3092\u30e2\u30c7\u30eb\u5316\u3057\u3066\u3044\u3066\u3001\u30b0\u30eb\u30fc\u30d7\u6570\u304c\u5c11\u306a\u3044\u3042\u308b\u3044\u306f\u30b0\u30eb\u30fc\u30d7\u30ec\u30d9\u30eb\u306e\u5206\u6563\u304c\u30bc\u30ed\u306b\u8fd1\u3044\u5834\u5408\u300d\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u4eca\u56de\u306e\u30b1\u30fc\u30b9\u306f\u5f53\u3066\u306f\u307e\u3089\u306a\u3044\u304b\u3082\uff08\u5225\u306b\u30b3\u30fc\u30b7\u30fc\u5206\u5e03\u3092\u4f7f\u3063\u3066\u3082\u554f\u984c\u306f\u7121\u3044\u307f\u305f\u3044\u3060\u3051\u3069\uff09\u3002\n\u53c2\u8003: http://www.slideshare.net/KojiKosugi/cauchy20150726\n\u4ee5\u4e0b\u30b3\u30fc\u30c9\u3002\nrequire(rstan) \n\ny <- as.integer(iris[,5])\nx <- scale(iris[,-5])\n\ndata.list <- \n  list(\n    N = NROW(x), \n    M = NCOL(x), \n    K = 3, \n    y = y, \n    x = x) \n\nstan.code <- \"\ndata { \n  int<lower=0> N; \n  int<lower=0> M; \n  int<lower=0> K;\n  int<lower=1,upper=3> y[N]; \n  matrix[N,M] x; \n} \nparameters { \n  real<lower=0> sigma;\n  vector[K] alpha; \n  matrix[K,M] beta; \n} \nmodel { \n  sigma ~ cauchy(0, 1);\n  for (i in 1:K) {\n    alpha[i] ~ normal(0, sigma); \n  }\n  for (d in 1:M) {\n    for (i in 1:K) {\n      beta[i,d] ~ normal(0, sigma); \n    }\n  }\n  for (n in 1:N) {\n    y[n] ~ categorical(softmax(alpha + beta * x[n]')); \n  }\n} \n\"\n\nstan.fit <- \n  stan(\n    model_code = stan.code, \n    data = data.list, \n    iter = 1000, \n    thin = 10,\n    chains = 3)\n\nprint(stan.fit)\n\n\u5b9f\u884c\u7d50\u679c\u3002\n> print(stan.fit)\nInference for Stan model: 45dc1db582ed31d42ac02f63763415d9.\n3 chains, each with iter=1000; warmup=500; thin=10; \npost-warmup draws per chain=50, total post-warmup draws=150.\n\n            mean se_mean    sd   2.5%    25%    50%    75%  97.5% n_eff Rhat\nsigma       8.97    0.41  4.45   3.87   5.79   7.74  10.61  19.80   120 0.99\nalpha[1]   -3.01    0.81  9.98 -24.72  -6.89  -1.33   2.29   9.66   150 0.98\nalpha[2]    8.49    0.61  7.48  -5.76   4.50   8.40  12.56  22.48   150 1.00\nalpha[3]   -6.67    0.66  8.13 -27.79  -9.76  -5.04  -1.95   6.53   150 1.00\nbeta[1,1]  -3.71    0.69  8.44 -23.82  -8.17  -3.68   1.07  10.45   150 1.01\nbeta[1,2]   5.26    0.65  8.01  -7.40   0.91   4.13   8.77  21.17   150 0.99\nbeta[1,3]  -9.71    0.83 10.18 -41.41 -13.96  -8.47  -3.49   5.19   150 0.99\nbeta[1,4]  -9.22    1.18 10.99 -37.98 -13.46  -8.59  -2.95   8.88    86 1.00\nbeta[2,1]   2.94    0.53  6.36  -9.38  -0.09   2.51   6.31  15.99   143 0.98\nbeta[2,2]  -1.54    0.51  6.20 -14.04  -4.54  -2.06   1.23  12.04   150 1.00\nbeta[2,3]  -1.29    0.45  5.18 -10.75  -4.87  -1.43   1.76   8.60   134 1.00\nbeta[2,4]  -0.66    0.53  6.50 -14.73  -3.72  -0.65   1.84  13.32   150 1.00\nbeta[3,1]   1.02    0.51  6.10 -12.27  -1.86   0.66   4.72  14.01   145 0.98\nbeta[3,2]  -3.58    0.52  6.34 -17.62  -6.64  -3.81  -0.08  10.62   150 1.00\nbeta[3,3]  11.49    0.59  6.91   0.37   6.66  10.36  15.54  26.33   138 0.99\nbeta[3,4]  10.38    0.64  7.83  -3.65   5.64   9.51  14.63  26.99   150 0.99\nlp__      -51.00    0.58  6.13 -63.69 -54.32 -50.18 -46.85 -40.07   112 0.99\n\nSamples were drawn using NUTS(diag_e) at Sun Jan 31 10:59:40 2016.\nFor each parameter, n_eff is a crude measure of effective sample size,\nand Rhat is the potential scale reduction factor on split chains (at \nconvergence, Rhat=1).\n\n\u4e0a\u8a18\u30b3\u30fc\u30c9\u306f\u3001\u56de\u5e30\u4fc2\u6570\u306e\u4e8b\u524d\u5206\u5e03\u306b\u5e73\u57470\u306e\u6b63\u898f\u5206\u5e03\u3092\u7f6e\u3044\u3066\u3044\u308b\u306e\u3067\u3001\u5b9f\u8cea\u7684\u306bL2\u6b63\u5247\u5316\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\u3068\u540c\u7b49\u306e\u3053\u3068\u3092\u3057\u3066\u304f\u308c\u308b\u3002\u3057\u304b\u3082\u51c4\u3044\u306e\u306f\u3001\u666e\u901aL2\u6b63\u5247\u5316\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\u3092\u4f7f\u3046\u3068\u304d\u306f\u6b63\u5247\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u3092cross-validation\u3068\u304b\u3067\u6c7a\u3081\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u3060\u3051\u308c\u3069\u3001\u4e0a\u8a18\u30b3\u30fc\u30c9\u3067\u306f\u6b63\u898f\u5206\u5e03\u306e\u5206\u6563\uff08\u2252\u6b63\u5247\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\uff09\u306e\u4e8b\u524d\u5206\u5e03\u306b\u7121\u60c5\u5831\u4e8b\u524d\u5206\u5e03\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u6b63\u5247\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u307e\u3067\u542b\u3081\u3066\u4e00\u5ea6\u306b\u30c7\u30fc\u30bf\u304b\u3089\u63a8\u5b9a\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3060\u3002\u3053\u308c\u304c\u968e\u5c64\u30d9\u30a4\u30ba\u306e\u529b\u3060\uff01\u3059\u3052\u30fc\uff01\u03a3(\uff9f\u0434\uff9f;)\n\u3067\u3082\u307e\u3041\u3001\u3053\u306e\u7a0b\u5ea6\u3060\u3063\u305f\u3089\u666e\u901a\u306bglmnet\u3068\u304b\u4f7f\u3063\u305f\u307b\u3046\u304c\u3044\u3044\u304b\u3082\u3002MCMC\u306f\u9045\u3044\u3057\u306d\u2026\u3002\nStan\u306e\u7df4\u7fd2\u304c\u3066\u3089\u3001\u304a\u306a\u3058\u307f\u306eiris\u30c7\u30fc\u30bf\u3067\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u63a8\u5b9a\u3057\u3066\u307f\u305f\u3002\n\u4eca\u56de\u4f5c\u6210\u3057\u305f\u30e2\u30c7\u30eb\u306firis\u306eSpecies\u3092\u4e88\u6e2c\u3059\u308b\u591a\u30af\u30e9\u30b9\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\u3002\u56de\u5e30\u4fc2\u6570\u306e\u4e8b\u524d\u5206\u5e03\u306f\u5e73\u57470\u306e\u6b63\u898f\u5206\u5e03\u3068\u3057\u305f\uff08\u3053\u3046\u3059\u308b\u3068L2\u6b63\u5247\u5316\u3068\u540c\u7b49\u306e\u52b9\u679c\u304c\u5f97\u3089\u308c\u308b\uff09\u3002\n\u306a\u304a\u3001\u6b63\u898f\u5206\u5e03\u306e\u5206\u6563\u306e\u4e8b\u524d\u5206\u5e03\u306b\u306f\u534a\u30b3\u30fc\u30b7\u30fc\u5206\u5e03\u3092\u4f7f\u3046\u3002~~\u30b5\u30f3\u30d7\u30eb\u6570\u304c\u5c11\u306a\u3044\u3068\u304d\u306f\u9006\u30ac\u30f3\u30de\u5206\u5e03\u3092\u7121\u60c5\u5831\u4e8b\u524d\u5206\u5e03\u3068\u3057\u3066\u4f7f\u3046\u3068\u4e0d\u90fd\u5408\u304c\u3042\u308b\u3089\u3057\u3044\u306e\u3067\u3002\uff08\u3067\u3082iris\u306e\u30b5\u30f3\u30d7\u30eb\u6570\u306f150\u306a\u306e\u3067\u9006\u30ac\u30f3\u30de\u5206\u5e03\u306e\u307e\u307e\u3067\u3082\u5927\u4e08\u592b\u304b\u3082\uff1f\uff09~~ \u8ffd\u8a18: [Gelman\u306e\u8ad6\u6587](http://projecteuclid.org/euclid.ba/1340371048)\u3092\u30c1\u30e9\u898b\u3057\u305f\u3089\u9006\u30ac\u30f3\u30de\u5206\u5e03\u3092\u4f7f\u3063\u3066\u554f\u984c\u306b\u306a\u308b\u30b1\u30fc\u30b9\u306f\u300c\u30b0\u30eb\u30fc\u30d7\u30ec\u30d9\u30eb\u306e\u52b9\u679c\u3092\u30e2\u30c7\u30eb\u5316\u3057\u3066\u3044\u3066\u3001\u30b0\u30eb\u30fc\u30d7\u6570\u304c\u5c11\u306a\u3044\u3042\u308b\u3044\u306f\u30b0\u30eb\u30fc\u30d7\u30ec\u30d9\u30eb\u306e\u5206\u6563\u304c\u30bc\u30ed\u306b\u8fd1\u3044\u5834\u5408\u300d\u307f\u305f\u3044\u306a\u306e\u3067\u3001\u4eca\u56de\u306e\u30b1\u30fc\u30b9\u306f\u5f53\u3066\u306f\u307e\u3089\u306a\u3044\u304b\u3082\uff08\u5225\u306b\u30b3\u30fc\u30b7\u30fc\u5206\u5e03\u3092\u4f7f\u3063\u3066\u3082\u554f\u984c\u306f\u7121\u3044\u307f\u305f\u3044\u3060\u3051\u3069\uff09\u3002\n\u53c2\u8003: http://www.slideshare.net/KojiKosugi/cauchy20150726\n\u4ee5\u4e0b\u30b3\u30fc\u30c9\u3002\n\n```r\nrequire(rstan) \n\ny <- as.integer(iris[,5])\nx <- scale(iris[,-5])\n\ndata.list <- \n  list(\n    N = NROW(x), \n    M = NCOL(x), \n    K = 3, \n    y = y, \n    x = x) \n\nstan.code <- \"\ndata { \n  int<lower=0> N; \n  int<lower=0> M; \n  int<lower=0> K;\n  int<lower=1,upper=3> y[N]; \n  matrix[N,M] x; \n} \nparameters { \n  real<lower=0> sigma;\n  vector[K] alpha; \n  matrix[K,M] beta; \n} \nmodel { \n  sigma ~ cauchy(0, 1);\n  for (i in 1:K) {\n    alpha[i] ~ normal(0, sigma); \n  }\n  for (d in 1:M) {\n    for (i in 1:K) {\n      beta[i,d] ~ normal(0, sigma); \n    }\n  }\n  for (n in 1:N) {\n    y[n] ~ categorical(softmax(alpha + beta * x[n]')); \n  }\n} \n\"\n\nstan.fit <- \n  stan(\n    model_code = stan.code, \n    data = data.list, \n    iter = 1000, \n    thin = 10,\n    chains = 3)\n\nprint(stan.fit)\n```\n\u5b9f\u884c\u7d50\u679c\u3002\n\n```r\n> print(stan.fit)\nInference for Stan model: 45dc1db582ed31d42ac02f63763415d9.\n3 chains, each with iter=1000; warmup=500; thin=10; \npost-warmup draws per chain=50, total post-warmup draws=150.\n\n            mean se_mean    sd   2.5%    25%    50%    75%  97.5% n_eff Rhat\nsigma       8.97    0.41  4.45   3.87   5.79   7.74  10.61  19.80   120 0.99\nalpha[1]   -3.01    0.81  9.98 -24.72  -6.89  -1.33   2.29   9.66   150 0.98\nalpha[2]    8.49    0.61  7.48  -5.76   4.50   8.40  12.56  22.48   150 1.00\nalpha[3]   -6.67    0.66  8.13 -27.79  -9.76  -5.04  -1.95   6.53   150 1.00\nbeta[1,1]  -3.71    0.69  8.44 -23.82  -8.17  -3.68   1.07  10.45   150 1.01\nbeta[1,2]   5.26    0.65  8.01  -7.40   0.91   4.13   8.77  21.17   150 0.99\nbeta[1,3]  -9.71    0.83 10.18 -41.41 -13.96  -8.47  -3.49   5.19   150 0.99\nbeta[1,4]  -9.22    1.18 10.99 -37.98 -13.46  -8.59  -2.95   8.88    86 1.00\nbeta[2,1]   2.94    0.53  6.36  -9.38  -0.09   2.51   6.31  15.99   143 0.98\nbeta[2,2]  -1.54    0.51  6.20 -14.04  -4.54  -2.06   1.23  12.04   150 1.00\nbeta[2,3]  -1.29    0.45  5.18 -10.75  -4.87  -1.43   1.76   8.60   134 1.00\nbeta[2,4]  -0.66    0.53  6.50 -14.73  -3.72  -0.65   1.84  13.32   150 1.00\nbeta[3,1]   1.02    0.51  6.10 -12.27  -1.86   0.66   4.72  14.01   145 0.98\nbeta[3,2]  -3.58    0.52  6.34 -17.62  -6.64  -3.81  -0.08  10.62   150 1.00\nbeta[3,3]  11.49    0.59  6.91   0.37   6.66  10.36  15.54  26.33   138 0.99\nbeta[3,4]  10.38    0.64  7.83  -3.65   5.64   9.51  14.63  26.99   150 0.99\nlp__      -51.00    0.58  6.13 -63.69 -54.32 -50.18 -46.85 -40.07   112 0.99\n\nSamples were drawn using NUTS(diag_e) at Sun Jan 31 10:59:40 2016.\nFor each parameter, n_eff is a crude measure of effective sample size,\nand Rhat is the potential scale reduction factor on split chains (at \nconvergence, Rhat=1).\n```\n\u4e0a\u8a18\u30b3\u30fc\u30c9\u306f\u3001\u56de\u5e30\u4fc2\u6570\u306e\u4e8b\u524d\u5206\u5e03\u306b\u5e73\u57470\u306e\u6b63\u898f\u5206\u5e03\u3092\u7f6e\u3044\u3066\u3044\u308b\u306e\u3067\u3001\u5b9f\u8cea\u7684\u306bL2\u6b63\u5247\u5316\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\u3068\u540c\u7b49\u306e\u3053\u3068\u3092\u3057\u3066\u304f\u308c\u308b\u3002\u3057\u304b\u3082\u51c4\u3044\u306e\u306f\u3001\u666e\u901aL2\u6b63\u5247\u5316\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\u3092\u4f7f\u3046\u3068\u304d\u306f\u6b63\u5247\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u3092cross-validation\u3068\u304b\u3067\u6c7a\u3081\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306e\u3060\u3051\u308c\u3069\u3001\u4e0a\u8a18\u30b3\u30fc\u30c9\u3067\u306f\u6b63\u898f\u5206\u5e03\u306e\u5206\u6563\uff08\u2252\u6b63\u5247\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\uff09\u306e\u4e8b\u524d\u5206\u5e03\u306b\u7121\u60c5\u5831\u4e8b\u524d\u5206\u5e03\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u6b63\u5247\u5316\u30d1\u30e9\u30e1\u30fc\u30bf\u307e\u3067\u542b\u3081\u3066\u4e00\u5ea6\u306b\u30c7\u30fc\u30bf\u304b\u3089\u63a8\u5b9a\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3060\u3002\u3053\u308c\u304c\u968e\u5c64\u30d9\u30a4\u30ba\u306e\u529b\u3060\uff01\u3059\u3052\u30fc\uff01\u03a3(\uff9f\u0434\uff9f;)\n\u3067\u3082\u307e\u3041\u3001\u3053\u306e\u7a0b\u5ea6\u3060\u3063\u305f\u3089\u666e\u901a\u306bglmnet\u3068\u304b\u4f7f\u3063\u305f\u307b\u3046\u304c\u3044\u3044\u304b\u3082\u3002MCMC\u306f\u9045\u3044\u3057\u306d\u2026\u3002\n", "tags": ["R", "Stan", "RStan"]}