{"tags": ["MySQL", "mariadb"], "context": " More than 1 year has passed since last update.mysql(MariaDB)\u306b\u306f\u3001\u30ec\u30f3\u30b8\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3063\u3066\u3082\u306e\u304c\u3042\u308a\u307e\u3057\u3066\u3001\u3046\u30fc\u306a\u3093\u3067\u3057\u3087\uff1f\u3042\u308b\u898f\u5247\u306b\u3057\u304c\u3063\u305f\u30c7\u30fc\u30bf\u3092\u304a\u306e\u304a\u306e\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306b\u632f\u308a\u5206\u3051\u3066\u304f\u308c\u308b\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u7684\u306a\u3082\u306e\u3067\u3059\u3002\n-- \u30c7\u30fc\u30bf\u9818\u57df\u304c\u5206\u5272\u3055\u308c\u308b\u305f\u3081\u3001\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3059\u308b\u3053\u3068\u306b\u3088\u308b\u6027\u80fd\u4e0a\u306e\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u306e\u767a\u751f\u3092\u6291\u3048\u3089\u308c\u308b\n-- MyISAM\u306a\u3069\u3001\u30c6\u30fc\u30d6\u30eb\u30b5\u30a4\u30ba\u306b\u4e0a\u9650\u304c\u3042\u308b\u5834\u5408\u3067\u3082\u305d\u308c\u4ee5\u4e0a\u306e\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u306b\u306a\u308b\n\u3068\u3044\u3063\u305f\u70b9\u3067\u3059\u3001\u5c11\u306a\u3044\u30c7\u30fc\u30bf\u3067\u3059\u3068\u3053\u308c\u3068\u3044\u3063\u305f\u5229\u70b9\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u6570\u767e\u4e07\u898f\u6a21\u30c7\u30fc\u30bf\u3067\u3059\u3068\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u6761\u4ef6\u306b\u30de\u30c3\u30c1\u3059\u308c\u3070\u3001\u731b\u70c8\u306b\u30af\u30a8\u30ea\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u5411\u4e0a\u3057\u307e\u3059\uff01\uff01\n\n\u30b5\u30f3\u30d7\u30eb\u30c6\u30fc\u30d6\u30eb\n\u3053\u3093\u306a\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u975e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u30c6\u30fc\u30d6\u30eb\u3067\u3059\u306d\u3002\u3064\u307e\u308a\u666e\u901a\u306e\u30c6\u30fc\u30d6\u30eb\u3067\u3059\u3002\u3053\u308c\u3092\u30d9\u30fc\u30b9\u306b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u5316\u3092\u691c\u8a3c\u3057\u305f\u3044\u3068\u304a\u3082\u3044\u307e\u3059\n\n| sample_tables | CREATE TABLE `sample_tables` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`detail1` varchar(26) DEFAULT NULL,\n`detail2` enum('cate','com','blog') NOT NULL DEFAULT 'cate',\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=271124 DEFAULT CHARSET=utf8 |\n\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.00 sec)\n\n\n\n\u65e2\u5b58\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u8868\u306b\u5909\u63db\u3067\u304d\u308b\u304b\u691c\u8a3c\n\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304a\u308a\u307e\u3059\n\nmysql> alter table sample_tables\n-> PARTITION BY RANGE (id) (\n->  PARTITION p000000 VALUES LESS THAN (100000),\n->  PARTITION p100000 VALUES LESS THAN (200000),\n->  PARTITION p200000 VALUES LESS THAN (300000),\n->  PARTITION pover VALUES LESS THAN MAXVALUE\n-> );\nQuery OK, 271123 rows affected (4.97 sec)\nRecords: 271123  Duplicates: 0  Warnings: 0\n\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.11 sec)\n\n\n\u30c7\u30fc\u30bf\u306e\u5206\u5e03\u72b6\u6cc1\u3092\u78ba\u8a8d\n\u306a\u3093\u3068\u306a\u304f\u5206\u304b\u308c\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u308b\nselect TABLE_SCHEMA,TABLE_NAME,PARTITION_NAME,PARTITION_ORDINAL_POSITION,TABLE_ROWS from INFORMATION_SCHEMA.PARTITIONS WHERE TABLE_NAME='sample_tables';\n\n+--------------+-----------------+----------------+----------------------------+------------+\n| TABLE_SCHEMA | TABLE_NAME      | PARTITION_NAME | PARTITION_ORDINAL_POSITION | TABLE_ROWS |\n+--------------+-----------------+----------------+----------------------------+------------+\n| say          | sample_tables   | p000000        |                          1 |      99972 |\n| say          | sample_tables   | p100000        |                          2 |     102819 |\n| say          | sample_tables   | p200000        |                          3 |      74263 |\n| say          | sample_tables   | pover          |                          4 |          0 |\n+--------------+-----------------+----------------+----------------------------+------------+\n\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.00 sec)\n\n\n\n\u4e0a\u8a18\u306b\u3066\u4f5c\u6210\u3057\u305f\u30c6\u30fc\u30d6\u30eb\u306b\u3001\u65b0\u898f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3059\u308b\nALTER TABLE sample_tables ADD PARTITION (\nPARTITION p300000 VALUES LESS THAN (400000)\n);\n\n\n\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\uff01\nRANGE \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3055\u308c\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u306b\u304a\u3044\u3066\u3001ADD PARTITION \u306f\u65e2\u5b58\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u300c\u5f8c\u300d\u306b\u3057\u304b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u8ffd\u52a0\u304c\u3067\u304d\u306a\u3044\n\uff08\u300c\u524d\u300d\u3084\u300c\u9593\u300d\u306fNG\u3067\u3059\uff09\u3002\u305d\u306e\u305f\u3081MAXVALUE\u304c\u65e2\u306b\u5b58\u5728\u3059\u308b\u5834\u5408\u306fMAXVALUE \u3088\u308a\u5f8c\u306e\u5024\u306f\u5b58\u5728\u3057\u5f97\u306a\u3044\u305f\u3081\u3001\u65b0\u898f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u304c\u4f5c\u6210\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\nERROR 1481 (HY000): MAXVALUE can only be used in last partition definition\n\n\n\u4ee3\u66ff\u6848\n\u4e0a\u8a18\u306e\u5834\u5408\u306f\u3001\u65b0\u898f\u3067\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u3088\u308a\u3001\u30c7\u30fc\u30bf\u3092\u518d\u914d\u7f6e\uff08REORGANIZE\uff09\u3059\u308b\u65b9\u6cd5\u3067\u5b9f\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nmysql> ALTER TABLE sample_tables REORGANIZE PARTITION pover INTO (\n->     PARTITION p300000 VALUES LESS THAN (400000),\n->     PARTITION pover VALUES LESS THAN MAXVALUE\n-> );\nQuery OK, 0 rows affected (0.10 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.11 sec)\n\n\n\u4ee5\u4e0a\u3092\u8e0f\u307e\u3048\u3066\u30fb\u30fb\n\nMAXVALUE\u306f\u3042\u3048\u3066\u6307\u5b9a\u3057\u306a\u3044\n\u3042\u308b\u7a0b\u5ea6\u3001\u30d0\u30c3\u30d5\u30a1\u3092\u6301\u305f\u305b\u305f\u5f62\u3067\u30ec\u30f3\u30b8\u3092\u632f\u3063\u3066\u304a\u304f\u7b49\u306e\u8a2d\u8a08\u3092\u884c\u3063\u3066\u304a\u3044\u305f\u307b\u3046\u304c\u826f\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u65e2\u5b58\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u3055\u3089\u306b\u7d30\u5206\u5316\u3059\u308b\n\u4f5c\u6210\u3057\u305f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u3055\u3089\u306b\u7d30\u5206\u5316\u3057\u305f\u3044\u5834\u5408\u3001\u305f\u3068\u3048\u3070\u3001sample_tables\u306e\u4f8b\u3067\u3059\u3068100000\u30ec\u30f3\u30b8\u3067\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u5206\u3051\u3066\u304a\u308a\u307e\u3059\u304c\u3001\u3055\u3089\u306b\u3053\u308c\u3092\u300110000\u5358\u4f4d\u3067\n\u5206\u5272\u3057\u306a\u304a\u3057\u305f\u3044\u3068\u3044\u3046\u5834\u5408\u306f\u3001REORGANIZE PARTITION\u3092\u5229\u7528\u3057\u3066\u3001\u3059\u3079\u3066\u518d\u914d\u7f6e\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u305f\u3060\u3057\u4e0a\u8a185\u540c\u69d8\u518d\u914d\u7f6e\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\n\u7d30\u5206\u5316\nALTER TABLE sample_tables REORGANIZE PARTITION p000000, p100000, p200000, p300000,pover INTO (\nPARTITION p00000 VALUES LESS THAN (10000),\nPARTITION p10000 VALUES LESS THAN (20000),\nPARTITION p20000 VALUES LESS THAN (30000),\nPARTITION p30000 VALUES LESS THAN (40000),\nPARTITION p40000 VALUES LESS THAN (50000),\nPARTITION p50000 VALUES LESS THAN (60000),\nPARTITION p60000 VALUES LESS THAN (70000),\nPARTITION p70000 VALUES LESS THAN (80000),\nPARTITION p80000 VALUES LESS THAN (90000),\nPARTITION p90000 VALUES LESS THAN (100000),\nPARTITION pover VALUES LESS THAN MAXVALUE\n);\n\nQuery OK, 271123 rows affected (5.00 sec)\nRecords: 271123  Duplicates: 0  Warnings: 0\n\nmysql> select count(*) from sample_tables;\n\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.10 sec)\n\n\n\n\u7d30\u5206\u5316\u7d50\u679c\n+--------------+-----------------+----------------+----------------------------+------------+\n| TABLE_SCHEMA | TABLE_NAME      | PARTITION_NAME | PARTITION_ORDINAL_POSITION | TABLE_ROWS |\n+--------------+-----------------+----------------+----------------------------+------------+\n| say          | sample_tables   | p00000         |                          1 |       9975 |\n| say          | sample_tables   | p10000         |                          2 |       9851 |\n| say          | sample_tables   | p20000         |                          3 |      10421 |\n| say          | sample_tables   | p30000         |                          4 |      10236 |\n| say          | sample_tables   | p40000         |                          5 |      10222 |\n| say          | sample_tables   | p50000         |                          6 |       9761 |\n| say          | sample_tables   | p60000         |                          7 |       9992 |\n| say          | sample_tables   | p70000         |                          8 |      10222 |\n| say          | sample_tables   | p80000         |                          9 |      10166 |\n| say          | sample_tables   | p90000         |                         10 |       9984 |\n| say          | sample_tables   | pover          |                         11 |     173134 |\n+--------------+-----------------+----------------+----------------------------+------------+\n11 rows in set (0.00 sec)\n\n\n\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u4e00\u90e8\u3092\u6d88\u3057\u305f\u3044\u5834\u5408\n\uff01\uff01\uff01\uff01\u3053\u306e\u4f5c\u696d\u3092\u884c\u3046\u3068\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u5185\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u305f\u30c7\u30fc\u30bf\u306f\u3059\u3079\u3066\u306a\u304f\u306a\u308a\u307e\u3059\u304c\u3001\u9006\u306b\u90e8\u5206\u7684\u306btruncate\u3067\u304d\u308b\u3068\u3044\u3046\u610f\u5473\u3067\u306f\u304b\u306a\u308a\u4f7f\u3048\u307e\u3059\uff01\nALTER TABLE sample_tables DROP PARTITION p00000;\nALTER TABLE sample_tables DROP PARTITION p10000;\nALTER TABLE sample_tables DROP PARTITION p20000;\nALTER TABLE sample_tables DROP PARTITION p30000;\n\n\nDROP PARTITION \u7d50\u679c\n\n\u30c7\u30fc\u30bf\u4ef6\u6570\n\u6e1b\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308b\u304b\u3068\u601d\u3044\u307e\u3059\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   231124 |\n+----------+\n1 row in set (0.08 sec)\n\n-- p00000\u3001p10000\u3001p20000\u3001p30000 \u304c\u306a\u304f\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n\n+--------------+-----------------+----------------+----------------------------+------------+\n| TABLE_SCHEMA | TABLE_NAME      | PARTITION_NAME | PARTITION_ORDINAL_POSITION | TABLE_ROWS |\n+--------------+-----------------+----------------+----------------------------+------------+\n| say          | sample_tables   | p40000         |                          1 |       9819 |\n| say          | sample_tables   | p50000         |                          2 |       9779 |\n| say          | sample_tables   | p60000         |                          3 |      10513 |\n| say          | sample_tables   | p70000         |                          4 |      10082 |\n| say          | sample_tables   | p80000         |                          5 |      10215 |\n| say          | sample_tables   | p90000         |                          6 |       9968 |\n| say          | sample_tables   | pover          |                          7 |     170286 |\n+--------------+-----------------+----------------+----------------------------+------------+\n7 rows in set (0.00 sec)\n\n\n\u5b9a\u7fa9\nsample_tables | CREATE TABLE `sample_tables` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`detail1` varchar(26) DEFAULT NULL,\n`detail2` enum('cate','com','blog') NOT NULL DEFAULT 'cate',\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=271124 DEFAULT CHARSET=utf8\n/*!50100 PARTITION BY RANGE (id)\n(PARTITION p40000 VALUES LESS THAN (50000) ENGINE = InnoDB,\nPARTITION p50000 VALUES LESS THAN (60000) ENGINE = InnoDB,\nPARTITION p60000 VALUES LESS THAN (70000) ENGINE = InnoDB,\nPARTITION p70000 VALUES LESS THAN (80000) ENGINE = InnoDB,\nPARTITION p80000 VALUES LESS THAN (90000) ENGINE = InnoDB,\nPARTITION p90000 VALUES LESS THAN (100000) ENGINE = InnoDB,\nPARTITION pover VALUES LESS THAN MAXVALUE ENGINE = InnoDB) */ |\n\n\n\u975e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u623b\u3059\n\u3053\u3061\u3089\u306f\u3001\u30c7\u30fc\u30bf\u306f\u6d88\u3048\u307e\u305b\u3093\uff01\nmysql> ALTER TABLE sample_tables REMOVE PARTITIONING;\n\n\n\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u304c\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\n+--------------+-----------------+----------------+----------------------------+------------+\n| TABLE_SCHEMA | TABLE_NAME      | PARTITION_NAME | PARTITION_ORDINAL_POSITION | TABLE_ROWS |\n+--------------+-----------------+----------------+----------------------------+------------+\n| say          | sample_tables   | NULL           |                       NULL |     248834 |\n+--------------+-----------------+----------------+----------------------------+------------+\n\n\n\n\u30c7\u30fc\u30bf\u306f\u6d88\u3048\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n\nmysql(MariaDB)\u306b\u306f\u3001\u30ec\u30f3\u30b8\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3063\u3066\u3082\u306e\u304c\u3042\u308a\u307e\u3057\u3066\u3001\u3046\u30fc\u306a\u3093\u3067\u3057\u3087\uff1f\u3042\u308b\u898f\u5247\u306b\u3057\u304c\u3063\u305f\u30c7\u30fc\u30bf\u3092\u304a\u306e\u304a\u306e\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306b\u632f\u308a\u5206\u3051\u3066\u304f\u308c\u308b\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3\u7684\u306a\u3082\u306e\u3067\u3059\u3002\n\n-- \u30c7\u30fc\u30bf\u9818\u57df\u304c\u5206\u5272\u3055\u308c\u308b\u305f\u3081\u3001\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3059\u308b\u3053\u3068\u306b\u3088\u308b\u6027\u80fd\u4e0a\u306e\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u306e\u767a\u751f\u3092\u6291\u3048\u3089\u308c\u308b\n-- MyISAM\u306a\u3069\u3001\u30c6\u30fc\u30d6\u30eb\u30b5\u30a4\u30ba\u306b\u4e0a\u9650\u304c\u3042\u308b\u5834\u5408\u3067\u3082\u305d\u308c\u4ee5\u4e0a\u306e\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u306b\u306a\u308b\n\n\u3068\u3044\u3063\u305f\u70b9\u3067\u3059\u3001\u5c11\u306a\u3044\u30c7\u30fc\u30bf\u3067\u3059\u3068\u3053\u308c\u3068\u3044\u3063\u305f\u5229\u70b9\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u6570\u767e\u4e07\u898f\u6a21\u30c7\u30fc\u30bf\u3067\u3059\u3068\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u6761\u4ef6\u306b\u30de\u30c3\u30c1\u3059\u308c\u3070\u3001\u731b\u70c8\u306b\u30af\u30a8\u30ea\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u5411\u4e0a\u3057\u307e\u3059\uff01\uff01\n\n## \u30b5\u30f3\u30d7\u30eb\u30c6\u30fc\u30d6\u30eb\n\n\u3053\u3093\u306a\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\u975e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u30c6\u30fc\u30d6\u30eb\u3067\u3059\u306d\u3002\u3064\u307e\u308a\u666e\u901a\u306e\u30c6\u30fc\u30d6\u30eb\u3067\u3059\u3002\u3053\u308c\u3092\u30d9\u30fc\u30b9\u306b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u5316\u3092\u691c\u8a3c\u3057\u305f\u3044\u3068\u304a\u3082\u3044\u307e\u3059\n\n```sql\n\n| sample_tables | CREATE TABLE `sample_tables` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`detail1` varchar(26) DEFAULT NULL,\n`detail2` enum('cate','com','blog') NOT NULL DEFAULT 'cate',\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=271124 DEFAULT CHARSET=utf8 |\n\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.00 sec)\n\n```\n\n## \u65e2\u5b58\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u8868\u306b\u5909\u63db\u3067\u304d\u308b\u304b\u691c\u8a3c\n\n\u6b63\u5e38\u7d42\u4e86\u3057\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304a\u308a\u307e\u3059\n\n```sql\n\nmysql> alter table sample_tables\n-> PARTITION BY RANGE (id) (\n->  PARTITION p000000 VALUES LESS THAN (100000),\n->  PARTITION p100000 VALUES LESS THAN (200000),\n->  PARTITION p200000 VALUES LESS THAN (300000),\n->  PARTITION pover VALUES LESS THAN MAXVALUE\n-> );\nQuery OK, 271123 rows affected (4.97 sec)\nRecords: 271123  Duplicates: 0  Warnings: 0\n\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.11 sec)\n```\n\n## \u30c7\u30fc\u30bf\u306e\u5206\u5e03\u72b6\u6cc1\u3092\u78ba\u8a8d\n\n\u306a\u3093\u3068\u306a\u304f\u5206\u304b\u308c\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u308b\n\n```sql\nselect TABLE_SCHEMA,TABLE_NAME,PARTITION_NAME,PARTITION_ORDINAL_POSITION,TABLE_ROWS from INFORMATION_SCHEMA.PARTITIONS WHERE TABLE_NAME='sample_tables';\n\n+--------------+-----------------+----------------+----------------------------+------------+\n| TABLE_SCHEMA | TABLE_NAME      | PARTITION_NAME | PARTITION_ORDINAL_POSITION | TABLE_ROWS |\n+--------------+-----------------+----------------+----------------------------+------------+\n| say          | sample_tables   | p000000        |                          1 |      99972 |\n| say          | sample_tables   | p100000        |                          2 |     102819 |\n| say          | sample_tables   | p200000        |                          3 |      74263 |\n| say          | sample_tables   | pover          |                          4 |          0 |\n+--------------+-----------------+----------------+----------------------------+------------+\n\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.00 sec)\n\n```\n\n## \u4e0a\u8a18\u306b\u3066\u4f5c\u6210\u3057\u305f\u30c6\u30fc\u30d6\u30eb\u306b\u3001\u65b0\u898f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3059\u308b\n\n```sql\nALTER TABLE sample_tables ADD PARTITION (\nPARTITION p300000 VALUES LESS THAN (400000)\n);\n```\n\n### \u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3057\u305f\uff01\n\nRANGE \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3055\u308c\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u306b\u304a\u3044\u3066\u3001ADD PARTITION \u306f\u65e2\u5b58\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u300c\u5f8c\u300d\u306b\u3057\u304b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u8ffd\u52a0\u304c\u3067\u304d\u306a\u3044\n\uff08\u300c\u524d\u300d\u3084\u300c\u9593\u300d\u306fNG\u3067\u3059\uff09\u3002\u305d\u306e\u305f\u3081MAXVALUE\u304c\u65e2\u306b\u5b58\u5728\u3059\u308b\u5834\u5408\u306fMAXVALUE \u3088\u308a\u5f8c\u306e\u5024\u306f\u5b58\u5728\u3057\u5f97\u306a\u3044\u305f\u3081\u3001\u65b0\u898f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u304c\u4f5c\u6210\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n```bash\nERROR 1481 (HY000): MAXVALUE can only be used in last partition definition\n```\n\n## \u4ee3\u66ff\u6848\n\n\u4e0a\u8a18\u306e\u5834\u5408\u306f\u3001\u65b0\u898f\u3067\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u308b\u3088\u308a\u3001\u30c7\u30fc\u30bf\u3092\u518d\u914d\u7f6e\uff08REORGANIZE\uff09\u3059\u308b\u65b9\u6cd5\u3067\u5b9f\u73fe\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n```sql\nmysql> ALTER TABLE sample_tables REORGANIZE PARTITION pover INTO (\n->     PARTITION p300000 VALUES LESS THAN (400000),\n->     PARTITION pover VALUES LESS THAN MAXVALUE\n-> );\nQuery OK, 0 rows affected (0.10 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.11 sec)\n```\n\n## \u4ee5\u4e0a\u3092\u8e0f\u307e\u3048\u3066\u30fb\u30fb\n\n### MAXVALUE\u306f\u3042\u3048\u3066\u6307\u5b9a\u3057\u306a\u3044\n\n\u3042\u308b\u7a0b\u5ea6\u3001\u30d0\u30c3\u30d5\u30a1\u3092\u6301\u305f\u305b\u305f\u5f62\u3067\u30ec\u30f3\u30b8\u3092\u632f\u3063\u3066\u304a\u304f\u7b49\u306e\u8a2d\u8a08\u3092\u884c\u3063\u3066\u304a\u3044\u305f\u307b\u3046\u304c\u826f\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n### \u65e2\u5b58\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u3055\u3089\u306b\u7d30\u5206\u5316\u3059\u308b\n\n\u4f5c\u6210\u3057\u305f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u3055\u3089\u306b\u7d30\u5206\u5316\u3057\u305f\u3044\u5834\u5408\u3001\u305f\u3068\u3048\u3070\u3001sample_tables\u306e\u4f8b\u3067\u3059\u3068100000\u30ec\u30f3\u30b8\u3067\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u5206\u3051\u3066\u304a\u308a\u307e\u3059\u304c\u3001\u3055\u3089\u306b\u3053\u308c\u3092\u300110000\u5358\u4f4d\u3067\n\u5206\u5272\u3057\u306a\u304a\u3057\u305f\u3044\u3068\u3044\u3046\u5834\u5408\u306f\u3001REORGANIZE PARTITION\u3092\u5229\u7528\u3057\u3066\u3001\u3059\u3079\u3066\u518d\u914d\u7f6e\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u305f\u3060\u3057\u4e0a\u8a185\u540c\u69d8\u518d\u914d\u7f6e\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\n\n#### \u7d30\u5206\u5316\n\n```sql\nALTER TABLE sample_tables REORGANIZE PARTITION p000000, p100000, p200000, p300000,pover INTO (\nPARTITION p00000 VALUES LESS THAN (10000),\nPARTITION p10000 VALUES LESS THAN (20000),\nPARTITION p20000 VALUES LESS THAN (30000),\nPARTITION p30000 VALUES LESS THAN (40000),\nPARTITION p40000 VALUES LESS THAN (50000),\nPARTITION p50000 VALUES LESS THAN (60000),\nPARTITION p60000 VALUES LESS THAN (70000),\nPARTITION p70000 VALUES LESS THAN (80000),\nPARTITION p80000 VALUES LESS THAN (90000),\nPARTITION p90000 VALUES LESS THAN (100000),\nPARTITION pover VALUES LESS THAN MAXVALUE\n);\n\nQuery OK, 271123 rows affected (5.00 sec)\nRecords: 271123  Duplicates: 0  Warnings: 0\n\nmysql> select count(*) from sample_tables;\n\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n1 row in set (0.10 sec)\n\n```\n#### \u7d30\u5206\u5316\u7d50\u679c\n\n```sql\n+--------------+-----------------+----------------+----------------------------+------------+\n| TABLE_SCHEMA | TABLE_NAME      | PARTITION_NAME | PARTITION_ORDINAL_POSITION | TABLE_ROWS |\n+--------------+-----------------+----------------+----------------------------+------------+\n| say          | sample_tables   | p00000         |                          1 |       9975 |\n| say          | sample_tables   | p10000         |                          2 |       9851 |\n| say          | sample_tables   | p20000         |                          3 |      10421 |\n| say          | sample_tables   | p30000         |                          4 |      10236 |\n| say          | sample_tables   | p40000         |                          5 |      10222 |\n| say          | sample_tables   | p50000         |                          6 |       9761 |\n| say          | sample_tables   | p60000         |                          7 |       9992 |\n| say          | sample_tables   | p70000         |                          8 |      10222 |\n| say          | sample_tables   | p80000         |                          9 |      10166 |\n| say          | sample_tables   | p90000         |                         10 |       9984 |\n| say          | sample_tables   | pover          |                         11 |     173134 |\n+--------------+-----------------+----------------+----------------------------+------------+\n11 rows in set (0.00 sec)\n\n```\n\n## \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u4e00\u90e8\u3092\u6d88\u3057\u305f\u3044\u5834\u5408\n\n\uff01\uff01\uff01\uff01\u3053\u306e\u4f5c\u696d\u3092\u884c\u3046\u3068\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u5185\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u305f\u30c7\u30fc\u30bf\u306f\u3059\u3079\u3066\u306a\u304f\u306a\u308a\u307e\u3059\u304c\u3001\u9006\u306b\u90e8\u5206\u7684\u306btruncate\u3067\u304d\u308b\u3068\u3044\u3046\u610f\u5473\u3067\u306f\u304b\u306a\u308a\u4f7f\u3048\u307e\u3059\uff01\n\n```sql\nALTER TABLE sample_tables DROP PARTITION p00000;\nALTER TABLE sample_tables DROP PARTITION p10000;\nALTER TABLE sample_tables DROP PARTITION p20000;\nALTER TABLE sample_tables DROP PARTITION p30000;\n```\n\n### DROP PARTITION \u7d50\u679c\n\n#### \u30c7\u30fc\u30bf\u4ef6\u6570\n\n\u6e1b\u3063\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308b\u304b\u3068\u601d\u3044\u307e\u3059\n\n```sql\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   231124 |\n+----------+\n1 row in set (0.08 sec)\n\n-- p00000\u3001p10000\u3001p20000\u3001p30000 \u304c\u306a\u304f\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n\n+--------------+-----------------+----------------+----------------------------+------------+\n| TABLE_SCHEMA | TABLE_NAME      | PARTITION_NAME | PARTITION_ORDINAL_POSITION | TABLE_ROWS |\n+--------------+-----------------+----------------+----------------------------+------------+\n| say          | sample_tables   | p40000         |                          1 |       9819 |\n| say          | sample_tables   | p50000         |                          2 |       9779 |\n| say          | sample_tables   | p60000         |                          3 |      10513 |\n| say          | sample_tables   | p70000         |                          4 |      10082 |\n| say          | sample_tables   | p80000         |                          5 |      10215 |\n| say          | sample_tables   | p90000         |                          6 |       9968 |\n| say          | sample_tables   | pover          |                          7 |     170286 |\n+--------------+-----------------+----------------+----------------------------+------------+\n7 rows in set (0.00 sec)\n```\n\n### \u5b9a\u7fa9\n\n```sql\nsample_tables | CREATE TABLE `sample_tables` (\n`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n`detail1` varchar(26) DEFAULT NULL,\n`detail2` enum('cate','com','blog') NOT NULL DEFAULT 'cate',\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=271124 DEFAULT CHARSET=utf8\n/*!50100 PARTITION BY RANGE (id)\n(PARTITION p40000 VALUES LESS THAN (50000) ENGINE = InnoDB,\nPARTITION p50000 VALUES LESS THAN (60000) ENGINE = InnoDB,\nPARTITION p60000 VALUES LESS THAN (70000) ENGINE = InnoDB,\nPARTITION p70000 VALUES LESS THAN (80000) ENGINE = InnoDB,\nPARTITION p80000 VALUES LESS THAN (90000) ENGINE = InnoDB,\nPARTITION p90000 VALUES LESS THAN (100000) ENGINE = InnoDB,\nPARTITION pover VALUES LESS THAN MAXVALUE ENGINE = InnoDB) */ |\n```\n\n## \u975e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u30c6\u30fc\u30d6\u30eb\u306b\u623b\u3059\n\n\u3053\u3061\u3089\u306f\u3001\u30c7\u30fc\u30bf\u306f\u6d88\u3048\u307e\u305b\u3093\uff01\n\n```\nmysql> ALTER TABLE sample_tables REMOVE PARTITIONING;\n\n```\n\n### \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u304c\u306a\u304f\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n```sql\n+--------------+-----------------+----------------+----------------------------+------------+\n| TABLE_SCHEMA | TABLE_NAME      | PARTITION_NAME | PARTITION_ORDINAL_POSITION | TABLE_ROWS |\n+--------------+-----------------+----------------+----------------------------+------------+\n| say          | sample_tables   | NULL           |                       NULL |     248834 |\n+--------------+-----------------+----------------+----------------------------+------------+\n\n```\n\n### \u30c7\u30fc\u30bf\u306f\u6d88\u3048\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\n\n```sql\nmysql> select count(*) from sample_tables;\n+----------+\n| count(*) |\n+----------+\n|   271123 |\n+----------+\n```\n"}