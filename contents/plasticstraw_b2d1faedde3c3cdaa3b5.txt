{"tags": ["Unity", "fastlane"], "context": "\n\n\u306f\u3058\u3081\u306b\n\u666e\u901a\u306e Unity \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u958b\u767a\u4e2d\u306f\u3001\u4ee5\u4e0b\u306e\u30b5\u30a4\u30af\u30eb\u304c\u4f55\u5ea6\u3082\u7e70\u308a\u8fd4\u3055\u308c\u308b\u3053\u3068\u3068\u601d\u3044\u307e\u3059\u3002\n\niOS \u7528\u306e buildNumber \u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\niOS \u7528\u306e Xcode \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u66f8\u304d\u51fa\u3057\niOS \u7528 ipa \u4f5c\u6210\nipa \u3092 fabric \u306e beta \u3067\u914d\u5e03\nAndroid \u7528\u306e bundleVersionCode \u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\nAndroid \u7528 apk \u66f8\u304d\u51fa\u3057\napk \u3092 fabric \u306e beta \u3067\u914d\u5e03\nslack \u3067\u958b\u767a\u30c1\u30fc\u30e0\u306b\u5831\u544a\n\n\u9762\u5012\u3067\u3059\u306d\u3002fastlane \u3067\u30e9\u30af\u3057\u307e\u3057\u3087\u3046\u3002\n\u3053\u306e\u8a18\u4e8b\u306f fastlane \u3067 Unity \u306e\u30d3\u30eb\u30c9\u3092\u884c\u3046\u90e8\u5206\u3092\u4e2d\u5fc3\u306b\u66f8\u3044\u3066\u3044\u307e\u3059\u306e\u3067\u3001fastlane \u306e\u57fa\u672c\u7684\u306a\u90e8\u5206\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u306a\u3069\u3092\u3069\u3046\u305e\u3002\n\nfastlane\u3092\u4f7f\u3063\u3066\u7d99\u7d9a\u7684\u30c7\u30ea\u30d0\u30ea\u30fc\u3092\u5b9f\u8df5\u3059\u308b\n\u3053\u308c\u304b\u3089\u59cb\u3081\u308bfastlane\n\n\nHOW?\n\n1. \u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u6e96\u5099\nAssets/Editor \u4ee5\u4e0b\u306b\u3001\u3053\u3093\u306a\u611f\u3058\u3067\u30d3\u30eb\u30c9\u7528\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u914d\u7f6e\u3057\u307e\u3059\u3002\n\nAppBuilder.cs\nusing UnityEditor;\nusing UnityEngine;\n\npublic class AppBuilder{\n\n    [MenuItem (\"Build/Android\u5411\u3051\u30d3\u30eb\u30c9\")]\n    static void buildForAndroid(){\n        bumpBuildNumberForAndroid ();\n        string errorMessage = BuildPipeline.BuildPlayer(GetAllScenePaths (), \"/Users/plasticstraw/Desktop/game.apk\", BuildTarget.Android, BuildOptions.None);\n        if( !string.IsNullOrEmpty( errorMessage ) )\n            Debug.LogError( \"[Error!] \" + errorMessage );\n        else\n            Debug.Log( \"[Success!]\" );\n    }\n\n    [MenuItem (\"Build/iOS\u5411\u3051\u30d3\u30eb\u30c9\")]\n    static void buildForIOS(){\n        bumpBuildNumberForIOS ();\n        // \u51fa\u529b\u30d1\u30b9\u3002\u7d76\u5bfe\u30d1\u30b9\u3067\u6307\u5b9a\u3059\u308b\u3053\u3068\u3002\u307e\u305f\u3001\u6700\u5f8c\u306b\u30b9\u30e9\u30c3\u30b7\u30e5\u3092\u5165\u308c\u306a\u3044\u3053\u3068\u3002PostBuildProcess \u306b\u6e21\u308b path \u304c\u901a\u5e38\u30d3\u30eb\u30c9\u3068\u7570\u306a\u3063\u3066\u3057\u307e\u3044\u3001\u601d\u308f\u306c\u30d0\u30b0\u3092\u5f15\u304d\u8d77\u3053\u3059\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n        string path = \"/Users/plasticstraw/Desktop/game\";\n        string errorMessage = BuildPipeline.BuildPlayer(GetAllScenePaths(), path, BuildTarget.iOS, BuildOptions.Il2CPP);\n        if( !string.IsNullOrEmpty( errorMessage ) )\n            Debug.LogError( \"[Error!] \" + errorMessage );\n        else\n            Debug.Log( \"[Success!]\" );\n    }\n\n    static void bumpBuildNumberForIOS(){\n        string str = PlayerSettings.iOS.buildNumber;\n        int num = int.Parse (str);\n        num++;\n        PlayerSettings.iOS.buildNumber = num + \"\";\n    }\n\n    static void bumpBuildNumberForAndroid(){\n        PlayerSettings.Android.bundleVersionCode += 1;\n    }\n\n    static string[] GetAllScenePaths(){\n        string[] scenes = new string[EditorBuildSettings.scenes.Length];\n        for( int i = 0; i < EditorBuildSettings.scenes.Length ; i++ ) {\n            scenes[i] = EditorBuildSettings.scenes[i].path;\n        }\n        return scenes;\n    }\n}\n\n\n\nUnity \u306e\u30e1\u30cb\u30e5\u30fc\u306b\u300cBuild \u300d\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u3053\u304b\u3089\u305d\u308c\u305e\u308c\u306e\u30d3\u30eb\u30c9\u51e6\u7406\u304c\u671f\u5f85\u901a\u308a\u306b\u52d5\u304f\u304b\u30c6\u30b9\u30c8\u3067\u304d\u307e\u3059\u3002\n\n2. Fastfile \u3092\u8a18\u8ff0\nUnity \u306b\u306f\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u4efb\u610f\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u6a5f\u80fd\u304c\u5099\u308f\u3063\u3066\u3044\u307e\u3059\u3002\nfastlane \u3092\u4f7f\u3063\u3066\u3001\u4e0a\u8a18\u3067\u4f5c\u6210\u3057\u305f\u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u547c\u3093\u3067\u3084\u308b\u3053\u3068\u3067\u30d3\u30eb\u30c9\u3092\u81ea\u52d5\u5316\u3067\u304d\u307e\u3059\u3002\n\nFastfile\ndesc \"\u30d3\u30eb\u30c9\u3057\u3066 Beta \u3067\u914d\u5e03\u3057\u307e\u3059\u3002\"\nlane :beta do\n    buildForIOS\n    buildForAndroid\n    distributeByCrashlytics\n    slack(\n        default_payloads: [],\n        message: \"<!channel>: Beta \u3067\u914d\u5e03\u3057\u305f\u3088\",\n    )\nend\n\ndesc \"iOS\u7528\u30d3\u30eb\u30c9\"\nlane :buildForIOS do\n    path = File.expand_path(File.dirname(__FILE__)) +\"/../\"\n    sh(\"/Applications/Unity/Unity.app/Contents/MacOS/Unity -batchmode -quit -logFile ./build.log -projectPath '#{path}' -buildTarget ios -executeMethod AppBuilder.buildForIOS\")\n    gym(\n        project: \"/Users/plasticstraw/Desktop/game/Unity-iPhone.xcodeproj\",\n    )\nend\n\ndesc \"android\u7528\u30d3\u30eb\u30c9\"\nlane :buildForAndroid do\n    path = File.expand_path(File.dirname(__FILE__)) +\"/../\"\n    sh(\"/Applications/Unity/Unity.app/Contents/MacOS/Unity -batchmode -quit -logFile ./build.log -projectPath '#{path}' -buildTarget android -executeMethod AppBuilder.buildForAndroid\")\nend\n\ndesc \"\u914d\u5e03\"\nlane :distributeByCrashlytics do\n    # ios\n    crashlytics(\n        groups: 'team'\n    )\n\n    # android\n    crashlytics(\n        apk_path: \"/Users/plasticstraw/Desktop/game.apk\",\n        groups: 'team'\n        ipa_path: false, # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067iOS\u306e\u5024\u304c\u5165\u3063\u3066\u304a\u308a\u3001apk_path\u3092\u6307\u5b9a\u3057\u3066\u3082\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u306a\u3044\u306e\u3067\u5024\u3092\u524a\u9664\n        crashlytics_path: false, # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067iOS\u306e\u5024\u304c\u5165\u3063\u3066\u304a\u308a\u3001android\u5411\u3051\u3060\u3068\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u306a\u3044\u305f\u3081\u3001\u5024\u3092\u524a\u9664\u3057\u3066fastlane\u306b\u4efb\u305b\u308b\n    )\nend\n\n\n\n\n3.\u5b9f\u884c\n\u3042\u3068\u306f\u30bf\u30fc\u30df\u30ca\u30eb\u304b\u3089 $ fastlane beta \u4e00\u767a\u3067\u3001\u3082\u308d\u3082\u308d\u30d3\u30eb\u30c9\u3057\u3066\u3082\u308d\u3082\u308d\u914d\u5e03\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u304a\u3081\u3067\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u306f Unity \u3067\u8a72\u5f53\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u958b\u3044\u3066\u3044\u308b\u72b6\u614b\u3067\u306f\u30c0\u30e1\u3067\u3001\u304b\u3064\u30d3\u30eb\u30c9\u3067\u8d05\u6ca2\u306bCPU\u3092\u98df\u308f\u308c\u308b\u305f\u3081\u3001CI\u306b\u7d44\u307f\u8fbc\u3080\u306a\u308a\u3001\u5225\u306e\u30de\u30b7\u30f3\u3067\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30af\u30ed\u30fc\u30f3\u3057\u3066\u304b\u3089\u5b9f\u884c\u3059\u308b\u306a\u308a\u304c\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n# \u306f\u3058\u3081\u306b\n\u666e\u901a\u306e Unity \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u958b\u767a\u4e2d\u306f\u3001\u4ee5\u4e0b\u306e\u30b5\u30a4\u30af\u30eb\u304c\u4f55\u5ea6\u3082\u7e70\u308a\u8fd4\u3055\u308c\u308b\u3053\u3068\u3068\u601d\u3044\u307e\u3059\u3002\n\n1. iOS \u7528\u306e buildNumber \u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n2. iOS \u7528\u306e Xcode \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u66f8\u304d\u51fa\u3057\n3. iOS \u7528 ipa \u4f5c\u6210\n4. ipa \u3092 fabric \u306e beta \u3067\u914d\u5e03\n4. Android \u7528\u306e bundleVersionCode \u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n5. Android \u7528 apk \u66f8\u304d\u51fa\u3057\n6. apk \u3092 fabric \u306e beta \u3067\u914d\u5e03\n7. slack \u3067\u958b\u767a\u30c1\u30fc\u30e0\u306b\u5831\u544a\n\n\u9762\u5012\u3067\u3059\u306d\u3002fastlane \u3067\u30e9\u30af\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u3053\u306e\u8a18\u4e8b\u306f fastlane \u3067 Unity \u306e\u30d3\u30eb\u30c9\u3092\u884c\u3046\u90e8\u5206\u3092\u4e2d\u5fc3\u306b\u66f8\u3044\u3066\u3044\u307e\u3059\u306e\u3067\u3001fastlane \u306e\u57fa\u672c\u7684\u306a\u90e8\u5206\u306f\u3053\u3061\u3089\u306e\u8a18\u4e8b\u306a\u3069\u3092\u3069\u3046\u305e\u3002\n\n- [fastlane\u3092\u4f7f\u3063\u3066\u7d99\u7d9a\u7684\u30c7\u30ea\u30d0\u30ea\u30fc\u3092\u5b9f\u8df5\u3059\u308b](http://qiita.com/gin0606/items/a8573b582752de0c15e1)\n- [\u3053\u308c\u304b\u3089\u59cb\u3081\u308bfastlane](http://qiita.com/econa77/items/d81a392d6b195cfb7316)\n\n# HOW?\n\n## 1. \u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u6e96\u5099\nAssets/Editor \u4ee5\u4e0b\u306b\u3001\u3053\u3093\u306a\u611f\u3058\u3067\u30d3\u30eb\u30c9\u7528\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n```csharp:AppBuilder.cs\nusing UnityEditor;\nusing UnityEngine;\n\npublic class AppBuilder{\n\n\t[MenuItem (\"Build/Android\u5411\u3051\u30d3\u30eb\u30c9\")]\n\tstatic void buildForAndroid(){\n\t\tbumpBuildNumberForAndroid ();\n\t\tstring errorMessage = BuildPipeline.BuildPlayer(GetAllScenePaths (), \"/Users/plasticstraw/Desktop/game.apk\", BuildTarget.Android, BuildOptions.None);\n\t\tif( !string.IsNullOrEmpty( errorMessage ) )\n\t\t\tDebug.LogError( \"[Error!] \" + errorMessage );\n\t\telse\n\t\t\tDebug.Log( \"[Success!]\" );\n\t}\n\n\t[MenuItem (\"Build/iOS\u5411\u3051\u30d3\u30eb\u30c9\")]\n\tstatic void buildForIOS(){\n\t\tbumpBuildNumberForIOS ();\n\t\t// \u51fa\u529b\u30d1\u30b9\u3002\u7d76\u5bfe\u30d1\u30b9\u3067\u6307\u5b9a\u3059\u308b\u3053\u3068\u3002\u307e\u305f\u3001\u6700\u5f8c\u306b\u30b9\u30e9\u30c3\u30b7\u30e5\u3092\u5165\u308c\u306a\u3044\u3053\u3068\u3002PostBuildProcess \u306b\u6e21\u308b path \u304c\u901a\u5e38\u30d3\u30eb\u30c9\u3068\u7570\u306a\u3063\u3066\u3057\u307e\u3044\u3001\u601d\u308f\u306c\u30d0\u30b0\u3092\u5f15\u304d\u8d77\u3053\u3059\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\t\tstring path = \"/Users/plasticstraw/Desktop/game\";\n\t\tstring errorMessage = BuildPipeline.BuildPlayer(GetAllScenePaths(), path, BuildTarget.iOS, BuildOptions.Il2CPP);\n\t\tif( !string.IsNullOrEmpty( errorMessage ) )\n\t\t\tDebug.LogError( \"[Error!] \" + errorMessage );\n\t\telse\n\t\t\tDebug.Log( \"[Success!]\" );\n\t}\n\n\tstatic void bumpBuildNumberForIOS(){\n\t\tstring str = PlayerSettings.iOS.buildNumber;\n\t\tint num = int.Parse (str);\n\t\tnum++;\n\t\tPlayerSettings.iOS.buildNumber = num + \"\";\n\t}\n\n\tstatic void bumpBuildNumberForAndroid(){\n\t\tPlayerSettings.Android.bundleVersionCode += 1;\n\t}\n\n\tstatic string[] GetAllScenePaths(){\n\t\tstring[] scenes = new string[EditorBuildSettings.scenes.Length];\n\t\tfor( int i = 0; i < EditorBuildSettings.scenes.Length ; i++ ) {\n\t\t\tscenes[i] = EditorBuildSettings.scenes[i].path;\n\t\t}\n\t\treturn scenes;\n\t}\n}\n\n```\n\nUnity \u306e\u30e1\u30cb\u30e5\u30fc\u306b\u300cBuild \u300d\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u3053\u304b\u3089\u305d\u308c\u305e\u308c\u306e\u30d3\u30eb\u30c9\u51e6\u7406\u304c\u671f\u5f85\u901a\u308a\u306b\u52d5\u304f\u304b\u30c6\u30b9\u30c8\u3067\u304d\u307e\u3059\u3002\n\n\n## 2. Fastfile \u3092\u8a18\u8ff0\n\nUnity \u306b\u306f\u3001\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u4efb\u610f\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u6a5f\u80fd\u304c\u5099\u308f\u3063\u3066\u3044\u307e\u3059\u3002\nfastlane \u3092\u4f7f\u3063\u3066\u3001\u4e0a\u8a18\u3067\u4f5c\u6210\u3057\u305f\u30d3\u30eb\u30c9\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u547c\u3093\u3067\u3084\u308b\u3053\u3068\u3067\u30d3\u30eb\u30c9\u3092\u81ea\u52d5\u5316\u3067\u304d\u307e\u3059\u3002\n\n```ruby:Fastfile\ndesc \"\u30d3\u30eb\u30c9\u3057\u3066 Beta \u3067\u914d\u5e03\u3057\u307e\u3059\u3002\"\nlane :beta do\n\tbuildForIOS\n\tbuildForAndroid\n\tdistributeByCrashlytics\n    slack(\n\t\tdefault_payloads: [],\n\t\tmessage: \"<!channel>: Beta \u3067\u914d\u5e03\u3057\u305f\u3088\",\n    )\nend\n\ndesc \"iOS\u7528\u30d3\u30eb\u30c9\"\nlane :buildForIOS do\n\tpath = File.expand_path(File.dirname(__FILE__)) +\"/../\"\n\tsh(\"/Applications/Unity/Unity.app/Contents/MacOS/Unity -batchmode -quit -logFile ./build.log -projectPath '#{path}' -buildTarget ios -executeMethod AppBuilder.buildForIOS\")\n\tgym(\n\t\tproject: \"/Users/plasticstraw/Desktop/game/Unity-iPhone.xcodeproj\",\n\t)\nend\n\ndesc \"android\u7528\u30d3\u30eb\u30c9\"\nlane :buildForAndroid do\n\tpath = File.expand_path(File.dirname(__FILE__)) +\"/../\"\n\tsh(\"/Applications/Unity/Unity.app/Contents/MacOS/Unity -batchmode -quit -logFile ./build.log -projectPath '#{path}' -buildTarget android -executeMethod AppBuilder.buildForAndroid\")\nend\n\ndesc \"\u914d\u5e03\"\nlane :distributeByCrashlytics do\n\t# ios\n    crashlytics(\n        groups: 'team'\n    )\n\n\t# android\n\tcrashlytics(\n\t\tapk_path: \"/Users/plasticstraw/Desktop/game.apk\",\n\t\tgroups: 'team'\n\t\tipa_path: false, # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067iOS\u306e\u5024\u304c\u5165\u3063\u3066\u304a\u308a\u3001apk_path\u3092\u6307\u5b9a\u3057\u3066\u3082\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u306a\u3044\u306e\u3067\u5024\u3092\u524a\u9664\n\t\tcrashlytics_path: false, # \u30c7\u30d5\u30a9\u30eb\u30c8\u3067iOS\u306e\u5024\u304c\u5165\u3063\u3066\u304a\u308a\u3001android\u5411\u3051\u3060\u3068\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u306a\u3044\u305f\u3081\u3001\u5024\u3092\u524a\u9664\u3057\u3066fastlane\u306b\u4efb\u305b\u308b\n\t)\nend\n\n```\n\n## 3.\u5b9f\u884c\n\n\u3042\u3068\u306f\u30bf\u30fc\u30df\u30ca\u30eb\u304b\u3089 `$ fastlane beta` \u4e00\u767a\u3067\u3001\u3082\u308d\u3082\u308d\u30d3\u30eb\u30c9\u3057\u3066\u3082\u308d\u3082\u308d\u914d\u5e03\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u304a\u3081\u3067\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u306f Unity \u3067\u8a72\u5f53\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u958b\u3044\u3066\u3044\u308b\u72b6\u614b\u3067\u306f\u30c0\u30e1\u3067\u3001\u304b\u3064\u30d3\u30eb\u30c9\u3067\u8d05\u6ca2\u306bCPU\u3092\u98df\u308f\u308c\u308b\u305f\u3081\u3001CI\u306b\u7d44\u307f\u8fbc\u3080\u306a\u308a\u3001\u5225\u306e\u30de\u30b7\u30f3\u3067\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30af\u30ed\u30fc\u30f3\u3057\u3066\u304b\u3089\u5b9f\u884c\u3059\u308b\u306a\u308a\u304c\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"}