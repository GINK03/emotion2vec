{"context": " More than 1 year has passed since last update.\u4e07\u304c\u4e00\u30b5\u30fc\u30d0\u306b\u5165\u3089\u308c\u3066\u500b\u4eba\u60c5\u5831\u3092\u629c\u304b\u308c\u306a\u3044\u70ba\u306b\n\u3053\u3093\u306a\u30b7\u30a7\u30eb\u3092\u66f8\u3044\u3066\u307f\u305f\n\nmail-delete.sh\n#!/bin/sh\n\n############################################\n#\u914d\u9001\u4e0d\u80fd\u30ad\u30e5\u30fc\u306b\u6e9c\u307e\u3063\u305f\u30e1\u30fc\u30eb\u3092\u5ec3\u68c4\u3059\u308b\n############################################\npostsuper -d ALL defer\npostsuper -d ALL deferred\n\n############################################\n#cur\u306b\u79fb\u52d5\u3057\u3066\u304b\u3089\u4e00\u65e5\u7d4c\u904e\u3057\u305f\u30e1\u30fc\u30eb\u3092\u524a\u9664\u3059\u308b\n############################################\nfunction delete_file () {\n\n    ###################\n    #debug\u7528\n    #ls -la /home/$1/Maildir/cur/\n    #echo -e \"\u524a\u9664\u5bfe\u8c61\u306e\u30e1\u30fc\u30eb\u306f\u3053\u3061\u3089============================\\n\"\n    #find /home/$1/Maildir/cur/ -ctime +1 -type f;\n    #find /home/$1/Maildir/cur/ -ctime +1 -type f >> /var/log/cron;\n    #echo -e \"====================================================\\n\"\n    find /home/$1/Maildir/cur/ -ctime +1 -type f -exec rm -f {} \\;\n}\n\n############################################\n# /home\u76f4\u4e0b\u306edir\u3060\u3051\u53d6\u5f97\u3057\u3001delete_file\u3092\u547c\u3073\u51fa\u3059\n############################################\nls -F /home | grep / | while read line; do\n\n    if [ -d /home/$line/Maildir ]; then\n        delete_file $line;\n    fi\n\ndone\n\n\n\u3042\u3068\u306f\u30b7\u30a7\u30eb\u3092cron\u3067\u5b9f\u884c\u3059\u308b\u3060\u3051\uff01(\u6bce\u65e50\u6642)\n\n/etc/cron.d/mail-delete\nSHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\n0 0 * * * root /etc/cron.d/mail-delete.sh\n\n\n**\u4e07\u304c\u4e00\u30b5\u30fc\u30d0\u306b\u5165\u3089\u308c\u3066\u500b\u4eba\u60c5\u5831\u3092\u629c\u304b\u308c\u306a\u3044\u70ba\u306b\n\u3053\u3093\u306a\u30b7\u30a7\u30eb\u3092\u66f8\u3044\u3066\u307f\u305f**\n\n```bash:mail-delete.sh\n#!/bin/sh\n\n############################################\n#\u914d\u9001\u4e0d\u80fd\u30ad\u30e5\u30fc\u306b\u6e9c\u307e\u3063\u305f\u30e1\u30fc\u30eb\u3092\u5ec3\u68c4\u3059\u308b\n############################################\npostsuper -d ALL defer\npostsuper -d ALL deferred\n\n############################################\n#cur\u306b\u79fb\u52d5\u3057\u3066\u304b\u3089\u4e00\u65e5\u7d4c\u904e\u3057\u305f\u30e1\u30fc\u30eb\u3092\u524a\u9664\u3059\u308b\n############################################\nfunction delete_file () {\n\n\t###################\n\t#debug\u7528\n\t#ls -la /home/$1/Maildir/cur/\n\t#echo -e \"\u524a\u9664\u5bfe\u8c61\u306e\u30e1\u30fc\u30eb\u306f\u3053\u3061\u3089============================\\n\"\n\t#find /home/$1/Maildir/cur/ -ctime +1 -type f;\n\t#find /home/$1/Maildir/cur/ -ctime +1 -type f >> /var/log/cron;\n\t#echo -e \"====================================================\\n\"\n\tfind /home/$1/Maildir/cur/ -ctime +1 -type f -exec rm -f {} \\;\n}\n\n############################################\n# /home\u76f4\u4e0b\u306edir\u3060\u3051\u53d6\u5f97\u3057\u3001delete_file\u3092\u547c\u3073\u51fa\u3059\n############################################\nls -F /home | grep / | while read line; do\n\t\n\tif [ -d /home/$line/Maildir ]; then\n\t\tdelete_file $line;\n\tfi\n\ndone\n```\n\n**\u3042\u3068\u306f\u30b7\u30a7\u30eb\u3092cron\u3067\u5b9f\u884c\u3059\u308b\u3060\u3051\uff01(\u6bce\u65e50\u6642)**\n\n```bash:/etc/cron.d/mail-delete\nSHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\n0 0 * * * root /etc/cron.d/mail-delete.sh\n```\n", "tags": ["postfix", "Linux", "Bash"]}