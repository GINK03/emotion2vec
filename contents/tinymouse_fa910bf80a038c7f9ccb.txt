{"context": " More than 1 year has passed since last update.\n\nPassport \u3068\u306f\nPassport \u306f Node.js \u306e\u305f\u3081\u306e\u8a8d\u8a3c\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3067\u3059\u3002\u8a8d\u8a3c\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u304a\u3053\u306a\u3046\u305f\u3081\u306e\u5fc5\u8981\u6700\u4f4e\u9650\u306e\u6a5f\u80fd\u3092\u3082\u3064\u3088\u3046\u306b\u8a2d\u8a08\u3055\u308c\u3066\u3044\u307e\u3059\u3002 \n\u516c\u5f0f Passport - Node.js\u306e\u305f\u3081\u306e\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u4f7f\u3044\u3069\u3053\u308d\u3092\u9078\u3070\u306a\u3044\u8a8d\u8a3c\u30e2\u30b8\u30e5\u30fc\u30eb\n\nPassport \u3092\u4f7f\u3063\u3066\u307f\u305f\nPassport \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u30e6\u30fc\u30b6\uff29\uff24\uff06\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u3001\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\nnode 0.10.24\nexpress 4.13.4\npassport 0.3.2\n\n\n\u30ef\u30fc\u30af\u30b9\u30da\u30fc\u30b9\u3092\u4f5c\u308b\n\u307e\u305a\u3001Node.js\uff0bExpress \u306e\u30ef\u30fc\u30af\u30b9\u30da\u30fc\u30b9\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u53c2\u8003 Node.js\u3001Express.js\u5165\u9580 - \u307a\u30fc\u307a\u30fcSE\u306e\u30d6\u30ed\u30b0\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n$ npm install --save passport\n\n\u53c2\u7167 Passport | \u306f\u3058\u3081\u306b\n\u4ee5\u4e0b\u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\napp.js\nvar passport = require('passport');\napp.use(passport.initialize());\n\n\n\u53c2\u7167 Passport | \u8a2d\u5b9a \u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u8a2d\u5b9a\n\n\u30e6\u30fc\u30b6\uff29\uff24\uff06\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3059\u308b\u305f\u3081\u306e\u6e96\u5099\nPassport \u3092\u4f7f\u3063\u3066\u8a8d\u8a3c\u78ba\u8a8d\u3059\u308b\u51e6\u7406\u3092\u66f8\u304d\u307e\u3059\u3002\n\u307e\u305a\u3001\u8a8d\u8a3c\u30b9\u30c8\u30e9\u30c6\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ npm install --save passpord-local\n\n\u4ee5\u4e0b\u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\napp.js\nvar LocalStrategy = require('passport-local').Strategy;\npassport.use(new LocalStrategy(function(username, password, done){\n    // \u3053\u3053\u3067 username \u3068 password \u3092\u78ba\u8a8d\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059\n}));\n\n\n\u7d50\u679c\u3092\u8fd4\u3059\u3068\u3053\u308d\u306f\u3001\n    if (\u306a\u3093\u3089\u304b\u306e\u30a8\u30e9\u30fc) {\n        return done(\u30a8\u30e9\u30fc\u5185\u5bb9);\n    }\n    else if (\u5931\u6557) {\n        return done(null, false);\n    }\n    else if (\u6210\u529f) {\n        return done(null, username);\n    }\n\n\u3053\u306e\u8fba\u306f Passport | \u8a2d\u5b9a \u691c\u8a3c\u7528\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\n\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u7528\u610f\u3059\u308b\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3001\u4f8b\u3048\u3070 login.html \u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\nlogin.html\n<form action=\"/login\" method=\"post\">\n    <div>\n        <label>\u30e6\u30fc\u30b6\u30fcID\uff1a</label>\n        <input type=\"text\" name=\"username\"/>\n    </div>\n    <div>\n        <label>\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a</label>\n        <input type=\"password\" name=\"password\"/>\n    </div>\n    <div>\n        <input type=\"submit\" value=\"\u30ed\u30b0\u30a4\u30f3\"/>\n    </div>\n</form>    \n\n\n\u3053\u306e\u4f8b\u3067\u306f /login \u306b POST \u3057\u307e\u3059\u3002\n/login \u306b GET \u3059\u308b\u3068\u3053\u306e\u753b\u9762\u3092\u8868\u793a\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\napp.js\napp.get('/login', function(req, res){\n    res.sendFile(__dirname + '/\u25c7\u25c7/login.html');\n});\n\n\n\n\u30ed\u30b0\u30a4\u30f3\u60c5\u5831\u3092\u53d7\u53d6\u3063\u3066\u8a8d\u8a3c\u51e6\u7406\u306b\u6e21\u3059\n/login \u306b POST \u3055\u308c\u305f\u3089\u3001\u305d\u306e\u60c5\u5831\u3092\u53d7\u53d6\u3063\u3066\u8a8d\u8a3c\u51e6\u7406\u306b\u6e21\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n$ npm install --save body-parser\n\n\napp.js\nvar bodyParser = require('body-parser');\napp.use(bodyParser.urlencoded({ extended: true });\n\napp.post('/login',\n    passport.authenticate('local'),\n    function(req, res){\n        // \u8a8d\u8a3c\u6210\u529f\u3059\u308b\u3068\u3053\u3053\u304c\u5b9f\u884c\u3055\u308c\u308b\n    }\n);\n\n\npassport.authenticate() \u306b\u306f\u3001post() \u3067\u53d7\u3051\u53d6\u3063\u305f username \u3068 password \u304c\u6e21\u3055\u308c\u307e\u3059\u3002\u4e0a\u8a18\u3067\u6e96\u5099\u3057\u305f\u8a8d\u8a3c\u78ba\u8a8d\u3059\u308b\u51e6\u7406\u304c\u5b9f\u884c\u3055\u308c\u3001\u305d\u306e\u7d50\u679c\u304c\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\n\u3053\u306e\u8fba\u307e\u3067\u306f Passport | \u30e6\u30fc\u30b6\u30fcID & \u30d1\u30b9\u30ef\u30fc\u30c9\n\u8a8d\u8a3c\u3059\u308b\u3068\u901a\u5e38\u306f\u30da\u30fc\u30b8\u9077\u79fb\u3057\u307e\u3059\u3002\n\napp.js\napp.post('/login',\n    passport.authenticate('local'),\n    function(req, res){\n        res.redirect('/\u25c7\u25c7');\n\n\n\u9077\u79fb\u5148\u306f\u30aa\u30d7\u30b7\u30e7\u30f3\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\napp.js\napp.post('/login',\n    passport.authenticate('local', {\n        failureRedirect: '/\u25c6\u25c6',  // \u5931\u6557\u3057\u305f\u3068\u304d\u306e\u9077\u79fb\u5148\n        successRedirect: '/\u25c7\u25c7',  // \u6210\u529f\u3057\u305f\u3068\u304d\u306e\u9077\u79fb\u5148\n    }),\n\n\n\u8a8d\u8a3c\u6210\u529f\u3057\u305f\u3068\u304d\u306f URL \u9077\u79fb\u305b\u305a\u306b\u51e6\u7406\u3059\u308b\u3053\u3068\u304c\u591a\u3044\u3067\u3057\u3087\u3046\u304b\u3002\n\napp.js\napp.post('/login',\n    passport.authenticate('local', {\n        failureRedirect: '/\u25c6\u25c6',  // \u5931\u6557\u3057\u305f\u3068\u304d\u306e\u9077\u79fb\u5148\n    }),\n    function(req, res){\n        \u25c7\u25c7  // \u6210\u529f\u3057\u305f\u3068\u304d\u306e\u51e6\u7406\n\n\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u7121\u52b9\u306b\u3057\u3066\u4f7f\u3046\nPassport \u306f\u8a8d\u8a3c\u6210\u529f\u3057\u305f\u3068\u304d\u8a8d\u8a3c\u60c5\u5831\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002API \u30b5\u30fc\u30d0\u3068\u3057\u3066\u5b9f\u884c\u3059\u308b\u3068\u304d\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3054\u3068\u306b\u8a8d\u8a3c\u51e6\u7406\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u3068\u304d\u306f\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u7121\u52b9\u306b\u3057\u3066\u4f7f\u7528\u3057\u307e\u3059\u3002\n\napp.js\napp.post('/login',\n    passport.authenticate('local', {\n        session: false,\n\n\n\u3053\u306e\u8fba\u307e\u3067\u306f Passport | \u8a8d\u8a3c\n\n\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u306b\u3057\u3066\u4f7f\u3046\nPassport \u306f\u8a8d\u8a3c\u6210\u529f\u3057\u305f\u3068\u304d\u8a8d\u8a3c\u60c5\u5831\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002Express \u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n$ npm install --save express-session\n\n\napp.js\nvar session = require('express-session');\napp.use(session({\n    secret: '\u25cb\u25cb',\n}));\napp.use(passport.session());\n\npassport.serializeUser(function(user, done) {\n    done(null, user);\n});\n\npassport.deserializeUser(function(user, done) {\n    done(null, user);\n});\n\n\n\u3053\u306e\u8fba\u306f Passport | \u8a2d\u5b9a \u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\n\n\u3069\u306e\u30da\u30fc\u30b8\u3067\u3082\u8a8d\u8a3c\u78ba\u8a8d\u3059\u308b\n\u3053\u308c\u307e\u3067\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916\u306e\u30da\u30fc\u30b8\u3067\u306f\u8a8d\u8a3c\u78ba\u8a8d\u3055\u308c\u307e\u305b\u3093\u3002\u3069\u306e\u30da\u30fc\u30b8\u3067\u3082\u8a8d\u8a3c\u78ba\u8a8d\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n\u307e\u305a\u3001\u30da\u30fc\u30b8\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8cb0\u3063\u305f\u3068\u304d\u8a8d\u8a3c\u6e08\u304b\u78ba\u8a8d\u3059\u308b\u95a2\u6570\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\napp.js\nfunction isAuthenticated(req, res, next){\n    if (req.isAuthenticated()) {  // \u8a8d\u8a3c\u6e08\n        return next();\n    }\n    else {  // \u8a8d\u8a3c\u3055\u308c\u3066\u3044\u306a\u3044\n        res.redirect('/login');  // \u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\n    }\n}\n\n\n\u30da\u30fc\u30b8\u3054\u3068\u306b\u78ba\u8a8d\u51e6\u7406\u3092\u5165\u308c\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\n\napp.js\napp.get('/\u25c6\u25c6', isAuthenticated, function(req, res){\n    \u25c7\u25c7  // \u8a8d\u8a3c\u6e08\u306e\u3068\u304d\u5b9f\u884c\u3055\u308c\u308b\n\n\n\u53c2\u8003 express - Documentation for \"ensureAuthentication\" \"isAuthenticated\" passport's functions? - Stack Overflow\n\n\u304a\u308f\u308a\u306b\n\u3068\u308a\u3042\u3048\u305a Node.js\uff0bExpress\uff0bPassport \u3092\u4f7f\u3063\u3066\u3001\u30e6\u30fc\u30b6\uff29\uff24\uff06\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nPassport \u306f\u3001Facebook \u3084 Twitter \u3068\u9023\u643a\u3057\u305f\u8a8d\u8a3c\u3082\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u306e\u51e6\u7406\u3082\u7528\u610f\u3057\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002\n\u3053\u308c\u3089\u306b\u3064\u3044\u3066\u306f\u3001\u6539\u3081\u3066\u3002\n#Passport \u3068\u306f\nPassport \u306f Node.js \u306e\u305f\u3081\u306e\u8a8d\u8a3c\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3067\u3059\u3002\u8a8d\u8a3c\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u304a\u3053\u306a\u3046\u305f\u3081\u306e\u5fc5\u8981\u6700\u4f4e\u9650\u306e\u6a5f\u80fd\u3092\u3082\u3064\u3088\u3046\u306b\u8a2d\u8a08\u3055\u308c\u3066\u3044\u307e\u3059\u3002 \n\u516c\u5f0f [Passport - Node.js\u306e\u305f\u3081\u306e\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u4f7f\u3044\u3069\u3053\u308d\u3092\u9078\u3070\u306a\u3044\u8a8d\u8a3c\u30e2\u30b8\u30e5\u30fc\u30eb]\n(http://knimon-software.github.io/www.passportjs.org/)\n\n#Passport \u3092\u4f7f\u3063\u3066\u307f\u305f\nPassport \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u30e6\u30fc\u30b6\uff29\uff24\uff06\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u3001\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n* node 0.10.24\n* express 4.13.4\n* passport 0.3.2\n\n##\u30ef\u30fc\u30af\u30b9\u30da\u30fc\u30b9\u3092\u4f5c\u308b\n\u307e\u305a\u3001Node.js\uff0bExpress \u306e\u30ef\u30fc\u30af\u30b9\u30da\u30fc\u30b9\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n\u53c2\u8003 [Node.js\u3001Express.js\u5165\u9580 - \u307a\u30fc\u307a\u30fcSE\u306e\u30d6\u30ed\u30b0]\n(http://tanakakns.hatenablog.com/entry/20150302/1425285635)\n\n##\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n```\n$ npm install --save passport\n```\n\n\u53c2\u7167 [Passport | \u306f\u3058\u3081\u306b]\n(http://knimon-software.github.io/www.passportjs.org/guide/)\n\n\u4ee5\u4e0b\u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```js:app.js\nvar passport = require('passport');\napp.use(passport.initialize());\n```\n\n\u53c2\u7167 [Passport | \u8a2d\u5b9a]\n(http://knimon-software.github.io/www.passportjs.org/guide/configure/) \u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u8a2d\u5b9a\n\n##\u30e6\u30fc\u30b6\uff29\uff24\uff06\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3059\u308b\u305f\u3081\u306e\u6e96\u5099\n\nPassport \u3092\u4f7f\u3063\u3066\u8a8d\u8a3c\u78ba\u8a8d\u3059\u308b\u51e6\u7406\u3092\u66f8\u304d\u307e\u3059\u3002\n\n\u307e\u305a\u3001\u8a8d\u8a3c\u30b9\u30c8\u30e9\u30c6\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$ npm install --save passpord-local\n```\n\n\u4ee5\u4e0b\u3092\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```js:app.js\nvar LocalStrategy = require('passport-local').Strategy;\npassport.use(new LocalStrategy(function(username, password, done){\n    // \u3053\u3053\u3067 username \u3068 password \u3092\u78ba\u8a8d\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059\n}));\n```\n\n\u7d50\u679c\u3092\u8fd4\u3059\u3068\u3053\u308d\u306f\u3001\n\n```js:\n    if (\u306a\u3093\u3089\u304b\u306e\u30a8\u30e9\u30fc) {\n        return done(\u30a8\u30e9\u30fc\u5185\u5bb9);\n    }\n    else if (\u5931\u6557) {\n        return done(null, false);\n    }\n    else if (\u6210\u529f) {\n        return done(null, username);\n    }\n```\n\n\u3053\u306e\u8fba\u306f [Passport | \u8a2d\u5b9a]\n(http://knimon-software.github.io/www.passportjs.org/guide/configure/) \u691c\u8a3c\u7528\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\n\n##\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u7528\u610f\u3059\u308b\n\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3001\u4f8b\u3048\u3070 login.html \u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n```html:login.html\n<form action=\"/login\" method=\"post\">\n    <div>\n        <label>\u30e6\u30fc\u30b6\u30fcID\uff1a</label>\n        <input type=\"text\" name=\"username\"/>\n    </div>\n    <div>\n        <label>\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a</label>\n        <input type=\"password\" name=\"password\"/>\n    </div>\n    <div>\n        <input type=\"submit\" value=\"\u30ed\u30b0\u30a4\u30f3\"/>\n    </div>\n</form>    \n```\n\n\u3053\u306e\u4f8b\u3067\u306f /login \u306b POST \u3057\u307e\u3059\u3002\n\n/login \u306b GET \u3059\u308b\u3068\u3053\u306e\u753b\u9762\u3092\u8868\u793a\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```js:app.js\napp.get('/login', function(req, res){\n    res.sendFile(__dirname + '/\u25c7\u25c7/login.html');\n});\n```\n\n##\u30ed\u30b0\u30a4\u30f3\u60c5\u5831\u3092\u53d7\u53d6\u3063\u3066\u8a8d\u8a3c\u51e6\u7406\u306b\u6e21\u3059\n\n/login \u306b POST \u3055\u308c\u305f\u3089\u3001\u305d\u306e\u60c5\u5831\u3092\u53d7\u53d6\u3063\u3066\u8a8d\u8a3c\u51e6\u7406\u306b\u6e21\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```\n$ npm install --save body-parser\n```\n\n```js:app.js\nvar bodyParser = require('body-parser');\napp.use(bodyParser.urlencoded({ extended: true });\n\napp.post('/login',\n    passport.authenticate('local'),\n    function(req, res){\n        // \u8a8d\u8a3c\u6210\u529f\u3059\u308b\u3068\u3053\u3053\u304c\u5b9f\u884c\u3055\u308c\u308b\n    }\n);\n```\n\n```passport.authenticate()``` \u306b\u306f\u3001```post()``` \u3067\u53d7\u3051\u53d6\u3063\u305f username \u3068 password \u304c\u6e21\u3055\u308c\u307e\u3059\u3002\u4e0a\u8a18\u3067\u6e96\u5099\u3057\u305f\u8a8d\u8a3c\u78ba\u8a8d\u3059\u308b\u51e6\u7406\u304c\u5b9f\u884c\u3055\u308c\u3001\u305d\u306e\u7d50\u679c\u304c\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u8fba\u307e\u3067\u306f [Passport | \u30e6\u30fc\u30b6\u30fcID & \u30d1\u30b9\u30ef\u30fc\u30c9]\n(http://knimon-software.github.io/www.passportjs.org/guide/username-password/)\n\n\u8a8d\u8a3c\u3059\u308b\u3068\u901a\u5e38\u306f\u30da\u30fc\u30b8\u9077\u79fb\u3057\u307e\u3059\u3002\n\n```js:app.js\napp.post('/login',\n    passport.authenticate('local'),\n    function(req, res){\n        res.redirect('/\u25c7\u25c7');\n```\n\n\u9077\u79fb\u5148\u306f\u30aa\u30d7\u30b7\u30e7\u30f3\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```js:app.js\napp.post('/login',\n    passport.authenticate('local', {\n        failureRedirect: '/\u25c6\u25c6',  // \u5931\u6557\u3057\u305f\u3068\u304d\u306e\u9077\u79fb\u5148\n        successRedirect: '/\u25c7\u25c7',  // \u6210\u529f\u3057\u305f\u3068\u304d\u306e\u9077\u79fb\u5148\n    }),\n```\n\n\u8a8d\u8a3c\u6210\u529f\u3057\u305f\u3068\u304d\u306f URL \u9077\u79fb\u305b\u305a\u306b\u51e6\u7406\u3059\u308b\u3053\u3068\u304c\u591a\u3044\u3067\u3057\u3087\u3046\u304b\u3002\n\n```js:app.js\napp.post('/login',\n    passport.authenticate('local', {\n        failureRedirect: '/\u25c6\u25c6',  // \u5931\u6557\u3057\u305f\u3068\u304d\u306e\u9077\u79fb\u5148\n    }),\n    function(req, res){\n        \u25c7\u25c7  // \u6210\u529f\u3057\u305f\u3068\u304d\u306e\u51e6\u7406\n```\n\n##\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u7121\u52b9\u306b\u3057\u3066\u4f7f\u3046\n\nPassport \u306f\u8a8d\u8a3c\u6210\u529f\u3057\u305f\u3068\u304d\u8a8d\u8a3c\u60c5\u5831\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002API \u30b5\u30fc\u30d0\u3068\u3057\u3066\u5b9f\u884c\u3059\u308b\u3068\u304d\u306f\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3054\u3068\u306b\u8a8d\u8a3c\u51e6\u7406\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u3068\u304d\u306f\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u7121\u52b9\u306b\u3057\u3066\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```js:app.js\napp.post('/login',\n    passport.authenticate('local', {\n        session: false,\n```\n\n\u3053\u306e\u8fba\u307e\u3067\u306f [Passport | \u8a8d\u8a3c]\n(http://knimon-software.github.io/www.passportjs.org/guide/authenticate/)\n\n##\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u6709\u52b9\u306b\u3057\u3066\u4f7f\u3046\n\nPassport \u306f\u8a8d\u8a3c\u6210\u529f\u3057\u305f\u3068\u304d\u8a8d\u8a3c\u60c5\u5831\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002Express \u3067\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```\n$ npm install --save express-session\n```\n\n```js:app.js\nvar session = require('express-session');\napp.use(session({\n    secret: '\u25cb\u25cb',\n}));\napp.use(passport.session());\n\npassport.serializeUser(function(user, done) {\n    done(null, user);\n});\n\npassport.deserializeUser(function(user, done) {\n    done(null, user);\n});\n```\n\n\u3053\u306e\u8fba\u306f [Passport | \u8a2d\u5b9a]\n(http://knimon-software.github.io/www.passportjs.org/guide/configure/) \u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\n\n##\u3069\u306e\u30da\u30fc\u30b8\u3067\u3082\u8a8d\u8a3c\u78ba\u8a8d\u3059\u308b\n\n\u3053\u308c\u307e\u3067\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916\u306e\u30da\u30fc\u30b8\u3067\u306f\u8a8d\u8a3c\u78ba\u8a8d\u3055\u308c\u307e\u305b\u3093\u3002\u3069\u306e\u30da\u30fc\u30b8\u3067\u3082\u8a8d\u8a3c\u78ba\u8a8d\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u307e\u305a\u3001\u30da\u30fc\u30b8\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8cb0\u3063\u305f\u3068\u304d\u8a8d\u8a3c\u6e08\u304b\u78ba\u8a8d\u3059\u308b\u95a2\u6570\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\n```js:app.js\nfunction isAuthenticated(req, res, next){\n    if (req.isAuthenticated()) {  // \u8a8d\u8a3c\u6e08\n        return next();\n    }\n    else {  // \u8a8d\u8a3c\u3055\u308c\u3066\u3044\u306a\u3044\n        res.redirect('/login');  // \u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\n    }\n}\n```\n\n\u30da\u30fc\u30b8\u3054\u3068\u306b\u78ba\u8a8d\u51e6\u7406\u3092\u5165\u308c\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\n\n```js:app.js\napp.get('/\u25c6\u25c6', isAuthenticated, function(req, res){\n    \u25c7\u25c7  // \u8a8d\u8a3c\u6e08\u306e\u3068\u304d\u5b9f\u884c\u3055\u308c\u308b\n```\n\n\u53c2\u8003 [express - Documentation for \"ensureAuthentication\" \"isAuthenticated\" passport's functions? - Stack Overflow]\n(http://stackoverflow.com/questions/14188834/documentation-for-ensureauthentication-isauthenticated-passports-functions)\n\n#\u304a\u308f\u308a\u306b\n\n\u3068\u308a\u3042\u3048\u305a Node.js\uff0bExpress\uff0bPassport \u3092\u4f7f\u3063\u3066\u3001\u30e6\u30fc\u30b6\uff29\uff24\uff06\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nPassport \u306f\u3001Facebook \u3084 Twitter \u3068\u9023\u643a\u3057\u305f\u8a8d\u8a3c\u3082\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u306e\u51e6\u7406\u3082\u7528\u610f\u3057\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002\n\u3053\u308c\u3089\u306b\u3064\u3044\u3066\u306f\u3001\u6539\u3081\u3066\u3002\n", "tags": ["Node.js", "JavaScirpt", "Express"]}