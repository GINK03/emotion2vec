{"context": " More than 1 year has passed since last update.\u91cd\u305f\u3044\u51e6\u7406\u306e\u9032\u6357\u3092\u628a\u63e1\u3057\u305f\u3044\u6642\u304c\u305f\u307e\u306b\u3042\u308b\n\u9032\u6357\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u7ba1\u7406\u3057\u3066\u7c21\u6613\u7684\u306b\u30b2\u30c3\u30c8\u3057\u3066\u307f\u308b\n\nPHP\u5074\n\nfoo.php\n<?php\n\nuse Fuel\\Core\\Session;\n\nclass Controller_Foo extends Controller_Rest\n{\n    // \u91cd\u305f\u3044\u30a2\u30af\u30b7\u30e7\u30f3\n    public function get_hevy()\n    {\n        // \u30d1\u30e9\u30e1\u30fc\u30bf\u521d\u671f\u5316\n        $progress = 0;          // \u9032\u6357\n        Session::delete('progress');    // \u30af\u30ea\u30a2\u3057\u3068\u304f\n\n        // \u30af\u30bd\u91cd\u305f\u3044\u51e6\u7406(1\u79d2\u9593\u306710%\u9032\u3080)\n        for ($i = 0; $i < 10; $i++) \n        {\n            $progress += 10;\n            Session::set('progress', $progress );   // \u9032\u6357\u30bb\u30c3\u30c8\n            Session::write();               // \u30b9\u30af\u30ea\u30d7\u30c8\u7d42\u4e86\u524d\u306b\u66f8\u304d\u8fbc\u307f\u2190\u91cd\u8981\n            sleep(1);\n        }\n\n        $this->response(['str' => 'complete!']);\n    }\n\n    // \u9032\u6357\u53d6\u5f97\u30a2\u30af\u30b7\u30e7\u30f3\n    public function get_progress()\n    {\n        $this->response(['progress' => Session::get('progress', 0)]);\n    }\n}\n\n\n\njavascript\u5074\n\nhoge.js\n$(function(){\n\n    // \u91cd\u3044\u51e6\u7406\u3092\u547c\u3073\u51fa\u3059\n    $.get('foo/hevy',function(data){\n\n        // \u7d50\u679c\u51fa\u529b\n        console.log(data.str);\n\n    }, \"json\");\n\n    // \u9032\u6357\u30921\u79d2\u9593\u9694\u3067\u547c\u3073\u51fa\u3059\n    progressInterval=setInterval(function(){\n\n        $.get('foo/progress',function(data){\n            // \u9032\u6357\u51fa\u529b\n            console.log(data.progress);// \u9032\u6357\u51fa\u529b\n\n            // 100\u306b\u306a\u3063\u305f\u3089\u7d42\u308f\u308a\n            if(data.progress >= 100) clearInterval(progressInterval);\n        }, \"json\");\n\n    } , 1000);\n});\n\n\n\u91cd\u305f\u3044\u51e6\u7406\u306e\u9032\u6357\u3092\u628a\u63e1\u3057\u305f\u3044\u6642\u304c\u305f\u307e\u306b\u3042\u308b\n\u9032\u6357\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u3067\u7ba1\u7406\u3057\u3066\u7c21\u6613\u7684\u306b\u30b2\u30c3\u30c8\u3057\u3066\u307f\u308b\n\n## PHP\u5074\n```php:foo.php\n<?php\n\nuse Fuel\\Core\\Session;\n\nclass Controller_Foo extends Controller_Rest\n{\n    // \u91cd\u305f\u3044\u30a2\u30af\u30b7\u30e7\u30f3\n    public function get_hevy()\n    {\n        // \u30d1\u30e9\u30e1\u30fc\u30bf\u521d\u671f\u5316\n        $progress = 0;\t\t\t// \u9032\u6357\n        Session::delete('progress');\t// \u30af\u30ea\u30a2\u3057\u3068\u304f\n\n        // \u30af\u30bd\u91cd\u305f\u3044\u51e6\u7406(1\u79d2\u9593\u306710%\u9032\u3080)\n        for ($i = 0; $i < 10; $i++) \n        {\n            $progress += 10;\n            Session::set('progress', $progress );\t// \u9032\u6357\u30bb\u30c3\u30c8\n            Session::write();\t\t\t\t// \u30b9\u30af\u30ea\u30d7\u30c8\u7d42\u4e86\u524d\u306b\u66f8\u304d\u8fbc\u307f\u2190\u91cd\u8981\n            sleep(1);\n        }\n\n        $this->response(['str' => 'complete!']);\n    }\n\n    // \u9032\u6357\u53d6\u5f97\u30a2\u30af\u30b7\u30e7\u30f3\n    public function get_progress()\n    {\n        $this->response(['progress' => Session::get('progress', 0)]);\n    }\n}\n```\n## javascript\u5074\n```javascript:hoge.js\n$(function(){\n\n    // \u91cd\u3044\u51e6\u7406\u3092\u547c\u3073\u51fa\u3059\n    $.get('foo/hevy',function(data){\n\n        // \u7d50\u679c\u51fa\u529b\n        console.log(data.str);\n\n    }, \"json\");\n\n    // \u9032\u6357\u30921\u79d2\u9593\u9694\u3067\u547c\u3073\u51fa\u3059\n    progressInterval=setInterval(function(){\n\n        $.get('foo/progress',function(data){\n            // \u9032\u6357\u51fa\u529b\n            console.log(data.progress);// \u9032\u6357\u51fa\u529b\n\n            // 100\u306b\u306a\u3063\u305f\u3089\u7d42\u308f\u308a\n            if(data.progress >= 100) clearInterval(progressInterval);\n        }, \"json\");\n\n    } , 1000);\n});\n```\n", "tags": ["FuelPHP", "JavaScript", "jQuery", "PHP"]}