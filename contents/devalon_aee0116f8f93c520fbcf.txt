{"context": "\n\nmongodb \u3067\u306e\u5168\u6587\u691c\u7d22\nmongodb\u3067\u65e5\u672c\u8a9e\u3067\u5168\u6587\u691c\u7d22\u3057\u305f\u3044\uff01\u3068\u601d\u3063\u3066\u3082\u3053\u308c\u304c\u6b8b\u5ff5\u306a\u304c\u3089\u672a\u3060\u975e\u5bfe\u5fdc\u3067\u3059\u3002\n\u53c2\u8003URL\n\u305d\u3053\u3067ElasticSearch \u30d7\u30e9\u30b0\u30a4\u30f3(MongoDB River + Kuromoji Analysis)\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nElasticSearch\u304b\u3089\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8272\u3005\u4f7f\u3063\u3066mongodb\u304b\u3089\u5168\u6587\u691c\u7d22\u3059\u308b\u611f\u3058\u3067\u3059\u3002\n\u305d\u306e\u305f\u3081\u306b\u3044\u308d\u3044\u308d\u3068\u30cf\u30de\u3063\u305f\u306e\u3067\u30e1\u30e2\u7684\u306b\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\u5fc5\u8981\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\nmongodb\nJDK (Java Development Kit)\nElasticSearch\n\nMongoDB River Plugin (\u30d7\u30e9\u30b0\u30a4\u30f3)(mongodb\u306e\u63a5\u7d9a\u7528)\n\nKuromoji Analysis Plugin (\u30d7\u30e9\u30b0\u30a4\u30f3)(\u65e5\u672c\u8a9e\u5f62\u614b\u7d20\u89e3\u6790)\n\n\u74b0\u5883\u306fCentOS 6.6 64bit \u3067\u3059\u3002\n\u4f55\u5ea6\u3082\u8a00\u3044\u307e\u3059\u304c\u3001mongodb\u3067\u65e5\u672c\u8a9e\u691c\u7d22\u304c\u51fa\u6765\u308c\u3070\u5fc5\u8981\u306a\u3044\u3082\u306e\u305f\u3061\u3067\u3059\u3002\n\nmongodb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n/etc/yum.repos.d/mongodb.repo\u3092\u4f5c\u6210\u3057\u3066\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3059\u308b\u3002\n[mongodb]\nname=MongoDB Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/\ngpgcheck=0\nenabled=1\n\nmongodb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nsudo yum install mongodb-org\n\nmongodb\u306e\u8d77\u52d5\nsudo yum service mongod start\n\n\nJDK \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo yum install java-1.7.0-openjdk\n\n\u554f\u984c\u306f\u3053\u3053\u304b\u3089\u3067\u3059\u3002\n\nElasticSearch\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6c7a\u3081\u308b\n\u304a\u305d\u3089\u304f\u73fe\u6642\u70b9\u3067\u306fmongodb\u306f2.6.8\u3042\u305f\u308a\u3060\u3068\u601d\u3046\u306e\u3067\u305d\u306e\u3064\u3082\u308a\u3067\u5404\u81ea\u9078\u629e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u4eca\u56de\u5229\u7528\u3059\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\n\n\nmongodb\nElasticSearch\nKuromoji Analysis Plugin\nMongoDB River Plugin\n\n\n2.6.8\n1.3.9\n2.3.0\n2.0.2\n\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u6c17\u306b\u305b\u305a\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3059\u308b\u3068\u306a\u305c\u304b\u52d5\u304b\u306a\u304b\u3063\u305f\u308a\u3057\u307e\u3059\u306e\u3067\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002\n\u30de\u30a4\u30ca\u30fc\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u9055\u3044\u304f\u3089\u3044\u3060\u3063\u305f\u3089\u306a\u3093\u3068\u304b\u306a\u308b\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4fdd\u8a3c\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u7121\u8996\u3057\u3066\u3084\u308b\u306e\u3082\u3044\u3044\u3067\u3059\u304c\u3001\u305d\u306e\u5834\u5408\u306f\u51fa\u6765\u308b\u9650\u308a\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3057\u305f\u65b9\u304c\u3044\u3044\u3067\u3059\u3002\n\u3057\u304b\u3057\u3001\u4f55\u5ea6\u3082\u8a00\u3044\u307e\u3059\u304c\u3001mongodb\u3067\u65e5\u672c\u8a9e\u691c\u7d22\u304c\u51fa\u6765\u308c\u3070\u5fc5\u8981\u306a\u3044\u3082\u306e\u305f\u3061\u3067\u3059\u3002\n\nElasticSearch1.3.x\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n/etc/yum.repos.d/elasticsearch.repo\u3092\u4f5c\u6210\u3057\u3066\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n[elasticsearch-1.3.x]\nname=Elasticsearch repository for 1.3.x packages\nbaseurl=http://packages.elasticsearch.org/elasticsearch/1.3/centos\ngpgcheck=1\ngpgkey=http://packages.elasticsearch.org/GPG-KEY-elasticsearch\nenabled=1\n\n\nElasticSearch\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo yum install elasticsearch\n\n\n\u3068\u308a\u3042\u3048\u305a\u8d77\u52d5\u3059\u308b\nsudo service elasticsearch\n\n\n\u8d77\u52d5\u78ba\u8a8d\ncurl -XGET 'localhost:9200'\n\n{\n  \"status\" : 200,\n  \"name\" : \"Zeitgeist\",\n  \"version\" : {\n    \"number\" : \"1.3.9\",\n    \"build_hash\" : \"0915c7306e6264ba21a6cb7609b93545ccc32ef1\",\n    \"build_timestamp\" : \"2015-02-19T12:34:48Z\",\n    \"build_snapshot\" : false,\n    \"lucene_version\" : \"4.9\"\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n\n\n\nMongoDB River Plugin 2.0.2 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo /usr/share/elasticsearch/bin/plugin --install com.github.richardwilly98.elasticsearch/elasticsearch-river-mongodb/2.0.2\n\n\nKuromoji Analysis Plugin 2.3.0\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo /usr/share/elasticsearch/bin/plugin --install elasticsearch/elasticsearch-analysis-kuromoji/2.3.0\n\n\n/etc/elasticsearch/elasticsearch.yml\u3092\u7de8\u96c6\nindex.analysis.analyzer.default.type: custom                    # \u8ffd\u52a0\nindex.analysis.analyzer.default.tokenizer: kuromoji_tokenizer   # \u8ffd\u52a0\n\n\nElasticSearch\u306e\u518d\u8d77\u52d5\nsudo service elasticsearch restart\n\n\u3075\u3045\u3001\u4f55\u5ea6\u3082\u8a00\u3044\u307e\u3059\u304c\u3001mongodb\u3067\u65e5\u672c\u8a9e\u691c\u7d22\u304c\u51fa\u6765\u308c\u3070\uff08\u7565\n\nmongodb\u3092\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3067\u69cb\u7bc9\u3059\u308b\n\n\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3068\u306f\n\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3068\u306f\u8907\u6570\u306emongodb\u3067\u30c7\u30fc\u30bf\u306e\u540c\u671f\u3068\u30b5\u30fc\u30d0\u306e\u5197\u9577\u5316\u3092\u884c\u3046\u6a5f\u80fd\u3067\u3059\u3002\nMySQL\u306e\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\u3002\nMongoDB River Plugin\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u3067\u3059\u304c\u3001\u30bb\u30ab\u30f3\u30c0\u30ea\u3092\u7528\u610f\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\netc/mongod.conf\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\nsudo vi /etc/mongod.conf \nreplSet = rs01 # \u6700\u5f8c\u306b\u8ffd\u8a18\n\n\nmongodb\u3067\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3092\u8a2d\u5b9a\u3059\u308b\nsudo service mongod restart\n\n\nmongod\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u3066\u5b9f\u884c\nmongo\nconfig = {_id: 'rs01', members: [{_id: 0, host: 'localhost:27017'}]};\nrs.initiate(config);\n\n\nmongodb\u306b\u30c7\u30fc\u30bf\u3092\u4f5c\u3063\u3066\u307f\u308b\n\nElasticSearch\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210\ncurl -XPUT 'http://localhost:9200/_river/mongodb/_meta' -d '{ \n    \"type\": \"mongodb\", \n    \"mongodb\": { \n      \"db\": \"testmongo\", \n      \"collection\": \"animal\"\n    }, \n    \"index\": {\n      \"name\": \"mongoindex\", \n      \"type\": \"animal\"  \n    }\n}'\n\n\nmongo\u3067\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\nmongo\n\nuse testmongo\n\nvar p = {name:\"\u30ad\u30c4\u30cd\"}\ndb.animal.save(p)\n\n\n\u52d5\u4f5c\u3092\u78ba\u8a8d\u3059\u308b\n\u691c\u7d22\u3059\u308b\u65e5\u672c\u8a9e\u3092UTF\u304b\u3089URL\u30a8\u30f3\u30b3\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u3067\u5909\u63db\u3059\u308b\u3068\u300c\u30ad\u30c4\u30cd\u300d\u306f %e3%82%ad%e3%83%84%e3%83%8d \u3067\u3059\u3002\nURL\u30a8\u30f3\u30b3\u30fc\u30c9\u30fb\u30c7\u30b3\u30fc\u30c9\u30d5\u30a9\u30fc\u30e0\n\n\u65e5\u672c\u8a9e\u3067\u691c\u7d22\u3057\u3066\u307f\u308b\ncurl -XGET 'http://localhost:9200/mongoindex/_search?q=name:%e3%82%ad%e3%83%84%e3%83%8d&pretty'\n\n{\n  \"took\" : 3,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1,\n    \"max_score\" : 0.30685282,\n    \"hits\" : [ {\n      \"_index\" : \"mongoindex\",\n      \"_type\" : \"animal\",\n      \"_id\" : \"55116bc107a66baa7b209026\",\n      \"_score\" : 0.30685282,\n      \"_source\":{\"_id\":\"55116bc107a66baa7b209026\",\"name\":\"\u30ad\u30c4\u30cd\"}\n    } ]\n  }\n}\n\n\u203b\u898b\u3065\u3089\u3044\u306e\u3067\u4e00\u756a\u5f8c\u308d\u306bpretty\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u7d42\u308f\u308a\n\u3053\u308c\u3067mongodb\u3067\u65e5\u672c\u8a9e\u5168\u6587\u691c\u7d22\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3002\u3002\u3002\u304a\u75b2\u308c\u69d8\u3067\u3059(\u00b4\u03c9`\uff1b)\n\u307e\u305f\u3059\u3067\u306b\u3042\u308bmongodb\u306e\u30c7\u30fc\u30bf\u304b\u3089\u65e5\u672c\u8a9e\u3067\u691c\u7d22\u3057\u305f\u3044\u5834\u5408\u306f\u3001\nElasticSearch\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210\u3059\u308b\u969b\u306bdb\u3068collection\u3068type\u3092\u5408\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\u307e\u305fElasticSearch\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u304c\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u3053\u3068\u306b\u306a\u3063\u305f\u3068\u304d\u306f\ncurl -XDELETE 'http://localhost:9200/*' \u3067\u5168\u90e8\u6d88\u305b\u307e\u3059\u3002\n\n\u906d\u9047\u3057\u305f\u30a8\u30e9\u30fc\n\u30d0\u30fc\u30b8\u30e7\u30f3\u7121\u8996\u3057\u3066\u5165\u308c\u3066\u3044\u305f\u3089\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\nCaused by: java.lang.ClassNotFoundException: org.elasticsearch.index.analysis.kuromojitokenizer.KuromojiTokenizerTokenizerFactory\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:425)\n    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:358)\n    at org.elasticsearch.common.settings.ImmutableSettings.loadClass(ImmutableSettings.java:469)\n    ... 18 more\n\u3082\u3046\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u524a\u9664\u30b3\u30de\u30f3\u30c9\u3059\u3089\u53d7\u3051\u4ed8\u3051\u306a\u3044\u306e\u3067\u3001\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u624b\u52d5\u3067\u30c7\u30fc\u30bf\u3092\u6d88\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002\nsudo rm -r /var/lib/elasticsearch\nmongodb\u3067\u65e5\u672c\u8a9e\u691c\u7d22\u304c\uff08\u7565\nmongodb\u3067\u3044\u3064\u304b\u65e5\u672c\u8a9e\u691c\u7d22\u304c\u3067\u304d\u308b\u3053\u3068\u3092\u9858\u3063\u3066\u304a\u308a\u307e\u3059(\u00b4\u03c9`)\uff42\n\n\u53c2\u8003URL\nhttp://cohakim.com/archives/5367\nhttps://github.com/richardwilly98/elasticsearch-river-mongodb\nhttps://github.com/elastic/elasticsearch-analysis-kuromoji\n\u305d\u3046\u3044\u3048\u3070Amazon Elasticsearch Service\u304c\u51fa\u307e\u3057\u305f\u306d\u3002\nQiita\u306e\u65b9\u304c\u826f\u3044\u3068\u601d\u3063\u305f\u306e\u3067\u3053\u3061\u3089\u306b\u79fb\u52d5\n\u5143\u8a18\u4e8b\n##mongodb \u3067\u306e\u5168\u6587\u691c\u7d22\nmongodb\u3067\u65e5\u672c\u8a9e\u3067\u5168\u6587\u691c\u7d22\u3057\u305f\u3044\uff01\u3068\u601d\u3063\u3066\u3082\u3053\u308c\u304c\u6b8b\u5ff5\u306a\u304c\u3089\u672a\u3060\u975e\u5bfe\u5fdc\u3067\u3059\u3002\n[\u53c2\u8003URL](http://docs.mongodb.org/manual/reference/text-search-languages/#text-search-languages)  \n\u305d\u3053\u3067ElasticSearch \u30d7\u30e9\u30b0\u30a4\u30f3(MongoDB River + Kuromoji Analysis)\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nElasticSearch\u304b\u3089\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8272\u3005\u4f7f\u3063\u3066mongodb\u304b\u3089\u5168\u6587\u691c\u7d22\u3059\u308b\u611f\u3058\u3067\u3059\u3002\n\n\u305d\u306e\u305f\u3081\u306b\u3044\u308d\u3044\u308d\u3068\u30cf\u30de\u3063\u305f\u306e\u3067\u30e1\u30e2\u7684\u306b\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\u5fc5\u8981\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\n* mongodb\n* JDK (Java Development Kit)\n* [ElasticSearch](https://www.elastic.co/)\n* [MongoDB River Plugin (\u30d7\u30e9\u30b0\u30a4\u30f3)](https://github.com/richardwilly98/elasticsearch-river-mongodb)(mongodb\u306e\u63a5\u7d9a\u7528)\n* [Kuromoji Analysis Plugin (\u30d7\u30e9\u30b0\u30a4\u30f3)](https://github.com/elastic/elasticsearch-analysis-kuromoji)(\u65e5\u672c\u8a9e\u5f62\u614b\u7d20\u89e3\u6790)\n\n\u74b0\u5883\u306fCentOS 6.6 64bit \u3067\u3059\u3002\n\n~~\u4f55\u5ea6\u3082\u8a00\u3044\u307e\u3059\u304c\u3001mongodb\u3067\u65e5\u672c\u8a9e\u691c\u7d22\u304c\u51fa\u6765\u308c\u3070\u5fc5\u8981\u306a\u3044\u3082\u306e\u305f\u3061\u3067\u3059\u3002~~\n\n##mongodb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n/etc/yum.repos.d/mongodb.repo\u3092\u4f5c\u6210\u3057\u3066\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n```\n[mongodb]\nname=MongoDB Repository\nbaseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/\ngpgcheck=0\nenabled=1\n```\n\n**mongodb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002**\n\n```\nsudo yum install mongodb-org\n```\n**mongodb\u306e\u8d77\u52d5**\n\n```\nsudo yum service mongod start\n```\n\n##JDK \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nsudo yum install java-1.7.0-openjdk\n```\n\n**\u554f\u984c**\u306f\u3053\u3053\u304b\u3089\u3067\u3059\u3002\n\n##ElasticSearch\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6c7a\u3081\u308b\n\n\u304a\u305d\u3089\u304f\u73fe\u6642\u70b9\u3067\u306fmongodb\u306f2.6.8\u3042\u305f\u308a\u3060\u3068\u601d\u3046\u306e\u3067\u305d\u306e\u3064\u3082\u308a\u3067\u5404\u81ea\u9078\u629e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n####\u4eca\u56de\u5229\u7528\u3059\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\n<table><tr><th>mongodb</th><th>ElasticSearch</th><th>Kuromoji Analysis Plugin</th><th>MongoDB River Plugin</th></tr><tr><td>2.6.8</td><td>1.3.9</td><td>2.3.0</td><td>2.0.2</td></tr></table>\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u6c17\u306b\u305b\u305a\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3059\u308b\u3068\u306a\u305c\u304b\u52d5\u304b\u306a\u304b\u3063\u305f\u308a\u3057\u307e\u3059\u306e\u3067\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002\n\u30de\u30a4\u30ca\u30fc\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u9055\u3044\u304f\u3089\u3044\u3060\u3063\u305f\u3089\u306a\u3093\u3068\u304b\u306a\u308b\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4fdd\u8a3c\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u7121\u8996\u3057\u3066\u3084\u308b\u306e\u3082\u3044\u3044\u3067\u3059\u304c\u3001\u305d\u306e\u5834\u5408\u306f\u51fa\u6765\u308b\u9650\u308a\u4e0b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3057\u305f\u65b9\u304c\u3044\u3044\u3067\u3059\u3002\n~~\u3057\u304b\u3057\u3001\u4f55\u5ea6\u3082\u8a00\u3044\u307e\u3059\u304c\u3001mongodb\u3067\u65e5\u672c\u8a9e\u691c\u7d22\u304c\u51fa\u6765\u308c\u3070\u5fc5\u8981\u306a\u3044\u3082\u306e\u305f\u3061\u3067\u3059\u3002~~\n\n##ElasticSearch1.3.x\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n### /etc/yum.repos.d/elasticsearch.repo\u3092\u4f5c\u6210\u3057\u3066\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n```\n[elasticsearch-1.3.x]\nname=Elasticsearch repository for 1.3.x packages\nbaseurl=http://packages.elasticsearch.org/elasticsearch/1.3/centos\ngpgcheck=1\ngpgkey=http://packages.elasticsearch.org/GPG-KEY-elasticsearch\nenabled=1\n```\n###ElasticSearch\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\nsudo yum install elasticsearch\n```\n### \u3068\u308a\u3042\u3048\u305a\u8d77\u52d5\u3059\u308b\n```\nsudo service elasticsearch\n```\n### \u8d77\u52d5\u78ba\u8a8d\n```\ncurl -XGET 'localhost:9200'\n```\n```\n{\n  \"status\" : 200,\n  \"name\" : \"Zeitgeist\",\n  \"version\" : {\n    \"number\" : \"1.3.9\",\n    \"build_hash\" : \"0915c7306e6264ba21a6cb7609b93545ccc32ef1\",\n    \"build_timestamp\" : \"2015-02-19T12:34:48Z\",\n    \"build_snapshot\" : false,\n    \"lucene_version\" : \"4.9\"\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n\n```\n\n##MongoDB River Plugin 2.0.2 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\nsudo /usr/share/elasticsearch/bin/plugin --install com.github.richardwilly98.elasticsearch/elasticsearch-river-mongodb/2.0.2\n```\n\n##Kuromoji Analysis Plugin 2.3.0\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n###\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\nsudo /usr/share/elasticsearch/bin/plugin --install elasticsearch/elasticsearch-analysis-kuromoji/2.3.0\n```\n### /etc/elasticsearch/elasticsearch.yml\u3092\u7de8\u96c6\n```\nindex.analysis.analyzer.default.type: custom\t\t\t\t\t# \u8ffd\u52a0\nindex.analysis.analyzer.default.tokenizer: kuromoji_tokenizer\t# \u8ffd\u52a0\n```\n\n##ElasticSearch\u306e\u518d\u8d77\u52d5\n\n```\nsudo service elasticsearch restart\n```\n~~\u3075\u3045\u3001\u4f55\u5ea6\u3082\u8a00\u3044\u307e\u3059\u304c\u3001mongodb\u3067\u65e5\u672c\u8a9e\u691c\u7d22\u304c\u51fa\u6765\u308c\u3070\uff08\u7565~~\n\n##mongodb\u3092\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3067\u69cb\u7bc9\u3059\u308b\n\n###\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3068\u306f\n\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3068\u306f\u8907\u6570\u306emongodb\u3067\u30c7\u30fc\u30bf\u306e\u540c\u671f\u3068\u30b5\u30fc\u30d0\u306e\u5197\u9577\u5316\u3092\u884c\u3046\u6a5f\u80fd\u3067\u3059\u3002\nMySQL\u306e\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\u3002\nMongoDB River Plugin\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u3067\u3059\u304c\u3001\u30bb\u30ab\u30f3\u30c0\u30ea\u3092\u7528\u610f\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n###etc/mongod.conf\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n```\nsudo vi /etc/mongod.conf \nreplSet = rs01 # \u6700\u5f8c\u306b\u8ffd\u8a18\n```\n###mongodb\u3067\u30ec\u30d7\u30ea\u30ab\u30bb\u30c3\u30c8\u3092\u8a2d\u5b9a\u3059\u308b\n```\nsudo service mongod restart\n```\n###mongod\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u3066\u5b9f\u884c\n```\nmongo\nconfig = {_id: 'rs01', members: [{_id: 0, host: 'localhost:27017'}]};\nrs.initiate(config);\n```\n\n##mongodb\u306b\u30c7\u30fc\u30bf\u3092\u4f5c\u3063\u3066\u307f\u308b\n\n### ElasticSearch\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210\n```\ncurl -XPUT 'http://localhost:9200/_river/mongodb/_meta' -d '{ \n\t\"type\": \"mongodb\", \n    \"mongodb\": { \n      \"db\": \"testmongo\", \n      \"collection\": \"animal\"\n    }, \n    \"index\": {\n      \"name\": \"mongoindex\", \n      \"type\": \"animal\"  \n    }\n}'\n```\n### mongo\u3067\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n```\nmongo\n\nuse testmongo\n\nvar p = {name:\"\u30ad\u30c4\u30cd\"}\ndb.animal.save(p)\n```\n\n### \u52d5\u4f5c\u3092\u78ba\u8a8d\u3059\u308b\n\u691c\u7d22\u3059\u308b\u65e5\u672c\u8a9e\u3092UTF\u304b\u3089URL\u30a8\u30f3\u30b3\u30fc\u30c9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u3067\u5909\u63db\u3059\u308b\u3068\u300c\u30ad\u30c4\u30cd\u300d\u306f %e3%82%ad%e3%83%84%e3%83%8d \u3067\u3059\u3002\n\n[URL\u30a8\u30f3\u30b3\u30fc\u30c9\u30fb\u30c7\u30b3\u30fc\u30c9\u30d5\u30a9\u30fc\u30e0](http://www.tagindex.com/tool/url.html)\n\n### \u65e5\u672c\u8a9e\u3067\u691c\u7d22\u3057\u3066\u307f\u308b\n```\ncurl -XGET 'http://localhost:9200/mongoindex/_search?q=name:%e3%82%ad%e3%83%84%e3%83%8d&pretty'\n\n{\n  \"took\" : 3,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1,\n    \"max_score\" : 0.30685282,\n    \"hits\" : [ {\n      \"_index\" : \"mongoindex\",\n      \"_type\" : \"animal\",\n      \"_id\" : \"55116bc107a66baa7b209026\",\n      \"_score\" : 0.30685282,\n      \"_source\":{\"_id\":\"55116bc107a66baa7b209026\",\"name\":\"\u30ad\u30c4\u30cd\"}\n    } ]\n  }\n}\n```\n\u203b\u898b\u3065\u3089\u3044\u306e\u3067\u4e00\u756a\u5f8c\u308d\u306bpretty\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u5165\u308c\u3066\u3044\u307e\u3059\u3002\n\n##\u7d42\u308f\u308a\n\n\u3053\u308c\u3067mongodb\u3067\u65e5\u672c\u8a9e\u5168\u6587\u691c\u7d22\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u3002\u3002\u3002\u304a\u75b2\u308c\u69d8\u3067\u3059(\u00b4\u03c9`\uff1b)\n\u307e\u305f\u3059\u3067\u306b\u3042\u308bmongodb\u306e\u30c7\u30fc\u30bf\u304b\u3089\u65e5\u672c\u8a9e\u3067\u691c\u7d22\u3057\u305f\u3044\u5834\u5408\u306f\u3001\nElasticSearch\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210\u3059\u308b\u969b\u306bdb\u3068collection\u3068type\u3092\u5408\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u307e\u305fElasticSearch\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u304c\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u3053\u3068\u306b\u306a\u3063\u305f\u3068\u304d\u306f\ncurl -XDELETE 'http://localhost:9200/*' \u3067\u5168\u90e8\u6d88\u305b\u307e\u3059\u3002\n\n##\u906d\u9047\u3057\u305f\u30a8\u30e9\u30fc\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u7121\u8996\u3057\u3066\u5165\u308c\u3066\u3044\u305f\u3089\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\nCaused by: java.lang.ClassNotFoundException: org.elasticsearch.index.analysis.kuromojitokenizer.KuromojiTokenizerTokenizerFactory\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:355)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:354)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:425)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:358)\n\tat org.elasticsearch.common.settings.ImmutableSettings.loadClass(ImmutableSettings.java:469)\n\t... 18 more\n\n\n\u3082\u3046\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u524a\u9664\u30b3\u30de\u30f3\u30c9\u3059\u3089\u53d7\u3051\u4ed8\u3051\u306a\u3044\u306e\u3067\u3001\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u624b\u52d5\u3067\u30c7\u30fc\u30bf\u3092\u6d88\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002\n\n`sudo rm -r /var/lib/elasticsearch`\n\n~~mongodb\u3067\u65e5\u672c\u8a9e\u691c\u7d22\u304c\uff08\u7565~~\nmongodb\u3067\u3044\u3064\u304b\u65e5\u672c\u8a9e\u691c\u7d22\u304c\u3067\u304d\u308b\u3053\u3068\u3092\u9858\u3063\u3066\u304a\u308a\u307e\u3059(\u00b4\u03c9`)\uff42\n\n##\u53c2\u8003URL\nhttp://cohakim.com/archives/5367\nhttps://github.com/richardwilly98/elasticsearch-river-mongodb\nhttps://github.com/elastic/elasticsearch-analysis-kuromoji\n\n\u305d\u3046\u3044\u3048\u3070Amazon Elasticsearch Service\u304c\u51fa\u307e\u3057\u305f\u306d\u3002\n\nQiita\u306e\u65b9\u304c\u826f\u3044\u3068\u601d\u3063\u305f\u306e\u3067\u3053\u3061\u3089\u306b\u79fb\u52d5\n[\u5143\u8a18\u4e8b](http://devalon.biz/elasticsearch/)\n", "tags": ["Elasticsearch", "MongoDB", "\u5168\u6587\u691c\u7d22"]}