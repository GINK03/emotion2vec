{"context": " More than 1 year has passed since last update.Gitlab 5.0\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb (CentOS 6.5)\n\u306e\u5f8c\u306b\u884c\u3063\u305f\u4f5c\u696d\u3067\u3059\u3002\n\nRequirements\n\nCentOS (Tested on 6.5)\nruby (Tested on 1.9.3)\n\n\nUpgrade\n\ngitlab\u30b5\u30fc\u30d0\u505c\u6b62\n\nsudo service gitlab stop\n\n\n\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n\nsu - git\ncd /home/git/gitlab\nmkdir /home/git/gitlab/public/uploads\nchown git:git /home/git/gitlab/public/uploads\nbundle exec rake gitlab:backup:create RAILS_ENV=production\n\n\n6.0\u306e\u30b3\u30fc\u30c9\u3092\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\n\ncd /home/git/gitlab\nsudo -u git -H git fetch\nsudo -u git -H git checkout 6-0-stable\n\n\ngitlab-shell\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\ncd /home/git/gitlab-shell\nsudo -u git -H git fetch\nsudo -u git -H git checkout v1.7.0\n\n\n\u8ffd\u52a0\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nsudo yum install -y python-docutils\n# ubuntu\u306e\u5834\u5408\n# apt-get install python-docutils\n\n\nGemfile\u3068Gemfile.lock\u3092\u66f8\u304d\u63db\u3048\n\nGemfile:136   \n-     gem \"modernizr\",        \"2.6.2\"\n+     gem \"modernizr-rails\",        \"2.7.1\"\n\nGemfile.lock:286\n-     modernizr (2.6.2)\n+     modernizr-rails (2.7.1)\n\nGemfile.lock:600\n-     modernizr (= 2.6.2)\n+     modernizr-rails (= 2.7.1)\n\n\n\u4f9d\u5b58gem\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\nsu - git\ncd /home/git/gitlab\nbundle install --deployment --without development test postgres\n\n\nDB\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\nbundle exec rake db:migrate RAILS_ENV=production\n\n\n\u30b0\u30eb\u30fc\u30d7\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\nbundle exec rake migrate_groups RAILS_ENV=production\n\n6.0\u3088\u308a\u30b0\u30ed\u30fc\u30d0\u30eb\u540d\u524d\u7a7a\u9593\u304c\u975e\u4e92\u63db\u306b\u306a\u3063\u305f\u306e\u3067\u30b0\u30ed\u30fc\u30d0\u30eb\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30b0\u30eb\u30fc\u30d7\u4ee5\u4e0b\u306e\u540d\u524d\u7a7a\u9593\u306b\u79fb\u52d5\u3059\u308b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u6240\u6709\u8005\u304c\u65e2\u306b\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u79fb\u52d5\u306f\u5931\u6557\u3059\u308b\u306e\u3067\u624b\u52d5\u3067\u3069\u3053\u304b\u306e\u540d\u524d\u7a7a\u9593\u4ee5\u4e0b\u306b\u79fb\u52d5\u3057\u3066\u304a\u304f\u3068\u3088\u3055\u305d\u3046\nbundle exec rake migrate_global_projects RAILS_ENV=production\n\n\n\u30d5\u30a3\u30f3\u30ac\u30fc\u30d7\u30ea\u30f3\u30c8\u3092DB\u5185\u306essh\u9375\u306b\u8ffd\u52a0\u3059\u308b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3(\u9375\u306e\u91cd\u8907\u3092\u9632\u3050\u305f\u3081\uff1f)\u3002\u3068\u308a\u3042\u3048\u305ano\u306b\u3057\u305f\u3051\u3069\u52d5\u3044\u305f\u3002\n\nbundle exec rake migrate_keys RAILS_ENV=production\n\n\nnote\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\nbundle exec rake migrate_inline_notes RAILS_ENV=production\n\n\ngitlab-satellites\u3092\u751f\u6210\u3057\u306a\u304a\u3059\u3002\u30b5\u30fc\u30d0\u79fb\u52d5\u6642\u306a\u3069\u307e\u3060\u751f\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u5b9f\u884c\u3002\n\nbundle exec rake gitlab:satellites:create RAILS_ENV=production\n\n\nredis\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u524a\u9664\n\nbundle exec rake cache:clear RAILS_ENV=production\n\n\n\u305d\u306e\u4ed6\n\nbundle exec rake assets:clean RAILS_ENV=production\nbundle exec rake assets:precompile RAILS_ENV=production\n\n\nconfig\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\ncd /home/git/gitlab/config\ncp gitlab.yml{,.bak} # \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\nrm gitlab.yml.example\nwget https://raw.github.com/gitlabhq/gitlabhq/6-0-stable/config/gitlab.yml.example\ncp gitlab.yml.example gitlab.yml\nvim gitlab.yml \n\n 16   gitlab:\n 17     ## Web server settings\n 18     host: gitlab.local.com //\u5909\u66f4\n 19     port: 80\n 20     https: false //https\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u5909\u66f4\n\n\nunicorn.rb\u306e\u5909\u66f4\n\ncd /home/git/gitlab/config\ncp unicorn.rb{,.bak}\nrm unicorn.rb.example\nwget https://raw.github.com/gitlabhq/gitlabhq/6-0-stable/config/unicorn.rb.example\ncp unicorn.rb.example unicorn.rb\n\n\n6.0\u7528\u306einit\u30b9\u30af\u30ea\u30d7\u30c8\u3092DL\n\ncurl --output /etc/init.d/gitlab https://raw.githubusercontent.com/gitlabhq/gitlabhq/6-0-stable/lib/support/init.d/gitlab\nchmod +x /etc/init.d/gitlab\n\n\n\u8d77\u52d5\n\nservice gitlab start\n\n\n\u30ed\u30b0\u78ba\u8a8d\n\ncd /home/git/gitlab/log\ntail -f *.log\n\n\ngitlab\u74b0\u5883\u306e\u78ba\u8a8d\n\nbundle exec rake gitlab:env:info RAILS_ENV=production\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\nbundle exec rake gitlab:check RAILS_ENV=production\n\n\n[Gitlab 5.0\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb (CentOS 6.5)](http://qiita.com/shufo/items/6fb1bd067ec7e5d47902)\n\n\u306e\u5f8c\u306b\u884c\u3063\u305f\u4f5c\u696d\u3067\u3059\u3002\n\n## Requirements\n\n- CentOS (Tested on 6.5)\n- ruby (Tested on 1.9.3)\n\n## Upgrade\n\n- gitlab\u30b5\u30fc\u30d0\u505c\u6b62\n\n```\nsudo service gitlab stop\n```\n\n- \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n\n```\nsu - git\ncd /home/git/gitlab\nmkdir /home/git/gitlab/public/uploads\nchown git:git /home/git/gitlab/public/uploads\nbundle exec rake gitlab:backup:create RAILS_ENV=production\n```\n\n- 6.0\u306e\u30b3\u30fc\u30c9\u3092\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\n\n```\ncd /home/git/gitlab\nsudo -u git -H git fetch\nsudo -u git -H git checkout 6-0-stable\n```\n\n- gitlab-shell\u3092\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n```\ncd /home/git/gitlab-shell\nsudo -u git -H git fetch\nsudo -u git -H git checkout v1.7.0\n```\n\n- \u8ffd\u52a0\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nsudo yum install -y python-docutils\n# ubuntu\u306e\u5834\u5408\n# apt-get install python-docutils\n```\n\n- Gemfile\u3068Gemfile.lock\u3092\u66f8\u304d\u63db\u3048\n\n```diff\nGemfile:136   \n-     gem \"modernizr\",        \"2.6.2\"\n+     gem \"modernizr-rails\",        \"2.7.1\"\n```\n\n```diff\nGemfile.lock:286\n-     modernizr (2.6.2)\n+     modernizr-rails (2.7.1)\n\nGemfile.lock:600\n-     modernizr (= 2.6.2)\n+     modernizr-rails (= 2.7.1)\n```\n\n- \u4f9d\u5b58gem\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\n\n```bash\nsu - git\ncd /home/git/gitlab\nbundle install --deployment --without development test postgres\n```\n\n- DB\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\n```\nbundle exec rake db:migrate RAILS_ENV=production\n```\n\n- \u30b0\u30eb\u30fc\u30d7\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\n```\nbundle exec rake migrate_groups RAILS_ENV=production\n```\n\n6.0\u3088\u308a\u30b0\u30ed\u30fc\u30d0\u30eb\u540d\u524d\u7a7a\u9593\u304c\u975e\u4e92\u63db\u306b\u306a\u3063\u305f\u306e\u3067\u30b0\u30ed\u30fc\u30d0\u30eb\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u30b0\u30eb\u30fc\u30d7\u4ee5\u4e0b\u306e\u540d\u524d\u7a7a\u9593\u306b\u79fb\u52d5\u3059\u308b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u6240\u6709\u8005\u304c\u65e2\u306b\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u79fb\u52d5\u306f\u5931\u6557\u3059\u308b\u306e\u3067\u624b\u52d5\u3067\u3069\u3053\u304b\u306e\u540d\u524d\u7a7a\u9593\u4ee5\u4e0b\u306b\u79fb\u52d5\u3057\u3066\u304a\u304f\u3068\u3088\u3055\u305d\u3046\n\n```\nbundle exec rake migrate_global_projects RAILS_ENV=production\n```\n\n- \u30d5\u30a3\u30f3\u30ac\u30fc\u30d7\u30ea\u30f3\u30c8\u3092DB\u5185\u306essh\u9375\u306b\u8ffd\u52a0\u3059\u308b\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3(\u9375\u306e\u91cd\u8907\u3092\u9632\u3050\u305f\u3081\uff1f)\u3002\u3068\u308a\u3042\u3048\u305ano\u306b\u3057\u305f\u3051\u3069\u52d5\u3044\u305f\u3002\n\n```\nbundle exec rake migrate_keys RAILS_ENV=production\n```\n\n- note\u306e\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\n```\nbundle exec rake migrate_inline_notes RAILS_ENV=production\n``` \n\n- gitlab-satellites\u3092\u751f\u6210\u3057\u306a\u304a\u3059\u3002\u30b5\u30fc\u30d0\u79fb\u52d5\u6642\u306a\u3069\u307e\u3060\u751f\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u5b9f\u884c\u3002\n\n```\nbundle exec rake gitlab:satellites:create RAILS_ENV=production\n```\n\n- redis\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u524a\u9664\n\n```\nbundle exec rake cache:clear RAILS_ENV=production\n```\n\n- \u305d\u306e\u4ed6\n\n```\nbundle exec rake assets:clean RAILS_ENV=production\nbundle exec rake assets:precompile RAILS_ENV=production\n```\n\n- config\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\n\n```\ncd /home/git/gitlab/config\ncp gitlab.yml{,.bak} # \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\nrm gitlab.yml.example\nwget https://raw.github.com/gitlabhq/gitlabhq/6-0-stable/config/gitlab.yml.example\ncp gitlab.yml.example gitlab.yml\nvim gitlab.yml \n \n 16   gitlab:\n 17     ## Web server settings\n 18     host: gitlab.local.com //\u5909\u66f4\n 19     port: 80\n 20     https: false //https\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u5909\u66f4\n```\n\n- unicorn.rb\u306e\u5909\u66f4\n\n```\ncd /home/git/gitlab/config\ncp unicorn.rb{,.bak}\nrm unicorn.rb.example\nwget https://raw.github.com/gitlabhq/gitlabhq/6-0-stable/config/unicorn.rb.example\ncp unicorn.rb.example unicorn.rb\n```\n\n- 6.0\u7528\u306einit\u30b9\u30af\u30ea\u30d7\u30c8\u3092DL\n\n```\ncurl --output /etc/init.d/gitlab https://raw.githubusercontent.com/gitlabhq/gitlabhq/6-0-stable/lib/support/init.d/gitlab\nchmod +x /etc/init.d/gitlab\n```\n\n- \u8d77\u52d5\n\n```\nservice gitlab start\n```\n\n- \u30ed\u30b0\u78ba\u8a8d\n\n```\ncd /home/git/gitlab/log\ntail -f *.log\n```\n\n- gitlab\u74b0\u5883\u306e\u78ba\u8a8d\n\n```\nbundle exec rake gitlab:env:info RAILS_ENV=production\n```\n\n- \u52d5\u4f5c\u78ba\u8a8d\n\n```\nbundle exec rake gitlab:check RAILS_ENV=production\n```\n", "tags": ["GitLab"]}