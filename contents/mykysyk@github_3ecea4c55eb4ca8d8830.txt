{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nDNS\u30b5\u30fc\u30d0\u30fc\u306equeries\u30ed\u30b0\u3092InfluxDB\u306b\u4fdd\u5b58\u3059\u308b\n\n\u691c\u8a3c\u74b0\u5883\n\n\n\n\u7528\u9014\nip\n\n\n\n\n\u30de\u30b9\u30bf\u30fcDNS\u30b5\u30fc\u30d0\u30fc\n192.168.24.101\n\n\n\u30b9\u30ec\u30fc\u30d6DNS\u30b5\u30fc\u30d0\u30fc\n192.168.24.102\n\n\nInfluxDB\u30b5\u30fc\u30d0\u30fc\n192.168.24.103\n\n\n\n\n\u4f5c\u696d\u5c65\u6b74\n\nbind \u306e queries\u30ed\u30b0\u3092syslog\u306b\u51fa\u529b\u3055\u305b\u308b\u8a2d\u5b9a\u3092\u5165\u308c\u308b\n\n/var/named/chroot/etc/named.conf\n\n    (\u7565)\n    logging {\n\n            channel \"syslog_local1\" {\n                syslog   local1;\n            };\n\n            category queries {\n                \"syslog_local1\";\n            };\n    };\n    (\u7565)\n\n\n\n\nbind(chroot\u74b0\u5883) \u306e queries \u30ed\u30b0\u3092 syslog \u3067 InfluxDB \u30b5\u30fc\u30d0\u30fc\u3078\u8ee2\u9001\u3059\u308b\n\nshell\ncat << EOF > /etc/rsyslog.d/bind_chroot.conf\n$AddUnixListenSocket /var/named/chroot/dev/log\nlocal1.*    @192.168.24.103:42185\nEOF\n/etc/init.d/rsyslog restart\n\n\n\nInfluxDB \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nshell\nrpm -ivh http://s3.amazonaws.com/influxdb/influxdb-latest-1.x86_64.rpm\n/etc/init.d/influxdb start\n\n\nhttp://192.168.24.103:8083/\n\nshell\niptables -A INPUT -p tcp -m multiport --dports 8083,8086,8090,8099 -s 127.0.0.1 -j ACCEPT\niptables -A INPUT -p tcp -m multiport --dports 8083,8086,8090,8099 -s 192.168.24.0/24 -j ACCEPT\niptables -A INPUT -p tcp -m multiport --dports 8083,8086,8090,8099 -j DROP\n\n\n\nshell\n#--- update cluster root password\ncurl -u root:root -X POST 'http://127.0.0.1:8086/cluster_admins/root' -d '{\"password\": \"****\"}'\n\n#--- create a database\ncurl -u root:**** -X POST 'http://127.0.0.1:8086/db' -d '{\"name\": \"named_log\"}'\n\n#--- add database user\ncurl -u root:**** -X POST 'http://127.0.0.1:8086/db/named_log/users' -d '{\"name\": \"fluent\", \"password\": \"****\"}'\n\n\n#--- create a database\ncurl -u root:**** -X POST 'http://127.0.0.1:8086/db' -d '{\"name\": \"grafana\"}'\n\n#--- add database user\ncurl -u root:**** -X POST 'http://127.0.0.1:8086/db/named_log/users' -d '{\"name\": \"grafana\", \"password\": \"****\"}'\n\n\n\nFluent \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nshell\ncurl -L http://toolbelt.treasuredata.com/sh/install-redhat.sh | sh\niptables -A INPUT -s 192.168.24.101 -p udp --dport 42185 -j ACCEPT\niptables -A INPUT -s 192.168.24.102 -p udp --dport 42185 -j ACCEPT\niptables -A INPUT -p udp --dport 42185 -j DROP\nmkdir -p /etc/td-agent/conf.d\n\n\n\nFluent \u306e plugin \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nshell\nyum install geoip-devel --enablerepo=epel\n/usr/lib64/fluent/ruby/bin/gem install fluent-plugin-geoip\n/usr/lib64/fluent/ruby/bin/gem install fluent-plugin-flatten-hash\n/usr/lib64/fluent/ruby/bin/gem install fluent-plugin-influxdb\n\n\n\nshell\necho 'include conf.d/*.conf' > /etc/td-agent/td-agent.conf\nvi /etc/td-agent/conf.d/bind_queries.conf\n\n\n\n\n/etc/td-agent/conf.d/bind_queries.conf\n```conf:/etc/td-agent/conf.d/bind_queries.conf\n#----------------------------------------------------------\n# \u5404DNS\u30b5\u30fc\u30d0\u30fc\u306ersyslog \u304b\u3089 \u306e\u30ed\u30b0\u3092\u53d6\u5f97\u3059\u308b\u51e6\u7406\n# local1.info -> syslog:42185 -> named.syslog.local1.info\n#----------------------------------------------------------\n<source>\n    type syslog\n    port 42185\n    tag  named.syslog\n</source>\n\n#----------------------------------------------------------\n# \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u51e6\u7406\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-flatten-hash\n#----------------------------------------------------------\n<match named.syslog.local1.info>\n\n    type copy\n\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    #<store>\n    #    type stdout\n    #</store>\n\n    #----------------------------------------------------------\n    # \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0 \u3057\u3066 \u30bf\u30b0\u3092\u5207\u308a\u66ff\u3048\u308b\n    # named.syslog.*.* -> named.filtered\n    #----------------------------------------------------------\n    <store>\n        type            rewrite\n        remove_prefix   named.syslog.local1.info\n        add_prefix      named.filtered\n\n        #--- QUERY\n        <rule>\n            key         message\n            pattern     client ([.0-9]+).[0-9]*: view ([^ ]*): [^ ]* ([^ ]*) ([^ ]* [^ ]* [^ ]*) \\(([.0-9:]+)\\)\n            replace     {\"log_type\":\"QUERY\", \"src\":\"\\1\",\"view\":\"\\2\",\"fqdn\":\"\\3\",\"class_type\":\"\\4\",\"dst\":\"\\5\"}\n            last        true\n        </rule>\n\n        #--- \u30d1\u30bf\u30fc\u30f3\u306b\u30de\u30c3\u30c1\u3057\u306a\u3044\u3082\u306e\u306f\u6368\u3066\u308b\n        <rule>\n            key         message\n            pattern     .*\n            ignore      true\n        </rule>\n    </store>\n\n</match>\n\n#----------------------------------------------------------\n# JSON \u51e6\u7406\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-parser\n#----------------------------------------------------------\n<match named.filtered>\n\n    type copy\n\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    #<store>\n    #    type stdout\n    #</store>\n\n    #----------------------------------------------------------\n    # message \u90e8\u5206\u3092 JSON\u5316 \u3057\u3066 \u30bf\u30b0\u3092\u5207\u308a\u66ff\u3048\u308b\n    # named.filtered -> named.json\n    #----------------------------------------------------------\n    <store>\n        type            parser\n        tag             named.json\n        key_name        message\n        format          json\n        #reserve_data    yes\n    </store>\n</match>\n\n#----------------------------------------------------------\n# GEO IP \u51e6\u7406\n# yum install geoip-devel --enablerepo=epel\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-geoip\n#----------------------------------------------------------\n<match named.json>\n\n    type copy\n\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    #<store>\n    #    type stdout\n    #</store>\n\n    #----------------------------------------------------------\n    # SRC IP \u306b \u56fd\u5225\u30b3\u30fc\u30c9\u306e\u4ed8\u4e0e \u3057\u3066 \u30bf\u30b0\u3092\u5207\u308a\u66ff\u3048\u308b\n    # named.json -> named.geoip-log\n    #----------------------------------------------------------\n    <store>\n        type                geoip\n        geoip_lookup_key    src\n\n        <record>\n            country         ${country_code['src']}\n        </record>\n\n        tag                 named.geoip-log\n        log_level           debug\n        flush_interval      1s\n    </store>\n</match>\n\n#----------------------------------------------------------\n# JSON \u30d5\u30e9\u30c3\u30c8\u5316\u51e6\u7406\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-flatten-hash\n#----------------------------------------------------------\n<match named.geoip-log>\n\n    type copy\n\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    #<store>\n    #    type stdout\n    #</store>\n\n    #----------------------------------------------------------\n    # \u30cd\u30b9\u30c8\u3057\u305fJSON\u3092\u3044\u3044\u611f\u3058\u306b\u30d5\u30e9\u30c3\u30c8\u5316\u3059\u308b\n    # syslog.named -> named.flat-log\n    #----------------------------------------------------------\n    <store>\n        type flatten_hash\n        tag  named.flat-log\n        separator _\n    </store>\n</match>\n\n#----------------------------------------------------------\n# Elasticsearch \u306b\u767b\u9332\u3059\u308b\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-elasticsearch\n#----------------------------------------------------------\n<match named.flat-log>\n\n    type copy\n\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    <store>\n        type stdout\n    </store>\n</match>\n\n#----------------------------------------------------------\n# named.flat-log -> influxdb[:8086]\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-influxdb\n#----------------------------------------------------------\n<match named.flat-log>\n    type           influxdb\n    host           localhost\n    port           8086\n    dbname         named_log\n    user           fluent\n    password       ****\n    time_precision s\n    flush_interval 1s\n</match>\n\n\n\n\nshell\n/etc/init.d/td-agent start\n\n\n\nGrafana \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nshell\nwget http://grafanarel.s3.amazonaws.com/grafana-1.9.1.tar.gz\ntar zxvf grafana-1.9.1.tar.gz\ncd grafana-1.9.1\ncp -av config.sample.js config.js\nvi config.js\n\n\n\n\nconfig.js\n// == Configuration\n// config.js is where you will find the core Grafana configuration. This file contains parameter that\n// must be set before Grafana is run for the first time.\n\ndefine(['settings'], function(Settings) {\n\n  return new Settings({\n\n      /* Data sources\n      * ========================================================\n      * Datasources are used to fetch metrics, annotations, and serve as dashboard storage\n      *  - You can have multiple of the same type.\n      *  - grafanaDB: true    marks it for use for dashboard storage\n      *  - default: true      marks the datasource as the default metric source (if you have multiple)\n      *  - basic authentication: use url syntax http://username:password@domain:port\n      */\n\n      // InfluxDB example setup (the InfluxDB databases specified need to exist)\n      datasources: {\n        influxdb: {\n          type: 'influxdb',\n          url: \"http://192.168.24.103:8086/db/named_log\",\n          username: 'fluent',\n          password: '****',\n        },\n        grafana: {\n          type: 'influxdb',\n          url: \"http://192.168.24.103:8086/db/grafana\",\n          username: 'grafana',\n          password: '****',\n          grafanaDB: true\n        },\n      },\n\n      // Graphite & Elasticsearch example setup\n      /*\n      datasources: {\n        graphite: {\n          type: 'graphite',\n          url: \"http://my.graphite.server.com:8080\",\n        },\n        elasticsearch: {\n          type: 'elasticsearch',\n          url: \"http://my.elastic.server.com:9200\",\n          index: 'grafana-dash',\n          grafanaDB: true,\n        }\n      },\n      */\n\n      // OpenTSDB & Elasticsearch example setup\n      /*\n      datasources: {\n        opentsdb: {\n          type: 'opentsdb',\n          url: \"http://opentsdb.server:4242\",\n        },\n        elasticsearch: {\n          type: 'elasticsearch',\n          url: \"http://my.elastic.server.com:9200\",\n          index: 'grafana-dash',\n          grafanaDB: true,\n        }\n      },\n      */\n\n      /* Global configuration options\n      * ========================================================\n      */\n\n      // specify the limit for dashboard search results\n      search: {\n        max_results: 100\n      },\n\n      // default home dashboard\n      default_route: '/dashboard/file/default.json',\n\n      // set to false to disable unsaved changes warning\n      unsaved_changes_warning: true,\n\n      // set the default timespan for the playlist feature\n      // Example: \"1m\", \"1h\"\n      playlist_timespan: \"1m\",\n\n      // If you want to specify password before saving, please specify it below\n      // The purpose of this password is not security, but to stop some users from accidentally changing dashboards\n      admin: {\n        password: ''\n      },\n\n      // Change window title prefix from 'Grafana - <dashboard title>'\n      window_title_prefix: 'Grafana - ',\n\n      // Add your own custom panels\n      plugins: {\n        // list of plugin panels\n        panels: [],\n        // requirejs modules in plugins folder that should be loaded\n        // for example custom datasources\n        dependencies: [],\n      }\n\n    });\n});\n\n\n\nshell\npython -m SimpleHTTPServer 9000\n\n\nhttp://192.168.24.103:9000/\n\n## \u6982\u8981\n\nDNS\u30b5\u30fc\u30d0\u30fc\u306equeries\u30ed\u30b0\u3092InfluxDB\u306b\u4fdd\u5b58\u3059\u308b\n\n## \u691c\u8a3c\u74b0\u5883\n\n| \u7528\u9014                | ip             |\n|:--                  |:--             |\n| \u30de\u30b9\u30bf\u30fcDNS\u30b5\u30fc\u30d0\u30fc | 192.168.24.101 |\n| \u30b9\u30ec\u30fc\u30d6DNS\u30b5\u30fc\u30d0\u30fc | 192.168.24.102 |\n| InfluxDB\u30b5\u30fc\u30d0\u30fc    | 192.168.24.103 |\n\n## \u4f5c\u696d\u5c65\u6b74\n### bind \u306e queries\u30ed\u30b0\u3092syslog\u306b\u51fa\u529b\u3055\u305b\u308b\u8a2d\u5b9a\u3092\u5165\u308c\u308b\n\n```shell:/var/named/chroot/etc/named.conf\n\n\t(\u7565)\n\tlogging {\n\n\t        channel \"syslog_local1\" {\n\t        \tsyslog   local1;\n\t        };\n\n\t        category queries {\n\t            \"syslog_local1\";\n\t        };\n\t};\n\t(\u7565)\n\n```\n\n### bind(chroot\u74b0\u5883) \u306e queries \u30ed\u30b0\u3092 syslog \u3067 InfluxDB \u30b5\u30fc\u30d0\u30fc\u3078\u8ee2\u9001\u3059\u308b\n\n```shell:shell\ncat << EOF > /etc/rsyslog.d/bind_chroot.conf\n$AddUnixListenSocket /var/named/chroot/dev/log\nlocal1.*    @192.168.24.103:42185\nEOF\n/etc/init.d/rsyslog restart\n```\n\n### InfluxDB \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell:shell\nrpm -ivh http://s3.amazonaws.com/influxdb/influxdb-latest-1.x86_64.rpm\n/etc/init.d/influxdb start\n```\n\nhttp://192.168.24.103:8083/\n\n```shell:shell\niptables -A INPUT -p tcp -m multiport --dports 8083,8086,8090,8099 -s 127.0.0.1 -j ACCEPT\niptables -A INPUT -p tcp -m multiport --dports 8083,8086,8090,8099 -s 192.168.24.0/24 -j ACCEPT\niptables -A INPUT -p tcp -m multiport --dports 8083,8086,8090,8099 -j DROP\n```\n\n```shell:shell\n#--- update cluster root password\ncurl -u root:root -X POST 'http://127.0.0.1:8086/cluster_admins/root' -d '{\"password\": \"****\"}'\n\n#--- create a database\ncurl -u root:**** -X POST 'http://127.0.0.1:8086/db' -d '{\"name\": \"named_log\"}'\n\n#--- add database user\ncurl -u root:**** -X POST 'http://127.0.0.1:8086/db/named_log/users' -d '{\"name\": \"fluent\", \"password\": \"****\"}'\n\n\n#--- create a database\ncurl -u root:**** -X POST 'http://127.0.0.1:8086/db' -d '{\"name\": \"grafana\"}'\n\n#--- add database user\ncurl -u root:**** -X POST 'http://127.0.0.1:8086/db/named_log/users' -d '{\"name\": \"grafana\", \"password\": \"****\"}'\n```\n\n### Fluent \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell:shell\ncurl -L http://toolbelt.treasuredata.com/sh/install-redhat.sh | sh\niptables -A INPUT -s 192.168.24.101 -p udp --dport 42185 -j ACCEPT\niptables -A INPUT -s 192.168.24.102 -p udp --dport 42185 -j ACCEPT\niptables -A INPUT -p udp --dport 42185 -j DROP\nmkdir -p /etc/td-agent/conf.d\n```\n### Fluent \u306e plugin \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell:shell\nyum install geoip-devel --enablerepo=epel\n/usr/lib64/fluent/ruby/bin/gem install fluent-plugin-geoip\n/usr/lib64/fluent/ruby/bin/gem install fluent-plugin-flatten-hash\n/usr/lib64/fluent/ruby/bin/gem install fluent-plugin-influxdb\n```\n\n```shell:shell\necho 'include conf.d/*.conf' > /etc/td-agent/td-agent.conf\nvi /etc/td-agent/conf.d/bind_queries.conf\n```\n>\n```conf:/etc/td-agent/conf.d/bind_queries.conf\n```conf:/etc/td-agent/conf.d/bind_queries.conf\n#----------------------------------------------------------\n# \u5404DNS\u30b5\u30fc\u30d0\u30fc\u306ersyslog \u304b\u3089 \u306e\u30ed\u30b0\u3092\u53d6\u5f97\u3059\u308b\u51e6\u7406\n# local1.info -> syslog:42185 -> named.syslog.local1.info\n#----------------------------------------------------------\n<source>\n    type syslog\n    port 42185\n    tag  named.syslog\n</source>\n>\n#----------------------------------------------------------\n# \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u51e6\u7406\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-flatten-hash\n#----------------------------------------------------------\n<match named.syslog.local1.info>\n>\n    type copy\n>\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    #<store>\n    #    type stdout\n    #</store>\n>\n    #----------------------------------------------------------\n    # \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0 \u3057\u3066 \u30bf\u30b0\u3092\u5207\u308a\u66ff\u3048\u308b\n    # named.syslog.*.* -> named.filtered\n    #----------------------------------------------------------\n    <store>\n        type            rewrite\n        remove_prefix   named.syslog.local1.info\n        add_prefix      named.filtered\n>\n        #--- QUERY\n        <rule>\n            key         message\n            pattern     client ([.0-9]+).[0-9]*: view ([^ ]*): [^ ]* ([^ ]*) ([^ ]* [^ ]* [^ ]*) \\(([.0-9:]+)\\)\n            replace     {\"log_type\":\"QUERY\", \"src\":\"\\1\",\"view\":\"\\2\",\"fqdn\":\"\\3\",\"class_type\":\"\\4\",\"dst\":\"\\5\"}\n            last        true\n        </rule>\n>\n        #--- \u30d1\u30bf\u30fc\u30f3\u306b\u30de\u30c3\u30c1\u3057\u306a\u3044\u3082\u306e\u306f\u6368\u3066\u308b\n        <rule>\n            key         message\n            pattern     .*\n            ignore      true\n        </rule>\n    </store>\n>\n</match>\n>\n#----------------------------------------------------------\n# JSON \u51e6\u7406\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-parser\n#----------------------------------------------------------\n<match named.filtered>\n>\n    type copy\n>\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    #<store>\n    #    type stdout\n    #</store>\n>\n    #----------------------------------------------------------\n    # message \u90e8\u5206\u3092 JSON\u5316 \u3057\u3066 \u30bf\u30b0\u3092\u5207\u308a\u66ff\u3048\u308b\n    # named.filtered -> named.json\n    #----------------------------------------------------------\n    <store>\n        type            parser\n        tag             named.json\n        key_name        message\n        format          json\n        #reserve_data    yes\n    </store>\n</match>\n>\n#----------------------------------------------------------\n# GEO IP \u51e6\u7406\n# yum install geoip-devel --enablerepo=epel\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-geoip\n#----------------------------------------------------------\n<match named.json>\n>\n    type copy\n>\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    #<store>\n    #    type stdout\n    #</store>\n>\n    #----------------------------------------------------------\n    # SRC IP \u306b \u56fd\u5225\u30b3\u30fc\u30c9\u306e\u4ed8\u4e0e \u3057\u3066 \u30bf\u30b0\u3092\u5207\u308a\u66ff\u3048\u308b\n    # named.json -> named.geoip-log\n    #----------------------------------------------------------\n    <store>\n        type                geoip\n        geoip_lookup_key    src\n>\n        <record>\n            country         ${country_code['src']}\n        </record>\n>\n        tag                 named.geoip-log\n        log_level           debug\n        flush_interval      1s\n    </store>\n</match>\n>\n#----------------------------------------------------------\n# JSON \u30d5\u30e9\u30c3\u30c8\u5316\u51e6\u7406\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-flatten-hash\n#----------------------------------------------------------\n<match named.geoip-log>\n>\n    type copy\n>\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    #<store>\n    #    type stdout\n    #</store>\n>\n    #----------------------------------------------------------\n    # \u30cd\u30b9\u30c8\u3057\u305fJSON\u3092\u3044\u3044\u611f\u3058\u306b\u30d5\u30e9\u30c3\u30c8\u5316\u3059\u308b\n    # syslog.named -> named.flat-log\n    #----------------------------------------------------------\n    <store>\n        type flatten_hash\n        tag  named.flat-log\n        separator _\n    </store>\n</match>\n>\n#----------------------------------------------------------\n# Elasticsearch \u306b\u767b\u9332\u3059\u308b\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-elasticsearch\n#----------------------------------------------------------\n<match named.flat-log>\n>\n    type copy\n>\n    #----------------------------------------------------------\n    # \u30c6\u30b9\u30c8\u51fa\u529b\n    #----------------------------------------------------------\n    <store>\n        type stdout\n    </store>\n</match>\n>\n#----------------------------------------------------------\n# named.flat-log -> influxdb[:8086]\n# /usr/lib64/fluent/ruby/bin/gem install fluent-plugin-influxdb\n#----------------------------------------------------------\n<match named.flat-log>\n    type           influxdb\n    host           localhost\n    port           8086\n    dbname         named_log\n    user           fluent\n    password       ****\n    time_precision s\n    flush_interval 1s\n</match>\n```\n\n```shell:shell\n/etc/init.d/td-agent start\n```\n\n### Grafana \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```shell:shell\nwget http://grafanarel.s3.amazonaws.com/grafana-1.9.1.tar.gz\ntar zxvf grafana-1.9.1.tar.gz\ncd grafana-1.9.1\ncp -av config.sample.js config.js\nvi config.js\n```\n>\n```js:config.js\n// == Configuration\n// config.js is where you will find the core Grafana configuration. This file contains parameter that\n// must be set before Grafana is run for the first time.\n>\ndefine(['settings'], function(Settings) {\n>\n  return new Settings({\n>\n      /* Data sources\n      * ========================================================\n      * Datasources are used to fetch metrics, annotations, and serve as dashboard storage\n      *  - You can have multiple of the same type.\n      *  - grafanaDB: true    marks it for use for dashboard storage\n      *  - default: true      marks the datasource as the default metric source (if you have multiple)\n      *  - basic authentication: use url syntax http://username:password@domain:port\n      */\n>\n      // InfluxDB example setup (the InfluxDB databases specified need to exist)\n      datasources: {\n        influxdb: {\n          type: 'influxdb',\n          url: \"http://192.168.24.103:8086/db/named_log\",\n          username: 'fluent',\n          password: '****',\n        },\n        grafana: {\n          type: 'influxdb',\n          url: \"http://192.168.24.103:8086/db/grafana\",\n          username: 'grafana',\n          password: '****',\n          grafanaDB: true\n        },\n      },\n>\n      // Graphite & Elasticsearch example setup\n      /*\n      datasources: {\n        graphite: {\n          type: 'graphite',\n          url: \"http://my.graphite.server.com:8080\",\n        },\n        elasticsearch: {\n          type: 'elasticsearch',\n          url: \"http://my.elastic.server.com:9200\",\n          index: 'grafana-dash',\n          grafanaDB: true,\n        }\n      },\n      */\n>\n      // OpenTSDB & Elasticsearch example setup\n      /*\n      datasources: {\n        opentsdb: {\n          type: 'opentsdb',\n          url: \"http://opentsdb.server:4242\",\n        },\n        elasticsearch: {\n          type: 'elasticsearch',\n          url: \"http://my.elastic.server.com:9200\",\n          index: 'grafana-dash',\n          grafanaDB: true,\n        }\n      },\n      */\n>\n      /* Global configuration options\n      * ========================================================\n      */\n>\n      // specify the limit for dashboard search results\n      search: {\n        max_results: 100\n      },\n>\n      // default home dashboard\n      default_route: '/dashboard/file/default.json',\n>\n      // set to false to disable unsaved changes warning\n      unsaved_changes_warning: true,\n>\n      // set the default timespan for the playlist feature\n      // Example: \"1m\", \"1h\"\n      playlist_timespan: \"1m\",\n>\n      // If you want to specify password before saving, please specify it below\n      // The purpose of this password is not security, but to stop some users from accidentally changing dashboards\n      admin: {\n        password: ''\n      },\n>\n      // Change window title prefix from 'Grafana - <dashboard title>'\n      window_title_prefix: 'Grafana - ',\n>\n      // Add your own custom panels\n      plugins: {\n        // list of plugin panels\n        panels: [],\n        // requirejs modules in plugins folder that should be loaded\n        // for example custom datasources\n        dependencies: [],\n      }\n>\n    });\n});\n```\n```shell:shell\npython -m SimpleHTTPServer 9000\n```\nhttp://192.168.24.103:9000/\n", "tags": ["CentOS6.6", "bind9.8.2", "grafana1.9.1", "fluentd0.10.55", "influxdb0.8.8"]}