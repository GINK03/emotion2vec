{"context": " More than 1 year has passed since last update.rsync\u3067\u6bce\u65e5\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u305f\u3044\u3002\n\u305d\u3093\u306a\u3042\u306a\u305f\u306b\u3002\n\n\u8981\u7d04\n\u6bce\u65e5rsync\u3057\u3066zip\u3067\u30a2\u30fc\u30ab\u30a4\u30d6\u3059\u308b\u3002\n\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306f\u3053\u3093\u306a\u611f\u3058\u3002\nbackup/\n|-- 20151120.zip\n|-- 20151121.zip\n|-- 20151122.zip\n`-- 20151123.zip\n\n\n\u65b9\u6cd5\n\u4ee5\u4e0b\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30b9\u30af\u30ea\u30d7\u30c8\u3002\n/path/to\u306a\u7b87\u6240\u3092\u66f8\u304d\u63db\u3048\u308b\u3002\nsrc_dir: \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5143\u3002ssh\u5148\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7OK\u3002(\u4f8b: hoge.com:/path/to/dir )\ndest_dir: \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5148\n#/bin/sh\n\nsrc_dir=\"/path/to/dir\"\ndest_dir=\"/path/to/dir\"\n\nbackup_dir=`date +'%Y%m%d'`\n\nmkdir -p ${dest_dir}/${backup_dir}\nrsync -a ${src_dir} ${dest_dir}/${backup_dir}\n\n# zip archive\ncd ${dest_dir} && zip -rm ${backup_dir}.zip ${backup_dir}\n\n\n\u5b9a\u671f\u5b9f\u884c\n\u6bce\u65e5\u5b9f\u884c\u3059\u308b\u306a\u3089 /etc/crontab \u306b\u3067\u3082\u66f8\u3044\u3066\u304a\u3053\u3046\u3002\n# everyday backup at 22:10\n10 22 * * * root /path/to/basic_backup.sh >> /path/to/backup.log\n\n\n\u53c2\u7167\ngist\u3082\u7f6e\u3044\u3066\u304a\u3044\u305f\u304b\u3089\u81ea\u7531\u306b\u4f7f\u3063\u3066\u306d\uff01\nhttps://gist.github.com/Yuji-Kuroko/e585859307f7477c6447\nrsync\u3067\u6bce\u65e5\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u305f\u3044\u3002\n\u305d\u3093\u306a\u3042\u306a\u305f\u306b\u3002\n\n## \u8981\u7d04\n\n\u6bce\u65e5rsync\u3057\u3066zip\u3067\u30a2\u30fc\u30ab\u30a4\u30d6\u3059\u308b\u3002\n\u30d5\u30a9\u30eb\u30c0\u968e\u5c64\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n```\nbackup/\n|-- 20151120.zip\n|-- 20151121.zip\n|-- 20151122.zip\n`-- 20151123.zip\n```\n\n### \u65b9\u6cd5\n\n\u4ee5\u4e0b\u3001\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30b9\u30af\u30ea\u30d7\u30c8\u3002\n`/path/to`\u306a\u7b87\u6240\u3092\u66f8\u304d\u63db\u3048\u308b\u3002\nsrc_dir: \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5143\u3002ssh\u5148\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7OK\u3002(\u4f8b: `hoge.com:/path/to/dir` )\ndest_dir: \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u5148\n\n```bash\n#/bin/sh\n\nsrc_dir=\"/path/to/dir\"\ndest_dir=\"/path/to/dir\"\n\nbackup_dir=`date +'%Y%m%d'`\n\nmkdir -p ${dest_dir}/${backup_dir}\nrsync -a ${src_dir} ${dest_dir}/${backup_dir}\n\n# zip archive\ncd ${dest_dir} && zip -rm ${backup_dir}.zip ${backup_dir}\n```\n\n### \u5b9a\u671f\u5b9f\u884c\n\n\u6bce\u65e5\u5b9f\u884c\u3059\u308b\u306a\u3089 `/etc/crontab` \u306b\u3067\u3082\u66f8\u3044\u3066\u304a\u3053\u3046\u3002\n\n```bash\n# everyday backup at 22:10\n10 22 * * * root /path/to/basic_backup.sh >> /path/to/backup.log\n```\n\n### \u53c2\u7167\n\ngist\u3082\u7f6e\u3044\u3066\u304a\u3044\u305f\u304b\u3089\u81ea\u7531\u306b\u4f7f\u3063\u3066\u306d\uff01\nhttps://gist.github.com/Yuji-Kuroko/e585859307f7477c6447\n", "tags": ["Linux", "Bash", "rsync"]}