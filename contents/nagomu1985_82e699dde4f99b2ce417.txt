{"context": " More than 1 year has passed since last update.\u5fd8\u5099\u9332\n\u3010OS\u3011\n\u4eca\u56de\u306fCentOS6.6_x86_64\u7248\u3092\u4f7f\u7528\u3002\u8a73\u7d30\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\u3002\nhttp://centos.server-manual.com/\n\u4e8b\u524d\u6e96\u5099\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4e8b\u524d\u306b\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\u4ee5\u4e0b\u3092\u5168\u3066\u8a2d\u5b9a\u3059\u308b\u3002\n\u30b7\u30b9\u30c6\u30e0\u5909\u66f4\u304c\u767a\u751f\u3059\u308b\u306e\u3067\u7ba1\u7406\u8005\u6a29\u9650\u304c\u5fc5\u9808\u3002root\u306bsu\u3057\u3066\u304a\u304f\u4e8b\u3002\n\u3010YUM\u30d1\u30c3\u30b1\u30fc\u30b8\u7ba1\u7406\u3011\nyum -y install yum-plugin-fastestmirror\nyum -y update\nyum -y groupinstall \"Base\" \"Development tools\" \"Japanese Support\"\n[RPMforge\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm --import http://apt.sw.be/RPM-GPG-KEY.dag.txt\nrpm -ivh http://apt.sw.be/redhat/el6/en/x86_64/rpmforge/RPMS/rpmforge-release-0.5.3-1.el6.rf.x86_64.rpm\n[EPEL\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\nrpm -ivh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n[ELRepo\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\nrpm -Uvh http://www.elrepo.org/elrepo-release-6-6.el6.elrepo.noarch.rpm\n[Remi\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n\u3010SELinux\u7121\u52b9\u5316\u3011\ngetenforce\nEnforcing \u2190SELinux\u6709\u52b9\nsetenforce 0\ngetenforce\nPermissive \u2190SELinux\u7121\u52b9\nvi /etc/sysconfig/selinux\nSELINUX=enforcing \nSELINUX=disabled \u2190\u5909\u66f4(\u8d77\u52d5\u6642\u306b\u7121\u52b9\u306b\u3059\u308b)\n\u3010iptables\u3067HTTP\u3092\u8a31\u53ef\u3011\nvi /etc/sysconfig/iptables\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 5601 -j ACCEPT \u2190\u8ffd\u52a0\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A FORWARD -j REJECT --reject-with icmp-host-prohibited\nCOMMIT\n\nIptables\u518d\u8d77\u52d5\nservice iptables restart\n\n\u3010JAVA\u3011\n\nCentOS\u69cb\u7bc9\u6642\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\nyum erase java*\n\u6700\u65b0\u7248\u3092\u30cd\u30c3\u30c8\u3088\u308a\u5165\u624b(rpm\u7248)\u3057\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nrpm \u2013ivh jdk-8u45-linux-x64.rpm\n\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\njava \u2013version\njava version \"1.8.0_45\"\nJava(TM) SE Runtime Environment (build 1.8.0_45-b14)\nJava HotSpot(TM) 64-Bit Server VM (build 25.45-b02, mixed mode)\n\u25a0JAVA_HOME\u8a2d\u5b9a\nvi /etc/profileexport JAVA_HOME=/usr/java/default\nexport PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar\n\n\n\u3010\u524d\u63d0\u6761\u4ef6\u3011\nElasticsearch\u306f\u65e2\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u3068\u3057\u307e\u3059\n\u3010Kibana4\u3011\ncd /usr/local/src\nwget https://download.elastic.co/kibana/kibana/kibana-4.1.1-linux-x64.tar.gz\ntar -zxvf kibana-4.1.1-linux-x64.tar.gz\nchown -R root:root kibana-4.1.1-linux-x64\nmv kibana-4.1.1-linux-x64 ../kibana\n\u25a0\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\nvi /etc/init.d/kibana\n\"#!/bin/sh\"\n\n\"### BEGIN INIT INFO\"\n\"# Provides:          kibana\"\n\"# Required-Start:    $local_fs $remote_fs $network\"\n\"# Should-Start:      $time\"\n\"# Required-Stop:     $local_fs $remote_fs $network\"\n\"# Default-Start:     3 5\"\n\"# Default-Stop:      0 1 2 6\"\n\"# Short-Description: Kibana 4\"\n\"# Description:       Service controller for Kibana 4\"\n\"### END INIT INFO\"\n\nINSTALLED_DIR=/usr/local/kibana\nEXEC_SCRIPT=\"$INSTALLED_DIR/bin/kibana\"\nLOG_DIR=/var/log/kibana\nPID_DIR=/var/run\nPID_FILE=\"$PID_DIR\"/kibana.pid\nLOG_FILE=\"$LOG_DIR\"/kibana.log\n\ntest -d $LOG_DIR || mkdir $LOG_DIR\n\n\"# Source function library.\"\n. /etc/init.d/functions\n\nRETVAL=0\n\ncase \"$1\" in\n    start)\n        if [ ! -f \"$PID_FILE\" ]; then\n          echo -n \"Starting Kibana\"\n          nohup $EXEC_SCRIPT 0<&- &> $LOG_FILE &\n          echo $! > $PID_FILE\n          success\n        else\n          echo -n \"Kibana is already running\"\n          RETVAL=1\n          failure\n        fi\n        echo\n        ;;\n    stop)\n        if [ -f \"$PID_FILE\" ]; then\n          echo -n \"Stopping Kibana\"\n          test -f $PID_FILE && cat $PID_FILE | xargs kill -s SIGKILL && rm -f $PID_FILE\n          success\n        else\n          echo -n \"Kibana is not running\"\n          RETVAL=1\n          failure\n        fi\n        echo\n        ;;\n    restart)\n        $0 stop\n        $0 start\n        ;;\n    reload)\n        $0 restart\n        ;;\n    status)\n        status kibana\n        RETVAL=$?\n        ;;\n*)\necho \"Usage: $0 {start|stop|status|restart|reload}\"\nexit 1\n;;\nesac\nexit $RETVAL\n\n\u5b9f\u884c\u6a29\u9650\u4ed8\u4e0e\nchmod +x /etc/init.d/kibana\nKibana4\u30b9\u30bf\u30fc\u30c8\n/etc/init.d/kibana start\n\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\nchkconfig --add kibana\n\n\u25a0\u4e8b\u524d\u6e96\u5099\nElasticsearch\u5185\u306e\u30c7\u30fc\u30bf\u304c\u7a7a\u3060\u3068\u3001\u4e0a\u624b\u304f\u8d77\u52d5\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u4e8b\u524d\u306b\u30c0\u30df\u30fc\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u4e0b\u8a18\u306e\u30b5\u30a4\u30c8\u3088\u308ashakespeare.json\u30fblogs.jsonl.gz\u30fbaccounts.zip\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nhttps://www.elastic.co/guide/en/kibana/current/getting-started.html\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\nunzip accounts.zip\ngunzip logs.jsonl.gz\nbulk API\u3092\u4f7f\u7528\u3057\u3066Elasticsearch\u306b\u30ed\u30fc\u30c9\ncurl -XPOST 'localhost:9200/accounts/account/_bulk?pretty' --data-binary @accounts.json\ncurl -XPOST 'localhost:9200/shakespeare/_bulk?pretty' --data-binary @shakespeare.json\ncurl -XPOST 'localhost:9200/_bulk?pretty' --data-binary @logs.jsonl\n\n\u78ba\u8a8d\ncurl 'localhost:9200/_cat/indices?v'\n\nhealth status index               pri rep docs.count docs.deleted store.size pri.store.size\nyellow open   accounts              5   1       1000            0    418.2kb        418.2kb\nyellow open   shakespeare           5   1     111396            0     17.6mb         17.6mb\nyellow open   logstash-2015.05.18   5   1       4631            0     15.6mb         15.6mb\nyellow open   logstash-2015.05.19   5   1       4624            0     15.7mb         15.7mb\nyellow open   logstash-2015.05.20   5   1       4750            0     16.4mb         16.4mb\n\n\u25a0\u52d5\u4f5c\u78ba\u8a8d\n\u30d6\u30e9\u30a6\u30b6\u3067\u4ee5\u4e0b\u306b\u30a2\u30af\u30bb\u30b9\nhttp://localhost:5601\n\n\u4ee5\u4e0b\u306e\u9805\u76ee\u3092\u8a2d\u5b9a\nIndex contains time-based events\uff1a\u30c1\u30a7\u30c3\u30af\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\nIndex name or pattern\uff1alogstash-*\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\nTime-field name\uff1a@timestamp\uff08\u9078\u629e\uff09\n\n\u300cCreate\u300d\u5b9f\u884c\n\n\u753b\u9762\u5de6\u4e0a\u306e\u300cDiscover\u300d\u9078\u629e\n\n\u5f8c\u306f\u672c\u5bb6\u30b5\u30a4\u30c8\u306e\u4f8b\u984c\u901a\u308a\u306b\u9032\u3081\u308c\u3070\u3001\u30b5\u30af\u30b5\u30af\u3068\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3057\u3066\u304f\u308c\u307e\u3059\nhttps://www.elastic.co/guide/en/kibana/current/index.html\n\u5fd8\u5099\u9332\n\n\u3010OS\u3011\n\u4eca\u56de\u306fCentOS6.6_x86_64\u7248\u3092\u4f7f\u7528\u3002\u8a73\u7d30\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\u3002\nhttp://centos.server-manual.com/\n\u4e8b\u524d\u6e96\u5099\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u4e8b\u524d\u306b\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308b\u3002\u4ee5\u4e0b\u3092\u5168\u3066\u8a2d\u5b9a\u3059\u308b\u3002\n\u30b7\u30b9\u30c6\u30e0\u5909\u66f4\u304c\u767a\u751f\u3059\u308b\u306e\u3067\u7ba1\u7406\u8005\u6a29\u9650\u304c\u5fc5\u9808\u3002root\u306bsu\u3057\u3066\u304a\u304f\u4e8b\u3002\n\n\u3010YUM\u30d1\u30c3\u30b1\u30fc\u30b8\u7ba1\u7406\u3011\nyum -y install yum-plugin-fastestmirror\nyum -y update\nyum -y groupinstall \"Base\" \"Development tools\" \"Japanese Support\"\n[RPMforge\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm --import http://apt.sw.be/RPM-GPG-KEY.dag.txt\nrpm -ivh http://apt.sw.be/redhat/el6/en/x86_64/rpmforge/RPMS/rpmforge-release-0.5.3-1.el6.rf.x86_64.rpm\n[EPEL\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm --import http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6\nrpm -ivh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\n[ELRepo\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\nrpm -Uvh http://www.elrepo.org/elrepo-release-6-6.el6.elrepo.noarch.rpm\n[Remi\u30ea\u30dd\u30b8\u30c8\u30ea\u8ffd\u52a0]\nrpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n\n\u3010SELinux\u7121\u52b9\u5316\u3011\ngetenforce\nEnforcing \u2190SELinux\u6709\u52b9\nsetenforce 0\ngetenforce\nPermissive \u2190SELinux\u7121\u52b9\nvi /etc/sysconfig/selinux\nSELINUX=enforcing \nSELINUX=disabled \u2190\u5909\u66f4(\u8d77\u52d5\u6642\u306b\u7121\u52b9\u306b\u3059\u308b)\n\n\u3010iptables\u3067HTTP\u3092\u8a31\u53ef\u3011\nvi /etc/sysconfig/iptables\n<pre>\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 5601 -j ACCEPT \u2190\u8ffd\u52a0\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A FORWARD -j REJECT --reject-with icmp-host-prohibited\nCOMMIT\n</pre>\nIptables\u518d\u8d77\u52d5\nservice iptables restart\n\n\u3010JAVA\u3011\n<table border=1>\nCentOS\u69cb\u7bc9\u6642\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\nyum erase java*\n\u6700\u65b0\u7248\u3092\u30cd\u30c3\u30c8\u3088\u308a\u5165\u624b(rpm\u7248)\u3057\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nrpm \u2013ivh jdk-8u45-linux-x64.rpm\n\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\njava \u2013version\njava version \"1.8.0_45\"\nJava(TM) SE Runtime Environment (build 1.8.0_45-b14)\nJava HotSpot(TM) 64-Bit Server VM (build 25.45-b02, mixed mode)\n\u25a0JAVA_HOME\u8a2d\u5b9a\nvi /etc/profile\n<pre>\nexport JAVA_HOME=/usr/java/default\nexport PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/jre/lib:$JAVA_HOME/lib:$JAVA_HOME/lib/tools.jar\n</pre>\n</table>\n\n\u3010\u524d\u63d0\u6761\u4ef6\u3011\nElasticsearch\u306f\u65e2\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u3068\u3057\u307e\u3059\n\n\u3010Kibana4\u3011\ncd /usr/local/src\nwget https://download.elastic.co/kibana/kibana/kibana-4.1.1-linux-x64.tar.gz\ntar -zxvf kibana-4.1.1-linux-x64.tar.gz\nchown -R root:root kibana-4.1.1-linux-x64\nmv kibana-4.1.1-linux-x64 ../kibana\n\u25a0\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\nvi /etc/init.d/kibana\n<pre>\n\"#!/bin/sh\"\n \n\"### BEGIN INIT INFO\"\n\"# Provides:          kibana\"\n\"# Required-Start:    $local_fs $remote_fs $network\"\n\"# Should-Start:      $time\"\n\"# Required-Stop:     $local_fs $remote_fs $network\"\n\"# Default-Start:     3 5\"\n\"# Default-Stop:      0 1 2 6\"\n\"# Short-Description: Kibana 4\"\n\"# Description:       Service controller for Kibana 4\"\n\"### END INIT INFO\"\n \nINSTALLED_DIR=/usr/local/kibana\nEXEC_SCRIPT=\"$INSTALLED_DIR/bin/kibana\"\nLOG_DIR=/var/log/kibana\nPID_DIR=/var/run\nPID_FILE=\"$PID_DIR\"/kibana.pid\nLOG_FILE=\"$LOG_DIR\"/kibana.log\n \ntest -d $LOG_DIR || mkdir $LOG_DIR\n \n\"# Source function library.\"\n. /etc/init.d/functions\n \nRETVAL=0\n \ncase \"$1\" in\n    start)\n        if [ ! -f \"$PID_FILE\" ]; then\n          echo -n \"Starting Kibana\"\n          nohup $EXEC_SCRIPT 0<&- &> $LOG_FILE &\n          echo $! > $PID_FILE\n          success\n        else\n          echo -n \"Kibana is already running\"\n          RETVAL=1\n          failure\n        fi\n        echo\n        ;;\n    stop)\n        if [ -f \"$PID_FILE\" ]; then\n          echo -n \"Stopping Kibana\"\n          test -f $PID_FILE && cat $PID_FILE | xargs kill -s SIGKILL && rm -f $PID_FILE\n          success\n        else\n          echo -n \"Kibana is not running\"\n          RETVAL=1\n          failure\n        fi\n        echo\n        ;;\n    restart)\n        $0 stop\n        $0 start\n        ;;\n    reload)\n        $0 restart\n        ;;\n    status)\n        status kibana\n        RETVAL=$?\n        ;;\n*)\necho \"Usage: $0 {start|stop|status|restart|reload}\"\nexit 1\n;;\nesac\nexit $RETVAL\n</pre>\n\u5b9f\u884c\u6a29\u9650\u4ed8\u4e0e\nchmod +x /etc/init.d/kibana\nKibana4\u30b9\u30bf\u30fc\u30c8\n/etc/init.d/kibana start\n\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\nchkconfig --add kibana\n\n\u25a0\u4e8b\u524d\u6e96\u5099\nElasticsearch\u5185\u306e\u30c7\u30fc\u30bf\u304c\u7a7a\u3060\u3068\u3001\u4e0a\u624b\u304f\u8d77\u52d5\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u4e8b\u524d\u306b\u30c0\u30df\u30fc\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u4e0b\u8a18\u306e\u30b5\u30a4\u30c8\u3088\u308ashakespeare.json\u30fblogs.jsonl.gz\u30fbaccounts.zip\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nhttps://www.elastic.co/guide/en/kibana/current/getting-started.html\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u89e3\u51cd\nunzip accounts.zip\ngunzip logs.jsonl.gz\n\nbulk API\u3092\u4f7f\u7528\u3057\u3066Elasticsearch\u306b\u30ed\u30fc\u30c9\n<pre>\ncurl -XPOST 'localhost:9200/accounts/account/_bulk?pretty' --data-binary @accounts.json\ncurl -XPOST 'localhost:9200/shakespeare/_bulk?pretty' --data-binary @shakespeare.json\ncurl -XPOST 'localhost:9200/_bulk?pretty' --data-binary @logs.jsonl\n</pre>\n\u78ba\u8a8d\n<pre>\ncurl 'localhost:9200/_cat/indices?v'\n</pre>\n<pre>\nhealth status index               pri rep docs.count docs.deleted store.size pri.store.size\nyellow open   accounts              5   1       1000            0    418.2kb        418.2kb\nyellow open   shakespeare           5   1     111396            0     17.6mb         17.6mb\nyellow open   logstash-2015.05.18   5   1       4631            0     15.6mb         15.6mb\nyellow open   logstash-2015.05.19   5   1       4624            0     15.7mb         15.7mb\nyellow open   logstash-2015.05.20   5   1       4750            0     16.4mb         16.4mb\n</pre>\n\n\u25a0\u52d5\u4f5c\u78ba\u8a8d\n\u30d6\u30e9\u30a6\u30b6\u3067\u4ee5\u4e0b\u306b\u30a2\u30af\u30bb\u30b9\nhttp://localhost:5601\n![image](https://qiita-image-store.s3.amazonaws.com/0/55845/ed8c5c43-c7fe-d853-d075-82faf1395390.png)\n\u4ee5\u4e0b\u306e\u9805\u76ee\u3092\u8a2d\u5b9a\n<pre>\nIndex contains time-based events\uff1a\u30c1\u30a7\u30c3\u30af\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\nIndex name or pattern\uff1alogstash-*\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\nTime-field name\uff1a@timestamp\uff08\u9078\u629e\uff09\n</pre>\n\u300cCreate\u300d\u5b9f\u884c\n\n\u753b\u9762\u5de6\u4e0a\u306e\u300cDiscover\u300d\u9078\u629e\n![image](https://qiita-image-store.s3.amazonaws.com/0/55845/5d5b93c1-9b1d-abde-487e-d9d18b5aa330.png)\n\u5f8c\u306f\u672c\u5bb6\u30b5\u30a4\u30c8\u306e\u4f8b\u984c\u901a\u308a\u306b\u9032\u3081\u308c\u3070\u3001\u30b5\u30af\u30b5\u30af\u3068\u30b0\u30e9\u30d5\u3092\u4f5c\u6210\u3057\u3066\u304f\u308c\u307e\u3059\nhttps://www.elastic.co/guide/en/kibana/current/index.html\n", "tags": ["Kibana4", "Elasticsearch", "CentOS6.x", "Java"]}