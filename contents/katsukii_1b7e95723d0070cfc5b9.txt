{"context": " More than 1 year has passed since last update.\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30d5\u30a9\u30fc\u30e0\u2193\n\nindex.html\n<form action=\"upload.php\" method=\"post\" enctype=\"multipart/form-data\">\n  CSV\u30d5\u30a1\u30a4\u30eb\uff1a<br />\n  <input type=\"file\" name=\"csvfile\" size=\"30\" /><br />\n  <input type=\"submit\" value=\"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\" />\n</form>\n\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5148\u306b\u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u51e6\u7406\u2193\n\nupload.php\nif (is_uploaded_file($_FILES[\"csvfile\"][\"tmp_name\"])) {\n  $file_tmp_name = $_FILES[\"csvfile\"][\"tmp_name\"];\n  $file_name = $_FILES[\"csvfile\"][\"name\"];\n\n  //\u62e1\u5f35\u5b50\u3092\u5224\u5b9a\n  if (pathinfo($file_name, PATHINFO_EXTENSION) != 'csv') {\n    $err_msg = 'CSV\u30d5\u30a1\u30a4\u30eb\u306e\u307f\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002';\n  } else {\n    //\u30d5\u30a1\u30a4\u30eb\u3092data\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\n    if (move_uploaded_file($file_tmp_name, \"../../data/uploaded/\" . $file_name)) {\n      //\u5f8c\u3067\u524a\u9664\u3067\u304d\u308b\u3088\u3046\u306b\u6a29\u9650\u3092644\u306b\n      chmod(\"../../data/uploaded/\" . $file_name, 0644);\n      $msg = $file_name . \"\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\u3002\";\n      $file = '../../data/uploaded/'.$file_name;\n      $fp   = fopen($file, \"r\");\n\n      //\u914d\u5217\u306b\u5909\u63db\u3059\u308b\n      while (($data = fgetcsv($fp, 0, \",\")) !== FALSE) {\n        $asins[] = $data;\n      }\n      fclose($fp);\n      //\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n      unlink('../../data/uploaded/'.$file_name);\n    } else {\n      $err_msg = \"\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u307e\u305b\u3093\u3002\";\n    }\n  }\n} else {\n  $err_msg = \"\u30d5\u30a1\u30a4\u30eb\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\";\n}\n\n\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30d5\u30a9\u30fc\u30e0\u2193\n\n```php:index.html\n<form action=\"upload.php\" method=\"post\" enctype=\"multipart/form-data\">\n  CSV\u30d5\u30a1\u30a4\u30eb\uff1a<br />\n  <input type=\"file\" name=\"csvfile\" size=\"30\" /><br />\n  <input type=\"submit\" value=\"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\" />\n</form>\n```\n\n\n\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5148\u306b\u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u51e6\u7406\u2193\n\n```php:upload.php\nif (is_uploaded_file($_FILES[\"csvfile\"][\"tmp_name\"])) {\n  $file_tmp_name = $_FILES[\"csvfile\"][\"tmp_name\"];\n  $file_name = $_FILES[\"csvfile\"][\"name\"];\n\n  //\u62e1\u5f35\u5b50\u3092\u5224\u5b9a\n  if (pathinfo($file_name, PATHINFO_EXTENSION) != 'csv') {\n    $err_msg = 'CSV\u30d5\u30a1\u30a4\u30eb\u306e\u307f\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002';\n  } else {\n    //\u30d5\u30a1\u30a4\u30eb\u3092data\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\n    if (move_uploaded_file($file_tmp_name, \"../../data/uploaded/\" . $file_name)) {\n      //\u5f8c\u3067\u524a\u9664\u3067\u304d\u308b\u3088\u3046\u306b\u6a29\u9650\u3092644\u306b\n      chmod(\"../../data/uploaded/\" . $file_name, 0644);\n      $msg = $file_name . \"\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\u3002\";\n      $file = '../../data/uploaded/'.$file_name;\n      $fp   = fopen($file, \"r\");\n\n\t  //\u914d\u5217\u306b\u5909\u63db\u3059\u308b\n      while (($data = fgetcsv($fp, 0, \",\")) !== FALSE) {\n        $asins[] = $data;\n      }\n      fclose($fp);\n      //\u30d5\u30a1\u30a4\u30eb\u306e\u524a\u9664\n      unlink('../../data/uploaded/'.$file_name);\n    } else {\n      $err_msg = \"\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u307e\u305b\u3093\u3002\";\n    }\n  }\n} else {\n  $err_msg = \"\u30d5\u30a1\u30a4\u30eb\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\";\n}\n```\n", "tags": ["\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9", "\u30d5\u30a1\u30a4\u30eb\u64cd\u4f5c", "CSV", "\u914d\u5217", "PHP"]}