{"context": " More than 1 year has passed since last update.\u524d\u56de\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u975e\u540c\u671f\u51e6\u7406\u3092\u9806\u6b21\u51e6\u7406\u3068\u3057\u3066\u66f8\u304f\u3053\u3068\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\u3057\u304b\u3057\u3001\u524d\u56de\u66f8\u3044\u305f\u66f8\u304d\u65b9\u3060\u3068\u3001\u5c11\u3005\u7269\u8db3\u308a\u306a\u3044\u3068\u3044\u3046\u304b\u3001\u6c4e\u7528\u6027\u306b\u304b\u3051\u308b\u3082\u306e\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u307e\u305a\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406\u306e\u8a18\u6cd5\u3092\u3082\u3046\u5c11\u3057\u6d17\u7df4\u3055\u305b\u3066\u3001\u6c4e\u7528\u6027\u3092\u9ad8\u3081\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u3064\u3044\u3067\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3042\u308bco\u3092\u4f7f\u3063\u3066\u3001\u975e\u540c\u671f\u51e6\u7406\u3092\u66f8\u304f\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406\u306e\u9806\u6b21\u8a18\u8ff0\n\u975e\u540c\u671f\u51e6\u7406\u304c\u7d42\u4e86\u3057\u305f\u6642\u306b\u3001\u305d\u306e\u5024\u3092next\u306b\u5165\u308c\u3066\u51e6\u7406\u3092\u518d\u958b\u3059\u308b\u3001\u3068\u3044\u3046\u5f62\u3067\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406\u306e\u9806\u6b21\u8a18\u8ff0\u304c\u5b9f\u73fe\u3067\u304d\u3066\u3044\u307e\u3057\u305f\u3002\n\u3053\u308c\u3092\u3088\u308a\u624b\u8efd\u306b\u3067\u304d\u308b\u3088\u3046\u306a\u4ed5\u7d44\u307f\u3092\u4f5c\u308a\u307e\u3057\u3087\u3046\n\n\u975e\u540c\u671f\u51e6\u7406\u306e\u5916\u51fa\u3057\n\u524d\u56de\u306e\u5b9f\u88c5\u3092\u601d\u3044\u51fa\u3057\u307e\u3057\u3087\u3046\n'use strict'\n\n//\u7121\u7406\u3084\u308a\u9806\u6b21\u51e6\u7406\nfunction* hell(n) {\n  console.log(n);\n  const x = yield setTimeout(() => gen.next(n * n), 1000);\n  console.log(x);\n  const y = yield setTimeout(() => gen.next(x * x), 1000);\n  console.log(y);\n  const z = yield setTimeout(() => gen.next(y * y * y), 1000);\n  console.log(z);\n}\n\nconst gen = hell(2);\ngen.next();\n\n\u3053\u308c\u3060\u3068\u3001\u975e\u540c\u671f\u51e6\u7406\u306e\u5185\u5bb9\u304c\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u4e2d\u306b\u5165\u308a\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\n\u307e\u305a\u306f\u3053\u308c\u3089\u3092\u5916\u306b\u51fa\u3057\u307e\u3057\u3087\u3046\n'use strict'\n\nfunction* somethings() {\n  const n = yield;\n  const x = yield afterSqure(n);\n  const y = yield afterSqure(x);\n  const z = yield afterCube(y);\n  console.log([n, x, y, z]);\n}\n\n//1\u79d2\u5f8c\u306b\uff12\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterSqure(n) {\n  setTimeout(() => gen.next(n * n), 1000);\n}\n\n//1\u79d2\u5f8c\u306b\uff13\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterCube(n) {\n  setTimeout(() => gen.next(n * n * n), 1000);\n}\n\nconst gen = somethings();\ngen.next();\ngen.next(2);\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\u3061\u3087\u3063\u3068\u7d50\u679c\u3082\u5909\u3048\u3066\u3044\u307e\u3059\u304c\u3001\u3054\u5bb9\u8d66\u9858\u3044\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u6700\u5f8c\u306e3\u884c\u304c\u3044\u3051\u307e\u305b\u3093\u306d\u3002\n\u88f8\u306e\u51e6\u7406\u304c\u5916\u306b\u51fa\u3066\u3057\u307e\u3063\u3066\u3044\u3066\u3001\u5c11\u3005\u30d6\u30b5\u30a4\u30af\u3067\u3059\u3002\n\u3053\u308c\u3089\u306f\u95a2\u6570\u306b\u30e9\u30c3\u30d4\u30f3\u30b0\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\n'use strict'\n\nfunction* somethings() {\n  const n = yield;\n  const x = yield afterSqure(n);\n  const y = yield afterSqure(x);\n  const z = yield afterCube(y);\n  console.log([n, x, y, z]);\n}\n\nfunction afterSqure(n) {\n  setTimeout(() => gen.next(n * n), 1000);\n}\n\nfunction afterCube(n) {\n  setTimeout(() => gen.next(n * n * n), 1000);\n}\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u95a2\u6570\nfunction processor(generator) {\n  const gen = generator();\n  gen.next();\n  gen.next(2);\n}\n\nprocessor(somethings);// \u5931\u6557\u3057\u307e\u3059\u3002\u3002\u3002\n\n\u3042\u308c\uff1f\u3053\u3093\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\nReferenceError: gen is not defined\n\u3053\u308c\u307e\u3067\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u3067const gen\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u305f\u305f\u3081\u3001\u95a2\u6570\u304b\u3089\u53c2\u7167\u3067\u304d\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u4eca\u56de\u306f\u95a2\u6570processor\u306e\u4e2d\u3067gen\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u5f53\u7136\u306a\u304c\u3089afterSqure\u306a\u3069\u306e\u5225\u306e\u95a2\u6570\u304b\u3089\u306f\u53c2\u7167\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n\u975e\u540c\u671f\u51e6\u7406\u3078\u306e\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u6e21\u3057\u65b9\n\u4e0a\u8ff0\u306e\u30b3\u30fc\u30c9\u306b\u306f\u6700\u5927\u306e\u6b20\u70b9\u304c\u3042\u308a\u307e\u3059\u3002afterSqure\u3068afterCube\u304c\u3001\u975e\u540c\u671f\u95a2\u6570\u306e\u304f\u305b\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u304c\u56fa\u5b9a\u5316\u3055\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u3068\u3053\u308d\u3067\u3059\u3002\n\u4e00\u822c\u7684\u306b\u306f\u3001\u975e\u540c\u671f\u95a2\u6570\u306f\u30e6\u30fc\u30b6\u30fc\u304c\u4efb\u610f\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092\u6307\u5b9a\u3067\u304d\u308b\u306e\u304c\u666e\u901a\u3067\u3059\u3002\n\u3064\u307e\u308a\u3001\nfunction afterSqure(n, callback) {\n  setTimeout(() => callback(n * n), 1000);\n}\n\nfunction afterCube(n, callback) {\n  setTimeout(() => callback(n * n * n), 1000);\n}\n\n\u3053\u306e\u3088\u3046\u306b\u66f8\u3044\u3066\u3057\u304b\u308b\u3079\u304d\u3067\u3057\u305f\u3002\n\u3068\u3059\u308b\u3068\u3001\u4eca\u5ea6\u306f\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u5074\u3067\u3082\u975e\u540c\u671f\u95a2\u6570\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3057\u3066\u3042\u3052\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\u3057\u304b\u3057\u3001\u3069\u3046\u3084\u3063\u3066\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3082\u306e\u304b\u3002\n\u305d\u3053\u3067\u3001\u30af\u30ed\u30fc\u30b8\u30e3\u3092\u4f7f\u3063\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u5f0f\u304c\u8003\u6848\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u6b21\u306e\u30b3\u30fc\u30c9\u3092\u898b\u3066\u304f\u3060\u3055\u3044\n'use strict'\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9\nfunction* somethings(next) {\n  const n = 2;\n  const x = yield afterSqure(n, next);\n  const y = yield afterSqure(x, next);\n  const z = yield afterCube(y, next);\n  console.log([n, x, y, z]);\n}\n\n//1\u79d2\u5f8c\u306b\uff12\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterSqure(n, callback) {\n  setTimeout(() => callback(n * n), 1000);\n}\n\n//1\u79d2\u5f8c\u306b\uff13\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterCube(n, callback) {\n  setTimeout(() => callback(n * n * n), 1000);\n}\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\nfunction processor(generator) {\n  const gen = generator(val => gen.next(val));\n  gen.next();\n}\n\nprocessor(somethings);// [2, 4, 16, 4096]\n\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u69cb\u9020\u306f\u975e\u5e38\u306b\u5358\u7d14\u3067\u3059\u3002\n\n\u307e\u305a\u30b8\u30a7\u30cd\u30ec\u30fc\u30bfsomething\u306f\u5f15\u6570\u3068\u3057\u3066\u95a2\u6570\u3092\u3068\u308b(\u3053\u3053\u3067\u306fnext\u3068\u540d\u4ed8\u3051\u3089\u308c\u3066\u3044\u308b)\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u5b9a\u7fa9\u5185\u306e\u5404\u975e\u540c\u671f\u95a2\u6570\u306f\u3001\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3068\u3057\u3066\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5f15\u6570\u3067\u4e0e\u3048\u3089\u308c\u305f\u95a2\u6570\u3092\u4f7f\u7528\u3059\u308b\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u95a2\u6570\u5185\u3067\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3092\u751f\u6210\u3059\u308b\u969b\u306b\u3001\u7121\u540d\u95a2\u6570\u3092\u5f15\u6570\u306b\u6e21\u3059\u3002\u3053\u306e\u7121\u540d\u95a2\u6570\u306f\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306enext\u30e1\u30bd\u30c3\u30c9\u306b\u4e0e\u3048\u3089\u308c\u305f\u5f15\u6570\u3092\u6e21\u3057\u3066\u5b9f\u884c\u3059\u308b\u95a2\u6570\u3067\u3042\u308b\u3002\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u3001\u975e\u540c\u671f\u51e6\u7406\u3092\u30b9\u30c3\u30ad\u30ea\u3057\u305f\u5f62\u3067\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nPromise\u3068co\nPromise\u3001\u3076\u3063\u3061\u3083\u3051\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u3002\n\u3067\u3059\u304c\u3001\u3053\u3044\u3064\u3068co\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306enext\u3092\u4e00\u5207\u610f\u8b58\u3059\u308b\u3053\u3068\u306a\u304f\u975e\u540c\u671f\u51e6\u7406\u3092\u9806\u6b21\u51e6\u7406\u3068\u3057\u3066\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u5fc5\u8981\u306aPromise\u306e\u77e5\u8b58\n\u3068\u308a\u3042\u3048\u305a\u3001\u76ee\u7684\u9054\u6210\u306b\u5fc5\u8981\u306a\u77e5\u8b58\u3060\u3051\n\nPromise\u3092new \u3059\u308b\u3068\u304d\u306f\u95a2\u6570\u3092\u5f15\u6570\u306b\u3059\u308b(new Promise(function(){}))\nPromise\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306e\u5f15\u6570\u3067\u3042\u308b\u95a2\u6570\u306f\u3001\u5f15\u6570\u306b\uff12\u3064\u307e\u3067\u95a2\u6570\u3092\u6307\u5b9a\u3067\u304d\u308b(new Promise(function(resolve, reject){})\n\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u6307\u5b9a\u3057\u305f\u95a2\u6570\u306e\u4e2d\u3067\u3001\u300c\u6210\u529f\u3057\u305f\u300d\u5834\u5408\u306fresolve\u95a2\u6570\u306b\u5024\u3092\u6e21\u3057\u3001\u300c\u5931\u6557\u3057\u305f\u300d\u5834\u5408\u306freject\u95a2\u6570\u306b\u5024\u3092\u6e21\u3059\n\u751f\u6210\u3057\u305fPromise\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066\u3001then\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3057\u3001\u6210\u529f\u6642\u3068\u5931\u6557\u6642\u306e\u52d5\u4f5c\u30e1\u30bd\u30c3\u30c9\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u51e6\u7406\u304c\u59cb\u307e\u308b\u3002\n\n\u5b9f\u88c5\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\nfunction prom(n) {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      if (n % 2 == 1) {\n        resolve('\u6210\u529f!!');\n      } else {\n        reject('\u5931\u6557');\n      }\n    }, 500)\n  });\n}\n\nfunction test(n) {\n  p = prom(n);\n  p.then(val => console.log(val), val => console.log('\u6b8b\u5ff5\u306a\u304c\u3089' + val));\n}\n\ntest(2);// \u6b8b\u5ff5\u306a\u304c\u3089\u5931\u6557\u3067\u3059\ntest(3);// \u6210\u529f!!\ntest(4);// \u6b8b\u5ff5\u306a\u304c\u3089\u5931\u6557\u3067\u3059\n\nthen\u30e1\u30bd\u30c3\u30c9\u306f\u3058\u3081\u306b\u767b\u9332\u3057\u305f\u95a2\u6570\u304c\u300c\u6210\u529f\u6642\u300d\u306e\u51e6\u7406\u3067\u3001\u5f8c\u306b\u767b\u9332\u3057\u305f\u95a2\u6570\u304c\u300c\u5931\u6557\u6642\u300d\u306e\u51e6\u7406\u3067\u3059\u3002\n\nco\u3067\u975e\u540c\u671f\u51e6\u7406\u3092\u66f8\u304f\nco\u306f\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3068Promise\u3092\u4f7f\u3063\u3066\u975e\u540c\u671f\u51e6\u7406\u3092\u9806\u6b21\u51e6\u7406\u306e\u66f8\u304d\u65b9\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3060\u3051\u3067\u66f8\u3044\u305f\u51e6\u7406\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\n'use strict'\n\nconst co = require('co');\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9\nfunction* somethings() {\n  const n = 2;\n  const x = yield afterSqure(n);\n  const y = yield afterSqure(x);\n  const z = yield afterCube(y);\n  console.log([n, x, y, z]);\n}\n\n//1\u79d2\u5f8c\u306b\uff12\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterSqure(n) {\n  return new Promise((resolve) => {\n    setTimeout(() => resolve(n * n), 1000);\n  });\n}\n\n//1\u79d2\u5f8c\u306b\uff13\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterCube(n) {\n  return new Promise((resolve) => {\n    setTimeout(() => resolve(n * n), 1000);\n  });\n}\n\nco(somethings);// [2, 4, 16, 4096]\n\nco\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5fc5\u8981\u3067\u3059\u306e\u3067\u3001\u4f7f\u7528\u524d\u306bnpm i co\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3063\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30b3\u30fc\u30c9\u3092\u898b\u308b\u3068\u3001\u3082\u3068\u3082\u3068\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u95a2\u6570\u304c\u3042\u3063\u305f\u90e8\u5206\u3092co(somethings)\u306b\u7f6e\u304d\u63db\u3048\u3066\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u307f\u306e\u6642\u306fnext\u30e1\u30bd\u30c3\u30c9\u3092\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306b\u6e21\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u4eca\u56de\u306f\u5fc5\u8981\u306a\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u3002\nyield\u306b\u5c55\u958b\u3055\u308c\u308b\u5024\u306f\u3001Promise\u306e\u6210\u529f\u6642\u3001resolve\u95a2\u6570\u306b\u6e21\u3055\u308c\u305f\u5024\u306b\u306a\u308b\u6a21\u69d8\u3067\u3059\nKoa\u306fco\u3068\u540c\u8abf\u3057\u3066\u3044\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u591a\u5206\u4f7f\u3063\u3066\u3044\u308b\u306e\u306f\u3053\u3063\u3061\u306e\u65b9\u6cd5\u306e\u306f\u305a\u3067\u3059\n\n\u307e\u3068\u3081\n\u8aac\u660e\u3068\u304b\u3092\u898b\u305f\u3060\u3051\u3067\u306f\u306a\u3093\u306e\u3053\u3068\u3060\u304b\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u3082\u306e\u3067\u3059\u304c\u3001\u81ea\u5206\u3067\u6253\u3064\u3053\u3068\u3067\u3001\u306a\u3093\u3068\u304b\u7406\u89e3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u3053\u308c\u3067\u304d\u3063\u3068Koa\u306e\u5b9f\u88c5\u304c\u3067\u304d\u308b\u306f\u305a\u3060\uff01\n\u3002\u3002\u3002\u305d\u3046\u601d\u3044\u305f\u3044\u3068\u3053\u308d\u3067\u3059\n\n\u53c2\u8003\ngenerator\u3068JavaScript\u306e\u975e\u540c\u671f\u51e6\u7406\n\n\u524d\u56de\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u975e\u540c\u671f\u51e6\u7406\u3092\u9806\u6b21\u51e6\u7406\u3068\u3057\u3066\u66f8\u304f\u3053\u3068\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\u3057\u304b\u3057\u3001\u524d\u56de\u66f8\u3044\u305f\u66f8\u304d\u65b9\u3060\u3068\u3001\u5c11\u3005\u7269\u8db3\u308a\u306a\u3044\u3068\u3044\u3046\u304b\u3001\u6c4e\u7528\u6027\u306b\u304b\u3051\u308b\u3082\u306e\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u307e\u305a\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406\u306e\u8a18\u6cd5\u3092\u3082\u3046\u5c11\u3057\u6d17\u7df4\u3055\u305b\u3066\u3001\u6c4e\u7528\u6027\u3092\u9ad8\u3081\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u3064\u3044\u3067\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3042\u308bco\u3092\u4f7f\u3063\u3066\u3001\u975e\u540c\u671f\u51e6\u7406\u3092\u66f8\u304f\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u3066\u3044\u304d\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406\u306e\u9806\u6b21\u8a18\u8ff0\n\n\u975e\u540c\u671f\u51e6\u7406\u304c\u7d42\u4e86\u3057\u305f\u6642\u306b\u3001\u305d\u306e\u5024\u3092`next`\u306b\u5165\u308c\u3066\u51e6\u7406\u3092\u518d\u958b\u3059\u308b\u3001\u3068\u3044\u3046\u5f62\u3067\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406\u306e\u9806\u6b21\u8a18\u8ff0\u304c\u5b9f\u73fe\u3067\u304d\u3066\u3044\u307e\u3057\u305f\u3002\n\u3053\u308c\u3092\u3088\u308a\u624b\u8efd\u306b\u3067\u304d\u308b\u3088\u3046\u306a\u4ed5\u7d44\u307f\u3092\u4f5c\u308a\u307e\u3057\u3087\u3046\n\n## \u975e\u540c\u671f\u51e6\u7406\u306e\u5916\u51fa\u3057\n\n\u524d\u56de\u306e\u5b9f\u88c5\u3092\u601d\u3044\u51fa\u3057\u307e\u3057\u3087\u3046\n\n```\n'use strict'\n\n//\u7121\u7406\u3084\u308a\u9806\u6b21\u51e6\u7406\nfunction* hell(n) {\n  console.log(n);\n  const x = yield setTimeout(() => gen.next(n * n), 1000);\n  console.log(x);\n  const y = yield setTimeout(() => gen.next(x * x), 1000);\n  console.log(y);\n  const z = yield setTimeout(() => gen.next(y * y * y), 1000);\n  console.log(z);\n}\n\nconst gen = hell(2);\ngen.next();\n```\n\u3053\u308c\u3060\u3068\u3001\u975e\u540c\u671f\u51e6\u7406\u306e\u5185\u5bb9\u304c\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u4e2d\u306b\u5165\u308a\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\n\u307e\u305a\u306f\u3053\u308c\u3089\u3092\u5916\u306b\u51fa\u3057\u307e\u3057\u3087\u3046\n\n```\n'use strict'\n\nfunction* somethings() {\n  const n = yield;\n  const x = yield afterSqure(n);\n  const y = yield afterSqure(x);\n  const z = yield afterCube(y);\n  console.log([n, x, y, z]);\n}\n\n//1\u79d2\u5f8c\u306b\uff12\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterSqure(n) {\n  setTimeout(() => gen.next(n * n), 1000);\n}\n\n//1\u79d2\u5f8c\u306b\uff13\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterCube(n) {\n  setTimeout(() => gen.next(n * n * n), 1000);\n}\n\nconst gen = somethings();\ngen.next();\ngen.next(2);\n```\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\u3061\u3087\u3063\u3068\u7d50\u679c\u3082\u5909\u3048\u3066\u3044\u307e\u3059\u304c\u3001\u3054\u5bb9\u8d66\u9858\u3044\u307e\u3059\u3002\n\u3057\u304b\u3057\u3001\u6700\u5f8c\u306e3\u884c\u304c\u3044\u3051\u307e\u305b\u3093\u306d\u3002\n\u88f8\u306e\u51e6\u7406\u304c\u5916\u306b\u51fa\u3066\u3057\u307e\u3063\u3066\u3044\u3066\u3001\u5c11\u3005\u30d6\u30b5\u30a4\u30af\u3067\u3059\u3002\n\u3053\u308c\u3089\u306f\u95a2\u6570\u306b\u30e9\u30c3\u30d4\u30f3\u30b0\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\n\n```\n'use strict'\n\nfunction* somethings() {\n  const n = yield;\n  const x = yield afterSqure(n);\n  const y = yield afterSqure(x);\n  const z = yield afterCube(y);\n  console.log([n, x, y, z]);\n}\n\nfunction afterSqure(n) {\n  setTimeout(() => gen.next(n * n), 1000);\n}\n\nfunction afterCube(n) {\n  setTimeout(() => gen.next(n * n * n), 1000);\n}\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u95a2\u6570\nfunction processor(generator) {\n  const gen = generator();\n  gen.next();\n  gen.next(2);\n}\n\nprocessor(somethings);// \u5931\u6557\u3057\u307e\u3059\u3002\u3002\u3002\n```\n\n\u3042\u308c\uff1f\u3053\u3093\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3059\nReferenceError: gen is not defined\n\n\u3053\u308c\u307e\u3067\u306f\u30b0\u30ed\u30fc\u30d0\u30eb\u3067`const gen`\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u305f\u305f\u3081\u3001\u95a2\u6570\u304b\u3089\u53c2\u7167\u3067\u304d\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u4eca\u56de\u306f\u95a2\u6570`processor`\u306e\u4e2d\u3067`gen`\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u5f53\u7136\u306a\u304c\u3089`afterSqure`\u306a\u3069\u306e\u5225\u306e\u95a2\u6570\u304b\u3089\u306f\u53c2\u7167\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n## \u975e\u540c\u671f\u51e6\u7406\u3078\u306e\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u6e21\u3057\u65b9\n\n\u4e0a\u8ff0\u306e\u30b3\u30fc\u30c9\u306b\u306f\u6700\u5927\u306e\u6b20\u70b9\u304c\u3042\u308a\u307e\u3059\u3002`afterSqure`\u3068`afterCube`\u304c\u3001\u975e\u540c\u671f\u95a2\u6570\u306e\u304f\u305b\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u304c\u56fa\u5b9a\u5316\u3055\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u3068\u3053\u308d\u3067\u3059\u3002\n\u4e00\u822c\u7684\u306b\u306f\u3001\u975e\u540c\u671f\u95a2\u6570\u306f\u30e6\u30fc\u30b6\u30fc\u304c\u4efb\u610f\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092\u6307\u5b9a\u3067\u304d\u308b\u306e\u304c\u666e\u901a\u3067\u3059\u3002\n\u3064\u307e\u308a\u3001\n\n```\nfunction afterSqure(n, callback) {\n  setTimeout(() => callback(n * n), 1000);\n}\n\nfunction afterCube(n, callback) {\n  setTimeout(() => callback(n * n * n), 1000);\n}\n```\n\u3053\u306e\u3088\u3046\u306b\u66f8\u3044\u3066\u3057\u304b\u308b\u3079\u304d\u3067\u3057\u305f\u3002\n\u3068\u3059\u308b\u3068\u3001\u4eca\u5ea6\u306f\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u5074\u3067\u3082\u975e\u540c\u671f\u95a2\u6570\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3057\u3066\u3042\u3052\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\u3057\u304b\u3057\u3001\u3069\u3046\u3084\u3063\u3066\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3082\u306e\u304b\u3002\n\u305d\u3053\u3067\u3001\u30af\u30ed\u30fc\u30b8\u30e3\u3092\u4f7f\u3063\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u5f0f\u304c\u8003\u6848\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u6b21\u306e\u30b3\u30fc\u30c9\u3092\u898b\u3066\u304f\u3060\u3055\u3044\n\n```\n'use strict'\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9\nfunction* somethings(next) {\n  const n = 2;\n  const x = yield afterSqure(n, next);\n  const y = yield afterSqure(x, next);\n  const z = yield afterCube(y, next);\n  console.log([n, x, y, z]);\n}\n\n//1\u79d2\u5f8c\u306b\uff12\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterSqure(n, callback) {\n  setTimeout(() => callback(n * n), 1000);\n}\n\n//1\u79d2\u5f8c\u306b\uff13\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterCube(n, callback) {\n  setTimeout(() => callback(n * n * n), 1000);\n}\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\nfunction processor(generator) {\n  const gen = generator(val => gen.next(val));\n  gen.next();\n}\n\nprocessor(somethings);// [2, 4, 16, 4096]\n```\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u69cb\u9020\u306f\u975e\u5e38\u306b\u5358\u7d14\u3067\u3059\u3002\n\n1. \u307e\u305a\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf`something`\u306f\u5f15\u6570\u3068\u3057\u3066\u95a2\u6570\u3092\u3068\u308b(\u3053\u3053\u3067\u306fnext\u3068\u540d\u4ed8\u3051\u3089\u308c\u3066\u3044\u308b)\n2. \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u5b9a\u7fa9\u5185\u306e\u5404\u975e\u540c\u671f\u95a2\u6570\u306f\u3001\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3068\u3057\u3066\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5f15\u6570\u3067\u4e0e\u3048\u3089\u308c\u305f\u95a2\u6570\u3092\u4f7f\u7528\u3059\u308b\n3. \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u95a2\u6570\u5185\u3067\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3092\u751f\u6210\u3059\u308b\u969b\u306b\u3001\u7121\u540d\u95a2\u6570\u3092\u5f15\u6570\u306b\u6e21\u3059\u3002\u3053\u306e\u7121\u540d\u95a2\u6570\u306f\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e`next`\u30e1\u30bd\u30c3\u30c9\u306b\u4e0e\u3048\u3089\u308c\u305f\u5f15\u6570\u3092\u6e21\u3057\u3066\u5b9f\u884c\u3059\u308b\u95a2\u6570\u3067\u3042\u308b\u3002\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u3001\u975e\u540c\u671f\u51e6\u7406\u3092\u30b9\u30c3\u30ad\u30ea\u3057\u305f\u5f62\u3067\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n# Promise\u3068co\n\nPromise\u3001\u3076\u3063\u3061\u3083\u3051\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u3002\n\u3067\u3059\u304c\u3001\u3053\u3044\u3064\u3068co\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e`next`\u3092\u4e00\u5207\u610f\u8b58\u3059\u308b\u3053\u3068\u306a\u304f\u975e\u540c\u671f\u51e6\u7406\u3092\u9806\u6b21\u51e6\u7406\u3068\u3057\u3066\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n## \u5fc5\u8981\u306aPromise\u306e\u77e5\u8b58\n\n\u3068\u308a\u3042\u3048\u305a\u3001\u76ee\u7684\u9054\u6210\u306b\u5fc5\u8981\u306a\u77e5\u8b58\u3060\u3051\n\n1. Promise\u3092new \u3059\u308b\u3068\u304d\u306f\u95a2\u6570\u3092\u5f15\u6570\u306b\u3059\u308b(`new Promise(function(){})`)\n2. Promise\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306e\u5f15\u6570\u3067\u3042\u308b\u95a2\u6570\u306f\u3001\u5f15\u6570\u306b\uff12\u3064\u307e\u3067\u95a2\u6570\u3092\u6307\u5b9a\u3067\u304d\u308b(`new Promise(function(resolve, reject){}`)\n3. \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u6307\u5b9a\u3057\u305f\u95a2\u6570\u306e\u4e2d\u3067\u3001\u300c\u6210\u529f\u3057\u305f\u300d\u5834\u5408\u306f`resolve`\u95a2\u6570\u306b\u5024\u3092\u6e21\u3057\u3001\u300c\u5931\u6557\u3057\u305f\u300d\u5834\u5408\u306f`reject`\u95a2\u6570\u306b\u5024\u3092\u6e21\u3059\n4. \u751f\u6210\u3057\u305fPromise\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5bfe\u3057\u3066\u3001then\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3057\u3001\u6210\u529f\u6642\u3068\u5931\u6557\u6642\u306e\u52d5\u4f5c\u30e1\u30bd\u30c3\u30c9\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u51e6\u7406\u304c\u59cb\u307e\u308b\u3002\n\n\u5b9f\u88c5\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\n\n```\nfunction prom(n) {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      if (n % 2 == 1) {\n        resolve('\u6210\u529f!!');\n      } else {\n        reject('\u5931\u6557');\n      }\n    }, 500)\n  });\n}\n\nfunction test(n) {\n  p = prom(n);\n  p.then(val => console.log(val), val => console.log('\u6b8b\u5ff5\u306a\u304c\u3089' + val));\n}\n\ntest(2);// \u6b8b\u5ff5\u306a\u304c\u3089\u5931\u6557\u3067\u3059\ntest(3);// \u6210\u529f!!\ntest(4);// \u6b8b\u5ff5\u306a\u304c\u3089\u5931\u6557\u3067\u3059\n```\n\n`then`\u30e1\u30bd\u30c3\u30c9\u306f\u3058\u3081\u306b\u767b\u9332\u3057\u305f\u95a2\u6570\u304c\u300c\u6210\u529f\u6642\u300d\u306e\u51e6\u7406\u3067\u3001\u5f8c\u306b\u767b\u9332\u3057\u305f\u95a2\u6570\u304c\u300c\u5931\u6557\u6642\u300d\u306e\u51e6\u7406\u3067\u3059\u3002\n\n## co\u3067\u975e\u540c\u671f\u51e6\u7406\u3092\u66f8\u304f\n\nco\u306f\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3068Promise\u3092\u4f7f\u3063\u3066\u975e\u540c\u671f\u51e6\u7406\u3092\u9806\u6b21\u51e6\u7406\u306e\u66f8\u304d\u65b9\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u3060\u3051\u3067\u66f8\u3044\u305f\u51e6\u7406\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\n\n```\n'use strict'\n\nconst co = require('co');\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9\nfunction* somethings() {\n  const n = 2;\n  const x = yield afterSqure(n);\n  const y = yield afterSqure(x);\n  const z = yield afterCube(y);\n  console.log([n, x, y, z]);\n}\n\n//1\u79d2\u5f8c\u306b\uff12\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterSqure(n) {\n  return new Promise((resolve) => {\n    setTimeout(() => resolve(n * n), 1000);\n  });\n}\n\n//1\u79d2\u5f8c\u306b\uff13\u4e57\u3057\u305f\u5024\u3092\u8fd4\u3059\nfunction afterCube(n) {\n  return new Promise((resolve) => {\n    setTimeout(() => resolve(n * n), 1000);\n  });\n}\n\nco(somethings);// [2, 4, 16, 4096]\n```\n\n`co`\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5fc5\u8981\u3067\u3059\u306e\u3067\u3001\u4f7f\u7528\u524d\u306b`npm i co`\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3063\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30b3\u30fc\u30c9\u3092\u898b\u308b\u3068\u3001\u3082\u3068\u3082\u3068\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5236\u5fa1\u95a2\u6570\u304c\u3042\u3063\u305f\u90e8\u5206\u3092`co(somethings)`\u306b\u7f6e\u304d\u63db\u3048\u3066\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u307f\u306e\u6642\u306f`next`\u30e1\u30bd\u30c3\u30c9\u3092\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306b\u6e21\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u4eca\u56de\u306f\u5fc5\u8981\u306a\u304f\u306a\u3063\u3066\u3044\u307e\u3059\u3002\nyield\u306b\u5c55\u958b\u3055\u308c\u308b\u5024\u306f\u3001Promise\u306e\u6210\u529f\u6642\u3001resolve\u95a2\u6570\u306b\u6e21\u3055\u308c\u305f\u5024\u306b\u306a\u308b\u6a21\u69d8\u3067\u3059\nKoa\u306fco\u3068\u540c\u8abf\u3057\u3066\u3044\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u591a\u5206\u4f7f\u3063\u3066\u3044\u308b\u306e\u306f\u3053\u3063\u3061\u306e\u65b9\u6cd5\u306e\u306f\u305a\u3067\u3059\n\n\n# \u307e\u3068\u3081\n\n\u8aac\u660e\u3068\u304b\u3092\u898b\u305f\u3060\u3051\u3067\u306f\u306a\u3093\u306e\u3053\u3068\u3060\u304b\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u3082\u306e\u3067\u3059\u304c\u3001\u81ea\u5206\u3067\u6253\u3064\u3053\u3068\u3067\u3001\u306a\u3093\u3068\u304b\u7406\u89e3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u3053\u308c\u3067\u304d\u3063\u3068Koa\u306e\u5b9f\u88c5\u304c\u3067\u304d\u308b\u306f\u305a\u3060\uff01\n\u3002\u3002\u3002\u305d\u3046\u601d\u3044\u305f\u3044\u3068\u3053\u308d\u3067\u3059\n\n# \u53c2\u8003\n[generator\u3068JavaScript\u306e\u975e\u540c\u671f\u51e6\u7406](http://qiita.com/hitsujiwool/items/316f3e8a41fb7dc3a119)\n", "tags": ["JavaScript", "es6", "promise", "es2015"]}