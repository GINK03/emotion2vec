{"context": " More than 1 year has passed since last update.\n\n\u74b0\u5883\n\nMacOS X 10.9.4\n\n\n\u4f5c\u696d\n\n\u4e8b\u524d\u306b\u5165\u308c\u3068\u304f\u3084\u30fc\u3064\n\nchef\nvirtualbox\n\n\nhomebrew \u304c\u58ca\u308c\u3066\u3044\u305f\u306e\u3067\u4fee\u5fa9(\u5f8c\u306e\u4f5c\u696d\u3067\u8a70\u307e\u3063\u305f\u3089\u898b\u3066\u3082\u3089\u3048\u308c\u3070\u3002)\n$ cd `brew --prefix`\n$ git fetch origin\n$ git reset --hard origin/master\n\n\u6cbb\u3063\u305f\u3002\n\u5371\u3046\u304f\u632b\u6298\u3057\u305d\u3046\u3060\u3063\u305f\u3002\n\npacker-install\n$ brew tap homebrew/binary\n$ brew install packer\n$ packer -v\nPacker v0.6.1\n\n\nchef\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ curl -L https://www.opscode.com/chef/install.sh | sudo bash\n$ sudo gem install chef --no-rdoc --no-ri \n$ sudo gem install knife-solo --no-rdoc --no-ri \n\n\ncookbook-nginx\ncookbook\u3092\u5225\u306e\u30d1\u30b9\u3067\u6240\u6709\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u30b9\u30eb\u30fc\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n$ knife solo init chef-repo\n\n$ cd chef-repo\n$ knife cookbook create test\n\n$ cat /var/tmp/chef-repo/cookbooks/hoge/recipes/default.rb\nyum_package \"httpd\" do\n  action :install\nend\n\nservice 'httpd' do\n  supports :status => true, :restart => true, :reload => true\n  action [:start, :enable]\nend\n\n\u203b httpd\u3092\u8ffd\u52a0\u307e\u3059\u3002\n\npacker\n\u4f9d\u4ee3\u3068\u306a\u308bOS\u305f\u3061\n$ cd /var/tmp\n$ git clone https://github.com/takayoshi/packer-vanilla-box.git\n$ cd packer-vanilla-box/centos/6\n\n\n\nchef\u306e\u8a2d\u5b9a\nprovisioners\u3092chef-solo\u3067\u5b9f\u884c\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n$ vim centos6.json\n[snip]\n  \"provisioners\": [{\n    \"type\": \"chef-solo\",\n    \"cookbook_paths\": [\"/var/tmp/chef-repo/cookbooks/\"],\n    \"run_list\": [\"recipe[hoge]\"],\n    \"json\": {\n      \"nginx\" : {\n        \"path\" : \"/usr/local/nginx\"\n      }\n    },\n    \"prevent_sudo\": false,\n    \"skip_install\": false\n  }]\n[snip]\n\n$ packer build -force -only=virtualbox-iso centos6.json\n\nvagrant\u306ebox\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\n==> Builds finished. The artifacts of successful builds are:\n--> virtualbox-iso: 'virtualbox' provider box: ./artifacts/centos6-virtualbox.box\n\n\u4f5c\u6210\u3057\u305fbox\u30d5\u30a1\u30a4\u30eb\u3092centos6\u3068\u3044\u3046\u540d\u524d\u3067vagrant\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\nvagrant box add centos6 artifacts/centos6-virtualbox.box\n\nVagrant\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002(\u9069\u5ea6\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002)\nvagrant init  centos6\n\nvagrant\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\nvagrant up\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u3066httpd\u304cinstall\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\nvagrant ssh\n$ /etc/init.d/httpd status\nhttpd \u306f\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059\n\n===\n\n\u53c2\u7167\u5143\u30da\u30fc\u30b8\n\u4ee5\u4e0b\u3092\u53c2\u7167\u3057\u307e\u3057\u305f\u3002(\u3044\u3064\u3082\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002)\n\nhttp://blog.f13.jp/post/20626146392/brew-brew-update\nhttp://momijiame.tumblr.com/post/80171332872/packer-vagrant-base-box\nhttp://dev.classmethod.jp/cloud/use_chef-solo-provisioner_to_make_ami_by_packer/\nhttps://github.com/miketheman/nginx\n\n## \u74b0\u5883\n\n* MacOS X 10.9.4\n\n## \u4f5c\u696d\n\n### \u4e8b\u524d\u306b\u5165\u308c\u3068\u304f\u3084\u30fc\u3064\n\n* chef\n* virtualbox\n\n### homebrew \u304c\u58ca\u308c\u3066\u3044\u305f\u306e\u3067\u4fee\u5fa9(\u5f8c\u306e\u4f5c\u696d\u3067\u8a70\u307e\u3063\u305f\u3089\u898b\u3066\u3082\u3089\u3048\u308c\u3070\u3002)\n\n```\n$ cd `brew --prefix`\n$ git fetch origin\n$ git reset --hard origin/master\n```\n\n\u6cbb\u3063\u305f\u3002\n\u5371\u3046\u304f\u632b\u6298\u3057\u305d\u3046\u3060\u3063\u305f\u3002\n\n### packer-install\n\n```\n$ brew tap homebrew/binary\n$ brew install packer\n$ packer -v\nPacker v0.6.1\n```\n\n### chef\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ curl -L https://www.opscode.com/chef/install.sh | sudo bash\n$ sudo gem install chef --no-rdoc --no-ri \n$ sudo gem install knife-solo --no-rdoc --no-ri \n```\n\n### cookbook-nginx\n\ncookbook\u3092\u5225\u306e\u30d1\u30b9\u3067\u6240\u6709\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u30b9\u30eb\u30fc\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n```\n$ knife solo init chef-repo\n```\n\n```\n$ cd chef-repo\n$ knife cookbook create test\n```\n\n```\n$ cat /var/tmp/chef-repo/cookbooks/hoge/recipes/default.rb\nyum_package \"httpd\" do\n  action :install\nend\n\nservice 'httpd' do\n  supports :status => true, :restart => true, :reload => true\n  action [:start, :enable]\nend\n```\n\u203b httpd\u3092\u8ffd\u52a0\u307e\u3059\u3002\n\n### packer\n\n\u4f9d\u4ee3\u3068\u306a\u308bOS\u305f\u3061\n\n```\n$ cd /var/tmp\n$ git clone https://github.com/takayoshi/packer-vanilla-box.git\n$ cd packer-vanilla-box/centos/6\n\n```\n\n### chef\u306e\u8a2d\u5b9a\n\nprovisioners\u3092chef-solo\u3067\u5b9f\u884c\u3059\u308b\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```\n$ vim centos6.json\n[snip]\n  \"provisioners\": [{\n    \"type\": \"chef-solo\",\n    \"cookbook_paths\": [\"/var/tmp/chef-repo/cookbooks/\"],\n    \"run_list\": [\"recipe[hoge]\"],\n    \"json\": {\n      \"nginx\" : {\n        \"path\" : \"/usr/local/nginx\"\n      }\n    },\n    \"prevent_sudo\": false,\n    \"skip_install\": false\n  }]\n[snip]\n```\n\n```\n$ packer build -force -only=virtualbox-iso centos6.json\n```\n\n\nvagrant\u306ebox\u30d5\u30a1\u30a4\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\n\n```\n==> Builds finished. The artifacts of successful builds are:\n--> virtualbox-iso: 'virtualbox' provider box: ./artifacts/centos6-virtualbox.box\n```\n\n\u4f5c\u6210\u3057\u305fbox\u30d5\u30a1\u30a4\u30eb\u3092centos6\u3068\u3044\u3046\u540d\u524d\u3067vagrant\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\nvagrant box add centos6 artifacts/centos6-virtualbox.box\n```\n\nVagrant\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002(\u9069\u5ea6\u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002)\n\n```\nvagrant init  centos6\n```\n\nvagrant\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\n\n```\nvagrant up\n```\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u3066httpd\u304cinstall\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\n\n```\nvagrant ssh\n$ /etc/init.d/httpd status\nhttpd \u306f\u8d77\u52d5\u3057\u3066\u3044\u307e\u3059\n```\n\n===\n\n\n### \u53c2\u7167\u5143\u30da\u30fc\u30b8\n\n\u4ee5\u4e0b\u3092\u53c2\u7167\u3057\u307e\u3057\u305f\u3002(\u3044\u3064\u3082\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002)\n\n* http://blog.f13.jp/post/20626146392/brew-brew-update\n* http://momijiame.tumblr.com/post/80171332872/packer-vagrant-base-box\n* http://dev.classmethod.jp/cloud/use_chef-solo-provisioner_to_make_ami_by_packer/\n* https://github.com/miketheman/nginx\n", "tags": ["packer", "vagrant-chef"]}