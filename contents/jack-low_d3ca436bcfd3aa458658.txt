{"context": "\n\nPythonista [iOS\u7528 Python]\nPythonista\u3068\u306f\u3001iOS\u7aef\u672b\u3092\u5f37\u529b\u306b\u3057\u3066\u304f\u308c\u308b\u30a2\u30d7\u30ea\u3067\u3059\u3002\n\u4eca\u56de\u306f\u3001youtube\u304b\u3089\u52d5\u753b\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\u304b\u3092\u8a66\u3057\u3066\u307f\u305f\u3002\nPython\u30e2\u30b8\u30e5\u30fc\u30eb\u306epafy\u3092\u5229\u7528\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u25a1 \u5fc5\u8981\u306a\u77e5\u8b58\n\n\nPython\n\n\n\u74b0\u5883\u69cb\u7bc9\u7de8\nPythonista\u306fpypi\u304b\u3089pip\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u4e00\u90e8\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u203b\u5168\u3066\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u3084OS\u306a\u3069\u306b\u3088\u308a\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u3082\u306e\u304c\u3042\u308a\u307e\u3059\u3002\n\u5229\u7528\u65b9\u6cd5\u306f\u3001\u307e\u305apipista.py\u3092\u30b3\u30d4\u30fc\u3057\u3066\u3001Extension\u30d5\u30a9\u30eb\u30c0\u30fc\u5185\u306b\u4f5c\u308a\u307e\u3059\u3002\n\u4f5c\u6210\u3057\u305f\u5f8c\u3001\u53f3\u304b\u3089\u5de6\u3078\u30b9\u30e9\u30a4\u30c9\u3055\u305b\u3066\u3001\u30a8\u30c7\u30a3\u30bf\u30fc\u30e2\u30fc\u30c9\u304b\u3089\u30b3\u30f3\u30bd\u30fc\u30eb\u30e2\u30fc\u30c9\u3078\u79fb\u52d5\u3057\u307e\u3059\u3002\n\u7d9a\u3044\u3066\u3001\u4e0b\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30fb\u53c2\u8003\u5143 pythonista-tools-installer\n\npythonista\u30b3\u30f3\u30bd\u30fc\u30eb\n> import pipista\n> pipista.install_xmlrpclib()\n\n\n\u3068\u5b9f\u884c\u3059\u308c\u3070\u3001xmlrpclib\u304c\u540c\u4e00\u30d5\u30a9\u30eb\u30c0\u30fc\u5185\u306b\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\u3055\u308c\u305f\u5f8c\u3001Extension\u30d5\u30a9\u30eb\u30c0\u30fc\u5185\u306b\u3042\u308bptinstaller.py\u3092\u958b\u304d\u3001\u5b9f\u884c\u30dc\u30bf\u30f3\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\u3046\u307e\u304f\u3044\u3051\u3070\u3053\u3061\u3089\u306e\u3088\u3046\u306b\u3001ptinstaller\u306eUI\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\u3053\u306e\u4e2d\u306ePypi Modules\u3092\u30bf\u30c3\u30d7\u3057\u3066\u3001wagenheber\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u3053\u3061\u3089\u306f\u3001pipista\u306e\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u306eTextField\u306bPypi\u306b\u3042\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\u3092\u5165\u308c\u308b\u3053\u3068\u3067\u3001pip\u3057\u3066\u304f\u308c\u308b\u3068\u3044\u3046\u512a\u308c\u3082\u306e\u3002\n\u81ea\u5206\u3067\u3082pip\u30b3\u30de\u30f3\u30c9\u3092\u4f5c\u6210\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3060\u304c\u3001\u4eca\u56de\u306f\u697d\u3092\u3057\u3066\u624b\u306b\u5165\u308c\u307e\u3059\u3002\n\u7d9a\u3044\u3066\u3001wagenheber.py\u3092\u958b\u304d\u3001\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30bf\u30c3\u30d7\u3057\u3066\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u8868\u793a\u3055\u305b\u307e\u3059\u3002\n\u30c0\u30a4\u30a2\u30ed\u30b0\u5185\u306b\u3001pafy\u3068\u5165\u529b\u3057\u3001\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u3057\u3070\u3089\u304f\u5f85\u3063\u3066\u3044\u308b\u3068\u30b3\u30f3\u30bd\u30fc\u30eb\u753b\u9762\u306b\u30c0\u30fc\u30fc\u30fc\u30fc\u30fc\u3068\u6587\u5b57\u304c\u8868\u793a\u3055\u308c\u3001\u3044\u308d\u3044\u308d\u7d42\u3048\u305f\u5f8c\u306b\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u307e\u3059\u3002\n\nwagenheber.py\u306e\u30a8\u30e9\u30fc\u3068\u5bfe\u51e6\u6cd5\nwagenheber.py\u306b\u306f\u3001urllib2\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u300cSettings>GENERAL>Default Interpreter\u300d\u306b\u3066\u30012.7\u3068\u3057\u3066\u3001\u5b9f\u884c\u3059\u308c\u3070\u3001\u5b9f\u884c\u53ef\u80fd\u3067\u3059\u3002\n\u307e\u305f\u306f\u3001\u300cwagenheber.py\u3068pipista.py\u300d\u3092\u300cPython 2 to 3\u300d\u3057\u3066\u3042\u3052\u308c\u3070\u3001\u3044\u3051\u307e\u3059\u3002\n\n\u8ffd\u8a18(10/3 0:30\u3054\u308d)\uff1a\nwagenheber.py\u3092\u4f7f\u3063\u3066\u3001ProtocolError\u304c\u767a\u751f\u3059\u308b\u5834\u5408\u306e\u5bfe\u51e6\u65b9\n\nwagenheber.py\n...\n# 'http://...' \u2192 'https://...' \u300cHTTP\u300d\u304b\u3089\u300cHTTPS\u300d\u3078URL\u3092\u5909\u66f4\u3002\nPYPI_URL = 'https://pypi.python.org/pypi'\n...\n\n\n\n\npafy\u306e\u5b9f\u884c\u524d\u306b\u3059\u308b\u3053\u3068\n\u300csite-packages\u300d\u3078pafy\u30d5\u30a9\u30eb\u30c0\u30fc\u5168\u4f53\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u79fb\u52d5\u3055\u305b\u308b\u3002\n\u79fb\u52d5\u5f8c\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u3066\u3001import pafy\u3068\u5165\u529b\u3057\u3001\u30a8\u30e9\u30fc\u304c\u306a\u3051\u308c\u3070\u3001\u30d1\u30b9\u304c\u901a\u3063\u3066\u3044\u308b\u72b6\u614b\u306a\u306e\u3067\u3001\u3069\u3053\u304b\u3089\u3067\u3082\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u3067\u3059\u3002\n\nytdl.py\nimport pafy\nurl = '- \u3088\u3046\u3064\u3079\u3055\u3093\u306e\u52d5\u753bURL -'\n\n# \u52d5\u753b\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306e\u304a\u307e\u3058\u306a\u3044\nvideo = pafy.new(url)\nprint video\n\n# \u52d5\u753b\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306e\u304a\u307e\u3058\u306a\u3044\nbest = video.getbest()\nprint best\n\n# \u52d5\u753b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u306e\u5b9f\u884c\nbest.download()\n\n\n\n\nUI\u3068\u30a2\u30d7\u30ea\u9023\u52d5\u3092\u5145\u5b9f\u3055\u305b\u305f\u3082\u306e\n\u3055\u3089\u306b\u4fbf\u5229\u306b\u3059\u308b\u305f\u3081\u306b\u3001UI\u3068\u30a2\u30d7\u30ea\u304b\u3089\u547c\u3073\u51fa\u305b\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u307f\u305f\u3002\n\n\nytdl.py\n#coding: utf-8\n# \u30a4\u30f3\u30dd\u30fc\u30c8\u7fa4\nfrom __future__ import division\nimport ui\nimport clipboard\nfrom console import hud_alert\nimport time, re, sys\nimport pafy\nimport appex\n\n# \u5404\u7a2e\u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\nv = ui.load_view('ytdl_ui')\nld1 = v['lb1']\ntf1 = v['tf1']\nimg = v['iv1']\n\n# YouTube\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u51e6\u7406: \u30e1\u30a4\u30f3\nclass ytdl(object):\n    def __init__(self, detas):\n        self.detas = detas\n        self.video = pafy.new(self.detas)\n        self.best = self.video.getbest()\n\n    # \u30b5\u30fc\u30c1\u53d7\u3051\u6e21\u3057\u51e6\u7406: \u30b5\u30d6\n    def search(self):\n        img.load_from_url(self.video.thumb)\n        ld1.text = '%s %s' % (self.video, self.best)\n\n    # \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u5b9f\u884c\u51e6\u7406: \u30b5\u30d6\n    def download(self):\n        try:\n            title_name = self.best.title\n            title_name = title_name.gsub(\" \", \"\")\n            print(title_name)\n            # dl\u30d5\u30a9\u30eb\u30c0\u30fc\u3078\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n            self.best.download(filepath='./dl/'+title_name+'.'+self.best.extension)\n        except:\n            print('DL Error.')\n\n# \u30b5\u30fc\u30c1\u30dc\u30bf\u30f3\u51e6\u7406\ndef button_sc(sender):\n    '@type sender: ui.Button'\n    global url\n    lb1 = sender.superview['lb1']\n    if tf1.text != '':\n        url = tf1.text\n        _ytdl = ytdl(url)\n        _ytdl.search()\n    else:\n        lb1.text = 'no url.'\n\n# \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3\u51e6\u7406\ndef button_dl(sender):\n    '@type sender: ui.Button'\n    global url\n    lb1 = sender.superview['lb1']\n    try:\n        if url != '':\n            url = tf1.text\n            _ytdl = ytdl(url)\n            _ytdl.download()\n        else:\n            hud_alert('no url.')\n        hud_alert('End.')\n    except:\n        hud_alert('Error')\n        print('01 error.')\n\n\n# UI\u4f5c\u6210\u3001\u64cd\u4f5c\nbtn = v['btn1']\nbtn.action = button_sc\n\nbtn2 = v['btn2']\nbtn2.action = button_dl\n\ndef main(args):\n    if len(args) == 2:\n        url = args[1]\n    else:\n        url = appex.get_text()\n\n    if not url:\n        print('No input URL found.')\n        hud_alert('No input URL found.')\n        return\n\n    if not appex.is_running_extension():\n        print('This script is intended to be run from the sharing extension.')\n        hud_alert('This script is intended to be run from the sharing extension.')\n        return\n    url = appex.get_text()\n    if not url:\n        print('No input URL found.')\n        hud_alert('No input URL found.')\n        return\n    print(url)\n    tf1.text = url\n    ytdl.search(url)\n\n# \u7aef\u672b\u8abf\u6574\u30b3\u30fc\u30c9\nif min(ui.get_screen_size()) >= 768:\n    # iPad\n    v.frame = (0, 0, 360, 400)\n    v.present('sheet')\nelse:\n    # iPhone\n    v.present(orientations=['portrait'])\n\n# \u5b9f\u884c\u51e6\u7406: \u521d\u671f\u5316\nif __name__ == '__main__':\n    main(sys.argv)\n\n\n\n\n\u203b\u6ce8\u610f\u3053\u306e\u30b3\u30fc\u30c9\u306f\u3001\u300cdl\u300d\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u30fc\u3078\u683c\u7d0d\u3059\u308b\u305f\u3081\u3001\u3042\u3089\u304b\u3058\u3081\u300cdl\u300d\u30d5\u30a9\u30eb\u30c0\u30fc\u3092\u4f5c\u6210\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u307e\u3068\u3081\n\u30fbpip\u306e\u74b0\u5883\u69cb\u7bc9\n\u30fbpipUI\u306e\u305f\u3081\u306e\u74b0\u5883\u69cb\u7bc9\n\u30fbpafy\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u8ffd\u52a0\n\u30fbpafy\u306e\u4f7f\u7528\u8aac\u660e\n\u30fbpafy\u306bUI\u3001\u30a2\u30d7\u30ea\u9023\u52d5\u3092\u8ffd\u52a0\n# Pythonista [iOS\u7528 Python]\n[Pythonista](http://omz-software.com/pythonista/)\u3068\u306f\u3001iOS\u7aef\u672b\u3092\u5f37\u529b\u306b\u3057\u3066\u304f\u308c\u308b\u30a2\u30d7\u30ea\u3067\u3059\u3002\n\n\u4eca\u56de\u306f\u3001youtube\u304b\u3089\u52d5\u753b\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\u304b\u3092\u8a66\u3057\u3066\u307f\u305f\u3002\nPython\u30e2\u30b8\u30e5\u30fc\u30eb\u306e[pafy](https://pypi.python.org/pypi/pafy)\u3092\u5229\u7528\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u25a1 \u5fc5\u8981\u306a\u77e5\u8b58\n\n- [x] Python\n\n\n## \u74b0\u5883\u69cb\u7bc9\u7de8\nPythonista\u306f[pypi](https://pypi.python.org/pypi)\u304b\u3089pip\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u4e00\u90e8\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u203b\u5168\u3066\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u3084OS\u306a\u3069\u306b\u3088\u308a\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u3082\u306e\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u5229\u7528\u65b9\u6cd5\u306f\u3001\u307e\u305a[pipista.py](https://gist.github.com/pudquick/4116558)\u3092\u30b3\u30d4\u30fc\u3057\u3066\u3001Extension\u30d5\u30a9\u30eb\u30c0\u30fc\u5185\u306b\u4f5c\u308a\u307e\u3059\u3002\n\u4f5c\u6210\u3057\u305f\u5f8c\u3001\u53f3\u304b\u3089\u5de6\u3078\u30b9\u30e9\u30a4\u30c9\u3055\u305b\u3066\u3001\u30a8\u30c7\u30a3\u30bf\u30fc\u30e2\u30fc\u30c9\u304b\u3089\u30b3\u30f3\u30bd\u30fc\u30eb\u30e2\u30fc\u30c9\u3078\u79fb\u52d5\u3057\u307e\u3059\u3002\n\n\u7d9a\u3044\u3066\u3001\u4e0b\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30fb\u53c2\u8003\u5143 [pythonista-tools-installer](https://github.com/ywangd/pythonista-tools-installer)\n\n```python:pythonista\u30b3\u30f3\u30bd\u30fc\u30eb\n> import pipista\n> pipista.install_xmlrpclib()\n```\n\n\u3068\u5b9f\u884c\u3059\u308c\u3070\u3001xmlrpclib\u304c\u540c\u4e00\u30d5\u30a9\u30eb\u30c0\u30fc\u5185\u306b\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\u3055\u308c\u305f\u5f8c\u3001Extension\u30d5\u30a9\u30eb\u30c0\u30fc\u5185\u306b\u3042\u308bptinstaller.py\u3092\u958b\u304d\u3001\u5b9f\u884c\u30dc\u30bf\u30f3\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n![ptinstaller](https://qiita-image-store.s3.amazonaws.com/0/12007/bf15cf8e-d8ca-42ca-6669-c111d5f103a3.png)\n\n\u3046\u307e\u304f\u3044\u3051\u3070\u3053\u3061\u3089\u306e\u3088\u3046\u306b\u3001ptinstaller\u306eUI\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\u3053\u306e\u4e2d\u306ePypi Modules\u3092\u30bf\u30c3\u30d7\u3057\u3066\u3001wagenheber\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u3053\u3061\u3089\u306f\u3001pipista\u306e\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u306eTextField\u306bPypi\u306b\u3042\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\u3092\u5165\u308c\u308b\u3053\u3068\u3067\u3001pip\u3057\u3066\u304f\u308c\u308b\u3068\u3044\u3046\u512a\u308c\u3082\u306e\u3002\n\u81ea\u5206\u3067\u3082pip\u30b3\u30de\u30f3\u30c9\u3092\u4f5c\u6210\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3060\u304c\u3001\u4eca\u56de\u306f\u697d\u3092\u3057\u3066\u624b\u306b\u5165\u308c\u307e\u3059\u3002\n\n\u7d9a\u3044\u3066\u3001wagenheber.py\u3092\u958b\u304d\u3001\u5b9f\u884c\u30dc\u30bf\u30f3\u3092\u30bf\u30c3\u30d7\u3057\u3066\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u8868\u793a\u3055\u305b\u307e\u3059\u3002\n\u30c0\u30a4\u30a2\u30ed\u30b0\u5185\u306b\u3001pafy\u3068\u5165\u529b\u3057\u3001\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u3057\u3070\u3089\u304f\u5f85\u3063\u3066\u3044\u308b\u3068\u30b3\u30f3\u30bd\u30fc\u30eb\u753b\u9762\u306b\u30c0\u30fc\u30fc\u30fc\u30fc\u30fc\u3068\u6587\u5b57\u304c\u8868\u793a\u3055\u308c\u3001\u3044\u308d\u3044\u308d\u7d42\u3048\u305f\u5f8c\u306b\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u307e\u3059\u3002\n\n## wagenheber.py\u306e\u30a8\u30e9\u30fc\u3068\u5bfe\u51e6\u6cd5\nwagenheber.py\u306b\u306f\u3001urllib2\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u300cSettings>GENERAL>Default Interpreter\u300d\u306b\u3066\u30012.7\u3068\u3057\u3066\u3001\u5b9f\u884c\u3059\u308c\u3070\u3001\u5b9f\u884c\u53ef\u80fd\u3067\u3059\u3002\n\n\u307e\u305f\u306f\u3001\u300cwagenheber.py\u3068pipista.py\u300d\u3092\u300cPython 2 to 3\u300d\u3057\u3066\u3042\u3052\u308c\u3070\u3001\u3044\u3051\u307e\u3059\u3002\n\n\n# \u8ffd\u8a18(10/3 0:30\u3054\u308d)\uff1a \n**wagenheber.py\u3092\u4f7f\u3063\u3066\u3001ProtocolError\u304c\u767a\u751f\u3059\u308b\u5834\u5408\u306e\u5bfe\u51e6\u65b9**\n\n```pytho:wagenheber.py\n...\n# 'http://...' \u2192 'https://...' \u300cHTTP\u300d\u304b\u3089\u300cHTTPS\u300d\u3078URL\u3092\u5909\u66f4\u3002\nPYPI_URL = 'https://pypi.python.org/pypi'\n...\n```\n\n---\n\n## pafy\u306e\u5b9f\u884c\u524d\u306b\u3059\u308b\u3053\u3068\n\u300csite-packages\u300d\u3078pafy\u30d5\u30a9\u30eb\u30c0\u30fc\u5168\u4f53\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u79fb\u52d5\u3055\u305b\u308b\u3002\n\n\u79fb\u52d5\u5f8c\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u3066\u3001`import pafy`\u3068\u5165\u529b\u3057\u3001\u30a8\u30e9\u30fc\u304c\u306a\u3051\u308c\u3070\u3001\u30d1\u30b9\u304c\u901a\u3063\u3066\u3044\u308b\u72b6\u614b\u306a\u306e\u3067\u3001\u3069\u3053\u304b\u3089\u3067\u3082\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n```python:ytdl.py\nimport pafy\nurl = '- \u3088\u3046\u3064\u3079\u3055\u3093\u306e\u52d5\u753bURL -'\n\n# \u52d5\u753b\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306e\u304a\u307e\u3058\u306a\u3044\nvideo = pafy.new(url)\nprint video\n\n# \u52d5\u753b\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306e\u304a\u307e\u3058\u306a\u3044\nbest = video.getbest()\nprint best\n\n# \u52d5\u753b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u306e\u5b9f\u884c\nbest.download()\n\n```\n\n# UI\u3068\u30a2\u30d7\u30ea\u9023\u52d5\u3092\u5145\u5b9f\u3055\u305b\u305f\u3082\u306e\n\u3055\u3089\u306b\u4fbf\u5229\u306b\u3059\u308b\u305f\u3081\u306b\u3001UI\u3068\u30a2\u30d7\u30ea\u304b\u3089\u547c\u3073\u51fa\u305b\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u307f\u305f\u3002\n![ytdl-ui.py](https://qiita-image-store.s3.amazonaws.com/0/12007/964d41eb-f578-45a7-b1e4-bb85d49045a9.jpeg)\n\n\n```python:ytdl.py\n#coding: utf-8\n# \u30a4\u30f3\u30dd\u30fc\u30c8\u7fa4\nfrom __future__ import division\nimport ui\nimport clipboard\nfrom console import hud_alert\nimport time, re, sys\nimport pafy\nimport appex\n\n# \u5404\u7a2e\u30b0\u30ed\u30fc\u30d0\u30eb\u5909\u6570\nv = ui.load_view('ytdl_ui')\nld1 = v['lb1']\ntf1 = v['tf1']\nimg = v['iv1']\n\n# YouTube\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u51e6\u7406: \u30e1\u30a4\u30f3\nclass ytdl(object):\n\tdef __init__(self, detas):\n\t\tself.detas = detas\n\t\tself.video = pafy.new(self.detas)\n\t\tself.best = self.video.getbest()\n\n\t# \u30b5\u30fc\u30c1\u53d7\u3051\u6e21\u3057\u51e6\u7406: \u30b5\u30d6\n\tdef search(self):\n\t\timg.load_from_url(self.video.thumb)\n\t\tld1.text = '%s %s' % (self.video, self.best)\n\n\t# \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u5b9f\u884c\u51e6\u7406: \u30b5\u30d6\n\tdef download(self):\n\t\ttry:\n\t\t\ttitle_name = self.best.title\n\t\t\ttitle_name = title_name.gsub(\" \", \"\")\n\t\t\tprint(title_name)\n            # dl\u30d5\u30a9\u30eb\u30c0\u30fc\u3078\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n\t\t\tself.best.download(filepath='./dl/'+title_name+'.'+self.best.extension)\n\t\texcept:\n\t\t\tprint('DL Error.')\n\n# \u30b5\u30fc\u30c1\u30dc\u30bf\u30f3\u51e6\u7406\ndef button_sc(sender):\n\t'@type sender: ui.Button'\n\tglobal url\n\tlb1 = sender.superview['lb1']\n\tif tf1.text != '':\n\t\turl = tf1.text\n\t\t_ytdl = ytdl(url)\n\t\t_ytdl.search()\n\telse:\n\t\tlb1.text = 'no url.'\n\n# \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3\u51e6\u7406\ndef button_dl(sender):\n\t'@type sender: ui.Button'\n\tglobal url\n\tlb1 = sender.superview['lb1']\n\ttry:\n\t\tif url != '':\n\t\t\turl = tf1.text\n\t\t\t_ytdl = ytdl(url)\n\t\t\t_ytdl.download()\n\t\telse:\n\t\t\thud_alert('no url.')\n\t\thud_alert('End.')\n\texcept:\n\t\thud_alert('Error')\n\t\tprint('01 error.')\n\n\n# UI\u4f5c\u6210\u3001\u64cd\u4f5c\nbtn = v['btn1']\nbtn.action = button_sc\n\nbtn2 = v['btn2']\nbtn2.action = button_dl\n\ndef main(args):\n\tif len(args) == 2:\n\t\turl = args[1]\n\telse:\n\t\turl = appex.get_text()\n\n\tif not url:\n\t\tprint('No input URL found.')\n\t\thud_alert('No input URL found.')\n\t\treturn\n\n\tif not appex.is_running_extension():\n\t\tprint('This script is intended to be run from the sharing extension.')\n\t\thud_alert('This script is intended to be run from the sharing extension.')\n\t\treturn\n\turl = appex.get_text()\n\tif not url:\n\t\tprint('No input URL found.')\n\t\thud_alert('No input URL found.')\n\t\treturn\n\tprint(url)\n\ttf1.text = url\n\tytdl.search(url)\n\n# \u7aef\u672b\u8abf\u6574\u30b3\u30fc\u30c9\nif min(ui.get_screen_size()) >= 768:\n\t# iPad\n\tv.frame = (0, 0, 360, 400)\n\tv.present('sheet')\nelse:\n\t# iPhone\n\tv.present(orientations=['portrait'])\n\n# \u5b9f\u884c\u51e6\u7406: \u521d\u671f\u5316\nif __name__ == '__main__':\n\tmain(sys.argv)\n\n```\n\u203b\u6ce8\u610f\u3053\u306e\u30b3\u30fc\u30c9\u306f\u3001\u300cdl\u300d\u3068\u3044\u3046\u30d5\u30a9\u30eb\u30c0\u30fc\u3078\u683c\u7d0d\u3059\u308b\u305f\u3081\u3001\u3042\u3089\u304b\u3058\u3081\u300cdl\u300d\u30d5\u30a9\u30eb\u30c0\u30fc\u3092\u4f5c\u6210\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n---\n# \u307e\u3068\u3081\n\u30fbpip\u306e\u74b0\u5883\u69cb\u7bc9\n\u30fbpipUI\u306e\u305f\u3081\u306e\u74b0\u5883\u69cb\u7bc9\n\u30fbpafy\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u8ffd\u52a0\n\u30fbpafy\u306e\u4f7f\u7528\u8aac\u660e\n\u30fbpafy\u306bUI\u3001\u30a2\u30d7\u30ea\u9023\u52d5\u3092\u8ffd\u52a0\n", "tags": ["Pythonista", "Pythonista3", "Python", "ios10"]}