{"context": " More than 1 year has passed since last update.\n\n\u524d\u56de\u8a18\u4e8b\nMac OS X \u306b Fluentd \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066 Ruby \u304b\u3089\u30ed\u30b0\u51fa\u529b\u3057\u3066\u307f\u308b\n\n\u524d\u63d0\nMongoDB \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u3053\u3067\u306f Homebrew \u3067\u5165\u308c\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\nMongoDB \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ngem \u3067 fluent-plugin-mongo \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ gem install fluent-plugin-mongo\n\n\u3053\u306e\u307e\u307e Fluentd \u3092\u8d77\u52d5\u3059\u308b\u3068\u3001\n**Notice: C extension not loaded. This is required for optimum MongoDB Ruby driver performance.\n  You can install the extension as follows:\n  gem install bson_ext\n\nIf you continue to receive this message after installing, make sure that the bson_ext gem is in your load path and that the bson_ext and mongo gems are of the same version.\n\n\u3068\u8a00\u308f\u308c\u305f\u306e\u3067\u3001mongo \u3068\u540c\u3058\u30d0\u30fc\u30b8\u30e7\u30f3\u306e bson_ext \u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u3002\n$ gem install bson_ext\n\n\nFluentd \u306e\u8a2d\u5b9a\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u306e debug.** \u306e\u90e8\u5206\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u3048\u3066\u3001\u6a19\u6e96\u51fa\u529b\u3068 MongoDB \u306e\u4e21\u65b9\u306b\u30ed\u30b0\u3092\u98db\u3070\u3059\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n<match debug.**>\n  type copy\n  <store>\n    type stdout\n  </store>\n  <store>\n    type mongo\n    host localhost\n    database fluent\n    collection debug\n  </store>\n</match>\n\n\nMongoDB \u306b\u30ed\u30b0\u51fa\u529b\u3057\u3066\u307f\u308b\n\u4e0a\u8a18\u8a2d\u5b9a\u3067 Fluentd \u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n$ fluentd -c ./fluent/fluent.conf\n2012-11-28 14:53:10 +0900: starting fluentd-0.10.29\n2012-11-28 14:53:10 +0900: reading config file path=\"./fluent/fluent.conf\"\n2012-11-28 14:53:10 +0900: adding source type=\"forward\"\n2012-11-28 14:53:10 +0900: adding source type=\"http\"\n2012-11-28 14:53:10 +0900: adding source type=\"debug_agent\"\n2012-11-28 14:53:10 +0900: adding match pattern=\"debug.**\" type=\"copy\"\n2012-11-28 14:53:10 +0900: listening fluent socket on 0.0.0.0:24224\n2012-11-28 14:53:10 +0900: listening dRuby uri=\"druby://0.0.0.0:24230\" object=\"Engine\"\n\n\u3059\u308b\u3068\u3001\u30ed\u30fc\u30ab\u30eb\u306e MongoDB \u306b fluent \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3001debug \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u81ea\u52d5\u3067\u4f5c\u3089\u308c\u307e\u3057\u305f\u3002\n\u305d\u3057\u3066\u3001\n$ echo '{\"hoge\":\"fuga\"}' | fluent-cat debug.test\n\n\u306a\u3069\u3068\u51fa\u529b\u3059\u308b\u3068\u3001\u6a19\u6e96\u51fa\u529b\u306b\n2012-11-28 14:58:12 +0900 debug.test: {\"hoge\":\"fuga\"}\n\n\u3068\u8868\u793a\u3055\u308c\u3001MongoDB \u306e\u65b9\u306b\u3082\u3001\n$ mongo fluent\nMongoDB shell version: 2.2.1\nconnecting to: fluent\n> db.debug.find()\n{ \"_id\" : ObjectId(\"50b5a7f7e0395a29bd000001\"), \"hoge\" : \"fuga\", \"time\" : ISODate(\"2012-11-28T05:58:12Z\") }\n\n\u3068\u3044\u3046\u5f62\u3067\u683c\u7d0d\u3055\u308c\u307e\u3057\u305f\u3002\n\n## \u524d\u56de\u8a18\u4e8b\n[Mac OS X \u306b Fluentd \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066 Ruby \u304b\u3089\u30ed\u30b0\u51fa\u529b\u3057\u3066\u307f\u308b](http://qiita.com/items/2dd7d135671c36fc9a20)\n\n## \u524d\u63d0\n[MongoDB](http://www.mongodb.org) \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u3053\u3067\u306f [Homebrew](http://mxcl.github.com/homebrew/) \u3067\u5165\u308c\u305f\u3082\u306e\u3092\u4f7f\u3063\u3066\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\n## MongoDB \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\ngem \u3067 [fluent-plugin-mongo](https://github.com/fluent/fluent-plugin-mongo) \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$ gem install fluent-plugin-mongo\n```\n\n\u3053\u306e\u307e\u307e Fluentd \u3092\u8d77\u52d5\u3059\u308b\u3068\u3001\n\n```\n**Notice: C extension not loaded. This is required for optimum MongoDB Ruby driver performance.\n  You can install the extension as follows:\n  gem install bson_ext\n\nIf you continue to receive this message after installing, make sure that the bson_ext gem is in your load path and that the bson_ext and mongo gems are of the same version.\n```\n\n\u3068\u8a00\u308f\u308c\u305f\u306e\u3067\u3001`mongo` \u3068\u540c\u3058\u30d0\u30fc\u30b8\u30e7\u30f3\u306e `bson_ext` \u3082\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3057\u305f\u3002\n\n```\n$ gem install bson_ext\n```\n\n\n## Fluentd \u306e\u8a2d\u5b9a\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u306e `debug.**` \u306e\u90e8\u5206\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u3048\u3066\u3001\u6a19\u6e96\u51fa\u529b\u3068 MongoDB \u306e\u4e21\u65b9\u306b\u30ed\u30b0\u3092\u98db\u3070\u3059\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n```\n<match debug.**>\n  type copy\n  <store>\n    type stdout\n  </store>\n  <store>\n    type mongo\n    host localhost\n    database fluent\n    collection debug\n  </store>\n</match>\n```\n\n## MongoDB \u306b\u30ed\u30b0\u51fa\u529b\u3057\u3066\u307f\u308b\n\n\u4e0a\u8a18\u8a2d\u5b9a\u3067 Fluentd \u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n$ fluentd -c ./fluent/fluent.conf\n2012-11-28 14:53:10 +0900: starting fluentd-0.10.29\n2012-11-28 14:53:10 +0900: reading config file path=\"./fluent/fluent.conf\"\n2012-11-28 14:53:10 +0900: adding source type=\"forward\"\n2012-11-28 14:53:10 +0900: adding source type=\"http\"\n2012-11-28 14:53:10 +0900: adding source type=\"debug_agent\"\n2012-11-28 14:53:10 +0900: adding match pattern=\"debug.**\" type=\"copy\"\n2012-11-28 14:53:10 +0900: listening fluent socket on 0.0.0.0:24224\n2012-11-28 14:53:10 +0900: listening dRuby uri=\"druby://0.0.0.0:24230\" object=\"Engine\"\n```\n\n\u3059\u308b\u3068\u3001\u30ed\u30fc\u30ab\u30eb\u306e MongoDB \u306b `fluent` \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3001`debug` \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304c\u81ea\u52d5\u3067\u4f5c\u3089\u308c\u307e\u3057\u305f\u3002\n\n\u305d\u3057\u3066\u3001\n\n```\n$ echo '{\"hoge\":\"fuga\"}' | fluent-cat debug.test\n```\n\n\u306a\u3069\u3068\u51fa\u529b\u3059\u308b\u3068\u3001\u6a19\u6e96\u51fa\u529b\u306b\n\n```\n2012-11-28 14:58:12 +0900 debug.test: {\"hoge\":\"fuga\"}\n```\n\n\u3068\u8868\u793a\u3055\u308c\u3001MongoDB \u306e\u65b9\u306b\u3082\u3001\n\n```\n$ mongo fluent\nMongoDB shell version: 2.2.1\nconnecting to: fluent\n> db.debug.find()\n{ \"_id\" : ObjectId(\"50b5a7f7e0395a29bd000001\"), \"hoge\" : \"fuga\", \"time\" : ISODate(\"2012-11-28T05:58:12Z\") }\n```\n\n\u3068\u3044\u3046\u5f62\u3067\u683c\u7d0d\u3055\u308c\u307e\u3057\u305f\u3002", "tags": ["fluentd", "MongoDB"]}