{"tags": ["PHP", "blowfish", "\u6697\u53f7\u5316"], "context": " More than 1 year has passed since last update.\n\nPHP\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\nphp\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u5f37\u529b\u306a\u30cf\u30c3\u30b7\u30e5\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u4f7f\u7528\u3057\u3066\u3001\u30cf\u30c3\u30b7\u30e5\u5316\u3092\u884c\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u6ce8\u610f\nphp5.6\u3088\u308a\u524d\u3067\u306f\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u3082\u3046\u4e00\u5ea6\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3066\u3001\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u691c\u8a3c\u3092\u3057\u307e\u3059\u304c\u3001\nphp5.6\u4ee5\u964d\u3067\u306f\u3001\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u6bd4\u8f03\u306bhash_equals()\u95a2\u6570\u3092\u7528\u3044\u307e\u3059\u3002\n\nCrypt Blowfish\n\u5f37\u529b\u306a\u30cf\u30c3\u30b7\u30e5\u65b9\u5f0f\n\nSalt\u306e\u751f\u6210\nSalt\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u6642\u306b\u3001\u6bce\u56de\u751f\u6210\u3057\u307e\u3059\u3002\n// $str\u304b\u3089\u4e71\u6570\u3067\u6587\u5b57\u5217\u3092\u53d6\u5f97\u3057\u3066\u3001$salt\u306bcrypt\u306esalt\u3092\u751f\u6210\u3059\u308b\n    $str  = array_merge(range('a', 'z'), range('0', '9'), range('A', 'Z'),array(\".\",\"/\"));\n    // \u30e9\u30f3\u30c0\u30e0\u306a\u6587\u5b57\u5217\u309222\u6587\u5b57\u53d6\u5f97\n    $max  = 22;\n\n    // Blowfish\u3092\u30cf\u30c3\u30b7\u30e5\u5f62\u5f0f\u306b\u6307\u5b9a\u3001\u30b9\u30c8\u30ec\u30c3\u30c1\u7528\u306e\u30b3\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\n    $salt = \"$2y$04$\";\n\n    for ($i = 1; $i <= $max; $i++) {\n        $salt .= $str[rand(0, count($str)-1)];\n    }\n\n\nBlowfish\u5f62\u5f0f\u3067\u6697\u53f7\u5316\n    // \u30cf\u30c3\u30b7\u30e5\u5316\n    $hashedPassword = crypt($password, $salt);\n\n\n\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u7167\u5408\uff08php5.6\u3088\u308a\u524d\u306e\u5834\u5408)\n   if(crypt($password, $hashedPassword)==$hashedPassword){\n       // \u7167\u5408\u6210\u529f\n   }\n\n$hashedPassword\u3092crypt()\u95a2\u6570\u3067\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u3001\u898b\u305f\u76ee\u4e0a\u6c17\u6301\u3061\u60aa\u3044\u3067\u3059\u304c\u3001\n\u3053\u306e\u5834\u5408\u3001crypt()\u95a2\u6570\u304c\u4f7f\u7528\u3059\u308b\u306e\u306f\u6700\u521d\u306b\u751f\u6210\u3057\u305fsalt\u90e8\u5206\u307e\u3067\u306b\u306a\u308a\u307e\u3059\u3002\nsalt\u4ee5\u964d\u306f\u7121\u8996\u3055\u308c\u3001\u6700\u521d\u306e\u30cf\u30c3\u30b7\u30e5\u5316\u306e\u969b\u306b\u4f7f\u7528\u3057\u305fsalt\u90e8\u5206\u3060\u3051\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u7167\u5408(php5.6)\nif (hash_equals($hashedPassword, crypt($password, $hashedPassword)) {\n   // \u7167\u5408\u6210\u529f\n}\n\n# PHP\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\nphp\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u5f37\u529b\u306a\u30cf\u30c3\u30b7\u30e5\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u4f7f\u7528\u3057\u3066\u3001\u30cf\u30c3\u30b7\u30e5\u5316\u3092\u884c\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u6ce8\u610f\nphp5.6\u3088\u308a\u524d\u3067\u306f\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u3082\u3046\u4e00\u5ea6\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3066\u3001\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u691c\u8a3c\u3092\u3057\u307e\u3059\u304c\u3001\nphp5.6\u4ee5\u964d\u3067\u306f\u3001\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u6bd4\u8f03\u306bhash_equals()\u95a2\u6570\u3092\u7528\u3044\u307e\u3059\u3002\n\n## Crypt Blowfish\n\u5f37\u529b\u306a\u30cf\u30c3\u30b7\u30e5\u65b9\u5f0f\n\n## Salt\u306e\u751f\u6210\nSalt\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u6642\u306b\u3001\u6bce\u56de\u751f\u6210\u3057\u307e\u3059\u3002\n\n```php\n// $str\u304b\u3089\u4e71\u6570\u3067\u6587\u5b57\u5217\u3092\u53d6\u5f97\u3057\u3066\u3001$salt\u306bcrypt\u306esalt\u3092\u751f\u6210\u3059\u308b\n    $str  = array_merge(range('a', 'z'), range('0', '9'), range('A', 'Z'),array(\".\",\"/\"));\n    // \u30e9\u30f3\u30c0\u30e0\u306a\u6587\u5b57\u5217\u309222\u6587\u5b57\u53d6\u5f97\n    $max  = 22;\n\n    // Blowfish\u3092\u30cf\u30c3\u30b7\u30e5\u5f62\u5f0f\u306b\u6307\u5b9a\u3001\u30b9\u30c8\u30ec\u30c3\u30c1\u7528\u306e\u30b3\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u6307\u5b9a\n    $salt = \"$2y$04$\";\n\n    for ($i = 1; $i <= $max; $i++) {\n        $salt .= $str[rand(0, count($str)-1)];\n    }\n```\n\n## Blowfish\u5f62\u5f0f\u3067\u6697\u53f7\u5316\n\n```php\n    // \u30cf\u30c3\u30b7\u30e5\u5316\n    $hashedPassword = crypt($password, $salt);\n```\n\n## \u30cf\u30c3\u30b7\u30e5\u5024\u306e\u7167\u5408\uff08php5.6\u3088\u308a\u524d\u306e\u5834\u5408)\n\n```php\n   if(crypt($password, $hashedPassword)==$hashedPassword){\n       // \u7167\u5408\u6210\u529f\n   }\n```\n$hashedPassword\u3092crypt()\u95a2\u6570\u3067\u4f7f\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u3001\u898b\u305f\u76ee\u4e0a\u6c17\u6301\u3061\u60aa\u3044\u3067\u3059\u304c\u3001\n\u3053\u306e\u5834\u5408\u3001crypt()\u95a2\u6570\u304c\u4f7f\u7528\u3059\u308b\u306e\u306f\u6700\u521d\u306b\u751f\u6210\u3057\u305fsalt\u90e8\u5206\u307e\u3067\u306b\u306a\u308a\u307e\u3059\u3002\nsalt\u4ee5\u964d\u306f\u7121\u8996\u3055\u308c\u3001\u6700\u521d\u306e\u30cf\u30c3\u30b7\u30e5\u5316\u306e\u969b\u306b\u4f7f\u7528\u3057\u305fsalt\u90e8\u5206\u3060\u3051\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n## \u30cf\u30c3\u30b7\u30e5\u5024\u306e\u7167\u5408(php5.6)\n\n```php\nif (hash_equals($hashedPassword, crypt($password, $hashedPassword)) {\n   // \u7167\u5408\u6210\u529f\n}\n```\n"}