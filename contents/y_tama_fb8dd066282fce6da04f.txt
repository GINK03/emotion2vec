{"tags": ["SoftLayer", "vagrant", "chef"], "context": " More than 1 year has passed since last update.Vagrant\u3092SoftLayer\u4e0a\u3067\u52d5\u304b\u3057\u3001\u7c21\u5358\u306b\u3067\u3059\u304cchef\u3068\u306e\u9023\u643a\u3082\u884c\u3063\u305f\u306e\u3067\u3001\u8a18\u9332\u3092\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n(2016/3/4\u306eSoftLayer\u52c9\u5f37\u4f1a\u3067\u767a\u8868\u3057\u305f\u5185\u5bb9\u306e\u8a73\u7d30\u7248\u3067\u3059\u3002\u767a\u8868\u8cc7\u6599\u306f\u3053\u3061\u3089\u3002)\nVagrant\u306f\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u306e\u4f5c\u6210\u30fb\u524a\u9664\u30fb\u518d\u69cb\u7bc9\u3092\u5bb9\u6613\u306b\u884c\u3048\u308b\u30c4\u30fc\u30eb\u3067\u3059\u3002\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\u306e\u5f8c\u5de5\u7a0b\u3068\u3057\u3066\u3001\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3084Chef\u3084Ansible\u3084Puppet\u3068\u306e\u9023\u643a\u3082\u3067\u304d\u307e\u3059\u306e\u3067\u3001vagrant up\u30b3\u30de\u30f3\u30c9\u306e\u307f\u3067\u3001\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3061\u4e0a\u3052\u3001\u5fc5\u8981\u306a\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u5165\u308c\u308b\u4e8b\u3082\u53ef\u80fd\u3067\u3059\u306e\u3067\u3001\u958b\u767a\u74b0\u5883\u3092\u6e96\u5099\u3059\u308b\u6642\u306a\u3069\u306b\u4fbf\u5229\u306a\u30c4\u30fc\u30eb\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4eca\u56de\u306e\u69cb\u6210\u56f3\n\u4eca\u56de\u306f\u3001\u4e0b\u56f3\u306e\u3088\u3046\u306a\u69cb\u6210\u3092SoftLayer\u4e0a\u306b\u4f5c\u308a\u307e\u3059\u3002\nVagrant\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u89aa\u30b5\u30fc\u30d0\u30fc\u3092SoftLayer\u4e0a\u306b1\u53f0\u4f5c\u308a\u307e\u3059\uff08\u3053\u308c\u306f\u624b\u52d5\u3067\u4f5c\u6210\u3057\u307e\u3059\uff09\u3002\n\u305d\u3053\u306b\u3001Vagrant\u81ea\u4f53\u3084SoftLayer\u7528\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u89aa\u30b5\u30fc\u30d0\u30fc\u3067vagrant up\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4ecb\u3057\u3066SoftLayer\u306eAPI\u304c\u547c\u3073\u51fa\u3055\u308c\u3001SoftLayer\u304c\u7528\u610f\u3057\u3066\u3044\u308bOS\u30a4\u30e1\u30fc\u30b8\u3084\u3001\u30a4\u30e1\u30fc\u30b8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u57fa\u306b\u3057\u3066\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u304c\u4f5c\u3089\u308c\u307e\u3059\u3002\n\n\n\u4e8b\u524d\u6e96\u5099\n\u4e0a\u56f3\u3067\u3001\u4e8b\u524d\u6e96\u5099\u306e\uff11\u3068\uff12\u3068\u66f8\u3044\u305f\u90e8\u5206\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\u307e\u305a\uff11\u3064\u76ee\u306f\u3001SoftLayer\u306e\u30e6\u30fc\u30b6\u30fcID\u3068API\u30ad\u30fc\u3092\u30e1\u30e2\u3057\u3066\u304a\u304d\u3001\u5f8c\u3067Vagrantfile\u5185\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u3053\u308c\u306f\u3001Vagrant\u304cSoftLayer\u306eAPI\u3092\u547c\u3073\u51fa\u3059\u969b\u306e\u8a8d\u8a3c\u7528\u306b\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u60c5\u5831\u306f\u3001SoftLayer\u306e\u7ba1\u7406\u30dd\u30fc\u30bf\u30eb\u3067\u3001Account > Users \u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u3001\u53c2\u7167\u53ef\u80fd\u3067\u3059\u3002\n\n\uff12\u3064\u76ee\u306e\u6e96\u5099\u306f\u3001SSH\u7528\u306e\u516c\u958b\u9375\u3092SoftLayer\u306e\u7ba1\u7406\u30dd\u30fc\u30bf\u30eb\u304b\u3089\u767b\u9332\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u3001vagrant ssh\u30b3\u30de\u30f3\u30c9\u3067\u3001\u89aa\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u306bssh\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u969b\u306b\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\u516c\u958b\u9375\u3068\u79d8\u5bc6\u9375\u306e\u30da\u30a2\u306f\u3001\u4e8b\u524d\u306b\u3069\u3053\u304b\u306eLinux\u30b5\u30fc\u30d0\u30fc\uff08\u3082\u3061\u308d\u3093\u89aa\u30b5\u30fc\u30d0\u30fc\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\uff09\u3067ssh-keygen\u30b3\u30de\u30f3\u30c9\u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u516c\u958b\u9375\u3092\u3001SoftLayer\u306e\u7ba1\u7406\u30dd\u30fc\u30bf\u30eb\u3067\u3001Devices > Manage > SSH Keys \u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u3001\u767b\u9332\u3057\u307e\u3059\u3002\n\u79d8\u5bc6\u9375\u306f\u89aa\u30b5\u30fc\u30d0\u30fc\u4e0a\u306b\u914d\u7f6e\u3057\u3001Vagrantfile\u5185\u3067\u5834\u6240\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\nVagrant\u3068SoftLayer\u7528\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4e8b\u524d\u6e96\u5099\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u3044\u3088\u3044\u3088\u89aa\u30b5\u30fc\u30d0\u30fc\u306bVagrant\u3068\u3001SoftLayer\u7528\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nVagrant\u672c\u4f53\u306f\u3001rpm\u3092hashicorp\u793e\u306e\u30b5\u30a4\u30c8\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\nhttps://www.vagrantup.com/downloads.html\n# rpm -ivh https://releases.hashicorp.com/vagrant/1.8.1/vagrant_1.8.1_x86_64.rpm\nRetrieving https://releases.hashicorp.com/vagrant/1.8.1/vagrant_1.8.1_x86_64.rpm\nPreparing...                ########################################### [100%]\n   1:vagrant                ########################################### [100%]\n# vagrant version\nInstalled Version: 1.8.1\nLatest Version: 1.8.1\n\nYou're running an up-to-date version of Vagrant!\n#\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306f\u3001vagrant plugin install\u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n# vagrant plugin install vagrant-softlayer\nInstalling the 'vagrant-softlayer' plugin. This can take a few minutes...\nInstalled the plugin 'vagrant-softlayer (0.4.0)'!\n# vagrant plugin list\nvagrant-share (1.1.5, system)\nvagrant-softlayer (0.4.0)\n#\n\n\nVagrantfile\u7de8\u96c6\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\uff11\u3064\u4f5c\u308a\u3001\u305d\u3053\u306b\u79fb\u52d5\u3057\u3066vagrant init\u30b3\u30de\u30f3\u30c9\u3067\u521d\u671f\u5316\u3057\u307e\u3059\u3002\n# mkdir vagrant\n# cd vagrant\n# vagrant init\nA `Vagrantfile` has been placed in this directory. You are now\nready to `vagrant up` your first virtual environment! Please read\nthe comments in the Vagrantfile as well as documentation on\n`vagrantup.com` for more information on using Vagrant.\n# ls\nVagrantfile\n#\n\n\u3053\u308c\u306b\u3001SoftLayer\u7528\u306e\u8a18\u8ff0\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\u9805\u76ee\u306e\u8a73\u7d30\u306a\u610f\u5473\u306f\u3001\u4e0b\u8a18\u306bREADME\u304c\u3042\u308a\u307e\u3059\u3002\nhttps://github.com/audiolize/vagrant-softlayer/blob/master/README.md\nVagrantfile\u306f\u3001\u4e00\u4f8b\u3068\u3057\u3066\u306f\u3053\u306e\u3088\u3046\u306a\u5185\u5bb9\u306b\u306a\u308a\u307e\u3059\u3002\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n# Vagrantfile API/syntax version. Don't touch unless you know what you're doing!\nVAGRANTFILE_API_VERSION = \"2\"\n\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n    config.vm.box = \"dummy\"\n    config.vm.box_url = \"https://github.com/audiolize/vagrant-softlayer/raw/master/dummy.box\"\n    config.ssh.pty = true\n    config.ssh.private_key_path = \"/root/.ssh/id_rsa\"\n    config.vm.synced_folder \".\", \"/vagrant\", type: \"rsync\", disabled: true\n    config.ssh.username = \"root\"\n\n    config.vm.provider :softlayer do | sl, override |\n            sl.api_key = \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n            sl.username = \"xxxxxxx\"\n            sl.datacenter   = \"che01\"\n            sl.dedicated    = false\n            sl.domain       = \"softlayer.com\"\n            sl.disk_capacity = { 0 => 25 }\n#            sl.private_only = true\n            sl.force_private_ip = true\n            sl.hostname     = \"vagrant03\"\n            sl.hourly_billing = true\n            sl.image_guid   = nil\n            sl.local_disk   = false\n            sl.max_memory   = 1024\n            sl.network_speed = 100\n            sl.operating_system = \"CENTOS_LATEST\"\n            sl.ssh_key = [ \"tamatest_key\" ]\n            sl.start_cpus   = 1\n\n            override.ssh.username = \"root\"\n    end\nend\n\n\nvagrant up\u5b9f\u884c\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30bb\u30c3\u30c8\u3057\u3066 vagrant up \u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n# vagrant up\nBringing machine 'default' up with 'softlayer' provider...\n==> default: Box 'dummy' could not be found. Attempting to find and install...\n    default: Box Provider: softlayer\n    default: Box Version: >= 0\n==> default: Box file was not detected as metadata. Adding it directly...\n==> default: Adding box 'dummy' (v0) for provider: softlayer\n    default: Downloading: https://github.com/audiolize/vagrant-softlayer/raw/master/dummy.box\n==> default: Successfully added box 'dummy' (v0) for 'softlayer'!\n==> default: Creating a new SoftLayer instance...\n==> default: Waiting for instance provisioning. This may take a few minutes...\n==> default: SoftLayer instance successfully provisioned!\n==> default: Waiting for machine to boot. This may take a few minutes...\n    default: SSH address: 10.xx.xx.xxx:22\n    default: SSH username: root\n    default: SSH auth method: private key\n==> default: Machine booted and ready!\n#\n\n\u7ba1\u7406\u30dd\u30fc\u30bf\u30eb\u4e0a\u3067\u3082\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u304c\u4f5c\u6210\u4e2d\u3067\u3042\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\n\u30a4\u30e1\u30fc\u30b8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304b\u3089\u306e\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\n\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u3001SoftLayer\u304c\u7528\u610f\u3057\u3066\u3044\u308b\u65b0\u898f\u30b5\u30fc\u30d0\u30fc\u7528\u306e\u30a4\u30e1\u30fc\u30b8\uff08\u7d20\u306eOS\u30a4\u30e1\u30fc\u30b8\uff09\u3092\u4f7f\u3063\u3066\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\u305d\u308c\u4ee5\u5916\u306b\u3001Image Template\u3092\u4f7f\u7528\u3057\u3066\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u5fc5\u8981\u3068\u306a\u308b\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3084\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u5c0e\u5165\u3057\u305fImage Template\u3092\u3042\u3089\u304b\u3058\u3081\u7528\u610f\u3057\u3066\u304a\u3044\u3066\u3001\u305d\u308c\u3092\u30b4\u30fc\u30eb\u30c7\u30f3\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u4f7f\u3046\u3053\u3068\u3067\u52b9\u7387\u7684\u306b\u958b\u767a\u74b0\u5883\u3092\u6e96\u5099\u3067\u304d\u307e\u3059\u3002\nImage Template\u306b\u306fguid\u3068\u3044\u3046\u4e00\u610f\u306eID\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u305d\u308c\u3092Vagrantfile\u5185\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\nguid\u306f\u3001SLCLI\u306e slcli image list\u30b3\u30de\u30f3\u30c9\u3067\u53c2\u7167\u3067\u304d\u307e\u3059\u3002\nSLCLI\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u306e\u8a18\u4e8b\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\u30bd\u30d5\u30c8\u30ec\u30a4\u30e4\u30fc\u6d3b\u7528\u30ac\u30a4\u30c9\u3000\u30b3\u30de\u30f3\u30c9\u3067\u30b5\u30fc\u30d0\u30fc\u3092\u30aa\u30fc\u30c0\u30fc\u3059\u308b\u306b\u306f\uff1f\nhttps://www.change-makers.jp/post/10352\n# slcli image list\n:......................................:....................................................:....................:............:.........:\n:                 guid                 :                        name                        :        type        : visibility : account :\n:......................................:....................................................:....................:............:.........:\n: 719113ed-c060-43f3-8c5c-8889f8b4df01 : 25GB - Ubuntu / Ubuntu / 14.04-64 Minimal for VSI  :       System       :   Public   :  208938 :\n: b14a49a2-648b-4cea-9194-17120e98138f : 25GB - Ubuntu / Ubuntu / 12.04-64 Minimal for VSI  :       System       :   Public   :  208938 :\n: 2402ec54-6dd8-4391-846a-772406fa76cd :    25GB - Redhat / EL / 5.5-64 Minimal for VSI     :       System       :   Public   :  208938 :\n: 56c35934-1caa-408f-9e38-b36e4368e3b7 : 100GB - Ubuntu / Ubuntu / 14.04-32 Minimal for VSI :       System       :   Public   :  208938 :\n: 0e4b036f-8287-4ff9-ac9b-77883c245e49 :    100GB - Redhat / EL / 5.5-32 Minimal for VSI    :       System       :   Public   :  208938 :\n: f5d6c60f-d6cf-4d0b-a424-5e661e2dea47 : 100GB - Debian / Debian / 8.0.0-64 Minimal for VSI :       System       :   Public   :  208938 :\n: 76575ef6-7227-4e76-a85f-b16e0c8cad27 :  25GB - CentOS / CentOS / 5.6-32 Minimal for VSI   :       System       :   Public   :  208938 :\n: a3ebe687-87cc-4651-a53c-5d10c47292c1 :    100GB - Redhat / EL / 6.0-32 Minimal for VSI    :       System       :   Public   :  208938 :\n: 6d801d2c-2a16-44ac-8d32-7da1a752f4f1 :  25GB - CentOS / CentOS / 6.0-32 Minimal for VSI   :       System       :   Public   :  208938 :\n\nVagrantfile\u3067\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u6307\u5b9a\u3057\u307e\u3059\u3002\uff08\u524d\u8ff0\u306e\u30b5\u30f3\u30d7\u30eb\u3068\u306e\u5dee\u5206\u3060\u3051\u66f8\u3044\u3066\u3044\u307e\u3059\uff09\nsl.image_guid   = \"719113ed-c060-43f3-8c5c-8889f8b4df01\"\nsl.operating_system = nil\n# sl.disk_capacity = { 0 => 25 }\n\nguid\u3092\u6307\u5b9a\u3057\u305f\u6642\u306f\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306bsl.operating_system\u3092\u660e\u793a\u7684\u306bnil\u306b\u3057\u3001sl.disk_capacity\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u306a\u3044\u3068\u3001vagrant up\u6642\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n# vagrant up\nThere are errors in the configuration of this machine. Please fix\nthe following errors and try again:\n\nSoftLayer:\n* The image guid for a compute or flex image and the operating\nsystem reference code cannot be used at the same time.\nPlease use only one of the following options in the provider\nsection:\n\nconfig.vm.provider :softlayer do |sl|\n  sl.image_guid = \"AAAAAAAA-BBBB-CCCC-DDDD-EEEEEEEEEEEE\"\nend\n\nconfig.vm.provider :softlayer do |sl|\n  sl.operating_system = \"UBUNTU_LATEST\"\nend\n\n#\n\n# vagrant up\nThere are errors in the configuration of this machine. Please fix\nthe following errors and try again:\n\nSoftLayer:\n* The disk capacity can only be specified when using an operating\nsystem reference code and not when using a specific compute or\nflex image guid. Please use one of the following options in the\nprovider section:\n\nconfig.vm.provider :softlayer do |sl|\n  sl.image_guid = \"AAAAAAAA-BBBB-CCCC-DDDD-EEEEEEEEEEEE\"\nend\n\nconfig.vm.provider :softlayer do |sl|\n  sl.operating_system = \"UBUNTU_LATEST\"\n\n  # Disk number 1 is reserved for SWAP space, see SoftLayer API\n  # CLI tool command 'sl cci create-options' for more info.\n  sl.disk_capacity = { 0 => 25, 2 => 100, 3 => 2000 }\nend\n\n#\n\n\n\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u306e\u9023\u643a\nvagrant up\u306e\u51e6\u7406\u306e\u4e2d\u3067\u3001\u89aa\u30b5\u30fc\u30d0\u30fc\u306b\u7f6e\u3044\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3001\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u4e0a\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\u5f8c\u306e\u5b9a\u578b\u4f5c\u696d\u306b\u4fbf\u5229\u3067\u3001\u7528\u9014\u3068\u3057\u3066\u306f\u3001iptables\u306e\u8a2d\u5b9a\u3001OS\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u3001\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306e\u5c0e\u5165 \u306a\u3069\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002\nSoftLayer\u306eProvisioning script\uff08 https://www.change-makers.jp/post/10294 \uff09\u3092\u4f7f\u3063\u3066\u3082\u540c\u69d8\u306e\u4e8b\u304c\u5b9f\u73fe\u3067\u304d\u307e\u3059\u304c\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u3092HTTPS\u30b5\u30fc\u30d0\u30fc\u306b\u914d\u7f6e\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u4e21\u65b9\u4f7f\u3063\u3066\u307f\u305f\u611f\u60f3\u3068\u3057\u3066\u306f\u3001Vagrant\u306e\u307b\u3046\u304c\u624b\u8efd\u306e\u3088\u3046\u306b\u611f\u3058\u307e\u3057\u305f\u3002\nVagrantfile\u306b\u306f\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\nconfig.vm.provision :shell, :path => \"./provisioning.sh\",:privileged   => true\nprovisioning.sh\u306f\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3001\u901a\u5e38\u306e\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u3057\u3066\u8a18\u8ff0\u3057\u307e\u3059\u3002\u4f8b\u3068\u3057\u3066\u3001\u6700\u65b0\u306eOS\u30d1\u30c3\u30c1\u3092\u9069\u7528\u3057\u3001\u30a6\u30a7\u30d6\u30b5\u30fc\u30d0\u30fc\u3092\u5c0e\u5165\u30fb\u8d77\u52d5\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\n#!/bin/sh\n\n# yum update all\nyum -y update\n\n# install apach webserver\nyum install -y httpd\nservice httpd start\nchkconfig httpd on\n\n\nChef\u3068\u306e\u9023\u643a\n\u7c21\u6613\u306a\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u5c0e\u5165\u3067\u3042\u308c\u3070\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3082\u5341\u5206\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u5c11\u3057\u8907\u96d1\u306a\u69cb\u6210\u3084\u3001\u65e2\u5b58\u306erecipe\u304c\u3042\u308b\u5834\u5408\u306b\u306f\u3001Chef\u3068\u9023\u643a\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002Vagrantfile\u306bChef\u3068\u9023\u643a\u3059\u308b\u8a18\u8ff0\u3092\u3059\u308b\u4e8b\u3067\u3001vagrant up \u306e\u307f\u3067\u3001Chef\u306b\u3088\u308b\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u307e\u3067\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u306a\u304a\u3001\u4eca\u56de\u306f\u3001chef-zero\u306e\u6a5f\u80fd\u3092\u4f7f\u3044\u3001Chef\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u30ed\u30fc\u30ab\u30eb\u30e2\u30fc\u30c9\u3067\u52d5\u304b\u3057\u307e\u3059\u3002\nChef\u3092\u52d5\u304b\u3059\u305f\u3081\u306b\u89aa\u30b5\u30fc\u30d0\u30fc\u306b\u5c11\u3005\u306e\u8ffd\u52a0\u6e96\u5099\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u305d\u308c\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\nOS\u306b Development Tools\u5c0e\u5165\nVagrant\u306bChef\u95a2\u9023\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8ffd\u52a0\u3059\u308b\u969b\u306b\u5fc5\u8981\u3068\u306a\u308b\u305f\u3081\u3001Development Tools\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n# yum groupinstall -y \"Development Tools\"\n\n\nChef Development Kit \u5c0e\u5165\uff08chef, ruby, gem\uff09\n\u89aa\u30b5\u30fc\u30d0\u30fc\u3067\u3001Chef\u3001Ruby\u3001Gem\u304c\u52d5\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nChef Development Kit(Chef DK)\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u3053\u308c\u3089\u3092\u4e00\u5ea6\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\u4e0b\u8a18\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\nhttps://downloads.chef.io/chef-dk/redhat/\n# rpm -ivh https://opscode-omnibus-packages.s3.amazonaws.com/el/6/x86_64/chefdk-0.11.2-1.el6.x86_64.rpm\nRetrieving https://opscode-omnibus-packages.s3.amazonaws.com/el/6/x86_64/chefdk-0.11.2-1.el6.x86_64.rpm\nwarning: /var/tmp/rpm-tmp.CMDJ51: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY\nPreparing...                ########################################### [100%]\n   1:chefdk                 ########################################### [100%]\nThank you for installing Chef Development Kit!\n#\n\n\u4e0a\u8a18\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3059\u308b\u3068chef\u30b3\u30de\u30f3\u30c9\u306f\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u304c\u3001gem\u306f\u307e\u3060\u30d1\u30b9\u304c\u901a\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u4f7f\u3048\u307e\u305b\u3093\u3002eval \"$(chef shell-init bash)\"\u30b3\u30de\u30f3\u30c9\u3067\u3001\u5fc5\u8981\u306a\u74b0\u5883\u5909\u6570\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067gem\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\"bash\"\u306e\u90e8\u5206\u306f\u3001echo $SHELL\u3067\u81ea\u5206\u306e\u30b7\u30a7\u30eb\u74b0\u5883\u3092\u78ba\u8a8d\u3057\u3066\u6307\u5b9a\u3057\u307e\u3059\u3002\n# which chef\n/usr/bin/chef\n# gem\n-bash: gem: command not found\n# echo $SHELL\n/bin/bash\n# eval \"$(chef shell-init bash)\"\n# which gem\n/opt/chefdk/embedded/bin/gem\n#\n\n\u3061\u306a\u307f\u306b\u3001chef shell-init bash\u306e\u51fa\u529b\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\n# chef shell-init bash\nexport PATH=\"/opt/chefdk/bin:/root/.chefdk/gem/ruby/2.1.0/bin:/opt/chefdk/embedded/bin:/opt/chefdk/bin:/root/.chefdk/gem/ruby/2.1.0/bin:/opt/chefdk/embedded/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin\"\nexport GEM_ROOT=\"/opt/chefdk/embedded/lib/ruby/gems/2.1.0\"\nexport GEM_HOME=\"/root/.chefdk/gem/ruby/2.1.0\"\nexport GEM_PATH=\"/root/.chefdk/gem/ruby/2.1.0:/opt/chefdk/embedded/lib/ruby/gems/2.1.0\"\n_chef_comp() {\n    local COMMANDS=\"exec env gem generate shell-init install update push push-archive show-policy diff provision export clean-policy-revisions clean-policy-cookbooks delete-policy-group delete-policy undelete verify\"\n    COMPREPLY=($(compgen -W \"$COMMANDS\" -- ${COMP_WORDS[COMP_CWORD]} ))\n}\ncomplete -F _chef_comp chef\n\n#\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u304a\u3057\u3066\u3082\u4e0a\u8a18\u306e\u74b0\u5883\u5909\u6570\u304c\u6709\u52b9\u306b\u306a\u308b\u3088\u3046\u3001profile\u306b\u3082\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n# echo 'eval \"$(chef shell-init bash)\"' >> ~/.bash_profile\n\n\nVagrant\u30d7\u30e9\u30b0\u30a4\u30f3\uff08vagrant-omnibus\u3001vagrant-chef-zero\uff09\u5c0e\u5165\nvagrant-omnibus\u306f\u3001\u64cd\u4f5c\u5bfe\u8c61\u306e\u30b5\u30fc\u30d0\u30fc\u306bChef\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002\n# vagrant plugin install vagrant-omnibus\nInstalling the 'vagrant-omnibus' plugin. This can take a few minutes...\nInstalled the plugin 'vagrant-omnibus (1.4.1)'!\n#\n\nvagrant-chef-zero\u306f\u3001Vagrant\u304b\u3089Chef Zero Server\u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002\n# vagrant plugin install vagrant-chef-zero\nInstalling the 'vagrant-chef-zero' plugin. This can take a few minutes...\nInstalled the plugin 'vagrant-chef-zero (2.0.0)'!\n#\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5c0e\u5165\u72b6\u6cc1\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n# vagrant plugin list\nvagrant-chef-zero (2.0.0)\nvagrant-omnibus (1.4.1)\nvagrant-share (1.1.5, system)\nvagrant-softlayer (0.4.0)\n#\n\n\u306a\u304a\u3001vagrant-chef-zero\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u3001OS\u306bDevelopment Tools\u3084gem\u304c\u5165\u3063\u3066\u3044\u306a\u3044\u3068\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u4e8b\u524d\u306b\u524d\u9805\u307e\u3067\u306e\u524d\u63d0\u6761\u4ef6\u3092\u5c0e\u5165\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n# vagrant plugin install vagrant-chef-zero\nInstalling the 'vagrant-chef-zero' plugin. This can take a few minutes...\nBundler, the underlying system Vagrant uses to install plugins,\nreported an error. The error is shown below. These errors are usually\ncaused by misconfigured plugin installations or transient network\nissues. The error from Bundler is:\n\nAn error occurred while installing hitimes (1.2.3), and Bundler cannot continue.\nMake sure that `gem install hitimes -v '1.2.3'` succeeds before bundling.\n\nWarning: this Gemfile contains multiple primary sources. Using `source` more than once without a block is a security risk, and may result in installing unexpected gems. To resolve this warning, use a block to indicate which gems should come from the secondary source. To upgrade this warning to an error, run `bundle config disable_multisource true`.Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    /opt/vagrant/embedded/bin/ruby -r ./siteconf20160306-18625-dthbk2.rb extconf.rb\nchecking for clock_gettime() in -lrt... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=/opt/vagrant/embedded/bin/$(RUBY_BASE_NAME)\n        --with-rtlib\n        --without-rtlib\n/opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:541:in `try_link0'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:556:in `try_link'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:735:in `try_func'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:966:in `block in have_library'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:911:in `block in checking_for'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:351:in `block (2 levels) in postpone'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:321:in `open'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:351:in `block in postpone'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:321:in `open'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:347:in `postpone'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:910:in `checking_for'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:961:in `have_library'\n        from extconf.rb:10:in `<main>'\n\nextconf failed, exit code 1\n\nGem files will remain installed in /root/.vagrant.d/gems/gems/hitimes-1.2.3 for inspection.\nResults logged to /root/.vagrant.d/gems/extensions/x86_64-linux/2.2.0/hitimes-1.2.3/gem_make.out\n\n#\n\n\nChef\u521d\u671f\u5316\nVagrantfile\u304c\u914d\u7f6e\u3055\u308c\u305f\u30d5\u30a9\u30eb\u30c0\u3067\u3001chef generate repo chef-repo\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3001policy repository\u306e\u96db\u5f62\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n# ls\nVagrantfile\n# chef generate repo chef-repo\nCompiling Cookbooks...\nRecipe: code_generator::repo\n  * directory[/root/vagrant/chef-repo] action create\n(\u5f8c\u7565)\n\n# ls\nchef-repo  Vagrantfile\n#\n\n\n\nBerksfile\u4f5c\u6210\n# cd chef-repo/\n# ls\nchefignore  cookbooks  data_bags  environments  LICENSE  README.md  roles\n# vi Berksfile\n# cat Berksfile\nsource \"https://supermarket.chef.io\"\ncookbook 'apache2'\n#\n\n\nCookbook\u4f5c\u6210(berks vendor cookbooks)\n# berks vendor cookbooks\n/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/httpclient-2.6.0.1/lib/httpclient/webagent-cookie.rb:458: warning: already initialized constant HTTPClient::CookieManager\n/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/httpclient-2.6.0.1/lib/httpclient/cookie.rb:8: warning: previous definition of CookieManager was here\nResolving cookbook dependencies...\nFetching cookbook index from https://supermarket.chef.io...\nInstalling apache2 (3.1.0)\nVendoring apache2 (3.1.0) to cookbooks/apache2\n#\n\n\nVagrantfile\u306bchef\u7528\u8a2d\u5b9a\u8ffd\u8a18\n# cat Vagrantfile\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n# Vagrantfile API/syntax version. Don't touch unless you know what you're doing!\nVAGRANTFILE_API_VERSION = \"2\"\n\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n    config.vm.box = \"dummy\"\n    config.vm.box_url = \"https://github.com/audiolize/vagrant-softlayer/raw/master/dummy.box\"\n    config.ssh.pty = true\n    config.ssh.private_key_path = \"/root/.ssh/id_rsa\"\n    config.vm.synced_folder \".\", \"/vagrant\", type: \"rsync\", disabled: true\n    config.ssh.username = \"root\"\n    config.omnibus.chef_version = :latest\n\n    config.vm.provision \"chef_zero\" do |chef|\n        # Specify the local paths where Chef data is stored\n        chef.cookbooks_path = \"./chef-repo/cookbooks\"\n        chef.roles_path = \"./chef-repo/roles\"\n        chef.nodes_path = \"./chef-repo/cookbooks\"\n\n        # Add a recipe\n        chef.add_recipe \"apache2\"\n\n    end\n\n    config.vm.provider :softlayer do | sl, override |\n            sl.api_key = \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n            sl.username = \"xxxxxxx\"\n            sl.datacenter   = \"sea01\"\n            sl.dedicated    = false\n            sl.domain       = \"softlayer.com\"\n            sl.disk_capacity = { 0 => 25 }\n#            sl.private_only = true\n            sl.force_private_ip = true\n            sl.hostname     = \"vagrant03\"\n            sl.hourly_billing = true\n            sl.image_guid   = nil\n            sl.local_disk   = false\n            sl.max_memory   = 1024\n            sl.network_speed = 100\n            sl.operating_system = \"UBUNTU_14_64\"\n            sl.ssh_key = [ \"tamatest_key\" ]\n            sl.start_cpus   = 1\n\n            override.ssh.username = \"root\"\n    end\nend\n#\n\n\nvagrant up\nvagrant up\u30b3\u30de\u30f3\u30c9\u306e\u4e2d\u3067\u3001\u64cd\u4f5c\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u306bChef\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3001\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u30e2\u30fc\u30c9\u3067\u30a2\u30af\u30bb\u30b9\u3057\u306b\u884c\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n# vagrant up\nBringing machine 'default' up with 'softlayer' provider...\n==> default: Auto-generating node name for Chef...\n==> default: Creating a new SoftLayer instance...\n==> default: Waiting for instance provisioning. This may take a few minutes...\n==> default: SoftLayer instance successfully provisioned!\n==> default: Waiting for machine to boot. This may take a few minutes...\n    default: SSH address: 10.28.227.132:22\n    default: SSH username: root\n    default: SSH auth method: private key\n==> default: Machine booted and ready!\n==> default: Rsyncing folder: /root/vagrant/chef-repo/cookbooks/ => /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/cookbooks\n==> default: Rsyncing folder: /root/vagrant/chef-repo/roles/ => /tmp/vagrant-chef/05d0b4f19a1e6bdc34b5b3c14dd2fb5c/roles\n==> default: Rsyncing folder: /root/vagrant/chef-repo/cookbooks/ => /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/nodes\n==> default: Installing Chef 12.7.2 Omnibus package...\n==> default: Getting information for chef stable 12.7.2 for ubuntu...\n==> default: downloading https://omnitruck-direct.chef.io/stable/chef/metadata?v=12.7.2&p=ubuntu&pv=14.04&m=x86_64\n==> default:   to file /tmp/install.sh.2745/metadata.txt\n==> default: trying wget...\n==> default: url        https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/14.04/x86_64/chef_12.7.2-1_amd64.deb\n==> default: md5        b7acab8f396f8bb12fe39f42b3277bed\n==> default: sha256     0f543f51116fb498cf683e73b005cdd8ed0c8147ca5d10163377d9c1ab6a2cde\n==> default: version    12.7.2downloaded metadata file looks valid...\n==> default: downloading https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/14.04/x86_64/chef_12.7.2-1_amd64.deb\n==> default:   to file /tmp/install.sh.2745/chef_12.7.2-1_amd64.deb\n==> default: trying wget...\n==> default: Comparing checksum with sha256sum...\n==> default: Installing chef 12.7.2\n==> default: installing with dpkg...\n==> default: Selecting previously unselected package chef.\n(Reading database ... 47139 files and directories currently installed.)\n==> default: Preparing to unpack .../chef_12.7.2-1_amd64.deb ...\n==> default: Unpacking chef (12.7.2-1) ...\n==> default: Setting up chef (12.7.2-1) ...\n==> default: Thank you for installing Chef!\n==> default: Running provisioner: chef_zero...\n==> default: Detected Chef (latest) is already installed\n==> default: Generating chef JSON and uploading...\n==> default: Running chef-client (local-mode)...\n==> default: [2016-03-07T02:05:25-06:00] INFO: Started chef-zero at chefzero://localhost:8889 with repository at /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2\n==> default:   One version per cookbook\n==> default:   roles at /tmp/vagrant-chef/05d0b4f19a1e6bdc34b5b3c14dd2fb5c/roles\n==> default:\n==> default: [2016-03-07T02:05:25-06:00] INFO: Forking chef instance to converge...\n==> default: Starting Chef Client, version 12.7.2\n==> default: [2016-03-07T02:05:25-06:00] INFO: *** Chef 12.7.2 ***\n==> default: [2016-03-07T02:05:25-06:00] INFO: Chef-client pid: 3149\n==> default: [2016-03-07T02:05:27-06:00] INFO: HTTP Request Returned 404 Not Found: Object not found: chefzero://localhost:8889/nodes/vagrant-38b5c5d2\n==> default: [2016-03-07T02:05:27-06:00] INFO: Setting the run_list to [\"recipe[apache2]\"] from CLI options\n==> default: [2016-03-07T02:05:27-06:00] INFO: Run List is [recipe[apache2]]\n==> default: [2016-03-07T02:05:27-06:00] INFO: Run List expands to [apache2]\n==> default: [2016-03-07T02:05:27-06:00] INFO: Starting Chef Run for vagrant-38b5c5d2\n==> default: [2016-03-07T02:05:27-06:00] INFO: Running start handlers\n==> default: [2016-03-07T02:05:27-06:00] INFO: Start handlers complete.\n==> default: resolving cookbooks for run list: [\"apache2\"]\n==> default: [2016-03-07T02:05:27-06:00] INFO: Loading cookbooks [apache2@3.1.0]\n==> default: Synchronizing Cookbooks:\n==> default: [2016-03-07T02:05:27-06:00] INFO: Storing updated cookbooks/apache2/recipes/mod_charset_lite.rb in the cache.\n==> default: [2016-03-07T02:05:27-06:00] INFO: Storing updated cookbooks/apache2/recipes/mod_authn_dbd.rb in the cache.\n==> default: [2016-03-07T02:05:27-06:00] INFO: Storing updated cookbooks/apache2/recipes/mod_authn_anon.rb in the cache.\n==> default: [2016-03-07T02:05:27-06:00] INFO: Storing updated cookbooks/apache2/recipes/mod_fcgid.rb in the cache.\n\uff08\u5f8c\u7565\uff09\n\n\u4e0a\u8a18\u51e6\u7406\u306e\u5b8c\u4e86\u5f8c\u3001\u64cd\u4f5c\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u4e0a\u3067apache\u304c\u8d77\u52d5\u3057\u3066\u3044\u307e\u3057\u305f\u3002\nvagrant up\u30b3\u30de\u30f3\u30c9\u306e\u307f\u3067\u3001Chef\u306e\u30ec\u30b7\u30d4\u5b9f\u884c\u307e\u3067\u884c\u3048\u305f\u4e8b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n# ps -ef|grep apache\nroot      4103     1  0 02:05 ?        00:00:00 /usr/sbin/apache2 -k start\nwww-data  4296  4103  0 02:05 ?        00:00:00 /usr/sbin/apache2 -k start\nwww-data  4297  4103  0 02:05 ?        00:00:00 /usr/sbin/apache2 -k start\nwww-data  4431  4103  0 02:05 ?        00:00:00 /usr/sbin/apache2 -k start\nroot      4659  4582  0 02:07 pts/0    00:00:00 grep --color=auto apache\n#\n\n\n\u6b8b\u8ab2\u984c\nRedHat\u3084CentOS\u3060\u3068\u3001vagrant up\u4e2d\u306b\u4e0b\u8a18\u306e\u30a8\u30e9\u30fc\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\u30b0\u30b0\u308b\u3068\u3001Vagrantfile\u306b override.ssh.pty = true \u3092\u8a18\u8ff0\u3059\u308b\u4e8b\u3067\u3046\u307e\u304f\u3044\u304f\u3001\u3068\u3044\u3046\u60c5\u5831\u3082\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u304c\u5f53\u74b0\u5883\u306e\u5834\u5408\u306f\u305d\u308c\u3067\u306f\u89e3\u6c7a\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n# vagrant up\nBringing machine 'default' up with 'softlayer' provider...\n==> default: Auto-generating node name for Chef...\n==> default: Creating a new SoftLayer instance...\n==> default: Waiting for instance provisioning. This may take a few minutes...\n==> default: SoftLayer instance successfully provisioned!\n==> default: Waiting for machine to boot. This may take a few minutes...\n    default: SSH address: 10.28.227.133:22\n    default: SSH username: root\n    default: SSH auth method: private key\n==> default: Machine booted and ready!\n==> default: Rsyncing folder: /root/vagrant/chef-repo/cookbooks/ => /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/cookbooks\nThere was an error when attempting to rsync a synced folder.\nPlease inspect the error message below for more info.\n\nHost path: /root/vagrant/chef-repo/cookbooks/\nGuest path: /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/cookbooks\nCommand: rsync --verbose --archive --delete -z --copy-links --no-owner --no-group --rsync-path sudo rsync -e ssh -p 22 -o ControlMaster=auto -o ControlPath=/tmp/ssh.116 -o ControlPersist=10m -o StrictHostKeyChecking=no -o IdentitiesOnly=true -o UserKnownHostsFile=/dev/null -i '/root/.ssh/id_rsa' --exclude .vagrant/ /root/vagrant/chef-repo/cookbooks/ root@10.28.227.133:/tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/cookbooks\nError: Warning: Permanently added '10.28.227.133' (RSA) to the list of known hosts.\nsudo: sorry, you must have a tty to run sudo\nrsync: connection unexpectedly closed (0 bytes received so far) [sender]\nrsync error: error in rsync protocol data stream (code 12) at io.c(600) [sender=3.0.6]\n\n#\n\n\u4e0a\u8a18\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3082\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u81ea\u4f53\u306f\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4f5c\u6210\u3055\u308c\u305f\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u306bssh\u30ed\u30b0\u30a4\u30f3\u3057\u3001visudo\u3067/etc/sudoers\u306etty\u306e\u8a2d\u5b9a\u3092\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u66f4\u5f8c\u3001vagrant provision\u3092\u884c\u3048\u3070\u3001Chef\u306b\u3088\u308b\u8a2d\u5b9a\u307e\u3067\u884c\u3063\u3066\u304f\u308c\u307e\u3059\u3002\n\u5909\u66f4\u524d\nDefaults    requiretty\n\u5909\u66f4\u5f8c\nDefaults    !requiretty\nRedHat\u3084CentOS\u306e\u5834\u5408\u3001/etc/sudoers\u306b\u4e0a\u8a18\u306e\u5909\u66f4\u3092\u884c\u3063\u305f\u5f8c\u3067Image Template\u3092\u53d6\u5f97\u3057\u3001\u524d\u8ff0\u306e\u3088\u3046\u306b\u3001Vagrantfile\u3067\u30a4\u30e1\u30fc\u30b8\u306eguid\u3092\u6307\u5b9a\u3057\u3066\u3001\u30a4\u30e1\u30fc\u30b8\u304b\u3089\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u6210\u3059\u308b\u306e\u304c\u826f\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u304a\u308f\u308a\u306b\nVagrant\u306f\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u306e\u4f5c\u6210\u30fb\u524a\u9664\u30fb\u518d\u69cb\u7bc9\u3092\u5bb9\u6613\u306b\u884c\u3048\u308b\u30c4\u30fc\u30eb\u3067\u3059\u304c\u3001\u305d\u308c\u3060\u3051\u306b\u7559\u307e\u3089\u305a\u3001Image Template\u304b\u3089\u306e\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\u3084\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\u306e\u5f8c\u5de5\u7a0b\u3068\u3057\u3066\u3001\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3084Chef\u3068\u306e\u9023\u643a\u3082\u3067\u304d\u308b\u4e8b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\nvagrant up\u30b3\u30de\u30f3\u30c9\u306e\u307f\u3067\u3001\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3061\u4e0a\u3052\u3001\u5fc5\u8981\u306a\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u304c\u5c0e\u5165\u3055\u308c\u305f\u72b6\u614b\u306b\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u958b\u767a\u74b0\u5883\u3092\u6e96\u5099\u3059\u308b\u6642\u306a\u3069\u306b\u6709\u7528\u306a\u30c4\u30fc\u30eb\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u30ea\u30f3\u30af\n\u4eca\u56de\u306e\u5185\u5bb9\u3092\u8a66\u3059\u306b\u3042\u305f\u308a\u3001\u4e0b\u8a18\u306e\u60c5\u5831\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\nVagrant\u3067SoftLayer\u3092\u64cd\u4f5c\u3059\u308b\nhttp://niccloud.niandc.ne.jp/?p=749\nVagrant\u3067SoftLayer\u306b\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3092Provisioning\u3059\u308b\nhttp://qiita.com/takech9203/items/27e38278e7f71ca4d9ab\nChef\u3092\u4f7f\u3046\u306e\u306b\u5fc5\u8981\u306a\u74b0\u5883\u304c\u4e00\u6c17\u306b\u6574\u3046\u300cChefDK\u300d\u30ec\u30d3\u30e5\u30fc\nhttp://knowledge.sakura.ad.jp/tech/2825/\nVagrant \u3068 Chef \u306b\u3088\u308b\u4eee\u60f3\u74b0\u5883\u69cb\u7bc9\u306e\u81ea\u52d5\u5316\uff08VirtualBox\u7de8\uff09\nhttps://www.ogis-ri.co.jp/otc/hiroba/technical/vagrant-chef/chap1.html\n\u521d\u3081\u3066\u306e Vagrant + Chef zero + Berkshelf \nhttp://qiita.com/tsuyopooon/items/d90679d9f8b5ccfcfde5\nSoftLayer Tips \u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u30fb\u30b9\u30af\u30ea\u30d7\u30c8\u3068SSH\u9375\u3067\u306e\u30ed\u30b0\u30a4\u30f3\nhttps://ibm.biz/BdH4Yu\nChef Zero Provisioner\nhttps://www.vagrantup.com/docs/provisioning/chef_zero.html\nError: Missing required value for `chef.nodes_path'.\nhttps://github.com/r8/vagrant-lamp/issues/134\nVagrant\u3092SoftLayer\u4e0a\u3067\u52d5\u304b\u3057\u3001\u7c21\u5358\u306b\u3067\u3059\u304cchef\u3068\u306e\u9023\u643a\u3082\u884c\u3063\u305f\u306e\u3067\u3001\u8a18\u9332\u3092\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n(2016/3/4\u306eSoftLayer\u52c9\u5f37\u4f1a\u3067\u767a\u8868\u3057\u305f\u5185\u5bb9\u306e\u8a73\u7d30\u7248\u3067\u3059\u3002\u767a\u8868\u8cc7\u6599\u306f[\u3053\u3061\u3089](http://www.slideshare.net/yuichitamagawa/vagrant-on-softlayer)\u3002)\n\nVagrant\u306f\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u306e\u4f5c\u6210\u30fb\u524a\u9664\u30fb\u518d\u69cb\u7bc9\u3092\u5bb9\u6613\u306b\u884c\u3048\u308b\u30c4\u30fc\u30eb\u3067\u3059\u3002\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\u306e\u5f8c\u5de5\u7a0b\u3068\u3057\u3066\u3001\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3084Chef\u3084Ansible\u3084Puppet\u3068\u306e\u9023\u643a\u3082\u3067\u304d\u307e\u3059\u306e\u3067\u3001`vagrant up`\u30b3\u30de\u30f3\u30c9\u306e\u307f\u3067\u3001\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3061\u4e0a\u3052\u3001\u5fc5\u8981\u306a\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u5165\u308c\u308b\u4e8b\u3082\u53ef\u80fd\u3067\u3059\u306e\u3067\u3001\u958b\u767a\u74b0\u5883\u3092\u6e96\u5099\u3059\u308b\u6642\u306a\u3069\u306b\u4fbf\u5229\u306a\u30c4\u30fc\u30eb\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u4eca\u56de\u306e\u69cb\u6210\u56f3\n\u4eca\u56de\u306f\u3001\u4e0b\u56f3\u306e\u3088\u3046\u306a\u69cb\u6210\u3092SoftLayer\u4e0a\u306b\u4f5c\u308a\u307e\u3059\u3002\n\nVagrant\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u89aa\u30b5\u30fc\u30d0\u30fc\u3092SoftLayer\u4e0a\u306b1\u53f0\u4f5c\u308a\u307e\u3059\uff08\u3053\u308c\u306f\u624b\u52d5\u3067\u4f5c\u6210\u3057\u307e\u3059\uff09\u3002\n\u305d\u3053\u306b\u3001Vagrant\u81ea\u4f53\u3084SoftLayer\u7528\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\u89aa\u30b5\u30fc\u30d0\u30fc\u3067`vagrant up`\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4ecb\u3057\u3066SoftLayer\u306eAPI\u304c\u547c\u3073\u51fa\u3055\u308c\u3001SoftLayer\u304c\u7528\u610f\u3057\u3066\u3044\u308bOS\u30a4\u30e1\u30fc\u30b8\u3084\u3001\u30a4\u30e1\u30fc\u30b8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u57fa\u306b\u3057\u3066\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u304c\u4f5c\u3089\u308c\u307e\u3059\u3002\n\n![vagrant01.jpg](https://qiita-image-store.s3.amazonaws.com/0/59627/89bfcdaf-af52-3e12-1b02-0e21192174d5.jpeg)\n\n# \u4e8b\u524d\u6e96\u5099\n\u4e0a\u56f3\u3067\u3001\u4e8b\u524d\u6e96\u5099\u306e\uff11\u3068\uff12\u3068\u66f8\u3044\u305f\u90e8\u5206\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u307e\u305a\uff11\u3064\u76ee\u306f\u3001SoftLayer\u306e\u30e6\u30fc\u30b6\u30fcID\u3068API\u30ad\u30fc\u3092\u30e1\u30e2\u3057\u3066\u304a\u304d\u3001\u5f8c\u3067Vagrantfile\u5185\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u3053\u308c\u306f\u3001Vagrant\u304cSoftLayer\u306eAPI\u3092\u547c\u3073\u51fa\u3059\u969b\u306e\u8a8d\u8a3c\u7528\u306b\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\u3053\u306e\u60c5\u5831\u306f\u3001SoftLayer\u306e\u7ba1\u7406\u30dd\u30fc\u30bf\u30eb\u3067\u3001Account > Users \u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u3001\u53c2\u7167\u53ef\u80fd\u3067\u3059\u3002\n\n![vagrant02.jpg](https://qiita-image-store.s3.amazonaws.com/0/59627/738383fe-ffbe-d2fd-ddb6-ac260400dafb.jpeg)\n\n\uff12\u3064\u76ee\u306e\u6e96\u5099\u306f\u3001SSH\u7528\u306e\u516c\u958b\u9375\u3092SoftLayer\u306e\u7ba1\u7406\u30dd\u30fc\u30bf\u30eb\u304b\u3089\u767b\u9332\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u3001vagrant ssh\u30b3\u30de\u30f3\u30c9\u3067\u3001\u89aa\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u306bssh\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u969b\u306b\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u516c\u958b\u9375\u3068\u79d8\u5bc6\u9375\u306e\u30da\u30a2\u306f\u3001\u4e8b\u524d\u306b\u3069\u3053\u304b\u306eLinux\u30b5\u30fc\u30d0\u30fc\uff08\u3082\u3061\u308d\u3093\u89aa\u30b5\u30fc\u30d0\u30fc\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\uff09\u3067ssh-keygen\u30b3\u30de\u30f3\u30c9\u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u516c\u958b\u9375\u3092\u3001SoftLayer\u306e\u7ba1\u7406\u30dd\u30fc\u30bf\u30eb\u3067\u3001Devices > Manage > SSH Keys \u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u3001\u767b\u9332\u3057\u307e\u3059\u3002\n\u79d8\u5bc6\u9375\u306f\u89aa\u30b5\u30fc\u30d0\u30fc\u4e0a\u306b\u914d\u7f6e\u3057\u3001Vagrantfile\u5185\u3067\u5834\u6240\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n![vagrant03.jpg](https://qiita-image-store.s3.amazonaws.com/0/59627/61a48d41-1950-7b9f-77a1-8a259e71ae79.jpeg)\n\n\n# Vagrant\u3068SoftLayer\u7528\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u4e8b\u524d\u6e96\u5099\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u3044\u3088\u3044\u3088\u89aa\u30b5\u30fc\u30d0\u30fc\u306bVagrant\u3068\u3001SoftLayer\u7528\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\nVagrant\u672c\u4f53\u306f\u3001rpm\u3092hashicorp\u793e\u306e\u30b5\u30a4\u30c8\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\nhttps://www.vagrantup.com/downloads.html\n\n```\n# rpm -ivh https://releases.hashicorp.com/vagrant/1.8.1/vagrant_1.8.1_x86_64.rpm\nRetrieving https://releases.hashicorp.com/vagrant/1.8.1/vagrant_1.8.1_x86_64.rpm\nPreparing...                ########################################### [100%]\n   1:vagrant                ########################################### [100%]\n# vagrant version\nInstalled Version: 1.8.1\nLatest Version: 1.8.1\n\nYou're running an up-to-date version of Vagrant!\n#\n```\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306f\u3001`vagrant plugin install`\u30b3\u30de\u30f3\u30c9\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n\n```\n# vagrant plugin install vagrant-softlayer\nInstalling the 'vagrant-softlayer' plugin. This can take a few minutes...\nInstalled the plugin 'vagrant-softlayer (0.4.0)'!\n# vagrant plugin list\nvagrant-share (1.1.5, system)\nvagrant-softlayer (0.4.0)\n#\n```\n\n# Vagrantfile\u7de8\u96c6\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u305f\u3089\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\uff11\u3064\u4f5c\u308a\u3001\u305d\u3053\u306b\u79fb\u52d5\u3057\u3066`vagrant init`\u30b3\u30de\u30f3\u30c9\u3067\u521d\u671f\u5316\u3057\u307e\u3059\u3002\n\n```\n# mkdir vagrant\n# cd vagrant\n# vagrant init\nA `Vagrantfile` has been placed in this directory. You are now\nready to `vagrant up` your first virtual environment! Please read\nthe comments in the Vagrantfile as well as documentation on\n`vagrantup.com` for more information on using Vagrant.\n# ls\nVagrantfile\n#\n```\n\n\u3053\u308c\u306b\u3001SoftLayer\u7528\u306e\u8a18\u8ff0\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\u9805\u76ee\u306e\u8a73\u7d30\u306a\u610f\u5473\u306f\u3001\u4e0b\u8a18\u306bREADME\u304c\u3042\u308a\u307e\u3059\u3002\nhttps://github.com/audiolize/vagrant-softlayer/blob/master/README.md\n\nVagrantfile\u306f\u3001\u4e00\u4f8b\u3068\u3057\u3066\u306f\u3053\u306e\u3088\u3046\u306a\u5185\u5bb9\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n# Vagrantfile API/syntax version. Don't touch unless you know what you're doing!\nVAGRANTFILE_API_VERSION = \"2\"\n\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n    config.vm.box = \"dummy\"\n    config.vm.box_url = \"https://github.com/audiolize/vagrant-softlayer/raw/master/dummy.box\"\n    config.ssh.pty = true\n    config.ssh.private_key_path = \"/root/.ssh/id_rsa\"\n    config.vm.synced_folder \".\", \"/vagrant\", type: \"rsync\", disabled: true\n    config.ssh.username = \"root\"\n\n    config.vm.provider :softlayer do | sl, override |\n            sl.api_key = \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n            sl.username = \"xxxxxxx\"\n            sl.datacenter   = \"che01\"\n            sl.dedicated    = false\n            sl.domain       = \"softlayer.com\"\n            sl.disk_capacity = { 0 => 25 }\n#            sl.private_only = true\n            sl.force_private_ip = true\n            sl.hostname     = \"vagrant03\"\n            sl.hourly_billing = true\n            sl.image_guid   = nil\n            sl.local_disk   = false\n            sl.max_memory   = 1024\n            sl.network_speed = 100\n            sl.operating_system = \"CENTOS_LATEST\"\n            sl.ssh_key = [ \"tamatest_key\" ]\n            sl.start_cpus   = 1\n\n            override.ssh.username = \"root\"\n    end\nend\n```\n\n# vagrant up\u5b9f\u884c\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30bb\u30c3\u30c8\u3057\u3066 `vagrant up` \u30b3\u30de\u30f3\u30c9\u3092\u6253\u3064\u3068\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n```\n# vagrant up\nBringing machine 'default' up with 'softlayer' provider...\n==> default: Box 'dummy' could not be found. Attempting to find and install...\n    default: Box Provider: softlayer\n    default: Box Version: >= 0\n==> default: Box file was not detected as metadata. Adding it directly...\n==> default: Adding box 'dummy' (v0) for provider: softlayer\n    default: Downloading: https://github.com/audiolize/vagrant-softlayer/raw/master/dummy.box\n==> default: Successfully added box 'dummy' (v0) for 'softlayer'!\n==> default: Creating a new SoftLayer instance...\n==> default: Waiting for instance provisioning. This may take a few minutes...\n==> default: SoftLayer instance successfully provisioned!\n==> default: Waiting for machine to boot. This may take a few minutes...\n    default: SSH address: 10.xx.xx.xxx:22\n    default: SSH username: root\n    default: SSH auth method: private key\n==> default: Machine booted and ready!\n#\n```\n\n\u7ba1\u7406\u30dd\u30fc\u30bf\u30eb\u4e0a\u3067\u3082\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u304c\u4f5c\u6210\u4e2d\u3067\u3042\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n![vagrant04.jpg](https://qiita-image-store.s3.amazonaws.com/0/59627/5276509d-4b16-f620-2c13-34bda7525836.jpeg)\n\n\n# \u30a4\u30e1\u30fc\u30b8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304b\u3089\u306e\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\n\n\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u3001SoftLayer\u304c\u7528\u610f\u3057\u3066\u3044\u308b\u65b0\u898f\u30b5\u30fc\u30d0\u30fc\u7528\u306e\u30a4\u30e1\u30fc\u30b8\uff08\u7d20\u306eOS\u30a4\u30e1\u30fc\u30b8\uff09\u3092\u4f7f\u3063\u3066\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u307e\u3057\u305f\u3002\u305d\u308c\u4ee5\u5916\u306b\u3001Image Template\u3092\u4f7f\u7528\u3057\u3066\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u5fc5\u8981\u3068\u306a\u308b\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3084\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u5c0e\u5165\u3057\u305fImage Template\u3092\u3042\u3089\u304b\u3058\u3081\u7528\u610f\u3057\u3066\u304a\u3044\u3066\u3001\u305d\u308c\u3092\u30b4\u30fc\u30eb\u30c7\u30f3\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u4f7f\u3046\u3053\u3068\u3067\u52b9\u7387\u7684\u306b\u958b\u767a\u74b0\u5883\u3092\u6e96\u5099\u3067\u304d\u307e\u3059\u3002\nImage Template\u306b\u306fguid\u3068\u3044\u3046\u4e00\u610f\u306eID\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u305d\u308c\u3092Vagrantfile\u5185\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nguid\u306f\u3001SLCLI\u306e `slcli image list`\u30b3\u30de\u30f3\u30c9\u3067\u53c2\u7167\u3067\u304d\u307e\u3059\u3002\nSLCLI\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u306e\u8a18\u4e8b\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\n\u30bd\u30d5\u30c8\u30ec\u30a4\u30e4\u30fc\u6d3b\u7528\u30ac\u30a4\u30c9\u3000\u30b3\u30de\u30f3\u30c9\u3067\u30b5\u30fc\u30d0\u30fc\u3092\u30aa\u30fc\u30c0\u30fc\u3059\u308b\u306b\u306f\uff1f\nhttps://www.change-makers.jp/post/10352\n\n```\n# slcli image list\n:......................................:....................................................:....................:............:.........:\n:                 guid                 :                        name                        :        type        : visibility : account :\n:......................................:....................................................:....................:............:.........:\n: 719113ed-c060-43f3-8c5c-8889f8b4df01 : 25GB - Ubuntu / Ubuntu / 14.04-64 Minimal for VSI  :       System       :   Public   :  208938 :\n: b14a49a2-648b-4cea-9194-17120e98138f : 25GB - Ubuntu / Ubuntu / 12.04-64 Minimal for VSI  :       System       :   Public   :  208938 :\n: 2402ec54-6dd8-4391-846a-772406fa76cd :    25GB - Redhat / EL / 5.5-64 Minimal for VSI     :       System       :   Public   :  208938 :\n: 56c35934-1caa-408f-9e38-b36e4368e3b7 : 100GB - Ubuntu / Ubuntu / 14.04-32 Minimal for VSI :       System       :   Public   :  208938 :\n: 0e4b036f-8287-4ff9-ac9b-77883c245e49 :    100GB - Redhat / EL / 5.5-32 Minimal for VSI    :       System       :   Public   :  208938 :\n: f5d6c60f-d6cf-4d0b-a424-5e661e2dea47 : 100GB - Debian / Debian / 8.0.0-64 Minimal for VSI :       System       :   Public   :  208938 :\n: 76575ef6-7227-4e76-a85f-b16e0c8cad27 :  25GB - CentOS / CentOS / 5.6-32 Minimal for VSI   :       System       :   Public   :  208938 :\n: a3ebe687-87cc-4651-a53c-5d10c47292c1 :    100GB - Redhat / EL / 6.0-32 Minimal for VSI    :       System       :   Public   :  208938 :\n: 6d801d2c-2a16-44ac-8d32-7da1a752f4f1 :  25GB - CentOS / CentOS / 6.0-32 Minimal for VSI   :       System       :   Public   :  208938 :\n```\n\nVagrantfile\u3067\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u6307\u5b9a\u3057\u307e\u3059\u3002\uff08\u524d\u8ff0\u306e\u30b5\u30f3\u30d7\u30eb\u3068\u306e\u5dee\u5206\u3060\u3051\u66f8\u3044\u3066\u3044\u307e\u3059\uff09\n\n```\nsl.image_guid   = \"719113ed-c060-43f3-8c5c-8889f8b4df01\"\nsl.operating_system = nil\n# sl.disk_capacity = { 0 => 25 }\n```\n\nguid\u3092\u6307\u5b9a\u3057\u305f\u6642\u306f\u3001\u4e0a\u8a18\u306e\u3088\u3046\u306bsl.operating_system\u3092\u660e\u793a\u7684\u306bnil\u306b\u3057\u3001sl.disk_capacity\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u306a\u3044\u3068\u3001`vagrant up`\u6642\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n# vagrant up\nThere are errors in the configuration of this machine. Please fix\nthe following errors and try again:\n\nSoftLayer:\n* The image guid for a compute or flex image and the operating\nsystem reference code cannot be used at the same time.\nPlease use only one of the following options in the provider\nsection:\n\nconfig.vm.provider :softlayer do |sl|\n  sl.image_guid = \"AAAAAAAA-BBBB-CCCC-DDDD-EEEEEEEEEEEE\"\nend\n\nconfig.vm.provider :softlayer do |sl|\n  sl.operating_system = \"UBUNTU_LATEST\"\nend\n\n#\n```\n\n```\n# vagrant up\nThere are errors in the configuration of this machine. Please fix\nthe following errors and try again:\n\nSoftLayer:\n* The disk capacity can only be specified when using an operating\nsystem reference code and not when using a specific compute or\nflex image guid. Please use one of the following options in the\nprovider section:\n\nconfig.vm.provider :softlayer do |sl|\n  sl.image_guid = \"AAAAAAAA-BBBB-CCCC-DDDD-EEEEEEEEEEEE\"\nend\n\nconfig.vm.provider :softlayer do |sl|\n  sl.operating_system = \"UBUNTU_LATEST\"\n\n  # Disk number 1 is reserved for SWAP space, see SoftLayer API\n  # CLI tool command 'sl cci create-options' for more info.\n  sl.disk_capacity = { 0 => 25, 2 => 100, 3 => 2000 }\nend\n\n#\n```\n\n# \u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u306e\u9023\u643a\n\nvagrant up\u306e\u51e6\u7406\u306e\u4e2d\u3067\u3001\u89aa\u30b5\u30fc\u30d0\u30fc\u306b\u7f6e\u3044\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u3001\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u4e0a\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\u5f8c\u306e\u5b9a\u578b\u4f5c\u696d\u306b\u4fbf\u5229\u3067\u3001\u7528\u9014\u3068\u3057\u3066\u306f\u3001iptables\u306e\u8a2d\u5b9a\u3001OS\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u3001\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306e\u5c0e\u5165 \u306a\u3069\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\nSoftLayer\u306eProvisioning script\uff08 https://www.change-makers.jp/post/10294 \uff09\u3092\u4f7f\u3063\u3066\u3082\u540c\u69d8\u306e\u4e8b\u304c\u5b9f\u73fe\u3067\u304d\u307e\u3059\u304c\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u3092HTTPS\u30b5\u30fc\u30d0\u30fc\u306b\u914d\u7f6e\u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u4e21\u65b9\u4f7f\u3063\u3066\u307f\u305f\u611f\u60f3\u3068\u3057\u3066\u306f\u3001Vagrant\u306e\u307b\u3046\u304c\u624b\u8efd\u306e\u3088\u3046\u306b\u611f\u3058\u307e\u3057\u305f\u3002\n\nVagrantfile\u306b\u306f\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n`config.vm.provision :shell, :path => \"./provisioning.sh\",:privileged   => true`\n\nprovisioning.sh\u306f\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3001\u901a\u5e38\u306e\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3068\u3057\u3066\u8a18\u8ff0\u3057\u307e\u3059\u3002\u4f8b\u3068\u3057\u3066\u3001\u6700\u65b0\u306eOS\u30d1\u30c3\u30c1\u3092\u9069\u7528\u3057\u3001\u30a6\u30a7\u30d6\u30b5\u30fc\u30d0\u30fc\u3092\u5c0e\u5165\u30fb\u8d77\u52d5\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\n\n```\n#!/bin/sh\n\n# yum update all\nyum -y update\n\n# install apach webserver\nyum install -y httpd\nservice httpd start\nchkconfig httpd on\n```\n\n# Chef\u3068\u306e\u9023\u643a\n\n\u7c21\u6613\u306a\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u306e\u5c0e\u5165\u3067\u3042\u308c\u3070\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3082\u5341\u5206\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u5c11\u3057\u8907\u96d1\u306a\u69cb\u6210\u3084\u3001\u65e2\u5b58\u306erecipe\u304c\u3042\u308b\u5834\u5408\u306b\u306f\u3001Chef\u3068\u9023\u643a\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002Vagrantfile\u306bChef\u3068\u9023\u643a\u3059\u308b\u8a18\u8ff0\u3092\u3059\u308b\u4e8b\u3067\u3001`vagrant up` \u306e\u307f\u3067\u3001Chef\u306b\u3088\u308b\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u307e\u3067\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u306a\u304a\u3001\u4eca\u56de\u306f\u3001chef-zero\u306e\u6a5f\u80fd\u3092\u4f7f\u3044\u3001Chef\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u30ed\u30fc\u30ab\u30eb\u30e2\u30fc\u30c9\u3067\u52d5\u304b\u3057\u307e\u3059\u3002\n\nChef\u3092\u52d5\u304b\u3059\u305f\u3081\u306b\u89aa\u30b5\u30fc\u30d0\u30fc\u306b\u5c11\u3005\u306e\u8ffd\u52a0\u6e96\u5099\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u305d\u308c\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n##OS\u306b Development Tools\u5c0e\u5165\n\nVagrant\u306bChef\u95a2\u9023\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u8ffd\u52a0\u3059\u308b\u969b\u306b\u5fc5\u8981\u3068\u306a\u308b\u305f\u3081\u3001Development Tools\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\n```\n# yum groupinstall -y \"Development Tools\"\n```\n\n\n##Chef Development Kit \u5c0e\u5165\uff08chef, ruby, gem\uff09\n\n\u89aa\u30b5\u30fc\u30d0\u30fc\u3067\u3001Chef\u3001Ruby\u3001Gem\u304c\u52d5\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nChef Development Kit(Chef DK)\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u3053\u308c\u3089\u3092\u4e00\u5ea6\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\u4e0b\u8a18\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\nhttps://downloads.chef.io/chef-dk/redhat/\n\n```\n# rpm -ivh https://opscode-omnibus-packages.s3.amazonaws.com/el/6/x86_64/chefdk-0.11.2-1.el6.x86_64.rpm\nRetrieving https://opscode-omnibus-packages.s3.amazonaws.com/el/6/x86_64/chefdk-0.11.2-1.el6.x86_64.rpm\nwarning: /var/tmp/rpm-tmp.CMDJ51: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY\nPreparing...                ########################################### [100%]\n   1:chefdk                 ########################################### [100%]\nThank you for installing Chef Development Kit!\n#\n```\n\n\u4e0a\u8a18\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3059\u308b\u3068chef\u30b3\u30de\u30f3\u30c9\u306f\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u304c\u3001gem\u306f\u307e\u3060\u30d1\u30b9\u304c\u901a\u3063\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u4f7f\u3048\u307e\u305b\u3093\u3002`eval \"$(chef shell-init bash)\"`\u30b3\u30de\u30f3\u30c9\u3067\u3001\u5fc5\u8981\u306a\u74b0\u5883\u5909\u6570\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067gem\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\"bash\"\u306e\u90e8\u5206\u306f\u3001`echo $SHELL`\u3067\u81ea\u5206\u306e\u30b7\u30a7\u30eb\u74b0\u5883\u3092\u78ba\u8a8d\u3057\u3066\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```\n# which chef\n/usr/bin/chef\n# gem\n-bash: gem: command not found\n# echo $SHELL\n/bin/bash\n# eval \"$(chef shell-init bash)\"\n# which gem\n/opt/chefdk/embedded/bin/gem\n#\n```\n\n\u3061\u306a\u307f\u306b\u3001`chef shell-init bash`\u306e\u51fa\u529b\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\n\n```\n# chef shell-init bash\nexport PATH=\"/opt/chefdk/bin:/root/.chefdk/gem/ruby/2.1.0/bin:/opt/chefdk/embedded/bin:/opt/chefdk/bin:/root/.chefdk/gem/ruby/2.1.0/bin:/opt/chefdk/embedded/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin\"\nexport GEM_ROOT=\"/opt/chefdk/embedded/lib/ruby/gems/2.1.0\"\nexport GEM_HOME=\"/root/.chefdk/gem/ruby/2.1.0\"\nexport GEM_PATH=\"/root/.chefdk/gem/ruby/2.1.0:/opt/chefdk/embedded/lib/ruby/gems/2.1.0\"\n_chef_comp() {\n    local COMMANDS=\"exec env gem generate shell-init install update push push-archive show-policy diff provision export clean-policy-revisions clean-policy-cookbooks delete-policy-group delete-policy undelete verify\"\n    COMPREPLY=($(compgen -W \"$COMMANDS\" -- ${COMP_WORDS[COMP_CWORD]} ))\n}\ncomplete -F _chef_comp chef\n\n#\n```\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u306a\u304a\u3057\u3066\u3082\u4e0a\u8a18\u306e\u74b0\u5883\u5909\u6570\u304c\u6709\u52b9\u306b\u306a\u308b\u3088\u3046\u3001profile\u306b\u3082\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n# echo 'eval \"$(chef shell-init bash)\"' >> ~/.bash_profile\n```\n\n##Vagrant\u30d7\u30e9\u30b0\u30a4\u30f3\uff08vagrant-omnibus\u3001vagrant-chef-zero\uff09\u5c0e\u5165\n\nvagrant-omnibus\u306f\u3001\u64cd\u4f5c\u5bfe\u8c61\u306e\u30b5\u30fc\u30d0\u30fc\u306bChef\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u305f\u3081\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002\n\n```\n# vagrant plugin install vagrant-omnibus\nInstalling the 'vagrant-omnibus' plugin. This can take a few minutes...\nInstalled the plugin 'vagrant-omnibus (1.4.1)'!\n#\n```\n\nvagrant-chef-zero\u306f\u3001Vagrant\u304b\u3089Chef Zero Server\u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002\n\n```\n# vagrant plugin install vagrant-chef-zero\nInstalling the 'vagrant-chef-zero' plugin. This can take a few minutes...\nInstalled the plugin 'vagrant-chef-zero (2.0.0)'!\n#\n```\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5c0e\u5165\u72b6\u6cc1\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n# vagrant plugin list\nvagrant-chef-zero (2.0.0)\nvagrant-omnibus (1.4.1)\nvagrant-share (1.1.5, system)\nvagrant-softlayer (0.4.0)\n#\n```\n\n\u306a\u304a\u3001vagrant-chef-zero\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u3001OS\u306bDevelopment Tools\u3084gem\u304c\u5165\u3063\u3066\u3044\u306a\u3044\u3068\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u4e8b\u524d\u306b\u524d\u9805\u307e\u3067\u306e\u524d\u63d0\u6761\u4ef6\u3092\u5c0e\u5165\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\n# vagrant plugin install vagrant-chef-zero\nInstalling the 'vagrant-chef-zero' plugin. This can take a few minutes...\nBundler, the underlying system Vagrant uses to install plugins,\nreported an error. The error is shown below. These errors are usually\ncaused by misconfigured plugin installations or transient network\nissues. The error from Bundler is:\n\nAn error occurred while installing hitimes (1.2.3), and Bundler cannot continue.\nMake sure that `gem install hitimes -v '1.2.3'` succeeds before bundling.\n\nWarning: this Gemfile contains multiple primary sources. Using `source` more than once without a block is a security risk, and may result in installing unexpected gems. To resolve this warning, use a block to indicate which gems should come from the secondary source. To upgrade this warning to an error, run `bundle config disable_multisource true`.Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    /opt/vagrant/embedded/bin/ruby -r ./siteconf20160306-18625-dthbk2.rb extconf.rb\nchecking for clock_gettime() in -lrt... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of necessary\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\nneed configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=/opt/vagrant/embedded/bin/$(RUBY_BASE_NAME)\n        --with-rtlib\n        --without-rtlib\n/opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:456:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:541:in `try_link0'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:556:in `try_link'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:735:in `try_func'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:966:in `block in have_library'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:911:in `block in checking_for'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:351:in `block (2 levels) in postpone'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:321:in `open'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:351:in `block in postpone'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:321:in `open'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:347:in `postpone'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:910:in `checking_for'\n        from /opt/vagrant/embedded/lib/ruby/2.2.0/mkmf.rb:961:in `have_library'\n        from extconf.rb:10:in `<main>'\n\nextconf failed, exit code 1\n\nGem files will remain installed in /root/.vagrant.d/gems/gems/hitimes-1.2.3 for inspection.\nResults logged to /root/.vagrant.d/gems/extensions/x86_64-linux/2.2.0/hitimes-1.2.3/gem_make.out\n\n#\n```\n\n##Chef\u521d\u671f\u5316\nVagrantfile\u304c\u914d\u7f6e\u3055\u308c\u305f\u30d5\u30a9\u30eb\u30c0\u3067\u3001`chef generate repo chef-repo`\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3001policy repository\u306e\u96db\u5f62\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n# ls\nVagrantfile\n# chef generate repo chef-repo\nCompiling Cookbooks...\nRecipe: code_generator::repo\n  * directory[/root/vagrant/chef-repo] action create\n(\u5f8c\u7565)\n\n# ls\nchef-repo  Vagrantfile\n#\n\n```\n\n##Berksfile\u4f5c\u6210\n\n```\n# cd chef-repo/\n# ls\nchefignore  cookbooks  data_bags  environments  LICENSE  README.md  roles\n# vi Berksfile\n# cat Berksfile\nsource \"https://supermarket.chef.io\"\ncookbook 'apache2'\n#\n```\n\n\n##Cookbook\u4f5c\u6210(berks vendor cookbooks)\n\n```\n# berks vendor cookbooks\n/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/httpclient-2.6.0.1/lib/httpclient/webagent-cookie.rb:458: warning: already initialized constant HTTPClient::CookieManager\n/opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/httpclient-2.6.0.1/lib/httpclient/cookie.rb:8: warning: previous definition of CookieManager was here\nResolving cookbook dependencies...\nFetching cookbook index from https://supermarket.chef.io...\nInstalling apache2 (3.1.0)\nVendoring apache2 (3.1.0) to cookbooks/apache2\n#\n```\n\n##Vagrantfile\u306bchef\u7528\u8a2d\u5b9a\u8ffd\u8a18\n\n```\n# cat Vagrantfile\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n# Vagrantfile API/syntax version. Don't touch unless you know what you're doing!\nVAGRANTFILE_API_VERSION = \"2\"\n\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n    config.vm.box = \"dummy\"\n    config.vm.box_url = \"https://github.com/audiolize/vagrant-softlayer/raw/master/dummy.box\"\n    config.ssh.pty = true\n    config.ssh.private_key_path = \"/root/.ssh/id_rsa\"\n    config.vm.synced_folder \".\", \"/vagrant\", type: \"rsync\", disabled: true\n    config.ssh.username = \"root\"\n    config.omnibus.chef_version = :latest\n\n    config.vm.provision \"chef_zero\" do |chef|\n        # Specify the local paths where Chef data is stored\n        chef.cookbooks_path = \"./chef-repo/cookbooks\"\n        chef.roles_path = \"./chef-repo/roles\"\n        chef.nodes_path = \"./chef-repo/cookbooks\"\n\n        # Add a recipe\n        chef.add_recipe \"apache2\"\n\n    end\n\n    config.vm.provider :softlayer do | sl, override |\n            sl.api_key = \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n            sl.username = \"xxxxxxx\"\n            sl.datacenter   = \"sea01\"\n            sl.dedicated    = false\n            sl.domain       = \"softlayer.com\"\n            sl.disk_capacity = { 0 => 25 }\n#            sl.private_only = true\n            sl.force_private_ip = true\n            sl.hostname     = \"vagrant03\"\n            sl.hourly_billing = true\n            sl.image_guid   = nil\n            sl.local_disk   = false\n            sl.max_memory   = 1024\n            sl.network_speed = 100\n            sl.operating_system = \"UBUNTU_14_64\"\n            sl.ssh_key = [ \"tamatest_key\" ]\n            sl.start_cpus   = 1\n\n            override.ssh.username = \"root\"\n    end\nend\n#\n```\n\n##vagrant up\n\n`vagrant up`\u30b3\u30de\u30f3\u30c9\u306e\u4e2d\u3067\u3001\u64cd\u4f5c\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u306bChef\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3001\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u30e2\u30fc\u30c9\u3067\u30a2\u30af\u30bb\u30b9\u3057\u306b\u884c\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n```\n# vagrant up\nBringing machine 'default' up with 'softlayer' provider...\n==> default: Auto-generating node name for Chef...\n==> default: Creating a new SoftLayer instance...\n==> default: Waiting for instance provisioning. This may take a few minutes...\n==> default: SoftLayer instance successfully provisioned!\n==> default: Waiting for machine to boot. This may take a few minutes...\n    default: SSH address: 10.28.227.132:22\n    default: SSH username: root\n    default: SSH auth method: private key\n==> default: Machine booted and ready!\n==> default: Rsyncing folder: /root/vagrant/chef-repo/cookbooks/ => /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/cookbooks\n==> default: Rsyncing folder: /root/vagrant/chef-repo/roles/ => /tmp/vagrant-chef/05d0b4f19a1e6bdc34b5b3c14dd2fb5c/roles\n==> default: Rsyncing folder: /root/vagrant/chef-repo/cookbooks/ => /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/nodes\n==> default: Installing Chef 12.7.2 Omnibus package...\n==> default: Getting information for chef stable 12.7.2 for ubuntu...\n==> default: downloading https://omnitruck-direct.chef.io/stable/chef/metadata?v=12.7.2&p=ubuntu&pv=14.04&m=x86_64\n==> default:   to file /tmp/install.sh.2745/metadata.txt\n==> default: trying wget...\n==> default: url        https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/14.04/x86_64/chef_12.7.2-1_amd64.deb\n==> default: md5        b7acab8f396f8bb12fe39f42b3277bed\n==> default: sha256     0f543f51116fb498cf683e73b005cdd8ed0c8147ca5d10163377d9c1ab6a2cde\n==> default: version    12.7.2downloaded metadata file looks valid...\n==> default: downloading https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/14.04/x86_64/chef_12.7.2-1_amd64.deb\n==> default:   to file /tmp/install.sh.2745/chef_12.7.2-1_amd64.deb\n==> default: trying wget...\n==> default: Comparing checksum with sha256sum...\n==> default: Installing chef 12.7.2\n==> default: installing with dpkg...\n==> default: Selecting previously unselected package chef.\n(Reading database ... 47139 files and directories currently installed.)\n==> default: Preparing to unpack .../chef_12.7.2-1_amd64.deb ...\n==> default: Unpacking chef (12.7.2-1) ...\n==> default: Setting up chef (12.7.2-1) ...\n==> default: Thank you for installing Chef!\n==> default: Running provisioner: chef_zero...\n==> default: Detected Chef (latest) is already installed\n==> default: Generating chef JSON and uploading...\n==> default: Running chef-client (local-mode)...\n==> default: [2016-03-07T02:05:25-06:00] INFO: Started chef-zero at chefzero://localhost:8889 with repository at /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2\n==> default:   One version per cookbook\n==> default:   roles at /tmp/vagrant-chef/05d0b4f19a1e6bdc34b5b3c14dd2fb5c/roles\n==> default:\n==> default: [2016-03-07T02:05:25-06:00] INFO: Forking chef instance to converge...\n==> default: Starting Chef Client, version 12.7.2\n==> default: [2016-03-07T02:05:25-06:00] INFO: *** Chef 12.7.2 ***\n==> default: [2016-03-07T02:05:25-06:00] INFO: Chef-client pid: 3149\n==> default: [2016-03-07T02:05:27-06:00] INFO: HTTP Request Returned 404 Not Found: Object not found: chefzero://localhost:8889/nodes/vagrant-38b5c5d2\n==> default: [2016-03-07T02:05:27-06:00] INFO: Setting the run_list to [\"recipe[apache2]\"] from CLI options\n==> default: [2016-03-07T02:05:27-06:00] INFO: Run List is [recipe[apache2]]\n==> default: [2016-03-07T02:05:27-06:00] INFO: Run List expands to [apache2]\n==> default: [2016-03-07T02:05:27-06:00] INFO: Starting Chef Run for vagrant-38b5c5d2\n==> default: [2016-03-07T02:05:27-06:00] INFO: Running start handlers\n==> default: [2016-03-07T02:05:27-06:00] INFO: Start handlers complete.\n==> default: resolving cookbooks for run list: [\"apache2\"]\n==> default: [2016-03-07T02:05:27-06:00] INFO: Loading cookbooks [apache2@3.1.0]\n==> default: Synchronizing Cookbooks:\n==> default: [2016-03-07T02:05:27-06:00] INFO: Storing updated cookbooks/apache2/recipes/mod_charset_lite.rb in the cache.\n==> default: [2016-03-07T02:05:27-06:00] INFO: Storing updated cookbooks/apache2/recipes/mod_authn_dbd.rb in the cache.\n==> default: [2016-03-07T02:05:27-06:00] INFO: Storing updated cookbooks/apache2/recipes/mod_authn_anon.rb in the cache.\n==> default: [2016-03-07T02:05:27-06:00] INFO: Storing updated cookbooks/apache2/recipes/mod_fcgid.rb in the cache.\n\uff08\u5f8c\u7565\uff09\n```\n\n\u4e0a\u8a18\u51e6\u7406\u306e\u5b8c\u4e86\u5f8c\u3001\u64cd\u4f5c\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u4e0a\u3067apache\u304c\u8d77\u52d5\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n`vagrant up`\u30b3\u30de\u30f3\u30c9\u306e\u307f\u3067\u3001Chef\u306e\u30ec\u30b7\u30d4\u5b9f\u884c\u307e\u3067\u884c\u3048\u305f\u4e8b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n```\n# ps -ef|grep apache\nroot      4103     1  0 02:05 ?        00:00:00 /usr/sbin/apache2 -k start\nwww-data  4296  4103  0 02:05 ?        00:00:00 /usr/sbin/apache2 -k start\nwww-data  4297  4103  0 02:05 ?        00:00:00 /usr/sbin/apache2 -k start\nwww-data  4431  4103  0 02:05 ?        00:00:00 /usr/sbin/apache2 -k start\nroot      4659  4582  0 02:07 pts/0    00:00:00 grep --color=auto apache\n#\n```\n\n# \u6b8b\u8ab2\u984c\n\nRedHat\u3084CentOS\u3060\u3068\u3001vagrant up\u4e2d\u306b\u4e0b\u8a18\u306e\u30a8\u30e9\u30fc\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\u30b0\u30b0\u308b\u3068\u3001Vagrantfile\u306b override.ssh.pty = true \u3092\u8a18\u8ff0\u3059\u308b\u4e8b\u3067\u3046\u307e\u304f\u3044\u304f\u3001\u3068\u3044\u3046\u60c5\u5831\u3082\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u304c\u5f53\u74b0\u5883\u306e\u5834\u5408\u306f\u305d\u308c\u3067\u306f\u89e3\u6c7a\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\n```\n# vagrant up\nBringing machine 'default' up with 'softlayer' provider...\n==> default: Auto-generating node name for Chef...\n==> default: Creating a new SoftLayer instance...\n==> default: Waiting for instance provisioning. This may take a few minutes...\n==> default: SoftLayer instance successfully provisioned!\n==> default: Waiting for machine to boot. This may take a few minutes...\n    default: SSH address: 10.28.227.133:22\n    default: SSH username: root\n    default: SSH auth method: private key\n==> default: Machine booted and ready!\n==> default: Rsyncing folder: /root/vagrant/chef-repo/cookbooks/ => /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/cookbooks\nThere was an error when attempting to rsync a synced folder.\nPlease inspect the error message below for more info.\n\nHost path: /root/vagrant/chef-repo/cookbooks/\nGuest path: /tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/cookbooks\nCommand: rsync --verbose --archive --delete -z --copy-links --no-owner --no-group --rsync-path sudo rsync -e ssh -p 22 -o ControlMaster=auto -o ControlPath=/tmp/ssh.116 -o ControlPersist=10m -o StrictHostKeyChecking=no -o IdentitiesOnly=true -o UserKnownHostsFile=/dev/null -i '/root/.ssh/id_rsa' --exclude .vagrant/ /root/vagrant/chef-repo/cookbooks/ root@10.28.227.133:/tmp/vagrant-chef/a14caf21a1f1c0ee0745db508bbcabc2/cookbooks\nError: Warning: Permanently added '10.28.227.133' (RSA) to the list of known hosts.\nsudo: sorry, you must have a tty to run sudo\nrsync: connection unexpectedly closed (0 bytes received so far) [sender]\nrsync error: error in rsync protocol data stream (code 12) at io.c(600) [sender=3.0.6]\n\n#\n```\n\n\u4e0a\u8a18\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3082\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u81ea\u4f53\u306f\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u4f5c\u6210\u3055\u308c\u305f\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u306bssh\u30ed\u30b0\u30a4\u30f3\u3057\u3001visudo\u3067/etc/sudoers\u306etty\u306e\u8a2d\u5b9a\u3092\u4e0b\u8a18\u306e\u3088\u3046\u306b\u5909\u66f4\u5f8c\u3001`vagrant provision`\u3092\u884c\u3048\u3070\u3001Chef\u306b\u3088\u308b\u8a2d\u5b9a\u307e\u3067\u884c\u3063\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u5909\u66f4\u524d\n`Defaults    requiretty`\n\n\u5909\u66f4\u5f8c\n`Defaults    !requiretty`\n\nRedHat\u3084CentOS\u306e\u5834\u5408\u3001/etc/sudoers\u306b\u4e0a\u8a18\u306e\u5909\u66f4\u3092\u884c\u3063\u305f\u5f8c\u3067Image Template\u3092\u53d6\u5f97\u3057\u3001\u524d\u8ff0\u306e\u3088\u3046\u306b\u3001Vagrantfile\u3067\u30a4\u30e1\u30fc\u30b8\u306eguid\u3092\u6307\u5b9a\u3057\u3066\u3001\u30a4\u30e1\u30fc\u30b8\u304b\u3089\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3092\u4f5c\u6210\u3059\u308b\u306e\u304c\u826f\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\n# \u304a\u308f\u308a\u306b\n\nVagrant\u306f\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u306e\u4f5c\u6210\u30fb\u524a\u9664\u30fb\u518d\u69cb\u7bc9\u3092\u5bb9\u6613\u306b\u884c\u3048\u308b\u30c4\u30fc\u30eb\u3067\u3059\u304c\u3001\u305d\u308c\u3060\u3051\u306b\u7559\u307e\u3089\u305a\u3001Image Template\u304b\u3089\u306e\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\u3084\u3001\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u4f5c\u6210\u306e\u5f8c\u5de5\u7a0b\u3068\u3057\u3066\u3001\u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u3084Chef\u3068\u306e\u9023\u643a\u3082\u3067\u304d\u308b\u4e8b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n`vagrant up`\u30b3\u30de\u30f3\u30c9\u306e\u307f\u3067\u3001\u30b5\u30fc\u30d0\u30fc\u3092\u7acb\u3061\u4e0a\u3052\u3001\u5fc5\u8981\u306a\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u304c\u5c0e\u5165\u3055\u308c\u305f\u72b6\u614b\u306b\u3067\u304d\u307e\u3059\u306e\u3067\u3001\u958b\u767a\u74b0\u5883\u3092\u6e96\u5099\u3059\u308b\u6642\u306a\u3069\u306b\u6709\u7528\u306a\u30c4\u30fc\u30eb\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u53c2\u8003\u30ea\u30f3\u30af\n\u4eca\u56de\u306e\u5185\u5bb9\u3092\u8a66\u3059\u306b\u3042\u305f\u308a\u3001\u4e0b\u8a18\u306e\u60c5\u5831\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n\nVagrant\u3067SoftLayer\u3092\u64cd\u4f5c\u3059\u308b\nhttp://niccloud.niandc.ne.jp/?p=749\n\nVagrant\u3067SoftLayer\u306b\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3092Provisioning\u3059\u308b\nhttp://qiita.com/takech9203/items/27e38278e7f71ca4d9ab\n\nChef\u3092\u4f7f\u3046\u306e\u306b\u5fc5\u8981\u306a\u74b0\u5883\u304c\u4e00\u6c17\u306b\u6574\u3046\u300cChefDK\u300d\u30ec\u30d3\u30e5\u30fc\nhttp://knowledge.sakura.ad.jp/tech/2825/\n\nVagrant \u3068 Chef \u306b\u3088\u308b\u4eee\u60f3\u74b0\u5883\u69cb\u7bc9\u306e\u81ea\u52d5\u5316\uff08VirtualBox\u7de8\uff09\nhttps://www.ogis-ri.co.jp/otc/hiroba/technical/vagrant-chef/chap1.html\n\n\u521d\u3081\u3066\u306e Vagrant + Chef zero + Berkshelf \nhttp://qiita.com/tsuyopooon/items/d90679d9f8b5ccfcfde5\n\nSoftLayer Tips \u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u30fb\u30b9\u30af\u30ea\u30d7\u30c8\u3068SSH\u9375\u3067\u306e\u30ed\u30b0\u30a4\u30f3\nhttps://ibm.biz/BdH4Yu\n\nChef Zero Provisioner\nhttps://www.vagrantup.com/docs/provisioning/chef_zero.html\n\nError: Missing required value for `chef.nodes_path'.\nhttps://github.com/r8/vagrant-lamp/issues/134\n\n"}