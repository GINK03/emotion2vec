{"tags": ["systemd"], "context": " More than 1 year has passed since last update.Vagrant\u4e0a\u306eCoreOS\u3067etcd\u3092\u52d5\u304b\u3057\u3066\u5225\u306e3\u53f0\u3067\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0\u3057\u3066\u307f\u305f - Qiita\u3067\u30cf\u30de\u3063\u305f\u306e\u3067\u30b5\u30fc\u30d3\u30b9\u306e\u72b6\u614b\u3092\u898b\u3066\u307f\u3088\u3046\u3068\u601d\u3063\u305f\u3089\u3001systemd\u306b\u3064\u3044\u3066\u4f55\u3082\u77e5\u3089\u306a\u3044\u4e8b\u306b\u6c17\u3065\u3044\u305f\u306e\u3067\u5c11\u3057\u3060\u3051\u8abf\u3079\u307e\u3057\u305f\u3002\n\n\u72b6\u614b\u306e\u78ba\u8a8d\nsystemctl\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3067\u30b5\u30fc\u30d3\u30b9\u306e\u78ba\u8a8d\u306a\u3069\u3092\u884c\u3046\u3089\u3057\u3044\u3067\u3059\u3002systemd (\u65e5\u672c\u8a9e) - ArchWiki\u304c\u8a73\u3057\u304f\u3066\u826f\u3055\u305d\u3046\u3067\u3059\u3002\nsystemctl status \u30b5\u30fc\u30d3\u30b9\u540d -l\u3067\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002-l\u306a\u3057\u3060\u3068\u4e0b\u534a\u5206\u3050\u3089\u3044\u306e\u30ed\u30b0\u306e\u884c\u304c...\u3067\u7701\u7565\u3055\u308c\u3066\u3001\u30d5\u30eb\u3067\u898b\u308b\u306b\u306f-l\u3092\u4ed8\u3051\u308b\u3088\u3046\u306b\u8a00\u308f\u308c\u307e\u3057\u305f\u3002\n\u4f8b\ncore@core-00 ~ $ systemctl status etcd -l\netcd.service - etcd\n   Loaded: loaded (/usr/lib64/systemd/system/etcd.service; disabled)\n  Drop-In: /run/systemd/system/etcd.service.d\n           \u2514\u250020-cloudinit.conf\n   Active: active (running) since Sun 2014-04-13 05:55:20 UTC; 29min ago\n Main PID: 3051 (etcd)\n   CGroup: /system.slice/etcd.service\n           \u2514\u25003051 /usr/bin/etcd\n\nApr 13 05:55:20 core-00 systemd[1]: Starting etcd...\nApr 13 05:55:20 core-00 systemd[1]: Started etcd.\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.821 INFO      | e91e07624f254be3835aa6b221f4e176: state changed from 'stopped' to 'follower'.\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.821 INFO      | e91e07624f254be3835aa6b221f4e176: state changed from 'follower' to 'leader'.\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.822 INFO      | e91e07624f254be3835aa6b221f4e176: leader changed from '' to 'e91e07624f254be3835aa6b221f4e176'.\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.823 INFO      | etcd server [name e91e07624f254be3835aa6b221f4e176, listen on [::]:4001, advertised url http://172.12.8.100:4001]\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.824 INFO      | peer server [name e91e07624f254be3835aa6b221f4e176, listen on [::]:7001, advertised url http://172.12.8.100:7001]\n\n\n\u8a2d\u5b9a\u306e\u78ba\u8a8d\nsystemctl status\u306e\u51fa\u529b\u7d50\u679c\u3067\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u308f\u304b\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u898b\u307e\u3059\u3002\n\u4f8b\ncore@core-01 ~ $ cat /run/systemd/system/etcd.service.d/20-cloudinit.conf\n[Service]\nEnvironment=\"ETCD_DISCOVERY=http://172.17.8.100:4001/v2/keys/machines\"\nEnvironment=\"ETCD_ADDR=172.17.8.101:4001\"\nEnvironment=\"ETCD_PEER_ADDR=172.17.8.101:7001\"\nEnvironment=\"ETCD_NAME=3e15b02dcddc4a079c04d7fa9c91b621\"\n\n\n\u30ed\u30b0\u306e\u78ba\u8a8d\n\u03c6(.. )\uff92\uff93\uff7c\uff83\uff75\uff7a\uff73\u3000systemd\u306ejournal\u306b\u3088\u308b\u30ed\u30b0\u306e\u78ba\u8a8d\u65b9\u6cd5 - \u03c6(\u30fb\u30fb*)\u309e \uff73\uff70\uff9d\u3000\u30ab\u30fc\u30cd\u30eb\u3068\u304b\u5f04\u3063\u305f\u308a\u306e\u30e1\u30e2\u306b\u3088\u308b\u3068systemd\u3067\u306f/var/log/messages\u306f\u4f5c\u3089\u308c\u305a\u3001\u30ed\u30b0\u306e\u78ba\u8a8d\u306b\u306fjournalctl\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3046\u305d\u3046\u3067\u3059\u3002-b\u3092\u3064\u3051\u308c\u3070\u30d6\u30fc\u30c8\u4ee5\u5f8c\u306e\u30ed\u30b0\u306e\u307f\u304c\u898b\u3089\u308c\u308b\u3068\u306e\u3053\u3068\u3002\n\u5b9f\u884c\u4f8b\njournalctl -b | less\n\n\u51fa\u529b\u629c\u7c8b\nApr 13 05:56:43 core-01 etcd[3055]: [etcd] Apr 13 05:56:43.514 INFO      | Discovery via http://172.17.8.100:4001 using prefix machines.\nApr 13 05:56:44 core-01 tlsdated[2891]: wait for child attempt 1\nApr 13 05:56:44 core-01 tlsdated[2891]: child exited with 0\nApr 13 05:56:44 core-01 tlsdated[2891]: tlsdate succeeded\nApr 13 05:56:44 core-01 tlsdated[2891]: synced rtc to sysclock\nApr 13 05:56:44 core-01 tlsdated[2891]: open failed: No such file or directory\nApr 13 05:56:44 core-01 tlsdated[2891]: wait for child attempt 1\nApr 13 05:56:44 core-01 tlsdated[2891]: child exited with 0\nApr 13 05:56:44 core-01 tlsdated[2891]: tlsdate succeeded\nApr 13 05:56:44 core-01 tlsdated[2891]: synced rtc to sysclock\nApr 13 05:56:44 core-01 tlsdated[2891]: open failed: No such file or directory\nApr 13 05:56:44 core-01 tlsdated[2891]: Failed to obtain UID for `tlsdate-dbus'\nApr 13 05:56:45 core-01 etcd[3055]: [etcd] Apr 13 05:56:45.924 CRITICAL  | Discovery failed and a backup peer list wasn't provided: 501: All the given peers are not reachable (Tried to connect to each peer twice and failed) [0]\nApr 13 05:56:45 core-01 systemd[1]: etcd.service: main process exited, code=exited, status=1/FAILURE\nApr 13 05:56:45 core-01 systemd[1]: Unit etcd.service entered failed state.\n\n[Vagrant\u4e0a\u306eCoreOS\u3067etcd\u3092\u52d5\u304b\u3057\u3066\u5225\u306e3\u53f0\u3067\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0\u3057\u3066\u307f\u305f - Qiita](http://qiita.com/hnakamur/items/bccac980bef68642a814)\u3067\u30cf\u30de\u3063\u305f\u306e\u3067\u30b5\u30fc\u30d3\u30b9\u306e\u72b6\u614b\u3092\u898b\u3066\u307f\u3088\u3046\u3068\u601d\u3063\u305f\u3089\u3001systemd\u306b\u3064\u3044\u3066\u4f55\u3082\u77e5\u3089\u306a\u3044\u4e8b\u306b\u6c17\u3065\u3044\u305f\u306e\u3067\u5c11\u3057\u3060\u3051\u8abf\u3079\u307e\u3057\u305f\u3002\n\n# \u72b6\u614b\u306e\u78ba\u8a8d\n\nsystemctl\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3067\u30b5\u30fc\u30d3\u30b9\u306e\u78ba\u8a8d\u306a\u3069\u3092\u884c\u3046\u3089\u3057\u3044\u3067\u3059\u3002[systemd (\u65e5\u672c\u8a9e) - ArchWiki](https://wiki.archlinux.org/index.php/Systemd_%28%e6%97%a5%e6%9c%ac%e8%aa%9e%29)\u304c\u8a73\u3057\u304f\u3066\u826f\u3055\u305d\u3046\u3067\u3059\u3002\n\nsystemctl status \u30b5\u30fc\u30d3\u30b9\u540d -l\u3067\u72b6\u614b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002-l\u306a\u3057\u3060\u3068\u4e0b\u534a\u5206\u3050\u3089\u3044\u306e\u30ed\u30b0\u306e\u884c\u304c...\u3067\u7701\u7565\u3055\u308c\u3066\u3001\u30d5\u30eb\u3067\u898b\u308b\u306b\u306f-l\u3092\u4ed8\u3051\u308b\u3088\u3046\u306b\u8a00\u308f\u308c\u307e\u3057\u305f\u3002\n\n\u4f8b\n\n```shell-session\ncore@core-00 ~ $ systemctl status etcd -l\netcd.service - etcd\n   Loaded: loaded (/usr/lib64/systemd/system/etcd.service; disabled)\n  Drop-In: /run/systemd/system/etcd.service.d\n           \u2514\u250020-cloudinit.conf\n   Active: active (running) since Sun 2014-04-13 05:55:20 UTC; 29min ago\n Main PID: 3051 (etcd)\n   CGroup: /system.slice/etcd.service\n           \u2514\u25003051 /usr/bin/etcd\n\nApr 13 05:55:20 core-00 systemd[1]: Starting etcd...\nApr 13 05:55:20 core-00 systemd[1]: Started etcd.\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.821 INFO      | e91e07624f254be3835aa6b221f4e176: state changed from 'stopped' to 'follower'.\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.821 INFO      | e91e07624f254be3835aa6b221f4e176: state changed from 'follower' to 'leader'.\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.822 INFO      | e91e07624f254be3835aa6b221f4e176: leader changed from '' to 'e91e07624f254be3835aa6b221f4e176'.\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.823 INFO      | etcd server [name e91e07624f254be3835aa6b221f4e176, listen on [::]:4001, advertised url http://172.12.8.100:4001]\nApr 13 05:55:20 core-00 etcd[3051]: [etcd] Apr 13 05:55:20.824 INFO      | peer server [name e91e07624f254be3835aa6b221f4e176, listen on [::]:7001, advertised url http://172.12.8.100:7001]\n```\n\n# \u8a2d\u5b9a\u306e\u78ba\u8a8d\n\nsystemctl status\u306e\u51fa\u529b\u7d50\u679c\u3067\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u308f\u304b\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u898b\u307e\u3059\u3002\n\n\u4f8b\n\n```shell-session\ncore@core-01 ~ $ cat /run/systemd/system/etcd.service.d/20-cloudinit.conf\n[Service]\nEnvironment=\"ETCD_DISCOVERY=http://172.17.8.100:4001/v2/keys/machines\"\nEnvironment=\"ETCD_ADDR=172.17.8.101:4001\"\nEnvironment=\"ETCD_PEER_ADDR=172.17.8.101:7001\"\nEnvironment=\"ETCD_NAME=3e15b02dcddc4a079c04d7fa9c91b621\"\n```\n\n# \u30ed\u30b0\u306e\u78ba\u8a8d\n\n[\u03c6(.. )\uff92\uff93\uff7c\uff83\uff75\uff7a\uff73\u3000systemd\u306ejournal\u306b\u3088\u308b\u30ed\u30b0\u306e\u78ba\u8a8d\u65b9\u6cd5 - \u03c6(\u30fb\u30fb*)\u309e \uff73\uff70\uff9d\u3000\u30ab\u30fc\u30cd\u30eb\u3068\u304b\u5f04\u3063\u305f\u308a\u306e\u30e1\u30e2](http://kernhack.hatenablog.com/entry/2013/10/10/170630)\u306b\u3088\u308b\u3068systemd\u3067\u306f/var/log/messages\u306f\u4f5c\u3089\u308c\u305a\u3001\u30ed\u30b0\u306e\u78ba\u8a8d\u306b\u306fjournalctl\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3046\u305d\u3046\u3067\u3059\u3002-b\u3092\u3064\u3051\u308c\u3070\u30d6\u30fc\u30c8\u4ee5\u5f8c\u306e\u30ed\u30b0\u306e\u307f\u304c\u898b\u3089\u308c\u308b\u3068\u306e\u3053\u3068\u3002\n\n\u5b9f\u884c\u4f8b\n\n```\njournalctl -b | less\n```\n\n\u51fa\u529b\u629c\u7c8b\n\n```\nApr 13 05:56:43 core-01 etcd[3055]: [etcd] Apr 13 05:56:43.514 INFO      | Discovery via http://172.17.8.100:4001 using prefix machines.\nApr 13 05:56:44 core-01 tlsdated[2891]: wait for child attempt 1\nApr 13 05:56:44 core-01 tlsdated[2891]: child exited with 0\nApr 13 05:56:44 core-01 tlsdated[2891]: tlsdate succeeded\nApr 13 05:56:44 core-01 tlsdated[2891]: synced rtc to sysclock\nApr 13 05:56:44 core-01 tlsdated[2891]: open failed: No such file or directory\nApr 13 05:56:44 core-01 tlsdated[2891]: wait for child attempt 1\nApr 13 05:56:44 core-01 tlsdated[2891]: child exited with 0\nApr 13 05:56:44 core-01 tlsdated[2891]: tlsdate succeeded\nApr 13 05:56:44 core-01 tlsdated[2891]: synced rtc to sysclock\nApr 13 05:56:44 core-01 tlsdated[2891]: open failed: No such file or directory\nApr 13 05:56:44 core-01 tlsdated[2891]: Failed to obtain UID for `tlsdate-dbus'\nApr 13 05:56:45 core-01 etcd[3055]: [etcd] Apr 13 05:56:45.924 CRITICAL  | Discovery failed and a backup peer list wasn't provided: 501: All the given peers are not reachable (Tried to connect to each peer twice and failed) [0]\nApr 13 05:56:45 core-01 systemd[1]: etcd.service: main process exited, code=exited, status=1/FAILURE\nApr 13 05:56:45 core-01 systemd[1]: Unit etcd.service entered failed state.\n```\n"}