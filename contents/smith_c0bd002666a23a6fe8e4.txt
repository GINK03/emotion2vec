{"context": " More than 1 year has passed since last update.Sqlite 3.9 \u304b\u3089\u3001\u30ab\u30e9\u30e0\u578b\u3068\u3057\u3066JSON\u304c\u8ffd\u52a0\u3055\u308c\u305f\u306e\u3067\u3001 (\u203b)JSON\u6587\u5b57\u5217\u3092\u30c7\u30fc\u30bf\u3068\u3057\u3066\u6271\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u57fa\u672c\u7684\u306a\u66f8\u304d\u65b9\u3092\u8a66\u3057\u3066\u307f\u305f\u3002\nhttps://www.sqlite.org/json1.html\n\u203b \u521d\u7a3f\u306e\u8868\u73fe\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u3000sqlite3\u306b\u304a\u3051\u308b\u30ab\u30e9\u30e0\u578b\u306f\u3001\u305d\u308c\u81ea\u4f53\u304c\u5024\u306e\u6027\u8cea\u3092\u6c7a\u5b9a\u3059\u308b\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u3000(\u53c2\u7167\uff1ahttps://www.sqlite.org/datatype3.html \u306e\u6700\u521d\u306e\u65b9)\n\nCREATE TABLE\nCREATE TABLE json_test_table (\n    id   INTEGER PRIMARY KEY AUTOINCREMENT,\n    name VARCHAR UNIQUE,\n    json JSON -- NEW!\n)\n\n\nINSERT\njson1 \u95a2\u6570\u3092\u5229\u7528\u3057\u305fINSERT\nINSERT INTO json_test_table (\n    name,\n    json\n)\nVALUES (\n    'test_name_1',\n    json(json_object( -- object\u306f{}\u3067\u56f2\u3046\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u578b\u306e\u3053\u3068\n        'key_for_int', 1,\n        'key_for_str', 'test_str',\n        'key_for_arr', json('[1, \"a\", 2, \"b\"]'), -- json()\u3067\u56f2\u308f\u306a\u3044\u3068\u6587\u5b57\u5217\u3068\u3057\u3066\u4fdd\u5b58\u3055\u308c\u308b\n        'key_for_obj', json('{\"c\":3, \"d\":4}'),\n        'attr_a',      'nice_attr'\n    ))\n);\n\njson\u6587\u5b57\u5217\u3067INSERT\nINSERT INTO json_test_table (name, json)\nVALUES (\n    'test_name_2',\n    json('{ -- json()\u306f\u6587\u5b57\u5217\u3082\u8a55\u4fa1\u3067\u304d\u308b\n        \"key_for_int\":2,\n        \"key_for_str\":\"test_str2\",\n        \"key_for_arr\":[5, \"e\", 6, \"f\"],\n        \"key_for_obj\":{\"g\":7, \"h\":8},\n        \"attr_b\":\"good_attr\"\n    }')\n);\n\n\nSELECT\njson\u306e\u5024\u3092\u500b\u5225\u306b\u53d6\u5f97\nSELECT \n    json_extract(json, '$.key_for_int')    as json_int, -- \u30eb\u30fc\u30c8\u3092$\u3068\u3057\u3066\u3001js\u306e\u30a2\u30af\u30bb\u30b5\u306e\u8a18\u6cd5\u3067\u5024\u3092\u53d6\u5f97\u3059\u308b\n    json_extract(json, '$.key_for_str')    as json_str,\n    json_extract(json, '$.key_for_arr[1]') as json_array_element_2,\n    json_extract(json, '$.key_for_obj.d')  as json_array_object_d\nFROM\n    json_test_table\nWHERE\n    name = 'test_name_1'\n\njson\u306e\u5024\u3092\u6761\u4ef6\u306b\u4f7f\u7528\u3059\u308b\njson_tree\u3092\u5229\u7528\u3057\u305f\u4f8b\u3002\n\u5024\u306fjson_tree.value\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\nSELECT\n    tree.value as attr_b\nFROM\n    json_test_table,\n    json_tree(json_test_table.json, '$.attr_b') as tree -- attr_b\u3092json_tree\u3068\u3057\u3066\u53d6\u5f97\u3059\u308b\nWHERE\n    tree.value IS NOT NULL\n\njson_extract\u3092\u5229\u7528\u3057\u305f\u4f8b\u3002\nSELECT\n    json_extract(json_test_table.json, '$.attr_b') as attr_b\nFROM\n    json_test_table\nWHERE\n    json_extract(json_test_table.json, '$.attr_b') IS NOT NULL\n\nJSON\u578b\u30ab\u30e9\u30e0\u306e\u30c7\u30fc\u30bf\u3092json\u6587\u5b57\u5217\u3068\u3057\u3066\u53d6\u5f97\u3059\u308b\njson_tree\u306b\u306fjson\u6587\u5b57\u5217\u304cjson\u30ab\u30e9\u30e0\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u3002\nSELECT\n    tree.json\nFROM\n    json_test_table,\n    json_tree(json_test_table.json) as tree\nWHERE\n    name = 'test_name_1'\n\njson\u306e\u5024\u3067ORDER BY\u3059\u308b\nSELECT\n    name\nFROM\n    json_test_table\nORDER BY\n    json_extract(json, '$.key_for_str') DESC\n\n\n\u6240\u611f\npros\n\njson\u6587\u5b57\u5217\u304c\u7528\u610f\u3067\u304d\u308c\u3070\u4fdd\u5b58\u3059\u308b\u306e\u306f\u7c21\u5358\nJSON\u3067\u3082\u30bd\u30fc\u30c8\u3084\u691c\u7d22\u6761\u4ef6\u304c\u6307\u5b9a\u3067\u304d\u305f\u308a\u3001\u4ed6\u306e\u30c7\u30fc\u30bf\u3068\u7d50\u5408\u3067\u304d\u308b\u306e\u306f\u5229\u70b9\n\ncons\n\nJSON\u30c7\u30fc\u30bf\u306e\u6271\u3044\u65b9\u304c\u7c21\u4fbf\u3067\u306a\u3044\n\u30a2\u30d7\u30ea\u5411\u3051\u306b\u30e9\u30c3\u30d1\u30fcAPI\u3092\u7528\u610f\u3059\u308b\u306e\u304c\u5927\u5909\u305d\u3046\n\nboth\n\n\u30b9\u30ad\u30fc\u30e0\u3092\u7121\u8996\u3057\u3066\u30ad\u30fc\u304c\u53ef\u5909\u9577\u306a\u30c7\u30fc\u30bf\u3092\u6271\u3048\u308b\n\nSqlite 3.9 \u304b\u3089\u3001~~\u30ab\u30e9\u30e0\u578b\u3068\u3057\u3066JSON\u304c\u8ffd\u52a0\u3055\u308c\u305f\u306e\u3067\u3001~~ (\u203b)JSON\u6587\u5b57\u5217\u3092\u30c7\u30fc\u30bf\u3068\u3057\u3066\u6271\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u57fa\u672c\u7684\u306a\u66f8\u304d\u65b9\u3092\u8a66\u3057\u3066\u307f\u305f\u3002\nhttps://www.sqlite.org/json1.html\n\n\u203b \u521d\u7a3f\u306e\u8868\u73fe\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u3000sqlite3\u306b\u304a\u3051\u308b\u30ab\u30e9\u30e0\u578b\u306f\u3001\u305d\u308c\u81ea\u4f53\u304c\u5024\u306e\u6027\u8cea\u3092\u6c7a\u5b9a\u3059\u308b\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u3000(\u53c2\u7167\uff1ahttps://www.sqlite.org/datatype3.html \u306e\u6700\u521d\u306e\u65b9)\n\n## CREATE TABLE\n\n    CREATE TABLE json_test_table (\n        id   INTEGER PRIMARY KEY AUTOINCREMENT,\n        name VARCHAR UNIQUE,\n        json JSON -- NEW!\n    )\n\n## INSERT\n\n__json1 \u95a2\u6570\u3092\u5229\u7528\u3057\u305fINSERT__\n\n    INSERT INTO json_test_table (\n        name,\n        json\n    )\n    VALUES (\n        'test_name_1',\n        json(json_object( -- object\u306f{}\u3067\u56f2\u3046\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u578b\u306e\u3053\u3068\n            'key_for_int', 1,\n            'key_for_str', 'test_str',\n            'key_for_arr', json('[1, \"a\", 2, \"b\"]'), -- json()\u3067\u56f2\u308f\u306a\u3044\u3068\u6587\u5b57\u5217\u3068\u3057\u3066\u4fdd\u5b58\u3055\u308c\u308b\n            'key_for_obj', json('{\"c\":3, \"d\":4}'),\n            'attr_a',      'nice_attr'\n        ))\n    );\n\n__json\u6587\u5b57\u5217\u3067INSERT__\n\n    INSERT INTO json_test_table (name, json)\n    VALUES (\n        'test_name_2',\n        json('{ -- json()\u306f\u6587\u5b57\u5217\u3082\u8a55\u4fa1\u3067\u304d\u308b\n            \"key_for_int\":2,\n            \"key_for_str\":\"test_str2\",\n            \"key_for_arr\":[5, \"e\", 6, \"f\"],\n            \"key_for_obj\":{\"g\":7, \"h\":8},\n            \"attr_b\":\"good_attr\"\n        }')\n    );\n\n## SELECT\n\n__json\u306e\u5024\u3092\u500b\u5225\u306b\u53d6\u5f97__\n\n    SELECT \n        json_extract(json, '$.key_for_int')    as json_int, -- \u30eb\u30fc\u30c8\u3092$\u3068\u3057\u3066\u3001js\u306e\u30a2\u30af\u30bb\u30b5\u306e\u8a18\u6cd5\u3067\u5024\u3092\u53d6\u5f97\u3059\u308b\n        json_extract(json, '$.key_for_str')    as json_str,\n        json_extract(json, '$.key_for_arr[1]') as json_array_element_2,\n        json_extract(json, '$.key_for_obj.d')  as json_array_object_d\n    FROM\n        json_test_table\n    WHERE\n        name = 'test_name_1'\n\n\n__json\u306e\u5024\u3092\u6761\u4ef6\u306b\u4f7f\u7528\u3059\u308b__\n\n[_json_tree_](https://www.sqlite.org/json1.html#jtree)\u3092\u5229\u7528\u3057\u305f\u4f8b\u3002\n\u5024\u306f_json_tree.value_\u3067\u53d6\u5f97\u3067\u304d\u308b\u3002\n\n    SELECT\n        tree.value as attr_b\n    FROM\n        json_test_table,\n        json_tree(json_test_table.json, '$.attr_b') as tree -- attr_b\u3092json_tree\u3068\u3057\u3066\u53d6\u5f97\u3059\u308b\n    WHERE\n        tree.value IS NOT NULL\n\n[_json_extract_](https://www.sqlite.org/json1.html#jex)\u3092\u5229\u7528\u3057\u305f\u4f8b\u3002\n\n    SELECT\n        json_extract(json_test_table.json, '$.attr_b') as attr_b\n    FROM\n        json_test_table\n    WHERE\n        json_extract(json_test_table.json, '$.attr_b') IS NOT NULL\n\n__JSON\u578b\u30ab\u30e9\u30e0\u306e\u30c7\u30fc\u30bf\u3092json\u6587\u5b57\u5217\u3068\u3057\u3066\u53d6\u5f97\u3059\u308b__\n\n[json_tree](https://www.sqlite.org/json1.html#jtree)\u306b\u306fjson\u6587\u5b57\u5217\u304c_json_\u30ab\u30e9\u30e0\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u3002\n\n    SELECT\n        tree.json\n    FROM\n        json_test_table,\n        json_tree(json_test_table.json) as tree\n    WHERE\n        name = 'test_name_1'\n\n__json\u306e\u5024\u3067ORDER BY\u3059\u308b__\n\n    SELECT\n        name\n    FROM\n        json_test_table\n    ORDER BY\n        json_extract(json, '$.key_for_str') DESC\n\n\n## \u6240\u611f\n\n__pros__\n\n- json\u6587\u5b57\u5217\u304c\u7528\u610f\u3067\u304d\u308c\u3070\u4fdd\u5b58\u3059\u308b\u306e\u306f\u7c21\u5358\n- JSON\u3067\u3082\u30bd\u30fc\u30c8\u3084\u691c\u7d22\u6761\u4ef6\u304c\u6307\u5b9a\u3067\u304d\u305f\u308a\u3001\u4ed6\u306e\u30c7\u30fc\u30bf\u3068\u7d50\u5408\u3067\u304d\u308b\u306e\u306f\u5229\u70b9\n\n__cons__\n\n- JSON\u30c7\u30fc\u30bf\u306e\u6271\u3044\u65b9\u304c\u7c21\u4fbf\u3067\u306a\u3044\n- \u30a2\u30d7\u30ea\u5411\u3051\u306b\u30e9\u30c3\u30d1\u30fcAPI\u3092\u7528\u610f\u3059\u308b\u306e\u304c\u5927\u5909\u305d\u3046\n\n__both__\n\n- \u30b9\u30ad\u30fc\u30e0\u3092\u7121\u8996\u3057\u3066\u30ad\u30fc\u304c\u53ef\u5909\u9577\u306a\u30c7\u30fc\u30bf\u3092\u6271\u3048\u308b\n\n", "tags": ["sqlite3.9", "JSON"]}