{"context": " More than 1 year has passed since last update.PRML\u6f14\u7fd28.3\u306e\u901a\u308a\u3001\u4e0e\u3048\u3089\u308c\u305f2\u5024\u5909\u6570a,b,c\u306e\u540c\u6642\u5206\u5e03\u304b\u3089\u3001a\u3068b\u304c\u72ec\u7acb\u3067\u306a\u304f\u3001c\u306e\u3082\u3068\u3067\u6761\u4ef6\u4ed8\u304d\u72ec\u7acb\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001p(a,b,c)=p(a,b|c)p(c)=p(a|c)p(b|c)p(c)\u306b\u5bfe\u5fdc\u3059\u308b\u30d9\u30a4\u30b8\u30a2\u30f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u63cf\u753b\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u6f14\u7fd28.4\u306e\u901a\u308a\u3001\u540c\u6642\u5206\u5e03\u304cp(a,b,c)=p(a)p(c|a)p(b|c)\u3068\u3082\u56e0\u6570\u5206\u89e3\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001\u5bfe\u5fdc\u3059\u308b\u30d9\u30a4\u30b8\u30a2\u30f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u63cf\u753b\u3057\u307e\u3059\u3002\n  a b p(a,b) p(a)p(b) p(a,b|c=0) p(a|c=0)p(b|c=0) p(a,b|c=1) p(a|c=1)p(b|c=1)\n1 0 0  0.336   0.3552        0.4              0.4  0.2769231        0.2769231\n2 0 1  0.264   0.2448        0.1              0.1  0.4153846        0.4153846\n3 1 0  0.256   0.2368        0.4              0.4  0.1230769        0.1230769\n4 1 1  0.144   0.1632        0.1              0.1  0.1846154        0.1846154\n  a b c     p p(a|c)p(b|c)p(c) p(a)p(c|a)p(b|c)\n1 0 0 0 0.192            0.192            0.192\n2 0 0 1 0.144            0.144            0.144\n3 0 1 0 0.048            0.048            0.048\n4 0 1 1 0.216            0.216            0.216\n5 1 0 0 0.192            0.192            0.192\n6 1 0 1 0.064            0.064            0.064\n7 1 1 0 0.048            0.048            0.048\n8 1 1 1 0.096            0.096            0.096\n\n\nlibrary(igraph)\nframe()\nset.seed(0)\npar(mfcol=c(1, 2))\npar(mar=c(0, 0, 1, 0))\n\nd <- data.frame(matrix(c(\n    0, 0, 0, 192,\n    0, 0, 1, 144,\n    0, 1, 0, 48,\n    0, 1, 1, 216,\n    1, 0, 0, 192,\n    1, 0, 1, 64,\n    1, 1, 0, 48,\n    1, 1, 1, 96\n    ), ncol=4, byrow=T))\nnames(d) <- c(\"a\", \"b\", \"c\", \"p\")\nd$p <- d$p / 1000\n\n# p(a,b)\ndab <- data.frame()\nfor (a in 0:1) {\n    for (b in 0:1) {\n        pa <- sum(d[d$a == a,]$p) # p(a)\n        pb <- sum(d[d$b == b,]$p) # p(b)\n        dab <- rbind(dab, c(\n            a, \n            b, \n            sum(d[d$a == a & d$b == b,]$p), \n            pa * pb\n            ))\n    }\n}\nnames(dab) <- c(\"a\", \"b\", \"p(a,b)\", \"p(a)p(b)\")\n\n# p(a,b|c)\nfor (a in 0:1) {\n    for (b in 0:1) {\n        for (c in 0:1) {\n            pc <- sum(d[d$c == c,]$p) # p(c)\n            pabc <- sum(d[d$a == a & d$b == b & d$c == c,]$p) / pc\n            dab[dab$a == a & dab$b == b, paste0(\"p(a,b|c=\", c, \")\")] <- pabc\n            pac <- sum(d[d$a == a & d$c == c,]$p) / pc # p(a|c)\n            pbc <- sum(d[d$b == b & d$c == c,]$p) / pc # p(b|c)\n            dab[dab$a == a & dab$b == b, paste0(\"p(a|c=\", c, \")p(b|c=\", c, \")\")] <- pac * pbc\n        }\n    }\n}\nprint(dab)\n\n# p(a,b,c)=p(a|c)p(b|c)p(c)\nfor (i in 1:nrow(d)) {\n    pc <- sum(d[d$c == d[i,]$c,]$p) # p(c)\n    pac <- sum(d[d$a == d[i,]$a & d$c == d[i,]$c,]$p) / pc # p(a|c)\n    pbc <- sum(d[d$b == d[i,]$b & d$c == d[i,]$c,]$p) / pc # p(b|c)\n    d[i,\"p(a|c)p(b|c)p(c)\"] <- pac * pbc * pc\n}\ng1 <- graph(c(3, 1, 3, 2))\nV(g1)$size <- 100\nV(g1)$label.cex <- 2\nV(g1)$label <- letters[1:3]\nplot(g1, layout=layout.circle)\ntitle(\"p(a|c)p(b|c)p(c)\")\n\n# p(a,b,c)=p(a)p(c|a)p(b|c)\nfor (i in 1:nrow(d)) {\n    pa <- sum(d[d$a == d[i,]$a,]$p) # p(a)\n    pc <- sum(d[d$c == d[i,]$c,]$p) # p(c)\n    pca <- sum(d[d$c == d[i,]$c & d$a == d[i,]$a,]$p) / pa # p(c|a)\n    pbc <- sum(d[d$b == d[i,]$b & d$c == d[i,]$c,]$p) / pc # p(b|c)\n    d[i,\"p(a)p(c|a)p(b|c)\"] <- pa * pca * pbc\n}\ng2 <- graph(c(1, 3, 3, 2))\nV(g2)$size <- 100\nV(g2)$label.cex <- 2\nV(g2)$label <- letters[1:3]\nplot(g2, layout=layout.circle)\ntitle(\"p(a)p(c|a)p(b|c)\")\n\nprint(d)\n\nPRML\u6f14\u7fd28.3\u306e\u901a\u308a\u3001\u4e0e\u3048\u3089\u308c\u305f2\u5024\u5909\u6570a,b,c\u306e\u540c\u6642\u5206\u5e03\u304b\u3089\u3001a\u3068b\u304c\u72ec\u7acb\u3067\u306a\u304f\u3001c\u306e\u3082\u3068\u3067\u6761\u4ef6\u4ed8\u304d\u72ec\u7acb\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001p(a,b,c)=p(a,b|c)p(c)=p(a|c)p(b|c)p(c)\u306b\u5bfe\u5fdc\u3059\u308b\u30d9\u30a4\u30b8\u30a2\u30f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u63cf\u753b\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u6f14\u7fd28.4\u306e\u901a\u308a\u3001\u540c\u6642\u5206\u5e03\u304cp(a,b,c)=p(a)p(c|a)p(b|c)\u3068\u3082\u56e0\u6570\u5206\u89e3\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3001\u5bfe\u5fdc\u3059\u308b\u30d9\u30a4\u30b8\u30a2\u30f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u63cf\u753b\u3057\u307e\u3059\u3002\n\n```\n  a b p(a,b) p(a)p(b) p(a,b|c=0) p(a|c=0)p(b|c=0) p(a,b|c=1) p(a|c=1)p(b|c=1)\n1 0 0  0.336   0.3552        0.4              0.4  0.2769231        0.2769231\n2 0 1  0.264   0.2448        0.1              0.1  0.4153846        0.4153846\n3 1 0  0.256   0.2368        0.4              0.4  0.1230769        0.1230769\n4 1 1  0.144   0.1632        0.1              0.1  0.1846154        0.1846154\n  a b c     p p(a|c)p(b|c)p(c) p(a)p(c|a)p(b|c)\n1 0 0 0 0.192            0.192            0.192\n2 0 0 1 0.144            0.144            0.144\n3 0 1 0 0.048            0.048            0.048\n4 0 1 1 0.216            0.216            0.216\n5 1 0 0 0.192            0.192            0.192\n6 1 0 1 0.064            0.064            0.064\n7 1 1 0 0.048            0.048            0.048\n8 1 1 1 0.096            0.096            0.096\n```\n\n![](https://dl.dropbox.com/sh/cwfemibvr7gk4cy/uB2pspE7I6/17.ConditionalIndependence.png)\n\n```r\nlibrary(igraph)\nframe()\nset.seed(0)\npar(mfcol=c(1, 2))\npar(mar=c(0, 0, 1, 0))\n\nd <- data.frame(matrix(c(\n\t0, 0, 0, 192,\n\t0, 0, 1, 144,\n\t0, 1, 0, 48,\n\t0, 1, 1, 216,\n\t1, 0, 0, 192,\n\t1, 0, 1, 64,\n\t1, 1, 0, 48,\n\t1, 1, 1, 96\n\t), ncol=4, byrow=T))\nnames(d) <- c(\"a\", \"b\", \"c\", \"p\")\nd$p <- d$p / 1000\n\n# p(a,b)\ndab <- data.frame()\nfor (a in 0:1) {\n\tfor (b in 0:1) {\n\t\tpa <- sum(d[d$a == a,]$p) # p(a)\n\t\tpb <- sum(d[d$b == b,]$p) # p(b)\n\t\tdab <- rbind(dab, c(\n\t\t\ta, \n\t\t\tb, \n\t\t\tsum(d[d$a == a & d$b == b,]$p), \n\t\t\tpa * pb\n\t\t\t))\n\t}\n}\nnames(dab) <- c(\"a\", \"b\", \"p(a,b)\", \"p(a)p(b)\")\n\n# p(a,b|c)\nfor (a in 0:1) {\n\tfor (b in 0:1) {\n\t\tfor (c in 0:1) {\n\t\t\tpc <- sum(d[d$c == c,]$p) # p(c)\n\t\t\tpabc <- sum(d[d$a == a & d$b == b & d$c == c,]$p) / pc\n\t\t\tdab[dab$a == a & dab$b == b, paste0(\"p(a,b|c=\", c, \")\")] <- pabc\n\t\t\tpac <- sum(d[d$a == a & d$c == c,]$p) / pc # p(a|c)\n\t\t\tpbc <- sum(d[d$b == b & d$c == c,]$p) / pc # p(b|c)\n\t\t\tdab[dab$a == a & dab$b == b, paste0(\"p(a|c=\", c, \")p(b|c=\", c, \")\")] <- pac * pbc\n\t\t}\n\t}\n}\nprint(dab)\n\n# p(a,b,c)=p(a|c)p(b|c)p(c)\nfor (i in 1:nrow(d)) {\n\tpc <- sum(d[d$c == d[i,]$c,]$p) # p(c)\n\tpac <- sum(d[d$a == d[i,]$a & d$c == d[i,]$c,]$p) / pc # p(a|c)\n\tpbc <- sum(d[d$b == d[i,]$b & d$c == d[i,]$c,]$p) / pc # p(b|c)\n\td[i,\"p(a|c)p(b|c)p(c)\"] <- pac * pbc * pc\n}\ng1 <- graph(c(3, 1, 3, 2))\nV(g1)$size <- 100\nV(g1)$label.cex <- 2\nV(g1)$label <- letters[1:3]\nplot(g1, layout=layout.circle)\ntitle(\"p(a|c)p(b|c)p(c)\")\n\n# p(a,b,c)=p(a)p(c|a)p(b|c)\nfor (i in 1:nrow(d)) {\n\tpa <- sum(d[d$a == d[i,]$a,]$p) # p(a)\n\tpc <- sum(d[d$c == d[i,]$c,]$p) # p(c)\n\tpca <- sum(d[d$c == d[i,]$c & d$a == d[i,]$a,]$p) / pa # p(c|a)\n\tpbc <- sum(d[d$b == d[i,]$b & d$c == d[i,]$c,]$p) / pc # p(b|c)\n\td[i,\"p(a)p(c|a)p(b|c)\"] <- pa * pca * pbc\n}\ng2 <- graph(c(1, 3, 3, 2))\nV(g2)$size <- 100\nV(g2)$label.cex <- 2\nV(g2)$label <- letters[1:3]\nplot(g2, layout=layout.circle)\ntitle(\"p(a)p(c|a)p(b|c)\")\n\nprint(d)\n```\n", "tags": ["R", "PRML"]}