{"context": "\n\nWindowsUpdate\n\nwindows update / microsoft up\n\nPowershell module\nhttps://gallery.technet.microsoft.com/scriptcenter/2d191bcd-3308-4edd-9de2-88dff796b0bc/\nhttps://www.petri.com/manage-windows-updates-with-powershell-module\n\ninstall\nUnzip to \n%USERPROFILE%\\Documents\\WindowsPowerShell\\Modules\nOr\n%WINDIR%\\System32\\WindowsPowerShell\\v1.0\\Modules\nImport-Module PSWindowsUpdate\n# list\nGet-Command \u2013module PSWindowsUpdate \n\n\nCommand-let\n\nUpdate Category?\n\nCritical Updates\nSecurity Updates\nUpdate Rollups\n\nUpdates < GUI treat it as Option\n\n\n\ntypical update\nGet-WUInstall -ListOnly -Category 'Security Updates','Critical Updates'\n\n\nNon admin user's enviroment_vars\ncontrol panel > user account > user account > edit env... \n\nETW?\nEvent Tracing for Windows\nhttp://tech.blog.aerie.jp/entry/2014/09/09/165448\n\nETW == EventLog?\nNo. \n\nDisable shutdown event tracker.\nhttps://blogs.technet.microsoft.com/chenley/2011/03/05/how-to-disable-the-shutdown-tracker-in-windows-server-2008-r2/\n\nEnable task scheduler's history\nhttp://www.powershellmagazine.com/2013/07/15/pstip-how-to-enable-event-logs-using-windows-powershell/\nWhy default was false ???\n$logName = 'Microsoft-Windows-TaskScheduler/Operational'\n$log = New-Object System.Diagnostics.Eventing.Reader.EventLogConfiguration $logName\n$log.IsEnabled=$true\n$log.SaveChanges()\n\n\nschtask\nschtasks manage windows task-scheduler.\nschtasks /create /tn <task-name> /tr \"<execute command>\" /sc daily /st 01:00 /rl highest /np /F\n\n\nAWS cloudwatch logs\n\nedit cat \"c:\\program files\\Amazon\\Ec2ConfigService\\Settings\\Config.xml\n\nrestert service sc or start-service\n\n\n\n# WindowsUpdate\n## windows update / microsoft up\n## Powershell module\nhttps://gallery.technet.microsoft.com/scriptcenter/2d191bcd-3308-4edd-9de2-88dff796b0bc/\nhttps://www.petri.com/manage-windows-updates-with-powershell-module\n### install\nUnzip to \n`%USERPROFILE%\\Documents\\WindowsPowerShell\\Modules`\nOr\n`%WINDIR%\\System32\\WindowsPowerShell\\v1.0\\Modules`\n\n```powershell:\nImport-Module PSWindowsUpdate\n# list\nGet-Command \u2013module PSWindowsUpdate \n```\n### Command-let\n\n### Update Category?\n- `Critical Updates`\n- `Security Updates`\n- `Update Rollups`\n- `Updates` < GUI treat it as `Option`\n\n### typical update\n```powershell:\nGet-WUInstall -ListOnly -Category 'Security Updates','Critical Updates'\n```\n# Non admin user's enviroment_vars\n`control panel > user account > user account > edit env...` \n\n# ETW?\nEvent Tracing for Windows\nhttp://tech.blog.aerie.jp/entry/2014/09/09/165448\n## ETW == EventLog?\nNo. \n\n# Disable shutdown event tracker.\nhttps://blogs.technet.microsoft.com/chenley/2011/03/05/how-to-disable-the-shutdown-tracker-in-windows-server-2008-r2/\n\n# Enable task scheduler's history\nhttp://www.powershellmagazine.com/2013/07/15/pstip-how-to-enable-event-logs-using-windows-powershell/\nWhy default was false ???\n\n```powerhsell:\n$logName = 'Microsoft-Windows-TaskScheduler/Operational'\n$log = New-Object System.Diagnostics.Eventing.Reader.EventLogConfiguration $logName\n$log.IsEnabled=$true\n$log.SaveChanges()\n```\n\n\n# schtask\n`schtasks` manage windows task-scheduler.\n\n```\nschtasks /create /tn <task-name> /tr \"<execute command>\" /sc daily /st 01:00 /rl highest /np /F\n```\n\n# AWS cloudwatch logs\n1. edit `cat \"c:\\program files\\Amazon\\Ec2ConfigService\\Settings\\Config.xml`\n2. restert service `sc` or `start-service`\n", "tags": ["Windows", "WindowsUpdate"]}