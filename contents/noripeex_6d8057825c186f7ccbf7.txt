{"context": " More than 1 year has passed since last update.\u753b\u50cf\u3092\u5727\u7e2e\u3057\u3066\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306bcarrierwave\u3068imagemagick\u3068piet\u4f7f\u3063\u3066\u307f\u305f\u3002\n\n\u74b0\u5883\nMacbook Pro (2.6 GHz Intel Core i5)\nmacOS X 10.10.5\nrails 4.2.3\ncarrierwave 0.10.0\nimagemagick 6.9.1-10\nrmagick 2.15.4\npiet 0.2.2\n\nGemfile\n\u4e00\u901a\u308a\u8ffd\u52a0\u3057\u3066bundle install\u3059\u308b\u3002\n\nGemfile\n  gem 'carrierwave'\n  gem 'piet'\n  gem 'rmagick'\n\n\n$ bundle install\n\n\nimagemagick\n\u666e\u901a\u306b\u6700\u65b0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066rails\u8d77\u52d5\u3057\u305f\u3089rmagick\u3068\u30d0\u30fc\u30b8\u30e7\u30f3\u5408\u3063\u3066\u306d\u30fc\u3068\u6012\u3089\u308c\u305f\u3002\n$ rails s\nUncaught exception: This installation of RMagick was configured with ImageMagick 6.9.1 but ImageMagick 6.9.2-3 is in use.\n\nbrew log\u3067\u9069\u5207\u306a\u30d0\u30fc\u30b8\u30e7\u30f3\uff08\u3053\u3053\u3067\u306f6.9.1\uff09\u3092\u63a2\u3059\u3002\n$ brew log imagemagick\n\n\u72d9\u3044\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u3063\u3066\u304f\u308b\u3002\n$ git checkout 20376e8fe12529cbac4cbe1a94654b90ae082335 /usr/local/Library/Formula/imagemagick.rb \n\n\u53d6\u308c\u305f\u304b\u78ba\u8a8d\u3002\n$ brew info imagemagick\nimagemagick: stable 6.9.1-10 (bottled), HEAD\nTools and libraries to manipulate images in many formats\nhttp://www.imagemagick.org\n/usr/local/Cellar/imagemagick/6.9.2-3 (1448 files, 22M) *\n  Poured from bottle\nFrom: https://github.com/Homebrew/homebrew/blob/master/Library/Formula/imagemagick.rb\n==> Dependencies\n...\n\n\u518d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\u5148\u306bunlink\u3059\u308b\u306e\u3092\u5fd8\u308c\u305a\u306b\u3002\n$ brew unlink imagemagick\nUnlinking /usr/local/Cellar/imagemagick/6.9.2-3... 72 symlinks removed\n\n$ brew install imagemagick\n==> Downloading https://homebrew.bintray.com/bottles/imagemagick-6.9.1-10.yosemite.bottle.tar.gz\n######################################################################## 100.0%\n==> Pouring imagemagick-6.9.1-10.yosemite.bottle.tar.gz\n\ud83c\udf7a  /usr/local/Cellar/imagemagick/6.9.1-10: 1447 files, 22M\n\n\u3053\u308c\u3067OK\u3002\n\noptipng\nhomebrew\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3002\n$ brew install optipng\n==> Downloading https://downloads.sourceforge.net/project/optipng/OptiPNG/optipng-0.7.5/optipng-0.7.5.tar.gz\n==> Downloading from http://jaist.dl.sourceforge.net/project/optipng/OptiPNG/optipng-0.7.5/optipng-0.7.5.tar.gz\n######################################################################## 100.0%\n==> Patching\npatching file src/optipng/osys.c\n==> ./configure --with-system-zlib --prefix=/usr/local/Cellar/optipng/0.7.5 --mandir=/usr/local/Cellar/optipng/0.7.5/share/man\n==> make install\n\ud83c\udf7a  /usr/local/Cellar/optipng/0.7.5: 6 files, 156K, built in 14 seconds\n\n\njpegoptim\n\u3053\u3061\u3089\u3082\u540c\u69d8\u3002\n$ brew install jpegoptim\n==> Downloading https://homebrew.bintray.com/bottles/jpegoptim-1.4.3.yosemite.bottle.1.tar.gz\n######################################################################## 100.0%\n==> Pouring jpegoptim-1.4.3.yosemite.bottle.1.tar.gz\n\ud83c\udf7a  /usr/local/Cellar/jpegoptim/1.4.3: 6 files, 72K\n\n\ncarrierwave\u306e\u8a2d\u5b9a\n\u3053\u3093\u306a\u611f\u3058\u3067\u3002\n\napp/aploaders/image_uploader.rb\nclass ImageUploader < CarrierWave::Uploader::Base\n  include CarrierWave::RMagick\n  include Piet::CarrierWaveExtension\n\n  # resize_to_fit(): \u305d\u306e\u30b5\u30a4\u30ba\u306b\u5408\u3046\u3088\u3046\u306b\u30ea\u30b5\u30a4\u30ba\u3002\uff08\u5927\u304d\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308b\u3002\uff09\n  # resize_to_limit(): \u305d\u306e\u30b5\u30a4\u30ba\u3088\u308a\u5927\u304d\u3044\u753b\u50cf\u306e\u3068\u304d\u306b\u3001\u305d\u306e\u30b5\u30a4\u30ba\u306b\u5408\u3046\u3088\u3046\u306b\u30ea\u30b5\u30a4\u30ba\u3002\uff08\u5927\u304d\u304f\u306a\u308b\u3053\u3068\u306f\u306a\u3044\u3002\uff09\n  version :icon do\n    process resize_to_limit: [150, 150]\n  end\n\n  process convert: 'jpg'\n  process optimize: [quality: 50]\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n\n  def filename\n    'hogehoge.jpg' if original_filename.present?\n  end\nend\n\n\n\u3053\u308c\u3067\u3044\u3044\u611f\u3058\u306b\u5727\u7e2e\u304b\u304b\u308b\u306f\u305a\u3002\n\u5727\u7e2e\u306f\u305d\u3053\u305d\u3053\u6642\u9593\u304b\u304b\u308b\u3002\uff08400KB\u306e\u753b\u50cf\u30923\u679a\u306b\u5727\u7e2e\u304b\u3051\u308b\u306e\u306b1\u79d2\u304f\u3089\u3044\uff09\n\u753b\u50cf\u3092\u5727\u7e2e\u3057\u3066\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306bcarrierwave\u3068imagemagick\u3068piet\u4f7f\u3063\u3066\u307f\u305f\u3002\n\n# \u74b0\u5883\nMacbook Pro (2.6 GHz Intel Core i5)\nmacOS X 10.10.5\nrails 4.2.3\n[carrierwave](https://github.com/carrierwaveuploader/carrierwave) 0.10.0\n[imagemagick](http://www.imagemagick.org/) 6.9.1-10\n[rmagick](https://github.com/rmagick/rmagick) 2.15.4\n[piet](https://github.com/albertbellonch/piet) 0.2.2\n\n# Gemfile\n\u4e00\u901a\u308a\u8ffd\u52a0\u3057\u3066bundle install\u3059\u308b\u3002\n\n```ruby:Gemfile\n  gem 'carrierwave'\n  gem 'piet'\n  gem 'rmagick'\n```\n\n```bash\n$ bundle install\n```\n\n# imagemagick\n\u666e\u901a\u306b\u6700\u65b0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066rails\u8d77\u52d5\u3057\u305f\u3089rmagick\u3068\u30d0\u30fc\u30b8\u30e7\u30f3\u5408\u3063\u3066\u306d\u30fc\u3068\u6012\u3089\u308c\u305f\u3002\n\n```bash\n$ rails s\nUncaught exception: This installation of RMagick was configured with ImageMagick 6.9.1 but ImageMagick 6.9.2-3 is in use.\n```\n\nbrew log\u3067\u9069\u5207\u306a\u30d0\u30fc\u30b8\u30e7\u30f3\uff08\u3053\u3053\u3067\u306f6.9.1\uff09\u3092\u63a2\u3059\u3002\n\n```bash\n$ brew log imagemagick\n```\n\n\u72d9\u3044\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u53d6\u3063\u3066\u304f\u308b\u3002\n\n```bash\n$ git checkout 20376e8fe12529cbac4cbe1a94654b90ae082335 /usr/local/Library/Formula/imagemagick.rb \n```\n\n\u53d6\u308c\u305f\u304b\u78ba\u8a8d\u3002\n\n```bash\n$ brew info imagemagick\nimagemagick: stable 6.9.1-10 (bottled), HEAD\nTools and libraries to manipulate images in many formats\nhttp://www.imagemagick.org\n/usr/local/Cellar/imagemagick/6.9.2-3 (1448 files, 22M) *\n  Poured from bottle\nFrom: https://github.com/Homebrew/homebrew/blob/master/Library/Formula/imagemagick.rb\n==> Dependencies\n...\n```\n\n\u518d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\u5148\u306bunlink\u3059\u308b\u306e\u3092\u5fd8\u308c\u305a\u306b\u3002\n\n```bash\n$ brew unlink imagemagick\nUnlinking /usr/local/Cellar/imagemagick/6.9.2-3... 72 symlinks removed\n\n$ brew install imagemagick\n==> Downloading https://homebrew.bintray.com/bottles/imagemagick-6.9.1-10.yosemite.bottle.tar.gz\n######################################################################## 100.0%\n==> Pouring imagemagick-6.9.1-10.yosemite.bottle.tar.gz\n\ud83c\udf7a  /usr/local/Cellar/imagemagick/6.9.1-10: 1447 files, 22M\n```\n\n\u3053\u308c\u3067OK\u3002\n\n# optipng\nhomebrew\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3002\n\n```bash\n$ brew install optipng\n==> Downloading https://downloads.sourceforge.net/project/optipng/OptiPNG/optipng-0.7.5/optipng-0.7.5.tar.gz\n==> Downloading from http://jaist.dl.sourceforge.net/project/optipng/OptiPNG/optipng-0.7.5/optipng-0.7.5.tar.gz\n######################################################################## 100.0%\n==> Patching\npatching file src/optipng/osys.c\n==> ./configure --with-system-zlib --prefix=/usr/local/Cellar/optipng/0.7.5 --mandir=/usr/local/Cellar/optipng/0.7.5/share/man\n==> make install\n\ud83c\udf7a  /usr/local/Cellar/optipng/0.7.5: 6 files, 156K, built in 14 seconds\n```\n\n# jpegoptim\n\u3053\u3061\u3089\u3082\u540c\u69d8\u3002\n\n```bash\n$ brew install jpegoptim\n==> Downloading https://homebrew.bintray.com/bottles/jpegoptim-1.4.3.yosemite.bottle.1.tar.gz\n######################################################################## 100.0%\n==> Pouring jpegoptim-1.4.3.yosemite.bottle.1.tar.gz\n\ud83c\udf7a  /usr/local/Cellar/jpegoptim/1.4.3: 6 files, 72K\n```\n\n# carrierwave\u306e\u8a2d\u5b9a\n\u3053\u3093\u306a\u611f\u3058\u3067\u3002\n\n```app/aploaders/image_uploader.rb\nclass ImageUploader < CarrierWave::Uploader::Base\n  include CarrierWave::RMagick\n  include Piet::CarrierWaveExtension\n\n  # resize_to_fit(): \u305d\u306e\u30b5\u30a4\u30ba\u306b\u5408\u3046\u3088\u3046\u306b\u30ea\u30b5\u30a4\u30ba\u3002\uff08\u5927\u304d\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308b\u3002\uff09\n  # resize_to_limit(): \u305d\u306e\u30b5\u30a4\u30ba\u3088\u308a\u5927\u304d\u3044\u753b\u50cf\u306e\u3068\u304d\u306b\u3001\u305d\u306e\u30b5\u30a4\u30ba\u306b\u5408\u3046\u3088\u3046\u306b\u30ea\u30b5\u30a4\u30ba\u3002\uff08\u5927\u304d\u304f\u306a\u308b\u3053\u3068\u306f\u306a\u3044\u3002\uff09\n  version :icon do\n    process resize_to_limit: [150, 150]\n  end\n\n  process convert: 'jpg'\n  process optimize: [quality: 50]\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n\n  def filename\n    'hogehoge.jpg' if original_filename.present?\n  end\nend\n```\n\n\u3053\u308c\u3067\u3044\u3044\u611f\u3058\u306b\u5727\u7e2e\u304b\u304b\u308b\u306f\u305a\u3002\n\u5727\u7e2e\u306f\u305d\u3053\u305d\u3053\u6642\u9593\u304b\u304b\u308b\u3002\uff08400KB\u306e\u753b\u50cf\u30923\u679a\u306b\u5727\u7e2e\u304b\u3051\u308b\u306e\u306b1\u79d2\u304f\u3089\u3044\uff09\n", "tags": ["Rails", "Gem", "carrierwave", "ImageMagick", "RMagick"]}