{"context": " More than 1 year has passed since last update.\n\n\u95c7\u96f2\u306b\u8abf\u3079\u3066\u3082\u30a2\u30ec\u306a\u306e\u3067\u3002\u3002\n\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3092\u53c2\u7167\u3057\u3066\u52c9\u5f37\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u4f7f\u7528\u8a00\u8a9e\u306fJavaScript\u3067\u3044\u304d\u307e\u3059\u3002\n\n\u524d\u63d0\u6761\u4ef6\n\u30fbGoogle\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9API\u3092\u4f7f\u3046\u305f\u3081\u306b\u3001client_id\u3068apiKey\u306e\u53d6\u5f97\u306b\u6210\u529f\u3057\u3066\u3044\u308b\u3002\n\u30fbjavascript_origin \u306e\u9805\u76ee\u306b\u306f\u3001\u52d5\u304b\u3059\u30b5\u30fc\u30d0\u306e\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u5fdc\u3057\u305f\u5024\u304c\u5165\u3063\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\u4f8b) html\u30d5\u30a1\u30a4\u30eb\u304cwww.example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30b5\u30fc\u30d0\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\njavascript_origin\u306e\u5024\u306f\u3001http://www.example.com\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u69cb\u6210\u60c5\u5831\n\u5fc5\u8981\u306a\u306e\u306f\u4ee5\u4e0b\u306e\uff13\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\u30fbhello_analytics_api_v3.html \u2013 \u30dc\u30bf\u30f3\u8868\u793a\u306e\u305f\u3081\u306ehtml\u3067\u3059\u3002\n\u30fbhello_analytics_api_v3_auth.js \u2013 \u8a8d\u8a3c\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u4f7f\u3063\u3066\u3001google\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8a8d\u8a3c\u3092\u884c\u3046\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\u30fbhello_analytics_api_v3.js \u2013 \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9API\u306e\u8a8d\u8a3c\u3068\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c\u3001\u7d50\u679c\u306e\u8868\u793a\u3092\u884c\u3046\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u8aac\u660e\n\u4ee5\u4e0b\u306b\u30bd\u30fc\u30b9\u3092\u793a\u3057\u307e\u3059\uff08\u82f1\u8a9e\u90e8\u5206\u306f\u62d9\u8a33\uff09\n\nhello_analytics_api_v3.html\n<!DOCTYPE>\n<html>\n  <head>\n    <title>Hello Google Analytics API</title>\n  </head>\n  <body>\n    <!-- \u30e6\u30fc\u30b6\u306e\u5b9f\u884c\u30dc\u30bf\u30f3 -->\n    <button id=\"authorize-button\" style=\"visibility: hidden\">Authorize</button><br/>\n    <button id=\"make-api-call-button\" style=\"visibility: hidden\">Get Sessions</button>\n\n    <!-- \u3042\u3068\u3067\u4f5c\u6210\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0 -->\n    <script src=\"hello_analytics_api_v3_auth.js\"></script>\n    <script src=\"hello_analytics_api_v3.js\"></script>\n\n    <!-- html\u304c\u8aad\u307f\u8fbc\u307e\u308c\u305f\u3068\u304d\u306b\u3001\u6700\u521d\u306b\u5b9f\u884c\u3055\u308c\u308b\u95a2\u6570\u3092\u5b9a\u7fa9 -->\n    <script src=\"https://apis.google.com/js/client.js?onload=handleClientLoad\"></script>\n  </body>\n</html>\n\n\n\nhello_analytics_api_v3_auth.js\n// \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9API\u306e\u8a8d\u8a3c\u3092\u884c\u3046\u95a2\u6570\u3002\n\n// scopes\u4ee5\u5916\u306e\u5024\u306f\u3001\u5404\u81ea\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u3063\u3066\u5909\u3048\u3066\u304f\u3060\u3055\u3044\u3002\nvar clientId = \"\u5404\u81ea\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8id\";\nvar apiKey = \"\u5404\u81ea\u306eapiKey\";\nvar scopes = \"https://www.googleapis.com/auth/analytics.readonly\";\n\n// \u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u8aad\u307f\u8fbc\u307e\u308c\u305f\u3042\u3068\u3067\u3001\u6700\u521d\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n//\u3000\u4ee5\u4e0b\u3001\u547c\u3073\u51fa\u3059\u95a2\u6570\u306f\u95a2\u6570\u540d\u3092\u66f8\u3044\u305f\u6b21\u306e\u30bb\u30af\u30b7\u30e7\u30f3\uff08\u3000\u30d6\u30ec\u30fc\u30b9\u3067\u56f2\u307e\u308c\u305f\u90e8\u5206\u3000\uff09\u306b\u5b9a\u7fa9\u3057\u3066\u3044\u304f\nfunction handleClientLoad() {\n  // 1. API\u30ad\u30fc\u3092\u30bb\u30c3\u30c8\n  gapi.client.setApiKey(apiKey);\n\n  // 2. \u30e6\u30fc\u30b6\u8a8d\u8a3c\u306e\u78ba\u8a8d\n  window.setTimeout(checkAuth,1);\n}\n\nfunction checkAuth() {\n  // \u4eca\u306e\u30e6\u30fc\u30b6\u30fc\u306e\u8a8d\u8a3c\u72b6\u614b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u3001\u30b0\u30fc\u30b0\u30eb\u30a2\u30ab\u30a6\u30f3\u30c8\u30b5\u30fc\u30d3\u30b9\u3092\u547c\u3073\u51fa\u3059\n  // handleAuthResult\u95a2\u6570\u3078\u3001\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u7d50\u679c\u3092\u8fd4\u5374\u3059\u308b\n  gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true}, handleAuthResult);\n}\n\nfunction handleAuthResult(authResult) {\n  if (authResult) {\n    // \u30e6\u30fc\u30b6\u30fc\u306e\u8a8d\u8a3c\u304c\u5b8c\u4e86\n    // \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u60c5\u5831\u3092\u8aad\u307f\u8fbc\u3080\n    loadAnalyticsClient();\n  } else {\n    // \u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u304c\u5931\u6557\n    handleUnAuthorized();\n  }\n}\n\n// \u8a8d\u8a3c\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\nfunction handleAuthorized() {\n  var authorizeButton = document.getElementById('authorize-button');\n  var makeApiCallButton = document.getElementById('make-api-call-button');\n\n// 'Get Sessions'\u30dc\u30bf\u30f3\u3092\u8868\u793a\u3057\u3001 'Authorize'\u30dc\u30bf\u30f3\u3092\u975e\u8868\u793a\n  makeApiCallButton.style.visibility = '';\n  authorizeButton.style.visibility = 'hidden';\n\n  // 'Get Sessions'\u30dc\u30bf\u30f3\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u305f\u5834\u5408\u3001makeAapiCall function\u3092\u5b9f\u884c\n  makeApiCallButton.onclick = makeApiCall;\n}\n\n// \u8a8d\u8a3c\u3055\u308c\u306a\u304b\u3063\u305f\u30e6\u30fc\u30b6\u30fc\nfunction handleUnAuthorized() {\n  var authorizeButton = document.getElementById('authorize-button');\n  var makeApiCallButton = document.getElementById('make-api-call-button');\n\n  // 'Authorize'\u30dc\u30bf\u30f3\u3092\u8868\u793a\u3057\u3001 'Get Sessions'\u30dc\u30bf\u30f3\u3092\u975e\u8868\u793a\n  makeApiCallButton.style.visibility = 'hidden';\n  authorizeButton.style.visibility = '';\n\n  // 'Authorize'\u30dc\u30bf\u30f3\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u305f\u5834\u5408\u3001handleAuthClick \u3092\u5b9f\u884c\n  authorizeButton.onclick = handleAuthClick;\n}\n\nfunction handleAuthClick(event) {\n  gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: false}, handleAuthResult);\n  return false;\n}\n\nfunction loadAnalyticsClient() {\n  // \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u60c5\u5831\u3092\u547c\u3073\u51fa\u3057\u3001 \u305d\u306e\u4e2d\u3067handleAuthorized\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3002\n  gapi.client.load('analytics', 'v3', handleAuthorized);\n}\n\n\n\nhello_analytics_api_v3.js\n// 'Get Sessions' \u30dc\u30bf\u30f3\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u305f\u3068\u304d\u306b\u5b9f\u884c\u3055\u308c\u308b\u95a2\u6570\nfunction makeApiCall() {\n  queryAccounts();\n}\n\nfunction queryAccounts() {\n  console.log('Querying Accounts.');\n\n  // \u8a8d\u8a3c\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u306b\u7d10\u4ed8\u3051\u3089\u308c\u305f\u5168\u3066\u306e\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u53d6\u5f97\n  gapi.client.analytics.management.accounts.list().execute(handleAccounts);\n}\n\nfunction handleAccounts(results) {\n  if (!results.code) {\n    if (results && results.items && results.items.length) {\n\n      // \u6700\u521d\u306b\u767b\u9332\u3055\u308c\u305f\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8id\u3092\u53d6\u5f97\n      var firstAccountId = results.items[0].id;\n\n      // \u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30a6\u30a7\u30d6\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\n      queryWebproperties(firstAccountId);\n\n    } else {\n      console.log('No accounts found for this user.')\n    }\n  } else {\n    console.log('There was an error querying accounts: ' + results.message);\n  }\n}\n\nfunction queryWebproperties(accountId) {\n  console.log('Querying Webproperties.');\n\n  // \u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u5168\u3066\u306e\u30a6\u30a7\u30d6\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u53d6\u5f97\u3059\u308b\n  gapi.client.analytics.management.webproperties.list({'accountId': accountId}).execute(handleWebproperties);\n}\n\nfunction handleWebproperties(results) {\n  if (!results.code) {\n    if (results && results.items && results.items.length) {\n\n      // \u6700\u521d\u306b\u767b\u9332\u3055\u308c\u305f\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8id\u3092\u53d6\u5f97\n      var firstAccountId = results.items[0].accountId;\n\n      // \u6700\u521d\u306e\u30a6\u30a7\u30d6\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u53d6\u5f97\n      var firstWebpropertyId = results.items[0].id;\n\n      // \u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u6700\u521d\u306e\u30d3\u30e5\u30fcid\u3092\u53d6\u5f97\n      queryProfiles(firstAccountId, firstWebpropertyId);\n\n    } else {\n      console.log('No webproperties found for this user.');\n    }\n  } else {\n    console.log('There was an error querying webproperties: ' + results.message);\n  }\n}\n\nfunction queryProfiles(accountId, webpropertyId) {\n  console.log('Querying Views (Profiles).');\n\n  // \u6700\u521d\u306e\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u7d10\u4ed8\u3051\u3089\u308c\u3066\u3044\u308b\u5168\u3066\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30ebid\u3092\u53d6\u5f97\n  gapi.client.analytics.management.profiles.list({\n      'accountId': accountId,\n      'webPropertyId': webpropertyId\n  }).execute(handleProfiles);\n}\n\nfunction handleProfiles(results) {\n  if (!results.code) {\n    if (results && results.items && results.items.length) {\n\n      // \u6700\u521d\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30ebid\u3092\u53d6\u5f97\n      var firstProfileId = results.items[0].id;\n\n      // Step 3. \u5b9f\u969b\u306e\u30ec\u30dd\u30fc\u30c8\u3092\u53d6\u5f97\u3059\u308b\n      queryCoreReportingApi(firstProfileId);\n\n    } else {\n      console.log('No views (profiles) found for this user.');\n    }\n  } else {\n    console.log('There was an error querying views (profiles): ' + results.message);\n  }\n}\n\nfunction queryCoreReportingApi(profileId) {\n  console.log('Querying Core Reporting API.');\n\n  //\u3000\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n  gapi.client.analytics.data.ga.get({\n    'ids': 'ga:' + profileId,\n    'start-date': '2012-03-03',\n    'end-date': '2012-03-03',\n    'metrics': 'ga:sessions'\n  }).execute(handleCoreReportingResults);\n}\n\nfunction handleCoreReportingResults(results) {\n  if (results.error) {\n    console.log('There was an error querying core reporting API: ' + results.message);\n  } else {\n    printResults(results);\n  }\n}\n\nfunction printResults(results) {\n  if (results.rows && results.rows.length) {\n    console.log('View (Profile) Name: ', results.profileInfo.profileName);\n    console.log('Total Sessions: ', results.rows[0][0]);\n  } else {\n    console.log('No results found');\n  }\n}\n\n\n\u6d41\u308c\u3068\u3057\u3066\u306f\u3001\n\nAuthorize\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u8a8d\u8a3c\u30c0\u30a4\u30a2\u30ed\u30b0\u3078\u9077\u79fb\n\u60c5\u5831\u5165\u529b\u3057\u3066\u30ed\u30b0\u30a4\u30f3\nGet Sessions\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u3092\u53d6\u5f97\u3001\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u306e\u89e3\u6790\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\n\n\u3068\u3044\u3063\u305f\u611f\u3058\u3067\u3059\u3002\n\u4eca\u56de\u306f\u3001\u81ea\u30b5\u30fc\u30d3\u30b9\u7528\u306b hello_analytics_api_v3.js\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u89e3\u6790\u30c7\u30fc\u30bf\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u65e2\u306bPerl\u3067\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\n1. \u30e6\u30fc\u30b6\u30fc\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u306e\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\n2. html\u4e0a\u306b\u30ea\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u3068\u3057\u3066\u8868\u793a\n\u4ee5\u4e0a\u3092\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n## \u95c7\u96f2\u306b\u8abf\u3079\u3066\u3082\u30a2\u30ec\u306a\u306e\u3067\u3002\u3002\n[\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9](https://developers.google.com/analytics/solutions/articles/hello-analytics-api?hl=ja#authorize_access)\u3092\u53c2\u7167\u3057\u3066\u52c9\u5f37\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u4f7f\u7528\u8a00\u8a9e\u306fJavaScript\u3067\u3044\u304d\u307e\u3059\u3002\n\n## \u524d\u63d0\u6761\u4ef6\n\u30fbGoogle\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9API\u3092\u4f7f\u3046\u305f\u3081\u306b\u3001client_id\u3068apiKey\u306e\u53d6\u5f97\u306b\u6210\u529f\u3057\u3066\u3044\u308b\u3002\n\u30fbjavascript_origin \u306e\u9805\u76ee\u306b\u306f\u3001\u52d5\u304b\u3059\u30b5\u30fc\u30d0\u306e\u30c9\u30e1\u30a4\u30f3\u306b\u5bfe\u5fdc\u3057\u305f\u5024\u304c\u5165\u3063\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n\u4f8b) html\u30d5\u30a1\u30a4\u30eb\u304cwww.example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30b5\u30fc\u30d0\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001\n**javascript_origin\u306e\u5024\u306f\u3001`http://www.example.com`\u3068\u306a\u308a\u307e\u3059\u3002**\n\n\n## \u69cb\u6210\u60c5\u5831\n\u5fc5\u8981\u306a\u306e\u306f\u4ee5\u4e0b\u306e\uff13\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\u30fbhello_analytics_api_v3.html \u2013 \u30dc\u30bf\u30f3\u8868\u793a\u306e\u305f\u3081\u306ehtml\u3067\u3059\u3002\n\u30fbhello_analytics_api_v3_auth.js \u2013 \u8a8d\u8a3c\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u4f7f\u3063\u3066\u3001google\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8a8d\u8a3c\u3092\u884c\u3046\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\u30fbhello_analytics_api_v3.js \u2013 \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9API\u306e\u8a8d\u8a3c\u3068\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c\u3001\u7d50\u679c\u306e\u8868\u793a\u3092\u884c\u3046\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u3059\u3002\n\n## \u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u8aac\u660e\n\n\u4ee5\u4e0b\u306b\u30bd\u30fc\u30b9\u3092\u793a\u3057\u307e\u3059\uff08\u82f1\u8a9e\u90e8\u5206\u306f\u62d9\u8a33\uff09\n\n```html:hello_analytics_api_v3.html\n<!DOCTYPE>\n<html>\n  <head>\n    <title>Hello Google Analytics API</title>\n  </head>\n  <body>\n    <!-- \u30e6\u30fc\u30b6\u306e\u5b9f\u884c\u30dc\u30bf\u30f3 -->\n    <button id=\"authorize-button\" style=\"visibility: hidden\">Authorize</button><br/>\n    <button id=\"make-api-call-button\" style=\"visibility: hidden\">Get Sessions</button>\n\n    <!-- \u3042\u3068\u3067\u4f5c\u6210\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0 -->\n    <script src=\"hello_analytics_api_v3_auth.js\"></script>\n    <script src=\"hello_analytics_api_v3.js\"></script>\n\n    <!-- html\u304c\u8aad\u307f\u8fbc\u307e\u308c\u305f\u3068\u304d\u306b\u3001\u6700\u521d\u306b\u5b9f\u884c\u3055\u308c\u308b\u95a2\u6570\u3092\u5b9a\u7fa9 -->\n    <script src=\"https://apis.google.com/js/client.js?onload=handleClientLoad\"></script>\n  </body>\n</html>\n```\n\n```js:hello_analytics_api_v3_auth.js\n// \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9API\u306e\u8a8d\u8a3c\u3092\u884c\u3046\u95a2\u6570\u3002\n\n// scopes\u4ee5\u5916\u306e\u5024\u306f\u3001\u5404\u81ea\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u3063\u3066\u5909\u3048\u3066\u304f\u3060\u3055\u3044\u3002\nvar clientId = \"\u5404\u81ea\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8id\";\nvar apiKey = \"\u5404\u81ea\u306eapiKey\";\nvar scopes = \"https://www.googleapis.com/auth/analytics.readonly\";\n\n// \u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u8aad\u307f\u8fbc\u307e\u308c\u305f\u3042\u3068\u3067\u3001\u6700\u521d\u306b\u547c\u3070\u308c\u308b\u95a2\u6570\n//\u3000\u4ee5\u4e0b\u3001\u547c\u3073\u51fa\u3059\u95a2\u6570\u306f\u95a2\u6570\u540d\u3092\u66f8\u3044\u305f\u6b21\u306e\u30bb\u30af\u30b7\u30e7\u30f3\uff08\u3000\u30d6\u30ec\u30fc\u30b9\u3067\u56f2\u307e\u308c\u305f\u90e8\u5206\u3000\uff09\u306b\u5b9a\u7fa9\u3057\u3066\u3044\u304f\nfunction handleClientLoad() {\n  // 1. API\u30ad\u30fc\u3092\u30bb\u30c3\u30c8\n  gapi.client.setApiKey(apiKey);\n\n  // 2. \u30e6\u30fc\u30b6\u8a8d\u8a3c\u306e\u78ba\u8a8d\n  window.setTimeout(checkAuth,1);\n}\n\nfunction checkAuth() {\n  // \u4eca\u306e\u30e6\u30fc\u30b6\u30fc\u306e\u8a8d\u8a3c\u72b6\u614b\u3092\u78ba\u8a8d\u3059\u308b\u305f\u3081\u3001\u30b0\u30fc\u30b0\u30eb\u30a2\u30ab\u30a6\u30f3\u30c8\u30b5\u30fc\u30d3\u30b9\u3092\u547c\u3073\u51fa\u3059\n  // handleAuthResult\u95a2\u6570\u3078\u3001\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u7d50\u679c\u3092\u8fd4\u5374\u3059\u308b\n  gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true}, handleAuthResult);\n}\n\nfunction handleAuthResult(authResult) {\n  if (authResult) {\n    // \u30e6\u30fc\u30b6\u30fc\u306e\u8a8d\u8a3c\u304c\u5b8c\u4e86\n    // \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u60c5\u5831\u3092\u8aad\u307f\u8fbc\u3080\n    loadAnalyticsClient();\n  } else {\n    // \u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u304c\u5931\u6557\n    handleUnAuthorized();\n  }\n}\n\n// \u8a8d\u8a3c\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\nfunction handleAuthorized() {\n  var authorizeButton = document.getElementById('authorize-button');\n  var makeApiCallButton = document.getElementById('make-api-call-button');\n\n// 'Get Sessions'\u30dc\u30bf\u30f3\u3092\u8868\u793a\u3057\u3001 'Authorize'\u30dc\u30bf\u30f3\u3092\u975e\u8868\u793a\n  makeApiCallButton.style.visibility = '';\n  authorizeButton.style.visibility = 'hidden';\n\n  // 'Get Sessions'\u30dc\u30bf\u30f3\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u305f\u5834\u5408\u3001makeAapiCall function\u3092\u5b9f\u884c\n  makeApiCallButton.onclick = makeApiCall;\n}\n\n// \u8a8d\u8a3c\u3055\u308c\u306a\u304b\u3063\u305f\u30e6\u30fc\u30b6\u30fc\nfunction handleUnAuthorized() {\n  var authorizeButton = document.getElementById('authorize-button');\n  var makeApiCallButton = document.getElementById('make-api-call-button');\n\n  // 'Authorize'\u30dc\u30bf\u30f3\u3092\u8868\u793a\u3057\u3001 'Get Sessions'\u30dc\u30bf\u30f3\u3092\u975e\u8868\u793a\n  makeApiCallButton.style.visibility = 'hidden';\n  authorizeButton.style.visibility = '';\n\n  // 'Authorize'\u30dc\u30bf\u30f3\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u305f\u5834\u5408\u3001handleAuthClick \u3092\u5b9f\u884c\n  authorizeButton.onclick = handleAuthClick;\n}\n\nfunction handleAuthClick(event) {\n  gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: false}, handleAuthResult);\n  return false;\n}\n\nfunction loadAnalyticsClient() {\n  // \u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u60c5\u5831\u3092\u547c\u3073\u51fa\u3057\u3001 \u305d\u306e\u4e2d\u3067handleAuthorized\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3002\n  gapi.client.load('analytics', 'v3', handleAuthorized);\n}\n```\n\n```js:hello_analytics_api_v3.js\n// 'Get Sessions' \u30dc\u30bf\u30f3\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u305f\u3068\u304d\u306b\u5b9f\u884c\u3055\u308c\u308b\u95a2\u6570\nfunction makeApiCall() {\n  queryAccounts();\n}\n\nfunction queryAccounts() {\n  console.log('Querying Accounts.');\n\n  // \u8a8d\u8a3c\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u306b\u7d10\u4ed8\u3051\u3089\u308c\u305f\u5168\u3066\u306e\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u53d6\u5f97\n  gapi.client.analytics.management.accounts.list().execute(handleAccounts);\n}\n\nfunction handleAccounts(results) {\n  if (!results.code) {\n    if (results && results.items && results.items.length) {\n\n      // \u6700\u521d\u306b\u767b\u9332\u3055\u308c\u305f\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8id\u3092\u53d6\u5f97\n      var firstAccountId = results.items[0].id;\n\n      // \u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u30a6\u30a7\u30d6\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\n      queryWebproperties(firstAccountId);\n\n    } else {\n      console.log('No accounts found for this user.')\n    }\n  } else {\n    console.log('There was an error querying accounts: ' + results.message);\n  }\n}\n\nfunction queryWebproperties(accountId) {\n  console.log('Querying Webproperties.');\n\n  // \u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u5168\u3066\u306e\u30a6\u30a7\u30d6\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u53d6\u5f97\u3059\u308b\n  gapi.client.analytics.management.webproperties.list({'accountId': accountId}).execute(handleWebproperties);\n}\n\nfunction handleWebproperties(results) {\n  if (!results.code) {\n    if (results && results.items && results.items.length) {\n\n      // \u6700\u521d\u306b\u767b\u9332\u3055\u308c\u305f\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8id\u3092\u53d6\u5f97\n      var firstAccountId = results.items[0].accountId;\n\n      // \u6700\u521d\u306e\u30a6\u30a7\u30d6\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u53d6\u5f97\n      var firstWebpropertyId = results.items[0].id;\n\n      // \u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u6700\u521d\u306e\u30d3\u30e5\u30fcid\u3092\u53d6\u5f97\n      queryProfiles(firstAccountId, firstWebpropertyId);\n\n    } else {\n      console.log('No webproperties found for this user.');\n    }\n  } else {\n    console.log('There was an error querying webproperties: ' + results.message);\n  }\n}\n\nfunction queryProfiles(accountId, webpropertyId) {\n  console.log('Querying Views (Profiles).');\n\n  // \u6700\u521d\u306e\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u7d10\u4ed8\u3051\u3089\u308c\u3066\u3044\u308b\u5168\u3066\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30ebid\u3092\u53d6\u5f97\n  gapi.client.analytics.management.profiles.list({\n      'accountId': accountId,\n      'webPropertyId': webpropertyId\n  }).execute(handleProfiles);\n}\n\nfunction handleProfiles(results) {\n  if (!results.code) {\n    if (results && results.items && results.items.length) {\n\n      // \u6700\u521d\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30ebid\u3092\u53d6\u5f97\n      var firstProfileId = results.items[0].id;\n\n      // Step 3. \u5b9f\u969b\u306e\u30ec\u30dd\u30fc\u30c8\u3092\u53d6\u5f97\u3059\u308b\n      queryCoreReportingApi(firstProfileId);\n\n    } else {\n      console.log('No views (profiles) found for this user.');\n    }\n  } else {\n    console.log('There was an error querying views (profiles): ' + results.message);\n  }\n}\n\nfunction queryCoreReportingApi(profileId) {\n  console.log('Querying Core Reporting API.');\n\n  //\u3000\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n  gapi.client.analytics.data.ga.get({\n    'ids': 'ga:' + profileId,\n    'start-date': '2012-03-03',\n    'end-date': '2012-03-03',\n    'metrics': 'ga:sessions'\n  }).execute(handleCoreReportingResults);\n}\n\nfunction handleCoreReportingResults(results) {\n  if (results.error) {\n    console.log('There was an error querying core reporting API: ' + results.message);\n  } else {\n    printResults(results);\n  }\n}\n\nfunction printResults(results) {\n  if (results.rows && results.rows.length) {\n    console.log('View (Profile) Name: ', results.profileInfo.profileName);\n    console.log('Total Sessions: ', results.rows[0][0]);\n  } else {\n    console.log('No results found');\n  }\n}\n```\n\n\u6d41\u308c\u3068\u3057\u3066\u306f\u3001\n\n1. Authorize\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u8a8d\u8a3c\u30c0\u30a4\u30a2\u30ed\u30b0\u3078\u9077\u79fb\n2. \u60c5\u5831\u5165\u529b\u3057\u3066\u30ed\u30b0\u30a4\u30f3\n3. Get Sessions\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u3092\u53d6\u5f97\u3001\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u306e\u89e3\u6790\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\n\n\u3068\u3044\u3063\u305f\u611f\u3058\u3067\u3059\u3002\n\n\u4eca\u56de\u306f\u3001\u81ea\u30b5\u30fc\u30d3\u30b9\u7528\u306b **hello_analytics_api_v3.js\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u3066\u3044\u304d\u307e\u3059\u3002**\n\n\u89e3\u6790\u30c7\u30fc\u30bf\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\u306f\u65e2\u306bPerl\u3067\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\n1. \u30e6\u30fc\u30b6\u30fc\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u306e\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\n2. html\u4e0a\u306b\u30ea\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u3068\u3057\u3066\u8868\u793a\n\n\u4ee5\u4e0a\u3092\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\n\n\n\n\n\n\n\n", "tags": ["\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30c4\u30fc\u30eb", "GoogleAnalytics", "JavaScript"]}