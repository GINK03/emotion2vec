{"context": " More than 1 year has passed since last update.\n\n\u3069\u30fc\u8a00\u3046\u3053\u3068\u304b\nSQLite\u306b\u304a\u3044\u3066\u3001\u305f\u3068\u3048\u3070\nsqlite3:partial.sql\nId INTEGER PRIMARY KEY AUTOINCREMENT\n\n\u3068\u8a00\u3046\u5b9a\u7fa9\u3092\u884c\u3046\u3068\u3001\u3042\u3093\u307e\u308a\u52b9\u7387\u304c\u3088\u308d\u3057\u304f\u306a\u3044\u3068\u3044\u3046\u304a\u8a71\u3002\n\n\u65e9\u901f\u8a66\u3057\u3066\u307f\u305f\n\n\u4f7f\u7528\u3057\u305f\u74b0\u5883\n1\uff0eC# 5.0\n1\uff0eDapper\u30001.38.0.0\n1\uff0eSystem.Data.SQLite\u30001.0.94.0\n\n\u30c6\u30fc\u30d6\u30eb\u30b9\u30ad\u30fc\u30de\n\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\nAUTOINCREMENT\u6307\u5b9a\u3057\u305fPrimary key\u3092\u5229\u7528\u3057\u305f\u30c6\u30fc\u30d6\u30eb\n\nAutoincrementTable.sql\nCREATE TABLE AutoincrementTable (\n    Id    INTEGER PRIMARY KEY AUTOINCREMENT,\n    Value INTEGER NOT NULL\n);\n\n\n\nAUTOINCREMENT\u6307\u5b9a\u3057\u3066\u306a\u3044Primary Key\u3092\u5229\u7528\u3057\u305f\u30c6\u30fc\u30d6\u30eb\n\nRowIdTable.sql\nCREATE TABLE RowIdTable (\n    Id    INTEGER PRIMARY KEY,\n    Value INTEGER NOT NULL\n);\n\n\n\n\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u8a08\u6e2c\u306b\u7528\u3044\u305f\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\n\nTestBench.cs\nusing System;\nusing System.Data;\nusing System.Data.SQLite;\nusing System.Diagnostics;\nusing System.Linq;\nusing Dapper;\n\nnamespace ConsoleApplication2\n{\n    internal class Program\n    {\n        private const int InsertCount = 1000000;\n        private const string FileName = \"Test.db3\";\n\n        private static void Main(string[] args)\n        {\n            CreateDataBase(FileName);\n            AutoincrementTable();\n            Console.WriteLine();\n            RowIdTable();\n        }\n\n        private static void AutoincrementTable()\n        {\n            Stopwatch chronograph = new Stopwatch();\n\n            using (SQLiteConnection conn = CreateConnection(FileName))\n            {\n                GcFullCollect();\n\n                chronograph.Start();\n                using (SQLiteTransaction tran = conn.BeginTransaction())\n                {\n                    conn.Execute(\"INSERT INTO AutoIncrementTable(Value) VALUES(@value)\",\n                        Enumerable.Range(0, InsertCount).Select(x => new {Value = x}), tran);\n                    tran.Commit();\n                }\n                chronograph.Stop();\n            }\n\n            Console.WriteLine(\"Autoincrement case:\" + chronograph.Elapsed);\n        }\n\n        private static void RowIdTable()\n        {\n            Stopwatch chronograph = new Stopwatch();\n\n            using (SQLiteConnection conn = CreateConnection(FileName))\n            {\n                GcFullCollect();\n\n                chronograph.Start();\n                using (SQLiteTransaction tran = conn.BeginTransaction())\n                {\n                    conn.Execute(\"INSERT INTO RowIdTable(Value) VALUES(@value)\",\n                        Enumerable.Range(0, InsertCount).Select(x => new {Value = x}), tran);\n                    tran.Commit();\n                }\n                chronograph.Stop();\n            }\n\n            Console.WriteLine(\"RowId case:\" + chronograph.Elapsed);\n        }\n\n\n        private static SQLiteConnection CreateConnection(string fileName)\n        {\n            SQLiteConnectionStringBuilder bld = new SQLiteConnectionStringBuilder\n            {\n                DataSource = fileName,\n                DefaultIsolationLevel = IsolationLevel.ReadCommitted\n            };\n\n            SQLiteConnection ret = new SQLiteConnection(bld.ToString());\n            ret.Open();\n\n            return ret;\n        }\n\n        private static void GcFullCollect()\n        {\n            GC.Collect();\n            GC.WaitForPendingFinalizers();\n            GC.Collect();\n        }\n\n        private static void CreateDataBase(string filePath)\n        {\n            SQLiteConnectionStringBuilder bld = new SQLiteConnectionStringBuilder\n            {\n                DataSource = filePath,\n                DefaultIsolationLevel = IsolationLevel.ReadCommitted\n            };\n\n            SQLiteConnection.CreateFile(filePath);\n\n            using (SQLiteConnection conn = new SQLiteConnection(bld.ToString()))\n            {\n                conn.Execute(\"CREATE TABLE AutoIncrementTable(\" +\n                             \"Id INTEGER PRIMARY KEY AUTOINCREMENT,\" +\n                             \"Value INTEGER NOT NULL);\");\n\n                conn.Execute(\"CREATE TABLE RowIdTable(\" +\n                             \"Id INTEGER PRIMARY KEY,\" +\n                             \"Value INTEGER NOT NULL);\");\n            }\n        }\n    }\n}\n\n\n\n\u7d50\u679c\n\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3092\u3001\n1.AnyCpu\n1.Release build\n1.\u30c7\u30d0\u30c3\u30ac\u30a2\u30bf\u30c3\u30c1\u7121\u3057\n\u4f3c\u3066\u5b9f\u884c\u3057\u305f\u3068\u3053\u308d\u3001\u4ee5\u4e0b\u306e\u7d50\u679c\u3068\u306a\u3063\u305f\u3002\n\nAutoincrement\u3092\u4f7f\u3063\u305f\u5834\u5408\uff1a04.7823556Sec\nAutoincrement\u3092\u4f7f\u308f\u306a\u304b\u3063\u305f\u5834\u5408\uff1a03.6289869Sec\n\n\u5dee\u306f\u3055\u3057\u3066\u5927\u304d\u304f\u306f\u306a\u3044\u306b\u3057\u308d\u3001\u6709\u610f\u306a\u5dee\u306f\u3064\u3044\u305f\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u307e\u3068\u3081\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3080\u3068\u3001\n\nThe AUTOINCREMENT keyword imposes extra CPU, memory, disk space, and disk I/O overhead and should be avoided if not strictly needed. It is usually not needed.\n\n\u3068\u3042\u308b\u306e\u3067\u3001\u5fc5\u8981\u3067\u7121\u3044\u9650\u308a\u306f\u4f7f\u3046\u3079\u304d\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\n\nOn an INSERT, if the ROWID or INTEGER PRIMARY KEY column is not explicitly given a value, then it will be filled automatically with an unused integer, usually the one more than the largest ROWID currently in use. This is true regardless of whether or not the AUTOINCREMENT keyword is used.\n\n\u3053\u306e\u3088\u3046\u306a\u8a18\u8f09\u304c\u3042\u308b\u306e\u3067\u3001Autoincrement\u3092\u4ed8\u4e0e\u3057\u306a\u304f\u3068\u3082\u3001\u5148\u307b\u3069\u306e\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306b\u3001\u81ea\u52d5\u7684\u306b\u4ed8\u756a\u3059\u308b\u3053\u3068\u306f\u4fdd\u8a3c\u3055\u308c\u3066\u3044\u307e\u3059\u304b\u3089\u3001DBMS\u30b5\u30a4\u30c9\u3067\u4ed8\u756a\u3057\u305f\u3044\u3060\u3051\u3067\u3042\u308c\u3070\u3001AUTOINCREMENT\u3092\u660e\u8a18\u3059\u308b\u5fc5\u8981\u306f\u7121\u3044\u3068\u8a00\u3048\u308b\u3067\u3057\u3087\u3046\u3002\n\u305d\u308c\u3067\u306f\u3001AUTOINCREMENT\u306e\u6709\u7121\u3067\u4f55\u304c\u5909\u308f\u308b\u304b\u3068\u3044\u3046\u3068\u3001AUTOINCREMENT\u304c\u3064\u3044\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u305f\u3068\u3048\u3070DELETE\u3055\u308c\u305f\u30ec\u30b3\u30fc\u30c9\u306eId\u3092\u518d\u5229\u7528\u3057\u307e\u3059\u304c\u3001AUTOINCREMENT\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u4efb\u610f\u306e\u30c6\u30fc\u30d6\u30eb\u3067\u4e00\u5ea6\u5229\u7528\u3055\u308c\u305f\u756a\u53f7\u3092\u3001\u5f53\u8a72\u30c6\u30fc\u30d6\u30eb\u306e\u65b0\u3057\u3044\u30ec\u30b3\u30fc\u30c9\u306eId\u3068\u3057\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30e9\u30a4\u30d5\u30bf\u30a4\u30e0\u306b\u6e21\u3063\u3066\u518d\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u306a\u3044\u3068\u8a00\u3046\u5dee\u304c\u3042\u308a\u307e\u3059\u3002\n\u3082\u3057\u3001\u3053\u306e\u3088\u3046\u306b\u3001\u4e00\u5ea6\u5229\u7528\u3057\u305fId\u3092\u78ba\u5b9f\u306b\u518d\u5229\u7528\u3057\u306a\u3044\u3053\u3068\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001AUTOINCREMENT\u306f\u6709\u52b9\u3067\u3059\u304c\u3001\u305d\u308c\u4ee5\u5916\u306e\u5834\u5408\u3001\u610f\u56f3\u7684\u306b\u4f7f\u3046\u5fc5\u8981\u306f\u7121\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u3068\u3057\u305f\u30da\u30fc\u30b8\nAutoincrement In SQLite\n#\u3069\u30fc\u8a00\u3046\u3053\u3068\u304b\n\nSQLite\u306b\u304a\u3044\u3066\u3001\u305f\u3068\u3048\u3070\n```sqlite3:partial.sql\nId INTEGER PRIMARY KEY AUTOINCREMENT\n```\n\u3068\u8a00\u3046\u5b9a\u7fa9\u3092\u884c\u3046\u3068\u3001\u3042\u3093\u307e\u308a\u52b9\u7387\u304c\u3088\u308d\u3057\u304f\u306a\u3044\u3068\u3044\u3046\u304a\u8a71\u3002\n\n#\u65e9\u901f\u8a66\u3057\u3066\u307f\u305f\n##\u4f7f\u7528\u3057\u305f\u74b0\u5883\n1\uff0eC# 5.0\n1\uff0eDapper\u30001.38.0.0\n1\uff0eSystem.Data.SQLite\u30001.0.94.0\n\n##\u30c6\u30fc\u30d6\u30eb\u30b9\u30ad\u30fc\u30de\n\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n###AUTOINCREMENT\u6307\u5b9a\u3057\u305fPrimary key\u3092\u5229\u7528\u3057\u305f\u30c6\u30fc\u30d6\u30eb\n```sqlite3:AutoincrementTable.sql\nCREATE TABLE AutoincrementTable (\n    Id    INTEGER PRIMARY KEY AUTOINCREMENT,\n    Value INTEGER NOT NULL\n);\n```\n\n###AUTOINCREMENT\u6307\u5b9a\u3057\u3066\u306a\u3044Primary Key\u3092\u5229\u7528\u3057\u305f\u30c6\u30fc\u30d6\u30eb\n```sqlite3:RowIdTable.sql\nCREATE TABLE RowIdTable (\n    Id    INTEGER PRIMARY KEY,\n    Value INTEGER NOT NULL\n);\n```\n\n##\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u8a08\u6e2c\u306b\u7528\u3044\u305f\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\n\n```csharp:TestBench.cs\nusing System;\nusing System.Data;\nusing System.Data.SQLite;\nusing System.Diagnostics;\nusing System.Linq;\nusing Dapper;\n\nnamespace ConsoleApplication2\n{\n\tinternal class Program\n\t{\n\t\tprivate const int InsertCount = 1000000;\n\t\tprivate const string FileName = \"Test.db3\";\n\n\t\tprivate static void Main(string[] args)\n\t\t{\n\t\t\tCreateDataBase(FileName);\n\t\t\tAutoincrementTable();\n\t\t\tConsole.WriteLine();\n\t\t\tRowIdTable();\n\t\t}\n\n\t\tprivate static void AutoincrementTable()\n\t\t{\n\t\t\tStopwatch chronograph = new Stopwatch();\n\n\t\t\tusing (SQLiteConnection conn = CreateConnection(FileName))\n\t\t\t{\n\t\t\t\tGcFullCollect();\n\n\t\t\t\tchronograph.Start();\n\t\t\t\tusing (SQLiteTransaction tran = conn.BeginTransaction())\n\t\t\t\t{\n\t\t\t\t\tconn.Execute(\"INSERT INTO AutoIncrementTable(Value) VALUES(@value)\",\n\t\t\t\t\t\tEnumerable.Range(0, InsertCount).Select(x => new {Value = x}), tran);\n\t\t\t\t\ttran.Commit();\n\t\t\t\t}\n\t\t\t\tchronograph.Stop();\n\t\t\t}\n\n\t\t\tConsole.WriteLine(\"Autoincrement case:\" + chronograph.Elapsed);\n\t\t}\n\n\t\tprivate static void RowIdTable()\n\t\t{\n\t\t\tStopwatch chronograph = new Stopwatch();\n\n\t\t\tusing (SQLiteConnection conn = CreateConnection(FileName))\n\t\t\t{\n\t\t\t\tGcFullCollect();\n\n\t\t\t\tchronograph.Start();\n\t\t\t\tusing (SQLiteTransaction tran = conn.BeginTransaction())\n\t\t\t\t{\n\t\t\t\t\tconn.Execute(\"INSERT INTO RowIdTable(Value) VALUES(@value)\",\n\t\t\t\t\t\tEnumerable.Range(0, InsertCount).Select(x => new {Value = x}), tran);\n\t\t\t\t\ttran.Commit();\n\t\t\t\t}\n\t\t\t\tchronograph.Stop();\n\t\t\t}\n\n\t\t\tConsole.WriteLine(\"RowId case:\" + chronograph.Elapsed);\n\t\t}\n\n\n\t\tprivate static SQLiteConnection CreateConnection(string fileName)\n\t\t{\n\t\t\tSQLiteConnectionStringBuilder bld = new SQLiteConnectionStringBuilder\n\t\t\t{\n\t\t\t\tDataSource = fileName,\n\t\t\t\tDefaultIsolationLevel = IsolationLevel.ReadCommitted\n\t\t\t};\n\n\t\t\tSQLiteConnection ret = new SQLiteConnection(bld.ToString());\n\t\t\tret.Open();\n\n\t\t\treturn ret;\n\t\t}\n\n\t\tprivate static void GcFullCollect()\n\t\t{\n\t\t\tGC.Collect();\n\t\t\tGC.WaitForPendingFinalizers();\n\t\t\tGC.Collect();\n\t\t}\n\n\t\tprivate static void CreateDataBase(string filePath)\n\t\t{\n\t\t\tSQLiteConnectionStringBuilder bld = new SQLiteConnectionStringBuilder\n\t\t\t{\n\t\t\t\tDataSource = filePath,\n\t\t\t\tDefaultIsolationLevel = IsolationLevel.ReadCommitted\n\t\t\t};\n\n\t\t\tSQLiteConnection.CreateFile(filePath);\n\n\t\t\tusing (SQLiteConnection conn = new SQLiteConnection(bld.ToString()))\n\t\t\t{\n\t\t\t\tconn.Execute(\"CREATE TABLE AutoIncrementTable(\" +\n\t\t\t\t             \"Id INTEGER PRIMARY KEY AUTOINCREMENT,\" +\n\t\t\t\t             \"Value INTEGER NOT NULL);\");\n\n\t\t\t\tconn.Execute(\"CREATE TABLE RowIdTable(\" +\n\t\t\t\t             \"Id INTEGER PRIMARY KEY,\" +\n\t\t\t\t             \"Value INTEGER NOT NULL);\");\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n###\u7d50\u679c\n\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3092\u3001\n1.AnyCpu\n1.Release build\n1.\u30c7\u30d0\u30c3\u30ac\u30a2\u30bf\u30c3\u30c1\u7121\u3057\n\u4f3c\u3066\u5b9f\u884c\u3057\u305f\u3068\u3053\u308d\u3001\u4ee5\u4e0b\u306e\u7d50\u679c\u3068\u306a\u3063\u305f\u3002\n\n* Autoincrement\u3092\u4f7f\u3063\u305f\u5834\u5408\uff1a04.7823556Sec\n* Autoincrement\u3092\u4f7f\u308f\u306a\u304b\u3063\u305f\u5834\u5408\uff1a03.6289869Sec\n\n\u5dee\u306f\u3055\u3057\u3066\u5927\u304d\u304f\u306f\u306a\u3044\u306b\u3057\u308d\u3001\u6709\u610f\u306a\u5dee\u306f\u3064\u3044\u305f\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n##\u307e\u3068\u3081\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3080\u3068\u3001\n> The AUTOINCREMENT keyword imposes extra CPU, memory, disk space, and disk I/O overhead and should be avoided if not strictly needed. It is usually not needed.\n\n\u3068\u3042\u308b\u306e\u3067\u3001\u5fc5\u8981\u3067\u7121\u3044\u9650\u308a\u306f\u4f7f\u3046\u3079\u304d\u3058\u3083\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u307e\u305f\u3001\n> On an INSERT, if the ROWID or INTEGER PRIMARY KEY column is not explicitly given a value, then it will be filled automatically with an unused integer, usually the one more than the largest ROWID currently in use. This is true regardless of whether or not the AUTOINCREMENT keyword is used.\n\n\u3053\u306e\u3088\u3046\u306a\u8a18\u8f09\u304c\u3042\u308b\u306e\u3067\u3001Autoincrement\u3092\u4ed8\u4e0e\u3057\u306a\u304f\u3068\u3082\u3001\u5148\u307b\u3069\u306e\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306b\u3001\u81ea\u52d5\u7684\u306b\u4ed8\u756a\u3059\u308b\u3053\u3068\u306f\u4fdd\u8a3c\u3055\u308c\u3066\u3044\u307e\u3059\u304b\u3089\u3001DBMS\u30b5\u30a4\u30c9\u3067\u4ed8\u756a\u3057\u305f\u3044\u3060\u3051\u3067\u3042\u308c\u3070\u3001AUTOINCREMENT\u3092\u660e\u8a18\u3059\u308b\u5fc5\u8981\u306f\u7121\u3044\u3068\u8a00\u3048\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u305d\u308c\u3067\u306f\u3001AUTOINCREMENT\u306e\u6709\u7121\u3067\u4f55\u304c\u5909\u308f\u308b\u304b\u3068\u3044\u3046\u3068\u3001AUTOINCREMENT\u304c\u3064\u3044\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u305f\u3068\u3048\u3070DELETE\u3055\u308c\u305f\u30ec\u30b3\u30fc\u30c9\u306eId\u3092\u518d\u5229\u7528\u3057\u307e\u3059\u304c\u3001**AUTOINCREMENT\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u4efb\u610f\u306e\u30c6\u30fc\u30d6\u30eb\u3067\u4e00\u5ea6\u5229\u7528\u3055\u308c\u305f\u756a\u53f7\u3092\u3001\u5f53\u8a72\u30c6\u30fc\u30d6\u30eb\u306e\u65b0\u3057\u3044\u30ec\u30b3\u30fc\u30c9\u306eId\u3068\u3057\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30e9\u30a4\u30d5\u30bf\u30a4\u30e0\u306b\u6e21\u3063\u3066\u518d\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u306a\u3044**\u3068\u8a00\u3046\u5dee\u304c\u3042\u308a\u307e\u3059\u3002\n\u3082\u3057\u3001\u3053\u306e\u3088\u3046\u306b\u3001\u4e00\u5ea6\u5229\u7528\u3057\u305fId\u3092\u78ba\u5b9f\u306b\u518d\u5229\u7528\u3057\u306a\u3044\u3053\u3068\u304c\u5fc5\u8981\u306a\u5834\u5408\u306f\u3001AUTOINCREMENT\u306f\u6709\u52b9\u3067\u3059\u304c\u3001\u305d\u308c\u4ee5\u5916\u306e\u5834\u5408\u3001\u610f\u56f3\u7684\u306b\u4f7f\u3046\u5fc5\u8981\u306f\u7121\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n####\u53c2\u8003\u3068\u3057\u305f\u30da\u30fc\u30b8\n[Autoincrement In SQLite](https://www.sqlite.org/autoinc.html)\n", "tags": ["SQLite3", "C#"]}