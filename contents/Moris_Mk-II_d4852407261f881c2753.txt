{"context": "NCMB\u306e\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u5b9f\u88c5\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u50d5\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u7d4c\u9a13\u304c\u6d45\u3044\u306e\u3068\u516c\u5f0f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u60c5\u5831\u91cf\u304c\u5982\u4f55\u305b\u3093\u5c11\u306a\u304b\u3063\u305f\u305f\u3081\u3001\u7d50\u69cb\u30cf\u30de\u308a\u307e\u3057\u305f\u3002\u5099\u5fd8\u9332\u3068\u3057\u3066\u4ee5\u4e0b\u306b\u30cf\u30de\u3063\u305f\u70b9\u3092\u3056\u3063\u304f\u308a\u6319\u3052\u307e\u3059\u3002\u5c0e\u5165\u624b\u9806\u306f\u30ea\u30f3\u30af\u3092\u8f09\u305b\u308b\u306e\u3067\u3001\u57fa\u672c\u7684\u306b\u305d\u3053\u304b\u3089\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5c0e\u5165\n\u4eca\u56de\u306fNCMB\u306e\u5c0e\u5165\u306f\u6e08\u3093\u3067\u3044\u308b\u3082\u306e\u3068\u3057\u3066\u3001\u30d7\u30c3\u30b7\u30e5\u6a5f\u80fd\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3060\u3051\u8a18\u8ff0\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002NCMB\u81ea\u4f53\u306e\u5c0e\u5165\u65b9\u6cd5\u306f\u516c\u5f0f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nFirebase\u3068\u306e\u9023\u643a\n\u65b0\u898f\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\u5834\u5408\u306fGCM(GoogleCloudMessaging)\u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u308bFCM(FirebaseCloudMessaging)\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002Firebase\u5c0e\u5165\u624b\u9806\u306f\u3001\n1. Firebase Console\u306b\u3066\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u767b\u9332\n2. Firebase\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n3. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306bimport\n\u3068\u3044\u3046\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306fgoogle_service.json\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u306b\u306a\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u683c\u7d0d\u4f4d\u7f6e\u306fapp/\u76f4\u4e0b\u3067\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u683c\u7d0d\u3057\u305f\u5f8c\u306fbuild.gradle(Project)\u306eclasspath\u3067\u6307\u5b9a\u3057\u3066\u3042\u3052\u307e\u3057\u3087\u3046\u3002\n-\u968e\u5c64\n\n-build.gradle(Project)\n\nbuild.gradle\u3067Firebase\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u305b\u308b\u306e\u3067\u3059\u304c\u3001play-services\u3068firebase\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u5408\u308f\u305b\u306a\u3044\u3068\u30a8\u30e9\u30fc\u3092\u5410\u304d\u307e\u3059\u3002\n\n\u3053\u308c\u3067Firebase\u306e\u5c0e\u5165\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n\nManifest\u306e\u5b9a\u7fa9\n\u6b21\u306b\u3001\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b\u305f\u3081\u306bManifest\u3092\u7de8\u96c6\u3057\u307e\u3057\u3087\u3046\u3002\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306b\u5bfe\u3059\u308b\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3068meta\u60c5\u5831\u306e\u8ffd\u52a0\u3001\u30ec\u30b7\u30fc\u30d0\u30fc\u3068\u30b5\u30fc\u30d3\u30b9\u306e\u6307\u5b9a\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u3056\u3063\u304f\u308a\u3057\u304b\u6319\u3052\u306a\u3044\u306e\u3067\u8a73\u7d30\u306f\u516c\u5f0f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb(Push\u901a\u77e5)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nAndroidManifest.xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\">\n\n    <uses-permission android:name=\"android.permission.INTERNET\" />\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />\n    <uses-permission android:name=\"android.permission.GET_ACCOUNTS\" />\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\n    <uses-permission android:name=\"android.permission.VIBRATE\" />\n    <uses-permission android:name=\"com.google.android.c2dm.permission.RECEIVE\" />\n    <permission\n        android:name=\"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8.permission.C2D_MESSAGE\"\n        android:protectionLevel=\"signature\" />\n    <uses-permission android:name=\"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8.permission.C2D_MESSAGE\" />\n\n    <application\n        android:name=\"com.nifty.cloud.mb.core.NCMBApplicationController\"\n        android:allowBackup=\"true\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.AppCompat.Light.DarkActionBar\">\n\n        <!-- \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u30bf\u30c3\u30d7\u6642\u306b\u8d77\u52d5\u3059\u308bActivity\u306e\u8a2d\u5b9a(\u5fc5\u9808) -->\n        <meta-data android:name=\"openPushStartActivity\" android:value=\"\u4efb\u610f\u306eActivity\"/>\n        <!-- \u901a\u77e5\u30a8\u30ea\u30a2\u306b\u8868\u793a\u3055\u308c\u308b\u30a2\u30a4\u30b3\u30f3\u306e\u8a2d\u5b9a(option) -->\n        <meta-data android:name=\"smallIcon\" android:resource=\"\u4efb\u610f\u306e\u753b\u50cf\u30c7\u30fc\u30bf\"/>\n        <!-- \u901a\u77e5\u30a8\u30ea\u30a2\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u8907\u6570\u8868\u793a\u3059\u308b\u8a2d\u5b9a\u30000:\u6700\u65b0\u306e\u307f\u8868\u793a , 1:\u8907\u6570\u8868\u793a(option) -->\n        <meta-data android:name=\"notificationOverlap\" android:value=\"1\"/>\n\n        <!--PushNotificationReceiver-->\n        <receiver\n            android:name=\"com.nifty.cloud.mb.core.NCMBGcmReceiver\"\n            android:exported=\"true\"\n            android:permission=\"com.google.android.c2dm.permission.SEND\">\n            <intent-filter>\n                <action android:name=\"com.google.android.c2dm.intent.RECEIVE\"/>\n                <category android:name=\"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\"/>\n            </intent-filter>\n        </receiver>\n        <!--PushNotificationService-->\n        <service\n            android:name=\"com.nifty.cloud.mb.core.NCMBGcmListenerService\"\n            android:exported=\"false\">\n            <intent-filter>\n                <action android:name=\"com.google.android.c2dm.intent.RECEIVE\"/>\n            </intent-filter>\n        </service>\n\n        <activity\n            android:name=\".PushTestActivity\"\n            android:label=\"@string/app_name\">\n        </activity>\n    </application>\n</manifest>\n\n\n\n\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\n\nFirebase\u9023\u643a\u306e\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\u306b\u6319\u3052\u3066\u3044\u308b\u306e\u3067\u5927\u4e08\u592b\u3060\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u6307\u5b9a\u3057\u3066\u3044\u308b\u30ec\u30b7\u30fc\u30d0\u30fc\u3068\u30b5\u30fc\u30d3\u30b9\u306fplay-services\u5185\u306e\u30af\u30e9\u30b9\u3092\u7d99\u627f\u3057\u3066\u3044\u308b\u306e\u3067\u3001build.gradle\u3067\u304d\u3061\u3093\u3068play-services\u3082\u3057\u304f\u306fplay-services-gcm\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u3044\u306a\u3044\u3068\u52d5\u4f5c\u3057\u3066\u304f\u308c\u307e\u305b\u3093\u3002\u50d5\u306f\u3053\u3053\u3067\u304b\u306a\u308a\u30cf\u30de\u308a\u307e\u3057\u305f\u3002\n\n\n\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\n\u30b3\u30fc\u30c9\u3067\u306fFCM\u306b\u7aef\u672b\u306eID\u3092\u767b\u9332\u3059\u308c\u3070\u3044\u3044\u3060\u3051\u3067\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306e\u307b\u307c\u4e38\u5199\u3057\u3067\u3059\u3002SENDER ID\u306fFCM\u9023\u643a\u306b\u5fc5\u8981\u306a\u8a2d\u5b9a\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nPushTestActivity.java\npublic class PushTestActivity extends Activity {\n\n    //NCMB DB\u306eappKey\u3068clientKey\n    private final static String APP_KEY = \"API KEY\";\n    private final static String CLIENT_KEY = \"CLIENT KEY\";\n    //Firebase senderID\n    private final static String SENDER_ID = \"SENDER ID\";\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_push_test);\n\n        //NCMB\u306e\u521d\u671f\u5316\n        NCMB.initialize(this.getApplicationContext(), APP_KEY, CLIENT_KEY);\n\n        //FCM\u306b\u7aef\u672bID\u3092\u767b\u9332\n        final NCMBInstallation installation = NCMBInstallation.getCurrentInstallation();\n        installation.getRegistrationIdInBackground(SENDER_ID, new DoneCallback() {\n            @Override\n            public void done(NCMBException e) {\n                if (e == null) {\n                    installation.saveInBackground(new DoneCallback() {\n                        @Override\n                        public void done(NCMBException e) {\n                            if (e == null) {\n                                //\u4fdd\u5b58\u6210\u529f\n                                Log.d(CLASS_TAG, \"\u767b\u9332\u6210\u529f\");\n                            } else if (NCMBException.DUPLICATE_VALUE.equals(e.getCode())) {\n                                updateInstallation(installation);\n                            } else {\n                                Log.d(CLASS_TAG, \"\u4fdd\u5b58\u5931\u6557\");\n                            }\n                        }\n                    });\n                } else {\n                    Log.d(CLASS_TAG, \"\u53d6\u5f97\u5931\u6557\");\n                }\n            }\n        });\n    }\n\n    public static void updateInstallation(final NCMBInstallation installation) {\n        NCMBQuery<NCMBInstallation> query = NCMBInstallation.getQuery();\n        query.whereEqualTo(\"deviceToken\", installation.getDeviceToken());\n        query.findInBackground(new FindCallback<NCMBInstallation>() {\n            @Override\n            public void done(List<NCMBInstallation> list, NCMBException e) {\n                installation.setObjectId(list.get(0).getObjectId());\n                installation.saveInBackground();\n            }\n        });\n    }\n}\n\n\nDB\u4e0a\u306eInstallation\u30af\u30e9\u30b9\u306b\u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u305f\u3089\u3001\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u4e0a\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u9001\u4fe1\u3092\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u591a\u5206\u5c4a\u304f\u306f\u305a\u3067\u3059\u3002\u9001\u4fe1\u65b9\u6cd5\u306f\u516c\u5f0f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb(Push\u901a\u77e5)\u306e\u4e0b\u306e\u65b9\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\n\u307e\u3068\u3081\nFirebase\u3068\u9023\u643a\u3057\u3066NCMB PushNotification\u3092\u5b9f\u88c5\u3059\u308b\u6587\u732e\u306f\u898b\u5f53\u305f\u3089\u306a\u304b\u3063\u305f\u306e\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f\u3002\u5168\u90e8\u8aac\u660e\u3059\u308b\u3068\u9577\u304f\u306a\u308b\u306e\u3067\u30ea\u30f3\u30af\u306b\u983c\u3063\u3066\u3044\u308b\u3068\u3053\u308d\u304c\u5927\u304d\u3044\u3067\u3059\u304c\u3001\u6ce8\u610f\u3059\u3079\u304d\u70b9\u306f\u6319\u3052\u3089\u308c\u305f\u3068\u601d\u3044\u307e\u3059\u3002\n\u304a\u304b\u3057\u306a\u6240\u3084\u8ffd\u52a0\u3059\u3079\u304d\u70b9\u304c\u3042\u308a\u307e\u3057\u305f\u3089\u3054\u6559\u6388\u9858\u3044\u307e\u3059\u3002\nNCMB\u306e\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u5b9f\u88c5\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u50d5\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u7d4c\u9a13\u304c\u6d45\u3044\u306e\u3068\u516c\u5f0f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u60c5\u5831\u91cf\u304c\u5982\u4f55\u305b\u3093\u5c11\u306a\u304b\u3063\u305f\u305f\u3081\u3001\u7d50\u69cb\u30cf\u30de\u308a\u307e\u3057\u305f\u3002\u5099\u5fd8\u9332\u3068\u3057\u3066\u4ee5\u4e0b\u306b\u30cf\u30de\u3063\u305f\u70b9\u3092\u3056\u3063\u304f\u308a\u6319\u3052\u307e\u3059\u3002\u5c0e\u5165\u624b\u9806\u306f\u30ea\u30f3\u30af\u3092\u8f09\u305b\u308b\u306e\u3067\u3001\u57fa\u672c\u7684\u306b\u305d\u3053\u304b\u3089\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n#\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5c0e\u5165\n\u4eca\u56de\u306fNCMB\u306e\u5c0e\u5165\u306f\u6e08\u3093\u3067\u3044\u308b\u3082\u306e\u3068\u3057\u3066\u3001\u30d7\u30c3\u30b7\u30e5\u6a5f\u80fd\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3060\u3051\u8a18\u8ff0\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002NCMB\u81ea\u4f53\u306e\u5c0e\u5165\u65b9\u6cd5\u306f[\u516c\u5f0f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb](http://mb.cloud.nifty.com/doc/current/introduction/quickstart_android.html)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n##Firebase\u3068\u306e\u9023\u643a\n\u65b0\u898f\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\u5834\u5408\u306fGCM(GoogleCloudMessaging)\u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u308bFCM(FirebaseCloudMessaging)\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002Firebase\u5c0e\u5165\u624b\u9806\u306f\u3001\n1. [Firebase Console](https://console.firebase.google.com/)\u306b\u3066\u81ea\u5206\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u767b\u9332\n2. Firebase\u306e[\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9](https://firebase.google.com/docs/android/setup)\n3. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306bimport\n\u3068\u3044\u3046\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n###\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\n+ \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306f`google_service.json`\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u306b\u306a\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u306e**\u30d5\u30a1\u30a4\u30eb\u306e\u683c\u7d0d\u4f4d\u7f6e\u306fapp/\u76f4\u4e0b**\u3067\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u683c\u7d0d\u3057\u305f\u5f8c\u306f`build.gradle(Project)`\u306eclasspath\u3067\u6307\u5b9a\u3057\u3066\u3042\u3052\u307e\u3057\u3087\u3046\u3002\n-\u968e\u5c64\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-18 15.45.26.png](https://qiita-image-store.s3.amazonaws.com/0/110584/7bad4b5d-92a4-c4d5-385b-934ecdd0d5f3.png)\n-`build.gradle(Project)`\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-18 15.51.57.png](https://qiita-image-store.s3.amazonaws.com/0/110584/d4d120ed-89f4-6386-3366-b1dba9c9623c.png)\n\n+ `build.gradle`\u3067Firebase\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3055\u305b\u308b\u306e\u3067\u3059\u304c\u3001**`play-services`\u3068`firebase`\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u5408\u308f\u305b\u306a\u3044\u3068\u30a8\u30e9\u30fc\u3092\u5410\u304d\u307e\u3059**\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-18 16.02.57.png](https://qiita-image-store.s3.amazonaws.com/0/110584/d78dcb92-fb38-2970-91ad-ca61ff2293b5.png)\n\u3053\u308c\u3067Firebase\u306e\u5c0e\u5165\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n\n##Manifest\u306e\u5b9a\u7fa9\n\u6b21\u306b\u3001\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b\u305f\u3081\u306bManifest\u3092\u7de8\u96c6\u3057\u307e\u3057\u3087\u3046\u3002\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306b\u5bfe\u3059\u308b\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u3068meta\u60c5\u5831\u306e\u8ffd\u52a0\u3001\u30ec\u30b7\u30fc\u30d0\u30fc\u3068\u30b5\u30fc\u30d3\u30b9\u306e\u6307\u5b9a\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u3056\u3063\u304f\u308a\u3057\u304b\u6319\u3052\u306a\u3044\u306e\u3067\u8a73\u7d30\u306f[\u516c\u5f0f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb(Push\u901a\u77e5)](http://mb.cloud.nifty.com/doc/current/push/basic_usage_android.html)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```xml:AndroidManifest.xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\">\n\n    <uses-permission android:name=\"android.permission.INTERNET\" />\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />\n    <uses-permission android:name=\"android.permission.GET_ACCOUNTS\" />\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\n    <uses-permission android:name=\"android.permission.VIBRATE\" />\n    <uses-permission android:name=\"com.google.android.c2dm.permission.RECEIVE\" />\n    <permission\n        android:name=\"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8.permission.C2D_MESSAGE\"\n        android:protectionLevel=\"signature\" />\n    <uses-permission android:name=\"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8.permission.C2D_MESSAGE\" />\n\n    <application\n        android:name=\"com.nifty.cloud.mb.core.NCMBApplicationController\"\n        android:allowBackup=\"true\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.AppCompat.Light.DarkActionBar\">\n\n        <!-- \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u30bf\u30c3\u30d7\u6642\u306b\u8d77\u52d5\u3059\u308bActivity\u306e\u8a2d\u5b9a(\u5fc5\u9808) -->\n        <meta-data android:name=\"openPushStartActivity\" android:value=\"\u4efb\u610f\u306eActivity\"/>\n        <!-- \u901a\u77e5\u30a8\u30ea\u30a2\u306b\u8868\u793a\u3055\u308c\u308b\u30a2\u30a4\u30b3\u30f3\u306e\u8a2d\u5b9a(option) -->\n        <meta-data android:name=\"smallIcon\" android:resource=\"\u4efb\u610f\u306e\u753b\u50cf\u30c7\u30fc\u30bf\"/>\n        <!-- \u901a\u77e5\u30a8\u30ea\u30a2\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u8907\u6570\u8868\u793a\u3059\u308b\u8a2d\u5b9a\u30000:\u6700\u65b0\u306e\u307f\u8868\u793a , 1:\u8907\u6570\u8868\u793a(option) -->\n        <meta-data android:name=\"notificationOverlap\" android:value=\"1\"/>\n\n        <!--PushNotificationReceiver-->\n        <receiver\n            android:name=\"com.nifty.cloud.mb.core.NCMBGcmReceiver\"\n            android:exported=\"true\"\n            android:permission=\"com.google.android.c2dm.permission.SEND\">\n            <intent-filter>\n                <action android:name=\"com.google.android.c2dm.intent.RECEIVE\"/>\n                <category android:name=\"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\u540d\"/>\n            </intent-filter>\n        </receiver>\n        <!--PushNotificationService-->\n        <service\n            android:name=\"com.nifty.cloud.mb.core.NCMBGcmListenerService\"\n            android:exported=\"false\">\n            <intent-filter>\n                <action android:name=\"com.google.android.c2dm.intent.RECEIVE\"/>\n            </intent-filter>\n        </service>\n\n        <activity\n            android:name=\".PushTestActivity\"\n            android:label=\"@string/app_name\">\n        </activity>\n    </application>\n</manifest>\n```\n\n###\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\n+ Firebase\u9023\u643a\u306e\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\u306b\u6319\u3052\u3066\u3044\u308b\u306e\u3067\u5927\u4e08\u592b\u3060\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u6307\u5b9a\u3057\u3066\u3044\u308b\u30ec\u30b7\u30fc\u30d0\u30fc\u3068\u30b5\u30fc\u30d3\u30b9\u306f`play-services`\u5185\u306e\u30af\u30e9\u30b9\u3092\u7d99\u627f\u3057\u3066\u3044\u308b\u306e\u3067\u3001`build.gradle`\u3067\u304d\u3061\u3093\u3068`play-services`\u3082\u3057\u304f\u306f`play-services-gcm`\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u3044\u306a\u3044\u3068\u52d5\u4f5c\u3057\u3066\u304f\u308c\u307e\u305b\u3093\u3002\u50d5\u306f\u3053\u3053\u3067\u304b\u306a\u308a\u30cf\u30de\u308a\u307e\u3057\u305f\u3002\n\n\n#\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\n\u30b3\u30fc\u30c9\u3067\u306fFCM\u306b\u7aef\u672b\u306eID\u3092\u767b\u9332\u3059\u308c\u3070\u3044\u3044\u3060\u3051\u3067\u3059\u3002[\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9](https://github.com/ncmbadmin/android_push_demo)\u306e\u307b\u307c\u4e38\u5199\u3057\u3067\u3059\u3002SENDER ID\u306f[FCM\u9023\u643a\u306b\u5fc5\u8981\u306a\u8a2d\u5b9a](http://mb.cloud.nifty.com/doc/current/tutorial/push_setup_android.html)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```java:PushTestActivity.java\npublic class PushTestActivity extends Activity {\n\n    //NCMB DB\u306eappKey\u3068clientKey\n    private final static String APP_KEY = \"API KEY\";\n    private final static String CLIENT_KEY = \"CLIENT KEY\";\n    //Firebase senderID\n    private final static String SENDER_ID = \"SENDER ID\";\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_push_test);\n\n        //NCMB\u306e\u521d\u671f\u5316\n        NCMB.initialize(this.getApplicationContext(), APP_KEY, CLIENT_KEY);\n\n        //FCM\u306b\u7aef\u672bID\u3092\u767b\u9332\n        final NCMBInstallation installation = NCMBInstallation.getCurrentInstallation();\n        installation.getRegistrationIdInBackground(SENDER_ID, new DoneCallback() {\n            @Override\n            public void done(NCMBException e) {\n                if (e == null) {\n                    installation.saveInBackground(new DoneCallback() {\n                        @Override\n                        public void done(NCMBException e) {\n                            if (e == null) {\n                                //\u4fdd\u5b58\u6210\u529f\n                                Log.d(CLASS_TAG, \"\u767b\u9332\u6210\u529f\");\n                            } else if (NCMBException.DUPLICATE_VALUE.equals(e.getCode())) {\n                                updateInstallation(installation);\n                            } else {\n                                Log.d(CLASS_TAG, \"\u4fdd\u5b58\u5931\u6557\");\n                            }\n                        }\n                    });\n                } else {\n                    Log.d(CLASS_TAG, \"\u53d6\u5f97\u5931\u6557\");\n                }\n            }\n        });\n    }\n\n    public static void updateInstallation(final NCMBInstallation installation) {\n        NCMBQuery<NCMBInstallation> query = NCMBInstallation.getQuery();\n        query.whereEqualTo(\"deviceToken\", installation.getDeviceToken());\n        query.findInBackground(new FindCallback<NCMBInstallation>() {\n            @Override\n            public void done(List<NCMBInstallation> list, NCMBException e) {\n                installation.setObjectId(list.get(0).getObjectId());\n                installation.saveInBackground();\n            }\n        });\n    }\n}\n```\n\nDB\u4e0a\u306eInstallation\u30af\u30e9\u30b9\u306b\u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u305f\u3089\u3001\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u4e0a\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u9001\u4fe1\u3092\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u591a\u5206\u5c4a\u304f\u306f\u305a\u3067\u3059\u3002\u9001\u4fe1\u65b9\u6cd5\u306f[\u516c\u5f0f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb(Push\u901a\u77e5)](http://mb.cloud.nifty.com/doc/current/push/basic_usage_android.html)\u306e\u4e0b\u306e\u65b9\u306b\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\n\n#\u307e\u3068\u3081\nFirebase\u3068\u9023\u643a\u3057\u3066NCMB PushNotification\u3092\u5b9f\u88c5\u3059\u308b\u6587\u732e\u306f\u898b\u5f53\u305f\u3089\u306a\u304b\u3063\u305f\u306e\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f\u3002\u5168\u90e8\u8aac\u660e\u3059\u308b\u3068\u9577\u304f\u306a\u308b\u306e\u3067\u30ea\u30f3\u30af\u306b\u983c\u3063\u3066\u3044\u308b\u3068\u3053\u308d\u304c\u5927\u304d\u3044\u3067\u3059\u304c\u3001\u6ce8\u610f\u3059\u3079\u304d\u70b9\u306f\u6319\u3052\u3089\u308c\u305f\u3068\u601d\u3044\u307e\u3059\u3002\n\u304a\u304b\u3057\u306a\u6240\u3084\u8ffd\u52a0\u3059\u3079\u304d\u70b9\u304c\u3042\u308a\u307e\u3057\u305f\u3089\u3054\u6559\u6388\u9858\u3044\u307e\u3059\u3002\n", "tags": ["Android", "NCMB", "Push\u901a\u77e5", "Firebase"]}