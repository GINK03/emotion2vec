{"tags": ["PHP", "Amazon", "api"], "context": " More than 1 year has passed since last update.Amazon Product Advertising API\n\u3092\u4f7f\u3063\u3066ASIN\u304b\u3089\u5546\u54c1\u753b\u50cf\u3092\u53d6\u5f97\u3057\u305f\u6642\u306e\u96d1\u306a\u30e1\u30e2\n\n\u624b\u9806\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\u3000REST \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u69cb\u9020\n\n\u7f72\u540d\u8a8d\u8a3c\u3000 REST\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u8a8d\u8a3c\u65b9\u6cd5\n\nURL\u7d44\u307f\u7acb\u3066\u3066\u30ea\u30af\u30a8\u30b9\u30c8\nXml\u30d1\u30fc\u30b9\n\n\n<?php\n//ASIN\n$asin = 'B013PUTPHK';\n\n//\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\n$access_key_id = '';\n//\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\n$secret_access_key = '';\n//\u30a2\u30bd\u30b7\u30a8\u30a4\u30c8\u30bf\u30b0\n$associateTag = '';\n\n//API\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8URL\n$endpoint = 'http://ecs.amazonaws.jp/onca/xml';\n\n// \u30d1\u30e9\u30e1\u30fc\u30bf\n$params = array(\n    //\u5171\u901a\u2193\n    'Service' => 'AWSECommerceService',\n    'AWSAccessKeyId' => $access_key_id,\n    'AssociateTag' => $associateTag,\n    //\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u3088\u308a\u5909\u66f4\u2193\n    'Operation' => 'ItemLookup',\n    'ItemId' => $asin,\n    'ResponseGroup' => 'ItemAttributes,Images',\n    //\u7f72\u540d\u7528\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\n    'Timestamp' => gmdate('Y-m-d\\TH:i:s\\Z'),\n);\n\n//\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u5024\u306e\u30da\u30a2\u3092\u30d0\u30a4\u30c8\u9806\uff1f\u3067\u4e26\u3079\u304b\u3048\u3002\nksort($params);\n\n//RFC 3986?\u3067URL\u30a8\u30f3\u30b3\u30fc\u30c9\n$string_request = str_replace(\n    array('+', '%7E'),\n    array('%20', '~'),\n    http_build_query($params)\n);\n\n//URL\u5206\u89e3\n$parse_url = parse_url($endpoint);\n\n//\u7f72\u540d\u5bfe\u8c61\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u6587\u5b57\u5217\u3092\u4f5c\u6210\u3002\n$string_signature = \"GET\\n{$parse_url[\"host\"]}\\n{$parse_url[\"path\"]}\\n$string_request\";\n\n//RFC2104\u6e96\u62e0\u306eHMAC-SHA256\u30cf\u30c3\u30b7\u30e5\u5316\u3057base64\u30a8\u30f3\u30b3\u30fc\u30c9\uff08\u3053\u308c\u304csignature\u3068\u306a\u308b\uff09\n$signature = base64_encode(hash_hmac('sha256', $string_signature, $secret_access_key,true));\n\n//URL\u7d44\u307f\u7acb\u3066\n$url = $endpoint . '?' . $string_request . '&Signature=' . $signature;\n\n\n// xml\u53d6\u5f97\n$xml = simplexml_load_string(getHttpContent($url));\n\n$item = $xml->Items->Item;\necho \"\u753b\u50cfURL\uff1a\".$item->LargeImage->URL.\"\\n\";\n\n\nfunction getHttpContent($url)\n{\n    try {\n        $ch = curl_init();\n        curl_setopt_array($ch, [\n            CURLOPT_URL => $url,\n            CURLOPT_RETURNTRANSFER => true,\n        ]);\n        $body = curl_exec($ch);\n        $errno = curl_errno($ch);\n        $error = curl_error($ch);\n        curl_close($ch);\n        if (CURLE_OK !== $errno) {\n            throw new RuntimeException($error, $errno);\n\n        }\n        return $body;\n    } catch (Exception $e) {\n        echo $e->getMessage();\n    }\n}\n\n\n\n\nAmazon Product Advertising API\n\u3092\u4f7f\u3063\u3066ASIN\u304b\u3089\u5546\u54c1\u753b\u50cf\u3092\u53d6\u5f97\u3057\u305f\u6642\u306e\u96d1\u306a\u30e1\u30e2\n\n\n## \u624b\u9806\n1. \u30d1\u30e9\u30e1\u30fc\u30bf\u8a2d\u5b9a\u3000[REST \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u69cb\u9020](https://images-na.ssl-images-amazon.com/images/G/09/associates/paapi/dg/index.html?AnatomyOfaRESTRequest.html)\n2. \u7f72\u540d\u8a8d\u8a3c\u3000[ REST\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u8a8d\u8a3c\u65b9\u6cd5](https://images-na.ssl-images-amazon.com/images/G/09/associates/paapi/dg/index.html?AnatomyOfaRESTRequest.html)\n3. URL\u7d44\u307f\u7acb\u3066\u3066\u30ea\u30af\u30a8\u30b9\u30c8\n4. Xml\u30d1\u30fc\u30b9\n\n\n\n```php\n\n<?php\n//ASIN\n$asin = 'B013PUTPHK';\n\n//\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\n$access_key_id = '';\n//\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ad\u30fc\n$secret_access_key = '';\n//\u30a2\u30bd\u30b7\u30a8\u30a4\u30c8\u30bf\u30b0\n$associateTag = '';\n\n//API\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8URL\n$endpoint = 'http://ecs.amazonaws.jp/onca/xml';\n\n// \u30d1\u30e9\u30e1\u30fc\u30bf\n$params = array(\n    //\u5171\u901a\u2193\n    'Service' => 'AWSECommerceService',\n    'AWSAccessKeyId' => $access_key_id,\n    'AssociateTag' => $associateTag,\n    //\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u3088\u308a\u5909\u66f4\u2193\n    'Operation' => 'ItemLookup',\n    'ItemId' => $asin,\n    'ResponseGroup' => 'ItemAttributes,Images',\n    //\u7f72\u540d\u7528\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\n    'Timestamp' => gmdate('Y-m-d\\TH:i:s\\Z'),\n);\n\n//\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u5024\u306e\u30da\u30a2\u3092\u30d0\u30a4\u30c8\u9806\uff1f\u3067\u4e26\u3079\u304b\u3048\u3002\nksort($params);\n\n//RFC 3986?\u3067URL\u30a8\u30f3\u30b3\u30fc\u30c9\n$string_request = str_replace(\n    array('+', '%7E'),\n    array('%20', '~'),\n    http_build_query($params)\n);\n\n//URL\u5206\u89e3\n$parse_url = parse_url($endpoint);\n\n//\u7f72\u540d\u5bfe\u8c61\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u6587\u5b57\u5217\u3092\u4f5c\u6210\u3002\n$string_signature = \"GET\\n{$parse_url[\"host\"]}\\n{$parse_url[\"path\"]}\\n$string_request\";\n\n//RFC2104\u6e96\u62e0\u306eHMAC-SHA256\u30cf\u30c3\u30b7\u30e5\u5316\u3057base64\u30a8\u30f3\u30b3\u30fc\u30c9\uff08\u3053\u308c\u304csignature\u3068\u306a\u308b\uff09\n$signature = base64_encode(hash_hmac('sha256', $string_signature, $secret_access_key,true));\n\n//URL\u7d44\u307f\u7acb\u3066\n$url = $endpoint . '?' . $string_request . '&Signature=' . $signature;\n\n\n// xml\u53d6\u5f97\n$xml = simplexml_load_string(getHttpContent($url));\n\n$item = $xml->Items->Item;\necho \"\u753b\u50cfURL\uff1a\".$item->LargeImage->URL.\"\\n\";\n\n\nfunction getHttpContent($url)\n{\n    try {\n        $ch = curl_init();\n        curl_setopt_array($ch, [\n            CURLOPT_URL => $url,\n            CURLOPT_RETURNTRANSFER => true,\n        ]);\n        $body = curl_exec($ch);\n        $errno = curl_errno($ch);\n        $error = curl_error($ch);\n        curl_close($ch);\n        if (CURLE_OK !== $errno) {\n            throw new RuntimeException($error, $errno);\n\n        }\n        return $body;\n    } catch (Exception $e) {\n        echo $e->getMessage();\n    }\n}\n\n\n\n```\n"}