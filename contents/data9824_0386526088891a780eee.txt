{"context": " More than 1 year has passed since last update.PRML\u56f33.8\u3068\u540c\u69d8\u306b\u3001\u30ac\u30a6\u30b9\u57fa\u5e95\u3092\u57fa\u5e95\u95a2\u6570\u3068\u3059\u308b\u7dda\u5f62\u57fa\u5e95\u95a2\u6570\u30e2\u30c7\u30eb\u306b\u304a\u3044\u3066\u3001\u30b5\u30f3\u30d7\u30eb\u304b\u3089\u6c42\u3081\u305f\u91cd\u307f\u306e\u4e8b\u5f8c\u5206\u5e03\u304b\u3089\u3001\u4e88\u6e2c\u5024\u306e\u4e88\u6e2c\u5206\u5e03\u3092\u6c42\u3081\u3001\u30b5\u30f3\u30d7\u30eb\u70b9\u3068\u3068\u3082\u306b\u56f3\u793a\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u56f33.9\u3068\u540c\u69d8\u306b\u3001\u91cd\u307f\u306e\u4e8b\u5f8c\u5206\u5e03\u304b\u3089\u751f\u6210\u3057\u305f\u95a2\u6570\u306e\u4f8b\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\n\nlibrary(mvtnorm)\nframe()\nset.seed(0)\npar(mfrow=c(2, 2))\npar(mar=c(2, 2, 1, 0.1))\npar(mgp=c(1, 0.2, 0))\nxrange <- c(-0.5, 1.5)\nyrange <- c(-1.5, 1.5)\nx1 <- seq(xrange[1], xrange[2], .01)\nx2 <- seq(yrange[1], yrange[2], .01)\ncolors <- rainbow(450)[256:1]\nM <- 10\nN <- 25\n\nbase <- function(m, x) {\n#   r <- x^m                        #\u591a\u9805\u5f0f\u57fa\u5e95\u306e\u5834\u5408\n    r <- exp(-(x-(m-1)/(M-2))^2/(2*0.2^2))  #\u30ac\u30a6\u30b9\u57fa\u5e95\u306e\u5834\u5408\n    r[m == 0]<-1                    # w0\u3092\u30d0\u30a4\u30a2\u30b9\u9805\u3068\u3059\u308b\u305f\u3081\u03c60=1\n    r\n}\nmakePhi<-function(M, x) {\n    A <- matrix(nrow=length(x), ncol=M)\n    for (i in 1:length(x)) {\n        for (j in 0:(M-1)) {\n            A[i, 1+j] <- base(j, x[i])\n        }\n    }\n    A\n}\nx <- runif(N, 0, 1)\ny <- rnorm(N, sin(2 * pi * x), 0.2)\n\nalpha <- 0.1\nbeta <- (1 / 0.2) ^ 2\n\n# prior probability distribution\ns0inv <- alpha * diag(1, M)\nm0 <- rep(0, M)\ncat(\"s0\");print(solve(s0inv))\ncat(\"m0\");print(m0)\n\nfor (n in c(1, 2, 4, 25)) {\n    # derive the posterior\n    phi <- makePhi(M, x[1:n])\n    sninv <- s0inv + beta * t(phi) %*% phi\n    sn <- solve(sninv)\n    mn <- sn %*% (s0inv %*% m0 + beta * t(phi) %*% y[1:n])\n    cat(\"sn\");print(sn)\n    cat(\"mn\");print(mn)\n\n    plot(x[1:n], y[1:n], xlim=xrange, ylim=yrange, xlab=\"x\", ylab=\"y\")\n    title(paste(\"N=\", n))\n\n    # derive the predictive distribution\n    phin <- t(makePhi(M, x1))\n    u <- t(mn) %*% phin\n    s <- 1 / beta + diag(t(phin) %*% sn %*% phin)\n    predictive <- function(x, y) {\n            dnorm(y, u[x], s[x])\n    }\n    image(x1, x2, outer(1:length(x1), x2, predictive), xlim=xrange, ylim=yrange, col=colors, xlab=\"\", ylab=\"\", axes=F, add=T)\n\n    # plot example regressions\n    for (i in 1:5) {\n            w <- rmvnorm(1, mn, sn)\n            estimate<-function(x){\n                    (w %*% t(makePhi(M, x)))  # (w[1]+w[2]*base(1,x)+w[3]*base(2,x)...)\n            }\n            par(new=T)\n            curve(estimate, type=\"l\", xlim=xrange, ylim=yrange, col=gray(i/10), xlab=\"\", ylab=\"\", axes=F)\n    }\n\n    # plot the samples\n    par(new=T)\n    plot(x[1:n], y[1:n], xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F)\n}\n\nPRML\u56f33.8\u3068\u540c\u69d8\u306b\u3001\u30ac\u30a6\u30b9\u57fa\u5e95\u3092\u57fa\u5e95\u95a2\u6570\u3068\u3059\u308b\u7dda\u5f62\u57fa\u5e95\u95a2\u6570\u30e2\u30c7\u30eb\u306b\u304a\u3044\u3066\u3001\u30b5\u30f3\u30d7\u30eb\u304b\u3089\u6c42\u3081\u305f\u91cd\u307f\u306e\u4e8b\u5f8c\u5206\u5e03\u304b\u3089\u3001\u4e88\u6e2c\u5024\u306e\u4e88\u6e2c\u5206\u5e03\u3092\u6c42\u3081\u3001\u30b5\u30f3\u30d7\u30eb\u70b9\u3068\u3068\u3082\u306b\u56f3\u793a\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u56f33.9\u3068\u540c\u69d8\u306b\u3001\u91cd\u307f\u306e\u4e8b\u5f8c\u5206\u5e03\u304b\u3089\u751f\u6210\u3057\u305f\u95a2\u6570\u306e\u4f8b\u3092\u56f3\u793a\u3057\u307e\u3059\u3002\n\n![](https://dl.dropbox.com/sh/cwfemibvr7gk4cy/jQRTwHQ9Ao/12.LinearRegressionPredictiveDistribution.png)\n\n```r\nlibrary(mvtnorm)\nframe()\nset.seed(0)\npar(mfrow=c(2, 2))\npar(mar=c(2, 2, 1, 0.1))\npar(mgp=c(1, 0.2, 0))\nxrange <- c(-0.5, 1.5)\nyrange <- c(-1.5, 1.5)\nx1 <- seq(xrange[1], xrange[2], .01)\nx2 <- seq(yrange[1], yrange[2], .01)\ncolors <- rainbow(450)[256:1]\nM <- 10\nN <- 25\n\nbase <- function(m, x) {\n#\tr <- x^m\t\t\t\t\t\t#\u591a\u9805\u5f0f\u57fa\u5e95\u306e\u5834\u5408\n\tr <- exp(-(x-(m-1)/(M-2))^2/(2*0.2^2))\t#\u30ac\u30a6\u30b9\u57fa\u5e95\u306e\u5834\u5408\n\tr[m == 0]<-1\t\t\t\t\t# w0\u3092\u30d0\u30a4\u30a2\u30b9\u9805\u3068\u3059\u308b\u305f\u3081\u03c60=1\n\tr\n}\nmakePhi<-function(M, x) {\n\tA <- matrix(nrow=length(x), ncol=M)\n\tfor (i in 1:length(x)) {\n\t\tfor (j in 0:(M-1)) {\n\t\t\tA[i, 1+j] <- base(j, x[i])\n\t\t}\n\t}\n\tA\n}\nx <- runif(N, 0, 1)\ny <- rnorm(N, sin(2 * pi * x), 0.2)\n\nalpha <- 0.1\nbeta <- (1 / 0.2) ^ 2\n\n# prior probability distribution\ns0inv <- alpha * diag(1, M)\nm0 <- rep(0, M)\ncat(\"s0\");print(solve(s0inv))\ncat(\"m0\");print(m0)\n \nfor (n in c(1, 2, 4, 25)) {\n\t# derive the posterior\n\tphi <- makePhi(M, x[1:n])\n\tsninv <- s0inv + beta * t(phi) %*% phi\n\tsn <- solve(sninv)\n\tmn <- sn %*% (s0inv %*% m0 + beta * t(phi) %*% y[1:n])\n\tcat(\"sn\");print(sn)\n\tcat(\"mn\");print(mn)\n\t\n\tplot(x[1:n], y[1:n], xlim=xrange, ylim=yrange, xlab=\"x\", ylab=\"y\")\n\ttitle(paste(\"N=\", n))\n\t\n\t# derive the predictive distribution\n\tphin <- t(makePhi(M, x1))\n\tu <- t(mn) %*% phin\n\ts <- 1 / beta + diag(t(phin) %*% sn %*% phin)\n\tpredictive <- function(x, y) {\n\t\t\tdnorm(y, u[x], s[x])\n\t}\n\timage(x1, x2, outer(1:length(x1), x2, predictive), xlim=xrange, ylim=yrange, col=colors, xlab=\"\", ylab=\"\", axes=F, add=T)\n\t\n\t# plot example regressions\n\tfor (i in 1:5) {\n\t\t\tw <- rmvnorm(1, mn, sn)\n\t\t\testimate<-function(x){\n\t\t\t\t\t(w %*% t(makePhi(M, x)))  # (w[1]+w[2]*base(1,x)+w[3]*base(2,x)...)\n\t\t\t}\n\t\t\tpar(new=T)\n\t\t\tcurve(estimate, type=\"l\", xlim=xrange, ylim=yrange, col=gray(i/10), xlab=\"\", ylab=\"\", axes=F)\n\t}\n\t\n\t# plot the samples\n\tpar(new=T)\n\tplot(x[1:n], y[1:n], xlim=xrange, ylim=yrange, xlab=\"\", ylab=\"\", axes=F)\n}\n```", "tags": ["R", "PRML"]}