{"context": " More than 1 year has passed since last update.\nnyan.vb\n\nPrivate Sub export_Click()\n\nDim W1 As Long\nDim OUT_FILE As String\nDim CUR_FLD As String\nDim Q_NAME As String\n\nQ_NAME = \"query_name\"\n\nIf DCount(\"*\", Q_NAME) = 0 Then\n   MsgBox \"\u30ec\u30b3\u30fc\u30c9\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\" & vbCrLf & \"\u51e6\u7406\u3092\u4e2d\u6b62\u3057\u307e\u3059\u3002\"\nExit Sub\nEnd If\n\nCUR_FLD = Left(CurrentDb.name, InStrRev(CurrentDb.name, \"\\\"))\n\nWizHook.Key = 51488399\nW1 = WizHook.GetFileName(0, \"\", \"\", \"\", OUT_FILE, CUR_FLD, \"xlsx\u30d5\u30a1\u30a4\u30eb(*.xlsx)|*.xlsx\", 0, 0, 4, False)\nWizHook.Key = 0\n\nIf W1 <> 0 Then\nExit Sub\nEnd If\n\nDoCmd.TransferSpreadsheet acExport, 10, Q_NAME, OUT_FILE\n\nEnd Sub\n\n\n\n```vb:nyan.vb\n\nPrivate Sub export_Click()\n\nDim W1 As Long\nDim OUT_FILE As String\nDim CUR_FLD As String\nDim Q_NAME As String\n\nQ_NAME = \"query_name\"\n\nIf DCount(\"*\", Q_NAME) = 0 Then\n   MsgBox \"\u30ec\u30b3\u30fc\u30c9\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\" & vbCrLf & \"\u51e6\u7406\u3092\u4e2d\u6b62\u3057\u307e\u3059\u3002\"\nExit Sub\nEnd If\n\nCUR_FLD = Left(CurrentDb.name, InStrRev(CurrentDb.name, \"\\\"))\n\nWizHook.Key = 51488399\nW1 = WizHook.GetFileName(0, \"\", \"\", \"\", OUT_FILE, CUR_FLD, \"xlsx\u30d5\u30a1\u30a4\u30eb(*.xlsx)|*.xlsx\", 0, 0, 4, False)\nWizHook.Key = 0\n\nIf W1 <> 0 Then\nExit Sub\nEnd If\n\nDoCmd.TransferSpreadsheet acExport, 10, Q_NAME, OUT_FILE\n\nEnd Sub\n\n```", "tags": ["VBA"]}