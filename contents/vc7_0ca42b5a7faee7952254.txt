{"tags": ["Swift", "Objective-C", "Block", "Closure"], "context": " More than 1 year has passed since last update.Swift \u7684 closure \u5373\u4f7f\u548c Objective-C \u7684 block \u975e\u5e38\u7684\u76f8\u50cf\uff0c\u4f46\u662f\u5728\u53d6\u5f97\u5916\u90e8\u8b8a\u6578\u7684\u503c\u6642\uff0c\u505a\u6cd5\u662f\u4e0d\u540c\u7684\u3002\n\u5148\u770b\u9019\u5169\u6bb5 code \uff0c\u505a\u7684\u4e8b\u60c5\u662f\u4e00\u6a23\u7684\uff1a\n\n\n\u5ba3\u544a\u4e00\u500b\u6574\u6578\u548c\u4e00\u500b\u5b57\u4e32\n\u5ba3\u544a\u4e00\u500b block\n\u57f7\u884c\u9019\u500b block\n\u8b8a\u52d5\u6574\u6578\u548c\u5b57\u4e32\u7684\u503c\n\u518d\u57f7\u884c\u9019\u500b block\n\n\n\nObjective-C\nNSInteger myInt = 1;\nNSMutableString *myString = [@\"Hello\" mutableCopy];\n\nvoid (^myBlock)(void) = ^() {\n    NSLog(@\"%@, %@\", @(myInt), myString);\n};\n\nmyBlock();\n\nmyInt = 2;\n[myString appendString:@\", world\"];\n\nmyBlock();\n\n\nSwift\nvar myInt = 1\nvar myString = \"Hello\"\n\nlet myBlock = {\n    print(\"\\(myInt), \\(myString)\")\n}\n\nmyBlock()\n\nmyInt = 2\nmyString.appendContentsOf(\", world!\")\n\n\nmyBlock()\n\n\n\u5370\u51fa\u7d50\u679c\n\u53ef\u4ee5\u767c\u73fe\u5169\u500b\u8a9e\u8a00\u5728\u985e\u4f3c\u8a9e\u53e5\uff0c\u5448\u73fe\u7d50\u679c\u537b\u4e0d\u4e00\u6a23\u7684\u7d50\u679c\uff1a\n\nObjective-C\n1, Hello\n1, Hello, world\n\n\u8aaa\u660e\uff1a\n\nNSInteger \u662f primitive type \uff0c\u8b8a\u6578\u662f\u5b58\u300c\u503c\u300d\u3001NSString \u662f\u5b58\u300c\u8a18\u61b6\u9ad4\u4f4d\u7f6e\u300d\n\n\u56e0\u6b64\u5728 myBlock \u5ba3\u544a\u7684\u6642\u5019\uff0c\u5404\u81ea capture \u9019\u5169\u500b\u503c\uff081 \u548c myString \u7684\u8a18\u61b6\u9ad4\u4f4d\u7f6e\uff09\n\u65bc\u662f\u5728 block \u5916\u8b8a\u66f4\u9019\u5169\u500b\u6578\u503c\u4e4b\u5f8c\u518d\u5370\u51fa\uff0ccaptured \u7684 1 \u548c myString \u7684\u8a18\u61b6\u9ad4\u4f4d\u7f6e\u90fd\u4e0d\u6703\u8b8a\u52d5\uff0c\u4f46\u662f myString \u8a18\u61b6\u9ad4\u4f4d\u7f6e\u6240\u5b58\u7684\u5167\u5bb9\u6539\u4e86\uff0c\u624d\u6703\u5370\u51fa Hello, world\n\nSwift\n1, Hello\n2, Hello, world!\n\n\u8aaa\u660e\uff1a\n\n\u5728 Swift \u7684 closure \u7684\u60c5\u5f62\u4e4b\u4e0b\uff0c closure \u6703\u5373\u6642\u53bb capture \u57f7\u884c\u6642\u8b8a\u6578 \u7576\u4e0b \u7684\u6578\u503c\u3002\n\n\u5728\u57f7\u884c\u7b2c\u4e00\u6b21 myBlock() \u7684\u6642\u5019\uff0c\u8b8a\u6578\u503c\u662f 1 \u548c Hello \uff0c\n\u63a5\u8457\u57f7\u884c\u7b2c\u4e8c\u6b21\u524d myBlock() \u7684\u6642\u5019\uff0c\u8b8a\u6578\u503c\u5c31\u5df2\u7d93\u88ab\u8b8a\u52d5\u6210 2 \u548c Hello, world! \uff0c\u9019\u5169\u500b\u503c\u5c31\u6703\u88ab myBlock() capture \u9032\u53bb\u7528\n\n\u7d50\u8a9e - \u6ce8\u610f\u4f7f\u7528\n\u77e5\u9053 Swift \u7684 data type \u57fa\u672c\u4e0a\u90fd\u8b8a\u6210 struct \u4e4b\u5f8c\uff0c\u5c31\u99ac\u4e0a\u4f86\u5617\u8a66\u9019\u6bb5 code \u7684\u7d50\u679c\u6703\u4e0d\u6703\u4e0d\u540c\uff0c\u65bc\u662f\u548c\u9810\u60f3\u4e00\u6a23\u7d50\u679c\u4e0d\u540c\u4e86\u3002\n\u5169\u500b\u5f88\u985e\u4f3c\u7684\u6771\u897f\u5373\u4f7f\u5beb\u6cd5\u985e\u4f3c\uff0c\u5728\u4e0d\u540c\u7684\u8a9e\u8a00\u4e4b\u4e0b\u57f7\u884c\u7684\u7d50\u679c\u6703\u4e0d\u76f8\u540c\u7684\u6642\u5019\uff0c\u5be6\u4f5c\u4e0a\u5c31\u53ef\u4ee5\u6ce8\u610f\u4e00\u4e0b\u57f7\u884c\u7d50\u679c\u6703\u4e0d\u6703\u56e0\u70ba\u7279\u6027\u6539\u8b8a\u800c\u5f71\u97ff\u3002\n\n\u53c3\u8003\n\nClosures - The Swift Programming Language (Swift 2.1)\n\nSwift \u7684 closure \u5373\u4f7f\u548c Objective-C \u7684 block \u975e\u5e38\u7684\u76f8\u50cf\uff0c\u4f46\u662f\u5728\u53d6\u5f97\u5916\u90e8\u8b8a\u6578\u7684\u503c\u6642\uff0c\u505a\u6cd5\u662f\u4e0d\u540c\u7684\u3002\n\n\u5148\u770b\u9019\u5169\u6bb5 code \uff0c\u505a\u7684\u4e8b\u60c5\u662f\u4e00\u6a23\u7684\uff1a\n\n> 1. \u5ba3\u544a\u4e00\u500b\u6574\u6578\u548c\u4e00\u500b\u5b57\u4e32\n> 2. \u5ba3\u544a\u4e00\u500b block\n> 3. \u57f7\u884c\u9019\u500b block\n> 4. \u8b8a\u52d5\u6574\u6578\u548c\u5b57\u4e32\u7684\u503c\n> 5. \u518d\u57f7\u884c\u9019\u500b block\n\n### Objective-C\n\n``` objc\nNSInteger myInt = 1;\nNSMutableString *myString = [@\"Hello\" mutableCopy];\n    \nvoid (^myBlock)(void) = ^() {\n    NSLog(@\"%@, %@\", @(myInt), myString);\n};\n    \nmyBlock();\n    \nmyInt = 2;\n[myString appendString:@\", world\"];\n    \nmyBlock();\n```\n\n### Swift\n``` swift\nvar myInt = 1\nvar myString = \"Hello\"\n\nlet myBlock = {\n    print(\"\\(myInt), \\(myString)\")\n}\n\nmyBlock()\n\nmyInt = 2\nmyString.appendContentsOf(\", world!\")\n\n\nmyBlock()\n```\n\n## \u5370\u51fa\u7d50\u679c\n\n\u53ef\u4ee5\u767c\u73fe\u5169\u500b\u8a9e\u8a00\u5728\u985e\u4f3c\u8a9e\u53e5\uff0c\u5448\u73fe\u7d50\u679c\u537b\u4e0d\u4e00\u6a23\u7684\u7d50\u679c\uff1a\n\n### Objective-C\n\n``` text\n1, Hello\n1, Hello, world\n```\n\n**\u8aaa\u660e\uff1a**\n\n> `NSInteger` \u662f primitive type \uff0c\u8b8a\u6578\u662f\u5b58\u300c\u503c\u300d\u3001`NSString` \u662f\u5b58\u300c\u8a18\u61b6\u9ad4\u4f4d\u7f6e\u300d\n\n\u56e0\u6b64\u5728 `myBlock` \u5ba3\u544a\u7684\u6642\u5019\uff0c\u5404\u81ea capture \u9019\u5169\u500b\u503c\uff081 \u548c `myString` \u7684\u8a18\u61b6\u9ad4\u4f4d\u7f6e\uff09\n\u65bc\u662f\u5728 block \u5916\u8b8a\u66f4\u9019\u5169\u500b\u6578\u503c\u4e4b\u5f8c\u518d\u5370\u51fa\uff0ccaptured \u7684 `1` \u548c `myString` \u7684\u8a18\u61b6\u9ad4\u4f4d\u7f6e\u90fd\u4e0d\u6703\u8b8a\u52d5\uff0c\u4f46\u662f `myString` \u8a18\u61b6\u9ad4\u4f4d\u7f6e\u6240\u5b58\u7684\u5167\u5bb9\u6539\u4e86\uff0c\u624d\u6703\u5370\u51fa `Hello, world`\n\n### Swift\n\n``` text\n1, Hello\n2, Hello, world!\n```\n\n**\u8aaa\u660e\uff1a**\n\n> \u5728 Swift \u7684 closure \u7684\u60c5\u5f62\u4e4b\u4e0b\uff0c closure \u6703\u5373\u6642\u53bb capture \u57f7\u884c\u6642\u8b8a\u6578 **\u7576\u4e0b** \u7684\u6578\u503c\u3002\n\n\u5728\u57f7\u884c\u7b2c\u4e00\u6b21 `myBlock()` \u7684\u6642\u5019\uff0c\u8b8a\u6578\u503c\u662f `1` \u548c `Hello` \uff0c\n\u63a5\u8457\u57f7\u884c\u7b2c\u4e8c\u6b21\u524d `myBlock()` \u7684\u6642\u5019\uff0c\u8b8a\u6578\u503c\u5c31\u5df2\u7d93\u88ab\u8b8a\u52d5\u6210 `2` \u548c `Hello, world!` \uff0c\u9019\u5169\u500b\u503c\u5c31\u6703\u88ab `myBlock()` capture \u9032\u53bb\u7528\n\n# \u7d50\u8a9e - \u6ce8\u610f\u4f7f\u7528\n\n\u77e5\u9053 Swift \u7684 data type \u57fa\u672c\u4e0a\u90fd\u8b8a\u6210 struct \u4e4b\u5f8c\uff0c\u5c31\u99ac\u4e0a\u4f86\u5617\u8a66\u9019\u6bb5 code \u7684\u7d50\u679c\u6703\u4e0d\u6703\u4e0d\u540c\uff0c\u65bc\u662f\u548c\u9810\u60f3\u4e00\u6a23\u7d50\u679c\u4e0d\u540c\u4e86\u3002\n\n\u5169\u500b\u5f88\u985e\u4f3c\u7684\u6771\u897f\u5373\u4f7f\u5beb\u6cd5\u985e\u4f3c\uff0c\u5728\u4e0d\u540c\u7684\u8a9e\u8a00\u4e4b\u4e0b\u57f7\u884c\u7684\u7d50\u679c\u6703\u4e0d\u76f8\u540c\u7684\u6642\u5019\uff0c\u5be6\u4f5c\u4e0a\u5c31\u53ef\u4ee5\u6ce8\u610f\u4e00\u4e0b\u57f7\u884c\u7d50\u679c\u6703\u4e0d\u6703\u56e0\u70ba\u7279\u6027\u6539\u8b8a\u800c\u5f71\u97ff\u3002\n\n# \u53c3\u8003\n\n- [Closures - The Swift Programming Language (Swift 2.1)](https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Closures.html#//apple_ref/doc/uid/TP40014097-CH11-ID94)\n"}