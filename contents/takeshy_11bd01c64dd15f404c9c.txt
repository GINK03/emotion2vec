{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u666e\u6bb5\u306fBackbone.js\u3067\u30a2\u30d7\u30ea\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001React.js\u306e\u8a55\u5224\u304c\u9ad8\u307e\u3063\u3066\u304d\u3066\u3044\u308b\u306e\u3067\u3001\u7c21\u6613Blog\u3092Backbone.js\u3068React.js\u306e\u4e21\u65b9\u3067\u5b9f\u88c5\u3057\u3066\u3001\u6bd4\u8f03\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nDemo\u3067\u306fjs\u4ee5\u5916\u306f\u540c\u3058\u30b5\u30fc\u30d0\u306eAPI\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u3069\u3061\u3089\u306b\u3082\u53cd\u6620\u3055\u308c\u307e\u3059\u3002\nBackbone.js\u3092\u3064\u304b\u3063\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\nSource \nhttps://github.com/takeshy/backbone_socket_io\nDemo\nhttps://radiant-dawn-8878.herokuapp.com/backbone\nReact.js\u3092\u3064\u304b\u3063\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\nSource\nhttps://github.com/takeshy/react_socket_io\nDemo\nhttps://radiant-dawn-8878.herokuapp.com/react\n\nHTML\u90e8\u5206\nBackbone.js\n\nindex.ejs\n<!DOCTYPE html>\n<html>\n  <head>\n    <link rel='stylesheet' href='/stylesheets/style.css' />\n    <script type=\"text/javascript\" src=\"/assets/bundle.js\"></script>\n    <script type=\"text/javascript\">\n      window.onload = function(){\n        window.router = new Blog.Routers.PostsRouter(<%- initialData %>);\n      }\n    </script>\n  </head>\n  <body>\n    <div id=\"posts\"></div>\n  </body>\n</html>\n\n\nReact.js\n\nindex.ejs\n<!DOCTYPE html>\n<html>\n  <head>\n    <link rel='stylesheet' href='/stylesheets/style.css' />\n    </script>\n  </head>\n  <body>\n    <div id=\"posts\"></div>\n    <script type=\"text/javascript\" src=\"socket.io.min.js\"></script>\n    <script type=\"text/javascript\" src=\"bundle.js\"></script>\n    <script>\n      reactInitial(<%- initialData %>);\n    </script>\n  </body>\n</html>\n\n\n\u307b\u307c\u540c\u3058\u3067\u3059\u3002js\u306e\u8aad\u307f\u8fbc\u307f\u3068\u521d\u671f\u547c\u3073\u51fa\u3057\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u307f\u3067\u3059\u3002\n\u521d\u671f\u8868\u793a\u3092\u901f\u304f\u3059\u308b\u305f\u3081\u521d\u671f\u30c7\u30fc\u30bf\u306bjson\u3092\u6e21\u3057\u3066\u3044\u307e\u3059\u3002\nReact.js\u306f\u3001Browserify\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001socket.io\u304cglobal\u306bio\u304c\u5b9a\u7fa9\u3055\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u3046\u307e\u304f\u52d5\u4f5c\u3057\u306a\u3044\u305f\u3081\u3001\u5225\u547c\u3073\u51fa\u3057\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\nRouter\nBackbone.js\n\nposts_router.js.coffee\nclass Blog.Routers.PostsRouter extends Backbone.Router\n  initialize: (options) ->\n    @posts = new Blog.Collections.PostsCollection(options.posts)\n    @posts.listen(\"http://localhost:3000\")\n    Backbone.history.start()\n\n  draw: (view)->\n    @view.remove() if @view\n    elem = document.getElementById(\"posts\")\n    elem.innerHTML = \"\"\n    elem.appendChild(view.render().el)\n    @view = view\n\n  routes:\n    \"new\"      : \"newPost\"\n    \"index\"    : \"index\"\n    \":id/edit\" : \"edit\"\n    \":id\"      : \"show\"\n    \".*\"        : \"index\"\n\n  index: ->\n    view = new Blog.Views.Posts.IndexView(collection: @posts)\n    @draw(view)\n\n  newPost: ->\n    view = new Blog.Views.Posts.NewView(collection: @posts)\n    @draw(view)\n\n  show: (id) ->\n    view = new Blog.Views.Posts.ShowView(model: @posts.get(id))\n    @draw(view)\n\n  edit: (id) ->\n    view = new Blog.Views.Posts.EditView(model: @posts.get(id))\n    @draw(view)\n\n\nReact.js\n\nindex.js\nimport React from 'react';\nimport {} from 'whatwg-fetch';\nimport Blog from './Blog';\nimport NewPost from './NewPost';\nimport Edit from './Edit';\nimport Show from './Show';\nimport { Router, Route } from 'react-router'\nimport BlogsActionCreators from '../actions/BlogsActionCreators';\n\nfunction initial(data){\n  BlogsActionCreators.initial(data.posts);\n  React.render((\n    <Router>\n      <Route path=\"/\" component={Blog}/>\n      <Route component={NewPost} path=\"/new\"/>\n      <Route component={Edit} path=\"/:blogId/edit\"/>\n      <Route component={Show} path=\"/:blogId/show\"/>\n    </Router>\n  ), document.getElementById('posts'));\n}\nwindow.reactInitial = initial;\n\n\n\u3088\u304f\u4f7f\u308f\u308c\u308b\u7d44\u307f\u5408\u308f\u305b\u306b\u3059\u308b\u305f\u3081\u3001Backbone\u306fCoffeeScript\u3001React.js\u3067\u306fES6\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\nReact.js\u306b\u306fRouter\u6a5f\u80fd\u304c\u306a\u3044\u306e\u3067\u3001\u4e00\u756a\u4f7f\u308f\u308c\u3066\u3044\u308b\u3067\u3042\u308d\u3046React.Router\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nES6\u306b\u3059\u308b\u3068import\u6587\u304c\u305f\u304f\u3055\u3093\u3067\u5927\u5909\u3002IDE\u304c\u3042\u308b\u3068\u4fbf\u5229\u306a\u306e\u3067\u3057\u3087\u3046\u304c\u3001vim\u3060\u3068\u8f9b\u3044\u3067\u3059\u3002\n\u305f\u3060\u3001\u4fdd\u5b88\u6027\u3092\u91cd\u8996\u3057\u3066\u3044\u308bReact.js\u306a\u306e\u3067\u3001\u306f\u3063\u304d\u308a\u30e2\u30b8\u30e5\u30fc\u30eb\u5316\u304c\u3055\u308c\u308bES6\u306e\u307b\u3046\u304c\u4eba\u6c17\u304c\u3042\u308b\u3068\u3044\u3046\u306e\u306f\u308f\u304b\u308b\u6c17\u304c\u3057\u307e\u3059\u3002\nBackbone.js\u306e\u307b\u3046\u306f\u3059\u3063\u304d\u308a\u3057\u3066\u3044\u3066\u898b\u3084\u3059\u3044\u3067\u3059\u304c\u3001\u57fa\u672crouter\u306f1\u3064\u3057\u304b\u4f7f\u308f\u306a\u3044\u306e\u3067\u3001\u6ca2\u5c71\u306e\u30da\u30fc\u30b8\u304c\u5fc5\u8981\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u30bd\u30fc\u30b9\u304c\u9577\u304f\u306a\u308a\u307e\u3059\u3002\n\u5171\u901a\u51e6\u7406\u306f\u5b9f\u884c\u3057\u3084\u3059\u3044\u3067\u3059\u3002\nReact.js\u3067\u3082React.router\u3092\u4f7f\u308f\u305a\u3001Backbone.js\u306eRouter\u3092\u4f7f\u3046\u4eba\u3082\u3044\u308b\u306e\u3067\u3053\u3053\u306e\u6bd4\u8f03\u306f\u3042\u307e\u308a\u610f\u5473\u3092\u306a\u3055\u306a\u3044\u304b\u3082\u3067\u3059\u304c\u3001\u4e00\u822c\u6027\u3067\u6bd4\u8f03\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nModel VS Dispatcher Store ActionCreator\nBackbone.js\n\npost.js.coffee\nclass Blog.Models.Post extends Backbone.Model\n  paramRoot: 'post'\n\n  defaults:\n    title: null\n    content: null\n\nclass Blog.Collections.PostsCollection extends Backbone.Collection\n  model: Blog.Models.Post\n  url: '/posts'\n  socket: null\n  listen:(nodeUrl)->\n    @socket = io.connect(nodeUrl + \"/posts\")\n    @socket.on('connect', ()=>\n      @addListener()\n    )\n\n  addListener:()->\n    @socket.on(\"post\", (msg)=>\n      obj = JSON.parse(msg)\n      _.each(obj,(postData)=>\n        if postData.deleted\n          @get(postData[\"id\"])?.destroy()\n        else\n          @add(postData,{merge: true})\n      )\n    )\n\n\nReact.js\n\nAppDispacher.js\n//Dispacher\nimport {Dispatcher} from 'flux';\n\nconst AppDispatcher = new Dispatcher();\n\nexport default AppDispatcher;\n\n\n\nBlogs.js\n//Store\nimport {EventEmitter} from 'events';\nimport assign from 'object-assign';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport BlogConstants from '../constants/BlogConstants';\n\nconst ActionTypes = BlogConstants.ActionTypes;\nconst CHANGE_EVENT = 'change';\nlet blogs = [];\n\nconst Blogs = assign({}, EventEmitter.prototype, {\n  emitChange() {\n    this.emit(CHANGE_EVENT);\n  },\n  addChangeListener(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n  removeChangeListener(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  },\n  all(){\n    return blogs.concat([])\n  },\n  find(id){\n    for(let i=0;i<blogs.length;i++){\n      let blog = blogs[i];\n      if(blog.id == id){\n        return blog;\n      }\n    }\n    return null;\n  }\n});\n\nBlogs.dispatchToken = AppDispatcher.register(action => {\n\n  switch (action.type) {\n    case ActionTypes.RECEIVE_BLOG:\n      blogs = blogs.concat(action.posts);\n      Blogs.emitChange();\n      break;\n    case ActionTypes.UPDATE_BLOG:\n      action.posts.forEach((post)=>{\n        if(post.deleted){\n          let nBlog = [];\n          blogs.forEach((blog)=>{\n            if(blog.id != post.id){\n              nBlog.push(blog);\n            }\n          })\n          blogs = nBlog;\n        }else{\n          let idx = blogs.map(blog=> blog.id).indexOf(post.id);\n          if(idx != -1){\n            let nBlog = [];\n            blogs.forEach((blog)=>{\n              if(blog.id != post.id){\n                nBlog.push(blog);\n              }else{\n                nBlog.push(post);\n              }\n            });\n            blogs = nBlog;\n          }else{\n            blogs = blogs.concat([post]);\n          }\n        }\n      });\n      Blogs.emitChange();\n      break;\n    case ActionTypes.DESTROY_BLOG:\n      let nBlog = [];\n      blogs.forEach((blog)=>{\n        if(blog.id != action.post.id){\n          nBlog.push(blog);\n        }\n      });\n      blogs = nBlog;\n      Blogs.emitChange();\n      break;\n  }\n});\n\nexport default Blogs;\n\n\n\nBlogsActionCreators.js\n//ActionCreator\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport BlogConstants from '../constants/BlogConstants';\nimport request from 'superagent';\n\nconst ActionTypes = BlogConstants.ActionTypes;\n\nconst Action = {\n  createBlog(post,fn){\n    request.post(\"/posts\").send(post).set('Accept', 'application/json').end((err,res)=>{\n      if(err){\n        alert(err.message);\n      }\n      AppDispatcher.dispatch({\n        type: ActionTypes.UPDATE_BLOG,\n        posts: [res.body]\n      });\n      fn();\n    })\n  },\n  updateBlog(post,fn){\n    post[\"_method\"] = \"put\"\n    request.post(\"/posts/\" + post.id).send(post).set('Accept', 'application/json').end((err,res)=>{\n      if(err){\n        alert(err.message);\n      }\n      AppDispatcher.dispatch({\n        type: ActionTypes.UPDATE_BLOG,\n        posts: [res.body]\n      });\n      fn();\n    })\n  },\n  destroyBlog(post){\n    request.post(\"/posts/\" + post.id).send({_method: \"DELETE\"}).set('Accept', 'application/json').end((err,res)=>{\n      AppDispatcher.dispatch({\n        type: ActionTypes.DESTROY_BLOG,\n        post: post\n      });\n    })\n  },\n  initial(posts){\n    AppDispatcher.dispatch({\n      type: ActionTypes.RECEIVE_BLOG,\n      posts: posts\n    });\n    var socket = io.connect(\"http://localhost:3000/posts\")\n    socket.on('connect', ()=>{\n      socket.on(\"post\", (msg)=>{\n        AppDispatcher.dispatch({\n          type: ActionTypes.UPDATE_BLOG,\n          posts: JSON.parse(msg)\n        });\n      })\n    });\n  }\n};\n\nexport default Action;\n\n\nBackbone.js\u306e\u307b\u3046\u306f\u3001\u521d\u671f\u51e6\u7406\u6642\u306blisten\u304crouter\u304b\u3089\u547c\u3070\u308c\u308b\u306e\u3067\u3001\u305d\u306e\u969b\u306bsocket.io\u306b\u30a4\u30d9\u30f3\u30c8\u30ea\u30b9\u30ca\u30fc\u3092\u767b\u9332\u3057\u3066\u3001Socket.IO\u30b5\u30fc\u30d0\u304b\u3089\u30a4\u30d9\u30f3\u30c8\u304c\u3042\u308b\u3054\u3068\u306bBackbone.js\u3088\u308a\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u66f4\u65b0\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3053\u3068\u3067\u66f4\u65b0\u3068\u5171\u306b\u81ea\u52d5\u7684\u306b\u66f4\u65b0\u5185\u5bb9\u306b\u5fdc\u3058\u305f\u30a4\u30d9\u30f3\u30c8\u306e\u767a\u884c\u304c\u884c\u308f\u308c\u307e\u3059\u3002\nReact.js\u306fFlux\u3068\u547c\u3070\u308c\u308b\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3067\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\nDispatcher\u3068\u547c\u3070\u308c\u308bSingleton\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u5bfe\u3057\u3066Store(Model\u3063\u307d\u3044\u306a\u306b\u304b)\u304c\u3001\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u767b\u9332\u3057\u307e\u3059\u3002\nStore\u306fDispatcher\u304b\u3089\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u547c\u3070\u308c\u305f\u6642\u306e\u307f\u3001\u81ea\u8eab\u306e\u30c7\u30fc\u30bf\u3092\u66f4\u65b0\u3057\u307e\u3059\u3002\nStore\u306e\u5143\u3068\u306a\u308b\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u306fActionCreator\u3068\u547c\u3070\u308c\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u62c5\u5f53\u3057\u307e\u3059\u3002\nActionCreator\u306fWeb\u30b5\u30fc\u30d0\u3001SocktIO\u30b5\u30fc\u30d0\u3001LocalStorage etc.\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u3001Dispacher\u306edispach\u30e1\u30bd\u30c3\u30c9\u306b\u30c7\u30fc\u30bf\u3092\u6e21\u3057\u307e\u3059\u3002\ndispach\u30e1\u30bd\u30c3\u30c9\u306b\u6e21\u3055\u308c\u308bActionType\u306f\u30a2\u30d7\u30ea\u3067\u30e6\u30cb\u30fc\u30af\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u5b9a\u6570\u3067\u5b9a\u7fa9\u3055\u308c\u307e\u3059\u3002\nDispacher\u306fdispach\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3070\u308c\u308b\u3068\u3001\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u3059\u3079\u3066\u306eStore\u306e\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u547c\u3076\u306e\u3067\u3001Store\u306f\u81ea\u5206\u304c\u95a2\u5fc3\u306e\u3042\u308bActionType\u306e\u5834\u5408\u306e\u307f\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u30c7\u30fc\u30bf\u306e\u66f4\u65b0\u306fActionCreator->Dispacher->Store\u306e\u4e00\u65b9\u901a\u884c\u3067\u3042\u308b\u3053\u3068\u304c\u4fdd\u8a3c\u3055\u308c\u308b\u305f\u3081\u3001\u30c7\u30d0\u30c3\u30b0\u3082Store\u306e\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u306b\u6ce8\u76ee\u3059\u308c\u3070\u3044\u3044\u3060\u3051\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u3067\u3042\u308bStore\u306f\u3001\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u65b9\u6cd5\u3092\u610f\u8b58\u3057\u306a\u304f\u3066\u3059\u3080\u305f\u3081\u3001\u30c6\u30b9\u30c8\u304c\u7c21\u5358\u306b\u66f8\u3051\u307e\u3059\u3002\nReact.js\u306e\u307b\u3046\u306f\u9577\u3044\u3067\u3059\u304c\u3001Boilerplate\u304c\u63d0\u4f9b\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308b\u3068\u304b\u306a\u308a\u77ed\u304f\u306a\u308b\u306f\u305a\u3067\u3059\u3002\n\nView VS Component\nBackbone.js\n\nposts_index_view.js.coffee\nBlog.Views.Posts ||= {}\nclass Blog.Views.Posts.IndexView extends Backbone.View\n  template: JST[\"templates/posts/index\"]\n\n  initialize: () ->\n    @childViews = []\n    @listenTo(@collection,'add', @addOne)\n\n  addAll: () =>\n    @collection.each(@addOne)\n\n  addOne: (post) =>\n    view = new Blog.Views.Posts.PostView({model : post})\n    @el.getElementsByTagName(\"tbody\")[0].appendChild(view.render().el)\n    @childViews.push(view)\n\n  remove: ()->\n    _.each(@childViews,(view)->\n      view.remove()\n    )\n    super()\n\n  render: =>\n    @el.innerHTML = @template()\n    @addAll()\n    @\n\n\n\nindex.jst.ejs\n<h1>Listing posts</h1>\n\n<table id=\"posts-table\">\n  <thead>\n    <tr>\n      <th>Title</th>\n      <th>Content</th>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n<br>\n<a href=\"#/new\">New Post</a>\n\n\n\npost_view.js.coffee\n\nBlog.Views.Posts ||= {}\n\nclass Blog.Views.Posts.PostView extends Backbone.View\n  template: JST[\"templates/posts/post\"]\n\n  events:\n    \"click .destroy\" : \"destroy\"\n\n  tagName: \"tr\"\n\n  initialize: ()->\n    @listenTo(@model,'destroy', @remove)\n    @listenTo(@model,'change', @render)\n\n  destroy: (e) ->\n    e.preventDefault()\n    e.stopPropagation()\n    @model.destroy()\n    window.router.navigate(\"/index\",{trigger: true})\n\n  render: ->\n    @el.innerHTML = @template(@model.toJSON())\n    return this\n\n\n\npost.jst.ejs\n<td><%= title %></td>\n<td><%= content %></td>\n<td><a href=\"#/<%= id %>\">Show</a></td>\n<td><a href=\"#/<%= id %>/edit\">Edit</a></td>\n<td><a href=\"#/<%= id %>/destroy\" class=\"destroy\">Destroy</a></td>\n\n\nReact.js\n\nBlog.js\nimport React from 'react';\nimport BlogsStore from '../stores/Blogs';\nimport BlogHeader from './BlogHeader';\nimport { Link } from 'react-router'\nclass Blog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.onChangeFunc = this._onChange.bind(this)\n    this.state = {\n      blogs: BlogsStore.all()\n    }\n  }\n  componentDidMount() {\n    BlogsStore.addChangeListener(this.onChangeFunc);\n  }\n  componentWillUnmount() {\n    BlogsStore.removeChangeListener(this.onChangeFunc);\n  }\n  _onChange() {\n    this.setState({ blogs: BlogsStore.all()});\n  }\n  render() {\n    return (\n      <div>\n      <h1>Listing posts</h1>\n      <table id=\"posts-table\">\n        <thead>\n          <tr>\n            <th>Title</th>\n            <th>Content</th>\n          </tr>\n        </thead>\n        <tbody>\n        {this.state.blogs.map(blog => <BlogHeader key={blog.id} blog={blog} />)}\n        </tbody>\n      </table>\n      <Link to='/new'>New Post</Link>\n      </div>\n    );\n  }\n}\nexport default Blog;\n\n\n\n\nBlogHeader.js\nimport React from 'react';\nimport BlogsActionCreators from '../actions/BlogsActionCreators';\nimport Router from 'react-router'; \nvar Link = Router.Link;\nclass BlogHeader extends React.Component {\n  clickDestroy(){\n    BlogsActionCreators.destroyBlog(this.props.blog);\n  }\n  render() {\n    return (\n      <tr>\n        <td>{this.props.blog.title}</td>\n        <td>{this.props.blog.content}</td>\n        <td><Link to=\"show\" params={{blogId: this.props.blog.id}}>Show</Link></td>\n        <td><Link to=\"edit\" params={{blogId: this.props.blog.id}}>Edit</Link></td>\n        <td><a onClick={this.clickDestroy.bind(this)} className=\"destroy\">Destroy</a></td>\n      </tr>\n    )\n  }\n}\nexport default BlogHeader;\n\n\nBackbone.js\u306e\u5834\u5408\u306f\u3001JST\u3068\u3088\u3070\u308c\u308b\u4ed5\u7d44\u307f\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001View\u3068Template\u3092\u5207\u308a\u96e2\u3059\u3053\u3068\u304c\u3067\u304d\u3001\u304b\u3064Compile\u6642\u306bTemplate\u3092js\u306e\u30e1\u30bd\u30c3\u30c9\u306b\u5909\u63db\u3057\u3066\u304f\u308c\u308b\u305f\u3081\u3001\u63cf\u753b\u901f\u5ea6\u3082\u901f\u3044\u3067\u3059\u3002\n\u307e\u305fTemplete\u3092ejs\u7b49\u306e\u7d20\u306eHTML\u306b\u8fd1\u304f\u3059\u308b\u3053\u3068\u3067\u3001\u30c7\u30b6\u30a4\u30ca\u30fc\u306e\u65b9\u304cTemplate\u306b\u5bfe\u3057\u3066\u76f4\u63a5\u4fee\u6b63\u3057\u3066\u30c7\u30b6\u30a4\u30f3\u3092\u53cd\u6620\u3057\u3066\u3044\u305f\u3060\u304f\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u5404view\u3067\u306fCollection\u3082\u3057\u304f\u306fModel\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u3057\u3066ListenTo\u3068\u3044\u3046\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u767b\u9332\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u3001View\u306b\u5bfe\u3057\u3066remove\u3092\u547c\u3073\u3060\u3057\u305f\u969b\u306b\u81ea\u52d5\u7684\u306b\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u89e3\u9664\u3057\u3066\u3082\u3089\u3048\u307e\u3059\u3002\nReact.js\u306e\u5834\u5408\u306f\u3001Backbone.js\u3067\u8a00\u3046View\u3068Template\u304c\u4e00\u7dd2\u306b\u306a\u3063\u305f\u3082\u306e\u3092Component\u3068\u547c\u3073\u307e\u3059\u3002\n\u89aa\u306eComponent\u306b\u304a\u3044\u3066\u3001Store\u306e\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u767b\u9332\u3057\u3001state(\u5909\u66f4\u53ef\u80fd\u306a\u5909\u6570)\u306b\u5024\u3092\u30bb\u30c3\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\u5b50\u306eComponent\u306e\u5834\u5408\u306f\u3001\u89aaComponent\u304b\u3089props(\u5909\u66f4\u4e0d\u53ef\u306a\u5909\u6570)\u3068\u3057\u3066\u6e21\u3055\u308c\u305f\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u63cf\u753b\u3059\u308b\u3053\u3068\u306b\u96c6\u4e2d\u3059\u308b\u3060\u3051\u3067\u3088\u304f\u306a\u308b\u305f\u3081\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u4f7f\u3044\u56de\u3057\u304c\u3057\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\u753b\u9762\u5185\u3067\u30a4\u30d9\u30f3\u30c8\u304c\u8d77\u304d\u305f\u5834\u5408\u3082\u3001ActionCreator\u306b\u5bfe\u3057\u3066\u9069\u5207\u306a\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u3060\u3051\u3068\u306a\u308a\u307e\u3059\u3002\nStore\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u89aaComponent\u304b\u3089\u307e\u308b\u3063\u3068\u63cf\u753b\u51e6\u7406\u304c\u3055\u308c\u307e\u3059\u304c\u3001VirtualDOM\u306e\u6069\u6075\u306b\u3088\u308a\u3001\u5b9fDOM\u306b\u5bfe\u3057\u3066\u5909\u66f4\u5206\u306e\u307f\u66f4\u65b0\u304c\u8d70\u308b\u306e\u3067\u3001\u307e\u308b\u3063\u3068\u63cf\u753b\u51e6\u7406\u3092\u3057\u3066\u3082\u554f\u984c\u304c\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u305d\u306e\u4ed6\n\n\n\n\u30a2\u30d7\u30ea\nsize\n\u521d\u671fload\u6642\u9593\n2\u56de\u76ee\u4ee5\u964dload\u6642\u9593\n\u30d5\u30a1\u30a4\u30eb\u6570\n\u884c\u6570\n\n\n\n\nBackbone.js\n119K\n565ms\n288ms\n12\n240\n\n\nReact.js\n314K\n714ms\n382ms\n9\n335\n\n\n\nBackbone.js\u306fVer1.2\u4ee5\u964d\u3092\u4f7f\u3063\u3066\u3001jQuery\u306e\u4f9d\u5b58\u3092\u306a\u304f\u3057\u307e\u3057\u305f\u3002\n\u5404js\u306b\u306f\u3001socket.io.js(\u30b5\u30a4\u30ba 64K)\u304c\u542b\u307e\u308c\u307e\u3059\u3002\n\nReact.js\u3067\u3044\u3044\u3068\u601d\u3046\u3068\u3053\u308d\n\n\u30e2\u30b8\u30e5\u30e9\u30d3\u30ea\u30c6\u30a3\u304c\u9ad8\u304f\u3001\u5f79\u5272\u3054\u3068\u306b\u8a18\u8ff0\u3059\u308b\u5834\u6240\u304c\u306f\u3063\u304d\u308a\u3057\u3066\u3044\u308b\u306e\u3067\u3001Debug\u304c\u3057\u3084\u3059\u304b\u3063\u305f\u308a\u3001\u30d7\u30ed\u30b0\u30e9\u30de\u3054\u3068\u306b\u3088\u308b\u30d0\u30e9\u30c4\u30ad\u3092\u6e1b\u3089\u305b\u3001\u4fdd\u5b88\u304c\u3057\u3084\u3059\u3044\u3002\nVirtual DOM\u3084RootComponent\u4ee5\u5916\u306f\u30c7\u30fc\u30bf\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u6c17\u306b\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u3068\u3044\u3046\u4ed5\u7d44\u307f\u306b\u3088\u308a\u3001Browser\u3060\u3051\u3067\u306a\u304f\u3001\u30b5\u30fc\u30d0\u5074\u3068\u5b9f\u88c5\u3092\u5171\u901a\u5316\u3067\u304d\u305f\u308a(Isomorphic)\u3001\u30a2\u30d7\u30ea\u3068\u3057\u3066\u52d5\u4f5c\u3055\u305b\u308b\u5b9f\u88c5(React Native)\u304c\u3042\u308b\u3002\nRoot Component\u4ee5\u5916\u306fModel\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u610f\u8b58\u305b\u305a\u3001immutable\u306a\u5909\u6570\u3092\u4f7f\u3046\u306e\u3067\u3001Component\u306e\u6d41\u7528\u6027\u304c\u9ad8\u3044\u3002\n\n\nReact.js\u306e\u61f8\u5ff5\n\njs\u306e\u30b5\u30a4\u30ba\u3084\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u901f\u5ea6\u304c\u30e2\u30d0\u30a4\u30eb\u3060\u3068\u3069\u3046\u304b\uff1f\nCanvas\u3092\u4f7f\u3063\u3066\u63cf\u753b\u3092\u3057\u3066\u3044\u308b\u30a2\u30d7\u30ea\u306b\u306f\u4f7f\u3048\u306a\u3044\u306e\u3067\u306f?\n\u5909\u66f4\u304c\u3042\u3063\u305f\u7b87\u6240\u306b\u5bfe\u3057\u3066Animation\u3055\u305b\u308b\u3068\u3044\u3063\u305f\u3053\u3068\u304c\u96e3\u3057\u3044\u306e\u3067\u306f\uff1f\ntouch\u7cfb\u306e\u7d30\u304b\u3044\u30a4\u30d9\u30f3\u30c8\u5236\u5fa1\u304c\u5927\u5909\u305d\u3046\u3002\njs\u306e\u9045\u5ef6\u30ed\u30fc\u30c9\u304c\u96e3\u3057\u305d\u3046\u3002\n\u30c7\u30b6\u30a4\u30ca\u30fc\u3068\u306e\u9023\u643a\u304c\u9762\u5012\u305d\u3046\u3002\n\n\n\u307e\u3068\u3081\nReact.js\n\u5236\u9650\u304c\u3042\u308b\u4ee3\u308f\u308a\u306b\u30b7\u30f3\u30d7\u30eb\u3002\nFlux\u306e\u4ed5\u7d44\u307f\u306b\u3088\u308a\u30b7\u30f3\u30d7\u30eb\u306b\u5b9f\u88c5\u3092\u69cb\u7bc9\u3067\u304d\u305f\u308a\u3001\u4fbf\u5229\u306aComponent\u304c\u6d41\u7528\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u3001Client\u5074\u3067\u3082\u5805\u7262\u306a\u30a2\u30d7\u30ea\u3092\u4f5c\u308c\u308b\u3002\nBackbone.js\n\u8907\u96d1\u306b\u306a\u308a\u3048\u308b\u3051\u3069\u307b\u307c\u5236\u9650\u304c\u306a\u3044\u3002\nCanvas\u3092\u6d3b\u7528\u3057\u305f\u308a\u3001touch\u30a4\u30d9\u30f3\u30c8\u3092\u99c6\u4f7f\u3057\u305f\u308a\u3001JS\u3092\u9045\u5ef6\u30ed\u30fc\u30c9\u3055\u305b\u308b\u306a\u3069\u5feb\u9069\u306a\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u63d0\u4f9b\u3059\u308b\u3088\u3046\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u304c\u3067\u304d\u308b\u3002\n#\u306f\u3058\u3081\u306b\n\n\u666e\u6bb5\u306fBackbone.js\u3067\u30a2\u30d7\u30ea\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001React.js\u306e\u8a55\u5224\u304c\u9ad8\u307e\u3063\u3066\u304d\u3066\u3044\u308b\u306e\u3067\u3001\u7c21\u6613Blog\u3092Backbone.js\u3068React.js\u306e\u4e21\u65b9\u3067\u5b9f\u88c5\u3057\u3066\u3001\u6bd4\u8f03\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nDemo\u3067\u306fjs\u4ee5\u5916\u306f\u540c\u3058\u30b5\u30fc\u30d0\u306eAPI\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u3069\u3061\u3089\u306b\u3082\u53cd\u6620\u3055\u308c\u307e\u3059\u3002\n\n**Backbone.js\u3092\u3064\u304b\u3063\u305f\u30d0\u30fc\u30b8\u30e7\u30f3**\nSource \n https://github.com/takeshy/backbone_socket_io\nDemo\n https://radiant-dawn-8878.herokuapp.com/backbone\n\n**React.js\u3092\u3064\u304b\u3063\u305f\u30d0\u30fc\u30b8\u30e7\u30f3**\nSource\nhttps://github.com/takeshy/react_socket_io\nDemo\n https://radiant-dawn-8878.herokuapp.com/react\n\n#HTML\u90e8\u5206 \n\nBackbone.js\n\n```html:index.ejs\n<!DOCTYPE html>\n<html>\n  <head>\n    <link rel='stylesheet' href='/stylesheets/style.css' />\n    <script type=\"text/javascript\" src=\"/assets/bundle.js\"></script>\n    <script type=\"text/javascript\">\n      window.onload = function(){\n        window.router = new Blog.Routers.PostsRouter(<%- initialData %>);\n      }\n    </script>\n  </head>\n  <body>\n    <div id=\"posts\"></div>\n  </body>\n</html>\n```\n\nReact.js\n\n```html:index.ejs\n<!DOCTYPE html>\n<html>\n  <head>\n    <link rel='stylesheet' href='/stylesheets/style.css' />\n    </script>\n  </head>\n  <body>\n    <div id=\"posts\"></div>\n    <script type=\"text/javascript\" src=\"socket.io.min.js\"></script>\n    <script type=\"text/javascript\" src=\"bundle.js\"></script>\n    <script>\n      reactInitial(<%- initialData %>);\n    </script>\n  </body>\n</html>\n```\n\n\u307b\u307c\u540c\u3058\u3067\u3059\u3002js\u306e\u8aad\u307f\u8fbc\u307f\u3068\u521d\u671f\u547c\u3073\u51fa\u3057\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u307f\u3067\u3059\u3002\n\u521d\u671f\u8868\u793a\u3092\u901f\u304f\u3059\u308b\u305f\u3081\u521d\u671f\u30c7\u30fc\u30bf\u306bjson\u3092\u6e21\u3057\u3066\u3044\u307e\u3059\u3002\nReact.js\u306f\u3001Browserify\u3092\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001socket.io\u304cglobal\u306bio\u304c\u5b9a\u7fa9\u3055\u308c\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u3046\u307e\u304f\u52d5\u4f5c\u3057\u306a\u3044\u305f\u3081\u3001\u5225\u547c\u3073\u51fa\u3057\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n# Router\n\nBackbone.js\n\n```coffeescript:posts_router.js.coffee\nclass Blog.Routers.PostsRouter extends Backbone.Router\n  initialize: (options) ->\n    @posts = new Blog.Collections.PostsCollection(options.posts)\n    @posts.listen(\"http://localhost:3000\")\n    Backbone.history.start()\n\n  draw: (view)->\n    @view.remove() if @view\n    elem = document.getElementById(\"posts\")\n    elem.innerHTML = \"\"\n    elem.appendChild(view.render().el)\n    @view = view\n\n  routes:\n    \"new\"      : \"newPost\"\n    \"index\"    : \"index\"\n    \":id/edit\" : \"edit\"\n    \":id\"      : \"show\"\n    \".*\"        : \"index\"\n\n  index: ->\n    view = new Blog.Views.Posts.IndexView(collection: @posts)\n    @draw(view)\n\n  newPost: ->\n    view = new Blog.Views.Posts.NewView(collection: @posts)\n    @draw(view)\n\n  show: (id) ->\n    view = new Blog.Views.Posts.ShowView(model: @posts.get(id))\n    @draw(view)\n\n  edit: (id) ->\n    view = new Blog.Views.Posts.EditView(model: @posts.get(id))\n    @draw(view)\n```\n\nReact.js\n\n```javascript:index.js\nimport React from 'react';\nimport {} from 'whatwg-fetch';\nimport Blog from './Blog';\nimport NewPost from './NewPost';\nimport Edit from './Edit';\nimport Show from './Show';\nimport { Router, Route } from 'react-router'\nimport BlogsActionCreators from '../actions/BlogsActionCreators';\n\nfunction initial(data){\n  BlogsActionCreators.initial(data.posts);\n  React.render((\n    <Router>\n      <Route path=\"/\" component={Blog}/>\n      <Route component={NewPost} path=\"/new\"/>\n      <Route component={Edit} path=\"/:blogId/edit\"/>\n      <Route component={Show} path=\"/:blogId/show\"/>\n    </Router>\n  ), document.getElementById('posts'));\n}\nwindow.reactInitial = initial;\n```\n\n\u3088\u304f\u4f7f\u308f\u308c\u308b\u7d44\u307f\u5408\u308f\u305b\u306b\u3059\u308b\u305f\u3081\u3001Backbone\u306fCoffeeScript\u3001React.js\u3067\u306fES6\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\nReact.js\u306b\u306fRouter\u6a5f\u80fd\u304c\u306a\u3044\u306e\u3067\u3001\u4e00\u756a\u4f7f\u308f\u308c\u3066\u3044\u308b\u3067\u3042\u308d\u3046React.Router\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nES6\u306b\u3059\u308b\u3068import\u6587\u304c\u305f\u304f\u3055\u3093\u3067\u5927\u5909\u3002IDE\u304c\u3042\u308b\u3068\u4fbf\u5229\u306a\u306e\u3067\u3057\u3087\u3046\u304c\u3001vim\u3060\u3068\u8f9b\u3044\u3067\u3059\u3002\n\u305f\u3060\u3001\u4fdd\u5b88\u6027\u3092\u91cd\u8996\u3057\u3066\u3044\u308bReact.js\u306a\u306e\u3067\u3001\u306f\u3063\u304d\u308a\u30e2\u30b8\u30e5\u30fc\u30eb\u5316\u304c\u3055\u308c\u308bES6\u306e\u307b\u3046\u304c\u4eba\u6c17\u304c\u3042\u308b\u3068\u3044\u3046\u306e\u306f\u308f\u304b\u308b\u6c17\u304c\u3057\u307e\u3059\u3002\nBackbone.js\u306e\u307b\u3046\u306f\u3059\u3063\u304d\u308a\u3057\u3066\u3044\u3066\u898b\u3084\u3059\u3044\u3067\u3059\u304c\u3001\u57fa\u672crouter\u306f1\u3064\u3057\u304b\u4f7f\u308f\u306a\u3044\u306e\u3067\u3001\u6ca2\u5c71\u306e\u30da\u30fc\u30b8\u304c\u5fc5\u8981\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u30bd\u30fc\u30b9\u304c\u9577\u304f\u306a\u308a\u307e\u3059\u3002\n\u5171\u901a\u51e6\u7406\u306f\u5b9f\u884c\u3057\u3084\u3059\u3044\u3067\u3059\u3002\nReact.js\u3067\u3082React.router\u3092\u4f7f\u308f\u305a\u3001Backbone.js\u306eRouter\u3092\u4f7f\u3046\u4eba\u3082\u3044\u308b\u306e\u3067\u3053\u3053\u306e\u6bd4\u8f03\u306f\u3042\u307e\u308a\u610f\u5473\u3092\u306a\u3055\u306a\u3044\u304b\u3082\u3067\u3059\u304c\u3001\u4e00\u822c\u6027\u3067\u6bd4\u8f03\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n# Model VS Dispatcher Store ActionCreator\n\nBackbone.js\n\n``` coffeescript:post.js.coffee\nclass Blog.Models.Post extends Backbone.Model\n  paramRoot: 'post'\n\n  defaults:\n    title: null\n    content: null\n\nclass Blog.Collections.PostsCollection extends Backbone.Collection\n  model: Blog.Models.Post\n  url: '/posts'\n  socket: null\n  listen:(nodeUrl)->\n    @socket = io.connect(nodeUrl + \"/posts\")\n    @socket.on('connect', ()=>\n      @addListener()\n    )\n\n  addListener:()->\n    @socket.on(\"post\", (msg)=>\n      obj = JSON.parse(msg)\n      _.each(obj,(postData)=>\n        if postData.deleted\n          @get(postData[\"id\"])?.destroy()\n        else\n          @add(postData,{merge: true})\n      )\n    )\n```\n\nReact.js\n\n```javascript:AppDispacher.js\n//Dispacher\nimport {Dispatcher} from 'flux';\n\nconst AppDispatcher = new Dispatcher();\n\nexport default AppDispatcher;\n```\n\n\n``` javascript:Blogs.js\n//Store\nimport {EventEmitter} from 'events';\nimport assign from 'object-assign';\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport BlogConstants from '../constants/BlogConstants';\n\nconst ActionTypes = BlogConstants.ActionTypes;\nconst CHANGE_EVENT = 'change';\nlet blogs = [];\n\nconst Blogs = assign({}, EventEmitter.prototype, {\n  emitChange() {\n    this.emit(CHANGE_EVENT);\n  },\n  addChangeListener(callback) {\n    this.on(CHANGE_EVENT, callback);\n  },\n  removeChangeListener(callback) {\n    this.removeListener(CHANGE_EVENT, callback);\n  },\n  all(){\n    return blogs.concat([])\n  },\n  find(id){\n    for(let i=0;i<blogs.length;i++){\n      let blog = blogs[i];\n      if(blog.id == id){\n        return blog;\n      }\n    }\n    return null;\n  }\n});\n\nBlogs.dispatchToken = AppDispatcher.register(action => {\n\n  switch (action.type) {\n    case ActionTypes.RECEIVE_BLOG:\n      blogs = blogs.concat(action.posts);\n      Blogs.emitChange();\n      break;\n    case ActionTypes.UPDATE_BLOG:\n      action.posts.forEach((post)=>{\n        if(post.deleted){\n          let nBlog = [];\n          blogs.forEach((blog)=>{\n            if(blog.id != post.id){\n              nBlog.push(blog);\n            }\n          })\n          blogs = nBlog;\n        }else{\n          let idx = blogs.map(blog=> blog.id).indexOf(post.id);\n          if(idx != -1){\n            let nBlog = [];\n            blogs.forEach((blog)=>{\n              if(blog.id != post.id){\n                nBlog.push(blog);\n              }else{\n                nBlog.push(post);\n              }\n            });\n            blogs = nBlog;\n          }else{\n            blogs = blogs.concat([post]);\n          }\n        }\n      });\n      Blogs.emitChange();\n      break;\n    case ActionTypes.DESTROY_BLOG:\n      let nBlog = [];\n      blogs.forEach((blog)=>{\n        if(blog.id != action.post.id){\n          nBlog.push(blog);\n        }\n      });\n      blogs = nBlog;\n      Blogs.emitChange();\n      break;\n  }\n});\n\nexport default Blogs;\n```\n\n\n```javascript:BlogsActionCreators.js\n//ActionCreator\nimport AppDispatcher from '../dispatcher/AppDispatcher';\nimport BlogConstants from '../constants/BlogConstants';\nimport request from 'superagent';\n\nconst ActionTypes = BlogConstants.ActionTypes;\n\nconst Action = {\n  createBlog(post,fn){\n    request.post(\"/posts\").send(post).set('Accept', 'application/json').end((err,res)=>{\n      if(err){\n        alert(err.message);\n      }\n      AppDispatcher.dispatch({\n        type: ActionTypes.UPDATE_BLOG,\n        posts: [res.body]\n      });\n      fn();\n    })\n  },\n  updateBlog(post,fn){\n    post[\"_method\"] = \"put\"\n    request.post(\"/posts/\" + post.id).send(post).set('Accept', 'application/json').end((err,res)=>{\n      if(err){\n        alert(err.message);\n      }\n      AppDispatcher.dispatch({\n        type: ActionTypes.UPDATE_BLOG,\n        posts: [res.body]\n      });\n      fn();\n    })\n  },\n  destroyBlog(post){\n    request.post(\"/posts/\" + post.id).send({_method: \"DELETE\"}).set('Accept', 'application/json').end((err,res)=>{\n      AppDispatcher.dispatch({\n        type: ActionTypes.DESTROY_BLOG,\n        post: post\n      });\n    })\n  },\n  initial(posts){\n    AppDispatcher.dispatch({\n      type: ActionTypes.RECEIVE_BLOG,\n      posts: posts\n    });\n    var socket = io.connect(\"http://localhost:3000/posts\")\n    socket.on('connect', ()=>{\n      socket.on(\"post\", (msg)=>{\n        AppDispatcher.dispatch({\n          type: ActionTypes.UPDATE_BLOG,\n          posts: JSON.parse(msg)\n        });\n      })\n    });\n  }\n};\n\nexport default Action;\n```\n\nBackbone.js\u306e\u307b\u3046\u306f\u3001\u521d\u671f\u51e6\u7406\u6642\u306blisten\u304crouter\u304b\u3089\u547c\u3070\u308c\u308b\u306e\u3067\u3001\u305d\u306e\u969b\u306bsocket.io\u306b\u30a4\u30d9\u30f3\u30c8\u30ea\u30b9\u30ca\u30fc\u3092\u767b\u9332\u3057\u3066\u3001Socket.IO\u30b5\u30fc\u30d0\u304b\u3089\u30a4\u30d9\u30f3\u30c8\u304c\u3042\u308b\u3054\u3068\u306bBackbone.js\u3088\u308a\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u66f4\u65b0\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3046\u3053\u3068\u3067\u66f4\u65b0\u3068\u5171\u306b\u81ea\u52d5\u7684\u306b\u66f4\u65b0\u5185\u5bb9\u306b\u5fdc\u3058\u305f\u30a4\u30d9\u30f3\u30c8\u306e\u767a\u884c\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\nReact.js\u306fFlux\u3068\u547c\u3070\u308c\u308b\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3067\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\nDispatcher\u3068\u547c\u3070\u308c\u308bSingleton\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u5bfe\u3057\u3066Store(Model\u3063\u307d\u3044\u306a\u306b\u304b)\u304c\u3001\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u767b\u9332\u3057\u307e\u3059\u3002\nStore\u306fDispatcher\u304b\u3089\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u547c\u3070\u308c\u305f\u6642\u306e\u307f\u3001\u81ea\u8eab\u306e\u30c7\u30fc\u30bf\u3092\u66f4\u65b0\u3057\u307e\u3059\u3002\nStore\u306e\u5143\u3068\u306a\u308b\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u306fActionCreator\u3068\u547c\u3070\u308c\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u62c5\u5f53\u3057\u307e\u3059\u3002\nActionCreator\u306fWeb\u30b5\u30fc\u30d0\u3001SocktIO\u30b5\u30fc\u30d0\u3001LocalStorage etc.\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u3001Dispacher\u306edispach\u30e1\u30bd\u30c3\u30c9\u306b\u30c7\u30fc\u30bf\u3092\u6e21\u3057\u307e\u3059\u3002\ndispach\u30e1\u30bd\u30c3\u30c9\u306b\u6e21\u3055\u308c\u308bActionType\u306f\u30a2\u30d7\u30ea\u3067\u30e6\u30cb\u30fc\u30af\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u3001\u5b9a\u6570\u3067\u5b9a\u7fa9\u3055\u308c\u307e\u3059\u3002\nDispacher\u306fdispach\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3070\u308c\u308b\u3068\u3001\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u3059\u3079\u3066\u306eStore\u306e\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u547c\u3076\u306e\u3067\u3001Store\u306f\u81ea\u5206\u304c\u95a2\u5fc3\u306e\u3042\u308bActionType\u306e\u5834\u5408\u306e\u307f\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u306b\u3088\u308a\u30c7\u30fc\u30bf\u306e\u66f4\u65b0\u306fActionCreator->Dispacher->Store\u306e\u4e00\u65b9\u901a\u884c\u3067\u3042\u308b\u3053\u3068\u304c\u4fdd\u8a3c\u3055\u308c\u308b\u305f\u3081\u3001\u30c7\u30d0\u30c3\u30b0\u3082Store\u306e\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u306b\u6ce8\u76ee\u3059\u308c\u3070\u3044\u3044\u3060\u3051\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u3067\u3042\u308bStore\u306f\u3001\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u65b9\u6cd5\u3092\u610f\u8b58\u3057\u306a\u304f\u3066\u3059\u3080\u305f\u3081\u3001\u30c6\u30b9\u30c8\u304c\u7c21\u5358\u306b\u66f8\u3051\u307e\u3059\u3002\n\nReact.js\u306e\u307b\u3046\u306f\u9577\u3044\u3067\u3059\u304c\u3001Boilerplate\u304c\u63d0\u4f9b\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308b\u3068\u304b\u306a\u308a\u77ed\u304f\u306a\u308b\u306f\u305a\u3067\u3059\u3002\n\n#View VS Component\n\nBackbone.js\n\n```coffeescript:posts_index_view.js.coffee\nBlog.Views.Posts ||= {}\nclass Blog.Views.Posts.IndexView extends Backbone.View\n  template: JST[\"templates/posts/index\"]\n\n  initialize: () ->\n    @childViews = []\n    @listenTo(@collection,'add', @addOne)\n\n  addAll: () =>\n    @collection.each(@addOne)\n\n  addOne: (post) =>\n    view = new Blog.Views.Posts.PostView({model : post})\n    @el.getElementsByTagName(\"tbody\")[0].appendChild(view.render().el)\n    @childViews.push(view)\n\n  remove: ()->\n    _.each(@childViews,(view)->\n      view.remove()\n    )\n    super()\n\n  render: =>\n    @el.innerHTML = @template()\n    @addAll()\n    @\n```\n\n\n```html:index.jst.ejs\n<h1>Listing posts</h1>\n\n<table id=\"posts-table\">\n  <thead>\n    <tr>\n      <th>Title</th>\n      <th>Content</th>\n  </thead>\n  <tbody>\n  </tbody>\n</table>\n<br>\n<a href=\"#/new\">New Post</a>\n```\n\n\n``` coffeescript:post_view.js.coffee\n\nBlog.Views.Posts ||= {}\n\nclass Blog.Views.Posts.PostView extends Backbone.View\n  template: JST[\"templates/posts/post\"]\n\n  events:\n    \"click .destroy\" : \"destroy\"\n\n  tagName: \"tr\"\n\n  initialize: ()->\n    @listenTo(@model,'destroy', @remove)\n    @listenTo(@model,'change', @render)\n\n  destroy: (e) ->\n    e.preventDefault()\n    e.stopPropagation()\n    @model.destroy()\n    window.router.navigate(\"/index\",{trigger: true})\n\n  render: ->\n    @el.innerHTML = @template(@model.toJSON())\n    return this\n```\n\n\n```html:post.jst.ejs\n<td><%= title %></td>\n<td><%= content %></td>\n<td><a href=\"#/<%= id %>\">Show</a></td>\n<td><a href=\"#/<%= id %>/edit\">Edit</a></td>\n<td><a href=\"#/<%= id %>/destroy\" class=\"destroy\">Destroy</a></td>\n```\n\nReact.js\n\n```javascript:Blog.js\nimport React from 'react';\nimport BlogsStore from '../stores/Blogs';\nimport BlogHeader from './BlogHeader';\nimport { Link } from 'react-router'\nclass Blog extends React.Component {\n  constructor(props) {\n    super(props);\n    this.onChangeFunc = this._onChange.bind(this)\n    this.state = {\n      blogs: BlogsStore.all()\n    }\n  }\n  componentDidMount() {\n    BlogsStore.addChangeListener(this.onChangeFunc);\n  }\n  componentWillUnmount() {\n    BlogsStore.removeChangeListener(this.onChangeFunc);\n  }\n  _onChange() {\n    this.setState({ blogs: BlogsStore.all()});\n  }\n  render() {\n    return (\n      <div>\n      <h1>Listing posts</h1>\n      <table id=\"posts-table\">\n        <thead>\n          <tr>\n            <th>Title</th>\n            <th>Content</th>\n          </tr>\n        </thead>\n        <tbody>\n        {this.state.blogs.map(blog => <BlogHeader key={blog.id} blog={blog} />)}\n        </tbody>\n      </table>\n      <Link to='/new'>New Post</Link>\n      </div>\n    );\n  }\n}\nexport default Blog;\n\n```\n\n```javascript:BlogHeader.js\nimport React from 'react';\nimport BlogsActionCreators from '../actions/BlogsActionCreators';\nimport Router from 'react-router'; \nvar Link = Router.Link;\nclass BlogHeader extends React.Component {\n  clickDestroy(){\n    BlogsActionCreators.destroyBlog(this.props.blog);\n  }\n  render() {\n    return (\n      <tr>\n        <td>{this.props.blog.title}</td>\n        <td>{this.props.blog.content}</td>\n        <td><Link to=\"show\" params={{blogId: this.props.blog.id}}>Show</Link></td>\n        <td><Link to=\"edit\" params={{blogId: this.props.blog.id}}>Edit</Link></td>\n        <td><a onClick={this.clickDestroy.bind(this)} className=\"destroy\">Destroy</a></td>\n      </tr>\n    )\n  }\n}\nexport default BlogHeader;\n```\n\nBackbone.js\u306e\u5834\u5408\u306f\u3001JST\u3068\u3088\u3070\u308c\u308b\u4ed5\u7d44\u307f\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001View\u3068Template\u3092\u5207\u308a\u96e2\u3059\u3053\u3068\u304c\u3067\u304d\u3001\u304b\u3064Compile\u6642\u306bTemplate\u3092js\u306e\u30e1\u30bd\u30c3\u30c9\u306b\u5909\u63db\u3057\u3066\u304f\u308c\u308b\u305f\u3081\u3001\u63cf\u753b\u901f\u5ea6\u3082\u901f\u3044\u3067\u3059\u3002\n\u307e\u305fTemplete\u3092ejs\u7b49\u306e\u7d20\u306eHTML\u306b\u8fd1\u304f\u3059\u308b\u3053\u3068\u3067\u3001\u30c7\u30b6\u30a4\u30ca\u30fc\u306e\u65b9\u304cTemplate\u306b\u5bfe\u3057\u3066\u76f4\u63a5\u4fee\u6b63\u3057\u3066\u30c7\u30b6\u30a4\u30f3\u3092\u53cd\u6620\u3057\u3066\u3044\u305f\u3060\u304f\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u5404view\u3067\u306fCollection\u3082\u3057\u304f\u306fModel\u306e\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u3057\u3066ListenTo\u3068\u3044\u3046\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u767b\u9332\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u3001View\u306b\u5bfe\u3057\u3066remove\u3092\u547c\u3073\u3060\u3057\u305f\u969b\u306b\u81ea\u52d5\u7684\u306b\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u89e3\u9664\u3057\u3066\u3082\u3089\u3048\u307e\u3059\u3002\n\nReact.js\u306e\u5834\u5408\u306f\u3001Backbone.js\u3067\u8a00\u3046View\u3068Template\u304c\u4e00\u7dd2\u306b\u306a\u3063\u305f\u3082\u306e\u3092Component\u3068\u547c\u3073\u307e\u3059\u3002\n\u89aa\u306eComponent\u306b\u304a\u3044\u3066\u3001Store\u306e\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u3092\u767b\u9332\u3057\u3001state(\u5909\u66f4\u53ef\u80fd\u306a\u5909\u6570)\u306b\u5024\u3092\u30bb\u30c3\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\u5b50\u306eComponent\u306e\u5834\u5408\u306f\u3001\u89aaComponent\u304b\u3089props(\u5909\u66f4\u4e0d\u53ef\u306a\u5909\u6570)\u3068\u3057\u3066\u6e21\u3055\u308c\u305f\u30c7\u30fc\u30bf\u3092\u4f7f\u3063\u3066\u63cf\u753b\u3059\u308b\u3053\u3068\u306b\u96c6\u4e2d\u3059\u308b\u3060\u3051\u3067\u3088\u304f\u306a\u308b\u305f\u3081\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u4f7f\u3044\u56de\u3057\u304c\u3057\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\u753b\u9762\u5185\u3067\u30a4\u30d9\u30f3\u30c8\u304c\u8d77\u304d\u305f\u5834\u5408\u3082\u3001ActionCreator\u306b\u5bfe\u3057\u3066\u9069\u5207\u306a\u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\u3060\u3051\u3068\u306a\u308a\u307e\u3059\u3002\nStore\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u89aaComponent\u304b\u3089\u307e\u308b\u3063\u3068\u63cf\u753b\u51e6\u7406\u304c\u3055\u308c\u307e\u3059\u304c\u3001VirtualDOM\u306e\u6069\u6075\u306b\u3088\u308a\u3001\u5b9fDOM\u306b\u5bfe\u3057\u3066\u5909\u66f4\u5206\u306e\u307f\u66f4\u65b0\u304c\u8d70\u308b\u306e\u3067\u3001\u307e\u308b\u3063\u3068\u63cf\u753b\u51e6\u7406\u3092\u3057\u3066\u3082\u554f\u984c\u304c\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n#\u305d\u306e\u4ed6\n\n\n|\u30a2\u30d7\u30ea  | size | \u521d\u671fload\u6642\u9593 | 2\u56de\u76ee\u4ee5\u964dload\u6642\u9593|\u30d5\u30a1\u30a4\u30eb\u6570|\u884c\u6570|\n|:----|-----:|:------------:|:----------------:|:--------:|:---|\n|Backbone.js|119K|565ms|288ms|12|240|\n|React.js|314K|714ms|382ms|9|335|\n\n\n_Backbone.js\u306fVer1.2\u4ee5\u964d\u3092\u4f7f\u3063\u3066\u3001jQuery\u306e\u4f9d\u5b58\u3092\u306a\u304f\u3057\u307e\u3057\u305f\u3002_\n_\u5404js\u306b\u306f\u3001socket.io.js(\u30b5\u30a4\u30ba 64K)\u304c\u542b\u307e\u308c\u307e\u3059\u3002_\n\n\n# React.js\u3067\u3044\u3044\u3068\u601d\u3046\u3068\u3053\u308d\n\n1. \u30e2\u30b8\u30e5\u30e9\u30d3\u30ea\u30c6\u30a3\u304c\u9ad8\u304f\u3001\u5f79\u5272\u3054\u3068\u306b\u8a18\u8ff0\u3059\u308b\u5834\u6240\u304c\u306f\u3063\u304d\u308a\u3057\u3066\u3044\u308b\u306e\u3067\u3001Debug\u304c\u3057\u3084\u3059\u304b\u3063\u305f\u308a\u3001\u30d7\u30ed\u30b0\u30e9\u30de\u3054\u3068\u306b\u3088\u308b\u30d0\u30e9\u30c4\u30ad\u3092\u6e1b\u3089\u305b\u3001\u4fdd\u5b88\u304c\u3057\u3084\u3059\u3044\u3002\n\n1. Virtual DOM\u3084RootComponent\u4ee5\u5916\u306f\u30c7\u30fc\u30bf\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u6c17\u306b\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u3068\u3044\u3046\u4ed5\u7d44\u307f\u306b\u3088\u308a\u3001Browser\u3060\u3051\u3067\u306a\u304f\u3001\u30b5\u30fc\u30d0\u5074\u3068\u5b9f\u88c5\u3092\u5171\u901a\u5316\u3067\u304d\u305f\u308a(Isomorphic)\u3001\u30a2\u30d7\u30ea\u3068\u3057\u3066\u52d5\u4f5c\u3055\u305b\u308b\u5b9f\u88c5(React Native)\u304c\u3042\u308b\u3002\n\n1. Root Component\u4ee5\u5916\u306fModel\u306e\u30a4\u30d9\u30f3\u30c8\u3092\u610f\u8b58\u305b\u305a\u3001immutable\u306a\u5909\u6570\u3092\u4f7f\u3046\u306e\u3067\u3001Component\u306e\u6d41\u7528\u6027\u304c\u9ad8\u3044\u3002\n\n# React.js\u306e\u61f8\u5ff5\n\n1. js\u306e\u30b5\u30a4\u30ba\u3084\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u901f\u5ea6\u304c\u30e2\u30d0\u30a4\u30eb\u3060\u3068\u3069\u3046\u304b\uff1f\n\n1. Canvas\u3092\u4f7f\u3063\u3066\u63cf\u753b\u3092\u3057\u3066\u3044\u308b\u30a2\u30d7\u30ea\u306b\u306f\u4f7f\u3048\u306a\u3044\u306e\u3067\u306f?\n\n1. \u5909\u66f4\u304c\u3042\u3063\u305f\u7b87\u6240\u306b\u5bfe\u3057\u3066Animation\u3055\u305b\u308b\u3068\u3044\u3063\u305f\u3053\u3068\u304c\u96e3\u3057\u3044\u306e\u3067\u306f\uff1f\n\n1. touch\u7cfb\u306e\u7d30\u304b\u3044\u30a4\u30d9\u30f3\u30c8\u5236\u5fa1\u304c\u5927\u5909\u305d\u3046\u3002\n\n1. js\u306e\u9045\u5ef6\u30ed\u30fc\u30c9\u304c\u96e3\u3057\u305d\u3046\u3002\n\n1. \u30c7\u30b6\u30a4\u30ca\u30fc\u3068\u306e\u9023\u643a\u304c\u9762\u5012\u305d\u3046\u3002\n\n#\u307e\u3068\u3081\n**React.js**\n\u5236\u9650\u304c\u3042\u308b\u4ee3\u308f\u308a\u306b\u30b7\u30f3\u30d7\u30eb\u3002\nFlux\u306e\u4ed5\u7d44\u307f\u306b\u3088\u308a\u30b7\u30f3\u30d7\u30eb\u306b\u5b9f\u88c5\u3092\u69cb\u7bc9\u3067\u304d\u305f\u308a\u3001\u4fbf\u5229\u306aComponent\u304c\u6d41\u7528\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u3001Client\u5074\u3067\u3082\u5805\u7262\u306a\u30a2\u30d7\u30ea\u3092\u4f5c\u308c\u308b\u3002\n**Backbone.js**\n\u8907\u96d1\u306b\u306a\u308a\u3048\u308b\u3051\u3069\u307b\u307c\u5236\u9650\u304c\u306a\u3044\u3002\nCanvas\u3092\u6d3b\u7528\u3057\u305f\u308a\u3001touch\u30a4\u30d9\u30f3\u30c8\u3092\u99c6\u4f7f\u3057\u305f\u308a\u3001JS\u3092\u9045\u5ef6\u30ed\u30fc\u30c9\u3055\u305b\u308b\u306a\u3069\u5feb\u9069\u306a\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u63d0\u4f9b\u3059\u308b\u3088\u3046\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u304c\u3067\u304d\u308b\u3002\n", "tags": ["react.js", "Backbone.js", "JavaScript"]}