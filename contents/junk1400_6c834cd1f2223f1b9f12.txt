{"context": " More than 1 year has passed since last update.\n\nSPARK SQL \u3067TSV\u30d5\u30a1\u30a4\u30eb\u3092HDFS\u304b\u3089\u30ed\u30fc\u30c9\u3057\u3066SHOW\u3059\u308b\u3060\u3051\u3002\n\n\u524d\u63d0\u3068\u304b\n\nSPARK\u306f1.6.0\n\u5b9f\u884c\u306fspark-shell\u304b\u3089\u884c\u3046\n--master yarn-client\u3067\u8d77\u52d5\nhdfs\u306f\u8a2d\u5b9a\u6e08(spark-env.sh\u306bHADOOP_CONF_DIR\u8a2d\u5b9a\u6e08)\n\u30c7\u30fc\u30bf\u306f\u56fd\u4f1a\u56f3\u66f8\u9928\u306e\u5168\u56fd\u66f8\u8a8c\uff08\u96fb\u5b50\u66f8\u7c4d\u30fb\u96fb\u5b50\u96d1\u8a8c\u7de8\uff09TSV\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\uff08\u4ee5\u4e0b\u306e\uff09\u30b5\u30a4\u30c8\u306e\u3082\u306e\u3092\u4f7f\u7528\u3059\u308b\nhttp://www.ndl.go.jp/jp/data/data_service/jnb/ebej_tsv.html\n\n\n1.TSV\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066hdfs\u306b\u914d\u7f6e\u3059\u308b\n\nshell\n$ wget http://iss.ndl.go.jp/data/download/digital_20160122.tsv\n$ sudo -i -u hdfs hdfs dfs -put /home/junk/digital_20160122.tsv /home/junk\n\n\n\u30b3\u30d4\u30fc\u5148\u306e/home/junk\u306f\u5148\u306b\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002chmod\u3067\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3082\u4e0e\u3048\u3066\u304a\u304f\u3002\nhdfs\u30b3\u30de\u30f3\u30c9\u3067\u4f7f\u7528\u3059\u308b\u74b0\u5883\u5909\u6570\u306e\u95a2\u4fc2\u3067\u3001\u5f15\u6570\u306b-i\u3092\u4f7f\u3063\u3066\u307e\u3059\u3002\n2.spark-shell\u8d77\u52d5\n\nshell\n$ /usr/local/spark/bin/spark-shell --master yarn-client\nWelcome to\n      ____              __\n     / __/__  ___ _____/ /__\n    _\\ \\/ _ \\/ _ `/ __/  '_/\n   /___/ .__/\\_,_/_/ /_/\\_\\   version 1.6.0\n      /_/\n\nUsing Scala version 2.10.5 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_72)\nType in expressions to have them evaluated.\nType :help for more information.\nscala>\n\n\n3.\u5b9f\u884c\n\nspark-shell\nscala>//tsv\u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30c9\nscala>val bookRDD = sc.textFile(\"/home/junk/digital_20160120.tsv\")\nscala>//case class\u5b9a\u7fa9\nscala>case class Book(NDL_URL: String, ISBN: String, SET_ISBN: String, ISSN: String, ISSN_L: String, DOI: String,\n                NDLIP: String, TITLE: String, NEXT_PART: String, PART_NAME: String, ANOTHER_NAME: String,\n                SERIES_TITLE: String, EDITION: String, AUTHOR: String, PUB: String, PLACE: String, PUB_DATE: String,\n                DATE_RECEIPT: String, TABLE_CONT: String, NOTE: String, LANG: String)\nscala>\nscala>//DataFrame\u3068\u30b9\u30ad\u30fc\u30de\u8a2d\u5b9a\nscala>val bookDF = bookRDD.map { record =>\n         val splitRecord = record.split(\"\\t\",-1)\n         val NDL_URL = splitRecord(0)\n         val ISBN = splitRecord(1)\n         val SET_ISBN = splitRecord(2)\n         val ISSN = splitRecord(3)\n         val ISSN_L = splitRecord(4)\n         val DOI = splitRecord(5)\n         val NDLIP = splitRecord(6)\n         val TITLE = splitRecord(7)\n         val NEXT_PART = splitRecord(8)\n         val PART_NAME = splitRecord(9)\n         val ANOTHER_NAME = splitRecord(10)\n         val SERIES_TITLE = splitRecord(11)\n         val EDITION = splitRecord(12)\n         val AUTHOR = splitRecord(13)\n         val PUB = splitRecord(14)\n         val PLACE = splitRecord(15)\n         val PUB_DATE = splitRecord(16)\n         val DATE_RECEIPT = splitRecord(17)\n         val TABLE_CONT = splitRecord(18)\n         val NOTE = splitRecord(19)\n         val LANG = splitRecord(20)\n         Book(NDL_URL, ISBN, SET_ISBN, ISSN, ISSN_L, DOI, NDLIP, TITLE, NEXT_PART, PART_NAME, \n         ANOTHER_NAME, SERIES_TITLE, EDITION, AUTHOR, PUB, PLACE, PUB_DATE, DATE_RECEIPT,\n         TABLE_CONT, NOTE, LANG)\n    }.toDF\nscala>// \u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306b\uff01\nscala>bookDF.registerTempTable(\"bookdata\")\nscala>// select\u3057\u3066\u307f\u308b\nscala>val bookCountDF = sqlContext.sql(\"SELECT * FROM bookdata\") \nscala>// select\u306e\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\nscala>bookCountDF.show\n+--------------------+----+--------+----+------+---+--------------------+--------------------+---------+---------+--------------------+------------+-------+--------------------+-------------------+-----+---------------+--------------------+----------+--------------------+--------------+\n|             NDL_URL|ISBN|SET_ISBN|ISSN|ISSN_L|DOI|               NDLIP|               TITLE|NEXT_PART|PART_NAME|        ANOTHER_NAME|SERIES_TITLE|EDITION|              AUTHOR|                PUB|PLACE|       PUB_DATE|        DATE_RECEIPT|TABLE_CONT|                NOTE|          LANG|\n+--------------------+----+--------+----+------+---+--------------------+--------------------+---------+---------+--------------------+------------+-------+--------------------+-------------------+-----+---------------+--------------------+----------+--------------------+--------------+\n|     NDL\u30b5\u30fc\u30c1\u66f8\u8a8c\u8a73\u7d30\u753b\u9762URL|ISBN| \u30bb\u30c3\u30c8ISBN|ISSN|ISSN-L|DOI|               NDLJP|                \u30bf\u30a4\u30c8\u30eb|  \u5dfb\u6b21\u30fb\u90e8\u7de8\u756a\u53f7|      \u90e8\u7de8\u540d|               \u5225\u30bf\u30a4\u30c8\u30eb|    \u30b7\u30ea\u30fc\u30ba\u30bf\u30a4\u30c8\u30eb|      \u7248|                  \u8457\u8005|                \u51fa\u7248\u8005|  \u51fa\u7248\u5730|\u51fa\u7248\u5e74\u6708\u65e5\uff08W3CDTF\u5f62\u5f0f\uff09|       \u53d7\u7406\u65e5\uff08W3CDTF\u5f62\u5f0f\uff09|        \u76ee\u6b21|                  \u6ce8\u8a18|\u8a00\u8a9e\uff08ISO639-2\u5f62\u5f0f\uff09|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u897f\u9060\u5730\u57df\u5de5\u696d\u7528\u6c34\u6e90\u5730\u57df\u8abf\u67fb\u5831\u544a(\u88dc...|         |         |Areal investigati...|            |       |        \u5c3e\u5d0e\u6b21\u7537 ; \u5c0f\u8c37\u91ce\u9577\u5e73|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1955|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u611b\u5a9b\u770c\u897f\u6761\u5e02\u306e\u5de5\u696d\u7528\u6c34\u6e90\u78ba\u4fdd\u306b\u95a2\u3059\u308b\u8003\u5bdf|         |         |Hydro-geological ...|            |       |         \u91ce\u9593\u6cf0\u4e8c ; \u6751\u4e0b\u654f\u592b|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1963|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|               \u770c\u6c11\u3060\u3088\u308a|    \u5e73\u621025\u5e74|         |                    |            |       |              \u9577\u5d0e\u770c\u5e83\u5831\u8ab2|                \u9577\u5d0e\u770c|   \u65e5\u672c|        2013-11|2016-01-20T22:00:11Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|Journal of the Na...|       55|         |                    |            |       |National Institut...|           \u60c5\u5831\u901a\u4fe1\u7814\u7a76\u6a5f\u69cb|   \u65e5\u672c|           2008|2016-01-20T20:30:20Z|          |Special issue on ...|           eng|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|  \u5bae\u5d0e\u770c\u5357\u90e8\u5730\u533a\u653e\u5c04\u80fd\u5f37\u5ea6\u5206\u5e03\u8abf\u67fb\u5831\u544a|         |         |Radiometric surve...|            |       |                \u6e05\u5cf6\u4fe1\u4e4b|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1966|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|      \u9577\u91ce\u770c\u897f\u7b51\u6469\u90e1\u4e0b\u306e\u653e\u5c04\u80fd\u8abf\u67fb|         |         |Report on the rad...|            |       |         \u6797\u6607\u4e00\u90ce ; \u4e38\u5c71\u4fee\u53f8|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1962|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|   \u9577\u91ce\u770c\u8acf\u8a2a\u30ac\u30b9\u7530\u306b\u304a\u3051\u308b\u30b3\u30a2\u30fc\u8a66\u9a13|         |         |On the core analy...|            |       |        \u672c\u5cf6\u516c\u53f8 ; \u54c1\u7530\u82b3\u4e8c\u90ce|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1955|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|   \u718a\u672c\u770c\u7da0\u5ddd\u6c34\u7cfb\u5830\u5824\u5730\u70b9\u5730\u8cea\u8abf\u67fb\u5831\u544a|         |         |Geology of the da...|            |       |                \u7a3b\u4e95\u4fe1\u96c4|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1957|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u9577\u91ce\u770c\u7adc\u738b\u9271\u5c71\u306b\u304a\u3051\u308b\u30b2\u30eb\u30de\u30cb\u30a6\u30e0...|         |         |Distribution of g...|            |       |           \u5b89\u85e4\u539a ; \u9ad8\u5cf6\u6e05|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1963|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u5e38\u78d0\u70ad\u7530\u5927\u6d25\u5730\u533a\u306b\u304a\u3051\u308b\u5730\u9707\u63a2\u9271\u6cd5...|         |         |Seismic reflectio...|            |       |                 \u5ddd\u5cf6\u5a01|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1962|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|K-Ar age of Omi s...|         |         |    \u98db\u9a52\u5c71\u5730\u3001\u9752\u6d77\u7247\u5ca9\u306eK-Ar\u5e74\u4ee4|            |       |Ken Shibata ; Tam...|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1968|2016-01-20T23:44:40Z|          |                    |           eng|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|               \u672c\u6587\u8a02\u6b63\u8868|         |         |                    |            |       |                    |\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1956|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|     \u7a7a\u77e5\u70ad\u7530\u8d64\u5e73\u753a\u8c4a\u91cc\u5730\u533a\u8abf\u67fb\u901f\u5831|         |         |Survey of coal fi...|            |       |          \u6df8\u6c34\u52c7 ; \u4e45\u4fdd\u606d\u8f14|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1952|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u4f50\u4e16\u4fdd\u70ad\u7530\u306b\u304a\u3051\u308b\u3044\u308f\u3086\u308b\u4f50\u4e16\u4fdd\u5c64...|         |         |On the upper part...|            |       |                \u9577\u6d5c\u6625\u592b|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1954|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|K-Ar age of the N...|         |         |     \u201c\u65e5\u672c\u56fd\u201d\u7247\u9ebb\u5ca9\u306eK-Ar\u5e74\u4ee3|            |       |Ken Shibata ; Tam...|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1966|2016-01-20T23:44:40Z|          |                    |           eng|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u2161\u8cc7\u6599\u3000\u755c\u6c34\u7523\u98df\u54c1\u4e2d\u306e\u5408\u6210\u6297\u83cc\u5264\u7b49...|         |         |Survey report of ...|            |       |  \u8fbb\u6751\u548c\u4e5f ; \u77f3\u539f\u96c5\u884c ; \u543e\u90f7\u660c\u4fe1|                \u9577\u5d0e\u770c|   \u65e5\u672c|        2013-09|2016-01-20T22:00:11Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|         \u5cf6\u6839\u770c\u5409\u6c38\u9271\u5c71\u306e\u9285\u9271\u5e8a|         |         |                    |            |       |         \u4e0a\u91ce\u4e09\u7fa9 ; \u571f\u4e95\u5553\u53f8|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1960|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|     \u5cf6\u6839\u770c\u4e0b\u306e\u30d8\u30ea\u30a6\u30e0\u8cc7\u6e90\u306b\u3064\u3044\u3066|         |         |Exploration for h...|            |       |                \u6bd4\u7559\u5ddd\u8cb4|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1968|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u7fa4\u99ac\u770c\u5ddd\u5834\u6751\u306e\u653e\u5c04\u80fd\u7570\u5e38\u5730\u8abf\u67fb\u3068\u30a6...|         |         |On occurrence of ...|            |       |                \u77f3\u539f\u821c\u4e09|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1967|2016-01-20T23:44:40Z|          |                    |           jpn|\n+--------------------+----+--------+----+------+---+--------------------+--------------------+---------+---------+--------------------+------------+-------+--------------------+-------------------+-----+---------------+--------------------+----------+--------------------+--------------+\nonly showing top 20 rows\n\n\n\n\n\u30fbcase class\u306e\u5f15\u6570\u304c\u6700\u592722\u307e\u3067\u3057\u304b\u5f15\u6570\u304c\u8a2d\u5b9a\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u30fb\u5b9f\u969b\u306eTSV\u306f30\u4ee5\u4e0a\u9805\u76ee\u304c\u3042\u308b\u306e\u3067\u3053\u308c\u3067\u306f\u56f0\u308a\u307e\u3059\u306d\u3002\u3002\u3002\n\u30fb\u30bd\u30fc\u30c8\u3068\u304b\u30de\u30c3\u30c1\u30f3\u30b0\u306b\u4f7f\u7528\u3057\u306a\u3044\u9805\u76ee\u306f\u30c7\u30ea\u30df\u30bf\u4ed8\u304d\u3067\u307e\u3068\u3081\u308b\u306e\u304c\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u306d\u3002\n\u30fb\u6700\u5f8c\u306eselect\u306e\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\u90e8\u5206\u306fshell\u306a\u306e\u3067\u3002jar\u306b\u3057\u3066\u30c9\u30e9\u30a4\u30d0\u304cclient\u3058\u3083\u306a\u3044\u5834\u5408\u3001\u3069\u3046\u306a\u308b\u3084\u3089\u3002\n# SPARK SQL \u3067TSV\u30d5\u30a1\u30a4\u30eb\u3092HDFS\u304b\u3089\u30ed\u30fc\u30c9\u3057\u3066SHOW\u3059\u308b\u3060\u3051\u3002\n\n## \u524d\u63d0\u3068\u304b\n- SPARK\u306f1.6.0\n- \u5b9f\u884c\u306fspark-shell\u304b\u3089\u884c\u3046\n- --master yarn-client\u3067\u8d77\u52d5\n- hdfs\u306f\u8a2d\u5b9a\u6e08(spark-env.sh\u306bHADOOP_CONF_DIR\u8a2d\u5b9a\u6e08)\n- \u30c7\u30fc\u30bf\u306f\u56fd\u4f1a\u56f3\u66f8\u9928\u306e\u5168\u56fd\u66f8\u8a8c\uff08\u96fb\u5b50\u66f8\u7c4d\u30fb\u96fb\u5b50\u96d1\u8a8c\u7de8\uff09TSV\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\uff08\u4ee5\u4e0b\u306e\uff09\u30b5\u30a4\u30c8\u306e\u3082\u306e\u3092\u4f7f\u7528\u3059\u308b  \nhttp://www.ndl.go.jp/jp/data/data_service/jnb/ebej_tsv.html\n\n1.TSV\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066hdfs\u306b\u914d\u7f6e\u3059\u308b\n\n```lang:shell\n$ wget http://iss.ndl.go.jp/data/download/digital_20160122.tsv\n$ sudo -i -u hdfs hdfs dfs -put /home/junk/digital_20160122.tsv /home/junk\n```\n\n\u30b3\u30d4\u30fc\u5148\u306e/home/junk\u306f\u5148\u306b\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002chmod\u3067\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3082\u4e0e\u3048\u3066\u304a\u304f\u3002\nhdfs\u30b3\u30de\u30f3\u30c9\u3067\u4f7f\u7528\u3059\u308b\u74b0\u5883\u5909\u6570\u306e\u95a2\u4fc2\u3067\u3001\u5f15\u6570\u306b-i\u3092\u4f7f\u3063\u3066\u307e\u3059\u3002\n\n\n2.spark-shell\u8d77\u52d5\n\n```lang:shell\n$ /usr/local/spark/bin/spark-shell --master yarn-client\nWelcome to\n      ____              __\n     / __/__  ___ _____/ /__\n    _\\ \\/ _ \\/ _ `/ __/  '_/\n   /___/ .__/\\_,_/_/ /_/\\_\\   version 1.6.0\n      /_/\n\nUsing Scala version 2.10.5 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_72)\nType in expressions to have them evaluated.\nType :help for more information.\nscala>\n```\n\n3.\u5b9f\u884c\n\n```lang:spark-shell\nscala>//tsv\u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30c9\nscala>val bookRDD = sc.textFile(\"/home/junk/digital_20160120.tsv\")\nscala>//case class\u5b9a\u7fa9\nscala>case class Book(NDL_URL: String, ISBN: String, SET_ISBN: String, ISSN: String, ISSN_L: String, DOI: String,\n                NDLIP: String, TITLE: String, NEXT_PART: String, PART_NAME: String, ANOTHER_NAME: String,\n                SERIES_TITLE: String, EDITION: String, AUTHOR: String, PUB: String, PLACE: String, PUB_DATE: String,\n                DATE_RECEIPT: String, TABLE_CONT: String, NOTE: String, LANG: String)\nscala>\nscala>//DataFrame\u3068\u30b9\u30ad\u30fc\u30de\u8a2d\u5b9a\nscala>val bookDF = bookRDD.map { record =>\n         val splitRecord = record.split(\"\\t\",-1)\n         val NDL_URL = splitRecord(0)\n         val ISBN = splitRecord(1)\n         val SET_ISBN = splitRecord(2)\n         val ISSN = splitRecord(3)\n         val ISSN_L = splitRecord(4)\n         val DOI = splitRecord(5)\n         val NDLIP = splitRecord(6)\n         val TITLE = splitRecord(7)\n         val NEXT_PART = splitRecord(8)\n         val PART_NAME = splitRecord(9)\n         val ANOTHER_NAME = splitRecord(10)\n         val SERIES_TITLE = splitRecord(11)\n         val EDITION = splitRecord(12)\n         val AUTHOR = splitRecord(13)\n         val PUB = splitRecord(14)\n         val PLACE = splitRecord(15)\n         val PUB_DATE = splitRecord(16)\n         val DATE_RECEIPT = splitRecord(17)\n         val TABLE_CONT = splitRecord(18)\n         val NOTE = splitRecord(19)\n         val LANG = splitRecord(20)\n         Book(NDL_URL, ISBN, SET_ISBN, ISSN, ISSN_L, DOI, NDLIP, TITLE, NEXT_PART, PART_NAME, \n         ANOTHER_NAME, SERIES_TITLE, EDITION, AUTHOR, PUB, PLACE, PUB_DATE, DATE_RECEIPT,\n         TABLE_CONT, NOTE, LANG)\n    }.toDF\nscala>// \u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306b\uff01\nscala>bookDF.registerTempTable(\"bookdata\")\nscala>// select\u3057\u3066\u307f\u308b\nscala>val bookCountDF = sqlContext.sql(\"SELECT * FROM bookdata\") \nscala>// select\u306e\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\nscala>bookCountDF.show\n+--------------------+----+--------+----+------+---+--------------------+--------------------+---------+---------+--------------------+------------+-------+--------------------+-------------------+-----+---------------+--------------------+----------+--------------------+--------------+\n|             NDL_URL|ISBN|SET_ISBN|ISSN|ISSN_L|DOI|               NDLIP|               TITLE|NEXT_PART|PART_NAME|        ANOTHER_NAME|SERIES_TITLE|EDITION|              AUTHOR|                PUB|PLACE|       PUB_DATE|        DATE_RECEIPT|TABLE_CONT|                NOTE|          LANG|\n+--------------------+----+--------+----+------+---+--------------------+--------------------+---------+---------+--------------------+------------+-------+--------------------+-------------------+-----+---------------+--------------------+----------+--------------------+--------------+\n|     NDL\u30b5\u30fc\u30c1\u66f8\u8a8c\u8a73\u7d30\u753b\u9762URL|ISBN| \u30bb\u30c3\u30c8ISBN|ISSN|ISSN-L|DOI|               NDLJP|                \u30bf\u30a4\u30c8\u30eb|  \u5dfb\u6b21\u30fb\u90e8\u7de8\u756a\u53f7|      \u90e8\u7de8\u540d|               \u5225\u30bf\u30a4\u30c8\u30eb|    \u30b7\u30ea\u30fc\u30ba\u30bf\u30a4\u30c8\u30eb|      \u7248|                  \u8457\u8005|                \u51fa\u7248\u8005|  \u51fa\u7248\u5730|\u51fa\u7248\u5e74\u6708\u65e5\uff08W3CDTF\u5f62\u5f0f\uff09|       \u53d7\u7406\u65e5\uff08W3CDTF\u5f62\u5f0f\uff09|        \u76ee\u6b21|                  \u6ce8\u8a18|\u8a00\u8a9e\uff08ISO639-2\u5f62\u5f0f\uff09|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u897f\u9060\u5730\u57df\u5de5\u696d\u7528\u6c34\u6e90\u5730\u57df\u8abf\u67fb\u5831\u544a(\u88dc...|         |         |Areal investigati...|            |       |        \u5c3e\u5d0e\u6b21\u7537 ; \u5c0f\u8c37\u91ce\u9577\u5e73|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1955|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u611b\u5a9b\u770c\u897f\u6761\u5e02\u306e\u5de5\u696d\u7528\u6c34\u6e90\u78ba\u4fdd\u306b\u95a2\u3059\u308b\u8003\u5bdf|         |         |Hydro-geological ...|            |       |         \u91ce\u9593\u6cf0\u4e8c ; \u6751\u4e0b\u654f\u592b|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1963|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|               \u770c\u6c11\u3060\u3088\u308a|    \u5e73\u621025\u5e74|         |                    |            |       |              \u9577\u5d0e\u770c\u5e83\u5831\u8ab2|                \u9577\u5d0e\u770c|   \u65e5\u672c|        2013-11|2016-01-20T22:00:11Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|Journal of the Na...|       55|         |                    |            |       |National Institut...|           \u60c5\u5831\u901a\u4fe1\u7814\u7a76\u6a5f\u69cb|   \u65e5\u672c|           2008|2016-01-20T20:30:20Z|          |Special issue on ...|           eng|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|  \u5bae\u5d0e\u770c\u5357\u90e8\u5730\u533a\u653e\u5c04\u80fd\u5f37\u5ea6\u5206\u5e03\u8abf\u67fb\u5831\u544a|         |         |Radiometric surve...|            |       |                \u6e05\u5cf6\u4fe1\u4e4b|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1966|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|      \u9577\u91ce\u770c\u897f\u7b51\u6469\u90e1\u4e0b\u306e\u653e\u5c04\u80fd\u8abf\u67fb|         |         |Report on the rad...|            |       |         \u6797\u6607\u4e00\u90ce ; \u4e38\u5c71\u4fee\u53f8|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1962|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|   \u9577\u91ce\u770c\u8acf\u8a2a\u30ac\u30b9\u7530\u306b\u304a\u3051\u308b\u30b3\u30a2\u30fc\u8a66\u9a13|         |         |On the core analy...|            |       |        \u672c\u5cf6\u516c\u53f8 ; \u54c1\u7530\u82b3\u4e8c\u90ce|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1955|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|   \u718a\u672c\u770c\u7da0\u5ddd\u6c34\u7cfb\u5830\u5824\u5730\u70b9\u5730\u8cea\u8abf\u67fb\u5831\u544a|         |         |Geology of the da...|            |       |                \u7a3b\u4e95\u4fe1\u96c4|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1957|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u9577\u91ce\u770c\u7adc\u738b\u9271\u5c71\u306b\u304a\u3051\u308b\u30b2\u30eb\u30de\u30cb\u30a6\u30e0...|         |         |Distribution of g...|            |       |           \u5b89\u85e4\u539a ; \u9ad8\u5cf6\u6e05|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1963|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u5e38\u78d0\u70ad\u7530\u5927\u6d25\u5730\u533a\u306b\u304a\u3051\u308b\u5730\u9707\u63a2\u9271\u6cd5...|         |         |Seismic reflectio...|            |       |                 \u5ddd\u5cf6\u5a01|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1962|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|K-Ar age of Omi s...|         |         |    \u98db\u9a52\u5c71\u5730\u3001\u9752\u6d77\u7247\u5ca9\u306eK-Ar\u5e74\u4ee4|            |       |Ken Shibata ; Tam...|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1968|2016-01-20T23:44:40Z|          |                    |           eng|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|               \u672c\u6587\u8a02\u6b63\u8868|         |         |                    |            |       |                    |\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1956|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|     \u7a7a\u77e5\u70ad\u7530\u8d64\u5e73\u753a\u8c4a\u91cc\u5730\u533a\u8abf\u67fb\u901f\u5831|         |         |Survey of coal fi...|            |       |          \u6df8\u6c34\u52c7 ; \u4e45\u4fdd\u606d\u8f14|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1952|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u4f50\u4e16\u4fdd\u70ad\u7530\u306b\u304a\u3051\u308b\u3044\u308f\u3086\u308b\u4f50\u4e16\u4fdd\u5c64...|         |         |On the upper part...|            |       |                \u9577\u6d5c\u6625\u592b|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1954|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|K-Ar age of the N...|         |         |     \u201c\u65e5\u672c\u56fd\u201d\u7247\u9ebb\u5ca9\u306eK-Ar\u5e74\u4ee3|            |       |Ken Shibata ; Tam...|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1966|2016-01-20T23:44:40Z|          |                    |           eng|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u2161\u8cc7\u6599\u3000\u755c\u6c34\u7523\u98df\u54c1\u4e2d\u306e\u5408\u6210\u6297\u83cc\u5264\u7b49...|         |         |Survey report of ...|            |       |  \u8fbb\u6751\u548c\u4e5f ; \u77f3\u539f\u96c5\u884c ; \u543e\u90f7\u660c\u4fe1|                \u9577\u5d0e\u770c|   \u65e5\u672c|        2013-09|2016-01-20T22:00:11Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|         \u5cf6\u6839\u770c\u5409\u6c38\u9271\u5c71\u306e\u9285\u9271\u5e8a|         |         |                    |            |       |         \u4e0a\u91ce\u4e09\u7fa9 ; \u571f\u4e95\u5553\u53f8|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1960|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|     \u5cf6\u6839\u770c\u4e0b\u306e\u30d8\u30ea\u30a6\u30e0\u8cc7\u6e90\u306b\u3064\u3044\u3066|         |         |Exploration for h...|            |       |                \u6bd4\u7559\u5ddd\u8cb4|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1968|2016-01-20T23:44:40Z|          |                    |           jpn|\n|http://iss.ndl.go...|    |        |    |      |   |info:ndljp/pid/96...|\u7fa4\u99ac\u770c\u5ddd\u5834\u6751\u306e\u653e\u5c04\u80fd\u7570\u5e38\u5730\u8abf\u67fb\u3068\u30a6...|         |         |On occurrence of ...|            |       |                \u77f3\u539f\u821c\u4e09|\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\u5730\u8cea\u8abf\u67fb\u7dcf\u5408\u30bb\u30f3\u30bf\u30fc|   \u65e5\u672c|           1967|2016-01-20T23:44:40Z|          |                    |           jpn|\n+--------------------+----+--------+----+------+---+--------------------+--------------------+---------+---------+--------------------+------------+-------+--------------------+-------------------+-----+---------------+--------------------+----------+--------------------+--------------+\nonly showing top 20 rows\n\n\n```\n\n\u30fbcase class\u306e\u5f15\u6570\u304c\u6700\u592722\u307e\u3067\u3057\u304b\u5f15\u6570\u304c\u8a2d\u5b9a\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u30fb\u5b9f\u969b\u306eTSV\u306f30\u4ee5\u4e0a\u9805\u76ee\u304c\u3042\u308b\u306e\u3067\u3053\u308c\u3067\u306f\u56f0\u308a\u307e\u3059\u306d\u3002\u3002\u3002\n\u30fb\u30bd\u30fc\u30c8\u3068\u304b\u30de\u30c3\u30c1\u30f3\u30b0\u306b\u4f7f\u7528\u3057\u306a\u3044\u9805\u76ee\u306f\u30c7\u30ea\u30df\u30bf\u4ed8\u304d\u3067\u307e\u3068\u3081\u308b\u306e\u304c\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u306d\u3002\n\u30fb\u6700\u5f8c\u306eselect\u306e\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\u90e8\u5206\u306fshell\u306a\u306e\u3067\u3002jar\u306b\u3057\u3066\u30c9\u30e9\u30a4\u30d0\u304cclient\u3058\u3083\u306a\u3044\u5834\u5408\u3001\u3069\u3046\u306a\u308b\u3084\u3089\u3002\n", "tags": ["sparksql", "Spark", "Hdfs"]}