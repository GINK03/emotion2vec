{"context": "\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u540d(ex: enp1s0)\u3068PCIe BDF\u540d(ex: 02:00.1)\u3092\u4e00\u5ea6\u306b\u8abf\u3079\u308b\u7c21\u5358\u306a\u65b9\u6cd5\u3092\u30e1\u30e2\u3002\n( PCIe BDF = Bus:Device.Function )\n\u3053\u308c\u307e\u3067\u306f\u65b0\u3057\u3044NIC\u3092\u8ffd\u52a0\u3059\u308b\u5ea6\u306b\u3001 lspci | grep -i <vendor_name> \u3067\u8ffd\u52a0\u3057\u305f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306ePCIe\u756a\u53f7\u3092\u63a2\u3057\u3001$ip a \u3067\u8868\u793a\u3055\u308c\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u540d\u304b\u3089\u76ee\u7684\u306e\u3082\u306e\u3089\u3057\u304d\u3082\u306e\u3092\u63a2\u3057\u3066\u306f ethtools -i <interface_name> \u3067 PCIe BDF \u3092\u8abf\u3079\u3066\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\u30e1\u30f3\u30c9\u30af\u30b5\u30a4\u306a\uff5e \u3068\u601d\u3063\u3066\u3044\u305f\u3089\u3001 $udevadm info /sys/class/net/<dev> \u306b\u5fc5\u8981\u306a\u60c5\u5831\u304c\u5168\u90e8\u8f09\u3063\u3066\u304a\u308a\u3001\u4ee5\u4e0b\uff11\u884c\u3067\u8868\u793a\u3067\u304d\u308b\u4e8b\u3092\u767a\u898b\u3002\n$ for DEV in $(ls /sys/class/net/); do udevadm info /sys/class/net/$DEV | grep -e INTERFACE -e \"ID_PATH=pci\" -e ID_MODEL_FROM_DATABASE; echo \"---\"; done\n\n\u898b\u3084\u3059\u304f\u66f8\u304f\u3068\u3053\u3093\u306a\u611f\u3058\n#!/bin/bash\n\nfor DEV in $(ls /sys/class/net/)\ndo\n        udevadm info /sys/class/net/$DEV | grep -e INTERFACE -e \"ID_PATH=pci\" -e ID_MODEL_FROM_DATABAS\n        echo \"---\"\ndone\n\n\n--> \u8ffd\u8a18\uff1a\u5b9f\u306f lshw -class network \u3068\u3044\u3046\u4fbf\u5229\u306a\u30b3\u30de\u30f3\u30c9\u304c\u3042\u3063\u305f\u3068\u3044\u3046\u7f60\u3002\n\nebiken@supermicro:~$ sudo lshw -class network\n  *-network DISABLED\n       description: Ethernet interface\n       product: FastLinQ QL45000 Series 100GbE Controller\n       vendor: QLogic Corp.\n       physical id: 0\n       bus info: pci@0000:02:00.0\n       logical name: enp2s0\n       version: 10\n       serial: 00:0e:1e:c6:40:92\n       width: 64 bits\n       clock: 33MHz\n       capabilities: pm vpd msi msix pciexpress bus_master cap_list rom ethernet physical fibre autonegotiation\n       configuration: autonegotiation=on broadcast=yes driver=qede driverversion=8.4.0.0 firmware=mfw 8.9.2.0 storm 8.4.2.0 latency=0 link=no multicast=yes\n       resources: irq:26 memory:b8080000-b80bffff memory:b8000000-b807ffff memory:b80c0000-b80cffff memory:d6500000-d653ffff\n  *-network:0\n       description: Ethernet interface\n       product: MT27700 Family [ConnectX-4]\n       vendor: Mellanox Technologies\n       physical id: 0\n...\n\n\n<-- \u8ffd\u8a18\n\n\uff12\u65e5\u306b\uff11\u56de\u306f ethtool -i \u3057\u3066\u308b\u306e\u3067\u3001\u3053\u308c\u304b\u3089\u306f\u697d\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\noutput memo\n\nip a / ethtool \u5229\u7528\uff1a\n\n\n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u540d\uff08enpXsY\uff09\u3068lspci BDF\uff08X:Y.0\uff09\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u3001 ethtool -i \u3092\u5ef6\u3005\u3068\u7e70\u308a\u8fd4\u3059\u3053\u3068\u306b\u306a\u308a\u30c4\u30e9\u30a4\u3002\n\n\n\nebiken@supermicro:~$ lspci | grep FastLinQ\n02:00.0 Ethernet controller: QLogic Corp. FastLinQ QL45000 Series 100GbE Controller (rev 10)\n\nebiken@supermicro:~$ ip a | grep ^[0-9]\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n2: enp5s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master br0 state UP group default qlen 1000\n3: enp6s0: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n4: enp2s0: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n5: ens1f0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master br-ens1f0 state UP group default qlen 1000\n6: ens1f1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master br-ens1f1 state UP group default qlen 1000\n7: ens3f0: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n8: ens3f1: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n\nebiken@supermicro:~$ ethtool -i enp2s0\ndriver: qede\nversion: 8.4.0.0\nfirmware-version: mfw 8.9.2.0 storm 8.4.2.0\nexpansion-rom-version:\nbus-info: 0000:02:00.0\nsupports-statistics: yes\nsupports-test: no\nsupports-eeprom-access: no\nsupports-register-dump: no\nsupports-priv-flags: no\n\n\n\uff11\u884c\u30b3\u30de\u30f3\u30c9\u3067\u4e00\u89a7\u8868\u793a\n\n\nConnectX-4 Lx \u306f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u540d\uff08enpXsY\uff09\u3068lspci BDF\uff08X:Y.0\uff09\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044 \n\n\n\nebiken@supermicro:~$ for DEV in $(ls /sys/class/net/); do udevadm info /sys/class/net/$DEV | grep -e INTERFACE -e \"ID_PATH=pci\" -e ID_MODEL_FROM_DATABASE; echo \"---\"; done\nE: INTERFACE=br0\n---\nE: INTERFACE=br-ens1f0\n---\nE: INTERFACE=br-ens1f1\n---\nE: ID_MODEL_FROM_DATABASE=FastLinQ QL45000 Series 100GbE Controller (FastLinQ QL45611H 100GbE Adapter)\nE: ID_PATH=pci-0000:02:00.0\nE: INTERFACE=enp2s0\n---\nE: ID_MODEL_FROM_DATABASE=I210 Gigabit Network Connection\nE: ID_PATH=pci-0000:05:00.0\nE: INTERFACE=enp5s0\n---\nE: ID_MODEL_FROM_DATABASE=I210 Gigabit Network Connection\nE: ID_PATH=pci-0000:06:00.0\nE: INTERFACE=enp6s0\n---\nE: ID_MODEL_FROM_DATABASE=MT27700 Family [ConnectX-4]\nE: ID_PATH=pci-0000:03:00.0\nE: INTERFACE=ens1f0\n---\nE: ID_MODEL_FROM_DATABASE=MT27700 Family [ConnectX-4]\nE: ID_PATH=pci-0000:03:00.1\nE: INTERFACE=ens1f1\n---\nE: ID_MODEL_FROM_DATABASE=MT27710 Family [ConnectX-4 Lx]\nE: ID_PATH=pci-0000:81:00.0\nE: INTERFACE=ens3f0\n---\nE: ID_MODEL_FROM_DATABASE=MT27710 Family [ConnectX-4 Lx]\nE: ID_PATH=pci-0000:81:00.1\nE: INTERFACE=ens3f1\n---\n\n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u540d(ex: enp1s0)\u3068PCIe BDF\u540d(ex: 02:00.1)\u3092\u4e00\u5ea6\u306b\u8abf\u3079\u308b\u7c21\u5358\u306a\u65b9\u6cd5\u3092\u30e1\u30e2\u3002\n( PCIe BDF = Bus:Device.Function )\n\n\u3053\u308c\u307e\u3067\u306f\u65b0\u3057\u3044NIC\u3092\u8ffd\u52a0\u3059\u308b\u5ea6\u306b\u3001 `lspci | grep -i <vendor_name>` \u3067\u8ffd\u52a0\u3057\u305f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306ePCIe\u756a\u53f7\u3092\u63a2\u3057\u3001`$ip a` \u3067\u8868\u793a\u3055\u308c\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u540d\u304b\u3089\u76ee\u7684\u306e\u3082\u306e\u3089\u3057\u304d\u3082\u306e\u3092\u63a2\u3057\u3066\u306f `ethtools -i <interface_name>` \u3067 PCIe BDF \u3092\u8abf\u3079\u3066\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u30e1\u30f3\u30c9\u30af\u30b5\u30a4\u306a\uff5e \u3068\u601d\u3063\u3066\u3044\u305f\u3089\u3001 `$udevadm info /sys/class/net/<dev>` \u306b\u5fc5\u8981\u306a\u60c5\u5831\u304c\u5168\u90e8\u8f09\u3063\u3066\u304a\u308a\u3001\u4ee5\u4e0b\uff11\u884c\u3067\u8868\u793a\u3067\u304d\u308b\u4e8b\u3092\u767a\u898b\u3002\n\n```\n$ for DEV in $(ls /sys/class/net/); do udevadm info /sys/class/net/$DEV | grep -e INTERFACE -e \"ID_PATH=pci\" -e ID_MODEL_FROM_DATABASE; echo \"---\"; done\n```\n\n\u898b\u3084\u3059\u304f\u66f8\u304f\u3068\u3053\u3093\u306a\u611f\u3058\n\n```bash\n#!/bin/bash\n\nfor DEV in $(ls /sys/class/net/)\ndo\n        udevadm info /sys/class/net/$DEV | grep -e INTERFACE -e \"ID_PATH=pci\" -e ID_MODEL_FROM_DATABAS\n        echo \"---\"\ndone\n```\n\n> --> \u8ffd\u8a18\uff1a\u5b9f\u306f `lshw -class network` \u3068\u3044\u3046\u4fbf\u5229\u306a\u30b3\u30de\u30f3\u30c9\u304c\u3042\u3063\u305f\u3068\u3044\u3046\u7f60\u3002\n\n```\nebiken@supermicro:~$ sudo lshw -class network\n  *-network DISABLED\n       description: Ethernet interface\n       product: FastLinQ QL45000 Series 100GbE Controller\n       vendor: QLogic Corp.\n       physical id: 0\n       bus info: pci@0000:02:00.0\n       logical name: enp2s0\n       version: 10\n       serial: 00:0e:1e:c6:40:92\n       width: 64 bits\n       clock: 33MHz\n       capabilities: pm vpd msi msix pciexpress bus_master cap_list rom ethernet physical fibre autonegotiation\n       configuration: autonegotiation=on broadcast=yes driver=qede driverversion=8.4.0.0 firmware=mfw 8.9.2.0 storm 8.4.2.0 latency=0 link=no multicast=yes\n       resources: irq:26 memory:b8080000-b80bffff memory:b8000000-b807ffff memory:b80c0000-b80cffff memory:d6500000-d653ffff\n  *-network:0\n       description: Ethernet interface\n       product: MT27700 Family [ConnectX-4]\n       vendor: Mellanox Technologies\n       physical id: 0\n...\n```\n\n> <-- \u8ffd\u8a18\n\n\uff12\u65e5\u306b\uff11\u56de\u306f `ethtool -i` \u3057\u3066\u308b\u306e\u3067\u3001\u3053\u308c\u304b\u3089\u306f\u697d\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n# output memo\n\n* ip a / ethtool \u5229\u7528\uff1a\n    * \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u540d\uff08enpXsY\uff09\u3068lspci BDF\uff08X:Y.0\uff09\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u3001 ethtool -i \u3092\u5ef6\u3005\u3068\u7e70\u308a\u8fd4\u3059\u3053\u3068\u306b\u306a\u308a\u30c4\u30e9\u30a4\u3002\n\n```\nebiken@supermicro:~$ lspci | grep FastLinQ\n02:00.0 Ethernet controller: QLogic Corp. FastLinQ QL45000 Series 100GbE Controller (rev 10)\n\nebiken@supermicro:~$ ip a | grep ^[0-9]\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n2: enp5s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master br0 state UP group default qlen 1000\n3: enp6s0: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n4: enp2s0: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n5: ens1f0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master br-ens1f0 state UP group default qlen 1000\n6: ens1f1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq master br-ens1f1 state UP group default qlen 1000\n7: ens3f0: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n8: ens3f1: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN group default qlen 1000\n\nebiken@supermicro:~$ ethtool -i enp2s0\ndriver: qede\nversion: 8.4.0.0\nfirmware-version: mfw 8.9.2.0 storm 8.4.2.0\nexpansion-rom-version:\nbus-info: 0000:02:00.0\nsupports-statistics: yes\nsupports-test: no\nsupports-eeprom-access: no\nsupports-register-dump: no\nsupports-priv-flags: no\n```\n\n* \uff11\u884c\u30b3\u30de\u30f3\u30c9\u3067\u4e00\u89a7\u8868\u793a\n    * ConnectX-4 Lx \u306f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u540d\uff08enpXsY\uff09\u3068lspci BDF\uff08X:Y.0\uff09\u304c\u4e00\u81f4\u3057\u3066\u3044\u306a\u3044 \n\n```\nebiken@supermicro:~$ for DEV in $(ls /sys/class/net/); do udevadm info /sys/class/net/$DEV | grep -e INTERFACE -e \"ID_PATH=pci\" -e ID_MODEL_FROM_DATABASE; echo \"---\"; done\nE: INTERFACE=br0\n---\nE: INTERFACE=br-ens1f0\n---\nE: INTERFACE=br-ens1f1\n---\nE: ID_MODEL_FROM_DATABASE=FastLinQ QL45000 Series 100GbE Controller (FastLinQ QL45611H 100GbE Adapter)\nE: ID_PATH=pci-0000:02:00.0\nE: INTERFACE=enp2s0\n---\nE: ID_MODEL_FROM_DATABASE=I210 Gigabit Network Connection\nE: ID_PATH=pci-0000:05:00.0\nE: INTERFACE=enp5s0\n---\nE: ID_MODEL_FROM_DATABASE=I210 Gigabit Network Connection\nE: ID_PATH=pci-0000:06:00.0\nE: INTERFACE=enp6s0\n---\nE: ID_MODEL_FROM_DATABASE=MT27700 Family [ConnectX-4]\nE: ID_PATH=pci-0000:03:00.0\nE: INTERFACE=ens1f0\n---\nE: ID_MODEL_FROM_DATABASE=MT27700 Family [ConnectX-4]\nE: ID_PATH=pci-0000:03:00.1\nE: INTERFACE=ens1f1\n---\nE: ID_MODEL_FROM_DATABASE=MT27710 Family [ConnectX-4 Lx]\nE: ID_PATH=pci-0000:81:00.0\nE: INTERFACE=ens3f0\n---\nE: ID_MODEL_FROM_DATABASE=MT27710 Family [ConnectX-4 Lx]\nE: ID_PATH=pci-0000:81:00.1\nE: INTERFACE=ens3f1\n---\n```\n", "tags": ["Ubuntu", "Linux", "PCI", "Network", "interface"]}