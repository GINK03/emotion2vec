{"tags": ["Python", "python2.7", "xlwings", "ExcelVBA"], "context": "Qiita\u3067xmlwings\u3068\u3044\u3046\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066Excel VBA\u3067Python\u3092\u52d5\u304b\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u3044\u3046\u8a18\u4e8b\u3092\u898b\u3066\u3001Quick Start + \u88dc\u8db3\u3092\u3061\u3087\u3063\u3068\u66f8\u3044\u3066\u307f\u308b\n\u666e\u6bb5\u30d6\u30ed\u30b0\u3067\u66f8\u3044\u3066\u308b\u306e\u3067Qiita\u306e\u65b9\u3067\u88dc\u8db3\u66f8\u3044\u3066\u307f\u308b\u306e\u3082\u826f\u3044\u304b\u306a\u3068\u3044\u3046\u3053\u3068\u3067\n\n\u958b\u767a\u74b0\u5883\n\nWindows 7 (32-bit)\nOffice 2010 SP-2\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u7279\u306b\u7279\u6b8a\u306a\u3053\u3068\u306f\u306a\u304f\u3066pip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3060\u3051\n\npip install xlwings\n\n\u79c1\u306e\u74b0\u5883\u3067\u306f\u4e0b\u8a18\u306e\u5834\u6240\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3002\u5f8c\u3067Excel\u5074\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u969b\u306b\u53c2\u7167\u3059\u308b\u5834\u6240\nC:\\Python27\\Lib\\site-packages\\xlwings\n\n\u30b5\u30f3\u30d7\u30eb\u3092\u5b9f\u884c\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nExcel\u304b\u3089\u547c\u3073\u51fa\u3059python\u30e2\u30b8\u30e5\u30fc\u30eb\n\nmymodule.py\nimport numpy as np\nfrom xlwings import Workbook, Range\n\ndef rand_numbers():\n    \"\"\" produces standard normally distributed random numbers with shape (n,n)\"\"\"\n    wb = Workbook.caller()  # Creates a reference to the calling Excel file\n    n = int(Range('Sheet1', 'B1').value)  # Write desired dimensions into Cell B1\n    rand_num = np.random.randn(n, n)\n    Range('Sheet1', 'C3').value = rand_num\n\n\nExcel\u5074\u306b\u3067\u66f8\u304fVBA\u30b3\u30fc\u30c9\n\nExcelVBA\nSub RandomNumbers()\n    RunPython (\"sys.path.append('C:\\Temp'); import mymodule; mymodule.rand_numbers()\")\nEnd Sub\n\n\n\u3053\u306eVBA\u306e\u30b3\u30fc\u30c9\u30b5\u30f3\u30d7\u30eb\u3067\u306f\nRunPython (\"import mymodule; mymodule.rand_numbers()\")\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3060\u304c\u3053\u308c\u304c\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u3061\u3087\u3063\u3068\u3057\u305f\u30c8\u30e9\u30c3\u30d7\u306a\u306e\u304b\u306a\u3068\nmymodule.py\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u3069\u3053\u306b\u7f6e\u3051\u3070\u826f\u3044\u306e\u304b\u3068\u3044\u3046\u3088\u3046\u306a\u3053\u3068\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3060\u304c\u3001RunPython\u306eimport\u306e\u524d\u306b\u4efb\u610f\u306e\u30d1\u30b9\u3092\u8ffd\u52a0\u3059\u308c\u3070\u3069\u3053\u306b\u7f6e\u3044\u3066\u3082\u69cb\u308f\u306a\u3044\u3002\n\u4eca\u56de\u306f\u30d1\u30b9\u3092\u901a\u3057\u3066\u3044\u306a\u3044C:\\Temp\u306bmymodule.py\u3092\u7f6e\u3044\u3066\u307f\u305f\u3002\nExcel\u81ea\u4f53\u306f\u3001C:\\Users\\h_oki\\Documents\\book\u306btest.xlsm\u3067\u4fdd\u5b58\u3057\u3066\u304a\u3044\u3066\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u5225\u306e\u5834\u6240\u306b\u307e\u3068\u3081\u3066\u304a\u304d\u305f\u304b\u3063\u305f\u3051\u3069\u30c6\u30b9\u30c8\u7528\u306b\u3069\u3053\u304b\u3089\u3067\u3082\u8aad\u307f\u8fbc\u3081\u308b\u304b\u78ba\u8a8d\u3057\u305f\u304b\u3063\u305f\u305f\u3081\u4e0a\u8a18\u306e\u3068\u304a\u308a\u3068\u3057\u305f\u3002\n\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a\u306f\u3001\u516c\u5f0f\u3092\u8aad\u3081\u3070\u3059\u3050\u308f\u304b\u308b\u306e\u3067\u7701\u7565\n\n\u88dc\u8db3\nVBA\u3068\u304bExcel\u3068\u304b\u306f\u95a2\u4fc2\u306a\u304f\u3001\u3042\u304f\u307e\u3067Python\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3060\u3051\u306a\u306e\u3067\u3001\u305d\u306e\u5f8c\u306b\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\u3053\u3068\u3067\u4efb\u610f\u306e\u5834\u6240\u306b\u7f6e\u3044\u3066\u3042\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3082\u8aad\u307f\u8fbc\u3081\u308b\u3002\nimport sys\u306fxlwings\u306e\u4e2d\u3067\u52dd\u624b\u306b\u8aad\u307f\u8fbc\u307e\u308c\u308b\u305f\u3081\u7279\u306b\u8a18\u5165\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u3002\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u306f\u30d1\u30b9\u306e\u901a\u3063\u305f\u5834\u6240\u304b\u76f4\u4e0b\u306b\u7f6e\u304b\u306a\u3044\u3068\u8aad\u307f\u8fbc\u3081\u306a\u3044\u304c\u4efb\u610f\u306e\u30d1\u30b9\u306b\u7f6e\u304d\u305f\u3044\u5834\u5408\u306f\u3001sys.path.append('/your/to/path')\u3092import mymodule\u306e\u524d\u306b\u66f8\u3044\u3066\u3042\u3052\u308b\u3060\u3051\u3067\u826f\u3044\u3002\n\u307e\u305f\u3001sys.path.append('/your/to/path')\u3092\u8ffd\u52a0\u3057\u306a\u304f\u3066\u3082\u74b0\u5883\u5909\u6570PYTHONPATH\u306b\u8a2d\u5b9a\u3057\u3066\u3042\u308b\u5834\u6240\u3067\u3042\u308c\u3070\u554f\u984c\u306f\u306a\u3055\u305d\u3046\u3002\n\n\u5b9f\u884c\u7d50\u679c\n\u306a\u305c\u304b\u753b\u50cf\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u306a\u304b\u3063\u305f\u305f\u3081\u7701\u7565\u3055\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\u305f\u3060\u3001\u4efb\u610f\u306e\u5834\u6240\u306b\u7f6e\u3044\u305fmymodule.py(\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8\u306e\u30b3\u30fc\u30c9\u305d\u306e\u3082\u306e)\u306f\u5b9f\u884c\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u53c2\u8003\u8a18\u4e8b\n\n\u95a2\u9023\u8a18\u4e8b\nxlwings\u3092\u4f7f\u3046\u305c\nExcel\u304b\u3089Python\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092Excel\u306b\u30b0\u30e9\u30d5\u8868\u793a\u3067\u304d\u308bxlwings\u3067\u904a\u3093\u3067\u307f\u305f\u3002\n\n\u516c\u5f0f\nxlwings\u516c\u5f0f\nQuickstart\n\nQiita\u3067xmlwings\u3068\u3044\u3046\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066Excel VBA\u3067Python\u3092\u52d5\u304b\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u3044\u3046\u8a18\u4e8b\u3092\u898b\u3066\u3001Quick Start + \u88dc\u8db3\u3092\u3061\u3087\u3063\u3068\u66f8\u3044\u3066\u307f\u308b\n\u666e\u6bb5\u30d6\u30ed\u30b0\u3067\u66f8\u3044\u3066\u308b\u306e\u3067Qiita\u306e\u65b9\u3067\u88dc\u8db3\u66f8\u3044\u3066\u307f\u308b\u306e\u3082\u826f\u3044\u304b\u306a\u3068\u3044\u3046\u3053\u3068\u3067\n\n# \u958b\u767a\u74b0\u5883\n- Windows 7 (32-bit)\n- Office 2010 SP-2\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u7279\u306b\u7279\u6b8a\u306a\u3053\u3068\u306f\u306a\u304f\u3066pip\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3060\u3051\n```\npip install xlwings\n```\n\u79c1\u306e\u74b0\u5883\u3067\u306f\u4e0b\u8a18\u306e\u5834\u6240\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3002\u5f8c\u3067Excel\u5074\u304b\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308b\u969b\u306b\u53c2\u7167\u3059\u308b\u5834\u6240\nC:\\Python27\\Lib\\site-packages\\xlwings\n\n# \u30b5\u30f3\u30d7\u30eb\u3092\u5b9f\u884c\n## \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nExcel\u304b\u3089\u547c\u3073\u51fa\u3059python\u30e2\u30b8\u30e5\u30fc\u30eb\n\n```python:mymodule.py\nimport numpy as np\nfrom xlwings import Workbook, Range\n\ndef rand_numbers():\n    \"\"\" produces standard normally distributed random numbers with shape (n,n)\"\"\"\n    wb = Workbook.caller()  # Creates a reference to the calling Excel file\n    n = int(Range('Sheet1', 'B1').value)  # Write desired dimensions into Cell B1\n    rand_num = np.random.randn(n, n)\n    Range('Sheet1', 'C3').value = rand_num\n```\n\nExcel\u5074\u306b\u3067\u66f8\u304fVBA\u30b3\u30fc\u30c9\n\n```vbnet:ExcelVBA\nSub RandomNumbers()\n    RunPython (\"sys.path.append('C:\\Temp'); import mymodule; mymodule.rand_numbers()\")\nEnd Sub\n```\n\n\u3053\u306eVBA\u306e\u30b3\u30fc\u30c9\u30b5\u30f3\u30d7\u30eb\u3067\u306f\n`RunPython (\"import mymodule; mymodule.rand_numbers()\")`\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3060\u304c\u3053\u308c\u304c\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u3061\u3087\u3063\u3068\u3057\u305f\u30c8\u30e9\u30c3\u30d7\u306a\u306e\u304b\u306a\u3068\nmymodule.py\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u3069\u3053\u306b\u7f6e\u3051\u3070\u826f\u3044\u306e\u304b\u3068\u3044\u3046\u3088\u3046\u306a\u3053\u3068\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3060\u304c\u3001`RunPython`\u306e`import`\u306e\u524d\u306b\u4efb\u610f\u306e\u30d1\u30b9\u3092\u8ffd\u52a0\u3059\u308c\u3070\u3069\u3053\u306b\u7f6e\u3044\u3066\u3082\u69cb\u308f\u306a\u3044\u3002\n\u4eca\u56de\u306f\u30d1\u30b9\u3092\u901a\u3057\u3066\u3044\u306a\u3044`C:\\Temp`\u306b`mymodule.py`\u3092\u7f6e\u3044\u3066\u307f\u305f\u3002\nExcel\u81ea\u4f53\u306f\u3001`C:\\Users\\h_oki\\Documents\\book`\u306b`test.xlsm`\u3067\u4fdd\u5b58\u3057\u3066\u304a\u3044\u3066\u3001\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u5225\u306e\u5834\u6240\u306b\u307e\u3068\u3081\u3066\u304a\u304d\u305f\u304b\u3063\u305f\u3051\u3069\u30c6\u30b9\u30c8\u7528\u306b\u3069\u3053\u304b\u3089\u3067\u3082\u8aad\u307f\u8fbc\u3081\u308b\u304b\u78ba\u8a8d\u3057\u305f\u304b\u3063\u305f\u305f\u3081\u4e0a\u8a18\u306e\u3068\u304a\u308a\u3068\u3057\u305f\u3002\n\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a\u306f\u3001\u516c\u5f0f\u3092\u8aad\u3081\u3070\u3059\u3050\u308f\u304b\u308b\u306e\u3067\u7701\u7565\n\n## \u88dc\u8db3\nVBA\u3068\u304bExcel\u3068\u304b\u306f\u95a2\u4fc2\u306a\u304f\u3001\u3042\u304f\u307e\u3067Python\u306e\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3057\u3066\u3044\u308b\u3060\u3051\u306a\u306e\u3067\u3001\u305d\u306e\u5f8c\u306b\u30d1\u30b9\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\u3053\u3068\u3067\u4efb\u610f\u306e\u5834\u6240\u306b\u7f6e\u3044\u3066\u3042\u308b\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3082\u8aad\u307f\u8fbc\u3081\u308b\u3002\n`import sys`\u306fxlwings\u306e\u4e2d\u3067\u52dd\u624b\u306b\u8aad\u307f\u8fbc\u307e\u308c\u308b\u305f\u3081\u7279\u306b\u8a18\u5165\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u3002\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u306f\u30d1\u30b9\u306e\u901a\u3063\u305f\u5834\u6240\u304b\u76f4\u4e0b\u306b\u7f6e\u304b\u306a\u3044\u3068\u8aad\u307f\u8fbc\u3081\u306a\u3044\u304c\u4efb\u610f\u306e\u30d1\u30b9\u306b\u7f6e\u304d\u305f\u3044\u5834\u5408\u306f\u3001`sys.path.append('/your/to/path')`\u3092`import mymodule`\u306e\u524d\u306b\u66f8\u3044\u3066\u3042\u3052\u308b\u3060\u3051\u3067\u826f\u3044\u3002\n\u307e\u305f\u3001`sys.path.append('/your/to/path')`\u3092\u8ffd\u52a0\u3057\u306a\u304f\u3066\u3082\u74b0\u5883\u5909\u6570`PYTHONPATH`\u306b\u8a2d\u5b9a\u3057\u3066\u3042\u308b\u5834\u6240\u3067\u3042\u308c\u3070\u554f\u984c\u306f\u306a\u3055\u305d\u3046\u3002\n\n# \u5b9f\u884c\u7d50\u679c\n\u306a\u305c\u304b\u753b\u50cf\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3067\u304d\u306a\u304b\u3063\u305f\u305f\u3081\u7701\u7565\u3055\u305b\u3066\u304f\u3060\u3055\u3044\u3002\n\u305f\u3060\u3001\u4efb\u610f\u306e\u5834\u6240\u306b\u7f6e\u3044\u305f`mymodule.py`(\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8\u306e\u30b3\u30fc\u30c9\u305d\u306e\u3082\u306e)\u306f\u5b9f\u884c\u3067\u304d\u307e\u3057\u305f\u3002\n\n# \u53c2\u8003\u8a18\u4e8b\n## \u95a2\u9023\u8a18\u4e8b\n[xlwings\u3092\u4f7f\u3046\u305c](http://qiita.com/shinriyo@github/items/1c38f5412e97d1a24c06)\n[Excel\u304b\u3089Python\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092Excel\u306b\u30b0\u30e9\u30d5\u8868\u793a\u3067\u304d\u308bxlwings\u3067\u904a\u3093\u3067\u307f\u305f\u3002](http://qiita.com/mtb_beta/items/96628a19e3c94cea4c24)\n\n## \u516c\u5f0f\n[xlwings\u516c\u5f0f](http://xlwings.org/)\n[Quickstart](http://docs.xlwings.org/en/stable/quickstart.html)\n"}