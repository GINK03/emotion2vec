{"context": " More than 1 year has passed since last update.\n\n\u524d\u63d0\n\u793e\u5185\u306e\u6570\u540d\u3067\u7c73\u3092\u708a\u3044\u3066\u4e2d\u98df\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u708a\u98ef\u3084\u5f8c\u7247\u4ed8\u3051\u3092\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30bf\u30b9\u30af\u3067\u7ba1\u7406\u30fb\u5171\u6709\u3057\u3066\u3044\u307e\u3059\u3002\n\u305f\u3060\u3001\u6b21\u306e\u4eba\u306e\u30bf\u30b9\u30af\u3092\u8ffd\u52a0\u3059\u308b\u3068\u3044\u3046\u4f5c\u696d\u304c\u6bce\u56de\u9762\u5012\u306a\u306e\u3067\u3001\u81ea\u52d5\u5316\u3067\u304d\u306a\u3044\u304bAPI\u4ed5\u69d8\u3092\u63a2\u3063\u3066\u5b9f\u73fe\u3057\u307e\u3057\u305f\u3002\n\n\u5b9f\u73fe\u65b9\u6cd5\n\u793e\u5185\u30a4\u30f3\u30c8\u30e9\u5185\u306b\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u3068\u3057\u3066\u8a2d\u7f6e\u3002\n\u5404\u30e1\u30f3\u30d0\u30fc\u306f\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30af\u306eAPI\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u305f\u3089\u3001\u305d\u308c\u3092\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u304b\u3089\u5165\u529b\u3057\u305f\u4e0a\u3067\u3001\u30bf\u30b9\u30af\u3092\u8ffd\u52a0\u3059\u308b\u5bfe\u8c61\u306e\u4eba\u3092\u9078\u629e\u3057\u3066\u30dc\u30bf\u30f3\u3092\u62bc\u3059\uff08\u305d\u308c\u3063\u3066\u7d50\u5c40\u624b\u52d5\u3067\u306f\u306a\u3044\u306e\u304b\uff1f\u3068\u3044\u3046\u8b70\u8ad6\u3082\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u81ea\u5206\u306e\u5f53\u65e5\u306e\u30bf\u30b9\u30af\u3092\u7d42\u3048\u3066\u304b\u3089\u6b21\u306e\u4eba\u306b\u30d0\u30c8\u30f3\u3092\u6e21\u3059\u884c\u70ba\u3092\u91cd\u8996\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\n\u30bd\u30fc\u30b9\n\nokome.php\n<?php\n/*\n \u304a\u7c73\u73ed\u30c4\u30fc\u30eb\n \u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u30bf\u30b9\u30af\u3092\u8ffd\u52a0\u3059\u308b\u30da\u30fc\u30b8\n*/\n\n// \u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u8a2d\u5b9a\n$room_id = '21232196';\n\n// \u4e00\u5ea6\u5165\u529b\u3057\u305fAPI\u30c8\u30fc\u30af\u30f3\u306f30\u65e5\u9593\u6709\u52b9\u306b\u3059\u308b\nif (!empty($_COOKIE['okome'])) {\n session_id($_COOKIE['okome']);\n}\nsession_start();\nif ($_POST['submit_token']) {\n $_SESSION['chatwork_token'] = $_POST['token'];\n session_regenerate_id();\n setcookie('okome', session_id(), strtotime( '+30 days' ));\n}\nif (empty($_SESSION['chatwork_token'])) {\n $login = false;\n} else {\n // API\u30c8\u30fc\u30af\u30f3\u3092\u5143\u306b\u81ea\u5206\u306e\u60c5\u5831\u3092\u53d6\u5f97\n $header = array(\n  \"Content-Type: application/x-www-form-urlencoded\",\n  \"X-ChatWorkToken: \" . $_SESSION['chatwork_token'],\n );\n $context = array(\n  \"http\" => array(\n   \"method\"  => \"GET\",\n   \"header\"  => implode(\"\\r\\n\", $header),\n  )\n );\n $json = file_get_contents('https://api.chatwork.com/v1/me', false, stream_context_create($context));\n if (empty($json)) {\n  $login = false;\n } else {\n  $mydata = json_decode($json, true);\n  if (!empty($mydata) && !empty($mydata['name'])) {\n   $login = true;\n   // member\u4e00\u89a7\u3092\u53d6\u5f97\n   $room_json = file_get_contents('https://api.chatwork.com/v1/rooms/'. $room_id .'/members', false, stream_context_create($context));\n   $members_data = json_decode($room_json, true);\n  } else {\n   $login = false;\n  }\n }\n}\n\nif (!$login) {\n // API\u30c8\u30fc\u30af\u30f3\u5165\u529b\u304c\u306a\u3044 or \u81ea\u5206\u81ea\u8eab\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\n ?>\n  <html><body>\n   API\u30c8\u30fc\u30af\u30f3\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002<br />\n   <form method=\"POST\" action=\"okome.php\">\n    <input name=\"token\" type=\"text\" /> <input type=\"submit\" name=\"submit_token\" value=\"\u9001\u4fe1\" />\n   </form>\n  </body></html>\n <?php\n exit;\n}\n\nif ($_POST['submit']) {\n // \u30bf\u30b9\u30af\u8ffd\u52a0\u5b9f\u884c\u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u305f\u3089\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\n add_chatwork_task($_POST['date'], $_POST['to_id'], $room_id, $_SESSION['chatwork_token']);\n}\n?>\n<html>\n<head>\n <link rel=\"stylesheet\" href=\"//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css\">\n <script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js\"></script>\n <script src=\"//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js\"></script>\n <script type=\"text/javascript\">//<![CDATA[ \n $(window).load(function(){\n  jQuery(function($) {\n   $(\".datepicker\").datepicker({ dateFormat: 'yy-mm-dd', minDate: new Date() });\n  });\n });//]]>  \n </script>\n</head>\n\n<body>\n<h1>\u304a\u7c73\u73ed \u30bf\u30b9\u30af\u8ffd\u52a0</h1>\n\n<h2><?php echo $mydata['name']; ?>\u3055\u3093</h2>\n\n<form method=\"POST\" action=\"okome.php\">\n <dl>\n  <dt>\u65e5\u4ed8\uff1a</dt>\n  <dd>\n   <input class=\"datepicker\" type=\"text\" name=\"date\" /> (\u672a\u5165\u529b\u306e\u5834\u5408\u306f\u7fcc\u5e73\u65e5)\n  </dd>\n  <dt>\u30e1\u30f3\u30d0\u30fc\uff1a</dt>\n  <dd>\n   <select name=\"to_id\">\n    <?php foreach($members_data as $members): ?>\n     <option value=\"<?php echo $members['account_id']; ?>\"><?php echo $members['name']; ?></option>\n    <?php endforeach; ?>\n   </select>\n  </dd>\n </dl>\n <input type=\"submit\" name=\"submit\" value=\"\u8ffd\u52a0\u3059\u308b\" />\n</form>\n\n<?php\nif ($_POST['submit']) {\n echo '<p>\u30bf\u30b9\u30af\u8ffd\u52a0\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3044\u307e\u3057\u305f\u3002</p>';\n}\n?>\n</body>\n</html>\n\n<?php // \u4ee5\u964d\u3001\u95a2\u6570\u306e\u307f\n\n /*\n  \u898f\u5b9a\u306e\u30bf\u30b9\u30af\u3092\u3001\u5165\u529b\u3055\u308c\u305froom_id \u3067 to_id \u306e\u4eba\u306b\u5bfe\u3057\u3066\u4f5c\u6210\u3059\u308b\u3002\n */\n function add_chatwork_task($date = NULL, $to_id = 1111111, $room_id = 9999999999, $api_token = \"abababababa\")\n  {\n   $url = 'https://api.chatwork.com/v1/rooms/' . $room_id . '/tasks';\n\n   if (empty($date)) {\n    $time = strtotime(\"next weekday\");\n   } else {\n    $time = strtotime($date);\n   }\n\n   // POST\u30c7\u30fc\u30bf\n   $data_set = array(\n    array(\n     \"body\" => \"11\u6642\u307e\u3067\u306b\u708a\u98ef\u30bb\u30c3\u30c8\",\n     \"limit\" => $time,\n     \"to_ids\" => $to_id,\n    ),\n    array(\n     \"body\" => \"14\u6642\u4ee5\u964d\u3001\u4f59\u308a\u306e\u98ef\u3092\u4f55\u3068\u304b\u3057\u3066\u91dc\u3092\u6d17\u3046\",\n     \"limit\" => $time,\n     \"to_ids\" => $to_id,\n    ),\n    array(\n     \"body\" => \"\u6b21\u306e\u4eba\u306e\u30bf\u30b9\u30af\u3092\u8ffd\u52a0\",\n     \"limit\" => $time,\n     \"to_ids\" => $to_id,\n    ),\n   );\n\n  foreach ($data_set as $data) {\n   $data = http_build_query($data, \"\", \"&\");\n\n   // header\n   $header = array(\n    \"Content-Type: application/x-www-form-urlencoded\",\n    \"Content-Length: \".strlen($data),\n    \"X-ChatWorkToken: \" . $api_token,\n   );\n\n   $context = array(\n    \"http\" => array(\n     \"method\"  => \"POST\",\n     \"header\"  => implode(\"\\r\\n\", $header),\n     \"content\" => $data\n    )\n   );\n\n   $result = file_get_contents($url, false, stream_context_create($context));\n  }\n  return $result; // \u7279\u306b\u623b\u3059\u610f\u5473\u7121\u3044\u3051\u3069\n }\n\n\n\n\n\u8ab2\u984c\n\u30e1\u30f3\u30d0\u30fc\u4e00\u89a7\u304cHTML\u5185\u306b\u30d9\u30bf\u66f8\u304d\u306a\u306e\u3067\u3001\u3053\u308c\u3082API\u304b\u3089\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\u3002 veryblue\u69d8\u306b\u4fee\u6b63\u3057\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\u524d\u63d0\n=\n\u793e\u5185\u306e\u6570\u540d\u3067\u7c73\u3092\u708a\u3044\u3066\u4e2d\u98df\u3092\u3057\u3066\u3044\u307e\u3059\u3002\n\u708a\u98ef\u3084\u5f8c\u7247\u4ed8\u3051\u3092\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30bf\u30b9\u30af\u3067\u7ba1\u7406\u30fb\u5171\u6709\u3057\u3066\u3044\u307e\u3059\u3002\n\u305f\u3060\u3001**\u6b21\u306e\u4eba\u306e\u30bf\u30b9\u30af\u3092\u8ffd\u52a0\u3059\u308b**\u3068\u3044\u3046\u4f5c\u696d\u304c\u6bce\u56de\u9762\u5012\u306a\u306e\u3067\u3001\u81ea\u52d5\u5316\u3067\u304d\u306a\u3044\u304b[API\u4ed5\u69d8](http://developer.chatwork.com/ja/)\u3092\u63a2\u3063\u3066\u5b9f\u73fe\u3057\u307e\u3057\u305f\u3002\n\n\u5b9f\u73fe\u65b9\u6cd5\n=\n\u793e\u5185\u30a4\u30f3\u30c8\u30e9\u5185\u306b\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u3068\u3057\u3066\u8a2d\u7f6e\u3002\n\u5404\u30e1\u30f3\u30d0\u30fc\u306f\u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30af\u306eAPI\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u305f\u3089\u3001\u305d\u308c\u3092\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u304b\u3089\u5165\u529b\u3057\u305f\u4e0a\u3067\u3001\u30bf\u30b9\u30af\u3092\u8ffd\u52a0\u3059\u308b\u5bfe\u8c61\u306e\u4eba\u3092\u9078\u629e\u3057\u3066\u30dc\u30bf\u30f3\u3092\u62bc\u3059\uff08\u305d\u308c\u3063\u3066\u7d50\u5c40**\u624b\u52d5**\u3067\u306f\u306a\u3044\u306e\u304b\uff1f\u3068\u3044\u3046\u8b70\u8ad6\u3082\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u81ea\u5206\u306e\u5f53\u65e5\u306e\u30bf\u30b9\u30af\u3092\u7d42\u3048\u3066\u304b\u3089\u6b21\u306e\u4eba\u306b\u30d0\u30c8\u30f3\u3092\u6e21\u3059\u884c\u70ba\u3092\u91cd\u8996\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\n\u30bd\u30fc\u30b9\n=\n```php:okome.php\n<?php\n/*\n \u304a\u7c73\u73ed\u30c4\u30fc\u30eb\n \u30c1\u30e3\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u30bf\u30b9\u30af\u3092\u8ffd\u52a0\u3059\u308b\u30da\u30fc\u30b8\n*/\n\n// \u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u8a2d\u5b9a\n$room_id = '21232196';\n\n// \u4e00\u5ea6\u5165\u529b\u3057\u305fAPI\u30c8\u30fc\u30af\u30f3\u306f30\u65e5\u9593\u6709\u52b9\u306b\u3059\u308b\nif (!empty($_COOKIE['okome'])) {\n session_id($_COOKIE['okome']);\n}\nsession_start();\nif ($_POST['submit_token']) {\n $_SESSION['chatwork_token'] = $_POST['token'];\n session_regenerate_id();\n setcookie('okome', session_id(), strtotime( '+30 days' ));\n}\nif (empty($_SESSION['chatwork_token'])) {\n $login = false;\n} else {\n // API\u30c8\u30fc\u30af\u30f3\u3092\u5143\u306b\u81ea\u5206\u306e\u60c5\u5831\u3092\u53d6\u5f97\n $header = array(\n  \"Content-Type: application/x-www-form-urlencoded\",\n  \"X-ChatWorkToken: \" . $_SESSION['chatwork_token'],\n );\n $context = array(\n  \"http\" => array(\n   \"method\"  => \"GET\",\n   \"header\"  => implode(\"\\r\\n\", $header),\n  )\n );\n $json = file_get_contents('https://api.chatwork.com/v1/me', false, stream_context_create($context));\n if (empty($json)) {\n  $login = false;\n } else {\n  $mydata = json_decode($json, true);\n  if (!empty($mydata) && !empty($mydata['name'])) {\n   $login = true;\n   // member\u4e00\u89a7\u3092\u53d6\u5f97\n   $room_json = file_get_contents('https://api.chatwork.com/v1/rooms/'. $room_id .'/members', false, stream_context_create($context));\n   $members_data = json_decode($room_json, true);\n  } else {\n   $login = false;\n  }\n }\n}\n\nif (!$login) {\n // API\u30c8\u30fc\u30af\u30f3\u5165\u529b\u304c\u306a\u3044 or \u81ea\u5206\u81ea\u8eab\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\n ?>\n  <html><body>\n   API\u30c8\u30fc\u30af\u30f3\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002<br />\n   <form method=\"POST\" action=\"okome.php\">\n    <input name=\"token\" type=\"text\" /> <input type=\"submit\" name=\"submit_token\" value=\"\u9001\u4fe1\" />\n   </form>\n  </body></html>\n <?php\n exit;\n}\n\nif ($_POST['submit']) {\n // \u30bf\u30b9\u30af\u8ffd\u52a0\u5b9f\u884c\u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u305f\u3089\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\n add_chatwork_task($_POST['date'], $_POST['to_id'], $room_id, $_SESSION['chatwork_token']);\n}\n?>\n<html>\n<head>\n <link rel=\"stylesheet\" href=\"//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css\">\n <script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js\"></script>\n <script src=\"//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js\"></script>\n <script type=\"text/javascript\">//<![CDATA[ \n $(window).load(function(){\n  jQuery(function($) {\n   $(\".datepicker\").datepicker({ dateFormat: 'yy-mm-dd', minDate: new Date() });\n  });\n });//]]>  \n </script>\n</head>\n\n<body>\n<h1>\u304a\u7c73\u73ed \u30bf\u30b9\u30af\u8ffd\u52a0</h1>\n\n<h2><?php echo $mydata['name']; ?>\u3055\u3093</h2>\n\n<form method=\"POST\" action=\"okome.php\">\n <dl>\n  <dt>\u65e5\u4ed8\uff1a</dt>\n  <dd>\n   <input class=\"datepicker\" type=\"text\" name=\"date\" /> (\u672a\u5165\u529b\u306e\u5834\u5408\u306f\u7fcc\u5e73\u65e5)\n  </dd>\n  <dt>\u30e1\u30f3\u30d0\u30fc\uff1a</dt>\n  <dd>\n   <select name=\"to_id\">\n    <?php foreach($members_data as $members): ?>\n     <option value=\"<?php echo $members['account_id']; ?>\"><?php echo $members['name']; ?></option>\n    <?php endforeach; ?>\n   </select>\n  </dd>\n </dl>\n <input type=\"submit\" name=\"submit\" value=\"\u8ffd\u52a0\u3059\u308b\" />\n</form>\n\n<?php\nif ($_POST['submit']) {\n echo '<p>\u30bf\u30b9\u30af\u8ffd\u52a0\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3044\u307e\u3057\u305f\u3002</p>';\n}\n?>\n</body>\n</html>\n\n<?php // \u4ee5\u964d\u3001\u95a2\u6570\u306e\u307f\n\n /*\n  \u898f\u5b9a\u306e\u30bf\u30b9\u30af\u3092\u3001\u5165\u529b\u3055\u308c\u305froom_id \u3067 to_id \u306e\u4eba\u306b\u5bfe\u3057\u3066\u4f5c\u6210\u3059\u308b\u3002\n */\n function add_chatwork_task($date = NULL, $to_id = 1111111, $room_id = 9999999999, $api_token = \"abababababa\")\n  {\n   $url = 'https://api.chatwork.com/v1/rooms/' . $room_id . '/tasks';\n\n   if (empty($date)) {\n    $time = strtotime(\"next weekday\");\n   } else {\n    $time = strtotime($date);\n   }\n\n   // POST\u30c7\u30fc\u30bf\n   $data_set = array(\n    array(\n     \"body\" => \"11\u6642\u307e\u3067\u306b\u708a\u98ef\u30bb\u30c3\u30c8\",\n     \"limit\" => $time,\n     \"to_ids\" => $to_id,\n    ),\n    array(\n     \"body\" => \"14\u6642\u4ee5\u964d\u3001\u4f59\u308a\u306e\u98ef\u3092\u4f55\u3068\u304b\u3057\u3066\u91dc\u3092\u6d17\u3046\",\n     \"limit\" => $time,\n     \"to_ids\" => $to_id,\n    ),\n    array(\n     \"body\" => \"\u6b21\u306e\u4eba\u306e\u30bf\u30b9\u30af\u3092\u8ffd\u52a0\",\n     \"limit\" => $time,\n     \"to_ids\" => $to_id,\n    ),\n   );\n\n  foreach ($data_set as $data) {\n   $data = http_build_query($data, \"\", \"&\");\n\n   // header\n   $header = array(\n    \"Content-Type: application/x-www-form-urlencoded\",\n    \"Content-Length: \".strlen($data),\n    \"X-ChatWorkToken: \" . $api_token,\n   );\n\n   $context = array(\n    \"http\" => array(\n     \"method\"  => \"POST\",\n     \"header\"  => implode(\"\\r\\n\", $header),\n     \"content\" => $data\n    )\n   );\n\n   $result = file_get_contents($url, false, stream_context_create($context));\n  }\n  return $result; // \u7279\u306b\u623b\u3059\u610f\u5473\u7121\u3044\u3051\u3069\n }\n\n```\n\n\u8ab2\u984c\n=\n~~\u30e1\u30f3\u30d0\u30fc\u4e00\u89a7\u304cHTML\u5185\u306b\u30d9\u30bf\u66f8\u304d\u306a\u306e\u3067\u3001\u3053\u308c\u3082API\u304b\u3089\u4e00\u89a7\u3092\u53d6\u5f97\u3059\u308b\u3002~~ veryblue\u69d8\u306b\u4fee\u6b63\u3057\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n", "tags": ["chatwork", "PHP"]}