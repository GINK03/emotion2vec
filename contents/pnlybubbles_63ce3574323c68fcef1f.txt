{"context": "\n\n\u6982\u8981\nGrimoire.js\u3092\u3064\u304b\u3063\u3066\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u4f5c\u3063\u3066\u5909\u5f62\u3055\u305b\u308b\u8a71\u3002\nGrimoire.js\u306b\u3064\u3044\u3066\u306e\u57fa\u672c\u7684\u306a\u3053\u3068\u306f\u4ed6\u306e\u8a18\u4e8b\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u95a2\u3059\u308b\u8aac\u660e\u306f\u3042\u307e\u308a\u3057\u307e\u305b\u3093\u3002\n\u3067\u304d\u305f\u3082\u306e\u2193\nhttps://pnlybubbles-gomibako.github.io/grimoirejs-advent-calendar-14/\n\n\u65b0\u3057\u3044\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u4f5c\u308b\n\u4eca\u56de\u306f\u677f(ita)\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u4f5c\u308a\u307e\u3059\u3002\u5909\u5f62\u3055\u305b\u308b\u305f\u3081\u306b\u30dd\u30ea\u30b4\u30f3\u306e\u5206\u5272\u6570(div)\u3092\u6307\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u767b\u9332\n\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u30bf\u30b0\u304b\u3089\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b\u306fGeometryFactory.addType()\u3092\u7528\u3044\u307e\u3059\u3002\nGeometryFactory.addType(\"ita\", {\n  div: {\n    converter: 'Vector3',\n    defaultValue: '2,2,2',\n  },\n}, (gl, attrs) => {\n  const geo = new Geometry;\n  //\n  // \u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u5b9f\u88c5\n  //\n  return geo;\n});\n\n\u3053\u308c\u3067Goml\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u4e0b\u306e\u3088\u3046\u306b\u30bf\u30b0\u3067\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u5229\u7528\u3067\u304d\u308b\u3088\u306b\u306a\u308a\u307e\u3059\u3002\n<geometry type=\"ita\" name=\"myIta\" div=\"10,1,1\" />\n\n\u7b2c2\u5f15\u6570\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306fGOML\u304b\u3089\u6307\u5b9a\u53ef\u80fd\u306a\u5c5e\u6027\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002\u4eca\u56de\u306f\u8ef8\u65b9\u5411\u3067\u306e\u5206\u5272\u6570\u3092\u6307\u5b9a\u53ef\u80fd\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n{\n  div: {\n    converter: 'Vector3',\n    defaultValue: '2,2,2',\n  },\n}\n\n\u3053\u3053\u3067\u5b9a\u7fa9\u3057\u305f\u5c5e\u6027\u306f\u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u5b9f\u88c5\u306e\u90e8\u5206\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3059\u3002\u30bf\u30b0\u3067\u6307\u5b9a\u3055\u308c\u305f\u6587\u5b57\u5217\u306fconverter\u3092\u901a\u308a\u3001\u4eca\u56de\u306e\u5834\u5408\u306fVector3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u3057\u3066\u5f97\u3089\u308c\u307e\u3059\u3002\n(gl, attrs) => {\n  console.log(attrs.div) // Vector3(2,2,2)\n}\n\n\n\u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u4f5c\u6210\n\u5148\u7a0b\u306e\u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u5b9f\u88c5\u90e8\u5206\u3067\u3001Geometry\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u60c5\u5831\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f\u5177\u4f53\u7684\u306a\u5b9f\u88c5(Ita)\u306b\u95a2\u3057\u3066\u306f\u5272\u611b\u3057\u307e\u3059\u3002\nconst ita = new Ita(attr.div);\nconst geometry = new Geometry(gl);\ngeometry.addAttributes(ita.vertices, primitiveLayout);\ngeometry.addIndex('default', ita.indices);\ngeometry.addIndex('wireframe', ita.wireframeIndices, WebGLRenderingContext.LINES);\n\ngeometry.addAttributes(vertices, layout);\u3067\u9802\u70b9\u306e\u60c5\u5831\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002verticies\u3067\u306f\u9802\u70b9\u306e\u5ea7\u6a19\u3001\u6cd5\u7dda\u3001\u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19\u3001\u306a\u3069\u304c1\u3064\u306e\u914d\u5217\u306b\u306f\u3044\u3063\u3066\u3044\u307e\u3059\u3002layout\u3067\u306f\u305d\u306e\u914d\u5217\u306e\u69cb\u6210\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\u30a4\u30f3\u30bf\u30fc\u30ea\u30fc\u30d6\u914d\u5217\u306e\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u30a4\u30f3\u30bf\u30fc\u30ea\u30fc\u30d6\u914d\u5217\u306b\u95a2\u3057\u3066\u306f\u3053\u3061\u3089\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059\n// \u4eca\u56de\u306e\u5834\u5408vertices\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u914d\u5217\u306a\u306e\u3067\n// vertices = [Px1, Py1, Pz1, Nx1, Ny1, Ny1, Tx1, Ty1, Px2, Py2, Pz2, Nx2, Ny2, Ny2, Tx2, Ty2...]\nconst primitiveLayout = {\n  POSITION: {\n    size: 3, // x, y, z \u306e3\u8981\u7d20\u30671\u304b\u305f\u307e\u308a\n    stride: 32, // \u6b21\u306e\u8981\u7d20\u306ePOSITION\u307e\u306732byte\n  },\n  NORMAL: {\n    size: 3, // x, y, z \u306e3\u8981\u7d20\u30671\u304b\u305f\u307e\u308a\n    stride: 32, // \u6b21\u306e\u8981\u7d20\u306eNORMAL\u307e\u306732byte\n    offset: 12, \n  },\n  TEXCOORD: {\n    size: 2, // x, y\u3000\u306e2\u8981\u7d20\u30671\u304b\u305f\u307e\u308a\n    stride: 32, // \u6b21\u306e\u8981\u7d20\u306eTEXCOORD\u307e\u306732byte\n    offset: 24,\n  }\n};\n\ngeometry.addIndex(name, layout, topology);\u3067\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002name\u306bdefault\u3092\u6307\u5b9a\u3059\u308b\u3068\u521d\u671f\u3067\u4f7f\u308f\u308c\u308b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u306a\u308a\u307e\u3059\u3002topology\u3092\u7701\u7565\u3059\u308b\u3068WebGLRenderingContext.TRIANGLES\u304c\u4f7f\u308f\u308c\u307e\u3059\u3002\u53c2\u8003\n\u307e\u305fname\u3067\u6307\u5b9a\u3057\u305fdefault\u4ee5\u5916\u306e\u540d\u524d\u306fmesh\u30bf\u30b0\u3067\u306etargetBuffer\u3067\u4e0b\u306e\u3088\u3046\u306b\u6307\u5b9a\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n<mesh geometry=\"ita\" targetBuffer=\"wireframe\" div=\"2,2,2\"/>\n\n\n\n\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u5909\u5f62\u3055\u305b\u308b\n\u4eca\u56de\u306f\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u3067\u5909\u5f62\u3092\u884c\u3044\u305f\u3044\u306e\u3067vertex shader\u3092\u7528\u3044\u3066\u9802\u70b9\u5ea7\u6a19\u3092\u3044\u3058\u308a\u307e\u3059\u3002\nGrimoire.js\u3067\u30b7\u30a7\u30fc\u30c0\u30fc\u3092\u66f8\u304f\u3068\u304d\u306f.sort\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u3044\u307e\u3059\u3002\n#ifdef VS\u306e\u4e2d\u304cvertex shader\u3068\u306a\u308a\u3001fragment shader\u306e\u6642\u3068\u540c\u69d8\u306b@{default:\"\"}\u3068\u3044\u3063\u305f\u8a18\u6cd5\u3067\u30bf\u30b0\u306buniform\u5909\u6570\u3092\u9732\u51fa\u3055\u305b\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n@Pass {\n  @DepthFunc(LEQUAL)\n  @BlendFunc(SRC_ALPHA, ONE_MINUS_SRC_ALPHA)\n  @CullFace(BACK)\n\n  FS_PREC(mediump,float)\n\n  varying vec2 vTexCoord;\n  varying vec3 vNormal;\n  varying vec3 vPosition;\n\n  #ifdef VS\n    attribute vec3 position;\n    attribute vec3 normal;\n    attribute vec2 texCoord;\n    uniform mat4 _matPVM;\n    uniform mat4 _matM;\n    @{default:\"-1\"}\n    uniform float radius; // \u9069\u5f53\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30bf\u30b0\u306b\u9732\u51fa\u3055\u305b\u308b\n    @{default:\"0.1\"}\n    uniform float coef; // \u9069\u5f53\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30bf\u30b0\u306b\u9732\u51fa\u3055\u305b\u308b\n    void main(){\n      float phi = position.x / radius;\n      // \u4e2d\u5fc3\u304b\u3089\u96e2\u308c\u308b\u307b\u3069y\u5ea7\u6a19\u3092\u6301\u3061\u4e0a\u3052\u308b\n      vec3 tposition = vec3(radius * sin(phi), radius * (1. - cos(phi)) / coef + position.y, position.z);\n      gl_Position = _matPVM * vec4(tposition, 1.);\n      vTexCoord = texCoord;\n      vNormal = normalize((_matM * vec4(normal, 0.)).xyz);\n      vec4 p = _matM * vec4(tposition, 1.);\n      vPosition = p.xyz / p.w;\n    }\n  #endif\n\n  #ifdef FS\n    // \u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\n  #endif\n}\n\n<import-material typeName=\"mageru\" src=\"./mageru.sort\"/>\n<material type=\"mageru\" radius=\"2\" coef=\"0.13\" texture=\"tex.jpg\"/>\n\n\u4f5c\u3063\u305f\u30de\u30c6\u30ea\u30a2\u30eb\u3092mesh\u3067\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\n<mesh class=\"ita\" geometry=\"ita\" material=\"#mageru\" scale=\"6,1,6\" />\n\n\u307e\u304c\u308b\n\njavascript\u3092\u4f7f\u3063\u3066mesh\u306e\u5c5e\u6027\u3092\u6bce\u30d5\u30ec\u30fc\u30e0\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u3067\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3055\u305b\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u306d\u3002\n\u3044\u3061\u304a\u3046\u4e0b\u306e\u30ea\u30f3\u30af\u3067\u3044\u3058\u308c\u307e\u3059\u3002\nhttps://pnlybubbles-gomibako.github.io/grimoirejs-advent-calendar-14/\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\nhttps://github.com/pnlybubbles-gomibako/grimoirejs-advent-calendar-14\n\n\ud83c\udf63\uff1f\n\n## \u6982\u8981\n\nGrimoire.js\u3092\u3064\u304b\u3063\u3066\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u4f5c\u3063\u3066\u5909\u5f62\u3055\u305b\u308b\u8a71\u3002\n\n[Grimoire.js](https://grimoire.gl)\u306b\u3064\u3044\u3066\u306e\u57fa\u672c\u7684\u306a\u3053\u3068\u306f\u4ed6\u306e\u8a18\u4e8b\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\n\u30b7\u30a7\u30fc\u30c0\u30fc\u306b\u95a2\u3059\u308b\u8aac\u660e\u306f\u3042\u307e\u308a\u3057\u307e\u305b\u3093\u3002\n\n\u3067\u304d\u305f\u3082\u306e\u2193\n\nhttps://pnlybubbles-gomibako.github.io/grimoirejs-advent-calendar-14/\n\n## \u65b0\u3057\u3044\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u4f5c\u308b\n\n\u4eca\u56de\u306f\u677f(ita)\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u4f5c\u308a\u307e\u3059\u3002\u5909\u5f62\u3055\u305b\u308b\u305f\u3081\u306b\u30dd\u30ea\u30b4\u30f3\u306e\u5206\u5272\u6570(div)\u3092\u6307\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n### \u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u767b\u9332\n\n\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u30bf\u30b0\u304b\u3089\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u305f\u3081\u306b\u306f`GeometryFactory.addType()`\u3092\u7528\u3044\u307e\u3059\u3002\n\n```javascript\nGeometryFactory.addType(\"ita\", {\n  div: {\n    converter: 'Vector3',\n    defaultValue: '2,2,2',\n  },\n}, (gl, attrs) => {\n  const geo = new Geometry;\n  //\n  // \u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u5b9f\u88c5\n  //\n  return geo;\n});\n```\n\n\u3053\u308c\u3067Goml\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u4e0b\u306e\u3088\u3046\u306b\u30bf\u30b0\u3067\u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u5229\u7528\u3067\u304d\u308b\u3088\u306b\u306a\u308a\u307e\u3059\u3002\n\n```xml\n<geometry type=\"ita\" name=\"myIta\" div=\"10,1,1\" />\n```\n\n\u7b2c2\u5f15\u6570\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306fGOML\u304b\u3089\u6307\u5b9a\u53ef\u80fd\u306a\u5c5e\u6027\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u307e\u3059\u3002\u4eca\u56de\u306f\u8ef8\u65b9\u5411\u3067\u306e\u5206\u5272\u6570\u3092\u6307\u5b9a\u53ef\u80fd\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```javascript\n{\n  div: {\n    converter: 'Vector3',\n    defaultValue: '2,2,2',\n  },\n}\n```\n\n\u3053\u3053\u3067\u5b9a\u7fa9\u3057\u305f\u5c5e\u6027\u306f\u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u5b9f\u88c5\u306e\u90e8\u5206\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3059\u3002\u30bf\u30b0\u3067\u6307\u5b9a\u3055\u308c\u305f\u6587\u5b57\u5217\u306f`converter`\u3092\u901a\u308a\u3001\u4eca\u56de\u306e\u5834\u5408\u306f`Vector3`\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u3057\u3066\u5f97\u3089\u308c\u307e\u3059\u3002\n\n```javascript\n(gl, attrs) => {\n  console.log(attrs.div) // Vector3(2,2,2)\n}\n```\n\n### \u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u4f5c\u6210\n\n\u5148\u7a0b\u306e\u30b8\u30aa\u30e1\u30c8\u30ea\u306e\u5b9f\u88c5\u90e8\u5206\u3067\u3001`Geometry`\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u60c5\u5831\u3092\u8ffd\u52a0\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u5177\u4f53\u7684\u306a\u5b9f\u88c5(`Ita`)\u306b\u95a2\u3057\u3066\u306f\u5272\u611b\u3057\u307e\u3059\u3002\n\n```javascript\nconst ita = new Ita(attr.div);\nconst geometry = new Geometry(gl);\ngeometry.addAttributes(ita.vertices, primitiveLayout);\ngeometry.addIndex('default', ita.indices);\ngeometry.addIndex('wireframe', ita.wireframeIndices, WebGLRenderingContext.LINES);\n```\n\n`geometry.addAttributes(vertices, layout);`\u3067\u9802\u70b9\u306e\u60c5\u5831\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002verticies\u3067\u306f\u9802\u70b9\u306e\u5ea7\u6a19\u3001\u6cd5\u7dda\u3001\u30c6\u30af\u30b9\u30c1\u30e3\u5ea7\u6a19\u3001\u306a\u3069\u304c1\u3064\u306e\u914d\u5217\u306b\u306f\u3044\u3063\u3066\u3044\u307e\u3059\u3002layout\u3067\u306f\u305d\u306e\u914d\u5217\u306e\u69cb\u6210\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\u30a4\u30f3\u30bf\u30fc\u30ea\u30fc\u30d6\u914d\u5217\u306e\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002[\u30a4\u30f3\u30bf\u30fc\u30ea\u30fc\u30d6\u914d\u5217\u306b\u95a2\u3057\u3066\u306f\u3053\u3061\u3089\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3059](https://wgld.org/d/webgl/w088.html)\n\n```javascript\n// \u4eca\u56de\u306e\u5834\u5408vertices\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u914d\u5217\u306a\u306e\u3067\n// vertices = [Px1, Py1, Pz1, Nx1, Ny1, Ny1, Tx1, Ty1, Px2, Py2, Pz2, Nx2, Ny2, Ny2, Tx2, Ty2...]\nconst primitiveLayout = {\n  POSITION: {\n    size: 3, // x, y, z \u306e3\u8981\u7d20\u30671\u304b\u305f\u307e\u308a\n    stride: 32, // \u6b21\u306e\u8981\u7d20\u306ePOSITION\u307e\u306732byte\n  },\n  NORMAL: {\n    size: 3, // x, y, z \u306e3\u8981\u7d20\u30671\u304b\u305f\u307e\u308a\n    stride: 32, // \u6b21\u306e\u8981\u7d20\u306eNORMAL\u307e\u306732byte\n    offset: 12, \n  },\n  TEXCOORD: {\n    size: 2, // x, y\u3000\u306e2\u8981\u7d20\u30671\u304b\u305f\u307e\u308a\n    stride: 32, // \u6b21\u306e\u8981\u7d20\u306eTEXCOORD\u307e\u306732byte\n    offset: 24,\n  }\n};\n```\n\n`geometry.addIndex(name, layout, topology);`\u3067\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002name\u306b`default`\u3092\u6307\u5b9a\u3059\u308b\u3068\u521d\u671f\u3067\u4f7f\u308f\u308c\u308b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u306a\u308a\u307e\u3059\u3002`topology`\u3092\u7701\u7565\u3059\u308b\u3068`WebGLRenderingContext.TRIANGLES`\u304c\u4f7f\u308f\u308c\u307e\u3059\u3002[\u53c2\u8003](http://miffysora.wikidot.com/primitive)\n\n\u307e\u305fname\u3067\u6307\u5b9a\u3057\u305f`default`\u4ee5\u5916\u306e\u540d\u524d\u306fmesh\u30bf\u30b0\u3067\u306e`targetBuffer`\u3067\u4e0b\u306e\u3088\u3046\u306b\u6307\u5b9a\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\n```xml\n<mesh geometry=\"ita\" targetBuffer=\"wireframe\" div=\"2,2,2\"/>\n```\n\n<img width=\"404\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-01-08 18.20.44.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/14939/08d1ff7d-f43d-8baa-50ec-ce465128c070.png\">\n\n## \u30b8\u30aa\u30e1\u30c8\u30ea\u3092\u5909\u5f62\u3055\u305b\u308b\n\n\u4eca\u56de\u306f\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u3067\u5909\u5f62\u3092\u884c\u3044\u305f\u3044\u306e\u3067vertex shader\u3092\u7528\u3044\u3066\u9802\u70b9\u5ea7\u6a19\u3092\u3044\u3058\u308a\u307e\u3059\u3002\n\nGrimoire.js\u3067\u30b7\u30a7\u30fc\u30c0\u30fc\u3092\u66f8\u304f\u3068\u304d\u306f`.sort`\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u3044\u307e\u3059\u3002\n\n`#ifdef VS`\u306e\u4e2d\u304cvertex shader\u3068\u306a\u308a\u3001fragment shader\u306e\u6642\u3068\u540c\u69d8\u306b@{default:\"\"}\u3068\u3044\u3063\u305f\u8a18\u6cd5\u3067\u30bf\u30b0\u306buniform\u5909\u6570\u3092\u9732\u51fa\u3055\u305b\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n```glsl\n@Pass {\n  @DepthFunc(LEQUAL)\n  @BlendFunc(SRC_ALPHA, ONE_MINUS_SRC_ALPHA)\n  @CullFace(BACK)\n\n  FS_PREC(mediump,float)\n\n  varying vec2 vTexCoord;\n  varying vec3 vNormal;\n  varying vec3 vPosition;\n\n  #ifdef VS\n    attribute vec3 position;\n    attribute vec3 normal;\n    attribute vec2 texCoord;\n    uniform mat4 _matPVM;\n    uniform mat4 _matM;\n    @{default:\"-1\"}\n    uniform float radius; // \u9069\u5f53\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30bf\u30b0\u306b\u9732\u51fa\u3055\u305b\u308b\n    @{default:\"0.1\"}\n    uniform float coef; // \u9069\u5f53\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30bf\u30b0\u306b\u9732\u51fa\u3055\u305b\u308b\n    void main(){\n      float phi = position.x / radius;\n      // \u4e2d\u5fc3\u304b\u3089\u96e2\u308c\u308b\u307b\u3069y\u5ea7\u6a19\u3092\u6301\u3061\u4e0a\u3052\u308b\n      vec3 tposition = vec3(radius * sin(phi), radius * (1. - cos(phi)) / coef + position.y, position.z);\n      gl_Position = _matPVM * vec4(tposition, 1.);\n      vTexCoord = texCoord;\n      vNormal = normalize((_matM * vec4(normal, 0.)).xyz);\n      vec4 p = _matM * vec4(tposition, 1.);\n      vPosition = p.xyz / p.w;\n    }\n  #endif\n\n  #ifdef FS\n    // \u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u30b7\u30a7\u30fc\u30c0\u30fc\n  #endif\n}\n```\n\n```xml\n<import-material typeName=\"mageru\" src=\"./mageru.sort\"/>\n<material type=\"mageru\" radius=\"2\" coef=\"0.13\" texture=\"tex.jpg\"/>\n```\n\n\u4f5c\u3063\u305f\u30de\u30c6\u30ea\u30a2\u30eb\u3092mesh\u3067\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\n\n```xml\n<mesh class=\"ita\" geometry=\"ita\" material=\"#mageru\" scale=\"6,1,6\" />\n```\n\n\u307e\u304c\u308b\n\n<img width=\"452\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-01-08 18.14.25.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/14939/9d97d433-b1a3-9dd8-7ede-8dbeb08ec472.png\">\n\njavascript\u3092\u4f7f\u3063\u3066mesh\u306e\u5c5e\u6027\u3092\u6bce\u30d5\u30ec\u30fc\u30e0\u66f8\u304d\u63db\u3048\u308b\u3053\u3068\u3067\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3055\u305b\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u306d\u3002\n\n\u3044\u3061\u304a\u3046\u4e0b\u306e\u30ea\u30f3\u30af\u3067\u3044\u3058\u308c\u307e\u3059\u3002\n\nhttps://pnlybubbles-gomibako.github.io/grimoirejs-advent-calendar-14/\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\n\nhttps://github.com/pnlybubbles-gomibako/grimoirejs-advent-calendar-14\n\n## \ud83c\udf63\uff1f\n\n<img width=\"422\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2017-01-08 18.36.46.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/14939/f6a5ed5d-319b-8647-deda-77ba95223f31.png\">\n", "tags": ["Grimoire.js", "WebGL", "GLSL"]}