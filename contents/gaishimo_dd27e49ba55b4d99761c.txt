{"context": "\n\n\u6982\u8981\n\u524d\u56de\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3067Apex\u3092\u4f7f\u3063\u3066Lambda\u3092\u74b0\u5883\u5225\u306b\u7ba1\u7406\u3059\u308b\u65b9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u304c\u3001\nLambda with Apex: \u74b0\u5883\u5909\u6570\u3067\u74b0\u5883\u5225\u306bLambda\u74b0\u5883\u3092\u6574\u3048\u308b - Qiita\n\u4eca\u56de\u306fApex\u3067Terraform\u3092\u4f7f\u3063\u3066Lambda\u3092\u7ba1\u7406\u3059\u308b\u65b9\u6cd5\u3092\u8a66\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u7b49\n\nOS: Mac OS X 10.11.1\nTerraform: v0.6.16\nApex: 0.9.0\n\u8a00\u8a9e: Go\n\n\n\u4e8b\u524d\u8a2d\u5b9a\n\nTerraform \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nTerraform\u304c\u307e\u3060\u306a\u3044\u5834\u5408\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nDownload Terraform - Terraform by HashiCorp\n\nApex\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nApex\u304c\u307e\u3060\u306a\u3044\u5834\u5408\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\ncurl https://raw.githubusercontent.com/apex/apex/master/install.sh | sh\n\n\nAWS\u8a2d\u5b9a\n\nAWS\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7528\u610f\n\u4eca\u56de\u306f\u74b0\u5883\u3054\u3068\u306bAWS\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u5206\u3051\u3066\u307f\u305f\u3044\u306e\u3067\u3001prod\u7528\u3068dev\u7528\u306bAWS\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7528\u610f\u3057\u305f\u3089 ~/.aws/credentials \u306b\u8a18\u8ff0\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n# dev\u7528\n[default]\nregion=ap-northeast-1\naws_access_key_id=XXXXXXXXXXX\naws_secret_access_key=XXXXXXXXXXX\n\n# prod\u7528\n[prod]\nregion=ap-northeast-1\naws_access_key_id=XXXXXXXXXXX\naws_secret_access_key=XXXXXXXXXXX\n\ndev\u7528\u306eprofile\u3092\u3092default\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n\nS3\u30d0\u30b1\u30c3\u30c8\u306e\u7528\u610f\nTerraform\u306e\u72b6\u614b\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306eS3\u30d0\u30b1\u30c3\u30c8\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u4eca\u56de\u306fapex-terraform-example\u3068\u3044\u3046\u540d\u524d\u306b\u3057\u307e\u3059\u3002\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\u307e\u305a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nmkdir apex_terraform\n\napex\u30b3\u30de\u30f3\u30c9\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\ncd apex_terraform\napex init\n\n\u5bfe\u8a71\u30b3\u30de\u30f3\u30c9\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5165\u529b\u3057\u307e\u3059\u3002\nProject name: apex_terraform\nProject description:\nWould you like to manage infrastructure with Terraform? (yes/no): yes\nEnvironments: dev, prod\nWould you like to store Terraform state on S3? (yes/no): yes\nS3 bucket name: apex-terraform-example\n\nTerraform\u3092\u4f7f\u3046\u304b\u3069\u3046\u304b\u306e\u8cea\u554f\u3067yes\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001Terraform\u306e\u72b6\u614b\u30d5\u30a1\u30a4\u30eb\u3092S3\u306b\u914d\u7f6e\u3059\u308b\u304b\u805e\u304b\u308c\u308b\u306e\u3067\u3001yes\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002yes\u306b\u3059\u308b\u3068S3\u306eBucket\u540d\u3092\u805e\u304b\u308c\u308b\u306e\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u5b8c\u4e86\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u69cb\u6210\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\u251c\u2500\u2500 functions\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 hello\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 index.js\n\u251c\u2500\u2500 infrastructure\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 dev\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.tf\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 modules\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 iam\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 iam.tf\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 outputs.tf\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 prod\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.tf\n\u2514\u2500\u2500 project.json\n\ninfrastructure\u306e\u4e0b\u306bdev/prod\u3068\u74b0\u5883\u5225\u306b\u30d5\u30a9\u30eb\u30c0\u304c\u4f5c\u6210\u3055\u308c\u3001terraform\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u914d\u7f6e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001infrastructure/modules\u306e\u4e0b\u306bIAM\u30ed\u30fc\u30eb\u4f5c\u6210\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u914d\u7f6e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5404\u74b0\u5883\u306emain.tf\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3055\u308c\u3066\u304a\u308a\u3001\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304cIAM\u30ed\u30fc\u30eb\u4f5c\u6210\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\nmodule \"iam\" {\n  source = \"../modules/iam\"\n}\n\noutput \"lambda_function_role_id\" {\n  value = \"${module.iam.lambda_function_role_id}\"\n}\n\n\n\u30a4\u30f3\u30d5\u30e9\u69cb\u7bc9 (dev)\n\u74b0\u5883\u3054\u3068\u306bTerraform\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\u307e\u305aplan\u3067\u5b9f\u884c\u8a08\u753b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n$ apex infra plan\nRefreshing Terraform state prior to plan...\n\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n+ module.iam.aws_iam_role.lambda_function\n    arn:                \"\" => \"<computed>\"\n    assume_role_policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Principal\\\": {\\n        \\\"Service\\\": \\\"lambda.amazonaws.com\\\"\\n      },\\n      \\\"Action\\\": \\\"sts:AssumeRole\\\"\\n    }\\n  ]\\n}\\n\"\n    name:               \"\" => \"$ apex infra plan\nRefreshing Terraform state prior to plan...\n\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n+ module.iam.aws_iam_role.lambda_function\n    arn:                \"\" => \"<computed>\"\n    assume_role_policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Principal\\\": {\\n        \\\"Service\\\": \\\"lambda.amazonaws.com\\\"\\n      },\\n      \\\"Action\\\": \\\"sts:AssumeRole\\\"\\n    }\\n  ]\\n}\\n\"\n    name:               \"\" => \"apex_lambda_function\"\n    path:               \"\" => \"/\"\n    unique_id:          \"\" => \"<computed>\"\n\n+ module.iam.aws_iam_role_policy.cloudwatchlogs_full_access\n    name:   \"\" => \"cloudwatchlogs_full_access\"\n    policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Action\\\": [\\n        \\\"logs:*\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"*\\\"\\n    }\\n  ]\\n}\\n\"\n    role:   \"\" => \"${aws_iam_role.lambda_function.id}\"\n\n\nPlan: 2 to add, 0 to change, 0 to destroy.\"\n    path:               \"\" => \"/\"\n    unique_id:          \"\" => \"<computed>\"\n\n+ module.iam.aws_iam_role_policy.cloudwatchlogs_full_access\n    name:   \"\" => \"cloudwatchlogs_full_access\"\n    policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Action\\\": [\\n        \\\"logs:*\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"*\\\"\\n    }\\n  ]\\n}\\n\"\n    role:   \"\" => \"${aws_iam_role.lambda_function.id}\"\n\n\nPlan: 2 to add, 0 to change, 0 to destroy.\n\nCloudWatch Logs\u3078\u306e\u30d5\u30eb\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3092\u6301\u3064Policy\u4f5c\u6210\u3068\u3001apex_lambda_function\u3068\u3044\u3046\u540d\u524d\u306eIAM Role\u304c\u4f5c\u6210\u3055\u308c\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u78ba\u8a8d\u3067\u304d\u305f\u306e\u3067Terraform\u3092\u672c\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n$ apex infra apply\nmodule.iam.aws_iam_role.lambda_function: Creating...\n  arn:                \"\" => \"<computed>\"\n  assume_role_policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Principal\\\": {\\n        \\\"Service\\\": \\\"lambda.amazonaws.com\\\"\\n      },\\n      \\\"Action\\\": \\\"sts:AssumeRole\\\"\\n    }\\n  ]\\n}\\n\"\n  name:               \"\" => \"apex_lambda_function\"\n  path:               \"\" => \"/\"\n  unique_id:          \"\" => \"<computed>\"\nmodule.iam.aws_iam_role.lambda_function: Creation complete\nmodule.iam.aws_iam_role_policy.cloudwatchlogs_full_access: Creating...\n  name:   \"\" => \"cloudwatchlogs_full_access\"\n  policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Action\\\": [\\n        \\\"logs:*\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"*\\\"\\n    }\\n  ]\\n}\\n\"\n  role:   \"\" => \"apex_lambda_function\"\nmodule.iam.aws_iam_role_policy.cloudwatchlogs_full_access: Creation complete\n\nApply complete! Resources: 2 added, 0 changed, 0 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\nState path: terraform.tfstate\n\nOutputs:\n\n  lambda_function_role_id = arn:aws:iam::588762728270:role/apex_lambda_function\n\n\u3053\u308c\u3067IAM\u30ed\u30fc\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\u305f\u3060\u3001\u73fe\u6642\u70b9\u3067\u306fdev\u74b0\u5883\u306eIAM Role\u3057\u304b\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\n\u30a4\u30f3\u30d5\u30e9\u69cb\u7bc9 (prod)\n\u73fe\u6642\u70b9\u3067\u306fdev\u74b0\u5883\u306eIAM Role\u3057\u304b\u69cb\u7bc9\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001prod\u7528\u306b\u3082\u69cb\u7bc9\u3092\u884c\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u521d\u671f\u72b6\u614b\u3067\u306fTerraform\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306f\u307e\u3063\u305f\u304f\u540c\u3058\u3082\u306e\u304c\u914d\u7f6e\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001prod\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066\u4ee5\u4e0b\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\ninfrastructure/prod/main.tf\nvariable \"aws_region\" {\n  default = \"ap-northeast-1\"\n}\n\nprovider \"aws\" {\n  profile = \"prod\"\n}\n...\n\n\n\u305d\u306e\u307e\u307e\u3060\u3068dev\u3068\u540c\u3058\u30c7\u30d5\u30a9\u30eb\u30c8\u306eProfile(AWS\u30a2\u30ab\u30a6\u30f3\u30c8)\u3092\u4f7f\u7528\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001prodProfile\u3092\u4f7f\u3046\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\nTerraform\u306e\u5b9f\u884c\u3067\u3059\u304c\u3001apex infra\u30b3\u30de\u30f3\u30c9\u3067\u306f\u5bfe\u8c61\u306e\u74b0\u5883\u3092\u6307\u5b9a\u3059\u308b\u3088\u3046\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u898b\u5f53\u305f\u308a\u307e\u305b\u3093\u3067\u3057\u305f(\u81ea\u5206\u304c\u628a\u63e1\u3057\u3066\u306a\u3044\u3060\u3051\u304b\u3082)\u3002\u3002\u305f\u3060\u3001\u57fa\u672c\u7684\u306b\u306f\u901a\u5e38\u306eTerraform\u306a\u306e\u3067\u3001prod\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3044\u3063\u3066terraform apply \u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\u203b2016/06/01\u5909\u66f4 - -e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3059\u308c\u3070\u884c\u3051\u307e\u3057\u305f!\n$ apex infra -e prod apply\nmodule.iam.aws_iam_role.lambda_function: Creating...\n  arn:                \"\" => \"<computed>\"\n  assume_role_policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Principal\\\": {\\n        \\\"Service\\\": \\\"lambda.amazonaws.com\\\"\\n      },\\n      \\\"Action\\\": \\\"sts:AssumeRole\\\"\\n    }\\n  ]\\n}\\n\"\n  name:               \"\" => \"apex_lambda_function\"\n  path:               \"\" => \"/\"\n  unique_id:          \"\" => \"<computed>\"\nmodule.iam.aws_iam_role.lambda_function: Creation complete\nmodule.iam.aws_iam_role_policy.cloudwatchlogs_full_access: Creating...\n  name:   \"\" => \"cloudwatchlogs_full_access\"\n  policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Action\\\": [\\n        \\\"logs:*\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"*\\\"\\n    }\\n  ]\\n}\\n\"\n  role:   \"\" => \"apex_lambda_function\"\nmodule.iam.aws_iam_role_policy.cloudwatchlogs_full_access: Creation complete\n\nApply complete! Resources: 2 added, 0 changed, 0 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\nState path: terraform.tfstate\n\nOutputs:\n\n  lambda_function_role_id = arn:aws:iam::109572732475:role/apex_lambda_function\n\n\u3053\u308c\u3067prod\u7528\u306eIAM Role\u3082\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f!\n\nfunction\u4f5c\u6210(\u74b0\u5883\u5909\u6570\u3092\u6307\u5b9a)\n\u7d9a\u3044\u3066\u74b0\u5883\u5909\u6570\u3092\u4f7f\u3063\u305fLambda\u306e\u30b3\u30fc\u30c9\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\u74b0\u5883\u5225\u306b\u74b0\u5883\u5909\u6570\u3092\u5909\u3048\u3066\u5b9f\u884c\u7d50\u679c\u304c\u5909\u308f\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3059\u3002\n\nfunctions/hello/.apexignore\n*.go\n\n\n\nfunctions/hello/main.go\npackage main\n\nimport (\n    \"encoding/json\"\n    \"os\"\n\n    \"github.com/apex/go-apex\"\n)\n\nfunc main() {\n    apex.HandleFunc(func(event json.RawMessage, ctx *apex.Context) (interface{}, error) {\n        return os.Getenv(\"HOGE\"), nil\n    })\n}\n\n\nmain()\u306e\u4e2d\u3067\u306f\u74b0\u5883\u5909\u6570\u306eHOGE\u306b\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u5024\u3092\u8fd4\u3057\u3066\u3044\u307e\u3059\u3002\n\u203bGo\u3092\u4f7f\u3063\u305f\u30b3\u30fc\u30c9\u306e\u30b5\u30f3\u30d7\u30eb\u306fapex/_examples/go at master \u00b7 apex/apex\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u74b0\u5883\u5909\u6570\u306fdev\u3068prod\u3067\u5207\u308a\u66ff\u3048\u305f\u3044\u305f\u3081\u3001env\u30d5\u30a1\u30a4\u30eb\u3092\u305d\u308c\u305e\u308c\u7528\u610f\u3057\u307e\u3059\u3002\n.env-dev\nHOGE=FUGA\n\n.env-prod\nHOGE=PIYO\n\ndev\u74b0\u5883\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\u74b0\u5883\u5909\u6570\u306f--set\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n$ apex deploy hello --set $(cat .env-dev)\n\n   \u2022 config unchanged          function=hello\n   \u2022 code unchanged            function=hello\n$ apex invoke hello\n\"FUGA\"\n\n\u74b0\u5883\u5909\u6570\u306e\u6307\u5b9a\u304c\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\u6b21\u306bprod\u74b0\u5883\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u307e\u3059\u3002\n$ apex deploy hello -e prod --profile prod --set $(cat .env-prod)\n   \u2022 config unchanged          function=hello\n   \u2022 updating function         function=hello\n   \u2022 updated alias current     function=hello version=2\n   \u2022 function updated          function=hello name=apex_terraform_hello version=2\n$ apex invoke hello -e prod --profile prod\n\"PIYO\"\n\n\u3053\u3061\u3089\u3082prod\u7528\u306b\u74b0\u5883\u5909\u6570\u304c\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f!\n\n## \u6982\u8981\n\n\u524d\u56de\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3067Apex\u3092\u4f7f\u3063\u3066Lambda\u3092\u74b0\u5883\u5225\u306b\u7ba1\u7406\u3059\u308b\u65b9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u304c\u3001\n[Lambda with Apex: \u74b0\u5883\u5909\u6570\u3067\u74b0\u5883\u5225\u306bLambda\u74b0\u5883\u3092\u6574\u3048\u308b - Qiita](http://qiita.com/gaishimo/items/af2a05bcaf4cb96e534b)\n\n\u4eca\u56de\u306fApex\u3067Terraform\u3092\u4f7f\u3063\u3066Lambda\u3092\u7ba1\u7406\u3059\u308b\u65b9\u6cd5\u3092\u8a66\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n\n## \u30d0\u30fc\u30b8\u30e7\u30f3\u7b49\n\n- OS: Mac OS X 10.11.1\n- Terraform: v0.6.16\n- Apex: 0.9.0\n- \u8a00\u8a9e: Go\n\n## \u4e8b\u524d\u8a2d\u5b9a\n\n### Terraform \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nTerraform\u304c\u307e\u3060\u306a\u3044\u5834\u5408\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n[Download Terraform - Terraform by HashiCorp](https://www.terraform.io/downloads.html)\n\n### Apex\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nApex\u304c\u307e\u3060\u306a\u3044\u5834\u5408\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\ncurl https://raw.githubusercontent.com/apex/apex/master/install.sh | sh\n```\n\n### AWS\u8a2d\u5b9a\n\n\n#### AWS\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u7528\u610f\n\n\u4eca\u56de\u306f\u74b0\u5883\u3054\u3068\u306bAWS\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u5206\u3051\u3066\u307f\u305f\u3044\u306e\u3067\u3001prod\u7528\u3068dev\u7528\u306bAWS\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u7528\u610f\u3057\u305f\u3089 `~/.aws/credentials` \u306b\u8a18\u8ff0\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n# dev\u7528\n[default]\nregion=ap-northeast-1\naws_access_key_id=XXXXXXXXXXX\naws_secret_access_key=XXXXXXXXXXX\n\n# prod\u7528\n[prod]\nregion=ap-northeast-1\naws_access_key_id=XXXXXXXXXXX\naws_secret_access_key=XXXXXXXXXXX\n```\n\ndev\u7528\u306eprofile\u3092\u3092default\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u305f\u3002\n\n\n#### S3\u30d0\u30b1\u30c3\u30c8\u306e\u7528\u610f\n\nTerraform\u306e\u72b6\u614b\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306eS3\u30d0\u30b1\u30c3\u30c8\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u4eca\u56de\u306f`apex-terraform-example`\u3068\u3044\u3046\u540d\u524d\u306b\u3057\u307e\u3059\u3002\n\n\n## \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\n\u307e\u305a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\nmkdir apex_terraform\n```\n\napex\u30b3\u30de\u30f3\u30c9\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\ncd apex_terraform\napex init\n```\n\n\u5bfe\u8a71\u30b3\u30de\u30f3\u30c9\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5165\u529b\u3057\u307e\u3059\u3002\n\n```\nProject name: apex_terraform\nProject description:\nWould you like to manage infrastructure with Terraform? (yes/no): yes\nEnvironments: dev, prod\nWould you like to store Terraform state on S3? (yes/no): yes\nS3 bucket name: apex-terraform-example\n```\n\nTerraform\u3092\u4f7f\u3046\u304b\u3069\u3046\u304b\u306e\u8cea\u554f\u3067`yes`\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001Terraform\u306e\u72b6\u614b\u30d5\u30a1\u30a4\u30eb\u3092S3\u306b\u914d\u7f6e\u3059\u308b\u304b\u805e\u304b\u308c\u308b\u306e\u3067\u3001yes\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002yes\u306b\u3059\u308b\u3068S3\u306eBucket\u540d\u3092\u805e\u304b\u308c\u308b\u306e\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u5b8c\u4e86\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u69cb\u6210\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n\n```\n\u251c\u2500\u2500 functions\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 hello\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 index.js\n\u251c\u2500\u2500 infrastructure\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 dev\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.tf\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 modules\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 iam\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u251c\u2500\u2500 iam.tf\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 outputs.tf\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 prod\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.tf\n\u2514\u2500\u2500 project.json\n```\n\ninfrastructure\u306e\u4e0b\u306bdev/prod\u3068\u74b0\u5883\u5225\u306b\u30d5\u30a9\u30eb\u30c0\u304c\u4f5c\u6210\u3055\u308c\u3001terraform\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u914d\u7f6e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001infrastructure/modules\u306e\u4e0b\u306bIAM\u30ed\u30fc\u30eb\u4f5c\u6210\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u914d\u7f6e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u5404\u74b0\u5883\u306e`main.tf`\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3055\u308c\u3066\u304a\u308a\u3001\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304cIAM\u30ed\u30fc\u30eb\u4f5c\u6210\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```\nmodule \"iam\" {\n  source = \"../modules/iam\"\n}\n\noutput \"lambda_function_role_id\" {\n  value = \"${module.iam.lambda_function_role_id}\"\n}\n```\n\n\n## \u30a4\u30f3\u30d5\u30e9\u69cb\u7bc9 (dev)\n\n\n\u74b0\u5883\u3054\u3068\u306bTerraform\u3092\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\u307e\u305aplan\u3067\u5b9f\u884c\u8a08\u753b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$ apex infra plan\nRefreshing Terraform state prior to plan...\n\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n+ module.iam.aws_iam_role.lambda_function\n    arn:                \"\" => \"<computed>\"\n    assume_role_policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Principal\\\": {\\n        \\\"Service\\\": \\\"lambda.amazonaws.com\\\"\\n      },\\n      \\\"Action\\\": \\\"sts:AssumeRole\\\"\\n    }\\n  ]\\n}\\n\"\n    name:               \"\" => \"$ apex infra plan\nRefreshing Terraform state prior to plan...\n\n\nThe Terraform execution plan has been generated and is shown below.\nResources are shown in alphabetical order for quick scanning. Green resources\nwill be created (or destroyed and then created if an existing resource\nexists), yellow resources are being changed in-place, and red resources\nwill be destroyed.\n\nNote: You didn't specify an \"-out\" parameter to save this plan, so when\n\"apply\" is called, Terraform can't guarantee this is what will execute.\n\n+ module.iam.aws_iam_role.lambda_function\n    arn:                \"\" => \"<computed>\"\n    assume_role_policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Principal\\\": {\\n        \\\"Service\\\": \\\"lambda.amazonaws.com\\\"\\n      },\\n      \\\"Action\\\": \\\"sts:AssumeRole\\\"\\n    }\\n  ]\\n}\\n\"\n    name:               \"\" => \"apex_lambda_function\"\n    path:               \"\" => \"/\"\n    unique_id:          \"\" => \"<computed>\"\n\n+ module.iam.aws_iam_role_policy.cloudwatchlogs_full_access\n    name:   \"\" => \"cloudwatchlogs_full_access\"\n    policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Action\\\": [\\n        \\\"logs:*\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"*\\\"\\n    }\\n  ]\\n}\\n\"\n    role:   \"\" => \"${aws_iam_role.lambda_function.id}\"\n\n\nPlan: 2 to add, 0 to change, 0 to destroy.\"\n    path:               \"\" => \"/\"\n    unique_id:          \"\" => \"<computed>\"\n\n+ module.iam.aws_iam_role_policy.cloudwatchlogs_full_access\n    name:   \"\" => \"cloudwatchlogs_full_access\"\n    policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Action\\\": [\\n        \\\"logs:*\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"*\\\"\\n    }\\n  ]\\n}\\n\"\n    role:   \"\" => \"${aws_iam_role.lambda_function.id}\"\n\n\nPlan: 2 to add, 0 to change, 0 to destroy.\n```\n\nCloudWatch Logs\u3078\u306e\u30d5\u30eb\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u3092\u6301\u3064Policy\u4f5c\u6210\u3068\u3001apex_lambda_function\u3068\u3044\u3046\u540d\u524d\u306eIAM Role\u304c\u4f5c\u6210\u3055\u308c\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u78ba\u8a8d\u3067\u304d\u305f\u306e\u3067Terraform\u3092\u672c\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$ apex infra apply\nmodule.iam.aws_iam_role.lambda_function: Creating...\n  arn:                \"\" => \"<computed>\"\n  assume_role_policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Principal\\\": {\\n        \\\"Service\\\": \\\"lambda.amazonaws.com\\\"\\n      },\\n      \\\"Action\\\": \\\"sts:AssumeRole\\\"\\n    }\\n  ]\\n}\\n\"\n  name:               \"\" => \"apex_lambda_function\"\n  path:               \"\" => \"/\"\n  unique_id:          \"\" => \"<computed>\"\nmodule.iam.aws_iam_role.lambda_function: Creation complete\nmodule.iam.aws_iam_role_policy.cloudwatchlogs_full_access: Creating...\n  name:   \"\" => \"cloudwatchlogs_full_access\"\n  policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Action\\\": [\\n        \\\"logs:*\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"*\\\"\\n    }\\n  ]\\n}\\n\"\n  role:   \"\" => \"apex_lambda_function\"\nmodule.iam.aws_iam_role_policy.cloudwatchlogs_full_access: Creation complete\n\nApply complete! Resources: 2 added, 0 changed, 0 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\nState path: terraform.tfstate\n\nOutputs:\n\n  lambda_function_role_id = arn:aws:iam::588762728270:role/apex_lambda_function\n```\n\n\u3053\u308c\u3067IAM\u30ed\u30fc\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\u305f\u3060\u3001\u73fe\u6642\u70b9\u3067\u306fdev\u74b0\u5883\u306eIAM Role\u3057\u304b\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\n\n### \u30a4\u30f3\u30d5\u30e9\u69cb\u7bc9 (prod)\n\n\u73fe\u6642\u70b9\u3067\u306fdev\u74b0\u5883\u306eIAM Role\u3057\u304b\u69cb\u7bc9\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001prod\u7528\u306b\u3082\u69cb\u7bc9\u3092\u884c\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u521d\u671f\u72b6\u614b\u3067\u306fTerraform\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306f\u307e\u3063\u305f\u304f\u540c\u3058\u3082\u306e\u304c\u914d\u7f6e\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001prod\u7528\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3066\u4ee5\u4e0b\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n```infrastructure/prod/main.tf\nvariable \"aws_region\" {\n  default = \"ap-northeast-1\"\n}\n\nprovider \"aws\" {\n  profile = \"prod\"\n}\n...\n```\n\n\u305d\u306e\u307e\u307e\u3060\u3068dev\u3068\u540c\u3058\u30c7\u30d5\u30a9\u30eb\u30c8\u306eProfile(AWS\u30a2\u30ab\u30a6\u30f3\u30c8)\u3092\u4f7f\u7528\u3057\u3066\u3057\u307e\u3046\u306e\u3067\u3001`prod`Profile\u3092\u4f7f\u3046\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n~~Terraform\u306e\u5b9f\u884c\u3067\u3059\u304c\u3001apex infra\u30b3\u30de\u30f3\u30c9\u3067\u306f\u5bfe\u8c61\u306e\u74b0\u5883\u3092\u6307\u5b9a\u3059\u308b\u3088\u3046\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u898b\u5f53\u305f\u308a\u307e\u305b\u3093\u3067\u3057\u305f(\u81ea\u5206\u304c\u628a\u63e1\u3057\u3066\u306a\u3044\u3060\u3051\u304b\u3082)\u3002\u3002\u305f\u3060\u3001\u57fa\u672c\u7684\u306b\u306f\u901a\u5e38\u306eTerraform\u306a\u306e\u3067\u3001prod\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3044\u3063\u3066`terraform apply` \u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002~~\n\u203b2016/06/01\u5909\u66f4 - `-e`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3059\u308c\u3070\u884c\u3051\u307e\u3057\u305f!\n\n\n```\n$ apex infra -e prod apply\nmodule.iam.aws_iam_role.lambda_function: Creating...\n  arn:                \"\" => \"<computed>\"\n  assume_role_policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Principal\\\": {\\n        \\\"Service\\\": \\\"lambda.amazonaws.com\\\"\\n      },\\n      \\\"Action\\\": \\\"sts:AssumeRole\\\"\\n    }\\n  ]\\n}\\n\"\n  name:               \"\" => \"apex_lambda_function\"\n  path:               \"\" => \"/\"\n  unique_id:          \"\" => \"<computed>\"\nmodule.iam.aws_iam_role.lambda_function: Creation complete\nmodule.iam.aws_iam_role_policy.cloudwatchlogs_full_access: Creating...\n  name:   \"\" => \"cloudwatchlogs_full_access\"\n  policy: \"\" => \"{\\n  \\\"Version\\\": \\\"2012-10-17\\\",\\n  \\\"Statement\\\": [\\n    {\\n      \\\"Action\\\": [\\n        \\\"logs:*\\\"\\n      ],\\n      \\\"Effect\\\": \\\"Allow\\\",\\n      \\\"Resource\\\": \\\"*\\\"\\n    }\\n  ]\\n}\\n\"\n  role:   \"\" => \"apex_lambda_function\"\nmodule.iam.aws_iam_role_policy.cloudwatchlogs_full_access: Creation complete\n\nApply complete! Resources: 2 added, 0 changed, 0 destroyed.\n\nThe state of your infrastructure has been saved to the path\nbelow. This state is required to modify and destroy your\ninfrastructure, so keep it safe. To inspect the complete state\nuse the `terraform show` command.\n\nState path: terraform.tfstate\n\nOutputs:\n\n  lambda_function_role_id = arn:aws:iam::109572732475:role/apex_lambda_function\n```\n\n\u3053\u308c\u3067prod\u7528\u306eIAM Role\u3082\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f!\n\n\n## function\u4f5c\u6210(\u74b0\u5883\u5909\u6570\u3092\u6307\u5b9a)\n\n\u7d9a\u3044\u3066\u74b0\u5883\u5909\u6570\u3092\u4f7f\u3063\u305fLambda\u306e\u30b3\u30fc\u30c9\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\u74b0\u5883\u5225\u306b\u74b0\u5883\u5909\u6570\u3092\u5909\u3048\u3066\u5b9f\u884c\u7d50\u679c\u304c\u5909\u308f\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3059\u3002\n\n```functions/hello/.apexignore\n*.go\n```\n\n```functions/hello/main.go\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"os\"\n\n\t\"github.com/apex/go-apex\"\n)\n\nfunc main() {\n\tapex.HandleFunc(func(event json.RawMessage, ctx *apex.Context) (interface{}, error) {\n\t\treturn os.Getenv(\"HOGE\"), nil\n\t})\n}\n```\n\nmain()\u306e\u4e2d\u3067\u306f\u74b0\u5883\u5909\u6570\u306eHOGE\u306b\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u5024\u3092\u8fd4\u3057\u3066\u3044\u307e\u3059\u3002\n\u203bGo\u3092\u4f7f\u3063\u305f\u30b3\u30fc\u30c9\u306e\u30b5\u30f3\u30d7\u30eb\u306f[apex/_examples/go at master \u00b7 apex/apex](https://github.com/apex/apex/tree/master/_examples/go)\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\n\u74b0\u5883\u5909\u6570\u306fdev\u3068prod\u3067\u5207\u308a\u66ff\u3048\u305f\u3044\u305f\u3081\u3001env\u30d5\u30a1\u30a4\u30eb\u3092\u305d\u308c\u305e\u308c\u7528\u610f\u3057\u307e\u3059\u3002\n\n.env-dev\n\n```.env-dev\nHOGE=FUGA\n```\n\n.env-prod\n\n```.env-prod\nHOGE=PIYO\n```\n\n\ndev\u74b0\u5883\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\u74b0\u5883\u5909\u6570\u306f`--set`\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```\n$ apex deploy hello --set $(cat .env-dev)\n\n   \u2022 config unchanged          function=hello\n   \u2022 code unchanged            function=hello\n$ apex invoke hello\n\"FUGA\"\n```\n\n\u74b0\u5883\u5909\u6570\u306e\u6307\u5b9a\u304c\u53cd\u6620\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u6b21\u306bprod\u74b0\u5883\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$ apex deploy hello -e prod --profile prod --set $(cat .env-prod)\n   \u2022 config unchanged          function=hello\n   \u2022 updating function         function=hello\n   \u2022 updated alias current     function=hello version=2\n   \u2022 function updated          function=hello name=apex_terraform_hello version=2\n$ apex invoke hello -e prod --profile prod\n\"PIYO\"\n```\n\n\u3053\u3061\u3089\u3082prod\u7528\u306b\u74b0\u5883\u5909\u6570\u304c\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f!\n\n\n\n", "tags": ["lambda", "Apex", "Terraform", "Go"]}