{"context": "\n\n\u76ee\u6b21\n\n\u4e8b\u524d\u6e96\u5099\n\n\nCakePHP3\u306e\u52d5\u4f5c\u74b0\u5883\u69cb\u7bc9\nCakePHP3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nCakePHP3\u306e\u521d\u671f\u8a2d\u5b9a\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\n\nbake\nAuth\nQuery Builder\n\n\u6b21 CakePHP3\u52c9\u5f37\u4f1a in Fusic \u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599 part.2\nhttp://qiita.com/Junkins/items/1e9882c463ce67344da2\n\n1.\u4e8b\u524d\u6e96\u5099\n\n1.1 CakePHP3\u306e\u52d5\u4f5c\u74b0\u5883\u69cb\u7bc9\n\nPHP5.5.9\u4ee5\u4e0a\nMySQL or Postgres\nCakePHP3.2\u7cfb\ncomposer\ngit\n\n\n1.2 CakePHP\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\ncomposer.phar \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\ncommand\n    cd /var/www/html/\n    curl -s https://getcomposer.org/installer | php\n\noutput\n\nAll settings correct for using Composer\nDownloading 1.0.0...\n\nComposer successfully installed to: /var/www/html/htdocs/hands-on/composer.phar\nUse it: php composer.phar\n\n\ncomposer.phar \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u78ba\u8a8d\n\ncommand\n    cd /var/www/html/\n    ls -la\n\noutput\n    composer.phar\n\n\nCakePHP3 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\ncommand\n    cd /var/www/html/\n    php composer.phar create-project --prefer-dist cakephp/app blog\n\noutput\n    nstalling cakephp/app (3.2.4)\n      - Installing cakephp/app (3.2.4)\n        Loading from cache\n\n    Created project in blog\n    Loading composer repositories with package information\n    Updating dependencies (including require-dev)\n      - Installing aura/installer-default (1.0.0)\n        Loading from cache\n\n    (\u4ee5\u4e0b\u7565)\n\n\nCakePHP3 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb \u78ba\u8a8d\n\ncommand\n    cd /var/www/html/blog/\n    ls -la \n\noutput\n    \u5408\u8a08 124\n    drwxrwxr-x 11 .\n    drwxrwxr-x  3  ..\n    -rw-rw-r--  1  .editorconfig\n    -rw-rw-r--  1  .gitattributes\n    -rw-rw-r--  1  .gitignore\n    -rw-rw-r--  1  .htaccess\n    -rw-rw-r--  1  .travis.yml\n    -rw-rw-r--  1  README.md\n    drwxrwxr-x  2  bin\n    -rw-rw-r--  1  composer.json\n    -rw-rw-r--  1  composer.lock\n    drwxrwxr-x  3  config\n    -rw-rw-r--  1  index.php\n    drwxrwxrwx  2  logs\n    -rw-rw-r--  1  phpunit.xml.dist\n    drwxrwxr-x  2  plugins\n    drwxrwxr-x  8  src\n    drwxrwxr-x  4  tests\n    drwxrwxrwx  5  tmp\n    drwxrwxr-x 15  vendor\n    drwxrwxr-x  5  webroot\n\nMySQl\u304c\u5165\u3063\u3066\u306a\u3044\u5834\u5408\u306f\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n\n\n1.3 CakePHP3\u306e\u521d\u671f\u8a2d\u5b9a\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\n\ncommand\n    psql -U postgres\n    postgres=# create database {DB\u540d};\n    CREATE DATABASE\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\n\ncommand\n    /var/www/html/blog/app/config/app.php\n    vim /var/www/html/blog/app/config/app.php\n\nvim\n    // Postgres\u306e\u65b9\u306f\u3001test\u306edriver\u3082\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n    Datasources' => [\n            'default' => [\n                'className' => 'Cake\\Database\\Connection',\n                // 'driver' => 'Cake\\Database\\Driver\\Mysql',\n                'driver' => 'Cake\\Database\\Driver\\Postgres',\n                'persistent' => false,\n                'host' => 'localhost',\n                /**\n                 * CakePHP will use the default DB port based on the driver selected\n                 * MySQL on MAMP uses port 8889, MAMP users will want to uncomment\n                 * the following line and set the port accordingly\n                 */\n                //'port' => 'non_standard_port_number',\n                'username' => '{username}',\n                'password' => '{password}',\n                'database' => 'blog',\n                'encoding' => 'utf8',\n                'timezone' => 'UTC',\n                'flags' => [],\n                'cacheMetadata' => true,\n                'log' => false,\n\n\n\n\u30ad\u30e3\u30c3\u30b7\u30e5\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u8a2d\u5b9a\n\n    'Cache' => [\n        'default' => [\n            'className' => 'File',\n            'path' => CACHE,\n            'url' => env('CACHE_DEFAULT_URL', null),\n        ],\n\n        /**\n         * Configure the cache used for general framework caching.\n         * Translation cache files are stored with this configuration.\n         * Duration will be set to '+1 year' in bootstrap.php when debug = false\n         */\n        '_cake_core_' => [ \n            'className' => 'File',\n            'prefix' => 'myapp_cake_core_',\n            'path' => CACHE . 'persistent/',\n            'serialize' => true,\n            'duration' => '+2 minutes',\n            'url' => env('CACHE_CAKECORE_URL', null),\n            'mask' => 0666,\n        ],\n\n        /**\n         * Configure the cache for model and datasource caches. This cache\n         * configuration is used to store schema descriptions, and table listings\n         * in connections.\n         * Duration will be set to '+1 year' in bootstrap.php when debug = false\n         */\n        '_cake_model_' => [\n            'className' => 'File',\n            'prefix' => 'myapp_cake_model_',\n            'path' => CACHE . 'models/',\n            'serialize' => true,\n            'duration' => '+2 minutes',\n            'url' => env('CACHE_CAKEMODEL_URL', null),\n            'mask' => 0666,\n        ],\n    ],\n\n\n\n1.4 \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\n\u53c2\u8003URL\nhttp://book.cakephp.org/3.0/ja/migrations.html\n\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\ncommand\n    // accounts \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n    bin/cake bake migration CreateAccounts name:text description:text username:text password:text created modified\n\noutput\n\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n\n    Creating file /var/www/html/htdocs/hands-on/blog/config/Migrations/20160412142111_CreateAccounts.php\n    Wrote `/var/www/html/htdocs/hands-on/blog/config/Migrations/20160412142111_CreateAccounts.php`\n\ncommand\n    // projects \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n    bin/cake bake migration CreateProjects account_id:integer name:text description:text created modified\n\ncommand\n    // tasks \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n    bin/cake bake migration CreateTasks project_id:integer name:text description:text created modified\n\n\n\u30b7\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\ncommand\n    bin/cake bake seed Accounts\n    bin/cake bake seed Projects\n    bin/cake bake seed Tasks\n\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n\n    Creating file /var/www/html/htdocs/hands-on/blog/config/Seeds/AccountsSeed.php\n    Wrote `/var/www/html/htdocs/hands-on/blog/config/Seeds/AccountsSeed.php`\n\n\n\u30b7\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u4fee\u6b63\n\ncommand\n    vim config/Seeds/AccountsSeed.php\n\nvim\n    use Cake\\Auth\\DefaultPasswordHasher;  \n\nvim\n    public function run()\n    {\n        $data = [\n          [\n              'name'            => 'AccountA',\n              'description'     => '',\n              'username'        => 'admin',\n              'password'        => (new DefaultPasswordHasher)->hash('admin'),\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ]\n        ];\n\ncommand\n    vim config/Seeds/ProjectsSeed.php\n\nvim\n    use Cake\\ORM\\TableRegistry;\n\nvim\n    public function run()\n    {\n        $query = TableRegistry::get('Accounts')->find();\n        $query\n            ->where(['Accounts.name' => 'AccountA'])\n            ->select(['id']);\n        $accounts = $query->firstOrFail();\n\n        $data = [\n          [\n              'account_id'      => $accounts->id,\n              'name'            => 'ProjectA',\n              'description'     => 'ProjectA',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'account_id'      => $accounts->id,\n              'name'            => 'ProjectB',\n              'description'     => 'ProjectB',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'account_id'      => $accounts->id,\n              'name'            => 'ProjectC',\n              'description'     => 'ProjectC',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ]\n        ];\n\ncommand\n    vim config/Seeds/TasksSeed.php\n\nvim\n    use Cake\\ORM\\TableRegistry;\n\nvim\n    public function run()\n    {\n        $query = TableRegistry::get('Projects')->find('list' , [\n            'keyField'   => 'name',\n            'valueField' => 'id'\n        ]);\n        $projects = $query->toArray();\n\n        $data = [\n          [\n              'project_id'      => $projects['ProjectA'],\n              'name'            => 'TaskA',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectA'],\n              'name'            => 'TaskB',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectA'],\n              'name'            => 'TaskC',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectB'],\n              'name'            => 'TaskD',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectB'],\n              'name'            => 'TaskE',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectC'],\n              'name'            => 'TaskF',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n        ];\n\n\n\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\ncommand\n    bin/cake migrations migrate\n\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    using migration path /var/www/html/htdocs/hands-on/blog/config/Migrations\n    using seed path /var/www/html/htdocs/hands-on/blog/config/Seeds\n    using environment default\n    using adapter pgsql\n    using database blog\n\n     == 20160412142111 CreateAccounts: migrating\n     == 20160412142111 CreateAccounts: migrated 0.0094s\n\n     == 20160412142116 CreateProjects: migrating\n     == 20160412142116 CreateProjects: migrated 0.0111s\n\n     == 20160412142121 CreateTasks: migrating\n     == 20160412142121 CreateTasks: migrated 0.0074s\n\n    All Done. Took 0.0319s\n\n\n\u30b7\u30fc\u30c9\n\ncommand\n    bin/cake migrations seed --seed AccountsSeed\n    bin/cake migrations seed --seed ProjectsSeed\n    bin/cake migrations seed --seed TasksSeed\n\noutput\nWelcome to CakePHP v3.2.7 Console\n---------------------------------------------------------------\nApp : src\nPath: /var/www/html/htdocs/hands-on/blog/src/\nPHP : 5.6.18\n---------------------------------------------------------------\nusing migration path /var/www/html/htdocs/hands-on/blog/config/Migrations\nusing seed path /var/www/html/htdocs/hands-on/blog/config/Seeds\nusing environment default\nusing adapter pgsql\nusing database blog\n\n == AccountsSeed: seeding\n == AccountsSeed: seeded 0.0851s\n\nAll Done. Took 0.0865s\n\n\n2. bake\n\n2.1 bake \u30b3\u30de\u30f3\u30c9\n\n\u53c2\u8003URL\nhttp://book.cakephp.org/3.0/ja/bake/usage.html\n\nbake \u30b3\u30de\u30f3\u30c9\u78ba\u8a8d\n\ncommand\n    bin/cake bake\n\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    The following commands can be used to generate skeleton code for your application.\n\n    Available bake commands:\n\n    - all\n    - behavior\n    - cell\n    - component\n    - controller\n    - fixture\n    - form\n    - helper\n    - mailer\n    - migration\n    - migration_snapshot\n    - model\n    - plugin\n    - seed\n    - shell\n    - shell_helper\n    - task\n    - template\n    - test\n\n    By using `cake bake [name]` you can invoke a specific bake task.\n\ncommand\n    bin/cake bake --help\n\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    The Bake script generates controllers, models and template files for\n    your application. If run with no command line arguments, Bake guides the\n    user through the class creation process. You can customize the\n    generation process by telling Bake where different parts of your\n    application are using command line arguments.\n\n    Usage:\n    cake bake.bake [subcommand] [options]\n\n    Subcommands:\n\n    all                 Bake a complete MVC skeleton.\n    component           Bake a component class file.\n    task                Bake a task class file.\n    cell                Bake a cell class file.\n    shell_helper        Bake a shell_helper class file.\n    model               Bake table and entity classes.\n    form                Bake a form class file.\n    mailer              Bake a mailer class file.\n    template            Bake views for a controller, using built-in or\n                        custom templates.\n    helper              Bake a helper class file.\n    controller          Bake a controller skeleton.\n    plugin              Create the directory structure, AppController class\n                        and testing setup for a new plugin. Can create\n                        plugins in any of your bootstrapped plugin paths.\n    test                Bake test case skeletons for classes.\n    behavior            Bake a behavior class file.\n    fixture             Generate fixtures for use with the test suite. You\n                        can use `bake fixture all` to bake all fixtures.\n    shell               Bake a shell class file.\n    seed                Bake seed class.\n    migration_snapshot  Bake migration snapshot class.\n    migration           Bake migration class.\n\n    To see help on a subcommand use `cake bake.bake [subcommand] --help`\n\n    Options:\n\n    --help, -h        Display this help.\n    --verbose, -v     Enable verbose output.\n    --quiet, -q       Enable quiet output.\n    --everything      Bake a complete MVC skeleton, using all the available\n                      tables. Usage: \"bake all --everything\"\n    --connection, -c  Database connection to use in conjunction with `bake\n                      all`. (default: default)\n    --force, -f       Force overwriting existing files without prompting.\n    --plugin, -p      Plugin to bake into.\n    --prefix          Prefix to bake controllers and templates into.\n    --theme, -t       The theme to use when baking code. (choices:\n                      Bake|Migrations)\n\n\nbake \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n\ncommand\n    bin/cake bake all\n\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    Bake All\n    ---------------------------------------------------------------\n    Possible model names based on your database:\n    - accounts\n    - projects\n    - tasks\n    Run `cake bake all [name]` to generate skeleton files.\n\ncommand\n    bin/cake bake all accounts\n\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    Bake All\n    ---------------------------------------------------------------\n    One moment while associations are detected.\n\n    Baking table class for Accounts...\n    (\u4ee5\u4e0b\u7565)\n    Baking entity class for Account...\n    (\u4ee5\u4e0b\u7565)\n\ncommand\n    bin/cake bake all projects\n    bin/cake bake all tasks\n\n\n\u6b21 CakePHP3\u52c9\u5f37\u4f1a in Fusic \u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599 part.2\nhttp://qiita.com/Junkins/items/1e9882c463ce67344da2\n## \u76ee\u6b21\n\n1. \u4e8b\u524d\u6e96\u5099\n    1. CakePHP3\u306e\u52d5\u4f5c\u74b0\u5883\u69cb\u7bc9\n    2. CakePHP3\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n    3. CakePHP3\u306e\u521d\u671f\u8a2d\u5b9a\n    4. \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n2. bake\n3. Auth\n4. Query Builder\n\n\u6b21 CakePHP3\u52c9\u5f37\u4f1a in Fusic \u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599 part.2\nhttp://qiita.com/Junkins/items/1e9882c463ce67344da2\n\n## 1.\u4e8b\u524d\u6e96\u5099\n### 1.1 CakePHP3\u306e\u52d5\u4f5c\u74b0\u5883\u69cb\u7bc9\n- PHP5.5.9\u4ee5\u4e0a\n- MySQL or Postgres\n- CakePHP3.2\u7cfb\n- composer\n- git\n\n### 1.2 CakePHP\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n- composer.phar \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```bash\ncommand\n    cd /var/www/html/\n    curl -s https://getcomposer.org/installer | php\n```\n\n```bash\noutput\n\nAll settings correct for using Composer\nDownloading 1.0.0...\n\nComposer successfully installed to: /var/www/html/htdocs/hands-on/composer.phar\nUse it: php composer.phar\n```\n\n- composer.phar \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u78ba\u8a8d\n\n```bash\ncommand\n    cd /var/www/html/\n    ls -la\n```\n```bash\noutput\n    composer.phar\n```\n\n- CakePHP3 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\ncommand\n    cd /var/www/html/\n    php composer.phar create-project --prefer-dist cakephp/app blog\n```\n```bash\noutput\n    nstalling cakephp/app (3.2.4)\n      - Installing cakephp/app (3.2.4)\n        Loading from cache\n\n    Created project in blog\n    Loading composer repositories with package information\n    Updating dependencies (including require-dev)\n      - Installing aura/installer-default (1.0.0)\n        Loading from cache\n    \n    (\u4ee5\u4e0b\u7565)\n```\n\n- CakePHP3 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb \u78ba\u8a8d\n\n```bash\ncommand\n    cd /var/www/html/blog/\n    ls -la \n```\n```bash\noutput\n    \u5408\u8a08 124\n    drwxrwxr-x 11 .\n    drwxrwxr-x  3  ..\n    -rw-rw-r--  1  .editorconfig\n    -rw-rw-r--  1  .gitattributes\n    -rw-rw-r--  1  .gitignore\n    -rw-rw-r--  1  .htaccess\n    -rw-rw-r--  1  .travis.yml\n    -rw-rw-r--  1  README.md\n    drwxrwxr-x  2  bin\n    -rw-rw-r--  1  composer.json\n    -rw-rw-r--  1  composer.lock\n    drwxrwxr-x  3  config\n    -rw-rw-r--  1  index.php\n    drwxrwxrwx  2  logs\n    -rw-rw-r--  1  phpunit.xml.dist\n    drwxrwxr-x  2  plugins\n    drwxrwxr-x  8  src\n    drwxrwxr-x  4  tests\n    drwxrwxrwx  5  tmp\n    drwxrwxr-x 15  vendor\n    drwxrwxr-x  5  webroot\n```\n\nMySQl\u304c\u5165\u3063\u3066\u306a\u3044\u5834\u5408\u306f\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n![hands-on-1.png](https://qiita-image-store.s3.amazonaws.com/0/30844/c1fc9a64-93fc-15f5-a547-62122376c315.png)\n\n![hands-on-2.png](https://qiita-image-store.s3.amazonaws.com/0/30844/64f2e3b3-767c-4585-ed6e-64464bccb446.png)\n\n\n### 1.3 CakePHP3\u306e\u521d\u671f\u8a2d\u5b9a\n- \u0010\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\n\n```bash\ncommand\n    psql -U postgres\n    postgres=# create database {DB\u540d};\n    CREATE DATABASE\n```\n\n- \u0010\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\n\n```bash\ncommand\n    /var/www/html/blog/app/config/app.php\n    vim /var/www/html/blog/app/config/app.php\n```\n\n```php\nvim\n    // Postgres\u306e\u65b9\u306f\u3001test\u306edriver\u3082\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n    Datasources' => [\n            'default' => [\n                'className' => 'Cake\\Database\\Connection',\n                // 'driver' => 'Cake\\Database\\Driver\\Mysql',\n                'driver' => 'Cake\\Database\\Driver\\Postgres',\n                'persistent' => false,\n                'host' => 'localhost',\n                /**\n                 * CakePHP will use the default DB port based on the driver selected\n                 * MySQL on MAMP uses port 8889, MAMP users will want to uncomment\n                 * the following line and set the port accordingly\n                 */\n                //'port' => 'non_standard_port_number',\n                'username' => '{username}',\n                'password' => '{password}',\n                'database' => 'blog',\n                'encoding' => 'utf8',\n                'timezone' => 'UTC',\n                'flags' => [],\n                'cacheMetadata' => true,\n                'log' => false,\n\n```\n\n- \u30ad\u30e3\u30c3\u30b7\u30e5\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u8a2d\u5b9a\n\n```php\n    'Cache' => [\n        'default' => [\n            'className' => 'File',\n            'path' => CACHE,\n            'url' => env('CACHE_DEFAULT_URL', null),\n        ],\n        \n        /**\n         * Configure the cache used for general framework caching.\n         * Translation cache files are stored with this configuration.\n         * Duration will be set to '+1 year' in bootstrap.php when debug = false\n         */\n        '_cake_core_' => [ \n            'className' => 'File',\n            'prefix' => 'myapp_cake_core_',\n            'path' => CACHE . 'persistent/',\n            'serialize' => true,\n            'duration' => '+2 minutes',\n            'url' => env('CACHE_CAKECORE_URL', null),\n            'mask' => 0666,\n        ],\n        \n        /**\n         * Configure the cache for model and datasource caches. This cache\n         * configuration is used to store schema descriptions, and table listings\n         * in connections.\n         * Duration will be set to '+1 year' in bootstrap.php when debug = false\n         */\n        '_cake_model_' => [\n            'className' => 'File',\n            'prefix' => 'myapp_cake_model_',\n            'path' => CACHE . 'models/',\n            'serialize' => true,\n            'duration' => '+2 minutes',\n            'url' => env('CACHE_CAKEMODEL_URL', null),\n            'mask' => 0666,\n        ],\n    ],\n```\n\n![hands-on-3.png](https://qiita-image-store.s3.amazonaws.com/0/30844/68dee7f8-7800-cd1a-9895-fe5dd4327d06.png)\n\n\n### 1.4 \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\n##### \u53c2\u8003URL\nhttp://book.cakephp.org/3.0/ja/migrations.html\n\n![hands-on-er.png](https://qiita-image-store.s3.amazonaws.com/0/30844/a25607f3-c06e-acc9-7abf-c2bd82241085.png)\n\n- \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\n```bash\ncommand\n    // accounts \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n    bin/cake bake migration CreateAccounts name:text description:text username:text password:text created modified\n```\n\n```bash\noutput\n\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n\n    Creating file /var/www/html/htdocs/hands-on/blog/config/Migrations/20160412142111_CreateAccounts.php\n    Wrote `/var/www/html/htdocs/hands-on/blog/config/Migrations/20160412142111_CreateAccounts.php`\n```\n\n```bash\ncommand\n    // projects \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n    bin/cake bake migration CreateProjects account_id:integer name:text description:text created modified\n```\n\n```bash\ncommand\n    // tasks \u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n    bin/cake bake migration CreateTasks project_id:integer name:text description:text created modified\n```\n\n- \u30b7\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\n```bash\ncommand\n    bin/cake bake seed Accounts\n    bin/cake bake seed Projects\n    bin/cake bake seed Tasks\n```\n\n```bash\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n\n    Creating file /var/www/html/htdocs/hands-on/blog/config/Seeds/AccountsSeed.php\n    Wrote `/var/www/html/htdocs/hands-on/blog/config/Seeds/AccountsSeed.php`\n```\n\n- \u30b7\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u4fee\u6b63\n\n```bash\ncommand\n    vim config/Seeds/AccountsSeed.php\n```\n\n```php\nvim\n    use Cake\\Auth\\DefaultPasswordHasher;  \n```\n```php\nvim\n    public function run()\n    {\n        $data = [\n          [\n              'name'            => 'AccountA',\n              'description'     => '',\n              'username'        => 'admin',\n              'password'        => (new DefaultPasswordHasher)->hash('admin'),\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ]\n        ];\n```\n\n```bash\ncommand\n    vim config/Seeds/ProjectsSeed.php\n```\n\n```php\nvim\n    use Cake\\ORM\\TableRegistry;\n```\n```php\nvim\n    public function run()\n    {\n        $query = TableRegistry::get('Accounts')->find();\n        $query\n            ->where(['Accounts.name' => 'AccountA'])\n            ->select(['id']);\n        $accounts = $query->firstOrFail();\n\n        $data = [\n          [\n              'account_id'      => $accounts->id,\n              'name'            => 'ProjectA',\n              'description'     => 'ProjectA',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'account_id'      => $accounts->id,\n              'name'            => 'ProjectB',\n              'description'     => 'ProjectB',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'account_id'      => $accounts->id,\n              'name'            => 'ProjectC',\n              'description'     => 'ProjectC',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ]\n        ];\n```\n\n\n```bash\ncommand\n    vim config/Seeds/TasksSeed.php\n```\n```php\nvim\n    use Cake\\ORM\\TableRegistry;\n```\n```php\nvim\n    public function run()\n    {\n        $query = TableRegistry::get('Projects')->find('list' , [\n            'keyField'   => 'name',\n            'valueField' => 'id'\n        ]);\n        $projects = $query->toArray();\n\n        $data = [\n          [\n              'project_id'      => $projects['ProjectA'],\n              'name'            => 'TaskA',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectA'],\n              'name'            => 'TaskB',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectA'],\n              'name'            => 'TaskC',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectB'],\n              'name'            => 'TaskD',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectB'],\n              'name'            => 'TaskE',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n          [\n              'project_id'      => $projects['ProjectC'],\n              'name'            => 'TaskF',\n              'description'     => '',\n              'created'         => date('Y-m-d H:i:s'),\n              'modified'        => date('Y-m-d H:i:s'),\n          ],\n        ];\n```\n- \u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\n\n```bash\ncommand\n    bin/cake migrations migrate\n```\n```bash\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    using migration path /var/www/html/htdocs/hands-on/blog/config/Migrations\n    using seed path /var/www/html/htdocs/hands-on/blog/config/Seeds\n    using environment default\n    using adapter pgsql\n    using database blog\n\n     == 20160412142111 CreateAccounts: migrating\n     == 20160412142111 CreateAccounts: migrated 0.0094s\n\n     == 20160412142116 CreateProjects: migrating\n     == 20160412142116 CreateProjects: migrated 0.0111s\n\n     == 20160412142121 CreateTasks: migrating\n     == 20160412142121 CreateTasks: migrated 0.0074s\n\n    All Done. Took 0.0319s\n```\n\n- \u30b7\u30fc\u30c9\n\n```bash\ncommand\n    bin/cake migrations seed --seed AccountsSeed\n    bin/cake migrations seed --seed ProjectsSeed\n    bin/cake migrations seed --seed TasksSeed\n```\n```bash\noutput\nWelcome to CakePHP v3.2.7 Console\n---------------------------------------------------------------\nApp : src\nPath: /var/www/html/htdocs/hands-on/blog/src/\nPHP : 5.6.18\n---------------------------------------------------------------\nusing migration path /var/www/html/htdocs/hands-on/blog/config/Migrations\nusing seed path /var/www/html/htdocs/hands-on/blog/config/Seeds\nusing environment default\nusing adapter pgsql\nusing database blog\n\n == AccountsSeed: seeding\n == AccountsSeed: seeded 0.0851s\n\nAll Done. Took 0.0865s\n```\n\n## 2. bake\n### 2.1 bake \u30b3\u30de\u30f3\u30c9\n\n##### \u53c2\u8003URL\nhttp://book.cakephp.org/3.0/ja/bake/usage.html\n\n- bake \u30b3\u30de\u30f3\u30c9\u78ba\u8a8d\n\n```bash\ncommand\n    bin/cake bake\n```\n\n```bash\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    The following commands can be used to generate skeleton code for your application.\n\n    Available bake commands:\n\n    - all\n    - behavior\n    - cell\n    - component\n    - controller\n    - fixture\n    - form\n    - helper\n    - mailer\n    - migration\n    - migration_snapshot\n    - model\n    - plugin\n    - seed\n    - shell\n    - shell_helper\n    - task\n    - template\n    - test\n\n    By using `cake bake [name]` you can invoke a specific bake task.\n```\n\n```bash\ncommand\n    bin/cake bake --help\n```\n\n```bash\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    The Bake script generates controllers, models and template files for\n    your application. If run with no command line arguments, Bake guides the\n    user through the class creation process. You can customize the\n    generation process by telling Bake where different parts of your\n    application are using command line arguments.\n\n    Usage:\n    cake bake.bake [subcommand] [options]\n\n    Subcommands:\n\n    all                 Bake a complete MVC skeleton.\n    component           Bake a component class file.\n    task                Bake a task class file.\n    cell                Bake a cell class file.\n    shell_helper        Bake a shell_helper class file.\n    model               Bake table and entity classes.\n    form                Bake a form class file.\n    mailer              Bake a mailer class file.\n    template            Bake views for a controller, using built-in or\n                        custom templates.\n    helper              Bake a helper class file.\n    controller          Bake a controller skeleton.\n    plugin              Create the directory structure, AppController class\n                        and testing setup for a new plugin. Can create\n                        plugins in any of your bootstrapped plugin paths.\n    test                Bake test case skeletons for classes.\n    behavior            Bake a behavior class file.\n    fixture             Generate fixtures for use with the test suite. You\n                        can use `bake fixture all` to bake all fixtures.\n    shell               Bake a shell class file.\n    seed                Bake seed class.\n    migration_snapshot  Bake migration snapshot class.\n    migration           Bake migration class.\n\n    To see help on a subcommand use `cake bake.bake [subcommand] --help`\n\n    Options:\n\n    --help, -h        Display this help.\n    --verbose, -v     Enable verbose output.\n    --quiet, -q       Enable quiet output.\n    --everything      Bake a complete MVC skeleton, using all the available\n                      tables. Usage: \"bake all --everything\"\n    --connection, -c  Database connection to use in conjunction with `bake\n                      all`. (default: default)\n    --force, -f       Force overwriting existing files without prompting.\n    --plugin, -p      Plugin to bake into.\n    --prefix          Prefix to bake controllers and templates into.\n    --theme, -t       The theme to use when baking code. (choices:\n                      Bake|Migrations)\n```\n\n- bake \u30b3\u30de\u30f3\u30c9\u5b9f\u884c\n\n```bash\ncommand\n    bin/cake bake all\n```\n```bash\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    Bake All\n    ---------------------------------------------------------------\n    Possible model names based on your database:\n    - accounts\n    - projects\n    - tasks\n    Run `cake bake all [name]` to generate skeleton files.\n```\n```bash\ncommand\n    bin/cake bake all accounts\n```\n```bash\noutput\n    Welcome to CakePHP v3.2.7 Console\n    ---------------------------------------------------------------\n    App : src\n    Path: /var/www/html/htdocs/hands-on/blog/src/\n    PHP : 5.6.18\n    ---------------------------------------------------------------\n    Bake All\n    ---------------------------------------------------------------\n    One moment while associations are detected.\n\n    Baking table class for Accounts...\n    (\u4ee5\u4e0b\u7565)\n    Baking entity class for Account...\n    (\u4ee5\u4e0b\u7565)\n```\n```bash\ncommand\n    bin/cake bake all projects\n    bin/cake bake all tasks\n```\n![hands-on-4.png](https://qiita-image-store.s3.amazonaws.com/0/30844/b42936c4-246d-cedd-e08b-007d5b65de8f.png)\n\n\n\u6b21 CakePHP3\u52c9\u5f37\u4f1a in Fusic \u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599 part.2\nhttp://qiita.com/Junkins/items/1e9882c463ce67344da2\n", "tags": ["cakephp3"]}