{"context": "\u203b\u6c4e\u7528\u6027\u306f\u4f4e\u3044\u3067\u3059\u3002\n\n\u6982\u8981\n\n\u524d\u63d0\nVBA\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306f\u3001\u6dfb\u3048\u5b57\u3092\u4f7f\u3063\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5834\u5408\u3001\u5f8c\u308d\u306e\u65b9\u306e\u8981\u7d20\u307b\u3069\u53c2\u7167\u306b\u6642\u9593\u304c\u304b\u304b\u308b\uff08\u9023\u7d50\u30ea\u30b9\u30c8\u3068\u3044\u3046\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u305f\u3081\uff09\u3002\n\n\u6642\u9593\u304c\u304b\u304b\u3089\u306a\u3044\u53c2\u7167\u65b9\u6cd5\n\n\nForEach\u6587\u306b\u3088\u308b\u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u30a2\u30af\u30bb\u30b9\n\u8981\u7d20\u8ffd\u52a0\u6642\u306b\u8a2d\u5b9a\u3057\u305f\u30ad\u30fc\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\n\n\u2192 \u6dfb\u3048\u5b57\u3068\u30ad\u30fc\u306e\u9593\u306b\u5bfe\u5fdc\u95a2\u4fc2\u304c\u3042\u308c\u3070\u6bd4\u8f03\u7684\u9ad8\u901f\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3002\n\n\u5177\u4f53\u4f8b\n\n\u6dfb\u3048\u5b57\u3092\u30ad\u30fc\u306b\u3059\u308b\n\u6dfb\u3048\u5b57\uff08\u6574\u6570\uff09\u304b\u3089\u4e00\u610f\u306e\u30ad\u30fc\uff08\u6587\u5b57\u5217\uff09\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3060\u304c\u3001\n\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304b\u3089\u8981\u7d20\u3092\u524a\u9664\u3057\u306a\u3044\u3068\u3044\u3046\u524d\u63d0\u3092\u4ed8\u3051\u305f\u5834\u5408\u3001\n\u300c\u6574\u6570\u2192\u6587\u5b57\u5217\u5909\u63db\u300d\u3092\u884c\u3048\u3070\u4e00\u610f\u306e\u30ad\u30fc\u3092\u53d6\u5f97\u3067\u304d\u308b\uff081\u756a\u76ee\u306e\u8981\u7d20\u306e\u30ad\u30fc\u306f\"1\"\u3068\u3044\u3063\u305f\u5f62\uff09\u3002\n\u5b9f\u969b\u306b\u8a18\u8ff0\u3092\u8003\u3048\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n'Dim myCollection As VBA.Collection\n\n'\u8981\u7d20\u306e\u8ffd\u52a0\nCall myCollection.Add(\u30c7\u30fc\u30bf, CStr(myCollection.Count + 1))\n\n'i\u756a\u76ee\u306e\u8981\u7d20\u3092\u53c2\u7167\n\u53d7\u3051\u53d6\u308b\u5909\u6570 = myCollection.Item(CStr(i))\n\n\n\u554f\u984c\u70b9\n\n\u8981\u7d20\u306e\u524a\u9664\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u305f\u3081\u3001\u8981\u7d20\u306e\u8ffd\u52a0\u30fb\u524a\u9664\u304c\u5bb9\u6613\u3068\u3044\u3046\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff08\u9023\u7d50\u30ea\u30b9\u30c8\uff09\u306e\u5229\u70b9\u306e\u4e00\u3064\u3092\u6bba\u3057\u3066\u3044\u308b\u3002\n\u4ed6\u306e\u4eba\u304c\u898b\u305f\u3068\u304d\u6df7\u4e71\u3057\u3084\u3059\u3044\u3002\n\u30ad\u30fc\u672a\u6307\u5b9a\u306e\u5834\u5408\u306b\u6bd4\u3079\u3066\u3001\u8981\u7d20\u306e\u8ffd\u52a0\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\n\u6bd4\u8f03\n\n\u81ea\u5206\u306e\u74b0\u5883\u3067\u306e\u7d50\u679c\n\u74b0\u5883\uff1aWindows 10 64bit / Excel 2016 64bit\n\u6e2c\u5b9a\u65b9\u6cd5\uff1aTimer\u95a2\u6570\u3092\u7528\u3044\u305f\u7c21\u6613\u6e2c\u5b9a\n100000\u500b\u306e\u8981\u7d20\u306e\u683c\u7d0d\u6642\u9593\n\n\n\n\u5bfe\u8c61\n\u51e6\u7406\u6642\u9593\uff08\u79d2\uff09\n\n\n\n\n\u9759\u7684\u914d\u5217\n0.000\n\n\n\u52d5\u7684\u914d\u5217\uff081\u500b\u305a\u3064ReDim\uff09\n0.609\n\n\n\u901a\u5e38\u306eCollection\n0.016\n\n\n\u30ad\u30fc\u6307\u5b9a\u306eCollection\n0.781\n\n\n.NET\u306eArrayList\n0.563\n\n\n\n1\u304b\u3089100000\u307e\u3067\u306e\u8981\u7d20\u306e\u53c2\u7167\u6642\u9593\n\n\n\n\u5bfe\u8c61\n\u51e6\u7406\u6642\u9593\uff08\u79d2\uff09\n\n\n\n\n\u9759\u7684\u914d\u5217\n0.000\n\n\n\u52d5\u7684\u914d\u5217\n0.000\n\n\n\u901a\u5e38\u306eCollection\n650.910\n\n\n\u30ad\u30fc\u6307\u5b9a\u306eCollection\n0.329\n\n\n.NET\u306eArrayList\n0.945\n\n\nFor Each Array\n0.004\n\n\nFor Each Collection\n0.018\n\n\n\n\u3053\u306e\u56de\u6570\u3060\u3068\u300c\u52d5\u7684\u914d\u5217\u300d\u306e\u65b9\u304c\u300c\u30ad\u30fc\u6307\u5b9a\u306eCollection\u300d\u3088\u308a\u3082\u9ad8\u901f\u3060\u304c\u3001\n\u3082\u3063\u3068\u8981\u7d20\u6570\u304c\u591a\u3044\u5834\u5408\u3067\u306f\u3001\u8981\u7d20\u306e\u683c\u7d0d\u6642\u9593\u3067\u306f\u300c\u30ad\u30fc\u6307\u5b9a\u306eCollection\u300d\u306e\u65b9\u304c\u65e9\u304f\u306a\u308b\u3002\n\n\u6e2c\u5b9a\u7528\u30b3\u30fc\u30c9\nSub CollectionBenchMark()\n    Const CountMax& = 10000\n\n    '\u6e96\u5099\n        '\u9759\u7684\u914d\u5217\n        Dim staticArray(1 To CountMax) As Variant\n\n        '\u52d5\u7684\u914d\u52171\u305a\u3064\u62e1\u5f35\u3059\u308b\n        Dim dynamicArray() As Variant\n        ReDim dynamicArray(1 To 1)\n\n        '\u666e\u901a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n        Dim myNormalCol As VBA.Collection\n        Set myNormalCol = New VBA.Collection\n\n        '\u30ad\u30fc\u4ed8\u304d\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n        Dim myKeyCol As VBA.Collection\n        Set myKeyCol = New VBA.Collection\n\n        'ArrayList\n        Dim myArrayList As Object\n        Set myArrayList = CreateObject(\"System.Collections.ArrayList\")\n\n        '\u6642\u9593\u8a08\u6e2c\u7528\n        Dim stTime As Single\n\n        'For\u6587\u7528\n        Dim i As Long\n\n\n    Debug.Print vbCrLf; \"\u8981\u7d20\u306e\u683c\u7d0d\"; CountMax; \"\u500b\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let staticArray(i) = i\n            Next i\n        Debug.Print \"\u9759\u7684\u914d\u5217\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let dynamicArray(i) = i\n                ReDim Preserve dynamicArray(1 To UBound(dynamicArray) + 1)\n            Next i\n        Debug.Print \"\u52d5\u7684\u914d\u5217\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Call myNormalCol.Add(i)\n            Next i\n        Debug.Print \"NormalCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Call myKeyCol.Add(i, CStr(myKeyCol.Count + 1))\n            Next i\n        Debug.Print \"KeyCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Call myArrayList.Add(i)\n            Next i\n        Debug.Print \"ArrayList\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n    '\u8981\u7d20\u53d6\u5f97\u5909\u6570\n    Dim trash As Variant\n    Debug.Print vbCrLf; \"\u8981\u7d20\u306e\u53c2\u7167 1 To \"; CountMax\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = staticArray(i)\n            Next i\n        Debug.Print \"\u9759\u7684\u914d\u5217\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = dynamicArray(i)\n            Next i\n        Debug.Print \"\u52d5\u7684\u914d\u5217\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = myNormalCol.Item(i)\n            Next i\n        Debug.Print \"NormalCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = myKeyCol.Item(CStr(i))\n            Next i\n        Debug.Print \"KeyCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = myArrayList.Item(i - 1)\n            Next i\n        Debug.Print \"ArrayList\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n    'ForEach\n    Dim tmp As Variant\n\n        Let stTime = VBA.Timer\n            For Each tmp In staticArray\n                Let trash = tmp\n            Next tmp\n        Debug.Print \"\u53c2\u8003EachArray\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n        Let stTime = VBA.Timer\n            For Each tmp In myKeyCol\n                Let trash = tmp\n            Next tmp\n        Debug.Print \"\u53c2\u8003EachCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n\n    '\u30a8\u30e9\u30fc\u7121\u8996\u3067\u30a2\u30af\u30bb\u30b9\uff08\u30a8\u30e9\u30fc\u3092\u8e0f\u307e\u3048\u305f\u30a2\u30af\u30bb\u30b9\u30b3\u30b9\u30c8\u306e\u78ba\u8a8d\uff09\n        Call myKeyCol.Remove(CountMax)\n        Let stTime = VBA.Timer\n            On Error Resume Next\n                For i = 1 To CountMax Step 1\n                    Let trash = myKeyCol.Item(CStr(CountMax))\n                Next i\n            On Error GoTo 0\n        Debug.Print \"\u53c2\u8003ErrIgnore\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\nEnd Sub\n\n\n\u307e\u3068\u3081\uff1f\n\u3042\u308b\u7a0b\u5ea6\u8981\u7d20\u6570\u306e\u591a\u3044\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u5bfe\u3059\u308b\u6dfb\u3048\u5b57\u30a2\u30af\u30bb\u30b9\u306f\u6975\u529b\u907f\u3051\u308b\u3079\u304d\u3002\n\u6dfb\u3048\u5b57\u30a2\u30af\u30bb\u30b9\u304c\u5fc5\u8981\u306b\u306a\u308a\u3001\u305d\u308c\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u4e0a\u554f\u984c\u306b\u306a\u308b\u5834\u5408\u306f\u3001\u30ad\u30fc\u3092\u4f7f\u7528\u3057\u305f\u30a2\u30af\u30bb\u30b9\u3067\u4ee3\u66ff\u3067\u304d\u306a\u3044\u304b\u3001\u4ed6\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u304c\u4f7f\u3048\u306a\u3044\u304b\u3092\u8003\u3048\u308b\u3002\n\n\u53c2\u8003\nVBA \u914d\u5217\u3068\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u9055\u3044\u3092\u30e1\u30e2\u30ea\u4e0a\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u304b\u3089\u7406\u89e3\u3059\u308b\n\u3053\u306e\u8a18\u4e8b\u3067\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u77e5\u3063\u305f\u3002\n\u4ed6\u306e\u8a18\u4e8b\u3082VBA\u306e\u7d30\u304b\u3044\u3068\u3053\u308d\u307e\u3067\u308f\u304b\u308a\u3084\u3059\u304f\u8aac\u660e\u3055\u308c\u3066\u3044\u3066\u52c9\u5f37\u306b\u306a\u308b\u3002\n[\u53c2\u80031]:http://thom.hateblo.jp/entry/2016/08/31/014820 \"VBA \u914d\u5217\u3068\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u9055\u3044\u3092\u30e1\u30e2\u30ea\u4e0a\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u304b\u3089\u7406\u89e3\u3059\u308b\"\n\n\u203b\u6c4e\u7528\u6027\u306f\u4f4e\u3044\u3067\u3059\u3002\n\n# \u6982\u8981\n\n## \u524d\u63d0\n\nVBA\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306f\u3001\u6dfb\u3048\u5b57\u3092\u4f7f\u3063\u3066\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5834\u5408\u3001\u5f8c\u308d\u306e\u65b9\u306e\u8981\u7d20\u307b\u3069\u53c2\u7167\u306b\u6642\u9593\u304c\u304b\u304b\u308b\uff08\u9023\u7d50\u30ea\u30b9\u30c8\u3068\u3044\u3046\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u305f\u3081\uff09\u3002\n\n## \u6642\u9593\u304c\u304b\u304b\u3089\u306a\u3044\u53c2\u7167\u65b9\u6cd5\n\n+ `ForEach`\u6587\u306b\u3088\u308b\u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u30a2\u30af\u30bb\u30b9\n+ \u8981\u7d20\u8ffd\u52a0\u6642\u306b\u8a2d\u5b9a\u3057\u305f\u30ad\u30fc\u306b\u3088\u308b\u30a2\u30af\u30bb\u30b9\n\n\u2192 \u6dfb\u3048\u5b57\u3068\u30ad\u30fc\u306e\u9593\u306b\u5bfe\u5fdc\u95a2\u4fc2\u304c\u3042\u308c\u3070\u6bd4\u8f03\u7684\u9ad8\u901f\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3002\n\n# \u5177\u4f53\u4f8b\n\n## \u6dfb\u3048\u5b57\u3092\u30ad\u30fc\u306b\u3059\u308b\n\n\u6dfb\u3048\u5b57\uff08\u6574\u6570\uff09\u304b\u3089\u4e00\u610f\u306e\u30ad\u30fc\uff08\u6587\u5b57\u5217\uff09\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3060\u304c\u3001\n**\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u304b\u3089\u8981\u7d20\u3092\u524a\u9664\u3057\u306a\u3044**\u3068\u3044\u3046\u524d\u63d0\u3092\u4ed8\u3051\u305f\u5834\u5408\u3001\n\u300c\u6574\u6570\u2192\u6587\u5b57\u5217\u5909\u63db\u300d\u3092\u884c\u3048\u3070\u4e00\u610f\u306e\u30ad\u30fc\u3092\u53d6\u5f97\u3067\u304d\u308b\uff081\u756a\u76ee\u306e\u8981\u7d20\u306e\u30ad\u30fc\u306f`\"1\"`\u3068\u3044\u3063\u305f\u5f62\uff09\u3002\n\n\u5b9f\u969b\u306b\u8a18\u8ff0\u3092\u8003\u3048\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b\u3002\n\n```vbnet\n'Dim myCollection As VBA.Collection\n\n'\u8981\u7d20\u306e\u8ffd\u52a0\nCall myCollection.Add(\u30c7\u30fc\u30bf, CStr(myCollection.Count + 1))\n\n'i\u756a\u76ee\u306e\u8981\u7d20\u3092\u53c2\u7167\n\u53d7\u3051\u53d6\u308b\u5909\u6570 = myCollection.Item(CStr(i))\n```\n\n## \u554f\u984c\u70b9\n\n+ \u8981\u7d20\u306e\u524a\u9664\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u305f\u3081\u3001\u8981\u7d20\u306e\u8ffd\u52a0\u30fb\u524a\u9664\u304c\u5bb9\u6613\u3068\u3044\u3046\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff08\u9023\u7d50\u30ea\u30b9\u30c8\uff09\u306e\u5229\u70b9\u306e\u4e00\u3064\u3092\u6bba\u3057\u3066\u3044\u308b\u3002\n+ \u4ed6\u306e\u4eba\u304c\u898b\u305f\u3068\u304d\u6df7\u4e71\u3057\u3084\u3059\u3044\u3002\n+ \u30ad\u30fc\u672a\u6307\u5b9a\u306e\u5834\u5408\u306b\u6bd4\u3079\u3066\u3001\u8981\u7d20\u306e\u8ffd\u52a0\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u3088\u3046\u306b\u306a\u308b\u3002\n\n\n# \u6bd4\u8f03\n\n## \u81ea\u5206\u306e\u74b0\u5883\u3067\u306e\u7d50\u679c\n\u74b0\u5883\uff1aWindows 10 64bit / Excel 2016 64bit\n\u6e2c\u5b9a\u65b9\u6cd5\uff1aTimer\u95a2\u6570\u3092\u7528\u3044\u305f\u7c21\u6613\u6e2c\u5b9a\n\n100000\u500b\u306e\u8981\u7d20\u306e\u683c\u7d0d\u6642\u9593\n\n|\u5bfe\u8c61| \u51e6\u7406\u6642\u9593\uff08\u79d2\uff09|\n|:--|--:|\n|\u9759\u7684\u914d\u5217|0.000|\n|\u52d5\u7684\u914d\u5217\uff081\u500b\u305a\u3064ReDim\uff09|0.609|\n|\u901a\u5e38\u306eCollection|0.016|\n|\u30ad\u30fc\u6307\u5b9a\u306eCollection|0.781|\n|.NET\u306eArrayList|0.563|\n\n\n1\u304b\u3089100000\u307e\u3067\u306e\u8981\u7d20\u306e\u53c2\u7167\u6642\u9593\n\n|\u5bfe\u8c61| \u51e6\u7406\u6642\u9593\uff08\u79d2\uff09|\n|:--|--:|\n|\u9759\u7684\u914d\u5217|0.000|\n|\u52d5\u7684\u914d\u5217|0.000|\n|\u901a\u5e38\u306eCollection|650.910|\n|\u30ad\u30fc\u6307\u5b9a\u306eCollection|0.329|\n|.NET\u306eArrayList|0.945|\n|For Each Array|0.004|\n|For Each Collection|0.018|\n\n\u3053\u306e\u56de\u6570\u3060\u3068\u300c\u52d5\u7684\u914d\u5217\u300d\u306e\u65b9\u304c\u300c\u30ad\u30fc\u6307\u5b9a\u306eCollection\u300d\u3088\u308a\u3082\u9ad8\u901f\u3060\u304c\u3001\n\u3082\u3063\u3068\u8981\u7d20\u6570\u304c\u591a\u3044\u5834\u5408\u3067\u306f\u3001\u8981\u7d20\u306e\u683c\u7d0d\u6642\u9593\u3067\u306f\u300c\u30ad\u30fc\u6307\u5b9a\u306eCollection\u300d\u306e\u65b9\u304c\u65e9\u304f\u306a\u308b\u3002\n\n## \u6e2c\u5b9a\u7528\u30b3\u30fc\u30c9\n\n```vbnet\nSub CollectionBenchMark()\n    Const CountMax& = 10000\n    \n    '\u6e96\u5099\n        '\u9759\u7684\u914d\u5217\n        Dim staticArray(1 To CountMax) As Variant\n        \n        '\u52d5\u7684\u914d\u52171\u305a\u3064\u62e1\u5f35\u3059\u308b\n        Dim dynamicArray() As Variant\n        ReDim dynamicArray(1 To 1)\n        \n        '\u666e\u901a\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n        Dim myNormalCol As VBA.Collection\n        Set myNormalCol = New VBA.Collection\n        \n        '\u30ad\u30fc\u4ed8\u304d\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n        Dim myKeyCol As VBA.Collection\n        Set myKeyCol = New VBA.Collection\n        \n        'ArrayList\n        Dim myArrayList As Object\n        Set myArrayList = CreateObject(\"System.Collections.ArrayList\")\n        \n        '\u6642\u9593\u8a08\u6e2c\u7528\n        Dim stTime As Single\n        \n        'For\u6587\u7528\n        Dim i As Long\n        \n    \n    Debug.Print vbCrLf; \"\u8981\u7d20\u306e\u683c\u7d0d\"; CountMax; \"\u500b\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let staticArray(i) = i\n            Next i\n        Debug.Print \"\u9759\u7684\u914d\u5217\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let dynamicArray(i) = i\n                ReDim Preserve dynamicArray(1 To UBound(dynamicArray) + 1)\n            Next i\n        Debug.Print \"\u52d5\u7684\u914d\u5217\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Call myNormalCol.Add(i)\n            Next i\n        Debug.Print \"NormalCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Call myKeyCol.Add(i, CStr(myKeyCol.Count + 1))\n            Next i\n        Debug.Print \"KeyCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Call myArrayList.Add(i)\n            Next i\n        Debug.Print \"ArrayList\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n    '\u8981\u7d20\u53d6\u5f97\u5909\u6570\n    Dim trash As Variant\n    Debug.Print vbCrLf; \"\u8981\u7d20\u306e\u53c2\u7167 1 To \"; CountMax\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = staticArray(i)\n            Next i\n        Debug.Print \"\u9759\u7684\u914d\u5217\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = dynamicArray(i)\n            Next i\n        Debug.Print \"\u52d5\u7684\u914d\u5217\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = myNormalCol.Item(i)\n            Next i\n        Debug.Print \"NormalCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = myKeyCol.Item(CStr(i))\n            Next i\n        Debug.Print \"KeyCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For i = 1 To CountMax Step 1\n                Let trash = myArrayList.Item(i - 1)\n            Next i\n        Debug.Print \"ArrayList\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n    'ForEach\n    Dim tmp As Variant\n        \n        Let stTime = VBA.Timer\n            For Each tmp In staticArray\n                Let trash = tmp\n            Next tmp\n        Debug.Print \"\u53c2\u8003EachArray\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n        Let stTime = VBA.Timer\n            For Each tmp In myKeyCol\n                Let trash = tmp\n            Next tmp\n        Debug.Print \"\u53c2\u8003EachCol\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\n        \n    '\u30a8\u30e9\u30fc\u7121\u8996\u3067\u30a2\u30af\u30bb\u30b9\uff08\u30a8\u30e9\u30fc\u3092\u8e0f\u307e\u3048\u305f\u30a2\u30af\u30bb\u30b9\u30b3\u30b9\u30c8\u306e\u78ba\u8a8d\uff09\n        Call myKeyCol.Remove(CountMax)\n        Let stTime = VBA.Timer\n            On Error Resume Next\n                For i = 1 To CountMax Step 1\n                    Let trash = myKeyCol.Item(CStr(CountMax))\n                Next i\n            On Error GoTo 0\n        Debug.Print \"\u53c2\u8003ErrIgnore\", VBA.Format$(Timer - stTime, \"0.000\"); \"\u79d2\"\nEnd Sub\n```\n\n# \u307e\u3068\u3081\uff1f\n\n\u3042\u308b\u7a0b\u5ea6\u8981\u7d20\u6570\u306e\u591a\u3044\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306b\u5bfe\u3059\u308b\u6dfb\u3048\u5b57\u30a2\u30af\u30bb\u30b9\u306f\u6975\u529b\u907f\u3051\u308b\u3079\u304d\u3002\n\u6dfb\u3048\u5b57\u30a2\u30af\u30bb\u30b9\u304c\u5fc5\u8981\u306b\u306a\u308a\u3001\u305d\u308c\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u4e0a\u554f\u984c\u306b\u306a\u308b\u5834\u5408\u306f\u3001\u30ad\u30fc\u3092\u4f7f\u7528\u3057\u305f\u30a2\u30af\u30bb\u30b9\u3067\u4ee3\u66ff\u3067\u304d\u306a\u3044\u304b\u3001\u4ed6\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u304c\u4f7f\u3048\u306a\u3044\u304b\u3092\u8003\u3048\u308b\u3002\n\n\n# \u53c2\u8003\n\n[VBA \u914d\u5217\u3068\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u9055\u3044\u3092\u30e1\u30e2\u30ea\u4e0a\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u304b\u3089\u7406\u89e3\u3059\u308b][\u53c2\u80031]\n\u3053\u306e\u8a18\u4e8b\u3067\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u77e5\u3063\u305f\u3002\n\u4ed6\u306e\u8a18\u4e8b\u3082VBA\u306e\u7d30\u304b\u3044\u3068\u3053\u308d\u307e\u3067\u308f\u304b\u308a\u3084\u3059\u304f\u8aac\u660e\u3055\u308c\u3066\u3044\u3066\u52c9\u5f37\u306b\u306a\u308b\u3002\n\n", "tags": ["VBA"]}