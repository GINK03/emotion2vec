{"context": " More than 1 year has passed since last update.\n\n\u4fbf\u5229\u306a $this->call\nLaravel \u3067\u306f\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8\u306e\u4e2d\u3067 $this->call \u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u3001\u7c21\u5358\u306b HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u305f\u7d50\u679c\u3092\u30c6\u30b9\u30c8\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u5185\u90e8\u3067\u306f Symfony\\Component\\HttpKernel\\Client \u304c\u4f7f\u308f\u308c\u3066\u3044\u307e\u3059\u3002\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 \u306b\u306f\u3053\u3046\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\nYou may easily call one of your routes for a test using the call method:\n $response = $this->call('GET', 'user/profile');\n\n $response = $this->call($method, $uri, $parameters, $files, $server, $content);\n\n\n$uri \u306f\u76f8\u5bfe\u30d1\u30b9\u3067\u66f8\u3051\u308b\uff01\u4fbf\u5229\uff01\uff01\u3000\u3068\u601d\u3044\u307e\u3059\u3088\u306d\u3002\n\u5b9f\u306f\u3001\u3053\u3053\u306b\u306f\u3061\u3087\u3063\u3068\u3057\u305f\u7f60\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n\u8a66\u3059\n\u307e\u305a\u306f\u3001\u666e\u901a\u306b\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\u9069\u5f53\u306a\u30eb\u30fc\u30c8\u3092\u7528\u610f\u3057\u3066\u3001\u5358\u7d14\u306a\u30c6\u30b9\u30c8\u3092\u66f8\u304d\u307e\u3059\u3002\n\nroutes.php\n<?php\n\nRoute::get('test/create', function () {\n    return Response::make('ok');\n});\n\n\n\nAPITest.php\n<?php\n\nclass APITest extends TestCase {\n\n    public function testGetTest()\n    {\n        $response = $this->call('GET', 'test/create');\n        $this->assertTrue($response->isOk());\n    }\n}\n\n\n\u8d70\u308a\u5207\u308a\u307e\u3057\u305f\u306d\u3002\n\u30c6\u30b9\u30c8\u306f\u901a\u308a\u307e\u3057\u305f\u3002\n\u3067\u306f\u3001 APITest.php \u306e\u65b9\u306b\u624b\u3092\u52a0\u3048\u3066\u3001 2 \u56de\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u307f\u307e\u3059\u3002\n\u5b9f\u969b\u306b\u3053\u3093\u306a\u30c6\u30b9\u30c8\u306f\u66f8\u304d\u307e\u305b\u3093\u304c\u3001\u4f55\u304b\u526f\u4f5c\u7528\u306e\u3042\u308b API \u3092\u53e9\u3044\u305f\u5f8c\u306b\u9069\u7528\u3055\u308c\u3066\u3044\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u610f\u5473\u3067\u3001 1 \u3064\u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306e\u4e2d\u3067 2 \u56de\u4ee5\u4e0a\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u308a\u305f\u3044\u3053\u3068\u304c\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nAPITest.php\n<?php\n\nclass APITest extends TestCase {\n\n    public function testGetTest()\n    {\n        $response = $this->call('GET', 'test/create');\n        $this->assertTrue($response->isOk());\n\n        $response = $this->call('GET', 'test/create');\n        $this->assertTrue($response->isOk());\n    }\n}\n\n\n\u3053\u306e\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\u5fc5\u305a 2 \u56de\u76ee\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3067 Symfony\\Component\\HttpKernel\\Exception\\NotFoundHttpException \u304c\u767a\u751f\u3057\u307e\u3059\u3002\n1 \u56de\u76ee\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u901a\u3063\u3066\u3044\u3066\u3001\u4f55\u3082\u526f\u4f5c\u7528\u306e\u3042\u308b\u3053\u3068\u3057\u3066\u3044\u306a\u3044\u306e\u306b\u2026\u3069\u3046\u3057\u3066 NotFound \uff01\uff1f\u3000\u3068\u56f0\u60d1\u3057\u307e\u3059\u3002\n\n\u7d50\u8ad6\n$uri \u306f / \u304b\u3089\u66f8\u304f\u3002\n\u3064\u307e\u308a\n$response = $this->call('GET', '/test/create');\n\n\u3053\u3046\u66f8\u3051\u3070\u3001\u4f55\u5ea6\u3067\u3082\u547c\u3073\u51fa\u305b\u307e\u3059\u3002\n$this->call \u306b $uri \u3092\u76f8\u5bfe URI \u3067\u6e21\u3059\u3068\u3001\u524d\u56de\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u305f URI \u304b\u3089\u306e\u76f8\u5bfe URI \u306b\u306a\u308b\u3088\u3046\u3067\u3001\u305d\u308c\u306f NotFound \u306b\u306a\u308b\u306e\u3082\u7d0d\u5f97\u3067\u304d\u307e\u3059\u3002\n\u3061\u306a\u307f\u306b\u3001 $this->call \u306e HTTPS \u7248\u3067\u3042\u308b $this->callSecure \u3067\u306f\u3053\u306e\u3088\u3046\u306a\u5d4c\u307e\u308a\u65b9\u306f\u3057\u307e\u305b\u3093\u3002\n\nIlluminate/Foundation/Testing/TestCase.php\n    public function callSecure()\n    {\n        $parameters = func_get_args();\n\n        $parameters[1] = 'https://localhost/'.ltrim($parameters[1], '/');\n\n        return call_user_func_array(array($this, 'call'), $parameters);\n    }\n\n\nhttps://localhost/ \u6c7a\u3081\u6253\u3061\u306a\u6240\u304c\u30ab\u30b8\u30e5\u30a2\u30eb\u3067\u3059\u306d\u3002\n\n\u5099\u8003\nLaravel \u306e\u30d5\u30a9\u30fc\u30e9\u30e0 \u306b\u306f\u3053\u3093\u306a\u3053\u3068\u304c\u66f8\u3044\u3066\u3042\u308a\u307e\u3057\u305f\u3002\n\nDoing a $this->refreshApplication() fixes it, just ensure that you set up the test again.\n\n$this->call \u547c\u3093\u3060\u5f8c\u306b\u6bce\u56de $this->refreshApplication \u3092\u547c\u3070\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306a\u3093\u3066\u3001\u305d\u3093\u306a\u975e\u52b9\u7387\u306a\u3053\u3068\u3042\u308b\u8a33\u306a\u3044\u3067\u3059\u306d\u3002\n$this->refreshApplication \u3092\u547c\u3076\u3068\u76f4\u308b\u306e\u306f\u3001 Client \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u65b0\u3057\u304f\u751f\u6210\u3055\u308c\u308b\u70ba\u3067\u3059\u3002 \n\n\u53c2\u8003\n\n\u30c6\u30b9\u30c8 | Symfony2\u65e5\u672c\u8a9e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\nTestCase::call()\nSymfony\\Component\\HttpKernel\\Client\nSymfony\\Component\\BrowserKit\\Client getAbsoluteUri()\n\n\n\u6700\u5f8c\u306b\n\n\u30b3\u30fc\u30c9\u3092\u8ffd\u3046\u524d\u306b Qiita \u3084\u30d5\u30a9\u30fc\u30e9\u30e0\u3092\u53c2\u7167\u3057\u307e\u3057\u3087\u3046\u3002\n## \u4fbf\u5229\u306a $this->call\nLaravel \u3067\u306f\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8\u306e\u4e2d\u3067 `$this->call` \u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u3001\u7c21\u5358\u306b HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u305f\u7d50\u679c\u3092\u30c6\u30b9\u30c8\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u5185\u90e8\u3067\u306f `Symfony\\Component\\HttpKernel\\Client` \u304c\u4f7f\u308f\u308c\u3066\u3044\u307e\u3059\u3002\n\n[\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://laravel.com/docs/testing#calling-routes-from-tests) \u306b\u306f\u3053\u3046\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\n> You may easily call one of your routes for a test using the call method:\n\n> ```\n $response = $this->call('GET', 'user/profile');\n> \n $response = $this->call($method, $uri, $parameters, $files, $server, $content);\n```\n\n$uri \u306f\u76f8\u5bfe\u30d1\u30b9\u3067\u66f8\u3051\u308b\uff01\u4fbf\u5229\uff01\uff01\u3000\u3068\u601d\u3044\u307e\u3059\u3088\u306d\u3002\n\u5b9f\u306f\u3001\u3053\u3053\u306b\u306f\u3061\u3087\u3063\u3068\u3057\u305f\u7f60\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n## \u8a66\u3059\n\u307e\u305a\u306f\u3001\u666e\u901a\u306b\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\u9069\u5f53\u306a\u30eb\u30fc\u30c8\u3092\u7528\u610f\u3057\u3066\u3001\u5358\u7d14\u306a\u30c6\u30b9\u30c8\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```routes.php\n<?php\n\nRoute::get('test/create', function () {\n\treturn Response::make('ok');\n});\n```\n\n```APITest.php\n<?php\n\nclass APITest extends TestCase {\n\n\tpublic function testGetTest()\n\t{\n\t\t$response = $this->call('GET', 'test/create');\n\t\t$this->assertTrue($response->isOk());\n\t}\n}\n```\n\n\u8d70\u308a\u5207\u308a\u307e\u3057\u305f\u306d\u3002\n\u30c6\u30b9\u30c8\u306f\u901a\u308a\u307e\u3057\u305f\u3002\n\n\u3067\u306f\u3001 `APITest.php` \u306e\u65b9\u306b\u624b\u3092\u52a0\u3048\u3066\u3001 2 \u56de\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u5b9f\u969b\u306b\u3053\u3093\u306a\u30c6\u30b9\u30c8\u306f\u66f8\u304d\u307e\u305b\u3093\u304c\u3001\u4f55\u304b\u526f\u4f5c\u7528\u306e\u3042\u308b API \u3092\u53e9\u3044\u305f\u5f8c\u306b\u9069\u7528\u3055\u308c\u3066\u3044\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u610f\u5473\u3067\u3001 1 \u3064\u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306e\u4e2d\u3067 2 \u56de\u4ee5\u4e0a\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u308a\u305f\u3044\u3053\u3068\u304c\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n```APITest.php\n<?php\n\nclass APITest extends TestCase {\n\n\tpublic function testGetTest()\n\t{\n\t\t$response = $this->call('GET', 'test/create');\n\t\t$this->assertTrue($response->isOk());\n\n\t\t$response = $this->call('GET', 'test/create');\n\t\t$this->assertTrue($response->isOk());\n\t}\n}\n```\n\n\u3053\u306e\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u8d70\u3089\u305b\u308b\u3068\u3001\u5fc5\u305a 2 \u56de\u76ee\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3067 `Symfony\\Component\\HttpKernel\\Exception\\NotFoundHttpException` \u304c\u767a\u751f\u3057\u307e\u3059\u3002\n\n1 \u56de\u76ee\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u901a\u3063\u3066\u3044\u3066\u3001\u4f55\u3082\u526f\u4f5c\u7528\u306e\u3042\u308b\u3053\u3068\u3057\u3066\u3044\u306a\u3044\u306e\u306b\u2026\u3069\u3046\u3057\u3066 NotFound \uff01\uff1f\u3000\u3068\u56f0\u60d1\u3057\u307e\u3059\u3002\n\n## \u7d50\u8ad6\n\n`$uri` \u306f `/` \u304b\u3089\u66f8\u304f\u3002\n\n\u3064\u307e\u308a\n\n```\n$response = $this->call('GET', '/test/create');\n```\n\n\u3053\u3046\u66f8\u3051\u3070\u3001\u4f55\u5ea6\u3067\u3082\u547c\u3073\u51fa\u305b\u307e\u3059\u3002\n\n`$this->call` \u306b `$uri` \u3092\u76f8\u5bfe URI \u3067\u6e21\u3059\u3068\u3001\u524d\u56de\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u305f URI \u304b\u3089\u306e\u76f8\u5bfe URI \u306b\u306a\u308b\u3088\u3046\u3067\u3001\u305d\u308c\u306f NotFound \u306b\u306a\u308b\u306e\u3082\u7d0d\u5f97\u3067\u304d\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u3001 `$this->call` \u306e HTTPS \u7248\u3067\u3042\u308b `$this->callSecure` \u3067\u306f\u3053\u306e\u3088\u3046\u306a\u5d4c\u307e\u308a\u65b9\u306f\u3057\u307e\u305b\u3093\u3002\n\n```Illuminate/Foundation/Testing/TestCase.php\n\tpublic function callSecure()\n\t{\n\t\t$parameters = func_get_args();\n\n\t\t$parameters[1] = 'https://localhost/'.ltrim($parameters[1], '/');\n\n\t\treturn call_user_func_array(array($this, 'call'), $parameters);\n\t}\n```\n\n`https://localhost/` \u6c7a\u3081\u6253\u3061\u306a\u6240\u304c\u30ab\u30b8\u30e5\u30a2\u30eb\u3067\u3059\u306d\u3002\n\n## \u5099\u8003\n[Laravel \u306e\u30d5\u30a9\u30fc\u30e9\u30e0](http://laravel.io/forum/03-07-2014-testcase-tests-unable-to-make-multiple-call) \u306b\u306f\u3053\u3093\u306a\u3053\u3068\u304c\u66f8\u3044\u3066\u3042\u308a\u307e\u3057\u305f\u3002\n\n> Doing a $this->refreshApplication() fixes it, just ensure that you set up the test again.\n\n`$this->call` \u547c\u3093\u3060\u5f8c\u306b\u6bce\u56de `$this->refreshApplication` \u3092\u547c\u3070\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u306a\u3093\u3066\u3001\u305d\u3093\u306a\u975e\u52b9\u7387\u306a\u3053\u3068\u3042\u308b\u8a33\u306a\u3044\u3067\u3059\u306d\u3002\n\n`$this->refreshApplication` \u3092\u547c\u3076\u3068\u76f4\u308b\u306e\u306f\u3001 `Client` \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u65b0\u3057\u304f\u751f\u6210\u3055\u308c\u308b\u70ba\u3067\u3059\u3002 \n\n## \u53c2\u8003\n* [\u30c6\u30b9\u30c8 | Symfony2\u65e5\u672c\u8a9e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://docs.symfony.gr.jp/symfony2/book/testing.html)\n* [TestCase::call()](https://github.com/laravel/framework/blob/4.1/src/Illuminate/Foundation/Testing/TestCase.php#L72)\n* [Symfony\\Component\\HttpKernel\\Client](https://github.com/symfony/symfony/blob/2.5/src/Symfony/Component/HttpKernel/Client.php)\n* [Symfony\\Component\\BrowserKit\\Client getAbsoluteUri()](https://github.com/symfony/symfony/blob/2.5/src/Symfony/Component/BrowserKit/Client.php#L547)\n\n## \u6700\u5f8c\u306b\n<blockquote class=\"twitter-tweet\" lang=\"en\"><p>\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u66f8\u3044\u3066\u306a\u3044\u306e\u306a\u3089\u3001\u30b3\u30fc\u30c9\u3092\u8aad\u3080\u307e\u3067\u3060\u2026</p>&mdash; \u305f\u3051@\u65e5\u5e38 (@ww24) <a href=\"https://twitter.com/ww24/status/506376921664352256\">September 1, 2014</a></blockquote>\n\n\u30b3\u30fc\u30c9\u3092\u8ffd\u3046\u524d\u306b Qiita \u3084\u30d5\u30a9\u30fc\u30e9\u30e0\u3092\u53c2\u7167\u3057\u307e\u3057\u3087\u3046\u3002\n", "tags": ["laravel4.1", "PHP5.5.3", "PHPUnit4.1.4"]}