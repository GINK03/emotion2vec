{"context": "\u8868\u984c\u306e\u901a\u308a\u3001DBMS_LOB.LOADCLOBFROMFILE\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3 \u3067\n\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb \u3092 CLOB\u578b\u5217 \u306b \u30ed\u30fc\u30c9\u3059\u308b\u3084\u3067\u5f61(\uff9f)(\uff9f)\n\u307e\u305aCLOB\u578b\u306e\u5217\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3068\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\nCONNECT AYSHIBAT/xxxxxxxx\nCREATE TABLE TEST_CLOB (\n    C1 NUMBER\n  , C2 CLOB\n);\nALTER TABLE TEST_CLOB ADD CONSTRAINT TEST_CLOB_PK PRIMARY KEY(C1) USING INDEX;\n\nCONNECT /AS SYSDBA\nCREATE DIRECTORY DIR_AYSHIBAT as '/home/oracle/work/ayshibat';\nGRANT READ, WRITE ON DIRECTORY DIR_AYSHIBAT TO AYSHIBAT;\n\n\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30d1\u30b9\u306b\u7f6e\u304d\u307e\u3059\u3002\n$ pwd\n/home/oracle/work/ayshibat\n$ ls -la\ntotal 112\ndrwxr-xr-x 2 oracle oinstall   4096 Aug 15 11:49 .\ndrwxr-xr-x 3 oracle oinstall   4096 Aug 15 11:45 ..\n-rw-r--r-- 1 oracle oinstall 102000 Aug 15 11:47 test_clob_data.txt\n$\n\n\u4ef6\u6570\u304c\u7121\u3044\u306e\u3092\u78ba\u8a8d\u3057\u3066\u3001DBMS_LOB.LOADCLOBFROMFILE\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3067\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092CLOB\u578b\u5217\u306b\u6d41\u3057\u8fbc\u3080\u3068\u2026\u2026\nSELECT C1, DBMS_LOB.GETLENGTH(C2) FROM TEST_CLOB;\n\nno rows selected\n\nDECLARE\n  bfile_p  BFILE;       -- BFILE pointer\n  clob_loc CLOB;        -- CLOB locator\n  n_c1     NUMBER;      -- TEST_CLOB Column C1\n  n_doffs  NUMBER := 1; -- dest_offset\n  n_soffs  NUMBER := 1; -- src_offset\n  n_lctx   NUMBER := 0; -- lang_context\n  n_warn   NUMBER;      -- warning\nBEGIN\n  -- BFILE pointer set\n  bfile_p := BFILENAME('DIR_AYSHIBAT', 'test_clob_data.txt');\n  -- Insert record and CLOB locator get\n  SELECT NVL(MAX(C1), 0) + 1 INTO n_c1 FROM TEST_CLOB;\n  INSERT INTO TEST_CLOB VALUES (n_c1, EMPTY_CLOB())\n  RETURNING C2 INTO clob_loc;\n  -- File open\n  DBMS_LOB.FILEOPEN(bfile_p, DBMS_LOB.FILE_READONLY);\n  -- LOAD CLOB from text file\n  DBMS_LOB.LOADCLOBFROMFILE(\n      clob_loc                   -- CLOB locator\n    , bfile_p                    -- BFILE pointer\n    , DBMS_LOB.LOBMAXSIZE        -- amount\n    , n_doffs                    -- dest_offset\n    , n_soffs                    -- src_offset\n    , NLS_CHARSET_ID('AL32UTF8') -- BFILE Characterset ID\n    , n_lctx                     -- lang_context\n    , n_warn                     -- warning\n  );\n  COMMIT;\n  -- File close\n  DBMS_LOB.FILECLOSE(bfile_p);\nEND;\n/\n\nPL/SQL procedure successfully completed.\n\n\u4ef6\u6570\u3068\u30d0\u30a4\u30c8\u6570\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u4e0a\u624b\u304f\u884c\u3063\u305f\u3084\u3067\u5f61(^)(^)\nSELECT C1, DBMS_LOB.GETLENGTH(C2) FROM TEST_CLOB;\n\n        C1 DBMS_LOB.GETLENGTH(C2)\n---------- ----------------------\n         1                 102000\n\n\u30de\u30cb\u30e5\u30a2\u30eb\u985e(\u203b11gR2\u7248)\u306f\u4e0b\u8a18\u3084\u3067\u5f61(\uff9f)(\uff9f)\n\nDBMS_LOB\u30d1\u30c3\u30b1\u30fc\u30b8\nLOADCLOBFROMFILE\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\nhttp://docs.oracle.com/cd/E16338_01/appdev.112/b56262/d_lob.htm#i998978\nSQL\u8a00\u8a9e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\nBFILENAME\nhttp://docs.oracle.com/cd/E16338_01/server.112/b56299/functions019.htm#i76871\nSQL\u8a00\u8a9e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\nEMPTY_BLOB\u3001EMPTY_CLOB\nhttp://docs.oracle.com/cd/E16338_01/server.112/b56299/functions056.htm#i77384\nSQL\u8a00\u8a9e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\nNLS_CHARSET_ID\nhttp://docs.oracle.com/cd/E16338_01/server.112/b56299/functions108.htm#i78230\n\n\u8868\u984c\u306e\u901a\u308a\u3001DBMS_LOB.LOADCLOBFROMFILE\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3 \u3067\n\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb \u3092 CLOB\u578b\u5217 \u306b \u30ed\u30fc\u30c9\u3059\u308b\u3084\u3067\u5f61(\uff9f)(\uff9f)\n\n\u307e\u305aCLOB\u578b\u306e\u5217\u3092\u6301\u3064\u30c6\u30fc\u30d6\u30eb\u3068\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n```sql\nCONNECT AYSHIBAT/xxxxxxxx\nCREATE TABLE TEST_CLOB (\n    C1 NUMBER\n  , C2 CLOB\n);\nALTER TABLE TEST_CLOB ADD CONSTRAINT TEST_CLOB_PK PRIMARY KEY(C1) USING INDEX;\n\nCONNECT /AS SYSDBA\nCREATE DIRECTORY DIR_AYSHIBAT as '/home/oracle/work/ayshibat';\nGRANT READ, WRITE ON DIRECTORY DIR_AYSHIBAT TO AYSHIBAT;\n```\n\n\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30d1\u30b9\u306b\u7f6e\u304d\u307e\u3059\u3002\n\n```shell-session\n$ pwd\n/home/oracle/work/ayshibat\n$ ls -la\ntotal 112\ndrwxr-xr-x 2 oracle oinstall   4096 Aug 15 11:49 .\ndrwxr-xr-x 3 oracle oinstall   4096 Aug 15 11:45 ..\n-rw-r--r-- 1 oracle oinstall 102000 Aug 15 11:47 test_clob_data.txt\n$\n```\n\n\u4ef6\u6570\u304c\u7121\u3044\u306e\u3092\u78ba\u8a8d\u3057\u3066\u3001DBMS_LOB.LOADCLOBFROMFILE\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3067\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\u3092CLOB\u578b\u5217\u306b\u6d41\u3057\u8fbc\u3080\u3068\u2026\u2026\n\n```sql\nSELECT C1, DBMS_LOB.GETLENGTH(C2) FROM TEST_CLOB;\n\nno rows selected\n\nDECLARE\n  bfile_p  BFILE;       -- BFILE pointer\n  clob_loc CLOB;        -- CLOB locator\n  n_c1     NUMBER;      -- TEST_CLOB Column C1\n  n_doffs  NUMBER := 1; -- dest_offset\n  n_soffs  NUMBER := 1; -- src_offset\n  n_lctx   NUMBER := 0; -- lang_context\n  n_warn   NUMBER;      -- warning\nBEGIN\n  -- BFILE pointer set\n  bfile_p := BFILENAME('DIR_AYSHIBAT', 'test_clob_data.txt');\n  -- Insert record and CLOB locator get\n  SELECT NVL(MAX(C1), 0) + 1 INTO n_c1 FROM TEST_CLOB;\n  INSERT INTO TEST_CLOB VALUES (n_c1, EMPTY_CLOB())\n  RETURNING C2 INTO clob_loc;\n  -- File open\n  DBMS_LOB.FILEOPEN(bfile_p, DBMS_LOB.FILE_READONLY);\n  -- LOAD CLOB from text file\n  DBMS_LOB.LOADCLOBFROMFILE(\n      clob_loc                   -- CLOB locator\n    , bfile_p                    -- BFILE pointer\n    , DBMS_LOB.LOBMAXSIZE        -- amount\n    , n_doffs                    -- dest_offset\n    , n_soffs                    -- src_offset\n    , NLS_CHARSET_ID('AL32UTF8') -- BFILE Characterset ID\n    , n_lctx                     -- lang_context\n    , n_warn                     -- warning\n  );\n  COMMIT;\n  -- File close\n  DBMS_LOB.FILECLOSE(bfile_p);\nEND;\n/\n\nPL/SQL procedure successfully completed.\n```\n\n\u4ef6\u6570\u3068\u30d0\u30a4\u30c8\u6570\u3092\u78ba\u8a8d\u3059\u308b\u3068\u3001\u4e0a\u624b\u304f\u884c\u3063\u305f\u3084\u3067\u5f61(^)(^)\n\n```sql\nSELECT C1, DBMS_LOB.GETLENGTH(C2) FROM TEST_CLOB;\n\n        C1 DBMS_LOB.GETLENGTH(C2)\n---------- ----------------------\n         1                 102000\n```\n\n\u30de\u30cb\u30e5\u30a2\u30eb\u985e(\u203b11gR2\u7248)\u306f\u4e0b\u8a18\u3084\u3067\u5f61(\uff9f)(\uff9f)\n\n> DBMS_LOB\u30d1\u30c3\u30b1\u30fc\u30b8\n> LOADCLOBFROMFILE\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\n> http://docs.oracle.com/cd/E16338_01/appdev.112/b56262/d_lob.htm#i998978\n>\n> SQL\u8a00\u8a9e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n> BFILENAME\n> http://docs.oracle.com/cd/E16338_01/server.112/b56299/functions019.htm#i76871\n>\n> SQL\u8a00\u8a9e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n> EMPTY_BLOB\u3001EMPTY_CLOB\n> http://docs.oracle.com/cd/E16338_01/server.112/b56299/functions056.htm#i77384\n>\n> SQL\u8a00\u8a9e\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n> NLS_CHARSET_ID\n> http://docs.oracle.com/cd/E16338_01/server.112/b56299/functions108.htm#i78230\n\n", "tags": ["oracle", "Database", "plsql"]}