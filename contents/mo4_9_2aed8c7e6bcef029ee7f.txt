{"context": "\n\n\u30d5\u30a9\u30fc\u30e0\u306b\u5165\u529b\u3057\u305f\u5185\u5bb9\u3092\u30e1\u30fc\u30eb\u3067\u9001\u4fe1\n\u300c\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u30d5\u30a9\u30fc\u30e0\u9001\u4fe1\u6642\u300d\u306b\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u706b\nfunction sendForm(e) {\n  var address = \"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\";\n  var ts = e.namedValues[\"\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\"];\n  var ans1 = e.namedValues[\"\u8cea\u554f1\"];\n  var ans2 = e.namedValues[\"\u8cea\u554f2\"];\n  var ans3 = e.namedValues[\"\u8cea\u554f3\"];\n  var body = \"\u6642\u523b\uff1a\" + ts + \"\\n\";\n  body += \"\u554f1\uff1a\" + ans1 + \"\\n\";\n  body += \"\u554f2\uff1a\" + ans2 + \"\\n\";\n  body += \"\u554f3\uff1a\" + ans3 + \"\\n\";\n  MailApp.sendEmail(address, \"\u30d5\u30a9\u30fc\u30e0\u9001\u4fe1\", body)\n}\n\n\n\u53d7\u4fe1\u30dc\u30c3\u30af\u30b9\u306e\u5185\u5bb9\u3092\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u66f8\u304d\u51fa\u3059\nfunction getMail() {\n  var sheet = SpreadsheetApp.getActiveSheet();\n  var thds = GmailApp.getInboxThreads();\n  var row = 1;\n  for(var n in thds){\n    var thd = thds[n];\n    sheet.getRange(row++, 1).setValue(thd.getMessageCount());\n    var msgs = thd.getMessages();\n    for(m in msgs){\n      var msg = msgs[m];\n      var from = msg.getFrom();\n      var to = msg.getTo();\n      var date = msg.getDate();\n      var subject = msg.getSubject();\n      var body = msg.getBody();\n      sheet.getRange(row, 1).setValue(date);\n      sheet.getRange(row, 2).setValue(from);\n      sheet.getRange(row, 3).setValue(to);\n      sheet.getRange(row, 4).setValue(subject);\n      // sheet.getRange(row, 5).setValue(body);\n      row++;\n    }\n  }\n}\n\n\n\u4e00\u5b9a\u671f\u9593\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u4e88\u5b9a\u3092\u53d6\u5f97\u3059\u308b\nfunction getCal() {\n  var sheet = SpreadsheetApp.getActiveSheet();\n  var cal = CalendarApp.getCalendarById(\"\u30ab\u30ec\u30f3\u30c0\u30fc\u306eID\");\n\n  var d1 = new Date();\n  d1.setDate(1);\n  d1.setHours(0);\n  d1.setMinutes(0);\n  d1.setSeconds(0);\n\n  var d2 = new Date();\n  d2.setDate(1);\n  d2.setMonth(d2.getMonth() + 1);\n  d2.setHours(0);\n  d2.setMinutes(0);\n  d2.setSeconds(0);\n\n  Logger.log(d1)\n  Logger.log(d2)\n\n  var evts = cal.getEvents(d1, d2);\n  var index = 1;\n  if(evts.length > 0){\n    for(var i in evts){\n      var evt = evts[i];\n      sheet.getRange(index, 1).setValue(evt.getTitle());\n      sheet.getRange(index, 2).setValue(evt.getDescription());\n      sheet.getRange(index, 3).setValue(evt.getStartTime());\n      sheet.getRange(index, 4).setValue(evt.getEndTime());\n      index++;\n    }\n  }\n\n}\n\n\n## \u30d5\u30a9\u30fc\u30e0\u306b\u5165\u529b\u3057\u305f\u5185\u5bb9\u3092\u30e1\u30fc\u30eb\u3067\u9001\u4fe1\n\n\u300c\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u30d5\u30a9\u30fc\u30e0\u9001\u4fe1\u6642\u300d\u306b\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u706b\n\n```javascript\nfunction sendForm(e) {\n  var address = \"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\";\n  var ts = e.namedValues[\"\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\"];\n  var ans1 = e.namedValues[\"\u8cea\u554f1\"];\n  var ans2 = e.namedValues[\"\u8cea\u554f2\"];\n  var ans3 = e.namedValues[\"\u8cea\u554f3\"];\n  var body = \"\u6642\u523b\uff1a\" + ts + \"\\n\";\n  body += \"\u554f1\uff1a\" + ans1 + \"\\n\";\n  body += \"\u554f2\uff1a\" + ans2 + \"\\n\";\n  body += \"\u554f3\uff1a\" + ans3 + \"\\n\";\n  MailApp.sendEmail(address, \"\u30d5\u30a9\u30fc\u30e0\u9001\u4fe1\", body)\n}\n```\n\n## \u53d7\u4fe1\u30dc\u30c3\u30af\u30b9\u306e\u5185\u5bb9\u3092\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u66f8\u304d\u51fa\u3059\n\n```javascript\nfunction getMail() {\n  var sheet = SpreadsheetApp.getActiveSheet();\n  var thds = GmailApp.getInboxThreads();\n  var row = 1;\n  for(var n in thds){\n    var thd = thds[n];\n    sheet.getRange(row++, 1).setValue(thd.getMessageCount());\n    var msgs = thd.getMessages();\n    for(m in msgs){\n      var msg = msgs[m];\n      var from = msg.getFrom();\n      var to = msg.getTo();\n      var date = msg.getDate();\n      var subject = msg.getSubject();\n      var body = msg.getBody();\n      sheet.getRange(row, 1).setValue(date);\n      sheet.getRange(row, 2).setValue(from);\n      sheet.getRange(row, 3).setValue(to);\n      sheet.getRange(row, 4).setValue(subject);\n      // sheet.getRange(row, 5).setValue(body);\n      row++;\n    }\n  }\n}\n```\n\n## \u4e00\u5b9a\u671f\u9593\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u306e\u4e88\u5b9a\u3092\u53d6\u5f97\u3059\u308b\n\n```\nfunction getCal() {\n  var sheet = SpreadsheetApp.getActiveSheet();\n  var cal = CalendarApp.getCalendarById(\"\u30ab\u30ec\u30f3\u30c0\u30fc\u306eID\");\n  \n  var d1 = new Date();\n  d1.setDate(1);\n  d1.setHours(0);\n  d1.setMinutes(0);\n  d1.setSeconds(0);\n  \n  var d2 = new Date();\n  d2.setDate(1);\n  d2.setMonth(d2.getMonth() + 1);\n  d2.setHours(0);\n  d2.setMinutes(0);\n  d2.setSeconds(0);\n  \n  Logger.log(d1)\n  Logger.log(d2)\n  \n  var evts = cal.getEvents(d1, d2);\n  var index = 1;\n  if(evts.length > 0){\n    for(var i in evts){\n      var evt = evts[i];\n      sheet.getRange(index, 1).setValue(evt.getTitle());\n      sheet.getRange(index, 2).setValue(evt.getDescription());\n      sheet.getRange(index, 3).setValue(evt.getStartTime());\n      sheet.getRange(index, 4).setValue(evt.getEndTime());\n      index++;\n    }\n  }\n  \n}\n```\n", "tags": ["GoogleAppsScript"]}