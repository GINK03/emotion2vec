{"context": " More than 1 year has passed since last update.\n\nEXCEL VBA\u3092\u52c9\u5f37\u3057\u3066\u3044\u307e\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u30bd\u30fc\u30b9\u304c\uff11\u3064\uff11\u3064\u306eExcel\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u5f8c\u65e5\u8abf\u3079\u308b\u6642\u306f\u4e0d\u4fbf\u3060\u306a\u3042\u3068\u601d\u3063\u3066\u3001Excel\u306b\u4fdd\u5b58\u3057\u3066\u3044\u308b\u30bd\u30fc\u30b9\u3092Export\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u672c\u5f53\u306fDB\u3084\u3089\u3001HTML\u3084\u3089\u306b\u4fdd\u5b58\u3057\u3001\u30ad\u30fc\u30ef\u30fc\u30c9\u306a\u3069\u3067\u691c\u7d22\u3057\u3066\u3059\u3050\u4f7f\u3048\u308b\u306e\u304c\u30d9\u30b9\u30c8\u3067\u3059\u3002\u5bbf\u984c\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u4f7f\u3044\u65b9\uff1a\n\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30ebExportExcelModule.bat\u3068CScript ExportExcelModule.vbs\u3092\nVBA\u30bd\u30fc\u30b9\u3092\u8a18\u8ff0\u3057\u305fExcel\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u30d5\u30a9\u30eb\u30c0\u306e\u89aa\u30d5\u30a9\u30eb\u30c0\u306b\u683c\u7d0d\u3057\u3001\n\u30bd\u30fc\u30b9\u3092\u4fdd\u5b58\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u4e8b\u524d\u306b\u4f5c\u6210\u3057\u3001\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u306eEXPORT_PATH\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u305f\u5f8c\u306b\u3001ExportExcelModule.bat\u3092\u5b9f\u884c\u3057\u305f\u3089\u3001\u5f8c\u306f\u5f85\u3064\u3060\u3051\u3067\u3059\u3002\u30bd\u30fc\u30b9\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3067\u3059\u3002\n\n\nExportExcelModule.bat\n@echo off\n\nrem ---------------------------------------------------------------\nrem \u6a5f\u80fd\uff1aVBA\u306e\u30bd\u30fc\u30b9\u3092Export\u3059\u308b\nrem ---------------------------------------------------------------\nrem \u4f7f\u3044\u65b9\uff1a\nrem     \u5f53\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u3068\u4e0b\u8a18\u547c\u3073\u51fa\u3057\u3066\u3044\u308bExportExcelModule.vbs\u3092\nrem     VBA\u30bd\u30fc\u30b9\u3092\u8a18\u8ff0\u3057\u305fExcel\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u30d5\u30a9\u30eb\u30c0\u306e\u89aa\u30d5\u30a9\u30eb\u30c0\u306b\u683c\u7d0d\u3059\u308b\nrem ---------------------------------------------------------------\n\nrem VBA\u306e\u30bd\u30fc\u30b9\u306e\u4fdd\u5b58\u7b87\u6240\u3092\u8a2d\u5b9a\nset EXPORT_PATH=\"C:\\ExcelVBA_SOURCE\\Export\"\n\nrem \u3053\u306e\u30d0\u30c3\u30c1\u304c\u5b58\u5728\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u30ab\u30ec\u30f3\u30c8\u306b\u79fb\u52d5\npushd %0\\..\n\ncls\n\n\nrem --------------------------------------------------------------------\nrem \u30ab\u30ec\u30f3\u30c8\u30d5\u30a9\u30eb\u30c0\u3068\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u306b\u542b\u3081\u3066\u3044\u308b\u5168\u3066\u306eEXCEL\uff08xlsm\u3082\u5bfe\u8c61\u306b\u306a\u308b\uff09\u3092\u30eb\u30fc\u30d7\u3057\u3001\nrem ExportExcelModule.vbs\u3067\u30bd\u30fc\u30b9\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\nrem (\u30eb\u30fc\u30d7\u306f\u3053\u3053\u3067\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u82e5\u5e72\u6027\u80fd\u304c\u60aa\u3044\u304c...VBS\u3067\u518d\u5e30\u51e6\u7406\u3092\u66f8\u304b\u306a\u304f\u3066\u6e08\u3080\u3002)\nrem --------------------------------------------------------------------\nfor /F \"usebackq\" %%i in (`dir /s /b *.xls `) do ( \n    echo %%i \n    CScript ExportExcelModule.vbs %%i %EXPORT_PATH%\n    rem pause\n)\npause\nexit\n\nrem --------------------------------------------------------------------\nrem \u52c9\u5f37\u6642\u30e1\u30e2\nrem \u30e1\u30e2\uff11\uff1a\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u62e1\u5f35\u5b50\u304cxls\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u51fa\u529b\nrem    for %%i in (*.xls) do ( echo %%i )\nrem \u30e1\u30e2\uff12(\u6b63\u898f\u8868\u73fe\u304c\u5229\u304b\u306a\u304b\u3063\u305f)\uff1a\nrem for /F \"usebackq\" %%i in (`dir /s /b *.xls ^| findstr /V \".*\\.xls$\" `) do ()\nrem --------------------------------------------------------------------\n\n\n\nExportExcelModule.vbs\nDim objParams, strFullPath, strFileName, objExcel, objWorkBook\nDim objTempComponent, strExportPath, strCode \nDim FSO\n\nstrFullPath=\"\"\nstrExportPath = \"\"\nstrFileName = \"\"\nstrFilePath = \"\"\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objParams = WScript.Arguments\nIf objParams.Count = 2 Then\n    strFullPath = objParams.Item(0)\n    strExportPath = objParams.Item(1)\n    strFileName = FSO.GetFileName(strFullPath)\n    strFilePath = FSO.GetParentFolderName(strFullPath)\n    'WScript.Echo \"strFullPath---->\" & strFullPath\n    'WScript.Echo \"strFileName---->\" & strFileName\n    'WScript.Echo \"strFilePath---->\" & strFilePath\n    'WScript.Echo \"strExportPath---->\" & strExportPath\n\nElse\n    WScript.Quit 0\nEnd If\n\n'Excel\u64cd\u4f5c\u6e96\u5099\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = False\nobjExcel.DisplayAlerts = False\nobjExcel.EnableEvents = False\n'\u30de\u30af\u30ed\u304c\u7121\u52b9\u306e\u72b6\u614b\u3067\u958b\u304f\n'\u203b\u3060\u3081\u3060\u3063\u305f\uff01\uff01objExcel.AutomationSecurity = msoAutomationSecurityForceDisable\nSet objWorkBook = objExcel.Workbooks.Open(strFullPath)\n\n'\u30bd\u30fc\u30b9\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\nCall ExportSource()\n\n'Excel\u3092\u30af\u30ed\u30fc\u30ba\nSet FSO = nothing\nSet objParams = nothing\nobjExcel.DisplayAlerts = True\nobjExcel.EnableEvents = True\nobjWorkBook.Close False\nobjExcel.Quit\nSet objWorkBook = nothing\nSet objExcel = nothing\n\n'--------------------------------------------------------------------------\n'\u30bd\u30fc\u30b9\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\n'--------------------------------------------------------------------------\nSub ExportSource()\n    For Each TempComponent In objWorkBook.VBProject.VBComponents\n        If TempComponent.CodeModule.CountOfDeclarationLines <> TempComponent.CodeModule.CountOfLines Then\n            Select Case TempComponent.Type\n                'STANDARD_MODULE\n                Case 1\n                    TempComponent.Export strExportPath & \"\\\" & objWorkBook.Name & \"_\" & TempComponent.Name & \".bas\"\n                'CLASS_MODULE\n                Case 2\n                    TempComponent.Export strExportPath & \"\\\" & objWorkBook.Name & \"_\" & TempComponent.Name & \".cls\"\n                'USER_FORM\n                Case 3\n                    TempComponent.Export strExportPath & \"\\\" & objWorkBook.Name & \"_\" & TempComponent.Name & \".frm\"\n                'SHEET\u3068ThisWorkBook\n                Case 100\n                    TempComponent.Export strExportPath & \"\\\" & objWorkBook.Name & \"_\" & TempComponent.Name & \".bas\"\n            End Select\n            With TempComponent.CodeModule\n                'Code = .Lines(1, .CountOfLines)\n                'Code = .Lines(.CountOfDeclarationLines + 1, .CountOfLines - .CountOfDeclarationLines + 1)                    \n            End With\n        End If\n    Next\n\nEnd Sub\n\n\n\n\n*****************************************************************************************************\n#####EXCEL VBA\u3092\u52c9\u5f37\u3057\u3066\u3044\u307e\u3059\u3002\u30b5\u30f3\u30d7\u30eb\u30bd\u30fc\u30b9\u304c\uff11\u3064\uff11\u3064\u306eExcel\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u5f8c\u65e5\u8abf\u3079\u308b\u6642\u306f\u4e0d\u4fbf\u3060\u306a\u3042\u3068\u601d\u3063\u3066\u3001Excel\u306b\u4fdd\u5b58\u3057\u3066\u3044\u308b\u30bd\u30fc\u30b9\u3092Export\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\u672c\u5f53\u306fDB\u3084\u3089\u3001HTML\u3084\u3089\u306b\u4fdd\u5b58\u3057\u3001\u30ad\u30fc\u30ef\u30fc\u30c9\u306a\u3069\u3067\u691c\u7d22\u3057\u3066\u3059\u3050\u4f7f\u3048\u308b\u306e\u304c\u30d9\u30b9\u30c8\u3067\u3059\u3002\u5bbf\u984c\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n*****************************************************************************************************\n\u4f7f\u3044\u65b9\uff1a\n\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30ebExportExcelModule.bat\u3068CScript ExportExcelModule.vbs\u3092\nVBA\u30bd\u30fc\u30b9\u3092\u8a18\u8ff0\u3057\u305fExcel\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u30d5\u30a9\u30eb\u30c0\u306e\u89aa\u30d5\u30a9\u30eb\u30c0\u306b\u683c\u7d0d\u3057\u3001\n\u30bd\u30fc\u30b9\u3092\u4fdd\u5b58\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u4e8b\u524d\u306b\u4f5c\u6210\u3057\u3001\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u306eEXPORT_PATH\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u305f\u5f8c\u306b\u3001ExportExcelModule.bat\u3092\u5b9f\u884c\u3057\u305f\u3089\u3001\u5f8c\u306f\u5f85\u3064\u3060\u3051\u3067\u3059\u3002\u30bd\u30fc\u30b9\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3067\u3059\u3002\n*****************************************************************************************************\n\n\n```bat:ExportExcelModule.bat\n@echo off\n\nrem ---------------------------------------------------------------\nrem \u6a5f\u80fd\uff1aVBA\u306e\u30bd\u30fc\u30b9\u3092Export\u3059\u308b\nrem ---------------------------------------------------------------\nrem \u4f7f\u3044\u65b9\uff1a\nrem     \u5f53\u30d0\u30c3\u30c1\u30d5\u30a1\u30a4\u30eb\u3068\u4e0b\u8a18\u547c\u3073\u51fa\u3057\u3066\u3044\u308bExportExcelModule.vbs\u3092\nrem     VBA\u30bd\u30fc\u30b9\u3092\u8a18\u8ff0\u3057\u305fExcel\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u30d5\u30a9\u30eb\u30c0\u306e\u89aa\u30d5\u30a9\u30eb\u30c0\u306b\u683c\u7d0d\u3059\u308b\nrem ---------------------------------------------------------------\n\nrem VBA\u306e\u30bd\u30fc\u30b9\u306e\u4fdd\u5b58\u7b87\u6240\u3092\u8a2d\u5b9a\nset EXPORT_PATH=\"C:\\ExcelVBA_SOURCE\\Export\"\n\nrem \u3053\u306e\u30d0\u30c3\u30c1\u304c\u5b58\u5728\u3059\u308b\u30d5\u30a9\u30eb\u30c0\u3092\u30ab\u30ec\u30f3\u30c8\u306b\u79fb\u52d5\npushd %0\\..\n\ncls\n\n\nrem --------------------------------------------------------------------\nrem \u30ab\u30ec\u30f3\u30c8\u30d5\u30a9\u30eb\u30c0\u3068\u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u306b\u542b\u3081\u3066\u3044\u308b\u5168\u3066\u306eEXCEL\uff08xlsm\u3082\u5bfe\u8c61\u306b\u306a\u308b\uff09\u3092\u30eb\u30fc\u30d7\u3057\u3001\nrem ExportExcelModule.vbs\u3067\u30bd\u30fc\u30b9\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\nrem (\u30eb\u30fc\u30d7\u306f\u3053\u3053\u3067\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u82e5\u5e72\u6027\u80fd\u304c\u60aa\u3044\u304c...VBS\u3067\u518d\u5e30\u51e6\u7406\u3092\u66f8\u304b\u306a\u304f\u3066\u6e08\u3080\u3002)\nrem --------------------------------------------------------------------\nfor /F \"usebackq\" %%i in (`dir /s /b *.xls `) do ( \n\techo %%i \n\tCScript ExportExcelModule.vbs %%i %EXPORT_PATH%\n\trem pause\n)\npause\nexit\n\nrem --------------------------------------------------------------------\nrem \u52c9\u5f37\u6642\u30e1\u30e2\nrem \u30e1\u30e2\uff11\uff1a\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u62e1\u5f35\u5b50\u304cxls\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u51fa\u529b\nrem    for %%i in (*.xls) do ( echo %%i )\nrem \u30e1\u30e2\uff12(\u6b63\u898f\u8868\u73fe\u304c\u5229\u304b\u306a\u304b\u3063\u305f)\uff1a\nrem for /F \"usebackq\" %%i in (`dir /s /b *.xls ^| findstr /V \".*\\.xls$\" `) do ()\nrem --------------------------------------------------------------------\n```\n\n```vbnet:ExportExcelModule.vbs\nDim objParams, strFullPath, strFileName, objExcel, objWorkBook\nDim objTempComponent, strExportPath, strCode \nDim FSO\n\nstrFullPath=\"\"\nstrExportPath = \"\"\nstrFileName = \"\"\nstrFilePath = \"\"\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objParams = WScript.Arguments\nIf objParams.Count = 2 Then\n\tstrFullPath = objParams.Item(0)\n\tstrExportPath = objParams.Item(1)\n\tstrFileName = FSO.GetFileName(strFullPath)\n\tstrFilePath = FSO.GetParentFolderName(strFullPath)\n\t'WScript.Echo \"strFullPath---->\" & strFullPath\n\t'WScript.Echo \"strFileName---->\" & strFileName\n\t'WScript.Echo \"strFilePath---->\" & strFilePath\n\t'WScript.Echo \"strExportPath---->\" & strExportPath\n\t\nElse\n\tWScript.Quit 0\nEnd If\n\n'Excel\u64cd\u4f5c\u6e96\u5099\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = False\nobjExcel.DisplayAlerts = False\nobjExcel.EnableEvents = False\n'\u30de\u30af\u30ed\u304c\u7121\u52b9\u306e\u72b6\u614b\u3067\u958b\u304f\n'\u203b\u3060\u3081\u3060\u3063\u305f\uff01\uff01objExcel.AutomationSecurity = msoAutomationSecurityForceDisable\nSet objWorkBook = objExcel.Workbooks.Open(strFullPath)\n\n'\u30bd\u30fc\u30b9\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\nCall ExportSource()\n\n'Excel\u3092\u30af\u30ed\u30fc\u30ba\nSet FSO = nothing\nSet objParams = nothing\nobjExcel.DisplayAlerts = True\nobjExcel.EnableEvents = True\nobjWorkBook.Close False\nobjExcel.Quit\nSet objWorkBook = nothing\nSet objExcel = nothing\n\n'--------------------------------------------------------------------------\n'\u30bd\u30fc\u30b9\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b\n'--------------------------------------------------------------------------\nSub ExportSource()\n    For Each TempComponent In objWorkBook.VBProject.VBComponents\n        If TempComponent.CodeModule.CountOfDeclarationLines <> TempComponent.CodeModule.CountOfLines Then\n            Select Case TempComponent.Type\n\t\t\t\t'STANDARD_MODULE\n                Case 1\n                    TempComponent.Export strExportPath & \"\\\" & objWorkBook.Name & \"_\" & TempComponent.Name & \".bas\"\n\t\t\t\t'CLASS_MODULE\n                Case 2\n                    TempComponent.Export strExportPath & \"\\\" & objWorkBook.Name & \"_\" & TempComponent.Name & \".cls\"\n                'USER_FORM\n\t\t\t\tCase 3\n                    TempComponent.Export strExportPath & \"\\\" & objWorkBook.Name & \"_\" & TempComponent.Name & \".frm\"\n                'SHEET\u3068ThisWorkBook\n\t\t\t\tCase 100\n                    TempComponent.Export strExportPath & \"\\\" & objWorkBook.Name & \"_\" & TempComponent.Name & \".bas\"\n            End Select\n\t\t\tWith TempComponent.CodeModule\n\t\t\t\t'Code = .Lines(1, .CountOfLines)\n\t\t\t\t'Code = .Lines(.CountOfDeclarationLines + 1, .CountOfLines - .CountOfDeclarationLines + 1)                    \n\t\t\tEnd With\n\t\tEnd If\n    Next\n\nEnd Sub\n```", "tags": ["VBA", "Excel"]}