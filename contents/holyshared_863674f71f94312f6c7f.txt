{"context": " More than 1 year has passed since last update.\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u30e1\u30e2\nsend_file \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306b length \u3092\u6307\u5b9a\u3057\u3066\u3082\u30d8\u30c3\u30c0\u30fc\u306b Content-Length \u304c\u4ed8\u304b\u306a\u3044\u306e\u3067application.rb \u306b Rack \u306e middleware \u3092\u8ffd\u52a0\u3057\u305f\u3002\n\n\u66f8\u3044\u3066\u305f\u30b3\u30fc\u30c9\nlength \u3092\u6307\u5b9a\u3057\u3066\u3044\u305f\u306e\u3060\u304c...\n\u30d8\u30c3\u30c0\u30fc\u306b Content-Length \u304c\u4ed8\u304b\u306a\u3044....\u3002\nsend_file zip_file_path, { :type => \"application/zip\", :length => File.size(zip_file_path) }\n\n\n\u3057\u304b\u305f\u306a\u3044\u306e\u3067Rack::ContentLength\u3092\u4f7f\u3046\nconfig/application.rb\u3092\u958b\u3044\u3066\u3001 Rack::ContentLength \u3092\u8ffd\u52a0\u3059\u308b\u3002\nconfig.middleware.use Rack::ContentLength\n\n\n\u3068\u308a\u3042\u3048\u305a\u78ba\u8a8d\u3002\n\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u30c6\u30b9\u30c8\u3059\u308b\u3002\ncurl\u3092\u5229\u7528\u3057\u3066\u3001\u30d8\u30c3\u30c0\u30fc\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u30c0\u30f3\u30d7\u3002\ncurl http://127.0.0.1:3000/download/audio --dump-header header.txt -X POST -d \"id=41\"\n\n\u30c0\u30f3\u30d7\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\u30d5\u30e0\u3001\u826f\u3055\u305d\u3046\u3060\u3002\nHTTP/1.1 200 OK\nContent-Disposition: attachment; filename=\"41.zip\"\nContent-Transfer-Encoding: binary\nContent-Type: application/zip\nCache-Control: private\nContent-Length: 8387828\nX-UA-Compatible: IE=Edge\n\n\n\u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\nhttp://dev.mensfeld.pl/2011/09/rails-3-1-sending-content-length-header-using-middleware-rack-content-length/\n\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u30e1\u30e2\n\n**send_file** \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306b **length** \u3092\u6307\u5b9a\u3057\u3066\u3082\u30d8\u30c3\u30c0\u30fc\u306b **Content-Length** \u304c\u4ed8\u304b\u306a\u3044\u306e\u3067**application.rb** \u306b **Rack** \u306e **middleware** \u3092\u8ffd\u52a0\u3057\u305f\u3002\n\n### \u66f8\u3044\u3066\u305f\u30b3\u30fc\u30c9\n\n**length** \u3092\u6307\u5b9a\u3057\u3066\u3044\u305f\u306e\u3060\u304c...\n\u30d8\u30c3\u30c0\u30fc\u306b **Content-Length** \u304c\u4ed8\u304b\u306a\u3044....\u3002\n\n\tsend_file zip_file_path, { :type => \"application/zip\", :length => File.size(zip_file_path) }\n\n### \u3057\u304b\u305f\u306a\u3044\u306e\u3067Rack::ContentLength\u3092\u4f7f\u3046\n\n**config/application.rb**\u3092\u958b\u3044\u3066\u3001 **Rack::ContentLength** \u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n\tconfig.middleware.use Rack::ContentLength\n\n### \u3068\u308a\u3042\u3048\u305a\u78ba\u8a8d\u3002\n\n\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u30c6\u30b9\u30c8\u3059\u308b\u3002\ncurl\u3092\u5229\u7528\u3057\u3066\u3001\u30d8\u30c3\u30c0\u30fc\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u30c0\u30f3\u30d7\u3002\n\n\tcurl http://127.0.0.1:3000/download/audio --dump-header header.txt -X POST -d \"id=41\"\n\n\u30c0\u30f3\u30d7\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\u30d5\u30e0\u3001\u826f\u3055\u305d\u3046\u3060\u3002\n\n\tHTTP/1.1 200 OK\n\tContent-Disposition: attachment; filename=\"41.zip\"\n\tContent-Transfer-Encoding: binary\n\tContent-Type: application/zip\n\tCache-Control: private\n\tContent-Length: 8387828\n\tX-UA-Compatible: IE=Edge\n\n\n### \u53c2\u8003\u306b\u3057\u305f\u30b5\u30a4\u30c8\n\nhttp://dev.mensfeld.pl/2011/09/rails-3-1-sending-content-length-header-using-middleware-rack-content-length/\n", "tags": ["rails3.2"]}