{"context": "\n\n\u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u66f8\u304f\u3068\u3053\u308d\u7121\u3044\ncakephp\u3067\u306f\u3001Helper,Component,ShellHelper,Cell\u306a\u3069\u3082\u308d\u3082\u308d\u30ed\u30b8\u30c3\u30af\u3092\u4f7f\u3044\u307e\u308f\u3059\u305f\u3081\u306e\u6a5f\u69cb\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30d0\u30c3\u30c1\u306a\u3069\u3092\u52d5\u304b\u3059Shell\u3068\u3001\u30a6\u30a7\u30d6\u4e0a\u3067\u52d5\u304b\u3059controller\u7b49\u306e\u30bd\u30fc\u30b9\u3067\u3001\u30ed\u30b8\u30c3\u30af\u3092\u5171\u6709\u3057\u305f\u3044\u306e\u306b\u65e2\u5b58\u306e\u3082\u306e\u3060\u3068\u30ed\u30b8\u30c3\u30af\u3092\u7f6e\u304f\u5834\u6240\u304c\u306a\u3044\u3067\u3059\u3002\n\n\u53c2\u8003\n\u307f\u3093\u306a\u56f0\u3063\u3066\u307e\u3059\u3002\n\n\ncakephp - How to load a component in console/shell - Stack Overflow \u3069\u3046\u3084\u3063\u3066\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092shell\u3067\u3064\u304b\u3046\u306e\uff1f\n\ncakephp 3.0 - Calling a Component function from helper - Stack Overflow \n\u3069\u3046\u3084\u3063\u3066\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092Helper\u306e\u4e2d\u3067\u3064\u304b\u3046\u306e\uff1f\n\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001Service\u30af\u30e9\u30b9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\n\u6b63\u76f4DDD\u306f\u3088\u304f\u5206\u304b\u3063\u3066\u307e\u305b\u3093\u3002\n\ncakephp3\u3067\u306f\u9069\u5f53\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068namespace\u3092\u52dd\u624b\u306b\u4f5c\u308c\u308b\nCakephp3\u306fsrc/Controller\u306a\u3069\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u3042\u308a\u307e\u3059\u304c\u3001src\u306e\u4e0b\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6398\u3063\u3066\u3001\u9069\u5207\u306anamespace\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\u3068\u3001\u305d\u306e\u914d\u4e0b\u306b\u304a\u3044\u305f\u30af\u30e9\u30b9\u306f\u3001\u81ea\u7531\u306b\u4ed6\u306e\u5834\u6240\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\uff08psr-4\u306e\u304a\u304b\u3052\u3067\u3059\u304c\uff09\n\ntree.log\n\ncake-app\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 config\n\u251c\u2500\u2500 logs\n\u251c\u2500\u2500 plugins\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Console\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Controller\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Model\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 \u7701\u7565....\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Service // \u3053\u3053\u306b\u9069\u5f53\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u308b\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 View\n\u251c\u2500\u2500 tmp\n\u251c\u2500\u2500 vendor\n\u2514\u2500\u2500 webroot\n    \u251c\u2500\u2500 css\n    \u251c\u2500\u2500 img\n    \u2514\u2500\u2500 js\n\n\n\nService\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3001class\u306ephp\u3092\u8d77\u304d\u3001\u30af\u30e9\u30b9\u306enamespace\u3092App\\Service\u306b\n\nsrc/Service/EnqueteFileService.php\n<?php\nnamespace App\\Service;\nclass EnqueteFileService {\n\n    public function imageFileExist($file_path) {\n        return file_exist($file_path);\n    }\n}\n\n\n\u3068\u3059\u308b\u3068\u3001\nSell\u3084Controller\u3084Model\u3084Helper\u3084Cell\u3084Entity\u3001Table\u306a\u3069\u3044\u308d\u3093\u306a\u3068\u3053\u308d\u3067\u3001use\u53e5\u3067\u8aad\u307f\u8fbc\u3093\u3067\u3042\u3052\u3066\u3001\u3053\u306e\u3088\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002\nuse App\\Service\\EnqueteFileService;\n\n// snip\n\n$service = new EnqueteFileService();\n$service->imageFileExist($file_path);\n\n\n\u4e00\u751f\u61f8\u547dcomponent\u306b\u5b9f\u88c5\u3057\u305f\u306e\u306bShell\u3067\u3064\u304b\u3048\u306d\u30fc\u3057\u3001\u4e00\u751f\u61f8\u547dcomponent\u306b\u5b9f\u88c5\u3057\u305f\u306e\u306bHelper\u306bcomponent\u3063\u3066\u307e\u3058\u3069\u3046\u3084\u3063\u3066\u6e21\u3059\u306e\u2026\u3002\u307e\u305f\u540c\u3058\u3053\u3068\u66f8\u304f\u306e\u304b\u3088\u30b3\u30ec\uff01\uff01\uff01\u307e\u305fTable\u30af\u30e9\u30b9\u306b\u66f8\u304f\u306e\u2026\u3002\u3053\u306e\u30ed\u30b8\u30c3\u30afEntity\u306b\u66f8\u3044\u3066\u3082\u3044\u3044\u2026\uff1f\uff1f\u3063\u3066\u9673\u8b1d\u3057\u306a\u304c\u3089\u8a31\u3057\u3092\u8acb\u3046\u306b\u306a\u3063\u305f\u3089\u3054\u5229\u7528\u304f\u3060\u3055\u3044\u3002\n\nAppService\u30af\u30e9\u30b9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u305d\u308c\u306a\u308a\u306b\u4f7f\u3048\u305d\u3046\u306a\u3001AppService\u30af\u30e9\u30b9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\nApp/Service/AppService.php\n<?php\nnamespace App\\Service;\n\nuse Cake\\Datasource\\ModelAwareTrait;\nuse Cake\\ORM\\Locator\\LocatorAwareTrait;\nuse Cake\\Log\\LogTrait;\n\nclass AppService {\n\n    use LocatorAwareTrait;\n    use LogTrait;\n    use ModelAwareTrait;\n\n    public $name = null;\n    public $plugin = null;\n\n    public function __construct($name = null)\n    {\n        if ($name !== null) {\n            $this->name = $name;\n        }\n\n        if ($this->name === null) {\n            list(, $name) = namespaceSplit(get_class($this));\n            $this->name = substr($name, 0, -10);\n        }\n        $this->initialize();\n    }\n\n    public function initialize() {\n\n    }\n\n    /**\n     * Magic accessor for model autoloading.\n     *\n     * @param string $name Property name\n     * @return bool|object The model instance or false\n     */\n    public function __get($name)\n    {\n        return $this->loadModel($name);\n    }\n}\n\n\n\u3053\u308c\u3092\u57fa\u5e95\u30af\u30e9\u30b9\u306b\u3059\u308b\u3068Table\u30af\u30e9\u30b9\u306e\u30ed\u30fc\u30c9\u3068\u304b\u304cController\u3068\u304a\u3093\u306a\u3058\u611f\u3058\u3067\u7c21\u5358\u306b\u3067\u304d\u307e\u3059\u3002phpdoc\u306e@property\u306e\u304a\u304b\u3052\u3060\u3051\u3069\n\nApp/Service/EnqueteFileService.php\n<?php\nnamespace App\\Service;\n\n/**\n * @property \\App\\Model\\Table\\EnqueteTable $Enquete\n * @property \\App\\Model\\Table\\EnqueteImageTable $EnqueteImage\n */\nclass EnqueteFileService extends AppService{\n\n    public function deleteRemainImages($id) {\n        $_enquetes = $this->Enquete->get($id, [\n            'contain' => ['EnqueteImage']\n        ]);\n        foreach($_enquetes as $_enquete) {\n            if(file_exist($_enquete->enquete_image->file_path)){\n                unlink($_enquete->enquete_image->file_path);\n            }\n\n        }\n    }\n}\n\n\n\u3053\u308c\u304c\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u3067\u3082shell\u3067\u3082helper\u3067\u3082component\u3067\u3082\u547c\u3073\u51fa\u305b\u307e\u3059\u3002\n## \u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u66f8\u304f\u3068\u3053\u308d\u7121\u3044\ncakephp\u3067\u306f\u3001Helper,Component,ShellHelper,Cell\u306a\u3069\u3082\u308d\u3082\u308d\u30ed\u30b8\u30c3\u30af\u3092\u4f7f\u3044\u307e\u308f\u3059\u305f\u3081\u306e\u6a5f\u69cb\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u30d0\u30c3\u30c1\u306a\u3069\u3092\u52d5\u304b\u3059Shell\u3068\u3001\u30a6\u30a7\u30d6\u4e0a\u3067\u52d5\u304b\u3059controller\u7b49\u306e\u30bd\u30fc\u30b9\u3067\u3001\u30ed\u30b8\u30c3\u30af\u3092\u5171\u6709\u3057\u305f\u3044\u306e\u306b\u65e2\u5b58\u306e\u3082\u306e\u3060\u3068\u30ed\u30b8\u30c3\u30af\u3092\u7f6e\u304f\u5834\u6240\u304c\u306a\u3044\u3067\u3059\u3002\n\n## \u53c2\u8003\n\n\u307f\u3093\u306a\u56f0\u3063\u3066\u307e\u3059\u3002\n\n* [cakephp - How to load a component in console/shell - Stack Overflow](http://stackoverflow.com/questions/28511023/how-to-load-a-component-in-console-shell) \u3069\u3046\u3084\u3063\u3066\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092shell\u3067\u3064\u304b\u3046\u306e\uff1f\n* [cakephp 3.0 - Calling a Component function from helper - Stack Overflow](http://stackoverflow.com/questions/27818635/calling-a-component-function-from-helper) \n\u3069\u3046\u3084\u3063\u3066\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092Helper\u306e\u4e2d\u3067\u3064\u304b\u3046\u306e\uff1f\n\n\n## \u3068\u3044\u3046\u3053\u3068\u3067\u3001Service\u30af\u30e9\u30b9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\n\n\u6b63\u76f4DDD\u306f\u3088\u304f\u5206\u304b\u3063\u3066\u307e\u305b\u3093\u3002\n\n### cakephp3\u3067\u306f\u9069\u5f53\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068namespace\u3092\u52dd\u624b\u306b\u4f5c\u308c\u308b\n\nCakephp3\u306fsrc/Controller\u306a\u3069\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u3042\u308a\u307e\u3059\u304c\u3001src\u306e\u4e0b\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6398\u3063\u3066\u3001\u9069\u5207\u306anamespace\u3092\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\u3068\u3001\u305d\u306e\u914d\u4e0b\u306b\u304a\u3044\u305f\u30af\u30e9\u30b9\u306f\u3001\u81ea\u7531\u306b\u4ed6\u306e\u5834\u6240\u3067\u3082\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\uff08[psr-4\u306e\u304a\u304b\u3052\u3067\u3059\u304c](http://book.cakephp.org/3.0/ja/appendices/3-0-migration-guide.html)\uff09\n\n\n```tree.log\n\ncake-app\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 config\n\u251c\u2500\u2500 logs\n\u251c\u2500\u2500 plugins\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Console\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Controller\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Model\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 \u7701\u7565....\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Service // \u3053\u3053\u306b\u9069\u5f53\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u308b\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 View\n\u251c\u2500\u2500 tmp\n\u251c\u2500\u2500 vendor\n\u2514\u2500\u2500 webroot\n    \u251c\u2500\u2500 css\n    \u251c\u2500\u2500 img\n    \u2514\u2500\u2500 js\n```\n\n### Service\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3001class\u306ephp\u3092\u8d77\u304d\u3001\u30af\u30e9\u30b9\u306enamespace\u3092App\\Service\u306b\n\n```src/Service/EnqueteFileService.php\n<?php\nnamespace App\\Service;\nclass EnqueteFileService {\n\n\tpublic function imageFileExist($file_path) {\n\t\treturn file_exist($file_path);\n\t}\n}\n```\n\n\u3068\u3059\u308b\u3068\u3001\n\nSell\u3084Controller\u3084Model\u3084Helper\u3084Cell\u3084Entity\u3001Table\u306a\u3069\u3044\u308d\u3093\u306a\u3068\u3053\u308d\u3067\u3001use\u53e5\u3067\u8aad\u307f\u8fbc\u3093\u3067\u3042\u3052\u3066\u3001\u3053\u306e\u3088\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002\n\n```\nuse App\\Service\\EnqueteFileService;\n\n// snip\n\n$service = new EnqueteFileService();\n$service->imageFileExist($file_path);\n\n```\n\n\u4e00\u751f\u61f8\u547dcomponent\u306b\u5b9f\u88c5\u3057\u305f\u306e\u306bShell\u3067\u3064\u304b\u3048\u306d\u30fc\u3057\u3001\u4e00\u751f\u61f8\u547dcomponent\u306b\u5b9f\u88c5\u3057\u305f\u306e\u306bHelper\u306bcomponent\u3063\u3066\u307e\u3058\u3069\u3046\u3084\u3063\u3066\u6e21\u3059\u306e\u2026\u3002\u307e\u305f\u540c\u3058\u3053\u3068\u66f8\u304f\u306e\u304b\u3088\u30b3\u30ec\uff01\uff01\uff01\u307e\u305fTable\u30af\u30e9\u30b9\u306b\u66f8\u304f\u306e\u2026\u3002\u3053\u306e\u30ed\u30b8\u30c3\u30afEntity\u306b\u66f8\u3044\u3066\u3082\u3044\u3044\u2026\uff1f\uff1f\u3063\u3066\u9673\u8b1d\u3057\u306a\u304c\u3089\u8a31\u3057\u3092\u8acb\u3046\u306b\u306a\u3063\u305f\u3089\u3054\u5229\u7528\u304f\u3060\u3055\u3044\u3002\n\n## AppService\u30af\u30e9\u30b9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u305d\u308c\u306a\u308a\u306b\u4f7f\u3048\u305d\u3046\u306a\u3001AppService\u30af\u30e9\u30b9\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n```App/Service/AppService.php\n<?php\nnamespace App\\Service;\n\nuse Cake\\Datasource\\ModelAwareTrait;\nuse Cake\\ORM\\Locator\\LocatorAwareTrait;\nuse Cake\\Log\\LogTrait;\n\nclass AppService {\n\n\tuse LocatorAwareTrait;\n\tuse LogTrait;\n\tuse ModelAwareTrait;\n\n\tpublic $name = null;\n\tpublic $plugin = null;\n\n\tpublic function __construct($name = null)\n\t{\n\t\tif ($name !== null) {\n\t\t\t$this->name = $name;\n\t\t}\n\n\t\tif ($this->name === null) {\n\t\t\tlist(, $name) = namespaceSplit(get_class($this));\n\t\t\t$this->name = substr($name, 0, -10);\n\t\t}\n\t\t$this->initialize();\n\t}\n\n\tpublic function initialize() {\n\n\t}\n\n\t/**\n\t * Magic accessor for model autoloading.\n\t *\n\t * @param string $name Property name\n\t * @return bool|object The model instance or false\n\t */\n\tpublic function __get($name)\n\t{\n\t\treturn $this->loadModel($name);\n\t}\n}\n```\n\n\u3053\u308c\u3092\u57fa\u5e95\u30af\u30e9\u30b9\u306b\u3059\u308b\u3068Table\u30af\u30e9\u30b9\u306e\u30ed\u30fc\u30c9\u3068\u304b\u304cController\u3068\u304a\u3093\u306a\u3058\u611f\u3058\u3067\u7c21\u5358\u306b\u3067\u304d\u307e\u3059\u3002phpdoc\u306e@property\u306e\u304a\u304b\u3052\u3060\u3051\u3069\n\n```App/Service/EnqueteFileService.php\n<?php\nnamespace App\\Service;\n\n/**\n * @property \\App\\Model\\Table\\EnqueteTable $Enquete\n * @property \\App\\Model\\Table\\EnqueteImageTable $EnqueteImage\n */\nclass EnqueteFileService extends AppService{\n\n\tpublic function deleteRemainImages($id) {\n\t\t$_enquetes = $this->Enquete->get($id, [\n\t\t\t'contain' => ['EnqueteImage']\n\t\t]);\n\t\tforeach($_enquetes as $_enquete) {\n\t\t\tif(file_exist($_enquete->enquete_image->file_path)){\n\t\t\t\tunlink($_enquete->enquete_image->file_path);\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n}\n```\n\n\u3053\u308c\u304c\u3001\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u3067\u3082shell\u3067\u3082helper\u3067\u3082component\u3067\u3082\u547c\u3073\u51fa\u305b\u307e\u3059\u3002\n\n\n", "tags": ["cakephp3"]}