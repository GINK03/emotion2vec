{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nCentOS7.1\u3092\u4f7f\u7528\u3057\u3066\u3001\u5185\u90e8\u5411\u3051DNS\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\nDNS\u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066\u3001BIND 9.9.4\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u5404\u7a2e\u30b5\u30a4\u30c8\u3084\u69cb\u7bc9\u3092\u901a\u3058\u3066\u3001\u81ea\u5206\u306a\u308a\u306e\u7406\u89e3\u3057\u305f\u5185\u5bb9\u306a\u3069\u3092\u8a18\u8f09\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4ee5\u4e0bURL\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\nhttp://centossrv.com/bind.shtml\nhttp://www.itmedia.co.jp/keywords/bind_tsukuru_dns_server.html\nhttp://www.atmarkit.co.jp/ait/articles/0309/09/news001.html\nhttp://www.atmarkit.co.jp/ait/articles/0310/15/news001.html\nhttp://qiita.com/shrkw/items/8410e9cb65eb789a40e1\n\nDNS\u69cb\u7bc9\n\nDNS\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\nCentOS7.1\u3067yum\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u305f\u3001BIND\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\u3092\u4e0b\u306b\u66f8\u304d\u307e\u3059\u3002\n\nchroot\u3068\u306f\nBIND\u306e\u30b5\u30fc\u30d3\u30b9\u300cnamed-chroot\u300d\u306b\u3088\u3063\u3066\u3001DNS\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306a\u7bc4\u56f2\u3092\u5236\u9650\u3057\u307e\u3059\u3002\n\u5185\u90e8\u7684\u306bchroot\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306f\u305a\u3067\u3059\uff08\u540d\u524d\u7684\u306b\uff09\nDNS\u3067\u306a\u305c\u5fc5\u8981\u304b\u3068\u3044\u3046\u3068\u3001DNS\u30b5\u30fc\u30d0\u30fc\u306f\u57fa\u672c\u7684\u306b\u4e16\u754c\u4e2d\u306b\u516c\u958b\u3059\u308b\u306e\u3067\u3001\u60aa\u3044\u4eba\u304b\u3089\u653b\u6483\u3092\u53d7\u3051\u308b\u6050\u308c\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001DNS\u95a2\u4fc2\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u53c2\u7167\u51fa\u6765\u308b\u7bc4\u56f2\u3092\u5236\u9650\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\n\u4e07\u304c\u4e00\u30e6\u30fc\u30b6\u30fc\u6a29\u9650\u3092\u596a\u308f\u308c\u3066\u3057\u307e\u3063\u3066\u3082\u3001\u5927\u4e8b\u306a\u30d5\u30a1\u30a4\u30eb\u306f\u53c2\u7167\u51fa\u6765\u306a\u304f\u3055\u305b\u307e\u3059\u3002\n\u4eca\u56de\u306eDNS\u8a2d\u5b9a\u3067\u306f /var/named/chroot/ \u304c DNS\u30d7\u30ed\u30bb\u30b9\u306b\u3068\u3063\u3066\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306a\u308a\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306fhttp://www.atmarkit.co.jp/ait/articles/0309/09/news001.html\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nbind(DNS\u30b5\u30fc\u30d0\u30fc\u30d7\u30ed\u30b0\u30e9\u30e0)\u3068\u3001bind-chroot(BIND\u7528\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3055\u308c\u305fchroot\u30d7\u30ed\u30b0\u30e9\u30e0\uff1f)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n[root@mng-server ~]# yum -y install bind bind-chroot\n\nbind-chroot\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u751f\u6210\u3055\u308c\u305f\u3001chroot\u5316\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n[root@mng-server ~]# /usr/libexec/setup-named-chroot.sh /var/named/chroot on\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30d5\u30a1\u30a4\u30eb\u304c\u30de\u30a6\u30f3\u30c8\u3055\u308c\u307e\u3059\u3002\n\u30b9\u30af\u30ea\u30d7\u30c8\u3092off\u306b\u3059\u308b\u3068\u3001mount\u5148\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u7dba\u9e97\u306b\u306a\u304f\u306a\u3063\u3066\u3001mount\u5143\u306b\u306e\u307f\u5b58\u5728\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001BIND\u8a2d\u5b9a\u5b8c\u4e86\u5f8c\u306b\u8d77\u52d5\u3059\u308b\u30b5\u30fc\u30d3\u30b9\u300cnamed-chroot\u300d\u306b\u3088\u3063\u3066\u3082\u3001\u30de\u30a6\u30f3\u30c8\u3055\u308c\u307e\u3059\u3002\n\u4eca\u307e\u3067\u89e6\u3063\u3066\u3044\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u6025\u306b\u6d88\u3048\u3066\u306a\u304f\u306a\u308b\u3088\u3046\u306b\u898b\u3048\u308b\u305f\u3081\u3001\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\n\nmount\u5143\nmount\u5148\n\n\n\n\n/etc/named\n/var/named/chroot/etc/named\n\n\n/etc/named.root.key\n/var/named/chroot/etc/named.root.key\n\n\n/etc/named.conf\n/var/named/chroot/etc/named.conf\n\n\n/etc/named.rfc1912.zone\n/var/named/chroot/etc/named.rfc1912.zones\n\n\n/etc/rndc.key\n/var/named/chroot/etc/rndc.key\n\n\n/etc/named.iscdlv.key\n/var/named/chroot/etc/named.iscdlv.key\n\n\n/run/named\n/var/named/chroot/run/named\n\n\n/var/named\n/var/named/chroot/var/named\n\n\n/usr/lib64/bind\n/var/named/chroot/usr/lib64/bind\n\n\n\n\nnamed.conf\u306e\u4f5c\u6210\n\u5404\u7a2e\u30b5\u30a4\u30c8\u3092\u8abf\u3079\u3066\u3001\u81ea\u5206\u306a\u308a\u306e\u7406\u89e3\u3057\u305f\u5185\u5bb9\u3092\u66f8\u304d\u307e\u3059\u3002\n\u9593\u9055\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u3082\u5341\u5206\u3042\u308b\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nBIND\u3092\u69cb\u7bc9\u3059\u308b\u4e0a\u3067\u306e\u3001\u5927\u5143\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u3000named.conf \u3067\u3059\u3002\n\u4eca\u56de\u306e\u69cb\u6210\u3067\u306f\u3001/var/named/chroot/etc/named.conf \u304c\u683c\u7d0d\u5148\u306b\u306a\u308a\u307e\u3059\u3002\nchroot\u3067\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u5b9f\u4f53\u306f/etc/named.conf\u306b\u6709\u308a\u307e\u3059\u3002\n\u307e\u305a\u306f\u30d5\u30a1\u30a4\u30eb\u5168\u4f53\u306e\u4e2d\u8eab\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\u74b0\u5883\u306b\u4f9d\u5b58\u3059\u308b\u5185\u5bb9\u3082\u3042\u308b\u306e\u3067\u3001\u9069\u5b9c\u4fee\u6b63\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n/var/named/chroot/etc/named.conf\n/* \u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u5b9a\u7fa9 */\nacl \"mylabo-network\" {\n        192.168.11.0/24;\n        192.168.12.0/24;\n        192.168.13.0/24;\n        192.168.14.0/24;\n        192.168.15.0/24;\n};\n\noptions {\n        #listen-on port 53 { 127.0.0.1; };\n        listen-on-v6 port 53 { ::1; } ; //IPv6\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\n        version         \"unknown\";\n        directory       \"/var/named\";\n        dump-file       \"/var/named/data/cache_dump.db\";\n        statistics-file \"/var/named/data/named_stats.txt\";\n        memstatistics-file \"/var/named/data/named_mem_stats.txt\";\n        allow-query     { localhost; mylabo-network; }; //\u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u304b\u3089\u306e\u554f\u3044\u5408\u308f\u305b\u306e\u307f\u8a31\u53ef\u3057\u307e\u3059\n\n        /*\n         - If you are building an AUTHORITATIVE DNS server, do NOT enable recursion.\n         - If you are building a RECURSIVE (caching) DNS server, you need to enable\n           recursion.\n         - If your recursive DNS server has a public IP address, you MUST enable access\n           control to limit queries to your legitimate users. Failing to do so will\n           cause your server to become part of large scale DNS amplification\n           attacks. Implementing BCP38 within your network would greatly\n           reduce such attack surface\n        */\n        recursion yes; // \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3059\u308b\u306e\u3067\u3001\u30d5\u30eb\u30b5\u30fc\u30d3\u30b9\u30ea\u30be\u30eb\u30d0(\u30ad\u30e3\u30c3\u30b7\u30e5\u30b5\u30fc\u30d0)\u3068\u3057\u3066\u3082\u52d5\u4f5c\u3055\u305b\u307e\u3059\n\n        /* DNSSEC\u306f\u7121\u52b9\u306b\u3057\u307e\u3059 */\n        dnssec-enable no;\n        dnssec-validation no;\n        //dnssec-lookaside auto;\n        managed-keys-directory \"/var/named/dynamic\";\n\n        /* Path to ISC DLV key */\n        bindkeys-file \"/etc/named.iscdlv.key\";\n\n        /* \u81ea\u5206\u81ea\u8eab\u3067\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u306a\u3044\u5834\u5408\u306f\u3001\u4e0a\u4f4d\u306eDNS\u30b5\u30fc\u30d0\u30fc(\u81ea\u5b85\u30eb\u30fc\u30bf\u30fc)\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u307e\u3059 */\n        forwarders {\n                192.168.11.1;\n        };\n        forward only;\n\n\n        pid-file \"/run/named/named.pid\";\n        session-keyfile \"/run/named/session.key\";\n};\n\nlogging {\n        channel default_debug {\n                file \"data/named.run\";\n                severity dynamic;\n        };\n        category lame-servers { null; }; //\u8ffd\u52a0(error (connection refused) resolving\u3068\u3044\u3046\u30a8\u30e9\u30fc\u30ed\u30b0\u306e\u51fa\u529b\u6291\u6b62)\n};\n\nview \"internal\" {\n        /* \u6700\u4e0a\u90e8\u3067\u5b9a\u7fa9\u3057\u305f\u30ed\u30fc\u30ab\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u3001\u5185\u90e8\u554f\u3044\u5408\u308f\u305b\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u307e\u3059 */\n        match-clients { localhost; mylabo-network; };\n        match-destinations { localhost; mylabo-network; };\n\n        zone \".\" IN {\n                type hint;\n                file \"named.ca\";\n        };\n\n        /* \u6b63\u5f15\u304d\u30be\u30fc\u30f3 */\n        zone \"mylabo.local\" IN {\n                type master;\n                file \"mylabo.local.lan\";\n        };\n\n        /* \u9006\u5f15\u304d\u30be\u30fc\u30f3 */\n        zone \"11.168.192.in-addr.arpa\" {\n                type master;\n                file \"11.168.192.in-addr.arpa.rev\";\n        };\n\n        zone \"14.168.192.in-addr.arpa\" {\n                type master;\n                file \"14.168.192.in-addr.arpa.rev\";\n        };\n\n        zone \"15.168.192.in-addr.arpa\" {\n                type master;\n                file \"15.168.192.in-addr.arpa.rev\";\n        };\n\n        include \"/etc/named.rfc1912.zones\"; //localhost\u306a\u3069\u306e\u5b9a\u7fa9\n        include \"/etc/named.root.key\";\n};\n\n/* \u5185\u90e8\u3080\u3051DNS\u306a\u306e\u3067\u3001\u5916\u90e8\u5411\u3051\u306eView\u306f\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\nview \"external\" {\n        match-clients { any; };\n        match-destinations { any; };\n        recursion no;\n};\n */\n\n\n\nnamed.conf\u306e\u69cb\u6210\u306b\u3064\u3044\u3066\nnamed.conf\u306f\u5927\u304d\u304f\u5206\u3051\u3066\u3001\u2193\u306e4\u7a2e\u985e\u306e\u30ab\u30c6\u30b4\u30ea\u306b\u5206\u304b\u308c\u307e\u3059\u3002\nacl \"\u4efb\u610f\u306eacl\u540d\u79f0\" {\n        \u7701\u7565\n};\n\noptions {\n        \u7701\u7565\n};\n\nlogging {\n        \u7701\u7565\n};\n\nview \"\u4efb\u610f\u306eview\u540d\u79f0\" {\n        \u7701\u7565\n};\n\n\u4e00\u3064\u305a\u3064\u7c21\u5358\u306b\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n1\u30ab\u30c6\u30b4\u30ea\u76ee\uff1aacl(access control list)\nnamed.conf\u3092\u7de8\u96c6\u3057\u3066\u3044\u304f\u4e0a\u3067\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c9\u30ec\u30b9\u306a\u3069\u3092\u6307\u5b9a\u3057\u3066\u3001\n\u30a2\u30af\u30bb\u30b9\u53ef\u5426\u306a\u3069\u3092\u8a2d\u5b9a\u3059\u308b\u7b87\u6240\u304c\u3042\u308a\u307e\u3059\u3002\n\u4f8b\u3048\u30705\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u6307\u5b9a\u3057\u305f\u3044\u6642\u306f\u30015\u30bb\u30b0\u30e1\u30f3\u30c8\u5206\u66f8\u3044\u3066\u3082\u52d5\u4f5c\u3057\u307e\u3059\u304c\u3001\n\u3044\u3061\u3044\u3061\u66f8\u304f\u306e\u304c\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067\u3001\u540d\u524d\u3092\u4ed8\u3051\u308b\u4e8b\u304c\u51fa\u6765\u307e\u3059\u3002\n\u4eca\u56de\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u306fmylabo-network\u3092\u5b9a\u7fa9\u3057\u307e\u3057\u305f\u3002\n\nnamed.conf\u306eacl\u629c\u7c8b\n/* \u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u5b9a\u7fa9 */\nacl \"mylabo-network\" {\n        192.168.11.0/24;\n        192.168.12.0/24;\n        192.168.13.0/24;\n        192.168.14.0/24;\n        192.168.15.0/24;\n};\n\n\n\u2191\u306e\u5b9a\u7fa9\u3092\u3059\u308b\u3068\u3001\u2193\u306e\u3088\u3046\u306b\u3001\u4ed6\u306e\u8a2d\u5b9a\u9805\u76ee\u3067\u4f7f\u7528\u3067\u304d\u308b\u540d\u524d\u3068\u306a\u308a\u307e\u3059\u3002\nallow-query     { localhost; mylabo-network; }; //\u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u304b\u3089\u306e\u554f\u3044\u5408\u308f\u305b\u306e\u307f\u8a31\u53ef\u3057\u307e\u3059\n\n\u3000\n\n2\u30ab\u30c6\u30b4\u30ea\u76ee\uff1aoptions\nBIND\u306e\u8272\u3005\u306a\u52d5\u4f5c\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u5927\u4e8b\u306a\u30dd\u30a4\u30f3\u30c8\u3084\u30c7\u30d5\u30a9\u30eb\u30c8\u304b\u3089\u5909\u66f4\u3057\u305f\u3068\u3053\u308d\u3092\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3000\n\nnamed.conf\u306eoption\u629c\u7c8b\n#listen-on port 53 { 127.0.0.1; };\nlisten-on-v6 port 53 { ::1; } ; //IPv6\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\n\n\nBIND\u304c\u540d\u524d\u89e3\u6c7a\u3092\u53d7\u3051\u4ed8\u3051\u308bNIC\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u300clisten-on port 53 { 127.0.0.1; };\u300d\u306e\u8a2d\u5b9a\u5024\u306a\u3089\u3001\u300c127.0.0.1\u300d\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3078\u306e\n\u30a2\u30af\u30bb\u30b9\u306e\u307f\u53d7\u3051\u4ed8\u3051\u308b\u5f62\u306b\u306a\u308b\u306e\u3067\u3001\u81ea\u5206\u81ea\u8eab\u3057\u304b\u540d\u524d\u89e3\u6c7a\u3092\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u306a\u3044\u69cb\u6210\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u308c\u3067\u306f\u56f0\u308b\u306e\u3067\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\u300clisten-on-v6 port 53 { ::1; } ;\u300d\u306fIPv6\u306a\u306e\u3067\u3001\u4eca\u56de\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002\n\u3053\u306e\u307e\u307e\u81ea\u5206\u81ea\u8eab\u306e\u307f\u53d7\u3051\u4ed8\u3051\u308b\u8a2d\u5b9a\u306b\u3057\u307e\u3059\u3002\n\u3000\n\u3000\n\nnamed.conf\u306eoption\u629c\u7c8b\nversion         \"unknown\";\n\n\nBIND\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8a18\u8f09\u3057\u3066\u3044\u308b\u7b87\u6240\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u306b\u6b63\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u66f8\u304f\u3068\n\u5916\u90e8\u304b\u3089\u306eBIND\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u51fa\u6765\u3066\u3057\u307e\u3046\u306e\u3067\u3001\n\u8106\u5f31\u6027\u3092\u653b\u6483\u3055\u308c\u3084\u3059\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001unknown\u306b\u3057\u3066\u96a0\u3057\u307e\u3059\u3002\n\u3000\n\u3000\n\nnamed.conf\u306eoption\u629c\u7c8b\ndirectory       \"/var/named\";\n\n\nnamed.conf\u304c4\u30ab\u30c6\u30b4\u30ea\u306b\u5206\u3051\u3089\u308c\u308b\u3046\u3061\u306e\u30013\u30ab\u30c6\u30b4\u30ea\u76ee(logging)\u30014\u30ab\u30c6\u30b4\u30ea\u76ee(view)\u3067\n\u5404\u7a2e\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u53c2\u7167\u3092\u6307\u5b9a\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u3089\u306e\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u3053\u3053\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306e\u69cb\u6210\u3067\u306fchroot\u69cb\u6210\u306a\u306e\u3067\u3001\u7d76\u5bfe\u30d1\u30b9\u306f\u300c/var/named/chroot/var/named\u300d\u3067\u3059\u3002\n\u6df7\u4e71\u3057\u3084\u3059\u3044\u3068\u3053\u308d\u306a\u306e\u3067\u6ce8\u610f\u3057\u307e\u3057\u3087\u3046\u3002\n\u3000\n\u3000\n\nnamed.conf\u306eoption\u629c\u7c8b\nallow-query     { localhost; mylabo-network; }; //\u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u304b\u3089\u306e\u554f\u3044\u5408\u308f\u305b\u306e\u307f\u8a31\u53ef\u3057\u307e\u3059\n\n\n\u540d\u524d\u89e3\u6c7a\u3092\u53d7\u3051\u4ed8\u3051\u308b\u3001DNS\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nmylabo-network \u306f1\u30ab\u30c6\u30b4\u30ea\u76ee(acl)\u3067\u5b9a\u7fa9\u3057\u307e\u3057\u305f\u3002\n\u3000\n\u3000\n\nnamed.conf\u306eoption\u629c\u7c8b\nrecursion yes; // \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3059\u308b\u306e\u3067\u3001\u30d5\u30eb\u30b5\u30fc\u30d3\u30b9\u30ea\u30be\u30eb\u30d0(\u30ad\u30e3\u30c3\u30b7\u30e5\u30b5\u30fc\u30d0)\u3068\u3057\u3066\u3082\u52d5\u4f5c\u3055\u305b\u307e\u3059\n\n\nyes\u306b\u3059\u308b\u3068\u3001\u81ea\u5206\u81ea\u8eab\u3067\u89e3\u6c7a\u51fa\u6765\u306a\u3044\u554f\u3044\u5408\u308f\u305b\u306b\u5bfe\u3057\u3066\u3001\u307b\u304b\u306eDNS\u30b5\u30fc\u30d0\u305f\u3061\u3092\u4f7f\u7528\u3057\u3066\u518d\u5e30\u554f\u3044\u5408\u308f\u305b\u3092\u3057\u307e\u3059\u3002\nno\u3067\u306f\u3057\u307e\u305b\u3093\u3002\n\u3000\n\u3000\n\nnamed.conf\u306eoption\u629c\u7c8b\n/* DNSSEC\u306f\u7121\u52b9\u306b\u3057\u307e\u3059 */\ndnssec-enable no;\ndnssec-validation no;\n//dnssec-lookaside auto;\nmanaged-keys-directory \"/var/named/dynamic\";\n\n\nDNSSEC\u3068\u3044\u3046\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u6a5f\u80fd\u306e\u4ed5\u69d8\u6709\u7121\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u516c\u958b\u9375\u6697\u53f7\u65b9\u5f0f\u3092\u4f7f\u7528\u3057\u3066\u30bb\u30ad\u30e5\u30a3\u30c6\u30a3\u5411\u4e0a\u3092\u56f3\u308b\u3088\u3046\u3067\u3059\u3002\n\u4eca\u56de\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002\n\u3000\n\u3000\n\nnamed.conf\u306eoption\u629c\u7c8b\n/* \u81ea\u5206\u81ea\u8eab\u3067\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u306a\u3044\u5834\u5408\u306f\u3001\u4e0a\u4f4d\u306eDNS\u30b5\u30fc\u30d0\u30fc(\u81ea\u5b85\u30eb\u30fc\u30bf\u30fc)\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u307e\u3059 */\nforwarders {\n        192.168.11.1;\n};\nforward only;\n\n\n\u30b3\u30e1\u30f3\u30c8\u306b\u3082\u66f8\u3044\u3066\u307e\u3059\u304c\u3001\u4ed6\u306eDNS\u3078\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\u969b\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u300cforward only;\u300d\u306e\u7b87\u6240\u304c\u3088\u304f\u308f\u304b\u3063\u3066\u306a\u3044\u306e\u3067\u3001\u8a73\u3057\u3044\u65b9\u3001\u662f\u975e\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002\nforward \u306b\u306f\u4e8c\u7a2e\u985e\u306e\u6307\u5b9a\u304c\u3042\u308a\u3001 only \u304b first \u3067\u3059\u3002\n\u4ee5\u4e0b\u8aac\u660e\u5f15\u7528\n\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3001forwarders \u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u3068\u304d\u306e\u307f\u6709\u52b9\u306b\u306a\u308b\u3002 \nfirst \u3092\u6307\u5b9a\u3059\u308b\u3068\u3001\u6700\u521d\u306b\uff08\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u4e2d\u306b\u7b54\u3048\u304c\u898b\u3064\u304b\u3089\u306a\u3051\u308c\u3070\uff09 forwarders \u3067\u6307\u5b9a\u3057\u305f\n\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u3001\u3082\u3057\u7b54\u3048\u304c\u5f97\u3089\u308c\u306a\u3051\u308c\u3070\u6b21\u306b\u81ea\u5206\u81ea\u8eab\u3067\u7b54\u3048\u3092\u898b\u3064\u3051\u3088\u3046\u3068\u3059\u308b\u3002 \nonly \u3092\u6307\u5b9a\u3059\u308b\u3068\u3001\u5358\u7d14\u306b forwarders \u3067\u6307\u5b9a\u3057\u305f\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u308b\u3002 \n\u30c7\u30d5\u30a9\u30eb\u30c8\u306f first\u3002\nLAN \u5185\u306e\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306e\u3088\u3046\u306a\u3001\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u76f4\u63a5\u554f\u3044\u5408\u308f\u305b\u3092\u3055\u305b\u305f\u304f\u306a\u3044\u30b5\u30fc\u30d0\u3067\u4f7f\u7528\u3055\u308c\u308b\u3002\n\u5f15\u7528\u7d42\u4e86\nonly\u306b\u3059\u308b\u3068\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u4e0a\u306b\u3042\u308b\u30b5\u30fc\u30d0\u30fc\u306e\u540d\u524d\u89e3\u6c7a(google.co.jp)\u304c\u51fa\u6765\u305f\u306e\u3067\u3059\u304c\u3001\nfirst\u3067\u306f\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u4e0a\u8a18\u306e\u8aac\u660e\u3067\u306f\u3001first\u3067\u3082\u5916\u90e8\u3078\u540d\u524d\u89e3\u6c7a\u3057\u3066\u304f\u308c\u305d\u3046\u306a\u5185\u5bb9\u3067\u3059\u304c\u3001\u3057\u3066\u304f\u308c\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u8b0e\u3067\u3059\u3002\n\n3\u30ab\u30c6\u30b4\u30ea\u76ee\uff1alogging\nDNS\u306e\u5404\u7a2e\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u51fa\u529b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nnamed.conf\u306elogging\u629c\u7c8b\nchannel default_debug {\n        file \"data/named.run\";\n        severity dynamic;\n};\ncategory lame-servers { null; }; //\u8ffd\u52a0(error (connection refused) resolving\u3068\u3044\u3046\u30a8\u30e9\u30fc\u30ed\u30b0\u306e\u51fa\u529b\u6291\u6b62)\n\n\n\u4e0a\u8a18\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ed\u30b0\u51fa\u529b\u306b\u3001\u300ccategory lame-servers { null; };\u300d\u3092\u52a0\u3048\u307e\u3057\u305f\u3002\n\u307e\u305f\u3001BIND\u306e\u540d\u524d\u89e3\u6c7a\u3092\u3059\u308b\u969b\u306e\u30c7\u30d0\u30c3\u30b0\u51fa\u529b\u306e\u4f8b\u3092\u4ee5\u4e0b\u306b\u66f8\u304d\u307e\u3059\u3002\nlogging {\n        channel \"default_debug\" {\n                file \"data/named.run\";\n                severity debug;\n                print-time yes;\n                print-severity yes;\n                print-category yes;\n        };\n\n        category queries { \"default_debug\"; };\n        category resolver { \"default_debug\"; };\n\n        category lame-servers { null; }; //\u8ffd\u52a0(error (connection refused) resolving\u3068\u3044\u3046\u30a8\u30e9\u30fc\u30ed\u30b0\u306e\u51fa\u529b\u6291\u6b62)\n\nchannel \"default_debug\"\u306eseverity \u3092debug\u306b\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30ed\u30b0\u51fa\u529b\u306e\u30ec\u30d9\u30eb\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4e0b\u8a183\u7a2e\u985e\u306eyes\u306e\u6307\u5b9a\u306f\u3001\u30ed\u30b0\u5185\u306b\u6642\u9593\u3084\u30ed\u30b0\u306e\u5185\u5bb9\u30fb\u30ed\u30b0\u30ec\u30d9\u30eb(debug\u3068\u304binfo\u3068\u304b)\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\n\u3053\u308c\u3089\u51fa\u529b\u3055\u308c\u306a\u3044\u3068\u308f\u304b\u308a\u306b\u304f\u3044\u306e\u3067\u3001yes\u304c\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nprint-time yes;\nprint-severity yes;\nprint-category yes;\n\u30ed\u30b0\u51fa\u529b\u306e\u4f8b\n18-Dec-2015 23:49:38.702 queries: info: client 127.0.0.1#54599 (torapc.mylabo.local): view internal: query: torapc.mylabo.local IN A + (127.0.0.1)\n18-Dec-2015 23:49:38.703 queries: info: client 127.0.0.1#57318 (3.11.168.192.in-addr.arpa): view internal: query: 3.11.168.192.in-addr.arpa IN PTR + (127.0.0.1)\n18-Dec-2015 23:49:39.705 queries: info: client 127.0.0.1#34290 (3.11.168.192.in-addr.arpa): view internal: query: 3.11.168.192.in-addr.arpa IN PTR + (127.0.0.1)\n18-Dec-2015 23:49:45.654 queries: info: client 127.0.0.1#38613 (google.co.jp): view internal: query: google.co.jp IN A + (127.0.0.1)\n18-Dec-2015 23:49:45.654 resolver: debug 1: createfetch: google.co.jp A\n18-Dec-2015 23:49:45.669 queries: info: client 127.0.0.1#33558 (207.126.194.173.in-addr.arpa): view internal: query: 207.126.194.173.in-addr.arpa IN PTR + (127.0.0.1)\n18-Dec-2015 23:49:45.669 resolver: debug 1: createfetch: 207.126.194.173.in-addr.arpa PTR\n18-Dec-2015 23:49:46.669 queries: info: client 127.0.0.1#51301 (207.126.194.173.in-addr.arpa): view internal: query: 207.126.194.173.in-addr.arpa IN PTR + (127.0.0.1)\n\n\u2193\u306e\u30da\u30fc\u30b8\u306blogging\u306e\u8a73\u7d30\u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\nhttp://www.atmarkit.co.jp/ait/articles/0310/15/news001.html\n\n4\u30ab\u30c6\u30b4\u30ea\u76ee\uff1aview\nview\u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u306f\u3001\u5185\u90e8\u5411\u3051\u306e\u540d\u524d\u89e3\u6c7a\u306e\u51e6\u7406\u65b9\u6cd5\u3068\u3001\u5916\u90e8\u5411\u3051\u306e\u51e6\u7406\u65b9\u6cd5\u3092\u5206\u3051\u3066\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\nview \"internal\" \u3067\u5185\u90e8\u5411\u3051\u306e\u8a2d\u5b9a\u3001view \"external\"\u3067\u5916\u90e8\u5411\u3051\u306e\u8a2d\u5b9a\u3092\u52a0\u3048\u308b\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u3002\nview\u306e\u540d\u524d\u306f\u4efb\u610f\u306e\u540d\u524d\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\nnamed.conf\u306eview\u629c\u7c8b\n/* \u6700\u4e0a\u90e8\u3067\u5b9a\u7fa9\u3057\u305f\u30ed\u30fc\u30ab\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u3001\u5185\u90e8\u554f\u3044\u5408\u308f\u305b\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u307e\u3059 */\nmatch-clients { localhost; mylabo-network; };\nmatch-destinations { localhost; mylabo-network; };\n\n\nview\u3067\u51e6\u7406\u3059\u308b\u305f\u3081\u306e\u6761\u4ef6\u3092\u3053\u3053\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\nmatch-clients\u3067\u306f\u3001\u540d\u524d\u89e3\u6c7a\u306e\u8981\u6c42\u5143\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u81ea\u5206\u81ea\u8eab\u3068\u3001\u5185\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092view \"internal\"\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u307e\u3059\u3002\nmatch-destinations\u306e\u6307\u5b9a\u306f\u3001BIND\u30b5\u30fc\u30d0\u30fc\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u3001192.168.15.1\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u7528\u306eview\u3092\u5b9a\u7fa9\u3001\n192.168.16.1\u7528\u306eview\u3092\u5b9a\u7fa9\u3001\u3068\u3044\u3063\u305f\u3088\u3046\u306b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3054\u3068\u306b\u51e6\u7406\u65b9\u6cd5\u3092\u5206\u3051\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u4eca\u56de\u306f\u7279\u306b\u5206\u5272\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u306e\u3067\u3001\u300clocalhost; mylabo-network;\u300d\u3068\u3057\u3066\u307e\u3059\u304c\u3001\n\u3053\u308c\u306f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c9\u30ec\u30b9\u3067\u306e\u6307\u5b9a\u3067\u3059\u306e\u3067\u3001\u6b63\u78ba\u306a\u6307\u5b9a\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u306d(\u00b4-`)\n\u3000\n\nnamed.conf\u306eview\u629c\u7c8b\nzone \".\" IN {\n        type hint;\n        file \"named.ca\";\n};\n\n\nDNS\u306e\u30eb\u30fc\u30c8\u30c9\u30e1\u30a4\u30f3\u306e\u6307\u5b9a\u3067\u3059\u3002\n\u3053\u306e\u6307\u5b9a\u306f\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u3067\u3082\u540c\u4e00\u306e\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\ntype \u3067hint\u3068\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u30eb\u30fc\u30c8\u30c9\u30e1\u30a4\u30f3\u7528\u306e\u5b9a\u7fa9\u306b\u306a\u308a\u307e\u3059\u3002\nfile \u3067\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u304c\u3001\u4ed6\u306e\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u53c2\u7167\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\noption\u30ab\u30c6\u30b4\u30ea\u306edirectory\u3067\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\n\u300c/var/named/chroot/var/named/named.ca\u300d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3001\u3068\u3044\u3046\u610f\u5473\u306b\u306a\u308a\u307e\u3059\u3002\nchroot\u74b0\u5883\u306a\u306e\u3067\u3001\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\nnamed.ca\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u751f\u6210\u3055\u308c\u307e\u3059\u3002\n\u3000\n\nnamed.conf\u306eview\u629c\u7c8b\n/* \u6b63\u5f15\u304d\u30be\u30fc\u30f3 */\nzone \"mylabo.local\" IN {\n        type master;\n        file \"mylabo.local.lan\";\n};\n\n\n\u6b63\u5f15\u304d\u7528\u306e\u30be\u30fc\u30f3\u306e\u6307\u5b9a\u3067\u3059\u3002\nzone \u3067DNS\u306e\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u3092\u5b9a\u7fa9\u3067\u304d\u307e\u3059\u3002\ntype \u3067master\u3068\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001DNS\u30d7\u30e9\u30a4\u30de\u30ea\u30b5\u30fc\u30d0\u30fc\u3067\u3042\u308b\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\nslave \u3068\u6307\u5b9a\u3059\u308b\u3068\u3001\u30bb\u30ab\u30f3\u30c0\u30ea\u30b5\u30fc\u30d0\u30fc\u3068\u306a\u308a\u307e\u3059\u3002\nfile\u3067\u6b63\u5f15\u304d\u7528\u306e\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u300c/var/named/chroot/var/named/mylabo.local.lan\u300d\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\u3000\n\nnamed.conf\u306eview\u629c\u7c8b\n/* \u9006\u5f15\u304d\u30be\u30fc\u30f3 */\nzone \"11.168.192.in-addr.arpa\" {\n        type master;\n        file \"11.168.192.in-addr.arpa.rev\";\n};\n\nzone \"14.168.192.in-addr.arpa\" {\n        type master;\n        file \"14.168.192.in-addr.arpa.rev\";\n};\n\nzone \"15.168.192.in-addr.arpa\" {\n        type master;\n        file \"15.168.192.in-addr.arpa.rev\";\n};\n\n\n\u9006\u5f15\u304d\u7528\u306e\u30be\u30fc\u30f3\u306e\u6307\u5b9a\u3067\u3059\u3002\nzone\u306e\u6307\u5b9a\u65b9\u6cd5\u304c\u7279\u6b8a\u3067\u3059\u304c\u3001\u305d\u308c\u4ee5\u5916\u306f\u6b63\u5f15\u304d\u7528\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u3002\n\u4eca\u56de\u9006\u5f15\u304d\u3057\u305f\u3044\u306e\u306f3\u30bb\u30b0\u30e1\u30f3\u30c8\u3042\u308b\u306e\u3067\u30013\u3064\u306e\u5b9a\u7fa9\u304c\u3042\u308a\u307e\u3059\u3002\n192.168.11.0/24\u306e\u30bb\u30b0\u30e1\u30f3\u30c8\u7528\u306e\u5b9a\u7fa9\u304c\u4e00\u756a\u4e0a\u306e\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u9006\u9806\u306b\u8a18\u8f09\u3059\u308b\u306e\u3068\u3001\u672b\u5c3e\u306b\u300c.in-addr.arpa\u300d\u3092\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u300c.in-addr.arpa\u300d\u3092\u4ed8\u4e0e\u3059\u308b\u3053\u3068\u3067\u3001\u6b63\u5f15\u304d\u3068\u540c\u3058\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u3001\u9006\u5f15\u304d\u3092\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u4f8b\uff09\ntorapc.mylabo.local\u2192\u6b63\u5f15\u304d\u2192192.168.11.3\n3.11.168.192.in-addr.arpa\u2192\u6b63\u5f15\u304d\u2192torapc.mylabo.local\n\u300c3.11.168.192.in-addr.arpa\u300d\u3068\u3044\u3046\u30db\u30b9\u30c8\u540d\u3068\u3057\u3066\u3001\u6b63\u5f15\u304d\u3092\u3059\u308b\u51e6\u7406\u3068\u306a\u308a\u307e\u3059\u3002\n\u3000\n\u3000\n\nnamed.conf\u306eview\u629c\u7c8b\ninclude \"/etc/named.rfc1912.zones\"; //localhost\u306a\u3069\u306e\u5b9a\u7fa9\ninclude \"/etc/named.root.key\";\n\n\nnamed.conf\u30d5\u30a1\u30a4\u30eb\u306f\u3001include\u3092\u4f7f\u7528\u3057\u3066\u3001\u5916\u90e8\u306b\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u5b9a\u7fa9\u3092\u5f15\u7528\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u306e\u5b9a\u7fa9\u3084\u3001\u30eb\u30fc\u30c8\u30c9\u30e1\u30a4\u30f3\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u305d\u308c\u305e\u308c\u306eBIND\u3067\u5b9a\u7fa9\u3059\u308b\u3088\u308a\u3082\n\u4e00\u500b\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6d41\u7528\u3057\u305f\u307b\u3046\u304c\u6574\u7406\u3057\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\u300cnamed.rfc1912.zones\u300d\u306e\u4e2d\u8eab\u3092\u4e0b\u306b\u66f8\u304d\u307e\u3059\u3002\n\nnamed.rfc1912.zones\n// named.rfc1912.zones:\n//\n// Provided by Red Hat caching-nameserver package \n//\n// ISC BIND named zone configuration for zones recommended by\n// RFC 1912 section 4.1 : localhost TLDs and address zones\n// and http://www.ietf.org/internet-drafts/draft-ietf-dnsop-default-local-zones-02.txt\n// (c)2007 R W Franks\n// \n// See /usr/share/doc/bind*/sample/ for example named configuration files.\n//\n\nzone \"localhost.localdomain\" IN {\ntype master;\nfile \"named.localhost\";\nallow-update { none; };\n};\n\nzone \"localhost\" IN {\ntype master;\nfile \"named.localhost\";\nallow-update { none; };\n};\n\n\n\nzone \"1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa\" IN {\ntype master;\nfile \"named.loopback\";\nallow-update { none; };\n};\n\n\nzone \"1.0.0.127.in-addr.arpa\" IN {\ntype master;\nfile \"named.loopback\";\nallow-update { none; };\n};\n\n\nzone \"0.in-addr.arpa\" IN {\ntype master;\nfile \"named.empty\";\nallow-update { none; };\n};\n\n\nIPv4, IPv6\u306e\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u7528\u306e\u6b63\u5f15\u304d\u3001\u9006\u5f15\u304d\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb(\u540d\u524d\u89e3\u6c7a\u306e\u305f\u3081\u306e\u60c5\u5831)\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306e\u4f8b\u3067\u306f\u6b63\u5f15\u304d1\u7a2e\u985e\u3002\n\u9006\u5f15\u304d3\u7a2e\u985e\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u6b63\u5f15\u304d\u7528\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u3044\u3066\n/var/named/chroot/var/named/\u306e\u76f4\u4e0b\u306b\nmylabo.local.lan\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n/var/named/chroot/var/named/mylabo.local.lan\n$TTL 3600\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n                 IN      NS     mng-server.mylabo.local.\ntorapc           IN      A      192.168.11.3\nstorage          IN      A      192.168.14.253\nESXi-Primary     IN      A      192.168.15.50\nESXi-Secondary   IN      A      192.168.15.51\nvCenter          IN      A      192.168.15.252\nmng-server       IN      A      192.168.15.253\n\n\n\u5404\u7a2e\u8981\u7d20\u3092\u4e0b\u3067\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\nmylabo.local.lan\u629c\u7c8b\n$TTL 3600\n\n\n3600\u79d2\u9593(1\u6642\u9593)\u3053\u306e\u30be\u30fc\u30f3\u306e\u5185\u5bb9\u304c\u3001\u4ed6\u306eDNS\u30b5\u30fc\u30d0\u30fc\u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u3055\u308c\u308b\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3092\u9577\u304f\u3057\u3059\u304e\u308b\u3068\u3001\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3057\u3066\u3082\u3001\u306a\u304b\u306a\u304b\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u3078\u60c5\u5831\u304c\u6d78\u900f\u3057\u306a\u3044\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u5373\u53cd\u6620\u3055\u305b\u308b\u306b\u306f\u3001\u307b\u304b\u306eDNS\u30b5\u30fc\u30d0\u30fc\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u5168\u3066\u30af\u30ea\u30a2\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\n\u73fe\u5b9f\u7684\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3068\u3044\u3046\u304b\u30e0\u30ea\u3067\u3059\u3002\u306a\u306e\u3067\u305d\u3053\u305d\u3053\u306e\u6642\u9593\u306b\u3059\u308b\u306e\u304c\u826f\u3044\u306e\u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\n\u3000\n\nmylabo.local.lan\u629c\u7c8b\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n\nSOA(Start Of Authority)\u30ec\u30b3\u30fc\u30c9\u306e\u5b9a\u7fa9\u3067\u3059\u3002\nSOA\u30ec\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u8aac\u660e\u3059\u308b\u3068\u3001\u300c\u79c1\u306f\u3053\u306e\u30c9\u30e1\u30a4\u30f3\u306e\u60c5\u5831\u3092\u7ba1\u7406\u3057\u307e\u3059\u300d\u3068\u3044\u3046\u5ba3\u8a00\u3067\u3059\u3002\n\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u3001\u300cmylabo.local\u300d\u30c9\u30e1\u30a4\u30f3\u3092\u7ba1\u7406\u3057\u3066\u3044\u308bDNS\u30b5\u30fc\u30d0\u30fc\u306f\u3001\n\u300cmng-server.mylabo.local.\u300d\u3068\u3044\u3046\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\uff08\u30c9\u30e1\u30a4\u30f3\u306e\u6b63\u78ba\u306a\u5b9a\u7fa9\u306b\u3064\u3044\u3066\u306f\u7121\u8996\u3057\u307e\u3059\uff09\n\u305d\u308c\u3067\u306f1\u3064\u305a\u3064\u89e3\u8aac\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n@\n\u81ea\u5206\u81ea\u8eab\u306e\u30be\u30fc\u30f3\u540d\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\u76f4\u63a5 mng-server.mylabo.local.\u3068\u66f8\u3044\u3066\u3082\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\nIN\n\u6c7a\u307e\u308a\u6587\u53e5\u3067\u3059\u3002InterNet\u304b\u3089\u53d6\u3089\u308c\u3066\u3044\u308b\u3068\u304b\u3001INternet \u304b\u3089\u53d6\u3089\u308c\u3066\u3044\u308b\u3068\u304b\u8a00\u308f\u308c\u3066\u3044\u307e\u3059\u3002\uff08\u3069\u3063\u3061\u3067\u3082\u3044\u3044\uff09\nSOA\n\u30ec\u30b3\u30fc\u30c9\u306e\u7a2e\u985e\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002IN SOA\u3068\u304b\u3001IN NS\u3068\u304b\u3001INT A \u3068\u304b\u6307\u5b9a\u304c\u53ef\u80fd\u3067\u3059\u3002\nmng-server.mylabo.local.\nMNAME\u3067\u3059\u3002\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306e\u57fa\u3068\u306a\u308b\u30c7\u30fc\u30bf\u3092\u6301\u3064\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306e\u540d\u524d\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u57fa\u672c\u7684\u306b\u81ea\u5206\u81ea\u8eab\u306b\u306a\u308a\u307e\u3059\u3002\nroot.mylabo.local. \nRNAME\u3067\u3059\u3002\u3053\u306e\u30be\u30fc\u30f3\u3092\u7ba1\u7406\u3059\u308b\u7ba1\u7406\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e@\u3092.\u306b\u5909\u63db\u3059\u308b\u3089\u3057\u3044\u306e\u3067\u3001\nroot@mylabo.local. \u3068\u3044\u3046\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u306a\u308a\u307e\u3059\u3002\n(\u3000)\u3067\u304f\u304f\u3089\u308c\u305f\u5404\u7a2e\u8a2d\u5b9a\u5024\nDNS\u30bb\u30ab\u30f3\u30c0\u30ea\u30b5\u30fc\u30d0\u30fc\u3068\u9023\u643a\u3059\u308b\u969b\u306e\u5404\u7a2e\u8a2d\u5b9a\u5024\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\nserial\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8868\u3059\u6570\u5b57\u3067\u3059\u3002\n\u5e74\u6708\u65e52\u6841\u306e\u6607\u9806\u306e\u6570\u5b57 \u3092\u66f8\u304f\u5834\u5408\u304c\u591a\u3044\u3067\u3059\u3002\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u304c\u5927\u304d\u3044\u3068\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3068\u8a8d\u8b58\u3055\u308c\u308b\u306e\u3067\u3001\n\u30bb\u30ab\u30f3\u30c0\u30ea\u30b5\u30fc\u30d0\u30fc\u306f\u30d7\u30e9\u30a4\u30de\u30ea\u30b5\u30fc\u30d0\u30fc\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u898b\u306b\u884c\u304d\u3001\n\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u5927\u304d\u3051\u308c\u3070\u30be\u30fc\u30f3\u8ee2\u9001\u3092\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u5e74\u6708\u65e5\u3067\u66f8\u304f\u3068\u3001\u7ba1\u7406\u3057\u3084\u3059\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\nrefresh\n\u30be\u30fc\u30f3\u306e\u60c5\u5831\u3092\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u3059\u308b\u307e\u3067\u306e\u6642\u9593\u3067\u3059\u3002\nDNS\u30bb\u30ab\u30f3\u30c0\u30ea\u30b5\u30fc\u30d0\u306f\u30be\u30fc\u30f3\u8ee2\u9001\u3092\u3057\u305f\u5f8c\u3001\u3053\u306e\u6642\u9593\u7d4c\u904e\u5f8c\u3001\n\u30be\u30fc\u30f3\u306e\u66f4\u65b0\u304c\u3055\u308c\u305f\u304b\u3092\u554f\u3044\u5408\u308f\u305b\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u518d\u5ea6\u30c7\u30fc\u30bf\u3092\u624b\u306b\u5165\u308c\u3088\u3046\u3068\u3057\u307e\u3059\n\u3053\u306e\u6642\u306b\u3001\u4e0a\u306eserial\u3092\u4f7f\u7528\u3057\u3066\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6bd4\u8f03\u3057\u307e\u3059\u3002\nretry\nrefresh\u3067\u30be\u30fc\u30f3\u60c5\u5831\u306e\u66f4\u65b0\u304c\u3067\u304d\u306a\u304b\u3063\u305f\u5834\u5408\u306b\u3001\nretry\u3067\u6307\u5b9a\u3055\u308c\u305f\u6642\u9593\u5f8c\u306b\u518d\u5ea6\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u3092\u8a66\u307f\u307e\u3059\u3002\nexpire\n\u4f55\u3089\u304b\u306e\u7406\u7531\u3067\u30be\u30fc\u30f3\u60c5\u5831\u306e\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u304c\u3067\u304d\u306a\u3044\u72b6\u614b\u304c\u7d9a\u3044\u305f\u5834\u5408\u3001\n\u30bb\u30ab\u30f3\u30c0\u30ea\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u304c\u6301\u3063\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092\u3069\u308c\u3060\u3051\u306e\u6642\u9593\u5229\u7528\u3057\u3066\u3082\u3088\u3044\u304b\u3092\u793a\u3057\u307e\u3059\u3002\nmin\uff08Negative cache TTL\uff09\n\u30cd\u30ac\u30c6\u30a3\u30d6\u30ad\u30e3\u30c3\u30b7\u30e5\u3068\u306f\u3001\u5b58\u5728\u3057\u306a\u3044\u30c9\u30e1\u30a4\u30f3\u540d\u3067\u3042\u308b\u3068\u3044\u3046\u60c5\u5831\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u610f\u5473\u3057\u307e\u3059\n\uff08\u30cd\u30ac\u30c6\u30a3\u30d6\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u7dad\u6301\u3059\u308b\u6642\u9593\uff09\n\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u554f\u3044\u5408\u308f\u305b\u306e\u90fd\u5ea6\u78ba\u8a8d\u3059\u308b\u3068\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3057\u3001\u4e0a\u4f4dDNS\u30b5\u30fc\u30d0\u30fc\u3078\u306e\u8ca0\u8377\u3082\u304b\u304b\u308b\u306e\u3067\u3001\n\u30ad\u30e3\u30c3\u30b7\u30e5\u3068\u3057\u3066\u4fdd\u6301\u3057\u307e\u3059\u3002\n\u3000\n\u3000\n\nmylabo.local.lan\u629c\u7c8b\n                 IN      NS     mng-server.mylabo.local.\n\n\nNS\u30ec\u30b3\u30fc\u30c9\u3067\u3059\u3002\u6c7a\u307e\u308a\u6587\u53e5\u306a\u306e\u3067\u3001\u81ea\u5206\u81ea\u8eab\u306e\u60c5\u5831\u3092\u66f8\u304d\u307e\u3057\u3087\u3046\n\u3000\n\nmylabo.local.lan\u629c\u7c8b\ntorapc           IN      A      192.168.11.3\nshare-storage    IN      A      192.168.14.253\nESXi-Primary     IN      A      192.168.15.50\nESXi-Secondary   IN      A      192.168.15.51\nvCenter          IN      A      192.168.15.252\nmng-server       IN      A      192.168.15.253\n\n\nA\u30ec\u30b3\u30fc\u30c9\u3067\u3059\u3002\u5404\u7a2e\u30db\u30b9\u30c8\u540d\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u9006\u5f15\u304d\u7528\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u3044\u3066\n3\u30bb\u30b0\u30e1\u30f3\u30c8\u5206\u306e\u9006\u5f15\u304d\u7528\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u57fa\u672c\u7684\u306b\u306f\u6b63\u5f15\u304d\u7528\u30d5\u30a1\u30a4\u30eb\u3068\u69cb\u6210\u306f\u540c\u3058\u3067\u3059\u3002\nA\u30ec\u30b3\u30fc\u30c9\u306e\u4ee3\u308f\u308a\u306bPTR\u30ec\u30b3\u30fc\u30c9\u3067\u3001\u9006\u5f15\u304d\u7528\u306e\u60c5\u5831\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n/var/named/chroot/var/named/11.168.192.in-addr.arpa.rev\n$TTL 3600\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n                 IN      NS     mng-server.mylabo.local.\n3                IN      PTR    torapc.mylabo.local.\n\n\n\n/var/named/chroot/var/named/14.168.192.in-addr.arpa.rev\n$TTL 3600\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n                 IN      NS     mng-server.mylabo.local.\n253              IN      PTR    share-storage.mylabo.local.\n\n\n\n/var/named/chroot/var/named/15.168.192.in-addr.arpa.rev\n$TTL 3600\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n                 IN      NS     mng-server.mylabo.local.\n50               IN      PTR    ESXi-Primary.mylabo.local.\n51               IN      PTR    ESXi-Secondary.mylabo.local.\n252              IN      PTR    vCenter.mylabo.local.\n253              IN      PTR    mng-server.mylabo.local.\n\n\n\n\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u306eDNS\u30dd\u30fc\u30c8\u89e3\u653e\nfirewalld\u3092\u4f7f\u7528\u3057\u3066DNS\u30dd\u30fc\u30c8(TCP:53 UDP:53)\u3092\u89e3\u653e\u3057\u307e\u3059\u3002\n\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\nhttp://qiita.com/shrkw/items/8410e9cb65eb789a40e1\nfirewalld\u3092\u6b62\u3081\u3066\u3044\u305f\u306e\u3067\u3001\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n[root@mng-server ~]# systemctl start firewalld\n[root@mng-server ~]#\n[root@mng-server ~]# systemctl enable firewalld\nln -s '/usr/lib/systemd/system/firewalld.service' '/etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service'\nln -s '/usr/lib/systemd/system/firewalld.service' '/etc/systemd/system/basic.target.wants/firewalld.service'\n[root@mng-server ~]# systemctl status firewalld\nfirewalld.service - firewalld - dynamic firewall daemon\n   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; enabled)\n   Active: active (running) since \u65e5 2015-12-20 13:47:27 JST; 12s ago\n Main PID: 2201 (firewalld)\n   CGroup: /system.slice/firewalld.service\n           \u2514\u25002201 /usr/bin/python -Es /usr/sbin/firewalld --nofork --nopid\n\n12\u6708 20 13:47:27 mng-server.mylabo.local systemd[1]: Started firewalld - dynamic firewall daemon.\n\n\n\u3000\n\u3000\nfirewalld\u3067\u73fe\u5728\u4f7f\u7528\u3057\u3066\u3044\u308b\u30be\u30fc\u30f3\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n[root@mng-server ~]# firewall-cmd --list-all\npublic (default, active)\n  interfaces: eno16777984\n  sources:\n  services: dhcpv6-client ssh\n  ports:\n  masquerade: no\n  forward-ports:\n  icmp-blocks:\n  rich rules:\n\n\u3000\neno16777984\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u304c\u3001\u30be\u30fc\u30f3public\u3067\u7a3c\u50cd\u3057\u3066\u3044\u307e\u3059\u3002\nservices\u306e\u9805\u76ee\u304c\u3001\u30dd\u30fc\u30c8\u89e3\u653e\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002\ndns\u304c\u7121\u3044\u306e\u3067\u8ffd\u52a0\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u524d\u306bdns\u30b5\u30fc\u30d3\u30b9\u306e\u5b9a\u7fa9\u5185\u5bb9\u3092\u5ff5\u306e\u305f\u3081\u78ba\u8a8d\u3057\u307e\u3059\u3002\n[root@mng-server ~]# cat /usr/lib/firewalld/services/dns.xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<service>\n  <short>DNS</short>\n  <description>The Domain Name System (DNS) is used to provide and request host and domain names. Enable this option, if you plan to provide a domain name service (e.g. with bind).</description>\n  <port protocol=\"tcp\" port=\"53\"/>\n  <port protocol=\"udp\" port=\"53\"/>\n</service>\n\ntcp 53, udp 53\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u3067\u306fpublic\u30be\u30fc\u30f3\u306bdns\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n[root@mng-server ~]# firewall-cmd --list-services --zone=public  --permanent\ndhcpv6-client ssh\n[root@mng-server ~]# firewall-cmd --add-service=dns --zone=public --permanent\nsuccess\n[root@mng-server ~]# firewall-cmd --list-services --zone=public  --permanent\ndhcpv6-client dns ssh\n\n\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n[root@mng-server ~]# firewall-cmd --reload\nsuccess\n\n\nBIND\u8d77\u52d5\n\u3053\u3053\u307e\u3067\u69cb\u7bc9\u3057\u305f\u3089\u3001\u3042\u3068\u306f\u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\u3067\u304d\u307e\u3059\u3002\n[root@mng-server named]# systemctl start named-chroot\n[root@mng-server named]# systemctl enable named-chroot \u2190 \u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\nln -s '/usr/lib/systemd/system/named-chroot.service' '/etc/systemd/system/multi-user.target.wants/named-chroot.service'\n\n\n\u540d\u524d\u89e3\u6c7a\u78ba\u8a8d\n\n\u6b63\u5f15\u304d\ndig\u30b3\u30de\u30f3\u30c9\u3067\u6b63\u5f15\u304d\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\ndig\u30b3\u30de\u30f3\u30c9\n[root@mng-server ~]# dig torapc.mylabo.local.\n\n; <<>> DiG 9.9.4-RedHat-9.9.4-18.el7_1.5 <<>> torapc.mylabo.local.\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 45901\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;torapc.mylabo.local.           IN      A\n\n;; ANSWER SECTION:\ntorapc.mylabo.local.    3600    IN      A       192.168.11.3\n\n;; AUTHORITY SECTION:\nmylabo.local.           3600    IN      NS      mng-server.mylabo.local.\n\n;; ADDITIONAL SECTION:\nmng-server.mylabo.local. 3600   IN      A       192.168.15.253\n\n;; Query time: 0 msec\n;; SERVER: 192.168.15.253#53(192.168.15.253)\n;; WHEN: \u6728 12\u6708 17 23:03:49 JST 2015\n;; MSG SIZE  rcvd: 105\n\n\n;; ANSWER SECTION:\u306e1\u884c\u4e0b\u306b\u540d\u524d\u89e3\u6c7a\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u9006\u5f15\u304d\n\u3053\u3061\u3089\u3082dig\u30b3\u30de\u30f3\u30c9 -x \u3067\u9006\u5f15\u304d\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\ndig\u30b3\u30de\u30f3\u30c9\n[root@mng-server named]# dig -x 192.168.11.3\n\n; <<>> DiG 9.9.4-RedHat-9.9.4-18.el7_1.5 <<>> -x 192.168.11.3\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 54774\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;3.11.168.192.in-addr.arpa.     IN      PTR\n\n;; ANSWER SECTION:\n3.11.168.192.in-addr.arpa. 3600 IN      PTR     torapc.mylabo.local.\n\n;; AUTHORITY SECTION:\n11.168.192.in-addr.arpa. 3600   IN      NS      mng-server.mylabo.local.\n\n;; ADDITIONAL SECTION:\nmng-server.mylabo.local. 3600   IN      A       192.168.15.253\n\n;; Query time: 0 msec\n;; SERVER: 192.168.15.253#53(192.168.15.253)\n;; WHEN: \u6728 12\u6708 17 23:18:13 JST 2015\n;; MSG SIZE  rcvd: 128\n\n\n#\u6982\u8981\nCentOS7.1\u3092\u4f7f\u7528\u3057\u3066\u3001\u5185\u90e8\u5411\u3051DNS\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\nDNS\u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066\u3001BIND 9.9.4\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u5404\u7a2e\u30b5\u30a4\u30c8\u3084\u69cb\u7bc9\u3092\u901a\u3058\u3066\u3001\u81ea\u5206\u306a\u308a\u306e\u7406\u89e3\u3057\u305f\u5185\u5bb9\u306a\u3069\u3092\u8a18\u8f09\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n\n\n\u4ee5\u4e0bURL\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\nhttp://centossrv.com/bind.shtml\nhttp://www.itmedia.co.jp/keywords/bind_tsukuru_dns_server.html\nhttp://www.atmarkit.co.jp/ait/articles/0309/09/news001.html\nhttp://www.atmarkit.co.jp/ait/articles/0310/15/news001.html\nhttp://qiita.com/shrkw/items/8410e9cb65eb789a40e1\n\n#DNS\u69cb\u7bc9\n##DNS\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\n\nCentOS7.1\u3067yum\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u305f\u3001BIND\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\u3092\u4e0b\u306b\u66f8\u304d\u307e\u3059\u3002\n\n![DNS\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210.png](https://qiita-image-store.s3.amazonaws.com/0/104247/01d62fe3-4b4b-b386-a419-04b85c774b25.png)\n\n\nchroot\u3068\u306f\nBIND\u306e\u30b5\u30fc\u30d3\u30b9\u300cnamed-chroot\u300d\u306b\u3088\u3063\u3066\u3001DNS\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306a\u7bc4\u56f2\u3092\u5236\u9650\u3057\u307e\u3059\u3002\n\u5185\u90e8\u7684\u306bchroot\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306f\u305a\u3067\u3059\uff08\u540d\u524d\u7684\u306b\uff09\nDNS\u3067\u306a\u305c\u5fc5\u8981\u304b\u3068\u3044\u3046\u3068\u3001DNS\u30b5\u30fc\u30d0\u30fc\u306f\u57fa\u672c\u7684\u306b\u4e16\u754c\u4e2d\u306b\u516c\u958b\u3059\u308b\u306e\u3067\u3001\u60aa\u3044\u4eba\u304b\u3089\u653b\u6483\u3092\u53d7\u3051\u308b\u6050\u308c\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001DNS\u95a2\u4fc2\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u53c2\u7167\u51fa\u6765\u308b\u7bc4\u56f2\u3092\u5236\u9650\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\n\u4e07\u304c\u4e00\u30e6\u30fc\u30b6\u30fc\u6a29\u9650\u3092\u596a\u308f\u308c\u3066\u3057\u307e\u3063\u3066\u3082\u3001\u5927\u4e8b\u306a\u30d5\u30a1\u30a4\u30eb\u306f\u53c2\u7167\u51fa\u6765\u306a\u304f\u3055\u305b\u307e\u3059\u3002\n\u4eca\u56de\u306eDNS\u8a2d\u5b9a\u3067\u306f /var/named/chroot/ \u304c DNS\u30d7\u30ed\u30bb\u30b9\u306b\u3068\u3063\u3066\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306a\u308a\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306fhttp://www.atmarkit.co.jp/ait/articles/0309/09/news001.html\n\n\n##\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nbind(DNS\u30b5\u30fc\u30d0\u30fc\u30d7\u30ed\u30b0\u30e9\u30e0)\u3068\u3001bind-chroot(BIND\u7528\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3055\u308c\u305fchroot\u30d7\u30ed\u30b0\u30e9\u30e0\uff1f)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n[root@mng-server ~]# yum -y install bind bind-chroot\n```\n\n\nbind-chroot\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u751f\u6210\u3055\u308c\u305f\u3001chroot\u5316\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n[root@mng-server ~]# /usr/libexec/setup-named-chroot.sh /var/named/chroot on\n```\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30d5\u30a1\u30a4\u30eb\u304c\u30de\u30a6\u30f3\u30c8\u3055\u308c\u307e\u3059\u3002\n\u30b9\u30af\u30ea\u30d7\u30c8\u3092off\u306b\u3059\u308b\u3068\u3001mount\u5148\u306e\u30d5\u30a1\u30a4\u30eb\u304c\u7dba\u9e97\u306b\u306a\u304f\u306a\u3063\u3066\u3001mount\u5143\u306b\u306e\u307f\u5b58\u5728\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001BIND\u8a2d\u5b9a\u5b8c\u4e86\u5f8c\u306b\u8d77\u52d5\u3059\u308b\u30b5\u30fc\u30d3\u30b9\u300cnamed-chroot\u300d\u306b\u3088\u3063\u3066\u3082\u3001\u30de\u30a6\u30f3\u30c8\u3055\u308c\u307e\u3059\u3002\n\u4eca\u307e\u3067\u89e6\u3063\u3066\u3044\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u6025\u306b\u6d88\u3048\u3066\u306a\u304f\u306a\u308b\u3088\u3046\u306b\u898b\u3048\u308b\u305f\u3081\u3001\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n| mount\u5143 | mount\u5148 |\n|:-----------|:------------|\n| /etc/named | /var/named/chroot/etc/named |\n| /etc/named.root.key     | /var/named/chroot/etc/named.root.key |\n| /etc/named.conf       | /var/named/chroot/etc/named.conf |\n| /etc/named.rfc1912.zone | /var/named/chroot/etc/named.rfc1912.zones |\n| /etc/rndc.key | /var/named/chroot/etc/rndc.key | \n| /etc/named.iscdlv.key | /var/named/chroot/etc/named.iscdlv.key | \n| /run/named | /var/named/chroot/run/named |\n| /var/named | /var/named/chroot/var/named | \n| /usr/lib64/bind | /var/named/chroot/usr/lib64/bind | \n\n\n##named.conf\u306e\u4f5c\u6210\n\n\u5404\u7a2e\u30b5\u30a4\u30c8\u3092\u8abf\u3079\u3066\u3001\u81ea\u5206\u306a\u308a\u306e\u7406\u89e3\u3057\u305f\u5185\u5bb9\u3092\u66f8\u304d\u307e\u3059\u3002\n\u9593\u9055\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u3082\u5341\u5206\u3042\u308b\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nBIND\u3092\u69cb\u7bc9\u3059\u308b\u4e0a\u3067\u306e\u3001\u5927\u5143\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304c\u3000named.conf \u3067\u3059\u3002\n\u4eca\u56de\u306e\u69cb\u6210\u3067\u306f\u3001/var/named/chroot/etc/named.conf \u304c\u683c\u7d0d\u5148\u306b\u306a\u308a\u307e\u3059\u3002\nchroot\u3067\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u5b9f\u4f53\u306f/etc/named.conf\u306b\u6709\u308a\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u30d5\u30a1\u30a4\u30eb\u5168\u4f53\u306e\u4e2d\u8eab\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\u74b0\u5883\u306b\u4f9d\u5b58\u3059\u308b\u5185\u5bb9\u3082\u3042\u308b\u306e\u3067\u3001\u9069\u5b9c\u4fee\u6b63\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```/var/named/chroot/etc/named.conf\n/* \u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u5b9a\u7fa9 */\nacl \"mylabo-network\" {\n        192.168.11.0/24;\n        192.168.12.0/24;\n        192.168.13.0/24;\n        192.168.14.0/24;\n        192.168.15.0/24;\n};\n\noptions {\n        #listen-on port 53 { 127.0.0.1; };\n        listen-on-v6 port 53 { ::1; } ; //IPv6\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\n        version         \"unknown\";\n        directory       \"/var/named\";\n        dump-file       \"/var/named/data/cache_dump.db\";\n        statistics-file \"/var/named/data/named_stats.txt\";\n        memstatistics-file \"/var/named/data/named_mem_stats.txt\";\n        allow-query     { localhost; mylabo-network; }; //\u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u304b\u3089\u306e\u554f\u3044\u5408\u308f\u305b\u306e\u307f\u8a31\u53ef\u3057\u307e\u3059\n\n        /*\n         - If you are building an AUTHORITATIVE DNS server, do NOT enable recursion.\n         - If you are building a RECURSIVE (caching) DNS server, you need to enable\n           recursion.\n         - If your recursive DNS server has a public IP address, you MUST enable access\n           control to limit queries to your legitimate users. Failing to do so will\n           cause your server to become part of large scale DNS amplification\n           attacks. Implementing BCP38 within your network would greatly\n           reduce such attack surface\n        */\n        recursion yes; // \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3059\u308b\u306e\u3067\u3001\u30d5\u30eb\u30b5\u30fc\u30d3\u30b9\u30ea\u30be\u30eb\u30d0(\u30ad\u30e3\u30c3\u30b7\u30e5\u30b5\u30fc\u30d0)\u3068\u3057\u3066\u3082\u52d5\u4f5c\u3055\u305b\u307e\u3059\n\n        /* DNSSEC\u306f\u7121\u52b9\u306b\u3057\u307e\u3059 */\n        dnssec-enable no;\n        dnssec-validation no;\n        //dnssec-lookaside auto;\n        managed-keys-directory \"/var/named/dynamic\";\n\n        /* Path to ISC DLV key */\n        bindkeys-file \"/etc/named.iscdlv.key\";\n\n        /* \u81ea\u5206\u81ea\u8eab\u3067\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u306a\u3044\u5834\u5408\u306f\u3001\u4e0a\u4f4d\u306eDNS\u30b5\u30fc\u30d0\u30fc(\u81ea\u5b85\u30eb\u30fc\u30bf\u30fc)\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u307e\u3059 */\n        forwarders {\n                192.168.11.1;\n        };\n        forward only;\n\n\n        pid-file \"/run/named/named.pid\";\n        session-keyfile \"/run/named/session.key\";\n};\n\nlogging {\n        channel default_debug {\n                file \"data/named.run\";\n                severity dynamic;\n        };\n        category lame-servers { null; }; //\u8ffd\u52a0(error (connection refused) resolving\u3068\u3044\u3046\u30a8\u30e9\u30fc\u30ed\u30b0\u306e\u51fa\u529b\u6291\u6b62)\n};\n\nview \"internal\" {\n        /* \u6700\u4e0a\u90e8\u3067\u5b9a\u7fa9\u3057\u305f\u30ed\u30fc\u30ab\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u3001\u5185\u90e8\u554f\u3044\u5408\u308f\u305b\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u307e\u3059 */\n        match-clients { localhost; mylabo-network; };\n        match-destinations { localhost; mylabo-network; };\n\n        zone \".\" IN {\n                type hint;\n                file \"named.ca\";\n        };\n\n        /* \u6b63\u5f15\u304d\u30be\u30fc\u30f3 */\n        zone \"mylabo.local\" IN {\n                type master;\n                file \"mylabo.local.lan\";\n        };\n\n        /* \u9006\u5f15\u304d\u30be\u30fc\u30f3 */\n        zone \"11.168.192.in-addr.arpa\" {\n                type master;\n                file \"11.168.192.in-addr.arpa.rev\";\n        };\n\n        zone \"14.168.192.in-addr.arpa\" {\n                type master;\n                file \"14.168.192.in-addr.arpa.rev\";\n        };\n\n        zone \"15.168.192.in-addr.arpa\" {\n                type master;\n                file \"15.168.192.in-addr.arpa.rev\";\n        };\n\n        include \"/etc/named.rfc1912.zones\"; //localhost\u306a\u3069\u306e\u5b9a\u7fa9\n        include \"/etc/named.root.key\";\n};\n\n/* \u5185\u90e8\u3080\u3051DNS\u306a\u306e\u3067\u3001\u5916\u90e8\u5411\u3051\u306eView\u306f\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\nview \"external\" {\n        match-clients { any; };\n        match-destinations { any; };\n        recursion no;\n};\n */\n```\n\n###named.conf\u306e\u69cb\u6210\u306b\u3064\u3044\u3066\nnamed.conf\u306f\u5927\u304d\u304f\u5206\u3051\u3066\u3001\u2193\u306e4\u7a2e\u985e\u306e\u30ab\u30c6\u30b4\u30ea\u306b\u5206\u304b\u308c\u307e\u3059\u3002\n\n```\nacl \"\u4efb\u610f\u306eacl\u540d\u79f0\" {\n        \u7701\u7565\n};\n\noptions {\n        \u7701\u7565\n};\n\nlogging {\n        \u7701\u7565\n};\n\nview \"\u4efb\u610f\u306eview\u540d\u79f0\" {\n        \u7701\u7565\n};\n```\n\n\u4e00\u3064\u305a\u3064\u7c21\u5358\u306b\u89e3\u8aac\u3057\u307e\u3059\u3002\n####1\u30ab\u30c6\u30b4\u30ea\u76ee\uff1aacl(access control list)\nnamed.conf\u3092\u7de8\u96c6\u3057\u3066\u3044\u304f\u4e0a\u3067\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c9\u30ec\u30b9\u306a\u3069\u3092\u6307\u5b9a\u3057\u3066\u3001\n\u30a2\u30af\u30bb\u30b9\u53ef\u5426\u306a\u3069\u3092\u8a2d\u5b9a\u3059\u308b\u7b87\u6240\u304c\u3042\u308a\u307e\u3059\u3002\n\u4f8b\u3048\u30705\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u6307\u5b9a\u3057\u305f\u3044\u6642\u306f\u30015\u30bb\u30b0\u30e1\u30f3\u30c8\u5206\u66f8\u3044\u3066\u3082\u52d5\u4f5c\u3057\u307e\u3059\u304c\u3001\n\u3044\u3061\u3044\u3061\u66f8\u304f\u306e\u304c\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067\u3001\u540d\u524d\u3092\u4ed8\u3051\u308b\u4e8b\u304c\u51fa\u6765\u307e\u3059\u3002\n\n\u4eca\u56de\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u306fmylabo-network\u3092\u5b9a\u7fa9\u3057\u307e\u3057\u305f\u3002\n\n```named.conf\u306eacl\u629c\u7c8b\n/* \u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u5b9a\u7fa9 */\nacl \"mylabo-network\" {\n        192.168.11.0/24;\n        192.168.12.0/24;\n        192.168.13.0/24;\n        192.168.14.0/24;\n        192.168.15.0/24;\n};\n```\n\n\u2191\u306e\u5b9a\u7fa9\u3092\u3059\u308b\u3068\u3001\u2193\u306e\u3088\u3046\u306b\u3001\u4ed6\u306e\u8a2d\u5b9a\u9805\u76ee\u3067\u4f7f\u7528\u3067\u304d\u308b\u540d\u524d\u3068\u306a\u308a\u307e\u3059\u3002\n\n```\nallow-query     { localhost; mylabo-network; }; //\u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u304b\u3089\u306e\u554f\u3044\u5408\u308f\u305b\u306e\u307f\u8a31\u53ef\u3057\u307e\u3059\n```\n\u3000\n\n####2\u30ab\u30c6\u30b4\u30ea\u76ee\uff1aoptions\nBIND\u306e\u8272\u3005\u306a\u52d5\u4f5c\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u5927\u4e8b\u306a\u30dd\u30a4\u30f3\u30c8\u3084\u30c7\u30d5\u30a9\u30eb\u30c8\u304b\u3089\u5909\u66f4\u3057\u305f\u3068\u3053\u308d\u3092\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3000\n\n```named.conf\u306eoption\u629c\u7c8b\n#listen-on port 53 { 127.0.0.1; };\nlisten-on-v6 port 53 { ::1; } ; //IPv6\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\n```\n\nBIND\u304c\u540d\u524d\u89e3\u6c7a\u3092\u53d7\u3051\u4ed8\u3051\u308bNIC\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u300clisten-on port 53 { 127.0.0.1; };\u300d\u306e\u8a2d\u5b9a\u5024\u306a\u3089\u3001\u300c127.0.0.1\u300d\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3078\u306e\n\u30a2\u30af\u30bb\u30b9\u306e\u307f\u53d7\u3051\u4ed8\u3051\u308b\u5f62\u306b\u306a\u308b\u306e\u3067\u3001\u81ea\u5206\u81ea\u8eab\u3057\u304b\u540d\u524d\u89e3\u6c7a\u3092\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u306a\u3044\u69cb\u6210\u306b\u306a\u308a\u307e\u3059\u3002\n\u305d\u308c\u3067\u306f\u56f0\u308b\u306e\u3067\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\u300clisten-on-v6 port 53 { ::1; } ;\u300d\u306fIPv6\u306a\u306e\u3067\u3001\u4eca\u56de\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002\n\u3053\u306e\u307e\u307e\u81ea\u5206\u81ea\u8eab\u306e\u307f\u53d7\u3051\u4ed8\u3051\u308b\u8a2d\u5b9a\u306b\u3057\u307e\u3059\u3002\n\u3000\n\u3000\n\n```named.conf\u306eoption\u629c\u7c8b\nversion         \"unknown\";\n```\n\nBIND\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8a18\u8f09\u3057\u3066\u3044\u308b\u7b87\u6240\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u306b\u6b63\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u66f8\u304f\u3068\n\u5916\u90e8\u304b\u3089\u306eBIND\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u51fa\u6765\u3066\u3057\u307e\u3046\u306e\u3067\u3001\n\u8106\u5f31\u6027\u3092\u653b\u6483\u3055\u308c\u3084\u3059\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001unknown\u306b\u3057\u3066\u96a0\u3057\u307e\u3059\u3002\n\u3000\n\u3000\n\n```named.conf\u306eoption\u629c\u7c8b\ndirectory       \"/var/named\";\n```\n\nnamed.conf\u304c4\u30ab\u30c6\u30b4\u30ea\u306b\u5206\u3051\u3089\u308c\u308b\u3046\u3061\u306e\u30013\u30ab\u30c6\u30b4\u30ea\u76ee(logging)\u30014\u30ab\u30c6\u30b4\u30ea\u76ee(view)\u3067\n\u5404\u7a2e\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u53c2\u7167\u3092\u6307\u5b9a\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u3089\u306e\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u3053\u3053\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306e\u69cb\u6210\u3067\u306fchroot\u69cb\u6210\u306a\u306e\u3067\u3001\u7d76\u5bfe\u30d1\u30b9\u306f\u300c/var/named/chroot/var/named\u300d\u3067\u3059\u3002\n\u6df7\u4e71\u3057\u3084\u3059\u3044\u3068\u3053\u308d\u306a\u306e\u3067\u6ce8\u610f\u3057\u307e\u3057\u3087\u3046\u3002\n\u3000\n\u3000\n\n```named.conf\u306eoption\u629c\u7c8b\nallow-query     { localhost; mylabo-network; }; //\u5185\u90e8\u30bb\u30b0\u30e1\u30f3\u30c8\u304b\u3089\u306e\u554f\u3044\u5408\u308f\u305b\u306e\u307f\u8a31\u53ef\u3057\u307e\u3059\n```\n\n\u540d\u524d\u89e3\u6c7a\u3092\u53d7\u3051\u4ed8\u3051\u308b\u3001DNS\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nmylabo-network \u306f1\u30ab\u30c6\u30b4\u30ea\u76ee(acl)\u3067\u5b9a\u7fa9\u3057\u307e\u3057\u305f\u3002\n\u3000\n\u3000\n\n```named.conf\u306eoption\u629c\u7c8b\nrecursion yes; // \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3059\u308b\u306e\u3067\u3001\u30d5\u30eb\u30b5\u30fc\u30d3\u30b9\u30ea\u30be\u30eb\u30d0(\u30ad\u30e3\u30c3\u30b7\u30e5\u30b5\u30fc\u30d0)\u3068\u3057\u3066\u3082\u52d5\u4f5c\u3055\u305b\u307e\u3059\n```\n\nyes\u306b\u3059\u308b\u3068\u3001\u81ea\u5206\u81ea\u8eab\u3067\u89e3\u6c7a\u51fa\u6765\u306a\u3044\u554f\u3044\u5408\u308f\u305b\u306b\u5bfe\u3057\u3066\u3001\u307b\u304b\u306eDNS\u30b5\u30fc\u30d0\u305f\u3061\u3092\u4f7f\u7528\u3057\u3066\u518d\u5e30\u554f\u3044\u5408\u308f\u305b\u3092\u3057\u307e\u3059\u3002\nno\u3067\u306f\u3057\u307e\u305b\u3093\u3002\n\u3000\n\u3000\n\n```named.conf\u306eoption\u629c\u7c8b\n/* DNSSEC\u306f\u7121\u52b9\u306b\u3057\u307e\u3059 */\ndnssec-enable no;\ndnssec-validation no;\n//dnssec-lookaside auto;\nmanaged-keys-directory \"/var/named/dynamic\";\n```\n\nDNSSEC\u3068\u3044\u3046\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u6a5f\u80fd\u306e\u4ed5\u69d8\u6709\u7121\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u516c\u958b\u9375\u6697\u53f7\u65b9\u5f0f\u3092\u4f7f\u7528\u3057\u3066\u30bb\u30ad\u30e5\u30a3\u30c6\u30a3\u5411\u4e0a\u3092\u56f3\u308b\u3088\u3046\u3067\u3059\u3002\n\u4eca\u56de\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002\n\u3000\n\u3000\n\n```named.conf\u306eoption\u629c\u7c8b\n/* \u81ea\u5206\u81ea\u8eab\u3067\u540d\u524d\u89e3\u6c7a\u51fa\u6765\u306a\u3044\u5834\u5408\u306f\u3001\u4e0a\u4f4d\u306eDNS\u30b5\u30fc\u30d0\u30fc(\u81ea\u5b85\u30eb\u30fc\u30bf\u30fc)\u306b\u30d5\u30a9\u30ef\u30fc\u30c9\u3057\u307e\u3059 */\nforwarders {\n        192.168.11.1;\n};\nforward only;\n```\n\u30b3\u30e1\u30f3\u30c8\u306b\u3082\u66f8\u3044\u3066\u307e\u3059\u304c\u3001\u4ed6\u306eDNS\u3078\u30d5\u30a9\u30ef\u30fc\u30c9\u3059\u308b\u969b\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u300cforward only;\u300d\u306e\u7b87\u6240\u304c\u3088\u304f\u308f\u304b\u3063\u3066\u306a\u3044\u306e\u3067\u3001\u8a73\u3057\u3044\u65b9\u3001\u662f\u975e\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\nforward \u306b\u306f\u4e8c\u7a2e\u985e\u306e\u6307\u5b9a\u304c\u3042\u308a\u3001 only \u304b first \u3067\u3059\u3002\n\n\u4ee5\u4e0b\u8aac\u660e\u5f15\u7528\n\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3001forwarders \u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u3068\u304d\u306e\u307f\u6709\u52b9\u306b\u306a\u308b\u3002 \nfirst \u3092\u6307\u5b9a\u3059\u308b\u3068\u3001\u6700\u521d\u306b\uff08\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u4e2d\u306b\u7b54\u3048\u304c\u898b\u3064\u304b\u3089\u306a\u3051\u308c\u3070\uff09 forwarders \u3067\u6307\u5b9a\u3057\u305f\n\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u3001\u3082\u3057\u7b54\u3048\u304c\u5f97\u3089\u308c\u306a\u3051\u308c\u3070\u6b21\u306b\u81ea\u5206\u81ea\u8eab\u3067\u7b54\u3048\u3092\u898b\u3064\u3051\u3088\u3046\u3068\u3059\u308b\u3002 \nonly \u3092\u6307\u5b9a\u3059\u308b\u3068\u3001\u5358\u7d14\u306b forwarders \u3067\u6307\u5b9a\u3057\u305f\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u308b\u3002 \n\u30c7\u30d5\u30a9\u30eb\u30c8\u306f first\u3002\nLAN \u5185\u306e\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306e\u3088\u3046\u306a\u3001\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u76f4\u63a5\u554f\u3044\u5408\u308f\u305b\u3092\u3055\u305b\u305f\u304f\u306a\u3044\u30b5\u30fc\u30d0\u3067\u4f7f\u7528\u3055\u308c\u308b\u3002\n\u5f15\u7528\u7d42\u4e86\n\nonly\u306b\u3059\u308b\u3068\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u4e0a\u306b\u3042\u308b\u30b5\u30fc\u30d0\u30fc\u306e\u540d\u524d\u89e3\u6c7a(google.co.jp)\u304c\u51fa\u6765\u305f\u306e\u3067\u3059\u304c\u3001\nfirst\u3067\u306f\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u4e0a\u8a18\u306e\u8aac\u660e\u3067\u306f\u3001first\u3067\u3082\u5916\u90e8\u3078\u540d\u524d\u89e3\u6c7a\u3057\u3066\u304f\u308c\u305d\u3046\u306a\u5185\u5bb9\u3067\u3059\u304c\u3001\u3057\u3066\u304f\u308c\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u8b0e\u3067\u3059\u3002\n\n\n####3\u30ab\u30c6\u30b4\u30ea\u76ee\uff1alogging\n\nDNS\u306e\u5404\u7a2e\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u51fa\u529b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```named.conf\u306elogging\u629c\u7c8b\nchannel default_debug {\n        file \"data/named.run\";\n        severity dynamic;\n};\ncategory lame-servers { null; }; //\u8ffd\u52a0(error (connection refused) resolving\u3068\u3044\u3046\u30a8\u30e9\u30fc\u30ed\u30b0\u306e\u51fa\u529b\u6291\u6b62)\n```\n\n\u4e0a\u8a18\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ed\u30b0\u51fa\u529b\u306b\u3001\u300ccategory lame-servers { null; };\u300d\u3092\u52a0\u3048\u307e\u3057\u305f\u3002\n\n\n\n\u307e\u305f\u3001BIND\u306e\u540d\u524d\u89e3\u6c7a\u3092\u3059\u308b\u969b\u306e\u30c7\u30d0\u30c3\u30b0\u51fa\u529b\u306e\u4f8b\u3092\u4ee5\u4e0b\u306b\u66f8\u304d\u307e\u3059\u3002\n\n```\nlogging {\n        channel \"default_debug\" {\n                file \"data/named.run\";\n                severity debug;\n                print-time yes;\n                print-severity yes;\n                print-category yes;\n        };\n        \n        category queries { \"default_debug\"; };\n        category resolver { \"default_debug\"; };\n        \n        category lame-servers { null; }; //\u8ffd\u52a0(error (connection refused) resolving\u3068\u3044\u3046\u30a8\u30e9\u30fc\u30ed\u30b0\u306e\u51fa\u529b\u6291\u6b62)\n```   \n\nchannel \"default_debug\"\u306eseverity \u3092debug\u306b\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30ed\u30b0\u51fa\u529b\u306e\u30ec\u30d9\u30eb\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u4e0b\u8a183\u7a2e\u985e\u306eyes\u306e\u6307\u5b9a\u306f\u3001\u30ed\u30b0\u5185\u306b\u6642\u9593\u3084\u30ed\u30b0\u306e\u5185\u5bb9\u30fb\u30ed\u30b0\u30ec\u30d9\u30eb(debug\u3068\u304binfo\u3068\u304b)\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\n\u3053\u308c\u3089\u51fa\u529b\u3055\u308c\u306a\u3044\u3068\u308f\u304b\u308a\u306b\u304f\u3044\u306e\u3067\u3001yes\u304c\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\nprint-time yes;\nprint-severity yes;\nprint-category yes;\n\n\u30ed\u30b0\u51fa\u529b\u306e\u4f8b\n\n```\n18-Dec-2015 23:49:38.702 queries: info: client 127.0.0.1#54599 (torapc.mylabo.local): view internal: query: torapc.mylabo.local IN A + (127.0.0.1)\n18-Dec-2015 23:49:38.703 queries: info: client 127.0.0.1#57318 (3.11.168.192.in-addr.arpa): view internal: query: 3.11.168.192.in-addr.arpa IN PTR + (127.0.0.1)\n18-Dec-2015 23:49:39.705 queries: info: client 127.0.0.1#34290 (3.11.168.192.in-addr.arpa): view internal: query: 3.11.168.192.in-addr.arpa IN PTR + (127.0.0.1)\n18-Dec-2015 23:49:45.654 queries: info: client 127.0.0.1#38613 (google.co.jp): view internal: query: google.co.jp IN A + (127.0.0.1)\n18-Dec-2015 23:49:45.654 resolver: debug 1: createfetch: google.co.jp A\n18-Dec-2015 23:49:45.669 queries: info: client 127.0.0.1#33558 (207.126.194.173.in-addr.arpa): view internal: query: 207.126.194.173.in-addr.arpa IN PTR + (127.0.0.1)\n18-Dec-2015 23:49:45.669 resolver: debug 1: createfetch: 207.126.194.173.in-addr.arpa PTR\n18-Dec-2015 23:49:46.669 queries: info: client 127.0.0.1#51301 (207.126.194.173.in-addr.arpa): view internal: query: 207.126.194.173.in-addr.arpa IN PTR + (127.0.0.1)\n```\n\n\u2193\u306e\u30da\u30fc\u30b8\u306blogging\u306e\u8a73\u7d30\u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\nhttp://www.atmarkit.co.jp/ait/articles/0310/15/news001.html\n\n\n####4\u30ab\u30c6\u30b4\u30ea\u76ee\uff1aview\n\nview\u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9\u306f\u3001\u5185\u90e8\u5411\u3051\u306e\u540d\u524d\u89e3\u6c7a\u306e\u51e6\u7406\u65b9\u6cd5\u3068\u3001\u5916\u90e8\u5411\u3051\u306e\u51e6\u7406\u65b9\u6cd5\u3092\u5206\u3051\u3066\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\nview \"internal\" \u3067\u5185\u90e8\u5411\u3051\u306e\u8a2d\u5b9a\u3001view \"external\"\u3067\u5916\u90e8\u5411\u3051\u306e\u8a2d\u5b9a\u3092\u52a0\u3048\u308b\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u3002\nview\u306e\u540d\u524d\u306f\u4efb\u610f\u306e\u540d\u524d\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n```named.conf\u306eview\u629c\u7c8b\n/* \u6700\u4e0a\u90e8\u3067\u5b9a\u7fa9\u3057\u305f\u30ed\u30fc\u30ab\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u3001\u5185\u90e8\u554f\u3044\u5408\u308f\u305b\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u307e\u3059 */\nmatch-clients { localhost; mylabo-network; };\nmatch-destinations { localhost; mylabo-network; };\n```\n\nview\u3067\u51e6\u7406\u3059\u308b\u305f\u3081\u306e\u6761\u4ef6\u3092\u3053\u3053\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\nmatch-clients\u3067\u306f\u3001\u540d\u524d\u89e3\u6c7a\u306e\u8981\u6c42\u5143\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u81ea\u5206\u81ea\u8eab\u3068\u3001\u5185\u90e8\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092view \"internal\"\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\nmatch-destinations\u306e\u6307\u5b9a\u306f\u3001BIND\u30b5\u30fc\u30d0\u30fc\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u3001192.168.15.1\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u7528\u306eview\u3092\u5b9a\u7fa9\u3001\n192.168.16.1\u7528\u306eview\u3092\u5b9a\u7fa9\u3001\u3068\u3044\u3063\u305f\u3088\u3046\u306b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3054\u3068\u306b\u51e6\u7406\u65b9\u6cd5\u3092\u5206\u3051\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u4eca\u56de\u306f\u7279\u306b\u5206\u5272\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u306e\u3067\u3001\u300clocalhost; mylabo-network;\u300d\u3068\u3057\u3066\u307e\u3059\u304c\u3001\n\u3053\u308c\u306f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c9\u30ec\u30b9\u3067\u306e\u6307\u5b9a\u3067\u3059\u306e\u3067\u3001\u6b63\u78ba\u306a\u6307\u5b9a\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u306d(\u00b4-`)\n\u3000\n\n```named.conf\u306eview\u629c\u7c8b\nzone \".\" IN {\n        type hint;\n        file \"named.ca\";\n};\n```\n\nDNS\u306e\u30eb\u30fc\u30c8\u30c9\u30e1\u30a4\u30f3\u306e\u6307\u5b9a\u3067\u3059\u3002\n\u3053\u306e\u6307\u5b9a\u306f\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u3067\u3082\u540c\u4e00\u306e\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\ntype \u3067hint\u3068\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u30eb\u30fc\u30c8\u30c9\u30e1\u30a4\u30f3\u7528\u306e\u5b9a\u7fa9\u306b\u306a\u308a\u307e\u3059\u3002\nfile \u3067\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u304c\u3001\u4ed6\u306e\u30d5\u30a1\u30a4\u30eb\u3078\u306e\u53c2\u7167\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\noption\u30ab\u30c6\u30b4\u30ea\u306edirectory\u3067\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\n\u300c/var/named/chroot/var/named/named.ca\u300d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3001\u3068\u3044\u3046\u610f\u5473\u306b\u306a\u308a\u307e\u3059\u3002\nchroot\u74b0\u5883\u306a\u306e\u3067\u3001\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\nnamed.ca\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6642\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u751f\u6210\u3055\u308c\u307e\u3059\u3002\n\u3000\n\n```named.conf\u306eview\u629c\u7c8b\n/* \u6b63\u5f15\u304d\u30be\u30fc\u30f3 */\nzone \"mylabo.local\" IN {\n        type master;\n        file \"mylabo.local.lan\";\n};\n```\n\n\u6b63\u5f15\u304d\u7528\u306e\u30be\u30fc\u30f3\u306e\u6307\u5b9a\u3067\u3059\u3002\nzone \u3067DNS\u306e\u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u3092\u5b9a\u7fa9\u3067\u304d\u307e\u3059\u3002\ntype \u3067master\u3068\u6307\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001DNS\u30d7\u30e9\u30a4\u30de\u30ea\u30b5\u30fc\u30d0\u30fc\u3067\u3042\u308b\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\nslave \u3068\u6307\u5b9a\u3059\u308b\u3068\u3001\u30bb\u30ab\u30f3\u30c0\u30ea\u30b5\u30fc\u30d0\u30fc\u3068\u306a\u308a\u307e\u3059\u3002\nfile\u3067\u6b63\u5f15\u304d\u7528\u306e\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u300c/var/named/chroot/var/named/mylabo.local.lan\u300d\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\u3000\n\n```named.conf\u306eview\u629c\u7c8b\n/* \u9006\u5f15\u304d\u30be\u30fc\u30f3 */\nzone \"11.168.192.in-addr.arpa\" {\n        type master;\n        file \"11.168.192.in-addr.arpa.rev\";\n};\n\nzone \"14.168.192.in-addr.arpa\" {\n        type master;\n        file \"14.168.192.in-addr.arpa.rev\";\n};\n\nzone \"15.168.192.in-addr.arpa\" {\n        type master;\n        file \"15.168.192.in-addr.arpa.rev\";\n};\n```\n\n\u9006\u5f15\u304d\u7528\u306e\u30be\u30fc\u30f3\u306e\u6307\u5b9a\u3067\u3059\u3002\nzone\u306e\u6307\u5b9a\u65b9\u6cd5\u304c\u7279\u6b8a\u3067\u3059\u304c\u3001\u305d\u308c\u4ee5\u5916\u306f\u6b63\u5f15\u304d\u7528\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u3002\n\u4eca\u56de\u9006\u5f15\u304d\u3057\u305f\u3044\u306e\u306f3\u30bb\u30b0\u30e1\u30f3\u30c8\u3042\u308b\u306e\u3067\u30013\u3064\u306e\u5b9a\u7fa9\u304c\u3042\u308a\u307e\u3059\u3002\n\n192.168.11.0/24\u306e\u30bb\u30b0\u30e1\u30f3\u30c8\u7528\u306e\u5b9a\u7fa9\u304c\u4e00\u756a\u4e0a\u306e\u3082\u306e\u306b\u306a\u308a\u307e\u3059\u3002\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30b0\u30e1\u30f3\u30c8\u3092\u9006\u9806\u306b\u8a18\u8f09\u3059\u308b\u306e\u3068\u3001\u672b\u5c3e\u306b\u300c.in-addr.arpa\u300d\u3092\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u300c.in-addr.arpa\u300d\u3092\u4ed8\u4e0e\u3059\u308b\u3053\u3068\u3067\u3001\u6b63\u5f15\u304d\u3068\u540c\u3058\u6a5f\u80fd\u3092\u4f7f\u3063\u3066\u3001\u9006\u5f15\u304d\u3092\u51fa\u6765\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\u4f8b\uff09\ntorapc.mylabo.local\u2192\u6b63\u5f15\u304d\u2192192.168.11.3\n3.11.168.192.in-addr.arpa\u2192\u6b63\u5f15\u304d\u2192torapc.mylabo.local\n\n\u300c3.11.168.192.in-addr.arpa\u300d\u3068\u3044\u3046\u30db\u30b9\u30c8\u540d\u3068\u3057\u3066\u3001\u6b63\u5f15\u304d\u3092\u3059\u308b\u51e6\u7406\u3068\u306a\u308a\u307e\u3059\u3002\n\u3000\n\u3000\n\n```named.conf\u306eview\u629c\u7c8b\ninclude \"/etc/named.rfc1912.zones\"; //localhost\u306a\u3069\u306e\u5b9a\u7fa9\ninclude \"/etc/named.root.key\";\n```\nnamed.conf\u30d5\u30a1\u30a4\u30eb\u306f\u3001include\u3092\u4f7f\u7528\u3057\u3066\u3001\u5916\u90e8\u306b\u3042\u308b\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u5b9a\u7fa9\u3092\u5f15\u7528\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u306e\u5b9a\u7fa9\u3084\u3001\u30eb\u30fc\u30c8\u30c9\u30e1\u30a4\u30f3\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u3001\u305d\u308c\u305e\u308c\u306eBIND\u3067\u5b9a\u7fa9\u3059\u308b\u3088\u308a\u3082\n\u4e00\u500b\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u6d41\u7528\u3057\u305f\u307b\u3046\u304c\u6574\u7406\u3057\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\n\u300cnamed.rfc1912.zones\u300d\u306e\u4e2d\u8eab\u3092\u4e0b\u306b\u66f8\u304d\u307e\u3059\u3002\n\n```named.rfc1912.zones\n// named.rfc1912.zones:\n//\n// Provided by Red Hat caching-nameserver package \n//\n// ISC BIND named zone configuration for zones recommended by\n// RFC 1912 section 4.1 : localhost TLDs and address zones\n// and http://www.ietf.org/internet-drafts/draft-ietf-dnsop-default-local-zones-02.txt\n// (c)2007 R W Franks\n// \n// See /usr/share/doc/bind*/sample/ for example named configuration files.\n//\n\nzone \"localhost.localdomain\" IN {\ntype master;\nfile \"named.localhost\";\nallow-update { none; };\n};\n\nzone \"localhost\" IN {\ntype master;\nfile \"named.localhost\";\nallow-update { none; };\n};\n\n\n\nzone \"1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa\" IN {\ntype master;\nfile \"named.loopback\";\nallow-update { none; };\n};\n\n\nzone \"1.0.0.127.in-addr.arpa\" IN {\ntype master;\nfile \"named.loopback\";\nallow-update { none; };\n};\n\n\nzone \"0.in-addr.arpa\" IN {\ntype master;\nfile \"named.empty\";\nallow-update { none; };\n};\n```\n\nIPv4, IPv6\u306e\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u7528\u306e\u6b63\u5f15\u304d\u3001\u9006\u5f15\u304d\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\n##\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb(\u540d\u524d\u89e3\u6c7a\u306e\u305f\u3081\u306e\u60c5\u5831)\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306e\u4f8b\u3067\u306f\u6b63\u5f15\u304d1\u7a2e\u985e\u3002\n\u9006\u5f15\u304d3\u7a2e\u985e\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n###\u6b63\u5f15\u304d\u7528\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u3044\u3066\n/var/named/chroot/var/named/\u306e\u76f4\u4e0b\u306b\nmylabo.local.lan\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```/var/named/chroot/var/named/mylabo.local.lan\n$TTL 3600\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n                 IN      NS     mng-server.mylabo.local.\ntorapc           IN      A      192.168.11.3\nstorage          IN      A      192.168.14.253\nESXi-Primary     IN      A      192.168.15.50\nESXi-Secondary   IN      A      192.168.15.51\nvCenter          IN      A      192.168.15.252\nmng-server       IN      A      192.168.15.253\n```\n\n\u5404\u7a2e\u8981\u7d20\u3092\u4e0b\u3067\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```mylabo.local.lan\u629c\u7c8b\n$TTL 3600\n```\n\n3600\u79d2\u9593(1\u6642\u9593)\u3053\u306e\u30be\u30fc\u30f3\u306e\u5185\u5bb9\u304c\u3001\u4ed6\u306eDNS\u30b5\u30fc\u30d0\u30fc\u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u3055\u308c\u308b\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u3092\u9577\u304f\u3057\u3059\u304e\u308b\u3068\u3001\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u3092\u66f4\u65b0\u3057\u3066\u3082\u3001\u306a\u304b\u306a\u304b\u4ed6\u306e\u30b5\u30fc\u30d0\u30fc\u3078\u60c5\u5831\u304c\u6d78\u900f\u3057\u306a\u3044\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u5373\u53cd\u6620\u3055\u305b\u308b\u306b\u306f\u3001\u307b\u304b\u306eDNS\u30b5\u30fc\u30d0\u30fc\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u5168\u3066\u30af\u30ea\u30a2\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\n\u73fe\u5b9f\u7684\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3068\u3044\u3046\u304b\u30e0\u30ea\u3067\u3059\u3002\u306a\u306e\u3067\u305d\u3053\u305d\u3053\u306e\u6642\u9593\u306b\u3059\u308b\u306e\u304c\u826f\u3044\u306e\u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\n\u3000\n\n\n```mylabo.local.lan\u629c\u7c8b\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n```\n\nSOA(Start Of Authority)\u30ec\u30b3\u30fc\u30c9\u306e\u5b9a\u7fa9\u3067\u3059\u3002\nSOA\u30ec\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u8aac\u660e\u3059\u308b\u3068\u3001\u300c\u79c1\u306f\u3053\u306e\u30c9\u30e1\u30a4\u30f3\u306e\u60c5\u5831\u3092\u7ba1\u7406\u3057\u307e\u3059\u300d\u3068\u3044\u3046\u5ba3\u8a00\u3067\u3059\u3002\n\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u3001\u300cmylabo.local\u300d\u30c9\u30e1\u30a4\u30f3\u3092\u7ba1\u7406\u3057\u3066\u3044\u308bDNS\u30b5\u30fc\u30d0\u30fc\u306f\u3001\n\u300cmng-server.mylabo.local.\u300d\u3068\u3044\u3046\u3053\u3068\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\uff08\u30c9\u30e1\u30a4\u30f3\u306e\u6b63\u78ba\u306a\u5b9a\u7fa9\u306b\u3064\u3044\u3066\u306f\u7121\u8996\u3057\u307e\u3059\uff09\n\n\u305d\u308c\u3067\u306f1\u3064\u305a\u3064\u89e3\u8aac\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n@\n\u81ea\u5206\u81ea\u8eab\u306e\u30be\u30fc\u30f3\u540d\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\u76f4\u63a5 mng-server.mylabo.local.\u3068\u66f8\u3044\u3066\u3082\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\n\nIN\n\u6c7a\u307e\u308a\u6587\u53e5\u3067\u3059\u3002InterNet\u304b\u3089\u53d6\u3089\u308c\u3066\u3044\u308b\u3068\u304b\u3001INternet \u304b\u3089\u53d6\u3089\u308c\u3066\u3044\u308b\u3068\u304b\u8a00\u308f\u308c\u3066\u3044\u307e\u3059\u3002\uff08\u3069\u3063\u3061\u3067\u3082\u3044\u3044\uff09\n\nSOA\n\u30ec\u30b3\u30fc\u30c9\u306e\u7a2e\u985e\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002IN SOA\u3068\u304b\u3001IN NS\u3068\u304b\u3001INT A \u3068\u304b\u6307\u5b9a\u304c\u53ef\u80fd\u3067\u3059\u3002\n\nmng-server.mylabo.local.\nMNAME\u3067\u3059\u3002\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306e\u57fa\u3068\u306a\u308b\u30c7\u30fc\u30bf\u3092\u6301\u3064\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306e\u540d\u524d\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u57fa\u672c\u7684\u306b\u81ea\u5206\u81ea\u8eab\u306b\u306a\u308a\u307e\u3059\u3002\n\nroot.mylabo.local. \nRNAME\u3067\u3059\u3002\u3053\u306e\u30be\u30fc\u30f3\u3092\u7ba1\u7406\u3059\u308b\u7ba1\u7406\u8005\u306e\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u3002\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306e@\u3092.\u306b\u5909\u63db\u3059\u308b\u3089\u3057\u3044\u306e\u3067\u3001\nroot@mylabo.local. \u3068\u3044\u3046\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n(\u3000)\u3067\u304f\u304f\u3089\u308c\u305f\u5404\u7a2e\u8a2d\u5b9a\u5024\nDNS\u30bb\u30ab\u30f3\u30c0\u30ea\u30b5\u30fc\u30d0\u30fc\u3068\u9023\u643a\u3059\u308b\u969b\u306e\u5404\u7a2e\u8a2d\u5b9a\u5024\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\nserial\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8868\u3059\u6570\u5b57\u3067\u3059\u3002\n\u5e74\u6708\u65e52\u6841\u306e\u6607\u9806\u306e\u6570\u5b57 \u3092\u66f8\u304f\u5834\u5408\u304c\u591a\u3044\u3067\u3059\u3002\n\u30be\u30fc\u30f3\u30d5\u30a1\u30a4\u30eb\u304c\u5927\u304d\u3044\u3068\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3068\u8a8d\u8b58\u3055\u308c\u308b\u306e\u3067\u3001\n\u30bb\u30ab\u30f3\u30c0\u30ea\u30b5\u30fc\u30d0\u30fc\u306f\u30d7\u30e9\u30a4\u30de\u30ea\u30b5\u30fc\u30d0\u30fc\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u898b\u306b\u884c\u304d\u3001\n\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u5927\u304d\u3051\u308c\u3070\u30be\u30fc\u30f3\u8ee2\u9001\u3092\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u5e74\u6708\u65e5\u3067\u66f8\u304f\u3068\u3001\u7ba1\u7406\u3057\u3084\u3059\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\nrefresh\n\u30be\u30fc\u30f3\u306e\u60c5\u5831\u3092\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u3059\u308b\u307e\u3067\u306e\u6642\u9593\u3067\u3059\u3002\nDNS\u30bb\u30ab\u30f3\u30c0\u30ea\u30b5\u30fc\u30d0\u306f\u30be\u30fc\u30f3\u8ee2\u9001\u3092\u3057\u305f\u5f8c\u3001\u3053\u306e\u6642\u9593\u7d4c\u904e\u5f8c\u3001\n\u30be\u30fc\u30f3\u306e\u66f4\u65b0\u304c\u3055\u308c\u305f\u304b\u3092\u554f\u3044\u5408\u308f\u305b\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u518d\u5ea6\u30c7\u30fc\u30bf\u3092\u624b\u306b\u5165\u308c\u3088\u3046\u3068\u3057\u307e\u3059\n\u3053\u306e\u6642\u306b\u3001\u4e0a\u306eserial\u3092\u4f7f\u7528\u3057\u3066\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6bd4\u8f03\u3057\u307e\u3059\u3002\n\nretry\nrefresh\u3067\u30be\u30fc\u30f3\u60c5\u5831\u306e\u66f4\u65b0\u304c\u3067\u304d\u306a\u304b\u3063\u305f\u5834\u5408\u306b\u3001\nretry\u3067\u6307\u5b9a\u3055\u308c\u305f\u6642\u9593\u5f8c\u306b\u518d\u5ea6\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u3092\u8a66\u307f\u307e\u3059\u3002\n\nexpire\n\u4f55\u3089\u304b\u306e\u7406\u7531\u3067\u30be\u30fc\u30f3\u60c5\u5831\u306e\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u304c\u3067\u304d\u306a\u3044\u72b6\u614b\u304c\u7d9a\u3044\u305f\u5834\u5408\u3001\n\u30bb\u30ab\u30f3\u30c0\u30ea\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u304c\u6301\u3063\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092\u3069\u308c\u3060\u3051\u306e\u6642\u9593\u5229\u7528\u3057\u3066\u3082\u3088\u3044\u304b\u3092\u793a\u3057\u307e\u3059\u3002\n\nmin\uff08Negative cache TTL\uff09\n\u30cd\u30ac\u30c6\u30a3\u30d6\u30ad\u30e3\u30c3\u30b7\u30e5\u3068\u306f\u3001\u5b58\u5728\u3057\u306a\u3044\u30c9\u30e1\u30a4\u30f3\u540d\u3067\u3042\u308b\u3068\u3044\u3046\u60c5\u5831\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u610f\u5473\u3057\u307e\u3059\n\uff08\u30cd\u30ac\u30c6\u30a3\u30d6\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u7dad\u6301\u3059\u308b\u6642\u9593\uff09\n\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u554f\u3044\u5408\u308f\u305b\u306e\u90fd\u5ea6\u78ba\u8a8d\u3059\u308b\u3068\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3057\u3001\u4e0a\u4f4dDNS\u30b5\u30fc\u30d0\u30fc\u3078\u306e\u8ca0\u8377\u3082\u304b\u304b\u308b\u306e\u3067\u3001\n\u30ad\u30e3\u30c3\u30b7\u30e5\u3068\u3057\u3066\u4fdd\u6301\u3057\u307e\u3059\u3002\n\u3000\n\u3000\n\n```mylabo.local.lan\u629c\u7c8b\n                 IN      NS     mng-server.mylabo.local.\n```\n\nNS\u30ec\u30b3\u30fc\u30c9\u3067\u3059\u3002\u6c7a\u307e\u308a\u6587\u53e5\u306a\u306e\u3067\u3001\u81ea\u5206\u81ea\u8eab\u306e\u60c5\u5831\u3092\u66f8\u304d\u307e\u3057\u3087\u3046\n\u3000\n\n```mylabo.local.lan\u629c\u7c8b\ntorapc           IN      A      192.168.11.3\nshare-storage    IN      A      192.168.14.253\nESXi-Primary     IN      A      192.168.15.50\nESXi-Secondary   IN      A      192.168.15.51\nvCenter          IN      A      192.168.15.252\nmng-server       IN      A      192.168.15.253\n```\n\nA\u30ec\u30b3\u30fc\u30c9\u3067\u3059\u3002\u5404\u7a2e\u30db\u30b9\u30c8\u540d\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u5b9a\u7fa9\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n###\u9006\u5f15\u304d\u7528\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u3044\u3066\n3\u30bb\u30b0\u30e1\u30f3\u30c8\u5206\u306e\u9006\u5f15\u304d\u7528\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u57fa\u672c\u7684\u306b\u306f\u6b63\u5f15\u304d\u7528\u30d5\u30a1\u30a4\u30eb\u3068\u69cb\u6210\u306f\u540c\u3058\u3067\u3059\u3002\nA\u30ec\u30b3\u30fc\u30c9\u306e\u4ee3\u308f\u308a\u306bPTR\u30ec\u30b3\u30fc\u30c9\u3067\u3001\u9006\u5f15\u304d\u7528\u306e\u60c5\u5831\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```/var/named/chroot/var/named/11.168.192.in-addr.arpa.rev\n$TTL 3600\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n                 IN      NS     mng-server.mylabo.local.\n3                IN      PTR    torapc.mylabo.local.\n```\n\n```/var/named/chroot/var/named/14.168.192.in-addr.arpa.rev\n$TTL 3600\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n                 IN      NS     mng-server.mylabo.local.\n253              IN      PTR    share-storage.mylabo.local.\n```\n\n\n```/var/named/chroot/var/named/15.168.192.in-addr.arpa.rev\n$TTL 3600\n@                IN      SOA mng-server.mylabo.local. root.mylabo.local. (\n                         2015121701 ; serial\n                         3600       ; refresh 1hr\n                         900        ; retry 15min\n                         604800     ; expire 1w\n                         86400      ; min 24hr\n)\n\n                 IN      NS     mng-server.mylabo.local.\n50               IN      PTR    ESXi-Primary.mylabo.local.\n51               IN      PTR    ESXi-Secondary.mylabo.local.\n252              IN      PTR    vCenter.mylabo.local.\n253              IN      PTR    mng-server.mylabo.local.\n```\n\n##\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u306eDNS\u30dd\u30fc\u30c8\u89e3\u653e\n\nfirewalld\u3092\u4f7f\u7528\u3057\u3066DNS\u30dd\u30fc\u30c8(TCP:53 UDP:53)\u3092\u89e3\u653e\u3057\u307e\u3059\u3002\n\n\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\nhttp://qiita.com/shrkw/items/8410e9cb65eb789a40e1\n\n\nfirewalld\u3092\u6b62\u3081\u3066\u3044\u305f\u306e\u3067\u3001\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n\n```\n[root@mng-server ~]# systemctl start firewalld\n[root@mng-server ~]#\n[root@mng-server ~]# systemctl enable firewalld\nln -s '/usr/lib/systemd/system/firewalld.service' '/etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service'\nln -s '/usr/lib/systemd/system/firewalld.service' '/etc/systemd/system/basic.target.wants/firewalld.service'\n[root@mng-server ~]# systemctl status firewalld\nfirewalld.service - firewalld - dynamic firewall daemon\n   Loaded: loaded (/usr/lib/systemd/system/firewalld.service; enabled)\n   Active: active (running) since \u65e5 2015-12-20 13:47:27 JST; 12s ago\n Main PID: 2201 (firewalld)\n   CGroup: /system.slice/firewalld.service\n           \u2514\u25002201 /usr/bin/python -Es /usr/sbin/firewalld --nofork --nopid\n\n12\u6708 20 13:47:27 mng-server.mylabo.local systemd[1]: Started firewalld - dynamic firewall daemon.\n\n```\n\u3000\n\u3000\nfirewalld\u3067\u73fe\u5728\u4f7f\u7528\u3057\u3066\u3044\u308b\u30be\u30fc\u30f3\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n```\n[root@mng-server ~]# firewall-cmd --list-all\npublic (default, active)\n  interfaces: eno16777984\n  sources:\n  services: dhcpv6-client ssh\n  ports:\n  masquerade: no\n  forward-ports:\n  icmp-blocks:\n  rich rules:\n```\n\u3000\n\neno16777984\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u304c\u3001\u30be\u30fc\u30f3public\u3067\u7a3c\u50cd\u3057\u3066\u3044\u307e\u3059\u3002\nservices\u306e\u9805\u76ee\u304c\u3001\u30dd\u30fc\u30c8\u89e3\u653e\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002\ndns\u304c\u7121\u3044\u306e\u3067\u8ffd\u52a0\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u524d\u306bdns\u30b5\u30fc\u30d3\u30b9\u306e\u5b9a\u7fa9\u5185\u5bb9\u3092\u5ff5\u306e\u305f\u3081\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n[root@mng-server ~]# cat /usr/lib/firewalld/services/dns.xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<service>\n  <short>DNS</short>\n  <description>The Domain Name System (DNS) is used to provide and request host and domain names. Enable this option, if you plan to provide a domain name service (e.g. with bind).</description>\n  <port protocol=\"tcp\" port=\"53\"/>\n  <port protocol=\"udp\" port=\"53\"/>\n</service>\n```\n\ntcp 53, udp 53\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n\u3067\u306fpublic\u30be\u30fc\u30f3\u306bdns\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\n[root@mng-server ~]# firewall-cmd --list-services --zone=public  --permanent\ndhcpv6-client ssh\n[root@mng-server ~]# firewall-cmd --add-service=dns --zone=public --permanent\nsuccess\n[root@mng-server ~]# firewall-cmd --list-services --zone=public  --permanent\ndhcpv6-client dns ssh\n```\n\n\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n\n```\n[root@mng-server ~]# firewall-cmd --reload\nsuccess\n```\n\n\n##BIND\u8d77\u52d5\n\n\u3053\u3053\u307e\u3067\u69cb\u7bc9\u3057\u305f\u3089\u3001\u3042\u3068\u306f\u30b5\u30fc\u30d3\u30b9\u8d77\u52d5\u3067\u304d\u307e\u3059\u3002\n\n```\n[root@mng-server named]# systemctl start named-chroot\n[root@mng-server named]# systemctl enable named-chroot \u2190 \u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\nln -s '/usr/lib/systemd/system/named-chroot.service' '/etc/systemd/system/multi-user.target.wants/named-chroot.service'\n```\n\n##\u540d\u524d\u89e3\u6c7a\u78ba\u8a8d\n###\u6b63\u5f15\u304d\n\ndig\u30b3\u30de\u30f3\u30c9\u3067\u6b63\u5f15\u304d\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```file:dig\u30b3\u30de\u30f3\u30c9\n[root@mng-server ~]# dig torapc.mylabo.local.\n\n; <<>> DiG 9.9.4-RedHat-9.9.4-18.el7_1.5 <<>> torapc.mylabo.local.\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 45901\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;torapc.mylabo.local.           IN      A\n\n;; ANSWER SECTION:\ntorapc.mylabo.local.    3600    IN      A       192.168.11.3\n\n;; AUTHORITY SECTION:\nmylabo.local.           3600    IN      NS      mng-server.mylabo.local.\n\n;; ADDITIONAL SECTION:\nmng-server.mylabo.local. 3600   IN      A       192.168.15.253\n\n;; Query time: 0 msec\n;; SERVER: 192.168.15.253#53(192.168.15.253)\n;; WHEN: \u6728 12\u6708 17 23:03:49 JST 2015\n;; MSG SIZE  rcvd: 105\n```\n\n;; ANSWER SECTION:\u306e1\u884c\u4e0b\u306b\u540d\u524d\u89e3\u6c7a\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n\n###\u9006\u5f15\u304d\n\n\u3053\u3061\u3089\u3082dig\u30b3\u30de\u30f3\u30c9 -x \u3067\u9006\u5f15\u304d\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```file:dig\u30b3\u30de\u30f3\u30c9\n[root@mng-server named]# dig -x 192.168.11.3\n\n; <<>> DiG 9.9.4-RedHat-9.9.4-18.el7_1.5 <<>> -x 192.168.11.3\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 54774\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;3.11.168.192.in-addr.arpa.     IN      PTR\n\n;; ANSWER SECTION:\n3.11.168.192.in-addr.arpa. 3600 IN      PTR     torapc.mylabo.local.\n\n;; AUTHORITY SECTION:\n11.168.192.in-addr.arpa. 3600   IN      NS      mng-server.mylabo.local.\n\n;; ADDITIONAL SECTION:\nmng-server.mylabo.local. 3600   IN      A       192.168.15.253\n\n;; Query time: 0 msec\n;; SERVER: 192.168.15.253#53(192.168.15.253)\n;; WHEN: \u6728 12\u6708 17 23:18:13 JST 2015\n;; MSG SIZE  rcvd: 128\n```\n", "tags": ["dns", "CentOS"]}