{"context": " More than 1 year has passed since last update.AWS\u3067\u30ea\u30bd\u30fc\u30b9\u306e\u76e3\u8996\u3084\u8a08\u6e2c\u3068\u3044\u3048\u3070CloudWatch\u3067\u3059\u304c\u3001\u4ed6\u306e\u30b5\u30fc\u30d3\u30b9\u304c\u3069\u3093\u306a\u611f\u3058\u304b\u4f7f\u3063\u3066\u307f\u305f\u304f\u3066\u8a66\u3057\u306bNewRelic\u3092\u4f7f\u3063\u3066\u307f\u305f\u306e\u3067\u305d\u306e\u6642\u306e\u30e1\u30e2\n\u6700\u7d42\u7684\u306b\u4ee5\u4e0b\u3092\u8a08\u6e2c\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30b5\u30fc\u30d0\u30fc\u30ea\u30bd\u30fc\u30b9(CPU\u3001\u30e1\u30e2\u30ea\u3001\u30ed\u30fc\u30c9\u30a2\u30d9\u30ec\u30fc\u30b8\u306a\u3069\uff09\nPHP\u30a2\u30d7\u30ea(\u30ec\u30b9\u30dd\u30f3\u30b9\u30bf\u30a4\u30e0\u3001\u30a8\u30e9\u30fc\u7387\u306a\u3069)\nRDS-MySQL(SQL\u6570\u3001\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u306a\u3069)\nApache Httpd(server status\u3067\u78ba\u8a8d\u3067\u304d\u308b\u5185\u5bb9)\n\n\n\u3068\u308a\u3042\u3048\u3042\u3048\u305a\u8a66\u3059\uff08\u30b5\u30fc\u30d0\u30fc\u30ea\u30bd\u30fc\u30b9\uff09\nAWS\u30e6\u30fc\u30b6\u306a\u3089\u7121\u6599\u3067\u4f7f\u3048\u308bNew Relic\u5c0e\u5165\u65b9\u6cd5\n\u4e0a\u8a18\u3092\u53c2\u8003\u306bAmazonLinux\u306b\u9069\u5fdc\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nNewRelic\u306b\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\n\u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u3092\u78ba\u8a8d\n\u76e3\u8996\u5bfe\u8c61\u306eEC2\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3057\u3001\u4ee5\u4e0b\u3092\u5b9f\u884c(LICENSE_KEY\u3068\u306a\u3063\u3066\u3044\u308b\u90e8\u5206\u306f\u81ea\u5206\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u306b\u5909\u66f4)\n\n$sudo rpm -Uvh http://download.newrelic.com/pub/newrelic/el5/i386/newrelic-repo-5-3.noarch.rpm\n$sudo yum install newrelic-sysmond\n$sudo nrsysmond-config --set license_key=LICENSE_KEY\n$sudo /etc/init.d/newrelic-sysmond start\n$sudo chkconfig newrelic-sysmond on\n\n\u3053\u308c\u3060\u3051\u3067\u4ee5\u4e0b\u304c\u8a08\u6e2c\u3067\u304d\u307e\u3059\u3002\n\nCPU\u4f7f\u7528\u7387\n\u30ed\u30fc\u30c9\u30a2\u30d9\u30ec\u30fc\u30b8\n\u30e1\u30e2\u30ea\u4f7f\u7528\u7387\nDisk I/O\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\n\u30d7\u30ed\u30bb\u30b9\n\n\n\n\u30d7\u30ed\u30bb\u30b9\u3092\u78ba\u8a8d\u3067\u304d\u308b\u306e\u304c\u4fbf\u5229\u3067\u3059\u3002\u3069\u306e\u30d7\u30ed\u30bb\u30b9\u304cCPU\u3001\u30e1\u30e2\u30ea\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u4f8b\u3067\u306froot\u30e6\u30fc\u30b6\u30fc\u3067\u5b9f\u884c\u3055\u308c\u3066\u3044\u308bJava\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u591a\u304f\u306e\u30e1\u30e2\u30ea\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n\u306a\u304a\u3001SecurityGroup\u3067\u53b3\u5bc6\u306bOutBound\u306e\u8a31\u53ef\u3092\u884c\u3046\u5834\u5408\u3001\u4ee5\u4e0b\u306b\u63a5\u7d9a\u5148\u30db\u30b9\u30c8\u540d\u3001\u30dd\u30fc\u30c8\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u3057\u305f\u3002\nNetWorks\n\nPHP\u30a2\u30d7\u30ea\u306e\u8a08\u6e2c\u3092\u3057\u3066\u307f\u308b\n\u521d\u3081\u306bPHP-info\u306e\u307f\u8868\u793a\u3057\u3066\u78ba\u8a8d\u3057\u307e\u3059\u304c\u3001\u3042\u3068\u3067WordPress\u69cb\u7bc9\u3057\u3066\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001MySQL\u306f\u4e8b\u524d\u306bRDS\u3067\u4f5c\u6210\u3057\u3066\u304a\u3044\u3066\u3001\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3001DB\u306e\u30e6\u30fc\u30b6\u30fc\u540d\u3001DB\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30e1\u30e2\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3066\u3044\u304d\u3001\u5fc5\u8981\u306a\u3082\u306e\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u306a\u304a\u3001SQL\u5b9f\u884c\u306e\u7b87\u6240\u306f\u30e6\u30fc\u30b6\u30fc\u540d\u306froot\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306fpassword\u3001RDS\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306fwordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com \u3068\u3044\u3046\u5834\u5408\u306e\u8a2d\u5b9a\u3068\u306a\u308b\u306e\u3067\u9069\u5b9c\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n# install httpd\nsudo yum install -y httpd\nsudo chkconfig httpd on\nsudo service httpd start\n\n# install application dependencies\nsudo yum install php php-mysql php-gd php-mbstring -y\nsudo yum install mysql -y\n\n#exec sql\nmysql -u root -ppassword -h wordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com <<EOF\nCREATE USER'wordpress-user'@'%' IDENTIFIED BY 'wordpress';\nCREATE DATABASE \\`wordpress\\`;\nGRANT ALL PRIVILEGES ON \\`wordpress\\`.*TO\"wordpress-user\"@\"%\";\nFLUSH PRIVILEGES;\nEOF\n\n\u6e96\u5099\u304c\u3067\u304d\u305f\u306e\u3067\u6b21\u306bPHP\u30a2\u30d7\u30ea\u306e\u8a08\u6e2c\u3092\u884c\u3046\u305f\u3081\u306e\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u304d\u307e\u3059\u3002\nPHP agent installation: RedHat and CentOS\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$sudo yum install newrelic-php5\n\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n$sudo newrelic-install install\n\n\u5b9f\u884c\u306e\u9014\u4e2d\u3067\u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u306e\u5165\u529b\u3092\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u5165\u529b\u3057\u307e\u3059\u3002\n\u3053\u308c\u3067\u5b8c\u4e86\u3067\u3059\u3002\n\u8a66\u3057\u306bphpinfo\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3059\u3002\n$sudo vi  /var/www/html/phpinfo.php\n\n\nphpinfo.php\n<?php phpinfo(); ?>\n\n\nhttpd\u306e\u518d\u8d77\u52d5\n$sudo service httpd restart\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\u3059\u308b\u3068\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fPHP\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306a\u3069\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002(http://{Public IP}/phpinfo.php)\n\u3053\u306e\u72b6\u614b\u3067NewRelic\u306e\u30b5\u30a4\u30c8\u3092\u898b\u308b\u3068PHP\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3060\u3051\u3060\u3068\u9762\u767d\u304f\u7121\u3044\u306e\u3067WordPress\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002\n$sudo yum install -y git\n$cd /var/www/html/\n$sudo git clone https://github.com/WordPress/WordPress.git\n$sudo chown -R apache:apache WordPress\n$sudo chmod -R 744 WordPress\n$sudo service httpd restart\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002(http://{Public IP}/WordPress)\nWordPress\u306e\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d->wordpress\n\u30e6\u30fc\u30b6\u30fc\u540d->root\n\u30d1\u30b9\u30ef\u30fc\u30c9->password\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30db\u30b9\u30c8\u540d->wordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com\n\n\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\nNewRelic\u3067\u306f\u4ee5\u4e0b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u30ec\u30b9\u30dd\u30f3\u30b9\u30bf\u30a4\u30e0\nApdex(New Relic\u72ec\u81ea\u6307\u6a19)\n\u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\n\u30a8\u30e9\u30fc\u7387\n\n\n\nApdex(New Relic\u72ec\u81ea\u6307\u6a19)\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306b\u8aac\u660e\u304c\u3042\u308a\u307e\u3057\u305f\u3002\nNew Relic\u3092\u4f7f\u3063\u3066\u308b\u4eba\u306b\u898b\u3066\u6b32\u3057\u3044\u6307\u6a19\u3002\u300cApdex\u300d\n\u307e\u305f\u3001\u7279\u5b9a\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9078\u629e\u3059\u308b\u3068\u305d\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u4e2d\u3067\u3069\u3053\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u304b\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\n\u3053\u308c\u3092\u4f7f\u3048\u3070\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u306e\u691c\u51fa\u306b\u3082\u5f79\u306b\u7acb\u3061\u305d\u3046\u3067\u3059\u306d\u3002\n\nMySQL\u306e\u8a08\u6e2c\u3092\u884c\u3046\nNew Relic\u3067MySQL\u3092\u8a73\u7d30\u306b\u76e3\u8996\u3059\u308b\n\u4e0a\u8a18\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u307e\u305a\u3001MySQL\u306b\u76e3\u8996\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u672c\u4f8b\u3067\u306f newrelic \u30e6\u30fc\u30b6\u30fc\u3068\u3057\u3066\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n$mysql -u root -ppassword -h wordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com\nmysql> CREATE USER newrelic@'%' IDENTIFIED BY 'newrelic';\nmysql> GRANT PROCESS,REPLICATION CLIENT ON *.* TO newrelic@'%';\n\n\u6e96\u5099\u304c\u3067\u304d\u305f\u306e\u3067\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\u3044\u304f\u3064\u304b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u304c\u3001New Relic Platform Installer\u3068\u3044\u3046\u306e\u3092\u4f7f\u3063\u3066\u3084\u3063\u3066\u307f\u307e\u3059\u3002\u4e0b\u8a18\u306f\u53c2\u8003\u3002\nnewrelic-platform/newrelic_mysql_java_plugin\nGetting Started with the Platform Installer\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n$LICENSE_KEY=YOUR_KEY_HERE bash -c \"$(curl -sSL https://download.newrelic.com/npi/release/install-npi-linux-redhat-x64.sh)\"\n\n\u4e0a\u8a18\u306b\u3088\u308a\u3001/home/{user}/newrelic-npi\u30d5\u30a9\u30eb\u30c0\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\u4ee5\u4e0b\u306b\u3088\u308a\u3001MySQL\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u6642\u306b\u8272\u3005\u78ba\u8a8d\u3055\u308c\u307e\u3059\u3002\n$cd ~/newrelic-npi/\n$./npi install npi install com.newrelic.plugins.mysql.instance\n\n\u9014\u4e2d\u3067\u3069\u306eDB\u306b\u63a5\u7d9a\u3059\u308b\u304b\u306a\u3069\u306e\u60c5\u5831\u3092\u805e\u304b\u308c\u307e\u3059\u306e\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\uff08\u8a2d\u5b9a\u306f\u9069\u5b9c\u5909\u66f4\uff09\n{\n  \"agents\": [\n    {\n      \"name\"    : \"WordPressDB\",\n      \"host\"    : \"wordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com\",\n      \"metrics\" : \"status,newrelic\",\n      \"user\"    : \"newrelic\",\n      \"passwd\"  : \"newrelic\"\n    }\n  ]\n}\n\n\u8a2d\u5b9a\u304c\u6b63\u3057\u3051\u308c\u3070NewRelic\u306ePlugin\u30da\u30fc\u30b8\u3067\u8a73\u7d30\u3092\u78ba\u8a8d\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067/etc/init.d/newrelic_plugin_com.newrelic.plugins.mysql.instance\u304c\u3067\u304d\u3066\u3044\u308b\u306e\u3067OS\u518d\u8d77\u52d5\u306e\u969b\u306b\u3082\u81ea\u52d5\u3067\u8d77\u52d5\u3059\u308b\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\u306a\u3069\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n$sudo service newrelic_plugin_com.newrelic.plugins.mysql.instance start\nStarting newrelic_plugin_com.newrelic.plugins.mysql.instance\n\nNewRelic\u3067\u306f\u4ee5\u4e0b\u306b\u3064\u3044\u3066\u78ba\u8a8d\u3067\u304d\u308b\u3088\u3046\u3067\u3057\u305f\u3002\n\nSQL\u6570(read\u3068write)\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\n\n\n\n\nhttpd\u306e\u8a08\u6e2c\u3082\u884c\u3046\nMeetMe/newrelic-plugin-agent\nhttpd\u306e\u8a08\u6e2c\u3082\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u3063\u3066\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\u305f\u3060\u3057\u3001MySQL\u30d7\u30e9\u30b0\u30a4\u30f3\u3068\u306f\u5225\u306e\u3084\u308a\u65b9\u306b\u306a\u308b\u3088\u3046\u3067\u3059\u3002\u3002\u3046\u30fc\u3093\u3001\u3053\u308c\u7d71\u4e00\u3055\u308c\u306a\u3044\u306e\u304b\u306a\u3002\u3002\u3002\npython\u306epip\u3092\u4f7f\u3046\u307f\u305f\u3044\u3067\u30012.6\u304b2.7\u306e\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$python -V\nPython 2.7.9\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n# install\n$sudo  pip install newrelic-plugin-agent\n\n# create folder(if it doesn't exsit)\n$sudo mkdir /etc/newrelic\n$sudo mkdir /var/log/newrelic\n$sudo mkdir /var/run/newrelic\n\n# copy config and init.d file\n$sudo cp /opt/newrelic-plugin-agent/newrelic-plugin-agent.cfg /etc/newrelic/\n$sudo cp /opt/newrelic-plugin-agent/newrelic-plugin-agent.rhel /etc/init.d/newrelic-plugin-agent\n$sudo chmod 755 /etc/init.d/newrelic-plugin-agent\n\n\u30c7\u30fc\u30e2\u30f3\u5b9f\u884c\u30e6\u30fc\u30b6\u30fc\u3092root\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001\u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\n/etc/newrelic/newrelic-plugin-agent.cfg\n- license_key: REPLACE_WITH_REAL_KEY\n+ license_key: YOUR_LICENCE_KEY\n\n-  #apache_httpd:\n-  #  name: hostname\n-  #  scheme: http\n-  #  host: localhost\n-  #  verify_ssl_cert: true\n-  #  port: 80\n-  #  path: /server-status\n\n+  apache_httpd:\n+    name: WordPress\n+    scheme: http\n+    host: localhost\n+  #  verify_ssl_cert: true\n+    port: 80\n+    path: /server-status\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3082\u5909\u3048\u307e\u3059\u3002\n\n/etc/newrelic/newrelic-plugin-agent.cfg\n- APP=\"/usr/bin/newrelic-plugin-agent\"\n+ APP=\"/usr/local/bin/newrelic-plugin-agent\"\n\n\nApache\u306eserver status page\u306e\u8868\u793a\u3092\u6709\u52b9\u5316\u306b\u3059\u308b\u305f\u3081\u3001httpd\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u3088\u308a\u8a73\u7d30\u306a\u60c5\u5831\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306bExtendedStatus\u3092\u6709\u52b9\u5316\u3057\u307e\u3059\u3002ExtendedStatus\u3092\u6709\u52b9\u306b\u3059\u308b\u3068\u30b5\u30fc\u30d0\u30fc\u306e\u52d5\u4f5c\u304c\u9045\u304f\u306a\u308b\u3053\u3068\u3082\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u672c\u756a\u306e\u74b0\u5883\u3067\u3084\u308b\u5834\u5408\u306b\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n/etc/httpd/conf/httpd.conf\n\n- #ExtendedStatus On\n+ ExtendedStatus On\n\n- #<Location /server-status>\n- #    SetHandler server-status\n- #    Order deny,allow\n- #    Deny from all\n- #    Allow from .example.com\n- #</Location>\n\n+ <Location /server-status>\n+     SetHandler server-status\n+     Order deny,allow\n+     Deny from all\n+     Allow from 127.0.0.1\n+ </Location>\n\n\nhttpd\u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n$sudo service httpd restart\n\nnewrelic\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n$sudo /etc/init.d/newrelic-plugin-agent start\n\n\u30ed\u30b0\u306f/var/log/newrelic/newrelic-plugin-agent.log\u4ee5\u4e0b\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u78ba\u8a8d\u3067\u304d\u308b\u5185\u5bb9\u306f\u4ee5\u4e0b\u306b\u8a18\u8f09\u304c\u3042\u308a\u307e\u3059\u3002\nApache \u30e2\u30b8\u30e5\u30fc\u30eb mod_status\n\n\nAWS\u3067\u30ea\u30bd\u30fc\u30b9\u306e\u76e3\u8996\u3084\u8a08\u6e2c\u3068\u3044\u3048\u3070CloudWatch\u3067\u3059\u304c\u3001\u4ed6\u306e\u30b5\u30fc\u30d3\u30b9\u304c\u3069\u3093\u306a\u611f\u3058\u304b\u4f7f\u3063\u3066\u307f\u305f\u304f\u3066\u8a66\u3057\u306b[NewRelic](https://newrelic.com/)\u3092\u4f7f\u3063\u3066\u307f\u305f\u306e\u3067\u305d\u306e\u6642\u306e\u30e1\u30e2\n\n\u6700\u7d42\u7684\u306b\u4ee5\u4e0b\u3092\u8a08\u6e2c\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n+ \u30b5\u30fc\u30d0\u30fc\u30ea\u30bd\u30fc\u30b9(CPU\u3001\u30e1\u30e2\u30ea\u3001\u30ed\u30fc\u30c9\u30a2\u30d9\u30ec\u30fc\u30b8\u306a\u3069\uff09\n+ PHP\u30a2\u30d7\u30ea(\u30ec\u30b9\u30dd\u30f3\u30b9\u30bf\u30a4\u30e0\u3001\u30a8\u30e9\u30fc\u7387\u306a\u3069)\n+ RDS-MySQL(SQL\u6570\u3001\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\u306a\u3069)\n+ Apache Httpd(server status\u3067\u78ba\u8a8d\u3067\u304d\u308b\u5185\u5bb9)\n\n# \u3068\u308a\u3042\u3048\u3042\u3048\u305a\u8a66\u3059\uff08\u30b5\u30fc\u30d0\u30fc\u30ea\u30bd\u30fc\u30b9\uff09\n\n[AWS\u30e6\u30fc\u30b6\u306a\u3089\u7121\u6599\u3067\u4f7f\u3048\u308bNew Relic\u5c0e\u5165\u65b9\u6cd5](http://qiita.com/kou/items/fcb75108e6e882fd12bb)\n\n\u4e0a\u8a18\u3092\u53c2\u8003\u306bAmazonLinux\u306b\u9069\u5fdc\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n+ NewRelic\u306b\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\n+ \u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u3092\u78ba\u8a8d\n+ \u76e3\u8996\u5bfe\u8c61\u306eEC2\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3057\u3001\u4ee5\u4e0b\u3092\u5b9f\u884c(LICENSE_KEY\u3068\u306a\u3063\u3066\u3044\u308b\u90e8\u5206\u306f\u81ea\u5206\u306e\u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u306b\u5909\u66f4)\n\n```\n$sudo rpm -Uvh http://download.newrelic.com/pub/newrelic/el5/i386/newrelic-repo-5-3.noarch.rpm\n$sudo yum install newrelic-sysmond\n$sudo nrsysmond-config --set license_key=LICENSE_KEY\n$sudo /etc/init.d/newrelic-sysmond start\n$sudo chkconfig newrelic-sysmond on\n```\n\n\u3053\u308c\u3060\u3051\u3067\u4ee5\u4e0b\u304c\u8a08\u6e2c\u3067\u304d\u307e\u3059\u3002\n\n+ CPU\u4f7f\u7528\u7387\n+ \u30ed\u30fc\u30c9\u30a2\u30d9\u30ec\u30fc\u30b8\n+ \u30e1\u30e2\u30ea\u4f7f\u7528\u7387\n+ Disk I/O\n+ \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\n+ \u30d7\u30ed\u30bb\u30b9\n\n![Screen Shot 2015-07-29 at 10.20.49 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/5749eca5-330e-4329-f0e5-2d68165e1fb4.png \"Screen Shot 2015-07-29 at 10.20.49 PM.png\")\n\n![Screen Shot 2015-07-29 at 10.21.04 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/37d720c4-aa12-253f-a6ce-d463af3c0b0b.png \"Screen Shot 2015-07-29 at 10.21.04 PM.png\")\n\n\u30d7\u30ed\u30bb\u30b9\u3092\u78ba\u8a8d\u3067\u304d\u308b\u306e\u304c\u4fbf\u5229\u3067\u3059\u3002\u3069\u306e\u30d7\u30ed\u30bb\u30b9\u304cCPU\u3001\u30e1\u30e2\u30ea\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u4f8b\u3067\u306froot\u30e6\u30fc\u30b6\u30fc\u3067\u5b9f\u884c\u3055\u308c\u3066\u3044\u308bJava\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u591a\u304f\u306e\u30e1\u30e2\u30ea\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n![Screen Shot 2015-07-29 at 10.22.46 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/c8fa1c24-df29-46f8-3f64-c70ad441c0f6.png \"Screen Shot 2015-07-29 at 10.22.46 PM.png\")\n\n\u306a\u304a\u3001SecurityGroup\u3067\u53b3\u5bc6\u306bOutBound\u306e\u8a31\u53ef\u3092\u884c\u3046\u5834\u5408\u3001\u4ee5\u4e0b\u306b\u63a5\u7d9a\u5148\u30db\u30b9\u30c8\u540d\u3001\u30dd\u30fc\u30c8\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n[NetWorks](https://docs.newrelic.com/docs/apm/new-relic-apm/getting-started/networks#agents)\n\n\n# PHP\u30a2\u30d7\u30ea\u306e\u8a08\u6e2c\u3092\u3057\u3066\u307f\u308b\n\n\u521d\u3081\u306bPHP-info\u306e\u307f\u8868\u793a\u3057\u3066\u78ba\u8a8d\u3057\u307e\u3059\u304c\u3001\u3042\u3068\u3067WordPress\u69cb\u7bc9\u3057\u3066\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001MySQL\u306f\u4e8b\u524d\u306bRDS\u3067\u4f5c\u6210\u3057\u3066\u304a\u3044\u3066\u3001\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3001DB\u306e\u30e6\u30fc\u30b6\u30fc\u540d\u3001DB\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30e1\u30e2\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3066\u3044\u304d\u3001\u5fc5\u8981\u306a\u3082\u306e\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u306a\u304a\u3001SQL\u5b9f\u884c\u306e\u7b87\u6240\u306f\u30e6\u30fc\u30b6\u30fc\u540d\u306froot\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306fpassword\u3001RDS\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306fwordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com \u3068\u3044\u3046\u5834\u5408\u306e\u8a2d\u5b9a\u3068\u306a\u308b\u306e\u3067\u9069\u5b9c\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\n# install httpd\nsudo yum install -y httpd\nsudo chkconfig httpd on\nsudo service httpd start\n\n# install application dependencies\nsudo yum install php php-mysql php-gd php-mbstring -y\nsudo yum install mysql -y\n\n#exec sql\nmysql -u root -ppassword -h wordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com <<EOF\nCREATE USER'wordpress-user'@'%' IDENTIFIED BY 'wordpress';\nCREATE DATABASE \\`wordpress\\`;\nGRANT ALL PRIVILEGES ON \\`wordpress\\`.*TO\"wordpress-user\"@\"%\";\nFLUSH PRIVILEGES;\nEOF\n```\n\n\u6e96\u5099\u304c\u3067\u304d\u305f\u306e\u3067\u6b21\u306bPHP\u30a2\u30d7\u30ea\u306e\u8a08\u6e2c\u3092\u884c\u3046\u305f\u3081\u306e\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n[PHP agent installation: RedHat and CentOS](https://docs.newrelic.com/docs/agents/php-agent/installation/php-agent-installation-redhat-centos)\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$sudo yum install newrelic-php5\n```\n\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n$sudo newrelic-install install\n```\n\n\u5b9f\u884c\u306e\u9014\u4e2d\u3067\u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u306e\u5165\u529b\u3092\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u5165\u529b\u3057\u307e\u3059\u3002\n\u3053\u308c\u3067\u5b8c\u4e86\u3067\u3059\u3002\n\n\u8a66\u3057\u306bphpinfo\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$sudo vi  /var/www/html/phpinfo.php\n```\n\n```lang:phpinfo.php\n<?php phpinfo(); ?>\n```\n\nhttpd\u306e\u518d\u8d77\u52d5\n\n```\n$sudo service httpd restart\n```\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u78ba\u8a8d\u3059\u308b\u3068\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fPHP\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306a\u3069\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002(http://{Public IP}/phpinfo.php)\n\n\u3053\u306e\u72b6\u614b\u3067NewRelic\u306e\u30b5\u30a4\u30c8\u3092\u898b\u308b\u3068PHP\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u308c\u3060\u3051\u3060\u3068\u9762\u767d\u304f\u7121\u3044\u306e\u3067WordPress\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$sudo yum install -y git\n$cd /var/www/html/\n$sudo git clone https://github.com/WordPress/WordPress.git\n$sudo chown -R apache:apache WordPress\n$sudo chmod -R 744 WordPress\n$sudo service httpd restart\n```\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u307e\u3059\u3002(http://{Public IP}/WordPress)\n\nWordPress\u306e\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n+ \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d->wordpress\n+ \u30e6\u30fc\u30b6\u30fc\u540d->root\n+ \u30d1\u30b9\u30ef\u30fc\u30c9->password\n+ \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30db\u30b9\u30c8\u540d->wordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com\n\n\u8a2d\u5b9a\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\n\nNewRelic\u3067\u306f\u4ee5\u4e0b\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n+ \u30ec\u30b9\u30dd\u30f3\u30b9\u30bf\u30a4\u30e0\n+ Apdex(New Relic\u72ec\u81ea\u6307\u6a19)\n+ \u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\n+ \u30a8\u30e9\u30fc\u7387\n\n![Screen Shot 2015-07-29 at 10.46.43 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/dbbade89-c340-8d8d-6ada-b5e53f793140.png \"Screen Shot 2015-07-29 at 10.46.43 PM.png\")\n\n![Screen Shot 2015-07-29 at 10.46.56 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/639bec28-7f74-0269-8e14-77edc5d76d0f.png \"Screen Shot 2015-07-29 at 10.46.56 PM.png\")\n\n\nApdex(New Relic\u72ec\u81ea\u6307\u6a19)\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306b\u8aac\u660e\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n[New Relic\u3092\u4f7f\u3063\u3066\u308b\u4eba\u306b\u898b\u3066\u6b32\u3057\u3044\u6307\u6a19\u3002\u300cApdex\u300d](http://qiita.com/g08m11/items/70d730593458ae0f1a55)\n\n\u307e\u305f\u3001\u7279\u5b9a\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9078\u629e\u3059\u308b\u3068\u305d\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u4e2d\u3067\u3069\u3053\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u304b\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n![Screen Shot 2015-07-29 at 10.47.38 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/ad6eda70-324b-4675-5764-0fa275af4942.png \"Screen Shot 2015-07-29 at 10.47.38 PM.png\")\n\n![Screen Shot 2015-07-29 at 10.47.57 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/cdeab8d9-77b0-0fa0-d9b7-8acbedd9eb2f.png \"Screen Shot 2015-07-29 at 10.47.57 PM.png\")\n\n\u3053\u308c\u3092\u4f7f\u3048\u3070\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u306e\u691c\u51fa\u306b\u3082\u5f79\u306b\u7acb\u3061\u305d\u3046\u3067\u3059\u306d\u3002\n\n# MySQL\u306e\u8a08\u6e2c\u3092\u884c\u3046\n\n[New Relic\u3067MySQL\u3092\u8a73\u7d30\u306b\u76e3\u8996\u3059\u308b](http://qiita.com/kou/items/0370dde20b74f23709c1)\n\n\u4e0a\u8a18\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\u307e\u305a\u3001MySQL\u306b\u76e3\u8996\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u672c\u4f8b\u3067\u306f **newrelic** \u30e6\u30fc\u30b6\u30fc\u3068\u3057\u3066\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n```\n$mysql -u root -ppassword -h wordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com\nmysql> CREATE USER newrelic@'%' IDENTIFIED BY 'newrelic';\nmysql> GRANT PROCESS,REPLICATION CLIENT ON *.* TO newrelic@'%';\n```\n\n\u6e96\u5099\u304c\u3067\u304d\u305f\u306e\u3067\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\u3044\u304f\u3064\u304b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u304c\u3001New Relic Platform Installer\u3068\u3044\u3046\u306e\u3092\u4f7f\u3063\u3066\u3084\u3063\u3066\u307f\u307e\u3059\u3002\u4e0b\u8a18\u306f\u53c2\u8003\u3002\n\n[newrelic-platform/newrelic_mysql_java_plugin](https://github.com/newrelic-platform/newrelic_mysql_java_plugin)\n\n[Getting Started with the Platform Installer](https://discuss.newrelic.com/t/getting-started-with-the-platform-installer/842)\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\n```\n$LICENSE_KEY=YOUR_KEY_HERE bash -c \"$(curl -sSL https://download.newrelic.com/npi/release/install-npi-linux-redhat-x64.sh)\"\n```\n\n\u4e0a\u8a18\u306b\u3088\u308a\u3001/home/{user}/newrelic-npi\u30d5\u30a9\u30eb\u30c0\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306b\u3088\u308a\u3001MySQL\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\u30b3\u30de\u30f3\u30c9\u5b9f\u884c\u6642\u306b\u8272\u3005\u78ba\u8a8d\u3055\u308c\u307e\u3059\u3002\n\n```\n$cd ~/newrelic-npi/\n$./npi install npi install com.newrelic.plugins.mysql.instance\n```\n\n\u9014\u4e2d\u3067\u3069\u306eDB\u306b\u63a5\u7d9a\u3059\u308b\u304b\u306a\u3069\u306e\u60c5\u5831\u3092\u805e\u304b\u308c\u307e\u3059\u306e\u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\uff08\u8a2d\u5b9a\u306f\u9069\u5b9c\u5909\u66f4\uff09\n\n```\n{\n  \"agents\": [\n    {\n      \"name\"    : \"WordPressDB\",\n      \"host\"    : \"wordpress.cfunxik4b0cn.ap-northeast-1.rds.amazonaws.com\",\n      \"metrics\" : \"status,newrelic\",\n      \"user\"    : \"newrelic\",\n      \"passwd\"  : \"newrelic\"\n    }\n  ]\n}\n```\n\n\u8a2d\u5b9a\u304c\u6b63\u3057\u3051\u308c\u3070NewRelic\u306ePlugin\u30da\u30fc\u30b8\u3067\u8a73\u7d30\u3092\u78ba\u8a8d\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067`/etc/init.d/newrelic_plugin_com.newrelic.plugins.mysql.instance`\u304c\u3067\u304d\u3066\u3044\u308b\u306e\u3067OS\u518d\u8d77\u52d5\u306e\u969b\u306b\u3082\u81ea\u52d5\u3067\u8d77\u52d5\u3059\u308b\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\u306a\u3069\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\n```\n$sudo service newrelic_plugin_com.newrelic.plugins.mysql.instance start\nStarting newrelic_plugin_com.newrelic.plugins.mysql.instance\n```\n\nNewRelic\u3067\u306f\u4ee5\u4e0b\u306b\u3064\u3044\u3066\u78ba\u8a8d\u3067\u304d\u308b\u3088\u3046\u3067\u3057\u305f\u3002\n\n+ SQL\u6570(read\u3068write)\n+ \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\n+ \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\n\n![Screen Shot 2015-07-29 at 10.28.14 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/eb692b2b-257c-3cee-bfd6-9c45b6ae19b1.png \"Screen Shot 2015-07-29 at 10.28.14 PM.png\")\n\n\n![Screen Shot 2015-07-29 at 10.28.23 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/190b4a7b-5be9-b16c-d14e-7ef2353d9c90.png \"Screen Shot 2015-07-29 at 10.28.23 PM.png\")\n\n# httpd\u306e\u8a08\u6e2c\u3082\u884c\u3046\n\n[MeetMe/newrelic-plugin-agent](https://github.com/MeetMe/newrelic-plugin-agent#installation-instructions)\n\nhttpd\u306e\u8a08\u6e2c\u3082\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u4f7f\u3063\u3066\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\u305f\u3060\u3057\u3001MySQL\u30d7\u30e9\u30b0\u30a4\u30f3\u3068\u306f\u5225\u306e\u3084\u308a\u65b9\u306b\u306a\u308b\u3088\u3046\u3067\u3059\u3002\u3002\u3046\u30fc\u3093\u3001\u3053\u308c\u7d71\u4e00\u3055\u308c\u306a\u3044\u306e\u304b\u306a\u3002\u3002\u3002\n\npython\u306epip\u3092\u4f7f\u3046\u307f\u305f\u3044\u3067\u30012.6\u304b2.7\u306e\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n$python -V\nPython 2.7.9\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n```\n# install\n$sudo  pip install newrelic-plugin-agent\n\n# create folder(if it doesn't exsit)\n$sudo mkdir /etc/newrelic\n$sudo mkdir /var/log/newrelic\n$sudo mkdir /var/run/newrelic\n\n# copy config and init.d file\n$sudo cp /opt/newrelic-plugin-agent/newrelic-plugin-agent.cfg /etc/newrelic/\n$sudo cp /opt/newrelic-plugin-agent/newrelic-plugin-agent.rhel /etc/init.d/newrelic-plugin-agent\n$sudo chmod 755 /etc/init.d/newrelic-plugin-agent\n```\n\n\u30c7\u30fc\u30e2\u30f3\u5b9f\u884c\u30e6\u30fc\u30b6\u30fc\u3092root\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001\u30e9\u30a4\u30bb\u30f3\u30b9\u30ad\u30fc\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```lang:/etc/newrelic/newrelic-plugin-agent.cfg\n- license_key: REPLACE_WITH_REAL_KEY\n+ license_key: YOUR_LICENCE_KEY\n\n-  #apache_httpd:\n-  #  name: hostname\n-  #  scheme: http\n-  #  host: localhost\n-  #  verify_ssl_cert: true\n-  #  port: 80\n-  #  path: /server-status\n\n+  apache_httpd:\n+    name: WordPress\n+    scheme: http\n+    host: localhost\n+  #  verify_ssl_cert: true\n+    port: 80\n+    path: /server-status\n```\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3082\u5909\u3048\u307e\u3059\u3002\n\n```lang:/etc/newrelic/newrelic-plugin-agent.cfg\n- APP=\"/usr/bin/newrelic-plugin-agent\"\n+ APP=\"/usr/local/bin/newrelic-plugin-agent\"\n```\n\nApache\u306eserver status page\u306e\u8868\u793a\u3092\u6709\u52b9\u5316\u306b\u3059\u308b\u305f\u3081\u3001httpd\u306e\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u3088\u308a\u8a73\u7d30\u306a\u60c5\u5831\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u306bExtendedStatus\u3092\u6709\u52b9\u5316\u3057\u307e\u3059\u3002ExtendedStatus\u3092\u6709\u52b9\u306b\u3059\u308b\u3068\u30b5\u30fc\u30d0\u30fc\u306e\u52d5\u4f5c\u304c\u9045\u304f\u306a\u308b\u3053\u3068\u3082\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u672c\u756a\u306e\u74b0\u5883\u3067\u3084\u308b\u5834\u5408\u306b\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n```lang:/etc/httpd/conf/httpd.conf\n\n- #ExtendedStatus On\n+ ExtendedStatus On\n\n- #<Location /server-status>\n- #    SetHandler server-status\n- #    Order deny,allow\n- #    Deny from all\n- #    Allow from .example.com\n- #</Location>\n\n+ <Location /server-status>\n+     SetHandler server-status\n+     Order deny,allow\n+     Deny from all\n+     Allow from 127.0.0.1\n+ </Location>\n```\n\nhttpd\u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n$sudo service httpd restart\n```\n\nnewrelic\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n$sudo /etc/init.d/newrelic-plugin-agent start\n```\n\n\u30ed\u30b0\u306f`/var/log/newrelic/newrelic-plugin-agent.log`\u4ee5\u4e0b\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\n\u78ba\u8a8d\u3067\u304d\u308b\u5185\u5bb9\u306f\u4ee5\u4e0b\u306b\u8a18\u8f09\u304c\u3042\u308a\u307e\u3059\u3002\n\n[Apache \u30e2\u30b8\u30e5\u30fc\u30eb mod_status](http://httpd.apache.org/docs/2.2/ja/mod/mod_status.html)\n\n![Screen Shot 2015-07-30 at 10.28.06 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/37a60d7f-1bbe-f9e9-3bc2-8eaee19a5d9f.png)\n\n![Screen Shot 2015-07-30 at 10.28.16 PM.png](https://qiita-image-store.s3.amazonaws.com/0/20193/639c3dcb-fc6a-0d9e-3a3c-3a7268e6c571.png)\n", "tags": ["AWS", "newrelic", "PHP", "MySQL", "Apache"]}