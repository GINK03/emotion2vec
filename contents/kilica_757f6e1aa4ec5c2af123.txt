{"context": " More than 1 year has passed since last update.\nThis work is licensed under a Creative Commons Attribution 2.1 Japan License.\nNote that the code is licensed under GPL 2, according to the XOOPS Cube Legacy's License.\n\nThis post is originally for XOOPS Themes and Templates Advent Calendar 2012 in Japanese.\nWe added and expanded several functions for theme designers and site owners in XOOPS Cube Legacy 2.2.\nI'll introduce them from now.\n\njQuery and jQuery UI\nRecently, many web sites use jQuery and jQuery UI. So XCL 2.2 do, too.\nXCL 2.2 loads jQuery and jQuery UI libraries from the latest Google Hosted Libraries(Google Ajax Feed API).\n\nVersion of jQuery\nAs a default, the latest version of jQuery/jQuery UI is loaded.\n\nLoad the specific version of jQuery/jQuery UI\nAt Admin menu - legacyRender System - General Setting\nYou set the version number you want. As a default, '1' is set. This means the largest version number of 1.x is loaded.\n\njQuery Core Library\njQuery UI Library\n\n\nLoad the local jQuery/jQuery UI file\nAt Admin menu - legacyRender System - General Setting\nSet the library file's URL\n\njQuery Core Library\njQuery UI Library\n\n\nTo add JavaScript and CSS file/script\nModule developers, skilled site owners and designers can add javascript libraries, javascript script and stylesheets into <{$xoops_module_header}> by using Legacy_HeaderScript object.\nIf you are a site owner, you can use preload files to add them.\nEspecially, addScript() method will add your codes in jQuery's $(document).ready().\n\nhtml/preload/sample.class.php\n<?php\nif (!defined('XOOPS_ROOT_PATH')) exit();\n\nclass Sample extends XCube_ActionFilter\n{\n    public function preBlockFilter()\n    {\n        $this->mRoot->mDelegateManager->add('Site.JQuery.AddFunction',array(&$this, 'addScript'));\n    }\n\n    public function addScript(&$jQuery)\n    {\n        $script = XCube_Root::getSingleton->mContext->getAttribute('headerScript');\n        $script->addLibrary('/library/myscript.js');\n        $script->addLibrary('http://mysite.example.com/myscript.js', true);\n        $script->addStylesheet('/library/mystyle.css');\n        $script->addStylesheet('http://mysite.example.com/mystyle.css', true);\n        $script->addScript('$(\".datepicker\").each(function(){$(this).datepicker({dateFormat: \"'._JSDATEPICKSTRING.'\"});});';');\n    }\n}\n?>\n\n\n\n<{xoops_user}> modifier\nSmarty's xoops_user modifier has new option \"user_name\".\n<{$uid|xoops_user:\"user_name\"}>\n\nThis special option call 'Legacy_User.GetUserName' and show its result.\nDo you know why we need such option ? In XOOPS, it has 'uname' field and 'name' field for user's name related fields.\nFor human, 'name' is recognizable but only few users fill this field. On the other hand, 'uname' is unrecognizable but all of users fill this field.\nTo use the following preload file, site owner can show 'name' field value if the user fills this filed and sho 'uname' field value if the user don't fill 'name' field.\n\nextras/extra_preload/UserName.class.php\n<?php\nif (!defined('XOOPS_ROOT_PATH')) exit();\nclass UserName extends XCube_ActionFilter\n{\n     public function preBlockFilter()\n     {\n          $this->mRoot->mDelegateManager->add('Legacy_User.GetUserName',array(&$this, 'get'));\n     }\n\n     public function get(/*** string ***/ &$userName, /*** int ***/ $uid)\n     {\n          $handler = xoops_gethandler('member');\n          $user = $handler->getUser($uid);\n          $name = $user->getShow('name');\n          $userName = $name ? $name : $user->getShow('uname');\n     }\n}\n?>\n\n\n\nSet meta value in html head.\nAdd some of meta values in <head> by using headerScript.\nUse the following preload file.\n\nhtml/preload/mymeta.class.php\n<?php\nif (!defined('XOOPS_ROOT_PATH')) exit();\n\nclass Mymeta extends XCube_ActionFilter\n{\n    public function preBlockFilter()\n    {\n        $this->mRoot->mDelegateManager->add('Site.JQuery.AddFunction',array(&$this, 'addMeta'));\n    }\n\n    public function addMeta(&$jQuery)\n    {\n        $context = XCube_Root::getSingleton()->mContext;\n        if($context->mModule != null) { // The process of module\n            $dirname = $context->xoopsModule->getVar('dirname');\n        }\n\n        $script = $context->getAttribute('headerScript');\n        if($dirname==\"news\") {\n            $script->addMeta('keyword', 'news, info');\n            $script->addMeta('description', 'This module is for news and announcement');\n        }\n        if($dirname==\"schedule\"){\n            $script->addMeta('robots', 'noindex,nofollow');\n        }\n        if($dirname==\"adult\") {\n            $script->addMeta('rating', 'adult');\n        }\n        $script->addMeta('author', 'me');\n        $script->addMeta('copyright', 'me');\n    }\n}\n?>\n\n\n\nAdd language definitions\nThis tips can be applied to XCL 2.1 and 2.2.\nIf you want to add language definition in theme file, you can set new language definitions.\n\nhtml/preload/ThemeLang.class.php\n<?php\ndefine('THEME_LANG_SAMPLE_1', 'This is sample');\ndefine('THEME_LANG_NEWS', 'Site News');\ndefine('THEME_LANG_USERNAME', 'Your Name');\n?>\n\n\nThen, you can write smarty constant in theme/template.\n<div><{$smarty.const.THEME_LANG_SAMPLE_1}></div>\n<div><{$smarty.const.THEME_LANG_NEWS}></div>\n<div><{$smarty.const.THEME_LANG_USERNAME}></div>\n\n![Creative Commons License](http://i.creativecommons.org/l/by/2.1/jp/88x31.png)\nThis work is licensed under a [Creative Commons Attribution 2.1 Japan License](http://creativecommons.org/licenses/by/2.1/jp/).\n\nNote that the code is licensed under GPL 2, according to the XOOPS Cube Legacy's License.\n\n----\n\nThis post is originally for [XOOPS Themes and Templates Advent Calendar 2012](http://qiita.com/advent-calendar/2012/xoops-themes-templates/participants) in Japanese.\n\nWe added and expanded several functions for theme designers and site owners in XOOPS Cube Legacy 2.2.\nI'll introduce them from now.\n\n## jQuery and jQuery UI\nRecently, many web sites use jQuery and jQuery UI. So XCL 2.2 do, too.\nXCL 2.2 loads jQuery and jQuery UI libraries from the latest Google Hosted Libraries(Google Ajax Feed API).\n\n### Version of jQuery\nAs a default, the latest version of jQuery/jQuery UI is loaded.\n\n### Load the specific version of jQuery/jQuery UI\nAt Admin menu - legacyRender System - General Setting\n\nYou set the version number you want. As a default, '1' is set. This means the largest version number of 1.x is loaded.\n\n* jQuery Core Library\n* jQuery UI Library\n\n### Load the local jQuery/jQuery UI file\nAt Admin menu - legacyRender System - General Setting\nSet the library file's URL\n\n* jQuery Core Library\n* jQuery UI Library\n\n## To add JavaScript and CSS file/script\nModule developers, skilled site owners and designers can add javascript libraries, javascript script and stylesheets into `<{$xoops_module_header}>` by using Legacy_HeaderScript object.\nIf you are a site owner, you can use preload files to add them.\nEspecially, addScript() method will add your codes in jQuery's `$(document).ready()`.\n\n```php:html/preload/sample.class.php\n<?php\nif (!defined('XOOPS_ROOT_PATH')) exit();\n\nclass Sample extends XCube_ActionFilter\n{\n    public function preBlockFilter()\n    {\n        $this->mRoot->mDelegateManager->add('Site.JQuery.AddFunction',array(&$this, 'addScript'));\n    }\n\n    public function addScript(&$jQuery)\n    {\n        $script = XCube_Root::getSingleton->mContext->getAttribute('headerScript');\n        $script->addLibrary('/library/myscript.js');\n        $script->addLibrary('http://mysite.example.com/myscript.js', true);\n        $script->addStylesheet('/library/mystyle.css');\n        $script->addStylesheet('http://mysite.example.com/mystyle.css', true);\n        $script->addScript('$(\".datepicker\").each(function(){$(this).datepicker({dateFormat: \"'._JSDATEPICKSTRING.'\"});});';');\n    }\n}\n?>\n```\n\n## <{xoops_user}> modifier\nSmarty's xoops_user modifier has new option \"user_name\".\n\n```\n<{$uid|xoops_user:\"user_name\"}>\n```\n\nThis special option call 'Legacy_User.GetUserName' and show its result.\nDo you know why we need such option ? In XOOPS, it has 'uname' field and 'name' field for user's name related fields.\nFor human, 'name' is recognizable but only few users fill this field. On the other hand, 'uname' is unrecognizable but all of users fill this field.\nTo use the following preload file, site owner can show 'name' field value if the user fills this filed and sho 'uname' field value if the user don't fill 'name' field.\n\n```php:extras/extra_preload/UserName.class.php\n<?php\nif (!defined('XOOPS_ROOT_PATH')) exit();\nclass UserName extends XCube_ActionFilter\n{\n     public function preBlockFilter()\n     {\n          $this->mRoot->mDelegateManager->add('Legacy_User.GetUserName',array(&$this, 'get'));\n     }\n\n     public function get(/*** string ***/ &$userName, /*** int ***/ $uid)\n     {\n          $handler = xoops_gethandler('member');\n          $user = $handler->getUser($uid);\n          $name = $user->getShow('name');\n          $userName = $name ? $name : $user->getShow('uname');\n     }\n}\n?>\n```\n\n## Set meta value in html head.\nAdd some of meta values in `<head>` by using headerScript.\nUse the following preload file.\n\n```php:html/preload/mymeta.class.php\n<?php\nif (!defined('XOOPS_ROOT_PATH')) exit();\n\nclass Mymeta extends XCube_ActionFilter\n{\n    public function preBlockFilter()\n    {\n        $this->mRoot->mDelegateManager->add('Site.JQuery.AddFunction',array(&$this, 'addMeta'));\n    }\n\n    public function addMeta(&$jQuery)\n    {\n        $context = XCube_Root::getSingleton()->mContext;\n        if($context->mModule != null) {\t// The process of module\n            $dirname = $context->xoopsModule->getVar('dirname');\n        }\n\n        $script = $context->getAttribute('headerScript');\n        if($dirname==\"news\") {\n            $script->addMeta('keyword', 'news, info');\n            $script->addMeta('description', 'This module is for news and announcement');\n        }\n        if($dirname==\"schedule\"){\n            $script->addMeta('robots', 'noindex,nofollow');\n        }\n        if($dirname==\"adult\") {\n            $script->addMeta('rating', 'adult');\n        }\n        $script->addMeta('author', 'me');\n        $script->addMeta('copyright', 'me');\n    }\n}\n?>\n```\n\n## Add language definitions\nThis tips can be applied to XCL 2.1 and 2.2.\nIf you want to add language definition in theme file, you can set new language definitions.\n\n```php:html/preload/ThemeLang.class.php\n<?php\ndefine('THEME_LANG_SAMPLE_1', 'This is sample');\ndefine('THEME_LANG_NEWS', 'Site News');\ndefine('THEME_LANG_USERNAME', 'Your Name');\n?>\n```\n\nThen, you can write smarty constant in theme/template.\n\n```\n<div><{$smarty.const.THEME_LANG_SAMPLE_1}></div>\n<div><{$smarty.const.THEME_LANG_NEWS}></div>\n<div><{$smarty.const.THEME_LANG_USERNAME}></div>\n```", "tags": ["XOOPS2.2", "xoopscube2.2", "theme"]}