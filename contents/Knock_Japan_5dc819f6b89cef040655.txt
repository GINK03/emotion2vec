{"context": " More than 1 year has passed since last update.\u304a\u4e16\u8a71\u306b\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\nYahoo!ID\u9023\u643a\u306e\u69cb\u7bc9\u306b\u3064\u3044\u3066\u8cea\u554f\u3067\u3059\u3002\n\u25a0SDK\u3092\u5229\u7528\u3057\u305fPHP\u306b\u3088\u308b\u5c0e\u5165\u65b9\u6cd5\nhttp://developer.yahoo.co.jp/yconnect/server_app/php/\n\u8a18\u8ff0\u901a\u308a\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u62bc\u4e0b\u5f8c\u3001callback.php\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\nAuthorization Code\u3092\u53d6\u5f97\u3092\u53d6\u5f97\u3068\u3042\u308a\u307e\u3059\u304c\u3001\u30a8\u30e9\u30fc\u3067\u53d6\u5f97\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u4e0b\u8a18\u306b\u30b3\u30fc\u30c9\u3092\u8a18\u8f09\u3057\u307e\u3059\u306e\u3067\u3001\u304a\u5206\u304b\u308a\u306e\u65b9\u304c\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u3057\u305f\u3089\u4fee\u6b63\u70b9\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002\nNotice: Undefined variable: state in /var/www/html/fmit-kk.com/admin/callback.php on line 18\nFatal error: Uncaught YConnect\\Exception\\TokenException: not_matched_state ( the state did not match ) thrown in /var/www/html/fmit-kk.com/admin/vendor/yahoojapan/yconnect-php-sdk/lib/YConnect/YConnectClient.php on line 188\n\n\nadmin_header.php\n<span class=\"yconnectLogin\"></span>\n<script type=\"text/javascript\">\n    window.yconnectInit = function() {\n        YAHOO.JP.yconnect.Authorization.init({\n            button: {\n                format: \"image\",\n                type: \"a\",\n                width: 64,\n                height: 36,\n                className: \"yconnectLogin\"\n            },\n            authorization: {\n                clientId: \"app_id\",\n                redirectUri: \"http://fmit-kk.com/admin/callback.php\",\n                scope: \"openid\",\n                state: \"44Oq44Ki5YWF44Gr5L+644Gv44Gq44KL77yB\",\n                nonce: \"5YOV44Go5aWR57SE44GX44GmSUTljqjjgavjgarjgaPjgabjgog=\"\n            },\n            onError: function(res) {\n                // \u30a8\u30e9\u30fc\u767a\u751f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\n            },\n            onCancel: function(res) {\n                // \u540c\u610f\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u305f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\n            }\n        });\n    };\n    (function(){\n    var fs = document.getElementsByTagName(\"script\")[0], s = document.createElement(\"script\");\n    s.setAttribute(\"src\", \"https://s.yimg.jp/images/login/yconnect/auth/1.0.0/auth-min.js\");\n    fs.parentNode.insertBefore(s, fs);\n    })();\n</script>\n\n\n\ncallback.php\n<?php\nini_set( 'display_errors', 1 );\nrequire './vendor/autoload.php';\n\nuse YConnect\\Credential\\ClientCredential;\nuse YConnect\\YConnectClient;\n\n// \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3ID, \u30b7\u30fc\u30af\u30ec\u30c3v\u30c8\n$client_id     = \"app_id\";\n$client_secret = \"\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\";\n$redirect_uri  = \"http://fmit-kk.com/admin/ys_index.php\";\n\n$cred = new ClientCredential( $client_id, $client_secret );\n$client = new YConnectClient( $cred );\n\ntry {\n    // Authorization Code\u3092\u53d6\u5f97\n    $code_result = $client->getAuthorizationCode( $state );\n\n    // Token\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u30ea\u30af\u30a8\u30b9\u30c8\n    $client->requestAccessToken( $redirect_uri, $code_result );\n\n    // \u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3, \u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\n    $access_token  = $client->getAccessToken();\n    $refresh_token = $client->getRefreshToken();\n\n} catch ( TokenException $e ) {\n    // \u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u8a8d\u53ef\u30b3\u30fc\u30c9\u3092\u767a\u884c\u3057\u3066\u304f\u3060\u3055\u3044\n}\necho $access_tokene;\necho $refresh_token;\n\n\n\u304a\u4e16\u8a71\u306b\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\nYahoo!ID\u9023\u643a\u306e\u69cb\u7bc9\u306b\u3064\u3044\u3066\u8cea\u554f\u3067\u3059\u3002\n\n\u25a0SDK\u3092\u5229\u7528\u3057\u305fPHP\u306b\u3088\u308b\u5c0e\u5165\u65b9\u6cd5\nhttp://developer.yahoo.co.jp/yconnect/server_app/php/\n\n\u8a18\u8ff0\u901a\u308a\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u62bc\u4e0b\u5f8c\u3001callback.php\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\nAuthorization Code\u3092\u53d6\u5f97\u3092\u53d6\u5f97\u3068\u3042\u308a\u307e\u3059\u304c\u3001\u30a8\u30e9\u30fc\u3067\u53d6\u5f97\u304c\u3067\u304d\u307e\u305b\u3093\u3002\n\u4e0b\u8a18\u306b\u30b3\u30fc\u30c9\u3092\u8a18\u8f09\u3057\u307e\u3059\u306e\u3067\u3001\u304a\u5206\u304b\u308a\u306e\u65b9\u304c\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u3057\u305f\u3089\u4fee\u6b63\u70b9\u3092\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n```\u30a8\u30e9\u30fc\u5185\u5bb9\nNotice: Undefined variable: state in /var/www/html/fmit-kk.com/admin/callback.php on line 18\nFatal error: Uncaught YConnect\\Exception\\TokenException: not_matched_state ( the state did not match ) thrown in /var/www/html/fmit-kk.com/admin/vendor/yahoojapan/yconnect-php-sdk/lib/YConnect/YConnectClient.php on line 188\n```\n\n```php:admin_header.php\n<span class=\"yconnectLogin\"></span>\n<script type=\"text/javascript\">\n\twindow.yconnectInit = function() {\n\t\tYAHOO.JP.yconnect.Authorization.init({\n\t\t\tbutton: {\n\t\t\t\tformat: \"image\",\n\t\t\t\ttype: \"a\",\n\t\t\t\twidth: 64,\n\t\t\t\theight: 36,\n\t\t\t\tclassName: \"yconnectLogin\"\n\t\t\t},\n\t\t\tauthorization: {\n\t\t\t\tclientId: \"app_id\",\n\t\t\t\tredirectUri: \"http://fmit-kk.com/admin/callback.php\",\n\t\t\t\tscope: \"openid\",\n\t\t\t\tstate: \"44Oq44Ki5YWF44Gr5L+644Gv44Gq44KL77yB\",\n\t\t\t\tnonce: \"5YOV44Go5aWR57SE44GX44GmSUTljqjjgavjgarjgaPjgabjgog=\"\n\t\t\t},\n\t\t\tonError: function(res) {\n\t\t\t\t// \u30a8\u30e9\u30fc\u767a\u751f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\n\t\t\t},\n\t\t\tonCancel: function(res) {\n\t\t\t\t// \u540c\u610f\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u305f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\n\t\t\t}\n\t\t});\n\t};\n\t(function(){\n\tvar fs = document.getElementsByTagName(\"script\")[0], s = document.createElement(\"script\");\n\ts.setAttribute(\"src\", \"https://s.yimg.jp/images/login/yconnect/auth/1.0.0/auth-min.js\");\n\tfs.parentNode.insertBefore(s, fs);\n\t})();\n</script>\n```\n```php:callback.php\n<?php\nini_set( 'display_errors', 1 );\nrequire './vendor/autoload.php';\n\nuse YConnect\\Credential\\ClientCredential;\nuse YConnect\\YConnectClient;\n \n// \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3ID, \u30b7\u30fc\u30af\u30ec\u30c3v\u30c8\n$client_id     = \"app_id\";\n$client_secret = \"\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\";\n$redirect_uri  = \"http://fmit-kk.com/admin/ys_index.php\";\n \n$cred = new ClientCredential( $client_id, $client_secret );\n$client = new YConnectClient( $cred );\n \ntry {\n    // Authorization Code\u3092\u53d6\u5f97\n    $code_result = $client->getAuthorizationCode( $state );\n\n    // Token\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u30ea\u30af\u30a8\u30b9\u30c8\n    $client->requestAccessToken( $redirect_uri, $code_result );\n \n    // \u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3, \u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\n    $access_token  = $client->getAccessToken();\n    $refresh_token = $client->getRefreshToken();\n \n} catch ( TokenException $e ) {\n    // \u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u8a8d\u53ef\u30b3\u30fc\u30c9\u3092\u767a\u884c\u3057\u3066\u304f\u3060\u3055\u3044\n}\necho $access_tokene;\necho $refresh_token;\n```\n\n", "tags": ["ydnjp", "Yahoo!ID\u9023\u643a"]}