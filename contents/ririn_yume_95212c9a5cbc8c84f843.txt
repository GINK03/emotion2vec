{"context": " More than 1 year has passed since last update.\u307b\u3068\u3093\u3069\u66f8\u6368\u3066(Write Only)\u306b\u8fd1\u3044\u3051\u308c\u3069\u30ab\u30ec\u30f3\u30c0\u30fc\u3089\u3057\u304d\u3082\u306e\u3092\u66f8\u3044\u305f\u3002\n\u304b\u306a\u308a\u5b8c\u6210\u5ea6\u306f\u4f4e\u3044(-\uff3f-\uff1b)\n\u5b9f\u884c\u7d50\u679c\n\nOption Explicit\n\nDim dt As Date\nDim last As Integer\nConst start_day As Integer = 1\nConst limit As Integer = 8\n\nPrivate Static Sub main()\n\n    Dim tmp As Range\n    Set tmp = Worksheets(Me.name).Range(\"A1\")\n    Dim remain As Integer\n\n    remain = 0\n\n    Call init\n    Call this_month_end\n\n    remain = print_week(tmp, 1, first_weekday(), limit - first_weekday(), 0)\n    remain = print_week(tmp, 3, vbSunday, vbSaturday, remain)\n    remain = print_week(tmp, 5, vbSunday, vbSaturday, remain)\n    remain = print_week(tmp, 7, vbSunday, vbSaturday, remain)\n    remain = print_week(tmp, 9, vbSunday, vbSaturday, remain)\n\nEnd Sub\n\nPrivate Sub init()\n    dt = 0\n    last = 0\n\nEnd Sub\n\nPrivate Sub this_month_end()\n    Const pre As Double = -1\n    ' \u6b21\u6708\u306e\u672b\u65e5\n    dt = DateSerial(Year(Date), Month(Date) + 1, start_day)\n    ' \u4eca\u6708\u306e\u6708\u672b\u306e\u65e5\u4ed8\n    dt = DateAdd(\"d\", pre, dt)\n    ' \u65e5\u306e\u307f\u62bd\u51fa\n    last = day(dt)\nEnd Sub\n\nFunction first_weekday() As Integer\n    Dim wk As Date\n\n    ' \u6708\u521d\u306e\u66dc\u65e5\u53d6\u5f97\n    wk = DateSerial(Year(Date), Month(Date), start_day)\n\n    ' \u65e5\u306e\u307f\u62bd\u51fa\u3057\u3066\u8fd4\u3059\n    first_weekday = Weekday(wk)\n\nEnd Function\n\n' \u7b2cn\u9031\u3092\u8868\u793a\nFunction print_week(ByVal place As Range, ByVal row_step As Integer, ByRef start_pos As Integer, ByRef end_pos As Integer, ByVal day_val As Integer) As Integer\n    Dim i As Integer\n    Dim day_remain As Integer\n\n    day_remain = day_val\n\n    i = 0\n    Do While i < end_pos\n        place(row_step, start_pos + i).Value = incr(day_remain)\n        i = i + 1\n    Loop\n\n     print_week = day_remain\n\nEnd Function\n\n' \u5024\u306e\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\nFunction incr(ByRef dd As Integer)\n    dd = dd + 1\n\n    If dd > last Then\n        Exit Function\n    End If\n\n    incr = dd\nEnd Function\n\n\u307b\u3068\u3093\u3069\u66f8\u6368\u3066(Write Only)\u306b\u8fd1\u3044\u3051\u308c\u3069\u30ab\u30ec\u30f3\u30c0\u30fc\u3089\u3057\u304d\u3082\u306e\u3092\u66f8\u3044\u305f\u3002\n\u304b\u306a\u308a\u5b8c\u6210\u5ea6\u306f\u4f4e\u3044(-\uff3f-\uff1b)\n\n\u5b9f\u884c\u7d50\u679c\n![cal.PNG](https://qiita-image-store.s3.amazonaws.com/0/36817/dc145ee4-49bd-a767-ded8-ad3a3e34a1e0.png)\n\n\n```vbnet\nOption Explicit\n\nDim dt As Date\nDim last As Integer\nConst start_day As Integer = 1\nConst limit As Integer = 8\n\nPrivate Static Sub main()\n    \n    Dim tmp As Range\n    Set tmp = Worksheets(Me.name).Range(\"A1\")\n    Dim remain As Integer\n\n    remain = 0\n\n    Call init\n    Call this_month_end\n\n    remain = print_week(tmp, 1, first_weekday(), limit - first_weekday(), 0)\n    remain = print_week(tmp, 3, vbSunday, vbSaturday, remain)\n    remain = print_week(tmp, 5, vbSunday, vbSaturday, remain)\n    remain = print_week(tmp, 7, vbSunday, vbSaturday, remain)\n    remain = print_week(tmp, 9, vbSunday, vbSaturday, remain)\n   \nEnd Sub\n\nPrivate Sub init()\n    dt = 0\n    last = 0\n\nEnd Sub\n\nPrivate Sub this_month_end()\n    Const pre As Double = -1\n    ' \u6b21\u6708\u306e\u672b\u65e5\n    dt = DateSerial(Year(Date), Month(Date) + 1, start_day)\n    ' \u4eca\u6708\u306e\u6708\u672b\u306e\u65e5\u4ed8\n    dt = DateAdd(\"d\", pre, dt)\n    ' \u65e5\u306e\u307f\u62bd\u51fa\n    last = day(dt)\nEnd Sub\n\nFunction first_weekday() As Integer\n    Dim wk As Date\n\n    ' \u6708\u521d\u306e\u66dc\u65e5\u53d6\u5f97\n    wk = DateSerial(Year(Date), Month(Date), start_day)\n\n    ' \u65e5\u306e\u307f\u62bd\u51fa\u3057\u3066\u8fd4\u3059\n    first_weekday = Weekday(wk)\n    \nEnd Function\n\n' \u7b2cn\u9031\u3092\u8868\u793a\nFunction print_week(ByVal place As Range, ByVal row_step As Integer, ByRef start_pos As Integer, ByRef end_pos As Integer, ByVal day_val As Integer) As Integer\n    Dim i As Integer\n    Dim day_remain As Integer\n\n    day_remain = day_val\n\n    i = 0\n    Do While i < end_pos\n        place(row_step, start_pos + i).Value = incr(day_remain)\n        i = i + 1\n    Loop\n\n     print_week = day_remain\n\nEnd Function\n\n' \u5024\u306e\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\nFunction incr(ByRef dd As Integer)\n    dd = dd + 1\n    \n    If dd > last Then\n        Exit Function\n    End If\n\n    incr = dd\nEnd Function\n```\n", "tags": ["VBA"]}