{"context": "\n\n\u306f\u3058\u3081\u306b\n\u3053\u306e\u8a18\u4e8b\u306f\u9ad8\u77e5\u5de5\u79d1\u5927 Advent Calendar 2016\u306e11\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u5148\u65e5 YAMAHA RTX1210\u3092\u885d\u52d5\u8cb7\u3044\u3057\u305f\u306e\u3067\u3001VyOS\u3068\u7d44\u307f\u5408\u308f\u305b\u3066OSPF\u3092\u69cb\u7bc9\u3059\u308b\u30c6\u30b9\u30c8\u3092\u884c\u3044\u307e\u3057\u305f\u3002\n\nOSPF\u3068\u306f\uff1f\nOSPF\u306fOpen Shortest Path First\u306e\u7565\u3067\u3001\u30ea\u30f3\u30af\u30b9\u30c6\u30fc\u30c8\u65b9\u5f0f\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5c64\u3067\u52d5\u4f5c\u3057\u307e\u3059\u3002\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u30e1\u30c8\u30ea\u30c3\u30af\u306b\u30b3\u30b9\u30c8\u5024\u3092\u7528\u3044\u3066\u3044\u3066\u3001\u5e2f\u57df\u5e45\u306a\u3069\u306b\u5fdc\u3058\u3066\u6700\u9069\u306a\u7d4c\u8def\u3092\u9078\u629e\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u7d4c\u8def\u53ce\u675f\u304c\u9ad8\u901f\u3001\u30a8\u30ea\u30a2\u3054\u3068\u306b\u5206\u3051\u308b\u3053\u3068\u3067\u5927\u898f\u6a21\u306a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5bfe\u5fdc\u3067\u304d\u308b\u3001\u306a\u3069\u306e\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u6210\n\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a\u69cb\u6210\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u5b9f\u9a13\u3057\u307e\u3059\u3002\u5168\u90e8\u3092\u30a8\u30ea\u30a20(backbone)\u3068\u3057\u3066\u3001\u30b3\u30b9\u30c8\u5024\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u306e\u307e\u307e\u884c\u3044\u307e\u3059\u3002\n\u56f3\u4e0b\u90e8\u5206\u306e192.168.36.0/24\u3068192.168.50.0/24\u9593\u3092OSPF\u3067\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3059\u308b\u306e\u304c\u76ee\u7684\u3067\u3059\u3002\n\n\n\u69cb\u7bc9\n\u5404\u30eb\u30fc\u30bf\u306b\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\nRTX1210.config\nip lan1/1 address 192.168.36.1/24\nip lan1/5 address 192.168.40.1/30\nospf use on\nospf area backbone\nip lan1/1 ospf area backbone\nip lan1/5 ospf area backbone\nospf configure refresh\n\n\n\nVyOS-A\u30ce\u30fc\u30c9.config\nset interfaces ethernet eth0 address '192.168.40.2/30'\nset interfaces ethernet eth1 address '192.168.40.5/30'\nset interfaces loopback lo address 1.1.1.1/32\nset protocols ospf area 0 network 192.168.0.0/16\nset protocols ospf parameters router-id 1.1.1.1\n\n\n\nVyOS-B\u30ce\u30fc\u30c9.config\nset interfaces ethernet eth0 address '192.168.40.6/30'\nset interfaces ethernet eth1 address '192.168.50.1/24'\nset interfaces loopback lo address 2.2.2.2/32\nset protocols ospf area 0 network 192.168.0.0/16\nset protocols ospf parameters router-id 2.2.2.2\n\n\n\n\u69cb\u7bc9\u7d50\u679c\nOSPF\u304c\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u3066\u3044\u308c\u3070\u3001RTX1210 \u3067show ip route\u306e\u30b3\u30de\u30f3\u30c9\u3067\u4ee5\u4e0b\u306e\u69d8\u306bOSPF\u306b\u3088\u308b\u7d4c\u8def\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\nRTX1210\n> show ip route\n\u5b9b\u5148\u30cd\u30c3\u30c8\u30ef\u30fc\u30af    \u30b2\u30fc\u30c8\u30a6\u30a7\u30a4     \u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9  \u7a2e\u5225         \u4ed8\u52a0\u60c5\u5831\n192.168.36.0/24     192.168.36.1         LAN1/1  implicit\n192.168.40.0/30     192.168.40.1         LAN1/5  implicit\n192.168.40.4/30     192.168.40.2         LAN1/5      OSPF     cost=11\n192.168.50.0/24     192.168.40.2         LAN1/5      OSPF     cost=21\n\n\n\u3053\u308c\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u56f3\u4e0b\u90e8\u5206\u306e192.168.36.0/24\u3068192.168.50.0/24\u3067\u901a\u4fe1\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\u8a66\u3057\u306b192.168.50.10\u306ePC\u3092\u7528\u610f\u3057\u3001192.168.36.0/24\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089tracert 192.168.50.10\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n>tracert 192.168.50.10\n\n192.168.50.10 \u3078\u306e\u30eb\u30fc\u30c8\u3092\u30c8\u30ec\u30fc\u30b9\u3057\u3066\u3044\u307e\u3059\u3002\u7d4c\u7531\u3059\u308b\u30db\u30c3\u30d7\u6570\u306f\u6700\u5927 30 \u3067\u3059\n\n  1    <1 ms    <1 ms    <1 ms  192.168.36.1\n  2    <1 ms    <1 ms    <1 ms  192.168.40.2\n  3     1 ms     1 ms     1 ms  192.168.40.6\n  4     3 ms     2 ms     1 ms  192.168.50.10\n\n\u30c8\u30ec\u30fc\u30b9\u3092\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\n\nOSPF\u3092\u8a2d\u5b9a\u3057\u305f\u30eb\u30fc\u30bf\u9054\u3092\u7d4c\u7531\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3057\u305f\uff01\n\n\u6700\u5f8c\u306b\nVyOS\u306f\u7121\u6599\u3067\u4f7f\u3048\u308b\u306e\u3067\u3001\u4f59\u3063\u3066\u308bPC\u3084\u4eee\u60f3\u30b5\u30fc\u30d0\u304c\u3042\u308c\u3070\u7c21\u5358\u306b\u9ad8\u6a5f\u80fd\u306a\u30eb\u30fc\u30bf\u3092\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3002\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u52c9\u5f37\u3057\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u308b\u65b9\u306b\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n#\u306f\u3058\u3081\u306b\n**\u3053\u306e\u8a18\u4e8b\u306f[\u9ad8\u77e5\u5de5\u79d1\u5927 Advent Calendar 2016](http://www.adventar.org/calendars/1872)\u306e11\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002**\n\u5148\u65e5 [YAMAHA RTX1210](http://jp.yamaha.com/products/network/routers/rtx1210/)\u3092\u885d\u52d5\u8cb7\u3044\u3057\u305f\u306e\u3067\u3001[VyOS](http://vyos.io/)\u3068\u7d44\u307f\u5408\u308f\u305b\u3066OSPF\u3092\u69cb\u7bc9\u3059\u308b\u30c6\u30b9\u30c8\u3092\u884c\u3044\u307e\u3057\u305f\u3002\n#OSPF\u3068\u306f\uff1f\nOSPF\u306fOpen Shortest Path First\u306e\u7565\u3067\u3001\u30ea\u30f3\u30af\u30b9\u30c6\u30fc\u30c8\u65b9\u5f0f\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5c64\u3067\u52d5\u4f5c\u3057\u307e\u3059\u3002\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u30e1\u30c8\u30ea\u30c3\u30af\u306b\u30b3\u30b9\u30c8\u5024\u3092\u7528\u3044\u3066\u3044\u3066\u3001\u5e2f\u57df\u5e45\u306a\u3069\u306b\u5fdc\u3058\u3066\u6700\u9069\u306a\u7d4c\u8def\u3092\u9078\u629e\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u7d4c\u8def\u53ce\u675f\u304c\u9ad8\u901f\u3001\u30a8\u30ea\u30a2\u3054\u3068\u306b\u5206\u3051\u308b\u3053\u3068\u3067\u5927\u898f\u6a21\u306a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5bfe\u5fdc\u3067\u304d\u308b\u3001\u306a\u3069\u306e\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n#\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u6210\n\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306a\u69cb\u6210\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u5b9f\u9a13\u3057\u307e\u3059\u3002\u5168\u90e8\u3092\u30a8\u30ea\u30a20(backbone)\u3068\u3057\u3066\u3001\u30b3\u30b9\u30c8\u5024\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u306e\u307e\u307e\u884c\u3044\u307e\u3059\u3002\n\u56f3\u4e0b\u90e8\u5206\u306e`192.168.36.0/24`\u3068`192.168.50.0/24`\u9593\u3092OSPF\u3067\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3059\u308b\u306e\u304c\u76ee\u7684\u3067\u3059\u3002\n![ADC2016-11.jpg](https://qiita-image-store.s3.amazonaws.com/0/106927/d3d8095a-2c7f-b1d2-8c43-3567943142f4.jpeg)\n\n#\u69cb\u7bc9\n\u5404\u30eb\u30fc\u30bf\u306b\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n```:RTX1210.config\nip lan1/1 address 192.168.36.1/24\nip lan1/5 address 192.168.40.1/30\nospf use on\nospf area backbone\nip lan1/1 ospf area backbone\nip lan1/5 ospf area backbone\nospf configure refresh\n```\n\n```:VyOS-A\u30ce\u30fc\u30c9.config\nset interfaces ethernet eth0 address '192.168.40.2/30'\nset interfaces ethernet eth1 address '192.168.40.5/30'\nset interfaces loopback lo address 1.1.1.1/32\nset protocols ospf area 0 network 192.168.0.0/16\nset protocols ospf parameters router-id 1.1.1.1\n```\n\n```:VyOS-B\u30ce\u30fc\u30c9.config\nset interfaces ethernet eth0 address '192.168.40.6/30'\nset interfaces ethernet eth1 address '192.168.50.1/24'\nset interfaces loopback lo address 2.2.2.2/32\nset protocols ospf area 0 network 192.168.0.0/16\nset protocols ospf parameters router-id 2.2.2.2\n```\n\n#\u69cb\u7bc9\u7d50\u679c\nOSPF\u304c\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u3066\u3044\u308c\u3070\u3001RTX1210 \u3067`show ip route`\u306e\u30b3\u30de\u30f3\u30c9\u3067\u4ee5\u4e0b\u306e\u69d8\u306b**OSPF**\u306b\u3088\u308b\u7d4c\u8def\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\n```:RTX1210\n> show ip route\n\u5b9b\u5148\u30cd\u30c3\u30c8\u30ef\u30fc\u30af    \u30b2\u30fc\u30c8\u30a6\u30a7\u30a4     \u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9  \u7a2e\u5225         \u4ed8\u52a0\u60c5\u5831\n192.168.36.0/24     192.168.36.1         LAN1/1  implicit\n192.168.40.0/30     192.168.40.1         LAN1/5  implicit\n192.168.40.4/30     192.168.40.2         LAN1/5      OSPF     cost=11\n192.168.50.0/24     192.168.40.2         LAN1/5      OSPF     cost=21\n```\n\u3053\u308c\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u56f3\u4e0b\u90e8\u5206\u306e`192.168.36.0/24`\u3068`192.168.50.0/24`\u3067\u901a\u4fe1\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\u8a66\u3057\u306b`192.168.50.10`\u306ePC\u3092\u7528\u610f\u3057\u3001`192.168.36.0/24`\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304b\u3089`tracert 192.168.50.10`\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n>tracert 192.168.50.10\n\n192.168.50.10 \u3078\u306e\u30eb\u30fc\u30c8\u3092\u30c8\u30ec\u30fc\u30b9\u3057\u3066\u3044\u307e\u3059\u3002\u7d4c\u7531\u3059\u308b\u30db\u30c3\u30d7\u6570\u306f\u6700\u5927 30 \u3067\u3059\n\n  1    <1 ms    <1 ms    <1 ms  192.168.36.1\n  2    <1 ms    <1 ms    <1 ms  192.168.40.2\n  3     1 ms     1 ms     1 ms  192.168.40.6\n  4     3 ms     2 ms     1 ms  192.168.50.10\n\n\u30c8\u30ec\u30fc\u30b9\u3092\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\n```\nOSPF\u3092\u8a2d\u5b9a\u3057\u305f\u30eb\u30fc\u30bf\u9054\u3092\u7d4c\u7531\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3057\u305f\uff01\n#\u6700\u5f8c\u306b\nVyOS\u306f\u7121\u6599\u3067\u4f7f\u3048\u308b\u306e\u3067\u3001\u4f59\u3063\u3066\u308bPC\u3084\u4eee\u60f3\u30b5\u30fc\u30d0\u304c\u3042\u308c\u3070\u7c21\u5358\u306b\u9ad8\u6a5f\u80fd\u306a\u30eb\u30fc\u30bf\u3092\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3002\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u52c9\u5f37\u3057\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u308b\u65b9\u306b\u30aa\u30b9\u30b9\u30e1\u3067\u3059\u3002\n", "tags": ["yamaha", "rtx1210", "VyOS1.1.7"]}