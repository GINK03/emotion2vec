{"context": " More than 1 year has passed since last update.Docker\u30b3\u30f3\u30c6\u30ca\u306e\u30ed\u30b0\u3092fluentd\u3067\u6271\u3046\u6642\u306b\u3001\u4eca\u307e\u3067/var/lib/docker/container\u4ee5\u4e0b\u3092\u307f\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001\u306a\u3093\u304b\u5acc\u3060\u306a\u30fc\u3068\u601d\u3063\u3066\u3044\u305f\u3089\u3002Docker\u306bfluentd\u7528\u306eLoggind Driver\u304c\u8ffd\u52a0\u3055\u308c\u305f\u306e\u3067\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nDocker v1.8\u304b\u3089\u4f7f\u3048\u308b\u307f\u305f\u3044\u3067\u3059\u306d\u3002\u3068\u308a\u3042\u3048\u305a\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u307e\u3059\u3002\nsudo apt-get update\nsudo apt-get install lxc-docker\n\n\u3061\u306a\u307f\u306b\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u3053\u3061\u3089\nhttp://www.fluentd.org/guides/recipes/docker-logging\n\u3042\u3093\u307e\u308afluentd\u5074\u306e\u66f8\u304d\u65b9\u306f\u6163\u308c\u3066\u306a\u3044\u306e\u3067\u3059\u304c\u3002td-agent.conf\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002log-collector.hoge.com\u306f\u4eee\u306e\u30ed\u30b0\u96c6\u7d04\u30b5\u30fc\u30d0\u306e\u30db\u30b9\u30c8\u3067\u3059\u3002\n<source>\n    type forward\n    port 24224\n    bind 0.0.0.0\n</source>\n<match docker.**>\n    type forward\n    <server>\n      host logs.hoge.com\n      port 24224\n    </server>\n</match>\n\nDocker\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b--log-driver\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u52a0\u3048\u307e\u3059\u3002\ndocker run --log-driver=fluentd {\u30a4\u30e1\u30fc\u30b8\u540d}\n\n\u3053\u308c\u3067\u3001logs.hoge.com\uff08\u96c6\u7d04\u30b5\u30fc\u30d0\uff09\u306b\u30b3\u30f3\u30c6\u30ca\u306e\u30ed\u30b0\u304c\u9001\u3089\u308c\u307e\u3059\u3002\n\u3053\u3093\u306a\u611f\u3058\n{\"log\":\"log content\",\"container_id\":\"f7d520f14333a16144748a44c0d0aa2c442b73d6d97a8335ed3b47b7852fa92d\",\"container_name\":\"/test\",\"source\":\"stdout\"}\n\ndocker logs\u30b3\u30de\u30f3\u30c9\u306f\u4f7f\u3048\u306a\u304f\u306a\u308b\u307f\u305f\u3044\u3067\u3059\u306d\u3002\n--log-driver\u3067\u306f\u4ed6\u306b\u3001json-file\u3001syslog\u3001journald\u3001gelf\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\nhttps://docs.docker.com/v1.8/reference/logging/overview/\n\n\u53c2\u8003\nhttp://www.fluentd.org/guides/recipes/docker-logging\nhttp://dev.classmethod.jp/cloud/docker-fluentd-logging-driver/\nDocker\u30b3\u30f3\u30c6\u30ca\u306e\u30ed\u30b0\u3092fluentd\u3067\u6271\u3046\u6642\u306b\u3001\u4eca\u307e\u3067/var/lib/docker/container\u4ee5\u4e0b\u3092\u307f\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001\u306a\u3093\u304b\u5acc\u3060\u306a\u30fc\u3068\u601d\u3063\u3066\u3044\u305f\u3089\u3002Docker\u306bfluentd\u7528\u306eLoggind Driver\u304c\u8ffd\u52a0\u3055\u308c\u305f\u306e\u3067\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nDocker v1.8\u304b\u3089\u4f7f\u3048\u308b\u307f\u305f\u3044\u3067\u3059\u306d\u3002\u3068\u308a\u3042\u3048\u305a\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u307e\u3059\u3002\n\n```\nsudo apt-get update\nsudo apt-get install lxc-docker\n```\n\n\u3061\u306a\u307f\u306b\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f\u3053\u3061\u3089\nhttp://www.fluentd.org/guides/recipes/docker-logging\n\n\u3042\u3093\u307e\u308afluentd\u5074\u306e\u66f8\u304d\u65b9\u306f\u6163\u308c\u3066\u306a\u3044\u306e\u3067\u3059\u304c\u3002td-agent.conf\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002log-collector.hoge.com\u306f\u4eee\u306e\u30ed\u30b0\u96c6\u7d04\u30b5\u30fc\u30d0\u306e\u30db\u30b9\u30c8\u3067\u3059\u3002\n\n```xml\n<source>\n    type forward\n    port 24224\n    bind 0.0.0.0\n</source>\n<match docker.**>\n    type forward\n    <server>\n      host logs.hoge.com\n      port 24224\n    </server>\n</match>\n```\n\nDocker\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306b--log-driver\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u52a0\u3048\u307e\u3059\u3002\n\n```sh\ndocker run --log-driver=fluentd {\u30a4\u30e1\u30fc\u30b8\u540d}\n```\n\n\u3053\u308c\u3067\u3001logs.hoge.com\uff08\u96c6\u7d04\u30b5\u30fc\u30d0\uff09\u306b\u30b3\u30f3\u30c6\u30ca\u306e\u30ed\u30b0\u304c\u9001\u3089\u308c\u307e\u3059\u3002\n\n\u3053\u3093\u306a\u611f\u3058\n\n```\n{\"log\":\"log content\",\"container_id\":\"f7d520f14333a16144748a44c0d0aa2c442b73d6d97a8335ed3b47b7852fa92d\",\"container_name\":\"/test\",\"source\":\"stdout\"}\n```\n\n\n```docker logs```\u30b3\u30de\u30f3\u30c9\u306f\u4f7f\u3048\u306a\u304f\u306a\u308b\u307f\u305f\u3044\u3067\u3059\u306d\u3002\n\n--log-driver\u3067\u306f\u4ed6\u306b\u3001json-file\u3001syslog\u3001journald\u3001gelf\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\nhttps://docs.docker.com/v1.8/reference/logging/overview/\n\n### \u53c2\u8003\n\nhttp://www.fluentd.org/guides/recipes/docker-logging\nhttp://dev.classmethod.jp/cloud/docker-fluentd-logging-driver/\n", "tags": ["docker", "fluentd"]}