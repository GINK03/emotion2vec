{"context": "\u30ae\u30e3\u30e9\u30ea\u30fc\u304b\u3089\u753b\u50cf\u3092\u307e\u3068\u3081\u3066\u8868\u793a\u3057\u305f\u3044\u5834\u5408\u3001ContentResolver\u3092\u4f7f\u3063\u3066\u753b\u50cf\u306eThumbnails\u60c5\u5831\u3092\u53d6\u3063\u3066\u304d\u3066\u8868\u793a\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u304c\u3001\u6ce8\u610f\u3059\u3079\u304d\u70b9\u3068\u3057\u3066\u3001Thumbnails\u753b\u50cf\u306b\u306f\u56de\u8ee2\u60c5\u5831\u304c\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u7aef\u672b\u306e\u6a5f\u7a2e\u306b\u3088\u3063\u3066\u306f\u7e26\u6a2a\u306e\u8868\u793a\u304c\u304a\u304b\u3057\u304f\u306a\u308b\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\n\u5177\u4f53\u7684\u306b\u306fGalaxy S4\u4ee5\u964d\u3067\u306f\u7e26\u9577\u753b\u50cf\u304c\u6a2a\u5411\u304d\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u73fe\u8c61\u304c\u78ba\u8a8d\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u89e3\u6c7a\u65b9\u6cd5\nContentResolver\u306e MediaStore.Images.Media._ID \u3068 MediaStore.Images.Thumbnails.IMAGE_ID\u304c\u540c\u3058\u3053\u3068\u3092\u5229\u7528\u3057\u3001MediaStore.Images.Media\u306e\u56de\u8ee2\u60c5\u5831\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u8868\u793a\u3059\u308b\u969b\u306f\u3053\u306e\u56de\u8ee2\u60c5\u5831\u3092\u5143\u306bbitmap\u3092\u56de\u8ee2\u3057\u3066\u8868\u793a\u3057\u3066\u3042\u3052\u307e\u3059\u3002Picasso\u3084Glide\u3092\u4f7f\u3048\u3070\u753b\u50cf\u56de\u8ee2\u3092\u3088\u308d\u3057\u304f\u3084\u3063\u3066\u304f\u308c\u308b(\u3068\u3001\u3044\u3046\u304bPicasso\u3067\u306f\u5185\u90e8\u7684\u306bMediaStore.Images\u306e\u56de\u8ee2\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u69cb\u304c\u3042\u308b\u3063\u307d\u3044)\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4eca\u56de\u306f\u5272\u611b\u3057\u307e\u3059\u3002\n\nCursorJoiner\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\n\u4e00\u81f4\u3059\u308bMediaStore.Images.Media._ID \u3068 MediaStore.Images.Thumbnails.IMAGE_ID\u3092\u62bd\u51fa\u3059\u308b\u306b\u306fCursorJoiner\u3092\u4f7f\u3044\u307e\u3059\u3002\nCursorJoiner\u306f\u305d\u306e\u540d\u306e\u901a\u308aCursor\u3092join\u3057\u307e\u3059\u3002\u5185\u90e8\u7684\u306b\u306f\uff12\u3064\u306eCursor\u3092\u6bd4\u8f03\u3057\u3001\u4e00\u81f4\u3059\u308b\u9805\u76ee\u304c\u51fa\u3066\u304f\u308b\u307e\u3067\u305d\u308c\u305e\u308c\u306eCursor\u3092\u9806\u306b\u9032\u3081\u3066\u3044\u304f\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u305f\u3060\u3057String\u578b\u3067\u3057\u304b\u6bd4\u8f03\u3057\u3066\u304f\u308c\u307e\u305b\u3093\u3002\u305d\u306e\u305f\u3081\u3001ID\u306eint\u578b\u3067\u3082\u5bfe\u5fdc\u3067\u304d\u308b\u3088\u3046\u306bCursorJoiner\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u307e\u3059\u3002\u5b9f\u88c5\u65b9\u6cd5\u306f\u3053\u3053\u306e\u30d6\u30ed\u30b0(\u306a\u3093\u30685\u5e74\u524d\uff01)\u306b\u3082\u66f8\u3044\u3066\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u5199\u771f\u306e\u4e00\u89a7\u306e\u5834\u5408\u65b0\u3057\u3044\u3082\u306e\u3092\u5148\u982d\u306b\u6301\u3063\u3066\u304d\u305f\u3044\u306e\u3067\u964d\u9806(DESC)\u3067\u6bd4\u8f03\u3067\u304d\u308b\u3088\u3046\u306b\u5de5\u592b\u3057\u307e\u3059\u3002\n\u5b9f\u969b\u306e\u5b9f\u88c5\u306fGist\u306b\u8cbc\u3063\u3066\u3044\u307e\u3059\u3002\n\u5909\u66f4\u70b9\u3092\u304b\u3044\u3064\u307e\u3093\u3067\u66f8\u304f\u3068\n(1)\u578b\u3068\u6bd4\u8f03\u9806\u5e8f\u306b\u95a2\u3059\u308benum\u8ffd\u52a0\n/**\n * The type of column to join\n */\npublic enum JoinColumnType {\n    STRING,\n    INT\n}\n/**\n * Order\n */\npublic enum OrderType {\n    ASC, DESC;\n}\n\n//\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5185\n        mType = type;\n        switch (mType) {\n            case STRING:\n                mStringValues = new String[mColumnsLeft.length * 2];\n                break;\n            case INT:\n                mIntValues = new int[mColumnsLeft.length * 2];\n        }\n\n        sOrderType = orderType;\n\n(2) \u578b\u306b\u3088\u3063\u3066\u6bd4\u8f03\u65b9\u6cd5\u3092\u5206\u5c90\u3055\u305b\u308b\nCursorJoiner\u306fIterator\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002next()\u30e1\u30bd\u30c3\u30c9\u3067\u9806\u6b21Cursor\u3092\u79fb\u52d5\u3055\u305b\u3066\u6bd4\u8f03\u3059\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u578b\u306b\u3088\u3063\u3066\u51e6\u7406\u3092\u5206\u5c90\u3055\u305b\u307e\u3059\u3002\npublic Result next() {\n...\n\u3000\u3000if (hasLeft && hasRight) {\n\u3000\u3000    int compareResult = 0;\n\u3000\u3000    switch (mType){\n\u3000\u3000        case STRING:\n\u3000\u3000            populateStringValues(mStringValues, mCursorLeft, mColumnsLeft, 0);\n\u3000\u3000            populateStringValues(mStringValues, mCursorRight, mColumnsRight, 1);\n\u3000\u3000            compareResult = compareStrings(mStringValues);\n\u3000\u3000            break;\n\u3000\u3000        case INT:\n\u3000\u3000            populateIntValues(mIntValues, mCursorLeft, mColumnsLeft, 0);\n\u3000\u3000            populateIntValues(mIntValues, mCursorRight, mColumnsRight, 1);\n\u3000\u3000            compareResult = compareInts(mIntValues);\n\u3000\u3000            break;\n\nint\u578b\u306e\u6bd4\u8f03(compareInts())\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002OrderType\u306b\u3088\u3063\u3066\u8fd4\u308b\u5024\u304c\u5909\u308f\u308b(\u3069\u3061\u3089\u306eCursor\u3092\u9032\u3081\u308b\u304b\u6c7a\u3081\u308b)\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\nprivate static int compareInts(int... values) {\n    if ((values.length % 2) != 0) {\n        throw new IllegalArgumentException(\"you must specify an even number of values\");\n    }\n\n    for (int index = 0; index < values.length; index += 2) {\n        int comp = values[index] - values[index + 1];\n        if (comp != 0) {\n            if (sOrderType == OrderType.DESC) {\n                // if LEFT is smaller than RIGHT, move RIGHT cursor since value order is desc\n                return comp < 0 ? 1 : -1;\n            } else if (sOrderType == OrderType.ASC) {\n                return comp > 0 ? 1 : -1;\n            }\n        }\n    }\n    return 0;\n}\n\n\n\u4f7f\u3044\u65b9\n\u3053\u306eCustomCursorJoiner\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4f7f\u3044\u307e\u3059\u3002\nprivate static final Uri THUMB_URI = MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI;\nprivate static final String[] THUMB_PROJECTION = {MediaStore.Images.Thumbnails.DATA,MediaStore.Images.Thumbnails.IMAGE_ID};\nprivate static final String[] THUMB_WHERE = {String.valueOf(MediaStore.Images.Thumbnails.MINI_KIND)};\nprivate static final String THUMB_ORDER_BY = MediaStore.Images.Thumbnails.IMAGE_ID + \" DESC\";\n\nprivate static final Uri IMAGE_MEDIA_URI = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;\nprivate static final String IMAGE_ORDER_BY = MediaStore.Images.Media._ID + \" DESC\";\nprivate static final String[] CONTENT_ORIENTATION = new String[] {\n        MediaStore.Images.Media._ID,\n        MediaStore.Images.ImageColumns.ORIENTATION\n};\nprivate static final String IMAGE_ORDER_BY = MediaStore.Images.Media._ID + \" DESC\";\n\n\n\nString selection = MediaStore.Images.Thumbnails.KIND + \" = ? AND \"\n        + MediaStore.Images.Thumbnails.IMAGE_ID + \" IN (\" + TextUtils.join(\",\", imageIdList) + \")\";\nContentResolver resolver = context.getContentResolver();\nCursor thumbNailCursor = resolver.query(\n        THUMB_URI,\n        THUMB_PROJECTION,\n        selection,\n        THUMB_WHERE,\n        THUMB_ORDER_BY);\n\nString rotationSelection = MediaStore.Images.Media._ID + \" IN (\" + TextUtils.join(\",\", imageIdList) + \")\";\nCursor rotationCursor = resolver.query(\n        IMAGE_MEDIA_URI,\n        CONTENT_ORIENTATION,\n        rotationSelection,\n        null,\n        IMAGE_ORDER_BY);\n\nCustomCursorJoiner joiner = new CustomCursorJoiner(\n        thumbNailCursor,\n        new String[]{MediaStore.Images.Thumbnails.IMAGE_ID},\n        rotationCursor,\n        new String[]{MediaStore.Images.Media._ID},\n        CustomCursorJoiner.JoinColumnType.INT,\n        CustomCursorJoiner.OrderType.DESC\n);\nfor(CustomCursorJoiner.Result result : joiner){\n    if(result == CustomCursorJoiner.Result.BOTH){\n        PhotoItem item = new PhotoItem(); // \u5199\u771f\u60c5\u5831(thumbnail, id, \u56de\u8ee2\u60c5\u5831)\u3092\u7ba1\u7406\u3059\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n        item.setThumbNailPath(CursorUtil.getString(thumbNailCursor, MediaStore.Images.Thumbnails.DATA));\n        item.setId(CursorUtil.getInt(thumbNailCursor, MediaStore.Images.Thumbnails.IMAGE_ID));\n        item.setRotation(CursorUtil.getInt(rotationCursor, MediaStore.Images.ImageColumns.ORIENTATION));\n        resultList.add(item);\n    }\n}\nrotationCursor.close();\nthumbNailCursor.close();\n\n\u3042\u308a\u304c\u305f\u3044\u3053\u3068\u306bMediaStore.Images.ImageColumns.ORIENTATION\u306fdegree\u3067\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\u6271\u3044\u3084\u3059\u3044\u3067\u3059\u306d\u3002\n\u3042\u3068\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306bBitmap\u751f\u6210\u6642\u306brotation\u60c5\u5831\u3092\u52a0\u3048\u3066\u3042\u3052\u3066\u3001imageView\u7b49\u306bset\u3057\u3066\u3042\u3052\u308c\u3070OK\u3067\u3059\u3002\nBitmap bitmap;\nbitmap = BitmapFactory.decodeFile(item.getThumbNailPath(), options);\n\nint degree = item.getRotation();\nif (degree > 0F) {\n    Matrix matrix = new Matrix();\n    matrix.postRotate(degree);\n\n    Bitmap rotateBm;\n    rotateBm = Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth(), bitmap.getHeight(), matrix, true);\n\n    bitmap.recycle();\n    bitmap = rotateBm;\n}\n...\n\n\n\n\u30ae\u30e3\u30e9\u30ea\u30fc\u304b\u3089\u753b\u50cf\u3092\u307e\u3068\u3081\u3066\u8868\u793a\u3057\u305f\u3044\u5834\u5408\u3001ContentResolver\u3092\u4f7f\u3063\u3066\u753b\u50cf\u306eThumbnails\u60c5\u5831\u3092\u53d6\u3063\u3066\u304d\u3066\u8868\u793a\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u304c\u3001\u6ce8\u610f\u3059\u3079\u304d\u70b9\u3068\u3057\u3066\u3001Thumbnails\u753b\u50cf\u306b\u306f\u56de\u8ee2\u60c5\u5831\u304c\u542b\u307e\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u7aef\u672b\u306e\u6a5f\u7a2e\u306b\u3088\u3063\u3066\u306f\u7e26\u6a2a\u306e\u8868\u793a\u304c\u304a\u304b\u3057\u304f\u306a\u308b\u30b1\u30fc\u30b9\u304c\u3042\u308a\u307e\u3059\u3002\n\u5177\u4f53\u7684\u306b\u306fGalaxy S4\u4ee5\u964d\u3067\u306f\u7e26\u9577\u753b\u50cf\u304c\u6a2a\u5411\u304d\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u73fe\u8c61\u304c\u78ba\u8a8d\u3055\u308c\u307e\u3057\u305f\u3002\n\n##\u89e3\u6c7a\u65b9\u6cd5\n\nContentResolver\u306e `MediaStore.Images.Media._ID` \u3068 `MediaStore.Images.Thumbnails.IMAGE_ID`\u304c\u540c\u3058\u3053\u3068\u3092\u5229\u7528\u3057\u3001MediaStore.Images.Media\u306e\u56de\u8ee2\u60c5\u5831\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u8868\u793a\u3059\u308b\u969b\u306f\u3053\u306e\u56de\u8ee2\u60c5\u5831\u3092\u5143\u306bbitmap\u3092\u56de\u8ee2\u3057\u3066\u8868\u793a\u3057\u3066\u3042\u3052\u307e\u3059\u3002Picasso\u3084Glide\u3092\u4f7f\u3048\u3070\u753b\u50cf\u56de\u8ee2\u3092\u3088\u308d\u3057\u304f\u3084\u3063\u3066\u304f\u308c\u308b(\u3068\u3001\u3044\u3046\u304bPicasso\u3067\u306f\u5185\u90e8\u7684\u306bMediaStore.Images\u306e\u56de\u8ee2\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u6a5f\u69cb\u304c\u3042\u308b\u3063\u307d\u3044)\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4eca\u56de\u306f\u5272\u611b\u3057\u307e\u3059\u3002\n\n### CursorJoiner\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3059\u308b\n\u4e00\u81f4\u3059\u308b`MediaStore.Images.Media._ID` \u3068 `MediaStore.Images.Thumbnails.IMAGE_ID`\u3092\u62bd\u51fa\u3059\u308b\u306b\u306fCursorJoiner\u3092\u4f7f\u3044\u307e\u3059\u3002  \nCursorJoiner\u306f\u305d\u306e\u540d\u306e\u901a\u308aCursor\u3092join\u3057\u307e\u3059\u3002\u5185\u90e8\u7684\u306b\u306f\uff12\u3064\u306eCursor\u3092\u6bd4\u8f03\u3057\u3001\u4e00\u81f4\u3059\u308b\u9805\u76ee\u304c\u51fa\u3066\u304f\u308b\u307e\u3067\u305d\u308c\u305e\u308c\u306eCursor\u3092\u9806\u306b\u9032\u3081\u3066\u3044\u304f\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u305f\u3060\u3057String\u578b\u3067\u3057\u304b\u6bd4\u8f03\u3057\u3066\u304f\u308c\u307e\u305b\u3093\u3002\u305d\u306e\u305f\u3081\u3001ID\u306eint\u578b\u3067\u3082\u5bfe\u5fdc\u3067\u304d\u308b\u3088\u3046\u306bCursorJoiner\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u307e\u3059\u3002\u5b9f\u88c5\u65b9\u6cd5\u306f[\u3053\u3053\u306e\u30d6\u30ed\u30b0](http://poly.hatenablog.com/entry/20101006/p1)(\u306a\u3093\u30685\u5e74\u524d\uff01)\u306b\u3082\u66f8\u3044\u3066\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u5199\u771f\u306e\u4e00\u89a7\u306e\u5834\u5408\u65b0\u3057\u3044\u3082\u306e\u3092\u5148\u982d\u306b\u6301\u3063\u3066\u304d\u305f\u3044\u306e\u3067\u964d\u9806(DESC)\u3067\u6bd4\u8f03\u3067\u304d\u308b\u3088\u3046\u306b\u5de5\u592b\u3057\u307e\u3059\u3002\n\u5b9f\u969b\u306e\u5b9f\u88c5\u306f[Gist](https://gist.github.com/tomoima525/59298f6aee6bc0ef5e9e00f992101552)\u306b\u8cbc\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u5909\u66f4\u70b9\u3092\u304b\u3044\u3064\u307e\u3093\u3067\u66f8\u304f\u3068  \n(1)\u578b\u3068\u6bd4\u8f03\u9806\u5e8f\u306b\u95a2\u3059\u308benum\u8ffd\u52a0\n\n```\n/**\n * The type of column to join\n */\npublic enum JoinColumnType {\n    STRING,\n    INT\n}\n/**\n * Order\n */\npublic enum OrderType {\n    ASC, DESC;\n}\n\n//\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5185\n        mType = type;\n        switch (mType) {\n            case STRING:\n                mStringValues = new String[mColumnsLeft.length * 2];\n                break;\n            case INT:\n                mIntValues = new int[mColumnsLeft.length * 2];\n        }\n        \n        sOrderType = orderType;\n```\n\n\n\n(2) \u578b\u306b\u3088\u3063\u3066\u6bd4\u8f03\u65b9\u6cd5\u3092\u5206\u5c90\u3055\u305b\u308b\nCursorJoiner\u306fIterator\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002next()\u30e1\u30bd\u30c3\u30c9\u3067\u9806\u6b21Cursor\u3092\u79fb\u52d5\u3055\u305b\u3066\u6bd4\u8f03\u3059\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u578b\u306b\u3088\u3063\u3066\u51e6\u7406\u3092\u5206\u5c90\u3055\u305b\u307e\u3059\u3002\n\n\n```\npublic Result next() {\n...\n\u3000\u3000if (hasLeft && hasRight) {\n\u3000\u3000    int compareResult = 0;\n\u3000\u3000    switch (mType){\n\u3000\u3000        case STRING:\n\u3000\u3000            populateStringValues(mStringValues, mCursorLeft, mColumnsLeft, 0);\n\u3000\u3000            populateStringValues(mStringValues, mCursorRight, mColumnsRight, 1);\n\u3000\u3000            compareResult = compareStrings(mStringValues);\n\u3000\u3000            break;\n\u3000\u3000        case INT:\n\u3000\u3000            populateIntValues(mIntValues, mCursorLeft, mColumnsLeft, 0);\n\u3000\u3000            populateIntValues(mIntValues, mCursorRight, mColumnsRight, 1);\n\u3000\u3000            compareResult = compareInts(mIntValues);\n\u3000\u3000            break;\n```\n\nint\u578b\u306e\u6bd4\u8f03(`compareInts()`)\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002OrderType\u306b\u3088\u3063\u3066\u8fd4\u308b\u5024\u304c\u5909\u308f\u308b(\u3069\u3061\u3089\u306eCursor\u3092\u9032\u3081\u308b\u304b\u6c7a\u3081\u308b)\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n```java\nprivate static int compareInts(int... values) {\n    if ((values.length % 2) != 0) {\n        throw new IllegalArgumentException(\"you must specify an even number of values\");\n    }\n\n    for (int index = 0; index < values.length; index += 2) {\n        int comp = values[index] - values[index + 1];\n        if (comp != 0) {\n            if (sOrderType == OrderType.DESC) {\n                // if LEFT is smaller than RIGHT, move RIGHT cursor since value order is desc\n                return comp < 0 ? 1 : -1;\n            } else if (sOrderType == OrderType.ASC) {\n                return comp > 0 ? 1 : -1;\n            }\n        }\n    }\n    return 0;\n}\n```\n\n\n### \u4f7f\u3044\u65b9\n\u3053\u306eCustomCursorJoiner\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u4f7f\u3044\u307e\u3059\u3002\n\n```java\nprivate static final Uri THUMB_URI = MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI;\nprivate static final String[] THUMB_PROJECTION = {MediaStore.Images.Thumbnails.DATA,MediaStore.Images.Thumbnails.IMAGE_ID};\nprivate static final String[] THUMB_WHERE = {String.valueOf(MediaStore.Images.Thumbnails.MINI_KIND)};\nprivate static final String THUMB_ORDER_BY = MediaStore.Images.Thumbnails.IMAGE_ID + \" DESC\";\n\nprivate static final Uri IMAGE_MEDIA_URI = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;\nprivate static final String IMAGE_ORDER_BY = MediaStore.Images.Media._ID + \" DESC\";\nprivate static final String[] CONTENT_ORIENTATION = new String[] {\n        MediaStore.Images.Media._ID,\n        MediaStore.Images.ImageColumns.ORIENTATION\n};\nprivate static final String IMAGE_ORDER_BY = MediaStore.Images.Media._ID + \" DESC\";\n\n\n\nString selection = MediaStore.Images.Thumbnails.KIND + \" = ? AND \"\n        + MediaStore.Images.Thumbnails.IMAGE_ID + \" IN (\" + TextUtils.join(\",\", imageIdList) + \")\";\nContentResolver resolver = context.getContentResolver();\nCursor thumbNailCursor = resolver.query(\n        THUMB_URI,\n        THUMB_PROJECTION,\n        selection,\n        THUMB_WHERE,\n        THUMB_ORDER_BY);\n\nString rotationSelection = MediaStore.Images.Media._ID + \" IN (\" + TextUtils.join(\",\", imageIdList) + \")\";\nCursor rotationCursor = resolver.query(\n        IMAGE_MEDIA_URI,\n        CONTENT_ORIENTATION,\n        rotationSelection,\n        null,\n        IMAGE_ORDER_BY);\n\nCustomCursorJoiner joiner = new CustomCursorJoiner(\n        thumbNailCursor,\n        new String[]{MediaStore.Images.Thumbnails.IMAGE_ID},\n        rotationCursor,\n        new String[]{MediaStore.Images.Media._ID},\n        CustomCursorJoiner.JoinColumnType.INT,\n        CustomCursorJoiner.OrderType.DESC\n);\nfor(CustomCursorJoiner.Result result : joiner){\n    if(result == CustomCursorJoiner.Result.BOTH){\n        PhotoItem item = new PhotoItem(); // \u5199\u771f\u60c5\u5831(thumbnail, id, \u56de\u8ee2\u60c5\u5831)\u3092\u7ba1\u7406\u3059\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n        item.setThumbNailPath(CursorUtil.getString(thumbNailCursor, MediaStore.Images.Thumbnails.DATA));\n        item.setId(CursorUtil.getInt(thumbNailCursor, MediaStore.Images.Thumbnails.IMAGE_ID));\n        item.setRotation(CursorUtil.getInt(rotationCursor, MediaStore.Images.ImageColumns.ORIENTATION));\n        resultList.add(item);\n    }\n}\nrotationCursor.close();\nthumbNailCursor.close();\n```\n\n\u3042\u308a\u304c\u305f\u3044\u3053\u3068\u306bMediaStore.Images.ImageColumns.ORIENTATION\u306fdegree\u3067\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\u6271\u3044\u3084\u3059\u3044\u3067\u3059\u306d\u3002\n\u3042\u3068\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306bBitmap\u751f\u6210\u6642\u306brotation\u60c5\u5831\u3092\u52a0\u3048\u3066\u3042\u3052\u3066\u3001imageView\u7b49\u306bset\u3057\u3066\u3042\u3052\u308c\u3070OK\u3067\u3059\u3002\n\n```java\nBitmap bitmap;\nbitmap = BitmapFactory.decodeFile(item.getThumbNailPath(), options);\n\nint degree = item.getRotation();\nif (degree > 0F) {\n    Matrix matrix = new Matrix();\n    matrix.postRotate(degree);\n\n    Bitmap rotateBm;\n    rotateBm = Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth(), bitmap.getHeight(), matrix, true);\n\n    bitmap.recycle();\n    bitmap = rotateBm;\n}\n...\n\n```\n\n\n\n\n\n", "tags": ["Android", "\u753b\u50cf\u51e6\u7406"]}