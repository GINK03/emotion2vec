{"context": "\u4e71\u6570\u306b\u504f\u308a\u3092\u6301\u305f\u305b\u305f\u3044\u5834\u5408\u3001\n\u4f8b\u3048\u3070\u3001\n\u300e\u80fd\u529b\u5024\u304c\u5e73\u5747\u7684\u306a\u7269\u304c\u591a\u304f\u51fa\u73fe\u3059\u308b\u3088\u3046\u306a\u30ac\u30c1\u30e3\u3092\u4f5c\u308a\u305f\u3044\u300f\n\u3068\u3044\u3063\u305f\u6642\u306f\u3001\u4e2d\u592e\u3092\u5e73\u5747\u5024\u3068\u3057\u305f\u6b63\u898f\u4e71\u6570\u3092\u4f5c\u308c\u3070\u307b\u307c\u89e3\u6c7a\u3067\u3059\u3002(\u30b0\u30b0\u308c\u3070\u7d50\u69cb\u51fa\u3066\u304f\u308b)\n\u3067\u306f\u3001\u300e\u80fd\u529b\u5024\u304c\u4e0a\u4f4d20%\u3050\u3089\u3044\u306b\u504f\u3063\u305f\u30ac\u30c1\u30e3\u3092\u4f5c\u308a\u305f\u3044\u300f\n\u3068\u3044\u3063\u305f\u5834\u5408\u306f\u3069\u3046\u3067\u3057\u3087\u3046\u3002\n\n\u30b0\u30e9\u30d5\u306f\u5e73\u57470.8 \u5206\u65630.36\u306e\u6b63\u898f\u5206\u5e03\u306e\u30b0\u30e9\u30d5\u3067\u3059\u304c\u3001\n\u3064\u307e\u308a\u306f\u9752\u3044\u90e8\u5206\u3060\u3051\u306b\u5206\u5e03\u3059\u308b\u3088\u3046\u306a\u4e71\u6570\u304c\u6b32\u3057\u3044\u308f\u3051\u3067\u3059\u3002\n\u666e\u901a\u306e\u6b63\u898f\u5206\u5e03\u3060\u3068\u3001\u5206\u6563\u3092\u5927\u304d\u304f\u3059\u308c\u3070\u305d\u308c\u3060\u3051\u70b9\u7dda\u90e8\u5206\u306e\u5206\u5e03\u3082\u591a\u304f\u306a\u3063\u3066\u304d\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u7bc4\u56f2\u5185\u306e\u307f\u3092\u63a1\u7528\u3059\u308b\u3068\u3044\u3046\u624b\u3082\u3042\u308a\u307e\u3059\u304c\u3001\n\u5206\u6563\u304c\u5927\u304d\u304f\u306a\u308b\u307b\u3069\u3001\u5b9f\u88c5\u5074\u3067\u306f\u53ce\u675f\u3084\u51e6\u7406\u6642\u9593\u306e\u4fdd\u8a3c\u304c\u96e3\u3057\u304f\u306a\u3063\u3066\u304d\u307e\u3059\u3002\n\u305d\u3053\u3067\u4eca\u56de\u306f\u3001\u7bc4\u56f2\u4ed8\u304d\u306e\u6b63\u898f\u5206\u5e03\u3001\u300c\u5207\u65ad\u6b63\u898f\u5206\u5e03\u300d\u3092\u7528\u3044\u3066\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u3044\u304d\u307e\u3059\u3002\nhttps://ja.wikipedia.org/wiki/%E5%88%87%E6%96%AD%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83\n\u3053\u308c\u3092C/C++\u3067\u306e\u5b9f\u88c5\u3092\u89e3\u8aac\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u3068\u304b\u8abf\u3079\u3066\u3082\u307b\u3068\u3093\u3069\u51fa\u3066\u3053\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u4f5c\u308a\u307e\u3057\u305f\u3002\n\u3061\u306a\u307f\u306b\u3053\u306e\u6a5f\u80fd\u306fC++11\u4ee5\u4e0a\u306e\u74b0\u5883\u3067\u306f\u3001\u65e2\u306b\u642d\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3057\u3001\nR\u8a00\u8a9e\u306a\u3069\u3001GPL\u306a\u3089\u3070\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3082\u3042\u308a\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001C++11\u306a\u3093\u3066\u4f7f\u3048\u308b\u74b0\u5883\u3058\u3083\u306a\u3044\u3057\u3001GPL\u306a\u3093\u3066\u4f7f\u3048\u308b\u304b\n\u3063\u3066\u3044\u3046\u72b6\u6cc1\u3084\u3001\u4e71\u6570\u306f\u81ea\u524d\u3067\u884c\u304d\u305f\u3044\u4eba\u306e\u53c2\u8003\u306b\u306a\u308c\u3070\u3068...\n(\u591a\u5206R\u8a00\u8a9e\u306e\u624b\u6cd5\u3068\u306f\u9055\u3046\u306f\u305a\u3067\u3059)\n\u7d30\u304b\u304f\u8aac\u660e\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\u304c\u3001\u6b63\u898f\u5206\u5e03\u3001\u6b63\u898f\u4e71\u6570\u3001\u4e00\u69d8\u4e71\u6570\u306b\u3064\u3044\u3066\u306f\u7406\u89e3\u3057\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\u81ea\u5206\u306f\u6570\u5b66\u306e\u30d7\u30ed\u3067\u3082\u7d71\u8a08\u306e\u30d7\u30ed\u3067\u3082\u306a\u3044\u306e\u3067\u3001\u305d\u3053\u3089\u3078\u3093\u306e\u77e5\u8b58\u304c\u6d45\u3044\u306e\u306f\u3054\u5bb9\u8d66\u304f\u3060\u3055\u3044\u3002\n(\u8a02\u6b63)\nC++11\u306e\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u306f\u6b63\u898f\u4e71\u6570\u306e\u7bc4\u56f2\u6307\u5b9a\u304c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u8a02\u6b63\u3044\u305f\u3057\u307e\u3059\u3002\n\n\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306e\u4e71\u6570\u306e\u5b9f\u73fe\n\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306f\u3001\u6b63\u898f\u5206\u5e03\u306b\u7bc4\u56f2\u3092\u3064\u3051\u305f\u3060\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u7bc4\u56f2\u5916\u306e\u5206\u304c\u7bc4\u56f2\u5185\u306b\u8a08\u4e0a\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u6b63\u898f\u5206\u5e03\u3068\u306f\u5c11\u3057\u9055\u3063\u3066\u304f\u308b\u306e\u3067\u3059\u3002\nWikipedia\u3092\u898b\u3066\u3082\u30fb\u30fb\u30fb\u3001\u4f55\u3084\u3089\u96e3\u3057\u3044\u5f0f\u304c\u66f8\u3044\u3066\u3042\u3063\u3066\u8a73\u3057\u3044\u4e8b\u306f\u3088\u304f\u5206\u304b\u308a\u307e\u305b\u3093\u304c\u3001\n\u4e71\u6570\u306f\u9006\u95a2\u6570\u6cd5\u3092\u7528\u3044\u3066\u5c0e\u51fa\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3069\u3046\u3084\u3089\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306e\u4e71\u6570\u306e\u5b9a\u7fa9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\nx = \\phi^{-1}(\\phi(\\alpha) + U\\times(\\phi(\\beta) - \\phi(\\alpha) )\\sigma + \\mu \\\\\n(\\alpha = \\frac{a - \\mu}{\\sigma},\\quad \\beta = \\frac{b - \\mu}{\\sigma})\nx=\u03d5\u22121(\u03d5(\u03b1)+U\u00d7(\u03d5(\u03b2)\u2212\u03d5(\u03b1))\u03c3+\u03bc(\u03b1=a\u2212\u03bc\u03c3,\u03b2=b\u2212\u03bc\u03c3){x = \\phi^{-1}(\\phi(\\alpha) + U\\times(\\phi(\\beta) - \\phi(\\alpha) )\\sigma + \\mu \\\\\n(\\alpha = \\frac{a - \\mu}{\\sigma},\\quad \\beta = \\frac{b - \\mu}{\\sigma})\n}\na, b\u306f\u305d\u308c\u305e\u308c\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306e\u4e0b\u9650\u3068\u4e0a\u9650\u3001\u03c3\u306f\u5206\u6563\u3001\u03bc\u306f\u5e73\u5747\u3068\u306a\u308a\u307e\u3059\u3002\nU\u306f\u4e00\u69d8\u4e71\u6570\u3001\u03a6\u306f\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\u3067\u3059\u3002\n(\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306f\u3001\u5e73\u5747\u304c0\u3001\u5206\u6563\u304c1\u306e\u6b63\u898f\u5206\u5e03\u306e\u3053\u3068\u3067\u3059\u3002)\n\u3053\u308c\u3092\u89e3\u3051\u3070\u4e71\u6570\u306f\u5b9f\u73fe\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570(CDF)\n\n\u5c0e\u51fa\u65b9\u6cd5\n\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570(Cumulative Distribution Function \u7565:CDF)\n\u03a6(x)\u306f\u3001\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570(Probability Density Function \u7565:PDF)\u306ex\u307e\u3067\u7d2f\u7a4d\u3067\u3059\u3002\n\u3064\u307e\u308a\u3001PDF\u3092\u03c6\u3068\u3059\u308b\u3068\u3001\n\\phi(x) = \\int_{-\\infty}^{x}\\varphi(t)dt\n\u03d5(x)=\u222bx\u2212\u221e\u03c6(t)dt{\\phi(x) = \\int_{-\\infty}^{x}\\varphi(t)dt\n}\n\u3053\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3092\u5b9f\u73fe\u3059\u308b\u3053\u3068\u3067CDF\u306f\u4f5c\u308c\u307e\u3059\u3002\n\u3057\u304b\u3057\u3053\u306e\u307e\u307e\u3067\u306f\u3001\u4e0d\u5b9a\u7a4d\u5206\u3067\u3059\u306e\u3067\u89e3\u304f\u306e\u306f\u5c11\u3057\u96e3\u3057\u305d\u3046\u3067\u3059\u3002\n\u3068\u3053\u308d\u304c\u3001\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u5834\u5408\nx = 0\u306e\u6642\u3001\n\u03a6(0)=0.5\u3068\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001CDF\u306e\u4e0d\u5b9a\u7a4d\u5206\u306f\u3001\n\\phi(x) = \\begin{cases}\n0.5 - \\int_{x}^{0}\\varphi(t)dt & ( x < 0 )\\\\\n0.5 & ( x = 0 )\\\\\n0.5 + \\int_{0}^{x}\\varphi(t)dt & ( x > 0 )\n\\end{cases}\n\u03d5(x)={0.5\u2212\u222b0x\u03c6(t)dt(x<0)0.5(x=0)0.5+\u222bx0\u03c6(t)dt(x>0){\\phi(x) = \\begin{cases}\n0.5 - \\int_{x}^{0}\\varphi(t)dt & ( x < 0 )\\\\\n0.5 & ( x = 0 )\\\\\n0.5 + \\int_{0}^{x}\\varphi(t)dt & ( x > 0 )\n\\end{cases}\n}\n\u3053\u306e\u3088\u3046\u306a\u5b9a\u7a4d\u5206\u306e\u5f0f\u3067\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3067\u6c42\u3081\u308b\u3053\u3068\u304c\u51fa\u6765\u305d\u3046\u3067\u3059\u3002\n\n\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570(PDF)\u306e\u5b9f\u88c5\n\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306ePDF\u306f\n\\varphi(x) = \\frac{e^{-\\frac{x^{2}}{2}}}{\\sqrt{2\\pi}}\n\u03c6(x)=e\u2212x22\u221a2\u03c0{\\varphi(x) = \\frac{e^{-\\frac{x^{2}}{2}}}{\\sqrt{2\\pi}}\n}\n\u3053\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u3067\u306f\u5b9f\u969b\u3053\u308c\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u73fe\u3059\u308b\u3068\u3001\nfloat StandardNormalPDF( float x )\n{\n    return expf( -0.5f * ( x * x ) ) / sqrtf( 2.0f * M_PI );\n}\n\n\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30ac\u30a6\u30b9\u6c42\u7a4d\n\u5b9a\u7a4d\u5206\u306e\u8fd1\u4f3c\u8a08\u7b97\u306e\u305f\u3081\u306b\u3001\u4eca\u56de\u306f\u30ac\u30a6\u30b9\u6c42\u7a4d(\u30ac\u30a6\u30b9\u30fb\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u306e\u516c\u5f0f)\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u8a73\u3057\u3044\u539f\u7406\u306f\u5272\u611b\u3057\u307e\u3059\u304c\u3001\u4eca\u56de\u306e\u5834\u5408\u306b\u5f53\u3066\u306f\u3081\u308b\u3068\u3001\u03c6\u306e\u5b9a\u7a4d\u5206\u306f\u3001\n\\int_{a}^{b}\\varphi(x)dx \\approx \\frac{b-a}{2}\\sum_{i=1}^{n}w_{i}\\varphi(\\frac{b-a}{2}x_{i} + \\frac{b+a}{2})\n\u222bba\u03c6(x)dx\u2248b\u2212a2n\u2211i=1wi\u03c6(b\u2212a2xi+b+a2){\\int_{a}^{b}\\varphi(x)dx \\approx \\frac{b-a}{2}\\sum_{i=1}^{n}w_{i}\\varphi(\\frac{b-a}{2}x_{i} + \\frac{b+a}{2})\n}\n\u3053\u306e\u3088\u3046\u306aN\u6b21\u306e\u7d1a\u6570\u306b\u5909\u63db\u3067\u304d\u307e\u3059\u3002\nwi\u306f\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u591a\u9805\u5f0f\u306e\u91cd\u307f\u3001xi\u304c\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u591a\u9805\u5f0f\u306e\u6839\u3067\u3059\u3002\n\u3053\u308c\u3089\u306f\u305d\u308c\u305e\u308c\u5b9a\u6570\u3068\u3057\u3066\u4e8b\u524d\u306b\u5b9a\u7fa9\u3057\u3066\u304a\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n/// \u30ac\u30a6\u30b9\u30ce\u30fc\u30c9(\u6839)\nstatic const float GaussNodeX[] =\n{\n    -9.931285e-1f,\n    -9.639719e-1f,\n    -9.122344e-1f,\n    -8.391169e-1f,\n    -7.463319e-1f,\n    -6.360536e-1f,\n    -5.108670e-1f,\n    -3.737060e-1f,\n    -2.277858e-1f,\n    -7.652652e-2f,\n     7.652652e-2f,\n     2.277858e-1f,\n     3.737060e-1f,\n     5.108670e-1f,\n     6.360536e-1f,\n     7.463319e-1f,\n     8.391169e-1f,\n     9.122344e-1f,\n     9.639719e-1f,\n     9.931285e-1f,\n};\n/// \u30ac\u30a6\u30b9\u30ce\u30fc\u30c9(\u91cd\u307f)\nstatic const float GaussNodeW[] =\n{\n    1.761400e-2f,\n    4.060142e-2f,\n    6.267204e-2f,\n    8.327674e-2f,\n    1.019301e-1f,\n    1.181945e-1f,\n    1.316886e-1f,\n    1.420961e-1f,\n    1.491729e-1f,\n    1.527533e-1f,\n    1.527533e-1f,\n    1.491729e-1f,\n    1.420961e-1f,\n    1.316886e-1f,\n    1.181945e-1f,\n    1.019301e-1f,\n    8.327674e-2f,\n    6.267204e-2f,\n    4.060142e-2f,\n    1.761400e-2f,\n};\n\n\u4eca\u56de\u306f\u6700\u5927\u306720\u6b21\u307e\u3067\u3068\u3057\u307e\u3059\u3002\n\u30ac\u30a6\u30b9\u6c42\u7a4d\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u73fe\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nfloat GetGaussianIntegral( float a, float b, float( *func )( float ), uint32_t degree = 20 )\n{\n    if( func == NULL ){\n        DEBUG_ASSERT( false, \"[%s]\u6c42\u7a4d\u3067\u304d\u307e\u305b\u3093\\n\", __FUNCTION__ );\n        return 0.0f;\n    }\n    float center = ( b - a ) * 0.5f;\n    float integral = 0.0f;\n    const uint32_t N = ( degree <= NUMBEROF( GaussNodeW ) && degree <= NUMBEROF( GaussNodeX ) ) ? degree : static_cast<uint32_t>( fminf( NUMBEROF( GaussNodeW ), NUMBEROF( GaussNodeX ) ) );\n    for( uint32_t i = 0; i < N; ++i ){\n        integral += GaussNodeW[i] * func( ( center * GaussNodeX[i] ) + ( ( b + a ) * 0.5f ) );\n    }\n    return center * integral;\n}\n\nDEBUG_ASSERT\u306fassert, NUMBEROF\u306f\u914d\u5217\u306e\u8981\u7d20\u6570\u3092\u8868\u3059\u30de\u30af\u30ed\u3067\u3059\u3002\n\u88ab\u7a4d\u5206\u95a2\u6570\u3092\u95a2\u6570\u30dd\u30a4\u30f3\u30bf\u3067\u5f15\u6570\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u305d\u3053\u306f\u81e8\u6a5f\u5fdc\u5909\u306b\u30fb\u30fb\u30fb\u3002\nN\u3092\u5927\u304d\u304f\u3059\u308c\u3070\u3059\u308b\u307b\u3069\u7cbe\u5ea6\u306f\u9ad8\u304f\u306a\u308a\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306ePDF\u306b\u304a\u3044\u3066\u767a\u751f\u3059\u308b\u304b\u3069\u3046\u304b\u306f\u672a\u78ba\u8a8d\u3067\u3059\u304c\u3001\nN\u3092\u5927\u304d\u304f\u3059\u308b\u3068\u3001\u30eb\u30f3\u30b2\u73fe\u8c61\u304c\u767a\u751f\u3057\u3001\u307e\u3063\u305f\u304f\u4fe1\u983c\u3067\u304d\u308b\u5024\u3067\u306f\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u5927\u4e08\u592b\u3067\u3059\u304c\u3001\u4e07\u80fd\u3067\u306f\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\nCDF\u306e\u5b9f\u73fe\n\u4e0d\u5b9a\u7a4d\u5206\u3082\u3001PDF\u3082\u5c0e\u51fa\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u6539\u3081\u3066CDF\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u3059\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nfloat StandardNormalCDF( float x )\n{\n    float ORIGINAL_POINT = 0.5f;\n    if( x > 0.0f ){\n        return ORIGINAL_POINT + GetGaussianIntegral( 0.0f, x, StandardNormalPDF, 20 );\n    }\n    else if( x < 0.0f ){\n        return ORIGINAL_POINT - GetGaussianIntegral( x, 0.0f, StandardNormalPDF, 20 );\n    }\n    return ORIGINAL_POINT;\n}\n\n\n\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u9006\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\n\n\u76f8\u88dc\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570(CCDF)\n\u5b9a\u7fa9\u306b\u51fa\u73fe\u3057\u3066\u304d\u305f\u03a6^-1\u306f\u3001CDF\u306e\u9006\u95a2\u6570(\u9006\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570)\u3067\u3059\u3002\n\u3053\u308c\u3092\u6c42\u3081\u308b\u305f\u3081\u306b\u306f\u3001\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u76f8\u88dc\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570(Complementary Cumulative Distribution Function \u7565:CCDF)\u3092\u5229\u7528\u3057\u307e\u3059\u3002\nCCDF\u306fCDF\u3068\u306e\u5408\u8a08\u304c1\u3068\u306a\u308b\u3088\u3046\u306a\u95a2\u6570\u306e\u3053\u3068\u3067\u3059\u3002\n\u3064\u307e\u308a\u3001CDF\u3092F(x)\u3001 CCDF\u3092G(x)\u3068\u3059\u308b\u3068\u3001\u6b21\u306e\u3088\u3046\u306a\u95a2\u4fc2\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\u3002\np = F(x)\\\\\nF(x) + G(x) = 1\\\\\nx = F^{-1}(p) = G^{-1}(1-p)\np=F(x)F(x)+G(x)=1x=F\u22121(p)=G\u22121(1\u2212p){p = F(x)\\\\\nF(x) + G(x) = 1\\\\\nx = F^{-1}(p) = G^{-1}(1-p)\n}\n\u307e\u305f\u3001\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\u306e\u30b0\u30e9\u30d5\u3092\u898b\u308b\u3068\u3001\n\n\u30b0\u30e9\u30d5\u306f\u3001(x, \u03a6(x)) = (0, 0.5)\u3092\u4e2d\u5fc3\u3068\u3057\u3066\u3001\u4e0a\u4e0b\u5de6\u53f3\u5bfe\u79f0\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3064\u307e\u308a\u3001x\u304c\u8ca0\u306e\u5834\u5408\u306eCDF\u306e\u5024\u306f\u6b63\u65b9\u5411\u306eCCDF\u306e\u5024\u3068\u540c\u7b49\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\u3088\u3063\u3066\u3001\np = F(x) = G(-x)\\\\\nx = F^{-1}(p) = -G^{-1}(p)\np=F(x)=G(\u2212x)x=F\u22121(p)=\u2212G\u22121(p){p = F(x) = G(-x)\\\\\nx = F^{-1}(p) = -G^{-1}(p)\n}\n\u3053\u306e\u3088\u3046\u306a\u95a2\u4fc2\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\u3002\n\u9006\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\u306f\u3001CCDF\u306e\u9006\u95a2\u6570\u306b\u3088\u3063\u3066\u8868\u3059\u3053\u3068\u3082\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\nCCDF\u306e\u6709\u7406\u8fd1\u4f3c\u516c\u5f0f\nAbramowitz and Stegun\u306b\u3088\u308b\u3068\u3001\np = G(x_{p})\np=G(xp){p = G(x_{p})\n}\n\u3067\u8868\u3055\u308c\u308b\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306eCCDF\u306b\u304a\u3044\u3066\u3001\n0 < p \u2266 0.5\n\u306a\u3089\u3070\u3001\nx_{p} = t - \\frac{c_{0} + c_{1}t + c_{2}t^2}{1 + d_1t + d_2t^2 + d_3t^3} + \\epsilon(p)\\\\\nt = \\sqrt{log\\frac{1}{p^2}}\\\\\nc_0 = 2.515517 \\quad c_1 = 0.802853 \\quad c_2 = 0.010328\\\\\nd_1 = 1.432788 \\quad d_2 = 0.189269 \\quad d_3 = 0.001308\\\\\n|\\epsilon(p)| < 4.5 \\times 10^{-4}\nxp=t\u2212c0+c1t+c2t21+d1t+d2t2+d3t3+\u03f5(p)t=\u221alog1p2c0=2.515517c1=0.802853c2=0.010328d1=1.432788d2=0.189269d3=0.001308|\u03f5(p)|<4.5\u00d710\u22124{x_{p} = t - \\frac{c_{0} + c_{1}t + c_{2}t^2}{1 + d_1t + d_2t^2 + d_3t^3} + \\epsilon(p)\\\\\nt = \\sqrt{log\\frac{1}{p^2}}\\\\\nc_0 = 2.515517 \\quad c_1 = 0.802853 \\quad c_2 = 0.010328\\\\\nd_1 = 1.432788 \\quad d_2 = 0.189269 \\quad d_3 = 0.001308\\\\\n|\\epsilon(p)| < 4.5 \\times 10^{-4}\n}\n\u3053\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u8a00\u3044\u307e\u3059\u3002\n\u3053\u3053\u3067\u3001\u8aa4\u5dee\u3067\u3042\u308b\u03b5(p)\u306f\u300110^-4\u3068\u3001\u975e\u5e38\u306b\u5c0f\u3055\u3044\u5024\u3068\u306a\u308a\u307b\u307c\u7121\u8996\u3067\u304d\u308b\u306e\u3067\u3001\n\u3053\u308c\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001CCDF\u306e\u9006\u95a2\u6570\u306e\u6709\u7406\u8fd1\u4f3c\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u3059\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nfloat GetRationalApproximation( float p )\n{\n    const float c[] = { 2.515517f, 0.802853f, 0.010328f };\n    const float d[] = { 1.432788f, 0.189269f, 0.001308f };\n    float t = sqrtf( -2.0f * logf( p ) );\n    //  \u30db\u30fc\u30ca\u30fc\u6cd5\u306b\u3088\u3063\u3066\u516c\u5f0f\u3092\u6700\u9069\u5316\n    return t - ( ( c[2] * t + c[1] ) * t + c[0] ) / ( ( ( d[2] * t + d[1] ) * t + d[0] ) * t + 1.0f );\n}\n\n\u591a\u9805\u5f0f\u306f\u3001\u30db\u30fc\u30ca\u30fc\u6cd5\u306b\u3088\u3063\u3066\u5909\u5f62\u3059\u308b\u3053\u3068\u3067\u8a08\u7b97\u56de\u6570\u3092\u6e1b\u3089\u3057\u307e\u3059\u3002\n\n\u9006CDF\u306e\u5b9f\u73fe\n\u524d\u8ff0\u306e\u8fd1\u4f3c\u516c\u5f0f\u306b\u306f\u3001\u9069\u7528\u3055\u308c\u308b\u7bc4\u56f2\u304c\u3042\u308a\u307e\u3059\u3002\n0 < p \u2266 0.5\n\u3067\u3059\u3002\n\u5b9f\u969b\u306ep\u304c\u53d6\u308a\u3046\u308b\u7bc4\u56f2\u306f0 < p < 1\u3067\u3059\u306e\u3067\u30010.5 < p < 1\u306e\u5834\u5408\u3092\u6c42\u3081\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n0 < p < 1\u306a\u306e\u3067\u3001p > 0.5\u306e\u5834\u5408\u306f\u3001p'=1-p\u3068\u3059\u308c\u3070\u30010 < p' \u2266 0.5\u3068\u306a\u308a\u516c\u5f0f\u306b\u5f53\u3066\u306f\u3081\u308b\u3053\u3068\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001\u524d\u8ff0\u306eCDF\u3068CCDF\u306e\u95a2\u4fc2\u304b\u3089\u3001CDF\u306e\u9006\u95a2\u6570\u306f\u6b21\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nx = \\begin{cases}\n-G^{-1}(p) & ( 0 < p \\leq 0.5 )\\\\\nG^{-1}(1 - p) & ( 0.5 < p < 1 )\n\\end{cases}\n{x = \\begin{cases}\n-G^{-1}(p) & ( 0 < p \\leq 0.5 )\\\\\nG^{-1}(1 - p) & ( 0.5 < p < 1 )\n\\end{cases}\n}{x = \\begin{cases}\n-G^{-1}(p) & ( 0 < p \\leq 0.5 )\\\\\nG^{-1}(1 - p) & ( 0.5 < p < 1 )\n\\end{cases}\n}\n\u3053\u306e\u95a2\u4fc2\u304b\u3089\u3001\u6709\u7406\u8fd1\u4f3c\u516c\u5f0f\u306b\u5f53\u3066\u306f\u3081\u308b\u3053\u3068\u3067\u3001\u9006CDF\u3092\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3089\u3092\u8e0f\u307e\u3048\u305f\u4e0a\u3067\u3001\u9006CDF\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u73fe\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nfloat StandardNormalCDFInverse( float x )\n{\n    if( x <= 0.0f ){\n        DEBUG_ASSERT( false, \"[%s]\u6c42\u3081\u3089\u308c\u307e\u305b\u3093\\n\", __FUNCTION__ );\n        return -FLT_MAX;\n    }\n    else if( x >= 1.0f ){\n        DEBUG_ASSERT( false, \"[%s]\u6c42\u3081\u3089\u308c\u307e\u305b\u3093\\n\", __FUNCTION__ );\n        return FLT_MAX;\n    }\n    return ( x < 0.5f ) ? -1.0f * GetRationalApproximation( x ) : GetRationalApproximation( 1.0f - x );\n}\n\n\u30b0\u30e9\u30d5\u3092\u898b\u308b\u3068\u5206\u304b\u308a\u307e\u3059\u304c\u3001x\u22660\u3084x\u22671\u3067\u306f\u3001\u7d50\u679c\u306f\u00b1\u221e\u306b\u767a\u6563\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067\u6ce8\u610f\u3002\n\n\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306e\u4e71\u6570\u306e\u5b9f\u88c5\n\u5fc5\u8981\u306a\u8981\u7d20\u304c\u5168\u3066\u63c3\u3044\u307e\u3057\u305f\u306e\u3067\nx = \\phi^{-1}(\\phi(\\alpha) + U\\times(\\phi(\\beta) - \\phi(\\alpha) )\\sigma + \\mu \\\\\n(\\alpha = \\frac{a - \\mu}{\\sigma},\\quad \\beta = \\frac{b - \\mu}{\\sigma})\n{x = \\phi^{-1}(\\phi(\\alpha) + U\\times(\\phi(\\beta) - \\phi(\\alpha) )\\sigma + \\mu \\\\\n(\\alpha = \\frac{a - \\mu}{\\sigma},\\quad \\beta = \\frac{b - \\mu}{\\sigma})\n}{x = \\phi^{-1}(\\phi(\\alpha) + U\\times(\\phi(\\beta) - \\phi(\\alpha) )\\sigma + \\mu \\\\\n(\\alpha = \\frac{a - \\mu}{\\sigma},\\quad \\beta = \\frac{b - \\mu}{\\sigma})\n}\n\u3053\u306e\u5b9a\u7fa9\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nfloat RandTruncatedNormal( float a, float b, float mu, float sigma )\n{\n    float alpha = ( a - mu ) / sigma;\n    float beta = ( b - mu ) / sigma;\n    return StandardNormalCDFInverse( StandardNormalCDF( alpha ) + ( RandF() * ( StandardNormalCDF( beta ) - StandardNormalCDF( alpha ) ) ) ) * sigma + mu;\n}\n\n\u5b9f\u969b\u306f\u4f8b\u5916\u51e6\u7406\u306a\u3069\u304c\u542b\u307e\u308c\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u7701\u7565\u3057\u3066\u3044\u307e\u3059\u3002(a, b, sigma\u306e\u5024\u304c\u7570\u5e38\u306a\u30b1\u30fc\u30b9\u306a\u3069)\nRandF()\u306f0 < u < 1\u306e\u7bc4\u56f2\u306e\u4e00\u69d8\u4e71\u6570\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u3067\u3059\u3002\n\u8272\u3005\u306a\u65b9\u6cd5\u304c\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u81ea\u5206\u306fXorshift\u3067\u4f5c\u3063\u3066\u3044\u307e\u3059\u3002\nXorshift\u306e\u5b9f\u88c5\u65b9\u6cd5\u306f\u30b0\u30b0\u308c\u3070\u3059\u3050\u51fa\u3066\u304f\u308b\u306e\u3067\u3053\u3053\u3067\u306f\u66f8\u304d\u307e\u305b\u3093\u3002\n\n\u7d50\u679c\n\u4e0b\u9650\u30920\u3001\u4e0a\u9650\u30921\u3001\u5e73\u5747\u30920.8\u3001\u5206\u6563\u30920.36\u3068\u3057\u3066\n\u4e71\u6570\u751f\u6210\u309220000\u56de\u884c\u3063\u305f\u6642\u306e\u4e71\u6570\u306e\u5206\u5e03\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n0\u304b\u30891\u306e\u533a\u9593\u306b\u9650\u5b9a\u3055\u308c\u30010.8\u4ed8\u8fd1\u304c\u6700\u3082\u591a\u304f\u306a\u308b\u6b63\u898f\u5206\u5e03\u66f2\u7dda\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u5c11\u3057\u30c7\u30b3\u30dc\u30b3\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u3050\u3089\u3044\u306a\u3089\u30ac\u30c1\u30e3\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3067\u306f\u554f\u984c\u306a\u3055\u305d\u3046\u3067\u3059\u3002\n\u51e6\u7406\u6642\u9593\u3082\u304b\u306a\u308a\u77ed\u3044\u3067\u3059\u3002(\u5b9f\u6e2c\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u304c)\n\u4eca\u56de\u306f\u30b2\u30fc\u30e0\u306e\u3088\u3046\u306a\u9ad8\u3044\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u6027\u3092\u60f3\u5b9a\u3057\u3001\u9ad8\u901f\u3055\u3082\u610f\u8b58\u3057\u3066\u3044\u307e\u3059\u304c\u3001\n\u901f\u5ea6\u3088\u308a\u3082\u7cbe\u5ea6\u3092\u91cd\u8996\u3057\u305f\u3044\u5834\u5408\u306a\u3069\u306f\u3001\n\u30ac\u30a6\u30b9\u6c42\u7a4d\u306e\u6b21\u6570\u3092\u5927\u304d\u304f\u3057\u305f\u308a\u3001float\u3067\u306f\u306a\u304fdouble\u3092\u4f7f\u3063\u305f\u308a\u3001Xorshift\u3067\u306f\u306a\u304f\u30e1\u30eb\u30bb\u30f3\u30cc\u30c4\u30a4\u30b9\u30bf\u3092\u4f7f\u3063\u305f\u308a\u3068\u3001\n\u8272\u3005\u3068\u5fdc\u7528\u304c\u5229\u304d\u307e\u3059\u3002\n\n\u53c2\u8003\u30b5\u30a4\u30c8\n\nTruncated normal distribution - Wikipedia\nNormal distribution - Wikipedia\n\u6b63\u898f\u5206\u5e03\u306e\u78ba\u7387\u8a08\u7b97\uff1aC++/Linux\u30d7\u30ed\u30b0\u30e9\u30e0\n\u30ac\u30a6\u30b9\uff65\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u7a4d\u5206\nNormal distribution inverse\n\n\u4e71\u6570\u306b\u504f\u308a\u3092\u6301\u305f\u305b\u305f\u3044\u5834\u5408\u3001\n\u4f8b\u3048\u3070\u3001\n\u300e\u80fd\u529b\u5024\u304c\u5e73\u5747\u7684\u306a\u7269\u304c\u591a\u304f\u51fa\u73fe\u3059\u308b\u3088\u3046\u306a\u30ac\u30c1\u30e3\u3092\u4f5c\u308a\u305f\u3044\u300f\n\u3068\u3044\u3063\u305f\u6642\u306f\u3001\u4e2d\u592e\u3092\u5e73\u5747\u5024\u3068\u3057\u305f\u6b63\u898f\u4e71\u6570\u3092\u4f5c\u308c\u3070\u307b\u307c\u89e3\u6c7a\u3067\u3059\u3002(\u30b0\u30b0\u308c\u3070\u7d50\u69cb\u51fa\u3066\u304f\u308b)\n\n\u3067\u306f\u3001\u300e\u80fd\u529b\u5024\u304c\u4e0a\u4f4d20%\u3050\u3089\u3044\u306b\u504f\u3063\u305f\u30ac\u30c1\u30e3\u3092\u4f5c\u308a\u305f\u3044\u300f\n\u3068\u3044\u3063\u305f\u5834\u5408\u306f\u3069\u3046\u3067\u3057\u3087\u3046\u3002\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/143708/ad69a8a3-969c-a122-85ff-769a75412c4b.png\" width=\"750px\">\n\n\u30b0\u30e9\u30d5\u306f\u5e73\u57470.8 \u5206\u65630.36\u306e\u6b63\u898f\u5206\u5e03\u306e\u30b0\u30e9\u30d5\u3067\u3059\u304c\u3001\n\u3064\u307e\u308a\u306f\u9752\u3044\u90e8\u5206\u3060\u3051\u306b\u5206\u5e03\u3059\u308b\u3088\u3046\u306a\u4e71\u6570\u304c\u6b32\u3057\u3044\u308f\u3051\u3067\u3059\u3002\n\u666e\u901a\u306e\u6b63\u898f\u5206\u5e03\u3060\u3068\u3001\u5206\u6563\u3092\u5927\u304d\u304f\u3059\u308c\u3070\u305d\u308c\u3060\u3051\u70b9\u7dda\u90e8\u5206\u306e\u5206\u5e03\u3082\u591a\u304f\u306a\u3063\u3066\u304d\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u7bc4\u56f2\u5185\u306e\u307f\u3092\u63a1\u7528\u3059\u308b\u3068\u3044\u3046\u624b\u3082\u3042\u308a\u307e\u3059\u304c\u3001\n\u5206\u6563\u304c\u5927\u304d\u304f\u306a\u308b\u307b\u3069\u3001\u5b9f\u88c5\u5074\u3067\u306f\u53ce\u675f\u3084\u51e6\u7406\u6642\u9593\u306e\u4fdd\u8a3c\u304c\u96e3\u3057\u304f\u306a\u3063\u3066\u304d\u307e\u3059\u3002\n\n\u305d\u3053\u3067\u4eca\u56de\u306f\u3001\u7bc4\u56f2\u4ed8\u304d\u306e\u6b63\u898f\u5206\u5e03\u3001\u300c\u5207\u65ad\u6b63\u898f\u5206\u5e03\u300d\u3092\u7528\u3044\u3066\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u3044\u304d\u307e\u3059\u3002\nhttps://ja.wikipedia.org/wiki/%E5%88%87%E6%96%AD%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83\n\n\u3053\u308c\u3092C/C++\u3067\u306e\u5b9f\u88c5\u3092\u89e3\u8aac\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u3068\u304b\u8abf\u3079\u3066\u3082\u307b\u3068\u3093\u3069\u51fa\u3066\u3053\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u4f5c\u308a\u307e\u3057\u305f\u3002\n~~\u3061\u306a\u307f\u306b\u3053\u306e\u6a5f\u80fd\u306f__C++11\u4ee5\u4e0a__\u306e\u74b0\u5883\u3067\u306f\u3001\u65e2\u306b\u642d\u8f09\u3055\u308c\u3066\u3044\u307e\u3059\u3057\u3001~~\n__R\u8a00\u8a9e__\u306a\u3069\u3001__GPL__\u306a\u3089\u3070\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3082\u3042\u308a\u307e\u3059\u3002\n\n\u306a\u306e\u3067\u3001~~C++11\u306a\u3093\u3066\u4f7f\u3048\u308b\u74b0\u5883\u3058\u3083\u306a\u3044\u3057\u3001~~GPL\u306a\u3093\u3066\u4f7f\u3048\u308b\u304b\n\u3063\u3066\u3044\u3046\u72b6\u6cc1\u3084\u3001\u4e71\u6570\u306f\u81ea\u524d\u3067\u884c\u304d\u305f\u3044\u4eba\u306e\u53c2\u8003\u306b\u306a\u308c\u3070\u3068...\n(\u591a\u5206R\u8a00\u8a9e\u306e\u624b\u6cd5\u3068\u306f\u9055\u3046\u306f\u305a\u3067\u3059)\n\u7d30\u304b\u304f\u8aac\u660e\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\u304c\u3001\u6b63\u898f\u5206\u5e03\u3001\u6b63\u898f\u4e71\u6570\u3001\u4e00\u69d8\u4e71\u6570\u306b\u3064\u3044\u3066\u306f\u7406\u89e3\u3057\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\n\u81ea\u5206\u306f\u6570\u5b66\u306e\u30d7\u30ed\u3067\u3082\u7d71\u8a08\u306e\u30d7\u30ed\u3067\u3082\u306a\u3044\u306e\u3067\u3001\u305d\u3053\u3089\u3078\u3093\u306e\u77e5\u8b58\u304c\u6d45\u3044\u306e\u306f\u3054\u5bb9\u8d66\u304f\u3060\u3055\u3044\u3002\n\n(\u8a02\u6b63)\nC++11\u306e\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u306f\u6b63\u898f\u4e71\u6570\u306e\u7bc4\u56f2\u6307\u5b9a\u304c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u8a02\u6b63\u3044\u305f\u3057\u307e\u3059\u3002\n\n#\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306e\u4e71\u6570\u306e\u5b9f\u73fe\n\n\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306f\u3001\u6b63\u898f\u5206\u5e03\u306b\u7bc4\u56f2\u3092\u3064\u3051\u305f\u3060\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u7bc4\u56f2\u5916\u306e\u5206\u304c\u7bc4\u56f2\u5185\u306b\u8a08\u4e0a\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u306a\u306e\u3067\u3001\u6b63\u898f\u5206\u5e03\u3068\u306f\u5c11\u3057\u9055\u3063\u3066\u304f\u308b\u306e\u3067\u3059\u3002\n\nWikipedia\u3092\u898b\u3066\u3082\u30fb\u30fb\u30fb\u3001\u4f55\u3084\u3089\u96e3\u3057\u3044\u5f0f\u304c\u66f8\u3044\u3066\u3042\u3063\u3066\u8a73\u3057\u3044\u4e8b\u306f\u3088\u304f\u5206\u304b\u308a\u307e\u305b\u3093\u304c\u3001\n\u4e71\u6570\u306f\u9006\u95a2\u6570\u6cd5\u3092\u7528\u3044\u3066\u5c0e\u51fa\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3069\u3046\u3084\u3089\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306e\u4e71\u6570\u306e\u5b9a\u7fa9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n```math\nx = \\phi^{-1}(\\phi(\\alpha) + U\\times(\\phi(\\beta) - \\phi(\\alpha) )\\sigma + \\mu \\\\\n(\\alpha = \\frac{a - \\mu}{\\sigma},\\quad \\beta = \\frac{b - \\mu}{\\sigma})\n```\na, b\u306f\u305d\u308c\u305e\u308c\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306e\u4e0b\u9650\u3068\u4e0a\u9650\u3001\u03c3\u306f\u5206\u6563\u3001\u03bc\u306f\u5e73\u5747\u3068\u306a\u308a\u307e\u3059\u3002\nU\u306f\u4e00\u69d8\u4e71\u6570\u3001\u03a6\u306f\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e[\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570](https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E5%88%86%E5%B8%83#.E5.88.86.E5.B8.83.E9.96.A2.E6.95.B0 \"\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\")\u3067\u3059\u3002\n(\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306f\u3001\u5e73\u5747\u304c0\u3001\u5206\u6563\u304c1\u306e\u6b63\u898f\u5206\u5e03\u306e\u3053\u3068\u3067\u3059\u3002)\n\u3053\u308c\u3092\u89e3\u3051\u3070\u4e71\u6570\u306f\u5b9f\u73fe\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n#\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570(CDF)\n##\u5c0e\u51fa\u65b9\u6cd5\n\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570(Cumulative Distribution Function \u7565:CDF)\n\u03a6(x)\u306f\u3001[\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570](https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E5%AF%86%E5%BA%A6%E9%96%A2%E6%95%B0 \"\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570\")(Probability Density Function \u7565:PDF)\u306ex\u307e\u3067\u7d2f\u7a4d\u3067\u3059\u3002\n\u3064\u307e\u308a\u3001PDF\u3092\u03c6\u3068\u3059\u308b\u3068\u3001\n\n```math\n\\phi(x) = \\int_{-\\infty}^{x}\\varphi(t)dt\n```\n\u3053\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3092\u5b9f\u73fe\u3059\u308b\u3053\u3068\u3067CDF\u306f\u4f5c\u308c\u307e\u3059\u3002\n\n\u3057\u304b\u3057\u3053\u306e\u307e\u307e\u3067\u306f\u3001\u4e0d\u5b9a\u7a4d\u5206\u3067\u3059\u306e\u3067\u89e3\u304f\u306e\u306f\u5c11\u3057\u96e3\u3057\u305d\u3046\u3067\u3059\u3002\n\u3068\u3053\u308d\u304c\u3001\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u5834\u5408\nx = 0\u306e\u6642\u3001\n\u03a6(0)=0.5\u3068\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u305d\u306e\u305f\u3081\u3001CDF\u306e\u4e0d\u5b9a\u7a4d\u5206\u306f\u3001\n\n```math\n\\phi(x) = \\begin{cases}\n0.5 - \\int_{x}^{0}\\varphi(t)dt & ( x < 0 )\\\\\n0.5 & ( x = 0 )\\\\\n0.5 + \\int_{0}^{x}\\varphi(t)dt & ( x > 0 )\n\\end{cases}\n```\n\n\u3053\u306e\u3088\u3046\u306a\u5b9a\u7a4d\u5206\u306e\u5f0f\u3067\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3067\u6c42\u3081\u308b\u3053\u3068\u304c\u51fa\u6765\u305d\u3046\u3067\u3059\u3002\n\n\n##\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u78ba\u7387\u5bc6\u5ea6\u95a2\u6570(PDF)\u306e\u5b9f\u88c5\n\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306ePDF\u306f\n\n```math\n\\varphi(x) = \\frac{e^{-\\frac{x^{2}}{2}}}{\\sqrt{2\\pi}}\n```\n\u3053\u306e\u3088\u3046\u306b\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u3067\u306f\u5b9f\u969b\u3053\u308c\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u73fe\u3059\u308b\u3068\u3001\n\n```cpp\nfloat StandardNormalPDF( float x )\n{\n\treturn expf( -0.5f * ( x * x ) ) / sqrtf( 2.0f * M_PI );\n}\n```\n\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n##\u30ac\u30a6\u30b9\u6c42\u7a4d\n\u5b9a\u7a4d\u5206\u306e\u8fd1\u4f3c\u8a08\u7b97\u306e\u305f\u3081\u306b\u3001\u4eca\u56de\u306f[\u30ac\u30a6\u30b9\u6c42\u7a4d](https://ja.wikipedia.org/wiki/%E3%82%AC%E3%82%A6%E3%82%B9%E6%B1%82%E7%A9%8D \"\u30ac\u30a6\u30b9\u6c42\u7a4d\")(\u30ac\u30a6\u30b9\u30fb\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u306e\u516c\u5f0f)\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\n\u8a73\u3057\u3044\u539f\u7406\u306f\u5272\u611b\u3057\u307e\u3059\u304c\u3001\u4eca\u56de\u306e\u5834\u5408\u306b\u5f53\u3066\u306f\u3081\u308b\u3068\u3001\u03c6\u306e\u5b9a\u7a4d\u5206\u306f\u3001\n\n```math\n\\int_{a}^{b}\\varphi(x)dx \\approx \\frac{b-a}{2}\\sum_{i=1}^{n}w_{i}\\varphi(\\frac{b-a}{2}x_{i} + \\frac{b+a}{2})\n```\n\u3053\u306e\u3088\u3046\u306aN\u6b21\u306e\u7d1a\u6570\u306b\u5909\u63db\u3067\u304d\u307e\u3059\u3002\nwi\u306f\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u591a\u9805\u5f0f\u306e\u91cd\u307f\u3001xi\u304c\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u591a\u9805\u5f0f\u306e\u6839\u3067\u3059\u3002\n\u3053\u308c\u3089\u306f\u305d\u308c\u305e\u308c\u5b9a\u6570\u3068\u3057\u3066\u4e8b\u524d\u306b\u5b9a\u7fa9\u3057\u3066\u304a\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```cpp\n///\t\u30ac\u30a6\u30b9\u30ce\u30fc\u30c9(\u6839)\nstatic const float GaussNodeX[] =\n{\n\t-9.931285e-1f,\n\t-9.639719e-1f,\n\t-9.122344e-1f,\n\t-8.391169e-1f,\n\t-7.463319e-1f,\n\t-6.360536e-1f,\n\t-5.108670e-1f,\n\t-3.737060e-1f,\n\t-2.277858e-1f,\n\t-7.652652e-2f,\n\t 7.652652e-2f,\n\t 2.277858e-1f,\n\t 3.737060e-1f,\n\t 5.108670e-1f,\n\t 6.360536e-1f,\n\t 7.463319e-1f,\n\t 8.391169e-1f,\n\t 9.122344e-1f,\n\t 9.639719e-1f,\n\t 9.931285e-1f,\n};\n///\t\u30ac\u30a6\u30b9\u30ce\u30fc\u30c9(\u91cd\u307f)\nstatic const float GaussNodeW[] =\n{\n\t1.761400e-2f,\n\t4.060142e-2f,\n\t6.267204e-2f,\n\t8.327674e-2f,\n\t1.019301e-1f,\n\t1.181945e-1f,\n\t1.316886e-1f,\n\t1.420961e-1f,\n\t1.491729e-1f,\n\t1.527533e-1f,\n\t1.527533e-1f,\n\t1.491729e-1f,\n\t1.420961e-1f,\n\t1.316886e-1f,\n\t1.181945e-1f,\n\t1.019301e-1f,\n\t8.327674e-2f,\n\t6.267204e-2f,\n\t4.060142e-2f,\n\t1.761400e-2f,\n};\n```\n\u4eca\u56de\u306f\u6700\u5927\u306720\u6b21\u307e\u3067\u3068\u3057\u307e\u3059\u3002\n\u30ac\u30a6\u30b9\u6c42\u7a4d\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u73fe\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```cpp\nfloat GetGaussianIntegral( float a, float b, float( *func )( float ), uint32_t degree = 20 )\n{\n\tif( func == NULL ){\n\t\tDEBUG_ASSERT( false, \"[%s]\u6c42\u7a4d\u3067\u304d\u307e\u305b\u3093\\n\", __FUNCTION__ );\n\t\treturn 0.0f;\n\t}\n\tfloat center = ( b - a ) * 0.5f;\n\tfloat integral = 0.0f;\n\tconst uint32_t N = ( degree <= NUMBEROF( GaussNodeW ) && degree <= NUMBEROF( GaussNodeX ) ) ? degree : static_cast<uint32_t>( fminf( NUMBEROF( GaussNodeW ), NUMBEROF( GaussNodeX ) ) );\n\tfor( uint32_t i = 0; i < N; ++i ){\n\t\tintegral += GaussNodeW[i] * func( ( center * GaussNodeX[i] ) + ( ( b + a ) * 0.5f ) );\n\t}\n\treturn center * integral;\n}\n```\nDEBUG_ASSERT\u306fassert, NUMBEROF\u306f\u914d\u5217\u306e\u8981\u7d20\u6570\u3092\u8868\u3059\u30de\u30af\u30ed\u3067\u3059\u3002\n\u88ab\u7a4d\u5206\u95a2\u6570\u3092\u95a2\u6570\u30dd\u30a4\u30f3\u30bf\u3067\u5f15\u6570\u306b\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u305d\u3053\u306f\u81e8\u6a5f\u5fdc\u5909\u306b\u30fb\u30fb\u30fb\u3002\n\nN\u3092\u5927\u304d\u304f\u3059\u308c\u3070\u3059\u308b\u307b\u3069\u7cbe\u5ea6\u306f\u9ad8\u304f\u306a\u308a\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306ePDF\u306b\u304a\u3044\u3066\u767a\u751f\u3059\u308b\u304b\u3069\u3046\u304b\u306f\u672a\u78ba\u8a8d\u3067\u3059\u304c\u3001\nN\u3092\u5927\u304d\u304f\u3059\u308b\u3068\u3001\u30eb\u30f3\u30b2\u73fe\u8c61\u304c\u767a\u751f\u3057\u3001\u307e\u3063\u305f\u304f\u4fe1\u983c\u3067\u304d\u308b\u5024\u3067\u306f\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u5927\u4e08\u592b\u3067\u3059\u304c\u3001\u4e07\u80fd\u3067\u306f\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\n##CDF\u306e\u5b9f\u73fe\n\u4e0d\u5b9a\u7a4d\u5206\u3082\u3001PDF\u3082\u5c0e\u51fa\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u306e\u3067\u3001\u6539\u3081\u3066CDF\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u3059\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```cpp\nfloat StandardNormalCDF( float x )\n{\n\tfloat ORIGINAL_POINT = 0.5f;\n\tif( x > 0.0f ){\n\t\treturn ORIGINAL_POINT + GetGaussianIntegral( 0.0f, x, StandardNormalPDF, 20 );\n\t}\n\telse if( x < 0.0f ){\n\t\treturn ORIGINAL_POINT - GetGaussianIntegral( x, 0.0f, StandardNormalPDF, 20 );\n\t}\n\treturn ORIGINAL_POINT;\n}\n```\n\n#\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u9006\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\n##\u76f8\u88dc\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570(CCDF)\n\u5b9a\u7fa9\u306b\u51fa\u73fe\u3057\u3066\u304d\u305f\u03a6^-1\u306f\u3001CDF\u306e\u9006\u95a2\u6570(\u9006\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570)\u3067\u3059\u3002\n\u3053\u308c\u3092\u6c42\u3081\u308b\u305f\u3081\u306b\u306f\u3001\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306e\u76f8\u88dc\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570(Complementary Cumulative Distribution Function \u7565:CCDF)\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\nCCDF\u306fCDF\u3068\u306e\u5408\u8a08\u304c1\u3068\u306a\u308b\u3088\u3046\u306a\u95a2\u6570\u306e\u3053\u3068\u3067\u3059\u3002\n\u3064\u307e\u308a\u3001CDF\u3092_F(x)_\u3001 CCDF\u3092_G(x)_\u3068\u3059\u308b\u3068\u3001\u6b21\u306e\u3088\u3046\u306a\u95a2\u4fc2\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\u3002\n\n```math\np = F(x)\\\\\nF(x) + G(x) = 1\\\\\nx = F^{-1}(p) = G^{-1}(1-p)\n```\n\n\u307e\u305f\u3001\u6b63\u898f\u5206\u5e03\u306e\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\u306e\u30b0\u30e9\u30d5\u3092\u898b\u308b\u3068\u3001\n<img src=\"https://upload.wikimedia.org/wikipedia/commons/c/ca/Normal_Distribution_CDF.svg\" width=\"500px\">\n\n\u30b0\u30e9\u30d5\u306f\u3001(x, \u03a6(x)) = (0, 0.5)\u3092\u4e2d\u5fc3\u3068\u3057\u3066\u3001\u4e0a\u4e0b\u5de6\u53f3\u5bfe\u79f0\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3064\u307e\u308a\u3001x\u304c\u8ca0\u306e\u5834\u5408\u306eCDF\u306e\u5024\u306f\u6b63\u65b9\u5411\u306eCCDF\u306e\u5024\u3068\u540c\u7b49\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\u3088\u3063\u3066\u3001\n\n```math\np = F(x) = G(-x)\\\\\nx = F^{-1}(p) = -G^{-1}(p)\n```\n\u3053\u306e\u3088\u3046\u306a\u95a2\u4fc2\u304c\u6210\u308a\u7acb\u3061\u307e\u3059\u3002\n\n\u9006\u7d2f\u7a4d\u5206\u5e03\u95a2\u6570\u306f\u3001CCDF\u306e\u9006\u95a2\u6570\u306b\u3088\u3063\u3066\u8868\u3059\u3053\u3068\u3082\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\n\n##CCDF\u306e\u6709\u7406\u8fd1\u4f3c\u516c\u5f0f\nAbramowitz and Stegun\u306b\u3088\u308b\u3068\u3001\n\n```math\np = G(x_{p})\n```\n\u3067\u8868\u3055\u308c\u308b\u6a19\u6e96\u6b63\u898f\u5206\u5e03\u306eCCDF\u306b\u304a\u3044\u3066\u3001\n0 < p \u2266 0.5\n\u306a\u3089\u3070\u3001\n\n```math\nx_{p} = t - \\frac{c_{0} + c_{1}t + c_{2}t^2}{1 + d_1t + d_2t^2 + d_3t^3} + \\epsilon(p)\\\\\nt = \\sqrt{log\\frac{1}{p^2}}\\\\\nc_0 = 2.515517 \\quad c_1 = 0.802853 \\quad c_2 = 0.010328\\\\\nd_1 = 1.432788 \\quad d_2 = 0.189269 \\quad d_3 = 0.001308\\\\\n|\\epsilon(p)| < 4.5 \\times 10^{-4}\n```\n\u3053\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u8a00\u3044\u307e\u3059\u3002\n\u3053\u3053\u3067\u3001\u8aa4\u5dee\u3067\u3042\u308b\u03b5(p)\u306f\u300110^-4\u3068\u3001\u975e\u5e38\u306b\u5c0f\u3055\u3044\u5024\u3068\u306a\u308a\u307b\u307c\u7121\u8996\u3067\u304d\u308b\u306e\u3067\u3001\n\u3053\u308c\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001CCDF\u306e\u9006\u95a2\u6570\u306e\u6709\u7406\u8fd1\u4f3c\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u308c\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u3059\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```cpp\nfloat GetRationalApproximation( float p )\n{\n\tconst float c[] = { 2.515517f, 0.802853f, 0.010328f };\n\tconst float d[] = { 1.432788f, 0.189269f, 0.001308f };\n\tfloat t = sqrtf( -2.0f * logf( p ) );\n\t//\t\u30db\u30fc\u30ca\u30fc\u6cd5\u306b\u3088\u3063\u3066\u516c\u5f0f\u3092\u6700\u9069\u5316\n\treturn t - ( ( c[2] * t + c[1] ) * t + c[0] ) / ( ( ( d[2] * t + d[1] ) * t + d[0] ) * t + 1.0f );\n}\n```\n\u591a\u9805\u5f0f\u306f\u3001\u30db\u30fc\u30ca\u30fc\u6cd5\u306b\u3088\u3063\u3066\u5909\u5f62\u3059\u308b\u3053\u3068\u3067\u8a08\u7b97\u56de\u6570\u3092\u6e1b\u3089\u3057\u307e\u3059\u3002\n\n\n##\u9006CDF\u306e\u5b9f\u73fe\n\u524d\u8ff0\u306e\u8fd1\u4f3c\u516c\u5f0f\u306b\u306f\u3001\u9069\u7528\u3055\u308c\u308b\u7bc4\u56f2\u304c\u3042\u308a\u307e\u3059\u3002\n0 < p \u2266 0.5\n\u3067\u3059\u3002\n\u5b9f\u969b\u306ep\u304c\u53d6\u308a\u3046\u308b\u7bc4\u56f2\u306f0 < p < 1\u3067\u3059\u306e\u3067\u30010.5 < p < 1\u306e\u5834\u5408\u3092\u6c42\u3081\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n0 < p < 1\u306a\u306e\u3067\u3001p > 0.5\u306e\u5834\u5408\u306f\u3001p'=1-p\u3068\u3059\u308c\u3070\u30010 < p' \u2266 0.5\u3068\u306a\u308a\u516c\u5f0f\u306b\u5f53\u3066\u306f\u3081\u308b\u3053\u3068\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001\u524d\u8ff0\u306eCDF\u3068CCDF\u306e\u95a2\u4fc2\u304b\u3089\u3001CDF\u306e\u9006\u95a2\u6570\u306f\u6b21\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```math\nx = \\begin{cases}\n-G^{-1}(p) & ( 0 < p \\leq 0.5 )\\\\\nG^{-1}(1 - p) & ( 0.5 < p < 1 )\n\\end{cases}\n```\n\u3053\u306e\u95a2\u4fc2\u304b\u3089\u3001\u6709\u7406\u8fd1\u4f3c\u516c\u5f0f\u306b\u5f53\u3066\u306f\u3081\u308b\u3053\u3068\u3067\u3001\u9006CDF\u3092\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\u3053\u308c\u3089\u3092\u8e0f\u307e\u3048\u305f\u4e0a\u3067\u3001\u9006CDF\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u73fe\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```cpp\nfloat StandardNormalCDFInverse( float x )\n{\n\tif( x <= 0.0f ){\n\t\tDEBUG_ASSERT( false, \"[%s]\u6c42\u3081\u3089\u308c\u307e\u305b\u3093\\n\", __FUNCTION__ );\n\t\treturn -FLT_MAX;\n\t}\n\telse if( x >= 1.0f ){\n\t\tDEBUG_ASSERT( false, \"[%s]\u6c42\u3081\u3089\u308c\u307e\u305b\u3093\\n\", __FUNCTION__ );\n\t\treturn FLT_MAX;\n\t}\n\treturn ( x < 0.5f ) ? -1.0f * GetRationalApproximation( x ) : GetRationalApproximation( 1.0f - x );\n}\n```\n\u30b0\u30e9\u30d5\u3092\u898b\u308b\u3068\u5206\u304b\u308a\u307e\u3059\u304c\u3001x\u22660\u3084x\u22671\u3067\u306f\u3001\u7d50\u679c\u306f\u00b1\u221e\u306b\u767a\u6563\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067\u6ce8\u610f\u3002\n\n\n#\u5207\u65ad\u6b63\u898f\u5206\u5e03\u306e\u4e71\u6570\u306e\u5b9f\u88c5\n\u5fc5\u8981\u306a\u8981\u7d20\u304c\u5168\u3066\u63c3\u3044\u307e\u3057\u305f\u306e\u3067\n\n```math\nx = \\phi^{-1}(\\phi(\\alpha) + U\\times(\\phi(\\beta) - \\phi(\\alpha) )\\sigma + \\mu \\\\\n(\\alpha = \\frac{a - \\mu}{\\sigma},\\quad \\beta = \\frac{b - \\mu}{\\sigma})\n```\n\u3053\u306e\u5b9a\u7fa9\u3092\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u8868\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```cpp\nfloat RandTruncatedNormal( float a, float b, float mu, float sigma )\n{\n\tfloat alpha = ( a - mu ) / sigma;\n\tfloat beta = ( b - mu ) / sigma;\n\treturn StandardNormalCDFInverse( StandardNormalCDF( alpha ) + ( RandF() * ( StandardNormalCDF( beta ) - StandardNormalCDF( alpha ) ) ) ) * sigma + mu;\n}\n```\n\u5b9f\u969b\u306f\u4f8b\u5916\u51e6\u7406\u306a\u3069\u304c\u542b\u307e\u308c\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306f\u7701\u7565\u3057\u3066\u3044\u307e\u3059\u3002(a, b, sigma\u306e\u5024\u304c\u7570\u5e38\u306a\u30b1\u30fc\u30b9\u306a\u3069)\n\nRandF()\u306f0 < u < 1\u306e\u7bc4\u56f2\u306e\u4e00\u69d8\u4e71\u6570\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570\u3067\u3059\u3002\n\u8272\u3005\u306a\u65b9\u6cd5\u304c\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u81ea\u5206\u306fXorshift\u3067\u4f5c\u3063\u3066\u3044\u307e\u3059\u3002\nXorshift\u306e\u5b9f\u88c5\u65b9\u6cd5\u306f\u30b0\u30b0\u308c\u3070\u3059\u3050\u51fa\u3066\u304f\u308b\u306e\u3067\u3053\u3053\u3067\u306f\u66f8\u304d\u307e\u305b\u3093\u3002\n\n\n#\u7d50\u679c\n\u4e0b\u9650\u30920\u3001\u4e0a\u9650\u30921\u3001\u5e73\u5747\u30920.8\u3001\u5206\u6563\u30920.36\u3068\u3057\u3066\n\u4e71\u6570\u751f\u6210\u309220000\u56de\u884c\u3063\u305f\u6642\u306e\u4e71\u6570\u306e\u5206\u5e03\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/143708/db74896e-05c8-a0aa-c02c-3488a8f28238.png\" width=\"750px\">\n\n0\u304b\u30891\u306e\u533a\u9593\u306b\u9650\u5b9a\u3055\u308c\u30010.8\u4ed8\u8fd1\u304c\u6700\u3082\u591a\u304f\u306a\u308b\u6b63\u898f\u5206\u5e03\u66f2\u7dda\u3068\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u5c11\u3057\u30c7\u30b3\u30dc\u30b3\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u3050\u3089\u3044\u306a\u3089\u30ac\u30c1\u30e3\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3067\u306f\u554f\u984c\u306a\u3055\u305d\u3046\u3067\u3059\u3002\n\u51e6\u7406\u6642\u9593\u3082\u304b\u306a\u308a\u77ed\u3044\u3067\u3059\u3002(\u5b9f\u6e2c\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u304c)\n\n\u4eca\u56de\u306f\u30b2\u30fc\u30e0\u306e\u3088\u3046\u306a\u9ad8\u3044\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u6027\u3092\u60f3\u5b9a\u3057\u3001\u9ad8\u901f\u3055\u3082\u610f\u8b58\u3057\u3066\u3044\u307e\u3059\u304c\u3001\n\u901f\u5ea6\u3088\u308a\u3082\u7cbe\u5ea6\u3092\u91cd\u8996\u3057\u305f\u3044\u5834\u5408\u306a\u3069\u306f\u3001\n\u30ac\u30a6\u30b9\u6c42\u7a4d\u306e\u6b21\u6570\u3092\u5927\u304d\u304f\u3057\u305f\u308a\u3001float\u3067\u306f\u306a\u304fdouble\u3092\u4f7f\u3063\u305f\u308a\u3001Xorshift\u3067\u306f\u306a\u304f\u30e1\u30eb\u30bb\u30f3\u30cc\u30c4\u30a4\u30b9\u30bf\u3092\u4f7f\u3063\u305f\u308a\u3068\u3001\n\u8272\u3005\u3068\u5fdc\u7528\u304c\u5229\u304d\u307e\u3059\u3002\n\n\n#\u53c2\u8003\u30b5\u30a4\u30c8\n* [Truncated normal distribution - Wikipedia](https://en.wikipedia.org/wiki/Truncated_normal_distribution)\n* [Normal distribution - Wikipedia](https://en.wikipedia.org/wiki/Normal_distribution)\n* [\u6b63\u898f\u5206\u5e03\u306e\u78ba\u7387\u8a08\u7b97\uff1aC++/Linux\u30d7\u30ed\u30b0\u30e9\u30e0](http://y-okamoto-psy1949.la.coocan.jp/CppBldr/CalcProbNormal/)\n* [\u30ac\u30a6\u30b9\uff65\u30eb\u30b8\u30e3\u30f3\u30c9\u30eb\u7a4d\u5206](http://www.geocities.jp/kouyoubako/GaussQuadrature.htm)\n* [Normal distribution inverse](https://www.johndcook.com/blog/normal_cdf_inverse/)\n\n\n\n", "tags": ["C", "C++", "\u6570\u5b66", "\u4e71\u6570"]}