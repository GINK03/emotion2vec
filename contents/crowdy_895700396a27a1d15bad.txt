{"context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\n\nhttpd\u3001php\u3001fuelphp \u306e\u958b\u767a\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u305f\u3002Local\u74b0\u5883\u306fWindows\u306a\u306e\u3067\u3001Global\u3067\u8a2d\u7f6e\u3059\u308b\u3053\u3068\u3088\u308aphp\u30a2\u30d7\u30ea\u6bce\u306b\u5404Middleware\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u65b9\u6cd5\u3092\u5de5\u592b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u8a00\u8a9e\u306fPowershell\u3002\n\nAdd-Type -AssemblyName System.IO.Compression.FileSystem\nfunction Unzip\n{\n    param([string]$zipfile, [string]$outpath)\n    [System.IO.Compression.ZipFile]::ExtractToDirectory($zipfile, $outpath)\n}\n\n$php_binary = @{\n  \"php-7.0.0-Win32-VC14-x64.zip\"  = \"http://windows.php.net/downloads/releases/php-7.0.0-Win32-VC14-x64.zip\"; \n  \"php-5.6.16-Win32-VC11-x64.zip\"  = \"http://windows.php.net/downloads/releases/php-5.6.16-Win32-VC11-x64.zip\";\n  \"php-5.5.30-Win32-VC11-x64.zip\"  = \"http://windows.php.net/downloads/releases/php-5.5.30-Win32-VC11-x64.zip\"; \n}\n\n$fuelphp_binary = @{\n  \"fuelphp-1.7.3.zip\" = \"http://fuelphp.com/files/download/34/fuelphp-1.7.3.zip\";\n  \"fuelphp-1.7.2.zip\" = \"http://fuelphp.com/files/download/28/fuelphp-1.7.2.zip\";\n  \"fuelphp-1.7.1.zip\" = \"http://fuelphp.com/files/download/26/fuelphp-1.7.1.zip\";\n  \"fuelphp-1.7.zip\" = \"http://fuelphp.com/files/download/25/fuelphp-1.7.zip\";\n  \"fuelphp-1.6.1.zip\" = \"http://fuelphp.com/files/download/24/fuelphp-1.6.1.zip\";\n}\n\n$httpd_binary = @{\n  \"httpd-2.4.18-win64-VC14.zip\" = \"https://www.apachelounge.com/download/VC14/binaries/httpd-2.4.18-win64-VC14.zip\"\n}\n\n#####################################################\n# EDIT HERE TO CHANGE INSTALLATION VERSION\n#####################################################\n$target_version_php = \"php-5.5.30-Win32-VC11-x64.zip\"\n$target_version_fuelphp = \"fuelphp-1.7.3.zip\"\n$target_version_httpd = \"httpd-2.4.18-win64-VC14.zip\"\n\n$install_path = \"D:\\dev\\myphpapp1\"\n$install_path_php = \"$install_path\\bin\\php\"\n$install_path_httpd = \"$install_path\\bin\\Apache24\"\n$install_path_documentroot = \"$install_path\\app\"\n\n#####################################################\n# Download binaries and extract them\n#####################################################\n\n#==========\n# PHP \n#==========\nmkdir $install_path_php | out-null\ncd \"$install_path\\bin\\\"\n$selected_binary_url_php = $php_binary[$target_version_php]\n\nInvoke-WebRequest $selected_binary_url_php -OutFile $target_version_php\nUnzip $($(pwd).Path + \"\\\" + $target_version_php) \"$(pwd)\\php\"\n\nd:\\opencloud\\zcom\\api\\bin\\php\\php.ini-production\n\n#==========\n# Edit php.ini\n#==========\ncopy \"$install_path_php\\php.ini-production\" \"$install_path_php\\php.ini\"\n$ini = get-content \"$install_path_php\\php.ini\"\n$ini = $ini.Replace('; extension_dir = \"ext\"', 'extension_dir = \"ext\"')\n$ini = $ini.Replace(';date.timezone =', 'date.timezone = \"UTC\"')\n\n\n$ini = $ini.Replace(\";extension=php_mbstring.dll\", \"extension=php_mbstring.dll\")\nSet-content \"$install_path_php\\php.ini\" $ini\n\n#==========\n# Httpd\n#==========\nmkdir $install_path_httpd | out-null\ncd \"$install_path\\bin\\\"\n$selected_binary_url_httpd = $httpd_binary[$target_version_httpd]\n\nInvoke-WebRequest $selected_binary_url_httpd -OutFile $target_version_httpd\nUnzip $($(pwd).Path + \"\\\" + $target_version_httpd) $(pwd)\n\n#==========\n# Edit httpd.conf\n#==========\ncopy \"$install_path_php\\php5apache2_4.dll\" \"$install_path_httpd\\modules\\\"\n\n$conf = get-content \"$install_path_httpd\\conf\\httpd.conf\"\n\n# change default setting\n$conf = $conf.Replace(\"admin@example.com\", \"address@email.com\")\n$conf = $conf.Replace( \"c:/Apache24/htdocs\", $install_path_documentroot.Replace('\\', '/') )\n$conf = $conf.Replace( \"c:/Apache24/cgi-bin\", \"$install_path_httpd\\cgi-bin\".Replace('\\', '/') )\n$conf = $conf.Replace( \"c:/Apache24\", $install_path_httpd.Replace('\\', '/') )\n$conf = $conf + @\"\n\n# \nLoadModule php5_module \"$( (\"$install_path_php\\php5apache2_4.dll\").Replace('\\', '/') )\"\nAddHandler application/x-httpd-php .php\n\n# configure the path to php.ini\nPHPIniDir \"$( ($install_path_php).Replace('\\', '/') )\"\n\"@\n\nSet-content \"$install_path_httpd\\conf\\httpd.conf\" $conf\n\n#==========\n# FuelPHP \n#==========\nmkdir $install_path_documentroot\ncd $install_path_httpd\n$selected_binary_url_fuelphp = $fuelphp_binary[$target_version_fuelphp]\n\nInvoke-WebRequest $selected_binary_url_fuelphp -OutFile $target_version_fuelphp\nUnzip $($(pwd).Path + \"\\\" + $target_version_fuelphp) $install_path_documentroot\n\n# cleaning\nrm *.zip\n\n# **\u76ee\u7684**\nhttpd\u3001php\u3001fuelphp \u306e\u958b\u767a\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u305f\u3002Local\u74b0\u5883\u306fWindows\u306a\u306e\u3067\u3001Global\u3067\u8a2d\u7f6e\u3059\u308b\u3053\u3068\u3088\u308aphp\u30a2\u30d7\u30ea\u6bce\u306b\u5404Middleware\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u65b9\u6cd5\u3092\u5de5\u592b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u8a00\u8a9e\u306fPowershell\u3002\n\n\n```ps1\n\nAdd-Type -AssemblyName System.IO.Compression.FileSystem\nfunction Unzip\n{\n    param([string]$zipfile, [string]$outpath)\n    [System.IO.Compression.ZipFile]::ExtractToDirectory($zipfile, $outpath)\n}\n\n$php_binary = @{\n  \"php-7.0.0-Win32-VC14-x64.zip\"  = \"http://windows.php.net/downloads/releases/php-7.0.0-Win32-VC14-x64.zip\"; \n  \"php-5.6.16-Win32-VC11-x64.zip\"  = \"http://windows.php.net/downloads/releases/php-5.6.16-Win32-VC11-x64.zip\";\n  \"php-5.5.30-Win32-VC11-x64.zip\"  = \"http://windows.php.net/downloads/releases/php-5.5.30-Win32-VC11-x64.zip\"; \n}\n\n$fuelphp_binary = @{\n  \"fuelphp-1.7.3.zip\" = \"http://fuelphp.com/files/download/34/fuelphp-1.7.3.zip\";\n  \"fuelphp-1.7.2.zip\" = \"http://fuelphp.com/files/download/28/fuelphp-1.7.2.zip\";\n  \"fuelphp-1.7.1.zip\" = \"http://fuelphp.com/files/download/26/fuelphp-1.7.1.zip\";\n  \"fuelphp-1.7.zip\" = \"http://fuelphp.com/files/download/25/fuelphp-1.7.zip\";\n  \"fuelphp-1.6.1.zip\" = \"http://fuelphp.com/files/download/24/fuelphp-1.6.1.zip\";\n}\n\n$httpd_binary = @{\n  \"httpd-2.4.18-win64-VC14.zip\" = \"https://www.apachelounge.com/download/VC14/binaries/httpd-2.4.18-win64-VC14.zip\"\n}\n\n#####################################################\n# EDIT HERE TO CHANGE INSTALLATION VERSION\n#####################################################\n$target_version_php = \"php-5.5.30-Win32-VC11-x64.zip\"\n$target_version_fuelphp = \"fuelphp-1.7.3.zip\"\n$target_version_httpd = \"httpd-2.4.18-win64-VC14.zip\"\n\n$install_path = \"D:\\dev\\myphpapp1\"\n$install_path_php = \"$install_path\\bin\\php\"\n$install_path_httpd = \"$install_path\\bin\\Apache24\"\n$install_path_documentroot = \"$install_path\\app\"\n\n#####################################################\n# Download binaries and extract them\n#####################################################\n\n#==========\n# PHP \n#==========\nmkdir $install_path_php | out-null\ncd \"$install_path\\bin\\\"\n$selected_binary_url_php = $php_binary[$target_version_php]\n\nInvoke-WebRequest $selected_binary_url_php -OutFile $target_version_php\nUnzip $($(pwd).Path + \"\\\" + $target_version_php) \"$(pwd)\\php\"\n\nd:\\opencloud\\zcom\\api\\bin\\php\\php.ini-production\n\n#==========\n# Edit php.ini\n#==========\ncopy \"$install_path_php\\php.ini-production\" \"$install_path_php\\php.ini\"\n$ini = get-content \"$install_path_php\\php.ini\"\n$ini = $ini.Replace('; extension_dir = \"ext\"', 'extension_dir = \"ext\"')\n$ini = $ini.Replace(';date.timezone =', 'date.timezone = \"UTC\"')\n\n\n$ini = $ini.Replace(\";extension=php_mbstring.dll\", \"extension=php_mbstring.dll\")\nSet-content \"$install_path_php\\php.ini\" $ini\n\n#==========\n# Httpd\n#==========\nmkdir $install_path_httpd | out-null\ncd \"$install_path\\bin\\\"\n$selected_binary_url_httpd = $httpd_binary[$target_version_httpd]\n\nInvoke-WebRequest $selected_binary_url_httpd -OutFile $target_version_httpd\nUnzip $($(pwd).Path + \"\\\" + $target_version_httpd) $(pwd)\n\n#==========\n# Edit httpd.conf\n#==========\ncopy \"$install_path_php\\php5apache2_4.dll\" \"$install_path_httpd\\modules\\\"\n\n$conf = get-content \"$install_path_httpd\\conf\\httpd.conf\"\n\n# change default setting\n$conf = $conf.Replace(\"admin@example.com\", \"address@email.com\")\n$conf = $conf.Replace( \"c:/Apache24/htdocs\", $install_path_documentroot.Replace('\\', '/') )\n$conf = $conf.Replace( \"c:/Apache24/cgi-bin\", \"$install_path_httpd\\cgi-bin\".Replace('\\', '/') )\n$conf = $conf.Replace( \"c:/Apache24\", $install_path_httpd.Replace('\\', '/') )\n$conf = $conf + @\"\n\n# \nLoadModule php5_module \"$( (\"$install_path_php\\php5apache2_4.dll\").Replace('\\', '/') )\"\nAddHandler application/x-httpd-php .php\n\n# configure the path to php.ini\nPHPIniDir \"$( ($install_path_php).Replace('\\', '/') )\"\n\"@\n\nSet-content \"$install_path_httpd\\conf\\httpd.conf\" $conf\n\n#==========\n# FuelPHP \n#==========\nmkdir $install_path_documentroot\ncd $install_path_httpd\n$selected_binary_url_fuelphp = $fuelphp_binary[$target_version_fuelphp]\n\nInvoke-WebRequest $selected_binary_url_fuelphp -OutFile $target_version_fuelphp\nUnzip $($(pwd).Path + \"\\\" + $target_version_fuelphp) $install_path_documentroot\n\n# cleaning\nrm *.zip\n```\n", "tags": ["PHP", "PowerShell", "FuelPHP", "Apache", "Windows"]}