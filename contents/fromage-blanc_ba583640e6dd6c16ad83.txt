{"context": "\u30a2\u30d7\u30ea\u5185\u306b\u8907\u6570\u307e\u305f\u304c\u308bWebView\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u65b9\u6cd5\u306e\u3072\u3068\u3064\u3068\u3057\u3066\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u524d\u63d0\n\n\nAlamofire 4.2.0\u3092\u4f7f\u7528\n\n\n1. \u8a8d\u8a3c\u30bb\u30c3\u30b7\u30e7\u30f3\u53d6\u5f97\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306a\u3069\u3067\u30b3\u30fc\u30eb\n\n// Swift 3.0\n// Alamofire 4.2.0\n\n/**\n\u3000\u8a8d\u8a3c\u30bb\u30c3\u30b7\u30e7\u30f3\uff08Cookie\uff09\u3092\u53d6\u5f97\u30fb\u4fdd\u5b58\u3059\u308b     \n\n - parameter authUrlString: \u8a8d\u8a3c(\u30ed\u30b0\u30a4\u30f3)URL \n - parameter authParams: \u8a8d\u8a3c\u60c5\u5831\u30c7\u30a3\u30af\u30b7\u30e7\u30ca\u30ea\n - returns: void\n*/\nfunc getAuthSession(_ authUrlString:String,authParams:Dictionary<String,String>) {\n\n    let storage = HTTPCookieStorage.shared\n\n    // Cookie\u30ea\u30bb\u30c3\u30c8\n    for cookie in storage.cookies! {\n        storage.deleteCookie(cookie)\n    }\n\n    var parameters:Dictionary<String,String> = [:]\n\n    for (key, value) in authParams {\n        parameters.updateValue(value, forKey: key)\n    }\n\n    Alamofire.request(authUrlString, method:.post, parameters:parameters ).response { response in\n\n        let res = response.response\n        let cookies = HTTPCookie.cookies(withResponseHeaderFields: res?.allHeaderFields as! [String : String], for: (res?.url!)!)\n\n    // Cookie\u4fdd\u5b58    \n    for i in 0 ..< cookies.count {\n        let cookie = cookies[i]\n\n        HTTPCookieStorage.shared.setCookie(cookie)\n    }\n}\n\n\n2. \u8a8d\u8a3c\u30bb\u30c3\u30b7\u30e7\u30f3\u4ed8\u304d\u3067URL\u30ed\u30fc\u30c9\n\u3042\u3089\u304b\u3058\u3081\u4e0a\u8a18\uff08getAuthSession\uff09\u306b\u3066\u53d6\u5f97\u3057\u305f\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4ed8\u4e0e\u3057\u3066URL\u3092\u30ed\u30fc\u30c9\n/**\n\u3000\u8a8d\u8a3c\u30bb\u30c3\u30b7\u30e7\u30f3\u4ed8\u304d\u3067URL\u3092\u30ed\u30fc\u30c9\u3059\u308b     \n\n - parameter urlString: URL\u6587\u5b57\u5217\n - parameter authUrlString: URL\u6587\u5b57\u5217\n - returns: void\n*/\nfunc loadRequestWithAuthSession(_ urlString:String,authUrlString:String,webView:UIWebView) {\n\n    // \u30bb\u30c3\u30b7\u30e7\u30f3\u4ed8\u304d\u3067\u30ed\u30fc\u30c9\u3057\u305f\u3044URL\n    let url = URL(string: urlString)\n\n    // \u8a8d\u8a3c(\u30ed\u30b0\u30a4\u30f3)URL\n    let authUrl = URL(string: authUrlString)\n\n    var request = URLRequest(url: url! as URL)\n\n    let cookies = HTTPCookieStorage.shared.cookies(for: authUrl! as URL)\n    let header  = HTTPCookie.requestHeaderFields(with: cookies!)\n    request.allHTTPHeaderFields = header\n\n    // \u30ed\u30fc\u30c9\n    webView.loadRequest(request as URLRequest)\n\n}\n\n\n\u304a\u304a\u3044\u306b\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u8a18\u4e8b\n\u3010Swift\u3011\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3cAPI\u3092\u901a\u3057\u305f\u5f8c\u3001\u540c\u4e00\u30bb\u30c3\u30b7\u30e7\u30f3\u3068\u3057\u3066UIWebView\u3092\u8868\u793a\u3059\u308b\n\n...\u672c\u8a18\u4e8b\u306f\u307b\u307c\u3053\u3061\u3089\u306eSwift/Alamofire\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u5bfe\u5fdc\u7248\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\n\n\u30a2\u30d7\u30ea\u5185\u306b\u8907\u6570\u307e\u305f\u304c\u308bWebView\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u65b9\u6cd5\u306e\u3072\u3068\u3064\u3068\u3057\u3066\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n## \u524d\u63d0\n- **Alamofire 4.2.0**\u3092\u4f7f\u7528\n\n## 1. \u8a8d\u8a3c\u30bb\u30c3\u30b7\u30e7\u30f3\u53d6\u5f97\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306a\u3069\u3067\u30b3\u30fc\u30eb\n\n```swift\n\n// Swift 3.0\n// Alamofire 4.2.0\n\n/**\n\u3000\u8a8d\u8a3c\u30bb\u30c3\u30b7\u30e7\u30f3\uff08Cookie\uff09\u3092\u53d6\u5f97\u30fb\u4fdd\u5b58\u3059\u308b     \n\n - parameter authUrlString: \u8a8d\u8a3c(\u30ed\u30b0\u30a4\u30f3)URL \n - parameter authParams: \u8a8d\u8a3c\u60c5\u5831\u30c7\u30a3\u30af\u30b7\u30e7\u30ca\u30ea\n - returns: void\n*/\nfunc getAuthSession(_ authUrlString:String,authParams:Dictionary<String,String>) {\n\n    let storage = HTTPCookieStorage.shared\n\n    // Cookie\u30ea\u30bb\u30c3\u30c8\n    for cookie in storage.cookies! {\n        storage.deleteCookie(cookie)\n    }\n        \n    var parameters:Dictionary<String,String> = [:]\n\n    for (key, value) in authParams {\n        parameters.updateValue(value, forKey: key)\n    }\n        \n    Alamofire.request(authUrlString, method:.post, parameters:parameters ).response { response in\n\n        let res = response.response\n        let cookies = HTTPCookie.cookies(withResponseHeaderFields: res?.allHeaderFields as! [String : String], for: (res?.url!)!)\n\n    // Cookie\u4fdd\u5b58    \n    for i in 0 ..< cookies.count {\n        let cookie = cookies[i]\n        \n        HTTPCookieStorage.shared.setCookie(cookie)\n    }\n}\n```\n\n## 2. \u8a8d\u8a3c\u30bb\u30c3\u30b7\u30e7\u30f3\u4ed8\u304d\u3067URL\u30ed\u30fc\u30c9\n\u3042\u3089\u304b\u3058\u3081\u4e0a\u8a18\uff08getAuthSession\uff09\u306b\u3066\u53d6\u5f97\u3057\u305f\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4ed8\u4e0e\u3057\u3066URL\u3092\u30ed\u30fc\u30c9\n\n```swift\n/**\n\u3000\u8a8d\u8a3c\u30bb\u30c3\u30b7\u30e7\u30f3\u4ed8\u304d\u3067URL\u3092\u30ed\u30fc\u30c9\u3059\u308b     \n\n - parameter urlString: URL\u6587\u5b57\u5217\n - parameter authUrlString: URL\u6587\u5b57\u5217\n - returns: void\n*/\nfunc loadRequestWithAuthSession(_ urlString:String,authUrlString:String,webView:UIWebView) {\n        \n    // \u30bb\u30c3\u30b7\u30e7\u30f3\u4ed8\u304d\u3067\u30ed\u30fc\u30c9\u3057\u305f\u3044URL\n    let url = URL(string: urlString)\n\n    // \u8a8d\u8a3c(\u30ed\u30b0\u30a4\u30f3)URL\n    let authUrl = URL(string: authUrlString)\n\n    var request = URLRequest(url: url! as URL)\n        \n    let cookies = HTTPCookieStorage.shared.cookies(for: authUrl! as URL)\n    let header  = HTTPCookie.requestHeaderFields(with: cookies!)\n    request.allHTTPHeaderFields = header\n    \n    // \u30ed\u30fc\u30c9\n    webView.loadRequest(request as URLRequest)\n\n}\n```\n\n### \u304a\u304a\u3044\u306b\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u3044\u305f\u8a18\u4e8b\n[\u3010Swift\u3011\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3cAPI\u3092\u901a\u3057\u305f\u5f8c\u3001\u540c\u4e00\u30bb\u30c3\u30b7\u30e7\u30f3\u3068\u3057\u3066UIWebView\u3092\u8868\u793a\u3059\u308b](http://qiita.com/ktanaka117/items/e4921f061f6522ed5a63)\n###### ...\u672c\u8a18\u4e8b\u306f\u307b\u307c\u3053\u3061\u3089\u306eSwift/Alamofire\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u5bfe\u5fdc\u7248\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059:relaxed:\n\n", "tags": ["UIWebView", "Swift3.0", "session", "cookie", "ios10"]}