{"context": "linuxOS\u306e\u591a\u304f\u306b\u6a19\u6e96\u642d\u8f09\u3055\u308c\u3066\u3044\u308bcurl\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u30b5\u30fc\u30d0\u304b\u3089WAN\u307e\u3067\u306e\u6642\u9593\u6bce\u306e\u5fdc\u7b54\u9045\u5ef6\u3092\u898b\u3066\u307f\u308b\u3002\n\n/etc/cron.d\u8a2d\u5b9a\n1/ * * * * root /tmp/networkHealth.sh\u3000>/dev/null 2>&1\n\n\nnetworkHealth.sh\n#!/bin/bash\n###########################################################\n## FunctionName : makeHeader\n## $1 : logfilepass&filename\n###########################################################\nmakeHeader()\n{\ntouch $1\ncat curl_header_env.config >>$1\n}\n\n###########################################################\n## FunctionName : healthCheck\n## $1 : logfilepass&filename\n## $2 : TargetURL\n###########################################################\nhealthCheck()\n{\necho -n `date \"+%H:%M:%S\"`, >>$1\ncurl ${2} -o /dev/null -w @curl_env.config -s 2> /dev/null 1>>${1}\necho `date \"+%H:%M:%S\"` >>$1\n}\n\nmain()\n{\n#init\nURL=https://www.google.co.jp/\nLOG_PATH=/tmp\nLOG_FILE=`date \"+%Y%m%d\"_status.log`\n\n#logfile check\nif [ -e ${LOG_PATH}/${LOG_FILE} ]; then\n    echo [info] Log\u3000file already exist...skip make file.\nelse\n    echo [info] Create a log file to a new\n    makeHeader ${LOG_PATH}/${LOG_FILE}\nfi\n\n#healthCheck\nhealthCheck ${LOG_PATH}/${LOG_FILE} ${URL}\n}\n\necho [info] `basename $0` started\nmain $*\necho [info] `basename $0` ended\nexit 0\n\n\n\ncurl\u51fa\u529b\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb(curl_env.config)\n%{url_effective},\n%{http_code},\n%{http_connect},\n%{time_total},\n%{time_namelookup},\n%{time_connect},\n%{time_appconnect},\n%{time_pretransfer},\n%{time_redirect},\n%{time_starttransfer},\n%{size_download},\n%{size_upload},\n%{size_header},\n%{size_request},\n%{speed_download},\n%{speed_upload},\n%{content_type},\n%{num_connects},\n%{num_redirects},\n%{redirect_url},\n%{ftp_entry_path},\n%{ssl_verify_result},\n\n\n\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u30d8\u30c3\u30c0\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb(curl_header_env.config)\nstart_time,url_effective,http_code,http_connect,time_total,time_namelookup,time_connect,time_appconnect,time_pretransfer,time_redirect,time_starttransfer,size_download,size_upload,size_header,size_request,speed_download,speed_upload,content_type,num_connects,num_redirects,redirect_url,ftp_entry_path,ssl_verify_result.end_time\n\n\u3046\u30fc\u3093\u3001curl\u3063\u3066\u76f8\u5bfe\u6642\u9593\u306f\u8c4a\u5bcc\u306b\u3042\u308b\u3051\u3069\u3001\u53d6\u5f97\u958b\u59cb\u3001\u7d42\u4e86\u306e\u7d76\u5bfe\u6642\u9593\u306f\u306a\u3044\u306e\u304b\u306a\u3002\n\u7121\u7406\u77e2\u7406\u524d\u5f8c\u3067date\u3067\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002\n\u5404\u5024\u306e\u610f\u5473\u306fman curl\u3067\u30aa\u30ca\u30b7\u30e3\u30b9\u3002\n\nlog\n cat 20160511_status.log \nstart_time,url_effective,http_code,http_connect,time_total,time_namelookup,time_connect,time_appconnect,time_pretransfer,time_redirect,time_starttransfer,size_download,size_upload,size_header,size_request,speed_download,speed_upload,content_type,num_connects,num_redirects,redirect_url,ftp_entry_path,ssl_verify_result.end_time\n00:20:01,https://www.google.co.jp/,200,000,5.233,5.047,5.061,5.157,5.157,0.000,5.232,10790,0,735,179,2062.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:20:02\n00:21:01,https://www.google.co.jp/,200,000,5.367,5.045,5.060,5.301,5.301,0.000,5.366,10694,0,735,179,1992.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:21:03\n00:22:02,https://www.google.co.jp/,200,000,5.242,5.063,5.077,5.174,5.174,0.000,5.242,10714,0,735,179,2043.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:22:03\n00:23:01,https://www.google.co.jp/,200,000,5.229,5.045,5.059,5.159,5.159,0.000,5.229,10743,0,735,179,2054.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:23:04\n00:24:01,https://www.google.co.jp/,200,000,5.233,5.048,5.064,5.165,5.165,0.000,5.233,10768,0,735,179,2057.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:24:02\n\n\n\u53c2\u8003\ncurl\u3067HTTP\u51e6\u7406\u306b\u304b\u304b\u3063\u305f\u6642\u9593\u3092\u8a08\u6e2c\u3059\u308b\ncurl\u3067\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u8abf\u67fb\u3092\u3059\u308b\nlinuxOS\u306e\u591a\u304f\u306b\u6a19\u6e96\u642d\u8f09\u3055\u308c\u3066\u3044\u308bcurl\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u30b5\u30fc\u30d0\u304b\u3089WAN\u307e\u3067\u306e\u6642\u9593\u6bce\u306e\u5fdc\u7b54\u9045\u5ef6\u3092\u898b\u3066\u307f\u308b\u3002\n\n#/etc/cron.d\u8a2d\u5b9a\n```\n1/ * * * * root /tmp/networkHealth.sh\u3000>/dev/null 2>&1\n```\n#networkHealth.sh\n```\n#!/bin/bash\n###########################################################\n## FunctionName : makeHeader\n## $1 : logfilepass&filename\n###########################################################\nmakeHeader()\n{\ntouch $1\ncat curl_header_env.config >>$1\n}\n\n###########################################################\n## FunctionName : healthCheck\n## $1 : logfilepass&filename\n## $2 : TargetURL\n###########################################################\nhealthCheck()\n{\necho -n `date \"+%H:%M:%S\"`, >>$1\ncurl ${2} -o /dev/null -w @curl_env.config -s 2> /dev/null 1>>${1}\necho `date \"+%H:%M:%S\"` >>$1\n}\n\nmain()\n{\n#init\nURL=https://www.google.co.jp/\nLOG_PATH=/tmp\nLOG_FILE=`date \"+%Y%m%d\"_status.log`\n\n#logfile check\nif [ -e ${LOG_PATH}/${LOG_FILE} ]; then\n    echo [info] Log\u3000file already exist...skip make file.\nelse\n    echo [info] Create a log file to a new\n    makeHeader ${LOG_PATH}/${LOG_FILE}\nfi\n\n#healthCheck\nhealthCheck ${LOG_PATH}/${LOG_FILE} ${URL}\n}\n\necho [info] `basename $0` started\nmain $*\necho [info] `basename $0` ended\nexit 0\n\n```\n\n#curl\u51fa\u529b\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb(curl_env.config)\n```\n%{url_effective},\n%{http_code},\n%{http_connect},\n%{time_total},\n%{time_namelookup},\n%{time_connect},\n%{time_appconnect},\n%{time_pretransfer},\n%{time_redirect},\n%{time_starttransfer},\n%{size_download},\n%{size_upload},\n%{size_header},\n%{size_request},\n%{speed_download},\n%{speed_upload},\n%{content_type},\n%{num_connects},\n%{num_redirects},\n%{redirect_url},\n%{ftp_entry_path},\n%{ssl_verify_result},\n```\n\n#\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u30d8\u30c3\u30c0\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb(curl_header_env.config)\n```\nstart_time,url_effective,http_code,http_connect,time_total,time_namelookup,time_connect,time_appconnect,time_pretransfer,time_redirect,time_starttransfer,size_download,size_upload,size_header,size_request,speed_download,speed_upload,content_type,num_connects,num_redirects,redirect_url,ftp_entry_path,ssl_verify_result.end_time\n```\n\u3046\u30fc\u3093\u3001curl\u3063\u3066\u76f8\u5bfe\u6642\u9593\u306f\u8c4a\u5bcc\u306b\u3042\u308b\u3051\u3069\u3001\u53d6\u5f97\u958b\u59cb\u3001\u7d42\u4e86\u306e\u7d76\u5bfe\u6642\u9593\u306f\u306a\u3044\u306e\u304b\u306a\u3002\n\u7121\u7406\u77e2\u7406\u524d\u5f8c\u3067date\u3067\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002\n\u5404\u5024\u306e\u610f\u5473\u306fman curl\u3067\u30aa\u30ca\u30b7\u30e3\u30b9\u3002\n\n#log\n```\n cat 20160511_status.log \nstart_time,url_effective,http_code,http_connect,time_total,time_namelookup,time_connect,time_appconnect,time_pretransfer,time_redirect,time_starttransfer,size_download,size_upload,size_header,size_request,speed_download,speed_upload,content_type,num_connects,num_redirects,redirect_url,ftp_entry_path,ssl_verify_result.end_time\n00:20:01,https://www.google.co.jp/,200,000,5.233,5.047,5.061,5.157,5.157,0.000,5.232,10790,0,735,179,2062.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:20:02\n00:21:01,https://www.google.co.jp/,200,000,5.367,5.045,5.060,5.301,5.301,0.000,5.366,10694,0,735,179,1992.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:21:03\n00:22:02,https://www.google.co.jp/,200,000,5.242,5.063,5.077,5.174,5.174,0.000,5.242,10714,0,735,179,2043.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:22:03\n00:23:01,https://www.google.co.jp/,200,000,5.229,5.045,5.059,5.159,5.159,0.000,5.229,10743,0,735,179,2054.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:23:04\n00:24:01,https://www.google.co.jp/,200,000,5.233,5.048,5.064,5.165,5.165,0.000,5.233,10768,0,735,179,2057.000,0.000,text/html; charset=Shift_JIS,1,0,,,0,00:24:02\n```\n#\u53c2\u8003\n[curl\u3067HTTP\u51e6\u7406\u306b\u304b\u304b\u3063\u305f\u6642\u9593\u3092\u8a08\u6e2c\u3059\u308b\n](http://rikuga.me/2014/03/11/curl%E3%81%A7http%E5%87%A6%E7%90%86%E3%81%AB%E3%81%8B%E3%81%8B%E3%81%A3%E3%81%9F%E6%99%82%E9%96%93%E3%82%92%E8%A8%88%E6%B8%AC%E3%81%99%E3%82%8B/)[curl\u3067\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u8abf\u67fb\u3092\u3059\u308b](http://d.hatena.ne.jp/akuwano/20120503/1335994486)\n", "tags": ["curl"]}