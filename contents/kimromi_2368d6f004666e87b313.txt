{"tags": ["Groovy", "spock", "HttpClient", "api", "RESTful"], "context": " More than 1 year has passed since last update.\n\n \u305f\u3068\u3048\u3070\u3053\u3093\u306aAPI\nGET /bookmarks\n(example) http://localhost/bookmarks\n\n[\n    {\n        \"id\": \"1\",\n        \"name\": \"\u30aa\u30ad\u30cb1\",\n        \"url\": \"http:/hogehoge.com/okini1\"\n    },\n    {\n        \"id\": \"2\",\n        \"name\": \"\u30aa\u30ad\u30cb2\",\n        \"url\": \"http:/hogehoge.com/okini2\"\n    },\n    {\n        \"id\": \"3\",\n        \"name\": \"\u30aa\u30ad\u30cb3\",\n        \"url\": \"http:/hogehoge.com/okini3\"\n    }\n]\n\nGET /bookmarks/{id}\n(example) http://localhost/bookmarks/2\n\n{\n    \"id\": \"2\",\n    \"name\": \"\u30aa\u30ad\u30cb2\",\n    \"url\": \"http:/hogehoge.com/okini2\"\n}\n\n\n \u3044\u304d\u306a\u308a\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n@Grab('org.spockframework:spock-core:0.7-groovy-2.0')\n@Grab('org.codehaus.groovy.modules.http-builder:http-builder:0.7.1')\n\nimport groovyx.net.http.RESTClient\nimport static groovyx.net.http.ContentType.*\nimport org.apache.http.client.HttpResponseException\nimport spock.lang.Specification\nimport spock.lang.Unroll\n\nclass Test extends Specification {\n\n    def ROOT = \"http://localhost/\"\n    def http = new RESTClient(ROOT)\n\n    def \"URL NotFound\"() {\n        when:\n        http.get(path: \"hoge\")\n\n        then:\n        def e = thrown(HttpResponseException)\n        e.statusCode == 404\n        e.message == \"Not Found\"\n    }\n\n    @Unroll\n    def \"test bookmarks\"() {\n        when:\n        def res = http.get(path: \"bookmarks\", contentType: JSON)\n        def resData = res.responseData\n\n        then:\n        notThrown(HttpResponseException)\n        resData.size() == 3\n        resData[i].id == t_id\n        resData[i].name == t_name\n        resData[i].url == t_url\n\n        where:\n        i || t_id | t_name    | t_url\n        0 || \"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n        1 || \"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n        2 || \"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n    }\n\n    @Unroll\n    def \"test bookmarks/#t_id\"() {\n        when:\n        def res = http.get(path: \"bookmarks/${t_id}\", contentType: JSON)\n        def resData = res.responseData\n\n        then:\n        notThrown(HttpResponseException)\n        resData.size() == 3\n        resData.id == t_id\n        resData.name == t_name\n        resData.url == t_url\n\n        where:\n        t_id | t_name    | t_url\n        \"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n        \"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n        \"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n    }\n}\n\n\n \u8aac\u660e\n\n \u6e96\u5099\n@Grab('org.spockframework:spock-core:0.7-groovy-2.0')\n@Grab('org.codehaus.groovy.modules.http-builder:http-builder:0.7.1')\n\nGrape\u3092\u3064\u304b\u3063\u3066spock\u3068http-builder(RESTClient)\u3092\u53d6\u5f97\u3057\u3066\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\nclass Test extends Specification {\n\n\u30c6\u30b9\u30c8\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u304c\u3001spock\u306eSpecification\u30af\u30e9\u30b9\u3092\u7d99\u627f\u3059\u308b\u3053\u3068\u3067\nspock\u306e\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3068\u3057\u3066\u30c6\u30b9\u30c8\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\n    def ROOT = \"http://localhost/\"\n    def http = new RESTClient(ROOT)\n\nRESTClient\u3092new\u3057\u3066\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5f15\u6570\u306b\u30eb\u30fc\u30c8URL\u3092\u6e21\u3057\u3066\u3042\u3052\u308c\u3070\nHTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u51fa\u6765\u4e0a\u304c\u308a\u3002\n\n ID\u6307\u5b9a\u306a\u3057\u306e\u30c6\u30b9\u30c8\n    @Unroll\n    def \"test bookmarks\"() {\n        when:\n        def res = http.get(path: \"bookmarks\", contentType: JSON)\n        def resData = res.responseData\n\n        then:\n        notThrown(HttpResponseException)\n        resData.size() == 3\n        resData[i].id == t_id\n        resData[i].name == t_name\n        resData[i].url == t_url\n\n        where:\n        i || t_id | t_name    | t_url\n        0 || \"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n        1 || \"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n        2 || \"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n    }\n\n\u3053\u308c\u304c\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306e\u304b\u305f\u307e\u308a\u3067\u3059\u3002def \"\u30c6\u30b9\u30c8\u540d\"() {} \u3067\u56f2\u307f\u307e\u3059\u3002\nspock\u306e\u30c6\u30b9\u30c8\u306e\u57fa\u672c\u3068\u3057\u3066\u3001\n\nwhen \u2192 \u3053\u306e\u64cd\u4f5c\u3092\u3057\u305f\u3068\u304d\u3001\nthen \u2192 \u3053\u3046\u3044\u3046\u7d50\u679c\u306b\u306a\u308b\u3002\n\n\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3067\u3059\u306e\u3067\u3001\n        when:\n        def res = http.get(path: \"bookmarks\", contentType: JSON)\n        def resData = res.responseData\n\n\u306e\u64cd\u4f5c\u304c\u3055\u308c\u305f\u3068\u304d\u3001\n        then:\n        notThrown(HttpResponseException)\n        resData.size() == 3\n        resData[i].id == id\n        resData[i].name == name\n        resData[i].url == url\n\n\u3068\u3044\u3046\u7d50\u679c\u306b\u306a\u308b\u306e\u304c\u6b63\u3057\u3044\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n when\n        when:\n        def res = http.get(path: \"bookmarks\", contentType: JSON)\n        def resData = res.responseData\n\nhttp\u306fRESTClient\u3067\u3059\u304c\u3001get\u30e1\u30bd\u30c3\u30c9\u3067GET\u3067\u63a5\u7d9a\u3057\u307e\u3059\u3002\npath\u306b\u306fURL\u306e\u30d1\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u2192http://localhost/bookmarks\u306bGET\u63a5\u7d9a\uff01\n\u8fd4\u3063\u3066\u304d\u305f\u30c7\u30fc\u30bf\u304b\u3089responseData\u3092\u53d6\u308a\u51fa\u3057\u3001JSON\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n then\n        then:\n        notThrown(HttpResponseException)\n        resData.size() == 3\n        resData[i].id == id\n        resData[i].name == name\n        resData[i].url == url\n\nwhen\u306e\u64cd\u4f5c\u304c\u3055\u308c\u305f\u5f8c\u3001then\u3067\u8a55\u4fa1\u3057\u307e\u3059\u3002\nRESTClient\u306f\u63a5\u7d9a\u7d50\u679c\u304c\u30a8\u30e9\u30fc\u3060\u3063\u305f\u5834\u5408HttpResponseException\u304c\u6295\u3052\u3089\u308c\u307e\u3059\u304c\nnotThrown\u3067HttpResponseException\u304c\u6295\u3052\u3089\u308c\u306a\u3044\uff08\u63a5\u7d9a\u6210\u529f\uff09\u3053\u3068\u3092\u8a55\u4fa1\u3057\u307e\u3059\u3002\n\u30ec\u30b9\u30dd\u30f3\u30b9JSON\u306fList\u5f62\u5f0f\u3067resData\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u3001\nresData.size()\u3067\u4f55\u4ef6\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u8fd4\u3063\u3066\u304d\u305f\u304b\u3092\u8a55\u4fa1\u3067\u304d\u307e\u3059\u3002\n\n where\n\u3053\u3053\u3067where\u3068\u3044\u3046\u4fbf\u5229\u306a\u8a18\u8ff0\u304c\u3042\u308a\u307e\u3059\u3002\n        then:\n        notThrown(HttpResponseException)\n        resData.size() == 3\n        resData[i].id == t_id\n        resData[i].name == t_name\n        resData[i].url == t_url\n\n        where:\n        i || t_id | t_name    | t_url\n        0 || \"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n        1 || \"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n        2 || \"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n\nthen\u306ei\u3001t_id\u3001t_name\u3001t_url\u306f\u5b9f\u306f\u5909\u6570\u3067\u3001where\u3067\u30c7\u30fc\u30bf\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\ni=0 \u306e\u3068\u304d\u3001t_id=\"1\"\u3001t_name=\"\u30aa\u30ad\u30cb1\"\u3001t_url=\"http:/hogehoge.com/okini1\" \u3060\uff01\ni=1 \u306e\u3068\u304d\u3001t_id=\"2\"\u3001t_name=\"\u30aa\u30ad\u30cb2\"\u3001t_url=\"http:/hogehoge.com/okini2\" \u3060\uff01\ni=1 \u306e\u3068\u304d\u3001t_id=\"3\"\u3001t_name=\"\u30aa\u30ad\u30cb3\"\u3001t_url=\"http:/hogehoge.com/okini3\" \u3060\uff01\n\n\u3068\u3044\u3046\u306e\u3092where\u306e3\u884c\u3067\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u306e\u3067where\u306e\u8a18\u8ff0\u3067\u30c6\u30b9\u30c8\u30b1\u30fc\u30b93\u3064\u5206\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\uff08\u5148\u982d\u306b@Unroll\u3092\u3064\u3051\u3066\u305f\u5834\u5408\uff09\n\u30fb\u30fb\u30fb\u3068\u3044\u3063\u305f\u611f\u3058\u3067\u8a55\u4fa1\u3067\u304d\u307e\u3059\u3002\n\n ID\u6307\u5b9a\u3042\u308a\u306e\u30c6\u30b9\u30c8\n    @Unroll\n    def \"test bookmarks/#t_id\"() {\n        when:\n        def res = http.get(path: \"bookmarks/${t_id}\", contentType: JSON)\n        def resData = res.responseData\n\n        then:\n        notThrown(HttpResponseException)\n        resData.size() == 3\n        resData.id == t_id\n        resData.name == t_name\n        resData.url == t_url\n\n        where:\n        t_id | t_name    | t_url\n        \"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n        \"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n        \"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n    }\n\nID\u6307\u5b9a\u306a\u3057\u3068\u307b\u3068\u3093\u3069\u5909\u308f\u3089\u306a\u3044\u3067\u3059\u304c\nwhen\u306epath\u6307\u5b9a\u3067\"bookmarks/${t_id}\"\u306e\u8a18\u8ff0\u304c\u3042\u308a\u307e\u3059\u304c\nwhen\u306e\u4e2d\u306e\u5024\u3082where\u3067\u6307\u5b9a\u3067\u304d\u308b\u3088\uff01\u3063\u3066\u611f\u3058\u3067\u3059\u3002\n\u3042\u3068\u306f\u6700\u521d\u306edef \"test bookmarks/#t_id\"() {\u3067\u3059\u304c\n\u30c6\u30b9\u30c8\u540d\u306b#\u5909\u6570\u540d\u3063\u3066\u3059\u308b\u3068\u30c6\u30b9\u30c8\u540d\u3092\u52d5\u7684\u306b\u5909\u66f4\u3067\u304d\u308b\u3088\uff01\u3063\u3066\u611f\u3058\u3067\u3059\u3002\n\n NotFound\u306e\u30c6\u30b9\u30c8\n    def \"URL NotFound\"() {\n        when:\n        http.get(path: \"hoge\")\n\n        then:\n        def e = thrown(HttpResponseException)\n        e.statusCode == 404\n        e.message == \"Not Found\"\n    }\n\npath\u3067\u5b58\u5728\u3057\u306a\u3044\u30d1\u30b9\u3092\u3057\u305f\u3068\u304d\u306f404\u306b\u306a\u308aHttpResponseException\u304c\u6295\u3052\u3089\u308c\u308b\u306e\u3067\nHttpResponseException\u304c\u30b9\u30ed\u30fc\u3055\u308c\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u306f404\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\"Not Found\"\u3060\uff01\u3068\u3044\u3046\u306e\u3092\u8a55\u4fa1\u3057\u3066\u307e\u3059\u3002\n\n\u30c6\u30b9\u30c8\u7d50\u679c\n\n \u30c6\u30b9\u30c8\u7d50\u679c\u304c\u3059\u3079\u3066OK\u306e\u3068\u304d\nJUnit 4 Runner, Tests: 7, Failures: 0, Time: 530           # 7\u4ef6\u30c6\u30b9\u30c8\u3067\u30a8\u30e9\u30fc\u306a\u3057\u3002\n\n7\u4ef6\u30c6\u30b9\u30c8\u306e\u5185\u8a33\u306fID\u6307\u5b9a\u306a\u3057:3\u4ef6\u3001ID\u6307\u5b9a\u3042\u308a:3\u4ef6\u3001NotFound:1\u4ef6\u3002\n\n \u30c6\u30b9\u30c8\u7d50\u679c\u304cNG\u3060\u3063\u305f\u3068\u304d\nJUnit 4 Runner, Tests: 7, Failures: 1, Time: 609           # 7\u4ef6\u30c6\u30b9\u30c8\u3067\u30a8\u30e9\u30fc1\u4ef6\u3002\nTest Failure: test bookmarks/2(Test)                       # test bookmarks/2 \u306e\u30c6\u30b9\u30c8\u3067\u5931\u6557\u3002\nCondition not satisfied:\n\nresData.url == t_url                                       # resData.url == t_url \u306e\u884c\u3067\u5931\u6557\u3002\n|       |   |  |                                           # \u5177\u4f53\u7684\u306b\u3069\u3046\u9055\u3046\u304b\u3092\u8868\u793a\u3057\u3066\u304f\u308c\u308b\u3002\n|       |   |  http:/hogehoge.com/okini3\n|       |   false\n|       |   1 difference (96% similarity)\n|       |   http:/hogehoge.com/okini(2)\n|       |   http:/hogehoge.com/okini(3)\n|       http:/hogehoge.com/okini2\n[id:2, name:\u30aa\u30ad\u30cb2, url:http:/hogehoge.com/okini2]\n\n    at Test.test bookmarks/#t_id(test.groovy:56)       # \u30bd\u30fc\u30b9\u306e\u3069\u306e\u884c\u3067\u5931\u6557\u3057\u305f\u304b\u3002\n\n\u81f3\u308c\u308a\u5c3d\u304f\u305b\u308a\uff01\n\u3069\u3053\u304c\u3069\u3046\u9055\u3046\u304b\u3001\u4f55\u30d1\u30fc\u30bb\u30f3\u30c8\u5408\u81f4\u3057\u3066\u3044\u308b\u304b\u307e\u3067\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u3082\u3046\u30c6\u30b9\u30c8\u5931\u6557\u3055\u305b\u305f\u3044\u304f\u3089\u3044\uff01\n\n \u307e\u3068\u3081\n\u304a\u3082\u306bspock\u306e\u6982\u8981\u8aac\u660e\u3067\u3057\u305f\u304cAPI\u30c6\u30b9\u30c8\u3060\u3051\u3067\u306a\u304fUnit\u30c6\u30b9\u30c8\u3082\u3082\u3061\u308d\u3093\u3067\u304d\u308b\u306e\u3067\u304b\u306a\u30fc\u308a\u4fbf\u5229\u306b\u306a\u3063\u305f\u308a\u3057\u307e\u3059\u3002\nGradle\u306b\u7d44\u307f\u8fbc\u3093\u3060\u308a\u3057\u3066\u3082\u30c6\u30b9\u30c8\u30ec\u30dd\u30fc\u30c8\u304cJUnit\u3068\u540c\u3058\u5f62\u5f0f\u3067\u51fa\u529b\u3055\u308c\u308b\u306e\u3067\u898b\u3084\u3059\u304b\u3063\u305f\u3067\u3059\u3002\n\n \u30b5\u30f3\u30d7\u30eb\n\u30b5\u30f3\u30d7\u30eb\u3092GitHub\u306b\u304a\u304d\u307e\u3057\u305f\u3002\nAPI\u30b5\u30fc\u30d0\u306f\u9069\u5f53\u306bSinatra\u3067\u66f8\u3044\u3066\u307e\u3059\u3002\nhttps://github.com/hiromikimura/spock-api-test\n## <i class=\"fa fa-hand-o-right\"/> \u305f\u3068\u3048\u3070\u3053\u3093\u306aAPI\n\n```\nGET /bookmarks\n(example) http://localhost/bookmarks\n```\n\n```json\n[\n\t{\n\t\t\"id\": \"1\",\n\t\t\"name\": \"\u30aa\u30ad\u30cb1\",\n\t\t\"url\": \"http:/hogehoge.com/okini1\"\n\t},\n\t{\n\t\t\"id\": \"2\",\n\t\t\"name\": \"\u30aa\u30ad\u30cb2\",\n\t\t\"url\": \"http:/hogehoge.com/okini2\"\n\t},\n\t{\n\t\t\"id\": \"3\",\n\t\t\"name\": \"\u30aa\u30ad\u30cb3\",\n\t\t\"url\": \"http:/hogehoge.com/okini3\"\n\t}\n]\n```\n\n```\nGET /bookmarks/{id}\n(example) http://localhost/bookmarks/2\n```\n\n```json\n{\n\t\"id\": \"2\",\n\t\"name\": \"\u30aa\u30ad\u30cb2\",\n\t\"url\": \"http:/hogehoge.com/okini2\"\n}\n```\n\n## <i class=\"fa fa-hand-o-right\"/> \u3044\u304d\u306a\u308a\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n```groovy\n@Grab('org.spockframework:spock-core:0.7-groovy-2.0')\n@Grab('org.codehaus.groovy.modules.http-builder:http-builder:0.7.1')\n\nimport groovyx.net.http.RESTClient\nimport static groovyx.net.http.ContentType.*\nimport org.apache.http.client.HttpResponseException\nimport spock.lang.Specification\nimport spock.lang.Unroll\n\nclass Test extends Specification {\n\n\tdef ROOT = \"http://localhost/\"\n\tdef http = new RESTClient(ROOT)\n\n\tdef \"URL NotFound\"() {\n\t\twhen:\n\t\thttp.get(path: \"hoge\")\n\n\t\tthen:\n\t\tdef e = thrown(HttpResponseException)\n\t\te.statusCode == 404\n\t\te.message == \"Not Found\"\n\t}\n\n\t@Unroll\n\tdef \"test bookmarks\"() {\n\t\twhen:\n\t\tdef res = http.get(path: \"bookmarks\", contentType: JSON)\n\t\tdef resData = res.responseData\n\n\t\tthen:\n\t\tnotThrown(HttpResponseException)\n\t\tresData.size() == 3\n\t\tresData[i].id == t_id\n\t\tresData[i].name == t_name\n\t\tresData[i].url == t_url\n\n\t\twhere:\n\t\ti || t_id | t_name    | t_url\n\t\t0 || \"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n\t\t1 || \"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n\t\t2 || \"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n\t}\n\n\t@Unroll\n\tdef \"test bookmarks/#t_id\"() {\n\t\twhen:\n\t\tdef res = http.get(path: \"bookmarks/${t_id}\", contentType: JSON)\n\t\tdef resData = res.responseData\n\n\t\tthen:\n\t\tnotThrown(HttpResponseException)\n\t\tresData.size() == 3\n\t\tresData.id == t_id\n\t\tresData.name == t_name\n\t\tresData.url == t_url\n\n\t\twhere:\n\t\tt_id | t_name    | t_url\n\t\t\"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n\t\t\"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n\t\t\"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n\t}\n}\n```\n\n## <i class=\"fa fa-hand-o-right\"/> \u8aac\u660e\n\n### <i class=\"fa fa-circle\"/> \u6e96\u5099\n\n```groovy\n@Grab('org.spockframework:spock-core:0.7-groovy-2.0')\n@Grab('org.codehaus.groovy.modules.http-builder:http-builder:0.7.1')\n```\n\nGrape\u3092\u3064\u304b\u3063\u3066spock\u3068http-builder(RESTClient)\u3092\u53d6\u5f97\u3057\u3066\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\n```groovy\nclass Test extends Specification {\n```\n\n\u30c6\u30b9\u30c8\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u304c\u3001spock\u306eSpecification\u30af\u30e9\u30b9\u3092\u7d99\u627f\u3059\u308b\u3053\u3068\u3067\nspock\u306e\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3068\u3057\u3066\u30c6\u30b9\u30c8\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\n\n```groovy\n\tdef ROOT = \"http://localhost/\"\n\tdef http = new RESTClient(ROOT)\n```\n\nRESTClient\u3092new\u3057\u3066\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u5f15\u6570\u306b\u30eb\u30fc\u30c8URL\u3092\u6e21\u3057\u3066\u3042\u3052\u308c\u3070\nHTTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u51fa\u6765\u4e0a\u304c\u308a\u3002\n\n### <i class=\"fa fa-circle\"/> ID\u6307\u5b9a\u306a\u3057\u306e\u30c6\u30b9\u30c8\n\n```groovy\n\t@Unroll\n\tdef \"test bookmarks\"() {\n\t\twhen:\n\t\tdef res = http.get(path: \"bookmarks\", contentType: JSON)\n\t\tdef resData = res.responseData\n\n\t\tthen:\n\t\tnotThrown(HttpResponseException)\n\t\tresData.size() == 3\n\t\tresData[i].id == t_id\n\t\tresData[i].name == t_name\n\t\tresData[i].url == t_url\n\n\t\twhere:\n\t\ti || t_id | t_name    | t_url\n\t\t0 || \"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n\t\t1 || \"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n\t\t2 || \"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n\t}\n```\n\n\u3053\u308c\u304c\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306e\u304b\u305f\u307e\u308a\u3067\u3059\u3002`def \"\u30c6\u30b9\u30c8\u540d\"() {}` \u3067\u56f2\u307f\u307e\u3059\u3002\nspock\u306e\u30c6\u30b9\u30c8\u306e\u57fa\u672c\u3068\u3057\u3066\u3001\n\n* when \u2192 \u3053\u306e\u64cd\u4f5c\u3092\u3057\u305f\u3068\u304d\u3001\n* then \u2192 \u3053\u3046\u3044\u3046\u7d50\u679c\u306b\u306a\u308b\u3002\n\n\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3067\u3059\u306e\u3067\u3001\n\n```groovy\n\t\twhen:\n\t\tdef res = http.get(path: \"bookmarks\", contentType: JSON)\n\t\tdef resData = res.responseData\n```\n\n\u306e\u64cd\u4f5c\u304c\u3055\u308c\u305f\u3068\u304d\u3001\n\n```groovy\n\t\tthen:\n\t\tnotThrown(HttpResponseException)\n\t\tresData.size() == 3\n\t\tresData[i].id == id\n\t\tresData[i].name == name\n\t\tresData[i].url == url\n```\n\n\u3068\u3044\u3046\u7d50\u679c\u306b\u306a\u308b\u306e\u304c\u6b63\u3057\u3044\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n#### <i class=\"fa fa-circle-o\"/> when\n\n```groovy\n\t\twhen:\n\t\tdef res = http.get(path: \"bookmarks\", contentType: JSON)\n\t\tdef resData = res.responseData\n```\n\n`http`\u306fRESTClient\u3067\u3059\u304c\u3001get\u30e1\u30bd\u30c3\u30c9\u3067GET\u3067\u63a5\u7d9a\u3057\u307e\u3059\u3002\npath\u306b\u306fURL\u306e\u30d1\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u2192`http://localhost/bookmarks`\u306bGET\u63a5\u7d9a\uff01\n\u8fd4\u3063\u3066\u304d\u305f\u30c7\u30fc\u30bf\u304b\u3089responseData\u3092\u53d6\u308a\u51fa\u3057\u3001JSON\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n#### <i class=\"fa fa-circle-o\"/> then\n\n```groovy\n\t\tthen:\n\t\tnotThrown(HttpResponseException)\n\t\tresData.size() == 3\n\t\tresData[i].id == id\n\t\tresData[i].name == name\n\t\tresData[i].url == url\n```\n\nwhen\u306e\u64cd\u4f5c\u304c\u3055\u308c\u305f\u5f8c\u3001then\u3067\u8a55\u4fa1\u3057\u307e\u3059\u3002\nRESTClient\u306f\u63a5\u7d9a\u7d50\u679c\u304c\u30a8\u30e9\u30fc\u3060\u3063\u305f\u5834\u5408HttpResponseException\u304c\u6295\u3052\u3089\u308c\u307e\u3059\u304c\nnotThrown\u3067HttpResponseException\u304c\u6295\u3052\u3089\u308c\u306a\u3044\uff08\u63a5\u7d9a\u6210\u529f\uff09\u3053\u3068\u3092\u8a55\u4fa1\u3057\u307e\u3059\u3002\n\u30ec\u30b9\u30dd\u30f3\u30b9JSON\u306fList<Map>\u5f62\u5f0f\u3067resData\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u3001\nresData.size()\u3067\u4f55\u4ef6\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u8fd4\u3063\u3066\u304d\u305f\u304b\u3092\u8a55\u4fa1\u3067\u304d\u307e\u3059\u3002\n\n#### <i class=\"fa fa-circle-o\"/> where\n\n\u3053\u3053\u3067where\u3068\u3044\u3046\u4fbf\u5229\u306a\u8a18\u8ff0\u304c\u3042\u308a\u307e\u3059\u3002\n\n```groovy\n\t\tthen:\n\t\tnotThrown(HttpResponseException)\n\t\tresData.size() == 3\n\t\tresData[i].id == t_id\n\t\tresData[i].name == t_name\n\t\tresData[i].url == t_url\n\n\t\twhere:\n\t\ti || t_id | t_name    | t_url\n\t\t0 || \"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n\t\t1 || \"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n\t\t2 || \"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n```\n\nthen\u306ei\u3001t_id\u3001t_name\u3001t_url\u306f\u5b9f\u306f\u5909\u6570\u3067\u3001where\u3067\u30c7\u30fc\u30bf\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n* i=0 \u306e\u3068\u304d\u3001t_id=\"1\"\u3001t_name=\"\u30aa\u30ad\u30cb1\"\u3001t_url=\"http:/hogehoge.com/okini1\" \u3060\uff01\n* i=1 \u306e\u3068\u304d\u3001t_id=\"2\"\u3001t_name=\"\u30aa\u30ad\u30cb2\"\u3001t_url=\"http:/hogehoge.com/okini2\" \u3060\uff01\n* i=1 \u306e\u3068\u304d\u3001t_id=\"3\"\u3001t_name=\"\u30aa\u30ad\u30cb3\"\u3001t_url=\"http:/hogehoge.com/okini3\" \u3060\uff01\n\n\u3068\u3044\u3046\u306e\u3092where\u306e3\u884c\u3067\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u306e\u3067where\u306e\u8a18\u8ff0\u3067\u30c6\u30b9\u30c8\u30b1\u30fc\u30b93\u3064\u5206\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\uff08\u5148\u982d\u306b@Unroll\u3092\u3064\u3051\u3066\u305f\u5834\u5408\uff09\n\n\u30fb\u30fb\u30fb\u3068\u3044\u3063\u305f\u611f\u3058\u3067\u8a55\u4fa1\u3067\u304d\u307e\u3059\u3002\n\n### <i class=\"fa fa-circle\"/> ID\u6307\u5b9a\u3042\u308a\u306e\u30c6\u30b9\u30c8\n\n```groovy\n\t@Unroll\n\tdef \"test bookmarks/#t_id\"() {\n\t\twhen:\n\t\tdef res = http.get(path: \"bookmarks/${t_id}\", contentType: JSON)\n\t\tdef resData = res.responseData\n\n\t\tthen:\n\t\tnotThrown(HttpResponseException)\n\t\tresData.size() == 3\n\t\tresData.id == t_id\n\t\tresData.name == t_name\n\t\tresData.url == t_url\n\n\t\twhere:\n\t\tt_id | t_name    | t_url\n\t\t\"1\"  | \"\u30aa\u30ad\u30cb1\" | \"http:/hogehoge.com/okini1\"\n\t\t\"2\"  | \"\u30aa\u30ad\u30cb2\" | \"http:/hogehoge.com/okini2\"\n\t\t\"3\"  | \"\u30aa\u30ad\u30cb3\" | \"http:/hogehoge.com/okini3\"\n\t}\n```\n\nID\u6307\u5b9a\u306a\u3057\u3068\u307b\u3068\u3093\u3069\u5909\u308f\u3089\u306a\u3044\u3067\u3059\u304c\nwhen\u306epath\u6307\u5b9a\u3067`\"bookmarks/${t_id}\"`\u306e\u8a18\u8ff0\u304c\u3042\u308a\u307e\u3059\u304c\nwhen\u306e\u4e2d\u306e\u5024\u3082where\u3067\u6307\u5b9a\u3067\u304d\u308b\u3088\uff01\u3063\u3066\u611f\u3058\u3067\u3059\u3002\n\n\u3042\u3068\u306f\u6700\u521d\u306e`def \"test bookmarks/#t_id\"() {`\u3067\u3059\u304c\n\u30c6\u30b9\u30c8\u540d\u306b#\u5909\u6570\u540d\u3063\u3066\u3059\u308b\u3068\u30c6\u30b9\u30c8\u540d\u3092\u52d5\u7684\u306b\u5909\u66f4\u3067\u304d\u308b\u3088\uff01\u3063\u3066\u611f\u3058\u3067\u3059\u3002\n\n### <i class=\"fa fa-circle\"/> NotFound\u306e\u30c6\u30b9\u30c8\n\n```groovy\n\tdef \"URL NotFound\"() {\n\t\twhen:\n\t\thttp.get(path: \"hoge\")\n\n\t\tthen:\n\t\tdef e = thrown(HttpResponseException)\n\t\te.statusCode == 404\n\t\te.message == \"Not Found\"\n\t}\n```\n\npath\u3067\u5b58\u5728\u3057\u306a\u3044\u30d1\u30b9\u3092\u3057\u305f\u3068\u304d\u306f404\u306b\u306a\u308aHttpResponseException\u304c\u6295\u3052\u3089\u308c\u308b\u306e\u3067\nHttpResponseException\u304c\u30b9\u30ed\u30fc\u3055\u308c\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u306f404\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\"Not Found\"\u3060\uff01\u3068\u3044\u3046\u306e\u3092\u8a55\u4fa1\u3057\u3066\u307e\u3059\u3002\n\n## <i class=\"fa fa-hand-o-right\"/>\u30c6\u30b9\u30c8\u7d50\u679c\n\n### <i class=\"fa fa-circle\"/> \u30c6\u30b9\u30c8\u7d50\u679c\u304c\u3059\u3079\u3066OK\u306e\u3068\u304d\n\n```\nJUnit 4 Runner, Tests: 7, Failures: 0, Time: 530           # 7\u4ef6\u30c6\u30b9\u30c8\u3067\u30a8\u30e9\u30fc\u306a\u3057\u3002\n```\n\n7\u4ef6\u30c6\u30b9\u30c8\u306e\u5185\u8a33\u306fID\u6307\u5b9a\u306a\u3057:3\u4ef6\u3001ID\u6307\u5b9a\u3042\u308a:3\u4ef6\u3001NotFound:1\u4ef6\u3002\n\n### <i class=\"fa fa-circle\"/> \u30c6\u30b9\u30c8\u7d50\u679c\u304cNG\u3060\u3063\u305f\u3068\u304d\n\n```\nJUnit 4 Runner, Tests: 7, Failures: 1, Time: 609           # 7\u4ef6\u30c6\u30b9\u30c8\u3067\u30a8\u30e9\u30fc1\u4ef6\u3002\nTest Failure: test bookmarks/2(Test)                       # test bookmarks/2 \u306e\u30c6\u30b9\u30c8\u3067\u5931\u6557\u3002\nCondition not satisfied:\n\nresData.url == t_url                                       # resData.url == t_url \u306e\u884c\u3067\u5931\u6557\u3002\n|       |   |  |                                           # \u5177\u4f53\u7684\u306b\u3069\u3046\u9055\u3046\u304b\u3092\u8868\u793a\u3057\u3066\u304f\u308c\u308b\u3002\n|       |   |  http:/hogehoge.com/okini3\n|       |   false\n|       |   1 difference (96% similarity)\n|       |   http:/hogehoge.com/okini(2)\n|       |   http:/hogehoge.com/okini(3)\n|       http:/hogehoge.com/okini2\n[id:2, name:\u30aa\u30ad\u30cb2, url:http:/hogehoge.com/okini2]\n\n\tat Test.test bookmarks/#t_id(test.groovy:56)       # \u30bd\u30fc\u30b9\u306e\u3069\u306e\u884c\u3067\u5931\u6557\u3057\u305f\u304b\u3002\n```\n\n\u81f3\u308c\u308a\u5c3d\u304f\u305b\u308a\uff01\n\u3069\u3053\u304c\u3069\u3046\u9055\u3046\u304b\u3001\u4f55\u30d1\u30fc\u30bb\u30f3\u30c8\u5408\u81f4\u3057\u3066\u3044\u308b\u304b\u307e\u3067\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\u3082\u3046\u30c6\u30b9\u30c8\u5931\u6557\u3055\u305b\u305f\u3044\u304f\u3089\u3044\uff01\n\n\n## <i class=\"fa fa-hand-o-right\"/> \u307e\u3068\u3081\n\n\u304a\u3082\u306bspock\u306e\u6982\u8981\u8aac\u660e\u3067\u3057\u305f\u304cAPI\u30c6\u30b9\u30c8\u3060\u3051\u3067\u306a\u304fUnit\u30c6\u30b9\u30c8\u3082\u3082\u3061\u308d\u3093\u3067\u304d\u308b\u306e\u3067\u304b\u306a\u30fc\u308a\u4fbf\u5229\u306b\u306a\u3063\u305f\u308a\u3057\u307e\u3059\u3002\nGradle\u306b\u7d44\u307f\u8fbc\u3093\u3060\u308a\u3057\u3066\u3082\u30c6\u30b9\u30c8\u30ec\u30dd\u30fc\u30c8\u304cJUnit\u3068\u540c\u3058\u5f62\u5f0f\u3067\u51fa\u529b\u3055\u308c\u308b\u306e\u3067\u898b\u3084\u3059\u304b\u3063\u305f\u3067\u3059\u3002\n\n## <i class=\"fa fa-hand-o-right\"/> \u30b5\u30f3\u30d7\u30eb\n\n\u30b5\u30f3\u30d7\u30eb\u3092GitHub\u306b\u304a\u304d\u307e\u3057\u305f\u3002\nAPI\u30b5\u30fc\u30d0\u306f\u9069\u5f53\u306bSinatra\u3067\u66f8\u3044\u3066\u307e\u3059\u3002\n\n[https://github.com/hiromikimura/spock-api-test](https://github.com/hiromikimura/spock-api-test)\n"}