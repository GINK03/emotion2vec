{"context": "\n\n\u3053\u308c\u306f\u4f55\uff1f\nPandas\u306e\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\u3067\u3059\u3002\u307b\u307c\u81ea\u5206\u7528\u30e1\u30e2\u3002\u6700\u4f4e\u9650\u306e\u884c\u9593\u3092\u8aad\u3081\u308b\u4eba\u5411\u3051\u3002\n\nPandas\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\n\n\u57fa\u672c\u30c7\u30fc\u30bf\u64cd\u4f5c\n\n\u5404\u7a2e\u30a4\u30f3\u30dd\u30fc\u30c8\nimport pandas as pd\nimport matplotlib as matplotlib\nimport matplotlib.pyplot as plt\nfrom IPython.display import display\n%matplotlib inline\n\n\n\u30c7\u30fc\u30bf\u306e\u30ed\u30fc\u30c9\ndata = pd.read_csv('https://gist.githubusercontent.com/kojim/0a47ed4258222b0541a42aa9fd7da906/raw/a5d6a1a527deec269697c5b2ddab4157184af4ff/civ4.csv')\ndata.head(5)\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\n\n\n\n0\n0\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n10.0\n4.0\n4.0\n1.0\n0.0\n\n\n1\n0\nTXT_KEY_LEADER_WANGKON\nTXT_KEY_CITY_NAME_SEOUL\n0.0\n9.0\n2.0\n4.0\n2.0\n0.0\n\n\n2\n0\nTXT_KEY_LEADER_HAMMURABI\nTXT_KEY_CITY_NAME_BABYLON\n0.0\n9.0\n2.0\n4.0\n1.0\n0.0\n\n\n3\n0\nTXT_KEY_LEADER_PACAL\nTXT_KEY_CITY_NAME_MUTAL\n0.0\n9.0\n2.0\n4.0\n1.0\n0.0\n\n\n4\n0\nTXT_KEY_LEADER_SITTING_BULL\nTXT_KEY_CITY_NAME_CAHOKIA\n0.0\n11.0\n2.0\n4.0\n1.0\n0.0\n\n\n\n\n\n\u884c\u306e\u7d5e\u8fbc\u307f(\u884c\u6570)\ndata.head(3)\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\n\n\n\n0\n0\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n10.0\n4.0\n4.0\n1.0\n0.0\n\n\n1\n0\nTXT_KEY_LEADER_WANGKON\nTXT_KEY_CITY_NAME_SEOUL\n0.0\n9.0\n2.0\n4.0\n2.0\n0.0\n\n\n2\n0\nTXT_KEY_LEADER_HAMMURABI\nTXT_KEY_CITY_NAME_BABYLON\n0.0\n9.0\n2.0\n4.0\n1.0\n0.0\n\n\n\n\n\n\u884c\u306e\u7d5e\u8fbc\u307f(\u5024)\ndata.query(\"\u6307\u5c0e\u8005 == 'kojim' & \u91d1\u92ad > 5\").head(3)\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\n\n\n\n654\n64\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n6.0\n4.0\n4.0\n4.0\n11.0\n1.0\n\n\n674\n65\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n6.0\n4.0\n4.0\n4.0\n11.0\n1.0\n\n\n695\n66\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n6.0\n4.0\n4.0\n4.0\n11.0\n1.0\n\n\n\n\n\n\u5217\u306e\u62bd\u51fa(Series\u306e\u53d6\u5f97)\ndata['\u30bf\u30fc\u30f3\u6570'].head(3)\n\n0    0\n1    0\n2    0\nName: \u30bf\u30fc\u30f3\u6570, dtype: int64\n\n\n\u5217\u306e\u7d5e\u8fbc\u307f\ndata[['\u30bf\u30fc\u30f3\u6570', '\u6307\u5c0e\u8005']].head(3)\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u6307\u5c0e\u8005\n\n\n\n\n0\n0\nkojim\n\n\n1\n0\nTXT_KEY_LEADER_WANGKON\n\n\n2\n0\nTXT_KEY_LEADER_HAMMURABI\n\n\n\n\n\n\u5217\u30c7\u30fc\u30bf\u306e\u6f14\u7b97\n(data['\u30bf\u30fc\u30f3\u6570'] + 10).head(3)\n\n0    10\n1    10\n2    10\nName: \u30bf\u30fc\u30f3\u6570, dtype: int64\n\n\n\u5217\u306e\u8ffd\u52a0\ndata['\u51fa\u529b'] = data['\u7814\u7a76'] + data['\u751f\u7523']\ndata.head(3)\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\n\n\n\n0\n0\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n10.0\n4.0\n4.0\n1.0\n0.0\n11.0\n\n\n1\n0\nTXT_KEY_LEADER_WANGKON\nTXT_KEY_CITY_NAME_SEOUL\n0.0\n9.0\n2.0\n4.0\n2.0\n0.0\n11.0\n\n\n2\n0\nTXT_KEY_LEADER_HAMMURABI\nTXT_KEY_CITY_NAME_BABYLON\n0.0\n9.0\n2.0\n4.0\n1.0\n0.0\n10.0\n\n\n\n\n\n\u884c\u306e\u9023\u7d50\ndata2 = pd.read_csv('https://gist.githubusercontent.com/kojim/0a47ed4258222b0541a42aa9fd7da906/raw/a5d6a1a527deec269697c5b2ddab4157184af4ff/civ4.csv')\ndata.append(data2, ignore_index=True).head(3)\n\n\n\n\n\n\n\u30b9\u30d1\u30a4\n\u30bf\u30fc\u30f3\u6570\n\u51fa\u529b\n\u6307\u5c0e\u8005\n\u6587\u5316\n\u751f\u7523\n\u7814\u7a76\n\u7dad\u6301\u8cbb\n\u90fd\u5e02\u540d\n\u91d1\u92ad\n\n\n\n\n0\n4.0\n0\n11.0\nkojim\n4.0\n1.0\n10.0\n0.0\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n\n\n1\n4.0\n0\n11.0\nTXT_KEY_LEADER_WANGKON\n2.0\n2.0\n9.0\n0.0\nTXT_KEY_CITY_NAME_SEOUL\n0.0\n\n\n2\n4.0\n0\n10.0\nTXT_KEY_LEADER_HAMMURABI\n2.0\n1.0\n9.0\n0.0\nTXT_KEY_CITY_NAME_BABYLON\n0.0\n\n\n\n\n\n\u5217\u306e\u9023\u7d50\ndata3 = pd.DataFrame(\n    {'\u90fd\u5e02\u540d': ['TXT_KEY_CITY_NAME_ATHENS'],\n     '\u90fd\u5e02\u540d(\u65e5\u672c\u8a9e)': ['\u30a2\u30c6\u30cd']})\ndata3\n\n\n\n\n\n\n\u90fd\u5e02\u540d\n\u90fd\u5e02\u540d(\u65e5\u672c\u8a9e)\n\n\n\n\n0\nTXT_KEY_CITY_NAME_ATHENS\n\u30a2\u30c6\u30cd\n\n\n\n\npd.merge(data, data3, on='\u90fd\u5e02\u540d', how='left').head(3)\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\u90fd\u5e02\u540d(\u65e5\u672c\u8a9e)\n\n\n\n\n0\n0\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n10.0\n4.0\n4.0\n1.0\n0.0\n11.0\n\u30a2\u30c6\u30cd\n\n\n1\n0\nTXT_KEY_LEADER_WANGKON\nTXT_KEY_CITY_NAME_SEOUL\n0.0\n9.0\n2.0\n4.0\n2.0\n0.0\n11.0\nNaN\n\n\n2\n0\nTXT_KEY_LEADER_HAMMURABI\nTXT_KEY_CITY_NAME_BABYLON\n0.0\n9.0\n2.0\n4.0\n1.0\n0.0\n10.0\nNaN\n\n\n\n\n\n\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\n\n\u5217\u306e\u5024\u3092\u4f7f\u7528\u3057\u305f\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\ndata.groupby('\u6307\u5c0e\u8005').sum()\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\n\n\u6307\u5c0e\u8005\n\n\n\n\n\n\n\n\n\n\n\n\nTXT_KEY_LEADER_BARBARIAN\n18676\n369.0\n0.0\n0.0\n0.0\n458.0\n302.0\n458.0\n\n\nTXT_KEY_LEADER_GILGAMESH\n526136\n22768.0\n57690.0\n40047.0\n30305.0\n32826.0\n5139.0\n90516.0\n\n\nTXT_KEY_LEADER_HAMMURABI\n276530\n4612.0\n29905.0\n14777.0\n10738.0\n14424.0\n2280.0\n44329.0\n\n\nTXT_KEY_LEADER_PACAL\n463715\n28303.0\n110795.0\n46527.0\n31253.0\n32673.0\n5193.0\n143468.0\n\n\nTXT_KEY_LEADER_RAGNAR\n459257\n26257.0\n53257.0\n20919.0\n21955.0\n28830.0\n5826.0\n82087.0\n\n\nTXT_KEY_LEADER_SITTING_BULL\n284044\n12073.0\n53986.0\n20733.0\n24190.0\n27457.0\n1580.0\n81443.0\n\n\nTXT_KEY_LEADER_WANGKON\n356335\n13491.0\n60699.0\n25940.0\n25531.0\n24785.0\n2938.0\n85484.0\n\n\nkojim\n469839\n32913.0\n223011.0\n94184.0\n31967.0\n95515.0\n13509.0\n318526.0\n\n\n\n\n\n\u95a2\u6570\u3092\u4f7f\u7528\u3057\u305f\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\ndata.groupby(lambda x: '\u5076\u6570\u30bf\u30fc\u30f3' if data.ix[x]['\u30bf\u30fc\u30f3\u6570'] % 2 else '\u5947\u6570\u30bf\u30fc\u30f3').sum()\ndata.groupby(lambda x: '\u5076\u6570\u30bf\u30fc\u30f3' if data.ix[x]['\u30bf\u30fc\u30f3\u6570'] % 2 else '\u5947\u6570\u30bf\u30fc\u30f3').sum()\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\n\n\n\n\u5076\u6570\u30bf\u30fc\u30f3\n1431876\n70479.0\n295597.0\n132280.0\n88755.0\n128240.0\n18415.0\n423837.0\n\n\n\u5947\u6570\u30bf\u30fc\u30f3\n1422656\n70307.0\n293746.0\n130847.0\n87184.0\n128728.0\n18352.0\n422474.0\n\n\n\n\n\n\u968e\u5c64\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\ng = data.groupby(['\u6307\u5c0e\u8005', '\u90fd\u5e02\u540d']).sum()\ng.head(10)\n\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\n\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\n\n\n\n\n\n\n\n\n\n\n\nTXT_KEY_LEADER_BARBARIAN\nTXT_KEY_CITY_NAME_KASSITE\n5481\n41.0\n0.0\n0.0\n0.0\n142.0\n60.0\n142.0\n\n\nTXT_KEY_CITY_NAME_SAXON\n6825\n280.0\n0.0\n0.0\n0.0\n138.0\n121.0\n138.0\n\n\nTXT_KEY_CITY_NAME_YAYOI\n6370\n48.0\n0.0\n0.0\n0.0\n178.0\n121.0\n178.0\n\n\nTXT_KEY_LEADER_GILGAMESH\nTXT_KEY_CITY_NAME_BAD_TIBIRA\n55560\n1210.0\n2468.0\n1009.0\n980.0\n1938.0\n783.0\n4406.0\n\n\nTXT_KEY_CITY_NAME_ERIDU\n61035\n4153.0\n9768.0\n5691.0\n3768.0\n4776.0\n423.0\n14544.0\n\n\nTXT_KEY_CITY_NAME_KISH\n60291\n1319.0\n7374.0\n4118.0\n4591.0\n2480.0\n508.0\n9854.0\n\n\nTXT_KEY_CITY_NAME_LAGASH\n58206\n1162.0\n1980.0\n5989.0\n3130.0\n3919.0\n424.0\n5899.0\n\n\nTXT_KEY_CITY_NAME_NIBRU\n51623\n1571.0\n3397.0\n3242.0\n1000.0\n2347.0\n757.0\n5744.0\n\n\nTXT_KEY_CITY_NAME_NIPPUR\n32093\n215.0\n526.0\n1243.0\n756.0\n1836.0\n349.0\n2362.0\n\n\nTXT_KEY_CITY_NAME_SAXON\n39831\n575.0\n1984.0\n1485.0\n1309.0\n1133.0\n296.0\n3117.0\n\n\n\n\nJupyter\u306e\u8868\u793a\u4e0a\u3001\u6307\u5c0e\u8005\u5217\u306f2\u884c\u3057\u304b\u306a\u3044\u3088\u3046\u306b\u898b\u3048\u308b\u304c\u3001\u8868\u793a\u4e0a\u305d\u3046\u306a\u3063\u3066\u3044\u308b\u3060\u3051\u3067\u3001\u5b9f\u969b\u306b\u306f\u884c\u306e\u6570\u3001\u3064\u307e\u308a\u2191\u306e\u4f8b\u3067\u8a00\u3048\u307010\u884c\u5b58\u5728\u3059\u308b\u3002\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u3067\u305d\u308c\u306f\u78ba\u8a8d\u3067\u304d\u308b\u3002\ng.head(10).index.values\n\narray([('TXT_KEY_LEADER_BARBARIAN', 'TXT_KEY_CITY_NAME_KASSITE'),\n   ('TXT_KEY_LEADER_BARBARIAN', 'TXT_KEY_CITY_NAME_SAXON'),\n   ('TXT_KEY_LEADER_BARBARIAN', 'TXT_KEY_CITY_NAME_YAYOI'),\n   ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_BAD_TIBIRA'),\n   ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_ERIDU'),\n   ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_KISH'),\n   ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_LAGASH'),\n   ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_NIBRU'),\n   ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_NIPPUR'),\n   ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_SAXON')], dtype=object)\n\n\n\u968e\u5c64\u30b0\u30eb\u30fc\u30d7\u306e\u968e\u5c64\u5165\u308c\u66ff\u3048\n\u3064\u307e\u308a\u5165\u308c\u66ff\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\ng.swaplevel(0, 1).head(10)\n\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\n\n\u90fd\u5e02\u540d\n\u6307\u5c0e\u8005\n\n\n\n\n\n\n\n\n\n\n\n\nTXT_KEY_CITY_NAME_KASSITE\nTXT_KEY_LEADER_BARBARIAN\n5481\n41.0\n0.0\n0.0\n0.0\n142.0\n60.0\n142.0\n\n\nTXT_KEY_CITY_NAME_SAXON\nTXT_KEY_LEADER_BARBARIAN\n6825\n280.0\n0.0\n0.0\n0.0\n138.0\n121.0\n138.0\n\n\nTXT_KEY_CITY_NAME_YAYOI\nTXT_KEY_LEADER_BARBARIAN\n6370\n48.0\n0.0\n0.0\n0.0\n178.0\n121.0\n178.0\n\n\nTXT_KEY_CITY_NAME_BAD_TIBIRA\nTXT_KEY_LEADER_GILGAMESH\n55560\n1210.0\n2468.0\n1009.0\n980.0\n1938.0\n783.0\n4406.0\n\n\nTXT_KEY_CITY_NAME_ERIDU\nTXT_KEY_LEADER_GILGAMESH\n61035\n4153.0\n9768.0\n5691.0\n3768.0\n4776.0\n423.0\n14544.0\n\n\nTXT_KEY_CITY_NAME_KISH\nTXT_KEY_LEADER_GILGAMESH\n60291\n1319.0\n7374.0\n4118.0\n4591.0\n2480.0\n508.0\n9854.0\n\n\nTXT_KEY_CITY_NAME_LAGASH\nTXT_KEY_LEADER_GILGAMESH\n58206\n1162.0\n1980.0\n5989.0\n3130.0\n3919.0\n424.0\n5899.0\n\n\nTXT_KEY_CITY_NAME_NIBRU\nTXT_KEY_LEADER_GILGAMESH\n51623\n1571.0\n3397.0\n3242.0\n1000.0\n2347.0\n757.0\n5744.0\n\n\nTXT_KEY_CITY_NAME_NIPPUR\nTXT_KEY_LEADER_GILGAMESH\n32093\n215.0\n526.0\n1243.0\n756.0\n1836.0\n349.0\n2362.0\n\n\nTXT_KEY_CITY_NAME_SAXON\nTXT_KEY_LEADER_GILGAMESH\n39831\n575.0\n1984.0\n1485.0\n1309.0\n1133.0\n296.0\n3117.0\n\n\n\n10 rows \u00d7 8 columns\n\n\n\u968e\u5c64\u30b0\u30eb\u30fc\u30d7\u306e\u518d\u4e26\u3073\u66ff\u3048\n\u5165\u308c\u66ff\u3048\u305f\u5f8c\u4e26\u3073\u66ff\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\ng.swaplevel(0, 1).sortlevel(0).head(3)\n\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\n\n\u90fd\u5e02\u540d\n\u6307\u5c0e\u8005\n\n\n\n\n\n\n\n\n\n\n\n\nTXT_KEY_CITY_NAME_AKKAD\nTXT_KEY_LEADER_HAMMURABI\n16769\n153.0\n936.0\n744.0\n29.0\n638.0\n287.0\n1574.0\n\n\nTXT_KEY_LEADER_RAGNAR\n41110\n1631.0\n2496.0\n776.0\n977.0\n1782.0\n590.0\n4278.0\n\n\nTXT_KEY_LEADER_WANGKON\n3492\n44.0\n55.0\n128.0\n12.0\n144.0\n57.0\n199.0\n\n\n\n\n\n\u968e\u5c64\u30b0\u30eb\u30fc\u30d7\u3092\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u5f62\u5f0f\u306b\u518d\u69cb\u6210\u3059\u308b\ng2 = g[['\u51fa\u529b']].head(3)\ng2\n\n\n\n\n\n\n\n\u51fa\u529b\n\n\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\n\n\n\n\nTXT_KEY_LEADER_BARBARIAN\nTXT_KEY_CITY_NAME_KASSITE\n142.0\n\n\nTXT_KEY_CITY_NAME_SAXON\n138.0\n\n\nTXT_KEY_CITY_NAME_YAYOI\n178.0\n\n\n\n\ng2.unstack()\n\n\n\n\n\n\n\u51fa\u529b\n\n\n\u90fd\u5e02\u540d\nTXT_KEY_CITY_NAME_KASSITE\nTXT_KEY_CITY_NAME_SAXON\nTXT_KEY_CITY_NAME_YAYOI\n\n\n\u6307\u5c0e\u8005\n\n\n\n\n\n\n\nTXT_KEY_LEADER_BARBARIAN\n142.0\n138.0\n178.0\n\n\n\n\n\n\u5217\u5168\u4f53\u306e\u96c6\u8a08\n\u30c7\u30fc\u30bf\u306e\u4e0b\u6e96\u5099\ndata3 = data.query(\"\u6307\u5c0e\u8005 == 'kojim' & \u30bf\u30fc\u30f3\u6570 > 40 & \u30bf\u30fc\u30f3\u6570 < 50\")\ndata3\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\n\n\n\n299\n41\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n12.0\n4.0\n4.0\n8.0\n0.0\n20.0\n\n\n311\n42\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n10.0\n4.0\n4.0\n11.0\n0.0\n21.0\n\n\n323\n43\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n335\n44\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n348\n45\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n361\n46\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n362\n46\nkojim\nTXT_KEY_CITY_NAME_SPARTA\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n\n\n375\n47\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n376\n47\nkojim\nTXT_KEY_CITY_NAME_SPARTA\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n\n\n389\n48\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n390\n48\nkojim\nTXT_KEY_CITY_NAME_SPARTA\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n\n\n403\n49\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n8.0\n0.0\n19.0\n\n\n404\n49\nkojim\nTXT_KEY_CITY_NAME_SPARTA\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n\n\n\n\n\u5217\u5168\u4f53\u306e\u7d2f\u7a4d\u5024\u3092\u8a08\u7b97\u3002\ndata3['\u7d2f\u7a4d\u51fa\u529b'] = data['\u51fa\u529b'].cumsum()\ndata3\n\n\n\n\n\n\n\u30bf\u30fc\u30f3\u6570\n\u6307\u5c0e\u8005\n\u90fd\u5e02\u540d\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\u7d2f\u7a4d\u51fa\u529b\n\n\n\n\n299\n41\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n12.0\n4.0\n4.0\n8.0\n0.0\n20.0\n3419.0\n\n\n311\n42\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n10.0\n4.0\n4.0\n11.0\n0.0\n21.0\n3545.0\n\n\n323\n43\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n3666.0\n\n\n335\n44\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n3786.0\n\n\n348\n45\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n3908.0\n\n\n361\n46\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n4031.0\n\n\n362\n46\nkojim\nTXT_KEY_CITY_NAME_SPARTA\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n4034.0\n\n\n375\n47\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n4164.0\n\n\n376\n47\nkojim\nTXT_KEY_CITY_NAME_SPARTA\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n4167.0\n\n\n389\n48\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n4295.0\n\n\n390\n48\nkojim\nTXT_KEY_CITY_NAME_SPARTA\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n4298.0\n\n\n403\n49\nkojim\nTXT_KEY_CITY_NAME_ATHENS\n0.0\n11.0\n4.0\n4.0\n8.0\n0.0\n19.0\n4428.0\n\n\n404\n49\nkojim\nTXT_KEY_CITY_NAME_SPARTA\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n4431.0\n\n\n\n\n\u5217\u5168\u4f53\u306e\u5408\u8a08\u5024\u3092\u8a08\u7b97\u3002\ndata['\u51fa\u529b'].sum()\n\n\n\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306e\u518d\u96c6\u8a08\ndata4 = data.query(\"\u6307\u5c0e\u8005 == 'kojim' & \u30bf\u30fc\u30f3\u6570 > 40 & \u30bf\u30fc\u30f3\u6570 < 50\").groupby(['\u90fd\u5e02\u540d', '\u30bf\u30fc\u30f3\u6570']).sum()\ndata4\n\n\u305f\u3068\u3048\u3070\u968e\u5c64\u30c7\u30fc\u30bf\u306e\u7279\u5b9a\u968e\u5c64\u3067\u306e\u96c6\u8a08\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u3002\n\n\n\n\n\n\n\u91d1\u92ad\n\u7814\u7a76\n\u6587\u5316\n\u30b9\u30d1\u30a4\n\u751f\u7523\n\u7dad\u6301\u8cbb\n\u51fa\u529b\n\n\n\u90fd\u5e02\u540d\n\u30bf\u30fc\u30f3\u6570\n\n\n\n\n\n\n\n\n\n\n\nTXT_KEY_CITY_NAME_ATHENS\n41\n0.0\n12.0\n4.0\n4.0\n8.0\n0.0\n20.0\n\n\n42\n0.0\n10.0\n4.0\n4.0\n11.0\n0.0\n21.0\n\n\n43\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n44\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n45\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n46\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n47\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n48\n0.0\n11.0\n4.0\n4.0\n7.0\n0.0\n18.0\n\n\n49\n0.0\n11.0\n4.0\n4.0\n8.0\n0.0\n19.0\n\n\nTXT_KEY_CITY_NAME_SPARTA\n46\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n\n\n47\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n\n\n48\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n\n\n49\n0.0\n1.0\n2.0\n0.0\n2.0\n2.0\n3.0\n\n\n\n\ndata4.groupby(level=0).cumsum()\n\n\n\n\n\n\n\n\u30b9\u30d1\u30a4\n\u51fa\u529b\n\u6587\u5316\n\u751f\u7523\n\u7814\u7a76\n\u7dad\u6301\u8cbb\n\u91d1\u92ad\n\n\n\u90fd\u5e02\u540d\n\u30bf\u30fc\u30f3\u6570\n\n\n\n\n\n\n\n\n\n\n\nTXT_KEY_CITY_NAME_ATHENS\n41\n4.0\n20.0\n4.0\n8.0\n12.0\n0.0\n0.0\n\n\n42\n8.0\n41.0\n8.0\n19.0\n22.0\n0.0\n0.0\n\n\n43\n12.0\n59.0\n12.0\n26.0\n33.0\n0.0\n0.0\n\n\n44\n16.0\n77.0\n16.0\n33.0\n44.0\n0.0\n0.0\n\n\n45\n20.0\n95.0\n20.0\n40.0\n55.0\n0.0\n0.0\n\n\n46\n24.0\n113.0\n24.0\n47.0\n66.0\n0.0\n0.0\n\n\n47\n28.0\n131.0\n28.0\n54.0\n77.0\n0.0\n0.0\n\n\n48\n32.0\n149.0\n32.0\n61.0\n88.0\n0.0\n0.0\n\n\n49\n36.0\n168.0\n36.0\n69.0\n99.0\n0.0\n0.0\n\n\nTXT_KEY_CITY_NAME_SPARTA\n46\n0.0\n3.0\n2.0\n2.0\n1.0\n2.0\n0.0\n\n\n47\n0.0\n6.0\n4.0\n4.0\n2.0\n4.0\n0.0\n\n\n48\n0.0\n9.0\n6.0\n6.0\n3.0\n6.0\n0.0\n\n\n49\n0.0\n12.0\n8.0\n8.0\n4.0\n8.0\n0.0\n\n\n\n\n# \u3053\u308c\u306f\u4f55\uff1f\nPandas\u306e\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\u3067\u3059\u3002\u307b\u307c\u81ea\u5206\u7528\u30e1\u30e2\u3002\u6700\u4f4e\u9650\u306e\u884c\u9593\u3092\u8aad\u3081\u308b\u4eba\u5411\u3051\u3002\n\n# Pandas\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\n## \u57fa\u672c\u30c7\u30fc\u30bf\u64cd\u4f5c\n### \u5404\u7a2e\u30a4\u30f3\u30dd\u30fc\u30c8\n```py3\nimport pandas as pd\nimport matplotlib as matplotlib\nimport matplotlib.pyplot as plt\nfrom IPython.display import display\n%matplotlib inline\n```\n\n### \u30c7\u30fc\u30bf\u306e\u30ed\u30fc\u30c9\n```python\ndata = pd.read_csv('https://gist.githubusercontent.com/kojim/0a47ed4258222b0541a42aa9fd7da906/raw/a5d6a1a527deec269697c5b2ddab4157184af4ff/civ4.csv')\ndata.head(5)\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>10.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_WANGKON</td>\n      <td>TXT_KEY_CITY_NAME_SEOUL</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_HAMMURABI</td>\n      <td>TXT_KEY_CITY_NAME_BABYLON</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_PACAL</td>\n      <td>TXT_KEY_CITY_NAME_MUTAL</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_SITTING_BULL</td>\n      <td>TXT_KEY_CITY_NAME_CAHOKIA</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u884c\u306e\u7d5e\u8fbc\u307f(\u884c\u6570)\n```python\ndata.head(3)\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>10.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_WANGKON</td>\n      <td>TXT_KEY_CITY_NAME_SEOUL</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_HAMMURABI</td>\n      <td>TXT_KEY_CITY_NAME_BABYLON</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u884c\u306e\u7d5e\u8fbc\u307f(\u5024)\n```python\ndata.query(\"\u6307\u5c0e\u8005 == 'kojim' & \u91d1\u92ad > 5\").head(3)\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>654</th>\n      <td>64</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>6.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>11.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>674</th>\n      <td>65</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>6.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>11.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>695</th>\n      <td>66</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>6.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>11.0</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u5217\u306e\u62bd\u51fa(Series\u306e\u53d6\u5f97)\n```python\ndata['\u30bf\u30fc\u30f3\u6570'].head(3)\n```\n    0    0\n    1    0\n    2    0\n    Name: \u30bf\u30fc\u30f3\u6570, dtype: int64\n\n### \u5217\u306e\u7d5e\u8fbc\u307f\n```python\ndata[['\u30bf\u30fc\u30f3\u6570', '\u6307\u5c0e\u8005']].head(3)\n```\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u6307\u5c0e\u8005</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>kojim</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_WANGKON</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_HAMMURABI</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u5217\u30c7\u30fc\u30bf\u306e\u6f14\u7b97\n```python\n(data['\u30bf\u30fc\u30f3\u6570'] + 10).head(3)\n```\n    0    10\n    1    10\n    2    10\n    Name: \u30bf\u30fc\u30f3\u6570, dtype: int64\n\n### \u5217\u306e\u8ffd\u52a0\n```python\ndata['\u51fa\u529b'] = data['\u7814\u7a76'] + data['\u751f\u7523']\ndata.head(3)\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>10.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n      <td>11.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_WANGKON</td>\n      <td>TXT_KEY_CITY_NAME_SEOUL</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>11.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_HAMMURABI</td>\n      <td>TXT_KEY_CITY_NAME_BABYLON</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n      <td>10.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u884c\u306e\u9023\u7d50\n```python\ndata2 = pd.read_csv('https://gist.githubusercontent.com/kojim/0a47ed4258222b0541a42aa9fd7da906/raw/a5d6a1a527deec269697c5b2ddab4157184af4ff/civ4.csv')\ndata.append(data2, ignore_index=True).head(3)\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u51fa\u529b</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u6587\u5316</th>\n      <th>\u751f\u7523</th>\n      <th>\u7814\u7a76</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u91d1\u92ad</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>4.0</td>\n      <td>0</td>\n      <td>11.0</td>\n      <td>kojim</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>10.0</td>\n      <td>0.0</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>4.0</td>\n      <td>0</td>\n      <td>11.0</td>\n      <td>TXT_KEY_LEADER_WANGKON</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>9.0</td>\n      <td>0.0</td>\n      <td>TXT_KEY_CITY_NAME_SEOUL</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>4.0</td>\n      <td>0</td>\n      <td>10.0</td>\n      <td>TXT_KEY_LEADER_HAMMURABI</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>9.0</td>\n      <td>0.0</td>\n      <td>TXT_KEY_CITY_NAME_BABYLON</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u5217\u306e\u9023\u7d50\n```python\ndata3 = pd.DataFrame(\n    {'\u90fd\u5e02\u540d': ['TXT_KEY_CITY_NAME_ATHENS'],\n     '\u90fd\u5e02\u540d(\u65e5\u672c\u8a9e)': ['\u30a2\u30c6\u30cd']})\ndata3\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u90fd\u5e02\u540d(\u65e5\u672c\u8a9e)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>\u30a2\u30c6\u30cd</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n```python\npd.merge(data, data3, on='\u90fd\u5e02\u540d', how='left').head(3)\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n      <th>\u90fd\u5e02\u540d(\u65e5\u672c\u8a9e)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>10.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>\u30a2\u30c6\u30cd</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_WANGKON</td>\n      <td>TXT_KEY_CITY_NAME_SEOUL</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0</td>\n      <td>TXT_KEY_LEADER_HAMMURABI</td>\n      <td>TXT_KEY_CITY_NAME_BABYLON</td>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>0.0</td>\n      <td>10.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n## \u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\n### \u5217\u306e\u5024\u3092\u4f7f\u7528\u3057\u305f\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\n```python\ndata.groupby('\u6307\u5c0e\u8005').sum()\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n    </tr>\n    <tr>\n      <th>\u6307\u5c0e\u8005</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>TXT_KEY_LEADER_BARBARIAN</th>\n      <td>18676</td>\n      <td>369.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>458.0</td>\n      <td>302.0</td>\n      <td>458.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_LEADER_GILGAMESH</th>\n      <td>526136</td>\n      <td>22768.0</td>\n      <td>57690.0</td>\n      <td>40047.0</td>\n      <td>30305.0</td>\n      <td>32826.0</td>\n      <td>5139.0</td>\n      <td>90516.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_LEADER_HAMMURABI</th>\n      <td>276530</td>\n      <td>4612.0</td>\n      <td>29905.0</td>\n      <td>14777.0</td>\n      <td>10738.0</td>\n      <td>14424.0</td>\n      <td>2280.0</td>\n      <td>44329.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_LEADER_PACAL</th>\n      <td>463715</td>\n      <td>28303.0</td>\n      <td>110795.0</td>\n      <td>46527.0</td>\n      <td>31253.0</td>\n      <td>32673.0</td>\n      <td>5193.0</td>\n      <td>143468.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_LEADER_RAGNAR</th>\n      <td>459257</td>\n      <td>26257.0</td>\n      <td>53257.0</td>\n      <td>20919.0</td>\n      <td>21955.0</td>\n      <td>28830.0</td>\n      <td>5826.0</td>\n      <td>82087.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_LEADER_SITTING_BULL</th>\n      <td>284044</td>\n      <td>12073.0</td>\n      <td>53986.0</td>\n      <td>20733.0</td>\n      <td>24190.0</td>\n      <td>27457.0</td>\n      <td>1580.0</td>\n      <td>81443.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_LEADER_WANGKON</th>\n      <td>356335</td>\n      <td>13491.0</td>\n      <td>60699.0</td>\n      <td>25940.0</td>\n      <td>25531.0</td>\n      <td>24785.0</td>\n      <td>2938.0</td>\n      <td>85484.0</td>\n    </tr>\n    <tr>\n      <th>kojim</th>\n      <td>469839</td>\n      <td>32913.0</td>\n      <td>223011.0</td>\n      <td>94184.0</td>\n      <td>31967.0</td>\n      <td>95515.0</td>\n      <td>13509.0</td>\n      <td>318526.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u95a2\u6570\u3092\u4f7f\u7528\u3057\u305f\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\n\ndata.groupby(lambda x: '\u5076\u6570\u30bf\u30fc\u30f3' if data.ix[x]['\u30bf\u30fc\u30f3\u6570'] % 2 else '\u5947\u6570\u30bf\u30fc\u30f3').sum()\n\n```python\ndata.groupby(lambda x: '\u5076\u6570\u30bf\u30fc\u30f3' if data.ix[x]['\u30bf\u30fc\u30f3\u6570'] % 2 else '\u5947\u6570\u30bf\u30fc\u30f3').sum()\n```\n\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>\u5076\u6570\u30bf\u30fc\u30f3</th>\n      <td>1431876</td>\n      <td>70479.0</td>\n      <td>295597.0</td>\n      <td>132280.0</td>\n      <td>88755.0</td>\n      <td>128240.0</td>\n      <td>18415.0</td>\n      <td>423837.0</td>\n    </tr>\n    <tr>\n      <th>\u5947\u6570\u30bf\u30fc\u30f3</th>\n      <td>1422656</td>\n      <td>70307.0</td>\n      <td>293746.0</td>\n      <td>130847.0</td>\n      <td>87184.0</td>\n      <td>128728.0</td>\n      <td>18352.0</td>\n      <td>422474.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\n### \u968e\u5c64\u30b0\u30eb\u30fc\u30d4\u30f3\u30b0\n```python\ng = data.groupby(['\u6307\u5c0e\u8005', '\u90fd\u5e02\u540d']).sum()\ng.head(10)\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n    </tr>\n    <tr>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"3\" valign=\"top\">TXT_KEY_LEADER_BARBARIAN</th>\n      <th>TXT_KEY_CITY_NAME_KASSITE</th>\n      <td>5481</td>\n      <td>41.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>142.0</td>\n      <td>60.0</td>\n      <td>142.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_SAXON</th>\n      <td>6825</td>\n      <td>280.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>138.0</td>\n      <td>121.0</td>\n      <td>138.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_YAYOI</th>\n      <td>6370</td>\n      <td>48.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>178.0</td>\n      <td>121.0</td>\n      <td>178.0</td>\n    </tr>\n    <tr>\n      <th rowspan=\"7\" valign=\"top\">TXT_KEY_LEADER_GILGAMESH</th>\n      <th>TXT_KEY_CITY_NAME_BAD_TIBIRA</th>\n      <td>55560</td>\n      <td>1210.0</td>\n      <td>2468.0</td>\n      <td>1009.0</td>\n      <td>980.0</td>\n      <td>1938.0</td>\n      <td>783.0</td>\n      <td>4406.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_ERIDU</th>\n      <td>61035</td>\n      <td>4153.0</td>\n      <td>9768.0</td>\n      <td>5691.0</td>\n      <td>3768.0</td>\n      <td>4776.0</td>\n      <td>423.0</td>\n      <td>14544.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_KISH</th>\n      <td>60291</td>\n      <td>1319.0</td>\n      <td>7374.0</td>\n      <td>4118.0</td>\n      <td>4591.0</td>\n      <td>2480.0</td>\n      <td>508.0</td>\n      <td>9854.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_LAGASH</th>\n      <td>58206</td>\n      <td>1162.0</td>\n      <td>1980.0</td>\n      <td>5989.0</td>\n      <td>3130.0</td>\n      <td>3919.0</td>\n      <td>424.0</td>\n      <td>5899.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_NIBRU</th>\n      <td>51623</td>\n      <td>1571.0</td>\n      <td>3397.0</td>\n      <td>3242.0</td>\n      <td>1000.0</td>\n      <td>2347.0</td>\n      <td>757.0</td>\n      <td>5744.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_NIPPUR</th>\n      <td>32093</td>\n      <td>215.0</td>\n      <td>526.0</td>\n      <td>1243.0</td>\n      <td>756.0</td>\n      <td>1836.0</td>\n      <td>349.0</td>\n      <td>2362.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_SAXON</th>\n      <td>39831</td>\n      <td>575.0</td>\n      <td>1984.0</td>\n      <td>1485.0</td>\n      <td>1309.0</td>\n      <td>1133.0</td>\n      <td>296.0</td>\n      <td>3117.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\nJupyter\u306e\u8868\u793a\u4e0a\u3001\u6307\u5c0e\u8005\u5217\u306f2\u884c\u3057\u304b\u306a\u3044\u3088\u3046\u306b\u898b\u3048\u308b\u304c\u3001\u8868\u793a\u4e0a\u305d\u3046\u306a\u3063\u3066\u3044\u308b\u3060\u3051\u3067\u3001\u5b9f\u969b\u306b\u306f\u884c\u306e\u6570\u3001\u3064\u307e\u308a\u2191\u306e\u4f8b\u3067\u8a00\u3048\u307010\u884c\u5b58\u5728\u3059\u308b\u3002\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u3067\u305d\u308c\u306f\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\n```python\ng.head(10).index.values\n```\n\n    array([('TXT_KEY_LEADER_BARBARIAN', 'TXT_KEY_CITY_NAME_KASSITE'),\n       ('TXT_KEY_LEADER_BARBARIAN', 'TXT_KEY_CITY_NAME_SAXON'),\n       ('TXT_KEY_LEADER_BARBARIAN', 'TXT_KEY_CITY_NAME_YAYOI'),\n       ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_BAD_TIBIRA'),\n       ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_ERIDU'),\n       ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_KISH'),\n       ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_LAGASH'),\n       ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_NIBRU'),\n       ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_NIPPUR'),\n       ('TXT_KEY_LEADER_GILGAMESH', 'TXT_KEY_CITY_NAME_SAXON')], dtype=object)\n\n### \u968e\u5c64\u30b0\u30eb\u30fc\u30d7\u306e\u968e\u5c64\u5165\u308c\u66ff\u3048\n\n\u3064\u307e\u308a\u5165\u308c\u66ff\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\n```python\ng.swaplevel(0, 1).head(10)\n```\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n    </tr>\n    <tr>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_KASSITE</th>\n      <th>TXT_KEY_LEADER_BARBARIAN</th>\n      <td>5481</td>\n      <td>41.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>142.0</td>\n      <td>60.0</td>\n      <td>142.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_SAXON</th>\n      <th>TXT_KEY_LEADER_BARBARIAN</th>\n      <td>6825</td>\n      <td>280.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>138.0</td>\n      <td>121.0</td>\n      <td>138.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_YAYOI</th>\n      <th>TXT_KEY_LEADER_BARBARIAN</th>\n      <td>6370</td>\n      <td>48.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>178.0</td>\n      <td>121.0</td>\n      <td>178.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_BAD_TIBIRA</th>\n      <th>TXT_KEY_LEADER_GILGAMESH</th>\n      <td>55560</td>\n      <td>1210.0</td>\n      <td>2468.0</td>\n      <td>1009.0</td>\n      <td>980.0</td>\n      <td>1938.0</td>\n      <td>783.0</td>\n      <td>4406.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_ERIDU</th>\n      <th>TXT_KEY_LEADER_GILGAMESH</th>\n      <td>61035</td>\n      <td>4153.0</td>\n      <td>9768.0</td>\n      <td>5691.0</td>\n      <td>3768.0</td>\n      <td>4776.0</td>\n      <td>423.0</td>\n      <td>14544.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_KISH</th>\n      <th>TXT_KEY_LEADER_GILGAMESH</th>\n      <td>60291</td>\n      <td>1319.0</td>\n      <td>7374.0</td>\n      <td>4118.0</td>\n      <td>4591.0</td>\n      <td>2480.0</td>\n      <td>508.0</td>\n      <td>9854.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_LAGASH</th>\n      <th>TXT_KEY_LEADER_GILGAMESH</th>\n      <td>58206</td>\n      <td>1162.0</td>\n      <td>1980.0</td>\n      <td>5989.0</td>\n      <td>3130.0</td>\n      <td>3919.0</td>\n      <td>424.0</td>\n      <td>5899.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_NIBRU</th>\n      <th>TXT_KEY_LEADER_GILGAMESH</th>\n      <td>51623</td>\n      <td>1571.0</td>\n      <td>3397.0</td>\n      <td>3242.0</td>\n      <td>1000.0</td>\n      <td>2347.0</td>\n      <td>757.0</td>\n      <td>5744.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_NIPPUR</th>\n      <th>TXT_KEY_LEADER_GILGAMESH</th>\n      <td>32093</td>\n      <td>215.0</td>\n      <td>526.0</td>\n      <td>1243.0</td>\n      <td>756.0</td>\n      <td>1836.0</td>\n      <td>349.0</td>\n      <td>2362.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_SAXON</th>\n      <th>TXT_KEY_LEADER_GILGAMESH</th>\n      <td>39831</td>\n      <td>575.0</td>\n      <td>1984.0</td>\n      <td>1485.0</td>\n      <td>1309.0</td>\n      <td>1133.0</td>\n      <td>296.0</td>\n      <td>3117.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>10 rows \u00d7 8 columns</p>\n</div>\n\n### \u968e\u5c64\u30b0\u30eb\u30fc\u30d7\u306e\u518d\u4e26\u3073\u66ff\u3048\n\n\u5165\u308c\u66ff\u3048\u305f\u5f8c\u4e26\u3073\u66ff\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\n```python\ng.swaplevel(0, 1).sortlevel(0).head(3)\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n    </tr>\n    <tr>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"3\" valign=\"top\">TXT_KEY_CITY_NAME_AKKAD</th>\n      <th>TXT_KEY_LEADER_HAMMURABI</th>\n      <td>16769</td>\n      <td>153.0</td>\n      <td>936.0</td>\n      <td>744.0</td>\n      <td>29.0</td>\n      <td>638.0</td>\n      <td>287.0</td>\n      <td>1574.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_LEADER_RAGNAR</th>\n      <td>41110</td>\n      <td>1631.0</td>\n      <td>2496.0</td>\n      <td>776.0</td>\n      <td>977.0</td>\n      <td>1782.0</td>\n      <td>590.0</td>\n      <td>4278.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_LEADER_WANGKON</th>\n      <td>3492</td>\n      <td>44.0</td>\n      <td>55.0</td>\n      <td>128.0</td>\n      <td>12.0</td>\n      <td>144.0</td>\n      <td>57.0</td>\n      <td>199.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u968e\u5c64\u30b0\u30eb\u30fc\u30d7\u3092\u30d4\u30dc\u30c3\u30c8\u30c6\u30fc\u30d6\u30eb\u5f62\u5f0f\u306b\u518d\u69cb\u6210\u3059\u308b\n\n\n\n\n```python\ng2 = g[['\u51fa\u529b']].head(3)\ng2\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>\u51fa\u529b</th>\n    </tr>\n    <tr>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"3\" valign=\"top\">TXT_KEY_LEADER_BARBARIAN</th>\n      <th>TXT_KEY_CITY_NAME_KASSITE</th>\n      <td>142.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_SAXON</th>\n      <td>138.0</td>\n    </tr>\n    <tr>\n      <th>TXT_KEY_CITY_NAME_YAYOI</th>\n      <td>178.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n```python\ng2.unstack()\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr>\n      <th></th>\n      <th colspan=\"3\" halign=\"left\">\u51fa\u529b</th>\n    </tr>\n    <tr>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>TXT_KEY_CITY_NAME_KASSITE</th>\n      <th>TXT_KEY_CITY_NAME_SAXON</th>\n      <th>TXT_KEY_CITY_NAME_YAYOI</th>\n    </tr>\n    <tr>\n      <th>\u6307\u5c0e\u8005</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>TXT_KEY_LEADER_BARBARIAN</th>\n      <td>142.0</td>\n      <td>138.0</td>\n      <td>178.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n### \u5217\u5168\u4f53\u306e\u96c6\u8a08\n\u30c7\u30fc\u30bf\u306e\u4e0b\u6e96\u5099\n\n```python\ndata3 = data.query(\"\u6307\u5c0e\u8005 == 'kojim' & \u30bf\u30fc\u30f3\u6570 > 40 & \u30bf\u30fc\u30f3\u6570 < 50\")\ndata3\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>299</th>\n      <td>41</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>12.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>8.0</td>\n      <td>0.0</td>\n      <td>20.0</td>\n    </tr>\n    <tr>\n      <th>311</th>\n      <td>42</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>10.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>11.0</td>\n      <td>0.0</td>\n      <td>21.0</td>\n    </tr>\n    <tr>\n      <th>323</th>\n      <td>43</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>335</th>\n      <td>44</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>348</th>\n      <td>45</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>361</th>\n      <td>46</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>362</th>\n      <td>46</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_SPARTA</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>375</th>\n      <td>47</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>376</th>\n      <td>47</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_SPARTA</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>389</th>\n      <td>48</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>390</th>\n      <td>48</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_SPARTA</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>403</th>\n      <td>49</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>8.0</td>\n      <td>0.0</td>\n      <td>19.0</td>\n    </tr>\n    <tr>\n      <th>404</th>\n      <td>49</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_SPARTA</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\u5217\u5168\u4f53\u306e\u7d2f\u7a4d\u5024\u3092\u8a08\u7b97\u3002\n\n```python\ndata3['\u7d2f\u7a4d\u51fa\u529b'] = data['\u51fa\u529b'].cumsum()\ndata3\n```\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th>\u6307\u5c0e\u8005</th>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n      <th>\u7d2f\u7a4d\u51fa\u529b</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>299</th>\n      <td>41</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>12.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>8.0</td>\n      <td>0.0</td>\n      <td>20.0</td>\n      <td>3419.0</td>\n    </tr>\n    <tr>\n      <th>311</th>\n      <td>42</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>10.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>11.0</td>\n      <td>0.0</td>\n      <td>21.0</td>\n      <td>3545.0</td>\n    </tr>\n    <tr>\n      <th>323</th>\n      <td>43</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n      <td>3666.0</td>\n    </tr>\n    <tr>\n      <th>335</th>\n      <td>44</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n      <td>3786.0</td>\n    </tr>\n    <tr>\n      <th>348</th>\n      <td>45</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n      <td>3908.0</td>\n    </tr>\n    <tr>\n      <th>361</th>\n      <td>46</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n      <td>4031.0</td>\n    </tr>\n    <tr>\n      <th>362</th>\n      <td>46</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_SPARTA</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>4034.0</td>\n    </tr>\n    <tr>\n      <th>375</th>\n      <td>47</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n      <td>4164.0</td>\n    </tr>\n    <tr>\n      <th>376</th>\n      <td>47</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_SPARTA</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>4167.0</td>\n    </tr>\n    <tr>\n      <th>389</th>\n      <td>48</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n      <td>4295.0</td>\n    </tr>\n    <tr>\n      <th>390</th>\n      <td>48</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_SPARTA</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>4298.0</td>\n    </tr>\n    <tr>\n      <th>403</th>\n      <td>49</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_ATHENS</td>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>8.0</td>\n      <td>0.0</td>\n      <td>19.0</td>\n      <td>4428.0</td>\n    </tr>\n    <tr>\n      <th>404</th>\n      <td>49</td>\n      <td>kojim</td>\n      <td>TXT_KEY_CITY_NAME_SPARTA</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n      <td>4431.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n\u5217\u5168\u4f53\u306e\u5408\u8a08\u5024\u3092\u8a08\u7b97\u3002\n\n```python\ndata['\u51fa\u529b'].sum()\n```\n\n### \u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306e\u518d\u96c6\u8a08\n```python\ndata4 = data.query(\"\u6307\u5c0e\u8005 == 'kojim' & \u30bf\u30fc\u30f3\u6570 > 40 & \u30bf\u30fc\u30f3\u6570 < 50\").groupby(['\u90fd\u5e02\u540d', '\u30bf\u30fc\u30f3\u6570']).sum()\ndata4\n```\n\n\u305f\u3068\u3048\u3070\u968e\u5c64\u30c7\u30fc\u30bf\u306e\u7279\u5b9a\u968e\u5c64\u3067\u306e\u96c6\u8a08\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u3002\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>\u91d1\u92ad</th>\n      <th>\u7814\u7a76</th>\n      <th>\u6587\u5316</th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u751f\u7523</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u51fa\u529b</th>\n    </tr>\n    <tr>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"9\" valign=\"top\">TXT_KEY_CITY_NAME_ATHENS</th>\n      <th>41</th>\n      <td>0.0</td>\n      <td>12.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>8.0</td>\n      <td>0.0</td>\n      <td>20.0</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>0.0</td>\n      <td>10.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>11.0</td>\n      <td>0.0</td>\n      <td>21.0</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>7.0</td>\n      <td>0.0</td>\n      <td>18.0</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>0.0</td>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>8.0</td>\n      <td>0.0</td>\n      <td>19.0</td>\n    </tr>\n    <tr>\n      <th rowspan=\"4\" valign=\"top\">TXT_KEY_CITY_NAME_SPARTA</th>\n      <th>46</th>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>3.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n\n```python\ndata4.groupby(level=0).cumsum()\n```\n\n<div>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>\u30b9\u30d1\u30a4</th>\n      <th>\u51fa\u529b</th>\n      <th>\u6587\u5316</th>\n      <th>\u751f\u7523</th>\n      <th>\u7814\u7a76</th>\n      <th>\u7dad\u6301\u8cbb</th>\n      <th>\u91d1\u92ad</th>\n    </tr>\n    <tr>\n      <th>\u90fd\u5e02\u540d</th>\n      <th>\u30bf\u30fc\u30f3\u6570</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"9\" valign=\"top\">TXT_KEY_CITY_NAME_ATHENS</th>\n      <th>41</th>\n      <td>4.0</td>\n      <td>20.0</td>\n      <td>4.0</td>\n      <td>8.0</td>\n      <td>12.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>8.0</td>\n      <td>41.0</td>\n      <td>8.0</td>\n      <td>19.0</td>\n      <td>22.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>12.0</td>\n      <td>59.0</td>\n      <td>12.0</td>\n      <td>26.0</td>\n      <td>33.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>16.0</td>\n      <td>77.0</td>\n      <td>16.0</td>\n      <td>33.0</td>\n      <td>44.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>20.0</td>\n      <td>95.0</td>\n      <td>20.0</td>\n      <td>40.0</td>\n      <td>55.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>24.0</td>\n      <td>113.0</td>\n      <td>24.0</td>\n      <td>47.0</td>\n      <td>66.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>28.0</td>\n      <td>131.0</td>\n      <td>28.0</td>\n      <td>54.0</td>\n      <td>77.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>32.0</td>\n      <td>149.0</td>\n      <td>32.0</td>\n      <td>61.0</td>\n      <td>88.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>36.0</td>\n      <td>168.0</td>\n      <td>36.0</td>\n      <td>69.0</td>\n      <td>99.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th rowspan=\"4\" valign=\"top\">TXT_KEY_CITY_NAME_SPARTA</th>\n      <th>46</th>\n      <td>0.0</td>\n      <td>3.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>2.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>0.0</td>\n      <td>6.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>0.0</td>\n      <td>9.0</td>\n      <td>6.0</td>\n      <td>6.0</td>\n      <td>3.0</td>\n      <td>6.0</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>0.0</td>\n      <td>12.0</td>\n      <td>8.0</td>\n      <td>8.0</td>\n      <td>4.0</td>\n      <td>8.0</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n", "tags": ["pandas"]}