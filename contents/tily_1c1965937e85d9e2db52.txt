{"context": "sekka1/docker-s3cmd: s3cmd in a Docker container \u306f\u3044\u3061\u3044\u3061\u30b3\u30f3\u30c6\u30ca\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3001/opt/main.sh \u3092\u53e9\u304b\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306e\u304c\u3060\u308b\u304b\u3063\u305f\u306e\u3067\u3001\u30db\u30b9\u30c8\u5074\u304b\u3089\u3042\u307e\u308a\u30b3\u30f3\u30c6\u30ca\u3092\u610f\u8b58\u305b\u305a\u306b\u4f7f\u3048\u308b\u3088\u3046\u306a\u3084\u308a\u65b9\u3092\u8003\u3048\u3066\u307f\u305f\u3002\n\u306a\u304a\u3001\u4e0b\u8a18\u3067\u306f\u30a2\u30af\u30bb\u30b9\u5148\u304c\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30b9\u30c8\u30ec\u30fc\u30b8\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u5c11\u3057\u3044\u3058\u308c\u3070\u4ed6\u306e S3 \u4e92\u63db API \u3067\u3082\u5229\u7528\u53ef\u80fd\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u6e96\u5099\n\u307e\u305a Dockerfile \u4f5c\u6210\u3002\njwilder/dockerize \u3092\u4f7f\u3063\u3066\u3001s3cmd \u304c\u8aad\u307f\u8fbc\u3080\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb ~/.s3cfg \u3092\u751f\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n$ vi Dockerfile\n\nFROM ubuntu\nRUN apt-get update && apt-get install -y wget s3cmd\n\nENV DOCKERIZE_VERSION v0.3.0\nRUN wget https://github.com/jwilder/dockerize/releases/download/$DOCKERIZE_VERSION/dockerize-linux-amd64-$DOCKERIZE_VERSION.tar.gz \\\n    && tar -C /usr/local/bin -xzvf dockerize-linux-amd64-$DOCKERIZE_VERSION.tar.gz \\\n    && rm dockerize-linux-amd64-$DOCKERIZE_VERSION.tar.gz\n\nADD dot.s3cfg.tmpl /root/.s3cfg.tmpl\nENTRYPOINT [\"dockerize\", \"-template\", \"/root/.s3cfg.tmpl:/root/.s3cfg\", \"s3cmd\"]\n\nWORKDIR /work\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u30ec\u4f5c\u6210\u3002\n$ vi dot.s3cfg.tmpl\n\n[default]\naccess_key = {{ .Env.ACCESS_KEY }}\nsecret_key = {{ .Env.SECRET_KEY }}\nhost_base = jp-east-2.os.cloud.nifty.com\nhost_bucket = %(bucket)s.jp-east-2.os.cloud.nifty.com\n\ndocker \u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\u3057\u3066\u304a\u304f\u3002\n$ docker build -t s3cmd .\n(\u7565)\nSuccessfully built d128c83ccaeb\n\n\u3042\u3068\u306f\u3001s3cmd \u306b\u30a8\u30a4\u30ea\u30a2\u30b9\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3002\n(\u5b9a\u5e38\u7684\u306b\u4f7f\u3046\u5834\u5408\u306b\u306f ~/.bashrc \u7b49\u306b\u66f8\u3044\u3066\u304a\u304f\u3068\u3044\u3044\u304b\u3082\u3002)\n$ alias s3cmd=\"docker run \\\n  -ti --rm -v $(pwd):/work \\\n  -e ACCESS_KEY=${YOUR_ACCESS_KEY} \\\n  -e SECRET_KEY=${YOUR_SECRET_KEY} \\\n  s3cmd\"\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\u3053\u3053\u307e\u3067\u3084\u308b\u3068\u3001\u30db\u30b9\u30c8\u306b s3cmd \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u306a\u304f\u3066\u3082\u30b3\u30f3\u30c6\u30ca\u7d4c\u7531\u3067 s3cmd \u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u30d0\u30b1\u30c3\u30c8\u306e\u4f5c\u6210\u3002\n$ s3cmd mb s3://tily\nBucket 's3://tily/' created\n2017/02/10 04:09:15 Command finished successfully.\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u4e00\u89a7\u3002\n$ s3cmd ls\n2017-02-10 03:52  s3://tily\n2017/02/10 04:09:33 Command finished successfully.\n\ns3cmd \u30b3\u30f3\u30c6\u30ca\u306f -v $(pwd):/work \u3067\u8d77\u52d5\u3059\u308b\u306e\u3067\u3001\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3060\u3063\u305f\u3089\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30fb\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3082\u3067\u304d\u308b\u3002\n\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3002(\u5fae\u5999\u306b\u5909\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u3051\u3069\u306a\u3093\u3060\u308d\u3046\u3002)\n$ echo hello world > test.txt\n$ s3cmd put test.txt s3://tily/test.txt\nWARNING: test.txt: Owner username not known. Storing UID=500 instead.\nWARNING: test.txt: Owner groupname not known. Storing GID=500 instead.\nupload: 'test.txt' -> 's3://tily/test.txt'  [1 of 1]\n 12 of 12   100% in    0s   354.82 B/s  done\nupload: 'test.txt' -> 's3://tily/test.txt'  [1 of 1]\n 12 of 12   100% in    0s   228.68 B/s  done\n2017/02/10 04:11:38 Command finished successfully.\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n$ s3cmd get s3://tily/test.txt test2.txt\ndownload: 's3://tily/test.txt' -> 'test2.txt'  [1 of 1]\ndownload: 's3://tily/test.txt' -> 'test2.txt'  [1 of 1]\n 12 of 12   100% in    0s   528.98 B/s  done\n2017/02/10 04:12:35 Command finished successfully.\n$ cat test2.txt \nhello world\n\n\n\u307e\u3068\u3081\n\u3042\u307e\u308a\u30b3\u30f3\u30c6\u30ca\u3092\u610f\u8b58\u305b\u305a\u306b\u30db\u30b9\u30c8\u5074\u304b\u3089 s3cmd \u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u4fbf\u5229\u306b\u306a\u3063\u305f\u3002\u3042\u3068\u3042\u307e\u308a\u95a2\u4fc2\u306a\u3044\u3051\u3069\u3001dockerize \u306f\u30c6\u30f3\u30d7\u30ec\u6a5f\u80fd\u3060\u3051\u3067\u306a\u304f\u3001\u5225\u306e\u30b3\u30f3\u30c6\u30ca\u306e TCP \u30dd\u30fc\u30c8\u304c LISTEN \u3059\u308b\u307e\u3067\u5f85\u3063\u3066\u304f\u308c\u308b\u6a5f\u80fd \u3082\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u3053\u3061\u3089\u3082\u4eca\u5ea6\u8a66\u3057\u3066\u307f\u305f\u3044\u3002\n[sekka1/docker\\-s3cmd: s3cmd in a Docker container](https://github.com/sekka1/docker-s3cmd) \u306f\u3044\u3061\u3044\u3061\u30b3\u30f3\u30c6\u30ca\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3001`/opt/main.sh` \u3092\u53e9\u304b\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u306e\u304c\u3060\u308b\u304b\u3063\u305f\u306e\u3067\u3001\u30db\u30b9\u30c8\u5074\u304b\u3089\u3042\u307e\u308a\u30b3\u30f3\u30c6\u30ca\u3092\u610f\u8b58\u305b\u305a\u306b\u4f7f\u3048\u308b\u3088\u3046\u306a\u3084\u308a\u65b9\u3092\u8003\u3048\u3066\u307f\u305f\u3002\n\n\u306a\u304a\u3001\u4e0b\u8a18\u3067\u306f\u30a2\u30af\u30bb\u30b9\u5148\u304c[\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30b9\u30c8\u30ec\u30fc\u30b8](http://cloud.nifty.com/service/obj_storage.htm)\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u5c11\u3057\u3044\u3058\u308c\u3070\u4ed6\u306e S3 \u4e92\u63db API \u3067\u3082\u5229\u7528\u53ef\u80fd\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n## \u6e96\u5099\n\n\u307e\u305a Dockerfile \u4f5c\u6210\u3002\n[jwilder/dockerize](https://github.com/jwilder/dockerize) \u3092\u4f7f\u3063\u3066\u3001s3cmd \u304c\u8aad\u307f\u8fbc\u3080\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb `~/.s3cfg` \u3092\u751f\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n\n```\n$ vi Dockerfile\n```\n\n```\nFROM ubuntu\nRUN apt-get update && apt-get install -y wget s3cmd\n\nENV DOCKERIZE_VERSION v0.3.0\nRUN wget https://github.com/jwilder/dockerize/releases/download/$DOCKERIZE_VERSION/dockerize-linux-amd64-$DOCKERIZE_VERSION.tar.gz \\\n    && tar -C /usr/local/bin -xzvf dockerize-linux-amd64-$DOCKERIZE_VERSION.tar.gz \\\n    && rm dockerize-linux-amd64-$DOCKERIZE_VERSION.tar.gz\n\nADD dot.s3cfg.tmpl /root/.s3cfg.tmpl\nENTRYPOINT [\"dockerize\", \"-template\", \"/root/.s3cfg.tmpl:/root/.s3cfg\", \"s3cmd\"]\n\nWORKDIR /work\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30c6\u30f3\u30d7\u30ec\u4f5c\u6210\u3002\n\n```\n$ vi dot.s3cfg.tmpl\n```\n\n```\n[default]\naccess_key = {{ .Env.ACCESS_KEY }}\nsecret_key = {{ .Env.SECRET_KEY }}\nhost_base = jp-east-2.os.cloud.nifty.com\nhost_bucket = %(bucket)s.jp-east-2.os.cloud.nifty.com\n```\n\ndocker \u30a4\u30e1\u30fc\u30b8\u3092\u30d3\u30eb\u30c9\u3057\u3066\u304a\u304f\u3002\n\n```\n$ docker build -t s3cmd .\n(\u7565)\nSuccessfully built d128c83ccaeb\n```\n\n\u3042\u3068\u306f\u3001s3cmd \u306b\u30a8\u30a4\u30ea\u30a2\u30b9\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u3002\n(\u5b9a\u5e38\u7684\u306b\u4f7f\u3046\u5834\u5408\u306b\u306f `~/.bashrc` \u7b49\u306b\u66f8\u3044\u3066\u304a\u304f\u3068\u3044\u3044\u304b\u3082\u3002)\n\n```\n$ alias s3cmd=\"docker run \\\n  -ti --rm -v $(pwd):/work \\\n  -e ACCESS_KEY=${YOUR_ACCESS_KEY} \\\n  -e SECRET_KEY=${YOUR_SECRET_KEY} \\\n  s3cmd\"\n```\n\n## \u52d5\u4f5c\u78ba\u8a8d\n\n\u3053\u3053\u307e\u3067\u3084\u308b\u3068\u3001\u30db\u30b9\u30c8\u306b s3cmd \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u306a\u304f\u3066\u3082\u30b3\u30f3\u30c6\u30ca\u7d4c\u7531\u3067 s3cmd \u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u4f5c\u6210\u3002\n\n```\n$ s3cmd mb s3://tily\nBucket 's3://tily/' created\n2017/02/10 04:09:15 Command finished successfully.\n```\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u4e00\u89a7\u3002\n\n```\n$ s3cmd ls\n2017-02-10 03:52  s3://tily\n2017/02/10 04:09:33 Command finished successfully.\n```\n\ns3cmd \u30b3\u30f3\u30c6\u30ca\u306f `-v $(pwd):/work` \u3067\u8d77\u52d5\u3059\u308b\u306e\u3067\u3001\u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3060\u3063\u305f\u3089\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30fb\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3082\u3067\u304d\u308b\u3002\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3002(\u5fae\u5999\u306b\u5909\u306a\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u3051\u3069\u306a\u3093\u3060\u308d\u3046\u3002)\n\n```\n$ echo hello world > test.txt\n$ s3cmd put test.txt s3://tily/test.txt\nWARNING: test.txt: Owner username not known. Storing UID=500 instead.\nWARNING: test.txt: Owner groupname not known. Storing GID=500 instead.\nupload: 'test.txt' -> 's3://tily/test.txt'  [1 of 1]\n 12 of 12   100% in    0s   354.82 B/s  done\nupload: 'test.txt' -> 's3://tily/test.txt'  [1 of 1]\n 12 of 12   100% in    0s   228.68 B/s  done\n2017/02/10 04:11:38 Command finished successfully.\n```\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3002\n\n```\n$ s3cmd get s3://tily/test.txt test2.txt\ndownload: 's3://tily/test.txt' -> 'test2.txt'  [1 of 1]\ndownload: 's3://tily/test.txt' -> 'test2.txt'  [1 of 1]\n 12 of 12   100% in    0s   528.98 B/s  done\n2017/02/10 04:12:35 Command finished successfully.\n$ cat test2.txt \nhello world\n```\n\n## \u307e\u3068\u3081\n\n\u3042\u307e\u308a\u30b3\u30f3\u30c6\u30ca\u3092\u610f\u8b58\u305b\u305a\u306b\u30db\u30b9\u30c8\u5074\u304b\u3089 s3cmd \u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u4fbf\u5229\u306b\u306a\u3063\u305f\u3002\u3042\u3068\u3042\u307e\u308a\u95a2\u4fc2\u306a\u3044\u3051\u3069\u3001dockerize \u306f\u30c6\u30f3\u30d7\u30ec\u6a5f\u80fd\u3060\u3051\u3067\u306a\u304f\u3001[\u5225\u306e\u30b3\u30f3\u30c6\u30ca\u306e TCP \u30dd\u30fc\u30c8\u304c LISTEN \u3059\u308b\u307e\u3067\u5f85\u3063\u3066\u304f\u308c\u308b\u6a5f\u80fd](https://github.com/jwilder/dockerize#waiting-for-other-dependencies) \u3082\u3042\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u3053\u3061\u3089\u3082\u4eca\u5ea6\u8a66\u3057\u3066\u307f\u305f\u3044\u3002\n", "tags": ["docker", "S3", "NiftyCloud"]}