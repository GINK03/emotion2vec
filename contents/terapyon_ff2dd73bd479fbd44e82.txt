{"context": " More than 1 year has passed since last update.\u3053\u306e\u8a18\u4e8b\u306f\u3001AWS S3 + CloudFront \u3067\u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u7d9a\u304d\u3067\u3059\u3002\n\n\u76ee\u7684\n\u671f\u9650\u4ed8\u304dURL\u3067\u306e\u63a5\u7d9a\u3092\u884c\u3046\u3002(\u30ef\u30f3\u30bf\u30a4\u30e0URL)\n\u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\u95b2\u89a7\u5236\u9650\u3057\u914d\u4fe1\u3057\u305f\u3044\u3002(\u4eca\u56de\u306f\u753b\u50cf\u3067\u8a66\u3057\u305f)\n\u6700\u7d42\u7684\u306b\u306fPlone\u306e\u8a8d\u8a3c\u3092\u4f7f\u3063\u3066\u52d5\u753b\u3092\u914d\u4fe1\u3057\u305f\u3044\u3002(\u6b21\u56de\u4ee5\u964d\u306b\u30c1\u30e3\u30ec\u30f3\u30b8)\n\nS3 \u53ca\u3073 CloudFront \u306e\u8a2d\u5b9a\n\u65b0\u898f\u306b\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u308a\u3001\u304a\u8a66\u3057\u306e\u753b\u50cf\u3092\u7f6e\u304f\u3002\u3053\u306e\u753b\u50cf\u3092\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u914d\u4fe1\u3059\u308b\u4e8b\u3092\u8a66\u3059\u3002\n\nS3\n\n\u65b0\u898f\u306b\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u308b (c2-video-test-private)\n\n\n\u30ed\u30b0\u306e\u8a2d\u5b9a\u306f\u884c\u3046\n\n\nUpload\n\n\n\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9 \"terada_pythonbr.jpg\"\n\n\n\n\nCloundFront\n\nCloudFront \u30a2\u30af\u30bb\u30b9ID\u306e\u53d6\u5f97\n\n\nIAM\u306eWeb\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u3078\u884c\u304f\nDetails\u5185\u306e\u3001 \"CloudFront Key Pair\" \u3067\u3001\"Create New Key Pair\"\u3092\u53d6\u5f97\n\u79d8\u5bc6\u9375\u3068\u516c\u958b\u9375\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n\n\nCloudFront Origin\nCloudFront\u306eWeb\u7ba1\u7406\u753b\u9762\u3067\u3001\"Private Content\"\u304b\u3089\"Origin Access Identity\"\u3078\u884c\u304f\uff08\u3042\u3068\u3067\u4f5c\u308b\u65b9\u6cd5\u3082\u3042\u308b\uff09\n\n\nCreate OAI \u3092\u30af\u30ea\u30c3\u30af\n\u30b3\u30e1\u30f3\u30c8\u306b \"OAI for c2-video-test-private\" \u3068\u5165\u308c\u3066\u4f5c\u6210\n\n\n\u65b0\u898f\u306b\"Private Distribution\"\u3092\u4f5c\u308b (Web\u7528\uff09\n\u8a2d\u5b9a\u3092\u884c\u3046\n\n\nRestrict Bucket Access: Yes\nOrigin Access Identity: Use an Existing Identity\nYour Identities: \u3092\u524d\u3082\u3063\u3066\u4f5c\u3063\u305f\u3082\u306e\u3092\u9078\u629e\uff08\u307e\u305f\u306f\u3053\u3053\u3067\u65b0\u898f\u306b\u4f5c\u308b\u3053\u3068\u3082\u53ef\u80fd\uff09\nGrant Read Permissions on Bucket: Yes\nHTTPS Only:Yes\nRestrict Viewer Access: Yes\nTrusted Signers\nLogging: On\n\u305d\u306e\u4ed6Logging\u306e\u8a2d\u5b9a\uff08\u30d0\u30b1\u30c3\u30c8\u3068Path)\n\n\nDomain Name: dn045wcqv2fv4.cloudfront.net \u3068\u306a\u3063\u305f\n\n\nSigned URL\u3092\u4f5c\u308b\n\u4ee5\u4e0b\u306e boto\u306e\u9805\u76ee\u3092\u53c2\u7167\u3057\u30ed\u30fc\u30ab\u30eb\u306ePython\u74b0\u5883\u3067\u4f5c\u3063\u3066\u307f\u308b\u3002\n\n\u5236\u9650\u306a\u3057URL\u306f\u3001\u4ee5\u4e0b\u3068\u306a\u308b\u306f\u305a\u3002\nhttps://dn045wcqv2fv4.cloudfront.net/terada_pythonbr.jpg\n\u5f53\u7136\u3067\u3059\u304c\u3001\u30a8\u30e9\u30fc\u304c\u5e30\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\nerror.xml\n<Error>\n  <Code>MissingKey</Code>\n  <Message>Missing Key-Pair-Id query parameter</Message>\n</Error>\n\n\n\n\u5236\u9650\u4ed8\u304dURL\u3092\u4f5c\u308b\n(boto\u95a2\u4fc2\u306e\u8a73\u7d30\u306f\u4e0b\u90e8\u306b\u8a18\u8f09\uff09\n\nsample.py\nACCESS_KEY_ID = \"xxxxxxxxxxxxxxxxx\"\nSECRET_ACCESS_KEY = \"xxxxxxxxxxxxxxxxxxxxxxxxxx\"\nYOUR_KEYPAIR_ID = \"xxxxxxxxxxxxxx\"\nYOUR_PRIVATE_KEY_FILE_LOCATION = \"xxxxxxxxxxxxxxxxxxxxx.pem\"\nurl = \"https://dn045wcqv2fv4.cloudfront.net/terada_pythonbr.jpg\"\nexpire_time = int(time.time() +3600)\n\nconn = CloudFrontConnection(ACCESS_KEY_ID, SECRET_ACCESS_KEY)\ndistribution = Distribution(connection=conn, config=None, domain_name='', id='', last_modified_time=None, status='')\n\nsigned_url = distribution.create_signed_url(url=url, keypair_id=YOUR_KEYPAIR_ID, expire_time=expire_time, private_key_file=YOUR_PRIVATE_KEY_FILE_LOCATION)\n\n\n>>> print signed_url\nhttps://dn045wcqv2fv4.cloudfront.net/terada_pythonbr.jpg?Expires=1406023941&Signature=Ihps3u0~jQ-Twkghg2tqQ-dTMEZoRC-Jb13F4FgNe~1MVAsXQ-yAbXtEKSTsIhN6OLZmuUii6E1xs7nWfe-76SGk26Jmx5edd35EgwQ8mH~2XlY4QOqP1Fgza93q02oQNhJWte1mef4tc8p3fJO6yzebpTEh4MqvQOt9s5bcKq9ad8EGSmfXfUlgL6b87z6TOAXVFQuIotttu6ajlfbCpplIUD-~r-6W~SB6n2dyB8SaoKgJBTkEKJwFiBWx2S5M20-06hsLOeV23UBJcuq6~C-pE1r1ViE8Ia-tM8L6v7zcbtLfOdw9lgFzYoMoh-KiWOAdz7pc-koYMVPXZ-9DuQ__&Key-Pair-Id=APKAJAJZQHPKZI6OK5UQ\n\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u30c6\u30b9\u30c8\nhttps://dn045wcqv2fv4.cloudfront.net/terada_pythonbr.jpg?Expires=1406023941&Signature=Ihps3u0~jQ-Twkghg2tqQ-dTMEZoRC-Jb13F4FgNe~1MVAsXQ-yAbXtEKSTsIhN6OLZmuUii6E1xs7nWfe-76SGk26Jmx5edd35EgwQ8mH~2XlY4QOqP1Fgza93q02oQNhJWte1mef4tc8p3fJO6yzebpTEh4MqvQOt9s5bcKq9ad8EGSmfXfUlgL6b87z6TOAXVFQuIotttu6ajlfbCpplIUD-~r-6W~SB6n2dyB8SaoKgJBTkEKJwFiBWx2S5M20-06hsLOeV23UBJcuq6~C-pE1r1ViE8Ia-tM8L6v7zcbtLfOdw9lgFzYoMoh-KiWOAdz7pc-koYMVPXZ-9DuQ__&Key-Pair-Id=APKAJAJZQHPKZI6OK5UQ\n2014/07/22 18:14\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u305f\u3002\n2014/07/22 19:15\u306b\u306a\u3063\u305f\u3089\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u306f\u305a\n\nboto\nboto \u306f\u3001AWS\u306eAPI\u3092\u64cd\u4f5c\u3059\u308bPython\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\u4ee5\u524d\u306fAmazon\u975e\u516c\u5f0f\u3067\u3057\u305f\u304c\u3001\u3044\u307e\u306f\u958b\u767a\u8005\u304cAmazon\u6240\u5c5e\u306b\u306a\u3063\u305f\u306f\u305a\u306a\u306e\u3067\u3001\u534a\u516c\u5f0f\u306a\u306f\u305a\u3067\u3059\u3002\n\n\u4e8b\u524d\u6e96\u5099\n$ pip install rsa\n$ pip install boto\n\n\nSigned URL\u306e\u53d6\u5f97\u65b9\u6cd5\n\u8aac\u660e\u304c\u4ee5\u4e0b\u306b\u3042\u308a\u307e\u3057\u305f\u3002\nhttp://boto.readthedocs.org/en/latest/ref/cloudfront.html\ncreate_signed_url(url, keypair_id, expire_time=None, valid_after_time=None, ip_address=None, policy_url=None, private_key_file=None, private_key_string=None)\n\n\nurl (str) \nkeypair_id (str) \nexpire_time (int) \nvalid_after_time (int)\nip_address (str)\npolicy_url (str)\nprivate_key_file (str or file object.) \nprivate_key_string (str) \n\n\u4ee5\u4e0b\u306b\u30b5\u30f3\u30d7\u30eb\u304c\u3042\u3063\u305f\nhttp://stackoverflow.com/questions/2573919/creating-signed-urls-for-amazon-cloudfront\nimport boto\nfrom boto.cloudfront import CloudFrontConnection\nfrom boto.cloudfront.distribution import Distribution\n\nexpire_time = int(time.time() +3000)\nconn = CloudFrontConnection('ACCESS_KEY_ID', 'SECRET_ACCESS_KEY')\n\n##enter the id or domain name to select a distribution\ndistribution = Distribution(connection=conn, config=None, domain_name='', id='', last_modified_time=None, status='')\nsigned_url = distribution.create_signed_url(url='YOUR_URL', keypair_id='YOUR_KEYPAIR_ID_example-APKAIAZVIO4BQ',expire_time=expire_time,private_key_file=\"YOUR_PRIVATE_KEY_FILE_LOCATION\")\n\n\n\u8abf\u67fb\u6642\u306b\u53c2\u7167\u3057\u305fURL\n\n[AWS\u30de\u30a4\u30b9\u30bf\u30fc\u30b7\u30ea\u30fc\u30ba] Amazon CloudFront / Amazon Elastic Transcoder\u306b\u3088\u308b\u30b3\u30f3\u30c6\u30f3\u30c4\u914d\u4fe1\nhttp://www.slideshare.net/AmazonWebServicesJapan/20131120-aws-medisterregeneratecloudfrontetspublic\nP29\u306b\u8aac\u660e\u304c\u3042\u308b\nAmazon CloudFront \u3067\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u30a2\u30af\u30bb\u30b9 \u305d\u306e1\nhttp://dev.classmethod.jp/etc/amazon-cloudfront-private-contents-access-1/\nAWS\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u82f1\u8a9e\u3067\u30de\u30cb\u30e5\u30a2\u30eb\u304c\u6709\u308a\u3001\u73fe\u72b6\u3067\u306f\u3001Web\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u5168\u3066\u306e\u64cd\u4f5c\u304c\u51fa\u6765\u305d\u3046\u3002\nCode and Examples for Creating a Signature for a Signed URL\nhttp://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/PrivateCFSignatureCodeAndExamples.html\nPython\u306e\u60c5\u5831\u304c\u7121\u3044\u3051\u3069\u53c2\u8003\u306b\u306a\u308a\u305d\u3046\n\n\n\u52d5\u753b\u3067\u8a66\u3057\u3066\u307f\u308b\nTODO\u306b\u3057\u3066\u3044\u305f\u3001\u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\u4e0a\u8a18\u3092\u5bfe\u5fdc\u3055\u305b\u308b\n\n\u6e96\u5099\n\nc2-video-test-private \u30d0\u30b1\u30c3\u30c8\u306b\u3001video\u30d5\u30a9\u30eb\u30c0\u3092\u8ffd\u52a0\nPyConAPACTW2014terada.mp4 \u3092 video\u30d5\u30a9\u30eb\u30c0\u306b\u8ffd\u52a0\nCloudFront\u306b\u30b9\u30c8\u30ea\u30fc\u30e0\u5bfe\u5fdc\u306eDistribution\u3092\u8ffd\u52a0\n\n\nCreate\u6642\u306b\u3001RTMP\u3092\u9078\u629e\nOrigin Domain Name : c2-video-test-private\nRestrict Bucket Access: Yes\nOrigin Access Identity: Use an Existing Identity\nYour Identities: \u3092\u524d\u3082\u3063\u3066\u4f5c\u3063\u305f\u3082\u306e\u3092\u9078\u629e  (OAI for c2-video-test-private)\nGrant Read Permissions on Bucket: Yes\nRestrict Viewer Access: Yes\nTrusted Signers: Self\nLogging: On\n\u305d\u306e\u4ed6Logging\u306e\u8a2d\u5b9a\uff08\u30d0\u30b1\u30c3\u30c8\u3068Path)\n\n\n\n\u3053\u3053\u307e\u3067\u306f\u3001\u4eca\u307e\u3067\u306e\u304a\u3055\u3089\u3044\u3067\u7c21\u5358\u306b\u51fa\u6765\u308b\u306f\u305a\u3002\n\nSigned URL\u3092\u4f5c\u308b\n\u4e0a\u8a18\u540c\u69d8\u306b\u3001boto\u3092\u4f7f\u3063\u3066\u4f5c\u696d\n\nurl = \"rtmp://s3lse3ja7xuop9.cloudfront.net/cfx/st/&mp4:video/PyConAPACTW2014terada.mp4\"\npolicy_url = \"video/\"\n\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002 **rtmp\u306e\u6642\u306f* \u4e0a\u8a18\u306e\u3088\u3046\u306bPATH\u3060\u3051\u3092\u66f8\u304f(rtpm://\u304b\u3089\u66f8\u304f\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u3044\uff1c\u3053\u308c\u3067\u6570\u65e5\u30cf\u30de\u3063\u305f)\n\n>>> url = \"rtmp://s3lse3ja7xuop9.cloudfront.net/cfx/st/&mp4:video/PyConAPACTW2014terada.mp4\"\n>>> policy_url = \"video/*\"\n>>> signed_url = distribution.create_signed_url(url=url, keypair_id=YOUR_KEYPAIR_ID, expire_time=expire_time, private_key_file=YOUR_PRIVATE_KEY_FILE_LOCATION, policy_url=policy_url)\n>>> print signed_url\nrtmp://s3lse3ja7xuop9.cloudfront.net/cfx/st/&mp4:video/PyConAPACTW2014terada.mp4?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoidmlkZW8vKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTQwNjg5OTIwMX19fV19&Signature=m10lfH4vpepAWVNLCGO9xr~TFs-ZCUklra-I4D6WZvqO3aHhijIbtPQOiK00BPZzTxnu-enkvTuao1aDoP~HSONzF5xIqGqMuP4RYJ-B0~g5iQxvac1VVkb~3lZXMRN3Oz45BsrRWQawyXp1o~0M9sFr~zIVQAbM8aAji1WmTu0~fY0UcfgO74DNevYw4-I4S8S2KLnSimFGeU0bz3b8bXtgxketPz0JhTyM4akK8gD7xWjskrxFOZ4pskCaLvJr3Pyb9pJsqQ9T2izNsPs0Ms5pi94FnOdyejSRWezqrxp00KNttnlc3DGCOcmcCNDNYdIMxmNC6MuAfQKx~a1tig__&Key-Pair-Id=APKAJAJZQHPKZI6OK5UQ\n\n\n\u52d5\u753b\u8868\u793a\u7528\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\nsrc\u306e\u90e8\u5206\u3092Signed URL\u306b\u3059\u308b\u3002\n<source src=\"rtmp://s3lse3ja7xuop9.cloudfront.net/cfx/st/&mp4:video/PyConAPACTW2014terada.mp4?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoidmlkZW8vKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTQwNjg5OTIwMX19fV19&Signature=m10lfH4vpepAWVNLCGO9xr~TFs-ZCUklra-I4D6WZvqO3aHhijIbtPQOiK00BPZzTxnu-enkvTuao1aDoP~HSONzF5xIqGqMuP4RYJ-B0~g5iQxvac1VVkb~3lZXMRN3Oz45BsrRWQawyXp1o~0M9sFr~zIVQAbM8aAji1WmTu0~fY0UcfgO74DNevYw4-I4S8S2KLnSimFGeU0bz3b8bXtgxketPz0JhTyM4akK8gD7xWjskrxFOZ4pskCaLvJr3Pyb9pJsqQ9T2izNsPs0Ms5pi94FnOdyejSRWezqrxp00KNttnlc3DGCOcmcCNDNYdIMxmNC6MuAfQKx~a1tig__&Key-Pair-Id=APKAJAJZQHPKZI6OK5UQ\"\n                 type='rtmp/mp4' />\n\n\n\u30c6\u30b9\u30c8\u30da\u30fc\u30b8\n\u3059\u3067\u306b\u3001\u95b2\u89a7\u671f\u9650\u304c\u904e\u304e\u3066\u3044\u308b\u3068\u601d\u3046\u304c\u3001\u4ee5\u4e0b\u3067\u898b\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\nhttp://c2-video-test.s3-website-ap-northeast-1.amazonaws.com/index2.html\n\n\u6b21\u56de\u4ee5\u964d\u306eTODO\n\n\u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\u95b2\u89a7\u5236\u9650\u3057\u914d\u4fe1\u3057\u305f\u3044\u3002 -> 20140801 \u4e0a\u8a18\u306e\u300c\u52d5\u753b\u3067\u8a66\u3057\u3066\u307f\u308b\u300d\u9805\u76ee\u306b\u8a18\u8f09\u3002\niOS\u7528HLS\u306e\u6642\u3063\u3066\u3069\u3046\u306a\u308b\u306e\u304b\u8abf\u67fb -> http://qiita.com/terapyon/items/fadecf13ed1d11dcd34d\n\n\u6700\u7d42\u7684\u306b\u306fPlone\u306e\u8a8d\u8a3c\u3092\u4f7f\u3063\u3066\u52d5\u753b\u3092\u914d\u4fe1\u3057\u305f\u3044\u3002\n\n\n\u8457\u8005\u95a2\u9023Blog\u8a18\u4e8b\nAWS CloudFront \u3067\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30b3\u30f3\u30c6\u30f3\u30c4\u914d\u4fe1\n\u3053\u306e\u8a18\u4e8b\u306f\u3001[AWS S3 + CloudFront \u3067\u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0](http://qiita.com/terapyon/items/b77ac981da790662e247 \"AWS S3 + CloudFront \u3067\u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0\")\u306e\u7d9a\u304d\u3067\u3059\u3002\n\n# \u76ee\u7684\n\u671f\u9650\u4ed8\u304dURL\u3067\u306e\u63a5\u7d9a\u3092\u884c\u3046\u3002(\u30ef\u30f3\u30bf\u30a4\u30e0URL)\n\u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\u95b2\u89a7\u5236\u9650\u3057\u914d\u4fe1\u3057\u305f\u3044\u3002(\u4eca\u56de\u306f\u753b\u50cf\u3067\u8a66\u3057\u305f)\n\u6700\u7d42\u7684\u306b\u306fPlone\u306e\u8a8d\u8a3c\u3092\u4f7f\u3063\u3066\u52d5\u753b\u3092\u914d\u4fe1\u3057\u305f\u3044\u3002(\u6b21\u56de\u4ee5\u964d\u306b\u30c1\u30e3\u30ec\u30f3\u30b8)\n\n# S3 \u53ca\u3073 CloudFront \u306e\u8a2d\u5b9a\n\n\u65b0\u898f\u306b\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u308a\u3001\u304a\u8a66\u3057\u306e\u753b\u50cf\u3092\u7f6e\u304f\u3002\u3053\u306e\u753b\u50cf\u3092\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u914d\u4fe1\u3059\u308b\u4e8b\u3092\u8a66\u3059\u3002\n\n## S3\n\n- \u65b0\u898f\u306b\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u308b (c2-video-test-private)\n  * \u30ed\u30b0\u306e\u8a2d\u5b9a\u306f\u884c\u3046\n- Upload\n  * \u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9 \"terada_pythonbr.jpg\"\n\n\n## CloundFront\n\n- CloudFront \u30a2\u30af\u30bb\u30b9ID\u306e\u53d6\u5f97\n  * IAM\u306eWeb\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u3078\u884c\u304f\n  * Details\u5185\u306e\u3001 \"CloudFront Key Pair\" \u3067\u3001\"Create New Key Pair\"\u3092\u53d6\u5f97\n  * \u79d8\u5bc6\u9375\u3068\u516c\u958b\u9375\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n- CloudFront Origin\nCloudFront\u306eWeb\u7ba1\u7406\u753b\u9762\u3067\u3001\"Private Content\"\u304b\u3089\"Origin Access Identity\"\u3078\u884c\u304f\uff08\u3042\u3068\u3067\u4f5c\u308b\u65b9\u6cd5\u3082\u3042\u308b\uff09\n  * Create OAI \u3092\u30af\u30ea\u30c3\u30af\n  * \u30b3\u30e1\u30f3\u30c8\u306b \"OAI for c2-video-test-private\" \u3068\u5165\u308c\u3066\u4f5c\u6210\n- \u65b0\u898f\u306b\"Private Distribution\"\u3092\u4f5c\u308b (Web\u7528\uff09\n- \u8a2d\u5b9a\u3092\u884c\u3046\n  * Restrict Bucket Access: Yes\n  * Origin Access Identity: Use an Existing Identity\n  * Your Identities: \u3092\u524d\u3082\u3063\u3066\u4f5c\u3063\u305f\u3082\u306e\u3092\u9078\u629e\uff08\u307e\u305f\u306f\u3053\u3053\u3067\u65b0\u898f\u306b\u4f5c\u308b\u3053\u3068\u3082\u53ef\u80fd\uff09\n  * Grant Read Permissions on Bucket: Yes\n  * HTTPS Only:Yes\n  * Restrict Viewer Access: Yes\n  * Trusted Signers\n  * Logging: On\n  * \u305d\u306e\u4ed6Logging\u306e\u8a2d\u5b9a\uff08\u30d0\u30b1\u30c3\u30c8\u3068Path)\n- Domain Name: dn045wcqv2fv4.cloudfront.net \u3068\u306a\u3063\u305f\n\n\n## Signed URL\u3092\u4f5c\u308b\n\u4ee5\u4e0b\u306e boto\u306e\u9805\u76ee\u3092\u53c2\u7167\u3057\u30ed\u30fc\u30ab\u30eb\u306ePython\u74b0\u5883\u3067\u4f5c\u3063\u3066\u307f\u308b\u3002\n\n\n### \u5236\u9650\u306a\u3057URL\u306f\u3001\u4ee5\u4e0b\u3068\u306a\u308b\u306f\u305a\u3002\nhttps://dn045wcqv2fv4.cloudfront.net/terada_pythonbr.jpg\n\u5f53\u7136\u3067\u3059\u304c\u3001\u30a8\u30e9\u30fc\u304c\u5e30\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\n```error.xml\n<Error>\n  <Code>MissingKey</Code>\n  <Message>Missing Key-Pair-Id query parameter</Message>\n</Error>\n```\n\n### \u5236\u9650\u4ed8\u304dURL\u3092\u4f5c\u308b\n(boto\u95a2\u4fc2\u306e\u8a73\u7d30\u306f\u4e0b\u90e8\u306b\u8a18\u8f09\uff09\n\n```sample.py\nACCESS_KEY_ID = \"xxxxxxxxxxxxxxxxx\"\nSECRET_ACCESS_KEY = \"xxxxxxxxxxxxxxxxxxxxxxxxxx\"\nYOUR_KEYPAIR_ID = \"xxxxxxxxxxxxxx\"\nYOUR_PRIVATE_KEY_FILE_LOCATION = \"xxxxxxxxxxxxxxxxxxxxx.pem\"\nurl = \"https://dn045wcqv2fv4.cloudfront.net/terada_pythonbr.jpg\"\nexpire_time = int(time.time() +3600)\n\nconn = CloudFrontConnection(ACCESS_KEY_ID, SECRET_ACCESS_KEY)\ndistribution = Distribution(connection=conn, config=None, domain_name='', id='', last_modified_time=None, status='')\n\nsigned_url = distribution.create_signed_url(url=url, keypair_id=YOUR_KEYPAIR_ID, expire_time=expire_time, private_key_file=YOUR_PRIVATE_KEY_FILE_LOCATION)\n```\n\n```\n>>> print signed_url\nhttps://dn045wcqv2fv4.cloudfront.net/terada_pythonbr.jpg?Expires=1406023941&Signature=Ihps3u0~jQ-Twkghg2tqQ-dTMEZoRC-Jb13F4FgNe~1MVAsXQ-yAbXtEKSTsIhN6OLZmuUii6E1xs7nWfe-76SGk26Jmx5edd35EgwQ8mH~2XlY4QOqP1Fgza93q02oQNhJWte1mef4tc8p3fJO6yzebpTEh4MqvQOt9s5bcKq9ad8EGSmfXfUlgL6b87z6TOAXVFQuIotttu6ajlfbCpplIUD-~r-6W~SB6n2dyB8SaoKgJBTkEKJwFiBWx2S5M20-06hsLOeV23UBJcuq6~C-pE1r1ViE8Ia-tM8L6v7zcbtLfOdw9lgFzYoMoh-KiWOAdz7pc-koYMVPXZ-9DuQ__&Key-Pair-Id=APKAJAJZQHPKZI6OK5UQ\n```\n\n### \u30d6\u30e9\u30a6\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u30c6\u30b9\u30c8\n\nhttps://dn045wcqv2fv4.cloudfront.net/terada_pythonbr.jpg?Expires=1406023941&Signature=Ihps3u0~jQ-Twkghg2tqQ-dTMEZoRC-Jb13F4FgNe~1MVAsXQ-yAbXtEKSTsIhN6OLZmuUii6E1xs7nWfe-76SGk26Jmx5edd35EgwQ8mH~2XlY4QOqP1Fgza93q02oQNhJWte1mef4tc8p3fJO6yzebpTEh4MqvQOt9s5bcKq9ad8EGSmfXfUlgL6b87z6TOAXVFQuIotttu6ajlfbCpplIUD-~r-6W~SB6n2dyB8SaoKgJBTkEKJwFiBWx2S5M20-06hsLOeV23UBJcuq6~C-pE1r1ViE8Ia-tM8L6v7zcbtLfOdw9lgFzYoMoh-KiWOAdz7pc-koYMVPXZ-9DuQ__&Key-Pair-Id=APKAJAJZQHPKZI6OK5UQ\n\n2014/07/22 18:14\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u305f\u3002\n2014/07/22 19:15\u306b\u306a\u3063\u305f\u3089\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u306f\u305a\n\n\n# boto\n\n[boto](https://pypi.python.org/pypi/boto \"boto\") \u306f\u3001AWS\u306eAPI\u3092\u64cd\u4f5c\u3059\u308bPython\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\u4ee5\u524d\u306fAmazon\u975e\u516c\u5f0f\u3067\u3057\u305f\u304c\u3001\u3044\u307e\u306f\u958b\u767a\u8005\u304cAmazon\u6240\u5c5e\u306b\u306a\u3063\u305f\u306f\u305a\u306a\u306e\u3067\u3001\u534a\u516c\u5f0f\u306a\u306f\u305a\u3067\u3059\u3002\n\n## \u4e8b\u524d\u6e96\u5099\n\n```\n$ pip install rsa\n$ pip install boto\n```\n\n## Signed URL\u306e\u53d6\u5f97\u65b9\u6cd5 \n\u8aac\u660e\u304c\u4ee5\u4e0b\u306b\u3042\u308a\u307e\u3057\u305f\u3002\nhttp://boto.readthedocs.org/en/latest/ref/cloudfront.html\n\n```\ncreate_signed_url(url, keypair_id, expire_time=None, valid_after_time=None, ip_address=None, policy_url=None, private_key_file=None, private_key_string=None)\n```\n\n- url (str) \n- keypair_id (str) \n- expire_time (int) \n- valid_after_time (int)\n- ip_address (str)\n- policy_url (str)\n- private_key_file (str or file object.) \n- private_key_string (str) \n\n\u4ee5\u4e0b\u306b\u30b5\u30f3\u30d7\u30eb\u304c\u3042\u3063\u305f\n\nhttp://stackoverflow.com/questions/2573919/creating-signed-urls-for-amazon-cloudfront\n\n```\nimport boto\nfrom boto.cloudfront import CloudFrontConnection\nfrom boto.cloudfront.distribution import Distribution\n\nexpire_time = int(time.time() +3000)\nconn = CloudFrontConnection('ACCESS_KEY_ID', 'SECRET_ACCESS_KEY')\n\n##enter the id or domain name to select a distribution\ndistribution = Distribution(connection=conn, config=None, domain_name='', id='', last_modified_time=None, status='')\nsigned_url = distribution.create_signed_url(url='YOUR_URL', keypair_id='YOUR_KEYPAIR_ID_example-APKAIAZVIO4BQ',expire_time=expire_time,private_key_file=\"YOUR_PRIVATE_KEY_FILE_LOCATION\")\n```\n\n\n\n# \u8abf\u67fb\u6642\u306b\u53c2\u7167\u3057\u305fURL\n\n- [AWS\u30de\u30a4\u30b9\u30bf\u30fc\u30b7\u30ea\u30fc\u30ba] Amazon CloudFront / Amazon Elastic Transcoder\u306b\u3088\u308b\u30b3\u30f3\u30c6\u30f3\u30c4\u914d\u4fe1\nhttp://www.slideshare.net/AmazonWebServicesJapan/20131120-aws-medisterregeneratecloudfrontetspublic\nP29\u306b\u8aac\u660e\u304c\u3042\u308b\n\n- Amazon CloudFront \u3067\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u30a2\u30af\u30bb\u30b9 \u305d\u306e1\nhttp://dev.classmethod.jp/etc/amazon-cloudfront-private-contents-access-1/\nAWS\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u82f1\u8a9e\u3067\u30de\u30cb\u30e5\u30a2\u30eb\u304c\u6709\u308a\u3001\u73fe\u72b6\u3067\u306f\u3001Web\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u5168\u3066\u306e\u64cd\u4f5c\u304c\u51fa\u6765\u305d\u3046\u3002\n\n- Code and Examples for Creating a Signature for a Signed URL\nhttp://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/PrivateCFSignatureCodeAndExamples.html\nPython\u306e\u60c5\u5831\u304c\u7121\u3044\u3051\u3069\u53c2\u8003\u306b\u306a\u308a\u305d\u3046\n\n\n# \u52d5\u753b\u3067\u8a66\u3057\u3066\u307f\u308b\nTODO\u306b\u3057\u3066\u3044\u305f\u3001\u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\u4e0a\u8a18\u3092\u5bfe\u5fdc\u3055\u305b\u308b\n\n## \u6e96\u5099\n\n- c2-video-test-private \u30d0\u30b1\u30c3\u30c8\u306b\u3001video\u30d5\u30a9\u30eb\u30c0\u3092\u8ffd\u52a0\n- PyConAPACTW2014terada.mp4 \u3092 video\u30d5\u30a9\u30eb\u30c0\u306b\u8ffd\u52a0\n- CloudFront\u306b\u30b9\u30c8\u30ea\u30fc\u30e0\u5bfe\u5fdc\u306eDistribution\u3092\u8ffd\u52a0\n  * Create\u6642\u306b\u3001RTMP\u3092\u9078\u629e\n  * Origin Domain Name : c2-video-test-private\n  * Restrict Bucket Access: Yes\n  * Origin Access Identity: Use an Existing Identity\n  * Your Identities: \u3092\u524d\u3082\u3063\u3066\u4f5c\u3063\u305f\u3082\u306e\u3092\u9078\u629e  (OAI for c2-video-test-private)\n  * Grant Read Permissions on Bucket: Yes\n  * Restrict Viewer Access: Yes\n  * Trusted Signers: Self\n  * Logging: On\n  * \u305d\u306e\u4ed6Logging\u306e\u8a2d\u5b9a\uff08\u30d0\u30b1\u30c3\u30c8\u3068Path)\n\n\u3053\u3053\u307e\u3067\u306f\u3001\u4eca\u307e\u3067\u306e\u304a\u3055\u3089\u3044\u3067\u7c21\u5358\u306b\u51fa\u6765\u308b\u306f\u305a\u3002\n\n## Signed URL\u3092\u4f5c\u308b\n  \u4e0a\u8a18\u540c\u69d8\u306b\u3001boto\u3092\u4f7f\u3063\u3066\u4f5c\u696d\n  \n- url = \"rtmp://s3lse3ja7xuop9.cloudfront.net/cfx/st/&mp4:video/PyConAPACTW2014terada.mp4\"\n- policy_url = \"video/*\"\n  \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002 **rtmp\u306e\u6642\u306f** \u4e0a\u8a18\u306e\u3088\u3046\u306bPATH\u3060\u3051\u3092\u66f8\u304f(rtpm://\u304b\u3089\u66f8\u304f\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u3044\uff1c\u3053\u308c\u3067\u6570\u65e5\u30cf\u30de\u3063\u305f)\n\n```\n>>> url = \"rtmp://s3lse3ja7xuop9.cloudfront.net/cfx/st/&mp4:video/PyConAPACTW2014terada.mp4\"\n>>> policy_url = \"video/*\"\n>>> signed_url = distribution.create_signed_url(url=url, keypair_id=YOUR_KEYPAIR_ID, expire_time=expire_time, private_key_file=YOUR_PRIVATE_KEY_FILE_LOCATION, policy_url=policy_url)\n>>> print signed_url\nrtmp://s3lse3ja7xuop9.cloudfront.net/cfx/st/&mp4:video/PyConAPACTW2014terada.mp4?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoidmlkZW8vKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTQwNjg5OTIwMX19fV19&Signature=m10lfH4vpepAWVNLCGO9xr~TFs-ZCUklra-I4D6WZvqO3aHhijIbtPQOiK00BPZzTxnu-enkvTuao1aDoP~HSONzF5xIqGqMuP4RYJ-B0~g5iQxvac1VVkb~3lZXMRN3Oz45BsrRWQawyXp1o~0M9sFr~zIVQAbM8aAji1WmTu0~fY0UcfgO74DNevYw4-I4S8S2KLnSimFGeU0bz3b8bXtgxketPz0JhTyM4akK8gD7xWjskrxFOZ4pskCaLvJr3Pyb9pJsqQ9T2izNsPs0Ms5pi94FnOdyejSRWezqrxp00KNttnlc3DGCOcmcCNDNYdIMxmNC6MuAfQKx~a1tig__&Key-Pair-Id=APKAJAJZQHPKZI6OK5UQ\n```\n\n\n## \u52d5\u753b\u8868\u793a\u7528\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\nsrc\u306e\u90e8\u5206\u3092Signed URL\u306b\u3059\u308b\u3002\n\n```html\n<source src=\"rtmp://s3lse3ja7xuop9.cloudfront.net/cfx/st/&mp4:video/PyConAPACTW2014terada.mp4?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoidmlkZW8vKiIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTQwNjg5OTIwMX19fV19&Signature=m10lfH4vpepAWVNLCGO9xr~TFs-ZCUklra-I4D6WZvqO3aHhijIbtPQOiK00BPZzTxnu-enkvTuao1aDoP~HSONzF5xIqGqMuP4RYJ-B0~g5iQxvac1VVkb~3lZXMRN3Oz45BsrRWQawyXp1o~0M9sFr~zIVQAbM8aAji1WmTu0~fY0UcfgO74DNevYw4-I4S8S2KLnSimFGeU0bz3b8bXtgxketPz0JhTyM4akK8gD7xWjskrxFOZ4pskCaLvJr3Pyb9pJsqQ9T2izNsPs0Ms5pi94FnOdyejSRWezqrxp00KNttnlc3DGCOcmcCNDNYdIMxmNC6MuAfQKx~a1tig__&Key-Pair-Id=APKAJAJZQHPKZI6OK5UQ\"\n                 type='rtmp/mp4' />\n```\n\n## \u30c6\u30b9\u30c8\u30da\u30fc\u30b8\n\n\u3059\u3067\u306b\u3001\u95b2\u89a7\u671f\u9650\u304c\u904e\u304e\u3066\u3044\u308b\u3068\u601d\u3046\u304c\u3001\u4ee5\u4e0b\u3067\u898b\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\nhttp://c2-video-test.s3-website-ap-northeast-1.amazonaws.com/index2.html\n\n\n\n# \u6b21\u56de\u4ee5\u964d\u306eTODO\n\n- \u52d5\u753b\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\u95b2\u89a7\u5236\u9650\u3057\u914d\u4fe1\u3057\u305f\u3044\u3002 -> 20140801 \u4e0a\u8a18\u306e\u300c\u52d5\u753b\u3067\u8a66\u3057\u3066\u307f\u308b\u300d\u9805\u76ee\u306b\u8a18\u8f09\u3002\n- iOS\u7528HLS\u306e\u6642\u3063\u3066\u3069\u3046\u306a\u308b\u306e\u304b\u8abf\u67fb -> http://qiita.com/terapyon/items/fadecf13ed1d11dcd34d\n- \u6700\u7d42\u7684\u306b\u306fPlone\u306e\u8a8d\u8a3c\u3092\u4f7f\u3063\u3066\u52d5\u753b\u3092\u914d\u4fe1\u3057\u305f\u3044\u3002\n\n# \u8457\u8005\u95a2\u9023Blog\u8a18\u4e8b\n\n[AWS CloudFront \u3067\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30b3\u30f3\u30c6\u30f3\u30c4\u914d\u4fe1](https://www.cmscom.jp/blog/hz2f2t)\n\n\n", "tags": ["AWS", "CloudFront", "VideoJS", "boto", "Python"]}