{"context": "\nJanus WebRTC Gateway\u3092\u4f7f\u3063\u3066 \u30e9\u30a4\u30d6\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\n\n\n\n\n\u6982\u8981\n\n\u3053\u306e\u8fba\n\n\nJanus WebRTC Gateway\nLightweight, Live Video in a Webpage with GStreamer and WebRTC\nBuilding a Raspberry Pi 2 WebRTC camera\n\n\nUSB\u63a5\u7d9a\u306eWebCam\u3092\u4f7f\u7528(V4L2?\u304c/dev/video0\u3092\u3046\u307e\u304f\u3084\u3063\u3066\u304f\u308c\u308b\uff09\n\nMotion\u3092\u3064\u304b\u304a\u3046\u3068\u691c\u7d22\u3057\u3066\u305f\u3089\u3001\u3044\u3064\u306e\u307e\u306b\u304b\u3053\u3063\u3061\u306b\u306a\u3063\u305f??\n\n\n\u74b0\u5883\n\nRaspberry Pi 3\nUSB\u306eWebCam (Buffalo BSW32K01H - \u767a\u58f2\u65e5\uff1a2009\u5e7411\u6708\u4e2d\u65ec...\u3075\u308b\u3044)\n2016-05-27-raspbian-jessie-lite.img\n\n\n\u624b\u9806\n\n\u3044\u3064\u3082\u306e \n\n\u57fa\u672c\u7684\u306a\u3082\u306e\u3092\u5165\u308c\u308b\nsudo apt-get install -y build-essential bc git byobu\n\n\n\n\nJanus\u30d3\u30eb\u30c9\n\n\nJanus\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u5165\u308c\u308b\nsudo apt-get install -y libmicrohttpd-dev libjansson-dev libnice-dev \\\nlibssl-dev libsrtp-dev libsofia-sip-ua-dev libglib2.0-dev \\\nlibopus-dev libogg-dev pkg-config gengetopt libtool automake\n\n\ncd ; git clone https://github.com/meetecho/janus-gateway.git ; cd janus-gateway\n\nsh autogen.sh ; CFLAGS=-I/usr/include/glib-2.0 ./configure --disable-websockets --disable-data-channels --disable-rabbitmq --disable-docs --prefix=/opt/janus ; make\n\nIf you're not interested in Data Channels, WebSockets and/or RabbitMQ (or you don't care about either of them) you can disable them when configuring:\n\n\u30d3\u30eb\u30c9\u304c\u901a\u308c\u3070\u3044\u3044\u306e\u3067\u7c21\u5358\u306a\u8a2d\u5b9a\u306b\u306b\u3052\u305f\n\nsudo make install; sudo make configs\n\n\ngstreamer\u3068Web\u30b5\u30fc\u30d0(nginx)\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001Janus\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\u3001\u30b5\u30fc\u30d3\u30b9\u30b9\u30bf\u30fc\u30c8\u306a\u3069\nsudo apt-get install gstreamer1.0-omx gstreamer1.0-tools gstreamer1.0-plugins-good gstreamer1.0-plugins-bad\nsudo apt-get install nginx\nsudo cp -r /opt/janus/share/janus/demos/ /var/www/html/\nsudo systemctl enable nginx \nsudo systemctl start nginx \n\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u3001 http://<\u3089\u305a\u3071\u3044\u306eIP>/demos/ \u3092\u307f\u3066\u52d5\u4f5c\u78ba\u8a8d\n\n\nWebRTC\u30e9\u30a4\u30d6\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u30922\u3064\u958b\u304f\u3002(byobu\u4f7f\u3063\u305f\u308a\u3001ssh\u3067\uff12\u3064\u30ed\u30b0\u30a4\u30f3\u3059\u308b)\n\n\n\u3072\u3068\u3064\u306fgstreamer\u8d77\u52d5\n\u3082\u3046\u3072\u3068\u3064\u306f\u3001janus\u8d77\u52d5\n\n\n\n\n\u30c6\u30b9\u30c8\n\n\ncd plugins/streams/;./test_gstreamer_1.sh\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8\u5b9f\u884c: \n\n\u3053\u3093\u306a\u611f\u3058\npi@raspberrypi:~/janus-gateway$ cd plugins/streams/\npi@raspberrypi:~/janus-gateway/plugins/streams$ ./test_gstreamer_1.sh \nSetting pipeline to PAUSED ...\nPipeline is PREROLLING ...\nRedistribute latency...\nRedistribute latency...\nPipeline is PREROLLED ...\nSetting pipeline to PLAYING ...\nNew clock: GstSystemClock\n\n\n\n\n/opt/janus/bin/janus -F /opt/janus/etc/janus/janus\u5b9f\u884c\n\n\u3053\u3093\u306a\u611f\u3058\npi@raspberrypi:~$ /opt/janus/bin/janus -F /opt/janus/etc/janus/\n---------------------------------------------------\nStarting Meetecho Janus (WebRTC Gateway) v0.1.2\n---------------------------------------------------\n...\n...\nJANUS Unix Sockets transport plugin initialized!\nUnix Sockets thread started\nSessions watchdog started\n[gstreamer-sample] New video stream! (ssrc=4120554784)\n\n\ngstreamer\u304c\u8d70\u3063\u3066\u306a\u3044\u3068\u3001\u6700\u5f8c\u306e [gstreamer-sample] New video stream!\u304c\u3067\u306a\u3044\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u3001http://<\u3089\u305a\u3071\u3044\u306eIP\u30a2\u30c9\u30ec\u30b9>/demos/streamingtest.html \u3092\u958b\u3044\u3066\u3001\n\n[Start]\u3092\u304a\u3057\u3066\u3001[Stream list]\u304b\u3089\u3001[Opus/VP8\uff5e]\u3092\u9078\u629e\u3057\u3066\u3001[Watch or Listen]\u3092\u62bc\u3059\u3002\n\n\n\nWebCam\u3092\u4f7f\u3063\u3066\u307f\u308b\n\n\u3046\u3061\u3067\u306f\u3001\u3053\u308c\u3067\u3046\u3054\u304d\u307e\u3057\u305f...\u30d5\u30ec\u30fc\u30e0\u30ec\u30fc\u30c8\u843d\u3068\u3057\u305f\u308a...\u9806\u756a\u5909\u3048\u305f\u308a..\n\ngst-launch-1.0 -v v4l2src device=/dev/video0 ! videoscale ! \\\n    video/x-raw,width=320,height=240,framerate=4/1 ! \\\n    videorate ! videoconvert ! timeoverlay ! \\\n    vp8enc error-resilient=true ! \\\n    rtpvp8pay ! udpsink host=127.0.0.1 port=5004\n\n\n\n\u305d\u306e\u4ed6\n\n\u3080\u3064\u304b\u3057\u3044\u3053\u3068\u3001\u308f\u304b\u308a\u307e\u305b\u3093...\n\u3046\u307e\u304f\u30d6\u30e9\u30a6\u30b6\u306b\u8868\u793a\u3055\u308c\u306a\u3044\u3068\u304d\u306f\u3001AdBlock\u3068\u304b NoScript\u3068\u304b\u3001Ghostery\u3068\u304b\u3001\u90aa\u9b54\u3057\u3066\u306a\u3044\u304b\u898b\u3066\u307f\u3088\u3046.\n\u30e9\u30ba\u30d1\u30a4\u516c\u5f0f\u306eCamera(MIPI?CSI?\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9)\u3060\u3068\u30d5\u30ec\u30fc\u30e0\u30ec\u30fc\u30c8\u304c\u3044\u3044\u30cf\u30ba.\u305d\u306e\u3046\u3061\u8a66\u3057\u3066\u307f\u3088\u3046.\n\n\n- Janus WebRTC Gateway\u3092\u4f7f\u3063\u3066 \u30e9\u30a4\u30d6\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\n![Janus4.png](https://qiita-image-store.s3.amazonaws.com/0/75594/01d4019f-6580-ff27-842a-fa6a27d32e4d.png)\n\n## \u6982\u8981\n- \u3053\u306e\u8fba\n    - [Janus WebRTC Gateway](https://github.com/meetecho/janus-gateway)\n    - [Lightweight, Live Video in a Webpage with GStreamer and WebRTC](https://the.randomengineer.com/2014/05/21/lightweight-live-video-in-a-webpage-with-gstreamer-and-webrtc/)\n    - [Building a Raspberry Pi 2 WebRTC camera](http://www.rs-online.com/designspark/electronics/jpn/blog/building-a-raspberry-pi-2-webrtc-camera)\n- USB\u63a5\u7d9a\u306eWebCam\u3092\u4f7f\u7528(V4L2?\u304c/dev/video0\u3092\u3046\u307e\u304f\u3084\u3063\u3066\u304f\u308c\u308b\uff09\n- `Motion`\u3092\u3064\u304b\u304a\u3046\u3068\u691c\u7d22\u3057\u3066\u305f\u3089\u3001\u3044\u3064\u306e\u307e\u306b\u304b\u3053\u3063\u3061\u306b\u306a\u3063\u305f??\n\n\n## \u74b0\u5883\n- Raspberry Pi 3\n- USB\u306eWebCam (Buffalo BSW32K01H - \u767a\u58f2\u65e5\uff1a2009\u5e7411\u6708\u4e2d\u65ec...\u3075\u308b\u3044)\n- `2016-05-27-raspbian-jessie-lite.img`\n\n\n## \u624b\u9806\n1. \u3044\u3064\u3082\u306e \n2. \u57fa\u672c\u7684\u306a\u3082\u306e\u3092\u5165\u308c\u308b\n\n    ```bash\nsudo apt-get install -y build-essential bc git byobu\n```\n\n### Janus\u30d3\u30eb\u30c9\n1. Janus\u306b\u5fc5\u8981\u306a\u3082\u306e\u3092\u5165\u308c\u308b\n\n    ```bash\nsudo apt-get install -y libmicrohttpd-dev libjansson-dev libnice-dev \\\nlibssl-dev libsrtp-dev libsofia-sip-ua-dev libglib2.0-dev \\\n    libopus-dev libogg-dev pkg-config gengetopt libtool automake\n```\n\n3. `cd ; git clone https://github.com/meetecho/janus-gateway.git ; cd janus-gateway`\n\n4. `sh autogen.sh ; CFLAGS=-I/usr/include/glib-2.0 ./configure --disable-websockets --disable-data-channels --disable-rabbitmq --disable-docs --prefix=/opt/janus ; make`\n\n    > *If you're not interested in Data Channels, WebSockets and/or RabbitMQ (or you don't care about either of them) you can disable them when configuring:*\n\n    \u30d3\u30eb\u30c9\u304c\u901a\u308c\u3070\u3044\u3044\u306e\u3067\u7c21\u5358\u306a\u8a2d\u5b9a\u306b\u306b\u3052\u305f\n\n5. `sudo make install; sudo make configs`\n\n\n### gstreamer\u3068Web\u30b5\u30fc\u30d0(nginx)\n\n1. \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001Janus\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\u3001\u30b5\u30fc\u30d3\u30b9\u30b9\u30bf\u30fc\u30c8\u306a\u3069\n\n    ```bash\nsudo apt-get install gstreamer1.0-omx gstreamer1.0-tools gstreamer1.0-plugins-good gstreamer1.0-plugins-bad\nsudo apt-get install nginx\nsudo cp -r /opt/janus/share/janus/demos/ /var/www/html/\nsudo systemctl enable nginx \nsudo systemctl start nginx \n```\n2. \u30d6\u30e9\u30a6\u30b6\u3067\u3001 `http://<\u3089\u305a\u3071\u3044\u306eIP>/demos/` \u3092\u307f\u3066\u52d5\u4f5c\u78ba\u8a8d<br>![Janus1.png](https://qiita-image-store.s3.amazonaws.com/0/75594/22c4d101-39a7-6d17-bba5-61fa5be09905.png)\n\n\n## WebRTC\u30e9\u30a4\u30d6\u30b9\u30c8\u30ea\u30fc\u30df\u30f3\u30b0\n- \u30b3\u30f3\u30bd\u30fc\u30eb\u30922\u3064\u958b\u304f\u3002(byobu\u4f7f\u3063\u305f\u308a\u3001ssh\u3067\uff12\u3064\u30ed\u30b0\u30a4\u30f3\u3059\u308b)\n    - \u3072\u3068\u3064\u306fgstreamer\u8d77\u52d5\n    - \u3082\u3046\u3072\u3068\u3064\u306f\u3001janus\u8d77\u52d5\n\n### \u30c6\u30b9\u30c8\n\n1. `cd plugins/streams/;./test_gstreamer_1.sh`<br>\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8\u5b9f\u884c: \n\n    ```shell-session:\u3053\u3093\u306a\u611f\u3058\npi@raspberrypi:~/janus-gateway$ cd plugins/streams/\npi@raspberrypi:~/janus-gateway/plugins/streams$ ./test_gstreamer_1.sh \nSetting pipeline to PAUSED ...\nPipeline is PREROLLING ...\nRedistribute latency...\nRedistribute latency...\nPipeline is PREROLLED ...\nSetting pipeline to PLAYING ...\nNew clock: GstSystemClock\n```\n2. `/opt/janus/bin/janus -F /opt/janus/etc/janus/`<br>janus\u5b9f\u884c\n\n    ```shell-session:\u3053\u3093\u306a\u611f\u3058\npi@raspberrypi:~$ /opt/janus/bin/janus -F /opt/janus/etc/janus/\n---------------------------------------------------\n  Starting Meetecho Janus (WebRTC Gateway) v0.1.2\n---------------------------------------------------\n...\n...\nJANUS Unix Sockets transport plugin initialized!\nUnix Sockets thread started\nSessions watchdog started\n[gstreamer-sample] New video stream! (ssrc=4120554784)\n```\ngstreamer\u304c\u8d70\u3063\u3066\u306a\u3044\u3068\u3001\u6700\u5f8c\u306e `[gstreamer-sample] New video stream!`\u304c\u3067\u306a\u3044\n\n3. \u30d6\u30e9\u30a6\u30b6\u3067\u3001`http://<\u3089\u305a\u3071\u3044\u306eIP\u30a2\u30c9\u30ec\u30b9>/demos/streamingtest.html` \u3092\u958b\u3044\u3066\u3001\n![Janus2.png](https://qiita-image-store.s3.amazonaws.com/0/75594/01e7bcfa-5aa9-bad3-257d-a38bf2daa6fa.png)\n4. `[Start]`\u3092\u304a\u3057\u3066\u3001`[Stream list]`\u304b\u3089\u3001`[Opus/VP8\uff5e]`\u3092\u9078\u629e\u3057\u3066\u3001`[Watch or Listen]`\u3092\u62bc\u3059\u3002\n![Janus3.png](https://qiita-image-store.s3.amazonaws.com/0/75594/eacb97bb-ff68-2dec-e344-a04bc31aaa8c.png)\n\n\n### WebCam\u3092\u4f7f\u3063\u3066\u307f\u308b\n- \u3046\u3061\u3067\u306f\u3001\u3053\u308c\u3067\u3046\u3054\u304d\u307e\u3057\u305f...\u30d5\u30ec\u30fc\u30e0\u30ec\u30fc\u30c8\u843d\u3068\u3057\u305f\u308a...\u9806\u756a\u5909\u3048\u305f\u308a..\n\n```\ngst-launch-1.0 -v v4l2src device=/dev/video0 ! videoscale ! \\\n    video/x-raw,width=320,height=240,framerate=4/1 ! \\\n    videorate ! videoconvert ! timeoverlay ! \\\n    vp8enc error-resilient=true ! \\\n    rtpvp8pay ! udpsink host=127.0.0.1 port=5004\n```\n\n![Janus4.png](https://qiita-image-store.s3.amazonaws.com/0/75594/01d4019f-6580-ff27-842a-fa6a27d32e4d.png)\n\n## \u305d\u306e\u4ed6\n- \u3080\u3064\u304b\u3057\u3044\u3053\u3068\u3001\u308f\u304b\u308a\u307e\u305b\u3093...\n- \u3046\u307e\u304f\u30d6\u30e9\u30a6\u30b6\u306b\u8868\u793a\u3055\u308c\u306a\u3044\u3068\u304d\u306f\u3001AdBlock\u3068\u304b NoScript\u3068\u304b\u3001Ghostery\u3068\u304b\u3001\u90aa\u9b54\u3057\u3066\u306a\u3044\u304b\u898b\u3066\u307f\u3088\u3046.\n- \u30e9\u30ba\u30d1\u30a4\u516c\u5f0f\u306eCamera(MIPI?CSI?\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9)\u3060\u3068\u30d5\u30ec\u30fc\u30e0\u30ec\u30fc\u30c8\u304c\u3044\u3044\u30cf\u30ba.\u305d\u306e\u3046\u3061\u8a66\u3057\u3066\u307f\u3088\u3046.\n", "tags": ["RaspberryPi", "raspbian", "WebRTC"]}