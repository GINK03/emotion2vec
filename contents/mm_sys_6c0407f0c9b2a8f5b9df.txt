{"context": " More than 1 year has passed since last update.\u884c\u306e\u8ffd\u52a0\u306fTStringList\u306e\u5024\u3092\u4f7f\u3063\u3066\u307f\u308b\u3002\n\u3082\u3061\u308d\u3093\u5217\u6570\u3068\u540c\u3058\u6570\u3067\u306a\u3044\u3068\u30c0\u30e1\u3002\n\nFireMonkey.h\n///FunctionInsert(\u5bfe\u8c61\u306e\u30b0\u30ea\u30c3\u30c9,\u8ffd\u8a18\u3059\u308b\u884c\u306e\u5024, \u5dee\u3057\u8fbc\u3080\u884c\u756a\u53f7)\nvoid __fastcall FunctionInsert(TStringGrid *var_string_grid,\n    TStringList *var_input_data, int var_row = 0);\n\n\n\nFireMonkey.cpp\nvoid __fastcall TForm1::FunctionInsert(TStringGrid *var_string_grid,\n    TStringList *var_input_data, int var_row) {\n    /// \u884c\u5217\u306e\u6570\u3092\u78ba\u8a8d\u3002\n    if (var_string_grid->ColumnCount != var_input_data->Count) {\n        ShowMessage(L\"\u5217\u6570\u3068\u914d\u5217\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002\");\n        return;\n    }\n    ///\u884c\u3092\u5897\u3084\u3059\n    var_string_grid->RowCount = var_string_grid->RowCount + 1;\n    ///\u884c\u3092\u305a\u3089\u3059\n    for (int i = var_string_grid->RowCount - 1; i > var_row; i--) {\n        for (int i2 = 0; i2 < var_string_grid->ColumnCount; i2++) {\n            var_string_grid->Cells[i2][i] = var_string_grid->Cells[i2][i - 1];\n        }\n    }\n    ///\u633f\u5165\u884c\u306b\u30c7\u30fc\u30bf\u3092\u5165\u308c\u308b\n    for (int i2 = 0; i2 < var_string_grid->ColumnCount; i2++) {\n        var_string_grid->Cells[i2][var_row] = var_input_data->Strings[i2];\n    }\n}\n\n\n\u884c\u524a\u9664\u306f\u3001\u73fe\u5728\u9078\u629e\u4e2d\u306e\u884c\u3092\u524a\u9664\u3059\u308b\u65b9\u6cd5\u3067\u3002\n\nFireMonkey.h\nvoid __fastcall FunctionDelete(TStringGrid *var_string_grid);\n\n\n\nFireMonkey.cpp\nvoid __fastcall TForm1::FunctionDelete(TStringGrid *var_string_grid) {\n    ///\u9078\u629e\u304c\u7121\u3051\u308c\u3070\u7d42\u4e86\n    if (var_string_grid->Selected == -1) {\n        return;\n    }\n    ///\u78ba\u8a8d\n    if (MessageDlg(L\"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f\", TMsgDlgType::mtWarning,\n        TMsgDlgButtons() << TMsgDlgBtn::mbOK << TMsgDlgBtn::mbCancel, 0) != 1) {\n        return;\n    }\n    ///\u9078\u629e\u4e2d\u306e\u884c\u3092\u524a\u9664\u3059\u308b\u611f\u3058\u3002\n    int var_row = var_string_grid->Selected;\n    ///\u524a\u9664\u306e\u524d\u306b\u9078\u629e\u3092\u89e3\u9664\u3059\u308b\u3002\n    var_string_grid->Selected = -1;\n    ///\u524a\u9664\u3068\u3044\u3046\u304b\u3001\u884c\u3092\u62bc\u3057\u3064\u3076\u3059\u611f\u3058\n    for (int i = var_row; i < var_string_grid->RowCount - 1; i++) {\n        for (int i2 = 0; i2 < var_string_grid->ColumnCount; i2++) {\n            var_string_grid->Cells[i2][i] = var_string_grid->Cells[i2][i + 1];\n        }\n    }\n    ///\u884c\u306e\u6570\u3092\u5909\u66f4\n    var_string_grid->RowCount = var_string_grid->RowCount - 1;\n}\n\n\n\u884c\u306e\u8ffd\u52a0\u306fTStringList\u306e\u5024\u3092\u4f7f\u3063\u3066\u307f\u308b\u3002\n\u3082\u3061\u308d\u3093\u5217\u6570\u3068\u540c\u3058\u6570\u3067\u306a\u3044\u3068\u30c0\u30e1\u3002\n\n```cpp:FireMonkey.h\n///FunctionInsert(\u5bfe\u8c61\u306e\u30b0\u30ea\u30c3\u30c9,\u8ffd\u8a18\u3059\u308b\u884c\u306e\u5024, \u5dee\u3057\u8fbc\u3080\u884c\u756a\u53f7)\nvoid __fastcall FunctionInsert(TStringGrid *var_string_grid,\n\tTStringList *var_input_data, int var_row = 0);\n```\n\n```cpp:FireMonkey.cpp\nvoid __fastcall TForm1::FunctionInsert(TStringGrid *var_string_grid,\n\tTStringList *var_input_data, int var_row) {\n\t/// \u884c\u5217\u306e\u6570\u3092\u78ba\u8a8d\u3002\n\tif (var_string_grid->ColumnCount != var_input_data->Count) {\n\t\tShowMessage(L\"\u5217\u6570\u3068\u914d\u5217\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3002\");\n\t\treturn;\n\t}\n\t///\u884c\u3092\u5897\u3084\u3059\n\tvar_string_grid->RowCount = var_string_grid->RowCount + 1;\n\t///\u884c\u3092\u305a\u3089\u3059\n\tfor (int i = var_string_grid->RowCount - 1; i > var_row; i--) {\n\t\tfor (int i2 = 0; i2 < var_string_grid->ColumnCount; i2++) {\n\t\t\tvar_string_grid->Cells[i2][i] = var_string_grid->Cells[i2][i - 1];\n\t\t}\n\t}\n\t///\u633f\u5165\u884c\u306b\u30c7\u30fc\u30bf\u3092\u5165\u308c\u308b\n\tfor (int i2 = 0; i2 < var_string_grid->ColumnCount; i2++) {\n\t\tvar_string_grid->Cells[i2][var_row] = var_input_data->Strings[i2];\n\t}\n}\n```\n\n\u884c\u524a\u9664\u306f\u3001\u73fe\u5728\u9078\u629e\u4e2d\u306e\u884c\u3092\u524a\u9664\u3059\u308b\u65b9\u6cd5\u3067\u3002\n\n```cpp:FireMonkey.h\nvoid __fastcall FunctionDelete(TStringGrid *var_string_grid);\n```\n\n```cpp:FireMonkey.cpp\nvoid __fastcall TForm1::FunctionDelete(TStringGrid *var_string_grid) {\n\t///\u9078\u629e\u304c\u7121\u3051\u308c\u3070\u7d42\u4e86\n\tif (var_string_grid->Selected == -1) {\n\t\treturn;\n\t}\n\t///\u78ba\u8a8d\n\tif (MessageDlg(L\"\u672c\u5f53\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f\", TMsgDlgType::mtWarning,\n\t\tTMsgDlgButtons() << TMsgDlgBtn::mbOK << TMsgDlgBtn::mbCancel, 0) != 1) {\n\t\treturn;\n\t}\n\t///\u9078\u629e\u4e2d\u306e\u884c\u3092\u524a\u9664\u3059\u308b\u611f\u3058\u3002\n\tint var_row = var_string_grid->Selected;\n\t///\u524a\u9664\u306e\u524d\u306b\u9078\u629e\u3092\u89e3\u9664\u3059\u308b\u3002\n\tvar_string_grid->Selected = -1;\n\t///\u524a\u9664\u3068\u3044\u3046\u304b\u3001\u884c\u3092\u62bc\u3057\u3064\u3076\u3059\u611f\u3058\n\tfor (int i = var_row; i < var_string_grid->RowCount - 1; i++) {\n\t\tfor (int i2 = 0; i2 < var_string_grid->ColumnCount; i2++) {\n\t\t\tvar_string_grid->Cells[i2][i] = var_string_grid->Cells[i2][i + 1];\n\t\t}\n\t}\n\t///\u884c\u306e\u6570\u3092\u5909\u66f4\n\tvar_string_grid->RowCount = var_string_grid->RowCount - 1;\n}\n```\n", "tags": ["cppBuilderXE8"]}