{"tags": ["Luigi", "MySQL", "docker"], "context": "\n\n\u3084\u308a\u305f\u3044\u3053\u3068\nluigid\u3092\u5229\u7528\u3057\u3066\u3044\u3066\u3001luigi\u30b5\u30fc\u30d0\u3092\u518d\u8d77\u52d5\u3059\u308b\u3068task_history\u304cUI\u304b\u3089\u6d88\u3048\u308b\u306e\u3067\u3001\u7c21\u6613\u3067\u3082\u826f\u3044\u306e\u3067\u30b9\u30c8\u30a2\u3057\u305f\u3044\u306a\u3001\u3068\u601d\u3063\u305f\u306e\u3067\u5099\u5fd8\u3068\u306a\u308a\u307e\u3059\u3002\n\ndocker-compose.yml\u3092\u7528\u610f\n\ndocker-compose.yml\nmysql:\n  image: mysql\n  ports:\n    - \"3306:3306\"\n  environment:\n    MYSQL_USER: luigi\n    MYSQL_PASSWORD: luigi\n    MYSQL_DATABASE: luigi\n    MYSQL_ALLOW_EMPTY_PASSWORD: True\n\n\n\u8d77\u52d5\u3057\u307e\u3059\u3002\ndocker-compose -f docker-compose.yml up -d\n\n\u63a5\u7d9a\u78ba\u8a8d\u3057\u307e\u3059\u3002\nmysql -uluigi -pluigi -Dluigi -h0.0.0.0\n\n\npip\u3067\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nluigi\u30e2\u30b8\u30e5\u30fc\u30eb\u304cMySQL\u306b\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b\u4ee5\u4e0b\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nsudo pip install sqlalchemy\nsudo pip install mysql-python\n\n\nluigi\u306econfiguration\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\n/etc/luigi/client.cfg\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7de8\u96c6\u3057\u307e\u3059\u3002\n[scheduler]\nrecord_task_history = True\nstate_path = /usr/local/var/luigi-state.pickle\n\n[task_history]\ndb_connection = mysql://luigi:luigi@0.0.0.0/luigi\n\n\nluigi\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3001/etc/luigi/client.cfg\u3092\u53c2\u7167\u3059\u308b\u306e\u3067\u3001\u8d77\u52d5\u6642\u306b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u306f\u6e21\u3057\u3066\u3044\u307e\u305b\u3093\nsudo luigid --background --pidfile /var/run/luigi.pid --logdir /var/log/luigi \n\n\n\u30c6\u30fc\u30d6\u30eb\u78ba\u8a8d\nmysql> show tables;\n+-----------------+\n| Tables_in_luigi |\n+-----------------+\n| task_events     |\n| task_parameters |\n| tasks           |\n+-----------------+\n3 rows in set (0.00 sec)\n\nmysql> describe tasks;\n+---------+--------------+------+-----+---------+----------------+\n| Field   | Type         | Null | Key | Default | Extra          |\n+---------+--------------+------+-----+---------+----------------+\n| id      | int(11)      | NO   | PRI | NULL    | auto_increment |\n| task_id | varchar(200) | YES  | MUL | NULL    |                |\n| name    | varchar(128) | YES  | MUL | NULL    |                |\n| host    | varchar(128) | YES  |     | NULL    |                |\n+---------+--------------+------+-----+---------+----------------+\n4 rows in set (0.00 sec)\n\nmysql> describe task_events;\n+------------+-------------+------+-----+---------+----------------+\n| Field      | Type        | Null | Key | Default | Extra          |\n+------------+-------------+------+-----+---------+----------------+\n| id         | int(11)     | NO   | PRI | NULL    | auto_increment |\n| task_id    | int(11)     | YES  | MUL | NULL    |                |\n| event_name | varchar(20) | YES  |     | NULL    |                |\n| ts         | timestamp   | NO   | MUL | NULL    |                |\n+------------+-------------+------+-----+---------+----------------+\n4 rows in set (0.00 sec)\n\nmysql> describe task_parameters;\n+---------+--------------+------+-----+---------+-------+\n| Field   | Type         | Null | Key | Default | Extra |\n+---------+--------------+------+-----+---------+-------+\n| task_id | int(11)      | NO   | PRI | NULL    |       |\n| name    | varchar(128) | NO   | PRI | NULL    |       |\n| value   | varchar(256) | YES  |     | NULL    |       |\n+---------+--------------+------+-----+---------+-------+\n3 rows in set (0.00 sec)\n\n\nmysql> select * from tasks;\n+----+--------------------------------------------------------------+---------------------+------+\n| id | task_id                                                      | name                | host |\n+----+--------------------------------------------------------------+---------------------+------+\n|  1 | SpecifySlopes_20160613_3ebb9c5320                            | SpecifySlopes       | NULL |\n|  2 | FindPatients_1467684972_20160613_046db15df4                  | FindPatients        | wada |\n|  3 | SpecifySlopes_20160612_0716bf8e6d                            | SpecifySlopes       | wada |\n|  4 | FindPatients_1467685543_20160612_f07fc2a460                  | FindPatients        | wada |\n|  5 | FindPatients_1467685596_20160612_05d0f99355                  | FindPatients        | wada |\n|  6 | FindPatients_1467686072_20160612_d08efce378                  | FindPatients        | wada |\n|  7 | SpecifySlope_1467686072_11_20160612_47755dafe3               | SpecifySlope        | wada |\n|  8 | SpecifySlopeByRange_1467686072_2_11_170b666e03               | SpecifySlopeByRange | wada |\n\n\n\u6240\u611f\n\n\u30bf\u30b9\u30af\u306e\u4f9d\u5b58\u7b49\u306f\u3001\u898b\u308c\u306a\u3044\u306e\u304b\u30fc\u3002\u3002\u3002\u3068\u3002\nelapsed time\u51fa\u306a\u3044\u306e\u304b\u3002\u3002\u3002\u3068\u3002\nGraphDB\u3068\u304b\u3067\u7f6e\u304d\u63db\u3048\u308b\u3001\u307f\u305f\u3044\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u3042\u3063\u305f\u3089\u9762\u767d\u305d\u3046\u3067\u3059\u3002\n\n\u7c21\u7d20\u3059\u304e\u308b\u3088\u3046\u306a\u3001\u304c\u611f\u60f3\u3067\u3059\u3002\n\u4f55\u304b\u3044\u3044\u65b9\u6cd5\u3054\u5b58\u3058\u306e\u65b9\u3044\u307e\u3057\u305f\u3089\u6559\u3048\u3066\u304f\u3060\u3055\u3044\uff3e\uff3e\n## \u3084\u308a\u305f\u3044\u3053\u3068\n\nluigid\u3092\u5229\u7528\u3057\u3066\u3044\u3066\u3001luigi\u30b5\u30fc\u30d0\u3092\u518d\u8d77\u52d5\u3059\u308b\u3068task_history\u304cUI\u304b\u3089\u6d88\u3048\u308b\u306e\u3067\u3001\u7c21\u6613\u3067\u3082\u826f\u3044\u306e\u3067\u30b9\u30c8\u30a2\u3057\u305f\u3044\u306a\u3001\u3068\u601d\u3063\u305f\u306e\u3067\u5099\u5fd8\u3068\u306a\u308a\u307e\u3059\u3002\n\n## docker-compose.yml\u3092\u7528\u610f\n\n```docker-compose.yml\nmysql:\n  image: mysql\n  ports:\n    - \"3306:3306\"\n  environment:\n    MYSQL_USER: luigi\n    MYSQL_PASSWORD: luigi\n    MYSQL_DATABASE: luigi\n    MYSQL_ALLOW_EMPTY_PASSWORD: True\n```\n\n\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash\ndocker-compose -f docker-compose.yml up -d\n```\n\n\u63a5\u7d9a\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\nmysql -uluigi -pluigi -Dluigi -h0.0.0.0\n```\n\n## pip\u3067\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nluigi\u30e2\u30b8\u30e5\u30fc\u30eb\u304cMySQL\u306b\u63a5\u7d9a\u3067\u304d\u308b\u3088\u3046\u306b\u4ee5\u4e0b\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\nsudo pip install sqlalchemy\nsudo pip install mysql-python\n```\n\n## luigi\u306econfiguration\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\n\n`/etc/luigi/client.cfg`\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n```cfg\n[scheduler]\nrecord_task_history = True\nstate_path = /usr/local/var/luigi-state.pickle\n\n[task_history]\ndb_connection = mysql://luigi:luigi@0.0.0.0/luigi\n```\n\n## luigi\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3001`/etc/luigi/client.cfg`\u3092\u53c2\u7167\u3059\u308b\u306e\u3067\u3001\u8d77\u52d5\u6642\u306b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u306f\u6e21\u3057\u3066\u3044\u307e\u305b\u3093\n\n```bash\nsudo luigid --background --pidfile /var/run/luigi.pid --logdir /var/log/luigi \n```\n\n## \u30c6\u30fc\u30d6\u30eb\u78ba\u8a8d\n\n```sql\nmysql> show tables;\n+-----------------+\n| Tables_in_luigi |\n+-----------------+\n| task_events     |\n| task_parameters |\n| tasks           |\n+-----------------+\n3 rows in set (0.00 sec)\n\nmysql> describe tasks;\n+---------+--------------+------+-----+---------+----------------+\n| Field   | Type         | Null | Key | Default | Extra          |\n+---------+--------------+------+-----+---------+----------------+\n| id      | int(11)      | NO   | PRI | NULL    | auto_increment |\n| task_id | varchar(200) | YES  | MUL | NULL    |                |\n| name    | varchar(128) | YES  | MUL | NULL    |                |\n| host    | varchar(128) | YES  |     | NULL    |                |\n+---------+--------------+------+-----+---------+----------------+\n4 rows in set (0.00 sec)\n\nmysql> describe task_events;\n+------------+-------------+------+-----+---------+----------------+\n| Field      | Type        | Null | Key | Default | Extra          |\n+------------+-------------+------+-----+---------+----------------+\n| id         | int(11)     | NO   | PRI | NULL    | auto_increment |\n| task_id    | int(11)     | YES  | MUL | NULL    |                |\n| event_name | varchar(20) | YES  |     | NULL    |                |\n| ts         | timestamp   | NO   | MUL | NULL    |                |\n+------------+-------------+------+-----+---------+----------------+\n4 rows in set (0.00 sec)\n\nmysql> describe task_parameters;\n+---------+--------------+------+-----+---------+-------+\n| Field   | Type         | Null | Key | Default | Extra |\n+---------+--------------+------+-----+---------+-------+\n| task_id | int(11)      | NO   | PRI | NULL    |       |\n| name    | varchar(128) | NO   | PRI | NULL    |       |\n| value   | varchar(256) | YES  |     | NULL    |       |\n+---------+--------------+------+-----+---------+-------+\n3 rows in set (0.00 sec)\n\n\nmysql> select * from tasks;\n+----+--------------------------------------------------------------+---------------------+------+\n| id | task_id                                                      | name                | host |\n+----+--------------------------------------------------------------+---------------------+------+\n|  1 | SpecifySlopes_20160613_3ebb9c5320                            | SpecifySlopes       | NULL |\n|  2 | FindPatients_1467684972_20160613_046db15df4                  | FindPatients        | wada |\n|  3 | SpecifySlopes_20160612_0716bf8e6d                            | SpecifySlopes       | wada |\n|  4 | FindPatients_1467685543_20160612_f07fc2a460                  | FindPatients        | wada |\n|  5 | FindPatients_1467685596_20160612_05d0f99355                  | FindPatients        | wada |\n|  6 | FindPatients_1467686072_20160612_d08efce378                  | FindPatients        | wada |\n|  7 | SpecifySlope_1467686072_11_20160612_47755dafe3               | SpecifySlope        | wada |\n|  8 | SpecifySlopeByRange_1467686072_2_11_170b666e03               | SpecifySlopeByRange | wada |\n```\n\n## \u6240\u611f\n\n* \u30bf\u30b9\u30af\u306e\u4f9d\u5b58\u7b49\u306f\u3001\u898b\u308c\u306a\u3044\u306e\u304b\u30fc\u3002\u3002\u3002\u3068\u3002\n* elapsed time\u51fa\u306a\u3044\u306e\u304b\u3002\u3002\u3002\u3068\u3002\n* GraphDB\u3068\u304b\u3067\u7f6e\u304d\u63db\u3048\u308b\u3001\u307f\u305f\u3044\u306a\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u3042\u3063\u305f\u3089\u9762\u767d\u305d\u3046\u3067\u3059\u3002\n\n\u7c21\u7d20\u3059\u304e\u308b\u3088\u3046\u306a\u3001\u304c\u611f\u60f3\u3067\u3059\u3002\n\u4f55\u304b\u3044\u3044\u65b9\u6cd5\u3054\u5b58\u3058\u306e\u65b9\u3044\u307e\u3057\u305f\u3089\u6559\u3048\u3066\u304f\u3060\u3055\u3044\uff3e\uff3e\n\n"}