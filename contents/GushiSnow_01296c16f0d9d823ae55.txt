{"tags": ["Kaldi", "\u97f3\u58f0\u8a8d\u8b58"], "context": " More than 1 year has passed since last update.\n\n\u524d\u56de\n\uff11\uff1ahttp://qiita.com/GushiSnow/items/cc1440e0a8ea199e78c5\n\uff12\uff1ahttp://qiita.com/GushiSnow/items/a24cad7231de341738ee\n\uff13\uff1ahttp://qiita.com/GushiSnow/items/e099baf9d1c2e72cb3d1\n\uff14\uff1ahttp://qiita.com/GushiSnow/items/d431a5c49dc4206def2d\n\uff15\uff1ahttp://qiita.com/GushiSnow/items/8e1c25b1d2eda8c1f2c3\n\n\u30c7\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\n\u97f3\u58f0\u8a8d\u8b58\u306e\u4f5c\u696d\u3082\u30c7\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u307e\u3067\u7d42\u308f\u308c\u3070\u8a55\u4fa1\u3092\u6e2c\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\n\u305f\u3060\u3057\u7cbe\u5ea6\u3092\u4e0a\u3052\u308b\u306b\u306f\u4ed6\u306e\u4f5c\u696d\u3082\u5f53\u7136\u5fc5\u8981\u3002\n\u8a66\u3057\u306b\u52d5\u304b\u3059\u3060\u3051\u306a\u3089\u3053\u3053\u307e\u3067\u3067\u554f\u984c\u306a\u3044\u3002\n\n\u30c7\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306b\u5fc5\u8981\u306a\u30c7\u30fc\u30bf\u304c\u3042\u308b\u304b\u7cbe\u67fb\nif [ -z \"$model\" ]; then # if --model <mdl> was not specified on the command lin\ne...\n  if [ -z $iter ]; then model=$srcdir/final.mdl; \n  else model=$srcdir/$iter.mdl; fi\nfi\n\nfor f in $sdata/1/feats.scp $sdata/1/cmvn.scp $model $graphdir/HCLG.fst; do\n  [ ! -f $f ] && echo \"decode.sh: no such file $f\" && exit 1;\ndone\n\n\n\n\u7279\u5fb4\u91cf\u306e\u30bf\u30a4\u30d7\u3092\u6307\u5b9a\ncase $feat_type in\n  delta) feats=\"ark,s,cs:apply-cmvn $cmvn_opts --utt2spk=ark:$sdata/JOB/utt2spk scp:$sdata/JOB/cmvn.scp scp:$sdata/JOB/feats.scp ark:- | add-deltas $delta_opts ark:- ark:- |\";;\n  lda) feats=\"ark,s,cs:apply-cmvn $cmvn_opts --utt2spk=ark:$sdata/JOB/utt2spk scp:$sdata/JOB/cmvn.scp scp:$sdata/JOB/feats.scp ark:- | splice-feats $splice_opts ark:- ark:- | transform-feats $srcdir/final.mat ark:- ark:- |\";;\n  *) echo \"Invalid feature type $feat_type\" && exit 1;\nesac\n\n\n\u8a71\u8005\u306b\u5fdc\u3058\u305f\u7279\u5fb4\u91cf\u3092\u62bd\u51fa\u3059\u308bfMLLR\u3092\u9069\u7528\nif [ ! -z \"$transform_dir\" ]; then # add transforms to features...\n  echo \"Using fMLLR transforms from $transform_dir\"\n  [ ! -f $transform_dir/trans.1 ] && echo \"Expected $transform_dir/trans.1 to exist.\"\n  [ ! -s $transform_dir/num_jobs ] && \\\n    echo \"$0: expected $transform_dir/num_jobs to contain the number of jobs.\" && exit 1;\n  nj_orig=$(cat $transform_dir/num_jobs)\n  if [ $nj -ne $nj_orig ]; then\n    # Copy the transforms into an archive with an index.\n    echo \"$0: num-jobs for transforms mismatches, so copying them.\"\n    for n in $(seq $nj_orig); do cat $transform_dir/trans.$n; done | \\\n       copy-feats ark:- ark,scp:$dir/trans.ark,$dir/trans.scp || exit 1;\n    feats=\"$feats transform-feats --utt2spk=ark:$sdata/JOB/utt2spk scp:$dir/trans.scp ark:- ark:- |\"\n  else\n    # number of jobs matches with alignment dir.\n    feats=\"$feats transform-feats --utt2spk=ark:$sdata/JOB/utt2spk ark:$transform_dir/trans.JOB ark:- ark:- |\"\n  fi\n\n\n\nGMM\u304b\u3089\u30e9\u30c6\u30a3\u30b9\u3092\u4f5c\u6210\n    gmm-latgen-faster$thread_string --max-active=$max_active --beam=$beam --lattice-beam=$lattice_beam \\\n    --acoustic-scale=$acwt --allow-partial=true --word-symbol-table=$graphdir/words.txt \\\n    $model $graphdir/HCLG.fst \"$feats\" \"ark:|gzip -c > $dir/lat.JOB.gz\" || exit 1;\n\n\nWER SER\u3092\u8a08\u7b97\nWER:\u5358\u8a9e\u8aa4\u308a\u7387\nSER:\u6587\u7ae0\u8aa4\u308a\u7387\nif ! $skip_scoring ; then\n  [ ! -x local/score.sh ] && \\\n    echo \"Not scoring because local/score.sh does not exist or not executable.\" && exit 1;\n  local/score.sh --cmd \"$cmd\" $scoring_opts $data $graphdir $dir\nfi\n\n\u51fa\u529b\u3055\u308c\u305fWER SER\u306f\u4e0b\u8a18\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b\u3002\nkaldi-trunk/exp/mono/decode/\n\n#\u524d\u56de\n\n\uff11\uff1ahttp://qiita.com/GushiSnow/items/cc1440e0a8ea199e78c5\n\n\uff12\uff1ahttp://qiita.com/GushiSnow/items/a24cad7231de341738ee\n\n\uff13\uff1ahttp://qiita.com/GushiSnow/items/e099baf9d1c2e72cb3d1\n\n\uff14\uff1ahttp://qiita.com/GushiSnow/items/d431a5c49dc4206def2d\n\n\uff15\uff1ahttp://qiita.com/GushiSnow/items/8e1c25b1d2eda8c1f2c3\n\n#\u30c7\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\n\n\u97f3\u58f0\u8a8d\u8b58\u306e\u4f5c\u696d\u3082\u30c7\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u307e\u3067\u7d42\u308f\u308c\u3070\u8a55\u4fa1\u3092\u6e2c\u308b\u3053\u3068\u304c\u51fa\u6765\u308b\u3002\n\u305f\u3060\u3057\u7cbe\u5ea6\u3092\u4e0a\u3052\u308b\u306b\u306f\u4ed6\u306e\u4f5c\u696d\u3082\u5f53\u7136\u5fc5\u8981\u3002\n\n\u8a66\u3057\u306b\u52d5\u304b\u3059\u3060\u3051\u306a\u3089\u3053\u3053\u307e\u3067\u3067\u554f\u984c\u306a\u3044\u3002\n\n##\u30c7\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u306b\u5fc5\u8981\u306a\u30c7\u30fc\u30bf\u304c\u3042\u308b\u304b\u7cbe\u67fb\n\n```shell-session\nif [ -z \"$model\" ]; then # if --model <mdl> was not specified on the command lin\ne...\n  if [ -z $iter ]; then model=$srcdir/final.mdl; \n  else model=$srcdir/$iter.mdl; fi\nfi\n\nfor f in $sdata/1/feats.scp $sdata/1/cmvn.scp $model $graphdir/HCLG.fst; do\n  [ ! -f $f ] && echo \"decode.sh: no such file $f\" && exit 1;\ndone\n\n```\n\n##\u7279\u5fb4\u91cf\u306e\u30bf\u30a4\u30d7\u3092\u6307\u5b9a\n\n```shell-session\ncase $feat_type in\n  delta) feats=\"ark,s,cs:apply-cmvn $cmvn_opts --utt2spk=ark:$sdata/JOB/utt2spk scp:$sdata/JOB/cmvn.scp scp:$sdata/JOB/feats.scp ark:- | add-deltas $delta_opts ark:- ark:- |\";;\n  lda) feats=\"ark,s,cs:apply-cmvn $cmvn_opts --utt2spk=ark:$sdata/JOB/utt2spk scp:$sdata/JOB/cmvn.scp scp:$sdata/JOB/feats.scp ark:- | splice-feats $splice_opts ark:- ark:- | transform-feats $srcdir/final.mat ark:- ark:- |\";;\n  *) echo \"Invalid feature type $feat_type\" && exit 1;\nesac\n```\n\n##\u8a71\u8005\u306b\u5fdc\u3058\u305f\u7279\u5fb4\u91cf\u3092\u62bd\u51fa\u3059\u308bfMLLR\u3092\u9069\u7528\n\n```shell-session\nif [ ! -z \"$transform_dir\" ]; then # add transforms to features...\n  echo \"Using fMLLR transforms from $transform_dir\"\n  [ ! -f $transform_dir/trans.1 ] && echo \"Expected $transform_dir/trans.1 to exist.\"\n  [ ! -s $transform_dir/num_jobs ] && \\\n    echo \"$0: expected $transform_dir/num_jobs to contain the number of jobs.\" && exit 1;\n  nj_orig=$(cat $transform_dir/num_jobs)\n  if [ $nj -ne $nj_orig ]; then\n    # Copy the transforms into an archive with an index.\n    echo \"$0: num-jobs for transforms mismatches, so copying them.\"\n    for n in $(seq $nj_orig); do cat $transform_dir/trans.$n; done | \\\n       copy-feats ark:- ark,scp:$dir/trans.ark,$dir/trans.scp || exit 1;\n    feats=\"$feats transform-feats --utt2spk=ark:$sdata/JOB/utt2spk scp:$dir/trans.scp ark:- ark:- |\"\n  else\n    # number of jobs matches with alignment dir.\n    feats=\"$feats transform-feats --utt2spk=ark:$sdata/JOB/utt2spk ark:$transform_dir/trans.JOB ark:- ark:- |\"\n  fi\n\n```\n##GMM\u304b\u3089\u30e9\u30c6\u30a3\u30b9\u3092\u4f5c\u6210\n\n```shell-session\n    gmm-latgen-faster$thread_string --max-active=$max_active --beam=$beam --lattice-beam=$lattice_beam \\\n    --acoustic-scale=$acwt --allow-partial=true --word-symbol-table=$graphdir/words.txt \\\n    $model $graphdir/HCLG.fst \"$feats\" \"ark:|gzip -c > $dir/lat.JOB.gz\" || exit 1;\n```\n\n##WER SER\u3092\u8a08\u7b97\n\nWER:\u5358\u8a9e\u8aa4\u308a\u7387\nSER:\u6587\u7ae0\u8aa4\u308a\u7387\n\n```shell-session\nif ! $skip_scoring ; then\n  [ ! -x local/score.sh ] && \\\n    echo \"Not scoring because local/score.sh does not exist or not executable.\" && exit 1;\n  local/score.sh --cmd \"$cmd\" $scoring_opts $data $graphdir $dir\nfi\n```\n\n\u51fa\u529b\u3055\u308c\u305fWER SER\u306f\u4e0b\u8a18\u306e\u30d5\u30a9\u30eb\u30c0\u306b\u3042\u308b\u3002\n\n```shell-session\nkaldi-trunk/exp/mono/decode/\n```\n"}