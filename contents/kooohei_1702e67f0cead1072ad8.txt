{"context": "\n\n\u306f\u3058\u3081\u306b\nDNS\u3092\u4ed6\u304b\u3089Route53\u3078\u79fb\u884c\u3059\u308b\u3068\u304d\u3069\u3046\u3057\u3066\u307e\u3059\u304b\uff1f\n\u30be\u30fc\u30f3\u60c5\u5831\u304c\u3042\u308c\u3070GUI\u304b\u3089\u300cImport Zone File\u300d\u3067\u30b3\u30d4\u30da\u3057\u3066\u5b8c\u4e86\u3067\u3059\u304c\u3001\u3044\u3061\u3044\u3061\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u3078\u30ed\u30b0\u30a4\u30f3\u3057\u3066Hosted Zone\u3092\u4f5c\u6210\u3057\u3066\u3002\u3002\u3002ttl\u90e8\u5206\u3092\u907f\u3051\u3066\u30b3\u30d4\u30da\u3057\u306a\u3044\u3068\u884c\u3051\u306a\u304b\u3063\u305f\u308a\u3001\u8907\u6570\u30c9\u30e1\u30a4\u30f3\u3042\u3063\u305f\u3089\u4e00\u3064\u4e00\u3064\u30d5\u30a1\u30a4\u30eb\u958b\u3044\u3066\u30b3\u30d4\u30da\u3057\u306a\u3044\u3068\u3060\u3057\u3002\u3002\u3002\u3063\u3066\u6b63\u76f4\u9762\u5012\u3067\u4ed5\u65b9\u306a\u3044\u3067\u3059\u3002\u3002\u3002\n\u305d\u3093\u306a\u6642\u306bbindtoroute53.pl\u3068dnscurl.pl\u3092\u5229\u7528\u3059\u308b\u3068\u3001BIND\u306e\u30be\u30fc\u30f3\u60c5\u5831\u3092GUI\u304b\u3089\u884c\u308f\u306a\u304f\u3066\u3082\u8a2d\u5b9a\u304c\u53ef\u80fd\u306b\u306a\u308b\u306e\u3067\u3068\u3066\u3082\u4fbf\u5229\u3067\u6642\u77ed\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30c4\u30fc\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u307e\u305a\u306f\u3058\u3081\u306b\u3001bindtoroute53.pl\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n\u6b21\u306bdnscurl.pl\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\n\nBIND \u2192 Route53\nbindtoroute53.pl\u3067BIND\u304b\u3089\u53d6\u5f97\u3057\u305f\u30be\u30fc\u30f3\u60c5\u5831\u3092Route53\u3078\u767b\u9332\u3059\u308b\u305f\u3081\u306eXML\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3057\u307e\u3059\u3002\n\n\u5909\u63db\n$ $ ./bindtoroute53.pl --ignore-origin-ns --ignore-soa --origin hogehoge.jp < hogehoge.jp.zone > hogehoge.jp.xml\n\nIgnoring 'hogehoge.jp.  300 IN  SOA ns1.nameserver.jp. postmaster.nameserver.jp.hogehoge.jp. (\n                    1355980110  ;serial\n                    10800       ;refresh\n                    3600        ;retry\n                    604800      ;expire\n                    300    )    ;minimum', --ignore-soa enabled.\nIgnoring 'hogehoge.jp.  300 IN  NS  ns1.nameserver.jp.', --ignore-origin-ns enabled.\nIgnoring 'hogehoge.jp.  300 IN  NS  ns2.nameserver.jp.', --ignore-origin-ns enabled.\n\n\n\nHosted  Zone\u306e\u4f5c\u6210\n\u767b\u9332\u3059\u308b\u305f\u3081\u306eHosted Zone\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nHostedZone\u4f5c\u6210\n$  aws route53 create-hosted-zone --name hogehoge.jp --caller-reference `date +%Y-%m-%d_%H-%M-%S`\n\n{\n    \"HostedZone\": {\n        \"ResourceRecordSetCount\": 2, \n        \"CallerReference\": \"2016-10-12_23-42-18\", \n        \"Config\": {\n            \"PrivateZone\": false\n        }, \n        \"Id\": \"/hostedzone/Z2B42SHHTH6TX1\", \n        \"Name\": \"hogehoge.jp.\"\n    }, \n    \"DelegationSet\": {\n        \"NameServers\": [\n            \"ns-498.awsdns-62.com\", \n            \"ns-844.awsdns-41.net\", \n            \"ns-1215.awsdns-23.org\", \n            \"ns-1972.awsdns-54.co.uk\"\n        ]\n    }, \n    \"Location\": \"https://route53.amazonaws.com/2013-04-01/hostedzone/Z2B42SHHTH6TX1\", \n    \"ChangeInfo\": {\n        \"Status\": \"PENDING\", \n        \"SubmittedAt\": \"2016-10-12T14:42:20.702Z\", \n        \"Id\": \"/change/C1N36QDVJM9J4O\"\n    }\n}\n\n\n\nRoute53\u3078\u767b\u9332\n\u307e\u305a\u3001\u300c.aws-secrets\u300d\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n$ vi .aws-secrets \n\n\n\u5185\u5bb9\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\n.aws-secrets\n%awsSecretAccessKeys = (\n    \"my-aws-account\" => {\n        id => \"********************\",\n        key => \"****************************************\",\n    },\n);\n\n\n\u4f5c\u6210\u3057\u305f\u3089dnscurl.pl\u30b3\u30de\u30f3\u30c9\u3067Route53\u3078\u60c5\u5831\u3092\u767b\u9332\u3057\u307e\u3059\u3002\n\n\u767b\u9332\n$ ./dnscurl.pl --keyname my-aws-account -- -H \"Content-Type: text/xml; charset=UTF-8\" -X POST --upload-file hogehoge.jp.xml https://route53.amazonaws.com/2010-10-01/hostedzone/Z2B42SHHTH6TX1/rrset | tee out\n\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  3127  100   276  100  2851    247   2552  0:00:01  0:00:01 --:--:--  2554\n<?xml version=\"1.0\"?>\n<ChangeResourceRecordSetsResponse xmlns=\"https://route53.amazonaws.com/doc/2010-10-01/\"><ChangeInfo><Id>/change/C2ZJGJOSDSK9L0</Id><Status>PENDING</Status><SubmittedAt>2016-10-12T16:19:08.986Z</SubmittedAt></ChangeInfo></ChangeResourceRecordSetsResponse>\n\n\n\u4ee5\u4e0a\u3067\u5b8c\u4e86\u3067\u3059\u3002\n\n\u304a\u308f\u308a\u306b\n\u306f\u3058\u3081\u306b\u3082\u8ff0\u3079\u307e\u3057\u305f\u304c\u3001\u30be\u30fc\u30f3\u60c5\u5831\u306fGUI\u304b\u3089\u30b3\u30d4\u30da\u3067\u767b\u9332\u53ef\u80fd\u3067\u3059\u304c\u3001\u3084\u306f\u308a\u3044\u3061\u3044\u3061\u30d5\u30a1\u30a4\u30eb\u958b\u3044\u3066\u30b3\u30d4\u30da\u306f\u3061\u3087\u3063\u3068\u9762\u5012\u304b\u306a\u3068\u3002\u3002\u3002\u6642\u9593\u3082\u304b\u304b\u308a\u307e\u3059\u3057\u3002\n\u306a\u306e\u3067\u3001\u74b0\u5883\u306e\u4e0b\u6e96\u5099(.aws-secrets\u306e\u4f5c\u6210\u3068\u304b)\u304c\u51fa\u6765\u3066\u3057\u307e\u3048\u3070\u3053\u3063\u3061\u306e\u65b9\u304c\u30df\u30b9\u3059\u308b\u30dd\u30a4\u30f3\u30c8\u3082\u6e1b\u3063\u3066\u3001\u6642\u9593\u306e\u77ed\u7e2e\u3082\u3067\u304d\u3066\u3068\u3066\u3082\u697d\u306b\u306a\u308b\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n# \u306f\u3058\u3081\u306b\nDNS\u3092\u4ed6\u304b\u3089**Route53**\u3078\u79fb\u884c\u3059\u308b\u3068\u304d\u3069\u3046\u3057\u3066\u307e\u3059\u304b\uff1f\n\u30be\u30fc\u30f3\u60c5\u5831\u304c\u3042\u308c\u3070GUI\u304b\u3089\u300c**Import Zone File**\u300d\u3067\u30b3\u30d4\u30da\u3057\u3066\u5b8c\u4e86\u3067\u3059\u304c\u3001\u3044\u3061\u3044\u3061\u7ba1\u7406\u30b3\u30f3\u30bd\u30fc\u30eb\u3078\u30ed\u30b0\u30a4\u30f3\u3057\u3066**Hosted Zone**\u3092\u4f5c\u6210\u3057\u3066\u3002\u3002\u3002ttl\u90e8\u5206\u3092\u907f\u3051\u3066\u30b3\u30d4\u30da\u3057\u306a\u3044\u3068\u884c\u3051\u306a\u304b\u3063\u305f\u308a\u3001\u8907\u6570\u30c9\u30e1\u30a4\u30f3\u3042\u3063\u305f\u3089\u4e00\u3064\u4e00\u3064\u30d5\u30a1\u30a4\u30eb\u958b\u3044\u3066\u30b3\u30d4\u30da\u3057\u306a\u3044\u3068\u3060\u3057\u3002\u3002\u3002\u3063\u3066\u6b63\u76f4\u9762\u5012\u3067\u4ed5\u65b9\u306a\u3044\u3067\u3059\u3002\u3002\u3002\n\u305d\u3093\u306a\u6642\u306b[**bindtoroute53.pl**](https://aws.amazon.com/developertools/Amazon-Route-53/4495891528591897)\u3068[**dnscurl.pl**](https://aws.amazon.com/developertools/Amazon-Route-53/9706686376855511)\u3092\u5229\u7528\u3059\u308b\u3068\u3001BIND\u306e\u30be\u30fc\u30f3\u60c5\u5831\u3092GUI\u304b\u3089\u884c\u308f\u306a\u304f\u3066\u3082\u8a2d\u5b9a\u304c\u53ef\u80fd\u306b\u306a\u308b\u306e\u3067\u3068\u3066\u3082\u4fbf\u5229\u3067\u6642\u77ed\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n# \u30c4\u30fc\u30eb\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u307e\u305a\u306f\u3058\u3081\u306b\u3001[**bindtoroute53.pl**](https://aws.amazon.com/developertools/Amazon-Route-53/4495891528591897)\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n![bindtoroute53.png](https://qiita-image-store.s3.amazonaws.com/0/82090/0e98bbeb-0537-4c7c-8e16-32601fc56f0e.png)\n\n\u6b21\u306b[**dnscurl.pl**](https://aws.amazon.com/developertools/Amazon-Route-53/9706686376855511)\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n![dnscurl.png](https://qiita-image-store.s3.amazonaws.com/0/82090/565117de-80f4-193f-9947-07811c9f33b0.png)\n\n\n# BIND \u2192 Route53\n**bindtoroute53.pl**\u3067BIND\u304b\u3089\u53d6\u5f97\u3057\u305f\u30be\u30fc\u30f3\u60c5\u5831\u3092**Route53**\u3078\u767b\u9332\u3059\u308b\u305f\u3081\u306eXML\u30d5\u30a1\u30a4\u30eb\u306b\u5909\u63db\u3057\u307e\u3059\u3002\n\n```bash:\u5909\u63db\n$ $ ./bindtoroute53.pl --ignore-origin-ns --ignore-soa --origin hogehoge.jp < hogehoge.jp.zone > hogehoge.jp.xml\n\nIgnoring 'hogehoge.jp.\t300\tIN\tSOA\tns1.nameserver.jp. postmaster.nameserver.jp.hogehoge.jp. (\n\t\t\t\t\t1355980110\t;serial\n\t\t\t\t\t10800     \t;refresh\n\t\t\t\t\t3600      \t;retry\n\t\t\t\t\t604800    \t;expire\n\t\t\t\t\t300    )\t;minimum', --ignore-soa enabled.\nIgnoring 'hogehoge.jp.\t300\tIN\tNS\tns1.nameserver.jp.', --ignore-origin-ns enabled.\nIgnoring 'hogehoge.jp.\t300\tIN\tNS\tns2.nameserver.jp.', --ignore-origin-ns enabled.\n```\n\n# Hosted  Zone\u306e\u4f5c\u6210\n\u767b\u9332\u3059\u308b\u305f\u3081\u306e**Hosted Zone**\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash:HostedZone\u4f5c\u6210\n$  aws route53 create-hosted-zone --name hogehoge.jp --caller-reference `date +%Y-%m-%d_%H-%M-%S`\n\n{\n    \"HostedZone\": {\n        \"ResourceRecordSetCount\": 2, \n        \"CallerReference\": \"2016-10-12_23-42-18\", \n        \"Config\": {\n            \"PrivateZone\": false\n        }, \n        \"Id\": \"/hostedzone/Z2B42SHHTH6TX1\", \n        \"Name\": \"hogehoge.jp.\"\n    }, \n    \"DelegationSet\": {\n        \"NameServers\": [\n            \"ns-498.awsdns-62.com\", \n            \"ns-844.awsdns-41.net\", \n            \"ns-1215.awsdns-23.org\", \n            \"ns-1972.awsdns-54.co.uk\"\n        ]\n    }, \n    \"Location\": \"https://route53.amazonaws.com/2013-04-01/hostedzone/Z2B42SHHTH6TX1\", \n    \"ChangeInfo\": {\n        \"Status\": \"PENDING\", \n        \"SubmittedAt\": \"2016-10-12T14:42:20.702Z\", \n        \"Id\": \"/change/C1N36QDVJM9J4O\"\n    }\n}\n```\n\n\n# Route53\u3078\u767b\u9332\n\n\u307e\u305a\u3001\u300c*.aws-secrets*\u300d\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash:\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n$ vi .aws-secrets \n```\n\n\u5185\u5bb9\u306f\u4ee5\u4e0b\u3067\u3059\u3002\n\n```bash:.aws-secrets\n%awsSecretAccessKeys = (\n    \"my-aws-account\" => {\n        id => \"********************\",\n        key => \"****************************************\",\n    },\n);\n```\n\n\u4f5c\u6210\u3057\u305f\u3089**dnscurl.pl**\u30b3\u30de\u30f3\u30c9\u3067**Route53**\u3078\u60c5\u5831\u3092\u767b\u9332\u3057\u307e\u3059\u3002\n\n```bash:\u767b\u9332\n$ ./dnscurl.pl --keyname my-aws-account -- -H \"Content-Type: text/xml; charset=UTF-8\" -X POST --upload-file hogehoge.jp.xml https://route53.amazonaws.com/2010-10-01/hostedzone/Z2B42SHHTH6TX1/rrset | tee out\n\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  3127  100   276  100  2851    247   2552  0:00:01  0:00:01 --:--:--  2554\n<?xml version=\"1.0\"?>\n<ChangeResourceRecordSetsResponse xmlns=\"https://route53.amazonaws.com/doc/2010-10-01/\"><ChangeInfo><Id>/change/C2ZJGJOSDSK9L0</Id><Status>PENDING</Status><SubmittedAt>2016-10-12T16:19:08.986Z</SubmittedAt></ChangeInfo></ChangeResourceRecordSetsResponse>\n```\n\n\u4ee5\u4e0a\u3067\u5b8c\u4e86\u3067\u3059\u3002\n\n\n# \u304a\u308f\u308a\u306b\n\u306f\u3058\u3081\u306b\u3082\u8ff0\u3079\u307e\u3057\u305f\u304c\u3001\u30be\u30fc\u30f3\u60c5\u5831\u306fGUI\u304b\u3089\u30b3\u30d4\u30da\u3067\u767b\u9332\u53ef\u80fd\u3067\u3059\u304c\u3001\u3084\u306f\u308a\u3044\u3061\u3044\u3061\u30d5\u30a1\u30a4\u30eb\u958b\u3044\u3066\u30b3\u30d4\u30da\u306f\u3061\u3087\u3063\u3068\u9762\u5012\u304b\u306a\u3068\u3002\u3002\u3002\u6642\u9593\u3082\u304b\u304b\u308a\u307e\u3059\u3057\u3002\n\u306a\u306e\u3067\u3001\u74b0\u5883\u306e\u4e0b\u6e96\u5099(.aws-secrets\u306e\u4f5c\u6210\u3068\u304b)\u304c\u51fa\u6765\u3066\u3057\u307e\u3048\u3070\u3053\u3063\u3061\u306e\u65b9\u304c\u30df\u30b9\u3059\u308b\u30dd\u30a4\u30f3\u30c8\u3082\u6e1b\u3063\u3066\u3001\u6642\u9593\u306e\u77ed\u7e2e\u3082\u3067\u304d\u3066\u3068\u3066\u3082\u697d\u306b\u306a\u308b\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n", "tags": ["AWS", "route53", "bind"]}