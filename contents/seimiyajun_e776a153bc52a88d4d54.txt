{"context": " More than 1 year has passed since last update.\n\n\u5f15\u7528\n\u3068\u3044\u3046\u304b\u3053\u3061\u3089\u3092\u66f8\u304d\u76f4\u3057\u3066\u3001\u81ea\u5206\u306e\u7d4c\u9a13\u3092\u5143\u306b\u30b3\u30e1\u30f3\u30c8\u3092\u8a18\u8f09\u3057\u305f\u3082\u306e\u3067\u3059\u3002\nEC-CUBE\u306a\u65e5\u3005 RUBY ON RAILS\u3067\u8907\u6570\u306e\u30e2\u30c7\u30eb\u304c\u7d61\u3080\u691c\u7d22\u753b\u9762\u306e\u4f5c\u308a\u65b9\n\n\u5b9f\u884c\u74b0\u5883\n\nRuby 2.2.2\nRails 4.2.3\n\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\nviews/parents/index \u306b\u7c21\u5358\u306a\u691c\u7d22\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\n\u8907\u6570\u306e\u691c\u7d22\u6761\u4ef6\u3092and\u3067\u3064\u306a\u3052\u308b\n\u95a2\u9023\u30c6\u30fc\u30d6\u30eb\u306b\u3064\u3044\u3066\u3082\u691c\u7d22\u3092\u884c\u3046\n\n\u6bd4\u8f03\u7684\u7c21\u5358\u306a\u5b9f\u88c5\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u7c21\u5358\u306a\u691c\u7d22\u3092\u3064\u304f\u308b\u3060\u3051\u306a\u3089\u8ca0\u8377\u306fransack\u3068\u6bd4\u3079\u308b\u3068\u5c0f\u3055\u3044\u3068\u601d\u3044\u307e\u3059\uff08\u8ca0\u8377\u306b\u95a2\u3059\u308b\u30c6\u30b9\u30c8\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u304cransack\u81ea\u4f53\u304c\u91cd\u305f\u304f\u306a\u308a\u304c\u3061\u306a\u306e\u3067\uff09\u3002\nor\u3067\u3064\u306a\u3052\u308b\u691c\u7d22\u306f\u3053\u306e\u3084\u308a\u65b9\u3067\u306f\u51fa\u6765\u307e\u305b\u3093\u304c\u3001ransack\u3092\u5229\u7528\u3059\u308b\u3068\u3068\u3066\u3082\u7c21\u5358\u3067\u3059\u3002\n\nmodel\n\u3053\u3093\u306a\u95a2\u4fc2\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\u89aa has_many \u5b50\n\u89aa\u3082\u5b50\u3082\u540d\u524d\uff08:name\uff09\u3092\u6301\u3061\u307e\u3059\u3002\n\n\u89aa\u3092\u3064\u304f\u308b.rb\nrails generate scaffold parent name:string\n\n\n\n\u5b50\u3092\u3064\u304f\u308b.rb\nrails generate scaffold child name:string parent:references\n\n\n\nparent.rb\nclass Parent < ActiveRecord::Base\n  has_many :childs\nend\n\n\n\nchild.rb\nclass Child < ActiveRecord::Base\n  belongs_to :parent\nend\n\n\n\n\u30b3\u30fc\u30c9\n\ncontroller\n\ndef index\u306b\u3064\u3044\u3066\n@search_form.search\u306f\u521d\u671f\u5024\u3060\u3068Member(null)\u306b\u306a\u308b\u306e\u3067\u3001\u521d\u671f\u5024\u306e\u5834\u5408\u306e\u307f\u4e0a\u66f8\u304d\u3057\u307e\u3059\u3002\n\uff08\u3082\u3063\u3068\u3046\u307e\u3044\u66f8\u304d\u65b9\u304c\u3042\u308c\u3070\u6559\u3048\u3066\u304f\u3060\u3055\u3044\uff09\nclass ParentSearchForm\u306b\u3064\u3044\u3066\n\u89aa\u306b\u691c\u7d22\u306b\u4e00\u81f4\u3059\u308b\u8907\u6570\u306e\u5b50\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u89aa\u304c\u8907\u6570\u884c\u8868\u793a\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u5b50\u306e\u691c\u7d22\u306b\u306f.uniq\u3092\u3064\u3051\u3066\u91cd\u8907\u3092\u9632\u304e\u307e\u3059\u3002\n\uff08\u4eba\u540d\u3060\u3068\u306a\u304b\u306a\u304b\u3042\u308a\u3048\u307e\u305b\u3093\u304c\u3001\u4f8b\u3048\u3070\u300c\u5b50\u306e\u5e74\u9f62\u304cxx\u6b73\u300d\u3084\u300c\u5b50\u306e\u6027\u5225\u304cxx\u300d\u691c\u7d22\u3059\u308b\u5834\u5408\u306f\u4e00\u4eba\u306e\u89aa\u304c\u691c\u7d22\u306b\u4e00\u81f4\u3059\u308b\u8907\u6570\u306e\u5b50\u3092\u6301\u3064\u53ef\u80fd\u6027\u306f\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\uff09\n\n\nparents_controller.rb\ndef index\n  @search_form = ParentSearchForm.new(params[:search])\n  @parents = @search_form.search\n  @parents = Parent.all if @parents == Parent\nend\n\nclass ParentSearchForm\n  include ActiveModel::Model\n\n  attr_accessor  :name, :child_name\n\n  def search\n    rel = Parent\n    rel = rel.where( name: name ) if name.present?\n    rel = rel.joins( :child ).where( \"childs.name\" => child_name ).uniq if child_name.present?\n\n    rel\n  end\nend\n\n\n\nview\n\u5148\u307b\u3069ParentSearchForm\u3067\u7528\u610f\u3057\u305fattribute\u3092\u8a2d\u5b9a\u3057\u307e\u3059\n\nviews/parents/index.html.erb\n<%= form_for @search_form, as: 'search', url: :parents, html: {method: :get} do |f| %>\n\n<%= f.label :name, \"\u89aa\u306e\u540d\u524d\" %>\n<%= f.text_field :name %><br>\n<%= f.label :child_name, \"\u5b50\u306e\u540d\u524d\" %>\n<%= f.text_field :child_name %>\n\n<%= f.submit \"\u691c\u7d22\" %>\n<% end %>\n\n\n\u3053\u306e\u691c\u7d22\u30d5\u30a9\u30fc\u30e0\u3067@parents\u306b\u691c\u7d22\u7d50\u679c\u304c\u8fd4\u3063\u3066\u304f\u308b\u306e\u3067<% @parents.each do |parent| %>\u3042\u305f\u308a\u3092\u4f7f\u3063\u3066\u4e00\u89a7\u3092\u8868\u793a\u3057\u3066\u3084\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n#\u5f15\u7528\n\u3068\u3044\u3046\u304b\u3053\u3061\u3089\u3092\u66f8\u304d\u76f4\u3057\u3066\u3001\u81ea\u5206\u306e\u7d4c\u9a13\u3092\u5143\u306b\u30b3\u30e1\u30f3\u30c8\u3092\u8a18\u8f09\u3057\u305f\u3082\u306e\u3067\u3059\u3002\n[EC-CUBE\u306a\u65e5\u3005 RUBY ON RAILS\u3067\u8907\u6570\u306e\u30e2\u30c7\u30eb\u304c\u7d61\u3080\u691c\u7d22\u753b\u9762\u306e\u4f5c\u308a\u65b9](http://www.prime-architect.co.jp/myblog/ruby-on-rails-1566)\n\n#\u5b9f\u884c\u74b0\u5883\n- Ruby 2.2.2\n- Rails 4.2.3\n\n#\u3084\u308a\u305f\u3044\u3053\u3068\n- views/parents/index \u306b\u7c21\u5358\u306a\u691c\u7d22\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\n- \u8907\u6570\u306e\u691c\u7d22\u6761\u4ef6\u3092and\u3067\u3064\u306a\u3052\u308b\n- \u95a2\u9023\u30c6\u30fc\u30d6\u30eb\u306b\u3064\u3044\u3066\u3082\u691c\u7d22\u3092\u884c\u3046\n\n\u6bd4\u8f03\u7684\u7c21\u5358\u306a\u5b9f\u88c5\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u7c21\u5358\u306a\u691c\u7d22\u3092\u3064\u304f\u308b\u3060\u3051\u306a\u3089\u8ca0\u8377\u306fransack\u3068\u6bd4\u3079\u308b\u3068\u5c0f\u3055\u3044\u3068\u601d\u3044\u307e\u3059\uff08\u8ca0\u8377\u306b\u95a2\u3059\u308b\u30c6\u30b9\u30c8\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u304cransack\u81ea\u4f53\u304c\u91cd\u305f\u304f\u306a\u308a\u304c\u3061\u306a\u306e\u3067\uff09\u3002\nor\u3067\u3064\u306a\u3052\u308b\u691c\u7d22\u306f\u3053\u306e\u3084\u308a\u65b9\u3067\u306f\u51fa\u6765\u307e\u305b\u3093\u304c\u3001ransack\u3092\u5229\u7528\u3059\u308b\u3068\u3068\u3066\u3082\u7c21\u5358\u3067\u3059\u3002\n\n##model\n\u3053\u3093\u306a\u95a2\u4fc2\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n\u89aa has_many \u5b50\n\n\b\u89aa\u3082\u5b50\u3082\u540d\u524d\uff08:name\uff09\u3092\u6301\u3061\u307e\u3059\u3002\n\n```\u89aa\u3092\u3064\u304f\u308b.rb\nrails generate scaffold parent name:string\n```\n\n```\u5b50\u3092\u3064\u304f\u308b.rb\nrails generate scaffold child name:string parent:references\n```\n\n\n```parent.rb\nclass Parent < ActiveRecord::Base\n  has_many :childs\nend\n```\n\n```child.rb\nclass Child < ActiveRecord::Base\n  belongs_to :parent\nend\n```\n\n#\u30b3\u30fc\u30c9\n##controller\n\n- `def index`\u306b\u3064\u3044\u3066\n  `@search_form.search`\u306f\u521d\u671f\u5024\u3060\u3068`Member(null)`\u306b\u306a\u308b\u306e\u3067\u3001\u521d\u671f\u5024\u306e\u5834\u5408\u306e\u307f\u4e0a\u66f8\u304d\u3057\u307e\u3059\u3002\n\uff08\u3082\u3063\u3068\u3046\u307e\u3044\u66f8\u304d\u65b9\u304c\u3042\u308c\u3070\u6559\u3048\u3066\u304f\u3060\u3055\u3044\uff09\n\n- `class ParentSearchForm`\u306b\u3064\u3044\u3066\n\u89aa\u306b\u691c\u7d22\u306b\u4e00\u81f4\u3059\u308b\u8907\u6570\u306e\u5b50\u304c\u3042\u3063\u305f\u5834\u5408\u3001\u89aa\u304c\u8907\u6570\u884c\u8868\u793a\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u5b50\u306e\u691c\u7d22\u306b\u306f`.uniq`\u3092\u3064\u3051\u3066\u91cd\u8907\u3092\u9632\u304e\u307e\u3059\u3002\n\uff08\u4eba\u540d\u3060\u3068\u306a\u304b\u306a\u304b\u3042\u308a\u3048\u307e\u305b\u3093\u304c\u3001\u4f8b\u3048\u3070\u300c\u5b50\u306e\u5e74\u9f62\u304cxx\u6b73\u300d\u3084\u300c\u5b50\u306e\u6027\u5225\u304cxx\u300d\u691c\u7d22\u3059\u308b\u5834\u5408\u306f\u4e00\u4eba\u306e\u89aa\u304c\u691c\u7d22\u306b\u4e00\u81f4\u3059\u308b\u8907\u6570\u306e\u5b50\u3092\u6301\u3064\u53ef\u80fd\u6027\u306f\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\uff09\n\n```parents_controller.rb\ndef index\n  @search_form = ParentSearchForm.new(params[:search])\n  @parents = @search_form.search\n  @parents = Parent.all if @parents == Parent\nend\n\nclass ParentSearchForm\n  include ActiveModel::Model\n \n  attr_accessor  :name, :child_name\n \n  def search\n    rel = Parent\n    rel = rel.where( name: name ) if name.present?\n    rel = rel.joins( :child ).where( \"childs.name\" => child_name ).uniq if child_name.present?\n\n    rel\n  end\nend\n```\n\n##view\n\u5148\u307b\u3069`ParentSearchForm`\u3067\u7528\u610f\u3057\u305fattribute\u3092\u8a2d\u5b9a\u3057\u307e\u3059\n\n```views/parents/index.html.erb\n<%= form_for @search_form, as: 'search', url: :parents, html: {method: :get} do |f| %>\n\n<%= f.label :name, \"\u89aa\u306e\u540d\u524d\" %>\n<%= f.text_field :name %><br>\n<%= f.label :child_name, \"\u5b50\u306e\u540d\u524d\" %>\n<%= f.text_field :child_name %>\n\n<%= f.submit \"\u691c\u7d22\" %>\n<% end %>\n```\n\n\u3053\u306e\u691c\u7d22\u30d5\u30a9\u30fc\u30e0\u3067`@parents`\u306b\u691c\u7d22\u7d50\u679c\u304c\u8fd4\u3063\u3066\u304f\u308b\u306e\u3067`<% @parents.each do |parent| %>`\u3042\u305f\u308a\u3092\u4f7f\u3063\u3066\u4e00\u89a7\u3092\u8868\u793a\u3057\u3066\u3084\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n", "tags": ["Rails", "Rails4", "\u691c\u7d22"]}