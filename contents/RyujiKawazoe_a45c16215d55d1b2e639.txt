{"tags": ["EMR", "AWS", "S3", "lambda"], "context": "\u73fe\u5728\u4f5c\u3063\u3066\u3044\u308bEMR\u3067\u306e\u30d0\u30c3\u30c1\u51e6\u7406\u304c\u6708\u6b21\u3067\u884c\u3048\u3070\u826f\u3044\u3082\u306e\u306a\u306e\u3067\u3001\u6bce\u56deEMR\u3092\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u7acb\u3061\u4e0a\u3052\u308b\u306e\u3082\u3081\u3093\u3069\u304f\u3055\u3044\u3067\u3059\u3057\u3001\u5b9a\u671f\u5b9f\u884c\u3055\u305b\u308b\u305f\u3081\u306e\u30b5\u30fc\u30d0\u3092\u7acb\u3066\u308b\u306e\u3082\u3081\u3093\u3069\u304f\u3055\u3044\u3067\u3059\u3057\u3001\u5b9a\u671f\u5b9f\u884c\u3059\u308bLambda\u3067\u9023\u643a\u3057\u3066\u307f\u307e\u3059\u3002\n\nLambda Function\u306e\u4f5c\u6210\n\n\n\u3068\u308a\u3042\u3048\u305aLambda\u3092\u958b\u3044\u3066\n\n\n\nblueprint, trigger\u306f\u7279\u306b\u8a2d\u5b9a\u305b\u305a\u306bSkip\n\n\n\u5b9a\u671f\u5b9f\u884c\u3059\u308bLambda\u306e\u8a2d\u5b9a\u306b\u95a2\u3057\u3066\u306f\u3001\u3053\u3061\u3089\u304b\u3089\uff08http://qiita.com/RyujiKawazoe@github/items/64e8a65ab3e4909678fc\uff09\n\n\nLambda\u306e\u8a2d\u5b9a\u3092\u884c\u3046\n\n\u79c1\u306e\u5834\u5408\u306f\u3001Java\u3067Lambda\u306e\u5b9f\u884c\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3057\u3066\u3044\u307e\u3059\u3002\njar\u3092\u76f4\u63a5\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9orS3\u304b\u3089\u8aad\u307f\u8fbc\u307e\u305b\u308b\uff12\u629e\u306b\u306a\u308b\u306e\u3067\u3059\u304c\u3001\n For files larger than 10 MB, consider uploading via S3.\n\n\u306e\u3088\u3046\u306b\u3001jar\u30b5\u30a4\u30ba\u304c10MB\u3092\u8d85\u3048\u308b\u5834\u5408\u306fS3\u306b\u307e\u305ajar\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3001jar\u306eURL\u3092\"S3 Link URL\"\u306b\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\uff08jar\u306eURL\u3092publish\u306b\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\uff09\n\nHandler\u306b\u306f\u3001Lambda\u304c\u5b9f\u884c\u3059\u308b\u30af\u30e9\u30b9\u3001\u30e1\u30bd\u30c3\u30c9\u540d\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\n\u30d1\u30c3\u30b1\u30fc\u30b8.\u30af\u30e9\u30b9::\u30e1\u30bd\u30c3\u30c9\n\nRole\u306b\u3064\u3044\u3066\u306f\u5f8c\u8ff0\u3057\u307e\u3059\u3002\n\n\u3042\u3068\u306fReview\u3057\u3066OK\u62bc\u305b\u3070\u3001\u4f5c\u6210\u5b8c\u4e86\u3067\u3059\u3002\n\n\nLambda\u306b\u8a2d\u5b9a\u3059\u308bIAM Role\u306b\u3064\u3044\u3066\n\u79c1\u304c\u4f5c\u6210\u3057\u305fLambda\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u3001\u4ee5\u4e0b\u306e\u632f\u308b\u821e\u3044\u3092\u3059\u308b\u3082\u306e\u3067\u3059\u3002\n\nS3\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30c1\u30a7\u30c3\u30af\n1\u3067\u30c1\u30a7\u30c3\u30af\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u306a\u3051\u308c\u3070EMR\u8d77\u52d5\n\n\u306a\u306e\u3067Lambda\u306b\u8a2d\u5b9a\u3059\u308bRole\u306f\n\nS3\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3082\u306e\nEMR\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3082\u306e\nLambda\u304cLog\u3092\u4f5c\u6210\u3067\u304d\u308b\u3082\u306e\uff08\u3053\u308c\u306f\u6700\u521dS3\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u9078\u3093\u3060\u305f\u3081\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u4ed8\u3044\u3066\u307e\u3057\u305f\uff09-> \"S3 read-only permissions\"\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\u305f\u3060\u3001\"S3 read-only permissions\"\u3060\u3051\u9078\u3093\u3067\u3001S3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3046\u3068\uff08\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\uff09\nfinal AmazonS3 s3Client = new AmazonS3Client();\nfinal String s3ObjectPath = \"aaa/bbb/ccc/ddd.txt\"\ns3Client.doesObjectExist(BUCKET_NAME, s3ObjectPath);\n\n\u306e\u3088\u3046\u306b\ns3Client.doesObjectExist\n\n\u30e1\u30bd\u30c3\u30c9\u3092\u8aad\u3093\u3060\u3089\u3001403\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u305f\u306e\u3067\nLambda\u306b\u8a2d\u5b9a\u3059\u308bIAM Role\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\uff08\u6b63\u76f4\u7d5e\u308a\u8fbc\u3093\u3060\u65b9\u304c\u3044\u3044\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067\u3068\u308a\u3042\u3048\u305a\uff09\n\n\u73fe\u5728\u4f5c\u3063\u3066\u3044\u308bEMR\u3067\u306e\u30d0\u30c3\u30c1\u51e6\u7406\u304c\u6708\u6b21\u3067\u884c\u3048\u3070\u826f\u3044\u3082\u306e\u306a\u306e\u3067\u3001\u6bce\u56deEMR\u3092\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u7acb\u3061\u4e0a\u3052\u308b\u306e\u3082\u3081\u3093\u3069\u304f\u3055\u3044\u3067\u3059\u3057\u3001\u5b9a\u671f\u5b9f\u884c\u3055\u305b\u308b\u305f\u3081\u306e\u30b5\u30fc\u30d0\u3092\u7acb\u3066\u308b\u306e\u3082\u3081\u3093\u3069\u304f\u3055\u3044\u3067\u3059\u3057\u3001\u5b9a\u671f\u5b9f\u884c\u3059\u308bLambda\u3067\u9023\u643a\u3057\u3066\u307f\u307e\u3059\u3002\n\n\nLambda Function\u306e\u4f5c\u6210\n---\n\n1. \u3068\u308a\u3042\u3048\u305aLambda\u3092\u958b\u3044\u3066\n\n\t![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.34.35.png](https://qiita-image-store.s3.amazonaws.com/0/18331/6ec4879d-a5ed-6ac6-5f32-1e2578b16d1f.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.34.35.png\")\n\t\n\n2. blueprint, trigger\u306f\u7279\u306b\u8a2d\u5b9a\u305b\u305a\u306bSkip\n\n\t\n\n\n\t![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.39.06.png](https://qiita-image-store.s3.amazonaws.com/0/18331/64ebbed8-9322-8f28-1b61-240b5eefac6a.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.39.06.png\")\n\t\n\t![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.39.13.png](https://qiita-image-store.s3.amazonaws.com/0/18331/3435e872-80ad-ae9d-7953-d4a9160c0b23.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.39.13.png\")\n\n\t\n\t\u5b9a\u671f\u5b9f\u884c\u3059\u308bLambda\u306e\u8a2d\u5b9a\u306b\u95a2\u3057\u3066\u306f\u3001\u3053\u3061\u3089\u304b\u3089\uff08http://qiita.com/RyujiKawazoe@github/items/64e8a65ab3e4909678fc\uff09\n\t\n3. Lambda\u306e\u8a2d\u5b9a\u3092\u884c\u3046\n\n\t![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.40.48.png](https://qiita-image-store.s3.amazonaws.com/0/18331/dc3d2dfa-263a-a2e2-47a6-10cdf36d9c59.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.40.48.png\")\n\n\t\u79c1\u306e\u5834\u5408\u306f\u3001Java\u3067Lambda\u306e\u5b9f\u884c\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3057\u3066\u3044\u307e\u3059\u3002\n\tjar\u3092\u76f4\u63a5\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9orS3\u304b\u3089\u8aad\u307f\u8fbc\u307e\u305b\u308b\uff12\u629e\u306b\u306a\u308b\u306e\u3067\u3059\u304c\u3001\n\t\n\t ~~~\n\t For files larger than 10 MB, consider uploading via S3.\n\t ~~~ \n\t \n\t \u306e\u3088\u3046\u306b\u3001jar\u30b5\u30a4\u30ba\u304c10MB\u3092\u8d85\u3048\u308b\u5834\u5408\u306fS3\u306b\u307e\u305ajar\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3001jar\u306eURL\u3092\"S3 Link URL\"\u306b\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\uff08jar\u306eURL\u3092publish\u306b\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\uff09\n\t \n\t ![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.41.01.png](https://qiita-image-store.s3.amazonaws.com/0/18331/f5e44949-23a5-db62-d162-a1b56d6be0dd.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 11.41.01.png\")\n\n\tHandler\u306b\u306f\u3001Lambda\u304c\u5b9f\u884c\u3059\u308b\u30af\u30e9\u30b9\u3001\u30e1\u30bd\u30c3\u30c9\u540d\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\n\t\n\t~~~\n\t\u30d1\u30c3\u30b1\u30fc\u30b8.\u30af\u30e9\u30b9::\u30e1\u30bd\u30c3\u30c9\n\t~~~\n\t\n\tRole\u306b\u3064\u3044\u3066\u306f\u5f8c\u8ff0\u3057\u307e\u3059\u3002\n\t\n4. \u3042\u3068\u306fReview\u3057\u3066OK\u62bc\u305b\u3070\u3001\u4f5c\u6210\u5b8c\u4e86\u3067\u3059\u3002\n\n\nLambda\u306b\u8a2d\u5b9a\u3059\u308bIAM Role\u306b\u3064\u3044\u3066\n---\n\n\u79c1\u304c\u4f5c\u6210\u3057\u305fLambda\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u3001\u4ee5\u4e0b\u306e\u632f\u308b\u821e\u3044\u3092\u3059\u308b\u3082\u306e\u3067\u3059\u3002\n\n1. S3\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30c1\u30a7\u30c3\u30af\n2. 1\u3067\u30c1\u30a7\u30c3\u30af\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u306a\u3051\u308c\u3070EMR\u8d77\u52d5\n\n\u306a\u306e\u3067Lambda\u306b\u8a2d\u5b9a\u3059\u308bRole\u306f\n\n* S3\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3082\u306e\n* EMR\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3082\u306e\n* Lambda\u304cLog\u3092\u4f5c\u6210\u3067\u304d\u308b\u3082\u306e\uff08\u3053\u308c\u306f\u6700\u521dS3\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u9078\u3093\u3060\u305f\u3081\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u4ed8\u3044\u3066\u307e\u3057\u305f\uff09-> \"S3 read-only permissions\"\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\n\u305f\u3060\u3001\"S3 read-only permissions\"\u3060\u3051\u9078\u3093\u3067\u3001S3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5b58\u5728\u30c1\u30a7\u30c3\u30af\u3092\u884c\u3046\u3068\uff08\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\uff09\n\n~~~\nfinal AmazonS3 s3Client = new AmazonS3Client();\nfinal String s3ObjectPath = \"aaa/bbb/ccc/ddd.txt\"\ns3Client.doesObjectExist(BUCKET_NAME, s3ObjectPath);\n~~~\n\n\u306e\u3088\u3046\u306b\n\n~~~\ns3Client.doesObjectExist\n~~~\n\t\n\u30e1\u30bd\u30c3\u30c9\u3092\u8aad\u3093\u3060\u3089\u3001403\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u305f\u306e\u3067\n\nLambda\u306b\u8a2d\u5b9a\u3059\u308bIAM Role\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 13.14.34.png](https://qiita-image-store.s3.amazonaws.com/0/18331/f06b1080-8e85-923d-90f5-934aee55d982.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-08-19 13.14.34.png\")\n\n\uff08\u6b63\u76f4\u7d5e\u308a\u8fbc\u3093\u3060\u65b9\u304c\u3044\u3044\u3068\u601d\u3046\u306e\u3067\u3059\u304c\u3001\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067\u3068\u308a\u3042\u3048\u305a\uff09\n\t\n"}