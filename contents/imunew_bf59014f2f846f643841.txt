{"tags": ["SQLServer"], "context": "\n\nSQLServer\u3067\u306f\u3001default\u5236\u7d04\u4ed8\u304d\u306e\u5217\u3092\u524a\u9664\u3067\u304d\u306a\u3044\nALTER TABLE (Transact-SQL)\u306b\u4e0b\u8a18\u306e\u8a18\u8ff0\u304c\u3042\u308a\u307e\u3059\u3002\n\u6b21\u306e\u6761\u4ef6\u306b\u8a72\u5f53\u3059\u308b\u5217\u306f\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3002\n\u30fb\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u5217\n\u30fbCHECK\u3001FOREIGN KEY\u3001UNIQUE\u3001\u307e\u305f\u306f PRIMARY KEY \u5236\u7d04\u3067\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u5217\n\u30fbDEFAULT \u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u5b9a\u7fa9\u3055\u308c\u305f\u65e2\u5b9a\u5024\u306b\u95a2\u9023\u4ed8\u3051\u3089\u308c\u3066\u3044\u308b\u5217\u3001\u307e\u305f\u306f\u65e2\u5b9a\u5024\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u3044\u308b\u5217\n\u30fb\u30eb\u30fc\u30eb\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u3044\u308b\u5217\n\n\u3057\u305f\u304c\u3063\u3066\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306bDEFAULT\u5024\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u5217\u306b\u3064\u3044\u3066\u306f\u3001\u5217\u3092\u524a\u9664\u3059\u308b\u524d\u306b\u3001DEFAULT\u5236\u7d04\u3092\u524a\u9664\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nALTER TABLE <table_name> ADD <column_name> <data_type> NOT NULL DEFAULT <default_value>;\n\nDEFAULT\u5236\u7d04\u304c\u3042\u308b\u5217\u3092\u524a\u9664\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3059\u3002\nThe object '<default constraint name>' is dependent on column '<column_name>'. 2) [Code: 4922, SQL State: S1000]  ALTER TABLE DROP COLUMN <column_name> failed because one or more objects access this column.\n\n\nDEFAULT\u5236\u7d04\u3092\u524a\u9664\nDEFAULT\u5236\u7d04\u306e\u540d\u79f0\u306f\u4e0b\u8a18\u306eSQL\u306b\u3066\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nSELECT obj.name FROM sys.objects AS obj\nJOIN sys.columns AS clm ON obj.object_id = clm.default_object_id\nWHERE obj.type = 'D' AND obj.parent_object_id = OBJECT_ID('<table_name>') AND clm.name = '<column_name>'\n\nDEFAULT\u5024\u5236\u7d04\u306f\u4e0b\u8a18\u306eSQL\u3067\u524a\u9664\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nALTER TABLE <table_name> DROP CONSTRAINT <constraint_name>;\n\n\nDEFAULT\u5236\u7d04\u4ed8\u304d\u306e\u5217\u3092\u524a\u9664\u3059\u308bSQL\n\u3068\u306e2\u3064\u306e\u5909\u6570\u306b\u3088\u308a\u3001DEFAULT\u5024\u5236\u7d04\u4ed8\u304d\u306e\u5217\u3092\u524a\u9664\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\nDECLARE @ConstraintName nvarchar(200)\n\nSELECT @ConstraintName = obj.name FROM sys.objects AS obj\nJOIN sys.columns AS clm ON obj.object_id = clm.default_object_id\nWHERE obj.type = 'D' AND obj.parent_object_id = OBJECT_ID('<table_name>') AND clm.name = '<column_name>'\n\nIF @ConstraintName IS NOT NULL\n    EXEC('ALTER TABLE <table_name> DROP CONSTRAINT ' + @ConstraintName)\nGO\n\nALTER TABLE <table_name> DROP COLUMN <column_name>;\nGO\n\n\n## SQLServer\u3067\u306f\u3001default\u5236\u7d04\u4ed8\u304d\u306e\u5217\u3092\u524a\u9664\u3067\u304d\u306a\u3044\n\n[ALTER TABLE (Transact-SQL)](https://msdn.microsoft.com/ja-jp/library/ms190273.aspx)\u306b\u4e0b\u8a18\u306e\u8a18\u8ff0\u304c\u3042\u308a\u307e\u3059\u3002\n\n```\n\u6b21\u306e\u6761\u4ef6\u306b\u8a72\u5f53\u3059\u308b\u5217\u306f\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3002\n\u30fb\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u5217\n\u30fbCHECK\u3001FOREIGN KEY\u3001UNIQUE\u3001\u307e\u305f\u306f PRIMARY KEY \u5236\u7d04\u3067\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u5217\n\u30fbDEFAULT \u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u5b9a\u7fa9\u3055\u308c\u305f\u65e2\u5b9a\u5024\u306b\u95a2\u9023\u4ed8\u3051\u3089\u308c\u3066\u3044\u308b\u5217\u3001\u307e\u305f\u306f\u65e2\u5b9a\u5024\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u3044\u308b\u5217\n\u30fb\u30eb\u30fc\u30eb\u306b\u30d0\u30a4\u30f3\u30c9\u3057\u3066\u3044\u308b\u5217\n```\n\n\u3057\u305f\u304c\u3063\u3066\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306bDEFAULT\u5024\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u5217\u306b\u3064\u3044\u3066\u306f\u3001\u5217\u3092\u524a\u9664\u3059\u308b\u524d\u306b\u3001DEFAULT\u5236\u7d04\u3092\u524a\u9664\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```sql\nALTER TABLE <table_name> ADD <column_name> <data_type> NOT NULL DEFAULT <default_value>;\n```\n\nDEFAULT\u5236\u7d04\u304c\u3042\u308b\u5217\u3092\u524a\u9664\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3059\u3002\n\n```\nThe object '<default constraint name>' is dependent on column '<column_name>'. 2) [Code: 4922, SQL State: S1000]  ALTER TABLE DROP COLUMN <column_name> failed because one or more objects access this column.\n```\n\n## DEFAULT\u5236\u7d04\u3092\u524a\u9664\nDEFAULT\u5236\u7d04\u306e\u540d\u79f0\u306f\u4e0b\u8a18\u306eSQL\u306b\u3066\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```sql\nSELECT obj.name FROM sys.objects AS obj\nJOIN sys.columns AS clm ON obj.object_id = clm.default_object_id\nWHERE obj.type = 'D' AND obj.parent_object_id = OBJECT_ID('<table_name>') AND clm.name = '<column_name>'\n```\n\nDEFAULT\u5024\u5236\u7d04\u306f\u4e0b\u8a18\u306eSQL\u3067\u524a\u9664\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```sql\nALTER TABLE <table_name> DROP CONSTRAINT <constraint_name>;\n```\n\n## DEFAULT\u5236\u7d04\u4ed8\u304d\u306e\u5217\u3092\u524a\u9664\u3059\u308bSQL\n<table_name>\u3068<column_name>\u306e2\u3064\u306e\u5909\u6570\u306b\u3088\u308a\u3001DEFAULT\u5024\u5236\u7d04\u4ed8\u304d\u306e\u5217\u3092\u524a\u9664\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n```\nDECLARE @ConstraintName nvarchar(200)\n\nSELECT @ConstraintName = obj.name FROM sys.objects AS obj\nJOIN sys.columns AS clm ON obj.object_id = clm.default_object_id\nWHERE obj.type = 'D' AND obj.parent_object_id = OBJECT_ID('<table_name>') AND clm.name = '<column_name>'\n\nIF @ConstraintName IS NOT NULL\n\tEXEC('ALTER TABLE <table_name> DROP CONSTRAINT ' + @ConstraintName)\nGO\n\nALTER TABLE <table_name> DROP COLUMN <column_name>;\nGO\n```\n"}