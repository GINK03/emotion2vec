{"context": " More than 1 year has passed since last update.docker - nsinit \u304c\u4e0a\u624b\u304f\u884c\u304b\u306a\u304f\u3066\u56f0\u3063\u3066\u3044\u305f\u3089 nsenter \u304c\u3042\u307e\u308a\u306b\u3082\u3042\u3063\u3055\u308a\u3060\u3063\u305f\u4ef6 - Qiita \u304b\u3089\u4e00\u9031\u9593\u3001\u8a66\u884c\u932f\u8aa4\u3092\u7e70\u308a\u8fd4\u3059\u3053\u3068\u5e7e\u5ea6\u304b\u3002\nRHEL/CentOS 6\u3067 Docker \u306b nsinit/nsenter \u3059\u308b - Qiita \u3067\u3001\u30bf\u30b0\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3092\u6559\u3048\u3066\u3082\u3089\u3044\u3001\u518d\u5ea6\u8a66\u3059\u3082\u30a8\u30e9\u30fc\u304c\u7d9a\u304f\u3002\n\u4eca\u65e5\u3001Docker v1.1.0 \u3092\u51fa\u305f\u3053\u3068\u3092\u30ad\u30c3\u30ab\u30b1\u306b\u6700\u65b0\u306e\u30b3\u30fc\u30c9\u3067\u518d\u5ea6\u8a66\u3059\u3082\u4e0a\u624b\u304f\u884c\u304b\u305a\u3001\u60a9\u3093\u3060\u672b\u3001golang \u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u306b\u3002\n\u3053\u308c\u304c\u306a\u3093\u3068\u5927\u6b63\u89e3\uff01\n\u30b3\u30fc\u30c9\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u554f\u984c\uff0btce-load -wil go \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b go \u306e\u30d0\u30a4\u30ca\u30ea\u306e\u305b\u3044\u3067\u3082\u3042\u308b\u3053\u3068\u304c\u5224\u660e\u3057\u307e\u3057\u305f\u3002\n\u4ee5\u4e0b\u6210\u529f\u3057\u305f\u72b6\u614b\u306e Vagrantfile \u3092\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u5ff5\u306e\u70ba\u3001boot2docker v1.1.0~\u3001libcontainer v1.1.0 \u306b\u56fa\u5b9a\u3057\u307e\u3057\u305f\u3002\n\nVagrantfile\nVAGRANTFILE_API_VERSION = \"2\"\n\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n  config.vm.define \"boot2docker-nsinit\"\n\n  config.vm.box = \"yungsang/boot2docker\"\n\n  config.vm.box_version = \">= 1.1.0, <= 1.1.1\"\n\n  config.vm.provision :shell do |s|\n    s.privileged = false\n    s.inline = <<-EOT\n      tce-load -wil compiletc 2> /dev/null\n\n      echo \"Installing go\"\n      cd /tmp\n      curl -sOL http://golang.org/dl/go1.3.linux-386.tar.gz\n      cd /var/lib/boot2docker\n      sudo tar zxf /tmp/go1.3.linux-386.tar.gz\n      export GOROOT=/var/lib/boot2docker/go\n      export PATH=$PATH:$GOROOT/bin\n\n      echo \"Installing nsinit\"\n      cd $HOME\n      export GOPATH=$HOME/go\n      go get -d github.com/docker/libcontainer/nsinit\n      cd $GOPATH/src/github.com/docker/libcontainer\n      git checkout -B nsinit v1.1.0\n      cd $GOPATH/src/github.com/docker/libcontainer/nsinit\n      go install .\n      sudo cp -f $GOPATH/bin/nsinit /usr/local/bin/nsinit\n\n      echo \"Installing docker-nsinit\"\n      cd $HOME\n      curl -sOL https://raw.githubusercontent.com/YungSang/docker-attach/master/docker-nsinit\n      chmod +x docker-nsinit\n      sudo mv docker-nsinit /usr/local/bin/docker-nsinit\n    EOT\n  end\n\n  config.vm.provision :docker do |d|\n    d.pull_images \"yungsang/busybox\"\n    d.run \"simple-echo\",\n      image: \"yungsang/busybox\",\n      args: \"-p 8080:8080\",\n      cmd: \"nc -p 8080 -l -l -e echo hello world!\"\n  end\n\n  config.vm.network :forwarded_port, guest: 8080, host: 8080\nend\n\n\n$ vagrant up\n$ vagrant ssh\n                        ##        .\n                  ## ## ##       ==\n               ## ## ## ##      ===\n           /\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\\___/ ===\n      ~~~ {~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~\n           \\______ o          __/\n             \\    \\        __/\n              \\____\\______/\n _                 _   ____     _            _\n| |__   ___   ___ | |_|___ \\ __| | ___   ___| | _____ _ __\n| '_ \\ / _ \\ / _ \\| __| __) / _` |/ _ \\ / __| |/ / _ \\ '__|\n| |_) | (_) | (_) | |_ / __/ (_| | (_) | (__|   <  __/ |\n|_.__/ \\___/ \\___/ \\__|_____\\__,_|\\___/ \\___|_|\\_\\___|_|\nboot2docker: 1.1.0\n             nfs+nsenter : e012f67 - Thu Jul  3 22:12:51 UTC 2014\ndocker@boot2docker:~$ docker ps\nCONTAINER ID        IMAGE                     COMMAND                CREATED              STATUS              PORTS                    NAMES\n4e5e685e7b4d        yungsang/busybox:latest   nc -p 8080 -l -l -e    About a minute ago   Up About a minute   0.0.0.0:8080->8080/tcp   simple-echo\ndocker@boot2docker:~$ docker-nsinit 4e5e685e7b4d\ncd /var/lib/docker/execdriver/native/4e5e685e7b4d4d02b1f36048638b6677b2d45af07362aeb123ad4767d45aa464 && nsinit exec -- /bin/sh\n/ #\n\n(\uff9f\u2200\uff9f)\uff77\uff80\uff7a\uff9a!!\n[docker - nsinit \u304c\u4e0a\u624b\u304f\u884c\u304b\u306a\u304f\u3066\u56f0\u3063\u3066\u3044\u305f\u3089 nsenter \u304c\u3042\u307e\u308a\u306b\u3082\u3042\u3063\u3055\u308a\u3060\u3063\u305f\u4ef6 - Qiita](http://qiita.com/yungsang/items/915f7c2ae6ccb239d5ee) \u304b\u3089\u4e00\u9031\u9593\u3001\u8a66\u884c\u932f\u8aa4\u3092\u7e70\u308a\u8fd4\u3059\u3053\u3068\u5e7e\u5ea6\u304b\u3002\n\n[RHEL/CentOS 6\u3067 Docker \u306b nsinit/nsenter \u3059\u308b - Qiita](http://qiita.com/comutt/items/2f873a0e7eaddd3f647e) \u3067\u3001\u30bf\u30b0\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3092\u6559\u3048\u3066\u3082\u3089\u3044\u3001\u518d\u5ea6\u8a66\u3059\u3082\u30a8\u30e9\u30fc\u304c\u7d9a\u304f\u3002\n\n\u4eca\u65e5\u3001Docker v1.1.0 \u3092\u51fa\u305f\u3053\u3068\u3092\u30ad\u30c3\u30ab\u30b1\u306b\u6700\u65b0\u306e\u30b3\u30fc\u30c9\u3067\u518d\u5ea6\u8a66\u3059\u3082\u4e0a\u624b\u304f\u884c\u304b\u305a\u3001\u60a9\u3093\u3060\u672b\u3001golang \u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3053\u3068\u306b\u3002\n\n\u3053\u308c\u304c\u306a\u3093\u3068\u5927\u6b63\u89e3\uff01\n\u30b3\u30fc\u30c9\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u554f\u984c\uff0b`tce-load -wil go` \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b go \u306e\u30d0\u30a4\u30ca\u30ea\u306e\u305b\u3044\u3067\u3082\u3042\u308b\u3053\u3068\u304c\u5224\u660e\u3057\u307e\u3057\u305f\u3002\n\n\u4ee5\u4e0b\u6210\u529f\u3057\u305f\u72b6\u614b\u306e Vagrantfile \u3092\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u5ff5\u306e\u70ba\u3001boot2docker v1.1.0~\u3001libcontainer v1.1.0 \u306b\u56fa\u5b9a\u3057\u307e\u3057\u305f\u3002\n\n```ruby:Vagrantfile\nVAGRANTFILE_API_VERSION = \"2\"\n\nVagrant.configure(VAGRANTFILE_API_VERSION) do |config|\n  config.vm.define \"boot2docker-nsinit\"\n\n  config.vm.box = \"yungsang/boot2docker\"\n\n  config.vm.box_version = \">= 1.1.0, <= 1.1.1\"\n\n  config.vm.provision :shell do |s|\n    s.privileged = false\n    s.inline = <<-EOT\n      tce-load -wil compiletc 2> /dev/null\n\n      echo \"Installing go\"\n      cd /tmp\n      curl -sOL http://golang.org/dl/go1.3.linux-386.tar.gz\n      cd /var/lib/boot2docker\n      sudo tar zxf /tmp/go1.3.linux-386.tar.gz\n      export GOROOT=/var/lib/boot2docker/go\n      export PATH=$PATH:$GOROOT/bin\n\n      echo \"Installing nsinit\"\n      cd $HOME\n      export GOPATH=$HOME/go\n      go get -d github.com/docker/libcontainer/nsinit\n      cd $GOPATH/src/github.com/docker/libcontainer\n      git checkout -B nsinit v1.1.0\n      cd $GOPATH/src/github.com/docker/libcontainer/nsinit\n      go install .\n      sudo cp -f $GOPATH/bin/nsinit /usr/local/bin/nsinit\n\n      echo \"Installing docker-nsinit\"\n      cd $HOME\n      curl -sOL https://raw.githubusercontent.com/YungSang/docker-attach/master/docker-nsinit\n      chmod +x docker-nsinit\n      sudo mv docker-nsinit /usr/local/bin/docker-nsinit\n    EOT\n  end\n\n  config.vm.provision :docker do |d|\n    d.pull_images \"yungsang/busybox\"\n    d.run \"simple-echo\",\n      image: \"yungsang/busybox\",\n      args: \"-p 8080:8080\",\n      cmd: \"nc -p 8080 -l -l -e echo hello world!\"\n  end\n\n  config.vm.network :forwarded_port, guest: 8080, host: 8080\nend\n```\n\n```\n$ vagrant up\n$ vagrant ssh\n                        ##        .\n                  ## ## ##       ==\n               ## ## ## ##      ===\n           /\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\\___/ ===\n      ~~~ {~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~\n           \\______ o          __/\n             \\    \\        __/\n              \\____\\______/\n _                 _   ____     _            _\n| |__   ___   ___ | |_|___ \\ __| | ___   ___| | _____ _ __\n| '_ \\ / _ \\ / _ \\| __| __) / _` |/ _ \\ / __| |/ / _ \\ '__|\n| |_) | (_) | (_) | |_ / __/ (_| | (_) | (__|   <  __/ |\n|_.__/ \\___/ \\___/ \\__|_____\\__,_|\\___/ \\___|_|\\_\\___|_|\nboot2docker: 1.1.0\n             nfs+nsenter : e012f67 - Thu Jul  3 22:12:51 UTC 2014\ndocker@boot2docker:~$ docker ps\nCONTAINER ID        IMAGE                     COMMAND                CREATED              STATUS              PORTS                    NAMES\n4e5e685e7b4d        yungsang/busybox:latest   nc -p 8080 -l -l -e    About a minute ago   Up About a minute   0.0.0.0:8080->8080/tcp   simple-echo\ndocker@boot2docker:~$ docker-nsinit 4e5e685e7b4d\ncd /var/lib/docker/execdriver/native/4e5e685e7b4d4d02b1f36048638b6677b2d45af07362aeb123ad4767d45aa464 && nsinit exec -- /bin/sh\n/ #\n```\n\n(\uff9f\u2200\uff9f)\uff77\uff80\uff7a\uff9a!!\n", "tags": ["docker", "boot2docker", "vagrant"]}