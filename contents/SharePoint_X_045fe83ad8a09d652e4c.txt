{"tags": ["SharePoint", "CSOM", "JavaScript"], "context": "// \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u53d6\u5f97\nvar custCtx = SP.ClientContext.get_current();\n\n// \u30b5\u30a4\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\u6307\u793a\nvar custWeb = custCtx.get_web();\n\n// \u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\uff08\u73fe\u5728\u306e\u30da\u30fc\u30b8\uff09\nJSRequest.EnsureSetup(); // \u30ea\u30af\u30a8\u30b9\u30c8\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u521d\u671f\u5316\nvar custPage = custWeb.getFileByServerRelativeUrl(JSRequest.PathName);\n// \u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\uff08\u6307\u5b9a\u306e\u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\uff09\n//var custPage = custWeb.getFileByServerRelativeUrl('\uff08\u30b5\u30fc\u30d0\u30fc\u76f8\u5bfeURL\uff09');\n\n// \u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\u4e88\u7d04\ncustCtx.load(custPage);\n\n// Web\u30d1\u30fc\u30c4\u30de\u30cd\u30fc\u30b8\u30e3 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\nvar custWpMgr = custPage.getLimitedWebPartManager(SP.WebParts.PersonalizationScope.shared);\n\n// Web\u30d1\u30fc\u30c4\u30de\u30cd\u30fc\u30b8\u30e3 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u4e88\u7d04\ncustCtx.load(custWpMgr);\n\n// Web\u30d1\u30fc\u30c4\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\nvar custWebparts = custWpMgr.get_webParts();\n\n// Web\u30d1\u30fc\u30c4\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u4e88\u7d04\ncustCtx.load(custWebparts, \"Include(WebPart.Title,WebPart.ZoneIndex)\");\n\n// \u30b5\u30fc\u30d0\u30fc\u3078\u306e\u30af\u30a8\u30ea\u30fc\u5b9f\u884c\uff08\u3053\u3053\u307e\u3067\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\u542b\u307e\u308c\u308b\u6307\u793a\u4e88\u7d04\u3092\u9001\u4fe1\uff09\ncustCtx.executeQueryAsync(\n    function(sender, args) { // \u30af\u30a8\u30ea\u30fc\u5b9f\u884c\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\n\n        // \u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb \u306e\u5185\u5bb9\u3092\u53d6\u5f97\n        console.log(custPage);\n\n        // Web\u30d1\u30fc\u30c4\u30de\u30cd\u30fc\u30b8\u30e3 \u306e\u5185\u5bb9\u3092\u53d6\u5f97\n        console.log(custWpMgr);\n\n        // Web\u30d1\u30fc\u30c4\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \u306e\u5185\u5bb9\u3092\u53d6\u5f97\n        console.log(custWebparts);\n\n        var webPartEnumerator = custWebparts.getEnumerator();\n        while (webPartEnumerator.moveNext()) {\n            var oWebPart = webPartEnumerator.get_current().get_webPart();\n\n            console.log(String.format(\n                \"Title:{0}, Zone:{1}\",\n                oWebPart.get_title(), oWebPart.get_zoneIndex()\n            ));\n        }\n\n          // \u5217\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u305f\u3089\u3001\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u304c\u5fc5\u8981\u3067\u3059\uff01\n          //custCtx.executeQueryAsync(\n          //    function(sender, args) { // \u30af\u30a8\u30ea\u30fc\u5b9f\u884c\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\n          //        console.log('\u9001\u4fe1\u30e8\u30b7\uff01');\n          //    },\n          //    function(sender, args) { // \u30af\u30a8\u30ea\u30fc\u5931\u6557\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\n          //        console.log('Request failed. ' + args.get_message() + '\\n' + args.get_stackTrace());\n          //    }\n          //);\n    },\n    function(sender, args) { // \u30af\u30a8\u30ea\u30fc\u5931\u6557\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\n        console.log('Request failed. ' + args.get_message() + '\\n' + args.get_stackTrace());\n    }\n);\n\n```javascript\n// \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u53d6\u5f97\nvar custCtx = SP.ClientContext.get_current();\n \n// \u30b5\u30a4\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\u6307\u793a\nvar custWeb = custCtx.get_web();\n\n// \u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\uff08\u73fe\u5728\u306e\u30da\u30fc\u30b8\uff09\nJSRequest.EnsureSetup(); // \u30ea\u30af\u30a8\u30b9\u30c8\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u521d\u671f\u5316\nvar custPage = custWeb.getFileByServerRelativeUrl(JSRequest.PathName);\n// \u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\uff08\u6307\u5b9a\u306e\u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb\uff09\n//var custPage = custWeb.getFileByServerRelativeUrl('\uff08\u30b5\u30fc\u30d0\u30fc\u76f8\u5bfeURL\uff09');\n\n// \u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u53d6\u5f97\u4e88\u7d04\ncustCtx.load(custPage);\n\n// Web\u30d1\u30fc\u30c4\u30de\u30cd\u30fc\u30b8\u30e3 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\nvar custWpMgr = custPage.getLimitedWebPartManager(SP.WebParts.PersonalizationScope.shared);\n\n// Web\u30d1\u30fc\u30c4\u30de\u30cd\u30fc\u30b8\u30e3 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u4e88\u7d04\ncustCtx.load(custWpMgr);\n\n// Web\u30d1\u30fc\u30c4\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u6307\u793a\nvar custWebparts = custWpMgr.get_webParts();\n\n// Web\u30d1\u30fc\u30c4\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u53d6\u5f97\u4e88\u7d04\ncustCtx.load(custWebparts, \"Include(WebPart.Title,WebPart.ZoneIndex)\");\n\n// \u30b5\u30fc\u30d0\u30fc\u3078\u306e\u30af\u30a8\u30ea\u30fc\u5b9f\u884c\uff08\u3053\u3053\u307e\u3067\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u306b\u542b\u307e\u308c\u308b\u6307\u793a\u4e88\u7d04\u3092\u9001\u4fe1\uff09\ncustCtx.executeQueryAsync(\n    function(sender, args) { // \u30af\u30a8\u30ea\u30fc\u5b9f\u884c\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\n\n        // \u30da\u30fc\u30b8\u30d5\u30a1\u30a4\u30eb \u306e\u5185\u5bb9\u3092\u53d6\u5f97\n        console.log(custPage);\n\n        // Web\u30d1\u30fc\u30c4\u30de\u30cd\u30fc\u30b8\u30e3 \u306e\u5185\u5bb9\u3092\u53d6\u5f97\n        console.log(custWpMgr);\n\n        // Web\u30d1\u30fc\u30c4\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \u306e\u5185\u5bb9\u3092\u53d6\u5f97\n        console.log(custWebparts);\n\n        var webPartEnumerator = custWebparts.getEnumerator();\n        while (webPartEnumerator.moveNext()) {\n            var oWebPart = webPartEnumerator.get_current().get_webPart();\n            \n            console.log(String.format(\n                \"Title:{0}, Zone:{1}\",\n                oWebPart.get_title(), oWebPart.get_zoneIndex()\n            ));\n        }\n\n          // \u5217\u306e\u8a2d\u5b9a\u3092\u66f4\u65b0\u3057\u305f\u3089\u3001\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u304c\u5fc5\u8981\u3067\u3059\uff01\n          //custCtx.executeQueryAsync(\n          //    function(sender, args) { // \u30af\u30a8\u30ea\u30fc\u5b9f\u884c\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\n          //        console.log('\u9001\u4fe1\u30e8\u30b7\uff01');\n          //    },\n          //    function(sender, args) { // \u30af\u30a8\u30ea\u30fc\u5931\u6557\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\n          //        console.log('Request failed. ' + args.get_message() + '\\n' + args.get_stackTrace());\n          //    }\n          //);\n    },\n    function(sender, args) { // \u30af\u30a8\u30ea\u30fc\u5931\u6557\u6642\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\n        console.log('Request failed. ' + args.get_message() + '\\n' + args.get_stackTrace());\n    }\n);\n```\n"}