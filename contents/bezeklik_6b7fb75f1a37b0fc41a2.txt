{"context": "\n\nSamhain\nhttp://www.la-samhna.de/samhain/\n\u30db\u30b9\u30c8\u578b\u4fb5\u5165\u691c\u77e5\u30b7\u30b9\u30c6\u30e0 (HIDS) \u306e Samhain \u306f\u3001\u30d5\u30a1\u30a4\u30eb\u6574\u5408\u6027\u30c1\u30a7\u30c3\u30af\u3001\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u76e3\u8996/\u5206\u6790\u3001\u30dd\u30fc\u30c8\u76e3\u8996\u3001\u4e0d\u6b63\u306a SUID \u5b9f\u884c\u53ef\u80fd\u30d5\u30a1\u30a4\u30eb\u306e\u691c\u51fa\u306a\u3069\u306e\u6a5f\u80fd\u3092\u63d0\u4f9b\u3059\u308b\u3002\ninotify \u306b\u3088\u308b\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u306e\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u77e5\u6a5f\u80fd\u306f\u6642\u4ee3\u306b\u5408\u308f\u306a\u304f\u306a\u3063\u305f\u3068\u3057\u3066 4.0 \u6642\u70b9\u3067\u5ec3\u6b62\u3055\u308c\u305f\u30021\n\u306a\u304a\u3001\u516c\u5f0f\u30b5\u30a4\u30c8\u306f ASAHI \u30cd\u30c3\u30c8\u304b\u3089\u306e\u63a5\u7d9a\u3092 IP \u5236\u9650\u3057\u3066\u3044\u308b\u6a21\u69d8\u3002\n\n\u7531\u6765\nSamhain \u306e\u767a\u97f3\u306f\u30b5\u30fc\u30a6\u30a3\u30f3 \u02c8s\u0251\u02d0w\u026an \u3067\u3001\u53e4\u4ee3\u30b1\u30eb\u30c8\u306711\u67081\u65e5\u306b\u884c\u308f\u308c\u305f\u53ce\u7a6b\u796d\u306e\u3053\u3068\u3002\u30cf\u30ed\u30a6\u30a3\u30f3\u306e\u7531\u6765\u3002\nSamhain \u30b5\u30fc\u30d0\u30fc\u306e\u547c\u79f0 Yule \u306f\u53e4\u4ee3\u30b2\u30eb\u30de\u30f3\u6c11\u65cf\u306e\u51ac\u81f3\u306e\u796d\u308a\u306e\u3053\u3068\u3067\u3001\u30af\u30ea\u30b9\u30de\u30b9\u306e\u7531\u6765\u3002\n\u6700\u65b0\u7248\u306f 2016/10/13 \u30ea\u30ea\u30fc\u30b9\u306e Samhain 4.2.0 \u306b\u306a\u308b\u3002\n\nHIDS\nSmhain \u4ee5\u5916\u306e\u4e3b\u306a HIDS \u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n\nAFICK 3.5.2 (2016/08/05) - SourceForge \u306b rpm \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3042\u308b\u3002\n\nAIDE 0.16 (2016/07/25) - CentOS \u306e Base \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\nOSSEC 2.9_beta5 (2016/04/26) - inotify \u5bfe\u5fdc\u3002Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\nSamhain 4.2.0 (2016/10/13) - inotify \u5bfe\u5fdc\u3002\n\nTripwire 2.4.3.1 (2016/04/24)- EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u4f5c\u6210\n\u6b8b\u5ff5\u306a\u304c\u3089\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u306a\u3044\u306e\u3067\u3084\u3080\u306a\u304f\u30bd\u30fc\u30b9\u304b\u3089\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\u3002\ncurl -O http://www.la-samhna.de/samhain/samhain-current.tar.gz\ntar vzxf samhain-current.tar.gz\ntar vzxf samhain-4.2.0.tar.gz\ncd samhain-4.2.0\nyum install gcc rpm-build libacl-devel libattr-devel pcre-devel zlib-devel\necho \"%_topdir $HOME/rpmbuild\" > ~/.rpmmacros\n./configure -q\\\n  --enable-selinux \\\n  --enable-posix-acl \\\n  --enable-login-watch \\\n  --enable-mounts-check \\\n  --enable-logfile-monitor \\\n  --enable-process-check \\\n  --enable-port-check \\\n  --enable-userfiles \\\n  --enable-suidcheck\nmake rpm\n\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066 ./configure \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u53d6\u6368\u9078\u629e\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum install samhain-4.2.0.rpm\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306f /etc/samhainrc \u306b\u914d\u7f6e\u3055\u308c\u308b\u3002\n\n\u81ea\u52d5\u8d77\u52d5\u306e\u78ba\u8a8d\nchkconfig --list samhain\n\n\n\u51fa\u529b\u4f8b\nsamhain         0:off   1:off   2:on    3:on    4:on    5:on    6:off\n\n\n\n\u521d\u671f\u5316\nsamhain -t init\n\n\n\u8d77\u52d5\nsamhain -t check -D\n\n\n\u30d7\u30ed\u30bb\u30b9\u306e\u78ba\u8a8d\nps aux | grep -v grep | grep \"USER\\|samhain\"\n\n\n\u51fa\u529b\u4f8b\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot      6742 50.5  0.0 169244   188 ?        SL   00:49   0:27 samhain -t check -D\nroot      6743  0.1  0.0 167444     0 ?        S    00:49   0:02 samhain -t check -D\n\n\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n\nPHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin\nDoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1\nLinux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV\nLinux Malware Detect\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)\n\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Samhain\n\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Tripwire\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS\n\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto\nLinux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis\n\n\n\n\n\nhttp://www.la-samhna.de/samhain/manual/kerneldef.html\u00a0\u21a9\n\n\n\n# Samhain\nhttp://www.la-samhna.de/samhain/\n\u30db\u30b9\u30c8\u578b\u4fb5\u5165\u691c\u77e5\u30b7\u30b9\u30c6\u30e0 (HIDS) \u306e **Samhain** \u306f\u3001\u30d5\u30a1\u30a4\u30eb\u6574\u5408\u6027\u30c1\u30a7\u30c3\u30af\u3001\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u76e3\u8996/\u5206\u6790\u3001\u30dd\u30fc\u30c8\u76e3\u8996\u3001\u4e0d\u6b63\u306a SUID \u5b9f\u884c\u53ef\u80fd\u30d5\u30a1\u30a4\u30eb\u306e\u691c\u51fa\u306a\u3069\u306e\u6a5f\u80fd\u3092\u63d0\u4f9b\u3059\u308b\u3002\ninotify \u306b\u3088\u308b\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u306e\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002\n[\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u77e5](http://qiita.com/bezeklik/items/27a188c951441b25ac0a)\u6a5f\u80fd\u306f\u6642\u4ee3\u306b\u5408\u308f\u306a\u304f\u306a\u3063\u305f\u3068\u3057\u3066 4.0 \u6642\u70b9\u3067\u5ec3\u6b62\u3055\u308c\u305f\u3002[^rootkit]\n\n\u306a\u304a\u3001\u516c\u5f0f\u30b5\u30a4\u30c8\u306f ASAHI \u30cd\u30c3\u30c8\u304b\u3089\u306e\u63a5\u7d9a\u3092 IP \u5236\u9650\u3057\u3066\u3044\u308b\u6a21\u69d8\u3002\n\n[^rootkit]: http://www.la-samhna.de/samhain/manual/kerneldef.html\n\n## \u7531\u6765\nSamhain \u306e\u767a\u97f3\u306f**\u30b5\u30fc\u30a6\u30a3\u30f3** `\u02c8s\u0251\u02d0w\u026an` \u3067\u3001\u53e4\u4ee3\u30b1\u30eb\u30c8\u306711\u67081\u65e5\u306b\u884c\u308f\u308c\u305f\u53ce\u7a6b\u796d\u306e\u3053\u3068\u3002\u30cf\u30ed\u30a6\u30a3\u30f3\u306e\u7531\u6765\u3002\nSamhain \u30b5\u30fc\u30d0\u30fc\u306e\u547c\u79f0 **Yule** \u306f\u53e4\u4ee3\u30b2\u30eb\u30de\u30f3\u6c11\u65cf\u306e\u51ac\u81f3\u306e\u796d\u308a\u306e\u3053\u3068\u3067\u3001\u30af\u30ea\u30b9\u30de\u30b9\u306e\u7531\u6765\u3002\n\n\u6700\u65b0\u7248\u306f 2016/10/13 \u30ea\u30ea\u30fc\u30b9\u306e **Samhain 4.2.0** \u306b\u306a\u308b\u3002\n\n# HIDS\nSmhain \u4ee5\u5916\u306e\u4e3b\u306a HIDS \u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3002\n\n* [AFICK](http://qiita.com/bezeklik/items/298dafd2aeb053b4ca88) 3.5.2 (2016/08/05) - SourceForge \u306b rpm \u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3042\u308b\u3002\n* [AIDE](http://qiita.com/bezeklik/items/d144d77a3e54cd35c06b) 0.16 (2016/07/25) - CentOS \u306e Base \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n* [OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38) 2.9_beta5 (2016/04/26) - inotify \u5bfe\u5fdc\u3002Atomic \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n* [Samhain](http://qiita.com/bezeklik/items/6b7fb75f1a37b0fc41a2) 4.2.0 (2016/10/13) - inotify \u5bfe\u5fdc\u3002\n* [Tripwire](http://qiita.com/bezeklik/items/2dfb871b9397211c735b) 2.4.3.1 (2016/04/24)- EPEL \u30ea\u30dd\u30b8\u30c8\u30ea\u30fc\u306b\u3042\u308b\u3002\n\n# \u30d1\u30c3\u30b1\u30fc\u30b8\u4f5c\u6210\n\u6b8b\u5ff5\u306a\u304c\u3089\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u306a\u3044\u306e\u3067\u3084\u3080\u306a\u304f\u30bd\u30fc\u30b9\u304b\u3089\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\u3002\n\n```bash\ncurl -O http://www.la-samhna.de/samhain/samhain-current.tar.gz\ntar vzxf samhain-current.tar.gz\ntar vzxf samhain-4.2.0.tar.gz\ncd samhain-4.2.0\nyum install gcc rpm-build libacl-devel libattr-devel pcre-devel zlib-devel\necho \"%_topdir $HOME/rpmbuild\" > ~/.rpmmacros\n./configure -q\\\n  --enable-selinux \\\n  --enable-posix-acl \\\n  --enable-login-watch \\\n  --enable-mounts-check \\\n  --enable-logfile-monitor \\\n  --enable-process-check \\\n  --enable-port-check \\\n  --enable-userfiles \\\n  --enable-suidcheck\nmake rpm\n```\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066 ./configure \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u53d6\u6368\u9078\u629e\u3002\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```bash\nyum install samhain-4.2.0.rpm\n```\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306f /etc/samhainrc \u306b\u914d\u7f6e\u3055\u308c\u308b\u3002\n\n## \u81ea\u52d5\u8d77\u52d5\u306e\u78ba\u8a8d\n```bash\nchkconfig --list samhain\n```\n```text:\u51fa\u529b\u4f8b\nsamhain         0:off   1:off   2:on    3:on    4:on    5:on    6:off\n```\n\n# \u521d\u671f\u5316\n```bash\nsamhain -t init\n```\n\n# \u8d77\u52d5\n```bash\nsamhain -t check -D\n```\n## \u30d7\u30ed\u30bb\u30b9\u306e\u78ba\u8a8d\n```bash\nps aux | grep -v grep | grep \"USER\\|samhain\"\n```\n```text:\u51fa\u529b\u4f8b\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot      6742 50.5  0.0 169244   188 ?        SL   00:49   0:27 samhain -t check -D\nroot      6743  0.1  0.0 167444     0 ?        S    00:49   0:02 samhain -t check -D\n```\n\n# \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u95a2\u9023\u8a18\u4e8b\n* [PHP\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u5f37\u5316\u30e2\u30b8\u30e5\u30fc\u30eb Suhosin](http://qiita.com/bezeklik/items/5e8b1f76465e39dc6cd0)\n* [DoS\u653b\u6483/\u30d6\u30eb\u30fc\u30c8\u30d5\u30a9\u30fc\u30b9\u653b\u6483\u5bfe\u7b56\u30a2\u30d7\u30ea\u306e\u8fd1\u6cc1](http://qiita.com/bezeklik/items/6d86a162e278f576e4ca)\n* [Linux\u30a2\u30f3\u30c1\u30a6\u30a4\u30eb\u30b9\u30bd\u30d5\u30c8 ClamAV](http://qiita.com/bezeklik/items/4696e15c889ffff6bc41)\n* [Linux Malware Detect](http://qiita.com/bezeklik/items/43a7d4fce6bc23fe84d3)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb Rootkit Hunter (rkhunter)](http://qiita.com/bezeklik/items/bc7affef8afe7c63f2ce)\n* [\u30eb\u30fc\u30c8\u30ad\u30c3\u30c8\u691c\u51fa\u30c4\u30fc\u30eb chkrootkit](http://qiita.com/bezeklik/items/7964ce67f1a1363b694e)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AFICK](http://qiita.com/bezeklik/items/298dafd2aeb053b4ca88)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb AIDE](http://qiita.com/bezeklik/items/d144d77a3e54cd35c06b)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb OSSEC](http://qiita.com/bezeklik/items/2143c02f1432d90f5c38)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Samhain](http://qiita.com/bezeklik/items/6b7fb75f1a37b0fc41a2)\n* [\u30d5\u30a1\u30a4\u30eb\u6539\u3056\u3093\u691c\u77e5\u30c4\u30fc\u30eb Tripwire](http://qiita.com/bezeklik/items/2dfb871b9397211c735b)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc OpenVAS](http://qiita.com/bezeklik/items/a64cad37eb03a1db2de4)\n* [\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30ca\u30fc Nikto](http://qiita.com/bezeklik/items/12643654dc0c45f4eb29)\n* [Linux\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u76e3\u67fb\u30c4\u30fc\u30eb Lynis](http://qiita.com/bezeklik/items/cf9be2deb546c69123e7)\n", "tags": ["Samhain4.2.0", "CentOS7", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"]}