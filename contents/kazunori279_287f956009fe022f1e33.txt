{"context": " More than 1 year has passed since last update.WIZnet\u306eTCP\u30d7\u30ed\u30bb\u30c3\u30b5W5300\u3092\u8f09\u305b\u305f\u30dc\u30fc\u30c9WIZ830MJ\u304c\u304f\u3055\u308b\u307b\u3069\u5c4a\u3044\u305f\u306e\u3067\u3001\u3082\u3063\u305f\u3044\u306a\u3044\u304b\u3089\u306a\u3093\u3068\u304b\u52d5\u304b\u305d\u3046\u3068\u3057\u3066\u3044\u308b\u3002\n\n\u3044\u308d\u3044\u308d\u8a66\u884c\u932f\u8aa4\u306e\u7d50\u679c\u3001Terasic DE0\u4e0a\u306bQsys\u3067Nios II\u30d7\u30ed\u30bb\u30c3\u30b5\u3092\u4f5c\u308a\u3001W5300\u3068\u3064\u306a\u3044\u3067TCP\u30ea\u30b9\u30ca\u30fc\u3092\u4f5c\u308b\u3068\u3053\u308d\u307e\u3067\u52d5\u3044\u305f\u306e\u3067\u3001\u305d\u306e\u624b\u9806\u3092\u3056\u3063\u3068\u307e\u3068\u3081\u3066\u304a\u304f\uff08disclaimer: \u30cf\u30fc\u30c9\u958b\u767a\u306b\u3064\u3044\u3066\u306f\u7d20\u4eba\u306a\u306e\u3067\u3001\u9593\u9055\u3063\u3066\u308b\u90e8\u5206\u3082\u5927\u3044\u306b\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\uff09\u3002\n\nW5300\u306b\u3064\u3044\u3066\nW5300\u306f\u3001WIZnet\u304c\u3051\u3063\u3053\u3046\u6614\u306b\u958b\u767a\u3057\u305f\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u30d9\u30fc\u30b9\u306eTCP/IP\u30d7\u30ed\u30bb\u30c3\u30b5\u3002CPU\u3084OS\u304c\u4e0d\u8981\u306a\u306e\u3067\u3001Linux\u306e\u8f09\u3089\u306a\u3044\u5c0f\u3055\u306a\u30de\u30a4\u30b3\u30f3\u306bTCP\u901a\u4fe1\u6a5f\u80fd\u3092\u6301\u305f\u305b\u308b\u305f\u3081\u306b\u3088\u304f\u7528\u3044\u3089\u308c\u3066\u3044\u308b\u3002\u30b9\u30c8\u30ed\u30d9\u30ea\u30fc\u30fb\u30ea\u30ca\u30c3\u30af\u30b9\u3067\u8a55\u4fa1\u30dc\u30fc\u30c9\u3092\u8cb7\u3046\u30681\u500b2000\u5186\u304f\u3089\u3044\u3002\u4e3b\u8981\u30b9\u30da\u30c3\u30af\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\uff1a\n\nTCP, UDP, ICMP, ARP, IGMP, PPPoE\u3092\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u5b9f\u88c5\n8\u307e\u305f\u306f16\u30d3\u30c3\u30c8\u306e\u30d0\u30b9\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5099\u3048\u308b\nDMA\u306b\u5bfe\u5fdc\u3057\u3001\u6700\u592780Mbps\u3067\u52d5\u4f5c\n\u6700\u59278\u672c\u306e\u30bd\u30b1\u30c3\u30c8\uff08\u30ea\u30b9\u30ca\u307e\u305f\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff09\u306b\u5bfe\u5fdc\n128KB\u30d0\u30c3\u30d5\u30a1\u642d\u8f09\n10BaseT/100BaseTX\u30b3\u30cd\u30af\u30bf\u88c5\u5099\n\n\n\u30cf\u30fc\u30c9\u5b9f\u88c5\u3060\u304b\u3089\u4ed5\u65b9\u304c\u306a\u3044\u3051\u3069\u3001\u30bd\u30b1\u30c3\u30c8\u306f8\u672c\u3057\u304b\u4f7f\u3048\u306a\u3044\u3002\u307e\u305f\u4e0b\u4f4d\u88fd\u54c1\u306eW5200/W5100\u306fSPI\u3067\u304a\u624b\u8efd\u306b\u30de\u30a4\u30b3\u30f3\u3068\u3064\u306a\u3052\u3089\u308c\u308b\u4e00\u65b9\u3067\u3001W5300\u306f\u901f\u5ea6\u91cd\u8996\u306e\u305f\u308116\u30d3\u30c3\u30c8\u306e\u30d0\u30b9\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3067\u3064\u306a\u3050\u5fc5\u8981\u304c\u3042\u308b\u3002\n\nDE0\u3068WIZ830MJ\u306e\u63a5\u7d9a\n\u307e\u305a\u306f\u3001WIZ830MJ\u306b\u4ed8\u3044\u3066\u3044\u308b2\u3064\u306e28\u30d4\u30f3\u30b3\u30cd\u30af\u30bf\u3092\u3069\u3046\u3084\u3063\u3066DE0\u306b\u7269\u7406\u7684\u306b\u7d50\u7dda\u3059\u308b\u304b\u3092\u8003\u3048\u305f\u3002\n\n\u3053\u308c\u3092\u3001aitendo\u3067\u58f2\u3063\u3066\u308b\u30d4\u30f3\u30d8\u30c3\u30c0\u63a5\u7d9a\u30b1\u30fc\u30d6\u30eb\u3092\u4f7f\u3063\u3066\u3072\u305f\u3059\u3089\u4e00\u672c\u305a\u3064DE0\u306eGPIO\u306b\u3064\u306a\u3052\u3066\u304f\u3002\u3053\u3093\u306a\u611f\u3058\uff1a\n\n\u3053\u3093\u306a\u306b\u305f\u304f\u3055\u3093\u30b1\u30fc\u30d6\u30eb\u633f\u3057\u3066\u3001\u4e00\u672c\u3067\u3082\u65ad\u7dda\u3057\u3066\u3066\u30c7\u30d0\u30c3\u30b0\u3067\u306f\u307e\u3063\u305f\u308a\u3059\u308b\u306e\u306f\u5acc\u3060\u3063\u305f\u306e\u3067\u3001\u5ff5\u306e\u305f\u3081WIZ\u306b\u7e4b\u3044\u3060\u3068\u3053\u308d\u3067\u30c6\u30b9\u30bf\u30fc\u3067\u4e00\u672c\u305a\u3064\u5c0e\u901a\u78ba\u8a8d\u3057\u3066\u304a\u3044\u305f\u3002\nDE0\u3068WIZ\u9593\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u306f\u3053\u3093\u306a\u3075\u3046\u306b\u30e1\u30e2\u3063\u3066\u304a\u3044\u3066\u3001\u3042\u3068\u306e\u30d4\u30f3\u30a2\u30b5\u30a4\u30f3\u6642\u306b\u4f7f\u3063\u305f\u3002\u3053\u308c\u30821\u3064\u3067\u3082\u9593\u9055\u3048\u308b\u3068\u30cf\u30de\u308a\u305d\u3046\u3002\n\n\n\u3068\u308a\u3042\u3048\u305aL\u30c1\u30ab\n\u3053\u306e\u30d0\u30b9\u3092\u3069\u3093\u306a\u3075\u3046\u306b\u4f7f\u3046\u306e\u304b\u306f\u3055\u3066\u304a\u304d\u3001\u3068\u308a\u3042\u3048\u305a\u306f\u96fb\u6e90\u3092\u5165\u308c\u3066LED\u304c\u30c1\u30ab\u30c1\u30ab\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u78ba\u8a8d\u3059\u308b\u3002WIZ\u306e\u30d4\u30f3\u304b\u3089\u51fa\u3066\u308bLED\u7528\u306e\u51fa\u529b\uff08Ethernet\u306e\u30ea\u30f3\u30af\u72b6\u614b\u3084Tx/Rx\u52d5\u4f5c\u306a\u3069\uff09\u3092\u305d\u306e\u307e\u307eDE0\u306eLED\u306b\u3064\u306a\u3052\u308bVerilog HDL\u3092\u66f8\u304f\u3002\nassign WIZ_BIT16EN = 1'b1; // 16 bit mode\nassign WIZ_RESET_N = RST_N; // reset\nassign LED9 = !WIZ_LINKLED_N;\nassign LED8 = !WIZ_TXLED_N;\nassign LED7 = !WIZ_RXLED_N;\nassign LED6 = !WIZ_COLLED_N;\nassign LED5 = !WIZ_FDXLED_N;\nassign LED4 = !WIZ_SPDLED_N;\nassign LED3 = !WIZ_ACTLED_N;\nassign LED2 = 1'b0;\nassign LED1 = 1'b0;\nassign LED0 = 1'b0;\n\n\u3055\u3089\u306bQuartus\u306ePin Planner\u3067\u306f\u3001\u3055\u3063\u304d\u30e1\u30e2\u3063\u305f\u30de\u30c3\u30d4\u30f3\u30b0\u901a\u308a\u306bLocation\u3092\u8a2d\u5b9a\u3001\u307e\u305f\u3059\u3079\u3066\u306e\u30d4\u30f3\u306eI/O Standard\u3092W5300\u306e\u4ed5\u69d8\u306b\u5408\u308f\u305b\u30663.3-V LVCMOS\u306b\u30bb\u30c3\u30c8\u3059\u308b\u3002\n\n\uff08Pin Planner\u306e\u753b\u9762\u3063\u3066\u306a\u3093\u304b\u30ab\u30c3\u30b3\u3044\u3044...\uff09\n\u3053\u3053\u307e\u3067\u3067\u304d\u305f\u3089DE0\u306e\u96fb\u6e90\u3092\u5165\u308c\u3066\u3001Quartus\u3067\u30b3\u30fc\u30c9\u3092\u30d3\u30eb\u30c9\u3001Programmer\u3067\u6d41\u3057\u3066\u307f\u308b\u3002\u30a4\u30fc\u30b5\u30b1\u30fc\u30d6\u30eb\u3092WIZ\u306e\u30b3\u30cd\u30af\u30bf\u306b\u633f\u3057\u305f\u3089DE0\u306eLED\u304c\u30c1\u30ab\u30c1\u30ab\u3057\u3066\u3001\u3069\u3046\u3084\u3089\u58ca\u308c\u305a\u306b\u52d5\u3044\u3066\u308b\u3089\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3002\u30ea\u30bb\u30c3\u30c8\u30dc\u30bf\u30f3\u3082\u52d5\u3044\u3066\u3044\u308b\u3002\n\nW5300\u306e\u30d0\u30b9\u306e\u4f7f\u3044\u65b9\n\u3055\u3066\u3001\u6700\u5927\u306e\u96e3\u95a2\u306fW5300\u306e\u30d0\u30b9\u3092\u3046\u307e\u304f\u4f7f\u3044\u3053\u306a\u305b\u308b\u304b\u3067\u3042\u308b\u3002\u751f\u307e\u308c\u3066\u3053\u306e\u304b\u305f\u30d0\u30b9\u306a\u3093\u3066\u4f7f\u3063\u305f\u3053\u3068\u306a\u3044\u3002My First Bus! \u307b\u3093\u307e\u306b\u3046\u3054\u304f\u3093\u304b\u3044\u306a\u3002\u3002\nW5300\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u898b\u308b\u9650\u308a\u306f\u3001\u3068\u3066\u3082\u30b7\u30f3\u30d7\u30eb\u305d\u3046\u306a\u30d0\u30b9\u3067\u306f\u3042\u308b\u3002\n\n\u307e\u3042\u3064\u307e\u308a\u3001\n\n10\u30d3\u30c3\u30c8\u306eADDR\u306b\u8aad\u307f\u66f8\u304d\u3057\u305f\u3044W5300\u306e\u30ec\u30b8\u30b9\u30bf\u306e\u30a2\u30c9\u30ec\u30b9\u3092\u6e21\u3057\u3066\u3001\n\nCS (chip select) \u3067\u300c\u3053\u308c\u304b\u3089\u541b\u3068\u901a\u4fe1\u3059\u308b\u3088\u30fc\u300d\u3068\u4f1d\u3048\u3066\u3001\n\nRD (read) \u3067\u300c\u30c7\u30fc\u30bf\u8aad\u3093\u3067\u30fc\u300d\u3068\u4f1d\u3048\u308b\u3068\u3001\u30a2\u30c9\u30ec\u30b9\u3067\u6307\u5b9a\u3057\u305f\u30ec\u30b8\u30b9\u30bf\u306e\u5024\u304c16\u30d3\u30c3\u30c8\u306eDATA\u306b\u8f09\u3063\u3066\u304f\u308b\n\n\u3068\u3044\u3046\u4ed5\u7d44\u307f\u3060\u3002\u56f3\u306b\u66f8\u304f\u3068\u3053\u3093\u306a\u6d41\u308c\uff1a\n\n\u3053\u3053\u306b\u66f8\u304b\u308c\u305ftRD\u3084\u3089tDATAs\u3084\u3089\u3067\u6c7a\u3081\u3089\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u5916\u308c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u4eca\u56de\u3001DE0\u306e\u30af\u30ed\u30c3\u30af\u306f50MHz=20ns\u306a\u306e\u3067\u3001\u4f8b\u3048\u3070tRD\u306e\u6700\u5c0f\u502465ns\u3092\u4e0b\u56de\u3089\u306a\u3044\u3088\u3046\u306bRD\u306f4\u30af\u30ed\u30c3\u30af\u4ee5\u4e0a\u7dad\u6301\u3059\u308b\u3001\u306a\u3069\u306a\u3069\u3002\n\nW5300\u306e\u30ec\u30b8\u30b9\u30bf\nW5300\u3092\u4f7f\u3046\u306b\u306f\u3001\u3068\u308a\u3042\u3048\u305a\u3053\u306e\u30d0\u30b9\u3092\u7d4c\u7531\u3057\u305f\u30ec\u30b8\u30b9\u30bf\u306e\u8aad\u307f\u66f8\u304d\u3055\u3048\u3067\u304d\u308c\u3070\u3088\u3044\u3002\u5272\u308a\u8fbc\u307f\u4fe1\u53f7INT\u3084DMA\u3092\u4f7f\u3046\u3068\u3044\u308d\u3044\u308d\u9ad8\u5ea6\u306a\u3053\u3068\u3082\u3067\u304d\u308b\u3051\u3069\u3001hello world\u3057\u305f\u3044\u6bb5\u968e\u3067\u306f\u3053\u308c\u3089\u306f\u8003\u3048\u306a\u304f\u3066\u3082\u3088\u3044\u3002TCP\u63a5\u7d9a\u306b\u5fc5\u8981\u306a\u30b3\u30de\u30f3\u30c9\u9001\u4fe1\u3084\u72b6\u614b\u7ba1\u7406\u306f\u3059\u3079\u3066\u30ec\u30b8\u30b9\u30bf\u306e\u8aad\u307f\u66f8\u304d\u306e\u307f\u3067\u884c\u3048\u308b\u3002\n\n\u4f8b\u3048\u3070\u30018\u672c\u306e\u30bd\u30b1\u30c3\u30c8\u305d\u308c\u305e\u308c\u306eTCP\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u898b\u308b\u306b\u306f\u3001\u5bfe\u8c61\u306e\u30bd\u30b1\u30c3\u30c8\u306eSocket Status Register (SSR)\u30ec\u30b8\u30b9\u30bf\u3092\u30d0\u30b9\u304b\u3089\u8aad\u3081\u3070\u3088\u3044\u3002\u4ed5\u69d8\u66f8\u306b\u306f\u305d\u306e\u5024\u304c\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u306eTCP\u30b9\u30c6\u30fc\u30bf\u30b9\u306b\u5bfe\u5fdc\u3059\u308b\u304b\u304c\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u3002\n\n\u30db\u30b9\u30c8\u5074\u3067\u306f\u3001\u3053\u306e\u72b6\u614b\u306b\u5fdc\u3058\u3066\u6b21\u306b\u51fa\u3059\u3079\u304d\u30b3\u30de\u30f3\u30c9\u3084\u3001\u30bd\u30fc\u30b9\uff0f\u5b9b\u5148IP\u30a2\u30c9\u30ec\u30b9\u7b49\u306e\u30c7\u30fc\u30bf\u3092\u5225\u306e\u30ec\u30b8\u30b9\u30bf\u306b\u66f8\u304d\u8fbc\u307f\u3057\u3066\u3001W5300\u306b\u4ed5\u4e8b\u3092\u4f9d\u983c\u3059\u308b\u3002\u306a\u308b\u307b\u3069\u3001\u539f\u7406\u7684\u306b\u306f\u305d\u3093\u306a\u96e3\u3057\u304f\u306f\u306a\u3055\u305d\u3046\u3060\u3002\n\nQsys\u3067Nios II\u3092\u4f5c\u308b\n\u305d\u306e\u4ed5\u4e8b\u306e\u4f9d\u983c\u65b9\u6cd5\u306b\u306f\u3001\u4ee5\u4e0b\u306e2\u3064\u304c\u8003\u3048\u3089\u308c\u308b\u3002\n\nW5300\u306e\u5236\u5fa1\u3092\u3059\u3079\u3066\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u3067\u5b9f\u88c5\u3059\u308b\nW5300\u3092\u30d0\u30b9\u7d4c\u7531\u3067CPU\u306b\u3064\u306a\u304e\u3001\u5236\u5fa1\u3092\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3067\u5b9f\u88c5\u3059\u308b\n\n\u6211\u304c\u5e2b\u5320\u306e\u307f\u3088\u3057\u3055\u3093\u306f\u3001\u4ed5\u4e8b\u306e\u5408\u9593\u306b\u3042\u3063\u3068\u3044\u3046\u9593\u306b\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u5b9f\u88c5\u3067W5300\u3092\u52d5\u304b\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u3002\u30d7\u30ed\u3053\u308f\u3044\u3002\u3057\u304b\u3082Synthesijer\u3068\u3044\u3046\u3001\u307f\u3088\u3057\u3055\u3093\u304a\u624b\u88fd\u306e\u9ad8\u4f4d\u5408\u6210\u30c4\u30fc\u30eb\uff08\u9ad8\u7d1a\u8a00\u8a9e\u304b\u3089\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u8a18\u8ff0\u8a00\u8a9e\u3092\u81ea\u52d5\u751f\u6210\u3059\u308b\u3084\u3064\uff09\u3092\u4f7f\u3063\u3066\u3001\u3042\u3063\u3055\u308aJava\u3067\u66f8\u3044\u3066\u3042\u308b\u3002\u3053\u308c\u304b\u3089\u306e\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u958b\u767a\u306f\u3053\u3093\u306a\u3075\u3046\u306b\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u3069\u3093\u3069\u3093\u8fd1\u304f\u306a\u3063\u3066\u3044\u304f\u306e\u3060\u308d\u3046\u306a\u30fc\u3002\u3002\n\u3057\u304b\u3057\u5e2b\u5320\u306e\u30b3\u30ec\u3092\u305d\u306e\u307e\u3093\u307e\u4f7f\u3063\u305f\u306e\u3067\u306f\u4fee\u884c\u306b\u306a\u3089\u306a\u3044\u306e\u3067\u3001\u4eca\u56de\u306f\u30aa\u30fc\u30bd\u30c9\u30c3\u30af\u30b9\u306b\u5f8c\u8005\u306e\u65b9\u6cd5\u3067\u884c\u304f\u3053\u3068\u306b\u3057\u305f\u3002Quartus\u306b\u4ed8\u5c5e\u306eSoC\u30c4\u30fc\u30ebQsys\u3092\u4f7f\u3063\u3066MIPS\u30d9\u30fc\u30b9CPU\u3067\u3042\u308bNios II\u3092FPGA\u4e0a\u306b\u4f5c\u6210\u3057\u3001\u305d\u306e\u4e0a\u3067C\u3067\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u3092\u52d5\u304b\u3057\u3066\u4e0a\u8ff0\u306e\u3088\u3046\u306aW5300\u306e\u30ec\u30b8\u30b9\u30bf\u306e\u8aad\u307f\u66f8\u304d\u3092\u884c\u3046\u3002\n\u3053\u308c\u307e\u3067Qsys\u3082Nios II\u3082\u4f7f\u3063\u305f\u3053\u3068\u304c\u306a\u304b\u3063\u305f\u306e\u3060\u3051\u3069\u3001\u795e\u672c\u300cFPGA\u30b9\u30bf\u30fc\u30bf\u30fb\u30ad\u30c3\u30c8\u3067\u521d\u4f53\u9a13\uff01\u30aa\u30ea\u30b8\u30ca\u30eb\u30fb\u30de\u30a4\u30b3\u30f3\u4f5c\u308a\u300d\u306e\u304a\u304b\u3052\u3067\u3001\u3042\u307e\u308a\u5f15\u3063\u304b\u304b\u308b\u3053\u3068\u306a\u304fQsys\u4e0a\u306eNios II\u4f5c\u6210\u3068L\u30c1\u30ab\u307e\u3067\u3092\u9032\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002This is the god's book\u3067\u3042\u308b\u3002\n\n\u3053\u306e\u672c\u3092\u8aad\u307f\u306a\u304c\u3089\u3001Qsys\u3067Nios II\u3084SDRAM\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u3092\u4f5c\u308a\u3001\u30af\u30ed\u30c3\u30af\u4fe1\u53f7\u3084Avalon\u30d0\u30b9\u3092\u307d\u3061\u307d\u3061UI\u4e0a\u3067\u3064\u306a\u3044\u3067\u3044\u304f\u3002\u3055\u3089\u306bQuartus\u4ed8\u5c5e\u306eEclipse\u3067C\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u3001Qsys\u4e0a\u3067\u9069\u5f53\u306b\u6307\u5b9a\u3057\u305f\u30e1\u30e2\u30ea\u30de\u30c3\u30d7I/O\u306e\u30a2\u30c9\u30ec\u30b9\u306b\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u3068\u3001\u305d\u306eI/O\u306b\u7e4b\u3044\u3060LED\u304c\u30c1\u30ab\u30c1\u30ab\u3057\u305f\u308a\u3059\u308b\u3002\u3053\u308c\u306f\u697d\u3057\u3044\u305e\u3002\u3002Altera\u306b\u304a\u91d1\u3092\u6255\u308f\u305a\u306b\u3053\u3053\u307e\u3067\u3067\u304d\u308b\u306a\u3093\u3066\u3002\n\n\u307e\u3041\u3001\u30af\u30ed\u30c3\u30af\u306f50MHz\u3060\u3057\u3001\u7121\u511f\u7248\u306eNios II\u306b\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u3082\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3082\u306a\u3044\u306e\u3067\u6fc0\u9045\u3067\u306f\u3042\u308b\u306e\u3060\u3051\u3069\u3002SDRAM\u3068\u306e\u8ee2\u9001\u5e2f\u57df\u3092\u5b9f\u6e2c\u3057\u3066\u307f\u305f\u3089280KB/s\u3060\u3063\u305f\u3002RAM\u306a\u306e\u306b\u3001GCE\u306eLocal SSD\u3088\u308a2500\u500d\u304f\u3089\u3044\u9045\u3044\uff57\n\nAvalon MM Slave Translator\u3067W5300\u306e\u30d0\u30b9\u5236\u5fa1\nQsys\u3067\u306fNios II\u306bAvalon\u3068\u3044\u3046\u30d0\u30b9\u304c\u3064\u306a\u304c\u3063\u3066\u3044\u308b\u306e\u3060\u3051\u3069\u3001Avalon\u3068W5300\u306e\u30d0\u30b9\u306f\u3069\u3046\u3084\u3063\u3066\u3064\u306a\u3052\u3088\u3046\uff1f \u3068\u3001Qsys\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u3044\u308d\u3044\u308d\u63a2\u3057\u305f\u3089\u3001\u3069\u3046\u3084\u3089Avalon MM Slave Translator\u3068\u3044\u3046\u3084\u3064\u3092\u4f7f\u3048\u3070\u3044\u3044\u611f\u3058\u306b\u884c\u3051\u305d\u3046\u3060\u3002\u8a73\u7d30\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u30a6\u30a3\u30b6\u30fc\u30c9\u753b\u9762\u3067\u6307\u5b9a\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u6700\u9069\u69cb\u6210\u3092\u898b\u3064\u3051\u308b\u306e\u306b\u82e6\u52b4\u3057\u305f\u3051\u3069\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3067\u4eca\u306e\u3068\u3053\u308d\u3044\u3044\u611f\u3058\u306e\u52d5\u304d\u306b\u306a\u3063\u3066\u3044\u308b\uff1a\n\n\u30bf\u30a4\u30df\u30f3\u30b0\u307e\u308f\u308a\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001\u3068\u308a\u3042\u3048\u305a\u3059\u3079\u30665\u30af\u30ed\u30c3\u30af\u306b\u3057\u3068\u3044\u3066\u3042\u3068\u3067\u8ffd\u3044\u8fbc\u3080\u3064\u3082\u308a\u3002\u3053\u306eTranslator\u306bwiz0\u3068\u3044\u3046\u540d\u524d\u3092\u4ed8\u3051\u3066\u3001HDL\u306e\u65b9\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3067W5300\u3068\u7e4b\u3044\u3060\u3002\nnios2e u0 (\n    .clk_clk (CLK),\n    .reset_reset_n (RST_N),\n    .wiz0_address       (WIZ_A),\n    .wiz0_write     (wiz_wr),\n    .wiz0_read      (wiz_rd),\n    .wiz0_readdata      (wiz_readdata),\n    .wiz0_writedata     (wiz_writedata),\n    .wiz0_chipselect    (wiz_cs),\n    .wiz0_byteenable    (wiz_byteenable)\n);\n\nwire [15:0] wiz_readdata;\nwire [15:0] wiz_writedata;\nwire [1:0] wiz_byteenable;\nwire wiz_cs, wiz_wr, wiz_rd;\nassign WIZ_CS_N = !wiz_cs;\nassign WIZ_WR_N = !(wiz_wr && wiz_byteenable[0] && wiz_byteenable[1]);\nassign WIZ_RD_N = !(wiz_rd && wiz_byteenable[0] && wiz_byteenable[1]);\nassign WIZ_D = (!WIZ_CS_N && !WIZ_WR_N) ? wiz_writedata : 15'bz;\nassign wiz_readdata = (!WIZ_CS_N && !WIZ_RD_N) ? WIZ_D : 15'b0;\n\n\u3053\u3093\u306a\u66f8\u304d\u65b9\u3067\u3088\u3044\u306e\u304b\u4e0d\u660e\u3060\u304c\u3001\u3001W5300\u306e\u30d0\u30b9\u306f\u30c8\u30e9\u30a4\u30b9\u30c6\u30fc\u30c8\u306a\u306e\u3067CS\u3068WR\u3082\u3057\u304f\u306fRD\u304c\u30a4\u30cd\u30fc\u30d6\u30eb\u306e\u6642\u306b\u3060\u3051\u30ea\u30fc\u30c9\u3084\u30e9\u30a4\u30c8\u306e\u30c7\u30fc\u30bf\u3092\u6d41\u3059\u3002\u305d\u308c\u3068\u3001byteenable\u304c\u30ef\u30fc\u30c9\u66f8\u304d\u8fbc\u307f\u306e\u6642\u3060\u3051\u5bfe\u5fdc\u3059\u308b\u3088\u3046\u306b\u3057\u305f\u3002\nW5300\u306e\u30d0\u30b9\u306b\u306fbyteenable\u304c\u306a\u3044\u306e\u3067\u3001\u3053\u3046\u3044\u3046\u3068\u304d\u3069\u3046\u3059\u308c\u3070\u3088\u3044\u306e\u3060\u308d\u3046\uff1f \u3068\u60a9\u3093\u3060\u3002Nios II\u4e0a\u306e\u30b3\u30fc\u30c9\u304b\u3089(char *)\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u4f7f\u3044\u3001\u30d0\u30a4\u30c8\u5358\u4f4d\u3067\u66f8\u304d\u8fbc\u307f\u3059\u308b\u3068\u3001byteenable\u306b\u306f\u30d0\u30a4\u30c8\u5358\u4f4d\u66f8\u304d\u8fbc\u307f\u306e\u30d5\u30e9\u30b0\u304c\u7acb\u3064\u3002\u3064\u307e\u308a\u30011\u30d0\u30a4\u30c8\u3060\u3051\u66f4\u65b0\u3057\u305f\u3044\u3002\u3057\u304b\u3057W5300\u306f1\u30ef\u30fc\u30c9\uff082\u30d0\u30a4\u30c8\uff09\u5358\u4f4d\u3067\u3057\u304b\u66f8\u304d\u8fbc\u307f\u3067\u304d\u306a\u3044\u3002\u306a\u306e\u3067\u3001\u3044\u3061\u3069\u5bfe\u8c61\u30ef\u30fc\u30c9\u3092\u8aad\u3093\u3067\u3001\u305d\u306e\u3046\u30611\u30d0\u30a4\u30c8\u306e\u307f\u66f8\u304d\u63db\u3048\u3001\u3075\u305f\u305f\u3073\u30ef\u30fc\u30c9\u5358\u4f4d\u3067\u66f8\u304d\u623b\u3059\u3068\u3044\u3046read-modify-write\u306e\u52d5\u4f5c\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\u3053\u308c\u3063\u3066I/O\u5074\u3067\u304c\u3093\u3070\u3063\u3066\u30cf\u30fc\u30c9\u5b9f\u88c5\u3059\u3079\u304d\u306a\u306e\u304b\u306a\uff1f \u3068\u8b58\u8005\u306e\u7686\u3055\u3093\u306b\u805e\u3044\u3066\u307f\u305f\u3089\u3001\u305f\u3051\u3080\u3089\u5e2b\u5320\u3068\u3068\u3088\u3057\u307e\u5e2b\u5320\u304b\u3089\u300c\u305d\u3046\u3044\u3046\u306e\u306fI/O\u5074\u3067\u52dd\u624b\u306b\u3084\u3089\u305a\u306b\u30db\u30b9\u30c8\u5074\u3067\u3084\u308b\u306e\u304c\u5e38\u9053\u300d\u3068\u306e\u30a2\u30c9\u30d0\u30a4\u30b9\u3092\u3044\u305f\u3060\u3044\u305f\u3002\u3068\u3044\u3046\u308f\u3051\u3067\u3001I/O\u5074\u3067\u306f\u30d0\u30a4\u30c8\u5358\u4f4d\u66f8\u304d\u8fbc\u307f\u306b\u306f\u5bfe\u5fdc\u3057\u306a\u3044\u3053\u3068\u306b\u3057\u305f\u3002C\u30b3\u30fc\u30c9\u304b\u3089\u306f(unsigned short *)\u306e\u307f\u3067\u8aad\u307f\u66f8\u304d\u3059\u308b\u3002\n\u3053\u306e\u3042\u305f\u308a\u306e\u30c7\u30d0\u30c3\u30b0\u306fQuartus\u4ed8\u5c5e\u306eSignalTap\u306a\u3057\u3067\u306f\u4e0d\u53ef\u80fd\u3002\u3082\u3063\u3068\u3061\u3083\u3093\u3068\u3057\u305f\u30c7\u30d0\u30c3\u30b0\u74b0\u5883\u3092\u6574\u3048\u308b\u305f\u3081\u306b\u3001\u5b9f\u6a5f\u3067\u306a\u304f\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc\u3092\u4f7f\u304a\u3046\u304b\u306a\u3068\u3082\u8003\u3048\u305f\u3051\u3051\u3069\u3001\u3072\u3068\u901a\u308a\u306e\u30e2\u30c7\u30eb\u3092\u7528\u610f\u3059\u308b\u306e\u304c\u9762\u5012\u306a\u306e\u3067\u3068\u308a\u3042\u3048\u305a\u5b9f\u6a5f\uff0bSignalTap\u3067\u3002\nNios II\u306eEclipse\u4e0a\u3067Nios II Application and BSP from Template\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3001hello world\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u3063\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u3001W5300\u3092\u30bd\u30d5\u30c8\u30ea\u30bb\u30c3\u30c8\u3057\u3066\u307f\u305f\u3002\n  volatile unsigned short *p = WIZ0_BASE + 0x000; // W5300 base address + 0x000 register\n  *p = *p | 0b10000000; // setting the reset flag\n\n\u3046\u307e\u304f\u30ea\u30bb\u30c3\u30c8\u3055\u308c\u3001\u30ec\u30b8\u30b9\u30bf\u304b\u3089\u8aad\u307f\u8fbc\u3093\u3060\u5024\u306e\u5185\u5bb9\u3082OK\u3002SignalTap\u3067\u3082\u3001\u60f3\u5b9a\u3069\u304a\u308a\u306b\u52d5\u3044\u3066\u308b\u3063\u307d\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u305f\u3002\n\n\nWIZnet\u306e\u30c9\u30e9\u30a4\u30d0\u30b3\u30fc\u30c9\u3092\u52d5\u304b\u3059\n\u3053\u308c\u3067C\u30b3\u30fc\u30c9\u304b\u3089W5300\u306e\u30ec\u30b8\u30b9\u30bf\u3092\u81ea\u7531\u306b\u8aad\u307f\u66f8\u304d\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3051\u3069\u3001\u30ec\u30b8\u30b9\u30bf\u306e\u4ed5\u69d8\u3092\u8aad\u3080\u3068\u7d50\u69cb\u7d30\u3005\u3068\u3057\u305f\u72b6\u614b\u9077\u79fb\u7ba1\u7406\u3084\u30d3\u30c3\u30c8\u64cd\u4f5c\u304c\u5fc5\u8981\u305d\u3046\u3067\u3001\u3059\u3079\u3066\u3092\u81ea\u5206\u3067\u66f8\u304f\u306e\u306f\u9762\u5012\u305d\u3046\u3002\u3057\u304b\u3057\u3042\u308a\u304c\u305f\u3044\u3053\u3068\u306b\u3001WIZnet\u306e\u30b5\u30a4\u30c8\u304b\u3089C\u3067\u66f8\u304b\u308c\u305f\u30c9\u30e9\u30a4\u30d0\u30b3\u30fc\u30c9\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u3053\u306e\u30c9\u30e9\u30a4\u30d0\u306f\u3069\u3046\u3084\u3089Xscale\u30de\u30a4\u30b3\u30f3\u7528\u306b\u66f8\u304b\u308c\u305f\u3082\u306e\u306e\u3088\u3046\u3067\u3001\u305d\u306e\u307e\u307e\u3067\u306f\u30ed\u30b0\u51fa\u529b\u306eprintf\u307e\u308f\u308a\u304c\u5f15\u3063\u304b\u304b\u3063\u3066\u52d5\u304b\u306a\u3044\u3002Altera\u63d0\u4f9b\u306ealt_printf\u3068\u5dee\u3057\u66ff\u3048\u305f\u308a\u3061\u3087\u3053\u3061\u3087\u3053\u76f4\u3057\u305f\u308a\u3057\u3066\u52d5\u3044\u305f\u3002\n\u3053\u308c\u3092\u4f7f\u3046\u3068\u3001TCP\u30bd\u30b1\u30c3\u30c8\u306e\u4f5c\u6210\u3092\u3068\u3066\u3082\u7c21\u5358\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u305f\u3002\nsetSIPR({ 192, 168, 1, 250 }); // set source IP address\nsetGAR({ 192, 168, 1, 1 }); // set gateway IP address\nsetSUBR({ 255, 255, 255, 0 }); // set subnet mask address\nsetSHAR({ 0x00, 0x08, 0xDC, 0x00, 111, 200 }); // set source hardware address\n\n\u3068\u3044\u3046\u611f\u3058\u306b\u30bd\u30fc\u30b9IP\u30a2\u30c9\u30ec\u30b9\u3084\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3001\u30b5\u30d6\u30cd\u30c3\u30c8\u30de\u30b9\u30af\u3001MAC\u30a2\u30c9\u30ec\u30b9\u7b49\u3092\u30ec\u30b8\u30b9\u30bf\u306b\u30bb\u30c3\u30c8\u3057\u3066\u3001main.c\u306b\u3042\u308b\u30eb\u30fc\u30d7\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u7528\u306e\u95a2\u6570loopback_tcps()\u3092\u547c\u3073\u51fa\u305b\u3070\u3001\u6307\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\u756a\u53f7\u3067TCP\u30ea\u30b9\u30ca\u30fc\u3092\u4f5c\u6210\u3067\u304d\u308b\u3002\nloopback_tcps(0, 5000, data_buf, 0);\n\n\u63a5\u7d9a\u30c6\u30b9\u30c8\u306e\u305f\u3081\u3001PC\u304b\u3089telnet\u3067\u3064\u306a\u3044\u3067\u307f\u308b\u3002\n$ telnet 192.168.1.250 5000\nTrying 192.168.1.250...\nConnected to 192.168.1.250.\nEscape character is '^]'.\nhello\nhello\nworld\nworld\n\n\u9069\u5f53\u306a\u6587\u5b57\u5217\u3092\u53e9\u304f\u3068\u305d\u306e\u307e\u307e\u30a8\u30b3\u30fc\u30d0\u30c3\u30af\u3055\u308c\u3066\u304d\u305f\u3002\u3044\u3048\u30fc\u3044\u3001\u52d5\u3044\u305f\u305c\uff01\uff01\uff01\n\n\u3053\u308c\u304b\u3089\u306e\u91ce\u671b\n\u3068\u308a\u3042\u3048\u305aCPU\u4e0a\u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u304b\u3089W5300\u3092\u5236\u5fa1\u3057\u3066hello world\u3059\u308b\u3068\u3044\u3046\u7b2c\u4e00\u76ee\u6a19\u306f\u9054\u3057\u305f\u3002\u3053\u308c\u304b\u3089\u306fTCP\u3088\u308a\u4e0a\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u30bd\u30d5\u30c8\u3067\u5b9f\u88c5\u3057\u3001\u3055\u3089\u306b\u305d\u306e\u4e00\u90e8\u3092\u30cf\u30fc\u30c9\u5b9f\u88c5\u306b\u79fb\u884c\u3059\u308b\u3001\u3001\u3063\u3066\u3053\u3068\u3092\u3084\u3063\u3066\u307f\u308b\u3064\u3082\u308a\u3002\n\u3053\u3053\u307e\u3067\u306b\u66f8\u3044\u305f\u30c9\u30e9\u30a4\u30d0\u30b3\u30fc\u30c9\uff08WIZnet\u306e\u30c9\u30e9\u30a4\u30d0\u306e\u4fee\u6b63\u7248\uff09\u3084HDL\u30b3\u30fc\u30c9\u306fGitHub\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u7f6e\u3044\u3066\u304a\u3044\u305f\u3002\nWIZnet\u306eTCP\u30d7\u30ed\u30bb\u30c3\u30b5[W5300](https://strawberry-linux.com/catalog/items?code=36002)\u3092\u8f09\u305b\u305f\u30dc\u30fc\u30c9[WIZ830MJ](https://strawberry-linux.com/catalog/items?code=36012)\u304c[\u304f\u3055\u308b\u307b\u3069\u5c4a\u3044\u305f](https://plus.google.com/u/0/+KazunoriSato/posts/KzKvWxvPPCH)\u306e\u3067\u3001\u3082\u3063\u305f\u3044\u306a\u3044\u304b\u3089\u306a\u3093\u3068\u304b\u52d5\u304b\u305d\u3046\u3068\u3057\u3066\u3044\u308b\u3002\n\n![Screen Shot 2014-11-09 at 22.42.43.png](https://qiita-image-store.s3.amazonaws.com/0/38290/837a25c7-28b5-82a2-c459-9bfacb7743dc.png)\n\n\u3044\u308d\u3044\u308d\u8a66\u884c\u932f\u8aa4\u306e\u7d50\u679c\u3001[Terasic DE0](http://www.terasic.com.tw/cgi-bin/page/archive.pl?Language=English&No=364)\u4e0a\u306b[Qsys](http://www.altera.co.jp/products/software/quartus-ii/subscription-edition/qsys/qts-qsys.html)\u3067[Nios II\u30d7\u30ed\u30bb\u30c3\u30b5](http://www.altera.co.jp/devices/processor/nios2/ni2-index.html)\u3092\u4f5c\u308a\u3001W5300\u3068\u3064\u306a\u3044\u3067TCP\u30ea\u30b9\u30ca\u30fc\u3092\u4f5c\u308b\u3068\u3053\u308d\u307e\u3067\u52d5\u3044\u305f\u306e\u3067\u3001\u305d\u306e\u624b\u9806\u3092\u3056\u3063\u3068\u307e\u3068\u3081\u3066\u304a\u304f\uff08disclaimer: \u30cf\u30fc\u30c9\u958b\u767a\u306b\u3064\u3044\u3066\u306f\u7d20\u4eba\u306a\u306e\u3067\u3001\u9593\u9055\u3063\u3066\u308b\u90e8\u5206\u3082\u5927\u3044\u306b\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\uff09\u3002\n\n## W5300\u306b\u3064\u3044\u3066\n\nW5300\u306f\u3001WIZnet\u304c\u3051\u3063\u3053\u3046\u6614\u306b\u958b\u767a\u3057\u305f\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u30d9\u30fc\u30b9\u306eTCP/IP\u30d7\u30ed\u30bb\u30c3\u30b5\u3002CPU\u3084OS\u304c\u4e0d\u8981\u306a\u306e\u3067\u3001Linux\u306e\u8f09\u3089\u306a\u3044\u5c0f\u3055\u306a\u30de\u30a4\u30b3\u30f3\u306bTCP\u901a\u4fe1\u6a5f\u80fd\u3092\u6301\u305f\u305b\u308b\u305f\u3081\u306b\u3088\u304f\u7528\u3044\u3089\u308c\u3066\u3044\u308b\u3002\u30b9\u30c8\u30ed\u30d9\u30ea\u30fc\u30fb\u30ea\u30ca\u30c3\u30af\u30b9\u3067\u8a55\u4fa1\u30dc\u30fc\u30c9\u3092\u8cb7\u3046\u30681\u500b2000\u5186\u304f\u3089\u3044\u3002\u4e3b\u8981\u30b9\u30da\u30c3\u30af\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\uff1a\n\n- TCP, UDP, ICMP, ARP, IGMP, PPPoE\u3092\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u5b9f\u88c5\n- 8\u307e\u305f\u306f16\u30d3\u30c3\u30c8\u306e\u30d0\u30b9\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3092\u5099\u3048\u308b\n- DMA\u306b\u5bfe\u5fdc\u3057\u3001\u6700\u592780Mbps\u3067\u52d5\u4f5c\n- \u6700\u59278\u672c\u306e\u30bd\u30b1\u30c3\u30c8\uff08\u30ea\u30b9\u30ca\u307e\u305f\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff09\u306b\u5bfe\u5fdc\n- 128KB\u30d0\u30c3\u30d5\u30a1\u642d\u8f09\n- 10BaseT/100BaseTX\u30b3\u30cd\u30af\u30bf\u88c5\u5099\n\n![Screen Shot 2014-11-09 at 22.58.25.png](https://qiita-image-store.s3.amazonaws.com/0/38290/fa9dd8f5-3710-8c3c-f0a5-b6776ca5f4fa.png)\n\n\u30cf\u30fc\u30c9\u5b9f\u88c5\u3060\u304b\u3089\u4ed5\u65b9\u304c\u306a\u3044\u3051\u3069\u3001\u30bd\u30b1\u30c3\u30c8\u306f8\u672c\u3057\u304b\u4f7f\u3048\u306a\u3044\u3002\u307e\u305f\u4e0b\u4f4d\u88fd\u54c1\u306eW5200/W5100\u306fSPI\u3067\u304a\u624b\u8efd\u306b\u30de\u30a4\u30b3\u30f3\u3068\u3064\u306a\u3052\u3089\u308c\u308b\u4e00\u65b9\u3067\u3001W5300\u306f\u901f\u5ea6\u91cd\u8996\u306e\u305f\u308116\u30d3\u30c3\u30c8\u306e\u30d0\u30b9\u30a4\u30f3\u30bf\u30d5\u30a7\u30fc\u30b9\u3067\u3064\u306a\u3050\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n## DE0\u3068WIZ830MJ\u306e\u63a5\u7d9a\n\n\u307e\u305a\u306f\u3001WIZ830MJ\u306b\u4ed8\u3044\u3066\u3044\u308b2\u3064\u306e28\u30d4\u30f3\u30b3\u30cd\u30af\u30bf\u3092\u3069\u3046\u3084\u3063\u3066DE0\u306b\u7269\u7406\u7684\u306b\u7d50\u7dda\u3059\u308b\u304b\u3092\u8003\u3048\u305f\u3002\n\n![Screen Shot 2014-11-09 at 22.51.16.png](https://qiita-image-store.s3.amazonaws.com/0/38290/c02498cf-8599-d88f-1d86-0750484c1dc4.png)\n\n\u3053\u308c\u3092\u3001[aitendo\u3067\u58f2\u3063\u3066\u308b\u30d4\u30f3\u30d8\u30c3\u30c0\u63a5\u7d9a\u30b1\u30fc\u30d6\u30eb](http://www.aitendo.com/product/2228)\u3092\u4f7f\u3063\u3066\u3072\u305f\u3059\u3089\u4e00\u672c\u305a\u3064DE0\u306eGPIO\u306b\u3064\u306a\u3052\u3066\u304f\u3002\u3053\u3093\u306a\u611f\u3058\uff1a\n\n![Screen Shot 2014-11-10 at 8.46.29.png](https://qiita-image-store.s3.amazonaws.com/0/38290/32cee945-3dcd-5bab-564c-f35e09ff1ccb.png)\n\n\u3053\u3093\u306a\u306b\u305f\u304f\u3055\u3093\u30b1\u30fc\u30d6\u30eb\u633f\u3057\u3066\u3001\u4e00\u672c\u3067\u3082\u65ad\u7dda\u3057\u3066\u3066\u30c7\u30d0\u30c3\u30b0\u3067\u306f\u307e\u3063\u305f\u308a\u3059\u308b\u306e\u306f\u5acc\u3060\u3063\u305f\u306e\u3067\u3001\u5ff5\u306e\u305f\u3081WIZ\u306b\u7e4b\u3044\u3060\u3068\u3053\u308d\u3067\u30c6\u30b9\u30bf\u30fc\u3067\u4e00\u672c\u305a\u3064\u5c0e\u901a\u78ba\u8a8d\u3057\u3066\u304a\u3044\u305f\u3002\n\nDE0\u3068WIZ\u9593\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u306f\u3053\u3093\u306a\u3075\u3046\u306b\u30e1\u30e2\u3063\u3066\u304a\u3044\u3066\u3001\u3042\u3068\u306e\u30d4\u30f3\u30a2\u30b5\u30a4\u30f3\u6642\u306b\u4f7f\u3063\u305f\u3002\u3053\u308c\u30821\u3064\u3067\u3082\u9593\u9055\u3048\u308b\u3068\u30cf\u30de\u308a\u305d\u3046\u3002\n\n![Screen Shot 2014-11-09 at 23.16.56.png](https://qiita-image-store.s3.amazonaws.com/0/38290/a14ad6ec-2a0c-09b9-6a60-4539ade14c40.png)\n\n## \u3068\u308a\u3042\u3048\u305aL\u30c1\u30ab\n\n\u3053\u306e\u30d0\u30b9\u3092\u3069\u3093\u306a\u3075\u3046\u306b\u4f7f\u3046\u306e\u304b\u306f\u3055\u3066\u304a\u304d\u3001\u3068\u308a\u3042\u3048\u305a\u306f\u96fb\u6e90\u3092\u5165\u308c\u3066LED\u304c\u30c1\u30ab\u30c1\u30ab\u3059\u308b\u3068\u3053\u308d\u307e\u3067\u78ba\u8a8d\u3059\u308b\u3002WIZ\u306e\u30d4\u30f3\u304b\u3089\u51fa\u3066\u308bLED\u7528\u306e\u51fa\u529b\uff08Ethernet\u306e\u30ea\u30f3\u30af\u72b6\u614b\u3084Tx/Rx\u52d5\u4f5c\u306a\u3069\uff09\u3092\u305d\u306e\u307e\u307eDE0\u306eLED\u306b\u3064\u306a\u3052\u308bVerilog HDL\u3092\u66f8\u304f\u3002\n\n```\nassign WIZ_BIT16EN = 1'b1; // 16 bit mode\nassign WIZ_RESET_N = RST_N; // reset\nassign LED9 = !WIZ_LINKLED_N;\nassign LED8 = !WIZ_TXLED_N;\nassign LED7 = !WIZ_RXLED_N;\nassign LED6 = !WIZ_COLLED_N;\nassign LED5 = !WIZ_FDXLED_N;\nassign LED4 = !WIZ_SPDLED_N;\nassign LED3 = !WIZ_ACTLED_N;\nassign LED2 = 1'b0;\nassign LED1 = 1'b0;\nassign LED0 = 1'b0;\n```\n\n\u3055\u3089\u306bQuartus\u306ePin Planner\u3067\u306f\u3001\u3055\u3063\u304d\u30e1\u30e2\u3063\u305f\u30de\u30c3\u30d4\u30f3\u30b0\u901a\u308a\u306bLocation\u3092\u8a2d\u5b9a\u3001\u307e\u305f\u3059\u3079\u3066\u306e\u30d4\u30f3\u306eI/O Standard\u3092W5300\u306e\u4ed5\u69d8\u306b\u5408\u308f\u305b\u30663.3-V LVCMOS\u306b\u30bb\u30c3\u30c8\u3059\u308b\u3002\n\n![Screen Shot 2014-11-09 at 23.29.06.png](https://qiita-image-store.s3.amazonaws.com/0/38290/ac1d0e21-270c-d990-4247-7651c40da71c.png)\n\n\uff08Pin Planner\u306e\u753b\u9762\u3063\u3066\u306a\u3093\u304b\u30ab\u30c3\u30b3\u3044\u3044...\uff09\n\n\u3053\u3053\u307e\u3067\u3067\u304d\u305f\u3089DE0\u306e\u96fb\u6e90\u3092\u5165\u308c\u3066\u3001Quartus\u3067\u30b3\u30fc\u30c9\u3092\u30d3\u30eb\u30c9\u3001Programmer\u3067\u6d41\u3057\u3066\u307f\u308b\u3002\u30a4\u30fc\u30b5\u30b1\u30fc\u30d6\u30eb\u3092WIZ\u306e\u30b3\u30cd\u30af\u30bf\u306b\u633f\u3057\u305f\u3089DE0\u306eLED\u304c\u30c1\u30ab\u30c1\u30ab\u3057\u3066\u3001\u3069\u3046\u3084\u3089\u58ca\u308c\u305a\u306b\u52d5\u3044\u3066\u308b\u3089\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3002\u30ea\u30bb\u30c3\u30c8\u30dc\u30bf\u30f3\u3082\u52d5\u3044\u3066\u3044\u308b\u3002\n\n## W5300\u306e\u30d0\u30b9\u306e\u4f7f\u3044\u65b9\n\n\u3055\u3066\u3001\u6700\u5927\u306e\u96e3\u95a2\u306fW5300\u306e\u30d0\u30b9\u3092\u3046\u307e\u304f\u4f7f\u3044\u3053\u306a\u305b\u308b\u304b\u3067\u3042\u308b\u3002\u751f\u307e\u308c\u3066\u3053\u306e\u304b\u305f\u30d0\u30b9\u306a\u3093\u3066\u4f7f\u3063\u305f\u3053\u3068\u306a\u3044\u3002My First Bus! \u307b\u3093\u307e\u306b\u3046\u3054\u304f\u3093\u304b\u3044\u306a\u3002\u3002\n\nW5300\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u898b\u308b\u9650\u308a\u306f\u3001\u3068\u3066\u3082\u30b7\u30f3\u30d7\u30eb\u305d\u3046\u306a\u30d0\u30b9\u3067\u306f\u3042\u308b\u3002\n\n![Screen Shot 2014-11-09 at 23.39.39.png](https://qiita-image-store.s3.amazonaws.com/0/38290/43fae6d0-fbbc-dd27-5424-4d92a4f27709.png)\n\n\u307e\u3042\u3064\u307e\u308a\u3001\n\n- 10\u30d3\u30c3\u30c8\u306e`ADDR`\u306b\u8aad\u307f\u66f8\u304d\u3057\u305f\u3044W5300\u306e\u30ec\u30b8\u30b9\u30bf\u306e\u30a2\u30c9\u30ec\u30b9\u3092\u6e21\u3057\u3066\u3001\n- `CS` (chip select) \u3067\u300c\u3053\u308c\u304b\u3089\u541b\u3068\u901a\u4fe1\u3059\u308b\u3088\u30fc\u300d\u3068\u4f1d\u3048\u3066\u3001\n- `RD` (read) \u3067\u300c\u30c7\u30fc\u30bf\u8aad\u3093\u3067\u30fc\u300d\u3068\u4f1d\u3048\u308b\u3068\u3001\u30a2\u30c9\u30ec\u30b9\u3067\u6307\u5b9a\u3057\u305f\u30ec\u30b8\u30b9\u30bf\u306e\u5024\u304c16\u30d3\u30c3\u30c8\u306e`DATA`\u306b\u8f09\u3063\u3066\u304f\u308b\n\n\u3068\u3044\u3046\u4ed5\u7d44\u307f\u3060\u3002\u56f3\u306b\u66f8\u304f\u3068\u3053\u3093\u306a\u6d41\u308c\uff1a\n\n![Screen Shot 2014-11-09 at 23.44.01.png](https://qiita-image-store.s3.amazonaws.com/0/38290/33327fcd-e95a-e752-c3c5-2bcf3c14a25f.png)\n\n\u3053\u3053\u306b\u66f8\u304b\u308c\u305f`tRD`\u3084\u3089`tDATAs`\u3084\u3089\u3067\u6c7a\u3081\u3089\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u5916\u308c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u4eca\u56de\u3001DE0\u306e\u30af\u30ed\u30c3\u30af\u306f50MHz=20ns\u306a\u306e\u3067\u3001\u4f8b\u3048\u3070`tRD`\u306e\u6700\u5c0f\u502465ns\u3092\u4e0b\u56de\u3089\u306a\u3044\u3088\u3046\u306b`RD`\u306f4\u30af\u30ed\u30c3\u30af\u4ee5\u4e0a\u7dad\u6301\u3059\u308b\u3001\u306a\u3069\u306a\u3069\u3002\n\n### W5300\u306e\u30ec\u30b8\u30b9\u30bf\n\nW5300\u3092\u4f7f\u3046\u306b\u306f\u3001\u3068\u308a\u3042\u3048\u305a\u3053\u306e\u30d0\u30b9\u3092\u7d4c\u7531\u3057\u305f\u30ec\u30b8\u30b9\u30bf\u306e\u8aad\u307f\u66f8\u304d\u3055\u3048\u3067\u304d\u308c\u3070\u3088\u3044\u3002\u5272\u308a\u8fbc\u307f\u4fe1\u53f7`INT`\u3084DMA\u3092\u4f7f\u3046\u3068\u3044\u308d\u3044\u308d\u9ad8\u5ea6\u306a\u3053\u3068\u3082\u3067\u304d\u308b\u3051\u3069\u3001hello world\u3057\u305f\u3044\u6bb5\u968e\u3067\u306f\u3053\u308c\u3089\u306f\u8003\u3048\u306a\u304f\u3066\u3082\u3088\u3044\u3002TCP\u63a5\u7d9a\u306b\u5fc5\u8981\u306a\u30b3\u30de\u30f3\u30c9\u9001\u4fe1\u3084\u72b6\u614b\u7ba1\u7406\u306f\u3059\u3079\u3066\u30ec\u30b8\u30b9\u30bf\u306e\u8aad\u307f\u66f8\u304d\u306e\u307f\u3067\u884c\u3048\u308b\u3002\n\n![Screen Shot 2014-11-09 at 23.53.13.png](https://qiita-image-store.s3.amazonaws.com/0/38290/815c1ad8-b491-8b0b-4fe3-68b60a2ebb69.png)\n\n\u4f8b\u3048\u3070\u30018\u672c\u306e\u30bd\u30b1\u30c3\u30c8\u305d\u308c\u305e\u308c\u306eTCP\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u898b\u308b\u306b\u306f\u3001\u5bfe\u8c61\u306e\u30bd\u30b1\u30c3\u30c8\u306eSocket Status Register (SSR)\u30ec\u30b8\u30b9\u30bf\u3092\u30d0\u30b9\u304b\u3089\u8aad\u3081\u3070\u3088\u3044\u3002\u4ed5\u69d8\u66f8\u306b\u306f\u305d\u306e\u5024\u304c\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u306eTCP\u30b9\u30c6\u30fc\u30bf\u30b9\u306b\u5bfe\u5fdc\u3059\u308b\u304b\u304c\u8a18\u8f09\u3055\u308c\u3066\u3044\u308b\u3002\n\n![Screen Shot 2014-11-09 at 23.57.33.png](https://qiita-image-store.s3.amazonaws.com/0/38290/d92cce65-5a9b-5b61-2edf-4114bed7a868.png)\n\n\u30db\u30b9\u30c8\u5074\u3067\u306f\u3001\u3053\u306e\u72b6\u614b\u306b\u5fdc\u3058\u3066\u6b21\u306b\u51fa\u3059\u3079\u304d\u30b3\u30de\u30f3\u30c9\u3084\u3001\u30bd\u30fc\u30b9\uff0f\u5b9b\u5148IP\u30a2\u30c9\u30ec\u30b9\u7b49\u306e\u30c7\u30fc\u30bf\u3092\u5225\u306e\u30ec\u30b8\u30b9\u30bf\u306b\u66f8\u304d\u8fbc\u307f\u3057\u3066\u3001W5300\u306b\u4ed5\u4e8b\u3092\u4f9d\u983c\u3059\u308b\u3002\u306a\u308b\u307b\u3069\u3001\u539f\u7406\u7684\u306b\u306f\u305d\u3093\u306a\u96e3\u3057\u304f\u306f\u306a\u3055\u305d\u3046\u3060\u3002\n\n## Qsys\u3067Nios II\u3092\u4f5c\u308b\n\n\u305d\u306e\u4ed5\u4e8b\u306e\u4f9d\u983c\u65b9\u6cd5\u306b\u306f\u3001\u4ee5\u4e0b\u306e2\u3064\u304c\u8003\u3048\u3089\u308c\u308b\u3002\n\n- W5300\u306e\u5236\u5fa1\u3092\u3059\u3079\u3066\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u3067\u5b9f\u88c5\u3059\u308b\n- W5300\u3092\u30d0\u30b9\u7d4c\u7531\u3067CPU\u306b\u3064\u306a\u304e\u3001\u5236\u5fa1\u3092\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3067\u5b9f\u88c5\u3059\u308b\n\n\u6211\u304c\u5e2b\u5320\u306e\u307f\u3088\u3057\u3055\u3093\u306f\u3001\u4ed5\u4e8b\u306e\u5408\u9593\u306b\u3042\u3063\u3068\u3044\u3046\u9593\u306b[\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u5b9f\u88c5\u3067W5300\u3092\u52d5\u304b\u3057\u3066](http://wasa-labo.com/wp/?p=112)\u3057\u307e\u3063\u3066\u3044\u305f\u3002\u30d7\u30ed\u3053\u308f\u3044\u3002\u3057\u304b\u3082[Synthesijer](http://synthesijer.sourceforge.net/)\u3068\u3044\u3046\u3001\u307f\u3088\u3057\u3055\u3093\u304a\u624b\u88fd\u306e\u9ad8\u4f4d\u5408\u6210\u30c4\u30fc\u30eb\uff08\u9ad8\u7d1a\u8a00\u8a9e\u304b\u3089\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u8a18\u8ff0\u8a00\u8a9e\u3092\u81ea\u52d5\u751f\u6210\u3059\u308b\u3084\u3064\uff09\u3092\u4f7f\u3063\u3066\u3001[\u3042\u3063\u3055\u308aJava\u3067\u66f8\u3044\u3066\u3042\u308b](https://github.com/miyo/de0nano/blob/master/wiz830mj/WIZ830MJ_Test.java)\u3002\u3053\u308c\u304b\u3089\u306e\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u958b\u767a\u306f\u3053\u3093\u306a\u3075\u3046\u306b\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u3069\u3093\u3069\u3093\u8fd1\u304f\u306a\u3063\u3066\u3044\u304f\u306e\u3060\u308d\u3046\u306a\u30fc\u3002\u3002\n\n\u3057\u304b\u3057\u5e2b\u5320\u306e\u30b3\u30ec\u3092\u305d\u306e\u307e\u3093\u307e\u4f7f\u3063\u305f\u306e\u3067\u306f\u4fee\u884c\u306b\u306a\u3089\u306a\u3044\u306e\u3067\u3001\u4eca\u56de\u306f\u30aa\u30fc\u30bd\u30c9\u30c3\u30af\u30b9\u306b\u5f8c\u8005\u306e\u65b9\u6cd5\u3067\u884c\u304f\u3053\u3068\u306b\u3057\u305f\u3002Quartus\u306b\u4ed8\u5c5e\u306eSoC\u30c4\u30fc\u30ebQsys\u3092\u4f7f\u3063\u3066MIPS\u30d9\u30fc\u30b9CPU\u3067\u3042\u308bNios II\u3092FPGA\u4e0a\u306b\u4f5c\u6210\u3057\u3001\u305d\u306e\u4e0a\u3067C\u3067\u66f8\u3044\u305f\u30b3\u30fc\u30c9\u3092\u52d5\u304b\u3057\u3066\u4e0a\u8ff0\u306e\u3088\u3046\u306aW5300\u306e\u30ec\u30b8\u30b9\u30bf\u306e\u8aad\u307f\u66f8\u304d\u3092\u884c\u3046\u3002\n\n\u3053\u308c\u307e\u3067Qsys\u3082Nios II\u3082\u4f7f\u3063\u305f\u3053\u3068\u304c\u306a\u304b\u3063\u305f\u306e\u3060\u3051\u3069\u3001\u795e\u672c\u300c[FPGA\u30b9\u30bf\u30fc\u30bf\u30fb\u30ad\u30c3\u30c8\u3067\u521d\u4f53\u9a13\uff01\u30aa\u30ea\u30b8\u30ca\u30eb\u30fb\u30de\u30a4\u30b3\u30f3\u4f5c\u308a](http://www.amazon.co.jp/dp/4789848191)\u300d\u306e\u304a\u304b\u3052\u3067\u3001\u3042\u307e\u308a\u5f15\u3063\u304b\u304b\u308b\u3053\u3068\u306a\u304fQsys\u4e0a\u306eNios II\u4f5c\u6210\u3068L\u30c1\u30ab\u307e\u3067\u3092\u9032\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002This is the god's book\u3067\u3042\u308b\u3002\n\n![Screen Shot 2014-11-10 at 0.22.30.png](https://qiita-image-store.s3.amazonaws.com/0/38290/b5d80cf2-bf12-41b5-3900-b800589d8b7b.png)\n\n\u3053\u306e\u672c\u3092\u8aad\u307f\u306a\u304c\u3089\u3001Qsys\u3067Nios II\u3084SDRAM\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u3092\u4f5c\u308a\u3001\u30af\u30ed\u30c3\u30af\u4fe1\u53f7\u3084Avalon\u30d0\u30b9\u3092\u307d\u3061\u307d\u3061UI\u4e0a\u3067\u3064\u306a\u3044\u3067\u3044\u304f\u3002\u3055\u3089\u306bQuartus\u4ed8\u5c5e\u306eEclipse\u3067C\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u3001Qsys\u4e0a\u3067\u9069\u5f53\u306b\u6307\u5b9a\u3057\u305f\u30e1\u30e2\u30ea\u30de\u30c3\u30d7I/O\u306e\u30a2\u30c9\u30ec\u30b9\u306b\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u3068\u3001\u305d\u306eI/O\u306b\u7e4b\u3044\u3060LED\u304c\u30c1\u30ab\u30c1\u30ab\u3057\u305f\u308a\u3059\u308b\u3002\u3053\u308c\u306f\u697d\u3057\u3044\u305e\u3002\u3002Altera\u306b\u304a\u91d1\u3092\u6255\u308f\u305a\u306b\u3053\u3053\u307e\u3067\u3067\u304d\u308b\u306a\u3093\u3066\u3002\n\n![Screen Shot 2014-11-10 at 0.23.53.png](https://qiita-image-store.s3.amazonaws.com/0/38290/0f410ba9-c440-6c2d-8535-e6c4e296ba99.png)\n\n\u307e\u3041\u3001\u30af\u30ed\u30c3\u30af\u306f50MHz\u3060\u3057\u3001\u7121\u511f\u7248\u306eNios II\u306b\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u3082\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3082\u306a\u3044\u306e\u3067\u6fc0\u9045\u3067\u306f\u3042\u308b\u306e\u3060\u3051\u3069\u3002SDRAM\u3068\u306e\u8ee2\u9001\u5e2f\u57df\u3092\u5b9f\u6e2c\u3057\u3066\u307f\u305f\u3089280KB/s\u3060\u3063\u305f\u3002RAM\u306a\u306e\u306b\u3001GCE\u306eLocal SSD\u3088\u308a2500\u500d\u304f\u3089\u3044\u9045\u3044\uff57\n\n### Avalon MM Slave Translator\u3067W5300\u306e\u30d0\u30b9\u5236\u5fa1\n\nQsys\u3067\u306fNios II\u306bAvalon\u3068\u3044\u3046\u30d0\u30b9\u304c\u3064\u306a\u304c\u3063\u3066\u3044\u308b\u306e\u3060\u3051\u3069\u3001Avalon\u3068W5300\u306e\u30d0\u30b9\u306f\u3069\u3046\u3084\u3063\u3066\u3064\u306a\u3052\u3088\u3046\uff1f \u3068\u3001Qsys\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u3044\u308d\u3044\u308d\u63a2\u3057\u305f\u3089\u3001\u3069\u3046\u3084\u3089Avalon MM Slave Translator\u3068\u3044\u3046\u3084\u3064\u3092\u4f7f\u3048\u3070\u3044\u3044\u611f\u3058\u306b\u884c\u3051\u305d\u3046\u3060\u3002\u8a73\u7d30\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u30a6\u30a3\u30b6\u30fc\u30c9\u753b\u9762\u3067\u6307\u5b9a\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u6700\u9069\u69cb\u6210\u3092\u898b\u3064\u3051\u308b\u306e\u306b\u82e6\u52b4\u3057\u305f\u3051\u3069\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3067\u4eca\u306e\u3068\u3053\u308d\u3044\u3044\u611f\u3058\u306e\u52d5\u304d\u306b\u306a\u3063\u3066\u3044\u308b\uff1a\n\n![Screen Shot 2014-11-10 at 0.42.55.png](https://qiita-image-store.s3.amazonaws.com/0/38290/9fa9fcb2-3a00-d096-2234-95ee6f860566.png)\n\n\u30bf\u30a4\u30df\u30f3\u30b0\u307e\u308f\u308a\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u3001\u3068\u308a\u3042\u3048\u305a\u3059\u3079\u30665\u30af\u30ed\u30c3\u30af\u306b\u3057\u3068\u3044\u3066\u3042\u3068\u3067\u8ffd\u3044\u8fbc\u3080\u3064\u3082\u308a\u3002\u3053\u306eTranslator\u306b`wiz0`\u3068\u3044\u3046\u540d\u524d\u3092\u4ed8\u3051\u3066\u3001HDL\u306e\u65b9\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3067W5300\u3068\u7e4b\u3044\u3060\u3002\n\n```\nnios2e u0 (\n\t.clk_clk (CLK),\n\t.reset_reset_n (RST_N),\n\t.wiz0_address\t\t(WIZ_A),\n\t.wiz0_write\t\t(wiz_wr),\n\t.wiz0_read\t\t(wiz_rd),\n\t.wiz0_readdata\t\t(wiz_readdata),\n\t.wiz0_writedata\t\t(wiz_writedata),\n\t.wiz0_chipselect\t(wiz_cs),\n\t.wiz0_byteenable\t(wiz_byteenable)\n);\n\nwire [15:0] wiz_readdata;\nwire [15:0] wiz_writedata;\nwire [1:0] wiz_byteenable;\nwire wiz_cs, wiz_wr, wiz_rd;\nassign WIZ_CS_N = !wiz_cs;\nassign WIZ_WR_N = !(wiz_wr && wiz_byteenable[0] && wiz_byteenable[1]);\nassign WIZ_RD_N = !(wiz_rd && wiz_byteenable[0] && wiz_byteenable[1]);\nassign WIZ_D = (!WIZ_CS_N && !WIZ_WR_N) ? wiz_writedata : 15'bz;\nassign wiz_readdata = (!WIZ_CS_N && !WIZ_RD_N) ? WIZ_D : 15'b0;\n```\n\n\u3053\u3093\u306a\u66f8\u304d\u65b9\u3067\u3088\u3044\u306e\u304b\u4e0d\u660e\u3060\u304c\u3001\u3001W5300\u306e\u30d0\u30b9\u306f\u30c8\u30e9\u30a4\u30b9\u30c6\u30fc\u30c8\u306a\u306e\u3067`CS`\u3068`WR`\u3082\u3057\u304f\u306f`RD`\u304c\u30a4\u30cd\u30fc\u30d6\u30eb\u306e\u6642\u306b\u3060\u3051\u30ea\u30fc\u30c9\u3084\u30e9\u30a4\u30c8\u306e\u30c7\u30fc\u30bf\u3092\u6d41\u3059\u3002\u305d\u308c\u3068\u3001`byteenable`\u304c\u30ef\u30fc\u30c9\u66f8\u304d\u8fbc\u307f\u306e\u6642\u3060\u3051\u5bfe\u5fdc\u3059\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\nW5300\u306e\u30d0\u30b9\u306b\u306fbyteenable\u304c\u306a\u3044\u306e\u3067\u3001\u3053\u3046\u3044\u3046\u3068\u304d\u3069\u3046\u3059\u308c\u3070\u3088\u3044\u306e\u3060\u308d\u3046\uff1f \u3068\u60a9\u3093\u3060\u3002Nios II\u4e0a\u306e\u30b3\u30fc\u30c9\u304b\u3089`(char *)`\u306e\u30dd\u30a4\u30f3\u30bf\u3092\u4f7f\u3044\u3001\u30d0\u30a4\u30c8\u5358\u4f4d\u3067\u66f8\u304d\u8fbc\u307f\u3059\u308b\u3068\u3001`byteenable`\u306b\u306f\u30d0\u30a4\u30c8\u5358\u4f4d\u66f8\u304d\u8fbc\u307f\u306e\u30d5\u30e9\u30b0\u304c\u7acb\u3064\u3002\u3064\u307e\u308a\u30011\u30d0\u30a4\u30c8\u3060\u3051\u66f4\u65b0\u3057\u305f\u3044\u3002\u3057\u304b\u3057W5300\u306f1\u30ef\u30fc\u30c9\uff082\u30d0\u30a4\u30c8\uff09\u5358\u4f4d\u3067\u3057\u304b\u66f8\u304d\u8fbc\u307f\u3067\u304d\u306a\u3044\u3002\u306a\u306e\u3067\u3001\u3044\u3061\u3069\u5bfe\u8c61\u30ef\u30fc\u30c9\u3092\u8aad\u3093\u3067\u3001\u305d\u306e\u3046\u30611\u30d0\u30a4\u30c8\u306e\u307f\u66f8\u304d\u63db\u3048\u3001\u3075\u305f\u305f\u3073\u30ef\u30fc\u30c9\u5358\u4f4d\u3067\u66f8\u304d\u623b\u3059\u3068\u3044\u3046read-modify-write\u306e\u52d5\u4f5c\u304c\u5fc5\u8981\u306b\u306a\u308b\u3002\u3053\u308c\u3063\u3066I/O\u5074\u3067\u304c\u3093\u3070\u3063\u3066\u30cf\u30fc\u30c9\u5b9f\u88c5\u3059\u3079\u304d\u306a\u306e\u304b\u306a\uff1f \u3068\u8b58\u8005\u306e\u7686\u3055\u3093\u306b\u805e\u3044\u3066\u307f\u305f\u3089\u3001\u305f\u3051\u3080\u3089\u5e2b\u5320\u3068\u3068\u3088\u3057\u307e\u5e2b\u5320\u304b\u3089\u300c\u305d\u3046\u3044\u3046\u306e\u306fI/O\u5074\u3067\u52dd\u624b\u306b\u3084\u3089\u305a\u306b\u30db\u30b9\u30c8\u5074\u3067\u3084\u308b\u306e\u304c\u5e38\u9053\u300d\u3068\u306e\u30a2\u30c9\u30d0\u30a4\u30b9\u3092\u3044\u305f\u3060\u3044\u305f\u3002\u3068\u3044\u3046\u308f\u3051\u3067\u3001I/O\u5074\u3067\u306f\u30d0\u30a4\u30c8\u5358\u4f4d\u66f8\u304d\u8fbc\u307f\u306b\u306f\u5bfe\u5fdc\u3057\u306a\u3044\u3053\u3068\u306b\u3057\u305f\u3002C\u30b3\u30fc\u30c9\u304b\u3089\u306f`(unsigned short *)`\u306e\u307f\u3067\u8aad\u307f\u66f8\u304d\u3059\u308b\u3002\n\n\u3053\u306e\u3042\u305f\u308a\u306e\u30c7\u30d0\u30c3\u30b0\u306fQuartus\u4ed8\u5c5e\u306eSignalTap\u306a\u3057\u3067\u306f\u4e0d\u53ef\u80fd\u3002\u3082\u3063\u3068\u3061\u3083\u3093\u3068\u3057\u305f\u30c7\u30d0\u30c3\u30b0\u74b0\u5883\u3092\u6574\u3048\u308b\u305f\u3081\u306b\u3001\u5b9f\u6a5f\u3067\u306a\u304f\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u30fc\u3092\u4f7f\u304a\u3046\u304b\u306a\u3068\u3082\u8003\u3048\u305f\u3051\u3051\u3069\u3001\u3072\u3068\u901a\u308a\u306e\u30e2\u30c7\u30eb\u3092\u7528\u610f\u3059\u308b\u306e\u304c\u9762\u5012\u306a\u306e\u3067\u3068\u308a\u3042\u3048\u305a\u5b9f\u6a5f\uff0bSignalTap\u3067\u3002\n\nNios II\u306eEclipse\u4e0a\u3067`Nios II Application and BSP from Template`\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3001hello world\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f7f\u3063\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u3001W5300\u3092\u30bd\u30d5\u30c8\u30ea\u30bb\u30c3\u30c8\u3057\u3066\u307f\u305f\u3002\n\n```\n  volatile unsigned short *p = WIZ0_BASE + 0x000; // W5300 base address + 0x000 register\n  *p = *p | 0b10000000; // setting the reset flag\n```\n\n\u3046\u307e\u304f\u30ea\u30bb\u30c3\u30c8\u3055\u308c\u3001\u30ec\u30b8\u30b9\u30bf\u304b\u3089\u8aad\u307f\u8fbc\u3093\u3060\u5024\u306e\u5185\u5bb9\u3082OK\u3002SignalTap\u3067\u3082\u3001\u60f3\u5b9a\u3069\u304a\u308a\u306b\u52d5\u3044\u3066\u308b\u3063\u307d\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u305f\u3002\n\n![Screen Shot 2014-11-10 at 1.59.41.png](https://qiita-image-store.s3.amazonaws.com/0/38290/08f506bc-5bb0-f3db-0fb3-3e1fed1cf29a.png)\n\n## WIZnet\u306e\u30c9\u30e9\u30a4\u30d0\u30b3\u30fc\u30c9\u3092\u52d5\u304b\u3059\n\n\u3053\u308c\u3067C\u30b3\u30fc\u30c9\u304b\u3089W5300\u306e\u30ec\u30b8\u30b9\u30bf\u3092\u81ea\u7531\u306b\u8aad\u307f\u66f8\u304d\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3051\u3069\u3001\u30ec\u30b8\u30b9\u30bf\u306e\u4ed5\u69d8\u3092\u8aad\u3080\u3068\u7d50\u69cb\u7d30\u3005\u3068\u3057\u305f\u72b6\u614b\u9077\u79fb\u7ba1\u7406\u3084\u30d3\u30c3\u30c8\u64cd\u4f5c\u304c\u5fc5\u8981\u305d\u3046\u3067\u3001\u3059\u3079\u3066\u3092\u81ea\u5206\u3067\u66f8\u304f\u306e\u306f\u9762\u5012\u305d\u3046\u3002\u3057\u304b\u3057\u3042\u308a\u304c\u305f\u3044\u3053\u3068\u306b\u3001WIZnet\u306e\u30b5\u30a4\u30c8\u304b\u3089C\u3067\u66f8\u304b\u308c\u305f[\u30c9\u30e9\u30a4\u30d0\u30b3\u30fc\u30c9](http://www.wiznet.co.kr/sub_modules/en/product/product_detail.asp?Refid=681&page=1&cate1=5&cate2=7&cate3=25&pid=1012&cType=2)\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n\u3053\u306e\u30c9\u30e9\u30a4\u30d0\u306f\u3069\u3046\u3084\u3089Xscale\u30de\u30a4\u30b3\u30f3\u7528\u306b\u66f8\u304b\u308c\u305f\u3082\u306e\u306e\u3088\u3046\u3067\u3001\u305d\u306e\u307e\u307e\u3067\u306f\u30ed\u30b0\u51fa\u529b\u306eprintf\u307e\u308f\u308a\u304c\u5f15\u3063\u304b\u304b\u3063\u3066\u52d5\u304b\u306a\u3044\u3002Altera\u63d0\u4f9b\u306ealt_printf\u3068\u5dee\u3057\u66ff\u3048\u305f\u308a\u3061\u3087\u3053\u3061\u3087\u3053\u76f4\u3057\u305f\u308a\u3057\u3066\u52d5\u3044\u305f\u3002\n\n\u3053\u308c\u3092\u4f7f\u3046\u3068\u3001TCP\u30bd\u30b1\u30c3\u30c8\u306e\u4f5c\u6210\u3092\u3068\u3066\u3082\u7c21\u5358\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u305f\u3002\n\n```\nsetSIPR({ 192, 168, 1, 250 }); // set source IP address\nsetGAR({ 192, 168, 1, 1 }); // set gateway IP address\nsetSUBR({ 255, 255, 255, 0 }); // set subnet mask address\nsetSHAR({ 0x00, 0x08, 0xDC, 0x00, 111, 200 }); // set source hardware address\n```\n\n\u3068\u3044\u3046\u611f\u3058\u306b\u30bd\u30fc\u30b9IP\u30a2\u30c9\u30ec\u30b9\u3084\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u3001\u30b5\u30d6\u30cd\u30c3\u30c8\u30de\u30b9\u30af\u3001MAC\u30a2\u30c9\u30ec\u30b9\u7b49\u3092\u30ec\u30b8\u30b9\u30bf\u306b\u30bb\u30c3\u30c8\u3057\u3066\u3001`main.c`\u306b\u3042\u308b\u30eb\u30fc\u30d7\u30d0\u30c3\u30af\u30c6\u30b9\u30c8\u7528\u306e\u95a2\u6570`loopback_tcps()`\u3092\u547c\u3073\u51fa\u305b\u3070\u3001\u6307\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\u756a\u53f7\u3067TCP\u30ea\u30b9\u30ca\u30fc\u3092\u4f5c\u6210\u3067\u304d\u308b\u3002\n\n```\nloopback_tcps(0, 5000, data_buf, 0);\n```\n\n\u63a5\u7d9a\u30c6\u30b9\u30c8\u306e\u305f\u3081\u3001PC\u304b\u3089telnet\u3067\u3064\u306a\u3044\u3067\u307f\u308b\u3002\n\n```\n$ telnet 192.168.1.250 5000\nTrying 192.168.1.250...\nConnected to 192.168.1.250.\nEscape character is '^]'.\nhello\nhello\nworld\nworld\n```\n\n\u9069\u5f53\u306a\u6587\u5b57\u5217\u3092\u53e9\u304f\u3068\u305d\u306e\u307e\u307e\u30a8\u30b3\u30fc\u30d0\u30c3\u30af\u3055\u308c\u3066\u304d\u305f\u3002\u3044\u3048\u30fc\u3044\u3001\u52d5\u3044\u305f\u305c\uff01\uff01\uff01\n\n## \u3053\u308c\u304b\u3089\u306e\u91ce\u671b\n\n\u3068\u308a\u3042\u3048\u305aCPU\u4e0a\u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u304b\u3089W5300\u3092\u5236\u5fa1\u3057\u3066hello world\u3059\u308b\u3068\u3044\u3046\u7b2c\u4e00\u76ee\u6a19\u306f\u9054\u3057\u305f\u3002\u3053\u308c\u304b\u3089\u306fTCP\u3088\u308a\u4e0a\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u30bd\u30d5\u30c8\u3067\u5b9f\u88c5\u3057\u3001\u3055\u3089\u306b\u305d\u306e\u4e00\u90e8\u3092\u30cf\u30fc\u30c9\u5b9f\u88c5\u306b\u79fb\u884c\u3059\u308b\u3001\u3001\u3063\u3066\u3053\u3068\u3092\u3084\u3063\u3066\u307f\u308b\u3064\u3082\u308a\u3002\n\n\u3053\u3053\u307e\u3067\u306b\u66f8\u3044\u305f\u30c9\u30e9\u30a4\u30d0\u30b3\u30fc\u30c9\uff08WIZnet\u306e\u30c9\u30e9\u30a4\u30d0\u306e\u4fee\u6b63\u7248\uff09\u3084HDL\u30b3\u30fc\u30c9\u306f[GitHub\u30ea\u30dd\u30b8\u30c8\u30ea](https://github.com/kazunori279/hdllesson/tree/master/Wiz)\u306b\u7f6e\u3044\u3066\u304a\u3044\u305f\u3002\n\n\n", "tags": ["FPGA", "Altera", "IoT"]}