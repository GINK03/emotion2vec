{"context": "milkcocoa\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u53c2\u8003\u306b\u3001\u30b9\u30de\u30db\u306e\u50be\u304d(\u753b\u9762\u72b6\u6cc1)\u3067\u30e9\u30ba\u30d1\u30a4\u306b\u7e4b\u3044\u3060\u30b5\u30fc\u30dc\u30e2\u30fc\u30bf\u3092\u5236\u5fa1\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nQiita\u521d\u6295\u7a3f\u306e\u305f\u3081\u3001\u898b\u3065\u3089\u304b\u3063\u305f\u308a\u3001\u5909\u306a\u6240\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u305d\u306e\u70b9\u306f\u3054\u6307\u6458\u9802\u3051\u305f\u3089\u5e78\u3044\u3067\u3059\u3002\n\n\u4eca\u56de\u4f7f\u7528\u3057\u305f\u3082\u306e\n\u30fbRaspberry Pi2 Model B\n\u30fb\u30b5\u30fc\u30dc\u30e2\u30fc\u30bf EK2-0500\n\u30fbNode.js\n\u30fbHeroku\n\u30fbMilkcocoa\n\u30e9\u30ba\u30d1\u30a4\u5468\u308a\u306e\u914d\u7dda\u306f\u3053\u3093\u306a\u611f\u3058\u3002\u30b5\u30fc\u30dc\u306e\u96fb\u6e90\u306f\u30e9\u30ba\u30d1\u30a4\u306evdd\u304b\u3089\u53d6\u308b\u3053\u3068\u306b\u3057\u307e\u3059(\u8907\u6570\u4f7f\u3046\u5834\u5408\u306f\u5916\u90e8\u96fb\u6e90\u3092\u7528\u610f\u3057\u3066\u4e0b\u3055\u3044)\u3002\n\n\u30b5\u30fc\u30dc\u306e\u4fe1\u53f7\u7dda\u306fGPIO18\u306e\u30d4\u30f3\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u4eca\u56de\u306fServoBlaster\u3092\u7528\u3044\u3066\u30b5\u30fc\u30dc\u5236\u5fa1\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30b9\u30de\u30db\u5074\nHeroku\u306bNode.js\u3067\u66f8\u3044\u305fWeb\u30a2\u30d7\u30ea\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3057\u305f\u3002\u4eca\u56de\u306fexpress(\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30a8\u30f3\u30b8\u30f3\u306fejs)\u3067\u96db\u5f62\u3092\u4f5c\u3063\u3066\u3001\u305d\u3053\u306bmilkcocoa\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u4f7f\u308f\u308c\u3066\u3044\u305f\u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u4f7f\u3044\u307e\u3057\u305f(\u3082\u3061\u308d\u3093uer_id\u306e\u307f\u81ea\u5206\u306e\u7269\u306b\u5909\u66f4)\u3002\n\u3053\u3053\u3067\u306fheroku\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u3001express\u306e\u5c0e\u5165\u30fb\u8aac\u660e\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n\nindex.ejs\n<body>\n<div id=\"output\"></div>\n<script src='https://cdn.mlkcca.com/v0.6.0/milkcocoa.js'></script>\n<script src=\"javascripts/main-sp.js\"></script>\n</body>\n\n\n\nmain-sp.js\nwindow.onload = function(){\n\n  var currentMode = 'portrait';\n  var output = document.getElementById('output');\n\n  // app_id\u306f\u81ea\u5206\u306e\u3082\u306e\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n  var milkcocoa = new MilkCocoa('app_id');\n  var ds = milkcocoa.dataStore('inclination');\n\n  window.addEventListener('devicemotion', function(e){\n    gravity = e.accelerationIncludingGravity;\n\n    output.innerHTML\n    = 'x\u65b9\u5411: '+gravity.x\n    + '<br>y\u65b9\u5411: '+gravity.y;\n\n    sendModeFromGravityValue(gravity);\n\n  },true);\n\n\n  function sendModeFromGravityValue(g){\n\n    // \u7d76\u5bfe\u5024\u3092\u53d6\u5f97\n    var x = Math.sqrt(g.x * g.x);\n    var y = Math.sqrt(g.y * g.y);\n\n    // portrait -> landscape\n    if(currentMode === 'portrait' && x > 8.5 && y < 1.5){\n      currentMode = 'landscape';\n      ds.send({mode: currentMode});\n    }\n\n    // landscape -> portrait\n    if(currentMode === 'landscape' && x < 1.5 && y > 8.5){\n      currentMode = 'portrait';\n      ds.send({mode: currentMode});\n    }\n  }\n};\n\n\n\u3042\u3068app.js\u306bmilkcocoa\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u8aad\u307f\u8fbc\u307e\u305b\u307e\u3059\u3002\n\napp.js\n//\u30e2\u30b8\u30e5\u30fc\u30eb\u8aad\u307f\u8fbc\u307f\u306e\u884c\u306e\u6700\u5f8c\u306b\u8ffd\u52a0\nvar MilkCocoa = require('milkcocoa');\n\n\n\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30b9\u30de\u30db\u306eX\u8ef8\u3068Y\u8ef8\u306e\u50be\u304d\u306e\u5024\u304c\u5de6\u4e0a\u306b\u51fa\u3066\u304f\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u306e\u5024\u3092\u5143\u306b\u30b9\u30de\u30db\u304c\u7e26\u304b\u6a2a\u306e\u72b6\u614b\u5224\u65ad\u3092\u884c\u3044\u3001\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u306b\u3042\u308b\"inclination\"\u306e\u5024\u304c\u5909\u5316\u3057\u307e\u3059\u3002\n\n\u30e9\u30ba\u30d1\u30a4\u5074\n\u307e\u305a\u9069\u5f53\u306b\u4f5c\u3063\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a9\u30eb\u30c0\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7528\u610f\u3057\u307e\u3059\u3002\nnpm init\nnpm install milkcocoa\nnpm install servoblaster\n\u305d\u3046\u3057\u305f\u3089servo.js\u3068\u3057\u3066\u5b9f\u884c\u30d7\u30e9\u30b0\u30e9\u30e0\u3092\u66f8\u304d\u307e\u3059\u3002\n\nservo.js\nvar MilkCocoa = require('milkcocoa');\nvar servoblaster = require('servoblaster');\n\n//\u30b5\u30fc\u30dc\u756a\u53f7\uff12(GPIO18)\u306e\u30b5\u30fc\u30dc\u30e2\u30fc\u30bf\u3092\u4f7f\u7528\u3092\u5ba3\u8a00\nvar stream = servoblaster.createWriteStream(2);\n\n//use_id\u306f\u81ea\u5206\u306e\u7269\u306b\u66f8\u304d\u63db\u3048\u3066\u4e0b\u3055\u3044\nvar milkcocoa = new MilkCocoa('use_is');\nvar ds = milkcocoa.dataStore('inclination');\n\nds.on(\"send\", chengeInclination);\n\nfunction chengeInclination(sent){\n    if(sent.value.mode === 'portrait'){\n      //\u30b5\u30fc\u30dc\u306e\u89d2\u5ea6\u3092130\u306b\u8a2d\u5b9a(\u4e2d\u5fc3150\u3002\u3053\u306e\u5834\u5408\u306f\u5de6\u56de\u8ee2)\n      //\u306a\u304a\u3053\u306e\u5024\u306f\u30b5\u30fc\u30dc\u30e2\u30fc\u30bf\u306b\u3088\u3063\u3066\u7570\u306a\u308b\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n      stream.write(130);\n    }\n    if(sent.value.mode === 'landscape'){\n      //\u30b5\u30fc\u30dc\u306e\u89d2\u5ea6\u3092200\u306b\u8a2d\u5b9a(\u53f3\u56de\u8ee2)\n      stream.write(200); \n    }\n}\n\n\nServoBlaster\u306e\u30b5\u30fc\u30dc\u756a\u53f7\u3068\u30d4\u30f3\u306e\u95a2\u4fc2\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\uff08\u30b5\u30fc\u30dc\u756a\u53f7\u306e3\u756a\u306b\u3064\u3044\u3066\u306fRaspberry Pi\u306e\u30ea\u30d3\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066GPIO\u306e21\u304b27\u306b\u306a\u308b\u305d\u3046\u3067\u3059\u3002\uff09\n\n\n\n\u30b5\u30fc\u30dc\u756a\u53f7\nGPIO\u756a\u53f7\n\n\n\n\n0\n4\n\n\n1\n17\n\n\n2\n18\n\n\n3\n21/27\n\n\n4\n22\n\n\n5\n23\n\n\n6\n24\n\n\n7\n25\n\n\n\nnode servo.js\u3067\u8d77\u52d5\u3002\n\u30b9\u30de\u30db\u3067\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u30a2\u30d7\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3001 \u30b9\u30de\u30db\u306e\u753b\u9762\u3092\u6a2a\u306b\u3057\u305f\u308a\u7e26\u306b\u3059\u308b\u3068\u30b5\u30fc\u30dc\u304c\u52d5\u304d\u307e\u3059\u3002\n\u4eca\u5f8c\u306f\u30b9\u30de\u30db\u306e\u89d2\u5ea6\u3068\u30b5\u30fc\u30dc\u306e\u89d2\u5ea6\u3092\u540c\u671f\u3055\u305b\u3066\u4f55\u304b\u4f5c\u3063\u3066\u307f\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u306b\u306a\u3063\u305f\u8a18\u4e8betc.\n\u30fbServoBlaster\u95a2\u9023\n\u3000http://oohito.com/nqthm/archives/2151\n\u3000https://www.npmjs.com/package/servoblaster\n\u30fbmilkcocoa\u95a2\u9023\n\u3000https://mlkcca.com/tutorial/page1.html\nmilkcocoa\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u53c2\u8003\u306b\u3001\u30b9\u30de\u30db\u306e\u50be\u304d(\u753b\u9762\u72b6\u6cc1)\u3067\u30e9\u30ba\u30d1\u30a4\u306b\u7e4b\u3044\u3060\u30b5\u30fc\u30dc\u30e2\u30fc\u30bf\u3092\u5236\u5fa1\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nQiita\u521d\u6295\u7a3f\u306e\u305f\u3081\u3001\u898b\u3065\u3089\u304b\u3063\u305f\u308a\u3001\u5909\u306a\u6240\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u305d\u306e\u70b9\u306f\u3054\u6307\u6458\u9802\u3051\u305f\u3089\u5e78\u3044\u3067\u3059\u3002\n\n##\u4eca\u56de\u4f7f\u7528\u3057\u305f\u3082\u306e\n\u30fbRaspberry Pi2 Model B\n\u30fb\u30b5\u30fc\u30dc\u30e2\u30fc\u30bf EK2-0500\n\u30fbNode.js\n\u30fbHeroku\n\u30fbMilkcocoa\n\n\u30e9\u30ba\u30d1\u30a4\u5468\u308a\u306e\u914d\u7dda\u306f\u3053\u3093\u306a\u611f\u3058\u3002\u30b5\u30fc\u30dc\u306e\u96fb\u6e90\u306f\u30e9\u30ba\u30d1\u30a4\u306evdd\u304b\u3089\u53d6\u308b\u3053\u3068\u306b\u3057\u307e\u3059(\u8907\u6570\u4f7f\u3046\u5834\u5408\u306f\u5916\u90e8\u96fb\u6e90\u3092\u7528\u610f\u3057\u3066\u4e0b\u3055\u3044)\u3002\n![zu1.png](https://qiita-image-store.s3.amazonaws.com/0/90062/1986825d-dde1-6d7a-3686-750c683e3390.png)\n\u30b5\u30fc\u30dc\u306e\u4fe1\u53f7\u7dda\u306fGPIO18\u306e\u30d4\u30f3\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u3002\u4eca\u56de\u306fServoBlaster\u3092\u7528\u3044\u3066\u30b5\u30fc\u30dc\u5236\u5fa1\u3092\u884c\u3044\u307e\u3059\u3002\n\n##\u30b9\u30de\u30db\u5074\nHeroku\u306bNode.js\u3067\u66f8\u3044\u305fWeb\u30a2\u30d7\u30ea\u3092\u30c7\u30d7\u30ed\u30a4\u3057\u307e\u3057\u305f\u3002\u4eca\u56de\u306fexpress(\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30a8\u30f3\u30b8\u30f3\u306fejs)\u3067\u96db\u5f62\u3092\u4f5c\u3063\u3066\u3001\u305d\u3053\u306bmilkcocoa\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u4f7f\u308f\u308c\u3066\u3044\u305f\u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u4f7f\u3044\u307e\u3057\u305f(\u3082\u3061\u308d\u3093uer_id\u306e\u307f\u81ea\u5206\u306e\u7269\u306b\u5909\u66f4)\u3002\n\u3053\u3053\u3067\u306fheroku\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u3001express\u306e\u5c0e\u5165\u30fb\u8aac\u660e\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n\n```index.ejs\n<body>\n<div id=\"output\"></div>\n<script src='https://cdn.mlkcca.com/v0.6.0/milkcocoa.js'></script>\n<script src=\"javascripts/main-sp.js\"></script>\n</body>\n```\n\n```main-sp.js\nwindow.onload = function(){\n\n  var currentMode = 'portrait';\n  var output = document.getElementById('output');\n\n  // app_id\u306f\u81ea\u5206\u306e\u3082\u306e\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\n  var milkcocoa = new MilkCocoa('app_id');\n  var ds = milkcocoa.dataStore('inclination');\n\n  window.addEventListener('devicemotion', function(e){\n    gravity = e.accelerationIncludingGravity;\n\n    output.innerHTML\n    = 'x\u65b9\u5411: '+gravity.x\n    + '<br>y\u65b9\u5411: '+gravity.y;\n\n    sendModeFromGravityValue(gravity);\n\n  },true);\n\n\n  function sendModeFromGravityValue(g){\n\n    // \u7d76\u5bfe\u5024\u3092\u53d6\u5f97\n    var x = Math.sqrt(g.x * g.x);\n    var y = Math.sqrt(g.y * g.y);\n\n    // portrait -> landscape\n    if(currentMode === 'portrait' && x > 8.5 && y < 1.5){\n      currentMode = 'landscape';\n      ds.send({mode: currentMode});\n    }\n\n    // landscape -> portrait\n    if(currentMode === 'landscape' && x < 1.5 && y > 8.5){\n      currentMode = 'portrait';\n      ds.send({mode: currentMode});\n    }\n  }\n};\n```\n\u3042\u3068`app.js`\u306bmilkcocoa\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u8aad\u307f\u8fbc\u307e\u305b\u307e\u3059\u3002\n\n```app.js\n//\u30e2\u30b8\u30e5\u30fc\u30eb\u8aad\u307f\u8fbc\u307f\u306e\u884c\u306e\u6700\u5f8c\u306b\u8ffd\u52a0\nvar MilkCocoa = require('milkcocoa');\n```\n\n\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u3001\u30b9\u30de\u30db\u306eX\u8ef8\u3068Y\u8ef8\u306e\u50be\u304d\u306e\u5024\u304c\u5de6\u4e0a\u306b\u51fa\u3066\u304f\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u306e\u5024\u3092\u5143\u306b\u30b9\u30de\u30db\u304c\u7e26\u304b\u6a2a\u306e\u72b6\u614b\u5224\u65ad\u3092\u884c\u3044\u3001\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u306b\u3042\u308b\"inclination\"\u306e\u5024\u304c\u5909\u5316\u3057\u307e\u3059\u3002\n\n##\u30e9\u30ba\u30d1\u30a4\u5074\n\u307e\u305a\u9069\u5f53\u306b\u4f5c\u3063\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30d5\u30a9\u30eb\u30c0\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7528\u610f\u3057\u307e\u3059\u3002\n`npm init`\n`npm install milkcocoa`\n`npm install servoblaster`\n\u305d\u3046\u3057\u305f\u3089servo.js\u3068\u3057\u3066\u5b9f\u884c\u30d7\u30e9\u30b0\u30e9\u30e0\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```servo.js\nvar MilkCocoa = require('milkcocoa');\nvar servoblaster = require('servoblaster');\n\n//\u30b5\u30fc\u30dc\u756a\u53f7\uff12(GPIO18)\u306e\u30b5\u30fc\u30dc\u30e2\u30fc\u30bf\u3092\u4f7f\u7528\u3092\u5ba3\u8a00\nvar stream = servoblaster.createWriteStream(2);\n\n//use_id\u306f\u81ea\u5206\u306e\u7269\u306b\u66f8\u304d\u63db\u3048\u3066\u4e0b\u3055\u3044\nvar milkcocoa = new MilkCocoa('use_is');\nvar ds = milkcocoa.dataStore('inclination');\n\nds.on(\"send\", chengeInclination);\n\nfunction chengeInclination(sent){\n    if(sent.value.mode === 'portrait'){\n      //\u30b5\u30fc\u30dc\u306e\u89d2\u5ea6\u3092130\u306b\u8a2d\u5b9a(\u4e2d\u5fc3150\u3002\u3053\u306e\u5834\u5408\u306f\u5de6\u56de\u8ee2)\n      //\u306a\u304a\u3053\u306e\u5024\u306f\u30b5\u30fc\u30dc\u30e2\u30fc\u30bf\u306b\u3088\u3063\u3066\u7570\u306a\u308b\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n      stream.write(130);\n    }\n    if(sent.value.mode === 'landscape'){\n      //\u30b5\u30fc\u30dc\u306e\u89d2\u5ea6\u3092200\u306b\u8a2d\u5b9a(\u53f3\u56de\u8ee2)\n      stream.write(200); \n    }\n}\n```\n\nServoBlaster\u306e\u30b5\u30fc\u30dc\u756a\u53f7\u3068\u30d4\u30f3\u306e\u95a2\u4fc2\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\uff08\u30b5\u30fc\u30dc\u756a\u53f7\u306e3\u756a\u306b\u3064\u3044\u3066\u306fRaspberry Pi\u306e\u30ea\u30d3\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066GPIO\u306e21\u304b27\u306b\u306a\u308b\u305d\u3046\u3067\u3059\u3002\uff09\n\n| \u30b5\u30fc\u30dc\u756a\u53f7 | GPIO\u756a\u53f7 |\n|:-----------:|:------------:|\n| 0 | 4 |\n| 1 | 17 |\n| 2 | 18 |\n| 3 | 21/27 |\n| 4 | 22 |\n| 5 | 23 |\n| 6 | 24 |\n| 7 | 25 |\n\n`node servo.js`\u3067\u8d77\u52d5\u3002\n\u30b9\u30de\u30db\u3067\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u30a2\u30d7\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3001 \u30b9\u30de\u30db\u306e\u753b\u9762\u3092\u6a2a\u306b\u3057\u305f\u308a\u7e26\u306b\u3059\u308b\u3068\u30b5\u30fc\u30dc\u304c\u52d5\u304d\u307e\u3059\u3002\n\n\u4eca\u5f8c\u306f\u30b9\u30de\u30db\u306e\u89d2\u5ea6\u3068\u30b5\u30fc\u30dc\u306e\u89d2\u5ea6\u3092\u540c\u671f\u3055\u305b\u3066\u4f55\u304b\u4f5c\u3063\u3066\u307f\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n##\u53c2\u8003\u306b\u306a\u3063\u305f\u8a18\u4e8betc.\n\u30fbServoBlaster\u95a2\u9023\n\u3000http://oohito.com/nqthm/archives/2151\n\u3000https://www.npmjs.com/package/servoblaster\n\u30fbmilkcocoa\u95a2\u9023\n\u3000https://mlkcca.com/tutorial/page1.html\n\n\n", "tags": ["RaspberryPi", "Node.js", "milkcocoa", "Heroku"]}