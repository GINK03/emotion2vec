{"context": "Google Spreadsheet\u81ea\u4f53\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u4ee5\u4e0b\u8a18\u8f09\u3057\u307e\u3059\u3002\nOAuth\u306e\u8a2d\u5b9a\u3001\u304a\u3088\u3073\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nPython\u304b\u3089OAuth2.0\u3092\u5229\u7528\u3057\u3066\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\n\u307e\u305f\u3001Google Spreadsheet\u306e\u4f5c\u6210\u81ea\u4f53\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\ndocs_v3_example.py\nCreate new spreadsheet (Google API / Python)\nPython 2.7.10, gdata 2.0.18\u306e\u74b0\u5883\u3067\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nfrom oauth2client.service_account import ServiceAccountCredentials\nimport gdata.docs.client\n\n# name definitions\nAPP_NAME = 'GDataDocumentsAPISample'\nname_spr = 'Sample Spreadsheet'\n\n# resources for credential\njson_key = 'gspread-test.json'\nscope = ['https://docs.google.com/feeds']\n\n# create goole data docs client\nclient = gdata.docs.client.DocsClient(source=APP_NAME)\nclient.http_client.debug = True\n#client.http_client.debug = False\n\n# create credentials\ncredentials = ServiceAccountCredentials.from_json_keyfile_name(json_key, scope)\nauth_token = gdata.gauth.OAuth2TokenFromCredentials(credentials)\n\n# authorise\nauth_token.authorize(client)\n\n# create document as spreadsheet\ndocument = gdata.docs.data.Resource(type='spreadsheet', title=name_spr)\ndocument = client.CreateResource(document)\n\n# add ACL to  spreadsheet\nacl_entry = gdata.docs.data.AclEntry(\n    scope=gdata.acl.data.AclScope(value='hoge@foo.bar', type='user'),\n    role=gdata.acl.data.AclRole(value='writer'),\n)\nclient.AddAclEntry(document, acl_entry, send_notifications=False)\n\nprint('Created:', document.title.text, document.resource_id.text)\n\n\u5c11\u3057\u30cf\u30de\u3063\u305f\u3068\u3053\u308d\u3068\u3057\u3066\u2026\u3000Oauth\u3092\u5b9f\u884c\u3059\u308b\u5834\u5408\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u306f\u81ea\u5206\u306eGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u306f\u7570\u306a\u308a\u3001name@projectname.iam.gserviceaccount.com \u304cowner\u3068\u306a\u308a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067private\u306a\u306e\u3067acl_entry\u3092\u8a2d\u5b9a\u3057\u3066\u3084\u3089\u306a\u3044\u3068Google Drive\u4e0a\u3067Spreadsheet\u304c\u8868\u793a\u3067\u304d\u307e\u305b\u3093\u3002\nGoogle Spreadsheet\u81ea\u4f53\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u4ee5\u4e0b\u8a18\u8f09\u3057\u307e\u3059\u3002\n\nOAuth\u306e\u8a2d\u5b9a\u3001\u304a\u3088\u3073\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n[Python\u304b\u3089OAuth2.0\u3092\u5229\u7528\u3057\u3066\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b](http://qiita.com/koyopro/items/d8d56f69f863f07e9378)\n\n\u307e\u305f\u3001Google Spreadsheet\u306e\u4f5c\u6210\u81ea\u4f53\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u304c\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n[docs_v3_example.py](https://github.com/google/gdata-python-client/blob/master/samples/docs/docs_v3_example.py)\n[Create new spreadsheet (Google API / Python)](http://stackoverflow.com/questions/10527705/create-new-spreadsheet-google-api-python)\n\nPython 2.7.10, gdata 2.0.18\u306e\u74b0\u5883\u3067\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n```\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nfrom oauth2client.service_account import ServiceAccountCredentials\nimport gdata.docs.client\n\n# name definitions\nAPP_NAME = 'GDataDocumentsAPISample'\nname_spr = 'Sample Spreadsheet'\n\n# resources for credential\njson_key = 'gspread-test.json'\nscope = ['https://docs.google.com/feeds']\n\n# create goole data docs client\nclient = gdata.docs.client.DocsClient(source=APP_NAME)\nclient.http_client.debug = True\n#client.http_client.debug = False\n\n# create credentials\ncredentials = ServiceAccountCredentials.from_json_keyfile_name(json_key, scope)\nauth_token = gdata.gauth.OAuth2TokenFromCredentials(credentials)\n\n# authorise\nauth_token.authorize(client)\n\n# create document as spreadsheet\ndocument = gdata.docs.data.Resource(type='spreadsheet', title=name_spr)\ndocument = client.CreateResource(document)\n\n# add ACL to  spreadsheet\nacl_entry = gdata.docs.data.AclEntry(\n    scope=gdata.acl.data.AclScope(value='hoge@foo.bar', type='user'),\n    role=gdata.acl.data.AclRole(value='writer'),\n)\nclient.AddAclEntry(document, acl_entry, send_notifications=False)\n\t\t\t    \nprint('Created:', document.title.text, document.resource_id.text)\n```\n\n\u5c11\u3057\u30cf\u30de\u3063\u305f\u3068\u3053\u308d\u3068\u3057\u3066\u2026\u3000Oauth\u3092\u5b9f\u884c\u3059\u308b\u5834\u5408\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u306f\u81ea\u5206\u306eGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u306f\u7570\u306a\u308a\u3001`name@projectname.iam.gserviceaccount.com` \u304cowner\u3068\u306a\u308a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067private\u306a\u306e\u3067acl_entry\u3092\u8a2d\u5b9a\u3057\u3066\u3084\u3089\u306a\u3044\u3068Google Drive\u4e0a\u3067Spreadsheet\u304c\u8868\u793a\u3067\u304d\u307e\u305b\u3093\u3002\n\n\n", "tags": ["Python", "googleapi"]}