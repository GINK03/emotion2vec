{"context": " More than 1 year has passed since last update.Embulk\u3068PostgreSQL\u3068\u4f7f\u3046\u5834\u5408\u306e\u6ce8\u610f\u70b9\u30e1\u30e2\n\n\u74b0\u5883\n\nembulk: 0.6.16\nembulk-output-postgresql: 0.4.1\nPostgreSQL: 9.4\n\n\n\u307e\u3068\u3081\nPostgreSQL\u306b\u65e5\u4ed8\u30c7\u30fc\u30bf\u3092\u5165\u308c\u308b\u5834\u5408\u306e\u6ce8\u610f\u4e8b\u9805\n\n\u30a4\u30f3\u30b5\u30fc\u30c8\u5148\u306e\u30ab\u30e9\u30e0\u304ctimezone\u578b(WITHOUT TIME ZONE)\u306e\u5834\u5408\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u5fd8\u308c\u305a\u306b\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3002\n\u672a\u6307\u5b9a\u306e\u5834\u5408\u3001PostgreSQL\u5074\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u304c\u65e5\u672c\u306b\u306a\u3063\u3066\u3044\u3066\u3082\u3001\u30d7\u30ec\u30d3\u30e5\u30fc\u3067\u8868\u793a\u3055\u308c\u305fUTC\u306e\u5024\u304c\u305d\u306e\u307e\u307e\u5165\u3063\u3066\u3057\u307e\u3046\n\ntimezone\u578b(WITH TIME ZONE)\u306e\u5834\u5408\u306f\u3001embulk\u304c\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u8003\u616e\u3057\u3066\u304f\u308c\u308b\u3002\nEmbulk\u306etimestamp\u578b\u3092\u3001date\u578b\u306b\u6295\u5165\u3059\u308b\u5834\u5408\u306fWITHOUT TIME ZONE\u3068\u540c\u69d8\u306btimezone\u3092\u6307\u5b9a\u3059\u308b\u3002\n\n\n\u89e3\u8aac\nEmbulk\u3068\u65e5\u4ed8\u30c7\u30fc\u30bf(\u305d\u306e1: CSV\u306e\u5165\u529b\u30c7\u30fc\u30bf) \u3067\u4f7f\u3063\u305fCSV\u30c7\u30fc\u30bf\u3092\u305d\u306e\u307e\u307e\u7528\u3044\u308b\nCSV\u30d1\u30fc\u30b5\u30fc\u3067\u3001default_timezone\u3092\u6307\u5b9a\u3057\u305f\u300c2015-01-27 19:23:49\u300d\u306e\u30c7\u30fc\u30bf\u306f\u3001embulk preview\u3067\u306f\u3001UTC\u6642\u523b\u300c2015-01-27 10:23:49 UTC\u300d\u3068\u8868\u793a\u3055\u308c\u308b\u3002\n\u3053\u306e\u30c7\u30fc\u30bf\u3092PostgreSQL\u306b\u6295\u5165\u3057\u305f\u5834\u5408\u306e\u52d5\u4f5c\u3092\u78ba\u8a8d\u3059\u308b\nembulk preview -G config.yaml\n*************************** 1 ***************************\n      id (     long) : 1\n account (     long) : 32,864\n    time (timestamp) : 2015-01-27 10:23:49 UTC\npurchase (timestamp) : 2015-01-26 15:00:00 UTC\n comment (   string) : embulk\n\n\nPostgreSQL\u5074\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306e\u78ba\u8a8d\n\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\u5148\u306ePostgreSQL\u306e\u30b5\u30fc\u30d0\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306fJapan\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002\nPostgreSQL\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u8a2d\u5b9a\u306f\u6b21\u306eSQL\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\u51fa\u529b\u3055\u308c\u305f\u65e5\u4ed8\u304c+09\u3068\u8868\u793a\u3055\u308c\u3066\u304a\u308a\u3001\u65e5\u672c\u6642\u9593\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\nselect now();\n              now              \n-------------------------------\n 2015-07-15 16:17:12.120466+09\n(1 row)\n\n\nPostgreSQL\u306etimezone\u578b\n\nPostgreSQL\u306etimestamp\u578b\u306b\u306f\u3001\u300c\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3042\u308a(WITH TIME ZONE)\u300d\u3068\u300c\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306a\u3057WITHOUT TIME ZONE\u300d\u3068\u3044\u3046\u578b\u304c\u304c\u3042\u308b\u3002\nSQL\u6a19\u6e96\u306e\u5834\u5408\u3001timestamp\u578b\u306f\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306a\u3057\u3060\u305d\u3046\u3060\u3002\u53c2\u8003\n\n\n\ntimestamp WITHOUT TIMEZONE\u306b\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\n\u6b21\u306eSQL\u3092\u6d41\u3057\u3066\u3001\u30a4\u30f3\u30b5\u30fc\u30c8\u5148\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\nDROP TABLE IF EXISTS \"public\".\"embulk_example\";\nCREATE TABLE \"public\".\"embulk_example\" (\n    \"id\" int8,\n    \"account\" int8,\n    \"time\" timestamp(6) WITHOUT TIME ZONE,\n    \"purchase\" timestamp(6) WITHOUT TIME ZONE,\n    \"comment\" text COLLATE \"default\"\n)\nWITH (OIDS=FALSE);\nALTER TABLE \"public\".\"embulk_example\" OWNER TO \"postgres\";\n\n\nembulk\u306e\u8a2d\u5b9a\n\u6b21\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u7528\u610f\u3059\u308b\u3002\nout:\n  type: postgresql\n  host: host\n  user: user\n  password: xxxxx\n  database: database\n  table: embulk_example\n  mode: insert\n\n\n\u30c7\u30fc\u30bf\u306e\u6295\u5165\nembulk run\u3067\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\nembulk run config.yml \n2015-07-15 16:13:39.142 +0900: Embulk v0.6.16\n2015-07-15 16:13:41.364 +0900 [INFO] (transaction): Loaded plugin embulk-output-postgresql (0.4.1)\n2015-07-15 16:13:41.414 +0900 [INFO] (transaction): Listing local files at directory '/private/tmp/postgresql_test/pgtest/csv' filtering filename by prefix 'sample_'\n2015-07-15 16:13:41.421 +0900 [INFO] (transaction): Loading files [/private/tmp/postgresql_test/pgtest/csv/sample_01.csv.gz]\n2015-07-15 16:13:41.520 +0900 [INFO] (transaction): Connecting to jdbc:postgresql://host:5432/database options {user=postgres, tcpKeepAlive=true, loginTimeout=300, socketTimeout=1800}\n2015-07-15 16:13:41.609 +0900 [INFO] (transaction): SQL: SET search_path TO \"public\"\n2015-07-15 16:13:41.614 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:41.614 +0900 [INFO] (transaction): Using insert mode\n2015-07-15 16:13:41.651 +0900 [INFO] (transaction): SQL: DROP TABLE IF EXISTS \"embulk_exam_1f78a400_bl_tmp000\"\n2015-07-15 16:13:41.656 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:41.670 +0900 [INFO] (transaction): SQL: CREATE TABLE IF NOT EXISTS \"embulk_exam_1f78a400_bl_tmp000\" (\"id\" INT8, \"account\" INT8, \"time\" TIMESTAMP, \"purchase\" TIMESTAMP, \"comment\" TEXT)\n2015-07-15 16:13:41.674 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:41.710 +0900 [INFO] (transaction): {done:  0 / 1, running: 0}\n2015-07-15 16:13:41.761 +0900 [INFO] (task-0000): Connecting to jdbc:postgresql://host:5432/database options {user=postgres, tcpKeepAlive=true, loginTimeout=300, socketTimeout=1800}\n2015-07-15 16:13:41.788 +0900 [INFO] (task-0000): SQL: SET search_path TO \"public\"\n2015-07-15 16:13:41.790 +0900 [INFO] (task-0000): > 0.00 seconds\n2015-07-15 16:13:41.792 +0900 [INFO] (task-0000): Copy SQL: COPY \"embulk_exam_1f78a400_bl_tmp000\" (\"id\", \"account\", \"time\", \"purchase\", \"comment\") FROM STDIN\n2015-07-15 16:13:41.966 +0900 [INFO] (task-0000): Loading 4 rows (340 bytes)\n2015-07-15 16:13:41.990 +0900 [INFO] (task-0000): > 0.02 seconds (loaded 4 rows in total)\n2015-07-15 16:13:41.992 +0900 [INFO] (transaction): {done:  1 / 1, running: 0}\n2015-07-15 16:13:41.993 +0900 [INFO] (transaction): Connecting to jdbc:postgresql://host:5432/database options {user=postgres, tcpKeepAlive=true, loginTimeout=300, socketTimeout=28800}\n2015-07-15 16:13:42.005 +0900 [INFO] (transaction): SQL: SET search_path TO \"public\"\n2015-07-15 16:13:42.008 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:42.009 +0900 [INFO] (transaction): SQL: INSERT INTO \"embulk_example\" (\"id\", \"account\", \"time\", \"purchase\", \"comment\") SELECT \"id\", \"account\", \"time\", \"purchase\", \"comment\" FROM \"embulk_exam_1f78a400_bl_tmp000\"\n2015-07-15 16:13:42.013 +0900 [INFO] (transaction): > 0.00 seconds (4 rows)\n2015-07-15 16:13:42.030 +0900 [INFO] (transaction): Connecting to jdbc:postgresql://host:5432/database options {user=postgres, tcpKeepAlive=true, loginTimeout=300, socketTimeout=1800}\n2015-07-15 16:13:42.045 +0900 [INFO] (transaction): SQL: SET search_path TO \"public\"\n2015-07-15 16:13:42.094 +0900 [INFO] (transaction): > 0.05 seconds\n2015-07-15 16:13:42.095 +0900 [INFO] (transaction): SQL: DROP TABLE IF EXISTS \"embulk_exam_1f78a400_bl_tmp000\"\n2015-07-15 16:13:42.099 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:42.100 +0900 [INFO] (main): Committed.\n2015-07-15 16:13:42.100 +0900 [INFO] (main): Next config diff: {\"in\":{\"last_path\":\"/private/tmp/postgresql_test/pgtest/csv/sample_01.csv.gz\"},\"out\":{}}\n\n\n\u78ba\u8a8d\n\u4e00\u756a\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u3001\u30d7\u30ec\u30d3\u30e5\u30fc\u6642\u300c2015-01-27 10:23:49 UTC\u300d\u3067\u3042\u308a\u65e5\u672c\u6642\u9593\u3067\u306f\u3001\u300c2015-01-27 19:23:49\u300d\u3067\u3042\u308b\u304c\u30a4\u30f3\u30b5\u30fc\u30c8\u3059\u308b\u3068UTC\u306e\u6642\u9593\u304c\u305d\u306e\u307e\u307e\u30a4\u30f3\u30b5\u30fc\u30c8\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u3002\nselect * from embulk_example ;\n id | account |        time         |      purchase       |          comment           \n----+---------+---------------------+---------------------+----------------------------\n  1 |   32864 | 2015-01-27 10:23:49 | 2015-01-26 15:00:00 | embulk\n  2 |   14824 | 2015-01-27 10:01:23 | 2015-01-26 15:00:00 | embulk jruby\n  3 |   27559 | 2015-01-27 17:20:02 | 2015-01-27 15:00:00 | Embulk \"csv\" parser plugin\n  4 |   11270 | 2015-01-29 02:54:36 | 2015-01-28 15:00:00 | NULL\n\n\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306e\u6307\u5b9a\n\u3053\u306e\u3088\u3046\u306a\u5834\u5408out\u5074\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u8a2d\u5b9a\u3067\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3002\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306f\u3001\u300c\u30ab\u30e9\u30e0\u6bce\u306e\u8a2d\u5b9a\u300d\u307e\u305f\u306f\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u6307\u5b9a\u300d\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u30ab\u30e9\u30e0\u6bce\u306e\u8a2d\u5b9a\u306e\u5834\u5408\u306fcolumn_options\u3067\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3002\u3053\u306e\u5834\u5408\u6642\u523b\u3092\u5229\u7528\u3059\u308b\u30ab\u30e9\u30e0\u6bce\u306b\u8a2d\u5b9a\u304c\u5fc5\u8981\u3002\nout:\n  type: postgresql\n  host: host\n  user: user\n  password: xxxxx\n  database: database\n  table: embulk_example\n  mode: insert\n  column_options:                   # <-- \u3053\u308c\n    time: { timezone: \"Japan\" }     # <-- time\u30ab\u30e9\u30e0\u7528\n    purchase: { timezone: \"Japan\" } # <-- purchase\u30ab\u30e9\u30e0\u7528\n\n\n\u3059\u3079\u3066\u306e\u30ab\u30e9\u30e0\u3067\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u5834\u5408\u306f\u3001default_timezone\u3092\u6307\u5b9a\u3059\u308b\u3068\u826f\u3044\nout:\n  type: postgresql\n  host: host\n  user: user\n  password: xxxxx\n  database: database\n  table: embulk_example\n  mode: insert\n  default_timezone: \"Japan\"  # <-- \u3053\u308c\n\n\u3053\u308c\u3092\u6307\u5b9a\u3057\u3066\u518d\u5ea6\u30c7\u30fc\u30bf\u3092\u30a4\u30f3\u30b5\u30fc\u30c8\u3059\u308b\u3068\u3001\u65e5\u672c\u6642\u9593\u306b\u5909\u63db\u3055\u308c\u305f\u6642\u523b\u304c\u5404\u30ab\u30e9\u30e0\u306b\u30a4\u30f3\u30b5\u30fc\u30c8\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\nselect * from embulk_example ;\n id | account |        time         |      purchase       |          comment           \n----+---------+---------------------+---------------------+----------------------------\n  1 |   32864 | 2015-01-27 19:23:49 | 2015-01-27 00:00:00 | embulk\n  2 |   14824 | 2015-01-27 19:01:23 | 2015-01-27 00:00:00 | embulk jruby\n  3 |   27559 | 2015-01-28 02:20:02 | 2015-01-28 00:00:00 | Embulk \"csv\" parser plugin\n  4 |   11270 | 2015-01-29 11:54:36 | 2015-01-29 00:00:00 | NULL\n(4 rows)\n\n\ntimestamp WITH TIME ZONE\u306b\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\nDROP TABLE IF EXISTS \"public\".\"embulk_example\";\nCREATE TABLE \"public\".\"embulk_example\" (\n    \"id\" int8,\n    \"account\" int8,\n    \"time\" timestamp(6) WITH TIME ZONE,\n    \"purchase\" timestamp(6) WITH TIME ZONE,\n    \"comment\" text COLLATE \"default\"\n)\nWITH (OIDS=FALSE);\nALTER TABLE \"public\".\"embulk_example\" OWNER TO \"postgres\";\n\nPostgreSQL\u56fa\u6709\u306etimestamp WITH TIMEZONE\u578b\u306e\u5834\u5408\u3001default_timezone\u3084column_options\u3092\u6307\u5b9a\u3057\u306a\u304f\u3066\u3082\u3001\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u8003\u616e\u3057\u3066\u30c7\u30fc\u30bf\u3092\u30a4\u30f3\u30b5\u30fc\u30c8\u3057\u3066\u304f\u308c\u308b\u3002\nmode: insert_direct\u3067embulk\u304c\u30c6\u30fc\u30d6\u30eb\u3092\u81ea\u52d5\u4f5c\u6210\u3059\u308b\u5834\u5408\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3042\u308a\u306e\u578b\u3067\u4f5c\u6210\u3055\u308c\u308b\u3002\n id | account |          time          |        purchase        |          comment           \n----+---------+------------------------+------------------------+----------------------------\n  1 |   32864 | 2015-01-27 19:23:49+09 | 2015-01-27 00:00:00+09 | embulk\n  2 |   14824 | 2015-01-27 19:01:23+09 | 2015-01-27 00:00:00+09 | embulk jruby\n  3 |   27559 | 2015-01-28 02:20:02+09 | 2015-01-28 00:00:00+09 | Embulk \"csv\" parser plugin\n  4 |   11270 | 2015-01-29 11:54:36+09 | 2015-01-29 00:00:00+09 | NULL\n(4 rows)\n\nEmbulk\u3068PostgreSQL\u3068\u4f7f\u3046\u5834\u5408\u306e\u6ce8\u610f\u70b9\u30e1\u30e2\n\n## \u74b0\u5883\n\n* embulk: 0.6.16\n* embulk-output-postgresql: 0.4.1\n* PostgreSQL: 9.4\n\n## \u307e\u3068\u3081\n\nPostgreSQL\u306b\u65e5\u4ed8\u30c7\u30fc\u30bf\u3092\u5165\u308c\u308b\u5834\u5408\u306e\u6ce8\u610f\u4e8b\u9805\n\n* \u30a4\u30f3\u30b5\u30fc\u30c8\u5148\u306e\u30ab\u30e9\u30e0\u304c**timezone\u578b(WITHOUT TIME ZONE)**\u306e\u5834\u5408\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u5fd8\u308c\u305a\u306b\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3002\n* \u672a\u6307\u5b9a\u306e\u5834\u5408\u3001PostgreSQL\u5074\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u304c\u65e5\u672c\u306b\u306a\u3063\u3066\u3044\u3066\u3082\u3001\u30d7\u30ec\u30d3\u30e5\u30fc\u3067\u8868\u793a\u3055\u308c\u305fUTC\u306e\u5024\u304c\u305d\u306e\u307e\u307e\u5165\u3063\u3066\u3057\u307e\u3046\n* **timezone\u578b(WITH TIME ZONE)**\u306e\u5834\u5408\u306f\u3001embulk\u304c\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u8003\u616e\u3057\u3066\u304f\u308c\u308b\u3002\n* Embulk\u306etimestamp\u578b\u3092\u3001date\u578b\u306b\u6295\u5165\u3059\u308b\u5834\u5408\u306fWITHOUT TIME ZONE\u3068\u540c\u69d8\u306btimezone\u3092\u6307\u5b9a\u3059\u308b\u3002\n\n## \u89e3\u8aac\n\n[Embulk\u3068\u65e5\u4ed8\u30c7\u30fc\u30bf(\u305d\u306e1: CSV\u306e\u5165\u529b\u30c7\u30fc\u30bf)](http://qiita.com/hiroysato/items/7e89ab892baacaec327e) \u3067\u4f7f\u3063\u305fCSV\u30c7\u30fc\u30bf\u3092\u305d\u306e\u307e\u307e\u7528\u3044\u308b\n\nCSV\u30d1\u30fc\u30b5\u30fc\u3067\u3001default_timezone\u3092\u6307\u5b9a\u3057\u305f\u300c2015-01-27 19:23:49\u300d\u306e\u30c7\u30fc\u30bf\u306f\u3001``embulk preview``\u3067\u306f\u3001UTC\u6642\u523b\u300c2015-01-27 10:23:49 UTC\u300d\u3068\u8868\u793a\u3055\u308c\u308b\u3002\n\n\u3053\u306e\u30c7\u30fc\u30bf\u3092PostgreSQL\u306b\u6295\u5165\u3057\u305f\u5834\u5408\u306e\u52d5\u4f5c\u3092\u78ba\u8a8d\u3059\u308b\n\n```\nembulk preview -G config.yaml\n*************************** 1 ***************************\n      id (     long) : 1\n account (     long) : 32,864\n    time (timestamp) : 2015-01-27 10:23:49 UTC\npurchase (timestamp) : 2015-01-26 15:00:00 UTC\n comment (   string) : embulk\n```\n\n\n\n### PostgreSQL\u5074\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306e\u78ba\u8a8d\n\n\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\u5148\u306ePostgreSQL\u306e\u30b5\u30fc\u30d0\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306fJapan\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002\n\nPostgreSQL\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u8a2d\u5b9a\u306f\u6b21\u306eSQL\u3067\u78ba\u8a8d\u3067\u304d\u308b\u3002\n\u51fa\u529b\u3055\u308c\u305f\u65e5\u4ed8\u304c**+09**\u3068\u8868\u793a\u3055\u308c\u3066\u304a\u308a\u3001\u65e5\u672c\u6642\u9593\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\n\n```\nselect now();\n              now              \n-------------------------------\n 2015-07-15 16:17:12.120466+09\n(1 row)\n```\n\n### PostgreSQL\u306etimezone\u578b\n\n* PostgreSQL\u306etimestamp\u578b\u306b\u306f\u3001\u300c\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3042\u308a(WITH TIME ZONE)\u300d\u3068\u300c\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306a\u3057WITHOUT TIME ZONE\u300d\u3068\u3044\u3046\u578b\u304c\u304c\u3042\u308b\u3002\n* SQL\u6a19\u6e96\u306e\u5834\u5408\u3001timestamp\u578b\u306f\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306a\u3057\u3060\u305d\u3046\u3060\u3002[\u53c2\u8003](https://www.postgresql.jp/document/9.4/html/datatype-datetime.html#DATATYPE-TIMEZONES)\n\n\n## timestamp WITHOUT TIMEZONE\u306b\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\n\n\u6b21\u306eSQL\u3092\u6d41\u3057\u3066\u3001\u30a4\u30f3\u30b5\u30fc\u30c8\u5148\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```sql\nDROP TABLE IF EXISTS \"public\".\"embulk_example\";\nCREATE TABLE \"public\".\"embulk_example\" (\n\t\"id\" int8,\n\t\"account\" int8,\n\t\"time\" timestamp(6) WITHOUT TIME ZONE,\n\t\"purchase\" timestamp(6) WITHOUT TIME ZONE,\n\t\"comment\" text COLLATE \"default\"\n)\nWITH (OIDS=FALSE);\nALTER TABLE \"public\".\"embulk_example\" OWNER TO \"postgres\";\n```\n\n### embulk\u306e\u8a2d\u5b9a\n\n\u6b21\u306e\u3088\u3046\u306a\u8a2d\u5b9a\u3092\u7528\u610f\u3059\u308b\u3002\n\n```yaml\nout:\n  type: postgresql\n  host: host\n  user: user\n  password: xxxxx\n  database: database\n  table: embulk_example\n  mode: insert\n```\n\n### \u30c7\u30fc\u30bf\u306e\u6295\u5165\n\n``embulk run``\u3067\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\n\n```\nembulk run config.yml \n2015-07-15 16:13:39.142 +0900: Embulk v0.6.16\n2015-07-15 16:13:41.364 +0900 [INFO] (transaction): Loaded plugin embulk-output-postgresql (0.4.1)\n2015-07-15 16:13:41.414 +0900 [INFO] (transaction): Listing local files at directory '/private/tmp/postgresql_test/pgtest/csv' filtering filename by prefix 'sample_'\n2015-07-15 16:13:41.421 +0900 [INFO] (transaction): Loading files [/private/tmp/postgresql_test/pgtest/csv/sample_01.csv.gz]\n2015-07-15 16:13:41.520 +0900 [INFO] (transaction): Connecting to jdbc:postgresql://host:5432/database options {user=postgres, tcpKeepAlive=true, loginTimeout=300, socketTimeout=1800}\n2015-07-15 16:13:41.609 +0900 [INFO] (transaction): SQL: SET search_path TO \"public\"\n2015-07-15 16:13:41.614 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:41.614 +0900 [INFO] (transaction): Using insert mode\n2015-07-15 16:13:41.651 +0900 [INFO] (transaction): SQL: DROP TABLE IF EXISTS \"embulk_exam_1f78a400_bl_tmp000\"\n2015-07-15 16:13:41.656 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:41.670 +0900 [INFO] (transaction): SQL: CREATE TABLE IF NOT EXISTS \"embulk_exam_1f78a400_bl_tmp000\" (\"id\" INT8, \"account\" INT8, \"time\" TIMESTAMP, \"purchase\" TIMESTAMP, \"comment\" TEXT)\n2015-07-15 16:13:41.674 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:41.710 +0900 [INFO] (transaction): {done:  0 / 1, running: 0}\n2015-07-15 16:13:41.761 +0900 [INFO] (task-0000): Connecting to jdbc:postgresql://host:5432/database options {user=postgres, tcpKeepAlive=true, loginTimeout=300, socketTimeout=1800}\n2015-07-15 16:13:41.788 +0900 [INFO] (task-0000): SQL: SET search_path TO \"public\"\n2015-07-15 16:13:41.790 +0900 [INFO] (task-0000): > 0.00 seconds\n2015-07-15 16:13:41.792 +0900 [INFO] (task-0000): Copy SQL: COPY \"embulk_exam_1f78a400_bl_tmp000\" (\"id\", \"account\", \"time\", \"purchase\", \"comment\") FROM STDIN\n2015-07-15 16:13:41.966 +0900 [INFO] (task-0000): Loading 4 rows (340 bytes)\n2015-07-15 16:13:41.990 +0900 [INFO] (task-0000): > 0.02 seconds (loaded 4 rows in total)\n2015-07-15 16:13:41.992 +0900 [INFO] (transaction): {done:  1 / 1, running: 0}\n2015-07-15 16:13:41.993 +0900 [INFO] (transaction): Connecting to jdbc:postgresql://host:5432/database options {user=postgres, tcpKeepAlive=true, loginTimeout=300, socketTimeout=28800}\n2015-07-15 16:13:42.005 +0900 [INFO] (transaction): SQL: SET search_path TO \"public\"\n2015-07-15 16:13:42.008 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:42.009 +0900 [INFO] (transaction): SQL: INSERT INTO \"embulk_example\" (\"id\", \"account\", \"time\", \"purchase\", \"comment\") SELECT \"id\", \"account\", \"time\", \"purchase\", \"comment\" FROM \"embulk_exam_1f78a400_bl_tmp000\"\n2015-07-15 16:13:42.013 +0900 [INFO] (transaction): > 0.00 seconds (4 rows)\n2015-07-15 16:13:42.030 +0900 [INFO] (transaction): Connecting to jdbc:postgresql://host:5432/database options {user=postgres, tcpKeepAlive=true, loginTimeout=300, socketTimeout=1800}\n2015-07-15 16:13:42.045 +0900 [INFO] (transaction): SQL: SET search_path TO \"public\"\n2015-07-15 16:13:42.094 +0900 [INFO] (transaction): > 0.05 seconds\n2015-07-15 16:13:42.095 +0900 [INFO] (transaction): SQL: DROP TABLE IF EXISTS \"embulk_exam_1f78a400_bl_tmp000\"\n2015-07-15 16:13:42.099 +0900 [INFO] (transaction): > 0.00 seconds\n2015-07-15 16:13:42.100 +0900 [INFO] (main): Committed.\n2015-07-15 16:13:42.100 +0900 [INFO] (main): Next config diff: {\"in\":{\"last_path\":\"/private/tmp/postgresql_test/pgtest/csv/sample_01.csv.gz\"},\"out\":{}}\n```\n\n### \u78ba\u8a8d\n\n\u4e00\u756a\u76ee\u306e\u30a8\u30f3\u30c8\u30ea\u306f\u3001\u30d7\u30ec\u30d3\u30e5\u30fc\u6642\u300c2015-01-27 10:23:49 UTC\u300d\u3067\u3042\u308a\u65e5\u672c\u6642\u9593\u3067\u306f\u3001\u300c2015-01-27 19:23:49\u300d\u3067\u3042\u308b\u304c\u30a4\u30f3\u30b5\u30fc\u30c8\u3059\u308b\u3068UTC\u306e\u6642\u9593\u304c\u305d\u306e\u307e\u307e\u30a4\u30f3\u30b5\u30fc\u30c8\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u3002\n\n```\nselect * from embulk_example ;\n id | account |        time         |      purchase       |          comment           \n----+---------+---------------------+---------------------+----------------------------\n  1 |   32864 | 2015-01-27 10:23:49 | 2015-01-26 15:00:00 | embulk\n  2 |   14824 | 2015-01-27 10:01:23 | 2015-01-26 15:00:00 | embulk jruby\n  3 |   27559 | 2015-01-27 17:20:02 | 2015-01-27 15:00:00 | Embulk \"csv\" parser plugin\n  4 |   11270 | 2015-01-29 02:54:36 | 2015-01-28 15:00:00 | NULL\n```\n\n### \u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306e\u6307\u5b9a\n\n\u3053\u306e\u3088\u3046\u306a\u5834\u5408out\u5074\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u8a2d\u5b9a\u3067\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3002\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u306f\u3001\u300c\u30ab\u30e9\u30e0\u6bce\u306e\u8a2d\u5b9a\u300d\u307e\u305f\u306f\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u6307\u5b9a\u300d\u3092\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n\u30ab\u30e9\u30e0\u6bce\u306e\u8a2d\u5b9a\u306e\u5834\u5408\u306f``column_options``\u3067\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3059\u308b\u3002\u3053\u306e\u5834\u5408\u6642\u523b\u3092\u5229\u7528\u3059\u308b\u30ab\u30e9\u30e0\u6bce\u306b\u8a2d\u5b9a\u304c\u5fc5\u8981\u3002\n\n```yaml\nout:\n  type: postgresql\n  host: host\n  user: user\n  password: xxxxx\n  database: database\n  table: embulk_example\n  mode: insert\n  column_options:                   # <-- \u3053\u308c\n    time: { timezone: \"Japan\" }     # <-- time\u30ab\u30e9\u30e0\u7528\n    purchase: { timezone: \"Japan\" } # <-- purchase\u30ab\u30e9\u30e0\u7528\n\n```\n\n\u3059\u3079\u3066\u306e\u30ab\u30e9\u30e0\u3067\u6307\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u306a\u3044\u5834\u5408\u306f\u3001``default_timezone``\u3092\u6307\u5b9a\u3059\u308b\u3068\u826f\u3044\n\n```\nout:\n  type: postgresql\n  host: host\n  user: user\n  password: xxxxx\n  database: database\n  table: embulk_example\n  mode: insert\n  default_timezone: \"Japan\"  # <-- \u3053\u308c\n```\n\n\u3053\u308c\u3092\u6307\u5b9a\u3057\u3066\u518d\u5ea6\u30c7\u30fc\u30bf\u3092\u30a4\u30f3\u30b5\u30fc\u30c8\u3059\u308b\u3068\u3001\u65e5\u672c\u6642\u9593\u306b\u5909\u63db\u3055\u308c\u305f\u6642\u523b\u304c\u5404\u30ab\u30e9\u30e0\u306b\u30a4\u30f3\u30b5\u30fc\u30c8\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\n\n```\nselect * from embulk_example ;\n id | account |        time         |      purchase       |          comment           \n----+---------+---------------------+---------------------+----------------------------\n  1 |   32864 | 2015-01-27 19:23:49 | 2015-01-27 00:00:00 | embulk\n  2 |   14824 | 2015-01-27 19:01:23 | 2015-01-27 00:00:00 | embulk jruby\n  3 |   27559 | 2015-01-28 02:20:02 | 2015-01-28 00:00:00 | Embulk \"csv\" parser plugin\n  4 |   11270 | 2015-01-29 11:54:36 | 2015-01-29 00:00:00 | NULL\n(4 rows)\n```\n\n## timestamp WITH TIME ZONE\u306b\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\n\n```sql\nDROP TABLE IF EXISTS \"public\".\"embulk_example\";\nCREATE TABLE \"public\".\"embulk_example\" (\n\t\"id\" int8,\n\t\"account\" int8,\n\t\"time\" timestamp(6) WITH TIME ZONE,\n\t\"purchase\" timestamp(6) WITH TIME ZONE,\n\t\"comment\" text COLLATE \"default\"\n)\nWITH (OIDS=FALSE);\nALTER TABLE \"public\".\"embulk_example\" OWNER TO \"postgres\";\n```\n\nPostgreSQL\u56fa\u6709\u306etimestamp WITH TIMEZONE\u578b\u306e\u5834\u5408\u3001default_timezone\u3084column_options\u3092\u6307\u5b9a\u3057\u306a\u304f\u3066\u3082\u3001\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u8003\u616e\u3057\u3066\u30c7\u30fc\u30bf\u3092\u30a4\u30f3\u30b5\u30fc\u30c8\u3057\u3066\u304f\u308c\u308b\u3002\n\n``mode: insert_direct``\u3067embulk\u304c\u30c6\u30fc\u30d6\u30eb\u3092\u81ea\u52d5\u4f5c\u6210\u3059\u308b\u5834\u5408\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3042\u308a\u306e\u578b\u3067\u4f5c\u6210\u3055\u308c\u308b\u3002\n\n```\n id | account |          time          |        purchase        |          comment           \n----+---------+------------------------+------------------------+----------------------------\n  1 |   32864 | 2015-01-27 19:23:49+09 | 2015-01-27 00:00:00+09 | embulk\n  2 |   14824 | 2015-01-27 19:01:23+09 | 2015-01-27 00:00:00+09 | embulk jruby\n  3 |   27559 | 2015-01-28 02:20:02+09 | 2015-01-28 00:00:00+09 | Embulk \"csv\" parser plugin\n  4 |   11270 | 2015-01-29 11:54:36+09 | 2015-01-29 00:00:00+09 | NULL\n(4 rows)\n```\n", "tags": ["Embulk"]}