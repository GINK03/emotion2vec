{"context": " More than 1 year has passed since last update.\u6d41\u884c\u308a\u7269\u306b\u89e6\u308c\u3066\u307f\u305f\u3002\n\u307f\u306a\u3055\u307e\u306e\u30a2\u30a6\u30c8\u30d7\u30c3\u30c8\u306b\u652f\u3048\u3089\u308c\u3066\u306e\u307e\u3068\u3081\u306e\u3088\u3046\u306a\u3082\u306e\u3002\n\u611f\u8b1d\u3067\u3059\u3002\n\n\u6210\u679c\u7269\n\nhttps://registry.hub.docker.com/u/ume3/docker-ubuntu-monit-log/dockerfile/\nhttps://github.com/ume3/docker-ubuntu-monit-log\n\n\n\u8d77\u52d5\ndocker login\ndocker pull ume3/docker-ubuntu-monit-log\ndocker images\ndocker run -dt -p 2812:2812 ume3/docker-ubuntu-monit-log\ndocker ps\n\n\nDockerHub\u7d4c\u7531\u3067DL\u3057\u3066\u7acb\u3061\u4e0a\u3052\u308b\u3068Monit\u7d4c\u7531\u3067\u4ee5\u4e0b\u304c\u95b2\u89a7\u3067\u304d\u308b\n\n\nex) http://127.0.0.1:2812\n\n\n\n\n\n\n\n\u3064\u304f\u308a\u304b\u305f\n\n\u5fc5\u8981\u306a\u3082\u306e\n\n\nGitHub\nDockerHub\n\n\nDocker\u3092\u7acb\u3061\u4e0a\u3052\u308b\u74b0\u5883\n\n\n\u4eca\u56de\u306f\u3001Mac(homebrew\u5229\u7528)\nboot2docker\nVirtulaBox\n\n\nDocker\u3092\u7acb\u3061\u4e0a\u3052\u308b\u74b0\u5883\u305d\u306e2\n\n\n\u4f5c\u3063\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u5225\u306eDocker\u74b0\u5883\u3067\u7528\u610f\u3057\u305f\u3044\u5834\u5408\n\u9069\u5f53\u306b\uff1aAWS\u3067Ubuntu\u3067\u3082\u305f\u3061\u3042\u3052\u308c\u3070\u3044\u3044\u3093\u3058\u3083\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff08\u96d1\uff09\n\n\n\n\nGitHub\u306bDockerfile\u3092\u7ba1\u7406\u3057\u305f\u3044\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n\nDokcerfile\u3092\u304a\u304f\u7528\u610f\u3092\u3059\u308b\n\n\ngit clone git@github.com:ume3/docker-ubuntu-monit-log.git\n\u8a72\u5f53\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u4f5c\u696d\u3059\u308b\n\n\n\n\nboot2docker (Mac\u306e\u5834\u5408\uff09\n\nDocker\u30b3\u30f3\u30c6\u30ca\u3092\u7acb\u3061\u4e0a\u3052\u308b\u74b0\u5883\u3092\u7528\u610f\u3059\u308b\n\n\nMac\u3067Docker\u3092\u6271\u3044\u305f\u3044\u306e\u3067homebrew\u3092\u4f7f\u3046\n\n\nrefs: https://docs.docker.com/installation/mac/\n\nrefs: http://qiita.com/AH_korikori/items/8a165c081e8eb699deb3\n\n\nbrew update\nbrew tap homebrew/binary\nbrew install docker\nbrew install boot2docker\nbrew cask install virtualbox\n\n\nboot2docker\u306f 1.3\u4ee5\u4e0a\u304c\u3088\u3044\u3067\u3059\n\n\n\nbrew info boot2docker \u3067\u78ba\u8a8d\n\n\n\n\nboot2dockr \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nboot2docker\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\n\nboot2docker init\nboot2docker start\n\n\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u6642\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306bdocker\u64cd\u4f5c\u3059\u308b\u969b\u306e\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3059\u308b\n\n\n\u305d\u306e\u307e\u307e\u30b3\u30d4\u30da(or .zshenv, .bashenv\u306a\u3069\u306b\u8a2d\u5b9a\u3059\u308b\uff09\n\n\n\n---snip\nTo connect the Docker client to the Docker daemon, please set:\n    export DOCKER_HOST=tcp://192.168.59.103:2376\n    export DOCKER_CERT_PATH=/Users/hoge/.boot2docker/certs/boot2docker-vm\n    export DOCKER_TLS_VERIFY=1\n\n\nDocker\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n% docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS\n\n\u3053\u3053\u307e\u3067\u3067\u6e96\u5099\u306fOK\n\n\nDockerfile\u3092\u7528\u610f\u3057\u3066\u30d3\u30eb\u30c9\u3059\u308b\n\n\nDockerfile \u3092\u66f8\u304f\nex) Ubuntu\u3067docker:docker\u3067ssh\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u74b0\u5883\n\n# Latest Ubuntu LTS\nFROM ubuntu:14.04\nMAINTAINER ume3\n\nENV USER_NAME docker\nENV USER_PASSWORD docker\n\n## install\nRUN apt-get update\nRUN apt-get upgrade -y\nRUN apt-get install sudo passwd openssh-server -y\n\n## setup\n# ssh\nRUN sed -ri 's/^#PermitRootLogin yes$/PermitRootLogin no/' /etc/ssh/sshd_config\n\n# useradd\nRUN useradd $USER_NAME\nRUN echo \"$USER_NAME:$USER_PASSWORD\" | chpasswd\nRUN echo \"$USER_NAME ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers.d/$USER_NAME\nRUN mkdir /var/run/sshd\nRUN mkdir /home/${USER_NAME}\n\n## service\n# ssh\nEXPOSE 22\n\nENTRYPOINT [ \"/usr/sbin/sshd\", \"-D\" ]\n\n\nDocker\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u6210\n\n# build\n% docker build -t ubuntu .\n# images\u306e\u78ba\u8a8d\n% docker images\n\n\nDocker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n\n10000\u756a\u30dd\u30fc\u30c8\u3067\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u8a2d\u5b9a\u3092\u8a18\u8f09\u3059\u308b\uff08\u5f8c\u8ff0\uff09\n\n% docker run -dt -p 10000:22 ubuntu\nbac4eb2001b2f6618a6c3b5b5b4b3e712b968ce403418059d15b92df4ca799b6\n% docker ps\nCONTAINER ID        IMAGE               COMMAND               CREATED             STATUS              PORTS                   NAMES\nbac4eb2001b2        ubuntu:latest       \"/usr/sbin/sshd -D\"   6 days ago          Up 12 seconds       0.0.0.0:10000->22/tcp   hungry_pasteur\n\n\nvirtualbox\u7d4c\u7531\u3067ssh\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n\nboot2docker\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3068\u3001VirtualBox\u306e\u30a4\u30e1\u30fc\u30b8\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u308b\nvirutalbox\u8d77\u52d5\u3088\u308a\n\n\n\nVirtualBox\u3067\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\n\nrefs: \nhttp://blog.ieknir.com/blog/build-docker-image-for-ssh-server/\n\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u95a2\u4fc2\u3092\u3064\u304f\u3063\u3066\u3042\u3052\u308b\u3002\n\u4eca\u56de\u306f10000\u756a\u3068\u3059\u308b\u3002\n[ssh:10000] -> [boot2docker-vm:10000] -> [docker-container:22]\n\n\nGUI\u64cd\u4f5c\u3067\u3082\u3044\u3044\u304c\u30b3\u30de\u30f3\u30c9\u3060\u3068\u4ee5\u4e0b\nbefore\n\n% VBoxManage showvminfo boot2docker-vm | grep ^NIC\nNIC 1:           MAC: 080027502227, Attachment: NAT, Cable connected: on, Trace: off (file: none), Type: virtio, Reported speed: 0 Mbps, Boot priority: 0, Promisc Policy: deny, Bandwidth group: none\nNIC 1 Settings:  MTU: 0, Socket (send: 64, receive: 64), TCP Window (send:64, receive: 64)\nNIC 2:           MAC: 0800276ADD18, Attachment: Host-only Interface 'vboxnet0', Cable connected: on, Trace: off (file: none), Type: virtio, Reported speed: 0 Mbps, Boot priority: 0, Promisc Policy: deny, Bandwidth group: none\nNIC 3:           disabled\nNIC 4:           disabled\nNIC 5:           disabled\nNIC 6:           disabled\nNIC 7:           disabled\nNIC 8:           disabled\n\n\nafter\n\n% VBoxManage controlvm \"boot2docker-vm\" natpf1 \"ssh_container,tcp,127.0.0.1,10000,,10000\"\n\n%  VBoxManage showvminfo boot2docker-vm | grep Rule\nNIC 1 Rule(0):   name = ssh_container, protocol = tcp, host ip = 127.0.0.1, host port = 10000, guest ip = , guest port = 10000\n\n\nVirtualBox(GUI)\u78ba\u8a8d\n\nVBoxManage\u3067\u8a2d\u5b9a\u3057\u305f\u3053\u3068\u3067\u4ee5\u4e0b\u3002\u4ed6\u3001\u5fdc\u7528\u304c\u304d\u304f\u3002\n\n\n\n\nssh\u30ed\u30b0\u30a4\u30f3\u78ba\u8a8d\n% ssh -p 10000 docker@127.0.0.1\ndocker@127.0.0.1's password:\nWelcome to Ubuntu 14.04 LTS (GNU/Linux 3.2.0-54-generic x86_64)\n---snip\n\nOK\n\n\u524a\u9664\u30fb\u6574\u7406\u30b3\u30de\u30f3\u30c9\n\n\u3053\u306e\u3042\u305f\u308a\n\ndocker stop <CONTAINER>\ndocker ps\ndocker ps -q\ndocker stop `docker ps -q`\ndocker images\ndocker rmi <IMAGE>\n\n\n\nGitHub+DockerHub\n\nrefs: http://qiita.com/jagaximo/items/4cbda778a10fd37f68e6\n\nrefs: http://ameblo.jp/tech-cz/entry-11886401333.html\n\nrefs: http://sawara.me/docker/2055/\n\n\n\nGitHub\n\n\u52d5\u4f5c\u78ba\u8a8d\u306e\u3068\u308c\u305f Dockerfile\u3092Commit\u3057\u3066\u3001GitHub\u3078push\u3057\u3066\u304a\u304f\n\n\nDockerHub\n\n\u30ed\u30b0\u30a4\u30f3\u5f8c\n\n\n[settings] - [Linked Accounts]\nGitHub\u3068\u306e\u8a8d\u8a3c\u3092\u5148\u306b\u6e08\u307e\u305b\u3066\u304a\u304f\n\n\n\n\n\n\u8a8d\u8a3c\u5f8c\n\n\n\nAutomated Build\n\nrefs: http://qiita.com/jagaximo/items/4cbda778a10fd37f68e6\n\n\u9023\u643a\u958b\u59cb\u3002 Automated Build \u3092\u9078\u629e\u3059\u308b\n\n\n\n\u753b\u9762\u9077\u79fb\u3057\u3064\u3064\u3001 \u7528\u610f\u3057\u305fGitHub\u306e\u30ea\u30dd\u30b8\u30c8\u30ea \u3092\u53c2\u7167\u3055\u305b\u308b\n\n\n\u3068\u304f\u306b\u8ff7\u308f\u306a\u3044\n\n\n\n\n\u9023\u643a\u7d50\u679c\n\n\n\nGitHub\u3078Push\u3059\u308b\u3068DockerHub\u3078Build\u304c\u8d70\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\n\u4eca\u56de\u306e\u30dd\u30a4\u30f3\u30c8\n\n\n\u66f4\u65b0\u3057\u3066\u307f\u308b\n\nrefs: http://qiita.com/mykysyk@github/items/7553e8fef2948de10844\n\nMonit\u3092\u3044\u308c\u3066\u307f\u3088\u3046\n\n\nDockerfile\u3092\u3044\u3058\u3063\u3066 Monit+sshd \u74b0\u5883\u3092\u7528\u610f\n\n\nMonit\u306f2812\u30dd\u30fc\u30c8\u3067web\u95b2\u89a7\u3067\u304d\u308b\u8a2d\u5b9a\u306b\u3057\u3066\u3044\u308b\u306e\u3067\u4ee5\u4e0b\n\n\n\n% docker build -t ubuntu:monit .\n% docker run -dt -p 10000:22 -p 2812:2812 ubuntu:monit\n% VBoxManage controlvm \"boot2docker-vm\" natpf1 \"monit_contaner,tcp,127.0.0.1,2812,,2812\"\n\n\n\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3067 http://127.0.0.1;2812 \u3092\u78ba\u8a8d\u3067\u304d\u308b\n\n\n\nDockerHub\u306e\u66f4\u65b0\u78ba\u8a8d\n\n\u81ea\u8eab\u306e GitHub \u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3078 git push origin master \u3059\u308b\n\u3059\u308b\u3068\u3001DockerHub \u3067Build\u304c\u8d70\u308b\uff08\u9023\u643a\u3057\u305f\u306e\u3067\uff09\n\nhttps://registry.hub.docker.com/u/ume3/docker-ubuntu-monit-log/builds_history/94617/\n\n\nBuild Histroy \u306e\u5c65\u6b74\u306f\u305d\u306e\u307e\u307e\u3001GitHub\u306eCommit\u30ed\u30b0\u3068\u540c\u69d8\u3068\u3044\u3046\u3053\u3068\n\n\n\n\u3053\u308c\u3067\u3001\u9023\u643a\u66f4\u65b0\u304c\u53ef\u80fd\u3068\u306a\u3063\u305f\u3002\n\nUbuntu\u3067Fluetnd\n\n\u304a\u307e\u3051\u306e\u3088\u3046\u306b\n\u516c\u5f0f\u306e\u3068\u304a\u308a\uff1ahttp://docs.fluentd.org/ja/articles/install-by-deb\n\n\nDockerfile \u306b\u8a18\u8f09\u3057\u3066\u3052\u308c\u3070\u3088\u3044\n\n\nmodule\u3044\u308c\u308b\u3068\u304d\u3082\u4ee5\u4e0b\u3068\u304b\u3067\n\n\nRUN /usr/lib/fluent/ruby/bin/fluent-gem install fluent-plugin-twitter\n\n\n\u3053\u3046\u306a\u3063\u3066\u304f\u308b\u3068Dockerfile\u4ee5\u5916\u306e\u30d5\u30a1\u30a4\u30eb\u7ba1\u7406\u3092\u3057\u305f\u304f\u306a\u308b\u306e\u3067Github\u9023\u643a\u304c\u3044\u304d\u3066\u304f\u308b\n\n\n\nDockerHub\u304b\u3089\u81ea\u4f5c\u306eDocker\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3046\n\n\u3053\u306e\u30a4\u30e1\u30fc\u30b8\u3092 pull \u3059\u308c\u3070\u3001\u3069\u306e Docker\u74b0\u5883 \u3067\u3082\u4f7f\u3048\u308b\n\n\n\u5225\u306e\u74b0\u5883\u3067\u8d77\u52d5\u3057\u3066\u307f\u3088\u3046\n\n\n\n\nAWS(Ubuntu) + Docker + DockerHub\u30a4\u30e1\u30fc\u30b8\n\nAWS\u3067\u9069\u5f53\u306b\u4f5c\u6210\uff08\u3056\u3063\u304f\u308a\u7701\u7565\uff09\n\u4eca\u3060\u3068VPC\u3067\u3057\u304b\u4f5c\u6210\u3067\u304d\u306a\u3044\uff08\u30af\u30e9\u30b7\u30c3\u30af\u30e2\u30fc\u30c9\u3058\u3083\u306a\u3044\u306a\u3089\uff09\n\n\n\u6c17\u306b\u305b\u305a\u3001 t2.micro \u3042\u305f\u308a\u3067\u3082\u4f7f\u3046(VPC\u9650\u5b9a\u3060\u304c\uff09\n\nec2-user \u3058\u3083\u306a\u304f\u3066 ubuntu\u306a\u306e\u306f\u6ce8\u610f\n\n\n\n\n\nUbuntu + docker\n\n\u516c\u5f0f\u3088\u308a\uff1ahttps://docs.docker.com/installation/ubuntulinux/\n\n\u3053\u306e\u3068\u304a\u308a\u3084\u308c\u3070\u52d5\u304f\u52d5\u304f\n\n\n\u4eca\u56de\u306f\u3001 Ubuntu Trusty 14.04 (LTS) (64-bit)\u306b\u3057\u305f\u3002\n\n\n\n\nDocker\u8d77\u52d5\u5f8c\u3001DockerHub\u3078\u30a2\u30af\u30bb\u30b9\n\nrefs: http://qiita.com/zembutsu/items/b0fbb1ca1a759eff31e4\n\nDockerHub\u306e\u30ed\u30b0\u30a4\u30f3\u60c5\u5831\u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u305f\u305f\u304f\n\n\n\u30ed\u30b0\u30a4\u30f3\n\nubuntu@ip-172-30-0-10:~$ sudo docker login\nUsername: ume3\nPassword: ******\nEmail: <mail@mail.com>\nLogin Succeeded\n\n\n\u81ea\u4f5c\u30a4\u30e1\u30fc\u30b8\u3092pull\u3059\u308b\n\n\u30dd\u30a4\u30f3\u30c8\n\n\n\u3053\u308c\u304c\u3084\u308a\u305f\u3044\u3053\u3068 docker pull <\u81ea\u4f5c\u30a4\u30e1\u30fc\u30b8>\n\n\n\n\nubuntu@ip-172-30-0-10:~$ sudo docker pull ume3/docker-ubuntu-monit-log\nPulling repository ume3/docker-ubuntu-monit-log\ndab621726aea: Pulling dependent layers\n511136ea3c5a: Download complete\n01bf15a18638: Download complete\n30541f8f3062: Download complete\n\n---snip\n\n194a6d0fae98: Download complete\nStatus: Downloaded newer image for ume3/docker-ubuntu-monit-log:latest\n\n\n\u78ba\u8a8d\u3068\u8d77\u52d5\n## \u30a4\u30e1\u30fc\u30b8\u78ba\u8a8d\nubuntu@ip-172-30-0-10:~$ sudo docker images | grep docker-ubuntu-monit-log\nume3/docker-ubuntu-monit-log   latest              dab621726aea        16 minutes ago      257 MB\n## \u8d77\u52d5\nubuntu@ip-172-30-0-10:~$ sudo docker run -dt ume3/docker-ubuntu-monit-log\nce36f0cf42c7e31b4864da3f862e0937711e27bba697579b144b3146005c7be6\n\n## \u8d77\u52d5\u78ba\u8a8d\nubuntu@ip-172-30-0-10:~$ sudo docker ps\nCONTAINER ID        IMAGE                                 COMMAND                CREATED             STATUS              PORTS               NAMES\nce36f0cf42c7        ume3/docker-ubuntu-monit-log:latest   \"/bin/sh -c '/usr/bi   27 seconds ago      Up 27 seconds       22/tcp, 2812/tcp    sick_mccarthy\n\n# \u30b3\u30f3\u30c6\u30ca\u306eip\u3092\u77e5\u308a\u305f\u3044\u306a\u3089\u4ee5\u4e0b\nubuntu@ip-172-30-0-10:~$ sudo sh -c 'docker inspect --format=\"{{ .NetworkSettings.IPAddress }}\" `docker ps -q`'\n172.17.0.82\n\n## SSH OK\nubuntu@ip-172-30-0-10:~$ ssh docker@172.17.0.82\nThe authenticity of host '172.17.0.82 (172.17.0.82)' can't be established.\nECDSA key fingerprint is 6a:aa:ad:15:21:f2:0b:b8:1a:95:0a:5d:6c:71:a6:b4.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '172.17.0.82' (ECDSA) to the list of known hosts.\ndocker@172.17.0.82's password:\nWelcome to Ubuntu 14.04 LTS (GNU/Linux 3.2.0-54-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com/\n---snip\n\n\n\u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u8d77\u52d5\u78ba\u8a8d\u3059\u308c\u3070\u7121\u4e8b\u306b\u305f\u3061\u3042\u304c\u3063\u3066\u3044\u308b\u3002\u3042\u3068\u306f\u3088\u3057\u306a\u306b\u3002\n\n$ bash\ndocker@f255f6f58ca6:~$ sudo netstat -lntp\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\ntcp        0      0 0.0.0.0:24224           0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:24230         0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:8888            0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:2812            0.0.0.0:*               LISTEN      -\ntcp6       0      0 :::22                   :::*                    LISTEN      -\n\n\n\n\u53c2\u8003\u60c5\u5831\n\n\u8aac\u660e\u9014\u4e2d\u306b\u53c2\u7167\u3059\u3079\u304d\u60c5\u5831\u306f\u306e\u305b\u307e\u3057\u305f\u304c\u3001\u591a\u304f\u306e\u304b\u305f\u306e\u60c5\u5831\u3067\u3055\u3055\u3048\u3089\u308c\u307e\u3057\u305f\u3002\n\u30a2\u30a6\u30c8\u30d7\u30c3\u30c8\u4e07\u6b73\n\n\u6d41\u884c\u308a\u7269\u306b\u89e6\u308c\u3066\u307f\u305f\u3002\n\u307f\u306a\u3055\u307e\u306e\u30a2\u30a6\u30c8\u30d7\u30c3\u30c8\u306b\u652f\u3048\u3089\u308c\u3066\u306e\u307e\u3068\u3081\u306e\u3088\u3046\u306a\u3082\u306e\u3002\n\u611f\u8b1d\u3067\u3059\u3002\n\n## \u6210\u679c\u7269\n* https://registry.hub.docker.com/u/ume3/docker-ubuntu-monit-log/dockerfile/\n* https://github.com/ume3/docker-ubuntu-monit-log\n\n### \u8d77\u52d5\n```\ndocker login\ndocker pull ume3/docker-ubuntu-monit-log\ndocker images\ndocker run -dt -p 2812:2812 ume3/docker-ubuntu-monit-log\ndocker ps\n```\n\n* DockerHub\u7d4c\u7531\u3067DL\u3057\u3066\u7acb\u3061\u4e0a\u3052\u308b\u3068Monit\u7d4c\u7531\u3067\u4ee5\u4e0b\u304c\u95b2\u89a7\u3067\u304d\u308b\n * ex) `http://127.0.0.1:2812`\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/68347cc8-08f3-bace-f8e1-21ce2728dca2.png)\n\n---\n\n## \u3064\u304f\u308a\u304b\u305f\n* \u5fc5\u8981\u306a\u3082\u306e\n * [GitHub](https://github.com/)\n * [DockerHub](https://hub.docker.com/)\n* Docker\u3092\u7acb\u3061\u4e0a\u3052\u308b\u74b0\u5883\n * \u4eca\u56de\u306f\u3001Mac(homebrew\u5229\u7528)\n * [boot2docker](https://github.com/boot2docker/boot2docker)\n * VirtulaBox\n* Docker\u3092\u7acb\u3061\u4e0a\u3052\u308b\u74b0\u5883\u305d\u306e2\n * \u4f5c\u3063\u305f\u30a4\u30e1\u30fc\u30b8\u3092\u5225\u306eDocker\u74b0\u5883\u3067\u7528\u610f\u3057\u305f\u3044\u5834\u5408\n * \u9069\u5f53\u306b\uff1aAWS\u3067Ubuntu\u3067\u3082\u305f\u3061\u3042\u3052\u308c\u3070\u3044\u3044\u3093\u3058\u3083\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff08\u96d1\uff09\n\n### GitHub\u306bDockerfile\u3092\u7ba1\u7406\u3057\u305f\u3044\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u4f5c\u6210\u3059\u308b\n* Dokcerfile\u3092\u304a\u304f\u7528\u610f\u3092\u3059\u308b\n * `git clone git@github.com:ume3/docker-ubuntu-monit-log.git`\n * \u8a72\u5f53\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u4f5c\u696d\u3059\u308b\n\n### boot2docker (Mac\u306e\u5834\u5408\uff09\n* Docker\u30b3\u30f3\u30c6\u30ca\u3092\u7acb\u3061\u4e0a\u3052\u308b\u74b0\u5883\u3092\u7528\u610f\u3059\u308b\n * Mac\u3067Docker\u3092\u6271\u3044\u305f\u3044\u306e\u3067homebrew\u3092\u4f7f\u3046\n* refs: https://docs.docker.com/installation/mac/\n* refs: http://qiita.com/AH_korikori/items/8a165c081e8eb699deb3\n\n```\nbrew update\nbrew tap homebrew/binary\nbrew install docker\nbrew install boot2docker\nbrew cask install virtualbox\n```\n\n* boot2docker\u306f `1.3`\u4ee5\u4e0a\u304c\u3088\u3044\u3067\u3059\n * `brew info boot2docker` \u3067\u78ba\u8a8d\n\n#### boot2dockr \u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n* boot2docker\u3092\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\n\n```\nboot2docker init\nboot2docker start\n```\n\n* \u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u6642\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306bdocker\u64cd\u4f5c\u3059\u308b\u969b\u306e\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3059\u308b\n * \u305d\u306e\u307e\u307e\u30b3\u30d4\u30da(or `.zshenv`, `.bashenv`\u306a\u3069\u306b\u8a2d\u5b9a\u3059\u308b\uff09\n\n```\n---snip\nTo connect the Docker client to the Docker daemon, please set:\n    export DOCKER_HOST=tcp://192.168.59.103:2376\n    export DOCKER_CERT_PATH=/Users/hoge/.boot2docker/certs/boot2docker-vm\n    export DOCKER_TLS_VERIFY=1\n```\n\n* Docker\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n```\n% docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS\n```\n\n\u3053\u3053\u307e\u3067\u3067\u6e96\u5099\u306fOK\n\n---\n\n### Dockerfile\u3092\u7528\u610f\u3057\u3066\u30d3\u30eb\u30c9\u3059\u308b\n* `Dockerfile` \u3092\u66f8\u304f\n* ex) Ubuntu\u3067docker:docker\u3067ssh\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u74b0\u5883\n\n```sh\n# Latest Ubuntu LTS\nFROM ubuntu:14.04\nMAINTAINER ume3\n\nENV USER_NAME docker\nENV USER_PASSWORD docker\n\n## install\nRUN apt-get update\nRUN apt-get upgrade -y\nRUN apt-get install sudo passwd openssh-server -y\n\n## setup\n# ssh\nRUN sed -ri 's/^#PermitRootLogin yes$/PermitRootLogin no/' /etc/ssh/sshd_config\n\n# useradd\nRUN useradd $USER_NAME\nRUN echo \"$USER_NAME:$USER_PASSWORD\" | chpasswd\nRUN echo \"$USER_NAME ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers.d/$USER_NAME\nRUN mkdir /var/run/sshd\nRUN mkdir /home/${USER_NAME}\n\n## service\n# ssh\nEXPOSE 22\n\nENTRYPOINT [ \"/usr/sbin/sshd\", \"-D\" ]\n```\n\n* Docker\u30a4\u30e1\u30fc\u30b8\u306e\u4f5c\u6210\n\n```sh\n# build\n% docker build -t ubuntu .\n# images\u306e\u78ba\u8a8d\n% docker images\n```\n\n### Docker\u30b3\u30f3\u30c6\u30ca\u306e\u8d77\u52d5\n* 10000\u756a\u30dd\u30fc\u30c8\u3067\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u8a2d\u5b9a\u3092\u8a18\u8f09\u3059\u308b\uff08\u5f8c\u8ff0\uff09\n\n```\n% docker run -dt -p 10000:22 ubuntu\nbac4eb2001b2f6618a6c3b5b5b4b3e712b968ce403418059d15b92df4ca799b6\n% docker ps\nCONTAINER ID        IMAGE               COMMAND               CREATED             STATUS              PORTS                   NAMES\nbac4eb2001b2        ubuntu:latest       \"/usr/sbin/sshd -D\"   6 days ago          Up 12 seconds       0.0.0.0:10000->22/tcp   hungry_pasteur\n```\n\n### virtualbox\u7d4c\u7531\u3067ssh\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n* boot2docker\u3092\u7acb\u3061\u4e0a\u3052\u308b\u3068\u3001VirtualBox\u306e\u30a4\u30e1\u30fc\u30b8\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u308b\n* virutalbox\u8d77\u52d5\u3088\u308a\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/15b71c71-a214-45a1-7e0a-24415bf429ba.png)\n\n#### VirtualBox\u3067\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\n* refs: \nhttp://blog.ieknir.com/blog/build-docker-image-for-ssh-server/\n\n\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u95a2\u4fc2\u3092\u3064\u304f\u3063\u3066\u3042\u3052\u308b\u3002\n\u4eca\u56de\u306f10000\u756a\u3068\u3059\u308b\u3002\n\n```\n[ssh:10000] -> [boot2docker-vm:10000] -> [docker-container:22]\n```\n\n* GUI\u64cd\u4f5c\u3067\u3082\u3044\u3044\u304c\u30b3\u30de\u30f3\u30c9\u3060\u3068\u4ee5\u4e0b\n\n* before\n\n```sh\n% VBoxManage showvminfo boot2docker-vm | grep ^NIC\nNIC 1:           MAC: 080027502227, Attachment: NAT, Cable connected: on, Trace: off (file: none), Type: virtio, Reported speed: 0 Mbps, Boot priority: 0, Promisc Policy: deny, Bandwidth group: none\nNIC 1 Settings:  MTU: 0, Socket (send: 64, receive: 64), TCP Window (send:64, receive: 64)\nNIC 2:           MAC: 0800276ADD18, Attachment: Host-only Interface 'vboxnet0', Cable connected: on, Trace: off (file: none), Type: virtio, Reported speed: 0 Mbps, Boot priority: 0, Promisc Policy: deny, Bandwidth group: none\nNIC 3:           disabled\nNIC 4:           disabled\nNIC 5:           disabled\nNIC 6:           disabled\nNIC 7:           disabled\nNIC 8:           disabled\n```\n\n* after\n\n```sh\n% VBoxManage controlvm \"boot2docker-vm\" natpf1 \"ssh_container,tcp,127.0.0.1,10000,,10000\"\n\n%  VBoxManage showvminfo boot2docker-vm | grep Rule\nNIC 1 Rule(0):   name = ssh_container, protocol = tcp, host ip = 127.0.0.1, host port = 10000, guest ip = , guest port = 10000\n```\n\n#### VirtualBox(GUI)\u78ba\u8a8d\n* VBoxManage\u3067\u8a2d\u5b9a\u3057\u305f\u3053\u3068\u3067\u4ee5\u4e0b\u3002\u4ed6\u3001\u5fdc\u7528\u304c\u304d\u304f\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/ae43526e-2fe4-9881-5aef-f59d2e840166.png)\n\n#### ssh\u30ed\u30b0\u30a4\u30f3\u78ba\u8a8d\n\n```\n% ssh -p 10000 docker@127.0.0.1\ndocker@127.0.0.1's password:\nWelcome to Ubuntu 14.04 LTS (GNU/Linux 3.2.0-54-generic x86_64)\n---snip\n```\n\nOK\n\n#### \u524a\u9664\u30fb\u6574\u7406\u30b3\u30de\u30f3\u30c9\n* \u3053\u306e\u3042\u305f\u308a\n\n```\ndocker stop <CONTAINER>\ndocker ps\ndocker ps -q\ndocker stop `docker ps -q`\ndocker images\ndocker rmi <IMAGE>\n```\n\n---\n\n## GitHub+DockerHub\n* refs: http://qiita.com/jagaximo/items/4cbda778a10fd37f68e6\n* refs: http://ameblo.jp/tech-cz/entry-11886401333.html\n* refs: http://sawara.me/docker/2055/\n\n### GitHub\n* \u52d5\u4f5c\u78ba\u8a8d\u306e\u3068\u308c\u305f `Dockerfile`\u3092Commit\u3057\u3066\u3001GitHub\u3078`push`\u3057\u3066\u304a\u304f\n\n### DockerHub\n* \u30ed\u30b0\u30a4\u30f3\u5f8c\n * [settings] - [Linked Accounts]\n * GitHub\u3068\u306e\u8a8d\u8a3c\u3092\u5148\u306b\u6e08\u307e\u305b\u3066\u304a\u304f\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/8a812fb6-150a-92f7-107c-eacd9e774875.png)\n\n* \u8a8d\u8a3c\u5f8c\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/78293134-c07e-2ae5-4cd9-2f294344e782.png)\n\n#### Automated Build\n* refs: http://qiita.com/jagaximo/items/4cbda778a10fd37f68e6\n* \u9023\u643a\u958b\u59cb\u3002 `Automated Build` \u3092\u9078\u629e\u3059\u308b\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/adc1e25a-3fca-d524-2400-ae6196ec67b1.png)\n\n* \u753b\u9762\u9077\u79fb\u3057\u3064\u3064\u3001 __\u7528\u610f\u3057\u305fGitHub\u306e\u30ea\u30dd\u30b8\u30c8\u30ea__ \u3092\u53c2\u7167\u3055\u305b\u308b\n * \u3068\u304f\u306b\u8ff7\u308f\u306a\u3044\n\n#### \u9023\u643a\u7d50\u679c\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/390e57e9-ee1e-f208-6fd2-81cf67b1e6db.png)\n\n---\n\n## GitHub\u3078Push\u3059\u308b\u3068DockerHub\u3078Build\u304c\u8d70\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n* \u4eca\u56de\u306e\u30dd\u30a4\u30f3\u30c8\n\n### \u66f4\u65b0\u3057\u3066\u307f\u308b\n* refs: http://qiita.com/mykysyk@github/items/7553e8fef2948de10844\n * Monit\u3092\u3044\u308c\u3066\u307f\u3088\u3046\n* Dockerfile\u3092\u3044\u3058\u3063\u3066 `Monit+sshd` \u74b0\u5883\u3092\u7528\u610f\n * Monit\u306f2812\u30dd\u30fc\u30c8\u3067web\u95b2\u89a7\u3067\u304d\u308b\u8a2d\u5b9a\u306b\u3057\u3066\u3044\u308b\u306e\u3067\u4ee5\u4e0b\n\n```\n% docker build -t ubuntu:monit .\n% docker run -dt -p 10000:22 -p 2812:2812 ubuntu:monit\n% VBoxManage controlvm \"boot2docker-vm\" natpf1 \"monit_contaner,tcp,127.0.0.1,2812,,2812\"\n```\n\n* \u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3067 `http://127.0.0.1;2812` \u3092\u78ba\u8a8d\u3067\u304d\u308b\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/c03da6cf-914b-9dc1-06ed-4b20c0fe2fed.png)\n\n### DockerHub\u306e\u66f4\u65b0\u78ba\u8a8d\n* \u81ea\u8eab\u306e `GitHub` \u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3078 `git push origin master` \u3059\u308b\n* \u3059\u308b\u3068\u3001`DockerHub` \u3067Build\u304c\u8d70\u308b\uff08\u9023\u643a\u3057\u305f\u306e\u3067\uff09\n* https://registry.hub.docker.com/u/ume3/docker-ubuntu-monit-log/builds_history/94617/\n * `Build Histroy` \u306e\u5c65\u6b74\u306f\u305d\u306e\u307e\u307e\u3001GitHub\u306eCommit\u30ed\u30b0\u3068\u540c\u69d8\u3068\u3044\u3046\u3053\u3068\n\n\u3053\u308c\u3067\u3001\u9023\u643a\u66f4\u65b0\u304c\u53ef\u80fd\u3068\u306a\u3063\u305f\u3002\n\n### Ubuntu\u3067Fluetnd\n* \u304a\u307e\u3051\u306e\u3088\u3046\u306b\n* \u516c\u5f0f\u306e\u3068\u304a\u308a\uff1ahttp://docs.fluentd.org/ja/articles/install-by-deb\n * `Dockerfile` \u306b\u8a18\u8f09\u3057\u3066\u3052\u308c\u3070\u3088\u3044\n* module\u3044\u308c\u308b\u3068\u304d\u3082\u4ee5\u4e0b\u3068\u304b\u3067\n * `RUN /usr/lib/fluent/ruby/bin/fluent-gem install fluent-plugin-twitter`\n* \u3053\u3046\u306a\u3063\u3066\u304f\u308b\u3068Dockerfile\u4ee5\u5916\u306e\u30d5\u30a1\u30a4\u30eb\u7ba1\u7406\u3092\u3057\u305f\u304f\u306a\u308b\u306e\u3067Github\u9023\u643a\u304c\u3044\u304d\u3066\u304f\u308b\n\n---\n\n## DockerHub\u304b\u3089\u81ea\u4f5c\u306eDocker\u30a4\u30e1\u30fc\u30b8\u3092\u4f7f\u3046\n* \u3053\u306e\u30a4\u30e1\u30fc\u30b8\u3092 `pull` \u3059\u308c\u3070\u3001\u3069\u306e `Docker\u74b0\u5883` \u3067\u3082\u4f7f\u3048\u308b\n * \u5225\u306e\u74b0\u5883\u3067\u8d77\u52d5\u3057\u3066\u307f\u3088\u3046\n\n### AWS(Ubuntu) + Docker + DockerHub\u30a4\u30e1\u30fc\u30b8\n* AWS\u3067\u9069\u5f53\u306b\u4f5c\u6210\uff08\u3056\u3063\u304f\u308a\u7701\u7565\uff09\n* \u4eca\u3060\u3068VPC\u3067\u3057\u304b\u4f5c\u6210\u3067\u304d\u306a\u3044\uff08\u30af\u30e9\u30b7\u30c3\u30af\u30e2\u30fc\u30c9\u3058\u3083\u306a\u3044\u306a\u3089\uff09\n * \u6c17\u306b\u305b\u305a\u3001 `t2.micro` \u3042\u305f\u308a\u3067\u3082\u4f7f\u3046(VPC\u9650\u5b9a\u3060\u304c\uff09\n * `ec2-user` \u3058\u3083\u306a\u304f\u3066 `ubuntu`\u306a\u306e\u306f\u6ce8\u610f\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/20303/eda7c67d-a1b7-1abe-8a89-4326db24d445.png)\n\n\n#### Ubuntu + docker\n* \u516c\u5f0f\u3088\u308a\uff1ahttps://docs.docker.com/installation/ubuntulinux/\n* \u3053\u306e\u3068\u304a\u308a\u3084\u308c\u3070\u52d5\u304f\u52d5\u304f\n * \u4eca\u56de\u306f\u3001 `Ubuntu Trusty 14.04 (LTS) (64-bit)`\u306b\u3057\u305f\u3002\n\n### Docker\u8d77\u52d5\u5f8c\u3001DockerHub\u3078\u30a2\u30af\u30bb\u30b9\n* refs: http://qiita.com/zembutsu/items/b0fbb1ca1a759eff31e4\n * DockerHub\u306e\u30ed\u30b0\u30a4\u30f3\u60c5\u5831\u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u305f\u305f\u304f\n* \u30ed\u30b0\u30a4\u30f3\n\n```\nubuntu@ip-172-30-0-10:~$ sudo docker login\nUsername: ume3\nPassword: ******\nEmail: <mail@mail.com>\nLogin Succeeded\n```\n\n#### \u81ea\u4f5c\u30a4\u30e1\u30fc\u30b8\u3092pull\u3059\u308b\n* \u30dd\u30a4\u30f3\u30c8\n * \u3053\u308c\u304c\u3084\u308a\u305f\u3044\u3053\u3068 `docker pull <\u81ea\u4f5c\u30a4\u30e1\u30fc\u30b8>`\n\n```shell-session\nubuntu@ip-172-30-0-10:~$ sudo docker pull ume3/docker-ubuntu-monit-log\nPulling repository ume3/docker-ubuntu-monit-log\ndab621726aea: Pulling dependent layers\n511136ea3c5a: Download complete\n01bf15a18638: Download complete\n30541f8f3062: Download complete\n\n---snip\n\n194a6d0fae98: Download complete\nStatus: Downloaded newer image for ume3/docker-ubuntu-monit-log:latest\n```\n\n### \u78ba\u8a8d\u3068\u8d77\u52d5\n```sh\n## \u30a4\u30e1\u30fc\u30b8\u78ba\u8a8d\nubuntu@ip-172-30-0-10:~$ sudo docker images | grep docker-ubuntu-monit-log\nume3/docker-ubuntu-monit-log   latest              dab621726aea        16 minutes ago      257 MB\n## \u8d77\u52d5\nubuntu@ip-172-30-0-10:~$ sudo docker run -dt ume3/docker-ubuntu-monit-log\nce36f0cf42c7e31b4864da3f862e0937711e27bba697579b144b3146005c7be6\n\n## \u8d77\u52d5\u78ba\u8a8d\nubuntu@ip-172-30-0-10:~$ sudo docker ps\nCONTAINER ID        IMAGE                                 COMMAND                CREATED             STATUS              PORTS               NAMES\nce36f0cf42c7        ume3/docker-ubuntu-monit-log:latest   \"/bin/sh -c '/usr/bi   27 seconds ago      Up 27 seconds       22/tcp, 2812/tcp    sick_mccarthy\n```\n\n```sh\n# \u30b3\u30f3\u30c6\u30ca\u306eip\u3092\u77e5\u308a\u305f\u3044\u306a\u3089\u4ee5\u4e0b\nubuntu@ip-172-30-0-10:~$ sudo sh -c 'docker inspect --format=\"{{ .NetworkSettings.IPAddress }}\" `docker ps -q`'\n172.17.0.82\n\n## SSH OK\nubuntu@ip-172-30-0-10:~$ ssh docker@172.17.0.82\nThe authenticity of host '172.17.0.82 (172.17.0.82)' can't be established.\nECDSA key fingerprint is 6a:aa:ad:15:21:f2:0b:b8:1a:95:0a:5d:6c:71:a6:b4.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '172.17.0.82' (ECDSA) to the list of known hosts.\ndocker@172.17.0.82's password:\nWelcome to Ubuntu 14.04 LTS (GNU/Linux 3.2.0-54-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com/\n---snip\n```\n\n* \u30ed\u30b0\u30a4\u30f3\u5f8c\u3001\u8d77\u52d5\u78ba\u8a8d\u3059\u308c\u3070\u7121\u4e8b\u306b\u305f\u3061\u3042\u304c\u3063\u3066\u3044\u308b\u3002\u3042\u3068\u306f\u3088\u3057\u306a\u306b\u3002\n\n```sh\n$ bash\ndocker@f255f6f58ca6:~$ sudo netstat -lntp\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\ntcp        0      0 0.0.0.0:24224           0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:24230         0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:8888            0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:2812            0.0.0.0:*               LISTEN      -\ntcp6       0      0 :::22                   :::*                    LISTEN      -\n```\n\n\n---\n\n\n### \u53c2\u8003\u60c5\u5831\n* \u8aac\u660e\u9014\u4e2d\u306b\u53c2\u7167\u3059\u3079\u304d\u60c5\u5831\u306f\u306e\u305b\u307e\u3057\u305f\u304c\u3001\u591a\u304f\u306e\u304b\u305f\u306e\u60c5\u5831\u3067\u3055\u3055\u3048\u3089\u308c\u307e\u3057\u305f\u3002\n* \u30a2\u30a6\u30c8\u30d7\u30c3\u30c8\u4e07\u6b73\n", "tags": ["docker", "DockerHub", "monit", "fluentd", "Ubuntu14.04"]}