{"context": " More than 1 year has passed since last update.SELECT\n    TD_TIME_FORMAT(time, 'yyyy-MM', 'JST'),\n    COUNT(*) AS total\n FROM hoge_table\nWHERE action = 'page_view'\n  AND TD_TIME_RANGE(\n        time,\n        IF(DAY(TD_TIME_FORMAT(UNIX_TIMESTAMP(), 'yyyy-MM-dd', 'JST')) = 1,\n           TD_TIME_FORMAT(TD_TIME_ADD(UNIX_TIMESTAMP(), '-1d', 'JST'), 'yyyy-MM-01 00:00:00', 'JST'),\n           TD_TIME_FORMAT(UNIX_TIMESTAMP(), 'yyyy-MM-01 00:00:00', 'JST')),\n        TD_TIME_FORMAT(UNIX_TIMESTAMP(), 'yyyy-MM-dd 00:00:00', 'JST'),\n        'JST'\n      )\nGROUP BY TD_TIME_FORMAT(time, 'yyyy-MM', 'JST')\n\nhoge_table \u306b page_view \u3068\u3044\u3046 action \u540d\u3067\u30ec\u30b3\u30fc\u30c9\u304c\u306f\u3044\u3063\u3066\u308b\u3068\u3057\u3066\u3002\n\u6bce\u65e5\u6628\u65e5\u307e\u3067\u306e\u6708\u9593PV\u3092\u96c6\u8a08\u3059\u308b\u3088\u3046\u306a\u30af\u30a8\u30ea\u30fc\u3002\nJST \u3092\u3064\u3051\u307e\u304f\u3089\u306a\u304d\u3083\u306a\u3089\u306a\u3044\u306e\u304c\u9762\u5012\u3002\n```sql\nSELECT\n    TD_TIME_FORMAT(time, 'yyyy-MM', 'JST'),\n    COUNT(*) AS total\n FROM hoge_table\nWHERE action = 'page_view'\n  AND TD_TIME_RANGE(\n        time,\n        IF(DAY(TD_TIME_FORMAT(UNIX_TIMESTAMP(), 'yyyy-MM-dd', 'JST')) = 1,\n           TD_TIME_FORMAT(TD_TIME_ADD(UNIX_TIMESTAMP(), '-1d', 'JST'), 'yyyy-MM-01 00:00:00', 'JST'),\n           TD_TIME_FORMAT(UNIX_TIMESTAMP(), 'yyyy-MM-01 00:00:00', 'JST')),\n        TD_TIME_FORMAT(UNIX_TIMESTAMP(), 'yyyy-MM-dd 00:00:00', 'JST'),\n        'JST'\n      )\nGROUP BY TD_TIME_FORMAT(time, 'yyyy-MM', 'JST')\n```\n\nhoge_table \u306b page_view \u3068\u3044\u3046 action \u540d\u3067\u30ec\u30b3\u30fc\u30c9\u304c\u306f\u3044\u3063\u3066\u308b\u3068\u3057\u3066\u3002\n\u6bce\u65e5\u6628\u65e5\u307e\u3067\u306e\u6708\u9593PV\u3092\u96c6\u8a08\u3059\u308b\u3088\u3046\u306a\u30af\u30a8\u30ea\u30fc\u3002\n\nJST \u3092\u3064\u3051\u307e\u304f\u3089\u306a\u304d\u3083\u306a\u3089\u306a\u3044\u306e\u304c\u9762\u5012\u3002\n", "tags": ["TreasureData", "hive"]}