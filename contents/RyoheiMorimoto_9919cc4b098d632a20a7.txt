{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\njQuery\u306eajax\u3092\u4f7f\u3046\u95a2\u6570\u306eUnit test\u3067sinon.js\u3092\u4f7f\u3046\u5834\u5408\u3001fakeServer\u3092\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001Stub\u3092\u4f7f\u3063\u3066\u66f8\u304f\u65b9\u6cd5\u3092\u30e1\u30e2\u7a0b\u5ea6\u306b\u6b8b\u3057\u3066\u304a\u304f\u3002\n\n\u66f8\u304d\u65b9\n\n\u30c6\u30b9\u30c8\u5bfe\u8c61\u306e\u30b3\u30fc\u30c9\n\u3053\u3093\u306a\u611f\u3058\u306eWeb API\u306e\u5b9f\u884c\u30b3\u30fc\u30c9\u3092\u60f3\u5b9a\u3059\u308b\nvar ajaxTest = {\n    getHoge : function() {\n        return $.ajax({\n            type : 'GET',\n            url : 'hoge',\n            dataType : 'json',\n            contentType : 'application/json; charset=UTF-8'\n        });\n    }\n};\n\n\nstub\u3092\u4f7f\u3063\u3066\u30c6\u30b9\u30c8\n// JsTestDriver + sinon.js\nTestCase('ajax test', {\n    'testGetHoge' : function() {\n        sinon.stub($, 'ajax').returns({\n            done : function(cb) {\n                cb('hoge');\n            }\n        });\n\n        ajaxTest.getHoge().done(function(data) {\n            assertEquals('hoge', data);\n            $.ajax.restore();\n        });\n    }\n});\n\n\u30dd\u30a4\u30f3\u30c8\u306f $.ajax \u3092\u4e38\u3054\u3068Stub\u3067\u7f6e\u304d\u63db\u3048\u3066\u3044\u308b\u3068\u3053\u308d\u3002\najax\u304c\u8fd4\u3059done\u95a2\u6570\u3092Mock\u3057\u3066\u3084\u308a\u307e\u3059\u3002\n\u4e00\u5fdc\u3053\u308c\u3067\u30ab\u30d0\u30ec\u30c3\u30b8\u306f100%\u306b\u306a\u308b\u306e\u3067\u3001\u308f\u3056\u308f\u3056fakeServer\u3092\u4f5c\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001sinon\u3067\u4f5c\u3063\u305fstub\u306f\u4ed6\u306eTest Suite\u306b\u3082\u5f15\u304d\u7d99\u304c\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u3061\u3083\u3093\u3068 restore() \u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306bfakeServer\u3092\u4f7f\u3046\u3068\u3053\u3093\u306a\u611f\u3058\n// JsTestDriver + sinon.js\nTestCase('ajax test', sinon.testCase({\n    'testGetHoge' : function(server) {\n        this.server = sinon.fakeServer.create();\n\n        ajaxTest.getHoge().done(function(data) {\n            assertEquals('hoge', data);\n        });\n\n        this.server.requests[0].respond(200, {\n            'content-type' : 'application/json'\n        }, 'hoge');\n    }\n}));\n\n\u3042\u308c\uff1f fakeServer\u306e\u65b9\u304c\u7c21\u5358\u2026\uff1f\n# \u306f\u3058\u3081\u306b\njQuery\u306eajax\u3092\u4f7f\u3046\u95a2\u6570\u306eUnit test\u3067sinon.js\u3092\u4f7f\u3046\u5834\u5408\u3001fakeServer\u3092\u4f7f\u3046\u3053\u3068\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001Stub\u3092\u4f7f\u3063\u3066\u66f8\u304f\u65b9\u6cd5\u3092\u30e1\u30e2\u7a0b\u5ea6\u306b\u6b8b\u3057\u3066\u304a\u304f\u3002\n\n# \u66f8\u304d\u65b9\n## \u30c6\u30b9\u30c8\u5bfe\u8c61\u306e\u30b3\u30fc\u30c9\n\u3053\u3093\u306a\u611f\u3058\u306eWeb API\u306e\u5b9f\u884c\u30b3\u30fc\u30c9\u3092\u60f3\u5b9a\u3059\u308b\n\n```javascript\nvar ajaxTest = {\n    getHoge : function() {\n        return $.ajax({\n            type : 'GET',\n            url : 'hoge',\n            dataType : 'json',\n            contentType : 'application/json; charset=UTF-8'\n        });\n    }\n};\n```\n\n## stub\u3092\u4f7f\u3063\u3066\u30c6\u30b9\u30c8\n```javascript\n// JsTestDriver + sinon.js\nTestCase('ajax test', {\n    'testGetHoge' : function() {\n        sinon.stub($, 'ajax').returns({\n            done : function(cb) {\n                cb('hoge');\n            }\n        });\n\n        ajaxTest.getHoge().done(function(data) {\n            assertEquals('hoge', data);\n            $.ajax.restore();\n        });\n    }\n});\n```\n\n\u30dd\u30a4\u30f3\u30c8\u306f `$.ajax` \u3092\u4e38\u3054\u3068Stub\u3067\u7f6e\u304d\u63db\u3048\u3066\u3044\u308b\u3068\u3053\u308d\u3002\najax\u304c\u8fd4\u3059done\u95a2\u6570\u3092Mock\u3057\u3066\u3084\u308a\u307e\u3059\u3002\n\u4e00\u5fdc\u3053\u308c\u3067\u30ab\u30d0\u30ec\u30c3\u30b8\u306f100%\u306b\u306a\u308b\u306e\u3067\u3001\u308f\u3056\u308f\u3056fakeServer\u3092\u4f5c\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001sinon\u3067\u4f5c\u3063\u305fstub\u306f\u4ed6\u306eTest Suite\u306b\u3082\u5f15\u304d\u7d99\u304c\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u3061\u3083\u3093\u3068 `restore()` \u3057\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n## \u3061\u306a\u307f\u306bfakeServer\u3092\u4f7f\u3046\u3068\u3053\u3093\u306a\u611f\u3058\n```javascript\n// JsTestDriver + sinon.js\nTestCase('ajax test', sinon.testCase({\n    'testGetHoge' : function(server) {\n        this.server = sinon.fakeServer.create();\n\n        ajaxTest.getHoge().done(function(data) {\n            assertEquals('hoge', data);\n        });\n\n        this.server.requests[0].respond(200, {\n            'content-type' : 'application/json'\n        }, 'hoge');\n    }\n}));\n```\n\n\u3042\u308c\uff1f fakeServer\u306e\u65b9\u304c\u7c21\u5358\u2026\uff1f\n", "tags": ["JavaScript", "Sinon.JS", "Ajax"]}