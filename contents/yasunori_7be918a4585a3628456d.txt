{"tags": ["Python", "Flask"], "context": " More than 1 year has passed since last update.\u3053\u308c\u3067\u3044\u3051\u307e\u3057\u305f\n\u305f\u3068\u3048\u3070UserAgent\u3092\u3044\u3058\u308b\n\u3068\u3044\u3046\u304b\u3053\u308c\u306e\u307e\u307e\u3067\u3059\nhttp://stackoverflow.com/questions/15278285/setting-mocking-request-headers-for-flask-app-unit-test\n\ntests.py\n# -*- coding: utf-8 -*-\nfrom nose.tools import ok_, eq_\nimport flask\n\nclass ClientProxy(object):\n    def __init__(self, app):\n        self.app = app\n\n    def __call__(self, environ, start_response):\n        environ['HTTP_USER_AGENT'] = environ.get('HTTP_USER_AGENT', 'hogehoge')\n        return self.app(environ, start_response)\n\n\ndef sample_test():\n    app = flask.Flask(__name__)\n    app.wsgi_app = ClientProxy(app.wsgi_app)\n    with app.test_client() as c:\n        c.get('/')\n        eq_(flask.request.user_agent.string, 'hogehoge')\n\n\n\n\u3053\u308c\u3067\u3044\u3051\u307e\u3057\u305f\n\u305f\u3068\u3048\u3070UserAgent\u3092\u3044\u3058\u308b\n\n\u3068\u3044\u3046\u304b\u3053\u308c\u306e\u307e\u307e\u3067\u3059\nhttp://stackoverflow.com/questions/15278285/setting-mocking-request-headers-for-flask-app-unit-test\n\n\n``` tests.py\n# -*- coding: utf-8 -*-\nfrom nose.tools import ok_, eq_\nimport flask\n\nclass ClientProxy(object):\n    def __init__(self, app):\n        self.app = app\n\n    def __call__(self, environ, start_response):\n        environ['HTTP_USER_AGENT'] = environ.get('HTTP_USER_AGENT', 'hogehoge')\n        return self.app(environ, start_response)\n\n\ndef sample_test():\n    app = flask.Flask(__name__)\n    app.wsgi_app = ClientProxy(app.wsgi_app)\n    with app.test_client() as c:\n        c.get('/')\n        eq_(flask.request.user_agent.string, 'hogehoge')\n```\n"}