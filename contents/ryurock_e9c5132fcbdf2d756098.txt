{"context": " More than 1 year has passed since last update.apache\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092\u89e3\u6790\u3059\u308b\u70ba\u306b\u3054\u306b\u3087\u3054\u306b\u3087\u3084\u3063\u3066\u307f\u305f\u3068\u304d\u306e\u30e1\u30e2\n\n\u3084\u308a\u305f\u3044\u3053\u3068\napache\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092mongodb\u306b\u5165\u308c\u3066\u89e3\u6790\u3092\u3054\u306b\u3087\u3054\u306b\u3087\u3057\u305f\u3044\u3002\n\u4eca\u56de\u306f\u5143\u306b\u306a\u308bapache\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092\u89e3\u51cd\u3059\u308b\u306e\u306b\u3069\u306e\u65b9\u6cd5\u304c\u4e00\u756a\u65e9\u3044\u304b\u3092\u691c\u8a3c\u3059\u308b\n\n\u524d\u63d0\u6761\u4ef6\napache\u306e\u904e\u53bb\u30ed\u30b0\u306f.gz\u3067\u5727\u7e2e\u3055\u308c\u3066\u3044\u3066\u30b9\u30c8\u30ec\u30fc\u30b8\u30b5\u30fc\u30d0\u30fc\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3068\u3059\u308b\n\n\u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u69cb\u6210(\u5727\u7e2e\u3055\u308c\u3066\u3044\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210)\ntree\n\n\u30b9\u30c8\u30ec\u30fc\u30b8/\n\u2514\u2500\u2500 \u65e5\u4ed8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n    \u251c\u2500\u2500 WEB01\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 access_log.gz\n    \u251c\u2500\u2500 WEB02\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 access_log.gz\n    \u251c\u2500\u2500 WEB03\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 access_log.gz\n    #\u2026\u2026\u3053\u308c\u304c370\u53f0\u3042\u308b\n\n\u4e0a\u8a18\u3067\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092mongodb\u306b\u7a81\u3063\u8fbc\u3080\u306e\u304c\u76ee\u7684\n\n\u4e00\u53f0\u3042\u305f\u308a\u306eapache\u30ed\u30b0\u306e\u5bb9\u91cf\n\u30b9\u30de\u30db\u7528270\u53f0\u3068\u30ac\u30e9\u30b1\u30fc\u7528100\u53f0\u3067\u305d\u308c\u305e\u308c\u5bb9\u91cf\u304c\u7570\u306a\u308b\n#\u30b9\u30de\u30db\u7528\ndu -m access_log.gz \n34  access_log.gz\n\n#\u30ac\u30e9\u30b1\u30fc\u7528\ndu -m access_log.gz \n\n10  access_log.gz\n\n\n\n\u7dcf\u5bb9\u91cf\ndu -m /path/to/\u30ed\u30b0\u30b9\u30c8\u30ec\u30fc\u30b8/ | awk '{sum += $1} END {gb = sum / 1024} END {print gb \"GB\"}'\n29.5322GB\n\n\u304a\u3075\u3063\u3002\u3002\u3002\u3002apache\u306e\u30ed\u30b0\u3060\u3051\u306730GB\u3042\u308b\n\n\u5b9f\u884c\u74b0\u5883(Amazon EC2)\n\nOS\ncat /etc/redhat-release\n\nCentOS release 6.2 (Final)\n\n\nCPU\ncat /proc/cpuinfo \n\nprocessor   : 0\nvendor_id   : GenuineIntel\ncpu family  : 6\nmodel       : 45\nmodel name  : Intel(R) Xeon(R) CPU E5-2650 0 @ 2.00GHz\nstepping    : 7\ncpu MHz     : 1800.001\ncache size  : 20480 KB\nfpu     : yes\nfpu_exception   : yes\ncpuid level : 13\nwp      : yes\nflags       : fpu de tsc msr pae cx8 cmov pat clflush mmx fxsr sse sse2 ss ht syscall nx lm rep_good unfair_spinlock pni pclmulqdq ssse3 cx16 sse4_1 sse4_2 x2apic popcnt aes hypervisor lahf_lm\nbogomips    : 3600.00\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 46 bits physical, 48 bits virtual\npower management:\n\n\u4e0a\u8a18\u306e\u540c\u69d8\u306e\u69cb\u6210\u30678\u30b3\u30a2\n\n\u30e1\u30e2\u30ea\ncat /proc/meminfo\nMemTotal:        7130488 kB\n\n#\u898b\u3065\u3089\u3044\u306e\u3067\ncat /proc/meminfo |grep MemTotal | awk '{sum= $2} END {mb = expr sum / 1024} END {print mb \"MB\"}'\n\n6963.37MB\n\n\u7d047GB\u3067\u3059\u3002\n\n\u30ed\u30b0\u53ce\u96c6\u3059\u308bWEB\u30b5\u30fc\u30d0\u30fc\u306e\u53f0\u6570\n370\u53f0\n\n\u691c\u8a3c\n\n\u4e00\u53f0\u306eWEB\u30b5\u30fc\u30d0\u30fc\u306e\u89e3\u51cd\u306b\u304b\u304b\u308b\u6642\u9593\u3092\u8a08\u308b\ntime gzip -dc /path/to/\u30b9\u30c8\u30ec\u30fc\u30b8/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log.gz > /path/to/\u5c55\u958b\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea/raw_log/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log\n\nreal    0m9.531s\nuser    0m2.408s\nsys 0m0.551s\n\n1\u53f0\u3042\u305f\u308a10\u79d2(\u56db\u6368\u4e94\u5165)\u304b\u304b\u308b\u8a08\u7b97\u306a\u306e\u3067370\u53f0\u3060\u3068\n(10 * 370) / 60 = 61.6666666667\n\n\u7d0462\u5206(\u7d041\u6642\u9593)\u304b\u304b\u308b\u8a08\u7b97\u3067\u3059\n\nCPU\u6570\u306b\u5fdc\u3058\u3066\u30d1\u30a4\u30d7\u51e6\u7406\u3092\u3057\u3066\u89e3\u51cd\u3092\u3057\u3066\u307f\u305f\n\u4e00\u756a\u6700\u521d\u4e00\u6c17\u306b370\u53f0\u5206\u306e\u5b50\u30d7\u30ed\u30bb\u30b9\u3092\u7a4d\u3093\u3067\u3084\u3063\u3066\u307f\u305f\u304c\n\u3084\u3063\u3071\u308a\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u51fa\u306a\u304b\u3063\u305f\n#\u3053\u308c\u3067370\u306e\u5b50\u30d7\u30ed\u30bb\u30b9\u306b\u4e00\u6c17\u306b\u7a4d\u3093\u3060 (\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092370\u56de\u30eb\u30fc\u30d7\u3055\u305b\u308bshell\u3092\u66f8\u3044\u305f)\ntime gzip -dc /path/to/\u30b9\u30c8\u30ec\u30fc\u30b8/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log.gz > /path/to/\u5c55\u958b\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea/raw_log/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log &\n\n\u3068\u3042\u308b\u4eba\u304b\u3089\u300cCPU\u6570\u306b\u5fdc\u3058\u3066\u5b50\u30d7\u30ed\u30bb\u30b9\u3092\u4f5c\u308c\u3070\u4e26\u5217\u3067\u4e00\u756a\u65e9\u304f\u3067\u304d\u308b\u3093\u3058\u3083\u3042\u306a\u3044\uff1f\u300d\u3068\u8a00\u308f\u308c\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u305f\n#\u3053\u308c\u3067CPU\u306e\u6570\u304c\u3060\u305b\u308b\ncat /proc/cpuinfo | grep processor | wc | awk '{print $1}'\n\n8\n\n#\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u30d1\u30a4\u30d7\u51e6\u7406\u30678\u500b\u306b\u9023\u7d50\u3057\u3066(370 /8) = 47\u56de\u30eb\u30fc\u30d7\u3055\u305b\u308b\ntime gzip -dc /path/to/\u30b9\u30c8\u30ec\u30fc\u30b8/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log.gz > /path/to/\u5c55\u958b\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea/raw_log/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log |\n\n\n\u7d50\u679c\n\n370\u53f0\u306e\u30ed\u30b0\u306e\u89e3\u51cd\u306b\u304b\u304b\u3063\u305f\u6642\u9593\nreal    32m13.975s\nuser    12m11.686s\nsys 2m32.123s\n\n\n\n30\u5206\u5f31\u3067\u89e3\u51cd\u3067\u304d\u305f\u304c\u7406\u8ad6\u4e0a\u306e\u6570\u5b57\u3068\u5408\u308f\u306a\u3044\u3002\u3002\u3002\u3002\n#\u7406\u8ad6\u4e0a\u3067\u3067\u308b\u30b9\u30d4\u30fc\u30c9\n((47 * 10) / 60) = 7.83333333333 \u5206\n\n\u30e1\u30e2\u30ea\u304c\u591a\u5206\u8ffd\u3063\u4ed8\u304b\u306a\u3044\u306e\u3067\u3057\u3087\u3046\u3002\u3002\u3002\n\n\u89e3\u51cd\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u7dcf\u5bb9\u91cf\u3092\u8abf\u3079\u308b\ndu -m /path/to/\u5c55\u958b\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea/raw_log/ | awk '{sum += $1} END {gb = sum / 1024} END {print gb \"GB\"}'\n\n207.183GB\n\n\u4e00\u65e5\u3067apache\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3060\u3051\u3067207GB\u3042\u308b\u3093\u3067\u3059\u306d\u3002\u3002\u3002\n\napache\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092\u89e3\u6790\u3059\u308b\u70ba\u306b\u3054\u306b\u3087\u3054\u306b\u3087\u3084\u3063\u3066\u307f\u305f\u3068\u304d\u306e\u30e1\u30e2\n\n## \u3084\u308a\u305f\u3044\u3053\u3068\n\napache\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092mongodb\u306b\u5165\u308c\u3066\u89e3\u6790\u3092\u3054\u306b\u3087\u3054\u306b\u3087\u3057\u305f\u3044\u3002\n\u4eca\u56de\u306f\u5143\u306b\u306a\u308bapache\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092\u89e3\u51cd\u3059\u308b\u306e\u306b\u3069\u306e\u65b9\u6cd5\u304c\u4e00\u756a\u65e9\u3044\u304b\u3092\u691c\u8a3c\u3059\u308b\n\n## \u524d\u63d0\u6761\u4ef6\n\napache\u306e\u904e\u53bb\u30ed\u30b0\u306f.gz\u3067\u5727\u7e2e\u3055\u308c\u3066\u3044\u3066\u30b9\u30c8\u30ec\u30fc\u30b8\u30b5\u30fc\u30d0\u30fc\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3068\u3059\u308b\n\n## \u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u69cb\u6210(\u5727\u7e2e\u3055\u308c\u3066\u3044\u308b\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210)\n\n```shell\ntree\n\n\u30b9\u30c8\u30ec\u30fc\u30b8/\n\u2514\u2500\u2500 \u65e5\u4ed8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\n    \u251c\u2500\u2500 WEB01\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 access_log.gz\n    \u251c\u2500\u2500 WEB02\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 access_log.gz\n    \u251c\u2500\u2500 WEB03\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 access_log.gz\n    #\u2026\u2026\u3053\u308c\u304c370\u53f0\u3042\u308b\n```\n\n\u4e0a\u8a18\u3067\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092mongodb\u306b\u7a81\u3063\u8fbc\u3080\u306e\u304c\u76ee\u7684\n\n##\u4e00\u53f0\u3042\u305f\u308a\u306eapache\u30ed\u30b0\u306e\u5bb9\u91cf\n\n\u30b9\u30de\u30db\u7528270\u53f0\u3068\u30ac\u30e9\u30b1\u30fc\u7528100\u53f0\u3067\u305d\u308c\u305e\u308c\u5bb9\u91cf\u304c\u7570\u306a\u308b\n\n```\n#\u30b9\u30de\u30db\u7528\ndu -m access_log.gz \n34\taccess_log.gz\n\n#\u30ac\u30e9\u30b1\u30fc\u7528\ndu -m access_log.gz \n\n10\taccess_log.gz\n\n```\n\n###\u7dcf\u5bb9\u91cf\n\n\n```\ndu -m /path/to/\u30ed\u30b0\u30b9\u30c8\u30ec\u30fc\u30b8/ | awk '{sum += $1} END {gb = sum / 1024} END {print gb \"GB\"}'\n29.5322GB\n```\n\n\u304a\u3075\u3063\u3002\u3002\u3002\u3002apache\u306e\u30ed\u30b0\u3060\u3051\u306730GB\u3042\u308b\n\n\n## \u5b9f\u884c\u74b0\u5883(Amazon EC2)\n\n### OS\n\n```shell\ncat /etc/redhat-release\n\nCentOS release 6.2 (Final)\n```\n\n### CPU\n\n```shell\ncat /proc/cpuinfo \n\nprocessor\t: 0\nvendor_id\t: GenuineIntel\ncpu family\t: 6\nmodel\t\t: 45\nmodel name\t: Intel(R) Xeon(R) CPU E5-2650 0 @ 2.00GHz\nstepping\t: 7\ncpu MHz\t\t: 1800.001\ncache size\t: 20480 KB\nfpu\t\t: yes\nfpu_exception\t: yes\ncpuid level\t: 13\nwp\t\t: yes\nflags\t\t: fpu de tsc msr pae cx8 cmov pat clflush mmx fxsr sse sse2 ss ht syscall nx lm rep_good unfair_spinlock pni pclmulqdq ssse3 cx16 sse4_1 sse4_2 x2apic popcnt aes hypervisor lahf_lm\nbogomips\t: 3600.00\nclflush size\t: 64\ncache_alignment\t: 64\naddress sizes\t: 46 bits physical, 48 bits virtual\npower management:\n```\n\n\u4e0a\u8a18\u306e\u540c\u69d8\u306e\u69cb\u6210\u30678\u30b3\u30a2\n\n\n### \u30e1\u30e2\u30ea\n\n```shell\ncat /proc/meminfo\nMemTotal:        7130488 kB\n\n#\u898b\u3065\u3089\u3044\u306e\u3067\ncat /proc/meminfo |grep MemTotal | awk '{sum= $2} END {mb = expr sum / 1024} END {print mb \"MB\"}'\n\n6963.37MB\n```\n\n\u7d047GB\u3067\u3059\u3002\n\n\n## \u30ed\u30b0\u53ce\u96c6\u3059\u308bWEB\u30b5\u30fc\u30d0\u30fc\u306e\u53f0\u6570\n\n370\u53f0\n\n## \u691c\u8a3c\n\n### \u4e00\u53f0\u306eWEB\u30b5\u30fc\u30d0\u30fc\u306e\u89e3\u51cd\u306b\u304b\u304b\u308b\u6642\u9593\u3092\u8a08\u308b\n\n```shell\ntime gzip -dc /path/to/\u30b9\u30c8\u30ec\u30fc\u30b8/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log.gz > /path/to/\u5c55\u958b\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea/raw_log/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log\n\nreal\t0m9.531s\nuser\t0m2.408s\nsys\t0m0.551s\n```\n\n1\u53f0\u3042\u305f\u308a10\u79d2(\u56db\u6368\u4e94\u5165)\u304b\u304b\u308b\u8a08\u7b97\u306a\u306e\u3067370\u53f0\u3060\u3068\n\n```\n(10 * 370) / 60 = 61.6666666667\n```\n\n\u7d0462\u5206(\u7d041\u6642\u9593)\u304b\u304b\u308b\u8a08\u7b97\u3067\u3059\n\n## CPU\u6570\u306b\u5fdc\u3058\u3066\u30d1\u30a4\u30d7\u51e6\u7406\u3092\u3057\u3066\u89e3\u51cd\u3092\u3057\u3066\u307f\u305f\n\n\u4e00\u756a\u6700\u521d\u4e00\u6c17\u306b370\u53f0\u5206\u306e\u5b50\u30d7\u30ed\u30bb\u30b9\u3092\u7a4d\u3093\u3067\u3084\u3063\u3066\u307f\u305f\u304c\n\u3084\u3063\u3071\u308a\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u51fa\u306a\u304b\u3063\u305f\n\n```shell\n#\u3053\u308c\u3067370\u306e\u5b50\u30d7\u30ed\u30bb\u30b9\u306b\u4e00\u6c17\u306b\u7a4d\u3093\u3060 (\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092370\u56de\u30eb\u30fc\u30d7\u3055\u305b\u308bshell\u3092\u66f8\u3044\u305f)\ntime gzip -dc /path/to/\u30b9\u30c8\u30ec\u30fc\u30b8/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log.gz > /path/to/\u5c55\u958b\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea/raw_log/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log &\n```\n\n\u3068\u3042\u308b\u4eba\u304b\u3089\u300cCPU\u6570\u306b\u5fdc\u3058\u3066\u5b50\u30d7\u30ed\u30bb\u30b9\u3092\u4f5c\u308c\u3070\u4e26\u5217\u3067\u4e00\u756a\u65e9\u304f\u3067\u304d\u308b\u3093\u3058\u3083\u3042\u306a\u3044\uff1f\u300d\u3068\u8a00\u308f\u308c\u305f\u306e\u3067\u8a66\u3057\u3066\u307f\u305f\n\n```shell\n#\u3053\u308c\u3067CPU\u306e\u6570\u304c\u3060\u305b\u308b\ncat /proc/cpuinfo | grep processor | wc | awk '{print $1}'\n\n8\n\n#\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u30d1\u30a4\u30d7\u51e6\u7406\u30678\u500b\u306b\u9023\u7d50\u3057\u3066(370 /8) = 47\u56de\u30eb\u30fc\u30d7\u3055\u305b\u308b\ntime gzip -dc /path/to/\u30b9\u30c8\u30ec\u30fc\u30b8/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log.gz > /path/to/\u5c55\u958b\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea/raw_log/\u65e5\u4ed8/\u30b5\u30fc\u30d0\u30fc\u540d/access_log |\n\n```\n\n\u7d50\u679c\n\n```shell:370\u53f0\u306e\u30ed\u30b0\u306e\u89e3\u51cd\u306b\u304b\u304b\u3063\u305f\u6642\u9593\nreal\t32m13.975s\nuser\t12m11.686s\nsys\t2m32.123s\n\n```\n\n30\u5206\u5f31\u3067\u89e3\u51cd\u3067\u304d\u305f\u304c\u7406\u8ad6\u4e0a\u306e\u6570\u5b57\u3068\u5408\u308f\u306a\u3044\u3002\u3002\u3002\u3002\n\n```shell\n#\u7406\u8ad6\u4e0a\u3067\u3067\u308b\u30b9\u30d4\u30fc\u30c9\n((47 * 10) / 60) = 7.83333333333 \u5206\n```\n\n\u30e1\u30e2\u30ea\u304c\u591a\u5206\u8ffd\u3063\u4ed8\u304b\u306a\u3044\u306e\u3067\u3057\u3087\u3046\u3002\u3002\u3002\n\n### \u89e3\u51cd\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u7dcf\u5bb9\u91cf\u3092\u8abf\u3079\u308b\n\n```shell\ndu -m /path/to/\u5c55\u958b\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea/raw_log/ | awk '{sum += $1} END {gb = sum / 1024} END {print gb \"GB\"}'\n\n207.183GB\n```\n\n\u4e00\u65e5\u3067apache\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3060\u3051\u3067207GB\u3042\u308b\u3093\u3067\u3059\u306d\u3002\u3002\u3002\n\n\n\n\n\n\n", "tags": ["\u30e1\u30e2"]}