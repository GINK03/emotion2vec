{"context": "DNS\u30b5\u30fc\u30d0\u30fc\u306e\u4ee3\u8868\u683cBIND\u3002\u6700\u8fd1\u306f\u8106\u5f31\u6027\u554f\u984c\u304c\u3057\u3070\u3057\u3070\u51fa\u308b\u3053\u3068\u304b\u3089\u5e38\u306b\u6700\u65b0\u7248\u3067\u306e\u904b\u7528\u304c\u63a8\u5968\u3055\u308c\u308b\u88fd\u54c1\u3002\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001BIND\u3092\u30bd\u30fc\u30b9\u304b\u3089\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u65b9\u6cd5\u3092\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002\n\uff08\u30bd\u30fc\u30b9\u304b\u3089\u306e\u30d3\u30eb\u30c9\u306e\u305f\u3081\u3001\u5e38\u306b\u6700\u65b0\u7248\u3067\u306e\u904b\u7528\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\uff09\n2016\u5e749\u6708\u73fe\u5728\u306eBIND\u306f\u3001\u300c9-11-0-p1\u300d\u304c\u6700\u65b0\u7248\u3067\u3059\u3002\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u5148\nhttps://www.isc.org/downloads/\n\n\u691c\u8a3c\u74b0\u5883\u30d0\u30fc\u30b8\u30e7\u30f3\n\n\n\n\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\n\u30d0\u30fc\u30b8\u30e7\u30f3\n\n\n\n\nBIND\n9-11-0-p1\n\n\nOS\nCentOS 7.3\n\n\n\n\n\u4e8b\u524d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nOpenSSL\u304c\u4e8b\u524d\u306b\u5fc5\u8981\u3067\u3059\u3002\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nOpenSSL(1.0.x)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\uff08\u30bd\u30fc\u30b9\u304b\u3089\u30b3\u30f3\u30d1\u30a4\u30eb\uff09for CentOS 7.2\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncd /usr/local/src\nwget --trust-server-names https://www.isc.org/downloads/file/bind-9-11-0-p1/?version=tar-gz\nmv index.html?version=tar-gz bind-9-11-0-p1.tar.gz\ntar xvzf bind-9-11-0-p1.tar.gz\ncd bind-9-11-0-P1\n./configure \\\n--enable-threads \\\n--with-openssl=/usr/local/ssl\nmake\nmake install\n\n\n\u521d\u671f\u8a2d\u5b9a\n\n\u4e8b\u524d\u6e96\u5099\nbind\u8d77\u52d5\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nuseradd named\nmkdir -p /var/named\nchown named:named -R /var/named/\nmkdir -p /run/named\nchown named:named -R /run/named\n\n\n\u30ad\u30fc\u306e\u751f\u6210\u3092\u884c\u3046\n#/etc/rndc.key\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n/usr/local/sbin/rndc-confgen -a\n\n#rndc.conf\u3092\u4f5c\u6210\nrndc-confgen -r /var/log/messages > /etc/rndc.conf\n\nvi /etc/rndc.conf\n- key \"rndc-key\"\u4ee5\u4e0b\u3092\u30b3\u30d4\u30fc -\ntouch /etc/named.conf\nvi /etc/named.conf\n\n\nrndc\u306e\u30ad\u30fc\u3092\u30b3\u30d4\u30fc\u3059\u308b\nvi /etc/rndc.key\n\nkey \"rndc-key\" {\n        algorithm hmac-md5;\n        secret \"XXXXXXXXXXXXXXXXXXXXXX==\";\n};\n\n\u30b3\u30d4\u30fc\u3057\u305f\u30ad\u30fc\u3092rdnc.conf\u306b\u5f35\u308a\u4ed8\u3051\u308b\nvi /etc/rndc.conf\n\n# Start of rndc.conf\nkey \"rndc-key\" {\n        algorithm hmac-md5;\n        secret \"XXXXXXXXXXXXXXXXXXXXXX==\";\n};\n\n\n\u30d2\u30f3\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3059\u308b\ncd /var/named\nwget https://www.internic.net/domain/named.root\n\n\nnamed.comf\u3092\u914d\u7f6e\u3059\u308b\nvi /etc/named.conf\n\noptions {\n    directory \"/var/named\";\n    allow-recursion{ 192.168.0.0/16; localhost; };\n    version \"unknow\";\n};\n\nkey \"rndc-key\" {\n      algorithm hmac-md5;\n      //rdnc.key\u306e\u30ad\u30fc\u3092\u3053\u3053\u306b\u5165\u308c\u308b\n      secret \"XXXXXXXXXXXXXXXXXXXXXX==\";\n};\n\ncontrols {\n      inet 127.0.0.1 port 953\n              allow { 127.0.0.1; } keys { \"rndc-key\"; };\n};\n\nzone \".\" IN {\n    type hint;\n    file \"named.root\";\n};\n\nzone \"localhost\" IN {\n    type master;\n    file \"named.localhost\";\n};\n\nzone \"0.0.127.in-addr.arpa\" IN {\n    type master;\n    file \"named.loopback\";\n};\n\n\nZone\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\nmkdir -p /var/named\nvi /var/named/named.localhost\n\n\nlocalhost\u6b63\u5f15\u304d\n\nnamed.localhost\n$TTL 1D\n@   IN SOA  @ rname.invalid. (\n                    0   ; serial\n                    1D  ; refresh\n                    1H  ; retry\n                    1W  ; expire\n                    3H )    ; minimum\n    NS  @\n    A   127.0.0.1\n    AAAA    ::1\n\n\nvi /var/named/named.loopback\n\n\nlocalhost\u9006\u5f15\u304d\n$TTL 1D\n@   IN SOA  @ rname.invalid. (\n                    0   ; serial\n                    1D  ; refresh\n                    1H  ; retry\n                    1W  ; expire\n                    3H )    ; minimum\n    NS  @\n    A   127.0.0.1\n    AAAA    ::1\n    PTR localhost.\n\n\n\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u914d\u7f6e\nvi /usr/lib/systemd/system/named.service\n\n[Unit]\nDescription=Berkeley Internet Name Domain (DNS)\n\n[Service]\nType=forking\nPIDFile=/run/named/named.pid\n\nExecStartPre=/bin/bash -c 'if [ ! \"$DISABLE_ZONE_CHECKING\" == \"yes\" ]; then /usr/local/sbin/named-checkconf -z /etc/named.conf; else echo \"Checking of zone files is disabled\"; fi'\nExecStart=/usr/local/sbin/named -u named $OPTIONS\n\nExecReload=/bin/sh -c '/usr/local/sbin/rndc reload > /dev/null 2>&1 || /bin/kill -HUP $MAINPID'\n\nExecStop=/bin/sh -c '/usr/local/sbin/rndc stop > /dev/null 2>&1 || /bin/kill -TERM $MAINPID'\n\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n\n\n\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3057\u3001\u81ea\u52d5\u8d77\u52d5\u3092\u8a2d\u5b9a\nsystemctl start bind\nsystemctl enable bind\n\nDNS\u30b5\u30fc\u30d0\u30fc\u306e\u4ee3\u8868\u683cBIND\u3002\u6700\u8fd1\u306f\u8106\u5f31\u6027\u554f\u984c\u304c\u3057\u3070\u3057\u3070\u51fa\u308b\u3053\u3068\u304b\u3089\u5e38\u306b\u6700\u65b0\u7248\u3067\u306e\u904b\u7528\u304c\u63a8\u5968\u3055\u308c\u308b\u88fd\u54c1\u3002\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001BIND\u3092\u30bd\u30fc\u30b9\u304b\u3089\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u65b9\u6cd5\u3092\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002\n\uff08\u30bd\u30fc\u30b9\u304b\u3089\u306e\u30d3\u30eb\u30c9\u306e\u305f\u3081\u3001\u5e38\u306b\u6700\u65b0\u7248\u3067\u306e\u904b\u7528\u304c\u53ef\u80fd\u3068\u306a\u308a\u307e\u3059\uff09\n2016\u5e749\u6708\u73fe\u5728\u306eBIND\u306f\u3001\u300c9-11-0-p1\u300d\u304c\u6700\u65b0\u7248\u3067\u3059\u3002\n\n## \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u5148\nhttps://www.isc.org/downloads/\n\n## \u691c\u8a3c\u74b0\u5883\u30d0\u30fc\u30b8\u30e7\u30f3\n| \u30bd\u30d5\u30c8\u30a6\u30a7\u30a2 | \u30d0\u30fc\u30b8\u30e7\u30f3 |\n|:-:|:-:|\n|  BIND| 9-11-0-p1 |\n|  OS | CentOS 7.3  |\n\n\n## \u4e8b\u524d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nOpenSSL\u304c\u4e8b\u524d\u306b\u5fc5\u8981\u3067\u3059\u3002\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u4e8b\u524d\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n[OpenSSL(1.0.x)\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\uff08\u30bd\u30fc\u30b9\u304b\u3089\u30b3\u30f3\u30d1\u30a4\u30eb\uff09for CentOS 7.2](http://qiita.com/shadowhat/items/68fd55b532c04b13acf5)\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash:\ncd /usr/local/src\nwget --trust-server-names https://www.isc.org/downloads/file/bind-9-11-0-p1/?version=tar-gz\nmv index.html?version=tar-gz bind-9-11-0-p1.tar.gz\ntar xvzf bind-9-11-0-p1.tar.gz\ncd bind-9-11-0-P1\n./configure \\\n--enable-threads \\\n--with-openssl=/usr/local/ssl\nmake\nmake install\n```\n\n## \u521d\u671f\u8a2d\u5b9a\n### \u4e8b\u524d\u6e96\u5099\nbind\u8d77\u52d5\u7528\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash:\nuseradd named\nmkdir -p /var/named\nchown named:named -R /var/named/\nmkdir -p /run/named\nchown named:named -R /run/named\n```\n\n### \u30ad\u30fc\u306e\u751f\u6210\u3092\u884c\u3046\n\n```bash:\n#/etc/rndc.key\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n/usr/local/sbin/rndc-confgen -a\n\n#rndc.conf\u3092\u4f5c\u6210\nrndc-confgen -r /var/log/messages > /etc/rndc.conf\n\nvi /etc/rndc.conf\n- key \"rndc-key\"\u4ee5\u4e0b\u3092\u30b3\u30d4\u30fc -\ntouch /etc/named.conf\nvi /etc/named.conf\n```\n\n### rndc\u306e\u30ad\u30fc\u3092\u30b3\u30d4\u30fc\u3059\u308b\n\n```bash:\nvi /etc/rndc.key\n```\n\n```\nkey \"rndc-key\" {\n        algorithm hmac-md5;\n        secret \"XXXXXXXXXXXXXXXXXXXXXX==\";\n};\n```\n\n\u30b3\u30d4\u30fc\u3057\u305f\u30ad\u30fc\u3092rdnc.conf\u306b\u5f35\u308a\u4ed8\u3051\u308b\n\n```bash:\nvi /etc/rndc.conf\n```\n\n```\n# Start of rndc.conf\nkey \"rndc-key\" {\n        algorithm hmac-md5;\n        secret \"XXXXXXXXXXXXXXXXXXXXXX==\";\n};\n```\n\n## \u30d2\u30f3\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3059\u308b\n\n```bash:\ncd /var/named\nwget https://www.internic.net/domain/named.root\n```\n\n##named.comf\u3092\u914d\u7f6e\u3059\u308b\n\n```bash:\nvi /etc/named.conf\n```\n\n```\noptions {\n    directory \"/var/named\";\n    allow-recursion{ 192.168.0.0/16; localhost; };\n    version \"unknow\";\n};\n\nkey \"rndc-key\" {\n      algorithm hmac-md5;\n      //rdnc.key\u306e\u30ad\u30fc\u3092\u3053\u3053\u306b\u5165\u308c\u308b\n      secret \"XXXXXXXXXXXXXXXXXXXXXX==\";\n};\n\ncontrols {\n      inet 127.0.0.1 port 953\n              allow { 127.0.0.1; } keys { \"rndc-key\"; };\n};\n\nzone \".\" IN {\n    type hint;\n    file \"named.root\";\n};\n\nzone \"localhost\" IN {\n    type master;\n    file \"named.localhost\";\n};\n\nzone \"0.0.127.in-addr.arpa\" IN {\n    type master;\n    file \"named.loopback\";\n};\n```\n\n## Zone\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\n\n```bash\nmkdir -p /var/named\nvi /var/named/named.localhost\n```\n\n### localhost\u6b63\u5f15\u304d\n```:named.localhost\n$TTL 1D\n@\tIN SOA\t@ rname.invalid. (\n\t\t\t\t\t0\t; serial\n\t\t\t\t\t1D\t; refresh\n\t\t\t\t\t1H\t; retry\n\t\t\t\t\t1W\t; expire\n\t\t\t\t\t3H )\t; minimum\n\tNS\t@\n\tA\t127.0.0.1\n\tAAAA\t::1\n```\n\n```bash:\nvi /var/named/named.loopback\n```\n\n### localhost\u9006\u5f15\u304d\n```\n$TTL 1D\n@\tIN SOA\t@ rname.invalid. (\n\t\t\t\t\t0\t; serial\n\t\t\t\t\t1D\t; refresh\n\t\t\t\t\t1H\t; retry\n\t\t\t\t\t1W\t; expire\n\t\t\t\t\t3H )\t; minimum\n\tNS\t@\n\tA\t127.0.0.1\n\tAAAA\t::1\n\tPTR\tlocalhost.\n```\n\n##\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u914d\u7f6e\n\n```bash:\nvi /usr/lib/systemd/system/named.service\n```\n\n```\n[Unit]\nDescription=Berkeley Internet Name Domain (DNS)\n\n[Service]\nType=forking\nPIDFile=/run/named/named.pid\n\nExecStartPre=/bin/bash -c 'if [ ! \"$DISABLE_ZONE_CHECKING\" == \"yes\" ]; then /usr/local/sbin/named-checkconf -z /etc/named.conf; else echo \"Checking of zone files is disabled\"; fi'\nExecStart=/usr/local/sbin/named -u named $OPTIONS\n\nExecReload=/bin/sh -c '/usr/local/sbin/rndc reload > /dev/null 2>&1 || /bin/kill -HUP $MAINPID'\n\nExecStop=/bin/sh -c '/usr/local/sbin/rndc stop > /dev/null 2>&1 || /bin/kill -TERM $MAINPID'\n\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n```\n\n## \u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3057\u3001\u81ea\u52d5\u8d77\u52d5\u3092\u8a2d\u5b9a\n\n```bash:\nsystemctl start bind\nsystemctl enable bind\n```\n\n", "tags": ["bind", "dns", "CentOS", "centos7"]}