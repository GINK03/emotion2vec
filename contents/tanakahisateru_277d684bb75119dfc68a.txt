{"context": " More than 1 year has passed since last update.Yii \u3067\u524a\u9664\u30ea\u30f3\u30af\u306a\u3069\u306b\u4f7f\u308f\u308c\u308b\u3042\u306e\u300c\u672c\u5f53\u306b\u5b9f\u884c\u3057\u307e\u3059\u304b\u300d\u306e\u78ba\u8a8d\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u901a\u5e38\u306e\u30d5\u30a9\u30fc\u30e0\u30b5\u30d6\u30df\u30c3\u30c8\u306b\u3082\u4f7f\u3044\u305f\u3044\u306e\u3067 jQuery \u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u66f8\u304d\u307e\u3057\u305f\u3002Yii 2.0.* \u5c02\u7528\u3067\u3059\u3002\n\nconfirm-before-submit.js\n(function($) {\n    $.fn.confirmBeforeSubmit = function(options) {\n        options = $.extend({\n            message: \"\u672c\u5f53\u306b\u5b9f\u884c\u3057\u307e\u3059\u304b\u3002\"\n        }, options);\n\n        this.each(function() {\n            var $button = $(this);\n            var $form = $button.closest('form');\n\n            var confirmed = false;\n            var message = options.message;\n\n            $button.on('click', function (event) {\n                confirmed = false;\n            });\n            $form.on('beforeSubmit', function () {\n                if (!confirmed) {\n                    var data = $form.data('yiiActiveForm');\n                    yii.confirm(message, function () {\n                        setTimeout(function(){\n                            confirmed = true;\n                            data.validated = true;\n                            $form.submit();\n                        }, 1);\n                    });\n                    //data.validated = false;\n                    return false;\n                } else {\n                    return true;\n                }\n            });\n        });\n    };\n})(jQuery);\n\n\n\u4f7f\u3044\u65b9\n<div class=\"form-group\">\n    <?= Html::submitButton($model->isNewRecord ? '\u4f5c\u6210\u3059\u308b' : '\u4fdd\u5b58\u3059\u308b', [\n        'class' => $model->isNewRecord ?\n            'btn btn-success submit' :\n            'btn btn-primary submit',\n    ]) ?>\n</div>\n<?php if ($model->isNewRecord) {\n    $this->registerJs(\n\"jQuery('.forum-form form .submit').confirmBeforeSubmit({\n    message: '\u306a\u306b\u304b\u4f5c\u6210\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059\u3002\u672c\u5f53\u306b\u3088\u308d\u3057\u3044\u3067\u3059\u304b?'\n});\"\n    );\n} ?>\n\n\u300c\u4f5c\u6210\u3059\u308b\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068:\n\nYii2\u306e\u524a\u9664\u78ba\u8a8d\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u304b\u3063\u3053\u826f\u304f\u3059\u308b \u3068\u5408\u308f\u305b\u3066\u4f7f\u3046\u3068\u52b9\u679c\u7684\u3067\u3059\u306d\u3002\nYii \u3067\u524a\u9664\u30ea\u30f3\u30af\u306a\u3069\u306b\u4f7f\u308f\u308c\u308b\u3042\u306e\u300c\u672c\u5f53\u306b\u5b9f\u884c\u3057\u307e\u3059\u304b\u300d\u306e\u78ba\u8a8d\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u901a\u5e38\u306e\u30d5\u30a9\u30fc\u30e0\u30b5\u30d6\u30df\u30c3\u30c8\u306b\u3082\u4f7f\u3044\u305f\u3044\u306e\u3067 jQuery \u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u66f8\u304d\u307e\u3057\u305f\u3002Yii 2.0.* \u5c02\u7528\u3067\u3059\u3002\n\n```js:confirm-before-submit.js\n(function($) {\n    $.fn.confirmBeforeSubmit = function(options) {\n        options = $.extend({\n            message: \"\u672c\u5f53\u306b\u5b9f\u884c\u3057\u307e\u3059\u304b\u3002\"\n        }, options);\n\n        this.each(function() {\n            var $button = $(this);\n            var $form = $button.closest('form');\n\n            var confirmed = false;\n            var message = options.message;\n\n            $button.on('click', function (event) {\n                confirmed = false;\n            });\n            $form.on('beforeSubmit', function () {\n                if (!confirmed) {\n                    var data = $form.data('yiiActiveForm');\n                    yii.confirm(message, function () {\n                        setTimeout(function(){\n                            confirmed = true;\n                            data.validated = true;\n                            $form.submit();\n                        }, 1);\n                    });\n                    //data.validated = false;\n                    return false;\n                } else {\n                    return true;\n                }\n            });\n        });\n    };\n})(jQuery);\n```\n\n\u4f7f\u3044\u65b9\n\n```php\n<div class=\"form-group\">\n    <?= Html::submitButton($model->isNewRecord ? '\u4f5c\u6210\u3059\u308b' : '\u4fdd\u5b58\u3059\u308b', [\n        'class' => $model->isNewRecord ?\n            'btn btn-success submit' :\n            'btn btn-primary submit',\n    ]) ?>\n</div>\n<?php if ($model->isNewRecord) {\n    $this->registerJs(\n\"jQuery('.forum-form form .submit').confirmBeforeSubmit({\n    message: '\u306a\u306b\u304b\u4f5c\u6210\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059\u3002\u672c\u5f53\u306b\u3088\u308d\u3057\u3044\u3067\u3059\u304b?'\n});\"\n    );\n} ?>\n```\n\n\u300c\u4f5c\u6210\u3059\u308b\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068:\n\n![confirm-before-submit.png](https://qiita-image-store.s3.amazonaws.com/0/11525/50902b42-8033-34b3-b3b9-772733e9e6f9.png)\n\n[Yii2\u306e\u524a\u9664\u78ba\u8a8d\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u304b\u3063\u3053\u826f\u304f\u3059\u308b](http://qiita.com/tanakahisateru/items/be28b7bed4566ce8fa99) \u3068\u5408\u308f\u305b\u3066\u4f7f\u3046\u3068\u52b9\u679c\u7684\u3067\u3059\u306d\u3002\n", "tags": ["Yii2.0", "jQuery"]}