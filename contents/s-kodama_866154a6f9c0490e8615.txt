{"tags": ["nginx", "Ruby", "Rails", "vagrant", "passenger"], "context": "\n\n\u30de\u30b7\u30f3\u74b0\u5883\u3068\u524d\u63d0\n\n\u30de\u30b7\u30f3\n\nOSX Yoshemite\n\n\nver 10.10.5\n\n\n\n\n\u524d\u63d0\n\nRails\u306e\u52d5\u4f5c\u74b0\u5883\u3092\u4f5c\u308b\u305c\uff01\nmac\u4e0a\u306bvagrant\u74b0\u5883\u304c\u65e2\u306b\u3042\u308b\nvagrant\u4e0a\u306bCentOS6.7\u306e\u74b0\u5883\u304c\u65e2\u306b\u3042\u308b\n\n\n\u30b3\u30de\u30f3\u30c9\u30e1\u30e2\n\n\u30b0\u30eb\u30fc\u30d7\u4e00\u89a7\ncat /etc/group\n\n\n\u30e6\u30fc\u30b6\u4e00\u89a7\ncut -d : -f1 /etc/passwd\n\n\nbashrc\u306a\u3069\u306balias\u767b\u9332\u3057\u3066\u304a\u304f\u3068\u697d\n\nalias listusers='cut -d : -f1 /etc/passwd'\n\n\nnginx\n\nnginx\u30e6\u30fc\u30b6\u8ffd\u52a0\n\n\u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n\nsudo groupadd -g 600 nginx\n\n\n\u30e6\u30fc\u30b6\u8ffd\u52a0\n\nsudo useradd -g nginx -u 600 -s /sbin/nologin -d /home/nginx nginx\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u53d6\u5f97\ncd /usr/local/src/\n\nsudo wget https://nginx.org/download/nginx-1.11.5.tar.gz\n\nsudo tar zxvf nginx-1.11.5.tar.gz\n\n\n\n/usr/local \u4ee5\u4e0b\u306f\u81ea\u5206\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5834\u6240\u3068\u3057\u3066\u5229\u7528\u3059\u308b\n\n/usr/local/src \u306f\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u7f6e\u304d\u5834\u6240\n\n\n\u4f9d\u5b58\u95a2\u4fc2\u89e3\u6d88\nyum\u3067\nsudo yum -y install pcre-devel    #\u6b63\u898f\u8868\u73fe\u30e9\u30a4\u30d6\u30e9\u30ea\n\n\n\u30d3\u30eb\u30c9\ncd nginx-1.7.11\n\nsudo ./configure --prefix=/usr/local/nginx --user=nginx --group=nginx --with-http_ssl_module\n\nsudo make\n\nsudo make install\n\n\n\u8d77\u52d5\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u7f6e\nhttps://www.nginx.com/resources/wiki/start/topics/examples/initscripts/\n\u30ea\u30f3\u30af\u5148\u304b\u3089\u74b0\u5883\u306b\u5408\u3046\u30bd\u30fc\u30b9\u3092\u30b3\u30d4\u30fc\u3057\u3066\u304f\u308b\nsudo vi /etc/init.d/nginx\n\u203b\u30b3\u30d4\u30fc\u3057\u3066\u304d\u305f\u30bd\u30fc\u30b9\u3092\u8cbc\u308b\n\nsudo chmod 755 /etc/init.d/nginx\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u30d1\u30b9\u306e\u66f8\u304d\u63db\u3048\u3092\u3059\u308b\nsudo vi /etc/init.d/nginx\n\n\nnginx=\"/usr/sbin/nginx\"\n\u2193\nnginx=\"/usr/local/nginx/sbin/nginx\"\n\nNGINX_CONF_FILE=\"/etc/nginx/nginx.conf\"\n\u2193\nNGINX_CONF_FILE=\"/usr/local/nginx/conf/nginx.conf\"\n\n\nnginx\u306e\u8d77\u52d5\u78ba\u8a8d\n\n\u30ed\u30b0\u306e\u8a2d\u5b9a\n\n\u51fa\u529b\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n\nsudo mkdir /var/log/nginx\n\nsudo chmod 777 /var/log/nginx/\n\nsudo chown nginx:nginx /var/log/nginx\n\n\nerror\u30ed\u30b0\u306e\u8a2d\u5b9a\n\nsudo vi /usr/local/nginx/conf/nginx.conf\n\n\n\u203berror\u30ed\u30b0\u306e\u51fa\u529b\u3092\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u306b\u3002\n \u30c7\u30d0\u30c3\u30b0\u306e\u305f\u3081\u306bnotice\u4ee5\u4e0a\u3092\u51fa\u529b\u3059\u308b\u3002\n\nerror_log   /var/log/nginx/error.log notice;\n\n\n\u30dd\u30fc\u30c8\u30b9\u30ad\u30e3\u30f3\u30b3\u30de\u30f3\u30c9\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo yum install nmap\n\n\nnginx\u8d77\u52d5\n\n\u8d77\u52d5\n\nsudo /etc/init.d/nginx start\n\n[vagrant@localhost nginx]$ sudo /etc/init.d/nginx start\nnginx \u3092\u8d77\u52d5\u4e2d:                                            [  OK  ]\n[vagrant@localhost nginx]$\n\n\n\u30dd\u30fc\u30c8\u306e\u78ba\u8a8d\n\n\n80\u756a\u304c\u958b\u3044\u3066\u3044\u308b\u306e\u3067OK\n\n\n\nnmap localhost\n\n[vagrant@localhost nginx]$ nmap localhost\n\nStarting Nmap 5.51 ( http://nmap.org ) at 2016-12-18 05:20 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.00016s latency).\nOther addresses for localhost (not scanned): 127.0.0.1\nNot shown: 996 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n111/tcp open  rpcbind\n\nNmap done: 1 IP address (1 host up) scanned in 0.07 seconds\n[vagrant@localhost nginx]$\n\n\n\u30ed\u30b0\u306e\u78ba\u8a8d\n\ncat /var/log/nginx/error.log\n\n[vagrant@localhost nginx]$ cat /var/log/nginx/error.log\n2016/12/18 05:16:58 [notice] 9946#0: using the \"epoll\" event method\n2016/12/18 05:16:58 [notice] 9946#0: nginx/1.11.5\n2016/12/18 05:16:58 [notice] 9946#0: built by gcc 4.4.7 20120313 (Red Hat 4.4.7-16) (GCC)\n2016/12/18 05:16:58 [notice] 9946#0: OS: Linux 2.6.32-573.el6.x86_64\n2016/12/18 05:16:58 [notice] 9946#0: getrlimit(RLIMIT_NOFILE): 1024:4096\n2016/12/18 05:16:58 [notice] 9947#0: start worker processes\n2016/12/18 05:16:58 [notice] 9947#0: start worker process 9949\n[vagrant@localhost nginx]$\n\n\nnginx\u306e\u505c\u6b62\n\n\u505c\u6b62\n\nsudo /etc/init.d/nginx stop\n\n[vagrant@localhost nginx]$ sudo /etc/init.d/nginx stop\nnginx \u3092\u505c\u6b62\u4e2d:                                            [  OK  ]\n[vagrant@localhost nginx]$\n\n\n\u30dd\u30fc\u30c8\u306e\u78ba\u8a8d\n\n\n80\u756a\u304c\u9589\u3058\u3066\u3044\u308b\u306e\u3067OK\n\n\n\nnmap localhost\n\n[vagrant@localhost nginx]$ nmap localhost\n\nStarting Nmap 5.51 ( http://nmap.org ) at 2016-12-18 05:27 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.0052s latency).\nOther addresses for localhost (not scanned): 127.0.0.1\nNot shown: 997 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n111/tcp open  rpcbind\n\nNmap done: 1 IP address (1 host up) scanned in 0.07 seconds\n[vagrant@localhost nginx]$\n\n\n\u74b0\u5883\u5909\u6570\u306b\u30d1\u30b9\u3092\u901a\u3059\n\u3068\u308a\u3042\u3048\u305a\u8ffd\u52a0\u3057\u305f\nsudo vi /etc/profile\n\n\u6700\u7d42\u884c\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\n# user add\nexport PATH=$PATH:/usr/local/nginx/sbin/\n\n\u518d\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u78ba\u8a8d\n[vagrant@localhost nginx]$ nginx -v\nnginx version: nginx/1.11.5\n[vagrant@localhost nginx]$\n\n\nRuby\n\n\u524d\u63d0\n\nrbenv\u3092\u5229\u7528\u3057\u306a\u3044\n\n\n\u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u672c\u756a\u74b0\u5883\u3092\u60f3\u5b9a\n\n\n\u672c\u756a\u74b0\u5883\u306eRuby\u306ever\u3092\u983b\u7e41\u306b\u5909\u66f4\u3059\u308b\u3053\u3068\u306f\u306a\u3044\n\u306a\u306e\u3067Ruby2.3.3\u3092\u30d4\u30f3\u30dd\u30a4\u30f3\u30c8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\u3068\u3044\u3046\u8a2d\u5b9a\u3067\u9032\u3081\u308b\n\n\n\n\n\n\nCentOS\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308bruby\u306e\u524a\u9664\nsudo yum erase ruby.x86_64\n\n\n\u4f9d\u5b58\u95a2\u4fc2\u306e\u89e3\u6d88\nyum\u3067\u4e00\u6c17\u306b\u3084\u3063\u3061\u307e\u3046\n\nyum.conf\u306e\u7de8\u96c6\n\n\nIPv6\u3092\u7121\u52b9\u306b\u3059\u308b\n\n\n\nsudo vi /etc/yum.conf\n\n\u4ee5\u4e0b\u3092\u8ffd\u8a18\n# user add\nip_resolve=4\n\n\nyum\u306eupdate&install\n\nsudo yum -y install libyaml libyaml-devel zlib zlib-devel readline readline-devel openssl openssl-devel libxml2 libxml2-devel libxslt libxslt-devel libcurl-devel\n\nsudo yum update libyaml libyaml-devel zlib zlib-devel readline readline-devel openssl openssl-devel libxml2 libxml2-devel libxslt libxslt-devel libcurl-devel\n\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\ncd /usr/local/src\n\nsudo wget https://cache.ruby-lang.org/pub/ruby/2.3/ruby-2.3.3.tar.gz\n\nsudo tar zxvf ruby-2.3.3.tar.gz\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncd ruby-2.3.3\n\nsudo ./configure --prefix=/usr/local/    # \u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5fc5\u8981\u304c\u3042\u308c\u3070\u4f55\u304b\u4ed8\u4e0e\u3059\u308b\u3053\u3068\n\nsudo make\n\nsudo make install\n\n\n\u4e00\u6c17\u306b\u3084\u308a\u305f\u3044\u306a\u3089\u3053\u308c\u3067\u3082\u3044\u3044\u304b\u3082(\u672a\u691c\u8a3c)\nsudo ./configure --prefix=/usr/local/ && make && make install\n\n\n\u78ba\u8a8d\nruby -v\n\n[vagrant@localhost ruby-2.3.3]$ ruby -v\nruby 2.3.3p222 (2016-11-21 revision 56859) [x86_64-linux]\n[vagrant@localhost ruby-2.3.3]$\n\nwhich ruby\n\n[vagrant@localhost ruby-2.3.3]$ which ruby\n/usr/local/bin/ruby\n[vagrant@localhost ruby-2.3.3]$\n\n\nRails\n\nGem\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\ngem\u30b3\u30de\u30f3\u30c9\u3092sudo\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n\n\n\n/usr/local/bin/ \u4ee5\u4e0b\u306b\u3042\u308b\u30b3\u30de\u30f3\u30c9\u306f\u5168\u3066sudo\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3057\u307e\u3046\n\n\n\nsudo visudo\n\n\n\u4ee5\u4e0b\u306e\u8a18\u8ff0\u3092\u4fee\u6b63(nginx\u3082\u3064\u3044\u3067\u306b\u8ffd\u52a0)\nDefaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin\n\u2193\nDefaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin/:/usr/local/nginx/sbin/\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nsudo gem install rails -v 5.0.0.1\n\n\n\u78ba\u8a8d\n\nrails -v\n\n[vagrant@localhost ~]$ rails -v\nRails 5.0.0.1\n[vagrant@localhost ~]$\n\n\nPassenger\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\ngem\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nsudo gem install passenger -v '5.0.30'\n\n\n\u78ba\u8a8d\n\n[vagrant@localhost ~]$ passenger -v\nPhusion Passenger 5.0.30\n[vagrant@localhost ~]$ which passenger\n/usr/local/bin/passenger\n[vagrant@localhost ~]$\n\n\nnginx\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo passenger-install-nginx-module\n\n\u3068\u3053\u308d\u3069\u3053\u308d\u3067\u805e\u304b\u308c\u308b\u3002\n\n\u6700\u521d\u306fpassenger\u30b5\u30dd\u30fc\u30c8\u3067nginx\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\u304b\uff1f\u306a\u306e\u3067 1 \n\u6b21\u306f\u8a00\u8a9e\u3002 Ruby \u3067\nnginx\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u5834\u6240\u3092\u805e\u304b\u308c\u308b\u306e\u3067 /usr/local/src/nginx-1.11.5 \u3067\n\u3069\u3053\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3044\u304b\u805e\u304b\u308c\u308b\u306e\u3067 /usr/local/nginx \u3067\n\u305d\u306e\u307b\u304b\u306econfigure\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u805e\u304b\u308c\u308b\u3051\u3069\u3068\u308a\u3042\u3048\u305a\u7121\u3057\u3002\u305d\u306e\u307e\u307e Enter \u62bc\u4e0b\u3067\n\u6700\u5f8c\u306b\u3001\u3084\u3063\u3061\u307e\u3046\u305e\uff01\uff1f\u7684\u306a\u611f\u3058\u306b\u306a\u308b\u306e\u3067\u304a\u3068\u306a\u3057\u304f yes \u3067\n\u7121\u4e8b\u306b\u7d42\u308f\u3063\u305f\u3089 Enter \u3067\n\n[vagrant@localhost ~]$ sudo passenger-install-nginx-module\nWelcome to the Phusion Passenger Nginx module installer, v5.0.30.\n\nThis installer will guide you through the entire installation process. It\nshouldn't take more than 5 minutes in total.\n\nHere's what you can expect from the installation process:\n\n 1. This installer will compile and install Nginx with Passenger support.\n 2. You'll learn how to configure Passenger in Nginx.\n 3. You'll learn how to deploy a Ruby on Rails application.\n\nDon't worry if anything goes wrong. This installer will advise you on how to\nsolve any problems.\n\nPress Enter to continue, or Ctrl-C to abort.\n1\n\n--------------------------------------------\n\nWhich languages are you interested in?\n\nUse <space> to select.\nIf the menu doesn't display correctly, press '!'\n\n \u2023 \u2b22  Ruby\n   \u2b22  Python\n   \u2b21  Node.js\n   \u2b21  Meteor\n\n--------------------------------------------\n\nChecking for required software...\n\n * Checking for C compiler...\n      Found: yes\n      Location: /usr/bin/cc\n\n\u7701\u7565\n\n--------------------------------------------\n\nAutomatically download and install Nginx?\n\nNginx doesn't support loadable modules such as some other web servers do,\nso in order to install Nginx with Passenger support, it must be recompiled.\n\nDo you want this installer to download, compile and install Nginx for you?\n\n 1. Yes: download, compile and install Nginx for me. (recommended)\n    The easiest way to get started. A stock Nginx 1.10.1 with Passenger\n    support, but with no other additional third party modules, will be\n    installed for you to a directory of your choice.\n\n 2. No: I want to customize my Nginx installation. (for advanced users)\n    Choose this if you want to compile Nginx with more third party modules\n    besides Passenger, or if you need to pass additional options to Nginx's\n    'configure' script. This installer will  1) ask you for the location of\n    the Nginx source code,  2) run the 'configure' script according to your\n    instructions, and  3) run 'make install'.\n\nWhichever you choose, if you already have an existing Nginx configuration file,\nthen it will be preserved.\n\nEnter your choice (1 or 2) or press Ctrl-C to abort: 2\n\n--------------------------------------------\n\nWhere is your Nginx source code located?\n\nPlease specify the directory: /usr/local/src/nginx-1.11.5\n\n--------------------------------------------\n\nWhere do you want to install Nginx to?\n\nPlease specify a prefix directory [/opt/nginx]: /usr/local/nginx\n\n--------------------------------------------\n\nExtra Nginx configure options\n\nIf you want to pass extra arguments to the Nginx 'configure' script, then\nplease specify them. If not, then specify nothing and press Enter.\n\nIf you specify nothing then the 'configure' script will be run as follows:\n\n  sh ./configure --prefix='/usr/local/nginx' --with-http_ssl_module --with-http_gzip_static_module --with-http_stub_status_module --with-cc-opt=-Wno-error --with-ld-opt='' --add-module='/usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30/src/nginx_module'\n\nExtra arguments to pass to configure script:\n\n--------------------------------------------\n\nConfirm configure flags\n\nThe Nginx configure script will be run as follows:\n\n  sh ./configure --prefix='/usr/local/nginx' --with-http_ssl_module --with-http_gzip_static_module --with-http_stub_status_module --with-cc-opt=-Wno-error --with-ld-opt='' --add-module='/usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30/src/nginx_module'\n\nIs this what you want? (yes/no) [default=yes]: yes\n\n--------------------------------------------\n\nCompiling Passenger support files...\n# env NOEXEC_DISABLE=1 /usr/local/bin/ruby /usr/local/bin/rake nginx:clean nginx RELEASE=yes\n\n\u7701\u7565\n\n--------------------------------------------\n\nNginx with Passenger support was successfully installed.\n\nPlease edit your Nginx configuration file (probably /usr/local/nginx/conf/nginx.conf),\nand set the passenger_root and passenger_ruby configuration options in the\n'http' block, like this:\n\n  http {\n      ...\n      passenger_root /usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30;\n      passenger_ruby /usr/local/bin/ruby;\n      ...\n  }\n\nAfter you (re)start Nginx, you are ready to deploy any number of web\napplications on Nginx.\n\nPress ENTER to continue.\n\n--------------------------------------------\n\nDeploying a web application\n\nTo learn how to deploy a web app on Passenger, please follow the deployment\nguide:\n\n  https://www.phusionpassenger.com/library/deploy/nginx/deploy/\n\nEnjoy Phusion Passenger, a product of Phusion (www.phusion.nl) :-)\nhttps://www.phusionpassenger.com\n\nPhusion Passenger is a registered trademark of Hongli Lai & Ninh Bui.\n[vagrant@localhost ~]$\n\n\n\u78ba\u8a8d\n\n\n\n--add-module \u306bpassenger\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\n\n\n\nnginx -V\n\n[vagrant@localhost ~]$ nginx -V\nnginx version: nginx/1.11.5\nbuilt by gcc 4.4.7 20120313 (Red Hat 4.4.7-16) (GCC)\nbuilt with OpenSSL 1.0.1e-fips 11 Feb 2013\nTLS SNI support enabled\nconfigure arguments: --prefix=/usr/local/nginx --with-http_ssl_module --with-http_gzip_static_module --with-http_stub_status_module --with-cc-opt=-Wno-error --with-ld-opt= --add-module=/usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30/src/nginx_module\n[vagrant@localhost ~]$\n\n\n\u8d77\u52d5&\u505c\u6b62\u78ba\u8a8d\n\n[vagrant@localhost ~]$ sudo /etc/init.d/nginx start\nnginx \u3092\u8d77\u52d5\u4e2d:                                            [  OK  ]\n[vagrant@localhost ~]$ nmap localhost\n\nStarting Nmap 5.51 ( http://nmap.org ) at 2016-12-18 09:40 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.00017s latency).\nOther addresses for localhost (not scanned): 127.0.0.1\nNot shown: 996 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n111/tcp open  rpcbind\n\nNmap done: 1 IP address (1 host up) scanned in 0.09 seconds\n\n\n\n[vagrant@localhost ~]$ sudo /etc/init.d/nginx stop\nnginx \u3092\u505c\u6b62\u4e2d:                                            [  OK  ]\n[vagrant@localhost ~]$ nmap localhost\n\nStarting Nmap 5.51 ( http://nmap.org ) at 2016-12-18 09:40 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.00031s latency).\nOther addresses for localhost (not scanned): 127.0.0.1\nNot shown: 997 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n111/tcp open  rpcbind\n\nNmap done: 1 IP address (1 host up) scanned in 0.06 seconds\n[vagrant@localhost ~]$\n\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066rails\u30a2\u30d7\u30ea\u3092\u8868\u793a\u3059\u308b\n\n\u30a2\u30d7\u30ea\u306e\u4f5c\u6210\ncd /vagrant\n\nrails new getwild\n\n\nGemfile\u306e\u7de8\u96c6\n\n\n\ntherubyracer \u306e\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3059\n\u5916\u3057\u3066\u304a\u304b\u306a\u3044\u3068rails\u30a2\u30d7\u30ea\u3092\u52d5\u304b\u3057\u305f\u6642\u306b\u30a8\u30e9\u30fc\u306b\u306a\u308b\n\n\n\ncd getwild\n\nvi Gemfile\n\n\n\nbundle install \u3092\u5b9f\u884c\n\n[vagrant@localhost getwild]$ bundle install\nFetching gem metadata from https://rubygems.org/..........\nFetching version metadata from https://rubygems.org/..\nFetching dependency metadata from https://rubygems.org/.\nResolving dependencies...\nUsing rake 12.0.0\nUsing concurrent-ruby 1.0.3\n\n\u7701\u7565\n\nUsing rails 5.0.0.1\nUsing sass-rails 5.0.6\nBundle complete! 16 Gemfile dependencies, 65 gems now installed.\nUse `bundle show [gemname]` to see where a bundled gem is installed.\n[vagrant@localhost getwild]$\n\n\nnginx.conf\u306e\u7de8\u96c6\n\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u5185\u5bb9\u306b\u7de8\u96c6\u3002\n\n/usr/local/nginx/conf/nginx.conf\n\n#user  nobody;\nworker_processes  1;\n\nerror_log   /var/log/nginx/error.log notice;\npid        /var/log/nginx/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    passenger_root /usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30;\n    passenger_ruby /usr/local/bin/ruby;\n\n    server {\n        listen       80;\n        server_name  192.168.33.10;\n        access_log   /var/log/nginx/192.168.33.10.access.log;\n        error_log    /var/log/nginx/192.168.33.10.error.log;\n\n        location / {\n            root                  /vagrant/getwild/public;\n            passenger_base_uri    /;\n            passenger_enabled     on;\n            rails_spawn_method    smart;\n            rails_env             development;\n            index                 index.html index.htm;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n    }\n\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server {\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n\n    # HTTPS server\n    #\n    #server {\n    #    listen       443 ssl;\n    #    server_name  localhost;\n\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n\n    #    ssl_session_cache    shared:SSL:1m;\n    #    ssl_session_timeout  5m;\n\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n}\n\n\n\niptables\u306e\u7de8\u96c6\n80\u756a\u30dd\u30fc\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n\n\u78ba\u8a8d\n\nsudo /sbin/iptables -L --line-numbers\n\n[vagrant@localhost ~]$ sudo /sbin/iptables -L --line-numbers\nChain INPUT (policy ACCEPT)\nnum  target     prot opt source               destination\n1    ACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED\n2    ACCEPT     icmp --  anywhere             anywhere\n3    ACCEPT     all  --  anywhere             anywhere\n4    ACCEPT     tcp  --  anywhere             anywhere            state NEW tcp dpt:ssh\n5    REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n\nChain FORWARD (policy ACCEPT)\nnum  target     prot opt source               destination\n1    REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n\nChain OUTPUT (policy ACCEPT)\nnum  target     prot opt source               destination\n[vagrant@localhost ~]$\n\n\n80\u756a\u3092\u958b\u3051\u308b\n\nsudo /sbin/iptables -I INPUT 5 -p tcp -m tcp --dport 80 -j ACCEPT\n\n\n\u4fdd\u5b58\n\nsudo service iptables save\n\n[vagrant@localhost ~]$ sudo service iptables save\niptables: Saving firewall rules to /etc/sysconfig/iptables:[  OK  ]\n[vagrant@localhost ~]$\n\n\n\u518d\u78ba\u8a8d\n\n[vagrant@localhost ~]$ sudo /sbin/iptables -L --line-numbers\nChain INPUT (policy ACCEPT)\nnum  target     prot opt source               destination\n1    ACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED\n2    ACCEPT     icmp --  anywhere             anywhere\n3    ACCEPT     all  --  anywhere             anywhere\n4    ACCEPT     tcp  --  anywhere             anywhere            state NEW tcp dpt:ssh\n5    ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:http\n6    REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n\nChain FORWARD (policy ACCEPT)\nnum  target     prot opt source               destination\n1    REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n\nChain OUTPUT (policy ACCEPT)\nnum  target     prot opt source               destination\n[vagrant@localhost ~]$\n\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\n\u81ea\u5206\u306e\u74b0\u5883\u306e\u5834\u5408\u4ee5\u4e0b\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u3067vagrant\u4e0a\u306e\u30a2\u30d7\u30ea\u306b\u3064\u306a\u304c\u308b\u3002\nhttp://192.168.33.10/\n\nrails\u30a2\u30d7\u30ea\u3092\u52d5\u4f5c\u3055\u305b\u308b\u74b0\u5883\u304c\u51fa\u6765\u4e0a\u304c\u308a\u307e\u3057\u305f\u3002\n## \u30de\u30b7\u30f3\u74b0\u5883\u3068\u524d\u63d0\n### \u30de\u30b7\u30f3\n* OSX Yoshemite\n    * ver 10.10.5\n\n### \u524d\u63d0\n* Rails\u306e\u52d5\u4f5c\u74b0\u5883\u3092\u4f5c\u308b\u305c\uff01\n* mac\u4e0a\u306bvagrant\u74b0\u5883\u304c\u65e2\u306b\u3042\u308b\n* vagrant\u4e0a\u306bCentOS6.7\u306e\u74b0\u5883\u304c\u65e2\u306b\u3042\u308b\n\n## \u30b3\u30de\u30f3\u30c9\u30e1\u30e2\n\n### \u30b0\u30eb\u30fc\u30d7\u4e00\u89a7\n```\ncat /etc/group\n```\n\n### \u30e6\u30fc\u30b6\u4e00\u89a7\n```\ncut -d : -f1 /etc/passwd\n```\n\n* bashrc\u306a\u3069\u306balias\u767b\u9332\u3057\u3066\u304a\u304f\u3068\u697d\n\n```\nalias listusers='cut -d : -f1 /etc/passwd'\n```\n\n## nginx\n\n### nginx\u30e6\u30fc\u30b6\u8ffd\u52a0\n* \u30b0\u30eb\u30fc\u30d7\u8ffd\u52a0\n\n\n```\nsudo groupadd -g 600 nginx\n```\n\n* \u30e6\u30fc\u30b6\u8ffd\u52a0\n\n\n```\nsudo useradd -g nginx -u 600 -s /sbin/nologin -d /home/nginx nginx\n```\n\n### \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u53d6\u5f97\n\n\n```\ncd /usr/local/src/\n\nsudo wget https://nginx.org/download/nginx-1.11.5.tar.gz\n\nsudo tar zxvf nginx-1.11.5.tar.gz\n```\n\n* `/usr/local` \u4ee5\u4e0b\u306f\u81ea\u5206\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5834\u6240\u3068\u3057\u3066\u5229\u7528\u3059\u308b\n* `/usr/local/src` \u306f\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u7f6e\u304d\u5834\u6240\n\n### \u4f9d\u5b58\u95a2\u4fc2\u89e3\u6d88\nyum\u3067\n\n```\nsudo yum -y install pcre-devel    #\u6b63\u898f\u8868\u73fe\u30e9\u30a4\u30d6\u30e9\u30ea\n```\n\n### \u30d3\u30eb\u30c9\n\n```\ncd nginx-1.7.11\n\nsudo ./configure --prefix=/usr/local/nginx --user=nginx --group=nginx --with-http_ssl_module\n\nsudo make\n\nsudo make install\n```\n\n### \u8d77\u52d5\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u7f6e\nhttps://www.nginx.com/resources/wiki/start/topics/examples/initscripts/\n\u30ea\u30f3\u30af\u5148\u304b\u3089\u74b0\u5883\u306b\u5408\u3046\u30bd\u30fc\u30b9\u3092\u30b3\u30d4\u30fc\u3057\u3066\u304f\u308b\n\n```\nsudo vi /etc/init.d/nginx\n\u203b\u30b3\u30d4\u30fc\u3057\u3066\u304d\u305f\u30bd\u30fc\u30b9\u3092\u8cbc\u308b\n\nsudo chmod 755 /etc/init.d/nginx\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u30d1\u30b9\u306e\u66f8\u304d\u63db\u3048\u3092\u3059\u308b\n\n```\nsudo vi /etc/init.d/nginx\n\n\nnginx=\"/usr/sbin/nginx\"\n\u2193\nnginx=\"/usr/local/nginx/sbin/nginx\"\n\nNGINX_CONF_FILE=\"/etc/nginx/nginx.conf\"\n\u2193\nNGINX_CONF_FILE=\"/usr/local/nginx/conf/nginx.conf\"\n```\n\n### nginx\u306e\u8d77\u52d5\u78ba\u8a8d\n\n#### \u30ed\u30b0\u306e\u8a2d\u5b9a\n* \u51fa\u529b\u5148\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n \n```\nsudo mkdir /var/log/nginx\n\nsudo chmod 777 /var/log/nginx/\n\nsudo chown nginx:nginx /var/log/nginx\n```\n\n* error\u30ed\u30b0\u306e\u8a2d\u5b9a\n\n```\nsudo vi /usr/local/nginx/conf/nginx.conf\n\n\n\u203berror\u30ed\u30b0\u306e\u51fa\u529b\u3092\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u306b\u3002\n \u30c7\u30d0\u30c3\u30b0\u306e\u305f\u3081\u306bnotice\u4ee5\u4e0a\u3092\u51fa\u529b\u3059\u308b\u3002\n\nerror_log   /var/log/nginx/error.log notice;\n```\n\n#### \u30dd\u30fc\u30c8\u30b9\u30ad\u30e3\u30f3\u30b3\u30de\u30f3\u30c9\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nsudo yum install nmap\n```\n\n### nginx\u8d77\u52d5\n\n* \u8d77\u52d5\n\n```\nsudo /etc/init.d/nginx start\n```\n\n```\n[vagrant@localhost nginx]$ sudo /etc/init.d/nginx start\nnginx \u3092\u8d77\u52d5\u4e2d:                                            [  OK  ]\n[vagrant@localhost nginx]$\n```\n\n* \u30dd\u30fc\u30c8\u306e\u78ba\u8a8d\n    * 80\u756a\u304c\u958b\u3044\u3066\u3044\u308b\u306e\u3067OK\n\n```\nnmap localhost\n```\n\n```\n[vagrant@localhost nginx]$ nmap localhost\n\nStarting Nmap 5.51 ( http://nmap.org ) at 2016-12-18 05:20 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.00016s latency).\nOther addresses for localhost (not scanned): 127.0.0.1\nNot shown: 996 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n111/tcp open  rpcbind\n\nNmap done: 1 IP address (1 host up) scanned in 0.07 seconds\n[vagrant@localhost nginx]$\n```\n\n* \u30ed\u30b0\u306e\u78ba\u8a8d\n\n```\ncat /var/log/nginx/error.log\n```\n```\n[vagrant@localhost nginx]$ cat /var/log/nginx/error.log\n2016/12/18 05:16:58 [notice] 9946#0: using the \"epoll\" event method\n2016/12/18 05:16:58 [notice] 9946#0: nginx/1.11.5\n2016/12/18 05:16:58 [notice] 9946#0: built by gcc 4.4.7 20120313 (Red Hat 4.4.7-16) (GCC)\n2016/12/18 05:16:58 [notice] 9946#0: OS: Linux 2.6.32-573.el6.x86_64\n2016/12/18 05:16:58 [notice] 9946#0: getrlimit(RLIMIT_NOFILE): 1024:4096\n2016/12/18 05:16:58 [notice] 9947#0: start worker processes\n2016/12/18 05:16:58 [notice] 9947#0: start worker process 9949\n[vagrant@localhost nginx]$\n```\n\n#### nginx\u306e\u505c\u6b62\n\n* \u505c\u6b62\n\n```\nsudo /etc/init.d/nginx stop\n```\n```\n[vagrant@localhost nginx]$ sudo /etc/init.d/nginx stop\nnginx \u3092\u505c\u6b62\u4e2d:                                            [  OK  ]\n[vagrant@localhost nginx]$\n```\n\n* \u30dd\u30fc\u30c8\u306e\u78ba\u8a8d\n    * 80\u756a\u304c\u9589\u3058\u3066\u3044\u308b\u306e\u3067OK\n\n```\nnmap localhost\n```\n\n```\n[vagrant@localhost nginx]$ nmap localhost\n\nStarting Nmap 5.51 ( http://nmap.org ) at 2016-12-18 05:27 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.0052s latency).\nOther addresses for localhost (not scanned): 127.0.0.1\nNot shown: 997 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n111/tcp open  rpcbind\n\nNmap done: 1 IP address (1 host up) scanned in 0.07 seconds\n[vagrant@localhost nginx]$\n```\n\n#### \u74b0\u5883\u5909\u6570\u306b\u30d1\u30b9\u3092\u901a\u3059\n\u3068\u308a\u3042\u3048\u305a\u8ffd\u52a0\u3057\u305f\n\n```\nsudo vi /etc/profile\n\n\u6700\u7d42\u884c\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\n# user add\nexport PATH=$PATH:/usr/local/nginx/sbin/\n```\n\n\u518d\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u78ba\u8a8d\n\n\n```\n[vagrant@localhost nginx]$ nginx -v\nnginx version: nginx/1.11.5\n[vagrant@localhost nginx]$\n```\n\n## Ruby\n### \u524d\u63d0\n* rbenv\u3092\u5229\u7528\u3057\u306a\u3044\n    * \u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n    * \u672c\u756a\u74b0\u5883\u3092\u60f3\u5b9a\n        * \u672c\u756a\u74b0\u5883\u306eRuby\u306ever\u3092\u983b\u7e41\u306b\u5909\u66f4\u3059\u308b\u3053\u3068\u306f\u306a\u3044\n        * \u306a\u306e\u3067Ruby2.3.3\u3092\u30d4\u30f3\u30dd\u30a4\u30f3\u30c8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n        * \u3068\u3044\u3046\u8a2d\u5b9a\u3067\u9032\u3081\u308b\n\n### CentOS\u306b\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308bruby\u306e\u524a\u9664\n\n```\nsudo yum erase ruby.x86_64\n```\n\n### \u4f9d\u5b58\u95a2\u4fc2\u306e\u89e3\u6d88\nyum\u3067\u4e00\u6c17\u306b\u3084\u3063\u3061\u307e\u3046\n\n* yum.conf\u306e\u7de8\u96c6\n    * IPv6\u3092\u7121\u52b9\u306b\u3059\u308b\n\n```\nsudo vi /etc/yum.conf\n\n\u4ee5\u4e0b\u3092\u8ffd\u8a18\n# user add\nip_resolve=4\n```\n\n* yum\u306eupdate&install\n\n```\nsudo yum -y install libyaml libyaml-devel zlib zlib-devel readline readline-devel openssl openssl-devel libxml2 libxml2-devel libxslt libxslt-devel libcurl-devel\n\nsudo yum update libyaml libyaml-devel zlib zlib-devel readline readline-devel openssl openssl-devel libxml2 libxml2-devel libxslt libxslt-devel libcurl-devel\n```\n\n### \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```\ncd /usr/local/src\n\nsudo wget https://cache.ruby-lang.org/pub/ruby/2.3/ruby-2.3.3.tar.gz\n\nsudo tar zxvf ruby-2.3.3.tar.gz\n```\n\n### \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\ncd ruby-2.3.3\n\nsudo ./configure --prefix=/usr/local/    # \u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u5fc5\u8981\u304c\u3042\u308c\u3070\u4f55\u304b\u4ed8\u4e0e\u3059\u308b\u3053\u3068\n\nsudo make\n\nsudo make install\n\n\n\u4e00\u6c17\u306b\u3084\u308a\u305f\u3044\u306a\u3089\u3053\u308c\u3067\u3082\u3044\u3044\u304b\u3082(\u672a\u691c\u8a3c)\nsudo ./configure --prefix=/usr/local/ && make && make install\n```\n\n### \u78ba\u8a8d\n\n```\nruby -v\n```\n```\n[vagrant@localhost ruby-2.3.3]$ ruby -v\nruby 2.3.3p222 (2016-11-21 revision 56859) [x86_64-linux]\n[vagrant@localhost ruby-2.3.3]$\n```\n\n```\nwhich ruby\n```\n```\n[vagrant@localhost ruby-2.3.3]$ which ruby\n/usr/local/bin/ruby\n[vagrant@localhost ruby-2.3.3]$\n```\n\n## Rails\n### Gem\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n* gem\u30b3\u30de\u30f3\u30c9\u3092sudo\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n    * `/usr/local/bin/` \u4ee5\u4e0b\u306b\u3042\u308b\u30b3\u30de\u30f3\u30c9\u306f\u5168\u3066sudo\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3057\u307e\u3046\n\n```\nsudo visudo\n\n\n\u4ee5\u4e0b\u306e\u8a18\u8ff0\u3092\u4fee\u6b63(nginx\u3082\u3064\u3044\u3067\u306b\u8ffd\u52a0)\nDefaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin\n\u2193\nDefaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin/:/usr/local/nginx/sbin/\n```\n\n* \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nsudo gem install rails -v 5.0.0.1\n```\n\n* \u78ba\u8a8d\n\n```\nrails -v\n```\n```\n[vagrant@localhost ~]$ rails -v\nRails 5.0.0.1\n[vagrant@localhost ~]$\n```\n\n## Passenger\n### \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n* gem\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nsudo gem install passenger -v '5.0.30'\n```\n\n* \u78ba\u8a8d\n\n```\n[vagrant@localhost ~]$ passenger -v\nPhusion Passenger 5.0.30\n[vagrant@localhost ~]$ which passenger\n/usr/local/bin/passenger\n[vagrant@localhost ~]$\n```\n\n### nginx\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nsudo passenger-install-nginx-module\n```\n\n\n\u3068\u3053\u308d\u3069\u3053\u308d\u3067\u805e\u304b\u308c\u308b\u3002\n\n* \u6700\u521d\u306fpassenger\u30b5\u30dd\u30fc\u30c8\u3067nginx\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3059\u308b\u304b\uff1f\u306a\u306e\u3067 `1` \n* \u6b21\u306f\u8a00\u8a9e\u3002 `Ruby` \u3067\n* nginx\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u5834\u6240\u3092\u805e\u304b\u308c\u308b\u306e\u3067 `/usr/local/src/nginx-1.11.5` \u3067\n* \u3069\u3053\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3044\u304b\u805e\u304b\u308c\u308b\u306e\u3067 `/usr/local/nginx` \u3067\n* \u305d\u306e\u307b\u304b\u306econfigure\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u805e\u304b\u308c\u308b\u3051\u3069\u3068\u308a\u3042\u3048\u305a\u7121\u3057\u3002\u305d\u306e\u307e\u307e `Enter` \u62bc\u4e0b\u3067\n* \u6700\u5f8c\u306b\u3001\u3084\u3063\u3061\u307e\u3046\u305e\uff01\uff1f\u7684\u306a\u611f\u3058\u306b\u306a\u308b\u306e\u3067\u304a\u3068\u306a\u3057\u304f `yes` \u3067\n* \u7121\u4e8b\u306b\u7d42\u308f\u3063\u305f\u3089 `Enter` \u3067\n\n\n```\n[vagrant@localhost ~]$ sudo passenger-install-nginx-module\nWelcome to the Phusion Passenger Nginx module installer, v5.0.30.\n\nThis installer will guide you through the entire installation process. It\nshouldn't take more than 5 minutes in total.\n\nHere's what you can expect from the installation process:\n\n 1. This installer will compile and install Nginx with Passenger support.\n 2. You'll learn how to configure Passenger in Nginx.\n 3. You'll learn how to deploy a Ruby on Rails application.\n\nDon't worry if anything goes wrong. This installer will advise you on how to\nsolve any problems.\n\nPress Enter to continue, or Ctrl-C to abort.\n1\n\n--------------------------------------------\n\nWhich languages are you interested in?\n\nUse <space> to select.\nIf the menu doesn't display correctly, press '!'\n\n \u2023 \u2b22  Ruby\n   \u2b22  Python\n   \u2b21  Node.js\n   \u2b21  Meteor\n\n--------------------------------------------\n\nChecking for required software...\n\n * Checking for C compiler...\n      Found: yes\n      Location: /usr/bin/cc\n\n\u7701\u7565\n\n--------------------------------------------\n\nAutomatically download and install Nginx?\n\nNginx doesn't support loadable modules such as some other web servers do,\nso in order to install Nginx with Passenger support, it must be recompiled.\n\nDo you want this installer to download, compile and install Nginx for you?\n\n 1. Yes: download, compile and install Nginx for me. (recommended)\n    The easiest way to get started. A stock Nginx 1.10.1 with Passenger\n    support, but with no other additional third party modules, will be\n    installed for you to a directory of your choice.\n\n 2. No: I want to customize my Nginx installation. (for advanced users)\n    Choose this if you want to compile Nginx with more third party modules\n    besides Passenger, or if you need to pass additional options to Nginx's\n    'configure' script. This installer will  1) ask you for the location of\n    the Nginx source code,  2) run the 'configure' script according to your\n    instructions, and  3) run 'make install'.\n\nWhichever you choose, if you already have an existing Nginx configuration file,\nthen it will be preserved.\n\nEnter your choice (1 or 2) or press Ctrl-C to abort: 2\n\n--------------------------------------------\n\nWhere is your Nginx source code located?\n\nPlease specify the directory: /usr/local/src/nginx-1.11.5\n\n--------------------------------------------\n\nWhere do you want to install Nginx to?\n\nPlease specify a prefix directory [/opt/nginx]: /usr/local/nginx\n\n--------------------------------------------\n\nExtra Nginx configure options\n\nIf you want to pass extra arguments to the Nginx 'configure' script, then\nplease specify them. If not, then specify nothing and press Enter.\n\nIf you specify nothing then the 'configure' script will be run as follows:\n\n  sh ./configure --prefix='/usr/local/nginx' --with-http_ssl_module --with-http_gzip_static_module --with-http_stub_status_module --with-cc-opt=-Wno-error --with-ld-opt='' --add-module='/usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30/src/nginx_module'\n\nExtra arguments to pass to configure script:\n\n--------------------------------------------\n\nConfirm configure flags\n\nThe Nginx configure script will be run as follows:\n\n  sh ./configure --prefix='/usr/local/nginx' --with-http_ssl_module --with-http_gzip_static_module --with-http_stub_status_module --with-cc-opt=-Wno-error --with-ld-opt='' --add-module='/usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30/src/nginx_module'\n\nIs this what you want? (yes/no) [default=yes]: yes\n\n--------------------------------------------\n\nCompiling Passenger support files...\n# env NOEXEC_DISABLE=1 /usr/local/bin/ruby /usr/local/bin/rake nginx:clean nginx RELEASE=yes\n\n\u7701\u7565\n\n--------------------------------------------\n\nNginx with Passenger support was successfully installed.\n\nPlease edit your Nginx configuration file (probably /usr/local/nginx/conf/nginx.conf),\nand set the passenger_root and passenger_ruby configuration options in the\n'http' block, like this:\n\n  http {\n      ...\n      passenger_root /usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30;\n      passenger_ruby /usr/local/bin/ruby;\n      ...\n  }\n\nAfter you (re)start Nginx, you are ready to deploy any number of web\napplications on Nginx.\n\nPress ENTER to continue.\n\n--------------------------------------------\n\nDeploying a web application\n\nTo learn how to deploy a web app on Passenger, please follow the deployment\nguide:\n\n  https://www.phusionpassenger.com/library/deploy/nginx/deploy/\n\nEnjoy Phusion Passenger, a product of Phusion (www.phusion.nl) :-)\nhttps://www.phusionpassenger.com\n\nPhusion Passenger is a registered trademark of Hongli Lai & Ninh Bui.\n[vagrant@localhost ~]$\n```\n\n* \u78ba\u8a8d\n    * `--add-module` \u306bpassenger\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\n\n\n```\nnginx -V\n```\n```\n[vagrant@localhost ~]$ nginx -V\nnginx version: nginx/1.11.5\nbuilt by gcc 4.4.7 20120313 (Red Hat 4.4.7-16) (GCC)\nbuilt with OpenSSL 1.0.1e-fips 11 Feb 2013\nTLS SNI support enabled\nconfigure arguments: --prefix=/usr/local/nginx --with-http_ssl_module --with-http_gzip_static_module --with-http_stub_status_module --with-cc-opt=-Wno-error --with-ld-opt= --add-module=/usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30/src/nginx_module\n[vagrant@localhost ~]$\n```\n\n* \u8d77\u52d5&\u505c\u6b62\u78ba\u8a8d\n\n```\n[vagrant@localhost ~]$ sudo /etc/init.d/nginx start\nnginx \u3092\u8d77\u52d5\u4e2d:                                            [  OK  ]\n[vagrant@localhost ~]$ nmap localhost\n\nStarting Nmap 5.51 ( http://nmap.org ) at 2016-12-18 09:40 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.00017s latency).\nOther addresses for localhost (not scanned): 127.0.0.1\nNot shown: 996 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n111/tcp open  rpcbind\n\nNmap done: 1 IP address (1 host up) scanned in 0.09 seconds\n\n\n\n[vagrant@localhost ~]$ sudo /etc/init.d/nginx stop\nnginx \u3092\u505c\u6b62\u4e2d:                                            [  OK  ]\n[vagrant@localhost ~]$ nmap localhost\n\nStarting Nmap 5.51 ( http://nmap.org ) at 2016-12-18 09:40 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.00031s latency).\nOther addresses for localhost (not scanned): 127.0.0.1\nNot shown: 997 closed ports\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n111/tcp open  rpcbind\n\nNmap done: 1 IP address (1 host up) scanned in 0.06 seconds\n[vagrant@localhost ~]$\n```\n\n## \u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066rails\u30a2\u30d7\u30ea\u3092\u8868\u793a\u3059\u308b\n### \u30a2\u30d7\u30ea\u306e\u4f5c\u6210\n\n```\ncd /vagrant\n\nrails new getwild\n```\n\n* Gemfile\u306e\u7de8\u96c6\n    * `therubyracer` \u306e\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3059\n    * \u5916\u3057\u3066\u304a\u304b\u306a\u3044\u3068rails\u30a2\u30d7\u30ea\u3092\u52d5\u304b\u3057\u305f\u6642\u306b\u30a8\u30e9\u30fc\u306b\u306a\u308b\n\n```\ncd getwild\n\nvi Gemfile\n```\n\n* `bundle install` \u3092\u5b9f\u884c\n\n```\n[vagrant@localhost getwild]$ bundle install\nFetching gem metadata from https://rubygems.org/..........\nFetching version metadata from https://rubygems.org/..\nFetching dependency metadata from https://rubygems.org/.\nResolving dependencies...\nUsing rake 12.0.0\nUsing concurrent-ruby 1.0.3\n\n\u7701\u7565\n\nUsing rails 5.0.0.1\nUsing sass-rails 5.0.6\nBundle complete! 16 Gemfile dependencies, 65 gems now installed.\nUse `bundle show [gemname]` to see where a bundled gem is installed.\n[vagrant@localhost getwild]$\n```\n\n### nginx.conf\u306e\u7de8\u96c6\n\n\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u5185\u5bb9\u306b\u7de8\u96c6\u3002\n\n```/usr/local/nginx/conf/nginx.conf\n\n#user  nobody;\nworker_processes  1;\n\nerror_log   /var/log/nginx/error.log notice;\npid        /var/log/nginx/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    passenger_root /usr/local/lib/ruby/gems/2.3.0/gems/passenger-5.0.30;\n    passenger_ruby /usr/local/bin/ruby;\n\n    server {\n        listen       80;\n        server_name  192.168.33.10;\n        access_log   /var/log/nginx/192.168.33.10.access.log;\n        error_log    /var/log/nginx/192.168.33.10.error.log;\n\n        location / {\n            root                  /vagrant/getwild/public;\n            passenger_base_uri    /;\n            passenger_enabled     on;\n            rails_spawn_method    smart;\n            rails_env             development;\n            index                 index.html index.htm;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n    }\n\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server {\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n\n    # HTTPS server\n    #\n    #server {\n    #    listen       443 ssl;\n    #    server_name  localhost;\n\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n\n    #    ssl_session_cache    shared:SSL:1m;\n    #    ssl_session_timeout  5m;\n\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n}\n```\n\n### iptables\u306e\u7de8\u96c6\n80\u756a\u30dd\u30fc\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\n\n* \u78ba\u8a8d\n\n```\nsudo /sbin/iptables -L --line-numbers\n```\n```\n[vagrant@localhost ~]$ sudo /sbin/iptables -L --line-numbers\nChain INPUT (policy ACCEPT)\nnum  target     prot opt source               destination\n1    ACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED\n2    ACCEPT     icmp --  anywhere             anywhere\n3    ACCEPT     all  --  anywhere             anywhere\n4    ACCEPT     tcp  --  anywhere             anywhere            state NEW tcp dpt:ssh\n5    REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n\nChain FORWARD (policy ACCEPT)\nnum  target     prot opt source               destination\n1    REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n\nChain OUTPUT (policy ACCEPT)\nnum  target     prot opt source               destination\n[vagrant@localhost ~]$\n```\n\n* 80\u756a\u3092\u958b\u3051\u308b\n\n```\nsudo /sbin/iptables -I INPUT 5 -p tcp -m tcp --dport 80 -j ACCEPT\n```\n\n* \u4fdd\u5b58\n\n```\nsudo service iptables save\n```\n```\n[vagrant@localhost ~]$ sudo service iptables save\niptables: Saving firewall rules to /etc/sysconfig/iptables:[  OK  ]\n[vagrant@localhost ~]$\n```\n\n* \u518d\u78ba\u8a8d\n\n```\n[vagrant@localhost ~]$ sudo /sbin/iptables -L --line-numbers\nChain INPUT (policy ACCEPT)\nnum  target     prot opt source               destination\n1    ACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED\n2    ACCEPT     icmp --  anywhere             anywhere\n3    ACCEPT     all  --  anywhere             anywhere\n4    ACCEPT     tcp  --  anywhere             anywhere            state NEW tcp dpt:ssh\n5    ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:http\n6    REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n\nChain FORWARD (policy ACCEPT)\nnum  target     prot opt source               destination\n1    REJECT     all  --  anywhere             anywhere            reject-with icmp-host-prohibited\n\nChain OUTPUT (policy ACCEPT)\nnum  target     prot opt source               destination\n[vagrant@localhost ~]$\n```\n\n### \u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\n\n\u81ea\u5206\u306e\u74b0\u5883\u306e\u5834\u5408\u4ee5\u4e0b\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u3067vagrant\u4e0a\u306e\u30a2\u30d7\u30ea\u306b\u3064\u306a\u304c\u308b\u3002\n\n`http://192.168.33.10/`\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-19 22.09.07.png](https://qiita-image-store.s3.amazonaws.com/0/71146/3322a65a-b5a6-79e6-eb54-56f7df51b34b.png)\n\n\nrails\u30a2\u30d7\u30ea\u3092\u52d5\u4f5c\u3055\u305b\u308b\u74b0\u5883\u304c\u51fa\u6765\u4e0a\u304c\u308a\u307e\u3057\u305f\u3002\n"}