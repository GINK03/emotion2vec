{"context": "\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\n\n\u306e\u7ae0\u672b\u554f\u984c\u3067\u300c\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3092\u7528\u3044\u3066\u300d\u3068\u3042\u308b\u3082\u306e\u3092R\u3067\u89e3\u3044\u3066\u3044\u307e\u3059\u3002\n\n\u30b5\u30dd\u30fc\u30c8\u30b5\u30a4\u30c8\uff08\u30c7\u30fc\u30bf\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\uff09\n\n\n6.4\nmsci<-read.table(\"msci_day.txt\", header=T)\nmsci.log<-log(msci[,2:8])\ndim(msci.log)\n\n[1] 1391    7\n\n\n(1)\nset.seed(1)\nwn<-rnorm(1391)\nhist(wn)\n\n\n\n(2)\nout<-data.frame(matrix(1:21,nrow=7,ncol=3))\nfor (i in 1:7) {\n  tmp.p<-lm(msci.log[,i]~wn)\n  tmp.p.beta<-tmp.p$coefficients[2]\n  tmp.f.stat<-summary(tmp.p)$fstatistic\n  tmp.p.p.value<-1-pf(tmp.f.stat[\"value\"],tmp.f.stat[\"numdf\"],tmp.f.stat[\"dendf\"])\n  tmp.p.adj.r.squared<-summary(tmp.p)$adj.r.squared\n  out[i,]<-data.frame(matrix(c(tmp.p.beta, tmp.p.p.value, tmp.p.adj.r.squared), nrow=1))\n}\ncolnames(out)<-c(\"\u63a8\u5b9a\u5024\u03b2^\", \"p\u5024\", \"\u6c7a\u5b9a\u4fc2\u6570\")\nrownames(out)<-colnames(msci.log)\nout\n\n   \u63a8\u5b9a\u5024\u03b2^       p\u5024\u3000\u3000\u3000\u3000\u6c7a\u5b9a\u4fc2\u6570\nca  -0.005197388 0.5748192 -0.0004931680\nfr  -0.003196312 0.6706261 -0.0005895938\nge  -0.003614680 0.6928374 -0.0006074941\nit  -0.003411967 0.5995188 -0.0005212435\njp  -0.001184826 0.8467281 -0.0006930146\nuk  -0.002621959 0.6630235 -0.0005831074\nus  -0.002241276 0.5714044 -0.0004890948\n\n\u8abf\u6574\u6e08\u307f\u6c7a\u5b9a\u4fc2\u6570\u306a\u306e\u3067\u3001\u8ca0\u306e\u5024\u306b\u306a\u3063\u3066\u3044\u308b\u304c\u5b9f\u8cea\u307b\u307c0\u3002\n\n(3)\nrw<-cumsum(wn)\nplot(rw, type=\"l\")\n\n\n\n(4)\nout<-data.frame(matrix(1:21,nrow=7,ncol=3))\nfor (i in 1:7) {\n  tmp.p<-lm(msci.log[,i]~rw)\n  tmp.p.beta<-tmp.p$coefficients[2]\n  tmp.f.stat<-summary(tmp.p)$fstatistic\n  tmp.p.p.value<-1-pf(tmp.f.stat[\"value\"],tmp.f.stat[\"numdf\"],tmp.f.stat[\"dendf\"])\n  tmp.p.adj.r.squared<-summary(tmp.p)$adj.r.squared\n  out[i,]<-data.frame(matrix(c(tmp.p.beta, tmp.p.p.value, tmp.p.adj.r.squared), nrow=1))\n}\ncolnames(out)<-c(\"\u63a8\u5b9a\u5024\u03b2^\", \"p\u5024\", \"\u6c7a\u5b9a\u4fc2\u6570\")\nrownames(out)<-colnames(msci.log)\nout\n\n   \u63a8\u5b9a\u5024\u03b2^       p\u5024\u3000\u3000\u3000\u3000\u6c7a\u5b9a\u4fc2\u6570\nca -0.022671268   0        0.6988062\nfr -0.017622486   0        0.6416288\nge -0.021094733   0        0.6201344\nit -0.014705891   0        0.5976875\njp -0.013653738   0        0.5790067\nuk -0.013868895   0        0.6199455\nus -0.008966661   0        0.5982770\n\n\u898b\u305b\u304b\u3051\u306e\u56de\u5e30\u306e\u73fe\u8c61\u304c\u898b\u3089\u308c\u308b\u3002\n\u30c6\u30ad\u30b9\u30c8\u3068\u30db\u30ef\u30a4\u30c8\u30ce\u30a4\u30ba\u306e\u5024\u304c\u7570\u306a\u308b\u306e\u3067\u5024\u306f\u4e00\u81f4\u3057\u306a\u3044\u304c\u3001p125\u306e\u88686.1\u3068\u540c\u7b49\u306bp\u5024\u304c0\u3067\u6c7a\u5b9a\u4fc2\u6570\u304c\u9ad8\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\n\n(5)\nfor (i in 1:1) {\n  rw_1<-0\n  y_1<-0\n  rw_1[1]<-0\n  y_1[1]<-0\n  for (j in 2:1391) {\n    rw_1[j]<-rw[j-1]\n    y_1[j]<-msci.log[j-1,i]\n  }\n  tmp.p<-lm(msci.log[,i]~rw+rw_1+y_1)\n  tmp.p.beta<-tmp.p$coefficients[2]\n  tmp.f.stat<-summary(tmp.p)$fstatistic\n  tmp.p.p.value<-1-pf(tmp.f.stat[\"value\"],tmp.f.stat[\"numdf\"],tmp.f.stat[\"dendf\"])\n  tmp.p.adj.r.squared<-summary(tmp.p)$adj.r.squared\n  out[i,]<-data.frame(matrix(c(tmp.p.beta, tmp.p.p.value, tmp.p.adj.r.squared), nrow=1))\n}\ncolnames(out)<-c(\"\u63a8\u5b9a\u5024\u03b2^\", \"p\u5024\", \"\u6c7a\u5b9a\u4fc2\u6570\")\nrownames(out)<-colnames(msci.log)\nout\n\n   \u63a8\u5b9a\u5024\u03b2^       p\u5024\u3000\u3000\u3000\u3000\u6c7a\u5b9a\u4fc2\u6570\nca -0.007613280   0        0.8812688\nfr -0.017622486   0        0.6416288\nge -0.021094733   0        0.6201344\nit -0.014705891   0        0.5976875\njp -0.013653738   0        0.5790067\nuk -0.013868895   0        0.6199455\nus -0.008966661   0        0.5982770\n\n\u898b\u305b\u304b\u3051\u306e\u56de\u5e30\u306e\u73fe\u8c61\u304c\u898b\u3089\u308c\u308b\u3002\n\n6.5\nppp<-read.table(\"ppp.txt\", header=T)\n\n\n(1)\nlcpijp<-ts(log(ppp$cpijp),start=c(1974,1),frequency=12)\nlcpius<-ts(log(ppp$cpius),start=c(1974,1),frequency=12)\nlexjp<-ts(log(ppp$exjp),start=c(1974,1),frequency=12)\npar(mfrow=c(3,2))\npar(mar=c(2,4,1,1))\nts.plot(ts(ppp$cpijp,start=c(1974,1),frequency=12),ylab=\"cpijp\")\nts.plot(lcpijp,ylab=\"log(cpijp)\")\nts.plot(ts(ppp$cpius,start=c(1974,1),frequency=12),ylab=\"cpius\")\nts.plot(lcpius,ylab=\"log(cpius)\")\nts.plot(ts(ppp$exjp,start=c(1974,1),frequency=12),ylab=\"exjp\")\nts.plot(lexjp,ylab=\"log(exjp)\")\n\n\n\n(2)\nlibrary(tseries)\nadf.test(lcpijp)\nadf.test(lcpijp, alternative = \"explosive\")\nadf.test(lcpius)\nadf.test(lcpius, alternative = \"explosive\")\nadf.test(lexjp)\nadf.test(lexjp, alternative = \"explosive\")\n\n> adf.test(lcpijp)\n\n    Augmented Dickey-Fuller Test\n\ndata:  lcpijp\nDickey-Fuller = -4.0654, Lag order = 7, p-value = 0.01\nalternative hypothesis: stationary\n\nWarning message:\nIn adf.test(lcpijp) : p-value smaller than printed p-value\n> adf.test(lcpijp, alternative = \"explosive\")\n\n    Augmented Dickey-Fuller Test\n\ndata:  lcpijp\nDickey-Fuller = -4.0654, Lag order = 7, p-value = 0.99\nalternative hypothesis: explosive\n\nWarning message:\nIn adf.test(lcpijp, alternative = \"explosive\") :\n  p-value smaller than printed p-value\n> adf.test(lcpius)\n\n    Augmented Dickey-Fuller Test\n\ndata:  lcpius\nDickey-Fuller = -2.4815, Lag order = 7, p-value =\n0.3739\nalternative hypothesis: stationary\n\n> adf.test(lcpius, alternative = \"explosive\")\n\n    Augmented Dickey-Fuller Test\n\ndata:  lcpius\nDickey-Fuller = -2.4815, Lag order = 7, p-value =\n0.6261\nalternative hypothesis: explosive\n\n> adf.test(lexjp)\n\n    Augmented Dickey-Fuller Test\n\ndata:  lexjp\nDickey-Fuller = -1.6156, Lag order = 7, p-value =\n0.7396\nalternative hypothesis: stationary\n\n> adf.test(lexjp, alternative = \"explosive\")\n\n    Augmented Dickey-Fuller Test\n\ndata:  lexjp\nDickey-Fuller = -1.6156, Lag order = 7, p-value =\n0.2604\nalternative hypothesis: explosive\n\n\n(3)\nlrexjp<-lcpijp-lcpius-lexjp\npar(mar=c(2,4,1,4))\nplot(lrexjp, ylab=\"log(rexjp)\")\n\n\n\n(4)\nPPP\u4eee\u8aac\u306f\n$$\nlcpijp \\approx lexjp + lcpius\n$$\n\u3067\u3042\u308b\u304b\u3089\n$$\nlcpijp - lcpius - lexjp = lrexjp \\approx 0 \n$$\n\u3088\u308alrexjp\u304c0\u306b\u53ce\u675f\u3059\u308b\u3053\u3068\u3092\u793a\u5506\u3057\u3066\u3044\u308b\u3002\n\n(5)\nadf.test(lrexjp)\nadf.test(lrexjp, alternative = \"explosive\")\nadf.test(diff(lrexjp))\n\n> adf.test(lrexjp)\n\n    Augmented Dickey-Fuller Test\n\ndata:  lrexjp\nDickey-Fuller = -1.3335, Lag order = 7, p-value =\n0.8587\nalternative hypothesis: stationary\n\n> adf.test(lrexjp, alternative = \"explosive\")\n\n    Augmented Dickey-Fuller Test\n\ndata:  lrexjp\nDickey-Fuller = -1.3335, Lag order = 7, p-value =\n0.1413\nalternative hypothesis: explosive\n\n> adf.test(diff(lrexjp))\n\n    Augmented Dickey-Fuller Test\n\ndata:  diff(lrexjp)\nDickey-Fuller = -6.7109, Lag order = 7, p-value = 0.01\nalternative hypothesis: stationary\n\nWarning message:\nIn adf.test(diff(lrexjp)) : p-value smaller than printed p-value\n\n\u3088\u308a\u3001\u5358\u4f4d\u6839\u304c\u3042\u308b\u3002\u3053\u306e\u305f\u3081lrexjp\u306e\u5024\u304c\u53ce\u675f\u3057\u306a\u3044\u306e\u3067\u3001PPP\u4eee\u8aac\u3092\u652f\u6301\u3057\u3066\u3044\u306a\u3044\u3002\n\n(6)\nlibrary(urca)\nlrexjp.df<-data.frame(lcpijp, -lcpius, -lexjp)\nlrexjp.vecm<-ca.jo(lrexjp.df, ecdet=\"none\", type=\"eigen\", K=6, spec=\"longrun\", season=NULL)\nsummary(lrexjp.vecm)\n\n> summary(lrexjp.vecm)\n\n###################### \n# Johansen-Procedure # \n###################### \n\nTest type: maximal eigenvalue statistic (lambda max) , with linear trend \n\nEigenvalues (lambda):\n[1] 0.158408638 0.032735262 0.002925689\n\nValues of teststatistic and critical values of test:\n\n          test 10pct  5pct  1pct\nr <= 2 |  1.14  6.50  8.18 11.65\nr <= 1 | 12.98 12.91 14.90 19.19\nr = 0  | 67.26 18.90 21.07 25.75\n\nEigenvectors, normalised to first column:\n(These are the cointegration relations)\n\n              lcpijp.l6 X.lcpius.l6 X.lexjp.l6\nlcpijp.l6    1.00000000   1.0000000  1.0000000\nX.lcpius.l6  0.02892562   0.2519313  0.7927706\nX.lexjp.l6  -0.07537271  -0.3823289  0.1300192\n\nWeights W:\n(This is the loading matrix)\n\n              lcpijp.l6 X.lcpius.l6    X.lexjp.l6\nlcpijp.d   -0.021872635 0.002756738 -0.0007592322\nX.lcpius.d  0.014398742 0.008619883 -0.0038549536\nX.lexjp.d   0.002801142 0.061199460  0.0184638162\n\nr = 1\nr+1=2\u500b\u306e\u5171\u548c\u5206\u95a2\u4fc2\u304c\u5b58\u5728\u3059\u308b\u3002\u3088\u3063\u3066PPP\u4eee\u8aac\u3092\u652f\u6301\u3059\u308b\u3002\n\n(7)\nlcpica<-ts(log(ppp$cpica),start=c(1974,1),frequency=12)\nlcpiuk<-ts(log(ppp$cpiuk),start=c(1974,1),frequency=12)\nlexca<-ts(log(ppp$exca),start=c(1974,1),frequency=12)\nlexuk<-ts(log(ppp$exuk),start=c(1974,1),frequency=12)\n\nlrexca.df<-data.frame(lcpica, -lcpius, -lexca)\nlrexca.vecm<-ca.jo(lrexca.df, ecdet=\"none\", type=\"eigen\", K=6, spec=\"longrun\", season=NULL)\nsummary(lrexca.vecm)\n\n###################### \n# Johansen-Procedure # \n###################### \n\nTest type: maximal eigenvalue statistic (lambda max) , with linear trend \n\nEigenvalues (lambda):\n[1] 0.104204155 0.016269511 0.002260424\n\nValues of teststatistic and critical values of test:\n\n          test 10pct  5pct  1pct\nr <= 2 |  0.88  6.50  8.18 11.65\nr <= 1 |  6.40 12.91 14.90 19.19\nr = 0  | 42.92 18.90 21.07 25.75\n\nEigenvectors, normalised to first column:\n(These are the cointegration relations)\n\n             lcpica.l6 X.lcpius.l6 X.lexca.l6\nlcpica.l6   1.00000000   1.0000000   1.000000\nX.lcpius.l6 0.97756101   1.2966193   2.087184\nX.lexca.l6  0.04893602   0.6192151  -1.629409\n\nWeights W:\n(This is the loading matrix)\n\n              lcpica.l6  X.lcpius.l6    X.lexca.l6\nlcpica.d   -0.013164472 -0.001479385  0.0003232371\nX.lcpius.d  0.009339536 -0.007286482 -0.0011414028\nX.lexca.d   0.032099791 -0.011930871  0.0031450132\n\nlrexuk.df<-data.frame(lcpiuk, -lcpius, -lexuk)\nlrexuk.vecm<-ca.jo(lrexuk.df, ecdet=\"none\", type=\"eigen\", K=6, spec=\"longrun\", season=NULL)\nsummary(lrexuk.vecm)\n\n###################### \n# Johansen-Procedure # \n###################### \n\nTest type: maximal eigenvalue statistic (lambda max) , with linear trend \n\nEigenvalues (lambda):\n[1] 0.128672334 0.030943227 0.007768275\n\nValues of teststatistic and critical values of test:\n\n          test 10pct  5pct  1pct\nr <= 2 |  3.04  6.50  8.18 11.65\nr <= 1 | 12.26 12.91 14.90 19.19\nr = 0  | 53.72 18.90 21.07 25.75\n\nEigenvectors, normalised to first column:\n(These are the cointegration relations)\n\n             lcpiuk.l6 X.lcpius.l6 X.lexuk.l6\nlcpiuk.l6    1.0000000   1.0000000   1.000000\nX.lcpius.l6  0.5757486   1.3613908   1.945102\nX.lexuk.l6  -2.0586854   0.9541808  -0.105148\n\nWeights W:\n(This is the loading matrix)\n\n              lcpiuk.l6  X.lcpius.l6   X.lexuk.l6\nlcpiuk.d   -0.005272950 -0.003607554  0.001152957\nX.lcpius.d  0.002705188 -0.006229943 -0.003849241\nX.lexuk.d   0.011352610 -0.017602665  0.026309049\n\nr = 1\nr+1=2\u500b\u306e\u5171\u548c\u5206\u95a2\u4fc2\u304c\u5b58\u5728\u3059\u308b\u3002\u3088\u3063\u3066PPP\u4eee\u8aac\u3092\u652f\u6301\u3059\u308b\u3002\n\u6b21\u306f \u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\u7ae0\u672b\u554f\u984c\u3092R\u3067\u89e3\u304f\uff0d\u7b2c7\u7ae0GARCH\u30e2\u30c7\u30eb\uff0d\n<a href=\"https://www.amazon.co.jp/%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90-%E7%B5%B1%E8%A8%88%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%83%BC-%E6%B2%96%E6%9C%AC-%E7%AB%9C%E7%BE%A9/dp/4254127928/ref=as_li_ss_tl?ie=UTF8&qid=1478165293&sr=8-1&keywords=%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90&linkCode=ll1&tag=aokikenichi-22&linkId=b4fb2bc3209ec5a8b2d381d8955f2486\">\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f</a>\n<a href=\"https://www.amazon.co.jp/%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90-%E7%B5%B1%E8%A8%88%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%83%BC-%E6%B2%96%E6%9C%AC-%E7%AB%9C%E7%BE%A9/dp/4254127928/ref=as_li_ss_il?ie=UTF8&qid=1478165293&sr=8-1&keywords=%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90&linkCode=li2&tag=aokikenichi-22&linkId=53c071200e6bc21d9723dd3a5f926476\" target=\"_blank\"><img border=\"0\" src=\"//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4254127928&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=aokikenichi-22\" ></a><img src=\"https://ir-jp.amazon-adsystem.com/e/ir?t=aokikenichi-22&l=li2&o=9&a=4254127928\" width=\"1\" height=\"1\" border=\"0\" alt=\"\" style=\"border:none !important; margin:0px !important;\" />\n\u306e\u7ae0\u672b\u554f\u984c\u3067\u300c\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3092\u7528\u3044\u3066\u300d\u3068\u3042\u308b\u3082\u306e\u3092R\u3067\u89e3\u3044\u3066\u3044\u307e\u3059\u3002\n\n* [\u30b5\u30dd\u30fc\u30c8\u30b5\u30a4\u30c8\uff08\u30c7\u30fc\u30bf\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\uff09](http://www.geocities.jp/tatsuyoshi_okimoto/books/tsa.html)\n\n# 6.4\n```r\nmsci<-read.table(\"msci_day.txt\", header=T)\nmsci.log<-log(msci[,2:8])\ndim(msci.log)\n```\n\n```r\n[1] 1391    7\n```\n\n### (1)\n```r\nset.seed(1)\nwn<-rnorm(1391)\nhist(wn)\n```\n![Rplot13.png](https://qiita-image-store.s3.amazonaws.com/0/116049/2a2d7444-a556-1a28-18ea-d1d5d653df65.png)\n\n### (2)\n```r\nout<-data.frame(matrix(1:21,nrow=7,ncol=3))\nfor (i in 1:7) {\n  tmp.p<-lm(msci.log[,i]~wn)\n  tmp.p.beta<-tmp.p$coefficients[2]\n  tmp.f.stat<-summary(tmp.p)$fstatistic\n  tmp.p.p.value<-1-pf(tmp.f.stat[\"value\"],tmp.f.stat[\"numdf\"],tmp.f.stat[\"dendf\"])\n  tmp.p.adj.r.squared<-summary(tmp.p)$adj.r.squared\n  out[i,]<-data.frame(matrix(c(tmp.p.beta, tmp.p.p.value, tmp.p.adj.r.squared), nrow=1))\n}\ncolnames(out)<-c(\"\u63a8\u5b9a\u5024\u03b2^\", \"p\u5024\", \"\u6c7a\u5b9a\u4fc2\u6570\")\nrownames(out)<-colnames(msci.log)\nout\n```\n\n```r\n   \u63a8\u5b9a\u5024\u03b2^       p\u5024\u3000\u3000\u3000\u3000\u6c7a\u5b9a\u4fc2\u6570\nca  -0.005197388 0.5748192 -0.0004931680\nfr  -0.003196312 0.6706261 -0.0005895938\nge  -0.003614680 0.6928374 -0.0006074941\nit  -0.003411967 0.5995188 -0.0005212435\njp  -0.001184826 0.8467281 -0.0006930146\nuk  -0.002621959 0.6630235 -0.0005831074\nus  -0.002241276 0.5714044 -0.0004890948\n```\n\u8abf\u6574\u6e08\u307f\u6c7a\u5b9a\u4fc2\u6570\u306a\u306e\u3067\u3001\u8ca0\u306e\u5024\u306b\u306a\u3063\u3066\u3044\u308b\u304c\u5b9f\u8cea\u307b\u307c0\u3002\n\n### (3)\n```r\nrw<-cumsum(wn)\nplot(rw, type=\"l\")\n```\n![Rplot14.png](https://qiita-image-store.s3.amazonaws.com/0/116049/543f7519-5ec8-a838-bb0f-c55886fd443f.png)\n\n### (4) \n```r\nout<-data.frame(matrix(1:21,nrow=7,ncol=3))\nfor (i in 1:7) {\n  tmp.p<-lm(msci.log[,i]~rw)\n  tmp.p.beta<-tmp.p$coefficients[2]\n  tmp.f.stat<-summary(tmp.p)$fstatistic\n  tmp.p.p.value<-1-pf(tmp.f.stat[\"value\"],tmp.f.stat[\"numdf\"],tmp.f.stat[\"dendf\"])\n  tmp.p.adj.r.squared<-summary(tmp.p)$adj.r.squared\n  out[i,]<-data.frame(matrix(c(tmp.p.beta, tmp.p.p.value, tmp.p.adj.r.squared), nrow=1))\n}\ncolnames(out)<-c(\"\u63a8\u5b9a\u5024\u03b2^\", \"p\u5024\", \"\u6c7a\u5b9a\u4fc2\u6570\")\nrownames(out)<-colnames(msci.log)\nout\n```\n\n```r\n   \u63a8\u5b9a\u5024\u03b2^       p\u5024\u3000\u3000\u3000\u3000\u6c7a\u5b9a\u4fc2\u6570\nca -0.022671268   0        0.6988062\nfr -0.017622486   0        0.6416288\nge -0.021094733   0        0.6201344\nit -0.014705891   0        0.5976875\njp -0.013653738   0        0.5790067\nuk -0.013868895   0        0.6199455\nus -0.008966661   0        0.5982770\n```\n\u898b\u305b\u304b\u3051\u306e\u56de\u5e30\u306e\u73fe\u8c61\u304c\u898b\u3089\u308c\u308b\u3002\n\u30c6\u30ad\u30b9\u30c8\u3068\u30db\u30ef\u30a4\u30c8\u30ce\u30a4\u30ba\u306e\u5024\u304c\u7570\u306a\u308b\u306e\u3067\u5024\u306f\u4e00\u81f4\u3057\u306a\u3044\u304c\u3001p125\u306e\u88686.1\u3068\u540c\u7b49\u306bp\u5024\u304c0\u3067\u6c7a\u5b9a\u4fc2\u6570\u304c\u9ad8\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\n\n\n### (5)\n```r\nfor (i in 1:1) {\n  rw_1<-0\n  y_1<-0\n  rw_1[1]<-0\n  y_1[1]<-0\n  for (j in 2:1391) {\n    rw_1[j]<-rw[j-1]\n    y_1[j]<-msci.log[j-1,i]\n  }\n  tmp.p<-lm(msci.log[,i]~rw+rw_1+y_1)\n  tmp.p.beta<-tmp.p$coefficients[2]\n  tmp.f.stat<-summary(tmp.p)$fstatistic\n  tmp.p.p.value<-1-pf(tmp.f.stat[\"value\"],tmp.f.stat[\"numdf\"],tmp.f.stat[\"dendf\"])\n  tmp.p.adj.r.squared<-summary(tmp.p)$adj.r.squared\n  out[i,]<-data.frame(matrix(c(tmp.p.beta, tmp.p.p.value, tmp.p.adj.r.squared), nrow=1))\n}\ncolnames(out)<-c(\"\u63a8\u5b9a\u5024\u03b2^\", \"p\u5024\", \"\u6c7a\u5b9a\u4fc2\u6570\")\nrownames(out)<-colnames(msci.log)\nout\n```\n\n```\n   \u63a8\u5b9a\u5024\u03b2^       p\u5024\u3000\u3000\u3000\u3000\u6c7a\u5b9a\u4fc2\u6570\nca -0.007613280   0        0.8812688\nfr -0.017622486   0        0.6416288\nge -0.021094733   0        0.6201344\nit -0.014705891   0        0.5976875\njp -0.013653738   0        0.5790067\nuk -0.013868895   0        0.6199455\nus -0.008966661   0        0.5982770\n```\n\u898b\u305b\u304b\u3051\u306e\u56de\u5e30\u306e\u73fe\u8c61\u304c\u898b\u3089\u308c\u308b\u3002\n\n## 6.5\n```r\nppp<-read.table(\"ppp.txt\", header=T)\n```\n\n### (1)\n```r\nlcpijp<-ts(log(ppp$cpijp),start=c(1974,1),frequency=12)\nlcpius<-ts(log(ppp$cpius),start=c(1974,1),frequency=12)\nlexjp<-ts(log(ppp$exjp),start=c(1974,1),frequency=12)\npar(mfrow=c(3,2))\npar(mar=c(2,4,1,1))\nts.plot(ts(ppp$cpijp,start=c(1974,1),frequency=12),ylab=\"cpijp\")\nts.plot(lcpijp,ylab=\"log(cpijp)\")\nts.plot(ts(ppp$cpius,start=c(1974,1),frequency=12),ylab=\"cpius\")\nts.plot(lcpius,ylab=\"log(cpius)\")\nts.plot(ts(ppp$exjp,start=c(1974,1),frequency=12),ylab=\"exjp\")\nts.plot(lexjp,ylab=\"log(exjp)\")\n```\n![Rplot15.png](https://qiita-image-store.s3.amazonaws.com/0/116049/066e2682-0387-71a4-0584-4d8f8aac69b7.png)\n\n### (2)\n```{r}\nlibrary(tseries)\nadf.test(lcpijp)\nadf.test(lcpijp, alternative = \"explosive\")\nadf.test(lcpius)\nadf.test(lcpius, alternative = \"explosive\")\nadf.test(lexjp)\nadf.test(lexjp, alternative = \"explosive\")\n```\n\n```\n> adf.test(lcpijp)\n\n\tAugmented Dickey-Fuller Test\n\ndata:  lcpijp\nDickey-Fuller = -4.0654, Lag order = 7, p-value = 0.01\nalternative hypothesis: stationary\n\nWarning message:\nIn adf.test(lcpijp) : p-value smaller than printed p-value\n> adf.test(lcpijp, alternative = \"explosive\")\n\n\tAugmented Dickey-Fuller Test\n\ndata:  lcpijp\nDickey-Fuller = -4.0654, Lag order = 7, p-value = 0.99\nalternative hypothesis: explosive\n\nWarning message:\nIn adf.test(lcpijp, alternative = \"explosive\") :\n  p-value smaller than printed p-value\n> adf.test(lcpius)\n\n\tAugmented Dickey-Fuller Test\n\ndata:  lcpius\nDickey-Fuller = -2.4815, Lag order = 7, p-value =\n0.3739\nalternative hypothesis: stationary\n\n> adf.test(lcpius, alternative = \"explosive\")\n\n\tAugmented Dickey-Fuller Test\n\ndata:  lcpius\nDickey-Fuller = -2.4815, Lag order = 7, p-value =\n0.6261\nalternative hypothesis: explosive\n\n> adf.test(lexjp)\n\n\tAugmented Dickey-Fuller Test\n\ndata:  lexjp\nDickey-Fuller = -1.6156, Lag order = 7, p-value =\n0.7396\nalternative hypothesis: stationary\n\n> adf.test(lexjp, alternative = \"explosive\")\n\n\tAugmented Dickey-Fuller Test\n\ndata:  lexjp\nDickey-Fuller = -1.6156, Lag order = 7, p-value =\n0.2604\nalternative hypothesis: explosive\n```\n\n\n### (3)\n```r\nlrexjp<-lcpijp-lcpius-lexjp\npar(mar=c(2,4,1,4))\nplot(lrexjp, ylab=\"log(rexjp)\")\n```\n![Rplot16.png](https://qiita-image-store.s3.amazonaws.com/0/116049/7effbfdc-3e57-78b1-58c7-97dce07c8746.png)\n\n### (4)\nPPP\u4eee\u8aac\u306f\n$$\nlcpijp \\approx lexjp + lcpius\n$$\n\u3067\u3042\u308b\u304b\u3089\n$$\nlcpijp - lcpius - lexjp = lrexjp \\approx 0 \n$$\n\u3088\u308alrexjp\u304c0\u306b\u53ce\u675f\u3059\u308b\u3053\u3068\u3092\u793a\u5506\u3057\u3066\u3044\u308b\u3002\n\n### (5)\n```r\nadf.test(lrexjp)\nadf.test(lrexjp, alternative = \"explosive\")\nadf.test(diff(lrexjp))\n```\n\n```r\n> adf.test(lrexjp)\n\n\tAugmented Dickey-Fuller Test\n\ndata:  lrexjp\nDickey-Fuller = -1.3335, Lag order = 7, p-value =\n0.8587\nalternative hypothesis: stationary\n\n> adf.test(lrexjp, alternative = \"explosive\")\n\n\tAugmented Dickey-Fuller Test\n\ndata:  lrexjp\nDickey-Fuller = -1.3335, Lag order = 7, p-value =\n0.1413\nalternative hypothesis: explosive\n\n> adf.test(diff(lrexjp))\n\n\tAugmented Dickey-Fuller Test\n\ndata:  diff(lrexjp)\nDickey-Fuller = -6.7109, Lag order = 7, p-value = 0.01\nalternative hypothesis: stationary\n\nWarning message:\nIn adf.test(diff(lrexjp)) : p-value smaller than printed p-value\n```\n\u3088\u308a\u3001\u5358\u4f4d\u6839\u304c\u3042\u308b\u3002\u3053\u306e\u305f\u3081lrexjp\u306e\u5024\u304c\u53ce\u675f\u3057\u306a\u3044\u306e\u3067\u3001PPP\u4eee\u8aac\u3092\u652f\u6301\u3057\u3066\u3044\u306a\u3044\u3002\n\n### (6)\n```r\nlibrary(urca)\nlrexjp.df<-data.frame(lcpijp, -lcpius, -lexjp)\nlrexjp.vecm<-ca.jo(lrexjp.df, ecdet=\"none\", type=\"eigen\", K=6, spec=\"longrun\", season=NULL)\nsummary(lrexjp.vecm)\n```\n\n```r\n> summary(lrexjp.vecm)\n\n###################### \n# Johansen-Procedure # \n###################### \n\nTest type: maximal eigenvalue statistic (lambda max) , with linear trend \n\nEigenvalues (lambda):\n[1] 0.158408638 0.032735262 0.002925689\n\nValues of teststatistic and critical values of test:\n\n          test 10pct  5pct  1pct\nr <= 2 |  1.14  6.50  8.18 11.65\nr <= 1 | 12.98 12.91 14.90 19.19\nr = 0  | 67.26 18.90 21.07 25.75\n\nEigenvectors, normalised to first column:\n(These are the cointegration relations)\n\n              lcpijp.l6 X.lcpius.l6 X.lexjp.l6\nlcpijp.l6    1.00000000   1.0000000  1.0000000\nX.lcpius.l6  0.02892562   0.2519313  0.7927706\nX.lexjp.l6  -0.07537271  -0.3823289  0.1300192\n\nWeights W:\n(This is the loading matrix)\n\n              lcpijp.l6 X.lcpius.l6    X.lexjp.l6\nlcpijp.d   -0.021872635 0.002756738 -0.0007592322\nX.lcpius.d  0.014398742 0.008619883 -0.0038549536\nX.lexjp.d   0.002801142 0.061199460  0.0184638162\n```\nr = 1\nr+1=2\u500b\u306e\u5171\u548c\u5206\u95a2\u4fc2\u304c\u5b58\u5728\u3059\u308b\u3002\u3088\u3063\u3066PPP\u4eee\u8aac\u3092\u652f\u6301\u3059\u308b\u3002\n\n### (7)\n```r\nlcpica<-ts(log(ppp$cpica),start=c(1974,1),frequency=12)\nlcpiuk<-ts(log(ppp$cpiuk),start=c(1974,1),frequency=12)\nlexca<-ts(log(ppp$exca),start=c(1974,1),frequency=12)\nlexuk<-ts(log(ppp$exuk),start=c(1974,1),frequency=12)\n\nlrexca.df<-data.frame(lcpica, -lcpius, -lexca)\nlrexca.vecm<-ca.jo(lrexca.df, ecdet=\"none\", type=\"eigen\", K=6, spec=\"longrun\", season=NULL)\nsummary(lrexca.vecm)\n```\n\n```r\n###################### \n# Johansen-Procedure # \n###################### \n\nTest type: maximal eigenvalue statistic (lambda max) , with linear trend \n\nEigenvalues (lambda):\n[1] 0.104204155 0.016269511 0.002260424\n\nValues of teststatistic and critical values of test:\n\n          test 10pct  5pct  1pct\nr <= 2 |  0.88  6.50  8.18 11.65\nr <= 1 |  6.40 12.91 14.90 19.19\nr = 0  | 42.92 18.90 21.07 25.75\n\nEigenvectors, normalised to first column:\n(These are the cointegration relations)\n\n             lcpica.l6 X.lcpius.l6 X.lexca.l6\nlcpica.l6   1.00000000   1.0000000   1.000000\nX.lcpius.l6 0.97756101   1.2966193   2.087184\nX.lexca.l6  0.04893602   0.6192151  -1.629409\n\nWeights W:\n(This is the loading matrix)\n\n              lcpica.l6  X.lcpius.l6    X.lexca.l6\nlcpica.d   -0.013164472 -0.001479385  0.0003232371\nX.lcpius.d  0.009339536 -0.007286482 -0.0011414028\nX.lexca.d   0.032099791 -0.011930871  0.0031450132\n```\n\n```r\nlrexuk.df<-data.frame(lcpiuk, -lcpius, -lexuk)\nlrexuk.vecm<-ca.jo(lrexuk.df, ecdet=\"none\", type=\"eigen\", K=6, spec=\"longrun\", season=NULL)\nsummary(lrexuk.vecm)\n```\n\n```r\n###################### \n# Johansen-Procedure # \n###################### \n\nTest type: maximal eigenvalue statistic (lambda max) , with linear trend \n\nEigenvalues (lambda):\n[1] 0.128672334 0.030943227 0.007768275\n\nValues of teststatistic and critical values of test:\n\n          test 10pct  5pct  1pct\nr <= 2 |  3.04  6.50  8.18 11.65\nr <= 1 | 12.26 12.91 14.90 19.19\nr = 0  | 53.72 18.90 21.07 25.75\n\nEigenvectors, normalised to first column:\n(These are the cointegration relations)\n\n             lcpiuk.l6 X.lcpius.l6 X.lexuk.l6\nlcpiuk.l6    1.0000000   1.0000000   1.000000\nX.lcpius.l6  0.5757486   1.3613908   1.945102\nX.lexuk.l6  -2.0586854   0.9541808  -0.105148\n\nWeights W:\n(This is the loading matrix)\n\n              lcpiuk.l6  X.lcpius.l6   X.lexuk.l6\nlcpiuk.d   -0.005272950 -0.003607554  0.001152957\nX.lcpius.d  0.002705188 -0.006229943 -0.003849241\nX.lexuk.d   0.011352610 -0.017602665  0.026309049\n```\n\nr = 1\nr+1=2\u500b\u306e\u5171\u548c\u5206\u95a2\u4fc2\u304c\u5b58\u5728\u3059\u308b\u3002\u3088\u3063\u3066PPP\u4eee\u8aac\u3092\u652f\u6301\u3059\u308b\u3002\n\n\u6b21\u306f [\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\u7ae0\u672b\u554f\u984c\u3092R\u3067\u89e3\u304f\uff0d\u7b2c7\u7ae0GARCH\u30e2\u30c7\u30eb\uff0d](http://qiita.com/aokikenichi/items/06a4de274e98a33af50a)\n", "tags": ["\u6642\u7cfb\u5217\u89e3\u6790", "R"]}