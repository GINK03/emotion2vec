{"context": "\u4ee5\u524d\u6295\u7a3f\u3057\u305f\u3001AWS\uff08SNS, Cognito\uff09\u3092\u7528\u3044\u3066iOS\u30a2\u30d7\u30ea\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u307e\u3067\u306e\u624b\u9806\uff08\u30b5\u30fc\u30d0\u30fc\u7de8\uff09 \u306e\u30a2\u30d7\u30ea\u5074\u306e\u5b9f\u88c5\u90e8\u5206\u3092\u3053\u3061\u3089\u306b\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\nAWS SDK \u306e\u5c0e\u5165\nPodfile \u3092\u4f5c\u6210\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\nPodfile\nsource 'https://github.com/CocoaPods/Specs.git'\n\npod 'AWSSNS'\npod 'AWSCognito'\n\n\n\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u4ee5\u4e0b\u306e pod \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\npod update\npod install\n\n\u3053\u308c\u3067\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\u4eca\u307e\u3067 SampleApp.xcodeproj \u304b\u3089\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u8d77\u52d5\u3057\u3066\u3044\u305f\u3068\u3059\u308b\u3068\u3001\u3053\u308c\u4ee5\u964d\u306f\u65b0\u305f\u306b\u751f\u6210\u3055\u308c\u305f SampleApp.xcworkspace \u304b\u3089\u8d77\u52d5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306b\u95a2\u3059\u308b\u5b9f\u88c5\n\u4ee5\u964d\u306f AppDelegate.m \u3078\u306e\u5b9f\u88c5\u306e\u307f\u3067\u5b8c\u7d50\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\u53c2\u8003\u306b\u3057\u305f\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u7d39\u4ecb\u3057\u3066\u304a\u304d\u307e\u3059\u3002\nhttps://github.com/awslabs/aws-sdk-ios-samples/tree/master/SNS-MobileAnalytics-Sample\n\u30b5\u30f3\u30d7\u30eb\u3067\u306f SNS \u306e\u307f\u306e\u4f7f\u7528\u3067\u3001Cognito \u306f\u6271\u3063\u3066\u3044\u307e\u305b\u3093\u304c\u3001AWS \u306e Cognito \u306e\u8a2d\u5b9a\u753b\u9762\u3067\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u8f09\u305b\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u30b3\u30d4\u30da\u3059\u308c\u3070OK\u3067\u3059\u3002\uff08\u5f8c\u8ff0\u306e initAWSCognito \u95a2\u6570\u306b\u3042\u305f\u308a\u307e\u3059\u3002\uff09\n\n\u5ba3\u8a00\u3068\u5b9a\u7fa9\n\u4ee5\u4e0b\u306f Prefix Header \u3067\u5ba3\u8a00\u3057\u3066\u3082\u3089\u3063\u3066\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\n\nAppDelegate.m\n#import <AWSSNS/AWSSNS.h>\n#import <AWSCognito/AWSCognito.h>\n\n\n\u4ee5\u4e0b\u306f NSString \u3067\u5b9a\u7fa9\u3057\u3066\u3082\u3089\u3063\u3066\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\n\nAppDelegate.m\n// Identity Pool Id\n#define Cognito_Identity_Pool_Id @\"ap-northeast-1:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"\n\n// Application ARN (Development, Product)\n#define SNS_Platform_Application_Arn @\"arn:aws:sns:ap-northeast-1:xxxxxxxxxxxx:app/APNS_SANDBOX/[Application Name]\"\n//#define SNS_Platform_Application_Arn @\"arn:aws:sns:ap-northeast-1:xxxxxxxxxxxx:app/APNS/[Application Name]\"\n\n// Topic ARN\n#define SNS_Topic_Arn @\"arn:aws:sns:ap-northeast-1:xxxxxxxxxxxx:[Topic name]\"\n\n\n\u30ea\u30fc\u30b8\u30e7\u30f3\u306f\u300c\u6771\u4eac\u300d\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nAppDelegate.m\nAWSRegionType const Cognito_Region_Type = AWSRegionAPNortheast1;\nAWSRegionType const Default_Service_Region_Type = AWSRegionAPNortheast1;\n\n\n\n\u30a2\u30d7\u30ea\u8d77\u52d5\u6642\u306e\u51e6\u7406\n\u5404\u30e6\u30fc\u30b6\u30fc\u304c\u6240\u6709\u3059\u308b\u7aef\u672b\u306e\u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u3092 AWS \u5074\u306b\u767b\u9332\u3059\u308b\u305f\u3081\u306e\u51e6\u7406\u3092\u884c\u3044\u307e\u3059\u3002\n\u6d41\u308c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u547c\u3073\u51fa\u3057\u8a2d\u5b9a\n\uff08\u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\u5f8c\uff09AWS \u3078\u306e\u767b\u9332\u51e6\u7406\n\n\nCognito \u306e\u8a8d\u8a3c\u51e6\u7406\nSNS \u3078\u306e\u767b\u9332\u51e6\u7406\n\n\n\n\u51e6\u7406\u306b\u6210\u529f\u3059\u308b\u3068\u3001AWS \u306e Cognito \u3068 SNS \u306b\u767b\u9332\u51e6\u7406\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u547c\u3073\u51fa\u3057\u8a2d\u5b9a\n\u30a2\u30d7\u30ea\u8d77\u52d5\u6642\u306b\u547c\u3073\u51fa\u3055\u308c\u308b application:didFinishLaunchingWithOptions \u30e1\u30bd\u30c3\u30c9\u5185\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\nAppDelegate.m\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions\n{\n\n    /* \u4e2d\u7565 */\n\n    [self registRemoteNotification:YES];\n\n    return YES;\n}\n\n// \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u6709\u52b9\uff0f\u7121\u52b9\u8a2d\u5b9a\n- (void)registRemoteNotification:(BOOL)isRegist\n{\n    UIUserNotificationType types = UIUserNotificationTypeBadge | UIUserNotificationTypeSound | UIUserNotificationTypeAlert;\n    UIUserNotificationSettings *notificationSettings = [UIUserNotificationSettings settingsForTypes:types categories:nil];\n    if (isRegist) {\n        [[UIApplication sharedApplication] registerUserNotificationSettings:notificationSettings];\n        [[UIApplication sharedApplication] registerForRemoteNotifications];\n    } else {\n        [[UIApplication sharedApplication] unregisterForRemoteNotifications];\n    }\n}\n\n\n\nCognito \u306e\u8a8d\u8a3c\u51e6\u7406\uff0fSNS \u3078\u306e\u767b\u9332\u51e6\u7406\nregisterForRemoteNotifications \u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u5f8c\u3001\u4ee5\u4e0b\u306e\u3069\u3061\u3089\u304b\u306e\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3073\u51fa\u3055\u308c\u307e\u3059\u3002\n\u7279\u306b\u554f\u984c\u306a\u3051\u308c\u3070\u3001Cognito, SNS \u3078\u306e\u767b\u9332\u51e6\u7406\u3092\u884c\u3044\u307e\u3059\u3002\n\nAppDelegate.m\n// APNs\u306b\u30c7\u30d0\u30a4\u30b9\u3092\u767b\u9332\u3067\u304d\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken\n{\n    // \u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\n    NSString *deviceTokenString = [[[deviceToken description] stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@\"<>\"]] stringByReplacingOccurrencesOfString:@\" \" withString:@\"\"];\n\n    [self initAWSCognito];\n\n    [self initAWSSns:deviceTokenString];\n}\n\n// Amazon Cognito credentials provider \u306e\u521d\u671f\u5316\n- (void)initAWSCognito\n{\n    AWSCognitoCredentialsProvider *credentialsProvider = [[AWSCognitoCredentialsProvider alloc] initWithRegionType:Cognito_Region_Type\n                                                                                                    identityPoolId:Cognito_Identity_Pool_Id];\n\n    AWSServiceConfiguration *configuration = [[AWSServiceConfiguration alloc] initWithRegion:Default_Service_Region_Type credentialsProvider:credentialsProvider];\n\n    [AWSServiceManager defaultServiceManager].defaultServiceConfiguration = configuration;\n}\n\n- (void)initAWSSns:(NSString *)deviceTokenString\n{\n    AWSSNS *sns = [AWSSNS defaultSNS];\n    // \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306e\u767b\u9332\n    AWSSNSCreatePlatformEndpointInput *endpointInput = [AWSSNSCreatePlatformEndpointInput new];\n    endpointInput.token = deviceTokenString;\n    endpointInput.platformApplicationArn = SNS_Platform_Application_Arn;\n    endpointInput.customUserData = @\"\u4efb\u610f\u306e\u6587\u5b57\u5217\";\n    [[sns createPlatformEndpoint:endpointInput] continueWithBlock:^id(AWSTask *task) {\n        if (task.error != nil) {\n            NSLog(@\"task.error: %@\", task.error);\n        } else {\n            AWSSNSCreateEndpointResponse *endPointResponse = task.result;\n            // \u30c8\u30d4\u30c3\u30af\u3078\u306e\u767b\u9332\n            AWSSNSSubscribeInput *subscribeInput = [AWSSNSSubscribeInput new];\n            subscribeInput.topicArn = SNS_Topic_Arn;\n            subscribeInput.protocols = @\"application\";\n            subscribeInput.endpoint = endPointResponse.endpointArn;\n            [[sns subscribe:subscribeInput] continueWithBlock:^id(AWSTask *task2) {\n                NSLog(@\"task2.error: %@\", task2.error);\n            }];\n        }\n    }];\n}\n\n// APNs\u306b\u30c7\u30d0\u30a4\u30b9\u3092\u767b\u9332\u3067\u304d\u306a\u304b\u3063\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error\n{\n    NSLog(@\"Failed to register with error: %@\", error);\n}\n\n\n\u4ee5\u4e0a\u304c\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u4e8b\u524d\u51e6\u7406\u3067\u3059\u3002\n\n\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u53d7\u4fe1\u51e6\u7406\nAWS \u306e SNS \u306b\u3066\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u9001\u4fe1\u51e6\u7406\u3092\u884c\u3046\u3068\u3001\u5404\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u304c\u5c4a\u304d\u307e\u3059\u3002\u7aef\u672b\u5074\u3067\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3063\u305f\u3068\u304d\u306b\u30a2\u30d7\u30ea\u5074\u3067\u547c\u3073\u51fa\u3055\u308c\u308b\u30e1\u30bd\u30c3\u30c9\u304c\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002\n\nAppDelegate.m\n// \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u53d7\u3051\u53d6\u3063\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo\n{\n    if (application.applicationState == UIApplicationStateActive) {\n        NSLog(@\"Foreground\");\n    } else if (application.applicationState == UIApplicationStateInactive) {\n        NSLog(@\"Background\");\n    }\n\n    NSLog(@\"userInfo: %@\", userInfo);\n\n    /* \u5b9f\u884c\u3057\u305f\u3044\u4f55\u304b\u3092\u5b9f\u88c5 */\n\n}\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002iOS\u306f\u30b7\u30f3\u30d7\u30eb\u3067\u3059\u306d\u3002\n\n\u4ee5\u524d\u6295\u7a3f\u3057\u305f\u3001[AWS\uff08SNS, Cognito\uff09\u3092\u7528\u3044\u3066iOS\u30a2\u30d7\u30ea\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3059\u308b\u307e\u3067\u306e\u624b\u9806\uff08\u30b5\u30fc\u30d0\u30fc\u7de8\uff09](http://qiita.com/MJeeeey/items/c11cbebd542f06e68719) \u306e\u30a2\u30d7\u30ea\u5074\u306e\u5b9f\u88c5\u90e8\u5206\u3092\u3053\u3061\u3089\u306b\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n# AWS SDK \u306e\u5c0e\u5165\n\nPodfile \u3092\u4f5c\u6210\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n~~~:Podfile\nsource 'https://github.com/CocoaPods/Specs.git'\n\npod 'AWSSNS'\npod 'AWSCognito'\n~~~\n\n\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u4ee5\u4e0b\u306e pod \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n~~~\npod update\npod install\n~~~\n\n\u3053\u308c\u3067\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u307e\u3059\u3002\n\u4eca\u307e\u3067 `SampleApp.xcodeproj` \u304b\u3089\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u8d77\u52d5\u3057\u3066\u3044\u305f\u3068\u3059\u308b\u3068\u3001\u3053\u308c\u4ee5\u964d\u306f\u65b0\u305f\u306b\u751f\u6210\u3055\u308c\u305f `SampleApp.xcworkspace` \u304b\u3089\u8d77\u52d5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n# \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306b\u95a2\u3059\u308b\u5b9f\u88c5\n\n\u4ee5\u964d\u306f AppDelegate.m \u3078\u306e\u5b9f\u88c5\u306e\u307f\u3067\u5b8c\u7d50\u3055\u305b\u3066\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u306b\u3057\u305f\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u7d39\u4ecb\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n[https://github.com/awslabs/aws-sdk-ios-samples/tree/master/SNS-MobileAnalytics-Sample](https://github.com/awslabs/aws-sdk-ios-samples/tree/master/SNS-MobileAnalytics-Sample)\n\n\u30b5\u30f3\u30d7\u30eb\u3067\u306f SNS \u306e\u307f\u306e\u4f7f\u7528\u3067\u3001Cognito \u306f\u6271\u3063\u3066\u3044\u307e\u305b\u3093\u304c\u3001AWS \u306e Cognito \u306e\u8a2d\u5b9a\u753b\u9762\u3067\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u8f09\u305b\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u30b3\u30d4\u30da\u3059\u308c\u3070OK\u3067\u3059\u3002\uff08\u5f8c\u8ff0\u306e initAWSCognito \u95a2\u6570\u306b\u3042\u305f\u308a\u307e\u3059\u3002\uff09\n\n\n## \u5ba3\u8a00\u3068\u5b9a\u7fa9\n\n\u4ee5\u4e0b\u306f Prefix Header \u3067\u5ba3\u8a00\u3057\u3066\u3082\u3089\u3063\u3066\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\n\n~~~objectivec:AppDelegate.m\n#import <AWSSNS/AWSSNS.h>\n#import <AWSCognito/AWSCognito.h>\n~~~\n\n\u4ee5\u4e0b\u306f NSString \u3067\u5b9a\u7fa9\u3057\u3066\u3082\u3089\u3063\u3066\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\n\n~~~objectivec:AppDelegate.m\n// Identity Pool Id\n#define Cognito_Identity_Pool_Id @\"ap-northeast-1:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\"\n\n// Application ARN (Development, Product)\n#define SNS_Platform_Application_Arn @\"arn:aws:sns:ap-northeast-1:xxxxxxxxxxxx:app/APNS_SANDBOX/[Application Name]\"\n//#define SNS_Platform_Application_Arn @\"arn:aws:sns:ap-northeast-1:xxxxxxxxxxxx:app/APNS/[Application Name]\"\n\n// Topic ARN\n#define SNS_Topic_Arn @\"arn:aws:sns:ap-northeast-1:xxxxxxxxxxxx:[Topic name]\"\n~~~\n\n\u30ea\u30fc\u30b8\u30e7\u30f3\u306f\u300c\u6771\u4eac\u300d\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n~~~objectivec:AppDelegate.m\nAWSRegionType const Cognito_Region_Type = AWSRegionAPNortheast1;\nAWSRegionType const Default_Service_Region_Type = AWSRegionAPNortheast1;\n~~~\n\n## \u30a2\u30d7\u30ea\u8d77\u52d5\u6642\u306e\u51e6\u7406\n\n\u5404\u30e6\u30fc\u30b6\u30fc\u304c\u6240\u6709\u3059\u308b\u7aef\u672b\u306e\u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u3092 AWS \u5074\u306b\u767b\u9332\u3059\u308b\u305f\u3081\u306e\u51e6\u7406\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u6d41\u308c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n1. \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u547c\u3073\u51fa\u3057\u8a2d\u5b9a\n1. \uff08\u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\u5f8c\uff09AWS \u3078\u306e\u767b\u9332\u51e6\u7406\n 1. Cognito \u306e\u8a8d\u8a3c\u51e6\u7406\n 1. SNS \u3078\u306e\u767b\u9332\u51e6\u7406\n\n\u51e6\u7406\u306b\u6210\u529f\u3059\u308b\u3068\u3001AWS \u306e Cognito \u3068 SNS \u306b\u767b\u9332\u51e6\u7406\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n### \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u547c\u3073\u51fa\u3057\u8a2d\u5b9a\n\n\u30a2\u30d7\u30ea\u8d77\u52d5\u6642\u306b\u547c\u3073\u51fa\u3055\u308c\u308b application:didFinishLaunchingWithOptions \u30e1\u30bd\u30c3\u30c9\u5185\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n~~~objectivec:AppDelegate.m\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions\n{\n\n\t/* \u4e2d\u7565 */\n\n\t[self registRemoteNotification:YES];\n\n\treturn YES;\n}\n\n// \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u6709\u52b9\uff0f\u7121\u52b9\u8a2d\u5b9a\n- (void)registRemoteNotification:(BOOL)isRegist\n{\n\tUIUserNotificationType types = UIUserNotificationTypeBadge | UIUserNotificationTypeSound | UIUserNotificationTypeAlert;\n\tUIUserNotificationSettings *notificationSettings = [UIUserNotificationSettings settingsForTypes:types categories:nil];\n\tif (isRegist) {\n\t\t[[UIApplication sharedApplication] registerUserNotificationSettings:notificationSettings];\n\t\t[[UIApplication sharedApplication] registerForRemoteNotifications];\n\t} else {\n\t\t[[UIApplication sharedApplication] unregisterForRemoteNotifications];\n\t}\n}\n~~~\n\n### Cognito \u306e\u8a8d\u8a3c\u51e6\u7406\uff0fSNS \u3078\u306e\u767b\u9332\u51e6\u7406\n\nregisterForRemoteNotifications \u30e1\u30bd\u30c3\u30c9\u306e\u547c\u3073\u51fa\u3057\u5f8c\u3001\u4ee5\u4e0b\u306e\u3069\u3061\u3089\u304b\u306e\u30e1\u30bd\u30c3\u30c9\u304c\u547c\u3073\u51fa\u3055\u308c\u307e\u3059\u3002\n\u7279\u306b\u554f\u984c\u306a\u3051\u308c\u3070\u3001Cognito, SNS \u3078\u306e\u767b\u9332\u51e6\u7406\u3092\u884c\u3044\u307e\u3059\u3002\n\n~~~objectivec:AppDelegate.m\n// APNs\u306b\u30c7\u30d0\u30a4\u30b9\u3092\u767b\u9332\u3067\u304d\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken\n{\n\t// \u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\n\tNSString *deviceTokenString = [[[deviceToken description] stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@\"<>\"]] stringByReplacingOccurrencesOfString:@\" \" withString:@\"\"];\n\n\t[self initAWSCognito];\n\n\t[self initAWSSns:deviceTokenString];\n}\n\n// Amazon Cognito credentials provider \u306e\u521d\u671f\u5316\n- (void)initAWSCognito\n{\n\tAWSCognitoCredentialsProvider *credentialsProvider = [[AWSCognitoCredentialsProvider alloc] initWithRegionType:Cognito_Region_Type\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tidentityPoolId:Cognito_Identity_Pool_Id];\n\t\n\tAWSServiceConfiguration *configuration = [[AWSServiceConfiguration alloc] initWithRegion:Default_Service_Region_Type credentialsProvider:credentialsProvider];\n\t\n\t[AWSServiceManager defaultServiceManager].defaultServiceConfiguration = configuration;\n}\n\n- (void)initAWSSns:(NSString *)deviceTokenString\n{\n\tAWSSNS *sns = [AWSSNS defaultSNS];\n\t// \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306e\u767b\u9332\n\tAWSSNSCreatePlatformEndpointInput *endpointInput = [AWSSNSCreatePlatformEndpointInput new];\n\tendpointInput.token = deviceTokenString;\n\tendpointInput.platformApplicationArn = SNS_Platform_Application_Arn;\n\tendpointInput.customUserData = @\"\u4efb\u610f\u306e\u6587\u5b57\u5217\";\n\t[[sns createPlatformEndpoint:endpointInput] continueWithBlock:^id(AWSTask *task) {\n\t\tif (task.error != nil) {\n\t\t\tNSLog(@\"task.error: %@\", task.error);\n\t\t} else {\n\t\t\tAWSSNSCreateEndpointResponse *endPointResponse = task.result;\n\t\t\t// \u30c8\u30d4\u30c3\u30af\u3078\u306e\u767b\u9332\n\t\t\tAWSSNSSubscribeInput *subscribeInput = [AWSSNSSubscribeInput new];\n\t\t\tsubscribeInput.topicArn = SNS_Topic_Arn;\n\t\t\tsubscribeInput.protocols = @\"application\";\n\t\t\tsubscribeInput.endpoint = endPointResponse.endpointArn;\n\t\t\t[[sns subscribe:subscribeInput] continueWithBlock:^id(AWSTask *task2) {\n\t\t\t\tNSLog(@\"task2.error: %@\", task2.error);\n\t\t\t}];\n\t\t}\n\t}];\n}\n\n// APNs\u306b\u30c7\u30d0\u30a4\u30b9\u3092\u767b\u9332\u3067\u304d\u306a\u304b\u3063\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error\n{\n\tNSLog(@\"Failed to register with error: %@\", error);\n}\n~~~\n\n\u4ee5\u4e0a\u304c\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u4e8b\u524d\u51e6\u7406\u3067\u3059\u3002\n\n## \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u53d7\u4fe1\u51e6\u7406\n\nAWS \u306e SNS \u306b\u3066\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u306e\u9001\u4fe1\u51e6\u7406\u3092\u884c\u3046\u3068\u3001\u5404\u7aef\u672b\u306b\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u304c\u5c4a\u304d\u307e\u3059\u3002\u7aef\u672b\u5074\u3067\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3063\u305f\u3068\u304d\u306b\u30a2\u30d7\u30ea\u5074\u3067\u547c\u3073\u51fa\u3055\u308c\u308b\u30e1\u30bd\u30c3\u30c9\u304c\u4ee5\u4e0b\u306b\u306a\u308a\u307e\u3059\u3002\n\n~~~objectivec:AppDelegate.m\n// \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u53d7\u3051\u53d6\u3063\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo\n{\n\tif (application.applicationState == UIApplicationStateActive) {\n\t\tNSLog(@\"Foreground\");\n\t} else if (application.applicationState == UIApplicationStateInactive) {\n\t\tNSLog(@\"Background\");\n\t}\n\n\tNSLog(@\"userInfo: %@\", userInfo);\n\n\t/* \u5b9f\u884c\u3057\u305f\u3044\u4f55\u304b\u3092\u5b9f\u88c5 */\n\n}\n~~~\n\n\u4ee5\u4e0a\u3067\u3059\u3002iOS\u306f\u30b7\u30f3\u30d7\u30eb\u3067\u3059\u306d\u3002\n", "tags": ["AWS", "SNS", "cognito", "iOS", "Objective-C"]}