{"context": " More than 1 year has passed since last update.<?php\n/**\n * SimpleXML\u306easXML()\u3092\u304d\u308c\u3044\u306b\u30a4\u30f3\u30c7\u30f3\u30c8\u3059\u308b\u95a2\u6570\n * @package    Sites\n * @author     Suin <suinyeze@gmail.com>\n * @copyright  2011 Suin\n * @license    MIT License\n */\n$xml = '<?xml version=\"1.0\"?><root><foo>FOO</foo><bar /><baz><hoge>HOGE</hoge><fuga /><!-- Comment --><piyo><![CDATA[CDATA desuyo!]]></piyo></baz><!-- Comment --></root>';\n\necho cleanUpXML($xml);\n\nfunction cleanUpXML($string)\n{\n    $string = preg_replace(\"/>\\s*</\", \">\\n<\", $string);\n    $lines  = explode(\"\\n\", $string);\n    $string = '';\n    $indent = 0;\n\n    foreach ( $lines as $line )\n    {\n        $increment = false;\n        $decrement = false;\n\n        if ( preg_match('#<\\?xml.+\\?>#', $line) == true )\n        {\n            // <?xml \u2026 \n        }\n        elseif ( preg_match('#<[^/].+>.*</.+>#', $line) == true )\n        {\n            // Open Tag & Close Tag\n        }\n        elseif ( preg_match('#<.+/>#', $line) == true )\n        {\n            // Self-closing Tag\n        }\n        elseif ( preg_match('#<!.*>#', $line) == true )\n        {\n            // Comments and CDATA\n        }\n        elseif ( preg_match('#<[^/].+>#', $line) == true )\n        {\n            // Open Tag\n            $increment = true;\n        }\n        elseif ( preg_match('#</.+>#', $line) == true )\n        {\n            // Close Tag\n            $decrement = true;\n        }\n        else\n        {\n            // Others\n        }\n\n        if ( $decrement === true )\n        {\n            $indent -= 1;\n        }\n\n        $string .= str_repeat(\"\\t\", $indent).$line.\"\\n\";\n\n        if ( $increment === true )\n        {\n            $indent += 1;\n        }\n    }\n\n    return $string;\n}\n\n\u5b9f\u884c\u7d50\u679c\n\n\u7d50\u679c\n<?xml version=\"1.0\"?>\n<root>\n    <foo>FOO</foo>\n    <bar />\n    <baz>\n        <hoge>HOGE</hoge>\n        <fuga />\n        <!-- Comment -->\n        <piyo>\n            <![CDATA[CDATA desuyo!]]>\n        </piyo>\n    </baz>\n    <!-- Comment -->\n</root>\n\n\n```php\n<?php\n/**\n * SimpleXML\u306easXML()\u3092\u304d\u308c\u3044\u306b\u30a4\u30f3\u30c7\u30f3\u30c8\u3059\u308b\u95a2\u6570\n * @package    Sites\n * @author     Suin <suinyeze@gmail.com>\n * @copyright  2011 Suin\n * @license    MIT License\n */\n$xml = '<?xml version=\"1.0\"?><root><foo>FOO</foo><bar /><baz><hoge>HOGE</hoge><fuga /><!-- Comment --><piyo><![CDATA[CDATA desuyo!]]></piyo></baz><!-- Comment --></root>';\n\necho cleanUpXML($xml);\n\nfunction cleanUpXML($string)\n{\n\t$string = preg_replace(\"/>\\s*</\", \">\\n<\", $string);\n\t$lines  = explode(\"\\n\", $string);\n\t$string = '';\n\t$indent = 0;\n\n\tforeach ( $lines as $line )\n\t{\n\t\t$increment = false;\n\t\t$decrement = false;\n\n\t\tif ( preg_match('#<\\?xml.+\\?>#', $line) == true )\n\t\t{\n\t\t\t// <?xml \u2026 \n\t\t}\n\t\telseif ( preg_match('#<[^/].+>.*</.+>#', $line) == true )\n\t\t{\n\t\t\t// Open Tag & Close Tag\n\t\t}\n\t\telseif ( preg_match('#<.+/>#', $line) == true )\n\t\t{\n\t\t\t// Self-closing Tag\n\t\t}\n\t\telseif ( preg_match('#<!.*>#', $line) == true )\n\t\t{\n\t\t\t// Comments and CDATA\n\t\t}\n\t\telseif ( preg_match('#<[^/].+>#', $line) == true )\n\t\t{\n\t\t\t// Open Tag\n\t\t\t$increment = true;\n\t\t}\n\t\telseif ( preg_match('#</.+>#', $line) == true )\n\t\t{\n\t\t\t// Close Tag\n\t\t\t$decrement = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// Others\n\t\t}\n\n\t\tif ( $decrement === true )\n\t\t{\n\t\t\t$indent -= 1;\n\t\t}\n\n\t\t$string .= str_repeat(\"\\t\", $indent).$line.\"\\n\";\n\n\t\tif ( $increment === true )\n\t\t{\n\t\t\t$indent += 1;\n\t\t}\n\t}\n\n\treturn $string;\n}\n```\n\n\u5b9f\u884c\u7d50\u679c\n\n```xml:\u7d50\u679c\n<?xml version=\"1.0\"?>\n<root>\n\t<foo>FOO</foo>\n\t<bar />\n\t<baz>\n\t\t<hoge>HOGE</hoge>\n\t\t<fuga />\n\t\t<!-- Comment -->\n\t\t<piyo>\n\t\t\t<![CDATA[CDATA desuyo!]]>\n\t\t</piyo>\n\t</baz>\n\t<!-- Comment -->\n</root>\n```\n", "tags": ["PHP", "XML"]}