{"context": " More than 1 year has passed since last update.\n\nhttp\u3067\u63a5\u7d9a\u3055\u308c\u305f\u5834\u5408\u306bhttps\u3067redirect\u3059\u308b\n\nserver.js\nvar express = require('express');\nvar app = express();\n\napp.use(express.static(__dirname + '/public'));\n\nfunction forceHttps(req, res, next){\n  if (!process.env.PORT) {\n    return next();\n  };\n\n  if (req.headers['x-forwarded-proto'] && req.headers['x-forwarded-proto'] === \"http\") {\n    res.redirect('https://' + req.headers.host + req.url);\n  }else {\n    return next();\n  }\n};\n\napp.all('*', forceHttps);\n\napp.get('/', function(req, res) {\n  res.sendFile(__dirname + '/public/index1.html');\n});\n\napp.set('port', (process.env.PORT || 5000));\n\napp.listen(app.get('port'), function() {\n  console.log(\"Node app is running at localhost:\" + app.get('port'))\n})\n\n\n\n\nhttp\u63a5\u7d9a\u306e\u5224\u5b9a\nHeroku\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u306freq.secure\u3092\u4f7f\u3063\u3066\u306e\u5224\u5b9a\u304c\u3067\u304d\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\u306a\u306e\u3067req.headers['x-forwarded-proto'] === \"http\"\u3067\u5224\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u306fredirect\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n  if (!process.env.PORT) {\n    return next();\n  };\n\n\nindex.html\u3092\u7f6e\u304f\u3068\u5224\u5b9a\u3092\u901a\u3089\u306a\u3044\u30fb\u30fb\u30fb\nindex.html\u3092\u7f6e\u304f\u3068http\u30a2\u30af\u30bb\u30b9\u306e\u5224\u5b9a\u3092\u901a\u3089\u305a\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u843d\u3068\u3057\u3066\u304d\u3066\u3057\u307e\u3046\u305f\u3081\u30d5\u30a1\u30a4\u30eb\u540d\u3092index1.html\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n#http\u3067\u63a5\u7d9a\u3055\u308c\u305f\u5834\u5408\u306bhttps\u3067redirect\u3059\u308b\n\n```js:server.js\nvar express = require('express');\nvar app = express();\n\napp.use(express.static(__dirname + '/public'));\n\nfunction forceHttps(req, res, next){\n  if (!process.env.PORT) {\n    return next();\n  };\n\n  if (req.headers['x-forwarded-proto'] && req.headers['x-forwarded-proto'] === \"http\") {\n    res.redirect('https://' + req.headers.host + req.url);\n  }else {\n    return next();\n  }\n};\n\napp.all('*', forceHttps);\n\napp.get('/', function(req, res) {\n  res.sendFile(__dirname + '/public/index1.html');\n});\n\napp.set('port', (process.env.PORT || 5000));\n\napp.listen(app.get('port'), function() {\n  console.log(\"Node app is running at localhost:\" + app.get('port'))\n})\n\n```\n\n##http\u63a5\u7d9a\u306e\u5224\u5b9a\nHeroku\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u306freq.secure\u3092\u4f7f\u3063\u3066\u306e\u5224\u5b9a\u304c\u3067\u304d\u306a\u3044\u3088\u3046\u3067\u3059\u3002\n\u306a\u306e\u3067`req.headers['x-forwarded-proto'] === \"http\"`\u3067\u5224\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n##\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u306fredirect\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n```\n  if (!process.env.PORT) {\n    return next();\n  };\n```\n\n##index.html\u3092\u7f6e\u304f\u3068\u5224\u5b9a\u3092\u901a\u3089\u306a\u3044\u30fb\u30fb\u30fb\nindex.html\u3092\u7f6e\u304f\u3068http\u30a2\u30af\u30bb\u30b9\u306e\u5224\u5b9a\u3092\u901a\u3089\u305a\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u843d\u3068\u3057\u3066\u304d\u3066\u3057\u307e\u3046\u305f\u3081\u30d5\u30a1\u30a4\u30eb\u540d\u3092index1.html\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n", "tags": ["Heroku", "Node.js", "SSL"]}