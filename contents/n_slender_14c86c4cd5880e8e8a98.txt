{"context": " More than 1 year has passed since last update.\n\n\u304d\u3063\u304b\u3051\nSpring + Tomcat\u3067\u306e\u958b\u767a\u306e\u3068\u304d\u306b\u3001DB\u306e\u63a5\u7d9a\u30a8\u30e9\u30fc\u3067\u306f\u307e\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u3068\u304d\u306e\u8a2d\u5b9a\u30e1\u30e2\u3002\njava6\u7e1b\u308a\u3067tomcat\u3082\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u8a2d\u5b9a\u3067\u3059\u306e\u3067\u3001\u6c17\u3092\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\u3002\n\u30dd\u30a4\u30f3\u30c8\u306fvalidationQuery\u3067\u3059\u3002\n\n\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u306e\u6709\u52b9\u6027\u30c6\u30b9\u30c8\n\u4e00\u5b9a\u6642\u9593\u305f\u3064\u3068DB\u306b\u63a5\u7d9a\u3067\u304d\u306a\u304f\u306a\u3063\u305f\u3068\u304d\u306f\u3001\u30d7\u30fc\u30eb\u3057\u3066\u3044\u308b\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u3064\u304b\u3048\u306a\u304f\u306a\u3063\u3066\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u3067\u3059\u3002\n\u3053\u3061\u3089 \u3067\u540c\u3058\u554f\u984c\u306e\u89e3\u6c7a\u7b56\u306b\u3067\u3066\u3044\u307e\u3057\u305f\u3002\nvalidationQuery\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3067\u89e3\u6d88\u3055\u308c\u307e\u3059\u3002Spring\u5074\u3067datasource\u3092\u5b9a\u7fa9\u3059\u308b\u306a\u3089\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n(RDBMS\u304cMySQL\u306e\u60f3\u5b9a\u3067\u3059\u304c\u3001OracleDB\u3067\u3082\u540c\u69d8\u3067\u3059\u3002)\n\napplicationContext.xml\n\napplicationContext.xml\n\n<bean id=\"dataSource\"\n          class=\"org.apache.tomcat.jdbc.pool.DataSource\">\n        <property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\"/>\n        <property name=\"url\" value=\"jdbc:mysql://localhost:3306/sample\"/>\n        <property name=\"username\" value=\"root\" />\n        <property name=\"password\" value=\"root\" />\n        <property name=\"validationQuery\" value=\"SELECT 1 FROM DUAL\" />\n        <property name=\"testOnBorrow\" value=\"true\" />\n        <property name=\"testWhileIdle\" value=\"true\" />\n        <property name=\"timeBetweenEvictionRunsMillis\" value=\"60000\" />\n    </bean>\n\n\n\nserver.xml\nTomcat\u5074\u3067\u63a5\u7d9a\u3059\u308bDB\u3092\u6307\u5b9a\u3044\u308b\u5834\u5408\u306f\u3001server.xml\u306b\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nhttps://tomcat.apache.org/tomcat-6.0-doc/jndi-resources-howto.html\nhttp://ymotoba.blogspot.jp/2008/09/tomcat.html\n\nserver.xml\n<Resource name=\"jdbc/sample\"\n      global=\"jdbc/sample\"\n      auth=\"Container\"\n      type=\"javax.sql.DataSource\"\n      driverClassName=\"com.mysql.jdbc.Driver\"\n      url=\"jdbc:mysql://localhost:3306/sample\"\n      username=\"root\"\n      password=\"root\"       \n      maxActive=\"100\"\n      maxIdle=\"20\"\n      minIdle=\"5\"\n      maxWait=\"10000\"\n      validationQuery=\"SELECT 1 FROM DUAL\"\n      testOnBorrow=\"true\"\n\u3000\u3000\u3000 testWhileIdle=\"true\"\n      timeBetweenEvictionRunsMillis=\"60000\"\u3000\u3000\u3000\n />\n\n\napplicationContext.xml\u306b\u306fJNDI\u306e\u8a2d\u5b9a\u306b\u66f8\u304d\u76f4\u3057\u307e\u3059\u3002\n\napplicationContext.xml\n\n <bean id=\"dataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\">\n        <property name=\"jndiName\" value=\"java:comp/env/jdbc/sample\"/>\n </bean>\n\n\n\n\u53c2\u8003\u30b5\u30a4\u30c8\nhttp://yyhayashi303.hatenablog.com/entry/20120911/1347322683\nhttp://stackoverflow.com/questions/22684807/spring-boot-jpa-configuring-auto-reconnect\nhttp://qiita.com/T0000N/items/7d3450623da5bc27e116\nhttp://d.hatena.ne.jp/learn/20101016/p1\n# \u304d\u3063\u304b\u3051\n\nSpring + Tomcat\u3067\u306e\u958b\u767a\u306e\u3068\u304d\u306b\u3001DB\u306e\u63a5\u7d9a\u30a8\u30e9\u30fc\u3067\u306f\u307e\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u3068\u304d\u306e\u8a2d\u5b9a\u30e1\u30e2\u3002\njava6\u7e1b\u308a\u3067tomcat\u3082\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u8a2d\u5b9a\u3067\u3059\u306e\u3067\u3001\u6c17\u3092\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30dd\u30a4\u30f3\u30c8\u306fvalidationQuery\u3067\u3059\u3002\n\n# \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u306e\u6709\u52b9\u6027\u30c6\u30b9\u30c8\n\n\u4e00\u5b9a\u6642\u9593\u305f\u3064\u3068DB\u306b\u63a5\u7d9a\u3067\u304d\u306a\u304f\u306a\u3063\u305f\u3068\u304d\u306f\u3001\u30d7\u30fc\u30eb\u3057\u3066\u3044\u308b\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u3064\u304b\u3048\u306a\u304f\u306a\u3063\u3066\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u3067\u3059\u3002\n[\u3053\u3061\u3089](http://yyhayashi303.hatenablog.com/entry/20120911/1347322683) \u3067\u540c\u3058\u554f\u984c\u306e\u89e3\u6c7a\u7b56\u306b\u3067\u3066\u3044\u307e\u3057\u305f\u3002\n\nvalidationQuery\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3067\u89e3\u6d88\u3055\u308c\u307e\u3059\u3002Spring\u5074\u3067datasource\u3092\u5b9a\u7fa9\u3059\u308b\u306a\u3089\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n(RDBMS\u304cMySQL\u306e\u60f3\u5b9a\u3067\u3059\u304c\u3001OracleDB\u3067\u3082\u540c\u69d8\u3067\u3059\u3002)\n\n## applicationContext.xml\n\n```lang:applicationContext.xml\n\n<bean id=\"dataSource\"\n          class=\"org.apache.tomcat.jdbc.pool.DataSource\">\n        <property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\"/>\n        <property name=\"url\" value=\"jdbc:mysql://localhost:3306/sample\"/>\n        <property name=\"username\" value=\"root\" />\n        <property name=\"password\" value=\"root\" />\n        <property name=\"validationQuery\" value=\"SELECT 1 FROM DUAL\" />\n\t\t<property name=\"testOnBorrow\" value=\"true\" />\n\t\t<property name=\"testWhileIdle\" value=\"true\" />\n\t\t<property name=\"timeBetweenEvictionRunsMillis\" value=\"60000\" />\n    </bean>\n```\n\n## server.xml\n\nTomcat\u5074\u3067\u63a5\u7d9a\u3059\u308bDB\u3092\u6307\u5b9a\u3044\u308b\u5834\u5408\u306f\u3001server.xml\u306b\u4e0a\u8a18\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nhttps://tomcat.apache.org/tomcat-6.0-doc/jndi-resources-howto.html\nhttp://ymotoba.blogspot.jp/2008/09/tomcat.html\n\n```lang:server.xml\n<Resource name=\"jdbc/sample\"\n      global=\"jdbc/sample\"\n      auth=\"Container\"\n      type=\"javax.sql.DataSource\"\n      driverClassName=\"com.mysql.jdbc.Driver\"\n      url=\"jdbc:mysql://localhost:3306/sample\"\n      username=\"root\"\n      password=\"root\"       \n      maxActive=\"100\"\n      maxIdle=\"20\"\n      minIdle=\"5\"\n      maxWait=\"10000\"\n      validationQuery=\"SELECT 1 FROM DUAL\"\n      testOnBorrow=\"true\"\n\u3000\u3000\u3000 testWhileIdle=\"true\"\n      timeBetweenEvictionRunsMillis=\"60000\"\u3000\u3000\u3000\n />\n```\n\napplicationContext.xml\u306b\u306fJNDI\u306e\u8a2d\u5b9a\u306b\u66f8\u304d\u76f4\u3057\u307e\u3059\u3002\n\n```lang:applicationContext.xml\n\n <bean id=\"dataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\">\n        <property name=\"jndiName\" value=\"java:comp/env/jdbc/sample\"/>\n </bean>\n```\n\n# \u53c2\u8003\u30b5\u30a4\u30c8\n\nhttp://yyhayashi303.hatenablog.com/entry/20120911/1347322683\n\nhttp://stackoverflow.com/questions/22684807/spring-boot-jpa-configuring-auto-reconnect\n\nhttp://qiita.com/T0000N/items/7d3450623da5bc27e116\n\nhttp://d.hatena.ne.jp/learn/20101016/p1\n", "tags": ["spring", "Tomcat", "Database", "Java"]}