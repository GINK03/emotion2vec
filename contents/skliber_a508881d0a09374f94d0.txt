{"context": "\n\nDB\u6697\u53f7\u5316\u306e\u7a2e\u985e\n\n\u30ab\u30e9\u30e0\u6697\u53f7\u5316\n\u30ab\u30e9\u30e0\u3054\u3068\u306b\u6697\u53f7\u5316\nEbean\u3067\u306f\u3053\u3061\u3089\u3057\u304b\u3067\u304d\u306a\u3044\u69d8\u5b50\n\u30c6\u30fc\u30d6\u30eb\u6697\u53f7\u5316\n\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306b\u6697\u53f7\u5316\n\u3053\u306e\u6a5f\u80fd\u306fmariadb\u306b\u6a19\u6e96\u3067\u4ed8\u3044\u3066\u3044\u308b\u304c\u3001\u6050\u3089\u304fPlay\u3084Ebean\u304b\u3089\u306f\u64cd\u4f5c\u3067\u304d\u306a\u3044\nDB\u306e\u3042\u308bHDD\u305d\u306e\u3082\u306e\u3092\u6697\u53f7\u5316\n\uff01\uff1f\n\n\n\u5168\u30b3\u30fc\u30c9\nhttps://github.com/skliber/encryptdb\n\n\u4e8b\u524d\u306e\u8a2d\u5b9a\n\nconf/application.conf\n\u4e00\u90e8\u629c\u7c8b\n\napplication.conf\ndb {\n  # You can declare as many datasources as you want.\n  # By convention, the default datasource is named `default`\n\n  # https://www.playframework.com/documentation/latest/Developing-with-the-H2-Database\n  default.driver = org.mariadb.jdbc.Driver\n  default.url = \"jdbc:mariadb://localhost:3306/playdb\"\n  default.username = play\n  default.password = \"play\"\n\n  # You can turn on SQL logging for any datasource\n  # https://www.playframework.com/documentation/latest/Highlights25#Logging-SQL-statements\n  #default.logSql=true\n}\n\nebean {\n  default = [\"models.entity.*\"]\n}\n\n\n\nbuild.sbt\n\nbuild.sbt\nname := \"\"\"encryptdb\"\"\"\n\nversion := \"1.0-SNAPSHOT\"\n\nlazy val root = (project in file(\".\")).enablePlugins(PlayJava, PlayEbean)\n\nscalaVersion := \"2.11.7\"\n\nlibraryDependencies ++= Seq(\n  javaJdbc,\n  cache,\n  javaWs,\n  \"org.mariadb.jdbc\" % \"mariadb-java-client\" % \"1.4.4\"\n)\n\n\n\nproject/plugins.sbt\n\u4ee5\u4e0b\u3092\u8ffd\u8a18\n\naddSbtPlugin(\"com.typesafe.sbt\" % \"sbt-play-ebean\" % \"3.0.0\")\n\n\nconf/ebean.properties\n\u65b0\u898f\u4f5c\u6210\u3057\u3066\u4ee5\u4e0b\u3092\u66f8\u304d\u3001\u5f8c\u8ff0\u306eBasicEncryptKeyManager\u306e\u5834\u6240\u3092\u6307\u5b9a\u3059\u308b\nencryptKeyManager = models.security.BasicEncryptKeyManager\n\nencryptKeyManager = \"models.security.BasicEncryptKeyManager\"\n\u3068\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c8\u3067\u56f2\u3046\u3068\u52d5\u304b\u306a\u3044\u306e\u3067\u6ce8\u610f\n\n\u6697\u53f7\u5316\u306e\u6e96\u5099\n\nmodels.entity\n@Encrypted\u3092\u3064\u3051\u305f\u30ab\u30e9\u30e0\u304c\u6697\u53f7\u5316\u3055\u308c\u308b\n\nUser.java\npackage models.entity;\n\nimport com.avaje.ebean.annotation.Encrypted;\n\nimport javax.persistence.Entity;\n\n/**\n * \u30e6\u30fc\u30b6\u30fc\u60c5\u5831\n *\n * @author\n *\n */\n@Entity\npublic class User extends BaseEntity {\n\n    /* \u30e6\u30fc\u30b6\u30fc\u540d */\n    @Encrypted\n    public String name;\n\n    /* \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9 */\n    @Encrypted\n    public String mail;\n\n    /* \u30d1\u30b9\u30ef\u30fc\u30c9 */\n    @Encrypted\n    public String password;\n\n    public static Finder<Long, User> finder = new Finder<Long, User>(User.class);\n\n}\n\n\n\nmodels.security\n\nBasicEncryptKeyManager\n\nBasicEncryptKeyManager\npackage models.security;\n\n\nimport com.avaje.ebean.config.EncryptKey;\nimport com.avaje.ebean.config.EncryptKeyManager;\n\npublic class BasicEncryptKeyManager implements EncryptKeyManager {\n\n    @Override\n    public EncryptKey getEncryptKey(String tableName, String columnName) {\n        return new CustomEncryptKey(tableName, columnName);\n    }\n\n    @Override\n    public void initialise() {\n        // Do nothing (yet)\n    }\n\n}\n\n\n\nCustomEncryptKey\n\nCustomEncryptKey\npackage models.security;\n\nimport com.avaje.ebean.config.EncryptKey;\n\npublic class CustomEncryptKey implements EncryptKey {\n\n    private String tableName;\n\n    private String columnName;\n\n    public CustomEncryptKey(String tableName, String columnName) {\n        this.tableName = tableName;\n        this.columnName = columnName;\n    }\n\n    @Override\n    public String getStringValue() {\n        return play.Configuration.root().getString(\"application.secret\") + \"::\" + this.tableName\n                + \"::\" + this.columnName;\n    }\n}\n\n\n\n\u78ba\u8a8d\n\u4e0a\u8a18\u307e\u3067\u3067\u6e96\u5099\u306f\u7d42\u4e86\nmariadb\u306b\u4ed8\u3044\u3066\u304d\u305fHeidiSQL\u3067\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\nHeidiSQL\n\n\u898b\u3048\u306a\u3044\uff01\n\n\u53c2\u8003\nhttps://www.playframework.com/documentation/2.5.x/JavaEbean\nhttps://archive-avaje-org.github.io/ebean/encryption.html\nhttp://stackoverflow.com/questions/15800453/play-framework-2-1-java-ebean-encrypted-annotation-errors\n# DB\u6697\u53f7\u5316\u306e\u7a2e\u985e\n- \u30ab\u30e9\u30e0\u6697\u53f7\u5316\n\u30ab\u30e9\u30e0\u3054\u3068\u306b\u6697\u53f7\u5316\nEbean\u3067\u306f\u3053\u3061\u3089\u3057\u304b\u3067\u304d\u306a\u3044\u69d8\u5b50\n\n- \u30c6\u30fc\u30d6\u30eb\u6697\u53f7\u5316\n\u30c6\u30fc\u30d6\u30eb\u3054\u3068\u306b\u6697\u53f7\u5316\n\u3053\u306e\u6a5f\u80fd\u306fmariadb\u306b\u6a19\u6e96\u3067\u4ed8\u3044\u3066\u3044\u308b\u304c\u3001\u6050\u3089\u304fPlay\u3084Ebean\u304b\u3089\u306f\u64cd\u4f5c\u3067\u304d\u306a\u3044\n\n- DB\u306e\u3042\u308bHDD\u305d\u306e\u3082\u306e\u3092\u6697\u53f7\u5316\n\uff01\uff1f\n\n# \u5168\u30b3\u30fc\u30c9\nhttps://github.com/skliber/encryptdb\n\n# \u4e8b\u524d\u306e\u8a2d\u5b9a\n## conf/application.conf\n\u4e00\u90e8\u629c\u7c8b\n\n```application.conf\ndb {\n  # You can declare as many datasources as you want.\n  # By convention, the default datasource is named `default`\n\n  # https://www.playframework.com/documentation/latest/Developing-with-the-H2-Database\n  default.driver = org.mariadb.jdbc.Driver\n  default.url = \"jdbc:mariadb://localhost:3306/playdb\"\n  default.username = play\n  default.password = \"play\"\n\n  # You can turn on SQL logging for any datasource\n  # https://www.playframework.com/documentation/latest/Highlights25#Logging-SQL-statements\n  #default.logSql=true\n}\n\nebean {\n  default = [\"models.entity.*\"]\n}\n```\n\n## build.sbt\n```build.sbt\nname := \"\"\"encryptdb\"\"\"\n\nversion := \"1.0-SNAPSHOT\"\n\nlazy val root = (project in file(\".\")).enablePlugins(PlayJava, PlayEbean)\n\nscalaVersion := \"2.11.7\"\n\nlibraryDependencies ++= Seq(\n  javaJdbc,\n  cache,\n  javaWs,\n  \"org.mariadb.jdbc\" % \"mariadb-java-client\" % \"1.4.4\"\n)\n```\n\n## project/plugins.sbt\n\u4ee5\u4e0b\u3092\u8ffd\u8a18\n```\naddSbtPlugin(\"com.typesafe.sbt\" % \"sbt-play-ebean\" % \"3.0.0\")\n```\n## conf/ebean.properties\n\u65b0\u898f\u4f5c\u6210\u3057\u3066\u4ee5\u4e0b\u3092\u66f8\u304d\u3001\u5f8c\u8ff0\u306eBasicEncryptKeyManager\u306e\u5834\u6240\u3092\u6307\u5b9a\u3059\u308b\n\n```\nencryptKeyManager = models.security.BasicEncryptKeyManager\n```\n\nencryptKeyManager = \"models.security.BasicEncryptKeyManager\"\n\u3068\u30c0\u30d6\u30eb\u30af\u30a9\u30fc\u30c8\u3067\u56f2\u3046\u3068\u52d5\u304b\u306a\u3044\u306e\u3067\u6ce8\u610f\n\n# \u6697\u53f7\u5316\u306e\u6e96\u5099\n\n## models.entity\n\n@Encrypted\u3092\u3064\u3051\u305f\u30ab\u30e9\u30e0\u304c\u6697\u53f7\u5316\u3055\u308c\u308b\n\n```java:User.java\npackage models.entity;\n\nimport com.avaje.ebean.annotation.Encrypted;\n\nimport javax.persistence.Entity;\n\n/**\n * \u30e6\u30fc\u30b6\u30fc\u60c5\u5831\n *\n * @author\n *\n */\n@Entity\npublic class User extends BaseEntity {\n\n    /* \u30e6\u30fc\u30b6\u30fc\u540d */\n    @Encrypted\n    public String name;\n\n    /* \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9 */\n    @Encrypted\n    public String mail;\n\n    /* \u30d1\u30b9\u30ef\u30fc\u30c9 */\n    @Encrypted\n    public String password;\n\n    public static Finder<Long, User> finder = new Finder<Long, User>(User.class);\n\n}\n```\n\n## models.security\n\n### BasicEncryptKeyManager\n\n```java:BasicEncryptKeyManager\npackage models.security;\n\n\nimport com.avaje.ebean.config.EncryptKey;\nimport com.avaje.ebean.config.EncryptKeyManager;\n\npublic class BasicEncryptKeyManager implements EncryptKeyManager {\n\n    @Override\n    public EncryptKey getEncryptKey(String tableName, String columnName) {\n        return new CustomEncryptKey(tableName, columnName);\n    }\n\n    @Override\n    public void initialise() {\n        // Do nothing (yet)\n    }\n\n}\n```\n\n### CustomEncryptKey\n\n```java:CustomEncryptKey\npackage models.security;\n\nimport com.avaje.ebean.config.EncryptKey;\n\npublic class CustomEncryptKey implements EncryptKey {\n\n    private String tableName;\n\n    private String columnName;\n\n    public CustomEncryptKey(String tableName, String columnName) {\n        this.tableName = tableName;\n        this.columnName = columnName;\n    }\n\n    @Override\n    public String getStringValue() {\n        return play.Configuration.root().getString(\"application.secret\") + \"::\" + this.tableName\n                + \"::\" + this.columnName;\n    }\n}\n```\n\n# \u78ba\u8a8d\n\u4e0a\u8a18\u307e\u3067\u3067\u6e96\u5099\u306f\u7d42\u4e86\n\nmariadb\u306b\u4ed8\u3044\u3066\u304d\u305fHeidiSQL\u3067\u78ba\u8a8d\u3057\u3066\u307f\u308b\n\n## HeidiSQL\n![db.gif](https://qiita-image-store.s3.amazonaws.com/0/77685/80cf121a-328c-9d9a-3b6f-25ed9ad02bbb.gif)\n\n\n\u898b\u3048\u306a\u3044\uff01\n\n# \u53c2\u8003\nhttps://www.playframework.com/documentation/2.5.x/JavaEbean\nhttps://archive-avaje-org.github.io/ebean/encryption.html\nhttp://stackoverflow.com/questions/15800453/play-framework-2-1-java-ebean-encrypted-annotation-errors\n", "tags": ["PlayFramework2.5", "Java8", "Ebean", "mariadb"]}