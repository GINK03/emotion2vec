{"context": " More than 1 year has passed since last update.myThings\u306e\u7d44\u5408\u305b\u3068\u3057\u3066IDCF\u3092\u30c8\u30ea\u30ac\u30fc\u306b\u4f7f\u3046\u5834\u5408\u3001\u4f55\u304b\u3057\u3089\u306e\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u305d\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u304b\u5224\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u5927\u304d\u304f\u5206\u3051\u3066Raspberry Pi\u306a\u3069\u306e\u30b3\u30cd\u30af\u30c6\u30c3\u30c9\u30c7\u30d0\u30a4\u30b9\u5074\u304b\u3001IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u304c\u3042\u308b\u30af\u30e9\u30a6\u30c9\u5074\u3067\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u8a08\u6e2c\u3057\u305f\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u304c\u95be\u5024\u3092\u8d85\u3048\u305f\u5834\u5408\u306b\u3001\u30c8\u30ea\u30ac\u30fc\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u304b\u5224\u5b9a\u3059\u308b\u30b3\u30fc\u30c9\u3092Rasbperry Pi\u5074\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u306f\u3058\u3081\u306b\n\n\u4f5c\u696d\u306e\u6d41\u308c\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u4f5c\u696d\u3092\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\nRaspberry Pi\u3067BME280\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\nRaspberry Pi\u3067\u95be\u5024\u76e3\u8996\u3092\u3059\u308b\nRaspberry Pi\u304b\u3089IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306bHTTP POST /data/{trigger\u306euuid}\u3059\u308b\nmyThings\u30a2\u30d7\u30ea\u304b\u3089\u7d44\u5408\u305b\u3092\u300c\u624b\u52d5\u5b9f\u884c\u300d\u3059\u308b\nGmail\u306b\u30e1\u30fc\u30eb\u304c\u5c4a\u304f\n\n\nRaspberry Pi\u3068BME280\u74b0\u5883\u30bb\u30f3\u30b5\u30fc\u8a2d\u5b9a\n\u3042\u3089\u304b\u3058\u3081Part2\u306e\u624b\u9806\u3067Raspberry Pi\u3068BME280\u74b0\u5883\u30bb\u30f3\u30b5\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3044\u307e\u3059\u3002\n\u3059\u3067\u306b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u6e08\u306e\u5834\u5408\u306fgit clone\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u6700\u65b0\u306e\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n$ cd ~/python_apps/bme280-meshblu-pybme280-meshblu-py\n$ git pull\n\n\u3042\u305f\u3089\u3057\u304f\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u5834\u5408\u306f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3066git clone\u3057\u307e\u3059\u3002\n$ mkdir -p ~/python_apps\n$ cd ~/python_apps\n$ git clone https://github.com/IDCFChannel/bme280-meshblu-py.git\n$ cd bme280-meshblu-py\n\nbme280_sample.py\u306ePython\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30f3\u30b5\u30fc\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ sudo python bme280_sample.py\ntemp : 27.06  \u2103\npressure : 1006.96 hPa\nhum :  57.78 \uff05\n\n\nIDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u3067trigger-1\u306e\u78ba\u8a8d\nIDCF\u30af\u30e9\u30a6\u30c9\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066list\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u4f7f\u7528\u3059\u308btrigger-1\u306etoken\u3068uuid\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ cd ~/iot_apps/meshblu-compose/\n$ docker-compose run --rm iotutil list\n...\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 keyword   \u2502 token    \u2502 uuid                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 trigger-1 \u2502 d74ebedf \u2502 21c83792-b25e-4ae7-a627-714af57a1a4b \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n...\n\n\nRaspberry Pi\u3067\u30b3\u30fc\u30c9\u306e\u6e96\u5099\nRasbpberry Pi\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066config.py\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u3067\u78ba\u8a8d\u3057\u305ftrigger-1\u306e\u5024\u3084\u3001IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002action\u306euuid\u306a\u3069\u306f\u4eca\u56de\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002THRESHOLD\u306f\u95be\u5024\u76e3\u8996\u3067\u4f7f\u3046\u6c17\u6e29\u306e\u95be\u5024\u306b\u306a\u308a\u307e\u3059\u3002\n\nconfig.py\nconf = {\n     \"IDCF_CHANNEL_URL\": \"210.140.162.58\",\n     \"TRIGGER_1_UUID\": \"21c83792-b25e-4ae7-a627-714af57a1a4b\",\n     \"TRIGGER_1_TOKEN\": \"d74ebedf\",\n     \"ACTION_1_UUID\": \"\",\n     \"ACTION_2_UUID\": \"\",\n     \"THRESHOLD\": 27.0\n}\n\n\n\nmyThings\u30a2\u30d7\u30ea\u3067\u7d44\u5408\u305b\u306e\u4f5c\u6210\nIDCF\u3092\u30c8\u30ea\u30ac\u30fc\u306b\u3001Gmail\u3092\u30a2\u30af\u30b7\u30e7\u30f3\u306b\u3057\u3066\u7d44\u5408\u305b\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4f5c\u308a\u65b9\u306fPart6\u306e\u300cGmail\u300d\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b\u3068\u540c\u3058\u3067\u3059\u3002\n\n\nRaspberry Pi\u5074\u3067\u95be\u5024\u76e3\u8996\nRaspberry Pi\u4e0a\u3067\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4e2d\u3067\u95be\u5024\u76e3\u8996\u3082\u540c\u6642\u306b\u884c\u3046\u30d1\u30bf\u30fc\u30f3\u3067\u3059\u3002\u30af\u30e9\u30a6\u30c9\u5074\u306b\u8ffd\u52a0\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u4e0d\u8981\u306a\u305f\u3081\u3001\u5358\u7d14\u306a\u95be\u5024\u76e3\u8996\u3084\u30c6\u30b9\u30c8\u306b\u5411\u3044\u3066\u3044\u307e\u3059\u3002\u305f\u3060\u3057Raspberry Pi\u304c\u8907\u6570\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u3001\u95be\u5024\u76e3\u8996\u306e\u6761\u4ef6\u3092\u5909\u66f4\u3057\u305f\u5f8c\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u30c7\u30d7\u30ed\u30a4\u304c\u7169\u96d1\u306b\u306a\u308a\u307e\u3059\u3002\n\nRaspberry Pi\u5074\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\n\u6700\u521d\u306b\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u5229\u7528\u3059\u308brequests\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ sudo pip install requests\n\ngit clone\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u3001bme280_data.py\u3092\u4f7f\u3044\u307e\u3059\u3002\n\nbme280_data.py\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\nfrom time import sleep\nimport json\nimport bme280\nimport requests\nfrom config import conf\n\ndef sensing():\n    return bme280.readData()\n\ndef main():\n    # HTTP\n    url = \"http://{0}/data/{1}\".format(conf[\"IDCF_CHANNEL_URL\"],\n                                       conf[\"TRIGGER_1_UUID\"])\n    headers = {\n        \"meshblu_auth_uuid\": conf[\"TRIGGER_1_UUID\"],\n        \"meshblu_auth_token\": conf[\"TRIGGER_1_TOKEN\"]\n    }\n    payload = {\"trigger\":\"on\"}\n\n    while True:\n        retval = sensing()\n        if retval:\n             print(\"temperature: {}\".format(retval[\"temperature\"]))\n             if float(retval[\"temperature\"]) > conf[\"THRESHOLD\"]:\n                 print(\"threshold over: {0} > {1}\".format(float(retval[\"temperature\"]),\n                                     conf[\"THRESHOLD\"]))\n                 r = requests.post(url, headers=headers, data=payload)\n        sleep(5)\n\nif __name__ == '__main__':\n    main()\n\n\n\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u306e\u95be\u5024\u3092\u76e3\u8996\u3059\u308b\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u3067\u3059\u3002config.py\u306b\u8a2d\u5b9a\u3057\u305fTHRESHOLD\u306e\u5024\u3068\u30bb\u30f3\u30b5\u30fc\u304b\u3089\u53d6\u5f97\u3057\u305f\u6c17\u6e29(temperature)\u3092\u6bd4\u8f03\u3057\u307e\u3059\u3002THRESHOLD\u306f27.0\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u6c17\u6e29\u304c27.0\u3088\u308a\u9ad8\u3044\u5834\u5408\u306b\u30c8\u30ea\u30ac\u30fc\u306e\u767a\u706b\u6761\u4ef6\u3068\u306a\u308a\u307e\u3059\u3002\n    while True:\n        sleep(5)\n        retval = sensing()\n        if retval:\n             print(\"temperature: {}\".format(retval[\"temperature\"]))\n             if float(retval[\"temperature\"]) > conf[\"THRESHOLD\"]:\n                 print(\"threshold over: {0} > {1}\".format(float(retval[\"temperature\"]),\n                                     conf[\"THRESHOLD\"]))\n                 r = requests.post(url, headers=headers, data=payload)\n\n\u30c8\u30ea\u30ac\u30fc\u306e\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u305f\u3053\u3068\u3092myThings\u30b5\u30fc\u30d0\u30fc\u306b\u4f1d\u3048\u308b\u305f\u3081\u3001IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306bHTTP POST\u3057\u307e\u3059\u3002IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306eIP\u30a2\u30c9\u30ec\u30b9\u306b\u7d9a\u3051\u3066/data/{trigger-1\u306euuid\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n    url = \"http://{0}/data/{1}\".format(conf[\"IDCF_CHANNEL_URL\"],\n                                       conf[\"TRIGGER_1_UUID\"])\n\n\u5b8c\u6210\u3057\u305fURL\u306b\u8a8d\u8a3c\u7528\u306eHTTP\u30d8\u30c3\u30c0\u3092\u8ffd\u52a0\u3057\u3066HTTP POST\u3057\u307e\u3059\u3002POST\u3059\u308b\u30c7\u30fc\u30bf\u306f\u73fe\u5728IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u306e\u30c8\u30ea\u30ac\u30fc\u304b\u3089\u30a2\u30af\u30b7\u30e7\u30f3\u306b\u5024\u3068\u3057\u3066\u6e21\u3059\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u306a\u304f\u3066\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\nhttp://210.140.162.58/data/21c83792-b25e-4ae7-a627-714af57a1a4b\n\n\n\u30c8\u30ea\u30ac\u30fc\u306e\u767a\u706b\u3068\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\nconfig.py\u306eTHRESHOLD\u306e\u5024\u306f\u95be\u5024\u76e3\u8996\u3092\u901a\u308b\u3088\u3046\u306b\u5024\u3092\u8abf\u6574\u3057\u3066\u304b\u3089\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n$ sudo ./bme280_data.py\ntemperature: 27.26\nthreshold over: 27.26 > 27.0\n\n\u95be\u5024\u3092\u8d85\u3048\u305f\u3089Ctrl-C\u3092\u62bc\u3057\u3066\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u7d42\u4e86\u3055\u305b\u307e\u3059\u3002\nmyThings\u30a2\u30d7\u30ea\u306e\u7d44\u5408\u305b\u3092\u958b\u3044\u3066\u300c\u624b\u52d5\u5b9f\u884c\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u307e\u3059\u3002\u30c8\u30ea\u30ac\u30fc\u306e\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u306e\u3067Gmail\u30a2\u30af\u30b7\u30e7\u30f3\u304c\u5b9f\u884c\u3055\u308c\u3001\u30e1\u30fc\u30eb\u304c\u5c4a\u304d\u307e\u3059\u3002\n\n\n/data\u306bPOST\u3059\u308b\u3068MongoDB\u306b\u30ec\u30b3\u30fc\u30c9\u304c\u4f5c\u6210\u3055\u308c\u308b\n\u30c8\u30ea\u30ac\u30fc\u767a\u706b\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066/data/{trigger-1\u306euuid}\u306bHTTP POST\u3059\u308b\u3068\u3001IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306eMongoDB\u306b\u30ec\u30b3\u30fc\u30c9\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\nIDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u304b\u3089\u3001MongoDB\u306e\u30b3\u30f3\u30c6\u30ca\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n$  cd ~/iot_apps/meshblu-compose\n$ docker exec -it meshblucompose_mongo_1 mongo skynet\n>\n\ndata\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u6700\u65b0\u306e\u5024\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002trigger-1\u306euuid\u3092\u6301\u3061\u3001\u5148\u307b\u3069\u30c8\u30ea\u30ac\u30fc\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u305f\u6642\u523b\u306bHTTP POST\u3057\u305f\u30ec\u30b3\u30fc\u30c9\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n> db.data.find().sort({ $natural: -1 }).limit(1)\n{ \"_id\" : ObjectId(\"55fa682d06986a0e000058da\"), \"trigger\" : \"on\", \"ipAddress\" : \"210.xxx.xxx.xxx\", \"uuid\" : \"21c83792-b25e-4ae7-a627-714af57a1a4b\", \"timestamp\" : \"2015-09-17T07:13:49.438Z\" }\n\nmyThings\u30a2\u30d7\u30ea\u306e\u7d44\u5408\u305b\u3067\u6307\u5b9a\u3057\u305f\u30c8\u30ea\u30ac\u30fc\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u304b\u3001myThings\u30b5\u30fc\u30d0\u30fc\u306f15\u5206\u9593\u9694\u3067data\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002myThings\u30a2\u30d7\u30ea\u306e\u300c\u624b\u52d5\u5b9f\u884c\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u305f\u5834\u5408\u306f\u3059\u3050\u306b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u524d\u56de\u78ba\u8a8d\u3057\u305f\u6642\u523b\u3088\u308a\u65b0\u3057\u3044\u30ec\u30b3\u30fc\u30c9\u304c\u898b\u3064\u304b\u308b\u3068\u3001\u30c8\u30ea\u30ac\u30fc\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u305f\u3068\u5224\u65ad\u3057\u3066myThings\u30b5\u30fc\u30d0\u30fc\u306f\u8a2d\u5b9a\u3055\u308c\u305f\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\nmyThings\u306e\u7d44\u5408\u305b\u3068\u3057\u3066IDCF\u3092\u30c8\u30ea\u30ac\u30fc\u306b\u4f7f\u3046\u5834\u5408\u3001\u4f55\u304b\u3057\u3089\u306e\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u305d\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u304b\u5224\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u5927\u304d\u304f\u5206\u3051\u3066Raspberry Pi\u306a\u3069\u306e\u30b3\u30cd\u30af\u30c6\u30c3\u30c9\u30c7\u30d0\u30a4\u30b9\u5074\u304b\u3001IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u304c\u3042\u308b\u30af\u30e9\u30a6\u30c9\u5074\u3067\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u4eca\u56de\u306f\u8a08\u6e2c\u3057\u305f\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u304c\u95be\u5024\u3092\u8d85\u3048\u305f\u5834\u5408\u306b\u3001\u30c8\u30ea\u30ac\u30fc\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u304b\u5224\u5b9a\u3059\u308b\u30b3\u30fc\u30c9\u3092Rasbperry Pi\u5074\u3067\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n## \u306f\u3058\u3081\u306b\n\n### \u4f5c\u696d\u306e\u6d41\u308c\n\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u4f5c\u696d\u3092\u9032\u3081\u3066\u3044\u304d\u307e\u3059\u3002\n\n1. Raspberry Pi\u3067BME280\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\n1. Raspberry Pi\u3067\u95be\u5024\u76e3\u8996\u3092\u3059\u308b\n1. Raspberry Pi\u304b\u3089IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306bHTTP POST `/data/{trigger\u306euuid}`\u3059\u308b\n1. myThings\u30a2\u30d7\u30ea\u304b\u3089\u7d44\u5408\u305b\u3092\u300c\u624b\u52d5\u5b9f\u884c\u300d\u3059\u308b\n1. Gmail\u306b\u30e1\u30fc\u30eb\u304c\u5c4a\u304f\n\n### Raspberry Pi\u3068BME280\u74b0\u5883\u30bb\u30f3\u30b5\u30fc\u8a2d\u5b9a\n\n\u3042\u3089\u304b\u3058\u3081[Part2](http://qiita.com/masato/items/f9be4a15216fe29de7fb)\u306e\u624b\u9806\u3067Raspberry Pi\u3068[BME280\u74b0\u5883\u30bb\u30f3\u30b5\u30e2\u30b8\u30e5\u30fc\u30eb](https://www.switch-science.com/catalog/2236/)\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u3059\u3067\u306b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u6e08\u306e\u5834\u5408\u306f`git clone`\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u6700\u65b0\u306e\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash\n$ cd ~/python_apps/bme280-meshblu-pybme280-meshblu-py\n$ git pull\n```\n\n\u3042\u305f\u3089\u3057\u304f\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u5834\u5408\u306f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u3066`git clone`\u3057\u307e\u3059\u3002\n\n```bash\n$ mkdir -p ~/python_apps\n$ cd ~/python_apps\n$ git clone https://github.com/IDCFChannel/bme280-meshblu-py.git\n$ cd bme280-meshblu-py\n```\n\n[bme280_sample.py](https://github.com/IDCFChannel/bme280-meshblu-py/blob/master/bme280_sample.py)\u306ePython\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30f3\u30b5\u30fc\u304b\u3089\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3067\u304d\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo python bme280_sample.py\ntemp : 27.06  \u2103\npressure : 1006.96 hPa\nhum :  57.78 \uff05\n```\n\n### IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u3067trigger-1\u306e\u78ba\u8a8d\n\nIDCF\u30af\u30e9\u30a6\u30c9\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066`list`\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u4f7f\u7528\u3059\u308b`trigger-1`\u306etoken\u3068uuid\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash\n$ cd ~/iot_apps/meshblu-compose/\n$ docker-compose run --rm iotutil list\n...\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 keyword   \u2502 token    \u2502 uuid                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 trigger-1 \u2502 d74ebedf \u2502 21c83792-b25e-4ae7-a627-714af57a1a4b \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n...\n```\n\n### Raspberry Pi\u3067\u30b3\u30fc\u30c9\u306e\u6e96\u5099\n\nRasbpberry Pi\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066config.py\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u3067\u78ba\u8a8d\u3057\u305f`trigger-1`\u306e\u5024\u3084\u3001IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002action\u306euuid\u306a\u3069\u306f\u4eca\u56de\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002`THRESHOLD`\u306f\u95be\u5024\u76e3\u8996\u3067\u4f7f\u3046\u6c17\u6e29\u306e\u95be\u5024\u306b\u306a\u308a\u307e\u3059\u3002\n\n```python:config.py\nconf = {\n     \"IDCF_CHANNEL_URL\": \"210.140.162.58\",\n     \"TRIGGER_1_UUID\": \"21c83792-b25e-4ae7-a627-714af57a1a4b\",\n     \"TRIGGER_1_TOKEN\": \"d74ebedf\",\n     \"ACTION_1_UUID\": \"\",\n     \"ACTION_2_UUID\": \"\",\n     \"THRESHOLD\": 27.0\n}\n```\n\n### myThings\u30a2\u30d7\u30ea\u3067\u7d44\u5408\u305b\u306e\u4f5c\u6210\n\nIDCF\u3092\u30c8\u30ea\u30ac\u30fc\u306b\u3001Gmail\u3092\u30a2\u30af\u30b7\u30e7\u30f3\u306b\u3057\u3066\u7d44\u5408\u305b\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4f5c\u308a\u65b9\u306f[Part6\u306e\u300cGmail\u300d\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b](/2015/09/01/mythings-idcfchannel-trigger-http/)\u3068\u540c\u3058\u3067\u3059\u3002\n\n\n![gmail-action-created.png](https://qiita-image-store.s3.amazonaws.com/0/43745/5d12cd85-5981-a17c-6fe1-e99bfb9add9b.png)\n\n\n## Raspberry Pi\u5074\u3067\u95be\u5024\u76e3\u8996\n\nRaspberry Pi\u4e0a\u3067\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4e2d\u3067\u95be\u5024\u76e3\u8996\u3082\u540c\u6642\u306b\u884c\u3046\u30d1\u30bf\u30fc\u30f3\u3067\u3059\u3002\u30af\u30e9\u30a6\u30c9\u5074\u306b\u8ffd\u52a0\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u4e0d\u8981\u306a\u305f\u3081\u3001\u5358\u7d14\u306a\u95be\u5024\u76e3\u8996\u3084\u30c6\u30b9\u30c8\u306b\u5411\u3044\u3066\u3044\u307e\u3059\u3002\u305f\u3060\u3057Raspberry Pi\u304c\u8907\u6570\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u3001\u95be\u5024\u76e3\u8996\u306e\u6761\u4ef6\u3092\u5909\u66f4\u3057\u305f\u5f8c\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u30c7\u30d7\u30ed\u30a4\u304c\u7169\u96d1\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n### Raspberry Pi\u5074\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\n\n\u6700\u521d\u306b\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u5229\u7528\u3059\u308b[requests](http://www.python-requests.org/en/latest/)\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo pip install requests\n```\n\n`git clone`\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u3001[bme280_data.py](https://github.com/IDCFChannel/bme280-meshblu-py/blob/master/bme280_data.py)\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```python:bme280_data.py\n#!/usr/bin/python\n# -*- coding: utf-8 -*-\nfrom time import sleep\nimport json\nimport bme280\nimport requests\nfrom config import conf\n\ndef sensing():\n    return bme280.readData()\n\ndef main():\n    # HTTP\n    url = \"http://{0}/data/{1}\".format(conf[\"IDCF_CHANNEL_URL\"],\n                                       conf[\"TRIGGER_1_UUID\"])\n    headers = {\n        \"meshblu_auth_uuid\": conf[\"TRIGGER_1_UUID\"],\n        \"meshblu_auth_token\": conf[\"TRIGGER_1_TOKEN\"]\n    }\n    payload = {\"trigger\":\"on\"}\n\n    while True:\n        retval = sensing()\n        if retval:\n             print(\"temperature: {}\".format(retval[\"temperature\"]))\n             if float(retval[\"temperature\"]) > conf[\"THRESHOLD\"]:\n                 print(\"threshold over: {0} > {1}\".format(float(retval[\"temperature\"]),\n                                     conf[\"THRESHOLD\"]))\n                 r = requests.post(url, headers=headers, data=payload)\n        sleep(5)\n\nif __name__ == '__main__':\n    main()\n```\n\n\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u306e\u95be\u5024\u3092\u76e3\u8996\u3059\u308b\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u3067\u3059\u3002config.py\u306b\u8a2d\u5b9a\u3057\u305f`THRESHOLD`\u306e\u5024\u3068\u30bb\u30f3\u30b5\u30fc\u304b\u3089\u53d6\u5f97\u3057\u305f\u6c17\u6e29(temperature)\u3092\u6bd4\u8f03\u3057\u307e\u3059\u3002`THRESHOLD`\u306f`27.0`\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u6c17\u6e29\u304c27.0\u3088\u308a\u9ad8\u3044\u5834\u5408\u306b\u30c8\u30ea\u30ac\u30fc\u306e\u767a\u706b\u6761\u4ef6\u3068\u306a\u308a\u307e\u3059\u3002\n\n```python\n    while True:\n        sleep(5)\n        retval = sensing()\n        if retval:\n             print(\"temperature: {}\".format(retval[\"temperature\"]))\n             if float(retval[\"temperature\"]) > conf[\"THRESHOLD\"]:\n                 print(\"threshold over: {0} > {1}\".format(float(retval[\"temperature\"]),\n                                     conf[\"THRESHOLD\"]))\n                 r = requests.post(url, headers=headers, data=payload)\n```\n\n\u30c8\u30ea\u30ac\u30fc\u306e\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u305f\u3053\u3068\u3092myThings\u30b5\u30fc\u30d0\u30fc\u306b\u4f1d\u3048\u308b\u305f\u3081\u3001IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306bHTTP POST\u3057\u307e\u3059\u3002IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306eIP\u30a2\u30c9\u30ec\u30b9\u306b\u7d9a\u3051\u3066`/data/{trigger-1\u306euuid`\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```python\n    url = \"http://{0}/data/{1}\".format(conf[\"IDCF_CHANNEL_URL\"],\n                                       conf[\"TRIGGER_1_UUID\"])\n```\n\n\u5b8c\u6210\u3057\u305fURL\u306b\u8a8d\u8a3c\u7528\u306eHTTP\u30d8\u30c3\u30c0\u3092\u8ffd\u52a0\u3057\u3066HTTP POST\u3057\u307e\u3059\u3002POST\u3059\u308b\u30c7\u30fc\u30bf\u306f\u73fe\u5728IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u306e\u30c8\u30ea\u30ac\u30fc\u304b\u3089\u30a2\u30af\u30b7\u30e7\u30f3\u306b\u5024\u3068\u3057\u3066\u6e21\u3059\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u306a\u304f\u3066\u3082\u69cb\u3044\u307e\u305b\u3093\u3002\n\n```bash\nhttp://210.140.162.58/data/21c83792-b25e-4ae7-a627-714af57a1a4b\n```\n\n### \u30c8\u30ea\u30ac\u30fc\u306e\u767a\u706b\u3068\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u5b9f\u884c\n\nconfig.py\u306e`THRESHOLD`\u306e\u5024\u306f\u95be\u5024\u76e3\u8996\u3092\u901a\u308b\u3088\u3046\u306b\u5024\u3092\u8abf\u6574\u3057\u3066\u304b\u3089\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash\n$ sudo ./bme280_data.py\ntemperature: 27.26\nthreshold over: 27.26 > 27.0\n```\n\n\u95be\u5024\u3092\u8d85\u3048\u305f\u3089Ctrl-C\u3092\u62bc\u3057\u3066\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u7d42\u4e86\u3055\u305b\u307e\u3059\u3002\n\nmyThings\u30a2\u30d7\u30ea\u306e\u7d44\u5408\u305b\u3092\u958b\u3044\u3066\u300c\u624b\u52d5\u5b9f\u884c\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u307e\u3059\u3002\u30c8\u30ea\u30ac\u30fc\u306e\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u306e\u3067Gmail\u30a2\u30af\u30b7\u30e7\u30f3\u304c\u5b9f\u884c\u3055\u308c\u3001\u30e1\u30fc\u30eb\u304c\u5c4a\u304d\u307e\u3059\u3002\n\n![gmail-received.png](https://qiita-image-store.s3.amazonaws.com/0/43745/a5028ae1-08de-82dc-c3b6-1dfd55c5298f.png)\n\n\n## /data\u306bPOST\u3059\u308b\u3068MongoDB\u306b\u30ec\u30b3\u30fc\u30c9\u304c\u4f5c\u6210\u3055\u308c\u308b\n\n\u30c8\u30ea\u30ac\u30fc\u767a\u706b\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u3066`/data/{trigger-1\u306euuid}`\u306bHTTP POST\u3059\u308b\u3068\u3001IDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u306eMongoDB\u306b\u30ec\u30b3\u30fc\u30c9\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\nIDCF\u30c1\u30e3\u30f3\u30cd\u30eb\u30b5\u30fc\u30d0\u30fc\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u3066\u304b\u3089\u3001MongoDB\u306e\u30b3\u30f3\u30c6\u30ca\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n```bash\n$  cd ~/iot_apps/meshblu-compose\n$ docker exec -it meshblucompose_mongo_1 mongo skynet\n>\n```\n\n`data`\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u6700\u65b0\u306e\u5024\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002trigger-1\u306euuid\u3092\u6301\u3061\u3001\u5148\u307b\u3069\u30c8\u30ea\u30ac\u30fc\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u305f\u6642\u523b\u306bHTTP POST\u3057\u305f\u30ec\u30b3\u30fc\u30c9\u304c\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n```bash\n> db.data.find().sort({ $natural: -1 }).limit(1)\n{ \"_id\" : ObjectId(\"55fa682d06986a0e000058da\"), \"trigger\" : \"on\", \"ipAddress\" : \"210.xxx.xxx.xxx\", \"uuid\" : \"21c83792-b25e-4ae7-a627-714af57a1a4b\", \"timestamp\" : \"2015-09-17T07:13:49.438Z\" }\n```\n\nmyThings\u30a2\u30d7\u30ea\u306e\u7d44\u5408\u305b\u3067\u6307\u5b9a\u3057\u305f\u30c8\u30ea\u30ac\u30fc\u306e\u30ec\u30b3\u30fc\u30c9\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u304b\u3001myThings\u30b5\u30fc\u30d0\u30fc\u306f15\u5206\u9593\u9694\u3067`data`\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u3066\u3044\u307e\u3059\u3002myThings\u30a2\u30d7\u30ea\u306e\u300c\u624b\u52d5\u5b9f\u884c\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u305f\u5834\u5408\u306f\u3059\u3050\u306b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u524d\u56de\u78ba\u8a8d\u3057\u305f\u6642\u523b\u3088\u308a\u65b0\u3057\u3044\u30ec\u30b3\u30fc\u30c9\u304c\u898b\u3064\u304b\u308b\u3068\u3001\u30c8\u30ea\u30ac\u30fc\u767a\u706b\u6761\u4ef6\u3092\u6e80\u305f\u3057\u305f\u3068\u5224\u65ad\u3057\u3066myThings\u30b5\u30fc\u30d0\u30fc\u306f\u8a2d\u5b9a\u3055\u308c\u305f\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n", "tags": ["myThings", "IDCF\u30af\u30e9\u30a6\u30c9", "IoT", "Meshblu", "RaspberryPi"]}