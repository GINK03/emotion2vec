{"context": " More than 1 year has passed since last update.\n\n\u672c\u8a18\u4e8b\u306e\u30bf\u30fc\u30b2\u30c3\u30c8\nLinux\u3067\u3001\u5b8c\u5168\u30af\u30ed\u30fc\u30ba\u30c9\u306a\u74b0\u5883\u3067\u697d\u306b\u8ffd\u52a0\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3044\u3068\u601d\u308f\u308c\u308b\u65b9\u3092\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u306a\u305c\u66f8\u3044\u305f\u306e\u304b\n\u69cb\u6210\u7ba1\u7406\u30c4\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u3066\u306e\u81ea\u52d5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u5f53\u305f\u308a\u524d\u306b\u306a\u308a\u3064\u3064\u3042\u308a\u307e\u3059\u304c\u3001\u304a\u5ba2\u69d8\u74b0\u5883\u306a\u3069\u306b\u3088\u3063\u3066\u306f\n\n\u30b5\u30fc\u30d0\u30ad\u30c3\u30c6\u30a3\u30f3\u30b0\u4f1a\u793e\u3068\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u7d44\u8fbc\u307f\u4f1a\u793e\u304c\u5206\u304b\u308c\u3066\u304a\u308a\u3001\u30ad\u30c3\u30c6\u30a3\u30f3\u30b0\u4f1a\u793e\u304c\u521d\u671f\u72b6\u614b\u3067zabbix-agent\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304b\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3002\n\u30b7\u30b9\u30c6\u30e0\u306e\u91cd\u8981\u6027\u304b\u3089\u3001\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u306f\u7d0d\u54c1\u3059\u308b\u307e\u3067\u7d76\u5bfe\u306b\u884c\u3063\u3066\u306f\u3044\u3051\u306a\u3044\u3002\n\n\u3068\u3044\u3046\u4e8b\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u3046\u3068\u3046\u5c11\u306a\u3044\u3067\u3059\u304c\u3002\n\u672c\u6295\u7a3f\u3067\u306f\u3001\u30e2\u30c7\u30eb\u3092zabbix-agent\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\u79c1\u304c\u3053\u308c\u3092\u66f8\u3044\u305f\u7406\u7531\u306f\u4e0a\u8a18\u306e\u554f\u984c\u3068\u5c11\u3057\u9055\u3063\u3066\u3044\u3066\u3001\u5143\u3005\u306f\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u306eIPMI\u76e3\u8996\u3092\u30b5\u30fc\u30d0\u3092\u30e9\u30c3\u30ad\u30f3\u30b0\u3057\u3066\u76f4\u3050\u306b\u59cb\u3081\u305f\u3044\u3068\u3044\u3046\u4e8b\u304c\u3042\u3063\u3066\u4f5c\u308a\u307e\u3057\u305f\u3002\nIPMI\u76e3\u8996\u306bzabbix-agent\u306f\u4e0d\u8981\u306a\u3093\u3058\u3083\u306a\u3044\uff1f\u3068\u3044\u3046\u3054\u610f\u898b\u3082\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u30aa\u30fc\u30c8\u30c7\u30a3\u30b9\u30ab\u30d0\u30ea\u3067zabbix-server\u3078\u81ea\u52d5\u767b\u9332\u3055\u305b\u308b\u306e\u304c\u76ee\u7684\u306b\u306a\u308a\u307e\u3059\u3002\n\nChef, Ansible, Puppet\u3067\u306f\u99c4\u76ee\u306a\u306e\u304b\uff1f\n\u524d\u9014\u3067\u6319\u3052\u305f\u3088\u3046\u306a\u74b0\u5883\u3067\u3059\u3068\u3001\u30b7\u30b9\u30c6\u30e0\u306b\u4e0d\u5fc5\u8981\u306a\u30c4\u30fc\u30eb\u30fb\u8a00\u8a9e\u30fb\u30dd\u30fc\u30c8\u306f\u4f7f\u7528\u3057\u3066\u306f\u3044\u3051\u306a\u3044\u3068\u3044\u3046\u30eb\u30fc\u30eb\u3082\u5b58\u5728\u3057\u307e\u3059\u3002\u52ff\u8ad622/TCP\u3082\u3053\u308c\u306b\u8a72\u5f53\u3059\u308b\u53ef\u80fd\u6027\u306f\u3042\u308a\u307e\u3059\u3002\n\n\u4eca\u56de\u4f5c\u6210\u3057\u305f\u69cb\u6210\n\nUbunut server 14.04 iso\u30a4\u30e1\u30fc\u30b8\nISO\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\u7528Linux(\u4eee\u60f3\u74b0\u5883\u3067\u3082OK\u3067\u3001\u4e0a\u8a18\u306eiso\u30a4\u30e1\u30fc\u30b8\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fOS)\n\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u304c\u53ef\u80fd\u306a\u74b0\u5883\n\n\n\u4e8b\u524d\u6e96\u5099\nISO\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u70ba\u306eOS\u3092\u4e8b\u524d\u306b\u7528\u610f\u3057\u307e\u3059\u3002\n\u53ef\u80fd\u3067\u3042\u308c\u3070\u540c\u3058iso\u30a4\u30e1\u30fc\u30b8\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u3082\u306e\u304c\u826f\u3044\u3067\u3059\u304c\u3001\u540c\u3058\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u30fb\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u5408\u3063\u3066\u3044\u308c\u3070\u554f\u984c\u306f\u7121\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30ab\u30b9\u30bf\u30e0Ubuntu\u4f5c\u6210\n\n\u69cb\u7bc9\u7528Ubuntu\u30b5\u30fc\u30d0\u30ed\u30b0\u30a4\u30f3\n\n$ ssh -l user 192.168.xxx.xxx\nuser@ubuntu:~$\n\n\niso\u30a4\u30e1\u30fc\u30b8\u5c55\u958b\u30fb\u30b3\u30d4\u30fc\n\n$ pwd\n/home/user\n$ mkdir work\n$ cd work/\nwork$ mkdir iso original-iso custom-iso\nwork$ cd iso/\nwork/iso$ wget http://releases.ubuntu.com/14.04.3/ubuntu-14.04.3-server-amd64.iso\n\nwork/iso$ cd ..\nwork$ sudo mount -o loop iso/ubuntu-14.04.3-server-amd64.iso ./original-iso/\nmount: block device /home/user/work/iso/ubuntu-14.04.3-server-amd64.iso is write-\nprotected, mounting read-only\nwork$ sudo cp -r ./original-iso/* ./custom-iso/\nwork$ sudo cp -r ./original-iso/.disk/ ./custom-iso/\nwork$ sudo umount ./original-iso\n\n\n\u30ab\u30b9\u30bf\u30e0 kickstart(seed) \u4f5c\u6210\n\n$ sudo apt-get update\n$ sudo apt-get install system-config-kickstart\n$ cd ~/work/custom-iso/isolinux/\n$ sudo vi txt.cfg\n\n\u4e00\u756a\u4e0a\u306b[default zabbix-custom]\u3000\u3068\u3000\u4e00\u756a\u4e0b\u306b[label zabbix-custom...]\u3092\u8ffd\u8a18\u3059\u308b\ndefault zabbix-custom   ## \u3053\u3053\u8ffd\u8a18\nlabel install\n  menu label ^Install Ubuntu Server\n  kernel /install/vmlinuz\n  append file=/cdrom/preseed/ubuntu-server.seed vga=788 initrd=/install/initrd.gz quiet --\nlabel cloud\n  menu label ^Multiple server install with MAAS\n  kernel /install/vmlinuz\n  append modules=maas-enlist-udeb vga=788 initrd=/install/initrd.gz quiet --\nlabel check\n  menu label ^Check disc for defects\n  kernel /install/vmlinuz\n  append MENU=/bin/cdrom-checker-menu vga=788 initrd=/install/initrd.gz quiet --\nlabel memtest\n  menu label Test ^memory\n  kernel /install/mt86plus\nlabel hd\n  menu label ^Boot from first hard disk\n  localboot 0x80\nlabel zabbix-custom ##\u3053\u3053\u304b\u3089\u8ffd\u8a18\n  menu label ^OCP Custom Install Ubuntu Server\n  kernel /install/vmlinuz\n  append file=/cdrom/preseed/ubuntu-ocp.seed initrd=/install/initrd.gz quiet --  ##\u3053\u3053\u307e\u3067\u8ffd\u8a18\n\n$ work/custom-iso/isolinux$ cd ..\n$ work/custom-iso$ cd preseed/\n$ work/custom-iso/preseed$ sudo vi ubuntu-zabbix.seed\n\n\u4e0b\u8a18\u3001kickstart\u7528\u30d5\u30a1\u30a4\u30eb\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3044\u8a00\u8a9e\u30fb\u30ad\u30fc\u30dc\u30fc\u30c9\u7b49\u3092\u74b0\u5883\u306b\u3088\u3063\u3066\u5909\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\u53c2\u8003URL: https://help.ubuntu.com/community/InstallCDCustomization/PreseedExamples\n########################################################################\n#### Custom Preseed Amlin Europe using Ubiquity\n### By Kelly Crabb \u30c6\u30a5 for Amlin Europe\n### Tested on Ubuntu Trusty Thral 14.04 LTS\n####################################################################\n# General\n####################################################################\n# Once installation is complete, automatically power off.\nd-i finish-install/reboot_in_progress note\nd-i ubiquity/summary note\nubiquity ubiquity/reboot boolean true\nubiquity ubiquity/poweroff boolean false# Automatically download and install stable updates?\nunattended-upgrades unattended-upgrades/enable_auto_updates boolean false\n####################################################################\n# Installation Sources\n####################################################################\n# Configure the sources.list\nd-i mirror/country string JP\n#d-i mirror/http/hostname string archive.ubuntu.com\n#d-i mirror/http/directory string /ubuntu/\n#d-i apt-setup/use_mirror boolean true\n#d-i apt-setup/mirror/error select Change mirror\n#d-i apt-setup/multiverse boolean true\n#d-i apt-setup/restricted boolean true\n#d-i apt-setup/universe boolean true\n#d-i apt-setup/partner boolean true\n####################################################################\n# Networking\n####################################################################\n# Network Configuration\nd-i netcfg/enable boolean true\nd-i netcfg/choose_interface select eth0\n#d-i netcfg/disable_dhcp boolean false\n####################################################################\n# Disk Partitioning / Boot loader\n####################################################################\n### Disk Partitioning ###\n# Configure auto partitioner\nubiquity partman-auto/init_automatically_partition select Guided - use entire disk\nubiquity partman-auto/disk string /dev/sda\nubiquity partman-auto/method string regular\nubiquity partman-auto/choose_recipe select All files in one partition (recommended for new\nusers)\nubiquity partman/confirm_write_new_label boolean true\nubiquity partman/choose_partition select Finish partitioning and write changes to disk\nubiquity partman/confirm boolean true\n####################################################################\n# Localizations / Timezone\n####################################################################\n### Keyboard selection ###\nd-i keyboard-configuration/layoutcode string us\nd-i keyboard-configuration/variantcode string\n### Locale ###\nd-i debian-installer/locale string en_US\n### Timezone ###\nd-i time/zone select Asia/Tokyod-i clock-setup/utc boolean true\nd-i clock-setup/ntp boolean false\nd-i console-setup/ask_detect boolean false\nd-i console-setup/layoutcode string us\n#d-i localechooser/supported-locales multiselect nl_NL, nl_BE, fr_BE\n### OEM-Config\nd-i oem-config/enable boolean true\nd-i oem-config/remove boolean true\nd-i oem-config/remove_extras boolean false\nd-i oem-config/install-language-support boolean true\nd-i ubiquity/only-show-installable-languages boolean true\n####################################################################\n# User Creation\n####################################################################\n# Root User\nd-i passwd/root-login boolean true\n# Mortal User\nd-i passwd/auto-login boolean true\nd-i passwd/root-login boolean true\nd-i passwd/make-user boolean false\nd-i passwd/root-password password password\nd-i passwd/root-password-again password password\nd-i user-setup/allow-password-weak boolean true\nd-i user-setup/encrypt-home boolean false\n####################################################################\n# Some extras\n####################################################################\ntasksel tasksel/force-tasks string server\ntasksel tasksel/first multiselect zabbix-custom\n# installing languages\n# Language pack selection\nd-i pkgsel/language-packs multiselect en, jp\n# installing services\n# d-i pkgsel/include string openssh-server\n# Whether to upgrade packages after debootstrap.\n# Allowed values: none, safe-upgrade, full-upgrade\nd-i pkgsel/upgrade select none\n# Policy for applying updates. May be \"none\" (no automatic updates),\n#d-i pkgsel/update-policy select unattended-upgrades\n# By default, the system's locate database will be updated after the\n# installer has finished installing most packages. This may take a while, so\n# if you don't want it, you can set this to \"false\" to turn it off.\n#d-i pkgsel/updatedb boolean true\n# This command is run just before the install finishes, but when there is\n# still a usable /target directory. You can chroot to /target and use it\n# directly, or use the apt-install and in-target commands to easily install\n# packages and run commands in the target system.\n#d-i preseed/late_command string apt-install zsh; in-target chsh -s /bin/zsh# And now we REALLY run with it!!\n# deb install\nd-i preseed/late_command string in-target /bin/bash /media/cdrom/pool/extras/custom_install.sh\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308bdeb\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u53ce\u96c6\n\n\n\u30ed\u30fc\u30ab\u30eb\u306e\u30a2\u30fc\u30ab\u30a4\u30d6\u524a\u9664\n\n\n\n$ sudo rm -rf /var/cache/apt/archives/\n\n\nzabbix-agent\u30ea\u30dd\u30b8\u30c8\u30ea\u767b\u9332\n\n$ wget http://repo.zabbix.com/zabbix/2.2/ubuntu/pool/main/z/zabbix-release/zabbix-release_2.2-1+trusty_all.deb\n$ sudo dpkg -i zabbix-release_2.2-1+trusty_all.deb\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb(deb\u30d1\u30c3\u30b1\u30fc\u30b8\u53ce\u96c6)\n\n$ sudo apt-get update\n$ sudo apt-get -y install zabbix-agent\n\n\ndeb\u30d1\u30c3\u30b1\u30fc\u30b8\u683c\u7d0d\n\n$ cd work/custom-iso/pool/\nwork/custom-iso/pool$ sudo mkdir extras\nwork/custom-iso/pool$ sudo cp -rp /var/cache/apt/archives/*.deb ./extras/\nwork/custom-iso/pool$ sudo vi extras/custom_install.sh\n\nzabbix-agent\u3092\u81ea\u52d5\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3001Server=XXXX/ServerActive=XXXX\u3092\u7d44\u307f\u66ff\u3048\u308b\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n#!/bin/bash\n/usr/bin/dpkg -i /media/cdrom/pool/extras/*.deb\nmodprobe mei\nmodprobe dcmi\nsed -i\".org\" \\\n-e 's/# EnableRemoteCommands=0/EnableRemoteCommands=1/g' \\\n-e 's/^Server=127.0.0.1/Server=zabbix-server/g' \\\n-e 's/^ServerActive=127.0.0.1/ServerActive=zabbix-server/g' \\\n-e 's/^Hostname=/# Hostname=/g' \\\n-e 's/# HostnameItem=/HostnameItem=/g' \\\n-e 's/# HostMetadata=/HostMetadata=Agent STARTER/g' \\\n/etc/zabbix/zabbix_agentd.conf\n\nwork/custom-iso/pool$ sudo chmod g+x extras/custom_install.sh\nwork/custom-iso/pool$ cd ../..\nwork$ sudo mkdir -p custom-iso/dists/stable/extras/binary-amd64\nwork/custom-iso/pool$ sudo su -\n# cd /home/user/work/\nhome/user/work/custom-iso# pushd custom-iso\nhome/user/work/custom-iso# apt-ftparchive packages ./pool/extras/ > dists/stable/extras/binary-amd64/Packages\nhome/user/work/custom-iso# gzip -c ./dists/stable/extras/binary-amd64/Packages | tee ./dists/stable/extras/binary-amd64/Packages.gz > /dev/null\nhome/user/work/custom-iso# popd\nhome/user/work/custom-iso# exit\n\n\nISO\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\n\nwork$ sudo apt-get install mkisofs\nwork$ sudo mkisofs -J -l -b isolinux/isolinux.bin -no-emul-boot -boot-load-size 4 -boot-info-\ntable -z -iso-level 4 -c isolinux/isolinux.cat -o ./ubuntu-zabbix-custom-amd64.iso custom-iso/\nwork$ ls\ncustom-iso iso original-iso ubuntu-zabbix-custom-amd64.iso\n\n\u5b8c\u6210\u3057\u305f\u300cubuntu-zabbix-custom-amd64.iso\u300d\u3092\u4f7f\u7528\u3059\u308b\u4e8b\u3067zabbix-agent\u304c\u81ea\u52d5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u304a\u307e\u3051\n\nOCP\u306b\u3064\u3044\u3066\nOCP\u3068\u306f\u3001Open Compute Project\u306e\u7565\u79f0\u30672011\u5e744\u6708\u306bFacebook\u793e\u304c\u63d0\u5531\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\n\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\u4ed5\u69d8\u3092\u30aa\u30fc\u30d7\u30f3\u306b\u516c\u958b\u3057\u3001\u5168\u4f53\u306e\u30a2\u30a4\u30c7\u30a2\u3084\u30b9\u30da\u30c3\u30af\u7b49\u306e\u77e5\u7684\u8ca1\u7523\u3092\u5171\u6709\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u3001\u30b5\u30fc\u30d0\u30fb\u30b9\u30c8\u30ec\u30fc\u30b8\u30fb\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\u30fb\u30e9\u30c3\u30af\u30fb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30b9\u30a4\u30c3\u30c1\u7b49\u306e\u8a2d\u8a08\u304c\u516c\u958b\u3055\u308c\u308b\u4e8b\u3067\u9ad8\u52b9\u7387\u306a\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\u304c\u51fa\u6765\u4e0a\u304c\u308a\u3001\u7701\u30a8\u30cd\u30fb\u30b3\u30b9\u30c8\u30c0\u30a6\u30f3\u304c\u56f3\u308c\u308b\u3068\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u3092\u66f8\u3044\u305f\u304d\u3063\u304b\u3051\u304cOCP\u306b\u3088\u308b\u3082\u306e\u3067\u3059\u3002\n\u8208\u5473\u3042\u308a\u307e\u3057\u305f\u3089\u4e0b\u8a18\u30b9\u30e9\u30a4\u30c9\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\nhttp://opencomputejapan.org/wp-content/uploads/2015/04/20150401-OCPJ-overview-16_91.pdf\n\ncobbler\u3067\u3082\u51fa\u6765\u307e\u3059\n\u3044\u3061\u3044\u3061iso\u3092\u4f5c\u6210\u3059\u308b\u306e\u304c\u9762\u5012\u3068\u3044\u3046\u601d\u3044\u3082\u3042\u308b\u3067\u3057\u3087\u3046\u3002\n\u305d\u3046\u3044\u3063\u305f\u5834\u5408\u306fPXE\u30d6\u30fc\u30c8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3082\u624b\u6bb5\u306e\u4e00\u3064\u3067\u3059\u3002\ncobbler\u306fPXE\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3092\u4e00\u62ec\u3067\u7ba1\u7406\u3059\u308b\u4e8b\u304c\u53ef\u80fd\u306a\u306e\u3067\u3001\u662f\u975e\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002\nhttp://cobbler.github.io/\n# \u672c\u8a18\u4e8b\u306e\u30bf\u30fc\u30b2\u30c3\u30c8\n\nLinux\u3067\u3001\u5b8c\u5168\u30af\u30ed\u30fc\u30ba\u30c9\u306a\u74b0\u5883\u3067\u697d\u306b\u8ffd\u52a0\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3044\u3068\u601d\u308f\u308c\u308b\u65b9\u3092\u30bf\u30fc\u30b2\u30c3\u30c8\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n# \u306a\u305c\u66f8\u3044\u305f\u306e\u304b\n\n\u69cb\u6210\u7ba1\u7406\u30c4\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u3066\u306e\u81ea\u52d5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u5f53\u305f\u308a\u524d\u306b\u306a\u308a\u3064\u3064\u3042\u308a\u307e\u3059\u304c\u3001\u304a\u5ba2\u69d8\u74b0\u5883\u306a\u3069\u306b\u3088\u3063\u3066\u306f\n\n* \u30b5\u30fc\u30d0\u30ad\u30c3\u30c6\u30a3\u30f3\u30b0\u4f1a\u793e\u3068\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u7d44\u8fbc\u307f\u4f1a\u793e\u304c\u5206\u304b\u308c\u3066\u304a\u308a\u3001\u30ad\u30c3\u30c6\u30a3\u30f3\u30b0\u4f1a\u793e\u304c\u521d\u671f\u72b6\u614b\u3067zabbix-agent\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304b\u306a\u3051\u308c\u3070\u3044\u3051\u306a\u3044\u3002\n\n* \u30b7\u30b9\u30c6\u30e0\u306e\u91cd\u8981\u6027\u304b\u3089\u3001\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u306f\u7d0d\u54c1\u3059\u308b\u307e\u3067\u7d76\u5bfe\u306b\u884c\u3063\u3066\u306f\u3044\u3051\u306a\u3044\u3002\n\n\u3068\u3044\u3046\u4e8b\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u3046\u3068\u3046\u5c11\u306a\u3044\u3067\u3059\u304c\u3002\n\n\u672c\u6295\u7a3f\u3067\u306f\u3001\u30e2\u30c7\u30eb\u3092**zabbix-agent**\u3068\u3057\u3066\u3044\u307e\u3059\u3002\n\u79c1\u304c\u3053\u308c\u3092\u66f8\u3044\u305f\u7406\u7531\u306f\u4e0a\u8a18\u306e\u554f\u984c\u3068\u5c11\u3057\u9055\u3063\u3066\u3044\u3066\u3001\u5143\u3005\u306f\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u306eIPMI\u76e3\u8996\u3092\u30b5\u30fc\u30d0\u3092\u30e9\u30c3\u30ad\u30f3\u30b0\u3057\u3066\u76f4\u3050\u306b\u59cb\u3081\u305f\u3044\u3068\u3044\u3046\u4e8b\u304c\u3042\u3063\u3066\u4f5c\u308a\u307e\u3057\u305f\u3002\nIPMI\u76e3\u8996\u306bzabbix-agent\u306f\u4e0d\u8981\u306a\u3093\u3058\u3083\u306a\u3044\uff1f\u3068\u3044\u3046\u3054\u610f\u898b\u3082\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u30aa\u30fc\u30c8\u30c7\u30a3\u30b9\u30ab\u30d0\u30ea\u3067zabbix-server\u3078\u81ea\u52d5\u767b\u9332\u3055\u305b\u308b\u306e\u304c\u76ee\u7684\u306b\u306a\u308a\u307e\u3059\u3002\n\n## Chef, Ansible, Puppet\u3067\u306f\u99c4\u76ee\u306a\u306e\u304b\uff1f\n\n\u524d\u9014\u3067\u6319\u3052\u305f\u3088\u3046\u306a\u74b0\u5883\u3067\u3059\u3068\u3001\u30b7\u30b9\u30c6\u30e0\u306b\u4e0d\u5fc5\u8981\u306a\u30c4\u30fc\u30eb\u30fb\u8a00\u8a9e\u30fb\u30dd\u30fc\u30c8\u306f\u4f7f\u7528\u3057\u3066\u306f\u3044\u3051\u306a\u3044\u3068\u3044\u3046\u30eb\u30fc\u30eb\u3082\u5b58\u5728\u3057\u307e\u3059\u3002\u52ff\u8ad622/TCP\u3082\u3053\u308c\u306b\u8a72\u5f53\u3059\u308b\u53ef\u80fd\u6027\u306f\u3042\u308a\u307e\u3059\u3002\n\n\n# \u4eca\u56de\u4f5c\u6210\u3057\u305f\u69cb\u6210\n\n- Ubunut server 14.04 iso\u30a4\u30e1\u30fc\u30b8\n- ISO\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\u7528Linux(\u4eee\u60f3\u74b0\u5883\u3067\u3082OK\u3067\u3001\u4e0a\u8a18\u306eiso\u30a4\u30e1\u30fc\u30b8\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fOS)\n- \u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u304c\u53ef\u80fd\u306a\u74b0\u5883\n\n# \u4e8b\u524d\u6e96\u5099\n\nISO\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u70ba\u306eOS\u3092\u4e8b\u524d\u306b\u7528\u610f\u3057\u307e\u3059\u3002\n\u53ef\u80fd\u3067\u3042\u308c\u3070\u540c\u3058iso\u30a4\u30e1\u30fc\u30b8\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u3082\u306e\u304c\u826f\u3044\u3067\u3059\u304c\u3001\u540c\u3058\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u30fb\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u5408\u3063\u3066\u3044\u308c\u3070\u554f\u984c\u306f\u7121\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u30ab\u30b9\u30bf\u30e0Ubuntu\u4f5c\u6210\n\n- \u69cb\u7bc9\u7528Ubuntu\u30b5\u30fc\u30d0\u30ed\u30b0\u30a4\u30f3\n\n```bash\n$ ssh -l user 192.168.xxx.xxx\nuser@ubuntu:~$\n```\n\n- iso\u30a4\u30e1\u30fc\u30b8\u5c55\u958b\u30fb\u30b3\u30d4\u30fc\n\n```bash\n$ pwd\n/home/user\n$ mkdir work\n$ cd work/\nwork$ mkdir iso original-iso custom-iso\nwork$ cd iso/\nwork/iso$ wget http://releases.ubuntu.com/14.04.3/ubuntu-14.04.3-server-amd64.iso\n\nwork/iso$ cd ..\nwork$ sudo mount -o loop iso/ubuntu-14.04.3-server-amd64.iso ./original-iso/\nmount: block device /home/user/work/iso/ubuntu-14.04.3-server-amd64.iso is write-\nprotected, mounting read-only\nwork$ sudo cp -r ./original-iso/* ./custom-iso/\nwork$ sudo cp -r ./original-iso/.disk/ ./custom-iso/\nwork$ sudo umount ./original-iso\n```\n\n- \u30ab\u30b9\u30bf\u30e0 kickstart(seed) \u4f5c\u6210\n\n```bash\n$ sudo apt-get update\n$ sudo apt-get install system-config-kickstart\n$ cd ~/work/custom-iso/isolinux/\n$ sudo vi txt.cfg\n```\n\n\u4e00\u756a\u4e0a\u306b[default zabbix-custom]\u3000\u3068\u3000\u4e00\u756a\u4e0b\u306b[label zabbix-custom...]\u3092\u8ffd\u8a18\u3059\u308b\n\n```text\ndefault zabbix-custom   ## \u3053\u3053\u8ffd\u8a18\nlabel install\n  menu label ^Install Ubuntu Server\n  kernel /install/vmlinuz\n  append file=/cdrom/preseed/ubuntu-server.seed vga=788 initrd=/install/initrd.gz quiet --\nlabel cloud\n  menu label ^Multiple server install with MAAS\n  kernel /install/vmlinuz\n  append modules=maas-enlist-udeb vga=788 initrd=/install/initrd.gz quiet --\nlabel check\n  menu label ^Check disc for defects\n  kernel /install/vmlinuz\n  append MENU=/bin/cdrom-checker-menu vga=788 initrd=/install/initrd.gz quiet --\nlabel memtest\n  menu label Test ^memory\n  kernel /install/mt86plus\nlabel hd\n  menu label ^Boot from first hard disk\n  localboot 0x80\nlabel zabbix-custom ##\u3053\u3053\u304b\u3089\u8ffd\u8a18\n  menu label ^OCP Custom Install Ubuntu Server\n  kernel /install/vmlinuz\n  append file=/cdrom/preseed/ubuntu-ocp.seed initrd=/install/initrd.gz quiet --  ##\u3053\u3053\u307e\u3067\u8ffd\u8a18\n```\n\n```bash\n$ work/custom-iso/isolinux$ cd ..\n$ work/custom-iso$ cd preseed/\n$ work/custom-iso/preseed$ sudo vi ubuntu-zabbix.seed\n```\n\n\u4e0b\u8a18\u3001kickstart\u7528\u30d5\u30a1\u30a4\u30eb\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3044\u8a00\u8a9e\u30fb\u30ad\u30fc\u30dc\u30fc\u30c9\u7b49\u3092\u74b0\u5883\u306b\u3088\u3063\u3066\u5909\u3048\u3066\u304f\u3060\u3055\u3044\u3002\n\u53c2\u8003URL: https://help.ubuntu.com/community/InstallCDCustomization/PreseedExamples\n\n```text\n########################################################################\n#### Custom Preseed Amlin Europe using Ubiquity\n### By Kelly Crabb \u30c6\u30a5 for Amlin Europe\n### Tested on Ubuntu Trusty Thral 14.04 LTS\n####################################################################\n# General\n####################################################################\n# Once installation is complete, automatically power off.\nd-i finish-install/reboot_in_progress note\nd-i ubiquity/summary note\nubiquity ubiquity/reboot boolean true\nubiquity ubiquity/poweroff boolean false# Automatically download and install stable updates?\nunattended-upgrades unattended-upgrades/enable_auto_updates boolean false\n####################################################################\n# Installation Sources\n####################################################################\n# Configure the sources.list\nd-i mirror/country string JP\n#d-i mirror/http/hostname string archive.ubuntu.com\n#d-i mirror/http/directory string /ubuntu/\n#d-i apt-setup/use_mirror boolean true\n#d-i apt-setup/mirror/error select Change mirror\n#d-i apt-setup/multiverse boolean true\n#d-i apt-setup/restricted boolean true\n#d-i apt-setup/universe boolean true\n#d-i apt-setup/partner boolean true\n####################################################################\n# Networking\n####################################################################\n# Network Configuration\nd-i netcfg/enable boolean true\nd-i netcfg/choose_interface select eth0\n#d-i netcfg/disable_dhcp boolean false\n####################################################################\n# Disk Partitioning / Boot loader\n####################################################################\n### Disk Partitioning ###\n# Configure auto partitioner\nubiquity partman-auto/init_automatically_partition select Guided - use entire disk\nubiquity partman-auto/disk string /dev/sda\nubiquity partman-auto/method string regular\nubiquity partman-auto/choose_recipe select All files in one partition (recommended for new\nusers)\nubiquity partman/confirm_write_new_label boolean true\nubiquity partman/choose_partition select Finish partitioning and write changes to disk\nubiquity partman/confirm boolean true\n####################################################################\n# Localizations / Timezone\n####################################################################\n### Keyboard selection ###\nd-i keyboard-configuration/layoutcode string us\nd-i keyboard-configuration/variantcode string\n### Locale ###\nd-i debian-installer/locale string en_US\n### Timezone ###\nd-i time/zone select Asia/Tokyod-i clock-setup/utc boolean true\nd-i clock-setup/ntp boolean false\nd-i console-setup/ask_detect boolean false\nd-i console-setup/layoutcode string us\n#d-i localechooser/supported-locales multiselect nl_NL, nl_BE, fr_BE\n### OEM-Config\nd-i oem-config/enable boolean true\nd-i oem-config/remove boolean true\nd-i oem-config/remove_extras boolean false\nd-i oem-config/install-language-support boolean true\nd-i ubiquity/only-show-installable-languages boolean true\n####################################################################\n# User Creation\n####################################################################\n# Root User\nd-i passwd/root-login boolean true\n# Mortal User\nd-i passwd/auto-login boolean true\nd-i passwd/root-login boolean true\nd-i passwd/make-user boolean false\nd-i passwd/root-password password password\nd-i passwd/root-password-again password password\nd-i user-setup/allow-password-weak boolean true\nd-i user-setup/encrypt-home boolean false\n####################################################################\n# Some extras\n####################################################################\ntasksel tasksel/force-tasks string server\ntasksel tasksel/first multiselect zabbix-custom\n# installing languages\n# Language pack selection\nd-i pkgsel/language-packs multiselect en, jp\n# installing services\n# d-i pkgsel/include string openssh-server\n# Whether to upgrade packages after debootstrap.\n# Allowed values: none, safe-upgrade, full-upgrade\nd-i pkgsel/upgrade select none\n# Policy for applying updates. May be \"none\" (no automatic updates),\n#d-i pkgsel/update-policy select unattended-upgrades\n# By default, the system's locate database will be updated after the\n# installer has finished installing most packages. This may take a while, so\n# if you don't want it, you can set this to \"false\" to turn it off.\n#d-i pkgsel/updatedb boolean true\n# This command is run just before the install finishes, but when there is\n# still a usable /target directory. You can chroot to /target and use it\n# directly, or use the apt-install and in-target commands to easily install\n# packages and run commands in the target system.\n#d-i preseed/late_command string apt-install zsh; in-target chsh -s /bin/zsh# And now we REALLY run with it!!\n# deb install\nd-i preseed/late_command string in-target /bin/bash /media/cdrom/pool/extras/custom_install.sh\n```\n\n- \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308bdeb\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u53ce\u96c6\n  - \u30ed\u30fc\u30ab\u30eb\u306e\u30a2\u30fc\u30ab\u30a4\u30d6\u524a\u9664\n\n```bash\n$ sudo rm -rf /var/cache/apt/archives/\n```\n\n- zabbix-agent\u30ea\u30dd\u30b8\u30c8\u30ea\u767b\u9332\n\n```bash\n$ wget http://repo.zabbix.com/zabbix/2.2/ubuntu/pool/main/z/zabbix-release/zabbix-release_2.2-1+trusty_all.deb\n$ sudo dpkg -i zabbix-release_2.2-1+trusty_all.deb\n```\n\n- \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb(deb\u30d1\u30c3\u30b1\u30fc\u30b8\u53ce\u96c6)\n\n```bash\n$ sudo apt-get update\n$ sudo apt-get -y install zabbix-agent\n```\n\n- deb\u30d1\u30c3\u30b1\u30fc\u30b8\u683c\u7d0d\n\n```bash\n$ cd work/custom-iso/pool/\nwork/custom-iso/pool$ sudo mkdir extras\nwork/custom-iso/pool$ sudo cp -rp /var/cache/apt/archives/*.deb ./extras/\nwork/custom-iso/pool$ sudo vi extras/custom_install.sh\n```\n\nzabbix-agent\u3092\u81ea\u52d5\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u3001Server=XXXX/ServerActive=XXXX\u3092\u7d44\u307f\u66ff\u3048\u308b\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n```bash\n#!/bin/bash\n/usr/bin/dpkg -i /media/cdrom/pool/extras/*.deb\nmodprobe mei\nmodprobe dcmi\nsed -i\".org\" \\\n-e 's/# EnableRemoteCommands=0/EnableRemoteCommands=1/g' \\\n-e 's/^Server=127.0.0.1/Server=zabbix-server/g' \\\n-e 's/^ServerActive=127.0.0.1/ServerActive=zabbix-server/g' \\\n-e 's/^Hostname=/# Hostname=/g' \\\n-e 's/# HostnameItem=/HostnameItem=/g' \\\n-e 's/# HostMetadata=/HostMetadata=Agent STARTER/g' \\\n/etc/zabbix/zabbix_agentd.conf\n```\n\n```bash\nwork/custom-iso/pool$ sudo chmod g+x extras/custom_install.sh\nwork/custom-iso/pool$ cd ../..\nwork$ sudo mkdir -p custom-iso/dists/stable/extras/binary-amd64\nwork/custom-iso/pool$ sudo su -\n# cd /home/user/work/\nhome/user/work/custom-iso# pushd custom-iso\nhome/user/work/custom-iso# apt-ftparchive packages ./pool/extras/ > dists/stable/extras/binary-amd64/Packages\nhome/user/work/custom-iso# gzip -c ./dists/stable/extras/binary-amd64/Packages | tee ./dists/stable/extras/binary-amd64/Packages.gz > /dev/null\nhome/user/work/custom-iso# popd\nhome/user/work/custom-iso# exit\n```\n\n- ISO\u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\n\n```bash\nwork$ sudo apt-get install mkisofs\nwork$ sudo mkisofs -J -l -b isolinux/isolinux.bin -no-emul-boot -boot-load-size 4 -boot-info-\ntable -z -iso-level 4 -c isolinux/isolinux.cat -o ./ubuntu-zabbix-custom-amd64.iso custom-iso/\nwork$ ls\ncustom-iso iso original-iso ubuntu-zabbix-custom-amd64.iso\n```\n\n\u5b8c\u6210\u3057\u305f\u300cubuntu-zabbix-custom-amd64.iso\u300d\u3092\u4f7f\u7528\u3059\u308b\u4e8b\u3067zabbix-agent\u304c\u81ea\u52d5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n# \u304a\u307e\u3051\n\n## OCP\u306b\u3064\u3044\u3066\n\nOCP\u3068\u306f\u3001Open Compute Project\u306e\u7565\u79f0\u30672011\u5e744\u6708\u306bFacebook\u793e\u304c\u63d0\u5531\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\n\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\u4ed5\u69d8\u3092\u30aa\u30fc\u30d7\u30f3\u306b\u516c\u958b\u3057\u3001\u5168\u4f53\u306e\u30a2\u30a4\u30c7\u30a2\u3084\u30b9\u30da\u30c3\u30af\u7b49\u306e\u77e5\u7684\u8ca1\u7523\u3092\u5171\u6709\u3057\u3066\u3044\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u3001\u30b5\u30fc\u30d0\u30fb\u30b9\u30c8\u30ec\u30fc\u30b8\u30fb\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\u30fb\u30e9\u30c3\u30af\u30fb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30b9\u30a4\u30c3\u30c1\u7b49\u306e\u8a2d\u8a08\u304c\u516c\u958b\u3055\u308c\u308b\u4e8b\u3067\u9ad8\u52b9\u7387\u306a\u30c7\u30fc\u30bf\u30bb\u30f3\u30bf\u30fc\u304c\u51fa\u6765\u4e0a\u304c\u308a\u3001\u7701\u30a8\u30cd\u30fb\u30b3\u30b9\u30c8\u30c0\u30a6\u30f3\u304c\u56f3\u308c\u308b\u3068\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u3092\u66f8\u3044\u305f\u304d\u3063\u304b\u3051\u304cOCP\u306b\u3088\u308b\u3082\u306e\u3067\u3059\u3002\n\u8208\u5473\u3042\u308a\u307e\u3057\u305f\u3089\u4e0b\u8a18\u30b9\u30e9\u30a4\u30c9\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\nhttp://opencomputejapan.org/wp-content/uploads/2015/04/20150401-OCPJ-overview-16_91.pdf\n\n## cobbler\u3067\u3082\u51fa\u6765\u307e\u3059\n\n\u3044\u3061\u3044\u3061iso\u3092\u4f5c\u6210\u3059\u308b\u306e\u304c\u9762\u5012\u3068\u3044\u3046\u601d\u3044\u3082\u3042\u308b\u3067\u3057\u3087\u3046\u3002\n\u305d\u3046\u3044\u3063\u305f\u5834\u5408\u306fPXE\u30d6\u30fc\u30c8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3082\u624b\u6bb5\u306e\u4e00\u3064\u3067\u3059\u3002\ncobbler\u306fPXE\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3092\u4e00\u62ec\u3067\u7ba1\u7406\u3059\u308b\u4e8b\u304c\u53ef\u80fd\u306a\u306e\u3067\u3001\u662f\u975e\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002\nhttp://cobbler.github.io/\n", "tags": ["zabbix", "kickstart", "Ubuntu"]}