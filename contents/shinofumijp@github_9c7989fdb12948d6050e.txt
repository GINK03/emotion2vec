{"context": " More than 1 year has passed since last update.\u4ee5\u4e0b\u306edestroy_all_safely\u30e1\u30bd\u30c3\u30c9\u306e\u3088\u3046\u306b\u3001where\u6761\u4ef6\u3067\u8fd4\u3055\u308c\u308b\u30ec\u30b3\u30fc\u30c9\u306b\u4f5c\u7528\u3059\u308b\u30af\u30e9\u30b9\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u3092\u8003\u3048\u308b.\ndestroy_all_safely\u30e1\u30bd\u30c3\u30c9\u3067\u306feach\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u5404\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u51e6\u7406\u3092\u884c\u3046\u30e1\u30bd\u30c3\u30c9\u3068\u3059\u308b.\nclass User < ActiveRecord::Base\n  class << self\n    def call_singleton_method\n      User.where(id: [1, 2, 3]).destroy_all_safely\n    end\n  end\nend\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30af\u30e9\u30b9\u30e1\u30bd\u30c3\u30c9\u306b\u3059\u308b\u3068each\u304cundefined method for \u3068\u6012\u3089\u308c\u308b.\nclass User < ActiveRecord::Base\n  class << self\n    def destroy_all_sefely\n      each do |user| # => undefined method\n        # some processes to be safe\n      end\n    end\n  end\nend\n\n\n\u3044\u304f\u3064\u304b\u306e\u5b9f\u88c5\u65b9\u6cd5\u304c\u3042\u308b\u304cActiveRecord_Relation\u30af\u30e9\u30b9\u3092\u30aa\u30fc\u30d7\u30f3\u3057\u3066\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3059\u308b\u3068\u4e0a\u624b\u304f\u3044\u304f.\n\u3053\u308c\u306fUser.where(id: [1, 2, 3])\u3067\u8a55\u4fa1\u3055\u308c\u308b\u7d50\u679c\u304c\u3001User::ActiveRecord_Relation\u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u3089\u3067\u3042\u308b.\nUser.where(id: [1, 2, 3]).class # => User::ActiveRecord_Relation\n\nclass User < ActiveRecord::Base\n  class ActiveRecord_Relation\n    def destroy_all_safely\n      each do |user|\n        # it works\n      end\n    end\n  end\nend\n\n\n\u5225\u89e3\n\u30aa\u30fc\u30d7\u30f3\u30af\u30e9\u30b9\u304c\u4ef0\u3005\u3057\u3044\u3068\u3044\u3046\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30af\u30e9\u30b9\u30e1\u30bd\u30c3\u30c9\u5185\u3067all\u3092\u547c\u3076\u3053\u3068\u3067\u3082\u3067\u304d\u308b\nclass User < ActiveRecord::Base\n  class << self\n    def destroy_all_safely\n      all.each do |user|\n        # it works\n      end\n    end\n  end\nend\n\n\n\u4ee5\u4e0b\u306edestroy_all_safely\u30e1\u30bd\u30c3\u30c9\u306e\u3088\u3046\u306b\u3001where\u6761\u4ef6\u3067\u8fd4\u3055\u308c\u308b\u30ec\u30b3\u30fc\u30c9\u306b\u4f5c\u7528\u3059\u308b\u30af\u30e9\u30b9\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u3092\u8003\u3048\u308b.\ndestroy_all_safely\u30e1\u30bd\u30c3\u30c9\u3067\u306feach\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u5404\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u51e6\u7406\u3092\u884c\u3046\u30e1\u30bd\u30c3\u30c9\u3068\u3059\u308b.\n\n```ruby\nclass User < ActiveRecord::Base\n  class << self\n    def call_singleton_method\n      User.where(id: [1, 2, 3]).destroy_all_safely\n    end\n  end\nend\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30af\u30e9\u30b9\u30e1\u30bd\u30c3\u30c9\u306b\u3059\u308b\u3068each\u304cundefined method for <Class >\u3068\u6012\u3089\u308c\u308b.\n\n```ruby\nclass User < ActiveRecord::Base\n  class << self\n    def destroy_all_sefely\n      each do |user| # => undefined method\n        # some processes to be safe\n      end\n    end\n  end\nend\n\n```\n\n\u3044\u304f\u3064\u304b\u306e\u5b9f\u88c5\u65b9\u6cd5\u304c\u3042\u308b\u304cActiveRecord_Relation\u30af\u30e9\u30b9\u3092\u30aa\u30fc\u30d7\u30f3\u3057\u3066\u30e1\u30bd\u30c3\u30c9\u3092\u5b9a\u7fa9\u3059\u308b\u3068\u4e0a\u624b\u304f\u3044\u304f.\n\n\u3053\u308c\u306fUser.where(id: [1, 2, 3])\u3067\u8a55\u4fa1\u3055\u308c\u308b\u7d50\u679c\u304c\u3001User::ActiveRecord_Relation\u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u3089\u3067\u3042\u308b.\n\n```ruby\nUser.where(id: [1, 2, 3]).class # => User::ActiveRecord_Relation\n\nclass User < ActiveRecord::Base\n  class ActiveRecord_Relation\n    def destroy_all_safely\n      each do |user|\n        # it works\n      end\n    end\n  end\nend\n```\n\n## \u5225\u89e3\n\n\u30aa\u30fc\u30d7\u30f3\u30af\u30e9\u30b9\u304c\u4ef0\u3005\u3057\u3044\u3068\u3044\u3046\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30af\u30e9\u30b9\u30e1\u30bd\u30c3\u30c9\u5185\u3067all\u3092\u547c\u3076\u3053\u3068\u3067\u3082\u3067\u304d\u308b\n\n```ruby\nclass User < ActiveRecord::Base\n  class << self\n    def destroy_all_safely\n      all.each do |user|\n        # it works\n      end\n    end\n  end\nend\n```\n", "tags": ["active_record", "\u30e1\u30bf\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0", "Rails"]}