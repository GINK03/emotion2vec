{"context": "\n\n\u306f\u3058\u3081\u306b\n\u6700\u8fd1\u793e\u5185\u306e\u4e00\u90e8\u3067Slack\u3092\u4f7f\u3046\u3088\u3046\u306b\u306a\u308a\u3001BOT\u306b\u975e\u5e38\u306b\u8208\u5473\u304c\u3042\u308b\u4eba\u3067\u3059\u3002\n(\u4eca\u5ea6\u4eba\u5de5\u7121\u80fd\u4f5c\u308a\u305f\u3044\u3067\u3059\u306d\u3002)\n\u3053\u3068\u306e\u767a\u7aef\u304b\u3089\u8a71\u3059\u3068\u9577\u304f\u306a\u308b\u306e\u3067\u3084\u3081\u307e\u3057\u305f\u3002\n\n\u7de8\u96c6\u6a29\u9650\u306e\u306a\u3044\u4eba\u306bGoogle \u30b5\u30a4\u30c8\u306e\u5909\u66f4\u3092\u81ea\u52d5\u3067\u901a\u77e5\u3057\u305f\u3044\nGoogle Apps Script\u3067Slack\u306b\u6295\u7a3f\u3057\u305f\u3044\n\u3067\u3082\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u983c\u3089\u305a\u306b\u4f5c\u308a\u305f\u3044\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u305d\u3093\u306a\u6761\u4ef6\u306e\u4eba\u306b\u5f79\u7acb\u3064\u306f\u305a\u3067\u3059\u3002\n\n\u4eca\u56de\u4f5c\u308b\u3082\u306e\n\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\u3001Google\u30b5\u30a4\u30c8\u306e\u5909\u66f4\u901a\u77e5\u3092Slack\u306b\u6295\u7a3f\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u79c1\u304c\u4f5c\u3063\u305f\u306e\u306f\u3053\u3093\u306a\u611f\u3058\u306e\u3082\u306e\u3067\u3059\u3002\n(\u6240\u3005\u8f09\u305b\u3089\u308c\u306a\u3044\u90e8\u5206\u304c\u3042\u308b\u306e\u3067\u4f0f\u305b\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u5b9f\u969b\u306b\u306f\u67a0\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002)\n\n\u30da\u30fc\u30b8/\u30da\u30fc\u30b8\u30d1\u30b9\u90e8\u5206\u306b\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u5165\u308b\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3002\n\u30a2\u30a4\u30b3\u30f3\u306f\u8003\u3048\u308b\u306e\u304c\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\u672c\u8a18\u4e8b\u3067\u306f\u3053\u308c\u306e\u4f5c\u308a\u65b9\u3092\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u30b7\u30b9\u30c6\u30e0\u6982\u8981\nGoogle\u30b5\u30a4\u30c8\u306b\u306f\u591a\u5206API\u304c\u306a\u3044\u306e\u3067\u3001Google\u30b5\u30a4\u30c8\u304b\u3089\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092\u5b9a\u671f\u7684\u306bGoogle Apps Script(\u4ee5\u4e0bGAS)\u3067\u78ba\u8a8d\u3057Slack API\u3092\u7528\u3044\u3066Slack\u306b\u901a\u77e5\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001\u4e8b\u524d\u306bGoogle\u30b5\u30a4\u30c8\u304b\u3089\u5909\u66f4\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\u65b9\u6cd5\u304c\u308f\u304b\u3089\u306a\u3051\u308c\u3070\u4ee5\u4e0b\u3092\u8aad\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n\u30b5\u30a4\u30c8\u3084\u30da\u30fc\u30b8\u304c\u5909\u66f4\u3055\u308c\u305f\u3068\u304d\u306b\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b - \u30b5\u30a4\u30c8 \u30d8\u30eb\u30d7\n\u307e\u305f\u3001\u30e1\u30fc\u30eb\u306b\u3064\u3044\u3066\u306f\u672a\u8aad\u306e\u3082\u306e\u3092\u901a\u77e5\u5bfe\u8c61\u3068\u3057\u3001Slack\u306b\u901a\u77e5\u3057\u305f\u3089\u30b7\u30b9\u30c6\u30e0\u3067\u65e2\u8aad\u306b\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u306f\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\u3088\u3046\u306b\u3082\u3057\u307e\u3059\u3002\n\n\u4f5c\u6210\u624b\u9806\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\nToken\u3092\u53d6\u5f97\u3059\u308b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\n[\u30c6\u30b9\u30c8]GAS\u3092\u7528\u3044\u3066Slack\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3057\u3066\u307f\u308b\n[\u30c6\u30b9\u30c8]Slack\u306b\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3057\u3066\u307f\u308b\nGoogle\u30b5\u30a4\u30c8\u304b\u3089\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092GAS\u3067\u53d6\u5f97\u3059\u308b\n\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u304b\u3089\u5fc5\u8981\u306a\u60c5\u5831\u3092\u629c\u304d\u51fa\u3059\n\u30e1\u30fc\u30eb\u53d6\u5f97\u90e8\u5206\u3092\u66f8\u304d\u63db\u3048\u308b\n\u629c\u304d\u51fa\u3057\u305f\u60c5\u5831\u3092\u6574\u5f62\u3057\u3066Slack\u306b\u6295\u7a3f\u3059\u308b\n\u5b9f\u884c\u306b\u5931\u6557\u3057\u305f\u3089\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\n\n\n\u5909\u66f4\u901a\u77e5\u30b7\u30b9\u30c6\u30e0\u306e\u4f5c\u6210\n\n1. Token\u3092\u53d6\u5f97\u3059\u308b\nSlack API\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306b\u306fToken\u304c\u5fc5\u8981\u3067\u3059\u3002\nToken\u306f\u4ee5\u4e0b\u306e\u3068\u3053\u308d\u304b\u3089\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\nOAuth Tokens for Testing and Development | Slack\n\n2. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\nGAS\u5358\u4f53\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u30ed\u30b0\u3092\u6b8b\u3059\u305f\u3081\u306b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3082\u8003\u3048\u307e\u3057\u305f\u304c\u3001\u30a8\u30e9\u30fc\u6642\u306b\u81ea\u5206\u3078\u30e1\u30fc\u30eb\u3059\u308c\u3070\u554f\u984c\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u3002\n\n3. [\u30c6\u30b9\u30c8]GAS\u3092\u7528\u3044\u3066Slack\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3057\u3066\u307f\u308b\n\u305f\u3060\u9001\u308b\u3060\u3051\u306a\u3089\u3053\u3093\u306a\u611f\u3058\u3067\u3044\u3051\u307e\u3059\u3002\n\nSlack\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\nfunction postMessage() {\n  var token = \"\u53d6\u5f97\u3057\u305f\u30c8\u30fc\u30af\u30f3\";\n  var channel = \"bot-test\"; //\u6295\u7a3f\u5148\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n  var username = \"testbot\"; //BOT\u306e\u540d\u524d\n  var text = \"test\" //\u30e1\u30c3\u30bb\u30fc\u30b8\n  UrlFetchApp.fetch(\"https://slack.com/api/chat.postMessage?token=\" + token + \"&channel=%23\" + channel + \"&username=\" + username + \"&text=\" + text);\n}\n\n\n\u5b9f\u884c\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u6295\u7a3f\u3055\u308c\u307e\u3059\u3002\n(\u521d\u56de\u5b9f\u884c\u6642\u306e\u307f\u5916\u90e8\u63a5\u7d9a\u3092\u8a31\u53ef\u3059\u308b\u304b\u805e\u304b\u308c\u307e\u3059)\n\nAPI\u7d4c\u7531\u306e\u6295\u7a3f\u306fBOT\u6271\u3044\u306a\u306e\u3067\u3001\u540d\u524d\u306e\u6a2a\u306bBOT\u3068\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u4eca\u56de\u306f\u30a2\u30a4\u30b3\u30f3\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3059\u304c\u3001URL\u3092\u7528\u3044\u3066\u753b\u50cf\u3092\u6307\u5b9a\u3057\u305f\u308a\u3001Slack\u3067\u4f7f\u3048\u308b\u7d75\u6587\u5b57\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3093\u3067\u307f\u3066\u304f\u3060\u3055\u3044\u3002\nchat.postMessage method | Slack\n\n4. [\u30c6\u30b9\u30c8]Slack\u306b\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3057\u3066\u307f\u308b\n\u5148\u307b\u3069\u306e\u3084\u308a\u65b9\u3067\u306f\u30b7\u30f3\u30d7\u30eb\u3059\u304e\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u306a\u306e\u3067\u3001\u5185\u5bb9\u306e\u6295\u7a3f\u306f\u3067\u304d\u307e\u3059\u304c\u30ea\u30f3\u30af\u306fURL\u3079\u305f\u66f8\u304d\u3067\u3057\u304b\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u3053\u3067\u4e0a\u8a18\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3093\u3067\u3044\u305f\u3068\u3053\u308d\u3001attachments\u3068\u8a00\u3046\u306e\u3092\u898b\u3064\u3051\u307e\u3057\u305f\u3002\n\u3068\u3066\u3082\u6c17\u306b\u306a\u3063\u305f\u306e\u3067\u8abf\u3079\u305f\u3068\u3053\u308d\u3001\u305d\u308c\u3092\u4f7f\u3048\u3070\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30ea\u30c3\u30c1\u306b\u3067\u304d\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\u3061\u3087\u3046\u3069\u4f3c\u305f\u3088\u3046\u306a\u3053\u3068\u3092\u3084\u3063\u3066\u3044\u308b\u8a18\u4e8b\u3082\u3042\u308a\u307e\u3057\u305f\u3002\nGAS\u3067\u76e3\u8996\u30e1\u30fc\u30eb\u3092Slack\u306b\u6d41\u3059 - Sanwa Systems Tech Blog\n\u305d\u3061\u3089\u3082\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u79c1\u306e\u66f8\u304d\u65b9\u304c\u60aa\u3044\u306e\u304b\u305d\u306e\u307e\u307e\u3067\u306fattachments\u304c\u7121\u8996\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\u8a66\u884c\u932f\u8aa4\u3057\u305f\u7d50\u679c\u3001\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3067\u304d\u307e\u3057\u305f\u3002\n\u7d30\u304b\u304f\u5909\u6570\u306b\u5206\u3051\u308b\u5fc5\u8981\u306f\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3068\u308a\u3042\u3048\u305aJSON.stringify()\u306fattachement\u306e\u307f\u304c\u3044\u3044\u3088\u3046\u3067\u3059\u3002\n\nSlack\u306b\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\nfunction postRichMessage(message) {\n  var token = \"\u53d6\u5f97\u3057\u305f\u30c8\u30fc\u30af\u30f3\";\n  var channel = \"bot-test\"; //\u6295\u7a3f\u5148\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n  var username = \"testbot\"; //BOT\u306e\u540d\u524d\n  var text = \"\u3053\u3061\u3089\u306fGAS\u3092\u7528\u3044\u3066\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u30c6\u30b9\u30c8\u3067\u3059\"; //\u30e1\u30c3\u30bb\u30fc\u30b8\n  var attachments = JSON.stringify([\n      {\n        color: \"#89CEEB\", //\u30a4\u30f3\u30c7\u30f3\u30c8\u7dda\u306e\u8272\n        pretext: \"pretext : \" + text, //\u305d\u306e\u5916\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\n        author_name: \"author_name : sakaguchi\",//\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u8457\u8005\u540d\n        author_link: \"http://google.co.jp/\",//\u305d\u306e\u30ea\u30f3\u30af\n        title: \"title : \" + text,//\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u30bf\u30a4\u30c8\u30eb\n        title_link: \"https://google.co.jp/\",//\u305d\u306e\u30ea\u30f3\u30af\n        text: \"attachments-text : *\u30ea\u30f3\u30af\u5148\u306fGoogle\u3067\u3059\" //\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u30c6\u30b9\u30c8\n      }\n    ]);\n  var payload = {\n    \"channel\" : channel, //\u901a\u77e5\u5148\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n    \"text\" : \"text : \" + text, //\u9001\u4fe1\u30c6\u30ad\u30b9\u30c8\n    \"username\": username, //BOT\u306e\u540d\u524d\n    \"attachments\": attachments //\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308b\u7528\u30c7\u30fc\u30bf\n  };\n  var option = {\n    \"method\" : \"POST\", //POST\u9001\u4fe1\n    \"payload\" : payload //POST\u30c7\u30fc\u30bf\n  };\n  UrlFetchApp.fetch(\"https://slack.com/api/chat.postMessage?token=\" + token, option);\n}\n\n\n\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30c6\u30b9\u30c8\u306e\u305f\u3081\u306b\u540c\u3058\u6587\u9762\u3092\u4f7f\u3044\u307e\u308f\u3057\u305f\u306e\u30673\u3064\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u30ea\u30c3\u30c1\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3061\u306a\u307f\u306b\u3001Slack\u304b\u3089\u901a\u77e5\u306b\u8868\u793a\u3055\u308c\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u306fattachments\u3058\u3083\u306a\u3044\u65b9\u306etext\u306b\u66f8\u3044\u305f\u5185\u5bb9\u306e\u307f\u306e\u3088\u3046\u3067\u3059\u3002\n\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u6319\u52d5\u78ba\u8a8d\u306f\u3053\u3061\u3089\u3067\u3067\u304d\u307e\u3059\u3002\nFormatting | Slack\nJSON\u5f62\u5f0f\u3067\u5b9a\u7fa9\u3059\u308b\u306e\u304c\u30bb\u30aa\u30ea\u30fc\u306e\u3088\u3046\u3067\u3059\u3002\n\n5. Google\u30b5\u30a4\u30c8\u304b\u3089\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092GAS\u3067\u53d6\u5f97\u3059\u308b\nGAS\u306b\u3042\u308bGmailApp\u3092\u7528\u3044\u3066\u672a\u8aad\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n2016/04/22 \u30b9\u30ec\u30c3\u30c9\u306e\u53d6\u5f97\u9806\u304c\u65b0\u3057\u3044\u9806\u3060\u3063\u305f\u306e\u3067\u3001\u53e4\u3044\u9806\u306b\u306a\u308b\u3088\u3046\u4fee\u6b63\n\n\u672a\u8aad\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092GAS\u3067\u53d6\u5f97\u3059\u308b\nfunction getUnreadNotificationMail() {\n  var unReadThreads = GmailApp.search(\"from:noreply@google.com is:unread\");\n  for (var n = unReadThreads.length -1; n >= 0; n--){\n    var mails = unReadThreads[n].getMessages();\n    mails.forEach(function(mail, index, array){\n      if (mail.isUnread()){\n        /*\u3053\u3053\u3067\u672a\u8aad\u306e\u30e1\u30fc\u30eb\u3092\u5143\u306bSlack\u306b\u901a\u77e5\u3057\u305f\u308a\u3059\u308b\n        * \u8a73\u3057\u304f\u306f\u5f8c\u8ff0*/\n      }\n    });\n  }\n}\n\n\n(\u521d\u56de\u5b9f\u884c\u6642\u306e\u307f\u30e1\u30fc\u30eb\u64cd\u4f5c\u3092\u8a31\u53ef\u3059\u308b\u304b\u805e\u304b\u308c\u307e\u3059)\nsearch\u95a2\u6570\u306e\u7b2c\u4e00\u5f15\u6570\u306fGMail\u306e\u691c\u7d22\u6b04\u3068\u540c\u69d8\u306e\u66f8\u304d\u65b9\u304c\u3067\u304d\u307e\u3059\u3002\n\u4e0a\u306e\u30b3\u30fc\u30c9\u3067\u306ffrom\u3067\u691c\u7d22\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u5b9f\u969b\u4f7f\u3063\u3066\u3044\u308b\u30b3\u30fc\u30c9\u306f\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u306b\u3088\u308a\u30e9\u30d9\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3067\u691c\u7d22\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u4ed6\u8aac\u660e\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3093\u3067\u304f\u3060\u3055\u3044\u3002\nClass GmailApp \u00a0|\u00a0 Apps Script \u00a0|\u00a0 Google Developers\n\u3059\u3067\u306b\u30cd\u30b9\u30c8\u304c\u6df1\u3044\u3088\u3046\u306b\u601d\u3044\u307e\u3059\u304c\u3001\u624b\u629c\u304d\u3067\u3053\u306e\u307e\u307e\u884c\u304d\u307e\u3059\u3002\n(\u5206\u3051\u305f\u3068\u304d\u306b\u3069\u3046\u3044\u3046\u540d\u524d\u306b\u3059\u308c\u3070\u3044\u3044\u304b\u60a9\u3080\u3001\u3068\u3044\u3046\u306e\u3082\u3042\u308a\u307e\u3059\u304c\u3002)\n\n6. \u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u304b\u3089\u5fc5\u8981\u306a\u60c5\u5831\u3092\u629c\u304d\u51fa\u3059\n\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u306f\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb(\u4e00\u90e8)\n\u4ef6\u540d\n[\u30b5\u30a4\u30c8\u540d] \u30da\u30fc\u30b8 \u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\n\u672c\u6587\n\u540d\u524d \u3055\u3093\u304c\u30da\u30fc\u30b8 \u30da\u30fc\u30b8\u30d1\u30b9 \u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002\u4e0b\u8a18\u306e\u5909\u66f4\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30ab\u30e9\u30fc \u30ad\u30fc: \u633f\u5165 | \u524a\u9664\n\n\nGoogle\u30b5\u30a4\u30c8\u304b\u3089\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u306f\u305d\u306e\u4e0b\u306b\u3042\u308b\u5dee\u5206\u8868\u793a\u304c\u4fbf\u5229\u3060\u3068\u611f\u3058\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u3092Slack\u306b\u6295\u7a3f\u3059\u308b\u306e\u306f\u9762\u5012\u306a\u306e\u3067\u672c\u30b7\u30b9\u30c6\u30e0\u3067\u306f\u672c\u6587\u306e\u300c\u301c\u3057\u307e\u3057\u305f\u3002\u300d\u307e\u3067\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n(Slack\u304chtml\u5f62\u5f0f\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308c\u3070\u5dee\u5206\u8868\u793a\u3082\u697d\u306a\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fb)\n\u672c\u6587\u306f\u6b21\u306e\u3088\u3046\u306ahtml\u5f62\u5f0f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u672c\u6587(\u4e00\u90e8)\n<p>\n        \u540d\u524d \u3055\u3093\u304c\u30da\u30fc\u30b8 <a href=\"http://sites.google.com/a/\u4ee5\u4e0b\u7565\" target=\"_blank\">\u30da\u30fc\u30b8\u30d1\u30b9</a> \u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002\u4e0b\u8a18\u306e\u5909\u66f4\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n        <p>\u30ab\u30e9\u30fc \u30ad\u30fc:\n          <span style=\"background-color:yellow;border:1px dotted;text-decoration:none\">\u633f\u5165</span> |\n          <span style=\"color:red;text-decoration:line-through\">\u524a\u9664</span>\n        </p>\n\n\n\u3053\u306e\u30e1\u30fc\u30eb\u304b\u3089\u901a\u77e5\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\n\u62bd\u51fa\u3057\u305f\u60c5\u5831\u3092\u623b\u308a\u5024\u306b\u3057\u305f\u3044\u306e\u3067\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n\u60c5\u5831\u62bd\u51fa\nfunction extractBody(body) {\n  if (body.indexOf(\"\u3057\u307e\u3057\u305f\") == -1) {\n    /*\u7570\u306a\u308b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u30e1\u30fc\u30eb\u304c\u5c4a\u3044\u305f\u3053\u3068\u3092\u30e1\u30fc\u30eb\n    \u8a73\u3057\u304f\u306f\u5f8c\u8ff0*/\n    sendNewFormat(body);\n    return null;\n  }\n  //\u672c\u6587\u304b\u3089\u5fc5\u8981\u306a\u7bc4\u56f2\u3092\u53d6\u308a\u51fa\u3059\n  return body.substring(0,body.indexOf(\"\u3057\u307e\u3057\u305f\") + \"\u3057\u307e\u3057\u305f\".length);\n}\n\nfunction createItems(mail) {\n  var message = extractBody(mail.getBody());\n  if (message == null) {\n    return null;\n  }\n  //\u901a\u77e5\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3092\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u307e\u3068\u3081\u308b\n  var items = {};\n  items.text = mail.getSubject().substring(\"[\u30b5\u30a4\u30c8\u540d] \".length) + \"\\r\" + mail.getDate().toLocaleString(); //\u5e74/\u6708/\u65e5 \u6642:\u5206:\u79d2 JST\u5f62\u5f0f\u306b\u306a\u308b\n  items.author_name = message.substring(message.indexOf(\">\") + 1, message.indexOf(\"\u3055\u3093\") + \"\u3055\u3093\".length);\n  items.title = message.substring(message.indexOf(\">\", 80) + 1, message.indexOf(\"<\", 80)) + message.substring(message.lastIndexOf(\"\u3092\"));\n  items.title_link = message.substring(message.indexOf(\"http\"), message.indexOf(\"\\\"\", message.indexOf(\"http\")));\n  return items;\n}\n\n\n\u62bd\u51fa\u3082\u307e\u3068\u3081\u308b\u90e8\u5206\u3082\u307b\u307c\u6c7a\u3081\u6253\u3061\u3067\u3059\u304c\u3001\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u306f\u6c7a\u307e\u3063\u305f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u9001\u3089\u308c\u3066\u304f\u308b\u3088\u3046\u306a\u306e\u3067\u554f\u984c\u306a\u3044\u3067\u3059\u3002\n(\u666e\u901a\u306a\u3089\u6b63\u898f\u8868\u73fe\u306a\u3069\u3092\u7528\u3044\u3066\u3044\u3044\u611f\u3058\u306b\u66f8\u304f\u3093\u3060\u3068\u601d\u3046\u3093\u3067\u3059\u3051\u3069\u3001\u79c1\u306f\u6b63\u898f\u8868\u73fe\u82e6\u624b\u306a\u306e\u3067\u3002)\nitems.title\u90e8\u5206\u306b\u3042\u308b80\u3068\u3044\u3046\u6570\u5b57\u306f\u3001<p>\u540d\u524d \u3055\u3093\u304c\u30da\u30fc\u30b8 <a href=\"http://sites.google.com/a/\u4ee5\u4e0b\u7565\"\u3042\u305f\u308a\u304c80\u6587\u5b57\u3060\u3063\u305f\u304b\u3089\u3067\u3059\u3002\n\u305d\u306ea\u30bf\u30b0\u306e>\u306e\u4f4d\u7f6e\u3092\u77e5\u308b\u305f\u3081\u306b80\u4ee5\u964d\u304b\u3089\u63a2\u3057\u3066\u3082\u3089\u3046\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u30b5\u30a4\u30c8\u540d\u306e\u90e8\u5206\u3082\u305d\u3046\u3067\u3059\u304c\u3001\u30e1\u30fc\u30eb\u306b\u5fdc\u3058\u3066\u9069\u5b9c\u8abf\u6574\u3057\u3066\u304f\u3060\u3044\u3002\n\n7. \u30e1\u30fc\u30eb\u53d6\u5f97\u90e8\u5206\u3092\u66f8\u304d\u63db\u3048\u308b\n5\u3067\u53d6\u5f97\u3057\u305f\u672a\u8aad\u30e1\u30fc\u30eb\u3092\u5148\u307b\u3069\u306ecreateItems\u95a2\u6570\u306b\u6e21\u3057\u3066\u60c5\u5831\u3092\u62bd\u51fa\u3057\u3066\u3082\u3089\u3044\u3001\u305d\u308c\u3092\u5f8c\u8ff0\u306epostNotice\u95a2\u6570\u306b\u6e21\u3057\u3066\u901a\u77e5\u3057\u3066\u3082\u3089\u3046\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\n\u30e1\u30fc\u30eb\u53d6\u5f97\u90e8\u5206\nfunction getUnreadNotificationMail() {\n  var unReadThreads = GmailApp.search(\"from:noreply@google.com is:unread\");\n  unReadThreads.forEach(function(unReadThread, index, array) {\n    var mails = unReadThread.getMessages();\n    mails.forEach(function(mail, index, array){\n      if (mail.isUnread()){\n        var items = createItems(mail);\n        if (items != null) {\n          /*Slack\u306b\u6295\u7a3f\u3057\u3066\u7d50\u679c\u3092\u53d7\u3051\u53d6\u308b\n          * \u6295\u7a3f\u90e8\u5206\u306f\u5f8c\u8ff0*/\n          var result = JSON.parse(postNotice(items));\n          if (result.ok) {\n            mail.markRead();\n          } else {\n            /*\u6295\u7a3f\u306b\u5931\u6557\u3057\u305f\u3053\u3068\u3092\u30e1\u30fc\u30eb\u3059\u308b\n            * \u8a73\u3057\u304f\u306f\u5f8c\u8ff0*/\n            sendFaild(result);\n          }\n        }\n      }\n    });\n  });\n}\n\n\npostNotice\u95a2\u6570\u306f\u6295\u7a3f\u7d50\u679c\u3092\u623b\u308a\u5024\u306b\u3059\u308b\u3088\u3046\u306b\u8a2d\u8a08\u3057\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u6295\u7a3f\u306b\u6210\u529f\u3059\u308b\u3068Slack API\u3088\u308a\u6b21\u306e\u3088\u3046\u306aJSON\u304c\u53d6\u5f97\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u306eok\u90e8\u5206\u3067\u6210\u529f\u3068\u5931\u6557\u3092\u5224\u5225\u3057\u3001\u5f8c\u8ff0\u306esendFaild\u95a2\u6570\u3067\u5931\u6557\u3092\u30e1\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\u6295\u7a3f\u6210\u529f\n{channel=\u30c1\u30e3\u30f3\u30cd\u30ebID, ok=true, message=\u6295\u7a3f\u30c7\u30fc\u30bf}\n\n\n\n8. \u629c\u304d\u51fa\u3057\u305f\u60c5\u5831\u3092\u6574\u5f62\u3057\u3066Slack\u306b\u6295\u7a3f\u3059\u308b\nposetMessage\u95a2\u6570\u306f4\u306b\u66f8\u3044\u305f\u95a2\u6570\u3068\u4f3c\u305f\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u304c\u3001\u5148\u307b\u3069\u4f5c\u6210\u3057\u305fitems\u3092\u5143\u306b\u3057\u3066Slack\u306b\u6295\u7a3f\u3057\u307e\u3059\u3002\n\n\u6574\u5f62\u3057\u3066Slack\u306b\u6295\u7a3f\nfunction postMessage(items) {\n  var token = \"\u53d6\u5f97\u3057\u305f\u30c8\u30fc\u30af\u30f3\";\n  var channel = \"\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\";\n  var username = \"\u30b5\u30a4\u30c8\u540d\u5909\u66f4\u901a\u77e5\u30b7\u30b9\u30c6\u30e0\"; //BOT\u306e\u540d\u524d\n  var attachments = JSON.stringify([\n      {\n        color: \"#89CEEB\", //\u30a4\u30f3\u30c7\u30f3\u30c8\u7dda\u306e\u8272\n        author_name: items.author_name,\u3000//\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u8457\u8005\u540d\n        title: items.title ,//\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u30bf\u30a4\u30c8\u30eb\n        title_link: items.title_link,//\u305d\u306e\u30ea\u30f3\u30af\n        text: \"\u4e0a\u8a18\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u5bfe\u8c61\u306e\u30da\u30fc\u30b8\u3084\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3057\u307e\u3059\u3002\" //\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u30c6\u30ad\u30b9\u30c8\n      }\n    ]);\n  var payload = {\n    \"channel\" : channel, //\u901a\u77e5\u5148\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n    \"text\" : items.text, //\u9001\u4fe1\u30c6\u30ad\u30b9\u30c8\n    \"username\": username, //BOT\u306e\u540d\u524d\n    \"attachments\": attachments //\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308b\u7528\u30c7\u30fc\u30bf\n  };\n  var option = {\n    \"method\" : \"POST\", \n    \"payload\" : payload\n  };\n  return UrlFetchApp.fetch(\"https://slack.com/api/chat.postMessage?token=\" + token, option);\n}\n\n\n\u6295\u7a3f\u3055\u308c\u308b\u306e\u306f\u4eca\u56de\u4f5c\u308b\u3082\u306e\u306b\u66f8\u3044\u305f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\u3002\n\n\n8. \u5b9f\u884c\u306b\u5931\u6557\u3057\u305f\u3089\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\n\u3082\u3057\u4f55\u3089\u304b\u306e\u7406\u7531\u3067\u5b9f\u884c\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u306f\u305d\u306e\u65e8\u3092\u30e1\u30fc\u30eb\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u9001\u4fe1\nfunction sendFaild(result) {\n  sendMail(\"\u901a\u77e5\u306e\u6295\u7a3f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\", result);\n}\n\nfunction sendNewFormat(body) {\n  sendMail(\"\u65b0\u3057\u3044\u5f62\u5f0f\u304c\u3042\u3063\u305f\u3088\u3046\u3067\u3059\u3002\", body);\n}\n\nfunction sendMail(subject, message) {\n  var mailAddress = \"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\";\n  var body = \"\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\";\n  GmailApp.sendEmail(mailAddress<img width=\"852\" alt=\"\u30c8\u30ea\u30ab\u3099\u30fc.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/76523/4e48086a-a640-e066-4c4a-12703b5e4fa9.png\">\n, subject, body);\n}\n\n\n\u3053\u308c+\u30c8\u30ea\u30ac\u30fc\u306e\u5b9f\u884c\u5931\u6557\u30e1\u30fc\u30eb\u306b\u3088\u308a\u3001\u3082\u3057\u30b7\u30b9\u30c6\u30e0\u304c\u4e0a\u624b\u304f\u3044\u304b\u306a\u304f\u3066\u3082\u6c17\u304c\u4ed8\u304d\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\n9. \u30c8\u30ea\u30ac\u30fc\u3092\u4f5c\u6210\u3059\u308b\n\u6700\u5f8c\u306b\u81ea\u52d5\u3067\u30b7\u30b9\u30c6\u30e0\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306e\u30c8\u30ea\u30ac\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u6b8b\u5ff5\u306a\u304c\u3089\u30e1\u30fc\u30eb\u304c\u5c4a\u3044\u305f\u6642\u3068\u3044\u3046\u6761\u4ef6\u306f\u306a\u3044\u306e\u3067\u30011\u6642\u9593\u3054\u3068\u306b\u5b9f\u884c\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u3057\u3066\u3082\u3089\u3046\u306e\u306fgetUnreadNotificationMail\u95a2\u6570\u3067\u3059\u3002\n\n\n\u7d42\u308f\u308a\u306b\n\u8aac\u660e\u4e0b\u624b\u306a\u90e8\u5206\u3082\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u30b3\u30fc\u30c9\u306f\u307b\u307c\u30b3\u30d4\u30da\u3067\u52d5\u304f\u3068\u601d\u3044\u307e\u3059\u3002\n\u3082\u3057\u5206\u304b\u3089\u306a\u3044\u90e8\u5206\u306a\u3069\u304c\u3042\u308c\u3070\u9060\u616e\u305b\u305a\u30b3\u30e1\u30f3\u30c8\u304f\u3060\u3055\u3044\u3002\nQiita\u306b\u66f8\u3053\u3046\u3068\u601d\u3063\u3066\u4e0b\u66f8\u304d\u6b62\u307e\u308a\u306a\u3082\u306e\u304c\u5e7e\u3064\u304b\u3042\u308b\u306e\u3067\u3001\u3044\u3064\u304b\u305d\u308c\u3089\u3082\u8a18\u4e8b\u3068\u3057\u3066\u6295\u7a3f\u3057\u305f\u3044\u3067\u3059\u3002\n\n\u53c2\u8003\n\u672c\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308b\u305f\u3081\u306b\u4e0b\u8a18\u30da\u30fc\u30b8\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\nSlack API\u3092\u4f7f\u7528\u3057\u3066\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b - Qiita\nSlack WebAPI\u3067\u30ca\u30a4\u30b9\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308b - \u30cf\u30a6\u30c6\u30ec\u30d3\u30b8\u30e7\u30f3\u958b\u767a\u8005\u30d6\u30ed\u30b0\nGAS\u3067\u76e3\u8996\u30e1\u30fc\u30eb\u3092Slack\u306b\u6d41\u3059 - Sanwa Systems Tech Blog\nchat.postMessage method | Slack\nMessage Attachments | Slack\nFormatting | Slack\nClass GmailApp \u00a0|\u00a0 Apps Script \u00a0|\u00a0 Google Developers\n# \u306f\u3058\u3081\u306b\n\u6700\u8fd1\u793e\u5185\u306e\u4e00\u90e8\u3067Slack\u3092\u4f7f\u3046\u3088\u3046\u306b\u306a\u308a\u3001BOT\u306b\u975e\u5e38\u306b\u8208\u5473\u304c\u3042\u308b\u4eba\u3067\u3059\u3002\n(\u4eca\u5ea6\u4eba\u5de5\u7121\u80fd\u4f5c\u308a\u305f\u3044\u3067\u3059\u306d\u3002)\n\u3053\u3068\u306e\u767a\u7aef\u304b\u3089\u8a71\u3059\u3068\u9577\u304f\u306a\u308b\u306e\u3067\u3084\u3081\u307e\u3057\u305f\u3002\n\n- \u7de8\u96c6\u6a29\u9650\u306e\u306a\u3044\u4eba\u306bGoogle \u30b5\u30a4\u30c8\u306e\u5909\u66f4\u3092\u81ea\u52d5\u3067\u901a\u77e5\u3057\u305f\u3044\n- Google Apps Script\u3067Slack\u306b\u6295\u7a3f\u3057\u305f\u3044\n- \u3067\u3082\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u983c\u3089\u305a\u306b\u4f5c\u308a\u305f\u3044\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u305d\u3093\u306a\u6761\u4ef6\u306e\u4eba\u306b\u5f79\u7acb\u3064\u306f\u305a\u3067\u3059\u3002\n\n# \u4eca\u56de\u4f5c\u308b\u3082\u306e\n\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\u3001Google\u30b5\u30a4\u30c8\u306e\u5909\u66f4\u901a\u77e5\u3092Slack\u306b\u6295\u7a3f\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u79c1\u304c\u4f5c\u3063\u305f\u306e\u306f\u3053\u3093\u306a\u611f\u3058\u306e\u3082\u306e\u3067\u3059\u3002\n(\u6240\u3005\u8f09\u305b\u3089\u308c\u306a\u3044\u90e8\u5206\u304c\u3042\u308b\u306e\u3067\u4f0f\u305b\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u5b9f\u969b\u306b\u306f\u67a0\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002)\n![\u5b8c\u6210\u54c1.png](https://qiita-image-store.s3.amazonaws.com/0/76523/099dd390-6be4-ff03-979f-e9c2e68acedd.png)\n\u30da\u30fc\u30b8/\u30da\u30fc\u30b8\u30d1\u30b9\u90e8\u5206\u306b\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u5165\u308b\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3002\n\u30a2\u30a4\u30b3\u30f3\u306f\u8003\u3048\u308b\u306e\u304c\u9762\u5012\u3060\u3063\u305f\u306e\u3067\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\u672c\u8a18\u4e8b\u3067\u306f\u3053\u308c\u306e\u4f5c\u308a\u65b9\u3092\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u30b7\u30b9\u30c6\u30e0\u6982\u8981\n\nGoogle\u30b5\u30a4\u30c8\u306b\u306f\u591a\u5206API\u304c\u306a\u3044\u306e\u3067\u3001Google\u30b5\u30a4\u30c8\u304b\u3089\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092\u5b9a\u671f\u7684\u306bGoogle Apps Script(\u4ee5\u4e0bGAS)\u3067\u78ba\u8a8d\u3057Slack API\u3092\u7528\u3044\u3066Slack\u306b\u901a\u77e5\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001\u4e8b\u524d\u306bGoogle\u30b5\u30a4\u30c8\u304b\u3089\u5909\u66f4\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\u65b9\u6cd5\u304c\u308f\u304b\u3089\u306a\u3051\u308c\u3070\u4ee5\u4e0b\u3092\u8aad\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n[\u30b5\u30a4\u30c8\u3084\u30da\u30fc\u30b8\u304c\u5909\u66f4\u3055\u308c\u305f\u3068\u304d\u306b\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308b - \u30b5\u30a4\u30c8 \u30d8\u30eb\u30d7](https://support.google.com/sites/answer/90597?hl=ja)\n\u307e\u305f\u3001\u30e1\u30fc\u30eb\u306b\u3064\u3044\u3066\u306f\u672a\u8aad\u306e\u3082\u306e\u3092\u901a\u77e5\u5bfe\u8c61\u3068\u3057\u3001Slack\u306b\u901a\u77e5\u3057\u305f\u3089\u30b7\u30b9\u30c6\u30e0\u3067\u65e2\u8aad\u306b\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u306f\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\u3088\u3046\u306b\u3082\u3057\u307e\u3059\u3002\n\n# \u4f5c\u6210\u624b\u9806\n\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u8aac\u660e\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n1. Token\u3092\u53d6\u5f97\u3059\u308b\n2. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\n3. [\u30c6\u30b9\u30c8]GAS\u3092\u7528\u3044\u3066Slack\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3057\u3066\u307f\u308b\n4. [\u30c6\u30b9\u30c8]Slack\u306b\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3057\u3066\u307f\u308b\n5. Google\u30b5\u30a4\u30c8\u304b\u3089\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092GAS\u3067\u53d6\u5f97\u3059\u308b\n6. \u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u304b\u3089\u5fc5\u8981\u306a\u60c5\u5831\u3092\u629c\u304d\u51fa\u3059\n7. \u30e1\u30fc\u30eb\u53d6\u5f97\u90e8\u5206\u3092\u66f8\u304d\u63db\u3048\u308b\n8. \u629c\u304d\u51fa\u3057\u305f\u60c5\u5831\u3092\u6574\u5f62\u3057\u3066Slack\u306b\u6295\u7a3f\u3059\u308b\n9. \u5b9f\u884c\u306b\u5931\u6557\u3057\u305f\u3089\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\n\n# \u5909\u66f4\u901a\u77e5\u30b7\u30b9\u30c6\u30e0\u306e\u4f5c\u6210\n\n## 1. Token\u3092\u53d6\u5f97\u3059\u308b\nSlack API\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u306b\u306fToken\u304c\u5fc5\u8981\u3067\u3059\u3002\nToken\u306f\u4ee5\u4e0b\u306e\u3068\u3053\u308d\u304b\u3089\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n[OAuth Tokens for Testing and Development | Slack](https://api.slack.com/docs/oauth-test-tokens)\n\n## 2. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3059\u308b\nGAS\u5358\u4f53\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u30ed\u30b0\u3092\u6b8b\u3059\u305f\u3081\u306b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3082\u8003\u3048\u307e\u3057\u305f\u304c\u3001\u30a8\u30e9\u30fc\u6642\u306b\u81ea\u5206\u3078\u30e1\u30fc\u30eb\u3059\u308c\u3070\u554f\u984c\u306a\u3055\u305d\u3046\u306a\u306e\u3067\u3002\n\n## 3. [\u30c6\u30b9\u30c8]GAS\u3092\u7528\u3044\u3066Slack\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3057\u3066\u307f\u308b\n\u305f\u3060\u9001\u308b\u3060\u3051\u306a\u3089\u3053\u3093\u306a\u611f\u3058\u3067\u3044\u3051\u307e\u3059\u3002\n\n```js:Slack\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\nfunction postMessage() {\n  var token = \"\u53d6\u5f97\u3057\u305f\u30c8\u30fc\u30af\u30f3\";\n  var channel = \"bot-test\"; //\u6295\u7a3f\u5148\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n  var username = \"testbot\"; //BOT\u306e\u540d\u524d\n  var text = \"test\" //\u30e1\u30c3\u30bb\u30fc\u30b8\n  UrlFetchApp.fetch(\"https://slack.com/api/chat.postMessage?token=\" + token + \"&channel=%23\" + channel + \"&username=\" + username + \"&text=\" + text);\n}\n```\n\n\u5b9f\u884c\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u6295\u7a3f\u3055\u308c\u307e\u3059\u3002\n(\u521d\u56de\u5b9f\u884c\u6642\u306e\u307f\u5916\u90e8\u63a5\u7d9a\u3092\u8a31\u53ef\u3059\u308b\u304b\u805e\u304b\u308c\u307e\u3059)\n![\u305f\u305f\u3099\u6295\u7a3f\u3059\u308b.png](https://qiita-image-store.s3.amazonaws.com/0/76523/42d7e246-383d-d88b-38ac-5055b00d7664.png)\n\nAPI\u7d4c\u7531\u306e\u6295\u7a3f\u306fBOT\u6271\u3044\u306a\u306e\u3067\u3001\u540d\u524d\u306e\u6a2a\u306b`BOT`\u3068\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u4eca\u56de\u306f\u30a2\u30a4\u30b3\u30f3\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3059\u304c\u3001URL\u3092\u7528\u3044\u3066\u753b\u50cf\u3092\u6307\u5b9a\u3057\u305f\u308a\u3001Slack\u3067\u4f7f\u3048\u308b\u7d75\u6587\u5b57\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u8a73\u3057\u304f\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3093\u3067\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n[chat.postMessage method | Slack](https://api.slack.com/methods/chat.postMessage)\n\n## 4. [\u30c6\u30b9\u30c8]Slack\u306b\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3057\u3066\u307f\u308b\n\u5148\u307b\u3069\u306e\u3084\u308a\u65b9\u3067\u306f\u30b7\u30f3\u30d7\u30eb\u3059\u304e\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u306a\u306e\u3067\u3001\u5185\u5bb9\u306e\u6295\u7a3f\u306f\u3067\u304d\u307e\u3059\u304c\u30ea\u30f3\u30af\u306fURL\u3079\u305f\u66f8\u304d\u3067\u3057\u304b\u3067\u304d\u307e\u305b\u3093\u3002\n\u305d\u3053\u3067\u4e0a\u8a18\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3093\u3067\u3044\u305f\u3068\u3053\u308d\u3001`attachments`\u3068\u8a00\u3046\u306e\u3092\u898b\u3064\u3051\u307e\u3057\u305f\u3002\n\u3068\u3066\u3082\u6c17\u306b\u306a\u3063\u305f\u306e\u3067\u8abf\u3079\u305f\u3068\u3053\u308d\u3001\u305d\u308c\u3092\u4f7f\u3048\u3070\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u30ea\u30c3\u30c1\u306b\u3067\u304d\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\u3061\u3087\u3046\u3069\u4f3c\u305f\u3088\u3046\u306a\u3053\u3068\u3092\u3084\u3063\u3066\u3044\u308b\u8a18\u4e8b\u3082\u3042\u308a\u307e\u3057\u305f\u3002\n[GAS\u3067\u76e3\u8996\u30e1\u30fc\u30eb\u3092Slack\u306b\u6d41\u3059 - Sanwa Systems Tech Blog](http://tech.sanwasystem.com/entry/2015/04/28/143541)\n\u305d\u3061\u3089\u3082\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u79c1\u306e\u66f8\u304d\u65b9\u304c\u60aa\u3044\u306e\u304b\u305d\u306e\u307e\u307e\u3067\u306fattachments\u304c\u7121\u8996\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u3002\n\u8a66\u884c\u932f\u8aa4\u3057\u305f\u7d50\u679c\u3001\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\u3067\u304d\u307e\u3057\u305f\u3002\n\u7d30\u304b\u304f\u5909\u6570\u306b\u5206\u3051\u308b\u5fc5\u8981\u306f\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3068\u308a\u3042\u3048\u305a`JSON.stringify()`\u306fattachement\u306e\u307f\u304c\u3044\u3044\u3088\u3046\u3067\u3059\u3002\n\n```js:Slack\u306b\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6295\u7a3f\nfunction postRichMessage(message) {\n  var token = \"\u53d6\u5f97\u3057\u305f\u30c8\u30fc\u30af\u30f3\";\n  var channel = \"bot-test\"; //\u6295\u7a3f\u5148\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n  var username = \"testbot\"; //BOT\u306e\u540d\u524d\n  var text = \"\u3053\u3061\u3089\u306fGAS\u3092\u7528\u3044\u3066\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b\u30c6\u30b9\u30c8\u3067\u3059\"; //\u30e1\u30c3\u30bb\u30fc\u30b8\n  var attachments = JSON.stringify([\n      {\n        color: \"#89CEEB\", //\u30a4\u30f3\u30c7\u30f3\u30c8\u7dda\u306e\u8272\n        pretext: \"pretext : \" + text, //\u305d\u306e\u5916\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\n        author_name: \"author_name : sakaguchi\",//\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u8457\u8005\u540d\n        author_link: \"http://google.co.jp/\",//\u305d\u306e\u30ea\u30f3\u30af\n        title: \"title : \" + text,//\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u30bf\u30a4\u30c8\u30eb\n        title_link: \"https://google.co.jp/\",//\u305d\u306e\u30ea\u30f3\u30af\n        text: \"attachments-text : *\u30ea\u30f3\u30af\u5148\u306fGoogle\u3067\u3059\" //\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u30c6\u30b9\u30c8\n      }\n    ]);\n  var payload = {\n    \"channel\" : channel, //\u901a\u77e5\u5148\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n    \"text\" : \"text : \" + text, //\u9001\u4fe1\u30c6\u30ad\u30b9\u30c8\n    \"username\": username, //BOT\u306e\u540d\u524d\n    \"attachments\": attachments //\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308b\u7528\u30c7\u30fc\u30bf\n  };\n  var option = {\n    \"method\" : \"POST\", //POST\u9001\u4fe1\n    \"payload\" : payload //POST\u30c7\u30fc\u30bf\n  };\n  UrlFetchApp.fetch(\"https://slack.com/api/chat.postMessage?token=\" + token, option);\n}\n```\n\n\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n<img width=\"593\" alt=\"\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b7\u3099\u3092\u6295\u7a3f.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/76523/89680a62-b3b1-2c39-db34-79ed520fd4ca.png\">\n\u30c6\u30b9\u30c8\u306e\u305f\u3081\u306b\u540c\u3058\u6587\u9762\u3092\u4f7f\u3044\u307e\u308f\u3057\u305f\u306e\u30673\u3064\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u30ea\u30c3\u30c1\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3061\u306a\u307f\u306b\u3001Slack\u304b\u3089\u901a\u77e5\u306b\u8868\u793a\u3055\u308c\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\u306fattachments\u3058\u3083\u306a\u3044\u65b9\u306etext\u306b\u66f8\u3044\u305f\u5185\u5bb9\u306e\u307f\u306e\u3088\u3046\u3067\u3059\u3002\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u6319\u52d5\u78ba\u8a8d\u306f\u3053\u3061\u3089\u3067\u3067\u304d\u307e\u3059\u3002\n[Formatting | Slack](https://api.slack.com/docs/formatting/builder?msg=%7B%22text%22%3A%22I%20am%20a%20test%20message%20http%3A%2F%2Fslack.com%22%2C%22attachments%22%3A%5B%7B%22text%22%3A%22And%20here%27s%20an%20attachment!%22%7D%5D%7D)\nJSON\u5f62\u5f0f\u3067\u5b9a\u7fa9\u3059\u308b\u306e\u304c\u30bb\u30aa\u30ea\u30fc\u306e\u3088\u3046\u3067\u3059\u3002\n\n## 5. Google\u30b5\u30a4\u30c8\u304b\u3089\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092GAS\u3067\u53d6\u5f97\u3059\u308b\n\nGAS\u306b\u3042\u308bGmailApp\u3092\u7528\u3044\u3066\u672a\u8aad\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n**2016/04/22 \u30b9\u30ec\u30c3\u30c9\u306e\u53d6\u5f97\u9806\u304c\u65b0\u3057\u3044\u9806\u3060\u3063\u305f\u306e\u3067\u3001\u53e4\u3044\u9806\u306b\u306a\u308b\u3088\u3046\u4fee\u6b63**\n\n```js:\u672a\u8aad\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u3092GAS\u3067\u53d6\u5f97\u3059\u308b\nfunction getUnreadNotificationMail() {\n  var unReadThreads = GmailApp.search(\"from:noreply@google.com is:unread\");\n  for (var n = unReadThreads.length -1; n >= 0; n--){\n    var mails = unReadThreads[n].getMessages();\n    mails.forEach(function(mail, index, array){\n      if (mail.isUnread()){\n        /*\u3053\u3053\u3067\u672a\u8aad\u306e\u30e1\u30fc\u30eb\u3092\u5143\u306bSlack\u306b\u901a\u77e5\u3057\u305f\u308a\u3059\u308b\n        * \u8a73\u3057\u304f\u306f\u5f8c\u8ff0*/\n      }\n    });\n  }\n}\n```\n\n(\u521d\u56de\u5b9f\u884c\u6642\u306e\u307f\u30e1\u30fc\u30eb\u64cd\u4f5c\u3092\u8a31\u53ef\u3059\u308b\u304b\u805e\u304b\u308c\u307e\u3059)\nsearch\u95a2\u6570\u306e\u7b2c\u4e00\u5f15\u6570\u306fGMail\u306e\u691c\u7d22\u6b04\u3068\u540c\u69d8\u306e\u66f8\u304d\u65b9\u304c\u3067\u304d\u307e\u3059\u3002\n\u4e0a\u306e\u30b3\u30fc\u30c9\u3067\u306ffrom\u3067\u691c\u7d22\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u5b9f\u969b\u4f7f\u3063\u3066\u3044\u308b\u30b3\u30fc\u30c9\u306f\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u306b\u3088\u308a\u30e9\u30d9\u30eb\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3067\u691c\u7d22\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u306e\u4ed6\u8aac\u660e\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u8aad\u3093\u3067\u304f\u3060\u3055\u3044\u3002\n[Class GmailApp \u00a0|\u00a0 Apps Script \u00a0|\u00a0 Google Developers](https://developers.google.com/apps-script/reference/gmail/gmail-app#methods)\n\u3059\u3067\u306b\u30cd\u30b9\u30c8\u304c\u6df1\u3044\u3088\u3046\u306b\u601d\u3044\u307e\u3059\u304c\u3001\u624b\u629c\u304d\u3067\u3053\u306e\u307e\u307e\u884c\u304d\u307e\u3059\u3002\n(\u5206\u3051\u305f\u3068\u304d\u306b\u3069\u3046\u3044\u3046\u540d\u524d\u306b\u3059\u308c\u3070\u3044\u3044\u304b\u60a9\u3080\u3001\u3068\u3044\u3046\u306e\u3082\u3042\u308a\u307e\u3059\u304c\u3002)\n\n## 6. \u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u304b\u3089\u5fc5\u8981\u306a\u60c5\u5831\u3092\u629c\u304d\u51fa\u3059\n\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u306f\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```text:\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb(\u4e00\u90e8)\n\u4ef6\u540d\n[\u30b5\u30a4\u30c8\u540d] \u30da\u30fc\u30b8 \u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\n\u672c\u6587\n\u540d\u524d \u3055\u3093\u304c\u30da\u30fc\u30b8 \u30da\u30fc\u30b8\u30d1\u30b9 \u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002\u4e0b\u8a18\u306e\u5909\u66f4\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30ab\u30e9\u30fc \u30ad\u30fc: \u633f\u5165 | \u524a\u9664\n```\n\nGoogle\u30b5\u30a4\u30c8\u304b\u3089\u306e\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u306f\u305d\u306e\u4e0b\u306b\u3042\u308b\u5dee\u5206\u8868\u793a\u304c\u4fbf\u5229\u3060\u3068\u611f\u3058\u3066\u3044\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u3092Slack\u306b\u6295\u7a3f\u3059\u308b\u306e\u306f\u9762\u5012\u306a\u306e\u3067\u672c\u30b7\u30b9\u30c6\u30e0\u3067\u306f\u672c\u6587\u306e\u300c\u301c\u3057\u307e\u3057\u305f\u3002\u300d\u307e\u3067\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n(Slack\u304chtml\u5f62\u5f0f\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308c\u3070\u5dee\u5206\u8868\u793a\u3082\u697d\u306a\u306e\u3067\u3059\u304c\u30fb\u30fb\u30fb)\n\u672c\u6587\u306f\u6b21\u306e\u3088\u3046\u306ahtml\u5f62\u5f0f\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```html:\u672c\u6587(\u4e00\u90e8)\n<p>\n        \u540d\u524d \u3055\u3093\u304c\u30da\u30fc\u30b8 <a href=\"http://sites.google.com/a/\u4ee5\u4e0b\u7565\" target=\"_blank\">\u30da\u30fc\u30b8\u30d1\u30b9</a> \u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\u3002\u4e0b\u8a18\u306e\u5909\u66f4\u5185\u5bb9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n        <p>\u30ab\u30e9\u30fc \u30ad\u30fc:\n          <span style=\"background-color:yellow;border:1px dotted;text-decoration:none\">\u633f\u5165</span> |\n          <span style=\"color:red;text-decoration:line-through\">\u524a\u9664</span>\n        </p>\n```\n\n\u3053\u306e\u30e1\u30fc\u30eb\u304b\u3089\u901a\u77e5\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\n\u62bd\u51fa\u3057\u305f\u60c5\u5831\u3092\u623b\u308a\u5024\u306b\u3057\u305f\u3044\u306e\u3067\u3001\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n```js:\u60c5\u5831\u62bd\u51fa\nfunction extractBody(body) {\n  if (body.indexOf(\"\u3057\u307e\u3057\u305f\") == -1) {\n    /*\u7570\u306a\u308b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u30e1\u30fc\u30eb\u304c\u5c4a\u3044\u305f\u3053\u3068\u3092\u30e1\u30fc\u30eb\n    \u8a73\u3057\u304f\u306f\u5f8c\u8ff0*/\n    sendNewFormat(body);\n    return null;\n  }\n  //\u672c\u6587\u304b\u3089\u5fc5\u8981\u306a\u7bc4\u56f2\u3092\u53d6\u308a\u51fa\u3059\n  return body.substring(0,body.indexOf(\"\u3057\u307e\u3057\u305f\") + \"\u3057\u307e\u3057\u305f\".length);\n}\n\nfunction createItems(mail) {\n  var message = extractBody(mail.getBody());\n  if (message == null) {\n    return null;\n  }\n  //\u901a\u77e5\u306b\u5fc5\u8981\u306a\u60c5\u5831\u3092\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u307e\u3068\u3081\u308b\n  var items = {};\n  items.text = mail.getSubject().substring(\"[\u30b5\u30a4\u30c8\u540d] \".length) + \"\\r\" + mail.getDate().toLocaleString(); //\u5e74/\u6708/\u65e5 \u6642:\u5206:\u79d2 JST\u5f62\u5f0f\u306b\u306a\u308b\n  items.author_name = message.substring(message.indexOf(\">\") + 1, message.indexOf(\"\u3055\u3093\") + \"\u3055\u3093\".length);\n  items.title = message.substring(message.indexOf(\">\", 80) + 1, message.indexOf(\"<\", 80)) + message.substring(message.lastIndexOf(\"\u3092\"));\n  items.title_link = message.substring(message.indexOf(\"http\"), message.indexOf(\"\\\"\", message.indexOf(\"http\")));\n  return items;\n}\n```\n\n\u62bd\u51fa\u3082\u307e\u3068\u3081\u308b\u90e8\u5206\u3082\u307b\u307c\u6c7a\u3081\u6253\u3061\u3067\u3059\u304c\u3001\u5909\u66f4\u901a\u77e5\u30e1\u30fc\u30eb\u306f\u6c7a\u307e\u3063\u305f\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u9001\u3089\u308c\u3066\u304f\u308b\u3088\u3046\u306a\u306e\u3067\u554f\u984c\u306a\u3044\u3067\u3059\u3002\n(\u666e\u901a\u306a\u3089\u6b63\u898f\u8868\u73fe\u306a\u3069\u3092\u7528\u3044\u3066\u3044\u3044\u611f\u3058\u306b\u66f8\u304f\u3093\u3060\u3068\u601d\u3046\u3093\u3067\u3059\u3051\u3069\u3001\u79c1\u306f\u6b63\u898f\u8868\u73fe\u82e6\u624b\u306a\u306e\u3067\u3002)\n`items.title`\u90e8\u5206\u306b\u3042\u308b80\u3068\u3044\u3046\u6570\u5b57\u306f\u3001`<p>\u540d\u524d \u3055\u3093\u304c\u30da\u30fc\u30b8 <a href=\"http://sites.google.com/a/\u4ee5\u4e0b\u7565\"`\u3042\u305f\u308a\u304c80\u6587\u5b57\u3060\u3063\u305f\u304b\u3089\u3067\u3059\u3002\n\u305d\u306ea\u30bf\u30b0\u306e`>`\u306e\u4f4d\u7f6e\u3092\u77e5\u308b\u305f\u3081\u306b80\u4ee5\u964d\u304b\u3089\u63a2\u3057\u3066\u3082\u3089\u3046\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n`\u30b5\u30a4\u30c8\u540d`\u306e\u90e8\u5206\u3082\u305d\u3046\u3067\u3059\u304c\u3001\u30e1\u30fc\u30eb\u306b\u5fdc\u3058\u3066\u9069\u5b9c\u8abf\u6574\u3057\u3066\u304f\u3060\u3044\u3002\n\n## 7. \u30e1\u30fc\u30eb\u53d6\u5f97\u90e8\u5206\u3092\u66f8\u304d\u63db\u3048\u308b\n5\u3067\u53d6\u5f97\u3057\u305f\u672a\u8aad\u30e1\u30fc\u30eb\u3092\u5148\u307b\u3069\u306e`createItems`\u95a2\u6570\u306b\u6e21\u3057\u3066\u60c5\u5831\u3092\u62bd\u51fa\u3057\u3066\u3082\u3089\u3044\u3001\u305d\u308c\u3092\u5f8c\u8ff0\u306e`postNotice`\u95a2\u6570\u306b\u6e21\u3057\u3066\u901a\u77e5\u3057\u3066\u3082\u3089\u3046\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u307e\u3059\u3002\n\n```js:\u30e1\u30fc\u30eb\u53d6\u5f97\u90e8\u5206\nfunction getUnreadNotificationMail() {\n  var unReadThreads = GmailApp.search(\"from:noreply@google.com is:unread\");\n  unReadThreads.forEach(function(unReadThread, index, array) {\n    var mails = unReadThread.getMessages();\n    mails.forEach(function(mail, index, array){\n      if (mail.isUnread()){\n        var items = createItems(mail);\n        if (items != null) {\n          /*Slack\u306b\u6295\u7a3f\u3057\u3066\u7d50\u679c\u3092\u53d7\u3051\u53d6\u308b\n          * \u6295\u7a3f\u90e8\u5206\u306f\u5f8c\u8ff0*/\n          var result = JSON.parse(postNotice(items));\n          if (result.ok) {\n            mail.markRead();\n          } else {\n            /*\u6295\u7a3f\u306b\u5931\u6557\u3057\u305f\u3053\u3068\u3092\u30e1\u30fc\u30eb\u3059\u308b\n            * \u8a73\u3057\u304f\u306f\u5f8c\u8ff0*/\n            sendFaild(result);\n          }\n        }\n      }\n    });\n  });\n}\n```\n\n`postNotice`\u95a2\u6570\u306f\u6295\u7a3f\u7d50\u679c\u3092\u623b\u308a\u5024\u306b\u3059\u308b\u3088\u3046\u306b\u8a2d\u8a08\u3057\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u6295\u7a3f\u306b\u6210\u529f\u3059\u308b\u3068Slack API\u3088\u308a\u6b21\u306e\u3088\u3046\u306aJSON\u304c\u53d6\u5f97\u3067\u304d\u308b\u306e\u3067\u3001\u305d\u306eok\u90e8\u5206\u3067\u6210\u529f\u3068\u5931\u6557\u3092\u5224\u5225\u3057\u3001\u5f8c\u8ff0\u306e`sendFaild`\u95a2\u6570\u3067\u5931\u6557\u3092\u30e1\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```json:\u6295\u7a3f\u6210\u529f\n{channel=\u30c1\u30e3\u30f3\u30cd\u30ebID, ok=true, message=\u6295\u7a3f\u30c7\u30fc\u30bf}\n```\n\n## 8. \u629c\u304d\u51fa\u3057\u305f\u60c5\u5831\u3092\u6574\u5f62\u3057\u3066Slack\u306b\u6295\u7a3f\u3059\u308b\n`posetMessage`\u95a2\u6570\u306f4\u306b\u66f8\u3044\u305f\u95a2\u6570\u3068\u4f3c\u305f\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u304c\u3001\u5148\u307b\u3069\u4f5c\u6210\u3057\u305fitems\u3092\u5143\u306b\u3057\u3066Slack\u306b\u6295\u7a3f\u3057\u307e\u3059\u3002\n\n```js:\u6574\u5f62\u3057\u3066Slack\u306b\u6295\u7a3f\nfunction postMessage(items) {\n  var token = \"\u53d6\u5f97\u3057\u305f\u30c8\u30fc\u30af\u30f3\";\n  var channel = \"\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\";\n  var username = \"\u30b5\u30a4\u30c8\u540d\u5909\u66f4\u901a\u77e5\u30b7\u30b9\u30c6\u30e0\"; //BOT\u306e\u540d\u524d\n  var attachments = JSON.stringify([\n      {\n        color: \"#89CEEB\", //\u30a4\u30f3\u30c7\u30f3\u30c8\u7dda\u306e\u8272\n        author_name: items.author_name,\u3000//\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u8457\u8005\u540d\n        title: items.title ,//\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u30bf\u30a4\u30c8\u30eb\n        title_link: items.title_link,//\u305d\u306e\u30ea\u30f3\u30af\n        text: \"\u4e0a\u8a18\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u5bfe\u8c61\u306e\u30da\u30fc\u30b8\u3084\u30d5\u30a1\u30a4\u30eb\u3092\u8868\u793a\u3057\u307e\u3059\u3002\" //\u30a4\u30f3\u30c7\u30f3\u30c8\u5185\u306b\u8868\u793a\u3055\u308c\u308b\u30c6\u30ad\u30b9\u30c8\n      }\n    ]);\n  var payload = {\n    \"channel\" : channel, //\u901a\u77e5\u5148\u30c1\u30e3\u30f3\u30cd\u30eb\u540d\n    \"text\" : items.text, //\u9001\u4fe1\u30c6\u30ad\u30b9\u30c8\n    \"username\": username, //BOT\u306e\u540d\u524d\n    \"attachments\": attachments //\u30ea\u30c3\u30c1\u306a\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308b\u7528\u30c7\u30fc\u30bf\n  };\n  var option = {\n    \"method\" : \"POST\", \n    \"payload\" : payload\n  };\n  return UrlFetchApp.fetch(\"https://slack.com/api/chat.postMessage?token=\" + token, option);\n}\n```\n\n\u6295\u7a3f\u3055\u308c\u308b\u306e\u306f\u4eca\u56de\u4f5c\u308b\u3082\u306e\u306b\u66f8\u3044\u305f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\u3002\n![\u5b8c\u6210\u54c1.png](https://qiita-image-store.s3.amazonaws.com/0/76523/099dd390-6be4-ff03-979f-e9c2e68acedd.png)\n\n## 8. \u5b9f\u884c\u306b\u5931\u6557\u3057\u305f\u3089\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\n\u3082\u3057\u4f55\u3089\u304b\u306e\u7406\u7531\u3067\u5b9f\u884c\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u306f\u305d\u306e\u65e8\u3092\u30e1\u30fc\u30eb\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```js:\u30a8\u30e9\u30fc\u30e1\u30fc\u30eb\u9001\u4fe1\nfunction sendFaild(result) {\n  sendMail(\"\u901a\u77e5\u306e\u6295\u7a3f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\", result);\n}\n\nfunction sendNewFormat(body) {\n  sendMail(\"\u65b0\u3057\u3044\u5f62\u5f0f\u304c\u3042\u3063\u305f\u3088\u3046\u3067\u3059\u3002\", body);\n}\n\nfunction sendMail(subject, message) {\n  var mailAddress = \"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\";\n  var body = \"\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\";\n  GmailApp.sendEmail(mailAddress<img width=\"852\" alt=\"\u30c8\u30ea\u30ab\u3099\u30fc.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/76523/4e48086a-a640-e066-4c4a-12703b5e4fa9.png\">\n, subject, body);\n}\n```\n\n\u3053\u308c+\u30c8\u30ea\u30ac\u30fc\u306e\u5b9f\u884c\u5931\u6557\u30e1\u30fc\u30eb\u306b\u3088\u308a\u3001\u3082\u3057\u30b7\u30b9\u30c6\u30e0\u304c\u4e0a\u624b\u304f\u3044\u304b\u306a\u304f\u3066\u3082\u6c17\u304c\u4ed8\u304d\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002\n\n## 9. \u30c8\u30ea\u30ac\u30fc\u3092\u4f5c\u6210\u3059\u308b\n\u6700\u5f8c\u306b\u81ea\u52d5\u3067\u30b7\u30b9\u30c6\u30e0\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u306e\u30c8\u30ea\u30ac\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u6b8b\u5ff5\u306a\u304c\u3089`\u30e1\u30fc\u30eb\u304c\u5c4a\u3044\u305f\u6642`\u3068\u3044\u3046\u6761\u4ef6\u306f\u306a\u3044\u306e\u3067\u3001`1\u6642\u9593\u3054\u3068`\u306b\u5b9f\u884c\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u5b9f\u884c\u3057\u3066\u3082\u3089\u3046\u306e\u306f`getUnreadNotificationMail`\u95a2\u6570\u3067\u3059\u3002\n<img width=\"852\" alt=\"\u30c8\u30ea\u30ab\u3099\u30fc.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/76523/48985da7-d0ee-82b5-7962-70e37ece4b5e.png\">\n\n\n# \u7d42\u308f\u308a\u306b\n\u8aac\u660e\u4e0b\u624b\u306a\u90e8\u5206\u3082\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u30b3\u30fc\u30c9\u306f\u307b\u307c\u30b3\u30d4\u30da\u3067\u52d5\u304f\u3068\u601d\u3044\u307e\u3059\u3002\n\u3082\u3057\u5206\u304b\u3089\u306a\u3044\u90e8\u5206\u306a\u3069\u304c\u3042\u308c\u3070\u9060\u616e\u305b\u305a\u30b3\u30e1\u30f3\u30c8\u304f\u3060\u3055\u3044\u3002\n\nQiita\u306b\u66f8\u3053\u3046\u3068\u601d\u3063\u3066\u4e0b\u66f8\u304d\u6b62\u307e\u308a\u306a\u3082\u306e\u304c\u5e7e\u3064\u304b\u3042\u308b\u306e\u3067\u3001\u3044\u3064\u304b\u305d\u308c\u3089\u3082\u8a18\u4e8b\u3068\u3057\u3066\u6295\u7a3f\u3057\u305f\u3044\u3067\u3059\u3002\n\n# \u53c2\u8003\n\u672c\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u308b\u305f\u3081\u306b\u4e0b\u8a18\u30da\u30fc\u30b8\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n[Slack API\u3092\u4f7f\u7528\u3057\u3066\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3059\u308b - Qiita](http://qiita.com/rubytomato@github/items/6558bfdb37d982891c09)\n[Slack WebAPI\u3067\u30ca\u30a4\u30b9\u306a\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u308b - \u30cf\u30a6\u30c6\u30ec\u30d3\u30b8\u30e7\u30f3\u958b\u767a\u8005\u30d6\u30ed\u30b0](http://blog.howtelevision.co.jp/entry/2015/04/09/124032)\n[GAS\u3067\u76e3\u8996\u30e1\u30fc\u30eb\u3092Slack\u306b\u6d41\u3059 - Sanwa Systems Tech Blog](http://tech.sanwasystem.com/entry/2015/04/28/143541)\n[chat.postMessage method | Slack](https://api.slack.com/methods/chat.postMessage)\n[Message Attachments | Slack](https://api.slack.com/docs/attachments)\n[Formatting | Slack](https://api.slack.com/docs/formatting/builder?msg=%7B%22attachments%22%3A%5B%7B%22fallback%22%3A%22Required%20plain-text%20summary%20of%20the%20attachment.%22%2C%22color%22%3A%22%2336a64f%22%2C%22pretext%22%3A%22Optional%20text%20that%20appears%20above%20the%20attachment%20block%22%2C%22author_name%22%3A%22Bobby%20Tables%22%2C%22author_link%22%3A%22http%3A%2F%2Fflickr.com%2Fbobby%2F%22%2C%22author_icon%22%3A%22http%3A%2F%2Fflickr.com%2Ficons%2Fbobby.jpg%22%2C%22title%22%3A%22Slack%20API%20Documentation%22%2C%22title_link%22%3A%22https%3A%2F%2Fapi.slack.com%2F%22%2C%22text%22%3A%22Optional%20text%20that%20appears%20within%20the%20attachment%22%2C%22fields%22%3A%5B%7B%22title%22%3A%22Priority%22%2C%22value%22%3A%22High%22%2C%22short%22%3Afalse%7D%5D%2C%22image_url%22%3A%22http%3A%2F%2Fmy-website.com%2Fpath%2Fto%2Fimage.jpg%22%2C%22thumb_url%22%3A%22http%3A%2F%2Fexample.com%2Fpath%2Fto%2Fthumb.png%22%7D%5D%7D)\n[Class GmailApp \u00a0|\u00a0 Apps Script \u00a0|\u00a0 Google Developers](https://developers.google.com/apps-script/reference/gmail/gmail-app#methods)\n", "tags": ["GoogleAppsScript", "Slack"]}