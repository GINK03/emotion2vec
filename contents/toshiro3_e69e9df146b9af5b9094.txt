{"tags": ["Subversion"], "context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nsubversion\u306epost-commit\u30d5\u30c3\u30af\u3067\u66f4\u65b0\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\ntrunk\u306b\u30b3\u30df\u30c3\u30c8\u3055\u308c\u305f\u3068\u304d\u3060\u3051\u3001XXX\u3057\u305f\u3044\u306e\u3088\u3046\u306a\u8981\u671b\u306b\u5bfe\u5fdc\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n\u74b0\u5883\n\nAmazon Linux AMI release 2014.03\nsubversion 1.8.8\n\n\nsubversion\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install subversion\n\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u4f5c\u6210\n$ svnadmin create sample\n$ svn mkdir file:///path/to/repository/trunk \\\n    file:///path/to/repository/branches      \\\n    file:///path/to/repository/tags          \\\n    -m 'create trunk,branches,tags'\n\n\npost-commit\u30d5\u30c3\u30af\u3092\u6709\u52b9\u306b\u3059\u308b\n$ cp -p /path/to/repository/hooks/post-commit.tmpl /path/to/repository/hooks/post-commit\n\n\u203b post-commit\u306b\u5b9f\u884c\u6a29\u9650\u304c\u3064\u3044\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n$ ls -l /path/to/repository/hooks/post-commit\n-rwxrwxr-x 1 ec2-user ec2-user 2062 Aug 25 21:57 /home/ec2-user/repos/svn/sample2/hooks/post-commit\n\n\n\u66f4\u65b0\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3059\u308b\nsvnlook\u30b3\u30de\u30f3\u30c9\u3067\u66f4\u65b0\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\npost-commit\u30d5\u30c3\u30af\u306e\u5f15\u6570\u3084svnlook\u30b3\u30de\u30f3\u30c9\u306e\u51fa\u529b\u3092\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3078\u8a18\u9332\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\npost-commit\n#!/bin/sh\n\nREPOS=\"$1\"\nREV=\"$2\"\nTXN_NAME=\"$3\"\n\necho \"$REPOS $REV $TXN_NAME\" >> path/to/logfile\nsvnlook changed -r $REV $REPOS >> /path/to/logfile\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u3059\u308b\n$ svn checkout file:///path/to/repository/trunk sample-trunk\n\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\u3078\u5909\u66f4\u3092\u30b3\u30df\u30c3\u30c8\u3059\u308b\n$ cd sample-trunk\n$ touch sample.txt sample2.txt sample3.txt\n$ svn add *\nA    sample2.txt\nA    sample3.txt\nA    sample.txt\n$ svn commit -m 'add sample files.'\nAdding sample.txt\nAdding sample2.txt\nAdding sample3.txt\nTransmitting file data ...\nCommitted revision 3.\n\n\u203b post-commit\u30d5\u30c3\u30af\u306b\u3088\u308b\u51fa\u529b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n$ cat /path/to/logfile\n/path/to/repository 3 2-2\nA    trunk/sample.txt\nA    trunk/sample2.txt\nA    trunk/sample3.txt\n\n\u203b branch\u304b\u3089\u3082\u30b3\u30df\u30c3\u30c8\u3057\u3066\u307f\u307e\u3059\u3002\n$ svn copy file:///path/to/repsitory/trunk file:///path/to/repository/branches/b1 -m 'create b1 branch'\n$ cd ../\n$ svn checkout file:///path/to/repository/branches/b1 sample-branches\n$ cd sample-branches\n$ hostname > sample.txt\n$ touch sample4.txt\n$ svn rm sample3.txt\n$ svn add sample4.txt\n$ svn commit -m 'modify sample.txt, delete sample3.txt and add sample4.txt'\nSending    sample.txt\nDeleting   sample3.txt\nAdding     sample4.txt\nTransmitting file data ..\nCommitted revision 5.\n$ cat /path/to/logfile\n...(\u7701\u7565)...\n/path/to/repository 5 4-4\nU    branches/b1/sample.txt\nD    branches/b1/sample3.txt\nA    branches/b1/sample4.txt\n\n\n## \u306f\u3058\u3081\u306b\n\nsubversion\u306epost-commit\u30d5\u30c3\u30af\u3067\u66f4\u65b0\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3059\u308b\u65b9\u6cd5\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\ntrunk\u306b\u30b3\u30df\u30c3\u30c8\u3055\u308c\u305f\u3068\u304d\u3060\u3051\u3001XXX\u3057\u305f\u3044\u306e\u3088\u3046\u306a\u8981\u671b\u306b\u5bfe\u5fdc\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n## \u74b0\u5883\n\n* Amazon Linux AMI release 2014.03\n* subversion 1.8.8\n\n## subversion\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell\n$ sudo yum install subversion\n```\n\n## \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u4f5c\u6210\n\n```shell\n$ svnadmin create sample\n$ svn mkdir file:///path/to/repository/trunk \\\n    file:///path/to/repository/branches      \\\n    file:///path/to/repository/tags          \\\n    -m 'create trunk,branches,tags'\n```\n\n## post-commit\u30d5\u30c3\u30af\u3092\u6709\u52b9\u306b\u3059\u308b\n\n```shell\n$ cp -p /path/to/repository/hooks/post-commit.tmpl /path/to/repository/hooks/post-commit\n```\n\n\u203b post-commit\u306b\u5b9f\u884c\u6a29\u9650\u304c\u3064\u3044\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```shell\n$ ls -l /path/to/repository/hooks/post-commit\n-rwxrwxr-x 1 ec2-user ec2-user 2062 Aug 25 21:57 /home/ec2-user/repos/svn/sample2/hooks/post-commit\n```\n\n## \u66f4\u65b0\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3059\u308b\n\nsvnlook\u30b3\u30de\u30f3\u30c9\u3067\u66f4\u65b0\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\npost-commit\u30d5\u30c3\u30af\u306e\u5f15\u6570\u3084svnlook\u30b3\u30de\u30f3\u30c9\u306e\u51fa\u529b\u3092\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3078\u8a18\u9332\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```shell:post-commit\n#!/bin/sh\n\nREPOS=\"$1\"\nREV=\"$2\"\nTXN_NAME=\"$3\"\n\necho \"$REPOS $REV $TXN_NAME\" >> path/to/logfile\nsvnlook changed -r $REV $REPOS >> /path/to/logfile\n```\n\n## \u52d5\u4f5c\u78ba\u8a8d\n\n### \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u3059\u308b\n\n```shell\n$ svn checkout file:///path/to/repository/trunk sample-trunk\n```\n\n### \u30ea\u30dd\u30b8\u30c8\u30ea\u3078\u5909\u66f4\u3092\u30b3\u30df\u30c3\u30c8\u3059\u308b\n\n```shell\n$ cd sample-trunk\n$ touch sample.txt sample2.txt sample3.txt\n$ svn add *\nA    sample2.txt\nA    sample3.txt\nA    sample.txt\n$ svn commit -m 'add sample files.'\nAdding sample.txt\nAdding sample2.txt\nAdding sample3.txt\nTransmitting file data ...\nCommitted revision 3.\n```\n\n\u203b post-commit\u30d5\u30c3\u30af\u306b\u3088\u308b\u51fa\u529b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```shell\n$ cat /path/to/logfile\n/path/to/repository 3 2-2\nA    trunk/sample.txt\nA    trunk/sample2.txt\nA    trunk/sample3.txt\n```\n\n\u203b branch\u304b\u3089\u3082\u30b3\u30df\u30c3\u30c8\u3057\u3066\u307f\u307e\u3059\u3002\n\n```shell\n$ svn copy file:///path/to/repsitory/trunk file:///path/to/repository/branches/b1 -m 'create b1 branch'\n$ cd ../\n$ svn checkout file:///path/to/repository/branches/b1 sample-branches\n$ cd sample-branches\n$ hostname > sample.txt\n$ touch sample4.txt\n$ svn rm sample3.txt\n$ svn add sample4.txt\n$ svn commit -m 'modify sample.txt, delete sample3.txt and add sample4.txt'\nSending    sample.txt\nDeleting   sample3.txt\nAdding     sample4.txt\nTransmitting file data ..\nCommitted revision 5.\n$ cat /path/to/logfile\n...(\u7701\u7565)...\n/path/to/repository 5 4-4\nU    branches/b1/sample.txt\nD    branches/b1/sample3.txt\nA    branches/b1/sample4.txt\n```\n"}