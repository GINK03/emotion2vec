{"tags": ["photoshopCS4\u301cCC2014", "JavaScript"], "context": " More than 1 year has passed since last update.\u5404\u30c1\u30e3\u30f3\u30cd\u30eb\u306e\u8272\u304c\u4e57\u3063\u305f\u90e8\u5206\u306e\u307f\u3092\u62bd\u51fa\u3057\u3066\u4e57\u7b97\u3059\u308b\u3053\u3068\u3067\u3001\u767d\u8272\u3092\u6392\u9664\u3057\u3066\u3044\u307e\u3059\u3002\n\u30ab\u30e9\u30fc\u30e2\u30fc\u30c9\u306f\u3001RGB\u30fbCMYK\u30fb\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5bfe\u5fdc\u3002\n#target \"Photoshop\"\n\n\nfunction CheckSelection()\n{\n    var select_bool = true;\n    try\n    {\n        app.activeDocument.selection.bounds;\n    }\n    catch(e)\n    {\n        select_bool = false;\n    }\n    return select_bool;\n}\n\n\ntry\n{\n    if (app.documents.length == 0){throw(\"\u30d5\u30a1\u30a4\u30eb\u304c\u958b\u304b\u308c\u3066\u3044\u307e\u305b\u3093\u3002\");}\n\n    with(app.activeDocument)\n    {\n        var color_mode = mode;\n        if (\"DocumentMode.GRAYSCALE,DocumentMode.RGB,DocumentMode.CMYK\".indexOf(color_mode.toString()) == -1)\n        {\n            throw(\"\u30d5\u30a1\u30a4\u30eb\u306e\u30ab\u30e9\u30fc\u30e2\u30fc\u30c9\u304cRGB\u30fbCMYK\u30fb\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306e\u3082\u306e\u3057\u304b\u51e6\u7406\u3067\u304d\u307e\u305b\u3093\u3002\");\n        }\n\n        alert(\"\u51e6\u7406\u5b9f\u884c\u3057\u307e\u3059\u3002\u9014\u4e2d\u3067\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u305f\u5834\u5408\u306f\u4fdd\u5b58\u3057\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002\");\n\n        flatten();\n\n        var doc_channels = channels;\n        for (i=0; i<doc_channels.length; i++)\n        {\n            if (doc_channels[i].kind == ChannelType.COMPONENT)\n            {\n                selection.load(doc_channels[i]);\n                selection.invert();\n\n                var new_layer = artLayers.add();\n                new_layer.name = \"Finish\";\n                new_layer.blendMode = BlendMode.MULTIPLY;\n\n                var channel_name = doc_channels[i].name;\n                var solid_color = new SolidColor();\n                if (\"\u30b0\u30ec\u30fc,gray\".indexOf(channel_name) != -1)\n                {\n                    solid_color.gray.gray = 100;\n                }\n                else if (\"\u30ec\u30c3\u30c9,red\".indexOf(channel_name) != -1)\n                {\n                    solid_color.rgb.red = 0;\n                    solid_color.rgb.green = 255;\n                    solid_color.rgb.blue = 255;\n                }\n                else if (\"\u30b0\u30ea\u30fc\u30f3,green\".indexOf(channel_name) != -1)\n                {\n                    solid_color.rgb.red = 255;\n                    solid_color.rgb.green = 0;\n                    solid_color.rgb.blue = 255;\n                }\n                else if (\"\u30d6\u30eb\u30fc,blue\".indexOf(channel_name) != -1)\n                {\n                    solid_color.rgb.red = 255;\n                    solid_color.rgb.green = 255;\n                    solid_color.rgb.blue = 0;\n                }\n                else if (\"\u30b7\u30a2\u30f3,cyan\".indexOf(channel_name) != -1)\n                {\n                    solid_color.cmyk.cyan = 100;\n                    solid_color.cmyk.magenta = 0;\n                    solid_color.cmyk.yellow = 0;\n                    solid_color.cmyk.black = 0;\n                }\n                else if (\"\u30de\u30bc\u30f3\u30bf,magenta\".indexOf(channel_name) != -1)\n                {\n                    solid_color.cmyk.cyan = 0;\n                    solid_color.cmyk.magenta = 100;\n                    solid_color.cmyk.yellow = 0;\n                    solid_color.cmyk.black = 0;\n                }\n                else if (\"\u30a4\u30a8\u30ed\u30fc,yellow\".indexOf(channel_name) != -1)\n                {\n                    solid_color.cmyk.cyan = 0;\n                    solid_color.cmyk.magenta = 0;\n                    solid_color.cmyk.yellow = 100;\n                    solid_color.cmyk.black = 0;\n                }\n                else if (\"\u30d6\u30e9\u30c3\u30af,black\".indexOf(channel_name) != -1)\n                {\n                    solid_color.cmyk.cyan = 0;\n                    solid_color.cmyk.magenta = 0;\n                    solid_color.cmyk.yellow = 0;\n                    solid_color.cmyk.black = 100;\n                }\n\n                if (CheckSelection())\n                {\n                    selection.fill(solid_color, ColorBlendMode.NORMAL , 100, false);\n                }\n            }\n        }\n\n        selection.deselect();\n\n        var doc_layers = layers;\n        for (j=0; j<doc_layers.length; j++)\n        {\n            if (doc_layers[j].isBackgroundLayer){doc_layers[j].remove();}\n        }\n\n        if (layers.length != 1)\n        {\n            mergeVisibleLayers();\n            artLayers[0].name = \"Finish\"\n        }\n        else\n        {\n            artLayers[0].blendMode = BlendMode.NORMAL;\n        }\n\n        alert(\"\u51e6\u7406\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\");\n    }\n}\ncatch(err_str)\n{\n    alert(err_str);\n}\n\n\u5404\u30c1\u30e3\u30f3\u30cd\u30eb\u306e\u8272\u304c\u4e57\u3063\u305f\u90e8\u5206\u306e\u307f\u3092\u62bd\u51fa\u3057\u3066\u4e57\u7b97\u3059\u308b\u3053\u3068\u3067\u3001\u767d\u8272\u3092\u6392\u9664\u3057\u3066\u3044\u307e\u3059\u3002\n\u30ab\u30e9\u30fc\u30e2\u30fc\u30c9\u306f\u3001RGB\u30fbCMYK\u30fb\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306b\u5bfe\u5fdc\u3002\n\n```js:\n#target \"Photoshop\"\n\n\nfunction CheckSelection()\n{\n\tvar select_bool = true;\n\ttry\n\t{\n\t\tapp.activeDocument.selection.bounds;\n\t}\n\tcatch(e)\n\t{\n\t\tselect_bool = false;\n\t}\n\treturn select_bool;\n}\n\n\ntry\n{\n\tif (app.documents.length == 0){throw(\"\u30d5\u30a1\u30a4\u30eb\u304c\u958b\u304b\u308c\u3066\u3044\u307e\u305b\u3093\u3002\");}\n\t\n\twith(app.activeDocument)\n\t{\n\t\tvar color_mode = mode;\n\t\tif (\"DocumentMode.GRAYSCALE,DocumentMode.RGB,DocumentMode.CMYK\".indexOf(color_mode.toString()) == -1)\n\t\t{\n\t\t\tthrow(\"\u30d5\u30a1\u30a4\u30eb\u306e\u30ab\u30e9\u30fc\u30e2\u30fc\u30c9\u304cRGB\u30fbCMYK\u30fb\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u306e\u3082\u306e\u3057\u304b\u51e6\u7406\u3067\u304d\u307e\u305b\u3093\u3002\");\n\t\t}\n\t\t\n\t\talert(\"\u51e6\u7406\u5b9f\u884c\u3057\u307e\u3059\u3002\u9014\u4e2d\u3067\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u305f\u5834\u5408\u306f\u4fdd\u5b58\u3057\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002\");\n\t\t\n\t\tflatten();\n\t\t\n\t\tvar doc_channels = channels;\n\t\tfor (i=0; i<doc_channels.length; i++)\n\t\t{\n\t\t\tif (doc_channels[i].kind == ChannelType.COMPONENT)\n\t\t\t{\n\t\t\t\tselection.load(doc_channels[i]);\n\t\t\t\tselection.invert();\n\t\t\t\t\n\t\t\t\tvar new_layer = artLayers.add();\n\t\t\t\tnew_layer.name = \"Finish\";\n\t\t\t\tnew_layer.blendMode = BlendMode.MULTIPLY;\n\t\t\t\t\t\t\t\t\n\t\t\t\tvar channel_name = doc_channels[i].name;\n\t\t\t\tvar solid_color = new SolidColor();\n\t\t\t\tif (\"\u30b0\u30ec\u30fc,gray\".indexOf(channel_name) != -1)\n\t\t\t\t{\n\t\t\t\t\tsolid_color.gray.gray = 100;\n\t\t\t\t}\n\t\t\t\telse if (\"\u30ec\u30c3\u30c9,red\".indexOf(channel_name) != -1)\n\t\t\t\t{\n\t\t\t\t\tsolid_color.rgb.red = 0;\n\t\t\t\t\tsolid_color.rgb.green = 255;\n\t\t\t\t\tsolid_color.rgb.blue = 255;\n\t\t\t\t}\n\t\t\t\telse if (\"\u30b0\u30ea\u30fc\u30f3,green\".indexOf(channel_name) != -1)\n\t\t\t\t{\n\t\t\t\t\tsolid_color.rgb.red = 255;\n\t\t\t\t\tsolid_color.rgb.green = 0;\n\t\t\t\t\tsolid_color.rgb.blue = 255;\n\t\t\t\t}\n\t\t\t\telse if (\"\u30d6\u30eb\u30fc,blue\".indexOf(channel_name) != -1)\n\t\t\t\t{\n\t\t\t\t\tsolid_color.rgb.red = 255;\n\t\t\t\t\tsolid_color.rgb.green = 255;\n\t\t\t\t\tsolid_color.rgb.blue = 0;\n\t\t\t\t}\n\t\t\t\telse if (\"\u30b7\u30a2\u30f3,cyan\".indexOf(channel_name) != -1)\n\t\t\t\t{\n\t\t\t\t\tsolid_color.cmyk.cyan = 100;\n\t\t\t\t\tsolid_color.cmyk.magenta = 0;\n\t\t\t\t\tsolid_color.cmyk.yellow = 0;\n\t\t\t\t\tsolid_color.cmyk.black = 0;\n\t\t\t\t}\n\t\t\t\telse if (\"\u30de\u30bc\u30f3\u30bf,magenta\".indexOf(channel_name) != -1)\n\t\t\t\t{\n\t\t\t\t\tsolid_color.cmyk.cyan = 0;\n\t\t\t\t\tsolid_color.cmyk.magenta = 100;\n\t\t\t\t\tsolid_color.cmyk.yellow = 0;\n\t\t\t\t\tsolid_color.cmyk.black = 0;\n\t\t\t\t}\n\t\t\t\telse if (\"\u30a4\u30a8\u30ed\u30fc,yellow\".indexOf(channel_name) != -1)\n\t\t\t\t{\n\t\t\t\t\tsolid_color.cmyk.cyan = 0;\n\t\t\t\t\tsolid_color.cmyk.magenta = 0;\n\t\t\t\t\tsolid_color.cmyk.yellow = 100;\n\t\t\t\t\tsolid_color.cmyk.black = 0;\n\t\t\t\t}\n\t\t\t\telse if (\"\u30d6\u30e9\u30c3\u30af,black\".indexOf(channel_name) != -1)\n\t\t\t\t{\n\t\t\t\t\tsolid_color.cmyk.cyan = 0;\n\t\t\t\t\tsolid_color.cmyk.magenta = 0;\n\t\t\t\t\tsolid_color.cmyk.yellow = 0;\n\t\t\t\t\tsolid_color.cmyk.black = 100;\n\t\t\t\t}\n\n\t\t\t\tif (CheckSelection())\n\t\t\t\t{\n\t\t\t\t\tselection.fill(solid_color, ColorBlendMode.NORMAL , 100, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tselection.deselect();\n\n\t\tvar doc_layers = layers;\n\t\tfor (j=0; j<doc_layers.length; j++)\n\t\t{\n\t\t\tif (doc_layers[j].isBackgroundLayer){doc_layers[j].remove();}\n\t\t}\n\n\t\tif (layers.length != 1)\n\t\t{\n\t\t\tmergeVisibleLayers();\n\t\t\tartLayers[0].name = \"Finish\"\n\t\t}\n\t\telse\n\t\t{\n\t\t\tartLayers[0].blendMode = BlendMode.NORMAL;\n\t\t}\n\n\t\talert(\"\u51e6\u7406\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\");\n\t}\n}\ncatch(err_str)\n{\n\talert(err_str);\n}\n```\n"}