{"context": " More than 1 year has passed since last update.\u3053\u3061\u3089\u3082\u65e2\u51fa\u3068\u601d\u3044\u307e\u3059\u304c\u30fb\u30fb\u30fb\u3002\nvagrant box add \u30b3\u30de\u30f3\u30c9\u30672\u4eee\u60f3\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nvagrant\u5171\u6709\u30d5\u30a9\u30eb\u30c0\u306b td.repo\u30d5\u30a1\u30a4\u30eb\u3092\u683c\u7d0d\u3057\u307e\u3059\u3002\n[treasuredata]\nname=TreasureData\nbaseurl=http://packages.treasuredata.com/2/redhat/$releasever/$basearch\ngpgcheck=1\ngpgkey=http://packages.treasuredata.com/GPG-KEY-td-agent\n\n\u3010fluentd\uff08\u53d7\u4fe1\uff09\u3011\nbootstrap.sh\u3092\u4ee5\u4e0b\u3067\u4f5c\u6210\n\u3000#!/bin/bash\n\u3000sudo su\n\u3000cp /vagrant/td.repo /etc/yum.repos.d/td.repo\n\u3000yum -y install td-agent\n\u3000service td-agent start\n\u3000chkconfig td-agent on\n\nVagrantfile\u3000\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\n  config.vm.network \"private_network\", ip: \"192.168.33.11\"\n  config.vm.provision :shell, path: \"bootstrap.sh\"\n\n\u3010fluentd\uff08\u53d7\u4fe1\uff09\u517cweb\u30b5\u30fc\u30d0\u3011\nbootstrap.sh\u3092\u4ee5\u4e0b\u3067\u4f5c\u6210\n\u3000#!/bin/bash\n\u3000sudo su\n\u3000yum install httpd -y\n\u3000rm -rf /var/www/html\n\u3000ln -fs /vagrant /var/www/html\n\u3000cp /vagrant/td.repo /etc/yum.repos.d/td.repo\n\u3000yum -y install td-agent\n\u3000service td-agent start\n\u3000chkconfig td-agent on\n\nVagrantfile\u3000\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\n  config.vm.network \"private_network\", ip: \"192.168.33.10\"\n  config.vm.provision :shell, path: \"bootstrap.sh\"\n  config.vm.network :forwarded_port, guest: 80, host: 1234\n\nvagrant up\u30672\u53f0\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3092\u505c\u6b62\u3057\u307e\u3059\u3002\n\u3000service iptables stop\n\u3000chkconfig iptables off\n\n\u3010fluentd\uff08\u53d7\u4fe1\uff09\u3011\ntd-agentd.conf\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\n\u4e0b\u8a18\u4ee5\u5916\u306f\u3059\u3079\u3066\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\nvi /etc/td-agent/td-agent.conf\n\u3000<source>\n\u3000type forward\n\u3000port 24224\n\u3000</source>\n\n\u3000<match httpd.access>\n\u3000type file\n\u3000path /var/log/td-agent/httpd\n\u3000</match>\n\ntd-agent\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u3000service td-agent restart\n\n\u3010fluentd\uff08\u53d7\u4fe1\uff09\u517cweb\u30b5\u30fc\u30d0\u3011\n/var/www/html/\u30d5\u30a9\u30eb\u30c0\u306b\u30c6\u30b9\u30c8\u7528html\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\ntd-agentd.conf\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\n\u4e0b\u8a18\u4ee5\u5916\u306f\u3059\u3079\u3066\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\nvi /etc/td-agent/td-agent.conf\n\u3000<source>\n  type tail\n  format apache\n  path /var/log/httpd-access.log\n  tag httpd.access\n\u3000</source>\n\u3000<match httpd.access>\n  type forward\n  host 192.168.33.10\n  port 24224\n  </match>\n\n\u30ed\u30b0\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\nchmod 755 /var/log/httpd/access_log\nchmod 755 /var/log/httpd/\n\ntd-agent\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u3000service td-agent restart\n\nhttp://127.0.0.1:1234\u3000\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\nfulentd\uff08\u53d7\u4fe1\uff09\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4ee5\u4e0b\u30d5\u30a9\u30eb\u30c0\u306b\u30ed\u30b0\u304c\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\n/var/log/td-agent/httpd*\n2015-04-03T06:59:31+00:00       httpd.access    {\"host\":\"10.0.2.2\",\"user\":\"-\",\"method\":\"GET\",\"path\":\"/\",\"code\":\"304\",\"size\":\"-\",\"referer\":\"-\",\"agent\":\"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0\"} \n\n\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f/var/log/td-agent/td-agent.log\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3053\u3061\u3089\u3082\u65e2\u51fa\u3068\u601d\u3044\u307e\u3059\u304c\u30fb\u30fb\u30fb\u3002\n\nvagrant box add \u30b3\u30de\u30f3\u30c9\u30672\u4eee\u60f3\u30b5\u30fc\u30d0\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nvagrant\u5171\u6709\u30d5\u30a9\u30eb\u30c0\u306b td.repo\u30d5\u30a1\u30a4\u30eb\u3092\u683c\u7d0d\u3057\u307e\u3059\u3002\n\n```bash\n[treasuredata]\nname=TreasureData\nbaseurl=http://packages.treasuredata.com/2/redhat/$releasever/$basearch\ngpgcheck=1\ngpgkey=http://packages.treasuredata.com/GPG-KEY-td-agent\n```\n\n\u3010fluentd\uff08\u53d7\u4fe1\uff09\u3011\n\nbootstrap.sh\u3092\u4ee5\u4e0b\u3067\u4f5c\u6210\n\n```bash\n\u3000#!/bin/bash\n\u3000sudo su\n\u3000cp /vagrant/td.repo /etc/yum.repos.d/td.repo\n\u3000yum -y install td-agent\n\u3000service td-agent start\n\u3000chkconfig td-agent on\n```\n\nVagrantfile\u3000\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\n\n```bash\n  config.vm.network \"private_network\", ip: \"192.168.33.11\"\n  config.vm.provision :shell, path: \"bootstrap.sh\"\n```\n\n\u3010fluentd\uff08\u53d7\u4fe1\uff09\u517cweb\u30b5\u30fc\u30d0\u3011\n\nbootstrap.sh\u3092\u4ee5\u4e0b\u3067\u4f5c\u6210\n\n```bash\n\u3000#!/bin/bash\n\u3000sudo su\n\u3000yum install httpd -y\n\u3000rm -rf /var/www/html\n\u3000ln -fs /vagrant /var/www/html\n\u3000cp /vagrant/td.repo /etc/yum.repos.d/td.repo\n\u3000yum -y install td-agent\n\u3000service td-agent start\n\u3000chkconfig td-agent on\n```\n\nVagrantfile\u3000\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\n\n```bash\n  config.vm.network \"private_network\", ip: \"192.168.33.10\"\n  config.vm.provision :shell, path: \"bootstrap.sh\"\n  config.vm.network :forwarded_port, guest: 80, host: 1234\n```\n\nvagrant up\u30672\u53f0\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3092\u505c\u6b62\u3057\u307e\u3059\u3002\n\n```bash\n\u3000service iptables stop\n\u3000chkconfig iptables off\n```\n\n\u3010fluentd\uff08\u53d7\u4fe1\uff09\u3011\n\ntd-agentd.conf\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\n\u4e0b\u8a18\u4ee5\u5916\u306f\u3059\u3079\u3066\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\nvi /etc/td-agent/td-agent.conf\n\n```bash\n\u3000<source>\n\u3000type forward\n\u3000port 24224\n\u3000</source>\n\n\u3000<match httpd.access>\n\u3000type file\n\u3000path /var/log/td-agent/httpd\n\u3000</match>\n```\n\ntd-agent\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash\n\u3000service td-agent restart\n```\n\n\u3010fluentd\uff08\u53d7\u4fe1\uff09\u517cweb\u30b5\u30fc\u30d0\u3011\n\n  /var/www/html/\u30d5\u30a9\u30eb\u30c0\u306b\u30c6\u30b9\u30c8\u7528html\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n  \ntd-agentd.conf\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\n\u4e0b\u8a18\u4ee5\u5916\u306f\u3059\u3079\u3066\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\nvi /etc/td-agent/td-agent.conf\n\n```bash\n\u3000<source>\n  type tail\n  format apache\n  path /var/log/httpd-access.log\n  tag httpd.access\n\u3000</source>\n\u3000<match httpd.access>\n  type forward\n  host 192.168.33.10\n  port 24224\n  </match>\n```\n\n\u30ed\u30b0\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```bash\nchmod 755 /var/log/httpd/access_log\nchmod 755 /var/log/httpd/\n```\n\ntd-agent\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash\n\u3000service td-agent restart\n```\n\nhttp://127.0.0.1:1234\u3000\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n fulentd\uff08\u53d7\u4fe1\uff09\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u4ee5\u4e0b\u30d5\u30a9\u30eb\u30c0\u306b\u30ed\u30b0\u304c\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\n \n /var/log/td-agent/httpd*\n\n```bash\n2015-04-03T06:59:31+00:00       httpd.access    {\"host\":\"10.0.2.2\",\"user\":\"-\",\"method\":\"GET\",\"path\":\"/\",\"code\":\"304\",\"size\":\"-\",\"referer\":\"-\",\"agent\":\"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0\"} \n```\n\n\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u5834\u5408\u306f/var/log/td-agent/td-agent.log\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n", "tags": ["vagrant", "fluentd"]}