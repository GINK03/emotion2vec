{"context": "\n\n\u3055\u3088\u306a\u3089\u306f\u3044\u3064\u3060\u3063\u3066\u3055\u3073\u3057\u3044\nHipChat \u306f\u9000\u4f1a\u51e6\u7406\u3092\u3059\u308b\u3068\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u524a\u9664\u3055\u308c\u3061\u3083\u3046\u4ed5\u69d8\u3089\u3057\u3044\u3067\u3059\uff08\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u306e\u4f1a\u8a71\u30ed\u30b0\u306f\u6b8b\u308b\u3089\u3057\u3044)\n\u3044\u3064\u307e\u3067\u3082\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6b8b\u3057\u3066\u304a\u304d\u305f\u3044\u3001\u305d\u3093\u306a\u885d\u52d5\u306b\u304b\u3089\u308c\u3066\u300130\u5206\u3067\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n\u6e96\u5099\n\ncreate new token\nHipChat API v2 \u3092\u4f7f\u3046\u306e\u3067\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8aad\u307f\u53d6\u308b\u7528\u306etoken\u3092\u767a\u884c\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nhttps://\u307b\u3052\u307b\u3052.hipchat.com/account/api\n\n\uff08URL\u306f\u9069\u5b9c\u8aad\u307f\u66ff\u3048\u3066\u306d\uff09\n\n\n\u304a\u4e16\u8a71\u306b\u306a\u3063\u305f\u3042\u306e\u3072\u3068\u306eID\u3092\u53d6\u5f97\u3059\u308b\n\nhttps://\u307b\u3052\u307b\u3052.hipchat.com/people\n\n\u3053\u3053\u304b\u3089\u76f8\u624b\u3092\u63a2\u3057\u307e\u3059\u3002\n\nhttps://\u307b\u3052\u307b\u3052.hipchat.com/people/show/1234567\n\n\u3053\u3093\u306aURL\u306e\u30da\u30fc\u30b8\u306b\u306a\u3063\u305f\u3089\u3001\u672b\u5c3e\u304cID\u3067\u3059\u3002\n\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3059\u308b\n\nhttps://www.hipchat.com/docs/apiv2/method/view_privatechat_history\n\n\u3053\u306eAPI\u3092\u4f7f\u3063\u3066\u53d6\u5f97\u3057\u307e\u3059\u3002\n\nsayonara.sh\n#! /bin/sh\n\nflag=true\nmax=100\ntoken='\u53d6\u5f97\u3057\u305f\u30c8\u30fc\u30af\u30f3'\nid=\u76f8\u624b\u306eID\nindex=0\ntrial=0\nlog='\u51fa\u529b\u5148\u306e\u30ed\u30b0'\ndate='\u76f8\u624b\u306e\u521d\u51fa\u793e\u65e5'\nenddate='\u76f8\u624b\u306e\u6700\u7d42\u51fa\u793e\u65e5'\n\nwhile ${flag}; do\n    if [ ${trial} -gt 100 ]; then\n        echo \"max trial.\"\n        exit\n    fi\n    echo ${index}\n    ret=$(curl -X GET \"https://\u307b\u3052\u307b\u3052.hipchat.com/v2/user/${id}/history?auth_token=${token}&timezone=Asia/Tokyo&date=${date}&end-date=${enddate}&reverse=false&start-index=${index}&max-results=${max}\")\n    if [[ ${ret} =~ .*(\\\"items\\\": \\[\\]) ]]; then\n        flag=false\n    else\n        index=$(expr ${index} + ${max})\n        echo ${ret} >> ${log}\n        sleep 1s\n    fi\n    trial=$(expr ${trial} + 1)\ndone\n\necho \"end\"\n\n\n\n\u5b9f\u884c\nbash sayonara.sh\n\n\u601d\u3044\u51fa\u304c\u305f\u304f\u3055\u3093\u3042\u308b\u3060\u3051\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\n\u78ba\u8a8d\u3059\u308b\njq \u30b3\u30de\u30f3\u30c9\u3068\u304b\u4f7f\u3046\u3068\u898b\u3084\u3059\u3044\u3067\u3059\u3002\n\u6642\u7cfb\u5217\u964d\u9806\u306a\u306e\u3067\u3001\u5148\u982d\u304c\u6700\u8fd1\u306e\u4f1a\u8a71\u306b\u306a\u3063\u3066\u307e\u3059\u3002\n\u30ed\u30fc\u30ab\u30eb\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u8d77\u3053\u305b\u305f\u3089\u3001\u3042\u3068\u306f\u3058\u3063\u304f\u308a\u6574\u5f62\u3059\u308c\u3070\u3044\u3044\u308f\u3051\u3067\u3059\u306d\u3002\n\n\u307e\u3068\u3081\n\u3055\u3073\u3057\u3044\n# \u3055\u3088\u306a\u3089\u306f\u3044\u3064\u3060\u3063\u3066\u3055\u3073\u3057\u3044\nHipChat \u306f\u9000\u4f1a\u51e6\u7406\u3092\u3059\u308b\u3068\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u524a\u9664\u3055\u308c\u3061\u3083\u3046\u4ed5\u69d8\u3089\u3057\u3044\u3067\u3059\uff08\u30c1\u30e3\u30c3\u30c8\u30eb\u30fc\u30e0\u306e\u4f1a\u8a71\u30ed\u30b0\u306f\u6b8b\u308b\u3089\u3057\u3044)\n\u3044\u3064\u307e\u3067\u3082\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6b8b\u3057\u3066\u304a\u304d\u305f\u3044\u3001\u305d\u3093\u306a\u885d\u52d5\u306b\u304b\u3089\u308c\u3066\u300130\u5206\u3067\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n# \u6e96\u5099\n## create new token\nHipChat API v2 \u3092\u4f7f\u3046\u306e\u3067\u3001\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8aad\u307f\u53d6\u308b\u7528\u306etoken\u3092\u767a\u884c\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n * https://\u307b\u3052\u307b\u3052.hipchat.com/account/api\n\n\uff08URL\u306f\u9069\u5b9c\u8aad\u307f\u66ff\u3048\u3066\u306d\uff09\n\n<img width=\"434\" alt=\"new_token.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/62697/254264d5-cd79-2c3d-4694-bba5fabd702a.png\">\n\n## \u304a\u4e16\u8a71\u306b\u306a\u3063\u305f\u3042\u306e\u3072\u3068\u306eID\u3092\u53d6\u5f97\u3059\u308b\n\n* https://\u307b\u3052\u307b\u3052.hipchat.com/people\n\n\u3053\u3053\u304b\u3089\u76f8\u624b\u3092\u63a2\u3057\u307e\u3059\u3002\n\n* https://\u307b\u3052\u307b\u3052.hipchat.com/people/show/1234567\n\n\u3053\u3093\u306aURL\u306e\u30da\u30fc\u30b8\u306b\u306a\u3063\u305f\u3089\u3001\u672b\u5c3e\u304cID\u3067\u3059\u3002\n\n## \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d6\u5f97\u3059\u308b\n\n* https://www.hipchat.com/docs/apiv2/method/view_privatechat_history\n\n\u3053\u306eAPI\u3092\u4f7f\u3063\u3066\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```sayonara.sh\n#! /bin/sh\n\nflag=true\nmax=100\ntoken='\u53d6\u5f97\u3057\u305f\u30c8\u30fc\u30af\u30f3'\nid=\u76f8\u624b\u306eID\nindex=0\ntrial=0\nlog='\u51fa\u529b\u5148\u306e\u30ed\u30b0'\ndate='\u76f8\u624b\u306e\u521d\u51fa\u793e\u65e5'\nenddate='\u76f8\u624b\u306e\u6700\u7d42\u51fa\u793e\u65e5'\n\nwhile ${flag}; do\n    if [ ${trial} -gt 100 ]; then\n        echo \"max trial.\"\n        exit\n    fi\n    echo ${index}\n    ret=$(curl -X GET \"https://\u307b\u3052\u307b\u3052.hipchat.com/v2/user/${id}/history?auth_token=${token}&timezone=Asia/Tokyo&date=${date}&end-date=${enddate}&reverse=false&start-index=${index}&max-results=${max}\")\n    if [[ ${ret} =~ .*(\\\"items\\\": \\[\\]) ]]; then\n        flag=false\n    else\n        index=$(expr ${index} + ${max})\n        echo ${ret} >> ${log}\n        sleep 1s\n    fi\n    trial=$(expr ${trial} + 1)\ndone\n\necho \"end\"\n```\n\n## \u5b9f\u884c\n\n```bash\nbash sayonara.sh\n```\n\n\u601d\u3044\u51fa\u304c\u305f\u304f\u3055\u3093\u3042\u308b\u3060\u3051\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\n## \u78ba\u8a8d\u3059\u308b\n\njq \u30b3\u30de\u30f3\u30c9\u3068\u304b\u4f7f\u3046\u3068\u898b\u3084\u3059\u3044\u3067\u3059\u3002\n\u6642\u7cfb\u5217\u964d\u9806\u306a\u306e\u3067\u3001\u5148\u982d\u304c\u6700\u8fd1\u306e\u4f1a\u8a71\u306b\u306a\u3063\u3066\u307e\u3059\u3002\n\u30ed\u30fc\u30ab\u30eb\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u8d77\u3053\u305b\u305f\u3089\u3001\u3042\u3068\u306f\u3058\u3063\u304f\u308a\u6574\u5f62\u3059\u308c\u3070\u3044\u3044\u308f\u3051\u3067\u3059\u306d\u3002\n\n\n# \u307e\u3068\u3081\n\n\u3055\u3073\u3057\u3044\n", "tags": ["hipchat"]}