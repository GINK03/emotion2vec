{"tags": ["Sensu", "Windows"], "context": "\n\nPowershell plugins\n\nclient.json\n{\n  \"client\": {\n    ...  \n    \"ruby\": \"c:/opt/sensu/embedded/bin/ruby.exe\",\n    \"powershell\": \"Powershell.exe -NonInteractive -NoProfile -ExecutionPolicy Unrestricted -NoLogo\",\n    \"plugins\": \"c:/opt/sensu/plugins\"    \n  }\n}\n\n\n\ncheck.json\n    \"check-process-photon\": {\n      \"handlers\": [\"mailer\"],\n      \"command\": \":::powershell::: -File :::plugins:::/check-windows-service.ps1 \\\"Photon Socket Server: Loadbalancing\\\"\",\n      \"interval\":  300,\n      \"standalone\": true\n    },\n\n\n\nwith metrin\n\ncheck.json\n    \"check-cloudwatch-cpu-load\": {\n      \"handlers\": [\"mailer\"],\n      \"command\": \"/opt/cloudpack/bin/metrin.exe -r us-west-2 -n AWS/EC2 -d \\\"InstanceId::::instance_id:::\\\" -m CPUUtilization -s Average -p 300 -S -120 check --warning-gt 70 --critical-gt 90\",\n      \"interval\":  300,\n      \"standalone\": true\n    },\n\n\nQuote via \\\" if this token contains :, due to josn_multi error.\n\ncheck-ports.rb (old version)\nnmap for windows\nI found new version check_port.rb. It's nmap-free.\nhttps://github.com/sensu-plugins/sensu-plugins-network-checks/blob/master/bin/check-ports.rb \n\nuse net-ping\nnet-ping support udp ping!\ngem install win32-security\ngem install net-ping\n\nhttps://gist.github.com/YoshihitoAso/4696911\nrequire 'net/ping'\n\nr = Net::Ping::TCP.new('127.0.0.1', 23)\np r.ping? #true or false\n\n\n\ncheck-ports.rb (new version namp-free)\ngem install sensu-plugins-network-checks\n\ncheck-ports.rb.bat -H localhost -p 22\n> CheckPort OK: ...\n\n\ncheck-service\ngem install sensu-plugins-network\n\ncheck-windows-service.rb.bat -s 'W32Time'\n\n\nsc query To get service_name\n\nlinux <=> Win\n\n\n\nlinux-daemon\nWin-Service\n\n\n\n\nntp,chrony\nW32Time\n\n\nrsyslogd\neventlog\n\n\ncrond,atd\nSchedule\n\n\n\n\n# Powershell plugins\n\n```json:client.json\n{\n  \"client\": {\n    ...  \n    \"ruby\": \"c:/opt/sensu/embedded/bin/ruby.exe\",\n    \"powershell\": \"Powershell.exe -NonInteractive -NoProfile -ExecutionPolicy Unrestricted -NoLogo\",\n    \"plugins\": \"c:/opt/sensu/plugins\"    \n  }\n}\n```\n\n\n```json:check.json\n    \"check-process-photon\": {\n      \"handlers\": [\"mailer\"],\n      \"command\": \":::powershell::: -File :::plugins:::/check-windows-service.ps1 \\\"Photon Socket Server: Loadbalancing\\\"\",\n      \"interval\":  300,\n      \"standalone\": true\n    },\n```\n\n\n# with metrin\n```json:check.json\n\t\"check-cloudwatch-cpu-load\": {\n      \"handlers\": [\"mailer\"],\n      \"command\": \"/opt/cloudpack/bin/metrin.exe -r us-west-2 -n AWS/EC2 -d \\\"InstanceId::::instance_id:::\\\" -m CPUUtilization -s Average -p 300 -S -120 check --warning-gt 70 --critical-gt 90\",\n      \"interval\":  300,\n      \"standalone\": true\n    },\n```\nQuote via `\\\"` if this token contains `:`, due to josn_multi error.\n\n# check-ports.rb (old version)\n`nmap` for windows\nI found new version check_port.rb. It's nmap-free.\n\nhttps://github.com/sensu-plugins/sensu-plugins-network-checks/blob/master/bin/check-ports.rb \n\n## use net-ping\n\nnet-ping support `udp` ping!\n\n```\ngem install win32-security\ngem install net-ping\n```\n\nhttps://gist.github.com/YoshihitoAso/4696911\n\n```ruby:\nrequire 'net/ping'\n\nr = Net::Ping::TCP.new('127.0.0.1', 23)\np r.ping? #true or false\n\n```\n\n## check-ports.rb (new version namp-free)\n\n```\ngem install sensu-plugins-network-checks\n\ncheck-ports.rb.bat -H localhost -p 22\n> CheckPort OK: ...\n```\n\n# check-service\n\n```\ngem install sensu-plugins-network\n\ncheck-windows-service.rb.bat -s 'W32Time'\n\n```\n\n`sc query ` To get `service_name`\n\n## linux <=> Win \n|linux-daemon|Win-Service|\n|------------|-----------|\n|ntp,chrony  |W32Time    |\n|rsyslogd    |eventlog   |\n|crond,atd   |Schedule   |\n\n\n\n\n\n\n\n\n\n"}