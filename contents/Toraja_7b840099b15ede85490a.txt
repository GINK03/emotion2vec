{"context": "\n\n\u524d\u53e3\u4e0a\n\u524d\u7a3f\u3092\u53d7\u3051\u3066\u3001\u30b5\u30d6\u30af\u30e9\u30b9\u5316\u306b\u3066\u30ab\u30e9\u30e0\u76f4\u63a5\u7de8\u96c6\u3092\u5b9f\u73fe\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u5e8f\u306a\u306e\u3067\u3001\u3075\u3063\u304b\u3061\u3083\u3093\u30d0\u30fc\u30b8\u30e7\u30f3\u3082\u7d39\u4ecb\u3057\u3068\u304d\u307e\u3057\u3087\u3046\u3002\n\u305f\u3060\u3001\u5b9f\u306f\u3075\u3063\u304b\u3061\u3083\u3093\u3001MS\u306e\u30b5\u30a4\u30c8\u304b\u3089\u3046\u307e\u304f\u30b3\u30d4\u30fc\u3067\u304d\u306a\u3044\u30d1\u30bf\u30fc\u30f3\u304c\u3042\u308a\u307e\u3059\u3002\uff08\u6539\u884c\u304c\u3050\u3061\u3083\u3050\u3061\u3083\u3067\u2026\uff09\ncopy\u3057\u3066\u304f\u308b\u6642\u306f\u3061\u3087\u3063\u3068\u53e4\u3081\u306e\u4e0b\u8a18\u30b5\u30a4\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\uff08\u4e21\u65b9\u5fc5\u8981\u3067\u3059\uff09\n\nWndProcHooker\nWin32\n\n\u3042\u3001\u5f8c Win32 \u306e\u4e2d\u306b\n[DllImport(\"coredll.dll\")]\n\u3063\u3066\u306e\u304c11\u30f6\u6240\u3042\u308a\u307e\u3059\u304c\u3001\u4f55\u304b\u5b9c\u3057\u304f\u306a\u3044\u306e\u3067\u3001\n[DllImport(\"user32.dll\")]\n\u306b\u5909\u3048\u3066\u4e0b\u3055\u3044\u3002\u554f\u984c\u306a\u3044\u7b48\u3067\u3059\u3002\n\n\u3075\u3063\u304b\u3061\u3083\u3093\n\u524d\u7a3f\u306e\u30b3\u30fc\u30c9\u306b\u524d\u51fa\u3075\u305f\u3064\u306e\u30b3\u30fc\u30c9\u3092\u5408\u308f\u305b\u305f\u4e0a\u3067\u3001\u4ee5\u4e0b\u306e\u69d8\u306b\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3059\u308c\u3070OK\u3067\u3059\u3002\npublic Form1() {\n    InitializeComponent();\n\n    //    \u6b21\u306e\uff12\u884c\u3092\u8ffd\u52a0\u3059\u308b\n    WndProcHooker.HookWndProc(listView1, new WndProcHooker.WndProcCallback(WM_Hook_Handler), WM_HSCROLL);\n    WndProcHooker.HookWndProc(listView1, new WndProcHooker.WndProcCallback(WM_Hook_Handler), WM_VSCROLL);\n}\n\nconst int WM_HSCROLL = 0x114;\nconst int WM_VSCROLL = 0x115;\n\nint WM_Hook_Handler(IntPtr hwnd, uint msg, uint wParam, int lParam, ref bool handled) {\n    Control.FromHandle(hwnd).Focus();\n    return -1;\n}\n\nprivate void Form1_FormClosing(object sender, FormClosingEventArgs e) {\n    WndProcHooker.UnhookWndProc(listView1, WM_VSCROLL);\n    WndProcHooker.UnhookWndProc(listView1, WM_HSCROLL);\n}\n\nListView \u306e\u30b9\u30af\u30ed\u30fc\u30eb\u30d0\u30fc\u3092\u89e6\u308b\u3068\u3001\u76f4\u63a5\u7de8\u96c6\u3061\u3063\u304f\u30e2\u30fc\u30c9\u629c\u3051\u305f\u3067\u3057\u3087\uff1f\n\u3075\u3063\u304b\u3061\u3083\u3093\u3001\u4e2d\u3005\u3084\u308b\u306a\u30fc\n\n\u30b5\u30d6\u30af\u30e9\u30b9\u5316\n\u3044\u304d\u306a\u308a\u30bd\u30fc\u30b9\uff01\n\u306e\u307f\u3063\uff01\nusing System;\nusing System.ComponentModel;\nusing System.Drawing;\nusing System.Text;\nusing System.Windows.Forms;\n\npublic class ListViewEx : ListView {\n    public ListViewEx() : base() {\n        this.SetStyle(ControlStyles.EnableNotifyMessage, true);\n\n        this.EditBox = new TextBox();\n        this.EditBox.Parent = this;\n        this.EditBox.Visible = false;\n        this.EditBox.BorderStyle = BorderStyle.FixedSingle;\n        this.EditBox.Leave += EditBox_Leave;\n        this.EditBox.KeyPress += EditBox_KeyPress;\n    }\n\n    protected override void Dispose(bool disposing) {\n        if(disposing) {\n            this.EditBox.KeyPress -= EditBox_KeyPress;\n            this.EditBox.Leave -= EditBox_Leave;\n            this.EditBox.Dispose();\n        }\n        base.Dispose(disposing);\n    }\n\n    TextBox EditBox;\n\n    private void EditBox_Leave(object sender, EventArgs e) {\n        CurrentColumn.Text = EditBox.Text;\n        EditBox.Visible = false;\n    }\n\n    private void EditBox_KeyPress(object sender, KeyPressEventArgs e) {\n        switch(e.KeyChar) {\n        case (char)Keys.Enter:\n            this.Focus();\n            e.Handled = true;\n            break;\n\n        case (char)Keys.Escape:\n            EditBox.Text = CurrentColumn.Text;\n            this.Focus();\n            e.Handled = true;\n            break;\n        }\n    }\n\n    [Browsable(false)]\n    public ListViewItem CurrentRow { get; set; }\n\n    [Browsable(false)]\n    public ListViewItem.ListViewSubItem CurrentColumn { get; set; }\n\n    [Browsable(false)]\n    public int CurrentRowIndex { get { return (CurrentRow == null) ? -1 : CurrentRow.Index; } }\n\n    [Browsable(false)]\n    public int CurrentColumnIndex { get { return (CurrentColumn == null) ? -1 : CurrentRow.SubItems.IndexOf(CurrentColumn); } }\n\n    protected override void OnItemCheck(ItemCheckEventArgs ice) {\n        if(CurrentColumn != null && CurrentColumnIndex != 0)\n            ice.NewValue = ice.CurrentValue;\n\n        base.OnItemCheck(ice);\n    }\n\n    protected override void OnMouseDown(MouseEventArgs e) {\n        Point loc = this.PointToClient(Cursor.Position);\n\n        CurrentRow = null;\n        CurrentColumn = null;\n\n        CurrentRow = this.GetItemAt(loc.X, loc.Y);\n        if(CurrentRow == null || !CurrentRow.Bounds.Contains(loc))\n            CurrentRow = null;\n        else {\n            CurrentColumn = CurrentRow.GetSubItemAt(loc.X, loc.Y);\n            if(CurrentColumn == null || !CurrentColumn.Bounds.Contains(loc))\n                CurrentColumn = null;\n        }\n\n        base.OnMouseDown(e);\n    }\n\n    protected override void OnResize(EventArgs e) {\n        this.Focus();\n        base.OnResize(e);\n    }\n\n    protected override void OnColumnWidthChanging(ColumnWidthChangingEventArgs e) {\n        this.Focus();\n        base.OnColumnWidthChanging(e);\n    }\n\n    protected override void OnNotifyMessage(Message m) {\n        switch(m.Msg) {\n        case WM_HSCROLL:\n        case WM_VSCROLL:\n            this.Focus();\n            break;\n        }\n        base.OnNotifyMessage(m);\n    }\n\n    const int WM_HSCROLL = 0x114;\n    const int WM_VSCROLL = 0x115;\n\n    public void EditColumn() {\n        if(CurrentColumn == null || CurrentColumnIndex == 0) return;\n\n        Rectangle rect = CurrentColumn.Bounds;\n        rect.Intersect(this.ClientRectangle);\n        rect.Y -= 1;\n\n        EditBox.Bounds = rect;\n        EditBox.Text = CurrentColumn.Text;\n        EditBox.Visible = true;\n        EditBox.BringToFront();\n        EditBox.Focus();\n    }\n}\n\n\u3044\u3084\u3044\u3084\u3001\u4f7f\u7528\u8aac\u660e\u3060\u3051\u306f\u3057\u306a\u304f\u3066\u306f\u2026\n\u4f7f\u3044\u305f\u3044\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4e2d\u306b ListVIewEx.cs \u306e\u30af\u30e9\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u3066\u3001\u4e0a\u8a18\u30bd\u30fc\u30b9\u3092\u307e\u308b\u3063\u3068\u8cbc\u308a\u4ed8\u3051\u3061\u3083\u3063\u3066\u4e0b\u3055\u3044\u3002\n\u4e00\u65e6\u5168\u4f53\u30d3\u30eb\u30c9\u3057\u305f\u3089\u3001\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9\u306b ListViewEx \u304c\u5897\u3048\u3066\u3044\u308b\u7b48\u306a\u306e\u3067\u30c7\u30b6\u30a4\u30ca\u753b\u9762\u3067\u4f7f\u3048\u307e\u3059\u3002\uff08\u52ff\u8ad6\u30d3\u30eb\u30c9\u30a8\u30e9\u30fc\u304c\u3042\u3063\u305f\u3089\u30c0\u30e1\u3067\u3059\u3088\uff09\n\n\n\n\u30d7\u30ed\u30d1\u30c6\u30a3\n\nCurrentRow\u3068CurrentRowIndex\u30d7\u30ed\u30d1\u30c6\u30a3\u304c\u5897\u3048\u3066\u307e\u3059\n\nCurrentColumn\u3068CurrentColumnIndex\u30d7\u30ed\u30d1\u30c6\u30a3\u3082\u5897\u3048\u3066\u307e\u3059\n\n\u30e1\u30bd\u30c3\u30c9\n\nEditColumn()\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059\n\n\n\u6a5f\u80fd\u306f\u540d\u524d\u304b\u3089\u63a8\u3057\u91cf\u3063\u3066\u4e0b\u3055\u3044\u3002\uff08\u6295\u3052\u3084\u308a\uff09\nEditColumn \u30e1\u30bd\u30c3\u30c9\u306f\u30d5\u30a9\u30fc\u30e0\u306b\u5f35\u308a\u4ed8\u3051\u305f ListViewEx \u306e MouseDoubleClick \u30a4\u30d9\u30f3\u30c8\u8fba\u308a\u3067\u5fc5\u8981\u6027\u3092\u78ba\u8a8d\u306e\u4e0a\u547c\u3073\u3060\u3059\u4ed5\u69d8\u3067\u3059\u3002\n\n\u30b3\u30fc\u30c9\u3067\u8aac\u660e\u3059\u308b\u3068\u3001\u3053\u3093\u306a\u611f\u3058\u2193\n\u3053\u308c\u3067\u524d\u7a3f\u3068\u540c\u3058\u304f\u3001\u30ab\u30e9\u30e02\u3060\u3051\u304c\u7de8\u96c6\u5bfe\u8c61\u3068\u306a\u308a\u307e\u3059\u3002\nprivate void listView1_MouseDoubleClick(object sender, MouseEventArgs e) {\n    if(listView1.CurrentColumnIndex == 1)\n        listView1.EditColumn();\n}\n\n\u4e00\u3064\u5fd8\u308c\u3082\u306e\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u30ab\u30e9\u30e0\u30b5\u30a4\u30ba\u3092\u8abf\u6574\u3057\u305f\u6642\u306b\u3082\u30e2\u30fc\u30c9\u629c\u3051\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3067\u3059\u306d\u3002\u30b5\u30d6\u30af\u30e9\u30b9\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u7e54\u308a\u8fbc\u3093\u3067\u3042\u308a\u307e\u3059\u3002\n\n\u6b21\u3078\u306e\u5e03\u77f3\n\u4eca\u56de\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u5316\u3067\u306f\u3001\u3069\u306e\u30ab\u30e9\u30e0\u304c\u7de8\u96c6\u5bfe\u8c61\u3067\u3042\u308b\u304b\u306f\u3001\u5916\u90e8\u304b\u3089\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\u30ab\u30e9\u30e0\u4f4d\u7f6e\u3067\u5224\u5b9a\u3057\u3066\u3044\u305f\u308a\u3059\u308b\u3068\u3001\u30b3\u30fc\u30c9\u306e\u53ef\u8aad\u6027\u306f\u843d\u3061\u307e\u3059\u3057\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u6027\u3082\u60aa\u304f\u306a\u308a\u307e\u3059\u3002\n\u3053\u3053\u306f\u3072\u3068\u3064ListViewItem\u306e\u30ab\u30e9\u30e0\u30d8\u30c3\u30c0\u8fba\u308a\u306b Editable \u307f\u305f\u3044\u306a\u30d7\u30ed\u30d1\u30c6\u30a3\u304c\u3042\u308b\u3068\u826f\u3044\u306e\u306b\u306a\u30fc\n\u3068\u304b\u601d\u3063\u3061\u3083\u3063\u305f\u306e\u304c\u904b\u306e\u5c3d\u304d\u3002\n\u66f4\u306b\u6ce5\u6cbc\u306b\u306f\u307e\u3063\u3066\u3044\u304f\u2026\n\u3061\u3085\u30fc\u4e8b\u3067\u6b21\u306fColumnHeader\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u5bfe\u5fdc\u304b\u3063\uff1f\n\u8acb\u3046\u3054\u671f\u5f85\uff01\n\n\u203b \u4e00\u65e6\u8133\u5473\u564c\u30af\u30fc\u30eb\u30c0\u30a6\u30f3\u56f3\u3063\u3066\u5225\u30cd\u30bf\u3092\u631f\u3080\u304b\u3082\u2026\n\n# \u524d\u53e3\u4e0a\n[\u524d\u7a3f](http://qiita.com/Toraja/items/51dd3ec878c647583231)\u3092\u53d7\u3051\u3066\u3001\u30b5\u30d6\u30af\u30e9\u30b9\u5316\u306b\u3066\u30ab\u30e9\u30e0\u76f4\u63a5\u7de8\u96c6\u3092\u5b9f\u73fe\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u5e8f\u306a\u306e\u3067\u3001\u3075\u3063\u304b\u3061\u3083\u3093\u30d0\u30fc\u30b8\u30e7\u30f3\u3082\u7d39\u4ecb\u3057\u3068\u304d\u307e\u3057\u3087\u3046\u3002\n\u305f\u3060\u3001\u5b9f\u306f\u3075\u3063\u304b\u3061\u3083\u3093\u3001MS\u306e\u30b5\u30a4\u30c8\u304b\u3089\u3046\u307e\u304f\u30b3\u30d4\u30fc\u3067\u304d\u306a\u3044\u30d1\u30bf\u30fc\u30f3\u304c\u3042\u308a\u307e\u3059\u3002\uff08\u6539\u884c\u304c\u3050\u3061\u3083\u3050\u3061\u3083\u3067\u2026\uff09\ncopy\u3057\u3066\u304f\u308b\u6642\u306f\u3061\u3087\u3063\u3068\u53e4\u3081\u306e\u4e0b\u8a18\u30b5\u30a4\u30c8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\uff08\u4e21\u65b9\u5fc5\u8981\u3067\u3059\uff09\n\n* [WndProcHooker](https://msdn.microsoft.com/ja-jp/library/ms229658(v=vs.80).aspx)\n* [Win32](https://msdn.microsoft.com/ja-jp/library/ms229683(v=vs.80).aspx)\n\n\u3042\u3001\u5f8c `Win32` \u306e\u4e2d\u306b\n`[DllImport(\"coredll.dll\")]`\n\u3063\u3066\u306e\u304c11\u30f6\u6240\u3042\u308a\u307e\u3059\u304c\u3001\u4f55\u304b\u5b9c\u3057\u304f\u306a\u3044\u306e\u3067\u3001\n`[DllImport(\"user32.dll\")]`\n\u306b\u5909\u3048\u3066\u4e0b\u3055\u3044\u3002\u554f\u984c\u306a\u3044\u7b48\u3067\u3059\u3002\n\n\n# \u3075\u3063\u304b\u3061\u3083\u3093\n[\u524d\u7a3f](http://qiita.com/Toraja/items/51dd3ec878c647583231)\u306e\u30b3\u30fc\u30c9\u306b\u524d\u51fa\u3075\u305f\u3064\u306e\u30b3\u30fc\u30c9\u3092\u5408\u308f\u305b\u305f\u4e0a\u3067\u3001\u4ee5\u4e0b\u306e\u69d8\u306b\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3059\u308c\u3070OK\u3067\u3059\u3002\n\n```csharp\npublic Form1() {\n\tInitializeComponent();\n\n    //    \u6b21\u306e\uff12\u884c\u3092\u8ffd\u52a0\u3059\u308b\n\tWndProcHooker.HookWndProc(listView1, new WndProcHooker.WndProcCallback(WM_Hook_Handler), WM_HSCROLL);\n\tWndProcHooker.HookWndProc(listView1, new WndProcHooker.WndProcCallback(WM_Hook_Handler), WM_VSCROLL);\n}\n\nconst int WM_HSCROLL = 0x114;\nconst int WM_VSCROLL = 0x115;\n\nint WM_Hook_Handler(IntPtr hwnd, uint msg, uint wParam, int lParam, ref bool handled) {\n\tControl.FromHandle(hwnd).Focus();\n\treturn -1;\n}\n\nprivate void Form1_FormClosing(object sender, FormClosingEventArgs e) {\n\tWndProcHooker.UnhookWndProc(listView1, WM_VSCROLL);\n\tWndProcHooker.UnhookWndProc(listView1, WM_HSCROLL);\n}\n```\n\n`ListView` \u306e\u30b9\u30af\u30ed\u30fc\u30eb\u30d0\u30fc\u3092\u89e6\u308b\u3068\u3001\u76f4\u63a5\u7de8\u96c6\u3061\u3063\u304f\u30e2\u30fc\u30c9\u629c\u3051\u305f\u3067\u3057\u3087\uff1f\n\u3075\u3063\u304b\u3061\u3083\u3093\u3001\u4e2d\u3005\u3084\u308b\u306a\u30fc\n\n# \u30b5\u30d6\u30af\u30e9\u30b9\u5316\n\u3044\u304d\u306a\u308a\u30bd\u30fc\u30b9\uff01\n\u306e\u307f\u3063\uff01\n\n```csharp\nusing System;\nusing System.ComponentModel;\nusing System.Drawing;\nusing System.Text;\nusing System.Windows.Forms;\n\npublic class ListViewEx : ListView {\n\tpublic ListViewEx() : base() {\n\t\tthis.SetStyle(ControlStyles.EnableNotifyMessage, true);\n\n\t\tthis.EditBox = new TextBox();\n\t\tthis.EditBox.Parent = this;\n\t\tthis.EditBox.Visible = false;\n\t\tthis.EditBox.BorderStyle = BorderStyle.FixedSingle;\n\t\tthis.EditBox.Leave += EditBox_Leave;\n\t\tthis.EditBox.KeyPress += EditBox_KeyPress;\n\t}\n\n\tprotected override void Dispose(bool disposing) {\n\t\tif(disposing) {\n\t\t\tthis.EditBox.KeyPress -= EditBox_KeyPress;\n\t\t\tthis.EditBox.Leave -= EditBox_Leave;\n\t\t\tthis.EditBox.Dispose();\n\t\t}\n\t\tbase.Dispose(disposing);\n\t}\n\n\tTextBox EditBox;\n\n\tprivate void EditBox_Leave(object sender, EventArgs e) {\n\t\tCurrentColumn.Text = EditBox.Text;\n\t\tEditBox.Visible = false;\n\t}\n\n\tprivate void EditBox_KeyPress(object sender, KeyPressEventArgs e) {\n\t\tswitch(e.KeyChar) {\n\t\tcase (char)Keys.Enter:\n\t\t\tthis.Focus();\n\t\t\te.Handled = true;\n\t\t\tbreak;\n\n\t\tcase (char)Keys.Escape:\n\t\t\tEditBox.Text = CurrentColumn.Text;\n\t\t\tthis.Focus();\n\t\t\te.Handled = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t[Browsable(false)]\n\tpublic ListViewItem CurrentRow { get; set; }\n\n\t[Browsable(false)]\n\tpublic ListViewItem.ListViewSubItem CurrentColumn { get; set; }\n\n\t[Browsable(false)]\n\tpublic int CurrentRowIndex { get { return (CurrentRow == null) ? -1 : CurrentRow.Index; } }\n\n\t[Browsable(false)]\n\tpublic int CurrentColumnIndex { get { return (CurrentColumn == null) ? -1 : CurrentRow.SubItems.IndexOf(CurrentColumn); } }\n\n\tprotected override void OnItemCheck(ItemCheckEventArgs ice) {\n\t\tif(CurrentColumn != null && CurrentColumnIndex != 0)\n\t\t\tice.NewValue = ice.CurrentValue;\n\n\t\tbase.OnItemCheck(ice);\n\t}\n\n\tprotected override void OnMouseDown(MouseEventArgs e) {\n\t\tPoint loc = this.PointToClient(Cursor.Position);\n\n\t\tCurrentRow = null;\n\t\tCurrentColumn = null;\n\n\t\tCurrentRow = this.GetItemAt(loc.X, loc.Y);\n\t\tif(CurrentRow == null || !CurrentRow.Bounds.Contains(loc))\n\t\t\tCurrentRow = null;\n\t\telse {\n\t\t\tCurrentColumn = CurrentRow.GetSubItemAt(loc.X, loc.Y);\n\t\t\tif(CurrentColumn == null || !CurrentColumn.Bounds.Contains(loc))\n\t\t\t\tCurrentColumn = null;\n\t\t}\n\n\t\tbase.OnMouseDown(e);\n\t}\n\n\tprotected override void OnResize(EventArgs e) {\n\t\tthis.Focus();\n\t\tbase.OnResize(e);\n\t}\n\n\tprotected override void OnColumnWidthChanging(ColumnWidthChangingEventArgs e) {\n\t\tthis.Focus();\n\t\tbase.OnColumnWidthChanging(e);\n\t}\n\n\tprotected override void OnNotifyMessage(Message m) {\n\t\tswitch(m.Msg) {\n\t\tcase WM_HSCROLL:\n\t\tcase WM_VSCROLL:\n\t\t\tthis.Focus();\n\t\t\tbreak;\n\t\t}\n\t\tbase.OnNotifyMessage(m);\n\t}\n\n\tconst int WM_HSCROLL = 0x114;\n\tconst int WM_VSCROLL = 0x115;\n\n\tpublic void EditColumn() {\n\t\tif(CurrentColumn == null || CurrentColumnIndex == 0) return;\n\n\t\tRectangle rect = CurrentColumn.Bounds;\n\t\trect.Intersect(this.ClientRectangle);\n\t\trect.Y -= 1;\n\n\t\tEditBox.Bounds = rect;\n\t\tEditBox.Text = CurrentColumn.Text;\n\t\tEditBox.Visible = true;\n\t\tEditBox.BringToFront();\n\t\tEditBox.Focus();\n\t}\n}\n```\n\n\u3044\u3084\u3044\u3084\u3001\u4f7f\u7528\u8aac\u660e\u3060\u3051\u306f\u3057\u306a\u304f\u3066\u306f\u2026\n\n\u4f7f\u3044\u305f\u3044\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4e2d\u306b `ListVIewEx.cs` \u306e\u30af\u30e9\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u3066\u3001\u4e0a\u8a18\u30bd\u30fc\u30b9\u3092\u307e\u308b\u3063\u3068\u8cbc\u308a\u4ed8\u3051\u3061\u3083\u3063\u3066\u4e0b\u3055\u3044\u3002\n\u4e00\u65e6\u5168\u4f53\u30d3\u30eb\u30c9\u3057\u305f\u3089\u3001\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9\u306b `ListViewEx` \u304c\u5897\u3048\u3066\u3044\u308b\u7b48\u306a\u306e\u3067\u30c7\u30b6\u30a4\u30ca\u753b\u9762\u3067\u4f7f\u3048\u307e\u3059\u3002\uff08\u52ff\u8ad6\u30d3\u30eb\u30c9\u30a8\u30e9\u30fc\u304c\u3042\u3063\u305f\u3089\u30c0\u30e1\u3067\u3059\u3088\uff09\n<br/>\n<dl>\n<dt>\u30d7\u30ed\u30d1\u30c6\u30a3</dt>\n<dd>CurrentRow\u3068CurrentRowIndex\u30d7\u30ed\u30d1\u30c6\u30a3\u304c\u5897\u3048\u3066\u307e\u3059</dd>\n<dd>CurrentColumn\u3068CurrentColumnIndex\u30d7\u30ed\u30d1\u30c6\u30a3\u3082\u5897\u3048\u3066\u307e\u3059</dd>\n<dt>\u30e1\u30bd\u30c3\u30c9</dt>\n<dd>EditColumn()\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u3059</dd>\n</dl>\n\n\u6a5f\u80fd\u306f\u540d\u524d\u304b\u3089\u63a8\u3057\u91cf\u3063\u3066\u4e0b\u3055\u3044\u3002\uff08\u6295\u3052\u3084\u308a\uff09\n\n`EditColumn` \u30e1\u30bd\u30c3\u30c9\u306f\u30d5\u30a9\u30fc\u30e0\u306b\u5f35\u308a\u4ed8\u3051\u305f `ListViewEx` \u306e `MouseDoubleClick` \u30a4\u30d9\u30f3\u30c8\u8fba\u308a\u3067\u5fc5\u8981\u6027\u3092\u78ba\u8a8d\u306e\u4e0a\u547c\u3073\u3060\u3059\u4ed5\u69d8\u3067\u3059\u3002\n<br/>\n\u30b3\u30fc\u30c9\u3067\u8aac\u660e\u3059\u308b\u3068\u3001\u3053\u3093\u306a\u611f\u3058\u2193\n\u3053\u308c\u3067\u524d\u7a3f\u3068\u540c\u3058\u304f\u3001\u30ab\u30e9\u30e02\u3060\u3051\u304c\u7de8\u96c6\u5bfe\u8c61\u3068\u306a\u308a\u307e\u3059\u3002\n\n```csharp\nprivate void listView1_MouseDoubleClick(object sender, MouseEventArgs e) {\n\tif(listView1.CurrentColumnIndex == 1)\n        listView1.EditColumn();\n}\n```\n\n\u4e00\u3064\u5fd8\u308c\u3082\u306e\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u30ab\u30e9\u30e0\u30b5\u30a4\u30ba\u3092\u8abf\u6574\u3057\u305f\u6642\u306b\u3082\u30e2\u30fc\u30c9\u629c\u3051\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3067\u3059\u306d\u3002\u30b5\u30d6\u30af\u30e9\u30b9\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u7e54\u308a\u8fbc\u3093\u3067\u3042\u308a\u307e\u3059\u3002\n\n\n# \u6b21\u3078\u306e\u5e03\u77f3\n\u4eca\u56de\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u5316\u3067\u306f\u3001\u3069\u306e\u30ab\u30e9\u30e0\u304c\u7de8\u96c6\u5bfe\u8c61\u3067\u3042\u308b\u304b\u306f\u3001\u5916\u90e8\u304b\u3089\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\n\u30ab\u30e9\u30e0\u4f4d\u7f6e\u3067\u5224\u5b9a\u3057\u3066\u3044\u305f\u308a\u3059\u308b\u3068\u3001\u30b3\u30fc\u30c9\u306e\u53ef\u8aad\u6027\u306f\u843d\u3061\u307e\u3059\u3057\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u6027\u3082\u60aa\u304f\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u3053\u306f\u3072\u3068\u3064ListViewItem\u306e\u30ab\u30e9\u30e0\u30d8\u30c3\u30c0\u8fba\u308a\u306b `Editable` \u307f\u305f\u3044\u306a\u30d7\u30ed\u30d1\u30c6\u30a3\u304c\u3042\u308b\u3068\u826f\u3044\u306e\u306b\u306a\u30fc\n\n\u3068\u304b\u601d\u3063\u3061\u3083\u3063\u305f\u306e\u304c\u904b\u306e\u5c3d\u304d\u3002\n\u66f4\u306b\u6ce5\u6cbc\u306b\u306f\u307e\u3063\u3066\u3044\u304f\u2026\n\n\u3061\u3085\u30fc\u4e8b\u3067\u6b21\u306fColumnHeader\u306e\u30b5\u30d6\u30af\u30e9\u30b9\u5bfe\u5fdc\u304b\u3063\uff1f\n\u8acb\u3046\u3054\u671f\u5f85\uff01\n<br/>\n\u203b \u4e00\u65e6\u8133\u5473\u564c\u30af\u30fc\u30eb\u30c0\u30a6\u30f3\u56f3\u3063\u3066\u5225\u30cd\u30bf\u3092\u631f\u3080\u304b\u3082\u2026\n", "tags": ["C#", "ListView"]}