{"context": " More than 1 year has passed since last update.\u30c6\u30b9\u30c8\u7528VM\uff08Ubuntu\uff09\u306b apache\u3084\u3089 php\u3084\u3089\u5165\u308c\u305f\u3082\u306e\u306b \u66f4\u306b\u8272\u3005\u5165\u308c\u307e\u3059\u3002\nGit\u3068 rbenv \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo apt-get install git rbenv\n\nrbenv\u306e\u30d1\u30b9\u3092 .bashrc\u306b\u8ffd\u52a0\n$ vim .bashrc \n    export PATH=\"$HOME/.rbenv/bin:$PATH\"\n    eval \"\"$(rbenv init -)\"\n$ source .bashrc\n\nruby-build \u3092 clone\n$ git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build \n\nRuby 2.2.2 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ rbenv install -l\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067 \u3068\u308a\u3042\u3048\u305a 2.2.2\u306b\u3059\u308b\n$ rbenv install 2.2.2  \n    BUILD FAILED (Ubuntu 14.04 \u30fb\u30fb\u30fb\u30fb)\n    Try running `apt-get install -y libreadline-dev` to fetch missing dependencies.\n\n\u30fb\u30fb\u30fb\u99c4\u76ee\u3060\u3063\u305f\u306e\u3067 \u7d20\u76f4\u306b\u5f93\u3046\n$ sudo apt-get install -y libreadline-dev\n\n\n$ rbenv install 2.2.2  \n    Installed ruby-2.2.2\n\n\u3044\u3051\u305f\uff01\nruby\u306e\u4f7f\u7528\u3059\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\n$ rbenv versions\n    * system (set by /home/ubuntu/.rbenv/version)\n      2.2.2\n\n$ rbenv global 2.2.2  \n      system\n    * 2.2.2 (set by /home/ubuntu/.rbenv/version)\n\n$ ruby -v \n    ruby 2.2.2\n\nPhantomJS\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo apt-get install phantomjs\n\nbundler\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ gem install bundler\n$ bundle -v\n    Bundler version 1.10.6\n\n\u30c6\u30b9\u30c8\u7528\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n$ mkdir test\n$ cd test\n\nGemfile\u3092\u4f5c\u6210\u3057\u3066 Capybara\u3001Rspec\u3001Poltergeist\u3001\u8af8\u3005\u5fc5\u8981\u305d\u3046\u306a\u3082\u306e \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb \n$ vim Gemfile \n    source 'https://rubygems.org'\n\n    gem 'capybara-mechanize'\n    gem 'rspec'\n    gem 'poltergeist'\"\n\n$ bundle install --path vendor/bundle \n\n\u30c6\u30b9\u30c8\u30da\u30fc\u30b8\u7528\u610f\u3002\n\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u5165\u529b\u3057\u305f\u5185\u5bb9\u304c \"This is a \u25cb\u25cb\"\u3067\u8868\u793a\u3055\u308c\u308b PHP\u30da\u30fc\u30b8\n $ vim test.php \n\n\ntest.php\n<?php\n$text = htmlspecialchars($_GET[\"inputtext\"], ENT_QUOTES, 'UTF-8');\nif($text) $text = \"This is a {$text}.\";\n\nprint <<<EOF\n<html>\n<body>\n<h1>Test Form</h1>\n\n<div id=\"text_view\">{$text}</div>\n\n<form>\n<input type=\"text\" name=\"inputtext\" id=\"input_text\">\n<input type=\"submit\" id=\"submit_btn\">\n</form>\n\n</body>\n</html>\nEOF;\n?>\n\n\nspec_helper\u4f5c\u6210\n$ vim spec/spec_helper.rb \n\n\nspec_helper.rb\n# encoding: utf-8\nrequire 'capybara/rspec'\nrequire 'capybara/poltergeist'\n\n\nCapybara.default_driver = :poltergeist\nCapybara.app_host = '\uff08\u30c6\u30b9\u30c8\u30da\u30fc\u30b8\u30db\u30b9\u30c8\uff09'\nCapybara.run_server = false\n\n\n\u30c6\u30b9\u30c8\u3092\u66f8\u304f\n$ vim spec/test_spec.rb\n\n\ntest_spec.rb\n# encoding: utf-8\nrequire 'spec_helper'\n\ndescribe '\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u30da\u30fc\u30b8' do\n before do\n  # \u5165\u529b\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\n  visit \"/test/test.php\"\n end\n\n scenario '\u753b\u9762\u304c\u958b\u3044\u3066\u3044\u308b' do\n     expect(page).to have_content 'Test Form'\n end\n\n scenario 'pen\u3092\u5165\u529b\u3059\u308b' do\n     fill_in 'input_text', with: 'pen'\n     click_on 'submit_btn'\n\n     #'This is a pen.'\u3063\u3066\u8868\u793a\u3055\u308c\u3066\u308b\u306f\u305a\n     expect(page).to have_selector '#text_view', text: 'This is a pen.'\n end\nend\n\n\n\u30c6\u30b9\u30c8\n$ bundle exec rspec spec/test_spec.rb \n    undefined method `visit' for #<RSpec::ExampleGroups::Nested:0x007f1efc20bc38>\n\nvisit \u304c\u7121\u3044\u3063\u3066\u8a00\u308f\u308c\u3066\u308b\uff1f\nspec_helper.rb \u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\u53c2\u8003\uff1a http://qiita.com/katryo/items/d001c7058e45506ef1b7\n\nspec_helper.rb\nRSpec.configure do |config|\n  include Capybara::DSL\nend**\n\n\n\u3082\u3046\u4e00\u56de\u30c6\u30b9\u30c8\n$ bundle exec rspec spec/test_spec.rb \n    Finished in 0.4502 seconds (files took 0.29978 seconds to load)\n    2 examples, 0 failures\n\n\u3044\u3051\u307e\u3057\u305f\uff01\n\u65e5\u672c\u8a9e\u5165\u529b\u30c6\u30b9\u30c8\u3082\u8ffd\u52a0\u3057\u3066\u307f\u308b \n\ntest_spec.rb\n# encoding: utf-8\nrequire 'spec_helper'\n\ndescribe '\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u30da\u30fc\u30b8' do\n before do\n  # \u5165\u529b\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\n  visit \"/test/test.php\"\n end\n\n scenario '\u753b\u9762\u304c\u958b\u3044\u3066\u3044\u308b' do\n     expect(page).to have_content 'Test Form'\n end\n\n scenario 'pen\u3092\u5165\u529b\u3059\u308b' do\n     #puts source\n     fill_in 'input_text', with: 'pen'\n     click_on 'submit_btn'\n     expect(page).to have_selector '#text_view', text: 'This is a pen.'\n end\n\n scenario '\u307a\u3093\u3092\u5165\u529b\u3059\u308b' do\n     #puts source\n     fill_in 'input_text', with: '\u307a\u3093'\n     click_on 'submit_btn'\n     expect(page).to have_selector '#text_view', text: 'This is a \u307a\u3093.'\n end\nend\n\n\n$ bundle exec rspec spec/test_spec.rb \n    Finished in 0.72215 seconds (files took 0.3276 seconds to load)\n    3 examples, 0 failures\n\n\u3059\u3079\u3066OK\n\u30c6\u30b9\u30c8\u7528VM\uff08Ubuntu\uff09\u306b apache\u3084\u3089 php\u3084\u3089\u5165\u308c\u305f\u3082\u306e\u306b \u66f4\u306b\u8272\u3005\u5165\u308c\u307e\u3059\u3002\n\nGit\u3068 rbenv \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ sudo apt-get install git rbenv\n```\n\nrbenv\u306e\u30d1\u30b9\u3092 .bashrc\u306b\u8ffd\u52a0\n\n```\n$ vim .bashrc \n\texport PATH=\"$HOME/.rbenv/bin:$PATH\"\n\teval \"\"$(rbenv init -)\"\n$ source .bashrc\n```\n\nruby-build \u3092 clone\n\n```\n$ git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build \n```\n\n\nRuby 2.2.2 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ rbenv install -l\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067 \u3068\u308a\u3042\u3048\u305a 2.2.2\u306b\u3059\u308b\n\n```\n$ rbenv install 2.2.2  \n\tBUILD FAILED (Ubuntu 14.04 \u30fb\u30fb\u30fb\u30fb)\n\tTry running `apt-get install -y libreadline-dev` to fetch missing dependencies.\n```\n\n\u30fb\u30fb\u30fb\u99c4\u76ee\u3060\u3063\u305f\u306e\u3067 \u7d20\u76f4\u306b\u5f93\u3046\n\n```\n$ sudo apt-get install -y libreadline-dev\n\n\n$ rbenv install 2.2.2  \n\tInstalled ruby-2.2.2\n```\n\n\u3044\u3051\u305f\uff01\n\n\nruby\u306e\u4f7f\u7528\u3059\u308b\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\n\n```\n$ rbenv versions\n\t* system (set by /home/ubuntu/.rbenv/version)\n\t  2.2.2\n\n$ rbenv global 2.2.2  \n\t  system\n\t* 2.2.2 (set by /home/ubuntu/.rbenv/version)\n\t\n$ ruby -v \n\truby 2.2.2\n```\n\nPhantomJS\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ sudo apt-get install phantomjs\n```\n\nbundler\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ gem install bundler\n$ bundle -v\n\tBundler version 1.10.6\n```\n\n\u30c6\u30b9\u30c8\u7528\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210\n\n```\n$ mkdir test\n$ cd test\n```\n\nGemfile\u3092\u4f5c\u6210\u3057\u3066 Capybara\u3001Rspec\u3001Poltergeist\u3001\u8af8\u3005\u5fc5\u8981\u305d\u3046\u306a\u3082\u306e \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb \n\n```\n$ vim Gemfile \n\tsource 'https://rubygems.org'\n\t\n\tgem 'capybara-mechanize'\n\tgem 'rspec'\n\tgem 'poltergeist'\"\n\n$ bundle install --path vendor/bundle \n```\n\n\n\u30c6\u30b9\u30c8\u30da\u30fc\u30b8\u7528\u610f\u3002\n\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u5165\u529b\u3057\u305f\u5185\u5bb9\u304c \"This is a \u25cb\u25cb\"\u3067\u8868\u793a\u3055\u308c\u308b PHP\u30da\u30fc\u30b8\n\n```\n $ vim test.php \n```\n\n```php:test.php\n<?php\n$text = htmlspecialchars($_GET[\"inputtext\"], ENT_QUOTES, 'UTF-8');\nif($text) $text = \"This is a {$text}.\";\n\nprint <<<EOF\n<html>\n<body>\n<h1>Test Form</h1>\n\n<div id=\"text_view\">{$text}</div>\n\n<form>\n<input type=\"text\" name=\"inputtext\" id=\"input_text\">\n<input type=\"submit\" id=\"submit_btn\">\n</form>\n\n</body>\n</html>\nEOF;\n?>\n```\n\n\n\n\nspec_helper\u4f5c\u6210\n\n```\n$ vim spec/spec_helper.rb \n```\n\n```ruby:spec_helper.rb \n# encoding: utf-8\nrequire 'capybara/rspec'\nrequire 'capybara/poltergeist'\n\n\nCapybara.default_driver = :poltergeist\nCapybara.app_host = '\uff08\u30c6\u30b9\u30c8\u30da\u30fc\u30b8\u30db\u30b9\u30c8\uff09'\nCapybara.run_server = false\n```\n\n\u30c6\u30b9\u30c8\u3092\u66f8\u304f\n\n```\n$ vim spec/test_spec.rb\n```\n\n```ruby:test_spec.rb \n# encoding: utf-8\nrequire 'spec_helper'\n\ndescribe '\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u30da\u30fc\u30b8' do\n before do\n  # \u5165\u529b\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\n  visit \"/test/test.php\"\n end\n \n scenario '\u753b\u9762\u304c\u958b\u3044\u3066\u3044\u308b' do\n     expect(page).to have_content 'Test Form'\n end\n \n scenario 'pen\u3092\u5165\u529b\u3059\u308b' do\n     fill_in 'input_text', with: 'pen'\n     click_on 'submit_btn'\n\n     #'This is a pen.'\u3063\u3066\u8868\u793a\u3055\u308c\u3066\u308b\u306f\u305a\n     expect(page).to have_selector '#text_view', text: 'This is a pen.'\n end\nend\n```\n\n\u30c6\u30b9\u30c8\n\n```\n$ bundle exec rspec spec/test_spec.rb \n\tundefined method `visit' for #<RSpec::ExampleGroups::Nested:0x007f1efc20bc38>\n```\n\nvisit \u304c\u7121\u3044\u3063\u3066\u8a00\u308f\u308c\u3066\u308b\uff1f\nspec_helper.rb \u306b\u4e0b\u8a18\u3092\u8ffd\u8a18\n\u53c2\u8003\uff1a http://qiita.com/katryo/items/d001c7058e45506ef1b7\n\n```ruby:spec_helper.rb \nRSpec.configure do |config|\n  include Capybara::DSL\nend**\n```\n\n\u3082\u3046\u4e00\u56de\u30c6\u30b9\u30c8\n\n```\n$ bundle exec rspec spec/test_spec.rb \n\tFinished in 0.4502 seconds (files took 0.29978 seconds to load)\n\t2 examples, 0 failures\n```\n\n\u3044\u3051\u307e\u3057\u305f\uff01\n\n\u65e5\u672c\u8a9e\u5165\u529b\u30c6\u30b9\u30c8\u3082\u8ffd\u52a0\u3057\u3066\u307f\u308b \n\n```ruby:test_spec.rb \n# encoding: utf-8\nrequire 'spec_helper'\n\ndescribe '\u5165\u529b\u30d5\u30a9\u30fc\u30e0\u30da\u30fc\u30b8' do\n before do\n  # \u5165\u529b\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\n  visit \"/test/test.php\"\n end\n \n scenario '\u753b\u9762\u304c\u958b\u3044\u3066\u3044\u308b' do\n     expect(page).to have_content 'Test Form'\n end\n \n scenario 'pen\u3092\u5165\u529b\u3059\u308b' do\n     #puts source\n     fill_in 'input_text', with: 'pen'\n     click_on 'submit_btn'\n     expect(page).to have_selector '#text_view', text: 'This is a pen.'\n end\n \n scenario '\u307a\u3093\u3092\u5165\u529b\u3059\u308b' do\n     #puts source\n     fill_in 'input_text', with: '\u307a\u3093'\n     click_on 'submit_btn'\n     expect(page).to have_selector '#text_view', text: 'This is a \u307a\u3093.'\n end\nend\n```\n\n```\n$ bundle exec rspec spec/test_spec.rb \n\tFinished in 0.72215 seconds (files took 0.3276 seconds to load)\n\t3 examples, 0 failures\n```\n\n\u3059\u3079\u3066OK\n\n\n\n", "tags": ["RSpec", "Capybara", "poltergeist"]}