{"tags": ["Electron"], "context": "Electron\u3067\u30a2\u30d7\u30ea\u3092\u4f5c\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\nmain.js\nconst { app, BrowserWindow } = require('electron');\nconst path = require('path');\nconst url = require('url');\n\n...\n\nfunction createWindow() {\n  win = new BrowserWindow({ width: 800, height: 600 });\n\n  win.loadURL(url.format({\n    pathname: path.join(__dirname, 'index.html'),\n    protocol: 'file:',\n    slashes: true,\n  }));\n  ...\n}\n\napp.on('ready', createWindow);\n\n...\n\n\n\nindex.html\n<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Hoge</title>\n    <link rel=\"stylesheet\" href=\"/style.css\">\n  </head>\n  <body>\n    <div id=\"root\">\n    </div>\n\n    <script type=\"text/javascript\" src=\"/app.js\">\n    </script>\n  </body>\n</html>\n\n\n\u3057\u304b\u3057\u3001index.html\u306e\u4e2d\u3067/style.css\u3084/app.js\u3092\u7d76\u5bfe\u30d1\u30b9\u3067\u6307\u5b9a\u3059\u308b\u3068\u6b63\u3057\u304f\u8aad\u307f\u8fbc\u3081\u307e\u305b\u3093\u3002\u7d76\u5bfe\u30d1\u30b9\u3067\u66f8\u304f\u3068\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u30eb\u30fc\u30c8\u3092\u57fa\u70b9\u3068\u3057\u3066\u30d1\u30b9\u304c\u63a2\u7d22\u3055\u308c\u307e\u3059(\u5f53\u305f\u308a\u524d\u3067\u3059\u306d)\u3002\u76f8\u5bfe\u30d1\u30b9\u3067\u66f8\u3051\u3070\u3001\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u8d77\u70b9\u306b\u3057\u3066\u63a2\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u6b63\u3057\u304f\u52d5\u304d\u307e\u3059\u304c\u3001web\u30b5\u30a4\u30c8\u3068\u30b3\u30fc\u30c9\u3092\u5171\u901a\u5316\u3057\u3066\u3044\u305f\u308a\u3059\u308b\u3068\u3001main.js\u3068\u540c\u968e\u5c64\u3092/\u3068\u3057\u3066\u6271\u3044\u7d76\u5bfe\u30d1\u30b9\u3067\u66f8\u304d\u305f\u304b\u3063\u305f\u308a\u3057\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001main.js\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\nmain.js\nconst { app, BrowserWindow, protocol } = require('electron');\nconst path = require('path');\nconst url = require('url');\n\n...\n\napp.on('ready', () => {\n  protocol.interceptFileProtocol('file', (req, callback) => {\n    const requestedUrl = req.url.substr(7);\n\n    if (path.isAbsolute(requestedUrl)) {\n      callback(path.normalize(path.join(__dirname, requestedUrl)));\n    } else {\n      callback(requestedUrl);\n    }\n  });\n});\n\nfunction createWindow() {\n  win = new BrowserWindow({ width: 800, height: 600 });\n\n  win.loadURL(url.format({\n    pathname: '/index.html',\n    protocol: 'file:',\n    slashes: true,\n  }));\n  ...\n}\n\napp.on('ready', createWindow);\n\n...\n\n\nelectron.protocol.interceptFileProtocol()\u3067\u3001URL\u89e3\u91c8\u3092\u7279\u5b9a\u306e\u30b9\u30ad\u30fc\u30de\u306b\u3064\u3044\u3066\u5272\u308a\u8fbc\u3081\u307e\u3059\u3002\n\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u6642\u306ffile\u3068\u3044\u3046\u30b9\u30ad\u30fc\u30de(\u4f8b:file:///hoge/fuga)\u306a\u306e\u3067\u3001\u305d\u306e\u51e6\u7406\u306b\u5272\u308a\u8fbc\u3093\u3067\u7d76\u5bfe\u30d1\u30b9\u306e\u5834\u5408\u306f__dirname\u3092\u8db3\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u4ee5\u4e0a\u306e\u51e6\u7406\u3092\u8db3\u3057\u305f\u306e\u3067\u3001win.loadURL()\u306b\u6e21\u3059URL\u306f__dirname\u3092\u8db3\u3057\u3066\u30d5\u30eb\u30d1\u30b9\u306b\u3057\u3066\u304a\u304f\u5fc5\u8981\u306f\u306a\u304f\u3001\u73fe\u5728\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092/\u3068\u3057\u3066\u8003\u3048\u305f\u7d76\u5bfe\u30d1\u30b9\u3067\u66f8\u304f\u3088\u3046\u306b\u5909\u3048\u307e\u3059\u3002\n\u53c2\u8003: https://github.com/electron/electron/issues/4612\nElectron\u3067\u30a2\u30d7\u30ea\u3092\u4f5c\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n```js:main.js\nconst { app, BrowserWindow } = require('electron');\nconst path = require('path');\nconst url = require('url');\n\n...\n\nfunction createWindow() {\n  win = new BrowserWindow({ width: 800, height: 600 });\n\n  win.loadURL(url.format({\n    pathname: path.join(__dirname, 'index.html'),\n    protocol: 'file:',\n    slashes: true,\n  }));\n  ...\n}\n\napp.on('ready', createWindow);\n\n...\n```\n\n\n```html:index.html\n<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Hoge</title>\n    <link rel=\"stylesheet\" href=\"/style.css\">\n  </head>\n  <body>\n    <div id=\"root\">\n    </div>\n\n    <script type=\"text/javascript\" src=\"/app.js\">\n    </script>\n  </body>\n</html>\n```\n\n\u3057\u304b\u3057\u3001`index.html`\u306e\u4e2d\u3067`/style.css`\u3084`/app.js`\u3092\u7d76\u5bfe\u30d1\u30b9\u3067\u6307\u5b9a\u3059\u308b\u3068\u6b63\u3057\u304f\u8aad\u307f\u8fbc\u3081\u307e\u305b\u3093\u3002\u7d76\u5bfe\u30d1\u30b9\u3067\u66f8\u304f\u3068\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u30eb\u30fc\u30c8\u3092\u57fa\u70b9\u3068\u3057\u3066\u30d1\u30b9\u304c\u63a2\u7d22\u3055\u308c\u307e\u3059(\u5f53\u305f\u308a\u524d\u3067\u3059\u306d)\u3002\u76f8\u5bfe\u30d1\u30b9\u3067\u66f8\u3051\u3070\u3001\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u8d77\u70b9\u306b\u3057\u3066\u63a2\u3057\u3066\u304f\u308c\u308b\u306e\u3067\u6b63\u3057\u304f\u52d5\u304d\u307e\u3059\u304c\u3001web\u30b5\u30a4\u30c8\u3068\u30b3\u30fc\u30c9\u3092\u5171\u901a\u5316\u3057\u3066\u3044\u305f\u308a\u3059\u308b\u3068\u3001`main.js`\u3068\u540c\u968e\u5c64\u3092`/`\u3068\u3057\u3066\u6271\u3044\u7d76\u5bfe\u30d1\u30b9\u3067\u66f8\u304d\u305f\u304b\u3063\u305f\u308a\u3057\u307e\u3059\u3002\n\n\u305d\u3053\u3067\u3001`main.js`\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```js:main.js\nconst { app, BrowserWindow, protocol } = require('electron');\nconst path = require('path');\nconst url = require('url');\n\n...\n\napp.on('ready', () => {\n  protocol.interceptFileProtocol('file', (req, callback) => {\n    const requestedUrl = req.url.substr(7);\n\n    if (path.isAbsolute(requestedUrl)) {\n      callback(path.normalize(path.join(__dirname, requestedUrl)));\n    } else {\n      callback(requestedUrl);\n    }\n  });\n});\n\nfunction createWindow() {\n  win = new BrowserWindow({ width: 800, height: 600 });\n\n  win.loadURL(url.format({\n    pathname: '/index.html',\n    protocol: 'file:',\n    slashes: true,\n  }));\n  ...\n}\n\napp.on('ready', createWindow);\n\n...\n```\n\n`electron.protocol.interceptFileProtocol()`\u3067\u3001URL\u89e3\u91c8\u3092\u7279\u5b9a\u306e\u30b9\u30ad\u30fc\u30de\u306b\u3064\u3044\u3066\u5272\u308a\u8fbc\u3081\u307e\u3059\u3002\n\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u6642\u306f`file`\u3068\u3044\u3046\u30b9\u30ad\u30fc\u30de(\u4f8b:`file:///hoge/fuga`)\u306a\u306e\u3067\u3001\u305d\u306e\u51e6\u7406\u306b\u5272\u308a\u8fbc\u3093\u3067\u7d76\u5bfe\u30d1\u30b9\u306e\u5834\u5408\u306f`__dirname`\u3092\u8db3\u3059\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u4ee5\u4e0a\u306e\u51e6\u7406\u3092\u8db3\u3057\u305f\u306e\u3067\u3001`win.loadURL()`\u306b\u6e21\u3059URL\u306f`__dirname`\u3092\u8db3\u3057\u3066\u30d5\u30eb\u30d1\u30b9\u306b\u3057\u3066\u304a\u304f\u5fc5\u8981\u306f\u306a\u304f\u3001\u73fe\u5728\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092`/`\u3068\u3057\u3066\u8003\u3048\u305f\u7d76\u5bfe\u30d1\u30b9\u3067\u66f8\u304f\u3088\u3046\u306b\u5909\u3048\u307e\u3059\u3002\n\n\u53c2\u8003: https://github.com/electron/electron/issues/4612\n"}