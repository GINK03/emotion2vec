{"tags": ["sidekiq"], "context": "Say you\u2019re building an app that needs to send emails. We all agree that we should never block the controller, so async delivery is the way to go. To achieve this, we\u2019ll move our email sending code outside the original request/response cycle with the help of an asynchronous processing library that can handle jobs in the background.\nHow can we be confident that our code behaves as expected upon making this change? In this blog post, we\u2019ll look at a way to test it. And we\u2019ll use MiniTest (since it ships with Rails) but the concepts presented here can be easily translated to RSpec.\nThe good news is that since Rails 4.2, sending emails asynchronously is easier than ever before. We\u2019ll use Sidekiq as the queuing system in our example, but since ActionMailer#deliver_later is built on top of ActiveJob, the interface is clean and agnostic of the asynchronous processing library used. This means that if I hadn\u2019t just mentioned it, you wouldn\u2019t be able to tell, as a developer or a user. Setting up a queuing system is a topic on it\u2019s own, you can read more on getting started with Active Job here.\nSay you\u2019re building an app that needs to send emails. We all agree that we should never block the controller, so async delivery is the way to go. To achieve this, we\u2019ll move our email sending code outside the original request/response cycle with the help of an asynchronous processing library that can handle jobs in the background.\nHow can we be confident that our code behaves as expected upon making this change? In this blog post, we\u2019ll look at a way to test it. And we\u2019ll use MiniTest (since it ships with Rails) but the concepts presented here can be easily translated to RSpec.\nThe good news is that since Rails 4.2, sending emails asynchronously is easier than ever before. We\u2019ll use Sidekiq as the queuing system in our example, but since ActionMailer#deliver_later is built on top of ActiveJob, the interface is clean and agnostic of the asynchronous processing library used. This means that if I hadn\u2019t just mentioned it, you wouldn\u2019t be able to tell, as a developer or a user. Setting up a queuing system is a topic on it\u2019s own, you can read more on getting started with Active Job here.\n"}