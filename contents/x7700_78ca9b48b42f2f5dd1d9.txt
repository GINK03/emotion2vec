{"context": "\n\nZynq\u3067\u30ed\u30dc\u30c3\u30c8\u5236\u5fa1\u3057\u307e\u3059\nZynq\u306e\u7fd2\u4f5c\u304c\u5fc5\u8981\u3060\u3063\u305f\u306e\u3067\u30ed\u30dc\u30c3\u30c8\u306b\u4f7f\u3044\u307e\u3057\u305f\u3002\n\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u305f\u969b\u306e\u6280\u8853\u7684\u306a\u8a71\u3092\u3057\u3066\u3044\u3053\u3046\u304b\u3068\u601d\u3063\u3066\u307e\u3059\u3002\n\u7279\u306b\u3001HDL\u306e\u8a18\u4e8b\u306f\u5c11\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u305d\u306e\u8fba\u3092\u4e2d\u5fc3\u306b\u8a9e\u3063\u3066\u3044\u3053\u3046\u304b\u306a\u3068\u3002\n\n\u56f3\uff11\u3000\u304a\u624b\u4e0a\u3052\u306e\u56f3\nZynq\u306e\u30dc\u30fc\u30c9\u306fZynqBerry\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\nhttp://www.trenz.jp/products/te0726/\nRaspberryPi\u306eZynq\u7248\u3067\u3001GPIO\u304c\u30d4\u30f3\u30d8\u30c3\u30c0\u3067\u51fa\u3066\u308b\u306e\u3067\u90fd\u5408\u304c\u3088\u3044\u306e\u3067\u3059\u3002\n\u305d\u308c\u3092\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u57fa\u677f\u3067RC\u30b5\u30fc\u30dc\u306b\u96fb\u6e90\u3068\u4fe1\u53f7\u3092\u4e0e\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u5de5\u4f5c\u3057\u307e\u3057\u305f\u3002\n\n\u5f79\u5272\u5206\u62c5\nZynq\u306b\u306fARM\u30d7\u30ed\u30bb\u30c3\u30b5\uff08Zynq\u3067\u306fPS\u3068\u547c\u3076\uff09\u3068FPGA\uff08\u540c\u3058\u304fPL\uff09\u304c\u5165\u3063\u3066\u307e\u3059\u3002\nPS\u3068PL\u306e\u5f79\u5272\u5206\u62c5\u3067\u3059\u304c\u3001PS\u3067\u306f\u30ed\u30dc\u30c3\u30c8\u306e\u30e2\u30fc\u30b7\u30e7\u30f3\u3092UART\u304b\u3089\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30d5\u30e9\u30c3\u30b7\u30e5\u306e\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u9818\u57df\uff08PS\u306e\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u3068PL\u306e\u30d3\u30c3\u30c8\u30b9\u30c8\u30ea\u30fc\u30e0\uff09\u3088\u308a\u5f8c\u308d\u306b\u683c\u7d0d\u3001\u53d6\u308a\u51fa\u3057\u3092\u884c\u3044\u307e\u3059\u3002\nPL\u3067\u306fRC\u30b5\u30fc\u30dc\u306e\u5236\u5fa1\u3068RC\u53d7\u4fe1\u5668\u306e\u4fe1\u53f7\u53d6\u308a\u8fbc\u307f\u3092\u3084\u3063\u3066\u307e\u3059\u3002\n\u3064\u307e\u308a\u3001RC\u7cfb\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u5236\u5fa1\u3092\u30cf\u30fc\u30c9\u51e6\u7406\u3068\u3057\u3001\u30bd\u30d5\u30c8\u306f\u59ff\u52e2\u306e\u5236\u5fa1\u306b\u5c02\u5ff5\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\nPS\u3068PL\u306e\u63a5\u7d9a\u306fAXI-GPIO\u3067\u3059\u3002RC\u7cfb\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u90e8\u306f\u5143\u3005Lattice\u306e\u30c7\u30d0\u30a4\u30b9\u7528\u306b\u4f5c\u3063\u305f\u3082\u306e\u3092\u6d41\u7528\u3057\u305f\u306e\u3067AXI\u5316\u3055\u308c\u3066\u306a\u3044\u3067\u3059\u3002\u3082\u3063\u3068\u3082AXI\u5316\u3059\u308b\u30e1\u30ea\u30c3\u30c8\u3082\u3042\u307e\u308a\u7121\u3044\u3067\u3059\u3057\u3002\n\n\u56f3\uff12\u3000\u30d6\u30ed\u30c3\u30af\u56f3\n\nRC\u30b5\u30fc\u30dc\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u90e8\uff08ServoCTRL\uff09\n\u307e\u305a\u3001RC\u30b5\u30fc\u30dc\u306e\u4fe1\u53f7\u306b\u3064\u3044\u3066\u4e0b\u56f3\u306e\u3088\u3046\u306a\u30bf\u30a4\u30df\u30f3\u30b0\u6ce2\u5f62\u3067\u3059\u3002\n\n\u56f3\uff13\u3000RC\u30b5\u30fc\u30dc\u306e\u5236\u5fa1\u4fe1\u53f7\u306e\u56f3\nHigh\u30ec\u30d9\u30eb\u306e\u30d1\u30eb\u30b9\u5e45\u3067\u30b5\u30fc\u30dc\u30db\u30fc\u30f3\u306e\u89d2\u5ea6\u304c\u6c7a\u307e\u308a\u307e\u3059\u3002\n1.5ms\u3067\u3060\u3044\u305f\u3044\u30bb\u30f3\u30bf\u30fc\u3067\u3059\u3002\n\u4fe1\u53f7\u30ec\u30d9\u30eb\u306f3.3V\u3067\u3088\u3044\u306e\u3067\u3001Zynq\u304b\u3089\u76f4\u63a5\u99c6\u52d5\u3067\u304d\u307e\u3059\u3002\uff08\u30d0\u30f3\u30af\u96fb\u5727\u304c3.3V\u306a\u3089\u306d\uff01\uff09\n\u3061\u306a\u307f\u306b\u53d7\u4fe1\u5668\u304b\u3089\u51fa\u3066\u304f\u308b\u4fe1\u53f7\u3082\u540c\u69d8\u3067\u3059\u3002\u3068\u3044\u3046\u304b\u3001\u53d7\u4fe1\u5668\u304b\u3089\u51fa\u3066\u304f\u308b\u4fe1\u53f7\u304c\u3053\u306e\u5f62\u3063\u3066\u3044\u3046\u8868\u73fe\u306e\u307b\u3046\u304c\u6b63\u3057\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3002\n\u30b3\u30fc\u30c9\u306fVHDL\u3067\u66f8\u3044\u3066\u307e\u3059\u3002\n\u30b3\u30fc\u30c9\u4e00\u89a7\u306f\u4ee5\u4e0bURL\u306b\u7f6e\u304d\u307e\u3057\u305f\u3002\u8208\u5473\u304c\u3042\u308c\u3070\u898b\u3066\u304f\u3060\u3055\u3044\u3002\nhttps://github.com/x7700jp/x7700jp_codes\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u540d\n\u8aac\u660e\n\n\n\n\nTE0726_TOP.vhd\n\u30c8\u30c3\u30d7\u30c7\u30b6\u30a4\u30f3\n\n\n\u251cTKSERVO.vhd\n\u30b5\u30fc\u30dc\u5236\u5fa1\n\n\n\u2502\u251cTKSERVO_ANGL.vhd\n\u89d2\u5ea6\u30d1\u30eb\u30b9\u751f\u6210\n\n\n\u2502\u2514TKSERVO_TMG.vhd\n\u30bf\u30a4\u30df\u30f3\u30b0\u5236\u5fa1\n\n\n\u2514TKRCV.vhd\nRC\u53d7\u4fe1\u5668\u4fe1\u53f7\u306e\u6570\u5024\u5316\n\n\nbench_TKSERVO.vhd\nTKSERVO\u306e\u30c6\u30b9\u30c8\u30d9\u30f3\u30c1\n\n\nbench_TKRCV.vhd\nTKRCV\u306e\u30c6\u30b9\u30c8\u30d9\u30f3\u30c1\n\n\n\n\u30c8\u30c3\u30d7\u30c7\u30b6\u30a4\u30f3\u3001\u30c6\u30b9\u30c8\u30d9\u30f3\u30c1\u306b\u3064\u3044\u3066\u306f\u8aac\u660e\u306e\u5fc5\u8981\u306b\u9700\u8981\u304c\u3042\u308c\u3070\u3044\u305a\u308c\u66f8\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\nTKSERVO\u306e\u30dd\u30fc\u30c8\u306e\u8aac\u660e\n\nTKSERVO.vhd\n\nentity TKSERVO is\ngeneric (\n    MASTER : boolean := TRUE; -- TRUE:MASTER / FALSE:SLAVE\n    CW     : integer := 7   ; -- PERI_GEN cnt Width\n    CNT    : integer := 109\n);\nport (\n    iCLK   : in    std_logic;\n    iRST   : in    std_logic;\n    iANGLE : in    std_logic_vector (7 downto 0);\n    bTMG   : inout std_logic; -- MASTER TRUE : output / FALSE : input\n    bPERI  : inout std_logic; -- MASTER TRUE : output / FALSE : input\n    oSERVO : out   std_logic\n);\n\n\n\n\u5165\u51fa\u529b\u306e\u8aac\u660e\u306e\u524d\u306bTKSERVO\u306e\u6982\u8981\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\nTKSERVO\u3067\u306f\u4e0e\u3048\u3089\u308c\u305f\u30a2\u30f3\u30b0\u30eb\u4fe1\u53f7\u306b\u6bd4\u4f8b\u3057\u305fRC\u4fe1\u53f7\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\n\u305d\u306e\u969b\u3001RC\u4fe1\u53f7\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u5236\u5fa1\u3092\u5404\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u6301\u305f\u305b\u308b\u3068\u975e\u52b9\u7387\u306a\u306e\u3067\u30bf\u30a4\u30df\u30f3\u30b0\u751f\u6210\u306f\uff11\u3064\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\uff08\u30de\u30b9\u30bf\u30fc\uff09\u306b\u3066\u884c\u3044\u3001\u30b9\u30ec\u30fc\u30d6\u306f\u3082\u3089\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\u25a0generic\u5024\u306b\u3064\u3044\u3066\nMaster\uff1aTrue\u3067\u30de\u30b9\u30bf\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u30de\u30b9\u30bf\u30fc\u306fbTMG/bPERI\u304c\u51fa\u529b\u306b\u306a\u308a\u307e\u3059\u3002\nCW\uff1a\u4e0b\u8a18CNT\u5024\u306e\u8868\u73fe\u306b\u5fc5\u8981\u306a\u30d3\u30c3\u30c8\u6570\uff08\u4e0b\u8a18CNT=109\u306a\u306e\u30677\u30d3\u30c3\u30c8\uff09\nCNT\uff1abTMG\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u30ab\u30a6\u30f3\u30bf\u5024\n \u6c7a\u3081\u65b9\u306f\n\u3000$CNT=0.02/(3656*PERI)$\u3000\u305f\u3060\u3057\u3001PERI:iCLK\u306e\u5468\u671f\n\u3000\u4f8b\uff1aiCLK=20MHz(PERI=50ns)\u6642\u3000$CNT=0.02/(3656*50*10^{-9})=109.5$\n\u203b\u306a\u3093\u3060\u3063\u3066\u3053\u3093\u306a\u3084\u3084\u3053\u3057\u8a08\u7b97\u306b\u3057\u305f\u304b\u3068\u3044\u3046\u3068\u3001\u524d\u8ff0\u3057\u305f\u6d41\u7528\u5143\u3067\u306f\u90fd\u5408\u304c\u826f\u304b\u3063\u305f\u306e\u3067\u3059\u3002\u305f\u3057\u304b\u3002\n\u25a0\u30dd\u30fc\u30c8\u306b\u3064\u3044\u3066\niCLK   \uff1a \u30af\u30ed\u30c3\u30af\u5165\u529b\uff08\u7acb\u3061\u4e0a\u304c\u308a\u30a8\u30c3\u30b8\uff09\niRST   \uff1a \u30ea\u30bb\u30c3\u30c8\u5165\u529b\uff081\u3067\u30ea\u30bb\u30c3\u30c8\uff09\niANGLE \uff1a \u30b5\u30fc\u30dc\u30db\u30fc\u30f3\u306e\u56de\u8ee2\u89d2\u5ea6\uff08-127\uff5e+127\uff09\nbTMG   \uff1a \u30bf\u30a4\u30df\u30f3\u30b0\u4fe1\u53f7\u306e\u5165\u51fa\u529b\uff08\u30de\u30b9\u30bf\u30fc\u6642\u51fa\u529b\uff09\nbPERI  \uff1a \u30bf\u30a4\u30df\u30f3\u30b0\u4fe1\u53f7\u306e\u5165\u51fa\u529b\uff08\u30de\u30b9\u30bf\u30fc\u6642\u51fa\u529b\uff09\noSERVO \uff1a RC\u4fe1\u53f7\u51fa\u529b\n\u25a0\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7d50\u679c\n\n\u56f3\uff14\u3000\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7d50\u679c\n\u305d\u308c\u3089\u3057\u304f\u52d5\u3044\u3066\u307e\u3059\u3002\n\n\u6b21\u56de\u4e88\u544a\u3068\u96d1\u8a18\n\n\u6b21\u56de\u4e88\u544a\nRC\u53d7\u4fe1\u5668\u4fe1\u53f7\u306e\u6570\u5024\u5316\u306b\u3064\u3044\u3066\u3092\u4e88\u5b9a\u3057\u3066\u307e\u3059\u3002\n\u3053\u308c\u306f\u30de\u30a4\u30b3\u30f3\u3067\u3084\u308b\u3088\u308aFPGA\u306e\u307b\u3046\u304c\u826f\u3044\u4f8b\u3068\u306a\u308a\u307e\u3059\u3002\n\u3068\u304f\u306b\u8907\u6570\u30c1\u30e3\u30cd\u30eb\u3067\u306f\u3059\u3054\u304f\u3059\u3063\u304d\u308a\u3057\u307e\u3059\u3002\n\n\u96d1\u8a18\nRC\u4fe1\u53f7\u3067\u52d5\u304fRC\u30b5\u30fc\u30dc\u306b\u306f\u30a2\u30ca\u30ed\u30b0\u65b9\u5f0f\u3068\u30c7\u30b8\u30bf\u30eb\u65b9\u5f0f\u306e2\u7a2e\u985e\u304c\u3042\u308a\u307e\u3059\u3002\n\u4fe1\u53f7\u305d\u306e\u3082\u306e\u306f\u5909\u308f\u3089\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u53d6\u308a\u6271\u3044\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\u7279\u306b\u30a2\u30ca\u30ed\u30b0\u65b9\u5f0f\u306f\u30d1\u30eb\u30b9\u9593\u9694\uff08\u56f3\uff13\u3067\u3044\u3046\u3068\u3053\u308d\u306e20ms\u306e\u3068\u3053\u308d\uff09\u304c\u958b\u304f\u3068\u4fdd\u6301\u30c8\u30eb\u30af\u304c\u5909\u308f\u308a\u307e\u3057\u305f\u3002\u30c7\u30b8\u30bf\u30eb\u65b9\u5f0f\u306f\u3069\u3046\u3084\u3089\u5024\u3092\u30e9\u30c3\u30c1\u3059\u308b\u3088\u3046\u3067\u3059\u3002\n\u5f93\u3063\u3066\u3001\u30de\u30eb\u30c1\u30d7\u30ec\u30af\u30b5\u3067\u5236\u5fa1\u3057\u3066\u3044\u308b\u3088\u3046\u306a\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u306e\u5834\u5408\u306f\u5236\u5fa1\u6570\u304c\u591a\u3044\u3068\u30a2\u30ca\u30ed\u30b0\u65b9\u5f0f\u306eRC\u30b5\u30fc\u30dc\u306f\u7279\u6027\u4f4e\u4e0b\u3059\u308b\u5834\u5408\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u6c17\u3092\u3064\u3051\u307e\u3057\u3087\u3046\u3002\n\u305d\u306e\u70b9\u3001Zynq\u3067\u3042\u308c\u3070\u3001\u5236\u5fa1\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u7dfb\u5bc6\u306b\u3067\u304d\u307e\u3059\u3057\u3001\u30d1\u30eb\u30b9\u9593\u9694\u3092\u4efb\u610f\u306b\u5909\u52d5\u3055\u305b\u3066\u4fdd\u6301\u30c8\u30eb\u30af\u3082\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\u305d\u308c\u304c\u6709\u7528\u304b\u3069\u3046\u304b\u306f\u3068\u3082\u304b\u304f\u306d\u3002\n\u3067\u306f\u6b21\u56de\u3002\n#Zynq\u3067\u30ed\u30dc\u30c3\u30c8\u5236\u5fa1\u3057\u307e\u3059\nZynq\u306e\u7fd2\u4f5c\u304c\u5fc5\u8981\u3060\u3063\u305f\u306e\u3067\u30ed\u30dc\u30c3\u30c8\u306b\u4f7f\u3044\u307e\u3057\u305f\u3002\n\u30c1\u30e3\u30ec\u30f3\u30b8\u3057\u305f\u969b\u306e\u6280\u8853\u7684\u306a\u8a71\u3092\u3057\u3066\u3044\u3053\u3046\u304b\u3068\u601d\u3063\u3066\u307e\u3059\u3002\n\u7279\u306b\u3001HDL\u306e\u8a18\u4e8b\u306f\u5c11\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u305d\u306e\u8fba\u3092\u4e2d\u5fc3\u306b\u8a9e\u3063\u3066\u3044\u3053\u3046\u304b\u306a\u3068\u3002\n\n![robo2.jpg](https://qiita-image-store.s3.amazonaws.com/0/142745/63c4be4e-bde0-6d22-255d-b813014fe7b0.jpeg)\n\u56f3\uff11\u3000\u304a\u624b\u4e0a\u3052\u306e\u56f3\n\nZynq\u306e\u30dc\u30fc\u30c9\u306fZynqBerry\u3092\u4f7f\u7528\u3057\u3066\u3044\u307e\u3059\u3002\nhttp://www.trenz.jp/products/te0726/\n\nRaspberryPi\u306eZynq\u7248\u3067\u3001GPIO\u304c\u30d4\u30f3\u30d8\u30c3\u30c0\u3067\u51fa\u3066\u308b\u306e\u3067\u90fd\u5408\u304c\u3088\u3044\u306e\u3067\u3059\u3002\n\u305d\u308c\u3092\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u57fa\u677f\u3067RC\u30b5\u30fc\u30dc\u306b\u96fb\u6e90\u3068\u4fe1\u53f7\u3092\u4e0e\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u5de5\u4f5c\u3057\u307e\u3057\u305f\u3002\n\n#\u5f79\u5272\u5206\u62c5\nZynq\u306b\u306fARM\u30d7\u30ed\u30bb\u30c3\u30b5\uff08Zynq\u3067\u306fPS\u3068\u547c\u3076\uff09\u3068FPGA\uff08\u540c\u3058\u304fPL\uff09\u304c\u5165\u3063\u3066\u307e\u3059\u3002\nPS\u3068PL\u306e\u5f79\u5272\u5206\u62c5\u3067\u3059\u304c\u3001PS\u3067\u306f\u30ed\u30dc\u30c3\u30c8\u306e\u30e2\u30fc\u30b7\u30e7\u30f3\u3092UART\u304b\u3089\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30d5\u30e9\u30c3\u30b7\u30e5\u306e\u30b3\u30f3\u30d5\u30a3\u30ae\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u9818\u57df\uff08PS\u306e\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u3068PL\u306e\u30d3\u30c3\u30c8\u30b9\u30c8\u30ea\u30fc\u30e0\uff09\u3088\u308a\u5f8c\u308d\u306b\u683c\u7d0d\u3001\u53d6\u308a\u51fa\u3057\u3092\u884c\u3044\u307e\u3059\u3002\nPL\u3067\u306fRC\u30b5\u30fc\u30dc\u306e\u5236\u5fa1\u3068RC\u53d7\u4fe1\u5668\u306e\u4fe1\u53f7\u53d6\u308a\u8fbc\u307f\u3092\u3084\u3063\u3066\u307e\u3059\u3002\n\u3064\u307e\u308a\u3001RC\u7cfb\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u5236\u5fa1\u3092\u30cf\u30fc\u30c9\u51e6\u7406\u3068\u3057\u3001\u30bd\u30d5\u30c8\u306f\u59ff\u52e2\u306e\u5236\u5fa1\u306b\u5c02\u5ff5\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\nPS\u3068PL\u306e\u63a5\u7d9a\u306fAXI-GPIO\u3067\u3059\u3002RC\u7cfb\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u90e8\u306f\u5143\u3005Lattice\u306e\u30c7\u30d0\u30a4\u30b9\u7528\u306b\u4f5c\u3063\u305f\u3082\u306e\u3092\u6d41\u7528\u3057\u305f\u306e\u3067AXI\u5316\u3055\u308c\u3066\u306a\u3044\u3067\u3059\u3002\u3082\u3063\u3068\u3082AXI\u5316\u3059\u308b\u30e1\u30ea\u30c3\u30c8\u3082\u3042\u307e\u308a\u7121\u3044\u3067\u3059\u3057\u3002\n\n\n![rc_robo.jpg](https://qiita-image-store.s3.amazonaws.com/0/142745/9db7bbdb-5227-2363-0201-413f19b4b4dc.jpeg \"\u30d6\u30ed\u30c3\u30af\u56f3\")\n\u56f3\uff12\u3000\u30d6\u30ed\u30c3\u30af\u56f3\n\n\n#RC\u30b5\u30fc\u30dc\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u90e8\uff08ServoCTRL\uff09\n\u307e\u305a\u3001RC\u30b5\u30fc\u30dc\u306e\u4fe1\u53f7\u306b\u3064\u3044\u3066\u4e0b\u56f3\u306e\u3088\u3046\u306a\u30bf\u30a4\u30df\u30f3\u30b0\u6ce2\u5f62\u3067\u3059\u3002\n![rc.jpg](https://qiita-image-store.s3.amazonaws.com/0/142745/1da86be3-179b-2a0b-9184-079b61671c14.jpeg)\n\u56f3\uff13\u3000RC\u30b5\u30fc\u30dc\u306e\u5236\u5fa1\u4fe1\u53f7\u306e\u56f3\n\nHigh\u30ec\u30d9\u30eb\u306e\u30d1\u30eb\u30b9\u5e45\u3067\u30b5\u30fc\u30dc\u30db\u30fc\u30f3\u306e\u89d2\u5ea6\u304c\u6c7a\u307e\u308a\u307e\u3059\u3002\n1.5ms\u3067\u3060\u3044\u305f\u3044\u30bb\u30f3\u30bf\u30fc\u3067\u3059\u3002\n\u4fe1\u53f7\u30ec\u30d9\u30eb\u306f3.3V\u3067\u3088\u3044\u306e\u3067\u3001Zynq\u304b\u3089\u76f4\u63a5\u99c6\u52d5\u3067\u304d\u307e\u3059\u3002\uff08\u30d0\u30f3\u30af\u96fb\u5727\u304c3.3V\u306a\u3089\u306d\uff01\uff09\n\u3061\u306a\u307f\u306b\u53d7\u4fe1\u5668\u304b\u3089\u51fa\u3066\u304f\u308b\u4fe1\u53f7\u3082\u540c\u69d8\u3067\u3059\u3002\u3068\u3044\u3046\u304b\u3001\u53d7\u4fe1\u5668\u304b\u3089\u51fa\u3066\u304f\u308b\u4fe1\u53f7\u304c\u3053\u306e\u5f62\u3063\u3066\u3044\u3046\u8868\u73fe\u306e\u307b\u3046\u304c\u6b63\u3057\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3002\n\n\u30b3\u30fc\u30c9\u306fVHDL\u3067\u66f8\u3044\u3066\u307e\u3059\u3002\n\u30b3\u30fc\u30c9\u4e00\u89a7\u306f\u4ee5\u4e0bURL\u306b\u7f6e\u304d\u307e\u3057\u305f\u3002\u8208\u5473\u304c\u3042\u308c\u3070\u898b\u3066\u304f\u3060\u3055\u3044\u3002\nhttps://github.com/x7700jp/x7700jp_codes\n\n| \u30d5\u30a1\u30a4\u30eb\u540d           | \u8aac\u660e                  |\n|:---------------------|:----------------------|\n| TE0726_TOP.vhd       | \u30c8\u30c3\u30d7\u30c7\u30b6\u30a4\u30f3        |\n| \u251cTKSERVO.vhd        | \u30b5\u30fc\u30dc\u5236\u5fa1            |\n| \u2502\u251cTKSERVO_ANGL.vhd | \u89d2\u5ea6\u30d1\u30eb\u30b9\u751f\u6210        |\n| \u2502\u2514TKSERVO_TMG.vhd  | \u30bf\u30a4\u30df\u30f3\u30b0\u5236\u5fa1        |\n| \u2514TKRCV.vhd          | RC\u53d7\u4fe1\u5668\u4fe1\u53f7\u306e\u6570\u5024\u5316  |\n| bench_TKSERVO.vhd    | TKSERVO\u306e\u30c6\u30b9\u30c8\u30d9\u30f3\u30c1 |\n| bench_TKRCV.vhd      | TKRCV\u306e\u30c6\u30b9\u30c8\u30d9\u30f3\u30c1   |\n\n\u30c8\u30c3\u30d7\u30c7\u30b6\u30a4\u30f3\u3001\u30c6\u30b9\u30c8\u30d9\u30f3\u30c1\u306b\u3064\u3044\u3066\u306f\u8aac\u660e\u306e\u5fc5\u8981\u306b\u9700\u8981\u304c\u3042\u308c\u3070\u3044\u305a\u308c\u66f8\u3053\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\nTKSERVO\u306e\u30dd\u30fc\u30c8\u306e\u8aac\u660e\n\n```vhdl:TKSERVO.vhd\n\nentity TKSERVO is\ngeneric (\n\tMASTER : boolean := TRUE; -- TRUE:MASTER / FALSE:SLAVE\n\tCW     : integer := 7   ; -- PERI_GEN cnt Width\n\tCNT    : integer := 109\n);\nport (\n\tiCLK   : in    std_logic;\n\tiRST   : in    std_logic;\n\tiANGLE : in    std_logic_vector (7 downto 0);\n\tbTMG   : inout std_logic; -- MASTER TRUE : output / FALSE : input\n\tbPERI  : inout std_logic; -- MASTER TRUE : output / FALSE : input\n\toSERVO : out   std_logic\n);\n\n```\n\n\u5165\u51fa\u529b\u306e\u8aac\u660e\u306e\u524d\u306bTKSERVO\u306e\u6982\u8981\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\nTKSERVO\u3067\u306f\u4e0e\u3048\u3089\u308c\u305f\u30a2\u30f3\u30b0\u30eb\u4fe1\u53f7\u306b\u6bd4\u4f8b\u3057\u305fRC\u4fe1\u53f7\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\n\u305d\u306e\u969b\u3001RC\u4fe1\u53f7\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u5236\u5fa1\u3092\u5404\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u6301\u305f\u305b\u308b\u3068\u975e\u52b9\u7387\u306a\u306e\u3067\u30bf\u30a4\u30df\u30f3\u30b0\u751f\u6210\u306f\uff11\u3064\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\uff08\u30de\u30b9\u30bf\u30fc\uff09\u306b\u3066\u884c\u3044\u3001\u30b9\u30ec\u30fc\u30d6\u306f\u3082\u3089\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\n\u25a0generic\u5024\u306b\u3064\u3044\u3066\nMaster\uff1aTrue\u3067\u30de\u30b9\u30bf\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u30de\u30b9\u30bf\u30fc\u306fbTMG/bPERI\u304c\u51fa\u529b\u306b\u306a\u308a\u307e\u3059\u3002\nCW\uff1a\u4e0b\u8a18CNT\u5024\u306e\u8868\u73fe\u306b\u5fc5\u8981\u306a\u30d3\u30c3\u30c8\u6570\uff08\u4e0b\u8a18CNT=109\u306a\u306e\u30677\u30d3\u30c3\u30c8\uff09\nCNT\uff1abTMG\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u30ab\u30a6\u30f3\u30bf\u5024\n \u6c7a\u3081\u65b9\u306f\n\u3000$CNT=0.02/(3656*PERI)$\u3000\u305f\u3060\u3057\u3001PERI:iCLK\u306e\u5468\u671f\n\n\u3000\u4f8b\uff1aiCLK=20MHz(PERI=50ns)\u6642\u3000$CNT=0.02/(3656*50*10^{-9})=109.5$\n\n\u203b\u306a\u3093\u3060\u3063\u3066\u3053\u3093\u306a\u3084\u3084\u3053\u3057\u8a08\u7b97\u306b\u3057\u305f\u304b\u3068\u3044\u3046\u3068\u3001\u524d\u8ff0\u3057\u305f\u6d41\u7528\u5143\u3067\u306f\u90fd\u5408\u304c\u826f\u304b\u3063\u305f\u306e\u3067\u3059\u3002\u305f\u3057\u304b\u3002\n\n\u25a0\u30dd\u30fc\u30c8\u306b\u3064\u3044\u3066\niCLK   \uff1a \u30af\u30ed\u30c3\u30af\u5165\u529b\uff08\u7acb\u3061\u4e0a\u304c\u308a\u30a8\u30c3\u30b8\uff09\niRST   \uff1a \u30ea\u30bb\u30c3\u30c8\u5165\u529b\uff081\u3067\u30ea\u30bb\u30c3\u30c8\uff09\niANGLE \uff1a \u30b5\u30fc\u30dc\u30db\u30fc\u30f3\u306e\u56de\u8ee2\u89d2\u5ea6\uff08-127\uff5e+127\uff09\nbTMG   \uff1a \u30bf\u30a4\u30df\u30f3\u30b0\u4fe1\u53f7\u306e\u5165\u51fa\u529b\uff08\u30de\u30b9\u30bf\u30fc\u6642\u51fa\u529b\uff09\nbPERI  \uff1a \u30bf\u30a4\u30df\u30f3\u30b0\u4fe1\u53f7\u306e\u5165\u51fa\u529b\uff08\u30de\u30b9\u30bf\u30fc\u6642\u51fa\u529b\uff09\noSERVO \uff1a RC\u4fe1\u53f7\u51fa\u529b\n\n\u25a0\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7d50\u679c\n![rc_robot_sim.jpg](https://qiita-image-store.s3.amazonaws.com/0/142745/deaa7284-3edc-62b9-59d3-857171184472.jpeg)\n\u56f3\uff14\u3000\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7d50\u679c\n\n\u305d\u308c\u3089\u3057\u304f\u52d5\u3044\u3066\u307e\u3059\u3002\n\n#\u6b21\u56de\u4e88\u544a\u3068\u96d1\u8a18\n###\u6b21\u56de\u4e88\u544a\nRC\u53d7\u4fe1\u5668\u4fe1\u53f7\u306e\u6570\u5024\u5316\u306b\u3064\u3044\u3066\u3092\u4e88\u5b9a\u3057\u3066\u307e\u3059\u3002\n\u3053\u308c\u306f\u30de\u30a4\u30b3\u30f3\u3067\u3084\u308b\u3088\u308aFPGA\u306e\u307b\u3046\u304c\u826f\u3044\u4f8b\u3068\u306a\u308a\u307e\u3059\u3002\n\u3068\u304f\u306b\u8907\u6570\u30c1\u30e3\u30cd\u30eb\u3067\u306f\u3059\u3054\u304f\u3059\u3063\u304d\u308a\u3057\u307e\u3059\u3002\n\n###\u96d1\u8a18\nRC\u4fe1\u53f7\u3067\u52d5\u304fRC\u30b5\u30fc\u30dc\u306b\u306f\u30a2\u30ca\u30ed\u30b0\u65b9\u5f0f\u3068\u30c7\u30b8\u30bf\u30eb\u65b9\u5f0f\u306e2\u7a2e\u985e\u304c\u3042\u308a\u307e\u3059\u3002\n\u4fe1\u53f7\u305d\u306e\u3082\u306e\u306f\u5909\u308f\u3089\u306a\u3044\u306e\u3067\u3059\u304c\u3001\u305d\u306e\u53d6\u308a\u6271\u3044\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\u7279\u306b\u30a2\u30ca\u30ed\u30b0\u65b9\u5f0f\u306f\u30d1\u30eb\u30b9\u9593\u9694\uff08\u56f3\uff13\u3067\u3044\u3046\u3068\u3053\u308d\u306e20ms\u306e\u3068\u3053\u308d\uff09\u304c\u958b\u304f\u3068\u4fdd\u6301\u30c8\u30eb\u30af\u304c\u5909\u308f\u308a\u307e\u3057\u305f\u3002\u30c7\u30b8\u30bf\u30eb\u65b9\u5f0f\u306f\u3069\u3046\u3084\u3089\u5024\u3092\u30e9\u30c3\u30c1\u3059\u308b\u3088\u3046\u3067\u3059\u3002\n\u5f93\u3063\u3066\u3001\u30de\u30eb\u30c1\u30d7\u30ec\u30af\u30b5\u3067\u5236\u5fa1\u3057\u3066\u3044\u308b\u3088\u3046\u306a\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u306e\u5834\u5408\u306f\u5236\u5fa1\u6570\u304c\u591a\u3044\u3068\u30a2\u30ca\u30ed\u30b0\u65b9\u5f0f\u306eRC\u30b5\u30fc\u30dc\u306f\u7279\u6027\u4f4e\u4e0b\u3059\u308b\u5834\u5408\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u6c17\u3092\u3064\u3051\u307e\u3057\u3087\u3046\u3002\n\u305d\u306e\u70b9\u3001Zynq\u3067\u3042\u308c\u3070\u3001\u5236\u5fa1\u30bf\u30a4\u30df\u30f3\u30b0\u306f\u7dfb\u5bc6\u306b\u3067\u304d\u307e\u3059\u3057\u3001\u30d1\u30eb\u30b9\u9593\u9694\u3092\u4efb\u610f\u306b\u5909\u52d5\u3055\u305b\u3066\u4fdd\u6301\u30c8\u30eb\u30af\u3082\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\u305d\u308c\u304c\u6709\u7528\u304b\u3069\u3046\u304b\u306f\u3068\u3082\u304b\u304f\u306d\u3002\n\n\u3067\u306f\u6b21\u56de\u3002\n\n\n", "tags": ["zynq", "VHDL", "FPGA"]}