{"context": "\u4fbf\u5229\u3060\u3063\u305f\u306e\u3067\u3001\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u3002\nSpring Boot \u3067 Web \u30a2\u30d7\u30ea\u3092\u958b\u767a\u3059\u308b\u3068\u3001\u7d44\u307f\u8fbc\u307e\u308c\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u306e\u52b9\u7528\u306b\u3088\u308a\u3001\n\u500b\u5225\u306e\u30dd\u30fc\u30c8\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3 (\u3068\u3001\u4e00\u7dd2\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc) \u3092\u8d77\u52d5\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u500b\u5225\u306e\u30dd\u30fc\u30c8\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3059\u308b\u3068\u3044\u3046\u306e\u304c\u30df\u30bd\u3067\u3001\n\u3053\u308c\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u30011\u53f0\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3092\u30011\u53f0\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u3059\u308b\u610f\u7fa9\u3068\u3044\u3046\u306e\u306f\u3044\u304f\u3064\u304b\u3042\u3063\u3066\u3001\n\u4ee5\u4e0b\u306e\u69d8\u306a\u3082\u306e\u304c\u3042\u308b\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u30b5\u30fc\u30d0\u30fc\u30ea\u30bd\u30fc\u30b9\u3092\u6709\u52b9\u306b\u4f7f\u7528\u3059\u308b\u305f\u3081\n\u7121\u505c\u6b62\u30c7\u30d7\u30ed\u30a4\u3092\u304a\u3053\u306a\u3046\u305f\u3081\n\n\u3053\u308c\u3089\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306b\u3001Nginx \u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u3092\u675f\u306d\u3066\u3001\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3057\u3088\u3046\u3068\u3044\u3046\u306e\u304c\u4eca\u56de\u306e\u304a\u984c\u3067\u3059\u3002\n\n\u74b0\u5883\n\nConoHa byGMO 900\u5186\u30d7\u30e9\u30f3 (2016-04-19 \u6642\u70b9)\n\n\n\u30e1\u30e2\u30ea 1GB\nCPU 2\u30b3\u30a2\nSSD 50GB\n\n\nUbuntu 14.04 LTS\nNginx 1.4.6\nJava 1.8.0\nSpring Boot 1.3.3\n\n$ cat /etc/lsb-release\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=14.04\nDISTRIB_CODENAME=trusty\nDISTRIB_DESCRIPTION=\"Ubuntu 14.04.4 LTS\"\n\n$ nginx -V\nnginx version: nginx/1.4.6 (Ubuntu)\nbuilt by gcc 4.8.2 (Ubuntu 4.8.2-19ubuntu1)\nTLS SNI support enabled\n\n$ java -version\njava version \"1.8.0_77\"\nJava(TM) SE Runtime Environment (build 1.8.0_77-b03)\nJava HotSpot(TM) 64-Bit Server VM (build 25.77-b03, mixed mode)\n\n$ cat pom.xml | grep '<parent>' -A 5\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>1.3.3.RELEASE</version>\n        <relativePath/> <!-- lookup parent from repository -->\n    </parent>\n\n\nSpring Boot \u30a2\u30d7\u30ea\u306e\u4f5c\u6210\n\u306f\u3001\u3067\u304d\u3066\u3044\u308b\u524d\u63d0\u3002\n\u624b\u5143\u306b Spring Boot \u30a2\u30d7\u30ea\u304c\u307e\u3060\u7121\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u304b\u3089\u3001\n\u30c6\u30f3\u30d7\u30ec\u306a\u3069\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304d\u3066\u3001\u3055\u3055\u3063\u3068\u7528\u610f\u3057\u3066\u4e0b\u3055\u3044\u3002\nhttps://start.spring.io/\n\nSpring Boot \u30a2\u30d7\u30ea\u306e\u8d77\u52d5\n\u3053\u3053\u304b\u3089\u304c\u4e3b\u984c\u3002\n\u307e\u305a\u3001\u30a2\u30d7\u30ea\u3092\u30d1\u30c3\u30b1\u30fc\u30b8\u30f3\u30b0\u3057\u3066\u304a\u304d\u3001\u8d77\u52d5\u53ef\u80fd\u306a\u72b6\u614b\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\u4f8b\u3068\u3057\u3066\u3001Spring Initializr \u3067 Artifact \u304c\u3001\"demo\" \u3067\u3042\u3063\u305f\u5834\u5408\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u30d1\u30c3\u30b1\u30fc\u30b8\u30f3\u30b0\u306f\u3001Spring Initializr \u304b\u3089\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u305f\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3002\n$ cd demo\n$ ./mvnw clean package\n$ ls target\nclasses            maven-archiver  demo-0.0.1-SNAPSHOT.jar\ngenerated-sources  maven-status    demo-web-0.0.1-SNAPSHOT.jar.original\n\ndemo-0.0.1-SNAPSHOT.jar \u3092\u4f7f\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u540c\u4e00\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3059\u308b\u306e\u3067\u30013\u3064\u5206\u8d77\u52d5\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u30dd\u30fc\u30c8\u306f\u305d\u308c\u305e\u308c\u3001\"8080\"\u3001\"8081\"\u3001\"8082\" \u3068\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n$ java -jar target/demo-0.0.1-SNAPSHOT.jar --server.port=8080 &\n$ java -jar target/demo-0.0.1-SNAPSHOT.jar --server.port=8081 &\n$ java -jar target/demo-0.0.1-SNAPSHOT.jar --server.port=8082 &\n\n\nNginx \u3067\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u8a2d\u5b9a\n\u3044\u3088\u3044\u3088\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u306e\u8a2d\u5b9a\u3092\u304a\u3053\u306a\u3044\u307e\u3059\u3002\n/etc/nginx/sites-available/default \u306e\u8a2d\u5b9a\u306f\u3001\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u307e\u307e\u5b58\u5728\u3057\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\u65b0\u305f\u306b\u3001/etc/nginx/sites-available/demo \u3068\u3044\u3046\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ vi /etc/nginx/sites-available/demo\n\nupstream \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u3001\u540d\u524d\u3092\u3064\u3051\u3066\n\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u5148\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u3092\u3001\u5217\u6319\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\"lb_demo\" \u3068\u3044\u3046\u540d\u524d\u3092\u3064\u3051\u307e\u3057\u305f\u3002\n\u6b21\u306b server \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u5185\u306e\u3001location \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u3001\n\u5148\u307b\u3069\u3064\u3051\u305f\u540d\u524d\u3092\u4f7f\u7528\u3057\u3066\u3001proxy_pass \u306e\u8a2d\u5b9a\u3092\u304a\u3053\u306a\u3044\u307e\u3059\u3002\nproxy_pass http://lb_demo; \u306b\u3088\u308a\u3001\n\"lb_demo\" \u306b\u8a2d\u5b9a\u3055\u308c\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u306b\u632f\u308a\u5206\u3051\u304c\u304a\u3053\u306a\u308f\u308c\u307e\u3059\u3002\n\n/etc/nginx/sites-available/demo\nupstream lb_demo {\n    least_conn;\n    server 127.0.0.1:8080;\n    server 127.0.0.1:8081;\n    server 127.0.0.1:8082 backup;\n}\n\nserver {\n    listen 80;\n    listen [::]:80;\n\n    root /usr/share/nginx/html;\n    index index.html index.htm;\n\n    # Make site accessible from http://localhost/\n    server_name demo.local;\n\n    proxy_redirect      off;\n    proxy_set_header    Host                $host;\n    proxy_set_header    X-Forwarded-For     $proxy_add_x_forwarded_for;\n    proxy_set_header    X-Forwarded-Host    $host;\n    proxy_set_header    X-Forwarded-Server  $host;\n    proxy_set_header    X-Real-IP           $remote_addr;\n\n    location / {\n        proxy_pass http://lb_demo;\n    }\n}\n\n\n\u305d\u308c\u305e\u308c\u306e\u4e3b\u8981\u306a\u8a2d\u5b9a\u5024\u306b\u3064\u3044\u3066\u306f\u3001\u4ee5\u4e0b\u304c\u5206\u304b\u308a\u3084\u3059\u304b\u3063\u305f\u3067\u3059\u3002\nhttp://og732.hatenadiary.com/entry/2013/05/08/225939\n\u6700\u5f8c\u306b\u8a2d\u5b9a\u3092\u9069\u7528\u3059\u308b\u305f\u3081\u3001sites-enabled \u306b\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u4f5c\u6210\u3057\u3066\u3001\nNginx \u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n$ sudo ln -s /etc/nginx/sites-available/demo /etc/nginx/sites-enabled/demo\n$ sudo service nginx reload\n * Reloading nginx configuration nginx                                   [ OK ]\n\n\u3068\u3001\u3053\u3093\u306a\u5177\u5408\u306b\u8a2d\u5b9a\u3092\u884c\u3046\u3053\u3068\u3067\u3001\n1\u53f0\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u306e\u8a2d\u5b9a\u304c\u304a\u3053\u306a\u3048\u307e\u3059\u3002\n\u30a2\u30d7\u30ea\u306e\u66f4\u65b0\u6642\u306a\u3069\u3001\u3084\u306f\u308a\u3067\u304d\u308c\u3070\u30b5\u30fc\u30d3\u30b9\u306f\u505c\u6b62\u3055\u305b\u305f\u304f\u306a\u3044\u3082\u306e\u3002\n\u305f\u3068\u3048\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c1\u53f0\u3057\u304b\u306a\u304b\u3063\u305f\u3068\u3057\u3066\u3082\u3001\u3044\u308d\u3044\u308d\u306a\u5de5\u592b\u3092\u3053\u3089\u3057\u305f\u3044\u3002\n\u4fbf\u5229\u3060\u3063\u305f\u306e\u3067\u3001\u5fd8\u308c\u306a\u3044\u3088\u3046\u306b\u3002\n\nSpring Boot \u3067 Web \u30a2\u30d7\u30ea\u3092\u958b\u767a\u3059\u308b\u3068\u3001\u7d44\u307f\u8fbc\u307e\u308c\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u306e\u52b9\u7528\u306b\u3088\u308a\u3001\n\u500b\u5225\u306e\u30dd\u30fc\u30c8\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3 (\u3068\u3001\u4e00\u7dd2\u306b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc) \u3092\u8d77\u52d5\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u500b\u5225\u306e\u30dd\u30fc\u30c8\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u304c\u8d77\u52d5\u3059\u308b\u3068\u3044\u3046\u306e\u304c\u30df\u30bd\u3067\u3001\n\u3053\u308c\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u30011\u53f0\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3092\u30011\u53f0\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u3059\u308b\u610f\u7fa9\u3068\u3044\u3046\u306e\u306f\u3044\u304f\u3064\u304b\u3042\u3063\u3066\u3001\n\u4ee5\u4e0b\u306e\u69d8\u306a\u3082\u306e\u304c\u3042\u308b\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\n- \u30b5\u30fc\u30d0\u30fc\u30ea\u30bd\u30fc\u30b9\u3092\u6709\u52b9\u306b\u4f7f\u7528\u3059\u308b\u305f\u3081\n- \u7121\u505c\u6b62\u30c7\u30d7\u30ed\u30a4\u3092\u304a\u3053\u306a\u3046\u305f\u3081\n\n\u3053\u308c\u3089\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306b\u3001Nginx \u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u3092\u675f\u306d\u3066\u3001\n\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3057\u3088\u3046\u3068\u3044\u3046\u306e\u304c\u4eca\u56de\u306e\u304a\u984c\u3067\u3059\u3002\n\n# \u74b0\u5883\n- ConoHa byGMO 900\u5186\u30d7\u30e9\u30f3 (2016-04-19 \u6642\u70b9)\n  - \u30e1\u30e2\u30ea 1GB\n  - CPU 2\u30b3\u30a2\n  - SSD 50GB\n- Ubuntu 14.04 LTS\n- Nginx 1.4.6\n- Java 1.8.0\n- Spring Boot 1.3.3\n\n```\n$ cat /etc/lsb-release\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=14.04\nDISTRIB_CODENAME=trusty\nDISTRIB_DESCRIPTION=\"Ubuntu 14.04.4 LTS\"\n\n$ nginx -V\nnginx version: nginx/1.4.6 (Ubuntu)\nbuilt by gcc 4.8.2 (Ubuntu 4.8.2-19ubuntu1)\nTLS SNI support enabled\n\n$ java -version\njava version \"1.8.0_77\"\nJava(TM) SE Runtime Environment (build 1.8.0_77-b03)\nJava HotSpot(TM) 64-Bit Server VM (build 25.77-b03, mixed mode)\n\n$ cat pom.xml | grep '<parent>' -A 5\n\t<parent>\n\t\t<groupId>org.springframework.boot</groupId>\n\t\t<artifactId>spring-boot-starter-parent</artifactId>\n\t\t<version>1.3.3.RELEASE</version>\n\t\t<relativePath/> <!-- lookup parent from repository -->\n\t</parent>\n```\n\n# Spring Boot \u30a2\u30d7\u30ea\u306e\u4f5c\u6210\n\u306f\u3001\u3067\u304d\u3066\u3044\u308b\u524d\u63d0\u3002\n\u624b\u5143\u306b Spring Boot \u30a2\u30d7\u30ea\u304c\u307e\u3060\u7121\u3044\u5834\u5408\u306f\u4ee5\u4e0b\u304b\u3089\u3001\n\u30c6\u30f3\u30d7\u30ec\u306a\u3069\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304d\u3066\u3001\u3055\u3055\u3063\u3068\u7528\u610f\u3057\u3066\u4e0b\u3055\u3044\u3002\nhttps://start.spring.io/\n\n# Spring Boot \u30a2\u30d7\u30ea\u306e\u8d77\u52d5\n\u3053\u3053\u304b\u3089\u304c\u4e3b\u984c\u3002\n\u307e\u305a\u3001\u30a2\u30d7\u30ea\u3092\u30d1\u30c3\u30b1\u30fc\u30b8\u30f3\u30b0\u3057\u3066\u304a\u304d\u3001\u8d77\u52d5\u53ef\u80fd\u306a\u72b6\u614b\u306b\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u4f8b\u3068\u3057\u3066\u3001Spring Initializr \u3067 `Artifact` \u304c\u3001\"demo\" \u3067\u3042\u3063\u305f\u5834\u5408\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u30d1\u30c3\u30b1\u30fc\u30b8\u30f3\u30b0\u306f\u3001Spring Initializr \u304b\u3089\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u305f\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3002\n\n```\n$ cd demo\n$ ./mvnw clean package\n$ ls target\nclasses            maven-archiver  demo-0.0.1-SNAPSHOT.jar\ngenerated-sources  maven-status    demo-web-0.0.1-SNAPSHOT.jar.original\n```\n\n`demo-0.0.1-SNAPSHOT.jar` \u3092\u4f7f\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u540c\u4e00\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3059\u308b\u306e\u3067\u30013\u3064\u5206\u8d77\u52d5\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u30dd\u30fc\u30c8\u306f\u305d\u308c\u305e\u308c\u3001\"8080\"\u3001\"8081\"\u3001\"8082\" \u3068\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n$ java -jar target/demo-0.0.1-SNAPSHOT.jar --server.port=8080 &\n$ java -jar target/demo-0.0.1-SNAPSHOT.jar --server.port=8081 &\n$ java -jar target/demo-0.0.1-SNAPSHOT.jar --server.port=8082 &\n```\n\n# Nginx \u3067\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u8a2d\u5b9a\n\u3044\u3088\u3044\u3088\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u306e\u8a2d\u5b9a\u3092\u304a\u3053\u306a\u3044\u307e\u3059\u3002\n`/etc/nginx/sites-available/default` \u306e\u8a2d\u5b9a\u306f\u3001\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u307e\u307e\u5b58\u5728\u3057\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n\u65b0\u305f\u306b\u3001`/etc/nginx/sites-available/demo` \u3068\u3044\u3046\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n$ vi /etc/nginx/sites-available/demo\n```\n\n`upstream` \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u3001\u540d\u524d\u3092\u3064\u3051\u3066\n\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u5148\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u3092\u3001\u5217\u6319\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\"lb_demo\" \u3068\u3044\u3046\u540d\u524d\u3092\u3064\u3051\u307e\u3057\u305f\u3002\n\n\u6b21\u306b `server` \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u5185\u306e\u3001`location` \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u3001\n\u5148\u307b\u3069\u3064\u3051\u305f\u540d\u524d\u3092\u4f7f\u7528\u3057\u3066\u3001`proxy_pass` \u306e\u8a2d\u5b9a\u3092\u304a\u3053\u306a\u3044\u307e\u3059\u3002\n\n`proxy_pass http://lb_demo;` \u306b\u3088\u308a\u3001\n\"lb_demo\" \u306b\u8a2d\u5b9a\u3055\u308c\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u306b\u632f\u308a\u5206\u3051\u304c\u304a\u3053\u306a\u308f\u308c\u307e\u3059\u3002\n\n```:/etc/nginx/sites-available/demo\nupstream lb_demo {\n\tleast_conn;\n\tserver 127.0.0.1:8080;\n\tserver 127.0.0.1:8081;\n\tserver 127.0.0.1:8082 backup;\n}\n\nserver {\n\tlisten 80;\n\tlisten [::]:80;\n\n\troot /usr/share/nginx/html;\n\tindex index.html index.htm;\n\n\t# Make site accessible from http://localhost/\n\tserver_name demo.local;\n\n\tproxy_redirect\t\toff;\n\tproxy_set_header\tHost\t\t\t\t$host;\n\tproxy_set_header\tX-Forwarded-For\t\t$proxy_add_x_forwarded_for;\n\tproxy_set_header\tX-Forwarded-Host\t$host;\n\tproxy_set_header\tX-Forwarded-Server\t$host;\n\tproxy_set_header\tX-Real-IP\t\t\t$remote_addr;\n\n\tlocation / {\n\t\tproxy_pass http://lb_demo;\n\t}\n}\n```\n\n\u305d\u308c\u305e\u308c\u306e\u4e3b\u8981\u306a\u8a2d\u5b9a\u5024\u306b\u3064\u3044\u3066\u306f\u3001\u4ee5\u4e0b\u304c\u5206\u304b\u308a\u3084\u3059\u304b\u3063\u305f\u3067\u3059\u3002\nhttp://og732.hatenadiary.com/entry/2013/05/08/225939\n\n\u6700\u5f8c\u306b\u8a2d\u5b9a\u3092\u9069\u7528\u3059\u308b\u305f\u3081\u3001`sites-enabled` \u306b\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u4f5c\u6210\u3057\u3066\u3001\nNginx \u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```\n$ sudo ln -s /etc/nginx/sites-available/demo /etc/nginx/sites-enabled/demo\n$ sudo service nginx reload\n * Reloading nginx configuration nginx                                   [ OK ]\n```\n\n\u3068\u3001\u3053\u3093\u306a\u5177\u5408\u306b\u8a2d\u5b9a\u3092\u884c\u3046\u3053\u3068\u3067\u3001\n1\u53f0\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u3001\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u306e\u8a2d\u5b9a\u304c\u304a\u3053\u306a\u3048\u307e\u3059\u3002\n\n\u30a2\u30d7\u30ea\u306e\u66f4\u65b0\u6642\u306a\u3069\u3001\u3084\u306f\u308a\u3067\u304d\u308c\u3070\u30b5\u30fc\u30d3\u30b9\u306f\u505c\u6b62\u3055\u305b\u305f\u304f\u306a\u3044\u3082\u306e\u3002\n\u305f\u3068\u3048\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c1\u53f0\u3057\u304b\u306a\u304b\u3063\u305f\u3068\u3057\u3066\u3082\u3001\u3044\u308d\u3044\u308d\u306a\u5de5\u592b\u3092\u3053\u3089\u3057\u305f\u3044\u3002\n", "tags": ["nginx", "spring-boot", "spring"]}