{"tags": ["AWS", "Mobile", "hub", "Swift", "cloudlogic"], "context": "Cloud Logic\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306e\u4f7f\u3044\u65b9\u306f\u3001Function\u306bLambda\u95a2\u6570\u3001Request\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u6307\u5b9a\u3057\u3001Invoke\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002Lambda\u95a2\u6570\u304b\u3089\u306e\u623b\u308a\u5024\u304c\u3001Result\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\nStoryBoard\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\nLambda\u95a2\u6570\u306e\u547c\u3073\u51fa\u3057\u306b\u306f\u3001\u30d8\u30eb\u30d1\u30fc\u30af\u30e9\u30b9AWSCloudLogic\u306einvokeFunction\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u30d6\u30ed\u30c3\u30af\u3067\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u51e6\u7406\u3057\u307e\u3059\u3002\n\nCloudLogicViewController.swift\n    public func invokeFunction(name: String, withParameters parameters: AnyObject?, completionBlock: (AnyObject, NSError) -> Void)\n\n\n\u4f55\u5ea6\u304bInvoke\u3092\u30bf\u30c3\u30d7\u3057\u3066\u5b9f\u884c\u3057\u307e\u3057\u3087\u3046\u3002\nAWS\u30b3\u30f3\u30bd\u30fc\u30eb\u306eLambda\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n\u304d\u3081\u7d30\u304b\u3044\u30a2\u30af\u30bb\u30b9\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3092\u5b9f\u88c5\u3057\u305f\u3044\u5834\u5408\u306f\u3001AWS API Gateway\u3092\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u6b8b\u5ff5\u306a\u304c\u3089\u3001\u307e\u3060Mobile Hub\u3067\u306f\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u307e\u305b\u3093\u304c\u3002\u3002\u3002\n\n\u4f59\u8208 - Lambda\u3067Swift\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\n\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u306eLambda\u3082Swift\u3067\u66f8\u304d\u305f\u304f\u306a\u308a\u307e\u3059\u3088\u306d\uff1f \u8a73\u7d30\u306f\u3053\u3053\nSwift\u306f\u3053\u3061\u3089\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002Ubuntu\u7248\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u306d\u3002  \nhttps://swift.org/download/#releases\nAMI\u306f\u3053\u3061\u3089\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\nUbuntu Server 14.04 LTS (HVM), SSD Volume Type - ami-9abea4fb\n\n\u8a2d\u5b9a\u65b9\u6cd5\nswift\u3068lambda\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nsudo mkdir /usr/local/swift\nsudo chown ubuntu /usr/local/swift\nmkdir ~/lambda\n\nSwift\u30b3\u30f3\u30d1\u30a4\u30e9\u30fc\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# Install dependencies\nsudo apt-get update\nsudo apt-get install clang libicu-dev libbsd-dev\ncd /usr/local/swift/\nwget https://swift.org/builds/ubuntu1404/swift-2.2-SNAPSHOT-2015-12-01-b/swift-2.2-SNAPSHOT-2015-12-01-b-ubuntu14.04.tar.gz\ntar xfz swift-2.2-SNAPSHOT-2015-12-01-b-ubuntu14.04.tar.gz --strip 1\nexport PATH=\"/usr/local/swift/usr/bin/:$PATH\"\n\nSwift\u3067\u3001Hello World\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304d\u307e\u3059\u3002\ncd ~/lambda\necho print\\(\"Hello World\"\\) > hello.swift\nswiftc hello.swift\n./hello\nHello World!\n\nLambda\u30b5\u30fc\u30d3\u30b9\u304c\u52d5\u3044\u3066\u3044\u308bAmazonLinux\u306b\u306f\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u306a\u3044\u305f\u3081\u4e00\u7dd2\u306b\u30a2\u30fc\u30ab\u30a4\u30d6\u3057\u307e\u3059\u3002\n(\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30ea\u30f3\u30af\u3067\u306f\u30c0\u30e1\u307f\u305f\u3044\u3067\u3059\u3002)\n\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nmkdir lib\n\n\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\ncp /usr/local/swift/usr/lib/swift/linux/*.so lib/\ncp /usr/lib/x86_64-linux-gnu/libicudata.so.52 lib/\ncp /usr/lib/x86_64-linux-gnu/libicui18n.so.52 lib/\ncp /usr/lib/x86_64-linux-gnu/libicuuc.so.52 lib/\ncp /usr/lib/x86_64-linux-gnu/libbsd.so lib/libbsd.so.0\n\nvi ~/lambda/index.js\n\nSwift\u3092\u547c\u3073\u51fa\u3059Lambda(Node.js)\u3092\u66f8\u304d\u307e\u3059\u3002\n\nindex.js\nvar exec = require('child_process').exec;\nexports.handler = function(event, context) {\n  child = exec(\"./hello\", function(error) {\n    // Resolve with result of process\n    context.done(error, 'Process complete!');\n  });\n  // Log process stdout and stderr\n  child.stdout.on('data', console.log);\n  child.stderr.on('data', console.error);\n};\n\n\n\u56fa\u3081\u307e\u3059\u3002\nsudo apt-get install zip\nzip swift.zip hello index.js\n\n\u3053\u3093\u306a\u30d5\u30a1\u30a4\u30eb\u69cb\u6210\u306b\u306a\u3063\u3066\u307e\u3059\u3002\n\nAWS\u30b3\u30f3\u30bd\u30fc\u30eb\u306eLambda\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u3001\u4f5c\u6210\u3057\u305fswift.zip\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nRole\u306b\u3001Mobile Hub\u3067\u4f5c\u6210\u3057\u305fRole\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nMobile Hub\u306eCloud Logic\u304b\u3089\u3001\u4f5c\u6210\u3057\u305fLambda\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u307e\u3059\u3002\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3001\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\n\nMobile Hub\u30a2\u30d7\u30ea\u304b\u3089\u3001\u4f5c\u6210\u3057\u305fSwift Lambda\u3092\u547c\u3093\u3067\u307f\u307e\u3059\u3002\n(\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4e00\u65e6\u30a2\u30d7\u30ea\u3092\u518d\u8d77\u52d5\u3057\u3066\u304f\u3060\u3055\u3044\u3002)\n\n\u3046\u307e\u304f\u3044\u304d\u307e\u3057\u305f\uff01  \n\n**Cloud Logic**\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306e\u4f7f\u3044\u65b9\u306f\u3001`Function`\u306bLambda\u95a2\u6570\u3001`Request`\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u6307\u5b9a\u3057\u3001`Invoke`\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002Lambda\u95a2\u6570\u304b\u3089\u306e\u623b\u308a\u5024\u304c\u3001`Result`\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![Screen Shot 2016-06-06 at 8.42.45 AM.png](https://qiita-image-store.s3.amazonaws.com/0/75231/609c25c4-e766-eddf-baf4-14009ff0c301.png)\n`StoryBoard`\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n![CloudLogic_storyboard_\u2014_Edited.jpg](https://qiita-image-store.s3.amazonaws.com/0/75231/7a232d8d-ff04-a335-8749-ac250abd961f.jpeg)\n\n\u30b3\u30fc\u30c9\u3067\u3059\u3002\n![CloudLogicViewController_swift.jpg](https://qiita-image-store.s3.amazonaws.com/0/75231/21e2279d-27db-75d9-adea-56a7e9f8171a.jpeg)\n\nLambda\u95a2\u6570\u306e\u547c\u3073\u51fa\u3057\u306b\u306f\u3001\u30d8\u30eb\u30d1\u30fc\u30af\u30e9\u30b9`AWSCloudLogic`\u306e`invokeFunction`\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u30d6\u30ed\u30c3\u30af\u3067\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u51e6\u7406\u3057\u307e\u3059\u3002\n\n```swift:CloudLogicViewController.swift\n    public func invokeFunction(name: String, withParameters parameters: AnyObject?, completionBlock: (AnyObject, NSError) -> Void)\n```\n\n\u4f55\u5ea6\u304b`Invoke`\u3092\u30bf\u30c3\u30d7\u3057\u3066\u5b9f\u884c\u3057\u307e\u3057\u3087\u3046\u3002\nAWS\u30b3\u30f3\u30bd\u30fc\u30eb\u306eLambda\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u3092\u898b\u3066\u307f\u307e\u3059\u3002\n\n![Screen Shot 2016-06-06 at 8.19.38 AM.png](https://qiita-image-store.s3.amazonaws.com/0/75231/d3ef5f42-345a-8931-0412-7f846d2d30f6.png)\n\n\n\u304d\u3081\u7d30\u304b\u3044\u30a2\u30af\u30bb\u30b9\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3092\u5b9f\u88c5\u3057\u305f\u3044\u5834\u5408\u306f\u3001AWS API Gateway\u3092\u4f7f\u7528\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u6b8b\u5ff5\u306a\u304c\u3089\u3001\u307e\u3060Mobile Hub\u3067\u306f\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u307e\u305b\u3093\u304c\u3002\u3002\u3002\n\n## \u4f59\u8208 - Lambda\u3067Swift\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\n\n\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u306eLambda\u3082Swift\u3067\u66f8\u304d\u305f\u304f\u306a\u308a\u307e\u3059\u3088\u306d\uff1f [\u8a73\u7d30\u306f\u3053\u3053]\n(https://medium.com/@gigq/using-swift-in-aws-lambda-6e2a67a27e03#.xq9iazgkv)\n\nSwift\u306f\u3053\u3061\u3089\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002Ubuntu\u7248\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u306d\u3002 :disappointed_relieved: \nhttps://swift.org/download/#releases\n\nAMI\u306f\u3053\u3061\u3089\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n\nUbuntu Server 14.04 LTS (HVM), SSD Volume Type - ami-9abea4fb\n\n## \u8a2d\u5b9a\u65b9\u6cd5\n\n`swift`\u3068`lambda`\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash\nsudo mkdir /usr/local/swift\nsudo chown ubuntu /usr/local/swift\nmkdir ~/lambda\n```\n\nSwift\u30b3\u30f3\u30d1\u30a4\u30e9\u30fc\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\n# Install dependencies\nsudo apt-get update\nsudo apt-get install clang libicu-dev libbsd-dev\ncd /usr/local/swift/\nwget https://swift.org/builds/ubuntu1404/swift-2.2-SNAPSHOT-2015-12-01-b/swift-2.2-SNAPSHOT-2015-12-01-b-ubuntu14.04.tar.gz\ntar xfz swift-2.2-SNAPSHOT-2015-12-01-b-ubuntu14.04.tar.gz --strip 1\nexport PATH=\"/usr/local/swift/usr/bin/:$PATH\"\n```\n\nSwift\u3067\u3001Hello World\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```bash\ncd ~/lambda\necho print\\(\"Hello World\"\\) > hello.swift\nswiftc hello.swift\n./hello\nHello World!\n```\n\nLambda\u30b5\u30fc\u30d3\u30b9\u304c\u52d5\u3044\u3066\u3044\u308b`AmazonLinux`\u306b\u306f\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u306a\u3044\u305f\u3081\u4e00\u7dd2\u306b\u30a2\u30fc\u30ab\u30a4\u30d6\u3057\u307e\u3059\u3002\n(\u30b9\u30bf\u30c6\u30a3\u30c3\u30af\u30ea\u30f3\u30af\u3067\u306f\u30c0\u30e1\u307f\u305f\u3044\u3067\u3059\u3002)\n\n\u30c0\u30a4\u30ca\u30df\u30c3\u30af\u30e9\u30a4\u30d6\u30e9\u30ea\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash\nmkdir lib\n```\n\n\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\n```bash\ncp /usr/local/swift/usr/lib/swift/linux/*.so lib/\ncp /usr/lib/x86_64-linux-gnu/libicudata.so.52 lib/\ncp /usr/lib/x86_64-linux-gnu/libicui18n.so.52 lib/\ncp /usr/lib/x86_64-linux-gnu/libicuuc.so.52 lib/\ncp /usr/lib/x86_64-linux-gnu/libbsd.so lib/libbsd.so.0\n```\n\n```bash\nvi ~/lambda/index.js\n```\n\nSwift\u3092\u547c\u3073\u51fa\u3059Lambda(Node.js)\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```js:index.js\nvar exec = require('child_process').exec;\nexports.handler = function(event, context) {\n  child = exec(\"./hello\", function(error) {\n    // Resolve with result of process\n    context.done(error, 'Process complete!');\n  });\n  // Log process stdout and stderr\n  child.stdout.on('data', console.log);\n  child.stderr.on('data', console.error);\n};\n```\n\n\u56fa\u3081\u307e\u3059\u3002\n\n```bash\nsudo apt-get install zip\nzip swift.zip hello index.js\n```\n\n\u3053\u3093\u306a\u30d5\u30a1\u30a4\u30eb\u69cb\u6210\u306b\u306a\u3063\u3066\u307e\u3059\u3002\n\n![Screen Shot 2016-06-06 at 9.35.22 PM.png](https://qiita-image-store.s3.amazonaws.com/0/75231/422ba370-3f09-7908-40f4-6b9c157c021c.png)\n\n\nAWS\u30b3\u30f3\u30bd\u30fc\u30eb\u306eLambda\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u3001\u4f5c\u6210\u3057\u305f`swift.zip`\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n`Role`\u306b\u3001Mobile Hub\u3067\u4f5c\u6210\u3057\u305fRole\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n![Lambda_Management_Console_\ud83d\udd0a.jpg](https://qiita-image-store.s3.amazonaws.com/0/75231/8b9de9b6-b8c4-ffad-e9ec-f489317660e8.jpeg)\n\nMobile Hub\u306eCloud Logic\u304b\u3089\u3001\u4f5c\u6210\u3057\u305fLambda\u30d5\u30a1\u30f3\u30af\u30b7\u30e7\u30f3\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u307e\u3059\u3002\n\n![AWS_Mobile_Hub_\ud83d\udd0a.jpg](https://qiita-image-store.s3.amazonaws.com/0/75231/6cfef0ba-6ad5-46ea-ab6e-e674c6da2a70.jpeg)\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u3001\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\n\n![Lambda_Management_Console_\ud83d\udd0a.jpg](https://qiita-image-store.s3.amazonaws.com/0/75231/378c95d2-365e-6987-97c9-98efb65e2abf.jpeg)\n\nMobile Hub\u30a2\u30d7\u30ea\u304b\u3089\u3001\u4f5c\u6210\u3057\u305fSwift Lambda\u3092\u547c\u3093\u3067\u307f\u307e\u3059\u3002\n(\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4e00\u65e6\u30a2\u30d7\u30ea\u3092\u518d\u8d77\u52d5\u3057\u3066\u304f\u3060\u3055\u3044\u3002)\n\n![Screen Shot 2016-06-06 at 10.04.48 PM.png](https://qiita-image-store.s3.amazonaws.com/0/75231/7818458a-1987-69cd-73db-f9550afb799e.png)\n\n\u3046\u307e\u304f\u3044\u304d\u307e\u3057\u305f\uff01 :smiley: \n"}