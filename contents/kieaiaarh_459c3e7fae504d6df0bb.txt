{"tags": ["Elasticsearch", "CircleCI", "Rails"], "context": "\nException in thread \"main\" java.lang.IllegalArgumentException: Unknown [gateway] type [none]\n\nrspec\u306b\u3066\u3001Elasticsearch\u3092\u7528\u3044\u305f\u30a2\u30d7\u30ea\u306e\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u4e2d\u306b\u3001\u4e0a\u8a18\u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u30cf\u30de\u3063\u305f\u306e\u3067\u3001\u5099\u5fd8\u9332\u3068\u3057\u3066\u3002\u3002\u3002\nES\u306e\u8d77\u52d5\u6642\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068\u3001gateway\u306flocal\u306e\u306f\u305a\u3060\u304c\u306a\u305c\u30fb\u30fb\u30fb\n\n\u8abf\u67fb\uff11\nhttps://github.com/elastic/elasticsearch/issues/347\n\u4e00\u5fdc\u30a8\u30e9\u30fc\u304b\u3089\u30bd\u30fc\u30b9\u3092\u8ffd\u3063\u3066\u307f\u308b\u3068\u3001\nhttps://github.com/elastic/elasticsearch/blob/master/core/src/main/java/org/elasticsearch/common/util/ExtensionPoint.java#L150\n\u3067\u3053\u3051\u3066\u3044\u308b\u3002\n\u3067\u3001\u3053\u3053\u304b\u3089\u30c8\u30ec\u30fc\u30b9\u3092\u3057\u3066\u307f\u3066\u3082\u3002\u3002\u3002\nhttps://github.com/jprante/elasticsearch-server/blob/master/elasticsearch-server-node/src/main/java/org/elasticsearch/gateway/GatewayModule.java#L28\n\u3060\u3057\u3001gateway\u304cnone\u3068\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u304c\u5168\u304f\u3082\u3063\u3066\u4e0d\u660e\u3002\n\n\u8abf\u67fb2\n\u305d\u3057\u3066\u3001\u3055\u3089\u306b\u3001\u8b0e\u306a\u306e\u304c\u3001\nTEST_CLUSTER_NAME=my-testing-cluster \\\nTEST_CLUSTER_COMMAND=/usr/local/Cellar/elasticsearch/0.90.10/bin/elasticsearch \\\nTEST_CLUSTER_PORT=9350 \\\nTEST_CLUSTER_NODES=3 \\\nTEST_CLUSTER_NAME=my_testing_cluster \\\nruby -r elasticsearch -e \"require 'elasticsearch/extensions/test/cluster'; Elasticsearch::Extensions::Test::Cluster.start\"\n\n\u307f\u305f\u3044\u306a\u611f\u3058\u3067\u30b3\u30de\u30f3\u30c9\u304b\u3089\u5b9f\u884c\u3059\u308b\u3068\u3046\u307e\u304f\u3044\u304f\u30fb\u30fb\u30fb\u3068\u3044\u3046\u3000  \n\n\u8abf\u67fb3\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u6f01\u3063\u3066\u3002\u3002\u3002\u3002\n\u30b3\u30de\u30f3\u30c9\u3067\u518d\u73fe\u3092\u3057\u3066\u307f\u305f\u3068\u3053\u308d\u3002\u3002\u3002\u3002\n~ $ elasticsearch -D es.foreground=yes -D es.cluster.name=elasticsearch-test-apple-no-macbook-pro.local -D es.node.name=node-1 -D es.http.port=9250 -D es.path.data=/tmp/elasticsearch_test -D es.path.work=/tmp -D es.path.logs=/tmp/log/elasticsearch -D es.cluster.routing.allocation.disk.threshold_enabled=false -D es.network.host=localhost -D es.script.inline=true -D es.script.stored=true -D es.node.attr.testattr=test -D es.path.repo=/tmp -D es.repositories.url.allowed_urls=http://snapshot.test* -D es.logger.level=DEBUG -D es.gateway.type=none\n:\n:\nException in thread \"main\" java.lang.IllegalArgumentException: Unknown [gateway] type [none]\n    at org.elasticsearch.common.util.ExtensionPoint$SelectedType.bindType(ExtensionPoint.java:146)\n    at org.elasticsearch.gateway.GatewayModule.configure(GatewayModule.java:53)\n    at <<<guice>>>\n    at org.elasticsearch.node.Node.<init>(Node.java:213)\n    at org.elasticsearch.node.Node.<init>(Node.java:140)\n    at org.elasticsearch.node.NodeBuilder.build(NodeBuilder.java:143)\n    at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:178)\n    at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:270)\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:35)\nRefer to the log for complete error details.\n\n\u518d\u73fe\u3067\u304d\u305f\u3002\n\u8981\u306f\n\n-D es.gateway.type=none\n\n\u304c\u9593\u9055\u3044\u3067\u3001\n\n-D es.gateway=local\n\n\u3068\u3059\u308b\u3068\n[2016-07-24 21:17:02,368][INFO ][node                     ] [node-1] started\n[2016-07-24 21:17:02,371][DEBUG][cluster.service          ] [node-1] processing [local-gateway-elected-state]: execute\n[2016-07-24 21:17:02,372][DEBUG][cluster.service          ] [node-1] cluster state updated, version [2], source [local-gateway-elected-state]\n[2016-07-24 21:17:02,372][DEBUG][cluster.service          ] [node-1] publishing cluster state version [2]\n[2016-07-24 21:17:02,372][DEBUG][cluster.service          ] [node-1] set local cluster state to version 2\n[2016-07-24 21:17:02,389][INFO ][gateway                  ] [node-1] recovered [0] indices into cluster_state\n[2016-07-24 21:17:02,389][DEBUG][cluster.service          ] [node-1] processing [local-gateway-elected-state]: took 18ms done applying updated cluster_state (version: 2, uuid: -NnoHok5TRWNODw59ligMQ)\n\n\u3068\u306a\u308a\u3001\u7121\u4e8b\u8d77\u52d5\u6210\u529f\u3002\n\u4f59\u8ac7\u3060\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u304c\u3000local\u306a\u306e\u3067\u3001\n\n-D es.gateway=none\n\n\u3067\u3082\u3044\u3051\u308b\u3002\n\n\u7d50\u679c\nhttps://github.com/kieaiaarh/lancher_es/pull/6/files#diff-d95265df13cf89b449e4b80218d35125R11\nElasticsearch::Extensions::Test::Cluster.start port: 9250, network_host: 'localhost', es_params: '-D es.gateway=local' unless Elasticsearch::Extensions::Test::Cluster.running?(on: 9250)`\n\nTEST Cluster\u8d77\u52d5\u6642\u306b\u8a2d\u5b9a\u8ffd\u52a0\u3057\u3066\u3001\u5b8c\u4e86\u3002\n\u3061\u306a\u307f\u306b\u3001network_host\u3082\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068\u3001\u30000.0.0.0\uff08\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\uff09\u306a\u306e\u3067\u3001CI\u30c6\u30b9\u30c8\u6642\u3001\u6c17\u6301\u3061\u60aa\u3044\u305f\u3081\u3001\u56fa\u5b9a\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u30e2\u30e4\u3063\u3068\u3002\u3002\u3002\n\nException in thread \"main\" java.lang.IllegalArgumentException: Unknown [gateway] type [none]\n\n\u306b\u3064\u3044\u3066\u306f\u3001\u306a\u305c\u3053\u3046\u306a\u3063\u305f\u306e\u304b\u304c\u73fe\u72b6\u307e\u3060\u4e0d\u660e\u30fb\u30fb\u30fb\u3002\nelasticsearch.yml\u3067\u3000\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u3082\u306a\u3057\u3002\u3002\u3002\u305d\u3082\u305d\u3082\u30d0\u30b0\u306a\u306e\u304b\u3001\u3001\u3001\u3068\u308a\u3042\u3048\u305a\u306f\u5148\u306b\u9032\u3081\u305f\u3044\u306e\u3067\u3001\u4e00\u65e6\u3000FIXME\u3068\u3057\u3066\u304a\u3053\u3002\n> Exception in thread \"main\" java.lang.IllegalArgumentException: Unknown [gateway] type [none]\n\nrspec\u306b\u3066\u3001Elasticsearch\u3092\u7528\u3044\u305f\u30a2\u30d7\u30ea\u306e\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\u4e2d\u306b\u3001\u4e0a\u8a18\u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u30cf\u30de\u3063\u305f\u306e\u3067\u3001\u5099\u5fd8\u9332\u3068\u3057\u3066\u3002\u3002\u3002\n\nES\u306e\u8d77\u52d5\u6642\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068\u3001gateway\u306flocal\u306e\u306f\u305a\u3060\u304c\u306a\u305c\u30fb\u30fb\u30fb\n\n## \u8abf\u67fb\uff11\nhttps://github.com/elastic/elasticsearch/issues/347\n\n\u4e00\u5fdc\u30a8\u30e9\u30fc\u304b\u3089\u30bd\u30fc\u30b9\u3092\u8ffd\u3063\u3066\u307f\u308b\u3068\u3001\nhttps://github.com/elastic/elasticsearch/blob/master/core/src/main/java/org/elasticsearch/common/util/ExtensionPoint.java#L150\n\n\u3067\u3053\u3051\u3066\u3044\u308b\u3002\n\n\u3067\u3001\u3053\u3053\u304b\u3089\u30c8\u30ec\u30fc\u30b9\u3092\u3057\u3066\u307f\u3066\u3082\u3002\u3002\u3002\nhttps://github.com/jprante/elasticsearch-server/blob/master/elasticsearch-server-node/src/main/java/org/elasticsearch/gateway/GatewayModule.java#L28\n\n\u3060\u3057\u3001gateway\u304c`none`\u3068\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u304c\u5168\u304f\u3082\u3063\u3066\u4e0d\u660e\u3002\n\n## \u8abf\u67fb2\n\n\u305d\u3057\u3066\u3001\u3055\u3089\u306b\u3001\u8b0e\u306a\u306e\u304c\u3001\n\n```\nTEST_CLUSTER_NAME=my-testing-cluster \\\nTEST_CLUSTER_COMMAND=/usr/local/Cellar/elasticsearch/0.90.10/bin/elasticsearch \\\nTEST_CLUSTER_PORT=9350 \\\nTEST_CLUSTER_NODES=3 \\\nTEST_CLUSTER_NAME=my_testing_cluster \\\nruby -r elasticsearch -e \"require 'elasticsearch/extensions/test/cluster'; Elasticsearch::Extensions::Test::Cluster.start\"\n```\n\u307f\u305f\u3044\u306a\u611f\u3058\u3067\u30b3\u30de\u30f3\u30c9\u304b\u3089\u5b9f\u884c\u3059\u308b\u3068\u3046\u307e\u304f\u3044\u304f\u30fb\u30fb\u30fb\u3068\u3044\u3046\u3000 :astonished: \n\n## \u8abf\u67fb3\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u6f01\u3063\u3066\u3002\u3002\u3002\u3002\n\u30b3\u30de\u30f3\u30c9\u3067\u518d\u73fe\u3092\u3057\u3066\u307f\u305f\u3068\u3053\u308d\u3002\u3002\u3002\u3002\n\n```cli\n~ $ elasticsearch -D es.foreground=yes -D es.cluster.name=elasticsearch-test-apple-no-macbook-pro.local -D es.node.name=node-1 -D es.http.port=9250 -D es.path.data=/tmp/elasticsearch_test -D es.path.work=/tmp -D es.path.logs=/tmp/log/elasticsearch -D es.cluster.routing.allocation.disk.threshold_enabled=false -D es.network.host=localhost -D es.script.inline=true -D es.script.stored=true -D es.node.attr.testattr=test -D es.path.repo=/tmp -D es.repositories.url.allowed_urls=http://snapshot.test* -D es.logger.level=DEBUG -D es.gateway.type=none\n:\n:\nException in thread \"main\" java.lang.IllegalArgumentException: Unknown [gateway] type [none]\n\tat org.elasticsearch.common.util.ExtensionPoint$SelectedType.bindType(ExtensionPoint.java:146)\n\tat org.elasticsearch.gateway.GatewayModule.configure(GatewayModule.java:53)\n\tat <<<guice>>>\n\tat org.elasticsearch.node.Node.<init>(Node.java:213)\n\tat org.elasticsearch.node.Node.<init>(Node.java:140)\n\tat org.elasticsearch.node.NodeBuilder.build(NodeBuilder.java:143)\n\tat org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:178)\n\tat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:270)\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:35)\nRefer to the log for complete error details.\n```\n\n\u518d\u73fe\u3067\u304d\u305f\u3002\n\n\u8981\u306f\n```\n-D es.gateway.type=none\n```\n\n\u304c\u9593\u9055\u3044\u3067\u3001\n```\n-D es.gateway=local\n```\n\u3068\u3059\u308b\u3068\n\n```\n[2016-07-24 21:17:02,368][INFO ][node                     ] [node-1] started\n[2016-07-24 21:17:02,371][DEBUG][cluster.service          ] [node-1] processing [local-gateway-elected-state]: execute\n[2016-07-24 21:17:02,372][DEBUG][cluster.service          ] [node-1] cluster state updated, version [2], source [local-gateway-elected-state]\n[2016-07-24 21:17:02,372][DEBUG][cluster.service          ] [node-1] publishing cluster state version [2]\n[2016-07-24 21:17:02,372][DEBUG][cluster.service          ] [node-1] set local cluster state to version 2\n[2016-07-24 21:17:02,389][INFO ][gateway                  ] [node-1] recovered [0] indices into cluster_state\n[2016-07-24 21:17:02,389][DEBUG][cluster.service          ] [node-1] processing [local-gateway-elected-state]: took 18ms done applying updated cluster_state (version: 2, uuid: -NnoHok5TRWNODw59ligMQ)\n```\n\n\u3068\u306a\u308a\u3001\u7121\u4e8b\u8d77\u52d5\u6210\u529f\u3002\n\n\u4f59\u8ac7\u3060\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u304c\u3000`local`\u306a\u306e\u3067\u3001\n```\n-D es.gateway=none\n```\n\u3067\u3082\u3044\u3051\u308b\u3002\n\n## \u7d50\u679c\nhttps://github.com/kieaiaarh/lancher_es/pull/6/files#diff-d95265df13cf89b449e4b80218d35125R11\n\n```rb\nElasticsearch::Extensions::Test::Cluster.start port: 9250, network_host: 'localhost', es_params: '-D es.gateway=local' unless Elasticsearch::Extensions::Test::Cluster.running?(on: 9250)`\n```\n\nTEST Cluster\u8d77\u52d5\u6642\u306b\u8a2d\u5b9a\u8ffd\u52a0\u3057\u3066\u3001\u5b8c\u4e86\u3002\n\n\u3061\u306a\u307f\u306b\u3001`network_host`\u3082\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3068\u3001\u3000`0.0.0.0`\uff08\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\uff09\u306a\u306e\u3067\u3001CI\u30c6\u30b9\u30c8\u6642\u3001\u6c17\u6301\u3061\u60aa\u3044\u305f\u3081\u3001\u56fa\u5b9a\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\n\n## \u30e2\u30e4\u3063\u3068\u3002\u3002\u3002\n> Exception in thread \"main\" java.lang.IllegalArgumentException: Unknown [gateway] type [none]\n\n\u306b\u3064\u3044\u3066\u306f\u3001\u306a\u305c\u3053\u3046\u306a\u3063\u305f\u306e\u304b\u304c\u73fe\u72b6\u307e\u3060\u4e0d\u660e\u30fb\u30fb\u30fb\u3002\nelasticsearch.yml\u3067\u3000\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u308f\u3051\u3067\u3082\u306a\u3057\u3002\u3002\u3002\u305d\u3082\u305d\u3082\u30d0\u30b0\u306a\u306e\u304b\u3001\u3001\u3001\u3068\u308a\u3042\u3048\u305a\u306f\u5148\u306b\u9032\u3081\u305f\u3044\u306e\u3067\u3001\u4e00\u65e6\u3000FIXME\u3068\u3057\u3066\u304a\u3053\u3002\n"}