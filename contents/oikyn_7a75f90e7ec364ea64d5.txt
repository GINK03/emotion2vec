{"tags": ["PHP", "Phalcon1.2.4"], "context": " More than 1 year has passed since last update.\n\nPhalcon\nPhalcon Framework\u3092\u5229\u7528\u3057\u3066API\u3092\u5b9f\u88c5\u3057\u305f\u3068\u304d\u306e\u30b9\u30b1\u30eb\u30c8\u30f3\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u672c\u5bb6\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\nhttp://docs.phalconphp.com/en/latest/reference/micro.html\n\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fb\u30d5\u30a1\u30a4\u30eb\u69cb\u6210\n\u57fa\u672c\u69cb\u6210\u306f\u3001Phalcon Developer Tools\u3092\u4f7f\u7528\u3057\u3066\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\nphalcon-micro\n\u2502  .htaccess\n\u2502  app.php\n\u2502\n\u251c\u2500.phalcon\n\u251c\u2500app\n\u2502  \u251c\u2500collections\n\u2502  \u2502      UserCollection.php\n\u2502  \u2502\n\u2502  \u251c\u2500config\n\u2502  \u2502      config.php\n\u2502  \u2502      loader.php\n\u2502  \u2502      services.php\n\u2502  \u2502\n\u2502  \u251c\u2500controllers\n\u2502  \u2502      ControllerBase.php\n\u2502  \u2502      UserController.php\n\u2502  \u2502\n\u2502  \u251c\u2500models\n\u2502  \u2514\u2500views\n\u2502\n\u251c\u2500logs\n\u2502\n\u2514\u2500public\n    \u2502  .htaccess\n    \u2502  index.php\n    \u2502\n    \u251c\u2500css\n    \u251c\u2500files\n    \u251c\u2500img\n    \u2514\u2500js\n\n\nAPI\u7528\u306b\u8ffd\u52a0\u3057\u305f\u90e8\u5206\n\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\nDeveloper Tools\u3067\u4f5c\u6210\u3059\u308b\u3068\u3001MV\u3057\u304b\u306a\u3044\u3002\n\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\nhttp://docs.phalconphp.com/en/latest/reference/micro.html#using-controllers-as-handlers\n\n\n\u30b5\u30f3\u30d7\u30eb\u30bd\u30fc\u30b9\n\napp.php\n\u203b\u30eb\u30fc\u30bf\u30fc\u306e\u5f79\u5272\n<?php\n\n//API\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\n$version = \"1.0\";\n\n//\u672a\u5b9a\u7fa9\u306e\u30d1\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u5834\u5408\u306b\u5b9f\u884c\u3055\u308c\u308b\n$app->notFound(array(new ControllerBase(), \"notFoundAction\"));\n\n//\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\ninclude __DIR__ . '/app/collections/UserCollection.php';\n\n\n\nUserCollection.php\n<?php\n\nuse Phalcon\\Mvc\\Micro\\Collection as MicroCollection;\n\n$userCollection = new MicroCollection();\n\n//\u30e1\u30a4\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\n$userCollection->setHandler(new UserController());\n\n//\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u5185\u3067\u306e\u5171\u901aprefix\n$userCollection->setPrefix(\"/{$version}/user\");\n\n/**\n  * \u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u53d6\u5f97\n  *\n  * http://api.sample.com/1.0/user/\n  * \u306b\u5bfe\u3057\u3066\n  * GET\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\n  * UserController\u306eapi_index\u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\n  */\n$userCollection->get(\"/\", \"api_index\");\n\n/**\n  * \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n  *\n  * http://api.sample.com/1.0/user/register/\n  * \u306b\u5bfe\u3057\u3066\n  * POST\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\n  * UserController\u306eapi_register\u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\n  */\n$userCollection->post(\"/register\", \"api_register\");\n\n$app->mount($userCollection);\n\n\n\nUserController.php\n<?php\n\nclass UserController extends ControllerBase {\n\n    public function api_index() {\n\n    }\n\n    public function api_register() {\n\n    }\n}\n\n\nControllerBase.php\n\u203b\u5168\u3066\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u306e\u30d9\u30fc\u30b9\n<?php\n\nuse Phalcon\\Mvc\\Controller;\n\nclass ControllerBase extends Controller\n{\n    /**\n     * \n     * @param int $code\n     * @param array $content\n     */\n    protected function output($code, $content=array()) {\n        //Header\n        $this->response->setContentType('application/json')\n                       ->setStatusCode($code, null)\n                       ->sendHeaders();\n        //Body\n        $this->response->setJsonContent($content)\n                       ->send();\n    }\n\n    public function notFoundAction() {\n        $this->output(404);\n    }\n}\n\nPhalcon\n=\n\nPhalcon Framework\u3092\u5229\u7528\u3057\u3066API\u3092\u5b9f\u88c5\u3057\u305f\u3068\u304d\u306e\u30b9\u30b1\u30eb\u30c8\u30f3\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n\u672c\u5bb6\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001  \n<http://docs.phalconphp.com/en/latest/reference/micro.html>  \n\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\n\n####\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30fb\u30d5\u30a1\u30a4\u30eb\u69cb\u6210\n\n\u57fa\u672c\u69cb\u6210\u306f\u3001Phalcon Developer Tools\u3092\u4f7f\u7528\u3057\u3066\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n```\nphalcon-micro\n\u2502  .htaccess\n\u2502  app.php\n\u2502\n\u251c\u2500.phalcon\n\u251c\u2500app\n\u2502  \u251c\u2500collections\n\u2502  \u2502      UserCollection.php\n\u2502  \u2502\n\u2502  \u251c\u2500config\n\u2502  \u2502      config.php\n\u2502  \u2502      loader.php\n\u2502  \u2502      services.php\n\u2502  \u2502\n\u2502  \u251c\u2500controllers\n\u2502  \u2502      ControllerBase.php\n\u2502  \u2502      UserController.php\n\u2502  \u2502\n\u2502  \u251c\u2500models\n\u2502  \u2514\u2500views\n\u2502\n\u251c\u2500logs\n\u2502\n\u2514\u2500public\n    \u2502  .htaccess\n    \u2502  index.php\n    \u2502\n    \u251c\u2500css\n    \u251c\u2500files\n    \u251c\u2500img\n    \u2514\u2500js\n```\n\n####API\u7528\u306b\u8ffd\u52a0\u3057\u305f\u90e8\u5206\n\n\n1. \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc  \nDeveloper Tools\u3067\u4f5c\u6210\u3059\u308b\u3068\u3001MV\u3057\u304b\u306a\u3044\u3002\n\n2. \u30b3\u30ec\u30af\u30b7\u30e7\u30f3  \n<http://docs.phalconphp.com/en/latest/reference/micro.html#using-controllers-as-handlers>\n\n\n####\u30b5\u30f3\u30d7\u30eb\u30bd\u30fc\u30b9\n#####app.php\n\u203b\u30eb\u30fc\u30bf\u30fc\u306e\u5f79\u5272\n\n```\n<?php\n\n//API\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\n$version = \"1.0\";\n\n//\u672a\u5b9a\u7fa9\u306e\u30d1\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u5834\u5408\u306b\u5b9f\u884c\u3055\u308c\u308b\n$app->notFound(array(new ControllerBase(), \"notFoundAction\"));\n\n//\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u306e\u30a4\u30f3\u30af\u30eb\u30fc\u30c9\ninclude __DIR__ . '/app/collections/UserCollection.php';\n\n```\n\n#####UserCollection.php\n\n```\n<?php\n\nuse Phalcon\\Mvc\\Micro\\Collection as MicroCollection;\n\n$userCollection = new MicroCollection();\n\n//\u30e1\u30a4\u30f3\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\n$userCollection->setHandler(new UserController());\n\n//\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u5185\u3067\u306e\u5171\u901aprefix\n$userCollection->setPrefix(\"/{$version}/user\");\n\n/**\n  * \u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u53d6\u5f97\n  *\n  * http://api.sample.com/1.0/user/\n  * \u306b\u5bfe\u3057\u3066\n  * GET\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\n  * UserController\u306eapi_index\u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\n  */\n$userCollection->get(\"/\", \"api_index\");\n\n/**\n  * \u30e6\u30fc\u30b6\u30fc\u767b\u9332\n  *\n  * http://api.sample.com/1.0/user/register/\n  * \u306b\u5bfe\u3057\u3066\n  * POST\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\n  * UserController\u306eapi_register\u30e1\u30bd\u30c3\u30c9\u304c\u5b9f\u884c\u3055\u308c\u308b\n  */\n$userCollection->post(\"/register\", \"api_register\");\n\n$app->mount($userCollection);\n\n```\n\n#####UserController.php\n\n```\n<?php\n\nclass UserController extends ControllerBase {\n    \n    public function api_index() {\n\n    }\n    \n    public function api_register() {\n\n    }\n}\n```\n\n#####ControllerBase.php\n\u203b\u5168\u3066\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u306e\u30d9\u30fc\u30b9\n\n```\n<?php\n\nuse Phalcon\\Mvc\\Controller;\n\nclass ControllerBase extends Controller\n{\n    /**\n     * \n     * @param int $code\n     * @param array $content\n     */\n    protected function output($code, $content=array()) {\n        //Header\n        $this->response->setContentType('application/json')\n                       ->setStatusCode($code, null)\n                       ->sendHeaders();\n        //Body\n        $this->response->setJsonContent($content)\n                       ->send();\n    }\n    \n    public function notFoundAction() {\n        $this->output(404);\n    }\n}\n```\n"}