{"context": "Hadoop\u306e\u52c9\u5f37\u3092\u3057\u3066\u3044\u308b\u3068\u304d\u306b\u51fa\u304f\u308f\u3057\u3066\u305d\u306e\u6642\u306e\u30e1\u30e2\u3002\n\nCopyOnWriteArrayList\u30af\u30e9\u30b9\nHashtable\u3084HashMap\u306e\u554f\u984c\u3092\u89e3\u6c7a\u3057\u305f\uff08\uff1f\uff09\u30af\u30e9\u30b9\u3002\n\u914d\u5217\u3092\u65b0\u898f\u306b\u30b3\u30d4\u30fc\u3057\u3066ArrayList\u3067ConcurrentModificationException\u304c\u8d77\u3053\u308b\u4f8b\u5916\u3092\u8d77\u3053\u3055\u305a\u306b\u51e6\u7406\u3057\u3066\u304f\u308c\u308b\u3068\u304b\u3002\n\u4f8b\u3048\u3070\u3001\nArrayList\u306eConcurrentModificationException\u767a\u751f\u3055\u305b\u305f\u4f8b\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u308b\n\nArrayListSample.java\nimport java.util.ArrayList;\n\npublic class ArrayListSample{\n    private static ArrayList<String> arraylist = new ArrayList<String>();\n\n    public static void main(String[] args) {     \n        //\u8981\u7d20\u8ffd\u52a0\n        for(int i = 0; i < 10000; i++)\n        {\n            arraylist.add(\"ArrayList\" + i);\n        }\n\n        //\u5225\u30b9\u30ec\u30c3\u30c9\u3067\u30ea\u30b9\u30c8\u3092\u8d70\u67fb\u3059\u308b\n        Thread th = new Thread(new Runnable(){\n                @Override\n                public void run(){\n                    for(String h : arraylist)\n                    {\n                        arraylist.remove(h);  //ConcurrentModificationException\u767a\u751f\u3002\n                    }\n                }\n        });\n\n        th.start();\n\n        //\u64cd\u4f5c\u4e2d\u306b\u524a\u9664\n        arraylist.remove(\"ArrayList0\");\n        System.out.println(\"\u524a\u9664\u5b8c\u4e86\");\n     }\n}\n\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\n\u524a\u9664\u5b8c\u4e86\nException in thread \"Thread-0\" java.util.ConcurrentModificationException\n    at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901)\n    at java.util.ArrayList$Itr.next(ArrayList.java:851)\n    at ArrayListSample$1.run(ArrayListSample.java:19)\n    at java.lang.Thread.run(Thread.java:745)\n\n\u3053\u308c\u306f\u3001\u30ea\u30b9\u30c8\u3092\u540c\u671f\u305b\u305a\u30a4\u30c6\u30ec\u30fc\u30bf\u52d5\u4f5c\u4e2d\u306b\u4ed6\u306e\u30b9\u30ec\u30c3\u30c9\u3067\u5909\u66f4\u3092\u304b\u3051\u305f\u305f\u3081\u306b\u8d77\u304d\u305f\u3002\n\u8981\u306f\u540c\u671f\u3057\u308d\u3068\u3044\u3046\u3053\u3068\u3067synchronized\u3084Collections.synchronizedList\u3092\u4f7f\u3048\u3070\u76f4\u308b\u3068\u601d\u3063\u305f\u304c\u3001\u76f4\u3089\u306a\u3044\u3002\n\u3060\u304c\u3001\u3053\u308c\u306fArrayList\u306e\u6240\u3092CopyOnWriteArrayList\u3068\u5909\u3048\u308b\u3060\u3051\u3067\u89e3\u6c7a\u3067\u304d\u3066\u3057\u307e\u3063\u305f\u3002\n\nCopyOnWriteArrayListSample.java\nimport java.util.concurrent.CopyOnWriteArrayList;\n\npublic class CopyOnWriteArrayListSample{\n    private static CopyOnWriteArrayList<String> copyonwritearraylist = new CopyOnWriteArrayList<String>();\n\n    public static void main(String[] args) {     \n        //\u8981\u7d20\u8ffd\u52a0\n        for(int i = 0; i < 10000; i++)\n        {\n            copyonwritearraylist.add(\"ArrayList\" + i);\n        }\n\n        //\u5225\u30b9\u30ec\u30c3\u30c9\u3067\u30ea\u30b9\u30c8\u3092\u8d70\u67fb\u3059\u308b\n        Thread th = new Thread(new Runnable(){\n                @Override\n                public void run(){\n                    for(String h : copyonwritearraylist)\n                    {\n                        copyonwritearraylist.remove(h);\n                    }\n                }\n        });\n\n        th.start();\n\n        //\u64cd\u4f5c\u4e2d\u306b\u524a\u9664\n        arrayList.remove(\"copyonwritearraylist0\");\n        System.out.println(\"\u524a\u9664\u5b8c\u4e86\");\n     }\n}\n\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\n\u524a\u9664\u5b8c\u4e86\n\n\u3053\u308c\u306f\u6700\u521d\u306b\u8a18\u8ff0\u3057\u305f\u3088\u3046\u306b\u3001\u307e\u305a\u914d\u5217\u3092\u65b0\u898f\u306b\u307e\u308b\u307e\u308b\u30b3\u30d4\u30fc\u3057\u3066\u30b3\u30d4\u30fc\u3057\u305f\u914d\u5217\u3067\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u3001ConcurrentModificationException\u304c\u8d77\u304d\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3002synchronized\u7b49\u3092\u4f7f\u3046\u3068\u3001\u540c\u3058\u914d\u5217\u4e2d\u3067\u51e6\u7406\u3092\u884c\u3063\u3066\u52d5\u4f5c\u3059\u308b\u305f\u3081\u3053\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u89e3\u6c7a\u3067\u304d\u306a\u304b\u3063\u305f\u3002\u306a\u306e\u3067\u4e26\u884c\u3057\u3066\u914d\u5217\u306e\u51e6\u7406\u3092\u3059\u308b\u3068\u304d\u306fCopyOnWriteArrayList\u3092\u4f7f\u3046\u3053\u3068\u304c\u30aa\u30b9\u30b9\u30e1\u3002\u3060\u304c\u3053\u308c\u306b\u3082\u6b20\u70b9\u304c\u3042\u308a\u3001\u305d\u308c\u306f\u666e\u901a\u306bArrayList\u3067\u51e6\u7406\u3092\u3059\u308b\u3088\u308a\u51e6\u7406\u306b\u6642\u9593\u304c\u304b\u306a\u308a\u304b\u304b\u308b\u3068\u3044\u3046\u3053\u3068\u3002\u3060\u304b\u3089\u3001\u3053\u306e\u30af\u30e9\u30b9\u3092\u4f7f\u3046\u7528\u9014\u3068\u3057\u3066\u306f\u983b\u7e41\u306b\u8aad\u307f\u53d6\u308a\u3092\u884c\u3044\u3001\u7a00\u306b\u3057\u304b\u66f8\u304d\u8fbc\u307e\u308c\u306a\u3044\u3068\u3044\u3046\u51e6\u7406\u306b\u4f7f\u3046\u3053\u3068\u304c\u671b\u307e\u3057\u3044\u3002\n\ncontains\u30e1\u30bd\u30c3\u30c9\n\u6307\u5b9a\u3057\u305f\u8981\u7d20\u304c\u30ea\u30b9\u30c8\u306b\u5165\u3063\u3066\u3044\u308c\u3070true\u3092\u8fd4\u3059\u3002\n\nadd\u30e1\u30bd\u30c3\u30c9\n\u6307\u5b9a\u3057\u305f\u8981\u7d20\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\nWeakHashMap\u30af\u30e9\u30b9\n\u30ad\u30fc\u53c2\u7167\u3067\u3042\u308bHashMap\u3092\u57fa\u306b\u4f5c\u3089\u308c\u3066\u304a\u308a\u3001HashMap\u3068\u9055\u3046\u306e\u306f\u30ad\u30fc\u306e\u53c2\u7167\u304c\u6d88\u3048\u308b\u3068\uff08\u4f8b\u3048\u3070\u3001\u5143\u306e\u30ad\u30fc\u306bnull\u3084\u9055\u3046\u5024\u3092\u5165\u308c\u305f\u308a\uff09WeakHashMap\u306b\u5165\u308c\u305f\u5024\u306f\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3063\u305f\u3068\u304d\u306b\u305d\u306e\u5024\u3054\u3068\u6d88\u3057\u3066\u3057\u307e\u3046\u3068\u3044\u3046\u3053\u3068\u3002\u3053\u308c\u304c\u5f31\u30ad\u30fc\u53c2\u7167\u3082\u3057\u304f\u306f\u5f31\u53c2\u7167\u3067\u3042\u308b\u3002\u30ad\u30fc\u53c2\u7167\u306a\u306e\u3067\u5024\u306e\u65b9\u306e\u53c2\u7167\u3092\u306a\u304f\u3057\u3066\u3082\u4f55\u3068\u3082\u306a\u3089\u306a\u3044\u3002\n\u3068\u308a\u3042\u3048\u305aHashMap\u3068WeakHashMap\u306e\u9055\u3044\u3092\u898b\u3066\u307f\u308b\n\u307e\u305a\u306fHashMap\n\nHashMapSample.java\nimport java.util.HashMap;\n\npublic class HashMapSample {\n    static HashMap<String,String> hashmap=new HashMap<String,String>();\n\n    public static void main(String[] args){\n\n        String[] key=new String[5];\n        String[] value=new String[5];\n\n        for(int i=0;i<key.length;i++)\n        {\n            key[i]=\"Key\"+i;\n            value[i]=\"Value\"+i;\n\n            hashmap.put(key[i],value[i]);\n        }\n\n        System.out.println(hashmap);\n        key[1]=null;\n        value[2]=null;\n        System.out.println(\"\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\");\n        System.gc();\n        System.out.println(hashmap);\n    }\n}\n\n\n\u5b9f\u884c\u7d50\u679c\u306f\n{Key2=Value2, Key1=Value1, Key0=Value0, Key4=Value4, Key3=Value3}\n\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n{Key2=Value2, Key1=Value1, Key0=Value0, Key4=Value4, Key3=Value3}\n\n\u3068\u306a\u308a\u3001\u30ad\u30fc\u306e\u53c2\u7167\u3092\u6d88\u3057\u3066\u3082\u305d\u306e\u307e\u307e\u3002\n\u6b21\u306fWeakHashMap\n\nWeakHashMapSample.java\nimport java.util.WeakHashMap;\n\npublic class WeakHashMapSample {\n    static WeakHashMap<String,String> weakhashmap=new WeakHashMap<String,String>();\n\n    public static void main(String[] args){\n\n        String[] key=new String[5];\n        String[] value=new String[5];\n\n        for(int i=0 ;i<key.length;i++)\n        {\n            key[i]=\"Key\"+i;\n            value[i]=\"Value\"+i;\n\n            weakhashmap.put(key[i],value[i]);\n        }\n\n        System.out.println(weakhashmap);\n        key[1]=null;\n        value[2]=null;\n        System.out.println(\"\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\");\n        System.gc();\n        System.out.println(weakhashmap);\n    }\n}\n\n\n\u5b9f\u884c\u7d50\u679c\u306f\n{Key3=Value3, Key4=Value4, Key1=Value1, Key2=Value2, Key0=Value0}\n\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n{Key3=Value3, Key4=Value4, Key2=Value2, Key0=Value0}\n\n\u306e\u3088\u3046\u306b\u53c2\u7167\u3092\u6d88\u3057\u305f\u30ad\u30fc\u306f\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3057\u305f\u3068\u304d\u306b\u5024\u3054\u3068\u6d88\u3048\u3066\u3044\u308b\u3002\n\nkeySet\u30e1\u30bd\u30c3\u30c9\nWeakHashMap\u306e\u3059\u3079\u3066\u306e\u30ad\u30fc\u3092\u8fd4\u3059\u3002\n\nCollections.newSetFromMap\u3068ConcurrentHashMap\u30af\u30e9\u30b9\n\nCollections.newSetFromMap\n\u307e\u305a\u306f\u3001Collections.newSetFromMap\u3002\u3053\u308c\u306f\u7a7a\u306eMap\u304b\u3089\u65b0\u3057\u304f\u751f\u6210\u3055\u308c\u305f\u30ad\u30fc\u3092\u65b0\u3057\u304fSet\u3092\u4f5c\u3063\u3066\u305d\u306eSet\u306b\u30ad\u30fc\u3092\u5165\u308c\u3066\u3044\u304f\u3082\u306e\u3002\u6ce8\u610f\u3057\u3066\u307b\u3057\u3044\u306e\u304c\u3001Set\u306b\u5165\u308c\u3089\u308c\u308b\u8981\u7d20\u304c1\u3064\u3060\u3051\u306a\u306e\u3067\u8981\u7d20\u30922\u3064\u6301\u3064Map\u306fSet\u3068\u5bfe\u5fdc\u3055\u305b\u308b\u305f\u3081\u306b2\u756a\u76ee\u306e\u8981\u7d20\u306fBoolean\u578b\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u4f8b\u3048\u3070\u3001WeakHashMap\u3092\u3084\u3063\u305f\u306e\u3067\u3053\u308c\u3092Set\u306b\n\nCollections_newSetFromMapSample.java\nimport java.util.Collections;\nimport java.util.Set;\nimport java.util.WeakHashMap;\n\npublic class Collections_newSetFromMapSample {\n    static WeakHashMap<String,Boolean> weakhashmap=new WeakHashMap<String,Boolean>();\n    static Set<String> set=Collections.newSetFromMap(weakhashmap);\n\n    public static void main(String[] args) {\n        String[] key=new String[5];\n\n        for(int i=0 ;i<key.length;i++)\n        {\n            key[i]=\"Key\"+i;\n            set.add(key[i]);\n        }\n\n        System.out.println(\"Set is: \"+set);\n        System.out.println(\"Map is: \"+weakhashmap);\n        key[1]=null;\n        System.out.println(\"\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\");\n        System.gc();\n        System.out.println(\"Set is: \"+set);\n        System.out.println(\"Map is: \"+weakhashmap);\n    }\n}\n\n\n\u5b9f\u884c\u7d50\u679c\nSet is: [Key3, Key4, Key1, Key2, Key0]\nMap is: {Key3=true, Key4=true, Key1=true, Key2=true, Key0=true}\n\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\nSet is: [Key3, Key4, Key2, Key0]\nMap is: {Key3=true, Key4=true, Key2=true, Key0=true}\n\n\u3061\u3083\u3093\u3068\u30ad\u30fc\u304cSet\u306b\u5165\u308c\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\uff08Map\u306e\u7b2c2\u8981\u7d20\u306b\u306a\u305ctrue\u304c\u5165\u308c\u3089\u308c\u308b\u306e\u304b\u4e0d\u660e\u306a\u306e\u3067\u77e5\u3063\u3066\u3044\u308b\u65b9\u304c\u3044\u308c\u3070\u6559\u3048\u3066\u304f\u3060\u3055\u3044\uff09\u3002\u3082\u3061\u308d\u3093\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3067\u53c2\u7167\u3055\u308c\u306a\u3044\u30ad\u30fc\u3092\u6392\u9664\u3057\u305f\u306e\u3067\u305d\u306e\u90e8\u5206\u306f\u6d88\u3048\u3066\u3044\u308b\u3002\n\nConcurrentHashMap\u30af\u30e9\u30b9\nHashTable\u306e\u6a5f\u80fd\u6027\u3092\u6301\u3064HashMap\u3002\u4ed6\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u50cd\u3044\u3066\u3044\u308b\u3068\u304d\u306f\u81ea\u52d5\u7684\u306b\u540c\u671f\u3057\u3066\u3001\u3055\u3089\u306b\u305d\u306e\u52d5\u6a5f\u6642\u9593\u3092\u304b\u306a\u308a\u77ed\u7e2e\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\u305f\u3060\u3057\u3001\u4ed6\u306eHashMap\u3068\u9055\u3044\u3001null\u3092\u30ad\u30fc\u3082\u3057\u304f\u306f\u5024\u306b\u5165\u308c\u3066\u3057\u307e\u3046\u3068NullPointerException\u304c\u767a\u751f\u3059\u308b\u3002\n\u5b9f\u969b\u306bnull\u3092\u5165\u308c\u3066\u307f\u308b\n\nConcurrentHashMapSample.java\nimport java.util.concurrent.ConcurrentHashMap;\n\npublic class ConcurrentHashMapSample {\n    static ConcurrentHashMap<String,String> concurrenthashmap=new ConcurrentHashMap<String,String>();\n\n    public static void main(String[] args) {\n        String[] key=new String[5];\n        String[] value=new String[5];\n\n        for(int i=0 ;i<key.length;i++)\n        {\n            key[i]=\"Key\"+i;\n            value[i]=\"Value\"+i;\n\n            concurrenthashmap.put(key[i],value[i]);\n        }\n\n        System.out.println(concurrenthashmap);\n\n        key[1]=null;\n        concurrenthashmap.put(key[1],value[1]);\n        System.out.println(concurrenthashmap);\n    }\n}\n\n\n\u3092\u5b9f\u884c\u3059\u308b\u3068\n{Key2=Value2, Key1=Value1, Key0=Value0, Key4=Value4, Key3=Value3}\nException in thread \"main\" java.lang.NullPointerException\n    at java.util.concurrent.ConcurrentHashMap.putVal(ConcurrentHashMap.java:1011)\n    at java.util.concurrent.ConcurrentHashMap.put(ConcurrentHashMap.java:1006)\n    at ConcurrentHashMapSample.main(ConcurrentHashMapSample.java:22)\n\n\u306e\u3088\u3046\u306b\u5b9f\u969b\u306bNullPointerException\u304c\u767a\u751f\u3059\u308b\u3002\n\nclear\u30e1\u30bd\u30c3\u30c9\nConcurrentHashMap\u5185\u306eMap\u3092\u5168\u3066\u524a\u9664\u3059\u308b\u3002\n\n\u304a\u308f\u308a\n\u306a\u306b\u304b\u610f\u898b\u3084\u8a02\u6b63\u70b9\u304c\u3042\u308c\u3070\u6c17\u8efd\u306b\u304f\u3060\u3055\u3044\u3002\nHadoop\u306e\u52c9\u5f37\u3092\u3057\u3066\u3044\u308b\u3068\u304d\u306b\u51fa\u304f\u308f\u3057\u3066\u305d\u306e\u6642\u306e\u30e1\u30e2\u3002\n\n## CopyOnWriteArrayList\u30af\u30e9\u30b9\nHashtable\u3084HashMap\u306e\u554f\u984c\u3092\u89e3\u6c7a\u3057\u305f\uff08\uff1f\uff09\u30af\u30e9\u30b9\u3002\n\u914d\u5217\u3092\u65b0\u898f\u306b\u30b3\u30d4\u30fc\u3057\u3066ArrayList\u3067ConcurrentModificationException\u304c\u8d77\u3053\u308b\u4f8b\u5916\u3092\u8d77\u3053\u3055\u305a\u306b\u51e6\u7406\u3057\u3066\u304f\u308c\u308b\u3068\u304b\u3002\n\n\u4f8b\u3048\u3070\u3001\nArrayList\u306eConcurrentModificationException\u767a\u751f\u3055\u305b\u305f\u4f8b\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u308b\n\n```java:ArrayListSample.java\nimport java.util.ArrayList;\n\npublic class ArrayListSample{\n\tprivate static ArrayList<String> arraylist = new ArrayList<String>();\n\t \n\tpublic static void main(String[] args) {\t \n\t\t//\u8981\u7d20\u8ffd\u52a0\n\t    for(int i = 0; i < 10000; i++)\n\t    {\n\t    \tarraylist.add(\"ArrayList\" + i);\n\t    }\n\t    \n\t    //\u5225\u30b9\u30ec\u30c3\u30c9\u3067\u30ea\u30b9\u30c8\u3092\u8d70\u67fb\u3059\u308b\n\t    Thread th = new Thread(new Runnable(){\n\t            @Override\n\t            public void run(){\n\t            \tfor(String h : arraylist)\n\t            \t{\n\t            \t\tarraylist.remove(h);  //ConcurrentModificationException\u767a\u751f\u3002\n\t            \t}\n\t            }\n\t    });\n\t    \n\t    th.start();\n\t \n\t    //\u64cd\u4f5c\u4e2d\u306b\u524a\u9664\n\t    arraylist.remove(\"ArrayList0\");\n\t    System.out.println(\"\u524a\u9664\u5b8c\u4e86\");\n\t }\n}\n```\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\n\n```\n\u524a\u9664\u5b8c\u4e86\nException in thread \"Thread-0\" java.util.ConcurrentModificationException\n\tat java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901)\n\tat java.util.ArrayList$Itr.next(ArrayList.java:851)\n\tat ArrayListSample$1.run(ArrayListSample.java:19)\n\tat java.lang.Thread.run(Thread.java:745)\n```\n\n\u3053\u308c\u306f\u3001\u30ea\u30b9\u30c8\u3092\u540c\u671f\u305b\u305a\u30a4\u30c6\u30ec\u30fc\u30bf\u52d5\u4f5c\u4e2d\u306b\u4ed6\u306e\u30b9\u30ec\u30c3\u30c9\u3067\u5909\u66f4\u3092\u304b\u3051\u305f\u305f\u3081\u306b\u8d77\u304d\u305f\u3002\n\u8981\u306f\u540c\u671f\u3057\u308d\u3068\u3044\u3046\u3053\u3068\u3067synchronized\u3084Collections.synchronizedList\u3092\u4f7f\u3048\u3070\u76f4\u308b\u3068\u601d\u3063\u305f\u304c\u3001\u76f4\u3089\u306a\u3044\u3002\n\n\u3060\u304c\u3001\u3053\u308c\u306fArrayList\u306e\u6240\u3092CopyOnWriteArrayList\u3068\u5909\u3048\u308b\u3060\u3051\u3067\u89e3\u6c7a\u3067\u304d\u3066\u3057\u307e\u3063\u305f\u3002\n\n```java:CopyOnWriteArrayListSample.java\nimport java.util.concurrent.CopyOnWriteArrayList;\n\npublic class CopyOnWriteArrayListSample{\n\tprivate static CopyOnWriteArrayList<String> copyonwritearraylist = new CopyOnWriteArrayList<String>();\n\t \n\tpublic static void main(String[] args) {\t \n\t\t//\u8981\u7d20\u8ffd\u52a0\n\t    for(int i = 0; i < 10000; i++)\n\t    {\n\t    \tcopyonwritearraylist.add(\"ArrayList\" + i);\n\t    }\n\t    \n\t    //\u5225\u30b9\u30ec\u30c3\u30c9\u3067\u30ea\u30b9\u30c8\u3092\u8d70\u67fb\u3059\u308b\n\t    Thread th = new Thread(new Runnable(){\n\t            @Override\n\t            public void run(){\n\t            \tfor(String h : copyonwritearraylist)\n\t            \t{\n\t            \t\tcopyonwritearraylist.remove(h);\n\t            \t}\n\t            }\n\t    });\n\t    \n\t    th.start();\n\t    \n\t    //\u64cd\u4f5c\u4e2d\u306b\u524a\u9664\n\t    arrayList.remove(\"copyonwritearraylist0\");\n\t    System.out.println(\"\u524a\u9664\u5b8c\u4e86\");\n\t }\n}\n```\n\n\u3053\u308c\u3092\u5b9f\u884c\u3059\u308b\u3068\u6b21\u306e\u3088\u3046\u306b\u306a\u308b\n\n```\n\u524a\u9664\u5b8c\u4e86\n```\n\n\u3053\u308c\u306f\u6700\u521d\u306b\u8a18\u8ff0\u3057\u305f\u3088\u3046\u306b\u3001\u307e\u305a\u914d\u5217\u3092\u65b0\u898f\u306b\u307e\u308b\u307e\u308b\u30b3\u30d4\u30fc\u3057\u3066\u30b3\u30d4\u30fc\u3057\u305f\u914d\u5217\u3067\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u3001ConcurrentModificationException\u304c\u8d77\u304d\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3002synchronized\u7b49\u3092\u4f7f\u3046\u3068\u3001\u540c\u3058\u914d\u5217\u4e2d\u3067\u51e6\u7406\u3092\u884c\u3063\u3066\u52d5\u4f5c\u3059\u308b\u305f\u3081\u3053\u306e\u3088\u3046\u306a\u3053\u3068\u3092\u89e3\u6c7a\u3067\u304d\u306a\u304b\u3063\u305f\u3002\u306a\u306e\u3067\u4e26\u884c\u3057\u3066\u914d\u5217\u306e\u51e6\u7406\u3092\u3059\u308b\u3068\u304d\u306fCopyOnWriteArrayList\u3092\u4f7f\u3046\u3053\u3068\u304c\u30aa\u30b9\u30b9\u30e1\u3002\u3060\u304c\u3053\u308c\u306b\u3082\u6b20\u70b9\u304c\u3042\u308a\u3001\u305d\u308c\u306f\u666e\u901a\u306bArrayList\u3067\u51e6\u7406\u3092\u3059\u308b\u3088\u308a\u51e6\u7406\u306b\u6642\u9593\u304c\u304b\u306a\u308a\u304b\u304b\u308b\u3068\u3044\u3046\u3053\u3068\u3002\u3060\u304b\u3089\u3001\u3053\u306e\u30af\u30e9\u30b9\u3092\u4f7f\u3046\u7528\u9014\u3068\u3057\u3066\u306f\u983b\u7e41\u306b\u8aad\u307f\u53d6\u308a\u3092\u884c\u3044\u3001\u7a00\u306b\u3057\u304b\u66f8\u304d\u8fbc\u307e\u308c\u306a\u3044\u3068\u3044\u3046\u51e6\u7406\u306b\u4f7f\u3046\u3053\u3068\u304c\u671b\u307e\u3057\u3044\u3002\n\n### contains\u30e1\u30bd\u30c3\u30c9\n\u6307\u5b9a\u3057\u305f\u8981\u7d20\u304c\u30ea\u30b9\u30c8\u306b\u5165\u3063\u3066\u3044\u308c\u3070true\u3092\u8fd4\u3059\u3002\n\n### add\u30e1\u30bd\u30c3\u30c9\n\u6307\u5b9a\u3057\u305f\u8981\u7d20\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n## WeakHashMap\u30af\u30e9\u30b9\n\u30ad\u30fc\u53c2\u7167\u3067\u3042\u308bHashMap\u3092\u57fa\u306b\u4f5c\u3089\u308c\u3066\u304a\u308a\u3001HashMap\u3068\u9055\u3046\u306e\u306f\u30ad\u30fc\u306e\u53c2\u7167\u304c\u6d88\u3048\u308b\u3068\uff08\u4f8b\u3048\u3070\u3001\u5143\u306e\u30ad\u30fc\u306bnull\u3084\u9055\u3046\u5024\u3092\u5165\u308c\u305f\u308a\uff09WeakHashMap\u306b\u5165\u308c\u305f\u5024\u306f\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u884c\u3063\u305f\u3068\u304d\u306b\u305d\u306e\u5024\u3054\u3068\u6d88\u3057\u3066\u3057\u307e\u3046\u3068\u3044\u3046\u3053\u3068\u3002\u3053\u308c\u304c\u5f31\u30ad\u30fc\u53c2\u7167\u3082\u3057\u304f\u306f\u5f31\u53c2\u7167\u3067\u3042\u308b\u3002\u30ad\u30fc\u53c2\u7167\u306a\u306e\u3067\u5024\u306e\u65b9\u306e\u53c2\u7167\u3092\u306a\u304f\u3057\u3066\u3082\u4f55\u3068\u3082\u306a\u3089\u306a\u3044\u3002\n\n\u3068\u308a\u3042\u3048\u305aHashMap\u3068WeakHashMap\u306e\u9055\u3044\u3092\u898b\u3066\u307f\u308b\n\u307e\u305a\u306fHashMap\n\n```java:HashMapSample.java\nimport java.util.HashMap;\n\npublic class HashMapSample {\n\tstatic HashMap<String,String> hashmap=new HashMap<String,String>();\n\t\n\tpublic static void main(String[] args){\n\t\t\n\t\tString[] key=new String[5];\n\t\tString[] value=new String[5];\n\t\t\n\t\tfor(int i=0;i<key.length;i++)\n\t\t{\n\t\t\tkey[i]=\"Key\"+i;\n\t\t\tvalue[i]=\"Value\"+i;\n\t\t\t\n\t\t\thashmap.put(key[i],value[i]);\n\t\t}\n\t\t\n\t\tSystem.out.println(hashmap);\n\t\tkey[1]=null;\n\t\tvalue[2]=null;\n\t\tSystem.out.println(\"\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\");\n\t\tSystem.gc();\n\t\tSystem.out.println(hashmap);\n\t}\n}\n```\n\n\u5b9f\u884c\u7d50\u679c\u306f\n\n```\n{Key2=Value2, Key1=Value1, Key0=Value0, Key4=Value4, Key3=Value3}\n\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n{Key2=Value2, Key1=Value1, Key0=Value0, Key4=Value4, Key3=Value3}\n```\n\n\u3068\u306a\u308a\u3001\u30ad\u30fc\u306e\u53c2\u7167\u3092\u6d88\u3057\u3066\u3082\u305d\u306e\u307e\u307e\u3002\n\u6b21\u306fWeakHashMap\n\n```java:WeakHashMapSample.java\nimport java.util.WeakHashMap;\n\npublic class WeakHashMapSample {\n\tstatic WeakHashMap<String,String> weakhashmap=new WeakHashMap<String,String>();\n\t\n\tpublic static void main(String[] args){\n\t\t\n\t\tString[] key=new String[5];\n\t\tString[] value=new String[5];\n\t\t\n\t\tfor(int i=0 ;i<key.length;i++)\n\t\t{\n\t\t\tkey[i]=\"Key\"+i;\n\t\t\tvalue[i]=\"Value\"+i;\n\t\t\t\n\t\t\tweakhashmap.put(key[i],value[i]);\n\t\t}\n\t\t\n\t\tSystem.out.println(weakhashmap);\n\t\tkey[1]=null;\n\t\tvalue[2]=null;\n\t\tSystem.out.println(\"\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\");\n\t\tSystem.gc();\n\t\tSystem.out.println(weakhashmap);\n\t}\n}\n```\n\n\u5b9f\u884c\u7d50\u679c\u306f\n\n```\n{Key3=Value3, Key4=Value4, Key1=Value1, Key2=Value2, Key0=Value0}\n\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\n{Key3=Value3, Key4=Value4, Key2=Value2, Key0=Value0}\n```\n\n\u306e\u3088\u3046\u306b\u53c2\u7167\u3092\u6d88\u3057\u305f\u30ad\u30fc\u306f\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3057\u305f\u3068\u304d\u306b\u5024\u3054\u3068\u6d88\u3048\u3066\u3044\u308b\u3002\n\n### keySet\u30e1\u30bd\u30c3\u30c9\nWeakHashMap\u306e\u3059\u3079\u3066\u306e\u30ad\u30fc\u3092\u8fd4\u3059\u3002\n\n## Collections.newSetFromMap\u3068ConcurrentHashMap\u30af\u30e9\u30b9\n### Collections.newSetFromMap\n\u307e\u305a\u306f\u3001Collections.newSetFromMap\u3002\u3053\u308c\u306f\u7a7a\u306eMap\u304b\u3089\u65b0\u3057\u304f\u751f\u6210\u3055\u308c\u305f\u30ad\u30fc\u3092\u65b0\u3057\u304fSet\u3092\u4f5c\u3063\u3066\u305d\u306eSet\u306b\u30ad\u30fc\u3092\u5165\u308c\u3066\u3044\u304f\u3082\u306e\u3002\u6ce8\u610f\u3057\u3066\u307b\u3057\u3044\u306e\u304c\u3001Set\u306b\u5165\u308c\u3089\u308c\u308b\u8981\u7d20\u304c1\u3064\u3060\u3051\u306a\u306e\u3067\u8981\u7d20\u30922\u3064\u6301\u3064Map\u306fSet\u3068\u5bfe\u5fdc\u3055\u305b\u308b\u305f\u3081\u306b2\u756a\u76ee\u306e\u8981\u7d20\u306fBoolean\u578b\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n\u4f8b\u3048\u3070\u3001WeakHashMap\u3092\u3084\u3063\u305f\u306e\u3067\u3053\u308c\u3092Set\u306b\n\n```java:Collections_newSetFromMapSample.java\nimport java.util.Collections;\nimport java.util.Set;\nimport java.util.WeakHashMap;\n\npublic class Collections_newSetFromMapSample {\n\tstatic WeakHashMap<String,Boolean> weakhashmap=new WeakHashMap<String,Boolean>();\n\tstatic Set<String> set=Collections.newSetFromMap(weakhashmap);\n\t\n\tpublic static void main(String[] args) {\n\t\tString[] key=new String[5];\n\t\t\n\t\tfor(int i=0 ;i<key.length;i++)\n\t\t{\n\t\t\tkey[i]=\"Key\"+i;\n\t\t\tset.add(key[i]);\n\t\t}\n\t\t\n\t\tSystem.out.println(\"Set is: \"+set);\n\t\tSystem.out.println(\"Map is: \"+weakhashmap);\n\t\tkey[1]=null;\n\t\tSystem.out.println(\"\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\");\n\t\tSystem.gc();\n\t\tSystem.out.println(\"Set is: \"+set);\n\t\tSystem.out.println(\"Map is: \"+weakhashmap);\n\t}\n}\n```\n\n\u5b9f\u884c\u7d50\u679c\n\n```\nSet is: [Key3, Key4, Key1, Key2, Key0]\nMap is: {Key3=true, Key4=true, Key1=true, Key2=true, Key0=true}\n\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\nSet is: [Key3, Key4, Key2, Key0]\nMap is: {Key3=true, Key4=true, Key2=true, Key0=true}\n```\n\n\u3061\u3083\u3093\u3068\u30ad\u30fc\u304cSet\u306b\u5165\u308c\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u308b\uff08Map\u306e\u7b2c2\u8981\u7d20\u306b\u306a\u305ctrue\u304c\u5165\u308c\u3089\u308c\u308b\u306e\u304b\u4e0d\u660e\u306a\u306e\u3067\u77e5\u3063\u3066\u3044\u308b\u65b9\u304c\u3044\u308c\u3070\u6559\u3048\u3066\u304f\u3060\u3055\u3044\uff09\u3002\u3082\u3061\u308d\u3093\u30ac\u30fc\u30d9\u30b8\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3067\u53c2\u7167\u3055\u308c\u306a\u3044\u30ad\u30fc\u3092\u6392\u9664\u3057\u305f\u306e\u3067\u305d\u306e\u90e8\u5206\u306f\u6d88\u3048\u3066\u3044\u308b\u3002\n\n### ConcurrentHashMap\u30af\u30e9\u30b9\nHashTable\u306e\u6a5f\u80fd\u6027\u3092\u6301\u3064HashMap\u3002\u4ed6\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u50cd\u3044\u3066\u3044\u308b\u3068\u304d\u306f\u81ea\u52d5\u7684\u306b\u540c\u671f\u3057\u3066\u3001\u3055\u3089\u306b\u305d\u306e\u52d5\u6a5f\u6642\u9593\u3092\u304b\u306a\u308a\u77ed\u7e2e\u3057\u3066\u304f\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\u305f\u3060\u3057\u3001\u4ed6\u306eHashMap\u3068\u9055\u3044\u3001null\u3092\u30ad\u30fc\u3082\u3057\u304f\u306f\u5024\u306b\u5165\u308c\u3066\u3057\u307e\u3046\u3068NullPointerException\u304c\u767a\u751f\u3059\u308b\u3002\n\n\u5b9f\u969b\u306bnull\u3092\u5165\u308c\u3066\u307f\u308b\n\n```java:ConcurrentHashMapSample.java\nimport java.util.concurrent.ConcurrentHashMap;\n\npublic class ConcurrentHashMapSample {\n\tstatic ConcurrentHashMap<String,String> concurrenthashmap=new ConcurrentHashMap<String,String>();\n\t\n\tpublic static void main(String[] args) {\n\t\tString[] key=new String[5];\n\t\tString[] value=new String[5];\n\t\t\n\t\tfor(int i=0 ;i<key.length;i++)\n\t\t{\n\t\t\tkey[i]=\"Key\"+i;\n\t\t\tvalue[i]=\"Value\"+i;\n\t\t\t\n\t\t\tconcurrenthashmap.put(key[i],value[i]);\n\t\t}\n\t\t\n\t\tSystem.out.println(concurrenthashmap);\n\t\t\n\t\tkey[1]=null;\n\t\tconcurrenthashmap.put(key[1],value[1]);\n\t\tSystem.out.println(concurrenthashmap);\n\t}\n}\n```\n\n\u3092\u5b9f\u884c\u3059\u308b\u3068\n\n```\n{Key2=Value2, Key1=Value1, Key0=Value0, Key4=Value4, Key3=Value3}\nException in thread \"main\" java.lang.NullPointerException\n\tat java.util.concurrent.ConcurrentHashMap.putVal(ConcurrentHashMap.java:1011)\n\tat java.util.concurrent.ConcurrentHashMap.put(ConcurrentHashMap.java:1006)\n\tat ConcurrentHashMapSample.main(ConcurrentHashMapSample.java:22)\n```\n\n\u306e\u3088\u3046\u306b\u5b9f\u969b\u306bNullPointerException\u304c\u767a\u751f\u3059\u308b\u3002\n\n#### clear\u30e1\u30bd\u30c3\u30c9\nConcurrentHashMap\u5185\u306eMap\u3092\u5168\u3066\u524a\u9664\u3059\u308b\u3002\n\n## \u304a\u308f\u308a\n\u306a\u306b\u304b\u610f\u898b\u3084\u8a02\u6b63\u70b9\u304c\u3042\u308c\u3070\u6c17\u8efd\u306b\u304f\u3060\u3055\u3044\u3002\n", "tags": ["Java", "\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9"]}