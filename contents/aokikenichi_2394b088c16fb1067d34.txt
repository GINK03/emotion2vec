{"tags": ["\u6642\u7cfb\u5217\u89e3\u6790", "R"], "context": "\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\n\n\u306e\u7ae0\u672b\u554f\u984c\u3067\u300c\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3092\u7528\u3044\u3066\u300d\u3068\u3042\u308b\u3082\u306e\u3092R\u3067\u89e3\u3044\u3066\u3044\u307e\u3059\u3002\n* \u30b5\u30dd\u30fc\u30c8\u30b5\u30a4\u30c8\uff08\u30c7\u30fc\u30bf\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\uff09\n\n2.5\n\n(1)\n\nlibrary(forecast)\n\ndata<-read.table(\"economicdata.txt\",header=T)\nar4<-Arima(diff(log(data$indprod))*100, order=c(4, 0, 0))\nma3<-Arima(diff(log(data$indprod))*100, order=c(0, 0, 3))\narma1_1<-Arima(diff(log(data$indprod))*100, order=c(1, 0, 1))\narma2_1<-Arima(diff(log(data$indprod))*100, order=c(2, 0, 1))\narma1_2<-Arima(diff(log(data$indprod))*100, order=c(1, 0, 2))\narma2_2<-Arima(diff(log(data$indprod))*100, order=c(2, 0, 2))\n\nname<-c('AR(4)', 'MA(3)', 'ARMA(1,1)', 'ARMA(2,1)', 'ARMA(1,2)', 'ARMA(2,2)')\naic<-c(\n  AIC(ar4)/length(data$indprod),\n  AIC(ma3)/length(data$indprod),\n  AIC(arma1_1)/length(data$indprod),\n  AIC(arma2_1)/length(data$indprod),\n  AIC(arma1_2)/length(data$indprod),\n  AIC(arma2_2)/length(data$indprod)\n)\nbic<-c(\n  BIC(ar4)/length(data$indprod),\n  BIC(ma3)/length(data$indprod),\n  BIC(arma1_1)/length(data$indprod),\n  BIC(arma2_1)/length(data$indprod),\n  BIC(arma1_2)/length(data$indprod),\n  BIC(arma2_2)/length(data$indprod)\n)\nout<-data.frame(matrix(aic, nrow=1))\nout<-rbind(out, bic)\ncolnames(out)<-name\nrownames(out)<-c('AIC', 'SIC')\nout\n\n       AR(4)    MA(3) ARMA(1,1) ARMA(2,1) ARMA(1,2) ARMA(2,2)\nAIC 3.232032 3.239599  3.324956  3.277746  3.233284  3.246579\nSIC 3.296225 3.293094  3.367752  3.331241  3.286779  3.310772\n\n## figure\npar(mfrow = c(2, 2))\npar(mar = c(2, 2, 1, 1))\nacf(diff(log(data$indprod)), xlim=c(1, 20), ylim=c(-0.5, 0.5))\nmtext(text = '\u6a19\u672c\u81ea\u5df1\u76f8\u95a2', side = 3)\npacf(diff(log(data$indprod)), xlim=c(1, 20), ylim=c(-0.5, 0.5))\nmtext(text = '\u6a19\u672c\u504f\u81ea\u5df1\u76f8\u95a2')\nacf(ar4$residuals, xlim=c(1, 20), ylim=c(-0.5, 0.5))\nmtext(text = 'AR(4)\u30e2\u30c7\u30eb\u306e\u6b8b\u5dee\u306e\u8a3a\u65ad', side = 3)\nacf(arma1_2$residuals, xlim=c(1, 20), ylim=c(-0.5, 0.5))\nmtext(text = 'ARMA(1,2)\u30e2\u30c7\u30eb\u306e\u6b8b\u5dee\u306e\u8a3a\u65ad', side = 3)\n\n\n\n(2)\n\nlibrary(forecast)\n\ndata<-read.table(\"economicdata.txt\",header=T)\nar4<-Arima(diff(log(data$indprod))*100, order=c(4, 0, 0))\narma1_2<-Arima(diff(log(data$indprod))*100, order=c(1, 0, 2))\n\nAR(4)\nBox.test(ar4$residuals[1:10], type=\"Ljung\")\n\n    Box-Ljung test\n\ndata:  ar4$residuals[1:10]\nX-squared = 0.37762, df = 1, p-value = 0.5389\n\np>0.05\u3088\u308a\u5e30\u7121\u4eee\u8aac\u3092\u68c4\u5374\u3067\u304d\u306a\u3044\u306e\u3067\u81ea\u5df1\u76f8\u95a2\u304c\u3042\u308b\u3068\u306f\u8a00\u3048\u306a\u3044\u3002\nARMA(1, 2)\nBox.test(arma1_2$residuals[1:10], type=\"Ljung\")\n\n    Box-Ljung test\n\ndata:  arma1_2$residuals[1:10]\nX-squared = 0.37971, df = 1, p-value = 0.5378\n\np>0.05\u3088\u308a\u5e30\u7121\u4eee\u8aac\u3092\u68c4\u5374\u3067\u304d\u306a\u3044\u306e\u3067\u81ea\u5df1\u76f8\u95a2\u304c\u3042\u308b\u3068\u306f\u8a00\u3048\u306a\u3044\u3002\n\n2.6\nlibrary(forecast)\ndata<-read.table(\"arma.txt\", header=T)\n\n\n(1)\n\npar(mfrow=c(2, 1))\nacf(data$y1, xlim=c(1, 20))\nmtext('\u6a19\u672c\u81ea\u5df1\u76f8\u95a2', side = 3)\npacf(data$y1, xlim=c(1, 20))\nmtext('\u6a19\u672c\u504f\u81ea\u5df1\u76f8\u95a2', side = 3)\n\n\n\n(2), (3)\n\n###AR(2)\n###ARMA(1,1),ARMA(2,1),ARMA(1,2),ARMA(2,2)\nar2<-Arima(data$y1, order=c(2, 0, 0))\narma1_1<-Arima(data$y1, order=c(1, 0, 1))\narma2_1<-Arima(data$y1, order=c(2, 0, 1))\narma1_2<-Arima(data$y1, order=c(1, 0, 2))\narma2_2<-Arima(data$y1, order=c(2, 0, 2))\n\nname<-c('AR(2)', 'ARMA(1,1)', 'ARMA(2,1)', 'ARMA(1,2)', 'ARMA(2,2)')\naic<-c(\n  AIC(ar2)/length(data$y1),\n  AIC(arma1_1)/length(data$y1),\n  AIC(arma2_1)/length(data$y1),\n  AIC(arma1_2)/length(data$y1),\n  AIC(arma2_2)/length(data$y1)\n)\nbic<-c(\n  BIC(ar2)/length(data$y1),\n  BIC(arma1_1)/length(data$y1),\n  BIC(arma2_1)/length(data$y1),\n  BIC(arma1_2)/length(data$y1),\n  BIC(arma2_2)/length(data$y1)\n)\nout<-data.frame(matrix(aic, nrow=1))\nout<-rbind(out, bic)\ncolnames(out)<-name\nrownames(out)<-c('AIC', 'SIC')\n###AIC ARMA(2,1), SIC AR(2)\nout\n\n       AR(2) ARMA(1,1) ARMA(2,1) ARMA(1,2) ARMA(2,2)\nAIC 3.023947  3.034293  3.021437  3.029152  3.027627\nSIC 3.073331  3.083677  3.083167  3.090882  3.101703\n\n\n(4)\n\nAIC\u304b\u3089\u306fARMA(2,1)\u3001SIC\u304b\u3089\u306fAR(2)\u3092\u9078\u629e\u3057\u305f\u3002\nacf(arma2_1$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\nacf(ar2$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\n\n\nBox.test(arma2_1$residuals[1:20], type=\"Ljung\")\n\n    Box-Ljung test\n\ndata:  arma2_1$residuals[1:20]\nX-squared = 0.013201, df = 1, p-value = 0.9085\n\nBox.test(ar2$residuals[1:20], type=\"Ljung\")\n\n    Box-Ljung test\n\ndata:  ar2$residuals[1:20]\nX-squared = 0.0979, df = 1, p-value = 0.7544\n\n\n(5)\n\ny2\nacf(data$y2, xlim = c(1, 20), ylim = c(-0.5, 0.5))\nmtext(text = 'y2 \u6a19\u672c\u81ea\u5df1\u76f8\u95a2', side = 3)\npacf(data$y2, xlim = c(1, 20), ylim = c(-0.5, 0.5))\nmtext(text = 'y2 \u6a19\u672c\u504f\u81ea\u5df1\u76f8\u95a2', side = 3)\n\n\n####MA(3)\n####ARMA(1,1),ARMA(2,1),ARMA(1,2),ARMA(2,2)\nma3<-Arima(data$y2, order=c(0, 0, 3))\narma1_1<-Arima(data$y2, order=c(1, 0, 1))\narma2_1<-Arima(data$y2, order=c(2, 0, 1))\narma1_2<-Arima(data$y2, order=c(1, 0, 2))\narma2_2<-Arima(data$y2, order=c(2, 0, 2))\n\nname<-c('MA(3)', 'ARMA(1,1)', 'ARMA(2,1)', 'ARMA(1,2)', 'ARMA(2,2)')\naic<-c(\n  AIC(ma3)/length(data$y2),\n  AIC(arma1_1)/length(data$y2),\n  AIC(arma2_1)/length(data$y2),\n  AIC(arma1_2)/length(data$y2),\n  AIC(arma2_2)/length(data$y2)\n)\nbic<-c(\n  BIC(ma3)/length(data$y2),\n  BIC(arma1_1)/length(data$y2),\n  BIC(arma2_1)/length(data$y2),\n  BIC(arma1_2)/length(data$y2),\n  BIC(arma2_2)/length(data$y2)\n)\nout<-data.frame(matrix(aic, nrow=1))\nout<-rbind(out, bic)\ncolnames(out)<-name\nrownames(out)<-c('AIC', 'SIC')\n###AIC MA(3), SIC MA(3)\nout\n\n       MA(3) ARMA(1,1) ARMA(2,1) ARMA(1,2) ARMA(2,2)\nAIC 2.769046  2.859515  2.775498  2.818165  2.781784\nSIC 2.830775  2.908899  2.837228  2.879895  2.855860\n\npar(mfrow = c(1, 1))\nacf(ma3$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\n\n\nBox.test(ma3$residuals[1:20], type=\"Ljung\")\n\n    Box-Ljung test\n\ndata:  ma3$residuals[1:20]\nX-squared = 0.0066437, df = 1, p-value = 0.935\n\ny3\n###y3\npar(mfrow=c(2,1))\nacf(data$y3, xlim=c(1, 20))\nmtext(text = 'y3 \u6a19\u672c\u81ea\u5df1\u76f8\u95a2', side = 3)\npacf(data$y3, xlim=c(1, 20))\nmtext(text = 'y3 \u6a19\u672c\u504f\u81ea\u5df1\u76f8\u95a2', side = 3)\n\n\n####AR(8), MA(7)\n####ARMA(1,1),ARMA(2,1),ARMA(1,2),ARMA(2,2)\nar8<-Arima(data$y3, order=c(8, 0, 0))\nma7<-Arima(data$y3, order=c(0, 0, 7))\narma1_1<-Arima(data$y3, order=c(1, 0, 1))\narma2_1<-Arima(data$y3, order=c(2, 0, 1))\narma1_2<-Arima(data$y3, order=c(1, 0, 2))\narma2_2<-Arima(data$y3, order=c(2, 0, 2))\n\nname<-c('AR(8)', 'MA(7)', 'ARMA(1,1)', 'ARMA(2,1)', 'ARMA(1,2)', 'ARMA(2,2)')\naic<-c(\n  AIC(ar8)/length(data$y3),\n  AIC(ma7)/length(data$y3),\n  AIC(arma1_1)/length(data$y3),\n  AIC(arma2_1)/length(data$y3),\n  AIC(arma1_2)/length(data$y3),\n  AIC(arma2_2)/length(data$y3)\n)\nbic<-c(\n  BIC(ar8)/length(data$y3),\n  BIC(ma7)/length(data$y3),\n  BIC(arma1_1)/length(data$y3),\n  BIC(arma2_1)/length(data$y3),\n  BIC(arma1_2)/length(data$y3),\n  BIC(arma2_2)/length(data$y3)\n)\nout<-data.frame(matrix(aic, nrow=1))\nout<-rbind(out, bic)\ncolnames(out)<-name\nrownames(out)<-c('AIC', 'SIC')\n###AIC ARMA(1,2), SIC ARMA(1,1)\nout\n\n       AR(8)    MA(7) ARMA(1,1) ARMA(2,1) ARMA(1,2) ARMA(2,2)\nAIC 3.115248 3.082550  3.069798   3.06590  3.065178  3.071635\nSIC 3.238708 3.193663  3.119182   3.12763  3.126907  3.145711\n\npar(mfrow = c(1, 1))\nacf(arma1_2$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\nmtext(text = 'ARMA(1,2)\u30e2\u30c7\u30eb\u306e\u6b8b\u5dee\u306e\u8a3a\u65ad', side = 3)\n\n\nBox.test(arma1_2$residuals[1:20], type=\"Ljung\")\n\n    Box-Ljung test\n\ndata:  arma1_2$residuals[1:20]\nX-squared = 0.17219, df = 1, p-value = 0.6782\n\nacf(arma1_1$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\nmtext(text = 'ARMA(1,1)\u30e2\u30c7\u30eb\u306e\u6b8b\u5dee\u306e\u8a3a\u65ad', side = 3)\n\n\nBox.test(arma1_1$residuals[1:20], type=\"Ljung\")\n\n    Box-Ljung test\n\ndata:  arma1_1$residuals[1:20]\nX-squared = 6.0017e-05, df = 1, p-value = 0.9938\n\n\u21d2 3\u7ae0\u306f\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u7528\u3044\u308b\u7ae0\u672b\u554f\u984c\u304c\u306a\u3044\u306e\u3067\u3001\u6b21\u306f \u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\u7ae0\u672b\u554f\u984c\u3092R\u3067\u89e3\u304f\uff0d\u7b2c4\u7ae0VAR\u30e2\u30c7\u30eb\uff0d \u3078\n<a href=\"https://www.amazon.co.jp/%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90-%E7%B5%B1%E8%A8%88%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%83%BC-%E6%B2%96%E6%9C%AC-%E7%AB%9C%E7%BE%A9/dp/4254127928/ref=as_li_ss_tl?ie=UTF8&qid=1478165293&sr=8-1&keywords=%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90&linkCode=ll1&tag=aokikenichi-22&linkId=b4fb2bc3209ec5a8b2d381d8955f2486\">\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f</a>\n<a href=\"https://www.amazon.co.jp/%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90-%E7%B5%B1%E8%A8%88%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%83%BC-%E6%B2%96%E6%9C%AC-%E7%AB%9C%E7%BE%A9/dp/4254127928/ref=as_li_ss_il?ie=UTF8&qid=1478165293&sr=8-1&keywords=%E7%B5%8C%E6%B8%88%E3%83%BB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%8A%E3%83%B3%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%A8%88%E9%87%8F%E6%99%82%E7%B3%BB%E5%88%97%E5%88%86%E6%9E%90&linkCode=li2&tag=aokikenichi-22&linkId=53c071200e6bc21d9723dd3a5f926476\" target=\"_blank\"><img border=\"0\" src=\"//ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4254127928&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=aokikenichi-22\" ></a><img src=\"https://ir-jp.amazon-adsystem.com/e/ir?t=aokikenichi-22&l=li2&o=9&a=4254127928\" width=\"1\" height=\"1\" border=\"0\" alt=\"\" style=\"border:none !important; margin:0px !important;\" />\n\u306e\u7ae0\u672b\u554f\u984c\u3067\u300c\u30b3\u30f3\u30d4\u30e5\u30fc\u30bf\u3092\u7528\u3044\u3066\u300d\u3068\u3042\u308b\u3082\u306e\u3092R\u3067\u89e3\u3044\u3066\u3044\u307e\u3059\u3002\n* [\u30b5\u30dd\u30fc\u30c8\u30b5\u30a4\u30c8\uff08\u30c7\u30fc\u30bf\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\uff09](http://www.geocities.jp/tatsuyoshi_okimoto/books/tsa.html)\n\n# 2.5\n* (1)\n\n```r\nlibrary(forecast)\n\ndata<-read.table(\"economicdata.txt\",header=T)\nar4<-Arima(diff(log(data$indprod))*100, order=c(4, 0, 0))\nma3<-Arima(diff(log(data$indprod))*100, order=c(0, 0, 3))\narma1_1<-Arima(diff(log(data$indprod))*100, order=c(1, 0, 1))\narma2_1<-Arima(diff(log(data$indprod))*100, order=c(2, 0, 1))\narma1_2<-Arima(diff(log(data$indprod))*100, order=c(1, 0, 2))\narma2_2<-Arima(diff(log(data$indprod))*100, order=c(2, 0, 2))\n\nname<-c('AR(4)', 'MA(3)', 'ARMA(1,1)', 'ARMA(2,1)', 'ARMA(1,2)', 'ARMA(2,2)')\naic<-c(\n  AIC(ar4)/length(data$indprod),\n  AIC(ma3)/length(data$indprod),\n  AIC(arma1_1)/length(data$indprod),\n  AIC(arma2_1)/length(data$indprod),\n  AIC(arma1_2)/length(data$indprod),\n  AIC(arma2_2)/length(data$indprod)\n)\nbic<-c(\n  BIC(ar4)/length(data$indprod),\n  BIC(ma3)/length(data$indprod),\n  BIC(arma1_1)/length(data$indprod),\n  BIC(arma2_1)/length(data$indprod),\n  BIC(arma1_2)/length(data$indprod),\n  BIC(arma2_2)/length(data$indprod)\n)\nout<-data.frame(matrix(aic, nrow=1))\nout<-rbind(out, bic)\ncolnames(out)<-name\nrownames(out)<-c('AIC', 'SIC')\nout\n```\n```r\n       AR(4)    MA(3) ARMA(1,1) ARMA(2,1) ARMA(1,2) ARMA(2,2)\nAIC 3.232032 3.239599  3.324956  3.277746  3.233284  3.246579\nSIC 3.296225 3.293094  3.367752  3.331241  3.286779  3.310772\n```\n\n```r\n## figure\npar(mfrow = c(2, 2))\npar(mar = c(2, 2, 1, 1))\nacf(diff(log(data$indprod)), xlim=c(1, 20), ylim=c(-0.5, 0.5))\nmtext(text = '\u6a19\u672c\u81ea\u5df1\u76f8\u95a2', side = 3)\npacf(diff(log(data$indprod)), xlim=c(1, 20), ylim=c(-0.5, 0.5))\nmtext(text = '\u6a19\u672c\u504f\u81ea\u5df1\u76f8\u95a2')\nacf(ar4$residuals, xlim=c(1, 20), ylim=c(-0.5, 0.5))\nmtext(text = 'AR(4)\u30e2\u30c7\u30eb\u306e\u6b8b\u5dee\u306e\u8a3a\u65ad', side = 3)\nacf(arma1_2$residuals, xlim=c(1, 20), ylim=c(-0.5, 0.5))\nmtext(text = 'ARMA(1,2)\u30e2\u30c7\u30eb\u306e\u6b8b\u5dee\u306e\u8a3a\u65ad', side = 3)\n```\n![1_2.5.1.png](https://qiita-image-store.s3.amazonaws.com/0/116049/05ab7285-6645-299d-8d9d-f85f5d0eee6d.png)\n\n* (2)\n\n```r\nlibrary(forecast)\n\ndata<-read.table(\"economicdata.txt\",header=T)\nar4<-Arima(diff(log(data$indprod))*100, order=c(4, 0, 0))\narma1_2<-Arima(diff(log(data$indprod))*100, order=c(1, 0, 2))\n```\n\nAR(4)\n\n```r\nBox.test(ar4$residuals[1:10], type=\"Ljung\")\n```\n\n```r\n\tBox-Ljung test\n\ndata:  ar4$residuals[1:10]\nX-squared = 0.37762, df = 1, p-value = 0.5389\n```\np>0.05\u3088\u308a\u5e30\u7121\u4eee\u8aac\u3092\u68c4\u5374\u3067\u304d\u306a\u3044\u306e\u3067\u81ea\u5df1\u76f8\u95a2\u304c\u3042\u308b\u3068\u306f\u8a00\u3048\u306a\u3044\u3002\n\nARMA(1, 2)\n\n```r\nBox.test(arma1_2$residuals[1:10], type=\"Ljung\")\n```\n\n```r\n\tBox-Ljung test\n\ndata:  arma1_2$residuals[1:10]\nX-squared = 0.37971, df = 1, p-value = 0.5378\n```\np>0.05\u3088\u308a\u5e30\u7121\u4eee\u8aac\u3092\u68c4\u5374\u3067\u304d\u306a\u3044\u306e\u3067\u81ea\u5df1\u76f8\u95a2\u304c\u3042\u308b\u3068\u306f\u8a00\u3048\u306a\u3044\u3002\n\n# 2.6\n```r\nlibrary(forecast)\ndata<-read.table(\"arma.txt\", header=T)\n```\n\n* (1)\n\n```r\npar(mfrow=c(2, 1))\nacf(data$y1, xlim=c(1, 20))\nmtext('\u6a19\u672c\u81ea\u5df1\u76f8\u95a2', side = 3)\npacf(data$y1, xlim=c(1, 20))\nmtext('\u6a19\u672c\u504f\u81ea\u5df1\u76f8\u95a2', side = 3)\n```\n![1_2.6.1.png](https://qiita-image-store.s3.amazonaws.com/0/116049/3b87c458-9cc1-75bb-c1cd-f577cb42a05f.png)\n\n* (2), (3)\n\n```r\n###AR(2)\n###ARMA(1,1),ARMA(2,1),ARMA(1,2),ARMA(2,2)\nar2<-Arima(data$y1, order=c(2, 0, 0))\narma1_1<-Arima(data$y1, order=c(1, 0, 1))\narma2_1<-Arima(data$y1, order=c(2, 0, 1))\narma1_2<-Arima(data$y1, order=c(1, 0, 2))\narma2_2<-Arima(data$y1, order=c(2, 0, 2))\n\nname<-c('AR(2)', 'ARMA(1,1)', 'ARMA(2,1)', 'ARMA(1,2)', 'ARMA(2,2)')\naic<-c(\n  AIC(ar2)/length(data$y1),\n  AIC(arma1_1)/length(data$y1),\n  AIC(arma2_1)/length(data$y1),\n  AIC(arma1_2)/length(data$y1),\n  AIC(arma2_2)/length(data$y1)\n)\nbic<-c(\n  BIC(ar2)/length(data$y1),\n  BIC(arma1_1)/length(data$y1),\n  BIC(arma2_1)/length(data$y1),\n  BIC(arma1_2)/length(data$y1),\n  BIC(arma2_2)/length(data$y1)\n)\nout<-data.frame(matrix(aic, nrow=1))\nout<-rbind(out, bic)\ncolnames(out)<-name\nrownames(out)<-c('AIC', 'SIC')\n###AIC ARMA(2,1), SIC AR(2)\nout\n```\n\n```r\n       AR(2) ARMA(1,1) ARMA(2,1) ARMA(1,2) ARMA(2,2)\nAIC 3.023947  3.034293  3.021437  3.029152  3.027627\nSIC 3.073331  3.083677  3.083167  3.090882  3.101703\n```\n\n* (4)\n\nAIC\u304b\u3089\u306fARMA(2,1)\u3001SIC\u304b\u3089\u306fAR(2)\u3092\u9078\u629e\u3057\u305f\u3002\n\n```r\nacf(arma2_1$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\nacf(ar2$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\n```\n![1_2.6.4.png](https://qiita-image-store.s3.amazonaws.com/0/116049/715b9d56-0ad4-0531-df1b-83b9fbaec0eb.png)\n\n```r\nBox.test(arma2_1$residuals[1:20], type=\"Ljung\")\n```\n\n```r\n\tBox-Ljung test\n\ndata:  arma2_1$residuals[1:20]\nX-squared = 0.013201, df = 1, p-value = 0.9085\n```\n\n```r\nBox.test(ar2$residuals[1:20], type=\"Ljung\")\n```\n\n```r\n\tBox-Ljung test\n\ndata:  ar2$residuals[1:20]\nX-squared = 0.0979, df = 1, p-value = 0.7544\n```\n\n* (5)\n\ny2\n\n```r\nacf(data$y2, xlim = c(1, 20), ylim = c(-0.5, 0.5))\nmtext(text = 'y2 \u6a19\u672c\u81ea\u5df1\u76f8\u95a2', side = 3)\npacf(data$y2, xlim = c(1, 20), ylim = c(-0.5, 0.5))\nmtext(text = 'y2 \u6a19\u672c\u504f\u81ea\u5df1\u76f8\u95a2', side = 3)\n```\n![1_2.6.5.y2.png](https://qiita-image-store.s3.amazonaws.com/0/116049/95ce2901-9902-5598-a2ca-80306deb0259.png)\n\n```r\n####MA(3)\n####ARMA(1,1),ARMA(2,1),ARMA(1,2),ARMA(2,2)\nma3<-Arima(data$y2, order=c(0, 0, 3))\narma1_1<-Arima(data$y2, order=c(1, 0, 1))\narma2_1<-Arima(data$y2, order=c(2, 0, 1))\narma1_2<-Arima(data$y2, order=c(1, 0, 2))\narma2_2<-Arima(data$y2, order=c(2, 0, 2))\n\nname<-c('MA(3)', 'ARMA(1,1)', 'ARMA(2,1)', 'ARMA(1,2)', 'ARMA(2,2)')\naic<-c(\n  AIC(ma3)/length(data$y2),\n  AIC(arma1_1)/length(data$y2),\n  AIC(arma2_1)/length(data$y2),\n  AIC(arma1_2)/length(data$y2),\n  AIC(arma2_2)/length(data$y2)\n)\nbic<-c(\n  BIC(ma3)/length(data$y2),\n  BIC(arma1_1)/length(data$y2),\n  BIC(arma2_1)/length(data$y2),\n  BIC(arma1_2)/length(data$y2),\n  BIC(arma2_2)/length(data$y2)\n)\nout<-data.frame(matrix(aic, nrow=1))\nout<-rbind(out, bic)\ncolnames(out)<-name\nrownames(out)<-c('AIC', 'SIC')\n###AIC MA(3), SIC MA(3)\nout\n```\n\n```r\n       MA(3) ARMA(1,1) ARMA(2,1) ARMA(1,2) ARMA(2,2)\nAIC 2.769046  2.859515  2.775498  2.818165  2.781784\nSIC 2.830775  2.908899  2.837228  2.879895  2.855860\n```\n\n```r\npar(mfrow = c(1, 1))\nacf(ma3$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\n```\n![1_2.5.6.y2.2.png](https://qiita-image-store.s3.amazonaws.com/0/116049/74bb34f6-cff8-0e8c-8962-854daeced1fd.png)\n\n```r\nBox.test(ma3$residuals[1:20], type=\"Ljung\")\n```\n\n```r\n\tBox-Ljung test\n\ndata:  ma3$residuals[1:20]\nX-squared = 0.0066437, df = 1, p-value = 0.935\n```\n\ny3\n\n```r\n###y3\npar(mfrow=c(2,1))\nacf(data$y3, xlim=c(1, 20))\nmtext(text = 'y3 \u6a19\u672c\u81ea\u5df1\u76f8\u95a2', side = 3)\npacf(data$y3, xlim=c(1, 20))\nmtext(text = 'y3 \u6a19\u672c\u504f\u81ea\u5df1\u76f8\u95a2', side = 3)\n```\n![1_2.6.5.y3.png](https://qiita-image-store.s3.amazonaws.com/0/116049/e742a109-e329-13e3-d330-37ed35834bfe.png)\n\n\n```r\n####AR(8), MA(7)\n####ARMA(1,1),ARMA(2,1),ARMA(1,2),ARMA(2,2)\nar8<-Arima(data$y3, order=c(8, 0, 0))\nma7<-Arima(data$y3, order=c(0, 0, 7))\narma1_1<-Arima(data$y3, order=c(1, 0, 1))\narma2_1<-Arima(data$y3, order=c(2, 0, 1))\narma1_2<-Arima(data$y3, order=c(1, 0, 2))\narma2_2<-Arima(data$y3, order=c(2, 0, 2))\n\nname<-c('AR(8)', 'MA(7)', 'ARMA(1,1)', 'ARMA(2,1)', 'ARMA(1,2)', 'ARMA(2,2)')\naic<-c(\n  AIC(ar8)/length(data$y3),\n  AIC(ma7)/length(data$y3),\n  AIC(arma1_1)/length(data$y3),\n  AIC(arma2_1)/length(data$y3),\n  AIC(arma1_2)/length(data$y3),\n  AIC(arma2_2)/length(data$y3)\n)\nbic<-c(\n  BIC(ar8)/length(data$y3),\n  BIC(ma7)/length(data$y3),\n  BIC(arma1_1)/length(data$y3),\n  BIC(arma2_1)/length(data$y3),\n  BIC(arma1_2)/length(data$y3),\n  BIC(arma2_2)/length(data$y3)\n)\nout<-data.frame(matrix(aic, nrow=1))\nout<-rbind(out, bic)\ncolnames(out)<-name\nrownames(out)<-c('AIC', 'SIC')\n###AIC ARMA(1,2), SIC ARMA(1,1)\nout\n```\n\n```r\n       AR(8)    MA(7) ARMA(1,1) ARMA(2,1) ARMA(1,2) ARMA(2,2)\nAIC 3.115248 3.082550  3.069798   3.06590  3.065178  3.071635\nSIC 3.238708 3.193663  3.119182   3.12763  3.126907  3.145711\n```\n\n```r\npar(mfrow = c(1, 1))\nacf(arma1_2$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\nmtext(text = 'ARMA(1,2)\u30e2\u30c7\u30eb\u306e\u6b8b\u5dee\u306e\u8a3a\u65ad', side = 3)\n```\n![1_2.6.5.y3.2.png](https://qiita-image-store.s3.amazonaws.com/0/116049/0b9a28d2-5435-21ed-e4c4-48ee5796dfbf.png)\n\n```r\nBox.test(arma1_2$residuals[1:20], type=\"Ljung\")\n```\n\n```r\n\tBox-Ljung test\n\ndata:  arma1_2$residuals[1:20]\nX-squared = 0.17219, df = 1, p-value = 0.6782\n```\n\n```r\nacf(arma1_1$residuals, xlim=c(1,20), ylim=c(-0.5,0.5))\nmtext(text = 'ARMA(1,1)\u30e2\u30c7\u30eb\u306e\u6b8b\u5dee\u306e\u8a3a\u65ad', side = 3)\n```\n![1_2.6.5.y3.3.png](https://qiita-image-store.s3.amazonaws.com/0/116049/dba1af64-3d32-f58f-6570-31a296bfc3b0.png)\n\n```r\nBox.test(arma1_1$residuals[1:20], type=\"Ljung\")\n```\n\n```r\n\tBox-Ljung test\n\ndata:  arma1_1$residuals[1:20]\nX-squared = 6.0017e-05, df = 1, p-value = 0.9938\n```\n\n\u21d2 3\u7ae0\u306f\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u7528\u3044\u308b\u7ae0\u672b\u554f\u984c\u304c\u306a\u3044\u306e\u3067\u3001\u6b21\u306f [\u300e\u7d4c\u6e08\u30fb\u30d5\u30a1\u30a4\u30ca\u30f3\u30b9\u30c7\u30fc\u30bf\u306e\u8a08\u91cf\u6642\u7cfb\u5217\u5206\u6790\u300f\u7ae0\u672b\u554f\u984c\u3092R\u3067\u89e3\u304f\uff0d\u7b2c4\u7ae0VAR\u30e2\u30c7\u30eb\uff0d](http://qiita.com/aokikenichi/items/a7f610e2bf92ecd8b360) \u3078\n"}