{"context": "CentOS7\u3068\u304bPHP7\u3092\u4f7f\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u306e\u3067\n\u304a\u624b\u8efd\u306b\u958b\u767a\u74b0\u5883\u3092\u7528\u610f\u3059\u308b\u3068\u304d\u306e\u30e1\u30e2\u66f8\u304d\u3068\u3057\u3066\u4f5c\u308a\u307e\u3057\u305f\n\n\u4f5c\u696d\u74b0\u5883\n\nWindows7\n\n\n\u524d\u63d0\n\nVagrant\u3092\u4f7f\u7528\u3059\u308b\nVirtualbox\u3092\u4f7f\u7528\u3059\u308b\n\u69cb\u6210\u7ba1\u7406\u30c4\u30fc\u30eb\u306f\u4f7f\u7528\u3057\u306a\u3044\n\n\n\u30b5\u30fc\u30d0\u30fc\u69cb\u6210\n\nCentOS-7\nApache/2.4.6\nPHP7\nMySQL5.6\n\n\nCentOS-7 \u306e BOX\u3092\u8ffd\u52a0\nvagrant box add \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\n$ vagrant box add centos7 https://github.com/holms/vagrant-centos7-box/releases/download/7.1.1503.001/CentOS-7.1.1503-x86_64-netboot.box\n\n==> box: Box file was not detected as metadata. Adding it directly...\n==> box: Adding box 'centos7' (v0) for provider:\n    box: Downloading: https://github.com/holms/vagrant-centos7-box/releases/down\nload/7.1.1503.001/CentOS-7.1.1503-x86_64-netboot.box\n    box: Progress: 100% (Rate: 10.4M/s, Estimated time remaining: --:--:--)\n==> box: Successfully added box 'centos7' (v0) for 'virtualbox'!\n\n\n\u8ffd\u52a0\u6e08\u307f\u306eBOX\u306e\u30ea\u30b9\u30c8\u3092\u78ba\u8a8d\nvagrant box list \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\n$ vagrant box list\n\ncentos7    (virtualbox,0)\n\n\u3061\u306a\u307f\u306b\u8ffd\u52a0\u3055\u308c\u305fBOX\u306e\u672c\u4f53\u306f C:/Users/{USER}/.vagrant.d/boxes/ \u306e\u4e2d\u306b\u8ffd\u52a0\u3055\u308c\u3066\u3044\u307e\u3059\n\nVM\u3092\u521d\u671f\u5316\n\u9069\u5f53\u306a\u5834\u6240\u306bVM\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3057\u307e\u3059\n\u30d5\u30a9\u30eb\u30c0\u306b\u79fb\u52d5\u3057\u3066BOX\u540d\u3092\u6307\u5b9a\u3057\u3066VM\u306e\u521d\u671f\u5316\u3092\u884c\u3044\u307e\u3059\n$ vagrant init centos7\n\nA `Vagrantfile` has been placed in this directory. You are now\nready to `vagrant up` your first virtual environment! Please read\nthe comments in the Vagrantfile as well as documentation on\n`vagrantup.com` for more information on using Vagrant.\n\n\u521d\u671f\u5316\u3092\u884c\u3046\u3068Vagrantfile\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u307e\u3059\nVagrantfile\u306fVM\u306e\u8a2d\u5b9a\u3092\u8a18\u8f09\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\n\nVagrantfile\u5185\u5bb9\n\n\u4f7f\u7528\u3059\u308bBOX\u540d\u306e\u6307\u5b9a\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\u30a2\u30c9\u30ec\u30b9\u306e\u6307\u5b9a\nVM\u306e\u30e1\u30e2\u30ea\u91cf\u8a2d\u5b9a\nprovision\u30d5\u30a1\u30a4\u30eb\u306e\u6307\u5b9a\n\nVagrant.configure(2) do |config|\n  config.vm.box = \"centos7\"\n  config.vm.network \"private_network\", ip: \"192.168.33.10\"\n  config.vm.provider \"virtualbox\" do |vb|\n    vb.customize [\"modifyvm\", :id, \"--memory\", \"1024\"]\n  end\n  config.vm.provision :shell do |sh|\n    sh.path = \"provision.sh\"\n  end\nend\n\n\n\nprovision.sh\u5185\u5bb9\n\nWeb\u30b5\u30fc\u30d0\u30fc\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nFirewall\u306e\u8a2d\u5b9a\nPHP7\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nphp.ini\u66f8\u304d\u63db\u3048\nMySQL\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nntp\u8a2d\u5b9a\n\n#!/bin/bash\n\n# WEB Server\necho \"Web Server ############################################\";\nsudo yum -y install httpd\nsudo systemctl start httpd.service\nsudo systemctl enable httpd.service\n\n# Firewall\necho \"Firewall ############################################\";\nsudo systemctl stop firewalld.service\nsudo systemctl disable firewalld.service\n\n# PHP7\necho \"PHP7 ############################################\";\nsudo yum -y install epel-release\nsudo rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm\nsudo yum -y install --enablerepo=remi,remi-php70 php php-devel php-mbstring php-pdo php-gd\n\n# php.ini\necho \"php.ini ############################################\";\nsudo cp /etc/php.ini /etc/php.ini.org\necho \"date.timezon = Asia\\/Tokyo\";\nsudo sed -i -e \"s/;date.timezone =/date.timezone = Asia\\/Tokyo/\" /etc/php.ini\necho \"mbstring.language = Japanese\";\nsudo sed -i -e \"s/;mbstring.language = Japanese/mbstring.language = Japanese/\" /etc/php.ini\necho \"mbstring.internal_encoding =UTF-8\";\nsudo sed -i -e \"s/;mbstring.internal_encoding =/mbstring.internal_encoding = UTF-8/\" /etc/php.ini\necho \"mbstring.encoding_translation = Off\";\nsudo sed -i -e \"s/;mbstring.encoding_translation = Off/mbstring.encoding_translation = Off/\" /etc/php.ini\necho \"mbstring.detect_order = auto\";\nsudo sed -i -e \"s/;mbstring.detect_order = auto/mbstring.detect_order = auto/\" /etc/php.ini\necho \"max_execution_time = 180\";\nsudo sed -i -e \"s/max_execution_time = 30/max_execution_time = 180/\" /etc/php.ini\n\n# mysql5.6\necho \"MySQL5.6 ############################################\";\nsudo rpm -Uvh http://dev.mysql.com/get/mysql57-community-release-el6-7.noarch.rpm\nsudo yum -y install yum-utils\nsudo yum-config-manager --disable mysql57-community\nsudo yum-config-manager --enable mysql56-community\nsudo yum -y install mysql-server\nsudo systemctl restart httpd.service\nsudo systemctl enable mysqld.service\nsudo systemctl start mysqld.service\n\n# ntp\necho \"ntp ############################################\";\nsudo yum -y install ntp\nsudo cp /etc/ntp.conf /etc/ntp.conf.org\nsudo sed -i -e \"s/server 0.centos.pool.ntp.org iburst/server -4 ntp.nict.jp/\" /etc/ntp.conf\nsudo sed -i -e \"s/server 1.centos.pool.ntp.org iburst/server -4 ntp1.jst.mfeed.ad.jp/\" /etc/ntp.conf\nsudo sed -i -e \"s/server 2.centos.pool.ntp.org iburst/server -4 ntp2.jst.mfeed.ad.jp/\" /etc/ntp.conf\nsudo sed -i -e \"s/server 3.centos.pool.ntp.org iburst/server -4 ntp3.jst.mfeed.ad.jp/\" /etc/ntp.conf\nsudo systemctl start ntpd.service\nsudo systemctl enable ntpd.service\nsudo timedatectl set-timezone Asia/Tokyo\n\n\n\nVM\u3092\u7acb\u3061\u4e0a\u3052\u308b\n\u4e88\u3081\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\n$ vagrant plugin install vagrant-vbguest\n\nVagrantfile\u304c\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u3067vagrant up\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\n$ vagrant up\n\nvagrant status\u3092\u4f7f\u7528\u3057\u3066VM\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\n$ vagrant status\n\nCurrent machine states:\n\ndefault                   running (virtualbox)\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u3066\u52d5\u4f5c\u304c\u554f\u984c\u306a\u3044\u304b\u78ba\u8a8d\u3059\u308b\n\n\nPHP\u306e\u52d5\u4f5c\u78ba\u8a8d\n/var/www/html \u306b index.php\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u5165\u529b\u3057\u307e\u3059\n<?php\necho phpinfo();\n\n\u30d6\u30e9\u30a6\u30b6\u306b\u30a2\u30af\u30bb\u30b9\u3092\u884c\u3044PHP\u306e\u8a2d\u5b9a\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u308c\u3070OK\u3067\u3059\nCentOS7\u3068\u304bPHP7\u3092\u4f7f\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u306e\u3067\n\u304a\u624b\u8efd\u306b\u958b\u767a\u74b0\u5883\u3092\u7528\u610f\u3059\u308b\u3068\u304d\u306e\u30e1\u30e2\u66f8\u304d\u3068\u3057\u3066\u4f5c\u308a\u307e\u3057\u305f\n\n## \u4f5c\u696d\u74b0\u5883\n- Windows7\n\n## \u524d\u63d0\n\n1. Vagrant\u3092\u4f7f\u7528\u3059\u308b\n2. Virtualbox\u3092\u4f7f\u7528\u3059\u308b\n3. \u69cb\u6210\u7ba1\u7406\u30c4\u30fc\u30eb\u306f\u4f7f\u7528\u3057\u306a\u3044\n\n## \u30b5\u30fc\u30d0\u30fc\u69cb\u6210\n\n- CentOS-7\n- Apache/2.4.6\n- PHP7\n- MySQL5.6\n\n## CentOS-7 \u306e BOX\u3092\u8ffd\u52a0\nvagrant box add \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\n\n```sh\n$ vagrant box add centos7 https://github.com/holms/vagrant-centos7-box/releases/download/7.1.1503.001/CentOS-7.1.1503-x86_64-netboot.box\n\n==> box: Box file was not detected as metadata. Adding it directly...\n==> box: Adding box 'centos7' (v0) for provider:\n    box: Downloading: https://github.com/holms/vagrant-centos7-box/releases/down\nload/7.1.1503.001/CentOS-7.1.1503-x86_64-netboot.box\n    box: Progress: 100% (Rate: 10.4M/s, Estimated time remaining: --:--:--)\n==> box: Successfully added box 'centos7' (v0) for 'virtualbox'!\n```\n\n## \u8ffd\u52a0\u6e08\u307f\u306eBOX\u306e\u30ea\u30b9\u30c8\u3092\u78ba\u8a8d\nvagrant box list \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\n\n```sh\n$ vagrant box list\n\ncentos7    (virtualbox,0)\n```\n\u3061\u306a\u307f\u306b\u8ffd\u52a0\u3055\u308c\u305fBOX\u306e\u672c\u4f53\u306f **C:/Users/{USER}/.vagrant.d/boxes/** \u306e\u4e2d\u306b\u8ffd\u52a0\u3055\u308c\u3066\u3044\u307e\u3059\n\n## VM\u3092\u521d\u671f\u5316\n\u9069\u5f53\u306a\u5834\u6240\u306bVM\u7528\u306e\u30d5\u30a9\u30eb\u30c0\u3092\u4f5c\u6210\u3057\u307e\u3059\n\n\u30d5\u30a9\u30eb\u30c0\u306b\u79fb\u52d5\u3057\u3066BOX\u540d\u3092\u6307\u5b9a\u3057\u3066VM\u306e\u521d\u671f\u5316\u3092\u884c\u3044\u307e\u3059\n\n```sh\n$ vagrant init centos7\n\nA `Vagrantfile` has been placed in this directory. You are now\nready to `vagrant up` your first virtual environment! Please read\nthe comments in the Vagrantfile as well as documentation on\n`vagrantup.com` for more information on using Vagrant.\n```\n\n\u521d\u671f\u5316\u3092\u884c\u3046\u3068Vagrantfile\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u304c\u751f\u6210\u3055\u308c\u307e\u3059\nVagrantfile\u306fVM\u306e\u8a2d\u5b9a\u3092\u8a18\u8f09\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\n\n### Vagrantfile\u5185\u5bb9\n\n1. \u4f7f\u7528\u3059\u308bBOX\u540d\u306e\u6307\u5b9a\n2. \u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\u30a2\u30c9\u30ec\u30b9\u306e\u6307\u5b9a\n3. VM\u306e\u30e1\u30e2\u30ea\u91cf\u8a2d\u5b9a\n4. provision\u30d5\u30a1\u30a4\u30eb\u306e\u6307\u5b9a\n\n```ruby\nVagrant.configure(2) do |config|\n  config.vm.box = \"centos7\"\n  config.vm.network \"private_network\", ip: \"192.168.33.10\"\n  config.vm.provider \"virtualbox\" do |vb|\n    vb.customize [\"modifyvm\", :id, \"--memory\", \"1024\"]\n  end\n  config.vm.provision :shell do |sh|\n    sh.path = \"provision.sh\"\n  end\nend\n\n```\n\n### provision.sh\u5185\u5bb9\n1. Web\u30b5\u30fc\u30d0\u30fc\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n- Firewall\u306e\u8a2d\u5b9a\n- PHP7\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n- php.ini\u66f8\u304d\u63db\u3048\n- MySQL\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n- ntp\u8a2d\u5b9a\n\n```sh\n#!/bin/bash\n\n# WEB Server\necho \"Web Server ############################################\";\nsudo yum -y install httpd\nsudo systemctl start httpd.service\nsudo systemctl enable httpd.service\n\n# Firewall\necho \"Firewall ############################################\";\nsudo systemctl stop firewalld.service\nsudo systemctl disable firewalld.service\n\n# PHP7\necho \"PHP7 ############################################\";\nsudo yum -y install epel-release\nsudo rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm\nsudo yum -y install --enablerepo=remi,remi-php70 php php-devel php-mbstring php-pdo php-gd\n\n# php.ini\necho \"php.ini ############################################\";\nsudo cp /etc/php.ini /etc/php.ini.org\necho \"date.timezon = Asia\\/Tokyo\";\nsudo sed -i -e \"s/;date.timezone =/date.timezone = Asia\\/Tokyo/\" /etc/php.ini\necho \"mbstring.language = Japanese\";\nsudo sed -i -e \"s/;mbstring.language = Japanese/mbstring.language = Japanese/\" /etc/php.ini\necho \"mbstring.internal_encoding =UTF-8\";\nsudo sed -i -e \"s/;mbstring.internal_encoding =/mbstring.internal_encoding = UTF-8/\" /etc/php.ini\necho \"mbstring.encoding_translation = Off\";\nsudo sed -i -e \"s/;mbstring.encoding_translation = Off/mbstring.encoding_translation = Off/\" /etc/php.ini\necho \"mbstring.detect_order = auto\";\nsudo sed -i -e \"s/;mbstring.detect_order = auto/mbstring.detect_order = auto/\" /etc/php.ini\necho \"max_execution_time = 180\";\nsudo sed -i -e \"s/max_execution_time = 30/max_execution_time = 180/\" /etc/php.ini\n\n# mysql5.6\necho \"MySQL5.6 ############################################\";\nsudo rpm -Uvh http://dev.mysql.com/get/mysql57-community-release-el6-7.noarch.rpm\nsudo yum -y install yum-utils\nsudo yum-config-manager --disable mysql57-community\nsudo yum-config-manager --enable mysql56-community\nsudo yum -y install mysql-server\nsudo systemctl restart httpd.service\nsudo systemctl enable mysqld.service\nsudo systemctl start mysqld.service\n\n# ntp\necho \"ntp ############################################\";\nsudo yum -y install ntp\nsudo cp /etc/ntp.conf /etc/ntp.conf.org\nsudo sed -i -e \"s/server 0.centos.pool.ntp.org iburst/server -4 ntp.nict.jp/\" /etc/ntp.conf\nsudo sed -i -e \"s/server 1.centos.pool.ntp.org iburst/server -4 ntp1.jst.mfeed.ad.jp/\" /etc/ntp.conf\nsudo sed -i -e \"s/server 2.centos.pool.ntp.org iburst/server -4 ntp2.jst.mfeed.ad.jp/\" /etc/ntp.conf\nsudo sed -i -e \"s/server 3.centos.pool.ntp.org iburst/server -4 ntp3.jst.mfeed.ad.jp/\" /etc/ntp.conf\nsudo systemctl start ntpd.service\nsudo systemctl enable ntpd.service\nsudo timedatectl set-timezone Asia/Tokyo\n\n```\n\n## VM\u3092\u7acb\u3061\u4e0a\u3052\u308b\n\u4e88\u3081\u30d7\u30e9\u30b0\u30a4\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\n\n```sh\n$ vagrant plugin install vagrant-vbguest\n```\n\nVagrantfile\u304c\u3042\u308b\u30d5\u30a9\u30eb\u30c0\u3067vagrant up\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u307e\u3059\n\n```sh\n$ vagrant up\n```\nvagrant status\u3092\u4f7f\u7528\u3057\u3066VM\u304c\u7acb\u3061\u4e0a\u304c\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\n\n```sh\n$ vagrant status\n\nCurrent machine states:\n\ndefault                   running (virtualbox)\n```\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u3066\u52d5\u4f5c\u304c\u554f\u984c\u306a\u3044\u304b\u78ba\u8a8d\u3059\u308b\n\n![firstaccess.png](https://qiita-image-store.s3.amazonaws.com/0/110087/b54d1f45-9102-60bd-f4ed-c3515a3d8464.png)\n\n## PHP\u306e\u52d5\u4f5c\u78ba\u8a8d\n\n/var/www/html \u306b index.php\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u5165\u529b\u3057\u307e\u3059\n\n```php\n<?php\necho phpinfo();\n```\n\n\u30d6\u30e9\u30a6\u30b6\u306b\u30a2\u30af\u30bb\u30b9\u3092\u884c\u3044PHP\u306e\u8a2d\u5b9a\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u308c\u3070OK\u3067\u3059\n", "tags": ["centos7", "PHP7", "vagrant"]}