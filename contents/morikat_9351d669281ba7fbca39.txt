{"tags": ["scaleway", "cloudfoundry"], "context": "\n\n\u306f\u3058\u3081\u306b\n\nmicroPCF\u3068\u306f\nCloud Foundry\u306e\u74b0\u5883\u3092\u30ed\u30fc\u30ab\u30eb\u3067Vagrant\u3092\u4f7f\u3063\u3066\u69cb\u7bc9\u51fa\u6765\u308b\u30c4\u30fc\u30eb\u3067\u3001\u30a2\u30d7\u30ea\u958b\u767a\u8005\u304c\u30ed\u30fc\u30ab\u30eb\u3067\u5b9f\u9a13\u3059\u308b\u306e\u306b\u4fbf\u5229\u3067\u3059\u3002\n\u53c2\u8003:\nBLOG.IK.AM\u3000MicroPCF\u3067\u30ed\u30fc\u30ab\u30ebCloudFoundry\u74b0\u5883\u3092\u4f5c\u308b\nmicroPCF\u3092\u4f7f\u3063\u3066\u307f\u3088\u3046\n\nScaleway\u306eC2\u30b5\u30fc\u30d0\u3068\u306f\n2016\u5e743\u670810\u65e5\u6642\u70b9\u3067\u77e5\u3063\u305f\u306e\u3067\u3059\u304c\u3001ARM\u306e\u30de\u30b7\u30f3\u8cb8\u3057\u3067\u4e00\u90e8\u3067\u8a71\u984c\u306b\u306a\u3063\u305fScaleway\u306e\u65b0\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\nC2\u30b5\u30fc\u30d0\u3068\u547c\u3070\u308c\u308bx86-64\u306e\u6700\u5c0f\u30d7\u30e9\u30f311.99\u30e6\u30fc\u30ed\uff081500\u5186\u7a0b\uff1f\uff09\u3067\n4core 8GB\u30e1\u30e2\u30ea\u3068\u3044\u3046\u6bd4\u8f03\u7684\u9b45\u529b\u7684\u306a\u30b5\u30fc\u30d3\u30b9\u304c\u958b\u59cb\u3055\u308c\u305f\u3088\u3046\u3067\u3059\u3002\nhttps://blog.scaleway.com/2016/03/08/c2-insanely-affordable-x64-servers/\n\n\u3053\u306e\u76ee\u6a19\nARM\u306e\u30de\u30b7\u30f3\u3092\u501f\u308a\u3089\u308c\u308bC1\u306e\u30d7\u30e9\u30f3\u306f\u4ee5\u524d\u306b\u8a66\u3057\u305f\u3053\u3068\u304c\u3042\u3063\u305f\u306e\u3067\u3001\n\u4eca\u56de\u306f\u3055\u304f\u3063\u3068C2\u3092\u501f\u308a\u3066microPCF\u3092\u4f7f\u3044\n\u300e\u683c\u5b89\u306e\u81ea\u5206\u5c02\u7528Cloud Foundry\u74b0\u5883\u3092\u7acb\u3066\u3089\u308c\u306a\u3044\u304b\uff1f\u300f\u3068\u3044\u3046\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u69cb\u7bc9\n\n\u30b5\u30fc\u30d0\u4f5c\u6210\nc2\u30b5\u30fc\u30d0\u306eubuntu trusty\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u9078\u629e\u3057\u307e\u3059\n\n\u203b\u8ffd\u52a0\u60c5\u5831(2016/3/27)\n\u5b9f\u969b\u306bCloud Foundry\u3092\u52d5\u304b\u3057\u3066\u30a2\u30d7\u30ea\u3092\u3044\u304f\u3064\u304b\u3042\u3052\u3066\n\u6570\u65e5\u69d8\u5b50\u3092\u898b\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001\u3084\u306f\u308aVagrant\u306esnapshot\u3084\u540c\u6642\u306b\u7acb\u3061\u4e0a\u3052\u3066\u3044\u308bService Broker\u7528\u306edocker\u306a\u3069\u306b\u3088\u3063\u3066\u3001\u30c7\u30a3\u30b9\u30af\u30b5\u30a4\u30ba\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e50GB\u306e\u307f\u3060\u3068\u30c7\u30a3\u30b9\u30af\u304c\u8db3\u308a\u306a\u304f\u306a\u308b\u3088\u3046\u3067\u3059\u3002\n\u305d\u306e\u70ba\u300150GB\u3042\u305f\u308a\u207a1\u30e6\u30fc\u30ed\u3068\u306a\u308a2\u30e6\u30fc\u30ed\u4f59\u5206\u306b\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u304c\u3001\u6700\u521d\u306b\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b100GB\u4ee5\u4e0a\u306e\u30c7\u30a3\u30b9\u30af\u3092\u30a2\u30bf\u30c3\u30c1\u3059\u308b\u306e\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\u3002\n\nssh\u63a5\u7d9a\n\u4e8b\u524d\u306bScaleway\u306e\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306eCredentials\u306bSSH\u7528\u306e\u516c\u958b\u9375\u3092\u767b\u9332\u3057\u3066\u3044\u305f\u306e\u3067\u3001\u4f5c\u6210\u3057\u305f\u30de\u30b7\u30f3\u306e\u60c5\u5831\u30da\u30fc\u30b8\u306b\u3042\u308bHOW TO CONNECT ?\u306e\u60c5\u5831\u3067\u63a5\u7d9a\u3067\u304d\u307e\u3057\u305f\u3002\n$ ssh root@YOUR_MACHINE_PUBLIC_IP_ADDRESS\n               _\n ___  ___ __ _| | _____      ____ _ _   _\n/ __|/ __/ _` | |/ _ \\ \\ /\\ / / _` | | | |\n\\__ \\ (_| (_| | |  __/\\ V  V / (_| | |_| |\n|___/\\___\\__,_|_|\\___| \\_/\\_/ \\__,_|\\__, |\n                                    |___/\n\n\nmicroPCF\u306e\u6e96\u5099\n\nVagrant\u74b0\u5883\u6e96\u5099\n\u307e\u305a\u306fvirtualbox\u74b0\u5883\u3092\u6e96\u5099\u3057\u307e\u3059\n# echo 'deb http://download.virtualbox.org/virtualbox/debian trusty contrib' >> /etc/apt/sources.list\n# wget https://www.virtualbox.org/download/oracle_vbox.asc\n# apt-key add oracle_vbox.asc\n# apt-get update\n\n\u305d\u306e\u307e\u307e\u3060\u3068kernel\u304c\u65b0\u3057\u3044\u3082\u306e\u304c\u4f7f\u308f\u308c\u3066\u3044\u308b\u70ba\uff1f\u304b\nlinux-headers\u307e\u308f\u308a\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u3066VirutualBox\u304c\u3059\u3093\u306a\u308a\u5165\u3063\u3066\u304f\u308c\u306a\u304b\u3063\u305f\u306e\u3067\u4ee5\u4e0b\u3092\u5b9f\u65bd\u3057\u305f\u3002\n\u203b\u53c2\u8003: https://github.com/scaleway/kernel-tools\n# apt-get install build-essential libssl-dev\n\n\u4ee5\u4e0b\u3092\u30b3\u30d4\u30da\u3057\u3066\u305f\u305f\u304f\n# Determine versions\narch=\"$(uname -m)\"\nrelease=\"$(uname -r)\"\nupstream=\"${release%%-*}\"\nlocal=\"${release#*-}\"\n\n# Get kernel sources\nmkdir -p /usr/src\nwget -O \"/usr/src/linux-${upstream}.tar.xz\" \"https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-${upstream}.tar.xz\"\ntar xf \"/usr/src/linux-${upstream}.tar.xz\" -C /usr/src/\nln -fns \"/usr/src/linux-${upstream}\" /usr/src/linux\nln -fns \"/usr/src/linux-${upstream}\" \"/lib/modules/${release}/build\"\n\n# Prepare kernel\nzcat /proc/config.gz > /usr/src/linux/.config\nprintf 'CONFIG_LOCALVERSION=\"%s\"\\nCONFIG_CROSS_COMPILE=\"\"\\n' \"${local:+-$local}\" >> /usr/src/linux/.config\nwget -O /usr/src/linux/Module.symvers \"http://mirror.scaleway.com/kernel/${arch}/${release}/Module.symvers\"\nmake -C /usr/src/linux prepare modules_prepare\n\nvirtualbox-5.0\u3092\u5165\u308c\u308b\n# apt-get install virtualbox-5.0\n\nVirtualBox_Extension_Pack\u3092\u5165\u308c\u308b\n# wget http://download.virtualbox.org/virtualbox/5.0.16/Oracle_VM_VirtualBox_Extension_Pack-5.0.16-105871.vbox-extpack\n# VBoxManage extpack install Oracle_VM_VirtualBox_Extension_Pack-5.0.16-105871.vbox-extpack\n\n\u7d9a\u3044\u3066vagrant\u74b0\u5883\u306e\u6e96\u5099\n# wget https://releases.hashicorp.com/vagrant/1.8.1/vagrant_1.8.1_x86_64.deb\n# dpkg -i vagrant_1.8.1_x86_64.deb\n\nmicropcf\u306e\u8d77\u52d5\nhttps://github.com/pivotal-cf/micropcf\n# wget https://github.com/pivotal-cf/micropcf/releases/download/v0.6.0/micropcf-v0.6.0.zip\n# apt-get install zip\n# unzip micropcf-v0.6.0.zip\n# cd micropcf-v0.6.0/\n# vagrant up --provider=virtualbox\nBringing machine 'default' up with 'virtualbox' provider...\n==> default: Box 'micropcf/micropcf' could not be found. Attempting to find and install.\n..\n    default: Box Provider: virtualbox\n    default: Box Version: 0.14.0\n==> default: Loading metadata for box 'micropcf/micropcf'\n    default: URL: https://atlas.hashicorp.com/micropcf/micropcf\n==> default: Adding box 'micropcf/micropcf' (v0.14.0) for provider: virtualbox\n    default: Downloading: https://atlas.hashicorp.com/micropcf/boxes/micropcf/versions/0\n.14.0/providers/virtualbox.box\n==> default: Successfully added box 'micropcf/micropcf' (v0.14.0) for 'virtualbox'!\n==> default: Importing base box 'micropcf/micropcf'...\n==> default: Matching MAC address for NAT networking...\n==> default: Checking if box 'micropcf/micropcf' is up to date...\n==> default: Setting the name of the VM: micropcf-v060_default_1457781886195_16572\n==> default: Clearing any previously set network interfaces...\n==> default: Preparing network interfaces based on configuration...\n    default: Adapter 1: nat\n    default: Adapter 2: hostonly\n==> default: Forwarding ports...\n    default: 22 (guest) => 2222 (host) (adapter 1)\n==> default: Running 'pre-boot' VM customizations...\n==> default: Booting VM...\n==> default: Waiting for machine to boot. This may take a few minutes...\n    default: SSH address: 127.0.0.1:2222\n    default: SSH username: vagrant\n    default: SSH auth method: private key\n    default:\n    default: Vagrant insecure key detected. Vagrant will automatically replace\n    default: this with a newly generated keypair for better security.\n    default:\n    default: Inserting generated public key within guest...\n    default: Removing insecure key from the guest if it's present...\n    default: Key inserted! Disconnecting and reconnecting using new SSH key...\n==> default: Machine booted and ready!\n==> default: Checking for guest additions in VM...\n==> default: Configuring and enabling network interfaces...\n==> default: Running provisioner: shell...\n    default: Running: inline script\n==> default: stdin: is not a tty\n==> default: Waiting for services to start...\n\n==> default: MicroPCF is now running.\n==> default: To begin using MicroPCF, please run:\n==> default:    cf api api.local.micropcf.io --skip-ssl-validation\n==> default:    cf login\n==> default: Email: admin\n==> default: Password: admin\n==> default: Don't have the cf command line utility? Download it from https://github.com/cloudfoundry/cli/releases\n\n\u203b ==> default: Waiting for services to start... \u306e\u90e8\u5206\u3067\u304a\u305d\u3089\u304fCPU\u304c\u305d\u3053\u307e\u3067\u30cf\u30a4\u30b9\u30da\u30c3\u30af\u3067\u306a\u3044\u70ba10-20\u5206?\u307b\u3069\u9032\u6357\u304c\u6b62\u307e\u3063\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u307e\u3057\u305f\u304c\u305d\u306e\u307e\u307e\u5f85\u3061\u307e\u3059\u3002\n\nCloud Foundry\u306ecli\u306e\u5c0e\u5165\n\u3072\u3068\u307e\u305a\u6700\u65b0\u7248\u306ev6.16.1\u3092\u5165\u308c\u307e\u3059\nhttps://github.com/cloudfoundry/cli/releases\n# wget -O cf-cli-installer_6.16.1_x86-64.deb \"https://cli.run.pivotal.io/stable?release=debian64&version=6.16.1&source=github-rel\"\n# dpkg -i cf-cli-installer_6.16.1_x86-64.deb\n# cf -v\ncf version 6.16.1+924508c-2016-02-26\n\n\nCloud Foundry\u306b\u30ed\u30b0\u30a4\u30f3\n# cf login -a api.local.micropcf.io -u admin -p admin --skip-ssl-validation\n\n\n\nCloud Foundry\u3092\u4f7f\u3063\u3066\u307f\u308b\n\n\u30a2\u30d7\u30ea\u3092push\n\u8a66\u3057\u306bCloud Foundry\u306e\u691c\u8a3c\u3067\u3088\u304f\u4f7f\u308f\u308c\u308bdora\u3068\u3044\u3046\u30a2\u30d7\u30ea\u3092Cloud Foundry\u4e0a\u306bpush\u3057\u307e\u3059\ngit\u3092\u5165\u308c\u308b\n# apt-get install git -y\n\n\u30bd\u30fc\u30b9\u3092clone\u3059\u308b\n# git clone https://github.com/cloudfoundry/cf-acceptance-tests.git\n# cd cf-acceptance-tests/assets/dora/\n\ndora\u3092push\n# cf push dora\n\n\n\u30a2\u30d7\u30ea\u306b\u30a2\u30af\u30bb\u30b9\n# curl dora.local.micropcf.io\nHi, I'm Dora!\n\n\n\u6210\u529f\u3057\u307e\u3057\u305f\uff01\nmicroPCF\u3092\u7acb\u3066\u308b\u76ee\u7684\u306f\u9054\u3057\u305f\u306e\u3067\u3001\u5f8c\u306fScaleway C2\u30b5\u30fc\u30d0\u304c\u3069\u3093\u306a\u611f\u3058\u306e\u69cb\u6210\u304b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30b3\u30de\u30f3\u30c9\u304b\u3089\u898b\u3048\u308b\u30de\u30b7\u30f3\u60c5\u5831\n\nuname\n# uname -a\nLinux scw-2ac7be 4.4.4-std-3 #1 SMP Tue Mar 8 17:31:34 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n\n\ncpuinfo\nroot@scw-2ac7be:~/micropcf-v0.6.0# cat /proc/cpuinfo\nprocessor       : 0\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 77\nmodel name      : Intel(R) Atom(TM) CPU  C2550  @ 2.40GHz\nstepping        : 8\nmicrocode       : 0x127\ncpu MHz         : 2393.902\ncache size      : 1024 KB\nphysical id     : 0\nsiblings        : 4\ncore id         : 0\ncpu cores       : 4\napicid          : 0\ninitial apicid  : 0\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 11\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch ida arat epb dtherm tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms\nbugs            :\nbogomips        : 4787.80\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 36 bits physical, 48 bits virtual\npower management:\n\nprocessor       : 1\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 77\nmodel name      : Intel(R) Atom(TM) CPU  C2550  @ 2.40GHz\nstepping        : 8\nmicrocode       : 0x127\ncpu MHz         : 2393.902\ncache size      : 1024 KB\nphysical id     : 0\nsiblings        : 4\ncore id         : 1\ncpu cores       : 4\napicid          : 2\ninitial apicid  : 2\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 11\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch ida arat epb dtherm tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms\nbugs            :\nbogomips        : 4787.80\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 36 bits physical, 48 bits virtual\npower management:\n\nprocessor       : 2\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 77\nmodel name      : Intel(R) Atom(TM) CPU  C2550  @ 2.40GHz\nstepping        : 8\nmicrocode       : 0x127\ncpu MHz         : 2393.902\ncache size      : 1024 KB\nphysical id     : 0\nsiblings        : 4\ncore id         : 2\ncpu cores       : 4\napicid          : 4\ninitial apicid  : 4\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 11\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch ida arat epb dtherm tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms\nbugs            :\nbogomips        : 4787.80\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 36 bits physical, 48 bits virtual\npower management:\n\nprocessor       : 3\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 77\nmodel name      : Intel(R) Atom(TM) CPU  C2550  @ 2.40GHz\nstepping        : 8\nmicrocode       : 0x127\ncpu MHz         : 2393.902\ncache size      : 1024 KB\nphysical id     : 0\nsiblings        : 4\ncore id         : 3\ncpu cores       : 4\napicid          : 6\ninitial apicid  : 6\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 11\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch ida arat epb dtherm tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms\nbugs            :\nbogomips        : 4787.80\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 36 bits physical, 48 bits virtual\npower management:\n\n\nmeminfo\n# cat /proc/meminfo\nMemTotal:        8130800 kB\nMemFree:          130376 kB\nMemAvailable:    3625532 kB\nBuffers:            9140 kB\nCached:          3588808 kB\nSwapCached:            0 kB\nActive:           701624 kB\nInactive:        2967872 kB\nActive(anon):      73156 kB\nInactive(anon):    12580 kB\nActive(file):     628468 kB\nInactive(file):  2955292 kB\nUnevictable:        1460 kB\nMlocked:               0 kB\nSwapTotal:             0 kB\nSwapFree:              0 kB\nDirty:              1904 kB\nWriteback:             0 kB\nAnonPages:         73108 kB\nMapped:          4137400 kB\nShmem:             12660 kB\nSlab:             197008 kB\nSReclaimable:     150408 kB\nSUnreclaim:        46600 kB\nKernelStack:        2272 kB\nPageTables:        11084 kB\nNFS_Unstable:          0 kB\nBounce:                0 kB\nWritebackTmp:          0 kB\nCommitLimit:     4065400 kB\nCommitted_AS:    4327064 kB\nVmallocTotal:   34359738367 kB\nVmallocUsed:           0 kB\nVmallocChunk:          0 kB\nDirectMap4k:       11264 kB\nDirectMap2M:     8339456 kB\n\n\n\u307e\u3068\u3081\n\n\u307e\u3060\u30e6\u30fc\u30b6\u6570\u304c\u5c11\u306a\u3044\u70ba\uff1fwget\u306e\u901f\u5ea6\u306a\u3069\u4f53\u611f\u3067\u306f\u6bd4\u8f03\u7684\u901f\u3044\n\u305f\u3060\u3057\u5834\u6240\u304c\u30e8\u30fc\u30ed\u30c3\u30d1\uff1f\u306b\u3042\u308b\u70ba\u3001ping\u306e\u5fdc\u7b54\u306f250ms\u7a0b\u306b\u306f\u306a\u3063\u3066\u3057\u307e\u3059\n\u81ea\u5206\u7528\u306eCloud Foundry\u74b0\u5883\u3092\u8a66\u3059\u306e\u3067\u3042\u308c\u307011.99\u30e6\u30fc\u30ed\uff082016/3/12\u6642\u70b9\u3067\u306f1500\u5186\u3061\u3087\u3063\u3068\uff09\u3067\u683c\u5b89\u3067\u5341\u5206\u306b\u904a\u3079\u308b\u30b9\u30da\u30c3\u30af\u306a\u306e\u30aa\u30b9\u30b9\u30e1\uff01\n\n\n## \u306f\u3058\u3081\u306b\n\n### microPCF\u3068\u306f\n\nCloud Foundry\u306e\u74b0\u5883\u3092\u30ed\u30fc\u30ab\u30eb\u3067Vagrant\u3092\u4f7f\u3063\u3066\u69cb\u7bc9\u51fa\u6765\u308b\u30c4\u30fc\u30eb\u3067\u3001\u30a2\u30d7\u30ea\u958b\u767a\u8005\u304c\u30ed\u30fc\u30ab\u30eb\u3067\u5b9f\u9a13\u3059\u308b\u306e\u306b\u4fbf\u5229\u3067\u3059\u3002\n\n\u53c2\u8003:\n[BLOG.IK.AM\u3000MicroPCF\u3067\u30ed\u30fc\u30ab\u30ebCloudFoundry\u74b0\u5883\u3092\u4f5c\u308b](https://blog.ik.am/entries/361)\n[microPCF\u3092\u4f7f\u3063\u3066\u307f\u3088\u3046](http://www.slideshare.net/Hiroaki_UKAJI/micropcf)\n\n### Scaleway\u306eC2\u30b5\u30fc\u30d0\u3068\u306f\n\n2016\u5e743\u670810\u65e5\u6642\u70b9\u3067\u77e5\u3063\u305f\u306e\u3067\u3059\u304c\u3001ARM\u306e\u30de\u30b7\u30f3\u8cb8\u3057\u3067\u4e00\u90e8\u3067\u8a71\u984c\u306b\u306a\u3063\u305fScaleway\u306e\u65b0\u30b5\u30fc\u30d3\u30b9\u3068\u3057\u3066\nC2\u30b5\u30fc\u30d0\u3068\u547c\u3070\u308c\u308bx86-64\u306e\u6700\u5c0f\u30d7\u30e9\u30f311.99\u30e6\u30fc\u30ed\uff081500\u5186\u7a0b\uff1f\uff09\u3067\n4core 8GB\u30e1\u30e2\u30ea\u3068\u3044\u3046\u6bd4\u8f03\u7684\u9b45\u529b\u7684\u306a\u30b5\u30fc\u30d3\u30b9\u304c\u958b\u59cb\u3055\u308c\u305f\u3088\u3046\u3067\u3059\u3002\n\nhttps://blog.scaleway.com/2016/03/08/c2-insanely-affordable-x64-servers/\n\n### \u3053\u306e\u76ee\u6a19\n\nARM\u306e\u30de\u30b7\u30f3\u3092\u501f\u308a\u3089\u308c\u308bC1\u306e\u30d7\u30e9\u30f3\u306f\u4ee5\u524d\u306b\u8a66\u3057\u305f\u3053\u3068\u304c\u3042\u3063\u305f\u306e\u3067\u3001\n\u4eca\u56de\u306f\u3055\u304f\u3063\u3068C2\u3092\u501f\u308a\u3066microPCF\u3092\u4f7f\u3044\n\u300e\u683c\u5b89\u306e\u81ea\u5206\u5c02\u7528Cloud Foundry\u74b0\u5883\u3092\u7acb\u3066\u3089\u308c\u306a\u3044\u304b\uff1f\u300f\u3068\u3044\u3046\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## \u69cb\u7bc9\n\n### \u30b5\u30fc\u30d0\u4f5c\u6210\nc2\u30b5\u30fc\u30d0\u306eubuntu trusty\u306e\u30a4\u30e1\u30fc\u30b8\u3092\u9078\u629e\u3057\u307e\u3059\n\n![c2-server-create.PNG](https://qiita-image-store.s3.amazonaws.com/0/37192/491618a6-a8fb-f8ec-8de7-f1d55ec327db.png)\n\n**\u203b\u8ffd\u52a0\u60c5\u5831(2016/3/27)**\n\u5b9f\u969b\u306bCloud Foundry\u3092\u52d5\u304b\u3057\u3066\u30a2\u30d7\u30ea\u3092\u3044\u304f\u3064\u304b\u3042\u3052\u3066\n\u6570\u65e5\u69d8\u5b50\u3092\u898b\u3066\u3044\u305f\u306e\u3067\u3059\u304c\u3001\u3084\u306f\u308aVagrant\u306esnapshot\u3084\u540c\u6642\u306b\u7acb\u3061\u4e0a\u3052\u3066\u3044\u308bService Broker\u7528\u306edocker\u306a\u3069\u306b\u3088\u3063\u3066\u3001\u30c7\u30a3\u30b9\u30af\u30b5\u30a4\u30ba\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e50GB\u306e\u307f\u3060\u3068\u30c7\u30a3\u30b9\u30af\u304c\u8db3\u308a\u306a\u304f\u306a\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u305d\u306e\u70ba\u300150GB\u3042\u305f\u308a\u207a1\u30e6\u30fc\u30ed\u3068\u306a\u308a2\u30e6\u30fc\u30ed\u4f59\u5206\u306b\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u304c\u3001\u6700\u521d\u306b\u30de\u30b7\u30f3\u3092\u4f5c\u6210\u3059\u308b\u969b\u306b100GB\u4ee5\u4e0a\u306e\u30c7\u30a3\u30b9\u30af\u3092\u30a2\u30bf\u30c3\u30c1\u3059\u308b\u306e\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\u3002\n\n### ssh\u63a5\u7d9a\n\n\u4e8b\u524d\u306bScaleway\u306e\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306eCredentials\u306bSSH\u7528\u306e\u516c\u958b\u9375\u3092\u767b\u9332\u3057\u3066\u3044\u305f\u306e\u3067\u3001\u4f5c\u6210\u3057\u305f\u30de\u30b7\u30f3\u306e\u60c5\u5831\u30da\u30fc\u30b8\u306b\u3042\u308b`HOW TO CONNECT ?`\u306e\u60c5\u5831\u3067\u63a5\u7d9a\u3067\u304d\u307e\u3057\u305f\u3002\n\n```bash\n$ ssh root@YOUR_MACHINE_PUBLIC_IP_ADDRESS\n               _\n ___  ___ __ _| | _____      ____ _ _   _\n/ __|/ __/ _` | |/ _ \\ \\ /\\ / / _` | | | |\n\\__ \\ (_| (_| | |  __/\\ V  V / (_| | |_| |\n|___/\\___\\__,_|_|\\___| \\_/\\_/ \\__,_|\\__, |\n                                    |___/\n```\n\n### microPCF\u306e\u6e96\u5099\n\n#### Vagrant\u74b0\u5883\u6e96\u5099\n\n\u307e\u305a\u306fvirtualbox\u74b0\u5883\u3092\u6e96\u5099\u3057\u307e\u3059\n\n```bash\n# echo 'deb http://download.virtualbox.org/virtualbox/debian trusty contrib' >> /etc/apt/sources.list\n# wget https://www.virtualbox.org/download/oracle_vbox.asc\n# apt-key add oracle_vbox.asc\n# apt-get update\n```\n\n\u305d\u306e\u307e\u307e\u3060\u3068kernel\u304c\u65b0\u3057\u3044\u3082\u306e\u304c\u4f7f\u308f\u308c\u3066\u3044\u308b\u70ba\uff1f\u304b\nlinux-headers\u307e\u308f\u308a\u306e\u30a8\u30e9\u30fc\u304c\u51fa\u3066VirutualBox\u304c\u3059\u3093\u306a\u308a\u5165\u3063\u3066\u304f\u308c\u306a\u304b\u3063\u305f\u306e\u3067\u4ee5\u4e0b\u3092\u5b9f\u65bd\u3057\u305f\u3002\n\n\u203b\u53c2\u8003: https://github.com/scaleway/kernel-tools\n\n```bash\n# apt-get install build-essential libssl-dev\n```\n\n\u4ee5\u4e0b\u3092\u30b3\u30d4\u30da\u3057\u3066\u305f\u305f\u304f\n\n```bash\n# Determine versions\narch=\"$(uname -m)\"\nrelease=\"$(uname -r)\"\nupstream=\"${release%%-*}\"\nlocal=\"${release#*-}\"\n\n# Get kernel sources\nmkdir -p /usr/src\nwget -O \"/usr/src/linux-${upstream}.tar.xz\" \"https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-${upstream}.tar.xz\"\ntar xf \"/usr/src/linux-${upstream}.tar.xz\" -C /usr/src/\nln -fns \"/usr/src/linux-${upstream}\" /usr/src/linux\nln -fns \"/usr/src/linux-${upstream}\" \"/lib/modules/${release}/build\"\n\n# Prepare kernel\nzcat /proc/config.gz > /usr/src/linux/.config\nprintf 'CONFIG_LOCALVERSION=\"%s\"\\nCONFIG_CROSS_COMPILE=\"\"\\n' \"${local:+-$local}\" >> /usr/src/linux/.config\nwget -O /usr/src/linux/Module.symvers \"http://mirror.scaleway.com/kernel/${arch}/${release}/Module.symvers\"\nmake -C /usr/src/linux prepare modules_prepare\n```\nvirtualbox-5.0\u3092\u5165\u308c\u308b\n\n```bash\n# apt-get install virtualbox-5.0\n```\n\nVirtualBox_Extension_Pack\u3092\u5165\u308c\u308b\n\n```bash\n# wget http://download.virtualbox.org/virtualbox/5.0.16/Oracle_VM_VirtualBox_Extension_Pack-5.0.16-105871.vbox-extpack\n# VBoxManage extpack install Oracle_VM_VirtualBox_Extension_Pack-5.0.16-105871.vbox-extpack\n```\n\n\n\u7d9a\u3044\u3066vagrant\u74b0\u5883\u306e\u6e96\u5099\n\n```bash\n# wget https://releases.hashicorp.com/vagrant/1.8.1/vagrant_1.8.1_x86_64.deb\n# dpkg -i vagrant_1.8.1_x86_64.deb\n```\n\nmicropcf\u306e\u8d77\u52d5\nhttps://github.com/pivotal-cf/micropcf\n\n```bash\n# wget https://github.com/pivotal-cf/micropcf/releases/download/v0.6.0/micropcf-v0.6.0.zip\n# apt-get install zip\n# unzip micropcf-v0.6.0.zip\n# cd micropcf-v0.6.0/\n# vagrant up --provider=virtualbox\nBringing machine 'default' up with 'virtualbox' provider...\n==> default: Box 'micropcf/micropcf' could not be found. Attempting to find and install.\n..\n    default: Box Provider: virtualbox\n    default: Box Version: 0.14.0\n==> default: Loading metadata for box 'micropcf/micropcf'\n    default: URL: https://atlas.hashicorp.com/micropcf/micropcf\n==> default: Adding box 'micropcf/micropcf' (v0.14.0) for provider: virtualbox\n    default: Downloading: https://atlas.hashicorp.com/micropcf/boxes/micropcf/versions/0\n.14.0/providers/virtualbox.box\n==> default: Successfully added box 'micropcf/micropcf' (v0.14.0) for 'virtualbox'!\n==> default: Importing base box 'micropcf/micropcf'...\n==> default: Matching MAC address for NAT networking...\n==> default: Checking if box 'micropcf/micropcf' is up to date...\n==> default: Setting the name of the VM: micropcf-v060_default_1457781886195_16572\n==> default: Clearing any previously set network interfaces...\n==> default: Preparing network interfaces based on configuration...\n    default: Adapter 1: nat\n    default: Adapter 2: hostonly\n==> default: Forwarding ports...\n    default: 22 (guest) => 2222 (host) (adapter 1)\n==> default: Running 'pre-boot' VM customizations...\n==> default: Booting VM...\n==> default: Waiting for machine to boot. This may take a few minutes...\n    default: SSH address: 127.0.0.1:2222\n    default: SSH username: vagrant\n    default: SSH auth method: private key\n    default:\n    default: Vagrant insecure key detected. Vagrant will automatically replace\n    default: this with a newly generated keypair for better security.\n    default:\n    default: Inserting generated public key within guest...\n    default: Removing insecure key from the guest if it's present...\n    default: Key inserted! Disconnecting and reconnecting using new SSH key...\n==> default: Machine booted and ready!\n==> default: Checking for guest additions in VM...\n==> default: Configuring and enabling network interfaces...\n==> default: Running provisioner: shell...\n    default: Running: inline script\n==> default: stdin: is not a tty\n==> default: Waiting for services to start...\n\n==> default: MicroPCF is now running.\n==> default: To begin using MicroPCF, please run:\n==> default:    cf api api.local.micropcf.io --skip-ssl-validation\n==> default:    cf login\n==> default: Email: admin\n==> default: Password: admin\n==> default: Don't have the cf command line utility? Download it from https://github.com/cloudfoundry/cli/releases\n```\n\u203b `==> default: Waiting for services to start...` \u306e\u90e8\u5206\u3067\u304a\u305d\u3089\u304fCPU\u304c\u305d\u3053\u307e\u3067\u30cf\u30a4\u30b9\u30da\u30c3\u30af\u3067\u306a\u3044\u70ba10-20\u5206?\u307b\u3069\u9032\u6357\u304c\u6b62\u307e\u3063\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u307e\u3057\u305f\u304c\u305d\u306e\u307e\u307e\u5f85\u3061\u307e\u3059\u3002\n\n### Cloud Foundry\u306ecli\u306e\u5c0e\u5165\n\n\u3072\u3068\u307e\u305a\u6700\u65b0\u7248\u306e`v6.16.1`\u3092\u5165\u308c\u307e\u3059\nhttps://github.com/cloudfoundry/cli/releases\n\n```bash\n# wget -O cf-cli-installer_6.16.1_x86-64.deb \"https://cli.run.pivotal.io/stable?release=debian64&version=6.16.1&source=github-rel\"\n# dpkg -i cf-cli-installer_6.16.1_x86-64.deb\n# cf -v\ncf version 6.16.1+924508c-2016-02-26\n```\n\n### Cloud Foundry\u306b\u30ed\u30b0\u30a4\u30f3\n\n```bash\n# cf login -a api.local.micropcf.io -u admin -p admin --skip-ssl-validation\n```\n![cf-login-ok.PNG](https://qiita-image-store.s3.amazonaws.com/0/37192/0466ec34-dbe8-9b30-ad04-b3b1c9f9cca0.png)\n\n\n## Cloud Foundry\u3092\u4f7f\u3063\u3066\u307f\u308b\n\n### \u30a2\u30d7\u30ea\u3092push\n\u8a66\u3057\u306bCloud Foundry\u306e\u691c\u8a3c\u3067\u3088\u304f\u4f7f\u308f\u308c\u308bdora\u3068\u3044\u3046\u30a2\u30d7\u30ea\u3092Cloud Foundry\u4e0a\u306bpush\u3057\u307e\u3059\n\ngit\u3092\u5165\u308c\u308b\n\n```bash\n# apt-get install git -y\n```\n\n\u30bd\u30fc\u30b9\u3092clone\u3059\u308b\n\n```bash\n# git clone https://github.com/cloudfoundry/cf-acceptance-tests.git\n# cd cf-acceptance-tests/assets/dora/\n```\n\ndora\u3092push\n\n```bash\n# cf push dora\n```\n![scaleway-push-dora-ok.PNG](https://qiita-image-store.s3.amazonaws.com/0/37192/8cb199f8-d646-c6c8-e2fe-3e2605d2730c.png)\n\n\n\u30a2\u30d7\u30ea\u306b\u30a2\u30af\u30bb\u30b9\n\n```bash\n# curl dora.local.micropcf.io\nHi, I'm Dora!\n```\n\n![curl-dora-ok.PNG](https://qiita-image-store.s3.amazonaws.com/0/37192/755ff157-27e4-9a51-9fcc-e645006ecf2b.png)\n\n\u6210\u529f\u3057\u307e\u3057\u305f\uff01\n\nmicroPCF\u3092\u7acb\u3066\u308b\u76ee\u7684\u306f\u9054\u3057\u305f\u306e\u3067\u3001\u5f8c\u306fScaleway C2\u30b5\u30fc\u30d0\u304c\u3069\u3093\u306a\u611f\u3058\u306e\u69cb\u6210\u304b\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## \u30b3\u30de\u30f3\u30c9\u304b\u3089\u898b\u3048\u308b\u30de\u30b7\u30f3\u60c5\u5831\n\n### uname\n\n```bash\n# uname -a\nLinux scw-2ac7be 4.4.4-std-3 #1 SMP Tue Mar 8 17:31:34 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n```\n\n### cpuinfo\n\n```bash\nroot@scw-2ac7be:~/micropcf-v0.6.0# cat /proc/cpuinfo\nprocessor       : 0\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 77\nmodel name      : Intel(R) Atom(TM) CPU  C2550  @ 2.40GHz\nstepping        : 8\nmicrocode       : 0x127\ncpu MHz         : 2393.902\ncache size      : 1024 KB\nphysical id     : 0\nsiblings        : 4\ncore id         : 0\ncpu cores       : 4\napicid          : 0\ninitial apicid  : 0\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 11\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch ida arat epb dtherm tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms\nbugs            :\nbogomips        : 4787.80\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 36 bits physical, 48 bits virtual\npower management:\n\nprocessor       : 1\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 77\nmodel name      : Intel(R) Atom(TM) CPU  C2550  @ 2.40GHz\nstepping        : 8\nmicrocode       : 0x127\ncpu MHz         : 2393.902\ncache size      : 1024 KB\nphysical id     : 0\nsiblings        : 4\ncore id         : 1\ncpu cores       : 4\napicid          : 2\ninitial apicid  : 2\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 11\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch ida arat epb dtherm tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms\nbugs            :\nbogomips        : 4787.80\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 36 bits physical, 48 bits virtual\npower management:\n\nprocessor       : 2\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 77\nmodel name      : Intel(R) Atom(TM) CPU  C2550  @ 2.40GHz\nstepping        : 8\nmicrocode       : 0x127\ncpu MHz         : 2393.902\ncache size      : 1024 KB\nphysical id     : 0\nsiblings        : 4\ncore id         : 2\ncpu cores       : 4\napicid          : 4\ninitial apicid  : 4\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 11\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch ida arat epb dtherm tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms\nbugs            :\nbogomips        : 4787.80\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 36 bits physical, 48 bits virtual\npower management:\n\nprocessor       : 3\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 77\nmodel name      : Intel(R) Atom(TM) CPU  C2550  @ 2.40GHz\nstepping        : 8\nmicrocode       : 0x127\ncpu MHz         : 2393.902\ncache size      : 1024 KB\nphysical id     : 0\nsiblings        : 4\ncore id         : 3\ncpu cores       : 4\napicid          : 6\ninitial apicid  : 6\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 11\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch ida arat epb dtherm tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms\nbugs            :\nbogomips        : 4787.80\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 36 bits physical, 48 bits virtual\npower management:\n```\n\n### meminfo\n\n```bash\n# cat /proc/meminfo\nMemTotal:        8130800 kB\nMemFree:          130376 kB\nMemAvailable:    3625532 kB\nBuffers:            9140 kB\nCached:          3588808 kB\nSwapCached:            0 kB\nActive:           701624 kB\nInactive:        2967872 kB\nActive(anon):      73156 kB\nInactive(anon):    12580 kB\nActive(file):     628468 kB\nInactive(file):  2955292 kB\nUnevictable:        1460 kB\nMlocked:               0 kB\nSwapTotal:             0 kB\nSwapFree:              0 kB\nDirty:              1904 kB\nWriteback:             0 kB\nAnonPages:         73108 kB\nMapped:          4137400 kB\nShmem:             12660 kB\nSlab:             197008 kB\nSReclaimable:     150408 kB\nSUnreclaim:        46600 kB\nKernelStack:        2272 kB\nPageTables:        11084 kB\nNFS_Unstable:          0 kB\nBounce:                0 kB\nWritebackTmp:          0 kB\nCommitLimit:     4065400 kB\nCommitted_AS:    4327064 kB\nVmallocTotal:   34359738367 kB\nVmallocUsed:           0 kB\nVmallocChunk:          0 kB\nDirectMap4k:       11264 kB\nDirectMap2M:     8339456 kB\n```\n\n## \u307e\u3068\u3081\n* \u307e\u3060\u30e6\u30fc\u30b6\u6570\u304c\u5c11\u306a\u3044\u70ba\uff1fwget\u306e\u901f\u5ea6\u306a\u3069\u4f53\u611f\u3067\u306f\u6bd4\u8f03\u7684\u901f\u3044\n* \u305f\u3060\u3057\u5834\u6240\u304c\u30e8\u30fc\u30ed\u30c3\u30d1\uff1f\u306b\u3042\u308b\u70ba\u3001ping\u306e\u5fdc\u7b54\u306f`250ms\u7a0b`\u306b\u306f\u306a\u3063\u3066\u3057\u307e\u3059\n* \u81ea\u5206\u7528\u306eCloud Foundry\u74b0\u5883\u3092\u8a66\u3059\u306e\u3067\u3042\u308c\u307011.99\u30e6\u30fc\u30ed\uff082016/3/12\u6642\u70b9\u3067\u306f1500\u5186\u3061\u3087\u3063\u3068\uff09\u3067\u683c\u5b89\u3067\u5341\u5206\u306b\u904a\u3079\u308b\u30b9\u30da\u30c3\u30af\u306a\u306e\u30aa\u30b9\u30b9\u30e1\uff01\n"}