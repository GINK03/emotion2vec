{"context": "Python\u3092\u7528\u3044\u305fOpenCV\u3067\u64ae\u5f71\u3057\u305f\u52d5\u753b\u306e\u30d5\u30ec\u30fc\u30e0\u9593\u306e\u5dee\u5206\u3092\u767d\u9ed2\u306e\u52d5\u753b\u3068\u3057\u3066\u51fa\u529b\u3057\u3001\u305d\u306e\u767d\u9ed2\u306e\u52d5\u753b\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u751f\u6210\u3055\u308c\u305f\u306e\u3067\u3059\u304c\u3001\u518d\u751f\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u72b6\u6cc1\u3067\u3059\u3002 \n\u30c7\u30d5\u30a9\u30eb\u30c8\u306eOpenCV\u3067\u306f\u7121\u5727\u7e2e\u306eavi\u30d5\u30a1\u30a4\u30eb\u3057\u304b\u518d\u751f\u3067\u304d\u306a\u3044\u3068\u66f8\u3044\u3066\u3042\u308b\u306e\u3092\u898b\u305f\u3053\u3068\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3069\u3046\u5bfe\u51e6\u3057\u3066\u3044\u3044\u304b\u308f\u304b\u3089\u306a\u3044\u306e\u3067\u6559\u3048\u3066\u9802\u304d\u305f\u3044\u3067\u3059\u3002\n\n-- codig: utf-8 --\nimport cv2\nimport time\nimport numpy as np\ndef flame_sub(im1,im2,im3,th,blur):\nd1 = cv2.absdiff(im3, im2)\nd2 = cv2.absdiff(im2, im1)\ndiff = cv2.bitwise_and(d1, d2)\n\n\u5dee\u5206\u304c\u95be\u5024\u3088\u308a\u5c0f\u3055\u3051\u308c\u3070True\nmask = diff < th\n\n\u80cc\u666f\u753b\u50cf\u3068\u540c\u3058\u30b5\u30a4\u30ba\u306e\u914d\u5217\u751f\u6210\nim_mask = np.empty((im1.shape[0],im1.shape[1]),np.uint8)\nim_mask[:][:]=255\n\nTrue\u306e\u90e8\u5206\uff08\u80cc\u666f\uff09\u306f\u9ed2\u5857\u308a\nim_mask[mask]=0\n\n\u30b4\u30de\u5869\u30ce\u30a4\u30ba\u9664\u53bb\nim_mask = cv2.medianBlur(im_mask,blur)\nreturn im_mask\nif name == 'main':\ncam = cv2.VideoCapture(\"toukasoku_movie.mp4\")\nim1 = cv2.cvtColor(cam.read()[1], cv2.COLOR_RGB2GRAY)\nim2 = cv2.cvtColor(cam.read()[1], cv2.COLOR_RGB2GRAY)\nim3 = cv2.cvtColor(cam.read()[1], cv2.COLOR_RGB2GRAY)\nout = cv2.VideoWriter('output_toukasoku.avi',-1, 20.0, (640,480))\nwhile True:\nret,frame = cam.read()\n\n\u30d5\u30ec\u30fc\u30e0\u9593\u5dee\u5206\u8a08\u7b97\nim_fs = flame_sub(im1,im2,im3,5,7)\nim1 = im2\nim2 = im3\nim3 = cv2.cvtColor(cam.read()[1], cv2.COLOR_RGB2GRAY)\nout.write(frame)\ncv2.imshow(\"Motion Mask2\",im_fs)\n\n\u30d5\u30ec\u30fc\u30e0\u9593\u5dee\u5206\u7d42\u4e86\nif cv2.waitKey(100) & 0xFF == ord('q'):\ncam.release()\nout.release()\ncv2.destroyAllWindows()\nbreak\ndef flame_sub2(im4,im5,im6,th2,blur2):\nd3 = cv2.absdiff(im6, im5)\nd4 = cv2.absdiff(im5, im4)\ndiff2 = cv2.bitwise_and(d3, d4)\n\n\u5dee\u5206\u304c\u95be\u5024\u3088\u308a\u5c0f\u3055\u3051\u308c\u3070True\nmask2 = diff2 < th2\n\n\u80cc\u666f\u753b\u50cf\u3068\u540c\u3058\u30b5\u30a4\u30ba\u306e\u914d\u5217\u751f\u6210\nim_mask2 = np.empty((im4.shape[0],im4.shape[1]),np.uint8)\nim_mask2[:][:]=255\n\nTrue\u306e\u90e8\u5206\uff08\u80cc\u666f\uff09\u306f\u9ed2\u5857\u308a\nim_mask2[mask]=0\n\n\u30b4\u30de\u5869\u30ce\u30a4\u30ba\u9664\u53bb\nim_mask2 = cv2.medianBlur(im_mask2,blur2)\nreturn im_mask2\nif name == 'main':\ncam2 = cv2.VideoCapture(\"Frame_detection.MP4\")\nim4 = cv2.cvtColor(cam2.read()[1], cv2.COLOR_RGB2GRAY)\nim5 = cv2.cvtColor(cam2.read()[1], cv2.COLOR_RGB2GRAY)\nim6 = cv2.cvtColor(cam2.read()[1], cv2.COLOR_RGB2GRAY)\nwhile True:\n\n\u30d5\u30ec\u30fc\u30e0\u9593\u5dee\u5206\u306e\u5dee\u5206\u8a08\u7b97\ncv2.imshow(\"Motion Mask3\",cam2)\nim4 = im5\nim5 = im6\nim6 = cv2.cvtColor(cam2.read()[1], cv2.COLOR_RGB2GRAY)\nkey2 = cv2.waitKey(1)\n\n\u30d5\u30ec\u30fc\u30e0\u9593\u5dee\u5206\u306e\u5dee\u5206\u8a08\u7b97\u7d42\u4e86\nif cam == True:\nframe = cv2.flip(frame,0)\nout.write(out)\n\nq\u30ad\u30fc\u304c\u62bc\u3055\u308c\u305f\u3089\nif cv2.waitKey(100) & 0xFF == ord('q'):\ncam.release()\nout.release()\ncv2.destroyAllWindows()\nbreak\nif name == 'main':\nmain() \nPython\u3092\u7528\u3044\u305fOpenCV\u3067\u64ae\u5f71\u3057\u305f\u52d5\u753b\u306e\u30d5\u30ec\u30fc\u30e0\u9593\u306e\u5dee\u5206\u3092\u767d\u9ed2\u306e\u52d5\u753b\u3068\u3057\u3066\u51fa\u529b\u3057\u3001\u305d\u306e\u767d\u9ed2\u306e\u52d5\u753b\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u751f\u6210\u3055\u308c\u305f\u306e\u3067\u3059\u304c\u3001\u518d\u751f\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u72b6\u6cc1\u3067\u3059\u3002 \n\u30c7\u30d5\u30a9\u30eb\u30c8\u306eOpenCV\u3067\u306f\u7121\u5727\u7e2e\u306eavi\u30d5\u30a1\u30a4\u30eb\u3057\u304b\u518d\u751f\u3067\u304d\u306a\u3044\u3068\u66f8\u3044\u3066\u3042\u308b\u306e\u3092\u898b\u305f\u3053\u3068\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3069\u3046\u5bfe\u51e6\u3057\u3066\u3044\u3044\u304b\u308f\u304b\u3089\u306a\u3044\u306e\u3067\u6559\u3048\u3066\u9802\u304d\u305f\u3044\u3067\u3059\u3002\n\n\n\n\n# -*- codig: utf-8 -*-\n\nimport cv2\n\nimport time\n\nimport numpy as np\n\n\n\ndef flame_sub(im1,im2,im3,th,blur):\n\nd1 = cv2.absdiff(im3, im2)\nd2 = cv2.absdiff(im2, im1)\ndiff = cv2.bitwise_and(d1, d2)\n\n# \u5dee\u5206\u304c\u95be\u5024\u3088\u308a\u5c0f\u3055\u3051\u308c\u3070True\n\nmask = diff < th\n\n# \u80cc\u666f\u753b\u50cf\u3068\u540c\u3058\u30b5\u30a4\u30ba\u306e\u914d\u5217\u751f\u6210\n\nim_mask = np.empty((im1.shape[0],im1.shape[1]),np.uint8)\nim_mask[:][:]=255\n\n# True\u306e\u90e8\u5206\uff08\u80cc\u666f\uff09\u306f\u9ed2\u5857\u308a\n\nim_mask[mask]=0\n\n# \u30b4\u30de\u5869\u30ce\u30a4\u30ba\u9664\u53bb\n\nim_mask = cv2.medianBlur(im_mask,blur)\nreturn im_mask\n\n\nif __name__ == '__main__':\n\ncam = cv2.VideoCapture(\"toukasoku_movie.mp4\")\n\nim1 = cv2.cvtColor(cam.read()[1], cv2.COLOR_RGB2GRAY)\nim2 = cv2.cvtColor(cam.read()[1], cv2.COLOR_RGB2GRAY)\nim3 = cv2.cvtColor(cam.read()[1], cv2.COLOR_RGB2GRAY)\n\n\nout = cv2.VideoWriter('output_toukasoku.avi',-1, 20.0, (640,480))\n\nwhile True:\n\nret,frame = cam.read()\n# \u30d5\u30ec\u30fc\u30e0\u9593\u5dee\u5206\u8a08\u7b97\nim_fs = flame_sub(im1,im2,im3,5,7)\nim1 = im2\nim2 = im3\nim3 = cv2.cvtColor(cam.read()[1], cv2.COLOR_RGB2GRAY)\nout.write(frame)\ncv2.imshow(\"Motion Mask2\",im_fs)\n\n# \u30d5\u30ec\u30fc\u30e0\u9593\u5dee\u5206\u7d42\u4e86\n\nif cv2.waitKey(100) & 0xFF == ord('q'):\ncam.release()\nout.release()\ncv2.destroyAllWindows()\nbreak\n\n\ndef flame_sub2(im4,im5,im6,th2,blur2):\n\nd3 = cv2.absdiff(im6, im5)\nd4 = cv2.absdiff(im5, im4)\ndiff2 = cv2.bitwise_and(d3, d4)\n\n# \u5dee\u5206\u304c\u95be\u5024\u3088\u308a\u5c0f\u3055\u3051\u308c\u3070True\n\nmask2 = diff2 < th2\n\n# \u80cc\u666f\u753b\u50cf\u3068\u540c\u3058\u30b5\u30a4\u30ba\u306e\u914d\u5217\u751f\u6210\n\nim_mask2 = np.empty((im4.shape[0],im4.shape[1]),np.uint8)\nim_mask2[:][:]=255\n\n# True\u306e\u90e8\u5206\uff08\u80cc\u666f\uff09\u306f\u9ed2\u5857\u308a\n\nim_mask2[mask]=0\n\n# \u30b4\u30de\u5869\u30ce\u30a4\u30ba\u9664\u53bb\n\nim_mask2 = cv2.medianBlur(im_mask2,blur2)\nreturn im_mask2\n\n\nif __name__ == '__main__':\n\ncam2 = cv2.VideoCapture(\"Frame_detection.MP4\")\nim4 = cv2.cvtColor(cam2.read()[1], cv2.COLOR_RGB2GRAY)\nim5 = cv2.cvtColor(cam2.read()[1], cv2.COLOR_RGB2GRAY)\nim6 = cv2.cvtColor(cam2.read()[1], cv2.COLOR_RGB2GRAY)\n\nwhile True:\n\n\n#\u30d5\u30ec\u30fc\u30e0\u9593\u5dee\u5206\u306e\u5dee\u5206\u8a08\u7b97\n\ncv2.imshow(\"Motion Mask3\",cam2)\nim4 = im5\nim5 = im6\nim6 = cv2.cvtColor(cam2.read()[1], cv2.COLOR_RGB2GRAY)\nkey2 = cv2.waitKey(1)\n\n#\u30d5\u30ec\u30fc\u30e0\u9593\u5dee\u5206\u306e\u5dee\u5206\u8a08\u7b97\u7d42\u4e86\n\n\n\n\n\n\nif cam == True:\nframe = cv2.flip(frame,0)\nout.write(out)\n\n# q\u30ad\u30fc\u304c\u62bc\u3055\u308c\u305f\u3089\n\nif cv2.waitKey(100) & 0xFF == ord('q'):\ncam.release()\nout.release()\ncv2.destroyAllWindows()\nbreak\n\n\nif __name__ == '__main__':\nmain() \n", "tags": ["OpenCV", "Python"]}