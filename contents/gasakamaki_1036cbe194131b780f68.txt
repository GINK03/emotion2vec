{"context": " More than 1 year has passed since last update.\n\n\u3010\u307e\u3048\u304c\u304d\u3011\n\u300e\u30ea\u30bd\u30fc\u30b9\u306e\u516c\u958b\u5f8c\u3001\u4e88\u5b9a\u304c\u4f5c\u6210\u3055\u308c\u305f\u5f8c\u306b\n\u540d\u79f0\u3092\u5909\u66f4\u3057\u305f\u304c\u3001\u4e88\u5b9a\u306e\u3010\u5834\u6240\u3011\u306b\u8868\u793a\u3055\u308c\u308b\u6587\u5b57\u5217\u307e\u3067\u3001\n\u53cd\u6620\u3055\u308c\u306a\u304f\u3066\u56f0\u3063\u3066\u308b\u3093\u3067\u3059\u3002\u3002\u3002\u300f\n\u305d\u3093\u306a\u554f\u3044\u5408\u308f\u305b\u304c\u3042\u308a\u3001\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\u5143\u306e\u540d\u79f0\u3000\u3000\uff1a\u300c\u4f1a\u8b70\u5ba4101\u300d\n\u5909\u66f4\u5f8c\u306e\u540d\u79f0\uff1a\u300c\u4f1a\u8b70\u5ba4111\u300d\n\u21d2\u4e00\u62ec\u3067\u5834\u6240\u3092\u300c\u4f1a\u8b70\u5ba4111\u300d\u306b\u5909\u66f4\u3059\u308b\u65b9\u6cd5\u3092\u3054\u6848\u5185\u3057\u307e\u3059\uff01\n\u203b\u4eca\u56de\u306f\u8907\u6570\u306e\u4f1a\u8b70\u5ba4\u5206\u3092\u4e00\u62ec\u3067\u5909\u66f4\u3059\u308b\u65b9\u6cd5\u3068\u3057\u307e\u3059\u3002\n\n\u3010\u307e\u3068\u3081\u3011\n\u4e0b\u8a18\u306e3\u3064\u306e\u624b\u9806\u3067\u884c\u3044\u307e\u3059\u3002\n\uff11\uff0e\u5bfe\u8c61\u306e\u30ea\u30bd\u30fc\u30b9\u306e\u4e88\u7d04\u3092\u62bd\u51fa\n\uff12\uff0e\u5909\u66f4\u5f8c\u306e\u5834\u6240\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u8a2d\u5b9a\n\uff13\uff0eEvent ID\u3092\u30ad\u30fc\u306b\u3057\u3066\u4e00\u62ec\u66f4\u65b0\n\n\u3010\u30dd\u30a4\u30f3\u30c8\u3011\n\u540c\u4e00Event ID\u306b\u3066\u8907\u6570\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u62db\u5f85\u3057\u3066\u3044\u308b\u5834\u5408\u306e\u5bfe\u51e6\u306f\uff1f\uff01\uff1f\uff01\n\n\u3010\u4f5c\u6210\u3057\u305f\u3082\u306e\u3011\n\n\u2605SpreadSheet\u3000\u00d7 1\n\u3000\u3000\u3000\u51e6\u7406\u7528\u30b7\u30fc\u30c8\uff1a\u30c7\u30fc\u30bf\u62bd\u51fa\u21d2\u30e1\u30f3\u30c6\u21d2\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u306b\u4f7f\u7528\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000C2\u30bb\u30eb\uff1a\u62bd\u51fa\u57fa\u6e96\u3000\u958b\u59cb\u65e5\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000E2\u30bb\u30eb\uff1a\u62bd\u51fa\u57fa\u6e96\u3000\u7d42\u4e86\u65e5\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000A\u5217\uff1a\u30ea\u30bd\u30fc\u30b9ID\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000B\u5217\uff1aEventID\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000C\u5217\uff1a\u30c1\u30a7\u30c3\u30af\u5217\uff08\u5f8c\u7a0b\u8aac\u660e\uff09\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000D\u5217\uff1a\u4e88\u5b9a\u306e\u30bf\u30a4\u30c8\u30eb\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000E\u5217\uff1a\u5909\u66f4\u5f8c\u306e\u5834\u6240\u306e\u30c6\u30ad\u30b9\u30c8\u8a18\u5165\u7528\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000F\u5217\uff1a\u62bd\u51fa\u5143\u30ea\u30bd\u30fc\u30b9\u540d\uff08\u7279\u306b\u51e6\u7406\u306b\u5f71\u97ff\u306a\u3057\uff09\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000G\u5217\uff1a\u62bd\u51fa\u3057\u305fEvent\u306e\u5834\u6240\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000H\u5217\uff1a\u4e88\u5b9a\u306e\u65e5\u6642\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000I\u5217\uff1a\u51e6\u7406\u7d50\u679c\u8a18\u5165\u7528\n\u3000\u3000\u3000\u203b1\u884c\u76ee\uff1a\u898b\u6804\u3048\u4e0a\u3001\u7a7a\u767d\u884c\n\u3000\u3000\u3000\u30003\u884c\u76ee\uff1a\u30d8\u30c3\u30c0\u30fc\u884c\n\u3000\u3000\u3000\u30004\u884c\u76ee\uff5e\u5b9f\u30c7\u30fc\u30bf\u884c\n\u3000\u3000\u3000\u3000\u3068\u3057\u3066\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u4e0b\u8a18\u30bd\u30fc\u30b9\u4e0a\u3067\u306f\u305d\u308c\u3092\u524d\u63d0\u306b\u898b\u3066\u304f\u3060\u3055\u3044\u306d\u3002\n\u3000\u3000\u3000\u30de\u30b9\u30bf\u30b7\u30fc\u30c8\uff1a\u62bd\u51fa\u6642\u306b\u4f7f\u7528\uff08\u62bd\u51fa\u5bfe\u8c61\u306e\u30ea\u30bd\u30fc\u30b9\u540d\u79f0\u304a\u3088\u3073\u30ea\u30bd\u30fc\u30b9ID\u3092\u7ba1\u7406\uff09\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000A\u5217\uff1a\u30ea\u30bd\u30fc\u30b9\u540d\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000B\u5217\uff1a\u30ea\u30bd\u30fc\u30b9ID\n\n\u2605AppsScript\u3000\u00d7 3\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000getCal\u3000\u3000\u3000\u3000\u3000\uff1a\u4e88\u5b9a\u306e\u62bd\u51fa\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000sort\u3000\u3000\u3000\u3000\u3000\u3000\uff1a\u62bd\u51fa\u3057\u305f\u4e88\u5b9a\u306e\u30bd\u30fc\u30c8\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000locationUpdate \uff1a\u4e88\u5b9a\u62bd\u51fa\n\uff11\uff0e\u5bfe\u8c61\u306e\u30ea\u30bd\u30fc\u30b9\u306e\u4e88\u7d04\u3092\u62bd\u51fa\n\uff12\uff0e\u5909\u66f4\u5f8c\u306e\u5834\u6240\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u8a2d\u5b9a\n\u3000\u3000\u21d2\u3053\u3061\u3089\u306f\u624b\u4f5c\u696d\u3067E\u5217\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\uff01\n\uff13\uff0eEvent ID\u3092\u30ad\u30fc\u306b\u3057\u3066\u4e00\u62ec\u66f4\u65b0\n\n\uff11\uff0e\u5bfe\u8c61\u306e\u30ea\u30bd\u30fc\u30b9\u306e\u4e88\u7d04\u3092\u62bd\u51fa\n\ngetCal.gs\u3000\u4e88\u5b9a\u306e\u62bd\u51fa\u51e6\u7406\nfunction getCalAll(){\n  var sheet = SpreadsheetApp.getActiveSpreadsheet();\n  var mstsheet = sheet.getSheetByName('\u30de\u30b9\u30bf');  \n  var batsheet = sheet.getSheetByName('\u51e6\u7406\u7528');   \n  var dataRange2 = batsheet.getRange(\"C2:C2\");\n  var StartDay = dataRange2.getValues();\n  var dataRange3 = batsheet.getRange(\"E2:E2\");\n  var EndDay = dataRange3.getValues(); \n  var index = 4;\n  var m = 1;\n  var range = mstsheet.getDataRange(); \n  for (var l = range.getRow(); l < range.getLastRow(); ){\n    var l =  l + 1;\n    var m =  m + 1;\n    var calmst =  mstsheet.getRange(l,2);\n    var caladdress =  calmst.getValues();     \n    var cal = CalendarApp.getCalendarById(caladdress);\n    var evts = cal.getEvents(\n      new Date(StartDay), \n      new Date(EndDay));\n    var calnm =  mstsheet.getRange(m,1);\n    var calname =  calnm.getValues(); \n    var address = caladdress[0];\n    var address = address[0];\n    if (evts.length > 0){\n      for (var i in evts){\n        var evt = evts[i];     \n        batsheet.getRange(index, 1).setValue(address);\n        batsheet.getRange(index, 2).setValue(evt.getId());\n        var count = index -1;\n        batsheet.getRange(index, 3).setFormula('=if(B'+index+'=B'+count+',\"\u7121\u8996\",\"\")');\n        batsheet.getRange(index, 4).setValue(evt.getTitle());\n        batsheet.getRange(index, 6).setValue(calname);\n        batsheet.getRange(index, 7).setValue(evt.getLocation());\n        batsheet.getRange(index, 8).setValue(evt.getStartTime());\n        batsheet.getRange(index, 9).setValue(evt.getCreators());\n\n        index++;\n      }\n    }\n  }\n  sort(); //sort\u51e6\u7406\u3092\u547c\u3073\u51fa\u3057\n}\n\n\nbatsheet.getRange(index, 3).setFormula('=if(B'+index+'=B'+count+',\"\u7121\u8996\",\"\")');\n\u21d2\u540c\u4e00Event ID\u306b\u3066\u8907\u6570\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u62db\u5f85\u3057\u3066\u3044\u308b\u5834\u5408\u306f1\u4ef6\u4ee5\u5916\u306f\n\u3000C\u5217\uff1a\u30c1\u30a7\u30c3\u30af\u5217\u306b\u7121\u8996\u304c\u5165\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\n\nsort.gs\nfunction sort() {  \n  var ss = SpreadsheetApp.getActiveSpreadsheet();\n  var sheet = ss.getSheetByName('\u51e6\u7406\u7528');    \n  var range = sheet.getRange('A4:I');\n  range.sort([8,2]);\n}\n\n\n\u21d2\u65e5\u6642\u3001\u4e88\u5b9aID\u9806\u306b\u30bd\u30fc\u30c8\u3092\u304b\u3051\u3066\u3044\u307e\u3059\n\n\uff13\uff0eEvent ID\u3092\u30ad\u30fc\u306b\u3057\u3066\u4e00\u62ec\u66f4\u65b0\n\nlocationUpdate.gs\nfunction locationUpdate(){\n  var sheet = SpreadsheetApp.getActiveSpreadsheet();\n  var batsheet = sheet.getSheetByName('\u51e6\u7406\u7528');   \n  var SheetValues = batsheet.getDataRange().getValues(); //\u30b7\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n  var LastRow = batsheet.getLastRow(); //\u6700\u5f8c\u306e\u884c\u756a\u53f7\u3092\u53d6\u5f97\n  for(var i = 4;i < LastRow+1;i++){ \n    var flg = SheetValues[i-1][2];\n    if(flg !== '\u7121\u8996'){ //\u7121\u8996\u306f\u98db\u3070\u3057\u307e\u3059\uff01\n      var caladdress = SheetValues[i-1][0];\n      var cal = CalendarApp.getCalendarById(caladdress); \n      var calid = SheetValues[i-1][1];\n      var newLocation = SheetValues[i-1][4];\n      var evts = cal.getEventSeriesById(calid);\n      evts.setLocation(newLocation) //\u3053\u3053\u3067\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30bb\u30c3\u30c8\uff01\n      batsheet.getRange([i], 10).setValue('\u5909\u66f4\u6e08');\n    }    \n  }\n}\n\n\n\u21d2\u30c1\u30a7\u30c3\u30af\u5217\u306b\u7121\u8996\u304c\u5165\u3063\u3066\u3044\u308b\u3082\u306e\u4ee5\u5916\u306f\u3001\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u5909\u66f4\u3057\u307e\u3059\uff01\n\n\u3010\u3042\u3068\u304c\u304d\u3011\n\u57fa\u672c\u7684\u306b\u3042\u307e\u308a\u904b\u7528\u958b\u59cb\u5f8c\u306e\u30ea\u30bd\u30fc\u30b9\u540d\u79f0\u306e\u5909\u66f4\u306f\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\n\u65b0\u898f\u30ea\u30bd\u30fc\u30b9\u4f5c\u6210\u3057\u305f\u5c11\u3057\u5f8c\u306b\u540c\u69d8\u306e\u4e8b\u8c61\u304c\u767a\u751f\u3057\u305f\u3089\u305c\u3072\u3054\u5229\u7528\u304f\u3060\u3055\u3044\uff01\n#\u3010\u307e\u3048\u304c\u304d\u3011\n\u300e\u30ea\u30bd\u30fc\u30b9\u306e\u516c\u958b\u5f8c\u3001\u4e88\u5b9a\u304c\u4f5c\u6210\u3055\u308c\u305f\u5f8c\u306b\n\u540d\u79f0\u3092\u5909\u66f4\u3057\u305f\u304c\u3001\u4e88\u5b9a\u306e\u3010\u5834\u6240\u3011\u306b\u8868\u793a\u3055\u308c\u308b\u6587\u5b57\u5217\u307e\u3067\u3001\n\u53cd\u6620\u3055\u308c\u306a\u304f\u3066\u56f0\u3063\u3066\u308b\u3093\u3067\u3059\u3002\u3002\u3002\u300f\n\u305d\u3093\u306a\u554f\u3044\u5408\u308f\u305b\u304c\u3042\u308a\u3001\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n\u5143\u306e\u540d\u79f0\u3000\u3000\uff1a\u300c\u4f1a\u8b70\u5ba4101\u300d\n\u5909\u66f4\u5f8c\u306e\u540d\u79f0\uff1a\u300c\u4f1a\u8b70\u5ba4111\u300d\n\u21d2\u4e00\u62ec\u3067\u5834\u6240\u3092\u300c\u4f1a\u8b70\u5ba4111\u300d\u306b\u5909\u66f4\u3059\u308b\u65b9\u6cd5\u3092\u3054\u6848\u5185\u3057\u307e\u3059\uff01\n\u203b\u4eca\u56de\u306f\u8907\u6570\u306e\u4f1a\u8b70\u5ba4\u5206\u3092\u4e00\u62ec\u3067\u5909\u66f4\u3059\u308b\u65b9\u6cd5\u3068\u3057\u307e\u3059\u3002\n\n#\u3010\u307e\u3068\u3081\u3011\n\u4e0b\u8a18\u306e3\u3064\u306e\u624b\u9806\u3067\u884c\u3044\u307e\u3059\u3002\n\uff11\uff0e\u5bfe\u8c61\u306e\u30ea\u30bd\u30fc\u30b9\u306e\u4e88\u7d04\u3092\u62bd\u51fa\n\uff12\uff0e\u5909\u66f4\u5f8c\u306e\u5834\u6240\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u8a2d\u5b9a\n\uff13\uff0eEvent ID\u3092\u30ad\u30fc\u306b\u3057\u3066\u4e00\u62ec\u66f4\u65b0\n\n#\u3010\u30dd\u30a4\u30f3\u30c8\u3011\n\u540c\u4e00Event ID\u306b\u3066\u8907\u6570\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u62db\u5f85\u3057\u3066\u3044\u308b\u5834\u5408\u306e\u5bfe\u51e6\u306f\uff1f\uff01\uff1f\uff01\n\n#\u3010\u4f5c\u6210\u3057\u305f\u3082\u306e\u3011\n####\u2605SpreadSheet\u3000\u00d7 1\n\u3000\u3000\u3000\u51e6\u7406\u7528\u30b7\u30fc\u30c8\uff1a\u30c7\u30fc\u30bf\u62bd\u51fa\u21d2\u30e1\u30f3\u30c6\u21d2\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u306b\u4f7f\u7528\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000C2\u30bb\u30eb\uff1a\u62bd\u51fa\u57fa\u6e96\u3000\u958b\u59cb\u65e5\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000E2\u30bb\u30eb\uff1a\u62bd\u51fa\u57fa\u6e96\u3000\u7d42\u4e86\u65e5\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000A\u5217\uff1a\u30ea\u30bd\u30fc\u30b9ID\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000B\u5217\uff1aEventID\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000C\u5217\uff1a\u30c1\u30a7\u30c3\u30af\u5217\uff08\u5f8c\u7a0b\u8aac\u660e\uff09\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000D\u5217\uff1a\u4e88\u5b9a\u306e\u30bf\u30a4\u30c8\u30eb\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000E\u5217\uff1a\u5909\u66f4\u5f8c\u306e\u5834\u6240\u306e\u30c6\u30ad\u30b9\u30c8\u8a18\u5165\u7528\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000F\u5217\uff1a\u62bd\u51fa\u5143\u30ea\u30bd\u30fc\u30b9\u540d\uff08\u7279\u306b\u51e6\u7406\u306b\u5f71\u97ff\u306a\u3057\uff09\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000G\u5217\uff1a\u62bd\u51fa\u3057\u305fEvent\u306e\u5834\u6240\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000H\u5217\uff1a\u4e88\u5b9a\u306e\u65e5\u6642\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000I\u5217\uff1a\u51e6\u7406\u7d50\u679c\u8a18\u5165\u7528\n\u3000\u3000\u3000\u203b1\u884c\u76ee\uff1a\u898b\u6804\u3048\u4e0a\u3001\u7a7a\u767d\u884c\n\u3000\u3000\u3000\u30003\u884c\u76ee\uff1a\u30d8\u30c3\u30c0\u30fc\u884c\n\u3000\u3000\u3000\u30004\u884c\u76ee\uff5e\u5b9f\u30c7\u30fc\u30bf\u884c\n\u3000\u3000\u3000\u3000\u3068\u3057\u3066\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u4e0b\u8a18\u30bd\u30fc\u30b9\u4e0a\u3067\u306f\u305d\u308c\u3092\u524d\u63d0\u306b\u898b\u3066\u304f\u3060\u3055\u3044\u306d\u3002\n\n\u3000\u3000\u3000\u30de\u30b9\u30bf\u30b7\u30fc\u30c8\uff1a\u62bd\u51fa\u6642\u306b\u4f7f\u7528\uff08\u62bd\u51fa\u5bfe\u8c61\u306e\u30ea\u30bd\u30fc\u30b9\u540d\u79f0\u304a\u3088\u3073\u30ea\u30bd\u30fc\u30b9ID\u3092\u7ba1\u7406\uff09\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000A\u5217\uff1a\u30ea\u30bd\u30fc\u30b9\u540d\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000B\u5217\uff1a\u30ea\u30bd\u30fc\u30b9ID\n####\u2605AppsScript\u3000\u00d7 3\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000getCal\u3000\u3000\u3000\u3000\u3000\uff1a\u4e88\u5b9a\u306e\u62bd\u51fa\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000sort\u3000\u3000\u3000\u3000\u3000\u3000\uff1a\u62bd\u51fa\u3057\u305f\u4e88\u5b9a\u306e\u30bd\u30fc\u30c8\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000locationUpdate \uff1a\u4e88\u5b9a\u62bd\u51fa\n\n\uff11\uff0e\u5bfe\u8c61\u306e\u30ea\u30bd\u30fc\u30b9\u306e\u4e88\u7d04\u3092\u62bd\u51fa\n\uff12\uff0e\u5909\u66f4\u5f8c\u306e\u5834\u6240\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u8a2d\u5b9a\n\u3000\u3000\u21d2\u3053\u3061\u3089\u306f\u624b\u4f5c\u696d\u3067E\u5217\u3092\u57cb\u3081\u3066\u304f\u3060\u3055\u3044\uff01\n\uff13\uff0eEvent ID\u3092\u30ad\u30fc\u306b\u3057\u3066\u4e00\u62ec\u66f4\u65b0\n\n##\uff11\uff0e\u5bfe\u8c61\u306e\u30ea\u30bd\u30fc\u30b9\u306e\u4e88\u7d04\u3092\u62bd\u51fa\n```getCal.gs\u3000\u4e88\u5b9a\u306e\u62bd\u51fa\u51e6\u7406\nfunction getCalAll(){\n  var sheet = SpreadsheetApp.getActiveSpreadsheet();\n  var mstsheet = sheet.getSheetByName('\u30de\u30b9\u30bf');  \n  var batsheet = sheet.getSheetByName('\u51e6\u7406\u7528');   \n  var dataRange2 = batsheet.getRange(\"C2:C2\");\n  var StartDay = dataRange2.getValues();\n  var dataRange3 = batsheet.getRange(\"E2:E2\");\n  var EndDay = dataRange3.getValues(); \n  var index = 4;\n  var m = 1;\n  var range = mstsheet.getDataRange(); \n  for (var l = range.getRow(); l < range.getLastRow(); ){\n    var l =  l + 1;\n    var m =  m + 1;\n    var calmst =  mstsheet.getRange(l,2);\n    var caladdress =  calmst.getValues();     \n    var cal = CalendarApp.getCalendarById(caladdress);\n    var evts = cal.getEvents(\n      new Date(StartDay), \n      new Date(EndDay));\n    var calnm =  mstsheet.getRange(m,1);\n    var calname =  calnm.getValues(); \n    var address = caladdress[0];\n    var address = address[0];\n    if (evts.length > 0){\n      for (var i in evts){\n        var evt = evts[i];     \n        batsheet.getRange(index, 1).setValue(address);\n        batsheet.getRange(index, 2).setValue(evt.getId());\n        var count = index -1;\n        batsheet.getRange(index, 3).setFormula('=if(B'+index+'=B'+count+',\"\u7121\u8996\",\"\")');\n        batsheet.getRange(index, 4).setValue(evt.getTitle());\n        batsheet.getRange(index, 6).setValue(calname);\n        batsheet.getRange(index, 7).setValue(evt.getLocation());\n        batsheet.getRange(index, 8).setValue(evt.getStartTime());\n        batsheet.getRange(index, 9).setValue(evt.getCreators());\n        \n        index++;\n      }\n    }\n  }\n  sort(); //sort\u51e6\u7406\u3092\u547c\u3073\u51fa\u3057\n}\n```\nbatsheet.getRange(index, 3).setFormula('=if(B'+index+'=B'+count+',\"\u7121\u8996\",\"\")');\n\u21d2\u540c\u4e00Event ID\u306b\u3066\u8907\u6570\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u62db\u5f85\u3057\u3066\u3044\u308b\u5834\u5408\u306f1\u4ef6\u4ee5\u5916\u306f\n\u3000C\u5217\uff1a\u30c1\u30a7\u30c3\u30af\u5217\u306b\u7121\u8996\u304c\u5165\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\n\n```sort.gs\nfunction sort() {  \n  var ss = SpreadsheetApp.getActiveSpreadsheet();\n  var sheet = ss.getSheetByName('\u51e6\u7406\u7528');    \n  var range = sheet.getRange('A4:I');\n  range.sort([8,2]);\n}\n```\n\u21d2\u65e5\u6642\u3001\u4e88\u5b9aID\u9806\u306b\u30bd\u30fc\u30c8\u3092\u304b\u3051\u3066\u3044\u307e\u3059\n\n##\uff13\uff0eEvent ID\u3092\u30ad\u30fc\u306b\u3057\u3066\u4e00\u62ec\u66f4\u65b0\n```locationUpdate.gs\nfunction locationUpdate(){\n  var sheet = SpreadsheetApp.getActiveSpreadsheet();\n  var batsheet = sheet.getSheetByName('\u51e6\u7406\u7528');   \n  var SheetValues = batsheet.getDataRange().getValues(); //\u30b7\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n  var LastRow = batsheet.getLastRow(); //\u6700\u5f8c\u306e\u884c\u756a\u53f7\u3092\u53d6\u5f97\n  for(var i = 4;i < LastRow+1;i++){ \n    var flg = SheetValues[i-1][2];\n    if(flg !== '\u7121\u8996'){ //\u7121\u8996\u306f\u98db\u3070\u3057\u307e\u3059\uff01\n      var caladdress = SheetValues[i-1][0];\n      var cal = CalendarApp.getCalendarById(caladdress); \n      var calid = SheetValues[i-1][1];\n      var newLocation = SheetValues[i-1][4];\n      var evts = cal.getEventSeriesById(calid);\n      evts.setLocation(newLocation) //\u3053\u3053\u3067\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30bb\u30c3\u30c8\uff01\n      batsheet.getRange([i], 10).setValue('\u5909\u66f4\u6e08');\n    }    \n  }\n}\n```\n\u21d2\u30c1\u30a7\u30c3\u30af\u5217\u306b\u7121\u8996\u304c\u5165\u3063\u3066\u3044\u308b\u3082\u306e\u4ee5\u5916\u306f\u3001\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u5909\u66f4\u3057\u307e\u3059\uff01\n\n#\u3010\u3042\u3068\u304c\u304d\u3011\n\u57fa\u672c\u7684\u306b\u3042\u307e\u308a\u904b\u7528\u958b\u59cb\u5f8c\u306e\u30ea\u30bd\u30fc\u30b9\u540d\u79f0\u306e\u5909\u66f4\u306f\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\n\u65b0\u898f\u30ea\u30bd\u30fc\u30b9\u4f5c\u6210\u3057\u305f\u5c11\u3057\u5f8c\u306b\u540c\u69d8\u306e\u4e8b\u8c61\u304c\u767a\u751f\u3057\u305f\u3089\u305c\u3072\u3054\u5229\u7528\u304f\u3060\u3055\u3044\uff01\n", "tags": ["GoogleAppsScript", "gas", "gasja"]}