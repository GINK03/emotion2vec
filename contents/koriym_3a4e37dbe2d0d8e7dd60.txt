{"context": "(\u3053\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u306f\u3001\u30a8\u30ad\u30b5\u30a4\u30c8Advent Calendar 2016 \u306e 12/02\u306e2\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\u30a8\u30ad\u30b5\u30a4\u30c8\u521d\u306e\u53c2\u52a0\u3068\u3044\u3046\u3053\u3068\u3067\u79c1\u3082\u53c2\u52a0\u3057\u307e\u3057\u305f\u3002)\nPHP\u306eV8Js\u3092\u4f7f\u3063\u3066Redux-ReactJs\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3059\u308bredux-react-ssr\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n\u7528\u8a9e\n\nV8Js\nSSR\nRedux\n\n\nV8Js\nV8Js\u306fPHP\u306e\u6a5f\u80fd\u62e1\u5f35\u3067Google V8 JavaScript Engine\u3092PHP\u306b\u7d44\u307f\u8fbc\u307f\u307e\u3059\u3002PHP\u304b\u3089\u76f4\u63a5JS\u306e\u30b3\u30fc\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n$v8 = new V8Js();\n\n/* basic.js */\n$js = <<< EOT\nlen = print('Hello' + ' ' + 'World!' + \"\\\\n\");\nlen;\nEOT;\n\ntry {\n  var_dump($v8->executeString($js, 'basic.js'));\n} catch (V8JsException $e) {\n  var_dump($e);\n}\n\n// Hello World!\n// int(13)\n\n// http://php.net/manual/en/v8js.examples.php \u3088\u308a\n\n\nSSR\nSSR\u3068\u306fServer Side Rendering\u306e\u7565\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u306f\u306a\u304f\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3092\u884c\u3046\u3053\u3068\u3092\u3044\u3044\u307e\u3059\u3002\u5178\u578b\u7684\u306a\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\u306f\u4ee5\u4e0b\u306e\uff12\u3064\u3002\n\n\u9ad8\u901f\u306a\u30da\u30fc\u30b8\u306e\u30ed\u30fc\u30c9\u3002\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u5b8c\u5168\u306a\u30da\u30fc\u30b8\u304c\u9001\u3089\u308c\u3066\u304f\u308b\u306e\u3067\u30c7\u30fc\u30bf\u30d5\u30a7\u30c3\u30c1\u306e\u305f\u3081\u306eHTTP\u30ea\u30af\u30a8\u30b9\u30c8\u306a\u3069\u304c\u4e0d\u8981\u3067\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3088\u308a\u4fe1\u983c\u306e\u3067\u304d\u308bSEO\u3002JavaScript\u306b\u3088\u3063\u3066\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u308b\u7a7a\u306e\u30da\u30fc\u30b8\u3067\u306f\u306a\u304f\u3001\u30b3\u30f3\u30c6\u30f3\u30c4\u306e\u4f34\u3063\u305f\u5b8c\u5168\u306a\u30da\u30fc\u30b8\u3092\u7528\u610f\u3057\u3066\u30af\u30ed\u30fc\u30e9\u30fc\u306b\u4e0e\u3048\u307e\u3059\u3002(\u3057\u304b\u3057\u30af\u30ed\u30fc\u30e9\u30fc\u306e\u6027\u80fd\u5411\u4e0a\u3067\u3053\u306e\u30e1\u30ea\u30c3\u30c8\u306f\u8584\u308c\u3064\u3064\u306f\u3042\u308a\u307e\u3059\uff09\n\nSSR\u3055\u308c\u305fHTML\u306fReactJS\u306b\u5bfe\u5fdc\u3057\u305f\u30bf\u30b0\u304c\u6253\u305f\u308c\u3001\u72b6\u614b\u3082\u5f15\u304d\u7d99\u304c\u308c\u308b\u305f\u3081\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u306eRedux React\u3067\u7d99\u7d9a\u53ef\u80fd\u3067\u3059\u3002(\u305d\u306e\u305f\u3081\u306b\u306fSSR\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u308bDOM\u3068CSR(Client Server Rendering)\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u308bDOM\u304c\u5b8c\u5168\u4e00\u81f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002)\nSSR\u3068CSR\u306f\u9055\u3046\u306e\u3082\u306e\u3067\u3069\u3061\u3089\u304b\u304c\u5b8c\u5168\u306b\u512a\u308c\u3066\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3082\u3042\u308a\u307e\u305b\u3093\u3002\u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\u304c\u591a\u304f\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u6709\u52b9\u306a\u30d6\u30e9\u30a6\u30ba\u4e3b\u4f53\u306e\u30da\u30fc\u30b8\u306bSSR\u304c\u5411\u3044\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u4e00\u65b9Google Play Music\u3084Gmail\u306e\u3088\u3046\u306aSPA\u306e\u30a2\u30d7\u30ea\u306b\u306fCSR\u304c\u5411\u3044\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nRedux\nGitHub\u306e\u8aac\u660e\u3088\u308b\u3068Redux\u306f\u300cFlux\u306b\u30a4\u30f3\u30b9\u30d1\u30a4\u30a2\u3055\u308c\u305f\u5358\u65b9\u5411\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u300d\u3067\u3059\u3002\n\nStore\u304c\u6301\u3064\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u72b6\u614b\u3092ReactJS\u304c\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3057\u307e\u3059\u3002ReactJs\u306f\u30d3\u30e5\u30fc\u3060\u3051\u3092\u53d7\u3051\u6301\u3061\u307e\u3059\u3002\n\nUNIDIRECTIONAL USER INTERFACE ARCHITECTURES\n\n\nredux-react-ssr\nReactJS\u3092SSR\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066React-PHP-V8Js\u304c\u3042\u308a\u307e\u3059\u3002redux-react-ssr\u3082\u3053\u308c\u3068\u540c\u69d8\u306b\u6a5f\u80fd\u3057\u307e\u3059\u3002\u9055\u3044\u306fReact\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u72b6\u614b\u3092\u6e21\u3059\u306e\u3067\u306f\u306a\u304fRedux\u306eStore\u306e\u72b6\u614b\u3092\u6e21\u3059\u3068\u3053\u308d\u3067\u3059\u3002\n<?php\n\nuse Koriym\\ReduxReactSsr\\ReduxReactJs;\nuse Koriym\\ReduxReactSsr\\ExceptionHandler;\n\n$ssr = new ReduxReactJs(\n    file_get_contents(__DIR__ . '/build/react.bundle.js'),\n    file_get_contents(__DIR__ . '/build/app.bundle.js'),\n    new ExceptionHandler(),\n    new \\V8Js()\n);\n\n$view = $ssr('App', ['hello' => ['message' => 'Hello, Redux!']], 'root');\n\n$html = <<<EOT\n<!DOCTYPE html>\n<html>\n  <head>\n    <title></title>\n  </head>\n  <body>\n    <div id=\"root\">{$view->markup}</div>\n    <script src=\"build/react.bundle.js\"></script>\n    <script src=\"build/app.bundle.js\"></script>\n    <script>{$view->js}</script>\n  </body>\n</html>\nEOT;\n\necho $html;\n\nreact.bundle.js\u3068app.bundle.js\u3092\u76f4\u63a5\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\u3002\n\nreact.bundle.js\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ReactDOMServer from 'react-dom/server';\nimport { Provider } from 'react-redux';\n\nglobal.React = React;\nglobal.ReactDOM = ReactDOM;\nglobal.ReactDOMServer = ReactDOMServer;\nglobal.Provider = Provider;\n\n\nreact.bundle.js\u306fReact\u3067\u5fc5\u8981\u306a\u5f15\u6570\u3092global\u3067\u5ba3\u8a00\u3057\u3066\u3044\u307e\u3059\u3002\n\napp.js\nimport configureStore from '../common/store/configureStore';\nimport App from '../common/components/App';\nimport { Provider } from 'react-redux';\n\nglobal.App = App;\nglobal.Provider = Provider;\nglobal.configureStore = configureStore;\n\n\napp.bundle.js\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u56fa\u6709\u306econfigureStore\u3068 App \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u30c7\u30e2\n\u30c7\u30e2\u3092\u52d5\u304b\u3057\u3066\u307f\u307e\u3059\u3002\uff08\u8981php7, v8js)\ngit clone git@github.com:koriym/Koriym.ReduxReactSsr.git\ncomposer install\ncd Koriym.ReduxReactSsr/example/redux\nnpm install\nnpm run build\nnpm start\n\n\n\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068State\u304c\u5909\u308f\u308a\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u305fDOM\u304c\u30af\u30e9\u30a4\u30f3\u30c8\u30b5\u30a4\u30c9\u306eJavaScript\u3067\u3082\u5f15\u304d\u7d99\u304c\u308c\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\nHTML\u3092\u898b\u308b\u3068\u3068\u5404\u30bf\u30b0\u304cdata-reactid\u3068\u3044\u3046ReactJs\u304c\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306aID\u3068\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u304b\u3089\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u306eJavaScript\u306b\u7d99\u7d9a\u304c\u53ef\u80fd\u304b\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306edata-react-checksum\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n<!DOCTYPE html>\n<html>\n  <head>\n    <title></title>\n  </head>\n  <body>\n    <div id=\"root\"><div data-reactroot=\"\" data-reactid=\"1\" data-react-checksum=\"466367079\"><div data-reactid=\"2\"><h1 data-reactid=\"3\">Hello, Redux!</h1><button data-reactid=\"4\">Click</button></div></div></div>\n    <script src=\"build/react.bundle.js\"></script>\n    <script src=\"build/app.bundle.js\"></script>\n    <script>ReactDOM.render(React.createElement(Provider,{store:configureStore({\"hello\":{\"message\":\"Hello, Redux!\"}}) },React.createElement(App)),document.getElementById('root'));</script>\n  </body>\n</html>\n\n\u6b21\u306bSSR\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3067\u30de\u30fc\u30af\u30a2\u30c3\u30d7\u3055\u308c\u305fHTML\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5916\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u5909\u66f4\u524d\n<div id=\"root\">{$markup}</div>\n\u5909\u66f4\u5f8c\n<div id=\"root\"></div>\n\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u305fHTML\n<!DOCTYPE html>\n<html>\n  <head>\n    <title></title>\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script src=\"build/react.bundle.js\"></script>\n    <script src=\"build/app.bundle.js\"></script>\n    <script>ReactDOM.render(React.createElement(Provider,{store:configureStore({\"hello\":{\"message\":\"Hello, Redux!\"}}) },React.createElement(App)),document.getElementById('root'));</script>\n  </body>\n</html>\n\n<img width=\"253\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-01 13.17.04.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/3940/2298ba96-e792-98ce-cefa-aa80a8b41ad1.png\">\n\n\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u305fHTML\u306f\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u30da\u30fc\u30b8\u306e\u8868\u793a\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u3002\u3053\u308c\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\n\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\nWhat are the tradeoffs of client-side rendering vs. server-side rendering?\n\n\u660e\u65e5\u306f\u65b0\u4eba\u306a\u306e\u306b\u5c71\u53e3\u767e\u6075\u306e\u30ab\u30e9\u30aa\u30b1\u304c\u5f97\u610f\u306a\u7267\u5c71\u541b\u306eGo\u306b\u3064\u3044\u3066\u306e\u8a18\u4e8b\u3067\u3059\u3002\u304a\u697d\u3057\u307f\u306b\u3002\n(\u3053\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u306f\u3001[\u30a8\u30ad\u30b5\u30a4\u30c8Advent Calendar 2016](http://qiita.com/advent-calendar/2016/excite) \u306e 12/02\u306e2\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\u30a8\u30ad\u30b5\u30a4\u30c8\u521d\u306e\u53c2\u52a0\u3068\u3044\u3046\u3053\u3068\u3067\u79c1\u3082\u53c2\u52a0\u3057\u307e\u3057\u305f\u3002)\n\nPHP\u306eV8Js\u3092\u4f7f\u3063\u3066Redux-ReactJs\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3059\u308b[redux-react-ssr](https://github.com/koriym/Koriym.ReduxReactSsr)\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n## \u7528\u8a9e\n\n * V8Js\n * SSR\n * Redux\n\n## V8Js\n\n[V8Js](http://php.net/manual/ja/book.v8js.php)\u306fPHP\u306e\u6a5f\u80fd\u62e1\u5f35\u3067[Google V8 JavaScript Engine](https://ja.wikipedia.org/wiki/Google_V8_JavaScript_Engine)\u3092PHP\u306b\u7d44\u307f\u8fbc\u307f\u307e\u3059\u3002PHP\u304b\u3089\u76f4\u63a5JS\u306e\u30b3\u30fc\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002\n\n```php\n$v8 = new V8Js();\n\n/* basic.js */\n$js = <<< EOT\nlen = print('Hello' + ' ' + 'World!' + \"\\\\n\");\nlen;\nEOT;\n\ntry {\n  var_dump($v8->executeString($js, 'basic.js'));\n} catch (V8JsException $e) {\n  var_dump($e);\n}\n\n// Hello World!\n// int(13)\n\n// http://php.net/manual/en/v8js.examples.php \u3088\u308a\n```\n\n## SSR\n\nSSR\u3068\u306fServer Side Rendering\u306e\u7565\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3067\u306f\u306a\u304f\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3092\u884c\u3046\u3053\u3068\u3092\u3044\u3044\u307e\u3059\u3002\u5178\u578b\u7684\u306a\u30e2\u30c1\u30d9\u30fc\u30b7\u30e7\u30f3\u306f\u4ee5\u4e0b\u306e\uff12\u3064\u3002\n\n1. \u9ad8\u901f\u306a\u30da\u30fc\u30b8\u306e\u30ed\u30fc\u30c9\u3002\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u5b8c\u5168\u306a\u30da\u30fc\u30b8\u304c\u9001\u3089\u308c\u3066\u304f\u308b\u306e\u3067\u30c7\u30fc\u30bf\u30d5\u30a7\u30c3\u30c1\u306e\u305f\u3081\u306eHTTP\u30ea\u30af\u30a8\u30b9\u30c8\u306a\u3069\u304c\u4e0d\u8981\u3067\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u3082\u53ef\u80fd\u3067\u3059\u3002\n\n2. \u3088\u308a\u4fe1\u983c\u306e\u3067\u304d\u308bSEO\u3002JavaScript\u306b\u3088\u3063\u3066\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u308b\u7a7a\u306e\u30da\u30fc\u30b8\u3067\u306f\u306a\u304f\u3001\u30b3\u30f3\u30c6\u30f3\u30c4\u306e\u4f34\u3063\u305f\u5b8c\u5168\u306a\u30da\u30fc\u30b8\u3092\u7528\u610f\u3057\u3066\u30af\u30ed\u30fc\u30e9\u30fc\u306b\u4e0e\u3048\u307e\u3059\u3002(\u3057\u304b\u3057\u30af\u30ed\u30fc\u30e9\u30fc\u306e\u6027\u80fd\u5411\u4e0a\u3067\u3053\u306e\u30e1\u30ea\u30c3\u30c8\u306f\u8584\u308c\u3064\u3064\u306f\u3042\u308a\u307e\u3059\uff09\n\nSSR\u3055\u308c\u305fHTML\u306fReactJS\u306b\u5bfe\u5fdc\u3057\u305f\u30bf\u30b0\u304c\u6253\u305f\u308c\u3001\u72b6\u614b\u3082\u5f15\u304d\u7d99\u304c\u308c\u308b\u305f\u3081\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u306eRedux React\u3067\u7d99\u7d9a\u53ef\u80fd\u3067\u3059\u3002(\u305d\u306e\u305f\u3081\u306b\u306fSSR\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u308bDOM\u3068CSR(Client Server Rendering)\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u308bDOM\u304c\u5b8c\u5168\u4e00\u81f4\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002)\n\nSSR\u3068CSR\u306f\u9055\u3046\u306e\u3082\u306e\u3067\u3069\u3061\u3089\u304b\u304c\u5b8c\u5168\u306b\u512a\u308c\u3066\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3082\u3042\u308a\u307e\u305b\u3093\u3002\u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\u304c\u591a\u304f\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u6709\u52b9\u306a\u30d6\u30e9\u30a6\u30ba\u4e3b\u4f53\u306e\u30da\u30fc\u30b8\u306bSSR\u304c\u5411\u3044\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\u4e00\u65b9Google Play Music\u3084Gmail\u306e\u3088\u3046\u306aSPA\u306e\u30a2\u30d7\u30ea\u306b\u306fCSR\u304c\u5411\u3044\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n## Redux\n\nGitHub\u306e\u8aac\u660e\u3088\u308b\u3068Redux\u306f\u300cFlux\u306b\u30a4\u30f3\u30b9\u30d1\u30a4\u30a2\u3055\u308c\u305f\u5358\u65b9\u5411\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u300d\u3067\u3059\u3002\n\n![redux-unidir-ui-arch.jpg](https://qiita-image-store.s3.amazonaws.com/0/3940/1337b2a8-22a8-856e-0779-0ef42a5c16bd.jpeg)\n\n**Store**\u304c\u6301\u3064\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u72b6\u614b\u3092ReactJS\u304c\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3057\u307e\u3059\u3002ReactJs\u306f\u30d3\u30e5\u30fc\u3060\u3051\u3092\u53d7\u3051\u6301\u3061\u307e\u3059\u3002\n\n* [UNIDIRECTIONAL USER INTERFACE ARCHITECTURES](http://staltz.com/unidirectional-user-interface-architectures.html)\n\n\n## redux-react-ssr\n\nReactJS\u3092SSR\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u3057\u3066[React-PHP-V8Js](https://github.com/reactjs/react-php-v8js)\u304c\u3042\u308a\u307e\u3059\u3002**redux-react-ssr**\u3082\u3053\u308c\u3068\u540c\u69d8\u306b\u6a5f\u80fd\u3057\u307e\u3059\u3002\u9055\u3044\u306fReact\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u72b6\u614b\u3092\u6e21\u3059\u306e\u3067\u306f\u306a\u304fRedux\u306eStore\u306e\u72b6\u614b\u3092\u6e21\u3059\u3068\u3053\u308d\u3067\u3059\u3002\n\n```php\n<?php\n\nuse Koriym\\ReduxReactSsr\\ReduxReactJs;\nuse Koriym\\ReduxReactSsr\\ExceptionHandler;\n\n$ssr = new ReduxReactJs(\n    file_get_contents(__DIR__ . '/build/react.bundle.js'),\n    file_get_contents(__DIR__ . '/build/app.bundle.js'),\n    new ExceptionHandler(),\n    new \\V8Js()\n);\n\n$view = $ssr('App', ['hello' => ['message' => 'Hello, Redux!']], 'root');\n\n$html = <<<EOT\n<!DOCTYPE html>\n<html>\n  <head>\n    <title></title>\n  </head>\n  <body>\n    <div id=\"root\">{$view->markup}</div>\n    <script src=\"build/react.bundle.js\"></script>\n    <script src=\"build/app.bundle.js\"></script>\n    <script>{$view->js}</script>\n  </body>\n</html>\nEOT;\n\necho $html;\n```\n\n`react.bundle.js`\u3068`app.bundle.js`\u3092\u76f4\u63a5\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3059\u3002\n\n```react.bundle.js\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ReactDOMServer from 'react-dom/server';\nimport { Provider } from 'react-redux';\n\nglobal.React = React;\nglobal.ReactDOM = ReactDOM;\nglobal.ReactDOMServer = ReactDOMServer;\nglobal.Provider = Provider;\n```\n\n`react.bundle.js`\u306fReact\u3067\u5fc5\u8981\u306a\u5f15\u6570\u3092global\u3067\u5ba3\u8a00\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n```app.js\nimport configureStore from '../common/store/configureStore';\nimport App from '../common/components/App';\nimport { Provider } from 'react-redux';\n\nglobal.App = App;\nglobal.Provider = Provider;\nglobal.configureStore = configureStore;\n```\n\n`app.bundle.js`\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u56fa\u6709\u306e[configureStore](https://github.com/koriym/Koriym.ReduxReactSsr/blob/1.x/example/redux/common/store/configureStore.js)\u3068 [App](https://github.com/koriym/Koriym.ReduxReactSsr/blob/1.x/example/redux/common/components/App.js) \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n## \u30c7\u30e2\n\n\u30c7\u30e2\u3092\u52d5\u304b\u3057\u3066\u307f\u307e\u3059\u3002\uff08\u8981php7, v8js)\n\n```\ngit clone git@github.com:koriym/Koriym.ReduxReactSsr.git\ncomposer install\ncd Koriym.ReduxReactSsr/example/redux\nnpm install\nnpm run build\nnpm start\n```\n<img width=\"253\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-01 13.17.04.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/3940/9628c5b3-4420-d938-4efa-6365e8c8ddcb.png\">\n\n\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068**State**\u304c\u5909\u308f\u308a\u3001\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u305fDOM\u304c\u30af\u30e9\u30a4\u30f3\u30c8\u30b5\u30a4\u30c9\u306eJavaScript\u3067\u3082\u5f15\u304d\u7d99\u304c\u308c\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n<img width=\"245\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-01 13.17.59.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/3940/58043a78-83de-38a2-7030-005b09c1207e.png\">\n\nHTML\u3092\u898b\u308b\u3068\u3068\u5404\u30bf\u30b0\u304c`data-reactid`\u3068\u3044\u3046ReactJs\u304c\u7ba1\u7406\u3059\u308b\u305f\u3081\u306b\u5fc5\u8981\u306aID\u3068\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u304b\u3089\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u306eJavaScript\u306b\u7d99\u7d9a\u304c\u53ef\u80fd\u304b\u78ba\u8a8d\u3059\u308b\u305f\u3081\u306e`data-react-checksum`\u304c\u4ed8\u4e0e\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n```html\n<!DOCTYPE html>\n<html>\n  <head>\n    <title></title>\n  </head>\n  <body>\n    <div id=\"root\"><div data-reactroot=\"\" data-reactid=\"1\" data-react-checksum=\"466367079\"><div data-reactid=\"2\"><h1 data-reactid=\"3\">Hello, Redux!</h1><button data-reactid=\"4\">Click</button></div></div></div>\n    <script src=\"build/react.bundle.js\"></script>\n    <script src=\"build/app.bundle.js\"></script>\n    <script>ReactDOM.render(React.createElement(Provider,{store:configureStore({\"hello\":{\"message\":\"Hello, Redux!\"}}) },React.createElement(App)),document.getElementById('root'));</script>\n  </body>\n</html>\n```\n\n\u6b21\u306bSSR\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3067\u30de\u30fc\u30af\u30a2\u30c3\u30d7\u3055\u308c\u305fHTML\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5916\u3057\u3066\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n**\u5909\u66f4\u524d**\n`<div id=\"root\">{$markup}</div>`\n\n**\u5909\u66f4\u5f8c**\n`<div id=\"root\"></div>`\n\n**\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u305fHTML**\n\n```html\n<!DOCTYPE html>\n<html>\n  <head>\n    <title></title>\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script src=\"build/react.bundle.js\"></script>\n    <script src=\"build/app.bundle.js\"></script>\n    <script>ReactDOM.render(React.createElement(Provider,{store:configureStore({\"hello\":{\"message\":\"Hello, Redux!\"}}) },React.createElement(App)),document.getElementById('root'));</script>\n  </body>\n</html>\n\n<img width=\"253\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-01 13.17.04.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/3940/2298ba96-e792-98ce-cefa-aa80a8b41ad1.png\">\n```\n\n\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u305fHTML\u306f\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u30da\u30fc\u30b8\u306e\u8868\u793a\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u3002\u3053\u308c\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u3067\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002\n\n## \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\n* [What are the tradeoffs of client-side rendering vs. server-side rendering?](https://www.quora.com/What-are-the-tradeoffs-of-client-side-rendering-vs-server-side-rendering)\n\n\u660e\u65e5\u306f\u65b0\u4eba\u306a\u306e\u306b\u5c71\u53e3\u767e\u6075\u306e\u30ab\u30e9\u30aa\u30b1\u304c\u5f97\u610f\u306a\u7267\u5c71\u541b\u306eGo\u306b\u3064\u3044\u3066\u306e\u8a18\u4e8b\u3067\u3059\u3002\u304a\u697d\u3057\u307f\u306b\u3002\n", "tags": ["PHP", "reactjs", "redux", "ssr", "v8js"]}