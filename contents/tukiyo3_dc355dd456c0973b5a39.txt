{"tags": ["keepalived"], "context": " More than 1 year has passed since last update.\n\n\u53c2\u8003\n\nHAProxy\u3092keepalived\u3067\u5197\u9577\u5316 - Qiita\n\u4eee\u60f3IP\u3092192.168.100.103\u3068\u3059\u308b\u3002\n\nCentOS7\u3067\u5b9f\u65bd\u3002\n\n\u4f3c\u305f\u30a2\u30d7\u30ea\u306bucarp\u304c\u3042\u308b\u304c\u3001\u3053\u3061\u3089\u306f\u3046\u307e\u304f\u52d5\u4f5c\u3057\u306a\u304b\u3063\u305f\u3002(\u4e21\u65b9\u306e\u30b5\u30fc\u30d0\u306b\u4eee\u60f3IP\u304c\u632f\u3089\u308c\u308b\u30fb\u30fb\u30fb)\n\n\n\n\n\u901a\u5e38master\u5074\n\n/etc/keepalived/keepalived.conf\nglobal_defs {\n   notification_email {\n     admin@hoge.com\n   }\n   notification_email_from master@hoge.com\n   smtp_server 192.168.100.3\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n}\n\nvrrp_instance VI_1 {\n   interface eth1\n   state MASTER\n   virtual_router_id 51\n   priority 101\n   virtual_ipaddress {\n       192.168.100.103\n   }\n}\n\n\n\n\u901a\u5e38backup\u5074\n\n/etc/keepalived/keepalived.conf\nglobal_defs {\n   notification_email {\n     admin@hoge.com\n   }\n   notification_email_from master@hoge.com\n   smtp_server 192.168.100.3\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n}\n\nvrrp_instance VI_1 {\n   interface eth1\n-  state MASTER\n+  state BACKUP\n   virtual_router_id 51\n-  priority 100\n+  priority 101\n   virtual_ipaddress {\n       192.168.100.103\n   }\n}\n\n\n\n\u30b5\u30fc\u30d3\u30b9\u767b\u9332\nsystemctl enable keepalived\nsystemctl start keepalived\n\n\n\u78ba\u8a8d\nwatch ip a\n\n\n\u4eee\u60f3IP\u304c\u7247\u65b9\u306e\u30b5\u30fc\u30d0\u306b\u5c45\u7d9a\u3051\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\nMASTER\u5074\u306e\u30b5\u30fc\u30d0\u3092\u518d\u8d77\u52d5\u3057\u3066\u3044\u308b\u9593\u306f\u3001BACKUP\u5074\u304c\u4eee\u60f3IP\u304c\u632f\u3089\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\nMASTER/BACKUP\u5207\u308a\u66ff\u308f\u308a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067ping\u304c\uff11\u56de\u7a0b\u5ea6\u3057\u304b\u843d\u3061\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3002\n\n\n## \u53c2\u8003\n\n* [HAProxy\u3092keepalived\u3067\u5197\u9577\u5316 - Qiita](http://qiita.com/shufo/items/1be4e3e644fa70cfb1b3)\n\n\n* \u4eee\u60f3IP\u3092192.168.100.103\u3068\u3059\u308b\u3002\n* CentOS7\u3067\u5b9f\u65bd\u3002\n  * \u4f3c\u305f\u30a2\u30d7\u30ea\u306bucarp\u304c\u3042\u308b\u304c\u3001\u3053\u3061\u3089\u306f\u3046\u307e\u304f\u52d5\u4f5c\u3057\u306a\u304b\u3063\u305f\u3002(\u4e21\u65b9\u306e\u30b5\u30fc\u30d0\u306b\u4eee\u60f3IP\u304c\u632f\u3089\u308c\u308b\u30fb\u30fb\u30fb)\n\n\n## \u901a\u5e38master\u5074\n\n```java:/etc/keepalived/keepalived.conf\nglobal_defs {\n   notification_email {\n     admin@hoge.com\n   }\n   notification_email_from master@hoge.com\n   smtp_server 192.168.100.3\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n}\n\nvrrp_instance VI_1 {\n   interface eth1\n   state MASTER\n   virtual_router_id 51\n   priority 101\n   virtual_ipaddress {\n       192.168.100.103\n   }\n}\n```\n\n## \u901a\u5e38backup\u5074\n\n```diff:/etc/keepalived/keepalived.conf\nglobal_defs {\n   notification_email {\n     admin@hoge.com\n   }\n   notification_email_from master@hoge.com\n   smtp_server 192.168.100.3\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n}\n\nvrrp_instance VI_1 {\n   interface eth1\n-  state MASTER\n+  state BACKUP\n   virtual_router_id 51\n-  priority 100\n+  priority 101\n   virtual_ipaddress {\n       192.168.100.103\n   }\n}\n```\n\n## \u30b5\u30fc\u30d3\u30b9\u767b\u9332\n\n```bash:\nsystemctl enable keepalived\nsystemctl start keepalived\n```\n\n## \u78ba\u8a8d\n\n```bash:\nwatch ip a\n```\n\n* \u4eee\u60f3IP\u304c\u7247\u65b9\u306e\u30b5\u30fc\u30d0\u306b\u5c45\u7d9a\u3051\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3002\n* MASTER\u5074\u306e\u30b5\u30fc\u30d0\u3092\u518d\u8d77\u52d5\u3057\u3066\u3044\u308b\u9593\u306f\u3001BACKUP\u5074\u304c\u4eee\u60f3IP\u304c\u632f\u3089\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\n* MASTER/BACKUP\u5207\u308a\u66ff\u308f\u308a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067ping\u304c\uff11\u56de\u7a0b\u5ea6\u3057\u304b\u843d\u3061\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3002\n"}