{"context": "\n\n\u3084\u308a\u305f\u3044\u3053\u3068\n\n\u666e\u901a\u306bRails\uff0bGrape\u3092\u4f7f\u3063\u3066\u3044\u308b\u3068\u3001\u30cf\u30f3\u30c9\u30eb\u3055\u308c\u306a\u3044\u4f8b\u5916\u304c\u767a\u751f\u3057\u305f\u3068\u304dRails\u306e\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u304c\u8fd4\u3063\u3066\u3057\u307e\u3046\u304c\u3001\u72ec\u81ea\u306eJSON\u3092\u8fd4\u3059\u3088\u3046\u306b\u3057\u305f\u3044\u3002HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u306f500\uff08Internal Server Error\uff09\u306b\u3057\u305f\u3044\u3002\nGrape\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30c1\u30a7\u30c3\u30af\u306b\u3072\u3063\u304b\u304b\u3063\u305f\u5834\u5408\u306fHTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u306f400\uff08Bad Request\uff09\u306b\u3057\u305f\u3044\u3002\n\n\n\u74b0\u5883\n\nRails 4.2.6\nGrape 0.16.2\n\n\n\u624b\u9806\n\u81ea\u5206\u306eAPI\u30af\u30e9\u30b9\u306b\u8a18\u8ff0\uff1a\nclass MyAPI < Grape::API\n  # rescue_from\u306f\u66f8\u3044\u305f\u9806\u756a\u306b\u30de\u30c3\u30c1\u30f3\u30b0\u3055\u308c\u308b\n\n  # Grape\u306e\u4f8b\u5916\u306e\u5834\u5408\u306f400\u3092\u8fd4\u3059\n  rescue_from Grape::Exceptions::Base do |e|\n    error!(e.message, 400)\n  end\n\n  # \u305d\u308c\u4ee5\u5916\u306f500\n  rescue_from :all do |e|\n    error!({error: e.message, backtrace: e.backtrace[0]}, 500)\n  end\nend\n\n\u3050\u3050\u308b\u3068error!\u3067\u306a\u304ferror_response\u3068\u3044\u3046\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u3044\u308b\u30da\u30fc\u30b8\u304c\u3042\u308b\u304c\u3001error_response\u306f\u975e\u63a8\u5968\u3089\u3057\u3044\uff1a\n\ngrape-0.16.2/lib/grape/middleware/error.rb\n      # TODO: This method is deprecated. Refactor out.\n      def error_response(error = {})\n\n\n# \u3084\u308a\u305f\u3044\u3053\u3068\n\n- \u666e\u901a\u306bRails\uff0bGrape\u3092\u4f7f\u3063\u3066\u3044\u308b\u3068\u3001\u30cf\u30f3\u30c9\u30eb\u3055\u308c\u306a\u3044\u4f8b\u5916\u304c\u767a\u751f\u3057\u305f\u3068\u304dRails\u306e\u30a8\u30e9\u30fc\u30da\u30fc\u30b8\u304c\u8fd4\u3063\u3066\u3057\u307e\u3046\u304c\u3001\u72ec\u81ea\u306eJSON\u3092\u8fd4\u3059\u3088\u3046\u306b\u3057\u305f\u3044\u3002HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u306f500\uff08Internal Server Error\uff09\u306b\u3057\u305f\u3044\u3002\n- Grape\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30c1\u30a7\u30c3\u30af\u306b\u3072\u3063\u304b\u304b\u3063\u305f\u5834\u5408\u306fHTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u306f400\uff08Bad Request\uff09\u306b\u3057\u305f\u3044\u3002\n\n# \u74b0\u5883\n\n- Rails 4.2.6\n- Grape 0.16.2\n\n# \u624b\u9806\n\n\u81ea\u5206\u306eAPI\u30af\u30e9\u30b9\u306b\u8a18\u8ff0\uff1a\n\n```\nclass MyAPI < Grape::API\n  # rescue_from\u306f\u66f8\u3044\u305f\u9806\u756a\u306b\u30de\u30c3\u30c1\u30f3\u30b0\u3055\u308c\u308b\n  \n  # Grape\u306e\u4f8b\u5916\u306e\u5834\u5408\u306f400\u3092\u8fd4\u3059\n  rescue_from Grape::Exceptions::Base do |e|\n    error!(e.message, 400)\n  end\n\n  # \u305d\u308c\u4ee5\u5916\u306f500\n  rescue_from :all do |e|\n    error!({error: e.message, backtrace: e.backtrace[0]}, 500)\n  end\nend\n```\n\n\u3050\u3050\u308b\u3068`error!`\u3067\u306a\u304f`error_response`\u3068\u3044\u3046\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3063\u3066\u3044\u308b\u30da\u30fc\u30b8\u304c\u3042\u308b\u304c\u3001`error_response`\u306f\u975e\u63a8\u5968\u3089\u3057\u3044\uff1a\n\n```grape-0.16.2/lib/grape/middleware/error.rb\n      # TODO: This method is deprecated. Refactor out.\n      def error_response(error = {})\n```\n", "tags": ["Rails4", "grape"]}