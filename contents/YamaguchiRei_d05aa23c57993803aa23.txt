{"context": " More than 1 year has passed since last update.\u6700\u8fd1\u3067\u3082\u306a\u3044\u3067\u3059\u304c\u3001RDS\u3068\u304b\u3092\u4f7f\u3046\u3068\u30ea\u30be\u30eb\u30d0\u304c\u6b7b\u306c\u3068\u5f71\u97ff\u3067\u307e\u3059\u3088\u306d\u30fc\u3002\n\u305d\u306e\u4e00\u65b9\u3067\u3001\u610f\u5916\u3068\u3061\u3083\u3093\u3068\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044resolv.conf\u306b\u3064\u3044\u3066\u8a73\u3057\u304f\u3002\n\n\u307e\u305a\u30c7\u30d5\u30a9\u30eb\u30c8\u3063\u3066\u3069\u3093\u306a\u3060\u3063\u3051\uff1f\n\u6700\u5c0f\u9650\u3067\u66f8\u304f\u3068\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nresolv.conf\nnameserver 192.168.33.10  #1\u53f7\u6a5f\nnameserver 192.168.33.11  #2\u53f7\u6a5f\n\n\n\u4ee5\u5f8c\u3001IP\u3060\u3068\u308f\u304b\u308a\u306b\u304f\u3044\u306e\u3067\u3001192.168.33.10\u30921\u53f7\u6a5f\u3001192.168.33.11\u30922\u53f7\u6a5f\u3068\u547c\u3073\u307e\u3059\u3002\n\n1\u53f7\u6a5f\u304c\u30ce\u30fc\u30c9\u307e\u308b\u3054\u3068\u843d\u3061\u305f\uff08IP\u7684\u306b\u6b7b\u4ea1\uff09\n\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067\u30011\u53f7\u6a5f\u306eIP\u3092\u5b58\u5728\u3057\u306a\u3044192.168.33.101\u306b\u5909\u3048\u3066\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n[root@localhost ~]# strace -tt route\n06:18:35.238838 execve(\"/sbin/route\", [\"route\"], [/* 17 vars */]) = 0\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:18:35.243618 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.101\")}, 16) = 0\n06:18:35.243646 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:18:35.243666 sendto(4, \"\\n\\251\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:18:35.243689 poll([{fd=4, events=POLLIN}], 1, 5000) = 0 (Timeout)\n06:18:40.248851 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:18:40.248894 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.11\")}, 16) = 0\n06:18:40.248923 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:18:40.248944 sendto(5, \"\\n\\251\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:18:40.249154 poll([{fd=5, events=POLLIN}], 1, 5000) = 1 ([{fd=5, revents=POLLIN}])\n06:18:40.249475 ioctl(5, FIONREAD, [116]) = 0\n06:18:40.249521 recvfrom(5, \"\\n\\251\\201\\203\\0\\1\\0\\0\\0\\1\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 1024, 0, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.11\")}, [16]) = 116\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:18:40.249813 +++ exited with 0 +++\n\n1\u53f7\u6a5f\u306f5\u79d2\u3067\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\uff0806:18:35.243689\uff09\u3057\u3066\u30012\u53f7\u6a5f\u306b\u63a5\u7d9a\u3057\u306b\u3044\u3063\u3066\u7d50\u679c\u3092\u5f97\u3066\uff0806:18:40.249521\uff09\u3044\u307e\u3059\u3002\n\n1\u53f7\u6a5f\u304c\u30b5\u30fc\u30d3\u30b9\u3060\u3051\u6b7b\u3093\u3060\uff08\u30dd\u30fc\u30c8\u3060\u3051\u6b7b\u4ea1\uff09\nIP\u306f\u5143\u306b\u623b\u3057\u3066\u3001\u30b5\u30fc\u30d3\u30b9\u3092\u843d\u3068\u3057\u3066\u8a66\u3057\u307e\u3059\u3002\n06:29:52.984867 execve(\"/sbin/route\", [\"route\"], [/* 17 vars */]) = 0\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:29:52.989791 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:29:52.989818 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:29:52.989838 sendto(4, \"\\325|\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:29:52.989904 poll([{fd=4, events=POLLIN}], 1, 5000) = 1 ([{fd=4, revents=POLLERR}])\n06:29:52.990147 close(4)                = 0\n06:29:52.990166 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:29:52.990184 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.11\")}, 16) = 0\n06:29:52.990208 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:29:52.990226 sendto(4, \"\\325|\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:29:52.990311 poll([{fd=4, events=POLLIN}], 1, 5000) = 1 ([{fd=4, revents=POLLIN}])\n06:29:53.110923 ioctl(4, FIONREAD, [116]) = 0\n06:29:52.989904 recvfrom(4, \"\\325|\\201\\203\\0\\1\\0\\0\\0\\1\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 1024, 0, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.11\")}, [16]) = 116\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:29:53.111217 +++ exited with 0 +++\n\n\u30dd\u30fc\u30c8\u304c\u958b\u3044\u3066\u3044\u306a\u3044\u306e\u30671\u53f7\u6a5f\u306f\u5373\u5ea7\u306bPOLLERR\uff0806:29:52.989904\uff09\u30012\u53f7\u6a5f\u306b\u805e\u304d\u306b\u884c\u3063\u3066\uff0806:29:52.989904\uff09\u4e8b\u306a\u304d\u3092\u5f97\u3066\u3044\u307e\u3059\u3002\n\n\u305d\u3057\u3066\u305d\u3082\u305d\u3082\u3069\u3093\u306a\u6319\u52d5\u3060\u3063\u3051\uff1f\nresolv.conf\u306e\u30de\u30cb\u30e5\u30a2\u30eb\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u4e3b\u8981\u90e8\u5206\u3092\u629c\u7c8b\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\nnameserver\n\u8907\u6570\u306e\u30b5\u30fc\u30d0\u304c\u6307\u5b9a\u3055\u308c\u305f\u5834\u5408\u3001\u30ec\u30be\u30eb\u30d0\u30e9\u30a4\u30d6\u30e9\u30ea\u306f \u30ea\u30b9\u30c8\u3055\u308c\u305f\u9806\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3046\u3002\noptions timeout:n\n\u300c\u30ec\u30be\u30eb\u30d0\u304c\u4ed6\u306e\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u3067\u554f\u3044\u5408\u308f\u305b\u3092\u30ea\u30c8\u30e9\u30a4\u3059\u308b\u524d\u306b\u3001 \u30ea\u30e2\u30fc\u30c8\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u3092\u5f85\u3064\u6642\u9593\u300d\u3092\u8a2d\u5b9a\u3059\u308b\u3002 \u5358\u4f4d\u306f\u79d2\u3067\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306f RES_TIMEOUT \u3067\u3042\u308b (\u73fe\u72b6\u3067\u306f 5 \u79d2\u3001 \u3092\u53c2\u7167)\u3002 \n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u3053\u3053\u307e\u3067\u306e\u30c6\u30b9\u30c8\u3060\u3068\u5fc5\u305a1\u53f7\u6a5f\u306b\u5148\u306b\u554f\u3044\u5408\u308f\u305b\u3057\u3066\u3001\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u5f85\u3064\u5834\u5408\u306f5\u79d2\u3068\u3044\u3046\u3053\u3068\u3067\u30de\u30cb\u30e5\u30a2\u30eb\u901a\u308a\u306e\u6319\u52d5\u3067\u3059\u3002\n\n\u8010\u969c\u5bb3\u6027\u306e\u305f\u3081\u306bresolv.conf\u3067\u51fa\u6765\u308b\u3053\u3068\n\u7d50\u8ad6\u304b\u3089\u8a00\u3046\u3068\u3001\u5b9f\u306f\u5927\u3057\u3066\u306a\u3044\u3093\u3067\u3059\u3088\u306d\u3001\u3053\u308c\u3002\u3002\u3002\n\u8fd1\u3057\u3044\u3068\u3053\u308d\u3067\u3084\u308c\u308b\u3053\u3068\u306f\u3053\u306e\u3042\u305f\u308a\u3067\u3059\u3002\n\u307e\u305a\u3001\u5148\u307b\u3069\u306etimeout\u3092\u7e2e\u3081\u308b\u3068\u3001\u6b21\u306e\u30b5\u30fc\u30d0\u3078\u306e\u30ea\u30c8\u30e9\u30a4\u304c\u65e9\u304f\u306a\u308a\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001\u30a8\u30e9\u30fc\u3067\u8ae6\u3081\u308b\u3053\u3068\u3092\u76ee\u7684\u3068\u3059\u308b\u306e\u3067\u3042\u308c\u3070\u3001attempts\u3092\u5c0f\u3055\u304f\u3059\u308b\u3068\u3001\u65e9\u3005\u306b\u8ae6\u3081\u3066\u30a8\u30e9\u30fc\u51e6\u7406\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3053\u308c\u306f nameserver\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u3001\u305d\u308c\u3089\u4e00\u5f0f\u306b\u9069\u7528 \u3055\u308c\u307e\u3059\u3002\uff08\u306a\u306e\u30671\u306b\u3057\u3066\u3082\u30011\u30bb\u30c3\u30c8\u306f\u3084\u3063\u3066\u304f\u308c\u308b\uff09\n\noptions attempts:n\n\u300c\u30ec\u30be\u30eb\u30d0\u304c\u8ae6\u3081\u3066\u547c\u3073\u51fa\u3057\u5143\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u30a8\u30e9\u30fc\u3092\u8fd4\u3059\u307e\u3067\u306b\u3001 \u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3046\u56de\u6570\u300d\u3092\u8a2d\u5b9a\u3059\u308b\u3002 \u30c7\u30d5\u30a9\u30eb\u30c8\u306f RES_DFLRETRY \u56de\u3067\u3042\u308b (\u73fe\u72b6\u3067\u306f 2 \u56de\u3001 \u3092\u53c2\u7167)\u3002 \u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5024\u306e\u4e0a\u9650\u306f 5 \u3067\u3042\u308a\u3001\u9ed9\u3063\u3066\u3053\u306e\u5024\u307e\u3067\u5207\u308a\u8a70\u3081\u3089\u308c\u308b\u3002\n\n\u305d\u306e\u4ed6\u3001rotate\u3059\u308b\u3068\u554f\u3044\u5408\u308f\u305b\u306e\u9806\u756a\u3092\u5909\u3048\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u969c\u5bb3\u6a5f\u3067\u306a\u3044\u3082\u306e\u306b\u884c\u3063\u3066\u304f\u308c\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\noptions rotate\n\u30ea\u30b9\u30c8\u3055\u308c\u3066\u3044\u308b\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u304b\u3089\u9078\u3076\u3068\u304d\u306b\u3001\u30e9\u30a6\u30f3\u30c9\u30ed\u30d3\u30f3 (round-robin) \u9078\u629e\u3092\u884c\u308f\u305b\u308b\u3002\u30ea\u30b9\u30c8\u3055\u308c\u3066\u3044\u308b\u5168\u3066\u306e\u30b5\u30fc\u30d0\u3067\u554f\u3044\u5408\u308f\u305b\u306e\u8ca0\u8377\u3092\u5206\u6563\u3059\u308b\u52b9\u679c\u304c\u3042\u308a\u3001\u6700\u521d\u306b\u30ea\u30b9\u30c8\u3055\u308c\u305f\u30b5\u30fc\u30d0\u306b\u5168\u3066\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u6bce\u56de\u6700\u521d\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3046\u308f\u3051\u3067\u306f\u306a\u304f\u306a\u308b\u3002\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u3053\u308c\u3089\u3092\u8a66\u3057\u306b\u30bb\u30c3\u30c8\u3057\u3066strace\u3057\u3066\u307f\u307e\u3059\u3002\uff08\u308f\u304b\u308a\u3084\u3059\u304f\u3001options timeout:3 attempts:5 rotate\u306b\u3057\u307e\u3057\u305f\uff09\n[root@localhost ~]# strace -tt route\n06:57:36.523619 execve(\"/sbin/route\", [\"route\"], [/* 17 vars */]) = 0\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:57:36.528604 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:57:36.528633 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:36.528654 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:36.529175 poll([{fd=4, events=POLLIN}], 1, 3000) = 1 ([{fd=4, revents=POLLERR}])\n06:57:36.529200 close(4)                = 0\n06:57:36.529256 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:57:36.529276 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:57:36.529301 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:36.529321 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:36.529340 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:57:38.531494 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:57:38.531535 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:57:38.531569 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:57:38.531590 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:38.531615 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:57:42.535756 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 6\n06:57:42.535796 connect(6, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:57:42.535826 poll([{fd=6, events=POLLOUT}], 1, 0) = 1 ([{fd=6, revents=POLLOUT}])\n06:57:42.535847 sendto(6, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:42.535931 poll([{fd=6, events=POLLIN}], 1, 3000) = 1 ([{fd=6, revents=POLLERR}])\n06:57:42.536214 close(6)                = 0\n06:57:42.536256 close(4)                = 0\n06:57:42.536282 close(5)                = 0\n06:57:42.536306 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:57:42.536352 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:57:42.536390 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:42.536435 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:42.536463 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:57:44.538183 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:57:44.538225 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:57:44.538255 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:57:44.538276 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:44.538300 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:57:48.543322 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 6\n06:57:48.543363 connect(6, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:57:48.543393 poll([{fd=6, events=POLLOUT}], 1, 0) = 1 ([{fd=6, revents=POLLOUT}])\n06:57:48.543414 sendto(6, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:48.543490 poll([{fd=6, events=POLLIN}], 1, 3000) = 1 ([{fd=6, revents=POLLERR}])\n06:57:48.543728 close(6)                = 0\n06:57:48.543751 close(4)                = 0\n06:57:48.543768 close(5)                = 0\n06:57:48.543784 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:57:48.543801 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:57:48.543821 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:48.543838 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:48.543858 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:57:50.545999 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:57:50.546040 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:57:50.546069 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:57:50.546090 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:50.546115 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:57:54.550286 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 6\n06:57:54.550328 connect(6, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:57:54.550358 poll([{fd=6, events=POLLOUT}], 1, 0) = 1 ([{fd=6, revents=POLLOUT}])\n06:57:54.550378 sendto(6, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:54.550464 poll([{fd=6, events=POLLIN}], 1, 3000) = 1 ([{fd=6, revents=POLLERR}])\n06:57:54.550716 close(6)                = 0\n06:57:54.550739 close(4)                = 0\n06:57:54.550755 close(5)                = 0\n06:57:54.550770 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:57:54.550788 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:57:54.550806 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:54.550823 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:54.550842 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:57:56.552982 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:57:56.553023 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:57:56.553052 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:57:56.553073 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:56.553097 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:58:00.558031 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 6\n06:58:00.558074 connect(6, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:58:00.558104 poll([{fd=6, events=POLLOUT}], 1, 0) = 1 ([{fd=6, revents=POLLOUT}])\n06:58:00.558125 sendto(6, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:58:00.558212 poll([{fd=6, events=POLLIN}], 1, 3000) = 1 ([{fd=6, revents=POLLERR}])\n06:58:00.558429 close(6)                = 0\n06:58:00.558455 close(4)                = 0\n06:58:00.558471 close(5)                = 0\n06:58:00.558487 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:58:00.558505 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:58:00.558525 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:58:00.558543 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:58:00.558563 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:58:02.560695 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:58:02.560736 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:58:02.560766 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:58:02.560786 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:58:02.560811 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:58:06.564969 close(4)                = 0\n06:58:06.565010 close(5)                = 0\n06:58:06.565045 write(1, \"default         10.0.2.2        \"..., 77default         10.0.2.2        0.0.0.0         UG    0      0        0 eth0\n) = 77\n06:58:06.565069 read(3, \"\", 1024)       = 0\n06:58:06.565089 close(3)                = 0\n06:58:06.565109 munmap(0x7f6dab081000, 4096) = 0\n06:58:06.565152 exit_group(0)           = ?\n06:58:06.565226 +++ exited with 0 +++\n\n\u9577\u3044\u3067\u3059\u304c\u3001\u30dd\u30a4\u30f3\u30c8\u306f\u5927\u3057\u3066\u3042\u308a\u307e\u305b\u3093\n\n\npoll()\u3067POLLIN\u3057\u3066\u3044\u308b\u884c\u304c3000ms -> 2000ms -> 4000ms\u30921\u30bb\u30c3\u30c8\u3068\u3057\u30665\u56de\uff08attempts\u5206\uff09\n\nconnect()\u3067\u63a5\u7d9a\u3057\u3066\u3044\u308binet_addr\u304c\u30e9\u30f3\u30c0\u30e0\u306b\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001 3\u53f0\u306enameserver\u306b\u5bfe\u3057timeout:1 attempts:1 rotate:1\u3068\u8a2d\u5b9a\u3059\u308b\u3068\u3001\u6700\u901f\u306e3\u79d2\u3067\u8ae6\u3081\u3066\u304f\u308c\u3001\u30e9\u30f3\u30c0\u30e0\u306a\u306e\u3067\u3082\u3057\u304b\u3059\u308b\u3068\u969c\u5bb3\u6a5f\u3067\u306a\u3044\u3082\u306e\u306b\u3042\u305f\u3063\u3066\u304f\u308c\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3001\u3068\u3044\u3046\u306e\u304c\u6700\u5927\u9650\u3067\u3059\u3002\u5bfe\u7b56\u306b\u306a\u3063\u3066\u3044\u306a\u3044\u3067\u3059\u3088\u306d\u3002\u3002\u3002\u3067\u3082\u3001resolv.conf\u306e\u7cbe\u4e00\u676f\u306f\u3053\u3053\u3067\u3059\u3002\uff083\u53f0\u3068\u3044\u3046\u306e\u306f\u3001nameserver\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u4e0a\u9650\u5024\u304c3\u53f0\u306a\u306e\u3067\u3002\uff09\n\u3061\u306a\u307f\u306b\u3001POLLIN\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u306e\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u5024\u3067\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u8a73\u3057\u3044\u3067\u3059\u3002\n/etc/resolv.conf\u3068\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u79d2\n\n\u305d\u3093\u306a\u306e\u3058\u3083\u56f0\u308b\u3093\u3060\u3051\u3069\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001resolv.conf\u306b\u62d8\u3089\u305a\u3001\u306a\u3093\u3068\u304b\u3059\u308b\u624b\u6bb5\u3092\u8003\u3048\u307e\u3059\u3002\n\nnameserver\u3092VIP\u306b\u3059\u308b\n\u304a\u91d1\u6301\u3061\u306e\u3068\u3053\u308d\u306f\u3053\u308c\u304c\u591a\u3044\u3088\u3046\u306b\u601d\u3044\u307e\u3059\u3002\u6b7b\u6d3b\u51fa\u6765\u308b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u914d\u4e0b\u306bnameserver\u3092\u3076\u3089\u4e0b\u3052\u3001VIP\u306enameserver\u3068\u3057\u3066\u63d0\u4f9b\u3057\u307e\u3059\u3002\u5b89\u5fc3\u3060\u3051\u308c\u3069\u3082\u3001ELB\u3060\u3068\u3053\u308c\u51fa\u6765\u306a\u3044\u3067\u3059\u306d\u3002\u3002\u3002\n\n\u30b5\u30fc\u30d0\u81ea\u8eab\u3092\u5f37\u5316\u3059\u308b\nresolv.conf\u3067\u51fa\u6765\u306a\u3044\u306a\u3089\u3001\u4f55\u304b\u5165\u308c\u3061\u3083\u3044\u307e\u3057\u3087\u3046\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u5165\u308c\u3089\u308c\u308bunbound\u3092\u4f7f\u3046\u3068\u304b\u3067\u3057\u3087\u3046\u304b\u3002Linux\u81ea\u8eab\u306e\u4ed5\u7d44\u307f\u3092\u4f7f\u308f\u306a\u3044\u3053\u3068\u3067\u3001resolv.conf\u306e\u5236\u7d04\u306f\u53d7\u3051\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\u53c2\u8003\nDNS unbound\u30b5\u30fc\u30d0\u69cb\u7bc9\u624b\u9806(yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\n\u6700\u8fd1\u3067\u3082\u306a\u3044\u3067\u3059\u304c\u3001RDS\u3068\u304b\u3092\u4f7f\u3046\u3068\u30ea\u30be\u30eb\u30d0\u304c\u6b7b\u306c\u3068\u5f71\u97ff\u3067\u307e\u3059\u3088\u306d\u30fc\u3002\n\u305d\u306e\u4e00\u65b9\u3067\u3001\u610f\u5916\u3068\u3061\u3083\u3093\u3068\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044`resolv.conf`\u306b\u3064\u3044\u3066\u8a73\u3057\u304f\u3002\n\n## \u307e\u305a\u30c7\u30d5\u30a9\u30eb\u30c8\u3063\u3066\u3069\u3093\u306a\u3060\u3063\u3051\uff1f\n\u6700\u5c0f\u9650\u3067\u66f8\u304f\u3068\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n```resolv.conf\nnameserver 192.168.33.10  #1\u53f7\u6a5f\nnameserver 192.168.33.11  #2\u53f7\u6a5f\n```\n\n\u4ee5\u5f8c\u3001IP\u3060\u3068\u308f\u304b\u308a\u306b\u304f\u3044\u306e\u3067\u3001`192.168.33.10`\u30921\u53f7\u6a5f\u3001`192.168.33.11`\u30922\u53f7\u6a5f\u3068\u547c\u3073\u307e\u3059\u3002\n\n### 1\u53f7\u6a5f\u304c\u30ce\u30fc\u30c9\u307e\u308b\u3054\u3068\u843d\u3061\u305f\uff08IP\u7684\u306b\u6b7b\u4ea1\uff09\n\u3081\u3093\u3069\u304f\u3055\u3044\u306e\u3067\u30011\u53f7\u6a5f\u306eIP\u3092\u5b58\u5728\u3057\u306a\u3044`192.168.33.101`\u306b\u5909\u3048\u3066\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n[root@localhost ~]# strace -tt route\n06:18:35.238838 execve(\"/sbin/route\", [\"route\"], [/* 17 vars */]) = 0\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:18:35.243618 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.101\")}, 16) = 0\n06:18:35.243646 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:18:35.243666 sendto(4, \"\\n\\251\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:18:35.243689 poll([{fd=4, events=POLLIN}], 1, 5000) = 0 (Timeout)\n06:18:40.248851 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:18:40.248894 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.11\")}, 16) = 0\n06:18:40.248923 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:18:40.248944 sendto(5, \"\\n\\251\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:18:40.249154 poll([{fd=5, events=POLLIN}], 1, 5000) = 1 ([{fd=5, revents=POLLIN}])\n06:18:40.249475 ioctl(5, FIONREAD, [116]) = 0\n06:18:40.249521 recvfrom(5, \"\\n\\251\\201\\203\\0\\1\\0\\0\\0\\1\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 1024, 0, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.11\")}, [16]) = 116\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:18:40.249813 +++ exited with 0 +++\n```\n\n1\u53f7\u6a5f\u306f5\u79d2\u3067\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\uff0806:18:35.243689\uff09\u3057\u3066\u30012\u53f7\u6a5f\u306b\u63a5\u7d9a\u3057\u306b\u3044\u3063\u3066\u7d50\u679c\u3092\u5f97\u3066\uff0806:18:40.249521\uff09\u3044\u307e\u3059\u3002\n\n### 1\u53f7\u6a5f\u304c\u30b5\u30fc\u30d3\u30b9\u3060\u3051\u6b7b\u3093\u3060\uff08\u30dd\u30fc\u30c8\u3060\u3051\u6b7b\u4ea1\uff09\nIP\u306f\u5143\u306b\u623b\u3057\u3066\u3001\u30b5\u30fc\u30d3\u30b9\u3092\u843d\u3068\u3057\u3066\u8a66\u3057\u307e\u3059\u3002\n\n```\n06:29:52.984867 execve(\"/sbin/route\", [\"route\"], [/* 17 vars */]) = 0\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:29:52.989791 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:29:52.989818 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:29:52.989838 sendto(4, \"\\325|\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:29:52.989904 poll([{fd=4, events=POLLIN}], 1, 5000) = 1 ([{fd=4, revents=POLLERR}])\n06:29:52.990147 close(4)                = 0\n06:29:52.990166 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:29:52.990184 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.11\")}, 16) = 0\n06:29:52.990208 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:29:52.990226 sendto(4, \"\\325|\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:29:52.990311 poll([{fd=4, events=POLLIN}], 1, 5000) = 1 ([{fd=4, revents=POLLIN}])\n06:29:53.110923 ioctl(4, FIONREAD, [116]) = 0\n06:29:52.989904 recvfrom(4, \"\\325|\\201\\203\\0\\1\\0\\0\\0\\1\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 1024, 0, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.11\")}, [16]) = 116\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:29:53.111217 +++ exited with 0 +++\n```\n\n\u30dd\u30fc\u30c8\u304c\u958b\u3044\u3066\u3044\u306a\u3044\u306e\u30671\u53f7\u6a5f\u306f\u5373\u5ea7\u306b`POLLERR`\uff0806:29:52.989904\uff09\u30012\u53f7\u6a5f\u306b\u805e\u304d\u306b\u884c\u3063\u3066\uff0806:29:52.989904\uff09\u4e8b\u306a\u304d\u3092\u5f97\u3066\u3044\u307e\u3059\u3002\n\n### \u305d\u3057\u3066\u305d\u3082\u305d\u3082\u3069\u3093\u306a\u6319\u52d5\u3060\u3063\u3051\uff1f\n[`resolv.conf`\u306e\u30de\u30cb\u30e5\u30a2\u30eb](https://linuxjm.osdn.jp/html/LDP_man-pages/man5/resolv.conf.5.html)\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u4e3b\u8981\u90e8\u5206\u3092\u629c\u7c8b\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n> **nameserver**\n> \u8907\u6570\u306e\u30b5\u30fc\u30d0\u304c\u6307\u5b9a\u3055\u308c\u305f\u5834\u5408\u3001\u30ec\u30be\u30eb\u30d0\u30e9\u30a4\u30d6\u30e9\u30ea\u306f \u30ea\u30b9\u30c8\u3055\u308c\u305f\u9806\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3046\u3002\n\n> **options timeout:n**\n> \u300c\u30ec\u30be\u30eb\u30d0\u304c\u4ed6\u306e\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u3067\u554f\u3044\u5408\u308f\u305b\u3092\u30ea\u30c8\u30e9\u30a4\u3059\u308b\u524d\u306b\u3001 \u30ea\u30e2\u30fc\u30c8\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u3092\u5f85\u3064\u6642\u9593\u300d\u3092\u8a2d\u5b9a\u3059\u308b\u3002 \u5358\u4f4d\u306f\u79d2\u3067\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306f RES_TIMEOUT \u3067\u3042\u308b (\u73fe\u72b6\u3067\u306f 5 \u79d2\u3001<resolv.h> \u3092\u53c2\u7167)\u3002 \n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u3053\u3053\u307e\u3067\u306e\u30c6\u30b9\u30c8\u3060\u3068\u5fc5\u305a1\u53f7\u6a5f\u306b\u5148\u306b\u554f\u3044\u5408\u308f\u305b\u3057\u3066\u3001\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u5f85\u3064\u5834\u5408\u306f5\u79d2\u3068\u3044\u3046\u3053\u3068\u3067\u30de\u30cb\u30e5\u30a2\u30eb\u901a\u308a\u306e\u6319\u52d5\u3067\u3059\u3002\n\n## \u8010\u969c\u5bb3\u6027\u306e\u305f\u3081\u306bresolv.conf\u3067\u51fa\u6765\u308b\u3053\u3068\n\u7d50\u8ad6\u304b\u3089\u8a00\u3046\u3068\u3001\u5b9f\u306f\u5927\u3057\u3066\u306a\u3044\u3093\u3067\u3059\u3088\u306d\u3001\u3053\u308c\u3002\u3002\u3002\n\u8fd1\u3057\u3044\u3068\u3053\u308d\u3067\u3084\u308c\u308b\u3053\u3068\u306f\u3053\u306e\u3042\u305f\u308a\u3067\u3059\u3002\n\n\u307e\u305a\u3001\u5148\u307b\u3069\u306e`timeout`\u3092\u7e2e\u3081\u308b\u3068\u3001\u6b21\u306e\u30b5\u30fc\u30d0\u3078\u306e\u30ea\u30c8\u30e9\u30a4\u304c\u65e9\u304f\u306a\u308a\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001\u30a8\u30e9\u30fc\u3067\u8ae6\u3081\u308b\u3053\u3068\u3092\u76ee\u7684\u3068\u3059\u308b\u306e\u3067\u3042\u308c\u3070\u3001`attempts`\u3092\u5c0f\u3055\u304f\u3059\u308b\u3068\u3001\u65e9\u3005\u306b\u8ae6\u3081\u3066\u30a8\u30e9\u30fc\u51e6\u7406\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u3053\u308c\u306f **nameserver\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u3001\u305d\u308c\u3089\u4e00\u5f0f\u306b\u9069\u7528** \u3055\u308c\u307e\u3059\u3002\uff08\u306a\u306e\u30671\u306b\u3057\u3066\u3082\u30011\u30bb\u30c3\u30c8\u306f\u3084\u3063\u3066\u304f\u308c\u308b\uff09\n\n> **options attempts:n**\n> \u300c\u30ec\u30be\u30eb\u30d0\u304c\u8ae6\u3081\u3066\u547c\u3073\u51fa\u3057\u5143\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u30a8\u30e9\u30fc\u3092\u8fd4\u3059\u307e\u3067\u306b\u3001 \u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3046\u56de\u6570\u300d\u3092\u8a2d\u5b9a\u3059\u308b\u3002 \u30c7\u30d5\u30a9\u30eb\u30c8\u306f RES_DFLRETRY \u56de\u3067\u3042\u308b (\u73fe\u72b6\u3067\u306f 2 \u56de\u3001<resolv.h> \u3092\u53c2\u7167)\u3002 \u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5024\u306e\u4e0a\u9650\u306f 5 \u3067\u3042\u308a\u3001\u9ed9\u3063\u3066\u3053\u306e\u5024\u307e\u3067\u5207\u308a\u8a70\u3081\u3089\u308c\u308b\u3002\n\n\u305d\u306e\u4ed6\u3001`rotate`\u3059\u308b\u3068\u554f\u3044\u5408\u308f\u305b\u306e\u9806\u756a\u3092\u5909\u3048\u3066\u304f\u308c\u308b\u306e\u3067\u3001\u969c\u5bb3\u6a5f\u3067\u306a\u3044\u3082\u306e\u306b\u884c\u3063\u3066\u304f\u308c\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n> **options rotate**\n> \u30ea\u30b9\u30c8\u3055\u308c\u3066\u3044\u308b\u30cd\u30fc\u30e0\u30b5\u30fc\u30d0\u304b\u3089\u9078\u3076\u3068\u304d\u306b\u3001\u30e9\u30a6\u30f3\u30c9\u30ed\u30d3\u30f3 (round-robin) \u9078\u629e\u3092\u884c\u308f\u305b\u308b\u3002\u30ea\u30b9\u30c8\u3055\u308c\u3066\u3044\u308b\u5168\u3066\u306e\u30b5\u30fc\u30d0\u3067\u554f\u3044\u5408\u308f\u305b\u306e\u8ca0\u8377\u3092\u5206\u6563\u3059\u308b\u52b9\u679c\u304c\u3042\u308a\u3001\u6700\u521d\u306b\u30ea\u30b9\u30c8\u3055\u308c\u305f\u30b5\u30fc\u30d0\u306b\u5168\u3066\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u6bce\u56de\u6700\u521d\u306b\u554f\u3044\u5408\u308f\u305b\u3092\u884c\u3046\u308f\u3051\u3067\u306f\u306a\u304f\u306a\u308b\u3002\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u3053\u308c\u3089\u3092\u8a66\u3057\u306b\u30bb\u30c3\u30c8\u3057\u3066`strace`\u3057\u3066\u307f\u307e\u3059\u3002\uff08\u308f\u304b\u308a\u3084\u3059\u304f\u3001`options timeout:3 attempts:5 rotate`\u306b\u3057\u307e\u3057\u305f\uff09\n\n```\n[root@localhost ~]# strace -tt route\n06:57:36.523619 execve(\"/sbin/route\", [\"route\"], [/* 17 vars */]) = 0\n\uff08\u9014\u4e2d\u7701\u7565\uff09\n06:57:36.528604 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:57:36.528633 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:36.528654 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:36.529175 poll([{fd=4, events=POLLIN}], 1, 3000) = 1 ([{fd=4, revents=POLLERR}])\n06:57:36.529200 close(4)                = 0\n06:57:36.529256 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:57:36.529276 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:57:36.529301 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:36.529321 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:36.529340 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:57:38.531494 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:57:38.531535 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:57:38.531569 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:57:38.531590 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:38.531615 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:57:42.535756 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 6\n06:57:42.535796 connect(6, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:57:42.535826 poll([{fd=6, events=POLLOUT}], 1, 0) = 1 ([{fd=6, revents=POLLOUT}])\n06:57:42.535847 sendto(6, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:42.535931 poll([{fd=6, events=POLLIN}], 1, 3000) = 1 ([{fd=6, revents=POLLERR}])\n06:57:42.536214 close(6)                = 0\n06:57:42.536256 close(4)                = 0\n06:57:42.536282 close(5)                = 0\n06:57:42.536306 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:57:42.536352 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:57:42.536390 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:42.536435 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:42.536463 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:57:44.538183 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:57:44.538225 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:57:44.538255 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:57:44.538276 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:44.538300 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:57:48.543322 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 6\n06:57:48.543363 connect(6, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:57:48.543393 poll([{fd=6, events=POLLOUT}], 1, 0) = 1 ([{fd=6, revents=POLLOUT}])\n06:57:48.543414 sendto(6, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:48.543490 poll([{fd=6, events=POLLIN}], 1, 3000) = 1 ([{fd=6, revents=POLLERR}])\n06:57:48.543728 close(6)                = 0\n06:57:48.543751 close(4)                = 0\n06:57:48.543768 close(5)                = 0\n06:57:48.543784 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:57:48.543801 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:57:48.543821 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:48.543838 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:48.543858 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:57:50.545999 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:57:50.546040 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:57:50.546069 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:57:50.546090 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:50.546115 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:57:54.550286 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 6\n06:57:54.550328 connect(6, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:57:54.550358 poll([{fd=6, events=POLLOUT}], 1, 0) = 1 ([{fd=6, revents=POLLOUT}])\n06:57:54.550378 sendto(6, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:54.550464 poll([{fd=6, events=POLLIN}], 1, 3000) = 1 ([{fd=6, revents=POLLERR}])\n06:57:54.550716 close(6)                = 0\n06:57:54.550739 close(4)                = 0\n06:57:54.550755 close(5)                = 0\n06:57:54.550770 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:57:54.550788 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:57:54.550806 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:57:54.550823 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:54.550842 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:57:56.552982 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:57:56.553023 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:57:56.553052 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:57:56.553073 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:57:56.553097 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:58:00.558031 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 6\n06:58:00.558074 connect(6, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.10\")}, 16) = 0\n06:58:00.558104 poll([{fd=6, events=POLLOUT}], 1, 0) = 1 ([{fd=6, revents=POLLOUT}])\n06:58:00.558125 sendto(6, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:58:00.558212 poll([{fd=6, events=POLLIN}], 1, 3000) = 1 ([{fd=6, revents=POLLERR}])\n06:58:00.558429 close(6)                = 0\n06:58:00.558455 close(4)                = 0\n06:58:00.558471 close(5)                = 0\n06:58:00.558487 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 4\n06:58:00.558505 connect(4, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.111\")}, 16) = 0\n06:58:00.558525 poll([{fd=4, events=POLLOUT}], 1, 0) = 1 ([{fd=4, revents=POLLOUT}])\n06:58:00.558543 sendto(4, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:58:00.558563 poll([{fd=4, events=POLLIN}], 1, 2000) = 0 (Timeout)\n06:58:02.560695 socket(PF_INET, SOCK_DGRAM|SOCK_NONBLOCK, IPPROTO_IP) = 5\n06:58:02.560736 connect(5, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(\"192.168.33.100\")}, 16) = 0\n06:58:02.560766 poll([{fd=5, events=POLLOUT}], 1, 0) = 1 ([{fd=5, revents=POLLOUT}])\n06:58:02.560786 sendto(5, \"n\\314\\1\\0\\0\\1\\0\\0\\0\\0\\0\\0\\0012\\0012\\0010\\00210\\7in-addr\\4ar\"..., 39, MSG_NOSIGNAL, NULL, 0) = 39\n06:58:02.560811 poll([{fd=5, events=POLLIN}], 1, 4000) = 0 (Timeout)\n06:58:06.564969 close(4)                = 0\n06:58:06.565010 close(5)                = 0\n06:58:06.565045 write(1, \"default         10.0.2.2        \"..., 77default         10.0.2.2        0.0.0.0         UG    0      0        0 eth0\n) = 77\n06:58:06.565069 read(3, \"\", 1024)       = 0\n06:58:06.565089 close(3)                = 0\n06:58:06.565109 munmap(0x7f6dab081000, 4096) = 0\n06:58:06.565152 exit_group(0)           = ?\n06:58:06.565226 +++ exited with 0 +++\n```\n\u9577\u3044\u3067\u3059\u304c\u3001\u30dd\u30a4\u30f3\u30c8\u306f\u5927\u3057\u3066\u3042\u308a\u307e\u305b\u3093\n\n- `poll()`\u3067`POLLIN`\u3057\u3066\u3044\u308b\u884c\u304c`3000ms -> 2000ms -> 4000ms`\u30921\u30bb\u30c3\u30c8\u3068\u3057\u30665\u56de\uff08attempts\u5206\uff09\n- `connect()`\u3067\u63a5\u7d9a\u3057\u3066\u3044\u308b`inet_addr`\u304c\u30e9\u30f3\u30c0\u30e0\u306b\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001 **3\u53f0\u306e`nameserver`\u306b\u5bfe\u3057`timeout:1 attempts:1 rotate:1`\u3068\u8a2d\u5b9a\u3059\u308b\u3068\u3001\u6700\u901f\u306e3\u79d2\u3067\u8ae6\u3081\u3066\u304f\u308c\u3001\u30e9\u30f3\u30c0\u30e0\u306a\u306e\u3067\u3082\u3057\u304b\u3059\u308b\u3068\u969c\u5bb3\u6a5f\u3067\u306a\u3044\u3082\u306e\u306b\u3042\u305f\u3063\u3066\u304f\u308c\u308b\u304b\u3082\u3057\u308c\u306a\u3044**\u3001\u3068\u3044\u3046\u306e\u304c\u6700\u5927\u9650\u3067\u3059\u3002\u5bfe\u7b56\u306b\u306a\u3063\u3066\u3044\u306a\u3044\u3067\u3059\u3088\u306d\u3002\u3002\u3002\u3067\u3082\u3001`resolv.conf`\u306e\u7cbe\u4e00\u676f\u306f\u3053\u3053\u3067\u3059\u3002\uff083\u53f0\u3068\u3044\u3046\u306e\u306f\u3001`nameserver`\u3067\u8a2d\u5b9a\u3067\u304d\u308b\u4e0a\u9650\u5024\u304c3\u53f0\u306a\u306e\u3067\u3002\uff09\n\n\u3061\u306a\u307f\u306b\u3001`POLLIN`\u3057\u3066\u3044\u308b\u3068\u3053\u308d\u306e\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u5024\u3067\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u8a18\u4e8b\u304c\u8a73\u3057\u3044\u3067\u3059\u3002\n\n[/etc/resolv.conf\u3068\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u79d2](http://qiita.com/todanano/items/323fa282c552de76923b)\n\n## \u305d\u3093\u306a\u306e\u3058\u3083\u56f0\u308b\u3093\u3060\u3051\u3069\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001`resolv.conf`\u306b\u62d8\u3089\u305a\u3001\u306a\u3093\u3068\u304b\u3059\u308b\u624b\u6bb5\u3092\u8003\u3048\u307e\u3059\u3002\n\n### nameserver\u3092VIP\u306b\u3059\u308b\n\u304a\u91d1\u6301\u3061\u306e\u3068\u3053\u308d\u306f\u3053\u308c\u304c\u591a\u3044\u3088\u3046\u306b\u601d\u3044\u307e\u3059\u3002\u6b7b\u6d3b\u51fa\u6765\u308b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u914d\u4e0b\u306bnameserver\u3092\u3076\u3089\u4e0b\u3052\u3001VIP\u306enameserver\u3068\u3057\u3066\u63d0\u4f9b\u3057\u307e\u3059\u3002\u5b89\u5fc3\u3060\u3051\u308c\u3069\u3082\u3001ELB\u3060\u3068\u3053\u308c\u51fa\u6765\u306a\u3044\u3067\u3059\u306d\u3002\u3002\u3002\n\n### \u30b5\u30fc\u30d0\u81ea\u8eab\u3092\u5f37\u5316\u3059\u308b\n`resolv.conf`\u3067\u51fa\u6765\u306a\u3044\u306a\u3089\u3001\u4f55\u304b\u5165\u308c\u3061\u3083\u3044\u307e\u3057\u3087\u3046\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u5165\u308c\u3089\u308c\u308b`unbound`\u3092\u4f7f\u3046\u3068\u304b\u3067\u3057\u3087\u3046\u304b\u3002Linux\u81ea\u8eab\u306e\u4ed5\u7d44\u307f\u3092\u4f7f\u308f\u306a\u3044\u3053\u3068\u3067\u3001`resolv.conf`\u306e\u5236\u7d04\u306f\u53d7\u3051\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n\u53c2\u8003\n[DNS unbound\u30b5\u30fc\u30d0\u69cb\u7bc9\u624b\u9806(yum\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)](http://qiita.com/na0AaooQ/items/e165250c1ea5c19b648c)\n", "tags": ["Linux", "dns"]}