{"context": "\u524d\u56de\u306fCLI\u3060\u3063\u305f\u306e\u3067\u4eca\u56de\u306fWeb\u30a2\u30d7\u30ea\u7de8\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\nhttps://developers.google.com/api-client-library/python/auth/web-app\n\u8a8d\u8a3c\u60c5\u5831\u3067\u627f\u8a8d\u6e08\u307f\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URL\u306e\u8a8d\u8a3c\u304c\u5fc5\u8981\n\n\u4f5c\u6210\u5f8cJSON\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n\u30b5\u30f3\u30d7\u30eb\ndjango\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3001HttpResponseRedirect\u3092\u5229\u7528\nfrom oauth2client import client\nfrom django.http import HttpResponseRedirect\n\nflow = client.flow_from_clientsecrets(\n    'client_secrets.json',\n    scope='https://www.googleapis.com/auth/drive.metadata.readonly',\n    redirect_uri='http://www.example.com/oauth2callback')\n\nauth_uri = flow.step1_get_authorize_url()\nreturn HttpResponseRedirect(auth_uri)\n\n\u30a2\u30ab\u30a6\u30f3\u30c8\u8a8d\u8a3c\u304c\u3055\u308c\u308b\u306e\u3067\u4efb\u610f\u30a2\u30ab\u30a6\u30f3\u30c8\u9078\u629e\n\n\u627f\u8a8d\u6e08\u307f\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URL\u3067\u8a8d\u8a3ccode\u304c\u53d6\u5f97\u3067\u304d\u308b\u306e\u3067\u305d\u308c\u3092\u4f7f\u7528\u3057\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30c7\u30fc\u30bf\u53d6\u5f97\nauth_code = request.GET['code']\nflow = client.flow_from_clientsecrets(\n    'client_secrets.json',\n    scope='https://www.googleapis.com/auth/drive.metadata.readonly',\n    redirect_uri='http://www.example.com/oauth2callback')\ncredentials = flow.step2_exchange(auth_code)\nhttp_auth = credentials.authorize(httplib2.Http())\nanalytics = build('analytics', 'v4', http=http_auth, discoveryServiceUrl=self.DISCOVERY_URI)\nreports = analytics.reports()\nreports.batchGet(\n                body={\n                    'reportRequests': [\n                        {\n                            'viewId': self.VIEW_ID,\n                            'dateRanges': [{'startDate': self.target_date, 'endDate': 'today'}],\n                            \"dimensions\": [\n                                {\n                                    \"name\": \"ga:productSku\",  # \u8ca9\u58f2\u3057\u305f\u54c1\u76ee\u306e\u5546\u54c1\u30b3\u30fc\u30c9\u3067\u3059\u3002\n                                }],\n                            'metrics': [\n                                {'expression': 'ga:itemQuantity'}  # e \u30b3\u30de\u30fc\u30b9 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3067\u58f2\u308c\u305f\u5546\u54c1\u306e\u6570\u3067\u3059\u3002\n                            ],\n                            'pageSize': 50000,\n                            'pageToken': \"nextpage\",\n                            \"orderBys\":\n                                [\n                                    {\"fieldName\": \"ga:itemQuantity\", \"sortOrder\": \"DESCENDING\"},\n                                ]\n                        }]\n                }\n        ).execute()\n\n\u524d\u56de\u306f[CLI](http://qiita.com/kobarincho/items/b77f78f9514c5b071d94)\u3060\u3063\u305f\u306e\u3067\u4eca\u56de\u306fWeb\u30a2\u30d7\u30ea\u7de8\n\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\nhttps://developers.google.com/api-client-library/python/auth/web-app\n\n\u8a8d\u8a3c\u60c5\u5831\u3067\u627f\u8a8d\u6e08\u307f\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URL\u306e\u8a8d\u8a3c\u304c\u5fc5\u8981\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-28 \u5348\u5f8c5.36.55.png](https://qiita-image-store.s3.amazonaws.com/0/130570/9a078e85-ce67-aaff-00e1-6eca02a0d06e.png)\n\n\n\u4f5c\u6210\u5f8cJSON\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-28 \u5348\u5f8c5.39.12.png](https://qiita-image-store.s3.amazonaws.com/0/130570/7ee4f59f-1bd8-88a4-2d47-3106d4084e4c.png)\n\n\u30b5\u30f3\u30d7\u30eb\ndjango\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3001HttpResponseRedirect\u3092\u5229\u7528\n\n```\nfrom oauth2client import client\nfrom django.http import HttpResponseRedirect\n\nflow = client.flow_from_clientsecrets(\n    'client_secrets.json',\n    scope='https://www.googleapis.com/auth/drive.metadata.readonly',\n    redirect_uri='http://www.example.com/oauth2callback')\n\nauth_uri = flow.step1_get_authorize_url()\nreturn HttpResponseRedirect(auth_uri)\n```\n\n\u30a2\u30ab\u30a6\u30f3\u30c8\u8a8d\u8a3c\u304c\u3055\u308c\u308b\u306e\u3067\u4efb\u610f\u30a2\u30ab\u30a6\u30f3\u30c8\u9078\u629e\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-28 \u5348\u5f8c5.42.16.png](https://qiita-image-store.s3.amazonaws.com/0/130570/d3f46b40-be53-0deb-0edc-c6cae5257282.png)\n\n\u627f\u8a8d\u6e08\u307f\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URL\u3067\u8a8d\u8a3ccode\u304c\u53d6\u5f97\u3067\u304d\u308b\u306e\u3067\u305d\u308c\u3092\u4f7f\u7528\u3057\u30a2\u30ca\u30ea\u30c6\u30a3\u30af\u30b9\u30c7\u30fc\u30bf\u53d6\u5f97\n\n```\nauth_code = request.GET['code']\nflow = client.flow_from_clientsecrets(\n    'client_secrets.json',\n    scope='https://www.googleapis.com/auth/drive.metadata.readonly',\n    redirect_uri='http://www.example.com/oauth2callback')\ncredentials = flow.step2_exchange(auth_code)\nhttp_auth = credentials.authorize(httplib2.Http())\nanalytics = build('analytics', 'v4', http=http_auth, discoveryServiceUrl=self.DISCOVERY_URI)\nreports = analytics.reports()\nreports.batchGet(\n                body={\n                    'reportRequests': [\n                        {\n                            'viewId': self.VIEW_ID,\n                            'dateRanges': [{'startDate': self.target_date, 'endDate': 'today'}],\n                            \"dimensions\": [\n                                {\n                                    \"name\": \"ga:productSku\",  # \u8ca9\u58f2\u3057\u305f\u54c1\u76ee\u306e\u5546\u54c1\u30b3\u30fc\u30c9\u3067\u3059\u3002\n                                }],\n                            'metrics': [\n                                {'expression': 'ga:itemQuantity'}  # e \u30b3\u30de\u30fc\u30b9 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3067\u58f2\u308c\u305f\u5546\u54c1\u306e\u6570\u3067\u3059\u3002\n                            ],\n                            'pageSize': 50000,\n                            'pageToken': \"nextpage\",\n                            \"orderBys\":\n                                [\n                                    {\"fieldName\": \"ga:itemQuantity\", \"sortOrder\": \"DESCENDING\"},\n                                ]\n                        }]\n                }\n        ).execute()\n```\n", "tags": ["Python", "Django", "googleapi", "WebApps", "google-api-python-client"]}