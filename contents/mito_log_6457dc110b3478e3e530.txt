{"context": " More than 1 year has passed since last update.Google Apps Script Advent Calendar 2014\u306e7\u65e5\u76ee\u306e\u8a18\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n2\u65e5\u76ee\u306e\u65b9\u306eslack\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u8fd1\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u65e2\u51fa\u3067\u3057\u305f\u3089\u5927\u5909\u6050\u7e2e\u3067\u3059\u3001\u3001\u3002\n\u753b\u9762\u5c0f\u3055\u3044\u3067\u3059\u304c\u3001\u901a\u77e5\u3055\u308c\u308b\u69d8\u5b50\u306f\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u203b \u2191\u3053\u308cgif\u306a\u3093\u3067\u3059\u304c\u3001\u52d5\u3044\u3066\u306a\u3044\u5834\u5408\u306f\u3053\u3061\u3089\u304b\u3089...\nslack\u306b\u6d41\u308c\u308b\u5185\u5bb9\u306f\u3001\u4f8b\u3048\u3070\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n\u3067\u306f\u3001\u4e0b\u8a18\u306b\u3068\u308a\u3042\u3048\u305a\u52d5\u304f\u3082\u306e\u3092\u4f5c\u308b\u624b\u9806\u3092\u66f8\u3044\u3066\u3001\u305d\u306e\u5f8c\u306b\u7c21\u5358\u306b\u88dc\u8db3\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nslack\u5074\u306e\u8a2d\u5b9a\n\ntodo\u7528\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u4f5c\u6210\n\nslack\u306e\u5de6\u5074CHANNELS\u306e\u4e0b\u306e\u65b9\u306b\u3042\u308b\u3001Create a channel... \u304b\u3089\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u4f5c\u6210\n\n\nincoming hook\u306e\u8a2d\u5b9a\n\n\nhttps://yourslackdomainname.slack.com/services/new#diy \u304b\u3089 Incoming WebHooks\u306eadd\u3092\u9078\u629e\npost\u3057\u305f\u3044\u30c1\u30e3\u30f3\u30cd\u30eb(\u3055\u3063\u304d\u4f5c\u3063\u305ftodo)\u3092\u9078\u629e\u3057\u3066\u3001Add Incoming WebHooks Integration\u3092\u9078\u629e\n\u4e0b\u8a18\u306e\u3088\u3046\u306aURL\u304c\u3067\u3066\u304f\u308b\u306e\u3067\u3053\u308c\u3092\u30b3\u30d4\u3063\u3066\u304a\u304f\n\n\n\ngoogle apps\u5074\u306e\u8a2d\u5b9a\n\n\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u7528\u610f\n\n\u4e0b\u8a18\u306e\u611f\u3058\u3067\u7528\u610f(\u5217\u306e\u7bc4\u56f2\uff1aB\u5217~I\u5217\u3001todo\u958b\u59cb\u884c\uff1a3\u884c\u76ee)\n\n\n\ngas\u306e\u7de8\u96c6\n\n\u30c4\u30fc\u30eb > \u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u3092\u9078\u629e\u3057\u65b0\u898f\u306b.gs\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u9069\u5f53\u306b\u5165\u529b\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3092\u30b3\u30d4\u30da\n1\u884c\u76ee\u306b\u3001\u3055\u3063\u304dslack\u5074\u3067\u30b3\u30d4\u3063\u3066\u304a\u3044\u305f\u3001incoming hook\u306epost\u7528url\u3092\u30da\u30fc\u30b9\u30c8\n\n\ntodo.gs\nvar postUrl = \"https://hooks.slack.com/services/xxxxxxx/xxxxxxx/xxxxxx\";\nvar postChannel = \"#todo\";\n\nfunction myOnEdit()\n{\n  var keywordCol = 8;         // \u30b9\u30c6\u30fc\u30bf\u30b9\u5217idx\n  var inChargePersonCol = 7;  // \u62c5\u5f53\u8005\u5217idx\n  var dataStartCol = 2;       // \u30c7\u30fc\u30bf\u304c\u958b\u59cb\u3059\u308b\u5217\u306eidx\n  var taskContentCol = 2;     // \u30bf\u30b9\u30af\u5185\u5bb9\u5217idx\n\n  var colOffset = 1;  // A\u5217\u306foffset\n\n  var dataColNum = 8;  // \u30c7\u30fc\u30bf\u306e\u5217\u6570\n  var range = SpreadsheetApp.getActiveRange();\n  var rowidx = range.getRow();\n  var colidx = range.getColumn();\n  if(colidx != keywordCol){ return ; }\n  var sheet = SpreadsheetApp.getActiveSheet();\n\n  // \u30b9\u30c6\u30fc\u30bf\u30b9\u306b\u5909\u66f4\u306e\u3042\u3063\u305ftodo1\u884c\n  var aLine = sheet.getRange(rowidx, dataStartCol, 1, dataColNum);\n  if(!aLine){\n    return;\n  }\n\n  // \u30b9\u30c6\u30fc\u30bf\u30b9\u30bb\u30eb\u306e\u5024\n  var status = aLine.getCell(1,keywordCol-colOffset).getValue();\n\n  // \u62c5\u5f53\u8005\u30bb\u30eb\u306e\u5024\n  var username = aLine.getCell(1, inChargePersonCol-colOffset).getValue();\n  if(!username){\n    username = \"unknown\";\n  }\n\n  // \u30bf\u30b9\u30af\u306e\u5185\u5bb9\n  var taskContent = aLine.getCell(1, taskContentCol-colOffset).getValue();  \n  if(!taskContent){\n    return;\n  }\n\n  // \u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u5909\u66f4\u3057\u305f\u4eba\u306e\u540d\u524d(google\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u540d) \n  // todo: \u3081\u3093\u3069\u304f\u3055\u305d\u3046\u306a\u306e\u3067\u4e00\u65e6\u306a\u3057\u3067\n  // var editor = Session.getActiveUser().\n\n  var message = username;\n  message += \"\u3055\u3093\u304c\u3001\u30bf\u30b9\u30af\u300c\";\n  message += taskContent;  \n  message += \"\u300d\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\";\n\n  if( status == '\u5b8c\u4e86' ){\n    aLine.setBackgroundColor(\"#efefef\");\n    aLine.setFontColor('black');\n    message += \"\u3010\u5b8c\u4e86\u3011\";\n\n  }\n  else if(status == '\u672a\u7740\u624b' || !status){\n    aLine.setBackgroundColor('white');\n    message += \"\u3010\u672a\u7740\u624b\u3011\";\n  }\n  else if(status == '\u9032\u884c\u4e2d'){\n    aLine.setBackgroundColor('#fce5cd');\n    message += \"\u3010\u9032\u884c\u4e2d\u3011\";\n  }\n\n  message += \"\u306b\u3057\u307e\u3057\u305f\";\n\n  sendHttpPost(message, \"TODO\u30c6\u30b9\u30c8\");\n}\n\nfunction test()\n{\n  sendHttpPost(\"\u4e0a\u69d8\u304c\u3001\u30bf\u30b9\u30af\u300c\u307b\u3052\u307b\u3052\u307b\u3052\u300d\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u3010\u9032\u884c\u4e2d\u3011\u306b\u3057\u307e\u3057\u305f\", \"TODO\u30c6\u30b9\u30c8\");\n}\n\nfunction sendHttpPost(message, username)\n{\n  var jsonData =\n  {\n     \"channel\" : postChannel,\n     \"username\" : username,\n     \"text\" : message\n  };\n  var payload = JSON.stringify(jsonData);\n  var options =\n  {\n    \"method\" : \"post\",\n    \"contentType\" : \"application/json\",\n    \"payload\" : payload\n  };\n\n  UrlFetchApp.fetch(postUrl, options);\n}\n\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u52d5\u304b\u3059\u305f\u3081\u306b\u627f\u8a8d(\u4e0b\u8a18\u53c2\u7167)\u304c\u5fc5\u8981\u306a\u306e\u3067\u3001\u307e\u305a\u306ftest()\u3092\u52d5\u304b\u3057\u3066\u3001\u7d9a\u884c > \u627f\u8a8d \u3092\u9078\u629e\n\n\n\n\ntest()\u304c\u3046\u307e\u304f\u52d5\u3044\u305f\u3089\u3001gas\u306e\u30a8\u30c7\u30a3\u30bf\u30e1\u30cb\u30e5\u30fc\u306e\u30ea\u30bd\u30fc\u30b9 > \u73fe\u5728\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30ea\u30ac\u30fc\u304b\u3089\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u4fdd\u5b58(\u65e2\u306bonEdit\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u4e00\u65e6\u30c8\u30ea\u30ac\u30fc\u3092\u6d88\u3057\u3066\u65b0\u305f\u306b\u8ffd\u52a0)\n\n\n\n\u4ee5\u4e0a\u3002\u3053\u308c\u3067\u3046\u3054\u304f\u306f\u305a\uff01\n\n\u89e3\u8aac\u3068\u88dc\u8db3\n\nSimple Triggers\ngas\u306b\u306f\u3001Simple Triggers\u3068\u3044\u3046\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u4f7f\u3063\u305f\u306e\u306f\u3001onEdit\u3067\u3059\u3002\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u5024\u3092\u7de8\u96c6\u3059\u308b\u3068\u3001\u547c\u3070\u308c\u308b\u307e\u3059\u3002\u306a\u306e\u3067\u3001\u5024\u3092\u7de8\u96c6\u3059\u308b\u3054\u3068\u306b\u3001slack\u306b\u901a\u77e5\u3092\u98db\u3070\u3059\u51e6\u7406\u306f\u3053\u3053\u306b\u5165\u308c\u305f\u3044\u308f\u3051\u3067\u3059\u3002\n\u3067\u3059\u304c\u3001\u4e0a\u8a18\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306eRestrictions\u306e\u90e8\u5206\u3067\n\nThey cannot access services that require authorization. For example, a simple trigger cannot send an email because the Gmail service requires authorization, but a simple trigger can translate a phrase with the Language service, which is anonymous.\n\n\u3068\u3042\u308b\u3088\u3046\u306b\u3001gmai\u3068\u304b\u5916\u90e8\u63a5\u7d9a\u30b5\u30fc\u30d3\u30b9\u3068\u304b\u306f\u5b9f\u884c\u3067\u304d\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u306a\u306e\u3067\u3001\u3061\u3087\u3063\u3068stackoverflow\u306e\u65b9\u306ework around\u3092\u53c2\u8003\u306b\u56de\u907f\u3057\u3066\u3044\u307e\u3059(\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u304a\u77e5\u3089\u305b\u304f\u3060\u3055\u3044)\u3002\n\n\u5b9f\u884c\u6a29\u9650\u306e\u627f\u8a8d\nga\u5074\u306e\u8a2d\u5b9a\u306e\u9014\u4e2d\u3067\u3001test()\u3092\u5b9f\u884c\u3057\u3066\u3001\u5b9f\u884c\u6a29\u9650\u306e\u627f\u8a8d\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u3092\u3057\u306a\u3044\u3068\u6050\u3089\u304f\u52d5\u304d\u307e\u305b\u3093\u3002\u81ea\u52d5\u7684\u306b\u627f\u8a8d\u3059\u308b\u65b9\u6cd5\u3082\u3042\u3063\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3053\u308c\u304c\u624b\u3063\u53d6\u308a\u65e9\u304b\u3063\u305f\u306e\u3067\u5927\u62b5\u3053\u308c\u3067\u3084\u3063\u3066\u307e\u3059\u3002\n\nslack\u306b\u5410\u304d\u51fa\u3059\u30c6\u30ad\u30b9\u30c8\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\n  var jsonData =\n  {\n     \"channel\" : postChannel,\n     \"username\" : username,\n     \"text\" : message\n  };\n\n\u3053\u3053\u3067\u3084\u3063\u3066\u307e\u3059\u3002\u3053\u3053\u3067username\u3068\u304bchannnel\u3092\u4efb\u610f\u306b\u5909\u3048\u308c\u3070\u5410\u304b\u308c\u308b\u5185\u5bb9\u3082\u5909\u308f\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u3082\u3063\u3068\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305f\u3044\u5834\u5408\u306f\u3001https://yourslackdomain.slack.com/services \u306eIncoming WebHooks\u304b\u3089\u5148\u307b\u3069\u4f5c\u6210\u3057\u305f\u3001incoming hook\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u307e\u3059\u3002\u30a2\u30a4\u30b3\u30f3\u3068\u304b\u3001\u30c7\u30d5\u30a9\u306eusername\u3068\u304b\u3001\u30c7\u30d5\u30a9\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u3068\u304b\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u4e0a\u8a18\u306ejsonData\u306e\u5185\u5bb9\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305f\u3044\u5834\u5408\u306f\u3001Configured Integrations\u3068\u304b\u3001Message Attachments\u3068\u304b\u3092\u307f\u308b\u3068\u53c2\u8003\u306b\u306a\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4ee5\u4e0a\u3001\u7c21\u5358\u3067\u3057\u305f\u304c\u3001Google Apps Script Advent Calendar 2014\u306e7\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3057\u305f\u3002\n\n[\u8a02\u6b631]\nSimple Triggers\u3067onEdit()\u304c\u547c\u3070\u308c\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u4e00\u5b9a\u6642\u9593\u305f\u3064\u3068\u81ea\u52d5\u7684\u306b\u5916\u308c\u3066\u3057\u307e\u3046\u3088\u3046\u3067\u3059\u3002\u3067\u3059\u306e\u3067\u3001Simple Trigger\u3067\u3001myOnEdit()\u3092\u547c\u3076\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\u307e\u305f\u3001myOnEdit()\u306e\u5f15\u6570\u3068\u4e2d\u8eab\u3092\u5c11\u3057\u7de8\u96c6\u3057\u307e\u3057\u305f\u3002\n[\u8a02\u6b632]\n\n\u65e2\u306bonEdit\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u4e00\u65e6\u30c8\u30ea\u30ac\u30fc\u3092\u6d88\u3057\u3066\u65b0\u305f\u306b\u8ffd\u52a0\n\n\u3068\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\u305d\u3046\u3059\u308b\u3068\u4ed6\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30ea\u30ac\u30fc\u306eonEdit\u3092\u6d88\u3059\u3053\u3068\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u3001\u73fe\u5728\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30ea\u30ac\u30fc\u306b\u65b0\u305f\u306b\u8ffd\u52a0\u3059\u308b\u5f62\u306b\u306a\u308a\u307e\u3059\u3001\u5927\u5909\u5931\u793c\u3057\u307e\u3057\u305f\u3002\n[\u8a02\u6b633]\n\nif(colidx != keywordCol){ return ; }\n\nmyOnEdit()\u306b\u3001\u4e0a\u8a181\u884c\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\u3053\u308c\u3067\u30b9\u30c6\u30fc\u30bf\u30b9\u4ee5\u5916\u306e\u30bb\u30eb\u3092\u7de8\u96c6\u3059\u308b\u3054\u3068\u306b\u901a\u77e5\u304c\u98db\u3093\u3067\u3044\u305f\u306e\u304c\u4fee\u6b63\u3055\u308c\u307e\u3059\u3002\n\u5909\u66f4\u306e\u5dee\u5206\u306f\u3001revisions\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n[Google Apps Script Advent Calendar 2014](http://qiita.com/advent-calendar/2014/gas)\u306e7\u65e5\u76ee\u306e\u8a18\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n[2\u65e5\u76ee](http://qiita.com/n0bisuke/items/ed99da94aba342af3cdc)\u306e\u65b9\u306eslack\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u8fd1\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u65e2\u51fa\u3067\u3057\u305f\u3089\u5927\u5909\u6050\u7e2e\u3067\u3059\u3001\u3001\u3002\n\n\u753b\u9762\u5c0f\u3055\u3044\u3067\u3059\u304c\u3001\u901a\u77e5\u3055\u308c\u308b\u69d8\u5b50\u306f\u3001\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059\u3002\n\n![todoToSlack.gif](https://qiita-image-store.s3.amazonaws.com/0/46489/0f99798e-86fb-567e-b861-c74219cffaf7.gif)\n\u203b \u2191\u3053\u308cgif\u306a\u3093\u3067\u3059\u304c\u3001\u52d5\u3044\u3066\u306a\u3044\u5834\u5408\u306f[\u3053\u3061\u3089](https://dl.dropboxusercontent.com/u/91774212/todoToSlack.gif)\u304b\u3089...\n\nslack\u306b\u6d41\u308c\u308b\u5185\u5bb9\u306f\u3001\u4f8b\u3048\u3070\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n![Screen Shot 2014-12-06 at 16.48.15.png](https://qiita-image-store.s3.amazonaws.com/0/46489/ebdb0f1f-444a-b3f7-7218-27cbdf3ea451.png)\n\n\n\u3067\u306f\u3001\u4e0b\u8a18\u306b\u3068\u308a\u3042\u3048\u305a\u52d5\u304f\u3082\u306e\u3092\u4f5c\u308b\u624b\u9806\u3092\u66f8\u3044\u3066\u3001\u305d\u306e\u5f8c\u306b\u7c21\u5358\u306b\u88dc\u8db3\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n# slack\u5074\u306e\u8a2d\u5b9a\n## todo\u7528\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u4f5c\u6210\n - slack\u306e\u5de6\u5074CHANNELS\u306e\u4e0b\u306e\u65b9\u306b\u3042\u308b\u3001Create a channel... \u304b\u3089\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u4f5c\u6210\n\n## incoming hook\u306e\u8a2d\u5b9a\n - https://yourslackdomainname.slack.com/services/new#diy \u304b\u3089 Incoming WebHooks\u306eadd\u3092\u9078\u629e\n - post\u3057\u305f\u3044\u30c1\u30e3\u30f3\u30cd\u30eb(\u3055\u3063\u304d\u4f5c\u3063\u305ftodo)\u3092\u9078\u629e\u3057\u3066\u3001Add Incoming WebHooks Integration\u3092\u9078\u629e\n - \u4e0b\u8a18\u306e\u3088\u3046\u306aURL\u304c\u3067\u3066\u304f\u308b\u306e\u3067\u3053\u308c\u3092\u30b3\u30d4\u3063\u3066\u304a\u304f\n\n![Screen Shot 2014-12-06 at 16.06.34.png](https://qiita-image-store.s3.amazonaws.com/0/46489/3fee9146-e908-c9b3-7385-f9b8df586e11.png)\n\n# google apps\u5074\u306e\u8a2d\u5b9a\n## \u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u7528\u610f\n - \u4e0b\u8a18\u306e\u611f\u3058\u3067\u7528\u610f(\u5217\u306e\u7bc4\u56f2\uff1aB\u5217~I\u5217\u3001todo\u958b\u59cb\u884c\uff1a3\u884c\u76ee)\n\n![Screen Shot 2014-12-06 at 16.08.28.png](https://qiita-image-store.s3.amazonaws.com/0/46489/e9a59ff5-ecd1-1511-284e-34561e9e3a22.png)\n\n## gas\u306e\u7de8\u96c6\n - \u30c4\u30fc\u30eb > \u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u3092\u9078\u629e\u3057\u65b0\u898f\u306b.gs\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n - \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3001\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u9069\u5f53\u306b\u5165\u529b\n - \u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3092\u30b3\u30d4\u30da\n - 1\u884c\u76ee\u306b\u3001\u3055\u3063\u304dslack\u5074\u3067\u30b3\u30d4\u3063\u3066\u304a\u3044\u305f\u3001incoming hook\u306epost\u7528url\u3092\u30da\u30fc\u30b9\u30c8\n\n```gas:todo.gs\nvar postUrl = \"https://hooks.slack.com/services/xxxxxxx/xxxxxxx/xxxxxx\";\nvar postChannel = \"#todo\";\n\nfunction myOnEdit()\n{\n  var keywordCol = 8;         // \u30b9\u30c6\u30fc\u30bf\u30b9\u5217idx\n  var inChargePersonCol = 7;  // \u62c5\u5f53\u8005\u5217idx\n  var dataStartCol = 2;       // \u30c7\u30fc\u30bf\u304c\u958b\u59cb\u3059\u308b\u5217\u306eidx\n  var taskContentCol = 2;     // \u30bf\u30b9\u30af\u5185\u5bb9\u5217idx\n  \n  var colOffset = 1;  // A\u5217\u306foffset\n  \n  var dataColNum = 8;  // \u30c7\u30fc\u30bf\u306e\u5217\u6570\n  var range = SpreadsheetApp.getActiveRange();\n  var rowidx = range.getRow();\n  var colidx = range.getColumn();\n  if(colidx != keywordCol){ return ; }\n  var sheet = SpreadsheetApp.getActiveSheet();\n  \n  // \u30b9\u30c6\u30fc\u30bf\u30b9\u306b\u5909\u66f4\u306e\u3042\u3063\u305ftodo1\u884c\n  var aLine = sheet.getRange(rowidx, dataStartCol, 1, dataColNum);\n  if(!aLine){\n    return;\n  }\n  \n  // \u30b9\u30c6\u30fc\u30bf\u30b9\u30bb\u30eb\u306e\u5024\n  var status = aLine.getCell(1,keywordCol-colOffset).getValue();\n    \n  // \u62c5\u5f53\u8005\u30bb\u30eb\u306e\u5024\n  var username = aLine.getCell(1, inChargePersonCol-colOffset).getValue();\n  if(!username){\n    username = \"unknown\";\n  }\n  \n  // \u30bf\u30b9\u30af\u306e\u5185\u5bb9\n  var taskContent = aLine.getCell(1, taskContentCol-colOffset).getValue();  \n  if(!taskContent){\n    return;\n  }\n  \n  // \u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u5909\u66f4\u3057\u305f\u4eba\u306e\u540d\u524d(google\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u540d) \n  // todo: \u3081\u3093\u3069\u304f\u3055\u305d\u3046\u306a\u306e\u3067\u4e00\u65e6\u306a\u3057\u3067\n  // var editor = Session.getActiveUser().\n\n  var message = username;\n  message += \"\u3055\u3093\u304c\u3001\u30bf\u30b9\u30af\u300c\";\n  message += taskContent;  \n  message += \"\u300d\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\";\n    \n  if( status == '\u5b8c\u4e86' ){\n    aLine.setBackgroundColor(\"#efefef\");\n    aLine.setFontColor('black');\n    message += \"\u3010\u5b8c\u4e86\u3011\";\n    \n  }\n  else if(status == '\u672a\u7740\u624b' || !status){\n    aLine.setBackgroundColor('white');\n    message += \"\u3010\u672a\u7740\u624b\u3011\";\n  }\n  else if(status == '\u9032\u884c\u4e2d'){\n    aLine.setBackgroundColor('#fce5cd');\n    message += \"\u3010\u9032\u884c\u4e2d\u3011\";\n  }\n  \n  message += \"\u306b\u3057\u307e\u3057\u305f\";\n  \n  sendHttpPost(message, \"TODO\u30c6\u30b9\u30c8\");\n}\n\nfunction test()\n{\n  sendHttpPost(\"\u4e0a\u69d8\u304c\u3001\u30bf\u30b9\u30af\u300c\u307b\u3052\u307b\u3052\u307b\u3052\u300d\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u3010\u9032\u884c\u4e2d\u3011\u306b\u3057\u307e\u3057\u305f\", \"TODO\u30c6\u30b9\u30c8\");\n}\n\nfunction sendHttpPost(message, username)\n{\n  var jsonData =\n  {\n     \"channel\" : postChannel,\n     \"username\" : username,\n     \"text\" : message\n  };\n  var payload = JSON.stringify(jsonData);\n  var options =\n  {\n    \"method\" : \"post\",\n    \"contentType\" : \"application/json\",\n    \"payload\" : payload\n  };\n  \n  UrlFetchApp.fetch(postUrl, options);\n}\n```\n\n - \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u52d5\u304b\u3059\u305f\u3081\u306b\u627f\u8a8d(\u4e0b\u8a18\u53c2\u7167)\u304c\u5fc5\u8981\u306a\u306e\u3067\u3001\u307e\u305a\u306f`test()`\u3092\u52d5\u304b\u3057\u3066\u3001\u7d9a\u884c > \u627f\u8a8d \u3092\u9078\u629e\n\n![Screen Shot 2014-12-06 at 15.25.28.png](https://qiita-image-store.s3.amazonaws.com/0/46489/8325f1e4-dc27-3f21-7511-45e5ab703a22.png)\n\n - `test()`\u304c\u3046\u307e\u304f\u52d5\u3044\u305f\u3089\u3001gas\u306e\u30a8\u30c7\u30a3\u30bf\u30e1\u30cb\u30e5\u30fc\u306e\u30ea\u30bd\u30fc\u30b9 > \u73fe\u5728\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30ea\u30ac\u30fc\u304b\u3089\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u4fdd\u5b58~~(\u65e2\u306bonEdit\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u4e00\u65e6\u30c8\u30ea\u30ac\u30fc\u3092\u6d88\u3057\u3066\u65b0\u305f\u306b\u8ffd\u52a0)~~\n\n![Screen Shot 2014-12-10 at 15.51.24.png](https://qiita-image-store.s3.amazonaws.com/0/46489/f0fddbdd-a561-1a18-888d-e1f4d7aa9f3e.png)\n\n\n\u4ee5\u4e0a\u3002\u3053\u308c\u3067\u3046\u3054\u304f\u306f\u305a\uff01\n\n\n#\u89e3\u8aac\u3068\u88dc\u8db3\n\n## Simple Triggers\ngas\u306b\u306f\u3001[Simple Triggers](https://developers.google.com/apps-script/guides/triggers/)\u3068\u3044\u3046\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u4f7f\u3063\u305f\u306e\u306f\u3001onEdit\u3067\u3059\u3002\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u5024\u3092\u7de8\u96c6\u3059\u308b\u3068\u3001\u547c\u3070\u308c\u308b\u307e\u3059\u3002\u306a\u306e\u3067\u3001\u5024\u3092\u7de8\u96c6\u3059\u308b\u3054\u3068\u306b\u3001slack\u306b\u901a\u77e5\u3092\u98db\u3070\u3059\u51e6\u7406\u306f\u3053\u3053\u306b\u5165\u308c\u305f\u3044\u308f\u3051\u3067\u3059\u3002\n\n\u3067\u3059\u304c\u3001\u4e0a\u8a18\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306eRestrictions\u306e\u90e8\u5206\u3067\n> They cannot access services that require authorization. For example, a simple trigger cannot send an email because the Gmail service requires authorization, but a simple trigger can translate a phrase with the Language service, which is anonymous.\n\n\u3068\u3042\u308b\u3088\u3046\u306b\u3001gmai\u3068\u304b\u5916\u90e8\u63a5\u7d9a\u30b5\u30fc\u30d3\u30b9\u3068\u304b\u306f\u5b9f\u884c\u3067\u304d\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u306a\u306e\u3067\u3001\u3061\u3087\u3063\u3068[stackoverflow\u306e\u65b9\u306ework around](http://stackoverflow.com/questions/20457847/urlfetch-in-an-event-failing)\u3092\u53c2\u8003\u306b\u56de\u907f\u3057\u3066\u3044\u307e\u3059(\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u304a\u77e5\u3089\u305b\u304f\u3060\u3055\u3044)\u3002\n\n## \u5b9f\u884c\u6a29\u9650\u306e\u627f\u8a8d\nga\u5074\u306e\u8a2d\u5b9a\u306e\u9014\u4e2d\u3067\u3001`test()`\u3092\u5b9f\u884c\u3057\u3066\u3001\u5b9f\u884c\u6a29\u9650\u306e\u627f\u8a8d\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u3092\u3057\u306a\u3044\u3068\u6050\u3089\u304f\u52d5\u304d\u307e\u305b\u3093\u3002\u81ea\u52d5\u7684\u306b\u627f\u8a8d\u3059\u308b\u65b9\u6cd5\u3082\u3042\u3063\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3053\u308c\u304c\u624b\u3063\u53d6\u308a\u65e9\u304b\u3063\u305f\u306e\u3067\u5927\u62b5\u3053\u308c\u3067\u3084\u3063\u3066\u307e\u3059\u3002\n\n## slack\u306b\u5410\u304d\u51fa\u3059\u30c6\u30ad\u30b9\u30c8\u306e\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\n\n```\n  var jsonData =\n  {\n     \"channel\" : postChannel,\n     \"username\" : username,\n     \"text\" : message\n  };\n```\n\u3053\u3053\u3067\u3084\u3063\u3066\u307e\u3059\u3002\u3053\u3053\u3067username\u3068\u304bchannnel\u3092\u4efb\u610f\u306b\u5909\u3048\u308c\u3070\u5410\u304b\u308c\u308b\u5185\u5bb9\u3082\u5909\u308f\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u3082\u3063\u3068\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305f\u3044\u5834\u5408\u306f\u3001https://yourslackdomain.slack.com/services \u306eIncoming WebHooks\u304b\u3089\u5148\u307b\u3069\u4f5c\u6210\u3057\u305f\u3001incoming hook\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u307e\u3059\u3002\u30a2\u30a4\u30b3\u30f3\u3068\u304b\u3001\u30c7\u30d5\u30a9\u306eusername\u3068\u304b\u3001\u30c7\u30d5\u30a9\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u3068\u304b\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u4e0a\u8a18\u306ejsonData\u306e\u5185\u5bb9\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3057\u305f\u3044\u5834\u5408\u306f\u3001**Configured Integrations**\u3068\u304b\u3001**Message Attachments**\u3068\u304b\u3092\u307f\u308b\u3068\u53c2\u8003\u306b\u306a\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n![Screen Shot 2014-12-06 at 17.05.30.png](https://qiita-image-store.s3.amazonaws.com/0/46489/25607cbe-6fe4-3f69-748a-5cbd33f40ba0.png)\n\n\n\u4ee5\u4e0a\u3001\u7c21\u5358\u3067\u3057\u305f\u304c\u3001[Google Apps Script Advent Calendar 2014](http://qiita.com/advent-calendar/2014/gas)\u306e7\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3057\u305f\u3002\n\n - - - - - \n[\u8a02\u6b631]\n\nSimple Triggers\u3067onEdit()\u304c\u547c\u3070\u308c\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u4e00\u5b9a\u6642\u9593\u305f\u3064\u3068\u81ea\u52d5\u7684\u306b\u5916\u308c\u3066\u3057\u307e\u3046\u3088\u3046\u3067\u3059\u3002\u3067\u3059\u306e\u3067\u3001Simple Trigger\u3067\u3001myOnEdit()\u3092\u547c\u3076\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\u307e\u305f\u3001myOnEdit()\u306e\u5f15\u6570\u3068\u4e2d\u8eab\u3092\u5c11\u3057\u7de8\u96c6\u3057\u307e\u3057\u305f\u3002\n\n[\u8a02\u6b632]\n> \u65e2\u306bonEdit\u304c\u5165\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u4e00\u65e6\u30c8\u30ea\u30ac\u30fc\u3092\u6d88\u3057\u3066\u65b0\u305f\u306b\u8ffd\u52a0\n\n\u3068\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\u305d\u3046\u3059\u308b\u3068\u4ed6\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30ea\u30ac\u30fc\u306eonEdit\u3092\u6d88\u3059\u3053\u3068\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u3001\u73fe\u5728\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30c8\u30ea\u30ac\u30fc\u306b\u65b0\u305f\u306b\u8ffd\u52a0\u3059\u308b\u5f62\u306b\u306a\u308a\u307e\u3059\u3001\u5927\u5909\u5931\u793c\u3057\u307e\u3057\u305f\u3002\n\n[\u8a02\u6b633]\n> if(colidx != keywordCol){ return ; }\n\nmyOnEdit()\u306b\u3001\u4e0a\u8a181\u884c\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\u3053\u308c\u3067\u30b9\u30c6\u30fc\u30bf\u30b9\u4ee5\u5916\u306e\u30bb\u30eb\u3092\u7de8\u96c6\u3059\u308b\u3054\u3068\u306b\u901a\u77e5\u304c\u98db\u3093\u3067\u3044\u305f\u306e\u304c\u4fee\u6b63\u3055\u308c\u307e\u3059\u3002\n\n\u5909\u66f4\u306e\u5dee\u5206\u306f\u3001[revisions](http://qiita.com/mito_log/items/6457dc110b3478e3e530/revisions)\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n", "tags": ["gas", "gasja", "Slack", "GoogleAppsScript"]}