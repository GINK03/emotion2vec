{"context": "\u524d\u56de\u306e\u8a18\u4e8b\u3067\u306f\u76f8\u95a2\u304c\u3042\u308b 222 \u3064\u306e\u64ec\u4f3c\u4e71\u6570\u3092\u751f\u6210\u3057\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u3001\u8272\u3005\u3084\u3063\u3066\u3044\u304f\u3046\u3061\u306b\u3084\u3063\u3071\u308a\u76f8\u95a2\u304c\u3042\u308b\u4e71\u6570\u304c nnn \u500b\u307b\u3057\u304f\u306a\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u751f\u6210\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3044\u304d\u306a\u308a nnn \u500b\u306e\u4e71\u6570\u3092\u4f5c\u308b\u8a71\u304b\u3089\u5165\u308b\u306e\u3067\u3001\u524d\u56de\u306e\u8a18\u4e8b\u3092\u307e\u305a\u8aad\u3093\u3067\u3044\u305f\u3060\u3044\u305f\u307b\u3046\u304c\u30b9\u30e0\u30fc\u30ba\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u8ffd\u8a18\uff1a\u5358\u306b\u76f8\u95a2\u304c\u3042\u308b\u4e71\u6570\u3092\u4f5c\u308a\u305f\u3044\u3001\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u306b\u306f\u8208\u5473\u306a\u3044\u3068\u3044\u3046\u65b9\u306f numpy.random.multivariate_normal \u3092\u4f7f\u3048\u3070\u5927\u4e08\u592b\u3067\u3059\u3002\n\n\u6982\u8981\nnnn \u500b\u306e\u30c7\u30fc\u30bf\u7cfb\u5217\u304c\u3042\u3063\u305f\u3068\u304d\u3001 iii \u756a\u76ee\u3068 jjj \u756a\u76ee\u306e\u76f8\u95a2\u4fc2\u6570\u3092 ijijij \u6210\u5206\u306b\u304a\u3044\u305f\u5bfe\u79f0\u884c\u5217\u30921\u3001 \u76f8\u95a2\u884c\u5217 \u3068\u3044\u3044\u307e\u3059\u3002\u3053\u306e\u76f8\u95a2\u884c\u5217\u3092\u30a4\u30f3\u30d7\u30c3\u30c8\u3068\u3057\u3066\u3001\u4e0e\u3048\u3089\u308c\u305f\u76f8\u95a2\u3092\u6e80\u305f\u3059\u3088\u3046\u306a nnn \u500b\u306e\u4e71\u6570\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u3092\u8003\u3048\u307e\u3059\u3002\n\u5e73\u5747\u304c\u30bc\u30ed\u3067\u5206\u6563\u304c\u7b49\u3057\u3044\u72ec\u7acb\u306a\u4e71\u6570\u3092 nnn \u500b\u7528\u610f\u3057\u3066\u3001\u305d\u308c\u3092\u30d9\u30af\u30c8\u30eb\u3067\u307e\u3068\u3081\u3066 X=(X1\u00a0\u00a0X2\u00a0\u00a0\u2026\u00a0\u00a0Xn)TX=(X1\u00a0\u00a0X2\u00a0\u00a0\u2026\u00a0\u00a0Xn)TX = (X_1 \\ \\ X_2 \\ \\ \\dots \\ \\ X_n)^T \u3068\u8868\u73fe\u3057\u307e\u30592\u3002\u3053\u306e\u3068\u304d\u3001X1X1X_1 \u3084 X2X2X_2 \u306a\u3069\u3068\u540c\u3058\u5206\u6563\u3092\u6301\u3063\u3066\u3044\u3066\u76f8\u95a2\u884c\u5217 RRR \u3067\u76f8\u95a2\u3057\u3042\u3046 nnn \u500b\u306e\u4e71\u6570 Z=(Z1\u00a0\u00a0Z2\u00a0\u00a0\u2026\u00a0\u00a0Zn)TZ=(Z1\u00a0\u00a0Z2\u00a0\u00a0\u2026\u00a0\u00a0Zn)TZ = (Z_1 \\ \\ Z_2 \\ \\ \\dots \\ \\ Z_n)^T \u306f\nZ = L \\ X\nZ=L\u00a0XZ=L\u00a0X{Z = L \\ X\n}\n\u3067\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u76f8\u95a2\u884c\u5217\u306f ZiZiZ_i \u3068 ZjZjZ_j \u306e\u76f8\u95a2\u4fc2\u6570\u3092 \u03c1ij\u03c1ij\\rho_{ij} \u3068\u3057\u3066\nR = \\left( \\begin{array}{cccc}\n\\rho_{11} & \\rho_{12} & \\dots & \\rho_{1n}\n\\\\\n\\rho_{21} & & &\n\\\\\n\\vdots & & \\ddots & \\vdots\n\\\\\n\\rho_{n1} & & \\dots & \\rho_{nn}\n\\end{array} \\right)\nR=(\u03c111\u03c112\u2026\u03c11n\u03c121\u22ee\u22f1\u22ee\u03c1n1\u2026\u03c1nn){R = \\left( \\begin{array}{cccc}\n\\rho_{11} & \\rho_{12} & \\dots & \\rho_{1n}\n\\\\\n\\rho_{21} & & &\n\\\\\n\\vdots & & \\ddots & \\vdots\n\\\\\n\\rho_{n1} & & \\dots & \\rho_{nn}\n\\end{array} \\right)\n}\n\u3067\u3001LL \u306f RR \u306e\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u304b\u3089\u5f97\u3089\u308c\u305f\u4e0b\u4e09\u89d2\u884c\u5217\uff08\u5bfe\u89d2\u6210\u5206\u3088\u308a\u53f3\u4e0a\u304c\u3059\u3079\u3066\u30bc\u30ed\u306e\u884c\u5217\uff09\u3067\u3059\u3002\n\u2026\u2026\u306f\u3044\u3001\u8033\u6163\u308c\u306a\u3044\u8a00\u8449\u304c\u3044\u3063\u3071\u3044\u51fa\u3066\u304d\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4e00\u3064\u3072\u3068\u3064\u89e3\u8aac\u3057\u3066\u3044\u304f\u306e\u3067\u5b89\u5fc3\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u7b11\n\u3068\u3044\u3046\u308f\u3051\u3067\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001\n\n\u7406\u8ad6\uff1a\u306a\u305c\u3053\u308c\u3067\u76f8\u95a2\u304c\u3042\u308b nn \u500b\u306e\u4e71\u6570\u304c\u4f5c\u308c\u308b\u306e\u304b\n\u691c\u8a3c\uff1aPython \u3067\u5b9f\u969b\u306b\u3084\u3063\u3066\u307f\u308b\n\n\u306b\u3064\u3044\u3066\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u304c\u3069\u3046\u3044\u3046\u3082\u306e\u304b\u306b\u3064\u3044\u3066\u3082\u89e6\u308c\u307e\u3059\u304c\u3001\u5b9f\u969b\u306b\u3069\u3046\u3084\u3063\u3066\u5206\u89e3\u3092\u5b9f\u73fe\u3059\u308b\u304b\u306f\u8aac\u660e\u3057\u307e\u305b\u3093\u306e\u3067\u3042\u3057\u304b\u3089\u305a\u3002\n\n\u7406\u8ad6\n\u7406\u8ad6\u306e\u5927\u307e\u304b\u306a\u6d41\u308c\u3068\u3057\u3066\u306f\u3001\n\n{Zi}=Z1,Z2,\u2026,Zn\\{Z_i\\} = Z_1, Z_2, \\dots, Z_n \u3092 {Xi}\\{X_i\\} \u3092\u4f7f\u3063\u3066\u8868\u73fe\u3059\u308b\u65b9\u6cd5\u3092\u8003\u3048\u308b\n\u5f97\u3089\u308c\u305f\u8868\u73fe\u3092\u3001\u76f8\u95a2\u4fc2\u6570\u3068\u95a2\u9023\u4ed8\u3051\u308b\n\u8868\u73fe\u3092\u78ba\u5b9a\u3059\u308b\n\n\u3068\u3044\u3046\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\u3067\u306f\u3044\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\nZ \u3092\u4f5c\u308b\u30a2\u30a4\u30c7\u30a3\u30a2\n\u72ec\u7acb\u306a\u4e71\u6570 {Xi}\\{X_i\\} \u306b\u3064\u3044\u3066\u3001\u5e73\u5747\u306f\u305d\u308c\u305e\u308c\u30bc\u30ed\u3001\u5206\u6563\u306f\u540c\u3058\u5024\u3067 \u03c32\\sigma^2 \u3068\u3057\u307e\u3059\u3002\u3053\u308c\u3089\u306f\u72ec\u7acb\u306a\u306e\u3067\u3001 \u5171\u5206\u6563 Cov[Xi,Xj]\\mathrm{Cov}[X_i, X_j] \u3084\u76f8\u95a2\u4fc2\u6570 Corr[Xi,Xj]\\mathrm{Corr}[X_i, X_j] \u306f\u30bc\u30ed\u3067\u3059\u3002\n\u3053\u306e {Xi}\\{X_i\\} \u3092\u4f7f\u3063\u3066 {Zi}\\{Z_i\\} \u3092\u4f5c\u3063\u3066\u3044\u304d\u305f\u3044\u308f\u3051\u3067\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\\begin{align}\nZ_1 &= a_{11} X_1\n\\\\\nZ_2 &= a_{21} X_1 + a_{22} X_2\n\\\\\nZ_3 &= a_{31} X_1 + a_{32} X_2 + a_{33} X_3\n\\\\\n&\\vdots\n\\\\\nZ_n &= a_{n1} X_1 + a_{n2} X_2 + \\dots + a_{nn} X_n\n\\end{align}\nZ1=a11X1Z2=a21X1+a22X2Z3=a31X1+a32X2+a33X3\u22eeZn=an1X1+an2X2+\u22ef+annXn{\\begin{align}\nZ_1 &= a_{11} X_1\n\\\\\nZ_2 &= a_{21} X_1 + a_{22} X_2\n\\\\\nZ_3 &= a_{31} X_1 + a_{32} X_2 + a_{33} X_3\n\\\\\n&\\vdots\n\\\\\nZ_n &= a_{n1} X_1 + a_{n2} X_2 + \\dots + a_{nn} X_n\n\\end{align}\n}\n\u3053\u308c\u306f\u307e\u305a\u57fa\u6e96\u3068\u306a\u308b Z1Z_1 \u3092\u4f5c\u308a\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066\u6c7a\u3081\u3089\u308c\u305f\u76f8\u95a2\u3092\u3082\u3064 Z2Z_2 \u3092\u4f5c\u308a\u3001\u4eca\u5ea6\u306f Z1Z_1 \u3068 Z2Z_2 \u3092\u57fa\u6e96\u3068\u3057\u3066\u305d\u308c\u305e\u308c\u306b\u5bfe\u3057\u3066\u6c7a\u3081\u3089\u308c\u305f\u76f8\u95a2\u3092\u6301\u3064 Z3Z_3 \u3092\u4f5c\u308a\u2026\u2026\u3068\u3044\u3046\u3053\u3068\u3092\u7e70\u308a\u8fd4\u3057\u3066 ZnZ_n \u307e\u3067\u3044\u304f\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\u3053\u306e\u90e8\u5206\u3092\u7406\u89e3\u3059\u308b\u3053\u3068\u306f\u975e\u5e38\u306b\u91cd\u8981\u3067\u3059\u3002\u306a\u3093\u306a\u3089\u7406\u8ad6\u30d1\u30fc\u30c8\u306e\u534a\u5206\u4ee5\u4e0a\u3092\u5360\u3081\u308b\u3068\u8a00\u3063\u3066\u3082\u904e\u8a00\u3067\u306f\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u3061\u3087\u3063\u3068\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u307f\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u306b\u3001n=3n = 3 \u3068\u3057\u3066\u8003\u3048\u3066\u307f\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u30a4\u30e1\u30fc\u30b8\u304c\u5b8c\u74a7\u3060\u3001\u3068\u3044\u3046\u65b9\u306f\u3053\u306e\u90e8\u5206\u306f\u8aad\u307f\u98db\u3070\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u76f8\u95a2\u3068\u306f\u4f55\u304b\u3075\u305f\u3064\u306e\u3082\u306e\u306e\u95a2\u4fc2\u3067\u3059\u3002\u95a2\u4fc2\u3092\u8003\u3048\u308b\u305f\u3081\u306b\u306f\u57fa\u6e96\u304c\u306a\u3044\u3068\u59cb\u307e\u3089\u306a\u3044\u306e\u3067\u3001\nZ_1 = a_{11} X_1\nZ1=a11X1{Z_1 = a_{11} X_1\n}\n\u3053\u306e\u90e8\u5206\u306f\u554f\u984c\u306a\u3044\u3068\u601d\u3044\u307e\u30593\u3002\u6b21\u306b\u3001 Z1Z_1 \u3068\u4ed6\u306e\u4e71\u6570\uff08X2X_2 \u3092\u9078\u3073\u307e\u3057\u3087\u3046\uff09\u3092\u4f7f\u3063\u3066\u3001\nZ_2 = c Z_1 + a_{22} X_2\nZ2=cZ1+a22X2{Z_2 = c Z_1 + a_{22} X_2\n}\n\u3068\u3057\u3001\u4fc2\u6570\u3092\u9069\u5207\u306b\u9078\u3076\u3053\u3068\u3067 Z1Z_1 \u3068 \u03c112\\rho_{12} \u3067\u76f8\u95a2\u3059\u308b Z2Z_2 \u304c\u4f5c\u308c\u307e\u3059\u3002\u3053\u308c\u3082\u524d\u56de\u306e\u8a18\u4e8b\u3092\u898b\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u554f\u984c\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u3053\u306e\u5f0f\u306e\u53f3\u8fba\u3092 {Xi}\\{X_i\\} \u3060\u3051\u306b\u3057\u3066\n\\begin{align}\nZ_2 &= c_1 \\cdot a_{11} X_1 + a_{22} X_2 & (\\because Z_1 \u306e\u5f0f)\n\\\\\n&= a_{21} X_1 + a_{22} X_2 & (\\because a_{21} = c_1 \\cdot a_{11} \u3068\u304a\u3044\u305f)\n\\end{align}\nZ2=c1\u22c5a11X1+a22X2(\u2235Z1\u306e\u5f0f)=a21X1+a22X2(\u2235a21=c1\u22c5a11\u3068\u304a\u3044\u305f){\\begin{align}\nZ_2 &= c_1 \\cdot a_{11} X_1 + a_{22} X_2 & (\\because Z_1 \u306e\u5f0f)\n\\\\\n&= a_{21} X_1 + a_{22} X_2 & (\\because a_{21} = c_1 \\cdot a_{11} \u3068\u304a\u3044\u305f)\n\\end{align}\n}\n\u3053\u308c\u30672\u5217\u76ee\u306e\u5f0f\u304c\u3067\u3066\u304d\u307e\u3057\u305f\u306d\u3002\u6700\u5f8c\u306b Z3Z_3 \u3067\u3059\u304c\u3001\u3059\u3067\u306b\u4e71\u6570\u304c2\u3064\u3042\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3044\u308d\u3044\u308d\u306a\u5834\u5408\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\n\u72b6\u6cc11. Z_2 \u3088\u308a Z_1 \u3068\u3088\u304f\u76f8\u95a2\u3059\u308b\n\u72b6\u6cc12. Z_1 \u3088\u308a Z_2 \u3068\u3088\u304f\u76f8\u95a2\u3059\u308b\n\u72b6\u6cc13. \u3069\u3061\u3089\u3068\u3082\u76f8\u95a2\u3057\u306a\u3044\n\u72b6\u6cc14. \u2026\u2026\n\n\u3053\u308c\u3089\u306e\u72b6\u6cc1\u3092\u5e45\u5e83\u304f\u30ab\u30d0\u30fc\u3059\u308b\u305f\u3081\u306b\u306f\u3001\nZ_3 = c_1 Z_1 + c_2 Z_2 + a_{31} X_3\nZ3=c1Z1+c2Z2+a31X3{Z_3 = c_1 Z_1 + c_2 Z_2 + a_{31} X_3\n}\n\u3068\u3001Z1Z_1\u3001Z2Z_2 \u3068\u66f4\u306b\u65b0\u305f\u306a\u4e71\u6570 X3X_3 \u306e\u91cd\u306d\u5408\u308f\u305b\u304c\u5fc5\u8981\u3068\u306a\u308a\u305d\u3046\u3067\u3059\u3088\u306d\u3002\u5b9f\u969b\u3001 c1c_1 \u3092\u5927\u304d\u304f\u53d6\u308c\u3070 \u72b6\u6cc11\u3092\u3001c2c_2 \u3092\u5927\u304d\u304f\u3068\u308c\u3070 \u72b6\u6cc12\u3092\u3001c1=c2=0c_1 = c_2 = 0 \u3068\u3057\u3066 a31a_{31} \u3060\u3051\u3092\u4f55\u304b\u306e\u6570\u5b57\u306b\u3059\u308c\u3070\u72b6\u6cc13\u3092\u8868\u305b\u305d\u3046\u3067\u3059\u3002\u3053\u306e\u5f0f\u306e\u53f3\u8fba\u3092\u307e\u305f {Xi}\\{X_i\\} \u306e\u307f\u3067\u8868\u3057\u3001\u4fc2\u6570\u3092\u9069\u5f53\u306b\u5b9a\u7fa9\u3057\u76f4\u3059\u3053\u3068\u306b\u3088\u3063\u30663\u5217\u76ee\u306e\u5f0f\u3082\u5c0e\u3051\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u3001\u3059\u3067\u306b\u4f5c\u3063\u305f Z1,Z2,\u2026,ZiZ_1, Z_2, \\dots, Z_i \u3068\u65b0\u305f\u306a\u4e71\u6570 Xi+1X_{i + 1} \u3092\u91cd\u306d\u5408\u308f\u305b\u308b\u3053\u3068\u306b\u3088\u3063\u3066 Zi+1Z_{i + 1} \u304c\u4f5c\u308c\u305d\u3046\u306a\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\n\u76f8\u95a2\u4fc2\u6570\u3068\u95a2\u9023\u4ed8\u3051\u308b\n\u3055\u3066\u3001\u5148\u7a0b\u306e {Zi}\\{Z_i\\} \u3092\u6c42\u3081\u308b\u5f0f\u3092\u884c\u5217\u3068\u3057\u3066\u8868\u73fe\u3057\u3066\u3084\u308b\u3068\u3001\nZ = \n\\left(\n \\begin{array}{ccccc}\n    a_{11} & 0 & 0 & \\dots & 0\n    \\\\\n    a_{21} & a_{22} & 0 & \\dots & 0\n    \\\\\n    a_{31} & a_{32} & a_{33} & & \\vdots\n    \\\\\n    \\vdots & \\vdots & & \\ddots & 0\n     \\\\\n    a_{n1} & a_{n2} & & \\dots & a_{nn}\n \\end{array}\n\\right)X\nZ=(a1100\u20260a21a220\u20260a31a32a33\u22ee\u22ee\u22ee\u22f10an1an2\u2026ann)X{Z = \n\\left(\n \\begin{array}{ccccc}\n    a_{11} & 0 & 0 & \\dots & 0\n    \\\\\n    a_{21} & a_{22} & 0 & \\dots & 0\n    \\\\\n    a_{31} & a_{32} & a_{33} & & \\vdots\n    \\\\\n    \\vdots & \\vdots & & \\ddots & 0\n     \\\\\n    a_{n1} & a_{n2} & & \\dots & a_{nn}\n \\end{array}\n\\right)X\n}\n\u3068\u66f8\u3051\u307e\u3059\u3002\u3053\u308c\u304c\u307e\u3055\u3057\u304f\u5148\u7a0b\u3061\u3089\u3063\u3068\u51fa\u3066\u304d\u305f\u300c\u4e0b\u4e09\u89d2\u884c\u5217\u300d\u3067\u3001\u5bfe\u89d2\u6210\u5206\u3068\u305d\u306e\u5de6\u4e0b\u306b\u306f\u5024\u304c\u5165\u3063\u3066\u304a\u308a\u3001\u53f3\u4e0a\u306f\u3059\u3079\u3066\u30bc\u30ed\u3067\u57cb\u3081\u5c3d\u304f\u3055\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u884c\u5217\u3067\u3059\u306d\u3002\n\u3053\u306e\u884c\u5217\u304c Z=L\u00a0XZ = L \\ X \u306e\u4e2d\u306b\u51fa\u3066\u304d\u305f LL \u306b\u76f8\u5f53\u3059\u308b\u308f\u3051\u3067\u3059\u3002\u305d\u3046\u3068\u308f\u304b\u308c\u3070\u3001\u3042\u3068\u306f\u4fc2\u6570 {aij}\\{a_{ij}\\} \u3092\u3001\u4e0e\u3048\u3089\u308c\u305f\u76f8\u95a2\u3092\u6e80\u305f\u3059\u3088\u3046\u306b\u6c7a\u3081\u3066\u3042\u3052\u308b\u3060\u3051\u3067\u3059\u3002\u3064\u307e\u308a\u3001{aij}\\{a_{ij}\\} \u3068 {\u03c1ij}\\{\\rho_{ij}\\} \u306e\u95a2\u4fc2\u304c\u308f\u304b\u308c\u3070\u3044\u3044\u308f\u3051\u3067\u3059\u3002\nZiZ_i \u3068 ZjZ_j \u306e\u9593\u306e\u76f8\u95a2 \u03c1ij\\rho_{ij} \u304c\u4e0e\u3048\u3089\u308c\u305f\u3068\u304d\u3001\u6e80\u305f\u3059\u3079\u304d\u5f0f\u306f\n\\mathrm{Corr}[Z_i, Z_j] = \\rho_{ij}\nCorr[Zi,Zj]=\u03c1ij{\\mathrm{Corr}[Z_i, Z_j] = \\rho_{ij}\n}\n\u3067\u3059\u306d\u3002\u307e\u3093\u307e\u3067\u3059\u304c\u3002\n\u3053\u306e\u307e\u307e\u3060\u3068\u4f55\u3082\u8a00\u3048\u306a\u3044\u306e\u3067\u3001\u5de6\u8fba\u3092\u5909\u5f62\u3057\u3066\u3044\u304d\u307e\u3059\u3002\nLHS = \\frac{\\mathrm{Cov}[Z_i, Z_j]}{\\sqrt{\\mathrm{Var}[Z_i]} \\sqrt{\\mathrm{Var}[Z_j]}} \\ (\\because \\mathrm{Corr} \u306e\u5b9a\u7fa9)\nLHS=Cov[Zi,Zj]\u221aVar[Zi]\u221aVar[Zj]\u00a0(\u2235Corr\u306e\u5b9a\u7fa9){LHS = \\frac{\\mathrm{Cov}[Z_i, Z_j]}{\\sqrt{\\mathrm{Var}[Z_i]} \\sqrt{\\mathrm{Var}[Z_j]}} \\ (\\because \\mathrm{Corr} \u306e\u5b9a\u7fa9)\n}\n\u3053\u3053\u3067\u3001\u7d50\u679c\u3092\u5148\u53d6\u308a\u3057\u3066 Var[Zk]=\u03c32\u00a0(for\u00a0all\u00a0k)\\mathrm{Var}[Z_k] = \\sigma^2 \\ (\\mathrm{for \\ all} \\ k) \u3092\u8a8d\u3081\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002{Zk}\\{Z_k\\} \u306e\u5206\u6563\u306f {Xk}\\{X_k\\} \u306e\u5206\u6563\u3068\u540c\u3058\u306b\u306a\u308a\u307e\u3059\u3088\u3068\u3044\u3046\u3053\u3068\u3092\u4eee\u5b9a\u3059\u308b\u306e\u3067\u3059\uff08\u3067\u306a\u3044\u3068\u8a08\u7b97\u304c\u3084\u3084\u3053\u3057\u304f\u306a\u308b\u306e\u3067\uff09\u3002\u3053\u308c\u306b\u3064\u3044\u3066\u306f\u3001\u3042\u3068\u3067\u6570\u5024\u7684\u306b\u691c\u8a3c\u3057\u307e\u3059\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u4e0a\u306e\u5f0f\u306f\n\\frac{\\mathrm{Cov}[Z_i, Z_j]}{\\sigma^2}\nCov[Zi,Zj]\u03c32{\\frac{\\mathrm{Cov}[Z_i, Z_j]}{\\sigma^2}\n}\n\u3068\u306a\u308a\u307e\u3059\u3002\u6b21\u306f\u3001\u5206\u5b50\u3092 {Xi}\\{X_i\\} \u3067\u5c55\u958b\u3057\u3066\u3044\u304d\u307e\u3059\u3002i\u2265ji \\geq j \u3068\u3057\u3066\u3001\n\\begin{align}\n\\mathrm{Cov}[Z_i, Z_j] &= \\mathrm{Cov}[a_{i1} X_1 + a_{i2} X_2 + \\dots + a_{ii} X_i, \\ \na_{j1} X_1 + a_{j2} X_2 + \\dots + a_{jj} X_j]\n\\end{align}\nCov[Zi,Zj]=Cov[ai1X1+ai2X2+\u22ef+aiiXi,\u00a0aj1X1+aj2X2+\u22ef+ajjXj]{\\begin{align}\n\\mathrm{Cov}[Z_i, Z_j] &= \\mathrm{Cov}[a_{i1} X_1 + a_{i2} X_2 + \\dots + a_{ii} X_i, \\ \na_{j1} X_1 + a_{j2} X_2 + \\dots + a_{jj} X_j]\n\\end{align}\n}\n\u3067\u3059\u304c\u3001Cov\\mathrm{Cov} \u306b\u306f\n\\mathrm{Cov}[a A + b B, c C + d D] = ac \\mathrm{Cov}[A, C] + ad \\mathrm{Cov}[A, D] + bc \\mathrm{Cov}[B, C] + bd \\mathrm{Cov}[B, D]\nCov[aA+bB,cC+dD]=acCov[A,C]+adCov[A,D]+bcCov[B,C]+bdCov[B,D]{\\mathrm{Cov}[a A + b B, c C + d D] = ac \\mathrm{Cov}[A, C] + ad \\mathrm{Cov}[A, D] + bc \\mathrm{Cov}[B, C] + bd \\mathrm{Cov}[B, D]\n}\n\u3068\u3044\u3046\u6027\u8cea\u304c\u3042\u308b\u306e\u3067\uff08\u5c0f\u6587\u5b57\u306f\u5b9a\u6570\u3067\u5927\u6587\u5b57\u304c\u4e71\u6570\uff09\u3001\u5148\u7a0b\u306e\u5f0f\u3082\u540c\u3058\u3088\u3046\u306b\u5206\u89e3\u3067\u304d\u307e\u3059\u3002\u3055\u3089\u306b\u3001\u4eca\u306e\u5834\u5408 Cov[Xk,Xk]=\u03c32\\mathrm{Cov}[X_k, X_k] = \\sigma^2 \u3001Cov[Xk,Xl]=0\u00a0(k\u2260l)\\mathrm{Cov}[X_k, X_l] = 0 \\ (k \\neq l) \u306a\u306e\u3067\u3001\n\\begin{align}\n\\mathrm{Cov}[&a_{i1} X_1 + a_{i2} X_2 + \\dots + a_{ii} X_i, \\ \na_{j1} X_1 + a_{j2} X_2 + \\dots + a_{jj} X_j]\n\\\\\n&= a_{i1} a_{j1} \\mathrm{Cov}[X_1, X_1] + a_{i2} a_{j2} \\mathrm{Cov}[X_2, X_2] + \\dots + a_{ij} a_{jj} \\mathrm{Cov}[X_j, X_j] + a_{i(j+1)} \\cdot 0  \\cdot \\mathrm{Cov}[X_{j+1}, X_{j+1}] + \\dots\n\\\\\n&= a_{i1} a_{j1} \\sigma^2 + a_{i2} a_{j2} \\sigma^2 + \\dots + a_{ij} a_{jj} \\sigma^2\n\\\\\n&= (a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}) \\ \\sigma^2\n\\end{align}\nCov[ai1X1+ai2X2+\u22ef+aiiXi,\u00a0aj1X1+aj2X2+\u22ef+ajjXj]=ai1aj1Cov[X1,X1]+ai2aj2Cov[X2,X2]+\u22ef+aijajjCov[Xj,Xj]+ai(j+1)\u22c50\u22c5Cov[Xj+1,Xj+1]+\u2026=ai1aj1\u03c32+ai2aj2\u03c32+\u22ef+aijajj\u03c32=(ai1aj1+ai2aj2+\u22ef+aijajj)\u00a0\u03c32{\\begin{align}\n\\mathrm{Cov}[&a_{i1} X_1 + a_{i2} X_2 + \\dots + a_{ii} X_i, \\ \na_{j1} X_1 + a_{j2} X_2 + \\dots + a_{jj} X_j]\n\\\\\n&= a_{i1} a_{j1} \\mathrm{Cov}[X_1, X_1] + a_{i2} a_{j2} \\mathrm{Cov}[X_2, X_2] + \\dots + a_{ij} a_{jj} \\mathrm{Cov}[X_j, X_j] + a_{i(j+1)} \\cdot 0  \\cdot \\mathrm{Cov}[X_{j+1}, X_{j+1}] + \\dots\n\\\\\n&= a_{i1} a_{j1} \\sigma^2 + a_{i2} a_{j2} \\sigma^2 + \\dots + a_{ij} a_{jj} \\sigma^2\n\\\\\n&= (a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}) \\ \\sigma^2\n\\end{align}\n}\n\u3068\u306a\u308a\u307e\u3059\u3002aj(j+1)=aj(j+2)=\u22ef=aji=0a_{j(j+1)} = a_{j(j+2)} = \\dots = a_{ji} = 0 \u306a\u306e\u3067\u3001\u9805\u306f jj \u756a\u76ee\u3067\u6253\u3061\u5207\u308a\u306b\u306a\u308b\u306e\u304c\u30df\u30bd\u3067\u3059\u306d\u3002\n\u6700\u7d42\u7684\u306b\u3001\u76f8\u95a2\u4fc2\u6570\u306f\n\\rho_{ij} = \\mathrm{Corr}[Z_i, Z_j] = a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}\n\u03c1ij=Corr[Zi,Zj]=ai1aj1+ai2aj2+\u22ef+aijajj{\\rho_{ij} = \\mathrm{Corr}[Z_i, Z_j] = a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}\n}\n\u3068\u3001\u3053\u3093\u306a\u5f62\u306b\u306a\u308a\u307e\u3059\u3002\ni\u2265ji \\geq j \u3092\u4eee\u5b9a\u3057\u3066\u8a08\u7b97\u3057\u3066\u304d\u305f\u306e\u3067\u76f8\u95a2\u884c\u5217\u306e\u4e0b\u4e09\u89d2\u306e\u90e8\u5206\u3092\u8a08\u7b97\u3057\u305f\u3053\u3068\u306b\u306a\u308b\u306e\u3067\u3059\u304c\u3001\u76f8\u95a2\u884c\u5217\u306f\u5fc5\u305a\u5bfe\u79f0\u306a\u306e\u3067\u3001\n\\rho_{ji} = a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}\n\u03c1ji=ai1aj1+ai2aj2+\u22ef+aijajj{\\rho_{ji} = a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}\n}\n\u3082\u6210\u308a\u7acb\u3061\u307e\u3059\u3002\u5de6\u8fba\u306e\u6dfb\u5b57\u304c\u3053\u3063\u305d\u308a\u5165\u308c\u66ff\u308f\u3063\u3066\u307e\u3059\u3002\n\n\u884c\u5217\u3092\u300c\u89e3\u304f\u300d\n\u3053\u308c\u307e\u3067\u306e\u8b70\u8ad6\u3092\u884c\u5217\u306e\u5f62\u306b\u307e\u3068\u3081\u308b\u3068\u3001\u76f8\u95a2\u884c\u5217 RR \u306f\u3001{aij}\\{a_ij\\} \u3092\u4f7f\u3063\u3066\nR = \\left( \\begin{array}{cccc}\na_{11} a_{11} & a_{21} a_{11} & \\cdots & a_{n1} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22} &\n\\\\\n\\\\\n\\vdots & & \\ddots & \\vdots\n\\\\\na_{n1} a_{11} & a_{n1} a_{21} + a_{n2} a_{22} & \\dots &\n\\end{array} \\right)\nR=(a11a11a21a11\u22efan1a11a21a11a21a21+a22a22\u22ee\u22f1\u22eean1a11an1a21+an2a22\u2026){R = \\left( \\begin{array}{cccc}\na_{11} a_{11} & a_{21} a_{11} & \\cdots & a_{n1} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22} &\n\\\\\n\\\\\n\\vdots & & \\ddots & \\vdots\n\\\\\na_{n1} a_{11} & a_{n1} a_{21} + a_{n2} a_{22} & \\dots &\n\\end{array} \\right)\n}\n\u3068\u3001\u3053\u3093\u306a\u3075\u3046\u306b\u8868\u305b\u307e\u3059\u3002RR \u306b\u306f {\u03c1ij}\\{\\rho_{ij}\\} \u3092\u4f7f\u3063\u305f\u8868\u73fe\u3068 {aij}\\{a_{ij}\\} \u3092\u4f7f\u3063\u305f\u8868\u73fe\u306e2\u901a\u308a\u304c\u3042\u308b\u306e\u3067\u3001\u3053\u308c\u3067\u3053\u306e\u3075\u305f\u3064\u3092\u5bfe\u5fdc\u3065\u3051\u3089\u308c\u305f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u3042\u3068\u306f\u3001\u3053\u308c\u3092 {aij}\\{a_{ij}\\} \u306b\u3064\u3044\u3066\u89e3\u3051\u3070\u3044\u3044\u308f\u3051\u3067\u3059\u306d\u3002\n\u78ba\u8a8d\u306e\u305f\u3081\u3001n=2n = 2 \u3067\u8a08\u7b97\u3057\u3066\u307f\u307e\u3059\u3002\u76f8\u95a2\u884c\u5217\u3068\u4fc2\u6570\u306e\u5bfe\u5fdc\u306f\n\\left( \\begin{array}{cc}\na_{11} a_{11} & a_{21} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22}\n\\end{array} \\right)\n=\n\\left( \\begin{array}{cc}\n\\rho_{11} & \\rho_{12}\n\\\\\n\\rho_{21} & \\rho_{22}\n\\end{array} \\right)\n(a11a11a21a11a21a11a21a21+a22a22)=(\u03c111\u03c112\u03c121\u03c122){\\left( \\begin{array}{cc}\na_{11} a_{11} & a_{21} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22}\n\\end{array} \\right)\n=\n\\left( \\begin{array}{cc}\n\\rho_{11} & \\rho_{12}\n\\\\\n\\rho_{21} & \\rho_{22}\n\\end{array} \\right)\n}\n\u3067\u3059\u3002\u76f8\u95a2\u884c\u5217\u306a\u306e\u3067\u3001\u03c111=\u03c122=1\\rho_{11} = \\rho_{22} = 1 \u3060\u3057\u3001\u03c121=\u03c112\\rho_{21} = \\rho_{12} \u3067\u3059\u306d\u3002\n\u3053\u308c\u3092\u8e0f\u307e\u3048\u3066\u610f\u5473\u306e\u3042\u308b\u5f0f\u3092\u629c\u304d\u51fa\u3059\u3068\u3001\n\\begin{align}\na_{11}^2 &= 1\n\\\\\na_{21} a_{11} &= \\rho_{21}\n\\\\\na_{21}^2 + a_{22}^2 &= 1\n\\end{align}\na211=1a21a11=\u03c121a221+a222=1{\\begin{align}\na_{11}^2 &= 1\n\\\\\na_{21} a_{11} &= \\rho_{21}\n\\\\\na_{21}^2 + a_{22}^2 &= 1\n\\end{align}\n}\n\u3068\u3001\u3053\u306e3\u672c\u3067\u3059\u3002\u3053\u3053\u3067\u3001akk>0\u00a0(for\u00a0all\u00a0k)a_{kk} > 0 \\ (\\mathrm{for \\ all} \\ k) \u3068\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u3092\u89e3\u304f\u3068\u3001\n\\begin{align}\na_{11} &= 1\n\\\\\na_{21} &= \\rho_{21}\n\\\\\na_{22} &= \\sqrt{1 - \\rho_{21}^2}\n\\end{align}\na11=1a21=\u03c121a22=\u221a1\u2212\u03c1221{\\begin{align}\na_{11} &= 1\n\\\\\na_{21} &= \\rho_{21}\n\\\\\na_{22} &= \\sqrt{1 - \\rho_{21}^2}\n\\end{align}\n}\n\u3068\u306a\u308a\u3001\u524d\u56de\u6c42\u3081\u305f\u7d50\u679c\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u306d\u3002\u3088\u3055\u305d\u3046\u3067\u3059\u3002\n\u3067\u306f\u3082\u3063\u3068\u4e00\u822c\u7684\u306b nn \u6b21\u5143\u306e\u884c\u5217\u306e\u3068\u304d\u306f\u3069\u3046\u3068\u3044\u305f\u3089\u3044\u3044\u3067\u3057\u3087\u3046\u304b\uff1f \u3082\u3046\u4e00\u5ea6\u884c\u5217\u3092\u3088\u304f\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u3082\u3046\u3061\u3087\u3063\u3068\u66f8\u304f\u6210\u5206\u3092\u5897\u3084\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nR = \\left( \\begin{array}{ccccc}\na_{11} a_{11} & a_{21} a_{11} & a_{31} a_{11} & \\cdots & a_{n1} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22} &\na_{31} a_{21} + a_{32} a_{22} &\n\\\\\na_{31} a_{11} & a_{31} a_{21} + a_{32} a_{22} & a_{31} a_{31} + a_{32} a_{32} + a_{33} a_{33} \n\\\\\n\\vdots & \\vdots & & \\ddots & \\vdots\n\\\\\na_{n1} a_{11} & a_{n1} a_{21} + a_{n2} a_{22} & \\dots &\n\\end{array} \\right)\nR=(a11a11a21a11a31a11\u22efan1a11a21a11a21a21+a22a22a31a21+a32a22a31a11a31a21+a32a22a31a31+a32a32+a33a33\u22ee\u22ee\u22f1\u22eean1a11an1a21+an2a22\u2026){R = \\left( \\begin{array}{ccccc}\na_{11} a_{11} & a_{21} a_{11} & a_{31} a_{11} & \\cdots & a_{n1} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22} &\na_{31} a_{21} + a_{32} a_{22} &\n\\\\\na_{31} a_{11} & a_{31} a_{21} + a_{32} a_{22} & a_{31} a_{31} + a_{32} a_{32} + a_{33} a_{33} \n\\\\\n\\vdots & \\vdots & & \\ddots & \\vdots\n\\\\\na_{n1} a_{11} & a_{n1} a_{21} + a_{n2} a_{22} & \\dots &\n\\end{array} \\right)\n}\n\u7d50\u69cb\u30ad\u30ec\u30a4\u306a\u5f62\u3092\u3057\u3066\u3044\u307e\u3059\u3088\u306d\u3002\u5b9f\u306f\u3053\u308c\u3001\nR = \\left(\n \\begin{array}{ccccc}\n    a_{11} & 0 & 0 & \\dots & 0\n    \\\\\n    a_{21} & a_{22} & 0 & \\dots & 0\n    \\\\\n    a_{31} & a_{32} & a_{33} & & \\vdots\n    \\\\\n    \\vdots & \\vdots & & \\ddots & 0\n     \\\\\n    a_{n1} & a_{n2} & & \\dots & a_{nn}\n \\end{array}\n\\right)\n\\left(\n \\begin{array}{ccccc}\n    a_{11} & a_{21} & a_{31}  & \\dots & a_{n1}\n    \\\\\n    0 & a_{22} & a_{32} & \\dots & a_{n2}\n    \\\\\n    0 & 0 & a_{33} & & \n    \\\\\n    \\vdots & \\vdots & & \\ddots & \\vdots\n     \\\\\n    0 & 0 & & \\dots & a_{nn}\n \\end{array}\n\\right)\nR=(a1100\u20260a21a220\u20260a31a32a33\u22ee\u22ee\u22ee\u22f10an1an2\u2026ann)(a11a21a31\u2026an10a22a32\u2026an200a33\u22ee\u22ee\u22f1\u22ee00\u2026ann){R = \\left(\n \\begin{array}{ccccc}\n    a_{11} & 0 & 0 & \\dots & 0\n    \\\\\n    a_{21} & a_{22} & 0 & \\dots & 0\n    \\\\\n    a_{31} & a_{32} & a_{33} & & \\vdots\n    \\\\\n    \\vdots & \\vdots & & \\ddots & 0\n     \\\\\n    a_{n1} & a_{n2} & & \\dots & a_{nn}\n \\end{array}\n\\right)\n\\left(\n \\begin{array}{ccccc}\n    a_{11} & a_{21} & a_{31}  & \\dots & a_{n1}\n    \\\\\n    0 & a_{22} & a_{32} & \\dots & a_{n2}\n    \\\\\n    0 & 0 & a_{33} & & \n    \\\\\n    \\vdots & \\vdots & & \\ddots & \\vdots\n     \\\\\n    0 & 0 & & \\dots & a_{nn}\n \\end{array}\n\\right)\n}\n\u3068\u3044\u3046\u5f62\u306b\u5206\u89e3\u3067\u304d\u308b\u3068\u8a00\u3063\u305f\u3089\u9a5a\u304f\u3067\u3057\u3087\u3046\u304b\uff1f \u5b9f\u969b\u3053\u308c\u306f\u672c\u5f53\u3067\u3001\u3053\u306e\u3042\u305f\u308a\u304c\u6570\u5b66\u306e\u7f8e\u3057\u3044\u3068\u3053\u308d\u3067\u3059\u3088\u306d\u3002\nn=3n = 3 \u3068\u3057\u3066\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u624b\u8a08\u7b97\u306f\u3057\u3093\u3069\u3044\u306e\u3067\u3001\u3053\u3053\u306f SymPy \u3092\u4f7f\u3044\u307e\u3059\u3002SymPy \u306f\u3001Mathematica \u306e\u3088\u3046\u306a\u6570\u5f0f\u306e\u8a08\u7b97\u3092\u3057\u3066\u304f\u308c\u308b Python \u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\n\u8a66\u3057\u306b\u5206\u89e3\u3055\u308c\u305f\u884c\u5217\u3092\u639b\u3051\u3066\u3082\u3068\u306b\u623b\u308b\u304b\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nimport sympy\n\n# Define symbols\na_11, a_22, a_33 = sympy.symbols('a_11 a_22 a_33', real=True, positive=True)\na_21, a_31, a_32 = sympy.symbols('a_21 a_31 a_32', real=True)\n\n# Define lower and upper triangular matrices\nL = sympy.Matrix([\n    [a_11, 0, 0], \n    [a_21, a_22, 0], \n    [a_31, a_32, a_33]\n    ])\nU = L.transpose()\n\n# Calculate product of triangular matrices\nR = L * U\nprint(\"R = {}\".format(R))\n\n\u51fa\u529b\u306f\u3053\u3061\u3089\u3002\u898b\u3084\u3059\u3044\u3088\u3046\u306b\u6574\u5f62\u3057\u3066\u307e\u30594\u3002\n\n\u51fa\u529b\nR = Matrix([\n[a_11**2,     a_11 * a_21,               a_11 * a_31                ],\n[a_11 * a_21, a_21**2 + a_22**2,         a_21 * a_31 + a_22 * a_32  ],\n[a_11 * a_31, a_21 * a_31 + a_22 * a_32, a_31**2 + a_32**2 + a_33**2]\n])\n\n\n\u306a\u3093\u3068\uff01 \u304d\u3061\u3093\u3068\u671f\u5f85\u3055\u308c\u305f\u7d50\u679c\u304c\u51fa\u3066\u304d\u3066\u3044\u307e\u3059\u306d\uff01\n\u9006\u306b\u8a00\u3046\u3068\u3001\u300c\u3042\u308b\u884c\u5217\u3092\u4e0b\u4e09\u89d2\u884c\u5217\u3068\u305d\u306e\u8ee2\u7f6e\uff08\u4e0a\u4e09\u89d2\u884c\u5217\uff09\u306e\u7a4d\u306b\u5206\u89e3\u3059\u308b\u300d\u3068\u3044\u3046\u64cd\u4f5c\u3053\u305d\u304c\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u306a\u306e\u3067\u3059\u3002\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u3053\u308c\u3082\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nimport sympy\n\n# Define symbols\na_11, a_22, a_33 = sympy.symbols('a_11 a_22 a_33', real=True, positive=True)\na_21, a_31, a_32 = sympy.symbols('a_21 a_31 a_32', real=True)\n\n# Define correlation matrix\nR = sympy.Matrix([\n    [a_11**2,     a_11 * a_21,               a_11 * a_31                ],\n    [a_11 * a_21, a_21**2 + a_22**2,         a_21 * a_31 + a_22 * a_32  ],\n    [a_11 * a_31, a_21 * a_31 + a_22 * a_32, a_31**2 + a_32**2 + a_33**2]\n    ])\n\n# Perform cholesky decomposition\nL = R.cholesky()\nprint(\"L = {}\".format(L))\n\n\u51fa\u529b\u3002\n\n\u51fa\u529b\nL = Matrix([\n[a_11, 0,    0   ], \n[a_21, a_22, 0   ], \n[a_31, a_32, a_33]\n])\n\n\n\u3046\u304a\u304a\u3001\u304d\u3061\u3093\u3068\u306a\u3063\u3066\u3044\u308b\uff01 \u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3067\u30ad\u30ec\u30a4\u306b\u4fc2\u6570\u304c\u53d6\u308a\u51fa\u305b\u3066\u3044\u307e\u3059\u306d\uff01\n\u3053\u308c\u3067\u3001\u76f8\u95a2\u4fc2\u6570 RR \u3092\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3057\u305f\u3082\u306e\u304c\u3001\u76f8\u95a2\u306e\u3042\u308b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u304f\u308c\u308b\u884c\u5217\u3067\u3042\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\uff01\n\n\u7406\u8ad6\u306e\u307e\u3068\u3081\n\u9577\u304f\u306a\u3063\u3066\u304d\u305f\u306e\u3067\u3001\u3053\u3053\u3067\u4e00\u65e6\u307e\u3068\u3081\u307e\u3059\u3002\n\u76f8\u95a2\u306e\u3042\u308b nn \u500b\u306e\u4e71\u6570\u306e\u4f5c\u308a\u65b9\uff1a\n\n\u76f8\u95a2\u884c\u5217 RR \u3092\u7528\u610f\u3059\u308b\u3002\nRR \u3092\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3057\u3066\u4e0b\u4e09\u89d2\u884c\u5217 LL \u3092\u6c42\u3081\u308b\u3002\nLL \u3092\u76f8\u95a2\u304c\u306a\u3044\u4e71\u6570\u306e\u5217\u30d9\u30af\u30c8\u30eb XX \u306b\u5de6\u304b\u3089\u639b\u3051\u308c\u3070\u3067\u304d\u3042\u304c\u308a\uff01\n\n\u6982\u8981\u3068\u8a00\u3063\u3066\u308b\u3053\u3068\u304c\u307e\u3063\u305f\u304f\u5909\u308f\u3063\u3066\u306a\u3044\u3067\u3059\u304c\u3001\u3060\u3044\u3076\u30a4\u30e1\u30fc\u30b8\u306f\u3064\u304b\u3081\u305f\u306f\u305a\u3067\u3059\u3002\n\u7e70\u308a\u8fd4\u3057\u307e\u3059\u304c\u3001\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3092\u3069\u306e\u3088\u3046\u306b\u8a08\u7b97\u3059\u308b\u304b\u3001\u3068\u3044\u3046\u3053\u3068\u306f\u3053\u3053\u3067\u306f\u89e6\u308c\u307e\u305b\u3093\u3002\u305f\u3060\u5358\u306b\u3001\u884c\u5217\u3092\u4e09\u89d2\u884c\u5217\u306b\u5206\u89e3\u3059\u308b\u30d6\u30e9\u30c3\u30af\u30dc\u30c3\u30af\u30b9\u3068\u3057\u3066\u6271\u3044\u307e\u3059\u3002\u8a08\u7b97\u6cd5\u306b\u3064\u3044\u3066\u306f\u8abf\u3079\u308c\u3070\u3044\u308d\u3044\u308d\u3068\u51fa\u3066\u304f\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u3069\u3046\u305e\u3002\n\n\u691c\u8a3c\n\u9577\u304b\u3063\u305f\u3067\u3059\u304c\u3001\u3044\u3088\u3044\u3088 Python3 \u3067\u691c\u8a3c\u3067\u3059\u3002\u524d\u56de\u306e\u53cd\u7701\u3092\u8e0f\u307e\u3048\u3001\u6700\u521d\u304b\u3089\u6b63\u898f\u4e71\u6570\u3067\u3044\u304d\u307e\u3059\u3002\nimport numpy as np\nimport numpy.random as rand\nimport matplotlib.pyplot as plt\n\n# Set parameters\nn = 3 # The number of random numbers\nsize = int(1e4) # Size of the vector\nr_in = np.matrix([\n    [1, 0.2, 0.8],\n    [0.2, 1, 0.6],\n    [0.8, 0.6, 1]\n    ]) # Correlation matrix\n\n# Generate correlated random numbers\nl = np.linalg.cholesky(r_in)\nx = rand.randn(n, size)\nz = l * x\n\n# Calculate stats\ncov = np.cov(z)\nr_out = np.corrcoef(z)\nprint(\"covariance matrix:\\n{}\\n\".format(cov))\nprint(\"correlation matrix:\\n{}\\n\".format(r_out))\n\n# Plot results\nfig, ax = plt.subplots()\nax.scatter(z[0, :], z[1, :], s=1, color='red', label='Z_2')\nax.scatter(z[0, :], z[2, :], s=1, color='blue', label='Z_3')\nax.set_xlabel('Z_1')\nax.set_ylabel('Z_2, Z_3')\nax.legend()\nplt.show()\n\n\n\u51fa\u529b\u306f\u3053\u308c\u3002\n\n\u51fa\u529b\ncovariance matrix:\n[[ 1.00545504  0.19297604  0.79517079]\n [ 0.19297604  1.00391907  0.5943957 ]\n [ 0.79517079  0.5943957   0.99000159]]\n\ncorrelation matrix:\n[[ 1.          0.19207582  0.79700517]\n [ 0.19207582  1.          0.5962225 ]\n [ 0.79700517  0.5962225   1.        ]]\n\n\nCovariance matrix\uff08\u5171\u5206\u6563\u884c\u5217\uff09\u306e\u5bfe\u89d2\u6210\u5206\u306f\u5206\u6563\u3067\u3059\u3002\u3082\u3068\u306e\u6b63\u898f\u4e71\u6570\u3068\u540c\u3058\u3001\u5206\u6563 11 \u306b\u8fd1\u3044\u5024\u304c\u51fa\u3066\u3044\u308b\u306e\u3067\u3001\u7406\u8ad6\u306e\u3068\u3053\u308d\u3067\u304a\u3044\u305f\u3001\u300c{Zi}\\{Z_i\\} \u306e\u5206\u6563\u306f {Xi}\\{X_i\\} \u3068\u7b49\u3057\u3044\u300d\u3068\u3044\u3046\u4eee\u5b9a\u306f\u554f\u984c\u306a\u3055\u305d\u3046\u3067\u3059\u306d\u3002\n\u307e\u305f\u3001Correlation matrix\uff08\u76f8\u95a2\u884c\u5217\uff09\u306e\u307b\u3046\u3067\u306f\u3001\u304d\u3061\u3093\u3068\u30a4\u30f3\u30d7\u30c3\u30c8\u3057\u305f\u5024\u306b\u8fd1\u3044\u6570\u5b57\u304c\u51fa\u3066\u304d\u3066\u3044\u307e\u3059\u3002\nZ1Z_1 \u306b\u5bfe\u3059\u308b Z2Z_2 \u3068 Z3Z_3 \u306e\u30d7\u30ed\u30c3\u30c8\u306f\u3053\u3061\u3089\u3002\n\n\u03c113\\rho_{13} \u306b\u5f37\u3081\u306e\u76f8\u95a2\u3092\u5165\u308c\u305f\u306e\u304c\u304d\u3061\u3093\u3068\u53cd\u6620\u3055\u308c\u3066\u3044\u307e\u3059\u306d\uff01\n\u3067\u306f\u3053\u3093\u306a\u76f8\u95a2\u884c\u5217\u306f\u3069\u3046\u3067\u3057\u3087\u3046\uff1f \u8ca0\u306e\u76f8\u95a2\u3082\u898b\u305f\u3044\u3067\u3059\u3088\u306d\u3002\nr_in = np.matrix([\n    [1, -0.2, -0.8],\n    [-0.2, 1, -0.6],\n    [-0.8, -0.6, 1]\n    ]) # Correlation matrix\n\n\u5b9f\u884c\u3059\u308b\u3068\u2026\u2026\n\n\u51fa\u529b\nTraceback (most recent call last):\n  File \"spike.py\", line 15, in <module>\n    l = np.linalg.cholesky(r_in)\n  File \"/Users/horiem/.pyenv/versions/anaconda3-4.0.0/lib/python3.5/site-packages/numpy/linalg/linalg.py\", line 612, in cholesky\n    r = gufunc(a, signature=signature, extobj=extobj)\n  File \"/Users/horiem/.pyenv/versions/anaconda3-4.0.0/lib/python3.5/site-packages/numpy/linalg/linalg.py\", line 93, in _raise_linalgerror_nonposdef\n    raise LinAlgError(\"Matrix is not positive definite\")\nnumpy.linalg.linalg.LinAlgError: Matrix is not positive definite\n\nshell returned 1\n\n\n\u304a\u3063\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3057\u305f\u306d\uff08\u305d\u3057\u3066 pyenv \u3068 anaconda \u3092\u4f7f\u3063\u3066\u308b\u3053\u3068\u304c\u30d0\u30ec\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u306d\uff09\u3002\u3069\u3046\u3084\u3089\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u306b\u5931\u6557\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\"Matrix is not positive definite\" \u3068\u6012\u3063\u3066\u3044\u307e\u3059\u306d\u3002\n\u305d\u3046\u3067\u3059\u3001\u5b9f\u306f\u3001\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u304c\u3067\u304d\u308b\u305f\u3081\u306b\u306f\u3001\u5bfe\u8c61\u3068\u306a\u308b\u884c\u5217\u304c\uff1a\n\n\u5bfe\u79f0\u884c\u5217\u3067\u3042\u308b\uff08\u8907\u7d20\u6570\u306e\u5834\u5408\u306f\u30a8\u30eb\u30df\u30fc\u30c8\uff09\n\u6b63\u5b9a\u5024\u884c\u5217\uff08positive definite\uff09\u3067\u3042\u308b\n\n\u3053\u3068\u304c\u5fc5\u8981\u306a\u3093\u3067\u3059\u3002\n\u6b63\u5b9a\u5024\u884c\u5217\u3063\u3066\u4f55\u3058\u3083\u3063\u3066\u3044\u3046\u3068\u3001\u4efb\u610f\u306e\u975e\u30bc\u30ed\u30d9\u30af\u30c8\u30eb z\\boldsymbol{z} \u306b\u5bfe\u3057\u3066\u3001\n\\boldsymbol{z}^T M \\boldsymbol{z} > 0\nzTMz>0{\\boldsymbol{z}^T M \\boldsymbol{z} > 0\n}\n\u3068\u306a\u308b\u3088\u3046\u306a\u5bfe\u79f0\u884c\u5217 MM \u306e\u3053\u3068\u3067\u30595\u3002\n\u305d\u3093\u306a\u306e\u3044\u3061\u3044\u3061\u78ba\u8a8d\u3057\u3066\u3089\u308c\u306a\u3044\u3088\u3063\u3066\u3044\u3046\u4eba\u306e\u305f\u3081\u306b\u3001\u3044\u3044\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\u300c\u884c\u5217 MM \u304c\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3053\u3068\u300d\u3068\u300c\u884c\u5217 MM \u306e\u56fa\u6709\u5024\u304c\u3059\u3079\u3066\u6b63\u3067\u3042\u308b\u3053\u3068\u300d\u306f\u540c\u5024\u3067\u3059\u3002\u306a\u306e\u3067\u3001\u56fa\u6709\u5024\u306e\u7b26\u53f7\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nr_in = np.matrix([\n    [1, -0.2, -0.8],\n    [-0.2, 1, -0.6],\n    [-0.8, -0.6, 1]\n    ]) # Correlation matrix\n\nw, v = np.linalg.eig(r_in)\nprint(w)\n\n\n\u51fa\u529b\n[-0.10192577  1.19135241  1.91057336]\n\n\n\u3042\u3061\u3083\u301c\u3001\u3084\u3063\u3071\u308a\u8ca0\u306e\u56fa\u6709\u5024\u304c\u3042\u308a\u307e\u3059\u306d\u3002\u3053\u308c\u3058\u3083\u3042\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3067\u304d\u307e\u305b\u3093\u3002\n\u3048\u30fc\u3058\u3083\u3042\u8ca0\u306e\u76f8\u95a2\u304c\u3042\u308b\u3068\u304d\u306f\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3067\u304d\u306a\u3044\u3063\u3066\u3053\u3068\uff1f \u3044\u3084\u3044\u3084\u3001\u305d\u3046\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u5b9f\u306f\u3001\u3069\u3093\u306a\u76f8\u95a2\u884c\u5217\u306b\u3082\u3082\u3068\u3082\u3068\u975e\u8ca0\u5b9a\u5024\u6027\uff08\u534a\u6b63\u5b9a\u5024\u6027\uff09\u304c\u3042\u308a\u307e\u3059\u3002\u975e\u8ca0\u5b9a\u5024\u6027\u306f\u3001\u3055\u3063\u304d\u306e\u6b63\u5b9a\u5024\u6027\u306e\u6761\u4ef6\u306b\u30bc\u30ed\u3092\u542b\u3093\u3060\u5834\u5408\u3067\u3059\u3002\u3064\u307e\u308a\u3001\u56fa\u6709\u5024\u304c\u30bc\u30ed\u304b\u6b63\u306b\u306a\u308b\u3063\u3066\u3053\u3068\u3067\u3059\u306d\u3002\u56fa\u6709\u5024\u304c\u30bc\u30ed\u306e\u3082\u306e\u3092\u542b\u3080\u4f8b\u3068\u3057\u3066\u306f\u3001\n\\left( \\begin{array}{ccc}\n1 & 1 & -1\n\\\\\n1 & 1 & -1\n\\\\\n-1 & -1 & 1\n\\end{array} \\right)\n(11\u2212111\u22121\u22121\u221211){\\left( \\begin{array}{ccc}\n1 & 1 & -1\n\\\\\n1 & 1 & -1\n\\\\\n-1 & -1 & 1\n\\end{array} \\right)\n}\n\u3068\u304b\u3067\u3059\u306d\u3002\u3053\u308c\u306f\u975e\u8ca0\u5b9a\u5024\u306a\u306e\u3067\u76f8\u95a2\u884c\u5217\u306e\u8cc7\u683c\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u6b63\u5b9a\u5024\u3067\u306f\u306a\u3044\u306e\u3067\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u30ec\u30a2\u30b1\u30fc\u30b9\u3067\u3059\uff08\u3067\u3082\u3001\u5fc5\u8981\u306a\u3044\u3088\u306d\uff1f\uff1f\uff09\u3002\n\u3055\u3089\u306b\u3001\u3053\u3093\u306a\u884c\u5217\n\\left( \\begin{array}{ccc}\n1 & -1 & -1\n\\\\\n-1 & 1 & -1\n\\\\\n-1 & -1 & 1\n\\end{array} \\right)\n(1\u22121\u22121\u221211\u22121\u22121\u221211){\\left( \\begin{array}{ccc}\n1 & -1 & -1\n\\\\\n-1 & 1 & -1\n\\\\\n-1 & -1 & 1\n\\end{array} \\right)\n}\n\u3053\u308c\u3082\u4e00\u898b\u76f8\u95a2\u884c\u5217\u3063\u307d\u3044\u3067\u3059\u304c\u975e\u8ca0\u5b9a\u5024\u3067\u3059\u3089\u306a\u3044\u306e\u3067\u76f8\u95a2\u884c\u5217\u306e\u8cc7\u683c\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u8003\u3048\u3066\u307f\u308c\u3070\u660e\u3089\u304b\u3067\u3001Z1Z_1 \u3068 Z2Z_2 \u304c\u9006\u76f8\u95a2\u3001Z2Z_2 \u3068 Z3Z_3 \u3082\u9006\u76f8\u95a2\u3001Z3Z_3 \u3068 Z1Z_1 \u3082\u9006\u76f8\u95a2\u306a\u3093\u3066\u3042\u308a\u3048\u307e\u305b\u3093\u3088\u306d\uff1f \u3053\u308c\u306e\u8a00\u3063\u3066\u3044\u308b\u3053\u3068\u306f\n\\begin{align}\nZ_1 = - c_2 Z_2\n\\\\\nZ_2 = - c_3 Z_3\n\\\\\nZ_3 = -c_1 Z_1\n\\end{align}\nZ1=\u2212c2Z2Z2=\u2212c3Z3Z3=\u2212c1Z1{\\begin{align}\nZ_1 = - c_2 Z_2\n\\\\\nZ_2 = - c_3 Z_3\n\\\\\nZ_3 = -c_1 Z_1\n\\end{align}\n}\n\u3068\u3044\u3046\u3053\u3068\u3067\u3059\uff08c1,c2,c3>0c_1, c_2, c_3 > 0\uff09\u3002\u3053\u308c\u3092\u5168\u90e8\u4ee3\u5165\u3057\u3066\u3044\u304f\u3068 Z1=(\u8ca0\u306e\u5b9a\u6570)\u00d7Z1Z_1 = (\u8ca0\u306e\u5b9a\u6570) \\times Z_1 \u3068\u306a\u3063\u3066\u3001\u77db\u76fe\u304c\u8d77\u304d\u307e\u3059\u3002\u3053\u3046\u3044\u3046\u6b63\u3057\u304f\u306a\u3044\u30c7\u30fc\u30bf\u306f\u6570\u5b66\u306e\u30b7\u30b9\u30c6\u30e0\u306e\u307b\u3046\u3067\u5f3e\u3044\u3066\u304f\u308c\u3066\u3044\u308b\u3093\u3067\u3059\u306d\u3002\u3059\u3054\u3044\u3002\n\u5148\u7a0b\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u4f8b\u3082\u3001\u30d1\u30c3\u3068\u898b\u76f8\u95a2\u884c\u5217\u3063\u307d\u3044\u3082\u306e\u3067\u3057\u305f\u304c\u3001\u8ca0\u306e\u56fa\u6709\u5024\u304c\u542b\u307e\u308c\u3066\u3044\u305f\u306e\u3067\u975e\u8ca0\u5b9a\u5024\u3067\u3042\u308a\u307e\u305b\u3093\u3002\u3064\u307e\u308a\u3001\u5b9f\u969b\u306b\u306f\u76f8\u95a2\u884c\u5217\u3068\u306f\u547c\u3079\u306a\u3044\u30c1\u30f3\u30d7\u30f3\u30ab\u30f3\u30d7\u30f3\u306e\u30c7\u30fc\u30bf\u3060\u3063\u305f\u3063\u3066\u3053\u3068\u3067\u3059\u306d\u3002\n\u306a\u306e\u3067\u3001\u8ca0\u306e\u76f8\u95a2\u3092\u5165\u308c\u308b\u3068\u304d\u306f\u3082\u3046\u3061\u3087\u3063\u3068\u30de\u30a4\u30eb\u30c9\u306b\u3057\u3066\u3042\u3052\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\u4f8b\u3048\u3070\nr_in = np.matrix([\n    [1, 0.2, -0.4],\n    [0.2, 1, 0.6],\n    [-0.4, 0.6, 1]\n    ]) # Correlation matrix\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u306d\u3002\u4e00\u5fdc\u56fa\u6709\u5024\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3068\u2026\u2026\n\n\u51fa\u529b\n[ 0.17738188  1.18223576  1.64038236]\n\n\n\u5168\u90e8\u6b63\u3002\u3088\u304b\u3063\u305f\u3002\u56de\u3057\u3066\u307f\u308b\u3068\u2026\u2026\n\n\u51fa\u529b\ncovariance matrix:\n[[ 1.0117086   0.17839112 -0.42687826]\n [ 0.17839112  0.98871838  0.60641387]\n [-0.42687826  0.60641387  1.03022947]]\n\ncorrelation matrix:\n[[ 1.          0.17836482 -0.41812808]\n [ 0.17836482  1.          0.60084968]\n [-0.41812808  0.60084968  1.        ]]\n\n\n\n\u3044\u3044\u611f\u3058\u306b\u9006\u76f8\u95a2\u304c\u51fa\u3066\u3044\u307e\u3059\uff01 \u3084\u3063\u305f\u306d\uff01\n\n\u307e\u3068\u3081\n\u76f8\u95a2\u304c\u3042\u308b nn \u500b\u306e\u4e71\u6570\u304c\u3069\u306e\u3088\u3046\u306b\u4f5c\u308c\u308b\u304b\uff1f \u305d\u3057\u3066\u3001\u305d\u308c\u306f\u306a\u305c\u304b\uff1f \u3092\u898b\u3066\u304d\u307e\u3057\u305f\u3002\u3053\u3046\u3044\u3046\u30cd\u30bf\u3067\u306f\u5fc5\u305a\u300c\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3092\u305b\u3088\u300d\u3068\u8a00\u308f\u308c\u308b\u306e\u3067\u3059\u304c\u3001\u306a\u305c\u305d\u308c\u3067\u3046\u307e\u304f\u3044\u304f\u306e\u304b\u307e\u3067\u8a00\u53ca\u3057\u3066\u3044\u308b\u8a18\u4e8b\u306f\u3042\u307e\u308a\u306a\u3044\u3093\u3058\u3083\u306a\u3044\u3067\u3057\u3087\u3046\u304b\u3002\u8a08\u7b97\u81ea\u4f53\u3082\u3001\u9805\u304c\u591a\u304f\u3066\uff08\u66f8\u304f\u306e\u304c\uff09\u3061\u3087\u3063\u3068\u3081\u3093\u3069\u304f\u3055\u3044\u3067\u3059\u304c\u3001\u7dda\u5f62\u4ee3\u6570\u3068\u7d71\u8a08\u306e\u57fa\u790e\u7684\u306a\u90e8\u5206\u3060\u3051\u3067\u5341\u5206\u6700\u5f8c\u307e\u3067\u3044\u3051\u307e\u3059\u3002\u3084\u306f\u308a\u3001nn \u500b\u306e\u5909\u6570\u3092\u6271\u3044\u59cb\u3081\u305f\u3089\u5fc5\u305a\u7dda\u5f62\u4ee3\u6570\u304c\u9854\u3092\u51fa\u3057\u307e\u3059\u306d\u3002\n\u691c\u8a3c\u306e\u65b9\u3067\u306f\u3001\u76f8\u95a2\u884c\u5217\u3063\u307d\u304f\u898b\u3048\u3066\u3082\u5b9f\u306f\u76f8\u95a2\u884c\u5217\u3068\u306f\u547c\u3079\u306a\u3044\u3088\u3046\u306a\u3082\u306e\u3082\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\u5404\u6210\u5206\u304c \u22121-1 \u304b\u3089 11 \u306e\u9593\u3063\u3066\u3060\u3051\u3058\u3083\u30c0\u30e1\u306a\u3093\u3067\u3059\u306d\u3002\n\u3044\u308d\u3044\u308d\u624b\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\u3068\u3044\u308d\u3044\u308d\u306a\u767a\u898b\u304c\u3042\u3063\u3066\u697d\u3057\u3044\u3067\u3059\u3002\u76f8\u95a2\u306e\u3042\u308b\u4e71\u6570\u751f\u6210\u306f\u624b\u3092\u52d5\u304b\u3059\u306b\u306f\u3061\u3087\u3046\u3069\u3044\u3044\u30cd\u30bf\u3060\u3068\u601d\u3046\u306e\u3067\u3001\u307f\u306a\u3055\u3093\u3082\u305c\u3072\u7d71\u8a08\u5b66\u3092\u697d\u3057\u3093\u3067\u307f\u3066\u304f\u3060\u3055\u3044\uff01\n\n\n\n\n\u3064\u306d\u306b (\u00a0i\u00a0\u3068\u00a0j\u00a0\u306e\u76f8\u95a2)=(\u00a0j\u00a0\u3068\u00a0i\u00a0\u306e\u76f8\u95a2)( \\ i \\ \u3068 \\ j \\ \u306e\u76f8\u95a2) = ( \\ j \\ \u3068 \\ i \\ \u306e\u76f8\u95a2) \u3067\u3042\u308b\u305f\u3081\u3002\u00a0\u21a9\n\n\nXX \u306f\u6210\u5206\u304c\u7e26\u306b\u4e26\u3093\u3060\u300c\u5217\u30d9\u30af\u30c8\u30eb\u300d\u3067\u3059\u304c\u3001\u7d19\u9762\u304c\u3082\u3063\u305f\u3044\u306a\u3044\u306e\u3067\u884c\u30d9\u30af\u30c8\u30eb\u306e\u8ee2\u7f6e\u3068\u3057\u3066\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\u00a0\u21a9\n\n\n{Xi}\\{X_i\\} \u3068 {Zi}\\{Z_i\\} \u306f\u540c\u3058\u5206\u6563\u3092\u6301\u3064\u3068\u3057\u3066\u308b\u306e\u3067 a11=1a_11 = 1 \u304c\u305f\u3060\u3061\u306b\u308f\u304b\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u3053\u306f\u8a18\u53f7\u306e\u307e\u307e\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u30e2\u30fc\u30c9\u3067\u3084\u308b\u3068\u884c\u5217\u3063\u307d\u304f\u51fa\u3066\u304f\u308b\u306e\u3067\u3059\u304c\u3042\u3093\u307e\u308a\u898b\u3084\u3059\u304f\u306a\u3044\u306e\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3084\u3063\u3066\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u306a\u306e\u3067\u5b9f\u969b\u306b\u306f\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u304c\u3067\u304d\u308b\u305f\u3081\u306e\u6761\u4ef6\u306f\u3001\u300c\u5bfe\u79f0\u306e\u884c\u5217\u304c\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3053\u3068\u300d\u3067\u5341\u5206\u3067\u3059\u3002\u00a0\u21a9\n\n\n\n[\u524d\u56de\u306e\u8a18\u4e8b](http://qiita.com/horiem/items/30a8783604ae67cdd63e \"\u76f8\u95a2\u306e\u3042\u308b2\u3064\u306e\u64ec\u4f3c\u4e71\u6570\u306e\u751f\u6210\uff08Python\u30b5\u30f3\u30d7\u30eb\u3064\u304d\uff09 - Qiita\")\u3067\u306f\u76f8\u95a2\u304c\u3042\u308b $2$ \u3064\u306e\u64ec\u4f3c\u4e71\u6570\u3092\u751f\u6210\u3057\u307e\u3057\u305f\u3002\u3057\u304b\u3057\u3001\u8272\u3005\u3084\u3063\u3066\u3044\u304f\u3046\u3061\u306b\u3084\u3063\u3071\u308a\u76f8\u95a2\u304c\u3042\u308b\u4e71\u6570\u304c $n$ \u500b\u307b\u3057\u304f\u306a\u3063\u305f\u306e\u3067\u3001\u305d\u306e\u751f\u6210\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3044\u304d\u306a\u308a $n$ \u500b\u306e\u4e71\u6570\u3092\u4f5c\u308b\u8a71\u304b\u3089\u5165\u308b\u306e\u3067\u3001\u524d\u56de\u306e\u8a18\u4e8b\u3092\u307e\u305a\u8aad\u3093\u3067\u3044\u305f\u3060\u3044\u305f\u307b\u3046\u304c\u30b9\u30e0\u30fc\u30ba\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u8ffd\u8a18\uff1a\u5358\u306b\u76f8\u95a2\u304c\u3042\u308b\u4e71\u6570\u3092\u4f5c\u308a\u305f\u3044\u3001\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u306b\u306f\u8208\u5473\u306a\u3044\u3068\u3044\u3046\u65b9\u306f `numpy.random.multivariate_normal` \u3092\u4f7f\u3048\u3070\u5927\u4e08\u592b\u3067\u3059\u3002\n\n# \u6982\u8981\n$n$ \u500b\u306e\u30c7\u30fc\u30bf\u7cfb\u5217\u304c\u3042\u3063\u305f\u3068\u304d\u3001 $i$ \u756a\u76ee\u3068 $j$ \u756a\u76ee\u306e\u76f8\u95a2\u4fc2\u6570\u3092 $ij$ \u6210\u5206\u306b\u304a\u3044\u305f\u5bfe\u79f0\u884c\u5217\u3092[^2]\u3001 **\u76f8\u95a2\u884c\u5217** \u3068\u3044\u3044\u307e\u3059\u3002\u3053\u306e\u76f8\u95a2\u884c\u5217\u3092\u30a4\u30f3\u30d7\u30c3\u30c8\u3068\u3057\u3066\u3001\u4e0e\u3048\u3089\u308c\u305f\u76f8\u95a2\u3092\u6e80\u305f\u3059\u3088\u3046\u306a $n$ \u500b\u306e\u4e71\u6570\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u3092\u8003\u3048\u307e\u3059\u3002\n\n\u5e73\u5747\u304c\u30bc\u30ed\u3067\u5206\u6563\u304c\u7b49\u3057\u3044\u72ec\u7acb\u306a\u4e71\u6570\u3092 $n$ \u500b\u7528\u610f\u3057\u3066\u3001\u305d\u308c\u3092\u30d9\u30af\u30c8\u30eb\u3067\u307e\u3068\u3081\u3066 $X = (X_1 \\ \\ X_2 \\ \\ \\dots \\ \\ X_n)^T$ \u3068\u8868\u73fe\u3057\u307e\u3059[^1]\u3002\u3053\u306e\u3068\u304d\u3001$X_1$ \u3084 $X_2$ \u306a\u3069\u3068\u540c\u3058\u5206\u6563\u3092\u6301\u3063\u3066\u3044\u3066\u76f8\u95a2\u884c\u5217 $R$ \u3067\u76f8\u95a2\u3057\u3042\u3046 $n$ \u500b\u306e\u4e71\u6570 $Z = (Z_1 \\ \\ Z_2 \\ \\ \\dots \\ \\ Z_n)^T$ \u306f\n\n```math\nZ = L \\ X\n```\n\n\u3067\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\n\u305f\u3060\u3057\u3001\u76f8\u95a2\u884c\u5217\u306f $Z_i$ \u3068 $Z_j$ \u306e\u76f8\u95a2\u4fc2\u6570\u3092 $\\rho_{ij}$ \u3068\u3057\u3066\n\n```math\nR = \\left( \\begin{array}{cccc}\n\\rho_{11} & \\rho_{12} & \\dots & \\rho_{1n}\n\\\\\n\\rho_{21} & & &\n\\\\\n\\vdots & & \\ddots & \\vdots\n\\\\\n\\rho_{n1} & & \\dots & \\rho_{nn}\n\\end{array} \\right)\n```\n\n\u3067\u3001$L$ \u306f $R$ \u306e\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u304b\u3089\u5f97\u3089\u308c\u305f\u4e0b\u4e09\u89d2\u884c\u5217\uff08\u5bfe\u89d2\u6210\u5206\u3088\u308a\u53f3\u4e0a\u304c\u3059\u3079\u3066\u30bc\u30ed\u306e\u884c\u5217\uff09\u3067\u3059\u3002\n\n\u2026\u2026\u306f\u3044\u3001\u8033\u6163\u308c\u306a\u3044\u8a00\u8449\u304c\u3044\u3063\u3071\u3044\u51fa\u3066\u304d\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4e00\u3064\u3072\u3068\u3064\u89e3\u8aac\u3057\u3066\u3044\u304f\u306e\u3067\u5b89\u5fc3\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u7b11\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001\n\n* \u7406\u8ad6\uff1a\u306a\u305c\u3053\u308c\u3067\u76f8\u95a2\u304c\u3042\u308b $n$ \u500b\u306e\u4e71\u6570\u304c\u4f5c\u308c\u308b\u306e\u304b\n* \u691c\u8a3c\uff1aPython \u3067\u5b9f\u969b\u306b\u3084\u3063\u3066\u307f\u308b\n\n\u306b\u3064\u3044\u3066\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u304c\u3069\u3046\u3044\u3046\u3082\u306e\u304b\u306b\u3064\u3044\u3066\u3082\u89e6\u308c\u307e\u3059\u304c\u3001\u5b9f\u969b\u306b\u3069\u3046\u3084\u3063\u3066\u5206\u89e3\u3092\u5b9f\u73fe\u3059\u308b\u304b\u306f\u8aac\u660e\u3057\u307e\u305b\u3093\u306e\u3067\u3042\u3057\u304b\u3089\u305a\u3002\n\n# \u7406\u8ad6\n\u7406\u8ad6\u306e\u5927\u307e\u304b\u306a\u6d41\u308c\u3068\u3057\u3066\u306f\u3001\n\n1. $\\\\{Z_i\\\\} = Z_1, Z_2, \\dots, Z_n$ \u3092 $\\\\{X_i\\\\}$ \u3092\u4f7f\u3063\u3066\u8868\u73fe\u3059\u308b\u65b9\u6cd5\u3092\u8003\u3048\u308b\n1. \u5f97\u3089\u308c\u305f\u8868\u73fe\u3092\u3001\u76f8\u95a2\u4fc2\u6570\u3068\u95a2\u9023\u4ed8\u3051\u308b\n1. \u8868\u73fe\u3092\u78ba\u5b9a\u3059\u308b\n\n\u3068\u3044\u3046\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\u3067\u306f\u3044\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n## Z \u3092\u4f5c\u308b\u30a2\u30a4\u30c7\u30a3\u30a2\n\n\u72ec\u7acb\u306a\u4e71\u6570 $\\\\{X_i\\\\}$ \u306b\u3064\u3044\u3066\u3001\u5e73\u5747\u306f\u305d\u308c\u305e\u308c\u30bc\u30ed\u3001\u5206\u6563\u306f\u540c\u3058\u5024\u3067 $\\sigma^2$ \u3068\u3057\u307e\u3059\u3002\u3053\u308c\u3089\u306f\u72ec\u7acb\u306a\u306e\u3067\u3001 \u5171\u5206\u6563 $\\mathrm{Cov}[X_i, X_j]$ \u3084\u76f8\u95a2\u4fc2\u6570 $\\mathrm{Corr}[X_i, X_j]$ \u306f\u30bc\u30ed\u3067\u3059\u3002\n\n\u3053\u306e $\\\\{X_i\\\\}$ \u3092\u4f7f\u3063\u3066 $\\\\{Z_i\\\\}$ \u3092\u4f5c\u3063\u3066\u3044\u304d\u305f\u3044\u308f\u3051\u3067\u3059\u304c\u3001\u3068\u308a\u3042\u3048\u305a\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```math\n\\begin{align}\nZ_1 &= a_{11} X_1\n\\\\\nZ_2 &= a_{21} X_1 + a_{22} X_2\n\\\\\nZ_3 &= a_{31} X_1 + a_{32} X_2 + a_{33} X_3\n\\\\\n&\\vdots\n\\\\\nZ_n &= a_{n1} X_1 + a_{n2} X_2 + \\dots + a_{nn} X_n\n\\end{align}\n```\n\n\u3053\u308c\u306f\u307e\u305a\u57fa\u6e96\u3068\u306a\u308b $Z_1$ \u3092\u4f5c\u308a\u3001\u305d\u308c\u306b\u5bfe\u3057\u3066\u6c7a\u3081\u3089\u308c\u305f\u76f8\u95a2\u3092\u3082\u3064 $Z_2$ \u3092\u4f5c\u308a\u3001\u4eca\u5ea6\u306f $Z_1$ \u3068 $Z_2$ \u3092\u57fa\u6e96\u3068\u3057\u3066\u305d\u308c\u305e\u308c\u306b\u5bfe\u3057\u3066\u6c7a\u3081\u3089\u308c\u305f\u76f8\u95a2\u3092\u6301\u3064 $Z_3$ \u3092\u4f5c\u308a\u2026\u2026\u3068\u3044\u3046\u3053\u3068\u3092\u7e70\u308a\u8fd4\u3057\u3066 $Z_n$ \u307e\u3067\u3044\u304f\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\u3053\u306e\u90e8\u5206\u3092\u7406\u89e3\u3059\u308b\u3053\u3068\u306f\u975e\u5e38\u306b\u91cd\u8981\u3067\u3059\u3002\u306a\u3093\u306a\u3089\u7406\u8ad6\u30d1\u30fc\u30c8\u306e\u534a\u5206\u4ee5\u4e0a\u3092\u5360\u3081\u308b\u3068\u8a00\u3063\u3066\u3082\u904e\u8a00\u3067\u306f\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3061\u3087\u3063\u3068\u30a4\u30e1\u30fc\u30b8\u3092\u3064\u304b\u307f\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u306b\u3001$n = 3$ \u3068\u3057\u3066\u8003\u3048\u3066\u307f\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u30a4\u30e1\u30fc\u30b8\u304c\u5b8c\u74a7\u3060\u3001\u3068\u3044\u3046\u65b9\u306f\u3053\u306e\u90e8\u5206\u306f\u8aad\u307f\u98db\u3070\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u76f8\u95a2\u3068\u306f\u4f55\u304b\u3075\u305f\u3064\u306e\u3082\u306e\u306e\u95a2\u4fc2\u3067\u3059\u3002\u95a2\u4fc2\u3092\u8003\u3048\u308b\u305f\u3081\u306b\u306f\u57fa\u6e96\u304c\u306a\u3044\u3068\u59cb\u307e\u3089\u306a\u3044\u306e\u3067\u3001\n\n```math\nZ_1 = a_{11} X_1\n```\n\n\u3053\u306e\u90e8\u5206\u306f\u554f\u984c\u306a\u3044\u3068\u601d\u3044\u307e\u3059[^3]\u3002\u6b21\u306b\u3001 $Z_1$ \u3068\u4ed6\u306e\u4e71\u6570\uff08$X_2$ \u3092\u9078\u3073\u307e\u3057\u3087\u3046\uff09\u3092\u4f7f\u3063\u3066\u3001\n\n```math\nZ_2 = c Z_1 + a_{22} X_2\n```\n\n\u3068\u3057\u3001\u4fc2\u6570\u3092\u9069\u5207\u306b\u9078\u3076\u3053\u3068\u3067 $Z_1$ \u3068 $\\rho_{12}$ \u3067\u76f8\u95a2\u3059\u308b $Z_2$ \u304c\u4f5c\u308c\u307e\u3059\u3002\u3053\u308c\u3082\u524d\u56de\u306e\u8a18\u4e8b\u3092\u898b\u3066\u3044\u305f\u3060\u3051\u308c\u3070\u554f\u984c\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u3053\u306e\u5f0f\u306e\u53f3\u8fba\u3092 $\\\\{X_i\\\\}$ \u3060\u3051\u306b\u3057\u3066\n\n```math\n\\begin{align}\nZ_2 &= c_1 \\cdot a_{11} X_1 + a_{22} X_2 & (\\because Z_1 \u306e\u5f0f)\n\\\\\n&= a_{21} X_1 + a_{22} X_2 & (\\because a_{21} = c_1 \\cdot a_{11} \u3068\u304a\u3044\u305f)\n\\end{align}\n```\n\n\u3053\u308c\u30672\u5217\u76ee\u306e\u5f0f\u304c\u3067\u3066\u304d\u307e\u3057\u305f\u306d\u3002\u6700\u5f8c\u306b $Z_3$ \u3067\u3059\u304c\u3001\u3059\u3067\u306b\u4e71\u6570\u304c2\u3064\u3042\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3044\u308d\u3044\u308d\u306a\u5834\u5408\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\n* \u72b6\u6cc11. Z_2 \u3088\u308a Z_1 \u3068\u3088\u304f\u76f8\u95a2\u3059\u308b\n* \u72b6\u6cc12. Z_1 \u3088\u308a Z_2 \u3068\u3088\u304f\u76f8\u95a2\u3059\u308b\n* \u72b6\u6cc13. \u3069\u3061\u3089\u3068\u3082\u76f8\u95a2\u3057\u306a\u3044\n* \u72b6\u6cc14. \u2026\u2026\n\n\u3053\u308c\u3089\u306e\u72b6\u6cc1\u3092\u5e45\u5e83\u304f\u30ab\u30d0\u30fc\u3059\u308b\u305f\u3081\u306b\u306f\u3001\n\n```math\nZ_3 = c_1 Z_1 + c_2 Z_2 + a_{31} X_3\n```\n\n\u3068\u3001$Z_1$\u3001$Z_2$ \u3068\u66f4\u306b\u65b0\u305f\u306a\u4e71\u6570 $X_3$ \u306e\u91cd\u306d\u5408\u308f\u305b\u304c\u5fc5\u8981\u3068\u306a\u308a\u305d\u3046\u3067\u3059\u3088\u306d\u3002\u5b9f\u969b\u3001 $c_1$ \u3092\u5927\u304d\u304f\u53d6\u308c\u3070 \u72b6\u6cc11\u3092\u3001$c_2$ \u3092\u5927\u304d\u304f\u3068\u308c\u3070 \u72b6\u6cc12\u3092\u3001$c_1 = c_2 = 0$ \u3068\u3057\u3066 $a_{31}$ \u3060\u3051\u3092\u4f55\u304b\u306e\u6570\u5b57\u306b\u3059\u308c\u3070\u72b6\u6cc13\u3092\u8868\u305b\u305d\u3046\u3067\u3059\u3002\u3053\u306e\u5f0f\u306e\u53f3\u8fba\u3092\u307e\u305f $\\\\{X_i\\\\}$ \u306e\u307f\u3067\u8868\u3057\u3001\u4fc2\u6570\u3092\u9069\u5f53\u306b\u5b9a\u7fa9\u3057\u76f4\u3059\u3053\u3068\u306b\u3088\u3063\u30663\u5217\u76ee\u306e\u5f0f\u3082\u5c0e\u3051\u307e\u3059\u3002\n\n\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u3001\u3059\u3067\u306b\u4f5c\u3063\u305f $Z_1, Z_2, \\dots, Z_i$ \u3068\u65b0\u305f\u306a\u4e71\u6570 $X_{i + 1}$ \u3092\u91cd\u306d\u5408\u308f\u305b\u308b\u3053\u3068\u306b\u3088\u3063\u3066 $Z_{i + 1}$ \u304c\u4f5c\u308c\u305d\u3046\u306a\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\n## \u76f8\u95a2\u4fc2\u6570\u3068\u95a2\u9023\u4ed8\u3051\u308b\n\u3055\u3066\u3001\u5148\u7a0b\u306e $\\\\{Z_i\\\\}$ \u3092\u6c42\u3081\u308b\u5f0f\u3092\u884c\u5217\u3068\u3057\u3066\u8868\u73fe\u3057\u3066\u3084\u308b\u3068\u3001\n\n```math\nZ = \n\\left(\n \\begin{array}{ccccc}\n    a_{11} & 0 & 0 & \\dots & 0\n    \\\\\n    a_{21} & a_{22} & 0 & \\dots & 0\n    \\\\\n    a_{31} & a_{32} & a_{33} & & \\vdots\n    \\\\\n    \\vdots & \\vdots & & \\ddots & 0\n     \\\\\n    a_{n1} & a_{n2} & & \\dots & a_{nn}\n \\end{array}\n\\right)X\n```\n\n\u3068\u66f8\u3051\u307e\u3059\u3002\u3053\u308c\u304c\u307e\u3055\u3057\u304f\u5148\u7a0b\u3061\u3089\u3063\u3068\u51fa\u3066\u304d\u305f\u300c\u4e0b\u4e09\u89d2\u884c\u5217\u300d\u3067\u3001\u5bfe\u89d2\u6210\u5206\u3068\u305d\u306e\u5de6\u4e0b\u306b\u306f\u5024\u304c\u5165\u3063\u3066\u304a\u308a\u3001\u53f3\u4e0a\u306f\u3059\u3079\u3066\u30bc\u30ed\u3067\u57cb\u3081\u5c3d\u304f\u3055\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u884c\u5217\u3067\u3059\u306d\u3002\n\n\u3053\u306e\u884c\u5217\u304c $Z = L \\ X$ \u306e\u4e2d\u306b\u51fa\u3066\u304d\u305f $L$ \u306b\u76f8\u5f53\u3059\u308b\u308f\u3051\u3067\u3059\u3002\u305d\u3046\u3068\u308f\u304b\u308c\u3070\u3001\u3042\u3068\u306f\u4fc2\u6570 $\\\\{a_{ij}\\\\}$ \u3092\u3001\u4e0e\u3048\u3089\u308c\u305f\u76f8\u95a2\u3092\u6e80\u305f\u3059\u3088\u3046\u306b\u6c7a\u3081\u3066\u3042\u3052\u308b\u3060\u3051\u3067\u3059\u3002\u3064\u307e\u308a\u3001$\\\\{a_{ij}\\\\}$ \u3068 $\\\\{\\rho_{ij}\\\\}$ \u306e\u95a2\u4fc2\u304c\u308f\u304b\u308c\u3070\u3044\u3044\u308f\u3051\u3067\u3059\u3002\n\n$Z_i$ \u3068 $Z_j$ \u306e\u9593\u306e\u76f8\u95a2 $\\rho_{ij}$ \u304c\u4e0e\u3048\u3089\u308c\u305f\u3068\u304d\u3001\u6e80\u305f\u3059\u3079\u304d\u5f0f\u306f\n\n```math\n\\mathrm{Corr}[Z_i, Z_j] = \\rho_{ij}\n```\n\n\u3067\u3059\u306d\u3002\u307e\u3093\u307e\u3067\u3059\u304c\u3002\n\n\u3053\u306e\u307e\u307e\u3060\u3068\u4f55\u3082\u8a00\u3048\u306a\u3044\u306e\u3067\u3001\u5de6\u8fba\u3092\u5909\u5f62\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\n```math\nLHS = \\frac{\\mathrm{Cov}[Z_i, Z_j]}{\\sqrt{\\mathrm{Var}[Z_i]} \\sqrt{\\mathrm{Var}[Z_j]}} \\ (\\because \\mathrm{Corr} \u306e\u5b9a\u7fa9)\n```\n\n\u3053\u3053\u3067\u3001\u7d50\u679c\u3092\u5148\u53d6\u308a\u3057\u3066 $\\mathrm{Var}[Z_k] = \\sigma^2 \\ (\\mathrm{for \\ all} \\ k)$ \u3092\u8a8d\u3081\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002$\\\\{Z_k\\\\}$ \u306e\u5206\u6563\u306f $\\\\{X_k\\\\}$ \u306e\u5206\u6563\u3068\u540c\u3058\u306b\u306a\u308a\u307e\u3059\u3088\u3068\u3044\u3046\u3053\u3068\u3092\u4eee\u5b9a\u3059\u308b\u306e\u3067\u3059\uff08\u3067\u306a\u3044\u3068\u8a08\u7b97\u304c\u3084\u3084\u3053\u3057\u304f\u306a\u308b\u306e\u3067\uff09\u3002\u3053\u308c\u306b\u3064\u3044\u3066\u306f\u3001\u3042\u3068\u3067\u6570\u5024\u7684\u306b\u691c\u8a3c\u3057\u307e\u3059\u3002\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u4e0a\u306e\u5f0f\u306f\n\n```math\n\\frac{\\mathrm{Cov}[Z_i, Z_j]}{\\sigma^2}\n```\n\n\u3068\u306a\u308a\u307e\u3059\u3002\u6b21\u306f\u3001\u5206\u5b50\u3092 $\\\\{X_i\\\\}$ \u3067\u5c55\u958b\u3057\u3066\u3044\u304d\u307e\u3059\u3002$i \\geq j$ \u3068\u3057\u3066\u3001\n\n```math\n\\begin{align}\n\\mathrm{Cov}[Z_i, Z_j] &= \\mathrm{Cov}[a_{i1} X_1 + a_{i2} X_2 + \\dots + a_{ii} X_i, \\ \na_{j1} X_1 + a_{j2} X_2 + \\dots + a_{jj} X_j]\n\\end{align}\n```\n\n\u3067\u3059\u304c\u3001$\\mathrm{Cov}$ \u306b\u306f\n\n```math\n\\mathrm{Cov}[a A + b B, c C + d D] = ac \\mathrm{Cov}[A, C] + ad \\mathrm{Cov}[A, D] + bc \\mathrm{Cov}[B, C] + bd \\mathrm{Cov}[B, D]\n```\n\n\u3068\u3044\u3046\u6027\u8cea\u304c\u3042\u308b\u306e\u3067\uff08\u5c0f\u6587\u5b57\u306f\u5b9a\u6570\u3067\u5927\u6587\u5b57\u304c\u4e71\u6570\uff09\u3001\u5148\u7a0b\u306e\u5f0f\u3082\u540c\u3058\u3088\u3046\u306b\u5206\u89e3\u3067\u304d\u307e\u3059\u3002\u3055\u3089\u306b\u3001\u4eca\u306e\u5834\u5408 $\\mathrm{Cov}[X_k, X_k] = \\sigma^2$ \u3001$\\mathrm{Cov}[X_k, X_l] = 0 \\ (k \\neq l)$ \u306a\u306e\u3067\u3001\n\n```math\n\\begin{align}\n\\mathrm{Cov}[&a_{i1} X_1 + a_{i2} X_2 + \\dots + a_{ii} X_i, \\ \na_{j1} X_1 + a_{j2} X_2 + \\dots + a_{jj} X_j]\n\\\\\n&= a_{i1} a_{j1} \\mathrm{Cov}[X_1, X_1] + a_{i2} a_{j2} \\mathrm{Cov}[X_2, X_2] + \\dots + a_{ij} a_{jj} \\mathrm{Cov}[X_j, X_j] + a_{i(j+1)} \\cdot 0  \\cdot \\mathrm{Cov}[X_{j+1}, X_{j+1}] + \\dots\n\\\\\n&= a_{i1} a_{j1} \\sigma^2 + a_{i2} a_{j2} \\sigma^2 + \\dots + a_{ij} a_{jj} \\sigma^2\n\\\\\n&= (a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}) \\ \\sigma^2\n\\end{align}\n```\n\n\u3068\u306a\u308a\u307e\u3059\u3002$a_{j(j+1)} = a_{j(j+2)} = \\dots = a_{ji} = 0$ \u306a\u306e\u3067\u3001\u9805\u306f $j$ \u756a\u76ee\u3067\u6253\u3061\u5207\u308a\u306b\u306a\u308b\u306e\u304c\u30df\u30bd\u3067\u3059\u306d\u3002\n\n\u6700\u7d42\u7684\u306b\u3001\u76f8\u95a2\u4fc2\u6570\u306f\n\n```math\n\\rho_{ij} = \\mathrm{Corr}[Z_i, Z_j] = a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}\n```\n\n\u3068\u3001\u3053\u3093\u306a\u5f62\u306b\u306a\u308a\u307e\u3059\u3002\n\n$i \\geq j$ \u3092\u4eee\u5b9a\u3057\u3066\u8a08\u7b97\u3057\u3066\u304d\u305f\u306e\u3067\u76f8\u95a2\u884c\u5217\u306e\u4e0b\u4e09\u89d2\u306e\u90e8\u5206\u3092\u8a08\u7b97\u3057\u305f\u3053\u3068\u306b\u306a\u308b\u306e\u3067\u3059\u304c\u3001\u76f8\u95a2\u884c\u5217\u306f\u5fc5\u305a\u5bfe\u79f0\u306a\u306e\u3067\u3001\n\n```math\n\\rho_{ji} = a_{i1} a_{j1} + a_{i2} a_{j2} + \\dots + a_{ij} a_{jj}\n```\n\n\u3082\u6210\u308a\u7acb\u3061\u307e\u3059\u3002\u5de6\u8fba\u306e\u6dfb\u5b57\u304c\u3053\u3063\u305d\u308a\u5165\u308c\u66ff\u308f\u3063\u3066\u307e\u3059\u3002\n\n\n## \u884c\u5217\u3092\u300c\u89e3\u304f\u300d\n\u3053\u308c\u307e\u3067\u306e\u8b70\u8ad6\u3092\u884c\u5217\u306e\u5f62\u306b\u307e\u3068\u3081\u308b\u3068\u3001\u76f8\u95a2\u884c\u5217 $R$ \u306f\u3001$\\\\{a_ij\\\\}$ \u3092\u4f7f\u3063\u3066\n\n```math\nR = \\left( \\begin{array}{cccc}\na_{11} a_{11} & a_{21} a_{11} & \\cdots & a_{n1} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22} &\n\\\\\n\\\\\n\\vdots & & \\ddots & \\vdots\n\\\\\na_{n1} a_{11} & a_{n1} a_{21} + a_{n2} a_{22} & \\dots &\n\\end{array} \\right)\n```\n\n\u3068\u3001\u3053\u3093\u306a\u3075\u3046\u306b\u8868\u305b\u307e\u3059\u3002$R$ \u306b\u306f $\\\\{\\rho_{ij}\\\\}$ \u3092\u4f7f\u3063\u305f\u8868\u73fe\u3068 $\\\\{a_{ij}\\\\}$ \u3092\u4f7f\u3063\u305f\u8868\u73fe\u306e2\u901a\u308a\u304c\u3042\u308b\u306e\u3067\u3001\u3053\u308c\u3067\u3053\u306e\u3075\u305f\u3064\u3092\u5bfe\u5fdc\u3065\u3051\u3089\u308c\u305f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u3042\u3068\u306f\u3001\u3053\u308c\u3092 $\\\\{a_{ij}\\\\}$ \u306b\u3064\u3044\u3066\u89e3\u3051\u3070\u3044\u3044\u308f\u3051\u3067\u3059\u306d\u3002\n\n\u78ba\u8a8d\u306e\u305f\u3081\u3001$n = 2$ \u3067\u8a08\u7b97\u3057\u3066\u307f\u307e\u3059\u3002\u76f8\u95a2\u884c\u5217\u3068\u4fc2\u6570\u306e\u5bfe\u5fdc\u306f\n\n```math\n\\left( \\begin{array}{cc}\na_{11} a_{11} & a_{21} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22}\n\\end{array} \\right)\n=\n\\left( \\begin{array}{cc}\n\\rho_{11} & \\rho_{12}\n\\\\\n\\rho_{21} & \\rho_{22}\n\\end{array} \\right)\n```\n\n\u3067\u3059\u3002\u76f8\u95a2\u884c\u5217\u306a\u306e\u3067\u3001$\\rho_{11} = \\rho_{22} = 1$ \u3060\u3057\u3001$\\rho_{21} = \\rho_{12}$ \u3067\u3059\u306d\u3002\n\n\u3053\u308c\u3092\u8e0f\u307e\u3048\u3066\u610f\u5473\u306e\u3042\u308b\u5f0f\u3092\u629c\u304d\u51fa\u3059\u3068\u3001\n\n```math\n\\begin{align}\na_{11}^2 &= 1\n\\\\\na_{21} a_{11} &= \\rho_{21}\n\\\\\na_{21}^2 + a_{22}^2 &= 1\n\\end{align}\n```\n\n\u3068\u3001\u3053\u306e3\u672c\u3067\u3059\u3002\u3053\u3053\u3067\u3001$a_{kk} > 0 \\ (\\mathrm{for \\ all} \\ k)$ \u3068\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\u3053\u308c\u3092\u89e3\u304f\u3068\u3001\n\n```math\n\\begin{align}\na_{11} &= 1\n\\\\\na_{21} &= \\rho_{21}\n\\\\\na_{22} &= \\sqrt{1 - \\rho_{21}^2}\n\\end{align}\n```\n\n\u3068\u306a\u308a\u3001\u524d\u56de\u6c42\u3081\u305f\u7d50\u679c\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u306d\u3002\u3088\u3055\u305d\u3046\u3067\u3059\u3002\n\n\u3067\u306f\u3082\u3063\u3068\u4e00\u822c\u7684\u306b $n$ \u6b21\u5143\u306e\u884c\u5217\u306e\u3068\u304d\u306f\u3069\u3046\u3068\u3044\u305f\u3089\u3044\u3044\u3067\u3057\u3087\u3046\u304b\uff1f \u3082\u3046\u4e00\u5ea6\u884c\u5217\u3092\u3088\u304f\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u3082\u3046\u3061\u3087\u3063\u3068\u66f8\u304f\u6210\u5206\u3092\u5897\u3084\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n```math\nR = \\left( \\begin{array}{ccccc}\na_{11} a_{11} & a_{21} a_{11} & a_{31} a_{11} & \\cdots & a_{n1} a_{11}\n\\\\\na_{21} a_{11} & a_{21} a_{21} + a_{22} a_{22} &\na_{31} a_{21} + a_{32} a_{22} &\n\\\\\na_{31} a_{11} & a_{31} a_{21} + a_{32} a_{22} & a_{31} a_{31} + a_{32} a_{32} + a_{33} a_{33} \n\\\\\n\\vdots & \\vdots & & \\ddots & \\vdots\n\\\\\na_{n1} a_{11} & a_{n1} a_{21} + a_{n2} a_{22} & \\dots &\n\\end{array} \\right)\n```\n\n\u7d50\u69cb\u30ad\u30ec\u30a4\u306a\u5f62\u3092\u3057\u3066\u3044\u307e\u3059\u3088\u306d\u3002\u5b9f\u306f\u3053\u308c\u3001\n\n```math\nR = \\left(\n \\begin{array}{ccccc}\n    a_{11} & 0 & 0 & \\dots & 0\n    \\\\\n    a_{21} & a_{22} & 0 & \\dots & 0\n    \\\\\n    a_{31} & a_{32} & a_{33} & & \\vdots\n    \\\\\n    \\vdots & \\vdots & & \\ddots & 0\n     \\\\\n    a_{n1} & a_{n2} & & \\dots & a_{nn}\n \\end{array}\n\\right)\n\\left(\n \\begin{array}{ccccc}\n    a_{11} & a_{21} & a_{31}  & \\dots & a_{n1}\n    \\\\\n    0 & a_{22} & a_{32} & \\dots & a_{n2}\n    \\\\\n    0 & 0 & a_{33} & & \n    \\\\\n    \\vdots & \\vdots & & \\ddots & \\vdots\n     \\\\\n    0 & 0 & & \\dots & a_{nn}\n \\end{array}\n\\right)\n```\n\n\u3068\u3044\u3046\u5f62\u306b\u5206\u89e3\u3067\u304d\u308b\u3068\u8a00\u3063\u305f\u3089\u9a5a\u304f\u3067\u3057\u3087\u3046\u304b\uff1f \u5b9f\u969b\u3053\u308c\u306f\u672c\u5f53\u3067\u3001\u3053\u306e\u3042\u305f\u308a\u304c\u6570\u5b66\u306e\u7f8e\u3057\u3044\u3068\u3053\u308d\u3067\u3059\u3088\u306d\u3002\n\n$n = 3$ \u3068\u3057\u3066\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u624b\u8a08\u7b97\u306f\u3057\u3093\u3069\u3044\u306e\u3067\u3001\u3053\u3053\u306f [SymPy](http://www.sympy.org/en/index.html \"SymPy\") \u3092\u4f7f\u3044\u307e\u3059\u3002SymPy \u306f\u3001Mathematica \u306e\u3088\u3046\u306a\u6570\u5f0f\u306e\u8a08\u7b97\u3092\u3057\u3066\u304f\u308c\u308b Python \u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\n\n\u8a66\u3057\u306b\u5206\u89e3\u3055\u308c\u305f\u884c\u5217\u3092\u639b\u3051\u3066\u3082\u3068\u306b\u623b\u308b\u304b\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```python\nimport sympy\n\n# Define symbols\na_11, a_22, a_33 = sympy.symbols('a_11 a_22 a_33', real=True, positive=True)\na_21, a_31, a_32 = sympy.symbols('a_21 a_31 a_32', real=True)\n\n# Define lower and upper triangular matrices\nL = sympy.Matrix([\n    [a_11, 0, 0], \n    [a_21, a_22, 0], \n    [a_31, a_32, a_33]\n    ])\nU = L.transpose()\n\n# Calculate product of triangular matrices\nR = L * U\nprint(\"R = {}\".format(R))\n```\n\n\u51fa\u529b\u306f\u3053\u3061\u3089\u3002\u898b\u3084\u3059\u3044\u3088\u3046\u306b\u6574\u5f62\u3057\u3066\u307e\u3059[^4]\u3002\n\n```python:\u51fa\u529b\nR = Matrix([\n[a_11**2,     a_11 * a_21,               a_11 * a_31                ],\n[a_11 * a_21, a_21**2 + a_22**2,         a_21 * a_31 + a_22 * a_32  ],\n[a_11 * a_31, a_21 * a_31 + a_22 * a_32, a_31**2 + a_32**2 + a_33**2]\n])\n```\n\n\u306a\u3093\u3068\uff01 \u304d\u3061\u3093\u3068\u671f\u5f85\u3055\u308c\u305f\u7d50\u679c\u304c\u51fa\u3066\u304d\u3066\u3044\u307e\u3059\u306d\uff01\n\n\u9006\u306b\u8a00\u3046\u3068\u3001\u300c\u3042\u308b\u884c\u5217\u3092\u4e0b\u4e09\u89d2\u884c\u5217\u3068\u305d\u306e\u8ee2\u7f6e\uff08\u4e0a\u4e09\u89d2\u884c\u5217\uff09\u306e\u7a4d\u306b\u5206\u89e3\u3059\u308b\u300d\u3068\u3044\u3046\u64cd\u4f5c\u3053\u305d\u304c\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u306a\u306e\u3067\u3059\u3002\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u3053\u308c\u3082\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```python\nimport sympy\n\n# Define symbols\na_11, a_22, a_33 = sympy.symbols('a_11 a_22 a_33', real=True, positive=True)\na_21, a_31, a_32 = sympy.symbols('a_21 a_31 a_32', real=True)\n\n# Define correlation matrix\nR = sympy.Matrix([\n    [a_11**2,     a_11 * a_21,               a_11 * a_31                ],\n    [a_11 * a_21, a_21**2 + a_22**2,         a_21 * a_31 + a_22 * a_32  ],\n    [a_11 * a_31, a_21 * a_31 + a_22 * a_32, a_31**2 + a_32**2 + a_33**2]\n    ])\n\n# Perform cholesky decomposition\nL = R.cholesky()\nprint(\"L = {}\".format(L))\n```\n\n\u51fa\u529b\u3002\n\n```python:\u51fa\u529b\nL = Matrix([\n[a_11, 0,    0   ], \n[a_21, a_22, 0   ], \n[a_31, a_32, a_33]\n])\n```\n\n\u3046\u304a\u304a\u3001\u304d\u3061\u3093\u3068\u306a\u3063\u3066\u3044\u308b\uff01 \u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3067\u30ad\u30ec\u30a4\u306b\u4fc2\u6570\u304c\u53d6\u308a\u51fa\u305b\u3066\u3044\u307e\u3059\u306d\uff01\n\n\u3053\u308c\u3067\u3001\u76f8\u95a2\u4fc2\u6570 $R$ \u3092\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3057\u305f\u3082\u306e\u304c\u3001\u76f8\u95a2\u306e\u3042\u308b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u304f\u308c\u308b\u884c\u5217\u3067\u3042\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\uff01\n\n## \u7406\u8ad6\u306e\u307e\u3068\u3081\n\u9577\u304f\u306a\u3063\u3066\u304d\u305f\u306e\u3067\u3001\u3053\u3053\u3067\u4e00\u65e6\u307e\u3068\u3081\u307e\u3059\u3002\n\n\u76f8\u95a2\u306e\u3042\u308b $n$ \u500b\u306e\u4e71\u6570\u306e\u4f5c\u308a\u65b9\uff1a\n\n1. \u76f8\u95a2\u884c\u5217 $R$ \u3092\u7528\u610f\u3059\u308b\u3002\n2. $R$ \u3092\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3057\u3066\u4e0b\u4e09\u89d2\u884c\u5217 $L$ \u3092\u6c42\u3081\u308b\u3002\n3. $L$ \u3092\u76f8\u95a2\u304c\u306a\u3044\u4e71\u6570\u306e\u5217\u30d9\u30af\u30c8\u30eb $X$ \u306b\u5de6\u304b\u3089\u639b\u3051\u308c\u3070\u3067\u304d\u3042\u304c\u308a\uff01\n\n\u6982\u8981\u3068\u8a00\u3063\u3066\u308b\u3053\u3068\u304c\u307e\u3063\u305f\u304f\u5909\u308f\u3063\u3066\u306a\u3044\u3067\u3059\u304c\u3001\u3060\u3044\u3076\u30a4\u30e1\u30fc\u30b8\u306f\u3064\u304b\u3081\u305f\u306f\u305a\u3067\u3059\u3002\n\n\u7e70\u308a\u8fd4\u3057\u307e\u3059\u304c\u3001\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3092\u3069\u306e\u3088\u3046\u306b\u8a08\u7b97\u3059\u308b\u304b\u3001\u3068\u3044\u3046\u3053\u3068\u306f\u3053\u3053\u3067\u306f\u89e6\u308c\u307e\u305b\u3093\u3002\u305f\u3060\u5358\u306b\u3001\u884c\u5217\u3092\u4e09\u89d2\u884c\u5217\u306b\u5206\u89e3\u3059\u308b\u30d6\u30e9\u30c3\u30af\u30dc\u30c3\u30af\u30b9\u3068\u3057\u3066\u6271\u3044\u307e\u3059\u3002\u8a08\u7b97\u6cd5\u306b\u3064\u3044\u3066\u306f\u8abf\u3079\u308c\u3070\u3044\u308d\u3044\u308d\u3068\u51fa\u3066\u304f\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u3069\u3046\u305e\u3002\n\n# \u691c\u8a3c\n\u9577\u304b\u3063\u305f\u3067\u3059\u304c\u3001\u3044\u3088\u3044\u3088 Python3 \u3067\u691c\u8a3c\u3067\u3059\u3002\u524d\u56de\u306e\u53cd\u7701\u3092\u8e0f\u307e\u3048\u3001\u6700\u521d\u304b\u3089\u6b63\u898f\u4e71\u6570\u3067\u3044\u304d\u307e\u3059\u3002\n\n```python\nimport numpy as np\nimport numpy.random as rand\nimport matplotlib.pyplot as plt\n\n# Set parameters\nn = 3 # The number of random numbers\nsize = int(1e4) # Size of the vector\nr_in = np.matrix([\n    [1, 0.2, 0.8],\n    [0.2, 1, 0.6],\n    [0.8, 0.6, 1]\n    ]) # Correlation matrix\n\n# Generate correlated random numbers\nl = np.linalg.cholesky(r_in)\nx = rand.randn(n, size)\nz = l * x\n\n# Calculate stats\ncov = np.cov(z)\nr_out = np.corrcoef(z)\nprint(\"covariance matrix:\\n{}\\n\".format(cov))\nprint(\"correlation matrix:\\n{}\\n\".format(r_out))\n\n# Plot results\nfig, ax = plt.subplots()\nax.scatter(z[0, :], z[1, :], s=1, color='red', label='Z_2')\nax.scatter(z[0, :], z[2, :], s=1, color='blue', label='Z_3')\nax.set_xlabel('Z_1')\nax.set_ylabel('Z_2, Z_3')\nax.legend()\nplt.show()\n\n```\n\n\u51fa\u529b\u306f\u3053\u308c\u3002\n\n```python:\u51fa\u529b\ncovariance matrix:\n[[ 1.00545504  0.19297604  0.79517079]\n [ 0.19297604  1.00391907  0.5943957 ]\n [ 0.79517079  0.5943957   0.99000159]]\n\ncorrelation matrix:\n[[ 1.          0.19207582  0.79700517]\n [ 0.19207582  1.          0.5962225 ]\n [ 0.79700517  0.5962225   1.        ]]\n```\n\nCovariance matrix\uff08\u5171\u5206\u6563\u884c\u5217\uff09\u306e\u5bfe\u89d2\u6210\u5206\u306f\u5206\u6563\u3067\u3059\u3002\u3082\u3068\u306e\u6b63\u898f\u4e71\u6570\u3068\u540c\u3058\u3001\u5206\u6563 $1$ \u306b\u8fd1\u3044\u5024\u304c\u51fa\u3066\u3044\u308b\u306e\u3067\u3001\u7406\u8ad6\u306e\u3068\u3053\u308d\u3067\u304a\u3044\u305f\u3001\u300c$\\\\{Z_i\\\\}$ \u306e\u5206\u6563\u306f $\\\\{X_i\\\\}$ \u3068\u7b49\u3057\u3044\u300d\u3068\u3044\u3046\u4eee\u5b9a\u306f\u554f\u984c\u306a\u3055\u305d\u3046\u3067\u3059\u306d\u3002\n\n\u307e\u305f\u3001Correlation matrix\uff08\u76f8\u95a2\u884c\u5217\uff09\u306e\u307b\u3046\u3067\u306f\u3001\u304d\u3061\u3093\u3068\u30a4\u30f3\u30d7\u30c3\u30c8\u3057\u305f\u5024\u306b\u8fd1\u3044\u6570\u5b57\u304c\u51fa\u3066\u304d\u3066\u3044\u307e\u3059\u3002\n\n$Z_1$ \u306b\u5bfe\u3059\u308b $Z_2$ \u3068 $Z_3$ \u306e\u30d7\u30ed\u30c3\u30c8\u306f\u3053\u3061\u3089\u3002\n![rho12_0p2_rho13_0p8_rho23_0p6.png](https://qiita-image-store.s3.amazonaws.com/0/96638/6ac85922-6aa7-043e-d6c5-97e1d20f54cd.png)\n$\\rho_{13}$ \u306b\u5f37\u3081\u306e\u76f8\u95a2\u3092\u5165\u308c\u305f\u306e\u304c\u304d\u3061\u3093\u3068\u53cd\u6620\u3055\u308c\u3066\u3044\u307e\u3059\u306d\uff01\n\n\u3067\u306f\u3053\u3093\u306a\u76f8\u95a2\u884c\u5217\u306f\u3069\u3046\u3067\u3057\u3087\u3046\uff1f \u8ca0\u306e\u76f8\u95a2\u3082\u898b\u305f\u3044\u3067\u3059\u3088\u306d\u3002\n\n```python\nr_in = np.matrix([\n    [1, -0.2, -0.8],\n    [-0.2, 1, -0.6],\n    [-0.8, -0.6, 1]\n    ]) # Correlation matrix\n```\n\n\u5b9f\u884c\u3059\u308b\u3068\u2026\u2026\n\n```python:\u51fa\u529b\nTraceback (most recent call last):\n  File \"spike.py\", line 15, in <module>\n    l = np.linalg.cholesky(r_in)\n  File \"/Users/horiem/.pyenv/versions/anaconda3-4.0.0/lib/python3.5/site-packages/numpy/linalg/linalg.py\", line 612, in cholesky\n    r = gufunc(a, signature=signature, extobj=extobj)\n  File \"/Users/horiem/.pyenv/versions/anaconda3-4.0.0/lib/python3.5/site-packages/numpy/linalg/linalg.py\", line 93, in _raise_linalgerror_nonposdef\n    raise LinAlgError(\"Matrix is not positive definite\")\nnumpy.linalg.linalg.LinAlgError: Matrix is not positive definite\n\nshell returned 1\n```\n\n\u304a\u3063\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3057\u305f\u306d\uff08\u305d\u3057\u3066 pyenv \u3068 anaconda \u3092\u4f7f\u3063\u3066\u308b\u3053\u3068\u304c\u30d0\u30ec\u3066\u3057\u307e\u3044\u307e\u3057\u305f\u306d\uff09\u3002\u3069\u3046\u3084\u3089\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u306b\u5931\u6557\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\"Matrix is not positive definite\" \u3068\u6012\u3063\u3066\u3044\u307e\u3059\u306d\u3002\n\n\u305d\u3046\u3067\u3059\u3001\u5b9f\u306f\u3001\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u304c\u3067\u304d\u308b\u305f\u3081\u306b\u306f\u3001\u5bfe\u8c61\u3068\u306a\u308b\u884c\u5217\u304c\uff1a\n\n* \u5bfe\u79f0\u884c\u5217\u3067\u3042\u308b\uff08\u8907\u7d20\u6570\u306e\u5834\u5408\u306f\u30a8\u30eb\u30df\u30fc\u30c8\uff09\n* \u6b63\u5b9a\u5024\u884c\u5217\uff08positive definite\uff09\u3067\u3042\u308b\n\n\u3053\u3068\u304c\u5fc5\u8981\u306a\u3093\u3067\u3059\u3002\n\n\u6b63\u5b9a\u5024\u884c\u5217\u3063\u3066\u4f55\u3058\u3083\u3063\u3066\u3044\u3046\u3068\u3001\u4efb\u610f\u306e\u975e\u30bc\u30ed\u30d9\u30af\u30c8\u30eb $\\boldsymbol{z}$ \u306b\u5bfe\u3057\u3066\u3001\n\n```math\n\\boldsymbol{z}^T M \\boldsymbol{z} > 0\n```\n\n\u3068\u306a\u308b\u3088\u3046\u306a\u5bfe\u79f0\u884c\u5217 $M$ \u306e\u3053\u3068\u3067\u3059[^5]\u3002\n\n\u305d\u3093\u306a\u306e\u3044\u3061\u3044\u3061\u78ba\u8a8d\u3057\u3066\u3089\u308c\u306a\u3044\u3088\u3063\u3066\u3044\u3046\u4eba\u306e\u305f\u3081\u306b\u3001\u3044\u3044\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\u300c\u884c\u5217 $M$ \u304c\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3053\u3068\u300d\u3068\u300c\u884c\u5217 $M$ \u306e\u56fa\u6709\u5024\u304c\u3059\u3079\u3066\u6b63\u3067\u3042\u308b\u3053\u3068\u300d\u306f\u540c\u5024\u3067\u3059\u3002\u306a\u306e\u3067\u3001\u56fa\u6709\u5024\u306e\u7b26\u53f7\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```python\nr_in = np.matrix([\n    [1, -0.2, -0.8],\n    [-0.2, 1, -0.6],\n    [-0.8, -0.6, 1]\n    ]) # Correlation matrix\n\nw, v = np.linalg.eig(r_in)\nprint(w)\n```\n\n```python:\u51fa\u529b\n[-0.10192577  1.19135241  1.91057336]\n```\n\n\u3042\u3061\u3083\u301c\u3001\u3084\u3063\u3071\u308a\u8ca0\u306e\u56fa\u6709\u5024\u304c\u3042\u308a\u307e\u3059\u306d\u3002\u3053\u308c\u3058\u3083\u3042\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3067\u304d\u307e\u305b\u3093\u3002\n\n\u3048\u30fc\u3058\u3083\u3042\u8ca0\u306e\u76f8\u95a2\u304c\u3042\u308b\u3068\u304d\u306f\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3067\u304d\u306a\u3044\u3063\u3066\u3053\u3068\uff1f \u3044\u3084\u3044\u3084\u3001\u305d\u3046\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u5b9f\u306f\u3001\u3069\u3093\u306a\u76f8\u95a2\u884c\u5217\u306b\u3082\u3082\u3068\u3082\u3068[\u975e\u8ca0\u5b9a\u5024\u6027\uff08\u534a\u6b63\u5b9a\u5024\u6027\uff09\u304c\u3042\u308a\u307e\u3059](http://mathtrain.jp/correlationmatrix \"\u76f8\u95a2\u884c\u5217\u306e\u5b9a\u7fa9\u3068\u5206\u6563\u5171\u5206\u6563\u884c\u5217\u3068\u306e\u95a2\u4fc2 | \u9ad8\u6821\u6570\u5b66\u306e\u7f8e\u3057\u3044\u7269\u8a9e\")\u3002\u975e\u8ca0\u5b9a\u5024\u6027\u306f\u3001\u3055\u3063\u304d\u306e\u6b63\u5b9a\u5024\u6027\u306e\u6761\u4ef6\u306b\u30bc\u30ed\u3092\u542b\u3093\u3060\u5834\u5408\u3067\u3059\u3002\u3064\u307e\u308a\u3001\u56fa\u6709\u5024\u304c\u30bc\u30ed\u304b\u6b63\u306b\u306a\u308b\u3063\u3066\u3053\u3068\u3067\u3059\u306d\u3002\u56fa\u6709\u5024\u304c\u30bc\u30ed\u306e\u3082\u306e\u3092\u542b\u3080\u4f8b\u3068\u3057\u3066\u306f\u3001\n\n```math\n\\left( \\begin{array}{ccc}\n1 & 1 & -1\n\\\\\n1 & 1 & -1\n\\\\\n-1 & -1 & 1\n\\end{array} \\right)\n```\n\n\u3068\u304b\u3067\u3059\u306d\u3002\u3053\u308c\u306f\u975e\u8ca0\u5b9a\u5024\u306a\u306e\u3067\u76f8\u95a2\u884c\u5217\u306e\u8cc7\u683c\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u6b63\u5b9a\u5024\u3067\u306f\u306a\u3044\u306e\u3067\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u30ec\u30a2\u30b1\u30fc\u30b9\u3067\u3059\uff08\u3067\u3082\u3001\u5fc5\u8981\u306a\u3044\u3088\u306d\uff1f\uff1f\uff09\u3002\n\n\u3055\u3089\u306b\u3001\u3053\u3093\u306a\u884c\u5217\n\n```math\n\\left( \\begin{array}{ccc}\n1 & -1 & -1\n\\\\\n-1 & 1 & -1\n\\\\\n-1 & -1 & 1\n\\end{array} \\right)\n```\n\n\u3053\u308c\u3082\u4e00\u898b\u76f8\u95a2\u884c\u5217\u3063\u307d\u3044\u3067\u3059\u304c\u975e\u8ca0\u5b9a\u5024\u3067\u3059\u3089\u306a\u3044\u306e\u3067\u76f8\u95a2\u884c\u5217\u306e\u8cc7\u683c\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u8003\u3048\u3066\u307f\u308c\u3070\u660e\u3089\u304b\u3067\u3001$Z_1$ \u3068 $Z_2$ \u304c\u9006\u76f8\u95a2\u3001$Z_2$ \u3068 $Z_3$ \u3082\u9006\u76f8\u95a2\u3001$Z_3$ \u3068 $Z_1$ \u3082\u9006\u76f8\u95a2\u306a\u3093\u3066\u3042\u308a\u3048\u307e\u305b\u3093\u3088\u306d\uff1f \u3053\u308c\u306e\u8a00\u3063\u3066\u3044\u308b\u3053\u3068\u306f\n\n```math\n\\begin{align}\nZ_1 = - c_2 Z_2\n\\\\\nZ_2 = - c_3 Z_3\n\\\\\nZ_3 = -c_1 Z_1\n\\end{align}\n```\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3059\uff08$c_1, c_2, c_3 > 0$\uff09\u3002\u3053\u308c\u3092\u5168\u90e8\u4ee3\u5165\u3057\u3066\u3044\u304f\u3068 $Z_1 = (\u8ca0\u306e\u5b9a\u6570) \\times Z_1$ \u3068\u306a\u3063\u3066\u3001\u77db\u76fe\u304c\u8d77\u304d\u307e\u3059\u3002\u3053\u3046\u3044\u3046\u6b63\u3057\u304f\u306a\u3044\u30c7\u30fc\u30bf\u306f\u6570\u5b66\u306e\u30b7\u30b9\u30c6\u30e0\u306e\u307b\u3046\u3067\u5f3e\u3044\u3066\u304f\u308c\u3066\u3044\u308b\u3093\u3067\u3059\u306d\u3002\u3059\u3054\u3044\u3002\n\n\u5148\u7a0b\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u4f8b\u3082\u3001\u30d1\u30c3\u3068\u898b\u76f8\u95a2\u884c\u5217\u3063\u307d\u3044\u3082\u306e\u3067\u3057\u305f\u304c\u3001\u8ca0\u306e\u56fa\u6709\u5024\u304c\u542b\u307e\u308c\u3066\u3044\u305f\u306e\u3067\u975e\u8ca0\u5b9a\u5024\u3067\u3042\u308a\u307e\u305b\u3093\u3002\u3064\u307e\u308a\u3001\u5b9f\u969b\u306b\u306f\u76f8\u95a2\u884c\u5217\u3068\u306f\u547c\u3079\u306a\u3044\u30c1\u30f3\u30d7\u30f3\u30ab\u30f3\u30d7\u30f3\u306e\u30c7\u30fc\u30bf\u3060\u3063\u305f\u3063\u3066\u3053\u3068\u3067\u3059\u306d\u3002\n\n\u306a\u306e\u3067\u3001\u8ca0\u306e\u76f8\u95a2\u3092\u5165\u308c\u308b\u3068\u304d\u306f\u3082\u3046\u3061\u3087\u3063\u3068\u30de\u30a4\u30eb\u30c9\u306b\u3057\u3066\u3042\u3052\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\u4f8b\u3048\u3070\n\n```\nr_in = np.matrix([\n    [1, 0.2, -0.4],\n    [0.2, 1, 0.6],\n    [-0.4, 0.6, 1]\n    ]) # Correlation matrix\n```\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u306d\u3002\u4e00\u5fdc\u56fa\u6709\u5024\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3068\u2026\u2026\n\n```python:\u51fa\u529b\n[ 0.17738188  1.18223576  1.64038236]\n```\n\n\u5168\u90e8\u6b63\u3002\u3088\u304b\u3063\u305f\u3002\u56de\u3057\u3066\u307f\u308b\u3068\u2026\u2026\n\n```python:\u51fa\u529b\ncovariance matrix:\n[[ 1.0117086   0.17839112 -0.42687826]\n [ 0.17839112  0.98871838  0.60641387]\n [-0.42687826  0.60641387  1.03022947]]\n\ncorrelation matrix:\n[[ 1.          0.17836482 -0.41812808]\n [ 0.17836482  1.          0.60084968]\n [-0.41812808  0.60084968  1.        ]]\n```\n\n![rho12_0p2_rho13_-0p4_rho23_0p6.png](https://qiita-image-store.s3.amazonaws.com/0/96638/dc8a4666-1612-3814-6f41-71af067de248.png)\n\n\u3044\u3044\u611f\u3058\u306b\u9006\u76f8\u95a2\u304c\u51fa\u3066\u3044\u307e\u3059\uff01 \u3084\u3063\u305f\u306d\uff01\n\n# \u307e\u3068\u3081\n\u76f8\u95a2\u304c\u3042\u308b $n$ \u500b\u306e\u4e71\u6570\u304c\u3069\u306e\u3088\u3046\u306b\u4f5c\u308c\u308b\u304b\uff1f \u305d\u3057\u3066\u3001\u305d\u308c\u306f\u306a\u305c\u304b\uff1f \u3092\u898b\u3066\u304d\u307e\u3057\u305f\u3002\u3053\u3046\u3044\u3046\u30cd\u30bf\u3067\u306f\u5fc5\u305a\u300c\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u3092\u305b\u3088\u300d\u3068\u8a00\u308f\u308c\u308b\u306e\u3067\u3059\u304c\u3001\u306a\u305c\u305d\u308c\u3067\u3046\u307e\u304f\u3044\u304f\u306e\u304b\u307e\u3067\u8a00\u53ca\u3057\u3066\u3044\u308b\u8a18\u4e8b\u306f\u3042\u307e\u308a\u306a\u3044\u3093\u3058\u3083\u306a\u3044\u3067\u3057\u3087\u3046\u304b\u3002\u8a08\u7b97\u81ea\u4f53\u3082\u3001\u9805\u304c\u591a\u304f\u3066\uff08\u66f8\u304f\u306e\u304c\uff09\u3061\u3087\u3063\u3068\u3081\u3093\u3069\u304f\u3055\u3044\u3067\u3059\u304c\u3001\u7dda\u5f62\u4ee3\u6570\u3068\u7d71\u8a08\u306e\u57fa\u790e\u7684\u306a\u90e8\u5206\u3060\u3051\u3067\u5341\u5206\u6700\u5f8c\u307e\u3067\u3044\u3051\u307e\u3059\u3002\u3084\u306f\u308a\u3001$n$ \u500b\u306e\u5909\u6570\u3092\u6271\u3044\u59cb\u3081\u305f\u3089\u5fc5\u305a\u7dda\u5f62\u4ee3\u6570\u304c\u9854\u3092\u51fa\u3057\u307e\u3059\u306d\u3002\n\n\u691c\u8a3c\u306e\u65b9\u3067\u306f\u3001\u76f8\u95a2\u884c\u5217\u3063\u307d\u304f\u898b\u3048\u3066\u3082\u5b9f\u306f\u76f8\u95a2\u884c\u5217\u3068\u306f\u547c\u3079\u306a\u3044\u3088\u3046\u306a\u3082\u306e\u3082\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\u5404\u6210\u5206\u304c $-1$ \u304b\u3089 $1$ \u306e\u9593\u3063\u3066\u3060\u3051\u3058\u3083\u30c0\u30e1\u306a\u3093\u3067\u3059\u306d\u3002\n\n\u3044\u308d\u3044\u308d\u624b\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\u3068\u3044\u308d\u3044\u308d\u306a\u767a\u898b\u304c\u3042\u3063\u3066\u697d\u3057\u3044\u3067\u3059\u3002\u76f8\u95a2\u306e\u3042\u308b\u4e71\u6570\u751f\u6210\u306f\u624b\u3092\u52d5\u304b\u3059\u306b\u306f\u3061\u3087\u3046\u3069\u3044\u3044\u30cd\u30bf\u3060\u3068\u601d\u3046\u306e\u3067\u3001\u307f\u306a\u3055\u3093\u3082\u305c\u3072\u7d71\u8a08\u5b66\u3092\u697d\u3057\u3093\u3067\u307f\u3066\u304f\u3060\u3055\u3044\uff01\n\n[^1]: $X$ \u306f\u6210\u5206\u304c\u7e26\u306b\u4e26\u3093\u3060\u300c\u5217\u30d9\u30af\u30c8\u30eb\u300d\u3067\u3059\u304c\u3001\u7d19\u9762\u304c\u3082\u3063\u305f\u3044\u306a\u3044\u306e\u3067\u884c\u30d9\u30af\u30c8\u30eb\u306e\u8ee2\u7f6e\u3068\u3057\u3066\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\n[^2]: \u3064\u306d\u306b $( \\ i \\ \u3068 \\ j \\ \u306e\u76f8\u95a2) = ( \\ j \\ \u3068 \\ i \\ \u306e\u76f8\u95a2)$ \u3067\u3042\u308b\u305f\u3081\u3002\n[^3]: $\\\\{X_i\\\\}$ \u3068 $\\\\{Z_i\\\\}$ \u306f\u540c\u3058\u5206\u6563\u3092\u6301\u3064\u3068\u3057\u3066\u308b\u306e\u3067 $a_11 = 1$ \u304c\u305f\u3060\u3061\u306b\u308f\u304b\u308b\u306e\u3067\u3059\u304c\u3001\u3053\u3053\u306f\u8a18\u53f7\u306e\u307e\u307e\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n[^4]: \u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u30e2\u30fc\u30c9\u3067\u3084\u308b\u3068\u884c\u5217\u3063\u307d\u304f\u51fa\u3066\u304f\u308b\u306e\u3067\u3059\u304c\u3042\u3093\u307e\u308a\u898b\u3084\u3059\u304f\u306a\u3044\u306e\u3067\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3084\u3063\u3066\u307e\u3059\u3002\n[^5]: \u306a\u306e\u3067\u5b9f\u969b\u306b\u306f\u30b3\u30ec\u30b9\u30ad\u30fc\u5206\u89e3\u304c\u3067\u304d\u308b\u305f\u3081\u306e\u6761\u4ef6\u306f\u3001\u300c\u5bfe\u79f0\u306e\u884c\u5217\u304c\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3053\u3068\u300d\u3067\u5341\u5206\u3067\u3059\u3002\n", "tags": ["\u7d71\u8a08\u5b66", "Python", "python3", "\u6570\u5b66", "\u7dda\u5f62\u4ee3\u6570"]}