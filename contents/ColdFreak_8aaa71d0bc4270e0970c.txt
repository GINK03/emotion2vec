{"context": " More than 1 year has passed since last update.\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u4e0b\u306e\u3053\u3053\u306b\u3042\u308a\u307e\u3059\nRebar\u3067Erlang/OPT\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ea\u30ea\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u305f\u3044\u5834\u5408\u306f\u524d\u306e\u6295\u7a3f\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\u3053\u306e\u6587\u66f8\u306ferlang.mk\u3067Erlang/OPT\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ea\u30ea\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\uff0e\u4f8b\u3068\u3057\u3066\u306fCowboy\u3067Post\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u51e6\u7406\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304d\u307e\u3059\uff0e\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u306f\u6587\u66f8\u306e\u6700\u5f8c\u306e\u90e8\u5206\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fcowboy\u306eexample\u3092\u30d9\u30fc\u30b9\u306b\u3057\u305f\u3082\u306e\u3067\u3059\uff0e\n\nerlang.mk\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u307e\u305a\u30c7\u30a3\u30ec\u30af\u30c8\u30eacowboy_post\u3092\u4f5c\u6210\u3057\u3066\uff0cerlang.mk\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30c9\u30fc\u30c9\u3057\u307e\u3059\uff0e\n$ mkdir cowboy_post\n$ cd cowboy_post\n$ curl -O https://raw.githubusercontent.com/ninenines/erlang.mk/master/erlang.mk\n\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\u5fc5\u8981\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306bBootstrap\u3057\u307e\u3059\uff0eMakefile\u3082\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u4f5c\u6210\u3055\u308c\u307e\u3059\uff0e\n$ make -f erlang.mk bootstrap bootstrap-rel\n$ tree -L 2\n.\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 erlang.mk\n\u251c\u2500\u2500 rel\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sys.config\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 vm.args\n\u251c\u2500\u2500 relx.config\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 cowboy_post.app.src\n    \u251c\u2500\u2500 cowboy_post_app.erl\n    \u2514\u2500\u2500 cowboy_post_sup.erl\n\n2 directories, 8 files\n\n\nMakefile\u306a\u3069\u5404\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\ncowoby\u304c\u5fc5\u8981\u306e\u305f\u3081\uff0cMakefile\u306b\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8(DEPS)\u306b cowboy\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\u6ce8\u610f\uff1aMakefile\u306bcowboy\u306e\u30ea\u30f3\u30af\u3092\u4ed8\u3051\u52a0\u3048\u306a\u3044\u3068\u53e4\u3044cowboy\u3092\u3068\u3063\u3066\u304d\u307e\u3059\u306e\u3067\uff0c\u53e4\u3044\u66f8\u304d\u65b9(init/3)\u3060\u3068\u4e0b\u306etoppage_handler\u306einit/2\u304c\u901a\u3089\u306a\u3044\u3067\u3059\uff0e\n$ cat Makefile\nPROJECT = cowboy_post\nDEPS = cowboy\ndep_cowboy = git https://github.com/ninenines/cowboy master\ninclude erlang.mk\n\nsrc/cowboy_post.app.src\u30d5\u30a1\u30a4\u30eb\u306b\u3082cowboy\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n$ cat src/cowboy_post.app.src\n{application, cowboy_post, [\n    {description, \"\"},\n    {vsn, \"0.1.0\"},\n    {id, \"git\"},\n    {modules, []},\n    {registered, []},\n    {applications, [\n        kernel,\n        stdlib,\n        cowboy\n    ]},\n    {mod, {cowboy_post_app, []}},\n    {env, []}\n]}.\n\n\u305d\u3057\u3066\uff0c\u4e00\u65e6make\u3057\u307e\u3059\n$ make\n\n\n\u6b21\u306fpriv/static/index.html\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3057\u307e\u3059\uff0e\n$ mkdir -p priv/static\n$ cd priv/static\n$ touch index.html\n\nindex.html\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306f\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\uff0csubmit\u3092\u62bc\u3059\u3068/process\u30da\u30fc\u30b8\u3067\u51e6\u7406\u3057\u307e\u3059\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n</head>\n<body>\n    <form method=\"post\" action=\"/process\">\n        <input type=\"text\"  name=\"echo\">\n        <input type=\"submit\" value=\"submit\">\n    </form>\n</body>\n</html>\n\nsrc/cowboy_post_app.erl\u3092\u4e0b\u306e\u3088\u3046\u306b\u8ffd\u52a0\u3057\u307e\u3059\uff0epriv_file\u306b\u95a2\u3059\u308b\u8aac\u660e\u306f\u3053\u3061\u3089\u306b\u3042\u308a\u307e\u3059\n$ cat cowboy_post_app.erl\n-module(cowboy_post_app).\n-behaviour(application).\n\n-export([start/2]).\n-export([stop/1]).\n\nstart(_Type, _Args) ->\n    Dispatch =  cowboy_router:compile([\n        {'_', [\n                {\"/\", cowboy_static, {priv_file, cowboy_post, \"static/index.html\" }},\n                {\"/process\", toppage_handler, []}\n              ]\n        }\n    ]),\n    {ok, _} = cowboy:start_http(http, 100, [{port, 8080}], [\n        {env, [{dispatch, Dispatch}]}\n    ]),\n    cowboy_post_sup:start_link().\n\nstop(_State) ->\n    ok.\n\n\u4e0a\u306estart\u95a2\u6570\u306etoppage_handler\u306f\u30cf\u30f3\u30c9\u30e9\u306e\u3053\u3068\u3067\uff0c\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u3067submit\u3059\u308b\u3068\uff0c/process\u3068\u3044\u3046\u30eb\u30fc\u30eb\u3092\u51e6\u7406\u3059\u308b\u306e\u306ftoppage_handler\uff0e\u306a\u306e\u3067\uff0ctoppage_handler.erl\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n$ touch src/toppage_handler.erl\n\ntoppage_handler.erl\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\n$ cat \n%% Feel free to use, reuse and abuse the code in this file.\n\n%% @doc POST toppage_handler.\n-module(toppage_handler).\n\n-export([init/2]).\n\ninit(Req, Opts) ->\n    Method = cowboy_req:method(Req),\n    HasBody = cowboy_req:has_body(Req),\n    Req2 = maybe_echo(Method, HasBody, Req),\n    {ok, Req2, Opts}.\n\nmaybe_echo(<<\"POST\">>, true, Req) ->\n    {ok, PostVals, Req2} = cowboy_req:body_qs(Req),\n    Echo = proplists:get_value(<<\"echo\">>, PostVals),\n    echo(Echo, Req2);\nmaybe_echo(<<\"POST\">>, false, Req) ->\n    cowboy_req:reply(400, [], <<\"Missing body.\">>, Req);\nmaybe_echo(_, _, Req) ->\n    %% Method not allowed.\n    cowboy_req:reply(405, Req).\n\necho(undefined, Req) ->\n    cowboy_req:reply(400, [], <<\"Missing echo parameter.\">>, Req);\necho(Echo, Req) ->\n    cowboy_req:reply(200, [\n        {<<\"content-type\">>, <<\"text/plain; charset=utf-8\">>}\n    ], Echo, Req).\n\n\u4e0a\u306e\u30b3\u30fc\u30c9\u306b\u6ce8\u76ee\u3059\u3079\u304d\u4e00\u3064\u306e\u3068\u3053\u308d\u306f \nEcho = proplists:get_value(<<\"echo\">>, PostVals),\n\u3053\u3053\u306e<<\"echo\">>\u306f\u3069\u3053\u304b\u3089\u6765\u3066\u3044\u308b\u304b\u3068\u3044\u3046\u3068index.html\u30d5\u30a1\u30a4\u30eb\u306ename=\"echo\" \u306einput\u30bf\u30b0\u304b\u3089\u6765\u3066\u3044\u307e\u3059\uff0e\u3064\u307e\u308aproplists:get_value/2\u3092\u4f7f\u3063\u3066\uff0cname\u5c5e\u6027echo\u306einput\u30bf\u30b0\u306b\u5165\u529b\u3057\u305f\u5185\u5bb9\u3092\u53d6\u308a\u51fa\u3059\uff0e\u306a\u305c<<\"echo\">>\u306a\u3093\u3067\u3057\u3087\u3046\uff1f\u3000Cowboy\u306fbinary string\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u304b\u3089\u3067\u3059\uff0egithub\u306e\u30da\u30fc\u30b8\u306b\u3082\u66f8\u3044\u3066\u3042\u308b\u3088\u3046\u306b\n\nCowboy aims to provide a complete HTTP stack in a small code base. It is optimized for low latency and low memory usage, in part because it uses binary strings.\n\nsrc/cowboy_post_sup.erl\u30d5\u30a1\u30a4\u30eb\u306f\u7279\u306b\u4fee\u6b63\u306f\u5fc5\u8981\u304c\u306a\u3044\u3067\u3059\uff0e\n\u518d\u5ea6make\u3057\u3066\u304b\u3089\uff0c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\uff0e\n$ _rel/cowboy_post_release/bin/cowboy_post_release console\n\u30b3\u30de\u30f3\u30c9\u306e\u4e2d\u306econsole\u306e\u4ee3\u308f\u308a\u306bstart/stop\u3082\u4f7f\u3048\u307e\u3059\uff0e\n$ make\n$ _rel/cowboy_post_release/bin/cowboy_post_release console\nEshell V6.3  (abort with ^G)\n(cowboy_post@127.0.0.1)1>\n\n\u3053\u308c\u3067127.0.0.1:8080\u3092\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\uff0e\n\n\n\u3053\u3053\u307e\u3067\u304f\u308b\u3068cowboy_post\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u306e\u69cb\u9020\u306f\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\uff0e\n$ tree -L 2\n.\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 _rel\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 cowboy_post_release\n\u251c\u2500\u2500 deps\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowboy\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowlib\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 ranch\n\u251c\u2500\u2500 ebin\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowboy_post.app\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowboy_post_app.beam\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowboy_post_sup.beam\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 toppage_handler.beam\n\u251c\u2500\u2500 erlang.mk\n\u251c\u2500\u2500 priv\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 static\n\u251c\u2500\u2500 rel\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sys.config\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 vm.args\n\u251c\u2500\u2500 relx\n\u251c\u2500\u2500 relx.config\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 cowboy_post.app.src\n    \u251c\u2500\u2500 cowboy_post_app.erl\n    \u251c\u2500\u2500 cowboy_post_sup.erl\n    \u2514\u2500\u2500 toppage_handler.erl\n\n\nAngularJS\u3092\u4f7f\u3046\nAngularJS\u3092\u4f7f\u3046\u305f\u3081\u306b\u307e\u305aangular.js\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n$ mkdir -p priv/static/js\n$ cd priv/static/js\n$ wget https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular.js\n\npriv/static/angular.html\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\u4e2d\u8eab\u306f\u4e0b\u306e\u3088\u3046\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n <!doctype html>\n <html>\n    <head>\n    <script src=\"/js/angular.js\"></script>\n    </head>\n    <body ng-app=\"myapp\">\n       <div ng-controller=\"HelloController\" >\n          <h2>Welcome {{helloTo.title}} to the world of Tutorialspoint!</h2>\n       </div>\n       <script>\n          angular.module(\"myapp\", [])\n          .controller(\"HelloController\", function($scope) {\n             $scope.helloTo = {};\n             $scope.helloTo.title = \"AngularJS\";\n          });\n       </script>\n    </body>\n </html>\n\nhtml\u30d5\u30a1\u30a4\u30eb\u306b<script src=\"/js/angular.js\"></script>\u3092\u66f8\u304d\u8fbc\u3093\u3067\u3082\u305d\u306e\u307e\u307e\u4f7f\u3048\u306a\u3044\u3067\u3059\u3002\nsrc/cowboy_post_app.erl\u30d5\u30a1\u30a4\u30eb\u306b\u4e0b\u306e\u4e8c\u884c\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n{\"/app\", cowboy_static, {priv_file, cowboy_post, \"static/angular.html\" }},\n{\"/js/[...]\", cowboy_static, {priv_dir, cowboy_post, \"static/js\"}},\n\n\u4eca\u306fcowboy_post_app.erl\u30d5\u30a1\u30a4\u30eb\u306f\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n-module(cowboy_post_app).\n -behaviour(application).\n\n -export([start/2]).\n -export([stop/1]).\n\n start(_Type, _Args) ->\n     Dispatch =  cowboy_router:compile([\n         {'_', [\n                 {\"/\", cowboy_static, {priv_file, cowboy_post, \"static/index.html\" }},\n                 {\"/app\", cowboy_static, {priv_file, cowboy_post, \"static/angular.html\" }},\n                 {\"/js/[...]\", cowboy_static, {priv_dir, cowboy_post, \"static/js\"}},\n                 {\"/echo\", echo_handler, []}\n               ]\n         }\n     ]),\n     {ok, _} = cowboy:start_http(http, 100, [{port, 3333}], [\n         {env, [{dispatch, Dispatch}]}\n     ]),\n     cowboy_post_sup:start_link().\n\n stop(_State) ->\n     ok.\n\n\n\u4e0a\u306e\u30b3\u30fc\u30c9\u306e\u4e2d\u306e/js/[...]\u90e8\u5206\u306b\u95a2\u3057\u3066\u306f\u3053\u306e\u30ea\u30f3\u30af\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\npriv\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u306e\u69cb\u9020\u306f\n\u251c\u2500\u2500 priv\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 static\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 angular.html\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 index.html\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 js\n\u2502\u00a0\u00a0         \u2514\u2500\u2500 angular.js\n\n\u30a2\u30d7\u30ea\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u3001\u30ea\u30b9\u30bf\u30fc\u30c8\u3059\u308b\n$ make\n$ _rel/cowboy_post_release/bin/cowboy_post_release restart\n\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u4e0b\u306e[\u3053\u3053](https://github.com/ColdFreak/try_cowboy)\u306b\u3042\u308a\u307e\u3059\n\nRebar\u3067Erlang/OPT\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ea\u30ea\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u305f\u3044\u5834\u5408\u306f[\u524d\u306e\u6295\u7a3f](http://qiita.com/ColdFreak/items/e43d91eda5e8a3f39c46)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\u3053\u306e\u6587\u66f8\u306ferlang.mk\u3067Erlang/OPT\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ea\u30ea\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\uff0e\u4f8b\u3068\u3057\u3066\u306fCowboy\u3067Post\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u51e6\u7406\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u66f8\u304d\u307e\u3059\uff0e\u30a4\u30e1\u30fc\u30b8\u3068\u3057\u3066\u306f\u6587\u66f8\u306e\u6700\u5f8c\u306e\u90e8\u5206\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f[cowboy\u306eexample](https://github.com/ninenines/cowboy/tree/master/examples/echo_post)\u3092\u30d9\u30fc\u30b9\u306b\u3057\u305f\u3082\u306e\u3067\u3059\uff0e\n\n\n### erlang.mk\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n\u307e\u305a\u30c7\u30a3\u30ec\u30af\u30c8\u30eacowboy_post\u3092\u4f5c\u6210\u3057\u3066\uff0cerlang.mk\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30c9\u30fc\u30c9\u3057\u307e\u3059\uff0e\n\n```\n$ mkdir cowboy_post\n$ cd cowboy_post\n$ curl -O https://raw.githubusercontent.com/ninenines/erlang.mk/master/erlang.mk\n```\n\n### \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\n\u5fc5\u8981\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306bBootstrap\u3057\u307e\u3059\uff0eMakefile\u3082\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u4f5c\u6210\u3055\u308c\u307e\u3059\uff0e\n\n```\n$ make -f erlang.mk bootstrap bootstrap-rel\n$ tree -L 2\n.\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 erlang.mk\n\u251c\u2500\u2500 rel\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sys.config\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 vm.args\n\u251c\u2500\u2500 relx.config\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 cowboy_post.app.src\n    \u251c\u2500\u2500 cowboy_post_app.erl\n    \u2514\u2500\u2500 cowboy_post_sup.erl\n\n2 directories, 8 files\n```\n\n### Makefile\u306a\u3069\u5404\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\n\ncowoby\u304c\u5fc5\u8981\u306e\u305f\u3081\uff0cMakefile\u306b\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8(DEPS)\u306b cowboy\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\n\u6ce8\u610f\uff1aMakefile\u306bcowboy\u306e\u30ea\u30f3\u30af\u3092\u4ed8\u3051\u52a0\u3048\u306a\u3044\u3068\u53e4\u3044cowboy\u3092\u3068\u3063\u3066\u304d\u307e\u3059\u306e\u3067\uff0c\u53e4\u3044\u66f8\u304d\u65b9(init/3)\u3060\u3068\u4e0b\u306etoppage_handler\u306einit/2\u304c\u901a\u3089\u306a\u3044\u3067\u3059\uff0e\n\n```\n$ cat Makefile\nPROJECT = cowboy_post\nDEPS = cowboy\ndep_cowboy = git https://github.com/ninenines/cowboy master\ninclude erlang.mk\n```\n\nsrc/cowboy_post.app.src\u30d5\u30a1\u30a4\u30eb\u306b\u3082cowboy\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\n```\n$ cat src/cowboy_post.app.src\n{application, cowboy_post, [\n\t{description, \"\"},\n\t{vsn, \"0.1.0\"},\n\t{id, \"git\"},\n\t{modules, []},\n\t{registered, []},\n\t{applications, [\n\t\tkernel,\n\t\tstdlib,\n        cowboy\n\t]},\n\t{mod, {cowboy_post_app, []}},\n\t{env, []}\n]}.\n```\n\n\u305d\u3057\u3066\uff0c\u4e00\u65e6make\u3057\u307e\u3059\n\n```\n$ make\n```\n\n![Screen Shot 2015-02-07 at 10.15.53 AM.png](https://qiita-image-store.s3.amazonaws.com/0/54698/a42e2681-7d5d-865e-1249-07fff16cb8a1.png)\n\n\n\u6b21\u306fpriv/static/index.html\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3057\u307e\u3059\uff0e\n\n```\n$ mkdir -p priv/static\n$ cd priv/static\n$ touch index.html\n```\n\nindex.html\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306f\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\uff0csubmit\u3092\u62bc\u3059\u3068/process\u30da\u30fc\u30b8\u3067\u51e6\u7406\u3057\u307e\u3059\n\n```html\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n</head>\n<body>\n    <form method=\"post\" action=\"/process\">\n        <input type=\"text\"  name=\"echo\">\n        <input type=\"submit\" value=\"submit\">\n    </form>\n</body>\n</html>\n```\n\nsrc/cowboy_post_app.erl\u3092\u4e0b\u306e\u3088\u3046\u306b\u8ffd\u52a0\u3057\u307e\u3059\uff0epriv_file\u306b\u95a2\u3059\u308b\u8aac\u660e\u306f[\u3053\u3061\u3089](http://ninenines.eu/docs/en/cowboy/HEAD/guide/static_files/)\u306b\u3042\u308a\u307e\u3059\n\n```erlang\n$ cat cowboy_post_app.erl\n-module(cowboy_post_app).\n-behaviour(application).\n\n-export([start/2]).\n-export([stop/1]).\n\nstart(_Type, _Args) ->\n    Dispatch =  cowboy_router:compile([\n        {'_', [\n                {\"/\", cowboy_static, {priv_file, cowboy_post, \"static/index.html\" }},\n                {\"/process\", toppage_handler, []}\n              ]\n        }\n    ]),\n    {ok, _} = cowboy:start_http(http, 100, [{port, 8080}], [\n        {env, [{dispatch, Dispatch}]}\n    ]),\n\tcowboy_post_sup:start_link().\n\nstop(_State) ->\n\tok.\n```\n\n\u4e0a\u306estart\u95a2\u6570\u306etoppage_handler\u306f\u30cf\u30f3\u30c9\u30e9\u306e\u3053\u3068\u3067\uff0c\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u3067submit\u3059\u308b\u3068\uff0c/process\u3068\u3044\u3046\u30eb\u30fc\u30eb\u3092\u51e6\u7406\u3059\u308b\u306e\u306ftoppage_handler\uff0e\u306a\u306e\u3067\uff0ctoppage_handler.erl\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\uff0e\n\n```\n$ touch src/toppage_handler.erl\n```\n\ntoppage_handler.erl\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\n\n```erlang\n$ cat \n%% Feel free to use, reuse and abuse the code in this file.\n\n%% @doc POST toppage_handler.\n-module(toppage_handler).\n\n-export([init/2]).\n\ninit(Req, Opts) ->\n\tMethod = cowboy_req:method(Req),\n\tHasBody = cowboy_req:has_body(Req),\n\tReq2 = maybe_echo(Method, HasBody, Req),\n\t{ok, Req2, Opts}.\n\nmaybe_echo(<<\"POST\">>, true, Req) ->\n\t{ok, PostVals, Req2} = cowboy_req:body_qs(Req),\n\tEcho = proplists:get_value(<<\"echo\">>, PostVals),\n\techo(Echo, Req2);\nmaybe_echo(<<\"POST\">>, false, Req) ->\n\tcowboy_req:reply(400, [], <<\"Missing body.\">>, Req);\nmaybe_echo(_, _, Req) ->\n\t%% Method not allowed.\n\tcowboy_req:reply(405, Req).\n\necho(undefined, Req) ->\n\tcowboy_req:reply(400, [], <<\"Missing echo parameter.\">>, Req);\necho(Echo, Req) ->\n\tcowboy_req:reply(200, [\n\t\t{<<\"content-type\">>, <<\"text/plain; charset=utf-8\">>}\n\t], Echo, Req).\n```\n\n\u4e0a\u306e\u30b3\u30fc\u30c9\u306b\u6ce8\u76ee\u3059\u3079\u304d\u4e00\u3064\u306e\u3068\u3053\u308d\u306f \n`Echo = proplists:get_value(<<\"echo\">>, PostVals),`\n\u3053\u3053\u306e`<<\"echo\">>`\u306f\u3069\u3053\u304b\u3089\u6765\u3066\u3044\u308b\u304b\u3068\u3044\u3046\u3068index.html\u30d5\u30a1\u30a4\u30eb\u306e`name=\"echo\"` \u306einput\u30bf\u30b0\u304b\u3089\u6765\u3066\u3044\u307e\u3059\uff0e\u3064\u307e\u308a`proplists:get_value/2`\u3092\u4f7f\u3063\u3066\uff0cname\u5c5e\u6027echo\u306einput\u30bf\u30b0\u306b\u5165\u529b\u3057\u305f\u5185\u5bb9\u3092\u53d6\u308a\u51fa\u3059\uff0e\u306a\u305c`<<\"echo\">>`\u306a\u3093\u3067\u3057\u3087\u3046\uff1f\u3000Cowboy\u306fbinary string\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u304b\u3089\u3067\u3059\uff0egithub\u306e\u30da\u30fc\u30b8\u306b\u3082\u66f8\u3044\u3066\u3042\u308b\u3088\u3046\u306b\n> Cowboy aims to provide a complete HTTP stack in a small code base. It is optimized for low latency and low memory usage, in part because it uses binary strings.\n\nsrc/cowboy_post_sup.erl\u30d5\u30a1\u30a4\u30eb\u306f\u7279\u306b\u4fee\u6b63\u306f\u5fc5\u8981\u304c\u306a\u3044\u3067\u3059\uff0e\n\n\u518d\u5ea6make\u3057\u3066\u304b\u3089\uff0c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u7acb\u3061\u4e0a\u3052\u307e\u3059\uff0e\n`$ _rel/cowboy_post_release/bin/cowboy_post_release console`\n\u30b3\u30de\u30f3\u30c9\u306e\u4e2d\u306econsole\u306e\u4ee3\u308f\u308a\u306bstart/stop\u3082\u4f7f\u3048\u307e\u3059\uff0e\n\n```\n$ make\n$ _rel/cowboy_post_release/bin/cowboy_post_release console\nEshell V6.3  (abort with ^G)\n(cowboy_post@127.0.0.1)1>\n```\n\n\u3053\u308c\u3067127.0.0.1:8080\u3092\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\uff0e\n\n![Screen Shot 2015-02-07 at 11.01.19 AM.png](https://qiita-image-store.s3.amazonaws.com/0/54698/01db7d54-e04a-d38e-70a2-4c1b69943e26.png)\n![Screen Shot 2015-02-07 at 11.01.53 AM.png](https://qiita-image-store.s3.amazonaws.com/0/54698/ad80c800-4f31-2fa8-0491-b11fcbb31d63.png)\n\n\n\u3053\u3053\u307e\u3067\u304f\u308b\u3068cowboy_post\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u306e\u69cb\u9020\u306f\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\uff0e\n\n```\n$ tree -L 2\n.\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 _rel\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 cowboy_post_release\n\u251c\u2500\u2500 deps\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowboy\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowlib\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 ranch\n\u251c\u2500\u2500 ebin\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowboy_post.app\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowboy_post_app.beam\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cowboy_post_sup.beam\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 toppage_handler.beam\n\u251c\u2500\u2500 erlang.mk\n\u251c\u2500\u2500 priv\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 static\n\u251c\u2500\u2500 rel\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sys.config\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 vm.args\n\u251c\u2500\u2500 relx\n\u251c\u2500\u2500 relx.config\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 cowboy_post.app.src\n    \u251c\u2500\u2500 cowboy_post_app.erl\n    \u251c\u2500\u2500 cowboy_post_sup.erl\n    \u2514\u2500\u2500 toppage_handler.erl\n```\n\n### AngularJS\u3092\u4f7f\u3046\n\nAngularJS\u3092\u4f7f\u3046\u305f\u3081\u306b\u307e\u305a`angular.js`\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```shell-session\n$ mkdir -p priv/static/js\n$ cd priv/static/js\n$ wget https://ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular.js\n```\n\n`priv/static/angular.html`\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\u4e2d\u8eab\u306f\u4e0b\u306e\u3088\u3046\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```html\n <!doctype html>\n <html>\n    <head>\n    <script src=\"/js/angular.js\"></script>\n    </head>\n    <body ng-app=\"myapp\">\n       <div ng-controller=\"HelloController\" >\n          <h2>Welcome {{helloTo.title}} to the world of Tutorialspoint!</h2>\n       </div>\n       <script>\n          angular.module(\"myapp\", [])\n          .controller(\"HelloController\", function($scope) {\n             $scope.helloTo = {};\n             $scope.helloTo.title = \"AngularJS\";\n          });\n       </script>\n    </body>\n </html>\n```\n\nhtml\u30d5\u30a1\u30a4\u30eb\u306b`<script src=\"/js/angular.js\"></script>`\u3092\u66f8\u304d\u8fbc\u3093\u3067\u3082\u305d\u306e\u307e\u307e\u4f7f\u3048\u306a\u3044\u3067\u3059\u3002\n\n`src/cowboy_post_app.erl`\u30d5\u30a1\u30a4\u30eb\u306b\u4e0b\u306e\u4e8c\u884c\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\n{\"/app\", cowboy_static, {priv_file, cowboy_post, \"static/angular.html\" }},\n{\"/js/[...]\", cowboy_static, {priv_dir, cowboy_post, \"static/js\"}},\n```\n\n\u4eca\u306f`cowboy_post_app.erl`\u30d5\u30a1\u30a4\u30eb\u306f\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```erlang\n-module(cowboy_post_app).\n -behaviour(application).\n\n -export([start/2]).\n -export([stop/1]).\n\n start(_Type, _Args) ->\n     Dispatch =  cowboy_router:compile([\n         {'_', [\n                 {\"/\", cowboy_static, {priv_file, cowboy_post, \"static/index.html\" }},\n                 {\"/app\", cowboy_static, {priv_file, cowboy_post, \"static/angular.html\" }},\n                 {\"/js/[...]\", cowboy_static, {priv_dir, cowboy_post, \"static/js\"}},\n                 {\"/echo\", echo_handler, []}\n               ]\n         }\n     ]),\n     {ok, _} = cowboy:start_http(http, 100, [{port, 3333}], [\n         {env, [{dispatch, Dispatch}]}\n     ]),\n     cowboy_post_sup:start_link().\n\n stop(_State) ->\n     ok.\n\n```\n\n\u4e0a\u306e\u30b3\u30fc\u30c9\u306e\u4e2d\u306e`/js/[...]`\u90e8\u5206\u306b\u95a2\u3057\u3066\u306f[\u3053\u306e\u30ea\u30f3\u30af](http://ninenines.eu/docs/en/cowboy/HEAD/guide/static_files/)\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\n`priv`\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4e0b\u306e\u69cb\u9020\u306f\n\n```\n\u251c\u2500\u2500 priv\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 static\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 angular.html\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 index.html\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 js\n\u2502\u00a0\u00a0         \u2514\u2500\u2500 angular.js\n```\n\n\u30a2\u30d7\u30ea\u3092\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u3001\u30ea\u30b9\u30bf\u30fc\u30c8\u3059\u308b\n\n```shell-session\n$ make\n$ _rel/cowboy_post_release/bin/cowboy_post_release restart\n```\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-14 20.18.56.png](https://qiita-image-store.s3.amazonaws.com/0/54698/338844f5-9cea-dc60-ea99-405516441d2d.png)\n", "tags": ["Erlang", "erlang.mk", "cowboy", "AngularJS"]}