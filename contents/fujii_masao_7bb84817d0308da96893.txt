{"context": " More than 1 year has passed since last update.psql\u7d4c\u7531\u3067\u3001CPU\u4f7f\u7528\u7387\u30921\u79d2\u9593\u9694\u3067\u30c6\u30fc\u30d6\u30eb\u306b\u84c4\u7a4d\u3057\u307e\u3059\u3002\n-- CPU\u4f7f\u7528\u7387\u306eus\u3001sy\u3001id\u3001wa\u3068\u53d6\u5f97\u6642\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u8a18\u9332\u3059\u308b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n=# CREATE TABLE cpu_usage (\n  time timestamp DEFAULT now(),\n  us smallint,\n  sy smallint,\n  id smallint,\n  wa smallint\n);\n\n-- COPY FROM PROGRAM\u3092\u4f7f\u3044\u3001vmstat\u304b\u3089CPU\u4f7f\u7528\u7387\u3092\u53d6\u5f97\u3057\u3066\u30c6\u30fc\u30d6\u30eb\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\nCOPY cpu_usage(us, sy, id, wa)\n  FROM PROGRAM 'vmstat | tail -1 | awk ''{print $13 \",\" $14 \",\" $15 \",\" $16}'''\n  WITH (FORMAT csv);\n\n-- CPU\u4f7f\u7528\u7387\u30921\u4ef6\u30c6\u30fc\u30d6\u30eb\u306b\u84c4\u7a4d\u3059\u308b\u4e0a\u8a18COPY FROM PROGRAM\u30921\u79d2\u9593\u9694\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\\watch 1\n\npsql\u7d4c\u7531\u3067\u3001CPU\u4f7f\u7528\u7387\u30921\u79d2\u9593\u9694\u3067\u30c6\u30fc\u30d6\u30eb\u306b\u84c4\u7a4d\u3057\u307e\u3059\u3002\n\n```sql\n-- CPU\u4f7f\u7528\u7387\u306eus\u3001sy\u3001id\u3001wa\u3068\u53d6\u5f97\u6642\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u8a18\u9332\u3059\u308b\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n=# CREATE TABLE cpu_usage (\n  time timestamp DEFAULT now(),\n  us smallint,\n  sy smallint,\n  id smallint,\n  wa smallint\n);\n\n-- COPY FROM PROGRAM\u3092\u4f7f\u3044\u3001vmstat\u304b\u3089CPU\u4f7f\u7528\u7387\u3092\u53d6\u5f97\u3057\u3066\u30c6\u30fc\u30d6\u30eb\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\nCOPY cpu_usage(us, sy, id, wa)\n  FROM PROGRAM 'vmstat | tail -1 | awk ''{print $13 \",\" $14 \",\" $15 \",\" $16}'''\n  WITH (FORMAT csv);\n\n-- CPU\u4f7f\u7528\u7387\u30921\u4ef6\u30c6\u30fc\u30d6\u30eb\u306b\u84c4\u7a4d\u3059\u308b\u4e0a\u8a18COPY FROM PROGRAM\u30921\u79d2\u9593\u9694\u3067\u5b9f\u884c\u3057\u307e\u3059\u3002\n\\watch 1\n```\n", "tags": ["monitoring", "PostgreSQL", "psql"]}