{"context": " More than 1 year has passed since last update.\u8a95\u751f\u65e5\u3068\u57fa\u6e96\u65e5\u3092\u3082\u3068\u306b\u3001\u6e80\u5e74\u9f62\u3001\u6570\u3048\u5e74\u3001\u5e72\u652f\u3001\u661f\u5ea7\u3092\u8868\u793a\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\nAppleScript\u306e\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306b\u5165\u308c\u3066\u304a\u3051\u3070\u3001\u91cd\u5b9d\u3057\u307e\u3059\u3002\uff08\u305f\u307e\u306b\u3057\u304b\u4f7f\u3044\u307e\u305b\u3093\u304c\uff09\n\u897f\u66a6\u3001\u548c\u66a6\uff08\u660e\u6cbb\u3001\u5927\u6b63\u3001\u662d\u548c\u3001\u5e73\u6210\uff09\u306e\u4e21\u65b9\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u3069\u3061\u3089\u306e\u5f62\u5f0f\u3067\u5165\u529b\u3057\u3066\u3082OK\u3067\u3059\u3002\n\n\u5e74\u9f62\u8a08\u7b97.scpt\n-- \u8a95\u751f\u65e5\u304b\u3089\u57fa\u6e96\u65e5\u306e\u6e80\u5e74\u9f62\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n-- \u5e72\u652f\u3068\u661f\u5ea7\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n-- \u5165\u529b\u306f\u897f\u66a6\u3067\u3082\u548c\u66a6\u3067\u3082\u81ea\u52d5\u5224\u5b9a\u3057\u307e\u3059\u3002\uff08\u660e\u6cbb\u301c\u5e73\u6210\u307e\u3067\uff09\n--\nset CR to ASCII character 13\ndisplay dialog \"\u8a95\u751f\u65e5\u3092\u5165\u529b\uff08yyyy/mm/dd \u3067\u3082\u53ef\uff09\" default answer \"\u662d\u548c12\u5e743\u67084\u65e5\"\nset BD to date gengo_check(text returned of result)\n\nset TODAY to (current date) as text\nset TD to (items 1 thru (offset of \"\u65e5\" in TODAY) of TODAY) as text\ndisplay dialog \"\u57fa\u6e96\u65e5\u3092\u5165\u529b\" default answer TD\nset KD to date gengo_check(text returned of result)\n\nset NENREI to (round ((KD - BD) / (365.25 * 24 * 60 * 60)) rounding down) as text\nset KAZOE to ((year of KD) - (year of BD) + 1) as text\n\nset ETO to item (((year of BD) mod 12) + 1) of \"\u7533\u9149\u620c\u4ea5\u5b50\u4e11\u5bc5\u536f\u8fb0\u5df3\u5348\u672a\"\nset SEIZA to constellation(BD)\n\ndisplay dialog \"\u6e80 \" & NENREI & \" \u6b73\u3001\" & ETO & \"\u5e74\u3001\" & SEIZA & \"\u3067\u3059\u3002\uff08\u6570\u3048\u5e74\u3067 \" & KAZOE & \" \u6b73\uff09\"\n\non gengo_check(inData)\n    set ans to inData\n    set GENGO to (items 1 thru 2 of ans) as text\n    set DIF to 0\n    if GENGO = \"\u660e\u6cbb\" then set DIF to 1867\n    if GENGO = \"\u5927\u6b63\" then set DIF to 1911\n    if GENGO = \"\u662d\u548c\" then set DIF to 1925\n    if GENGO = \"\u5e73\u6210\" then set DIF to 1988\n    if DIF > 0 then\n        set POS to offset of \"\u5e74\" in ans\n        set NEN to ((items 3 thru (POS - 1) of ans) as text) + DIF\n        set ans to ((NEN as text) & items POS thru (offset of \"\u65e5\" in ans) of ans) as text\n    end if\n    return ans\nend gengo_check\n\non constellation(B_Day)\n    set ans to \"Error\"\n    set MM to month of B_Day as integer\n    set DD to day of B_Day as integer\n    if (MM = 3 and DD \u2265 21) then set ans to \"\u7261\u7f8a\"\n    if (MM = 4 and DD \u2264 19) then set ans to \"\u7261\u7f8a\"\n    if (MM = 4 and DD \u2265 20) then set ans to \"\u7261\u725b\"\n    if (MM = 5 and DD \u2264 20) then set ans to \"\u7261\u725b\"\n    if (MM = 5 and DD \u2265 21) then set ans to \"\u53cc\u5b50\"\n    if (MM = 6 and DD \u2264 21) then set ans to \"\u53cc\u5b50\"\n    if (MM = 6 and DD \u2265 22) then set ans to \"\u87f9\"\n    if (MM = 7 and DD \u2264 22) then set ans to \"\u87f9\"\n    if (MM = 7 and DD \u2265 23) then set ans to \"\u7345\u5b50\"\n    if (MM = 8 and DD \u2264 22) then set ans to \"\u7345\u5b50\"\n    if (MM = 8 and DD \u2265 23) then set ans to \"\u4e59\u5973\"\n    if (MM = 9 and DD \u2264 22) then set ans to \"\u4e59\u5973\"\n    if (MM = 9 and DD \u2265 23) then set ans to \"\u5929\u79e4\"\n    if (MM = 10 and DD \u2264 23) then set ans to \"\u5929\u79e4\"\n    if (MM = 10 and DD \u2265 24) then set ans to \"\u880d\"\n    if (MM = 11 and DD \u2264 21) then set ans to \"\u880d\"\n    if (MM = 11 and DD \u2265 22) then set ans to \"\u5c04\u624b\"\n    if (MM = 12 and DD \u2264 21) then set ans to \"\u5c04\u624b\"\n    if (MM = 12 and DD \u2265 22) then set ans to \"\u5c71\u7f8a\"\n    if (MM = 1 and DD \u2264 19) then set ans to \"\u5c71\u7f8a\"\n    if (MM = 1 and DD \u2265 20) then set ans to \"\u6c34\u74f6\"\n    if (MM = 2 and DD \u2264 18) then set ans to \"\u6c34\u74f6\"\n    if (MM = 2 and DD \u2265 19) then set ans to \"\u9b5a\"\n    if (MM = 3 and DD \u2264 20) then set ans to \"\u9b5a\"\n    return ans & \"\u5ea7\"\nend constellation\n\n\n\u8a95\u751f\u65e5\u3068\u57fa\u6e96\u65e5\u3092\u3082\u3068\u306b\u3001\u6e80\u5e74\u9f62\u3001\u6570\u3048\u5e74\u3001\u5e72\u652f\u3001\u661f\u5ea7\u3092\u8868\u793a\u3059\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\nAppleScript\u306e\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u306b\u5165\u308c\u3066\u304a\u3051\u3070\u3001\u91cd\u5b9d\u3057\u307e\u3059\u3002\uff08\u305f\u307e\u306b\u3057\u304b\u4f7f\u3044\u307e\u305b\u3093\u304c\uff09\n\u897f\u66a6\u3001\u548c\u66a6\uff08\u660e\u6cbb\u3001\u5927\u6b63\u3001\u662d\u548c\u3001\u5e73\u6210\uff09\u306e\u4e21\u65b9\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u3069\u3061\u3089\u306e\u5f62\u5f0f\u3067\u5165\u529b\u3057\u3066\u3082OK\u3067\u3059\u3002\n\n```AppleScript:\u5e74\u9f62\u8a08\u7b97.scpt\n-- \u8a95\u751f\u65e5\u304b\u3089\u57fa\u6e96\u65e5\u306e\u6e80\u5e74\u9f62\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n-- \u5e72\u652f\u3068\u661f\u5ea7\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n-- \u5165\u529b\u306f\u897f\u66a6\u3067\u3082\u548c\u66a6\u3067\u3082\u81ea\u52d5\u5224\u5b9a\u3057\u307e\u3059\u3002\uff08\u660e\u6cbb\u301c\u5e73\u6210\u307e\u3067\uff09\n--\nset CR to ASCII character 13\ndisplay dialog \"\u8a95\u751f\u65e5\u3092\u5165\u529b\uff08yyyy/mm/dd \u3067\u3082\u53ef\uff09\" default answer \"\u662d\u548c12\u5e743\u67084\u65e5\"\nset BD to date gengo_check(text returned of result)\n\nset TODAY to (current date) as text\nset TD to (items 1 thru (offset of \"\u65e5\" in TODAY) of TODAY) as text\ndisplay dialog \"\u57fa\u6e96\u65e5\u3092\u5165\u529b\" default answer TD\nset KD to date gengo_check(text returned of result)\n\nset NENREI to (round ((KD - BD) / (365.25 * 24 * 60 * 60)) rounding down) as text\nset KAZOE to ((year of KD) - (year of BD) + 1) as text\n\nset ETO to item (((year of BD) mod 12) + 1) of \"\u7533\u9149\u620c\u4ea5\u5b50\u4e11\u5bc5\u536f\u8fb0\u5df3\u5348\u672a\"\nset SEIZA to constellation(BD)\n\ndisplay dialog \"\u6e80 \" & NENREI & \" \u6b73\u3001\" & ETO & \"\u5e74\u3001\" & SEIZA & \"\u3067\u3059\u3002\uff08\u6570\u3048\u5e74\u3067 \" & KAZOE & \" \u6b73\uff09\"\n\non gengo_check(inData)\n\tset ans to inData\n\tset GENGO to (items 1 thru 2 of ans) as text\n\tset DIF to 0\n\tif GENGO = \"\u660e\u6cbb\" then set DIF to 1867\n\tif GENGO = \"\u5927\u6b63\" then set DIF to 1911\n\tif GENGO = \"\u662d\u548c\" then set DIF to 1925\n\tif GENGO = \"\u5e73\u6210\" then set DIF to 1988\n\tif DIF > 0 then\n\t\tset POS to offset of \"\u5e74\" in ans\n\t\tset NEN to ((items 3 thru (POS - 1) of ans) as text) + DIF\n\t\tset ans to ((NEN as text) & items POS thru (offset of \"\u65e5\" in ans) of ans) as text\n\tend if\n\treturn ans\nend gengo_check\n\non constellation(B_Day)\n\tset ans to \"Error\"\n\tset MM to month of B_Day as integer\n\tset DD to day of B_Day as integer\n\tif (MM = 3 and DD \u2265 21) then set ans to \"\u7261\u7f8a\"\n\tif (MM = 4 and DD \u2264 19) then set ans to \"\u7261\u7f8a\"\n\tif (MM = 4 and DD \u2265 20) then set ans to \"\u7261\u725b\"\n\tif (MM = 5 and DD \u2264 20) then set ans to \"\u7261\u725b\"\n\tif (MM = 5 and DD \u2265 21) then set ans to \"\u53cc\u5b50\"\n\tif (MM = 6 and DD \u2264 21) then set ans to \"\u53cc\u5b50\"\n\tif (MM = 6 and DD \u2265 22) then set ans to \"\u87f9\"\n\tif (MM = 7 and DD \u2264 22) then set ans to \"\u87f9\"\n\tif (MM = 7 and DD \u2265 23) then set ans to \"\u7345\u5b50\"\n\tif (MM = 8 and DD \u2264 22) then set ans to \"\u7345\u5b50\"\n\tif (MM = 8 and DD \u2265 23) then set ans to \"\u4e59\u5973\"\n\tif (MM = 9 and DD \u2264 22) then set ans to \"\u4e59\u5973\"\n\tif (MM = 9 and DD \u2265 23) then set ans to \"\u5929\u79e4\"\n\tif (MM = 10 and DD \u2264 23) then set ans to \"\u5929\u79e4\"\n\tif (MM = 10 and DD \u2265 24) then set ans to \"\u880d\"\n\tif (MM = 11 and DD \u2264 21) then set ans to \"\u880d\"\n\tif (MM = 11 and DD \u2265 22) then set ans to \"\u5c04\u624b\"\n\tif (MM = 12 and DD \u2264 21) then set ans to \"\u5c04\u624b\"\n\tif (MM = 12 and DD \u2265 22) then set ans to \"\u5c71\u7f8a\"\n\tif (MM = 1 and DD \u2264 19) then set ans to \"\u5c71\u7f8a\"\n\tif (MM = 1 and DD \u2265 20) then set ans to \"\u6c34\u74f6\"\n\tif (MM = 2 and DD \u2264 18) then set ans to \"\u6c34\u74f6\"\n\tif (MM = 2 and DD \u2265 19) then set ans to \"\u9b5a\"\n\tif (MM = 3 and DD \u2264 20) then set ans to \"\u9b5a\"\n\treturn ans & \"\u5ea7\"\nend constellation\n```\n", "tags": ["AppleScript", "Mac"]}