{"context": "\n\n\u76ee\u7684\nWebProxy\u914d\u4e0b\u306eFTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089FTPS\u3092\u901a\u3057\u305f\u3044\n\n\u69cb\u6210\nclient(lftp,curl)\n|\nWebProxy(squid)\n|\nFTPServer(proftpd)\n\n\u5404\u8a2d\u5b9a\u306e\u629c\u7c8b\nFTPServer\n\u3053\u306e\u8fba\u308a\u306b\u66f8\u3044\u3066\u3042\u308b\u3053\u3068\u3092\u53c2\u8003\u306bImplicitMode\u3067\u5f85\u3061\u53d7\u3051\u3088\u3046\u3068\u3057\u305f\u304c\n\u4f55\u304b\u3092\u9593\u9055\u3048\u3066\u3044\u308b\u306e\u304b\u3001\u3046\u307e\u304f\u52d5\u4f5c\u305b\u305a\u3002\u3002\nExplicit\u3067\u5f85\u3061\u53d7\u3051\u3002\nhttp://www.proftpd.org/docs/contrib/mod_tls.html\n/usr/local/etc/proftpd.conf \n<IfModule mod_tls.c>\n# <VirtualHost FTP\u30b5\u30fc\u30d0\u306ePrivateIP\u3092\u8a2d\u5b9a\u3057\u305f>\n    TLSEngine on\n    TLSRequired off\n#    Port 990\n    TLSLog  /var/log/proftpd/tls.log\n    TLSProtocol TLSv1 TLSV1.2\n    TLSCipherSuite ALL:HIGH:MEDIUM\n\n    TLSRSACertificateFile /etc/pki/tls/certs/ftps.crt\n    TLSRSACertificateKeyFile /etc/pki/tls/private/ftps.key\n    TLSOptions NoCertRequest\n    TLSVerifyClient off\n\n# </VirtualHost>\n</IfModule>\n\n\n2.webProxy(Squid)\n/etc/squid/squid.conf\nacl SSL_ports port 21\n\n3.client\n~/.curlrc\ncat << _EOF_ > ~/.curlrc\nproxy=\"http://\u30d7\u30ed\u30ad\u30b7\u306ePrivateIP:3128\"\n_EOF_\n\n\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\n\u30fbls\ncurl --ftp-ssl -u FTP\u30e6\u30fc\u30b6\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9 ftp://xx.xx.xx.xxx\n\nproxy\u306e\u30ed\u30b0\n1487002892.132    324 xxx.xx.xx.xx TCP_MISS/200 5261 GET ftp://FTP\u30e6\u30fc\u30b6\u540d@xx.xxx.x.xxxx/ - DIRECT/xx.xxx.x.xxx text/html\n\n\u30fbput\ncurl --ftp-ssl -u FTP\u30e6\u30fc\u30b6\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9 -T \"put_file_name\" ftp://xxx.xxx.xx.xx -k\n\n\n\u53c2\u8003\nhttps://curl.haxx.se/mail/archive-2006-09/0021.html\n# \u76ee\u7684\nWebProxy\u914d\u4e0b\u306eFTP\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089FTPS\u3092\u901a\u3057\u305f\u3044\n\n# \u69cb\u6210\nclient(lftp,curl)\n|\nWebProxy(squid)\n|\nFTPServer(proftpd)\n\n# \u5404\u8a2d\u5b9a\u306e\u629c\u7c8b\n\nFTPServer\n\n\u3053\u306e\u8fba\u308a\u306b\u66f8\u3044\u3066\u3042\u308b\u3053\u3068\u3092\u53c2\u8003\u306bImplicitMode\u3067\u5f85\u3061\u53d7\u3051\u3088\u3046\u3068\u3057\u305f\u304c\n\u4f55\u304b\u3092\u9593\u9055\u3048\u3066\u3044\u308b\u306e\u304b\u3001\u3046\u307e\u304f\u52d5\u4f5c\u305b\u305a\u3002\u3002\nExplicit\u3067\u5f85\u3061\u53d7\u3051\u3002\nhttp://www.proftpd.org/docs/contrib/mod_tls.html\n\n\n_/usr/local/etc/proftpd.conf_ \n\n\n```\n<IfModule mod_tls.c>\n# <VirtualHost FTP\u30b5\u30fc\u30d0\u306ePrivateIP\u3092\u8a2d\u5b9a\u3057\u305f>\n    TLSEngine on\n    TLSRequired off\n#    Port 990\n    TLSLog  /var/log/proftpd/tls.log\n    TLSProtocol TLSv1 TLSV1.2\n    TLSCipherSuite ALL:HIGH:MEDIUM\n    \n    TLSRSACertificateFile /etc/pki/tls/certs/ftps.crt\n    TLSRSACertificateKeyFile /etc/pki/tls/private/ftps.key\n    TLSOptions NoCertRequest\n    TLSVerifyClient off\n\n# </VirtualHost>\n</IfModule>\n                  \n```\n\n2.webProxy(Squid)\n\n_/etc/squid/squid.conf_\n\n```\nacl SSL_ports port 21\n```\n\n\n3.client\n\n_~/.curlrc_\n\n```\ncat << _EOF_ > ~/.curlrc\nproxy=\"http://\u30d7\u30ed\u30ad\u30b7\u306ePrivateIP:3128\"\n_EOF_\n```\n\n\u5b9f\u884c\u30b3\u30de\u30f3\u30c9\n\n\n_\u30fbls_\n\n```\ncurl --ftp-ssl -u FTP\u30e6\u30fc\u30b6\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9 ftp://xx.xx.xx.xxx\n```\n\nproxy\u306e\u30ed\u30b0\n\n```\n1487002892.132    324 xxx.xx.xx.xx TCP_MISS/200 5261 GET ftp://FTP\u30e6\u30fc\u30b6\u540d@xx.xxx.x.xxxx/ - DIRECT/xx.xxx.x.xxx text/html\n```\n\n\n\n_\u30fbput_\n\n```\ncurl --ftp-ssl -u FTP\u30e6\u30fc\u30b6\u540d:\u30d1\u30b9\u30ef\u30fc\u30c9 -T \"put_file_name\" ftp://xxx.xxx.xx.xx -k\n```\n\n\n\n\n\n\n# \u53c2\u8003\nhttps://curl.haxx.se/mail/archive-2006-09/0021.html\n", "tags": ["squid", "proftpd"]}