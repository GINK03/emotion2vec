{"context": " More than 1 year has passed since last update.\u4eca\u56de\u306fAnsible\u3092\u4f7f\u3063\u3066\u3001mackerel-agent\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u8a18\u3001\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u8d77\u52d5\u3057Mackerel\u3067\u76e3\u8996\u5bfe\u8c61\u30db\u30b9\u30c8\u3078\u8ffd\u52a0\u3059\u308bplaybook\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\nmackerel\nmackerel\u306e\u30b5\u30fc\u30d3\u30b9\u306b\u3064\u3044\u3066\u306f\u3001\u307e\u305a\u3053\u3061\u3089\u3067\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u6642\u306f\u3001\u7121\u6599\u30c8\u30e9\u30a4\u30a2\u30eb\u306f14\u65e5\u3067\u3059\u3002\u307e\u305a\u306f\u7121\u6599\u30c8\u30e9\u30a4\u30a2\u30eb\u3067\u3069\u306e\u3088\u3046\u306a\u30b5\u30fc\u30d3\u30b9\u304b\u89e6\u3063\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002\n\nhosts\n[web]\ndev-web ansible_connection=ssh\nstg-web ansible_connection=ssh\nprod-web1 ansible_connection=ssh\nprod-web2 ansible_connection=ssh\n\n[dev]\ndev-web ansible_connection=ssh\n\n[stg]\nstg-web ansible_connection=ssh\n\n[prod]\nprod-web1 ansible_connection=ssh\nprod-web2 ansible_connection=ssh\n\n\nplaybook\n\nmackerele-agent.yml\n---\n- hosts: web\n  sudo: yes\n  tasks:\n    - name: install mackerel agent\n      shell: curl -fsSL https://mackerel.io/assets/files/scripts/setup-yum.sh | sh\n\n    - name: install yum mackerel angent\n      yum: name=mackerel-agent state=installed\n\n    - name: configure /etc/mackerel-agent/mackerel-agent.conf\n      lineinfile: dest=/etc/mackerel-agent/mackerel-agent.conf line='apikey = \"xxxxxxxxxxxxxxx\"'\n\n    - name: start mackerel-agent\n      command: '/etc/init.d/mackerel-agent start'\n\n\n\u4eca\u56de\u306fAnsible\u3092\u4f7f\u3063\u3066\u3001mackerel-agent\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u8a18\u3001\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u8d77\u52d5\u3057Mackerel\u3067\u76e3\u8996\u5bfe\u8c61\u30db\u30b9\u30c8\u3078\u8ffd\u52a0\u3059\u308bplaybook\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n## mackerel\nmackerel\u306e\u30b5\u30fc\u30d3\u30b9\u306b\u3064\u3044\u3066\u306f\u3001\u307e\u305a[\u3053\u3061\u3089](https://mackerel.io/ja/)\u3067\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u6642\u306f\u3001\u7121\u6599\u30c8\u30e9\u30a4\u30a2\u30eb\u306f14\u65e5\u3067\u3059\u3002\u307e\u305a\u306f\u7121\u6599\u30c8\u30e9\u30a4\u30a2\u30eb\u3067\u3069\u306e\u3088\u3046\u306a\u30b5\u30fc\u30d3\u30b9\u304b\u89e6\u3063\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002\n\n## hosts\n\n```\n[web]\ndev-web ansible_connection=ssh\nstg-web ansible_connection=ssh\nprod-web1 ansible_connection=ssh\nprod-web2 ansible_connection=ssh\n\n[dev]\ndev-web ansible_connection=ssh\n\n[stg]\nstg-web ansible_connection=ssh\n\n[prod]\nprod-web1 ansible_connection=ssh\nprod-web2 ansible_connection=ssh\n```\n\n## playbook\n\n```mackerele-agent.yml\n---\n- hosts: web\n  sudo: yes\n  tasks:\n    - name: install mackerel agent\n      shell: curl -fsSL https://mackerel.io/assets/files/scripts/setup-yum.sh | sh\n\n    - name: install yum mackerel angent\n      yum: name=mackerel-agent state=installed\n\n    - name: configure /etc/mackerel-agent/mackerel-agent.conf\n      lineinfile: dest=/etc/mackerel-agent/mackerel-agent.conf line='apikey = \"xxxxxxxxxxxxxxx\"'\n\n    - name: start mackerel-agent\n      command: '/etc/init.d/mackerel-agent start'\n```\n", "tags": ["Mackerel", "Ansible", "ansible-playbook"]}