{"tags": ["EC2", "Munin", "mariadb", "MySQL"], "context": " More than 1 year has passed since last update.\n\nAWS EC2\u3067munin \u697d\u3005\u30ea\u30bd\u30fc\u30b9\u76e3\u8996 \u3057\u3088\u3046\uff01\n\naws \u3067\u76e3\u8996\u3068\u3044\u3048\u3070\u3001\u3082\u3061\u308d\u3093cloud watch !! \u306a\u3093\u3067\u3059\u304c\u3001\u4f8b\u3048\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3044\u3046\u3068\u3001rds \u3067\u7acb\u3066\u305f\u5834\u5408\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ea\u30bd\u30fc\u30b9\u76e3\u8996\u306f\u4e00\u901a\u308a\u63c3\u3063\u3066\u3044\u3066\u4fbf\u5229\u3067\u3059\u3088\u306d\uff1f\u3067\u308f\u3067\u308f\u3001\u4eca\u56de\u306e\u3088\u3046\u306bEC2\u3067 Mariadb 10.0 \u3092\u72ec\u81ea\u3067\u4f5c\u3063\u305f\u30fb\u306a\u3093\u3066\u8a00\u3063\u305f\u5834\u5408\u306f\u3001\u3044\u308d\u3044\u308d\u4e0d\u4fbf\u3060\u3063\u305f\u308a\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u4ed6\u306b\u3082\u3001redis\u3092\u72ec\u81ea\u3067\u7acb\u3066\u305f\u308a\u3001\u306a\u3093\u3068\u304b\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u5225\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u7acb\u3066\u305f\u308a\u3068\u304b\u3055\u307e\u3056\u307e\u306a\u8981\u4ef6\u304c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u3053\u3053\u306f\u3001cloud watch \u3067\u3001\u3053\u3053\u306f\u3001\u5225\u306e\u76e3\u8996\u30c4\u30fc\u30eb\u3067\u306a\u3093\u3066\u3084\u3063\u3066\u3044\u305f\u3089\u3001\u30ea\u30bd\u30fc\u30b9\u76e3\u8996\u305d\u306e\u3082\u306e\u306e\u4e00\u8cab\u6027\u304c\u306a\u304f\u3066\u6df7\u4e71\u3068\u304b\u3057\u3061\u3083\u3044\u305d\u3046\u30fb\u30fb\n\u3063\u3066\u306a\u308f\u3051\u3067\u3001\u6bd4\u8f03\u7684\u306b\u7c21\u5358\u306b\u69cb\u7bc9\u3067\u304d\u308b\u3001munin\u3092\u4f7f\u3063\u3066\u3001\u3059\u3079\u3066\u306eec2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7d71\u5408\u76e3\u8996\u3067\u304d\u308b\u304b\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\uff01\n\u65e9\u901f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u8aac\u660e\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u524d\u306b\u3084\u3063\u305f\u74b0\u5883\u306b\u3064\u3044\u3066\u3056\u3063\u304f\u308a\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\u691c\u8a3c\u3057\u305f\u74b0\u5883\n\u3053\u3093\u306a\u74b0\u5883\u3067\u691c\u8a3c\u3057\u3066\u307f\u307e\u3057\u305f\n\u30fb VPC\u69cb\u6210\u3067\u3001public \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30b0\u30e1\u30f3\u30c8(10.0.0.0/24)\u3068 private \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30b0\u30e1\u30f3\u30c8(10.0.1.0/24)\u3092\u6301\u3063\u3066\u3044\u308b\n\u30fb munin \u30b5\u30fc\u30d0 \u306f\u30d1\u30d6\u30ea\u30c3\u30af\u30bb\u30b0\u30e1\u30f3\u30c8\u306b\u914d\u7f6e\u3057\u3066\u304a\u308a\u3001EIP\u3067public ip\u3092\u5272\u308a\u5f53\u3066\u3066\u3044\u308b(Private:10.0.0.111 Public: 52.5.72.111)\n\u30fb munin \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u306fpublic ip\u3092\u6301\u3063\u3066\u304a\u3089\u305a Mariadb 10.0 \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b(Private: 10.0.1.101)\n\nepel \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3053\u306e\u4f5c\u696d\u306f\u3001amazon linux \u3067\u306f\u3001\u5fc5\u8981\u306a\u3055\u305d\u3046\u3067\u3059\u304c\u3001ec2 \u3058\u3083\u306a\u304f\u3066\u3001\u4ed6\u793eVPS\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3060\u3051\u306b\u8a18\u8f09\u3057\u3066\u304a\u308a\u307e\u3059\ncd /tmp ; wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\nrpm -ivh epel-release-6-8.noarch.rpm\n# \u203bamazon linux \u306e\u5834\u5408\u306f\u3001epel \u5165\u3063\u3066\u3044\u308b\u3063\u307d\u306a\u306e\u3067\u3001\u4e0d\u8981\u3067\u3059\n\n\n\napache\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u3068\u308a\u3042\u3048\u305a\u3001\u306a\u306b\u3082\u8003\u3048\u306a\u3044\u3067\u3053\u308c\u306f\u5165\u308c\u3066\u304a\u304d\u307e\u3057\u3087\u3046\nyum insrall httpd\n\n\nmunin \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nyum --enablerepo=epel install munin munin-node\n\n\napache\u306e\u8d77\u52d5\n/etc/init.d/httpd start\n\n\nmunin \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u305f\u969b\u306e\u30ed\u30b0\u30a4\u30f3\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\ncd /etc/munin/\nhtpasswd -c munin-htpasswd \u4efb\u610f\u306e\u30e6\u30fc\u30b6\u30fc\u540d\nNew password: \u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\nRe-type new password: \u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\nAdding password for user \u4efb\u610f\u306e\u30e6\u30fc\u30b6\u30fc\u540d\n\n\u3053\u3053\u307e\u3067\u304d\u3066\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\u3061\u306a\u307f\u306b\u30a2\u30af\u30bb\u30b9\u306f\u3067\u304d\u308b\u3051\u3069\n\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\u306f\u307e\u3060\u958b\u59cb\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3057\u304b\u30d1\u30fc\u30b9\u3055\u308c\u3066\u3053\u306a\u3044\u306f\u305a\u3067\u3059\u3002\n\nmunin.conf \u306e\u7de8\u96c6\n;\u3092\u631f\u3093\u3067\u5de6\u304c\u3001\u30b0\u30eb\u30fc\u30d7\u5206\u3051\u306e\u540d\u524d\u3001\u53f3\u304c\u76e3\u8996\u5bfe\u8c61\u30db\u30b9\u30c8\uff08\u30af\u30e9\u30a4\u30f3\u30c8\uff09\u306e\u8b58\u5225\u5b50\u3092\u8a18\u5165\u3057\u307e\u3059\naddress\u306f\u3001munin\u30af\u30e9\u30a4\u30f3\u30c8\uff08\u76e3\u8996\u3055\u308c\u308b\u5074\uff09\u306eipaddress\u3067\u3059\u306d (^_^)\nvi /etc/munin/munin.conf\n---------------\n[dbms;db-mst01]                                                                                                                        address 10.0.1.101                                                                                                                      \nuse_node_name yes\n\n\nmunin \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nmunin-node \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u306f\u3001\u5358\u7d14\u306b\u306f\u3001\u4e0a\u8a18munin.server\u306f\u3069\u3053\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\nyum --enablerepo=epel install munin-node\n\n\nmunin-node.conf \u306e\u7de8\u96c6\ncd /etc/munin\n\nvi munin-node.conf\n-----\nhost_name stat.myserver.com\ncidr_allow 127.0.0.1/32\ncidr_allow 10.0.0.0/24\n\n\nmunin_client\u306e\u8d77\u52d5\n\u3072\u3068\u307e\u305a\u8d77\u52d5\u3057\u3066\u3001\u30d7\u30ed\u30bb\u30b9\u304c\u3042\u308b\u304b\u3092\u78ba\u8a8d\u3057\u3066\u307e\u3059\n/etc/init.d/munin-node start\nps -efw | grep munin | grep -v grep\nroot     26959     1  0 07:44 ?        00:00:00 /usr/bin/perl -wT /usr/sbin/munin-node\n\n\n\u78ba\u8a8d\u3057\u305f\u3089\u4e00\u5ea6\u7d42\u4e86\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n/etc/init.d/munin-node stop\n\n\nmunin MySQL\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nmunin MySQL \u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u306f\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\u5358\u7d14\u306b\u306f\u3001perl\u306eMySQL \u30c9\u30e9\u30a4\u30d0\u5468\u308a\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3060\u3051\u3067\u3059\n\u79c1\u306e\u5834\u5408\u306f\u3053\u3093\u306a\u306e\u3092\u5165\u308c\u307e\u3057\u305f\u3002\nyum install --enablerepo=epel perl-IPC-ShareLite perl-Cache-Cache perl-Cache perl-DBD-MySQL\n\n\nMySQL(mariaDB\u306e\u63a5\u7d9a\u8a2d\u5b9a\uff09\n\u4eca\u56de\u306f\u3001root\u3092userid\u3068\u3057\u3066\u5229\u7528\u3057\u307e\u3057\u305f\u304c\u3001\u3042\u307e\u308adb\u3067root\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u5229\u7528\u3059\u308b\u306e\u306f\u3088\u304f\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u306e\u3067\n\u76e3\u8996\u5c02\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u3066\u305d\u308c\u3092\u8a2d\u5b9a\u3057\u305f\u307b\u3046\u304c\u3044\u3068\u601d\u3044\u30fb\u30fb\u30fb\u307e\u3059\u3002\nvi /etc/munin/plugin-conf.d/munin-node\n------------------------------------------\n[mysql*]\nenv.mysqlopts -u root -p\u30d1\u30b9\u30ef\u30fc\u30c9\nenv.mysqladmin /usr/bin/mysqladmin\nenv.mysqlconnection DBI:mysql:mysql;host=127.0.0.1;port=3306\nenv.mysqluser root\nenv.mysqlpassword \u30d1\u30b9\u30ef\u30fc\u30c9\n------------------------------------------\n\n\nmysql\u306eplugin\u3092\u8a2d\u5b9a\nmunin\u3067\u76e3\u8996\u9805\u76ee\u3092\u8ffd\u52a0\u3059\u308b\u65b9\u6cd5\u306f\u5358\u7d14\u306b/usr/share/munin/plugins/\u304b\u3089\u3001/etc/munin/plugins\u306b\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308b\u3060\u3051\u3067\u3059\u4eca\u56de\u306fmysql(mariadb)\ncd /etc/munin/plugins\nln -s /usr/share/munin/plugins/mysql_ mysql_commands\nln -s /usr/share/munin/plugins/mysql_ mysql_innodb_bpool\nln -s /usr/share/munin/plugins/mysql_ mysql_innodb_io\nln -s /usr/share/munin/plugins/mysql_ mysql_innodb_log\nln -s /usr/share/munin/plugins/mysql_ mysql_innodb_tnx\nln -s /usr/share/munin/plugins/mysql_ mysql_select_types\nln -s /usr/share/munin/plugins/mysql_ mysql_table_locks\nln -s /usr/share/munin/plugins/mysql_ mysql_connections\nln -s /usr/share/munin/plugins/mysql_ mysql_slow\nln -s /usr/share/munin/plugins/mysql_ mysql_myisam_indexes\nln -s /usr/share/munin/plugins/mysql_ mysql_network_traffic\nln -s /usr/share/munin/plugins/mysql_ mysql_qcache\nln -s /usr/share/munin/plugins/mysql_ mysql_qcache_mem\n\n/etc/init.d/munin-node start\n/sbin/chkconfig/munin-node on\n\n\nmariadb\u306b\u6b63\u5e38\u306b\u63a5\u7d9a\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3059\u308b\n\u3053\u3093\u306a\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\u3042\u308c\u308c\u308c\u30fb\u30fb\n/usr/sbin/munin-run mysql_commands\nUnknown section: INDIVIDUAL BUFFER POOL INFO at /etc/munin/plugins/mysql_commands line 1098.\n\n\u3069\u3046\u3082\u3001maria\u3067\u8a8d\u8b58\u3055\u308c\u306a\u3044\u30b3\u30de\u30f3\u30c9\u304c\u3042\u308b\u6a21\u69d8\u3067 /usr/share/munin/plugins/mysql_ \u306e\u30a8\u30e9\u30fc\u5bfe\u8c61\u884c\u4ed8\u8fd1\u306b\u3042\u308b\u3001\u4e0b\u8a18\u9805\u76ee\u306b\n'INDIVIDUAL BUFFER POOL INFO'   => \\&skip,\n\n\u3068\u3044\u3046\u884c\u3092\u4e0b\u8a18\u3042\u305f\u308a\u306b\u8ffd\u8a18\u3057\u3066\u304f\u308c\u308c\u3070\u89e3\u6c7a\u3057\u307e\u3059\nvi /usr/share/munin/plugins/mysql_\n---------------------------------\n    my %section_map = (\n\n        'BUFFER POOL AND MEMORY'   => \\&parse_buffer_pool_and_memory,\n        'FILE I/O'                 => \\&parse_file_io,\n        'INSERT BUFFER AND ADAPTIVE HASH INDEX'\n            => \\&parse_insert_buffer_and_adaptive_hash_index,\n        'LATEST DETECTED DEADLOCK' => \\&skip,\n        'LATEST FOREIGN KEY ERROR' => \\&skip,\n        'LOG'                      => \\&parse_log,\n        'ROW OPERATIONS'           => \\&skip,\n        'SEMAPHORES'               => \\&parse_semaphores,\n        'TRANSACTIONS'             => \\&parse_transactions,\n        'BACKGROUND THREAD'        => \\&skip,\n        'INDIVIDUAL BUFFER POOL INFO'   => \\&skip,    # \u2192 \u3053\u308c\u3092\u8ffd\u8a18                                                                    \n    );\n---------------------------------\n\n\n\u518d\u5ea6\u30c1\u30e3\u30ec\u30f3\u30b8\n\u3069\u3046\u3067\u3057\u3087\u3046\uff1f\u304d\u3063\u3068\u4eca\u56de\u306f\u3046\u307e\u304f\u3044\u3063\u305f\u304b\u3068\u601d\u3044\u307e\u3059\n/usr/sbin/munin-run mysql_commands\nCom_delete.value 1371\nCom_insert.value 3896\nCom_insert_select.value 0\nCom_load.value 0\nCom_replace.value 0\nCom_replace_select.value 0\nCom_select.value 1419070\nCom_update.value 6555\nCom_update_multi.value 0\n\n\n\u76e3\u8996\u9805\u76ee\u3067\u4e0d\u8981\u306a\u3082\u306e\u3092\u524a\u9664\u3057\u305f\u3044\u5834\u5408\n\u3076\u3063\u3061\u3083\u3051\u898b\u306a\u3044\u3082\u306e\u3092\u304c\u3093\u304c\u3093\u30b0\u30e9\u30d5\u8868\u793a\u3059\u308b\u306e\u3082\u306e\u3057\u3093\u3069\u3044\u306e\u3067\u3001\u3044\u3089\u306a\u3044\u30b0\u30e9\u30d5\u306f\u6d88\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\ncd /etc/munin/plugins/\nll\n\u5408\u8a08 0\nlrwxrwxrwx 1 root root 28  4\u6708  8 07:02 cpu -> /usr/share/munin/plugins/cpu\nlrwxrwxrwx 1 root root 27  4\u6708  8 07:02 df -> /usr/share/munin/plugins/df\nlrwxrwxrwx 1 root root 33  4\u6708  8 07:02 df_inode -> /usr/share/munin/plugins/df_inode\nlrwxrwxrwx 1 root root 34  4\u6708  8 07:02 diskstats -> /usr/share/munin/plugins/diskstats\nlrwxrwxrwx 1 root root 32  4\u6708  8 07:02 entropy -> /usr/share/munin/plugins/entropy\nlrwxrwxrwx 1 root root 30  4\u6708  8 07:02 forks -> /usr/share/munin/plugins/forks\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 fw_packets -> /usr/share/munin/plugins/fw_packets\nlrwxrwxrwx 1 root root 32  4\u6708  8 07:02 if_err_eth0 -> /usr/share/munin/plugins/if_err_\nlrwxrwxrwx 1 root root 28  4\u6708  8 07:02 if_eth0 -> /usr/share/munin/plugins/if_\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 interrupts -> /usr/share/munin/plugins/interrupts\nlrwxrwxrwx 1 root root 33  4\u6708  8 07:02 irqstats -> /usr/share/munin/plugins/irqstats\nlrwxrwxrwx 1 root root 29  4\u6708  8 07:02 load -> /usr/share/munin/plugins/load\nlrwxrwxrwx 1 root root 31  4\u6708  8 07:02 memory -> /usr/share/munin/plugins/memory\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_commands -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_connections -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_innodb_bpool -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_innodb_io -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_innodb_log -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_innodb_tnx -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_myisam_indexes -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_network_traffic -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_qcache -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_qcache_mem -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_select_types -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_slow -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_table_locks -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 32  4\u6708  8 07:02 netstat -> /usr/share/munin/plugins/netstat\nlrwxrwxrwx 1 root root 36  4\u6708  8 07:02 nfs4_client -> /usr/share/munin/plugins/nfs4_client\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 nfs_client -> /usr/share/munin/plugins/nfs_client\nlrwxrwxrwx 1 root root 39  4\u6708  8 07:02 ntp_kernel_err -> /usr/share/munin/plugins/ntp_kernel_err\nlrwxrwxrwx 1 root root 44  4\u6708  8 07:02 ntp_kernel_pll_freq -> /usr/share/munin/plugins/ntp_kernel_pll_freq\nlrwxrwxrwx 1 root root 43  4\u6708  8 07:02 ntp_kernel_pll_off -> /usr/share/munin/plugins/ntp_kernel_pll_off\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 ntp_offset -> /usr/share/munin/plugins/ntp_offset\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 ntp_states -> /usr/share/munin/plugins/ntp_states\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 open_files -> /usr/share/munin/plugins/open_files\nlrwxrwxrwx 1 root root 36  4\u6708  8 07:02 open_inodes -> /usr/share/munin/plugins/open_inodes\nlrwxrwxrwx 1 root root 33  4\u6708  8 07:02 proc_pri -> /usr/share/munin/plugins/proc_pri\nlrwxrwxrwx 1 root root 34  4\u6708  8 07:02 processes -> /usr/share/munin/plugins/processes\nlrwxrwxrwx 1 root root 43  4\u6708  8 07:02 sendmail_mailqueue -> /usr/share/munin/plugins/sendmail_mailqueue\nlrwxrwxrwx 1 root root 43  4\u6708  8 07:02 sendmail_mailstats -> /usr/share/munin/plugins/sendmail_mailstats\nlrwxrwxrwx 1 root root 45  4\u6708  8 07:02 sendmail_mailtraffic -> /usr/share/munin/plugins/sendmail_mailtraffic\nlrwxrwxrwx 1 root root 29  4\u6708  8 07:02 swap -> /usr/share/munin/plugins/swap\nlrwxrwxrwx 1 root root 32  4\u6708  8 07:02 threads -> /usr/share/munin/plugins/threads\nlrwxrwxrwx 1 root root 31  4\u6708  8 07:02 uptime -> /usr/share/munin/plugins/uptime\nlrwxrwxrwx 1 root root 30  4\u6708  8 07:02 users -> /usr/share/munin/plugins/users\nlrwxrwxrwx 1 root root 31  4\u6708  8 07:02 vmstat -> /usr/share/munin/plugins/vmstat\n\n\n\u79c1\u306e\u5834\u5408\u3001\u4e0b\u8a18\u3092\u6d88\u3057\u307e\u3057\u305f\u3002\u6d88\u3059\u30fb\u30fb\u3068\u3044\u3063\u3066\u3082\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u5916\u3057\u305f\u3060\u3051\u3063\u3059\n\nunlink sendmail_mailqueue \nunlink sendmail_mailstats\nunlink sendmail_mailtraffic\nunlink users\nunlink threads\nunlink proc_pri\nunlink entropy\nunlink irqstats\nunlink forks\nunlink interrupts\nunlink ntp_offset\nunlink ntp_kernel_pll_off\nunlink ntp_kernel_pll_freq\nunlink ntp_kernel_err\nunlink if_err_eth0\nunlink if_err_eth1\nunlink ntp_states\nunlink fw_conntrack\nunlink fw_forwarded_local\nunlink fw_packets\nunlink postfix_mailqueue\nunlink postfix_mailvolume\nunlink proc_pri\n\n\n\u8d77\u52d5\u3057\u3066\u307f\u307e\u3057\u3087\u3046\n\u4e00\u901a\u308a\u306e\u8a2d\u5b9a\u304c\u6e08\u3093\u3060\u3068\u3053\u308d\u3067 \u8d77\u52d5\u3057\u3066\u307f\u307e\u3059\u3002\n/etc/init.d/munin-node start\n/sbin/chkconfig munin-node on\n\n\nWEB\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3088\u3046\nmunin\u30b5\u30fc\u30d0\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u53e9\u3044\u3066\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u5bfe\u8c61\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30ea\u30bd\u30fc\u30b9\u72b6\u6cc1\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u3001\u30aa\u30c3\u30b1\u30fc\u3067\u3059\uff01\uff01\n\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u9805\u76ee\u304c\u51fa\u3066\u3053\u306a\u3044\u5834\u5408\nmunin\u306f\u3001munin server\u5074\u304b\u3089\u76e3\u8996\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5024\u3092cron\u3092\u5229\u7528\u3057\u3066\u8aad\u307f\u53d6\u308b\u3057\u304f\u307f\u306b\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\u306a\u306e\u3067\u3001\u8a2d\u5b9a\u3057\u305f\u306f\u305a\u306a\u306e\u306b\u8868\u793a\u3055\u308c\u3066\u3053\u306a\u3044\uff01\u306a\u3093\u3066\u5834\u5408\u306f\u3001munin server\u5074\u306b\u3042\u308blog\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u3067\u3001\u3042\u308b\u7a0b\u5ea6\u306e\u539f\u56e0\u3092\u3055\u3050\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30b0\u30e9\u30d5\u3084\u8a2d\u5b9a\u9805\u76ee\u306e\u8868\u793a\u3055\u308c\u306a\u3044\u7406\u7531\u306f\u3001\n\u30fb\u8a2d\u5b9a\u4e0d\u5099\n\u30fb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\uff08IPTABLES\u7b49\uff09\n\u306e\uff12\u30d1\u30bf\u30fc\u30f3\u304c\u591a\u3044\u3067\u3059\u3002\n\u3053\u3068\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u3089\u307f\u306e\u5834\u5408\u306f\u3001munin server\u304b\u3089\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306bport 4949\u3067\u758e\u901a\u304c\u3068\u308c\u308b\u306e\u304b\uff1f\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u5f53\u65b9\u306f\u3001VPC\u69cb\u6210\u3067\u3001public \u30bb\u30b0\u30e1\u30f3\u30c8(munin server\u5074\uff09\u3001private \u30bb\u30b0\u30e1\u30f3\u30c8(\u76e3\u8996\u30af\u30e9\u30a4\u30f3\u30c8\u5074\uff09\u306e\uff12\u3064\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c9\u30ec\u30b9(CIDR\u30d6\u30ed\u30c3\u30af\uff09\u3092\u6301\u3063\u3066\u3044\u305f\u305f\u3081\u3001\u7d50\u69cb\u30cf\u30de\u308a\u307e\u3057\u305f\u3002\u3002\n\nmunin\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u30dd\u30fc\u30c84949\u306blocal\u30db\u30b9\u30c8\u3067\u758e\u901a\u304c\u3068\u308c\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3002\n\nnmap localhost -p 4949\n\n\n\u6b21\u306bmunin\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u78ba\u8a8d\u3059\u308b\n\nnmap [\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eIP] -p 4949\n\n\u3061\u306a\u307f\u306b\u3001amazon ec2 (CPC\u69cb\u6210\uff09\u4e0a\u8a18\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\u5834\u5408\u306f\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eiptable\u30674949\u306e\u30dd\u30fc\u30c8\u304c\u901a\u3055\u306a\u3044\u3088\u3046\u306a\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u70ba\u3001\u3053\u308c\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002EC2\u306e\u5834\u5408\u306f\u3001SG\uff08\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\uff09\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u79c1\u306e\u5834\u5408\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u305d\u308c\u3067\u306f\u3001\u826f\u3044munin \u30e9\u30a4\u30d5\u3092\uff01\n# AWS EC2\u3067munin \u697d\u3005\u30ea\u30bd\u30fc\u30b9\u76e3\u8996 \u3057\u3088\u3046\uff01\n\n![munin.png](https://qiita-image-store.s3.amazonaws.com/0/37544/ee9c1e19-08d1-5fc8-a151-b8009edcc7ef.png)\n\naws \u3067\u76e3\u8996\u3068\u3044\u3048\u3070\u3001\u3082\u3061\u308d\u3093cloud watch !! \u306a\u3093\u3067\u3059\u304c\u3001\u4f8b\u3048\u3070\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3044\u3046\u3068\u3001rds \u3067\u7acb\u3066\u305f\u5834\u5408\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ea\u30bd\u30fc\u30b9\u76e3\u8996\u306f\u4e00\u901a\u308a\u63c3\u3063\u3066\u3044\u3066\u4fbf\u5229\u3067\u3059\u3088\u306d\uff1f\u3067\u308f\u3067\u308f\u3001\u4eca\u56de\u306e\u3088\u3046\u306bEC2\u3067 Mariadb 10.0 \u3092\u72ec\u81ea\u3067\u4f5c\u3063\u305f\u30fb\u306a\u3093\u3066\u8a00\u3063\u305f\u5834\u5408\u306f\u3001\u3044\u308d\u3044\u308d\u4e0d\u4fbf\u3060\u3063\u305f\u308a\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u4ed6\u306b\u3082\u3001redis\u3092\u72ec\u81ea\u3067\u7acb\u3066\u305f\u308a\u3001\u306a\u3093\u3068\u304b\u30df\u30c9\u30eb\u30a6\u30a7\u30a2\u3092\u5225\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u7acb\u3066\u305f\u308a\u3068\u304b\u3055\u307e\u3056\u307e\u306a\u8981\u4ef6\u304c\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u3001\u3053\u3053\u306f\u3001cloud watch \u3067\u3001\u3053\u3053\u306f\u3001\u5225\u306e\u76e3\u8996\u30c4\u30fc\u30eb\u3067\u306a\u3093\u3066\u3084\u3063\u3066\u3044\u305f\u3089\u3001\u30ea\u30bd\u30fc\u30b9\u76e3\u8996\u305d\u306e\u3082\u306e\u306e\u4e00\u8cab\u6027\u304c\u306a\u304f\u3066\u6df7\u4e71\u3068\u304b\u3057\u3061\u3083\u3044\u305d\u3046\u30fb\u30fb\n\n\u3063\u3066\u306a\u308f\u3051\u3067\u3001\u6bd4\u8f03\u7684\u306b\u7c21\u5358\u306b\u69cb\u7bc9\u3067\u304d\u308b\u3001munin\u3092\u4f7f\u3063\u3066\u3001\u3059\u3079\u3066\u306eec2 \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7d71\u5408\u76e3\u8996\u3067\u304d\u308b\u304b\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\uff01\n\n\u65e9\u901f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3092\u8aac\u660e\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u524d\u306b\u3084\u3063\u305f\u74b0\u5883\u306b\u3064\u3044\u3066\u3056\u3063\u304f\u308a\u8aac\u660e\u3057\u307e\u3059\u3002\n\n## \u691c\u8a3c\u3057\u305f\u74b0\u5883\n\n\u3053\u3093\u306a\u74b0\u5883\u3067\u691c\u8a3c\u3057\u3066\u307f\u307e\u3057\u305f\n\n\u30fb VPC\u69cb\u6210\u3067\u3001public \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30b0\u30e1\u30f3\u30c8(10.0.0.0/24)\u3068 private \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30bb\u30b0\u30e1\u30f3\u30c8(10.0.1.0/24)\u3092\u6301\u3063\u3066\u3044\u308b\n\u30fb munin \u30b5\u30fc\u30d0 \u306f\u30d1\u30d6\u30ea\u30c3\u30af\u30bb\u30b0\u30e1\u30f3\u30c8\u306b\u914d\u7f6e\u3057\u3066\u304a\u308a\u3001EIP\u3067public ip\u3092\u5272\u308a\u5f53\u3066\u3066\u3044\u308b(Private:10.0.0.111 Public: 52.5.72.111)\n\u30fb munin \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u306fpublic ip\u3092\u6301\u3063\u3066\u304a\u3089\u305a Mariadb 10.0 \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b(Private: 10.0.1.101)\n\n## epel \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3053\u306e\u4f5c\u696d\u306f\u3001amazon linux \u3067\u306f\u3001\u5fc5\u8981\u306a\u3055\u305d\u3046\u3067\u3059\u304c\u3001ec2 \u3058\u3083\u306a\u304f\u3066\u3001\u4ed6\u793eVPS\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3060\u3051\u306b\u8a18\u8f09\u3057\u3066\u304a\u308a\u307e\u3059\n\n```\ncd /tmp ; wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\nrpm -ivh epel-release-6-8.noarch.rpm\n# \u203bamazon linux \u306e\u5834\u5408\u306f\u3001epel \u5165\u3063\u3066\u3044\u308b\u3063\u307d\u306a\u306e\u3067\u3001\u4e0d\u8981\u3067\u3059\n\n```\n\n## apache\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3068\u308a\u3042\u3048\u305a\u3001\u306a\u306b\u3082\u8003\u3048\u306a\u3044\u3067\u3053\u308c\u306f\u5165\u308c\u3066\u304a\u304d\u307e\u3057\u3087\u3046\n\n```\nyum insrall httpd\n```\n\n## munin \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nyum --enablerepo=epel install munin munin-node\n```\n\n## apache\u306e\u8d77\u52d5\n\n```\n/etc/init.d/httpd start\n```\n\n## munin \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\n\n\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3057\u305f\u969b\u306e\u30ed\u30b0\u30a4\u30f3\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u307e\u3059\n\n```\ncd /etc/munin/\nhtpasswd -c munin-htpasswd \u4efb\u610f\u306e\u30e6\u30fc\u30b6\u30fc\u540d\nNew password: \u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\nRe-type new password: \u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\nAdding password for user \u4efb\u610f\u306e\u30e6\u30fc\u30b6\u30fc\u540d\n```\n\n\u3053\u3053\u307e\u3067\u304d\u3066\u3001\u30d6\u30e9\u30a6\u30b6\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\u3061\u306a\u307f\u306b\u30a2\u30af\u30bb\u30b9\u306f\u3067\u304d\u308b\u3051\u3069\n\u30c7\u30fc\u30bf\u306e\u53ce\u96c6\u306f\u307e\u3060\u958b\u59cb\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u3001\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3057\u304b\u30d1\u30fc\u30b9\u3055\u308c\u3066\u3053\u306a\u3044\u306f\u305a\u3067\u3059\u3002\n\n## munin.conf \u306e\u7de8\u96c6\n\n;\u3092\u631f\u3093\u3067\u5de6\u304c\u3001\u30b0\u30eb\u30fc\u30d7\u5206\u3051\u306e\u540d\u524d\u3001\u53f3\u304c\u76e3\u8996\u5bfe\u8c61\u30db\u30b9\u30c8\uff08\u30af\u30e9\u30a4\u30f3\u30c8\uff09\u306e\u8b58\u5225\u5b50\u3092\u8a18\u5165\u3057\u307e\u3059\naddress\u306f\u3001munin\u30af\u30e9\u30a4\u30f3\u30c8\uff08\u76e3\u8996\u3055\u308c\u308b\u5074\uff09\u306eipaddress\u3067\u3059\u306d (^_^)\n\n```\nvi /etc/munin/munin.conf\n---------------\n[dbms;db-mst01]                                                                                                                        address 10.0.1.101                                                                                                                      \nuse_node_name yes\n```\n\n# munin \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n## munin-node \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u306f\u3001\u5358\u7d14\u306b\u306f\u3001\u4e0a\u8a18munin.server\u306f\u3069\u3053\u304b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\n\n```\nyum --enablerepo=epel install munin-node\n```\n\n## munin-node.conf \u306e\u7de8\u96c6\n\n```\ncd /etc/munin\n\nvi munin-node.conf\n-----\nhost_name stat.myserver.com\ncidr_allow 127.0.0.1/32\ncidr_allow 10.0.0.0/24\n```\n\n## munin_client\u306e\u8d77\u52d5\n\n\u3072\u3068\u307e\u305a\u8d77\u52d5\u3057\u3066\u3001\u30d7\u30ed\u30bb\u30b9\u304c\u3042\u308b\u304b\u3092\u78ba\u8a8d\u3057\u3066\u307e\u3059\n\n```\n/etc/init.d/munin-node start\nps -efw | grep munin | grep -v grep\nroot     26959     1  0 07:44 ?        00:00:00 /usr/bin/perl -wT /usr/sbin/munin-node\n```\n\n## \u78ba\u8a8d\u3057\u305f\u3089\u4e00\u5ea6\u7d42\u4e86\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n/etc/init.d/munin-node stop\n```\n\n## munin MySQL\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n### \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nmunin MySQL \u30e2\u30b8\u30e5\u30fc\u30eb\u3068\u306f\u66f8\u304d\u307e\u3057\u305f\u304c\u3001\u5358\u7d14\u306b\u306f\u3001perl\u306eMySQL \u30c9\u30e9\u30a4\u30d0\u5468\u308a\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3060\u3051\u3067\u3059\n\u79c1\u306e\u5834\u5408\u306f\u3053\u3093\u306a\u306e\u3092\u5165\u308c\u307e\u3057\u305f\u3002\n\n```\nyum install --enablerepo=epel perl-IPC-ShareLite perl-Cache-Cache perl-Cache perl-DBD-MySQL\n```\n\n\n## MySQL(mariaDB\u306e\u63a5\u7d9a\u8a2d\u5b9a\uff09\n\n\u4eca\u56de\u306f\u3001root\u3092userid\u3068\u3057\u3066\u5229\u7528\u3057\u307e\u3057\u305f\u304c\u3001\u3042\u307e\u308adb\u3067root\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u5229\u7528\u3059\u308b\u306e\u306f\u3088\u304f\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u306e\u3067\n\u76e3\u8996\u5c02\u7528\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u3066\u305d\u308c\u3092\u8a2d\u5b9a\u3057\u305f\u307b\u3046\u304c\u3044\u3068\u601d\u3044\u30fb\u30fb\u30fb\u307e\u3059\u3002\n\n```\nvi /etc/munin/plugin-conf.d/munin-node\n------------------------------------------\n[mysql*]\nenv.mysqlopts -u root -p\u30d1\u30b9\u30ef\u30fc\u30c9\nenv.mysqladmin /usr/bin/mysqladmin\nenv.mysqlconnection DBI:mysql:mysql;host=127.0.0.1;port=3306\nenv.mysqluser root\nenv.mysqlpassword \u30d1\u30b9\u30ef\u30fc\u30c9\n------------------------------------------\n```\n\n## mysql\u306eplugin\u3092\u8a2d\u5b9a\n\nmunin\u3067\u76e3\u8996\u9805\u76ee\u3092\u8ffd\u52a0\u3059\u308b\u65b9\u6cd5\u306f\u5358\u7d14\u306b/usr/share/munin/plugins/\u304b\u3089\u3001/etc/munin/plugins\u306b\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u8cbc\u308b\u3060\u3051\u3067\u3059\u4eca\u56de\u306fmysql(mariadb)\n\n```\ncd /etc/munin/plugins\nln -s /usr/share/munin/plugins/mysql_ mysql_commands\nln -s /usr/share/munin/plugins/mysql_ mysql_innodb_bpool\nln -s /usr/share/munin/plugins/mysql_ mysql_innodb_io\nln -s /usr/share/munin/plugins/mysql_ mysql_innodb_log\nln -s /usr/share/munin/plugins/mysql_ mysql_innodb_tnx\nln -s /usr/share/munin/plugins/mysql_ mysql_select_types\nln -s /usr/share/munin/plugins/mysql_ mysql_table_locks\nln -s /usr/share/munin/plugins/mysql_ mysql_connections\nln -s /usr/share/munin/plugins/mysql_ mysql_slow\nln -s /usr/share/munin/plugins/mysql_ mysql_myisam_indexes\nln -s /usr/share/munin/plugins/mysql_ mysql_network_traffic\nln -s /usr/share/munin/plugins/mysql_ mysql_qcache\nln -s /usr/share/munin/plugins/mysql_ mysql_qcache_mem\n```\n\n```\n/etc/init.d/munin-node start\n/sbin/chkconfig/munin-node on\n```\n\n## mariadb\u306b\u6b63\u5e38\u306b\u63a5\u7d9a\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3059\u308b\n\n\u3053\u3093\u306a\u30a8\u30e9\u30fc\u306b\u306a\u3063\u305f\u306e\u3067\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\u3042\u308c\u308c\u308c\u30fb\u30fb\n\n```\n/usr/sbin/munin-run mysql_commands\nUnknown section: INDIVIDUAL BUFFER POOL INFO at /etc/munin/plugins/mysql_commands line 1098.\n```\n\n\u3069\u3046\u3082\u3001maria\u3067\u8a8d\u8b58\u3055\u308c\u306a\u3044\u30b3\u30de\u30f3\u30c9\u304c\u3042\u308b\u6a21\u69d8\u3067 /usr/share/munin/plugins/mysql_ \u306e\u30a8\u30e9\u30fc\u5bfe\u8c61\u884c\u4ed8\u8fd1\u306b\u3042\u308b\u3001\u4e0b\u8a18\u9805\u76ee\u306b\n\n```\n'INDIVIDUAL BUFFER POOL INFO'   => \\&skip,\n```\n\n\u3068\u3044\u3046\u884c\u3092\u4e0b\u8a18\u3042\u305f\u308a\u306b\u8ffd\u8a18\u3057\u3066\u304f\u308c\u308c\u3070\u89e3\u6c7a\u3057\u307e\u3059\n\n\n```\nvi /usr/share/munin/plugins/mysql_\n---------------------------------\n    my %section_map = (\n\n        'BUFFER POOL AND MEMORY'   => \\&parse_buffer_pool_and_memory,\n        'FILE I/O'                 => \\&parse_file_io,\n        'INSERT BUFFER AND ADAPTIVE HASH INDEX'\n            => \\&parse_insert_buffer_and_adaptive_hash_index,\n        'LATEST DETECTED DEADLOCK' => \\&skip,\n        'LATEST FOREIGN KEY ERROR' => \\&skip,\n        'LOG'                      => \\&parse_log,\n        'ROW OPERATIONS'           => \\&skip,\n        'SEMAPHORES'               => \\&parse_semaphores,\n        'TRANSACTIONS'             => \\&parse_transactions,\n        'BACKGROUND THREAD'        => \\&skip,\n        'INDIVIDUAL BUFFER POOL INFO'   => \\&skip,    # \u2192 \u3053\u308c\u3092\u8ffd\u8a18                                                                    \n    );\n---------------------------------\n```\n\n## \u518d\u5ea6\u30c1\u30e3\u30ec\u30f3\u30b8\n\n\u3069\u3046\u3067\u3057\u3087\u3046\uff1f\u304d\u3063\u3068\u4eca\u56de\u306f\u3046\u307e\u304f\u3044\u3063\u305f\u304b\u3068\u601d\u3044\u307e\u3059\n\n```\n/usr/sbin/munin-run mysql_commands\nCom_delete.value 1371\nCom_insert.value 3896\nCom_insert_select.value 0\nCom_load.value 0\nCom_replace.value 0\nCom_replace_select.value 0\nCom_select.value 1419070\nCom_update.value 6555\nCom_update_multi.value 0\n```\n\n\n## \u76e3\u8996\u9805\u76ee\u3067\u4e0d\u8981\u306a\u3082\u306e\u3092\u524a\u9664\u3057\u305f\u3044\u5834\u5408\n\n\u3076\u3063\u3061\u3083\u3051\u898b\u306a\u3044\u3082\u306e\u3092\u304c\u3093\u304c\u3093\u30b0\u30e9\u30d5\u8868\u793a\u3059\u308b\u306e\u3082\u306e\u3057\u3093\u3069\u3044\u306e\u3067\u3001\u3044\u3089\u306a\u3044\u30b0\u30e9\u30d5\u306f\u6d88\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n```\ncd /etc/munin/plugins/\nll\n\u5408\u8a08 0\nlrwxrwxrwx 1 root root 28  4\u6708  8 07:02 cpu -> /usr/share/munin/plugins/cpu\nlrwxrwxrwx 1 root root 27  4\u6708  8 07:02 df -> /usr/share/munin/plugins/df\nlrwxrwxrwx 1 root root 33  4\u6708  8 07:02 df_inode -> /usr/share/munin/plugins/df_inode\nlrwxrwxrwx 1 root root 34  4\u6708  8 07:02 diskstats -> /usr/share/munin/plugins/diskstats\nlrwxrwxrwx 1 root root 32  4\u6708  8 07:02 entropy -> /usr/share/munin/plugins/entropy\nlrwxrwxrwx 1 root root 30  4\u6708  8 07:02 forks -> /usr/share/munin/plugins/forks\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 fw_packets -> /usr/share/munin/plugins/fw_packets\nlrwxrwxrwx 1 root root 32  4\u6708  8 07:02 if_err_eth0 -> /usr/share/munin/plugins/if_err_\nlrwxrwxrwx 1 root root 28  4\u6708  8 07:02 if_eth0 -> /usr/share/munin/plugins/if_\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 interrupts -> /usr/share/munin/plugins/interrupts\nlrwxrwxrwx 1 root root 33  4\u6708  8 07:02 irqstats -> /usr/share/munin/plugins/irqstats\nlrwxrwxrwx 1 root root 29  4\u6708  8 07:02 load -> /usr/share/munin/plugins/load\nlrwxrwxrwx 1 root root 31  4\u6708  8 07:02 memory -> /usr/share/munin/plugins/memory\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_commands -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_connections -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_innodb_bpool -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_innodb_io -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_innodb_log -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_innodb_tnx -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_myisam_indexes -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_network_traffic -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_qcache -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_qcache_mem -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_select_types -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_slow -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 31  4\u6708  8 09:02 mysql_table_locks -> /usr/share/munin/plugins/mysql_\nlrwxrwxrwx 1 root root 32  4\u6708  8 07:02 netstat -> /usr/share/munin/plugins/netstat\nlrwxrwxrwx 1 root root 36  4\u6708  8 07:02 nfs4_client -> /usr/share/munin/plugins/nfs4_client\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 nfs_client -> /usr/share/munin/plugins/nfs_client\nlrwxrwxrwx 1 root root 39  4\u6708  8 07:02 ntp_kernel_err -> /usr/share/munin/plugins/ntp_kernel_err\nlrwxrwxrwx 1 root root 44  4\u6708  8 07:02 ntp_kernel_pll_freq -> /usr/share/munin/plugins/ntp_kernel_pll_freq\nlrwxrwxrwx 1 root root 43  4\u6708  8 07:02 ntp_kernel_pll_off -> /usr/share/munin/plugins/ntp_kernel_pll_off\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 ntp_offset -> /usr/share/munin/plugins/ntp_offset\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 ntp_states -> /usr/share/munin/plugins/ntp_states\nlrwxrwxrwx 1 root root 35  4\u6708  8 07:02 open_files -> /usr/share/munin/plugins/open_files\nlrwxrwxrwx 1 root root 36  4\u6708  8 07:02 open_inodes -> /usr/share/munin/plugins/open_inodes\nlrwxrwxrwx 1 root root 33  4\u6708  8 07:02 proc_pri -> /usr/share/munin/plugins/proc_pri\nlrwxrwxrwx 1 root root 34  4\u6708  8 07:02 processes -> /usr/share/munin/plugins/processes\nlrwxrwxrwx 1 root root 43  4\u6708  8 07:02 sendmail_mailqueue -> /usr/share/munin/plugins/sendmail_mailqueue\nlrwxrwxrwx 1 root root 43  4\u6708  8 07:02 sendmail_mailstats -> /usr/share/munin/plugins/sendmail_mailstats\nlrwxrwxrwx 1 root root 45  4\u6708  8 07:02 sendmail_mailtraffic -> /usr/share/munin/plugins/sendmail_mailtraffic\nlrwxrwxrwx 1 root root 29  4\u6708  8 07:02 swap -> /usr/share/munin/plugins/swap\nlrwxrwxrwx 1 root root 32  4\u6708  8 07:02 threads -> /usr/share/munin/plugins/threads\nlrwxrwxrwx 1 root root 31  4\u6708  8 07:02 uptime -> /usr/share/munin/plugins/uptime\nlrwxrwxrwx 1 root root 30  4\u6708  8 07:02 users -> /usr/share/munin/plugins/users\nlrwxrwxrwx 1 root root 31  4\u6708  8 07:02 vmstat -> /usr/share/munin/plugins/vmstat\n```\n\n* \u79c1\u306e\u5834\u5408\u3001\u4e0b\u8a18\u3092\u6d88\u3057\u307e\u3057\u305f\u3002\u6d88\u3059\u30fb\u30fb\u3068\u3044\u3063\u3066\u3082\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\u3092\u5916\u3057\u305f\u3060\u3051\u3063\u3059\n\n```\nunlink sendmail_mailqueue \nunlink sendmail_mailstats\nunlink sendmail_mailtraffic\nunlink users\nunlink threads\nunlink proc_pri\nunlink entropy\nunlink irqstats\nunlink forks\nunlink interrupts\nunlink ntp_offset\nunlink ntp_kernel_pll_off\nunlink ntp_kernel_pll_freq\nunlink ntp_kernel_err\nunlink if_err_eth0\nunlink if_err_eth1\nunlink ntp_states\nunlink fw_conntrack\nunlink fw_forwarded_local\nunlink fw_packets\nunlink postfix_mailqueue\nunlink postfix_mailvolume\nunlink proc_pri\n```\n\n## \u8d77\u52d5\u3057\u3066\u307f\u307e\u3057\u3087\u3046\n\n\u4e00\u901a\u308a\u306e\u8a2d\u5b9a\u304c\u6e08\u3093\u3060\u3068\u3053\u308d\u3067 \u8d77\u52d5\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n/etc/init.d/munin-node start\n/sbin/chkconfig munin-node on\n```\n\n## WEB\u3092\u78ba\u8a8d\u3057\u3066\u307f\u3088\u3046\n\nmunin\u30b5\u30fc\u30d0\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u53e9\u3044\u3066\u3001\u30d6\u30e9\u30a6\u30b6\u3067\u5bfe\u8c61\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30ea\u30bd\u30fc\u30b9\u72b6\u6cc1\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\uff01\n\n\n### \u3053\u3093\u306a\u611f\u3058\u306b\u306a\u3063\u3066\u3044\u308c\u3070\u3001\u30aa\u30c3\u30b1\u30fc\u3067\u3059\uff01\uff01\n\n![2015-04-09_103950.jpg](https://qiita-image-store.s3.amazonaws.com/0/37544/10d9f0c9-798b-98eb-79c7-ec4d823f5f3a.jpeg)\n\n## \u4e0a\u8a18\u306e\u3088\u3046\u306b\u9805\u76ee\u304c\u51fa\u3066\u3053\u306a\u3044\u5834\u5408\n\nmunin\u306f\u3001munin server\u5074\u304b\u3089\u76e3\u8996\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5024\u3092cron\u3092\u5229\u7528\u3057\u3066\u8aad\u307f\u53d6\u308b\u3057\u304f\u307f\u306b\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\u306a\u306e\u3067\u3001\u8a2d\u5b9a\u3057\u305f\u306f\u305a\u306a\u306e\u306b\u8868\u793a\u3055\u308c\u3066\u3053\u306a\u3044\uff01\u306a\u3093\u3066\u5834\u5408\u306f\u3001munin server\u5074\u306b\u3042\u308blog\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u3067\u3001\u3042\u308b\u7a0b\u5ea6\u306e\u539f\u56e0\u3092\u3055\u3050\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30b0\u30e9\u30d5\u3084\u8a2d\u5b9a\u9805\u76ee\u306e\u8868\u793a\u3055\u308c\u306a\u3044\u7406\u7531\u306f\u3001\n\n\u30fb\u8a2d\u5b9a\u4e0d\u5099\n\u30fb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8a2d\u5b9a\uff08IPTABLES\u7b49\uff09\n\n\u306e\uff12\u30d1\u30bf\u30fc\u30f3\u304c\u591a\u3044\u3067\u3059\u3002\n\n\u3053\u3068\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u3089\u307f\u306e\u5834\u5408\u306f\u3001munin server\u304b\u3089\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306bport 4949\u3067\u758e\u901a\u304c\u3068\u308c\u308b\u306e\u304b\uff1f\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u5f53\u65b9\u306f\u3001VPC\u69cb\u6210\u3067\u3001public \u30bb\u30b0\u30e1\u30f3\u30c8(munin server\u5074\uff09\u3001private \u30bb\u30b0\u30e1\u30f3\u30c8(\u76e3\u8996\u30af\u30e9\u30a4\u30f3\u30c8\u5074\uff09\u306e\uff12\u3064\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a2\u30c9\u30ec\u30b9(CIDR\u30d6\u30ed\u30c3\u30af\uff09\u3092\u6301\u3063\u3066\u3044\u305f\u305f\u3081\u3001\u7d50\u69cb\u30cf\u30de\u308a\u307e\u3057\u305f\u3002\u3002\n\n* munin\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u30dd\u30fc\u30c84949\u306blocal\u30db\u30b9\u30c8\u3067\u758e\u901a\u304c\u3068\u308c\u308b\u304b\u78ba\u8a8d\u3059\u308b\u3002\n\n```\nnmap localhost -p 4949\n```\n\n\n* \u6b21\u306bmunin\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u78ba\u8a8d\u3059\u308b\n\n```\nnmap [\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eIP] -p 4949\n```\n\n\u3061\u306a\u307f\u306b\u3001amazon ec2 (CPC\u69cb\u6210\uff09\u4e0a\u8a18\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\u5834\u5408\u306f\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306eiptable\u30674949\u306e\u30dd\u30fc\u30c8\u304c\u901a\u3055\u306a\u3044\u3088\u3046\u306a\u8a2d\u5b9a\u306b\u306a\u3063\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u70ba\u3001\u3053\u308c\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002EC2\u306e\u5834\u5408\u306f\u3001SG\uff08\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\uff09\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u79c1\u306e\u5834\u5408\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u3057\u307e\u3057\u305f\u3002\n\n![sg.jpg](https://qiita-image-store.s3.amazonaws.com/0/37544/055e9fe1-ac53-0d7d-3c1c-dcec2129c2e8.jpeg)\n\n\n\u305d\u308c\u3067\u306f\u3001\u826f\u3044munin \u30e9\u30a4\u30d5\u3092\uff01\n"}