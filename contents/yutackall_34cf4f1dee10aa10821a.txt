{"tags": ["Rails44.0.4", "Ruby2.1.1", "ActiveRecord4.0.4"], "context": " More than 1 year has passed since last update.\n\n\u3084\u308a\u305f\u3044\u3053\u3068\nRails \u3067 API \u30b5\u30fc\u30d0\u30fc\u3068\u304b\u4f5c\u3063\u3066\u308b\u3068\u3001\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u969b\u3001\u4e00\u65e6 id \u306e\u914d\u5217\u3060\u3051\u3092\u8fd4\u3057\u3066\u3001\n\u5b9f\u30c7\u30fc\u30bf\u306f\u5225\u9014\u305d\u306e id \u306e\u914d\u5217\u3092\u9001\u4fe1\u3057\u3066\u53d6\u5f97\u3059\u308b\u307f\u305f\u3044\u306a\u51e6\u7406\u3092\u3084\u308b\u3053\u3068\u304c\u591a\u3005\u3042\u308b\u3002\n\u305d\u306e\u8fd4\u5374\u3057\u305f id \u306e\u914d\u5217\u306e\u9806\u5e8f\u306b\u610f\u5473\u304c\u3042\u308b\u5834\u5408\u3001\u305d\u306e\u307e\u307e\u5358\u7d14\u306b ActiveRecord \u3067\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u3068\u3001\nid \u9806 ( scope \u3067\u9806\u5e8f\u3092\u6307\u5b9a\u3057\u3066\u308b\u3068\u305d\u308c\u9806 ) \u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u305d\u308c\u3092\u3082\u3089\u3063\u305f id \u306e\u914d\u5217\u9806\u3067\u30c7\u30fc\u30bf\u3092\n\u8fd4\u5374\u3059\u308b\u969b\u306e\u3084\u308a\u65b9\u3092\u8abf\u3079\u305f\u969b\u306e\u30e1\u30e2\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u30e6\u30fc\u30b6\u30fc\u306e id \u306e\u914d\u5217\u3092\u30a2\u30af\u30bb\u30b9\u65e5\u6642\u306e\u964d\u9806\u3067\u8fd4\u5374\u3059\u308b\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 ( ids ) \u304c\u3042\u3063\u3066\u3001\nids \u9806\u3069\u304a\u308a\u306b\u3001\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u8fd4\u5374\u3059\u308b\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 ( lookup ) \u306e\u5834\u5408\n\napp/users_controller.rb\nclass UsersController < ApplicationController\n\n  # GET /users/ids\n  def ids\n    @users = User.all.order(accessced_at: :desc)\n    render json: @users.pluck(:id)\n  end\n\n  # GET /users/lookup?ids[]=1&ids[]=2\n  def lookup\n    @users = User.where(id: params[:ids]).sort_by{|c| params[:ids].map(&:to_i).index(c.id)}\n    # view \u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u524d\u63d0\u3067\u3059\u3002\n    # app/views/users/lookup.json.jbuilder\n  end\nend\n\n\nparams[:ids].map(&:to_i)\u306b\u3064\u3044\u3066\u306f\u3001JSON \u3092 POST \u3059\u308b\u5834\u5408 ( \"ids\": [1,2,3] ) \u306a\u3069\u306f\u3001\nprams[:ids] \u306e\u4e2d\u8eab\u306f\u6570\u5024\u306e\u914d\u5217 ( [1,2,3] ) \u306a\u3093\u3060\u3051\u3069\u3001GET \u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u306e\u5834\u5408\u306f\u3001[\"1\",\"2\",\"3\"] \u3068\u6587\u5b57\u5217\u3067\u53d7\u3051\u53d6\u308b\u306e\u3067\u3001GET \u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u3082\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306b map \u3067\u6570\u5024\u306b\u5909\u63db\u3057\u3066\u307e\u3059\u3002\n# \u3084\u308a\u305f\u3044\u3053\u3068\n\nRails \u3067 API \u30b5\u30fc\u30d0\u30fc\u3068\u304b\u4f5c\u3063\u3066\u308b\u3068\u3001\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u969b\u3001\u4e00\u65e6 id \u306e\u914d\u5217\u3060\u3051\u3092\u8fd4\u3057\u3066\u3001\n\u5b9f\u30c7\u30fc\u30bf\u306f\u5225\u9014\u305d\u306e id \u306e\u914d\u5217\u3092\u9001\u4fe1\u3057\u3066\u53d6\u5f97\u3059\u308b\u307f\u305f\u3044\u306a\u51e6\u7406\u3092\u3084\u308b\u3053\u3068\u304c\u591a\u3005\u3042\u308b\u3002\n\n\u305d\u306e\u8fd4\u5374\u3057\u305f id \u306e\u914d\u5217\u306e\u9806\u5e8f\u306b\u610f\u5473\u304c\u3042\u308b\u5834\u5408\u3001\u305d\u306e\u307e\u307e\u5358\u7d14\u306b ActiveRecord \u3067\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u3068\u3001\nid \u9806 ( scope \u3067\u9806\u5e8f\u3092\u6307\u5b9a\u3057\u3066\u308b\u3068\u305d\u308c\u9806 ) \u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u305d\u308c\u3092\u3082\u3089\u3063\u305f id \u306e\u914d\u5217\u9806\u3067\u30c7\u30fc\u30bf\u3092\n\u8fd4\u5374\u3059\u308b\u969b\u306e\u3084\u308a\u65b9\u3092\u8abf\u3079\u305f\u969b\u306e\u30e1\u30e2\u3002\n\n# \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u30e6\u30fc\u30b6\u30fc\u306e id \u306e\u914d\u5217\u3092\u30a2\u30af\u30bb\u30b9\u65e5\u6642\u306e\u964d\u9806\u3067\u8fd4\u5374\u3059\u308b\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 ( ids ) \u304c\u3042\u3063\u3066\u3001\nids \u9806\u3069\u304a\u308a\u306b\u3001\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u8fd4\u5374\u3059\u308b\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 ( lookup ) \u306e\u5834\u5408\n\n```ruby:app/users_controller.rb\nclass UsersController < ApplicationController\n\n  # GET /users/ids\n  def ids\n    @users = User.all.order(accessced_at: :desc)\n    render json: @users.pluck(:id)\n  end\n\n  # GET /users/lookup?ids[]=1&ids[]=2\n  def lookup\n    @users = User.where(id: params[:ids]).sort_by{|c| params[:ids].map(&:to_i).index(c.id)}\n    # view \u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u524d\u63d0\u3067\u3059\u3002\n    # app/views/users/lookup.json.jbuilder\n  end\nend\n```\n\n`params[:ids].map(&:to_i)`\u306b\u3064\u3044\u3066\u306f\u3001JSON \u3092 POST \u3059\u308b\u5834\u5408 ( `\"ids\": [1,2,3]` ) \u306a\u3069\u306f\u3001\n`prams[:ids]` \u306e\u4e2d\u8eab\u306f\u6570\u5024\u306e\u914d\u5217 ( `[1,2,3]` ) \u306a\u3093\u3060\u3051\u3069\u3001GET \u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u306e\u5834\u5408\u306f\u3001`[\"1\",\"2\",\"3\"]` \u3068\u6587\u5b57\u5217\u3067\u53d7\u3051\u53d6\u308b\u306e\u3067\u3001GET \u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u3082\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306b map \u3067\u6570\u5024\u306b\u5909\u63db\u3057\u3066\u307e\u3059\u3002\n"}