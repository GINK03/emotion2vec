{"tags": ["RaspberryPi", "WiFi", "Linux"], "context": "\n\nCross Compile MT7610U Driver for RPi2/3\nPLANEX\u88fd\u306eGW-450D\u306fMT7610U\u3068\u3044\u3046\u30c1\u30c3\u30d7\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\u3001Linux\u30c9\u30e9\u30a4\u30d0\u306f\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001RaspberryPi\u3067\u3082\u4f7f\u3046\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u30cd\u30a4\u30c6\u30a3\u30d6\u30d3\u30eb\u30c9\u306e\u60c5\u5831\u306f\u305f\u304f\u3055\u3093\u3042\u308a\u307e\u3057\u305f\u304c\u3001\u30af\u30ed\u30b9\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u60c5\u5831\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u308a\u307e\u3057\u305f\u3002\u30cd\u30a4\u30c6\u30a3\u30d6\u30d3\u30eb\u30c9\u3060\u3068\u4e0b\u624b\u3059\u308b\u3068\u6570\u6642\u9593\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067\u3001\u3053\u3061\u3089\u306e\u65b9\u6cd5\u306e\u65b9\u304c\u697d\u3060\u3068\u601d\u3044\u307e\u3059\u3002\nRaspberryPi3\u3068\u30ab\u30fc\u30cd\u30eb\u30d0\u30fc\u30b8\u30e7\u30f34.4\u306e\u74b0\u5883\u3067\u30c6\u30b9\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305a\u4f5c\u696d\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u3063\u3066\u304a\u304d\u307e\u3059\u3002\n$ mkdir bcm-staging\n$ export WORK=`pwd`/bcm-staging\n\n\nRPi2/3 Kernel\n\u307e\u305a\u30ab\u30fc\u30cd\u30eb\u3092\u30af\u30ed\u30b9\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\u3002\u57fa\u672c\u7684\u306b\u516c\u5f0f\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u624b\u9806\u3068\u4e00\u7dd2\u3067\u3059\u3002\n\nSetup toolchain\n\u516c\u5f0f\u306e\u30c4\u30fc\u30eb\u30c1\u30a7\u30a4\u30f3\u3092\u843d\u3068\u3057\u3066\u304d\u3066PATH\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n$ cd ${WORK}\n$ git clone https://github.com/raspberrypi/tools\n$ export PATH=${PATH}:`pwd`/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin\n\n\nBuild\n\u3053\u3061\u3089\u306e\u30d3\u30eb\u30c9\u65b9\u6cd5\u306f\u516c\u5f0f\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u624b\u9806\u3068\u4e00\u7dd2\u3067\u3059\u3002\n$ cd ${WORK}\n$ git clone -b rpi-4.4.y https://github.com/raspberrypi/linux.git\n$ cd linux\n$ export KERNEL=kernel7\n$ export ARCH=arm\n$ export CROSS_COMPILE=arm-linux-gnueabihf-\n$ make bcm2709_defconfig\n$ make -j 4 zImage modules dtbs\n\n\nMT7610U Driver\n\nBuild\n\u516c\u5f0f\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u30c9\u30e9\u30a4\u30d0\u306bRPi\u7528\u306b\u3059\u3053\u3057\u624b\u3092\u52a0\u3048\u305f\u3082\u306e\u3092\u843d\u3068\u3057\u3066\u304d\u3066\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\uff08\u30c4\u30fc\u30eb\u30c1\u30a7\u30a4\u30f3\u306ePATH\u304c\u901a\u3063\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\uff09\n$ cd ${WORK}\n$ git clone -b rpi https://github.com/FantomJAC/mt7610u_wifi_sta_v3002_dpo_20130916.git\n$ cd mt7610u_wifi_sta_v3002_dpo_20130916\n$ export PI_SRC=${WORK}/linux\n$ make\n\n\nInstall\n\u30c9\u30e9\u30a4\u30d0\u30d5\u30a1\u30a4\u30eb\u3092RaspberryPi\u306erootfs\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\uff08${RPI_ROOTFS}\u306f\u9069\u6642\u8a2d\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\uff09\n\u672c\u6765\u3067\u3042\u308c\u3070\u4e0a\u8a18\u624b\u9806\u3067\u30d3\u30eb\u30c9\u3057\u305f\u30ab\u30fc\u30cd\u30eb\u3092\u4e00\u7dd2\u306b\u4f7f\u7528\u3059\u3079\u304d\u3067\u3059\u304c\u3001\u30ab\u30fc\u30cd\u30eb\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c4.4\u307e\u3067\u4e00\u81f4\u3057\u3066\u3044\u308c\u3070\u5927\u4f53\u52d5\u304d\u307e\u3059\u3002\n$ cp ./os/linux/mt7650u_sta.ko ${RPI_ROOTFS}/modules/4.4.21-v7+\n$ mkdir -p ${RPI_ROOTFS}/etc/Wireless/RT2870STA\n$ cp RT2870STA.dat ${RPI_ROOTFS}/etc/Wireless/RT2870STA\n\n/etc/network/interfaces\u306b\u4ee5\u4e0b\u306e\u884c\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\nallow-hotplug ra0\niface ra0 inet manual\n    wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf\n\nRaspberryPi\u4e0a\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n# depmod -a\n\n# Cross Compile MT7610U Driver for RPi2/3\nPLANEX\u88fd\u306eGW-450D\u306fMT7610U\u3068\u3044\u3046\u30c1\u30c3\u30d7\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\u3001Linux\u30c9\u30e9\u30a4\u30d0\u306f\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001RaspberryPi\u3067\u3082\u4f7f\u3046\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n\u30cd\u30a4\u30c6\u30a3\u30d6\u30d3\u30eb\u30c9\u306e\u60c5\u5831\u306f\u305f\u304f\u3055\u3093\u3042\u308a\u307e\u3057\u305f\u304c\u3001\u30af\u30ed\u30b9\u30b3\u30f3\u30d1\u30a4\u30eb\u306e\u60c5\u5831\u304c\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u308a\u307e\u3057\u305f\u3002\u30cd\u30a4\u30c6\u30a3\u30d6\u30d3\u30eb\u30c9\u3060\u3068\u4e0b\u624b\u3059\u308b\u3068\u6570\u6642\u9593\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067\u3001\u3053\u3061\u3089\u306e\u65b9\u6cd5\u306e\u65b9\u304c\u697d\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\nRaspberryPi3\u3068\u30ab\u30fc\u30cd\u30eb\u30d0\u30fc\u30b8\u30e7\u30f34.4\u306e\u74b0\u5883\u3067\u30c6\u30b9\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u307e\u305a\u4f5c\u696d\u7528\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u3063\u3066\u304a\u304d\u307e\u3059\u3002\n\n```\n$ mkdir bcm-staging\n$ export WORK=`pwd`/bcm-staging\n```\n## RPi2/3 Kernel\n\u307e\u305a\u30ab\u30fc\u30cd\u30eb\u3092\u30af\u30ed\u30b9\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u307e\u3059\u3002\u57fa\u672c\u7684\u306b\u516c\u5f0f\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u624b\u9806\u3068\u4e00\u7dd2\u3067\u3059\u3002\n\n### Setup toolchain\n\u516c\u5f0f\u306e\u30c4\u30fc\u30eb\u30c1\u30a7\u30a4\u30f3\u3092\u843d\u3068\u3057\u3066\u304d\u3066PATH\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```\n$ cd ${WORK}\n$ git clone https://github.com/raspberrypi/tools\n$ export PATH=${PATH}:`pwd`/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin\n```\n### Build\n\u3053\u3061\u3089\u306e\u30d3\u30eb\u30c9\u65b9\u6cd5\u306f\u516c\u5f0f\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u624b\u9806\u3068\u4e00\u7dd2\u3067\u3059\u3002\n\n```\n$ cd ${WORK}\n$ git clone -b rpi-4.4.y https://github.com/raspberrypi/linux.git\n$ cd linux\n$ export KERNEL=kernel7\n$ export ARCH=arm\n$ export CROSS_COMPILE=arm-linux-gnueabihf-\n$ make bcm2709_defconfig\n$ make -j 4 zImage modules dtbs\n```\n## MT7610U Driver\n### Build\n\u516c\u5f0f\u3067\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u30c9\u30e9\u30a4\u30d0\u306bRPi\u7528\u306b\u3059\u3053\u3057\u624b\u3092\u52a0\u3048\u305f\u3082\u306e\u3092\u843d\u3068\u3057\u3066\u304d\u3066\u30d3\u30eb\u30c9\u3057\u307e\u3059\u3002\uff08\u30c4\u30fc\u30eb\u30c1\u30a7\u30a4\u30f3\u306ePATH\u304c\u901a\u3063\u3066\u3044\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\uff09\n\n```\n$ cd ${WORK}\n$ git clone -b rpi https://github.com/FantomJAC/mt7610u_wifi_sta_v3002_dpo_20130916.git\n$ cd mt7610u_wifi_sta_v3002_dpo_20130916\n$ export PI_SRC=${WORK}/linux\n$ make\n```\n### Install\n\u30c9\u30e9\u30a4\u30d0\u30d5\u30a1\u30a4\u30eb\u3092RaspberryPi\u306erootfs\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\uff08${RPI_ROOTFS}\u306f\u9069\u6642\u8a2d\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\uff09\n\n*\u672c\u6765\u3067\u3042\u308c\u3070\u4e0a\u8a18\u624b\u9806\u3067\u30d3\u30eb\u30c9\u3057\u305f\u30ab\u30fc\u30cd\u30eb\u3092\u4e00\u7dd2\u306b\u4f7f\u7528\u3059\u3079\u304d\u3067\u3059\u304c\u3001\u30ab\u30fc\u30cd\u30eb\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c4.4\u307e\u3067\u4e00\u81f4\u3057\u3066\u3044\u308c\u3070\u5927\u4f53\u52d5\u304d\u307e\u3059\u3002*\n\n```\n$ cp ./os/linux/mt7650u_sta.ko ${RPI_ROOTFS}/modules/4.4.21-v7+\n$ mkdir -p ${RPI_ROOTFS}/etc/Wireless/RT2870STA\n$ cp RT2870STA.dat ${RPI_ROOTFS}/etc/Wireless/RT2870STA\n```\n\n/etc/network/interfaces\u306b\u4ee5\u4e0b\u306e\u884c\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\nallow-hotplug ra0\niface ra0 inet manual\n    wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf\n```\n\nRaspberryPi\u4e0a\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n# depmod -a\n```\n"}