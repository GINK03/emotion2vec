{"context": "\n\n[\u4f8b]DB\u306b\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u5168\u3066\u306e\u9867\u5ba2\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3001CSV\u3067\u51fa\u529b\u3057\u305f\u3044\n\nJSP\n\nsample.jsp\n<button type=\"button\" onclick=\"location.href='${pageContext.request.contextPath}/csvDownload'\">\n\u3000\u3000\u3000\u3000\u3000\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u4e00\u62ec\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9(csv)</button>\n\n\n\nController\n\nController.java\n    /**\n     * \u30e6\u30fc\u30b6\u30fc\u60c5\u5831csv\u5f62\u5f0f\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n     */\n    @RequestMapping(\"csvDownload\")\n    public void csvDownload(HttpServletResponse response) {\n\n        //\u6587\u5b57\u30b3\u30fc\u30c9\u3068\u51fa\u529b\u3059\u308bCSV\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u8a2d\u5b9a\n        response.setContentType(MimeTypeUtils.APPLICATION_OCTET_STREAM_VALUE + \";charset=utf-8\");\n        response.setHeader(\"Content-Disposition\", \"attachment; filename=\\\"test.csv\\\"\");\n\n        //try-with-resources\u6587\u3092\u4f7f\u3046\u3053\u3068\u3067close\u51e6\u7406\u3092\u81ea\u52d5\u5316\n        try (PrintWriter pw = response.getWriter()) {\n            List<User> all_users = service.findAll();\n            for (int i = 0; i < all_users.size(); i++) {\n                long id = all_users.get(i).getId();\n                String name = all_users.get(i).getName();\n                String email = all_users.get(i).getEmail();\n                String password = all_users.get(i).getPassword();\n                String address = all_users.get(i).getAddress();\n                String telephone = all_users.get(i).getTelephone();\n\n                //CSV\u30d5\u30a1\u30a4\u30eb\u5185\u90e8\u306b\u8a18\u8f09\u3059\u308b\u5f62\u5f0f\u3067\u6587\u5b57\u5217\u3092\u8a2d\u5b9a\n                String outputString = id + \",\" + name + \",\" + email + \",\" + password + \",\" + address + \",\" + telephone\n                         + \"\\r\\n\";\n\n                //CSV\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u307f\n                pw.print(outputString);\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n\n\n#[\u4f8b]DB\u306b\u767b\u9332\u3055\u308c\u3066\u3044\u308b\u5168\u3066\u306e\u9867\u5ba2\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3001CSV\u3067\u51fa\u529b\u3057\u305f\u3044\n\n##JSP\n```sample.jsp\n<button type=\"button\" onclick=\"location.href='${pageContext.request.contextPath}/csvDownload'\">\n\u3000\u3000\u3000\u3000\u3000\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u4e00\u62ec\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9(csv)</button>\n```\n\n##Controller\n```Controller.java\n    /**\n\t * \u30e6\u30fc\u30b6\u30fc\u60c5\u5831csv\u5f62\u5f0f\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n\t */\n\t@RequestMapping(\"csvDownload\")\n\tpublic void csvDownload(HttpServletResponse response) {\n\t\t\n\t\t//\u6587\u5b57\u30b3\u30fc\u30c9\u3068\u51fa\u529b\u3059\u308bCSV\u30d5\u30a1\u30a4\u30eb\u540d\u3092\u8a2d\u5b9a\n\t\tresponse.setContentType(MimeTypeUtils.APPLICATION_OCTET_STREAM_VALUE + \";charset=utf-8\");\n\t\tresponse.setHeader(\"Content-Disposition\", \"attachment; filename=\\\"test.csv\\\"\");\n\t\t\n\t\t//try-with-resources\u6587\u3092\u4f7f\u3046\u3053\u3068\u3067close\u51e6\u7406\u3092\u81ea\u52d5\u5316\n\t\ttry (PrintWriter pw = response.getWriter()) {\n\t\t\tList<User> all_users = service.findAll();\n\t\t\tfor (int i = 0; i < all_users.size(); i++) {\n\t\t\t\tlong id = all_users.get(i).getId();\n\t\t\t\tString name = all_users.get(i).getName();\n\t\t\t\tString email = all_users.get(i).getEmail();\n\t\t\t\tString password = all_users.get(i).getPassword();\n\t\t\t\tString address = all_users.get(i).getAddress();\n\t\t\t\tString telephone = all_users.get(i).getTelephone();\n\t\t\t\t\n\t\t\t\t//CSV\u30d5\u30a1\u30a4\u30eb\u5185\u90e8\u306b\u8a18\u8f09\u3059\u308b\u5f62\u5f0f\u3067\u6587\u5b57\u5217\u3092\u8a2d\u5b9a\n\t\t\t\tString outputString = id + \",\" + name + \",\" + email + \",\" + password + \",\" + address + \",\" + telephone\n\t\t\t\t\t\t + \"\\r\\n\";\n\t\t\t\t\n\t\t\t\t//CSV\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u307f\n\t\t\t\tpw.print(outputString);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n```\n", "tags": ["Java", "spring"]}