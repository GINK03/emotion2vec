{"tags": ["Tomcat"], "context": " More than 1 year has passed since last update.\u8272\u3005\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u30b3\u30fc\u30c9\u3067\u5b89\u5b9a\u3057\u305f\u306e\u3067\u30e1\u30e2\u3067\u3059\u3002\nTomcat: 7.0.53\n\u307e\u305a\u306f\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u306e\u30b3\u30fc\u30c9\u3002\n\nImageFileServlet\npackage com.sample.web;\n\nimport java.io.BufferedInputStream;\nimport java.io.FileInputStream;\nimport java.io.IOException;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.ServletOutputStream;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet(\"/imagefile\")\npublic class ImageFileServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    public ImageFileServlet() {\n        super();\n    }\n\n    protected void doGet(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n\n        //\u51fa\u529b\u3059\u308b\u30d5\u30a1\u30a4\u30eb(\u3042\u3089\u304b\u3058\u3081WebContent\u4ee5\u4e0b\u306b\u914d\u7f6e\u3057\u3066\u304a\u304f\u3002)\n        String dir = getServletContext().getRealPath(\"/\");\n        String fname = request.getParameter(\"name\");\n\n        int iData = 0;\n\n        //Servlet\u306eOutputStream\u53d6\u5f97\n        ServletOutputStream out = response.getOutputStream();\n\n        //\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092BufferedInputStream\u3092\u4f7f\u7528\u3057\u3066\u8aad\u307f\u53d6\u308b\n        BufferedInputStream in = new BufferedInputStream(new FileInputStream(dir+fname));\n\n        //\u753b\u50cf\u3092\u66f8\u304d\u51fa\u3059\n        while((iData = in.read()) != -1){\n            out.write(iData);\n        }\n\n        in.close();\n        out.close();\n    }\n\n}\n\n\n\u7d9a\u3044\u3066\u8868\u793a\u7528\u306eHTML\n\ntest.html\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n<title>Servlet\u3067\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u8868\u793a</title>\n</head>\n<body>\n<img src=\"./imagefile?name=neko2.jpg\"><br>\n<img src=\"./imagefile?name=neko2.png\"><br>\n<img src=\"./imagefile?name=neko2.gif\"><br>\n</body>\n</html>\n\n\n\u8272\u3005\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u30b3\u30fc\u30c9\u3067\u5b89\u5b9a\u3057\u305f\u306e\u3067\u30e1\u30e2\u3067\u3059\u3002\nTomcat: 7.0.53\n\n\u307e\u305a\u306f\u30b5\u30fc\u30d6\u30ec\u30c3\u30c8\u306e\u30b3\u30fc\u30c9\u3002\n\n```java:ImageFileServlet\npackage com.sample.web;\n\nimport java.io.BufferedInputStream;\nimport java.io.FileInputStream;\nimport java.io.IOException;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.ServletOutputStream;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n@WebServlet(\"/imagefile\")\npublic class ImageFileServlet extends HttpServlet {\n    private static final long serialVersionUID = 1L;\n\n    public ImageFileServlet() {\n        super();\n    }\n\n    protected void doGet(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n\n        //\u51fa\u529b\u3059\u308b\u30d5\u30a1\u30a4\u30eb(\u3042\u3089\u304b\u3058\u3081WebContent\u4ee5\u4e0b\u306b\u914d\u7f6e\u3057\u3066\u304a\u304f\u3002)\n        String dir = getServletContext().getRealPath(\"/\");\n        String fname = request.getParameter(\"name\");\n\n        int iData = 0;\n\n        //Servlet\u306eOutputStream\u53d6\u5f97\n        ServletOutputStream out = response.getOutputStream();\n\n        //\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092BufferedInputStream\u3092\u4f7f\u7528\u3057\u3066\u8aad\u307f\u53d6\u308b\n        BufferedInputStream in = new BufferedInputStream(new FileInputStream(dir+fname));\n\n        //\u753b\u50cf\u3092\u66f8\u304d\u51fa\u3059\n        while((iData = in.read()) != -1){\n            out.write(iData);\n        }\n\n        in.close();\n        out.close();\n    }\n\n}\n```\n\n\u7d9a\u3044\u3066\u8868\u793a\u7528\u306eHTML\n\n```html:test.html\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n<html>\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n<title>Servlet\u3067\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u8868\u793a</title>\n</head>\n<body>\n<img src=\"./imagefile?name=neko2.jpg\"><br>\n<img src=\"./imagefile?name=neko2.png\"><br>\n<img src=\"./imagefile?name=neko2.gif\"><br>\n</body>\n</html>\n```\n"}