{"tags": ["Python", "svm"], "context": "\u6a5f\u68b0\u5b66\u7fd2\u3063\u3066\u306a\u3093\u3060\u308d\u3046\u3063\u3066\u3044\u3046\u3068\u3001\u601d\u3044\u3064\u304f\u307e\u307e\u306b\u66f8\u304f\u3068\u3001\u3053\u3093\u306a\u611f\u3058\u304b\u306a\u3002\n\n\u5206\u985e\n\u56de\u5e30\n\u5224\u5225\n\n\u4ed6\u306b\u3082\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3051\u308c\u3069\u3001\u601d\u3044\u3064\u304b\u306a\u3044\u304b\u3089\u3044\u3044\u3084\u3002\nR\u3067\u3053\u306e\u8fba\u308a\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u3059\u3059\u3081\u308b\u6642\u306b\u306f\u3001iris\u30c7\u30fc\u30bf\u3092\u4f7f\u3046\u3093\u3060\u3051\u308c\u3069\u3001Python\u306b\u306f\u3042\u308b\u306e\u304b\u306a\u3002\u2192\u3042\u308b\u3089\u3057\u3044\u3002\n\nR\u3067\u6a5f\u68b0\u5b66\u7fd2\n\n\u5206\u985e\uff06\u5224\u5225\u306e\u4f8b\n\u307e\u305a\u306f\u3001R\u3067\u3084\u3063\u3066\u307f\u308b\u3002R\u3067SVM\u3084\u3089NeuralNet\u3084\u3089NaiveBayse\u3084\u3089RandomForest\u3084\u3089\u3092\u4f7f\u3063\u3066\u8b58\u5225\u5668\u3092\u4f5c\u308b\u306e\u306f\u3001\u306a\u3093\u3066\u3044\u3046\u304b\u4f5c\u308b\u3060\u3051\u306a\u3089\u307b\u3068\u3093\u3069\u4f55\u3082\u8003\u3048\u308b\u5fc5\u8981\u304c\u306a\u3044\u3002\u305d\u308c\u305e\u308c\u306e\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0\u624b\u6cd5\u3092\u4f7f\u3063\u3066\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u3092\u4f7f\u3063\u3066\u8b58\u5225\u5668\u3092\u4f5c\u308a\u3001\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8\u304c\u305d\u306e\u8b58\u5225\u5668\u3067\u6b63\u3057\u304f\u5206\u985e\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u3092\u8a55\u4fa1\u3059\u308b\u3068\u3044\u3046\u6d41\u308c\u3060\u3002\nR\u3067\u306fdata(iris)\u3059\u308c\u3070\u3001\u30b7\u30e7\u30a6\u30d6\u3060\u304b\u30a2\u30e4\u30e1\u3060\u304b\u30ab\u30ad\u30c4\u30d0\u30bf\u3060\u304b\u306e\u30c7\u30fc\u30bf\u3092\u5229\u7528\u3067\u304d\u308b\u3002\n\n\u3053\u308c\u306f\u3001\u843c\u9577\u3001\u843c\u5e45\u3001\u82b1\u5f01\u9577\u3001\u82b1\u5f01\u5e45\u3092\u8aac\u660e\u5909\u6570\u306b\u3001\u76ee\u7684\u5909\u6570\u306biris\u306e\u54c1\u7a2e(setosa ,  versicolor ,  virginica )\u3092\u6301\u3063\u305f\u5168150 sample\u306edata.table\u3060\u3002\n\u307e\u305a\u306f\u3001sample()\u3067\u534a\u6570\u3092\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u306b\u3001\u6b8b\u308a\u3092\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8\u306b\u306a\u308b\u3088\u3046\u306b\u3001\u30e9\u30f3\u30c0\u30e0\u306b\u5206\u5272\u3059\u308b\u3002\n## iris\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\ndata(iris)\n## \u534a\u5206\u3092\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u306b\u3059\u308b\u305f\u3081\u306b\u3001\u30e9\u30f3\u30c0\u30e0\u306b\u9078\u629e\u3059\u308b\ntrain_ids <- sample(nrow(iris), nrow(iris)*0.5)\n## \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u306e\u4f5c\u6210\niris.train <- iris[train_ids,]\n## \u6b8b\u308a\u534a\u5206\u3092\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8\u306b\niris.test  <- iris[-train_ids,]\n\n\u3068\u3053\u308d\u3067\u3001iris\u306e3\u54c1\u7a2e\u3001setosa , versicolor, virignica\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u82b1\u3060\u3002\u307f\u3093\u306a\u540c\u3058\u3084\u3093\uff01\u30b3\u30ec\u3092\u82b1\u3073\u3089\u306e\u5f62\u72b6\u3067\u533a\u5225\u3059\u308b\u3068\u304b\u3001\u7f70\u30b2\u30fc\u30e0\u3067\u3059\u3084\u3093\u3002\n\n### SVM\u5b9f\u884c\nlibrary(kernlab)\niris.svm <- ksvm(Species~., data=iris.train)\nsvm.predict <- predict(iris.svm, iris.test)\n### \u7d50\u679c\u8868\u793a\ntable(svm.predict, iris.test$Species)\n\n### neuralnet\u5b9f\u884c\nlibrary(nnet)\niris.nnet<-nnet(Species ~ ., data = iris.train, size = 3)\nnnet.predict <- predict(iris.nnet, iris.test, type=\"class\")\n### \u7d50\u679c\u8868\u793a\ntable( nnet.predict,  iris.test$Species)\n\n### naivebayes\u5b9f\u884c\nlibrary(e1071)\niris.nb <- naiveBayes(Species~., iris.train)\nnbayes.predict <- predict(iris.nb, iris.test)\n### \u7d50\u679c\u8868\u793a\ntable(nbayes.predict, iris.test$Species)\n\n### randomforest\u5b9f\u884c\nlibrary(randomForest)\niris.rf <- randomForest(Species~., iris.train)\nrf.predict <- predict(iris.rf, iris.test)\n### \u7d50\u679c\u8868\u793a\ntable(rf.predict, iris.test$Species)\n\n\u5b9f\u884c\u3057\u3066\u307f\u308b\u3068\u3001\u3069\u3093\u306a\u624b\u6cd5\u3092\u4f7f\u3063\u3066\u3082\u3001\u3060\u3044\u305f\u3044\u6b63\u89e3\u738773/75\u304f\u3089\u3044\u3067\u8b58\u5225\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u767e\u767a\u767e\u4e2d\u3068\u306f\u3044\u304b\u306a\u3044\u3093\u3060\u3051\u308c\u3069\u3001\u305d\u308c\u306f\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u8abf\u7bc0\u3068\u304b\u3067\u306a\u3093\u3068\u304b\u306a\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\uff08\u306a\u3089\u306a\u3044\u306e\u304b\u3082\u3057\u308c\u306a\u3044\uff09\u3002\n\u3055\u3066\u3001\u540c\u3058\u3053\u3068\u3092Python\u3067\u3084\u3063\u3066\u307f\u308b\u305f\u3081\u306b\u306f\u3001scikit-learn\u3092\u4f7f\u3046\u3002\u8a73\u3057\u3044\u3053\u3068\u306f\u3001scikit-learn\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb \u306b\u66f8\u3044\u3066\u3042\u308b\u3002\n\nPython\u3067\u8b58\u5225\n\nPython\u3067SVM\u3092\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u307f\u308b\n\u305d\u3082\u305d\u3082\u300c\u4e0a\u8a18\u306e\u3088\u3046\u306bR\u3067\u7c21\u5358\u306b\u3067\u304d\u305f\u3053\u3068\u300d\u3092\u306a\u305c\u81ea\u5206\u306b\u3068\u3063\u3066\u672a\u77e5\u306ePython\u3067\u3084\u308b\u306e\u304b\uff1f\u3068\u3044\u3046\u3068\u3001Python\u3067\u3084\u3063\u3066\u307f\u305f\u3044\u304b\u3089\u3068\u3057\u304b\u8a00\u3044\u3088\u3046\u304c\u306a\u3044\u3002\u30bd\u30b3\u306b\u5c71\u304c\u3042\u3063\u305f\u3089\u767b\u308b\u3057\u3001\u6c34\u305f\u307e\u308a\u304c\u3042\u3063\u305f\u3089\u30cf\u30de\u308b\u3057\u3001\u636e\u3048\u81b3\u304c\u3042\u3063\u305f\u3089\u55b0\u3046\u306e\u3067\u3042\u308b\u3002\nAnaconda\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u306a\u3089scikit-learn\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u306a\u306e\u3067\u3001import\u3059\u308b\u3002import\u3059\u308b\u3093\u3060\u3051\u308c\u3069\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u540d\u306fsklearn\u3060\u3002\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u306fdatasets\u3068\u3057\u3066\u3001iris\u3082load\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\nfrom sklearn import svm, datasets\niris = datasets.load_iris()\n\n\u4e2d\u8eab\u306b\u3064\u3044\u3066\u306f\u3001print(iris.data)\u3068\u304b\u3001print(iris.target)\u3068\u304b\u3059\u308b\u3068\u5206\u304b\u308b\u3093\u3060\u3051\u308c\u3069\u3001iris.data\u306e\u65b9\u306b\u8aac\u660e\u5909\u6570\u304c\u3001iris.target\u306e\u65b9\u306b\u76ee\u7684\u5909\u6570\u304c\u5165\u3063\u3066\u3044\u308b\u3002\u3053\u308c\u3092\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u7528\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3068\u3001\u30c6\u30b9\u30c8\u7528\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306b\u5206\u5272\u3059\u308b\u3002R\u3060\u3068sample()\u95a2\u6570\u3092\u4f7f\u3063\u305f\u3051\u308c\u3069\u3001scikit-learn\u306e\u5834\u5408\u306b\u306f\u3001sklearn.cross_varidation\u306btrain_test_split()\u3068\u3044\u3046\u30e1\u30bd\u30c3\u30c9\u304c\u3042\u308b\u3002\u3053\u308c\u3067\u3001R\u3067\u3084\u3063\u305f\u6642\u3068\u540c\u69d8\u306b\u3001\u534a\u5206\u3092\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8(iris_data_train, iris_target_train)\u3068\u3001\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8(iris_data_test, iris_target_test)\u306b2\u5206\u5272\u3057\u305f\u3002\nfrom sklearn import svm, datasets\nfrom sklearn.cross_validation import train_test_split\nimport numpy as np\n\niris = datasets.load_iris()\niris_data_train, iris_data_test, iris_target_train, iris_target_test = train_test_split(iris.data, iris.target, test_size=0.5)\n\n\u3053\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u3092\u4f7f\u3063\u3066\u8b58\u5225\u5668\u3092\u4f5c\u308b\u3002SVM\u306b\u3082\u3044\u308d\u3044\u308d\u3042\u3063\u3066\u3001\u7dda\u5f62\u304b\uff1f\u975e\u7dda\u5f62\u304b\uff1f\u3068\u304b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u3044\u308d\u3044\u308d\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3093\u3060\u3051\u308c\u3069\u3001\u3053\u3053\u306f\u5168\u90e8\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3002\nsvc = svm.SVC()\nsvc.fit(iris_data_train, iris_target_train)\nsvc.predict(iris_data_test)\n\nfit()\u3068predict()\u306f2\u884c\u306b\u5206\u3051\u3066\u66f8\u3044\u305f\u3051\u308c\u3069\u3001\u521d\u671f\u5316\u3057\u3066\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u98df\u308f\u305b\u3066\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u98df\u308f\u305b\u308b\u3060\u3051\u306a\u306e\u3067\u30011\u884c\u3067\u66f8\u3044\u3066\u3082\u3044\u3044\u3002\niris_predict = svm.SVC().fit(iris_data_train, iris_target_train).predict(iris_data_test)\n\n\n\u3053\u306esvc.predict()\u306e\u7d50\u679c(iris_predict)\u3068\u3001iris_target_test\u3068\u306e\u4e00\u81f4\u7387\u3092\u898b\u308c\u3070\u826f\u3044\u3002R\u3067\u306f\u3001table(svm.predict, iris.test$Species) \u306e\u3088\u3046\u306b\u8868\u5f62\u5f0f\u306b\u3057\u3066\u51fa\u529b\u3057\u305f\u306e\u3067\u3001\u540c\u3058\u3088\u3046\u306b\u3084\u3063\u3066\u307f\u308b\u3002\u3053\u306e\u8868\u3092 confusion_matrix \u3068\u3044\u3046\u3002accuracy_score\u3067\u3001\u6b63\u89e3\u7387\u3092\u624b\u3063\u53d6\u308a\u65e9\u304f\u51fa\u3059\u3053\u3068\u3082\u3067\u304d\u308b\u3002\nfrom sklearn.metrics import confusion_matrix, accuracy_score\n\nprint (confusion_matrix(iris_target_test, iris_predict))\nprint (accuracy_score(iris_target_test, iris_predict))\n\nconfusion_matrix()\u306f\u3001\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3088\u308b\u3068\u3001\u7b2c\u4e00\u5f15\u6570\u304c\u771f\u5024\u3067\u3001\u7b2c\u4e8c\u5f15\u6570\u304c\u8b58\u5225\u5668\u306b\u3088\u308b\u5224\u5225\u5024\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u305d\u306e\u3088\u3046\u306b\u6e21\u3059\u3002\n\nR\u3088\u308a\u306f\u5358\u7d14\u306b\u30bf\u30a4\u30d7\u91cf\u304c\u591a\u3044\u3051\u308c\u3069\u3001\u540c\u3058\u3088\u3046\u306a\u7d50\u679c\u304c\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u306f\u306a\u3063\u305f\u3002\n\u4e0a\u8a18\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3088\u308b\u3068\u3001\u3053\u308c\u3092\u56f3\u306b\u793a\u3059\u3053\u3068\u3082\u3067\u304d\u308b\u3002\u307e\u305a\u3001confusion_matrix\u306e\u5404\u884c\u304c\u5408\u8a081\u306b\u306a\u308b\u3088\u3046\u306b\u6b63\u898f\u5316\u3059\u308b\u3002\u3053\u306e\u5f0f\u3092\u30d1\u30c3\u3068\u81ea\u5206\u3067\u306f\u66f8\u3051\u306a\u3044\u306a\u3002\ncm = confusion_matrix(iris_target_test, iris_predict)\ncm_normalized = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n\n\u3053\u306e\u6b63\u898f\u5316\u3057\u305fconfusion_matrix\u3092\u4f7f\u3063\u3066\u3001matplotlib\u306e\u6a5f\u80fd\u3092\u4f7f\u3063\u3066heatmap\u5316\u3059\u308b\u3002\u3061\u306a\u307f\u306b\u3001\u4f55\u56de\u3082svc.predict()\u3092\u3084\u3063\u3066\u3001\u305d\u306e\u305f\u3073\u306b\u7d50\u679c\u304c\u5fae\u5999\u306b\u7570\u306a\u308b\u306e\u3067\u3001\u4e0a\u56f3\u3068\u4e0b\u56f3\u306fconfusion_matrix\u306e\u4e2d\u8eab\u304c\u82e5\u5e72\u7570\u306a\u308b\u3002\ndef plot_confusion_matrix(cm, title='Confusion matrix', cmap=plt.cm.Blues):\n    ''' confusion_matrix\u3092heatmap\u8868\u793a\u3059\u308b\u95a2\u6570\n    Keyword arguments:\n        cm -- confusion_matrix\n        title -- \u56f3\u306e\u8868\u984c\n        cmap -- \u4f7f\u7528\u3059\u308b\u30ab\u30e9\u30fc\u30de\u30c3\u30d7\n\n    '''\n    plt.imshow(cm, interpolation='nearest', cmap=cmap)\n    plt.title(title)\n    plt.colorbar()\n    tick_marks = np.arange(len(iris.target_names))\n    plt.xticks(tick_marks, iris.target_names, rotation=45)\n    plt.yticks(tick_marks, iris.target_names)\n    plt.tight_layout()\n    plt.ylabel('True label')\n    plt.xlabel('Predicted label')\n\n\n\u4eca\u56de\u306f\u3001svc=svm.SVC()\u3068\u3044\u3046\u5177\u5408\u306b\u5168\u90e8\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3063\u305f\u3093\u3060\u3051\u308c\u3069\u3001\u3082\u3061\u308d\u3093\u5206\u985e\u306e\u305f\u3081\u306ekernel\u306f\u3044\u308d\u3044\u308d\u4f7f\u3048\u308b\u306f\u305a\u3002\nscikit-learn\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\u306eExamples\u306e\u30da\u30fc\u30b8\u306b\u306f\u3001\u3044\u308d\u3044\u308d\u306a\u30c7\u30e2\u3068\u304b\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3068\u304b\u8f09\u3063\u3066\u308b\u306e\u3067\u3001\u3044\u3056\u5fc5\u8981\u306a\u3068\u304d\u306b\u306f\u3001\u3053\u3053\u304b\u3089\u30d2\u30f3\u30c8\u3092\u63a2\u308b\u3053\u3068\u304c\u3067\u304d\u305d\u3046\u3060\u3002\nR\u3067\u3084\u3063\u305f\u3088\u3046\u306b\u3001\u3058\u3083\u3042NeuralNet\u306a\u3089naiveBayes\u306a\u3089randomForest\u306a\u3089\u3069\u3046\u306a\u306e\u304b\u3001\u3068\u3044\u3046\u306e\u3082\u6c17\u306b\u306a\u308b\u3051\u308c\u3069\u3001\u591a\u5206\u3001\u3060\u3044\u305f\u3044\u540c\u3058(\u8abf\u3079\u3066\u306a\u3044\u3051\u3069)\u3002\n\n\u4eca\u56de\u306e\u7d50\u8ad6\n\u6a5f\u68b0\u5b66\u7fd2\u306e\u4e00\u7aef\u306b\u89e6\u308c\u305f\u6c17\u5206\u306a\u3093\u3060\u3051\u308c\u3069\u3001\u7d50\u5c40iris\u3063\u3066\u306e\u304c\u30b7\u30e7\u30a6\u30d6\u306a\u306e\u304b\u30a2\u30e4\u30e1\u306a\u306e\u304b\u30ab\u30ad\u30c4\u30d0\u30bf\u306a\u306e\u304b\u306f\u5206\u304b\u3089\u305a\u3058\u307e\u3044\u306a\u306e\u3067\u3042\u3063\u305f\u3002\n\n\u8ffd\u8a18\n\u5f53\u521d\u300cPython\u3067\u6a5f\u68b0\u5b66\u7fd2\u306e\u3055\u308f\u308a\u3092\u3084\u3063\u3066\u307f\u308b\u300d\u3068\u3044\u3046\u30bf\u30a4\u30c8\u30eb\u3067\u3057\u305f\u304c\u3001\u300c\u3055\u308f\u308a\u306f\u6700\u3082\u76db\u308a\u4e0a\u304c\u308b\u6240\u306e\u610f\u5473\u3060\u304b\u3089\u3001\u30bf\u30a4\u30c8\u30eb\u306f\u3075\u3055\u308f\u3057\u304f\u306a\u3044\u300d\u3068\u306e\u3053\u3068\u3060\u3063\u305f\u306e\u3067\u3001\u4fee\u6b63\u3057\u307e\u3057\u305f\u3002\n\u300cPython\u3067SVM\u3067\u5224\u5225\u5668\u3092\u4f5c\u308c\u308b\u300d\u306e\u3063\u3066\u3001\u500b\u4eba\u7684\u306b\u306f\u76db\u308a\u4e0a\u304c\u308b\u30dd\u30a4\u30f3\u30c8\u3060\u3068\u601d\u3046\u3093\u3060\u3051\u3069\u3001\u72ec\u308a\u3088\u304c\u308a\u3060\u3063\u305f\u307f\u305f\u3044\u3067\u3059\u3002SVM\u3054\u3068\u304d\u3067\u6a5f\u68b0\u5b66\u7fd2\u3092\u8a9e\u3063\u3066\u3059\u307f\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u51fa\u76f4\u3057\u3066\u304d\u307e\u3059\u3002\n\n\u4eca\u56de\u306e\u30b3\u30fc\u30c9\n\nhttps://github.com/fukuit/Python_SelfLearning/blob/master/ml_svm.py\n\n\u6a5f\u68b0\u5b66\u7fd2\u3063\u3066\u306a\u3093\u3060\u308d\u3046\u3063\u3066\u3044\u3046\u3068\u3001\u601d\u3044\u3064\u304f\u307e\u307e\u306b\u66f8\u304f\u3068\u3001\u3053\u3093\u306a\u611f\u3058\u304b\u306a\u3002\n\n- \u5206\u985e\n- \u56de\u5e30\n- \u5224\u5225\n\n\u4ed6\u306b\u3082\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3051\u308c\u3069\u3001\u601d\u3044\u3064\u304b\u306a\u3044\u304b\u3089\u3044\u3044\u3084\u3002\nR\u3067\u3053\u306e\u8fba\u308a\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u3059\u3059\u3081\u308b\u6642\u306b\u306f\u3001iris\u30c7\u30fc\u30bf\u3092\u4f7f\u3046\u3093\u3060\u3051\u308c\u3069\u3001Python\u306b\u306f\u3042\u308b\u306e\u304b\u306a\u3002\u2192\u3042\u308b\u3089\u3057\u3044\u3002\n\n# R\u3067\u6a5f\u68b0\u5b66\u7fd2\n## \u5206\u985e\uff06\u5224\u5225\u306e\u4f8b\n\u307e\u305a\u306f\u3001R\u3067\u3084\u3063\u3066\u307f\u308b\u3002R\u3067SVM\u3084\u3089NeuralNet\u3084\u3089NaiveBayse\u3084\u3089RandomForest\u3084\u3089\u3092\u4f7f\u3063\u3066\u8b58\u5225\u5668\u3092\u4f5c\u308b\u306e\u306f\u3001\u306a\u3093\u3066\u3044\u3046\u304b\u4f5c\u308b\u3060\u3051\u306a\u3089\u307b\u3068\u3093\u3069\u4f55\u3082\u8003\u3048\u308b\u5fc5\u8981\u304c\u306a\u3044\u3002\u305d\u308c\u305e\u308c\u306e\u30af\u30e9\u30b9\u30bf\u30ea\u30f3\u30b0\u624b\u6cd5\u3092\u4f7f\u3063\u3066\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u3092\u4f7f\u3063\u3066\u8b58\u5225\u5668\u3092\u4f5c\u308a\u3001\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8\u304c\u305d\u306e\u8b58\u5225\u5668\u3067\u6b63\u3057\u304f\u5206\u985e\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u3092\u8a55\u4fa1\u3059\u308b\u3068\u3044\u3046\u6d41\u308c\u3060\u3002\n\nR\u3067\u306fdata(iris)\u3059\u308c\u3070\u3001\u30b7\u30e7\u30a6\u30d6\u3060\u304b\u30a2\u30e4\u30e1\u3060\u304b\u30ab\u30ad\u30c4\u30d0\u30bf\u3060\u304b\u306e\u30c7\u30fc\u30bf\u3092\u5229\u7528\u3067\u304d\u308b\u3002\n\n![20160903001.png](https://qiita-image-store.s3.amazonaws.com/0/15553/4684d1b4-e77b-17c1-c8c8-6ecc0d60f932.png \"20160903001.png\")\n\n\n\u3053\u308c\u306f\u3001\u843c\u9577\u3001\u843c\u5e45\u3001\u82b1\u5f01\u9577\u3001\u82b1\u5f01\u5e45\u3092\u8aac\u660e\u5909\u6570\u306b\u3001\u76ee\u7684\u5909\u6570\u306biris\u306e\u54c1\u7a2e(setosa ,  versicolor ,  virginica )\u3092\u6301\u3063\u305f\u5168150 sample\u306edata.table\u3060\u3002\n\n\u307e\u305a\u306f\u3001sample()\u3067\u534a\u6570\u3092\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u306b\u3001\u6b8b\u308a\u3092\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8\u306b\u306a\u308b\u3088\u3046\u306b\u3001\u30e9\u30f3\u30c0\u30e0\u306b\u5206\u5272\u3059\u308b\u3002\n\n```R\n## iris\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\ndata(iris)\n## \u534a\u5206\u3092\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u306b\u3059\u308b\u305f\u3081\u306b\u3001\u30e9\u30f3\u30c0\u30e0\u306b\u9078\u629e\u3059\u308b\ntrain_ids <- sample(nrow(iris), nrow(iris)*0.5)\n## \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u306e\u4f5c\u6210\niris.train <- iris[train_ids,]\n## \u6b8b\u308a\u534a\u5206\u3092\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8\u306b\niris.test  <- iris[-train_ids,]\n```\n\n\u3068\u3053\u308d\u3067\u3001iris\u306e3\u54c1\u7a2e\u3001setosa , versicolor, virignica\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u82b1\u3060\u3002\u307f\u3093\u306a\u540c\u3058\u3084\u3093\uff01\u30b3\u30ec\u3092\u82b1\u3073\u3089\u306e\u5f62\u72b6\u3067\u533a\u5225\u3059\u308b\u3068\u304b\u3001\u7f70\u30b2\u30fc\u30e0\u3067\u3059\u3084\u3093\u3002\n\n![20160903004.png](https://qiita-image-store.s3.amazonaws.com/0/15553/3d5484fb-fea7-afa7-871f-10fd86ccd4d8.png \"20160903004.png\")\n\n```R\n### SVM\u5b9f\u884c\nlibrary(kernlab)\niris.svm <- ksvm(Species~., data=iris.train)\nsvm.predict <- predict(iris.svm, iris.test)\n### \u7d50\u679c\u8868\u793a\ntable(svm.predict, iris.test$Species)\n\n### neuralnet\u5b9f\u884c\nlibrary(nnet)\niris.nnet<-nnet(Species ~ ., data = iris.train, size = 3)\nnnet.predict <- predict(iris.nnet, iris.test, type=\"class\")\n### \u7d50\u679c\u8868\u793a\ntable( nnet.predict,  iris.test$Species)\n\n### naivebayes\u5b9f\u884c\nlibrary(e1071)\niris.nb <- naiveBayes(Species~., iris.train)\nnbayes.predict <- predict(iris.nb, iris.test)\n### \u7d50\u679c\u8868\u793a\ntable(nbayes.predict, iris.test$Species)\n\n### randomforest\u5b9f\u884c\nlibrary(randomForest)\niris.rf <- randomForest(Species~., iris.train)\nrf.predict <- predict(iris.rf, iris.test)\n### \u7d50\u679c\u8868\u793a\ntable(rf.predict, iris.test$Species)\n```\n\n\u5b9f\u884c\u3057\u3066\u307f\u308b\u3068\u3001\u3069\u3093\u306a\u624b\u6cd5\u3092\u4f7f\u3063\u3066\u3082\u3001\u3060\u3044\u305f\u3044\u6b63\u89e3\u738773/75\u304f\u3089\u3044\u3067\u8b58\u5225\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u767e\u767a\u767e\u4e2d\u3068\u306f\u3044\u304b\u306a\u3044\u3093\u3060\u3051\u308c\u3069\u3001\u305d\u308c\u306f\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u8abf\u7bc0\u3068\u304b\u3067\u306a\u3093\u3068\u304b\u306a\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\uff08\u306a\u3089\u306a\u3044\u306e\u304b\u3082\u3057\u308c\u306a\u3044\uff09\u3002\n\n\u3055\u3066\u3001\u540c\u3058\u3053\u3068\u3092Python\u3067\u3084\u3063\u3066\u307f\u308b\u305f\u3081\u306b\u306f\u3001scikit-learn\u3092\u4f7f\u3046\u3002\u8a73\u3057\u3044\u3053\u3068\u306f\u3001[scikit-learn\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb](http://scikit-learn.org/stable/tutorial/basic/tutorial.html) \u306b\u66f8\u3044\u3066\u3042\u308b\u3002\n\n# Python\u3067\u8b58\u5225\n## Python\u3067SVM\u3092\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u307f\u308b\n\n\u305d\u3082\u305d\u3082\u300c\u4e0a\u8a18\u306e\u3088\u3046\u306bR\u3067\u7c21\u5358\u306b\u3067\u304d\u305f\u3053\u3068\u300d\u3092\u306a\u305c\u81ea\u5206\u306b\u3068\u3063\u3066\u672a\u77e5\u306ePython\u3067\u3084\u308b\u306e\u304b\uff1f\u3068\u3044\u3046\u3068\u3001Python\u3067\u3084\u3063\u3066\u307f\u305f\u3044\u304b\u3089\u3068\u3057\u304b\u8a00\u3044\u3088\u3046\u304c\u306a\u3044\u3002\u30bd\u30b3\u306b\u5c71\u304c\u3042\u3063\u305f\u3089\u767b\u308b\u3057\u3001\u6c34\u305f\u307e\u308a\u304c\u3042\u3063\u305f\u3089\u30cf\u30de\u308b\u3057\u3001\u636e\u3048\u81b3\u304c\u3042\u3063\u305f\u3089\u55b0\u3046\u306e\u3067\u3042\u308b\u3002\n\nAnaconda\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u306a\u3089scikit-learn\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u306a\u306e\u3067\u3001import\u3059\u308b\u3002import\u3059\u308b\u3093\u3060\u3051\u308c\u3069\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u540d\u306fsklearn\u3060\u3002\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u306fdatasets\u3068\u3057\u3066\u3001iris\u3082load\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```python\nfrom sklearn import svm, datasets\niris = datasets.load_iris()\n```\n\n\u4e2d\u8eab\u306b\u3064\u3044\u3066\u306f\u3001print(iris.data)\u3068\u304b\u3001print(iris.target)\u3068\u304b\u3059\u308b\u3068\u5206\u304b\u308b\u3093\u3060\u3051\u308c\u3069\u3001iris.data\u306e\u65b9\u306b\u8aac\u660e\u5909\u6570\u304c\u3001iris.target\u306e\u65b9\u306b\u76ee\u7684\u5909\u6570\u304c\u5165\u3063\u3066\u3044\u308b\u3002\u3053\u308c\u3092\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u7528\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3068\u3001\u30c6\u30b9\u30c8\u7528\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306b\u5206\u5272\u3059\u308b\u3002R\u3060\u3068sample()\u95a2\u6570\u3092\u4f7f\u3063\u305f\u3051\u308c\u3069\u3001scikit-learn\u306e\u5834\u5408\u306b\u306f\u3001sklearn.cross_varidation\u306btrain_test_split()\u3068\u3044\u3046\u30e1\u30bd\u30c3\u30c9\u304c\u3042\u308b\u3002\u3053\u308c\u3067\u3001R\u3067\u3084\u3063\u305f\u6642\u3068\u540c\u69d8\u306b\u3001\u534a\u5206\u3092\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8(iris_data_train, iris_target_train)\u3068\u3001\u30c6\u30b9\u30c8\u30bb\u30c3\u30c8(iris_data_test, iris_target_test)\u306b2\u5206\u5272\u3057\u305f\u3002\n\n```python\nfrom sklearn import svm, datasets\nfrom sklearn.cross_validation import train_test_split\nimport numpy as np\n\niris = datasets.load_iris()\niris_data_train, iris_data_test, iris_target_train, iris_target_test = train_test_split(iris.data, iris.target, test_size=0.5)\n```\n\n\u3053\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30bb\u30c3\u30c8\u3092\u4f7f\u3063\u3066\u8b58\u5225\u5668\u3092\u4f5c\u308b\u3002SVM\u306b\u3082\u3044\u308d\u3044\u308d\u3042\u3063\u3066\u3001\u7dda\u5f62\u304b\uff1f\u975e\u7dda\u5f62\u304b\uff1f\u3068\u304b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u3044\u308d\u3044\u308d\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3093\u3060\u3051\u308c\u3069\u3001\u3053\u3053\u306f\u5168\u90e8\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3002\n\n```python\nsvc = svm.SVC()\nsvc.fit(iris_data_train, iris_target_train)\nsvc.predict(iris_data_test)\n```\n\nfit()\u3068predict()\u306f2\u884c\u306b\u5206\u3051\u3066\u66f8\u3044\u305f\u3051\u308c\u3069\u3001\u521d\u671f\u5316\u3057\u3066\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u98df\u308f\u305b\u3066\u3001\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u98df\u308f\u305b\u308b\u3060\u3051\u306a\u306e\u3067\u30011\u884c\u3067\u66f8\u3044\u3066\u3082\u3044\u3044\u3002\n\n```python\niris_predict = svm.SVC().fit(iris_data_train, iris_target_train).predict(iris_data_test)\n```\n\n![20160903005.png](https://qiita-image-store.s3.amazonaws.com/0/15553/bd906449-1787-e7e6-be78-519458c2e82c.png \"20160903005.png\")\n\n\u3053\u306esvc.predict()\u306e\u7d50\u679c(iris_predict)\u3068\u3001iris_target_test\u3068\u306e\u4e00\u81f4\u7387\u3092\u898b\u308c\u3070\u826f\u3044\u3002R\u3067\u306f\u3001table(svm.predict, iris.test$Species) \u306e\u3088\u3046\u306b\u8868\u5f62\u5f0f\u306b\u3057\u3066\u51fa\u529b\u3057\u305f\u306e\u3067\u3001\u540c\u3058\u3088\u3046\u306b\u3084\u3063\u3066\u307f\u308b\u3002\u3053\u306e\u8868\u3092 confusion_matrix \u3068\u3044\u3046\u3002accuracy_score\u3067\u3001\u6b63\u89e3\u7387\u3092\u624b\u3063\u53d6\u308a\u65e9\u304f\u51fa\u3059\u3053\u3068\u3082\u3067\u304d\u308b\u3002\n\n```python\nfrom sklearn.metrics import confusion_matrix, accuracy_score\n\nprint (confusion_matrix(iris_target_test, iris_predict))\nprint (accuracy_score(iris_target_test, iris_predict))\n```\n\nconfusion_matrix()\u306f\u3001[\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8](http://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html)\u306b\u3088\u308b\u3068\u3001\u7b2c\u4e00\u5f15\u6570\u304c\u771f\u5024\u3067\u3001\u7b2c\u4e8c\u5f15\u6570\u304c\u8b58\u5225\u5668\u306b\u3088\u308b\u5224\u5225\u5024\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u305d\u306e\u3088\u3046\u306b\u6e21\u3059\u3002\n\n![20160903006.png](https://qiita-image-store.s3.amazonaws.com/0/15553/c3093fba-5d0f-5cb5-45e6-b6ecf044fb4a.png \"20160903006.png\")\n\nR\u3088\u308a\u306f\u5358\u7d14\u306b\u30bf\u30a4\u30d7\u91cf\u304c\u591a\u3044\u3051\u308c\u3069\u3001\u540c\u3058\u3088\u3046\u306a\u7d50\u679c\u304c\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u306f\u306a\u3063\u305f\u3002\n\n\u4e0a\u8a18\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u3088\u308b\u3068\u3001\u3053\u308c\u3092\u56f3\u306b\u793a\u3059\u3053\u3068\u3082\u3067\u304d\u308b\u3002\u307e\u305a\u3001confusion_matrix\u306e\u5404\u884c\u304c\u5408\u8a081\u306b\u306a\u308b\u3088\u3046\u306b\u6b63\u898f\u5316\u3059\u308b\u3002\u3053\u306e\u5f0f\u3092\u30d1\u30c3\u3068\u81ea\u5206\u3067\u306f\u66f8\u3051\u306a\u3044\u306a\u3002\n\n```python\ncm = confusion_matrix(iris_target_test, iris_predict)\ncm_normalized = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n```\n\n\u3053\u306e\u6b63\u898f\u5316\u3057\u305fconfusion_matrix\u3092\u4f7f\u3063\u3066\u3001matplotlib\u306e\u6a5f\u80fd\u3092\u4f7f\u3063\u3066heatmap\u5316\u3059\u308b\u3002\u3061\u306a\u307f\u306b\u3001\u4f55\u56de\u3082svc.predict()\u3092\u3084\u3063\u3066\u3001\u305d\u306e\u305f\u3073\u306b\u7d50\u679c\u304c\u5fae\u5999\u306b\u7570\u306a\u308b\u306e\u3067\u3001\u4e0a\u56f3\u3068\u4e0b\u56f3\u306fconfusion_matrix\u306e\u4e2d\u8eab\u304c\u82e5\u5e72\u7570\u306a\u308b\u3002\n\n```python\ndef plot_confusion_matrix(cm, title='Confusion matrix', cmap=plt.cm.Blues):\n    ''' confusion_matrix\u3092heatmap\u8868\u793a\u3059\u308b\u95a2\u6570\n    Keyword arguments:\n        cm -- confusion_matrix\n        title -- \u56f3\u306e\u8868\u984c\n        cmap -- \u4f7f\u7528\u3059\u308b\u30ab\u30e9\u30fc\u30de\u30c3\u30d7\n        \n    '''\n    plt.imshow(cm, interpolation='nearest', cmap=cmap)\n    plt.title(title)\n    plt.colorbar()\n    tick_marks = np.arange(len(iris.target_names))\n    plt.xticks(tick_marks, iris.target_names, rotation=45)\n    plt.yticks(tick_marks, iris.target_names)\n    plt.tight_layout()\n    plt.ylabel('True label')\n    plt.xlabel('Predicted label')\n```\n\n![20160903007.png](https://qiita-image-store.s3.amazonaws.com/0/15553/f3283e62-4173-bbf0-7f03-5200688888bc.png \"20160903007.png\")\n\n\u4eca\u56de\u306f\u3001svc=svm.SVC()\u3068\u3044\u3046\u5177\u5408\u306b\u5168\u90e8\u30c7\u30d5\u30a9\u30eb\u30c8\u3060\u3063\u305f\u3093\u3060\u3051\u308c\u3069\u3001\u3082\u3061\u308d\u3093\u5206\u985e\u306e\u305f\u3081\u306ekernel\u306f\u3044\u308d\u3044\u308d\u4f7f\u3048\u308b\u306f\u305a\u3002\nscikit-learn\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\u306e[Examples](http://scikit-learn.org/stable/auto_examples/)\u306e\u30da\u30fc\u30b8\u306b\u306f\u3001\u3044\u308d\u3044\u308d\u306a\u30c7\u30e2\u3068\u304b\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3068\u304b\u8f09\u3063\u3066\u308b\u306e\u3067\u3001\u3044\u3056\u5fc5\u8981\u306a\u3068\u304d\u306b\u306f\u3001\u3053\u3053\u304b\u3089\u30d2\u30f3\u30c8\u3092\u63a2\u308b\u3053\u3068\u304c\u3067\u304d\u305d\u3046\u3060\u3002\n\nR\u3067\u3084\u3063\u305f\u3088\u3046\u306b\u3001\u3058\u3083\u3042NeuralNet\u306a\u3089naiveBayes\u306a\u3089randomForest\u306a\u3089\u3069\u3046\u306a\u306e\u304b\u3001\u3068\u3044\u3046\u306e\u3082\u6c17\u306b\u306a\u308b\u3051\u308c\u3069\u3001\u591a\u5206\u3001\u3060\u3044\u305f\u3044\u540c\u3058(\u8abf\u3079\u3066\u306a\u3044\u3051\u3069)\u3002\n\n# \u4eca\u56de\u306e\u7d50\u8ad6\n\n\u6a5f\u68b0\u5b66\u7fd2\u306e\u4e00\u7aef\u306b\u89e6\u308c\u305f\u6c17\u5206\u306a\u3093\u3060\u3051\u308c\u3069\u3001\u7d50\u5c40iris\u3063\u3066\u306e\u304c\u30b7\u30e7\u30a6\u30d6\u306a\u306e\u304b\u30a2\u30e4\u30e1\u306a\u306e\u304b\u30ab\u30ad\u30c4\u30d0\u30bf\u306a\u306e\u304b\u306f\u5206\u304b\u3089\u305a\u3058\u307e\u3044\u306a\u306e\u3067\u3042\u3063\u305f\u3002\n\n## \u8ffd\u8a18\n\u5f53\u521d\u300cPython\u3067\u6a5f\u68b0\u5b66\u7fd2\u306e\u3055\u308f\u308a\u3092\u3084\u3063\u3066\u307f\u308b\u300d\u3068\u3044\u3046\u30bf\u30a4\u30c8\u30eb\u3067\u3057\u305f\u304c\u3001\u300c\u3055\u308f\u308a\u306f\u6700\u3082\u76db\u308a\u4e0a\u304c\u308b\u6240\u306e\u610f\u5473\u3060\u304b\u3089\u3001\u30bf\u30a4\u30c8\u30eb\u306f\u3075\u3055\u308f\u3057\u304f\u306a\u3044\u300d\u3068\u306e\u3053\u3068\u3060\u3063\u305f\u306e\u3067\u3001\u4fee\u6b63\u3057\u307e\u3057\u305f\u3002\n\n\u300cPython\u3067SVM\u3067\u5224\u5225\u5668\u3092\u4f5c\u308c\u308b\u300d\u306e\u3063\u3066\u3001\u500b\u4eba\u7684\u306b\u306f\u76db\u308a\u4e0a\u304c\u308b\u30dd\u30a4\u30f3\u30c8\u3060\u3068\u601d\u3046\u3093\u3060\u3051\u3069\u3001\u72ec\u308a\u3088\u304c\u308a\u3060\u3063\u305f\u307f\u305f\u3044\u3067\u3059\u3002SVM\u3054\u3068\u304d\u3067\u6a5f\u68b0\u5b66\u7fd2\u3092\u8a9e\u3063\u3066\u3059\u307f\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u51fa\u76f4\u3057\u3066\u304d\u307e\u3059\u3002\n\n## \u4eca\u56de\u306e\u30b3\u30fc\u30c9\n\n- https://github.com/fukuit/Python_SelfLearning/blob/master/ml_svm.py\n\n"}