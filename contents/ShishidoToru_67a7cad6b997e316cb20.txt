{"context": "\n\nGAS\u5074\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3059\u308b\n\u3000https://script.google.com\n\u304b\u3089\u72ec\u7acb\u3057\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u4f55\u3067\u3082\u304b\u307e\u3044\u307e\u305b\u3093\u3002 \n\u3000\n\u3000\u516c\u5f0f\u30b5\u30a4\u30c8\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u30b3\u30d4\u30da\u3057\u3001\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n\u30b3\u30fc\u30c9.gs\nfunction getFoldersUnderRoot() {\n  var root = DriveApp.getRootFolder();\n  var folders = root.getFolders();\n  var folderSet = {};\n  while (folders.hasNext()) {\n    var folder = folders.next();\n    folderSet[folder.getId()] = folder.getName();\n  }\n  return folderSet;\n}\n\n\n\u3000\u30b0\u30fc\u30b0\u30eb\u30c9\u30e9\u30a4\u30d6\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3055\u308c\u305f\u30d5\u30a9\u30eb\u30c0\u540d\u3092\u3059\u3079\u3066\u8fd4\u3059\u95a2\u6570\u3067\u3059\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8ID\u53d6\u5f97\n\u3000\u753b\u9762\u4e0a\u90e8\u306e\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u304b\u3089\u300c\u30d5\u30a1\u30a4\u30eb\u300d\u2192\u300c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u300d\u304b\u3089\u60c5\u5831\u30bf\u30d6\u306e\u306a\u304b\u306b\u3042\u308b\u306e\u3067\u305d\u308c\u3092\u3069\u3053\u304b\u306b\u30b3\u30d4\u30da\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u3042\u3068\u3067\u30b5\u30fc\u30d0\u30fc\u5074\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u3068\u304d\u306b\u4f7f\u3044\u307e\u3059\u3002\n\u3000\u3042\u308b\u3044\u306fURL\u6b04\u304b\u3089\u8abf\u3079\u3066\u3082\u540c\u3058\u3067\u3001https://script.google.com/d/\u30b9\u30af\u30ea\u30d7\u30c8ID/edit?usp=drive_web&folder=xxxxx&splash=yes\u306e\u306a\u304b\u306e\u3001\u30b9\u30af\u30ea\u30d7\u30c8ID\u304c\u305d\u308c\u3067\u3059\u3002\n\n\u516c\u958b\n\u3000\u540c\u3058\u304f\u753b\u9762\u4e0a\u90e8\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u304b\u3089\u300c\u516c\u958b\u300d\u2192\u300c\u5b9f\u884c\u53ef\u80fdAPI\u3068\u3057\u3066\u5c0e\u5165\u300d\u3068\u9032\u307f\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u300c\u65b0\u898f\u300d\u3068\u3057\u3066\u540d\u524d\u306f\u9069\u5f53\u306b\u4ed8\u3051\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30e6\u30fc\u30b6\u30fc\u306f\u300c\u81ea\u5206\u306e\u307f\u300d\u3068\u3057\u307e\u3059\u3002\n\u3000\u307e\u305f\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u30dc\u30c3\u30af\u30b9\u306b\u300c\u73fe\u5728\u306eAPI ID\u300d\u3068\u3044\u3046\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3053\u308c\u306f\u4eca\u56de\u7279\u306b\u5229\u7528\u3057\u307e\u305b\u3093\u3002\n\nExecution API\u6709\u52b9\u5316\n\u3000\u540c\u3058\u304f\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u304b\u3089\u300c\u30ea\u30bd\u30fc\u30b9\u300d\u2192\u300cDevelopers Console \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u300d\u3068\u9032\u307f\u3001\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u73fe\u5728\u95a2\u9023\u4ed8\u3051\u3089\u308c\u3066\u3044\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8:\u306e\u4e0b\u306b\u9752\u6587\u5b57\u3067\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u30ea\u30f3\u30af\u5148\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\u3000API Manager\u753b\u9762\u306b\u306a\u3063\u305f\u3089\u5de6\u30b5\u30a4\u30c9\u30d0\u30fc\u304b\u3089\u300c\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u753b\u9762\u4e0a\u90e8\u306b\u3042\u308b\u300cAPI\u3092\u6709\u52b9\u306b\u3059\u308b\u300d\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4e00\u89a7\u304c\u8868\u793a\u3055\u308c\u307e\u3059\uff08\u6700\u521d\u304b\u3089\u5de6\u30d0\u30fc\u304b\u3089\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u9078\u629e\u3057\u3066\u3082\u540c\u3058\u304b\uff09\u3002\n\n\u3000\u3053\u3053\u304c\u3084\u3084\u3053\u3057\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u306e\u4e2d\u306b\u306fExcution API\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u305d\u3053\u3067\u691c\u7d22\u30dc\u30c3\u30af\u30b9\u306b\u300cExecution\u300d\u306a\u3069\u3068\u5165\u529b\u3057\u3066Excution API\u3092\u8868\u793a\u3055\u305b\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u3057\u3066\u300cGoogle Apps Script Execution API\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u6b21\u3078\u9032\u307f\u307e\u3059\uff08\u500b\u4eba\u7684\u306b\u306f\u3053\u3053\u304c\u4e00\u756a\u30cf\u30de\u308a\u307e\u3057\u305f\uff09\u3002\n\n\u3000\u305d\u3057\u3066\u300c\u6709\u52b9\u306b\u3059\u308b\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n\n\n\u8a8d\u8a3c\u60c5\u5831\u8a2d\u5b9a\n\u3000\u5148\u7a0b\u306eAPI Manager\u753b\u9762\u306e\u5de6\u30b5\u30a4\u30c9\u30d0\u30fc\u304b\u3089\u300c\u8a8d\u8a3c\u60c5\u5831\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\u3000\u3053\u3053\u304b\u3089OAuth\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n\u3000\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7a2e\u985e\u306f\u300c\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\u540d\u524d\u306f\u9069\u5f53\u3067\u304b\u307e\u3044\u307e\u305b\u3093\u3002\u300c\u627f\u8a8d\u6e08\u307f\u306eJavaScript\u751f\u6210\u5143\u300d\u306f\u5404\u81ea\u304c\u4f7f\u3063\u3066\u3044\u308bWeb\u30b5\u30fc\u30d0\u30fc\u306ehttp://www.sample.com \u306e\u3088\u3046\u306b\u5165\u529b\u3057\u3066\u304a\u304d\uff08\u30c8\u30c3\u30d7\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u8a00\u3063\u305f\u3089\u3044\u3044\u306e\u304b\uff1f\uff09\u3001\u4e0b\u6bb5\u306e\u300c\u627f\u8a8d\u6e08\u307f\u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI\u300d\u306fhttp://www.sample.com/quickstart.html \u306e\u3088\u3046\u306b\u5165\u529b\u3057\u3066\u304a\u304d\u307e\u3059\u3002quickstart.html\u306f\u3042\u3068\u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3000\u3067\u3001\u4f5c\u6210\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\u3000\u3059\u308b\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u304c\u751f\u6210\u3055\u308c\u3066\u304a\u308a\u3001\u4eca\u56de\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3060\u3051\u4f7f\u7528\u3059\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u3069\u3053\u304b\u306b\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u30b5\u30fc\u30d0\u30fc\u5074\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\n\u3000\u516c\u5f0f\u30b5\u30a4\u30c8\u306e\u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u30b3\u30d4\u30da\u3057\u307e\u3059\u304c\u3001 <YOUR_CLIENT_ID>\u306f\u8a8d\u8a3c\u60c5\u5831\u8a2d\u5b9a\u6642\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3092\u3001ENTER_YOUR_SCRIPT_ID_HERE\u306e\u90e8\u5206\u306f\u6700\u521d\u306e\u65b9\u3067\u793a\u3057\u305f\u30b9\u30af\u30ea\u30d7\u30c8ID\u3092\u5165\u308c\u307e\u3059\u3002\u3053\u308c\u3092\u8a8d\u8a3c\u8a2d\u5b9a\u306e\u3068\u304d\u306e\u8a2d\u5b9a\u306b\u6cbf\u3063\u3066http:www.sample.com/quickstart.html \u306b\u7f6e\u304d\u307e\u3059\u3002\n\nquickstart.html\n<html>\n  <head>\n    <script type=\"text/javascript\">\n      // Your Client ID can be retrieved from your project in the Google\n      // Developer Console, https://console.developers.google.com\n      var CLIENT_ID = '<YOUR_CLIENT_ID>'; // \u2190\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\n\n      var SCOPES = ['https://www.googleapis.com/auth/drive'];\n\n      /**\n       * Check if current user has authorized this application.\n       */\n      function checkAuth() {\n        gapi.auth.authorize(\n          {\n            'client_id': CLIENT_ID,\n            'scope': SCOPES.join(' '),\n            'immediate': true\n          }, handleAuthResult);\n      }\n\n      /**\n       * Handle response from authorization server.\n       *\n       * @param {Object} authResult Authorization result.\n       */\n      function handleAuthResult(authResult) {\n        var authorizeDiv = document.getElementById('authorize-div');\n        if (authResult && !authResult.error) {\n          // Hide auth UI, then load client library.\n          authorizeDiv.style.display = 'none';\n          callScriptFunction();\n        } else {\n          // Show auth UI, allowing the user to initiate authorization by\n          // clicking authorize button.\n          authorizeDiv.style.display = 'inline';\n        }\n      }\n\n      /**\n       * Initiate auth flow in response to user clicking authorize button.\n       *\n       * @param {Event} event Button click event.\n       */\n      function handleAuthClick(event) {\n        gapi.auth.authorize(\n          {client_id: CLIENT_ID, scope: SCOPES, immediate: false},\n          handleAuthResult);\n        return false;\n      }\n\n      /**\n       * Calls an Apps Script function to list the folders in the user's\n       * root Drive folder.\n       */\n      function callScriptFunction() {\n        var scriptId = \"ENTER_YOUR_SCRIPT_ID_HERE\"; // \u2190\u30b9\u30af\u30ea\u30d7\u30c8ID\n\n        // Create an execution request object.\n        var request = {\n            'function': 'getFoldersUnderRoot'\n            };\n\n        // Make the API request.\n        var op = gapi.client.request({\n            'root': 'https://script.googleapis.com',\n            'path': 'v1/scripts/' + scriptId + ':run',\n            'method': 'POST',\n            'body': request\n        });\n\n        op.execute(function(resp) {\n          if (resp.error && resp.error.status) {\n            // The API encountered a problem before the script\n            // started executing.\n            appendPre('Error calling API:');\n            appendPre(JSON.stringify(resp, null, 2));\n          } else if (resp.error) {\n            // The API executed, but the script returned an error.\n\n            // Extract the first (and only) set of error details.\n            // The values of this object are the script's 'errorMessage' and\n            // 'errorType', and an array of stack trace elements.\n            var error = resp.error.details[0];\n            appendPre('Script error message: ' + error.errorMessage);\n\n            if (error.scriptStackTraceElements) {\n              // There may not be a stacktrace if the script didn't start\n              // executing.\n              appendPre('Script error stacktrace:');\n              for (var i = 0; i < error.scriptStackTraceElements.length; i++) {\n                var trace = error.scriptStackTraceElements[i];\n                appendPre('\\t' + trace.function + ':' + trace.lineNumber);\n              }\n            }\n          } else {\n            // The structure of the result will depend upon what the Apps\n            // Script function returns. Here, the function returns an Apps\n            // Script Object with String keys and values, and so the result\n            // is treated as a JavaScript object (folderSet).\n            var folderSet = resp.response.result;\n            if (Object.keys(folderSet).length == 0) {\n                appendPre('No folders returned!');\n            } else {\n              appendPre('Folders under your root folder:');\n              Object.keys(folderSet).forEach(function(id){\n                appendPre('\\t' + folderSet[id] + ' (' + id  + ')');\n              });\n            }\n          }\n        });\n      }\n\n      /**\n       * Append a pre element to the body containing the given message\n       * as its text node.\n       *\n       * @param {string} message Text to be placed in pre element.\n       */\n      function appendPre(message) {\n        var pre = document.getElementById('output');\n        var textContent = document.createTextNode(message + '\\n');\n        pre.appendChild(textContent);\n      }\n\n    </script>\n    <script src=\"https://apis.google.com/js/client.js?onload=checkAuth\">\n    </script>\n  </head>\n  <body>\n    <div id=\"authorize-div\" style=\"display: none\">\n      <span>Authorize access to Google Apps Script Execution API</span>\n      <!--Button for the user to click to initiate auth sequence -->\n      <button id=\"authorize-button\" onclick=\"handleAuthClick(event)\">\n        Authorize\n      </button>\n    </div>\n    <pre id=\"output\"></pre>\n  </body>\n</html>\n\n\n\u3000\u521d\u56de\u30a2\u30af\u30bb\u30b9\u6642\u306e\u307f\u3001\u8a8d\u8a3c\u753b\u9762\u3078\u306e\u30af\u30ea\u30c3\u30af\u30dc\u30bf\u30f3\u304c\u73fe\u308c\u3066\u3001\u8a8d\u8a3c\u6210\u529f\u3059\u308b\u3068\u51e6\u7406\u304c\u9032\u307f\u3001GAS\u304c\u5410\u304d\u51fa\u3059\u30c7\u30fc\u30bf\u3092JavaScript\u3067\u53d7\u3051\u53d6\u3063\u3066\u8868\u793a\u3001\u3068\u3044\u3046\u6d41\u308c\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\nvar request = {\n  'function': 'getFoldersUnderRoot'\n};\n\n\u3000\u3053\u3053\u3067\u3059\u306d\u3002getFolersUnderRoot\u3068\u3044\u3046\u306e\u306f\u3055\u3063\u304dGAS\u5074\u3067\u66f8\u3044\u305f\u95a2\u6570\u3067\u3059\u3002GAS\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u6295\u3052\u3066\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u3082\u3089\u3063\u3066\u8868\u793a\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\u3000http://www.example.com/quickstart.html\n\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001\u8a8d\u8a3c\u306b\u6210\u529f\u3057\u3066\u30d5\u30a9\u30eb\u30c0\u30fc\u540d\u306e\u4e00\u89a7\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u30b4\u30fc\u30eb\u3067\u3059\u3002\n\u3000\u3068\u306b\u304b\u304f\u624b\u9806\u304c\u5206\u304b\u308a\u306b\u304f\u3044\u306e\u3067\u305d\u306e\u3046\u3061\u3084\u308a\u65b9\u304c\u5927\u5e45\u306b\u5909\u308f\u3063\u3066\u3057\u307e\u3046\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u500b\u4eba\u7684\u306b\u306f\u5371\u60e7\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u3061\u306a\u307f\u306b\n\u3000\u5b9f\u8df5\u7684\u306b\u306f\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u4f55\u304b\u3057\u3089\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u3068\u3044\u3046\u6d41\u308c\u3092\u4f5c\u308a\u305f\u3044\u3067\u3057\u3087\u3046\u3002\u305d\u306e\u30b5\u30f3\u30d7\u30eb\u306f\u5f8c\u65e5\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u30b5\u30a4\u30c8\nGAS\u306eExecution API\u3092\u4f7f\u3063\u3066GAS\u3092\u5916\u90e8\u304b\u3089\u3076\u3063\u53e9\u304f\nCreate a Target Project for the Apps Script Execution API\nJavaScript Quickstart\n#GAS\u5074\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7528\u610f\u3059\u308b\n\u3000https://script.google.com\n\u304b\u3089\u72ec\u7acb\u3057\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\u3057\u307e\u3059\u3002\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u4f55\u3067\u3082\u304b\u307e\u3044\u307e\u305b\u3093\u3002 \n\n\u3000\n\u3000[\u516c\u5f0f\u30b5\u30a4\u30c8](https://developers.google.com/apps-script/guides/rest/quickstart/target-script)\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u30b3\u30d4\u30da\u3057\u3001\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n```js:\u30b3\u30fc\u30c9.gs\nfunction getFoldersUnderRoot() {\n  var root = DriveApp.getRootFolder();\n  var folders = root.getFolders();\n  var folderSet = {};\n  while (folders.hasNext()) {\n    var folder = folders.next();\n    folderSet[folder.getId()] = folder.getName();\n  }\n  return folderSet;\n}\n```\n\n\u3000\u30b0\u30fc\u30b0\u30eb\u30c9\u30e9\u30a4\u30d6\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3055\u308c\u305f\u30d5\u30a9\u30eb\u30c0\u540d\u3092\u3059\u3079\u3066\u8fd4\u3059\u95a2\u6570\u3067\u3059\u3002\n\n#\u30b9\u30af\u30ea\u30d7\u30c8ID\u53d6\u5f97\n\u3000\u753b\u9762\u4e0a\u90e8\u306e\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u304b\u3089\u300c\u30d5\u30a1\u30a4\u30eb\u300d\u2192\u300c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u300d\u304b\u3089\u60c5\u5831\u30bf\u30d6\u306e\u306a\u304b\u306b\u3042\u308b\u306e\u3067\u305d\u308c\u3092\u3069\u3053\u304b\u306b\u30b3\u30d4\u30da\u3057\u3066\u304a\u304d\u307e\u3059\u3002<font color=\"Blue\">\u3042\u3068\u3067\u30b5\u30fc\u30d0\u30fc\u5074\u306e\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u3068\u304d\u306b\u4f7f\u3044\u307e\u3059\u3002\n\n\u3000\u3042\u308b\u3044\u306fURL\u6b04\u304b\u3089\u8abf\u3079\u3066\u3082\u540c\u3058\u3067\u3001https\\://script.google.com/d/\u30b9\u30af\u30ea\u30d7\u30c8ID/edit?usp=drive_web&folder=xxxxx&splash=yes\u306e\u306a\u304b\u306e\u3001\u30b9\u30af\u30ea\u30d7\u30c8ID\u304c\u305d\u308c\u3067\u3059\u3002\n\n#\u516c\u958b\n\u3000\u540c\u3058\u304f\u753b\u9762\u4e0a\u90e8\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u304b\u3089\u300c\u516c\u958b\u300d\u2192\u300c\u5b9f\u884c\u53ef\u80fdAPI\u3068\u3057\u3066\u5c0e\u5165\u300d\u3068\u9032\u307f\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u300c\u65b0\u898f\u300d\u3068\u3057\u3066\u540d\u524d\u306f\u9069\u5f53\u306b\u4ed8\u3051\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30e6\u30fc\u30b6\u30fc\u306f\u300c\u81ea\u5206\u306e\u307f\u300d\u3068\u3057\u307e\u3059\u3002\n\n\u3000\u307e\u305f\u3001\u30c0\u30a4\u30a2\u30ed\u30b0\u30dc\u30c3\u30af\u30b9\u306b\u300c\u73fe\u5728\u306eAPI ID\u300d\u3068\u3044\u3046\u60c5\u5831\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3053\u308c\u306f\u4eca\u56de\u7279\u306b\u5229\u7528\u3057\u307e\u305b\u3093\u3002\n\n#Execution API\u6709\u52b9\u5316\n\u3000\u540c\u3058\u304f\u30e1\u30cb\u30e5\u30fc\u30d0\u30fc\u304b\u3089\u300c\u30ea\u30bd\u30fc\u30b9\u300d\u2192\u300cDevelopers Console \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u300d\u3068\u9032\u307f\u3001\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u73fe\u5728\u95a2\u9023\u4ed8\u3051\u3089\u308c\u3066\u3044\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8:\u306e\u4e0b\u306b\u9752\u6587\u5b57\u3067\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u30ea\u30f3\u30af\u5148\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n\u3000API Manager\u753b\u9762\u306b\u306a\u3063\u305f\u3089\u5de6\u30b5\u30a4\u30c9\u30d0\u30fc\u304b\u3089\u300c\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u753b\u9762\u4e0a\u90e8\u306b\u3042\u308b\u300cAPI\u3092\u6709\u52b9\u306b\u3059\u308b\u300d\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4e00\u89a7\u304c\u8868\u793a\u3055\u308c\u307e\u3059\uff08\u6700\u521d\u304b\u3089\u5de6\u30d0\u30fc\u304b\u3089\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u9078\u629e\u3057\u3066\u3082\u540c\u3058\u304b\uff09\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-13 23.56.44.png](https://qiita-image-store.s3.amazonaws.com/0/139134/da640619-9281-a4a1-ca2a-ff3601b1fd83.png)\n\n\u3000<font color=\"Red\">\u3053\u3053\u304c\u3084\u3084\u3053\u3057\u3044\u306e\u3067\u3059\u304c\u3001\u3053\u306e\u4e2d\u306b\u306fExcution API\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u305d\u3053\u3067\u691c\u7d22\u30dc\u30c3\u30af\u30b9\u306b\u300cExecution\u300d\u306a\u3069\u3068\u5165\u529b\u3057\u3066Excution API\u3092\u8868\u793a\u3055\u305b\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u3057\u3066\u300cGoogle Apps Script Execution API\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u6b21\u3078\u9032\u307f\u307e\u3059\uff08\u500b\u4eba\u7684\u306b\u306f\u3053\u3053\u304c\u4e00\u756a\u30cf\u30de\u308a\u307e\u3057\u305f\uff09\u3002</font>\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-14 0.00.48.png](https://qiita-image-store.s3.amazonaws.com/0/139134/67b0024f-393d-0eb4-d143-09c5f3363078.png)\n\n\n\u3000\u305d\u3057\u3066\u300c\u6709\u52b9\u306b\u3059\u308b\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u6709\u52b9\u5316\u3057\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-14 0.03.59.png](https://qiita-image-store.s3.amazonaws.com/0/139134/6098fda1-50b2-dc5f-8ae9-9b72ff89e48e.png)\n\n#\u8a8d\u8a3c\u60c5\u5831\u8a2d\u5b9a\n\u3000\u5148\u7a0b\u306eAPI Manager\u753b\u9762\u306e\u5de6\u30b5\u30a4\u30c9\u30d0\u30fc\u304b\u3089\u300c\u8a8d\u8a3c\u60c5\u5831\u300d\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-14 0.14.47.png](https://qiita-image-store.s3.amazonaws.com/0/139134/dd230160-c4c0-530d-4edd-598e72f49d02.png)\n\n\u3000\u3053\u3053\u304b\u3089OAuth\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-14 0.17.09.png](https://qiita-image-store.s3.amazonaws.com/0/139134/63c268fd-630a-0ae5-3b98-bf02f7e5d349.png)\n\n\u3000\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7a2e\u985e\u306f\u300c\u30a6\u30a7\u30d6\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\u540d\u524d\u306f\u9069\u5f53\u3067\u304b\u307e\u3044\u307e\u305b\u3093\u3002\u300c\u627f\u8a8d\u6e08\u307f\u306eJavaScript\u751f\u6210\u5143\u300d\u306f\u5404\u81ea\u304c\u4f7f\u3063\u3066\u3044\u308bWeb\u30b5\u30fc\u30d0\u30fc\u306ehttp\\://www.sample.com \u306e\u3088\u3046\u306b\u5165\u529b\u3057\u3066\u304a\u304d\uff08\u30c8\u30c3\u30d7\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u8a00\u3063\u305f\u3089\u3044\u3044\u306e\u304b\uff1f\uff09\u3001\u4e0b\u6bb5\u306e\u300c\u627f\u8a8d\u6e08\u307f\u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI\u300d\u306fhttp\\://www.sample.com/quickstart.html \u306e\u3088\u3046\u306b\u5165\u529b\u3057\u3066\u304a\u304d\u307e\u3059\u3002quickstart.html\u306f\u3042\u3068\u3067\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u3000\u3067\u3001\u4f5c\u6210\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-11-14 0.30.37.png](https://qiita-image-store.s3.amazonaws.com/0/139134/51eb194b-6058-431d-5cfd-4bdf696a0013.png)\n\n\u3000\u3059\u308b\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u304c\u751f\u6210\u3055\u308c\u3066\u304a\u308a\u3001<font color=\"Blue\">\u4eca\u56de\u306f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3060\u3051\u4f7f\u7528\u3059\u308b\u306e\u3067\u3001\u305d\u308c\u3092\u3069\u3053\u304b\u306b\u30b3\u30d4\u30fc\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n#\u30b5\u30fc\u30d0\u30fc\u5074\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u7528\u610f\u3059\u308b\n\n\u3000[\u516c\u5f0f\u30b5\u30a4\u30c8](https://developers.google.com/apps-script/guides/rest/quickstart/js)\u306e\u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u30b3\u30d4\u30da\u3057\u307e\u3059\u304c\u3001 \\<YOUR_CLIENT_ID>\u306f\u8a8d\u8a3c\u60c5\u5831\u8a2d\u5b9a\u6642\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3092\u3001ENTER_YOUR_SCRIPT_ID_HERE\u306e\u90e8\u5206\u306f\u6700\u521d\u306e\u65b9\u3067\u793a\u3057\u305f\u30b9\u30af\u30ea\u30d7\u30c8ID\u3092\u5165\u308c\u307e\u3059\u3002\u3053\u308c\u3092\u8a8d\u8a3c\u8a2d\u5b9a\u306e\u3068\u304d\u306e\u8a2d\u5b9a\u306b\u6cbf\u3063\u3066http\\:www.sample.com/quickstart.html \u306b\u7f6e\u304d\u307e\u3059\u3002\n\n```html:quickstart.html\n<html>\n  <head>\n    <script type=\"text/javascript\">\n      // Your Client ID can be retrieved from your project in the Google\n      // Developer Console, https://console.developers.google.com\n      var CLIENT_ID = '<YOUR_CLIENT_ID>'; // \u2190\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\n\n      var SCOPES = ['https://www.googleapis.com/auth/drive'];\n\n      /**\n       * Check if current user has authorized this application.\n       */\n      function checkAuth() {\n        gapi.auth.authorize(\n          {\n            'client_id': CLIENT_ID,\n            'scope': SCOPES.join(' '),\n            'immediate': true\n          }, handleAuthResult);\n      }\n\n      /**\n       * Handle response from authorization server.\n       *\n       * @param {Object} authResult Authorization result.\n       */\n      function handleAuthResult(authResult) {\n        var authorizeDiv = document.getElementById('authorize-div');\n        if (authResult && !authResult.error) {\n          // Hide auth UI, then load client library.\n          authorizeDiv.style.display = 'none';\n          callScriptFunction();\n        } else {\n          // Show auth UI, allowing the user to initiate authorization by\n          // clicking authorize button.\n          authorizeDiv.style.display = 'inline';\n        }\n      }\n\n      /**\n       * Initiate auth flow in response to user clicking authorize button.\n       *\n       * @param {Event} event Button click event.\n       */\n      function handleAuthClick(event) {\n        gapi.auth.authorize(\n          {client_id: CLIENT_ID, scope: SCOPES, immediate: false},\n          handleAuthResult);\n        return false;\n      }\n\n      /**\n       * Calls an Apps Script function to list the folders in the user's\n       * root Drive folder.\n       */\n      function callScriptFunction() {\n        var scriptId = \"ENTER_YOUR_SCRIPT_ID_HERE\"; // \u2190\u30b9\u30af\u30ea\u30d7\u30c8ID\n\n        // Create an execution request object.\n        var request = {\n            'function': 'getFoldersUnderRoot'\n            };\n\n        // Make the API request.\n        var op = gapi.client.request({\n            'root': 'https://script.googleapis.com',\n            'path': 'v1/scripts/' + scriptId + ':run',\n            'method': 'POST',\n            'body': request\n        });\n\n        op.execute(function(resp) {\n          if (resp.error && resp.error.status) {\n            // The API encountered a problem before the script\n            // started executing.\n            appendPre('Error calling API:');\n            appendPre(JSON.stringify(resp, null, 2));\n          } else if (resp.error) {\n            // The API executed, but the script returned an error.\n\n            // Extract the first (and only) set of error details.\n            // The values of this object are the script's 'errorMessage' and\n            // 'errorType', and an array of stack trace elements.\n            var error = resp.error.details[0];\n            appendPre('Script error message: ' + error.errorMessage);\n\n            if (error.scriptStackTraceElements) {\n              // There may not be a stacktrace if the script didn't start\n              // executing.\n              appendPre('Script error stacktrace:');\n              for (var i = 0; i < error.scriptStackTraceElements.length; i++) {\n                var trace = error.scriptStackTraceElements[i];\n                appendPre('\\t' + trace.function + ':' + trace.lineNumber);\n              }\n            }\n          } else {\n            // The structure of the result will depend upon what the Apps\n            // Script function returns. Here, the function returns an Apps\n            // Script Object with String keys and values, and so the result\n            // is treated as a JavaScript object (folderSet).\n            var folderSet = resp.response.result;\n            if (Object.keys(folderSet).length == 0) {\n                appendPre('No folders returned!');\n            } else {\n              appendPre('Folders under your root folder:');\n              Object.keys(folderSet).forEach(function(id){\n                appendPre('\\t' + folderSet[id] + ' (' + id  + ')');\n              });\n            }\n          }\n        });\n      }\n\n      /**\n       * Append a pre element to the body containing the given message\n       * as its text node.\n       *\n       * @param {string} message Text to be placed in pre element.\n       */\n      function appendPre(message) {\n        var pre = document.getElementById('output');\n        var textContent = document.createTextNode(message + '\\n');\n        pre.appendChild(textContent);\n      }\n\n    </script>\n    <script src=\"https://apis.google.com/js/client.js?onload=checkAuth\">\n    </script>\n  </head>\n  <body>\n    <div id=\"authorize-div\" style=\"display: none\">\n      <span>Authorize access to Google Apps Script Execution API</span>\n      <!--Button for the user to click to initiate auth sequence -->\n      <button id=\"authorize-button\" onclick=\"handleAuthClick(event)\">\n        Authorize\n      </button>\n    </div>\n    <pre id=\"output\"></pre>\n  </body>\n</html>\n```\n\n\u3000\u521d\u56de\u30a2\u30af\u30bb\u30b9\u6642\u306e\u307f\u3001\u8a8d\u8a3c\u753b\u9762\u3078\u306e\u30af\u30ea\u30c3\u30af\u30dc\u30bf\u30f3\u304c\u73fe\u308c\u3066\u3001\u8a8d\u8a3c\u6210\u529f\u3059\u308b\u3068\u51e6\u7406\u304c\u9032\u307f\u3001GAS\u304c\u5410\u304d\u51fa\u3059\u30c7\u30fc\u30bf\u3092JavaScript\u3067\u53d7\u3051\u53d6\u3063\u3066\u8868\u793a\u3001\u3068\u3044\u3046\u6d41\u308c\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```\nvar request = {\n  'function': 'getFoldersUnderRoot'\n};\n```\n\u3000\u3053\u3053\u3067\u3059\u306d\u3002getFolersUnderRoot\u3068\u3044\u3046\u306e\u306f\u3055\u3063\u304dGAS\u5074\u3067\u66f8\u3044\u305f\u95a2\u6570\u3067\u3059\u3002GAS\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u6295\u3052\u3066\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u3082\u3089\u3063\u3066\u8868\u793a\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n\u3000http\\://www.example.com/quickstart.html\n\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001\u8a8d\u8a3c\u306b\u6210\u529f\u3057\u3066\u30d5\u30a9\u30eb\u30c0\u30fc\u540d\u306e\u4e00\u89a7\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u30b4\u30fc\u30eb\u3067\u3059\u3002\n\n\u3000\u3068\u306b\u304b\u304f\u624b\u9806\u304c\u5206\u304b\u308a\u306b\u304f\u3044\u306e\u3067\u305d\u306e\u3046\u3061\u3084\u308a\u65b9\u304c\u5927\u5e45\u306b\u5909\u308f\u3063\u3066\u3057\u307e\u3046\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u500b\u4eba\u7684\u306b\u306f\u5371\u60e7\u3057\u3066\u3044\u307e\u3059\u3002\n\n#\u3061\u306a\u307f\u306b\n\u3000\u5b9f\u8df5\u7684\u306b\u306f\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u304b\u3089\u4f55\u304b\u3057\u3089\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u3068\u3044\u3046\u6d41\u308c\u3092\u4f5c\u308a\u305f\u3044\u3067\u3057\u3087\u3046\u3002\u305d\u306e\u30b5\u30f3\u30d7\u30eb\u306f\u5f8c\u65e5\u7d39\u4ecb\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n#\u53c2\u8003\u30b5\u30a4\u30c8\n[GAS\u306eExecution API\u3092\u4f7f\u3063\u3066GAS\u3092\u5916\u90e8\u304b\u3089\u3076\u3063\u53e9\u304f](http://qiita.com/soundTricker/items/1bcfc5c9e80d29a7ae4b)\n[Create a Target Project for the Apps Script Execution API](https://developers.google.com/apps-script/guides/rest/quickstart/target-script)\n[JavaScript Quickstart](https://developers.google.com/apps-script/guides/rest/quickstart/js)\n", "tags": ["GoogleAppsScript", "JavaScript"]}