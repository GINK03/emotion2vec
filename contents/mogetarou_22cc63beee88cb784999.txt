{"context": "\n\n\u306f\u3058\u3081\u306b\nFuelPHP\u6a19\u6e96\u306eRequest_Curl\u3067\u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3092\u3059\u308b\u6a5f\u4f1a\u304c\u3042\u3063\u305f\u306e\u3067\u305d\u306e\u30b5\u30f3\u30d7\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\u4ed6\u3067\u3084\u308c\u3070\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u6a19\u6e96\u4f7f\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u8abf\u3079\u307e\u3057\u305f\u3002\nCurl\u306e\u5834\u5408\uff20\u3092\u4f7f\u7528\u3059\u308c\u3070\u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u306a\u308b\u306f\u305a\u306a\u306e\u3067\u3059\u304c\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u5fae\u5999\u306b\u306f\u307e\u308a\u307e\u3057\u305f\u3002\n\u74b0\u5883\nFuelPHP 1.7\nPHP 5.6.18\n\n\u6982\u8981\n\n\u30bd\u30fc\u30b9\u4f5c\u6210\n\u5b9f\u884c\n\n\n\u8a73\u7d30\n\n\n1. \u30bd\u30fc\u30b9\u4f5c\u6210\n\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nnamespace Fuel\\Tasks;\n\nclass UploadTest {\n\n    public function run() {\n        $params = array(\n            'post_param1'   => '\u30c7\u30fc\u30bf\uff11'\n        ,   'fileupload'    => \\CURLFile(dirname(__FILE__).\"/upload.csv\");\n        );\n        $postparam  = array(\n            'form-data'     => $params\n        );\n\n        $curl       = \\Request::forge($url, 'curl');\n        $curl->set_method('post');\n        $curl->set_params($postparam);\n        $curl->set_option(CURLOPT_RETURNTRANSFER,true); \n        $curl->set_option(CURLOPT_BINARYTRANSFER,true);\n        $curl->set_header('Content-Type','multipart/form-data');\n        $execResult = $curl->execute();\n        $response   = $execResult->response();\n        $result     = $response->body;\n        print_r($result);\n    }\n}\n\n\n2. \u30bd\u30fc\u30b9\u4f5c\u6210\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n$oil refine UploadTest\n\n\n\u3042\u3068\u304c\u304d\nset_option\u3067CURLOPT_RETURNTRANSFER\u306f\u30bd\u30fc\u30b9\u3092\u898b\u308b\u3068CURLOPT_\u3064\u3051\u3066\u3044\u308b\u611f\u3058\u306a\u306e\u3067\u6587\u5b57\u5217\u3067\u6307\u5b9a\u3059\u308b\u5834\u5408\u306fRETURNTRANSFER\u3067\u3082\u826f\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\ncurl.php\n\uff1a\n    public function set_options(array $options)\n    {\n        foreach ($options as $key => $val)\n        {\n            if (is_string($key) && ! is_numeric($key))\n            {\n                $key = constant('CURLOPT_' . strtoupper($key));\n            }\n\n            $this->options[$key] = $val;\n        }\n\n        return $this;\n    }\n\n\n\n\u305d\u306e\u4ed6\n\u53c2\u8003\nPHP\u3067cURL\u306e\u30af\u30bd\u4ed5\u69d8 \"@\" \u3092\u56de\u907f\u3059\u308b\n## \u306f\u3058\u3081\u306b\nFuelPHP\u6a19\u6e96\u306eRequest_Curl\u3067\u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3092\u3059\u308b\u6a5f\u4f1a\u304c\u3042\u3063\u305f\u306e\u3067\u305d\u306e\u30b5\u30f3\u30d7\u30eb\u306b\u306a\u308a\u307e\u3059\u3002\u4ed6\u3067\u3084\u308c\u3070\u3044\u3044\u306e\u3067\u3059\u304c\u3001\u6a19\u6e96\u4f7f\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u8abf\u3079\u307e\u3057\u305f\u3002\nCurl\u306e\u5834\u5408\uff20\u3092\u4f7f\u7528\u3059\u308c\u3070\u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u306a\u308b\u306f\u305a\u306a\u306e\u3067\u3059\u304c\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u5fae\u5999\u306b\u306f\u307e\u308a\u307e\u3057\u305f\u3002\n\n\u74b0\u5883\nFuelPHP 1.7\nPHP 5.6.18\n\n## \u6982\u8981\n1. \u30bd\u30fc\u30b9\u4f5c\u6210\n2. \u5b9f\u884c\n\n\n## \u8a73\u7d30\n----\n\n#### 1. \u30bd\u30fc\u30b9\u4f5c\u6210\n\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```php\nnamespace Fuel\\Tasks;\n\nclass UploadTest {\n\n\tpublic function run() {\n\t\t$params = array(\n\t\t\t'post_param1'\t=> '\u30c7\u30fc\u30bf\uff11'\n\t\t,\t'fileupload'\t=> \\CURLFile(dirname(__FILE__).\"/upload.csv\");\n\t\t);\n\t\t$postparam \t= array(\n\t\t\t'form-data'\t\t=> $params\n\t\t);\n\n\t\t$curl\t\t= \\Request::forge($url, 'curl');\n\t\t$curl->set_method('post');\n\t\t$curl->set_params($postparam);\n\t\t$curl->set_option(CURLOPT_RETURNTRANSFER,true); \n\t\t$curl->set_option(CURLOPT_BINARYTRANSFER,true);\n\t\t$curl->set_header('Content-Type','multipart/form-data');\n\t\t$execResult\t= $curl->execute();\n\t\t$response\t= $execResult->response();\n\t\t$result \t= $response->body;\n\t\tprint_r($result);\n\t}\n}\n```\n\n#### 2. \u30bd\u30fc\u30b9\u4f5c\u6210\n\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```shell-session\n$oil refine UploadTest\n```\n\n## \u3042\u3068\u304c\u304d\nset_option\u3067CURLOPT_RETURNTRANSFER\u306f\u30bd\u30fc\u30b9\u3092\u898b\u308b\u3068CURLOPT_\u3064\u3051\u3066\u3044\u308b\u611f\u3058\u306a\u306e\u3067\u6587\u5b57\u5217\u3067\u6307\u5b9a\u3059\u308b\u5834\u5408\u306fRETURNTRANSFER\u3067\u3082\u826f\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n```php:curl.php\n\uff1a\n\tpublic function set_options(array $options)\n\t{\n\t\tforeach ($options as $key => $val)\n\t\t{\n\t\t\tif (is_string($key) && ! is_numeric($key))\n\t\t\t{\n\t\t\t\t$key = constant('CURLOPT_' . strtoupper($key));\n\t\t\t}\n\n\t\t\t$this->options[$key] = $val;\n\t\t}\n\n\t\treturn $this;\n\t}\n```\n\n## \u305d\u306e\u4ed6\n\u53c2\u8003\n[PHP\u3067cURL\u306e\u30af\u30bd\u4ed5\u69d8 \"@\" \u3092\u56de\u907f\u3059\u308b](http://qiita.com/mpyw/items/c2d2f9cf67072e926721)\n\n", "tags": ["FuelPHP", "PHP", "curl"]}