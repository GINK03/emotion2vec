{"context": "MapBuilder\u3068\u547c\u3070\u308c\u308b\u3082\u306e\u306f\u3044\u308d\u3044\u308d\u3042\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u306a\u306b\u304b\u3053\u3046\u3057\u3063\u304f\u308a\u3053\u306a\u3044\u306e\u3067\u3059\u3002\n\u53f3\u5074\u306b\u7121\u99c4\u306a\u578b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u66f8\u304b\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u3058\u3083\u306a\u3044\u3067\u3059\u304b\uff1f\nMap<A,B> map = new MapBuilder<A,B>()...\n\n\u306e\u53f3\u5074\u306eA,B\u304c\u7121\u99c4\u306a\u6c17\u304c\u3057\u3066\u5acc\u306a\u306e\u3067\u3059\u3002\n\u305d\u3053\u3067\u5c11\u3057\u8003\u3048\u3066\u307f\u307e\u3057\u305f\u3002\npublic class MapBuilderTest {\n    Map<String,Integer> map = MapBuilder.createHashMap()\n            .$_(\"A\" , 1)\n            .$_(\"B\" , 2)\n            .$_(\"C\" , 3)\n            .buildUnmodifiable();\n\n    Map<Month,Integer> enumMap = MapBuilder.createEnumMap()\n            .$_(Month.JANUARY  , 1)\n            .$_(Month.FEBRUARY , 2)\n            .$_(Month.MARCH    , 3)\n            .build();\n\n    Map<String,String> map2 = createHashMap(\n            $(\"A\",\"a\"),\n            $(\"B\",\"b\"),\n            $(\"C\",\"c\")\n    );\n\n\u4e0a\u4e8c\u3064\u306f\u3044\u308f\u3086\u308bfluent interface\u3092\u3082\u3061\u3044\u305f\u3082\u306e(type A)\u3001\u4e0b\u306fEntry\u914d\u5217\u3092\u7528\u3044\u305f\u3082\u306e(type B)\u3067\u3059\u3002\n\u4f7f\u3044\u52dd\u624b\u3068\u3057\u3066\u3069\u3061\u3089\u304c\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u304b\u306d\u3002\n\n\u5b9f\u88c5\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\ntype A\npublic class MapBuilder<K,V> {\n    private Map<K,V> map;\n\n    public static HashMapSeed createHashMap(){\n        return new HashMapSeed();\n    }\n    public static EnumMapSeed createEnumMap(){\n        return new EnumMapSeed();\n    }\n    private MapBuilder(Map<K,V> map){\n        this.map = map;\n    }\n    public MapBuilder<K,V> $_(K k,V v){\n        map.put(k,v);\n        return this;\n    }\n    public Map<K,V> buildUnmodifiable(){\n        return Collections.unmodifiableMap(map);\n    }\n    public Map<K,V> build(){\n        return map;\n    }\n    public static class HashMapSeed{\n        public <K,V> MapBuilder<K,V> $_(K k,V v){\n            MapBuilder<K,V> builder = new MapBuilder<K,V>(new HashMap<K,V>());\n            return builder.$_(k,v);\n        }\n    }\n    public static class EnumMapSeed{\n        public <K extends Enum<K>,V> MapBuilder<K,V> $_(K k,V v){\n            MapBuilder<K,V> builder = new MapBuilder<>(new EnumMap<>(k.getClass()));\n            return builder.$_(k,v);\n        }\n    }\n}\n\n\ntype B\npublic class MapBuilder<K,V> {\n    public static class Entry<K,V>{\n        public K k;\n        public V v;\n        public Entry(K k,V v){\n            this.k = k;\n            this.v = v;\n        }\n    }\n    public static <K,V> Entry<K,V> $(K k, V v){\n        return new Entry<>(k,v);\n    }\n    public static <K,V> Map<K,V> createHashMap(Entry<? extends K,? extends V>...entries){\n        Map<K,V> map = new HashMap<>();\n        for(Entry<? extends K,? extends V> e : entries){\n            map.put(e.k, e.v);\n        }\n        return map;\n    }\n}\n\ntype B\u306fStatic Import\u3057\u306a\u3044\u3068\u4f7f\u3044\u3065\u3089\u3044\u3067\u3059\u304c\u3001\u305d\u308c\u304c\u3067\u304d\u308b\u73fe\u5834\u3070\u304b\u308a\u3067\u306f\u306a\u3044\u3060\u308d\u3046\u3068\u3044\u3046\u306e\u304c\u554f\u984c\u3067\u3059\u304c\u3001\u304d\u3061\u3093\u3068\u5de6\u5074\u306eMap<K,V>\u304c\u53f3\u5074\u306b\u3082\u751f\u304d\u3066\u3044\u308b\u4e8b\u306f\u5229\u70b9\u3067\u3059\u304b\u306d\u3002\ntype A\u306f\u53f3\u5074\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u5de6\u5074\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u5207\u308a\u96e2\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u307e\u3059\u3002fluent interface\u3092\u4f7f\u3046\u4ee5\u4e0a\u306f\u5de6\u53f3\u306e\u578b\u306e\u63a5\u7d9a\u95a2\u4fc2\u306f\u6700\u5f8c\u306ebuild()\u307e\u3067\u5206\u304b\u3089\u306a\u3044\u308f\u3051\u3067\u3059\u304b\u3089\u3001\u3053\u308c\u306f\u4ed5\u65b9\u3042\u308a\u307e\u305b\u3093\u3088\u306d\u3002\n\ntype A\u306e\u578b\u306f\u3001\u6700\u521d\u306e$_(K k,V v)\u30e1\u30bd\u30c3\u30c9\u306b\u4e0e\u3048\u3089\u308c\u308bk,v\u306e\u578b\u3067\u78ba\u5b9a\u3055\u308c\u3066\u3057\u307e\u3046\u3002\ntype B\u306e\u578b\u306f\u3001\u5de6\u5074\u306e\u53d7\u3051\u624b\u306e\u578b\u304c\u304d\u3061\u3093\u3068\u751f\u304b\u3055\u308c\u308b\u3002\n\nMapBuilder\u4e00\u3064\u3067\u3082\u60a9\u3093\u3067\u3057\u307e\u3046\u4eca\u65e5\u3053\u306e\u9803\u3067\u3059\u3002\u306a\u306b\u304b\u826f\u3044MapBuilder\u306f\u306a\u3044\u3082\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\nMapBuilder\u3068\u547c\u3070\u308c\u308b\u3082\u306e\u306f\u3044\u308d\u3044\u308d\u3042\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u306a\u306b\u304b\u3053\u3046\u3057\u3063\u304f\u308a\u3053\u306a\u3044\u306e\u3067\u3059\u3002\n\n\u53f3\u5074\u306b\u7121\u99c4\u306a\u578b\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u66f8\u304b\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u3058\u3083\u306a\u3044\u3067\u3059\u304b\uff1f\n\n```java\nMap<A,B> map = new MapBuilder<A,B>()...\n```\n\u306e\u53f3\u5074\u306eA,B\u304c\u7121\u99c4\u306a\u6c17\u304c\u3057\u3066\u5acc\u306a\u306e\u3067\u3059\u3002\n\n\u305d\u3053\u3067\u5c11\u3057\u8003\u3048\u3066\u307f\u307e\u3057\u305f\u3002\n\n```java\npublic class MapBuilderTest {\n    Map<String,Integer> map = MapBuilder.createHashMap()\n            .$_(\"A\" , 1)\n            .$_(\"B\" , 2)\n            .$_(\"C\" , 3)\n            .buildUnmodifiable();\n\n    Map<Month,Integer> enumMap = MapBuilder.createEnumMap()\n            .$_(Month.JANUARY  , 1)\n            .$_(Month.FEBRUARY , 2)\n            .$_(Month.MARCH    , 3)\n            .build();\n\n    Map<String,String> map2 = createHashMap(\n            $(\"A\",\"a\"),\n            $(\"B\",\"b\"),\n            $(\"C\",\"c\")\n    );\n```\n\n\u4e0a\u4e8c\u3064\u306f\u3044\u308f\u3086\u308bfluent interface\u3092\u3082\u3061\u3044\u305f\u3082\u306e(type A)\u3001\u4e0b\u306fEntry\u914d\u5217\u3092\u7528\u3044\u305f\u3082\u306e(type B)\u3067\u3059\u3002\n\u4f7f\u3044\u52dd\u624b\u3068\u3057\u3066\u3069\u3061\u3089\u304c\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u304b\u306d\u3002\n\n## \u5b9f\u88c5\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n###type A\n```java\npublic class MapBuilder<K,V> {\n    private Map<K,V> map;\n\n    public static HashMapSeed createHashMap(){\n        return new HashMapSeed();\n    }\n    public static EnumMapSeed createEnumMap(){\n        return new EnumMapSeed();\n    }\n    private MapBuilder(Map<K,V> map){\n        this.map = map;\n    }\n    public MapBuilder<K,V> $_(K k,V v){\n        map.put(k,v);\n        return this;\n    }\n    public Map<K,V> buildUnmodifiable(){\n        return Collections.unmodifiableMap(map);\n    }\n    public Map<K,V> build(){\n        return map;\n    }\n    public static class HashMapSeed{\n        public <K,V> MapBuilder<K,V> $_(K k,V v){\n            MapBuilder<K,V> builder = new MapBuilder<K,V>(new HashMap<K,V>());\n            return builder.$_(k,v);\n        }\n    }\n    public static class EnumMapSeed{\n        public <K extends Enum<K>,V> MapBuilder<K,V> $_(K k,V v){\n            MapBuilder<K,V> builder = new MapBuilder<>(new EnumMap<>(k.getClass()));\n            return builder.$_(k,v);\n        }\n    }\n}\n```\n###type B\n\n```java\npublic class MapBuilder<K,V> {\n    public static class Entry<K,V>{\n        public K k;\n        public V v;\n        public Entry(K k,V v){\n            this.k = k;\n            this.v = v;\n        }\n    }\n    public static <K,V> Entry<K,V> $(K k, V v){\n        return new Entry<>(k,v);\n    }\n    public static <K,V> Map<K,V> createHashMap(Entry<? extends K,? extends V>...entries){\n        Map<K,V> map = new HashMap<>();\n        for(Entry<? extends K,? extends V> e : entries){\n            map.put(e.k, e.v);\n        }\n        return map;\n    }\n}\n```\n\ntype B\u306fStatic Import\u3057\u306a\u3044\u3068\u4f7f\u3044\u3065\u3089\u3044\u3067\u3059\u304c\u3001\u305d\u308c\u304c\u3067\u304d\u308b\u73fe\u5834\u3070\u304b\u308a\u3067\u306f\u306a\u3044\u3060\u308d\u3046\u3068\u3044\u3046\u306e\u304c\u554f\u984c\u3067\u3059\u304c\u3001\u304d\u3061\u3093\u3068\u5de6\u5074\u306e`Map<K,V>`\u304c\u53f3\u5074\u306b\u3082\u751f\u304d\u3066\u3044\u308b\u4e8b\u306f\u5229\u70b9\u3067\u3059\u304b\u306d\u3002\ntype A\u306f\u53f3\u5074\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u5de6\u5074\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u304c\u5207\u308a\u96e2\u3055\u308c\u3066\u3057\u307e\u3063\u3066\u3044\u307e\u3059\u3002fluent interface\u3092\u4f7f\u3046\u4ee5\u4e0a\u306f\u5de6\u53f3\u306e\u578b\u306e\u63a5\u7d9a\u95a2\u4fc2\u306f\u6700\u5f8c\u306ebuild()\u307e\u3067\u5206\u304b\u3089\u306a\u3044\u308f\u3051\u3067\u3059\u304b\u3089\u3001\u3053\u308c\u306f\u4ed5\u65b9\u3042\u308a\u307e\u305b\u3093\u3088\u306d\u3002\n\n* type A\u306e\u578b\u306f\u3001\u6700\u521d\u306e`$_(K k,V v)`\u30e1\u30bd\u30c3\u30c9\u306b\u4e0e\u3048\u3089\u308c\u308bk,v\u306e\u578b\u3067\u78ba\u5b9a\u3055\u308c\u3066\u3057\u307e\u3046\u3002\n* type B\u306e\u578b\u306f\u3001\u5de6\u5074\u306e\u53d7\u3051\u624b\u306e\u578b\u304c\u304d\u3061\u3093\u3068\u751f\u304b\u3055\u308c\u308b\u3002\n\nMapBuilder\u4e00\u3064\u3067\u3082\u60a9\u3093\u3067\u3057\u307e\u3046\u4eca\u65e5\u3053\u306e\u9803\u3067\u3059\u3002\u306a\u306b\u304b\u826f\u3044MapBuilder\u306f\u306a\u3044\u3082\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\n", "tags": ["Java", "map"]}