{"context": " More than 1 year has passed since last update.download\n\u53c2\u8003: Windows Update\u5f8c\u306e\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u505c\u6b62\u3059\u308b\u8a2d\u5b9a\u306b\u3064\u3044\u3066\nDim wShell, currentSetting\nconst key=\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\\NoAutoRebootWithLoggedOnUsers\"\nSet wShell = CreateObject(\"WScript.Shell\")\n\nFunction isAutoReboot()\n    ' \u672a\u69cb\u6210\u306e\u5834\u5408\u3001RegRead\u304c\u5931\u6557\u3059\u308b\u305f\u3081\n    On Error Resume Next\n    isAutoReboot=wShell.RegRead(key)\nEnd Function\n\ncurrentSetting = isAutoReboot()\n\nIf currentSetting = \"\" Or currentSetting = 0 Then\n    If msgbox(\"\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u7121\u52b9\u306b\u3057\u307e\u3059\u304b\uff1f\" ,vbYesNo,\"Windows Update\u5f8c\u306e\u81ea\u52d5\u518d\u8d77\u52d5\") = vbYes Then\n        wShell.RegWrite key, 1, \"REG_DWORD\"\n    msgbox (\"\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u7121\u52b9\u306b\u3057\u307e\u3057\u305f\u3002\")\n    End If\nElseIf currentSetting = 1 Then\n    If msgbox(\"\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u304b\uff1f\" ,vbYesNo,\"Windows Update\u5f8c\u306e\u81ea\u52d5\u518d\u8d77\u52d5\") = vbYes Then\n        wShell.RegWrite key, 0, \"REG_DWORD\"\n    msgbox (\"\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u6709\u52b9\u306b\u3057\u307e\u3057\u305f\u3002\")\n    End If\nEnd If\n\n[download](https://github.com/tukiyo/windows_setup/blob/master/toggle_no_auto_reboot.vbs)\n\n\u53c2\u8003: [Windows Update\u5f8c\u306e\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u505c\u6b62\u3059\u308b\u8a2d\u5b9a\u306b\u3064\u3044\u3066](http://social.technet.microsoft.com/Forums/windowsserver/ja-JP/d2095c72-de6e-46e7-8ab8-0c0878ce2ce8/windows-update?forum=windowsserver2003ja)\n\n\n```vbnet:\nDim wShell, currentSetting\nconst key=\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\\NoAutoRebootWithLoggedOnUsers\"\nSet wShell = CreateObject(\"WScript.Shell\")\n\nFunction isAutoReboot()\n    ' \u672a\u69cb\u6210\u306e\u5834\u5408\u3001RegRead\u304c\u5931\u6557\u3059\u308b\u305f\u3081\n    On Error Resume Next\n    isAutoReboot=wShell.RegRead(key)\nEnd Function\n\ncurrentSetting = isAutoReboot()\n\nIf currentSetting = \"\" Or currentSetting = 0 Then\n    If msgbox(\"\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u7121\u52b9\u306b\u3057\u307e\u3059\u304b\uff1f\" ,vbYesNo,\"Windows Update\u5f8c\u306e\u81ea\u52d5\u518d\u8d77\u52d5\") = vbYes Then\n        wShell.RegWrite key, 1, \"REG_DWORD\"\n\tmsgbox (\"\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u7121\u52b9\u306b\u3057\u307e\u3057\u305f\u3002\")\n    End If\nElseIf currentSetting = 1 Then\n    If msgbox(\"\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u304b\uff1f\" ,vbYesNo,\"Windows Update\u5f8c\u306e\u81ea\u52d5\u518d\u8d77\u52d5\") = vbYes Then\n        wShell.RegWrite key, 0, \"REG_DWORD\"\n\tmsgbox (\"\u81ea\u52d5\u518d\u8d77\u52d5\u3092\u6709\u52b9\u306b\u3057\u307e\u3057\u305f\u3002\")\n    End If\nEnd If\n```\n", "tags": ["VBScript"]}