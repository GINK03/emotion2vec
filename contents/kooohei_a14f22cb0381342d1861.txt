{"tags": ["AWS", "AmazonLinux", "S3", "goofys"], "context": "\n\n\u306f\u3058\u3081\u306b\nAWS\u3092\u5229\u7528\u3057\u3066\u3044\u3066\u3001S3\u3092\u30b5\u30fc\u30d0\u30fc\u30de\u30a6\u30f3\u30c8\u3059\u308b\u6280\u8853\u3068\u3057\u3066s3fs\u304c\u6709\u540d\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u3067\u3059\u304c\u3001s3fs\u306f\u9045\u3044\u3068\u611f\u3058\u308b\u4eba\u306f\u5c11\u306a\u304f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3053\u3067\u4ed6\u306b\u4f55\u304b\u306a\u3044\u304b\u306a\u3068\u601d\u3063\u3066\u8abf\u3079\u305f\u3068\u3053\u308d\u3001goofys\u3068\u3044\u3046\u306e\u304c\u3042\u308b\u307f\u305f\u3044\u3067\u3059\u3002\ngoofys\u306eREADME\u306b\u3001\u4ee5\u4e0b\u306eBenchmark\u304c\u8f09\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u3068\u308a\u3042\u3048\u305agoofys\u3092\u4f7f\u3063\u3066S3\u3092\u30de\u30a6\u30f3\u30c8\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\ngo\u3068fuse\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u307e\u305a\u3001goofys\u3092\u5229\u7528\u3059\u308b\u306b\u3042\u305f\u308a\u3001go\u3068fuse\u304c\u5fc5\u8981\u3068\u306a\u308b\u305f\u3081\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install golang fuse\n\n\ngolang\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306b\u4f9d\u5b58\u95a2\u4fc2\u304c\u305f\u304f\u3055\u3093\u3042\u308b\u305f\u3081yum\u3067\u4e00\u6c17\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002\n\nAWS CLI\u306e\u8a2d\u5b9a\naws cli\u74b0\u5883\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u8a2d\u5b9a\n$ aws configure\nAWS Access Key ID [None]: ********************\nAWS Secret Access Key [None]: ****************************************\nDefault region name [None]: ap-northeast-1\nDefault output format [None]:\n\n\n\n\u30d0\u30b1\u30c3\u30c8\u306e\u4f5c\u6210\naws cli\u74b0\u5883\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u305f\u3089\u30de\u30a6\u30f3\u30c8\u3059\u308b\u305f\u3081\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u30d0\u30b1\u30c3\u30c8\u4f5c\u6210\n$ aws s3 mb s3://kohei-goofys\nmake_bucket: s3://kohei-goofys/\n\n\n\n\u30d0\u30b1\u30c3\u30c8\u78ba\u8a8d\n$ aws s3 ls s3://kohei-goofys\n\n\n\u4f5c\u6210\u3057\u305f\u3070\u304b\u308a\u3060\u3068\u30d0\u30b1\u30c3\u30c8\u306b\u306f\u4f55\u3082\u7121\u3044\u306e\u3067aws s3 ls\u3057\u3066\u3082\u623b\u308a\u5024\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\ngoofys\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u307e\u305a\u3001GOPATH\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u30d1\u30b9\u8a2d\u5b9a\n$ export GOPATH=$HOME/go\n$ echo $GOPATH\n/home/ec2-user/go\n\n\n\u4eca\u56de\u306fec2-user\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u8a2d\u5b9a\u304c\u3067\u304d\u305f\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ go get github.com/kahing/goofys\n$ go install github.com/kahing/goofys\n\n\n*get\u3082install\u3082\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u623b\u3063\u3066\u304f\u308b\u307e\u3067\u306b\u82e5\u5e72\u6642\u9593\u304c\u304b\u304b\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\nS3\u30de\u30a6\u30f3\u30c8\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u3067\u304d\u305f\u3089\u3044\u3088\u3044\u3088\u30de\u30a6\u30f3\u30c8\u3067\u3059\u3002\n\n\u30de\u30a6\u30f3\u30c8\u30dd\u30a4\u30f3\u30c8\u306e\u4f5c\u6210\n$ mkdir ~/mount-goofys\n\n\n\n\u30de\u30a6\u30f3\u30c8\n$ ./go/bin/goofys kohei-goofys ~/mount-goofys\n\n\n\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u5e30\u3063\u3066\u304d\u305f\u3089\u5b8c\u4e86\u3067\u3059\u3002\n\u30de\u30a6\u30f3\u30c8\u306b\u6210\u529f\u3057\u3066\u3082\u3057\u306a\u304f\u3066\u3082\u3001\u4f55\u3082\u623b\u3063\u3066\u3053\u306a\u3044\u306e\u3067\u5b9f\u969b\u306b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u78ba\u8a8d\n\u78ba\u8a8d\u30dd\u30a4\u30f3\u30c8\u306f\u5e7e\u3064\u304b\u3042\u308a\u307e\u3059\u3002\n\n\u30d7\u30ed\u30bb\u30b9\u78ba\u8a8d\n$ ps auxf |grep goofys\nec2-user  3030  0.0  0.4 110472  2144 pts/0    S+   03:08   0:00              \\_ grep --color=auto goofys\nec2-user  3022  0.3  2.7 197876 13668 ?        Ssl  03:08   0:00 /home/ec2-user/go/bin/goofys kohei-goofys /home/ec2-user/mount-goofys\n\n\n\n\u30ed\u30b0\u78ba\u8a8d\n$ sudo grep goofys /var/log/messages\nJul  1 03:08:50 ip-172-31-3-125 /home/ec2-user/go/bin/goofys[3022]: s3.ERROR code=incorrect region, the bucket is not in 'us-west-2' region msg=301 request=#012\nJul  1 03:08:51 ip-172-31-3-125 /home/ec2-user/go/bin/goofys[3022]: s3.INFO Switching from region 'us-west-2' to 'ap-northeast-1'\nJul  1 03:08:51 ip-172-31-3-125 /home/ec2-user/go/bin/goofys[3022]: main.INFO File system has been successfully mounted.\n\n\n\n\u30dc\u30ea\u30e5\u30fc\u30e0\u78ba\u8a8d\n$ df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9   \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/xvda1       7.8G  1.6G  6.1G   21% /\ndevtmpfs         238M   56K  238M    1% /dev\ntmpfs            246M     0  246M    0% /dev/shm\nkohei-goofys     1.0P     0  1.0P    0% /home/ec2-user/mount-goofys\n\n\n\u7121\u4e8b\u30de\u30a6\u30f3\u30c8\u304c\u3067\u304d\u305f\u3088\u3046\u3067\u3059\u3002\n\u3067\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n$ touch ~/mount-goofys/test\n$ ls ~/mount-goofys/\ntest\n\n\n\u4f5c\u6210\u3067\u304d\u305f\u3089aws s3\u30b3\u30de\u30f3\u30c9\u3067\u30d0\u30b1\u30c3\u30c8\u5185\u3092\u76f4\u63a5\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u30d0\u30b1\u30c3\u30c8\u5185\u306e\u78ba\u8a8d\n$ aws s3 ls s3://kohei-goofys\n2016-07-01 03:14:44          0 test\n\n\n\u5148\u307b\u3069\u4f5c\u6210\u3055\u308c\u305f\u30b3\u30de\u30f3\u30c9\u304c\u3053\u3061\u3089\u304b\u3089\u3067\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u81ea\u52d5\u30de\u30a6\u30f3\u30c8\u8a2d\u5b9a\n\u30de\u30a6\u30f3\u30c8\u306f\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u304c\u3001\u6bce\u56de\u624b\u52d5\u3067\u30de\u30a6\u30f3\u30c8\u3059\u308b\u306e\u306f\u5927\u5909\u3067\u3059\u3002\n\u306a\u306e\u3067/etc/fstab\u306b\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u6642\u306b\u30de\u30a6\u30f3\u30c8\u3055\u308c\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u305f\u3060\u3001\u3053\u3053\u3067\u30dd\u30a4\u30f3\u30c8\u306f\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u6642\u306froot\u3067\u51e6\u7406\u304c\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u306faws cli\u306e\u8a2d\u5b9a\u3082root\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u8a2d\u5b9a\n$ sudo aws configure\nAWS Access Key ID [None]: ********************\nAWS Secret Access Key [None]: ****************************************\nDefault region name [None]: ap-northeast-1\nDefault output format [None]:\n\n\n\u8a2d\u5b9a\u304c\u3067\u304d\u305f\u3089fstab\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\n\nfstab\u4fee\u6b63\n$ sudo vi /etc/fstab\n$ cat /etc/fstab\n#\nLABEL=/     /           ext4    defaults,noatime  1   1\ntmpfs       /dev/shm    tmpfs   defaults        0   0\ndevpts      /dev/pts    devpts  gid=5,mode=620  0   0\nsysfs       /sys        sysfs   defaults        0   0\nproc        /proc       proc    defaults        0   0\n/home/ec2-user/go/bin/goofys#kohei-goofys /home/ec2-user/mount-goofys fuse _netdev,allow_other,--file-mode=0666,--uid=500,--gid=500 0 0\n\n\n\u3053\u3053\u3067\u3068\u3066\u3082\u91cd\u8981\u306a\u306e\u304c\u30aa\u30d7\u30b7\u30e7\u30f3\u3067allow_other\u304c\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3067\u3059\u3002\n\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u306a\u3044\u3068root\u4ee5\u5916\u306e\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u306f\u898b\u3048\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001--file-mode\u3068--uid\u3001--gid\u306f\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u4f5c\u6210\u3055\u308c\u305f\u969b\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u6a29\u9650/\u6240\u6709\u8005\u306e\u8a2d\u5b9a\u306b\u306a\u308a\u307e\u3059\u3002\n\u4eca\u56de\u306e\u5834\u5408\u306fec2-user\u304cUID\u3001GID\u3068\u3082\u306b500\u3067\u3057\u305f\u3002\n\nid\u78ba\u8a8d\n$ id\nuid=500(ec2-user) gid=500(ec2-user) groups=500(ec2-user),10(wheel)\n\n\n\u4fee\u6b63\u304c\u5b8c\u4e86\u3057\u305f\u3089\u81ea\u52d5\u30de\u30a6\u30f3\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u81ea\u52d5\u30de\u30a6\u30f3\u30c8\n$ sudo mount -a\n\n\n\n\u78ba\u8a8d\n$ df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9   \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/xvda1       7.8G  1.6G  6.1G   21% /\ndevtmpfs         238M   56K  238M    1% /dev\ntmpfs            246M     0  246M    0% /dev/shm\nkohei-goofys     1.0P     0  1.0P    0% /home/ec2-user/mount-goofys\n\n\n\u3061\u3083\u3093\u3068\u30de\u30a6\u30f3\u30c8\u304c\u3067\u304d\u305f\u306e\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u3082\u3057\u3001\u3053\u3053\u3067\u30de\u30a6\u30f3\u30c8\u304c\u898b\u3048\u306a\u304b\u3063\u305f\u3089sudo df -h\u3092\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u305d\u308c\u3067\u898b\u3048\u308b\u5834\u5408\u306f\u6a29\u9650\u5468\u308a\u304c\u3046\u307e\u304f\u3067\u304d\u3066\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\n\u8aac\u660e\n\n\n\n\n_netdev\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u6709\u52b9\u306b\u306a\u308b\u307e\u3067\u30de\u30a6\u30f3\u30c8\u3092\u5f85\u3064\u305f\u3081\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3002\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7d4c\u7531\u306e\u30c7\u30d0\u30a4\u30b9\u3092\u8d77\u52d5\u6642\u306b\u30de\u30a6\u30f3\u30c8\u3055\u305b\u305f\u3044\u5834\u5408\u306a\u3069\u306b\u6307\u5b9a\u3059\u308b\u3002\n\n\nallow_other\n\u4ed6\u306e\u30e6\u30fc\u30b6\u30fc\u3067\u3082\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3002\n\n\n--file-mode\n\u30de\u30a6\u30f3\u30c8\u3059\u308b\u969b\u306e\u30d5\u30a1\u30a4\u30eb\u6a29\u9650\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n\n--uid\n\u30de\u30a6\u30f3\u30c8\u3059\u308b\u30e6\u30fc\u30b6\u30fcID\u3092\u6307\u5b9a\u3059\u308b\u3002\n\n\n--gid\n\u30de\u30a6\u30f3\u30c8\u3059\u308b\u30b0\u30eb\u30fc\u30d7ID\u3092\u6307\u5b9a\u3059\u308b\u3002\n\n\n\n\u307e\u305f\u3001\u4e0a\u8a18\u306f\u4eca\u56de\u4f7f\u3063\u305f\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u8aac\u660e\u3068\u306a\u308b\u306e\u3067\u53c2\u8003\u306b\u3057\u3066\u3082\u3089\u3048\u308c\u3070\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u304a\u308f\u308a\u306b\n\u3068\u308a\u3042\u3048\u305agoofys\u304c\u3069\u3093\u306a\u611f\u3058\u304b\u3092\u8a66\u3057\u305f\u304f\u3066\u884c\u3044\u307e\u3057\u305f\u304c\u3001\u5c0e\u5165\u306f\u3068\u3066\u3082\u7c21\u5358\u3067\u3057\u305f\u3002\n\u305f\u3060\u3001\u81ea\u52d5\u30de\u30a6\u30f3\u30c8\u8a2d\u5b9a\u306e\u969b\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u5468\u308a\u306e\u6319\u52d5\u3092\u78ba\u8a8d\u3059\u308b\u306e\u306b\u5c11\u3005\u6642\u9593\u304b\u304b\u3063\u305f\u304b\u306a\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u3002\nGitHub\u306eBenchmark\u3067\u306fs3fs\u3088\u308a\u304b\u306a\u308a\u512a\u79c0\u306a\u611f\u3058\u3067\u3059\u304c\u3001\u5b9f\u969b\u6bd4\u8f03\u306f\u307e\u3060\u3057\u3066\u306a\u3044\u306e\u3067\u305d\u3063\u3061\u306e\u65b9\u3082\u3067\u304d\u305f\u3089\u306a\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u5b9f\u969b\u306b\u5229\u7528\u3057\u3066\u3044\u308b\u65b9\u304c\u3044\u307e\u3057\u305f\u3089\u305d\u3053\u3089\u3078\u3093\u306e\u60c5\u5831\u306b\u3064\u3044\u3066\u30b3\u30e1\u30f3\u30c8\u3044\u305f\u3060\u3051\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\n# \u306f\u3058\u3081\u306b\nAWS\u3092\u5229\u7528\u3057\u3066\u3044\u3066\u3001S3\u3092\u30b5\u30fc\u30d0\u30fc\u30de\u30a6\u30f3\u30c8\u3059\u308b\u6280\u8853\u3068\u3057\u3066`s3fs`\u304c\u6709\u540d\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u3067\u3059\u304c\u3001**s3fs\u306f\u9045\u3044**\u3068\u611f\u3058\u308b\u4eba\u306f\u5c11\u306a\u304f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3053\u3067\u4ed6\u306b\u4f55\u304b\u306a\u3044\u304b\u306a\u3068\u601d\u3063\u3066\u8abf\u3079\u305f\u3068\u3053\u308d\u3001**[goofys](https://github.com/kahing/goofys)**\u3068\u3044\u3046\u306e\u304c\u3042\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n\ngoofys\u306eREADME\u306b\u3001\u4ee5\u4e0b\u306eBenchmark\u304c\u8f09\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n![goofys-benchmark](https://github.com/kahing/goofys/blob/master/bench/bench.png?raw=true)\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u3068\u308a\u3042\u3048\u305a`goofys`\u3092\u4f7f\u3063\u3066S3\u3092\u30de\u30a6\u30f3\u30c8\u3057\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n# go\u3068fuse\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u307e\u305a\u3001goofys\u3092\u5229\u7528\u3059\u308b\u306b\u3042\u305f\u308a\u3001go\u3068fuse\u304c\u5fc5\u8981\u3068\u306a\u308b\u305f\u3081\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash:\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install golang fuse\n```\n\n_golang_\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306b\u4f9d\u5b58\u95a2\u4fc2\u304c\u305f\u304f\u3055\u3093\u3042\u308b\u305f\u3081_yum_\u3067\u4e00\u6c17\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3057\u307e\u3044\u307e\u3057\u3087\u3046\u3002\n\n\n# AWS CLI\u306e\u8a2d\u5b9a\n_aws cli_\u74b0\u5883\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```bash:\u8a2d\u5b9a\n$ aws configure\nAWS Access Key ID [None]: ********************\nAWS Secret Access Key [None]: ****************************************\nDefault region name [None]: ap-northeast-1\nDefault output format [None]:\n```\n\n\n# \u30d0\u30b1\u30c3\u30c8\u306e\u4f5c\u6210\n\n_aws cli_\u74b0\u5883\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u305f\u3089\u30de\u30a6\u30f3\u30c8\u3059\u308b\u305f\u3081\u306e\u30d0\u30b1\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash:\u30d0\u30b1\u30c3\u30c8\u4f5c\u6210\n$ aws s3 mb s3://kohei-goofys\nmake_bucket: s3://kohei-goofys/\n```\n\n```bash:\u30d0\u30b1\u30c3\u30c8\u78ba\u8a8d\n$ aws s3 ls s3://kohei-goofys\n```\n\n\u4f5c\u6210\u3057\u305f\u3070\u304b\u308a\u3060\u3068\u30d0\u30b1\u30c3\u30c8\u306b\u306f\u4f55\u3082\u7121\u3044\u306e\u3067`aws s3 ls`\u3057\u3066\u3082\u623b\u308a\u5024\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n# goofys\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u307e\u305a\u3001GOPATH\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```bash:\u30d1\u30b9\u8a2d\u5b9a\n$ export GOPATH=$HOME/go\n$ echo $GOPATH\n/home/ec2-user/go\n```\n\u4eca\u56de\u306f_ec2-user_\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u8a2d\u5b9a\u304c\u3067\u304d\u305f\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u3059\u3002\n\n```bash:\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ go get github.com/kahing/goofys\n$ go install github.com/kahing/goofys\n```\n*get\u3082install\u3082\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u623b\u3063\u3066\u304f\u308b\u307e\u3067\u306b\u82e5\u5e72\u6642\u9593\u304c\u304b\u304b\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n# S3\u30de\u30a6\u30f3\u30c8\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u3067\u304d\u305f\u3089\u3044\u3088\u3044\u3088\u30de\u30a6\u30f3\u30c8\u3067\u3059\u3002\n\n```bash:\u30de\u30a6\u30f3\u30c8\u30dd\u30a4\u30f3\u30c8\u306e\u4f5c\u6210\n$ mkdir ~/mount-goofys\n```\n\n```bash:\u30de\u30a6\u30f3\u30c8\n$ ./go/bin/goofys kohei-goofys ~/mount-goofys\n```\n\n\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u5e30\u3063\u3066\u304d\u305f\u3089\u5b8c\u4e86\u3067\u3059\u3002\n\u30de\u30a6\u30f3\u30c8\u306b\u6210\u529f\u3057\u3066\u3082\u3057\u306a\u304f\u3066\u3082\u3001\u4f55\u3082\u623b\u3063\u3066\u3053\u306a\u3044\u306e\u3067\u5b9f\u969b\u306b\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n# \u78ba\u8a8d\n\u78ba\u8a8d\u30dd\u30a4\u30f3\u30c8\u306f\u5e7e\u3064\u304b\u3042\u308a\u307e\u3059\u3002\n\n```bash:\u30d7\u30ed\u30bb\u30b9\u78ba\u8a8d\n$ ps auxf |grep goofys\nec2-user  3030  0.0  0.4 110472  2144 pts/0    S+   03:08   0:00              \\_ grep --color=auto goofys\nec2-user  3022  0.3  2.7 197876 13668 ?        Ssl  03:08   0:00 /home/ec2-user/go/bin/goofys kohei-goofys /home/ec2-user/mount-goofys\n```\n\n```bash:\u30ed\u30b0\u78ba\u8a8d\n$ sudo grep goofys /var/log/messages\nJul  1 03:08:50 ip-172-31-3-125 /home/ec2-user/go/bin/goofys[3022]: s3.ERROR code=incorrect region, the bucket is not in 'us-west-2' region msg=301 request=#012\nJul  1 03:08:51 ip-172-31-3-125 /home/ec2-user/go/bin/goofys[3022]: s3.INFO Switching from region 'us-west-2' to 'ap-northeast-1'\nJul  1 03:08:51 ip-172-31-3-125 /home/ec2-user/go/bin/goofys[3022]: main.INFO File system has been successfully mounted.\n```\n\n```bash:\u30dc\u30ea\u30e5\u30fc\u30e0\u78ba\u8a8d\n$ df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9   \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/xvda1       7.8G  1.6G  6.1G   21% /\ndevtmpfs         238M   56K  238M    1% /dev\ntmpfs            246M     0  246M    0% /dev/shm\nkohei-goofys     1.0P     0  1.0P    0% /home/ec2-user/mount-goofys\n```\n\n\u7121\u4e8b\u30de\u30a6\u30f3\u30c8\u304c\u3067\u304d\u305f\u3088\u3046\u3067\u3059\u3002\n\u3067\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\u3092\u884c\u3044\u307e\u3059\u3002\n\n```bash:\u30d5\u30a1\u30a4\u30eb\u306e\u4f5c\u6210\n$ touch ~/mount-goofys/test\n$ ls ~/mount-goofys/\ntest\n```\n\n\u4f5c\u6210\u3067\u304d\u305f\u3089`aws s3`\u30b3\u30de\u30f3\u30c9\u3067\u30d0\u30b1\u30c3\u30c8\u5185\u3092\u76f4\u63a5\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n\n```bash:\u30d0\u30b1\u30c3\u30c8\u5185\u306e\u78ba\u8a8d\n$ aws s3 ls s3://kohei-goofys\n2016-07-01 03:14:44          0 test\n```\n\n\u5148\u307b\u3069\u4f5c\u6210\u3055\u308c\u305f\u30b3\u30de\u30f3\u30c9\u304c\u3053\u3061\u3089\u304b\u3089\u3067\u3082\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n\n\n# \u81ea\u52d5\u30de\u30a6\u30f3\u30c8\u8a2d\u5b9a\n\n\u30de\u30a6\u30f3\u30c8\u306f\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u304c\u3001\u6bce\u56de\u624b\u52d5\u3067\u30de\u30a6\u30f3\u30c8\u3059\u308b\u306e\u306f\u5927\u5909\u3067\u3059\u3002\n\u306a\u306e\u3067_/etc/fstab_\u306b\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u6642\u306b\u30de\u30a6\u30f3\u30c8\u3055\u308c\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u305f\u3060\u3001\u3053\u3053\u3067\u30dd\u30a4\u30f3\u30c8\u306f**\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u6642\u306f_root_**\u3067\u51e6\u7406\u304c\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u306f_aws cli_\u306e\u8a2d\u5b9a\u3082root\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```bash:\u8a2d\u5b9a\n$ sudo aws configure\nAWS Access Key ID [None]: ********************\nAWS Secret Access Key [None]: ****************************************\nDefault region name [None]: ap-northeast-1\nDefault output format [None]:\n```\n\n\u8a2d\u5b9a\u304c\u3067\u304d\u305f\u3089_fstab_\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\n\n```bash:fstab\u4fee\u6b63\n$ sudo vi /etc/fstab\n$ cat /etc/fstab\n#\nLABEL=/     /           ext4    defaults,noatime  1   1\ntmpfs       /dev/shm    tmpfs   defaults        0   0\ndevpts      /dev/pts    devpts  gid=5,mode=620  0   0\nsysfs       /sys        sysfs   defaults        0   0\nproc        /proc       proc    defaults        0   0\n/home/ec2-user/go/bin/goofys#kohei-goofys /home/ec2-user/mount-goofys fuse _netdev,allow_other,--file-mode=0666,--uid=500,--gid=500 0 0\n```\n\n\u3053\u3053\u3067\u3068\u3066\u3082\u91cd\u8981\u306a\u306e\u304c\u30aa\u30d7\u30b7\u30e7\u30f3\u3067_allow_other_\u304c\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3067\u3059\u3002\n\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u306a\u3044\u3068root\u4ee5\u5916\u306e\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u306f\u898b\u3048\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001_--file-mode_\u3068_--uid_\u3001_--gid_\u306f\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u4f5c\u6210\u3055\u308c\u305f\u969b\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u6a29\u9650/\u6240\u6709\u8005\u306e\u8a2d\u5b9a\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u4eca\u56de\u306e\u5834\u5408\u306f_ec2-user_\u304cUID\u3001GID\u3068\u3082\u306b500\u3067\u3057\u305f\u3002\n\n```bash:id\u78ba\u8a8d\n$ id\nuid=500(ec2-user) gid=500(ec2-user) groups=500(ec2-user),10(wheel)\n```\n\n\n\u4fee\u6b63\u304c\u5b8c\u4e86\u3057\u305f\u3089\u81ea\u52d5\u30de\u30a6\u30f3\u30c8\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u81ea\u52d5\u30de\u30a6\u30f3\u30c8\n$ sudo mount -a\n```\n\n```bash:\u78ba\u8a8d\n$ df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9   \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/xvda1       7.8G  1.6G  6.1G   21% /\ndevtmpfs         238M   56K  238M    1% /dev\ntmpfs            246M     0  246M    0% /dev/shm\nkohei-goofys     1.0P     0  1.0P    0% /home/ec2-user/mount-goofys\n```\n\n\u3061\u3083\u3093\u3068\u30de\u30a6\u30f3\u30c8\u304c\u3067\u304d\u305f\u306e\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u3082\u3057\u3001\u3053\u3053\u3067\u30de\u30a6\u30f3\u30c8\u304c\u898b\u3048\u306a\u304b\u3063\u305f\u3089`sudo df -h`\u3092\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u305d\u308c\u3067\u898b\u3048\u308b\u5834\u5408\u306f\u6a29\u9650\u5468\u308a\u304c\u3046\u307e\u304f\u3067\u304d\u3066\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\n| \u30aa\u30d7\u30b7\u30e7\u30f3     | \u8aac\u660e                             |\n| :---------- | :------------------------------ |\n| _netdev     | \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u6709\u52b9\u306b\u306a\u308b\u307e\u3067\u30de\u30a6\u30f3\u30c8\u3092\u5f85\u3064\u305f\u3081\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3002<br>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7d4c\u7531\u306e\u30c7\u30d0\u30a4\u30b9\u3092\u8d77\u52d5\u6642\u306b\u30de\u30a6\u30f3\u30c8\u3055\u305b\u305f\u3044\u5834\u5408\u306a\u3069\u306b\u6307\u5b9a\u3059\u308b\u3002 |\n| allow_other | \u4ed6\u306e\u30e6\u30fc\u30b6\u30fc\u3067\u3082\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3059\u308b\u3002    |\n| --file-mode | \u30de\u30a6\u30f3\u30c8\u3059\u308b\u969b\u306e\u30d5\u30a1\u30a4\u30eb\u6a29\u9650\u3092\u8a2d\u5b9a\u3059\u308b\u3002   |\n| --uid       | \u30de\u30a6\u30f3\u30c8\u3059\u308b\u30e6\u30fc\u30b6\u30fcID\u3092\u6307\u5b9a\u3059\u308b\u3002       |\n| --gid       | \u30de\u30a6\u30f3\u30c8\u3059\u308b\u30b0\u30eb\u30fc\u30d7ID\u3092\u6307\u5b9a\u3059\u308b\u3002       |\n\n\u307e\u305f\u3001\u4e0a\u8a18\u306f\u4eca\u56de\u4f7f\u3063\u305f\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u8aac\u660e\u3068\u306a\u308b\u306e\u3067\u53c2\u8003\u306b\u3057\u3066\u3082\u3089\u3048\u308c\u3070\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n# \u304a\u308f\u308a\u306b\n\n\u3068\u308a\u3042\u3048\u305a**_goofys_**\u304c\u3069\u3093\u306a\u611f\u3058\u304b\u3092\u8a66\u3057\u305f\u304f\u3066\u884c\u3044\u307e\u3057\u305f\u304c\u3001\u5c0e\u5165\u306f\u3068\u3066\u3082\u7c21\u5358\u3067\u3057\u305f\u3002\n\u305f\u3060\u3001\u81ea\u52d5\u30de\u30a6\u30f3\u30c8\u8a2d\u5b9a\u306e\u969b\u306e\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u5468\u308a\u306e\u6319\u52d5\u3092\u78ba\u8a8d\u3059\u308b\u306e\u306b\u5c11\u3005\u6642\u9593\u304b\u304b\u3063\u305f\u304b\u306a\u3068\u3044\u3046\u611f\u3058\u3067\u3059\u3002\nGitHub\u306e[Benchmark](https://github.com/kahing/goofys#benchmark)\u3067\u306fs3fs\u3088\u308a\u304b\u306a\u308a\u512a\u79c0\u306a\u611f\u3058\u3067\u3059\u304c\u3001\u5b9f\u969b\u6bd4\u8f03\u306f\u307e\u3060\u3057\u3066\u306a\u3044\u306e\u3067\u305d\u3063\u3061\u306e\u65b9\u3082\u3067\u304d\u305f\u3089\u306a\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u5b9f\u969b\u306b\u5229\u7528\u3057\u3066\u3044\u308b\u65b9\u304c\u3044\u307e\u3057\u305f\u3089\u305d\u3053\u3089\u3078\u3093\u306e\u60c5\u5831\u306b\u3064\u3044\u3066\u30b3\u30e1\u30f3\u30c8\u3044\u305f\u3060\u3051\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3002\n"}