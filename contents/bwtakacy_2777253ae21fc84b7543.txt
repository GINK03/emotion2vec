{"tags": ["hive"], "context": " More than 1 year has passed since last update.Hive\u3067GRANT/REVOKE\u306b\u3088\u308bINSERT/SELECT/UPDATE/DELETE\u6a29\u9650\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u6a5f\u80fd\u300cSQL Standard Based Authorization\u300d\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\u3002\n\u74b0\u5883\u306f\n\nCentOS 7.2\nHive 1.1.0 (CDH 5.6.0)\nPostgreSQL 9.5.1 (\u30e1\u30bf\u30b9\u30c8\u30a2\u7528)\n\n\nHive\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4ee5\u524d\u306e\u8a18\u4e8b\u53c2\u7167\u3002\n\nHive\u306e\u8a2d\u5b9a\nHive\u306ewiki\u3092\u53c2\u8003\u306b\u8a2d\u5b9a\u3059\u308b\u3002\n\u8ffd\u52a0\u3067hive-site.xml\u306b\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u9805\u76ee\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3002\n<property>\n  <name>hive.server2.enable.doAs</name>\n  <value>false</value>\n</property>\n\n<property>\n  <name>hive.users.in.admin.role</name>\n  <value>hive</value>\n</property>\n\n<property>\n  <name>hive.security.authorization.enabled</name>\n  <value>true</value>\n</property>\n\n<property>\n  <name>hive.security.metastore.authorization.manager</name>\n  <value>org.apache.hadoop.hive.ql.security.authorization.MetaStoreAuthzAPIAuthorizerEmbedOnly</value>\n</property>\n\n<property>\n  <name>hive.security.authorization.manager</name>\n  <value>org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdConfOnlyAuthorizerFactory</value>\n</property>\n\n<property>\n  <name>hive.security.authorization.task.factory</name>\n  <value>org.apache.hadoop.hive.ql.parse.authorization.HiveAuthorizationTaskFactoryImpl</value>\n</property>\n\n\nCDH5\u7279\u6709\u306e\u6ce8\u610f\u70b9\nCDH5\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fHive\u306eSQL Based Authorization\u6a5f\u80fd\u304c\u7121\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001Hive\u306ewiki\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u8a2d\u5b9a\u9805\u76ee\u306e\u52a0\u3048\u3066hive.security.authorization.task.factory\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u3053\u308c\u3092\u8a2d\u5b9a\u3057\u306a\u3044\u3068\u3001GRANT\u6587\u306a\u3069\u3092\u5b9f\u884c\u3057\u3088\u3046\u3068\u3057\u3066\u3082\u3001\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u4f55\u3082\u52d5\u4f5c\u3057\u306a\u3044\u3002\n0: jdbc:hive2://localhost:10000> SHOW ROLES;\nError: Error while compiling statement: FAILED: SemanticException The current builtin authorization in Hive is incomplete and disabled. (state=42000,code=40000)\n\n\u975e\u5e38\u306b\u610f\u5473\u4e0d\u660e\u306a\u306e\u3067\u89e3\u6c7a\u3059\u308b\u306e\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u305f\u3002\u3002\u3002\n\nHiveServer2\u306e\u8d77\u52d5\n\u8d77\u52d5\u6642\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3089\u3057\u3044\u3002\n[hive@localhost ~]$ hiveserver2 --hiveconf hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory --hiveconf hive.security.authorization.enabled=true --hiveconf hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateUserAuthenticator --hiveconf hive.metastore.uris=''\n\ninit\u30b9\u30af\u30ea\u30d7\u30c8\u7d4c\u7531\u3067\u8d77\u52d5\u3059\u308b\u5834\u5408\u306f\u3001/etc/default/hive-server2\u306b\u8d77\u52d5\u6642\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u74b0\u5883\u5909\u6570\u3067\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\u3068\u3044\u3051\u308b\u3063\u307d\u3044\u3002\n\n/etc/default/hive-server2\nexport HIVE_OPTS='--hiveconf hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory --hiveconf hive.security.authorization.enabled=true --hiveconf hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateUserAuthenticator --hiveconf hive.metastore.uris='\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\u3053\u306e\u30d6\u30ed\u30b0\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u4f8b\u3092\u3084\u3063\u3066\u307f\u308b\u3002\nADMIN\u6a29\u9650\u3092\u6301\u3066\u308b\u30e6\u30fc\u30b6\u3067\u3001\u7279\u5b9a\u306e\u30e6\u30fc\u30b6\u306b\u306fSELECT\u6a29\u3057\u304b\u306a\u3044ROLE\u3092\u4ed8\u4e0e\u3057\u3066\u307f\u308b\u3002\n[hive@localhost ~]$ beeline \nBeeline version 1.1.0-cdh5.6.0 by Apache Hive\nbeeline> !connect jdbc:hive2://localhost:10000 hive password org.apache.hive.jdbc.HiveDriver\nConnecting to jdbc:hive2://localhost:10000\nConnected to: Apache Hive (version 1.1.0-cdh5.6.0)\nDriver: Hive JDBC (version 1.1.0-cdh5.6.0)\nTransaction isolation: TRANSACTION_REPEATABLE_READ\n0: jdbc:hive2://localhost:10000> SET ROLE ADMIN;\nNo rows affected (0.102 seconds)\n\n\u6700\u521d\u306bSET ROLE ADMIN\u3092\u5b9f\u884c\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u3053\u308c\u3092\u3084\u3063\u305f\u5f8c\u306breadonly\u30ed\u30fc\u30eb\u3092\u4f5c\u6210\u3002\n0: jdbc:hive2://localhost:10000> CREATE ROLE readonly;\nNo rows affected (0.088 seconds)\n0: jdbc:hive2://localhost:10000> SHOW ROLES;\n+-----------+--+\n|   role    |\n+-----------+--+\n| admin     |\n| public    |\n| readonly  |\n+-----------+--+\n3 rows selected (0.058 seconds)\n\n\u30e6\u30fc\u30b6alice\u306b\u30ed\u30fc\u30ebreadonly\u3092\u4ed8\u4e0e\u3002\n0: jdbc:hive2://localhost:10000> GRANT ROLE readonly TO USER alice;\nNo rows affected (0.072 seconds)\n\n\u9069\u5f53\u306a\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u3001readonly\u30ed\u30fc\u30eb\u306bSELECT\u6a29\u9650\u3092\u4e0e\u3048\u308b\u3002\n0: jdbc:hive2://localhost:10000> CREATE TABLE tbl_a (id int);\nNo rows affected (0.998 seconds)\n0: jdbc:hive2://localhost:10000> LOAD DATA INPATH '/user/hive/tbl_a.data' INTO TABLE tbl_a;\nINFO  : Loading data to table default.tbl_a from hdfs://localhost:8020/user/hive/tbl_a.data\nINFO  : Table default.tbl_a stats: [numFiles=1, totalSize=10]\nNo rows affected (0.353 seconds)\n0: jdbc:hive2://localhost:10000> SHOW TABLES;\n+-----------+--+\n| tab_name  |\n+-----------+--+\n| tbl_a     |\n+-----------+--+\n1 row selected (0.07 seconds)\n0: jdbc:hive2://localhost:10000> DESC tbl_a\n0: jdbc:hive2://localhost:10000> ;\n+-----------+------------+----------+--+\n| col_name  | data_type  | comment  |\n+-----------+------------+----------+--+\n| id        | int        |          |\n+-----------+------------+----------+--+\n1 row selected (0.147 seconds)\n0: jdbc:hive2://localhost:10000> GRANT SELECT ON TABLE tbl_a TO readonly;\nError: Error while compiling statement: FAILED: ParseException line 1:31 cannot recognize input near 'readonly' '<EOF>' '<EOF>' in user|group|role name (state=42000,code=40000)\n0: jdbc:hive2://localhost:10000> GRANT SELECT ON TABLE tbl_a TO ROLE readonly;\nNo rows affected (0.144 seconds)\n0: jdbc:hive2://localhost:10000> SHOW GRANT ROLE readonly;\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n| database  | table  | partition  | column  | principal_name  | principal_type  | privilege  | grant_option  |   grant_time   | grantor  |\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n| default   | tbl_a  |            |         | readonly        | ROLE            | SELECT     | false         | 1457444851000  | hive     |\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n1 row selected (0.173 seconds)\n0: jdbc:hive2://localhost:10000> SHOW GRANT ON TABLE tbl_a;\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n| database  | table  | partition  | column  | principal_name  | principal_type  | privilege  | grant_option  |   grant_time   | grantor  |\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n| default   | tbl_a  |            |         | hive            | USER            | DELETE     | true          | 1457445229000  | hive     |\n| default   | tbl_a  |            |         | hive            | USER            | INSERT     | true          | 1457445229000  | hive     |\n| default   | tbl_a  |            |         | hive            | USER            | SELECT     | true          | 1457445229000  | hive     |\n| default   | tbl_a  |            |         | hive            | USER            | UPDATE     | true          | 1457445229000  | hive     |\n| default   | tbl_a  |            |         | readonly        | ROLE            | SELECT     | false         | 1457445378000  | hive     |\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n5 rows selected (0.114 seconds)\n\n\u3067\u3001alice\u30e6\u30fc\u30b6\u3067HiveServer2\u306b\u63a5\u7d9a\u3057\u3066\u307f\u308b\u3002\n[alice@localhost ~]$ beeline \nBeeline version 1.1.0-cdh5.6.0 by Apache Hive\nbeeline> !connect jdbc:hive2://localhost:10000\nscan complete in 2ms\nConnecting to jdbc:hive2://localhost:10000\nEnter username for jdbc:hive2://localhost:10000: alice\nEnter password for jdbc:hive2://localhost:10000: *****\nConnected to: Apache Hive (version 1.1.0-cdh5.6.0)\nDriver: Hive JDBC (version 1.1.0-cdh5.6.0)\nTransaction isolation: TRANSACTION_REPEATABLE_READ\n0: jdbc:hive2://localhost:10000> SHOW TABLES;\n+-----------+--+\n| tab_name  |\n+-----------+--+\n| tbl_a     |\n+-----------+--+\n1 row selected (0.219 seconds)\n0: jdbc:hive2://localhost:10000> DESC tbl_a;\n+-----------+------------+----------+--+\n| col_name  | data_type  | comment  |\n+-----------+------------+----------+--+\n| id        | int        |          |\n+-----------+------------+----------+--+\n1 row selected (0.123 seconds)\n0: jdbc:hive2://localhost:10000> SELECT * FROM tbl_a;\n+-----------+--+\n| tbl_a.id  |\n+-----------+--+\n| 1         |\n| 2         |\n| 3         |\n| 4         |\n| 5         |\n+-----------+--+\n5 rows selected (0.525 seconds)\n0: jdbc:hive2://localhost:10000> DROP TABLE tbl_a;\nError: Error while compiling statement: FAILED: HiveAccessControlException Permission denied: Principal [name=alice, type=USER] does not have following privileges for operation DROPTABLE [[OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.tbl_a]] (state=42000,code=40000)\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u30c6\u30fc\u30d6\u30eb\u306e\u30b9\u30ad\u30fc\u30de\u3084\u5185\u5bb9\u306f\u53c2\u7167\u3067\u304d\u308b\u304c\u3001\u5909\u66f4\u3092\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001Permission denied\u304c\u767a\u751f\u3059\u308b\u3002\nADMIN\u6a29\u9650\u3092\u5f97\u3088\u3046\u3068\u3057\u3066\u3082\u3067\u304d\u306a\u3044\u3002\n0: jdbc:hive2://localhost:10000> SET ROLE ADMIN;\nError: Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. alice doesn't belong to role admin (state=08S01,code=1)\n\n\u4ee5\u4e0a\uff01\n\nHive\u3067GRANT/REVOKE\u306b\u3088\u308bINSERT/SELECT/UPDATE/DELETE\u6a29\u9650\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u6a5f\u80fd\u300cSQL Standard Based Authorization\u300d\u3092\u52d5\u304b\u3057\u3066\u307f\u308b\u3002\n\n\u74b0\u5883\u306f\n\n* CentOS 7.2\n* Hive 1.1.0 (CDH 5.6.0)\n* PostgreSQL 9.5.1 (\u30e1\u30bf\u30b9\u30c8\u30a2\u7528)\n\n# Hive\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n[\u4ee5\u524d\u306e\u8a18\u4e8b](http://qiita.com/bwtakacy/items/306afa1b8261f2d4d76e)\u53c2\u7167\u3002\n\n# Hive\u306e\u8a2d\u5b9a\n\n[Hive\u306ewiki](https://cwiki.apache.org/confluence/display/Hive/SQL+Standard+Based+Hive+Authorization)\u3092\u53c2\u8003\u306b\u8a2d\u5b9a\u3059\u308b\u3002\n\n\u8ffd\u52a0\u3067hive-site.xml\u306b\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u9805\u76ee\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3002\n\n```\n<property>\n  <name>hive.server2.enable.doAs</name>\n  <value>false</value>\n</property>\n\n<property>\n  <name>hive.users.in.admin.role</name>\n  <value>hive</value>\n</property>\n\n<property>\n  <name>hive.security.authorization.enabled</name>\n  <value>true</value>\n</property>\n\n<property>\n  <name>hive.security.metastore.authorization.manager</name>\n  <value>org.apache.hadoop.hive.ql.security.authorization.MetaStoreAuthzAPIAuthorizerEmbedOnly</value>\n</property>\n\n<property>\n  <name>hive.security.authorization.manager</name>\n  <value>org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdConfOnlyAuthorizerFactory</value>\n</property>\n\n<property>\n  <name>hive.security.authorization.task.factory</name>\n  <value>org.apache.hadoop.hive.ql.parse.authorization.HiveAuthorizationTaskFactoryImpl</value>\n</property>\n```\n\n## CDH5\u7279\u6709\u306e\u6ce8\u610f\u70b9\n\nCDH5\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306fHive\u306eSQL Based Authorization\u6a5f\u80fd\u304c\u7121\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001Hive\u306ewiki\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u8a2d\u5b9a\u9805\u76ee\u306e\u52a0\u3048\u3066hive.security.authorization.task.factory\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u3053\u308c\u3092\u8a2d\u5b9a\u3057\u306a\u3044\u3068\u3001GRANT\u6587\u306a\u3069\u3092\u5b9f\u884c\u3057\u3088\u3046\u3068\u3057\u3066\u3082\u3001\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u4f55\u3082\u52d5\u4f5c\u3057\u306a\u3044\u3002\n\n```\n0: jdbc:hive2://localhost:10000> SHOW ROLES;\nError: Error while compiling statement: FAILED: SemanticException The current builtin authorization in Hive is incomplete and disabled. (state=42000,code=40000)\n```\n\n\u975e\u5e38\u306b\u610f\u5473\u4e0d\u660e\u306a\u306e\u3067\u89e3\u6c7a\u3059\u308b\u306e\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u305f\u3002\u3002\u3002\n\n# HiveServer2\u306e\u8d77\u52d5\n\n\u8d77\u52d5\u6642\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3089\u3057\u3044\u3002\n\n```\n[hive@localhost ~]$ hiveserver2 --hiveconf hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory --hiveconf hive.security.authorization.enabled=true --hiveconf hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateUserAuthenticator --hiveconf hive.metastore.uris=''\n```\n\ninit\u30b9\u30af\u30ea\u30d7\u30c8\u7d4c\u7531\u3067\u8d77\u52d5\u3059\u308b\u5834\u5408\u306f\u3001/etc/default/hive-server2\u306b\u8d77\u52d5\u6642\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u74b0\u5883\u5909\u6570\u3067\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\u3068\u3044\u3051\u308b\u3063\u307d\u3044\u3002\n\n```shell:/etc/default/hive-server2\nexport HIVE_OPTS='--hiveconf hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory --hiveconf hive.security.authorization.enabled=true --hiveconf hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateUserAuthenticator --hiveconf hive.metastore.uris='\n```\n\n# \u52d5\u4f5c\u78ba\u8a8d\n\n[\u3053\u306e\u30d6\u30ed\u30b0](http://crazyadmins.com/setup-sql-based-authorization-in-hive/)\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u308b\u4f8b\u3092\u3084\u3063\u3066\u307f\u308b\u3002\n\nADMIN\u6a29\u9650\u3092\u6301\u3066\u308b\u30e6\u30fc\u30b6\u3067\u3001\u7279\u5b9a\u306e\u30e6\u30fc\u30b6\u306b\u306fSELECT\u6a29\u3057\u304b\u306a\u3044ROLE\u3092\u4ed8\u4e0e\u3057\u3066\u307f\u308b\u3002\n\n```\n[hive@localhost ~]$ beeline \nBeeline version 1.1.0-cdh5.6.0 by Apache Hive\nbeeline> !connect jdbc:hive2://localhost:10000 hive password org.apache.hive.jdbc.HiveDriver\nConnecting to jdbc:hive2://localhost:10000\nConnected to: Apache Hive (version 1.1.0-cdh5.6.0)\nDriver: Hive JDBC (version 1.1.0-cdh5.6.0)\nTransaction isolation: TRANSACTION_REPEATABLE_READ\n0: jdbc:hive2://localhost:10000> SET ROLE ADMIN;\nNo rows affected (0.102 seconds)\n```\n\n\u6700\u521d\u306b`SET ROLE ADMIN`\u3092\u5b9f\u884c\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u3053\u308c\u3092\u3084\u3063\u305f\u5f8c\u306breadonly\u30ed\u30fc\u30eb\u3092\u4f5c\u6210\u3002\n\n```\n0: jdbc:hive2://localhost:10000> CREATE ROLE readonly;\nNo rows affected (0.088 seconds)\n0: jdbc:hive2://localhost:10000> SHOW ROLES;\n+-----------+--+\n|   role    |\n+-----------+--+\n| admin     |\n| public    |\n| readonly  |\n+-----------+--+\n3 rows selected (0.058 seconds)\n```\n\n\u30e6\u30fc\u30b6alice\u306b\u30ed\u30fc\u30ebreadonly\u3092\u4ed8\u4e0e\u3002\n\n```\n0: jdbc:hive2://localhost:10000> GRANT ROLE readonly TO USER alice;\nNo rows affected (0.072 seconds)\n```\n\n\u9069\u5f53\u306a\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u3001readonly\u30ed\u30fc\u30eb\u306bSELECT\u6a29\u9650\u3092\u4e0e\u3048\u308b\u3002\n\n```\n0: jdbc:hive2://localhost:10000> CREATE TABLE tbl_a (id int);\nNo rows affected (0.998 seconds)\n0: jdbc:hive2://localhost:10000> LOAD DATA INPATH '/user/hive/tbl_a.data' INTO TABLE tbl_a;\nINFO  : Loading data to table default.tbl_a from hdfs://localhost:8020/user/hive/tbl_a.data\nINFO  : Table default.tbl_a stats: [numFiles=1, totalSize=10]\nNo rows affected (0.353 seconds)\n0: jdbc:hive2://localhost:10000> SHOW TABLES;\n+-----------+--+\n| tab_name  |\n+-----------+--+\n| tbl_a     |\n+-----------+--+\n1 row selected (0.07 seconds)\n0: jdbc:hive2://localhost:10000> DESC tbl_a\n0: jdbc:hive2://localhost:10000> ;\n+-----------+------------+----------+--+\n| col_name  | data_type  | comment  |\n+-----------+------------+----------+--+\n| id        | int        |          |\n+-----------+------------+----------+--+\n1 row selected (0.147 seconds)\n0: jdbc:hive2://localhost:10000> GRANT SELECT ON TABLE tbl_a TO readonly;\nError: Error while compiling statement: FAILED: ParseException line 1:31 cannot recognize input near 'readonly' '<EOF>' '<EOF>' in user|group|role name (state=42000,code=40000)\n0: jdbc:hive2://localhost:10000> GRANT SELECT ON TABLE tbl_a TO ROLE readonly;\nNo rows affected (0.144 seconds)\n0: jdbc:hive2://localhost:10000> SHOW GRANT ROLE readonly;\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n| database  | table  | partition  | column  | principal_name  | principal_type  | privilege  | grant_option  |   grant_time   | grantor  |\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n| default   | tbl_a  |            |         | readonly        | ROLE            | SELECT     | false         | 1457444851000  | hive     |\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n1 row selected (0.173 seconds)\n0: jdbc:hive2://localhost:10000> SHOW GRANT ON TABLE tbl_a;\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n| database  | table  | partition  | column  | principal_name  | principal_type  | privilege  | grant_option  |   grant_time   | grantor  |\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n| default   | tbl_a  |            |         | hive            | USER            | DELETE     | true          | 1457445229000  | hive     |\n| default   | tbl_a  |            |         | hive            | USER            | INSERT     | true          | 1457445229000  | hive     |\n| default   | tbl_a  |            |         | hive            | USER            | SELECT     | true          | 1457445229000  | hive     |\n| default   | tbl_a  |            |         | hive            | USER            | UPDATE     | true          | 1457445229000  | hive     |\n| default   | tbl_a  |            |         | readonly        | ROLE            | SELECT     | false         | 1457445378000  | hive     |\n+-----------+--------+------------+---------+-----------------+-----------------+------------+---------------+----------------+----------+--+\n5 rows selected (0.114 seconds)\n```\n\n\u3067\u3001alice\u30e6\u30fc\u30b6\u3067HiveServer2\u306b\u63a5\u7d9a\u3057\u3066\u307f\u308b\u3002\n\n```\n[alice@localhost ~]$ beeline \nBeeline version 1.1.0-cdh5.6.0 by Apache Hive\nbeeline> !connect jdbc:hive2://localhost:10000\nscan complete in 2ms\nConnecting to jdbc:hive2://localhost:10000\nEnter username for jdbc:hive2://localhost:10000: alice\nEnter password for jdbc:hive2://localhost:10000: *****\nConnected to: Apache Hive (version 1.1.0-cdh5.6.0)\nDriver: Hive JDBC (version 1.1.0-cdh5.6.0)\nTransaction isolation: TRANSACTION_REPEATABLE_READ\n0: jdbc:hive2://localhost:10000> SHOW TABLES;\n+-----------+--+\n| tab_name  |\n+-----------+--+\n| tbl_a     |\n+-----------+--+\n1 row selected (0.219 seconds)\n0: jdbc:hive2://localhost:10000> DESC tbl_a;\n+-----------+------------+----------+--+\n| col_name  | data_type  | comment  |\n+-----------+------------+----------+--+\n| id        | int        |          |\n+-----------+------------+----------+--+\n1 row selected (0.123 seconds)\n0: jdbc:hive2://localhost:10000> SELECT * FROM tbl_a;\n+-----------+--+\n| tbl_a.id  |\n+-----------+--+\n| 1         |\n| 2         |\n| 3         |\n| 4         |\n| 5         |\n+-----------+--+\n5 rows selected (0.525 seconds)\n0: jdbc:hive2://localhost:10000> DROP TABLE tbl_a;\nError: Error while compiling statement: FAILED: HiveAccessControlException Permission denied: Principal [name=alice, type=USER] does not have following privileges for operation DROPTABLE [[OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.tbl_a]] (state=42000,code=40000)\n```\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u30c6\u30fc\u30d6\u30eb\u306e\u30b9\u30ad\u30fc\u30de\u3084\u5185\u5bb9\u306f\u53c2\u7167\u3067\u304d\u308b\u304c\u3001\u5909\u66f4\u3092\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u3001Permission denied\u304c\u767a\u751f\u3059\u308b\u3002\n\nADMIN\u6a29\u9650\u3092\u5f97\u3088\u3046\u3068\u3057\u3066\u3082\u3067\u304d\u306a\u3044\u3002\n\n```\n0: jdbc:hive2://localhost:10000> SET ROLE ADMIN;\nError: Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. alice doesn't belong to role admin (state=08S01,code=1)\n```\n\n\u4ee5\u4e0a\uff01\n"}