{"context": "\u3000\u6a5f\u68b0\u5b66\u7fd2\u3092\u5b66\u3076\u306e\u306b\u6700\u3082\u9069\u3057\u305f\u6559\u6750\u3068\u8a00\u308f\u308c\u308b\u3001Machine Learning | Coursera\u3000\u3092\u53d7\u8b1b\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u5fa9\u7fd2\u3082\u517c\u306d\u5b66\u3093\u3060\u5185\u5bb9\u3092\u7c21\u6f54\u306b\u307e\u3068\u3081\u3066\u307f\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\u3000\u7b2c\u4e8c\u5f3e\u306f\u3001\u91cd\u56de\u5e30\u5206\u6790 (multiple linear regression)\u3001\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0 (feature scaling)\u3001\u6b63\u898f\u65b9\u7a0b\u5f0f (normal equation)\u3067\u3059\u3002\n\u904e\u53bb\u306e\u8a18\u4e8b\nCoursera Machine Learning (1): \u6a5f\u68b0\u5b66\u7fd2\u3068\u306f\uff1f\u5358\u56de\u5e30\u5206\u6790\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3001\u76ee\u7684\u95a2\u6570\n\n\u91cd\u56de\u5e30\u5206\u6790 (Linear Regression with Multiple Variables)\n\u3000\u5358\u56de\u5e30\u5206\u6790\u306f\u30011\u3064\u306e\u30a2\u30a6\u30c8\u30d7\u30c3\u30c8YYY\u30921\u3064\u306e\u30a4\u30f3\u30d7\u30c3\u30c8XXX\u304b\u3089\u4e88\u6e2c\u3059\u308b\u624b\u6cd5\u3067\u3057\u305f\u3002\u91cd\u56de\u5e30\u5206\u6790\u306f\u3001XXX\u304c1\u3064\u306e\u30d9\u30af\u30c8\u30eb (vector)\u3067\u306f\u306a\u304f\u3001\u8907\u6570\u306e\u30d9\u30af\u30c8\u30eb\u306e\u96c6\u307e\u308a\u3001\u30de\u30c8\u30ea\u30c3\u30af\u30b9 (matrix)\u306b\u306a\u3063\u305f\u3060\u3051\u3067\u3059\u3002\n\uff08\u4f8b\uff09\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027\u3092\u3001\u5404\u6559\u79d1\u306e\u5f97\u70b9\u304b\u3089\u4e88\u6e2c\u3059\u308b\n\n\n\n\u30c6\u30b9\u30c8\u756a\u53f7\n\u6570\u5b66\u306e\u5f97\u70b9\n\u82f1\u8a9e\u306e\u5f97\u70b9\n\u56fd\u8a9e\u306e\u5f97\u70b9\n\u7406\u79d1\u306e\u5f97\u70b9\n\u793e\u4f1a\u306e\u5f97\u70b9\n\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027 (%)\n\n\n\n\n1\n40\n60\n20\n10\n10\n10\n\n\n2\n70\n70\n60\n60\n40\n30\n\n\n3\n70\n90\n40\n40\n60\n50\n\n\n4\n80\n80\n50\n90\n70\n80\n\n\n\n\u3000\u3053\u306e\u3068\u304d\u3001\u4eee\u5b9a\u95a2\u6570 (Hypothesis Function)\u306f\u3001\u5404\u6559\u79d1\u306e\u70b9\u6570\u3092XXX\u3001\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027\u3092YYY\u3068\u3059\u308b\u3068\u3001\u91cd\u56de\u5e30\u5206\u6790\u3067\u306f\u3001YYY\u306fXXX\u306b\u3088\u3063\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a1\u6b21\u95a2\u6570\u306e\u5f0f\u3067\u8aac\u660e\u3055\u308c\u307e\u3059\u3002\n\n\\hat{Y} = h_\\theta (X) = \\theta_0 x_0 + \\theta_1 x_1 + \\theta_2 x_2 + \\theta_3 x_3\u3000+\\theta_4 x_4+ \\theta_5 x_5 = \\theta^{\\mathrm{T}} X^{\\mathrm{T}} \n\n\u02c6Y=h\u03b8(X)=\u03b80x0+\u03b81x1+\u03b82x2+\u03b83x3\u3000+\u03b84x4+\u03b85x5=\u03b8TXTY^=h\u03b8(X)=\u03b80x0+\u03b81x1+\u03b82x2+\u03b83x3\u3000+\u03b84x4+\u03b85x5=\u03b8TXT{\n\\hat{Y} = h_\\theta (X) = \\theta_0 x_0 + \\theta_1 x_1 + \\theta_2 x_2 + \\theta_3 x_3\u3000+\\theta_4 x_4+ \\theta_5 x_5 = \\theta^{\\mathrm{T}} X^{\\mathrm{T}} \n\n}\n\u3000\u3053\u306e\u3068\u304d\u3001XX\u306f4\u884c\uff08\u30c6\u30b9\u30c8\u6570\uff096\u5217\uff08\u8981\u7d20\u304c\u5168\u30661\u306e\u30d9\u30af\u30c8\u30eb + 5\u6559\u79d1\u306e\u5f97\u70b9\uff09\u306e\u30de\u30c8\u30ea\u30c3\u30af\u30b9\u3001YY\u306f4\u884c1\u5217\uff08\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027\uff09\u306e\u30d9\u30af\u30c8\u30eb\u3001\u03b8\\theta\u306f\u305d\u308c\u305e\u308c\u306e\u8aac\u660e\u5909\u6570\uff08\u6559\u79d1\u306e\u5f97\u70b9\uff09\u306e\u91cd\u307f\u3065\u3051\u3092\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u30d9\u30af\u30c8\u30eb\u3067\u3059\u3002\u03b8T\\theta^{\\mathrm{T}}\u306eTT\u306f\u8ee2\u7f6e\u884c\u5217 (transposed matrix\u3001\u3064\u307e\u308a\u3001\u884c\u3068\u5217\u3092\u5165\u308c\u66ff\u3048\u305f\u884c\u5217\u306e\u3053\u3068)\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\n  X = \\left[\n    \\begin{array}{rrr}\n      1 & 40 & 60 & 20 & 10 & 10 \\\\\n      1 & 70 & 70 & 60 & 60 & 40 \\\\\n      1 & 70 & 90 & 40 & 40 & 60 \\\\\n      1 & 80 & 80 & 50 & 90 & 70\n    \\end{array}\n  \\right]\n\n  Y = \\left[\n    \\begin{array}{rrr}\n      10 \\\\\n      30 \\\\\n      50 \\\\\n      80\n    \\end{array}\n  \\right]\n\n  \\theta = \\left[\n    \\begin{array}{rrr}\n      \\theta_0 \\\\\n      \\theta_1 \\\\\n      \\theta_2 \\\\\n      \\theta_3 \\\\\n      \\theta_4 \\\\\n      \\theta_5 \\\\\n    \\end{array}\n  \\right]\n\nX=[14060201010170706060401709040406018080509070]Y=[10305080]\u03b8=[\u03b80\u03b81\u03b82\u03b83\u03b84\u03b85]{\n  X = \\left[\n    \\begin{array}{rrr}\n      1 & 40 & 60 & 20 & 10 & 10 \\\\\n      1 & 70 & 70 & 60 & 60 & 40 \\\\\n      1 & 70 & 90 & 40 & 40 & 60 \\\\\n      1 & 80 & 80 & 50 & 90 & 70\n    \\end{array}\n  \\right]\n\n  Y = \\left[\n    \\begin{array}{rrr}\n      10 \\\\\n      30 \\\\\n      50 \\\\\n      80\n    \\end{array}\n  \\right]\n\n  \\theta = \\left[\n    \\begin{array}{rrr}\n      \\theta_0 \\\\\n      \\theta_1 \\\\\n      \\theta_2 \\\\\n      \\theta_3 \\\\\n      \\theta_4 \\\\\n      \\theta_5 \\\\\n    \\end{array}\n  \\right]\n\n}\n\u3000\u30c7\u30fc\u30bf\u306b\u6700\u3082\u30d5\u30a3\u30c3\u30c8\u3059\u308b\u3088\u3046\u306a\u03b8\\theta\u3092\u63a2\u3059\u305f\u3081\u306b\u3001\u5b9f\u30c7\u30fc\u30bf\u3068\u306e\u8aa4\u5dee\u3092\u5b9a\u91cf\u5316\u3059\u308b\u76ee\u7684\u95a2\u6570 (cost function)\u3068\u3001\u76ee\u7684\u95a2\u6570\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u305f\u3081\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3042\u308b\u6700\u6025\u964d\u4e0b\u6cd5 (Gradient Descent)\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\u76ee\u7684\u95a2\u6570 (Cost Function)\n\n   J(\\theta) = \\frac{1}{2m}\\sum_{i=1}^m(h_\\theta (x^{(i)}) - y^{(i)})^2\n\nJ(\u03b8)=12mm\u2211i=1(h\u03b8(x(i))\u2212y(i))2{\n   J(\\theta) = \\frac{1}{2m}\\sum_{i=1}^m(h_\\theta (x^{(i)}) - y^{(i)})^2\n\n}\n\u3000\u3053\u306e\u3068\u304d\u3001x(i)x^{(i)}\u306f\u3001ii\u756a\u76ee\u306e\u30a4\u30f3\u30d7\u30c3\u30c8\u30c7\u30fc\u30bf (i=2i = 2\u306a\u3089\u3001x(2)x^{(2)}\u306f\u30c6\u30b9\u30c8\u756a\u53f72\u306e\u3068\u304d\u306e\u5404\u6559\u79d1\u306e\u70b9\u6570)\u3001y(i)y^{(i)}\u306f\u3001\u305d\u306e\u3068\u304d\u306e\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027 (= 30 [%])\u3092\u8868\u3057\u307e\u3059\u3002\n\u3000\u4f8b\u306b\u3088\u3063\u3066\u3001\u9078\u3093\u3060\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u03b8\\theta\u3092\u7528\u3044\u3066\u8a08\u7b97\u3057\u305f\u4e88\u6e2c\u5024h\u03b8(x)h_\\theta (x)\u3068\u3001\u5b9f\u969b\u306e\u5024yy\u304c\u3069\u308c\u3060\u3051\u305a\u308c\u3066\u3044\u308b\u306e\u304b\u3001\u4e8c\u4e57\u5dee\u3092\u3068\u3063\u3066\u8db3\u3057\u5408\u308f\u305b\u3001\u5e73\u5747\u3092\u53d6\u3063\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u306d\u30022\u3067\u5272\u3063\u3066\u3044\u308b\u306e\u306f\u3001\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u305f\u3081\u306b\u5fae\u5206\u3059\u308b\u969b\u3001\u2211\\sum\u306e\u4e2d\u304b\u3089\u6765\u308b2\u3068\u76f8\u6bba\u3055\u308c\u308b\u3088\u3046\u306b\u3064\u3051\u3066\u3042\u308a\u307e\u3059\u3002\n\u6700\u6025\u964d\u4e0b\u6cd5 (Gradient Descent)\n\n   \\theta_j := \\theta_j - \\alpha\\frac{\\partial}{\\partial \\theta_j}J(\\theta)\n             = \\theta_j - \\alpha \\sum_{i=1}^m (h_\\theta (x^{(i)}) - y^{(i)}) x_j ^{(i)}\n\n\u03b8j:=\u03b8j\u2212\u03b1\u2202\u2202\u03b8jJ(\u03b8)=\u03b8j\u2212\u03b1m\u2211i=1(h\u03b8(x(i))\u2212y(i))x(i)j{\n   \\theta_j := \\theta_j - \\alpha\\frac{\\partial}{\\partial \\theta_j}J(\\theta)\n             = \\theta_j - \\alpha \\sum_{i=1}^m (h_\\theta (x^{(i)}) - y^{(i)}) x_j ^{(i)}\n\n}\n\u3000\u3053\u308c\u3092\u3001j=0,1,...,nj = 0, 1, ... , n\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\u540c\u6642\u306b\u3001\u03b8j\\theta_j\u306e\u5024\u304c\u53ce\u675f\u3059\u308b\u307e\u3067 (\u76ee\u5b89\u3068\u3057\u3066\u306f\u30011\u56de\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3067\u306e\u5024\u306e\u5909\u5316\u304c10\u2212310^{-3}\u3088\u308a\u5c0f\u3055\u304f\u306a\u308b\u307e\u3067\uff09\u7e70\u308a\u8fd4\u3057\u307e\u3059\u30021\u56de\u306e\u30ea\u30d4\u30fc\u30c8\u3067\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u03b8j\\theta_j\u306f\u3001\uff08\u305d\u306e\u3068\u304d\u306e\u76ee\u7684\u95a2\u6570J(\u03b8)J(\\theta)\u306e\u50be\u304d\uff09 x  \uff08\u5b66\u7fd2\u7387\u03b1\\alpha\uff09\u3000\u3060\u3051\u5024\u304c\u5909\u5316\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3000\n\u3000\u03b1\\alpha\u306e\u5024\u304c\u5927\u304d\u3051\u308c\u3070\u30011\u56de1\u56de\u306e\u03b8\\theta\u306e\u5024\u306e\u5909\u5316\u304c\u5927\u304d\u304f\u306a\u308a\u307e\u3059\u3002\u03b1\\alpha\u304c\u5c0f\u3055\u3051\u308c\u3070\u3086\u3063\u304f\u308a\u3067\u3082\u78ba\u5b9f\u306b\u53ce\u675f\u3057\u307e\u3059\u304c\u3001\u03b1\\alpha\u304c\u5927\u304d\u3059\u304e\u308b\u3068\u5024\u304c\u3068\u3073\u3068\u3073\u306b\u306a\u308a\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u7e70\u308a\u8fd4\u3057\u3066\u3044\u308b\u306e\u306b\u76ee\u7684\u95a2\u6570J(\u03b8)J(\\theta)\u304c\u5c0f\u3055\u304f\u306a\u3089\u306a\u3044\u3001\u3068\u3044\u3046\u3053\u3068\u3082\u3042\u308a\u5f97\u307e\u3059\u3002\n\n\n\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0 (feature scaling)\n\n\u3000\u8aac\u660e\u5909\u6570\u306e\u30de\u30c8\u30ea\u30c3\u30af\u30b9XX\u306f\u3001\u4eca\u56de\u306e\u4f8b\u3067\u306f\u6559\u79d1\u306e\u5f97\u70b9\u306a\u306e\u3067\u3001\u3069\u308c\u3082\u540c\u3058\u7bc4\u56f2 (0 - 100)\u306b\u53ce\u307e\u3063\u3066\u3044\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u3082\u3057\u8aac\u660e\u5909\u6570\u306e\u7bc4\u56f2\u304c\u4e92\u3044\u306b\u30d0\u30e9\u30d0\u30e9\u3060\u3063\u305f\u306a\u3089\u3070\u3001\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0 (feature scaling)\u3092\u3057\u3066\u3001\u5168\u3066\u306e\u8aac\u660e\u5909\u6570\u306e\u5024\u306e\u7bc4\u56f2\u3092\u3001\u304a\u304a\u3088\u305d\u22121\u2264xi\u22641 -1 \\leq x_i \\leq 1\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nx_i = \\frac{x_i - mean(x)}{SD(x)}\n\nxi=xi\u2212mean(x)SD(x){\nx_i = \\frac{x_i - mean(x)}{SD(x)}\n\n}\n\u3042\u308b\u3044\u306f\u3001\n\nx_i = \\frac{x_i - mean(x)}{max(x) - min(x)}\n\nxi=xi\u2212mean(x)max(x)\u2212min(x){\nx_i = \\frac{x_i - mean(x)}{max(x) - min(x)}\n\n}\n\u3068\u3059\u308c\u3070\u3001\u5024\u306e\u7bc4\u56f2\u3092\u304a\u304a\u3088\u305d-1\u304b\u30891\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002mean(x)mean(x)\u306f\u30d9\u30af\u30c8\u30ebxx\u306e\u5e73\u5747\u5024\u3001SD(x)SD(x)\u306fxx\u306e\u6a19\u6e96\u504f\u5dee\u3001max(x)max(x)\u3001min(x)min(x)\u306f\u3001\u305d\u308c\u305e\u308c\u6700\u5927\u5024\u3068\u6700\u5c0f\u5024\u3092\u8868\u3057\u307e\u3059\u3002\n\u3000\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306e\u5229\u70b9\n\u3000\u03b8\\theta\u540c\u58eb\u306e\u7bc4\u56f2\u306b\u5dee\u304c\u3042\u308b\u3068\u3001\u76ee\u7684\u95a2\u6570J(\u03b8)J(\\theta)\u304c\u975e\u5bfe\u79f0\u7684\u306a\u5f62\u306b\u306a\u308a\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3067\u6700\u5c0f\u5024\u306b\u305f\u3069\u308a\u7740\u304f\u307e\u3067\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306b\u3088\u3063\u3066\u3001\u76ee\u7684\u95a2\u6570J(\u03b8)J(\\theta)\u304c\u5bfe\u79f0\u7684\u306a\u5f62\u3068\u306a\u308a\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3067\u6700\u5c0f\u5024\u307e\u3067\u305f\u3069\u308a\u7740\u304f\u6642\u9593\u304c\u77ed\u304f\u306a\u308a\u307e\u3059\u3002\n\n\n\u6b63\u898f\u65b9\u7a0b\u5f0f (Normal Equation)\n\u3000\u6700\u6025\u964d\u4e0b\u6cd5\u4ee5\u5916\u306b\u3001\u76ee\u7684\u95a2\u6570J(\u03b8)J(\\theta)\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u65b9\u6cd5\u3068\u3057\u3066\u3001\u6b63\u898f\u65b9\u7a0b\u5f0f (normal equation)\u3092\u89e3\u304f\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\n\n\\theta = (X^{\\mathrm{T}} X)^{-1} X^{\\mathrm{T}} y\n\n\u03b8=(XTX)\u22121XTy{\n\\theta = (X^{\\mathrm{T}} X)^{-1} X^{\\mathrm{T}} y\n\n}\n\u3000\u3053\u308c\u3092\u89e3\u304f\u3068\u3001\u4e00\u767a\u3067\u76ee\u7684\u95a2\u6570J(\u03b8)J(\\theta)\u304c\u6700\u5c0f\u3068\u306a\u308b\u03b8\\theta\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u6b63\u898f\u65b9\u7a0b\u5f0f\u304c\u3042\u308c\u3070\u6700\u6025\u964d\u4e0b\u6cd5\u306a\u3093\u3066\u3044\u3089\u306a\u3044\u3058\u3083\u3093\uff1f\n\u3000\u3068\u601d\u3046\u306e\u304c\u5f53\u7136\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\u3000\u305f\u3060\u3001\u6700\u6025\u964d\u4e0b\u6cd5 (Gradient Descent)\u306b\u3082\u30e1\u30ea\u30c3\u30c8\u304c\u3042\u308a\u3001\u6b63\u898f\u65b9\u7a0b\u5f0f (Normal Equation)\u306b\u3082\u30c7\u30e1\u30ea\u30c3\u30c8\u306f\u3042\u308a\u307e\u3059\u3002\n\n\u6700\u6025\u964d\u4e0b\u6cd5\n \u5b66\u7fd2\u7387\u03b1\\alpha\u3092\u9078\u3076\u5fc5\u8981\u304c\u3042\u308b \n\u3000 \u305f\u304f\u3055\u3093\u306e\u7e70\u308a\u8fd4\u3057\u306b\u3088\u3063\u3066\u89e3\u306b\u305f\u3069\u308a\u7740\u304f \n\u3000 \u8aac\u660e\u5909\u6570\u306e\u6570\u304c\u591a\u304f\u3066\u3082 (n = 1,000,000\u7a0b\u5ea6)\u4e0a\u624b\u304f\u52d5\u304f \n\n\n\u6b63\u898f\u65b9\u7a0b\u5f0f\n \u5b66\u7fd2\u7387\u03b1\\alpha\u3092\u9078\u3070\u306a\u304f\u3066\u3088\u3044 \n\u3000 \u76f4\u63a5\u89e3\u304c\u6c42\u3081\u3089\u308c\u308b \n\u3000 X\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3044\u5834\u5408\u3001\u8a08\u7b97\u306b\u6642\u9593\u304c\u304b\u304b\u308b \n\n\u3000\u306a\u306e\u3067\u3001\u8aac\u660e\u5909\u6570\u306e\u6570\u304c100\u4e07\u3092\u8d85\u3048\u308b\u3088\u3046\u306a\u5834\u5408\u3067\u306a\u3051\u308c\u3070\u3001\u6b63\u898f\u65b9\u7a0b\u5f0f\u3092\u4f7f\u3048\u3070\u3088\u3044\u306e\u3067\u3059\u306d\u3002\npinv(X'*X)*X'*y\n\n\u3000Matlab / Octave\u3067\u3042\u308c\u3070\u3001\u4e0a\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3067\u6b63\u898f\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u307e\u3068\u3081\u306e\u307e\u3068\u3081\n\n\u91cd\u56de\u5e30\u5206\u6790\u3068\u306f\u3001\u8907\u6570\u306e\u8aac\u660e\u5909\u6570\u3067\uff11\u3064\u306e\u76ee\u7684\u5909\u6570\u3092\u4e88\u6e2c\u3059\u308b\u65b9\u6cd5\u3067\u3042\u308b\u3002\n\u76ee\u7684\u95a2\u6570 (cost function)\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u306b\u306f\u3001\u6700\u6025\u964d\u4e0b\u6cd5 (gradient descent)\u304b\u6b63\u898f\u65b9\u7a0b\u5f0f (normal equation)\u3092\u4f7f\u3046\u3002\n\u8aac\u660e\u5909\u6570\u540c\u58eb\u306e\u5024\u306e\u7bc4\u56f2\u3092\u5408\u308f\u305b\u308b\u305f\u3081\u3001\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0 (feature scaling)\u3092\u7528\u3044\u308b\u3002\n\n\n\u7d42\u308f\u308a\u306b\n\u3000\u6b21\u56de\u306f\u4e3b\u306b\u3001\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30 (logistic regression)\u306b\u3088\u308b\u5206\u985e (classification)\u306e\u304a\u8a71\u3067\u3059\u3002\n\u3000\u6a5f\u68b0\u5b66\u7fd2\u3092\u5b66\u3076\u306e\u306b\u6700\u3082\u9069\u3057\u305f\u6559\u6750\u3068\u8a00\u308f\u308c\u308b\u3001[Machine Learning | Coursera](\nhttps://www.coursera.org/learn/machine-learning)\u3000\u3092\u53d7\u8b1b\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u5fa9\u7fd2\u3082\u517c\u306d\u5b66\u3093\u3060\u5185\u5bb9\u3092\u7c21\u6f54\u306b\u307e\u3068\u3081\u3066\u307f\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3000\u7b2c\u4e8c\u5f3e\u306f\u3001\u91cd\u56de\u5e30\u5206\u6790 (multiple linear regression)\u3001\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0 (feature scaling)\u3001\u6b63\u898f\u65b9\u7a0b\u5f0f (normal equation)\u3067\u3059\u3002\n\n\n\n*\u904e\u53bb\u306e\u8a18\u4e8b*\n[Coursera Machine Learning (1): \u6a5f\u68b0\u5b66\u7fd2\u3068\u306f\uff1f\u5358\u56de\u5e30\u5206\u6790\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3001\u76ee\u7684\u95a2\u6570](http://qiita.com/katsu1110/items/fac314996f34540da260)\n\n\n\n# \u91cd\u56de\u5e30\u5206\u6790 (Linear Regression with Multiple Variables) #\n\u3000\u5358\u56de\u5e30\u5206\u6790\u306f\u30011\u3064\u306e\u30a2\u30a6\u30c8\u30d7\u30c3\u30c8$Y$\u30921\u3064\u306e\u30a4\u30f3\u30d7\u30c3\u30c8$X$\u304b\u3089\u4e88\u6e2c\u3059\u308b\u624b\u6cd5\u3067\u3057\u305f\u3002\u91cd\u56de\u5e30\u5206\u6790\u306f\u3001$X$\u304c1\u3064\u306e\u30d9\u30af\u30c8\u30eb (vector)\u3067\u306f\u306a\u304f\u3001\u8907\u6570\u306e\u30d9\u30af\u30c8\u30eb\u306e\u96c6\u307e\u308a\u3001\u30de\u30c8\u30ea\u30c3\u30af\u30b9 (matrix)\u306b\u306a\u3063\u305f\u3060\u3051\u3067\u3059\u3002\n\n\uff08\u4f8b\uff09\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027\u3092\u3001\u5404\u6559\u79d1\u306e\u5f97\u70b9\u304b\u3089\u4e88\u6e2c\u3059\u308b\n\n|  \u30c6\u30b9\u30c8\u756a\u53f7  | \u6570\u5b66\u306e\u5f97\u70b9  | \u82f1\u8a9e\u306e\u5f97\u70b9 | \u56fd\u8a9e\u306e\u5f97\u70b9 | \u7406\u79d1\u306e\u5f97\u70b9 | \u793e\u4f1a\u306e\u5f97\u70b9 | \u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027 (%) |\n|:--------------:|:------------:|:------------:|:------------:|:------------:|:------------:|:------------:|\n| 1 |     40     |     60     |     20     |     10     |     10     |    10     |\n| 2 |    70    |     70     |     60     |     60     |    40     |    30     |\n| 3 |     70     |     90     |     40     |     40     |    60     |    50     |\n| 4 |      80      |     80     |     50     |     90     |    70     |    80     |\n\n\u3000\u3053\u306e\u3068\u304d\u3001\u4eee\u5b9a\u95a2\u6570 (Hypothesis Function)\u306f\u3001\u5404\u6559\u79d1\u306e\u70b9\u6570\u3092$X$\u3001\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027\u3092$Y$\u3068\u3059\u308b\u3068\u3001\u91cd\u56de\u5e30\u5206\u6790\u3067\u306f\u3001$Y$\u306f$X$\u306b\u3088\u3063\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306a1\u6b21\u95a2\u6570\u306e\u5f0f\u3067\u8aac\u660e\u3055\u308c\u307e\u3059\u3002\n\n```math\n\n\\hat{Y} = h_\\theta (X) = \\theta_0 x_0 + \\theta_1 x_1 + \\theta_2 x_2 + \\theta_3 x_3\u3000+\\theta_4 x_4+ \\theta_5 x_5 = \\theta^{\\mathrm{T}} X^{\\mathrm{T}} \n\n```\n\n\u3000\u3053\u306e\u3068\u304d\u3001$X$\u306f4\u884c\uff08\u30c6\u30b9\u30c8\u6570\uff096\u5217\uff08\u8981\u7d20\u304c\u5168\u30661\u306e\u30d9\u30af\u30c8\u30eb + 5\u6559\u79d1\u306e\u5f97\u70b9\uff09\u306e\u30de\u30c8\u30ea\u30c3\u30af\u30b9\u3001$Y$\u306f4\u884c1\u5217\uff08\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027\uff09\u306e\u30d9\u30af\u30c8\u30eb\u3001$\\theta$\u306f\u305d\u308c\u305e\u308c\u306e\u8aac\u660e\u5909\u6570\uff08\u6559\u79d1\u306e\u5f97\u70b9\uff09\u306e\u91cd\u307f\u3065\u3051\u3092\u3059\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u30d9\u30af\u30c8\u30eb\u3067\u3059\u3002$\\theta^{\\mathrm{T}}$\u306e$T$\u306f\u8ee2\u7f6e\u884c\u5217 (transposed matrix\u3001\u3064\u307e\u308a\u3001\u884c\u3068\u5217\u3092\u5165\u308c\u66ff\u3048\u305f\u884c\u5217\u306e\u3053\u3068)\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```math\n\n  X = \\left[\n    \\begin{array}{rrr}\n      1 & 40 & 60 & 20 & 10 & 10 \\\\\n      1 & 70 & 70 & 60 & 60 & 40 \\\\\n      1 & 70 & 90 & 40 & 40 & 60 \\\\\n      1 & 80 & 80 & 50 & 90 & 70\n    \\end{array}\n  \\right]\n\n  Y = \\left[\n    \\begin{array}{rrr}\n      10 \\\\\n      30 \\\\\n      50 \\\\\n      80\n    \\end{array}\n  \\right]\n\n  \\theta = \\left[\n    \\begin{array}{rrr}\n      \\theta_0 \\\\\n      \\theta_1 \\\\\n      \\theta_2 \\\\\n      \\theta_3 \\\\\n      \\theta_4 \\\\\n      \\theta_5 \\\\\n    \\end{array}\n  \\right]\n\n```\n\n\u3000\u30c7\u30fc\u30bf\u306b\u6700\u3082\u30d5\u30a3\u30c3\u30c8\u3059\u308b\u3088\u3046\u306a$\\theta$\u3092\u63a2\u3059\u305f\u3081\u306b\u3001\u5b9f\u30c7\u30fc\u30bf\u3068\u306e\u8aa4\u5dee\u3092\u5b9a\u91cf\u5316\u3059\u308b\u76ee\u7684\u95a2\u6570 (cost function)\u3068\u3001\u76ee\u7684\u95a2\u6570\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u305f\u3081\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3067\u3042\u308b\u6700\u6025\u964d\u4e0b\u6cd5 (Gradient Descent)\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\n**\u76ee\u7684\u95a2\u6570 (Cost Function)**\n\n```math\n\n   J(\\theta) = \\frac{1}{2m}\\sum_{i=1}^m(h_\\theta (x^{(i)}) - y^{(i)})^2\n\n```\n\n\u3000\u3053\u306e\u3068\u304d\u3001$x^{(i)}$\u306f\u3001$i$\u756a\u76ee\u306e\u30a4\u30f3\u30d7\u30c3\u30c8\u30c7\u30fc\u30bf ($i = 2$\u306a\u3089\u3001$x^{(2)}$\u306f\u30c6\u30b9\u30c8\u756a\u53f72\u306e\u3068\u304d\u306e\u5404\u6559\u79d1\u306e\u70b9\u6570)\u3001$y^{(i)}$\u306f\u3001\u305d\u306e\u3068\u304d\u306e\u5fd7\u671b\u6821\u306e\u5408\u683c\u53ef\u80fd\u6027 (= 30 [%])\u3092\u8868\u3057\u307e\u3059\u3002\n\n\u3000\u4f8b\u306b\u3088\u3063\u3066\u3001\u9078\u3093\u3060\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc$\\theta$\u3092\u7528\u3044\u3066\u8a08\u7b97\u3057\u305f\u4e88\u6e2c\u5024$h_\\theta (x)$\u3068\u3001\u5b9f\u969b\u306e\u5024$y$\u304c\u3069\u308c\u3060\u3051\u305a\u308c\u3066\u3044\u308b\u306e\u304b\u3001\u4e8c\u4e57\u5dee\u3092\u3068\u3063\u3066\u8db3\u3057\u5408\u308f\u305b\u3001\u5e73\u5747\u3092\u53d6\u3063\u3066\u3044\u308b\u3060\u3051\u3067\u3059\u306d\u30022\u3067\u5272\u3063\u3066\u3044\u308b\u306e\u306f\u3001\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u305f\u3081\u306b\u5fae\u5206\u3059\u308b\u969b\u3001$\\sum$\u306e\u4e2d\u304b\u3089\u6765\u308b2\u3068\u76f8\u6bba\u3055\u308c\u308b\u3088\u3046\u306b\u3064\u3051\u3066\u3042\u308a\u307e\u3059\u3002\n\n**\u6700\u6025\u964d\u4e0b\u6cd5 (Gradient Descent)**\n\n```math\n\n   \\theta_j := \\theta_j - \\alpha\\frac{\\partial}{\\partial \\theta_j}J(\\theta)\n             = \\theta_j - \\alpha \\sum_{i=1}^m (h_\\theta (x^{(i)}) - y^{(i)}) x_j ^{(i)}\n\n```\n\n\u3000\u3053\u308c\u3092\u3001$j = 0, 1, ... , n$\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\u540c\u6642\u306b\u3001$\\theta_j$\u306e\u5024\u304c\u53ce\u675f\u3059\u308b\u307e\u3067 (\u76ee\u5b89\u3068\u3057\u3066\u306f\u30011\u56de\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3067\u306e\u5024\u306e\u5909\u5316\u304c$10^{-3}$\u3088\u308a\u5c0f\u3055\u304f\u306a\u308b\u307e\u3067\uff09\u7e70\u308a\u8fd4\u3057\u307e\u3059\u30021\u56de\u306e\u30ea\u30d4\u30fc\u30c8\u3067\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc$\\theta_j$\u306f\u3001\uff08\u305d\u306e\u3068\u304d\u306e\u76ee\u7684\u95a2\u6570$J(\\theta)$\u306e\u50be\u304d\uff09 x  \uff08\u5b66\u7fd2\u7387$\\alpha$\uff09\u3000\u3060\u3051\u5024\u304c\u5909\u5316\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u3000\n\u3000$\\alpha$\u306e\u5024\u304c\u5927\u304d\u3051\u308c\u3070\u30011\u56de1\u56de\u306e$\\theta$\u306e\u5024\u306e\u5909\u5316\u304c\u5927\u304d\u304f\u306a\u308a\u307e\u3059\u3002$\\alpha$\u304c\u5c0f\u3055\u3051\u308c\u3070\u3086\u3063\u304f\u308a\u3067\u3082\u78ba\u5b9f\u306b\u53ce\u675f\u3057\u307e\u3059\u304c\u3001$\\alpha$\u304c\u5927\u304d\u3059\u304e\u308b\u3068\u5024\u304c\u3068\u3073\u3068\u3073\u306b\u306a\u308a\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3092\u7e70\u308a\u8fd4\u3057\u3066\u3044\u308b\u306e\u306b\u76ee\u7684\u95a2\u6570$J(\\theta)$\u304c\u5c0f\u3055\u304f\u306a\u3089\u306a\u3044\u3001\u3068\u3044\u3046\u3053\u3068\u3082\u3042\u308a\u5f97\u307e\u3059\u3002\n\n![fig3.PNG](https://qiita-image-store.s3.amazonaws.com/0/122354/c6840853-9189-7674-72cb-ee17b755fc61.png)\n\n\n\n### \u30b9\u30b1\u30fc\u30ea\u30f3\u30b0 (feature scaling) ###\n***\n\u3000\u8aac\u660e\u5909\u6570\u306e\u30de\u30c8\u30ea\u30c3\u30af\u30b9$X$\u306f\u3001\u4eca\u56de\u306e\u4f8b\u3067\u306f\u6559\u79d1\u306e\u5f97\u70b9\u306a\u306e\u3067\u3001\u3069\u308c\u3082\u540c\u3058\u7bc4\u56f2 (0 - 100)\u306b\u53ce\u307e\u3063\u3066\u3044\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u3082\u3057\u8aac\u660e\u5909\u6570\u306e\u7bc4\u56f2\u304c\u4e92\u3044\u306b\u30d0\u30e9\u30d0\u30e9\u3060\u3063\u305f\u306a\u3089\u3070\u3001\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0 (feature scaling)\u3092\u3057\u3066\u3001\u5168\u3066\u306e\u8aac\u660e\u5909\u6570\u306e\u5024\u306e\u7bc4\u56f2\u3092\u3001\u304a\u304a\u3088\u305d$ -1 \\leq x_i \\leq 1$\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```math\n\nx_i = \\frac{x_i - mean(x)}{SD(x)}\n\n```\n\n\u3042\u308b\u3044\u306f\u3001\n\n```math\n\nx_i = \\frac{x_i - mean(x)}{max(x) - min(x)}\n\n```\n\n\u3068\u3059\u308c\u3070\u3001\u5024\u306e\u7bc4\u56f2\u3092\u304a\u304a\u3088\u305d-1\u304b\u30891\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002$mean(x)$\u306f\u30d9\u30af\u30c8\u30eb$x$\u306e\u5e73\u5747\u5024\u3001$SD(x)$\u306f$x$\u306e\u6a19\u6e96\u504f\u5dee\u3001$max(x)$\u3001$min(x)$\u306f\u3001\u305d\u308c\u305e\u308c\u6700\u5927\u5024\u3068\u6700\u5c0f\u5024\u3092\u8868\u3057\u307e\u3059\u3002\n\n\u3000*\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306e\u5229\u70b9*\n\u3000$\\theta$\u540c\u58eb\u306e\u7bc4\u56f2\u306b\u5dee\u304c\u3042\u308b\u3068\u3001\u76ee\u7684\u95a2\u6570$J(\\theta)$\u304c\u975e\u5bfe\u79f0\u7684\u306a\u5f62\u306b\u306a\u308a\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3067\u6700\u5c0f\u5024\u306b\u305f\u3069\u308a\u7740\u304f\u307e\u3067\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u3059\u3002\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306b\u3088\u3063\u3066\u3001\u76ee\u7684\u95a2\u6570$J(\\theta)$\u304c\u5bfe\u79f0\u7684\u306a\u5f62\u3068\u306a\u308a\u3001\u6700\u6025\u964d\u4e0b\u6cd5\u3067\u6700\u5c0f\u5024\u307e\u3067\u305f\u3069\u308a\u7740\u304f\u6642\u9593\u304c\u77ed\u304f\u306a\u308a\u307e\u3059\u3002\n\n![fig4.PNG](https://qiita-image-store.s3.amazonaws.com/0/122354/af86ad2b-1c3d-e577-2fb2-781f26fe8798.png)\n\n# \u6b63\u898f\u65b9\u7a0b\u5f0f (Normal Equation) #\n\u3000\u6700\u6025\u964d\u4e0b\u6cd5\u4ee5\u5916\u306b\u3001\u76ee\u7684\u95a2\u6570$J(\\theta)$\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u65b9\u6cd5\u3068\u3057\u3066\u3001\u6b63\u898f\u65b9\u7a0b\u5f0f (normal equation)\u3092\u89e3\u304f\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\n\n```math\n\n\\theta = (X^{\\mathrm{T}} X)^{-1} X^{\\mathrm{T}} y\n\n```\n\n\u3000\u3053\u308c\u3092\u89e3\u304f\u3068\u3001\u4e00\u767a\u3067\u76ee\u7684\u95a2\u6570$J(\\theta)$\u304c\u6700\u5c0f\u3068\u306a\u308b$\\theta$\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3000**\u6b63\u898f\u65b9\u7a0b\u5f0f\u304c\u3042\u308c\u3070\u6700\u6025\u964d\u4e0b\u6cd5\u306a\u3093\u3066\u3044\u3089\u306a\u3044\u3058\u3083\u3093\uff1f**\n\n\u3000\u3068\u601d\u3046\u306e\u304c\u5f53\u7136\u3060\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3000\u305f\u3060\u3001\u6700\u6025\u964d\u4e0b\u6cd5 (Gradient Descent)\u306b\u3082\u30e1\u30ea\u30c3\u30c8\u304c\u3042\u308a\u3001\u6b63\u898f\u65b9\u7a0b\u5f0f (Normal Equation)\u306b\u3082\u30c7\u30e1\u30ea\u30c3\u30c8\u306f\u3042\u308a\u307e\u3059\u3002\n\n<dl>\n  <dt>\u6700\u6025\u964d\u4e0b\u6cd5</dt>\n  <dd> \u5b66\u7fd2\u7387$\\alpha$\u3092\u9078\u3076\u5fc5\u8981\u304c\u3042\u308b </dd>\n\u3000<dd> \u305f\u304f\u3055\u3093\u306e\u7e70\u308a\u8fd4\u3057\u306b\u3088\u3063\u3066\u89e3\u306b\u305f\u3069\u308a\u7740\u304f </dd>\n\u3000<dd> <strong>\u8aac\u660e\u5909\u6570\u306e\u6570\u304c\u591a\u304f\u3066\u3082 (n = 1,000,000\u7a0b\u5ea6)\u4e0a\u624b\u304f\u52d5\u304f</strong> </dd>\n</dl>\n\n\n\n<dl>\n  <dt>\u6b63\u898f\u65b9\u7a0b\u5f0f</dt>\n  <dd> \u5b66\u7fd2\u7387$\\alpha$\u3092\u9078\u3070\u306a\u304f\u3066\u3088\u3044 </dd>\n\u3000<dd> \u76f4\u63a5\u89e3\u304c\u6c42\u3081\u3089\u308c\u308b </dd>\n\u3000<dd> <strong>X\u306e\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3044\u5834\u5408\u3001\u8a08\u7b97\u306b\u6642\u9593\u304c\u304b\u304b\u308b</strong> </dd>\n</dl>\n\n\u3000\u306a\u306e\u3067\u3001\u8aac\u660e\u5909\u6570\u306e\u6570\u304c100\u4e07\u3092\u8d85\u3048\u308b\u3088\u3046\u306a\u5834\u5408\u3067\u306a\u3051\u308c\u3070\u3001\u6b63\u898f\u65b9\u7a0b\u5f0f\u3092\u4f7f\u3048\u3070\u3088\u3044\u306e\u3067\u3059\u306d\u3002\n\n```matlab:\npinv(X'*X)*X'*y\n```\n\n\u3000Matlab / Octave\u3067\u3042\u308c\u3070\u3001\u4e0a\u8a18\u306e\u30b3\u30de\u30f3\u30c9\u3067\u6b63\u898f\u65b9\u7a0b\u5f0f\u3092\u89e3\u304f\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n#\u307e\u3068\u3081\u306e\u307e\u3068\u3081#\n- \u91cd\u56de\u5e30\u5206\u6790\u3068\u306f\u3001\u8907\u6570\u306e\u8aac\u660e\u5909\u6570\u3067\uff11\u3064\u306e\u76ee\u7684\u5909\u6570\u3092\u4e88\u6e2c\u3059\u308b\u65b9\u6cd5\u3067\u3042\u308b\u3002\n- \u76ee\u7684\u95a2\u6570 (cost function)\u306e\u6700\u5c0f\u5024\u3092\u6c42\u3081\u308b\u306b\u306f\u3001\u6700\u6025\u964d\u4e0b\u6cd5 (gradient descent)\u304b\u6b63\u898f\u65b9\u7a0b\u5f0f (normal equation)\u3092\u4f7f\u3046\u3002\n- \u8aac\u660e\u5909\u6570\u540c\u58eb\u306e\u5024\u306e\u7bc4\u56f2\u3092\u5408\u308f\u305b\u308b\u305f\u3081\u3001\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0 (feature scaling)\u3092\u7528\u3044\u308b\u3002\n\n\n#\u7d42\u308f\u308a\u306b#\n\u3000[\u6b21\u56de](http://qiita.com/katsu1110/items/e4ef613559f02f183af5)\u306f\u4e3b\u306b\u3001\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30 (logistic regression)\u306b\u3088\u308b\u5206\u985e (classification)\u306e\u304a\u8a71\u3067\u3059\u3002\n", "tags": ["coursera", "\u6a5f\u68b0\u5b66\u7fd2", "\u91cd\u56de\u5e30\u5206\u6790", "Octave", "matlab"]}