{"context": "\n\nTL;DR\nActiveAdmin\u306escope\u540d\u306b\u65e5\u672c\u8a9e\u3092\u4f7f\u3044\u305f\u3044\u3068\u304d\u306f\u3001\u6a2a\u7740\u305b\u305a\u306b config/locales/ja.yml \u306b\u8a2d\u5b9a\u3059\u308b\u3002\n\n\u554f\u984c\nActiveAdmin\u3092\u4f7f\u3063\u3066\u3044\u3066\u3001scope\u540d\u3092\u65e5\u672c\u8a9e\u3067\u30d9\u30bf\u66f8\u304d\u3057\u3066\u3044\u305f\u3089\u3001\u8868\u793a\u3055\u308c\u3066\u3044\u308bscope\u304c\u306a\u3093\u3060\u304b\u8db3\u308a\u306a\u3044\u3002\n\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u3001\u30e6\u30fc\u30b6\u30fc\u3092\u767b\u9332\u5e74\u6708\u5225\u306b\u8868\u793a\u3057\u305f\u3044\u5834\u5408\u3092\u8003\u3048\u308b\n\nhogehoge_admin/user.rb\nActiveAdmin.register User do\n\n##### \u7565 #####\n\n  scope(\"2014\u5e74\u524d\u534a\u767b\u9332\") { |scope| scope.where(\"created_at BETWEEN '2014-01-01' AND '2014-05-31'\") }\n  scope(\"2014\u5e74\u5f8c\u534a\u767b\u9332\") { |scope| scope.where(\"created_at BETWEEN '2014-06-01' AND '2014-12-31'\") }\n  scope(\"2015\u5e74\u524d\u534a\u767b\u9332\") { |scope| scope.where(\"created_at BETWEEN '2015-01-01' AND '2015-05-31'\") }\n  scope(\"2015\u5e74\u5f8c\u534a\u767b\u9332\", default: true) { |scope| scope.where(\"created_at BETWEEN '2015-06-01' AND '2015-12-31'\") }\n  scope :all\n\n##### \u7565 #####\n\nend\n\n\n\u3053\u3046\u66f8\u304f\u3068\u3001\n\n\u3053\u3046\u306a\u308b\u3002\n\n\u539f\u56e0\ngem\u306e\u4e2d\u8eab\u3092\u8aad\u3093\u3067\u63a2\u3063\u3066\u307f\u308b\u3002\n\nactive_admin/scope.rb\nmodule ActiveAdmin\n  class Scope\n\n##### \u7565 ######\n\n    def initialize(name, method = nil, options = {}, &block)\n      @name, @scope_method = name, method.try(:to_sym)\n\n      if name.is_a? Proc\n        raise \"A string/symbol is required as the second argument if your label is a proc.\" unless method\n        @id = ActiveAdmin::Dependency.rails.parameterize method.to_s\n      else\n        @scope_method ||= name.to_sym\n        @id = ActiveAdmin::Dependency.rails.parameterize name.to_s\n      end\n\n      @scope_method               = nil        if @scope_method == :all\n      @scope_method, @scope_block = nil, block if block_given?\n\n      @show_count       = options.fetch(:show_count, true)\n      @display_if_block = options[:if]      || proc{ true }\n      @default_block    = options[:default] || proc{ false }\n    end\n\n##### \u7565 ######\n\n  end\nend\n\n\nscope \u306e\u5f15\u6570\u306b name, method, option\u3068\u3001block \u304c\u6e21\u3055\u308c\u3066\u3044\u308b\u3002\n\u4eca\u56de\u95a2\u4fc2\u3042\u308a\u305d\u3046\u306a\u306e\u306f name \u306a\u306e\u3067\u3001\u305d\u306e\u52d5\u304d\u3092\u8ffd\u3063\u3066\u307f\u308b\u3068\u3001 \n@id = ActiveAdmin::Dependency.rails.parameterize name.to_s\n\n\u3068\u3042\u308b\u3088\u3046\u306b\u3001 name \u3092 parameterize \u3057\u305f\u3082\u306e\u3092\u3001 scope  \u306e id \u3068\u3057\u3066\u3044\u308b\u3089\u3057\u3044\u3002\n\u2026\u2026\u602a\u3057\u3044\u3002\u306e\u3067console\u3067\u8a66\u3057\u3066\u307f\u308b\u3002\n[1] pry(main)> \"2014\u5e74\u524d\u534a\u767b\u9332\".parameterize\n=> \"2014\"\n[2] pry(main)> \"2014\u5e74\u5f8c\u534a\u767b\u9332\".parameterize\n=> \"2014\"\n\n\u3053\u308c\u3060\u30fc\uff01\n\u3069\u3046\u3084\u3089 parameterize \u306b\u65e5\u672c\u8a9e\u3092\u6e21\u3057\u3066\u3044\u305f\u306e\u304c\u554f\u984c\u3060\u3063\u305f\u69d8\u5b50\u3002\n\n\u89e3\u6c7a\u7b56\n\u30d9\u30bf\u66f8\u304d\u305b\u305a\u306b config/locales/ja.yml \u306b\u8a2d\u5b9a\u3092\u66f8\u304f\u3002\n\nhogehoge_admin/user.rb\nActiveAdmin.register User do\n\n  scope(:early_2014) { |scope| scope.where(\"created_at BETWEEN '2014-01-01' AND '2014-05-31'\") }\n  scope(:later_2014) { |scope| scope.where(\"created_at BETWEEN '2014-06-01' AND '2014-12-31'\") }\n  scope(:early_2015) { |scope| scope.where(\"created_at BETWEEN '2015-01-01' AND '2015-05-31'\") }\n  scope(:later_2015, default: true) { |scope| scope.where(\"created_at BETWEEN '2015-06-01' AND '2015-12-31'\") }\n  scope :all\n\nend\n\n\n\nconfig/locales/ja.yml\nactive_admin:\n    scopes:\n      all: \u3059\u3079\u3066\n      early_2014: 2014\u5e74\u524d\u534a\u767b\u9332\n      later_2014: 2014\u5e74\u5f8c\u534a\u767b\u9332\n      early_2015: 2015\u5e74\u524d\u534a\u767b\u9332\n      later_2015: 2015\u5e74\u5f8c\u534a\u767b\u9332\n\n\n\n\n\u96d1\u611f\n\u30d9\u30bf\u6253\u3061\u3057\u306a\u3044\u3068\u304b\u5f53\u305f\u308a\u524d\u306a\u3093\u3060\u3051\u3069\u3001ActiveAdmin\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\nscope :all, default: true\n\n# assumes the model has a scope called ':active'\nscope :active\n\n# renames model scope ':leaves' to ':subcategories'\nscope \"Subcategories\", :leaves\n\n# Dynamic scope name\nscope ->{ Date.today.strftime '%A' }, :published_today\n\n# custom scope not defined on the model\nscope(\"Inactive\") { |scope| scope.where(active: false) }\n\n# conditionally show a custom controller scope\nscope \"Published\", if: proc { current_admin_user.can? :manage, Posts } do |posts|\n  posts.published\nend\n\n\u3063\u3066\u3044\u3046\u3088\u3046\u306a\u4f8b\u304c\u3042\u3063\u305f\u304b\u3089\u7518\u3048\u3066\u3057\u307e\u3063\u305f\u3002\n\u65e5\u672c\u8a9e\u5bfe\u5fdc\u306f\u4e01\u5be7\u306b\u3084\u308d\u3046\u306a\u3002\n\n\u53c2\u8003\nhttps://github.com/activeadmin/activeadmin\n# TL;DR\nActiveAdmin\u306escope\u540d\u306b\u65e5\u672c\u8a9e\u3092\u4f7f\u3044\u305f\u3044\u3068\u304d\u306f\u3001\u6a2a\u7740\u305b\u305a\u306b `config/locales/ja.yml` \u306b\u8a2d\u5b9a\u3059\u308b\u3002\n\n# \u554f\u984c\nActiveAdmin\u3092\u4f7f\u3063\u3066\u3044\u3066\u3001scope\u540d\u3092\u65e5\u672c\u8a9e\u3067\u30d9\u30bf\u66f8\u304d\u3057\u3066\u3044\u305f\u3089\u3001\u8868\u793a\u3055\u308c\u3066\u3044\u308bscope\u304c\u306a\u3093\u3060\u304b\u8db3\u308a\u306a\u3044\u3002\n\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u3001\u30e6\u30fc\u30b6\u30fc\u3092\u767b\u9332\u5e74\u6708\u5225\u306b\u8868\u793a\u3057\u305f\u3044\u5834\u5408\u3092\u8003\u3048\u308b\n\n```hogehoge_admin/user.rb\nActiveAdmin.register User do\n\n##### \u7565 #####\n\n  scope(\"2014\u5e74\u524d\u534a\u767b\u9332\") { |scope| scope.where(\"created_at BETWEEN '2014-01-01' AND '2014-05-31'\") }\n  scope(\"2014\u5e74\u5f8c\u534a\u767b\u9332\") { |scope| scope.where(\"created_at BETWEEN '2014-06-01' AND '2014-12-31'\") }\n  scope(\"2015\u5e74\u524d\u534a\u767b\u9332\") { |scope| scope.where(\"created_at BETWEEN '2015-01-01' AND '2015-05-31'\") }\n  scope(\"2015\u5e74\u5f8c\u534a\u767b\u9332\", default: true) { |scope| scope.where(\"created_at BETWEEN '2015-06-01' AND '2015-12-31'\") }\n  scope :all\n\n##### \u7565 #####\n\nend\n```\n\u3053\u3046\u66f8\u304f\u3068\u3001\n![bad_example](https://qiita-image-store.s3.amazonaws.com/0/52834/70134c62-bcf9-00b4-ecbd-682325800661.png)\n\u3053\u3046\u306a\u308b\u3002\n\n# \u539f\u56e0\n[gem\u306e\u4e2d\u8eab](https://github.com/activeadmin/activeadmin/blob/master/lib/active_admin/scope.rb#L27)\u3092\u8aad\u3093\u3067\u63a2\u3063\u3066\u307f\u308b\u3002\n\n```active_admin/scope.rb\nmodule ActiveAdmin\n  class Scope\n\n##### \u7565 ######\n\n    def initialize(name, method = nil, options = {}, &block)\n      @name, @scope_method = name, method.try(:to_sym)\n\n      if name.is_a? Proc\n        raise \"A string/symbol is required as the second argument if your label is a proc.\" unless method\n        @id = ActiveAdmin::Dependency.rails.parameterize method.to_s\n      else\n        @scope_method ||= name.to_sym\n        @id = ActiveAdmin::Dependency.rails.parameterize name.to_s\n      end\n\n      @scope_method               = nil        if @scope_method == :all\n      @scope_method, @scope_block = nil, block if block_given?\n\n      @show_count       = options.fetch(:show_count, true)\n      @display_if_block = options[:if]      || proc{ true }\n      @default_block    = options[:default] || proc{ false }\n    end\n\n##### \u7565 ######\n\n  end\nend\n```\n\n`scope` \u306e\u5f15\u6570\u306b `name`, `method`, `option`\u3068\u3001`block` \u304c\u6e21\u3055\u308c\u3066\u3044\u308b\u3002\n\u4eca\u56de\u95a2\u4fc2\u3042\u308a\u305d\u3046\u306a\u306e\u306f `name` \u306a\u306e\u3067\u3001\u305d\u306e\u52d5\u304d\u3092\u8ffd\u3063\u3066\u307f\u308b\u3068\u3001 \n\n```rb\n@id = ActiveAdmin::Dependency.rails.parameterize name.to_s\n```\n\n\u3068\u3042\u308b\u3088\u3046\u306b\u3001 `name` \u3092 `parameterize` \u3057\u305f\u3082\u306e\u3092\u3001 `scope`  \u306e `id` \u3068\u3057\u3066\u3044\u308b\u3089\u3057\u3044\u3002\n\u2026\u2026\u602a\u3057\u3044\u3002\u306e\u3067console\u3067\u8a66\u3057\u3066\u307f\u308b\u3002\n\n```rb\n[1] pry(main)> \"2014\u5e74\u524d\u534a\u767b\u9332\".parameterize\n=> \"2014\"\n[2] pry(main)> \"2014\u5e74\u5f8c\u534a\u767b\u9332\".parameterize\n=> \"2014\"\n```\n\n\u3053\u308c\u3060\u30fc\uff01\n\u3069\u3046\u3084\u3089 `parameterize` \u306b\u65e5\u672c\u8a9e\u3092\u6e21\u3057\u3066\u3044\u305f\u306e\u304c\u554f\u984c\u3060\u3063\u305f\u69d8\u5b50\u3002\n\n# \u89e3\u6c7a\u7b56\n\u30d9\u30bf\u66f8\u304d\u305b\u305a\u306b `config/locales/ja.yml` \u306b\u8a2d\u5b9a\u3092\u66f8\u304f\u3002\n\n```hogehoge_admin/user.rb\nActiveAdmin.register User do\n\n  scope(:early_2014) { |scope| scope.where(\"created_at BETWEEN '2014-01-01' AND '2014-05-31'\") }\n  scope(:later_2014) { |scope| scope.where(\"created_at BETWEEN '2014-06-01' AND '2014-12-31'\") }\n  scope(:early_2015) { |scope| scope.where(\"created_at BETWEEN '2015-01-01' AND '2015-05-31'\") }\n  scope(:later_2015, default: true) { |scope| scope.where(\"created_at BETWEEN '2015-06-01' AND '2015-12-31'\") }\n  scope :all\n\nend\n```\n```config/locales/ja.yml\nactive_admin:\n    scopes:\n      all: \u3059\u3079\u3066\n      early_2014: 2014\u5e74\u524d\u534a\u767b\u9332\n      later_2014: 2014\u5e74\u5f8c\u534a\u767b\u9332\n      early_2015: 2015\u5e74\u524d\u534a\u767b\u9332\n      later_2015: 2015\u5e74\u5f8c\u534a\u767b\u9332\n```\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-15 18.20.48.png](https://qiita-image-store.s3.amazonaws.com/0/52834/267275df-0cfe-78f6-43d9-a4b4ed648424.png)\n\n\n# \u96d1\u611f\n\u30d9\u30bf\u6253\u3061\u3057\u306a\u3044\u3068\u304b\u5f53\u305f\u308a\u524d\u306a\u3093\u3060\u3051\u3069\u3001ActiveAdmin\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\n\n```rb\nscope :all, default: true\n\n# assumes the model has a scope called ':active'\nscope :active\n\n# renames model scope ':leaves' to ':subcategories'\nscope \"Subcategories\", :leaves\n\n# Dynamic scope name\nscope ->{ Date.today.strftime '%A' }, :published_today\n\n# custom scope not defined on the model\nscope(\"Inactive\") { |scope| scope.where(active: false) }\n\n# conditionally show a custom controller scope\nscope \"Published\", if: proc { current_admin_user.can? :manage, Posts } do |posts|\n  posts.published\nend\n```\n\n\u3063\u3066\u3044\u3046\u3088\u3046\u306a\u4f8b\u304c\u3042\u3063\u305f\u304b\u3089\u7518\u3048\u3066\u3057\u307e\u3063\u305f\u3002\n\u65e5\u672c\u8a9e\u5bfe\u5fdc\u306f\u4e01\u5be7\u306b\u3084\u308d\u3046\u306a\u3002\n\n## \u53c2\u8003\nhttps://github.com/activeadmin/activeadmin\n", "tags": ["Rails", "activeadmin"]}