{"context": " More than 1 year has passed since last update.pm2\u3067Node.js\u3092\u30d7\u30ed\u30bb\u30b9\u3092\u8d77\u52d5\u3059\u308b\u3068\u3001pm2\u81ea\u8eab\u306f\u3059\u3050\u306b\u7d42\u4e86\u3057\u3066\u3057\u307e\u3046\u3002\n\u306a\u306e\u3067Docker\u306eCMD\u3067pm2\u3092\u958b\u59cb\u3057\u3066\u3082\u30b3\u30f3\u30c6\u30ca\u306f\u505c\u6b62\u3057\u3066\u3057\u307e\u3046\u3002\n\u3053\u307e\u3063\u305f\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u3002\n\u5168\u7136\u56f0\u3089\u306a\u304b\u3063\u305f\u3002\npm2\u306b --no-daemon \u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u305f\u306e\u3067\u3001\u305d\u308c\u3067OK\u3067\u3057\u305f\u3002\nhttps://github.com/Unitech/pm2/issues/259\n\nDockerfile\u3084\u3089\u4f55\u3084\u3089\nDockerfile\nFROM node\n\nWORKDIR /nodeapp\n\nADD package.json /nodeapp/\nADD index.js /nodeapp/\n\nRUN npm install\n\nEXPOSE  1337\n\nCMD [\"node_modules/pm2/bin/pm2\", \"--no-daemon\", \"start\", \"index.js\"]\n\npackage.json\n{\n  \"name\": \"docker-pm2\",\n  \"version\": \"0.0.1\",\n  \"description\": \"Docker pm2 example\",\n  \"main\": \"index.js\",\n  \"author\": \"5t111111\",\n  \"dependencies\": {\n    \"pm2\": \"latest\"\n  }\n}\n\nindex.js\nvar http = require('http');\nhttp.createServer(function (req, res) {\n  res.writeHead(200, {'Content-Type': 'text/plain'});\n  res.end('Hello World\\n');\n}).listen(1337);\n\n\n\u8d77\u52d5\n$ docker build .\n\n$ docker run -P -d <\u30a4\u30e1\u30fc\u30b8ID>\n\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                     NAMES\nf89174a4ac15        392c405d84f6        node_modules/pm2/bin   48 seconds ago      Up 47 seconds       0.0.0.0:49169->1337/tcp   sad_shockley\n\n$ curl -i localhost:49169\nHTTP/1.1 200 OK\nContent-Type: text/plain\nDate: Thu, 03 Jul 2014 14:57:45 GMT\nConnection: keep-alive\nTransfer-Encoding: chunked\n\nHello World\n\n\npm2\u3067Node.js\u3092\u30d7\u30ed\u30bb\u30b9\u3092\u8d77\u52d5\u3059\u308b\u3068\u3001pm2\u81ea\u8eab\u306f\u3059\u3050\u306b\u7d42\u4e86\u3057\u3066\u3057\u307e\u3046\u3002\n\u306a\u306e\u3067Docker\u306eCMD\u3067pm2\u3092\u958b\u59cb\u3057\u3066\u3082\u30b3\u30f3\u30c6\u30ca\u306f\u505c\u6b62\u3057\u3066\u3057\u307e\u3046\u3002\n\n\u3053\u307e\u3063\u305f\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u30fc\u3002\n\n\u5168\u7136\u56f0\u3089\u306a\u304b\u3063\u305f\u3002\n\npm2\u306b `--no-daemon` \u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u8ffd\u52a0\u3055\u308c\u3066\u3044\u305f\u306e\u3067\u3001\u305d\u308c\u3067OK\u3067\u3057\u305f\u3002\n\nhttps://github.com/Unitech/pm2/issues/259\n\n## Dockerfile\u3084\u3089\u4f55\u3084\u3089\n\n**Dockerfile**\n\n```docker\nFROM node\n\nWORKDIR /nodeapp\n\nADD package.json /nodeapp/\nADD index.js /nodeapp/\n\nRUN npm install\n\nEXPOSE  1337\n\nCMD [\"node_modules/pm2/bin/pm2\", \"--no-daemon\", \"start\", \"index.js\"]\n```\n\n**package.json**\n\n```json\n{\n  \"name\": \"docker-pm2\",\n  \"version\": \"0.0.1\",\n  \"description\": \"Docker pm2 example\",\n  \"main\": \"index.js\",\n  \"author\": \"5t111111\",\n  \"dependencies\": {\n    \"pm2\": \"latest\"\n  }\n}\n```\n\n**index.js**\n\n```javascript\nvar http = require('http');\nhttp.createServer(function (req, res) {\n  res.writeHead(200, {'Content-Type': 'text/plain'});\n  res.end('Hello World\\n');\n}).listen(1337);\n```\n\n## \u8d77\u52d5\n\n```console\n$ docker build .\n```\n\n```console\n$ docker run -P -d <\u30a4\u30e1\u30fc\u30b8ID>\n```\n\n```console\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                     NAMES\nf89174a4ac15        392c405d84f6        node_modules/pm2/bin   48 seconds ago      Up 47 seconds       0.0.0.0:49169->1337/tcp   sad_shockley\n```\n\n```console\n$ curl -i localhost:49169\nHTTP/1.1 200 OK\nContent-Type: text/plain\nDate: Thu, 03 Jul 2014 14:57:45 GMT\nConnection: keep-alive\nTransfer-Encoding: chunked\n\nHello World\n```\n", "tags": ["Linux", "JavaScript", "pm2", "Node", "docker"]}