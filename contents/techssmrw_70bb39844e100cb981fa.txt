{"context": "GAS\u3067wiki\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308bSlack Bot\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\nwiki \u25cb\u25cb\u25cb\n\n\u306b\u3066\u3001Wikipedia\u306e\u60c5\u5831\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\nWikipedia\u306e\u60c5\u5831\u306f\u3001\u4ee5\u4e0b\u306eAPI\u3092\u5229\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\u611f\u8b1d\u3002\nhttp://wikipedia.simpleapi.net/\n\n\u7d44\u307f\u8fbc\u307f\u5229\u7528\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u306a\u308b\u3079\u304f1\u5206\u3042\u305f\u308a30\u30ea\u30af\u30a8\u30b9\u30c8\u4ee5\u4e0b\u3067\u304a\u9858\u3044\u3057\u307e\u3059\n\n\u3068\u306e\u3053\u3068\u3067\u3059\u306e\u3067\u3001\u6ce8\u610f\u3057\u3066\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nhttps://tech.camph.net/slack-bot-with-gas/\nhttp://qiita.com/soundTricker/items/43267609a870fc9c7453\n\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n\u3068\u308a\u3042\u3048\u305a\u30bd\u30fc\u30b9\u3060\u3051\u3042\u3052\u3066\u304a\u304d\u307e\u3059\u3002\n\u4e0a\u8a18\u3092\u307f\u308c\u3070\u3001\u8a2d\u5b9a\u65b9\u6cd5\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nwiki.js\n\nvar OUTGOING_TOKEN       = PropertiesService.getScriptProperties().getProperty('OUTGOING_TOKEN');\nvar BOT_ICON             = PropertiesService.getScriptProperties().getProperty('BOT_ICON');\nvar BOT_NAME             = \"wiki\";\n\nfunction doPost(e) {\n  var token = PropertiesService.getScriptProperties().getProperty('SLACK_ACCESS_TOKEN');\n  if(OUTGOING_TOKEN != e.parameter.token && e.parameter.trigger_word == 'wiki'){\n     return;\n  }    \n\n  var app = SlackApp.create(token);\n  var params = e.parameter.text.match(/^wiki (.*)/);\n\n  if(params == null) return;\n\n  var word = params[1].replace(/(^\\s+)|(\\s+$)/g, \"\");\n\n  var url = \"https://ja.wikipedia.org/wiki/\" + word ;\n  var message = \"\";\n  message += url + \"\\n\";\n  message += getWikiData(word);\n\n  return app.postMessage(e.parameter.channel_id, message , {\n    username: BOT_NAME,\n    icon_url: BOT_ICON\n  });\n}\n\nfunction getWikiData(keyword) {\n    var url = \"http://wikipedia.simpleapi.net/api?keyword=\"+ keyword +\"&output=json\";\n\n    // JSON\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n    var json = UrlFetchApp.fetch(url).getContentText();\n    var jsonData = JSON.parse(json);\n\n  if(jsonData == null){\n    return \"\u5b58\u5728\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\";\n  }else if(jsonData[0] == null){\n    return \"\u5b58\u5728\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\";\n  }else if(jsonData[0][\"body\"] == null){\n    return \"\u5b58\u5728\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\";\n  }else{\n    return jsonData[0][\"body\"];\n  }\n\n}\n\n\n\n\n\n\nGAS\u3067wiki\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308bSlack Bot\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\n> wiki \u25cb\u25cb\u25cb\n\n\u306b\u3066\u3001Wikipedia\u306e\u60c5\u5831\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n<img width=\"756\" alt=\"Slack_wiki.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/160390/d2af295f-6720-54d0-fa77-5bc60d314cd7.png\">\n\n\nWikipedia\u306e\u60c5\u5831\u306f\u3001\u4ee5\u4e0b\u306eAPI\u3092\u5229\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\u611f\u8b1d\u3002\nhttp://wikipedia.simpleapi.net/\n\n> \u7d44\u307f\u8fbc\u307f\u5229\u7528\u306b\u3042\u305f\u3063\u3066\u306f\u3001\u306a\u308b\u3079\u304f1\u5206\u3042\u305f\u308a30\u30ea\u30af\u30a8\u30b9\u30c8\u4ee5\u4e0b\u3067\u304a\u9858\u3044\u3057\u307e\u3059\n\n\u3068\u306e\u3053\u3068\u3067\u3059\u306e\u3067\u3001\u6ce8\u610f\u3057\u3066\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nhttps://tech.camph.net/slack-bot-with-gas/\nhttp://qiita.com/soundTricker/items/43267609a870fc9c7453\n\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\u3002\n\n\u3068\u308a\u3042\u3048\u305a\u30bd\u30fc\u30b9\u3060\u3051\u3042\u3052\u3066\u304a\u304d\u307e\u3059\u3002\n\u4e0a\u8a18\u3092\u307f\u308c\u3070\u3001\u8a2d\u5b9a\u65b9\u6cd5\u304c\u308f\u304b\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n```javascript:wiki.js\n\nvar OUTGOING_TOKEN       = PropertiesService.getScriptProperties().getProperty('OUTGOING_TOKEN');\nvar BOT_ICON             = PropertiesService.getScriptProperties().getProperty('BOT_ICON');\nvar BOT_NAME             = \"wiki\";\n\nfunction doPost(e) {\n  var token = PropertiesService.getScriptProperties().getProperty('SLACK_ACCESS_TOKEN');\n  if(OUTGOING_TOKEN != e.parameter.token && e.parameter.trigger_word == 'wiki'){\n     return;\n  }    \n  \n  var app = SlackApp.create(token);\n  var params = e.parameter.text.match(/^wiki (.*)/);\n  \n  if(params == null) return;\n  \n  var word = params[1].replace(/(^\\s+)|(\\s+$)/g, \"\");\n  \n  var url = \"https://ja.wikipedia.org/wiki/\" + word ;\n  var message = \"\";\n  message += url + \"\\n\";\n  message += getWikiData(word);\n\n  return app.postMessage(e.parameter.channel_id, message , {\n    username: BOT_NAME,\n    icon_url: BOT_ICON\n  });\n}\n\nfunction getWikiData(keyword) {\n    var url = \"http://wikipedia.simpleapi.net/api?keyword=\"+ keyword +\"&output=json\";\n\n    // JSON\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n    var json = UrlFetchApp.fetch(url).getContentText();\n    var jsonData = JSON.parse(json);\n\n  if(jsonData == null){\n    return \"\u5b58\u5728\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\";\n  }else if(jsonData[0] == null){\n    return \"\u5b58\u5728\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\";\n  }else if(jsonData[0][\"body\"] == null){\n    return \"\u5b58\u5728\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\";\n  }else{\n    return jsonData[0][\"body\"];\n  }\n  \n}\n\n\n\n\n```\n\n\n", "tags": ["gas", "Slack", "bot", "api"]}