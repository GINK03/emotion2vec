{"context": " More than 1 year has passed since last update.\n\n\u7d50\u8ad6\n\u3068\u308c\u306a\u304b\u3063\u305f\u3067\u3059\uff082015\u5e742\u670823\u65e5\u73fe\u5728 poltergeist 1.6.0\uff09\n\u3053\u3046\u3059\u308c\u3070\u3068\u308c\u308b\u3088\u306a\u3069\u3042\u308a\u307e\u3057\u305f\u3089\u30b3\u30e1\u30f3\u30c8\u3044\u305f\u3060\u3051\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3001\u3001\n\n\u8a66\u3057\u305f\u3053\u3068\n\npoltergesit\u306esession\u306breferer\u3092\u8ffd\u52a0\u3057\u3066\u307f\u308b\nUserAgent\npage.driver.headers = { referer: 'http://www.google.co.jp/' }\npage.driver.headers\n=> {:referer=>\"http://www.google.co.jp/\"}\n\nvisit root_path\nevaluate_script('document.referrer')\n=> \"\"\n\n\u3068\u308c\u306a\u3044\u2026\u3002\n\nJS\u3067 referrer\u3092\u66f8\u304d\u63db\u3048\u3066\u307f\u305f\nevaluate_script(\"window.document.__defineGetter__('referrer', function () { return http://www.google.co.jp/'; });\")\nevaluate_script('document.referrer')\n=> \"\"\n\nevaluate_script('Object.defineProperty(document, \"referrer\", {get : function(){ return \"http://www.google.co.jp/\"; });')\nevaluate_script('document.referrer')\n=> \"\"\n\n\u3068\u308c\u306a\u3044\u2026\u3002\n\u53c2\u8003URL\uff1aTry to overwrite window.document.referrer from within phantomjs / onInitialized\n\ncookie\u3082UA\u3082\u3068\u308c\u308b\u306e\u306b\u2026\npage.driver.set_cookie('hoge', 'fuga')\nevaluate_script('document.cookie')\n\nUserAgent\u3082header\u306b\u8ffd\u52a0\u3059\u308c\u3070\u6b63\u3057\u304f\u3068\u308c\u308b\u2026\nevaluate_script('window.navigator.userAgent')\n=> \"Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A403 Safari/8536.25\"\n\n(\u00b4\uff1b\u03c9\uff1b\uff40)\uff73\uff6f\u2026\n\n# \u7d50\u8ad6\n\u3068\u308c\u306a\u304b\u3063\u305f\u3067\u3059\uff082015\u5e742\u670823\u65e5\u73fe\u5728 poltergeist 1.6.0\uff09\n\n\u3053\u3046\u3059\u308c\u3070\u3068\u308c\u308b\u3088\u306a\u3069\u3042\u308a\u307e\u3057\u305f\u3089\u30b3\u30e1\u30f3\u30c8\u3044\u305f\u3060\u3051\u308b\u3068\u5b09\u3057\u3044\u3067\u3059\u3001\u3001\n\n# \u8a66\u3057\u305f\u3053\u3068\n\n## poltergesit\u306esession\u306breferer\u3092\u8ffd\u52a0\u3057\u3066\u307f\u308b\nUserAgent\n\n```\npage.driver.headers = { referer: 'http://www.google.co.jp/' }\npage.driver.headers\n=> {:referer=>\"http://www.google.co.jp/\"}\n```\n\n```\nvisit root_path\nevaluate_script('document.referrer')\n=> \"\"\n```\n\n\u3068\u308c\u306a\u3044\u2026\u3002\n\n## JS\u3067 referrer\u3092\u66f8\u304d\u63db\u3048\u3066\u307f\u305f\n\n```\nevaluate_script(\"window.document.__defineGetter__('referrer', function () { return http://www.google.co.jp/'; });\")\nevaluate_script('document.referrer')\n=> \"\"\n```\n\n```\nevaluate_script('Object.defineProperty(document, \"referrer\", {get : function(){ return \"http://www.google.co.jp/\"; });')\nevaluate_script('document.referrer')\n=> \"\"\n```\n\n\u3068\u308c\u306a\u3044\u2026\u3002\n\n\u53c2\u8003URL\uff1a[Try to overwrite window.document.referrer from within phantomjs / onInitialized](https://gist.github.com/papoms/3481673)\n\n## cookie\u3082UA\u3082\u3068\u308c\u308b\u306e\u306b\u2026\n\n```\npage.driver.set_cookie('hoge', 'fuga')\nevaluate_script('document.cookie')\n```\n\nUserAgent\u3082header\u306b\u8ffd\u52a0\u3059\u308c\u3070\u6b63\u3057\u304f\u3068\u308c\u308b\u2026\n\n```\nevaluate_script('window.navigator.userAgent')\n=> \"Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A403 Safari/8536.25\"\n```\n\n\n(\u00b4\uff1b\u03c9\uff1b\uff40)\uff73\uff6f\u2026\n", "tags": ["Capybara", "poltergeist", "RSpec"]}