{"context": "Google Maps API\u306b\u306fDirectionsService\u3068\u3044\u3046\u30eb\u30fc\u30c8\u691c\u7d22\u7528\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u3066\u3001\u51fa\u767a\u5730\u3068\u76ee\u7684\u5730\u3092\u6307\u5b9a\u3057\u3066\u30eb\u30fc\u30c8\u691c\u7d22\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3053\u306e\u6587\u66f8\u3067\u306f\u3001\u9014\u4e2d\u306e\u7d4c\u7531\u5730\u70b9(\u4e2d\u7d99\u5730\u70b9)\u3092\u6307\u5b9a\u3057\u3066\u30eb\u30fc\u30c8\u691c\u7d22\u3059\u308b\u7c21\u5358\u306a\u65b9\u6cd5\u3068\u3001\u305f\u304f\u3055\u3093\u306e\u7d4c\u7531\u5730\u70b9\u304c\u5fc5\u8981\u306a\u5834\u5408\u306e\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\u7c21\u5358\u306a\u65b9\u6cd5 (\u7d4c\u7531\u5730\u70b9\u306e\u6570\u304c8\u4ee5\u4e0b\u306e\u5834\u5408)\nDirectionsService\u306e\u30eb\u30fc\u30c8\u691c\u7d22\u3067\u306f\u3001\u9014\u4e2d\u306e\u7d4c\u7531\u5730\u70b9(\u4e2d\u7d99\u5730\u70b9)\u3092\u300cwaypoints\u300d\u3068\u3057\u3066\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n(\u4e0b\u8a18\u3067\u306f\u51fa\u767a\u5730(origin), \u76ee\u7684\u5730(destination), \u7d4c\u7531\u5730\u70b9(waypoints)\u3068\u3082\u7def\u5ea6\u7d4c\u5ea6(LatLng)\u3067\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u300c\u6771\u4eac\u99c5\u300d\u306a\u3069\u306e\u6587\u5b57\u5217\u3067\u3082\u6307\u5b9a\u3067\u304d\u307e\u3059)\n<!DOCTYPE html>\n<html>\n<head><style>html, body, #map { width: 100%; height: 100%; }</style></head>\n<body>\n<div id=\"map\"></div>\n\n<script>\nfunction initMap() {\n    // \u30eb\u30fc\u30c8\u691c\u7d22\u306e\u6761\u4ef6\n    var request = {\n        origin: new google.maps.LatLng(35.681382,139.766084), // \u51fa\u767a\u5730\n        destination: new google.maps.LatLng(34.73348,135.500109), // \u76ee\u7684\u5730\n        waypoints: [ // \u7d4c\u7531\u5730\u70b9(\u6307\u5b9a\u306a\u3057\u3067\u3082\u53ef)\n            { location: new google.maps.LatLng(35.630152,139.74044) },\n            { location: new google.maps.LatLng(35.507456,139.617585) },\n            { location: new google.maps.LatLng(35.25642,139.154904) },\n            { location: new google.maps.LatLng(35.103217,139.07776) },\n            { location: new google.maps.LatLng(35.127152,138.910627) },\n            { location: new google.maps.LatLng(35.142365,138.663199) },\n            { location: new google.maps.LatLng(34.97171,138.38884) },\n            { location: new google.maps.LatLng(34.769758,138.014928) },\n        ],\n        travelMode: google.maps.DirectionsTravelMode.WALKING, // \u4ea4\u901a\u624b\u6bb5(\u6b69\u884c\u3002DRIVING\u306e\u5834\u5408\u306f\u8eca)\n    };\n\n    // \u30de\u30c3\u30d7\u306e\u751f\u6210\n    var map = new google.maps.Map(document.getElementById(\"map\"), {\n        center: new google.maps.LatLng(35.681382,139.766084), // \u30de\u30c3\u30d7\u306e\u4e2d\u5fc3\n        zoom: 7 // \u30ba\u30fc\u30e0\u30ec\u30d9\u30eb\n    });\n\n    var d = new google.maps.DirectionsService(); // \u30eb\u30fc\u30c8\u691c\u7d22\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    var r = new google.maps.DirectionsRenderer({ // \u30eb\u30fc\u30c8\u63cf\u753b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n        map: map, // \u63cf\u753b\u5148\u306e\u5730\u56f3\n        preserveViewport: true, // \u63cf\u753b\u5f8c\u306b\u4e2d\u5fc3\u70b9\u3092\u305a\u3089\u3055\u306a\u3044\n    });\n    // \u30eb\u30fc\u30c8\u691c\u7d22\n    d.route(request, function(result, status){\n        // OK\u306e\u5834\u5408\u30eb\u30fc\u30c8\u63cf\u753b\n        if (status == google.maps.DirectionsStatus.OK) {\n            r.setDirections(result);\n        }\n    });\n}\n</script>\n<script src=\"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap\" async defer></script>\n</body>\n</html>\n\n\u203b YOUR_API_KEY \u306e\u90e8\u5206\u306f Google\u306eAPI\u30ad\u30fc\u3092\u53d6\u5f97\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n\u7d4c\u7531\u5730\u70b9\u306e\u6570\u304c8\u3088\u308a\u591a\u3044\u5834\u5408\n\u4e0a\u8a18\u306e\u65b9\u6cd5\u306f\u7c21\u5358\u3067\u3059\u304c\u3001\u300c\u30a6\u30a9\u30fc\u30ad\u30f3\u30b0\u30de\u30c3\u30d7\u3092\u4f5c\u308a\u305f\u3044\u300d\u306a\u3069\u3068\u601d\u3063\u305f\u3068\u304d\u306b\u7d4c\u7531\u5730\u70b9\u304c8\u5730\u70b9\u3088\u308a\u591a\u304f\u306a\u308b\u5834\u5408\u3060\u3068\u4e0a\u8a18\u306e\u65b9\u6cd5\u3067\u306f\u300cToo many waypoints in the request (\u5730\u70b9\u6570). The maximum allowed waypoints for this request is 8, plus the origin, and destination.\u300d(\u691c\u7d22\u6761\u4ef6\u306b\u7d4c\u7531\u5730\u70b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u691c\u7d22\u6761\u4ef6\u306b\u8a31\u53ef\u3055\u308c\u308b\u7d4c\u7531\u5730\u70b9\u306e\u6700\u5927\u6570\u306f8\u3064 + \u51fa\u767a\u5730\u3068\u76ee\u7684\u5730\u3067\u3059)\u3068\u3044\u3046\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u7d4c\u7531\u5730\u70b9\u304c8\u3064\u3088\u308a\u591a\u3044\u5834\u5408\u306f\u3001\u300c\u5730\u70b9\u3092\u51fa\u767a\u5730 + \u7d4c\u7531\u5730\u70b98\u3064 + \u51fa\u767a\u5730\u306e\u6700\u592710\u3067\u533a\u5207\u3063\u3066\u691c\u7d22\u3057\u3066\u304b\u3089\u6700\u5f8c\u306b\u307e\u3068\u3081\u308b\u300d\u3053\u3068\u3067\u56de\u907f\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n<!DOCTYPE html>\n<html>\n<head><style>html, body, #map { width: 100%; height: 100%; }</style></head>\n<body>\n<div id=\"map\"></div>\n\n<script>\nfunction initMap() {\n    // \u305f\u304f\u3055\u3093\u306e\u5730\u70b9...\n    var points = [\n        new google.maps.LatLng(35.681382,139.766084),\n        new google.maps.LatLng(35.630152,139.74044),\n        new google.maps.LatLng(35.507456,139.617585),\n        new google.maps.LatLng(35.25642,139.154904),\n        new google.maps.LatLng(35.103217,139.07776),\n        new google.maps.LatLng(35.127152,138.910627),\n        new google.maps.LatLng(35.142365,138.663199),\n        new google.maps.LatLng(34.97171,138.38884),\n        new google.maps.LatLng(34.769758,138.014928),\n        new google.maps.LatLng(34.703741,137.734442),\n        new google.maps.LatLng(34.762811,137.381651),\n        new google.maps.LatLng(34.96897,137.060662),\n        new google.maps.LatLng(35.170694,136.881637),\n        new google.maps.LatLng(35.315705,136.685593),\n        new google.maps.LatLng(35.314188,136.290488),\n        new google.maps.LatLng(34.985458,135.757755),\n        new google.maps.LatLng(34.73348,135.500109),\n    ];\n\n    // \u30de\u30c3\u30d7\u306e\u751f\u6210\n    var map = new google.maps.Map(document.getElementById(\"map\"), {\n        center: new google.maps.LatLng(35.681298, 139.766247), // \u30de\u30c3\u30d7\u306e\u4e2d\u5fc3\n        zoom: 7 // \u30ba\u30fc\u30e0\u30ec\u30d9\u30eb\n    });\n\n    // \u5730\u70b9\u3092\u5206\u5272\u3057\u3066\u30eb\u30fc\u30c8\u691c\u7d22\u3092\u884c\u3044\u307e\u3059\u3002\n\n    var d = new google.maps.DirectionsService(); // \u30eb\u30fc\u30c8\u691c\u7d22\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    var origin = null, waypoints = [], dest = null; // \u51fa\u767a\u5730\u3001\u7d4c\u7531\u5730\u3001\u76ee\u7684\u5730\n    var resultMap = {}; // \u5206\u5272\u3057\u3066\u30eb\u30fc\u30c8\u691c\u7d22\u3057\u305f\u7d50\u679c\u30c7\u30fc\u30bf\n    var requestIndex = 0; // \u691c\u7d22\u756a\u53f7\n    var done = 0; // \u30eb\u30fc\u30c8\u691c\u7d22\u304c\u5b8c\u4e86\u3057\u305f\u6570\n    for (var i = 0, len = points.length; i < len; i++) {\n        // \u6700\u521d\u306e\u5834\u5408\u3001origin\u306b\u5024\u3092\u30bb\u30c3\u30c8\n        if (origin == null) {\n            origin = points[i];\n        }\n        // \u7d4c\u7531\u5730\u304c8\u3064\u305f\u307e\u3063\u305f\u304b\u6700\u5f8c\u306e\u5730\u70b9\u306e\u5834\u5408\u3001\u30eb\u30fc\u30c8\u691c\u7d22\n        else if (waypoints.length == 8 || i == len - 1) {\n            dest = points[i];\n\n            (function(index){\n                // \u30eb\u30fc\u30c8\u691c\u7d22\u306e\u6761\u4ef6\n                var request = {\n                    origin: origin, // \u51fa\u767a\u5730\n                    destination: dest, // \u76ee\u7684\u5730\n                    waypoints: waypoints, // \u7d4c\u7531\u5730\n                    travelMode: google.maps.DirectionsTravelMode.WALKING, // \u4ea4\u901a\u624b\u6bb5(\u6b69\u884c\u3002DRIVING\u306e\u5834\u5408\u306f\u8eca)\n                };\n                console.log(request);\n                // \u30eb\u30fc\u30c8\u691c\u7d22\n                d.route(request, function(result, status){\n                    // OK\u306e\u5834\u5408\u30eb\u30fc\u30c8\u30c7\u30fc\u30bf\u4fdd\u6301\n                    if (status == google.maps.DirectionsStatus.OK) {\n                        resultMap[index] = result; // \u4e26\u884c\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\u306e\u3067\u914d\u5217\u3060\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u9806\u3068\u305a\u308c\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\n                        done++;\n                    }\n                    else {\n                        console.log(status); // \u30c7\u30d0\u30c3\u30b0\n                    }\n                });\n            })(requestIndex);\n\n            requestIndex++;\n            origin = points[i]; // \u4eca\u56de\u306e\u76ee\u7684\u5730\u3092\u6b21\u56de\u306e\u51fa\u767a\u5730\u306b\u3057\u307e\u3059\u3002\n            waypoints = [];\n        }\n        // \u4e0a\u8a18\u4ee5\u5916\u3001waypoints\u306b\u5730\u70b9\u3092\u8ffd\u52a0\n        else {\n            waypoints.push({ location: points[i], stopover: true });\n        }\n    }\n\n    // \u30de\u30fc\u30ab\u30fc\u3092\u8868\u793a\u3059\u308b\u5834\u5408\u306e\u6e96\u5099\n    var infoWindow = new google.maps.InfoWindow();\n    var mark = function(position, content) {\n        var marker = new google.maps.Marker({\n            map: map, // \u63cf\u753b\u5148\u306e\u5730\u56f3\n            position: position // \u5ea7\u6a19\n        });\n        // \u30af\u30ea\u30c3\u30af\u6642\u5439\u304d\u51fa\u3057\u3092\u8868\u793a\n        marker.addListener(\"click\", function(){\n            infoWindow.setContent(content);\n            infoWindow.open(map, marker);\n        });\n    };\n\n    var sid = setInterval(function(){\n        // \u5206\u5272\u3057\u305f\u3059\u3079\u3066\u306e\u691c\u7d22\u304c\u5b8c\u4e86\u3059\u308b\u307e\u3067\u5f85\u3061\u307e\u3059\u3002\n        if (requestIndex > done) return;\n        clearInterval(sid);\n\n        // \u3059\u3079\u3066\u306e\u7d50\u679c\u306e\u30eb\u30fc\u30c8\u5ea7\u6a19\u3092\u9806\u756a\u306b\u53d6\u5f97\u3057\u3066\u5e73\u5766\u306a\u914d\u5217\u306b\u3057\u307e\u3059\u3002\n        var path = [];\n        var result;\n        for (var i = 0, len = requestIndex; i < len; i++) {\n            result = resultMap[i]; // \u691c\u7d22\u7d50\u679c\n            var legs = result.routes[0].legs; // Array<DirectionsLeg>\n            for (var li = 0, llen = legs.length; li < llen; li++) {\n                var leg = legs[li]; // DirectionLeg\n                var steps = leg.steps; // Array<DirectionsStep>\n                // DirectionsStep\u304c\u6301\u3063\u3066\u3044\u308bpath\u3092\u53d6\u5f97\u3057\u3066\u5e73\u5766(2\u6b21\u5143\u914d\u5217\u21921\u6b21\u5143\u914d\u5217)\u306b\u3057\u307e\u3059\u3002\n                var _path = steps.map(function(step){ return step.path })\n                    .reduce(function(all, paths){ return all.concat(paths) });\n                path = path.concat(_path);\n\n                // \u30de\u30fc\u30ab\u30fc\u304c\u5fc5\u8981\u306a\u3089\u30de\u30fc\u30ab\u30fc\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n                mark(leg.start_location, leg.start_address);\n            }\n        }\n        // \u30de\u30fc\u30ab\u30fc\u304c\u5fc5\u8981\u306a\u3089\u30de\u30fc\u30ab\u30fc\u3092\u8868\u793a\u3057\u307e\u3059\u3002(\u6700\u7d42)\n        var endLeg = result.routes[0].legs[result.routes[0].legs.length-1];\n        mark(endLeg.end_location, endLeg.end_address);\n\n        // \u30d1\u30b9\u3092\u63cf\u753b\u3057\u307e\u3059\u3002\n        var line = new google.maps.Polyline({\n            map: map, // \u63cf\u753b\u5148\u306e\u5730\u56f3\n            strokeColor: \"#2196f3\", // \u7dda\u306e\u8272\n            strokeOpacity: 0.8, // \u7dda\u306e\u4e0d\u900f\u660e\u5ea6\n            strokeWeight: 6, // \u5148\u306e\u592a\u3055\n            path: path // \u63cf\u753b\u3059\u308b\u30d1\u30b9\u30c7\u30fc\u30bf\n        });\n    }, 1000);\n}\n</script>\n<script src=\"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap\" async defer></script>\n</body>\n</html>\n\n\n\u203b YOUR_API_KEY \u306e\u90e8\u5206\u306f Google\u306eAPI\u30ad\u30fc\u3092\u53d6\u5f97\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u203b \u3053\u306e\u65b9\u6cd5\u3067\u3082\u7121\u5236\u9650\u306b\u691c\u7d22\u3067\u304d\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u3001Google Maps API\u306eDirectionsService\u3067\u306f\u4e00\u6c17\u306b\u691c\u7d22\u3067\u304d\u308b\u306e\u304c10\u56de\u307e\u3067\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u691c\u7d22\u53ef\u80fd\u306a\u6700\u5927\u5730\u70b9\u6570\u306f\u51fa\u767a\u5730\u3068\u76ee\u7684\u5730\u3092\u542b\u3081\u306691\u5730\u70b9\u307e\u3067\u306b\u306a\u308a\u307e\u3059\u3002(10\u5730\u70b9\u5206\u691c\u7d22\u3057\u305f\u5f8c\u3001\u6700\u5f8c\u306e10\u5730\u70b9\u76ee\u3092\u6b21\u306e\u691c\u7d22\u306e\u51fa\u767a\u5730\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067 10 + 9 \u00d7 9 = 91\u306b\u306a\u308b)\n\u203b \u3053\u306e\u65b9\u6cd5\u3067\u306fDirectionsRenderer\u304c\u4f7f\u3048\u306a\u304f\u306a\u308b\u306e\u3067\u3001\u81ea\u529b\u3067\u30d1\u30b9\u63cf\u753b\u3084\u30de\u30fc\u30ab\u30fc\u306e\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002(1\u3064\u306e\u7d50\u679c\u3057\u304bDirectionsRenderer\u306b\u30bb\u30c3\u30c8\u3067\u304d\u306a\u3044\u305f\u3081\u3002\u305f\u3060\u3001DirectionsRenderer\u306f\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u308b\u90e8\u5206\u304c\u3042\u307e\u308a\u591a\u304f\u306a\u3044\u306e\u3067\u3001\u72ec\u81ea\u3067\u51e6\u7406\u3092\u4f5c\u6210\u3057\u305f\u307b\u3046\u304c\u878d\u901a\u304c\u304d\u304d\u3084\u3059\u3044\u3067\u3059)\n\n\u51fa\u767a\u5730\u3001\u7d4c\u7531\u5730\u70b9\u3001\u76ee\u7684\u5730\u306e\u5408\u8a08\u304c91\u3088\u308a\u591a\u3044\u5834\u5408\n\u300c91\u3067\u306f\u8db3\u308a\u306a\u3044\u300d\u3068\u3044\u3046\u30b1\u30fc\u30b9\u306f\u3042\u307e\u308a\u7121\u3044\u6c17\u304c\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u306b\u306a\u3063\u305f\u3068\u304d\u306f\u300c\u300c\u7d4c\u7531\u5730\u70b9\u306e\u6570\u304c8\u3088\u308a\u591a\u3044\u5834\u5408\u300d\u306e\u30b3\u30fc\u30c9\u5185\u306b\u3001DirectionsService\u304c\u8fd4\u3057\u3066\u304d\u305f\u7d50\u679c\u3092JSON\u5f62\u5f0f\u3067\u4fdd\u5b58\u3059\u308b\u30b3\u30fc\u30c9\u3092\u30c7\u30d0\u30c3\u30b0\u3067\u631f\u3093\u3067\u304a\u3044\u3066\u3001\u4fdd\u5b58\u3067\u304d\u305f\u3089\u305d\u308c\u4ee5\u964d\u306f\u4fdd\u5b58\u3057\u305f\u30c7\u30fc\u30bf\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3068\u3057\u3066\u4f7f\u3046\u300d\u3068\u3044\u3046\u5f62\u304c\u3068\u308c\u307e\u3059\u3002(\u300c\u3068\u308c\u307e\u3059\u300d\u3068\u3044\u3063\u3066\u3082\u300c\u3068\u308c\u306a\u304f\u3082\u306a\u3044\u300d\u3068\u3044\u3046\u30ec\u30d9\u30eb\u3067\u3001\u3060\u3044\u3076\u7121\u7406\u77e2\u7406\u306a\u90e8\u985e\u3067\u3059)\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u304c\u66f8\u304d\u3065\u3089\u3044\u306e\u3067\u3059\u304c\u3001DirectionsService\u306eroute()\u3067\u8fd4\u3063\u3066\u304d\u305f\u7d50\u679c\u3092\u300cHow to save the output of a console.log(object) to a file? - StackOverflow\u300d\u306e\u56de\u7b54(console.save())\u3088\u3046\u306a\u5f62\u3067JSON\u3067\u4fdd\u5b58\u3057\u3066\u3001\u4fdd\u5b58\u3057\u305f\u7d50\u679c\u30c7\u30fc\u30bf\u3092Ajax\u3067\u53d6\u5f97\u3057\u3066\u30eb\u30fc\u30c8\u63cf\u753b\u3059\u308b\u3088\u3046\u306a\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\n\u203b \u7d50\u679c (DirectionsResult) \u306e\u30c7\u30fc\u30bf\u306f\u5de8\u5927\u306a\u306e\u3067\u3001path\u3060\u3051\u629c\u304d\u51fa\u3059\u306a\u3069\u5de5\u592b\u3057\u305f\u307b\u3046\u304c\u3088\u3044\u3067\u3059\u3002\n\u3053\u308c\u3060\u3068\u6700\u7d42\u7684\u306b\u300cGoogle Maps API\u7121\u511f\u7248\u306e\u30dd\u30ea\u30b7\u30fc\u5909\u66f4\u300d \u306e\u3088\u3046\u306a\u7121\u511f\u7248\u30a2\u30ab\u30a6\u30f3\u30c8\u306eDirections API\u30ea\u30af\u30a8\u30b9\u30c8\u56de\u6570\u4e0a\u9650(1\u65e52500\u56de)\u3082\u5c11\u3057\u56de\u907f\u3067\u304d\u307e\u3059\u304c\u3001\u3053\u3053\u307e\u3067\u3084\u308b\u306e\u3067\u3042\u308c\u3070\u7d20\u76f4\u306b\u6709\u511f\u306b\u3059\u308b\u304b\u4ee3\u66ff\u30b5\u30fc\u30d3\u30b9\u3092\u691c\u8a0e\u3057\u305f\u307b\u3046\u304c\u3088\u3044\u6c17\u304c\u3057\u307e\u3059\u3002\nGoogle Maps API\u306b\u306fDirectionsService\u3068\u3044\u3046\u30eb\u30fc\u30c8\u691c\u7d22\u7528\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u3066\u3001\u51fa\u767a\u5730\u3068\u76ee\u7684\u5730\u3092\u6307\u5b9a\u3057\u3066\u30eb\u30fc\u30c8\u691c\u7d22\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3053\u306e\u6587\u66f8\u3067\u306f\u3001\u9014\u4e2d\u306e\u7d4c\u7531\u5730\u70b9(\u4e2d\u7d99\u5730\u70b9)\u3092\u6307\u5b9a\u3057\u3066\u30eb\u30fc\u30c8\u691c\u7d22\u3059\u308b\u7c21\u5358\u306a\u65b9\u6cd5\u3068\u3001\u305f\u304f\u3055\u3093\u306e\u7d4c\u7531\u5730\u70b9\u304c\u5fc5\u8981\u306a\u5834\u5408\u306e\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u307e\u3059\u3002\n\n\n## \u7c21\u5358\u306a\u65b9\u6cd5 (\u7d4c\u7531\u5730\u70b9\u306e\u6570\u304c8\u4ee5\u4e0b\u306e\u5834\u5408)\n\nDirectionsService\u306e\u30eb\u30fc\u30c8\u691c\u7d22\u3067\u306f\u3001\u9014\u4e2d\u306e\u7d4c\u7531\u5730\u70b9(\u4e2d\u7d99\u5730\u70b9)\u3092\u300cwaypoints\u300d\u3068\u3057\u3066\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n(\u4e0b\u8a18\u3067\u306f\u51fa\u767a\u5730(origin), \u76ee\u7684\u5730(destination), \u7d4c\u7531\u5730\u70b9(waypoints)\u3068\u3082\u7def\u5ea6\u7d4c\u5ea6(LatLng)\u3067\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u300c\u6771\u4eac\u99c5\u300d\u306a\u3069\u306e\u6587\u5b57\u5217\u3067\u3082\u6307\u5b9a\u3067\u304d\u307e\u3059)\n\n```html\n<!DOCTYPE html>\n<html>\n<head><style>html, body, #map { width: 100%; height: 100%; }</style></head>\n<body>\n<div id=\"map\"></div>\n\n<script>\nfunction initMap() {\n    // \u30eb\u30fc\u30c8\u691c\u7d22\u306e\u6761\u4ef6\n    var request = {\n        origin: new google.maps.LatLng(35.681382,139.766084), // \u51fa\u767a\u5730\n        destination: new google.maps.LatLng(34.73348,135.500109), // \u76ee\u7684\u5730\n        waypoints: [ // \u7d4c\u7531\u5730\u70b9(\u6307\u5b9a\u306a\u3057\u3067\u3082\u53ef)\n            { location: new google.maps.LatLng(35.630152,139.74044) },\n            { location: new google.maps.LatLng(35.507456,139.617585) },\n            { location: new google.maps.LatLng(35.25642,139.154904) },\n            { location: new google.maps.LatLng(35.103217,139.07776) },\n            { location: new google.maps.LatLng(35.127152,138.910627) },\n            { location: new google.maps.LatLng(35.142365,138.663199) },\n            { location: new google.maps.LatLng(34.97171,138.38884) },\n            { location: new google.maps.LatLng(34.769758,138.014928) },\n        ],\n        travelMode: google.maps.DirectionsTravelMode.WALKING, // \u4ea4\u901a\u624b\u6bb5(\u6b69\u884c\u3002DRIVING\u306e\u5834\u5408\u306f\u8eca)\n    };\n\n    // \u30de\u30c3\u30d7\u306e\u751f\u6210\n    var map = new google.maps.Map(document.getElementById(\"map\"), {\n        center: new google.maps.LatLng(35.681382,139.766084), // \u30de\u30c3\u30d7\u306e\u4e2d\u5fc3\n        zoom: 7 // \u30ba\u30fc\u30e0\u30ec\u30d9\u30eb\n    });\n\n    var d = new google.maps.DirectionsService(); // \u30eb\u30fc\u30c8\u691c\u7d22\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    var r = new google.maps.DirectionsRenderer({ // \u30eb\u30fc\u30c8\u63cf\u753b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n        map: map, // \u63cf\u753b\u5148\u306e\u5730\u56f3\n        preserveViewport: true, // \u63cf\u753b\u5f8c\u306b\u4e2d\u5fc3\u70b9\u3092\u305a\u3089\u3055\u306a\u3044\n    });\n    // \u30eb\u30fc\u30c8\u691c\u7d22\n    d.route(request, function(result, status){\n        // OK\u306e\u5834\u5408\u30eb\u30fc\u30c8\u63cf\u753b\n        if (status == google.maps.DirectionsStatus.OK) {\n            r.setDirections(result);\n        }\n    });\n}\n</script>\n<script src=\"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap\" async defer></script>\n</body>\n</html>\n```\n\n\u203b YOUR_API_KEY \u306e\u90e8\u5206\u306f Google\u306eAPI\u30ad\u30fc\u3092\u53d6\u5f97\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n![1.png](https://qiita-image-store.s3.amazonaws.com/0/782/9e7ae03d-648c-5b94-9a86-11c1f1115e16.png)\n\n\n## \u7d4c\u7531\u5730\u70b9\u306e\u6570\u304c8\u3088\u308a\u591a\u3044\u5834\u5408\n\n\u4e0a\u8a18\u306e\u65b9\u6cd5\u306f\u7c21\u5358\u3067\u3059\u304c\u3001\u300c\u30a6\u30a9\u30fc\u30ad\u30f3\u30b0\u30de\u30c3\u30d7\u3092\u4f5c\u308a\u305f\u3044\u300d\u306a\u3069\u3068\u601d\u3063\u305f\u3068\u304d\u306b\u7d4c\u7531\u5730\u70b9\u304c8\u5730\u70b9\u3088\u308a\u591a\u304f\u306a\u308b\u5834\u5408\u3060\u3068\u4e0a\u8a18\u306e\u65b9\u6cd5\u3067\u306f\u300cToo many waypoints in the request (\u5730\u70b9\u6570). The maximum allowed waypoints for this request is 8, plus the origin, and destination.\u300d(\u691c\u7d22\u6761\u4ef6\u306b\u7d4c\u7531\u5730\u70b9\u304c\u591a\u3059\u304e\u307e\u3059\u3002\u691c\u7d22\u6761\u4ef6\u306b\u8a31\u53ef\u3055\u308c\u308b\u7d4c\u7531\u5730\u70b9\u306e\u6700\u5927\u6570\u306f8\u3064 + \u51fa\u767a\u5730\u3068\u76ee\u7684\u5730\u3067\u3059)\u3068\u3044\u3046\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u7d4c\u7531\u5730\u70b9\u304c8\u3064\u3088\u308a\u591a\u3044\u5834\u5408\u306f\u3001\u300c\u5730\u70b9\u3092\u51fa\u767a\u5730 + \u7d4c\u7531\u5730\u70b98\u3064 + \u51fa\u767a\u5730\u306e\u6700\u592710\u3067\u533a\u5207\u3063\u3066\u691c\u7d22\u3057\u3066\u304b\u3089\u6700\u5f8c\u306b\u307e\u3068\u3081\u308b\u300d\u3053\u3068\u3067\u56de\u907f\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```html\n<!DOCTYPE html>\n<html>\n<head><style>html, body, #map { width: 100%; height: 100%; }</style></head>\n<body>\n<div id=\"map\"></div>\n\n<script>\nfunction initMap() {\n    // \u305f\u304f\u3055\u3093\u306e\u5730\u70b9...\n    var points = [\n        new google.maps.LatLng(35.681382,139.766084),\n        new google.maps.LatLng(35.630152,139.74044),\n        new google.maps.LatLng(35.507456,139.617585),\n        new google.maps.LatLng(35.25642,139.154904),\n        new google.maps.LatLng(35.103217,139.07776),\n        new google.maps.LatLng(35.127152,138.910627),\n        new google.maps.LatLng(35.142365,138.663199),\n        new google.maps.LatLng(34.97171,138.38884),\n        new google.maps.LatLng(34.769758,138.014928),\n        new google.maps.LatLng(34.703741,137.734442),\n        new google.maps.LatLng(34.762811,137.381651),\n        new google.maps.LatLng(34.96897,137.060662),\n        new google.maps.LatLng(35.170694,136.881637),\n        new google.maps.LatLng(35.315705,136.685593),\n        new google.maps.LatLng(35.314188,136.290488),\n        new google.maps.LatLng(34.985458,135.757755),\n        new google.maps.LatLng(34.73348,135.500109),\n    ];\n\n    // \u30de\u30c3\u30d7\u306e\u751f\u6210\n    var map = new google.maps.Map(document.getElementById(\"map\"), {\n        center: new google.maps.LatLng(35.681298, 139.766247), // \u30de\u30c3\u30d7\u306e\u4e2d\u5fc3\n        zoom: 7 // \u30ba\u30fc\u30e0\u30ec\u30d9\u30eb\n    });\n\n    // \u5730\u70b9\u3092\u5206\u5272\u3057\u3066\u30eb\u30fc\u30c8\u691c\u7d22\u3092\u884c\u3044\u307e\u3059\u3002\n\n    var d = new google.maps.DirectionsService(); // \u30eb\u30fc\u30c8\u691c\u7d22\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\n    var origin = null, waypoints = [], dest = null; // \u51fa\u767a\u5730\u3001\u7d4c\u7531\u5730\u3001\u76ee\u7684\u5730\n    var resultMap = {}; // \u5206\u5272\u3057\u3066\u30eb\u30fc\u30c8\u691c\u7d22\u3057\u305f\u7d50\u679c\u30c7\u30fc\u30bf\n    var requestIndex = 0; // \u691c\u7d22\u756a\u53f7\n    var done = 0; // \u30eb\u30fc\u30c8\u691c\u7d22\u304c\u5b8c\u4e86\u3057\u305f\u6570\n    for (var i = 0, len = points.length; i < len; i++) {\n        // \u6700\u521d\u306e\u5834\u5408\u3001origin\u306b\u5024\u3092\u30bb\u30c3\u30c8\n        if (origin == null) {\n            origin = points[i];\n        }\n        // \u7d4c\u7531\u5730\u304c8\u3064\u305f\u307e\u3063\u305f\u304b\u6700\u5f8c\u306e\u5730\u70b9\u306e\u5834\u5408\u3001\u30eb\u30fc\u30c8\u691c\u7d22\n        else if (waypoints.length == 8 || i == len - 1) {\n            dest = points[i];\n\n            (function(index){\n                // \u30eb\u30fc\u30c8\u691c\u7d22\u306e\u6761\u4ef6\n                var request = {\n                    origin: origin, // \u51fa\u767a\u5730\n                    destination: dest, // \u76ee\u7684\u5730\n                    waypoints: waypoints, // \u7d4c\u7531\u5730\n                    travelMode: google.maps.DirectionsTravelMode.WALKING, // \u4ea4\u901a\u624b\u6bb5(\u6b69\u884c\u3002DRIVING\u306e\u5834\u5408\u306f\u8eca)\n                };\n                console.log(request);\n                // \u30eb\u30fc\u30c8\u691c\u7d22\n                d.route(request, function(result, status){\n                    // OK\u306e\u5834\u5408\u30eb\u30fc\u30c8\u30c7\u30fc\u30bf\u4fdd\u6301\n                    if (status == google.maps.DirectionsStatus.OK) {\n                        resultMap[index] = result; // \u4e26\u884c\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u3059\u308b\u306e\u3067\u914d\u5217\u3060\u3068\u30ea\u30af\u30a8\u30b9\u30c8\u9806\u3068\u305a\u308c\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\n                        done++;\n                    }\n                    else {\n                        console.log(status); // \u30c7\u30d0\u30c3\u30b0\n                    }\n                });\n            })(requestIndex);\n\n            requestIndex++;\n            origin = points[i]; // \u4eca\u56de\u306e\u76ee\u7684\u5730\u3092\u6b21\u56de\u306e\u51fa\u767a\u5730\u306b\u3057\u307e\u3059\u3002\n            waypoints = [];\n        }\n        // \u4e0a\u8a18\u4ee5\u5916\u3001waypoints\u306b\u5730\u70b9\u3092\u8ffd\u52a0\n        else {\n            waypoints.push({ location: points[i], stopover: true });\n        }\n    }\n\n    // \u30de\u30fc\u30ab\u30fc\u3092\u8868\u793a\u3059\u308b\u5834\u5408\u306e\u6e96\u5099\n    var infoWindow = new google.maps.InfoWindow();\n    var mark = function(position, content) {\n        var marker = new google.maps.Marker({\n            map: map, // \u63cf\u753b\u5148\u306e\u5730\u56f3\n            position: position // \u5ea7\u6a19\n        });\n        // \u30af\u30ea\u30c3\u30af\u6642\u5439\u304d\u51fa\u3057\u3092\u8868\u793a\n        marker.addListener(\"click\", function(){\n            infoWindow.setContent(content);\n            infoWindow.open(map, marker);\n        });\n    };\n\n    var sid = setInterval(function(){\n        // \u5206\u5272\u3057\u305f\u3059\u3079\u3066\u306e\u691c\u7d22\u304c\u5b8c\u4e86\u3059\u308b\u307e\u3067\u5f85\u3061\u307e\u3059\u3002\n        if (requestIndex > done) return;\n        clearInterval(sid);\n\n        // \u3059\u3079\u3066\u306e\u7d50\u679c\u306e\u30eb\u30fc\u30c8\u5ea7\u6a19\u3092\u9806\u756a\u306b\u53d6\u5f97\u3057\u3066\u5e73\u5766\u306a\u914d\u5217\u306b\u3057\u307e\u3059\u3002\n        var path = [];\n        var result;\n        for (var i = 0, len = requestIndex; i < len; i++) {\n            result = resultMap[i]; // \u691c\u7d22\u7d50\u679c\n            var legs = result.routes[0].legs; // Array<DirectionsLeg>\n            for (var li = 0, llen = legs.length; li < llen; li++) {\n                var leg = legs[li]; // DirectionLeg\n                var steps = leg.steps; // Array<DirectionsStep>\n                // DirectionsStep\u304c\u6301\u3063\u3066\u3044\u308bpath\u3092\u53d6\u5f97\u3057\u3066\u5e73\u5766(2\u6b21\u5143\u914d\u5217\u21921\u6b21\u5143\u914d\u5217)\u306b\u3057\u307e\u3059\u3002\n                var _path = steps.map(function(step){ return step.path })\n                    .reduce(function(all, paths){ return all.concat(paths) });\n                path = path.concat(_path);\n\n                // \u30de\u30fc\u30ab\u30fc\u304c\u5fc5\u8981\u306a\u3089\u30de\u30fc\u30ab\u30fc\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n                mark(leg.start_location, leg.start_address);\n            }\n        }\n        // \u30de\u30fc\u30ab\u30fc\u304c\u5fc5\u8981\u306a\u3089\u30de\u30fc\u30ab\u30fc\u3092\u8868\u793a\u3057\u307e\u3059\u3002(\u6700\u7d42)\n        var endLeg = result.routes[0].legs[result.routes[0].legs.length-1];\n        mark(endLeg.end_location, endLeg.end_address);\n\n        // \u30d1\u30b9\u3092\u63cf\u753b\u3057\u307e\u3059\u3002\n        var line = new google.maps.Polyline({\n            map: map, // \u63cf\u753b\u5148\u306e\u5730\u56f3\n            strokeColor: \"#2196f3\", // \u7dda\u306e\u8272\n            strokeOpacity: 0.8, // \u7dda\u306e\u4e0d\u900f\u660e\u5ea6\n            strokeWeight: 6, // \u5148\u306e\u592a\u3055\n            path: path // \u63cf\u753b\u3059\u308b\u30d1\u30b9\u30c7\u30fc\u30bf\n        });\n    }, 1000);\n}\n</script>\n<script src=\"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap\" async defer></script>\n</body>\n</html>\n```\n\n![2.png](https://qiita-image-store.s3.amazonaws.com/0/782/4bd33ace-1005-305e-8fb5-46abc45b6c0f.png)\n\n\u203b YOUR_API_KEY \u306e\u90e8\u5206\u306f Google\u306eAPI\u30ad\u30fc\u3092\u53d6\u5f97\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u203b \u3053\u306e\u65b9\u6cd5\u3067\u3082\u7121\u5236\u9650\u306b\u691c\u7d22\u3067\u304d\u308b\u308f\u3051\u3067\u306f\u306a\u304f\u3001Google Maps API\u306eDirectionsService\u3067\u306f\u4e00\u6c17\u306b\u691c\u7d22\u3067\u304d\u308b\u306e\u304c10\u56de\u307e\u3067\u306b\u5236\u9650\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u691c\u7d22\u53ef\u80fd\u306a\u6700\u5927\u5730\u70b9\u6570\u306f\u51fa\u767a\u5730\u3068\u76ee\u7684\u5730\u3092\u542b\u3081\u306691\u5730\u70b9\u307e\u3067\u306b\u306a\u308a\u307e\u3059\u3002(10\u5730\u70b9\u5206\u691c\u7d22\u3057\u305f\u5f8c\u3001\u6700\u5f8c\u306e10\u5730\u70b9\u76ee\u3092\u6b21\u306e\u691c\u7d22\u306e\u51fa\u767a\u5730\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067 10 + 9 \u00d7 9 = 91\u306b\u306a\u308b)\n\n\u203b \u3053\u306e\u65b9\u6cd5\u3067\u306fDirectionsRenderer\u304c\u4f7f\u3048\u306a\u304f\u306a\u308b\u306e\u3067\u3001\u81ea\u529b\u3067\u30d1\u30b9\u63cf\u753b\u3084\u30de\u30fc\u30ab\u30fc\u306e\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002(1\u3064\u306e\u7d50\u679c\u3057\u304bDirectionsRenderer\u306b\u30bb\u30c3\u30c8\u3067\u304d\u306a\u3044\u305f\u3081\u3002\u305f\u3060\u3001DirectionsRenderer\u306f\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u308b\u90e8\u5206\u304c\u3042\u307e\u308a\u591a\u304f\u306a\u3044\u306e\u3067\u3001\u72ec\u81ea\u3067\u51e6\u7406\u3092\u4f5c\u6210\u3057\u305f\u307b\u3046\u304c\u878d\u901a\u304c\u304d\u304d\u3084\u3059\u3044\u3067\u3059)\n\n## \u51fa\u767a\u5730\u3001\u7d4c\u7531\u5730\u70b9\u3001\u76ee\u7684\u5730\u306e\u5408\u8a08\u304c91\u3088\u308a\u591a\u3044\u5834\u5408\n\n\u300c91\u3067\u306f\u8db3\u308a\u306a\u3044\u300d\u3068\u3044\u3046\u30b1\u30fc\u30b9\u306f\u3042\u307e\u308a\u7121\u3044\u6c17\u304c\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u306b\u306a\u3063\u305f\u3068\u304d\u306f\u300c\u300c\u7d4c\u7531\u5730\u70b9\u306e\u6570\u304c8\u3088\u308a\u591a\u3044\u5834\u5408\u300d\u306e\u30b3\u30fc\u30c9\u5185\u306b\u3001DirectionsService\u304c\u8fd4\u3057\u3066\u304d\u305f\u7d50\u679c\u3092JSON\u5f62\u5f0f\u3067\u4fdd\u5b58\u3059\u308b\u30b3\u30fc\u30c9\u3092\u30c7\u30d0\u30c3\u30b0\u3067\u631f\u3093\u3067\u304a\u3044\u3066\u3001\u4fdd\u5b58\u3067\u304d\u305f\u3089\u305d\u308c\u4ee5\u964d\u306f\u4fdd\u5b58\u3057\u305f\u30c7\u30fc\u30bf\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3068\u3057\u3066\u4f7f\u3046\u300d\u3068\u3044\u3046\u5f62\u304c\u3068\u308c\u307e\u3059\u3002(\u300c\u3068\u308c\u307e\u3059\u300d\u3068\u3044\u3063\u3066\u3082\u300c\u3068\u308c\u306a\u304f\u3082\u306a\u3044\u300d\u3068\u3044\u3046\u30ec\u30d9\u30eb\u3067\u3001\u3060\u3044\u3076\u7121\u7406\u77e2\u7406\u306a\u90e8\u985e\u3067\u3059)\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u304c\u66f8\u304d\u3065\u3089\u3044\u306e\u3067\u3059\u304c\u3001DirectionsService\u306eroute()\u3067\u8fd4\u3063\u3066\u304d\u305f\u7d50\u679c\u3092\u300c[How to save the output of a console.log(object) to a file? - StackOverflow](http://stackoverflow.com/questions/11849562/how-to-save-the-output-of-a-console-logobject-to-a-file)\u300d\u306e\u56de\u7b54(console.save())\u3088\u3046\u306a\u5f62\u3067JSON\u3067\u4fdd\u5b58\u3057\u3066\u3001\u4fdd\u5b58\u3057\u305f\u7d50\u679c\u30c7\u30fc\u30bf\u3092Ajax\u3067\u53d6\u5f97\u3057\u3066\u30eb\u30fc\u30c8\u63cf\u753b\u3059\u308b\u3088\u3046\u306a\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\n\n\u203b \u7d50\u679c (DirectionsResult) \u306e\u30c7\u30fc\u30bf\u306f\u5de8\u5927\u306a\u306e\u3067\u3001path\u3060\u3051\u629c\u304d\u51fa\u3059\u306a\u3069\u5de5\u592b\u3057\u305f\u307b\u3046\u304c\u3088\u3044\u3067\u3059\u3002\n\n\u3053\u308c\u3060\u3068\u6700\u7d42\u7684\u306b\u300c[Google Maps API\u7121\u511f\u7248\u306e\u30dd\u30ea\u30b7\u30fc\u5909\u66f4](http://internet.watch.impress.co.jp/docs/special/1029218.html)\u300d \u306e\u3088\u3046\u306a\u7121\u511f\u7248\u30a2\u30ab\u30a6\u30f3\u30c8\u306eDirections API\u30ea\u30af\u30a8\u30b9\u30c8\u56de\u6570\u4e0a\u9650(1\u65e52500\u56de)\u3082\u5c11\u3057\u56de\u907f\u3067\u304d\u307e\u3059\u304c\u3001\u3053\u3053\u307e\u3067\u3084\u308b\u306e\u3067\u3042\u308c\u3070\u7d20\u76f4\u306b\u6709\u511f\u306b\u3059\u308b\u304b\u4ee3\u66ff\u30b5\u30fc\u30d3\u30b9\u3092\u691c\u8a0e\u3057\u305f\u307b\u3046\u304c\u3088\u3044\u6c17\u304c\u3057\u307e\u3059\u3002\n", "tags": ["JavaScript", "GoogleMapsAPI"]}