{"tags": ["SmartyBundle", "Smarty", "PHP", "Symfony"], "context": "Symfony 2.8 \u3067 SmartyBundle \u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306e Smarty \u30d7\u30ea\u30d5\u30a3\u30eb\u30bf\u306e\u5b9f\u88c5\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u8003\u306b\u3057\u305f\u3068\u3053\u308d\u3001\u601d\u3044\u306e\u307b\u304b\u30cf\u30de\u3063\u3066\u3001\u7d50\u5c40 SmartyBundle \u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u90e8\u5206\u7684\u306b\u8aad\u3080\u4e8b\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\u30e1\u30e2\u3092\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u53c2\u8003: SmartyBundle \u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n6.8. Enabling custom Extensions\n\n\u30d7\u30ea\u30d5\u30a3\u30eb\u30bf\u3092\u5229\u7528\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u5b9f\u88c5\nSmartyBundle \u3067\u30d7\u30ea\u30d5\u30a3\u30eb\u30bf\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u3001Extension \u3092\u7528\u610f\u3057\u307e\u3059\u3002\nSmartyBundle \u306e Extension \u306f\u3001ExtensionInterface \u3092\u5b9f\u88c5\u3057\u305f\u30af\u30e9\u30b9\u3067\u3001AbstractExtension \u306f ExtensionInterface \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5b9f\u88c5\u3092\u7528\u610f\u3057\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u3067\u3001AbstractExtension \u3092\u7d99\u627f\u3059\u308c\u3070\u5fc5\u8981\u306a\u30e1\u30bd\u30c3\u30c9(\u4eca\u56de\u306f getFilters )\u306e\u307f\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3059\u308c\u3070OK\u3067\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u5b9f\u88c5\u306f SSI \u306e\u30bf\u30b0\u3092 include \u30bf\u30b0\u306b\u7f6e\u63db\u3059\u308b\u30d7\u30ea\u30d5\u30a3\u30eb\u30bf\u3092\u767b\u9332\u3059\u308b\u3082\u306e\u3067\u3059\u3002\n\nsrc/Ext/SmartyExtensionBundle/Extension/TemplateFiltersExtension.php\n<?php\n\nnamespace Ext\\SmartyExtensionBundle\\Extension;\n\nuse Psr\\Log\\LoggerInterface as Logger;\nuse Symfony\\Component\\DependencyInjection\\ContainerInterface as Container;\nuse NoiseLabs\\Bundle\\SmartyBundle\\Extension\\AbstractExtension;\nuse NoiseLabs\\Bundle\\SmartyBundle\\Extension\\Filter\\PreFilter;\n\nclass TemplateFiltersExtension extends AbstractExtension\n{\n    // not required.\n    public function __construct(Container $container, Logger $logger)\n    {\n        $this->container = $container;\n        $this->logger = $logger;\n    }\n\n    // required (the official doc. said.)\n    public function getName()\n    {\n        // the extension name.\n        return 'ext.ssi2include';\n    }\n\n    public function getFilters()\n    {\n        return array(\n            // filter name, extension obj, filter function(method) name\n            new PreFilter('prefilter_ssi2include', $this, 'ssi2include'),\n        );\n    }\n\n    // filter function(method).\n    // example: replace ssi-tags to smarty include tags.\n    public function ssi2include($source) {\n\n        $left_delimiter = $this->container->getParameter('smarty.opt.delimiter.left');\n        $right_delimiter = $this->container->getParameter('smarty.opt.delimiter.right');\n        $source = preg_replace('/<!--#include\\ (virtual|file)=\"\\/?(.+)?\"-->/i',\n            $left_delimiter . 'include file=\\'' . $_SERVER['DOCUMENT_ROOT'] . '/' . \"$2\" . '\\'' . $right_delimiter,\n            $source\n        );\n\n        return $source;\n    }\n}\n\n\n\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306f\u5fc5\u9808\u3067\u306f\u306a\u3044\u3067\u3059\u304c\u3001getName \u30e1\u30bd\u30c3\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002\nSmarty\u306e\u30d5\u30a3\u30eb\u30bf\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u306f\u3001getFilters \u306e\u623b\u308a\u5024\u3068\u3057\u3066\u3001PreFilter(FilterInterface \u306e\u5b9f\u88c5\u30af\u30e9\u30b9)\u306e\u914d\u5217\u3092\u8fd4\u3059\u3053\u3068\u3067\u3001$smarty->register_prefilter() \u306b\u5bfe\u8c61\u306e\u30e1\u30bd\u30c3\u30c9\u304c\u6e21\u3055\u308c\u307e\u3059\u3002\n\u516c\u5f0f\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u7b2c\u4e00\u5f15\u6570\u304c $this\u3001\u7b2c\u4e8c\u5f15\u6570\u304c\u30d5\u30a3\u30eb\u30bf\u672c\u4f53\u306e\u30e1\u30bd\u30c3\u30c9\u540d\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u7b2c\u4e00\u5f15\u6570\u306f\u30d5\u30a3\u30eb\u30bf\u540d\u3092\u6307\u5b9a\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4f55\u304b\u306e\u8a2d\u5b9a\u3067\u5909\u66f4\u3067\u304d\u308b\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30d5\u30a3\u30eb\u30bf\u306e\u5b9f\u88c5\u306e\u5909\u66f4\u3092\u53cd\u6620\u3055\u305b\u308b\u969b\u306f\u6bce\u56de\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u30af\u30ea\u30a2\u3057\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n\u30b5\u30fc\u30d3\u30b9\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\n\u30b5\u30fc\u30d3\u30b9\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u969b\u3001smarty.extension \u3068\u3044\u3046\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u3060\u3051\u3067 SmartyBundle \u306e Extension \u3068\u3057\u3066\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\nsrc/Ext/SmartyExtensionBundle/Resources/config/services.yml\nservices:\n    smarty.extension.template_filters:\n        class: Ext\\SmartyExtensionBundle\\Extension\\TemplateFiltersExtension\n        arguments: [ \"@service_container\", \"@logger\" ]\n        tags:\n            - { name: smarty.extension }\n\n\narguments \u306e\u30b5\u30fc\u30d3\u30b9\u30b3\u30f3\u30c6\u30ca\u306f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u6e21\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u304a\u307e\u3051: \u30b5\u30f3\u30d7\u30eb\u3067\u53c2\u7167\u3057\u3066\u3044\u308b\u8a2d\u5b9a\n\u30b5\u30f3\u30d7\u30eb\u3067\u5229\u7528\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3001\u672c\u7b4b\u3068\u306f\u95a2\u4fc2\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u53c2\u7167\u3057\u3066\u3044\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u7b49\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\napp/config/config.yml\n\nparameters:\n    smarty.opt.delimiter.left:  \"{\"\n    smarty.opt.delimiter.right: \"}\"\n\nsmarty:\n    options:\n        left_delimiter:  \"%smarty.opt.delimiter.left%\"\n        right_delimiter: \"%smarty.opt.delimiter.right%\"\n\n\n\n[Symfony](https://symfony.com) 2.8 \u3067 [SmartyBundle](https://github.com/noiselabs/SmartyBundle) \u3092\u5229\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306e Smarty \u30d7\u30ea\u30d5\u30a3\u30eb\u30bf\u306e\u5b9f\u88c5\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\n\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u53c2\u8003\u306b\u3057\u305f\u3068\u3053\u308d\u3001\u601d\u3044\u306e\u307b\u304b\u30cf\u30de\u3063\u3066\u3001\u7d50\u5c40 SmartyBundle \u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u90e8\u5206\u7684\u306b\u8aad\u3080\u4e8b\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3001\u30e1\u30e2\u3092\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n## \u53c2\u8003: SmartyBundle \u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n[6.8. Enabling custom Extensions](\"http://smartybundle.readthedocs.io/en/latest/extensions.html#enabling-custom-extensions\")\n\n\n## \u30d7\u30ea\u30d5\u30a3\u30eb\u30bf\u3092\u5229\u7528\u3059\u308b\u30b5\u30f3\u30d7\u30eb\u5b9f\u88c5\n\nSmartyBundle \u3067\u30d7\u30ea\u30d5\u30a3\u30eb\u30bf\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u3001Extension \u3092\u7528\u610f\u3057\u307e\u3059\u3002\nSmartyBundle \u306e Extension \u306f\u3001ExtensionInterface \u3092\u5b9f\u88c5\u3057\u305f\u30af\u30e9\u30b9\u3067\u3001AbstractExtension \u306f ExtensionInterface \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5b9f\u88c5\u3092\u7528\u610f\u3057\u3066\u304f\u308c\u3066\u3044\u308b\u306e\u3067\u3001AbstractExtension \u3092\u7d99\u627f\u3059\u308c\u3070\u5fc5\u8981\u306a\u30e1\u30bd\u30c3\u30c9(\u4eca\u56de\u306f `getFilters` )\u306e\u307f\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3059\u308c\u3070OK\u3067\u3059\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u5b9f\u88c5\u306f SSI \u306e\u30bf\u30b0\u3092 include \u30bf\u30b0\u306b\u7f6e\u63db\u3059\u308b\u30d7\u30ea\u30d5\u30a3\u30eb\u30bf\u3092\u767b\u9332\u3059\u308b\u3082\u306e\u3067\u3059\u3002\n\n```php:src/Ext/SmartyExtensionBundle/Extension/TemplateFiltersExtension.php\n<?php\n\nnamespace Ext\\SmartyExtensionBundle\\Extension;\n\nuse Psr\\Log\\LoggerInterface as Logger;\nuse Symfony\\Component\\DependencyInjection\\ContainerInterface as Container;\nuse NoiseLabs\\Bundle\\SmartyBundle\\Extension\\AbstractExtension;\nuse NoiseLabs\\Bundle\\SmartyBundle\\Extension\\Filter\\PreFilter;\n\nclass TemplateFiltersExtension extends AbstractExtension\n{\n    // not required.\n    public function __construct(Container $container, Logger $logger)\n    {\n        $this->container = $container;\n        $this->logger = $logger;\n    }\n\n    // required (the official doc. said.)\n    public function getName()\n    {\n        // the extension name.\n        return 'ext.ssi2include';\n    }\n\n    public function getFilters()\n    {\n        return array(\n            // filter name, extension obj, filter function(method) name\n            new PreFilter('prefilter_ssi2include', $this, 'ssi2include'),\n        );\n    }\n\n    // filter function(method).\n    // example: replace ssi-tags to smarty include tags.\n    public function ssi2include($source) {\n\n        $left_delimiter = $this->container->getParameter('smarty.opt.delimiter.left');\n        $right_delimiter = $this->container->getParameter('smarty.opt.delimiter.right');\n        $source = preg_replace('/<!--#include\\ (virtual|file)=\"\\/?(.+)?\"-->/i',\n            $left_delimiter . 'include file=\\'' . $_SERVER['DOCUMENT_ROOT'] . '/' . \"$2\" . '\\'' . $right_delimiter,\n            $source\n        );\n\n        return $source;\n    }\n}\n```\n\n\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306f\u5fc5\u9808\u3067\u306f\u306a\u3044\u3067\u3059\u304c\u3001`getName` \u30e1\u30bd\u30c3\u30c9\u306f\u5fc5\u9808\u3067\u3059\u3002\n\nSmarty\u306e\u30d5\u30a3\u30eb\u30bf\u3092\u5229\u7528\u3059\u308b\u5834\u5408\u306f\u3001`getFilters` \u306e\u623b\u308a\u5024\u3068\u3057\u3066\u3001`PreFilter`(`FilterInterface` \u306e\u5b9f\u88c5\u30af\u30e9\u30b9)\u306e\u914d\u5217\u3092\u8fd4\u3059\u3053\u3068\u3067\u3001`$smarty->register_prefilter()` \u306b\u5bfe\u8c61\u306e\u30e1\u30bd\u30c3\u30c9\u304c\u6e21\u3055\u308c\u307e\u3059\u3002\n\n\u516c\u5f0f\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u7b2c\u4e00\u5f15\u6570\u304c `$this`\u3001\u7b2c\u4e8c\u5f15\u6570\u304c\u30d5\u30a3\u30eb\u30bf\u672c\u4f53\u306e\u30e1\u30bd\u30c3\u30c9\u540d\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u306f\u7b2c\u4e00\u5f15\u6570\u306f\u30d5\u30a3\u30eb\u30bf\u540d\u3092\u6307\u5b9a\u3059\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u4f55\u304b\u306e\u8a2d\u5b9a\u3067\u5909\u66f4\u3067\u304d\u308b\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30d5\u30a3\u30eb\u30bf\u306e\u5b9f\u88c5\u306e\u5909\u66f4\u3092\u53cd\u6620\u3055\u305b\u308b\u969b\u306f\u6bce\u56de\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u30af\u30ea\u30a2\u3057\u3066\u3084\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n\n## \u30b5\u30fc\u30d3\u30b9\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\n\n\u30b5\u30fc\u30d3\u30b9\u30b3\u30f3\u30c6\u30ca\u306b\u767b\u9332\u3059\u308b\u969b\u3001`smarty.extension` \u3068\u3044\u3046\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u3060\u3051\u3067 SmartyBundle \u306e Extension \u3068\u3057\u3066\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\n```yaml:src/Ext/SmartyExtensionBundle/Resources/config/services.yml\nservices:\n    smarty.extension.template_filters:\n        class: Ext\\SmartyExtensionBundle\\Extension\\TemplateFiltersExtension\n        arguments: [ \"@service_container\", \"@logger\" ]\n        tags:\n            - { name: smarty.extension }\n```\n\narguments \u306e\u30b5\u30fc\u30d3\u30b9\u30b3\u30f3\u30c6\u30ca\u306f\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u6e21\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n\n## \u304a\u307e\u3051: \u30b5\u30f3\u30d7\u30eb\u3067\u53c2\u7167\u3057\u3066\u3044\u308b\u8a2d\u5b9a\n\n\u30b5\u30f3\u30d7\u30eb\u3067\u5229\u7528\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3001\u672c\u7b4b\u3068\u306f\u95a2\u4fc2\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u53c2\u7167\u3057\u3066\u3044\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u7b49\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n```yaml:app/config/config.yml\n\nparameters:\n    smarty.opt.delimiter.left:  \"{\"\n    smarty.opt.delimiter.right: \"}\"\n\nsmarty:\n    options:\n        left_delimiter:  \"%smarty.opt.delimiter.left%\"\n        right_delimiter: \"%smarty.opt.delimiter.right%\"\n```\n"}