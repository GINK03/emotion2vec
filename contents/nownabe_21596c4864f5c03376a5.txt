{"context": "\n\n\u306f\u3058\u3081\u306b\n\u8907\u6570\u306eEmoji\u30bb\u30c3\u30c8\u3092\u7c21\u5358\u306b\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u308bSomemoji\u3068\u3044\u3046Ruby Gem\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001\u305d\u308c\u3092\u4f7f\u3063\u3066\u597d\u304d\u306aEmoji\u30bb\u30c3\u30c8\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308bMarkdown\u30a8\u30c7\u30a3\u30bf\u3092Ruby/HTML/JavaScript\u3067\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\u5b8c\u6210\u54c1\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059 \n\nhttps://meme-ac.herokuapp.com/\n\n\u74b0\u5883\n\u3060\u3044\u305f\u3044\u3053\u3093\u306a\u611f\u3058\u306e\u74b0\u5883\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\nMac\nRuby 2.3\nChrome\n\n\nSomemoji\n\n\u6982\u8981\nr7kamura/somemoji\u306f\u69d8\u3005\u306a\u7a2e\u985e\u306eEmoji\u30bb\u30c3\u30c8\u304c\u30b7\u30f3\u30d7\u30eb\u3067\u7c21\u5358\u306aAPI\u3067\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308bGem\u3067\u3059\u3002\n\u8a73\u3057\u304f\u306fr7kamura\u3055\u3093\u306e\u30d6\u30ed\u30b0\u3092\u898b\u3066\u304f\u3060\u3055\u3044  \n\u73fe\u5728\u306f\n\nApple Emoji\nEmojiOne\nNoto Emoji\nTwemoji\n\n\u306e4\u7a2e\u985e\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\nSomemoji\u3092\u4f7f\u3048\u3070Slack\u306eEmoji\u9078\u629e\u307f\u305f\u3044\u306a\u6a5f\u80fd\u304c\u7c21\u5358\u306b\u5b9f\u73fe\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059  \n\n\n\u4f7f\u3044\u65b9\n\u306a\u306b\u306f\u3068\u3082\u3042\u308c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n$ gem install somemoji\n\nSomemoji\u3067\u306f\u3001Emoji\u30b3\u30fc\u30c9(:poop:\u307f\u305f\u3044\u306a\u306e)\u304b\u3001\u751f\u306eEmoji\u304b\u3089\u753b\u50cf\u306eURL\u306b\u5909\u63db\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u6b21\u306e\u3088\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002\n# \u5909\u63db\u524d\u306e\u6587\u5b57\u5217\n>> str = \"I have a \ud83d\udd8a. I have an :apple:\"\n=> \"I have a \ud83d\udd8a. I have an :apple:\"\n\n# Somemoji::EmojiCollection\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3059\u308b\u3002\n>> emoji_collection = Somemoji.twemoji_emoji_collection\n=> #<Somemoji::EmojiCollection:0x007feb511ce2f8>\n\n# Emoji\u30b3\u30fc\u30c9\u3092img\u30bf\u30b0\u306b\u5909\u63db\u3059\u308b\n>> emoji_collection.replace_code(str) { |emoji| %(<img alt=\"#{emoji.character}\" src=\"/assets/emoji/twemoji/#{emoji.base_path}.png\">) }\n=> \"I have a \ud83d\udd8a. I have an <img alt=\\\"\ud83c\udf4e\\\" src=\\\"/assets/emoji/twemoji/unicode/1f34e.png\\\">\"\n\n# Emoji\u3092img\u30bf\u30b0\u306b\u5909\u63db\u3059\u308b\n>> emoji_collection.replace_character(str) { |emoji| %(<img alt=\"#{emoji.character}\" src=\"/assets/emoji/twemoji/#{emoji.base_path}.png\">) }\n=> \"I have a <img alt=\\\"\ud83d\udd8a\\\" src=\\\"/assets/emoji/twemoji/unicode/1f58a.png\\\">. I have an :apple:\"\n\nemoji\u3068\u3044\u3046\u30d6\u30ed\u30c3\u30af\u5909\u6570\u306b\u306fSomemoji::Emoji\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u5165\u308a\u3001\u3053\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u305d\u306eEmoji\u306e\u8272\u3005\u306a\u60c5\u5831\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\n>> emoji = emoji_collection.find_by_code(\"apple\")\n=> #<Somemoji::Emoji:0x007feb53ae21f8>\n>> emoji.code\n=> \"apple\"\n>> emoji.category\n=> \"food\"\n>> emoji.keywords\n=> [\"apple\", \"core\", \"creationism\", \"doctor\", \"electronics\", \"food\", \"fruit\", \"mac\", \"red\", \"school\", \"teacher\"]\n>> emoji.base_path\n=> \"unicode/1f34e\"\n\nSomemoji::Emoji#base_path\u3067\u306f\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u304c\u5f97\u3089\u308c\u307e\u3059\u3002Somemoji\u306b\u306f\u3053\u306e\u30d1\u30b9\u306b\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u81ea\u52d5\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306esomemoji\u30b3\u30de\u30f3\u30c9\u304c\u4ed8\u5c5e\u3057\u3066\u3044\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n# Apple Emoji\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u3001./assets/emoji/apple/ \u4ee5\u4e0b\u306b\u4fdd\u5b58\u3059\u308b\n$ somemoji extract --provider=apple --destination=./assets/emoji/apple\n\n# EmojiOne\u3092SVG\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n$ somemoji extract --provider=emoji_one --format svg --destination=./assets/emoji/emoji_one \n\n\nMarkdown\u30a8\u30c7\u30a3\u30bf\u3092\u4f5c\u308b\n\n\u6982\u8981\nSomemoji\u304c\u306a\u3093\u3068\u306a\u304f\u308f\u304b\u3063\u305f\u3068\u3053\u308d\u3067\u3001\u30de\u30eb\u30c1Emoji\u306aMarkdown\u30a8\u30c7\u30a3\u30bf\u3092\u4f5c\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\u30d6\u30e9\u30a6\u30b6\u3067\u5165\u529b\u3057\u305fMarkdown\u3092\u30b5\u30fc\u30d0\u306b\u9001\u4fe1\u3057\u3001\u30b5\u30fc\u30d0\u3067HTML\u3092\u63cf\u753b\u3057\u3066\u8fd4\u3059\u3068\u3044\u3046\u5358\u7d14\u306a\u4ed5\u7d44\u307f\u306e\u3082\u306e\u3067\u3059\u3002\n\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u306fRuby\u3001Sinatra\u3067\u4f5c\u308a\u307e\u3059\u3002\nMarkdown\u306e\u5909\u63db\u306b\u306fincrements/qiita-markdown\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u306fHTML\u3068JavaScript\u3067\u4f5c\u308a\u307e\u3059\u3002\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\u306b\u3042\u308a\u307e\u3059\u3002\nhttps://github.com/nownabe/meme\n\u4eca\u56de\u306f\u8af8\u4e8b\u60c5\u3067Apple Emoji\u306f\u629c\u3044\u3066\u3042\u308a\u307e\u3059\u30021\n\nAPI\u8a2d\u8a08\n\u4eca\u56deJavaScript\u3067Markdown\u3092\u30b5\u30fc\u30d0\u306b\u9001\u4fe1\u3057\u3001\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u3051\u53d6\u308a\u307e\u3059\u3002\nAPI\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\u30ea\u30af\u30a8\u30b9\u30c8\nPOST /markdown\n\n\n\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\n\u578b\n\u5185\u5bb9\n\n\n\n\nprovider\n\u6587\u5b57\u5217\nEmoji\u30bb\u30c3\u30c8\u306e\u7a2e\u985e\n\n\nmarkdown\n\u6587\u5b57\u5217\nMarkdown\u30c6\u30ad\u30b9\u30c8\n\n\n\n\n\u30ec\u30b9\u30dd\u30f3\u30b9\n{\n  \"provider\": \"emoji_one\", // Emoji\u30bb\u30c3\u30c8\u306e\u7a2e\u985e\n  \"rendered_html\": \"<h1>\u307b\u3052\u307b\u3052</h1>\" // \u63cf\u753b\u3055\u308c\u305fHTML\n}\n\n\n\u6e96\u5099\n\u9069\u5f53\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u3063\u3066\u3001Gemfile\u3092\u7528\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nGemfile\n# frozen_string_literal: true\n\nsource \"https://rubygems.org\"\n\ngem \"qiita-markdown\"\ngem \"somemoji\"\ngem \"sinatra\"\n\n\nbundle install\u3082\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\nEmoji\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nEmoji\u30bb\u30c3\u30c8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u30b3\u30de\u30f3\u30c9\u6253\u3063\u3066\u6b21\u306e\u4f5c\u696d\u306b\u79fb\u3063\u3066\u3057\u307e\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n$ bundle exec somemoji extract --provider emoji_one --destination ./public/images/emoji/emoji_one\n$ bundle exec somemoji extract --provider noto --destination ./public/images/emoji/noto\n$ bundle exec somemoji extract --provider twemoji --destination ./public/images/emoji/twemoji\n\n\n\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\npublic/index.html\u306b\u3053\u3093\u306a\u611f\u3058\u306eHTML\u3092\u7528\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\npublic/index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Multi Emoji Markdown Editor</title>\n    <script>\n      setInterval(function() {\n        var provider = document.getElementById(\"provider\").value\n        var markdown = document.getElementById(\"editor\").value\n        var formData = new FormData()\n        formData.append(\"provider\", provider)\n        formData.append(\"markdown\", markdown)\n        fetch(\n          \"/markdown\",\n          { method: \"POST\", body: formData }\n        ).then(function(response) {\n          return response.json()\n        }).then(function(response) {\n          document.getElementById(\"view\").innerHTML = response.rendered_html\n        })\n      }, 1000)\n    </script>\n  </head>\n  <body>\n    <div>\n      <select id=\"provider\">\n        <option value=\"emoji_one\">EmojiOne</option>\n        <option value=\"noto\">Noto</option>\n        <option value=\"twemoji\">Twemoji</option>\n      </select>\n    </div>\n    <div style=\"display: flex\">\n      <textarea id=\"editor\" style=\"width: 50%; height: 800px;\"></textarea>\n      <div id=\"view\" style=\"width: 50%; padding: 10px\">View</div>\n    </div>\n  </body>\n</html>\n\n\n1\u79d2\u3054\u3068\u306btextarea#editor\u306e\u5185\u5bb9\u3092\u30b5\u30fc\u30d0\u306b\u9001\u4fe1\u3057\u3066\u3001\u8fd4\u3063\u3066\u304d\u305fHTML\u3092div#view\u306b\u7a81\u3063\u8fbc\u3093\u3067\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\nAPI\u30b5\u30fc\u30d0 1\nAPI\u30b5\u30fc\u30d0\u306fSinatra\u3067\u30c1\u30e3\u30c1\u30e3\u3063\u3068\u4f5c\u308a\u307e\u3059\u3002\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u90e8\u5206\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\napi.rb\n# frozen_string_literal: true\n\nrequire \"json\"\nrequire \"sinatra\"\n\npost \"/markdown\" do\n  content_type :json\n  {\n    provider: params[:provider],\n    rendered_html: Renderer.new(params[:provider]).render(params[:markdown])\n  }.to_json\nend\n\n\nRenderer.new(provider).render(markdown)\u3067\u3001Markdown\u3092\u6307\u5b9a\u3055\u308c\u305fEmoji\u30bb\u30c3\u30c8\u3067\u63cf\u753b\u3059\u308b\u3088\u3046\u306aRenderer\u30af\u30e9\u30b9\u3092\u4f5c\u308a\u307e\u3059\u3002\n\nqiita-markdown\nRenderer\u30af\u30e9\u30b9\u3092\u5b9f\u88c5\u3059\u308b\u524d\u306b\u3001qiita-markdown\u3092\u5c11\u3057\u3060\u3051\u8aac\u660e\u3057\u307e\u3059\u3002\nqiita-markdown\u306fIncrements\u306b\u3088\u308b\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u306eMarkdown\u30d7\u30ed\u30bb\u30c3\u30b5\u3067\u3059\u3002Markdown\u3092\u30d1\u30fc\u30b9\u3057\u3066HTML\u306b\u5909\u63db\u3057\u3066\u304f\u308c\u305f\u308a\u3057\u307e\u3059\u3002\n\u3053\u3093\u306a\u611f\u3058\u3067\u4f7f\u3048\u307e\u3059\u3002\nrequire \"qiita/markdown\"\nprocessor = Qiita::Markdown::Processor.new(hostname: \"localhost:4567\")\nresult = processor.call(\"# \u307b\u3052\")\nresult[:output].to_s\n#=> \"\\n<h1>\\n<span id=\\\"\u307b\u3052\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E3%81%BB%E3%81%92\\\"><i class=\\\"fa fa-link\\\"></i></a>\u307b \u3052</h1>\\n\"\n\nqiita-markdown\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067Emoji\u3092\u5909\u63db\u3057\u3066\u304f\u308c\u307e\u3059\u304c\u3001emoji_url_generator\u3068emoj_names\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6e21\u3059\u3053\u3068\u3067\u3001\u4efb\u610f\u306e\u5909\u63db\u30ed\u30b8\u30c3\u30af\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nemoji_names\u306b\u306fEmoji\u30b3\u30fc\u30c9\u306e\u30ea\u30b9\u30c8\u3001emoji_url_generator\u306b\u306fEmoji\u30b3\u30fc\u30c9\u3092\u53d7\u3051\u3066\u6587\u5b57\u5217\u3068\u3057\u3066URL\u3092\u8fd4\u3059Proc\u306a\u3069\u3092\u6e21\u3059\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002Somemoji\u3092\u4f7f\u3046\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\nemoji_collection = Somemoji.twemoji_emoji_collection\nprocessor =\n  Qiita::Markdown::Processor.new(\n    hostname: \"localhost:4567\",\n    emoji_url_generator: proc { |code| \"/images/emoji/twemoji/#{emoji_collection.find_by_code(code).base_path}.png\" },\n    emoji_names: emoji_collection.codes\n  )\nresult = processor.call(\"# \u307b\u3052\\n:poop:\")\nresult[:output].to_s\n=> \"\\n<h1>\\n<span id=\\\"\u307b\u3052\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E3%81%BB%E3%81%92\\\"><i class=\\\"fa fa-link\\\"></i></a>\u307b \u3052</h1>\\n\\n<p><img class=\\\"emoji\\\" title=\\\":poop:\\\" alt=\\\":poop:\\\" src=\\\"/images/emoji/twemoji/unicode/1f4a9.png\\\" height=\\\"20\\\" width=\\\"20\\\" align=\\\"absmiddle\\\"></p>\\n\"\n\n\nAPI\u30b5\u30fc\u30d0 2\n\u4ee5\u4e0a\u3092\u8e0f\u307e\u3048\u3001\u6700\u7d42\u7684\u306aAPI\u30b5\u30fc\u30d0\u306e\u30b3\u30fc\u30c9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\napi.rb\n# frozen_string_literal: true\n\nrequire \"json\"\nrequire \"sinatra\"\nrequire \"somemoji\"\nrequire \"qiita/markdown\"\n\nclass Renderer\n  def initialize(provider)\n    @provider = provider\n    @processor =\n      Qiita::Markdown::Processor.new(\n        hostname: \"localhost:4567\",\n        emoji_url_generator: emoji_url_generator,\n        emoji_names: emoji_names\n      )\n  end\n\n  def render(markdown)\n    @processor.call(markdown)[:output].to_s\n  end\n\n  private\n\n  def emoji_collection\n    @emoji_collection ||=\n      case @provider\n      when \"emoji_one\"\n        Somemoji.emoji_one_emoji_collection\n      when \"noto\"\n        Somemoji.noto_emoji_collection\n      when \"twemoji\"\n        Somemoji.twemoji_emoji_collection\n      end\n  end\n\n  def emoji_names\n    emoji_collection.codes\n  end\n\n  def emoji_path(code)\n    \"/images/emoji/#{@provider}/#{emoji_collection.find_by_code(code).base_path}.png\"\n  end\n\n  def emoji_url_generator\n    proc { |code| emoji_path(code) }\n  end\nend\n\npost \"/markdown\" do\n  content_type :json\n  {\n    provider: params[:provider],\n    rendered_html: Renderer.new(params[:provider]).render(params[:markdown])\n  }.to_json\nend\n\n\n\n\u8d77\u52d5\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u3066\u3001http://localhost:4567/index.html\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n$ bundle exec ruby api.rb\n\n\u30c6\u30ad\u30b9\u30c8\u30a8\u30ea\u30a2\u306bMarkdown\u3092\u66f8\u3044\u3066\u3001\u53f3\u5074\u306b\u5185\u5bb9\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u6210\u529f\u3067\u3059 \nEmoji\u30bb\u30c3\u30c8\u3092\u9078\u629e\u3059\u308c\u3070\u53f3\u5074\u306eEmoji\u3082\u5909\u308f\u308b\u3068\u601d\u3044\u307e\u3059  \n\n\u304a\u308f\u308a\u306b\n\u306a\u3093\u3068\u3053\u308c\u3060\u3051\u3067\u8272\u3005\u306aEmoji\u30bb\u30c3\u30c8\u304c\u4f7f\u3048\u308bMarkdown\u30a8\u30c7\u30a3\u30bf\u304c\u3067\u304d\u3066\u3057\u307e\u3044\u307e\u3057\u305f \nSomemoji\u7d20\u6674\u3089\u3057\u3044\u3067\u3059  \nEmoji\u754c\u9688\u306e\u30a8\u30b3\u30b7\u30b9\u30c6\u30e0\u3082\u5145\u5b9f\u3057\u3066\u304d\u3066\u3001\u307e\u3059\u307e\u3059Emoji\u306e\u4eca\u5f8c\u304c\u697d\u3057\u307f\u3067\u3059\u306d  \n\n\n\n\nsomemoji extract (\u3082\u3063\u3068\u3044\u3046\u3068\u5185\u90e8\u3067\u4f7f\u3063\u3066\u308bgemoji)\u306eApple Emoji\u62bd\u51fa\u304cSierra\u306b\u3057\u304b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u00a0\u21a9\n\n\n\n# \u306f\u3058\u3081\u306b\n\u8907\u6570\u306eEmoji\u30bb\u30c3\u30c8\u3092\u7c21\u5358\u306b\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u308bSomemoji\u3068\u3044\u3046Ruby Gem\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u307e\u305f\u3001\u305d\u308c\u3092\u4f7f\u3063\u3066\u597d\u304d\u306aEmoji\u30bb\u30c3\u30c8\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308bMarkdown\u30a8\u30c7\u30a3\u30bf\u3092Ruby/HTML/JavaScript\u3067\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\n\u5b8c\u6210\u54c1\u306f\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3059 :sparkles:\n\n![meme.gif](https://qiita-image-store.s3.amazonaws.com/0/43208/ad5772b2-4282-ad0e-b052-0e31d672d607.gif)\nhttps://meme-ac.herokuapp.com/\n\n# \u74b0\u5883\n\u3060\u3044\u305f\u3044\u3053\u3093\u306a\u611f\u3058\u306e\u74b0\u5883\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n* Mac\n* Ruby 2.3\n* Chrome\n\n# Somemoji\n## \u6982\u8981\n[r7kamura/somemoji](https://github.com/r7kamura/somemoji)\u306f\u69d8\u3005\u306a\u7a2e\u985e\u306eEmoji\u30bb\u30c3\u30c8\u304c\u30b7\u30f3\u30d7\u30eb\u3067\u7c21\u5358\u306aAPI\u3067\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u308bGem\u3067\u3059\u3002\n\n\u8a73\u3057\u304f\u306f[r7kamura\u3055\u3093\u306e\u30d6\u30ed\u30b0](http://r7kamura.hatenablog.com/entry/2016/10/09/135444)\u3092\u898b\u3066\u304f\u3060\u3055\u3044 :balloon: \n\n\u73fe\u5728\u306f\n\n* Apple Emoji\n* EmojiOne\n* Noto Emoji\n* Twemoji\n\n\u306e4\u7a2e\u985e\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n\nSomemoji\u3092\u4f7f\u3048\u3070Slack\u306eEmoji\u9078\u629e\u307f\u305f\u3044\u306a\u6a5f\u80fd\u304c\u7c21\u5358\u306b\u5b9f\u73fe\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059 :blush: \n\n<img width=\"395\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-03 14.38.37.png (91.9 kB)\" src=\"https://img.esa.io/uploads/production/attachments/1679/2016/12/03/4429/662551ab-2bd1-4d7e-a1db-c1c22fe0c4de.png\">\n\n## \u4f7f\u3044\u65b9\n\u306a\u306b\u306f\u3068\u3082\u3042\u308c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```bash\n$ gem install somemoji\n```\n\nSomemoji\u3067\u306f\u3001Emoji\u30b3\u30fc\u30c9(`:poop:`\u307f\u305f\u3044\u306a\u306e)\u304b\u3001\u751f\u306eEmoji\u304b\u3089\u753b\u50cf\u306eURL\u306b\u5909\u63db\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u6b21\u306e\u3088\u3046\u306b\u4f7f\u3048\u307e\u3059\u3002\n\n```rb\n# \u5909\u63db\u524d\u306e\u6587\u5b57\u5217\n>> str = \"I have a \ud83d\udd8a. I have an :apple:\"\n=> \"I have a \ud83d\udd8a. I have an :apple:\"\n\n# Somemoji::EmojiCollection\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3059\u308b\u3002\n>> emoji_collection = Somemoji.twemoji_emoji_collection\n=> #<Somemoji::EmojiCollection:0x007feb511ce2f8>\n\n# Emoji\u30b3\u30fc\u30c9\u3092img\u30bf\u30b0\u306b\u5909\u63db\u3059\u308b\n>> emoji_collection.replace_code(str) { |emoji| %(<img alt=\"#{emoji.character}\" src=\"/assets/emoji/twemoji/#{emoji.base_path}.png\">) }\n=> \"I have a \ud83d\udd8a. I have an <img alt=\\\"\ud83c\udf4e\\\" src=\\\"/assets/emoji/twemoji/unicode/1f34e.png\\\">\"\n\n# Emoji\u3092img\u30bf\u30b0\u306b\u5909\u63db\u3059\u308b\n>> emoji_collection.replace_character(str) { |emoji| %(<img alt=\"#{emoji.character}\" src=\"/assets/emoji/twemoji/#{emoji.base_path}.png\">) }\n=> \"I have a <img alt=\\\"\ud83d\udd8a\\\" src=\\\"/assets/emoji/twemoji/unicode/1f58a.png\\\">. I have an :apple:\"\n```\n\n`emoji`\u3068\u3044\u3046\u30d6\u30ed\u30c3\u30af\u5909\u6570\u306b\u306f`Somemoji::Emoji`\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u5165\u308a\u3001\u3053\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u305d\u306eEmoji\u306e\u8272\u3005\u306a\u60c5\u5831\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\n\n```rb\n>> emoji = emoji_collection.find_by_code(\"apple\")\n=> #<Somemoji::Emoji:0x007feb53ae21f8>\n>> emoji.code\n=> \"apple\"\n>> emoji.category\n=> \"food\"\n>> emoji.keywords\n=> [\"apple\", \"core\", \"creationism\", \"doctor\", \"electronics\", \"food\", \"fruit\", \"mac\", \"red\", \"school\", \"teacher\"]\n>> emoji.base_path\n=> \"unicode/1f34e\"\n```\n\n`Somemoji::Emoji#base_path`\u3067\u306f\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306e\u30d1\u30b9\u304c\u5f97\u3089\u308c\u307e\u3059\u3002Somemoji\u306b\u306f\u3053\u306e\u30d1\u30b9\u306b\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u81ea\u52d5\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306e`somemoji`\u30b3\u30de\u30f3\u30c9\u304c\u4ed8\u5c5e\u3057\u3066\u3044\u307e\u3059\u3002\u6b21\u306e\u3088\u3046\u306b\u3057\u3066\u4f7f\u3044\u307e\u3059\u3002\n\n```bash\n# Apple Emoji\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u3001./assets/emoji/apple/ \u4ee5\u4e0b\u306b\u4fdd\u5b58\u3059\u308b\n$ somemoji extract --provider=apple --destination=./assets/emoji/apple\n\n# EmojiOne\u3092SVG\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n$ somemoji extract --provider=emoji_one --format svg --destination=./assets/emoji/emoji_one \n```\n\n# Markdown\u30a8\u30c7\u30a3\u30bf\u3092\u4f5c\u308b\n## \u6982\u8981\nSomemoji\u304c\u306a\u3093\u3068\u306a\u304f\u308f\u304b\u3063\u305f\u3068\u3053\u308d\u3067\u3001\u30de\u30eb\u30c1Emoji\u306aMarkdown\u30a8\u30c7\u30a3\u30bf\u3092\u4f5c\u3063\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u5165\u529b\u3057\u305fMarkdown\u3092\u30b5\u30fc\u30d0\u306b\u9001\u4fe1\u3057\u3001\u30b5\u30fc\u30d0\u3067HTML\u3092\u63cf\u753b\u3057\u3066\u8fd4\u3059\u3068\u3044\u3046\u5358\u7d14\u306a\u4ed5\u7d44\u307f\u306e\u3082\u306e\u3067\u3059\u3002\n\n\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u306fRuby\u3001Sinatra\u3067\u4f5c\u308a\u307e\u3059\u3002\nMarkdown\u306e\u5909\u63db\u306b\u306f[increments/qiita-markdown](https://github.com/increments/qiita-markdown)\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u306fHTML\u3068JavaScript\u3067\u4f5c\u308a\u307e\u3059\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u3053\u3061\u3089\u306b\u3042\u308a\u307e\u3059\u3002\nhttps://github.com/nownabe/meme\n\n\u4eca\u56de\u306f\u8af8\u4e8b\u60c5\u3067Apple Emoji\u306f\u629c\u3044\u3066\u3042\u308a\u307e\u3059\u3002[^1]\n\n[^1]: `somemoji extract` (\u3082\u3063\u3068\u3044\u3046\u3068\u5185\u90e8\u3067\u4f7f\u3063\u3066\u308bgemoji)\u306eApple Emoji\u62bd\u51fa\u304cSierra\u306b\u3057\u304b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\n\n## API\u8a2d\u8a08\n\u4eca\u56deJavaScript\u3067Markdown\u3092\u30b5\u30fc\u30d0\u306b\u9001\u4fe1\u3057\u3001\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u3051\u53d6\u308a\u307e\u3059\u3002\nAPI\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n### \u30ea\u30af\u30a8\u30b9\u30c8\n```\nPOST /markdown\n```\n\n| \u30d1\u30e9\u30e1\u30fc\u30bf | \u578b | \u5185\u5bb9 |\n| --- | --- | --- |\n| `provider` | \u6587\u5b57\u5217 | Emoji\u30bb\u30c3\u30c8\u306e\u7a2e\u985e |\n| `markdown` | \u6587\u5b57\u5217 | Markdown\u30c6\u30ad\u30b9\u30c8 |\n\n### \u30ec\u30b9\u30dd\u30f3\u30b9\n```js\n{\n  \"provider\": \"emoji_one\", // Emoji\u30bb\u30c3\u30c8\u306e\u7a2e\u985e\n  \"rendered_html\": \"<h1>\u307b\u3052\u307b\u3052</h1>\" // \u63cf\u753b\u3055\u308c\u305fHTML\n}\n```\n\n## \u6e96\u5099\n\u9069\u5f53\u306a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u3063\u3066\u3001Gemfile\u3092\u7528\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```rb:Gemfile\n# frozen_string_literal: true\n\nsource \"https://rubygems.org\"\n\ngem \"qiita-markdown\"\ngem \"somemoji\"\ngem \"sinatra\"\n```\n\n`bundle install`\u3082\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n## Emoji\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nEmoji\u30bb\u30c3\u30c8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u30b3\u30de\u30f3\u30c9\u6253\u3063\u3066\u6b21\u306e\u4f5c\u696d\u306b\u79fb\u3063\u3066\u3057\u307e\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\n$ bundle exec somemoji extract --provider emoji_one --destination ./public/images/emoji/emoji_one\n$ bundle exec somemoji extract --provider noto --destination ./public/images/emoji/noto\n$ bundle exec somemoji extract --provider twemoji --destination ./public/images/emoji/twemoji\n```\n\n## \u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\n`public/index.html`\u306b\u3053\u3093\u306a\u611f\u3058\u306eHTML\u3092\u7528\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```html:public/index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Multi Emoji Markdown Editor</title>\n    <script>\n      setInterval(function() {\n        var provider = document.getElementById(\"provider\").value\n        var markdown = document.getElementById(\"editor\").value\n        var formData = new FormData()\n        formData.append(\"provider\", provider)\n        formData.append(\"markdown\", markdown)\n        fetch(\n          \"/markdown\",\n          { method: \"POST\", body: formData }\n        ).then(function(response) {\n          return response.json()\n        }).then(function(response) {\n          document.getElementById(\"view\").innerHTML = response.rendered_html\n        })\n      }, 1000)\n    </script>\n  </head>\n  <body>\n    <div>\n      <select id=\"provider\">\n        <option value=\"emoji_one\">EmojiOne</option>\n        <option value=\"noto\">Noto</option>\n        <option value=\"twemoji\">Twemoji</option>\n      </select>\n    </div>\n    <div style=\"display: flex\">\n      <textarea id=\"editor\" style=\"width: 50%; height: 800px;\"></textarea>\n      <div id=\"view\" style=\"width: 50%; padding: 10px\">View</div>\n    </div>\n  </body>\n</html>\n```\n\n1\u79d2\u3054\u3068\u306b`textarea#editor`\u306e\u5185\u5bb9\u3092\u30b5\u30fc\u30d0\u306b\u9001\u4fe1\u3057\u3066\u3001\u8fd4\u3063\u3066\u304d\u305fHTML\u3092`div#view`\u306b\u7a81\u3063\u8fbc\u3093\u3067\u3044\u308b\u3060\u3051\u3067\u3059\u3002\n\n## API\u30b5\u30fc\u30d0 1\nAPI\u30b5\u30fc\u30d0\u306fSinatra\u3067\u30c1\u30e3\u30c1\u30e3\u3063\u3068\u4f5c\u308a\u307e\u3059\u3002\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u90e8\u5206\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n```rb:api.rb\n# frozen_string_literal: true\n\nrequire \"json\"\nrequire \"sinatra\"\n\npost \"/markdown\" do\n  content_type :json\n  {\n    provider: params[:provider],\n    rendered_html: Renderer.new(params[:provider]).render(params[:markdown])\n  }.to_json\nend\n```\n\n`Renderer.new(provider).render(markdown)`\u3067\u3001Markdown\u3092\u6307\u5b9a\u3055\u308c\u305fEmoji\u30bb\u30c3\u30c8\u3067\u63cf\u753b\u3059\u308b\u3088\u3046\u306a`Renderer`\u30af\u30e9\u30b9\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n## qiita-markdown\n`Renderer`\u30af\u30e9\u30b9\u3092\u5b9f\u88c5\u3059\u308b\u524d\u306b\u3001qiita-markdown\u3092\u5c11\u3057\u3060\u3051\u8aac\u660e\u3057\u307e\u3059\u3002\nqiita-markdown\u306fIncrements\u306b\u3088\u308b\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u306eMarkdown\u30d7\u30ed\u30bb\u30c3\u30b5\u3067\u3059\u3002Markdown\u3092\u30d1\u30fc\u30b9\u3057\u3066HTML\u306b\u5909\u63db\u3057\u3066\u304f\u308c\u305f\u308a\u3057\u307e\u3059\u3002\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u4f7f\u3048\u307e\u3059\u3002\n\n```rb\nrequire \"qiita/markdown\"\nprocessor = Qiita::Markdown::Processor.new(hostname: \"localhost:4567\")\nresult = processor.call(\"# \u307b\u3052\")\nresult[:output].to_s\n#=> \"\\n<h1>\\n<span id=\\\"\u307b\u3052\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E3%81%BB%E3%81%92\\\"><i class=\\\"fa fa-link\\\"></i></a>\u307b \u3052</h1>\\n\"\n```\n\nqiita-markdown\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067Emoji\u3092\u5909\u63db\u3057\u3066\u304f\u308c\u307e\u3059\u304c\u3001`emoji_url_generator`\u3068`emoj_names`\u3068\u3044\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6e21\u3059\u3053\u3068\u3067\u3001\u4efb\u610f\u306e\u5909\u63db\u30ed\u30b8\u30c3\u30af\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n`emoji_names`\u306b\u306fEmoji\u30b3\u30fc\u30c9\u306e\u30ea\u30b9\u30c8\u3001`emoji_url_generator`\u306b\u306fEmoji\u30b3\u30fc\u30c9\u3092\u53d7\u3051\u3066\u6587\u5b57\u5217\u3068\u3057\u3066URL\u3092\u8fd4\u3059Proc\u306a\u3069\u3092\u6e21\u3059\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002Somemoji\u3092\u4f7f\u3046\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```rb\nemoji_collection = Somemoji.twemoji_emoji_collection\nprocessor =\n  Qiita::Markdown::Processor.new(\n    hostname: \"localhost:4567\",\n    emoji_url_generator: proc { |code| \"/images/emoji/twemoji/#{emoji_collection.find_by_code(code).base_path}.png\" },\n    emoji_names: emoji_collection.codes\n  )\nresult = processor.call(\"# \u307b\u3052\\n:poop:\")\nresult[:output].to_s\n=> \"\\n<h1>\\n<span id=\\\"\u307b\u3052\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E3%81%BB%E3%81%92\\\"><i class=\\\"fa fa-link\\\"></i></a>\u307b \u3052</h1>\\n\\n<p><img class=\\\"emoji\\\" title=\\\":poop:\\\" alt=\\\":poop:\\\" src=\\\"/images/emoji/twemoji/unicode/1f4a9.png\\\" height=\\\"20\\\" width=\\\"20\\\" align=\\\"absmiddle\\\"></p>\\n\"\n```\n\n## API\u30b5\u30fc\u30d0 2\n\u4ee5\u4e0a\u3092\u8e0f\u307e\u3048\u3001\u6700\u7d42\u7684\u306aAPI\u30b5\u30fc\u30d0\u306e\u30b3\u30fc\u30c9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```rb:api.rb\n# frozen_string_literal: true\n\nrequire \"json\"\nrequire \"sinatra\"\nrequire \"somemoji\"\nrequire \"qiita/markdown\"\n\nclass Renderer\n  def initialize(provider)\n    @provider = provider\n    @processor =\n      Qiita::Markdown::Processor.new(\n        hostname: \"localhost:4567\",\n        emoji_url_generator: emoji_url_generator,\n        emoji_names: emoji_names\n      )\n  end\n\n  def render(markdown)\n    @processor.call(markdown)[:output].to_s\n  end\n\n  private\n\n  def emoji_collection\n    @emoji_collection ||=\n      case @provider\n      when \"emoji_one\"\n        Somemoji.emoji_one_emoji_collection\n      when \"noto\"\n        Somemoji.noto_emoji_collection\n      when \"twemoji\"\n        Somemoji.twemoji_emoji_collection\n      end\n  end\n\n  def emoji_names\n    emoji_collection.codes\n  end\n\n  def emoji_path(code)\n    \"/images/emoji/#{@provider}/#{emoji_collection.find_by_code(code).base_path}.png\"\n  end\n\n  def emoji_url_generator\n    proc { |code| emoji_path(code) }\n  end\nend\n\npost \"/markdown\" do\n  content_type :json\n  {\n    provider: params[:provider],\n    rendered_html: Renderer.new(params[:provider]).render(params[:markdown])\n  }.to_json\nend\n```\n\n## \u8d77\u52d5\n\u6b21\u306e\u30b3\u30de\u30f3\u30c9\u3067\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u3066\u3001`http://localhost:4567/index.html`\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash\n$ bundle exec ruby api.rb\n```\n\n\u30c6\u30ad\u30b9\u30c8\u30a8\u30ea\u30a2\u306bMarkdown\u3092\u66f8\u3044\u3066\u3001\u53f3\u5074\u306b\u5185\u5bb9\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u6210\u529f\u3067\u3059 :tada:\nEmoji\u30bb\u30c3\u30c8\u3092\u9078\u629e\u3059\u308c\u3070\u53f3\u5074\u306eEmoji\u3082\u5909\u308f\u308b\u3068\u601d\u3044\u307e\u3059 :blossom: \n\n# \u304a\u308f\u308a\u306b\n\u306a\u3093\u3068\u3053\u308c\u3060\u3051\u3067\u8272\u3005\u306aEmoji\u30bb\u30c3\u30c8\u304c\u4f7f\u3048\u308bMarkdown\u30a8\u30c7\u30a3\u30bf\u304c\u3067\u304d\u3066\u3057\u307e\u3044\u307e\u3057\u305f :flushed:\nSomemoji\u7d20\u6674\u3089\u3057\u3044\u3067\u3059 :heart: \n\nEmoji\u754c\u9688\u306e\u30a8\u30b3\u30b7\u30b9\u30c6\u30e0\u3082\u5145\u5b9f\u3057\u3066\u304d\u3066\u3001\u307e\u3059\u307e\u3059Emoji\u306e\u4eca\u5f8c\u304c\u697d\u3057\u307f\u3067\u3059\u306d :laughing: \n", "tags": ["emoji", "somemoji", "Ruby", "Markdown"]}