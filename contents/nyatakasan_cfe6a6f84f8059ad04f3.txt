{"context": " More than 1 year has passed since last update.\n\nOS\u72b6\u6cc1\u78ba\u8a8d\nCentOS 7 (x86_64) with Updates HVM\nhttps://aws.amazon.com/marketplace/pp/B00O7WM7QW\n\u203buser:'centos'\n\nOS\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n$ yum -y update\n$ yum -y install wget ntp mlocate\n\n\n\u6642\u523b\u30b5\u30fc\u30d0\u8a2d\u5b9a\n$ sed -i \"s/server 0.centos.pool.ntp.org iburst/server -4 ntp.nict.jp iburst/g\" /etc/ntp.conf\n$ sed -i \"s/server 1.centos.pool.ntp.org iburst/server -4 ntp1.jst.mfeed.ad.jp iburst/g\" /etc/ntp.conf\n$ sed -i \"s/server 2.centos.pool.ntp.org iburst/server -4 ntp2.jst.mfeed.ad.jp iburst/g\" /etc/ntp.conf\n$ sed -i \"s/server 3.centos.pool.ntp.org iburst/server -4 ntp3.jst.mfeed.ad.jp iburst/g\" /etc/ntp.conf\n\n\nNTP\u30b5\u30fc\u30d0\u8d77\u52d5\n$ sudo systemctl enable ntpd\n$ sudo systemctl start ntpd\n$ ntpq -p\n     remote           refid      st t when poll reach   delay   offset  jitter\n==============================================================================\n*ntp-a3.nict.go. .NICT.           1 u   29   64  177    2.445  -12.927   7.649\n+ntp1.jst.mfeed. 172.29.2.50      2 u   21   64  177    2.361   -9.481   4.574\n+ntp2.jst.mfeed. 172.16.176.60    2 u   20   64  177    2.330  -10.254   4.722\n-ntp3.jst.mfeed. 133.243.236.17   2 u   22   64  177    2.913   -4.273   5.107\n\n\n\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u65e5\u672c\u306b\u66f8\u304d\u63db\u3048\n$ sudo timedatectl set-timezone Asia/Tokyo\n$ timedatectl status\n$ timedatectl status\n      Local time: Wed 2015-04-15 16:39:04 JST\n  Universal time: Wed 2015-04-15 07:39:04 UTC\n        Timezone: Asia/Tokyo (JST, +0900)\n     NTP enabled: yes\nNTP synchronized: yes\n RTC in local TZ: no\n      DST active: n/a\n\n\nPHP5.4\u53ca\u3073PHP-FPM\u95a2\u9023\u30d7\u30ed\u30b0\u30e9\u30e0\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nPHP\u95a2\u9023\u30d7\u30ed\u30b0\u30e9\u30e0\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install -y epel-release\n$ sudo rpm -ivh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\n$ sudo yum install -y yum install -y php php-fpm php-intl php-mbstring php-mysql php-pdo php-pear php-pecl-apc php-process php-xml php-xdebug php-xhprof php-opcache\n$ sudo cp -a /usr/share/doc/php-common-5.4.16/php.ini-production /etc/php.ini\n$ sudo sed -i \"s|;date.timezone =|date.timezone = Asia/Tokyo|g\" /etc/php.ini\n$ sudo echo 'xdebug.max_nesting_level = 250' >> /etc/php.d/xdebug.ini\n\n\u203bSymfony2\u306e\u958b\u767a\u74b0\u5883\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u7528\u306a\u306e\u3067\u9069\u6642PHP\u306e\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306f\u66f8\u304d\u63db\u3048\u308b\u4e8b\u3002\n\nPHP-FPM\u8a2d\u5b9a\n$ sudo sed -i \"s|user = apache|user = nginx|g\" /etc/php-fpm.d/www.conf\n$ sudo sed -i \"s|group= apache|group= nginx|g\" /etc/php-fpm.d/www.conf\n\n\nPHP-FPM\u8d77\u52d5\u8a2d\u5b9a\n$ sudo systemctl enable php-fpm\n$ sudo systemctl start php-fpm\n$ sudo systemctl status php-fpm\nphp-fpm.service - The PHP FastCGI Process Manager\n   Loaded: loaded (/usr/lib/systemd/system/php-fpm.service; enabled)\n   Active: active (running) since Tue 2015-04-21 05:28:21 JST; 3h 40min ago\n Main PID: 1498 (php-fpm)\n   Status: \"Processes active: 0, idle: 5, Requests: 16, slow: 0, Traffic: 0req/sec\"\n   CGroup: /system.slice/php-fpm.service\n           \u251c\u25001498 php-fpm: master process (/etc/php-fpm.conf)\n           \u251c\u25001500 php-fpm: pool www\n           \u251c\u25001501 php-fpm: pool www\n           \u251c\u25001502 php-fpm: pool www\n           \u251c\u25001503 php-fpm: pool www\n           \u2514\u25001504 php-fpm: pool www\n\nApr 21 05:28:21 ip-172-31-19-117 systemd[1]: Starting The PHP FastCGI Process Manager...\nApr 21 05:28:21 ip-172-31-19-117 systemd[1]: Started The PHP FastCGI Process Manager.\n\n\nMariaDB\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nMariaDB\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install -y mariadb mariadb-server\n\n\nMariaDB\u8a2d\u5b9a\n$ cp -a /usr/share/mysql/my-large.cnf /etc/my.cnf\n$ sudo sed -i \"s|#innodb_data_home_dir = /var/lib/mysql|innodb_data_home_dir = /var/lib/mysql|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_data_file_path = ibdata1:10M:autoextend|innodb_data_file_path = ibdata1:100M:autoextend|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_log_group_home_dir = /var/lib/mysql|innodb_log_group_home_dir = /var/lib/mysql|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_buffer_pool_size = 256M|innodb_buffer_pool_size = 256M|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_additional_mem_pool_size = 20M|innodb_additional_mem_pool_size = 20M|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_log_file_size = 64M|innodb_log_file_size = 64M|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_log_buffer_size = 8M|innodb_log_buffer_size = 8M|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_flush_log_at_trx_commit = 1|innodb_flush_log_at_trx_commit = 1|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_lock_wait_timeout = 50|innodb_lock_wait_timeout = 50|g\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a innodb_file_format = Barracuda\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a innodb_file_per_table = 1\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a innodb_flush_method=O_DIRECT\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a default-storage-engine = InnoDB\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a character-set-server = utf8\" /etc/my.cnf\n\n\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u8a2d\u5b9a\u3059\u308b\n\n\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb   \u642d\u8f09\u30e1\u30e2\u30ea \u7528\u9014\nmy-small.cnf   \u301c64MB \u5c0f\u898f\u6a21\u306aDB\nmy-medium.cnf  \u301c128MB    \u5171\u7528\u30b5\u30fc\u30d0\u3067\u306e\u5c0f\u898f\u6a21\u306aDB\nmy-large.cnf   \u301c512MB    MySQL\u3092\u4e3b\u3068\u3059\u308b\u30b5\u30fc\u30d0\nmy-huge.cnf    1G\u301c2G MySQL\u5c02\u7528\u30b5\u30fc\u30d0\nmy-innodb-heavy-4G.cnf 4G  InnoDB\u30e1\u30a4\u30f3\u3068\u3059\u308b\u30b5\u30fc\u30d0\n\n\nMariaDB\u8d77\u52d5\u8a2d\u5b9a\n$ sudo systemctl enable mariadb\n$ sudo systemctl start mariadb\n$ sudo systemctl status mariadb\nmariadb.service - MariaDB database server\n   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; enabled)\n   Active: active (running) since Tue 2015-04-21 05:17:04 JST; 3h 52min ago\n Main PID: 802 (mysqld_safe)\n   CGroup: /system.slice/mariadb.service\n           \u251c\u2500 802 /bin/sh /usr/bin/mysqld_safe --basedir=/usr\n           \u2514\u25001374 /usr/libexec/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib64/mysql/plugin --log-error=/var/lib/mysql/ip-172-31-...\n\nApr 21 05:16:58 ip-172-31-19-117 systemd[1]: Starting MariaDB database server...\nApr 21 05:16:58 ip-172-31-19-117 mysqld_safe[802]: 150421 05:16:58 mysqld_safe Logging to '/var/lib/mysql/ip-172-31-19-117.err'.\nApr 21 05:16:59 ip-172-31-19-117 mysqld_safe[802]: 150421 05:16:58 mysqld_safe Starting mysqld daemon with databases from /var/lib/mysql\nApr 21 05:17:04 ip-172-31-19-117 systemd[1]: Started MariaDB database server.\n\n\nNginx\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nNginx\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ sudo yum install -y nginx \n\n\nNginx \u30b5\u30fc\u30d0\u521d\u671f\u8a2d\u5b9a\n$ sudo cat <<_EOF_ > /etc/nginx/nginx.conf\nuser  nginx;\nworker_processes  1; #\u3000CPU\u306e\u6570\u306b\u5408\u308f\u305b\u308b\n\n#error_log  /var/log/nginx/error.log;\n#error_log  /var/log/nginx/error.log  warn;\n#error_log  /var/log/nginx/error.log  notice;\n#error_log  /var/log/nginx/error.log  info;\npid        /var/run/nginx.pid;\n\nevents {\n    worker_connections  2048;\n}\n\nhttp {\n    #server_tokens off; #\u672c\u756a\u74b0\u5883\u306e\u5834\u5408\u3001\u30b3\u30e1\u30f3\u30c8\u5916\u3059\n\n    # default log format\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    # default access log\n    access_log  /var/log/nginx/access.log  main;\n\n    # don't rely on the kernel's sendfile() this is more efficient.\n    sendfile        on;\n    tcp_nopush      on;\n    tcp_nodelay     on;\n\n    # allow user agents to keep a connection open with us.\n    keepalive_timeout         10;\n    client_header_timeout     10;\n    client_body_timeout       10;\n    reset_timedout_connection on;\n    send_timeout              10;\n\n    limit_conn_zone $binary_remote_addr zone=addr:10m;\n    limit_conn addr 100;\n\n    include       /etc/nginx/mime.types;\n    default_type  text/html;\n\n    # deliver content faster with gzip.\n    gzip              on;\n    gzip_http_version 1.0;\n    gzip_disable      \"msie6\";\n    gzip_vary         on; # \u672c\u756a\u74b0\u5883\u306e\u5834\u5408\u3001off\n    #gzip_proxied      any; # Proxy\u5229\u7528\u306e\u5834\u5408\u3001\u6709\u52b9\u5316\n    gzip_min_length 1024;\n    gzip_comp_level 6;\n    gzip_types      text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript application/javascript;\n\n    # cache the open file descriptors\n    open_file_cache max=10000 inactive=20s;\n    open_file_cache_valid    30s;\n    open_file_cache_min_uses 2;\n    open_file_cache_errors   on;\n\n    # allow 20Mb as max upload size.\n    client_body_buffer_size 20M;\n\n    include /etc/nginx/conf.d/*.conf;\n}\n_EOF_\n$ sudo sed -i \"s|#location ~ \\.php$ {|location ~ \\.php$ {|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i -e \"/server_name  localhost;/a root   /usr/share/nginx/html;\" /etc/my.cnf\n$ sudo sed -i \"s|#fastcgi_pass   127.0.0.1:9000;|fastcgi_pass   127.0.0.1:9000;|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i \"s|#fastcgi_index  index.php;|fastcgi_index  index.php;|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i \"s|#fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;|fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i \"s|#include        fastcgi_params;|include        fastcgi_params;|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i -e \"/include        fastcgi_params;$/a }\" /etc/default.conf\n\n\nNginx\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n$ sudo systemctl enable nginx\n$ sudo systemctl start nginx\n$ sudo systemctl status nginx\nnginx.service - nginx - high performance web server\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; disabled)\n   Active: active (running) since Tue 2015-04-21 08:46:26 JST; 23min ago\n     Docs: http://nginx.org/en/docs/\n  Process: 1967 ExecStop=/bin/kill -s QUIT $MAINPID (code=exited, status=0/SUCCESS)\n  Process: 1972 ExecStart=/usr/sbin/nginx -c /etc/nginx/nginx.conf (code=exited, status=0/SUCCESS)\n  Process: 1971 ExecStartPre=/usr/sbin/nginx -t -c /etc/nginx/nginx.conf (code=exited, status=0/SUCCESS)\n Main PID: 1974 (nginx)\n   CGroup: /system.slice/nginx.service\n           \u251c\u25001974 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf\n           \u2514\u25001975 nginx: worker process\n\nApr 21 08:46:26 ip-172-31-19-117 systemd[1]: Starting nginx - high performance web server...\nApr 21 08:46:26 ip-172-31-19-117 nginx[1971]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nApr 21 08:46:26 ip-172-31-19-117 nginx[1971]: nginx: configuration file /etc/nginx/nginx.conf test is successful\nApr 21 08:46:26 ip-172-31-19-117 systemd[1]: Failed to read PID from file /run/nginx.pid: Invalid argument\nApr 21 08:46:26 ip-172-31-19-117 systemd[1]: Started nginx - high performance web server.\n\n\n\u8868\u793a\u78ba\u8a8d\n$ sudo cat <<_EOF_ > /usr/share/nginx/html/phpinfo.php\n<?php\n   phpinfo();\n_EOF_\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u30b5\u30fc\u30d0IP\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068phpinfo\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n\n\u53c2\u8003URL\nCentOS\u306bnginx, php-fpm, mysql\u306e\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff11\nhttp://qiita.com/puttyo_bubu/items/5bf554ef2790f6435c32\n# OS\u72b6\u6cc1\u78ba\u8a8d\n\nCentOS 7 (x86_64) with Updates HVM\nhttps://aws.amazon.com/marketplace/pp/B00O7WM7QW\n\u203buser:'centos'\n\n# OS\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n```shell-session\n$ yum -y update\n$ yum -y install wget ntp mlocate\n```\n\n## \u6642\u523b\u30b5\u30fc\u30d0\u8a2d\u5b9a\n```shell-session\n$ sed -i \"s/server 0.centos.pool.ntp.org iburst/server -4 ntp.nict.jp iburst/g\" /etc/ntp.conf\n$ sed -i \"s/server 1.centos.pool.ntp.org iburst/server -4 ntp1.jst.mfeed.ad.jp iburst/g\" /etc/ntp.conf\n$ sed -i \"s/server 2.centos.pool.ntp.org iburst/server -4 ntp2.jst.mfeed.ad.jp iburst/g\" /etc/ntp.conf\n$ sed -i \"s/server 3.centos.pool.ntp.org iburst/server -4 ntp3.jst.mfeed.ad.jp iburst/g\" /etc/ntp.conf\n```\n\n## NTP\u30b5\u30fc\u30d0\u8d77\u52d5\n\n```shell-session\n$ sudo systemctl enable ntpd\n$ sudo systemctl start ntpd\n$ ntpq -p\n     remote           refid      st t when poll reach   delay   offset  jitter\n==============================================================================\n*ntp-a3.nict.go. .NICT.           1 u   29   64  177    2.445  -12.927   7.649\n+ntp1.jst.mfeed. 172.29.2.50      2 u   21   64  177    2.361   -9.481   4.574\n+ntp2.jst.mfeed. 172.16.176.60    2 u   20   64  177    2.330  -10.254   4.722\n-ntp3.jst.mfeed. 133.243.236.17   2 u   22   64  177    2.913   -4.273   5.107\n```\n\n#\u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u3092\u65e5\u672c\u306b\u66f8\u304d\u63db\u3048\n\n```shell-session\n$ sudo timedatectl set-timezone Asia/Tokyo\n$ timedatectl status\n$ timedatectl status\n      Local time: Wed 2015-04-15 16:39:04 JST\n  Universal time: Wed 2015-04-15 07:39:04 UTC\n        Timezone: Asia/Tokyo (JST, +0900)\n     NTP enabled: yes\nNTP synchronized: yes\n RTC in local TZ: no\n      DST active: n/a\n```\n\n# PHP5.4\u53ca\u3073PHP-FPM\u95a2\u9023\u30d7\u30ed\u30b0\u30e9\u30e0\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n##PHP\u95a2\u9023\u30d7\u30ed\u30b0\u30e9\u30e0\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session\n$ sudo yum install -y epel-release\n$ sudo rpm -ivh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\n$ sudo yum install -y yum install -y php php-fpm php-intl php-mbstring php-mysql php-pdo php-pear php-pecl-apc php-process php-xml php-xdebug php-xhprof php-opcache\n$ sudo cp -a /usr/share/doc/php-common-5.4.16/php.ini-production /etc/php.ini\n$ sudo sed -i \"s|;date.timezone =|date.timezone = Asia/Tokyo|g\" /etc/php.ini\n$ sudo echo 'xdebug.max_nesting_level = 250' >> /etc/php.d/xdebug.ini\n```\n\u203bSymfony2\u306e\u958b\u767a\u74b0\u5883\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u7528\u306a\u306e\u3067\u9069\u6642PHP\u306e\u30a8\u30af\u30b9\u30c6\u30f3\u30b7\u30e7\u30f3\u306f\u66f8\u304d\u63db\u3048\u308b\u4e8b\u3002\n\n## PHP-FPM\u8a2d\u5b9a\n\n```shell-session\n$ sudo sed -i \"s|user = apache|user = nginx|g\" /etc/php-fpm.d/www.conf\n$ sudo sed -i \"s|group= apache|group= nginx|g\" /etc/php-fpm.d/www.conf\n```\n\n## PHP-FPM\u8d77\u52d5\u8a2d\u5b9a\n\n```shell-session\n$ sudo systemctl enable php-fpm\n$ sudo systemctl start php-fpm\n$ sudo systemctl status php-fpm\nphp-fpm.service - The PHP FastCGI Process Manager\n   Loaded: loaded (/usr/lib/systemd/system/php-fpm.service; enabled)\n   Active: active (running) since Tue 2015-04-21 05:28:21 JST; 3h 40min ago\n Main PID: 1498 (php-fpm)\n   Status: \"Processes active: 0, idle: 5, Requests: 16, slow: 0, Traffic: 0req/sec\"\n   CGroup: /system.slice/php-fpm.service\n           \u251c\u25001498 php-fpm: master process (/etc/php-fpm.conf)\n           \u251c\u25001500 php-fpm: pool www\n           \u251c\u25001501 php-fpm: pool www\n           \u251c\u25001502 php-fpm: pool www\n           \u251c\u25001503 php-fpm: pool www\n           \u2514\u25001504 php-fpm: pool www\n\nApr 21 05:28:21 ip-172-31-19-117 systemd[1]: Starting The PHP FastCGI Process Manager...\nApr 21 05:28:21 ip-172-31-19-117 systemd[1]: Started The PHP FastCGI Process Manager.\n```\n\n# MariaDB\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n## MariaDB\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session\n$ sudo yum install -y mariadb mariadb-server\n```\n\n## MariaDB\u8a2d\u5b9a\n\n```shell-session\n$ cp -a /usr/share/mysql/my-large.cnf /etc/my.cnf\n$ sudo sed -i \"s|#innodb_data_home_dir = /var/lib/mysql|innodb_data_home_dir = /var/lib/mysql|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_data_file_path = ibdata1:10M:autoextend|innodb_data_file_path = ibdata1:100M:autoextend|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_log_group_home_dir = /var/lib/mysql|innodb_log_group_home_dir = /var/lib/mysql|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_buffer_pool_size = 256M|innodb_buffer_pool_size = 256M|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_additional_mem_pool_size = 20M|innodb_additional_mem_pool_size = 20M|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_log_file_size = 64M|innodb_log_file_size = 64M|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_log_buffer_size = 8M|innodb_log_buffer_size = 8M|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_flush_log_at_trx_commit = 1|innodb_flush_log_at_trx_commit = 1|g\" /etc/my.cnf\n$ sudo sed -i \"s|#innodb_lock_wait_timeout = 50|innodb_lock_wait_timeout = 50|g\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a innodb_file_format = Barracuda\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a innodb_file_per_table = 1\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a innodb_flush_method=O_DIRECT\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a default-storage-engine = InnoDB\" /etc/my.cnf\n$ sudo sed -i -e \"/^innodb_lock_wait_timeout = 50$/a character-set-server = utf8\" /etc/my.cnf\n```\n\n\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u8a2d\u5b9a\u3059\u308b\n\n>\u30b5\u30f3\u30d7\u30eb\u30d5\u30a1\u30a4\u30eb\t\u642d\u8f09\u30e1\u30e2\u30ea\t\u7528\u9014\n>my-small.cnf\t\u301c64MB\t\u5c0f\u898f\u6a21\u306aDB\n>my-medium.cnf\t\u301c128MB\t\u5171\u7528\u30b5\u30fc\u30d0\u3067\u306e\u5c0f\u898f\u6a21\u306aDB\n>my-large.cnf\t\u301c512MB\tMySQL\u3092\u4e3b\u3068\u3059\u308b\u30b5\u30fc\u30d0\n>my-huge.cnf\t1G\u301c2G\tMySQL\u5c02\u7528\u30b5\u30fc\u30d0\n>my-innodb-heavy-4G.cnf\t4G\tInnoDB\u30e1\u30a4\u30f3\u3068\u3059\u308b\u30b5\u30fc\u30d0\n\n## MariaDB\u8d77\u52d5\u8a2d\u5b9a\n\n```shell-session\n$ sudo systemctl enable mariadb\n$ sudo systemctl start mariadb\n$ sudo systemctl status mariadb\nmariadb.service - MariaDB database server\n   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; enabled)\n   Active: active (running) since Tue 2015-04-21 05:17:04 JST; 3h 52min ago\n Main PID: 802 (mysqld_safe)\n   CGroup: /system.slice/mariadb.service\n           \u251c\u2500 802 /bin/sh /usr/bin/mysqld_safe --basedir=/usr\n           \u2514\u25001374 /usr/libexec/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib64/mysql/plugin --log-error=/var/lib/mysql/ip-172-31-...\n\nApr 21 05:16:58 ip-172-31-19-117 systemd[1]: Starting MariaDB database server...\nApr 21 05:16:58 ip-172-31-19-117 mysqld_safe[802]: 150421 05:16:58 mysqld_safe Logging to '/var/lib/mysql/ip-172-31-19-117.err'.\nApr 21 05:16:59 ip-172-31-19-117 mysqld_safe[802]: 150421 05:16:58 mysqld_safe Starting mysqld daemon with databases from /var/lib/mysql\nApr 21 05:17:04 ip-172-31-19-117 systemd[1]: Started MariaDB database server.\n```\n\n# Nginx\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n## Nginx\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```shell-session\n$ sudo yum install -y nginx \n```\n\n## Nginx \u30b5\u30fc\u30d0\u521d\u671f\u8a2d\u5b9a\n\n```shell-session\n$ sudo cat <<_EOF_ > /etc/nginx/nginx.conf\nuser  nginx;\nworker_processes  1; #\u3000CPU\u306e\u6570\u306b\u5408\u308f\u305b\u308b\n\n#error_log  /var/log/nginx/error.log;\n#error_log  /var/log/nginx/error.log  warn;\n#error_log  /var/log/nginx/error.log  notice;\n#error_log  /var/log/nginx/error.log  info;\npid        /var/run/nginx.pid;\n\nevents {\n    worker_connections  2048;\n}\n\nhttp {\n    #server_tokens off; #\u672c\u756a\u74b0\u5883\u306e\u5834\u5408\u3001\u30b3\u30e1\u30f3\u30c8\u5916\u3059\n\n    # default log format\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    # default access log\n    access_log  /var/log/nginx/access.log  main;\n\n    # don't rely on the kernel's sendfile() this is more efficient.\n    sendfile        on;\n    tcp_nopush      on;\n    tcp_nodelay     on;\n\n    # allow user agents to keep a connection open with us.\n    keepalive_timeout         10;\n    client_header_timeout     10;\n    client_body_timeout       10;\n    reset_timedout_connection on;\n    send_timeout              10;\n\n    limit_conn_zone $binary_remote_addr zone=addr:10m;\n    limit_conn addr 100;\n\n    include       /etc/nginx/mime.types;\n    default_type  text/html;\n\n    # deliver content faster with gzip.\n    gzip              on;\n    gzip_http_version 1.0;\n    gzip_disable      \"msie6\";\n    gzip_vary         on; # \u672c\u756a\u74b0\u5883\u306e\u5834\u5408\u3001off\n    #gzip_proxied      any; # Proxy\u5229\u7528\u306e\u5834\u5408\u3001\u6709\u52b9\u5316\n    gzip_min_length 1024;\n    gzip_comp_level 6;\n    gzip_types      text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript application/javascript;\n\n    # cache the open file descriptors\n    open_file_cache max=10000 inactive=20s;\n    open_file_cache_valid    30s;\n    open_file_cache_min_uses 2;\n    open_file_cache_errors   on;\n\n    # allow 20Mb as max upload size.\n    client_body_buffer_size 20M;\n\n    include /etc/nginx/conf.d/*.conf;\n}\n_EOF_\n$ sudo sed -i \"s|#location ~ \\.php$ {|location ~ \\.php$ {|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i -e \"/server_name  localhost;/a root   /usr/share/nginx/html;\" /etc/my.cnf\n$ sudo sed -i \"s|#fastcgi_pass   127.0.0.1:9000;|fastcgi_pass   127.0.0.1:9000;|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i \"s|#fastcgi_index  index.php;|fastcgi_index  index.php;|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i \"s|#fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;|fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i \"s|#include        fastcgi_params;|include        fastcgi_params;|g\" /etc/nginx/conf.d/default.conf\n$ sudo sed -i -e \"/include        fastcgi_params;$/a }\" /etc/default.conf\n```\n\n## Nginx\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n\n```shell-session\n$ sudo systemctl enable nginx\n$ sudo systemctl start nginx\n$ sudo systemctl status nginx\nnginx.service - nginx - high performance web server\n   Loaded: loaded (/usr/lib/systemd/system/nginx.service; disabled)\n   Active: active (running) since Tue 2015-04-21 08:46:26 JST; 23min ago\n     Docs: http://nginx.org/en/docs/\n  Process: 1967 ExecStop=/bin/kill -s QUIT $MAINPID (code=exited, status=0/SUCCESS)\n  Process: 1972 ExecStart=/usr/sbin/nginx -c /etc/nginx/nginx.conf (code=exited, status=0/SUCCESS)\n  Process: 1971 ExecStartPre=/usr/sbin/nginx -t -c /etc/nginx/nginx.conf (code=exited, status=0/SUCCESS)\n Main PID: 1974 (nginx)\n   CGroup: /system.slice/nginx.service\n           \u251c\u25001974 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf\n           \u2514\u25001975 nginx: worker process\n\nApr 21 08:46:26 ip-172-31-19-117 systemd[1]: Starting nginx - high performance web server...\nApr 21 08:46:26 ip-172-31-19-117 nginx[1971]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nApr 21 08:46:26 ip-172-31-19-117 nginx[1971]: nginx: configuration file /etc/nginx/nginx.conf test is successful\nApr 21 08:46:26 ip-172-31-19-117 systemd[1]: Failed to read PID from file /run/nginx.pid: Invalid argument\nApr 21 08:46:26 ip-172-31-19-117 systemd[1]: Started nginx - high performance web server.\n```\n\n# \u8868\u793a\u78ba\u8a8d\n\n```shell-session\n$ sudo cat <<_EOF_ > /usr/share/nginx/html/phpinfo.php\n<?php\n   phpinfo();\n_EOF_\n```\n\n\u30d6\u30e9\u30a6\u30b6\u3067\u30b5\u30fc\u30d0IP\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068phpinfo\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n![phpinfo\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002](https://qiita-image-store.s3.amazonaws.com/0/19439/8a2195a4-c57e-401b-d5ba-0c81d6f762d2.png)\n\n\n# \u53c2\u8003URL\nCentOS\u306bnginx, php-fpm, mysql\u306e\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\uff11\nhttp://qiita.com/puttyo_bubu/items/5bf554ef2790f6435c32\n", "tags": ["CentOS7.1", "php-fpm5.4.16", "PHP5.4.16", "nginx1.6.3", "mariadb1.55"]}