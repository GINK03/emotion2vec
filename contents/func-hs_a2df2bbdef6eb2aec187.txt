{"context": " More than 1 year has passed since last update.(\u65e5\u4ed8\u3092\u307e\u305f\u3044\u3067\u3057\u307e\u3063\u3066\u7533\u3057\u8a33\u306a\u3044\u2026)\nClojure Advent Calendar 2015 25\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n\u306f\u3058\u3081\u306b\n\u524d\u56de\u306e\u8a18\u4e8b\u304b\u3089\u65e91\u5e74\u3002Clojure \u672c\u4f53\u3092\u542b\u3081\u3001\u8907\u6570\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u65b0\u3057\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n\u524d\u56de\u304b\u3089\u306e\u5909\u66f4\u70b9\n\n\u30b2\u30b9\u30c8OS\u3092 wheezy \u304b\u3089 jessie \u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u307e\u3057\u305f\u3002\n\u4e0b\u8a18\u306e\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3057\u307e\u3057\u305f\n\n\nclojure: 1.6 -> 1.7\ndata.json: 0.2.5 -> 0.2.6\njava.jdbc: 0.3.6 -> 0.4.2\ncompojure: 1.3.1 -> 1.4.0 (\u6ce8: clojure 1.5.1 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b)\nlib-noir: 0.9.5 -> 0.9.9 (\u6ce8: clojure 1.6.0 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b)\nclj-http: 1.0.1 -> 2.0.0\nclj-oauth: 1.5.1 -> 1.5.3 (\u6ce8: clojure 1.6.0, clj-http 1.0.1, commons-codec 1.8 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b)\nlein-ring: 0.8.13 -> 0.9.7\nlein-auto: 0.1.1 -> 0.1.2\ncodox: 0.8.10 -> 0.9.0\nring-mock: 0.2.5 -> 0.3.0\n\n\n\n\u3055\u3066\u3053\u306e\u5185\u3001\u6700\u65b0\u306e clojure \u672c\u4f53\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3044\u304f\u3064\u304b\u3042\u308a\u307e\u3059\u3002\u52a0\u3048\u3066\u3001 clj-oauth \u306f clj-http \u306e\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3082\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u307e\u307e\u3067\u306f\u8907\u6570\u306e\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u540c\u6642\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3067\u3057\u3087\u3046\u3002\u3053\u306e\u3053\u3068\u306b\u3088\u308a\u3001\u958b\u767a\u3092\u884c\u3046\u4e0a\u3067\u554f\u984c\u3068\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u79c1\u9054\u306b\u306f\u4e0d\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3059\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u9055\u3044\u3067\u7121\u99c4\u306b\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5897\u3048\u305f\u308a\u3059\u308b\u3068\u5f8c\u3067\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u624b\u9593\u304c\u5897\u3048\u307e\u3059(\u30c7\u30a3\u30b9\u30af\u3082\u5727\u8feb\u3057\u307e\u3059\u3057\u306d)\u3002\u3053\u306e\u3088\u3046\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u3001\u305d\u3082\u305d\u3082\u521d\u3081\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u3044\u3067\u304a\u304f\u3088\u3046\u306b\u3059\u308b\u306b\u9650\u308a\u307e\u3059\u3002\n\n\u4e0d\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u9664\u5916\n\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u4e2d\u304b\u3089\u4e0d\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5207\u308a\u96e2\u3059\u306b\u306f\u3001 project.clj \u5185\u306b :exclusions \u30ad\u30fc\u3092\u8ffd\u8a18\u3057\u3001\u305d\u306e\u5024\u3068\u3057\u3066\u9664\u5916\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092 vector \u306b\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\u307e\u305a\u3001\u524d\u56de\u306e\u8a18\u4e8b\u3067 project.clj \u304c\u3069\u3046\u66f8\u304b\u308c\u3066\u3044\u305f\u304b\u3092\u601d\u3044\u51fa\u3057\u307e\u3057\u3087\u3046\u3002\n(defproject <project-name> \"0.1.0-SNAPSHOT\"\n  :descriptions \"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6982\u8981\"\n  :url          \"\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u4fdd\u7ba1\u3057\u3066\u3044\u308b\u30ea\u30dd\u30b8\u30c8\u30ea\u306a\u3069\u306eURL\"\n  :license      {:name \"\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u5f93\u5c5e\u3059\u308b\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u540d\u524d\"\n                 :url \"\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u6761\u6587\u304c\u7f6e\u304b\u308c\u3066\u3044\u308b\u30b5\u30a4\u30c8\u306eURL\"}\n  :dependencies [[org.clojure/clojure \"1.6.0\"]\n                 [org.clojure/data.json \"0.2.5\"]\n                 [org.clojure/java.jdbc \"0.3.6\"]\n                 [compojure \"1.3.1\"]\n                 [hiccup \"1.0.5\"]\n                 [lib-noir \"0.9.5\"]\n                 [clj-http \"1.0.1\"]\n                 [clj-oauth \"1.5.1\"]]\n  :plugins       [[lein-ring \"0.8.13\"]\n                  [lein-auto \"0.1.1\"]\n                  [codox \"0.8.10\"]]\n  :ring          {:handler <project-name>.core.handler/app}\n  :profiles      {:dev {:dependencies [[javax.servlet/servlet-api \"2.5\"]\n                                       [ring/ring-mock \"0.2.5\"]]}})\n\n\u3053\u308c\u3092\n(defproject <project-name> \"0.1.0-SNAPSHOT\"\n  :descriptions \"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6982\u8981\"\n  :url          \"\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u4fdd\u7ba1\u3057\u3066\u3044\u308b\u30ea\u30dd\u30b8\u30c8\u30ea\u306a\u3069\u306eURL\"\n  :license      {:name \"\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u5f93\u5c5e\u3059\u308b\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u540d\u524d\"\n                 :url \"\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u6761\u6587\u304c\u7f6e\u304b\u308c\u3066\u3044\u308b\u30b5\u30a4\u30c8\u306eURL\"}\n  :exclusions   [org.clojure/clojure]\n  :dependencies [[org.clojure/clojure \"1.7.0\"]\n                 [org.clojure/data.json \"0.2.6\"]\n                 [org.clojure/java.jdbc \"0.4.2\"]\n                 [compojure \"1.4.0\"]\n                 [hiccup \"1.0.5\"]\n                 [lib-noir \"0.9.9\"]\n                 [clj-http \"2.0.0\"]\n                 [clj-oauth \"1.5.3\" :exclusions [clj-http commons-codec]]]\n  :plugins       [[lein-ring \"0.9.7\"]\n                  [lein-auto \"0.1.2\"]\n                  [codox \"0.9.0\"]]\n  :ring          {:handler <project-name>.core.handler/app}\n  :profiles      {:dev {:dependencies [[javax.servlet/servlet-api \"2.5\"]\n                                       [ring/ring-mock \"0.3.0\"]]}})\n\n\u3053\u3046\u3057\u307e\u3059\u3002\n\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u306b\u3042\u308b :exclusions \u306f\u3001\u81ea\u5206\u81ea\u8eab\u3092\u542b\u3081\u3066\u3001\u305d\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3059\u3079\u3066\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089\u6307\u5b9a\u3057\u305f\u4f9d\u5b58\u3092\u53d6\u308a\u9664\u304d\u307e\u3059\u3002\u4eca\u56de\u306f\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u3067\u4e00\u5ea6 clojure \u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u9664\u304f\u3088\u3046\u306b\u6307\u5b9a\u3057\u3064\u3064 clojure \u672c\u4f53\u3078\u306e\u4f9d\u5b58\u3092\u8a18\u8ff0\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3059\u3079\u3066\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089 clojure \u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u53d6\u308a\u9664\u304d\u3001\u305d\u306e\u5f8c\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u81ea\u8eab\u3060\u3051\u304c clojure 1.7 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3068\u3044\u3046\u72b6\u614b\u3092\u4f5c\u308a\u51fa\u3059\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u5358\u4f4d(\u4eca\u56de\u306f clj-oauth )\u3067\u8a18\u8ff0\u3055\u308c\u308b :exclusions \u306f\u305d\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u4e2d\u304b\u3089\u3060\u3051\u6307\u5b9a\u3057\u305f\u4f9d\u5b58\u3092\u53d6\u308a\u9664\u304d\u307e\u3059\u3002\n\n\u30c4\u30a4\u30fc\u30c8\u306e\u30c7\u30b6\u30a4\u30f3\n\u3055\u3066\u3001\u305d\u308c\u3067\u306f\u30a6\u30a7\u30d6\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u30c7\u30b6\u30a4\u30f3\u3057\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u4eca\u56de\u306fDisplay Requirement\u306b\u53ef\u80fd\u306a\u9650\u308a\u6e96\u62e0\u3059\u308b\u305f\u3081\u306b\u3001\u30a6\u30a7\u30d6\u3067\u306e\u30c4\u30a4\u30fc\u30c8\u8868\u793a\u3092\u6a21\u5023\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\nhiccup \u3068 vector\n\u30ec\u30a4\u30a2\u30a6\u30c8\u3092\u6574\u7406\u3057\u307e\u3057\u3087\u3046\u3002\u307e\u305a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a4\u884c\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u306e\u306f\u3059\u3050\u306b\u60f3\u50cf\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\n1\u884c\u76ee: \u30e6\u30fc\u30b6\u60c5\u5831\n2\u884c\u76ee: \u672c\u6587\n3\u884c\u76ee: \u6295\u7a3f\u65e5\n4\u884c\u76ee: \u5404\u7a2e\u30b3\u30de\u30f3\u30c9\u30a2\u30a4\u30b3\u30f3\n\n\u3053\u308c\u3089\u306e\u69cb\u9020\u3092 hiccup \u304c\u89e3\u91c8\u3067\u304d\u308b vector \u306e\u5f62\u3067\u8868\u73fe\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n[:div.tweet [:div.user]\n            [:div.text]\n            [:div.created_at]\n            [:div.actions]]\n\n\u3053\u306e4\u884c\u306e vector \u305d\u308c\u305e\u308c\u306e\u5185\u5074\u306b\u3001\u5b9f\u969b\u306b\u8868\u793a\u3059\u308b\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u633f\u5165\u3057\u3066\u3044\u304d\u307e\u3059\u3002\u30ad\u30fc\u30ef\u30fc\u30c9\u306e\u540d\u524d\u306e\u5185\u3001# \u3084 . \u306e\u524d\u306b\u3042\u308b\u90e8\u5206\u304c\u30bf\u30b0\u306e\u8981\u7d20\u540d\u3067\u3059\u3002\u8981\u7d20\u540d\u306b # \u304c\u7d9a\u304f\u5834\u5408\u306f\u3001\u305d\u306e\u8981\u7d20\u306b id \u5c5e\u6027\u304c\u5272\u308a\u632f\u3089\u308c\u3001 . \u304c\u7d9a\u304f\u5834\u5408\u306f class \u5c5e\u6027\u304c\u5272\u308a\u632f\u3089\u308c\u307e\u3059\u3002\u305d\u308c\u4ee5\u5916\u306e\u5c5e\u6027\u3092\u4ed8\u4e0e\u3059\u308b\u5834\u5408\u306f\u3001\u305d\u306e\u8981\u7d20\u3068\u540c\u3058 vector \u306e\u4e2d\u306b Map \u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\n[:div.tweet {:data-role \"list\"} some-content]\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u3002\u4eca\u56de\u306f\u3001\u524d\u56de\u306e\u8a18\u4e8b\u3068\u4f75\u305b\u3066\u30c6\u30b9\u30c8\u306e\u66f8\u304d\u65b9\u3068 Clojure \u81ea\u4f53\u3067\u306e\u30a6\u30a7\u30d6\u30b3\u30f3\u30c6\u30f3\u30c4\u306e\u751f\u6210\u306e\u4ed5\u65b9\u306b\u7740\u76ee\u3059\u308b\u305f\u3081\u3001 CSS \u306e\u5185\u5bb9\u306f\u4e00\u65e6\u5f8c\u56de\u3057\u306b\u3057\u307e\u3057\u3087\u3046(\u307e\u305f\u5f8c\u306e\u8a18\u4e8b\u3067\u8a73\u3057\u304f\u8ffd\u3063\u3066\u3044\u304d\u307e\u3059)\u3002\u3053\u306e\u69cb\u9020\u306b\u5b9f\u969b\u306e\u30c4\u30a4\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3057\u3066\u3044\u304d\u307e\u3059\u3002Twitter \u304b\u3089 JSON \u3092\u8cb0\u3063\u3066\u304f\u308b\u90e8\u5206\u306f\u524d\u56de\u306e\u8a18\u4e8b\u3067\u66f8\u3044\u305f\u306e\u3067\u3001\u3042\u308c\u3092\u6398\u308a\u8d77\u3053\u3057\u307e\u3057\u3087\u3046\u3002\u3048\u3048\u3068\u3001\u78ba\u304b\u2026\n(defn- status-show\n  [^long id]\n  (let [url    \"http://api.twitter.com/1.1/statuses/show/\"\n        ; OAuth\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5074\u306b\u30af\u30a8\u30ea\u6587\u5b57\u5217\u306e\u305f\u3081\u306eWrapper\u306f\u306a\u3044\u3002\n        params {:headers      {\"authorization\" (authorization-header (credentials url (str id \".json\")))}\n                :query-params {:id id}}]\n       (http/get url params)))\n\n\u305d\u3046\u305d\u3046\u3001\u3053\u308c\u3067\u3059\u306d\u3002\u4eca\u56de\u306f\u3053\u308c\u3092\n\nURL\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6307\u5b9a\u3055\u308c\u305f id \u3092\u5143\u306b Twitter \u304b\u3089 JSON \u30c7\u30fc\u30bf\u3092\u8cb0\u3063\u3066\u304f\u308b\nJSON \u3092 Clojure \u306e Map \u306b\u5909\u63db\u3059\u308b\nMap \u306e\u4e2d\u306e\u30c7\u30fc\u30bf\u3092\u3082\u3068\u306b\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u751f\u6210\u3059\u308b\n\n\u4e0a\u8a183\u3064\u306e\u6d41\u308c\u306b\u5909\u3048\u307e\u3059\u3002\u3053\u308c\u306b\u4f34\u3044\u3001\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306e\u898b\u76f4\u3057\u3082\u884c\u3044\u307e\u3059\u3002\u4eca\u5ea6\u306fJSON\u304c\u6b63\u3057\u304f\u8fd4\u3063\u3066\u304d\u305f\u304b\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u6307\u5b9a\u3057\u305f id \u306e\u30c4\u30a4\u30fc\u30c8\u3068\u540c\u3058\u5185\u5bb9\u3067 vector \u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u304b\u3001\u305d\u3057\u3066\u305d\u306e vector \u304b\u3089 HTML \u304c\u671f\u5f85\u901a\u308a\u306b\u751f\u6210\u3055\u308c\u3066\u3044\u308b\u304b\u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306e\u4fee\u6b63\n\n\u5b8c\u6210\u5f62\u306e\u30a4\u30e1\u30fc\u30b8\nvector \u306e\u5f62\u3092\u30a4\u30e1\u30fc\u30b8\u3057\u307e\u3057\u3087\u3046\u3002\u5b9f\u88c5\u30b3\u30fc\u30c9\u306b\u9593\u9055\u3044\u304c\u306a\u3051\u308c\u3070\u3001\n; tweet \u3068\u3044\u3046\u540d\u306e JSON \u3092\u53d7\u3051\u53d6\u3063\u305f\u3068\u4eee\u5b9a\u3057\u3066\u2026\n[:div.tweet [:div.user [:a {:href (str \"https://twitter.com/\" (get-in tweet [:user :screen_name]))}\n            ; profile_image_url \u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u6271\u3044\u306f\u3001\u8a2d\u5b9a\u3092\u53c2\u7167\u3057\u3066HTTPS\u306b\u3059\u308b\u304b\u3069\u3046\u304b\u3092\u9078\u629e\u3059\u308b\u3088\u3046\u306b\u306f\u3057\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u308b\u3002\n                           [:img.avatar {:src (get-in tweet [:user :profile_image_url])}]\n                           [:strong.name (get-in tweet [:user :name])]\n                           [:span.screen_name (str \"@\" (get-in tweet [:user :screen_name]))]]]\n            [:div.text (:text tweet)]\n            [:div.created_at (:created_at tweet)]\n            [:div.actions #_\"\u3053\u3053\u306f\u4fdd\u7559\"]]\n\n\u307e\u305a\u3053\u3093\u306a vector \u304c\u751f\u6210\u3055\u308c\u3001\u305d\u308c\u3092 hiccup \u306e html \u30de\u30af\u30ed\u306b\u89e3\u91c8\u3055\u305b\u308b\u3053\u3068\u3067\u6700\u7d42\u7684\u306a HTML \u6587\u5b57\u5217\u304c\u751f\u6210\u3055\u308c\u307e\u3059(\u30a2\u30af\u30b7\u30e7\u30f3\u30dc\u30bf\u30f3\u306e\u3068\u3053\u308d\u306f CSS \u4f9d\u5b58\u306a\u306e\u3067\u5f8c\u56de\u3057\u306b\u3057\u307e\u3059)\u3002\u3053\u306e vector \u306f html \u30de\u30af\u30ed\u306b\u89e3\u91c8\u3055\u305b\u308b\u3068\u3001\n<div class=\"tweet\">\n  <div class=\"user\">\n    <a href=\"https://twitter.com/<screen_name \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u30b9\u30af\u30ea\u30fc\u30f3\u540d>\">\n      <img src=\"<profile_image_url_https \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b URL>\" class=\"avatar\" />\n      <strong class=\"name\">&lt;name \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u30e6\u30fc\u30b6\u540d&gt;</strong>\n      <span class=\"screen_name\">&lt;screen_name \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b screen\u540d&gt;</span>\n    </a>\n  </div>\n  <div class=\"text\">&lt;text \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u30c4\u30a4\u30fc\u30c8\u672c\u6587&gt;</div>\n  <div class=\"created_at\">&lt;created_at \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6295\u7a3f\u65e5(\u8981\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u5909\u63db)&gt;</div>\n  <div class=\"actions\">&lt;\u8fd4\u4fe1\u7b49\u306e\u5404\u7a2e\u30a2\u30af\u30b7\u30e7\u30f3\u30dc\u30bf\u30f3(\u4eca\u56de\u306f\u5f8c\u56de\u3057)&gt;</div></div>\n\n\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059(\u5b9f\u969b\u306b\u306f\u30a4\u30f3\u30c7\u30f3\u30c8\u3055\u308c\u306a\u3044\u3053\u3068\u306b\u6ce8\u610f)\u3002\n\n\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306e\u62e1\u5f35\n\u3053\u308c\u3089\u306e vector \u3068 HTML \u6587\u5b57\u5217\u306e\u30c6\u30b9\u30c8\u3092\u52a0\u3048\u308b\u3068\u3001\u65b0\u3057\u3044\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n(ns <project-name>.core.handler-test\n  (:require [clojure.test :refer :all]\n            [ring.mock.request :as mock]\n            [<project-name>.core.handler :refer :all]\n            [data.json :as json]\n            [oauth.client :as oauth]\n            [clj-http.client :as http]\n            [hiccup.core :as hiccup]))\n\n(deftest test-status\n         ; /<screen_name>/status/xx \u304c Twitter \u3078\u306e\u63a5\u7d9a\u306b\u6210\u529f\u3059\u308b\u304b\u3069\u3046\u304b\u3002\n         ; \u5931\u6557\u3057\u305f\u5834\u5408\u306f\u3001\u4f55\u3089\u304b\u306e\u63a5\u7d9a\u4f8b\u5916\u304b -1 \u304c\u8fd4\u308b\u3060\u308d\u3046\u3002\n         ; \u3053\u3053\u3067\u3001 status \u30d5\u30a3\u30fc\u30eb\u30c9(\u30c4\u30a4\u30fc\u30c8\u306e\u3067\u306f\u306a\u304f\u3001HTTP \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u306e\u65b9)\u3092\u898b\u3064\u3051\u3089\u308c\u306a\u304b\u3063\u305f\u5834\u5408\u306f\n         ; \u660e\u793a\u7684\u306b -1 \u3092\u8fd4\u3059\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\n         (testing \"Tests for connection success:\"\n                  (is (not= -1\n                            (-> (get (app (mock/request :get \"/<screen_name>/status/xx\")))\n                                (get :status -1)))\n                      \"The connection failed.\"))\n         ; /status/:id \u304c\u6b63\u5e38\u306b\u6a5f\u80fd\u3059\u308b\u304b\u3002\u304b\u306a\u308a\u5f37\u5f15\u306a\u3084\u308a\u65b9\u3067\u30c6\u30b9\u30c8\u3057\u3066\u3044\u308b(\u5f8c\u8ff0)\u3002\n         (testing \"Tests for /status/:id:\"\n                  ; \u63a5\u7d9a\u81ea\u4f53\u304c\u6210\u529f\u3057\u3066\u3044\u308c\u3070\u3001\u3044\u305a\u308c\u306e\u5834\u5408\u3082 Twitter \u306f JSON \u3092\u8fd4\u3059\u3002\n                  (testing \"Correctness of returned JSON:\"\n                           (is (instance? clojure.lang.IPersistentMap\n                                          (-> (@#'<project-name>.core.handler/get-json xx)\n                                              (get :body)\n                                              (json/read-str :keyword-fn keyword)))\n                               \"Invalid JSON form.\"))\n                  (with-test\n                    (defn- valid-vector\n                      [tweet]\n                      [:div.tweet [:div.user [:a {:href (str \"https://twitter.com/\" (get-in tweet [:user :screen_name]))}\n                                                 [:img.avatar {:src (get-in tweet [:user :profile_image_url])}]\n                                                 [:strong.name (get-in tweet [:user :name])]\n                                                 [:strong.screen_name (str \"@\" (get-in tweet [:user :screen_name]))]]]\n                                  [:div.text (:text tweet)]\n                                  [:div.created_at (:created_at tweet)]\n                                  [:div.actions #_\"\u3053\u3053\u306f\u4fdd\u7559\"]])\n                    ; JSON \u306e\u5185\u5bb9\u304c\u6b63\u3057\u304f vector \u306b\u5c55\u958b\u3055\u308c\u3066\u3044\u308b\u304b(hiccup \u306b\u89e3\u91c8\u3055\u305b\u308b\u4e00\u6b69\u524d)\n                    (testing \"Correctness of expanded vector:\"\n                             (is (= (-> (@#'<project-name>.core.handler/get-json xx)\n                                        (json/read-str :keyword-fn keyword)\n                                        valid-vector)\n                                    (-> (@#'<project-name>.core.handler/get-json xx)\n                                        @#'<project-name>.core.handler/to-vector))\n                                 \"Incorrect expanded vector.\"))\n                    ; \u6700\u7d42\u7684\u306b\u51fa\u529b\u3055\u308c\u308b HTML \u306f\u6b63\u3057\u3044\u304b\n                    (testing \"Correctness of converted HTML:\"\n                             (is (= (-> (@#'<project-name>.core.handler/get-json xx)\n                                        (json/read-str :keyword-fn keyword)\n                                        valid-vector\n                                        hiccup/html)\n                                    (-> (app (mock/request :get \"/<screen_name>/status/xx\"))\n                                        (get :body)))\n                                 \"Incorrect output HTML.\")))))\n\n(deftest test-authorize\n         (are [valid-param requested-param] (= valid-param requested-param)\n              ; Twitter\u5074\u306e\u8a8d\u8a3c\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3067\u304d\u3066\u3044\u308b\u304b\n              (str \"https://api.twitter.com/oauth/authorize?oauth_token=\" <token>) (get-in (app (mock/request :get \"/auth/twitter\"))\n                                                                                           [:headers \"location\"]\n                                                                                           \"\")\n\n              ; Twitter\u304b\u3089\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u305f\u6642\u3001 oauth_token \u3068 oauth_verifier \u306f\u6b63\u3057\u304f\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u304b\u3002\n              ; Twitter \u306e /oauth/authorize \u3067\u306e\u8a8d\u8a3c\u304c\u7d42\u308f\u3063\u3066\u3053\u3061\u3089\u5074\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u304d\u305f\u6642\u306b\u3001\n              ; \u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u6e21\u3055\u308c\u3066\u304d\u305f oauth_token \u3068 oauth_verifier \u304c \u30af\u30c3\u30ad\u30fc\u306b\u6b8b\u3063\u3066\u3044\u308b\u304b \u3092\u78ba\u8a8d\u3059\u308b\u3002\n              true (let [request (mock/request :get \"/auth/twitter\" {:oauth_token <token> :oauth_verifier <verifier>})\n                         request (mock/header request \"referer\" (str \"https://api.twitter.com/oauth/authorize?=\" <token>))\n                         requested (app request)]\n                        (and from-twitter?\n                             (not-any? false?\n                                       [(get-in requested [:headers \"Set-Cookie\" \"oauth_token\"] false)\n                                        (get-in requested [:headers \"Set-Cookie\" \"oauth_verifier\"] false)])))))\n\n\u524d\u56de\u306b\u6bd4\u3079\u3066\u5927\u5e45\u306a\u5909\u66f4\u304c\u5165\u308a\u307e\u3057\u305f\u3002\u3053\u306e\u4e2d\u3067\u3082\n\ntesting \u30de\u30af\u30ed\nis \u3068 are \u306e\u9055\u3044\nwith-test \u30de\u30af\u30ed\nvar \u3078\u306e deref (@#'<project-name>.core.handler/* \u306e\u3053\u3068)\n\n\u4e0a\u8a184\u3064\u306e\u3053\u3068\u306f\u899a\u3048\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u9806\u306b\u8aac\u660e\u3057\u307e\u3059\u3002\n\ntesting \u30de\u30af\u30ed\ntesting \u30de\u30af\u30ed\u306f\u3001\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u306e\u524d\u306b\u6307\u5b9a\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8(\u7b2c\u4e00\u5f15\u6570\u306e\u6587\u5b57\u5217)\u3092\u51fa\u529b\u3057\u3066\u304f\u308c\u308b\u30de\u30af\u30ed\u3067\u3059\u3002\u3064\u307e\u308a\u3001\u4e00\u5b9a\u306e\u7bc4\u56f2\u3067\u30c6\u30b9\u30c8\u306b\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u6301\u305f\u305b\u307e\u3059\u3002\u4e0a\u8a18\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306b\u3001\u30cd\u30b9\u30c8\u3057\u305f\u4f7f\u3044\u65b9\u3082\u53ef\u80fd\u3067\u3059\u3002\n\nis \u3068 are \u306e\u9055\u3044\nis \u306f\u5358\u884c(\u3082\u3061\u308d\u3093\u3001\u8907\u6570\u306e is \u30de\u30af\u30ed\u3092\u66f8\u304d\u9023\u306d\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059)\u3067\u30c6\u30b9\u30c8\u3092\u8d70\u3089\u305b\u308b\u3082\u306e\u3067\u3042\u308b\u306e\u306b\u5bfe\u3057\u3001 are \u306f\u305d\u306e\u30b9\u30b3\u30fc\u30d7\u306e\u4e2d\u3067\u3001\u540c\u3058\u6bd4\u8f03\u306e\u4ed5\u65b9\u304c\u3067\u304d\u308b\u3082\u306e\u306b\u3064\u3044\u3066\u3001\u8907\u6570\u306e\u5024\u3092\u540c\u6642\u306b\u30c6\u30b9\u30c8\u3059\u308b\u305f\u3081\u306e\u3082\u306e\u3067\u3059\u3002\u5b9f\u969b\u306b\u306f\u3001 are \u306f clojure.template/do-template \u30de\u30af\u30ed\u3092\u4f7f\u3063\u3066\u3001\u8907\u6570\u306e is \u30de\u30af\u30ed\u3092 template \u306b\u6cbf\u3063\u3066\u540c\u6642\u306b\u5c55\u958b\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u4e00\u898b are \u306e\u65b9\u304c\u3068\u306b\u304b\u304f\u4fbf\u5229\u3067\u3059\u304c\u3001 are \u306e\u30b3\u30fc\u30c9\u5c55\u958b\u306f\u4e8b\u524d\u306b\u5f15\u6570\u3068\u3057\u3066\u6e21\u3055\u308c\u305f template \u306e\u5185\u5bb9\u306b\u56fa\u5b9a\u3055\u308c\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u3001is \u3068\u540c\u3058\u3088\u3046\u306b\u5404\u30c6\u30b9\u30c8\u306e\u30a8\u30e9\u30fc\u30d1\u30bf\u30fc\u30f3\u306b\u5bfe\u3057\u3066\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u529b\u3055\u305b\u3066\u3044\u304f\u5834\u5408\u306b\u3064\u3044\u3066\u8003\u3048\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u7d20\u76f4\u306b\u8003\u3048\u308c\u3070\u3001\n(are [x y msg] (if (= x y) true (throw (Exception. msg)))\n     2 (+ 1 1) \"hoge\"\n     4 (+ 2 2) \"fuga\")\n\n\u3053\u306e\u3088\u3046\u306b\u66f8\u304f\u3060\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\nis \u306e\u5b9f\u88c5\n\u3053\u3053\u3067\u3001 is \u306e\u30b3\u30fc\u30c9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n(defmacro is\n  \"Generic assertion macro.  'form' is any predicate test.\n  'msg' is an optional message to attach to the assertion.\n\n  Example: (is (= 4 (+ 2 2)) \\\"Two plus two should be 4\\\")\n  Special forms:\n  (is (thrown? c body)) checks that an instance of c is thrown from\n  body, fails if not; then returns the thing thrown.\n  (is (thrown-with-msg? c re body)) checks that an instance of c is\n  thrown AND that the message on the exception matches (with\n  re-find) the regular expression re.\"\n  {:added \"1.1\"} \n  ([form] `(is ~form nil))\n  ([form msg] `(try-expr ~msg ~form)))\n\nis \u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u51fa\u529b\u306f\u3001\u5c02\u7528\u306e\u6a5f\u80fd\u304c\u4f7f\u308f\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002 try-expr \u30de\u30af\u30ed\u306e\u5b9f\u88c5\u3092\u8ffd\u3063\u3066\u3044\u304f\u3068\u3001 is \u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u51fa\u529b\u306f\u4f8b\u5916\u51e6\u7406\u3092\u30e9\u30c3\u30d7\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\u3053\u306e\u3088\u3046\u306a\u51e6\u7406\u3092 are \u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3067\u518d\u5b9f\u88c5\u3001\u3068\u3044\u3046\u306e\u306f\u3055\u3059\u304c\u306b\u9762\u5012\u3067\u3059\u306d\u3002\u3067\u306f are \u306e expr \u4e2d\u3067 is \u30de\u30af\u30ed\u3092\u4f7f\u3048\u3070\u3044\u3044\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u305d\u308c\u306f\u69cb\u6587\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002 are \u306f\u30b3\u30fc\u30c9\u5c55\u958b\u6642\u306b is \u306b\u5fc5\u8981\u306a\u5024\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3001\u305d\u3046\u3057\u3066\u51fa\u6765\u305f\u30b3\u30fc\u30c9\u3092\u751f\u6210\u3057\u3066\u3044\u304f\u3088\u3046\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u304b\u3089\u3067\u3059\u3002\u3067\u306f\u3001 try-expr \u30de\u30af\u30ed\u3092\u518d\u5229\u7528\u3059\u308c\u3070\u3044\u3044\u306e\u304b\u3068\u3044\u3046\u3068\u3053\u308d\u3067\u3059\u304c\u3001\u305d\u308c\u306f\u3084\u3081\u3066\u304a\u304f\u3079\u304d\u3067\u3057\u3087\u3046\u3002\u306a\u305c\u306a\u3089\u3001 try-expr \u30de\u30af\u30ed\u3092\u4f5c\u3063\u305f\u672c\u4eba\u304c doc \u30b3\u30e1\u30f3\u30c8\u4e2d\u306b\u306f\u3063\u304d\u308a\u3068\u3053\u3046\u66f8\u3044\u3066\u3042\u308b\u304b\u3089\u3067\u3059\u3002\n\n\"Used by the 'is' macro to catch unexpected exceptions. You don't call this.\" \n\n\nis \u3068 are \u306e\u4f7f\u3044\u5206\u3051\u65b9\n\u3053\u306e\u4e8b\u304b\u3089\u3001 is \u3068 are \u306e\u4f7f\u3044\u5206\u3051\u65b9\u306f\u304a\u304a\u3080\u306d\n\nare \u306f\u3001\u30c6\u30b9\u30c8\u306e\u610f\u5473\u304c\u540c\u3058\u3067\u3042\u308b\u304b\u3001\u540c\u69d8\u306e\u6bd4\u8f03\u304c\u3067\u304d\u308b\u3082\u306e\u30921\u7b87\u6240\u306b\u96c6\u7d04\u3055\u305b\u308b\u6642\u306b\u4f7f\u3046\nis \u306f\u5358\u884c\u3067\u6e08\u3080\u30c6\u30b9\u30c8\u3084\u3001\u500b\u5225\u306b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u529b\u3055\u305b\u308b\u5fc5\u8981\u304c\u3042\u308b\u6642\u306b\u4f7f\u3046\n\n\u4e0a\u8a182\u3064\u306b\u843d\u3061\u7740\u304f\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\nwith-test \u30de\u30af\u30ed\nwith-test \u30de\u30af\u30ed\u306f\u3001\u305d\u306e\u30b9\u30b3\u30fc\u30d7\u306e\u4e2d\u3067\u5171\u901a\u306b\u5229\u7528\u3059\u308b\u95a2\u6570\u3092\u65b0\u305f\u306b\u5b9a\u7fa9\u3057\u3064\u3064\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u66f8\u3051\u308b\u30de\u30af\u30ed\u3067\u3059\u3002\u30a4\u30e1\u30fc\u30b8\u306f\u4e01\u5ea6\u4e0a\u8a18\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\n\nvar \u3078\u306e deref\n\u4eca\u56de\u306e\u30b3\u30fc\u30c9\u306e\u4e2d\u3067\u6700\u3082\u6ce8\u610f\u304c\u5fc5\u8981\u306a\u306e\u304c\u3001 var \u3078\u306e deref \u3067\u3059\u3002\u901a\u5e38\u3001 Clojure \u3067 deref \u3092\u4f7f\u3046\u6a5f\u4f1a\u304c\u3042\u308b\u3068\u3059\u308c\u3070\u3001\u305d\u308c\u306f\u307b\u3068\u3093\u3069\u306e\u5834\u5408\u306b\u304a\u3044\u3066 ref, atom, agent \u3068\u3044\u3063\u305f\u4e26\u5217\u51e6\u7406\u3084\u4e26\u884c\u51e6\u7406\u306e\u305f\u3081\u306b\u5b9f\u88c5\u3055\u308c\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u72b6\u614b\u3092\u53d6\u5f97\u3059\u308b\u3068\u304d\u3067\u3057\u3087\u3046\u3002\u305d\u308c\u3089\u3068\u540c\u69d8\u306b deref \u304c\u6a5f\u80fd\u3059\u308b\u3068\u3044\u3046\u70b9\u3067\u3001 var \u306b\u3082 IDeref \u306e\u5b9f\u88c5\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u306f\u60f3\u50cf\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\u3057\u304b\u3057\u3001\n\u5916\u306e\u540d\u524d\u7a7a\u9593\u306e var \u3092\u30af\u30a9\u30fc\u30c8\u3057\u3066\u66f4\u306b\u305d\u308c\u3092 deref \u3067\u547c\u3073\u51fa\u3057\u3066\u3044\u308b\uff1f\u3057\u304b\u3082 private \u306a\u95a2\u6570\u304b\u3089\uff1f\n\u304a\u305d\u3089\u304f\u3001\u3069\u3046\u3044\u3046\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u304b\u30a4\u30e1\u30fc\u30b8\u304c\u3064\u304d\u306b\u304f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u79c1\u3082\u305d\u3046\u3067\u3057\u305f\u3002\u3053\u306e\u30b3\u30fc\u30c9\u306e\u52d5\u304d\u3092\u7406\u89e3\u3059\u308b\u306b\u306f\u3001\u307e\u305a Clojure \u306e var \u304c\u3069\u3046\u3044\u3046\u5b9f\u88c5\u306a\u306e\u304b\u306b\u3064\u3044\u3066\u77e5\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u7aef\u7684\u306b\u8a00\u3046\u3068\u3001 Clojure \u306e var \u306f\u3001\u30b7\u30f3\u30dc\u30eb\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u306e\u30dd\u30a4\u30f3\u30bf\u306a\u306e\u3067\u3059\u3002\u66f4\u306b\u306f\u3001\u52d5\u7684\u5909\u6570\u306e\u305f\u3081\u306e\u30b9\u30ec\u30c3\u30c9\u30ed\u30fc\u30ab\u30eb\u306a\u5024\u3092\u78ba\u4fdd\u3059\u308b\u305f\u3081\u306e\u6a5f\u80fd\u3082\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059(\u4eca\u56de\u306f\u3053\u3053\u306b\u306f\u89e6\u308c\u307e\u305b\u3093)\u3002\u7c21\u5358\u306b\u56f3\u306b\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\n       \u53c2\u7167\n[Var] ------> [\u4f55\u3089\u304b\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b7\u30f3\u30dc\u30eb] \u203b\u3053\u306e\u30b7\u30f3\u30dc\u30eb\u306e\u4e2d\u306b\u5b9f\u969b\u306e\u5024\u304c\u3042\u308b\u3002\n\n\u3053\u308c\u306b\u5bfe\u3057\u3066\u5916\u90e8\u304b\u3089 deref \u3067\u547c\u3073\u51fa\u3057\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u3053\u3046\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n(var \u30af\u30a9\u30fc\u30c8\u306e deref) ---------\n                               |\n       \u53c2\u7167                   \\|/\n[Var] ------> [\u4f55\u3089\u304b\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b7\u30f3\u30dc\u30eb] \u203b\u3053\u306e\u30b7\u30f3\u30dc\u30eb\u306e\u4e2d\u306b\u5b9f\u969b\u306e\u5024\u304c\u3042\u308b\n\n\u3064\u307e\u308a\u3001 var \u305d\u306e\u3082\u306e\u3067\u306f\u306a\u304f\u3001 var \u306e\u53c2\u7167\u5148\u306e\u30b7\u30f3\u30dc\u30eb\u306e\u60c5\u5831\u3092\u76f4\u63a5\u53d6\u5f97\u3057\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\u3067\u306f\u3001 def \u3067\u5b9a\u7fa9\u3057\u305f var \u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u3068\u3057\u3066\u4ed8\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u308b private \u30ad\u30fc\u30ef\u30fc\u30c9\u306b\u306f\u3069\u3046\u3044\u3046\u610f\u5473\u304c\u3042\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u3002\u4e0a\u56f3\u3092\u898b\u3066\u3044\u308b\u3068\u3001\u5927\u4f53\u60f3\u50cf\u304c\u3064\u304f\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n(var \u30af\u30a9\u30fc\u30c8\u306e deref) --------\n                              |\n       \u53c2\u7167                  \\|/\n[Var] ------> [\u4f55\u3089\u304b\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b7\u30f3\u30dc\u30eb]\n \u2191\nprivate \u30e1\u30bf\u304c\u3064\u304f\u306e\u306f\u3053\u3053\n\nprivate \u30e1\u30bf\u3067\u4fdd\u8b77\u3055\u308c\u308b\u306e\u306f\u3001\u5b9f\u969b\u306e\u5024\u3067\u306f\u306a\u304f\u30dd\u30a4\u30f3\u30bf\u3067\u3042\u308b var \u306e\u65b9\u306a\u306e\u3067\u3059\u3002\u4f55\u6545\u305d\u3046\u306a\u3063\u3066\u3044\u308b\u306e\u304b\u3068\u3044\u3046\u3068\u3001 var \u306f\u3042\u304f\u307e\u3067\u30dd\u30a4\u30f3\u30bf\u306a\u306e\u3067\u3001\u53c2\u7167\u3059\u308b\u5024\u3092\u5f8c\u304b\u3089\u3044\u304f\u3089\u3067\u3082\u5909\u66f4\u3067\u304d\u308b\u304b\u3089\u3067\u3059\u3002\u3088\u3063\u3066\u3001 def \u306b\u3088\u308b var \u306e\u5b9a\u7fa9\u306b\u95a2\u3057\u3066\u306f redefined \u3067\u30a8\u30e9\u30fc\u304c\u98db\u3093\u3067\u304f\u308b\u3053\u3068\u306f\u307e\u305a\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u3053\u308c\u306f\u30b7\u30e3\u30c9\u30a6\u30a4\u30f3\u30b0\u304c\u767a\u751f\u3059\u308b\u8981\u56e0\u3067\u3082\u3042\u308a\u307e\u3059(\u3053\u306e\u3053\u3068\u306b\u3064\u3044\u3066\u307e\u3067\u89e6\u308c\u308b\u3068\u8a71\u304c\u9577\u304f\u306a\u308a\u3059\u304e\u308b\u306e\u3067\u3001\u306f\u3057\u3087\u308a\u307e\u3059\u3002\u8a73\u3057\u304f\u306f\u30b0\u30b0\u30c3\u3066\u306d)\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u4eca\u56de\u306e\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3067\u306f\u3001\u65b0\u305f\u306b\u66f8\u304d\u76f4\u3055\u308c\u305f\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u306e\u500b\u3005\u306e\u51e6\u7406\u306b\u3064\u3044\u3066\u30c6\u30b9\u30c8\u3059\u308b\u305f\u3081\u306b\u3001\u5916\u90e8\u306b\u3042\u308b\u95a2\u6570\u306e\u53c2\u7167\u5148\u3092\u610f\u56f3\u7684\u306b\u53d6\u5f97\u3057\u306b\u884c\u304f\u3068\u3044\u3046(\u304b\u306a\u308a\u3080\u3061\u3083\u304f\u3061\u3083\u306a)\u884c\u52d5\u306b\u51fa\u3066\u3044\u305f\u306e\u3067\u3057\u305f\u3002\n\u4eca\u56de\u306e\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306e\u8aac\u660e\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3002\u3067\u306f\u3001\u6700\u5f8c\u306b\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u306e\u66f8\u304d\u76f4\u3057\u306b\u79fb\u308a\u307e\u3059\u3002\n\n\u5b9f\u88c5\u30b3\u30fc\u30c9\u306e\u62e1\u5f35\n(ns <project-name>.core.handler\n  (:require [data.json :as json]\n            [oauth.client :as oauth]\n            [clj-http.client :as http]\n            [hiccup.core :as hiccup])))\n\n(def ^:private consumer-key #_hoge)\n(def ^:private consumer-secret #_fuga)\n\n(def ^:private consumer (oauth/make-consumer <consumer-key>\n                                             <consumer-secret>\n                                             \"https://api.twitter.com/oauth/request_token\"\n                                             \"https://api.twitter.com/oauth/access_token\"\n                                             \"https://api.twitter.com/oauth/authorize\"\n                                             :hmac-sha1))\n\n(def ^:private request-token (oauth/request-token consumer <callback-uri>))\n\n; \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a8d\u8a3c\u753b\u9762(/oauth/authorize?oauth_token=xxxx...) \u306eURL\u3092\u751f\u6210\u3059\u308b\u3002\n; \u300cTwitter\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u300d\u30dc\u30bf\u30f3\u306a\u3069\u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u306b\u5fc5\u8981\n(def ^:private user-approval-uri (oauth/user-approval-uri consumer\n                                                          (:oauth_token request-token)))\n\n(def ^:private access-token-response (oauth/access-token consumer request-token <verifier>))\n\n(defn- credentials\n  [url params]\n  (oauth/credentials consumer\n                     (:oauth_token access-token-response)\n                     (:oauth_token_secret access-token-response)\n                     :GET\n                     (str url params)))\n\n(defn- get-json\n  [^long id]\n  (let [url    \"http://api.twitter.com/1.1/statuses/show/\"\n        ; OAuth\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5074\u306b\u30af\u30a8\u30ea\u6587\u5b57\u5217\u306e\u305f\u3081\u306eWrapper\u306f\u306a\u3044\u3002\n        params {:headers      {\"authorization\" (authorization-header (credentials url (str id \".json\")))}\n                :query-params {:id id}}]\n       (-> (http/get url params)\n           (json/read-str :keyword-fn keyword))))\n\n(defn- to-vector\n  [tweet]\n  [:div.tweet [:div.user [:a {:href (str \"https://twitter.com/\" (get-in tweet [:user :screen_name]))}\n                             ; profile_image_url \u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u6271\u3044\u306f\u3001\u8a2d\u5b9a\u3092\u53c2\u7167\u3057\u3066 HTTPS \u306b\u3059\u308b\u304b\u3069\u3046\u304b\u3092\u9078\u629e\u3059\u308b\u3088\u3046\u306b\u306f\u3057\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u308b\u3002\n                             [:img.avatar {:src (get-in tweet [:user :profile_image_url])}]\n                             [:strong.name (get-in tweet [:user :name])]\n                             [:span.screen_name (str \"@\" (get-in tweet [:user :screen_name]))]]]\n              [:div.text (:text tweet)]\n              [:div.created_at (:created_at tweet)]\n              [:div.actions #_\"\u3053\u3053\u306f\u4fdd\u7559\"]])\n\n(defn- status-show\n  [^long id]\n  (-> (get-json id)\n      to-vector\n      hiccup/html))\n\n(defroutes app-routes\n           ; Twitter\u8a8d\u8a3c(\u4eca\u56de\u306e\u8a18\u4e8b\u3067\u306f\u7701\u7565)\n           (GET \"/auth/twitter\" [] get-auth)\n           (context \"/:screen_name\" [^String screen_name]\n                    (GET \"/\" [] #_\"\u3053\u3063\u3061\u5074\u306e\u30b5\u30fc\u30d0 \u304b\u3089 \u6700\u65b0\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97 \u3059\u308b\u51e6\u7406\")\n                    (GET \"/status/:id\" [^long id] (status-show id))))\n\n(def app (wrap-defaults app-routes site-defaults))\n\n\n\u307e\u3068\u3081\u3068\u304b\u96d1\u611f\u3068\u304b\n\nclojure.test \u306e\u30de\u30af\u30ed\u306f\u5730\u5473\u306b\u4fbf\u5229\u3002\n\n\u3067\u3082\u30a6\u30a7\u30d6\u3060\u3068\u3084\u3063\u3071\u308a MVC \u304c\u3061\u3083\u3093\u3068\u63c3\u3063\u3066\u306a\u3044\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306e\u30c6\u30b9\u30c8\u306f\u307e\u3060\u8f9b\u3044\u2026\n\nClojure \u306e Var \u306f deref \u3067\u304d\u308b\u3002\u4f8b\u3048\u305d\u308c\u304c private \u306a Var \u3067\u3042\u3063\u3066\u3082\u3002\n\n\n\u3067\u3082\u3067\u304d\u308b\u306a\u3089\u4f7f\u308f\u305a\u306b\u5c45\u305f\u3044\u3088\u306d\u2026\u3002\u540d\u524d\u7a7a\u9593\u5b8c\u5168\u4fee\u98fe\u3068\u304b\u3081\u3093\u3069\u3044\u2026[1]\n\n\u306c\u308f\u3042\u3042\u3042\u3042\u3093\u30a6\u30a7\u30d6\u958b\u767a\u75b2\u308c\u305f\u3082\u304a\u304a\u304a\u3093\n\n\u3053\u306e\u8fba\uff08\uff1f\uff09\u306b\u3043\u3001\u92ad\u6e6f\u306e\u5e97\u3001\u3042\u308b\u3093\u3067\u3059\u3051\u3069\u3001\u884c\u304b\u306a\u3044\u3063\u3059\u304b\uff1f\n\uff1f\uff1f\uff1f\u300c\u304a\u3063\u305d\u3046\u3060\u306a\u300d\n\u3058\u3083\u3051\u3093\u591c\u884c\u304d\u307e\u3057\u3087\u3046\u306d\u3002\n\u2026\u2026\u2026\uff87\uff6f(\u5927\u96ea)\n\u3082\u3046\u3084\u3081\u305f\u304f\u306a\u308a\u307e\u3059\u3088\u301c\u5916\u51fa\u30a5\u301c\n(\u8a71\u3092)\u3082\u3069\u3057\u3066\u3001compojure \u3092\u4f7f\u3046\u30e1\u30ea\u30c3\u30c8\u306f\uff1f\n\nring \u3068\u4f5c\u8005\u304c\u540c\u3058\u306a\u306e\u3067\u3001\u57fa\u672c\u7684\u306b\u306f\u4e00\u4eba\u306e\u4f5c\u8005\u3060\u3051\u3092\u8ffd\u3044\u304b\u3051\u3066\u3044\u308c\u3070\u3088\u3044\u3002(\u591a\u5206\u3001\u4f9d\u5b58\u3082\u305d\u3053\u307e\u3067\u3053\u3093\u304c\u3089\u304c\u3089\u306a\u3044)\n\u4f5c\u308a\u81ea\u4f53\u306f\u5272\u3068\u30b7\u30f3\u30d7\u30eb\u306a\u306e\u3067\u3001\u30a6\u30a7\u30d6\u958b\u767a\u306e\u7df4\u7fd2\u7528\u3068\u3057\u3066\u3082\u305d\u308c\u307b\u3069\u60aa\u304f\u306f\u306a\u3044\u3002\n\u57fa\u672c\u7684\u306b\u306f\u3001\u3053\u308c\u306b\u52a0\u3048\u3066\u305d\u306e\u76ee\u7684\u306b\u3042\u3063\u305f\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u3044\u304f\u3064\u304b\u8ffd\u52a0\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3060\u3051\u3067\u3088\u3044\u3002\n\n\u2026\u2026\u2026\u30c7\u30e1\u30ea\u30c3\u30c8\u306f\uff1f\n\n\u306a\u3044\u3067\u3059(\u5927\u5618)\n\n\n\u30cf\u30f3\u30c9\u30e9\u3068\u30d3\u30e5\u30fc\u304c\u76f4\u7d50\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4eca\u56de\u306e\u8a18\u4e8b\u306e\u5185\u5bb9\u304b\u3089\u3082\u60f3\u50cf\u304c\u3064\u304f\u3088\u3046\u306b\u3001HTML \u51fa\u529b\u304c\u7d61\u307f\u51fa\u3059\u3068\u305d\u306e\u5206\u3060\u3051\u30c6\u30b9\u30c8\u306e\u96e3\u6613\u5ea6\u304c\u4e0a\u304c\u3063\u3066\u304f\u308b(\u4eca\u56de\u306f\u30c4\u30a4\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u5358\u4f53\u3092 HTML \u3067\u30c7\u30b3\u30ec\u30fc\u30c8\u3059\u308b\u3060\u3051\u3060\u3063\u305f\u3051\u308c\u3069\u3082\u3001\u3053\u308c\u304c\u4e00\u5ea6\u306b\u30ea\u30b9\u30c8\u8868\u793a\u3059\u308b\u3068\u304b\u306a\u308b\u3068\u2026(\u00b4\uff65_\uff65`))\u3002\n\u30eb\u30fc\u30c8\u306e\u5b9a\u7fa9\u306e\u4ed5\u65b9\u306f\u3001\u30de\u30af\u30ed\u306e\u5b9f\u88c5\u306b\u3088\u308a\u6c7a\u3081\u3089\u308c\u3066\u3044\u308b\u3002\u3064\u307e\u308a\u3001\u30cf\u30fc\u30c9\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u3057\u304b\u306a\u3044\u3002API \u306e\u4e2d\u306b\u73fe\u5728\u306e\u30eb\u30fc\u30c8\u3092\u53d6\u5f97\u3057\u305f\u308a\u3001\u30eb\u30fc\u30c8\u306b\u4f55\u3089\u304b\u306e\u5024\u3092\u8ffd\u52a0\u3057\u3066\u65b0\u3057\u3044\u30eb\u30fc\u30c8\u3092\u4f5c\u308b\u305f\u3081\u306e\u3082\u306e\u304c\u306a\u3044(HTTP \u30d8\u30c3\u30c0\u4e2d\u306e uri \u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u4e0a\u624b\u304f\u4f7f\u3048\u3070\u306a\u3093\u3068\u304b\u306a\u308a\u305d\u3046\u306a\u6c17\u304c\u3057\u3066\u3044\u308b\u3002\u4eca\u306e\u3068\u3053\u308d\u8a66\u3059\u6c17\u306f\u306a\u3044\u3051\u308c\u3069)\u3002\u3082\u3057\u4eca\u3059\u3050\u5fc5\u8981\u3060\u3068\u3044\u3046\u65b9\u306f bidi \u3092\u63a2\u3057\u3066\u3001\u3069\u3046\u305e\u3002\n\u3088\u3063\u3066\u3001\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092\u30da\u30fc\u30b8\u5316\u3057\u3066\u5c0f\u5206\u3051\u306b\u8868\u793a\u3059\u308b\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u6a5f\u80fd\u306f\u73fe\u5728\u306e\u5b9f\u88c5\u3060\u3051\u3067\u306f\u5229\u7528\u3067\u304d\u306a\u3044\u3002\u305d\u3082\u305d\u3082\u30da\u30fc\u30b8\u5316\u304c\u4e0d\u8981\u3067\u3001\u4eca\u6d41\u884c\u308a\u306e\u30ea\u30c3\u30c1\u306a\u9045\u5ef6\u8868\u793a\u3067\u3044\u3044\u3068\u3044\u3046\u306e\u3067\u3042\u308c\u3070\u3001\u5272\u3068\u306a\u3093\u3068\u304b\u306a\u308a\u305d\u3046\u306a\u6c17\u304c\u3059\u308b\u3002\n\u30df\u30cb\u30de\u30eb\u69cb\u6210\u3067\u3042\u308b(== \u30aa\u30fc\u30eb\u30a4\u30f3\u30ef\u30f3\u3067\u306f\u306a\u3044)\u304c\u6545\u306e\u3042\u308c\u3053\u308c\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u307e\u3060\u305d\u306e\u4e8b\u614b\u306b\u306f\u906d\u9047\u3057\u305f\u3068\u3044\u3046\u8a71\u306f\u805e\u304d\u53ca\u3093\u3067\u3044\u306a\u3044\u304c\u3001\u4f9d\u5b58\u5730\u7344\u306b\u9665\u3089\u306a\u3044\u3068\u306f\u8a00\u3044\u5207\u308c\u306a\u3044\u3002(yesod \u3068\u304b\u4f7f\u3063\u305f\u3053\u3068\u3042\u308b\u4eba\u306a\u3089\u308f\u304b\u308b\u3068\u601d\u3046\u3002\u307e\u3042\u3001\u3042\u308c\u306f cabal \u304c\u4e0a\u624b\u306b\u4f9d\u5b58\u89e3\u6c7a\u3057\u304d\u308c\u3066\u306a\u3044\u306e\u304c\u539f\u56e0\u3060\u3063\u305f\u308f\u3051\u3060\u3051\u3069\u3082\u3002 stack \u306f\u305d\u306e\u3078\u3093\u3069\u3046\u3060\u3063\u3051\u306a\u2026)[2]\n\n\n\n\n\u3067\u306f\u3001compojure \u3068\u305d\u306e\u5468\u8fba\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3082\u6bd4\u8f03\u7684\u958b\u767a\u304c\u7528\u610f\u306a\u30d1\u30bf\u30fc\u30f3\u306f\u306a\u3093\u3060\u308d\u3046\u304b\u3002\n\n\u304a\u305d\u3089\u304f\u3001 REST API\n\n\n\u3064\u307e\u308a\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066\u8fd4\u3059\u3082\u306e\u304c HTML \u6587\u5b57\u5217\u3067\u306f\u306a\u304f\u3001JSON \u306a\u3069\u306e\u5f62\u5f0f\u306e\u6c7a\u307e\u3063\u305f\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u307f\u3067\u3042\u308b\u3001\u3068\u3044\u3046\u3082\u306e\u3002\n\u8fd4\u308a\u5024\u3068\u306a\u308b JSON \u306f\u3001 parse \u3059\u308c\u3070 Clojure \u3067\u3082\u5bb9\u6613\u306b\u6271\u3048\u308b(== Clojure\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u306b\u7f6e\u304d\u63db\u3048\u3066\u30c6\u30b9\u30c8\u3067\u304d\u308b)\u3002\u305f\u3060\u3001 Twitter \u306e JSON \u306f\u3081\u3093\u3069\u3044\u2026\n\n\u305d\u3082\u305d\u3082\u30a6\u30a7\u30d6\u30d6\u30e9\u30a6\u30b6\u4e0a\u3067\u8868\u793a\u3059\u308b\u3053\u3068\u306e\u65b9\u304c\u5c11\u306a\u3044 API \u306a\u306e\u3067\u3001\u30a6\u30a7\u30d6\u3068\u3044\u3046\u3088\u308a\u306f\u3001\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u958b\u767a\u306b\u8fd1\u3044\n\n\n\n\u3067\u306f\u3067\u306f\u3001\u304a\u3084\u3059\u307f\u306a\u3055\u3044\u301c\u3002\n\u3042\u3001\u7686\u3055\u3093\u3001\u3088\u3044\u304a\u5e74\u3092\uff01\n\n\u8ffd\u8a18\n[1] var \u30af\u30a9\u30fc\u30c8\u3067\u3042\u3063\u3066\u3082\u3001\u540d\u524d\u7a7a\u9593\u306e\u5225\u540d\u4fee\u98fe\u306f\u53ef\u80fd\u3002(@ayato_p \u3055\u3093\u306e\u3054\u6307\u6458\u306e3.)\n[2] \u4f9d\u5b58\u95a2\u4fc2\u306f\u3001 bidi \u306e\u305d\u308c\u306b\u6bd4\u3079\u308c\u3070\u5927\u304d\u3044\u65b9(@ayato_p \u3055\u3093\u3054\u6307\u6458\u306e5.)\u3002\u304a\u305d\u3089\u304f\u3001\u8907\u6570\u306e\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u30e9\u30a4\u30d6\u30e9\u30ea\u3092(\u672c\u4eba\u304c\u81ea\u4f5c\u3057\u305f\u306e\u3082\u542b\u3081\u3066)\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u5229\u7528\u3057\u3066\u3044\u308b\u304b\u3089\u3060\u3068\u601d\u308f\u308c\u308b\n*(\u65e5\u4ed8\u3092\u307e\u305f\u3044\u3067\u3057\u307e\u3063\u3066\u7533\u3057\u8a33\u306a\u3044\u2026)*\nClojure Advent Calendar 2015 25\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n# \u306f\u3058\u3081\u306b\n\n[\u524d\u56de\u306e\u8a18\u4e8b](http://qiita.com/func-hs/items/57e1e0241e0f804f5ccf)\u304b\u3089\u65e91\u5e74\u3002Clojure \u672c\u4f53\u3092\u542b\u3081\u3001\u8907\u6570\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u65b0\u3057\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n## \u524d\u56de\u304b\u3089\u306e\u5909\u66f4\u70b9\n\n* \u30b2\u30b9\u30c8OS\u3092 wheezy \u304b\u3089 jessie \u306b\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u3057\u307e\u3057\u305f\u3002\n* \u4e0b\u8a18\u306e\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u3057\u307e\u3057\u305f\n * clojure: 1.6 -> 1.7\n * data.json: 0.2.5 -> 0.2.6\n * java.jdbc: 0.3.6 -> 0.4.2\n * compojure: 1.3.1 -> 1.4.0 (\u6ce8: clojure 1.5.1 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b)\n * lib-noir: 0.9.5 -> 0.9.9 (\u6ce8: clojure 1.6.0 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b)\n * clj-http: 1.0.1 -> 2.0.0\n * clj-oauth: 1.5.1 -> 1.5.3 (\u6ce8: clojure 1.6.0, clj-http 1.0.1, commons-codec 1.8 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b)\n * lein-ring: 0.8.13 -> 0.9.7\n * lein-auto: 0.1.1 -> 0.1.2\n * codox: 0.8.10 -> 0.9.0\n * ring-mock: 0.2.5 -> 0.3.0\n\n\u3055\u3066\u3053\u306e\u5185\u3001\u6700\u65b0\u306e clojure \u672c\u4f53\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u3044\u304f\u3064\u304b\u3042\u308a\u307e\u3059\u3002\u52a0\u3048\u3066\u3001 clj-oauth \u306f clj-http \u306e\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3082\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u307e\u307e\u3067\u306f\u8907\u6570\u306e\u53e4\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u540c\u6642\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3067\u3057\u3087\u3046\u3002\u3053\u306e\u3053\u3068\u306b\u3088\u308a\u3001\u958b\u767a\u3092\u884c\u3046\u4e0a\u3067\u554f\u984c\u3068\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u79c1\u9054\u306b\u306f\u4e0d\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3059\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u9055\u3044\u3067\u7121\u99c4\u306b\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u5897\u3048\u305f\u308a\u3059\u308b\u3068\u5f8c\u3067\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u624b\u9593\u304c\u5897\u3048\u307e\u3059(\u30c7\u30a3\u30b9\u30af\u3082\u5727\u8feb\u3057\u307e\u3059\u3057\u306d)\u3002\u3053\u306e\u3088\u3046\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u3001\u305d\u3082\u305d\u3082\u521d\u3081\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u306a\u3044\u3067\u304a\u304f\u3088\u3046\u306b\u3059\u308b\u306b\u9650\u308a\u307e\u3059\u3002\n\n## \u4e0d\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u9664\u5916\n\n\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u4e2d\u304b\u3089\u4e0d\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u5207\u308a\u96e2\u3059\u306b\u306f\u3001 project.clj \u5185\u306b `:exclusions` \u30ad\u30fc\u3092\u8ffd\u8a18\u3057\u3001\u305d\u306e\u5024\u3068\u3057\u3066\u9664\u5916\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092 vector \u306b\u66f8\u304d\u8fbc\u307f\u307e\u3059\u3002\u307e\u305a\u3001\u524d\u56de\u306e\u8a18\u4e8b\u3067 project.clj \u304c\u3069\u3046\u66f8\u304b\u308c\u3066\u3044\u305f\u304b\u3092\u601d\u3044\u51fa\u3057\u307e\u3057\u3087\u3046\u3002\n\n```clj\n(defproject <project-name> \"0.1.0-SNAPSHOT\"\n  :descriptions \"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6982\u8981\"\n  :url          \"\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u4fdd\u7ba1\u3057\u3066\u3044\u308b\u30ea\u30dd\u30b8\u30c8\u30ea\u306a\u3069\u306eURL\"\n  :license      {:name \"\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u5f93\u5c5e\u3059\u308b\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u540d\u524d\"\n                 :url \"\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u6761\u6587\u304c\u7f6e\u304b\u308c\u3066\u3044\u308b\u30b5\u30a4\u30c8\u306eURL\"}\n  :dependencies [[org.clojure/clojure \"1.6.0\"]\n                 [org.clojure/data.json \"0.2.5\"]\n                 [org.clojure/java.jdbc \"0.3.6\"]\n                 [compojure \"1.3.1\"]\n                 [hiccup \"1.0.5\"]\n                 [lib-noir \"0.9.5\"]\n                 [clj-http \"1.0.1\"]\n                 [clj-oauth \"1.5.1\"]]\n  :plugins       [[lein-ring \"0.8.13\"]\n                  [lein-auto \"0.1.1\"]\n                  [codox \"0.8.10\"]]\n  :ring          {:handler <project-name>.core.handler/app}\n  :profiles      {:dev {:dependencies [[javax.servlet/servlet-api \"2.5\"]\n                                       [ring/ring-mock \"0.2.5\"]]}})\n```\n\n\u3053\u308c\u3092\n\n```clj\n(defproject <project-name> \"0.1.0-SNAPSHOT\"\n  :descriptions \"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u6982\u8981\"\n  :url          \"\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u4fdd\u7ba1\u3057\u3066\u3044\u308b\u30ea\u30dd\u30b8\u30c8\u30ea\u306a\u3069\u306eURL\"\n  :license      {:name \"\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u5f93\u5c5e\u3059\u308b\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u540d\u524d\"\n                 :url \"\u30e9\u30a4\u30bb\u30f3\u30b9\u306e\u6761\u6587\u304c\u7f6e\u304b\u308c\u3066\u3044\u308b\u30b5\u30a4\u30c8\u306eURL\"}\n  :exclusions   [org.clojure/clojure]\n  :dependencies [[org.clojure/clojure \"1.7.0\"]\n                 [org.clojure/data.json \"0.2.6\"]\n                 [org.clojure/java.jdbc \"0.4.2\"]\n                 [compojure \"1.4.0\"]\n                 [hiccup \"1.0.5\"]\n                 [lib-noir \"0.9.9\"]\n                 [clj-http \"2.0.0\"]\n                 [clj-oauth \"1.5.3\" :exclusions [clj-http commons-codec]]]\n  :plugins       [[lein-ring \"0.9.7\"]\n                  [lein-auto \"0.1.2\"]\n                  [codox \"0.9.0\"]]\n  :ring          {:handler <project-name>.core.handler/app}\n  :profiles      {:dev {:dependencies [[javax.servlet/servlet-api \"2.5\"]\n                                       [ring/ring-mock \"0.3.0\"]]}})\n```\n\n\u3053\u3046\u3057\u307e\u3059\u3002\n\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u306b\u3042\u308b `:exclusions` \u306f\u3001\u81ea\u5206\u81ea\u8eab\u3092\u542b\u3081\u3066\u3001\u305d\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3059\u3079\u3066\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089\u6307\u5b9a\u3057\u305f\u4f9d\u5b58\u3092\u53d6\u308a\u9664\u304d\u307e\u3059\u3002\u4eca\u56de\u306f\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u3067\u4e00\u5ea6 clojure \u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u9664\u304f\u3088\u3046\u306b\u6307\u5b9a\u3057\u3064\u3064 clojure \u672c\u4f53\u3078\u306e\u4f9d\u5b58\u3092\u8a18\u8ff0\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3059\u3079\u3066\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304b\u3089 clojure \u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u53d6\u308a\u9664\u304d\u3001\u305d\u306e\u5f8c\u3053\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u81ea\u8eab\u3060\u3051\u304c clojure 1.7 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u308b\u3068\u3044\u3046\u72b6\u614b\u3092\u4f5c\u308a\u51fa\u3059\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u4f9d\u5b58\u30d1\u30c3\u30b1\u30fc\u30b8\u5358\u4f4d(\u4eca\u56de\u306f clj-oauth )\u3067\u8a18\u8ff0\u3055\u308c\u308b `:exclusions` \u306f\u305d\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u4e2d\u304b\u3089\u3060\u3051\u6307\u5b9a\u3057\u305f\u4f9d\u5b58\u3092\u53d6\u308a\u9664\u304d\u307e\u3059\u3002\n\n# \u30c4\u30a4\u30fc\u30c8\u306e\u30c7\u30b6\u30a4\u30f3\n\n\u3055\u3066\u3001\u305d\u308c\u3067\u306f\u30a6\u30a7\u30d6\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u30c7\u30b6\u30a4\u30f3\u3057\u3066\u3044\u304d\u307e\u3057\u3087\u3046\u3002\n![tweet.png](https://qiita-image-store.s3.amazonaws.com/0/58240/570ae6bd-7f36-2cd4-5599-9d6a5e989a3b.png)\n\u4eca\u56de\u306f[Display Requirement](https://about.twitter.com/ja/company/display-requirements)\u306b\u53ef\u80fd\u306a\u9650\u308a\u6e96\u62e0\u3059\u308b\u305f\u3081\u306b\u3001\u30a6\u30a7\u30d6\u3067\u306e\u30c4\u30a4\u30fc\u30c8\u8868\u793a\u3092\u6a21\u5023\u3059\u308b\u3053\u3068\u306b\u3057\u307e\u3059\u3002\n\n## hiccup \u3068 vector\n\n\u30ec\u30a4\u30a2\u30a6\u30c8\u3092\u6574\u7406\u3057\u307e\u3057\u3087\u3046\u3002\u307e\u305a\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a4\u884c\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u306e\u306f\u3059\u3050\u306b\u60f3\u50cf\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\n\n* 1\u884c\u76ee: \u30e6\u30fc\u30b6\u60c5\u5831\n* 2\u884c\u76ee: \u672c\u6587\n* 3\u884c\u76ee: \u6295\u7a3f\u65e5\n* 4\u884c\u76ee: \u5404\u7a2e\u30b3\u30de\u30f3\u30c9\u30a2\u30a4\u30b3\u30f3\n\n\u3053\u308c\u3089\u306e\u69cb\u9020\u3092 hiccup \u304c\u89e3\u91c8\u3067\u304d\u308b vector \u306e\u5f62\u3067\u8868\u73fe\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```clj\n[:div.tweet [:div.user]\n            [:div.text]\n            [:div.created_at]\n            [:div.actions]]\n```\n\n\u3053\u306e4\u884c\u306e vector \u305d\u308c\u305e\u308c\u306e\u5185\u5074\u306b\u3001\u5b9f\u969b\u306b\u8868\u793a\u3059\u308b\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u633f\u5165\u3057\u3066\u3044\u304d\u307e\u3059\u3002\u30ad\u30fc\u30ef\u30fc\u30c9\u306e\u540d\u524d\u306e\u5185\u3001`#` \u3084 `.` \u306e\u524d\u306b\u3042\u308b\u90e8\u5206\u304c\u30bf\u30b0\u306e\u8981\u7d20\u540d\u3067\u3059\u3002\u8981\u7d20\u540d\u306b `#` \u304c\u7d9a\u304f\u5834\u5408\u306f\u3001\u305d\u306e\u8981\u7d20\u306b id \u5c5e\u6027\u304c\u5272\u308a\u632f\u3089\u308c\u3001 `.` \u304c\u7d9a\u304f\u5834\u5408\u306f class \u5c5e\u6027\u304c\u5272\u308a\u632f\u3089\u308c\u307e\u3059\u3002\u305d\u308c\u4ee5\u5916\u306e\u5c5e\u6027\u3092\u4ed8\u4e0e\u3059\u308b\u5834\u5408\u306f\u3001\u305d\u306e\u8981\u7d20\u3068\u540c\u3058 vector \u306e\u4e2d\u306b Map \u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001\n\n```clj\n[:div.tweet {:data-role \"list\"} some-content]\n```\n\n\u3053\u3093\u306a\u611f\u3058\u306b\u3002\u4eca\u56de\u306f\u3001\u524d\u56de\u306e\u8a18\u4e8b\u3068\u4f75\u305b\u3066\u30c6\u30b9\u30c8\u306e\u66f8\u304d\u65b9\u3068 Clojure \u81ea\u4f53\u3067\u306e\u30a6\u30a7\u30d6\u30b3\u30f3\u30c6\u30f3\u30c4\u306e\u751f\u6210\u306e\u4ed5\u65b9\u306b\u7740\u76ee\u3059\u308b\u305f\u3081\u3001 CSS \u306e\u5185\u5bb9\u306f\u4e00\u65e6\u5f8c\u56de\u3057\u306b\u3057\u307e\u3057\u3087\u3046(\u307e\u305f\u5f8c\u306e\u8a18\u4e8b\u3067\u8a73\u3057\u304f\u8ffd\u3063\u3066\u3044\u304d\u307e\u3059)\u3002\u3053\u306e\u69cb\u9020\u306b\u5b9f\u969b\u306e\u30c4\u30a4\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u3092\u633f\u5165\u3057\u3066\u3044\u304d\u307e\u3059\u3002Twitter \u304b\u3089 JSON \u3092\u8cb0\u3063\u3066\u304f\u308b\u90e8\u5206\u306f\u524d\u56de\u306e\u8a18\u4e8b\u3067\u66f8\u3044\u305f\u306e\u3067\u3001\u3042\u308c\u3092\u6398\u308a\u8d77\u3053\u3057\u307e\u3057\u3087\u3046\u3002\u3048\u3048\u3068\u3001\u78ba\u304b\u2026\n\n```clj\n(defn- status-show\n  [^long id]\n  (let [url    \"http://api.twitter.com/1.1/statuses/show/\"\n        ; OAuth\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5074\u306b\u30af\u30a8\u30ea\u6587\u5b57\u5217\u306e\u305f\u3081\u306eWrapper\u306f\u306a\u3044\u3002\n        params {:headers      {\"authorization\" (authorization-header (credentials url (str id \".json\")))}\n                :query-params {:id id}}]\n       (http/get url params)))\n```\n\n\u305d\u3046\u305d\u3046\u3001\u3053\u308c\u3067\u3059\u306d\u3002\u4eca\u56de\u306f\u3053\u308c\u3092\n\n1. URL\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u6307\u5b9a\u3055\u308c\u305f id \u3092\u5143\u306b Twitter \u304b\u3089 JSON \u30c7\u30fc\u30bf\u3092\u8cb0\u3063\u3066\u304f\u308b\n2. **JSON \u3092 Clojure \u306e Map \u306b\u5909\u63db\u3059\u308b**\n3. **Map \u306e\u4e2d\u306e\u30c7\u30fc\u30bf\u3092\u3082\u3068\u306b\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u751f\u6210\u3059\u308b**\n\n\u4e0a\u8a183\u3064\u306e\u6d41\u308c\u306b\u5909\u3048\u307e\u3059\u3002\u3053\u308c\u306b\u4f34\u3044\u3001\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306e\u898b\u76f4\u3057\u3082\u884c\u3044\u307e\u3059\u3002\u4eca\u5ea6\u306fJSON\u304c\u6b63\u3057\u304f\u8fd4\u3063\u3066\u304d\u305f\u304b\u3060\u3051\u3067\u306f\u306a\u304f\u3001**\u6307\u5b9a\u3057\u305f id \u306e\u30c4\u30a4\u30fc\u30c8\u3068\u540c\u3058\u5185\u5bb9\u3067 vector \u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u304b**\u3001\u305d\u3057\u3066**\u305d\u306e vector \u304b\u3089 HTML \u304c\u671f\u5f85\u901a\u308a\u306b\u751f\u6210\u3055\u308c\u3066\u3044\u308b\u304b**\u3092\u78ba\u8a8d\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n# \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306e\u4fee\u6b63\n\n## \u5b8c\u6210\u5f62\u306e\u30a4\u30e1\u30fc\u30b8\n\nvector \u306e\u5f62\u3092\u30a4\u30e1\u30fc\u30b8\u3057\u307e\u3057\u3087\u3046\u3002\u5b9f\u88c5\u30b3\u30fc\u30c9\u306b\u9593\u9055\u3044\u304c\u306a\u3051\u308c\u3070\u3001\n\n```clj\n; tweet \u3068\u3044\u3046\u540d\u306e JSON \u3092\u53d7\u3051\u53d6\u3063\u305f\u3068\u4eee\u5b9a\u3057\u3066\u2026\n[:div.tweet [:div.user [:a {:href (str \"https://twitter.com/\" (get-in tweet [:user :screen_name]))}\n            ; profile_image_url \u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u6271\u3044\u306f\u3001\u8a2d\u5b9a\u3092\u53c2\u7167\u3057\u3066HTTPS\u306b\u3059\u308b\u304b\u3069\u3046\u304b\u3092\u9078\u629e\u3059\u308b\u3088\u3046\u306b\u306f\u3057\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u308b\u3002\n                           [:img.avatar {:src (get-in tweet [:user :profile_image_url])}]\n                           [:strong.name (get-in tweet [:user :name])]\n                           [:span.screen_name (str \"@\" (get-in tweet [:user :screen_name]))]]]\n            [:div.text (:text tweet)]\n            [:div.created_at (:created_at tweet)]\n            [:div.actions #_\"\u3053\u3053\u306f\u4fdd\u7559\"]]\n```\n\n\u307e\u305a\u3053\u3093\u306a vector \u304c\u751f\u6210\u3055\u308c\u3001\u305d\u308c\u3092 hiccup \u306e html \u30de\u30af\u30ed\u306b\u89e3\u91c8\u3055\u305b\u308b\u3053\u3068\u3067\u6700\u7d42\u7684\u306a HTML \u6587\u5b57\u5217\u304c\u751f\u6210\u3055\u308c\u307e\u3059(\u30a2\u30af\u30b7\u30e7\u30f3\u30dc\u30bf\u30f3\u306e\u3068\u3053\u308d\u306f CSS \u4f9d\u5b58\u306a\u306e\u3067\u5f8c\u56de\u3057\u306b\u3057\u307e\u3059)\u3002\u3053\u306e vector \u306f html \u30de\u30af\u30ed\u306b\u89e3\u91c8\u3055\u305b\u308b\u3068\u3001\n\n```html\n<div class=\"tweet\">\n  <div class=\"user\">\n    <a href=\"https://twitter.com/<screen_name \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u30b9\u30af\u30ea\u30fc\u30f3\u540d>\">\n      <img src=\"<profile_image_url_https \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b URL>\" class=\"avatar\" />\n      <strong class=\"name\">&lt;name \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u30e6\u30fc\u30b6\u540d&gt;</strong>\n      <span class=\"screen_name\">&lt;screen_name \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b screen\u540d&gt;</span>\n    </a>\n  </div>\n  <div class=\"text\">&lt;text \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u30c4\u30a4\u30fc\u30c8\u672c\u6587&gt;</div>\n  <div class=\"created_at\">&lt;created_at \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6295\u7a3f\u65e5(\u8981\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u5909\u63db)&gt;</div>\n  <div class=\"actions\">&lt;\u8fd4\u4fe1\u7b49\u306e\u5404\u7a2e\u30a2\u30af\u30b7\u30e7\u30f3\u30dc\u30bf\u30f3(\u4eca\u56de\u306f\u5f8c\u56de\u3057)&gt;</div></div>\n```\n\n\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059(\u5b9f\u969b\u306b\u306f\u30a4\u30f3\u30c7\u30f3\u30c8\u3055\u308c\u306a\u3044\u3053\u3068\u306b\u6ce8\u610f)\u3002\n\n## \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306e\u62e1\u5f35\n\n\u3053\u308c\u3089\u306e vector \u3068 HTML \u6587\u5b57\u5217\u306e\u30c6\u30b9\u30c8\u3092\u52a0\u3048\u308b\u3068\u3001\u65b0\u3057\u3044\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```clj\n(ns <project-name>.core.handler-test\n  (:require [clojure.test :refer :all]\n            [ring.mock.request :as mock]\n            [<project-name>.core.handler :refer :all]\n            [data.json :as json]\n            [oauth.client :as oauth]\n            [clj-http.client :as http]\n            [hiccup.core :as hiccup]))\n\n(deftest test-status\n         ; /<screen_name>/status/xx \u304c Twitter \u3078\u306e\u63a5\u7d9a\u306b\u6210\u529f\u3059\u308b\u304b\u3069\u3046\u304b\u3002\n         ; \u5931\u6557\u3057\u305f\u5834\u5408\u306f\u3001\u4f55\u3089\u304b\u306e\u63a5\u7d9a\u4f8b\u5916\u304b -1 \u304c\u8fd4\u308b\u3060\u308d\u3046\u3002\n         ; \u3053\u3053\u3067\u3001 status \u30d5\u30a3\u30fc\u30eb\u30c9(\u30c4\u30a4\u30fc\u30c8\u306e\u3067\u306f\u306a\u304f\u3001HTTP \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u306e\u65b9)\u3092\u898b\u3064\u3051\u3089\u308c\u306a\u304b\u3063\u305f\u5834\u5408\u306f\n         ; \u660e\u793a\u7684\u306b -1 \u3092\u8fd4\u3059\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\n         (testing \"Tests for connection success:\"\n                  (is (not= -1\n                            (-> (get (app (mock/request :get \"/<screen_name>/status/xx\")))\n                                (get :status -1)))\n                      \"The connection failed.\"))\n         ; /status/:id \u304c\u6b63\u5e38\u306b\u6a5f\u80fd\u3059\u308b\u304b\u3002\u304b\u306a\u308a\u5f37\u5f15\u306a\u3084\u308a\u65b9\u3067\u30c6\u30b9\u30c8\u3057\u3066\u3044\u308b(\u5f8c\u8ff0)\u3002\n         (testing \"Tests for /status/:id:\"\n                  ; \u63a5\u7d9a\u81ea\u4f53\u304c\u6210\u529f\u3057\u3066\u3044\u308c\u3070\u3001\u3044\u305a\u308c\u306e\u5834\u5408\u3082 Twitter \u306f JSON \u3092\u8fd4\u3059\u3002\n                  (testing \"Correctness of returned JSON:\"\n                           (is (instance? clojure.lang.IPersistentMap\n                                          (-> (@#'<project-name>.core.handler/get-json xx)\n                                              (get :body)\n                                              (json/read-str :keyword-fn keyword)))\n                               \"Invalid JSON form.\"))\n                  (with-test\n                    (defn- valid-vector\n                      [tweet]\n                      [:div.tweet [:div.user [:a {:href (str \"https://twitter.com/\" (get-in tweet [:user :screen_name]))}\n                                                 [:img.avatar {:src (get-in tweet [:user :profile_image_url])}]\n                                                 [:strong.name (get-in tweet [:user :name])]\n                                                 [:strong.screen_name (str \"@\" (get-in tweet [:user :screen_name]))]]]\n                                  [:div.text (:text tweet)]\n                                  [:div.created_at (:created_at tweet)]\n                                  [:div.actions #_\"\u3053\u3053\u306f\u4fdd\u7559\"]])\n                    ; JSON \u306e\u5185\u5bb9\u304c\u6b63\u3057\u304f vector \u306b\u5c55\u958b\u3055\u308c\u3066\u3044\u308b\u304b(hiccup \u306b\u89e3\u91c8\u3055\u305b\u308b\u4e00\u6b69\u524d)\n                    (testing \"Correctness of expanded vector:\"\n                             (is (= (-> (@#'<project-name>.core.handler/get-json xx)\n                                        (json/read-str :keyword-fn keyword)\n                                        valid-vector)\n                                    (-> (@#'<project-name>.core.handler/get-json xx)\n                                        @#'<project-name>.core.handler/to-vector))\n                                 \"Incorrect expanded vector.\"))\n                    ; \u6700\u7d42\u7684\u306b\u51fa\u529b\u3055\u308c\u308b HTML \u306f\u6b63\u3057\u3044\u304b\n                    (testing \"Correctness of converted HTML:\"\n                             (is (= (-> (@#'<project-name>.core.handler/get-json xx)\n                                        (json/read-str :keyword-fn keyword)\n                                        valid-vector\n                                        hiccup/html)\n                                    (-> (app (mock/request :get \"/<screen_name>/status/xx\"))\n                                        (get :body)))\n                                 \"Incorrect output HTML.\")))))\n\n(deftest test-authorize\n         (are [valid-param requested-param] (= valid-param requested-param)\n              ; Twitter\u5074\u306e\u8a8d\u8a3c\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3067\u304d\u3066\u3044\u308b\u304b\n              (str \"https://api.twitter.com/oauth/authorize?oauth_token=\" <token>) (get-in (app (mock/request :get \"/auth/twitter\"))\n                                                                                           [:headers \"location\"]\n                                                                                           \"\")\n\n              ; Twitter\u304b\u3089\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u305f\u6642\u3001 oauth_token \u3068 oauth_verifier \u306f\u6b63\u3057\u304f\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u304b\u3002\n              ; Twitter \u306e /oauth/authorize \u3067\u306e\u8a8d\u8a3c\u304c\u7d42\u308f\u3063\u3066\u3053\u3061\u3089\u5074\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u304d\u305f\u6642\u306b\u3001\n              ; \u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u6e21\u3055\u308c\u3066\u304d\u305f oauth_token \u3068 oauth_verifier \u304c \u30af\u30c3\u30ad\u30fc\u306b\u6b8b\u3063\u3066\u3044\u308b\u304b \u3092\u78ba\u8a8d\u3059\u308b\u3002\n              true (let [request (mock/request :get \"/auth/twitter\" {:oauth_token <token> :oauth_verifier <verifier>})\n                         request (mock/header request \"referer\" (str \"https://api.twitter.com/oauth/authorize?=\" <token>))\n                         requested (app request)]\n                        (and from-twitter?\n                             (not-any? false?\n                                       [(get-in requested [:headers \"Set-Cookie\" \"oauth_token\"] false)\n                                        (get-in requested [:headers \"Set-Cookie\" \"oauth_verifier\"] false)])))))\n```\n\n\u524d\u56de\u306b\u6bd4\u3079\u3066\u5927\u5e45\u306a\u5909\u66f4\u304c\u5165\u308a\u307e\u3057\u305f\u3002\u3053\u306e\u4e2d\u3067\u3082\n\n* testing \u30de\u30af\u30ed\n* is \u3068 are \u306e\u9055\u3044\n* with-test \u30de\u30af\u30ed\n* var \u3078\u306e deref (@#'&lt;project-name&gt;.core.handler/* \u306e\u3053\u3068)\n\n\u4e0a\u8a184\u3064\u306e\u3053\u3068\u306f\u899a\u3048\u3066\u304a\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u9806\u306b\u8aac\u660e\u3057\u307e\u3059\u3002\n\n### testing \u30de\u30af\u30ed\n\n[testing](http://clojure.github.io/clojure/clojure.test-api.html#clojure.test/testing) \u30de\u30af\u30ed\u306f\u3001\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u306e\u524d\u306b\u6307\u5b9a\u3057\u305f\u30e1\u30c3\u30bb\u30fc\u30b8(\u7b2c\u4e00\u5f15\u6570\u306e\u6587\u5b57\u5217)\u3092\u51fa\u529b\u3057\u3066\u304f\u308c\u308b\u30de\u30af\u30ed\u3067\u3059\u3002\u3064\u307e\u308a\u3001\u4e00\u5b9a\u306e\u7bc4\u56f2\u3067\u30c6\u30b9\u30c8\u306b\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3092\u6301\u305f\u305b\u307e\u3059\u3002\u4e0a\u8a18\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306b\u3001\u30cd\u30b9\u30c8\u3057\u305f\u4f7f\u3044\u65b9\u3082\u53ef\u80fd\u3067\u3059\u3002\n\n### is \u3068 are \u306e\u9055\u3044\n\n[is](http://clojure.github.io/clojure/clojure.test-api.html#clojure.test/is) \u306f\u5358\u884c(\u3082\u3061\u308d\u3093\u3001\u8907\u6570\u306e is \u30de\u30af\u30ed\u3092\u66f8\u304d\u9023\u306d\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059)\u3067\u30c6\u30b9\u30c8\u3092\u8d70\u3089\u305b\u308b\u3082\u306e\u3067\u3042\u308b\u306e\u306b\u5bfe\u3057\u3001 [are](http://clojure.github.io/clojure/clojure.test-api.html#clojure.test/are) \u306f\u305d\u306e\u30b9\u30b3\u30fc\u30d7\u306e\u4e2d\u3067\u3001\u540c\u3058\u6bd4\u8f03\u306e\u4ed5\u65b9\u304c\u3067\u304d\u308b\u3082\u306e\u306b\u3064\u3044\u3066\u3001\u8907\u6570\u306e\u5024\u3092\u540c\u6642\u306b\u30c6\u30b9\u30c8\u3059\u308b\u305f\u3081\u306e\u3082\u306e\u3067\u3059\u3002\u5b9f\u969b\u306b\u306f\u3001 are \u306f [clojure.template/do-template](http://clojure.github.io/clojure/clojure.template-api.html#clojure.template/do-template) \u30de\u30af\u30ed\u3092\u4f7f\u3063\u3066\u3001\u8907\u6570\u306e is \u30de\u30af\u30ed\u3092 template \u306b\u6cbf\u3063\u3066\u540c\u6642\u306b\u5c55\u958b\u3057\u3066\u304f\u308c\u307e\u3059\u3002\u4e00\u898b are \u306e\u65b9\u304c\u3068\u306b\u304b\u304f\u4fbf\u5229\u3067\u3059\u304c\u3001 are \u306e\u30b3\u30fc\u30c9\u5c55\u958b\u306f\u4e8b\u524d\u306b\u5f15\u6570\u3068\u3057\u3066\u6e21\u3055\u308c\u305f template \u306e\u5185\u5bb9\u306b\u56fa\u5b9a\u3055\u308c\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u3001is \u3068\u540c\u3058\u3088\u3046\u306b\u5404\u30c6\u30b9\u30c8\u306e\u30a8\u30e9\u30fc\u30d1\u30bf\u30fc\u30f3\u306b\u5bfe\u3057\u3066\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u529b\u3055\u305b\u3066\u3044\u304f\u5834\u5408\u306b\u3064\u3044\u3066\u8003\u3048\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u7d20\u76f4\u306b\u8003\u3048\u308c\u3070\u3001\n\n```clj\n(are [x y msg] (if (= x y) true (throw (Exception. msg)))\n     2 (+ 1 1) \"hoge\"\n     4 (+ 2 2) \"fuga\")\n```\n\n\u3053\u306e\u3088\u3046\u306b\u66f8\u304f\u3060\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n#### is \u306e\u5b9f\u88c5\n\n\u3053\u3053\u3067\u3001 [is \u306e\u30b3\u30fc\u30c9](https://github.com/clojure/clojure/blob/919a7100ddf327d73bc2d50d9ee1411d4a0e8921/src/clj/clojure/test.clj#L541)\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```clj\n(defmacro is\n  \"Generic assertion macro.  'form' is any predicate test.\n  'msg' is an optional message to attach to the assertion.\n  \n  Example: (is (= 4 (+ 2 2)) \\\"Two plus two should be 4\\\")\n  Special forms:\n  (is (thrown? c body)) checks that an instance of c is thrown from\n  body, fails if not; then returns the thing thrown.\n  (is (thrown-with-msg? c re body)) checks that an instance of c is\n  thrown AND that the message on the exception matches (with\n  re-find) the regular expression re.\"\n  {:added \"1.1\"} \n  ([form] `(is ~form nil))\n  ([form msg] `(try-expr ~msg ~form)))\n```\n\nis \u306e\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u51fa\u529b\u306f\u3001\u5c02\u7528\u306e\u6a5f\u80fd\u304c\u4f7f\u308f\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002 try-expr \u30de\u30af\u30ed\u306e\u5b9f\u88c5\u3092\u8ffd\u3063\u3066\u3044\u304f\u3068\u3001 is \u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u51fa\u529b\u306f\u4f8b\u5916\u51e6\u7406\u3092\u30e9\u30c3\u30d7\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3059\u3002\u3053\u306e\u3088\u3046\u306a\u51e6\u7406\u3092 are \u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u3067\u518d\u5b9f\u88c5\u3001\u3068\u3044\u3046\u306e\u306f\u3055\u3059\u304c\u306b\u9762\u5012\u3067\u3059\u306d\u3002\u3067\u306f are \u306e expr \u4e2d\u3067 is \u30de\u30af\u30ed\u3092\u4f7f\u3048\u3070\u3044\u3044\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u305d\u308c\u306f\u69cb\u6587\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002 are \u306f\u30b3\u30fc\u30c9\u5c55\u958b\u6642\u306b is \u306b\u5fc5\u8981\u306a\u5024\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3001\u305d\u3046\u3057\u3066\u51fa\u6765\u305f\u30b3\u30fc\u30c9\u3092\u751f\u6210\u3057\u3066\u3044\u304f\u3088\u3046\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u304b\u3089\u3067\u3059\u3002\u3067\u306f\u3001 try-expr \u30de\u30af\u30ed\u3092\u518d\u5229\u7528\u3059\u308c\u3070\u3044\u3044\u306e\u304b\u3068\u3044\u3046\u3068\u3053\u308d\u3067\u3059\u304c\u3001\u305d\u308c\u306f**\u3084\u3081\u3066\u304a\u304f\u3079\u304d**\u3067\u3057\u3087\u3046\u3002\u306a\u305c\u306a\u3089\u3001 try-expr \u30de\u30af\u30ed\u3092\u4f5c\u3063\u305f\u672c\u4eba\u304c doc \u30b3\u30e1\u30f3\u30c8\u4e2d\u306b\u306f\u3063\u304d\u308a\u3068\u3053\u3046\u66f8\u3044\u3066\u3042\u308b\u304b\u3089\u3067\u3059\u3002\n\n> \"Used by the 'is' macro to catch unexpected exceptions. You don't call this.\" \n\n#### is \u3068 are \u306e\u4f7f\u3044\u5206\u3051\u65b9\n\n\u3053\u306e\u4e8b\u304b\u3089\u3001 is \u3068 are \u306e\u4f7f\u3044\u5206\u3051\u65b9\u306f\u304a\u304a\u3080\u306d\n\n* are \u306f\u3001\u30c6\u30b9\u30c8\u306e\u610f\u5473\u304c\u540c\u3058\u3067\u3042\u308b\u304b\u3001\u540c\u69d8\u306e\u6bd4\u8f03\u304c\u3067\u304d\u308b\u3082\u306e\u30921\u7b87\u6240\u306b\u96c6\u7d04\u3055\u305b\u308b\u6642\u306b\u4f7f\u3046\n* is \u306f\u5358\u884c\u3067\u6e08\u3080\u30c6\u30b9\u30c8\u3084\u3001\u500b\u5225\u306b\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u529b\u3055\u305b\u308b\u5fc5\u8981\u304c\u3042\u308b\u6642\u306b\u4f7f\u3046\n\n\u4e0a\u8a182\u3064\u306b\u843d\u3061\u7740\u304f\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n### with-test \u30de\u30af\u30ed\n\n[with-test](http://clojure.github.io/clojure/clojure.test-api.html#clojure.test/with-test) \u30de\u30af\u30ed\u306f\u3001\u305d\u306e\u30b9\u30b3\u30fc\u30d7\u306e\u4e2d\u3067\u5171\u901a\u306b\u5229\u7528\u3059\u308b\u95a2\u6570\u3092\u65b0\u305f\u306b\u5b9a\u7fa9\u3057\u3064\u3064\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u66f8\u3051\u308b\u30de\u30af\u30ed\u3067\u3059\u3002\u30a4\u30e1\u30fc\u30b8\u306f\u4e01\u5ea6\u4e0a\u8a18\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\n\n### var \u3078\u306e deref\n\n\u4eca\u56de\u306e\u30b3\u30fc\u30c9\u306e\u4e2d\u3067\u6700\u3082\u6ce8\u610f\u304c\u5fc5\u8981\u306a\u306e\u304c\u3001 var \u3078\u306e deref \u3067\u3059\u3002\u901a\u5e38\u3001 Clojure \u3067 deref \u3092\u4f7f\u3046\u6a5f\u4f1a\u304c\u3042\u308b\u3068\u3059\u308c\u3070\u3001\u305d\u308c\u306f\u307b\u3068\u3093\u3069\u306e\u5834\u5408\u306b\u304a\u3044\u3066 ref, atom, agent \u3068\u3044\u3063\u305f\u4e26\u5217\u51e6\u7406\u3084\u4e26\u884c\u51e6\u7406\u306e\u305f\u3081\u306b\u5b9f\u88c5\u3055\u308c\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u72b6\u614b\u3092\u53d6\u5f97\u3059\u308b\u3068\u304d\u3067\u3057\u3087\u3046\u3002\u305d\u308c\u3089\u3068\u540c\u69d8\u306b deref \u304c\u6a5f\u80fd\u3059\u308b\u3068\u3044\u3046\u70b9\u3067\u3001 var \u306b\u3082 IDeref \u306e\u5b9f\u88c5\u304c\u4e0e\u3048\u3089\u308c\u3066\u3044\u308b\u3053\u3068\u306f\u60f3\u50cf\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002\u3057\u304b\u3057\u3001\n\n*\u5916\u306e\u540d\u524d\u7a7a\u9593\u306e var \u3092\u30af\u30a9\u30fc\u30c8\u3057\u3066\u66f4\u306b\u305d\u308c\u3092 deref \u3067\u547c\u3073\u51fa\u3057\u3066\u3044\u308b\uff1f\u3057\u304b\u3082 private \u306a\u95a2\u6570\u304b\u3089\uff1f*\n\n\u304a\u305d\u3089\u304f\u3001\u3069\u3046\u3044\u3046\u3053\u3068\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u304b\u30a4\u30e1\u30fc\u30b8\u304c\u3064\u304d\u306b\u304f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u79c1\u3082\u305d\u3046\u3067\u3057\u305f\u3002\u3053\u306e\u30b3\u30fc\u30c9\u306e\u52d5\u304d\u3092\u7406\u89e3\u3059\u308b\u306b\u306f\u3001\u307e\u305a Clojure \u306e var \u304c\u3069\u3046\u3044\u3046\u5b9f\u88c5\u306a\u306e\u304b\u306b\u3064\u3044\u3066\u77e5\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u7aef\u7684\u306b\u8a00\u3046\u3068\u3001 Clojure \u306e var \u306f\u3001**\u30b7\u30f3\u30dc\u30eb\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3078\u306e\u30dd\u30a4\u30f3\u30bf**\u306a\u306e\u3067\u3059\u3002\u66f4\u306b\u306f\u3001\u52d5\u7684\u5909\u6570\u306e\u305f\u3081\u306e\u30b9\u30ec\u30c3\u30c9\u30ed\u30fc\u30ab\u30eb\u306a\u5024\u3092\u78ba\u4fdd\u3059\u308b\u305f\u3081\u306e\u6a5f\u80fd\u3082\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059(\u4eca\u56de\u306f\u3053\u3053\u306b\u306f\u89e6\u308c\u307e\u305b\u3093)\u3002\u7c21\u5358\u306b\u56f3\u306b\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3059\u3002\n\n```\n       \u53c2\u7167\n[Var] ------> [\u4f55\u3089\u304b\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b7\u30f3\u30dc\u30eb] \u203b\u3053\u306e\u30b7\u30f3\u30dc\u30eb\u306e\u4e2d\u306b\u5b9f\u969b\u306e\u5024\u304c\u3042\u308b\u3002\n```\n\n\u3053\u308c\u306b\u5bfe\u3057\u3066\u5916\u90e8\u304b\u3089 deref \u3067\u547c\u3073\u51fa\u3057\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u3053\u3046\u3044\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n(var \u30af\u30a9\u30fc\u30c8\u306e deref) ---------\n                               |\n       \u53c2\u7167                   \\|/\n[Var] ------> [\u4f55\u3089\u304b\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b7\u30f3\u30dc\u30eb] \u203b\u3053\u306e\u30b7\u30f3\u30dc\u30eb\u306e\u4e2d\u306b\u5b9f\u969b\u306e\u5024\u304c\u3042\u308b\n```\n\n\u3064\u307e\u308a\u3001 var \u305d\u306e\u3082\u306e\u3067\u306f\u306a\u304f\u3001 var \u306e\u53c2\u7167\u5148\u306e\u30b7\u30f3\u30dc\u30eb\u306e\u60c5\u5831\u3092\u76f4\u63a5\u53d6\u5f97\u3057\u3066\u3044\u308b\u306e\u3067\u3059\u3002\n\u3067\u306f\u3001 def \u3067\u5b9a\u7fa9\u3057\u305f var \u306e\u30e1\u30bf\u30c7\u30fc\u30bf\u3068\u3057\u3066\u4ed8\u3051\u308b\u3053\u3068\u304c\u3067\u304d\u308b private \u30ad\u30fc\u30ef\u30fc\u30c9\u306b\u306f\u3069\u3046\u3044\u3046\u610f\u5473\u304c\u3042\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u3002\u4e0a\u56f3\u3092\u898b\u3066\u3044\u308b\u3068\u3001\u5927\u4f53\u60f3\u50cf\u304c\u3064\u304f\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n```\n(var \u30af\u30a9\u30fc\u30c8\u306e deref) --------\n                              |\n       \u53c2\u7167                  \\|/\n[Var] ------> [\u4f55\u3089\u304b\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b7\u30f3\u30dc\u30eb]\n \u2191\nprivate \u30e1\u30bf\u304c\u3064\u304f\u306e\u306f\u3053\u3053\n```\n\nprivate \u30e1\u30bf\u3067\u4fdd\u8b77\u3055\u308c\u308b\u306e\u306f\u3001\u5b9f\u969b\u306e\u5024\u3067\u306f\u306a\u304f\u30dd\u30a4\u30f3\u30bf\u3067\u3042\u308b var \u306e\u65b9\u306a\u306e\u3067\u3059\u3002\u4f55\u6545\u305d\u3046\u306a\u3063\u3066\u3044\u308b\u306e\u304b\u3068\u3044\u3046\u3068\u3001 var \u306f\u3042\u304f\u307e\u3067\u30dd\u30a4\u30f3\u30bf\u306a\u306e\u3067\u3001\u53c2\u7167\u3059\u308b\u5024\u3092\u5f8c\u304b\u3089\u3044\u304f\u3089\u3067\u3082\u5909\u66f4\u3067\u304d\u308b\u304b\u3089\u3067\u3059\u3002\u3088\u3063\u3066\u3001 def \u306b\u3088\u308b var \u306e\u5b9a\u7fa9\u306b\u95a2\u3057\u3066\u306f redefined \u3067\u30a8\u30e9\u30fc\u304c\u98db\u3093\u3067\u304f\u308b\u3053\u3068\u306f\u307e\u305a\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u3053\u308c\u306f\u30b7\u30e3\u30c9\u30a6\u30a4\u30f3\u30b0\u304c\u767a\u751f\u3059\u308b\u8981\u56e0\u3067\u3082\u3042\u308a\u307e\u3059(\u3053\u306e\u3053\u3068\u306b\u3064\u3044\u3066\u307e\u3067\u89e6\u308c\u308b\u3068\u8a71\u304c\u9577\u304f\u306a\u308a\u3059\u304e\u308b\u306e\u3067\u3001\u306f\u3057\u3087\u308a\u307e\u3059\u3002\u8a73\u3057\u304f\u306f\u30b0\u30b0\u30c3\u3066\u306d)\u3002\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001\u4eca\u56de\u306e\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3067\u306f\u3001**\u65b0\u305f\u306b\u66f8\u304d\u76f4\u3055\u308c\u305f\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u306e\u500b\u3005\u306e\u51e6\u7406\u306b\u3064\u3044\u3066\u30c6\u30b9\u30c8\u3059\u308b\u305f\u3081\u306b\u3001\u5916\u90e8\u306b\u3042\u308b\u95a2\u6570\u306e\u53c2\u7167\u5148\u3092\u610f\u56f3\u7684\u306b\u53d6\u5f97\u3057\u306b\u884c\u304f**\u3068\u3044\u3046(\u304b\u306a\u308a\u3080\u3061\u3083\u304f\u3061\u3083\u306a)\u884c\u52d5\u306b\u51fa\u3066\u3044\u305f\u306e\u3067\u3057\u305f\u3002\n\u4eca\u56de\u306e\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u306e\u8aac\u660e\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3002\u3067\u306f\u3001\u6700\u5f8c\u306b\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u306e\u66f8\u304d\u76f4\u3057\u306b\u79fb\u308a\u307e\u3059\u3002\n\n# \u5b9f\u88c5\u30b3\u30fc\u30c9\u306e\u62e1\u5f35\n\n```clj\n(ns <project-name>.core.handler\n  (:require [data.json :as json]\n            [oauth.client :as oauth]\n            [clj-http.client :as http]\n            [hiccup.core :as hiccup])))\n\n(def ^:private consumer-key #_hoge)\n(def ^:private consumer-secret #_fuga)\n\n(def ^:private consumer (oauth/make-consumer <consumer-key>\n                                             <consumer-secret>\n                                             \"https://api.twitter.com/oauth/request_token\"\n                                             \"https://api.twitter.com/oauth/access_token\"\n                                             \"https://api.twitter.com/oauth/authorize\"\n                                             :hmac-sha1))\n\n(def ^:private request-token (oauth/request-token consumer <callback-uri>))\n\n; \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a8d\u8a3c\u753b\u9762(/oauth/authorize?oauth_token=xxxx...) \u306eURL\u3092\u751f\u6210\u3059\u308b\u3002\n; \u300cTwitter\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u300d\u30dc\u30bf\u30f3\u306a\u3069\u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u5148\u306b\u5fc5\u8981\n(def ^:private user-approval-uri (oauth/user-approval-uri consumer\n                                                          (:oauth_token request-token)))\n\n(def ^:private access-token-response (oauth/access-token consumer request-token <verifier>))\n\n(defn- credentials\n  [url params]\n  (oauth/credentials consumer\n                     (:oauth_token access-token-response)\n                     (:oauth_token_secret access-token-response)\n                     :GET\n                     (str url params)))\n\n(defn- get-json\n  [^long id]\n  (let [url    \"http://api.twitter.com/1.1/statuses/show/\"\n        ; OAuth\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5074\u306b\u30af\u30a8\u30ea\u6587\u5b57\u5217\u306e\u305f\u3081\u306eWrapper\u306f\u306a\u3044\u3002\n        params {:headers      {\"authorization\" (authorization-header (credentials url (str id \".json\")))}\n                :query-params {:id id}}]\n       (-> (http/get url params)\n           (json/read-str :keyword-fn keyword))))\n\n(defn- to-vector\n  [tweet]\n  [:div.tweet [:div.user [:a {:href (str \"https://twitter.com/\" (get-in tweet [:user :screen_name]))}\n                             ; profile_image_url \u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u6271\u3044\u306f\u3001\u8a2d\u5b9a\u3092\u53c2\u7167\u3057\u3066 HTTPS \u306b\u3059\u308b\u304b\u3069\u3046\u304b\u3092\u9078\u629e\u3059\u308b\u3088\u3046\u306b\u306f\u3057\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u308b\u3002\n                             [:img.avatar {:src (get-in tweet [:user :profile_image_url])}]\n                             [:strong.name (get-in tweet [:user :name])]\n                             [:span.screen_name (str \"@\" (get-in tweet [:user :screen_name]))]]]\n              [:div.text (:text tweet)]\n              [:div.created_at (:created_at tweet)]\n              [:div.actions #_\"\u3053\u3053\u306f\u4fdd\u7559\"]])\n\n(defn- status-show\n  [^long id]\n  (-> (get-json id)\n      to-vector\n      hiccup/html))\n\n(defroutes app-routes\n           ; Twitter\u8a8d\u8a3c(\u4eca\u56de\u306e\u8a18\u4e8b\u3067\u306f\u7701\u7565)\n           (GET \"/auth/twitter\" [] get-auth)\n           (context \"/:screen_name\" [^String screen_name]\n                    (GET \"/\" [] #_\"\u3053\u3063\u3061\u5074\u306e\u30b5\u30fc\u30d0 \u304b\u3089 \u6700\u65b0\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97 \u3059\u308b\u51e6\u7406\")\n                    (GET \"/status/:id\" [^long id] (status-show id))))\n\n(def app (wrap-defaults app-routes site-defaults))\n```\n\n# \u307e\u3068\u3081\u3068\u304b\u96d1\u611f\u3068\u304b\n\n* clojure.test \u306e\u30de\u30af\u30ed\u306f\u5730\u5473\u306b\u4fbf\u5229\u3002\n\n\u3067\u3082\u30a6\u30a7\u30d6\u3060\u3068\u3084\u3063\u3071\u308a MVC \u304c\u3061\u3083\u3093\u3068\u63c3\u3063\u3066\u306a\u3044\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306e\u30c6\u30b9\u30c8\u306f\u307e\u3060\u8f9b\u3044\u2026\n\n* Clojure \u306e Var \u306f deref \u3067\u304d\u308b\u3002*\u4f8b\u3048\u305d\u308c\u304c private \u306a Var \u3067\u3042\u3063\u3066\u3082\u3002*\n\n\u3067\u3082\u3067\u304d\u308b\u306a\u3089\u4f7f\u308f\u305a\u306b\u5c45\u305f\u3044\u3088\u306d\u2026\u3002*\u540d\u524d\u7a7a\u9593\u5b8c\u5168\u4fee\u98fe\u3068\u304b\u3081\u3093\u3069\u3044\u2026*[[1]](#note1)\n\n* \u306c\u308f\u3042\u3042\u3042\u3042\u3093\u30a6\u30a7\u30d6\u958b\u767a\u75b2\u308c\u305f\u3082\u304a\u304a\u304a\u3093\n\n\u3053\u306e\u8fba\uff08\uff1f\uff09\u306b\u3043\u3001\u92ad\u6e6f\u306e\u5e97\u3001\u3042\u308b\u3093\u3067\u3059\u3051\u3069\u3001\u884c\u304b\u306a\u3044\u3063\u3059\u304b\uff1f\n\uff1f\uff1f\uff1f\u300c\u304a\u3063\u305d\u3046\u3060\u306a\u300d\n\u3058\u3083\u3051\u3093\u591c\u884c\u304d\u307e\u3057\u3087\u3046\u306d\u3002\n\u2026\u2026\u2026\uff87\uff6f(\u5927\u96ea)\n\u3082\u3046\u3084\u3081\u305f\u304f\u306a\u308a\u307e\u3059\u3088\u301c\u5916\u51fa\u30a5\u301c\n\n(\u8a71\u3092)\u3082\u3069\u3057\u3066\u3001compojure \u3092\u4f7f\u3046\u30e1\u30ea\u30c3\u30c8\u306f\uff1f\n\n* ring \u3068\u4f5c\u8005\u304c\u540c\u3058\u306a\u306e\u3067\u3001\u57fa\u672c\u7684\u306b\u306f\u4e00\u4eba\u306e\u4f5c\u8005\u3060\u3051\u3092\u8ffd\u3044\u304b\u3051\u3066\u3044\u308c\u3070\u3088\u3044\u3002(\u591a\u5206\u3001\u4f9d\u5b58\u3082\u305d\u3053\u307e\u3067\u3053\u3093\u304c\u3089\u304c\u3089\u306a\u3044)\n* \u4f5c\u308a\u81ea\u4f53\u306f\u5272\u3068\u30b7\u30f3\u30d7\u30eb\u306a\u306e\u3067\u3001\u30a6\u30a7\u30d6\u958b\u767a\u306e\u7df4\u7fd2\u7528\u3068\u3057\u3066\u3082\u305d\u308c\u307b\u3069\u60aa\u304f\u306f\u306a\u3044\u3002\n* \u57fa\u672c\u7684\u306b\u306f\u3001\u3053\u308c\u306b\u52a0\u3048\u3066\u305d\u306e\u76ee\u7684\u306b\u3042\u3063\u305f\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u3044\u304f\u3064\u304b\u8ffd\u52a0\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3060\u3051\u3067\u3088\u3044\u3002\n\n\u2026\u2026\u2026\u30c7\u30e1\u30ea\u30c3\u30c8\u306f\uff1f\n\n* \u306a\u3044\u3067\u3059(\u5927\u5618)\n * \u30cf\u30f3\u30c9\u30e9\u3068\u30d3\u30e5\u30fc\u304c\u76f4\u7d50\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4eca\u56de\u306e\u8a18\u4e8b\u306e\u5185\u5bb9\u304b\u3089\u3082\u60f3\u50cf\u304c\u3064\u304f\u3088\u3046\u306b\u3001HTML \u51fa\u529b\u304c\u7d61\u307f\u51fa\u3059\u3068\u305d\u306e\u5206\u3060\u3051\u30c6\u30b9\u30c8\u306e\u96e3\u6613\u5ea6\u304c\u4e0a\u304c\u3063\u3066\u304f\u308b(\u4eca\u56de\u306f\u30c4\u30a4\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u5358\u4f53\u3092 HTML \u3067\u30c7\u30b3\u30ec\u30fc\u30c8\u3059\u308b\u3060\u3051\u3060\u3063\u305f\u3051\u308c\u3069\u3082\u3001\u3053\u308c\u304c\u4e00\u5ea6\u306b\u30ea\u30b9\u30c8\u8868\u793a\u3059\u308b\u3068\u304b\u306a\u308b\u3068\u2026(\u00b4\uff65_\uff65`))\u3002\n * \u30eb\u30fc\u30c8\u306e\u5b9a\u7fa9\u306e\u4ed5\u65b9\u306f\u3001\u30de\u30af\u30ed\u306e\u5b9f\u88c5\u306b\u3088\u308a\u6c7a\u3081\u3089\u308c\u3066\u3044\u308b\u3002\u3064\u307e\u308a\u3001\u30cf\u30fc\u30c9\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u3057\u304b\u306a\u3044\u3002API \u306e\u4e2d\u306b\u73fe\u5728\u306e\u30eb\u30fc\u30c8\u3092\u53d6\u5f97\u3057\u305f\u308a\u3001\u30eb\u30fc\u30c8\u306b\u4f55\u3089\u304b\u306e\u5024\u3092\u8ffd\u52a0\u3057\u3066\u65b0\u3057\u3044\u30eb\u30fc\u30c8\u3092\u4f5c\u308b\u305f\u3081\u306e\u3082\u306e\u304c\u306a\u3044(HTTP \u30d8\u30c3\u30c0\u4e2d\u306e uri \u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u4e0a\u624b\u304f\u4f7f\u3048\u3070\u306a\u3093\u3068\u304b\u306a\u308a\u305d\u3046\u306a\u6c17\u304c\u3057\u3066\u3044\u308b\u3002\u4eca\u306e\u3068\u3053\u308d\u8a66\u3059\u6c17\u306f\u306a\u3044\u3051\u308c\u3069)\u3002\u3082\u3057\u4eca\u3059\u3050\u5fc5\u8981\u3060\u3068\u3044\u3046\u65b9\u306f bidi \u3092\u63a2\u3057\u3066\u3001\u3069\u3046\u305e\u3002\n * \u3088\u3063\u3066\u3001\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u3092\u30da\u30fc\u30b8\u5316\u3057\u3066\u5c0f\u5206\u3051\u306b\u8868\u793a\u3059\u308b\u3068\u304b\u3001\u305d\u3046\u3044\u3046\u6a5f\u80fd\u306f\u73fe\u5728\u306e\u5b9f\u88c5\u3060\u3051\u3067\u306f\u5229\u7528\u3067\u304d\u306a\u3044\u3002\u305d\u3082\u305d\u3082\u30da\u30fc\u30b8\u5316\u304c\u4e0d\u8981\u3067\u3001\u4eca\u6d41\u884c\u308a\u306e\u30ea\u30c3\u30c1\u306a\u9045\u5ef6\u8868\u793a\u3067\u3044\u3044\u3068\u3044\u3046\u306e\u3067\u3042\u308c\u3070\u3001\u5272\u3068\u306a\u3093\u3068\u304b\u306a\u308a\u305d\u3046\u306a\u6c17\u304c\u3059\u308b\u3002\n * \u30df\u30cb\u30de\u30eb\u69cb\u6210\u3067\u3042\u308b(== \u30aa\u30fc\u30eb\u30a4\u30f3\u30ef\u30f3\u3067\u306f\u306a\u3044)\u304c\u6545\u306e\u3042\u308c\u3053\u308c\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u307e\u3060\u305d\u306e\u4e8b\u614b\u306b\u306f\u906d\u9047\u3057\u305f\u3068\u3044\u3046\u8a71\u306f\u805e\u304d\u53ca\u3093\u3067\u3044\u306a\u3044\u304c\u3001\u4f9d\u5b58\u5730\u7344\u306b\u9665\u3089\u306a\u3044\u3068\u306f\u8a00\u3044\u5207\u308c\u306a\u3044\u3002(yesod \u3068\u304b\u4f7f\u3063\u305f\u3053\u3068\u3042\u308b\u4eba\u306a\u3089\u308f\u304b\u308b\u3068\u601d\u3046\u3002\u307e\u3042\u3001\u3042\u308c\u306f cabal \u304c\u4e0a\u624b\u306b\u4f9d\u5b58\u89e3\u6c7a\u3057\u304d\u308c\u3066\u306a\u3044\u306e\u304c\u539f\u56e0\u3060\u3063\u305f\u308f\u3051\u3060\u3051\u3069\u3082\u3002 stack \u306f\u305d\u306e\u3078\u3093\u3069\u3046\u3060\u3063\u3051\u306a\u2026)[[2]](#note2)\n\n\u3067\u306f\u3001compojure \u3068\u305d\u306e\u5468\u8fba\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3082\u6bd4\u8f03\u7684\u958b\u767a\u304c\u7528\u610f\u306a\u30d1\u30bf\u30fc\u30f3\u306f\u306a\u3093\u3060\u308d\u3046\u304b\u3002\n\n* \u304a\u305d\u3089\u304f\u3001 REST API\n * \u3064\u307e\u308a\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u5bfe\u3057\u3066\u8fd4\u3059\u3082\u306e\u304c HTML \u6587\u5b57\u5217\u3067\u306f\u306a\u304f\u3001JSON \u306a\u3069\u306e\u5f62\u5f0f\u306e\u6c7a\u307e\u3063\u305f\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u307f\u3067\u3042\u308b\u3001\u3068\u3044\u3046\u3082\u306e\u3002\n * \u8fd4\u308a\u5024\u3068\u306a\u308b JSON \u306f\u3001 parse \u3059\u308c\u3070 Clojure \u3067\u3082\u5bb9\u6613\u306b\u6271\u3048\u308b(== Clojure\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u306b\u7f6e\u304d\u63db\u3048\u3066\u30c6\u30b9\u30c8\u3067\u304d\u308b)\u3002*\u305f\u3060\u3001 Twitter \u306e JSON \u306f\u3081\u3093\u3069\u3044\u2026*\n * \u305d\u3082\u305d\u3082\u30a6\u30a7\u30d6\u30d6\u30e9\u30a6\u30b6\u4e0a\u3067\u8868\u793a\u3059\u308b\u3053\u3068\u306e\u65b9\u304c\u5c11\u306a\u3044 API \u306a\u306e\u3067\u3001\u30a6\u30a7\u30d6\u3068\u3044\u3046\u3088\u308a\u306f\u3001\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u958b\u767a\u306b\u8fd1\u3044\n\n\u3067\u306f\u3067\u306f\u3001\u304a\u3084\u3059\u307f\u306a\u3055\u3044\u301c\u3002\n\n\u3042\u3001\u7686\u3055\u3093\u3001\u3088\u3044\u304a\u5e74\u3092\uff01\n\n# \u8ffd\u8a18\n\n<a id=\"note1\">[1]</a> var \u30af\u30a9\u30fc\u30c8\u3067\u3042\u3063\u3066\u3082\u3001\u540d\u524d\u7a7a\u9593\u306e\u5225\u540d\u4fee\u98fe\u306f\u53ef\u80fd\u3002(@ayato_p \u3055\u3093\u306e\u3054\u6307\u6458\u306e3.)\n<a id=\"note2\">[2]</a> \u4f9d\u5b58\u95a2\u4fc2\u306f\u3001 bidi \u306e\u305d\u308c\u306b\u6bd4\u3079\u308c\u3070\u5927\u304d\u3044\u65b9(@ayato_p \u3055\u3093\u3054\u6307\u6458\u306e5.)\u3002\u304a\u305d\u3089\u304f\u3001\u8907\u6570\u306e\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u30e9\u30a4\u30d6\u30e9\u30ea\u3092(\u672c\u4eba\u304c\u81ea\u4f5c\u3057\u305f\u306e\u3082\u542b\u3081\u3066)\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u5229\u7528\u3057\u3066\u3044\u308b\u304b\u3089\u3060\u3068\u601d\u308f\u308c\u308b\n", "tags": ["Clojure", "AdventCalendar", "Compojure", "ring"]}