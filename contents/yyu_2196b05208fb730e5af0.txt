{"context": "\n\n\u306f\u3058\u3081\u306b\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u4fdd\u5b58\u3059\u308b\u969b\u306b\u3088\u304f\u7528\u3044\u3089\u308c\u308b\u30bd\u30eb\u30c8\u3068\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u4f7f\u3046\u3084\u308a\u65b9\u306b\u3064\u3044\u3066\u3001\u306a\u305c\u305d\u308c\u304c\u5fae\u5999\u3067\u3042\u308b\u304b\u3092\u89e3\u8aac\u3057\u305f\u5f8c\u306b\u3001\u305d\u308c\u3092\u89e3\u6c7a\u3059\u308b\u65b9\u6cd5\u3092\u7d39\u4ecb\u3059\u308b\u3002\n\u3082\u3057\u8a18\u4e8b\u306e\u4e2d\u306b\u4f55\u304b\u8aa4\u308a\u304c\u3042\u308c\u3070\u3001\u6c17\u8efd\u306b\u6307\u6458\u3057\u3066\u6b32\u3057\u3044\u3068\u601d\u3046\u3002\n\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3068\u30bd\u30eb\u30c8\u3092\u7528\u3044\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u4fdd\u5b58\n\u4f8b\u3048\u3070\u6b21\u306e\u3088\u3046\u306a\u5909\u6570\u3068\u95a2\u6570\u304c\u3042\u308b\u3068\u3059\u308b\u3002\n\n\n\n\u5909\u6570\n\u610f\u5473\n\n\n\n\nmm\n\u30d1\u30b9\u30ef\u30fc\u30c9\uff08\u30e1\u30c3\u30bb\u30fc\u30b81\uff09\n\n\nkk\n\u30bd\u30eb\u30c8\n\n\nHH\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\n\n\na\u2223\u2223ba \\mid\\mid b\n\u6587\u5b57\u5217aa\u3068bb\u306e\u7d50\u5408\n\n\n\n\u3059\u308b\u3068\u3001\u6b21\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u304b\u3089\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u6c42\u3081\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306a\u3069\u306b\u4fdd\u5b58\u3059\u308b\u30b1\u30fc\u30b9\u304c\u591a\u3044\u3068\u601d\u3046\u3002\nhp = H(k \\mid\\mid m)\nhp=H(k\u2223\u2223m){hp = H(k \\mid\\mid m)\n}\n\u3057\u304b\u3057\u3001\u4f7f\u3046\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u3088\u3063\u3066\u306f\u3001\u3053\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3067\u3042\u308b\u3068\u554f\u984c\u304c\u8d77\u304d\u308b\u3002\n\n\u524d\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u4e0e\u3059\u308b\u65b9\u6cd5\u3068\u4f38\u9577\u653b\u6483\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u3088\u3063\u3066\u306f\u3001\u4f38\u9577\u653b\u6483\u3068\u547c\u3070\u308c\u308b\u6b21\u306e\u3088\u3046\u306a\u653b\u6483\u304c\u53ef\u80fd\u306a\u3082\u306e\u304c\u3042\u308b\u3002\n\nmm\u3068kk\u306b\u3088\u308b\u30cf\u30c3\u30b7\u30e5\u5024H(k\u2223\u2223m)H(k \\mid\\mid m)\u304c\u5206\u304b\u308b\u3068\u3001mm\u306b\u9069\u5f53\u306a\u6587\u5b57\u5217\u3092\u8ffd\u52a0\u3057\u305f\u6587\u5b57\u5217m\u2032m'\u306b\u3064\u3044\u3066\u3001kk\u3092\u77e5\u308b\u3053\u3068\u306a\u304fH(k\u2223\u2223m\u2032)H(k \\mid\\mid m')\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\n\u4f8b\u3048\u3070SHA1\u3084SHA2\u3001MD5\u306a\u3069\u306f\u3053\u306e\u3088\u3046\u306a\u7279\u5fb4\u3092\u6301\u3064\u3002\u5f93\u3063\u3066\u3001\u653b\u6483\u8005\u306f\u3042\u3089\u304b\u3058\u3081\u30011\u6587\u5b57\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3069\u77ed\u3044\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u5165\u624b\u3057\u305f\u5f8c\u3001\u9577\u3044\u6587\u5b57\u5217\u3092\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u3057\u305f\u5834\u5408\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u3088\u3063\u3066\u3001\u3053\u306e\u65b9\u6cd5\u306f\u3084\u3084\u5371\u967a\u3067\u3042\u308b\u3068\u8a00\u3048\u308b\u3002\n\n\u5f8c\u308d\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u4e0e\u3059\u308b\u65b9\u6cd5\n\u3067\u306f\u3001H(m\u2223\u2223k)H(m \\mid\\mid k)\u306e\u3088\u3046\u306b\u5f8c\u308d\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u4e0e\u3059\u308c\u3070\u3088\u3044\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\u78ba\u304b\u306b\u3053\u306e\u65b9\u6cd5\u3067\u4f38\u9577\u653b\u6483\u306f\u3067\u304d\u306a\u304f\u306a\u308b\u304c\u3001\u3053\u306e\u65b9\u6cd5\u3092\u7528\u3044\u308b\u3068\u3001\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u304c\u8106\u5f31\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u3002\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u306f\u6b21\u306e\u3088\u3046\u306a\u6027\u8cea\u304c\u3042\u308b\u3002\n\n\u5f31\u885d\u7a81\u8010\u6027\n\u3042\u308b\u30e1\u30c3\u30bb\u30fc\u30b8mm\u3068\u7b49\u3057\u3044\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u6301\u3064\u3088\u3046\u306am\u2032m'\u3092\u6c42\u3081\u308b\u306e\u304c\u56f0\u96e3\u3067\u3042\u308b\u6027\u8cea\n\n\u5f37\u885d\u7a81\u8010\u6027\n\u4efb\u610f\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u306b\u3064\u3044\u3066\u3001H(m)=H(m\u2032)H(m) = H(m')\u3068\u306a\u308bmm\u3068m\u2032m'\u306e\u7d44\u3092\u898b\u3064\u3051\u308b\u306e\u304c\u56f0\u96e3\u3067\u3042\u308b\u6027\u8cea\n\n\u3053\u306e\u3046\u3061\u3001\u5229\u7528\u3057\u3066\u3044\u308b\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306e\u5f37\u885d\u7a81\u8010\u6027\u304c\u7834\u3089\u308c\u305f\u5834\u5408\u306b\u3064\u3044\u3066\u8003\u3048\u308b\u3002\u4f8b\u3048\u3070\u30cf\u30c3\u30b7\u30e5\u95a2\u6570MD5\u306f\u3059\u3067\u306b\u5f37\u885d\u7a81\u8010\u6027\u304c\u7834\u3089\u308c\u3066\u3044\u308b\u3002\n\u4eca\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u6b21\u306e\u3088\u3046\u306a\u65b9\u6cd5\u3067\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4fdd\u5b58\u3057\u3066\u3044\u308b\u3068\u3059\u308b\u3002\nhp = H(m \\mid\\mid k)\nhp=H(m\u2223\u2223k){hp = H(m \\mid\\mid k)\n}\n\u5f37\u885d\u7a81\u8010\u6027\u304c\u7834\u3089\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u653b\u6483\u8005\u306f\u307e\u305a\u65e2\u77e5\u306e\u30e1\u30c3\u30bb\u30fc\u30b8mm\u306b\u3064\u3044\u3066\u30cf\u30c3\u30b7\u30e5\u5024\u304c\u7b49\u3057\u304f\u306a\u308b\uff08H(m)=H(m\u2032)H(m) = H(m')\u3068\u306a\u308b\uff09m\u2032m'\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002m\u2260m\u2032m \\ne m'\u3067\u3042\u3063\u305f\u3068\u3057\u3066\u3082\u3001H(m)=H(m\u2032)H(m) = H(m')\u3067\u3042\u308b\u3068\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306e\u5185\u90e8\u72b6\u614b\u304ckk\u307e\u3067\u3067\u540c\u3058\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001H(m\u2223\u2223k)=H(m\u2032\u2223\u2223k)H(m \\mid\\mid k) = H(m' \\mid\\mid k)\u3068\u306a\u308a\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u7570\u306a\u308b\u306b\u3082\u95a2\u308f\u3089\u305a\u610f\u56f3\u3057\u306a\u3044\u8a8d\u8a3c\u3092\u3057\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\u3088\u3063\u3066\u3001\u3053\u306e\u3088\u3046\u306b\u5f8c\u65b9\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u4e0e\u3059\u308b\u65b9\u6cd5\u306f\u610f\u56f3\u3057\u306a\u3044\u8a8d\u8a3c\u3092\u3057\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u304c\u3042\u308b\u3068\u8a00\u3048\u308b\u3002\n\n\u30e1\u30c3\u30bb\u30fc\u30b8\u8a8d\u8a3c\u30b3\u30fc\u30c9\u3068HMAC\n\u3053\u308c\u3089\u306e\u5bfe\u7b56\u3068\u3057\u3066\u3001\u6700\u7d42\u7684\u306b\u306fHMAC\u3068\u547c\u3070\u308c\u308b\u65b9\u6cd5\u3092\u7528\u3044\u308b\u306e\u304c\u3088\u3044\u3068\u3055\u308c\u3066\u3044\u308b\u3002HMAC\u306f\u3001\u9375\uff08\u30bd\u30eb\u30c8\uff09\u3092kk\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092mm\u3001\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092HH\u3068\u3057\u305f\u6642\u306b\u6b21\u306e\u3088\u3046\u306a\u95a2\u6570\u3067\u3042\u308b\u3002\u306a\u304a\u3001\u2295\\oplus\u306f\u6392\u4ed6\u7684\u8ad6\u7406\u548c\u3092\u8868\u3057\u3001ipadipad\u3068opadopad\u306f\u5b9a\u6570\u3067\u3042\u308b\u3002\n\\begin{align}\nHMAC &= \\\\\n  &\\text{val}\\, ikey = k \\oplus ipad \\\\\n  &\\text{val}\\, okey = k \\oplus opad \\\\\n  &H(okey \\mid\\mid H(ikey \\mid\\mid m))\n\\end{align}\nHMAC=valikey=k\u2295ipadvalokey=k\u2295opadH(okey\u2223\u2223H(ikey\u2223\u2223m)){\\begin{align}\nHMAC &= \\\\\n  &\\text{val}\\, ikey = k \\oplus ipad \\\\\n  &\\text{val}\\, okey = k \\oplus opad \\\\\n  &H(okey \\mid\\mid H(ikey \\mid\\mid m))\n\\end{align}\n}\n\u3053\u306e\u3088\u3046\u306b\u30012\u56de\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u5165\u308c\u308b\u3053\u3068\u3067\u3001\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u4f38\u9577\u653b\u6483\u304c\u3042\u3063\u305f\u308a\u5f37\u885d\u7a81\u8010\u6027\u304c\u7834\u308c\u3066\u3044\u305f\u3068\u3057\u3066\u3082HMAC\u304c\u76f4\u3061\u306b\u5371\u967a\u306b\u306a\u308b\u3053\u3068\u306f\u306a\u3044\u3002\n\n\u307e\u3068\u3081\n\u30bd\u30eb\u30c8\u3092\u524d\u3084\u5f8c\u308d\u304b\u3089\u4ed8\u4e0e\u3057\u3066\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u306e\u306f\u3088\u304f\u306a\u3044\u306e\u3067\u3001\u7279\u306b\u7406\u7531\u304c\u306a\u3051\u308c\u3070HMAC\u3092\u4f7f\u3046\u65b9\u304c\u3088\u3044\u3068\u601d\u308f\u308c\u308b\u3002\n\n\u8b1d\u8f9e\n\u5f8c\u308d\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u3051\u305f\u969b\u306b\u5371\u967a\u306b\u306a\u308b\u5834\u5408\u306b\u3064\u3044\u3066\u306f\u3001@herumi\u3055\u3093\u304b\u3089\u60c5\u5831\u3092\u9802\u3044\u305f\u3002\n\n\n\u53c2\u8003\u6587\u732e\n\n\u539f\u50cf\u653b\u6483\n\u30af\u30e9\u30a6\u30c9\u3092\u652f\u3048\u308b\u3053\u308c\u304b\u3089\u306e\u6697\u53f7\u6280\u8853\nStop using unsafe keyed hashes, use HMAC\n\u6697\u53f7\u6280\u8853\u5165\u9580 \u7b2c3\u7248 \u79d8\u5bc6\u306e\u56fd\u306e\u30a2\u30ea\u30b9\n\n\n\n\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3068\u306f\u3001\u9069\u5f53\u306a\u6587\u5b57\u5217\u3068\u3044\u3046\u610f\u5473\u3067\u3042\u308b\u3002\u00a0\u21a9\n\n\n\n# \u306f\u3058\u3081\u306b\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u4fdd\u5b58\u3059\u308b\u969b\u306b\u3088\u304f\u7528\u3044\u3089\u308c\u308b\u30bd\u30eb\u30c8\u3068\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u4f7f\u3046\u3084\u308a\u65b9\u306b\u3064\u3044\u3066\u3001\u306a\u305c\u305d\u308c\u304c\u5fae\u5999\u3067\u3042\u308b\u304b\u3092\u89e3\u8aac\u3057\u305f\u5f8c\u306b\u3001\u305d\u308c\u3092\u89e3\u6c7a\u3059\u308b\u65b9\u6cd5\u3092\u7d39\u4ecb\u3059\u308b\u3002\n\u3082\u3057\u8a18\u4e8b\u306e\u4e2d\u306b\u4f55\u304b\u8aa4\u308a\u304c\u3042\u308c\u3070\u3001\u6c17\u8efd\u306b\u6307\u6458\u3057\u3066\u6b32\u3057\u3044\u3068\u601d\u3046\u3002\n\n# \u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3068\u30bd\u30eb\u30c8\u3092\u7528\u3044\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u4fdd\u5b58\n\n\u4f8b\u3048\u3070\u6b21\u306e\u3088\u3046\u306a\u5909\u6570\u3068\u95a2\u6570\u304c\u3042\u308b\u3068\u3059\u308b\u3002\n\n|   \u5909\u6570   | \u610f\u5473                 |\n|:--------:|----------------------|\n|    $m$   |      \u30d1\u30b9\u30ef\u30fc\u30c9\uff08\u30e1\u30c3\u30bb\u30fc\u30b8[^message]\uff09      |\n|    $k$   |        \u30bd\u30eb\u30c8        |\n| $H$      | \u30cf\u30c3\u30b7\u30e5\u95a2\u6570         |\n| $a \\mid\\mid b$ | \u6587\u5b57\u5217$a$\u3068$b$\u306e\u7d50\u5408 |\n\n[^message]: \u3053\u306e\u8a18\u4e8b\u3067\u306e**\u30e1\u30c3\u30bb\u30fc\u30b8**\u3068\u306f\u3001\u9069\u5f53\u306a\u6587\u5b57\u5217\u3068\u3044\u3046\u610f\u5473\u3067\u3042\u308b\u3002\n\n\u3059\u308b\u3068\u3001\u6b21\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3067\u30d1\u30b9\u30ef\u30fc\u30c9\u304b\u3089\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u6c42\u3081\u3066\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306a\u3069\u306b\u4fdd\u5b58\u3059\u308b\u30b1\u30fc\u30b9\u304c\u591a\u3044\u3068\u601d\u3046\u3002\n\n```math\nhp = H(k \\mid\\mid m)\n```\n\n\u3057\u304b\u3057\u3001\u4f7f\u3046\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u3088\u3063\u3066\u306f\u3001\u3053\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3067\u3042\u308b\u3068\u554f\u984c\u304c\u8d77\u304d\u308b\u3002\n\n# \u524d\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u4e0e\u3059\u308b\u65b9\u6cd5\u3068\u4f38\u9577\u653b\u6483\n\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u3088\u3063\u3066\u306f\u3001**\u4f38\u9577\u653b\u6483**\u3068\u547c\u3070\u308c\u308b\u6b21\u306e\u3088\u3046\u306a\u653b\u6483\u304c\u53ef\u80fd\u306a\u3082\u306e\u304c\u3042\u308b\u3002\n\n- $m$\u3068$k$\u306b\u3088\u308b\u30cf\u30c3\u30b7\u30e5\u5024$H(k \\mid\\mid m)$\u304c\u5206\u304b\u308b\u3068\u3001$m$\u306b\u9069\u5f53\u306a\u6587\u5b57\u5217\u3092\u8ffd\u52a0\u3057\u305f\u6587\u5b57\u5217$m'$\u306b\u3064\u3044\u3066\u3001$k$\u3092\u77e5\u308b\u3053\u3068\u306a\u304f$H(k \\mid\\mid m')$\u3092\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\n\u4f8b\u3048\u3070SHA1\u3084SHA2\u3001MD5\u306a\u3069\u306f\u3053\u306e\u3088\u3046\u306a\u7279\u5fb4\u3092\u6301\u3064\u3002\u5f93\u3063\u3066\u3001\u653b\u6483\u8005\u306f\u3042\u3089\u304b\u3058\u3081\u30011\u6587\u5b57\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3069\u77ed\u3044\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u5165\u624b\u3057\u305f\u5f8c\u3001\u9577\u3044\u6587\u5b57\u5217\u3092\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u3057\u305f\u5834\u5408\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u3088\u3063\u3066\u3001\u3053\u306e\u65b9\u6cd5\u306f\u3084\u3084\u5371\u967a\u3067\u3042\u308b\u3068\u8a00\u3048\u308b\u3002\n\n# \u5f8c\u308d\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u4e0e\u3059\u308b\u65b9\u6cd5\n\n\u3067\u306f\u3001$H(m \\mid\\mid k)$\u306e\u3088\u3046\u306b\u5f8c\u308d\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u4e0e\u3059\u308c\u3070\u3088\u3044\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\u78ba\u304b\u306b\u3053\u306e\u65b9\u6cd5\u3067\u4f38\u9577\u653b\u6483\u306f\u3067\u304d\u306a\u304f\u306a\u308b\u304c\u3001\u3053\u306e\u65b9\u6cd5\u3092\u7528\u3044\u308b\u3068\u3001\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u304c\u8106\u5f31\u306b\u306a\u3063\u305f\u5834\u5408\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u3002\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u306f\u6b21\u306e\u3088\u3046\u306a\u6027\u8cea\u304c\u3042\u308b\u3002\n\n<dl>\n  <dt>\u5f31\u885d\u7a81\u8010\u6027</dt>\n  <dd>\u3042\u308b\u30e1\u30c3\u30bb\u30fc\u30b8$m$\u3068\u7b49\u3057\u3044\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u6301\u3064\u3088\u3046\u306a$m'$\u3092\u6c42\u3081\u308b\u306e\u304c\u56f0\u96e3\u3067\u3042\u308b\u6027\u8cea<dd>\n  <dt>\u5f37\u885d\u7a81\u8010\u6027</dt>\n  <dd>\u4efb\u610f\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u306b\u3064\u3044\u3066\u3001$H(m) = H(m')$\u3068\u306a\u308b$m$\u3068$m'$\u306e\u7d44\u3092\u898b\u3064\u3051\u308b\u306e\u304c\u56f0\u96e3\u3067\u3042\u308b\u6027\u8cea</dd>\n</dl>\n\n\u3053\u306e\u3046\u3061\u3001\u5229\u7528\u3057\u3066\u3044\u308b\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306e\u5f37\u885d\u7a81\u8010\u6027\u304c\u7834\u3089\u308c\u305f\u5834\u5408\u306b\u3064\u3044\u3066\u8003\u3048\u308b\u3002\u4f8b\u3048\u3070\u30cf\u30c3\u30b7\u30e5\u95a2\u6570[MD5](https://ja.wikipedia.org/wiki/MD5)\u306f\u3059\u3067\u306b\u5f37\u885d\u7a81\u8010\u6027\u304c\u7834\u3089\u308c\u3066\u3044\u308b\u3002\n\u4eca\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u6b21\u306e\u3088\u3046\u306a\u65b9\u6cd5\u3067\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4fdd\u5b58\u3057\u3066\u3044\u308b\u3068\u3059\u308b\u3002\n\n```math\nhp = H(m \\mid\\mid k)\n```\n\n\u5f37\u885d\u7a81\u8010\u6027\u304c\u7834\u3089\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u653b\u6483\u8005\u306f\u307e\u305a\u65e2\u77e5\u306e\u30e1\u30c3\u30bb\u30fc\u30b8$m$\u306b\u3064\u3044\u3066\u30cf\u30c3\u30b7\u30e5\u5024\u304c\u7b49\u3057\u304f\u306a\u308b\uff08$H(m) = H(m')$\u3068\u306a\u308b\uff09$m'$\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002$m \\ne m'$\u3067\u3042\u3063\u305f\u3068\u3057\u3066\u3082\u3001$H(m) = H(m')$\u3067\u3042\u308b\u3068\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306e\u5185\u90e8\u72b6\u614b\u304c$k$\u307e\u3067\u3067\u540c\u3058\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u3001$H(m \\mid\\mid k) = H(m' \\mid\\mid k)$\u3068\u306a\u308a\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u7570\u306a\u308b\u306b\u3082\u95a2\u308f\u3089\u305a\u610f\u56f3\u3057\u306a\u3044\u8a8d\u8a3c\u3092\u3057\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\u3088\u3063\u3066\u3001\u3053\u306e\u3088\u3046\u306b\u5f8c\u65b9\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u4e0e\u3059\u308b\u65b9\u6cd5\u306f\u610f\u56f3\u3057\u306a\u3044\u8a8d\u8a3c\u3092\u3057\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u304c\u3042\u308b\u3068\u8a00\u3048\u308b\u3002\n\n# \u30e1\u30c3\u30bb\u30fc\u30b8\u8a8d\u8a3c\u30b3\u30fc\u30c9\u3068HMAC\n\n\u3053\u308c\u3089\u306e\u5bfe\u7b56\u3068\u3057\u3066\u3001\u6700\u7d42\u7684\u306b\u306f[HMAC](https://ja.wikipedia.org/wiki/HMAC)\u3068\u547c\u3070\u308c\u308b\u65b9\u6cd5\u3092\u7528\u3044\u308b\u306e\u304c\u3088\u3044\u3068\u3055\u308c\u3066\u3044\u308b\u3002HMAC\u306f\u3001\u9375\uff08\u30bd\u30eb\u30c8\uff09\u3092$k$\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092$m$\u3001\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092$H$\u3068\u3057\u305f\u6642\u306b\u6b21\u306e\u3088\u3046\u306a\u95a2\u6570\u3067\u3042\u308b\u3002\u306a\u304a\u3001$\\oplus$\u306f\u6392\u4ed6\u7684\u8ad6\u7406\u548c\u3092\u8868\u3057\u3001$ipad$\u3068$opad$\u306f\u5b9a\u6570\u3067\u3042\u308b\u3002\n\n```math\n\\begin{align}\nHMAC &= \\\\\n  &\\text{val}\\, ikey = k \\oplus ipad \\\\\n  &\\text{val}\\, okey = k \\oplus opad \\\\\n  &H(okey \\mid\\mid H(ikey \\mid\\mid m))\n\\end{align}\n```\n\n\u3053\u306e\u3088\u3046\u306b\u30012\u56de\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u5165\u308c\u308b\u3053\u3068\u3067\u3001\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u4f38\u9577\u653b\u6483\u304c\u3042\u3063\u305f\u308a\u5f37\u885d\u7a81\u8010\u6027\u304c\u7834\u308c\u3066\u3044\u305f\u3068\u3057\u3066\u3082HMAC\u304c\u76f4\u3061\u306b\u5371\u967a\u306b\u306a\u308b\u3053\u3068\u306f\u306a\u3044\u3002\n\n# \u307e\u3068\u3081\n\n\u30bd\u30eb\u30c8\u3092\u524d\u3084\u5f8c\u308d\u304b\u3089\u4ed8\u4e0e\u3057\u3066\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3059\u308b\u306e\u306f\u3088\u304f\u306a\u3044\u306e\u3067\u3001\u7279\u306b\u7406\u7531\u304c\u306a\u3051\u308c\u3070HMAC\u3092\u4f7f\u3046\u65b9\u304c\u3088\u3044\u3068\u601d\u308f\u308c\u308b\u3002\n\n# \u8b1d\u8f9e\n\n\u5f8c\u308d\u304b\u3089\u30bd\u30eb\u30c8\u3092\u4ed8\u3051\u305f\u969b\u306b\u5371\u967a\u306b\u306a\u308b\u5834\u5408\u306b\u3064\u3044\u3066\u306f\u3001[@herumi](https://twitter.com/herumi)\u3055\u3093\u304b\u3089\u60c5\u5831\u3092\u9802\u3044\u305f\u3002\n\n<blockquote class=\"twitter-tweet\" data-conversation=\"none\" data-lang=\"ja\"><p lang=\"ja\" dir=\"ltr\">\u4f8b\u3048\u3070\u885d\u7a81\u56f0\u96e3\u6027\u304c\u7834\u3089\u308c\u305fMD5\u3067H(m||k)\u3092\u4f7f\u3046\u3068\u610f\u56f3\u3057\u306a\u3044\u8a8d\u8a3c\u3092\u3057\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\uff08<a href=\"https://t.co/wuQ8adA83I\">https://t.co/wuQ8adA83I</a>\uff09\u304c\u3042\u308a\u307e\u3059\u304cHMAC-MD5\u306a\u3089\u4eca\u306e\u3068\u3053\u308d\u307e\u3060\u5927\u4e08\u592b\uff08\u306a\u306f\u305a<a href=\"https://t.co/NYePTKpaJu\">https://t.co/NYePTKpaJu</a>\uff09\u3068\u3044\u3046\u9055\u3044\u304c\u3042\u308a\u307e\u3059\u3002<a href=\"https://twitter.com/_yyu_\">@_yyu_</a></p>&mdash; herumi (@herumi) <a href=\"https://twitter.com/herumi/status/705256862304702464\">2016\u5e743\u67083\u65e5</a></blockquote>\n<script async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n# \u53c2\u8003\u6587\u732e\n\n- [\u539f\u50cf\u653b\u6483](https://ja.wikipedia.org/wiki/%E5%8E%9F%E5%83%8F%E6%94%BB%E6%92%83)\n- [\u30af\u30e9\u30a6\u30c9\u3092\u652f\u3048\u308b\u3053\u308c\u304b\u3089\u306e\u6697\u53f7\u6280\u8853](http://www.amazon.co.jp/dp/479804413X)\n- [Stop using unsafe keyed hashes, use HMAC](http://rdist.root.org/2009/10/29/stop-using-unsafe-keyed-hashes-use-hmac/)\n- [\u6697\u53f7\u6280\u8853\u5165\u9580 \u7b2c3\u7248 \u79d8\u5bc6\u306e\u56fd\u306e\u30a2\u30ea\u30b9](http://www.amazon.co.jp/dp/4797382228)\n", "tags": ["\u8a8d\u8a3c", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"]}