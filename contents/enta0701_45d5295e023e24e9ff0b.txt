{"context": "\n\n\u306f\u3058\u3081\u306b\n2016\u5e744\u67087\u65e5\u306bLINE\u3088\u308a\u300cBOT API Trial Account\u300d\u306e\u7121\u511f\u63d0\u4f9b\uff08\u5148\u77401\u4e07\u540d\u9650\u5b9a\uff09\u304c\u59cb\u307e\u308a\u307e\u3057\u305f\u3002\n\u65e2\u306b\u69d8\u3005\u306a\u8a18\u4e8b\u304c\u51fa\u3066\u3044\u307e\u3059\u304cExpress\u3092\u4f7f\u3063\u305f\u3082\u306e\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\n\u8a66\u3057\u306b\u30b5\u30fc\u30d3\u30b9\u958b\u59cb\u6642\u306eNEWS\u306b\u3042\u3063\u305f\u3001\u30ec\u30b9\u30c8\u30e9\u30f3BOT\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u203b\u3053\u308c\u3092\u66f8\u3044\u3066\u3044\u308b\u6642\u306b\u9177\u4f3c\u3057\u305f\u8a18\u4e8b\u3092\u898b\u3064\u3051\u307e\u3057\u305f\u304c\u5168\u7136\u6c17\u306b\u3057\u3066\u307e\u305b\u3093\u3002\u307e\u3063\u305f\u304f\u3002\n\u4eca\u56de\u306fHeroku\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307e\u3059\u304c\u3001\u30b0\u30b0\u308c\u3070\u5148\u4eba\u305f\u3061\u306e\u8a18\u9332\u304c\u305f\u304f\u3055\u3093\u898b\u3064\u304b\u308b\u306e\u3067\u3001\u305d\u306e\u8fba\u308a\u306e\u8a71\u306f\u3057\u307e\u305b\u3093\u3002\n\u53c2\u8003\uff1aNode.js+Express+EJS+Heroku\u3067Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a \u305d\u306e1\n\n\u74b0\u5883\n\nOS X El Capitan 10.11.3\nnode\u3000v5.4.1\nnpm\u30003.5.3\n\n\n\u6e96\u5099\n\nHeroku\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\n\nBOT API Trial Account\u306b\u767b\u9332\u3057\u3066\u6b21\u306e\uff13\u3064\u3092\u53d6\u5f97\n\n\nChannel ID\nChannel Secret\nMID\n\n\nHeroku\u306e\u30a2\u30c9\u30aa\u30f3\uff08Fixie\uff09\u7528\u306b\u30af\u30ec\u30b8\u30c3\u30c8\u30ab\u30fc\u30c9\u3000\u203b\u7121\u6599\n\n\u3050\u308b\u306a\u3073 Web\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u53d6\u5f97\n\n\n\u3055\u3063\u305d\u304f\u3067\u3059\u304c\n\u3068\u308a\u3042\u3048\u305a\u52d5\u3044\u305f\u3082\u306e\u3092\u3002\n\nindex.js\nvar express = require('express');\nvar app = express();\nvar bodyParser = require('body-parser');\nvar request = require('request');\nvar async = require('async');\n\napp.set('port', (process.env.PORT || 5000));\napp.use(bodyParser.urlencoded({extended: true}));  // JSON\u306e\u9001\u4fe1\u3092\u8a31\u53ef\napp.use(bodyParser.json());                        // JSON\u306e\u30d1\u30fc\u30b9\u3092\u697d\u306b\uff08\u53d7\u4fe1\u6642\uff09\n// app.get('/', function(request, response) {\n//     response.send('Hello World!');\n// });\n\napp.post('/callback', function(req, res){\n\n    async.waterfall([\n        // \u3050\u308b\u306a\u3073API\n        function(callback) {\n\n            var json = req.body;\n\n            // \u53d7\u4fe1\u30c6\u30ad\u30b9\u30c8\n            var search_place = json['result'][0]['content']['text'];\n            var search_place_array = search_place.split(\"\\n\");\n\n            //\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\n            var gnavi_keyword = \"\";\n            if(search_place_array.length == 2){\n                var keyword_array = search_place_array[1].split(\"\u3001\");\n                gnavi_keyword = keyword_array.join();\n            }\n\n            // \u3050\u308b\u306a\u3073API \u30ec\u30b9\u30c8\u30e9\u30f3\u691c\u7d22API\n            var gnavi_url = 'http://api.gnavi.co.jp/RestSearchAPI/20150630/';\n            // \u3050\u308b\u306a\u3073 \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8a2d\u5b9a\n            var gnavi_query = {\n                \"keyid\":\"<\u3050\u308b\u306a\u3073\u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc>\",\n                \"format\": \"json\",\n                \"address\": search_place_array[0],\n                \"hit_per_page\": 1,\n                \"freeword\": gnavi_keyword,\n                \"freeword_condition\": 2\n            };\n            var gnavi_options = {\n                url: gnavi_url,\n                headers : {'Content-Type' : 'application/json; charset=UTF-8'},\n                qs: gnavi_query,\n                json: true\n            };\n\n            // \u691c\u7d22\u7d50\u679c\u3092\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5316\n            var search_result = {};\n\n            request.get(gnavi_options, function (error, response, body) {\n                if (!error && response.statusCode == 200) {\n                    if('error' in body){\n                        console.log(\"\u691c\u7d22\u30a8\u30e9\u30fc\" + JSON.stringify(body));\n                        return;\n                    }\n\n                    // \u5e97\u540d\n                    if('name' in body.rest){\n                        search_result['name'] = body.rest.name;\n                    }\n                    // \u753b\u50cf\n                    if('image_url' in body.rest){\n                        search_result['shop_image1'] = body.rest.image_url.shop_image1;\n                    }\n                    // \u4f4f\u6240\n                    if('address' in body.rest){\n                        search_result['address'] = body.rest.address;\n                    }\n                    // \u7def\u5ea6\n                    if('latitude' in body.rest){\n                        search_result['latitude'] = body.rest.latitude;\n                    }\n                    // \u8efd\u5ea6\n                    if('longitude' in body.rest){\n                        search_result['longitude'] = body.rest.longitude;\n                    }\n                    // \u55b6\u696d\u6642\u9593\n                    if('opentime' in body.rest){\n                        search_result['opentime'] = body.rest.opentime;\n                    }\n\n                    callback(null, json, search_result);\n\n                } else {\n                    console.log('error: '+ response.statusCode);\n                }\n            });\n\n        },\n    ],\n\n    // LINE BOT\n    function(err, json, search_result) {\n        if(err){\n            return;\n        }\n\n        //\u30d8\u30c3\u30c0\u30fc\u3092\u5b9a\u7fa9\n        var headers = {\n            'Content-Type' : 'application/json; charset=UTF-8',\n            'X-Line-ChannelID' : '<Your Channel ID>',\n            'X-Line-ChannelSecret' : '<Your Channel Secret>',\n            'X-Line-Trusted-User-With-ACL' : '<Your MID>'\n        };\n\n        // \u9001\u4fe1\u76f8\u624b\u306e\u8a2d\u5b9a\uff08\u914d\u5217\uff09\n        var to_array = [];\n        to_array.push(json['result'][0]['content']['from']);\n\n\n        // \u9001\u4fe1\u30c7\u30fc\u30bf\u4f5c\u6210\n        var data = {\n            'to': to_array,\n            'toChannel': 1383378250, //\u56fa\u5b9a\n            'eventType':'140177271400161403', //\u56fa\u5b9a\n            \"content\": {\n                \"messageNotified\": 0,\n                \"messages\": [\n                    // \u30c6\u30ad\u30b9\u30c8\n                    {\n                        \"contentType\": 1,\n                        \"text\": '\u3053\u3061\u3089\u306f\u3044\u304b\u304c\u3067\u3059\u304b\uff1f\\n\u3010\u304a\u5e97\u3011' + search_result['name'] + '\\n\u3010\u55b6\u696d\u6642\u9593\u3011' + search_result['opentime'],\n                    },\n                    // \u753b\u50cf\n                    {\n                        \"contentType\": 2,\n                        \"originalContentUrl\": search_result['shop_image1'],\n                        \"previewImageUrl\": search_result['shop_image1']\n                    },\n                    // \u4f4d\u7f6e\u60c5\u5831\n                    {\n                        \"contentType\":7,\n                        \"text\": search_result['name'],\n                        \"location\":{\n                            \"title\": search_result['address'],\n                            \"latitude\": Number(search_result['latitude']),\n                            \"longitude\": Number(search_result['longitude'])\n                        }\n                    }\n                ]\n            }\n        };\n\n        //\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5b9a\u7fa9\n        var options = {\n            url: 'https://trialbot-api.line.me/v1/events',\n            proxy : process.env.FIXIE_URL,\n            headers: headers,\n            json: true,\n            body: data\n        };\n\n        request.post(options, function (error, response, body) {\n            if (!error && response.statusCode == 200) {\n                console.log(body);\n            } else {\n                console.log('error: '+ JSON.stringify(response));\n            }\n        });\n\n    });\n\n});\n\napp.listen(app.get('port'), function() {\n    console.log('Node app is running');\n});\n\n\n\n\n\u306a\u306b\u3092\u3084\u3063\u3066\u3044\u308b\u304b\n/callback\u306b\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u30e6\u30fc\u30b6\u304c\u9001\u4fe1\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\uff09\u304c\u6765\u305f\u3089\u3001\n\n\u4e00\u884c\u76ee\uff1a\u4f4f\u6240 \u4f8b\uff09\u5ca9\u624b\u770c\u76db\u5ca1\u5e02\n\u4e8c\u884c\u76ee\uff1a\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3000\u4f8b\uff09\u713c\u304d\u8089\u3001\u51b7\u9eba\u2026\n\n\u3092\u53d6\u308a\u51fa\u3057\u3066\u3001\u3050\u308b\u306a\u3073\u306eAPI\u306b\u6295\u3052\u308b\u3002\n\u691c\u7d22\u7d50\u679c\u304b\u3089\u3001\n\n\u304a\u5e97\u306e\u540d\u524d\n\u753b\u50cf\n\u4f4f\u6240\n\u7def\u5ea6\u30fb\u8efd\u5ea6\n\u55b6\u696d\u6642\u9593\n\n\u3092\u53d6\u308a\u51fa\u3057\u3001\u3053\u3053\u304b\u3089\u3088\u3046\u3084\u304fLINE BOT\u304b\u3089\u9001\u4fe1\u3057\u305f\u3044\u60c5\u5831\u3092\u30bb\u30c3\u30c8\u3057\u3066POST\u3059\u308b\u3002\n\u9001\u4fe1\u3057\u305f\u3044\u3082\u306e\u304c\uff11\u3064\u3067\u3042\u308c\u3070 Sending messages\u3001\u8907\u6570\u306a\u3089Sending multiple messages\u3092\u4f7f\u3046\u3002\n\n\u3064\u307e\u3065\u3044\u305f\u3068\u3053\u308d\nLINE BOT \u3092\u3068\u308a\u3042\u3048\u305a\u30bf\u30c0\u3067 Heroku \u3067\u52d5\u304b\u3059\u3092\u898b\u308b\u3068\u3001\n\nLINE BOT API \u306e\u547c\u3073\u51fa\u3057\u306b\u306f Server IP Whitelist \u306b\u63a5\u7d9a\u5143 IP \u306e\u6307\u5b9a\u304c\u5fc5\u8981\u3068\u306e\u3053\u3068\u3067\u3001Heroku \u3060\u3068\u96e3\u3057\u3044\u304b\u306a\u30fc\u3001\u3068\u601d\u3044\u307e\u3057\u305f\u304c\u30a2\u30c9\u30aa\u30f3\u3067\u89e3\u6c7a\u3067\u304d\u307e\u3057\u305f\u3002\nFixie\n\n\u306a\u3093\u3068\uff01\uff01\uff01\u3042\u308a\u304c\u305f\u3044\u3002\nFixie\u3092\u4f7f\u3046\u3068\u304d\u306bfree\u3067\u3082\u30af\u30ec\u30b8\u30c3\u30c8\u30ab\u30fc\u30c9\u306e\u767b\u9332\u304c\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u3001\u6e0b\u3005\u5fc5\u8981\u60c5\u5831\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u6b21\u306e\u4f5c\u696d\u3092\u5fd8\u308c\u3066\u3044\u305f\u305f\u3081\u3001\u304b\u306a\u308a\u6642\u9593\u3092\u53d6\u3089\u308c\u307e\u3057\u305f\u3002\nHeroku\u306e\u7ba1\u7406\u753b\u9762\u304b\u3089\u3001Resources > Fixie > account\u3000\u3068\u9032\u307f\u3001\nProxy URL\u3092\u3001LINE BOT\u306bPOST\u3059\u308b\u969b\u306b\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\u3059\u308b\u3068\u3001\u3088\u3046\u3084\u304f\u305d\u308c\u3063\u307d\u3044\u3082\u306e\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n\n\u307e\u3068\u3081\n\u30c4\u30c3\u30b3\u30df\u3042\u308c\u3070\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\uff01\n\uff08BOT API Trial Account\u3001\u307e\u306010,000\u540d\u9054\u3057\u3066\u306a\u3044\u306e\u304b\u306a\u3002\u3002\u3002\uff09\n\n##\u306f\u3058\u3081\u306b\n2016\u5e744\u67087\u65e5\u306bLINE\u3088\u308a\u300cBOT API Trial Account\u300d\u306e\u7121\u511f\u63d0\u4f9b\uff08\u5148\u77401\u4e07\u540d\u9650\u5b9a\uff09\u304c\u59cb\u307e\u308a\u307e\u3057\u305f\u3002\n\u65e2\u306b\u69d8\u3005\u306a\u8a18\u4e8b\u304c\u51fa\u3066\u3044\u307e\u3059\u304cExpress\u3092\u4f7f\u3063\u305f\u3082\u306e\u304c\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\n\u8a66\u3057\u306b[\u30b5\u30fc\u30d3\u30b9\u958b\u59cb\u6642\u306eNEWS](http://linecorp.com/ja/pr/news/ja/2016/1320)\u306b\u3042\u3063\u305f\u3001\u30ec\u30b9\u30c8\u30e9\u30f3BOT\u3092\u4f5c\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u203b\u3053\u308c\u3092\u66f8\u3044\u3066\u3044\u308b\u6642\u306b\u9177\u4f3c\u3057\u305f\u8a18\u4e8b\u3092\u898b\u3064\u3051\u307e\u3057\u305f\u304c\u5168\u7136\u6c17\u306b\u3057\u3066\u307e\u305b\u3093\u3002\u307e\u3063\u305f\u304f\u3002\n\n\n\u4eca\u56de\u306fHeroku\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307e\u3059\u304c\u3001\u30b0\u30b0\u308c\u3070\u5148\u4eba\u305f\u3061\u306e\u8a18\u9332\u304c\u305f\u304f\u3055\u3093\u898b\u3064\u304b\u308b\u306e\u3067\u3001\u305d\u306e\u8fba\u308a\u306e\u8a71\u306f\u3057\u307e\u305b\u3093\u3002\n\u53c2\u8003\uff1a[Node.js+Express+EJS+Heroku\u3067Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a \u305d\u306e1](http://kokushin.hatenablog.com/entry/2016/04/04/Node.js%E3%81%A8Heroku%E3%81%A7Web%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E9%96%8B%E7%99%BA%E3%83%BB%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89%E7%B7%A8)\n\n\n##\u74b0\u5883\n- OS X El Capitan 10.11.3\n- node\u3000v5.4.1\n- npm\u30003.5.3\n\n##\u6e96\u5099\n- Heroku\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\n- [BOT API Trial Account](https://business.line.me/services/products/4/introduction)\u306b\u767b\u9332\u3057\u3066\u6b21\u306e\uff13\u3064\u3092\u53d6\u5f97\n\t- Channel ID\n\t- Channel Secret\n\t- MID\n- Heroku\u306e\u30a2\u30c9\u30aa\u30f3\uff08Fixie\uff09\u7528\u306b\u30af\u30ec\u30b8\u30c3\u30c8\u30ab\u30fc\u30c9\u3000\u203b\u7121\u6599\n- [\u3050\u308b\u306a\u3073 Web\u30b5\u30fc\u30d3\u30b9](http://api.gnavi.co.jp/api/)\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30ad\u30fc\u3092\u53d6\u5f97\n\n\n##\u3055\u3063\u305d\u304f\u3067\u3059\u304c\n\u3068\u308a\u3042\u3048\u305a\u52d5\u3044\u305f\u3082\u306e\u3092\u3002\n\n\n```javascript:index.js\nvar express = require('express');\nvar app = express();\nvar bodyParser = require('body-parser');\nvar request = require('request');\nvar async = require('async');\n\napp.set('port', (process.env.PORT || 5000));\napp.use(bodyParser.urlencoded({extended: true}));  // JSON\u306e\u9001\u4fe1\u3092\u8a31\u53ef\napp.use(bodyParser.json());                        // JSON\u306e\u30d1\u30fc\u30b9\u3092\u697d\u306b\uff08\u53d7\u4fe1\u6642\uff09\n// app.get('/', function(request, response) {\n//     response.send('Hello World!');\n// });\n\napp.post('/callback', function(req, res){\n\n    async.waterfall([\n        // \u3050\u308b\u306a\u3073API\n        function(callback) {\n\n            var json = req.body;\n\n            // \u53d7\u4fe1\u30c6\u30ad\u30b9\u30c8\n            var search_place = json['result'][0]['content']['text'];\n            var search_place_array = search_place.split(\"\\n\");\n\n            //\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\n            var gnavi_keyword = \"\";\n            if(search_place_array.length == 2){\n                var keyword_array = search_place_array[1].split(\"\u3001\");\n                gnavi_keyword = keyword_array.join();\n            }\n\n            // \u3050\u308b\u306a\u3073API \u30ec\u30b9\u30c8\u30e9\u30f3\u691c\u7d22API\n            var gnavi_url = 'http://api.gnavi.co.jp/RestSearchAPI/20150630/';\n            // \u3050\u308b\u306a\u3073 \u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8a2d\u5b9a\n            var gnavi_query = {\n                \"keyid\":\"<\u3050\u308b\u306a\u3073\u306e\u30a2\u30af\u30bb\u30b9\u30ad\u30fc>\",\n                \"format\": \"json\",\n                \"address\": search_place_array[0],\n                \"hit_per_page\": 1,\n                \"freeword\": gnavi_keyword,\n                \"freeword_condition\": 2\n            };\n            var gnavi_options = {\n                url: gnavi_url,\n                headers : {'Content-Type' : 'application/json; charset=UTF-8'},\n                qs: gnavi_query,\n                json: true\n            };\n\n            // \u691c\u7d22\u7d50\u679c\u3092\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5316\n            var search_result = {};\n\n            request.get(gnavi_options, function (error, response, body) {\n                if (!error && response.statusCode == 200) {\n                    if('error' in body){\n                        console.log(\"\u691c\u7d22\u30a8\u30e9\u30fc\" + JSON.stringify(body));\n                        return;\n                    }\n\n                    // \u5e97\u540d\n                    if('name' in body.rest){\n                        search_result['name'] = body.rest.name;\n                    }\n                    // \u753b\u50cf\n                    if('image_url' in body.rest){\n                        search_result['shop_image1'] = body.rest.image_url.shop_image1;\n                    }\n                    // \u4f4f\u6240\n                    if('address' in body.rest){\n                        search_result['address'] = body.rest.address;\n                    }\n                    // \u7def\u5ea6\n                    if('latitude' in body.rest){\n                        search_result['latitude'] = body.rest.latitude;\n                    }\n                    // \u8efd\u5ea6\n                    if('longitude' in body.rest){\n                        search_result['longitude'] = body.rest.longitude;\n                    }\n                    // \u55b6\u696d\u6642\u9593\n                    if('opentime' in body.rest){\n                        search_result['opentime'] = body.rest.opentime;\n                    }\n\n                    callback(null, json, search_result);\n\n                } else {\n                    console.log('error: '+ response.statusCode);\n                }\n            });\n\n        },\n    ],\n\n    // LINE BOT\n    function(err, json, search_result) {\n        if(err){\n            return;\n        }\n\n        //\u30d8\u30c3\u30c0\u30fc\u3092\u5b9a\u7fa9\n        var headers = {\n            'Content-Type' : 'application/json; charset=UTF-8',\n            'X-Line-ChannelID' : '<Your Channel ID>',\n            'X-Line-ChannelSecret' : '<Your Channel Secret>',\n            'X-Line-Trusted-User-With-ACL' : '<Your MID>'\n        };\n\n        // \u9001\u4fe1\u76f8\u624b\u306e\u8a2d\u5b9a\uff08\u914d\u5217\uff09\n        var to_array = [];\n        to_array.push(json['result'][0]['content']['from']);\n\n\n        // \u9001\u4fe1\u30c7\u30fc\u30bf\u4f5c\u6210\n        var data = {\n            'to': to_array,\n            'toChannel': 1383378250, //\u56fa\u5b9a\n            'eventType':'140177271400161403', //\u56fa\u5b9a\n            \"content\": {\n                \"messageNotified\": 0,\n                \"messages\": [\n                    // \u30c6\u30ad\u30b9\u30c8\n                    {\n                        \"contentType\": 1,\n                        \"text\": '\u3053\u3061\u3089\u306f\u3044\u304b\u304c\u3067\u3059\u304b\uff1f\\n\u3010\u304a\u5e97\u3011' + search_result['name'] + '\\n\u3010\u55b6\u696d\u6642\u9593\u3011' + search_result['opentime'],\n                    },\n                    // \u753b\u50cf\n                    {\n                        \"contentType\": 2,\n                        \"originalContentUrl\": search_result['shop_image1'],\n                        \"previewImageUrl\": search_result['shop_image1']\n                    },\n                    // \u4f4d\u7f6e\u60c5\u5831\n                    {\n                        \"contentType\":7,\n                        \"text\": search_result['name'],\n                        \"location\":{\n                            \"title\": search_result['address'],\n                            \"latitude\": Number(search_result['latitude']),\n                            \"longitude\": Number(search_result['longitude'])\n                        }\n                    }\n                ]\n            }\n        };\n\n        //\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5b9a\u7fa9\n        var options = {\n            url: 'https://trialbot-api.line.me/v1/events',\n            proxy : process.env.FIXIE_URL,\n            headers: headers,\n            json: true,\n            body: data\n        };\n\n        request.post(options, function (error, response, body) {\n            if (!error && response.statusCode == 200) {\n                console.log(body);\n            } else {\n                console.log('error: '+ JSON.stringify(response));\n            }\n        });\n\n    });\n\n});\n\napp.listen(app.get('port'), function() {\n    console.log('Node app is running');\n});\n\n```\n\n\n####\u306a\u306b\u3092\u3084\u3063\u3066\u3044\u308b\u304b\n`/callback`\u306b\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u30e6\u30fc\u30b6\u304c\u9001\u4fe1\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\uff09\u304c\u6765\u305f\u3089\u3001\n\n- \u4e00\u884c\u76ee\uff1a\u4f4f\u6240 \u4f8b\uff09\u5ca9\u624b\u770c\u76db\u5ca1\u5e02\n- \u4e8c\u884c\u76ee\uff1a\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3000\u4f8b\uff09\u713c\u304d\u8089\u3001\u51b7\u9eba\u2026\n\n\u3092\u53d6\u308a\u51fa\u3057\u3066\u3001\u3050\u308b\u306a\u3073\u306eAPI\u306b\u6295\u3052\u308b\u3002\n\u691c\u7d22\u7d50\u679c\u304b\u3089\u3001\n\n- \u304a\u5e97\u306e\u540d\u524d\n- \u753b\u50cf\n- \u4f4f\u6240\n- \u7def\u5ea6\u30fb\u8efd\u5ea6\n- \u55b6\u696d\u6642\u9593\n\n\u3092\u53d6\u308a\u51fa\u3057\u3001\u3053\u3053\u304b\u3089\u3088\u3046\u3084\u304fLINE BOT\u304b\u3089\u9001\u4fe1\u3057\u305f\u3044\u60c5\u5831\u3092\u30bb\u30c3\u30c8\u3057\u3066POST\u3059\u308b\u3002\n\u9001\u4fe1\u3057\u305f\u3044\u3082\u306e\u304c\uff11\u3064\u3067\u3042\u308c\u3070 [Sending messages](https://developers.line.me/bot-api/api-reference#sending_message)\u3001\u8907\u6570\u306a\u3089[Sending multiple messages](https://developers.line.me/bot-api/api-reference#sending_multiple_messages)\u3092\u4f7f\u3046\u3002\n\n####\u3064\u307e\u3065\u3044\u305f\u3068\u3053\u308d\n[LINE BOT \u3092\u3068\u308a\u3042\u3048\u305a\u30bf\u30c0\u3067 Heroku \u3067\u52d5\u304b\u3059](http://qiita.com/yuya_takeyama/items/0660a59d13e2cd0b2516#comment-e6737f3166be32597681)\u3092\u898b\u308b\u3068\u3001\n>LINE BOT API \u306e\u547c\u3073\u51fa\u3057\u306b\u306f Server IP Whitelist \u306b\u63a5\u7d9a\u5143 IP \u306e\u6307\u5b9a\u304c\u5fc5\u8981\u3068\u306e\u3053\u3068\u3067\u3001Heroku \u3060\u3068\u96e3\u3057\u3044\u304b\u306a\u30fc\u3001\u3068\u601d\u3044\u307e\u3057\u305f\u304c\u30a2\u30c9\u30aa\u30f3\u3067\u89e3\u6c7a\u3067\u304d\u307e\u3057\u305f\u3002\n>\n>[Fixie](https://elements.heroku.com/addons/fixie)\n\n\u306a\u3093\u3068\uff01\uff01\uff01\u3042\u308a\u304c\u305f\u3044\u3002\nFixie\u3092\u4f7f\u3046\u3068\u304d\u306bfree\u3067\u3082\u30af\u30ec\u30b8\u30c3\u30c8\u30ab\u30fc\u30c9\u306e\u767b\u9332\u304c\u6c42\u3081\u3089\u308c\u308b\u306e\u3067\u3001\u6e0b\u3005\u5fc5\u8981\u60c5\u5831\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001`\u6b21\u306e\u4f5c\u696d\u3092\u5fd8\u308c\u3066\u3044\u305f\u305f\u3081\u3001\u304b\u306a\u308a\u6642\u9593\u3092\u53d6\u3089\u308c\u307e\u3057\u305f\u3002`\n\nHeroku\u306e\u7ba1\u7406\u753b\u9762\u304b\u3089\u3001Resources > Fixie > account\u3000\u3068\u9032\u307f\u3001\n`Proxy URL`\u3092\u3001LINE BOT\u306bPOST\u3059\u308b\u969b\u306b\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3059\u308b\u3068\u3001\u3088\u3046\u3084\u304f\u305d\u308c\u3063\u307d\u3044\u3082\u306e\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n![IMG_9307.PNG](https://qiita-image-store.s3.amazonaws.com/0/92359/38f48e24-bb06-9d47-0669-775b6f27b2e9.png \"IMG_9307.PNG\")\n\n\n\n##\u307e\u3068\u3081\n\u30c4\u30c3\u30b3\u30df\u3042\u308c\u3070\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\uff01\n\uff08BOT API Trial Account\u3001\u307e\u306010,000\u540d\u9054\u3057\u3066\u306a\u3044\u306e\u304b\u306a\u3002\u3002\u3002\uff09\n\n\n\n", "tags": ["Express", "linebot", "Line", "nodejs", "Heroku"]}