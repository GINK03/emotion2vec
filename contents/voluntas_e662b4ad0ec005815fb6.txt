{"context": " More than 1 year has passed since last update.\n\n\u74b0\u5883\n\nMac OS X 10.9.4\nErlang/OTP 17.1\n\n\n\u6982\u8981\nErlang VM \u3092\u8907\u6570\u7acb\u3066\u3066\u3001Mnesia \u306e\u540c\u671f\u30c6\u30b9\u30c8\u3092 CommonTest \u3067\u306f\u306a\u304f EUnit \u3067\u306f\u3069\u3046\u3084\u308b\u306e\u304b\u8abf\u3079\u3066\u3044\u305f\u3068\u3053\u308d slave \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3048\u3070\u3088\u3044\u3068\u3044\u3046\u4e8b\u3060\u3063\u305f\u306e\u3067\u3001slave \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u307f\u308b\u3053\u3068\u306b\u3057\u305f\u3002\nCommonTest \u306b\u306f ct_slave \u3068\u3044\u3046\u5c02\u7528\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u3042\u308b\u6a21\u69d8\u3002\n\n\u30d5\u30ed\u30fc\n\n\u30ce\u30fc\u30c9\u540d\u3092\u81ea\u5206\u306b\u4ed8\u3051\u307e\u3059\n\n\nnet_kernel:start/1\n\n\n\u30af\u30c3\u30ad\u30fc\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\n\n\nerlang:set_cookie/2\n\n\n\u30ce\u30fc\u30c9\u3092 3 \u3064\u8d77\u52d5\u3057\u307e\u3059\n\n\nslave:start/3\n-setcookie \u3067\u30af\u30c3\u30ad\u30fc\u3092\u6307\u5b9a\u3059\u308b\n\n\n3 \u30ce\u30fc\u30c9\u5168\u3066\u3067 mnesia \u3092\u8d77\u52d5\u3057\u307e\u3059\n\n\nmnesia:start/0\n\n\n1 \u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u30c6\u30fc\u30d6\u30eb\u3092\u751f\u6210\u3057\u307e\u3059\n\n\nmnesia:create_table/2\n\n\n\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u305f\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u4ed6\u306e\u30ce\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\n\n\nmnesia:change_config/2\n\n\n\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u305f\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u30ec\u30d7\u30ea\u30ab\u5bfe\u8c61\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\n\n\nmnesia:add_table_copy/3\n\n\n\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u305f\u30ce\u30fc\u30c9\u306b bacon \u3068\u3044\u3046\u30ad\u30fc\u3067\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 +1 \u3057\u307e\u3059\n\n\nmnesia:dirty_update_counter/3\n\n\n\u4ed6\u306e\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u30ab\u30a6\u30f3\u30bf\u30fc\u306e\u5024\u3092\u53d6\u5f97\u3057\u307e\u3059\n\n\nmnesia:dirty_read/2\n\n\n\u5168\u3066\u306e\u30ce\u30fc\u30c9\u3067\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u5897\u52a0\u3055\u305b\u308b\n\u8d77\u52d5\u3057\u305f 3 \u30ce\u30fc\u30c9\u3092\u7d42\u4e86\u3057\u307e\u3059\n\n\nslave:stop/1\n\n\n\u81ea\u5206\u306e\u30ce\u30fc\u30c9\u540d\u3092\u524a\u9664\u3057\u307e\u3059\n\n\nnet_kernel:stop/0\n\n\n\n\n\u30b5\u30f3\u30d7\u30eb\n\n\u8aac\u660e\n\n\u30ce\u30fc\u30c9\u306f 3 \u53f0\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\u30aa\u30f3\u30e1\u30e2\u30ea\n\u540c\u671f\u306f Mnesia \u72ec\u81ea\u3092\u4f7f\u7528\n\n\n\u30b3\u30fc\u30c9\n-module(spam).\n\n-export([main/0]).\n\n-include_lib(\"eunit/include/eunit.hrl\").\n\n-record(store, {key :: binary(),\n                value :: non_neg_integer()}).\n\nmain() ->\n    {ok, _Pid} = net_kernel:start([spam, shortnames]),\n    true = erlang:set_cookie(node(), spam),\n\n    Host = list_to_atom(net_adm:localhost()),\n    Args = \"-setcookie spam\",\n\n    {ok, N1} = slave:start(Host, n1, Args),\n    {ok, N2} = slave:start(Host, n2, Args),\n    {ok, N3} = slave:start(Host, n3, Args),\n\n    rpc:call(N1, net_kernel, connect_node, [N2]),\n    rpc:call(N1, net_kernel, connect_node, [N3]),\n\n    rpc:call(N1, mnesia, start, []),\n    rpc:call(N2, mnesia, start, []),\n    rpc:call(N3, mnesia, start, []),\n\n    rpc:call(N1, mnesia, create_table, [store, [{attributes, record_info(fields, store)}]]),\n\n    rpc:call(N1, mnesia, change_config, [extra_db_nodes, node()]),\n    [ rpc:call(N1, mnesia, add_table_copy, [store, N, ram_copies]) || N <- nodes() ],\n\n    1 = rpc:call(N1, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n\n    [{store, <<\"bacon\">>, 1}] = rpc:call(N2, mnesia, dirty_read, [store, <<\"bacon\">>]),\n    [{store, <<\"bacon\">>, 1}] = rpc:call(N3, mnesia, dirty_read, [store, <<\"bacon\">>]),\n\n    2 = rpc:call(N2, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n\n    [{store, <<\"bacon\">>, 2}] = rpc:call(N1, mnesia, dirty_read, [store, <<\"bacon\">>]),\n    [{store, <<\"bacon\">>, 2}] = rpc:call(N3, mnesia, dirty_read, [store, <<\"bacon\">>]),\n\n    3 = rpc:call(N1, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n    4 = rpc:call(N2, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n    5 = rpc:call(N3, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n\n    slave:stop(N1),\n    slave:stop(N2),\n    slave:stop(N3),\n\n    ok = net_kernel:stop(),\n    ok.\n\nspam.erl \u3067\u4fdd\u5b58\u3057\u3066\u3001\u8a66\u305b\u307e\u3059\u3002\n$ erl\nErlang/OTP 17 [erts-6.1] [source] [64-bit] [smp:4:4] [ds:4:4:10] [async-threads:10] [hipe] [kernel-poll:false] [dtrace]\n\nEshell V6.1  (abort with ^G)\n1> c(spam).\n{ok,spam}\n2> spam:main().\nok\n\n\n## \u74b0\u5883\n\n- Mac OS X 10.9.4\n- Erlang/OTP 17.1\n\n## \u6982\u8981\n\nErlang VM \u3092\u8907\u6570\u7acb\u3066\u3066\u3001Mnesia \u306e\u540c\u671f\u30c6\u30b9\u30c8\u3092 CommonTest \u3067\u306f\u306a\u304f EUnit \u3067\u306f\u3069\u3046\u3084\u308b\u306e\u304b\u8abf\u3079\u3066\u3044\u305f\u3068\u3053\u308d slave \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3048\u3070\u3088\u3044\u3068\u3044\u3046\u4e8b\u3060\u3063\u305f\u306e\u3067\u3001slave \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3063\u3066\u307f\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\nCommonTest \u306b\u306f ct_slave \u3068\u3044\u3046\u5c02\u7528\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u3042\u308b\u6a21\u69d8\u3002\n\n## \u30d5\u30ed\u30fc\n\n- \u30ce\u30fc\u30c9\u540d\u3092\u81ea\u5206\u306b\u4ed8\u3051\u307e\u3059\n    - net_kernel:start/1\n- \u30af\u30c3\u30ad\u30fc\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\n    - erlang:set_cookie/2\n- \u30ce\u30fc\u30c9\u3092 3 \u3064\u8d77\u52d5\u3057\u307e\u3059\n    - slave:start/3\n    - -setcookie \u3067\u30af\u30c3\u30ad\u30fc\u3092\u6307\u5b9a\u3059\u308b\n- 3 \u30ce\u30fc\u30c9\u5168\u3066\u3067 mnesia \u3092\u8d77\u52d5\u3057\u307e\u3059\n    - mnesia:start/0\n- 1 \u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u30c6\u30fc\u30d6\u30eb\u3092\u751f\u6210\u3057\u307e\u3059\n    - mnesia:create_table/2\n- \u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u305f\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u4ed6\u306e\u30ce\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\n    - mnesia:change_config/2\n- \u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u305f\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u30ec\u30d7\u30ea\u30ab\u5bfe\u8c61\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\n    - mnesia:add_table_copy/3\n- \u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u305f\u30ce\u30fc\u30c9\u306b bacon \u3068\u3044\u3046\u30ad\u30fc\u3067\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 +1 \u3057\u307e\u3059\n    - mnesia:dirty_update_counter/3\n- \u4ed6\u306e\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u30ab\u30a6\u30f3\u30bf\u30fc\u306e\u5024\u3092\u53d6\u5f97\u3057\u307e\u3059\n    - mnesia:dirty_read/2\n- \u5168\u3066\u306e\u30ce\u30fc\u30c9\u3067\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u5897\u52a0\u3055\u305b\u308b\n- \u8d77\u52d5\u3057\u305f 3 \u30ce\u30fc\u30c9\u3092\u7d42\u4e86\u3057\u307e\u3059\n    - slave:stop/1\n- \u81ea\u5206\u306e\u30ce\u30fc\u30c9\u540d\u3092\u524a\u9664\u3057\u307e\u3059\n    - net_kernel:stop/0\n\n## \u30b5\u30f3\u30d7\u30eb\n\n### \u8aac\u660e\n\n- \u30ce\u30fc\u30c9\u306f 3 \u53f0\n- \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306f\u30aa\u30f3\u30e1\u30e2\u30ea\n- \u540c\u671f\u306f Mnesia \u72ec\u81ea\u3092\u4f7f\u7528\n\n### \u30b3\u30fc\u30c9\n\n```erlang\n-module(spam).\n\n-export([main/0]).\n\n-include_lib(\"eunit/include/eunit.hrl\").\n\n-record(store, {key :: binary(),\n                value :: non_neg_integer()}).\n\nmain() ->\n    {ok, _Pid} = net_kernel:start([spam, shortnames]),\n    true = erlang:set_cookie(node(), spam),\n\n    Host = list_to_atom(net_adm:localhost()),\n    Args = \"-setcookie spam\",\n\n    {ok, N1} = slave:start(Host, n1, Args),\n    {ok, N2} = slave:start(Host, n2, Args),\n    {ok, N3} = slave:start(Host, n3, Args),\n\n    rpc:call(N1, net_kernel, connect_node, [N2]),\n    rpc:call(N1, net_kernel, connect_node, [N3]),\n\n    rpc:call(N1, mnesia, start, []),\n    rpc:call(N2, mnesia, start, []),\n    rpc:call(N3, mnesia, start, []),\n\n    rpc:call(N1, mnesia, create_table, [store, [{attributes, record_info(fields, store)}]]),\n\n    rpc:call(N1, mnesia, change_config, [extra_db_nodes, node()]),\n    [ rpc:call(N1, mnesia, add_table_copy, [store, N, ram_copies]) || N <- nodes() ],\n\n    1 = rpc:call(N1, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n\n    [{store, <<\"bacon\">>, 1}] = rpc:call(N2, mnesia, dirty_read, [store, <<\"bacon\">>]),\n    [{store, <<\"bacon\">>, 1}] = rpc:call(N3, mnesia, dirty_read, [store, <<\"bacon\">>]),\n\n    2 = rpc:call(N2, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n\n    [{store, <<\"bacon\">>, 2}] = rpc:call(N1, mnesia, dirty_read, [store, <<\"bacon\">>]),\n    [{store, <<\"bacon\">>, 2}] = rpc:call(N3, mnesia, dirty_read, [store, <<\"bacon\">>]),\n\n    3 = rpc:call(N1, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n    4 = rpc:call(N2, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n    5 = rpc:call(N3, mnesia, dirty_update_counter, [store, <<\"bacon\">>, 1]),\n\n    slave:stop(N1),\n    slave:stop(N2),\n    slave:stop(N3),\n\n    ok = net_kernel:stop(),\n    ok.\n```\n\n\nspam.erl \u3067\u4fdd\u5b58\u3057\u3066\u3001\u8a66\u305b\u307e\u3059\u3002\n\n```\n$ erl\nErlang/OTP 17 [erts-6.1] [source] [64-bit] [smp:4:4] [ds:4:4:10] [async-threads:10] [hipe] [kernel-poll:false] [dtrace]\n\nEshell V6.1  (abort with ^G)\n1> c(spam).\n{ok,spam}\n2> spam:main().\nok\n```\n", "tags": ["Mnesia", "Erlang"]}