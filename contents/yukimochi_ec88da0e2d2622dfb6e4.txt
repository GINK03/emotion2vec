{"context": "\n\n\u6982\u8981\uff08\u4e09\u884c\u3067\u307e\u3068\u3081\u308b\u3068\uff09\n\n\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3092\u6d3b\u7528\u3057\u3066\u3001\u65e2\u5b58\u306eWeb\u30da\u30fc\u30b8\u3092QUIC\u3067\u914d\u4fe1\u3057\u305f\u3044\u3002\n\nCaddy\u3068\u3044\u3046Web\u30b5\u30fc\u30d0\u3067\u306f\u3001\u5f15\u6570\u306b-quic\u3092\u3064\u3051\u308b\u3068\u3001\u8a66\u9a13\u7684\u306bQUIC\u3067\u914d\u4fe1\u304c\u3067\u304d\u308b\u3002\nAmazon Linux 2016.09 \u3067\u306f\u3001 init\u3092\u7528\u3044\u3066\u3001Caddy\u3092\u30b5\u30fc\u30d3\u30b9\u5316\u3055\u305b\u3001\u81ea\u52d5\u8d77\u52d5\u3055\u305b\u308b\u3088\u3046\u306b\u3067\u304d\u308b\u3002\n\n\nQUIC (Quick UDP Internet Connection)\u3068\u306f\nGoogle\u306e\u958b\u767a\u3057\u3066\u3044\u308b\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u5c64\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\n\u6a19\u6e96\u5316\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3067\u306f\u306a\u304f\u3001Google\u306e\u30b5\u30fc\u30d0\u3068Chrome\u3068\u306e\u9593\u3067\u306e\u8a66\u9a13\u904b\u7528\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u72b6\u6cc1\u3067\u3059\u3002\n\u6280\u8853\u7684\u306a\u3053\u3068\u306f\u3001IIJ \u5927\u6d25\u3055\u3093\u306e\u30b9\u30e9\u30a4\u30c9(HTTP/2\u304b\u3089QUIC\u3078\u7d9a\u304fWeb\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u9032\u5316)\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n\nQUIC\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308bWeb\u30b5\u30fc\u30d0\u306f\u5c11\u306a\u3044\n\nChromium\nCaddy\n\n\u203b\u307b\u304b\u306b\u3082\u3042\u308b\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001Caddy\u3092\u898b\u3064\u3051\u305f\u3042\u305f\u308a\u304b\u3089\u63a2\u3059\u6c17\u304c\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\nCaddy \u3063\u3066\u3069\u3093\u306aWeb\u30b5\u30fc\u30d0\uff1f\nQUIC\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d0\u3068\u3057\u3066\u3001\u540d\u524d\u306e\u77e5\u3089\u306a\u3044Web\u30b5\u30fc\u30d0\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\u3002\n\u7279\u5fb4\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\nGo\u8a00\u8a9e\u3067\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\n\u7c21\u5358\u306bWeb\u30b5\u30fc\u30d0\u304c\u7acb\u3066\u3089\u308c\u308b\u3002\nFastCGI\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002\n\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3084\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306a\u3069\u306e\u6a5f\u80fd\u3082\u642d\u8f09\u3057\u3066\u3044\u308b\u3002\nLet's Encrypt\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u5185\u8535\u3057\u3066\u3044\u3066\u3001\u7c21\u5358\u306b\u6697\u53f7\u5316\u3092\u6709\u52b9\u306b\u3067\u304d\u308b\u3002\nHTTP/2 \u306b\u65e2\u5b9a\u3067\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002\nQUIC \u306b\u8a66\u9a13\u7684\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002(\u91cd\u8981)\n\u521d\u671f\u8a2d\u5b9a\u3067\u3001Qualys SSL Server Test\u3067A\u5224\u5b9a\u304c\u53d6\u308c\u308b\u3002\n\n\u3046\u3061\u306e\u74b0\u5883\u306fASP.NET\u306a\u306e\u3067\u3001IIS 10.0 \u306e\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3068\u3057\u3066\u5229\u7528\u3057\u3066\u307f\u307e\u3059\u3002\n\nCaddy \u3092\u4f7f\u3063\u3066\u307f\u308b\n\n\u524d\u63d0\u6761\u4ef6\n\u5b9f\u9a13\u65e5: 2017/02/17\n\u540c\u4e00\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u30b0\u30eb\u30fc\u30d7\u5185\u306b2\u53f0\u306e\u30b5\u30fc\u30d0\u30fc\u3092\u7f6e\u3044\u3066\u5b9f\u9a13\u3057\u307e\u3057\u305f\u3002\n\n\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\nAWS EC2 \u4e0a\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\nOS: Amazon Linux 2016.09\nCaddy: 0.9.5\n\n\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\uff08\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u6e08\u307f\uff09\nAWS EC2 \u4e0a\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\nOS: Windows Server 2016 Datacenter\nIIS: 10.0 (8080\u30dd\u30fc\u30c8\u3067\u5f85\u3061\u53d7\u3051)\n\nCaddy \u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n\u3053\u3053\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3067\u306f\u306a\u304f\u3001\u30d0\u30a4\u30ca\u30ea\u304c\u76f4\u63a5\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306b\u3088\u3063\u3066\u3001\u3055\u307e\u3056\u307e\u306a\u6a5f\u80fd\u304c\u8ffd\u52a0\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3068\u3057\u3066\u4f7f\u3046\u5834\u5408\u306f\u3001\u4f55\u3082\u3064\u3051\u306a\u304f\u3066\u5927\u4e08\u592b\u3067\u3059\u3002\n\u3053\u306e\u30ea\u30f3\u30af\u306f\u52d5\u7684\u306b\u4f5c\u6210\u3055\u308c\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u76f4\u63a5wget\u3067\u304d\u307e\u305b\u3093\u3002\u4e00\u65e6\u3001\u7aef\u672b\u5074\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u3057\u3066\u304b\u3089\u3001SCP\u3067\u9001\u308a\u307e\u3057\u3087\u3046\u3002\u4eca\u56de\u306f\u3001Linux 64-bit\u3092\u9078\u3073\u307e\u3059\u3002\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092SCP\u306a\u3069\u3067\u8ee2\u9001\u3057\u305f\u3089\u3001\u5c55\u958b\u3057\u307e\u3059\u3002\n(\u4ee5\u4e0b\u306e\u4f8b\u306f\u3001ec2-user\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u8ee2\u9001\u3057\u305f\u5834\u5408)\n$ mkdir caddy\n$ cd caddy\n$ tar zxvf ../caddy_linux_amd64_custom.tar.gz\n$ ls -l\ntotal 15416\n-rwxrwxr-x 1 ec2-user ec2-user 15730207 Feb  6 13:52 caddy\n-rw-rw-r-- 1 ec2-user ec2-user    14996 Jan 24 15:38 CHANGES.txt\ndrwxrwxr-x 7 ec2-user ec2-user     4096 Jan 24 15:38 init\n-rw-rw-r-- 1 ec2-user ec2-user    25261 Jan 24 15:38 LICENSES.txt\n-rw-rw-r-- 1 ec2-user ec2-user      994 Jan 24 15:38 README.txt\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u5b9f\u884c\u53ef\u80fd\u30d5\u30a1\u30a4\u30eb\"caddy\"\u304c\u65e2\u306b\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002\n\nCaddy \u3092\u8d77\u52d5\u3055\u305b\u3066\u307f\u308b\nCaddy\u306e\u8d77\u52d5\u65b9\u6cd5\u306f\u3001\u7c21\u5358\u3067\u3059\u3002\n$ ./caddy\nActivating privacy features... done.\nhttp://:2015\n\n\u3053\u308c\u3067\u30012015\u756a\u30dd\u30fc\u30c8\u3067Web\u30b5\u30fc\u30d0\u304c\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30dd\u30fc\u30c8\u756a\u53f7\u306a\u3069\u306e\u6307\u5b9a\u306f\u3001\u5f15\u6570\u304bCaddyfile\u3092\u7528\u3044\u3066\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u307b\u3068\u3093\u3069\u306e\u8a2d\u5b9a\uff08\u3068\u3044\u3063\u3066\u3082\u307b\u3093\u306e\u5c11\u3057\u3067\u3059\u304c\uff09\u3092Caddyfile\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\n\nCaddyfile \u3092\u4f5c\u6210\u3059\u308b\nCaddyfile \u3068\u306f\u3001Caddy\u306e\u8a2d\u5b9a\u3092\u8a18\u8f09\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\u5b9f\u884c\u6642\u306b\u4ee5\u4e0b\u306e\u5f15\u6570\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u8aad\u307f\u8fbc\u307e\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n-conf=path/to/Caddyfile\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8f09\u3067\u304d\u308b\u5185\u5bb9\u306b\u3064\u3044\u3066\u306f\u3001\u516c\u5f0f\u30b5\u30a4\u30c8\u306edocs\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\u4eca\u56de\u306f\u3001\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3068\u3057\u3066\u5fc5\u8981\u306a\u8a2d\u5b9a\u306e\u307f\u306b\u89e6\u308c\u3066\u3044\u304d\u307e\u3059\u3002\n\u4ee5\u4e0b\u304c\u3001\u4eca\u56de\u8a2d\u5b9a\u3057\u305fCaddyfile\u3067\u3059\u3002\nhttps://example.jp {\nproxy / ip-xxx-xxx-xxx-xxx.aws-region.compute.internal:8080 {\nheader_upstream Host {host}\nheader_upstream X-Forwarded-For {remote}\n}\ntls admin@mail.example.jp\n}\n\nCaddyfile \u306f\u3001{}\u3067\u968e\u5c64\u5316\u3055\u308c\u3066\u8868\u73fe\u3055\u308c\u308b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\u4e00\u884c\u76ee\u306ehttps://example.jp\u304c\u3001URL\u3068\u306a\u308a\u307e\u3059\u3002\nCaddy\u3067\u306f\u3001\u81ea\u52d5\u3067\u8a3c\u660e\u66f8\u306e\u53d6\u5f97\u304c\u884c\u308f\u308c\u308b\u306e\u3067\u3001\u7279\u306b\u9593\u9055\u3048\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u306e\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\u3092{}\u5185\u306b\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\u4e8c\u884c\u76ee\u306eproxy\u306f\u3001\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u306e\u8a2d\u5b9a\u3067\u3059\u3002\n\u3053\u306e\u8a2d\u5b9a\u3067\u306f\u3001/\u3078\u306e\u30a2\u30af\u30bb\u30b9\u304c\u3001http://ip-xxx-xxx-xxx-xxx.aws-region.compute.internal:8080/\u3078\u8ee2\u9001\u3055\u308c\u308b\u5f62\u306b\u306a\u308a\u307e\u3059\u3002\nproxy / web1:8080 web2:8080 web3:8080\n\n\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3059\u308b\u3068\u3001Caddy\u306f\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u30fc\u3068\u3057\u3066\u6a5f\u80fd\u3057\u307e\u3059\u3002\nproxy\u306b\u3064\u3044\u3066\u306e\u8a2d\u5b9a\u306f\u3001\u3055\u3089\u306b{}\u5185\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\nheader_upstream Host {host} - \u5143\u306ehost\u306e\u60c5\u5831\u3092\u305d\u306e\u307e\u307e\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306b\u9001\u308a\u307e\u3059\u3002\nheader_upstream X-Forwarded-For {remote} - \u5143\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092X-Forwarded-For\u30d8\u30c3\u30c0\u3067\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306b\u9001\u308a\u307e\u3059\u3002\n\u516d\u884c\u76ee\u306etls\u306f\u3001\u6697\u53f7\u5316\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\u3067\u3059\u304c\u3001\u975e\u5e38\u306b\u30e6\u30cb\u30fc\u30af\u3067\u3059\u3002\nCaddy\u306f\u3001Let's Encrypt\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u5185\u8535\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u81ea\u52d5\u3067\u8a3c\u660e\u66f8\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u3053\u3053\u306b\u8a3c\u660e\u66f8\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\uff08\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\uff09\ntls\u306b\u306f\u3001\u6b21\u306e\uff14\u901a\u308a\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u307e\u3059\u3002\n\noff - HTTP\u901a\u4fe1\u3092\u884c\u3046\u3002\uff08\u6697\u53f7\u5316\u3057\u306a\u3044\uff09\nself_signed - \u81ea\u5df1\u7f72\u540d\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u3066\u3001\u305d\u308c\u3092\u4f7f\u3046\u3002\uff08\u6697\u53f7\u5316\u3059\u308b\uff09\nemail - \u3053\u3053\u306b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3059\u308b\u3068\u3001Let's Encrypt\u304b\u3089\u8a3c\u660e\u66f8\u3092\u53d6\u5f97\u3057\u3001\u305d\u308c\u3092\u4f7f\u3046\u3002\uff08\u6697\u53f7\u5316\u3059\u308b\uff09\n/path/to/cert /path/to/private_key - \u5165\u529b\u3055\u308c\u305f\u3068\u3053\u308d\u306b\u3042\u308b\u8a3c\u660e\u66f8\u3092\u4f7f\u3046\u3002\uff08\u6697\u53f7\u5316\u3059\u308b\uff09\n\n\u3053\u3053\u3067\u3082\u3001\u7d30\u304b\u304fprotocols\u3084chiphers\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u304c\u3001\u521d\u671f\u8a2d\u5b9a\u306e\u307e\u307e\u3067\u554f\u984c\u306a\u3044\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n(TLS1.0\u304c\u65e2\u5b9a\u3067\u7121\u52b9\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\uff09\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3093\u3067Caddy\u3092\u8d77\u52d5\u3059\u308b & QUIC \u3092\u6709\u52b9\u306b\u3059\u308b\n\u3053\u3053\u307e\u3067QUIC\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u73fe\u5728\u306e\u3068\u3053\u308dQUIC\u306e\u6709\u52b9\u5316\u306f\u5f15\u6570-quic\u3067\u306e\u307f\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\u3064\u3064\u3001QUIC\u3092\u6709\u52b9\u5316\u3057\u3066\u8d77\u52d5\u3057\u307e\u3059\u3002\n$ ./caddy -conf=/path/to/Caddyfile -quic\n\n\u3053\u306e\u72b6\u614b\u3067\u3001Google Chrome \u306a\u3069\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3092\u8a66\u884c\u3057\u3066\u3001QUIC\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n(Caddy\u3067\u306f\u3001https\u306e\u307f\u304c\u6709\u52b9\u306a\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306b\u5bfe\u3057\u3066http\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u81ea\u52d5\u7684\u306bhttps\u306b\u8ee2\u9001\u3055\u308c\u307e\u3059\u304c\u3001TLS1.2\u306b\u3088\u308a\u63a5\u7d9a\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002https\u306b\u8ee2\u9001\u3055\u308c\u305f\u306e\u3061\u306b\u66f4\u65b0\u3059\u308b\u306a\u3069\u3057\u3066\u518d\u63a5\u7d9a\u3059\u308b\u3068QUIC\u3067\u63a5\u7d9a\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002)\n\n\n\u30c7\u30fc\u30e2\u30f3\u5316\u3055\u305b\u3066\u81ea\u52d5\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u3059\u308b\n\u3042\u307e\u308a\u3084\u308b\u4eba\u306f\u3044\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001Caddy\u3092\u30c7\u30fc\u30e2\u30f3\u5316\u3055\u305b\u3066\u81ea\u52d5\u8d77\u52d5\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\u3053\u308c\u306f\u3001\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u308a\u5909\u308f\u3063\u3066\u304d\u307e\u3059\u306e\u3067\u3001Amazon Linux 2016.09 \u3067\u306e\u4f8b\u3068\u306a\u308a\u307e\u3059\u3002\nAmazon Linux 2016.09 \u3067\u306f\u3001\u307e\u3060systemd\u306b\u79fb\u884c\u3057\u3066\u3044\u307e\u305b\u3093\u306e\u3067\u3001init\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305a\u3001/etc/init.d/\u4ee5\u4e0b\u306b\u3053\u306e\u3088\u3046\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u304d\u307e\u3059\u3002\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u3001caddy\u306a\u3069\u3068\u3057\u3066\u304a\u304f\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n(\u3053\u3061\u3089\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002)\n!/bin/bash\n# Caddy daemon\n# chkconfig: 345 20 80\n# description: Caddy daemon\n# processname: caddy\n\nDAEMON_PATH=\"/path/to/caddy/\"\n\nDAEMON='./caddy'\nDAEMONOPTS=\"-quic -conf=/path/to/Caddyfile -log /var/log/caddy.log\"\n\nNAME=caddy\nDESC=\"Caddy upstart\"\nPIDFILE=/var/run/$NAME.pid\nSCRIPTNAME=/etc/init.d/$NAME\n\ncase \"$1\" in\nstart)\n    printf \"%-50s\" \"Starting $NAME...\"\n    cd $DAEMON_PATH\n    PID=`$DAEMON $DAEMONOPTS > /dev/null 2>&1 & echo $!`\n    echo \"Saving PID\" $PID \" to \" $PIDFILE\n        if [ -z $PID ]; then\n            printf \"%s\\n\" \"Fail\"\n        else\n            echo $PID > $PIDFILE\n            printf \"%s\\n\" \"Ok\"\n        fi\n;;\nstatus)\n        printf \"%-50s\" \"Checking $NAME...\"\n        if [ -f $PIDFILE ]; then\n            PID=`cat $PIDFILE`\n            if [ -z \"`ps axf | grep ${PID} | grep -v grep`\" ]; then\n                printf \"%s\\n\" \"Process dead but pidfile exists\"\n            else\n                echo \"Running\"\n            fi\n        else\n            printf \"%s\\n\" \"Service not running\"\n        fi\n;;\nstop)\n        printf \"%-50s\" \"Stopping $NAME\"\n            PID=`cat $PIDFILE`\n            cd $DAEMON_PATH\n        if [ -f $PIDFILE ]; then\n            kill -HUP $PID\n            printf \"%s\\n\" \"Ok\"\n            rm -f $PIDFILE\n        else\n            printf \"%s\\n\" \"pidfile not found\"\n        fi\n;;\n\nrestart)\n    $0 stop\n    $0 start\n;;\n\n*)\n        echo \"Usage: $0 {status|start|stop|restart}\"\n        exit 1\nesac\n\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u5b9f\u884c\u6a29\u9650\u3092\u4e0e\u3048\u307e\u3059\u3002\n# chmod +x caddy\n\n\u7d9a\u3044\u3066\u3001chkconfig\u3067\u30b5\u30fc\u30d3\u30b9\u767b\u9332\u3092\u3059\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n# chkconfig --add caddy\n\n\u3053\u308c\u3067\u3001\u8d77\u52d5\u6642\u306b\u81ea\u52d5\u8d77\u52d5\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b5\u30fc\u30d3\u30b9\u306e\u5236\u5fa1\u3082\u884c\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n# service caddy start\n# service caddy status\n# service caddy stop\n\n\n\u307e\u3068\u3081\n\u4eca\u56de\u306f\u3001Caddy\u3092\u4f7f\u3063\u3066\u65e2\u5b58\u306eWeb\u30da\u30fc\u30b8\u3092\u7121\u7406\u3084\u308aQUIC\u3067\u914d\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u3057\u305f\u304c\u3063\u3066\u3001\u5b9f\u969b\u306bQUIC\u306e\u6301\u3064\u6069\u6075\u3092\u53d7\u3051\u3089\u308c\u308b\u306e\u304b\u306f\u7591\u554f\u304c\u6b8b\u308a\u307e\u3059\u3002\n\u305f\u3060\u3001\u5468\u56f2\u306b\u5148\u99c6\u3051\u3066QUIC\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u306e\u3092\u898b\u305b\u3064\u3051\u3066\u697d\u3057\u3080\u3053\u3068\u304f\u3089\u3044\u306f\u3067\u304d\u307e\u3059\u306d\u3002\n\uff08HTTP/2 and SPDY indicator\u304c\u7dd1\u8272\u306b\u5149\u308a\u307e\u3059\u3002\uff09\n\u6642\u9593\u304c\u3042\u3063\u305f\u3089\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u306a\u3069\u3082\u3057\u3066\u307f\u305f\u3044\u3067\u3059\u304c\u3001\u6761\u4ef6\u3092\u6574\u3048\u308b\u306e\u3082\u96e3\u3057\u305d\u3046\u306a\u306e\u3067\u3042\u307e\u308a\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u304f\u306a\u3044\u3067\u3059\u3002\n\u30cd\u30a4\u30c6\u30a3\u30d6\u306bASP.NET \u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092QUIC\u3067\u914d\u4fe1\u3059\u308b\u306b\u306f\u3001IIS \u304cQUIC\u306b\u5bfe\u5fdc\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\n\u5b9f\u969b\u306bMicrosoft\u793e\u5185\u3067\u306fQUIC\u306b\u3088\u308bWeb\u30b5\u30fc\u30d0\u304c\u4f5c\u3089\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u8a71\u3082\u805e\u304f\u306e\u3067\u3001\u697d\u3057\u307f\u306b\u5f85\u3063\u3066\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\uff08\u305d\u306e\u307e\u3048\u306b\u3001\u898f\u683c\u5316\u3055\u308c\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u304c\u3002\uff09\n\n\u53c2\u8003\u6587\u732e\u30fb\u30ea\u30f3\u30af\nCaddy - Official Site - Caddy\u306e\u9812\u5e03\u5143\nHTTP/2\u304b\u3089QUIC\u3078\u7d9a\u304fWeb\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u9032\u5316 - \u975e\u5e38\u306b\u5206\u304b\u308a\u3084\u3059\u3044\u30d7\u30ec\u30bc\u30f3\u3067\u3059\u3002(11/11 IIJ \u5927\u6d25\u3055\u3093\u306e\u3082\u306e)\ncaddy int.d script - slav123 - caddy\u7528\u306einit\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\uff08CentOS6\u307e\u3067\uff09\u81ea\u4f5c\u306e\u30b5\u30fc\u30d3\u30b9\u3092chkconfig\u3067\u767b\u9332\u3059\u308b - chkconfig\u3067\u306e\u30b5\u30fc\u30d3\u30b9\u306e\u767b\u9332\u65b9\u6cd5\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n# \u6982\u8981\uff08\u4e09\u884c\u3067\u307e\u3068\u3081\u308b\u3068\uff09\n1. \u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3092\u6d3b\u7528\u3057\u3066\u3001\u65e2\u5b58\u306eWeb\u30da\u30fc\u30b8\u3092QUIC\u3067\u914d\u4fe1\u3057\u305f\u3044\u3002\n1. [Caddy](https://caddyserver.com/)\u3068\u3044\u3046Web\u30b5\u30fc\u30d0\u3067\u306f\u3001\u5f15\u6570\u306b`-quic`\u3092\u3064\u3051\u308b\u3068\u3001\u8a66\u9a13\u7684\u306bQUIC\u3067\u914d\u4fe1\u304c\u3067\u304d\u308b\u3002\n1. Amazon Linux 2016.09 \u3067\u306f\u3001 init\u3092\u7528\u3044\u3066\u3001Caddy\u3092\u30b5\u30fc\u30d3\u30b9\u5316\u3055\u305b\u3001\u81ea\u52d5\u8d77\u52d5\u3055\u305b\u308b\u3088\u3046\u306b\u3067\u304d\u308b\u3002\n\n# QUIC (Quick UDP Internet Connection)\u3068\u306f\nGoogle\u306e\u958b\u767a\u3057\u3066\u3044\u308b\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u5c64\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u3059\u3002\n\u6a19\u6e96\u5316\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3067\u306f\u306a\u304f\u3001Google\u306e\u30b5\u30fc\u30d0\u3068Chrome\u3068\u306e\u9593\u3067\u306e\u8a66\u9a13\u904b\u7528\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u72b6\u6cc1\u3067\u3059\u3002\n\n\u6280\u8853\u7684\u306a\u3053\u3068\u306f\u3001IIJ \u5927\u6d25\u3055\u3093\u306e\u30b9\u30e9\u30a4\u30c9([HTTP/2\u304b\u3089QUIC\u3078\u7d9a\u304fWeb\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u9032\u5316](http://www.iij.ad.jp/company/development/tech/techweek/2015/))\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3067\u3059\u3002\n\n# QUIC\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308bWeb\u30b5\u30fc\u30d0\u306f\u5c11\u306a\u3044\n1. [Chromium](https://www.chromium.org/Home)\n1. [Caddy](https://caddyserver.com/)\n\n\u203b\u307b\u304b\u306b\u3082\u3042\u308b\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001Caddy\u3092\u898b\u3064\u3051\u305f\u3042\u305f\u308a\u304b\u3089\u63a2\u3059\u6c17\u304c\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n# Caddy \u3063\u3066\u3069\u3093\u306aWeb\u30b5\u30fc\u30d0\uff1f\nQUIC\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d0\u3068\u3057\u3066\u3001\u540d\u524d\u306e\u77e5\u3089\u306a\u3044Web\u30b5\u30fc\u30d0\u304c\u51fa\u3066\u304d\u307e\u3057\u305f\u3002\n\u7279\u5fb4\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\n\n- Go\u8a00\u8a9e\u3067\u66f8\u304b\u308c\u3066\u3044\u308b\u3002\n- \u7c21\u5358\u306bWeb\u30b5\u30fc\u30d0\u304c\u7acb\u3066\u3089\u308c\u308b\u3002\n- FastCGI\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002\n- \u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3084\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u306a\u3069\u306e\u6a5f\u80fd\u3082\u642d\u8f09\u3057\u3066\u3044\u308b\u3002\n- Let's Encrypt\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u5185\u8535\u3057\u3066\u3044\u3066\u3001\u7c21\u5358\u306b\u6697\u53f7\u5316\u3092\u6709\u52b9\u306b\u3067\u304d\u308b\u3002\n- HTTP/2 \u306b\u65e2\u5b9a\u3067\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002\n- **QUIC \u306b\u8a66\u9a13\u7684\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u3002(\u91cd\u8981)**\n- \u521d\u671f\u8a2d\u5b9a\u3067\u3001[Qualys SSL Server Test](https://www.ssllabs.com/ssltest/)\u3067A\u5224\u5b9a\u304c\u53d6\u308c\u308b\u3002\n\n\u3046\u3061\u306e\u74b0\u5883\u306fASP.NET\u306a\u306e\u3067\u3001IIS 10.0 \u306e\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3068\u3057\u3066\u5229\u7528\u3057\u3066\u307f\u307e\u3059\u3002\n\n# Caddy \u3092\u4f7f\u3063\u3066\u307f\u308b\n## \u524d\u63d0\u6761\u4ef6\n\u5b9f\u9a13\u65e5: 2017/02/17\n\u540c\u4e00\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u30b0\u30eb\u30fc\u30d7\u5185\u306b2\u53f0\u306e\u30b5\u30fc\u30d0\u30fc\u3092\u7f6e\u3044\u3066\u5b9f\u9a13\u3057\u307e\u3057\u305f\u3002\n### \u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\nAWS EC2 \u4e0a\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\nOS: Amazon Linux 2016.09\nCaddy: 0.9.5\n### \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\uff08\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u6e08\u307f\uff09\nAWS EC2 \u4e0a\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\nOS: Windows Server 2016 Datacenter\nIIS: 10.0 (8080\u30dd\u30fc\u30c8\u3067\u5f85\u3061\u53d7\u3051)\n\n## Caddy \u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\n[\u3053\u3053](https://caddyserver.com/download)\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3067\u306f\u306a\u304f\u3001\u30d0\u30a4\u30ca\u30ea\u304c\u76f4\u63a5\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\n![1.png](https://qiita-image-store.s3.amazonaws.com/0/165383/1f3f8c4f-272c-6e3e-a936-5f01b38ec4bd.png)\n\u30d7\u30e9\u30b0\u30a4\u30f3\u306b\u3088\u3063\u3066\u3001\u3055\u307e\u3056\u307e\u306a\u6a5f\u80fd\u304c\u8ffd\u52a0\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u304c\u3001\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3068\u3057\u3066\u4f7f\u3046\u5834\u5408\u306f\u3001\u4f55\u3082\u3064\u3051\u306a\u304f\u3066\u5927\u4e08\u592b\u3067\u3059\u3002\n![2.png](https://qiita-image-store.s3.amazonaws.com/0/165383/4419b639-cc1f-aa5c-f79a-c7250ead3d47.png)\u3053\u306e\u30ea\u30f3\u30af\u306f\u52d5\u7684\u306b\u4f5c\u6210\u3055\u308c\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u76f4\u63a5wget\u3067\u304d\u307e\u305b\u3093\u3002\u4e00\u65e6\u3001\u7aef\u672b\u5074\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u3057\u3066\u304b\u3089\u3001SCP\u3067\u9001\u308a\u307e\u3057\u3087\u3046\u3002\u4eca\u56de\u306f\u3001Linux 64-bit\u3092\u9078\u3073\u307e\u3059\u3002\n\n\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092SCP\u306a\u3069\u3067\u8ee2\u9001\u3057\u305f\u3089\u3001\u5c55\u958b\u3057\u307e\u3059\u3002\n(\u4ee5\u4e0b\u306e\u4f8b\u306f\u3001ec2-user\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u8ee2\u9001\u3057\u305f\u5834\u5408)\n\n````\n$ mkdir caddy\n$ cd caddy\n$ tar zxvf ../caddy_linux_amd64_custom.tar.gz\n$ ls -l\ntotal 15416\n-rwxrwxr-x 1 ec2-user ec2-user 15730207 Feb  6 13:52 caddy\n-rw-rw-r-- 1 ec2-user ec2-user    14996 Jan 24 15:38 CHANGES.txt\ndrwxrwxr-x 7 ec2-user ec2-user     4096 Jan 24 15:38 init\n-rw-rw-r-- 1 ec2-user ec2-user    25261 Jan 24 15:38 LICENSES.txt\n-rw-rw-r-- 1 ec2-user ec2-user      994 Jan 24 15:38 README.txt\n````\n\u3053\u306e\u3088\u3046\u306b\u3001\u5b9f\u884c\u53ef\u80fd\u30d5\u30a1\u30a4\u30eb\"caddy\"\u304c\u65e2\u306b\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002\n\n## Caddy \u3092\u8d77\u52d5\u3055\u305b\u3066\u307f\u308b\nCaddy\u306e\u8d77\u52d5\u65b9\u6cd5\u306f\u3001\u7c21\u5358\u3067\u3059\u3002\n\n````\n$ ./caddy\nActivating privacy features... done.\nhttp://:2015\n````\n\u3053\u308c\u3067\u30012015\u756a\u30dd\u30fc\u30c8\u3067Web\u30b5\u30fc\u30d0\u304c\u52d5\u4f5c\u3057\u307e\u3059\u3002\n\u306a\u304a\u3001\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3084\u30dd\u30fc\u30c8\u756a\u53f7\u306a\u3069\u306e\u6307\u5b9a\u306f\u3001\u5f15\u6570\u304bCaddyfile\u3092\u7528\u3044\u3066\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u307b\u3068\u3093\u3069\u306e\u8a2d\u5b9a\uff08\u3068\u3044\u3063\u3066\u3082\u307b\u3093\u306e\u5c11\u3057\u3067\u3059\u304c\uff09\u3092Caddyfile\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n## Caddyfile \u3092\u4f5c\u6210\u3059\u308b\nCaddyfile \u3068\u306f\u3001Caddy\u306e\u8a2d\u5b9a\u3092\u8a18\u8f09\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n\u5b9f\u884c\u6642\u306b\u4ee5\u4e0b\u306e\u5f15\u6570\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u8aad\u307f\u8fbc\u307e\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n-conf=path/to/Caddyfile\n\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8f09\u3067\u304d\u308b\u5185\u5bb9\u306b\u3064\u3044\u3066\u306f\u3001[\u516c\u5f0f\u30b5\u30a4\u30c8\u306edocs](https://caddyserver.com/docs/caddyfile)\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\n\u4eca\u56de\u306f\u3001\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u3068\u3057\u3066\u5fc5\u8981\u306a\u8a2d\u5b9a\u306e\u307f\u306b\u89e6\u308c\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u304c\u3001\u4eca\u56de\u8a2d\u5b9a\u3057\u305fCaddyfile\u3067\u3059\u3002\n\n````\nhttps://example.jp {\nproxy / ip-xxx-xxx-xxx-xxx.aws-region.compute.internal:8080 {\nheader_upstream Host {host}\nheader_upstream X-Forwarded-For {remote}\n}\ntls admin@mail.example.jp\n}\n````\nCaddyfile \u306f\u3001{}\u3067\u968e\u5c64\u5316\u3055\u308c\u3066\u8868\u73fe\u3055\u308c\u308b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n\u4e00\u884c\u76ee\u306e`https://example.jp`\u304c\u3001URL\u3068\u306a\u308a\u307e\u3059\u3002\nCaddy\u3067\u306f\u3001\u81ea\u52d5\u3067\u8a3c\u660e\u66f8\u306e\u53d6\u5f97\u304c\u884c\u308f\u308c\u308b\u306e\u3067\u3001\u7279\u306b\u9593\u9055\u3048\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u306e\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\u3092{}\u5185\u306b\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u4e8c\u884c\u76ee\u306e`proxy`\u306f\u3001\u30ea\u30d0\u30fc\u30b9\u30d7\u30ed\u30ad\u30b7\u306e\u8a2d\u5b9a\u3067\u3059\u3002\n\u3053\u306e\u8a2d\u5b9a\u3067\u306f\u3001`/`\u3078\u306e\u30a2\u30af\u30bb\u30b9\u304c\u3001`http://ip-xxx-xxx-xxx-xxx.aws-region.compute.internal:8080/`\u3078\u8ee2\u9001\u3055\u308c\u308b\u5f62\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\nproxy / web1:8080 web2:8080 web3:8080\n```\n\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3059\u308b\u3068\u3001Caddy\u306f\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u30fc\u3068\u3057\u3066\u6a5f\u80fd\u3057\u307e\u3059\u3002\n`proxy`\u306b\u3064\u3044\u3066\u306e\u8a2d\u5b9a\u306f\u3001\u3055\u3089\u306b{}\u5185\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n`header_upstream Host {host}` - \u5143\u306e`host`\u306e\u60c5\u5831\u3092\u305d\u306e\u307e\u307e\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306b\u9001\u308a\u307e\u3059\u3002\n`header_upstream X-Forwarded-For {remote}` - \u5143\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092`X-Forwarded-For`\u30d8\u30c3\u30c0\u3067\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u306b\u9001\u308a\u307e\u3059\u3002\n\n\u516d\u884c\u76ee\u306e`tls`\u306f\u3001\u6697\u53f7\u5316\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\u3067\u3059\u304c\u3001\u975e\u5e38\u306b\u30e6\u30cb\u30fc\u30af\u3067\u3059\u3002\nCaddy\u306f\u3001Let's Encrypt\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3092\u5185\u8535\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u81ea\u52d5\u3067\u8a3c\u660e\u66f8\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u305d\u306e\u305f\u3081\u3001\u3053\u3053\u306b\u8a3c\u660e\u66f8\u306e\u30d1\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\uff08\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u3002\uff09\n`tls`\u306b\u306f\u3001\u6b21\u306e\uff14\u901a\u308a\u306e\u8a2d\u5b9a\u304c\u3067\u304d\u307e\u3059\u3002\n\n- off - HTTP\u901a\u4fe1\u3092\u884c\u3046\u3002\uff08\u6697\u53f7\u5316\u3057\u306a\u3044\uff09\n- self_signed - \u81ea\u5df1\u7f72\u540d\u8a3c\u660e\u66f8\u3092\u4f5c\u6210\u3057\u3066\u3001\u305d\u308c\u3092\u4f7f\u3046\u3002\uff08\u6697\u53f7\u5316\u3059\u308b\uff09\n- email - \u3053\u3053\u306b\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3092\u5165\u529b\u3059\u308b\u3068\u3001Let's Encrypt\u304b\u3089\u8a3c\u660e\u66f8\u3092\u53d6\u5f97\u3057\u3001\u305d\u308c\u3092\u4f7f\u3046\u3002\uff08\u6697\u53f7\u5316\u3059\u308b\uff09\n- /path/to/cert /path/to/private_key - \u5165\u529b\u3055\u308c\u305f\u3068\u3053\u308d\u306b\u3042\u308b\u8a3c\u660e\u66f8\u3092\u4f7f\u3046\u3002\uff08\u6697\u53f7\u5316\u3059\u308b\uff09\n\n\u3053\u3053\u3067\u3082\u3001\u7d30\u304b\u304fprotocols\u3084chiphers\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u304c\u3001\u521d\u671f\u8a2d\u5b9a\u306e\u307e\u307e\u3067\u554f\u984c\u306a\u3044\u3068\u601d\u308f\u308c\u307e\u3059\u3002\n(TLS1.0\u304c\u65e2\u5b9a\u3067\u7121\u52b9\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u6ce8\u610f\u304c\u5fc5\u8981\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\uff09\n\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3093\u3067Caddy\u3092\u8d77\u52d5\u3059\u308b & QUIC \u3092\u6709\u52b9\u306b\u3059\u308b\n\u3053\u3053\u307e\u3067QUIC\u306b\u95a2\u3059\u308b\u8a2d\u5b9a\u306f\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u73fe\u5728\u306e\u3068\u3053\u308dQUIC\u306e\u6709\u52b9\u5316\u306f\u5f15\u6570`-quic`\u3067\u306e\u307f\u3067\u304d\u308b\u3088\u3046\u3067\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\u3064\u3064\u3001QUIC\u3092\u6709\u52b9\u5316\u3057\u3066\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n````\n$ ./caddy -conf=/path/to/Caddyfile -quic\n````\n\u3053\u306e\u72b6\u614b\u3067\u3001Google Chrome \u306a\u3069\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3092\u8a66\u884c\u3057\u3066\u3001QUIC\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n(Caddy\u3067\u306f\u3001https\u306e\u307f\u304c\u6709\u52b9\u306a\u30d0\u30fc\u30c1\u30e3\u30eb\u30db\u30b9\u30c8\u306b\u5bfe\u3057\u3066http\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u81ea\u52d5\u7684\u306bhttps\u306b\u8ee2\u9001\u3055\u308c\u307e\u3059\u304c\u3001TLS1.2\u306b\u3088\u308a\u63a5\u7d9a\u3055\u308c\u3066\u3057\u307e\u3044\u307e\u3059\u3002https\u306b\u8ee2\u9001\u3055\u308c\u305f\u306e\u3061\u306b\u66f4\u65b0\u3059\u308b\u306a\u3069\u3057\u3066\u518d\u63a5\u7d9a\u3059\u308b\u3068QUIC\u3067\u63a5\u7d9a\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002)\n![QUIC.PNG](https://qiita-image-store.s3.amazonaws.com/0/165383/42117a6f-1c47-0877-3785-85eb017284ae.png)\n\n# \u30c7\u30fc\u30e2\u30f3\u5316\u3055\u305b\u3066\u81ea\u52d5\u8d77\u52d5\u3059\u308b\u3088\u3046\u306b\u3059\u308b\n\u3042\u307e\u308a\u3084\u308b\u4eba\u306f\u3044\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001Caddy\u3092\u30c7\u30fc\u30e2\u30f3\u5316\u3055\u305b\u3066\u81ea\u52d5\u8d77\u52d5\u3055\u305b\u3066\u307f\u307e\u3059\u3002\n\u3053\u308c\u306f\u3001\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u306b\u3088\u308a\u5909\u308f\u3063\u3066\u304d\u307e\u3059\u306e\u3067\u3001Amazon Linux 2016.09 \u3067\u306e\u4f8b\u3068\u306a\u308a\u307e\u3059\u3002\n\nAmazon Linux 2016.09 \u3067\u306f\u3001\u307e\u3060systemd\u306b\u79fb\u884c\u3057\u3066\u3044\u307e\u305b\u3093\u306e\u3067\u3001init\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305a\u3001`/etc/init.d/`\u4ee5\u4e0b\u306b\u3053\u306e\u3088\u3046\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u304d\u307e\u3059\u3002\u30d5\u30a1\u30a4\u30eb\u540d\u306f\u3001`caddy`\u306a\u3069\u3068\u3057\u3066\u304a\u304f\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n([\u3053\u3061\u3089](https://gist.github.com/slav123/f58c9c25587ab4987186)\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002)\n\n````sh(caddy)\n!/bin/bash\n# Caddy daemon\n# chkconfig: 345 20 80\n# description: Caddy daemon\n# processname: caddy\n\nDAEMON_PATH=\"/path/to/caddy/\"\n\nDAEMON='./caddy'\nDAEMONOPTS=\"-quic -conf=/path/to/Caddyfile -log /var/log/caddy.log\"\n\nNAME=caddy\nDESC=\"Caddy upstart\"\nPIDFILE=/var/run/$NAME.pid\nSCRIPTNAME=/etc/init.d/$NAME\n\ncase \"$1\" in\nstart)\n    printf \"%-50s\" \"Starting $NAME...\"\n    cd $DAEMON_PATH\n    PID=`$DAEMON $DAEMONOPTS > /dev/null 2>&1 & echo $!`\n    echo \"Saving PID\" $PID \" to \" $PIDFILE\n        if [ -z $PID ]; then\n            printf \"%s\\n\" \"Fail\"\n        else\n            echo $PID > $PIDFILE\n            printf \"%s\\n\" \"Ok\"\n        fi\n;;\nstatus)\n        printf \"%-50s\" \"Checking $NAME...\"\n        if [ -f $PIDFILE ]; then\n            PID=`cat $PIDFILE`\n            if [ -z \"`ps axf | grep ${PID} | grep -v grep`\" ]; then\n                printf \"%s\\n\" \"Process dead but pidfile exists\"\n            else\n                echo \"Running\"\n            fi\n        else\n            printf \"%s\\n\" \"Service not running\"\n        fi\n;;\nstop)\n        printf \"%-50s\" \"Stopping $NAME\"\n            PID=`cat $PIDFILE`\n            cd $DAEMON_PATH\n        if [ -f $PIDFILE ]; then\n            kill -HUP $PID\n            printf \"%s\\n\" \"Ok\"\n            rm -f $PIDFILE\n        else\n            printf \"%s\\n\" \"pidfile not found\"\n        fi\n;;\n\nrestart)\n    $0 stop\n    $0 start\n;;\n\n*)\n        echo \"Usage: $0 {status|start|stop|restart}\"\n        exit 1\nesac\n````\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u5b9f\u884c\u6a29\u9650\u3092\u4e0e\u3048\u307e\u3059\u3002\n\n````\n# chmod +x caddy\n````\n\u7d9a\u3044\u3066\u3001`chkconfig`\u3067\u30b5\u30fc\u30d3\u30b9\u767b\u9332\u3092\u3059\u308c\u3070\u5b8c\u4e86\u3067\u3059\u3002\n\n````\n# chkconfig --add caddy\n````\n\u3053\u308c\u3067\u3001\u8d77\u52d5\u6642\u306b\u81ea\u52d5\u8d77\u52d5\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b5\u30fc\u30d3\u30b9\u306e\u5236\u5fa1\u3082\u884c\u3048\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n````\n# service caddy start\n# service caddy status\n# service caddy stop\n````\n\n# \u307e\u3068\u3081\n\u4eca\u56de\u306f\u3001Caddy\u3092\u4f7f\u3063\u3066\u65e2\u5b58\u306eWeb\u30da\u30fc\u30b8\u3092\u7121\u7406\u3084\u308aQUIC\u3067\u914d\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u3057\u305f\u304c\u3063\u3066\u3001\u5b9f\u969b\u306bQUIC\u306e\u6301\u3064\u6069\u6075\u3092\u53d7\u3051\u3089\u308c\u308b\u306e\u304b\u306f\u7591\u554f\u304c\u6b8b\u308a\u307e\u3059\u3002\n\u305f\u3060\u3001\u5468\u56f2\u306b\u5148\u99c6\u3051\u3066QUIC\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u306e\u3092\u898b\u305b\u3064\u3051\u3066\u697d\u3057\u3080\u3053\u3068\u304f\u3089\u3044\u306f\u3067\u304d\u307e\u3059\u306d\u3002\n\uff08[HTTP/2 and SPDY indicator](https://chrome.google.com/webstore/detail/http2-and-spdy-indicator/mpbpobfflnpcgagjijhmgnchggcjblin)\u304c\u7dd1\u8272\u306b\u5149\u308a\u307e\u3059\u3002\uff09\n\u6642\u9593\u304c\u3042\u3063\u305f\u3089\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u306a\u3069\u3082\u3057\u3066\u307f\u305f\u3044\u3067\u3059\u304c\u3001\u6761\u4ef6\u3092\u6574\u3048\u308b\u306e\u3082\u96e3\u3057\u305d\u3046\u306a\u306e\u3067\u3042\u307e\u308a\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u304f\u306a\u3044\u3067\u3059\u3002\n\n\u30cd\u30a4\u30c6\u30a3\u30d6\u306bASP.NET \u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092QUIC\u3067\u914d\u4fe1\u3059\u308b\u306b\u306f\u3001IIS \u304cQUIC\u306b\u5bfe\u5fdc\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001\n\u5b9f\u969b\u306bMicrosoft\u793e\u5185\u3067\u306fQUIC\u306b\u3088\u308bWeb\u30b5\u30fc\u30d0\u304c\u4f5c\u3089\u308c\u3066\u3044\u308b\u3068\u3044\u3046\u8a71\u3082\u805e\u304f\u306e\u3067\u3001\u697d\u3057\u307f\u306b\u5f85\u3063\u3066\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\uff08\u305d\u306e\u307e\u3048\u306b\u3001\u898f\u683c\u5316\u3055\u308c\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u304c\u3002\uff09\n\n# \u53c2\u8003\u6587\u732e\u30fb\u30ea\u30f3\u30af\n[Caddy - Official Site](https://caddyserver.com/) - Caddy\u306e\u9812\u5e03\u5143\n[HTTP/2\u304b\u3089QUIC\u3078\u7d9a\u304fWeb\u30d7\u30ed\u30c8\u30b3\u30eb\u306e\u9032\u5316](http://www.iij.ad.jp/company/development/tech/techweek/2015/) - \u975e\u5e38\u306b\u5206\u304b\u308a\u3084\u3059\u3044\u30d7\u30ec\u30bc\u30f3\u3067\u3059\u3002(11/11 IIJ \u5927\u6d25\u3055\u3093\u306e\u3082\u306e)\n[caddy int.d script - slav123](https://gist.github.com/slav123/f58c9c25587ab4987186) - caddy\u7528\u306einit\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n[\uff08CentOS6\u307e\u3067\uff09\u81ea\u4f5c\u306e\u30b5\u30fc\u30d3\u30b9\u3092chkconfig\u3067\u767b\u9332\u3059\u308b](http://kazmax.zpp.jp/linux_beginner/self-made_service_chkconfig.html) - chkconfig\u3067\u306e\u30b5\u30fc\u30d3\u30b9\u306e\u767b\u9332\u65b9\u6cd5\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n", "tags": ["Caddy", "QUIC", "http2"]}