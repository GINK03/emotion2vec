{"tags": ["redux", "redux-saga", "reactjs", "bitbucket"], "context": "\n\n\u306f\u3058\u3081\u306b\nBitbucket Browser\u3068\u3044\u3046Bitbucket Server\u306eViewer\u3092React\u3067\u4f5c\u3063\u3066\u3044\u3066\u3001\u6a5f\u80fd\u8ffd\u52a0\u306b\u4f34\u3044\u975e\u540c\u671f\u51e6\u7406\u90e8\u5206\u304c\u3060\u3093\u3060\u3093\u8f9b\u304f\u306a\u3063\u3066\u304d\u305f\u306e\u3067\u3001\u52c9\u5f37\u3082\u517c\u306d\u3066redux-saga\u3092\u4f7f\u3063\u3066\u307f\u305f\u3089\u3069\u3046\u6539\u5584\u3055\u308c\u308b\u306e\u304b\u8a66\u3057\u3066\u307f\u305f\u3002\n\u306a\u304a\u3001Bitbucket\u306b\u306f\u30d7\u30e9\u30b0\u30a4\u30f3\u6a5f\u69cb\u304c\u3042\u308b\u306e\u3067\u30d7\u30e9\u30b0\u30a4\u30f3\u3068\u3057\u3066\u5b9f\u88c5\u3059\u308b\u306e\u304c\u738b\u9053\u306a\u306e\u3060\u304c\u3001Bitbucket\u304c\u63d0\u4f9b\u3059\u308bREST API\u3092\u547c\u3073\u51fa\u3059\u3060\u3051\u3067\u7c21\u6613\u7684\u306aViewer\u306a\u3089\u5341\u5206\u4f5c\u308c\u305d\u3046\u306a\u306e\u3067\u3001HTML/JS/CSS\u306e\u307f\u3067\u4f5c\u3063\u3066\u3044\u308b\u3002\n\n\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\n\u7d30\u304b\u3044\u30e9\u30a4\u30d6\u30e9\u30ea\u3082\u542b\u3081\u305f\u4f7f\u7528\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u4e0b\u8a18\u306e\u3068\u304a\u308a\u3002\u306a\u304a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5168\u4f53\u306fTypeScript\u3067\u66f8\u3044\u3066\u3044\u308b\u3002\n  \"dependencies\": {\n    \"babel-polyfill\": \"^6.9.0\",\n    \"bulma\": \"0.0.26\",\n    \"font-awesome\": \"^4.6.1\",\n    \"lodash\": \"^4.12.0\",\n    \"react\": \"^15.1.0\",\n    \"react-dom\": \"^15.1.0\",\n    \"react-redux\": \"^4.4.5\",\n    \"react-select\": \"^1.0.0-beta13\",\n    \"react-sidebar\": \"^2.1.2\",\n    \"redux\": \"^3.5.2\",\n    \"redux-saga\": \"^0.10.4\",\n    \"whatwg-fetch\": \"^0.10.1\"\n  }\n\n\n\u975e\u540c\u671f\u51e6\u7406\u306e\u6982\u8981\n\u5b9f\u88c5\u3057\u3066\u3044\u308b\u975e\u540c\u671f\u51e6\u7406\u306e\u5185\u5bb9\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u8aac\u660e\u3057\u3066\u304a\u304f\u3002\nBitbucket\u304c\u63d0\u4f9b\u3059\u308bREST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u4e0b\u8a18\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3001\u6700\u7d42\u7684\u306b\u306f\u30d6\u30e9\u30f3\u30c1\u5358\u4f4d\u3067\u60c5\u5831\u3092\u30c6\u30fc\u30d6\u30eb\u306b\u51fa\u529b\u3057\u3066\u3044\u308b(\u30a4\u30e1\u30fc\u30b8)\u3002\u307e\u305f\u30016\u756a\u306b\u95a2\u3057\u3066\u306fBitbucket\u3067\u306f\u306a\u304fSonarQube\u306eREST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u53d6\u5f97\u3057\u3066\u3044\u308b\u3002\n\nGit\u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\nGit\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u306e\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\nGit\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u306e\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u4e00\u89a7\n\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u7d10\u3065\u304fSonar 4 Bitbucket Server\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u63d0\u4f9b\u3059\u308b\u60c5\u5831\n\u30d6\u30e9\u30f3\u30c1\u306e\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\n\u30d6\u30e9\u30f3\u30c1\u306e\u6700\u65b0\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831 (SonarQube\u306eAPI\u3092\u30b3\u30fc\u30eb)\n\n\u4e0a\u8a18\u306e\u547c\u3073\u51fa\u3057\u306f\u4f9d\u5b58\u95a2\u4fc2\u304c\u3042\u308a\u3001\n\n1 -> 2\n\n\n2 -> 3\n\n\n3 -> 4\n\n\n2 -> 5\n2 -> 6\n\n\n\n\u3068\u3044\u3046\u9806\u756a\u3067\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308b\u3002\u307e\u305f\u5927\u91cf\u306eGit\u30ea\u30dd\u30b8\u30c8\u30ea\u3001\u30d6\u30e9\u30f3\u30c1\u3092\u7ba1\u7406\u3057\u3066\u3044\u308b\u3068\u5927\u91cf\u306e\u30a2\u30af\u30bb\u30b9\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3046\u305f\u3081\u3001Git\u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\u30fb\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u307e\u3067\u306f\u521d\u671f\u8868\u793a\u6642\u306b\u5168\u3066\u53d6\u5f97\u3059\u308b\u304c\u3001\u305d\u306e\u4ed6\u306f\u30da\u30fc\u30b8\u30f3\u30b0\u5236\u5fa1\u3067\u8868\u793a\u3055\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u521d\u3081\u3066\u30d5\u30a7\u30c3\u30c1\u3059\u308b\u3088\u3046\u306b\u5236\u5fa1\u3057\u3066\u3044\u308b\u3002\n(\u305d\u308c\u3067\u3082\u5229\u7528\u3057\u3066\u3044\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\u76f8\u5f53\u6570\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u30fb\u30d6\u30e9\u30f3\u30c1\u304c\u3042\u308a\u3001\u521d\u56de\u8868\u793a\u6642\u306b130\u30ea\u30af\u30a8\u30b9\u30c8\u304f\u3089\u3044\u98db\u3093\u3067\u3057\u307e\u3046\u304c\u3001\u5f85\u3061\u6642\u9593\u306f\u8a31\u5bb9\u3067\u304d\u308b\u7bc4\u56f2)\n\u52a0\u3048\u3066\u30016\u756a\u306eSonarQube\u306eAPI\u30b3\u30fc\u30eb\u306fSonarQube\u306b\u307e\u3060\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u8a8d\u8a3c\u5b8c\u4e86\u3092\u5f85\u3063\u3066\u304b\u3089\u30d5\u30a7\u30c3\u30c1\u3059\u308b\u3088\u3046\u306b\u3082\u5236\u5fa1\u3057\u3066\u3044\u308b(\u8a8d\u8a3c\u306f\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c0\u30eb\u3092\u5225\u9014\u958b\u3044\u3066\u884c\u3046)\u3002\n\u6587\u5b57\u3067\u66f8\u304f\u3068\u5206\u304b\u308a\u306b\u304f\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u306e\u3067\u3001\u3053\u306e\u4e00\u9023\u306eREST API\u30b3\u30fc\u30eb\u306e\u30d5\u30ed\u30fc\u3092\u56f3\u306b\u66f8\u3044\u3066\u307f\u305f\u3002\n\n\u7070\u8272\u306e\u90e8\u5206\u306f\u753b\u9762\u306e\u518d\u63cf\u753b\u3067\u3001\u53d6\u5f97\u3057\u305f\u60c5\u5831\u3092\u8868\u793a\u3059\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306b\u306a\u308b\u3002\u53d6\u5f97\u3067\u304d\u305f\u3082\u306e\u304b\u3089\u3069\u3093\u3069\u3093\u63cf\u753b\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\u96d1\u306b\u518d\u63cf\u753b\u6307\u793a\u3092\u51fa\u3057\u3066\u3082React\u304c\u5dee\u5206\u63cf\u753b\u3057\u3066\u304f\u308c\u308b\u305f\u3081\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u60aa\u3044\u3068\u3044\u3046\u3053\u3068\u306f\u4eca\u306e\u3068\u3053\u308d\u306a\u3044\u3002\n\n\u521d\u671f\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u5b9f\u88c5\nFlux\u306f\u63a1\u7528\u305b\u305a\u3001\u30b7\u30f3\u30d7\u30eb\u306bReact\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u5185\u3067\u30d5\u30a7\u30c3\u30c1\u3057\u3066Promise\u306e\u89e3\u6c7a\u5f8c\u306bsetState\u3092\u3059\u308b\u3001\u3068\u3044\u3046\u65b9\u5f0f\u3067\u3084\u3063\u3066\u3044\u305f\u3002\n\u6700\u521d\u306f\u30b3\u30fc\u30eb\u3059\u308bREST API\u3082\u305f\u3063\u305f2\u7a2e\u985e(Git\u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\u3068\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u306e\u53d6\u5f97)\u3060\u3063\u305f\u306e\u3067\u3001\u3053\u308c\u3067\u5341\u5206\u3060\u3063\u305f\u3002\n\u3057\u304b\u3057\u305d\u306e\u5f8c\u3001\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u60c5\u5831\u3082\u51fa\u3057\u3066\u6b32\u3057\u3044\u3001\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u203b\u3082\u51fa\u3057\u3066\u6b32\u3057\u3044\u3001SonarQube\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831\u3082\u51fa\u3057\u3066\u6b32\u3057\u3044\u3001\u3068\u8981\u671b\u304c\u5897\u3048\u3066\u3044\u304d\u3001Promise\u306e\u51e6\u7406\u3092\u3069\u3093\u3069\u3093\u30cd\u30b9\u30c8\u3055\u305b\u308b\u3053\u3068\u306b\u3001\u3001\u3001\n\u3055\u3089\u306b\u60c5\u5831\u53d6\u5f97\u91cf\u304c\u5897\u3048\u305f\u305f\u3081\u3001\u521d\u671f\u8868\u793a\u6642\u306b\u5168\u3066\u30d5\u30a7\u30c3\u30c1\u3059\u308b\u3068\u304b\u306a\u308a\u5f85\u305f\u3055\u308c\u308b\u3088\u3046\u306b\u3082\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u305d\u3053\u3067\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6539\u5584\u306e\u305f\u3081\u306b\u8868\u793a\u3059\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30d5\u30a7\u30c3\u30c1\u3059\u308b\u3088\u3046\u306a\u9045\u5ef6\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u4ed5\u639b\u3051\u3082\u52a0\u3048\u3066\u3044\u3063\u305f\u304c\u3001\u304b\u306a\u308a\u8907\u96d1\u306a\u5b9f\u88c5\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\n\u203b Bitbucket\u306fJenkins\u306a\u3069\u306e\u30d3\u30eb\u30c9\u30b5\u30fc\u30d0\u3068\u9023\u643a\u3057\u3066\u8a72\u5f53\u30d6\u30e9\u30f3\u30c1\u306e\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\nredux-saga\u3067\u518d\u5b9f\u88c5\n\u57fa\u672c\u7684\u306b\u306f\u5148\u7a0b\u793a\u3057\u305f\u975e\u540c\u671f\u51e6\u7406\u306e\u30d5\u30ed\u30fc\u56f3\u306e\u51e6\u7406\u3092redux-saga\u306etask\u3068\u3057\u3066\u5b9f\u88c5\u3057\u3066\u3044\u3051\u3070\u826f\u3044\u3002\n\u975e\u540c\u671f\u51e6\u7406\u306e\u958b\u59cb\u70b9\u3068\u306a\u308b\u3001pollFetchBranchInfosRequested\u95a2\u6570\u304b\u3089\u3069\u3093\u306a\u98a8\u306b\u5b9f\u88c5\u3057\u305f\u304b\u7d39\u4ecb\u3059\u308b\u3002\u306a\u304a\u3001\u7c21\u7565\u5316\u306e\u305f\u3081\u672c\u8cea\u7684\u3067\u306a\u3044\u7269\u306f\u4e00\u90e8\u51e6\u7406\u3092\u524a\u3063\u3066\u3044\u308b\u3068\u3053\u308d\u3082\u3042\u308b\u306e\u3067\u3001\u5b9f\u969b\u306e\u5b9f\u88c5\u30b3\u30fc\u30c9\u306f\u30bd\u30fc\u30b9\u3092\u53c2\u7167\u306e\u3053\u3068\u3002\n\u3053\u306e\u8d77\u70b9\u3068\u306a\u308b\u30bf\u30b9\u30af\u3067\u306fFETCH_BRANCH_INFOS_REQUESTED \u30a2\u30af\u30b7\u30e7\u30f3\u304c\u3069\u3053\u304b\u3067\u767a\u884c\u3055\u308c\u305f\u3089\u51e6\u7406\u3092\u958b\u59cb\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b (\u30a2\u30af\u30b7\u30e7\u30f3\u306f\u521d\u671f\u8868\u793a\u6642\u3068\u30ea\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\u306b\u767a\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b)\u3002\nGit\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u305f\u3089\u3001\u305d\u306e\u7d50\u679c\u3092\u5225\u306e\u30bf\u30b9\u30af\u306b\u6e21\u3057\u3066\u5b8c\u4e86\u3092\u5f85\u3064\u3060\u3051\u3002\u306a\u304a\u3001join\u3092\u4f7f\u3044\u5b50\u30bf\u30b9\u30af\u306e\u5b8c\u4e86\u3092\u5f85\u3063\u3066\u3044\u308b\u306e\u306f\u3001\u5168\u30d6\u30e9\u30f3\u30c1\u306e\u53d6\u5f97\u3092\u5b8c\u4e86\u3059\u308b\u307e\u3067\u306b\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30a4\u30b3\u30f3\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u3002api.fetchAllRepos\u306fPromise\u3092\u8fd4\u3059\u95a2\u6570\u3060\u304c\u3001Async/Await\u306e\u3088\u3046\u306b\u540c\u671f\u51e6\u7406\u7684\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u3002\nfunction* pollFetchBranchInfosRequested(action: actions.FetchBranchInfosAction): Iterable<Effect> {\n    while (true) {\n        // \u30a2\u30af\u30b7\u30e7\u30f3\u767a\u884c\u307e\u3067\u5f85\u3064\n        yield take(actions.FETCH_BRANCH_INFOS_REQUESTED);\n\n        // \u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\u306e\u53d6\u5f97\n        const repos: API.Repo[] = yield call([api, api.fetchAllRepos]);\n\n        // \u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\u304b\u3089\u30d6\u30e9\u30f3\u30c1\u3092\u53d6\u5f97\u3059\u308b\u30bf\u30b9\u30af\u3092fork\u3059\u308b\n        const task = yield fork(handleFetchBranchInfoAll, repos);\n\n        // \u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u53d6\u5f97\u306e\u5b8c\u4e86\u307e\u3067\u5f85\u3064 (\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30a4\u30b3\u30f3\u8868\u793a\u5236\u5fa1\u305f\u3081)\n        yield join(task);\n\n        // \u5b8c\u4e86\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u767a\u884c (\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30a4\u30b3\u30f3\u3092\u975e\u8868\u793a\u306b\u3059\u308b)\n        yield put(<actions.FetchBranchInfosAction>{\n            type: actions.FETCH_BRANCH_INFOS_SUCCEEDED\n        });\n    }\n}\n\n\u6b21\u306ffork\u3055\u308c\u305f\u5b50\u30bf\u30b9\u30af\u306e\u5185\u5bb9\u3002Git\u30ea\u30dd\u30b8\u30c8\u30ea\u6bce\u306b\u30d1\u30e9\u30ec\u30eb\u306b\u30d5\u30a7\u30c3\u30c1\u3055\u305b\u308b\u305f\u3081\u306b\u3053\u3053\u3067\u306f\u30eb\u30fc\u30d7\u3067\u56de\u3057\u3066\u3055\u3089\u306b\u5b50\u30bf\u30b9\u30af\u3092fork\u3059\u308b\u3060\u3051\u3068\u3057\u3066\u3044\u308b\u3002\nfunction* handleFetchBranchInfoAll(repos: API.Repo[]): Iterable<Effect> {\n    for (let i = 0; i < repos.length; i++) {\n        const repo = repos[i];\n        yield fork(handleFetchBranchInfosPerRepo, api, repo);\n    }\n}\n\n\u305d\u306e\u5b50\u30bf\u30b9\u30af\u3067\u306f\u3001\u30d6\u30e9\u30f3\u30c1\u60c5\u5831\u3092\u53d6\u5f97\u3057\u518d\u63cf\u753b\u3092\u6307\u793a(APPEND_BRANCH_INFOS \u30a2\u30af\u30b7\u30e7\u30f3\u306e\u767a\u884c)\u3057\u3001\u305d\u306e\u5f8c\u306f\u3053\u306e\u30d6\u30e9\u30f3\u30c1\u306b\u7d10\u3065\u304f\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u60c5\u5831\u3001\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3001SonarQube\u30e1\u30c8\u30ea\u30af\u30b9\u53d6\u5f97\u306e\u51e6\u7406\u30bf\u30b9\u30af\u3092\u8d77\u52d5\u3057\u3066\u3044\u308b\u3002\n\u30dd\u30a4\u30f3\u30c8\u306f\u3053\u3053\u3067\u306fspawn\u3092\u4f7f\u3063\u3066\u3044\u308b\u3068\u3053\u308d\u3002fork\u306b\u3057\u3066\u3057\u307e\u3046\u3068\u3001\u5168\u3066\u306e\u5b50\u30bf\u30b9\u30af\u306e\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u306a\u3044\u3068\u672c\u30bf\u30b9\u30af\u304c\u5b8c\u4e86\u3068\u306a\u3089\u306a\u3044\u3002\u305d\u3046\u3059\u308b\u3068\u89aa\u306e\u65b9\u3067join\u3067\u5f85\u3063\u3066\u3044\u305f\u7b87\u6240\u3067\u6b62\u307e\u3063\u305f\u307e\u307e\u3068\u306a\u308a\u3001\u305a\u3063\u3068\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30a4\u30b3\u30f3\u304c\u51fa\u7d9a\u3051\u3066\u3057\u307e\u3046\u3002\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u60c5\u5831\u3001\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3001SonarQube\u30e1\u30c8\u30ea\u30af\u30b9\u306f\u753b\u9762\u8868\u793a\u3067\u5fc5\u8981\u306b\u306a\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u9045\u5ef6\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u3068\u3055\u305b\u305f\u3044\u305f\u3081\u3001\u89aa\u3068\u306f\u5207\u308a\u96e2\u3055\u308c\u305f\u30bf\u30b9\u30af\u3068\u3057\u3066\u5b9f\u884c\u3055\u305b\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u305d\u3046\u3044\u3046\u3068\u304d\u306fspawn\u3092\u4f7f\u3048\u3070\u826f\u3044\u3002\nfunction* handleFetchBranchInfosPerRepo(api: API.API, repo: API.Repo): Iterable<Effect> {\n    // \u3053\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u306e\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u3092\u53d6\u5f97\n    const branchInfos: API.BranchInfo[] = yield call([api, api.fetchBranchInfo], repo);\n\n    // \u518d\u63cf\u753b\u6307\u793a\n    yield put(<actions.AppendBranchInfosAction>{\n        type: actions.APPEND_BRANCH_INFOS,\n        payload: {\n            branchInfos\n        }\n    });\n\n    // \u9045\u5ef6\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u51e6\u7406\u306f\u5206\u96e2\u3055\u308c\u305f\u30bf\u30b9\u30af\u3068\u3057\u3066\u5b9f\u884c\u3059\u308b\n    if (branchInfos.length > 0) {\n        // \u30ea\u30dd\u30b8\u30c8\u30ea\u5358\u4f4d\u306e\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n        yield spawn(handleFetchPullRequestCount, branchInfos);\n\n        // \u30d6\u30e9\u30f3\u30c1\u5358\u4f4d\u306e\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n        for (let i = 0; i < branchInfos.length; i++) {\n            yield spawn(handleBuildStatus, branchInfos[i]);\n            yield spawn(handleSonarQubeMetrics, branchInfos[i]);\n        }\n    }\n}\n\n\u524d\u8ff0\u306e\u901a\u308a\u3001\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u60c5\u5831\u3001\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3001SonarQube\u30e1\u30c8\u30ea\u30af\u30b9\u53d6\u5f97\u306e\u51e6\u7406\u306f\u753b\u9762\u8868\u793a\u3067\u5fc5\u8981\u306b\u306a\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u884c\u3046\u3088\u3046\u306b\u3059\u308b\u3002\u5177\u4f53\u7684\u306b\u306f\u3001\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u306e\u30c6\u30fc\u30d6\u30eb\u8868\u793a\u306b\u304a\u3044\u3066\u3001\u30da\u30fc\u30b8\u30f3\u30b0\u3067\u8868\u793a\u5bfe\u8c61\u306b\u306a\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u521d\u3081\u3066\u30d5\u30a7\u30c3\u30c1\u3092\u884c\u3046\u3088\u3046\u306b\u3059\u308b\u3002\n\u3053\u308c\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306b\u3001SHOW_BRANCH_INFO_DETAILS_REQUESTED:(\u5bfe\u8c61\u30ec\u30fc\u30d6\u30eb\u884c\u30c7\u30fc\u30bf\u306e\u30e6\u30cb\u30fc\u30afid)\u30a2\u30af\u30b7\u30e7\u30f3\u304c\u767a\u884c\u3055\u308c\u308b\u307e\u3067\u5f85\u3064\u3088\u3046\u306b\u3057\u305f\u3002\u5225\u9014\u30c6\u30fc\u30d6\u30eb\u8868\u793a\u3092\u884c\u3046React\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u65b9\u304b\u3089\u3001\u8868\u793a\u5bfe\u8c61\u3068\u306a\u3063\u305f\u884c\u30c7\u30fc\u30bf\u306e\u30e6\u30cb\u30fc\u30afid\u3092\u30ad\u30fc\u306b\u3057\u3066\u3053\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u767a\u884c\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\n\u4f8b\u3068\u3057\u3066\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u306e\u51e6\u7406\u30bf\u30b9\u30af\u306e\u30b3\u30fc\u30c9\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3002\u9045\u5ef6\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u304b\u3057\u306a\u3044\u304b\u306f\u3001\u3053\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306etake\u306b\u3088\u308b\u5f85\u3061\u3060\u3051\u3067\u6c7a\u307e\u3063\u3066\u304a\u308a\u304b\u306a\u308a\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u3063\u305f\u3002\nfunction* handleBuildStatus(branchInfo: API.BranchInfo): Iterable<Effect> {\n    const { id, latestCommitHash } = branchInfo;\n\n    // \u30da\u30fc\u30b8\u30f3\u30b0\u3067\u8868\u793a\u5bfe\u8c61\u306b\u306a\u308b\u307e\u3067\u3053\u3053\u3067\u5f85\u3064\n    yield take(`${actions.SHOW_BRANCH_INFO_DETAILS_REQUESTED}:${id}`);\n\n    // \u8868\u793a\u5bfe\u8c61\u306b\u306a\u3063\u305f\u3089REST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u53d6\u5f97\n    const buildStatus = yield call([api, api.fetchBuildStatus], latestCommitHash);\n\n    // \u518d\u63cf\u753b\u6307\u793a\n    yield put(<actions.UpdateBranchInfoAction>{\n        type: actions.UPDATE_BRANCH_INFO,\n        payload: {\n            branchInfo: {\n                id,\n                buildStatus\n            }\n        }\n    });\n}\n\n\u306a\u304a\u3001\u6700\u521d\u306fSHOW_BRANCH_INFO_DETAILS_REQUESTED \u3068\u3044\u3046\u5171\u901a\u30a2\u30af\u30b7\u30e7\u30f3\u3067take\u3057\u3066\u3001\u305d\u306epayload\u306b\u3042\u308bid\u3067\u81ea\u5206\u304c\u5bfe\u8c61\u304b\u3069\u3046\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3068\u3044\u3046\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u66f8\u3044\u3066\u3044\u305f\u3002\u3057\u304b\u3057\u3053\u308c\u3060\u3068\u5927\u91cf\u306e\u30d6\u30e9\u30f3\u30c1\u304c\u3042\u308b\u5834\u5408\u306b\u6027\u80fd\u306b\u5927\u304d\u306a\u5f71\u97ff\u304c\u51fa\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u6b62\u3081\u305f(\u7279\u306bIE\u304c\u3072\u3069\u304f\u9045\u304f\u306a\u3063\u305f)\u3002\u30da\u30fc\u30b8\u30f3\u30b0\u306e\u305f\u3073\u306b\u5f85\u3063\u3066\u3044\u308b\u5168\u30bf\u30b9\u30af\u304c\u7121\u99c4\u306b\u52d5\u3044\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u983b\u5ea6\u3001\u5f85\u3061\u72b6\u614b\u306e\u30bf\u30b9\u30af\u304c\u591a\u3044\u5834\u5408\u306f\u3067\u304d\u308b\u3060\u3051\u7121\u99c4\u306b\u53cd\u5fdc\u3057\u306a\u3044\u3088\u3046\u306b\u6c17\u3092\u3064\u3051\u3066\u5b9f\u88c5\u3057\u305f\u65b9\u304c\u3088\u3055\u305d\u3046\u3067\u3042\u308b\u3002\n    while (true) {\n        const action = yield take(`${actions.SHOW_BRANCH_INFO_DETAILS_REQUESTED}`);\n        if (action.payload.id === id) {\n            break;\n        }\n    }\n\n\u3082\u3046\u4e00\u3064\u3001spawn\u3067\u8d77\u52d5\u3057\u305fSonarQube\u30e1\u30c8\u30ea\u30af\u30b9\u53d6\u5f97\u306e\u51e6\u7406\u30bf\u30b9\u30af\u3082\u7d39\u4ecb\u3002\u3053\u3061\u3089\u306f\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3088\u308a\u8907\u96d1\u306b\u306a\u3063\u3066\u3044\u308b\u3002SonarQube\u306eREST API\u306fBitbucket\u3068\u306f\u5225\u306e\u30b5\u30fc\u30d0\u306e\u305f\u3081\u3001\u8a8d\u8a3c\u51e6\u7406\u304c\u5225\u9014\u5fc5\u8981\u306b\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\u65e2\u306b\u8a8d\u8a3c\u6e08\u307f\u3067\u3042\u308c\u3070\u305d\u306e\u307e\u307eREST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u826f\u3044\u304c\u3001\u672a\u8a8d\u8a3c\u306e\u5834\u5408\u306f\u30e6\u30fc\u30b6\u306b\u3088\u308b\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u5b8c\u4e86\u3092\u5f85\u3064\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u3068\u3044\u3063\u3066\u3082redux-saga\u3060\u3068\u5b9f\u88c5\u306f\u7c21\u5358\u3067\u3001\u540c\u3058\u3088\u3046\u306btake\u3067\u8a8d\u8a3c\u5b8c\u4e86\u307e\u3067\u5f85\u3064\u3088\u3046\u306b\u3059\u308b\u3060\u3051\u3067\u826f\u3044\u3002\u306a\u304a\u3001updateSonarQubeMetrics\u95a2\u6570\u306f\u518d\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u5207\u308a\u51fa\u3057\u305f\u3060\u3051\u3067\u3042\u308b\u3002\nfunction* handleSonarQubeMetrics(branchInfo: API.BranchInfo): Iterable<Effect> {\n    const { id } = branchInfo;\n\n    // \u30da\u30fc\u30b8\u30f3\u30b0\u3067\u8868\u793a\u5bfe\u8c61\u306b\u306a\u308b\u307e\u3067\u3053\u3053\u3067\u5f85\u3064\n    yield take(`${actions.SHOW_BRANCH_INFO_DETAILS_REQUESTED}:${id}`);\n\n    // SonarQube\u3078\u306e\u8a8d\u8a3c\u72b6\u614b\u3092State\u304b\u3089\u53d6\u5f97\n    const sonarQubeAuthenticated: boolean = yield select((state: RootState) => state.app.sonarQubeAuthenticated);\n\n    if (sonarQubeAuthenticated) {\n        // \u8a8d\u8a3c\u6e08\u307f\u3067\u3042\u308c\u3070SonarQube\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831\u53d6\u5f97\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n        yield fork(updateSonarQubeMetrics, branchInfo);\n\n    } else {\n        // \u672a\u8a8d\u8a3c\u3067\u3042\u308c\u3070\u3001\u8a8d\u8a3c\u3055\u308c\u308b\u307e\u3067\u5f85\u3064\n        yield take(actions.SONARQUBE_AUTHENTICATED);\n\n        // \u8a8d\u8a3c\u3055\u308c\u305f\u5f8c\u306bSonarQube\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831\u53d6\u5f97\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n        yield fork(updateSonarQubeMetrics, branchInfo);\n    }\n}\n\nfunction* updateSonarQubeMetrics(branchInfo: API.BranchInfo) {\n    const { id, repo, branch } = branchInfo;\n\n    // SonarQube\u306eREST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n    const sonarQubeMetrics: API.SonarQubeMetrics = yield call([api, api.fetchSonarQubeMetricsByKey], repo, branch);\n\n    // \u518d\u63cf\u753b\u6307\u793a\n    yield put(<actions.UpdateBranchInfoAction>{\n        type: actions.UPDATE_BRANCH_INFO,\n        payload: {\n            branchInfo: {\n                id,\n                sonarQubeMetrics\n            }\n        }\n    });\n}\n\n\n\u6240\u611f\n\u4eca\u56de\u30c6\u30b9\u30c8\u306f\u4e00\u5207\u66f8\u3044\u3066\u3044\u306a\u3044\u306e\u3067\u3001redux-saga\u306e\u30e1\u30ea\u30c3\u30c8\u3092\u6d3b\u304b\u3057\u304d\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306e\u203b\u3001redux-saga\u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406\u5236\u5fa1\u306f\u4eca\u56de\u306e\u3084\u308a\u305f\u3044\u3053\u3068\u306b\u30de\u30c3\u30c1\u3057\u3066\u3044\u308b\u3068\u601d\u3063\u305f\u3002\u5168\u3066\u306e\u51e6\u7406\u3092\u30d5\u30e9\u30c3\u30c8\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u4e0a\u304b\u3089\u9806\u306b\u8aad\u3093\u3067\u3044\u304f\u3060\u3051\u3067\u51e6\u7406\u3092\u8ffd\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u3001\u30b3\u30fc\u30c9\u306e\u898b\u901a\u3057\u304c\u304b\u306a\u308a\u826f\u304f\u306a\u3063\u305f\u3068\u601d\u3046\u3002\n\u307e\u305f\u3001\u4eca\u5f8c\u306e\u8ffd\u52a0\u8981\u671b\u3067Bitbucket\u304b\u3089\u306e\u53d6\u5f97\u60c5\u5831\u304c\u5897\u3048\u305f\u3068\u3057\u3066\u3082\u3001\u65b0\u305f\u306b\u30bf\u30b9\u30af\u3092\u5b9a\u7fa9\u3057\u3066fork or spawn\u3059\u308b\u3060\u3051\u3067\u5bb9\u6613\u306b\u8ffd\u52a0\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3082\u306a\u3063\u305f\u306e\u3082\u826f\u3044\u3002\n\u203b redux-saga\u3060\u3068\u975e\u540c\u671f\u51e6\u7406\u3092\u30e2\u30c3\u30af\u306a\u3057\u3067\u30b7\u30f3\u30d7\u30eb\u306b\u30c6\u30b9\u30c8\u304c\u3067\u304d\u308b\u3002\u8a73\u3057\u304f\u306f@kuy \u6c0f\u306eredux-saga\u3067\u975e\u540c\u671f\u51e6\u7406\u3068\u6226\u3046\u3092\u53c2\u7167\u306e\u3053\u3068\u3002\n# \u306f\u3058\u3081\u306b\n[Bitbucket Browser](https://github.com/wadahiro/bitbucket-browser)\u3068\u3044\u3046[Bitbucket Server](https://bitbucket.org/product/server)\u306eViewer\u3092React\u3067\u4f5c\u3063\u3066\u3044\u3066\u3001\u6a5f\u80fd\u8ffd\u52a0\u306b\u4f34\u3044\u975e\u540c\u671f\u51e6\u7406\u90e8\u5206\u304c\u3060\u3093\u3060\u3093\u8f9b\u304f\u306a\u3063\u3066\u304d\u305f\u306e\u3067\u3001\u52c9\u5f37\u3082\u517c\u306d\u3066[redux-saga](https://github.com/yelouafi/redux-saga)\u3092\u4f7f\u3063\u3066\u307f\u305f\u3089\u3069\u3046\u6539\u5584\u3055\u308c\u308b\u306e\u304b\u8a66\u3057\u3066\u307f\u305f\u3002\n\n\u306a\u304a\u3001Bitbucket\u306b\u306f\u30d7\u30e9\u30b0\u30a4\u30f3\u6a5f\u69cb\u304c\u3042\u308b\u306e\u3067\u30d7\u30e9\u30b0\u30a4\u30f3\u3068\u3057\u3066\u5b9f\u88c5\u3059\u308b\u306e\u304c\u738b\u9053\u306a\u306e\u3060\u304c\u3001Bitbucket\u304c\u63d0\u4f9b\u3059\u308bREST API\u3092\u547c\u3073\u51fa\u3059\u3060\u3051\u3067\u7c21\u6613\u7684\u306aViewer\u306a\u3089\u5341\u5206\u4f5c\u308c\u305d\u3046\u306a\u306e\u3067\u3001HTML/JS/CSS\u306e\u307f\u3067\u4f5c\u3063\u3066\u3044\u308b\u3002\n\n# \u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\n\u7d30\u304b\u3044\u30e9\u30a4\u30d6\u30e9\u30ea\u3082\u542b\u3081\u305f\u4f7f\u7528\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u4e0b\u8a18\u306e\u3068\u304a\u308a\u3002\u306a\u304a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5168\u4f53\u306fTypeScript\u3067\u66f8\u3044\u3066\u3044\u308b\u3002\n\n```json\n  \"dependencies\": {\n    \"babel-polyfill\": \"^6.9.0\",\n    \"bulma\": \"0.0.26\",\n    \"font-awesome\": \"^4.6.1\",\n    \"lodash\": \"^4.12.0\",\n    \"react\": \"^15.1.0\",\n    \"react-dom\": \"^15.1.0\",\n    \"react-redux\": \"^4.4.5\",\n    \"react-select\": \"^1.0.0-beta13\",\n    \"react-sidebar\": \"^2.1.2\",\n    \"redux\": \"^3.5.2\",\n    \"redux-saga\": \"^0.10.4\",\n    \"whatwg-fetch\": \"^0.10.1\"\n  }\n```\n\n# \u975e\u540c\u671f\u51e6\u7406\u306e\u6982\u8981\n\u5b9f\u88c5\u3057\u3066\u3044\u308b\u975e\u540c\u671f\u51e6\u7406\u306e\u5185\u5bb9\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u8aac\u660e\u3057\u3066\u304a\u304f\u3002\nBitbucket\u304c\u63d0\u4f9b\u3059\u308bREST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u4e0b\u8a18\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3001\u6700\u7d42\u7684\u306b\u306f\u30d6\u30e9\u30f3\u30c1\u5358\u4f4d\u3067\u60c5\u5831\u3092\u30c6\u30fc\u30d6\u30eb\u306b\u51fa\u529b\u3057\u3066\u3044\u308b([\u30a4\u30e1\u30fc\u30b8](https://raw.githubusercontent.com/wadahiro/bitbucket-browser/master/images/browser.png))\u3002\u307e\u305f\u30016\u756a\u306b\u95a2\u3057\u3066\u306fBitbucket\u3067\u306f\u306a\u304f[SonarQube](http://www.sonarqube.org/)\u306eREST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u53d6\u5f97\u3057\u3066\u3044\u308b\u3002\n\n1. Git\u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\n2. Git\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u306e\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\n3. Git\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u306e\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u4e00\u89a7\n4. \u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u7d10\u3065\u304f[Sonar 4 Bitbucket Server\u30d7\u30e9\u30b0\u30a4\u30f3](https://marketplace.atlassian.com/plugins/ch.mibex.stash.sonar4stash/server/overview)\u304c\u63d0\u4f9b\u3059\u308b\u60c5\u5831\n5. \u30d6\u30e9\u30f3\u30c1\u306e\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\n6. \u30d6\u30e9\u30f3\u30c1\u306e\u6700\u65b0\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831 (SonarQube\u306eAPI\u3092\u30b3\u30fc\u30eb)\n\n\u4e0a\u8a18\u306e\u547c\u3073\u51fa\u3057\u306f\u4f9d\u5b58\u95a2\u4fc2\u304c\u3042\u308a\u3001\n\n* 1 -> 2\n    * 2 -> 3\n        * 3 -> 4\n    * 2 -> 5\n    * 2 -> 6\n\n\u3068\u3044\u3046\u9806\u756a\u3067\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u308b\u3002\u307e\u305f\u5927\u91cf\u306eGit\u30ea\u30dd\u30b8\u30c8\u30ea\u3001\u30d6\u30e9\u30f3\u30c1\u3092\u7ba1\u7406\u3057\u3066\u3044\u308b\u3068\u5927\u91cf\u306e\u30a2\u30af\u30bb\u30b9\u304c\u767a\u751f\u3057\u3066\u3057\u307e\u3046\u305f\u3081\u3001Git\u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\u30fb\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u307e\u3067\u306f\u521d\u671f\u8868\u793a\u6642\u306b\u5168\u3066\u53d6\u5f97\u3059\u308b\u304c\u3001\u305d\u306e\u4ed6\u306f\u30da\u30fc\u30b8\u30f3\u30b0\u5236\u5fa1\u3067\u8868\u793a\u3055\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u521d\u3081\u3066\u30d5\u30a7\u30c3\u30c1\u3059\u308b\u3088\u3046\u306b\u5236\u5fa1\u3057\u3066\u3044\u308b\u3002\n(\u305d\u308c\u3067\u3082\u5229\u7528\u3057\u3066\u3044\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\u76f8\u5f53\u6570\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u30fb\u30d6\u30e9\u30f3\u30c1\u304c\u3042\u308a\u3001\u521d\u56de\u8868\u793a\u6642\u306b130\u30ea\u30af\u30a8\u30b9\u30c8\u304f\u3089\u3044\u98db\u3093\u3067\u3057\u307e\u3046\u304c\u3001\u5f85\u3061\u6642\u9593\u306f\u8a31\u5bb9\u3067\u304d\u308b\u7bc4\u56f2)\n\n\u52a0\u3048\u3066\u30016\u756a\u306eSonarQube\u306eAPI\u30b3\u30fc\u30eb\u306fSonarQube\u306b\u307e\u3060\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u8a8d\u8a3c\u5b8c\u4e86\u3092\u5f85\u3063\u3066\u304b\u3089\u30d5\u30a7\u30c3\u30c1\u3059\u308b\u3088\u3046\u306b\u3082\u5236\u5fa1\u3057\u3066\u3044\u308b(\u8a8d\u8a3c\u306f\u30ed\u30b0\u30a4\u30f3\u30e2\u30fc\u30c0\u30eb\u3092\u5225\u9014\u958b\u3044\u3066\u884c\u3046)\u3002\n\n\u6587\u5b57\u3067\u66f8\u304f\u3068\u5206\u304b\u308a\u306b\u304f\u3044\u304b\u3082\u3057\u308c\u306a\u3044\u306e\u3067\u3001\u3053\u306e\u4e00\u9023\u306eREST API\u30b3\u30fc\u30eb\u306e\u30d5\u30ed\u30fc\u3092\u56f3\u306b\u66f8\u3044\u3066\u307f\u305f\u3002\n\n![bitbucket-browser-sequence.png](https://qiita-image-store.s3.amazonaws.com/0/35233/dc1ca0e7-47a4-357e-a83f-b61e35f3a132.png)\n\n\n\u7070\u8272\u306e\u90e8\u5206\u306f\u753b\u9762\u306e\u518d\u63cf\u753b\u3067\u3001\u53d6\u5f97\u3057\u305f\u60c5\u5831\u3092\u8868\u793a\u3059\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u306b\u306a\u308b\u3002\u53d6\u5f97\u3067\u304d\u305f\u3082\u306e\u304b\u3089\u3069\u3093\u3069\u3093\u63cf\u753b\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\u96d1\u306b\u518d\u63cf\u753b\u6307\u793a\u3092\u51fa\u3057\u3066\u3082React\u304c\u5dee\u5206\u63cf\u753b\u3057\u3066\u304f\u308c\u308b\u305f\u3081\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u60aa\u3044\u3068\u3044\u3046\u3053\u3068\u306f\u4eca\u306e\u3068\u3053\u308d\u306a\u3044\u3002\n\n\n# \u521d\u671f\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u5b9f\u88c5\nFlux\u306f\u63a1\u7528\u305b\u305a\u3001\u30b7\u30f3\u30d7\u30eb\u306bReact\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u5185\u3067\u30d5\u30a7\u30c3\u30c1\u3057\u3066Promise\u306e\u89e3\u6c7a\u5f8c\u306b`setState`\u3092\u3059\u308b\u3001\u3068\u3044\u3046\u65b9\u5f0f\u3067\u3084\u3063\u3066\u3044\u305f\u3002\n\u6700\u521d\u306f\u30b3\u30fc\u30eb\u3059\u308bREST API\u3082\u305f\u3063\u305f2\u7a2e\u985e(Git\u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\u3068\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u306e\u53d6\u5f97)\u3060\u3063\u305f\u306e\u3067\u3001\u3053\u308c\u3067\u5341\u5206\u3060\u3063\u305f\u3002\n\n\u3057\u304b\u3057\u305d\u306e\u5f8c\u3001\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u60c5\u5831\u3082\u51fa\u3057\u3066\u6b32\u3057\u3044\u3001\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u203b\u3082\u51fa\u3057\u3066\u6b32\u3057\u3044\u3001SonarQube\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831\u3082\u51fa\u3057\u3066\u6b32\u3057\u3044\u3001\u3068\u8981\u671b\u304c\u5897\u3048\u3066\u3044\u304d\u3001Promise\u306e\u51e6\u7406\u3092\u3069\u3093\u3069\u3093\u30cd\u30b9\u30c8\u3055\u305b\u308b\u3053\u3068\u306b\u3001\u3001\u3001\n\u3055\u3089\u306b\u60c5\u5831\u53d6\u5f97\u91cf\u304c\u5897\u3048\u305f\u305f\u3081\u3001\u521d\u671f\u8868\u793a\u6642\u306b\u5168\u3066\u30d5\u30a7\u30c3\u30c1\u3059\u308b\u3068\u304b\u306a\u308a\u5f85\u305f\u3055\u308c\u308b\u3088\u3046\u306b\u3082\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u305d\u3053\u3067\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6539\u5584\u306e\u305f\u3081\u306b\u8868\u793a\u3059\u308b\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30d5\u30a7\u30c3\u30c1\u3059\u308b\u3088\u3046\u306a\u9045\u5ef6\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u306e\u4ed5\u639b\u3051\u3082\u52a0\u3048\u3066\u3044\u3063\u305f\u304c\u3001\u304b\u306a\u308a\u8907\u96d1\u306a\u5b9f\u88c5\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\n\n\u203b Bitbucket\u306fJenkins\u306a\u3069\u306e\u30d3\u30eb\u30c9\u30b5\u30fc\u30d0\u3068\u9023\u643a\u3057\u3066\u8a72\u5f53\u30d6\u30e9\u30f3\u30c1\u306e\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u53d6\u5f97\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n# redux-saga\u3067\u518d\u5b9f\u88c5\n\u57fa\u672c\u7684\u306b\u306f\u5148\u7a0b\u793a\u3057\u305f\u975e\u540c\u671f\u51e6\u7406\u306e\u30d5\u30ed\u30fc\u56f3\u306e\u51e6\u7406\u3092redux-saga\u306etask\u3068\u3057\u3066\u5b9f\u88c5\u3057\u3066\u3044\u3051\u3070\u826f\u3044\u3002\n\u975e\u540c\u671f\u51e6\u7406\u306e\u958b\u59cb\u70b9\u3068\u306a\u308b\u3001`pollFetchBranchInfosRequested`\u95a2\u6570\u304b\u3089\u3069\u3093\u306a\u98a8\u306b\u5b9f\u88c5\u3057\u305f\u304b\u7d39\u4ecb\u3059\u308b\u3002\u306a\u304a\u3001\u7c21\u7565\u5316\u306e\u305f\u3081\u672c\u8cea\u7684\u3067\u306a\u3044\u7269\u306f\u4e00\u90e8\u51e6\u7406\u3092\u524a\u3063\u3066\u3044\u308b\u3068\u3053\u308d\u3082\u3042\u308b\u306e\u3067\u3001\u5b9f\u969b\u306e\u5b9f\u88c5\u30b3\u30fc\u30c9\u306f[\u30bd\u30fc\u30b9](https://github.com/wadahiro/bitbucket-browser/blob/master/src/script/sagas/index.ts)\u3092\u53c2\u7167\u306e\u3053\u3068\u3002\n\n\u3053\u306e\u8d77\u70b9\u3068\u306a\u308b\u30bf\u30b9\u30af\u3067\u306f`FETCH_BRANCH_INFOS_REQUESTED` \u30a2\u30af\u30b7\u30e7\u30f3\u304c\u3069\u3053\u304b\u3067\u767a\u884c\u3055\u308c\u305f\u3089\u51e6\u7406\u3092\u958b\u59cb\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b (\u30a2\u30af\u30b7\u30e7\u30f3\u306f\u521d\u671f\u8868\u793a\u6642\u3068\u30ea\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\u306b\u767a\u884c\u3055\u308c\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b)\u3002\nGit\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u305f\u3089\u3001\u305d\u306e\u7d50\u679c\u3092\u5225\u306e\u30bf\u30b9\u30af\u306b\u6e21\u3057\u3066\u5b8c\u4e86\u3092\u5f85\u3064\u3060\u3051\u3002\u306a\u304a\u3001`join`\u3092\u4f7f\u3044\u5b50\u30bf\u30b9\u30af\u306e\u5b8c\u4e86\u3092\u5f85\u3063\u3066\u3044\u308b\u306e\u306f\u3001\u5168\u30d6\u30e9\u30f3\u30c1\u306e\u53d6\u5f97\u3092\u5b8c\u4e86\u3059\u308b\u307e\u3067\u306b\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30a4\u30b3\u30f3\u3092\u8868\u793a\u3059\u308b\u305f\u3081\u3002`api.fetchAllRepos`\u306fPromise\u3092\u8fd4\u3059\u95a2\u6570\u3060\u304c\u3001Async/Await\u306e\u3088\u3046\u306b\u540c\u671f\u51e6\u7406\u7684\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n```ts\nfunction* pollFetchBranchInfosRequested(action: actions.FetchBranchInfosAction): Iterable<Effect> {\n    while (true) {\n        // \u30a2\u30af\u30b7\u30e7\u30f3\u767a\u884c\u307e\u3067\u5f85\u3064\n        yield take(actions.FETCH_BRANCH_INFOS_REQUESTED);\n        \n        // \u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\u306e\u53d6\u5f97\n        const repos: API.Repo[] = yield call([api, api.fetchAllRepos]);\n        \n        // \u30ea\u30dd\u30b8\u30c8\u30ea\u4e00\u89a7\u304b\u3089\u30d6\u30e9\u30f3\u30c1\u3092\u53d6\u5f97\u3059\u308b\u30bf\u30b9\u30af\u3092fork\u3059\u308b\n        const task = yield fork(handleFetchBranchInfoAll, repos);\n\n        // \u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u53d6\u5f97\u306e\u5b8c\u4e86\u307e\u3067\u5f85\u3064 (\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30a4\u30b3\u30f3\u8868\u793a\u5236\u5fa1\u305f\u3081)\n        yield join(task);\n\n        // \u5b8c\u4e86\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u767a\u884c (\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30a4\u30b3\u30f3\u3092\u975e\u8868\u793a\u306b\u3059\u308b)\n        yield put(<actions.FetchBranchInfosAction>{\n            type: actions.FETCH_BRANCH_INFOS_SUCCEEDED\n        });\n    }\n}\n```\n\n\u6b21\u306f`fork`\u3055\u308c\u305f\u5b50\u30bf\u30b9\u30af\u306e\u5185\u5bb9\u3002Git\u30ea\u30dd\u30b8\u30c8\u30ea\u6bce\u306b\u30d1\u30e9\u30ec\u30eb\u306b\u30d5\u30a7\u30c3\u30c1\u3055\u305b\u308b\u305f\u3081\u306b\u3053\u3053\u3067\u306f\u30eb\u30fc\u30d7\u3067\u56de\u3057\u3066\u3055\u3089\u306b\u5b50\u30bf\u30b9\u30af\u3092`fork`\u3059\u308b\u3060\u3051\u3068\u3057\u3066\u3044\u308b\u3002\n\n```ts\nfunction* handleFetchBranchInfoAll(repos: API.Repo[]): Iterable<Effect> {\n    for (let i = 0; i < repos.length; i++) {\n        const repo = repos[i];\n        yield fork(handleFetchBranchInfosPerRepo, api, repo);\n    }\n}\n```\n\n\u305d\u306e\u5b50\u30bf\u30b9\u30af\u3067\u306f\u3001\u30d6\u30e9\u30f3\u30c1\u60c5\u5831\u3092\u53d6\u5f97\u3057\u518d\u63cf\u753b\u3092\u6307\u793a(`APPEND_BRANCH_INFOS` \u30a2\u30af\u30b7\u30e7\u30f3\u306e\u767a\u884c)\u3057\u3001\u305d\u306e\u5f8c\u306f\u3053\u306e\u30d6\u30e9\u30f3\u30c1\u306b\u7d10\u3065\u304f\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u60c5\u5831\u3001\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3001SonarQube\u30e1\u30c8\u30ea\u30af\u30b9\u53d6\u5f97\u306e\u51e6\u7406\u30bf\u30b9\u30af\u3092\u8d77\u52d5\u3057\u3066\u3044\u308b\u3002\n\n\u30dd\u30a4\u30f3\u30c8\u306f\u3053\u3053\u3067\u306f`spawn`\u3092\u4f7f\u3063\u3066\u3044\u308b\u3068\u3053\u308d\u3002`fork`\u306b\u3057\u3066\u3057\u307e\u3046\u3068\u3001\u5168\u3066\u306e\u5b50\u30bf\u30b9\u30af\u306e\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u306a\u3044\u3068\u672c\u30bf\u30b9\u30af\u304c\u5b8c\u4e86\u3068\u306a\u3089\u306a\u3044\u3002\u305d\u3046\u3059\u308b\u3068\u89aa\u306e\u65b9\u3067`join`\u3067\u5f85\u3063\u3066\u3044\u305f\u7b87\u6240\u3067\u6b62\u307e\u3063\u305f\u307e\u307e\u3068\u306a\u308a\u3001\u305a\u3063\u3068\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u30a2\u30a4\u30b3\u30f3\u304c\u51fa\u7d9a\u3051\u3066\u3057\u307e\u3046\u3002\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u60c5\u5831\u3001\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3001SonarQube\u30e1\u30c8\u30ea\u30af\u30b9\u306f\u753b\u9762\u8868\u793a\u3067\u5fc5\u8981\u306b\u306a\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u9045\u5ef6\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u3068\u3055\u305b\u305f\u3044\u305f\u3081\u3001\u89aa\u3068\u306f\u5207\u308a\u96e2\u3055\u308c\u305f\u30bf\u30b9\u30af\u3068\u3057\u3066\u5b9f\u884c\u3055\u305b\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u305d\u3046\u3044\u3046\u3068\u304d\u306f`spawn`\u3092\u4f7f\u3048\u3070\u826f\u3044\u3002\n\n```ts\nfunction* handleFetchBranchInfosPerRepo(api: API.API, repo: API.Repo): Iterable<Effect> {\n    // \u3053\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u5185\u306e\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u3092\u53d6\u5f97\n    const branchInfos: API.BranchInfo[] = yield call([api, api.fetchBranchInfo], repo);\n\n    // \u518d\u63cf\u753b\u6307\u793a\n    yield put(<actions.AppendBranchInfosAction>{\n        type: actions.APPEND_BRANCH_INFOS,\n        payload: {\n            branchInfos\n        }\n    });\n\n    // \u9045\u5ef6\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u51e6\u7406\u306f\u5206\u96e2\u3055\u308c\u305f\u30bf\u30b9\u30af\u3068\u3057\u3066\u5b9f\u884c\u3059\u308b\n    if (branchInfos.length > 0) {\n        // \u30ea\u30dd\u30b8\u30c8\u30ea\u5358\u4f4d\u306e\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n        yield spawn(handleFetchPullRequestCount, branchInfos);\n\n        // \u30d6\u30e9\u30f3\u30c1\u5358\u4f4d\u306e\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n        for (let i = 0; i < branchInfos.length; i++) {\n            yield spawn(handleBuildStatus, branchInfos[i]);\n            yield spawn(handleSonarQubeMetrics, branchInfos[i]);\n        }\n    }\n}\n```\n\n\u524d\u8ff0\u306e\u901a\u308a\u3001\u30d7\u30eb\u30ea\u30af\u30a8\u30b9\u30c8\u60c5\u5831\u3001\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3001SonarQube\u30e1\u30c8\u30ea\u30af\u30b9\u53d6\u5f97\u306e\u51e6\u7406\u306f\u753b\u9762\u8868\u793a\u3067\u5fc5\u8981\u306b\u306a\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u884c\u3046\u3088\u3046\u306b\u3059\u308b\u3002\u5177\u4f53\u7684\u306b\u306f\u3001\u30d6\u30e9\u30f3\u30c1\u4e00\u89a7\u306e\u30c6\u30fc\u30d6\u30eb\u8868\u793a\u306b\u304a\u3044\u3066\u3001\u30da\u30fc\u30b8\u30f3\u30b0\u3067\u8868\u793a\u5bfe\u8c61\u306b\u306a\u3063\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u521d\u3081\u3066\u30d5\u30a7\u30c3\u30c1\u3092\u884c\u3046\u3088\u3046\u306b\u3059\u308b\u3002\n\u3053\u308c\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306b\u3001`SHOW_BRANCH_INFO_DETAILS_REQUESTED:(\u5bfe\u8c61\u30ec\u30fc\u30d6\u30eb\u884c\u30c7\u30fc\u30bf\u306e\u30e6\u30cb\u30fc\u30afid)`\u30a2\u30af\u30b7\u30e7\u30f3\u304c\u767a\u884c\u3055\u308c\u308b\u307e\u3067\u5f85\u3064\u3088\u3046\u306b\u3057\u305f\u3002\u5225\u9014\u30c6\u30fc\u30d6\u30eb\u8868\u793a\u3092\u884c\u3046React\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u65b9\u304b\u3089\u3001\u8868\u793a\u5bfe\u8c61\u3068\u306a\u3063\u305f\u884c\u30c7\u30fc\u30bf\u306e\u30e6\u30cb\u30fc\u30afid\u3092\u30ad\u30fc\u306b\u3057\u3066\u3053\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u767a\u884c\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u308b\u3002\n\u4f8b\u3068\u3057\u3066\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u306e\u51e6\u7406\u30bf\u30b9\u30af\u306e\u30b3\u30fc\u30c9\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u611f\u3058\u3002\u9045\u5ef6\u30ed\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b\u304b\u3057\u306a\u3044\u304b\u306f\u3001\u3053\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306e`take`\u306b\u3088\u308b\u5f85\u3061\u3060\u3051\u3067\u6c7a\u307e\u3063\u3066\u304a\u308a\u304b\u306a\u308a\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u3063\u305f\u3002\n\n```ts\nfunction* handleBuildStatus(branchInfo: API.BranchInfo): Iterable<Effect> {\n    const { id, latestCommitHash } = branchInfo;\n\n    // \u30da\u30fc\u30b8\u30f3\u30b0\u3067\u8868\u793a\u5bfe\u8c61\u306b\u306a\u308b\u307e\u3067\u3053\u3053\u3067\u5f85\u3064\n    yield take(`${actions.SHOW_BRANCH_INFO_DETAILS_REQUESTED}:${id}`);\n\n    // \u8868\u793a\u5bfe\u8c61\u306b\u306a\u3063\u305f\u3089REST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u53d6\u5f97\n    const buildStatus = yield call([api, api.fetchBuildStatus], latestCommitHash);\n\n    // \u518d\u63cf\u753b\u6307\u793a\n    yield put(<actions.UpdateBranchInfoAction>{\n        type: actions.UPDATE_BRANCH_INFO,\n        payload: {\n            branchInfo: {\n                id,\n                buildStatus\n            }\n        }\n    });\n}\n```\n\n\u306a\u304a\u3001\u6700\u521d\u306f`SHOW_BRANCH_INFO_DETAILS_REQUESTED` \u3068\u3044\u3046\u5171\u901a\u30a2\u30af\u30b7\u30e7\u30f3\u3067take\u3057\u3066\u3001\u305d\u306epayload\u306b\u3042\u308bid\u3067\u81ea\u5206\u304c\u5bfe\u8c61\u304b\u3069\u3046\u304b\u30c1\u30a7\u30c3\u30af\u3059\u308b\u3068\u3044\u3046\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u66f8\u3044\u3066\u3044\u305f\u3002\u3057\u304b\u3057\u3053\u308c\u3060\u3068\u5927\u91cf\u306e\u30d6\u30e9\u30f3\u30c1\u304c\u3042\u308b\u5834\u5408\u306b\u6027\u80fd\u306b\u5927\u304d\u306a\u5f71\u97ff\u304c\u51fa\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u6b62\u3081\u305f(\u7279\u306bIE\u304c\u3072\u3069\u304f\u9045\u304f\u306a\u3063\u305f)\u3002\u30da\u30fc\u30b8\u30f3\u30b0\u306e\u305f\u3073\u306b\u5f85\u3063\u3066\u3044\u308b\u5168\u30bf\u30b9\u30af\u304c\u7121\u99c4\u306b\u52d5\u3044\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u983b\u5ea6\u3001\u5f85\u3061\u72b6\u614b\u306e\u30bf\u30b9\u30af\u304c\u591a\u3044\u5834\u5408\u306f\u3067\u304d\u308b\u3060\u3051\u7121\u99c4\u306b\u53cd\u5fdc\u3057\u306a\u3044\u3088\u3046\u306b\u6c17\u3092\u3064\u3051\u3066\u5b9f\u88c5\u3057\u305f\u65b9\u304c\u3088\u3055\u305d\u3046\u3067\u3042\u308b\u3002\n\n```ts\n    while (true) {\n        const action = yield take(`${actions.SHOW_BRANCH_INFO_DETAILS_REQUESTED}`);\n        if (action.payload.id === id) {\n            break;\n        }\n    }\n```\n\n\u3082\u3046\u4e00\u3064\u3001`spawn`\u3067\u8d77\u52d5\u3057\u305fSonarQube\u30e1\u30c8\u30ea\u30af\u30b9\u53d6\u5f97\u306e\u51e6\u7406\u30bf\u30b9\u30af\u3082\u7d39\u4ecb\u3002\u3053\u3061\u3089\u306f\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30bf\u30b9\u3088\u308a\u8907\u96d1\u306b\u306a\u3063\u3066\u3044\u308b\u3002SonarQube\u306eREST API\u306fBitbucket\u3068\u306f\u5225\u306e\u30b5\u30fc\u30d0\u306e\u305f\u3081\u3001\u8a8d\u8a3c\u51e6\u7406\u304c\u5225\u9014\u5fc5\u8981\u306b\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\u65e2\u306b\u8a8d\u8a3c\u6e08\u307f\u3067\u3042\u308c\u3070\u305d\u306e\u307e\u307eREST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u826f\u3044\u304c\u3001\u672a\u8a8d\u8a3c\u306e\u5834\u5408\u306f\u30e6\u30fc\u30b6\u306b\u3088\u308b\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u5b8c\u4e86\u3092\u5f85\u3064\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u3068\u3044\u3063\u3066\u3082redux-saga\u3060\u3068\u5b9f\u88c5\u306f\u7c21\u5358\u3067\u3001\u540c\u3058\u3088\u3046\u306b`take`\u3067\u8a8d\u8a3c\u5b8c\u4e86\u307e\u3067\u5f85\u3064\u3088\u3046\u306b\u3059\u308b\u3060\u3051\u3067\u826f\u3044\u3002\u306a\u304a\u3001`updateSonarQubeMetrics`\u95a2\u6570\u306f\u518d\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u5207\u308a\u51fa\u3057\u305f\u3060\u3051\u3067\u3042\u308b\u3002\n\n```ts\nfunction* handleSonarQubeMetrics(branchInfo: API.BranchInfo): Iterable<Effect> {\n    const { id } = branchInfo;\n\n    // \u30da\u30fc\u30b8\u30f3\u30b0\u3067\u8868\u793a\u5bfe\u8c61\u306b\u306a\u308b\u307e\u3067\u3053\u3053\u3067\u5f85\u3064\n    yield take(`${actions.SHOW_BRANCH_INFO_DETAILS_REQUESTED}:${id}`);\n\n    // SonarQube\u3078\u306e\u8a8d\u8a3c\u72b6\u614b\u3092State\u304b\u3089\u53d6\u5f97\n    const sonarQubeAuthenticated: boolean = yield select((state: RootState) => state.app.sonarQubeAuthenticated);\n\n    if (sonarQubeAuthenticated) {\n        // \u8a8d\u8a3c\u6e08\u307f\u3067\u3042\u308c\u3070SonarQube\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831\u53d6\u5f97\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n        yield fork(updateSonarQubeMetrics, branchInfo);\n\n    } else {\n        // \u672a\u8a8d\u8a3c\u3067\u3042\u308c\u3070\u3001\u8a8d\u8a3c\u3055\u308c\u308b\u307e\u3067\u5f85\u3064\n        yield take(actions.SONARQUBE_AUTHENTICATED);\n\n        // \u8a8d\u8a3c\u3055\u308c\u305f\u5f8c\u306bSonarQube\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831\u53d6\u5f97\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n        yield fork(updateSonarQubeMetrics, branchInfo);\n    }\n}\n\nfunction* updateSonarQubeMetrics(branchInfo: API.BranchInfo) {\n    const { id, repo, branch } = branchInfo;\n    \n    // SonarQube\u306eREST API\u3092\u30b3\u30fc\u30eb\u3057\u3066\u30e1\u30c8\u30ea\u30af\u30b9\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n    const sonarQubeMetrics: API.SonarQubeMetrics = yield call([api, api.fetchSonarQubeMetricsByKey], repo, branch);\n\n    // \u518d\u63cf\u753b\u6307\u793a\n    yield put(<actions.UpdateBranchInfoAction>{\n        type: actions.UPDATE_BRANCH_INFO,\n        payload: {\n            branchInfo: {\n                id,\n                sonarQubeMetrics\n            }\n        }\n    });\n}\n```\n\n# \u6240\u611f\n\u4eca\u56de\u30c6\u30b9\u30c8\u306f\u4e00\u5207\u66f8\u3044\u3066\u3044\u306a\u3044\u306e\u3067\u3001redux-saga\u306e\u30e1\u30ea\u30c3\u30c8\u3092\u6d3b\u304b\u3057\u304d\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306e\u203b\u3001redux-saga\u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406\u5236\u5fa1\u306f\u4eca\u56de\u306e\u3084\u308a\u305f\u3044\u3053\u3068\u306b\u30de\u30c3\u30c1\u3057\u3066\u3044\u308b\u3068\u601d\u3063\u305f\u3002\u5168\u3066\u306e\u51e6\u7406\u3092\u30d5\u30e9\u30c3\u30c8\u306b\u66f8\u304f\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u4e0a\u304b\u3089\u9806\u306b\u8aad\u3093\u3067\u3044\u304f\u3060\u3051\u3067\u51e6\u7406\u3092\u8ffd\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u3001\u30b3\u30fc\u30c9\u306e\u898b\u901a\u3057\u304c\u304b\u306a\u308a\u826f\u304f\u306a\u3063\u305f\u3068\u601d\u3046\u3002\n\u307e\u305f\u3001\u4eca\u5f8c\u306e\u8ffd\u52a0\u8981\u671b\u3067Bitbucket\u304b\u3089\u306e\u53d6\u5f97\u60c5\u5831\u304c\u5897\u3048\u305f\u3068\u3057\u3066\u3082\u3001\u65b0\u305f\u306b\u30bf\u30b9\u30af\u3092\u5b9a\u7fa9\u3057\u3066`fork` or `spawn`\u3059\u308b\u3060\u3051\u3067\u5bb9\u6613\u306b\u8ffd\u52a0\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u3082\u306a\u3063\u305f\u306e\u3082\u826f\u3044\u3002\n\n\u203b redux-saga\u3060\u3068\u975e\u540c\u671f\u51e6\u7406\u3092\u30e2\u30c3\u30af\u306a\u3057\u3067\u30b7\u30f3\u30d7\u30eb\u306b\u30c6\u30b9\u30c8\u304c\u3067\u304d\u308b\u3002\u8a73\u3057\u304f\u306f@kuy \u6c0f\u306e[redux-saga\u3067\u975e\u540c\u671f\u51e6\u7406\u3068\u6226\u3046] (http://qiita.com/kuy/items/716affc808ebb3e1e8ac#%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%BF%E3%82%8B)\u3092\u53c2\u7167\u306e\u3053\u3068\u3002\n"}