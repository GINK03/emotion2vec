{"tags": ["twilio", "PHP"], "context": " More than 1 year has passed since last update.\u300c\u3042\u308b\u96fb\u8a71\u756a\u53f7\u3078\u81ea\u52d5\u7684\u306b\u96fb\u8a71\u3092\u3057\u3001\u76f8\u624b\u304c\u51fa\u305f\u3089\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6d41\u3057\u3001\u55b6\u696d\u30de\u30f3\u306e\u643a\u5e2f\u96fb\u8a71\u306b\u8ee2\u9001\u3057\u3066\u307b\u3057\u3044\u300d\u7684\u306a\u8a71\u304c\u3042\u3063\u305f\u306e\u3067\u8abf\u3079\u305f\u3089\u3001twilio http://twilio.kddi-web.com/ \u3092\u4f7f\u3063\u305f\u767a\u7740\u4fe1\u306e\u5236\u5fa1\u304c\u3059\u3054\u304f\u7c21\u5358\u3060\u3063\u305f\u3002\n\u4ee5\u4e0b\u306f\u30c6\u30b9\u30c8\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u5c11\u3057\u8a66\u3057\u305f\u3082\u306e\u3002\n\uff08\u65b0\u898f\u767b\u9332\u6642\u3001\u304a\u8a66\u3057\u3067\u3057\u3070\u3089\u304f\u7121\u6599\u3067\u5229\u7528\u3067\u304d\u308b\uff09\n\u30c6\u30b9\u30c8\u3067\u4f5c\u6210\u3057\u305f\u306e\u3067\u3001\u4e00\u90e8\u306f\u30b5\u30f3\u30d7\u30eb\u306e\u307e\u307e\u3002\n\ntwilio.php\n<?php\n// PHP\u306eSDK\u3092\u5229\u7528\u3059\u308b \nrequire('twilio-php/Services/Twilio.php'); \n\n// 1. \u767a\u4fe1\u3002\u5f15\u6570 'call'\u3092\u3064\u3051\u3066\u3001PHP\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3002\nif (isset($argv)) {\n    if (in_array('call', $argv)) {\n        phone('+813xxxxxxxx');\n        echo \"phone\u00a5n\";\n        exit();\n    }\n}\n\n// 2. \u767a\u4fe1\u304c\u53d7\u3051\u53d6\u3089\u308c\u305f\u5834\u5408\u3001\u767b\u9332\u6e08\u307f\u306eURL(?hello=1)\u304c\u547c\u3073\u51fa\u3055\u308c\u308b \nif (isset($_GET['hello'])){\n    header(\"content-type: text/xml\");\n    // TWIML\u3092\u51fa\u529b\n    echo <<<_EOD_\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Response>\n  <Say>This is Seraph Test.</Say>\n  <Play>http://example.com/monkey.mp3</Play>\n  <Gather numDigits=\"1\" action=\"twilio.php\" method=\"POST\">\n    <Say>To speak to a real monkey, press 5.  Press any other key to start over.</Say>\n  </Gather>\n</Response>\n_EOD_;\n\n    exit();\n}\n\n// 3. \u30ad\u30fc\u304c\u62bc\u3055\u308c\u308b\u3068\u547c\u3073\u51fa\u3055\u308c\u308b\nif (isset($_POST['Digits'])) {\n    // \u62bc\u3055\u308c\u305f\u30ad\u30fc\u304c'5'\u306e\u5834\u5408\n    if ($_POST['Digits'] == '5') {\n        // '+813xxxxxxxx'\u3078\u96fb\u8a71\u3092\u8ee2\u9001\u3059\u308b\n        header(\"content-type: text/xml\");\n        // TWIML\u3092\u51fa\u529b\n        echo <<<_EOD_\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Response>\n    <Dial>+813xxxxxxxx</Dial>\n    <Say>The call failed or the remote party hung up. Goodbye.</Say>\n</Response>\n_EOD_;\n\n    } else {\n        // \u51e6\u74062\u3092\u518d\u3073\u884c\u3046\n        header('Location: ' . $url . 'twilio.php?hello=1');\n    }\n    exit();\n}\n\n\necho \"end\\n\";\nexit();\n\n/**\n * \u767a\u4fe1\u7528\u95a2\u6570\n * @param string $to \u767a\u4fe1\u5148\u96fb\u8a71\u756a\u53f7\n */\nfunction phone($to) {\n\n    $account_sid = \"0123456789012345678901234567890123\";\n    $auth_token = \"0123456789012345678901234567890123\";\n\n    // \u767b\u9332\u6e08\u307f\u306eApplicationSid\n    $application_sid = \"0123456789012345678901234567890123\";\n\n    // \u767a\u4fe1\u5143\u96fb\u8a71\u756a\u53f7\n    $from = '+813xxxxxxxx';\n\n    $client = new Services_Twilio($account_sid, $auth_token); \n\n    // \u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u9069\u6642\u5909\u66f4\u3059\u308b\n    $client->account->calls->create($from, $to, $application_sid, array( \n        'Method' => 'GET',  \n        'FallbackMethod' => 'GET',  \n        'StatusCallbackMethod' => 'GET',    \n        'Record' => 'true', \n    ));\n}\n\n\n\u300c\u3042\u308b\u96fb\u8a71\u756a\u53f7\u3078\u81ea\u52d5\u7684\u306b\u96fb\u8a71\u3092\u3057\u3001\u76f8\u624b\u304c\u51fa\u305f\u3089\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6d41\u3057\u3001\u55b6\u696d\u30de\u30f3\u306e\u643a\u5e2f\u96fb\u8a71\u306b\u8ee2\u9001\u3057\u3066\u307b\u3057\u3044\u300d\u7684\u306a\u8a71\u304c\u3042\u3063\u305f\u306e\u3067\u8abf\u3079\u305f\u3089\u3001twilio http://twilio.kddi-web.com/ \u3092\u4f7f\u3063\u305f\u767a\u7740\u4fe1\u306e\u5236\u5fa1\u304c\u3059\u3054\u304f\u7c21\u5358\u3060\u3063\u305f\u3002\n\n\u4ee5\u4e0b\u306f\u30c6\u30b9\u30c8\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u5c11\u3057\u8a66\u3057\u305f\u3082\u306e\u3002\n\uff08\u65b0\u898f\u767b\u9332\u6642\u3001\u304a\u8a66\u3057\u3067\u3057\u3070\u3089\u304f\u7121\u6599\u3067\u5229\u7528\u3067\u304d\u308b\uff09\n\u30c6\u30b9\u30c8\u3067\u4f5c\u6210\u3057\u305f\u306e\u3067\u3001\u4e00\u90e8\u306f\u30b5\u30f3\u30d7\u30eb\u306e\u307e\u307e\u3002\n\n```php:twilio.php\n<?php\n// PHP\u306eSDK\u3092\u5229\u7528\u3059\u308b \nrequire('twilio-php/Services/Twilio.php'); \n\n// 1. \u767a\u4fe1\u3002\u5f15\u6570 'call'\u3092\u3064\u3051\u3066\u3001PHP\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3002\nif (isset($argv)) {\n\tif (in_array('call', $argv)) {\n\t\tphone('+813xxxxxxxx');\n\t\techo \"phone\u00a5n\";\n\t\texit();\n\t}\n}\n\n// 2. \u767a\u4fe1\u304c\u53d7\u3051\u53d6\u3089\u308c\u305f\u5834\u5408\u3001\u767b\u9332\u6e08\u307f\u306eURL(?hello=1)\u304c\u547c\u3073\u51fa\u3055\u308c\u308b \nif (isset($_GET['hello'])){\n    header(\"content-type: text/xml\");\n    // TWIML\u3092\u51fa\u529b\n\techo <<<_EOD_\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Response>\n  <Say>This is Seraph Test.</Say>\n  <Play>http://example.com/monkey.mp3</Play>\n  <Gather numDigits=\"1\" action=\"twilio.php\" method=\"POST\">\n    <Say>To speak to a real monkey, press 5.  Press any other key to start over.</Say>\n  </Gather>\n</Response>\n_EOD_;\n\n\texit();\n}\n\n// 3. \u30ad\u30fc\u304c\u62bc\u3055\u308c\u308b\u3068\u547c\u3073\u51fa\u3055\u308c\u308b\nif (isset($_POST['Digits'])) {\n\t// \u62bc\u3055\u308c\u305f\u30ad\u30fc\u304c'5'\u306e\u5834\u5408\n\tif ($_POST['Digits'] == '5') {\n\t\t// '+813xxxxxxxx'\u3078\u96fb\u8a71\u3092\u8ee2\u9001\u3059\u308b\n\t\theader(\"content-type: text/xml\");\n    \t// TWIML\u3092\u51fa\u529b\n\t\techo <<<_EOD_\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Response>\n    <Dial>+813xxxxxxxx</Dial>\n    <Say>The call failed or the remote party hung up. Goodbye.</Say>\n</Response>\n_EOD_;\n\n\t} else {\n\t\t// \u51e6\u74062\u3092\u518d\u3073\u884c\u3046\n\t\theader('Location: ' . $url . 'twilio.php?hello=1');\n\t}\n\texit();\n}\n\n\necho \"end\\n\";\nexit();\n\n/**\n * \u767a\u4fe1\u7528\u95a2\u6570\n * @param string $to \u767a\u4fe1\u5148\u96fb\u8a71\u756a\u53f7\n */\nfunction phone($to) {\n\n\t$account_sid = \"0123456789012345678901234567890123\";\n\t$auth_token = \"0123456789012345678901234567890123\";\n\t\n\t// \u767b\u9332\u6e08\u307f\u306eApplicationSid\n\t$application_sid = \"0123456789012345678901234567890123\";\n\t\n\t// \u767a\u4fe1\u5143\u96fb\u8a71\u756a\u53f7\n\t$from = '+813xxxxxxxx';\n\n\t$client = new Services_Twilio($account_sid, $auth_token); \n\n\t// \u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u9069\u6642\u5909\u66f4\u3059\u308b\n\t$client->account->calls->create($from, $to, $application_sid, array( \n\t\t'Method' => 'GET',  \n\t\t'FallbackMethod' => 'GET',  \n\t\t'StatusCallbackMethod' => 'GET',    \n\t\t'Record' => 'true', \n\t));\n}\n```\n"}