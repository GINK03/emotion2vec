{"context": "\n\nTL;DR\ndocker run \u3067\u306f --log-opt max-size \u3068 --log-opt max-file \u3092\u6307\u5b9a\n\ndocker-run\ndocker run --rm hello-world \\\n  --log-opt max-size=10m \\\n  --log-opt max-file=3\n\n\ndocker-compose \u3067\u306f\u540c\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u30b5\u30fc\u30d3\u30b9\u3054\u3068\u306e logging \u3067\u5b9a\u7fa9\n\ndocker-compose.yml\nversion: \"3\"\nservices:\n  hello:\n    image: \"hello-world:latest\"\n    logging:\n      driver: \"json-file\" # defaults if not specified\n      options:\n        max-size: \"10m\"\n        max-file: \"3\"\n\n\nYAML \u306e max-size, max-file \u306f\u660e\u793a\u7684\u306b\u6587\u5b57\u5217\u578b\u3067\u8a18\u8ff0\u3057\u306a\u3044\u3068\u30a8\u30e9\u30fc\u3068\u306a\u308b\u3002\n\n\u6982\u8981\n\u300cdocker \u30ed\u30b0 rotate\u300d\u3067\u30b0\u30b0\u308b \u3068 logrotate \u3092\u4f7f\u3063\u3066\u3044\u308b\u4f8b\u304c\u3088\u304f\u3042\u308a\u307e\u3059\u304c\u3001\n/var/lib/docker/containers/*/*.log \u306e\u30ed\u30fc\u30c6\u30fc\u30c8\u306f\u6a19\u6e96\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\n\u5b9f\u8df5\n\ndocker run \u306e\u5834\u5408\n\n\n--log-opt \u3067 max-size \u3068 max-file \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\nmax-size \u306b\u306f k, m, g \u3068\u3044\u3063\u305f\u5358\u4f4d\u304c\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\n\n\ndocker-run\ndocker run --rm hello-world \\\n  --log-opt max-size=10m \\\n  --log-opt max-file=3\n\n\n\ndocker-compose \u306e\u5834\u5408\n\u30b5\u30fc\u30d3\u30b9\u5b9a\u7fa9\u3054\u3068\u306b logging \u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\ndocker-compose.yml\nversion: \"3\"\nservices:\n  hello:\n    image: \"hello-world:latest\"\n    logging:\n      driver: \"json-file\" # defaults if not specified\n      options:\n        max-size: \"10m\"\n        max-file: \"3\"\n\n\n\u6ce8\u610f\u70b9\u3068\u3057\u3066 max-size, max-file \u306f\u6587\u5b57\u5217\u578b\u3067\u8a18\u8ff0\u3057\u306a\u3044\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\nmax-size \u306f g, m, k \u5358\u4f4d\u6587\u5b57\u304c\u4f7f\u3048\u308b\u306e\u3067\u81ea\u7136\u3068\u6587\u5b57\u5217\u578b\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001 max-file: 3 \u306a\u3069\u3068\u3046\u3063\u304b\u308a\u66f8\u304f\u3068\nERROR: for SERVICE_NAME  Cannot create container for service web: json: cannot unmarshal number into Go value of type string\n\n\u3068\u6012\u3089\u308c\u307e\u3059\u3002\n\n\u53c2\u8003\u30ea\u30f3\u30af\nConfigure logging drivers - json-file | docs.docker.com\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n# TL;DR\n\n`docker run` \u3067\u306f `--log-opt max-size` \u3068 `--log-opt max-file` \u3092\u6307\u5b9a\n\n```text:docker-run\ndocker run --rm hello-world \\\n  --log-opt max-size=10m \\\n  --log-opt max-file=3\n```\n\n`docker-compose` \u3067\u306f\u540c\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u30b5\u30fc\u30d3\u30b9\u3054\u3068\u306e `logging` \u3067\u5b9a\u7fa9\n\n```yaml:docker-compose.yml\nversion: \"3\"\nservices:\n  hello:\n    image: \"hello-world:latest\"\n    logging:\n      driver: \"json-file\" # defaults if not specified\n      options:\n        max-size: \"10m\"\n        max-file: \"3\"\n ```\n\nYAML \u306e `max-size`, `max-file` \u306f\u660e\u793a\u7684\u306b\u6587\u5b57\u5217\u578b\u3067\u8a18\u8ff0\u3057\u306a\u3044\u3068\u30a8\u30e9\u30fc\u3068\u306a\u308b\u3002\n\n# \u6982\u8981\n\n[\u300cdocker \u30ed\u30b0 rotate\u300d\u3067\u30b0\u30b0\u308b](https://www.google.co.jp/search?q=docker+%E3%83%AD%E3%82%B0+rotate) \u3068 `logrotate` \u3092\u4f7f\u3063\u3066\u3044\u308b\u4f8b\u304c\u3088\u304f\u3042\u308a\u307e\u3059\u304c\u3001\n`/var/lib/docker/containers/*/*.log` \u306e\u30ed\u30fc\u30c6\u30fc\u30c8\u306f\u6a19\u6e96\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\n# \u5b9f\u8df5\n\n## `docker run` \u306e\u5834\u5408\n\n* `--log-opt` \u3067 `max-size` \u3068 `max-file` \u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n* `max-size` \u306b\u306f `k`, `m`, `g` \u3068\u3044\u3063\u305f\u5358\u4f4d\u304c\u4f7f\u7528\u3067\u304d\u307e\u3059\u3002\n\n```text:docker-run\ndocker run --rm hello-world \\\n  --log-opt max-size=10m \\\n  --log-opt max-file=3\n```\n\n## `docker-compose` \u306e\u5834\u5408\n\n\u30b5\u30fc\u30d3\u30b9\u5b9a\u7fa9\u3054\u3068\u306b `logging` \u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```yaml:docker-compose.yml\nversion: \"3\"\nservices:\n  hello:\n    image: \"hello-world:latest\"\n    logging:\n      driver: \"json-file\" # defaults if not specified\n      options:\n        max-size: \"10m\"\n        max-file: \"3\"\n ```\n\n\u6ce8\u610f\u70b9\u3068\u3057\u3066 `max-size`, `max-file` \u306f\u6587\u5b57\u5217\u578b\u3067\u8a18\u8ff0\u3057\u306a\u3044\u3068\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n\n`max-size` \u306f `g, m, k` \u5358\u4f4d\u6587\u5b57\u304c\u4f7f\u3048\u308b\u306e\u3067\u81ea\u7136\u3068\u6587\u5b57\u5217\u578b\u306b\u306a\u308b\u3068\u601d\u3044\u307e\u3059\u304c\u3001 `max-file: 3` \u306a\u3069\u3068\u3046\u3063\u304b\u308a\u66f8\u304f\u3068\n\n```text\nERROR: for SERVICE_NAME  Cannot create container for service web: json: cannot unmarshal number into Go value of type string\n```\n\n\u3068\u6012\u3089\u308c\u307e\u3059\u3002\n\n# \u53c2\u8003\u30ea\u30f3\u30af\n\n[Configure logging drivers - json-file | docs.docker.com](https://docs.docker.com/engine/admin/logging/overview/#/json-file)\n\n----\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n", "tags": ["docker", "docker-compose"]}