{"context": "Android\u3067BLE\u3092\u52d5\u4f5c\u3055\u305b\u308b\u305f\u3081\u306e\u5099\u5fd8\u9332\u3068\u3057\u3066\u8a18\u8f09\u3057\u307e\u3059\u3002\n\u81ea\u5206\u3067\u7406\u89e3\u3067\u304d\u308b\u3053\u3068\u3092\u512a\u5148\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u4e0d\u8db3\u5206\u306f\u88dc\u5b8c\u3057\u3066\u304f\u3060\u3055\u3044\u307e\u305b\u3002\u3002\u3002\n\n\u30de\u30cb\u30e5\u30d5\u30a7\u30b9\u30c8\u3078\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u8ffd\u52a0\nAndroidManifest\u306b\u201dBLE\u4f7f\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u306d\u201d\u7684\u306a\u3082\u306e\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u4f4d\u7f6e\u306b\u95a2\u3059\u308b\"ACCESS_COARSE_LOCATION\"\u3082\u5fc5\u8981\u3068\u306a\u308b\u306e\u3067\u5fd8\u308c\u305a\u306b\u3002\n\nAndroidManifest.xml\n<uses-permission android:name=\"android.permission.BLUETOOTH\" />\n<uses-permission android:name=\"android.permission.BLUETOOTH_ADMIN\" />\n<uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" />\n<uses-feature android:name=\"android.hardware.bluetooth\" />\n\n\n\n\u30a4\u30f3\u30dd\u30fc\u30c8\nBLE\u306b\u5fc5\u8981\u306a\u3042\u308c\u3053\u308c\u3092import\u3057\u307e\u3059\u3002\nimport android.bluetooth.BluetoothAdapter;\nimport android.bluetooth.BluetoothDevice;\nimport android.bluetooth.BluetoothManager;\nimport android.bluetooth.le.BluetoothLeScanner;\nimport android.bluetooth.le.ScanCallback;\nimport android.bluetooth.le.ScanResult;\n\n\n\u5909\u6570\u5ba3\u8a00\nBLE\u901a\u4fe1\u3092\u3059\u308b\u30af\u30e9\u30b9\u306e\u30e1\u30f3\u30d0\u3068\u3057\u3066\u8ffd\u52a0\u3002\nprivate BluetoothAdapter mBluetoothAdapter;\nprivate BluetoothLeScanner mBluetoothLeScanner;\nprivate ScanCallback mScanCallback;\n\n\nBluettoothAdapter\u306e\u53d6\u5f97\nfinal BluetoothManager bluetoothManager =\n        (BluetoothManager) getSystemService(Context.BLUETOOTH_SERVICE);\nmBluetoothAdapter = bluetoothManager.getAdapter();\n\n// Bluetooth\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u304b\u306e\u30c1\u30a7\u30c3\u30af\nif (mBluetoothAdapter == null) {\n    Toast.makeText(this, \u201dBluetooth\u672a\u30b5\u30dd\u30fc\u30c8\u201d, Toast.LENGTH_SHORT).show();\n    finish();\n    return;\n}\n\n\nBluetoothLeScanner\u306e\u53d6\u5f97\nmBluetoothLeScanner = mBluetoothAdapter.getBluetoothLeScanner();\n\n\n\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3068\u52d5\u4f5c\u3092\u4f5c\u6210\u3059\u308b\u3002\nprivate ScanCallback initCallbacks() {\n    return new ScanCallback() {\n        @Override\n        public void onScanResult(int callbackType, ScanResult result) {\n            super.onScanResult(callbackType, result);\n\n            // \u30c7\u30d0\u30a4\u30b9\u304c\u898b\u3064\u304b\u3063\u305f\uff01\n            if (result != null && result.getDevice() != null) {\n                // \u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u306a\u3069\u306a\u3069\u306e\u51e6\u7406\u3092\u304a\u3053\u306a\u3046\n                //addDevice(result.getDevice(), result.getRssi());\n            }\n        }\n\n        @Override\n        public void onBatchScanResults(List<ScanResult> results) {\n            super.onBatchScanResults(results);\n        }\n\n        @Override\n        public void onScanFailed(int errorCode) {\n            super.onScanFailed(errorCode);\n        }\n    };\n}\n\nonCreate\u306a\u3069\u3067\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u30e1\u30f3\u30d0\u306b\u5165\u308c\u3066\u304a\u304f\nmScanCallback = initCallbacks();\n\n\nBLE\u30b9\u30ad\u30e3\u30f3\u306e\u958b\u59cb\uff0f\u505c\u6b62\n\n\u30b9\u30ad\u30e3\u30f3\u306e\u958b\u59cb\nmBluetoothLeScanner.startScan(mScanCallback);\n\n\n\u30b9\u30ad\u30e3\u30f3\u306e\u505c\u6b62\nmBluetoothLeScanner.stopScan(mScanCallback);\n\n\u4ee5\u4e0a\u3002\nAndroid\u3067BLE\u3092\u52d5\u4f5c\u3055\u305b\u308b\u305f\u3081\u306e\u5099\u5fd8\u9332\u3068\u3057\u3066\u8a18\u8f09\u3057\u307e\u3059\u3002\n\u81ea\u5206\u3067\u7406\u89e3\u3067\u304d\u308b\u3053\u3068\u3092\u512a\u5148\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u4e0d\u8db3\u5206\u306f\u88dc\u5b8c\u3057\u3066\u304f\u3060\u3055\u3044\u307e\u305b\u3002\u3002\u3002\n\n\n# \u30de\u30cb\u30e5\u30d5\u30a7\u30b9\u30c8\u3078\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u8ffd\u52a0\n\nAndroidManifest\u306b\u201dBLE\u4f7f\u308f\u305b\u3066\u304f\u3060\u3055\u3044\u306d\u201d\u7684\u306a\u3082\u306e\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u4f4d\u7f6e\u306b\u95a2\u3059\u308b\"ACCESS_COARSE_LOCATION\"\u3082\u5fc5\u8981\u3068\u306a\u308b\u306e\u3067\u5fd8\u308c\u305a\u306b\u3002\n\n```xml:AndroidManifest.xml\n<uses-permission android:name=\"android.permission.BLUETOOTH\" />\n<uses-permission android:name=\"android.permission.BLUETOOTH_ADMIN\" />\n<uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" />\n<uses-feature android:name=\"android.hardware.bluetooth\" />\n```\n\n\n# \u30a4\u30f3\u30dd\u30fc\u30c8\n\nBLE\u306b\u5fc5\u8981\u306a\u3042\u308c\u3053\u308c\u3092import\u3057\u307e\u3059\u3002\n\n``` java\nimport android.bluetooth.BluetoothAdapter;\nimport android.bluetooth.BluetoothDevice;\nimport android.bluetooth.BluetoothManager;\nimport android.bluetooth.le.BluetoothLeScanner;\nimport android.bluetooth.le.ScanCallback;\nimport android.bluetooth.le.ScanResult;\n```\n\n# \u5909\u6570\u5ba3\u8a00\n\nBLE\u901a\u4fe1\u3092\u3059\u308b\u30af\u30e9\u30b9\u306e\u30e1\u30f3\u30d0\u3068\u3057\u3066\u8ffd\u52a0\u3002\n\n```java\nprivate BluetoothAdapter mBluetoothAdapter;\nprivate BluetoothLeScanner mBluetoothLeScanner;\nprivate ScanCallback mScanCallback;\n```\n\n# BluettoothAdapter\u306e\u53d6\u5f97\n\n```java\nfinal BluetoothManager bluetoothManager =\n        (BluetoothManager) getSystemService(Context.BLUETOOTH_SERVICE);\nmBluetoothAdapter = bluetoothManager.getAdapter();\n\n// Bluetooth\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u304b\u306e\u30c1\u30a7\u30c3\u30af\nif (mBluetoothAdapter == null) {\n    Toast.makeText(this, \u201dBluetooth\u672a\u30b5\u30dd\u30fc\u30c8\u201d, Toast.LENGTH_SHORT).show();\n    finish();\n    return;\n}\n```\n\n# BluetoothLeScanner\u306e\u53d6\u5f97\n\n``` java\nmBluetoothLeScanner = mBluetoothAdapter.getBluetoothLeScanner();\n```\n\n# \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\n\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3068\u52d5\u4f5c\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```java\nprivate ScanCallback initCallbacks() {\n    return new ScanCallback() {\n        @Override\n        public void onScanResult(int callbackType, ScanResult result) {\n            super.onScanResult(callbackType, result);\n\n            // \u30c7\u30d0\u30a4\u30b9\u304c\u898b\u3064\u304b\u3063\u305f\uff01\n            if (result != null && result.getDevice() != null) {\n                // \u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u306a\u3069\u306a\u3069\u306e\u51e6\u7406\u3092\u304a\u3053\u306a\u3046\n                //addDevice(result.getDevice(), result.getRssi());\n            }\n        }\n\n        @Override\n        public void onBatchScanResults(List<ScanResult> results) {\n            super.onBatchScanResults(results);\n        }\n\n        @Override\n        public void onScanFailed(int errorCode) {\n            super.onScanFailed(errorCode);\n        }\n    };\n}\n```\n\nonCreate\u306a\u3069\u3067\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u30e1\u30f3\u30d0\u306b\u5165\u308c\u3066\u304a\u304f\n\n```java\nmScanCallback = initCallbacks();\n```\n\n\n# BLE\u30b9\u30ad\u30e3\u30f3\u306e\u958b\u59cb\uff0f\u505c\u6b62\n\n## \u30b9\u30ad\u30e3\u30f3\u306e\u958b\u59cb\n``` java\nmBluetoothLeScanner.startScan(mScanCallback);\n```\n\n\n## \u30b9\u30ad\u30e3\u30f3\u306e\u505c\u6b62\n``` java\nmBluetoothLeScanner.stopScan(mScanCallback);\n```\n\n\u4ee5\u4e0a\u3002\n", "tags": ["BLE", "Android"]}