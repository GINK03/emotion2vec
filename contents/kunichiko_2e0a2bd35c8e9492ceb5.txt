{"context": " More than 1 year has passed since last update.\n\n\u96fb\u5b50\u7f72\u540d\u306e\u30d5\u30a1\u30a4\u30eb\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\nOpenSSL\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u96fb\u5b50\u7f72\u540d\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u306f\u3001OpenSSL\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u516c\u958b\u9375\u6697\u53f7\u3001\u96fb\u5b50\u7f72\u540d\u306e\u65b9\u6cd5 \u3067\u89e3\u8aac\u3057\u307e\u3057\u305f\u3002\n\u305d\u306e\u30b3\u30de\u30f3\u30c9\u3067\u751f\u6210\u3055\u308c\u305f sign.sig \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306f\u4e00\u4f53\u306a\u3093\u306a\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\u3068\u3044\u3046\u306e\u3092\u307e\u3068\u3081\u305f\u306e\u304c\u3053\u306e\u30a8\u30f3\u30c8\u30ea\u3067\u3059\u3002\n\n\u96fb\u5b50\u7f72\u540d\u306b\u95a2\u3059\u308b\u4ed5\u69d8\nRSA\u6697\u53f7\u306e\u5168\u4f53\u50cf\u3067\u89e3\u8aac\u3057\u305f\u3088\u3046\u306b\u3001\u516c\u958b\u9375\u6697\u53f7\u306b\u95a2\u3059\u308b\u4ed5\u69d8\u306f PKCS\u3068\u3044\u3046\u898f\u683c\u7fa4\u306b\u307e\u3068\u3081\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u96fb\u5b50\u7f72\u540d\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3082 PKCS #1\u306b\u898f\u5b9a\u304c\u3042\u308a\u307e\u3059\u3002PKCS #1\u306f RFC 3447\u3068\u3057\u3066\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u7121\u6599\u3067\u8aad\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u3001PKCS #7\u306b\u3082\u96fb\u5b50\u7f72\u540d\u306b\u95a2\u3059\u308b\u8a18\u8ff0\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002\u3053\u3061\u3089\u306f\u307e\u3060\u3061\u3083\u3093\u3068\u8aad\u3081\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u3069\u3046\u3084\u3089\u3001\u7f72\u540d\u81ea\u4f53\u3092\u5143\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u6dfb\u4ed8\u3059\u308b\u65b9\u6cd5\u306a\u3069\u306b\u3064\u3044\u3066\u898f\u5b9a\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u3067\u3059\u306e\u3067\u3001\u96fb\u5b50\u7f72\u540d\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u3064\u3044\u3066\u306f\u3001\u307e\u305a\u306f PKCS #1\u3092\u898b\u308b\u306e\u304c\u5148\u6c7a\u3067\u3059\u3002\n\nPKCS #1 \u304b\u3089\u96fb\u5b50\u7f72\u540d\u306e\u4ed5\u69d8\u3092\u8aad\u307f\u89e3\u304f\n\n\u300c8 Signature schemes with appendix\u300d\nSection 8\u306b\u3001\u7f72\u540d\u306e\u30b9\u30ad\u30fc\u30e0\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u304c\u3042\u308a\u307e\u3059\u3002 with appendix \u306f\u76f4\u8a33\u3059\u308b\u3068\u300c\u4ed8\u52a0\u60c5\u5831\u4ed8\u304d\u300d\u3068\u3044\u3046\u610f\u5473\u3067\u3059\u304c\u3001\u304a\u305d\u3089\u304f\u3001\u7f72\u540d\u3092\u691c\u8a3c\u3059\u308b\u305f\u3081\u306e\u4ed8\u52a0\u60c5\u5831\u304c\u3064\u3044\u3066\u3044\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3092\u8a00\u3044\u305f\u3044\u306b\u3060\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\u3053\u306e\u8aac\u660e\u306b\u3088\u308b\u3068\u3001\u96fb\u5b50\u7f72\u540d\u306b\u306f\u4ee5\u4e0b\u306e\uff12\u3064\u306e\u30b9\u30ad\u30fc\u30e0\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\nRSASSA-PSS\nRSASSA-PKCS1-v1_5\n\n\u3053\u308c\u3089\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8aac\u660e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\nAlthough no attacks are known against RSASSA-PKCS1-v1_5, in the interest of increased robustness, RSASSA-PSS is recommended for eventual adoption in new applications.\n\n(\u9069\u5f53\u8a33)\n\nRSASSA-PKCS1-v1_5\u306b\u5bfe\u3059\u308b\u6709\u52b9\u306a\u653b\u6483\u306f\u77e5\u3089\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u65b0\u3057\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u5805\u7262\u6027\u3092\u5411\u4e0a\u3055\u305b\u308b\u76ee\u7684\u3067 RSASSA-PSS\u3092\u63a1\u629e\u3059\u308b\u3053\u3068\u3092\u63a8\u5968\u3057\u307e\u3059\u3002\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001RSASSA-PSS\u304c\u3068\u3066\u3082\u826f\u3044\u3082\u306e\u306e\u3088\u3046\u306b\u8aad\u3081\u307e\u3059\u304c\u3001\u6b8b\u5ff5\u306a\u304c\u3089 openssl\u304c\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u306f RSASSA-PKCS1-v1_5 \u306e\u65b9\u306e\u3088\u3046\u3067\u3059\u3002PSS\u306e\u65b9\u306e\u4ed5\u69d8\u3092\u8aad\u3093\u3067\u307f\u308b\u3068\u3001\u5272\u3068\u3081\u3093\u3069\u3063\u3061\u3044\u3053\u3068\u304c\u3044\u308d\u3044\u308d\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u7279\u306b\u554f\u984c\u306a\u3044\u306a\u3089 v1_5\u306e\u307e\u307e\u3067\u3044\u3044\u3088\u306d\u3063\u3066\u611f\u3058\u306a\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\u5b9f\u969b\u3001OpenSSL\u4ee5\u5916\u306e\u6697\u53f7\u5316\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u3069\u3082 v1_5\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3082\u306e\u304c\u307b\u3068\u3093\u3069\u306e\u3088\u3046\u3067\u3059\u3002\u306a\u306e\u3067\u3053\u3053\u304b\u3089\u306f RSASSA-PSS\u306e\u3053\u3068\u306f\u5fd8\u308c\u3066\u3001v1_5\u306e\u65b9\u3060\u3051\u898b\u3066\u3044\u304d\u307e\u3059\u3002\n\n\u300c8.2.1 Signature generation operation\u300d\n8.2.1\u306b\u3001RSASSA-PKCS1-v1_5 \u306e\u7f72\u540d\u751f\u6210\u51e6\u7406\u306e\u8a73\u7d30\u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u9069\u5f53\u306b\u8a33\u3057\u3066\u307f\u307e\u3059\u3002\n\nRSASSA-PKCS1-V1_5-SIGN (K, M)\n\n\n\u5165\u529b:\n\nK - \u7f72\u540d\u8005\u306e\u79d8\u5bc6\u9375\nM - \u7f72\u540d\u5bfe\u8c61\u306e\u30e1\u30c3\u30bb\u30fc\u30b8(\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf)\n\n\n\n\u51fa\u529b:\n\nS - \u7f72\u540d(\u9577\u3055k\u306e\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf)\u3002k\u306f RSA\u30e2\u30b8\u30e5\u30fc\u30eb\u306e n\u4ee5\u4e0b\u306e\u9577\u3055(?)\n\n\n\n\u30a8\u30e9\u30fc:\n\n\"message too long\"\n\"RSA modulus too short\"\n\n\n\n\n\u624b\u9806:\n\n\nEMSA-PKCS1-v1_5 \u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u884c\u3046\n\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u3082\u306e\u3092EM\u3068\u3059\u308b\u3002\u30a8\u30f3\u30b3\u30fc\u30c9\u306e\u8a73\u7d30\u306f9.2\u3067\u8aac\u660e\u3002\nEM = EMSA-PKCS1-V1_5-ENCODE (M, k).\n\n\n\nRSA\u7f72\u540d\u3092\u884c\u3046\na. 4.2\u3067\u5b9a\u7fa9\u3055\u308c\u305fOS2IP\u3092\u4f7f\u3063\u3066\u3001\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8EM\u3092\u6574\u6570\u5024 m\u306b\u5909\u63db\u3059\u308b\u3002(\u8a33\u6ce8:OS2IP\u306f\u3001\u5358\u306b\u30d0\u30a4\u30ca\u30ea\u5217\u3092\u7b26\u53f7\u306a\u3057\u306e\u5de8\u5927\u306a\u30d3\u30c3\u30b0\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\u306e\u6574\u6570\u5024\u3068\u307f\u306a\u3059\u3068\u3044\u3046\u3060\u3051\u3067\u3059)\nm = OS2IP (EM).\n\nb. RSA\u79d8\u5bc6\u9375 K\u3068\u30e1\u30c3\u30bb\u30fc\u30b8 m \u3092 RSAAP1\u306b\u9069\u7528\u3057\u3001\u6574\u6570\u5024\u306e\u7f72\u540d\u5024 s\u3092\u751f\u6210\u3059\u308b(5.2.1\u7bc0\u53c2\u7167)(\u8a33\u6ce8:\u5358\u306b\u3001\u79d8\u5bc6\u9375K\u3067m\u3092\u6697\u53f7\u5316\u3059\u308b\u51e6\u7406\u3068\u601d\u308f\u308c\u307e\u3059)\ns = RSASP1 (K, m).\n\nc. 4.1\u3067\u5b9a\u7fa9\u3055\u308c\u305fI2OSP\u3092\u3064\u304b\u3063\u3066\u3001\u7f72\u540d\u5024 s\u3092\u9577\u3055 k\u306e\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u306b\u5909\u63db\u3059\u308b\u3002(\u8a33\u6ce8:I2OSP\u306f\u3001\u5358\u306b\u6b63\u306e\u6574\u6570\u5024\u3092\u7b26\u53f7\u306a\u3057k\u30d0\u30a4\u30c8\u306e\u30d3\u30c3\u30b0\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\u3067\u66f8\u304d\u51fa\u3059\u51e6\u7406\u3067\u3059)\nS = I2OSP (s, k).\n\n\n\u7f72\u540d S\u3092\u51fa\u529b\u3059\u308b\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u30012\u306f\u5358\u306b\u300c\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3059\u308b\u300d\u51e6\u7406\u3092\u53b3\u5bc6\u306b\u66f8\u3044\u3066\u3044\u308b\u3060\u3051\u306a\u306e\u3067\u3001\u554f\u984c\u306f1\u306e EMSA-PKCS-V1_5-ENCODE \u306e\u51e6\u7406\u304c\u306a\u3093\u306a\u306e\u304b\u3068\u3044\u3046\u3068\u3053\u308d\u306b\u7d5e\u3089\u308c\u307e\u3059\u3002\u3053\u308c\u306f 9.2\u7bc0\u3092\u898b\u3066\u307f\u308c\u3070\u308f\u304b\u308a\u307e\u3059\u3002\n\n\u300c8.2.2 Signature verification operation\u300d\n8.2.2\u3067\u306f\u30018.2.1\u3067\u898f\u5b9a\u3055\u308c\u305f RSASSA-PKCS1-V1_5-SIGN \u306e\u9006\u51e6\u7406\u3001RSASSA-PKCS1-V1_5-VERIFY \u306e\u52d5\u4f5c\u304c\u898f\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u300c9.2 EMSA-PKCS1-v1_5\u300d\n8.2.1\u306eRSASSA-PKCS1-V1_5-SIGN \u3067\u4f7f\u308f\u308c\u3066\u3044\u308b EMSA-PKCS1-v1_5-ENCODE \u306e\u4ed5\u69d8\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3061\u3089\u3082\u8a33\u3057\u3066\u307f\u307e\u3059\u3002\n\nEMSA-PKCS1-v1_5-ENCODE (M, emLen)\n\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\n\nHash - \u30cf\u30c3\u30b7\u30e5\u95a2\u6570 (hLen \u306f\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u304c\u51fa\u529b\u3059\u308b\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u30d0\u30a4\u30c8\u9577\u3092\u8868\u3059)\n\n\n\n\u5165\u529b:\n\nM - \u30a8\u30f3\u30b3\u30fc\u30c9\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\nemLen - \u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8(EM)\u306e\u9577\u3055\u3002\u6700\u4f4e\u3067\u3082 tLen + 11 \u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u3053\u3053\u3067\u3001tLen\u306f\u3001\u30a8\u30f3\u30b3\u30fc\u30c9\u51e6\u7406\u306e\u904e\u7a0b\u3067\u751f\u6210\u3055\u308c\u308bT\u3092 DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u305f\u30d0\u30a4\u30c8\u9577\u3067\u3042\u308b\u3002(\u8a33\u6ce8: \u3053\u306e\u30a8\u30f3\u30b3\u30fc\u30c9\u30e1\u30bd\u30c3\u30c9\u3067\u306f\u30d1\u30c7\u30a3\u30f3\u30b0\u306b\u3088\u3063\u3066\u9577\u3055\u3092\u8abf\u6574\u3067\u304d\u308b\u306e\u3067\u3001emLen\u306b\u597d\u304d\u306a\u9577\u3055\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\u305f\u3060\u3057\u3001\u77ed\u3059\u304e\u308b\u3068\u5165\u308a\u304d\u3089\u306a\u3044\u306e\u3067\u30c0\u30e1\u3067\u3059\u3088\u3001\u3068\u3044\u3046\u3053\u3068)\n\n\n\n\u51fa\u529b:\n\nEM - \u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8(\u9577\u3055 emLen\u306e\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf)\n\n\n\n\u30a8\u30e9\u30fc:\n\n\"message too long\"\n\"intended encoded message length too short\"\n\n\n\n\n\u624b\u9806:\n\n\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u30e1\u30c3\u30bb\u30fc\u30b8M\u306b\u9069\u7528\u3057\u3066\u3001\u30cf\u30c3\u30b7\u30e5\u5024 H \u3092\u751f\u6210\u3059\u308b:\nH = Hash(M).\n\n\u3082\u3057\u3001\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u304c \"message too long\" \u3092\u51fa\u529b\u3057\u305f\u3089 \"message too long\" \u3092\u51fa\u529b\u3057\u3066\u505c\u6b62\u3059\u308b\n\n\n\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u5bfe\u5fdc\u3057\u305f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0ID\u3068\u30cf\u30c3\u30b7\u30e5\u5024\u3092 ASN.1\u306e DigestInfo\u578b\u306e\u5024\u3068\u3057\u3066\u8868\u73fe\u3057\u3001DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3059\u308b\u3002\u306a\u304a\u3001DigestInfo\u578b\u306f\u6b21\u306e\u69cb\u9020\u3092\u3057\u3066\u3044\u308b\u3002\nDigestInfo ::= SEQUENCE {\n   digestAlgorithm AlgorithmIdentifier,\n   digest OCTET STRING\n}\n\n\u6700\u521d\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306eID\u3067\u3001\u4e8c\u756a\u76ee\u306f\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u793a\u3057\u3066\u3044\u308b\u3002\n\u3053\u3053\u3067\u3001 \n\nT - DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f DigestInfo\u5024\ntLen - T\u306e\u30d0\u30a4\u30c8\u9577\n\n\u3068\u5b9a\u7fa9\u3059\u308b\u3002\n\n\u3082\u3057\u3001emLen < tLen + 11 \u3067\u3042\u308b\u306a\u3089\u3070\u3001\"intended encoded message length too short\" \u3092\u51fa\u529b\u3057\u3066\u505c\u6b62\u3059\u308b\u3002\n\u9577\u3055 emLen - tLen - 3 \u30d0\u30a4\u30c8\u306e0xff\u5024\u304b\u3089\u306a\u308b\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf PS \u3092\u751f\u6210\u3059\u308b\u3002\u3053\u3053\u3067 PS\u306f\u6700\u4f4e\u3067\u3082 8\u30d0\u30a4\u30c8\u306e\u9577\u3055\u304c\u3042\u308b\u306f\u305a\u3067\u3042\u308b\u3002\n\nPS\u3001DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f T\u3001\u305d\u306e\u4ed6\u306e\u30d1\u30c7\u30a3\u30f3\u30b0\u3092\u7d50\u5408\u3057\u3066\u3001\u4ee5\u4e0b\u306eEM\u3092\u751f\u6210\u3059\u308b\u3002\nEM = 0x00 || 0x01 || PS || 0x00 || T.\n\n\nEM\u3092\u51fa\u529b\u3059\u308b\n\n\n\u30e1\u30e2:\n\n\nAppendix B.1\u3067\u8a00\u53ca\u3057\u3066\u3044\u308b6\u3064\u306e\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u3064\u3044\u3066\u3001DigestInfo\u3092 DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u305f\u5024\u306f\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b:\n\n\nMD2:\n(0x)30 20 30 0c 06 08 2a 86 48 86 f7 0d 02 02 05 00 04 10 || H.\n\n\n\nMD5:\n(0x)30 20 30 0c 06 08 2a 86 48 86 f7 0d 02 05 05 00 04 10 || H.\n\n\n\nSHA-1:\n(0x)30 21 30 09 06 05 2b 0e 03 02 1a 05 00 04 14 || H.\n\n\n\nSHA-256:\n(0x)30 31 30 0d 06 09 60 86 48 01 65 03 04 02 01 05 00 04 20 || H.\n\n\n\nSHA-384:\n(0x)30 41 30 0d 06 09 60 86 48 01 65 03 04 02 02 05 00 04 30 || H.\n\n\n\nSHA-512:\n (0x)30 51 30 0d 06 09 60 86 48 01 65 03 04 02 03 05 00 04 40 || H.\n\n\n\n\n\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u30d0\u30fc\u30b8\u30e7\u30f31.5\u3067\u306f\u3001T\u306fDigestInfo\u5024\u3092DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u305f\u3082\u306e\u3067\u306f\u306a\u304f\u3001BER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u305f\u3082\u306e\u3068\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u305f\u3002\u305d\u306e\u305f\u3081\u3001\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8(\u30d0\u30fc\u30b8\u30e7\u30f32.0)\u3067\u5b9a\u7fa9\u3055\u308c\u308b\u7f72\u540d\u306e\u691c\u8a3c\u51e6\u7406\u306b\u304a\u3044\u3066\u3001PKCS #1 v1.5 \u4ed5\u69d8\u306b\u304a\u3044\u3066\u306f\u6b63\u3057\u3044\u3068\u3055\u308c\u308b\u7f72\u540d\u3092\u62d2\u7d76\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\u4f8b\u3048\u3070\u3001\u9577\u3055\u304c\u4e0d\u5b9a\u306b\u306a\u308b\u30b7\u30fc\u30b1\u30f3\u30b9\u578b\u306e\u30a8\u30f3\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306aDER\u4ee5\u5916\u306e\u30eb\u30fc\u30eb\u304c DigestInfo\u306b\u9069\u7528\u3055\u308c\u305f\u5834\u5408\u306b\u8d77\u3053\u308a\u307e\u3059\u3002\u5b9f\u969b\u306b\u306f\u3053\u306e\u3088\u3046\u306a\u3053\u3068\u304c\u5fc3\u914d\u306b\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u6ce8\u610f\u6df1\u3044\u5b9f\u88c5\u8005\u306f\u3001PKCS #1 v1.5\u3067\u5b9a\u7fa9\u3055\u308c\u305f BER\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u30d9\u30fc\u30b9\u306b\u3057\u305f\u691c\u8a3c\u51e6\u7406\u3092\u63a1\u7528\u3057\u3066\u3082\u69cb\u308f\u306a\u3044\u3002\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u3001PKCS #1 v1.5\u3068\u306e\u4e92\u63db\u6027\u304c\u5f97\u3089\u308c\u308b\u3002\u305d\u306e\u3088\u3046\u306a\u691c\u8a3c\u51e6\u7406\u306f\u3001\u4f7f\u308f\u308c\u3066\u3044\u308bBER\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u304cDER\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u3042\u308a\u3001\u305d\u308c\u3086\u308c\u3001\u7f72\u540d\u304c\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u5b9a\u7fa9\u3055\u308c\u305f\u4ed5\u69d8\u306b\u6cbf\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u660e\u793a\u3059\u3079\u304d\u3067\u3042\u308b\u3002\n\n\n\u7d50\u5c40\u3001\u96fb\u5b50\u7f72\u540d\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u3069\u3046\u306a\u3063\u3066\u308b\u306e\uff1f\n\u4ed5\u69d8\u66f8\u306a\u306e\u3067\u4ed5\u65b9\u306a\u3044\u3067\u3059\u304c\u3001\u3061\u3087\u3063\u3068\u308f\u304b\u308a\u306b\u304f\u3044\u3067\u3059\u3088\u306d\u3002\n\u306a\u306e\u3067\u308f\u304b\u308a\u3084\u3059\u304f\u56f3\u89e3\u3057\u3088\u3046\uff01\u3068\u610f\u6c17\u8fbc\u3093\u3067\u3044\u305f\u3089\u3001\u3059\u3067\u306b\u4f5c\u3063\u3066\u3044\u308b\u65b9\u304c\u3044\u307e\u3057\u305f\uff01 \u3053\u3061\u3089\u306e \u300c\u56f3\u8aacRSA\u7f72\u540d\u306e\u5dfb\u300d\u3068\u3044\u3046\u30da\u30fc\u30b8\u3067\u3059\u3002\u4ed5\u69d8\u66f8\u306e\u5404\u30b9\u30c6\u30c3\u30d7\u3067\u3001\u5177\u4f53\u7684\u306b\u3069\u306e\u3088\u3046\u306a\u51e6\u7406\u304c\u884c\u308f\u308c\u308b\u306e\u304b\u3092\u3001\u308f\u304b\u308a\u3084\u3059\u304f\u56f3\u306b\u3057\u3066\u304f\u308c\u3066\u3044\u307e\u3059\u3002\n\nOpenSSL\u30b3\u30de\u30f3\u30c9\u3068\u306e\u5bfe\u5fdc\n\u3067\u306f\u3001\u4e0a\u8a18\u4ed5\u69d8\u3068\u3001OpenSSL\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u516c\u958b\u9375\u6697\u53f7\u3001\u96fb\u5b50\u7f72\u540d\u306e\u65b9\u6cd5 \u3067\u884c\u3063\u305f OpenSSL\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u7f72\u540d\u51e6\u7406\u3068\u306f\u3069\u3046\u3044\u3046\u95a2\u4fc2\u304c\u3042\u308b\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\n\nopenssl dgst -sha1 -sign \u3068\u306e\u95a2\u4fc2\nopenssl dgst -sha1 -sign \u30b3\u30de\u30f3\u30c9\u306f\u3001\u4e0a\u8a18\u4ed5\u69d8\u306e RSASSA-PKCS1-V1_5-SIGN (K, M) \u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n> openssl dgst -sha1 -sign private-key.pem target.txt > sign.sig\n\n\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3092\u5165\u529b\u3059\u308b\u3068\u3001private-key.pem\u304c K\u3001target.txt\u304c M \u3068\u3057\u3066 RSASSA-PKCS1-V1_5-SIGN (K, M) \u304c\u5b9f\u884c\u3055\u308c\u3001EM\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\nopenssl rsautl -sign \u3068\u306e\u95a2\u4fc2\n\u5b9f\u306f\u3001OpenSSL\u306e\u30b3\u30de\u30f3\u30c9\u306b\u306f\u3082\u3046\u4e00\u3064\u7f72\u540d\u306b\u95a2\u3059\u308b\u30b3\u30de\u30f3\u30c9\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u308c\u304c\u3001 openssl rsautl -sign \u3067\u3059\u3002\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u96fb\u5b50\u7f72\u540d\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n> openssl rsautl -sign -inkey private-key.pem -in target.txt > sign2.sig\n\nsign.sig\u3068 sign2.sig\u306e\u4e2d\u8eab\u3092\u898b\u3066\u307f\u308b\u3068\u3001\u5168\u304f\u5185\u5bb9\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n> hexdump sign.sig \n0000000 ac d0 75 ab 62 06 9a 3a 9b c4 c4 91 40 be 9d 64\n0000010 58 4d 64 af 75 55 35 4f f3 20 c5 de 34 d2 30 af\n0000020 5f db 91 cc 3d 2a ea 86 32 39 7a b0 a3 09 95 ed\n0000030 60 dc 91 1b 1e 14 dd b2 78 65 ed 97 17 fa 05 e5\n0000040 7e eb 4f 64 99 31 1c 8e d8 91 d6 b5 76 c7 df f8\n0000050 6e 1a 32 24 a6 2a 81 5c 52 54 f1 1c de 0a a5 00\n0000060 47 37 ee 8e 8b 57 34 ea 21 f5 d5 b0 e0 6c 84 2b\n0000070 8b a2 2a e9 94 f1 f6 a7 38 0d 9d e7 3e 61 81 93\n0000080\n\n> hexdump sign2.sig \n0000000 6a 5f 9a 7e e5 a0 2b d8 67 3e f7 cf 89 5e 2e 14\n0000010 37 58 74 31 a2 8f 52 b7 28 25 1e ab b5 5c a8 92\n0000020 78 2a c3 66 56 97 9f fa ff da 7b 4a 2c 9a 6b ba\n0000030 34 de 0b ed 52 87 63 0e 11 49 b0 83 cc f2 72 c7\n0000040 e1 4d 96 5c c9 f3 3f d5 cf ec 36 83 15 b6 22 9a\n0000050 a0 d1 09 5f 7a 5b 9a 4c b3 ea cf fe f4 7d 4c b4\n0000060 b1 21 36 99 b9 7e f7 bb 7a d4 77 90 84 0b c4 74\n0000070 f2 d0 60 91 b5 bf 95 01 40 9b 70 4f 5a 0f 09 71\n0000080\n\n\u540c\u3058\u9375\u3067\u3001\u540c\u3058\u30d5\u30a1\u30a4\u30eb\u306b\u5bfe\u3057\u3066\u884c\u3063\u305f\u306e\u306b\u3001\u306a\u305c\u5168\u304f\u9055\u3046\u3082\u306e\u304c\u51fa\u529b\u3055\u308c\u308b\u306e\u3067\u3057\u3087\u3046\uff1f\u5b9f\u306f\u3053\u306e\u9055\u3044\u304c\u96fb\u5b50\u7f72\u540d\u3092\u6271\u3046\u4e0a\u3067\u306e \u975e\u5e38\u306b\u3084\u3063\u304b\u3044\u306a\u7f60 \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4e0a\u8a18\uff12\u3064\u304c\u3069\u3046\u9055\u3046\u306e\u304b\u8abf\u3079\u3066\u307f\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u3069\u3061\u3089\u3082\u304a\u305d\u3089\u304f\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3055\u308c\u305f\u60c5\u5831\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u773a\u3081\u3066\u3044\u3066\u3082\u4f55\u3082\u898b\u3048\u3066\u304d\u307e\u305b\u3093\u3002\u56f0\u308a\u307e\u3057\u305f\u3002\n\u3068\u3053\u308d\u3067\u3001sign2.sign\u3092\u751f\u6210\u3059\u308b\u306e\u306b\u4f7f\u3063\u305f openssl rsautl -sign \u306f\u7f72\u540d\u3092\u751f\u6210\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3059\u304c\u3001\u305d\u308c\u3068\u5bfe\u306b\u306a\u308b\u30b3\u30de\u30f3\u30c9\u306f `openssl rsautl -verify \u3067\u3059\u3002\u8a66\u3057\u306b\u3001\u3053\u308c\u3092\u4e21\u8005\u306b\u5bfe\u3057\u3066\u304b\u3051\u3066\u307f\u307e\u3059\u3002\n> openssl rsautl -verify -pubin -inkey public-key.pem -in sign.sig | hexdump -C\n00000000  30 21 30 09 06 05 2b 0e  03 02 1a 05 00 04 14 ee  |0!0...+.........|\n00000010  fd 5b c2 c5 47 bf 82 b1  77 b6 25 9c 13 f7 72 3d  |.[..G...w.%...r=|\n00000020  c8 76 d9                                          |.v.|\n00000023\n\n> openssl rsautl -verify -pubin -inkey public-key.pem -in sign2.sig | hexdump -C\n00000000  68 6f 67 65 0a                                    |hoge.|\n00000005\n\n\u306a\u3093\u3068\u3001\u4f55\u304b\u304c\u30c7\u30b3\u30fc\u30c9\u3055\u308c\u3066\u30d0\u30a4\u30ca\u30ea\u3068\u3057\u3066\u51fa\u529b\u3055\u308c\u3066\u304d\u307e\u3057\u305f\u3002\n\nsign.sig\u306e\u30c7\u30b3\u30fc\u30c9\u7d50\u679c\u3092\u8aad\u307f\u89e3\u304f\nsign.sig\u3092 verify\u3057\u305f\u7d50\u679c\u3092\u3088\u304f\u898b\u3066\u307f\u308b\u3068\u30010x30 21 30 09 \u3068\u306a\u3063\u3066\u3044\u3066\u3001\u5148\u307b\u3069 9.2 EMSA-PKCS1-v1_5 \u306e\u3068\u3053\u308d\u3067\u51fa\u3066\u304d\u305f\u3001SHA-1\u306e DigestInfo\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u3002\n\u3064\u307e\u308a\u3001\n00000000  30 21 30 09 06 05 2b 0e  03 02 1a 05 00 04 14\n\n\u307e\u3067\u304cSHA-1\u306eAlgorithmIdentifier(\u306eDER\u30a8\u30f3\u30b3\u30fc\u30c9)\u3067\u3001\n00000000                                                ee\n00000010  fd 5b c2 c5 47 bf 82 b1  77 b6 25 9c 13 f7 72 3d\n00000020  c8 76 d9\n\n\u306e20\u30d0\u30a4\u30c8\u304c H\u3001\u3064\u307e\u308a\u5b9f\u969b\u306eSHA-1\u30cf\u30c3\u30b7\u30e5\u5024\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u5b9f\u969b\u3001target.txt\u306eSHA-1\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\u3057\u3066\u307f\u308b\u3068\u3001\n> shasum target.txt \neefd5bc2c547bf82b177b6259c13f7723dc876d9  target.txt\n\n\u3068\u306a\u3063\u3066\u3044\u3066\u3001\u78ba\u304b\u306b\u3001SHA-1\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u3002\n\nsign2.sig\u306e\u30c7\u30b3\u30fc\u30c9\u7d50\u679c\u3092\u8aad\u307f\u89e3\u304f\n\u4e00\u65b9\u3001sign2.sig\u306e\u65b9\u306f\u3001\u660e\u3089\u304b\u306b\u7f72\u540d\u306b\u5165\u529b\u3057\u305f\u60c5\u5831\u305d\u306e\u3082\u306e\u3067\u3059\u3002\u305d\u306e\u3082\u306e\u304c\u898b\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u30c0\u30a4\u30b8\u30a7\u30b9\u30c8\u95a2\u6570\u3059\u3089\u304b\u3051\u3089\u308c\u3066\u3044\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\nopenssl rsautl -sign \u306e\u6b63\u4f53\n\u3053\u306e\u6319\u52d5\u304b\u3089\u63a8\u6e2c\u3059\u308b\u3068\u3001openssl rsautl -sign \u306f\u3001RSASSA-PKCS1-V1_5-SIGN\u306e\u51e6\u7406\u306e T \u3092\u76f4\u63a5\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4e0e\u3048\u305f\u3088\u3046\u306a\u52d5\u4f5c\u3092\u3057\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u3002\n\u307e\u305f\u3001openssl rsautl -verify\u306f\u7f72\u540d\u3092\u516c\u958b\u9375\u3067\u5e73\u6587\u5316\u3057\u3001\u7d50\u679c\u304c\u4ee5\u4e0b\u306eEM\u306e\u69cb\u9020\u3092\u3057\u3066\u3044\u308b\u3068\u89e3\u91c8\u3057\u3001T\u3092\u51fa\u529b\u3059\u308b\u30b3\u30de\u30f3\u30c9\u306e\u3088\u3046\u3067\u3059\u3002\nEM = 0x00 || 0x01 || PS || 0x00 || T\n\n\niOS/Mac\u306e Security Framework\u3068\u306e\u95a2\u4fc2\niOS\u306e Security Framework\u3067\u306f SecKeyRawSign() \u3084 SecKeyRawVerify() \u95a2\u6570\u3067\u96fb\u5b50\u7f72\u540d\u3092\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u305d\u306e\u969b\u3001\u30d1\u30c7\u30a3\u30f3\u30b0\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u3057\u3066\u4ee5\u4e0b\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nkSecPaddingNone\n\n\nNo padding.\n\n\nkSecPaddingPKCS1\n\n\nPKCS1 padding.\n\n\nkSecPaddingPKCS1MD2\n\n\nData to be signed is an MD2 hash.\nStandard ASN.1 padding is done, as well as PKCS1 padding of the underlying RSA operation. Used with SecKeyRawSign and SecKeyRawVerify only.\n\n\nkSecPaddingPKCS1MD5\n\n\nData to be signed is an MD5 hash.\nStandard ASN.1 padding is done, as well as PKCS1 padding of the underlying RSA operation. Used with SecKeyRawSign and SecKeyRawVerify only.\n\n\nkSecPaddingPKCS1SHA1\n\n\nData to be signed is a SHA1 hash.\nStandard ASN.1 padding will be done, as well as PKCS1 padding of the underlying RSA operation. Used with SecKeyRawSign and SecKeyRawVerify only.\n\n\n\n\u203b \u516c\u5f0f\u30b5\u30a4\u30c8\u304b\u3089\u5f15\u7528\n\nkSecPaddingPKCS1SHA1 \u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\n\u7d50\u8ad6\u304b\u3089\u8a00\u3046\u3068\u3001kSecPaddingPKCS1SHA1\u306e\u6307\u5b9a\u306f\u3001 openssl dgst -sha1 -sign\u30b3\u30de\u30f3\u30c9\u3068\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\u3064\u307e\u308a\u3001\nEM = 0x00 || 0x01 || PS || 0x00 || T\n\u305f\u3060\u3057\u3001 T  = A || H\n        A  = (0x)30 21 30 09 06 05 2b 0e 03 02 1a 05 00 04 14\n\n\u306eEM\u3092\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3057\u305f\u3082\u306e\u304c\u7f72\u540d\u3068\u3057\u3066\u5229\u7528\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u6642\u3001SecKeyRawSign()/SecKeyRawVerify()\u306e\u5165\u529b\u306f H \u3067\u3059\u3002PS\u3084A\u306f\u95a2\u6570\u304c\u52dd\u624b\u306b\u51e6\u7406\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\nkSecPaddingPKCS1 \u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\n\u3053\u306e\u5834\u5408\u3001\u4e0a\u8a18 kSecPaddingPKCS1SHA1 \u306e\u51e6\u7406\u304b\u3089 A\u306b\u95a2\u3059\u308b\u51e6\u7406\u304c\u884c\u308f\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u3064\u307e\u308a\u3001\nEM = 0x00 || 0x01 || PS || 0x00 || T\n\n\u306eEM\u3092\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3057\u305f\u3082\u306e\u304c\u7f72\u540d\u3068\u3057\u3066\u5229\u7528\u3055\u308c\u308b\u306e\u306f\u540c\u3058\u3067\u3059\u304c\u3001SecKeyRawSign()/SecKeyRawVerify()\u306e\u5165\u529b\u304c\u751f\u306eT\u3067\u3042\u308b\u3068\u89e3\u91c8\u3055\u308c\u3001A\u3092\u4ed8\u4e0e\u3059\u308b\u51e6\u7406\u304c\u884c\u308f\u308c\u307e\u305b\u3093\u3002\n\u3053\u306e\u6319\u52d5\u306f openssl rsautl -sign\u3084 openssl rsautl -verify \u306e\u52d5\u4f5c\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u3002\n\nkSecPaddingNone \u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\n\u3061\u3083\u3093\u3068\u8a66\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u3053\u306e\u5834\u5408\u3001PS\u306b\u95a2\u3059\u308b\u51e6\u7406\u3082\u884c\u308f\u308c\u305a\u3001SecKeyRawSign()/SecKeyRawVerify()\u306e\u5165\u529b\u304c EM\u81ea\u4f53\u3067\u3042\u308b\u3068\u89e3\u91c8\u3055\u308c\u308b\u306e\u3060\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u306a\u305c\u3053\u3093\u306a\u30d0\u30ea\u30a8\u30fc\u30b7\u30e7\u30f3\u304c\u3042\u308b\u306e\u304b\uff1f\n\u53c2\u8003\u30b5\u30a4\u30c8\u306b\u30ea\u30f3\u30af\u3057\u305f StackOverFlow\u306e\u56de\u7b54\u306b\u3088\u308b\u3068\u3001A\u306e\u30d1\u30c7\u30a3\u30f3\u30b0\u3092\u30d0\u30a4\u30d1\u30b9\u3059\u308b\u51e6\u7406\u306f\u3001SSL/TLS\u306e\u51e6\u7406\u3067\u5fc5\u8981\u306b\u306a\u308b\u3093\u3060\u305d\u3046\u3067\u3059\u3002\u3053\u306e\u8fba\u306f\u3053\u308c\u4ee5\u4e0a\u8abf\u3079\u3066\u3044\u306a\u3044\u306e\u3067\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u3002\n\nJava\u306e JCE\u3068\u306e\u95a2\u4fc2\nJCE\u306e Signature\u30af\u30e9\u30b9\u306e\u4ed5\u69d8\u306b\u3088\u308b\u3068\u3001\u5b9f\u88c5\u30af\u30e9\u30b9\u306f\u7f72\u540d\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\uff13\u3064\u306f\u5fc5\u305a\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3068\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\nSHA1withDSA\nSHA1withRSA\nSHA256withRSA\n\n\u3053\u306e\u3046\u3061\u3001SHA1withRSA\u3068\u3044\u3046\u306e\u304c iOS\u306e kSecPaddingPKCS1SHA1\u3084\u3001OpenSSL\u30b3\u30de\u30f3\u30c9\u306e openssl dgst -sha1 -sign \u3068\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u30b5\u30a4\u30c8\n\nWhat is the difference between the different padding types on iOS? - StackOverFlow\n\n\n# \u96fb\u5b50\u7f72\u540d\u306e\u30d5\u30a1\u30a4\u30eb\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\nOpenSSL\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u3066\u96fb\u5b50\u7f72\u540d\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u306f\u3001[OpenSSL\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u516c\u958b\u9375\u6697\u53f7\u3001\u96fb\u5b50\u7f72\u540d\u306e\u65b9\u6cd5](http://qiita.com/kunichiko/items/3c0b1a2915e9dacbd4c1) \u3067\u89e3\u8aac\u3057\u307e\u3057\u305f\u3002\n\n\u305d\u306e\u30b3\u30de\u30f3\u30c9\u3067\u751f\u6210\u3055\u308c\u305f ``sign.sig`` \u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u306f\u4e00\u4f53\u306a\u3093\u306a\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\u3068\u3044\u3046\u306e\u3092\u307e\u3068\u3081\u305f\u306e\u304c\u3053\u306e\u30a8\u30f3\u30c8\u30ea\u3067\u3059\u3002\n\n\n## \u96fb\u5b50\u7f72\u540d\u306b\u95a2\u3059\u308b\u4ed5\u69d8\n\n[RSA\u6697\u53f7\u306e\u5168\u4f53\u50cf](http://qiita.com/kunichiko/items/7796ecfb88a62ce26b36)\u3067\u89e3\u8aac\u3057\u305f\u3088\u3046\u306b\u3001\u516c\u958b\u9375\u6697\u53f7\u306b\u95a2\u3059\u308b\u4ed5\u69d8\u306f PKCS\u3068\u3044\u3046\u898f\u683c\u7fa4\u306b\u307e\u3068\u3081\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u96fb\u5b50\u7f72\u540d\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3082 PKCS #1\u306b\u898f\u5b9a\u304c\u3042\u308a\u307e\u3059\u3002PKCS #1\u306f [RFC 3447](https://tools.ietf.org/html/rfc3447)\u3068\u3057\u3066\u516c\u958b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u7121\u6599\u3067\u8aad\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u307e\u305f\u3001PKCS #7\u306b\u3082\u96fb\u5b50\u7f72\u540d\u306b\u95a2\u3059\u308b\u8a18\u8ff0\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002\u3053\u3061\u3089\u306f\u307e\u3060\u3061\u3083\u3093\u3068\u8aad\u3081\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u3069\u3046\u3084\u3089\u3001\u7f72\u540d\u81ea\u4f53\u3092\u5143\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306b\u6dfb\u4ed8\u3059\u308b\u65b9\u6cd5\u306a\u3069\u306b\u3064\u3044\u3066\u898f\u5b9a\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u3067\u3059\u306e\u3067\u3001\u96fb\u5b50\u7f72\u540d\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u3064\u3044\u3066\u306f\u3001\u307e\u305a\u306f PKCS #1\u3092\u898b\u308b\u306e\u304c\u5148\u6c7a\u3067\u3059\u3002\n\n# PKCS #1 \u304b\u3089\u96fb\u5b50\u7f72\u540d\u306e\u4ed5\u69d8\u3092\u8aad\u307f\u89e3\u304f\n\n## \u300c8 Signature schemes with appendix\u300d\n\nSection 8\u306b\u3001\u7f72\u540d\u306e\u30b9\u30ad\u30fc\u30e0\u306b\u3064\u3044\u3066\u306e\u8aac\u660e\u304c\u3042\u308a\u307e\u3059\u3002 with appendix \u306f\u76f4\u8a33\u3059\u308b\u3068\u300c\u4ed8\u52a0\u60c5\u5831\u4ed8\u304d\u300d\u3068\u3044\u3046\u610f\u5473\u3067\u3059\u304c\u3001\u304a\u305d\u3089\u304f\u3001\u7f72\u540d\u3092\u691c\u8a3c\u3059\u308b\u305f\u3081\u306e\u4ed8\u52a0\u60c5\u5831\u304c\u3064\u3044\u3066\u3044\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u3092\u8a00\u3044\u305f\u3044\u306b\u3060\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3053\u306e\u8aac\u660e\u306b\u3088\u308b\u3068\u3001\u96fb\u5b50\u7f72\u540d\u306b\u306f\u4ee5\u4e0b\u306e\uff12\u3064\u306e\u30b9\u30ad\u30fc\u30e0\u304c\u3042\u308b\u3088\u3046\u3067\u3059\u3002\n\n- RSASSA-PSS\n- RSASSA-PKCS1-v1_5\n\n\u3053\u308c\u3089\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8aac\u660e\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n> Although no attacks are known against RSASSA-PKCS1-v1_5, in the interest of increased robustness, RSASSA-PSS is recommended for eventual adoption in new applications.\n\n(\u9069\u5f53\u8a33)\n> RSASSA-PKCS1-v1_5\u306b\u5bfe\u3059\u308b\u6709\u52b9\u306a\u653b\u6483\u306f\u77e5\u3089\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u65b0\u3057\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u5805\u7262\u6027\u3092\u5411\u4e0a\u3055\u305b\u308b\u76ee\u7684\u3067 RSASSA-PSS\u3092\u63a1\u629e\u3059\u308b\u3053\u3068\u3092\u63a8\u5968\u3057\u307e\u3059\u3002\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001RSASSA-PSS\u304c\u3068\u3066\u3082\u826f\u3044\u3082\u306e\u306e\u3088\u3046\u306b\u8aad\u3081\u307e\u3059\u304c\u3001\u6b8b\u5ff5\u306a\u304c\u3089 openssl\u304c\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u306f RSASSA-PKCS1-v1_5 \u306e\u65b9\u306e\u3088\u3046\u3067\u3059\u3002PSS\u306e\u65b9\u306e\u4ed5\u69d8\u3092\u8aad\u3093\u3067\u307f\u308b\u3068\u3001\u5272\u3068\u3081\u3093\u3069\u3063\u3061\u3044\u3053\u3068\u304c\u3044\u308d\u3044\u308d\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u7279\u306b\u554f\u984c\u306a\u3044\u306a\u3089 v1_5\u306e\u307e\u307e\u3067\u3044\u3044\u3088\u306d\u3063\u3066\u611f\u3058\u306a\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u5b9f\u969b\u3001OpenSSL\u4ee5\u5916\u306e\u6697\u53f7\u5316\u30e9\u30a4\u30d6\u30e9\u30ea\u306a\u3069\u3082 v1_5\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u308b\u3082\u306e\u304c\u307b\u3068\u3093\u3069\u306e\u3088\u3046\u3067\u3059\u3002\u306a\u306e\u3067\u3053\u3053\u304b\u3089\u306f RSASSA-PSS\u306e\u3053\u3068\u306f\u5fd8\u308c\u3066\u3001v1_5\u306e\u65b9\u3060\u3051\u898b\u3066\u3044\u304d\u307e\u3059\u3002\n\n## \u300c8.2.1 Signature generation operation\u300d\n\n8.2.1\u306b\u3001RSASSA-PKCS1-v1_5 \u306e\u7f72\u540d\u751f\u6210\u51e6\u7406\u306e\u8a73\u7d30\u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u9069\u5f53\u306b\u8a33\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n### RSASSA-PKCS1-V1_5-SIGN (K, M)\n- \u5165\u529b:\n\t- K - \u7f72\u540d\u8005\u306e\u79d8\u5bc6\u9375\n\t- M - \u7f72\u540d\u5bfe\u8c61\u306e\u30e1\u30c3\u30bb\u30fc\u30b8(\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf)\n\n- \u51fa\u529b:\n\t- S - \u7f72\u540d(\u9577\u3055k\u306e\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf)\u3002k\u306f RSA\u30e2\u30b8\u30e5\u30fc\u30eb\u306e n\u4ee5\u4e0b\u306e\u9577\u3055(?)\n\n- \u30a8\u30e9\u30fc:\n\t- \"message too long\"\n\t- \"RSA modulus too short\"\n\n####\u624b\u9806:\n\n1. EMSA-PKCS1-v1_5 \u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u884c\u3046\n\n\t\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u3082\u306e\u3092EM\u3068\u3059\u308b\u3002\u30a8\u30f3\u30b3\u30fc\u30c9\u306e\u8a73\u7d30\u306f9.2\u3067\u8aac\u660e\u3002\n\t\n\t\tEM = EMSA-PKCS1-V1_5-ENCODE (M, k).\n\n2.\tRSA\u7f72\u540d\u3092\u884c\u3046\n\n\ta. 4.2\u3067\u5b9a\u7fa9\u3055\u308c\u305fOS2IP\u3092\u4f7f\u3063\u3066\u3001\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8EM\u3092\u6574\u6570\u5024 m\u306b\u5909\u63db\u3059\u308b\u3002(\u8a33\u6ce8:OS2IP\u306f\u3001\u5358\u306b\u30d0\u30a4\u30ca\u30ea\u5217\u3092\u7b26\u53f7\u306a\u3057\u306e\u5de8\u5927\u306a\u30d3\u30c3\u30b0\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\u306e\u6574\u6570\u5024\u3068\u307f\u306a\u3059\u3068\u3044\u3046\u3060\u3051\u3067\u3059)\n\n    \tm = OS2IP (EM).\n\n\tb. RSA\u79d8\u5bc6\u9375 K\u3068\u30e1\u30c3\u30bb\u30fc\u30b8 m \u3092 RSAAP1\u306b\u9069\u7528\u3057\u3001\u6574\u6570\u5024\u306e\u7f72\u540d\u5024 s\u3092\u751f\u6210\u3059\u308b(5.2.1\u7bc0\u53c2\u7167)(\u8a33\u6ce8:\u5358\u306b\u3001\u79d8\u5bc6\u9375K\u3067m\u3092\u6697\u53f7\u5316\u3059\u308b\u51e6\u7406\u3068\u601d\u308f\u308c\u307e\u3059)\n\n\t\ts = RSASP1 (K, m).\n\n\tc. 4.1\u3067\u5b9a\u7fa9\u3055\u308c\u305fI2OSP\u3092\u3064\u304b\u3063\u3066\u3001\u7f72\u540d\u5024 s\u3092\u9577\u3055 k\u306e\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u306b\u5909\u63db\u3059\u308b\u3002(\u8a33\u6ce8:I2OSP\u306f\u3001\u5358\u306b\u6b63\u306e\u6574\u6570\u5024\u3092\u7b26\u53f7\u306a\u3057k\u30d0\u30a4\u30c8\u306e\u30d3\u30c3\u30b0\u30a8\u30f3\u30c7\u30a3\u30a2\u30f3\u3067\u66f8\u304d\u51fa\u3059\u51e6\u7406\u3067\u3059)\n\n\t\tS = I2OSP (s, k).\n\n3. \u7f72\u540d S\u3092\u51fa\u529b\u3059\u308b\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u30012\u306f\u5358\u306b\u300c\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3059\u308b\u300d\u51e6\u7406\u3092\u53b3\u5bc6\u306b\u66f8\u3044\u3066\u3044\u308b\u3060\u3051\u306a\u306e\u3067\u3001\u554f\u984c\u306f1\u306e EMSA-PKCS-V1_5-ENCODE \u306e\u51e6\u7406\u304c\u306a\u3093\u306a\u306e\u304b\u3068\u3044\u3046\u3068\u3053\u308d\u306b\u7d5e\u3089\u308c\u307e\u3059\u3002\u3053\u308c\u306f 9.2\u7bc0\u3092\u898b\u3066\u307f\u308c\u3070\u308f\u304b\u308a\u307e\u3059\u3002\n\n## \u300c8.2.2 Signature verification operation\u300d\n\n8.2.2\u3067\u306f\u30018.2.1\u3067\u898f\u5b9a\u3055\u308c\u305f RSASSA-PKCS1-V1_5-SIGN \u306e\u9006\u51e6\u7406\u3001RSASSA-PKCS1-V1_5-VERIFY \u306e\u52d5\u4f5c\u304c\u898f\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n## \u300c9.2 EMSA-PKCS1-v1_5\u300d\n\n8.2.1\u306eRSASSA-PKCS1-V1_5-SIGN \u3067\u4f7f\u308f\u308c\u3066\u3044\u308b EMSA-PKCS1-v1_5-ENCODE \u306e\u4ed5\u69d8\u304c\u66f8\u304b\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u3053\u3061\u3089\u3082\u8a33\u3057\u3066\u307f\u307e\u3059\u3002\n\n### EMSA-PKCS1-v1_5-ENCODE (M, emLen)\n\n- \u30aa\u30d7\u30b7\u30e7\u30f3\n\t- Hash - \u30cf\u30c3\u30b7\u30e5\u95a2\u6570 (hLen \u306f\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u304c\u51fa\u529b\u3059\u308b\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u30d0\u30a4\u30c8\u9577\u3092\u8868\u3059)\n\n- \u5165\u529b:\n\t- M - \u30a8\u30f3\u30b3\u30fc\u30c9\u3059\u308b\u30e1\u30c3\u30bb\u30fc\u30b8\n\t- emLen - \u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8(EM)\u306e\u9577\u3055\u3002\u6700\u4f4e\u3067\u3082 tLen + 11 \u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u3053\u3053\u3067\u3001tLen\u306f\u3001\u30a8\u30f3\u30b3\u30fc\u30c9\u51e6\u7406\u306e\u904e\u7a0b\u3067\u751f\u6210\u3055\u308c\u308bT\u3092 DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u305f\u30d0\u30a4\u30c8\u9577\u3067\u3042\u308b\u3002(\u8a33\u6ce8: \u3053\u306e\u30a8\u30f3\u30b3\u30fc\u30c9\u30e1\u30bd\u30c3\u30c9\u3067\u306f\u30d1\u30c7\u30a3\u30f3\u30b0\u306b\u3088\u3063\u3066\u9577\u3055\u3092\u8abf\u6574\u3067\u304d\u308b\u306e\u3067\u3001emLen\u306b\u597d\u304d\u306a\u9577\u3055\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002\u305f\u3060\u3057\u3001\u77ed\u3059\u304e\u308b\u3068\u5165\u308a\u304d\u3089\u306a\u3044\u306e\u3067\u30c0\u30e1\u3067\u3059\u3088\u3001\u3068\u3044\u3046\u3053\u3068)\n\n- \u51fa\u529b:\n\t- EM - \u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30e1\u30c3\u30bb\u30fc\u30b8(\u9577\u3055 emLen\u306e\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf)\n- \u30a8\u30e9\u30fc:\n\t- \"message too long\"\n\t- \"intended encoded message length too short\"\n\n#### \u624b\u9806:\n\n1. \u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u30e1\u30c3\u30bb\u30fc\u30b8M\u306b\u9069\u7528\u3057\u3066\u3001\u30cf\u30c3\u30b7\u30e5\u5024 H \u3092\u751f\u6210\u3059\u308b:\n\n\t\tH = Hash(M).\n\n\t\u3082\u3057\u3001\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u304c \"message too long\" \u3092\u51fa\u529b\u3057\u305f\u3089 \"message too long\" \u3092\u51fa\u529b\u3057\u3066\u505c\u6b62\u3059\u308b\n\n2. \u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u5bfe\u5fdc\u3057\u305f\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0ID\u3068\u30cf\u30c3\u30b7\u30e5\u5024\u3092 ASN.1\u306e DigestInfo\u578b\u306e\u5024\u3068\u3057\u3066\u8868\u73fe\u3057\u3001DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3059\u308b\u3002\u306a\u304a\u3001DigestInfo\u578b\u306f\u6b21\u306e\u69cb\u9020\u3092\u3057\u3066\u3044\u308b\u3002\n\n\t\tDigestInfo ::= SEQUENCE {\n\t\t   digestAlgorithm AlgorithmIdentifier,\n\t\t   digest OCTET STRING\n\t\t}\n\n\t\u6700\u521d\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306eID\u3067\u3001\u4e8c\u756a\u76ee\u306f\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u793a\u3057\u3066\u3044\u308b\u3002\n\n\t\u3053\u3053\u3067\u3001 \n\t- T - DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f DigestInfo\u5024\n\t- tLen - T\u306e\u30d0\u30a4\u30c8\u9577\n\n\t\u3068\u5b9a\u7fa9\u3059\u308b\u3002\n\n3. \u3082\u3057\u3001emLen < tLen + 11 \u3067\u3042\u308b\u306a\u3089\u3070\u3001\"intended encoded message length too short\" \u3092\u51fa\u529b\u3057\u3066\u505c\u6b62\u3059\u308b\u3002\n\n4. \u9577\u3055 emLen - tLen - 3 \u30d0\u30a4\u30c8\u306e0xff\u5024\u304b\u3089\u306a\u308b\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf PS \u3092\u751f\u6210\u3059\u308b\u3002\u3053\u3053\u3067 PS\u306f\u6700\u4f4e\u3067\u3082 8\u30d0\u30a4\u30c8\u306e\u9577\u3055\u304c\u3042\u308b\u306f\u305a\u3067\u3042\u308b\u3002\n\n5. PS\u3001DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f T\u3001\u305d\u306e\u4ed6\u306e\u30d1\u30c7\u30a3\u30f3\u30b0\u3092\u7d50\u5408\u3057\u3066\u3001\u4ee5\u4e0b\u306eEM\u3092\u751f\u6210\u3059\u308b\u3002\n\n\t\tEM = 0x00 || 0x01 || PS || 0x00 || T.\n\n6. EM\u3092\u51fa\u529b\u3059\u308b\n\n\n#### \u30e1\u30e2:\n\n1. Appendix B.1\u3067\u8a00\u53ca\u3057\u3066\u3044\u308b6\u3064\u306e\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306b\u3064\u3044\u3066\u3001DigestInfo\u3092 DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u305f\u5024\u306f\u305d\u308c\u305e\u308c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308b:\n\t- MD2:\n\n\t\t\t(0x)30 20 30 0c 06 08 2a 86 48 86 f7 0d 02 02 05 00 04 10 || H.\n\t- MD5:\n\n\t\t\t(0x)30 20 30 0c 06 08 2a 86 48 86 f7 0d 02 05 05 00 04 10 || H.\n\t- SHA-1:\n\t \n\t\t\t(0x)30 21 30 09 06 05 2b 0e 03 02 1a 05 00 04 14 || H.\n\t- SHA-256:\n\n\t\t\t(0x)30 31 30 0d 06 09 60 86 48 01 65 03 04 02 01 05 00 04 20 || H.\n\t- SHA-384:\n\n\t\t\t(0x)30 41 30 0d 06 09 60 86 48 01 65 03 04 02 02 05 00 04 30 || H.\n\t- SHA-512:\n\n\t\t\t (0x)30 51 30 0d 06 09 60 86 48 01 65 03 04 02 03 05 00 04 40 || H.\n\n2. \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u30d0\u30fc\u30b8\u30e7\u30f31.5\u3067\u306f\u3001T\u306fDigestInfo\u5024\u3092DER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u305f\u3082\u306e\u3067\u306f\u306a\u304f\u3001BER\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u305f\u3082\u306e\u3068\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u305f\u3002\u305d\u306e\u305f\u3081\u3001\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8(\u30d0\u30fc\u30b8\u30e7\u30f32.0)\u3067\u5b9a\u7fa9\u3055\u308c\u308b\u7f72\u540d\u306e\u691c\u8a3c\u51e6\u7406\u306b\u304a\u3044\u3066\u3001PKCS #1 v1.5 \u4ed5\u69d8\u306b\u304a\u3044\u3066\u306f\u6b63\u3057\u3044\u3068\u3055\u308c\u308b\u7f72\u540d\u3092\u62d2\u7d76\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\u4f8b\u3048\u3070\u3001\u9577\u3055\u304c\u4e0d\u5b9a\u306b\u306a\u308b\u30b7\u30fc\u30b1\u30f3\u30b9\u578b\u306e\u30a8\u30f3\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306aDER\u4ee5\u5916\u306e\u30eb\u30fc\u30eb\u304c DigestInfo\u306b\u9069\u7528\u3055\u308c\u305f\u5834\u5408\u306b\u8d77\u3053\u308a\u307e\u3059\u3002\u5b9f\u969b\u306b\u306f\u3053\u306e\u3088\u3046\u306a\u3053\u3068\u304c\u5fc3\u914d\u306b\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u6ce8\u610f\u6df1\u3044\u5b9f\u88c5\u8005\u306f\u3001PKCS #1 v1.5\u3067\u5b9a\u7fa9\u3055\u308c\u305f BER\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u30d9\u30fc\u30b9\u306b\u3057\u305f\u691c\u8a3c\u51e6\u7406\u3092\u63a1\u7528\u3057\u3066\u3082\u69cb\u308f\u306a\u3044\u3002\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u3001PKCS #1 v1.5\u3068\u306e\u4e92\u63db\u6027\u304c\u5f97\u3089\u308c\u308b\u3002\u305d\u306e\u3088\u3046\u306a\u691c\u8a3c\u51e6\u7406\u306f\u3001\u4f7f\u308f\u308c\u3066\u3044\u308bBER\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u304cDER\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3067\u3042\u308a\u3001\u305d\u308c\u3086\u308c\u3001\u7f72\u540d\u304c\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u5b9a\u7fa9\u3055\u308c\u305f\u4ed5\u69d8\u306b\u6cbf\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u660e\u793a\u3059\u3079\u304d\u3067\u3042\u308b\u3002\n\n# \u7d50\u5c40\u3001\u96fb\u5b50\u7f72\u540d\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u3069\u3046\u306a\u3063\u3066\u308b\u306e\uff1f\n\n\u4ed5\u69d8\u66f8\u306a\u306e\u3067\u4ed5\u65b9\u306a\u3044\u3067\u3059\u304c\u3001\u3061\u3087\u3063\u3068\u308f\u304b\u308a\u306b\u304f\u3044\u3067\u3059\u3088\u306d\u3002\n\n\u306a\u306e\u3067\u308f\u304b\u308a\u3084\u3059\u304f\u56f3\u89e3\u3057\u3088\u3046\uff01\u3068\u610f\u6c17\u8fbc\u3093\u3067\u3044\u305f\u3089\u3001\u3059\u3067\u306b\u4f5c\u3063\u3066\u3044\u308b\u65b9\u304c\u3044\u307e\u3057\u305f\uff01 \u3053\u3061\u3089\u306e \u300c[\u56f3\u8aacRSA\u7f72\u540d\u306e\u5dfb](http://blog.livedoor.jp/k_urushima/archives/979220.html)\u300d\u3068\u3044\u3046\u30da\u30fc\u30b8\u3067\u3059\u3002\u4ed5\u69d8\u66f8\u306e\u5404\u30b9\u30c6\u30c3\u30d7\u3067\u3001\u5177\u4f53\u7684\u306b\u3069\u306e\u3088\u3046\u306a\u51e6\u7406\u304c\u884c\u308f\u308c\u308b\u306e\u304b\u3092\u3001\u308f\u304b\u308a\u3084\u3059\u304f\u56f3\u306b\u3057\u3066\u304f\u308c\u3066\u3044\u307e\u3059\u3002\n\n# OpenSSL\u30b3\u30de\u30f3\u30c9\u3068\u306e\u5bfe\u5fdc\n\n\u3067\u306f\u3001\u4e0a\u8a18\u4ed5\u69d8\u3068\u3001[OpenSSL\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u516c\u958b\u9375\u6697\u53f7\u3001\u96fb\u5b50\u7f72\u540d\u306e\u65b9\u6cd5](http://qiita.com/kunichiko/items/3c0b1a2915e9dacbd4c1) \u3067\u884c\u3063\u305f OpenSSL\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u7f72\u540d\u51e6\u7406\u3068\u306f\u3069\u3046\u3044\u3046\u95a2\u4fc2\u304c\u3042\u308b\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\n\n## openssl dgst -sha1 -sign \u3068\u306e\u95a2\u4fc2\n\n``openssl dgst -sha1 -sign`` \u30b3\u30de\u30f3\u30c9\u306f\u3001\u4e0a\u8a18\u4ed5\u69d8\u306e ```RSASSA-PKCS1-V1_5-SIGN (K, M)``` \u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\n```\n> openssl dgst -sha1 -sign private-key.pem target.txt > sign.sig\n```\n\n\u3068\u3044\u3046\u30b3\u30de\u30f3\u30c9\u3092\u5165\u529b\u3059\u308b\u3068\u3001private-key.pem\u304c K\u3001target.txt\u304c M \u3068\u3057\u3066 ```RSASSA-PKCS1-V1_5-SIGN (K, M)``` \u304c\u5b9f\u884c\u3055\u308c\u3001EM\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n## openssl rsautl -sign \u3068\u306e\u95a2\u4fc2\n\n\u5b9f\u306f\u3001OpenSSL\u306e\u30b3\u30de\u30f3\u30c9\u306b\u306f\u3082\u3046\u4e00\u3064\u7f72\u540d\u306b\u95a2\u3059\u308b\u30b3\u30de\u30f3\u30c9\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u308c\u304c\u3001 ```openssl rsautl -sign``` \u3067\u3059\u3002\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u96fb\u5b50\u7f72\u540d\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n```\n> openssl rsautl -sign -inkey private-key.pem -in target.txt > sign2.sig\n```\n\nsign.sig\u3068 sign2.sig\u306e\u4e2d\u8eab\u3092\u898b\u3066\u307f\u308b\u3068\u3001\u5168\u304f\u5185\u5bb9\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n```\n> hexdump sign.sig \n0000000 ac d0 75 ab 62 06 9a 3a 9b c4 c4 91 40 be 9d 64\n0000010 58 4d 64 af 75 55 35 4f f3 20 c5 de 34 d2 30 af\n0000020 5f db 91 cc 3d 2a ea 86 32 39 7a b0 a3 09 95 ed\n0000030 60 dc 91 1b 1e 14 dd b2 78 65 ed 97 17 fa 05 e5\n0000040 7e eb 4f 64 99 31 1c 8e d8 91 d6 b5 76 c7 df f8\n0000050 6e 1a 32 24 a6 2a 81 5c 52 54 f1 1c de 0a a5 00\n0000060 47 37 ee 8e 8b 57 34 ea 21 f5 d5 b0 e0 6c 84 2b\n0000070 8b a2 2a e9 94 f1 f6 a7 38 0d 9d e7 3e 61 81 93\n0000080\n```\n\n```\n> hexdump sign2.sig \n0000000 6a 5f 9a 7e e5 a0 2b d8 67 3e f7 cf 89 5e 2e 14\n0000010 37 58 74 31 a2 8f 52 b7 28 25 1e ab b5 5c a8 92\n0000020 78 2a c3 66 56 97 9f fa ff da 7b 4a 2c 9a 6b ba\n0000030 34 de 0b ed 52 87 63 0e 11 49 b0 83 cc f2 72 c7\n0000040 e1 4d 96 5c c9 f3 3f d5 cf ec 36 83 15 b6 22 9a\n0000050 a0 d1 09 5f 7a 5b 9a 4c b3 ea cf fe f4 7d 4c b4\n0000060 b1 21 36 99 b9 7e f7 bb 7a d4 77 90 84 0b c4 74\n0000070 f2 d0 60 91 b5 bf 95 01 40 9b 70 4f 5a 0f 09 71\n0000080\n```\n\n\u540c\u3058\u9375\u3067\u3001\u540c\u3058\u30d5\u30a1\u30a4\u30eb\u306b\u5bfe\u3057\u3066\u884c\u3063\u305f\u306e\u306b\u3001\u306a\u305c\u5168\u304f\u9055\u3046\u3082\u306e\u304c\u51fa\u529b\u3055\u308c\u308b\u306e\u3067\u3057\u3087\u3046\uff1f\u5b9f\u306f\u3053\u306e\u9055\u3044\u304c\u96fb\u5b50\u7f72\u540d\u3092\u6271\u3046\u4e0a\u3067\u306e **\u975e\u5e38\u306b\u3084\u3063\u304b\u3044\u306a\u7f60** \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u4e0a\u8a18\uff12\u3064\u304c\u3069\u3046\u9055\u3046\u306e\u304b\u8abf\u3079\u3066\u307f\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3059\u304c\u3001\u3069\u3061\u3089\u3082\u304a\u305d\u3089\u304f\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3055\u308c\u305f\u60c5\u5831\u306a\u306e\u3067\u3001\u3053\u308c\u3092\u773a\u3081\u3066\u3044\u3066\u3082\u4f55\u3082\u898b\u3048\u3066\u304d\u307e\u305b\u3093\u3002\u56f0\u308a\u307e\u3057\u305f\u3002\n\n\u3068\u3053\u308d\u3067\u3001sign2.sign\u3092\u751f\u6210\u3059\u308b\u306e\u306b\u4f7f\u3063\u305f ```openssl rsautl -sign``` \u306f\u7f72\u540d\u3092\u751f\u6210\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3059\u304c\u3001\u305d\u308c\u3068\u5bfe\u306b\u306a\u308b\u30b3\u30de\u30f3\u30c9\u306f ```openssl rsautl -verify`` \u3067\u3059\u3002\u8a66\u3057\u306b\u3001\u3053\u308c\u3092\u4e21\u8005\u306b\u5bfe\u3057\u3066\u304b\u3051\u3066\u307f\u307e\u3059\u3002\n\n```\n> openssl rsautl -verify -pubin -inkey public-key.pem -in sign.sig | hexdump -C\n00000000  30 21 30 09 06 05 2b 0e  03 02 1a 05 00 04 14 ee  |0!0...+.........|\n00000010  fd 5b c2 c5 47 bf 82 b1  77 b6 25 9c 13 f7 72 3d  |.[..G...w.%...r=|\n00000020  c8 76 d9                                          |.v.|\n00000023\n```\n\n```\n> openssl rsautl -verify -pubin -inkey public-key.pem -in sign2.sig | hexdump -C\n00000000  68 6f 67 65 0a                                    |hoge.|\n00000005\n```\n\n\u306a\u3093\u3068\u3001\u4f55\u304b\u304c\u30c7\u30b3\u30fc\u30c9\u3055\u308c\u3066\u30d0\u30a4\u30ca\u30ea\u3068\u3057\u3066\u51fa\u529b\u3055\u308c\u3066\u304d\u307e\u3057\u305f\u3002\n\n### sign.sig\u306e\u30c7\u30b3\u30fc\u30c9\u7d50\u679c\u3092\u8aad\u307f\u89e3\u304f\nsign.sig\u3092 verify\u3057\u305f\u7d50\u679c\u3092\u3088\u304f\u898b\u3066\u307f\u308b\u3068\u30010x30 21 30 09 \u3068\u306a\u3063\u3066\u3044\u3066\u3001\u5148\u307b\u3069 9.2 EMSA-PKCS1-v1_5 \u306e\u3068\u3053\u308d\u3067\u51fa\u3066\u304d\u305f\u3001SHA-1\u306e DigestInfo\u69cb\u9020\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u3002\n\n\u3064\u307e\u308a\u3001\n\n```\n00000000  30 21 30 09 06 05 2b 0e  03 02 1a 05 00 04 14\n```\n\n\u307e\u3067\u304cSHA-1\u306eAlgorithmIdentifier(\u306eDER\u30a8\u30f3\u30b3\u30fc\u30c9)\u3067\u3001\n\n```\n00000000                                                ee\n00000010  fd 5b c2 c5 47 bf 82 b1  77 b6 25 9c 13 f7 72 3d\n00000020  c8 76 d9\n```\n\n\u306e20\u30d0\u30a4\u30c8\u304c H\u3001\u3064\u307e\u308a\u5b9f\u969b\u306eSHA-1\u30cf\u30c3\u30b7\u30e5\u5024\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u5b9f\u969b\u3001target.txt\u306eSHA-1\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\u3057\u3066\u307f\u308b\u3068\u3001\n\n```\n> shasum target.txt \neefd5bc2c547bf82b177b6259c13f7723dc876d9  target.txt\n```\n\n\u3068\u306a\u3063\u3066\u3044\u3066\u3001\u78ba\u304b\u306b\u3001SHA-1\u306e\u30cf\u30c3\u30b7\u30e5\u5024\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u3002\n\n### sign2.sig\u306e\u30c7\u30b3\u30fc\u30c9\u7d50\u679c\u3092\u8aad\u307f\u89e3\u304f\n\u4e00\u65b9\u3001sign2.sig\u306e\u65b9\u306f\u3001\u660e\u3089\u304b\u306b\u7f72\u540d\u306b\u5165\u529b\u3057\u305f\u60c5\u5831\u305d\u306e\u3082\u306e\u3067\u3059\u3002\u305d\u306e\u3082\u306e\u304c\u898b\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u306f\u3001\u30c0\u30a4\u30b8\u30a7\u30b9\u30c8\u95a2\u6570\u3059\u3089\u304b\u3051\u3089\u308c\u3066\u3044\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n### openssl rsautl -sign \u306e\u6b63\u4f53\n\u3053\u306e\u6319\u52d5\u304b\u3089\u63a8\u6e2c\u3059\u308b\u3068\u3001``openssl rsautl -sign`` \u306f\u3001RSASSA-PKCS1-V1_5-SIGN\u306e\u51e6\u7406\u306e T \u3092\u76f4\u63a5\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u4e0e\u3048\u305f\u3088\u3046\u306a\u52d5\u4f5c\u3092\u3057\u3066\u3044\u308b\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u3002\n\n\u307e\u305f\u3001``openssl rsautl -verify``\u306f\u7f72\u540d\u3092\u516c\u958b\u9375\u3067\u5e73\u6587\u5316\u3057\u3001\u7d50\u679c\u304c\u4ee5\u4e0b\u306eEM\u306e\u69cb\u9020\u3092\u3057\u3066\u3044\u308b\u3068\u89e3\u91c8\u3057\u3001T\u3092\u51fa\u529b\u3059\u308b\u30b3\u30de\u30f3\u30c9\u306e\u3088\u3046\u3067\u3059\u3002\n\n\tEM = 0x00 || 0x01 || PS || 0x00 || T\n\n# iOS/Mac\u306e Security Framework\u3068\u306e\u95a2\u4fc2\n\niOS\u306e Security Framework\u3067\u306f SecKeyRawSign() \u3084 SecKeyRawVerify() \u95a2\u6570\u3067\u96fb\u5b50\u7f72\u540d\u3092\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u305d\u306e\u969b\u3001\u30d1\u30c7\u30a3\u30f3\u30b0\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u3057\u3066\u4ee5\u4e0b\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n- kSecPaddingNone\n\t- No padding.\n- kSecPaddingPKCS1\n\t- PKCS1 padding.\n- kSecPaddingPKCS1MD2\n\t- Data to be signed is an MD2 hash.\n\t- Standard ASN.1 padding is done, as well as PKCS1 padding of the underlying RSA operation. Used with SecKeyRawSign and SecKeyRawVerify only.\n- kSecPaddingPKCS1MD5\n\t- Data to be signed is an MD5 hash.\n\t- Standard ASN.1 padding is done, as well as PKCS1 padding of the underlying RSA operation. Used with SecKeyRawSign and SecKeyRawVerify only.\n- kSecPaddingPKCS1SHA1\n\t- Data to be signed is a SHA1 hash.\n\t- Standard ASN.1 padding will be done, as well as PKCS1 padding of the underlying RSA operation. Used with SecKeyRawSign and SecKeyRawVerify only.\n\n\u203b [\u516c\u5f0f\u30b5\u30a4\u30c8](https://developer.apple.com/library/ios/documentation/Security/Reference/certifkeytrustservices/index.html)\u304b\u3089\u5f15\u7528\n\n## kSecPaddingPKCS1SHA1 \u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\n\u7d50\u8ad6\u304b\u3089\u8a00\u3046\u3068\u3001kSecPaddingPKCS1SHA1\u306e\u6307\u5b9a\u306f\u3001 ```openssl dgst -sha1 -sign ```\u30b3\u30de\u30f3\u30c9\u3068\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\u3064\u307e\u308a\u3001\n\n\tEM = 0x00 || 0x01 || PS || 0x00 || T\n  \t\u305f\u3060\u3057\u3001 T  = A || H\n            A  = (0x)30 21 30 09 06 05 2b 0e 03 02 1a 05 00 04 14\n\n\u306eEM\u3092\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3057\u305f\u3082\u306e\u304c\u7f72\u540d\u3068\u3057\u3066\u5229\u7528\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u6642\u3001SecKeyRawSign()/SecKeyRawVerify()\u306e\u5165\u529b\u306f H \u3067\u3059\u3002PS\u3084A\u306f\u95a2\u6570\u304c\u52dd\u624b\u306b\u51e6\u7406\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n## kSecPaddingPKCS1 \u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\n\u3053\u306e\u5834\u5408\u3001\u4e0a\u8a18 kSecPaddingPKCS1SHA1 \u306e\u51e6\u7406\u304b\u3089 A\u306b\u95a2\u3059\u308b\u51e6\u7406\u304c\u884c\u308f\u308c\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u3064\u307e\u308a\u3001\n\n\tEM = 0x00 || 0x01 || PS || 0x00 || T\n\n\u306eEM\u3092\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3057\u305f\u3082\u306e\u304c\u7f72\u540d\u3068\u3057\u3066\u5229\u7528\u3055\u308c\u308b\u306e\u306f\u540c\u3058\u3067\u3059\u304c\u3001SecKeyRawSign()/SecKeyRawVerify()\u306e\u5165\u529b\u304c\u751f\u306eT\u3067\u3042\u308b\u3068\u89e3\u91c8\u3055\u308c\u3001A\u3092\u4ed8\u4e0e\u3059\u308b\u51e6\u7406\u304c\u884c\u308f\u308c\u307e\u305b\u3093\u3002\n\n\u3053\u306e\u6319\u52d5\u306f ```openssl rsautl -sign```\u3084 ```openssl rsautl -verify``` \u306e\u52d5\u4f5c\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u3002\n\n## kSecPaddingNone \u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\n\n\u3061\u3083\u3093\u3068\u8a66\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u3053\u306e\u5834\u5408\u3001PS\u306b\u95a2\u3059\u308b\u51e6\u7406\u3082\u884c\u308f\u308c\u305a\u3001SecKeyRawSign()/SecKeyRawVerify()\u306e\u5165\u529b\u304c EM\u81ea\u4f53\u3067\u3042\u308b\u3068\u89e3\u91c8\u3055\u308c\u308b\u306e\u3060\u308d\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n## \u306a\u305c\u3053\u3093\u306a\u30d0\u30ea\u30a8\u30fc\u30b7\u30e7\u30f3\u304c\u3042\u308b\u306e\u304b\uff1f\n\u53c2\u8003\u30b5\u30a4\u30c8\u306b\u30ea\u30f3\u30af\u3057\u305f StackOverFlow\u306e\u56de\u7b54\u306b\u3088\u308b\u3068\u3001A\u306e\u30d1\u30c7\u30a3\u30f3\u30b0\u3092\u30d0\u30a4\u30d1\u30b9\u3059\u308b\u51e6\u7406\u306f\u3001SSL/TLS\u306e\u51e6\u7406\u3067\u5fc5\u8981\u306b\u306a\u308b\u3093\u3060\u305d\u3046\u3067\u3059\u3002\u3053\u306e\u8fba\u306f\u3053\u308c\u4ee5\u4e0a\u8abf\u3079\u3066\u3044\u306a\u3044\u306e\u3067\u3088\u304f\u308f\u304b\u308a\u307e\u305b\u3093\u3002\n\n# Java\u306e JCE\u3068\u306e\u95a2\u4fc2\n\nJCE\u306e [Signature\u30af\u30e9\u30b9\u306e\u4ed5\u69d8](http://docs.oracle.com/javase/7/docs/api/java/security/Signature.html)\u306b\u3088\u308b\u3068\u3001\u5b9f\u88c5\u30af\u30e9\u30b9\u306f\u7f72\u540d\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\uff13\u3064\u306f\u5fc5\u305a\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3068\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\n- SHA1withDSA\n- SHA1withRSA\n- SHA256withRSA\n\n\u3053\u306e\u3046\u3061\u3001SHA1withRSA\u3068\u3044\u3046\u306e\u304c iOS\u306e kSecPaddingPKCS1SHA1\u3084\u3001OpenSSL\u30b3\u30de\u30f3\u30c9\u306e ```openssl dgst -sha1 -sign``` \u3068\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002\n\n# \u53c2\u8003\u30b5\u30a4\u30c8\n- [What is the difference between the different padding types on iOS? - StackOverFlow](http://stackoverflow.com/questions/5054036/what-is-the-difference-between-the-different-padding-types-on-ios)\n", "tags": ["iOS", "RSA", "Java", "\u96fb\u5b50\u7f72\u540d", "JCA"]}