{"context": "\n\n\u52d5\u6a5f\nBot Framework\u3067Office365\u306e\u4f1a\u8b70\u5ba4\u4e88\u7d04\u3068\u304b\u3092\u3059\u308b\u305f\u3081\u306bMicrosoft Graph API\u3092\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u3063\u305f\u3002\n\u5b9f\u969b\u306e\u958b\u767a\u3067\u306fGraph API\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u3042\u308b\u306e\u3067\u305d\u3061\u3089\u3092\u4f7f\u3048\u3070\u3044\u3044\u304c\u3001\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u3044\u3066\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5c0e\u5165\u3092\u3059\u308b\u307b\u3069\u3067\u3082\u306a\u304b\u3063\u305f\u306e\u3067\u81ea\u5206\u3067\u66f8\u3044\u3066\u307f\u305f\u3002\n\n\u30b3\u30fc\u30c9\nusing (var client = new HttpClient())\n{\n  var url = \"https://graph.microsoft.com/v1.0/me\";\n  client.DefaultRequestHeaders.Add(\"Authorization\", \"Bearer \" + accessToken);\n  var response = await client.GetStringAsync(url);\n  JObject json = JObject.Parse(response);\n  var hogehoge = json.GetValue(\"hogehoge\");\n\n  Console.WriteLine(hogehoge);\n}\n\n\u610f\u5916\u306b\u306f\u307e\u3063\u305f\u306e\u304c\u30ea\u30af\u30a8\u30b9\u30c8\u30d8\u30c3\u30c0\u30fc\u306bAuthorization\u3092\u8ffd\u52a0\u3059\u308b\u3068\u304d\u306b[Bearer]\u3068\u5b9f\u969b\u306eaccessToken\u306e\u9593\u306b\u30b9\u30da\u30fc\u30b9\u3092\u5165\u308c\u308b\u5fc5\u8981\u304c\u3042\u308b\u3068\u3044\u3046\u3053\u3068\u3002\n\nAccessToken\u306e\u53d6\u5f97\n\u4e0a\u306e\u30b3\u30fc\u30c9\u3067AccessToken\u3082\u4e00\u7dd2\u306b\u6e21\u3059\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001API\u3092\u547c\u3073\u51fa\u3059\u524d\u306bAccessToken\u3092\u53d6\u5f97\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u8a73\u3057\u304f\u306f\u3053\u3053\u306b\u66f8\u3044\u3066\u3042\u308b\u304c\u3001Bot\u304b\u3089\u306e\u8a8d\u8a3c\u65b9\u6cd5\u306f\u4f55\u304c\u3044\u3044\u306e\u304b\u691c\u7d22\u3057\u305f\u3068\u3053\u308dMagic code\u3092\u4f7f\u7528\u3057\u305fBot\u304b\u3089\u306e\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u306e\u30da\u30fc\u30b8\u3092\u898b\u3064\u3051\u305f\u306e\u3067Magic code\u3092\u4f7f\u304a\u3046\u3068\u601d\u3044\u3001\u3055\u3089\u306b\u691c\u7d22\u3057\u305f\u3068\u3053\u308dAuthBot\u3068\u3044\u3046\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u898b\u3064\u3051\u305f\u306e\u3067\u3053\u308c\u3092\u4f7f\u3063\u3066AccessToken\u3092\u53d6\u5f97\u3057\u305f\u3002\n# \u52d5\u6a5f\nBot Framework\u3067Office365\u306e\u4f1a\u8b70\u5ba4\u4e88\u7d04\u3068\u304b\u3092\u3059\u308b\u305f\u3081\u306bMicrosoft Graph API\u3092\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u3042\u3063\u305f\u3002\n**\u5b9f\u969b\u306e\u958b\u767a\u3067\u306f[Graph API\u30e9\u30a4\u30d6\u30e9\u30ea](https://www.nuget.org/packages/Microsoft.Graph)\u304c\u3042\u308b\u306e\u3067\u305d\u3061\u3089\u3092\u4f7f\u3048\u3070\u3044\u3044\u304c\u3001**\u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u3044\u3066\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5c0e\u5165\u3092\u3059\u308b\u307b\u3069\u3067\u3082\u306a\u304b\u3063\u305f\u306e\u3067\u81ea\u5206\u3067\u66f8\u3044\u3066\u307f\u305f\u3002\n\n# \u30b3\u30fc\u30c9\n``` CSharp\nusing (var client = new HttpClient())\n{\n  var url = \"https://graph.microsoft.com/v1.0/me\";\n  client.DefaultRequestHeaders.Add(\"Authorization\", \"Bearer \" + accessToken);\n  var response = await client.GetStringAsync(url);\n  JObject json = JObject.Parse(response);\n  var hogehoge = json.GetValue(\"hogehoge\");\n\n  Console.WriteLine(hogehoge);\n}\n```\n\u610f\u5916\u306b\u306f\u307e\u3063\u305f\u306e\u304c\u30ea\u30af\u30a8\u30b9\u30c8\u30d8\u30c3\u30c0\u30fc\u306bAuthorization\u3092\u8ffd\u52a0\u3059\u308b\u3068\u304d\u306b[Bearer]\u3068\u5b9f\u969b\u306eaccessToken\u306e\u9593\u306b\u30b9\u30da\u30fc\u30b9\u3092\u5165\u308c\u308b\u5fc5\u8981\u304c\u3042\u308b\u3068\u3044\u3046\u3053\u3068\u3002\n\n# AccessToken\u306e\u53d6\u5f97\n\u4e0a\u306e\u30b3\u30fc\u30c9\u3067AccessToken\u3082\u4e00\u7dd2\u306b\u6e21\u3059\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067\u3001API\u3092\u547c\u3073\u51fa\u3059\u524d\u306bAccessToken\u3092\u53d6\u5f97\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u8a73\u3057\u304f\u306f[\u3053\u3053](https://graph.microsoft.io/ja-jp/docs/authorization/app_authorization#\u30a2\u30af\u30bb\u30b9-\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b)\u306b\u66f8\u3044\u3066\u3042\u308b\u304c\u3001Bot\u304b\u3089\u306e\u8a8d\u8a3c\u65b9\u6cd5\u306f\u4f55\u304c\u3044\u3044\u306e\u304b\u691c\u7d22\u3057\u305f\u3068\u3053\u308d[Magic code\u3092\u4f7f\u7528\u3057\u305fBot\u304b\u3089\u306e\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c](https://blogs.msdn.microsoft.com/tsmatsuz/2016/09/06/microsoft-bot-framework-bot-with-authentication-and-signin-login/)\u306e\u30da\u30fc\u30b8\u3092\u898b\u3064\u3051\u305f\u306e\u3067Magic code\u3092\u4f7f\u304a\u3046\u3068\u601d\u3044\u3001\u3055\u3089\u306b\u691c\u7d22\u3057\u305f\u3068\u3053\u308d[AuthBot](https://github.com/MicrosoftDX/AuthBot)\u3068\u3044\u3046\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u898b\u3064\u3051\u305f\u306e\u3067\u3053\u308c\u3092\u4f7f\u3063\u3066AccessToken\u3092\u53d6\u5f97\u3057\u305f\u3002\n", "tags": ["MicrosoftGraph", "BotFramework"]}