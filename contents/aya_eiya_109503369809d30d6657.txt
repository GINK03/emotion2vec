{"context": " More than 1 year has passed since last update.gretty\u306b\u6e21\u3059\u5f15\u6570\u3092\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6e21\u3057\u305f\u304b\u3063\u305f\u3002\n./gradlew appRun -Dgretty.port=8080 -Dgretty.xxx=xxxx\n\n\u307b\u3093\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bSystem.properties\u3092\u56de\u3059\u3002\nSystem.properties.findAll { it.key.indexOf('gretty.')==0 }.collect{\n  new MapEntry(\"${it.key.replaceFirst('^gretty\\\\.','')}\",it.value)\n}.each{\n  gretty[it.key]=it.value\n}\n\n\u306a\u305c\u3060\u304b\u3001port\u306e\u5f15\u6570\u3067Cast\u51fa\u6765\u306a\u3044\u4f8b\u5916\u304c\u767a\u751f\u3057\u3066(\uff9f\u0414\uff9f)\uff8a\uff67?\u3063\u3066\u306a\u3063\u305f\u3002\n\uff08\u3061\u306a\u307f\u306b\u3001Groovy\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3060\u3068\u3001Integer\u578b\u306e\u5f15\u6570\u3092\u53d7\u3051\u308bproperty\u306bString\u578b\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7a81\u3063\u8fbc\u3093\u3067\u3082\u3001Cast\u51fa\u6765\u306a\u3044\u4f8b\u5916\u306f\u767a\u751f\u3057\u306a\u3044\uff09\n\u3068\u308a\u3042\u3048\u305a\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u3053\u3068\u3092\u8a66\u3057\u3066\u307f\u308b\u3002\nclass Dog{\n  int age = 1\n  String name = 'taro'\n  boolean isMale = true\n  Integer id = 1\n  void setName(String name){\n     this.name = name.toLowerCase()\n  }\n  void setId(Integer id){\n     if(id == null || id < 0){\n        throw new Exception('bad id')\n     }\n     this.id = id\n  }\n  String toString(){\n    \"{$name:{'age':$age,'sex':'${isMale?'m':'f'}'}}\"\n  }\n}\ndef setPropValue(target,kv){\n  try{\n    def setter=\"set${kv.key.replaceFirst('^(.)'){it[1].toUpperCase()}}\"\n    target.class.methods.each{\n      if(it.name == setter && it.parameterTypes.length == 1){\n        if(it.parameterTypes[0].isPrimitive() ||\n           it.parameterTypes[0].methods.find {\n             it.name=='valueOf' &&  it.parameterTypes.length == 1\n           } &&\n           it.parameterTypes[0] != String.class\n        ){\n          println \"p : $kv.key\"\n          target[kv.key]=Eval.me(kv.value)\n        }else{\n          println \"o : $kv.key\"\n          target[kv.key]=kv.value\n        }\n      }\n    }\n  }\n  catch(e){println e}\n}\n\ndef dog=new Dog()\n['gretty.id':'2','gretty.name':'Hanako','gretty.isMale':'false','gretty.age':'2'].\ncollect{\n  new MapEntry(\"${it.key.replaceFirst('^gretty\\\\.','')}\",it.value)\n}.each{\n  setPropValue(dog,it)\n}\n\n\u3046\u307e\u3044\u3053\u3068\u5024\u3092\u653e\u308a\u8fbc\u3081\u305d\u3046\u3002\n\u4e0a\u306e\u95a2\u6570\u3092\u305d\u306e\u307e\u307e\u4f7f\u3063\u3066\u3001\ndef setPropValue(target,kv){\n  try{\n    def setter=\"set${kv.key.replaceFirst('^(.)'){it[1].toUpperCase()}}\"\n    target.class.methods.each{\n      if(it.name == setter && it.parameterTypes.length == 1){\n        if(it.parameterTypes[0].isPrimitive() ||\n           it.parameterTypes[0].methods.find {\n             it.name=='valueOf' &&  it.parameterTypes.length == 1\n           } &&\n           it.parameterTypes[0] != String.class\n        ){\n          println \"p : $kv.key\"\n          target[kv.key]=Eval.me(kv.value)\n        }else{\n          println \"o : $kv.key\"\n          target[kv.key]=kv.value\n        }\n      }\n    }\n  }\n  catch(e){println e}\n}\nSystem.properties.findAll { it.key.indexOf('gretty.')==0 }.collect{\n  new MapEntry(\"${it.key.replaceFirst('^gretty\\\\.','')}\",it.value)\n}.each{\n  setPropValue(gretty,it)\n}\n\n\u3068\u3059\u308b\u3002\n\u3053\u308c\u3067./gradlew\u306bGretty\u306e\u8a2d\u5b9a\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\u5b9f\u969b\u306b\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u304c\u4e0a\u306b\u3064\u3089\u3064\u3089\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\nJenkins\u306bintegration test\u3055\u305b\u3066\u3044\u308b\u3068\u304d\u3001project\u6bce\u306bport\u3092\u5909\u66f4\u3057\u305f\u308a\u3067\u304d\u308b\u306e\u3067\u4fbf\u5229\u3067\u3059\u3002\ngretty\u306b\u6e21\u3059\u5f15\u6570\u3092\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u6e21\u3057\u305f\u304b\u3063\u305f\u3002\n\n```zsh\n./gradlew appRun -Dgretty.port=8080 -Dgretty.xxx=xxxx\n```\n\n\u307b\u3093\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bSystem.properties\u3092\u56de\u3059\u3002\n\n```groovy\nSystem.properties.findAll { it.key.indexOf('gretty.')==0 }.collect{\n  new MapEntry(\"${it.key.replaceFirst('^gretty\\\\.','')}\",it.value)\n}.each{\n  gretty[it.key]=it.value\n}\n```\n\n\u306a\u305c\u3060\u304b\u3001port\u306e\u5f15\u6570\u3067Cast\u51fa\u6765\u306a\u3044\u4f8b\u5916\u304c\u767a\u751f\u3057\u3066(\uff9f\u0414\uff9f)\uff8a\uff67?\u3063\u3066\u306a\u3063\u305f\u3002\n\uff08\u3061\u306a\u307f\u306b\u3001Groovy\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u3060\u3068\u3001Integer\u578b\u306e\u5f15\u6570\u3092\u53d7\u3051\u308bproperty\u306bString\u578b\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7a81\u3063\u8fbc\u3093\u3067\u3082\u3001Cast\u51fa\u6765\u306a\u3044\u4f8b\u5916\u306f\u767a\u751f\u3057\u306a\u3044\uff09\n\n\u3068\u308a\u3042\u3048\u305a\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u3053\u3068\u3092\u8a66\u3057\u3066\u307f\u308b\u3002\n\n```groovy\nclass Dog{\n  int age = 1\n  String name = 'taro'\n  boolean isMale = true\n  Integer id = 1\n  void setName(String name){\n     this.name = name.toLowerCase()\n  }\n  void setId(Integer id){\n     if(id == null || id < 0){\n        throw new Exception('bad id')\n     }\n     this.id = id\n  }\n  String toString(){\n    \"{$name:{'age':$age,'sex':'${isMale?'m':'f'}'}}\"\n  }\n}\ndef setPropValue(target,kv){\n  try{\n    def setter=\"set${kv.key.replaceFirst('^(.)'){it[1].toUpperCase()}}\"\n    target.class.methods.each{\n      if(it.name == setter && it.parameterTypes.length == 1){\n        if(it.parameterTypes[0].isPrimitive() ||\n           it.parameterTypes[0].methods.find {\n             it.name=='valueOf' &&  it.parameterTypes.length == 1\n           } &&\n           it.parameterTypes[0] != String.class\n        ){\n          println \"p : $kv.key\"\n          target[kv.key]=Eval.me(kv.value)\n        }else{\n          println \"o : $kv.key\"\n          target[kv.key]=kv.value\n        }\n      }\n    }\n  }\n  catch(e){println e}\n}\n\ndef dog=new Dog()\n['gretty.id':'2','gretty.name':'Hanako','gretty.isMale':'false','gretty.age':'2'].\ncollect{\n  new MapEntry(\"${it.key.replaceFirst('^gretty\\\\.','')}\",it.value)\n}.each{\n  setPropValue(dog,it)\n}\n```\n\n\u3046\u307e\u3044\u3053\u3068\u5024\u3092\u653e\u308a\u8fbc\u3081\u305d\u3046\u3002\n\n\u4e0a\u306e\u95a2\u6570\u3092\u305d\u306e\u307e\u307e\u4f7f\u3063\u3066\u3001\n\n```groovy\ndef setPropValue(target,kv){\n  try{\n    def setter=\"set${kv.key.replaceFirst('^(.)'){it[1].toUpperCase()}}\"\n    target.class.methods.each{\n      if(it.name == setter && it.parameterTypes.length == 1){\n        if(it.parameterTypes[0].isPrimitive() ||\n           it.parameterTypes[0].methods.find {\n             it.name=='valueOf' &&  it.parameterTypes.length == 1\n           } &&\n           it.parameterTypes[0] != String.class\n        ){\n          println \"p : $kv.key\"\n          target[kv.key]=Eval.me(kv.value)\n        }else{\n          println \"o : $kv.key\"\n          target[kv.key]=kv.value\n        }\n      }\n    }\n  }\n  catch(e){println e}\n}\nSystem.properties.findAll { it.key.indexOf('gretty.')==0 }.collect{\n  new MapEntry(\"${it.key.replaceFirst('^gretty\\\\.','')}\",it.value)\n}.each{\n  setPropValue(gretty,it)\n}\n```\n\n\u3068\u3059\u308b\u3002\n\n\u3053\u308c\u3067./gradlew\u306bGretty\u306e\u8a2d\u5b9a\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\n\u5b9f\u969b\u306b\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u304c\u4e0a\u306b\u3064\u3089\u3064\u3089\u66f8\u3044\u3066\u3042\u308a\u307e\u3059\u3002\n\nJenkins\u306bintegration test\u3055\u305b\u3066\u3044\u308b\u3068\u304d\u3001project\u6bce\u306bport\u3092\u5909\u66f4\u3057\u305f\u308a\u3067\u304d\u308b\u306e\u3067\u4fbf\u5229\u3067\u3059\u3002\n", "tags": ["Groovy", "gradle"]}