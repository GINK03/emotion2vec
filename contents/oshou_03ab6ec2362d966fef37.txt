{"tags": ["tcpdump"], "context": "\n\ntcpdump\u3068\u306f\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1\u306e\u751f\u30c7\u30fc\u30bf\u3092\u53ce\u96c6\u3057\u7d50\u679c\u3092\u51fa\u529b(=\u30d1\u30b1\u30c3\u30c8\u30ad\u30e3\u30d7\u30c1\u30e3)\u3057\u3066\u304f\u308c\u308bCUI\u306e\u89e3\u6790\u30c4\u30fc\u30eb\n\n\u3044\u3064\u3001\u3069\u3053\u304b\u3089\u3069\u3053\u3078\u3001\u3069\u3093\u306a\u30d5\u30e9\u30b0(SYN,ACK,FIN\u7b49)\u306e\u30d1\u30b1\u30c3\u30c8\u304c\u9001\u3089\u308c\u305f\u304b\u7b49\u304c\u5206\u304b\u308b\u3002\n\nUDP\n01:49:27.734570 IP 10.121.97.2.ddi-udp-1 > 224.0.0.2.ddi-udp-1: UDP, length 20\nTCP\n02:33:08.725216 IP 127.0.0.1.50430 > 127.0.0.1.12345: Flags [S], seq 1798840789, win 65495, options [mss 65495,sackOK,TS val 338968857 ecr 0,nop,wscale 7], length 0\n02:33:08.725238 IP 127.0.0.1.12345 > 127.0.0.1.50430: Flags [S.], seq 2503952955, ack 1798840790, win 65483, options [mss 65495,sackOK,TS val 338968857 ecr 338968857,nop,wscale 7], length 0\n02:33:08.725254 IP 127.0.0.1.50430 > 127.0.0.1.12345: Flags [.], ack 1, win 512, options [nop,nop,TS val 338968857 ecr 338968857], length 0\n\n\n\u4ed6\u89e3\u6790\u30c4\u30fc\u30eb\u3068\u6bd4\u3079\u3066\u30ea\u30bd\u30fc\u30b9\u6d88\u8cbb\u304c\u5c11\u306a\u3044\u3002\n\n\n\u4f7f\u3044\u65b9\n\n\u7528\u9014\u306b\u3088\u3063\u3066\u30d5\u30a3\u30eb\u30bf\u3092\u304b\u3051\u308b\n\n\n\u30d5\u30a3\u30eb\u30bf\u7121\u3057\u3060\u3068\u96c6\u8a08\u7d50\u679c\u304c\u81a8\u5927\u3059\u304e\u308b\u306e\u3067\u5fc5\u305a\u30d5\u30a3\u30eb\u30bf\u3092\u639b\u3051\u307e\u3059\u3002\n\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u306e\u65b9\u6cd5\u306f\u4ee5\u4e0b\n\n\n\u30db\u30b9\u30c8\u3067\u7d5e\u308b\n> tcpdump host xxx.xxx.xxx.xxx #\u7279\u5b9aIP\u3067\u30d5\u30a3\u30eb\u30bf\n> tcpdump host 1.1.1.1 or 2.2.2.2 #\u8907\u6570IP\u3067\u30d5\u30a3\u30eb\u30bf\n> tcpdump src host xxx #\u7279\u5b9aIP(\u9001\u4fe1\u5143\u306e\u307f)\u3067\u30d5\u30a3\u30eb\u30bf\n> tcpdump dst host xxx #\u7279\u5b9aIP(\u9001\u4fe1\u5148\u306e\u307f)\u3067\u30d5\u30a3\u30eb\u30bf\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u7d5e\u308b\n> tcpdump net 192.168.2.0/24 #\u7279\u5b9a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u30d5\u30a3\u30eb\u30bf(\u9001\u4fe1\u5143\u3001\u9001\u4fe1\u5148\u4e21\u65b9\u304c\u5bfe\u5fdc\uff09\n> tcpdump src net 192.168.2.0 mask 255.255.255.0 #\u9001\u4fe1\u5143\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u30d5\u30a3\u30eb\u30bf\n> tcpdump dst net 192.168.2.0 mask 255.255.255.0 #\u9001\u4fe1\u5148\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u30d5\u30a3\u30eb\u30bf\n\u30dd\u30fc\u30c8\u3067\u7d5e\u308b\n> tcpdump port 80 #\u5358\u4e00\u30dd\u30fc\u30c8\n> tcpdump port 80 or port 443 #\u8907\u6570\u30dd\u30fc\u30c8\n> tcpdump dst port 80 #\u9001\u4fe1\u5148\u30dd\u30fc\u30c8\n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u7d5e\u308b\n> tcpdump -i eth0 #eth0\u306e\u901a\u4fe1\u306e\u307f\u5bfe\u8c61\nTCP\u30d5\u30e9\u30b0\u3067\u7d5e\u308b\n> tcpdump \"tcp[tcpflags] & (tcp-syn|tcp-fin)!=0\" #SYNorFIN\u30d1\u30b1\u30c3\u30c8\u306b\u30de\u30c3\u30c1\u3059\u308b\u3082\u306e\u304c\u5bfe\u8c61\n\n\n\n\n\u3088\u304f\u4f7f\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\n\n\n-n\n\u30a2\u30c9\u30ec\u30b9\u5909\u63db(192.168.1.123=>examplehost)\u3084\u30dd\u30fc\u30c8\u756a\u53f7\u5909\u63db(80=>http)\u3092\u3057\u306a\u3044\u3002\n-w \u66f8\u304d\u51fa\u3059\u30d5\u30a1\u30a4\u30eb\u540d\n\u53ce\u96c6\u7d50\u679c\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u51fa\u3059\n-r \u8aad\u307f\u8fbc\u3080\u30d5\u30a1\u30a4\u30eb\u540d\n\u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30d1\u30b1\u30c3\u30c8\u53ce\u96c6\u7d50\u679c\u3092\u8aad\u307f\u8fbc\u3080\n\n\n\n\n\u53c2\u8003\n\n\u8d85\u7d76\u521d\u5fc3\u8005\u3080\u3051tcpdump\u306e\u4f7f\u3044\u65b9 - Qiita\n\n\nhttps://goo.gl/keIySm\n\n\ntcpdump\u3084wireshark\u3067TCP\u5236\u5fa1\u30d5\u30e9\u30b0\u3092\u6307\u5b9a\u3057\u3066\u30d1\u30b1\u30c3\u30c8\u3092\u53ce\u96c6\u3059\u308b\u65b9\u6cd5\n\n\n\nhttps://goo.gl/M9dXr2 \n\n\n\n\n## tcpdump\u3068\u306f\n- \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1\u306e\u751f\u30c7\u30fc\u30bf\u3092\u53ce\u96c6\u3057\u7d50\u679c\u3092\u51fa\u529b(=\u30d1\u30b1\u30c3\u30c8\u30ad\u30e3\u30d7\u30c1\u30e3)\u3057\u3066\u304f\u308c\u308bCUI\u306e\u89e3\u6790\u30c4\u30fc\u30eb\n- \u3044\u3064\u3001\u3069\u3053\u304b\u3089\u3069\u3053\u3078\u3001\u3069\u3093\u306a\u30d5\u30e9\u30b0(SYN,ACK,FIN\u7b49)\u306e\u30d1\u30b1\u30c3\u30c8\u304c\u9001\u3089\u308c\u305f\u304b\u7b49\u304c\u5206\u304b\u308b\u3002\n  > UDP\n  > 01:49:27.734570 IP 10.121.97.2.ddi-udp-1 > 224.0.0.2.ddi-udp-1: UDP, length 20\n  > TCP\n  > 02:33:08.725216 IP 127.0.0.1.50430 > 127.0.0.1.12345: Flags [S], seq 1798840789, win 65495, options [mss 65495,sackOK,TS val 338968857 ecr 0,nop,wscale 7], length 0\n02:33:08.725238 IP 127.0.0.1.12345 > 127.0.0.1.50430: Flags [S.], seq 2503952955, ack 1798840790, win 65483, options [mss 65495,sackOK,TS val 338968857 ecr 338968857,nop,wscale 7], length 0\n02:33:08.725254 IP 127.0.0.1.50430 > 127.0.0.1.12345: Flags [.], ack 1, win 512, options [nop,nop,TS val 338968857 ecr 338968857], length 0\n\n- \u4ed6\u89e3\u6790\u30c4\u30fc\u30eb\u3068\u6bd4\u3079\u3066\u30ea\u30bd\u30fc\u30b9\u6d88\u8cbb\u304c\u5c11\u306a\u3044\u3002\n\n## \u4f7f\u3044\u65b9\n- \u7528\u9014\u306b\u3088\u3063\u3066\u30d5\u30a3\u30eb\u30bf\u3092\u304b\u3051\u308b\n    - \u30d5\u30a3\u30eb\u30bf\u7121\u3057\u3060\u3068\u96c6\u8a08\u7d50\u679c\u304c\u81a8\u5927\u3059\u304e\u308b\u306e\u3067\u5fc5\u305a\u30d5\u30a3\u30eb\u30bf\u3092\u639b\u3051\u307e\u3059\u3002\n    - \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u306e\u65b9\u6cd5\u306f\u4ee5\u4e0b\n        - \u30db\u30b9\u30c8\u3067\u7d5e\u308b\n          > tcpdump host xxx.xxx.xxx.xxx #\u7279\u5b9aIP\u3067\u30d5\u30a3\u30eb\u30bf\n          > tcpdump host 1.1.1.1 or 2.2.2.2 #\u8907\u6570IP\u3067\u30d5\u30a3\u30eb\u30bf\n          > tcpdump src host xxx #\u7279\u5b9aIP(\u9001\u4fe1\u5143\u306e\u307f)\u3067\u30d5\u30a3\u30eb\u30bf\n          > tcpdump dst host xxx #\u7279\u5b9aIP(\u9001\u4fe1\u5148\u306e\u307f)\u3067\u30d5\u30a3\u30eb\u30bf\n        - \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u7d5e\u308b\n          > tcpdump net 192.168.2.0/24 #\u7279\u5b9a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u30d5\u30a3\u30eb\u30bf(\u9001\u4fe1\u5143\u3001\u9001\u4fe1\u5148\u4e21\u65b9\u304c\u5bfe\u5fdc\uff09\n          > tcpdump src net 192.168.2.0 mask 255.255.255.0 #\u9001\u4fe1\u5143\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u30d5\u30a3\u30eb\u30bf\n          > tcpdump dst net 192.168.2.0 mask 255.255.255.0 #\u9001\u4fe1\u5148\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u30d5\u30a3\u30eb\u30bf\n        - \u30dd\u30fc\u30c8\u3067\u7d5e\u308b\n          > tcpdump port 80 #\u5358\u4e00\u30dd\u30fc\u30c8\n          > tcpdump port 80 or port 443 #\u8907\u6570\u30dd\u30fc\u30c8\n          > tcpdump dst port 80 #\u9001\u4fe1\u5148\u30dd\u30fc\u30c8\n        - \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u7d5e\u308b\n          > tcpdump -i eth0 #eth0\u306e\u901a\u4fe1\u306e\u307f\u5bfe\u8c61\n        - TCP\u30d5\u30e9\u30b0\u3067\u7d5e\u308b\n          > tcpdump \"tcp[tcpflags] & (tcp-syn|tcp-fin)!=0\" #SYNorFIN\u30d1\u30b1\u30c3\u30c8\u306b\u30de\u30c3\u30c1\u3059\u308b\u3082\u306e\u304c\u5bfe\u8c61\n- \u3088\u304f\u4f7f\u3046\u30aa\u30d7\u30b7\u30e7\u30f3\n    - -n  \n    \u30a2\u30c9\u30ec\u30b9\u5909\u63db(192.168.1.123=>examplehost)\u3084\u30dd\u30fc\u30c8\u756a\u53f7\u5909\u63db(80=>http)\u3092\u3057\u306a\u3044\u3002\n    - -w \u66f8\u304d\u51fa\u3059\u30d5\u30a1\u30a4\u30eb\u540d\n    \u53ce\u96c6\u7d50\u679c\u3092\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u51fa\u3059\n    - -r \u8aad\u307f\u8fbc\u3080\u30d5\u30a1\u30a4\u30eb\u540d\n    \u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30d1\u30b1\u30c3\u30c8\u53ce\u96c6\u7d50\u679c\u3092\u8aad\u307f\u8fbc\u3080\n\n    \n## \u53c2\u8003\n- \u8d85\u7d76\u521d\u5fc3\u8005\u3080\u3051tcpdump\u306e\u4f7f\u3044\u65b9 - Qiita\n    - https://goo.gl/keIySm\n- tcpdump\u3084wireshark\u3067TCP\u5236\u5fa1\u30d5\u30e9\u30b0\u3092\u6307\u5b9a\u3057\u3066\u30d1\u30b1\u30c3\u30c8\u3092\u53ce\u96c6\u3059\u308b\u65b9\u6cd5\n    - https://goo.gl/M9dXr2 \n"}