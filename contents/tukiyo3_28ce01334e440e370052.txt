{"context": " More than 1 year has passed since last update.\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npacman -Sy apache php php-apache mariadb postfix\n\n\n\napache,php\n\nconf/httpd.conf\n+ LoadModule php5_module       modules/libphp5.so\n+ AddHandler php5-script php\n+ Include conf/extra/php5_module.conf\n\n\n\nApache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe.  You need to recompile PHP.\u306e\u5bfe\u5fdc\n\n\nconf/httpd.conf\n- LoadModule mpm_event_module modules/mod_mpm_event.so\n+ LoadModule mpm_prefork_module modules/mod_mpm_prefork.so\n\n\n\nconf/httpd.conf\n- #LoadModule vhost_alias_module modules/mod_vhost_alias.so\n+ LoadModule vhost_alias_module modules/mod_vhost_alias.so\n- #Include conf/extra/httpd-vhosts.conf\n+ Include conf/extra/httpd-vhosts.conf\n\n\n\n\u9069\u5b9cextra/httpd-vhosts.conf\u306e\u7de8\u96c6\n\n\nphp,mysql\n\n/etc/php/php.ini\n- ;date.timezone =\n+ date.timezone = Asia/Tokyo\n\n\n\nPHP Fatal error:  Call to undefined function mysql_connect()\u306e\u5bfe\u5fdc\n\n\n/etc/php/php.ini\n- ;extension=mysql.so\n+ extension=mysql.so\n\n\nmysql.so \u306fphp5.5\u3067\u306fdeprecated\u3060\u3063\u305f\u3088\u3046\u306a\u3002\u4e00\u6642\u3057\u306e\u304e\n\npostfix\n\nerror: open database /etc/postfix/aliases.db: No such file or directory\nalias database unavailable \u306e\u5bfe\u5fdc\n\nnewaliases\n\n\n\u30b5\u30fc\u30d3\u30b9\u767b\u9332\nfor s in mysqld httpd postfix\ndo\n  systemctl enable $s\n  systemctl start $s\ndone\n\n\nDocumentRoot \u306f /srv/http\nmariadb\u306f\u6a19\u6e96\u3067utf-8\n\n\ntips\n\ncgi-script\u304c\u4f7f\u3044\u305f\u3044\u5834\u5408\n\nconf/httpd.conf\n- #LoadModule cgi_module modules/mod_cgi.so\n+ LoadModule cgi_module modules/mod_cgi.so\n- #AddHandler cgi-script .cgi\n+ AddHandler cgi-script .cgi\n\n\n\nconf/extra/httpd-vhosts.conf\n<VirtualHost *:80>\n    ...\n+   <Directory \"/srv/http/cgi\">\n+       Options +ExecCGI\n+       Require all granted\n+   </Directory>\n</VirtualHost>\n\n\n\nDocumentRoot\u3092\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\n\n/srv/http/ \u304b\u3089 /srv/domainname/ \u306b\u5909\u66f4\u3059\u308b\u5834\u5408\n\n\nPHP Warning:  Unknown: open_basedir restriction in effect. File(/srv/domainname/public/index.php) is not within the allowed path(s): (/srv/http/:/home/:/tmp/:/usr/share/pear/:/usr/share/webapps/) in Unknown on line 0\n\n\n/etc/php/php.ini\n- open_basedir = /srv/http/:/home/:/tmp/:/usr/share/pear/:/usr/share/webapps/\n+ ;open_basedir = /srv/http/:/home/:/tmp/:/usr/share/pear/:/usr/share/webapps/\n\n\n\ndigest\u8a8d\u8a3c + .htaccess\n\nhttpd.conf\n- #LoadModule auth_digest_module modules/mod_auth_digest.so\n+ LoadModule auth_digest_module modules/mod_auth_digest.so\n\n\n\nextra/httpd-vhosts.conf\n  <Directory \"/srv/httpd/admin/\">\n+   AllowOverride AuthConfig\n    Require all granted   \n  </Directory>\n\n\n\n.htaccess\nAuthType Digest\nAuthName \"member only\"\nAuthUserFile \"/srv/digest/.htdigest\"\nrequire valid-user\n\n\n\n.htdigest\u4f5c\u6210\n$ htdigest -c /srv/digest/.htdigest \"member only\" user1\nAdding password for user1 in realm member only.\nNew password:\nRe-type new password:\n$ cat .htdigest\nuser1:member only:e9fc3e4e6f5fd3a18be2006b6a1964b9\n\n\n\n.htaccess\u3067php_value\u5024\u306e\u5909\u66f4\u3059\u308b\u305f\u3081\u306b\n\n.htaccess: php_value not allowed here\n\n\nextra/httpd-vhosts.conf\n  <Directory \"/srv/httpd/admin/\">\n+   AllowOverride Options\n    Require all granted   \n  </Directory>\n\n\n\n.htaccess\u3067\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306e\u8a2d\u5b9a\u5909\u66f4\n\n.htaccess\nphp_value max_execution_time 600\nphp_value post_max_size 50M\nphp_value upload_max_filesize 50M\n\n\n\nuserdir\n\nmod_userdir - Apache HTTP \u30b5\u30fc\u30d0 \u30d0\u30fc\u30b8\u30e7\u30f3 2.4\n\n\nextra/httpd-userdir.conf\n  UserDir public_html\n+ UserDir disabled\n+ UserDir enabled username1 username2\n\n\nchown :http /home/username[12]/\nchmod g+rx /home/username[12]/\n\npublic_html\u3092http\u30e6\u30fc\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u6a29\u9650\u306b\u6c17\u3092\u3064\u3051\u308b\u3002\n\n\u305d\u306e\u4ed6\n\nnetstat\u304c\u306a\u3044\u5834\u5408\npacman -Sy net-tools\n\n# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash:\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npacman -Sy apache php php-apache mariadb postfix\n```\n\n## apache,php\n\n```diff:conf/httpd.conf\n+ LoadModule php5_module       modules/libphp5.so\n+ AddHandler php5-script php\n+ Include conf/extra/php5_module.conf\n```\n\n> Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe.  You need to recompile PHP.\u306e\u5bfe\u5fdc\n\n```diff:conf/httpd.conf\n- LoadModule mpm_event_module modules/mod_mpm_event.so\n+ LoadModule mpm_prefork_module modules/mod_mpm_prefork.so\n```\n\n```diff:conf/httpd.conf\n- #LoadModule vhost_alias_module modules/mod_vhost_alias.so\n+ LoadModule vhost_alias_module modules/mod_vhost_alias.so\n- #Include conf/extra/httpd-vhosts.conf\n+ Include conf/extra/httpd-vhosts.conf\n```\n\n* \u9069\u5b9c`extra/httpd-vhosts.conf`\u306e\u7de8\u96c6\n\n\n## php,mysql\n\n```diff:/etc/php/php.ini\n- ;date.timezone =\n+ date.timezone = Asia/Tokyo\n```\n\n> PHP Fatal error:  Call to undefined function mysql_connect()\u306e\u5bfe\u5fdc\n\n```diff:/etc/php/php.ini\n- ;extension=mysql.so\n+ extension=mysql.so\n```\n\nmysql.so \u306fphp5.5\u3067\u306fdeprecated\u3060\u3063\u305f\u3088\u3046\u306a\u3002\u4e00\u6642\u3057\u306e\u304e\n\n## postfix\n\n> error: open database /etc/postfix/aliases.db: No such file or directory\n> alias database unavailable \u306e\u5bfe\u5fdc\n\n```bash:\nnewaliases\n```\n\n# \u30b5\u30fc\u30d3\u30b9\u767b\u9332\n\n```bash:\nfor s in mysqld httpd postfix\ndo\n  systemctl enable $s\n  systemctl start $s\ndone\n```\n\n* DocumentRoot \u306f /srv/http\n* mariadb\u306f\u6a19\u6e96\u3067utf-8\n\n# tips\n\n## cgi-script\u304c\u4f7f\u3044\u305f\u3044\u5834\u5408\n\n```diff:conf/httpd.conf\n- #LoadModule cgi_module modules/mod_cgi.so\n+ LoadModule cgi_module modules/mod_cgi.so\n- #AddHandler cgi-script .cgi\n+ AddHandler cgi-script .cgi\n```\n\n```diff:conf/extra/httpd-vhosts.conf\n<VirtualHost *:80>\n    ...\n+   <Directory \"/srv/http/cgi\">\n+       Options +ExecCGI\n+       Require all granted\n+   </Directory>\n</VirtualHost>\n```\n\n## DocumentRoot\u3092\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\n\n* /srv/http/ \u304b\u3089 /srv/domainname/ \u306b\u5909\u66f4\u3059\u308b\u5834\u5408\n\n> PHP Warning:  Unknown: open_basedir restriction in effect. File(/srv/domainname/public/index.php) is not within the allowed path(s): (/srv/http/:/home/:/tmp/:/usr/share/pear/:/usr/share/webapps/) in Unknown on line 0\n\n```diff:/etc/php/php.ini\n- open_basedir = /srv/http/:/home/:/tmp/:/usr/share/pear/:/usr/share/webapps/\n+ ;open_basedir = /srv/http/:/home/:/tmp/:/usr/share/pear/:/usr/share/webapps/\n```\n\n## digest\u8a8d\u8a3c + .htaccess\n\n```diff:httpd.conf\n- #LoadModule auth_digest_module modules/mod_auth_digest.so\n+ LoadModule auth_digest_module modules/mod_auth_digest.so\n```\n\n```diff:extra/httpd-vhosts.conf\n  <Directory \"/srv/httpd/admin/\">\n+   AllowOverride AuthConfig\n    Require all granted   \n  </Directory>\n```\n\n```bash:.htaccess\nAuthType Digest\nAuthName \"member only\"\nAuthUserFile \"/srv/digest/.htdigest\"\nrequire valid-user\n```\n\n```bash:.htdigest\u4f5c\u6210\n$ htdigest -c /srv/digest/.htdigest \"member only\" user1\nAdding password for user1 in realm member only.\nNew password:\nRe-type new password:\n$ cat .htdigest\nuser1:member only:e9fc3e4e6f5fd3a18be2006b6a1964b9\n```\n\n## .htaccess\u3067php_value\u5024\u306e\u5909\u66f4\u3059\u308b\u305f\u3081\u306b\n\n> .htaccess: php_value not allowed here\n\n```diff:extra/httpd-vhosts.conf\n  <Directory \"/srv/httpd/admin/\">\n+   AllowOverride Options\n    Require all granted   \n  </Directory>\n```\n\n## .htaccess\u3067\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306e\u8a2d\u5b9a\u5909\u66f4\n\n```bash:.htaccess\nphp_value max_execution_time 600\nphp_value post_max_size 50M\nphp_value upload_max_filesize 50M\n```\n\n## userdir\n\n* [mod_userdir - Apache HTTP \u30b5\u30fc\u30d0 \u30d0\u30fc\u30b8\u30e7\u30f3 2.4](http://httpd.apache.org/docs/2.4/ja/mod/mod_userdir.html)\n\n```diff:extra/httpd-userdir.conf\n  UserDir public_html\n+ UserDir disabled\n+ UserDir enabled username1 username2\n```\n\n```bash:\nchown :http /home/username[12]/\nchmod g+rx /home/username[12]/\n```\n\npublic_html\u3092`http`\u30e6\u30fc\u30b6\u3067\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u6a29\u9650\u306b\u6c17\u3092\u3064\u3051\u308b\u3002\n\n\n# \u305d\u306e\u4ed6\n\n## netstat\u304c\u306a\u3044\u5834\u5408\n\n```bash:\npacman -Sy net-tools\n```\n", "tags": ["archLinux", "lamp"]}