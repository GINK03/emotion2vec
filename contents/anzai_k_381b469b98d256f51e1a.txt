{"context": " More than 1 year has passed since last update.\n\n\u80cc\u666f\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1\u6599\u524a\u6e1b\u306e\u305f\u3081\u3001Apache \u30b5\u30fc\u30d0\u30fc\u306b\u901a\u4fe1\u5727\u7e2e\u8a2d\u5b9a\u3092\u5165\u308c\u307e\u3057\u305f\u3002\n\u5165\u308c\u305f\u30e2\u30b8\u30e5\u30fc\u30eb\u306f mod_deflate \u3067\u3059\u3002\nDeflateFilterNote \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3092\u4f7f\u3048\u3070\u3001apache \u30ed\u30b0\u306b\u3066\u5727\u7e2e\u524d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u304c\u53d6\u308c\u308b\u3068\u30cd\u30c3\u30c8\u4e0a\u3067\u89e6\u308c\u8fbc\u307f\u306f\u3042\u308b\u3082\u306e\u306e\u3001\u516c\u5f0f\u30b5\u30a4\u30c8\u306b\u306f\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u304c\u53d6\u308c\u308b\u3068\u306f\u660e\u8a18\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u305d\u3053\u3067\u672c\u5f53\u306b DeflateFilterNote \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u5727\u7e2e\u524d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u304c\u53d6\u308c\u308b\u306e\u304b\u3092\u3001apache \u30ed\u30b0\u3001tcpdump \u304b\u3089\u691c\u8a3c\u3057\u305f\u8a71\u3067\u3059\u3002\n\napache \u30ed\u30b0\u66f8\u5f0f\n\n/etc/httpd/conf/httpd.conf\nDeflateFilterNote Input instream\n\nLogFormat '%t request:%r response_total:%O response_body:%B input:%{instream}n' deflate\nCustomLog logs/deflate_log deflate\n\n\ninstream...\u30d5\u30a3\u30eb\u30bf\u306e\u5165\u529b\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u30d0\u30a4\u30c8\u30ab\u30a6\u30f3\u30c8\u306e\u30e1\u30e2\n%t...\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\n%r...\u30ea\u30af\u30a8\u30b9\u30c8URI\n%O...\u5727\u7e2e\u5f8c\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30b5\u30a4\u30ba\n%B...\u5727\u7e2e\u5f8c\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\n\u8a73\u7d30\u306f\u3053\u3061\u3089\n\n\u5727\u7e2e\u8a2d\u5b9a\u3042\u308a\u306e apache \u30ed\u30b0\n/hoge/fuga \u306b\u5bfe\u3057\u3066\u5727\u7e2e\u8a2d\u5b9a\u3042\u308a\u6642\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u307e\u3057\u305f\u3002\n\u5727\u7e2e\u524d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u306f input \u3088\u308a40\u30d0\u30a4\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\n\n$ tail -f /etc/httpd/logs/deflate_log\n\n[18/Dec/2015:10:39:30 +0000] \nrequest:/hoge/fuga \nresponse_total:295\nresponse_body:58  \ninput:40\n\n\n\n\u5727\u7e2e\u8a2d\u5b9a\u306a\u3057\u306e tcpdump\n/hoge/fuga \u306b\u5bfe\u3057\u3066\u5727\u7e2e\u8a2d\u5b9a\u306a\u3057\u6642\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u307e\u3057\u305f\u3002\n\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u306f Content-Length \u3088\u308a40\u30d0\u30a4\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\n$ sudo tcpdump\n10:09:54.797870 IP \u9001\u4fe1\u5143 > \u9001\u4fe1\u5148: \nFlags [P.], seq 1:231, ack 919, win 155, options [nop,nop,TS val 1067968672 ecr 1692520408], length 230\nE.....@.@...\n..\n....P..j...v.rv...........\n?...d...\nHTTP/1.1 200 OK\nDate: Fri, 18 Dec 2015 10:09:54 GMT\nContent-Type: application/json\nContent-Length: 40\nConnection: close\n\n{\"hoge\":xxx,\"fuga\":\"xxxx\"}\n\n\n\u7d50\u8ad6\n\u300c\u5727\u7e2e\u8a2d\u5b9a\u3042\u308a\u306e input \uff1d \u5727\u7e2e\u8a2d\u5b9a\u306a\u3057\u306e Content-Length\u300d\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3088\u3063\u3066\u3001\u5df7\u3067\u8a00\u308f\u308c\u3066\u3044\u305f\u300capache \u30ed\u30b0\u306b\u3066\u5727\u7e2e\u524d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u304c\u53d6\u308c\u308b\u300d\u306f\u6b63\u3057\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n# \u80cc\u666f\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1\u6599\u524a\u6e1b\u306e\u305f\u3081\u3001Apache \u30b5\u30fc\u30d0\u30fc\u306b\u901a\u4fe1\u5727\u7e2e\u8a2d\u5b9a\u3092\u5165\u308c\u307e\u3057\u305f\u3002\n\u5165\u308c\u305f\u30e2\u30b8\u30e5\u30fc\u30eb\u306f [mod_deflate](https://httpd.apache.org/docs/2.2/ja/mod/mod_deflate.html) \u3067\u3059\u3002\nDeflateFilterNote \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3092\u4f7f\u3048\u3070\u3001apache \u30ed\u30b0\u306b\u3066\u5727\u7e2e\u524d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u304c\u53d6\u308c\u308b\u3068\u30cd\u30c3\u30c8\u4e0a\u3067\u89e6\u308c\u8fbc\u307f\u306f\u3042\u308b\u3082\u306e\u306e\u3001[\u516c\u5f0f\u30b5\u30a4\u30c8](https://httpd.apache.org/docs/2.2/ja/mod/mod_deflate.html#deflatefilternote)\u306b\u306f\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u304c\u53d6\u308c\u308b\u3068\u306f\u660e\u8a18\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u305d\u3053\u3067\u672c\u5f53\u306b DeflateFilterNote \u30c7\u30a3\u30ec\u30af\u30c6\u30a3\u30d6\u3067\u5727\u7e2e\u524d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u304c\u53d6\u308c\u308b\u306e\u304b\u3092\u3001apache \u30ed\u30b0\u3001tcpdump \u304b\u3089\u691c\u8a3c\u3057\u305f\u8a71\u3067\u3059\u3002\n# apache \u30ed\u30b0\u66f8\u5f0f\n\n```/etc/httpd/conf/httpd.conf\nDeflateFilterNote Input instream\n\nLogFormat '%t request:%r response_total:%O response_body:%B input:%{instream}n' deflate\nCustomLog logs/deflate_log deflate\n```\n\ninstream...\u30d5\u30a3\u30eb\u30bf\u306e\u5165\u529b\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u30d0\u30a4\u30c8\u30ab\u30a6\u30f3\u30c8\u306e\u30e1\u30e2\n%t...\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\n%r...\u30ea\u30af\u30a8\u30b9\u30c8URI\n%O...\u5727\u7e2e\u5f8c\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30b5\u30a4\u30ba\n%B...\u5727\u7e2e\u5f8c\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\n[\u8a73\u7d30\u306f\u3053\u3061\u3089](https://httpd.apache.org/docs/2.2/ja/logs.html#accesslog)\n# \u5727\u7e2e\u8a2d\u5b9a\u3042\u308a\u306e apache \u30ed\u30b0\n/hoge/fuga \u306b\u5bfe\u3057\u3066\u5727\u7e2e\u8a2d\u5b9a\u3042\u308a\u6642\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u307e\u3057\u305f\u3002\n\u5727\u7e2e\u524d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u306f input \u3088\u308a40\u30d0\u30a4\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n\n$ tail -f /etc/httpd/logs/deflate_log\n\n[18/Dec/2015:10:39:30 +0000] \nrequest:/hoge/fuga \nresponse_total:295\nresponse_body:58  \ninput:40\n\n```\n\n# \u5727\u7e2e\u8a2d\u5b9a\u306a\u3057\u306e tcpdump\n/hoge/fuga \u306b\u5bfe\u3057\u3066\u5727\u7e2e\u8a2d\u5b9a\u306a\u3057\u6642\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3057\u307e\u3057\u305f\u3002\n\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u306f Content-Length \u3088\u308a40\u30d0\u30a4\u30c8\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n$ sudo tcpdump\n10:09:54.797870 IP \u9001\u4fe1\u5143 > \u9001\u4fe1\u5148: \nFlags [P.], seq 1:231, ack 919, win 155, options [nop,nop,TS val 1067968672 ecr 1692520408], length 230\nE.....@.@...\n..\n....P..j...v.rv...........\n?...d...\nHTTP/1.1 200 OK\nDate: Fri, 18 Dec 2015 10:09:54 GMT\nContent-Type: application/json\nContent-Length: 40\nConnection: close\n\n{\"hoge\":xxx,\"fuga\":\"xxxx\"}\n```\n\n# \u7d50\u8ad6\n\u300c\u5727\u7e2e\u8a2d\u5b9a\u3042\u308a\u306e input \uff1d \u5727\u7e2e\u8a2d\u5b9a\u306a\u3057\u306e Content-Length\u300d\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u3088\u3063\u3066\u3001\u5df7\u3067\u8a00\u308f\u308c\u3066\u3044\u305f\u300capache \u30ed\u30b0\u306b\u3066\u5727\u7e2e\u524d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u30b5\u30a4\u30ba\u304c\u53d6\u308c\u308b\u300d\u306f\u6b63\u3057\u3044\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n", "tags": ["Apache", "tcpdump"]}