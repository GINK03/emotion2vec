{"tags": ["\u6a5f\u68b0\u5b66\u7fd2", "DeepLearning", "TensorFlow", "iOS", "\u4eba\u5de5\u77e5\u80fd"], "context": "TensorFlow \u306b iOS \u30b5\u30dd\u30fc\u30c8\u304c\u8ffd\u52a0\u3055\u308c\u305f \u3068\u3044\u3046\u30cb\u30e5\u30fc\u30b9\u3092\u898b\u304b\u3051\u305f\u306e\u3067\u3001\u30d3\u30eb\u30c9\u3057\u3066\u3001iOS\u3067\u52d5\u4f5c\u3055\u305b\u3066\u307f\u307e\u3057\u305f\u3002\n\n\uff08\u305f\u307e\u305f\u307e\u76ee\u306e\u524d\u306b\u3042\u3063\u305f\u6247\u98a8\u6a5f\u3082\u30d0\u30c3\u30c1\u30ea\u8a8d\u8b58\u3057\u3066\u304f\u308c\u307e\u3057\u305f\uff09\n\u672c\u8a18\u4e8b\u3067\u306f\u6700\u7d42\u7684\u306b\u3046\u307e\u304f\u3044\u3063\u305f\u624b\u9806\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u624b\u9806\u3092\u306a\u305e\u3063\u3066\u307f\u308b\u306b\u3042\u305f\u3063\u3066TensorFlow\u3084\u6a5f\u68b0\u5b66\u7fd2\u30fb\u30c7\u30a3\u30fc\u30d7\u30e9\u30fc\u30cb\u30f3\u30b0\u306b\u3064\u3044\u3066\u306e\u5c02\u9580\u77e5\u8b58\u306f\u4e0d\u8981\u3067\u3059\u306e\u3067\u305c\u3072\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\uff01\n\n\u30d3\u30eb\u30c9\u624b\u9806\n\niOS\u5411\u3051\u306bTensorFlow\u3092\u30d3\u30eb\u30c9\u3059\u308b\niOS\u30b5\u30dd\u30fc\u30c8\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u308bv0.9.0\u3092\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u30d3\u30eb\u30c9\u3057\u3066\u3044\u304d\u307e\u3059\u3002\u624b\u9806\u306f\u3053\u306e\u901a\u308a\u306b\u306a\u305e\u308b\u3060\u3051\u3067\u3059\u3057\u3001\u307b\u307c\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3060\u3051\u3067\u975e\u5e38\u306b\u7c21\u5358\u3067\u3059\uff08\u304c\u3001\u5b9f\u884c\u6642\u9593\u304c\u304b\u306a\u308a\u304b\u304b\u308a\u307e\u3059\uff09\u3002\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u3066 Eigen \u3084 Protobuf \u7b49\u306e\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\ncd tensorflow\ntensorflow/contrib/makefile/download_dependencies.sh\n\n\nprotobuf \u3092\u30d3\u30eb\u30c9\uff06\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\ncd tensorflow/contrib/makefile/downloads/protobuf/\n./autogen.sh\n./configure\nmake\nsudo make install\n\n\u3053\u3053\u3067\u3001\u50d5\u306e\u74b0\u5883\u3067\u306f ./autogen.sh \u5b9f\u884c\u6642\u306b\nCan't exec \"aclocal\": No such file or directory at /usr/local/Cellar/autoconf/2.69/share/autoconf/Autom4te/FileUtils.pm line 326.\nautoreconf: failed to run aclocal: No such file or directory\nshuichi-MacBook-Pro-Retina-15inch:protobuf shuichi$ ./configure\n-bash: ./configure: No such file or directory\n\n\u3068\u3044\u3046\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3057\u305f\u3002\"aclocal\"\u3068\u3044\u3046\u306e\u306f\u3001\"automake\"\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u3089\u3057\u3044\u306e\u3067\u3001automake\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\nbrew instal automake\n\n\u3067\u3001\u6539\u3081\u3066\n./autogen.sh\n./configure\nmake\nsudo make install\n\n\niOS native\u7248\u306eprotobuf\u3092\u30d3\u30eb\u30c9\n\ncd ../../../../..\ntensorflow/contrib/makefile/compile_ios_protobuf.sh\n\n\niOS\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u5411\u3051\u306bTensorFlow\u3092\u30d3\u30eb\u30c9\n\ntensorflow/contrib/makefile/compile_ios_tensorflow.sh\n\n\n\uff082016.8.22\u8ffd\u8a18\uff09v0.10.0 RC0 \u306e\u30d3\u30eb\u30c9\n\u73fe\u6642\u70b9\u3067\u306e\u6700\u65b0Release\u3067\u3042\u308b v0.10.0 RC0 \u306f\u3001\u4e0a\u8a18\u624b\u9806\u3067\u30d3\u30eb\u30c9\u3057\u3088\u3046\u3068\u3059\u308b\u3068 compile_ios_tensorflow.sh \u3092\u5b9f\u884c\u3059\u308b\u3068\u3053\u308d\u3067\u30b3\u30b1\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u4eca\u306f\u5404\u30d3\u30eb\u30c9\u306e\u624b\u9806\u304c\u307e\u308b\u3063\u3068\u5165\u3063\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\ntensorflow/contrib/makefile/build_all_ios.sh\n\n\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304b\u3089iOS\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u5411\u3051\u30d3\u30eb\u30c9\u307e\u3067\u3001\u3053\u308c\u4e00\u767a\u3067ok\u3067\u3057\u305f\u3002\n\n\u30b5\u30f3\u30d7\u30eb\u3092\u30d3\u30eb\u30c9\u3059\u308b\ntensorflow/tensorflow/contrib/ios_example \u306b2\u7a2e\u985e\u306e\u30b5\u30f3\u30d7\u30eb\u304c\u3042\u308a\u307e\u3059\u3002\nsimple \u3068\u540d\u4ed8\u3051\u3089\u308c\u305f\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306f\u3001\u4eca\u56de\u30d3\u30eb\u30c9\u3057\u305f static library \u3092\u30a2\u30d7\u30ea\u5185\u306b\u7d44\u307f\u8fbc\u3080\u969b\u306e\u6700\u5c0f\u5b9f\u88c5\u3068\u3057\u3066\u306e\u53c2\u8003\u306b\u306f\u306a\u308a\u305d\u3046\u3067\u3059\u304c\u3001\u30c7\u30e2\u3068\u3057\u3066\u898b\u3066\u697d\u3057\u3044\u6a5f\u80fd\u304c\u3042\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u672c\u8a18\u4e8b\u3067\u306f\u3082\u3046\u4e00\u65b9\u306e camera \u306e\u65b9\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u307e\u305a\u3001\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u3001\u89e3\u51cd\u3059\u308b\u3068\u5165\u3063\u3066\u3044\u308b\u3001\n\nimagenet_comp_graph_label_strings.txt\ntensorflow_inception_graph.pb\n\n\u306e2\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u3001tensorflow/contrib/ios_examples/camera/data \u306b\u7f6e\u304d\u307e\u3059\u30021\n\u3053\u306e Inception \u3068\u3044\u3046\u306e\u306fGoogle\u304c\u63d0\u4f9b\u3059\u308b\u753b\u50cf\u8a8d\u8b58\u7528\u306e\u5b66\u7fd2\u6e08\u307f\u30e2\u30c7\u30eb\u306e\u3088\u3046\u3067\u3059\u3002\n\nhttps://research.googleblog.com/2016/03/train-your-own-image-classifier-with.html\nhttps://github.com/google/inception\n\n\ncamera\u30b5\u30f3\u30d7\u30eb\u5b9f\u884c\u4f8b\ncamera\u30b5\u30f3\u30d7\u30eb\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u3059\u3050\u306b\u30ab\u30e1\u30e9\u304c\u8d77\u52d5\u3057\u307e\u3059\u3002\u8eab\u8fd1\u306e\u3082\u306e\u3092\u8272\u3005\u3068\u6620\u3057\u3066\u307f\u307e\u3057\u305f\u3002\uff08\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30ab\u30e1\u30e9\u5165\u529b\u306b\u5bfe\u3059\u308b\u8a8d\u8b58\u7d50\u679c\u3092\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\uff09\n\nMacBook\n\n\"Notebook\" \"Laptop\" \u3069\u3063\u3061\u3067\u3082\u6b63\u89e3\uff01\n\n\u6247\u98a8\u6a5f\n\n\"Electric Fan\" \u6b63\u89e3\uff01\n\n\u6905\u5b50\n\n\"Folding Chair\"\uff08\u6298\u308a\u305f\u305f\u307f\u6905\u5b50\uff09 \u60dc\u3057\u3044\u3002\u3002\u3067\u3059\u304c\u3001\u305d\u3082\u305d\u3082 imagenet_comp_graph_label_strings.txt \u306b\u306f chair \u304c3\u7a2e\u985e\u3057\u304b\u306a\u304f\u3066\u3001\u305d\u306e\u4e2d\u3067\u306f\u4e00\u756a\u8fd1\u3044\u3068\u8a00\u3063\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\niPhone\n\n\"iPod\"\u30fb\u30fb\u30fb\u60dc\u3057\u3044\uff01iPhone 6 Plus\u306a\u306e\u3067\u307b\u307c\u6b63\u89e3\u3068\u8a00\u3063\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\n\u4eca\u56decamera\u30b5\u30f3\u30d7\u30eb\u3092\u8a66\u3057\u305f\u30c7\u30d0\u30a4\u30b9\u306fiPhone 6\u3060\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u8a8d\u8b58\u306f\u307e\u3060\u307e\u3060\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3068\u306f\u8a00\u3044\u96e3\u304f\u3001\u6570\u79d2\u5358\u4f4d\u306e\u9045\u5ef6\u304c\u3042\u308b\u611f\u3058\u3067\u3057\u305f\u3002\u307e\u3060iOS\u5411\u3051\u306b\u30d3\u30eb\u30c9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3068\u3044\u3046\u3060\u3051\u3067iOS\u306b\u304a\u3051\u308b GPU Accelerated \u306f\u3055\u308c\u3066\u306a\u3044\u3067\u3059\u3057\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u6700\u9069\u5316\u306f\u307e\u3060\u307e\u3060\u3053\u308c\u304b\u3089\u306e\u3088\u3046\u3067\u3059\u3002\n\u3061\u306a\u307f\u306b iOS 10 \u3067 Accelerate.framework \u306b\u8ffd\u52a0\u3055\u308c\u305f BNNS (Basic neural network subroutines) \u3092\u4f7f\u7528\u3057\u305f\u6700\u9069\u5316\u3082issue\u306b\u6319\u304c\u3063\u3066\u3044\u307e\u3059\u3002\n\nUse Basic neural network subroutines (BNNS) on iOS \u00b7 Issue #3001 \u00b7 tensorflow/tensorflow\n\n\n\u30d3\u30eb\u30c9\u624b\u9806\u306e\u60c5\u5831\u30bd\u30fc\u30b9\niOS\u30b5\u30dd\u30fc\u30c8\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u308b0.9.0\u306e\u30c8\u30c3\u30d7\u968e\u5c64\u306b\u3042\u308bREADME\u3092\u898b\u3066\u3082\u3001iOS\u306b\u3064\u3044\u3066\u306f\u66f8\u304b\u308c\u3066\u3044\u307e\u305b\u3093\u3002\n\u4e0a\u8ff0\u3057\u305f\u30d3\u30eb\u30c9\u624b\u9806\u306fcontrib/makefile \u914d\u4e0b\u306eREADME\u306b\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\u95a2\u9023\u60c5\u5831\u3092\u4ee5\u4e0b\u306b\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\n\niOS\u30b5\u30dd\u30fc\u30c8\u306eIssue: iOS Support and Example \u00b7 Issue #16\n\niOS\u30b5\u30dd\u30fc\u30c8\u306ePull Request: Added iOS example by petewarden \u00b7 Pull Request #2561\n\n\u4e00\u756a\u95a2\u9023\u3059\u308b\u30b3\u30df\u30c3\u30c8: Enabled optimization flags for makefile, and added iOS example\n\n\n\n\u30b5\u30f3\u30d7\u30eb\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u8aad\u3093\u3067\u307f\u308b\n\u30b5\u30f3\u30d7\u30eb\u306f\u5168\u7de8Objective-C++\u3067\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u8aad\u3093\u3067\u3082\u308f\u304b\u3089\u306a\u3044\u3060\u308d\u3046\u3068\u601d\u3044\u3064\u3064\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u8aad\u3093\u3067\u307f\u307e\u3059\u3002\n\ntensorflow_utils\n\u30e2\u30c7\u30eb\u3068\u30e9\u30d9\u30eb\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u3080\u30e1\u30bd\u30c3\u30c9\u3068\u3001\u8a8d\u8b58\u7d50\u679c\u3092\u8fd4\u3059\u30e1\u30bd\u30c3\u30c9\u3092\u6301\u3064\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u30af\u30e9\u30b9\u306e\u3088\u3046\u3067\u3059\u3002\n\ntensorflow_utils.h\ntensorflow::Status LoadModel(NSString* file_name, NSString* file_type,\n                             std::unique_ptr<tensorflow::Session>* session);\ntensorflow::Status LoadLabels(NSString* file_name, NSString* file_type,\n                              std::vector<std::string>* label_strings);\nvoid GetTopN(const Eigen::TensorMap<Eigen::Tensor<float, 1, Eigen::RowMajor>,\n             Eigen::Aligned>& prediction, const int num_results,\n             const float threshold,\n             std::vector<std::pair<float, int> >* top_results);\n\n\n\u6c4e\u7528\u7684\u306b\u4f7f\u3048\u305d\u3046\u3002\n\nios_image_load\n\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u30af\u30e9\u30b9\u3002\n\nios_image_load.h\nstd::vector<tensorflow::uint8> LoadImageFromFile(const char* file_name,\n             int* out_width,\n             int* out_height,\n             int* out_channels);\n\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u306f\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3051\u3069\u4f7f\u308f\u308c\u3066\u306a\u3044\u3063\u307d\u3044\u3002\n\nCameraExampleViewController\n\u30b5\u30f3\u30d7\u30eb\u672c\u4f53\u3002\u809d\u3063\u307d\u3044\u3068\u3053\u308d\u3060\u3051\u3092\u62fe\u3063\u3066\u3044\u304f\u3068\u3001\nstd::unique_ptr<tensorflow::Session> \u306a\u30e1\u30f3\u30d0\u5909\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u3001\n\nCameraExampleViewController.mm\nstd::unique_ptr<tensorflow::Session> tf_session;\n\n\nviewDidLoad\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30e2\u30c7\u30eb\u3092\u301c.pb\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30ed\u30fc\u30c9\u3002\n\nCameraExampleViewController.mm\ntensorflow::Status load_status =\n  LoadModel(@\"tensorflow_inception_graph\", @\"pb\", &tf_session);\n\n\n\u3067\u3001\u30ab\u30e1\u30e9\u304b\u3089\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u5165\u529b\u304c\u5f97\u3089\u308c\u308b\u305f\u3073\u306b\u547c\u3070\u308c\u308b\u30c7\u30ea\u30b2\u30fc\u30c8\u30e1\u30bd\u30c3\u30c9\u3092\u898b\u3066\u307f\u308b\u3068\u3001\n\nCameraExampleViewController.mm\n- (void)captureOutput:(AVCaptureOutput *)captureOutput\ndidOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer\n       fromConnection:(AVCaptureConnection *)connection {\n  CVPixelBufferRef pixelBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);\n  [self runCNNOnFrame:pixelBuffer];\n}\n\n\nCMSampleBufferRef \u304b\u3089 CVPixelBufferRef \u3092\u53d6\u5f97\u3057\u3066 runCNNOnFrame: \u3092\u547c\u3093\u3067\u3044\u308b\u3060\u3051\u306e\u3088\u3046\u3067\u3059\u3002\nrunCNNOnFrame: \u306f\u30b3\u30fc\u30c9\u304c\u82e5\u5e72\u9577\u3044\u3067\u3059\u304c\u3001\u3053\u306e\u3078\u3093\u3068\u3001\n\nCameraExampleViewController.mm\ntensorflow::Tensor image_tensor(\n    tensorflow::DT_FLOAT,\n    tensorflow::TensorShape(\n        {1, wanted_height, wanted_width, wanted_channels}));\nauto image_tensor_mapped = image_tensor.tensor<float, 4>();\ntensorflow::uint8 *in = sourceStartAddr;\nfloat *out = image_tensor_mapped.data();\n\n\n\u3053\u306e\u3078\u3093\u304c\u809d\u3063\u307d\u3044\u3067\u3059\u3002\n\nCameraExampleViewController.mm\nif (tf_session.get()) {\n  std::string input_layer = \"input\";\n  std::string output_layer = \"output\";\n  std::vector<tensorflow::Tensor> outputs;\n  tensorflow::Status run_status = tf_session->Run(\n      {{input_layer, image_tensor}}, {output_layer}, {}, &outputs);\n  if (!run_status.ok()) {\n    LOG(ERROR) << \"Running model failed:\" << run_status;\n  } else {\n    tensorflow::Tensor *output = &outputs[0];\n    auto predictions = output->flat<float>();\n\n    // \u30e9\u30d9\u30eb\u53d6\u5f97\n  }\n}\n\n\n\u304c\u3001\u3059\u307f\u307e\u305b\u3093\u3001\u305d\u308c\u305e\u308c\u4f55\u3092\u3084\u3063\u3066\u3044\u308b\u306e\u304b\u3092\u89e3\u8aac\u3059\u308b\u306b\u306fTensorFlow\u306e\u51e6\u7406\u3092\u3061\u3083\u3093\u3068\u7406\u89e3\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002\u3002\uff08\u52c9\u5f37\u3057\u307e\u3059\uff09\n\n\u81ea\u5206\u306e\u30a2\u30d7\u30ea\u306b\u7d44\u307f\u8fbc\u3080\n\u8a66\u305b\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u3053\u3061\u3089 \u306b\u624b\u9806\u304c\u793a\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u306astatic library\uff08libtensorflow-core.a\uff09\u3092\u30d3\u30eb\u30c9\u3057\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3059\u308b\n\n\n[Library Search Paths] \u306b\u3082\u8ffd\u52a0\u3002\n\n\n\n\nThe `compile_ios_tensorflow.sh' script builds a universal static library in tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a. You'll need to add this to your linking build stage, and in Search Paths add tensorflow/contrib/makefile/gen/lib to the Library Search Paths setting.\n\n\nlibprotobuf.a \u3068 libprotobuf-lite.a \u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u3002\n\n\n[Library Search Paths]\u306b\u3082\u8ffd\u52a0\n\n\n\n\nYou'll also need to add libprotobuf.a and libprotobuf-lite.a from tensorflow/contrib/makefile/gen/protobuf_ios/lib to your Build Stages and Library Search Paths.\n\n\n[Header Search paths] \u3092\u8ffd\u52a0\n\n\nThe Header Search paths needs to contain the root folder of tensorflow, tensorflow/contrib/makefile/downloads/protobuf/src, tensorflow/contrib/makefile/downloads, tensorflow/contrib/makefile/downloads/eigen-eigen-, and tensorflow/contrib/makefile/gen/proto.\n\n\n[Other Linker Flags] \u306b -force_load \u3092\u8ffd\u52a0\n\n\nIn the Linking section, you need to add -force_load followed by the path to the TensorFlow static library in the Other Linker Flags section. This ensures that the global C++ objects that are used to register important classes inside the library are not stripped out. To the linker, they can appear unused because no other code references the variables, but in fact their constructors have the important side effect of registering the class.\n\n\nbitcode\u3092\u7121\u52b9\u306b\u3059\u308b\n\n\nThe library doesn't currently support bitcode, so you'll need to disable that in your project settings.\n\n\n\u307e\u3068\u3081\nTensorFlow\u3092iOS\u5411\u3051\u306b\u30d3\u30eb\u30c9\u3057\u3001\u4ed8\u5c5e\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u52d5\u304b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u6700\u9069\u5316\u7b49\u3001\u307e\u3060\u307e\u3060\u3053\u308c\u304b\u3089\u611f\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u6247\u98a8\u6a5f\u3084\u6905\u5b50\u3001\u30ce\u30fc\u30c8\u30d1\u30bd\u30b3\u30f3\u3084iPhone\u7b49\u3001\u5927\u304d\u3055\u3082\u5f62\u3082\u5168\u7136\u9055\u3046\u3082\u306e\u3092\u8a8d\u8b58\u3057\u3066\u304f\u308c\u3066\u672a\u6765\u3092\u611f\u3058\u307e\u3059\u3002\n\u8a66\u3057\u3066\u307f\u308b\u3060\u3051\u306a\u3089\u6a5f\u68b0\u5b66\u7fd2\u3084TensorFlow\u306b\u3064\u3044\u3066\u306e\u5c02\u9580\u77e5\u8b58\u3092\u5fc5\u8981\u3068\u3057\u307e\u305b\u3093\u3057\u3001\u305c\u3072\u304a\u624b\u5143\u3067\u52d5\u304b\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff01\n\u307e\u305f\u3001\u672c\u8a18\u4e8b\u540c\u69d8\u306b\u300c\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\u300d\u30b7\u30ea\u30fc\u30ba\u3068\u3057\u3066\u3001\u3053\u3061\u3089\u3082\u3088\u308d\u3057\u3051\u308c\u3070\u3069\u3046\u305e\uff1a\n\n\u30c7\u30a3\u30fc\u30d7\u30e9\u30fc\u30cb\u30f3\u30b0\u306e\u6709\u540d\u30e9\u30a4\u30d6\u30e9\u30ea5\u7a2e\u3092\u6700\u77ed\u8ddd\u96e2\u3067\u8a66\u3059\u534a\u65e5\u30b3\u30fc\u30b9\uff08TensorFlow, Chainer, Caffe, DeepDream, \u753b\u98a8\u5909\u63db\uff09 - Qiita\n\n\n\n\n\n\u3061\u306a\u307f\u306b\u3053\u306e\u3068\u304d\u3001 https://github.com/miyosuda/TensorFlowAndroidDemo/find/master \u306b\u3042\u308b\u540c\u540d\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u3063\u3066\u3082\u3001\u3061\u3083\u3093\u3068\u52d5\u304d\u307e\u305b\u3093\u3002\u53c2\u8003\u00a0\u21a9\n\n\n\n[TensorFlow \u306b iOS \u30b5\u30dd\u30fc\u30c8\u304c\u8ffd\u52a0\u3055\u308c\u305f](http://japan.cnet.com/news/service/35083908/) \u3068\u3044\u3046\u30cb\u30e5\u30fc\u30b9\u3092\u898b\u304b\u3051\u305f\u306e\u3067\u3001<b>\u30d3\u30eb\u30c9\u3057\u3066\u3001iOS\u3067\u52d5\u4f5c</b>\u3055\u305b\u3066\u307f\u307e\u3057\u305f\u3002\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/3180/4b7ddd7b-357d-a2fc-32a7-64878e020de5.jpeg\" width=\"240\">\n\n\uff08<b>\u305f\u307e\u305f\u307e\u76ee\u306e\u524d\u306b\u3042\u3063\u305f\u6247\u98a8\u6a5f\u3082\u30d0\u30c3\u30c1\u30ea\u8a8d\u8b58</b>\u3057\u3066\u304f\u308c\u307e\u3057\u305f\uff09\n\n\n\u672c\u8a18\u4e8b\u3067\u306f<b>\u6700\u7d42\u7684\u306b\u3046\u307e\u304f\u3044\u3063\u305f\u624b\u9806</b>\u3092\u66f8\u3044\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u624b\u9806\u3092\u306a\u305e\u3063\u3066\u307f\u308b\u306b\u3042\u305f\u3063\u3066<b><span class=\"deco\" style=\"color:#FF0000;\">TensorFlow\u3084\u6a5f\u68b0\u5b66\u7fd2\u30fb\u30c7\u30a3\u30fc\u30d7\u30e9\u30fc\u30cb\u30f3\u30b0\u306b\u3064\u3044\u3066\u306e\u5c02\u9580\u77e5\u8b58\u306f\u4e0d\u8981</span></b>\u3067\u3059\u306e\u3067\u305c\u3072\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\uff01\n\n\n##\u30d3\u30eb\u30c9\u624b\u9806\n\n###iOS\u5411\u3051\u306bTensorFlow\u3092\u30d3\u30eb\u30c9\u3059\u308b\n\niOS\u30b5\u30dd\u30fc\u30c8\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u308b<b>v0.9.0\u3092\u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8</b>\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u624b\u9806\u3067\u30d3\u30eb\u30c9\u3057\u3066\u3044\u304d\u307e\u3059\u3002\u624b\u9806\u306f\u3053\u306e\u901a\u308a\u306b\u306a\u305e\u308b\u3060\u3051\u3067\u3059\u3057\u3001<b>\u307b\u307c\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u3060\u3051</b>\u3067\u975e\u5e38\u306b\u7c21\u5358\u3067\u3059\uff08\u304c\u3001<span class=\"deco\" style=\"color:#FF0000;\">\u5b9f\u884c\u6642\u9593\u304c\u304b\u306a\u308a\u304b\u304b\u308a\u307e\u3059</span>\uff09\u3002\n\n\n- \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u3066 Eigen \u3084 Protobuf \u7b49\u306e\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\n```bash\ncd tensorflow\ntensorflow/contrib/makefile/download_dependencies.sh\n```\n\n\n- protobuf \u3092\u30d3\u30eb\u30c9\uff06\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\ncd tensorflow/contrib/makefile/downloads/protobuf/\n./autogen.sh\n./configure\nmake\nsudo make install\n```\n\n\n\u3053\u3053\u3067\u3001\u50d5\u306e\u74b0\u5883\u3067\u306f `./autogen.sh` \u5b9f\u884c\u6642\u306b\n\n```\nCan't exec \"aclocal\": No such file or directory at /usr/local/Cellar/autoconf/2.69/share/autoconf/Autom4te/FileUtils.pm line 326.\nautoreconf: failed to run aclocal: No such file or directory\nshuichi-MacBook-Pro-Retina-15inch:protobuf shuichi$ ./configure\n-bash: ./configure: No such file or directory\n```\n\n\u3068\u3044\u3046\u30a8\u30e9\u30fc\u304c\u51fa\u307e\u3057\u305f\u3002[\"aclocal\"\u3068\u3044\u3046\u306e\u306f\u3001\"automake\"\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u542b\u307e\u308c\u3066\u3044\u308b\u3089\u3057\u3044](http://qiita.com/DQNEO/items/11d6056547cab0632901)\u306e\u3067\u3001automake\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3002\n\n```bash\nbrew instal automake\n```\n\n\n\u3067\u3001\u6539\u3081\u3066\n\n```bash\n./autogen.sh\n./configure\nmake\nsudo make install\n```\n\n\n- iOS native\u7248\u306eprotobuf\u3092\u30d3\u30eb\u30c9\n\n```bash\ncd ../../../../..\ntensorflow/contrib/makefile/compile_ios_protobuf.sh\n```\n\n\n- iOS\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u5411\u3051\u306bTensorFlow\u3092\u30d3\u30eb\u30c9\n\n```bash\ntensorflow/contrib/makefile/compile_ios_tensorflow.sh\n```\n\n###\uff082016.8.22\u8ffd\u8a18\uff09v0.10.0 RC0 \u306e\u30d3\u30eb\u30c9\n\n\u73fe\u6642\u70b9\u3067\u306e\u6700\u65b0Release\u3067\u3042\u308b [v0.10.0 RC0](https://github.com/tensorflow/tensorflow/releases/tag/v0.10.0rc0) \u306f\u3001\u4e0a\u8a18\u624b\u9806\u3067\u30d3\u30eb\u30c9\u3057\u3088\u3046\u3068\u3059\u308b\u3068 compile_ios_tensorflow.sh \u3092\u5b9f\u884c\u3059\u308b\u3068\u3053\u308d\u3067\u30b3\u30b1\u3066\u3057\u307e\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u4eca\u306f\u5404\u30d3\u30eb\u30c9\u306e\u624b\u9806\u304c\u307e\u308b\u3063\u3068\u5165\u3063\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n```\ntensorflow/contrib/makefile/build_all_ios.sh\n```\n\n**\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304b\u3089iOS\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u5411\u3051\u30d3\u30eb\u30c9\u307e\u3067\u3001\u3053\u308c\u4e00\u767a\u3067ok**\u3067\u3057\u305f\u3002\n\n\n##\u30b5\u30f3\u30d7\u30eb\u3092\u30d3\u30eb\u30c9\u3059\u308b\n\n`tensorflow/tensorflow/contrib/ios_example` \u306b2\u7a2e\u985e\u306e\u30b5\u30f3\u30d7\u30eb\u304c\u3042\u308a\u307e\u3059\u3002\n\n\nsimple \u3068\u540d\u4ed8\u3051\u3089\u308c\u305f\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306f\u3001\u4eca\u56de<b>\u30d3\u30eb\u30c9\u3057\u305f static library \u3092\u30a2\u30d7\u30ea\u5185\u306b\u7d44\u307f\u8fbc\u3080\u969b\u306e\u6700\u5c0f\u5b9f\u88c5</b>\u3068\u3057\u3066\u306e\u53c2\u8003\u306b\u306f\u306a\u308a\u305d\u3046\u3067\u3059\u304c\u3001\u30c7\u30e2\u3068\u3057\u3066\u898b\u3066\u697d\u3057\u3044\u6a5f\u80fd\u304c\u3042\u308b\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u672c\u8a18\u4e8b\u3067\u306f\u3082\u3046\u4e00\u65b9\u306e camera \u306e\u65b9\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\n\n\u307e\u305a\u3001[\u3053\u306e\u30d5\u30a1\u30a4\u30eb](https://storage.googleapis.com/download.tensorflow.org/models/inception5h.zip)\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u3001\u89e3\u51cd\u3059\u308b\u3068\u5165\u3063\u3066\u3044\u308b\u3001\n\n- imagenet_comp_graph_label_strings.txt\n- tensorflow_inception_graph.pb\n\n\u306e2\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u3001`tensorflow/contrib/ios_examples/camera/data` \u306b\u7f6e\u304d\u307e\u3059\u3002[^1]\n\n[^1]: \u3061\u306a\u307f\u306b\u3053\u306e\u3068\u304d\u3001 https://github.com/miyosuda/TensorFlowAndroidDemo/find/master \u306b\u3042\u308b\u540c\u540d\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u3063\u3066\u3082\u3001\u3061\u3083\u3093\u3068\u52d5\u304d\u307e\u305b\u3093\u3002[\u53c2\u8003](https://github.com/tensorflow/tensorflow/issues/2923)\n\n\n\u3053\u306e Inception \u3068\u3044\u3046\u306e\u306fGoogle\u304c\u63d0\u4f9b\u3059\u308b<b>\u753b\u50cf\u8a8d\u8b58\u7528\u306e\u5b66\u7fd2\u6e08\u307f\u30e2\u30c7\u30eb</b>\u306e\u3088\u3046\u3067\u3059\u3002\n\n- https://research.googleblog.com/2016/03/train-your-own-image-classifier-with.html\n- https://github.com/google/inception\n\n\n##camera\u30b5\u30f3\u30d7\u30eb\u5b9f\u884c\u4f8b\n\ncamera\u30b5\u30f3\u30d7\u30eb\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u3059\u3050\u306b\u30ab\u30e1\u30e9\u304c\u8d77\u52d5\u3057\u307e\u3059\u3002\u8eab\u8fd1\u306e\u3082\u306e\u3092\u8272\u3005\u3068\u6620\u3057\u3066\u307f\u307e\u3057\u305f\u3002\uff08\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u30ab\u30e1\u30e9\u5165\u529b\u306b\u5bfe\u3059\u308b\u8a8d\u8b58\u7d50\u679c\u3092\u8868\u793a\u3057\u3066\u304f\u308c\u307e\u3059\uff09\n\n\n###MacBook\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/3180/eb67230c-ae2b-22ae-4e95-e5b0fb17c0cf.jpeg\" width=\"240\">\n\n\"Notebook\" \"Laptop\" \u3069\u3063\u3061\u3067\u3082\u6b63\u89e3\uff01\n\n\n###\u6247\u98a8\u6a5f\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/3180/4b7ddd7b-357d-a2fc-32a7-64878e020de5.jpeg\" width=\"240\">\n\n\"Electric Fan\" \u6b63\u89e3\uff01\n\n\n###\u6905\u5b50\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/3180/120b6678-aead-b9f7-b460-5b1164095395.jpeg\" width=\"240\">\n\n\"Folding Chair\"\uff08\u6298\u308a\u305f\u305f\u307f\u6905\u5b50\uff09 \u60dc\u3057\u3044\u3002\u3002\u3067\u3059\u304c\u3001\u305d\u3082\u305d\u3082 `imagenet_comp_graph_label_strings.txt` \u306b\u306f chair \u304c3\u7a2e\u985e\u3057\u304b\u306a\u304f\u3066\u3001\u305d\u306e\u4e2d\u3067\u306f\u4e00\u756a\u8fd1\u3044\u3068\u8a00\u3063\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\n###iPhone\n\n<img src=\"https://qiita-image-store.s3.amazonaws.com/0/3180/5a587869-cfec-565e-2765-c115d66acd92.jpeg\" width=\"240\">\n\n\"iPod\"\u30fb\u30fb\u30fb\u60dc\u3057\u3044\uff01<b>iPhone 6 Plus\u306a\u306e\u3067\u307b\u307c\u6b63\u89e3</b>\u3068\u8a00\u3063\u3066\u3082\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\n##\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\n\n\u4eca\u56decamera\u30b5\u30f3\u30d7\u30eb\u3092\u8a66\u3057\u305f\u30c7\u30d0\u30a4\u30b9\u306fiPhone 6\u3060\u3063\u305f\u306e\u3067\u3059\u304c\u3001**\u8a8d\u8b58\u306f\u307e\u3060\u307e\u3060\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3068\u306f\u8a00\u3044\u96e3\u304f\u3001\u6570\u79d2\u5358\u4f4d\u306e\u9045\u5ef6**\u304c\u3042\u308b\u611f\u3058\u3067\u3057\u305f\u3002\u307e\u3060iOS\u5411\u3051\u306b\u30d3\u30eb\u30c9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3068\u3044\u3046\u3060\u3051\u3067<b>iOS\u306b\u304a\u3051\u308b GPU Accelerated \u306f\u3055\u308c\u3066\u306a\u3044</b>\u3067\u3059\u3057\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u6700\u9069\u5316\u306f\u307e\u3060\u307e\u3060\u3053\u308c\u304b\u3089\u306e\u3088\u3046\u3067\u3059\u3002\n\n\n\u3061\u306a\u307f\u306b <b>iOS 10 \u3067 Accelerate.framework \u306b\u8ffd\u52a0\u3055\u308c\u305f BNNS</b> (Basic neural network subroutines) \u3092\u4f7f\u7528\u3057\u305f\u6700\u9069\u5316\u3082issue\u306b\u6319\u304c\u3063\u3066\u3044\u307e\u3059\u3002\n\n- [Use Basic neural network subroutines (BNNS) on iOS &#183; Issue #3001 &#183; tensorflow/tensorflow](https://github.com/tensorflow/tensorflow/issues/3001)\n\n\n##\u30d3\u30eb\u30c9\u624b\u9806\u306e\u60c5\u5831\u30bd\u30fc\u30b9\n\niOS\u30b5\u30dd\u30fc\u30c8\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3042\u308b[0.9.0](https://github.com/tensorflow/tensorflow/tree/v0.9.0)\u306e**\u30c8\u30c3\u30d7\u968e\u5c64\u306b\u3042\u308bREADME\u3092\u898b\u3066\u3082\u3001iOS\u306b\u3064\u3044\u3066\u306f\u66f8\u304b\u308c\u3066\u3044\u307e\u305b\u3093**\u3002\n\n\u4e0a\u8ff0\u3057\u305f\u30d3\u30eb\u30c9\u624b\u9806\u306f[`contrib/makefile` \u914d\u4e0b\u306eREADME](https://github.com/petewarden4prs/tensorflow/blob/c7c966eb2f1ac5d89ce7999d7eab53783e74abb7/tensorflow/contrib/makefile/README.md#ios)\u306b\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u95a2\u9023\u60c5\u5831\u3092\u4ee5\u4e0b\u306b\u307e\u3068\u3081\u3066\u304a\u304d\u307e\u3059\u3002\n\n- iOS\u30b5\u30dd\u30fc\u30c8\u306eIssue: [iOS Support and Example &#183; Issue #16](https://github.com/tensorflow/tensorflow/issues/16)\n- iOS\u30b5\u30dd\u30fc\u30c8\u306ePull Request: [Added iOS example by petewarden &#183; Pull Request #2561](https://github.com/tensorflow/tensorflow/pull/2561)\n- \u4e00\u756a\u95a2\u9023\u3059\u308b\u30b3\u30df\u30c3\u30c8: [Enabled optimization flags for makefile, and added iOS example](https://github.com/tensorflow/tensorflow/pull/2561/commits/c7c966eb2f1ac5d89ce7999d7eab53783e74abb7)\n\n\n##\u30b5\u30f3\u30d7\u30eb\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u8aad\u3093\u3067\u307f\u308b\n\n\u30b5\u30f3\u30d7\u30eb\u306f\u5168\u7de8Objective-C++\u3067\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002\u8aad\u3093\u3067\u3082\u308f\u304b\u3089\u306a\u3044\u3060\u308d\u3046\u3068\u601d\u3044\u3064\u3064\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u8aad\u3093\u3067\u307f\u307e\u3059\u3002\n\n\n###tensorflow_utils\n\n\u30e2\u30c7\u30eb\u3068\u30e9\u30d9\u30eb\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u3080\u30e1\u30bd\u30c3\u30c9\u3068\u3001\u8a8d\u8b58\u7d50\u679c\u3092\u8fd4\u3059\u30e1\u30bd\u30c3\u30c9\u3092\u6301\u3064\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u30af\u30e9\u30b9\u306e\u3088\u3046\u3067\u3059\u3002\n\n```cpp:tensorflow_utils.h\ntensorflow::Status LoadModel(NSString* file_name, NSString* file_type,\n                             std::unique_ptr<tensorflow::Session>* session);\ntensorflow::Status LoadLabels(NSString* file_name, NSString* file_type,\n                              std::vector<std::string>* label_strings);\nvoid GetTopN(const Eigen::TensorMap<Eigen::Tensor<float, 1, Eigen::RowMajor>,\n             Eigen::Aligned>& prediction, const int num_results,\n             const float threshold,\n             std::vector<std::pair<float, int> >* top_results);\n```\n\n\u6c4e\u7528\u7684\u306b\u4f7f\u3048\u305d\u3046\u3002\n\n\n###ios_image_load\n\n\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u30af\u30e9\u30b9\u3002\n\n```cpp:ios_image_load.h\nstd::vector<tensorflow::uint8> LoadImageFromFile(const char* file_name,\n             int* out_width,\n             int* out_height,\n             int* out_channels);\n```\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u306f\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u3051\u3069\u4f7f\u308f\u308c\u3066\u306a\u3044\u3063\u307d\u3044\u3002\n\n\n###CameraExampleViewController\n\n\u30b5\u30f3\u30d7\u30eb\u672c\u4f53\u3002\u809d\u3063\u307d\u3044\u3068\u3053\u308d\u3060\u3051\u3092\u62fe\u3063\u3066\u3044\u304f\u3068\u3001\n\n\n`std::unique_ptr<tensorflow::Session>` \u306a\u30e1\u30f3\u30d0\u5909\u6570\u3092\u5b9a\u7fa9\u3057\u3066\u3001\n\n```cpp:CameraExampleViewController.mm\nstd::unique_ptr<tensorflow::Session> tf_session;\n```\n\n\nviewDidLoad\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067<b>\u30e2\u30c7\u30eb\u3092&#12316;.pb\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u30ed\u30fc\u30c9</b>\u3002\n\n```cpp:CameraExampleViewController.mm\ntensorflow::Status load_status =\n  LoadModel(@\"tensorflow_inception_graph\", @\"pb\", &tf_session);\n```\n\n\n\u3067\u3001\u30ab\u30e1\u30e9\u304b\u3089\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u5165\u529b\u304c\u5f97\u3089\u308c\u308b\u305f\u3073\u306b\u547c\u3070\u308c\u308b\u30c7\u30ea\u30b2\u30fc\u30c8\u30e1\u30bd\u30c3\u30c9\u3092\u898b\u3066\u307f\u308b\u3068\u3001\n\n```objc:CameraExampleViewController.mm\n- (void)captureOutput:(AVCaptureOutput *)captureOutput\ndidOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer\n       fromConnection:(AVCaptureConnection *)connection {\n  CVPixelBufferRef pixelBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);\n  [self runCNNOnFrame:pixelBuffer];\n}\n```\n\nCMSampleBufferRef \u304b\u3089 CVPixelBufferRef \u3092\u53d6\u5f97\u3057\u3066 `runCNNOnFrame:` \u3092\u547c\u3093\u3067\u3044\u308b\u3060\u3051\u306e\u3088\u3046\u3067\u3059\u3002\n\n\n`runCNNOnFrame:` \u306f\u30b3\u30fc\u30c9\u304c\u82e5\u5e72\u9577\u3044\u3067\u3059\u304c\u3001\u3053\u306e\u3078\u3093\u3068\u3001\n\n```cpp:CameraExampleViewController.mm\ntensorflow::Tensor image_tensor(\n    tensorflow::DT_FLOAT,\n    tensorflow::TensorShape(\n        {1, wanted_height, wanted_width, wanted_channels}));\nauto image_tensor_mapped = image_tensor.tensor<float, 4>();\ntensorflow::uint8 *in = sourceStartAddr;\nfloat *out = image_tensor_mapped.data();\n```\n\n\n\u3053\u306e\u3078\u3093\u304c\u809d\u3063\u307d\u3044\u3067\u3059\u3002\n\n```cpp:CameraExampleViewController.mm\nif (tf_session.get()) {\n  std::string input_layer = \"input\";\n  std::string output_layer = \"output\";\n  std::vector<tensorflow::Tensor> outputs;\n  tensorflow::Status run_status = tf_session->Run(\n      {{input_layer, image_tensor}}, {output_layer}, {}, &outputs);\n  if (!run_status.ok()) {\n    LOG(ERROR) << \"Running model failed:\" << run_status;\n  } else {\n    tensorflow::Tensor *output = &outputs[0];\n    auto predictions = output->flat<float>();\n\n    // \u30e9\u30d9\u30eb\u53d6\u5f97\n  }\n}\n```\n\n\n\u304c\u3001\u3059\u307f\u307e\u305b\u3093\u3001\u305d\u308c\u305e\u308c\u4f55\u3092\u3084\u3063\u3066\u3044\u308b\u306e\u304b\u3092\u89e3\u8aac\u3059\u308b\u306b\u306fTensorFlow\u306e\u51e6\u7406\u3092\u3061\u3083\u3093\u3068\u7406\u89e3\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002\u3002\uff08\u52c9\u5f37\u3057\u307e\u3059\uff09\n\n\n##\u81ea\u5206\u306e\u30a2\u30d7\u30ea\u306b\u7d44\u307f\u8fbc\u3080\n\n\u8a66\u305b\u3066\u3044\u307e\u305b\u3093\u304c\u3001[\u3053\u3061\u3089](http://stackoverflow.com/questions/37769904/how-to-compile-ios-example-in-tensorflow) \u306b\u624b\u9806\u304c\u793a\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002\n\n- \u30e6\u30cb\u30d0\u30fc\u30b5\u30eb\u306astatic library\uff08libtensorflow-core.a\uff09\u3092\u30d3\u30eb\u30c9\u3057\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3059\u308b\n  - [Library Search Paths] \u306b\u3082\u8ffd\u52a0\u3002\n\n> The `compile_ios_tensorflow.sh' script builds a universal static library in tensorflow/contrib/makefile/gen/lib/libtensorflow-core.a. You'll need to add this to your linking build stage, and in Search Paths add tensorflow/contrib/makefile/gen/lib to the Library Search Paths setting.\n\n- libprotobuf.a \u3068 libprotobuf-lite.a \u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u3002\n  - [Library Search Paths]\u306b\u3082\u8ffd\u52a0\n\n> You'll also need to add libprotobuf.a and libprotobuf-lite.a from tensorflow/contrib/makefile/gen/protobuf_ios/lib to your Build Stages and Library Search Paths.\n\n\n- [Header Search paths] \u3092\u8ffd\u52a0\n\n> The Header Search paths needs to contain the root folder of tensorflow, tensorflow/contrib/makefile/downloads/protobuf/src, tensorflow/contrib/makefile/downloads, tensorflow/contrib/makefile/downloads/eigen-eigen-, and tensorflow/contrib/makefile/gen/proto.\n\n- [Other Linker Flags] \u306b `-force_load` \u3092\u8ffd\u52a0\n\n> In the Linking section, you need to add -force_load followed by the path to the TensorFlow static library in the Other Linker Flags section. This ensures that the global C++ objects that are used to register important classes inside the library are not stripped out. To the linker, they can appear unused because no other code references the variables, but in fact their constructors have the important side effect of registering the class.\n\n- bitcode\u3092\u7121\u52b9\u306b\u3059\u308b\n\n> The library doesn't currently support bitcode, so you'll need to disable that in your project settings.\n\n\n##\u307e\u3068\u3081\n\nTensorFlow\u3092iOS\u5411\u3051\u306b\u30d3\u30eb\u30c9\u3057\u3001\u4ed8\u5c5e\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u52d5\u304b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u6700\u9069\u5316\u7b49\u3001\u307e\u3060\u307e\u3060\u3053\u308c\u304b\u3089\u611f\u306f\u3042\u308a\u307e\u3059\u304c\u3001\u6247\u98a8\u6a5f\u3084\u6905\u5b50\u3001\u30ce\u30fc\u30c8\u30d1\u30bd\u30b3\u30f3\u3084iPhone\u7b49\u3001\u5927\u304d\u3055\u3082\u5f62\u3082\u5168\u7136\u9055\u3046\u3082\u306e\u3092\u8a8d\u8b58\u3057\u3066\u304f\u308c\u3066\u672a\u6765\u3092\u611f\u3058\u307e\u3059\u3002\n\n\n\u8a66\u3057\u3066\u307f\u308b\u3060\u3051\u306a\u3089\u6a5f\u68b0\u5b66\u7fd2\u3084TensorFlow\u306b\u3064\u3044\u3066\u306e\u5c02\u9580\u77e5\u8b58\u3092\u5fc5\u8981\u3068\u3057\u307e\u305b\u3093\u3057\u3001\u305c\u3072\u304a\u624b\u5143\u3067\u52d5\u304b\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\uff01\n\n\u307e\u305f\u3001\u672c\u8a18\u4e8b\u540c\u69d8\u306b\u300c\u3068\u308a\u3042\u3048\u305a\u52d5\u304b\u3057\u3066\u307f\u308b\u300d\u30b7\u30ea\u30fc\u30ba\u3068\u3057\u3066\u3001\u3053\u3061\u3089\u3082\u3088\u308d\u3057\u3051\u308c\u3070\u3069\u3046\u305e\uff1a\n\n- [\u30c7\u30a3\u30fc\u30d7\u30e9\u30fc\u30cb\u30f3\u30b0\u306e\u6709\u540d\u30e9\u30a4\u30d6\u30e9\u30ea5\u7a2e\u3092\u6700\u77ed\u8ddd\u96e2\u3067\u8a66\u3059\u534a\u65e5\u30b3\u30fc\u30b9\uff08TensorFlow, Chainer, Caffe, DeepDream, \u753b\u98a8\u5909\u63db\uff09 - Qiita](http://qiita.com/shu223/items/a4fc17eb3356a6068553)\n\n \n"}