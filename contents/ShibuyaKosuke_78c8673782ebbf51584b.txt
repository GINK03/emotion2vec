{"tags": ["PHP", "\u30ed\u30b0\u30a4\u30f3"], "context": "\n\u57fa\u672c\u8a2d\u8a08\u3001\u30e6\u30fc\u30b6\u30fc\u30e2\u30c7\u30eb\n\u30aa\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc\n\u4f8b\u5916\u30fb\u30ed\u30b0\n\nPDO \u30b7\u30f3\u30b0\u30eb\u30c8\u30f3\u3000SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\n\n\u6c4e\u7528\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30fb\u30af\u30e9\u30b9\u4f5c\u6210\n\n\n\u30e6\u30fc\u30b6\u30fc\u30e2\u30c7\u30eb\u306e\u4f5c\u6210\n\u30af\u30e9\u30b9\u306e\u7d99\u627f\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30fb\u30af\u30e9\u30b9\u306e\u5b9f\u88c5\n\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u6a5f\u80fd\u306e\u5b9f\u88c5\n\u30e1\u30fc\u30eb\u9001\u4fe1\u6a5f\u80fd\u306e\u5b9f\u88c5\n\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u89e3\u9664\u6a5f\u80fd\u306e\u5b9f\u88c5\nCSRF\u5bfe\u7b56\n\n\n\u306f\u3058\u3081\u306b\n\u3000\u30e1\u30fc\u30eb\u9001\u4fe1\u306b\u3064\u3044\u3066\u306f\u3001\u591a\u304f\u306e\u5165\u9580\u66f8\u5e2d\u306b\u3042\u308b\u3088\u3046\u306a\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u306f\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u3053\u3068\u304c\u591a\u3044\u3002\u304b\u3064\u3066\u3053\u306e\u3088\u3046\u306a\u8a18\u4e8b\u3082\u66f8\u304b\u305b\u3066\u3082\u3089\u3044\u307e\u3057\u305f\u3002\n\u3000\u8981\u70b9\u3068\u3057\u3066\u306f \u3061\u3083\u3093\u3068SMTP\u30b5\u30fc\u30d0\u30fc\u3092\u901a\u3057\u3066\u30e1\u30fc\u30eb\u9001\u4fe1\u3057\u307e\u3057\u3087\u3046 \u3068\u3044\u3046\u3053\u3068\u3060\u3002\n\u3000\n\u3000\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea\u306b PHPMailer\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u3000composer.json\u306b\u4ee5\u4e0b\u3092\u8a18\u8ff0\u3057\u3001\u30b3\u30de\u30f3\u30c9 composer update \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n\ncomposer.json\n{\n    \"name\": \"MyApp\",\n    \"description\": \"login\",\n    \"require\": {\n        \"php\": \">=5.6.0\",\n        \"phpmailer/phpmailer\": \"~5.2\",\n        \"smarty/smarty\": \"~3.1\"\n    }\n}\n\n\n\u5229\u7528\u3057\u3084\u3059\u304f\u3001\u8a18\u8ff0\u306f\u7c21\u5358\u306b \u304c\u30e2\u30c3\u30c8\u30fc\u306a\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u8a2d\u8a08\u3057\u307e\u3059\u3002\nMail::send($email, $title, $body);\n\nMail.class.php\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u8981\u4ef6\u306b\u306f\u306a\u3044\u304c\u3001\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u5bfe\u5fdc\n\u30e1\u30fc\u30eb\u672c\u6587\u306b\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n\u3000\u30b5\u30fc\u30d3\u30b9\u304c\u904b\u7528\u30d5\u30a7\u30fc\u30ba\u306b\u5165\u308b\u3068\u3001\u610f\u5916\u3068\u9001\u4fe1\u30e1\u30fc\u30eb\u306e\u66f8\u5f0f\u3092\u5909\u66f4\u3059\u308b\u5834\u9762\u304c\u51fa\u3066\u304f\u308b\u3002\u305d\u306e\u5ea6\u306b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092GREP\u3057\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u63a2\u3057\u3001\u30d2\u30a2\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u4fee\u6b63\u3057\u2026\u306a\u3093\u3066\u3053\u3068\u306f\u975e\u5e38\u306b\u9762\u5012\u3002\n\u3000\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30a8\u30f3\u30b8\u30f3\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001HTML\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u3053\u3046\u3044\u3063\u305f\u30e1\u30fc\u30eb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u6a5f\u80fd\u306b\u3082\u5fdc\u7528\u3067\u304d\u307e\u3059\u3002\n\u3000\u30dd\u30a4\u30f3\u30c8\u3068\u3057\u3066\u306f\u3001\u901a\u5e38\u306e display() \u3067\u306f\u306a\u304f\u3001fetch() \u3092\u4f7f\u3044\u307e\u3059\u3002fetch() \u306e\u5834\u5408\u3001\u8fd4\u308a\u5024\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u306f\u8fd4\u3059\u3053\u3068\u306a\u304f\u3001\u30e1\u30e2\u30ea\u4e0a\u306b\u78ba\u4fdd\u3057\u307e\u3059\u3002\n\u3000\n\u3000\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\u3000fetch()\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u5229\u7528\u3057\u305f\u8a18\u8ff0\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n$email = 'recipient@example.com';\n$title = '\u30e1\u30fc\u30eb\u30fb\u30bf\u30a4\u30c8\u30eb';\n$body = Mail::getTemplate('template.tpl', array('name'=>'\u304a\u306a\u307e\u3048'));\nMail::send($email, $title, $body);\n\n\n\u5b9f\u88c5\n\nclasses/common/Mail.class.php\n<?php\n\nnamespace MyApp\\common;\n\n/**\n * Mailer.php\n * @since 2015/07/24\n */\nclass Mail\n{\n\n    /**\n     * \u9001\u4fe1\u5c02\u7528\u30e1\u30fc\u30eb\n     */\n    const SEND_ONLY_EMAIL = \"\u9001\u4fe1\u7528\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\";\n\n    /**\n     * \u9001\u4fe1\u5c02\u7528\u30e1\u30fc\u30eb\u3000\u8868\u793a\u540d\n     */\n    const SEND_ONLY_EMAIL_NAME = 'MyApp';\n\n    /**\n     * \u9001\u4fe1\u5c02\u7528\u30e1\u30fc\u30eb\u3000\u8a00\u8a9e\u540d\n     */\n    const SEND_ONLY_EMAIL_LANGUAGE = \"japanese\";\n\n    /**\n     * \u9001\u4fe1\u5c02\u7528\u30e1\u30fc\u30eb\u3000\u6587\u5b57\u30b3\u30fc\u30c9\n     */\n    const SEND_ONLY_EMAIL_ENCODING = 'utf-8';\n\n    /**\n     * \u30db\u30b9\u30c8\u540d\n     */\n    const MAIL_HOST = 'mail.example.com';\n\n    /**\n     * \u30dd\u30fc\u30c8\n     */\n    const MAIL_PORT = '25';\n\n    /**\n     * \u30e6\u30fc\u30b6\u30fc\u540d\n     */\n    const MAIL_USER = 'contact@example.com';\n\n    /**\n     * \u30d1\u30b9\u30ef\u30fc\u30c9\n     */\n    const MAIL_PASS = 'smtp_password';\n\n    /**\n     * \u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\n     * @param string $strRecipient \u5b9b\u5148\n     * @param string $strSubject \u984c\u540d\n     * @param string $strBody \u672c\u6587\n     * @param array('path'=>'', 'name'=>'') $binAttachment \u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\n     * @throws \\Exception\n     */\n    public static function send($strRecipient, $strSubject, $strBody, array $binAttachment = [])\n    {\n        Log::write('*** send_mail ***');\n\n        if (empty($strRecipient)) {\n            throw new \\Exception('\u5b9b\u5148\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002');\n        }\n        if (empty($strSubject)) {\n            throw new \\Exception('\u30e1\u30fc\u30eb\u30bf\u30a4\u30c8\u30eb\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002');\n        }\n        if (empty($strBody)) {\n            throw new \\Exception('\u30e1\u30fc\u30eb\u672c\u6587\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002');\n        }\n\n        mb_language(self::SEND_ONLY_EMAIL_LANGUAGE);\n        mb_internal_encoding(self::SEND_ONLY_EMAIL_ENCODING);\n\n        $from = self::SEND_ONLY_EMAIL;\n        $fromname = self::SEND_ONLY_EMAIL_NAME;\n\n        $mail = new \\PHPMailer();\n\n        $mail->IsSMTP();\n        $mail->SMTPAuth = TRUE;\n        $mail->Host = self::MAIL_HOST;\n        $mail->Port = self::MAIL_PORT;\n        $mail->Username = self::MAIL_USER;\n        $mail->Password = self::MAIL_PASS;\n\n        $mail->CharSet = \"iso-2022-jp\";\n        $mail->Encoding = \"7bit\";\n\n        $mail->AddAddress($strRecipient);\n        $mail->From = $from;\n        $mail->FromName = mb_encode_mimeheader(\n            mb_convert_encoding(\n                $fromname\n                , \"JIS\"\n                , self::SEND_ONLY_EMAIL_ENCODING\n            )\n        );\n        $mail->Subject = mb_encode_mimeheader($strSubject);\n        $mail->Body = mb_convert_encoding(\n            $strBody\n            , \"JIS\"\n            , self::SEND_ONLY_EMAIL_ENCODING\n        );\n\n        foreach ($binAttachment as $attachment) {\n            if (array_key_exists('path', $attachment) &&\n                array_key_exists('name', $attachment) &&\n                file_exists($attachment['path'])) {\n\n                $mail->AddAttachment(\n                    $attachment['path']\n                    , $attachment['name']\n                );\n            } else if (array_key_exists('path', $attachment) &&\n                file_exists($attachment['path'])) {\n\n                $mail->AddAttachment($attachment['path']);\n            } else if (file_exists($attachment)) {\n\n                $mail->AddAttachment($attachment);\n            }\n        }\n\n        if (!$mail->Send()) {\n            throw new \\Exception($mail->ErrorInfo);\n        }\n    }\n\n    /**\n     * \u30e1\u30fc\u30eb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u5909\u6570\u3092\u5272\u308a\u5f53\u3066\u3066\u672c\u6587\u3092\u53d6\u5f97\n     * @param string $templateName\n     * @param array $args\n     */\n    static public function getTemplate($templateName, array $args = [])\n    {\n        $smarty = new \\Smarty();\n        $smarty->setTemplateDir(BASE_DIR . '/smarty/templates/mail/');\n        foreach ($args as $k => $v) {\n            $smarty->assign($k, $v);\n        }\n        return $smarty->fetch($templateName);\n    }\n\n}\n\n\n\n\n1. [\u57fa\u672c\u8a2d\u8a08\u3001\u30e6\u30fc\u30b6\u30fc\u30e2\u30c7\u30eb](http://qiita.com/ShibuyaKosuke/items/f114ffccf441edb2b745)\n2. [\u30aa\u30fc\u30c8\u30ed\u30fc\u30c0\u30fc](http://qiita.com/ShibuyaKosuke/items/6109810464a7293293bd)\n3. [\u4f8b\u5916\u30fb\u30ed\u30b0](http://qiita.com/ShibuyaKosuke/items/88b1305a4ff0c5f3e728)\n4. [PDO \u30b7\u30f3\u30b0\u30eb\u30c8\u30f3\u3000SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3](http://qiita.com/ShibuyaKosuke/items/094df7f399912ae7df56)\n\t* [\u6c4e\u7528\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30fb\u30af\u30e9\u30b9\u4f5c\u6210](http://qiita.com/ShibuyaKosuke/items/8502492ac024362b528d)\n\n5. [\u30e6\u30fc\u30b6\u30fc\u30e2\u30c7\u30eb\u306e\u4f5c\u6210](http://qiita.com/ShibuyaKosuke/items/81c556d836d70a29c5f3)\n6. [\u30af\u30e9\u30b9\u306e\u7d99\u627f](http://qiita.com/ShibuyaKosuke/items/490ffa6a92670cf6c644)\n7. [\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30fb\u30af\u30e9\u30b9\u306e\u5b9f\u88c5](http://qiita.com/ShibuyaKosuke/items/803dc58a23601118942e)\n8. [\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u6a5f\u80fd\u306e\u5b9f\u88c5](http://qiita.com/ShibuyaKosuke/items/e890becdb8193d3def05)\n9. \u30e1\u30fc\u30eb\u9001\u4fe1\u6a5f\u80fd\u306e\u5b9f\u88c5\n10. [\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u89e3\u9664\u6a5f\u80fd\u306e\u5b9f\u88c5](http://qiita.com/ShibuyaKosuke/items/ee4b1896071eeca37628)\n11. [CSRF\u5bfe\u7b56](http://qiita.com/ShibuyaKosuke/items/8100e304e4447e44e98c)\n\n##\u306f\u3058\u3081\u306b\n\n\u3000\u30e1\u30fc\u30eb\u9001\u4fe1\u306b\u3064\u3044\u3066\u306f\u3001\u591a\u304f\u306e\u5165\u9580\u66f8\u5e2d\u306b\u3042\u308b\u3088\u3046\u306a\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u306f\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u3053\u3068\u304c\u591a\u3044\u3002\u304b\u3064\u3066[\u3053\u306e\u3088\u3046\u306a\u8a18\u4e8b](http://qiita.com/ShibuyaKosuke/items/309c0a7d969baf0ea8d1)\u3082\u66f8\u304b\u305b\u3066\u3082\u3089\u3044\u307e\u3057\u305f\u3002\n\n\u3000\u8981\u70b9\u3068\u3057\u3066\u306f **\u3061\u3083\u3093\u3068SMTP\u30b5\u30fc\u30d0\u30fc\u3092\u901a\u3057\u3066\u30e1\u30fc\u30eb\u9001\u4fe1\u3057\u307e\u3057\u3087\u3046** \u3068\u3044\u3046\u3053\u3068\u3060\u3002\n\u3000\n\u3000\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea\u306b [PHPMailer](https://github.com/PHPMailer/PHPMailer)\u3092\u5229\u7528\u3057\u3066\u3044\u307e\u3059\u3002\n\u3000composer.json\u306b\u4ee5\u4e0b\u3092\u8a18\u8ff0\u3057\u3001\u30b3\u30de\u30f3\u30c9 `composer update` \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3067\u304d\u307e\u3059\u3002\n\n```json:composer.json\n{\n\t\"name\": \"MyApp\",\n\t\"description\": \"login\",\n\t\"require\": {\n\t\t\"php\": \">=5.6.0\",\n\t\t\"phpmailer/phpmailer\": \"~5.2\",\n\t\t\"smarty/smarty\": \"~3.1\"\n\t}\n}\n```\n\n**\u5229\u7528\u3057\u3084\u3059\u304f\u3001\u8a18\u8ff0\u306f\u7c21\u5358\u306b** \u304c\u30e2\u30c3\u30c8\u30fc\u306a\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u8a2d\u8a08\u3057\u307e\u3059\u3002\n\n```php\nMail::send($email, $title, $body);\n```\n\n`Mail.class.php`\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n* \u8981\u4ef6\u306b\u306f\u306a\u3044\u304c\u3001\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u5bfe\u5fdc\n* \u30e1\u30fc\u30eb\u672c\u6587\u306b\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n\u3000\u30b5\u30fc\u30d3\u30b9\u304c\u904b\u7528\u30d5\u30a7\u30fc\u30ba\u306b\u5165\u308b\u3068\u3001\u610f\u5916\u3068\u9001\u4fe1\u30e1\u30fc\u30eb\u306e\u66f8\u5f0f\u3092\u5909\u66f4\u3059\u308b\u5834\u9762\u304c\u51fa\u3066\u304f\u308b\u3002\u305d\u306e\u5ea6\u306b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092GREP\u3057\u3001\u30d5\u30a1\u30a4\u30eb\u3092\u63a2\u3057\u3001\u30d2\u30a2\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u4fee\u6b63\u3057\u2026\u306a\u3093\u3066\u3053\u3068\u306f\u975e\u5e38\u306b\u9762\u5012\u3002\n\n\u3000\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u30a8\u30f3\u30b8\u30f3\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001HTML\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u3053\u3046\u3044\u3063\u305f\u30e1\u30fc\u30eb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u6a5f\u80fd\u306b\u3082\u5fdc\u7528\u3067\u304d\u307e\u3059\u3002\n\u3000\u30dd\u30a4\u30f3\u30c8\u3068\u3057\u3066\u306f\u3001\u901a\u5e38\u306e `display()` \u3067\u306f\u306a\u304f\u3001`fetch()` \u3092\u4f7f\u3044\u307e\u3059\u3002`fetch()` \u306e\u5834\u5408\u3001\u8fd4\u308a\u5024\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u306f\u8fd4\u3059\u3053\u3068\u306a\u304f\u3001\u30e1\u30e2\u30ea\u4e0a\u306b\u78ba\u4fdd\u3057\u307e\u3059\u3002\n\u3000\n\u3000\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\u3000[fetch()](http://www.smarty.net/docs/ja/api.fetch.tpl)\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u5229\u7528\u3057\u305f\u8a18\u8ff0\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```php\n$email = 'recipient@example.com';\n$title = '\u30e1\u30fc\u30eb\u30fb\u30bf\u30a4\u30c8\u30eb';\n$body = Mail::getTemplate('template.tpl', array('name'=>'\u304a\u306a\u307e\u3048'));\nMail::send($email, $title, $body);\n```\n\n##\u5b9f\u88c5\n\n```php:classes/common/Mail.class.php\n<?php\n\nnamespace MyApp\\common;\n\n/**\n * Mailer.php\n * @since 2015/07/24\n */\nclass Mail\n{\n\n\t/**\n\t * \u9001\u4fe1\u5c02\u7528\u30e1\u30fc\u30eb\n\t */\n\tconst SEND_ONLY_EMAIL = \"\u9001\u4fe1\u7528\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\";\n\n\t/**\n\t * \u9001\u4fe1\u5c02\u7528\u30e1\u30fc\u30eb\u3000\u8868\u793a\u540d\n\t */\n\tconst SEND_ONLY_EMAIL_NAME = 'MyApp';\n\n\t/**\n\t * \u9001\u4fe1\u5c02\u7528\u30e1\u30fc\u30eb\u3000\u8a00\u8a9e\u540d\n\t */\n\tconst SEND_ONLY_EMAIL_LANGUAGE = \"japanese\";\n\n\t/**\n\t * \u9001\u4fe1\u5c02\u7528\u30e1\u30fc\u30eb\u3000\u6587\u5b57\u30b3\u30fc\u30c9\n\t */\n\tconst SEND_ONLY_EMAIL_ENCODING = 'utf-8';\n\n\t/**\n\t * \u30db\u30b9\u30c8\u540d\n\t */\n\tconst MAIL_HOST = 'mail.example.com';\n\n\t/**\n\t * \u30dd\u30fc\u30c8\n\t */\n\tconst MAIL_PORT = '25';\n\n\t/**\n\t * \u30e6\u30fc\u30b6\u30fc\u540d\n\t */\n\tconst MAIL_USER = 'contact@example.com';\n\n\t/**\n\t * \u30d1\u30b9\u30ef\u30fc\u30c9\n\t */\n\tconst MAIL_PASS = 'smtp_password';\n\n\t/**\n\t * \u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3059\u308b\n\t * @param string $strRecipient \u5b9b\u5148\n\t * @param string $strSubject \u984c\u540d\n\t * @param string $strBody \u672c\u6587\n\t * @param array('path'=>'', 'name'=>'') $binAttachment \u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\n\t * @throws \\Exception\n\t */\n\tpublic static function send($strRecipient, $strSubject, $strBody, array $binAttachment = [])\n\t{\n\t\tLog::write('*** send_mail ***');\n\n\t\tif (empty($strRecipient)) {\n\t\t\tthrow new \\Exception('\u5b9b\u5148\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002');\n\t\t}\n\t\tif (empty($strSubject)) {\n\t\t\tthrow new \\Exception('\u30e1\u30fc\u30eb\u30bf\u30a4\u30c8\u30eb\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002');\n\t\t}\n\t\tif (empty($strBody)) {\n\t\t\tthrow new \\Exception('\u30e1\u30fc\u30eb\u672c\u6587\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002');\n\t\t}\n\n\t\tmb_language(self::SEND_ONLY_EMAIL_LANGUAGE);\n\t\tmb_internal_encoding(self::SEND_ONLY_EMAIL_ENCODING);\n\n\t\t$from = self::SEND_ONLY_EMAIL;\n\t\t$fromname = self::SEND_ONLY_EMAIL_NAME;\n\n\t\t$mail = new \\PHPMailer();\n\n\t\t$mail->IsSMTP();\n\t\t$mail->SMTPAuth = TRUE;\n\t\t$mail->Host = self::MAIL_HOST;\n\t\t$mail->Port = self::MAIL_PORT;\n\t\t$mail->Username = self::MAIL_USER;\n\t\t$mail->Password = self::MAIL_PASS;\n\n\t\t$mail->CharSet = \"iso-2022-jp\";\n\t\t$mail->Encoding = \"7bit\";\n\n\t\t$mail->AddAddress($strRecipient);\n\t\t$mail->From = $from;\n\t\t$mail->FromName = mb_encode_mimeheader(\n\t\t\tmb_convert_encoding(\n\t\t\t\t$fromname\n\t\t\t\t, \"JIS\"\n\t\t\t\t, self::SEND_ONLY_EMAIL_ENCODING\n\t\t\t)\n\t\t);\n\t\t$mail->Subject = mb_encode_mimeheader($strSubject);\n\t\t$mail->Body = mb_convert_encoding(\n\t\t\t$strBody\n\t\t\t, \"JIS\"\n\t\t\t, self::SEND_ONLY_EMAIL_ENCODING\n\t\t);\n\n\t\tforeach ($binAttachment as $attachment) {\n\t\t\tif (array_key_exists('path', $attachment) &&\n\t\t\t\tarray_key_exists('name', $attachment) &&\n\t\t\t\tfile_exists($attachment['path'])) {\n\n\t\t\t\t$mail->AddAttachment(\n\t\t\t\t\t$attachment['path']\n\t\t\t\t\t, $attachment['name']\n\t\t\t\t);\n\t\t\t} else if (array_key_exists('path', $attachment) &&\n\t\t\t\tfile_exists($attachment['path'])) {\n\n\t\t\t\t$mail->AddAttachment($attachment['path']);\n\t\t\t} else if (file_exists($attachment)) {\n\n\t\t\t\t$mail->AddAttachment($attachment);\n\t\t\t}\n\t\t}\n\n\t\tif (!$mail->Send()) {\n\t\t\tthrow new \\Exception($mail->ErrorInfo);\n\t\t}\n\t}\n\n\t/**\n\t * \u30e1\u30fc\u30eb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306b\u5909\u6570\u3092\u5272\u308a\u5f53\u3066\u3066\u672c\u6587\u3092\u53d6\u5f97\n\t * @param string $templateName\n\t * @param array $args\n\t */\n\tstatic public function getTemplate($templateName, array $args = [])\n\t{\n\t\t$smarty = new \\Smarty();\n\t\t$smarty->setTemplateDir(BASE_DIR . '/smarty/templates/mail/');\n\t\tforeach ($args as $k => $v) {\n\t\t\t$smarty->assign($k, $v);\n\t\t}\n\t\treturn $smarty->fetch($templateName);\n\t}\n\n}\n"}