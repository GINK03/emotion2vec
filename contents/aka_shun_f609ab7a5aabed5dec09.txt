{"context": "\n\nmacvlan\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3063\u3066??\n\u30db\u30b9\u30c8\u3068\u540c\u3058\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u4efb\u610f\u306eIP\u3067\u3064\u306a\u3052\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001\u5f53\u7136\u30db\u30b9\u30c8\u4ee5\u5916\u306e\u540c\u4e00\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u306e\u30de\u30b7\u30f3\u306b\u3001\u30b3\u30f3\u30c6\u30ca\u304b\u3089ping\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3001\u3082\u3061\u308d\u3093\u9006\u3082\u3002\n\u540c\u4e00\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u306e\u30ed\u30dc\u30c3\u30c8\u3082\u30b3\u30f3\u30c6\u30ca\u5185\u304b\u3089\u52d5\u304b\u305b\u307e\u3059\u3002\ndocker\u3092\u4f7f\u3046\u3068\u3001\u74b0\u5883\u3092\u3042\u308b\u7a0b\u5ea6\u7dba\u9e97\u306b\u3067\u304d\u308b\u306e\u3067\u3001\u3088\u304f\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u308bROS\u3092\u4f7f\u3046\u3068\u304d\u306f\u4fbf\u5229\u3067\u3059\u3002   \nmac book pro\u306bVM\u30672\u3064\u74b0\u5883(ubuntu)\u3092\u7528\u610f\u3057\u3066\u3001\n\u4e00\u65b9\u3067docker\u3092\u8d77\u52d5\u3057\u3066\u3001\u3082\u3046\u4e00\u65b9\u304b\u3089ping\u3057\u3066\u30c6\u30b9\u30c8\u3057\u305f\u969b\u306f\u3046\u307e\u304f\u3044\u304d\u307e\u3057\u305f\u304c\u3001\n\u307e\u3063\u305f\u304f\u5225\u306e\u30de\u30b7\u30f3\u304b\u3089\u3060\u3068ping\u304c\u901a\u3089\u306a\u3044\u3067\u3059\n\n\u53c2\u8003\n\n\u3068\u3066\u3082\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002  docker\u3067ROS\u3092\u8a66\u3057\u305f\u3044\n\nmacvlan\u306b\u3064\u3044\u3066\u306e\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 Get started with Macvlan network driver\n\n\n\n\u74b0\u5883\nhost machine OS: Ubuntu:14.04\ndocker: 1.13.1\nnetwork interface: eth1\nnetwork subnet: 192.168.1.0\nhost machine ip: 192.168.1.2    \n\ndocker\u30b3\u30f3\u30c6\u30ca\u9593\u306eROS\u306e\u901a\u4fe1\u306e\u5b9f\u9a13\u65b9\u6cd5\nDockerfile\nFROM ros:indigo-ros-base\n\n# update & git upgrade\nRUN apt-get update\nRUN apt-get install -y apt-file\nRUN apt-file update\nRUN apt-file search add-apt-repository\nRUN apt-get install -y software-properties-common\nRUN add-apt-repository -y ppa:git-core/ppa\nRUN sudo apt-get update\nRUN apt-get upgrade -y\n\n# install vim, g++, python-catkin-tools\nRUN apt-get install -y vim wget g++ zip\nRUN sh -c 'echo \"deb http://packages.ros.org/ros/ubuntu `lsb_release -sc` main\" > /etc/apt/sources.list.d/ros-latest.list' \nRUN wget http://packages.ros.org/ros.key -O - |  apt-key add - \nRUN apt-get update && apt-get install -y python-catkin-tools\n\n# \u30e6\u30fc\u30b6\u30fc\u306e\u8ffd\u52a0\nRUN useradd -ms /bin/bash me\nRUN usermod -G sudo me\nRUN echo 'me:password' | chpasswd\n\n#\u30e6\u30fc\u30b6\u30fc\u5207\u308a\u66ff\u3048\nUSER me\n\n# ROS\u30ef\u30fc\u30af\u30b9\u30da\u30fc\u30b9\nRUN /bin/bash -c \"source /opt/ros/indigo/setup.bash && \\\nmkdir -p ~/catkin_ws/src && \\\ncd ~/catkin_ws/src && \\\ncatkin_init_workspace && \\\ncd ~/catkin_ws && \\\ncatkin_make\"\n\n# ROS\u30d1\u30c3\u30b1\u30fc\u30b8\nRUN /bin/bash -c \"source /opt/ros/indigo/setup.bash && \\\ncd ~/catkin_ws/src && \\\ncatkin_create_pkg ros_start rospy roscpp std_msgs && \\\ncd ~/catkin_ws && \\\ncatkin_make && \\\ncd ~/catkin_ws/src/ros_start && \\\nmkdir script && \\\ncd script && \\\nwget https://raw.github.com/ros/ros_tutorials/indigo-devel/rospy_tutorials/001_talker_listener/talker.py && \\\nwget https://raw.github.com/ros/ros_tutorials/indigo-devel/rospy_tutorials/001_talker_listener/listener.py && \\\nchmod +x *.py && \\\ncd ~/catkin_ws && \\\ncatkin_make\"\n\n# \u74b0\u5883\u8a2d\u5b9a\nRUN echo \"source ~/catkin_ws/devel/setup.bash\" >> ~/.bashrc\n\n#rosdep update\nRUN /bin/bash -c \"source /opt/ros/indigo/setup.bash && rosdep update\"\n\nCMD [\"/bin/bash\"]\n\n\u9577\u304f\u3066\u3054\u3081\u3093\u306a\u3055\u3044\u3002\u3002\u3002\n\n1. \u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\ndocker build -t rdnt .\n\n\n2. \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4f5c\u6210\ndocker network create -d macvlan \\\n    --subnet=192.168.1.0/24 \\\n    --gateway=192.168.1.1  \\\n    -o parent=eth1 pub_net\n\n\n3. \u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\n\u30b3\u30f3\u30c6\u30ca\u304b\u3089\u51fa\u308b\u3068\u304d\u306f\u3001ctrl + p + q\na. roscore\u30b3\u30f3\u30c6\u30ca\ndocker run -ti --net=pub_net --ip=192.168.1.10  \\\n    -h master --name master --env ROS_HOSTNAME=master \\\n    --env ROS_MASTER_URI=http://192.168.1.10:11311 --env ROS_IP=192.168.1.10 \\\n    rdnt\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c\nroscore\nb. publisher(talker)\u30b3\u30f3\u30c6\u30ca\ndocker run -ti --net=pub_net --ip=192.168.1.11 \\\n    -h talker --name talker --add-host=\"master:192.168.1.10\" --env ROS_HOSTNAME=talker \\\n    --env ROS_MASTER_URI=http://192.168.1.10:11311 --env ROS_IP=192.168.1.10 \\\n    rdnt\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c\nrosrun ros_start talker.py\nc. subscriber(listener)\u30b3\u30f3\u30c6\u30ca\ndocker run -ti --net=pub_net --ip=192.168.1.12 \\\n    -h listener --name listener --add-host=\"master:192.168.1.10\" --add-host=\"talker:192.168.1.11\" \\\n    --env ROS_HOSTNAME=listener --env ROS_MASTER_URI=http://192.168.1.10:11311 \\\n    --env ROS_IP=192.168.1.10 \\\n    rdnt\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c\nrosrun ros_start listener.py\n\n\u51fa\u529b\ntalker\u30b3\u30f3\u30c6\u30ca\u3067\u3001hello world...\u304cpublish\u3055\u308c\u3001\nlistener\u30b3\u30f3\u30c6\u30ca\u3067hello world...\u304csubscribe\u3055\u308c\u308b\u3002\n## macvlan\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3063\u3066??\n~~\u30db\u30b9\u30c8\u3068\u540c\u3058\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u4efb\u610f\u306eIP\u3067\u3064\u306a\u3052\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002~~   \n~~\u306a\u306e\u3067\u3001\u5f53\u7136\u30db\u30b9\u30c8\u4ee5\u5916\u306e\u540c\u4e00\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u306e\u30de\u30b7\u30f3\u306b\u3001\u30b3\u30f3\u30c6\u30ca\u304b\u3089ping\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3001\u3082\u3061\u308d\u3093\u9006\u3082\u3002~~   \n~~\u540c\u4e00\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u306e\u30ed\u30dc\u30c3\u30c8\u3082\u30b3\u30f3\u30c6\u30ca\u5185\u304b\u3089\u52d5\u304b\u305b\u307e\u3059\u3002~~   \ndocker\u3092\u4f7f\u3046\u3068\u3001\u74b0\u5883\u3092\u3042\u308b\u7a0b\u5ea6\u7dba\u9e97\u306b\u3067\u304d\u308b\u306e\u3067\u3001\u3088\u304f\u30a8\u30e9\u30fc\u304c\u8d77\u304d\u308bROS\u3092\u4f7f\u3046\u3068\u304d\u306f\u4fbf\u5229\u3067\u3059\u3002   \n\n***mac book pro\u306bVM\u30672\u3064\u74b0\u5883(ubuntu)\u3092\u7528\u610f\u3057\u3066\u3001   \n\u4e00\u65b9\u3067docker\u3092\u8d77\u52d5\u3057\u3066\u3001\u3082\u3046\u4e00\u65b9\u304b\u3089ping\u3057\u3066\u30c6\u30b9\u30c8\u3057\u305f\u969b\u306f\u3046\u307e\u304f\u3044\u304d\u307e\u3057\u305f\u304c\u3001   \n\u307e\u3063\u305f\u304f\u5225\u306e\u30de\u30b7\u30f3\u304b\u3089\u3060\u3068ping\u304c\u901a\u3089\u306a\u3044\u3067\u3059***\n\n\n## \u53c2\u8003\n\n- \u3068\u3066\u3082\u53c2\u8003\u306b\u306a\u308a\u307e\u3057\u305f\u3002  [docker\u3067ROS\u3092\u8a66\u3057\u305f\u3044](http://qiita.com/akachochin/items/129181da9cbf23e8b22f)\n- macvlan\u306b\u3064\u3044\u3066\u306e\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 [Get started with Macvlan network driver](https://docs.docker.com/engine/userguide/networking/get-started-macvlan/)\n\n\n## \u74b0\u5883\nhost machine OS: Ubuntu:14.04   \ndocker: 1.13.1   \nnetwork interface: eth1   \nnetwork subnet: 192.168.1.0   \nhost machine ip: 192.168.1.2    \n\n## docker\u30b3\u30f3\u30c6\u30ca\u9593\u306eROS\u306e\u901a\u4fe1\u306e\u5b9f\u9a13\u65b9\u6cd5\n\nDockerfile\n\n```\nFROM ros:indigo-ros-base\n\n# update & git upgrade\nRUN apt-get update\nRUN apt-get install -y apt-file\nRUN apt-file update\nRUN apt-file search add-apt-repository\nRUN apt-get install -y software-properties-common\nRUN add-apt-repository -y ppa:git-core/ppa\nRUN sudo apt-get update\nRUN apt-get upgrade -y\n\n# install vim, g++, python-catkin-tools\nRUN apt-get install -y vim wget g++ zip\nRUN sh -c 'echo \"deb http://packages.ros.org/ros/ubuntu `lsb_release -sc` main\" > /etc/apt/sources.list.d/ros-latest.list' \nRUN wget http://packages.ros.org/ros.key -O - |  apt-key add - \nRUN apt-get update && apt-get install -y python-catkin-tools\n\n# \u30e6\u30fc\u30b6\u30fc\u306e\u8ffd\u52a0\nRUN useradd -ms /bin/bash me\nRUN usermod -G sudo me\nRUN echo 'me:password' | chpasswd\n\n#\u30e6\u30fc\u30b6\u30fc\u5207\u308a\u66ff\u3048\nUSER me\n\n# ROS\u30ef\u30fc\u30af\u30b9\u30da\u30fc\u30b9\nRUN /bin/bash -c \"source /opt/ros/indigo/setup.bash && \\\nmkdir -p ~/catkin_ws/src && \\\ncd ~/catkin_ws/src && \\\ncatkin_init_workspace && \\\ncd ~/catkin_ws && \\\ncatkin_make\"\n\n# ROS\u30d1\u30c3\u30b1\u30fc\u30b8\nRUN /bin/bash -c \"source /opt/ros/indigo/setup.bash && \\\ncd ~/catkin_ws/src && \\\ncatkin_create_pkg ros_start rospy roscpp std_msgs && \\\ncd ~/catkin_ws && \\\ncatkin_make && \\\ncd ~/catkin_ws/src/ros_start && \\\nmkdir script && \\\ncd script && \\\nwget https://raw.github.com/ros/ros_tutorials/indigo-devel/rospy_tutorials/001_talker_listener/talker.py && \\\nwget https://raw.github.com/ros/ros_tutorials/indigo-devel/rospy_tutorials/001_talker_listener/listener.py && \\\nchmod +x *.py && \\\ncd ~/catkin_ws && \\\ncatkin_make\"\n\n# \u74b0\u5883\u8a2d\u5b9a\nRUN echo \"source ~/catkin_ws/devel/setup.bash\" >> ~/.bashrc\n\n#rosdep update\nRUN /bin/bash -c \"source /opt/ros/indigo/setup.bash && rosdep update\"\n\nCMD [\"/bin/bash\"]\n```\n\n\u9577\u304f\u3066\u3054\u3081\u3093\u306a\u3055\u3044\u3002\u3002\u3002\n\n### 1. \u30a4\u30e1\u30fc\u30b8\u4f5c\u6210\n```\ndocker build -t rdnt .\n```\n\n### 2. \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4f5c\u6210\n```\ndocker network create -d macvlan \\\n    --subnet=192.168.1.0/24 \\\n    --gateway=192.168.1.1  \\\n    -o parent=eth1 pub_net\n```\n\n### 3. \u30b3\u30f3\u30c6\u30ca\u4f5c\u6210\n\n\u30b3\u30f3\u30c6\u30ca\u304b\u3089\u51fa\u308b\u3068\u304d\u306f\u3001***ctrl + p + q***\n\na. ***roscore***\u30b3\u30f3\u30c6\u30ca\n\n```\ndocker run -ti --net=pub_net --ip=192.168.1.10  \\\n    -h master --name master --env ROS_HOSTNAME=master \\\n    --env ROS_MASTER_URI=http://192.168.1.10:11311 --env ROS_IP=192.168.1.10 \\\n    rdnt\n```\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c   \nroscore\n\nb. ***publisher(talker)***\u30b3\u30f3\u30c6\u30ca\n\n```\ndocker run -ti --net=pub_net --ip=192.168.1.11 \\\n    -h talker --name talker --add-host=\"master:192.168.1.10\" --env ROS_HOSTNAME=talker \\\n    --env ROS_MASTER_URI=http://192.168.1.10:11311 --env ROS_IP=192.168.1.10 \\\n    rdnt\n```\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c   \nrosrun ros_start talker.py\n\nc. ***subscriber(listener)***\u30b3\u30f3\u30c6\u30ca\n\n```\ndocker run -ti --net=pub_net --ip=192.168.1.12 \\\n    -h listener --name listener --add-host=\"master:192.168.1.10\" --add-host=\"talker:192.168.1.11\" \\\n    --env ROS_HOSTNAME=listener --env ROS_MASTER_URI=http://192.168.1.10:11311 \\\n    --env ROS_IP=192.168.1.10 \\\n    rdnt\n```\n\n\u30b3\u30f3\u30c6\u30ca\u5185\u3067\u4ee5\u4e0b\u3092\u5b9f\u884c   \nrosrun ros_start listener.py\n\n\n## \u51fa\u529b\ntalker\u30b3\u30f3\u30c6\u30ca\u3067\u3001hello world...\u304cpublish\u3055\u308c\u3001\nlistener\u30b3\u30f3\u30c6\u30ca\u3067hello world...\u304csubscribe\u3055\u308c\u308b\u3002\n", "tags": ["docker", "ROS"]}