{"tags": ["symfony3", "Symfony", "PHP"], "context": "Symfony Advent Calendar 2016 12\u65e5\u76ee\u306e\u8a18\u4e8b\u3002\n\nForm Collection \u3068\u30a4\u30d9\u30f3\u30c8\u5468\u308a\u306b\u3064\u3044\u3066\n\n\nForm\u30a4\u30d9\u30f3\u30c8\u5468\u308a\u306b\u3064\u3044\u3066\nCollection\u306b\u3064\u3044\u3066\u3082\u66f8\u3053\u3046\u3068\u601d\u3063\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u9593\u306b\u5408\u308f\u305a\u65ad\u5ff5m(_ _)m\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001Form\u306e\u30a4\u30d9\u30f3\u30c8\u5468\u308a\u306b\u3064\u3044\u3066\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f\u3002\nSymfony\u306eForm\u306b\u306f\u30a4\u30d9\u30f3\u30c8\u3068\u3044\u3046\u3082\u306e\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\n\u5404\u30a4\u30d9\u30f3\u30c8\u3067\u3001Form\u306e\u30e2\u30c7\u30eb\u3092\u6210\u5f62\u3057\u305f\u308a\u3001Form\u3092\u52d5\u7684\u306b\u8ffd\u52a0\u30fb\u7de8\u96c6\u30fb\u524a\u9664\u3057\u305f\u308a\u3001\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u6210\u5f62\u3057\u305f\u308a\u306a\u3069\u3092\u884c\u306a\u3046\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\u30a4\u30d9\u30f3\u30c8\u4e00\u89a7\n\n\n\nEvent\nForm\u306e\u64cd\u4f5c\nData\n\u5f97\u610f\u306a\u3053\u3068\n\n\n\n\nPRE_SET_DATA\n\u25ef\nModel\n\u30e2\u30c7\u30eb\u306e\u6210\u5f62\n\n\nPOST_SET_DATA\n\u25ef\nModel\nForm\u306e\u6210\u5f62\u3000\n\n\nPRE_SUBMIT\n\u25ef\nRequest Data\n\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u6210\u5f62\u3002Form\u306e\u6210\u5f62\n\n\nSUBMIT\n\u2613\nModel\n\u30c7\u30fc\u30bf\u691c\u8a3c\n\n\nPOST_SUBMIT\n\u2613\nModel\n\u691c\u8a3c\u5f8c\u306e\u64cd\u4f5c\n\n\n\n\u30a4\u30d9\u30f3\u30c8\u306f\u4e0a\u8a18\u306e\u3088\u3046\u306a\uff15\u7a2e\u985e\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u304a\u308a\u3001\u3044\u3044\u611f\u3058\u306b\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u3044\u3044\u611f\u3058\u306b\u306a\u308a\u307e\u3059\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u5b9f\u88c5\u4f8b\u3092\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\u5185\u5bb9\u306f\n\n\n\n\u753b\u50cf\u306e\u3088\u3046\u306a\u30d5\u30a9\u30fc\u30e0\u3092\u7528\u610f\n\n\u6f14\u7b97\u5b50 [+ - * /]\n\u5024\uff11\n\u50242\n\u50243\n\n\u5404\u30a4\u30d9\u30f3\u30c8\u3067\u3084\u308b\u3053\u3068\n\nPRE_SET_DATA\n\n\n\u5024123\u306e\u521d\u671f\u5024\u3092\u8a2d\u5b9a\n\n\nPOST_SET_DATA \n\n\n\u9001\u4fe1\u30dc\u30bf\u30f3\u3092\u8ffd\u52a0\n\n\nPRE_SUBMIT\n\n\n\u5165\u529b\u3055\u308c\u305f\u5024\uff13\u3092\u534a\u5206\u306e\u6570\u5024\u306b\u3059\u308b\n\n\nSUBMIT\n\n\n\u5024123\u304c\u6570\u5024\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\u5024123\u3067\u8a08\u7b97\u3057\u3001\u30a8\u30e9\u30fc\u304c\u51fa\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\n\n\nPOST_SUBMIT\n\n\nForm\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u304c\u7121\u3051\u308c\u3070\u3001\u8a08\u7b97\u7d50\u679c\u3092\u51fa\u529b\nForm\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u3067\u3042\u308c\u3070Failed\u3092\u51fa\u529b\n\n\n\n\nclass SampleType extends AbstractType\n{\n    // \u6f14\u7b97\u306e\u4e00\u89a7\n    const OPERATION_PLUS = 1;\n    const OPERATION_MINUS = 2;\n    const OPERATION_MULTIPLIED = 3;\n    const OPERATION_DIVIDED = 4;\n\n    const operations = [\n        self::OPERATION_PLUS => '+',\n        self::OPERATION_MINUS => '-',\n        self::OPERATION_MULTIPLIED => '*',\n        self::OPERATION_DIVIDED => '/',\n    ];\n\n    /**\n     * {@inheritdoc}\n     */\n    public function buildForm(FormBuilderInterface $builder, array $options)\n    {\n        $builder\n            ->add('operation', ChoiceType::class, [\n                'label' => '\u6f14\u7b97\u5b50',\n                'choices' => self::operations\n            ])\n            ->add('num1', TextType::class, [\n                'label' => '\u50241'\n            ])\n            ->add('num2', TextType::class, [\n                'label' => '\u50242'\n            ])\n            ->add('num3', TextType::class, [\n                'label' => '\u50243 (\u5f37\u5236\u7684\u306b\u534a\u5206)'\n            ])\n            ;\n\n        // \u30e2\u30c7\u30eb\u304c\u89e6\u308c\u308b\n        $builder->addEventListener(FormEvents::PRE_SET_DATA, function (FormEvent $event) {\n            // \u521d\u671f\u5024\u3092\u4f5c\u6210\n            $data = $event->getData();\n            $data['num1'] = 10;\n            $data['num2'] = 20;\n            $data['num3'] = 30;\n            $data['operation'] = self::operations[1];\n            $event->setData($data);\n        });\n\n        // \u30e2\u30c7\u30eb\u3068\u30d5\u30a9\u30fc\u30e0\u304c\u89e6\u308c\u308b \u30d5\u30a9\u30fc\u30e0\u3092\u8ffd\u52a0\u3001\u7de8\u96c6\u3092\u884c\u3046\u5834\u5408\u306f\u3053\u3053\n        $builder->addEventListener(FormEvents::POST_SET_DATA, function (FormEvent $event) {\n            // \u30b5\u30d6\u30df\u30c3\u30c8\u30dc\u30bf\u30f3\u3092\u8ffd\u52a0\n            $form = $event->getForm();\n            $form->add('submit', SubmitType::class);\n        });\n        // \u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3068\u30d5\u30a9\u30fc\u30e0\u304c\u3055\u308f\u308c\u308b\u3002 \u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u6210\u5f62\u3084\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u306b\u3088\u3063\u3066\u30d5\u30a9\u30fc\u30e0\u3092\u5909\u66f4\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n        $builder->addEventListener(FormEvents::PRE_SUBMIT, function (FormEvent $event) {\n            // num3\u3068\u3044\u3046\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u534a\u5206\u306b\u3059\u308b\n            $data = $event->getData();\n            $num3 = $data['num3'];\n            if (is_numeric($num3) and $num3 > 0) {\n                $data['num3'] = $num3 / 2;\n            }\n            $event->setData($data);\n        });\n\n        // \u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u304cmapped\u3055\u308c\u305f\u30e2\u30c7\u30eb\u304c\u3055\u308f\u308c\u308b\u3002\u72ec\u81ea\u306eValidation\u7b49\u3067\u4f7f\u3046\n        $builder->addEventListener(FormEvents::SUBMIT, function (FormEvent $event) {\n            // \u691c\u8a3c\n            $form = $event->getForm();\n\n            // \u5165\u529b\u3055\u308c\u305f\u5024\u304c\u6570\u5b57\u304b\u3069\u3046\u304b\n            if (!is_numeric($form->get('num1')->getData())) {\n                $form->get('num1')->addError(new FormError('num1 not numeric!'));\n            }\n            if (!is_numeric($form->get('num2')->getData())) {\n                $form->get('num2')->addError(new FormError('num2 not numeric!'));\n            }\n            if (!is_numeric($form->get('num3')->getData())) {\n                $form->get('num3')->addError(new FormError('num3 not numeric!'));\n            }\n\n            //\u3000\u8a08\u7b97\u306b\u5931\u6557\u3059\u308b\u304b\u3069\u3046\u304b\n            try {\n                $this->calc($event->getData());\n            } catch (ContextErrorException $e) {\n                $form->addError(new FormError($e->getMessage()));\n            }\n\n        });\n\n        //\u3000\u30e2\u30c7\u30eb\u304c\u89e6\u308c\u308b\u3002Validation\u3092\u901a\u3063\u305f\u5f8c\u306b\u30e2\u30c7\u30eb\u3092\u6210\u5f62\u306a\u3069\u306b\u4f7f\u3048\u308b\n        $builder->addEventListener(FormEvents::POST_SUBMIT, function (FormEvent $event) {\n            // \u6210\u529f\u53ef\u5426\u3092\u78ba\u8a8d\u3057\u3001\u6210\u529f\u3067\u3042\u308c\u3070\u96c6\u8a08\u5024\u3092\u3002 \u5931\u6557\u3067\u3042\u308c\u3070Failed\u3092\u51fa\u529b\n            $form = $event->getForm();\n            $data = $event->getData();\n\n            if ($form->isValid()) {\n                print('SUCCESS Total: ' . $this->calc($data));\n            } else {\n                print('Failed');\n            }\n        });\n    }\n\n    /**\n     * \u30c7\u30fc\u30bf\u3092\u5143\u306b\u8a08\u7b97\n     */\n    private function calc($data)\n    {\n        $sum = false;\n        switch ($data['operation']) {\n            case self::OPERATION_PLUS:\n                $sum = $data['num1'] + $data['num2'] + $data['num3'];\n                break;\n            case self::OPERATION_MINUS:\n                $sum = $data['num1'] - $data['num2'] - $data['num3'];\n                break;\n            case self::OPERATION_MULTIPLIED:\n                $sum = $data['num1'] * $data['num2'] * $data['num3'];\n                break;\n            case self::OPERATION_DIVIDED:\n                $sum = $data['num1'] / $data['num2'] / $data['num3'];\n                break;\n        }\n\n        return $sum;\n    }\n}\n\n\n\u6210\u529f\n\n\n\n\n\u5931\u6557\n\n\n\n\u3042\u307e\u308a\u3044\u3044\u4f8b\u304c\u601d\u3044\u3064\u304b\u305a\u3001\u3068\u3066\u3082\u7121\u7406\u77e2\u7406\u306a\u30a4\u30d9\u30f3\u30c8\u306e\u4f7f\u3044\u65b9\u3092\u3057\u3066\u3044\u308b\u306e\u306f\u53cd\u7701\u3002\n\n\u307e\u3068\u3081\n\u4eca\u56de\u306e\u30b3\u30fc\u30c9\u304b\u3089\u306f\u8aad\u307f\u53d6\u308a\u306b\u304f\u3044\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001\u5404\u30a4\u30d9\u30f3\u30c8\u3092\u4e0a\u624b\u304f\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u9762\u5012\u306a\u4f5c\u696d\u3092Symfony\u306b\u4efb\u305b\u308b\u3088\u3046\u306a\u3053\u3068\u304c\u3067\u304d\u3001\u3059\u3054\u304f\u697d\u304c\u3067\u304d\u307e\u3059\u3002\n\u3082\u3046\u3059\u3053\u3057\u8907\u96d1\u306a\u30d1\u30bf\u30fc\u30f3\u3067\u3044\u304f\u3068\u3001\nPRE_SUBMIT\u6642\u306b\u7279\u5b9a\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u304c\u6765\u305f\u5834\u5408Form\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092disabled\u306b\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u5024\u306e\u66f4\u65b0\u3092\u4e0d\u53ef\u306b\u3057\u305f\u308a\u306a\u3069\u2026\n\u3051\u3063\u3053\u3046\u3050\u3060\u3050\u3060\u306a\u611f\u3058\u3067\u3057\u305f\u304c\u3053\u308c\u3067\u7d42\u308f\u308a\u306b\u3057\u307e\u3059\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\n[Symfony Advent Calendar 2016 12\u65e5\u76ee\u306e\u8a18\u4e8b\u3002](http://qiita.com/advent-calendar/2016/symfony)\n\n### ~~Form Collection \u3068\u30a4\u30d9\u30f3\u30c8\u5468\u308a\u306b\u3064\u3044\u3066~~\n### Form\u30a4\u30d9\u30f3\u30c8\u5468\u308a\u306b\u3064\u3044\u3066\nCollection\u306b\u3064\u3044\u3066\u3082\u66f8\u3053\u3046\u3068\u601d\u3063\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u9593\u306b\u5408\u308f\u305a\u65ad\u5ff5m(_ _)m\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3001Form\u306e\u30a4\u30d9\u30f3\u30c8\u5468\u308a\u306b\u3064\u3044\u3066\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f\u3002\n\nSymfony\u306eForm\u306b\u306f\u30a4\u30d9\u30f3\u30c8\u3068\u3044\u3046\u3082\u306e\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\n\u5404\u30a4\u30d9\u30f3\u30c8\u3067\u3001Form\u306e\u30e2\u30c7\u30eb\u3092\u6210\u5f62\u3057\u305f\u308a\u3001Form\u3092\u52d5\u7684\u306b\u8ffd\u52a0\u30fb\u7de8\u96c6\u30fb\u524a\u9664\u3057\u305f\u308a\u3001\u30e6\u30fc\u30b6\u30fc\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u6210\u5f62\u3057\u305f\u308a\u306a\u3069\u3092\u884c\u306a\u3046\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n\u30a4\u30d9\u30f3\u30c8\u4e00\u89a7\n\n| Event         | Form\u306e\u64cd\u4f5c |     Data     | \u5f97\u610f\u306a\u3053\u3068 |\n|:------------- |:---------:|:------------:|:---------\n| PRE_SET_DATA  |      \u25ef    |     Model    |\u30e2\u30c7\u30eb\u306e\u6210\u5f62 |\n| POST_SET_DATA |      \u25ef    |     Model    |Form\u306e\u6210\u5f62\u3000 |\n| PRE_SUBMIT    |      \u25ef    | Request Data |\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u6210\u5f62\u3002Form\u306e\u6210\u5f62 |\n| SUBMIT        |      \u2613    |     Model    |\u30c7\u30fc\u30bf\u691c\u8a3c |\n| POST_SUBMIT   |      \u2613    |     Model    |\u691c\u8a3c\u5f8c\u306e\u64cd\u4f5c |\n\n\n\u30a4\u30d9\u30f3\u30c8\u306f\u4e0a\u8a18\u306e\u3088\u3046\u306a\uff15\u7a2e\u985e\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u304a\u308a\u3001\u3044\u3044\u611f\u3058\u306b\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u3044\u3044\u611f\u3058\u306b\u306a\u308a\u307e\u3059\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001\u5b9f\u88c5\u4f8b\u3092\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\u5185\u5bb9\u306f\n\n> <img width=\"203\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-11 21.55.58.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/131778/0074b3cd-f724-6d68-b727-834302f8013e.png\">\n\n\u753b\u50cf\u306e\u3088\u3046\u306a\u30d5\u30a9\u30fc\u30e0\u3092\u7528\u610f\n\n- \u6f14\u7b97\u5b50 [+ - * /]\n- \u5024\uff11\n- \u50242\n- \u50243\n\n\u5404\u30a4\u30d9\u30f3\u30c8\u3067\u3084\u308b\u3053\u3068\n\n- PRE_SET_DATA\n - \u5024123\u306e\u521d\u671f\u5024\u3092\u8a2d\u5b9a\n- POST_SET_DATA \n - \u9001\u4fe1\u30dc\u30bf\u30f3\u3092\u8ffd\u52a0\n- PRE_SUBMIT\n - \u5165\u529b\u3055\u308c\u305f\u5024\uff13\u3092\u534a\u5206\u306e\u6570\u5024\u306b\u3059\u308b\n- SUBMIT\n - \u5024123\u304c\u6570\u5024\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\n - \u5024123\u3067\u8a08\u7b97\u3057\u3001\u30a8\u30e9\u30fc\u304c\u51fa\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\n- POST_SUBMIT\n - Form\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u304c\u7121\u3051\u308c\u3070\u3001\u8a08\u7b97\u7d50\u679c\u3092\u51fa\u529b\n - Form\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u3067\u3042\u308c\u3070Failed\u3092\u51fa\u529b\n\n```php\n\nclass SampleType extends AbstractType\n{\n    // \u6f14\u7b97\u306e\u4e00\u89a7\n    const OPERATION_PLUS = 1;\n    const OPERATION_MINUS = 2;\n    const OPERATION_MULTIPLIED = 3;\n    const OPERATION_DIVIDED = 4;\n\n    const operations = [\n        self::OPERATION_PLUS => '+',\n        self::OPERATION_MINUS => '-',\n        self::OPERATION_MULTIPLIED => '*',\n        self::OPERATION_DIVIDED => '/',\n    ];\n\n    /**\n     * {@inheritdoc}\n     */\n    public function buildForm(FormBuilderInterface $builder, array $options)\n    {\n        $builder\n            ->add('operation', ChoiceType::class, [\n                'label' => '\u6f14\u7b97\u5b50',\n                'choices' => self::operations\n            ])\n            ->add('num1', TextType::class, [\n                'label' => '\u50241'\n            ])\n            ->add('num2', TextType::class, [\n                'label' => '\u50242'\n            ])\n            ->add('num3', TextType::class, [\n                'label' => '\u50243 (\u5f37\u5236\u7684\u306b\u534a\u5206)'\n            ])\n            ;\n\n        // \u30e2\u30c7\u30eb\u304c\u89e6\u308c\u308b\n        $builder->addEventListener(FormEvents::PRE_SET_DATA, function (FormEvent $event) {\n            // \u521d\u671f\u5024\u3092\u4f5c\u6210\n            $data = $event->getData();\n            $data['num1'] = 10;\n            $data['num2'] = 20;\n            $data['num3'] = 30;\n            $data['operation'] = self::operations[1];\n            $event->setData($data);\n        });\n\n        // \u30e2\u30c7\u30eb\u3068\u30d5\u30a9\u30fc\u30e0\u304c\u89e6\u308c\u308b \u30d5\u30a9\u30fc\u30e0\u3092\u8ffd\u52a0\u3001\u7de8\u96c6\u3092\u884c\u3046\u5834\u5408\u306f\u3053\u3053\n        $builder->addEventListener(FormEvents::POST_SET_DATA, function (FormEvent $event) {\n            // \u30b5\u30d6\u30df\u30c3\u30c8\u30dc\u30bf\u30f3\u3092\u8ffd\u52a0\n            $form = $event->getForm();\n            $form->add('submit', SubmitType::class);\n        });\n        // \u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3068\u30d5\u30a9\u30fc\u30e0\u304c\u3055\u308f\u308c\u308b\u3002 \u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u6210\u5f62\u3084\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u306b\u3088\u3063\u3066\u30d5\u30a9\u30fc\u30e0\u3092\u5909\u66f4\u3055\u305b\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n        $builder->addEventListener(FormEvents::PRE_SUBMIT, function (FormEvent $event) {\n            // num3\u3068\u3044\u3046\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u534a\u5206\u306b\u3059\u308b\n            $data = $event->getData();\n            $num3 = $data['num3'];\n            if (is_numeric($num3) and $num3 > 0) {\n                $data['num3'] = $num3 / 2;\n            }\n            $event->setData($data);\n        });\n\n        // \u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u304cmapped\u3055\u308c\u305f\u30e2\u30c7\u30eb\u304c\u3055\u308f\u308c\u308b\u3002\u72ec\u81ea\u306eValidation\u7b49\u3067\u4f7f\u3046\n        $builder->addEventListener(FormEvents::SUBMIT, function (FormEvent $event) {\n            // \u691c\u8a3c\n            $form = $event->getForm();\n\n            // \u5165\u529b\u3055\u308c\u305f\u5024\u304c\u6570\u5b57\u304b\u3069\u3046\u304b\n            if (!is_numeric($form->get('num1')->getData())) {\n                $form->get('num1')->addError(new FormError('num1 not numeric!'));\n            }\n            if (!is_numeric($form->get('num2')->getData())) {\n                $form->get('num2')->addError(new FormError('num2 not numeric!'));\n            }\n            if (!is_numeric($form->get('num3')->getData())) {\n                $form->get('num3')->addError(new FormError('num3 not numeric!'));\n            }\n\n            //\u3000\u8a08\u7b97\u306b\u5931\u6557\u3059\u308b\u304b\u3069\u3046\u304b\n            try {\n                $this->calc($event->getData());\n            } catch (ContextErrorException $e) {\n                $form->addError(new FormError($e->getMessage()));\n            }\n\n        });\n\n        //\u3000\u30e2\u30c7\u30eb\u304c\u89e6\u308c\u308b\u3002Validation\u3092\u901a\u3063\u305f\u5f8c\u306b\u30e2\u30c7\u30eb\u3092\u6210\u5f62\u306a\u3069\u306b\u4f7f\u3048\u308b\n        $builder->addEventListener(FormEvents::POST_SUBMIT, function (FormEvent $event) {\n            // \u6210\u529f\u53ef\u5426\u3092\u78ba\u8a8d\u3057\u3001\u6210\u529f\u3067\u3042\u308c\u3070\u96c6\u8a08\u5024\u3092\u3002 \u5931\u6557\u3067\u3042\u308c\u3070Failed\u3092\u51fa\u529b\n            $form = $event->getForm();\n            $data = $event->getData();\n\n            if ($form->isValid()) {\n                print('SUCCESS Total: ' . $this->calc($data));\n            } else {\n                print('Failed');\n            }\n        });\n    }\n\n    /**\n     * \u30c7\u30fc\u30bf\u3092\u5143\u306b\u8a08\u7b97\n     */\n    private function calc($data)\n    {\n        $sum = false;\n        switch ($data['operation']) {\n            case self::OPERATION_PLUS:\n                $sum = $data['num1'] + $data['num2'] + $data['num3'];\n                break;\n            case self::OPERATION_MINUS:\n                $sum = $data['num1'] - $data['num2'] - $data['num3'];\n                break;\n            case self::OPERATION_MULTIPLIED:\n                $sum = $data['num1'] * $data['num2'] * $data['num3'];\n                break;\n            case self::OPERATION_DIVIDED:\n                $sum = $data['num1'] / $data['num2'] / $data['num3'];\n                break;\n        }\n\n        return $sum;\n    }\n}\n```\n\n#### \u6210\u529f\n> <img width=\"222\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-11 21.56.29.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/131778/d8982633-3767-89f4-7691-3f0259b3a3a5.png\">\n\n#### \u5931\u6557\n> <img width=\"503\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-12-11 21.56.40.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/131778/62a86e72-3ddb-d705-99ee-163f575672b8.png\">\n\n\u3042\u307e\u308a\u3044\u3044\u4f8b\u304c\u601d\u3044\u3064\u304b\u305a\u3001\u3068\u3066\u3082\u7121\u7406\u77e2\u7406\u306a\u30a4\u30d9\u30f3\u30c8\u306e\u4f7f\u3044\u65b9\u3092\u3057\u3066\u3044\u308b\u306e\u306f\u53cd\u7701\u3002\n\n### \u307e\u3068\u3081\n\u4eca\u56de\u306e\u30b3\u30fc\u30c9\u304b\u3089\u306f\u8aad\u307f\u53d6\u308a\u306b\u304f\u3044\u3068\u306f\u601d\u3044\u307e\u3059\u304c\u3001\u5404\u30a4\u30d9\u30f3\u30c8\u3092\u4e0a\u624b\u304f\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u3001\u9762\u5012\u306a\u4f5c\u696d\u3092Symfony\u306b\u4efb\u305b\u308b\u3088\u3046\u306a\u3053\u3068\u304c\u3067\u304d\u3001\u3059\u3054\u304f\u697d\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3082\u3046\u3059\u3053\u3057\u8907\u96d1\u306a\u30d1\u30bf\u30fc\u30f3\u3067\u3044\u304f\u3068\u3001\nPRE_SUBMIT\u6642\u306b\u7279\u5b9a\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u30c7\u30fc\u30bf\u304c\u6765\u305f\u5834\u5408Form\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092disabled\u306b\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u5024\u306e\u66f4\u65b0\u3092\u4e0d\u53ef\u306b\u3057\u305f\u308a\u306a\u3069\u2026\n\n\u3051\u3063\u3053\u3046\u3050\u3060\u3050\u3060\u306a\u611f\u3058\u3067\u3057\u305f\u304c\u3053\u308c\u3067\u7d42\u308f\u308a\u306b\u3057\u307e\u3059\u3002\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3057\u305f\n"}