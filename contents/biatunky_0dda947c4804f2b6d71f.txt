{"tags": ["geoip", "iptables"], "context": " More than 1 year has passed since last update.iptables\u3092\u4f7f\u3063\u3066\u56fd\u3054\u3068\u306b\u30a2\u30af\u30bb\u30b9\u5236\u9650\u3092\u3059\u308b\u969b\u306bGeoIP\u3092\u7528\u3044\u308b\u3068\u7c21\u5358\u306b\u8a2d\u5b9a\u304c\u3067\u304d\u307e\u3059\u3002\n\u74b0\u5883\u306fCentOS6\u3067\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u6e96\u5099\nyum install gcc gcc-c++ make automake unzip zip xz kernel-devel-`uname -r` iptables-devel\nrpm -ivh ftp://ftp.pbone.net/mirror/ftp.scientificlinux.org/linux/scientific/6.1/x86_64/updates/security/kernel-devel-2.6.32-279.14.1.el6.x86_64.rpm\nrpm -i http://packages.sw.be/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.i686.rpm\n\n\nperl-Text-CSV_XS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nvi /etc/yum.repos.d/rpmforge.repo \n-------------\nenabled = 0\n-------------\n\nyum install --enablerepo=rpmforge perl-Text-CSV_XS\n\n\n\nxtables-addons\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nxtables-addons\u306f\u3001iptables\u3092\u6271\u3046\u969b\u306e\u30ab\u30fc\u30cd\u30eb\u306e\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\nwget http://downloads.sourceforge.net/project/xtables-addons/Xtables-addons/1.37/xtables-addons-1.37.tar.xz\n\ntar xvf xtables-addons-1.37.tar.xz\ncd xtables-addons-1.37/\n\nCentOS6\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u306a\u3088\u3046\u3067\u3059\u3002\uff08\u305d\u306e\u5834\u5408\u306eip6tables\u3067\u306e\u52d5\u4f5c\u306f\u672a\u691c\u8a3c\uff09\nvi /lib/modules/2.6.32-279.14.1.el6.x86_64/build/include/linux/autoconf.h\n------------\n/* #define CONFIG_IP6_NF_IPTABLES_MODULE 1 */\n------------\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n./configure\n\nmake && make install\n\n\nGeoIP\u30c7\u30fc\u30bf\u306e\u53d6\u5f97&\u5c55\u958b\n\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u914d\u7f6e\u3092\u3057\u307e\u3059\u3002\n\u5e38\u306b\u6700\u65b0\u306e\u60c5\u5831\u306b\u66f4\u65b0\u3059\u308b\u305f\u3081\u306b\u306fcron\u306a\u3069\u3067\u4ee5\u4e0b\u306e\u51e6\u7406\u3092\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\ncd geoip/\n./xt_geoip_dl\n./xt_geoip_build GeoIPCountryWhois.csv\nmkdir -p /usr/share/xt_geoip/\ncp -r {BE,LE} /usr/share/xt_geoip/\n\n\n\u4f7f\u3044\u65b9\niptables -I INPUT -m geoip --src-cc CN -j DROP\n\n\u306e\u3088\u3046\u306b-src-cc\u3067\u56fd\u30b3\u30fc\u30c9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u53c2\u8003\nhttp://www.howtoforge.com/xtables-addons-on-centos-6-and-iptables-geoip-filtering\niptables\u3092\u4f7f\u3063\u3066\u56fd\u3054\u3068\u306b\u30a2\u30af\u30bb\u30b9\u5236\u9650\u3092\u3059\u308b\u969b\u306bGeoIP\u3092\u7528\u3044\u308b\u3068\u7c21\u5358\u306b\u8a2d\u5b9a\u304c\u3067\u304d\u307e\u3059\u3002\n\u74b0\u5883\u306fCentOS6\u3067\u3059\u3002\n\n#\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306e\u6e96\u5099\n\n```\nyum install gcc gcc-c++ make automake unzip zip xz kernel-devel-`uname -r` iptables-devel\nrpm -ivh ftp://ftp.pbone.net/mirror/ftp.scientificlinux.org/linux/scientific/6.1/x86_64/updates/security/kernel-devel-2.6.32-279.14.1.el6.x86_64.rpm\nrpm -i http://packages.sw.be/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.i686.rpm\n```\n\n#perl-Text-CSV_XS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\nvi /etc/yum.repos.d/rpmforge.repo \n-------------\nenabled = 0\n-------------\n\nyum install --enablerepo=rpmforge perl-Text-CSV_XS\n\n```\n\n#xtables-addons\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nxtables-addons\u306f\u3001iptables\u3092\u6271\u3046\u969b\u306e\u30ab\u30fc\u30cd\u30eb\u306e\u62e1\u5f35\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002\n\n```\nwget http://downloads.sourceforge.net/project/xtables-addons/Xtables-addons/1.37/xtables-addons-1.37.tar.xz\n\ntar xvf xtables-addons-1.37.tar.xz\ncd xtables-addons-1.37/\n```\n\nCentOS6\u306e\u5834\u5408\u306f\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u306a\u3088\u3046\u3067\u3059\u3002\uff08\u305d\u306e\u5834\u5408\u306eip6tables\u3067\u306e\u52d5\u4f5c\u306f\u672a\u691c\u8a3c\uff09\n\n```\nvi /lib/modules/2.6.32-279.14.1.el6.x86_64/build/include/linux/autoconf.h\n------------\n/* #define CONFIG_IP6_NF_IPTABLES_MODULE 1 */\n------------\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n./configure\n\nmake && make install\n```\n\n#GeoIP\u30c7\u30fc\u30bf\u306e\u53d6\u5f97&\u5c55\u958b\n\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3068\u914d\u7f6e\u3092\u3057\u307e\u3059\u3002\n\u5e38\u306b\u6700\u65b0\u306e\u60c5\u5831\u306b\u66f4\u65b0\u3059\u308b\u305f\u3081\u306b\u306fcron\u306a\u3069\u3067\u4ee5\u4e0b\u306e\u51e6\u7406\u3092\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n```\ncd geoip/\n./xt_geoip_dl\n./xt_geoip_build GeoIPCountryWhois.csv\nmkdir -p /usr/share/xt_geoip/\ncp -r {BE,LE} /usr/share/xt_geoip/\n```\n\n#\u4f7f\u3044\u65b9\n\n```\niptables -I INPUT -m geoip --src-cc CN -j DROP\n```\n\n\u306e\u3088\u3046\u306b-src-cc\u3067\u56fd\u30b3\u30fc\u30c9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n#\u53c2\u8003\nhttp://www.howtoforge.com/xtables-addons-on-centos-6-and-iptables-geoip-filtering\n"}