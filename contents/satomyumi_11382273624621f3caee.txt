{"context": " More than 1 year has passed since last update.Git\u4ee5\u5916\u306e\u65b9\u6cd5\u3067\u3082\u3055\u304f\u3089VPS\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u4e0a\u3052\u308b\u70ba\u306b\u3001FTP\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308a\u3001\u305d\u306e\u65b9\u6cd5\u3092\u30e1\u30e2\u308a\u307e\u3059\u3002\n\nvsftpd\u3092\u4f7f\u3044\u307e\u3059\u3002\n\nvsftpd\u3092\u5165\u308c\u307e\u3059\u3002\n$ yum install vsftpd\n\n//vsftpd\u3092 \u8d77\u52d5\n$ sudo /etc/rc.d/init.d/vsftpd start\n\n//\u81ea\u52d5\u8d77\u52d5\u3092\u6709\u52b9\u5316\n$ sudo chkconfig vsftpd on\n\n\nvsftpd\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n// \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u53d6\u308a\u307e\u3059\u3002\n$ cd \n$ mkdir origin\n$ sudo cp /etc/vsftpd/vsftpd.conf origin\n\n// \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\u3002\n$ sudo vim /etc/vsftpd/vsftpd.conf \n---- \n#\u30a2\u30b9\u30ad\u30fc\u30e2\u30fc\u30c9\u3092\u6709\u52b9\u306b\u3059\u308b\nascii_upload_enable=YES\nascii_download_enable=YES   \n\n# TCP/IP \u3067\u306e\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\u3000\uff08iptables \u3067\u4e00\u5fdcOK\uff09\ntcp_wrappers=NO \n\n# \u65e5\u672c\u6642\u9593\u3092\u4f7f\u7528\nuse_localtime=YES \n\n# anonymous \u3092\u7121\u52b9\u306b\u3059\u308b\nanonymous_enable=NO\n\n# /var/log/vsftpd.log\u3000\u306b\u30ed\u30b0\u3092\u8a18\u5165\nxferlog_std_format=NO\n\n# \u30ed\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b\ndual_log_enable=YES\n---\n\n\nchroot \u3068 FTP\u5229\u7528\u30e6\u30fc\u30b6\u30fc\u5236\u9650\n\n\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\n# useradd hoge\n# passwd hoge\n\n\nvsftpd.conf\u306e\u8a2d\u5b9a\n$ sudo vim /etc/vsftpd/vsftpd.conf\n---\n# /etc/vsftpd/user_list\u3000\u306b\u8a18\u8ff0\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u3092\u62d2\u5426\u3059\u308b\nuserlist_deny=NO\n\n# \u5168\u3066\u306e\u30ed\u30fc\u30ab\u30eb\u30e6\u30fc\u30b6\u30fc\u306bchroot\u3092\u6709\u52b9\u306b\u3059\u308b\u3002\nchroot_local_user=YES\nchroot_list_enable=NO\n\n# vsftpd\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092 /home/hoge/public_html \u306b\u8a2d\u5b9a\nlocal_root=/home/hoge/public_html\n---\n\n\u2191\u3067\u6307\u5b9a\u3057\u305f\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002\n\n\u203bchroot\u306b\u3064\u3044\u3066\u306f\u30b3\u30c1\u30e9\n\n\n\u30a2\u30af\u30bb\u30b9\u8a31\u53ef\u30e6\u30fc\u30b6\u30fc\u6307\u5b9a\n$ sudo vim /etc/vsftpd/user_list\n---\n# vsftpd userlist\n# If userlist_deny=NO, only allow users in this file\n# If userlist_deny=YES (default), never allow users in this file, and\n# do not even prompt for a password.\n# Note that the default vsftpd pam config also checks /etc/vsftpd/ftpusers\n# for users that are denied.\nhoge\n---\n\n\niptables \u8a2d\u5b9a\n$ sudo vim /etc/sysconfig/iptables\n---\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\u3000\uff08\u8ffd\u8a18\uff09\n---\n\n$ sudo /etc/rc.d/init.d/iptables restart\n\n\u3082\u3057\u304f\u306f\u4ee5\u4e0b\u3002\n$ sudo iptables -A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\n$ sudo /etc/rc.d/init.d/iptables save\n\n\nvsftpd\u306e\u53cd\u6620\n// vsftpd \u306e\u8a2d\u5b9a\u3092\u53cd\u6620\n$ sudo /etc/rc.d/init.d/vsftpd restart\n\n\nIPTABLES_MODULES\u306e\u30ed\u30fc\u30c9\n\niptables-config\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n$ sudo vim /etc/sysconfig/iptables-config\n---\n# \u4ee5\u4e0b\u3092\u8ffd\u8a18\nIPTABLES_MODULES=\"ip_conntrack_ftp ip_nat_ftp\"\n---\n\n\niptables-config\u3092restart\u3057\u307e\u3059\u3002\n$ sudo /etc/rc.d/init.d/iptables restart\n\n\n\u30ed\u30fc\u30c9\u78ba\u8a8d\n$ lsmod\n---\n// \u3053\u3053\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u3042\u308c\u3070OK\n---\n\n\nftp\u51fa\u6765\u308b\u304b\u78ba\u8a8d\nftp\u30a2\u30d7\u30ea\u3092\u4f7f\u3063\u3066\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\n\u53c2\u8003\n\u30fbWEB\u958b\u767a\u8a18 | \u3055\u304f\u3089\u306eVPS\u3067\u30b5\u30fc\u30d0\u30fc\u5165\u95808\u3000vsftp\u306e\u5c0e\u5165\n\u30fbpistolfly | iptables\u3067ftp\u3092\u901a\u3059\nGit\u4ee5\u5916\u306e\u65b9\u6cd5\u3067\u3082\u3055\u304f\u3089VPS\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u4e0a\u3052\u308b\u70ba\u306b\u3001FTP\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308a\u3001\u305d\u306e\u65b9\u6cd5\u3092\u30e1\u30e2\u308a\u307e\u3059\u3002\n\n# vsftpd\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n## vsftpd\u3092\u5165\u308c\u307e\u3059\u3002\n\n```shell-session\n$ yum install vsftpd\n```\n\n```shell-session\n//vsftpd\u3092 \u8d77\u52d5\n$ sudo /etc/rc.d/init.d/vsftpd start\n \n//\u81ea\u52d5\u8d77\u52d5\u3092\u6709\u52b9\u5316\n$ sudo chkconfig vsftpd on\n```\n\n## vsftpd\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n\n```shell-session\n// \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u53d6\u308a\u307e\u3059\u3002\n$ cd \n$ mkdir origin\n$ sudo cp /etc/vsftpd/vsftpd.conf origin\n\n// \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u7de8\u96c6\u3002\n$ sudo vim /etc/vsftpd/vsftpd.conf \n---- \n#\u30a2\u30b9\u30ad\u30fc\u30e2\u30fc\u30c9\u3092\u6709\u52b9\u306b\u3059\u308b\nascii_upload_enable=YES\nascii_download_enable=YES   \n \n# TCP/IP \u3067\u306e\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3092\u7121\u52b9\u306b\u3059\u308b\u3000\uff08iptables \u3067\u4e00\u5fdcOK\uff09\ntcp_wrappers=NO \n \n# \u65e5\u672c\u6642\u9593\u3092\u4f7f\u7528\nuse_localtime=YES \n \n# anonymous \u3092\u7121\u52b9\u306b\u3059\u308b\nanonymous_enable=NO\n \n# /var/log/vsftpd.log\u3000\u306b\u30ed\u30b0\u3092\u8a18\u5165\nxferlog_std_format=NO\n \n# \u30ed\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b\ndual_log_enable=YES\n---\n```\n\n# chroot \u3068 FTP\u5229\u7528\u30e6\u30fc\u30b6\u30fc\u5236\u9650\n\n## \u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\n\n```shell-session\n# useradd hoge\n# passwd hoge\n``` \n\n## vsftpd.conf\u306e\u8a2d\u5b9a\n\n```shell-session\n$ sudo vim /etc/vsftpd/vsftpd.conf\n---\n# /etc/vsftpd/user_list\u3000\u306b\u8a18\u8ff0\u3055\u308c\u305f\u30e6\u30fc\u30b6\u30fc\u3092\u62d2\u5426\u3059\u308b\nuserlist_deny=NO\n \n# \u5168\u3066\u306e\u30ed\u30fc\u30ab\u30eb\u30e6\u30fc\u30b6\u30fc\u306bchroot\u3092\u6709\u52b9\u306b\u3059\u308b\u3002\nchroot_local_user=YES\nchroot_list_enable=NO\n \n# vsftpd\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092 /home/hoge/public_html \u306b\u8a2d\u5b9a\nlocal_root=/home/hoge/public_html\n---\n```\n\n**\u2191\u3067\u6307\u5b9a\u3057\u305f\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002**\n\n### \u203bchroot\u306b\u3064\u3044\u3066\u306f[\u30b3\u30c1\u30e9](http://blog.infinity-es.com/%E3%81%95%E3%81%8F%E3%82%89%E3%81%AEvps%E3%81%A7%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E5%85%A5%E9%96%808%E3%80%80vsftp%E3%81%AE%E5%B0%8E%E5%85%A5/)\n\n## \u30a2\u30af\u30bb\u30b9\u8a31\u53ef\u30e6\u30fc\u30b6\u30fc\u6307\u5b9a\n\n```shell-session\n$ sudo vim /etc/vsftpd/user_list\n---\n# vsftpd userlist\n# If userlist_deny=NO, only allow users in this file\n# If userlist_deny=YES (default), never allow users in this file, and\n# do not even prompt for a password.\n# Note that the default vsftpd pam config also checks /etc/vsftpd/ftpusers\n# for users that are denied.\nhoge\n---\n```\n\n# iptables \u8a2d\u5b9a\n\n```shell-session\n$ sudo vim /etc/sysconfig/iptables\n---\n-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\u3000\uff08\u8ffd\u8a18\uff09\n---\n\n$ sudo /etc/rc.d/init.d/iptables restart\n```\n\n\u3082\u3057\u304f\u306f\u4ee5\u4e0b\u3002\n\n```shell-session\n$ sudo iptables -A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\n$ sudo /etc/rc.d/init.d/iptables save\n``` \n\n# vsftpd\u306e\u53cd\u6620\n\n```shell-session\n// vsftpd \u306e\u8a2d\u5b9a\u3092\u53cd\u6620\n$ sudo /etc/rc.d/init.d/vsftpd restart\n```\n\n# IPTABLES_MODULES\u306e\u30ed\u30fc\u30c9\n\n## iptables-config\u3092\u7de8\u96c6\u3057\u307e\u3059\u3002\n\n```shell-session\n$ sudo vim /etc/sysconfig/iptables-config\n---\n# \u4ee5\u4e0b\u3092\u8ffd\u8a18\nIPTABLES_MODULES=\"ip_conntrack_ftp ip_nat_ftp\"\n---\n```\n\n## iptables-config\u3092restart\u3057\u307e\u3059\u3002\n\n```shell-session\n$ sudo /etc/rc.d/init.d/iptables restart\n```\n\n## \u30ed\u30fc\u30c9\u78ba\u8a8d\n\n```shell-session\n$ lsmod\n---\n// \u3053\u3053\u306b\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u3042\u308c\u3070OK\n---\n```\n\n# ftp\u51fa\u6765\u308b\u304b\u78ba\u8a8d\n\nftp\u30a2\u30d7\u30ea\u3092\u4f7f\u3063\u3066\u78ba\u8a8d\u3057\u3066\u307f\u308b\u3002\n\n# \u53c2\u8003\n\u30fb[WEB\u958b\u767a\u8a18 | \u3055\u304f\u3089\u306eVPS\u3067\u30b5\u30fc\u30d0\u30fc\u5165\u95808\u3000vsftp\u306e\u5c0e\u5165](http://blog.infinity-es.com/%E3%81%95%E3%81%8F%E3%82%89%E3%81%AEvps%E3%81%A7%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E5%85%A5%E9%96%808%E3%80%80vsftp%E3%81%AE%E5%B0%8E%E5%85%A5/)\n\u30fb[pistolfly | iptables\u3067ftp\u3092\u901a\u3059](http://www.pistolfly.com/weblog/2008/04/iptablesftp.html)", "tags": ["CentOS6", "\u3055\u304f\u3089VPS", "iptables", "ftp", "Linux"]}