{"context": " More than 1 year has passed since last update.Excel VBA\u3067\u3001\u7a7a\u767d\u3092\u542b\u3093\u3060\u5834\u5408\u306e\u6700\u7d42\u884c\u306e\u53d6\u5f97\u3092\u884c\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u30e1\u30e2\u3002\n\u8907\u6570\u306e\u5217\u306e\u6700\u7d42\u884c\u3092\u53d6\u5f97\u3057\u3066\u3001\u4e00\u756a\u5927\u304d\u3044\u7269\u3092\u8fd4\u3059\u3002\n\u4e0b\u306e\u4f8b\u3060\u306812\u3092\u8fd4\u3059\u3002\n\n\u6b6f\u629c\u3051\u306b\u306a\u3063\u3066\u3044\u3066\u3082\u3069\u3053\u304b\u306e\u5217\u306e\u6700\u7d42\u884c\u3092\u8fd4\u3059\u3002\u4e0b\u306e\u4f8b\u3060\u306814\u3092\u8fd4\u3059\u3002\n\n\n\u30bd\u30fc\u30b9\n'***************************************************\n' @fn \u30c7\u30fc\u30bf\u6700\u7d42\u884c\u3092\u53d6\u5f97\n' @param I N:(lastColIndex) \u30c7\u30fc\u30bf\u5217\u306e\u6700\u7d42\u5217\n' @return \u6700\u7d42\u884c\u756a\u53f7\n'***************************************************\nFunction GetLastRowIndex(ByVal lastColIndex As Long) As Long\n    Dim colIndex As Long   ' \u73fe\u5728\u5217\n    Dim wkIndex()          ' \u4f5c\u696d\u7528\u914d\u5217\n\n    ' \u30c7\u30fc\u30bf\u5217\u306e\u5168\u3066\u306e\u6700\u7d42\u884c\u3092\u914d\u5217\u306b\u683c\u7d0d\n    colIndex = 1 ' \u6700\u521d\u306e\u5217\n    ReDim wkIndex(lastColIndex) ' \u914d\u5217\u6570\u5b9a\u7fa9\n    Do\n        wkIndex(colIndex - 1) = Cells(Rows.Count, colIndex).End(xlUp).Row\n\n        colIndex = colIndex + 1 ' \u6b21\u306e\u5217\u3078\n        If colIndex > lastColIndex Then\n            Exit Do\n        End If\n    Loop\n\n    ' \u6700\u7d42\u884c\u3067\u4e00\u756a\u5927\u304d\u3044\u3082\u306e\u3092\u683c\u7d0d\u3059\u308b\n    Dim i As Long\n    Dim maxnum As Long: maxnum = -1 ' \u6700\u5927\u5024\n    For i = 0 To UBound(wkIndex)\n        If wkIndex(i) > maxnum Then\n            maxnum = wkIndex(i)\n        End If\n    Next i\n    GetLastRowIndex = maxnum\nEnd Function\n\n\n\u4f7f\u3044\u65b9\n\u30d8\u30c3\u30c0\u884c\u304c5\u884c\u76ee\u3001\u30c7\u30fc\u30bf\u5217\u304c3\u5217\u3001\u30c7\u30fc\u30bf\u884c\u306e\u59cb\u307e\u308a\u304c6\u884c\u76ee\u304b\u3089\u3042\u308b\u3068\u3059\u308b\u3002\n'************************************\n' \u30af\u30ea\u30a2\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\n'************************************\nSub ClearButton_Click()\n    Dim FastRowIndex As Long                   ' \u30d8\u30c3\u30c0\u3092\u9664\u304f\u30c7\u30fc\u30bf\u884c\u304b\u3089\n    Dim lastRowIndex As Long                   ' \u6700\u7d42\u884c\n    Dim res As VbMsgBoxResult\n    Dim lastColIndex As Long: lastColIndex = 3 ' \u6700\u7d42\u5217\n\n'    res = MsgBox(\"\u30c7\u30fc\u30bf\u884c\u3092\u30af\u30ea\u30a2\u3057\u307e\u3059\u3002\" & vbCr & \"\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\", vbOKCancel)\n'    If res = vbCancel Then\n'        Exit Sub\n'    End If\n\n    ' \u6700\u521d\u306e\u30d8\u30c3\u30c0\u3092\u9664\u304f\u30c7\u30fc\u30bf\u884c\u3092\u53d6\u5f97\n    FastRowIndex = Cells(1, 1).End(xlDown).Row + 1\n\n    ' \u6700\u7d42\u884c\u53d6\u5f97\n    lastRowIndex = GetLastRowIndex(lastColIndex) + 1\n\n    ' \u30c7\u30fc\u30bf\u884c\u30af\u30ea\u30a2\n    Range(Cells(FastRowIndex, 1), Cells(lastRowIndex, lastColIndex)).ClearContents\nEnd Sub\n\n\u25cf\u30d8\u30c3\u30c0\u3092\u9664\u304f\u30c7\u30fc\u30bf\u884c\u306e\u5024\u3092\u5168\u3066\u524a\u9664\u3057\u3066\u304f\u308c\u308b\u3002\n\n\u2193\n\n\u25cf\u7a81\u304d\u629c\u3051\u305f\u30c7\u30fc\u30bf\u304c\u3042\u3063\u305f\u308a\u7a7a\u767d\u3092\u542b\u3093\u3067\u3044\u3066\u3082\u5168\u3066\u306e\u6700\u7d42\u884c\u3092\u524a\u9664\u3057\u3066\u304f\u308c\u308b\n\n\u2193\n\n\u3053\u306e\u95a2\u6570\u306f\u3001\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3059\u308b\u3068\u304d\u306e\u6700\u7d42\u884c\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u4f7f\u3046\u306e\u3082\u826f\u3044\u304b\u3082\u3002\nExcel VBA\u3067\u3001\u7a7a\u767d\u3092\u542b\u3093\u3060\u5834\u5408\u306e\u6700\u7d42\u884c\u306e\u53d6\u5f97\u3092\u884c\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u30e1\u30e2\u3002\n\u8907\u6570\u306e\u5217\u306e\u6700\u7d42\u884c\u3092\u53d6\u5f97\u3057\u3066\u3001\u4e00\u756a\u5927\u304d\u3044\u7269\u3092\u8fd4\u3059\u3002\n\n\u4e0b\u306e\u4f8b\u3060\u306812\u3092\u8fd4\u3059\u3002\n![get1.png](https://qiita-image-store.s3.amazonaws.com/0/93950/8cf2adcd-6c00-2cc4-71e2-c99fb84a29a6.png)\n\n\u6b6f\u629c\u3051\u306b\u306a\u3063\u3066\u3044\u3066\u3082\u3069\u3053\u304b\u306e\u5217\u306e\u6700\u7d42\u884c\u3092\u8fd4\u3059\u3002\u4e0b\u306e\u4f8b\u3060\u306814\u3092\u8fd4\u3059\u3002\n![get2.png](https://qiita-image-store.s3.amazonaws.com/0/93950/4b741bfe-2e99-98f6-ff8b-cadb688c2e8d.png)\n\n# \u30bd\u30fc\u30b9\n\n```vbnet:\n'***************************************************\n' @fn \u30c7\u30fc\u30bf\u6700\u7d42\u884c\u3092\u53d6\u5f97\n' @param I N:(lastColIndex) \u30c7\u30fc\u30bf\u5217\u306e\u6700\u7d42\u5217\n' @return \u6700\u7d42\u884c\u756a\u53f7\n'***************************************************\nFunction GetLastRowIndex(ByVal lastColIndex As Long) As Long\n    Dim colIndex As Long   ' \u73fe\u5728\u5217\n    Dim wkIndex()          ' \u4f5c\u696d\u7528\u914d\u5217\n    \n    ' \u30c7\u30fc\u30bf\u5217\u306e\u5168\u3066\u306e\u6700\u7d42\u884c\u3092\u914d\u5217\u306b\u683c\u7d0d\n    colIndex = 1 ' \u6700\u521d\u306e\u5217\n    ReDim wkIndex(lastColIndex) ' \u914d\u5217\u6570\u5b9a\u7fa9\n    Do\n        wkIndex(colIndex - 1) = Cells(Rows.Count, colIndex).End(xlUp).Row\n        \n        colIndex = colIndex + 1 ' \u6b21\u306e\u5217\u3078\n        If colIndex > lastColIndex Then\n            Exit Do\n        End If\n    Loop\n    \n    ' \u6700\u7d42\u884c\u3067\u4e00\u756a\u5927\u304d\u3044\u3082\u306e\u3092\u683c\u7d0d\u3059\u308b\n    Dim i As Long\n    Dim maxnum As Long: maxnum = -1 ' \u6700\u5927\u5024\n    For i = 0 To UBound(wkIndex)\n        If wkIndex(i) > maxnum Then\n            maxnum = wkIndex(i)\n        End If\n    Next i\n    GetLastRowIndex = maxnum\nEnd Function\n```\n\n# \u4f7f\u3044\u65b9\n\n\u30d8\u30c3\u30c0\u884c\u304c5\u884c\u76ee\u3001\u30c7\u30fc\u30bf\u5217\u304c3\u5217\u3001\u30c7\u30fc\u30bf\u884c\u306e\u59cb\u307e\u308a\u304c6\u884c\u76ee\u304b\u3089\u3042\u308b\u3068\u3059\u308b\u3002\n\n```vbnet:\n'************************************\n' \u30af\u30ea\u30a2\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\n'************************************\nSub ClearButton_Click()\n    Dim FastRowIndex As Long                   ' \u30d8\u30c3\u30c0\u3092\u9664\u304f\u30c7\u30fc\u30bf\u884c\u304b\u3089\n    Dim lastRowIndex As Long                   ' \u6700\u7d42\u884c\n    Dim res As VbMsgBoxResult\n    Dim lastColIndex As Long: lastColIndex = 3 ' \u6700\u7d42\u5217\n\n'    res = MsgBox(\"\u30c7\u30fc\u30bf\u884c\u3092\u30af\u30ea\u30a2\u3057\u307e\u3059\u3002\" & vbCr & \"\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f\", vbOKCancel)\n'    If res = vbCancel Then\n'        Exit Sub\n'    End If\n        \n    ' \u6700\u521d\u306e\u30d8\u30c3\u30c0\u3092\u9664\u304f\u30c7\u30fc\u30bf\u884c\u3092\u53d6\u5f97\n    FastRowIndex = Cells(1, 1).End(xlDown).Row + 1\n    \n    ' \u6700\u7d42\u884c\u53d6\u5f97\n    lastRowIndex = GetLastRowIndex(lastColIndex) + 1\n    \n    ' \u30c7\u30fc\u30bf\u884c\u30af\u30ea\u30a2\n    Range(Cells(FastRowIndex, 1), Cells(lastRowIndex, lastColIndex)).ClearContents\nEnd Sub\n```\n\n\u25cf\u30d8\u30c3\u30c0\u3092\u9664\u304f\u30c7\u30fc\u30bf\u884c\u306e\u5024\u3092\u5168\u3066\u524a\u9664\u3057\u3066\u304f\u308c\u308b\u3002\n![\u30af\u30ea\u30a2\uff11.png](https://qiita-image-store.s3.amazonaws.com/0/93950/ebcdfe0a-a7b1-8998-9302-c30399111eca.png)\n\u2193\n![\u30af\u30ea\u30a2\uff12.png](https://qiita-image-store.s3.amazonaws.com/0/93950/9405bef2-5c78-8b07-5b72-203368b4c6ba.png)\n\n\u25cf\u7a81\u304d\u629c\u3051\u305f\u30c7\u30fc\u30bf\u304c\u3042\u3063\u305f\u308a\u7a7a\u767d\u3092\u542b\u3093\u3067\u3044\u3066\u3082\u5168\u3066\u306e\u6700\u7d42\u884c\u3092\u524a\u9664\u3057\u3066\u304f\u308c\u308b\n![\u30af\u30ea\u30a2\uff13.png](https://qiita-image-store.s3.amazonaws.com/0/93950/ea89e361-6d49-64ed-2ff5-c190e85bf10f.png)\n\u2193\n![\u30af\u30ea\u30a2\uff14.png](https://qiita-image-store.s3.amazonaws.com/0/93950/96485c9d-7811-5460-d850-71064011720f.png)\n\n\u3053\u306e\u95a2\u6570\u306f\u3001\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3059\u308b\u3068\u304d\u306e\u6700\u7d42\u884c\u3092\u53d6\u5f97\u3059\u308b\u305f\u3081\u306b\u4f7f\u3046\u306e\u3082\u826f\u3044\u304b\u3082\u3002\n", "tags": ["ExcelVBA", "\u30e1\u30e2"]}