{"context": "\n\n\u306f\u3058\u3081\u306b\n\u4eca\u66f4\u3067\u3059\u304c\u3001\nUIViewControllerTransitioningDelegate\u3092\u5229\u7528\u3057\u305f\n\u30ab\u30b9\u30bf\u30e0\u30c8\u30e9\u30f3\u30b8\u30b7\u30e7\u30f3\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u5099\u5fd8\u9332\u3068\u3057\u3066\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u52d5\u4f5c\u30a4\u30e1\u30fc\u30b8\u306f\u3001Pinterest\u98a8\u306e\u30c8\u30e9\u30f3\u30b8\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\u7d20\u6575\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u52c9\u5f37\u304c\u3066\u3089\u306b\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n\u5b9f\u88c5\u624b\u9806\n\n\u753b\u9762\u9077\u79fb\u5143\u3001\u753b\u9762\u9077\u79fb\u5148\u3001CollectionViewCell\u7528\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u5b9a\u7fa9\u3059\u308b\n\u753b\u9762\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\n\u753b\u9762\u975e\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\nUIViewControllerTransitioningDelegate\u3092\u7d99\u627f\u3057\u305f\u30b5\u30d6\u30af\u30e9\u30b9\u3092\u4f5c\u308b\nPinterest\u98a8\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5229\u7528\u3057\u3066\u307f\u308b\n\n\n1. \u753b\u9762\u9077\u79fb\u5143\u3001\u753b\u9762\u9077\u79fb\u5148\u3001CollectionViewCell\u7528\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u5b9a\u7fa9\u3059\u308b\n\u30c8\u30e9\u30f3\u30b8\u30b7\u30e7\u30f3\u306b\u5fc5\u8981\u306a\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u4e0b\u8a18\u306e\uff13\u3064\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\u30fb\u753b\u9762\u9077\u79fb\u5143\u306b\u306f\u3001UICollectionView\u3068\u571f\u53f0\u306eUIView\u3092\u8a2d\u7f6e\u3057\u307e\u3059\n\u30fb\u753b\u9762\u9077\u79fb\u5148\u306b\u306f\u3001UIImageView\u3068\u571f\u53f0\u306eView\u3092\u8a2d\u7f6e\u3057\u307e\u3059\n\u30fbCollectionViewCell\u306b\u306f\u3001UIImageView\u3092\u8a2d\u7f6e\u3057\u307e\u3059\n\nImageTransitionProtocol.swift\nimport UIKit\n\nprotocol ImageSourceTransitionType {\n    var collectionView: UICollectionView! {get}\n    var baseView: UIView! {get}\n}\n\nprotocol ImageDistinationTransitionType {\n    var imageView: UIImageView! {get}\n    var baseView: UIView! {get}\n}\n\nprotocol ImageCollectionViewCellType {\n    var imageView: UIImageView! {get}\n}\n\n\n\n2. \u753b\u9762\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\n\u753b\u9762\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092ImagePresentedAnimator\u3068\u3057\u307e\u3059\u3002\n\nImagePresentedAnimator.swift\nimport UIKit\n\nclass ImagePresentedAnimator: NSObject, UIViewControllerAnimatedTransitioning {\n\n    func transitionDuration(transitionContext: UIViewControllerContextTransitioning?) -> NSTimeInterval {\n        return 0.3\n    }\n\n    func animateTransition(transitionContext: UIViewControllerContextTransitioning) {\n\n        guard let sourceVC = transitionContext.viewControllerForKey(UITransitionContextFromViewControllerKey)\n            as? ImageSourceTransitionType else {\n            return\n        }\n\n        guard let distinationVC = transitionContext.viewControllerForKey(UITransitionContextToViewControllerKey)\n            as? ImageDistinationTransitionType else {\n            return\n        }\n\n        guard let containerView = transitionContext.containerView() else {\n            return\n        }\n\n        let animationDuration = transitionDuration(transitionContext)\n\n        guard let selectedIndexPath = sourceVC.collectionView.indexPathsForSelectedItems()?.first else {\n            return\n        }\n\n        let selectedCell = sourceVC.collectionView.cellForItemAtIndexPath(selectedIndexPath)\n            as! ImageCollectionViewCellType\n        let selectedImage = selectedCell.imageView.image\n\n        let selectedCellsFrame = containerView.convertRect(selectedCell.imageView.frame,\n            fromView: selectedCell.imageView.superview)\n\n        let selectedImageWrapperView = UIView.init(frame: selectedCellsFrame)\n        selectedImageWrapperView.backgroundColor = UIColor.clearColor()\n        selectedImageWrapperView.clipsToBounds = true\n\n        let imageView = UIImageView.init(image: selectedImage)\n        imageView.frame = CGRectMake(0.0, 0.0, CGRectGetWidth(selectedCellsFrame), CGRectGetHeight(selectedCellsFrame))\n        imageView.contentMode = distinationVC.imageView.contentMode\n        imageView.autoresizingMask = [.FlexibleHeight,.FlexibleWidth,.FlexibleTopMargin,.FlexibleBottomMargin]\n        selectedImageWrapperView.addSubview(imageView)\n\n        containerView.addSubview(selectedImageWrapperView)\n\n        let whiteBackgroundView = UIView.init(frame: sourceVC.baseView.frame)\n        whiteBackgroundView.backgroundColor = UIColor.whiteColor()\n        containerView.insertSubview(whiteBackgroundView, belowSubview: selectedImageWrapperView)\n\n        distinationVC.baseView.alpha = 0.0\n        containerView.addSubview(distinationVC.baseView)\n\n        let rect = CGRectMake(0.0, 0.0,\n                              CGRectGetWidth(distinationVC.baseView.frame),\n                              CGRectGetHeight(distinationVC.baseView.frame))\n        let imageViewFinalFrame = containerView.convertRect(rect, fromView: distinationVC.baseView)\n\n        UIView.animateWithDuration(animationDuration,\n                                   delay: 0.0,\n                                   options: .CurveEaseOut,\n                                   animations: {\n                                    selectedImageWrapperView.frame = imageViewFinalFrame\n            }) { (finished) in\n\n                distinationVC.imageView.image = selectedImage;\n                distinationVC.baseView.alpha = 1.0;\n                transitionContext.completeTransition(!transitionContext.transitionWasCancelled())\n        }\n    }\n}\n\n\n\n3. \u753b\u9762\u975e\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\n\u753b\u9762\u975e\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092ImageDismissedAnimator\u3068\u3057\u307e\u3059\u3002\n\nImageDismissedAnimator.swift\nimport UIKit\n\nclass ImageDismissedAnimator: NSObject, UIViewControllerAnimatedTransitioning {\n\n    func transitionDuration(transitionContext: UIViewControllerContextTransitioning?) -> NSTimeInterval {\n        return 0.3\n    }\n\n    func animateTransition(transitionContext: UIViewControllerContextTransitioning) {\n\n        guard let sourceVC = transitionContext.viewControllerForKey(UITransitionContextFromViewControllerKey)\n            as? ImageDistinationTransitionType else {\n                return\n        }\n\n        guard let distinationVC = transitionContext.viewControllerForKey(UITransitionContextToViewControllerKey)\n            as? ImageSourceTransitionType else {\n                return\n        }\n\n        guard let containerView = transitionContext.containerView() else {\n            return\n        }\n\n        let animationDuration = transitionDuration(transitionContext)\n\n        let snapshot = sourceVC.imageView.snapshotViewAfterScreenUpdates(false)\n        snapshot.frame = containerView.convertRect(sourceVC.imageView.frame,\n                                                   toView: sourceVC.imageView.superview)\n        snapshot.autoresizingMask = [.FlexibleHeight,.FlexibleWidth,.FlexibleTopMargin,.FlexibleBottomMargin]\n        sourceVC.imageView.alpha = 0.0\n\n        guard let selectedIndexPath = distinationVC.collectionView.indexPathsForSelectedItems()?.first else {\n            return\n        }\n\n        let selectedCell = distinationVC.collectionView.cellForItemAtIndexPath(selectedIndexPath) as! ImageCollectionViewCellType\n        selectedCell.imageView.alpha = 0.0\n        selectedCell.imageView.transform =  CGAffineTransformMakeScale(1.1, 1.1)\n\n        distinationVC.baseView.frame = transitionContext.finalFrameForViewController(distinationVC as! UIViewController)\n        containerView.insertSubview(distinationVC.baseView, belowSubview: sourceVC.baseView)\n\n        let imageWrapperView = UIView.init(frame: containerView.convertRect(sourceVC.imageView.frame,\n            toView: sourceVC.imageView.superview))\n        imageWrapperView.clipsToBounds = true\n        imageWrapperView.addSubview(snapshot)\n        containerView.addSubview(imageWrapperView)\n\n        let whiteBackgroundView = UIView.init(frame: sourceVC.baseView.frame)\n        whiteBackgroundView.backgroundColor = UIColor.whiteColor()\n        containerView.insertSubview(whiteBackgroundView, belowSubview: imageWrapperView)\n\n        UIView.animateKeyframesWithDuration(animationDuration,\n                                            delay: 0.0,\n                                            options: UIViewKeyframeAnimationOptions.CalculationModeLinear,\n                                            animations: {\n\n                                                UIView .addKeyframeWithRelativeStartTime(0.0,\n                                                    relativeDuration: 1.0,\n                                                    animations: {\n\n                                                        sourceVC.baseView.alpha = 0.0\n                                                        imageWrapperView.frame = containerView.convertRect(selectedCell.imageView.frame,\n                                                            fromView: selectedCell.imageView.superview)\n                                                        whiteBackgroundView.alpha = 0.0\n                                                        selectedCell.imageView.alpha = 1.0\n                                                })\n\n                                                UIView .addKeyframeWithRelativeStartTime(0.95,\n                                                    relativeDuration: 0.05,\n                                                    animations: {\n                                                        selectedCell.imageView.transform = CGAffineTransformIdentity\n                                                        snapshot.alpha = 0.0\n                                                })\n\n            }) { (finished) in\n\n                whiteBackgroundView.removeFromSuperview()\n                snapshot.removeFromSuperview()\n                imageWrapperView.removeFromSuperview()\n                sourceVC.imageView.hidden = false\n                transitionContext.completeTransition(!transitionContext.transitionWasCancelled())\n        }\n    }\n}\n\n\n\n4. UIViewControllerTransitioningDelegate\u3092\u7d99\u627f\u3057\u305f\u30b5\u30d6\u30af\u30e9\u30b9\u3092\u4f5c\u308b\n\nImageTransitionDelegate.swift\nimport UIKit\n\nclass ImageTransitionDelegate: NSObject {}\n\nextension ImageTransitionDelegate: UIViewControllerTransitioningDelegate{\n\n    func animationControllerForPresentedController(presented: UIViewController, presentingController presenting: UIViewController, sourceController source: UIViewController) -> UIViewControllerAnimatedTransitioning? {\n        return ImagePresentedAnimator()\n    }\n\n    func animationControllerForDismissedController(dismissed: UIViewController) -> UIViewControllerAnimatedTransitioning? {\n        return ImageDismissedAnimator()\n    }\n}\n\n\n\n5. Pinterest\u98a8\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5229\u7528\u3057\u3066\u307f\u308b\n\n\u753b\u9762\u30a4\u30e1\u30fc\u30b8\n\n\n\u753b\u9762\u9077\u79fb\u5143\u753b\u9762\n\nViewController.swift\nimport UIKit\n\nclass ViewController: UIViewController {\n\n    @IBOutlet weak var collectionView: UICollectionView!\n    @IBOutlet var baseView: UIView!\n\n    var imageTransitioningDelegate: ImageTransitionDelegate?\n}\n\nextension ViewController: UICollectionViewDataSource {\n\n    func collectionView(collectionView: UICollectionView, cellForItemAtIndexPath indexPath: NSIndexPath) -> UICollectionViewCell {\n\n        let cell = collectionView.dequeueReusableCellWithReuseIdentifier(\"ImageCollectionViewCell\",\n        forIndexPath: indexPath) as! ImageCollectionViewCell\n\n        //\u9069\u5f53\u306b\u753b\u50cf\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\n        let imageName = indexPath.row % 2 == 0 ? \"image1\" : \"image2\"\n        cell.imageView.image = UIImage.init(named: imageName)\n        return cell\n    }\n\n    func collectionView(collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {\n        //\u9069\u5f53\u306b\u8868\u793a\u3059\u308b\u753b\u50cf\u6570\u8fd4\u3057\u3066\u3044\u307e\u3059\n        return 15\n    }\n}\n\nextension ViewController: UICollectionViewDelegate {\n\n    func collectionView(collectionView: UICollectionView, didSelectItemAtIndexPath indexPath: NSIndexPath) {\n\n        if imageTransitioningDelegate == nil {\n            imageTransitioningDelegate = ImageTransitionDelegate()\n        }\n\n        let vc = UIStoryboard(name: \"Main\",bundle: nil).instantiateViewControllerWithIdentifier(\"DetailViewController\")\n            as! DetailViewController\n\n        //Pinterest\u98a8\u306e\u30c8\u30e9\u30f3\u30b8\u30b7\u30e7\u30f3\u3092\u30bb\u30c3\u30c8\u3057\u3066\u3044\u307e\u3059\n        vc.transitioningDelegate = imageTransitioningDelegate\n\n        let imageName = indexPath.row % 2 == 0 ? \"image1\" : \"image2\"\n        vc.imageToPresent = UIImage.init(named: imageName)\n        presentViewController(vc, animated: true, completion: nil)\n    }\n}\n\n\nextension ViewController: ImageSourceTransitionType {}\n\n\n\n\u753b\u9762\u9077\u79fb\u5148\u753b\u9762\n\nDetailViewController.swift\nimport UIKit\n\nclass DetailViewController: UIViewController {\n\n    var imageToPresent: UIImage!\n    @IBOutlet weak var imageView: UIImageView!\n    @IBOutlet var baseView: UIView!\n\n    @IBAction func didTappedDissmiss(sender: UIButton) {\n        self.dismissViewControllerAnimated(true, completion: nil)\n    }\n}\n\nextension DetailViewController: ImageDistinationTransitionType {}\n\n\n\n\nCollectionViewCell\n\nImageCollectionViewCell.swift\nimport UIKit\n\nclass ImageCollectionViewCell: UICollectionViewCell {\n    @IBOutlet weak var imageView: UIImageView!\n}\n\nextension ImageCollectionViewCell: ImageCollectionViewCellType {}\n\n\n\n\u307e\u3068\u3081\n\u57fa\u672c\u7684\u306b\u306f\u3001UIViewControllerAnimatedTransitioning\u3092\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u3067\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5b9a\u7fa9\u3057\u3001\nUIViewControllerTransitioningDelegate\u3092\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u3067\u3001\u5404\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3068\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002\n\u3042\u3068\u306f\u3001\u753b\u9762\u9077\u79fb\u6642\u306b\u3001transitioningDelegate\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u4e0a\u8a18\u306e\u30af\u30e9\u30b9\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\n\u53c2\u8003\nhttp://zappdesigntemplates.com/create-custom-uicollectionviewcell-transition/\n# \u306f\u3058\u3081\u306b\n\u4eca\u66f4\u3067\u3059\u304c\u3001\nUIViewControllerTransitioningDelegate\u3092\u5229\u7528\u3057\u305f\n\u30ab\u30b9\u30bf\u30e0\u30c8\u30e9\u30f3\u30b8\u30b7\u30e7\u30f3\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u5099\u5fd8\u9332\u3068\u3057\u3066\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n\u52d5\u4f5c\u30a4\u30e1\u30fc\u30b8\u306f\u3001Pinterest\u98a8\u306e\u30c8\u30e9\u30f3\u30b8\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\u7d20\u6575\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u52c9\u5f37\u304c\u3066\u3089\u306b\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3059\u3002\n\n![circleAnimationMuvie.gif](https://qiita-image-store.s3.amazonaws.com/0/71694/8327845d-f258-1ec7-0922-1a724a18e9d0.gif)\n\n# \u5b9f\u88c5\u624b\u9806\n1. \u753b\u9762\u9077\u79fb\u5143\u3001\u753b\u9762\u9077\u79fb\u5148\u3001CollectionViewCell\u7528\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u5b9a\u7fa9\u3059\u308b\n2. \u753b\u9762\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\n3. \u753b\u9762\u975e\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\n4. UIViewControllerTransitioningDelegate\u3092\u7d99\u627f\u3057\u305f\u30b5\u30d6\u30af\u30e9\u30b9\u3092\u4f5c\u308b\n5. Pinterest\u98a8\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5229\u7528\u3057\u3066\u307f\u308b\n\n## 1. \u753b\u9762\u9077\u79fb\u5143\u3001\u753b\u9762\u9077\u79fb\u5148\u3001CollectionViewCell\u7528\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u5b9a\u7fa9\u3059\u308b\n\u30c8\u30e9\u30f3\u30b8\u30b7\u30e7\u30f3\u306b\u5fc5\u8981\u306a\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u30d7\u30ed\u30c8\u30b3\u30eb\u3067\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u4e0b\u8a18\u306e\uff13\u3064\u306e\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n\u30fb\u753b\u9762\u9077\u79fb\u5143\u306b\u306f\u3001UICollectionView\u3068\u571f\u53f0\u306eUIView\u3092\u8a2d\u7f6e\u3057\u307e\u3059\n\u30fb\u753b\u9762\u9077\u79fb\u5148\u306b\u306f\u3001UIImageView\u3068\u571f\u53f0\u306eView\u3092\u8a2d\u7f6e\u3057\u307e\u3059\n\u30fbCollectionViewCell\u306b\u306f\u3001UIImageView\u3092\u8a2d\u7f6e\u3057\u307e\u3059\n\n```swift:ImageTransitionProtocol.swift\nimport UIKit\n\nprotocol ImageSourceTransitionType {\n    var collectionView: UICollectionView! {get}\n    var baseView: UIView! {get}\n}\n\nprotocol ImageDistinationTransitionType {\n    var imageView: UIImageView! {get}\n    var baseView: UIView! {get}\n}\n\nprotocol ImageCollectionViewCellType {\n    var imageView: UIImageView! {get}\n}\n```\n\n## 2. \u753b\u9762\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\n\u753b\u9762\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092ImagePresentedAnimator\u3068\u3057\u307e\u3059\u3002\n\n```swift:ImagePresentedAnimator.swift\nimport UIKit\n\nclass ImagePresentedAnimator: NSObject, UIViewControllerAnimatedTransitioning {\n\n    func transitionDuration(transitionContext: UIViewControllerContextTransitioning?) -> NSTimeInterval {\n        return 0.3\n    }\n\n    func animateTransition(transitionContext: UIViewControllerContextTransitioning) {\n\n        guard let sourceVC = transitionContext.viewControllerForKey(UITransitionContextFromViewControllerKey)\n            as? ImageSourceTransitionType else {\n            return\n        }\n\n        guard let distinationVC = transitionContext.viewControllerForKey(UITransitionContextToViewControllerKey)\n            as? ImageDistinationTransitionType else {\n            return\n        }\n\n        guard let containerView = transitionContext.containerView() else {\n            return\n        }\n\n        let animationDuration = transitionDuration(transitionContext)\n\n        guard let selectedIndexPath = sourceVC.collectionView.indexPathsForSelectedItems()?.first else {\n            return\n        }\n\n        let selectedCell = sourceVC.collectionView.cellForItemAtIndexPath(selectedIndexPath)\n            as! ImageCollectionViewCellType\n        let selectedImage = selectedCell.imageView.image\n\n        let selectedCellsFrame = containerView.convertRect(selectedCell.imageView.frame,\n            fromView: selectedCell.imageView.superview)\n\n        let selectedImageWrapperView = UIView.init(frame: selectedCellsFrame)\n        selectedImageWrapperView.backgroundColor = UIColor.clearColor()\n        selectedImageWrapperView.clipsToBounds = true\n\n        let imageView = UIImageView.init(image: selectedImage)\n        imageView.frame = CGRectMake(0.0, 0.0, CGRectGetWidth(selectedCellsFrame), CGRectGetHeight(selectedCellsFrame))\n        imageView.contentMode = distinationVC.imageView.contentMode\n        imageView.autoresizingMask = [.FlexibleHeight,.FlexibleWidth,.FlexibleTopMargin,.FlexibleBottomMargin]\n        selectedImageWrapperView.addSubview(imageView)\n\n        containerView.addSubview(selectedImageWrapperView)\n\n        let whiteBackgroundView = UIView.init(frame: sourceVC.baseView.frame)\n        whiteBackgroundView.backgroundColor = UIColor.whiteColor()\n        containerView.insertSubview(whiteBackgroundView, belowSubview: selectedImageWrapperView)\n\n        distinationVC.baseView.alpha = 0.0\n        containerView.addSubview(distinationVC.baseView)\n\n        let rect = CGRectMake(0.0, 0.0,\n                              CGRectGetWidth(distinationVC.baseView.frame),\n                              CGRectGetHeight(distinationVC.baseView.frame))\n        let imageViewFinalFrame = containerView.convertRect(rect, fromView: distinationVC.baseView)\n\n        UIView.animateWithDuration(animationDuration,\n                                   delay: 0.0,\n                                   options: .CurveEaseOut,\n                                   animations: {\n                                    selectedImageWrapperView.frame = imageViewFinalFrame\n            }) { (finished) in\n\n                distinationVC.imageView.image = selectedImage;\n                distinationVC.baseView.alpha = 1.0;\n                transitionContext.completeTransition(!transitionContext.transitionWasCancelled())\n        }\n    }\n}\n```\n\n## 3. \u753b\u9762\u975e\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3059\u308b\n\u753b\u9762\u975e\u8868\u793a\u6642\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u30af\u30e9\u30b9\u3092ImageDismissedAnimator\u3068\u3057\u307e\u3059\u3002\n\n```swift:ImageDismissedAnimator.swift\nimport UIKit\n\nclass ImageDismissedAnimator: NSObject, UIViewControllerAnimatedTransitioning {\n\n    func transitionDuration(transitionContext: UIViewControllerContextTransitioning?) -> NSTimeInterval {\n        return 0.3\n    }\n\n    func animateTransition(transitionContext: UIViewControllerContextTransitioning) {\n\n        guard let sourceVC = transitionContext.viewControllerForKey(UITransitionContextFromViewControllerKey)\n            as? ImageDistinationTransitionType else {\n                return\n        }\n\n        guard let distinationVC = transitionContext.viewControllerForKey(UITransitionContextToViewControllerKey)\n            as? ImageSourceTransitionType else {\n                return\n        }\n\n        guard let containerView = transitionContext.containerView() else {\n            return\n        }\n\n        let animationDuration = transitionDuration(transitionContext)\n\n        let snapshot = sourceVC.imageView.snapshotViewAfterScreenUpdates(false)\n        snapshot.frame = containerView.convertRect(sourceVC.imageView.frame,\n                                                   toView: sourceVC.imageView.superview)\n        snapshot.autoresizingMask = [.FlexibleHeight,.FlexibleWidth,.FlexibleTopMargin,.FlexibleBottomMargin]\n        sourceVC.imageView.alpha = 0.0\n\n        guard let selectedIndexPath = distinationVC.collectionView.indexPathsForSelectedItems()?.first else {\n            return\n        }\n\n        let selectedCell = distinationVC.collectionView.cellForItemAtIndexPath(selectedIndexPath) as! ImageCollectionViewCellType\n        selectedCell.imageView.alpha = 0.0\n        selectedCell.imageView.transform =  CGAffineTransformMakeScale(1.1, 1.1)\n\n        distinationVC.baseView.frame = transitionContext.finalFrameForViewController(distinationVC as! UIViewController)\n        containerView.insertSubview(distinationVC.baseView, belowSubview: sourceVC.baseView)\n\n        let imageWrapperView = UIView.init(frame: containerView.convertRect(sourceVC.imageView.frame,\n            toView: sourceVC.imageView.superview))\n        imageWrapperView.clipsToBounds = true\n        imageWrapperView.addSubview(snapshot)\n        containerView.addSubview(imageWrapperView)\n\n        let whiteBackgroundView = UIView.init(frame: sourceVC.baseView.frame)\n        whiteBackgroundView.backgroundColor = UIColor.whiteColor()\n        containerView.insertSubview(whiteBackgroundView, belowSubview: imageWrapperView)\n\n        UIView.animateKeyframesWithDuration(animationDuration,\n                                            delay: 0.0,\n                                            options: UIViewKeyframeAnimationOptions.CalculationModeLinear,\n                                            animations: {\n\n                                                UIView .addKeyframeWithRelativeStartTime(0.0,\n                                                    relativeDuration: 1.0,\n                                                    animations: {\n\n                                                        sourceVC.baseView.alpha = 0.0\n                                                        imageWrapperView.frame = containerView.convertRect(selectedCell.imageView.frame,\n                                                            fromView: selectedCell.imageView.superview)\n                                                        whiteBackgroundView.alpha = 0.0\n                                                        selectedCell.imageView.alpha = 1.0\n                                                })\n\n                                                UIView .addKeyframeWithRelativeStartTime(0.95,\n                                                    relativeDuration: 0.05,\n                                                    animations: {\n                                                        selectedCell.imageView.transform = CGAffineTransformIdentity\n                                                        snapshot.alpha = 0.0\n                                                })\n\n            }) { (finished) in\n\n                whiteBackgroundView.removeFromSuperview()\n                snapshot.removeFromSuperview()\n                imageWrapperView.removeFromSuperview()\n                sourceVC.imageView.hidden = false\n                transitionContext.completeTransition(!transitionContext.transitionWasCancelled())\n        }\n    }\n}\n```\n## 4. UIViewControllerTransitioningDelegate\u3092\u7d99\u627f\u3057\u305f\u30b5\u30d6\u30af\u30e9\u30b9\u3092\u4f5c\u308b\n\n```swift:ImageTransitionDelegate.swift\nimport UIKit\n\nclass ImageTransitionDelegate: NSObject {}\n\nextension ImageTransitionDelegate: UIViewControllerTransitioningDelegate{\n\n    func animationControllerForPresentedController(presented: UIViewController, presentingController presenting: UIViewController, sourceController source: UIViewController) -> UIViewControllerAnimatedTransitioning? {\n        return ImagePresentedAnimator()\n    }\n\n    func animationControllerForDismissedController(dismissed: UIViewController) -> UIViewControllerAnimatedTransitioning? {\n        return ImageDismissedAnimator()\n    }\n}\n```\n\n## 5. Pinterest\u98a8\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5229\u7528\u3057\u3066\u307f\u308b\n\n### \u753b\u9762\u30a4\u30e1\u30fc\u30b8\n\n<img width=\"726\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-06 21.16.06.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/71694/4348592f-675c-9c4f-d46f-f0dae8c9b7e1.png\">\n\n#### \u753b\u9762\u9077\u79fb\u5143\u753b\u9762\n\n```swift:ViewController.swift\nimport UIKit\n\nclass ViewController: UIViewController {\n\n    @IBOutlet weak var collectionView: UICollectionView!\n    @IBOutlet var baseView: UIView!\n\n    var imageTransitioningDelegate: ImageTransitionDelegate?\n}\n\nextension ViewController: UICollectionViewDataSource {\n\n    func collectionView(collectionView: UICollectionView, cellForItemAtIndexPath indexPath: NSIndexPath) -> UICollectionViewCell {\n\n        let cell = collectionView.dequeueReusableCellWithReuseIdentifier(\"ImageCollectionViewCell\",\n        forIndexPath: indexPath) as! ImageCollectionViewCell\n\n        //\u9069\u5f53\u306b\u753b\u50cf\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\n        let imageName = indexPath.row % 2 == 0 ? \"image1\" : \"image2\"\n        cell.imageView.image = UIImage.init(named: imageName)\n        return cell\n    }\n\n    func collectionView(collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {\n        //\u9069\u5f53\u306b\u8868\u793a\u3059\u308b\u753b\u50cf\u6570\u8fd4\u3057\u3066\u3044\u307e\u3059\n        return 15\n    }\n}\n\nextension ViewController: UICollectionViewDelegate {\n\n    func collectionView(collectionView: UICollectionView, didSelectItemAtIndexPath indexPath: NSIndexPath) {\n\n        if imageTransitioningDelegate == nil {\n            imageTransitioningDelegate = ImageTransitionDelegate()\n        }\n\n        let vc = UIStoryboard(name: \"Main\",bundle: nil).instantiateViewControllerWithIdentifier(\"DetailViewController\")\n            as! DetailViewController\n\n        //Pinterest\u98a8\u306e\u30c8\u30e9\u30f3\u30b8\u30b7\u30e7\u30f3\u3092\u30bb\u30c3\u30c8\u3057\u3066\u3044\u307e\u3059\n        vc.transitioningDelegate = imageTransitioningDelegate\n\n        let imageName = indexPath.row % 2 == 0 ? \"image1\" : \"image2\"\n        vc.imageToPresent = UIImage.init(named: imageName)\n        presentViewController(vc, animated: true, completion: nil)\n    }\n}\n\n\nextension ViewController: ImageSourceTransitionType {}\n```\n\n#### \u753b\u9762\u9077\u79fb\u5148\u753b\u9762\n\n```swift:DetailViewController.swift\nimport UIKit\n\nclass DetailViewController: UIViewController {\n\n    var imageToPresent: UIImage!\n    @IBOutlet weak var imageView: UIImageView!\n    @IBOutlet var baseView: UIView!\n\n    @IBAction func didTappedDissmiss(sender: UIButton) {\n        self.dismissViewControllerAnimated(true, completion: nil)\n    }\n}\n\nextension DetailViewController: ImageDistinationTransitionType {}\n\n```\n\n#### CollectionViewCell\n\n```swift:ImageCollectionViewCell.swift\nimport UIKit\n\nclass ImageCollectionViewCell: UICollectionViewCell {\n    @IBOutlet weak var imageView: UIImageView!\n}\n\nextension ImageCollectionViewCell: ImageCollectionViewCellType {}\n```\n\n# \u307e\u3068\u3081\n\u57fa\u672c\u7684\u306b\u306f\u3001UIViewControllerAnimatedTransitioning\u3092\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u3067\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u5b9a\u7fa9\u3057\u3001\nUIViewControllerTransitioningDelegate\u3092\u7d99\u627f\u3057\u305f\u30af\u30e9\u30b9\u3067\u3001\u5404\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3068\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002\n\n\u3042\u3068\u306f\u3001\u753b\u9762\u9077\u79fb\u6642\u306b\u3001transitioningDelegate\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u306b\u4e0a\u8a18\u306e\u30af\u30e9\u30b9\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\n## \u53c2\u8003\nhttp://zappdesigntemplates.com/create-custom-uicollectionviewcell-transition/\n", "tags": ["Swift", "iOS", "UIKit"]}