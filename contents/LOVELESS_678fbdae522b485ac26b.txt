{"context": "\n\n\u958b\u767a\u74b0\u5883\nUbuntu Server 16.04 LTS\nCakePHP 2.8.5\n\n\u6982\u8981\n\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u305b\u305f\u5f8c\u3001\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u30b3\u30fc\u30c9\u3092\u4f7f\u3044\u56de\u3057\u305f\u3044\u305f\u3081\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u5316\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u5185\u3067\u306f $this->response \u304c\u4f7f\u7528\u3067\u304d\u306a\u3044\u305f\u3081\u5f15\u6570\u3067\u6e21\u3057\u3066\u3044\u307e\u3059\u3002\n$this->response->file() \u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u305f\u5f8c\u306f\u51e6\u7406\u304c\u7d42\u4e86\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067 $response->send(); \u3092\u631f\u3080\u3068\u51e6\u7406\u304c\u7d99\u7d9a\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u306b unlink(); \u3059\u308c\u3070\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u304c\u524a\u9664\u3055\u308c\u307e\u3059\u3002\u305f\u3060\u3057\u3053\u306e\u307e\u307e\u3060\u3068 view \u3082\u4e00\u7dd2\u306b\u51fa\u529b\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u95a2\u6570\u5185\u3067\u51e6\u7406\u304c\u7d42\u4e86\u3055\u308c\u308b\u3088\u3046 exit(); \u3057\u307e\u3059\u3002\n\n// myController.php\npublic $components = array('Hoge');\npublic function proc() {\n    $this->download('\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u540d', '\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u540d', $this->response)\n}\n\n// Component/HogeComponent.php\npublic function download($tmp_name, $download_name, $response) {\n    $response->type('text/plain');\n    $response->file($tmp_name, array(\n        'name' => $download_name,\n        'download' => true\n    ));\n    $response->send();\n    unlink($tmp_name);\n    exit();\n}\n\n#\u958b\u767a\u74b0\u5883\nUbuntu Server 16.04 LTS\nCakePHP 2.8.5\n\n#\u6982\u8981\n\u30ea\u30af\u30a8\u30b9\u30c8\u306b\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u305b\u305f\u5f8c\u3001\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u30b3\u30fc\u30c9\u3092\u4f7f\u3044\u56de\u3057\u305f\u3044\u305f\u3081\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u5316\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u5185\u3067\u306f `$this->response` \u304c\u4f7f\u7528\u3067\u304d\u306a\u3044\u305f\u3081\u5f15\u6570\u3067\u6e21\u3057\u3066\u3044\u307e\u3059\u3002\n`$this->response->file()` \u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3055\u308c\u305f\u5f8c\u306f\u51e6\u7406\u304c\u7d42\u4e86\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067 `$response->send();` \u3092\u631f\u3080\u3068\u51e6\u7406\u304c\u7d99\u7d9a\u3057\u307e\u3059\u3002\u305d\u306e\u5f8c\u306b `unlink();` \u3059\u308c\u3070\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u304c\u524a\u9664\u3055\u308c\u307e\u3059\u3002\u305f\u3060\u3057\u3053\u306e\u307e\u307e\u3060\u3068 view \u3082\u4e00\u7dd2\u306b\u51fa\u529b\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u95a2\u6570\u5185\u3067\u51e6\u7406\u304c\u7d42\u4e86\u3055\u308c\u308b\u3088\u3046 `exit();` \u3057\u307e\u3059\u3002\n\n```php\n\n// myController.php\npublic $components = array('Hoge');\npublic function proc() {\n\t$this->download('\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u540d', '\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb\u540d', $this->response)\n}\n\n// Component/HogeComponent.php\npublic function download($tmp_name, $download_name, $response) {\n\t$response->type('text/plain');\n\t$response->file($tmp_name, array(\n\t\t'name' => $download_name,\n\t\t'download' => true\n\t));\n\t$response->send();\n\tunlink($tmp_name);\n\texit();\n}\n```\n", "tags": ["cakephp2"]}