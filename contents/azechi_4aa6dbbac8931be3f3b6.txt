{"context": " More than 1 year has passed since last update.Google OAuth2.0\u306e\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u306b\u306f\u6709\u52b9\u671f\u9650\u304c\u306a\u3044\u3002\n\u3069\u306e\u8a8d\u8a3c\u30d5\u30ed\u30fc\u3067\u3042\u3063\u3066\u3082\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3067\u304d\u308c\u3070\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3067\u304d\u308b\u3002\n\u53c2\u8003: Using OAuth 2.0 to Access Google APIs\n\u30c7\u30d0\u30a4\u30b9\u8a8d\u8a3c\u30d5\u30ed\u30fc\u3067\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u3002\n\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u8a8d\u8a3c\u30d5\u30ed\u30fc\u3092\u958b\u59cb\u3059\u308b\nverification_url\u3068user_code\u3092\u53d6\u5f97\u3059\u308b\u3002\n\u30d6\u30e9\u30a6\u30b6\u3067verification_url\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\u8a31\u53ef\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u627f\u8a8d\u3057\u3066user_code\u3092\u5165\u529b\u3059\u308b\u3002\n\u30b3\u30f3\u30bd\u30fc\u30eb\u3067device_code\u3092\u6307\u5b9a\u3057\u3066\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u3002\n$client_id = \"\"\n$client_secret = \"\"\n$scope = \"\"\n\n$data = Invoke-RestMethod `\n    -Uri 'https://accounts.google.com/o/oauth2/device/code' `\n    -Method Post `\n    -ContentType \"application/x-www-form-urlencoded\" `\n    -Body @{\n        client_id=$client_id;\n        scope=$scope\n    }\n\n$data.user_code\n\n# \u30d6\u30e9\u30a6\u30b6\u3092\u8d77\u52d5\nstart $data.verification_url\n\ndo\n{\n\n  Read-Host '?'\n\n  $result = Invoke-RestMethod `\n      -Uri \"https://accounts.google.com/o/oauth2/token\" `\n      -Method Post `\n      -ContentType \"application/x-www-form-urlencoded\" `\n      -Body @{\n          client_id = $client_id;\n          client_secret = $client_secret ;\n          code=$data.device_code;\n          grant_type='http://oauth.net/grant_type/device/1.0';\n      }\n\n  $result\n\n} while($result.error)\n\n# \u7d50\u679c\n$result.access_token\n$result.refresh_token\n$result.expires_in\n$result.token_type\n$result\n\n\nGoogle OAuth2.0\u306e\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u306b\u306f\u6709\u52b9\u671f\u9650\u304c\u306a\u3044\u3002\n\u3069\u306e\u8a8d\u8a3c\u30d5\u30ed\u30fc\u3067\u3042\u3063\u3066\u3082\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3067\u304d\u308c\u3070\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3067\u304d\u308b\u3002\n\n\u53c2\u8003: [Using OAuth 2.0 to Access Google APIs](https://developers.google.com/identity/protocols/OAuth2)\n\n\u30c7\u30d0\u30a4\u30b9\u8a8d\u8a3c\u30d5\u30ed\u30fc\u3067\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u3002\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u8a8d\u8a3c\u30d5\u30ed\u30fc\u3092\u958b\u59cb\u3059\u308b\n`verification_url`\u3068`user_code`\u3092\u53d6\u5f97\u3059\u308b\u3002\n\n\u30d6\u30e9\u30a6\u30b6\u3067`verification_url`\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3002\n\u8a31\u53ef\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u627f\u8a8d\u3057\u3066`user_code`\u3092\u5165\u529b\u3059\u308b\u3002\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u3067`device_code`\u3092\u6307\u5b9a\u3057\u3066\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\u3002\n\n```ps1\n$client_id = \"\"\n$client_secret = \"\"\n$scope = \"\"\n\n$data = Invoke-RestMethod `\n    -Uri 'https://accounts.google.com/o/oauth2/device/code' `\n    -Method Post `\n    -ContentType \"application/x-www-form-urlencoded\" `\n    -Body @{\n        client_id=$client_id;\n        scope=$scope\n    }\n\n$data.user_code\n\n# \u30d6\u30e9\u30a6\u30b6\u3092\u8d77\u52d5\nstart $data.verification_url\n\ndo\n{\n\n  Read-Host '?'\n\n  $result = Invoke-RestMethod `\n      -Uri \"https://accounts.google.com/o/oauth2/token\" `\n      -Method Post `\n      -ContentType \"application/x-www-form-urlencoded\" `\n      -Body @{\n          client_id = $client_id;\n          client_secret = $client_secret ;\n          code=$data.device_code;\n          grant_type='http://oauth.net/grant_type/device/1.0';\n      }\n\n  $result\n\n} while($result.error)\n\n# \u7d50\u679c\n$result.access_token\n$result.refresh_token\n$result.expires_in\n$result.token_type\n$result\n\n```\n", "tags": ["OAuth2.0", "googleapi", "PowerShell"]}