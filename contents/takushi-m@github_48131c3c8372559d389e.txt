{"context": " More than 1 year has passed since last update.\n\nPRML\u5b9f\u88c5\u3000\u7b2c3\u7ae0 \u7dda\u5f62\u57fa\u5e95\u95a2\u6570\u30e2\u30c7\u30eb\n\u6700\u5c24\u63a8\u5b9a\u89e3\u3092\u6c42\u3081\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\nscript.py\nimport numpy as np\nfrom numpy.linalg import inv\nimport matplotlib.pyplot as plt\n\nM = 10 # \u30e2\u30c7\u30eb\u306e\u8907\u96d1\u3055\nN = 20 # \u30c7\u30fc\u30bf\u6570\nL = 10 # \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u6570\n\nary_mu = np.linspace(0,1,M)\n\ndef phi(ary_mu, x):\n    ret = np.array([np.exp(-(x-mu)**2/(2*0.1**2)) for mu in ary_mu])\n    ret[0] = 1\n    return ret\n\nfor x in range(L):\n    x_train = np.linspace(0,1,N)\n    y_train = np.sin(2*np.pi*x_train) + np.random.normal(0,0.3,N)\n\n    # \u8a08\u753b\u884c\u5217(3.16\u5f0f)\u306e\u8a08\u7b97\n    PHI = np.array([phi(ary_mu,x) for x in x_train]).reshape(N,M)\n\n    # \u6700\u5c24\u63a8\u5b9a\u89e3(3.15\u5f0f)\u306e\u8a08\u7b97\n    w_ml = inv(PHI.transpose().dot(PHI)).dot(PHI.transpose()).dot(y_train)\n    # \u6b63\u5247\u5316\u3059\u308b\u5834\u5408\u306f\u4e0b\u3092\u4f7f\u3046\n    # l = 0.3\n    # w_ml = inv(l*np.identity(M)+PHI.transpose().dot(PHI)).dot(PHI.transpose()).dot(y_train)\n\n    xx = np.linspace(0,1,100)\n    y = [phi(ary_mu,x).dot(w_ml) for x in xx]\n\n    plt.plot(xx,y)\n\nplt.show()\n\n\n sin(2*\\pi*x) + N(0,0.3)\n\n\u3067\u30c7\u30fc\u30bf\u751f\u6210\u3092\u884c\u3044\u3001\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u6bce\u306e\u7d50\u679c\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u6b63\u5247\u5316\u3092\u884c\u308f\u306a\u3044\u5834\u5408\n\n\u6b63\u5247\u5316\u3092\u884c\u3063\u305f\u5834\u5408\n\n\u3067\u3059\u3002\u306a\u3093\u3068\u306a\u304f\u6b63\u5247\u5316\u306e\u52b9\u679c\u304c\u51fa\u3066\u3044\u307e\u3059\u3002\n# PRML\u5b9f\u88c5\u3000\u7b2c3\u7ae0 \u7dda\u5f62\u57fa\u5e95\u95a2\u6570\u30e2\u30c7\u30eb\n\u6700\u5c24\u63a8\u5b9a\u89e3\u3092\u6c42\u3081\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\n```lang:script.py\nimport numpy as np\nfrom numpy.linalg import inv\nimport matplotlib.pyplot as plt\n\nM = 10 # \u30e2\u30c7\u30eb\u306e\u8907\u96d1\u3055\nN = 20 # \u30c7\u30fc\u30bf\u6570\nL = 10 # \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u6570\n\nary_mu = np.linspace(0,1,M)\n\ndef phi(ary_mu, x):\n    ret = np.array([np.exp(-(x-mu)**2/(2*0.1**2)) for mu in ary_mu])\n    ret[0] = 1\n    return ret\n\nfor x in range(L):\n    x_train = np.linspace(0,1,N)\n    y_train = np.sin(2*np.pi*x_train) + np.random.normal(0,0.3,N)\n\n    # \u8a08\u753b\u884c\u5217(3.16\u5f0f)\u306e\u8a08\u7b97\n    PHI = np.array([phi(ary_mu,x) for x in x_train]).reshape(N,M)\n\n    # \u6700\u5c24\u63a8\u5b9a\u89e3(3.15\u5f0f)\u306e\u8a08\u7b97\n    w_ml = inv(PHI.transpose().dot(PHI)).dot(PHI.transpose()).dot(y_train)\n    # \u6b63\u5247\u5316\u3059\u308b\u5834\u5408\u306f\u4e0b\u3092\u4f7f\u3046\n    # l = 0.3\n    # w_ml = inv(l*np.identity(M)+PHI.transpose().dot(PHI)).dot(PHI.transpose()).dot(y_train)\n\n    xx = np.linspace(0,1,100)\n    y = [phi(ary_mu,x).dot(w_ml) for x in xx]\n\n    plt.plot(xx,y)\n\nplt.show()\n```\n\n```math\n sin(2*\\pi*x) + N(0,0.3)\n```\n\u3067\u30c7\u30fc\u30bf\u751f\u6210\u3092\u884c\u3044\u3001\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u6bce\u306e\u7d50\u679c\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u6b63\u5247\u5316\u3092\u884c\u308f\u306a\u3044\u5834\u5408\n![normal.png](https://qiita-image-store.s3.amazonaws.com/0/20986/398dddb2-8bc6-65c7-944d-f7f3392db974.png)\n\n\u6b63\u5247\u5316\u3092\u884c\u3063\u305f\u5834\u5408\n![\u6b63\u5247\u5316.png](https://qiita-image-store.s3.amazonaws.com/0/20986/5db5e734-72df-f966-f5b2-bedd7b287e32.png)\n\n\u3067\u3059\u3002\u306a\u3093\u3068\u306a\u304f\u6b63\u5247\u5316\u306e\u52b9\u679c\u304c\u51fa\u3066\u3044\u307e\u3059\u3002\n", "tags": ["PRML", "\u6a5f\u68b0\u5b66\u7fd2", "Python"]}