{"context": " More than 1 year has passed since last update.MA\u306b\u5411\u3051\u3066Twilio\u3068\u697d\u5929\u30c8\u30e9\u30d9\u30eb\u7a7a\u5ba4\u691c\u7d22API\u3092\u4f7f\u3063\u3066\u30a2\u30d7\u30ea\u3092\u4f5c\u308a\u305f\u3044(http://qiita.com/fumishitan/items/6b9944ed9d4daec6a3a8)\n\u306e\uff15\u56de\u76ee\n\u3053\u3053\u307e\u3067\u3067\u3001\u4e0b\u8a18\u306e\u3053\u3068\u304c\u3067\u304d\u305f\u3002\n\u30fb\u30db\u30c6\u30eb\u306e\u7a7a\u5ba4\u3092\u691c\u7d22\u3057\u4e00\u89a7\u3067\u53d6\u5f97\u30fb\u8868\u793a\u3059\u308b\u3002\n\u30fbmonaca\u3067\u73fe\u5728\u5730\u306e\u4e00\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\u30fb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bbf\u6cca\u5c65\u6b74\u3092\u66f4\u65b0\u3059\u308b\u30fb\u5bbf\u6cca\u304c\u6570\u591a\u3059\u304e\u305f\u3089\u30a2\u30e9\u30fc\u30c8\u3092\u4e0a\u3052\u308b\n\u4e0a\u8a18\u306e\u5404\u9805\u76ee\u306e\u307e\u3068\u3081\u3068\u3057\u3066\u4f55\u3092\u3084\u3063\u305f\u304b\u3092\u66f8\u3044\u3066\u3044\u304f\n\n\u30db\u30c6\u30eb\u306e\u7a7a\u5ba4\u3092\u691c\u7d22\u3057\u4e00\u89a7\u3067\u53d6\u5f97\u30fb\u8868\u793a\u3059\u308b\n\u30db\u30c6\u30eb\u7a7a\u5ba4\u60c5\u5831\u53d6\u5f97\u30fb\u8868\u793a\u306e\u305f\u3081\u4ee5\u4e0b\u306e\u3053\u3068\u3092\u884c\u3063\u305f\n\u30fb\u697d\u5929WebService\u3067\u306e\u30a2\u30d7\u30eaID\u306e\u767a\u884c\n\u30fb\u697d\u5929\u30c8\u30e9\u30d9\u30eb\u7a7a\u5ba4\u691c\u7d22API\u3092\u53e9\u3044\u3066\u30fb\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u51e6\u7406\u3059\u308b\uff08\u8a73\u7d30\u306f\u4e0b\u8a18\uff09\n\u3000\u30fbhttp://qiita.com/fumishitan/items/8e576184315d275a2d52\n\u203bmonaca\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u5c11\u3057\u5909\u66f4\u3059\u308c\u3070Web\u3067\u3082\u4f7f\u3048\u307e\u3059\n\nmonaca\u3067\u73fe\u5728\u5730\u306e\u4e00\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\nmonaca\u3067\u73fe\u5728\u5730\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3053\u3068\u3092\u884c\u3063\u305f\u3002\n\u30fbmonaca\u306e\u65b0\u898f\u767b\u9332\n\u3000\u30fbhttps://ja.monaca.io/\n\u30fb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210(\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\uff1aToDo App)\n\u30fb\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u30ed\u30b8\u30c3\u30af\u3092\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\uff08\u8a73\u7d30\u306f\u4e0b\u8a18\uff09\n\u3000\u30fbhttp://qiita.com/fumishitan/items/6bee754bf31cf77e0afe\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bbf\u6cca\u5c65\u6b74\u3092\u66f4\u65b0\u3059\u308b\u30fb\u5bbf\u6cca\u304c\u6570\u591a\u3059\u304e\u305f\u3089\u30a2\u30e9\u30fc\u30c8\u3092\u4e0a\u3052\u308b\n\u4eca\u56de\u306f\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9mobile backend(mBaaS)\u306e\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u3057\u3066\u5229\u7528\u3057\u305f\n\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u3000mobile backend\nhttp://mb.cloud.nifty.com/about.htm\n\u884c\u3063\u305f\u3053\u3068\u306f\u4ee5\u4e0b\n\u30fb\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\n\u30fbSDK\u306eDL\u30fbmonaca www>js\u30d5\u30a9\u30eb\u30c0\u3078\u306e\u914d\u7f6e\n\u3000\u3000\u30fbhttp://mb.cloud.nifty.com/doc/current/introduction/quickstart_javascript.html#/JavaScript/\n\u30fb\u30a2\u30d7\u30ea\u306e\u4f5c\u6210\u30fb\u30ad\u30fc\u306e\u53d6\u5f97\n\u30fbSDK\u306e\u521d\u671f\u5316\n\u30fb\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0(\u8a73\u7d30\u306f\u4e0b\u8a18)\n\u3000\u30fbhttp://qiita.com/fumishitan/items/747582a3120a0be2da39\n\u30fb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u691c\u7d22\u3057\u3001\u5bbf\u6cca\u6570\u3092\u6570\u3048\u308b\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0(\u8a73\u7d30\u306f\u4e0b\u8a18)\n\u3000\u30fbhttp://qiita.com/fumishitan/items/1975fd9f0ef99fc590d8\n\n\u4e0a\u8a18\u306e\u4e00\u9023\u306e\u4f5c\u696d\u3092\u307e\u3068\u3081\u305f\u7d50\u679c\nmonaca\u3067TODO App\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3092index.html\u306b\u8cbc\u308a\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\n\nindex.html\n<!DOCTYPE HTML>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no\">\n    <script src=\"components/loader.js\"></script>\n    <link rel=\"stylesheet\" href=\"components/loader.css\">\n    <link rel=\"stylesheet\" href=\"css/styles.css\">\n    <script src=\"js/ncmb-latest.min.js\"></script>\n    <script src=\"js/cssua.min.js\"></script>\n    <script src=\"js/app.js\"></script>\n\n</head>\n<body>\n    <div data-role=\"page\" id=\"list-page\">\n        <div data-role=\"header\" data-position=\"fixed\" data-theme=\"c\">\n            <h1>Hotel\u3092\u63a2\u305d\u3046\uff01</h1>\n            <input id=\"search-button\" type=\"button\" value=\"Search\" onclick=\"rakutenTravelApi()\">\n        </div>\n        <div data-role=\"content\">\n            <ul data-role=\"listview\" data-inset=\"true\" id=\"hotel-list\"></ul>\n        </div>\n    </div>\n</body>\n</html>\n\n\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3092app.js\u306b\u8cbc\u308a\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\u3002\n\napp.js\n\nvar xhr = new XMLHttpRequest();\nvar current;\nvar YOUR_APP_KEY = \"YOUR_APP_KEY\";\nvar YOUR_CLIENT_KEY = \"YOUR_CLIENT_KEY\";\n\n$(function(){\n    //\u8d77\u52d5\u6642\u306bmobile backend API\u30ad\u30fc\u3092\u8a2d\u5b9a\n    NCMB.initialize(YOUR_APP_KEY,YOUR_CLIENT_KEY);\n});\n\nfunction rakutenTravelApi(){\n\n    navigator.geolocation.getCurrentPosition(onSuccess, onError, option);\n    var lat = current.geopoint.latitude;\n    var lng = current.geopoint.longitude;\n\n    var rakutentravelApi = \"https://app.rakuten.co.jp/services/api/Travel/VacantHotelSearch/20131024\";\n    var rakutentravelKey =\"*************\";\n    var RANGE = 3;\n    var datumType = 1;\n    var checkInDate = new Date();\n    var checkOutDate = checkInDate;\n\n    checkOutDate.setDate(checkOutDate.getDate() + 1);\n    var queri = rakutentravelApi + \"?applicationId=\" + rakutentravelKey + \"&checkinDate=\" + checkInDate.toISOString().substring(0,10) + \"&checkoutDate=\" + checkOutDate.toISOString().substring(0,10) + \"&latitude=\" + lat + \"&longitude=\" + lng + \"&searchRadius=\" + RANGE + \"&datumType=\" + datumType;\n    console.log(queri);\n    // XMLHttpRequest \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n   xhr.open(\"GET\",queri,true);\n   xhr.onreadystatechange = processResponse;\n   xhr.send();\n}\n\n//\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u306b\u6210\u529f\u3057\u305f\u5834\u5408\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\nvar onSuccess = function(position){\n    current = new CurrentPoint();\n    current.distance = CurrentPoint.distance;   //\u691c\u7d22\u7bc4\u56f2\u306e\u534a\u5f84\u3092\u4fdd\u6301\u3059\u308b    \n    current.geopoint = position.coords;         //\u4f4d\u7f6e\u60c5\u5831\u3092\u4fdd\u5b58\u3059\u308b\n    //search(current);\n};\n\n//\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\nvar onError = function(error){\n    console.log(\"\u73fe\u5728\u4f4d\u7f6e\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\");\n};\n\n//\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u6642\u306b\u8a2d\u5b9a\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\nvar option = {\n    timeout: 6000   //\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u5024(\u30df\u30ea\u79d2)\n};\n\n//\u73fe\u5728\u5730\u3092\u4fdd\u6301\u3059\u308b\u30af\u30e9\u30b9\u3092\u4f5c\u6210\nfunction CurrentPoint(){\n    geopoint=null;  //\u7aef\u672b\u306e\u4f4d\u7f6e\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\n    distance=0;     //\u4f4d\u7f6e\u60c5\u5831\u691c\u7d22\u306b\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u691c\u7d22\u8ddd\u96e2\u3092\u6307\u5b9a\u3059\u308b\n}\n\nfunction processResponse() {\n    if(xhr.readyState == 4) {\n        if(xhr.status == 200 || xhr.status == 201) {\n            // \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u51e6\u7406\n            var rakutentravel = JSON.parse(xhr.responseText);\n             for(var i in rakutentravel.hotels){\n                var hotelName = JSON.stringify(rakutentravel.hotels[i].hotel[0].hotelBasicInfo[\"hotelName\"]);\n                var hotelInfoUrl = JSON.stringify(rakutentravel.hotels[i].hotel[0].hotelBasicInfo[\"hotelInformationUrl\"]);\n                var clickInput = \"search-button\" + i;\n                $(\"#hotel-list\").append(\"<li>\" + \"<p><h3>\" + hotelName + \"</h3><h4>\" + hotelInfoUrl + \"</h4>\"); \n\n                //$(\"#hotel-list\").append(\"<p>\" );\n                $(\"#hotel-list\").append(\"<h4>\"+ \"<input id=\" + clickInput + \" \" + \"type=\" + \"'button'\" + \"value=\" + \"'reserve'\" +\"></h4>\");\n\n                clickInput = \"#\" + clickInput ;\n                $(clickInput).click({name : hotelName,url : hotelInfoUrl},reserve);\n\n                $(\"#hotel-list\").append(\"</p>\" );\n                $(\"#hotel-list\").append(\"</li>\" );\n                $(\"#hotel-list\").listview('refresh');\n\n            }\n\n        } else {\n            // \u30a8\u30e9\u30fc\u51e6\u7406\n\n        }\n    }\n}\n\nfunction reserve(event){\n    var today = new Date();\n    var beforeOneWeek = new Date();\n    var HotelClass = NCMB.Object.extend(\"ReserveHotel\");\n    var query = new NCMB.Query(HotelClass);\n    beforeOneWeek.setDate(beforeOneWeek.getDate() - 7);\n    query.greaterThan(\"Date\", beforeOneWeek.toISOString());\n    query.count({\n        success: function(number) {\n            if(number > 1){\n                navigator.notification.alert(\"\u3057\u3063\u304b\u308a\u4f11\u307f\",alertDismissed , \"\u4eca\u9031\u3082\u3046\uff13\u65e5\u76ee\u3084\u3067\" , \"\u6c17\u3092\u3064\u3051\u307e\u3059\");\n            }\n        },\n\n        error: function(error) {\n            navigator.notification.alert(\"\u5931\u6557\",alertDismissed , \"\u5931\u6557\" , \"\u4e86\u89e3\");\n        }\n    });\n\n  //\u3069\u306e\u30af\u30e9\u30b9 (\u30c6\u30fc\u30d6\u30eb\u306e\u3088\u3046\u306a\u30a4\u30e1\u30fc\u30b8\u3068\u601d\u3063\u3066\u304f\u3060\u3055\u3044)\u306b\u30c7\u30fc\u30bf\u3092\u5165\u308c\u308b\u304b\u6307\u5b9a\u3059\u308b\n    var ReserveHotelClass = NCMB.Object.extend(\"ReserveHotel\");\n    var reserveHotelClass = new ReserveHotelClass();\n  //HotelName\u30ab\u30e9\u30e0\u3092\u6307\u5b9a\u3057\u30db\u30c6\u30eb\u306e\u540d\u524d\u3092\u6307\u5b9a\u3059\u308b\n    reserveHotelClass.set(\"HotelName\", event.data.name);\n  //HotelUrl\u30ab\u30e9\u30e0\u3092\u6307\u5b9a\u3057\u30db\u30c6\u30eb\u306eURL\u3092\u6307\u5b9a\u3059\u308b\n    reserveHotelClass.set(\"HotelUrl\", event.data.url);\n  //Date\u30ab\u30e9\u30e0\u3092\u6307\u5b9a\u3057\u30db\u30c6\u30eb\u306e\u65e5\u4ed8\u3092\u6307\u5b9a\u3059\u308b\n    reserveHotelClass.set(\"Date\", today.toISOString());\n   //\u975e\u540c\u671f\u3067\u30c7\u30fc\u30bf\u3092\u66f4\u65b0\u3059\u308b\n   reserveHotelClass.save(null, {\n        success: function(object) {\n            // \u4fdd\u5b58\u5b8c\u4e86\u5f8c\u306b\u5b9f\u884c\u3055\u308c\u308b\n\n        },\n        error: function(object, error) {\n            // \u30a8\u30e9\u30fc\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\n        }\n    });\n}\n\nfunction alertDismissed() {\n        // \u4efb\u610f\u306e\u30b3\u30fc\u30c9\n}\n\n\n\nMA\u306b\u5411\u3051\u3066Twilio\u3068\u697d\u5929\u30c8\u30e9\u30d9\u30eb\u7a7a\u5ba4\u691c\u7d22API\u3092\u4f7f\u3063\u3066\u30a2\u30d7\u30ea\u3092\u4f5c\u308a\u305f\u3044(http://qiita.com/fumishitan/items/6b9944ed9d4daec6a3a8)\n\u306e\uff15\u56de\u76ee\n\u3053\u3053\u307e\u3067\u3067\u3001\u4e0b\u8a18\u306e\u3053\u3068\u304c\u3067\u304d\u305f\u3002\n\n\u30fb\u30db\u30c6\u30eb\u306e\u7a7a\u5ba4\u3092\u691c\u7d22\u3057\u4e00\u89a7\u3067\u53d6\u5f97\u30fb\u8868\u793a\u3059\u308b\u3002\n\u30fbmonaca\u3067\u73fe\u5728\u5730\u306e\u4e00\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\u30fb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bbf\u6cca\u5c65\u6b74\u3092\u66f4\u65b0\u3059\u308b\u30fb\u5bbf\u6cca\u304c\u6570\u591a\u3059\u304e\u305f\u3089\u30a2\u30e9\u30fc\u30c8\u3092\u4e0a\u3052\u308b\n\n\u4e0a\u8a18\u306e\u5404\u9805\u76ee\u306e\u307e\u3068\u3081\u3068\u3057\u3066\u4f55\u3092\u3084\u3063\u305f\u304b\u3092\u66f8\u3044\u3066\u3044\u304f\n\n## \u30db\u30c6\u30eb\u306e\u7a7a\u5ba4\u3092\u691c\u7d22\u3057\u4e00\u89a7\u3067\u53d6\u5f97\u30fb\u8868\u793a\u3059\u308b\n\n\u30db\u30c6\u30eb\u7a7a\u5ba4\u60c5\u5831\u53d6\u5f97\u30fb\u8868\u793a\u306e\u305f\u3081\u4ee5\u4e0b\u306e\u3053\u3068\u3092\u884c\u3063\u305f\n\n\u30fb\u697d\u5929WebService\u3067\u306e\u30a2\u30d7\u30eaID\u306e\u767a\u884c\n\u30fb\u697d\u5929\u30c8\u30e9\u30d9\u30eb\u7a7a\u5ba4\u691c\u7d22API\u3092\u53e9\u3044\u3066\u30fb\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u51e6\u7406\u3059\u308b\uff08\u8a73\u7d30\u306f\u4e0b\u8a18\uff09\n\u3000\u30fbhttp://qiita.com/fumishitan/items/8e576184315d275a2d52\n\u203bmonaca\u3092\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u5c11\u3057\u5909\u66f4\u3059\u308c\u3070Web\u3067\u3082\u4f7f\u3048\u307e\u3059\n\n## monaca\u3067\u73fe\u5728\u5730\u306e\u4e00\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\n\nmonaca\u3067\u73fe\u5728\u5730\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3053\u3068\u3092\u884c\u3063\u305f\u3002\n\u30fbmonaca\u306e\u65b0\u898f\u767b\u9332\n\u3000\u30fbhttps://ja.monaca.io/\n\u30fb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210(\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\uff1aToDo App)\n\u30fb\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u30ed\u30b8\u30c3\u30af\u3092\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\uff08\u8a73\u7d30\u306f\u4e0b\u8a18\uff09\n\u3000\u30fbhttp://qiita.com/fumishitan/items/6bee754bf31cf77e0afe\n\n## \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bbf\u6cca\u5c65\u6b74\u3092\u66f4\u65b0\u3059\u308b\u30fb\u5bbf\u6cca\u304c\u6570\u591a\u3059\u304e\u305f\u3089\u30a2\u30e9\u30fc\u30c8\u3092\u4e0a\u3052\u308b\n\n\u4eca\u56de\u306f\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9mobile backend(mBaaS)\u306e\u30c7\u30fc\u30bf\u30b9\u30c8\u30a2\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u3057\u3066\u5229\u7528\u3057\u305f\n\u30cb\u30d5\u30c6\u30a3\u30af\u30e9\u30a6\u30c9\u3000mobile backend\nhttp://mb.cloud.nifty.com/about.htm\n\n\u884c\u3063\u305f\u3053\u3068\u306f\u4ee5\u4e0b\n\u30fb\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u4f5c\u6210\n\u30fbSDK\u306eDL\u30fbmonaca www>js\u30d5\u30a9\u30eb\u30c0\u3078\u306e\u914d\u7f6e\n\u3000\u3000\u30fbhttp://mb.cloud.nifty.com/doc/current/introduction/quickstart_javascript.html#/JavaScript/\n\u30fb\u30a2\u30d7\u30ea\u306e\u4f5c\u6210\u30fb\u30ad\u30fc\u306e\u53d6\u5f97\n\u30fbSDK\u306e\u521d\u671f\u5316\n\u30fb\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0(\u8a73\u7d30\u306f\u4e0b\u8a18)\n\u3000\u30fbhttp://qiita.com/fumishitan/items/747582a3120a0be2da39\n\u30fb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u691c\u7d22\u3057\u3001\u5bbf\u6cca\u6570\u3092\u6570\u3048\u308b\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0(\u8a73\u7d30\u306f\u4e0b\u8a18)\n\u3000\u30fbhttp://qiita.com/fumishitan/items/1975fd9f0ef99fc590d8\n\n## \u4e0a\u8a18\u306e\u4e00\u9023\u306e\u4f5c\u696d\u3092\u307e\u3068\u3081\u305f\u7d50\u679c\n\nmonaca\u3067TODO App\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3092index.html\u306b\u8cbc\u308a\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\n\n``` HTML:index.html\n<!DOCTYPE HTML>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no\">\n    <script src=\"components/loader.js\"></script>\n    <link rel=\"stylesheet\" href=\"components/loader.css\">\n    <link rel=\"stylesheet\" href=\"css/styles.css\">\n    <script src=\"js/ncmb-latest.min.js\"></script>\n    <script src=\"js/cssua.min.js\"></script>\n    <script src=\"js/app.js\"></script>\n    \n</head>\n<body>\n    <div data-role=\"page\" id=\"list-page\">\n        <div data-role=\"header\" data-position=\"fixed\" data-theme=\"c\">\n            <h1>Hotel\u3092\u63a2\u305d\u3046\uff01</h1>\n            <input id=\"search-button\" type=\"button\" value=\"Search\" onclick=\"rakutenTravelApi()\">\n        </div>\n        <div data-role=\"content\">\n            <ul data-role=\"listview\" data-inset=\"true\" id=\"hotel-list\"></ul>\n        </div>\n    </div>\n</body>\n</html>\n```\n\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3092app.js\u306b\u8cbc\u308a\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044\u3002\n\n```js:app.js\n\nvar xhr = new XMLHttpRequest();\nvar current;\nvar YOUR_APP_KEY = \"YOUR_APP_KEY\";\nvar YOUR_CLIENT_KEY = \"YOUR_CLIENT_KEY\";\n\n$(function(){\n    //\u8d77\u52d5\u6642\u306bmobile backend API\u30ad\u30fc\u3092\u8a2d\u5b9a\n    NCMB.initialize(YOUR_APP_KEY,YOUR_CLIENT_KEY);\n});\n\nfunction rakutenTravelApi(){\n    \n    navigator.geolocation.getCurrentPosition(onSuccess, onError, option);\n    var lat = current.geopoint.latitude;\n    var lng = current.geopoint.longitude;\n    \n    var rakutentravelApi = \"https://app.rakuten.co.jp/services/api/Travel/VacantHotelSearch/20131024\";\n    var rakutentravelKey =\"*************\";\n    var RANGE = 3;\n    var datumType = 1;\n    var checkInDate = new Date();\n    var checkOutDate = checkInDate;\n    \n    checkOutDate.setDate(checkOutDate.getDate() + 1);\n    var queri = rakutentravelApi + \"?applicationId=\" + rakutentravelKey + \"&checkinDate=\" + checkInDate.toISOString().substring(0,10) + \"&checkoutDate=\" + checkOutDate.toISOString().substring(0,10) + \"&latitude=\" + lat + \"&longitude=\" + lng + \"&searchRadius=\" + RANGE + \"&datumType=\" + datumType;\n    console.log(queri);\n    // XMLHttpRequest \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n   xhr.open(\"GET\",queri,true);\n   xhr.onreadystatechange = processResponse;\n   xhr.send();\n}\n\n//\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u306b\u6210\u529f\u3057\u305f\u5834\u5408\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\nvar onSuccess = function(position){\n    current = new CurrentPoint();\n    current.distance = CurrentPoint.distance;   //\u691c\u7d22\u7bc4\u56f2\u306e\u534a\u5f84\u3092\u4fdd\u6301\u3059\u308b    \n    current.geopoint = position.coords;         //\u4f4d\u7f6e\u60c5\u5831\u3092\u4fdd\u5b58\u3059\u308b\n    //search(current);\n};\n\n//\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\nvar onError = function(error){\n    console.log(\"\u73fe\u5728\u4f4d\u7f6e\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\");\n};\n\n//\u4f4d\u7f6e\u60c5\u5831\u53d6\u5f97\u6642\u306b\u8a2d\u5b9a\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\nvar option = {\n    timeout: 6000   //\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u5024(\u30df\u30ea\u79d2)\n};\n\n//\u73fe\u5728\u5730\u3092\u4fdd\u6301\u3059\u308b\u30af\u30e9\u30b9\u3092\u4f5c\u6210\nfunction CurrentPoint(){\n    geopoint=null;  //\u7aef\u672b\u306e\u4f4d\u7f6e\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b\n    distance=0;     //\u4f4d\u7f6e\u60c5\u5831\u691c\u7d22\u306b\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u691c\u7d22\u8ddd\u96e2\u3092\u6307\u5b9a\u3059\u308b\n}\n\nfunction processResponse() {\n    if(xhr.readyState == 4) {\n        if(xhr.status == 200 || xhr.status == 201) {\n            // \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u51e6\u7406\n            var rakutentravel = JSON.parse(xhr.responseText);\n             for(var i in rakutentravel.hotels){\n                var hotelName = JSON.stringify(rakutentravel.hotels[i].hotel[0].hotelBasicInfo[\"hotelName\"]);\n                var hotelInfoUrl = JSON.stringify(rakutentravel.hotels[i].hotel[0].hotelBasicInfo[\"hotelInformationUrl\"]);\n                var clickInput = \"search-button\" + i;\n                $(\"#hotel-list\").append(\"<li>\" + \"<p><h3>\" + hotelName + \"</h3><h4>\" + hotelInfoUrl + \"</h4>\"); \n                \n                //$(\"#hotel-list\").append(\"<p>\" );\n                $(\"#hotel-list\").append(\"<h4>\"+ \"<input id=\" + clickInput + \" \" + \"type=\" + \"'button'\" + \"value=\" + \"'reserve'\" +\"></h4>\");\n                \n                clickInput = \"#\" + clickInput ;\n                $(clickInput).click({name : hotelName,url : hotelInfoUrl},reserve);\n             \n                $(\"#hotel-list\").append(\"</p>\" );\n                $(\"#hotel-list\").append(\"</li>\" );\n                $(\"#hotel-list\").listview('refresh');\n             \n            }\n           \n        } else {\n            // \u30a8\u30e9\u30fc\u51e6\u7406\n           \n        }\n    }\n}\n\nfunction reserve(event){\n    var today = new Date();\n    var beforeOneWeek = new Date();\n    var HotelClass = NCMB.Object.extend(\"ReserveHotel\");\n    var query = new NCMB.Query(HotelClass);\n    beforeOneWeek.setDate(beforeOneWeek.getDate() - 7);\n    query.greaterThan(\"Date\", beforeOneWeek.toISOString());\n    query.count({\n        success: function(number) {\n            if(number > 1){\n                navigator.notification.alert(\"\u3057\u3063\u304b\u308a\u4f11\u307f\",alertDismissed , \"\u4eca\u9031\u3082\u3046\uff13\u65e5\u76ee\u3084\u3067\" , \"\u6c17\u3092\u3064\u3051\u307e\u3059\");\n            }\n        },\n\n        error: function(error) {\n            navigator.notification.alert(\"\u5931\u6557\",alertDismissed , \"\u5931\u6557\" , \"\u4e86\u89e3\");\n        }\n    });\n \n  //\u3069\u306e\u30af\u30e9\u30b9 (\u30c6\u30fc\u30d6\u30eb\u306e\u3088\u3046\u306a\u30a4\u30e1\u30fc\u30b8\u3068\u601d\u3063\u3066\u304f\u3060\u3055\u3044)\u306b\u30c7\u30fc\u30bf\u3092\u5165\u308c\u308b\u304b\u6307\u5b9a\u3059\u308b\n    var ReserveHotelClass = NCMB.Object.extend(\"ReserveHotel\");\n    var reserveHotelClass = new ReserveHotelClass();\n  //HotelName\u30ab\u30e9\u30e0\u3092\u6307\u5b9a\u3057\u30db\u30c6\u30eb\u306e\u540d\u524d\u3092\u6307\u5b9a\u3059\u308b\n    reserveHotelClass.set(\"HotelName\", event.data.name);\n  //HotelUrl\u30ab\u30e9\u30e0\u3092\u6307\u5b9a\u3057\u30db\u30c6\u30eb\u306eURL\u3092\u6307\u5b9a\u3059\u308b\n    reserveHotelClass.set(\"HotelUrl\", event.data.url);\n  //Date\u30ab\u30e9\u30e0\u3092\u6307\u5b9a\u3057\u30db\u30c6\u30eb\u306e\u65e5\u4ed8\u3092\u6307\u5b9a\u3059\u308b\n    reserveHotelClass.set(\"Date\", today.toISOString());\n   //\u975e\u540c\u671f\u3067\u30c7\u30fc\u30bf\u3092\u66f4\u65b0\u3059\u308b\n   reserveHotelClass.save(null, {\n        success: function(object) {\n            // \u4fdd\u5b58\u5b8c\u4e86\u5f8c\u306b\u5b9f\u884c\u3055\u308c\u308b\n\n        },\n        error: function(object, error) {\n            // \u30a8\u30e9\u30fc\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\n        }\n    });\n}\n\nfunction alertDismissed() {\n        // \u4efb\u610f\u306e\u30b3\u30fc\u30c9\n}\n\n```\n", "tags": ["\u697d\u5929API", "js", "NCMB", "mashupaward", "monaca"]}