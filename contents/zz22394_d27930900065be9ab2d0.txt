{"context": "\n\n1. \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n1.1 \u53c2\u8003\u8a18\u4e8b\n\nAWS SDK for PHP\uff08\u30d0\u30fc\u30b8\u30e7\u30f33\uff09\u3092\u4f7f\u3063\u3066\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30fb\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\nS3\u516c\u5f0fDoc Install SDK\nhttp://docs.aws.amazon.com/aws-sdk-php/v3/guide/getting-started/installation.html\nS3\u516c\u5f0fDoc Upload\n\n\n1.2\u3000\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncurl -sS https://getcomposer.org/installer | php\n\nV2 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\uff1a\ncomposer.json\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\n\ncomposer.json\n{\n    \"require\": {\n        \"aws/aws-sdk-php\": \"2.*\"\n    }\n}\n\n\nV3 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nphp composer.phar require aws/aws-sdk-php\n\n\n2. \u63a5\u7d9a\n\n2.1 AWS Credential file\n\n~/.aws/credentials\n[default]\naws_access_key_id=AKIAIOSFODNN7EXAMPLE\naws_secret_access_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\nregion=us-east-1\n\n[test-user]\naws_access_key_id=AKIAI44QH8DHBEXAMPLE\naws_secret_access_key=je7MtGbClwBF/2Zp9Utk/h3yCo8nvbEXAMPLEKEY\nregion=us-west-2\n\n\n\n2.2 \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\nmy_config.json\n{\n    \"includes\": [\"_aws\"],\n    \"services\": {\n        \"default_settings\": {\n            \"params\": {\n                \"profile\": \"test-user\",\n                \"region\": \"us-east-1\"\n            }\n        }\n    }\n}\n\n\n\n2.3 uploader.php PHP\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\nuploader_v2.php\n<?php\n\nrequire '/Users/zeng/s3upload/vendor/autoload.php';\nuse Aws\\Common\\Aws;\n\n\n$aws = Aws::factory('./my_config.json');\n\n$client = $aws->get('S3');\n\n\n$result = $client->listBuckets();\n\nforeach ($result['Buckets'] as $bucket) {\n    // Each Bucket value will contain a Name and CreationDate\n    echo \"{$bucket['Name']} - {$bucket['CreationDate']}\\n\";\n}\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30ebKey\u306e\u610f\u5473\uff1a\nhttp://docs.aws.amazon.com/aws-sdk-php/v3/guide/guide/configuration.html#profile\n\nuploader_v3.php\n<?php\n\nrequire '/Users/*****/s3upload/vendor/autoload.php';\n\ndate_default_timezone_set(\"Asia/Tokyo\");\n\n// Use the us-west-2 region and latest version of each client.\n$sharedConfig = [\n    'profile'  => 'test-user',\n    'region'  => 'us-west-1',\n    'version' => 'latest'\n];\n\n\n// Create an SDK class used to share configuration across clients.\n$sdk = new Aws\\Sdk($sharedConfig);\n\n// Create an Amazon S3 client using the shared configuration data.\n$client = $sdk->createS3();\n\n\n$result = $client->listBuckets();\n\nforeach ($result['Buckets'] as $bucket) {\n    // Each Bucket value will contain a Name and CreationDate\n    echo \"{$bucket['Name']} - {$bucket['CreationDate']}\\n\";\n}\n\n\n\n\n\n3. List Bucket\u5b9f\u884c\u7d50\u679c\n/usr/bin/php /Users/zeng/s3upload/uploader.php\ns-web - 2017-02-08T06:21:18.000Z\ns**** - 2016-04-26T06:31:00.000Z\nProcess finished with exit code 0\n\n\n4. Upload File to S3\n\u53c2\u8003\u8cc7\u6599\nhttp://docs.aws.amazon.com/ja_jp/AmazonS3/latest/dev/UploadObjSingleOpPHP.html\n\n# http://docs.aws.amazon.com/ja_jp/AmazonS3/latest/dev/UploadObjSingleOpPHP.html\n# File upload\n// Upload a file.\n$result = $client->putObject(array(\n    'Bucket'       => \"******\",\n    'Key'          => \"test01/s3upload/test01.jpg\",\n    'SourceFile'   => \"/Users/******/IMG_1583.JPG\",\n    'ACL'          => 'public-read',\n    'Metadata'     => array(\n        'param1' => 'value 1',\n        'param2' => 'value 2'\n    )\n));\n\necho $result['ObjectURL'];\n\n\u51fa\u529b\u7d50\u679c\uff1a\nhttps://s3-ap-northeast-1.amazonaws.com/******/test01/s3upload/test01.jpg\n\n# 1. \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n## 1.1 \u53c2\u8003\u8a18\u4e8b\n* [AWS SDK for PHP\uff08\u30d0\u30fc\u30b8\u30e7\u30f33\uff09\u3092\u4f7f\u3063\u3066\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30fb\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b](https://remotestance.com/blog/3044/)\n* [S3\u516c\u5f0fDoc Install SDK](http://docs.aws.amazon.com/aws-sdk-php/v2/guide/installation.html)\n* http://docs.aws.amazon.com/aws-sdk-php/v3/guide/getting-started/installation.html\n* [S3\u516c\u5f0fDoc Upload](http://docs.aws.amazon.com/aws-sdk-php/v2/guide/service-s3.html)\n\n## 1.2\u3000\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```shell\ncurl -sS https://getcomposer.org/installer | php\n``` \n\nV2 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\uff1a\ncomposer.json\u30d5\u30a1\u30a4\u30eb\u3092\u65b0\u898f\u4f5c\u6210\n\n```composer.json\n{\n    \"require\": {\n        \"aws/aws-sdk-php\": \"2.*\"\n    }\n}\n```\n\nV3 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```cli\nphp composer.phar require aws/aws-sdk-php\n```\n\n\n# 2. \u63a5\u7d9a\n## 2.1 AWS Credential file\n```~/.aws/credentials\n[default]\naws_access_key_id=AKIAIOSFODNN7EXAMPLE\naws_secret_access_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\nregion=us-east-1\n\n[test-user]\naws_access_key_id=AKIAI44QH8DHBEXAMPLE\naws_secret_access_key=je7MtGbClwBF/2Zp9Utk/h3yCo8nvbEXAMPLEKEY\nregion=us-west-2\n```\n## 2.2 \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n```my_config.json\n{\n    \"includes\": [\"_aws\"],\n    \"services\": {\n        \"default_settings\": {\n            \"params\": {\n                \"profile\": \"test-user\",\n                \"region\": \"us-east-1\"\n            }\n        }\n    }\n}\n```\n\n## 2.3 uploader.php PHP\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n```uploader_v2.php\n<?php\n\nrequire '/Users/zeng/s3upload/vendor/autoload.php';\nuse Aws\\Common\\Aws;\n\n\n$aws = Aws::factory('./my_config.json');\n\n$client = $aws->get('S3');\n\n\n$result = $client->listBuckets();\n\nforeach ($result['Buckets'] as $bucket) {\n    // Each Bucket value will contain a Name and CreationDate\n    echo \"{$bucket['Name']} - {$bucket['CreationDate']}\\n\";\n}\n\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30ebKey\u306e\u610f\u5473\uff1a\nhttp://docs.aws.amazon.com/aws-sdk-php/v3/guide/guide/configuration.html#profile\n\n```uploader_v3.php\n<?php\n\nrequire '/Users/*****/s3upload/vendor/autoload.php';\n\ndate_default_timezone_set(\"Asia/Tokyo\");\n\n// Use the us-west-2 region and latest version of each client.\n$sharedConfig = [\n    'profile'  => 'test-user',\n    'region'  => 'us-west-1',\n    'version' => 'latest'\n];\n\n\n// Create an SDK class used to share configuration across clients.\n$sdk = new Aws\\Sdk($sharedConfig);\n\n// Create an Amazon S3 client using the shared configuration data.\n$client = $sdk->createS3();\n\n\n$result = $client->listBuckets();\n\nforeach ($result['Buckets'] as $bucket) {\n    // Each Bucket value will contain a Name and CreationDate\n    echo \"{$bucket['Name']} - {$bucket['CreationDate']}\\n\";\n}\n\n\n```\n\n# 3. List Bucket\u5b9f\u884c\u7d50\u679c\n```INTELJ \n/usr/bin/php /Users/zeng/s3upload/uploader.php\ns-web - 2017-02-08T06:21:18.000Z\ns**** - 2016-04-26T06:31:00.000Z\nProcess finished with exit code 0\n```\n\n# 4. Upload File to S3\n\u53c2\u8003\u8cc7\u6599\nhttp://docs.aws.amazon.com/ja_jp/AmazonS3/latest/dev/UploadObjSingleOpPHP.html\n\n```upload\u51e6\u7406\n\n# http://docs.aws.amazon.com/ja_jp/AmazonS3/latest/dev/UploadObjSingleOpPHP.html\n# File upload\n// Upload a file.\n$result = $client->putObject(array(\n    'Bucket'       => \"******\",\n    'Key'          => \"test01/s3upload/test01.jpg\",\n    'SourceFile'   => \"/Users/******/IMG_1583.JPG\",\n    'ACL'          => 'public-read',\n    'Metadata'     => array(\n        'param1' => 'value 1',\n        'param2' => 'value 2'\n    )\n));\n\necho $result['ObjectURL'];\n```\n\n\n\u51fa\u529b\u7d50\u679c\uff1a\n\n```\nhttps://s3-ap-northeast-1.amazonaws.com/******/test01/s3upload/test01.jpg\n```\n", "tags": ["PHP", "5.6", "S3"]}