{"context": " More than 1 year has passed since last update.\n\n\u9805\u76ee\u3054\u3068\u306b\u5206\u5272\u3057\u3066\u5225\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\u3059\u308b\u3002\n\u25bc\u4f1a\u793e\u306e\u5165\u308a\u53e3\u306b\u8a2d\u7f6e\u3055\u308c\u305f\u30bf\u30a4\u30e0\u30ec\u30b3\u30fc\u30c0\u30fc\u3067\u306f\u3001\u62bc\u3057\u308f\u3059\u308c\u306a\u3069\u3067\u767a\u751f\u3059\u308b\u5168\u793e\u54e1\u306e\u51fa\u52e4\u4e0d\u660e\u6642\u9593\u30c7\u30fc\u30bf\u304c\u3001CSV\u30d5\u30a1\u30a4\u30eb\u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\u3053\u306e\u51fa\u52e4\u4e0d\u660e\u30c7\u30fc\u30bf\u3092\u4e8b\u696d\u90e8\u3054\u3068\u306b\u5206\u5272\u3057\u3066\u5225\u3005\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u51fa\u529b\u3059\u308b\u5834\u5408\u306e\u30de\u30af\u30ed\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n\u4e0a\u306e\u30c7\u30fc\u30bf\u3092\u4e8b\u696d\u90e8\u3054\u3068\u306b\u6b21\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\uff11\uff0e\u8ca1\u7d4c\u90e8\u306e\u793e\u54e1\u306e\u51fa\u52e4\u6642\u9593\u4e0d\u660e\u30c7\u30fc\u30bf\uff08\u8ca1\u7d4c\u90e8.xls\uff09\n\n\uff12\uff0e\u55b6\u696d\u90e8\u306e\u793e\u54e1\u306e\u51fa\u52e4\u6642\u9593\u4e0d\u660e\u30c7\u30fc\u30bf\uff08\u55b6\u696d\u90e8.xls\uff09\n\n\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u30b5\u30d6\u30eb\u30fc\u30c1\u30f3\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3067\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\nExcelTool.xls\n'2015/09/04 --------------------------------------------------*\nPrivate Sub s_\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u5b9f\u884c(qCategory As String)\n  Dim wFileID   As String\n  Dim wBookName As String\n  '\n  Dim wRow      As String\n  Dim wAbc      As String\n  Dim wSaveName As String  '\u4fdd\u5b58\u540d\n  Dim wRange    As String\n  Dim wCntRow   As Integer\n  Dim wCopyRow  As String\n  Dim wPastRow  As String\n  Dim wItem     As String\n  Dim wNo   As Integer\n  Dim wFL   As Integer\n  Dim wBook As String\n\n  wBook = fnPickFile(gMyBook)\n\n  '\u30ef\u30fc\u30af\u30d6\u30c3\u30af\u540d\u3092\u4f5c\u6210\n  wAbc = Me.cbo\u5217.Text\n  wRow = Me.cbo\u884c.Text\n\n  wSaveName = Trim(qCategory)\n  wSaveName = Replace(wSaveName, \" \", \"\")\n  wSaveName = Replace(wSaveName, \"\u3000\", \"\")\n\n  wFileID = Format(Date, \"yyyymmdd\") & Format(Time, \"hhmmss\")\n  '2015/09/11 \u5148\u982d\u65e5\u4ed8\u3092\u7121\u304f\u3057\u305f\n  wBookName = wSaveName & \".xlsx\"\n\n  '\u65b0\u898f\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\n  Workbooks.Add\n  '\u30ef\u30fc\u30af\u30d6\u30c3\u30af\u3092\u5225\u540d\u3067\u4fdd\u5b58\n  ActiveWorkbook.SaveAs FileName:=wBookName\n  '\u30d8\u30c3\u30c0\u30b3\u30d4\u30fc\n  wRange = \"1:\" & wRow\n  Workbooks(wBook).Worksheets(1).Rows(wRange).Copy\n  Workbooks(wBookName).Worksheets(1).Rows(wRange).Select\n  Workbooks(wBookName).Worksheets(1).Rows(wRange).PasteSpecial Paste:=xlPasteAll\n  Workbooks(wBookName).Worksheets(1).Rows(wRange).PasteSpecial Paste:=xlPasteColumnWidths\n\n  wCntRow = Val(wRow) + 1\n  wNo = wCntRow\n  wFL = 0\n  Do\n    wRange = Replace(wAbc, \"\u5217\", \"\") & Trim(Str(wCntRow))\n    wItem = Workbooks(wBook).Worksheets(1).Range(wRange)\n\n    If qCategory = wItem Then\n      wFL = 1\n      wCopyRow = Trim(Str(wCntRow))\n      wPastRow = Trim(Str(wNo))\n\n      Workbooks(wBook).Worksheets(1).Rows(wCopyRow).Copy _\n      Workbooks(wBookName).Worksheets(1).Rows(wPastRow)\n\n      wNo = wNo + 1\n    Else\n      If wFL = 1 Then Exit Do\n    End If\n\n    wCntRow = wCntRow + 1\n    If wCntRow > 1000 Then Exit Do\n  Loop\n\n  Workbooks(wBookName).Worksheets(1).Range(\"A1\").Select\n  Workbooks(wBookName).Save\n  Workbooks(wBookName).Close SaveChanges:=False\nEnd Sub\n\n\n\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u8d77\u52d5\u3057\u305f\u3068\u304d\u306e\u30e1\u30cb\u30e5\u30fc\u753b\u9762\n\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3057\u3066\u3001\u6c4e\u7528\u7684\u306b\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u4e0b\u306eURL\u306e\u30da\u30fc\u30b8\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n\u25bc\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nhttp://excel-databace.hatenablog.com/entry/data-bunkatsu\n# \u9805\u76ee\u3054\u3068\u306b\u5206\u5272\u3057\u3066\u5225\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\u3059\u308b\u3002\n\n\n\u25bc\u4f1a\u793e\u306e\u5165\u308a\u53e3\u306b\u8a2d\u7f6e\u3055\u308c\u305f\u30bf\u30a4\u30e0\u30ec\u30b3\u30fc\u30c0\u30fc\u3067\u306f\u3001\u62bc\u3057\u308f\u3059\u308c\u306a\u3069\u3067\u767a\u751f\u3059\u308b\u5168\u793e\u54e1\u306e\u51fa\u52e4\u4e0d\u660e\u6642\u9593\u30c7\u30fc\u30bf\u304c\u3001CSV\u30d5\u30a1\u30a4\u30eb\u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n\u3053\u306e\u51fa\u52e4\u4e0d\u660e\u30c7\u30fc\u30bf\u3092\u4e8b\u696d\u90e8\u3054\u3068\u306b\u5206\u5272\u3057\u3066\u5225\u3005\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u51fa\u529b\u3059\u308b\u5834\u5408\u306e\u30de\u30af\u30ed\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/93227/4ea68def-df93-8312-0eb8-626be0ad60e8.png)\n\n\n\u4e0a\u306e\u30c7\u30fc\u30bf\u3092\u4e8b\u696d\u90e8\u3054\u3068\u306b\u6b21\u306e\u3088\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\uff11\uff0e\u8ca1\u7d4c\u90e8\u306e\u793e\u54e1\u306e\u51fa\u52e4\u6642\u9593\u4e0d\u660e\u30c7\u30fc\u30bf\uff08\u8ca1\u7d4c\u90e8.xls\uff09\n![image](https://qiita-image-store.s3.amazonaws.com/0/93227/123d8769-13a9-95ff-e232-9a87187006c0.png)\n\n\uff12\uff0e\u55b6\u696d\u90e8\u306e\u793e\u54e1\u306e\u51fa\u52e4\u6642\u9593\u4e0d\u660e\u30c7\u30fc\u30bf\uff08\u55b6\u696d\u90e8.xls\uff09\n![image](https://qiita-image-store.s3.amazonaws.com/0/93227/363bb5f2-0db2-2be4-2870-0079ad9536a1.png)\n\n\n\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u30b5\u30d6\u30eb\u30fc\u30c1\u30f3\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3067\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n```VBA:ExcelTool.xls\n'2015/09/04 --------------------------------------------------*\nPrivate Sub s_\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\u5b9f\u884c(qCategory As String)\n  Dim wFileID   As String\n  Dim wBookName As String\n  '\n  Dim wRow      As String\n  Dim wAbc      As String\n  Dim wSaveName As String  '\u4fdd\u5b58\u540d\n  Dim wRange    As String\n  Dim wCntRow   As Integer\n  Dim wCopyRow  As String\n  Dim wPastRow  As String\n  Dim wItem     As String\n  Dim wNo   As Integer\n  Dim wFL   As Integer\n  Dim wBook As String\n  \n  wBook = fnPickFile(gMyBook)\n  \n  '\u30ef\u30fc\u30af\u30d6\u30c3\u30af\u540d\u3092\u4f5c\u6210\n  wAbc = Me.cbo\u5217.Text\n  wRow = Me.cbo\u884c.Text\n  \n  wSaveName = Trim(qCategory)\n  wSaveName = Replace(wSaveName, \" \", \"\")\n  wSaveName = Replace(wSaveName, \"\u3000\", \"\")\n  \n  wFileID = Format(Date, \"yyyymmdd\") & Format(Time, \"hhmmss\")\n  '2015/09/11 \u5148\u982d\u65e5\u4ed8\u3092\u7121\u304f\u3057\u305f\n  wBookName = wSaveName & \".xlsx\"\n  \n  '\u65b0\u898f\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308b\n  Workbooks.Add\n  '\u30ef\u30fc\u30af\u30d6\u30c3\u30af\u3092\u5225\u540d\u3067\u4fdd\u5b58\n  ActiveWorkbook.SaveAs FileName:=wBookName\n  '\u30d8\u30c3\u30c0\u30b3\u30d4\u30fc\n  wRange = \"1:\" & wRow\n  Workbooks(wBook).Worksheets(1).Rows(wRange).Copy\n  Workbooks(wBookName).Worksheets(1).Rows(wRange).Select\n  Workbooks(wBookName).Worksheets(1).Rows(wRange).PasteSpecial Paste:=xlPasteAll\n  Workbooks(wBookName).Worksheets(1).Rows(wRange).PasteSpecial Paste:=xlPasteColumnWidths\n  \n  wCntRow = Val(wRow) + 1\n  wNo = wCntRow\n  wFL = 0\n  Do\n    wRange = Replace(wAbc, \"\u5217\", \"\") & Trim(Str(wCntRow))\n    wItem = Workbooks(wBook).Worksheets(1).Range(wRange)\n    \n    If qCategory = wItem Then\n      wFL = 1\n      wCopyRow = Trim(Str(wCntRow))\n      wPastRow = Trim(Str(wNo))\n      \n      Workbooks(wBook).Worksheets(1).Rows(wCopyRow).Copy _\n      Workbooks(wBookName).Worksheets(1).Rows(wPastRow)\n\n      wNo = wNo + 1\n    Else\n      If wFL = 1 Then Exit Do\n    End If\n    \n    wCntRow = wCntRow + 1\n    If wCntRow > 1000 Then Exit Do\n  Loop\n  \n  Workbooks(wBookName).Worksheets(1).Range(\"A1\").Select\n  Workbooks(wBookName).Save\n  Workbooks(wBookName).Close SaveChanges:=False\nEnd Sub\n\n```\n\n## \u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u8d77\u52d5\u3057\u305f\u3068\u304d\u306e\u30e1\u30cb\u30e5\u30fc\u753b\u9762\n\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3057\u3066\u3001\u6c4e\u7528\u7684\u306b\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/93227/02d2564a-6aed-53f3-aa6b-4c214811b69f.png)\n\n### \u30d7\u30ed\u30b0\u30e9\u30e0\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n\u4e0b\u306eURL\u306e\u30da\u30fc\u30b8\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/93227/6ab71e4c-5394-4eb5-ca06-9fb59c2b9d7d.png)\n\n\u25bc\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n[http://excel-databace.hatenablog.com/entry/data-bunkatsu](http://excel-databace.hatenablog.com/entry/data-bunkatsu)\n\n\n", "tags": ["Excel", "ExcelVBA"]}