{"context": " More than 1 year has passed since last update.\u9577\u3044\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\u3067\u3059\u3002\nAutoHotKey\u3092\u4f7f\u3044\u3001Esc\u307e\u305f\u306fCtrl-[\u3067\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u308b\u969b\u306b\u3001\u65e5\u672c\u8a9e\u5165\u529b\u304cON\u3067\u3042\u308c\u3070OFF\u306b\u306a\u308b\u3088\u3046\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nAutoHotKey\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4ee5\u4e0b\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\nhttp://www.autohotkey.com/\n\nahk\u30b9\u30af\u30ea\u30d7\u30c8\n\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092*.ahk\u3068\u3057\u3066\u4fdd\u5b58\u3057\u3001\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001Sublime Text\uff08\u3068\u3064\u3044\u3067\u306bAtom\uff09\u306eWindow\u304c\u30a2\u30af\u30c6\u30a3\u30d6\u306e\u3068\u304d\u306b\u306e\u307fAutoHotKey\u304c\u6709\u52b9\u306b\u306a\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001IME\u306e\u64cd\u4f5c\u306b\u306f\u3001eamat@Cabinet\u3055\u3093\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u308bIME.ahk\u3092\u4f7f\u308f\u305b\u3066\u3044\u305f\u3060\u3044\u3066\u3044\u307e\u3059\u3002\n\nvim_esc.ahk\n; For Sublime Text/Atom\nSetTitleMatchMode, 2 \nGroupAdd Editor, ahk_class PX_WINDOW_CLASS ; Sublime Text\nGroupAdd Editor, - Atom                    ; Atom\nreturn\n\n; Paste IME.ahk functions\nIME_GET(WinTitle=\"A\")  {\n    ControlGet,hwnd,HWND,,,%WinTitle%\n    if  (WinActive(WinTitle))   {\n        ptrSize := !A_PtrSize ? 4 : A_PtrSize\n        VarSetCapacity(stGTI, cbSize:=4+4+(PtrSize*6)+16, 0)\n        NumPut(cbSize, stGTI,  0, \"UInt\")   ;   DWORD   cbSize;\n        hwnd := DllCall(\"GetGUIThreadInfo\", Uint,0, Uint,&stGTI)\n                 ? NumGet(stGTI,8+PtrSize,\"UInt\") : hwnd\n    }\n\n    return DllCall(\"SendMessage\"\n          , UInt, DllCall(\"imm32\\ImmGetDefaultIMEWnd\", Uint,hwnd)\n          , UInt, 0x0283  ;Message : WM_IME_CONTROL\n          ,  Int, 0x0005  ;wParam  : IMC_GETOPENSTATUS\n          ,  Int, 0)      ;lParam  : 0\n}\nIME_SET(SetSts, WinTitle=\"A\")    {\n    ControlGet,hwnd,HWND,,,%WinTitle%\n    if  (WinActive(WinTitle))   {\n        ptrSize := !A_PtrSize ? 4 : A_PtrSize\n        VarSetCapacity(stGTI, cbSize:=4+4+(PtrSize*6)+16, 0)\n        NumPut(cbSize, stGTI,  0, \"UInt\")   ;   DWORD   cbSize;\n        hwnd := DllCall(\"GetGUIThreadInfo\", Uint,0, Uint,&stGTI)\n                 ? NumGet(stGTI,8+PtrSize,\"UInt\") : hwnd\n    }\n\n    return DllCall(\"SendMessage\"\n          , UInt, DllCall(\"imm32\\ImmGetDefaultIMEWnd\", Uint,hwnd)\n          , UInt, 0x0283  ;Message : WM_IME_CONTROL\n          ,  Int, 0x006   ;wParam  : IMC_SETOPENSTATUS\n          ,  Int, SetSts) ;lParam  : 0 or 1\n}\nIME_GetConverting(WinTitle=\"A\",ConvCls=\"\",CandCls=\"\") {\n\n    ;IME\u6bce\u306e \u5165\u529b\u7a93/\u5019\u88dc\u7a93Class\u4e00\u89a7 (\"|\" \u533a\u5207\u308a\u3067\u9069\u5f53\u306b\u8db3\u3057\u3066\u3051\u3070OK)\n    ConvCls .= (ConvCls ? \"|\" : \"\")                 ;--- \u5165\u529b\u7a93 ---\n            .  \"ATOK\\d+CompStr\"                     ; ATOK\u7cfb\n            .  \"|imejpstcnv\\d+\"                     ; MS-IME\u7cfb\n            .  \"|WXGIMEConv\"                        ; WXG\n            .  \"|SKKIME\\d+\\.*\\d+UCompStr\"           ; SKKIME Unicode\n            .  \"|MSCTFIME Composition\"              ; Google\u65e5\u672c\u8a9e\u5165\u529b\n\n    CandCls .= (CandCls ? \"|\" : \"\")                 ;--- \u5019\u88dc\u7a93 ---\n            .  \"ATOK\\d+Cand\"                        ; ATOK\u7cfb\n            .  \"|imejpstCandList\\d+|imejpstcand\\d+\" ; MS-IME 2002(8.1)XP\u4ed8\u5c5e\n            .  \"|mscandui\\d+\\.candidate\"            ; MS Office IME-2007\n            .  \"|WXGIMECand\"                        ; WXG\n            .  \"|SKKIME\\d+\\.*\\d+UCand\"              ; SKKIME Unicode\n   CandGCls := \"GoogleJapaneseInputCandidateWindow\" ;Google\u65e5\u672c\u8a9e\u5165\u529b\n\n    ControlGet,hwnd,HWND,,,%WinTitle%\n    if  (WinActive(WinTitle))   {\n        ptrSize := !A_PtrSize ? 4 : A_PtrSize\n        VarSetCapacity(stGTI, cbSize:=4+4+(PtrSize*6)+16, 0)\n        NumPut(cbSize, stGTI,  0, \"UInt\")   ;   DWORD   cbSize;\n        hwnd := DllCall(\"GetGUIThreadInfo\", Uint,0, Uint,&stGTI)\n                 ? NumGet(stGTI,8+PtrSize,\"UInt\") : hwnd\n    }\n\n    WinGet, pid, PID,% \"ahk_id \" hwnd\n    tmm:=A_TitleMatchMode\n    SetTitleMatchMode, RegEx\n    ret := WinExist(\"ahk_class \" . CandCls . \" ahk_pid \" pid) ? 2\n        :  WinExist(\"ahk_class \" . CandGCls                 ) ? 2\n        :  WinExist(\"ahk_class \" . ConvCls . \" ahk_pid \" pid) ? 1\n        :  0\n    SetTitleMatchMode, %tmm%\n    return ret\n}\n\n#IfWInActive, ahk_group Editor\n; When Press Esc\nEsc::\n  if (IME_GET(A)) {\n    if (IME_GetConverting(A)) {\n      Send,{Esc}\n    } else {\n      Send,{Esc}\n      Sleep 1 ; wait 1 ms (Need to stop converting)\n      IME_SET(0)\n    }\n  } else {\n    Send,{Esc}\n  }\n  Return\n^[::\n; When Press Ctrl-[\n  if (IME_GET(A)) {\n    Send,{Esc}\n    Sleep 1 ; wait 1 ms (Need to stop converting)\n    IME_SET(0)\n    Send,{Esc}\n  } else {\n    Send,{Esc}\n  }\n  Return\n#IfWInActive\n\n\n\n\u53c2\u8003\n\nVim\u3092\u4f7f\u3046\u4e0a\u3067\u306eIME(\u65e5\u672c\u8a9e\u5165\u529b)\u306e\u53d6\u308a\u6271\u3044 with AutoHotKey\neamat @Cabinet - IME\u5236\u5fa1\n\n\u9577\u3044\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\u3067\u3059\u3002\nAutoHotKey\u3092\u4f7f\u3044\u3001Esc\u307e\u305f\u306fCtrl-[\u3067\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u308b\u969b\u306b\u3001\u65e5\u672c\u8a9e\u5165\u529b\u304cON\u3067\u3042\u308c\u3070OFF\u306b\u306a\u308b\u3088\u3046\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n# AutoHotKey\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u4ee5\u4e0b\u304b\u3089\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\nhttp://www.autohotkey.com/\n\n\n# ahk\u30b9\u30af\u30ea\u30d7\u30c8\n\n\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092*.ahk\u3068\u3057\u3066\u4fdd\u5b58\u3057\u3001\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001Sublime Text\uff08\u3068\u3064\u3044\u3067\u306bAtom\uff09\u306eWindow\u304c\u30a2\u30af\u30c6\u30a3\u30d6\u306e\u3068\u304d\u306b\u306e\u307fAutoHotKey\u304c\u6709\u52b9\u306b\u306a\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u306a\u304a\u3001IME\u306e\u64cd\u4f5c\u306b\u306f\u3001[eamat@Cabinet\u3055\u3093\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u308bIME.ahk](\"http://www6.atwiki.jp/eamat/pages/17.html\")\u3092\u4f7f\u308f\u305b\u3066\u3044\u305f\u3060\u3044\u3066\u3044\u307e\u3059\u3002\n\n```vim_esc.ahk\n; For Sublime Text/Atom\nSetTitleMatchMode, 2 \nGroupAdd Editor, ahk_class PX_WINDOW_CLASS ; Sublime Text\nGroupAdd Editor, - Atom                    ; Atom\nreturn\n \n; Paste IME.ahk functions\nIME_GET(WinTitle=\"A\")  {\n\tControlGet,hwnd,HWND,,,%WinTitle%\n\tif\t(WinActive(WinTitle))\t{\n\t\tptrSize := !A_PtrSize ? 4 : A_PtrSize\n\t    VarSetCapacity(stGTI, cbSize:=4+4+(PtrSize*6)+16, 0)\n\t    NumPut(cbSize, stGTI,  0, \"UInt\")   ;\tDWORD   cbSize;\n\t\thwnd := DllCall(\"GetGUIThreadInfo\", Uint,0, Uint,&stGTI)\n\t             ? NumGet(stGTI,8+PtrSize,\"UInt\") : hwnd\n\t}\n\n    return DllCall(\"SendMessage\"\n          , UInt, DllCall(\"imm32\\ImmGetDefaultIMEWnd\", Uint,hwnd)\n          , UInt, 0x0283  ;Message : WM_IME_CONTROL\n          ,  Int, 0x0005  ;wParam  : IMC_GETOPENSTATUS\n          ,  Int, 0)      ;lParam  : 0\n}\nIME_SET(SetSts, WinTitle=\"A\")    {\n\tControlGet,hwnd,HWND,,,%WinTitle%\n\tif\t(WinActive(WinTitle))\t{\n\t\tptrSize := !A_PtrSize ? 4 : A_PtrSize\n\t    VarSetCapacity(stGTI, cbSize:=4+4+(PtrSize*6)+16, 0)\n\t    NumPut(cbSize, stGTI,  0, \"UInt\")   ;\tDWORD   cbSize;\n\t\thwnd := DllCall(\"GetGUIThreadInfo\", Uint,0, Uint,&stGTI)\n\t             ? NumGet(stGTI,8+PtrSize,\"UInt\") : hwnd\n\t}\n\n    return DllCall(\"SendMessage\"\n          , UInt, DllCall(\"imm32\\ImmGetDefaultIMEWnd\", Uint,hwnd)\n          , UInt, 0x0283  ;Message : WM_IME_CONTROL\n          ,  Int, 0x006   ;wParam  : IMC_SETOPENSTATUS\n          ,  Int, SetSts) ;lParam  : 0 or 1\n}\nIME_GetConverting(WinTitle=\"A\",ConvCls=\"\",CandCls=\"\") {\n\n    ;IME\u6bce\u306e \u5165\u529b\u7a93/\u5019\u88dc\u7a93Class\u4e00\u89a7 (\"|\" \u533a\u5207\u308a\u3067\u9069\u5f53\u306b\u8db3\u3057\u3066\u3051\u3070OK)\n    ConvCls .= (ConvCls ? \"|\" : \"\")                 ;--- \u5165\u529b\u7a93 ---\n            .  \"ATOK\\d+CompStr\"                     ; ATOK\u7cfb\n            .  \"|imejpstcnv\\d+\"                     ; MS-IME\u7cfb\n            .  \"|WXGIMEConv\"                        ; WXG\n            .  \"|SKKIME\\d+\\.*\\d+UCompStr\"           ; SKKIME Unicode\n            .  \"|MSCTFIME Composition\"              ; Google\u65e5\u672c\u8a9e\u5165\u529b\n\n    CandCls .= (CandCls ? \"|\" : \"\")                 ;--- \u5019\u88dc\u7a93 ---\n            .  \"ATOK\\d+Cand\"                        ; ATOK\u7cfb\n            .  \"|imejpstCandList\\d+|imejpstcand\\d+\" ; MS-IME 2002(8.1)XP\u4ed8\u5c5e\n            .  \"|mscandui\\d+\\.candidate\"            ; MS Office IME-2007\n            .  \"|WXGIMECand\"                        ; WXG\n            .  \"|SKKIME\\d+\\.*\\d+UCand\"              ; SKKIME Unicode\n   CandGCls := \"GoogleJapaneseInputCandidateWindow\" ;Google\u65e5\u672c\u8a9e\u5165\u529b\n\n\tControlGet,hwnd,HWND,,,%WinTitle%\n\tif\t(WinActive(WinTitle))\t{\n\t\tptrSize := !A_PtrSize ? 4 : A_PtrSize\n\t    VarSetCapacity(stGTI, cbSize:=4+4+(PtrSize*6)+16, 0)\n\t    NumPut(cbSize, stGTI,  0, \"UInt\")   ;\tDWORD   cbSize;\n\t\thwnd := DllCall(\"GetGUIThreadInfo\", Uint,0, Uint,&stGTI)\n\t             ? NumGet(stGTI,8+PtrSize,\"UInt\") : hwnd\n\t}\n\n    WinGet, pid, PID,% \"ahk_id \" hwnd\n    tmm:=A_TitleMatchMode\n    SetTitleMatchMode, RegEx\n    ret := WinExist(\"ahk_class \" . CandCls . \" ahk_pid \" pid) ? 2\n        :  WinExist(\"ahk_class \" . CandGCls                 ) ? 2\n        :  WinExist(\"ahk_class \" . ConvCls . \" ahk_pid \" pid) ? 1\n        :  0\n    SetTitleMatchMode, %tmm%\n    return ret\n}\n\n#IfWInActive, ahk_group Editor\n; When Press Esc\nEsc::\n  if (IME_GET(A)) {\n    if (IME_GetConverting(A)) {\n      Send,{Esc}\n    } else {\n      Send,{Esc}\n      Sleep 1 ; wait 1 ms (Need to stop converting)\n      IME_SET(0)\n    }\n  } else {\n    Send,{Esc}\n  }\n  Return\n^[::\n; When Press Ctrl-[\n  if (IME_GET(A)) {\n    Send,{Esc}\n    Sleep 1 ; wait 1 ms (Need to stop converting)\n    IME_SET(0)\n    Send,{Esc}\n  } else {\n    Send,{Esc}\n  }\n  Return\n#IfWInActive\n```\n\n## \u53c2\u8003\n- [Vim\u3092\u4f7f\u3046\u4e0a\u3067\u306eIME(\u65e5\u672c\u8a9e\u5165\u529b)\u306e\u53d6\u308a\u6271\u3044 with AutoHotKey](\"http://rcmdnk.github.io/blog/2013/08/04/computer-windows-autohotkey/\")\n- [eamat @Cabinet - IME\u5236\u5fa1](\"http://www6.atwiki.jp/eamat/pages/17.html\")\n", "tags": ["SublimeText", "AutoHotkey"]}