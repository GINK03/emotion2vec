{"tags": ["openstack", "Cinder"], "context": " More than 1 year has passed since last update.\n\nWhat's this?\nCinder volume \u3092\u5225\u306e Storage backend \u3078\u79fb\u52d5\n\nInitial state\n\nCinder Services\n# cinder service-list\n+------------------+---------+-------+---------+-------+----------------------------+\n|      Binary      | Host    |  Zone |  Status | State |         Updated_at         |\n+------------------+---------+-------+---------+-------+----------------------------+\n|  cinder-backup   | node-17 |  nova | enabled |   up  | 2015-03-09T06:58:19.000000 |\n|  cinder-backup   | node-18 |  nova | enabled |   up  | 2015-03-09T06:58:28.000000 |\n|  cinder-backup   | node-22 |  nova | enabled |   up  | 2015-03-09T06:58:28.000000 |\n| cinder-scheduler | node-17 |  nova | enabled |   up  | 2015-03-09T06:58:25.000000 |\n| cinder-scheduler | node-18 |  nova | enabled |   up  | 2015-03-09T06:58:28.000000 |\n| cinder-scheduler | node-22 | nova2 | enabled |   up  | 2015-03-09T06:58:23.000000 |\n|  cinder-volume   | node-17 |  nova | enabled |   up  | 2015-03-09T06:58:26.000000 |\n|  cinder-volume   | node-18 |  nova | enabled |   up  | 2015-03-09T06:58:21.000000 |\n|  cinder-volume   | node-22 | nova2 | enabled |   up  | 2015-03-09T06:58:21.000000 |\n+------------------+---------+-------+---------+-------+----------------------------+\n\n\nAZ\n# cinder availability-zone-list\n+-------+-----------+\n|  Name |   Status  |\n+-------+-----------+\n|  nova | available |\n| nova2 | available |\n+-------+-----------+\n\n\nHost\n# cinder-manage host list\nhost          zone\nnode-17       nova\nnode-18       nova\nnode-22       nova2\n\n\nCinder Volume\n# cinder list\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n|                  ID                  |   Status  | Display Name | Size | Volume Type | Bootable | Attached to |\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n| 3ffaaea5-24a0-414b-a6c2-7c28a888795b | available | admin_vol01  |  1   |     None    |  false   |             |\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n\n# cinder show 3ffaaea5-24a0-414b-a6c2-7c28a888795b\n+--------------------------------+--------------------------------------+\n|            Property            |                Value                 |\n+--------------------------------+--------------------------------------+\n|          attachments           |                  []                  |\n|       availability_zone        |                 nova                 |\n|            bootable            |                false                 |\n|           created_at           |      2015-03-09T06:41:33.000000      |\n|      display_description       |                                      |\n|          display_name          |             admin_vol01              |\n|           encrypted            |                False                 |\n|               id               | 3ffaaea5-24a0-414b-a6c2-7c28a888795b |\n|            metadata            |                  {}                  |\n|     os-vol-host-attr:host      |        node-17                       |\n| os-vol-mig-status-attr:migstat |                 None                 |\n| os-vol-mig-status-attr:name_id |                 None                 |\n|  os-vol-tenant-attr:tenant_id  |   a8085d1871f847bdb906ef4a28d1bd48   |\n|              size              |                  1                   |\n|          snapshot_id           |                 None                 |\n|          source_volid          |                 None                 |\n|             status             |              available               |\n|          volume_type           |                 None                 |\n+--------------------------------+--------------------------------------+\n\n\nMigrate cinder volume to different backend\n\nMigrate volume(admin_vol01) from backend(node-17) to backend(node-18)\n# cinder migrate 3ffaaea5-24a0-414b-a6c2-7c28a888795b node-18\n\n\nCreated new Cinder volume(93f650fd-c4b3-420a-8409-d333c12e4d9c) as same name.\n# cinder list\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n|                  ID                  |   Status  | Display Name | Size | Volume Type | Bootable | Attached to |\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n| 3ffaaea5-24a0-414b-a6c2-7c28a888795b | available | admin_vol01  |  1   |     None    |  false   |             |\n| 93f650fd-c4b3-420a-8409-d333c12e4d9c | available | admin_vol01  |  1   |     None    |  false   |             |\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n\n\nNew Cinder volume(93f650fd-c4b3-420a-8409-d333c12e4d9c) is on backend(node-18)\n# cinder show 93f650fd-c4b3-420a-8409-d333c12e4d9c\n+--------------------------------+---------------------------------------------+\n|            Property            |                    Value                    |\n+--------------------------------+---------------------------------------------+\n|          attachments           |                      []                     |\n|       availability_zone        |                     nova                    |\n|            bootable            |                    false                    |\n|           created_at           |          2015-03-09T06:41:33.000000         |\n|      display_description       |                                             |\n|          display_name          |                 admin_vol01                 |\n|           encrypted            |                    False                    |\n|               id               |     93f650fd-c4b3-420a-8409-d333c12e4d9c    |\n|            metadata            |                      {}                     |\n|     os-vol-host-attr:host      |            node-18                          |\n| os-vol-mig-status-attr:migstat | target:3ffaaea5-24a0-414b-a6c2-7c28a888795b |\n| os-vol-mig-status-attr:name_id |                     None                    |\n|  os-vol-tenant-attr:tenant_id  |       a8085d1871f847bdb906ef4a28d1bd48      |\n|              size              |                      1                      |\n|          snapshot_id           |                     None                    |\n|          source_volid          |                     None                    |\n|             status             |                  available                  |\n|          volume_type           |                     None                    |\n+--------------------------------+---------------------------------------------+\n\n\nCinder rename\n# cinder rename 93f650fd-c4b3-420a-8409-d333c12e4d9c admin_vol11\n\n# cinder list\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n|                  ID                  |   Status  | Display Name | Size | Volume Type | Bootable | Attached to |\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n| 3ffaaea5-24a0-414b-a6c2-7c28a888795b | available | admin_vol01  |  1   |     None    |  false   |             |\n| 93f650fd-c4b3-420a-8409-d333c12e4d9c | available | admin_vol11  |  1   |     None    |  false   |             |\n+--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n\n\nEnvironment\n\nOpenstack : Juno\nCeph : Firefly\n\n\nReference\nCinder Migration to Different Backend\nCinder Migration to Different AZ\nCinder Migration to Different Region\n## What's this?\n\nCinder volume \u3092\u5225\u306e Storage backend \u3078\u79fb\u52d5\n\n## Initial state\n\n##### Cinder Services\n\n    # cinder service-list\n    +------------------+---------+-------+---------+-------+----------------------------+\n    |      Binary      | Host    |  Zone |  Status | State |         Updated_at         |\n    +------------------+---------+-------+---------+-------+----------------------------+\n    |  cinder-backup   | node-17 |  nova | enabled |   up  | 2015-03-09T06:58:19.000000 |\n    |  cinder-backup   | node-18 |  nova | enabled |   up  | 2015-03-09T06:58:28.000000 |\n    |  cinder-backup   | node-22 |  nova | enabled |   up  | 2015-03-09T06:58:28.000000 |\n    | cinder-scheduler | node-17 |  nova | enabled |   up  | 2015-03-09T06:58:25.000000 |\n    | cinder-scheduler | node-18 |  nova | enabled |   up  | 2015-03-09T06:58:28.000000 |\n    | cinder-scheduler | node-22 | nova2 | enabled |   up  | 2015-03-09T06:58:23.000000 |\n    |  cinder-volume   | node-17 |  nova | enabled |   up  | 2015-03-09T06:58:26.000000 |\n    |  cinder-volume   | node-18 |  nova | enabled |   up  | 2015-03-09T06:58:21.000000 |\n    |  cinder-volume   | node-22 | nova2 | enabled |   up  | 2015-03-09T06:58:21.000000 |\n    +------------------+---------+-------+---------+-------+----------------------------+\n\n##### AZ\n\n    # cinder availability-zone-list\n    +-------+-----------+\n    |  Name |   Status  |\n    +-------+-----------+\n    |  nova | available |\n    | nova2 | available |\n    +-------+-----------+\n\n##### Host\n\n    # cinder-manage host list\n    host          zone\n    node-17       nova\n    node-18       nova\n    node-22       nova2\n\n##### Cinder Volume\n\n    # cinder list\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n    |                  ID                  |   Status  | Display Name | Size | Volume Type | Bootable | Attached to |\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n    | 3ffaaea5-24a0-414b-a6c2-7c28a888795b | available | admin_vol01  |  1   |     None    |  false   |             |\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n\n    # cinder show 3ffaaea5-24a0-414b-a6c2-7c28a888795b\n    +--------------------------------+--------------------------------------+\n    |            Property            |                Value                 |\n    +--------------------------------+--------------------------------------+\n    |          attachments           |                  []                  |\n    |       availability_zone        |                 nova                 |\n    |            bootable            |                false                 |\n    |           created_at           |      2015-03-09T06:41:33.000000      |\n    |      display_description       |                                      |\n    |          display_name          |             admin_vol01              |\n    |           encrypted            |                False                 |\n    |               id               | 3ffaaea5-24a0-414b-a6c2-7c28a888795b |\n    |            metadata            |                  {}                  |\n    |     os-vol-host-attr:host      |        node-17                       |\n    | os-vol-mig-status-attr:migstat |                 None                 |\n    | os-vol-mig-status-attr:name_id |                 None                 |\n    |  os-vol-tenant-attr:tenant_id  |   a8085d1871f847bdb906ef4a28d1bd48   |\n    |              size              |                  1                   |\n    |          snapshot_id           |                 None                 |\n    |          source_volid          |                 None                 |\n    |             status             |              available               |\n    |          volume_type           |                 None                 |\n    +--------------------------------+--------------------------------------+\n\n\n## Migrate cinder volume to different backend\n\n##### Migrate volume(admin_vol01) from backend(node-17) to backend(node-18)\n\n    # cinder migrate 3ffaaea5-24a0-414b-a6c2-7c28a888795b node-18\n\n##### Created new Cinder volume(93f650fd-c4b3-420a-8409-d333c12e4d9c) as same name.\n\n    # cinder list\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n    |                  ID                  |   Status  | Display Name | Size | Volume Type | Bootable | Attached to |\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n    | 3ffaaea5-24a0-414b-a6c2-7c28a888795b | available | admin_vol01  |  1   |     None    |  false   |             |\n    | 93f650fd-c4b3-420a-8409-d333c12e4d9c | available | admin_vol01  |  1   |     None    |  false   |             |\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n\n##### New Cinder volume(93f650fd-c4b3-420a-8409-d333c12e4d9c) is on backend(node-18)\n\n    # cinder show 93f650fd-c4b3-420a-8409-d333c12e4d9c\n    +--------------------------------+---------------------------------------------+\n    |            Property            |                    Value                    |\n    +--------------------------------+---------------------------------------------+\n    |          attachments           |                      []                     |\n    |       availability_zone        |                     nova                    |\n    |            bootable            |                    false                    |\n    |           created_at           |          2015-03-09T06:41:33.000000         |\n    |      display_description       |                                             |\n    |          display_name          |                 admin_vol01                 |\n    |           encrypted            |                    False                    |\n    |               id               |     93f650fd-c4b3-420a-8409-d333c12e4d9c    |\n    |            metadata            |                      {}                     |\n    |     os-vol-host-attr:host      |            node-18                          |\n    | os-vol-mig-status-attr:migstat | target:3ffaaea5-24a0-414b-a6c2-7c28a888795b |\n    | os-vol-mig-status-attr:name_id |                     None                    |\n    |  os-vol-tenant-attr:tenant_id  |       a8085d1871f847bdb906ef4a28d1bd48      |\n    |              size              |                      1                      |\n    |          snapshot_id           |                     None                    |\n    |          source_volid          |                     None                    |\n    |             status             |                  available                  |\n    |          volume_type           |                     None                    |\n    +--------------------------------+---------------------------------------------+\n\n##### Cinder rename\n\n    # cinder rename 93f650fd-c4b3-420a-8409-d333c12e4d9c admin_vol11\n\n    # cinder list\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n    |                  ID                  |   Status  | Display Name | Size | Volume Type | Bootable | Attached to |\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n    | 3ffaaea5-24a0-414b-a6c2-7c28a888795b | available | admin_vol01  |  1   |     None    |  false   |             |\n    | 93f650fd-c4b3-420a-8409-d333c12e4d9c | available | admin_vol11  |  1   |     None    |  false   |             |\n    +--------------------------------------+-----------+--------------+------+-------------+----------+-------------+\n\n\n## Environment\n\n* Openstack : Juno\n* Ceph : Firefly\n\n\n## Reference\n\n[Cinder Migration to Different Backend][link-01]\n[Cinder Migration to Different AZ][link-02]\n[Cinder Migration to Different Region][link-03]\n\n[link-01]:http://qiita.com/idzzy/items/d4258be6bf73b0060dfb\n[link-02]:http://qiita.com/idzzy/items/153c5668ba08c87c1d2b\n[link-03]:http://qiita.com/idzzy/items/25dc605342738409a76b\n"}