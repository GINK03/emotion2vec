{"context": " More than 1 year has passed since last update.Intel Edison\u3068Ubuntu\u306bconsul\u3092\u5c0e\u5165\u3057\u3001\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b\u3002\nIntel Edison\u306fx86\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306e\u305f\u3081\u3001\u516c\u5f0f\u30b5\u30a4\u30c8\u304c\u914d\u5e03\u3057\u3066\u3044\u308b 32bit\u30d0\u30a4\u30ca\u30ea \u3092\u914d\u7f6e\u3059\u308b\u3060\u3051\u3067\u52d5\u4f5c\u3059\u308b\u3002\n\nUbuntu\u306e\u6e96\u5099\nconsul\u30af\u30e9\u30b9\u30bf\u306b\u53c2\u52a0\u3059\u308bUbuntu\u3092\u6e96\u5099\u3059\u308b\u3002\n\n\n\nUbuntu\n15.04\n\n\nkernel\n3.19.0-15-generic\n\n\narch\nx86_64\n\n\nconsul\n0.5.0(amd64)\n\n\nIPaddr\n192.168.0.9/24\n\n\n\n\nconsul(linux 64bit)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nconsul\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnmatsui@develop:~$ wget https://dl.bintray.com/mitchellh/consul/0.5.0_linux_amd64.zip -qO /tmp/consul_0.5.0_amd64.zip\nnmatsui@develop:~$ unzip /tmp/consul_0.5.0_amd64.zip -d ~/bin\nnmatsui@develop:~$ chmod +x ~/bin/consul \nnmatsui@develop:~$ consul version\nConsul v0.5.0\nConsul Protocol: 2 (Understands back to: 1)\n\n\n\nIntel Edison\u306e\u6e96\u5099\nconsul\u30af\u30e9\u30b9\u30bf\u306b\u53c2\u52a0\u3059\u308bIntel Edison\u3092\u6e96\u5099\u3059\u308b\u3002\nhttp://tech-sketch.jp/2014/12/edison-setup.html \u7b49\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u624b\u9806\u306b\u5f93\u3044\u3001Edison\u306b\u6700\u65b0\u30a4\u30e1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\u4eca\u56de\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u306fedison-image-ww05-15.zip\n\n\n\nIntel Edison\nweekly-120\n\n\nkernel\n3.10.17-poky-edison+\n\n\narch\ni686\n\n\nconsul\n0.5.0(386)\n\n\nIPaddr\n192.168.0.10/24\n\n\n\n\nIntel Edison\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nEdison\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nnmatsui@develop:~$ sudo screen /dev/ttyUSB0 115200\n\nPoky (Yocto Project Reference Distro) 1.6 edison ttyMFD2\n\nedison login: root\n[  126.834432] systemd-fsck[233]: /dev/mmcblk0p10: recovering journal\n[  126.881414] systemd-fsck[233]: /dev/mmcblk0p10: clean, 13/152608 files, 26868/610299 blocks\nroot@edison:~# \nroot@edison:~# reboot ota\nroot@edison:~# configure_edison --setup\n\nConfigure Edison: Device Password\nConfigure Edison: Device Name\nConfigure Edison: WiFi Connection\n\nroot@edison01:~# opkg update\nroot@edison01:~# opkg upgrade\n\n\n\nconsul(linux 32bit)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nconsul\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nroot@edison01:~# mkdir -p /usr/local/bin\nroot@edison01:~# wget https://dl.bintray.com/mitchellh/consul/0.5.0_linux_386.zi\np -qO /tmp/consul_0.5.0_386.zip --no-check-certificate\nroot@edison01:~# unzip /tmp/consul_0.5.0_386.zip -d /usr/local/bin\nroot@edison01:~# chmod +x /usr/local/bin/consul\nroot@edison01:~# consul version\nConsul v0.5.0\nConsul Protocol: 2 (Understands back to: 1)\n\n\n\nconsul\u30af\u30e9\u30b9\u30bf\u306e\u69cb\u7bc9\n\nUbuntu\u306econsul\u3092bootstrap\u3068\u3057\u3066\u8d77\u52d5\n\nconsul\u8d77\u52d5\nnmatsui@develop:~$ consul agent -data-dir /tmp -server -bootstrap-expect 2 &\n\n\n\nIntel Edison\u306econsul\u3092\u8d77\u52d5\u3057\u3066Ubuntu\u306bJOIN\n\nconsul\u8d77\u52d5\nroot@edison01:~# consul agent -data-dir /tmp -server -join 192.168.0.9 &\n\n\n\nconsul\u30af\u30e9\u30b9\u30bf\u306e\u72b6\u614b\n\nubuntu\u304b\u3089\u30e1\u30f3\u30d0\u30fc\u78ba\u8a8d\nnmatsui@develop:~$ consul members\n    2015/04/29 09:32:19 [INFO] agent.rpc: Accepted client: 127.0.0.1:35648\nNode      Address            Status  Type    Build  Protocol\ndevelop   192.168.0.9:8301   alive   server  0.5.0  2\nedison01  192.168.0.10:8301  alive   server  0.5.0  2\n\n\n\nedison\u304b\u3089\u30e1\u30f3\u30d0\u30fc\u78ba\u8a8d\nroot@edison01:~# consul members\n    2015/04/29 00:40:35 [INFO] agent.rpc: Accepted client: 127.0.0.1:54706\nNode      Address            Status  Type    Build  Protocol\nedison01  192.168.0.10:8301  alive   server  0.5.0  2\ndevelop   192.168.0.9:8301   alive   server  0.5.0  2\n\n\n\nconsul\u306b\u3088\u308b\u540d\u524d\u89e3\u6c7a\n\ndig\u3067\u78ba\u8a8d\nnmatsui@develop:~$ dig @127.0.0.1 -p 8600 develop.node.consul ANY\n...\n;; ANSWER SECTION:\ndevelop.node.consul.    0   IN  A   192.168.0.9\n...\nnmatsui@develop:~$ dig @127.0.0.1 -p 8600 edison01.node.consul ANY\nedison01.node.consul.   0   IN  A   192.168.0.10\n...\n\n\n\nAPI\u3067\u78ba\u8a8d\nroot@edison01:~# curl localhost:8500/v1/catalog/nodes\n[{\"Node\":\"develop\",\"Address\":\"192.168.0.9\"},{\"Node\":\"edison01\",\"Address\":\"192.168.0.10\"}]\n\n\n\nKVS\u306e\u5229\u7528\nConsul KVS\u306b\u5024\uff08{'foo'=>'bar'}\uff09\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u3059\u3079\u3066\u306e\u30af\u30e9\u30b9\u30bf\u30e1\u30f3\u30d0\u30fc\u3067\u5171\u6709\u3055\u308c\u308b\u3002\n\uff08Consul KVS\u306b\u767b\u9332\u3055\u308c\u308b\u5024\u306fbase64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\uff09\n\nEdison\u304b\u3089KVS\u306b\u30ad\u30fc\u3068\u5024\u3092\u767b\u9332\nroot@edison01:~# curl -X PUT -d 'hello world' http://localhost:8500/v1/kv/hoge\ntrue\n\n\n\nKVS\u306e\u78ba\u8a8d\nroot@edison01:~# curl -s http://localhost:8500/v1/kv/hoge\n[{\"CreateIndex\":35,\"ModifyIndex\":35,\"LockIndex\":0,\"Key\":\"hoge\",\"Flags\":0,\"Value\":\"aGVsbG8gd29ybGQ=\"}]\nnmatsui@develop:~$ curl -s http://localhost:8500/v1/kv/hoge\n[{\"CreateIndex\":35,\"ModifyIndex\":35,\"LockIndex\":0,\"Key\":\"hoge\",\"Flags\":0,\"Value\":\"aGVsbG8gd29ybGQ=\"}]\n\n\n\nbase64\u30c7\u30b3\u30fc\u30c9\u3057\u3066\u5024\u3092\u78ba\u8a8d\nnmatsui@develop:~$ curl -s http://localhost:8500/v1/kv/hoge | jq -r \".[0].Value\" | base64 -d\nhello world\n\n\n\n\u307e\u3068\u3081\n\u516c\u5f0f\u30b5\u30a4\u30c8\u304c\u914d\u5e03\u3057\u3066\u3044\u308b32bit\u30d0\u30a4\u30ca\u30ea\u3092\u914d\u7f6e\u3059\u308b\u3060\u3051\u3067Intel Edison\u4e0a\u3067consul\u304c\u52d5\u4f5c\u3057\u3001PC\u4e0a\u3067\u52d5\u4f5c\u3059\u308bconsul\u3068\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002\nIntel Edison\u3068Ubuntu\u306b[consul](https://www.consul.io/)\u3092\u5c0e\u5165\u3057\u3001\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b\u3002\nIntel Edison\u306fx86\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306e\u305f\u3081\u3001\u516c\u5f0f\u30b5\u30a4\u30c8\u304c\u914d\u5e03\u3057\u3066\u3044\u308b **32bit\u30d0\u30a4\u30ca\u30ea** \u3092\u914d\u7f6e\u3059\u308b\u3060\u3051\u3067\u52d5\u4f5c\u3059\u308b\u3002\n\n# Ubuntu\u306e\u6e96\u5099\nconsul\u30af\u30e9\u30b9\u30bf\u306b\u53c2\u52a0\u3059\u308bUbuntu\u3092\u6e96\u5099\u3059\u308b\u3002\n\n<table>\n<tbody>\n<tr><th>Ubuntu</th><td>15.04</td></tr>\n<tr><th>kernel</th><td>3.19.0-15-generic</td></tr>\n<tr><th>arch</th><td>x86_64</td></tr>\n<tr><th>consul</th><td>0.5.0(amd64)</td></tr>\n<tr><th>IPaddr</th><td>192.168.0.9/24</td></tr>\n</table>\n\n## consul(linux 64bit)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```text:consul\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nnmatsui@develop:~$ wget https://dl.bintray.com/mitchellh/consul/0.5.0_linux_amd64.zip -qO /tmp/consul_0.5.0_amd64.zip\nnmatsui@develop:~$ unzip /tmp/consul_0.5.0_amd64.zip -d ~/bin\nnmatsui@develop:~$ chmod +x ~/bin/consul \nnmatsui@develop:~$ consul version\nConsul v0.5.0\nConsul Protocol: 2 (Understands back to: 1)\n```\n\n# Intel Edison\u306e\u6e96\u5099\n\nconsul\u30af\u30e9\u30b9\u30bf\u306b\u53c2\u52a0\u3059\u308bIntel Edison\u3092\u6e96\u5099\u3059\u308b\u3002\n\nhttp://tech-sketch.jp/2014/12/edison-setup.html \u7b49\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u624b\u9806\u306b\u5f93\u3044\u3001Edison\u306b\u6700\u65b0\u30a4\u30e1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\u4eca\u56de\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u30a4\u30e1\u30fc\u30b8\u306f[edison-image-ww05-15.zip](http://downloadmirror.intel.com/24698/eng/edison-image-ww05-15.zip)\n\n<table>\n<tbody>\n<tr><th>Intel Edison</th><td>weekly-120</td></tr>\n<tr><th>kernel</th><td>3.10.17-poky-edison+</td></tr>\n<tr><th>arch</th><td>i686</td></tr>\n<tr><th>consul</th><td>0.5.0(386)</td></tr>\n<tr><th>IPaddr</th><td>192.168.0.10/24</td></tr>\n</table>\n\n## Intel Edison\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\n```text:Edison\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\nnmatsui@develop:~$ sudo screen /dev/ttyUSB0 115200\n\nPoky (Yocto Project Reference Distro) 1.6 edison ttyMFD2\n\nedison login: root\n[  126.834432] systemd-fsck[233]: /dev/mmcblk0p10: recovering journal\n[  126.881414] systemd-fsck[233]: /dev/mmcblk0p10: clean, 13/152608 files, 26868/610299 blocks\nroot@edison:~# \nroot@edison:~# reboot ota\nroot@edison:~# configure_edison --setup\n\nConfigure Edison: Device Password\nConfigure Edison: Device Name\nConfigure Edison: WiFi Connection\n\nroot@edison01:~# opkg update\nroot@edison01:~# opkg upgrade\n```\n## consul(linux 32bit)\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```text:consul\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nroot@edison01:~# mkdir -p /usr/local/bin\nroot@edison01:~# wget https://dl.bintray.com/mitchellh/consul/0.5.0_linux_386.zi\np -qO /tmp/consul_0.5.0_386.zip --no-check-certificate\nroot@edison01:~# unzip /tmp/consul_0.5.0_386.zip -d /usr/local/bin\nroot@edison01:~# chmod +x /usr/local/bin/consul\nroot@edison01:~# consul version\nConsul v0.5.0\nConsul Protocol: 2 (Understands back to: 1)\n```\n\n# consul\u30af\u30e9\u30b9\u30bf\u306e\u69cb\u7bc9\n\n## Ubuntu\u306econsul\u3092bootstrap\u3068\u3057\u3066\u8d77\u52d5\n\n```text:consul\u8d77\u52d5\nnmatsui@develop:~$ consul agent -data-dir /tmp -server -bootstrap-expect 2 &\n```\n\n## Intel Edison\u306econsul\u3092\u8d77\u52d5\u3057\u3066Ubuntu\u306bJOIN\n\n```text:consul\u8d77\u52d5\nroot@edison01:~# consul agent -data-dir /tmp -server -join 192.168.0.9 &\n```\n\n## consul\u30af\u30e9\u30b9\u30bf\u306e\u72b6\u614b\n\n```text:ubuntu\u304b\u3089\u30e1\u30f3\u30d0\u30fc\u78ba\u8a8d\nnmatsui@develop:~$ consul members\n    2015/04/29 09:32:19 [INFO] agent.rpc: Accepted client: 127.0.0.1:35648\nNode      Address            Status  Type    Build  Protocol\ndevelop   192.168.0.9:8301   alive   server  0.5.0  2\nedison01  192.168.0.10:8301  alive   server  0.5.0  2\n```\n\n```text:edison\u304b\u3089\u30e1\u30f3\u30d0\u30fc\u78ba\u8a8d\nroot@edison01:~# consul members\n    2015/04/29 00:40:35 [INFO] agent.rpc: Accepted client: 127.0.0.1:54706\nNode      Address            Status  Type    Build  Protocol\nedison01  192.168.0.10:8301  alive   server  0.5.0  2\ndevelop   192.168.0.9:8301   alive   server  0.5.0  2\n```\n\n## consul\u306b\u3088\u308b\u540d\u524d\u89e3\u6c7a\n\n```text:dig\u3067\u78ba\u8a8d\nnmatsui@develop:~$ dig @127.0.0.1 -p 8600 develop.node.consul ANY\n...\n;; ANSWER SECTION:\ndevelop.node.consul.\t0\tIN\tA\t192.168.0.9\n...\nnmatsui@develop:~$ dig @127.0.0.1 -p 8600 edison01.node.consul ANY\nedison01.node.consul.\t0\tIN\tA\t192.168.0.10\n...\n```\n\n```text:API\u3067\u78ba\u8a8d\nroot@edison01:~# curl localhost:8500/v1/catalog/nodes\n[{\"Node\":\"develop\",\"Address\":\"192.168.0.9\"},{\"Node\":\"edison01\",\"Address\":\"192.168.0.10\"}]\n```\n\n## KVS\u306e\u5229\u7528\n\nConsul KVS\u306b\u5024\uff08{'foo'=>'bar'}\uff09\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u3059\u3079\u3066\u306e\u30af\u30e9\u30b9\u30bf\u30e1\u30f3\u30d0\u30fc\u3067\u5171\u6709\u3055\u308c\u308b\u3002\n\uff08Consul KVS\u306b\u767b\u9332\u3055\u308c\u308b\u5024\u306fbase64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u306b\u6ce8\u610f\uff09\n\n```text:Edison\u304b\u3089KVS\u306b\u30ad\u30fc\u3068\u5024\u3092\u767b\u9332\nroot@edison01:~# curl -X PUT -d 'hello world' http://localhost:8500/v1/kv/hoge\ntrue\n```\n\n```text:KVS\u306e\u78ba\u8a8d\nroot@edison01:~# curl -s http://localhost:8500/v1/kv/hoge\n[{\"CreateIndex\":35,\"ModifyIndex\":35,\"LockIndex\":0,\"Key\":\"hoge\",\"Flags\":0,\"Value\":\"aGVsbG8gd29ybGQ=\"}]\nnmatsui@develop:~$ curl -s http://localhost:8500/v1/kv/hoge\n[{\"CreateIndex\":35,\"ModifyIndex\":35,\"LockIndex\":0,\"Key\":\"hoge\",\"Flags\":0,\"Value\":\"aGVsbG8gd29ybGQ=\"}]\n```\n\n```text:base64\u30c7\u30b3\u30fc\u30c9\u3057\u3066\u5024\u3092\u78ba\u8a8d\nnmatsui@develop:~$ curl -s http://localhost:8500/v1/kv/hoge | jq -r \".[0].Value\" | base64 -d\nhello world\n```\n\n# \u307e\u3068\u3081\n\u516c\u5f0f\u30b5\u30a4\u30c8\u304c\u914d\u5e03\u3057\u3066\u3044\u308b**32bit\u30d0\u30a4\u30ca\u30ea**\u3092\u914d\u7f6e\u3059\u308b\u3060\u3051\u3067Intel Edison\u4e0a\u3067consul\u304c\u52d5\u4f5c\u3057\u3001PC\u4e0a\u3067\u52d5\u4f5c\u3059\u308bconsul\u3068\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u3002\n\n\n", "tags": ["Edison", "Ubuntu15.04", "consul0.5.0"]}