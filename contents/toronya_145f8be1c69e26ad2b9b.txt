{"context": " More than 1 year has passed since last update.\n\n\u767a\u751f\u3057\u305f\u74b0\u5883\n\nBitnami Redmine Stack (Windows\u7248) 1.4 \u304b\u3089 3.1.1 \u3078\u306e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u5f8c\n\u901a\u5e38\u306eIssue\u4f5c\u6210\u3001\u95b2\u89a7\u306f\u554f\u984c\u306a\u3044\n\u30ab\u30b9\u30bf\u30e0\u30af\u30a8\u30ea\u3060\u3051 500 Internal Error\n\n\n\u539f\u56e0\n\nproduction.log \u306b\u3088\u308b\u3068VIEW\u306e\u8868\u793a\u3067 ASCII-8BIT \u304b\u3089 UTF-8 \u3078\u5909\u63db\u3067\u304d\u306a\u3044\u3068\u306e\u3053\u3068\u3002\n\n\nproduction.log\nStarted GET \"/redmine/projects/a/issues?query_id=1\" for 192.168.XX.XX at 2015-XX-XX XX:XX:XX +0900\nProcessing by IssuesController#index as HTML\n  Parameters: {\"query_id\"=>\"1\", \"project_id\"=>\"a\"}\n  Current user: User (id=1)\n  Rendered queries/_filters.html.erb (10.0ms)\n  Rendered issues/index.html.erb within layouts/base (16.0ms)\nCompleted 500 Internal Server Error in 261ms (ActiveRecord: 101.0ms)\n\nActionView::Template::Error (\"\\xE4\" from ASCII-8BIT to UTF-8):\n     7: $(document).ready(function(){\n     8:   initFilters();\n     9:   <% query.filters.each do |field, options| %>\n    10:   addFilter(\"<%= field %>\", <%= raw_json query.operator_for(field) %>, <%= raw_json query.values_for(field) %>);\n    11:   <% end %>\n    12: });\n    13: <% end %>\n  app/helpers/application_helper.rb:1076:in `raw_json'\n  app/views/queries/_filters.html.erb:10:in `block (2 levels) in _app_views_queries__filters_html_erb__85224075_77320944'\n  app/views/queries/_filters.html.erb:9:in `each'\n  app/views/queries/_filters.html.erb:9:in `block in _app_views_queries__filters_html_erb__85224075_77320944'\n  app/views/queries/_filters.html.erb:1:in `_app_views_queries__filters_html_erb__85224075_77320944'\n  app/views/issues/index.html.erb:19:in `block in _app_views_issues_index_html_erb___72240600_77564676'\n  app/views/issues/index.html.erb:11:in `_app_views_issues_index_html_erb___72240600_77564676'\n  app/controllers/issues_controller.rb:77:in `block (2 levels) in index'\n  app/controllers/issues_controller.rb:76:in `index'\n  lib/redmine/sudo_mode.rb:63:in `sudo_mode'\n\n\n\napp/helpers/application_helper.rb \u306b\u3042\u308b raw_json \u304c\u554f\u984c\u3092\u8d77\u3053\u3057\u3066\u3044\u308b\u69d8\u5b50\u3002\n\napp/helpers/application_helper.rb\n  # Helper to render JSON in views\n  def raw_json(arg)\n    arg.to_json.to_s.gsub('/', '\\/').html_safe\n  end\n\n\narg.inspect \u3057\u3066\u307f\u308b\u3068\u3061\u3083\u3093\u3068 UTF-8 \u3060\u3068\u5224\u5b9a\u3055\u308c\u305f\u308aASCII-8BIT (\u4f8b\u3048\u3070\"\\xE4\")\u3068\u5224\u5b9a\u3055\u308c\u305f\u308a\u6df7\u3056\u3063\u3066\u3044\u305f\u3002ruby\u3067\u306f\u300c\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u9055\u3046\u3082\u306e\u3069\u3046\u3057\u3092\u7d50\u5408\u3067\u304d\u306a\u3044\u300d\u3068\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002\n\n\u5bfe\u51e6\uff08\u3068\u308a\u3042\u3048\u305a\uff09\n\u547c\u3073\u51fa\u3057\u5143\u3067\u5bfe\u51e6\u3059\u308b\u304b\u3001\u3053\u306eraw_json\u3067\u5bfe\u5fdc\u3059\u3079\u304d\u304b\u6b63\u76f4\u8ff7\u3063\u305f\u306e\u3067\u3059\u304c\u3002\n\u6765\u305f\u3082\u306e\u3092\u7247\u3063\u7aef\u304b\u3089UTF-8\u306b\u3057\u3066\u3057\u307e\u3046\u3053\u3068\u3067\u9003\u3052\u308b\u3002\n\napp/helpers/application_helper.rb\n  # Helper to render JSON in views\n  def raw_json(arg)\n    arg = force_utf8_strings(arg)      # add\n    arg.to_json.to_s.gsub('/', '\\/').html_safe\n  end\n\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u672b\uff08Private \u30e1\u30bd\u30c3\u30c9\u306e\u4e26\u3073\uff09\n\napp/helpers/application_helper.rb\nprivate\n\n# (\u7565)\n\n# add\n  def force_utf8_strings(arg)\n    if arg.is_a?(String)\n      arg.dup.force_encoding('UTF-8')\n    elsif arg.is_a?(Array)\n      arg.map do |a|\n        force_utf8_strings(a)\n      end\n    elsif arg.is_a?(Hash)\n      arg = arg.dup\n      arg.each do |k,v|\n        arg[k] = force_utf8_strings(v)\n      end\n      arg\n    else\n      arg\n    end\n  end\n\n\n\u3053\u308c\u3067\u30a8\u30e9\u30fc\u306f\u51fa\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\u5b9f\u306f force_utf8_strings \u306f app/models/setting.rb \u306b\u3042\u308bPrivate\u30e1\u30bd\u30c3\u30c9\u3092\u30b3\u30d4\u30fc\u3057\u305f\u3082\u306e\u3002\n\u540c\u3058\u30b3\u30fc\u30c9\u304c\u4e8c\u7b87\u6240\u306b\u3042\u308b\u3053\u3068\u306b\u306a\u308b\u306e\u3067\u3001\u539f\u5247\u7684\u306b\u826f\u3044\u65b9\u6cd5\u3058\u3083\u306a\u3044\u3067\u3059\u3088\u306d\u30fb\u30fb\u30fb\u3002\n\u3053\u3046\u3044\u3063\u305f\u5834\u5408\u306f\u3069\u3053\u306b\u914d\u7f6e\u3059\u308b\u306e\u304c\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u3002\n# \u767a\u751f\u3057\u305f\u74b0\u5883\n- Bitnami Redmine Stack (Windows\u7248) 1.4 \u304b\u3089 3.1.1 \u3078\u306e\u30a2\u30c3\u30d7\u30b0\u30ec\u30fc\u30c9\u5f8c\n- \u901a\u5e38\u306eIssue\u4f5c\u6210\u3001\u95b2\u89a7\u306f\u554f\u984c\u306a\u3044\n- \u30ab\u30b9\u30bf\u30e0\u30af\u30a8\u30ea\u3060\u3051 500 Internal Error\n\n\n# \u539f\u56e0\n- production.log \u306b\u3088\u308b\u3068VIEW\u306e\u8868\u793a\u3067 ASCII-8BIT \u304b\u3089 UTF-8 \u3078\u5909\u63db\u3067\u304d\u306a\u3044\u3068\u306e\u3053\u3068\u3002\n\n```ruby:production.log\nStarted GET \"/redmine/projects/a/issues?query_id=1\" for 192.168.XX.XX at 2015-XX-XX XX:XX:XX +0900\nProcessing by IssuesController#index as HTML\n  Parameters: {\"query_id\"=>\"1\", \"project_id\"=>\"a\"}\n  Current user: User (id=1)\n  Rendered queries/_filters.html.erb (10.0ms)\n  Rendered issues/index.html.erb within layouts/base (16.0ms)\nCompleted 500 Internal Server Error in 261ms (ActiveRecord: 101.0ms)\n\nActionView::Template::Error (\"\\xE4\" from ASCII-8BIT to UTF-8):\n     7: $(document).ready(function(){\n     8:   initFilters();\n     9:   <% query.filters.each do |field, options| %>\n    10:   addFilter(\"<%= field %>\", <%= raw_json query.operator_for(field) %>, <%= raw_json query.values_for(field) %>);\n    11:   <% end %>\n    12: });\n    13: <% end %>\n  app/helpers/application_helper.rb:1076:in `raw_json'\n  app/views/queries/_filters.html.erb:10:in `block (2 levels) in _app_views_queries__filters_html_erb__85224075_77320944'\n  app/views/queries/_filters.html.erb:9:in `each'\n  app/views/queries/_filters.html.erb:9:in `block in _app_views_queries__filters_html_erb__85224075_77320944'\n  app/views/queries/_filters.html.erb:1:in `_app_views_queries__filters_html_erb__85224075_77320944'\n  app/views/issues/index.html.erb:19:in `block in _app_views_issues_index_html_erb___72240600_77564676'\n  app/views/issues/index.html.erb:11:in `_app_views_issues_index_html_erb___72240600_77564676'\n  app/controllers/issues_controller.rb:77:in `block (2 levels) in index'\n  app/controllers/issues_controller.rb:76:in `index'\n  lib/redmine/sudo_mode.rb:63:in `sudo_mode'\n\n```\n\napp/helpers/application_helper.rb \u306b\u3042\u308b raw_json \u304c\u554f\u984c\u3092\u8d77\u3053\u3057\u3066\u3044\u308b\u69d8\u5b50\u3002\n\n```ruby:app/helpers/application_helper.rb\n  # Helper to render JSON in views\n  def raw_json(arg)\n    arg.to_json.to_s.gsub('/', '\\/').html_safe\n  end\n```\n\n`arg.inspect` \u3057\u3066\u307f\u308b\u3068\u3061\u3083\u3093\u3068 UTF-8 \u3060\u3068\u5224\u5b9a\u3055\u308c\u305f\u308aASCII-8BIT (\u4f8b\u3048\u3070\"\\xE4\")\u3068\u5224\u5b9a\u3055\u308c\u305f\u308a\u6df7\u3056\u3063\u3066\u3044\u305f\u3002ruby\u3067\u306f\u300c\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u9055\u3046\u3082\u306e\u3069\u3046\u3057\u3092\u7d50\u5408\u3067\u304d\u306a\u3044\u300d\u3068\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u3002\n\n# \u5bfe\u51e6\uff08\u3068\u308a\u3042\u3048\u305a\uff09\n\u547c\u3073\u51fa\u3057\u5143\u3067\u5bfe\u51e6\u3059\u308b\u304b\u3001\u3053\u306eraw_json\u3067\u5bfe\u5fdc\u3059\u3079\u304d\u304b\u6b63\u76f4\u8ff7\u3063\u305f\u306e\u3067\u3059\u304c\u3002\n\u6765\u305f\u3082\u306e\u3092\u7247\u3063\u7aef\u304b\u3089UTF-8\u306b\u3057\u3066\u3057\u307e\u3046\u3053\u3068\u3067\u9003\u3052\u308b\u3002\n\n```ruby:app/helpers/application_helper.rb\n  # Helper to render JSON in views\n  def raw_json(arg)\n    arg = force_utf8_strings(arg)      # add\n    arg.to_json.to_s.gsub('/', '\\/').html_safe\n  end\n```\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u672b\uff08Private \u30e1\u30bd\u30c3\u30c9\u306e\u4e26\u3073\uff09\n\n```ruby:app/helpers/application_helper.rb\nprivate\n\n# (\u7565)\n\n# add\n  def force_utf8_strings(arg)\n    if arg.is_a?(String)\n      arg.dup.force_encoding('UTF-8')\n    elsif arg.is_a?(Array)\n      arg.map do |a|\n        force_utf8_strings(a)\n      end\n    elsif arg.is_a?(Hash)\n      arg = arg.dup\n      arg.each do |k,v|\n        arg[k] = force_utf8_strings(v)\n      end\n      arg\n    else\n      arg\n    end\n  end\n```\n\n\u3053\u308c\u3067\u30a8\u30e9\u30fc\u306f\u51fa\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\u5b9f\u306f force_utf8_strings \u306f app/models/setting.rb \u306b\u3042\u308bPrivate\u30e1\u30bd\u30c3\u30c9\u3092\u30b3\u30d4\u30fc\u3057\u305f\u3082\u306e\u3002\n\u540c\u3058\u30b3\u30fc\u30c9\u304c\u4e8c\u7b87\u6240\u306b\u3042\u308b\u3053\u3068\u306b\u306a\u308b\u306e\u3067\u3001\u539f\u5247\u7684\u306b\u826f\u3044\u65b9\u6cd5\u3058\u3083\u306a\u3044\u3067\u3059\u3088\u306d\u30fb\u30fb\u30fb\u3002\n\u3053\u3046\u3044\u3063\u305f\u5834\u5408\u306f\u3069\u3053\u306b\u914d\u7f6e\u3059\u308b\u306e\u304c\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u3002\n", "tags": ["Redmine", "3.1.1", "ASCII-8BIT", "UTF-8"]}