{"tags": ["FPGA", "Vivado", "Tcl"], "context": "\n\n\u306f\u3058\u3081\u306b\nXilinx \u793e\u306eFPGA\u958b\u767a\u74b0\u5883\u306e Vivado\u3001\u3044\u3061\u3044\u3061 GUI \u3067\u30de\u30a6\u30b9\u30dc\u30bf\u30f3\u3092\u30dd\u30c1\u30dd\u30c1\u3059\u308b\u306e\u306f\u9762\u5012\u3067\u3059\u3002\nVivado \u306f Tcl \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30d0\u30c3\u30c1\u51e6\u7406\u304c\u51fa\u6765\u308b\u306e\u3067\u3001\u6c7a\u307e\u308a\u5207\u3063\u305f\u4ed5\u4e8b\u306a\u3089 Tcl \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u3066\u51e6\u7406\u3055\u305b\u305f\u307b\u3046\u304c\u697d\u3067\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001Vivado \u3067\u65b0\u3057\u3044\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b Tcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n\u74b0\u5883\n\nXilinx Vivado 2015.4\nXilinx Vivado 2016.4\n\n\nTcl\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u8aac\u660e\n\n1 \u65b0\u3057\u3044\u7a7a\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\n\u307e\u305a\u307e\u3063\u3055\u3089\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u5909\u6570 project_name \u306b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3092\u3001\u5909\u6570 project_directory \u306b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u3053\u306e\u4f8b\u3067\u306f\u3001project_name \u306b \"project\" \u3092\u3001project_directory \u306bTcl\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\ncreate_project.tcl\nset project_directory   [file dirname [info script]]\nset project_name        \"project\"\n\ncreate_project -force $project_name $project_directory\n\n\ncreate_project \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306b -force \u3092\u4ed8\u3051\u3066\u3044\u308b\u306e\u3067\u3001\u3082\u3057\u3059\u3067\u306b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u5b58\u5728\u3057\u3066\u3044\u305f\u5834\u5408\u3001\u3059\u3067\u306b\u3042\u3063\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306f\u524a\u9664\u3055\u308c\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n2 \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8a2d\u5b9a\u3059\u308b\n\n2.1 \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u30dc\u30fc\u30c9\u307e\u305f\u306f\u30c7\u30d0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u30dc\u30fc\u30c9\u307e\u305f\u306f\u30c7\u30d0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u5909\u6570 board_part \u306b\u30dc\u30fc\u30c9\u306e\u540d\u524d\u3092\u8a2d\u5b9a\u3059\u308b\u304b\u3001\u5909\u6570 device_part \u306b\u30c7\u30d0\u30a4\u30b9\u540d\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u306e\u4f8b\u3067\u306f board_part \u306b Xilinx\u793e\u306eZC706\u8a55\u4fa1\u30dc\u30fc\u30c9\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\ncreate_project.tcl\nset board_part \"xilinx.com:zc706:part0:1.2\"\n\n\n\u3069\u306e\u3088\u3046\u306a\u30dc\u30fc\u30c9\u304c\u6307\u5b9a\u3067\u304d\u308b\u304b\u306f get_board_parts \u30b3\u30de\u30f3\u30c9\u3067\u8abf\u3079\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u307e\u305f\u3001\u6b21\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u4f7f\u3063\u3066\u6700\u65b0\u306e\u30dc\u30fc\u30c9\u60c5\u5831\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u304c\u51fa\u6765\u307e\u3059\u3002\n\ncreate_project.tcl\nset board_part [get_board_parts -quiet -latest_file_version \"*zc706*\"]\n\n\n\u5909\u6570 board_part \u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u305d\u3061\u3089\u3092\u512a\u5148\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\u3082\u3057\u5909\u6570 board_part \u3082 \u5909\u6570 device_part \u3082\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u5834\u5408\u306f\u30a8\u30e9\u30fc\u3067\u7d42\u4e86\u3057\u307e\u3059\u3002\n\ncreate_project.tcl\nif       {[info exists board_part ] && [string equal $board_part  \"\" ] == 0} {\n    set_property \"board_part\"     $board_part      [current_project]\n} elseif {[info exists device_part] && [string equal $device_part \"\" ] == 0} {\n    set_property \"part\"           $device_part     [current_project]\n} else {\n    puts \"ERROR: Please set board_part or device_part.\"\n    return 1\n}\n\n\n\n2.2 IP \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8a2d\u5b9a\u3059\u308b\n\u30e6\u30fc\u30b6\u30fc\u304c\u4f5c\u3063\u305f IP \u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3001IP\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u5909\u6570 ip_repo_path_list \u306b\u8ffd\u52a0\u3057\u305f IP \u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30ea\u30b9\u30c8\u5f62\u5f0f\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u306e\u4f8b\u3067\u306f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u540c\u3058\u968e\u5c64\u306b\u3042\u308b ip \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\ncreate_project.tcl\nlappend ip_repo_path_list   [file join $project_directory \"ip\"]\n\n\n\u5909\u6570 ip_repo_path_list \u304c\u5b58\u5728\u3057\u3001\u304b\u3064\u8981\u7d20\u3092\uff11\u4ee5\u4e0a\u6301\u3064\u30ea\u30b9\u30c8\u306e\u5834\u5408\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u5909\u6570 ip_repo_path_list \u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b IP \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\ncreate_project.tcl\nif {[info exists ip_repo_path_list] && [llength $ip_repo_path_list] > 0 } {\n    set_property ip_repo_paths $ip_repo_path_list [current_fileset]\n    update_ip_catalog\n}\n\n\n\n2.3 \u30c7\u30d5\u30a9\u30eb\u30c8\u30e9\u30a4\u30d6\u30e9\u30ea\u3084\u8a00\u8a9e\u306a\u3069\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8a2d\u5b9a\u3059\u308b\n\ncreate_project.tcl\nset_property \"default_lib\"        \"xil_defaultlib\" [current_project]\nset_property \"simulator_language\" \"Mixed\"          [current_project]\nset_property \"target_language\"    \"VHDL\"           [current_project]\n\n\n\n3\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u3092\u751f\u6210\u3059\u308b\nVivado \u3067\u306f\u5404\u7a2e\u5165\u529b\u30d5\u30a1\u30a4\u30eb(HDL\u3084\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306a\u3069)\u3092\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u3067\u7ba1\u7406\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u307e\u305a\u7a7a\u306e\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u751f\u6210\u3057\u307e\u3059\u3002\n\n3.1 \u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u3092\u751f\u6210\u3059\u308b\nHDL\u3084\u30d6\u30ed\u30c3\u30af\u30c7\u30b6\u30a4\u30f3\u306a\u3069\u8ad6\u7406\u5408\u6210\u53ef\u80fd\u306a\u5404\u7a2e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u3092\u65b0\u305f\u306b\u751f\u6210\u3057\u307e\u3059\u3002\n\ncreate_project.tcl\nif {[string equal [get_filesets -quiet sources_1] \"\"]} {\n    create_fileset -srcset sources_1\n}\n\n\n\n3.2 \u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u3092\u751f\u6210\u3059\u308b\n\u30bf\u30a4\u30df\u30f3\u30b0\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3084\u30d4\u30f3\u30a2\u30b5\u30a4\u30f3\u6307\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u3092\u65b0\u305f\u306b\u751f\u6210\u3057\u307e\u3059\u3002\n\ncreate_project.tcl\nif {[string equal [get_filesets -quiet constrs_1] \"\"]} {\n    create_fileset -constrset constrs_1\n}\n\n\n\n3.3 \u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sim_1 \u3092\u751f\u6210\u3059\u308b\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sim_1 \u3092\u65b0\u305f\u306b\u751f\u6210\u3057\u307e\u3059\u3002\u3053\u3053\u306b\u306f\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30c6\u30b9\u30c8\u30d9\u30f3\u30c1\u3084\u5404\u7a2e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u683c\u7d0d\u3057\u307e\u3059\u3002\n\ncreate_project.tcl\nif {[string equal [get_filesets -quiet sim_1] \"\"]} {\n    create_fileset -simset sim_1\n}\n\n\n\n4 Design Run \u3092\u751f\u6210\u3059\u308b\nVivado \u3067\u306f\u8ad6\u7406\u5408\u6210(Synthesis)\u3068\u914d\u7f6e\u914d\u7dda(Implementation)\u306e\u5404\u5de5\u7a0b\u3092 Design Run \u3068\u3044\u3046\u5358\u4f4d\u3067\u7ba1\u7406\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e Design Run \u6bce\u306b\u5404\u7a2e\u8a2d\u5b9a\u304a\u3088\u3073\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n4.1 Synthesis \u7528 Design Run synth_1 \u3092\u751f\u6210\u3059\u308b\n\u8ad6\u7406\u5408\u6210(Synthesis)\u7528\u306e Design Run synth_1 \u3092\u751f\u6210\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u8ad6\u7406\u5408\u6210\u6642\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u3069\u306e\u3088\u3046\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u308b\u304b\u306f\u30de\u30cb\u30e5\u30a2\u30eb\u306a\u3069\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002-constrset \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30013.2 \u3067\u751f\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u3068\u95a2\u9023\u3065\u3051\u3066\u3044\u307e\u3059\u3002\n\ncreate_project.tcl\nset synth_1_flow     \"Vivado Synthesis 2015\"\nset synth_1_strategy \"Vivado Synthesis Defaults\"\nif {[string equal [get_runs -quiet synth_1] \"\"]} {\n    create_run -name synth_1 -flow $synth_1_flow -strategy $synth_1_strategy -constrset constrs_1\n} else {\n    set_property flow     $synth_1_flow     [get_runs synth_1]\n    set_property strategy $synth_1_strategy [get_runs synth_1]\n}\ncurrent_run -synthesis [get_runs synth_1]\n\n\n\n4.2 Implementation \u7528 Design Run impl_1 \u3092\u751f\u6210\u3059\u308b\n\u914d\u7f6e\u914d\u7dda\u3084\u30d3\u30c3\u30c8\u30b9\u30c8\u30ea\u30fc\u30e0\u751f\u6210\u7528\u306e Design Run impl_1 \u3092\u751f\u6210\u3057\u307e\u3059\u3002-parent_run \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u8ad6\u7406\u5408\u6210(Synthesis)\u7528\u306e Design Run \u3068\u95a2\u9023\u3065\u3051\u3066\u3044\u307e\u3059\u3002-constrset \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30013.2 \u3067\u751f\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u3068\u95a2\u9023\u3065\u3051\u3066\u3044\u307e\u3059\u3002\n\ncreate_project.tcl\nset impl_1_flow      \"Vivado Implementation 2015\"\nset impl_1_strategy  \"Vivado Implementation Defaults\"\nif {[string equal [get_runs -quiet impl_1] \"\"]} {\n    create_run -name impl_1 -flow $impl_1_flow -strategy $impl_1_strategy -constrset constrs_1 -parent_run synth_1\n} else {\n    set_property flow     $impl_1_flow      [get_runs impl_1]\n    set_property strategy $impl_1_strategy  [get_runs impl_1]\n}\ncurrent_run -implementation [get_runs impl_1]\n\n\n\n5 \u5404\u7a2e\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\n\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u306b\u5404\u7a2e\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n5.1 constrs_1 \u306b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\n\u3053\u306e\u4f8b\u3067\u306f\u5909\u6570 design_timing_xdc_file \u306b\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u306b\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\ncreate_project.tcl\nif {[info exists design_timing_xdc_file]} {\n    add_files    -fileset constrs_1 -norecurse $design_timing_xdc_file\n}\n\n\n\n5.2 sources_1 \u306b Block Design \u3092\u8ffd\u52a0\u3059\u308b\n\u3053\u306e\u4f8b\u3067\u306f\u3001\u5909\u6570 design_bd_tcl_file \u306b\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u306b Block Design \u3092\u8ffd\u52a0\u3057\u3066\u3001\u3055\u3089\u306b\u30e9\u30c3\u30d1\u30fc\u30d5\u30a1\u30a4\u30eb\u3082\u751f\u6210\u3057\u307e\u3059\u3002\n\ncreate_project.tcl\nif {[info exists design_bd_tcl_file]} {\n    source $design_bd_tcl_file\n    regenerate_bd_layout\n    save_bd_design\n    set design_bd_name  [get_bd_designs]\n    make_wrapper -files [get_files $design_bd_name.bd] -top -import\n}\n\n\n\u3053\u3053\u3067 design_bd_tcl_file \u306fTcl\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002Vivado \u306b\u306f\u4e00\u5ea6 GUI \u3067\u4f5c\u6210\u3057\u305f Block Design \u3092 Tcl\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\u3059\u308b\u6a5f\u80fd\u304c\u3042\u308a\u307e\u3059\u3002\u5177\u4f53\u7684\u306b\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nVivado > Flow Navigator > Open Block Design\nVivado > File > Export > Export Block Design\n\n\u3053\u3053\u3067\u51fa\u529b\u3057\u305fTcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5909\u6570 design_bd_tcl_file \u306b\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n5.3 sources_1 \u306bVHDL\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u3002\nVHDL\u30d5\u30a1\u30a4\u30eb\u3092\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\nVHDL\u30d5\u30a1\u30a4\u30eb\u306f\u591a\u6570\u3042\u308b\u3053\u3068\u304c\u591a\u3044\u306e\u3067\u3001\u307e\u305a\u306f\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u305f\u3081\u306e\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3092\u5b9a\u7fa9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\ncreate_project.tcl\nproc add_vhdl_file {fileset_name library_name file_name} {\n    set file    [file normalize $file_name]\n    set fileset [get_filesets   $fileset_name] \n    add_files -norecurse -fileset $fileset $file\n    set file_obj [get_files -of_objects $fileset $file]\n    set_property \"file_type\" \"VHDL\"        $file_obj\n    set_property \"library\"   $library_name $file_obj\n}\n\n\n\u4e0a\u8a18\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3092\u4f7f\u3063\u3066\u3001\u8ffd\u52a0\u3057\u305f\u3044VHDL\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u6b21\u306e\u4f8b\u3067\u306f\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u306b../../src/main/vhdl/top.vhd\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\u30d5\u30a1\u30a4\u30eb\u540d\u306fTcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u306e\u76f8\u5bfe\u30d1\u30b9\u3067\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001WORK\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u5c5e\u3059\u308bVHDL\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3053\u3068\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\ncreate_project.tcl\nadd_vhdl_file sources_1 WORK ../../src/main/vhdl/top.vhd\n\n\n\u3053\u306e\u4f8b\u3067\u306fVHDL\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u540c\u69d8\u306e\u65b9\u6cd5\u3067Verilog\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3082\u51fa\u6765\u308b\u306f\u305a\u3067\u3059\u3002\n\nTcl\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\n\nVivado \u306e\u30d0\u30c3\u30c1\u30e2\u30fc\u30c9\u3067\u5b9f\u884c\u3059\u308b\nTcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092 Vivado \u306e\u30d0\u30c3\u30c1\u30e2\u30fc\u30c9\u3067\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nshell% cd project\nshell% vivado -mode batch -source create_project.tcl\n\n\nVivado \u306e GUI\u30e2\u30fc\u30c9\u304b\u3089\u5b9f\u884c\u3059\u308b\nTcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092 Vivado \u306eGUI\u30e2\u30fc\u30c9\u304b\u3089\u52d5\u304b\u3059\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nVivado > Tools > Run Tcl Script... > project/create_project.tcl\n\n\nTcl\u30b9\u30af\u30ea\u30d7\u30c8\u30b5\u30f3\u30d7\u30eb\nSynthesijer\u3067\u4f5c\u3063\u305f\u30e2\u30b8\u30e5\u30fc\u30eb\u3092MessagePack-RPC\u3067\u5236\u5fa1\u3059\u308b(ZYNQ\u8ad6\u7406\u5408\u6210\u7de8)\u3067\u4f7f\u3063\u305f create_project.tcl \u3092\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u793a\u3057\u307e\u3059\u3002\n\ncreate_project.tcl\n#\n# create_project.tcl  Tcl script for creating project\n#\nset     project_directory   [file dirname [info script]]\nset     project_name        \"project\"\nset     board_part          [get_board_parts -quiet -latest_file_version \"*zybo*\"]\nset     device_parts        \"xc7z010clg400-1\"\nset     design_bd_tcl_file  [file join $project_directory \"design_1_bd.tcl\"  ]\nset     design_pin_xdc_file [file join $project_directory \"design_1_pin.xdc\" ]\nlappend ip_repo_path_list   [file join $project_directory \"..\" \"..\" \"..\" \"..\" \"..\" \"..\" \"PTTY_AXI\" \"target\" \"xilinx\" \"ip\"]\nlappend ip_repo_path_list   [file join $project_directory \"..\" \"..\" \"..\" \"..\" \"..\" \"..\" \"LED_AXI\"  \"target\" \"xilinx\" \"ip\"]\nlappend ip_repo_path_list   [file join $project_directory \"..\" \"..\" \"ip\"]\n#\n# Create project\n#\ncreate_project -force $project_name $project_directory\n#\n# Set project properties\n#\nif       {[info exists board_part ] && [string equal $board_part  \"\" ] == 0} {\n    set_property \"board_part\"     $board_part      [current_project]\n} elseif {[info exists device_part] && [string equal $device_part \"\" ] == 0} {\n    set_property \"part\"           $device_part     [current_project]\n} else {\n    puts \"ERROR: Please set board_part or device_part.\"\n    return 1\n}\nset_property \"default_lib\"        \"xil_defaultlib\" [current_project]\nset_property \"simulator_language\" \"Mixed\"          [current_project]\nset_property \"target_language\"    \"VHDL\"           [current_project]\n#\n# Create fileset \"sources_1\"\n#\nif {[string equal [get_filesets -quiet sources_1] \"\"]} {\n    create_fileset -srcset sources_1\n}\n#\n# Create fileset \"constrs_1\"\n#\nif {[string equal [get_filesets -quiet constrs_1] \"\"]} {\n    create_fileset -constrset constrs_1\n}\n#\n# Create fileset \"sim_1\"\n#\nif {[string equal [get_filesets -quiet sim_1] \"\"]} {\n    create_fileset -simset sim_1\n}\n#\n# Create run \"synth_1\" and set property\n#\nset synth_1_flow     \"Vivado Synthesis 2015\"\nset synth_1_strategy \"Vivado Synthesis Defaults\"\nif {[string equal [get_runs -quiet synth_1] \"\"]} {\n    create_run -name synth_1 -flow $synth_1_flow -strategy $synth_1_strategy -constrset constrs_1\n} else {\n    set_property flow     $synth_1_flow     [get_runs synth_1]\n    set_property strategy $synth_1_strategy [get_runs synth_1]\n}\ncurrent_run -synthesis [get_runs synth_1]\n#\n# Create run \"impl_1\" and set property\n#\nset impl_1_flow      \"Vivado Implementation 2015\"\nset impl_1_strategy  \"Vivado Implementation Defaults\"\nif {[string equal [get_runs -quiet impl_1] \"\"]} {\n    create_run -name impl_1 -flow $impl_1_flow -strategy $impl_1_strategy -constrset constrs_1 -parent_run synth_1\n} else {\n    set_property flow     $impl_1_flow      [get_runs impl_1]\n    set_property strategy $impl_1_strategy  [get_runs impl_1]\n}\ncurrent_run -implementation [get_runs impl_1]\n#\n# Set IP Repository\n#\nif {[info exists ip_repo_path_list] && [llength $ip_repo_path_list] > 0 } {\n    set_property ip_repo_paths $ip_repo_path_list [current_fileset]\n    update_ip_catalog\n}\n#\n# Create block design\n#\nif {[info exists design_bd_tcl_file]} {\n    # \n    # Read block design file\n    #\n    source $design_bd_tcl_file\n    #\n    # Save block design\n    #\n    regenerate_bd_layout\n    save_bd_design\n    #\n    # Generate wrapper files\n    #\n    set design_bd_name  [get_bd_designs]\n    make_wrapper -files [get_files $design_bd_name.bd] -top -import\n}\n#\n# Import timing files\n#\nif {[info exists design_timing_xdc_file]} {\n    add_files    -fileset constrs_1 -norecurse $design_timing_xdc_file\n}\n#\n# Import pin files\n#\nif {[info exists design_pin_xdc_file]} {\n    add_files    -fileset constrs_1 -norecurse $design_pin_xdc_file\n}\n\n\n\n\n\u53c2\u8003\n\nVivado\u3092GUI\u3092\u4f7f\u308f\u305a\u306b\u5b9f\u884c\u3059\u308b\u305f\u3081\u306eTcl\u30b9\u30af\u30ea\u30d7\u30c8\u9054\n\n#\u306f\u3058\u3081\u306b\n\nXilinx \u793e\u306eFPGA\u958b\u767a\u74b0\u5883\u306e Vivado\u3001\u3044\u3061\u3044\u3061 GUI \u3067\u30de\u30a6\u30b9\u30dc\u30bf\u30f3\u3092\u30dd\u30c1\u30dd\u30c1\u3059\u308b\u306e\u306f\u9762\u5012\u3067\u3059\u3002\nVivado \u306f Tcl \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30d0\u30c3\u30c1\u51e6\u7406\u304c\u51fa\u6765\u308b\u306e\u3067\u3001\u6c7a\u307e\u308a\u5207\u3063\u305f\u4ed5\u4e8b\u306a\u3089 Tcl \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u3066\u51e6\u7406\u3055\u305b\u305f\u307b\u3046\u304c\u697d\u3067\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001Vivado \u3067\u65b0\u3057\u3044\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b Tcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002\n\n#\u74b0\u5883\n\n - Xilinx Vivado 2015.4\n - Xilinx Vivado 2016.4\n\n#Tcl\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u8aac\u660e\n\n##1 \u65b0\u3057\u3044\u7a7a\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308b\n\n\u307e\u305a\u307e\u3063\u3055\u3089\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u5909\u6570 project_name \u306b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3092\u3001\u5909\u6570 project_directory \u306b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u8a2d\u5b9a\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u3053\u306e\u4f8b\u3067\u306f\u3001project_name \u306b \"project\" \u3092\u3001project_directory \u306bTcl\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nset project_directory   [file dirname [info script]]\nset project_name        \"project\"\n\ncreate_project -force $project_name $project_directory\n````\n\ncreate_project \u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306b -force \u3092\u4ed8\u3051\u3066\u3044\u308b\u306e\u3067\u3001\u3082\u3057\u3059\u3067\u306b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u5b58\u5728\u3057\u3066\u3044\u305f\u5834\u5408\u3001\u3059\u3067\u306b\u3042\u3063\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306f\u524a\u9664\u3055\u308c\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n##2 \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8a2d\u5b9a\u3059\u308b\n\n###2.1 \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u30dc\u30fc\u30c9\u307e\u305f\u306f\u30c7\u30d0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u30dc\u30fc\u30c9\u307e\u305f\u306f\u30c7\u30d0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u5909\u6570 board_part \u306b\u30dc\u30fc\u30c9\u306e\u540d\u524d\u3092\u8a2d\u5b9a\u3059\u308b\u304b\u3001\u5909\u6570 device_part \u306b\u30c7\u30d0\u30a4\u30b9\u540d\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u306e\u4f8b\u3067\u306f board_part \u306b Xilinx\u793e\u306eZC706\u8a55\u4fa1\u30dc\u30fc\u30c9\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nset board_part \"xilinx.com:zc706:part0:1.2\"\n````\n\n\u3069\u306e\u3088\u3046\u306a\u30dc\u30fc\u30c9\u304c\u6307\u5b9a\u3067\u304d\u308b\u304b\u306f get_board_parts \u30b3\u30de\u30f3\u30c9\u3067\u8abf\u3079\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u307e\u305f\u3001\u6b21\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u4f7f\u3063\u3066\u6700\u65b0\u306e\u30dc\u30fc\u30c9\u60c5\u5831\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u304c\u51fa\u6765\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nset board_part [get_board_parts -quiet -latest_file_version \"*zc706*\"]\n````\n\n\u5909\u6570 board_part \u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u305d\u3061\u3089\u3092\u512a\u5148\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\u3082\u3057\u5909\u6570 board_part \u3082 \u5909\u6570 device_part \u3082\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u5834\u5408\u306f\u30a8\u30e9\u30fc\u3067\u7d42\u4e86\u3057\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nif       {[info exists board_part ] && [string equal $board_part  \"\" ] == 0} {\n    set_property \"board_part\"     $board_part      [current_project]\n} elseif {[info exists device_part] && [string equal $device_part \"\" ] == 0} {\n    set_property \"part\"           $device_part     [current_project]\n} else {\n    puts \"ERROR: Please set board_part or device_part.\"\n    return 1\n}\n````\n\n###2.2 IP \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8a2d\u5b9a\u3059\u308b\n\n\u30e6\u30fc\u30b6\u30fc\u304c\u4f5c\u3063\u305f IP \u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3001IP\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u5909\u6570 ip_repo_path_list \u306b\u8ffd\u52a0\u3057\u305f IP \u304c\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30ea\u30b9\u30c8\u5f62\u5f0f\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u306e\u4f8b\u3067\u306f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3068\u540c\u3058\u968e\u5c64\u306b\u3042\u308b ip \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nlappend ip_repo_path_list   [file join $project_directory \"ip\"]\n````\n\n\u5909\u6570 ip_repo_path_list \u304c\u5b58\u5728\u3057\u3001\u304b\u3064\u8981\u7d20\u3092\uff11\u4ee5\u4e0a\u6301\u3064\u30ea\u30b9\u30c8\u306e\u5834\u5408\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u5909\u6570 ip_repo_path_list \u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u308b IP \u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nif {[info exists ip_repo_path_list] && [llength $ip_repo_path_list] > 0 } {\n    set_property ip_repo_paths $ip_repo_path_list [current_fileset]\n    update_ip_catalog\n}\n````\n\n###2.3 \u30c7\u30d5\u30a9\u30eb\u30c8\u30e9\u30a4\u30d6\u30e9\u30ea\u3084\u8a00\u8a9e\u306a\u3069\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u8a2d\u5b9a\u3059\u308b\n\n````Tcl:create_project.tcl\nset_property \"default_lib\"        \"xil_defaultlib\" [current_project]\nset_property \"simulator_language\" \"Mixed\"          [current_project]\nset_property \"target_language\"    \"VHDL\"           [current_project]\n````\n\n##3\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u3092\u751f\u6210\u3059\u308b\n\nVivado \u3067\u306f\u5404\u7a2e\u5165\u529b\u30d5\u30a1\u30a4\u30eb(HDL\u3084\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306a\u3069)\u3092\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u3067\u7ba1\u7406\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u3053\u3067\u306f\u307e\u305a\u7a7a\u306e\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u3092\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u751f\u6210\u3057\u307e\u3059\u3002\n\n###3.1 \u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u3092\u751f\u6210\u3059\u308b\n\nHDL\u3084\u30d6\u30ed\u30c3\u30af\u30c7\u30b6\u30a4\u30f3\u306a\u3069\u8ad6\u7406\u5408\u6210\u53ef\u80fd\u306a\u5404\u7a2e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u3092\u65b0\u305f\u306b\u751f\u6210\u3057\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nif {[string equal [get_filesets -quiet sources_1] \"\"]} {\n    create_fileset -srcset sources_1\n}\n````\n\n###3.2 \u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u3092\u751f\u6210\u3059\u308b\n\n\u30bf\u30a4\u30df\u30f3\u30b0\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3084\u30d4\u30f3\u30a2\u30b5\u30a4\u30f3\u6307\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u3092\u65b0\u305f\u306b\u751f\u6210\u3057\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nif {[string equal [get_filesets -quiet constrs_1] \"\"]} {\n    create_fileset -constrset constrs_1\n}\n````\n\n###3.3 \u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sim_1 \u3092\u751f\u6210\u3059\u308b\n\n\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sim_1 \u3092\u65b0\u305f\u306b\u751f\u6210\u3057\u307e\u3059\u3002\u3053\u3053\u306b\u306f\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\u7528\u306e\u30c6\u30b9\u30c8\u30d9\u30f3\u30c1\u3084\u5404\u7a2e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u683c\u7d0d\u3057\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nif {[string equal [get_filesets -quiet sim_1] \"\"]} {\n    create_fileset -simset sim_1\n}\n````\n\n##4 Design Run \u3092\u751f\u6210\u3059\u308b\n\nVivado \u3067\u306f\u8ad6\u7406\u5408\u6210(Synthesis)\u3068\u914d\u7f6e\u914d\u7dda(Implementation)\u306e\u5404\u5de5\u7a0b\u3092 Design Run \u3068\u3044\u3046\u5358\u4f4d\u3067\u7ba1\u7406\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e Design Run \u6bce\u306b\u5404\u7a2e\u8a2d\u5b9a\u304a\u3088\u3073\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n###4.1 Synthesis \u7528 Design Run synth_1 \u3092\u751f\u6210\u3059\u308b\n\n\u8ad6\u7406\u5408\u6210(Synthesis)\u7528\u306e Design Run synth_1 \u3092\u751f\u6210\u3057\u307e\u3059\u3002\u3053\u3053\u3067\u8ad6\u7406\u5408\u6210\u6642\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u3069\u306e\u3088\u3046\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u308b\u304b\u306f\u30de\u30cb\u30e5\u30a2\u30eb\u306a\u3069\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002-constrset \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30013.2 \u3067\u751f\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u3068\u95a2\u9023\u3065\u3051\u3066\u3044\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nset synth_1_flow     \"Vivado Synthesis 2015\"\nset synth_1_strategy \"Vivado Synthesis Defaults\"\nif {[string equal [get_runs -quiet synth_1] \"\"]} {\n    create_run -name synth_1 -flow $synth_1_flow -strategy $synth_1_strategy -constrset constrs_1\n} else {\n    set_property flow     $synth_1_flow     [get_runs synth_1]\n    set_property strategy $synth_1_strategy [get_runs synth_1]\n}\ncurrent_run -synthesis [get_runs synth_1]\n````\n\n###4.2 Implementation \u7528 Design Run impl_1 \u3092\u751f\u6210\u3059\u308b\n\n\u914d\u7f6e\u914d\u7dda\u3084\u30d3\u30c3\u30c8\u30b9\u30c8\u30ea\u30fc\u30e0\u751f\u6210\u7528\u306e Design Run impl_1 \u3092\u751f\u6210\u3057\u307e\u3059\u3002-parent_run \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u8ad6\u7406\u5408\u6210(Synthesis)\u7528\u306e Design Run \u3068\u95a2\u9023\u3065\u3051\u3066\u3044\u307e\u3059\u3002-constrset \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u30013.2 \u3067\u751f\u6210\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u3068\u95a2\u9023\u3065\u3051\u3066\u3044\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nset impl_1_flow      \"Vivado Implementation 2015\"\nset impl_1_strategy  \"Vivado Implementation Defaults\"\nif {[string equal [get_runs -quiet impl_1] \"\"]} {\n    create_run -name impl_1 -flow $impl_1_flow -strategy $impl_1_strategy -constrset constrs_1 -parent_run synth_1\n} else {\n    set_property flow     $impl_1_flow      [get_runs impl_1]\n    set_property strategy $impl_1_strategy  [get_runs impl_1]\n}\ncurrent_run -implementation [get_runs impl_1]\n````\n\n##5 \u5404\u7a2e\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\n\n\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u306b\u5404\u7a2e\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n###5.1 constrs_1 \u306b\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\n\n\u3053\u306e\u4f8b\u3067\u306f\u5909\u6570 design_timing_xdc_file \u306b\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 constrs_1 \u306b\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nif {[info exists design_timing_xdc_file]} {\n    add_files    -fileset constrs_1 -norecurse $design_timing_xdc_file\n}\n````\n\n###5.2 sources_1 \u306b Block Design \u3092\u8ffd\u52a0\u3059\u308b\n\n\u3053\u306e\u4f8b\u3067\u306f\u3001\u5909\u6570 design_bd_tcl_file \u306b\u30d5\u30a1\u30a4\u30eb\u540d\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u305f\u5834\u5408\u3001\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u306b Block Design \u3092\u8ffd\u52a0\u3057\u3066\u3001\u3055\u3089\u306b\u30e9\u30c3\u30d1\u30fc\u30d5\u30a1\u30a4\u30eb\u3082\u751f\u6210\u3057\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nif {[info exists design_bd_tcl_file]} {\n    source $design_bd_tcl_file\n    regenerate_bd_layout\n    save_bd_design\n    set design_bd_name  [get_bd_designs]\n    make_wrapper -files [get_files $design_bd_name.bd] -top -import\n}\n````\n\n\u3053\u3053\u3067 design_bd_tcl_file \u306fTcl\u30b9\u30af\u30ea\u30d7\u30c8\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002Vivado \u306b\u306f\u4e00\u5ea6 GUI \u3067\u4f5c\u6210\u3057\u305f Block Design \u3092 Tcl\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b\u3059\u308b\u6a5f\u80fd\u304c\u3042\u308a\u307e\u3059\u3002\u5177\u4f53\u7684\u306b\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n````\nVivado > Flow Navigator > Open Block Design\nVivado > File > Export > Export Block Design\n````\n\n\u3053\u3053\u3067\u51fa\u529b\u3057\u305fTcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5909\u6570 design_bd_tcl_file \u306b\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\n###5.3 sources_1 \u306bVHDL\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\nVHDL\u30d5\u30a1\u30a4\u30eb\u3092\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\nVHDL\u30d5\u30a1\u30a4\u30eb\u306f\u591a\u6570\u3042\u308b\u3053\u3068\u304c\u591a\u3044\u306e\u3067\u3001\u307e\u305a\u306f\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8\u306b\u8ffd\u52a0\u3059\u308b\u305f\u3081\u306e\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3092\u5b9a\u7fa9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nproc add_vhdl_file {fileset_name library_name file_name} {\n    set file    [file normalize $file_name]\n    set fileset [get_filesets   $fileset_name] \n    add_files -norecurse -fileset $fileset $file\n    set file_obj [get_files -of_objects $fileset $file]\n    set_property \"file_type\" \"VHDL\"        $file_obj\n    set_property \"library\"   $library_name $file_obj\n}\n````\n\n\u4e0a\u8a18\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3092\u4f7f\u3063\u3066\u3001\u8ffd\u52a0\u3057\u305f\u3044VHDL\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u6b21\u306e\u4f8b\u3067\u306f\u30d5\u30a1\u30a4\u30eb\u30bb\u30c3\u30c8 sources_1 \u306b../../src/main/vhdl/top.vhd\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\u30d5\u30a1\u30a4\u30eb\u540d\u306fTcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304b\u3089\u306e\u76f8\u5bfe\u30d1\u30b9\u3067\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001WORK\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u5c5e\u3059\u308bVHDL\u30d5\u30a1\u30a4\u30eb\u3067\u3042\u308b\u3053\u3068\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\nadd_vhdl_file sources_1 WORK ../../src/main/vhdl/top.vhd\n````\n\n\u3053\u306e\u4f8b\u3067\u306fVHDL\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u65b9\u6cd5\u3092\u8aac\u660e\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u540c\u69d8\u306e\u65b9\u6cd5\u3067Verilog\u30d5\u30a1\u30a4\u30eb\u3092\u8ffd\u52a0\u3059\u308b\u3053\u3068\u3082\u51fa\u6765\u308b\u306f\u305a\u3067\u3059\u3002\n\n#Tcl\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5b9f\u884c\n\n## Vivado \u306e\u30d0\u30c3\u30c1\u30e2\u30fc\u30c9\u3067\u5b9f\u884c\u3059\u308b\n\nTcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092 Vivado \u306e\u30d0\u30c3\u30c1\u30e2\u30fc\u30c9\u3067\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n````\nshell% cd project\nshell% vivado -mode batch -source create_project.tcl\n````\n\n##Vivado \u306e GUI\u30e2\u30fc\u30c9\u304b\u3089\u5b9f\u884c\u3059\u308b\n\nTcl\u30b9\u30af\u30ea\u30d7\u30c8\u3092 Vivado \u306eGUI\u30e2\u30fc\u30c9\u304b\u3089\u52d5\u304b\u3059\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n````\nVivado > Tools > Run Tcl Script... > project/create_project.tcl\n````\n\n#Tcl\u30b9\u30af\u30ea\u30d7\u30c8\u30b5\u30f3\u30d7\u30eb\n\n[Synthesijer\u3067\u4f5c\u3063\u305f\u30e2\u30b8\u30e5\u30fc\u30eb\u3092MessagePack-RPC\u3067\u5236\u5fa1\u3059\u308b(ZYNQ\u8ad6\u7406\u5408\u6210\u7de8)](http://qiita.com/ikwzm/items/0254f1d49602095b5cde)\u3067\u4f7f\u3063\u305f create_project.tcl \u3092\u30b5\u30f3\u30d7\u30eb\u3068\u3057\u3066\u793a\u3057\u307e\u3059\u3002\n\n````Tcl:create_project.tcl\n#\n# create_project.tcl  Tcl script for creating project\n#\nset     project_directory   [file dirname [info script]]\nset     project_name        \"project\"\nset     board_part          [get_board_parts -quiet -latest_file_version \"*zybo*\"]\nset     device_parts        \"xc7z010clg400-1\"\nset     design_bd_tcl_file  [file join $project_directory \"design_1_bd.tcl\"  ]\nset     design_pin_xdc_file [file join $project_directory \"design_1_pin.xdc\" ]\nlappend ip_repo_path_list   [file join $project_directory \"..\" \"..\" \"..\" \"..\" \"..\" \"..\" \"PTTY_AXI\" \"target\" \"xilinx\" \"ip\"]\nlappend ip_repo_path_list   [file join $project_directory \"..\" \"..\" \"..\" \"..\" \"..\" \"..\" \"LED_AXI\"  \"target\" \"xilinx\" \"ip\"]\nlappend ip_repo_path_list   [file join $project_directory \"..\" \"..\" \"ip\"]\n#\n# Create project\n#\ncreate_project -force $project_name $project_directory\n#\n# Set project properties\n#\nif       {[info exists board_part ] && [string equal $board_part  \"\" ] == 0} {\n    set_property \"board_part\"     $board_part      [current_project]\n} elseif {[info exists device_part] && [string equal $device_part \"\" ] == 0} {\n    set_property \"part\"           $device_part     [current_project]\n} else {\n    puts \"ERROR: Please set board_part or device_part.\"\n    return 1\n}\nset_property \"default_lib\"        \"xil_defaultlib\" [current_project]\nset_property \"simulator_language\" \"Mixed\"          [current_project]\nset_property \"target_language\"    \"VHDL\"           [current_project]\n#\n# Create fileset \"sources_1\"\n#\nif {[string equal [get_filesets -quiet sources_1] \"\"]} {\n    create_fileset -srcset sources_1\n}\n#\n# Create fileset \"constrs_1\"\n#\nif {[string equal [get_filesets -quiet constrs_1] \"\"]} {\n    create_fileset -constrset constrs_1\n}\n#\n# Create fileset \"sim_1\"\n#\nif {[string equal [get_filesets -quiet sim_1] \"\"]} {\n    create_fileset -simset sim_1\n}\n#\n# Create run \"synth_1\" and set property\n#\nset synth_1_flow     \"Vivado Synthesis 2015\"\nset synth_1_strategy \"Vivado Synthesis Defaults\"\nif {[string equal [get_runs -quiet synth_1] \"\"]} {\n    create_run -name synth_1 -flow $synth_1_flow -strategy $synth_1_strategy -constrset constrs_1\n} else {\n    set_property flow     $synth_1_flow     [get_runs synth_1]\n    set_property strategy $synth_1_strategy [get_runs synth_1]\n}\ncurrent_run -synthesis [get_runs synth_1]\n#\n# Create run \"impl_1\" and set property\n#\nset impl_1_flow      \"Vivado Implementation 2015\"\nset impl_1_strategy  \"Vivado Implementation Defaults\"\nif {[string equal [get_runs -quiet impl_1] \"\"]} {\n    create_run -name impl_1 -flow $impl_1_flow -strategy $impl_1_strategy -constrset constrs_1 -parent_run synth_1\n} else {\n    set_property flow     $impl_1_flow      [get_runs impl_1]\n    set_property strategy $impl_1_strategy  [get_runs impl_1]\n}\ncurrent_run -implementation [get_runs impl_1]\n#\n# Set IP Repository\n#\nif {[info exists ip_repo_path_list] && [llength $ip_repo_path_list] > 0 } {\n    set_property ip_repo_paths $ip_repo_path_list [current_fileset]\n    update_ip_catalog\n}\n#\n# Create block design\n#\nif {[info exists design_bd_tcl_file]} {\n    # \n    # Read block design file\n    #\n    source $design_bd_tcl_file\n    #\n    # Save block design\n    #\n    regenerate_bd_layout\n    save_bd_design\n    #\n    # Generate wrapper files\n    #\n    set design_bd_name  [get_bd_designs]\n    make_wrapper -files [get_files $design_bd_name.bd] -top -import\n}\n#\n# Import timing files\n#\nif {[info exists design_timing_xdc_file]} {\n    add_files    -fileset constrs_1 -norecurse $design_timing_xdc_file\n}\n#\n# Import pin files\n#\nif {[info exists design_pin_xdc_file]} {\n    add_files    -fileset constrs_1 -norecurse $design_pin_xdc_file\n}\n\n````\n\n#\u53c2\u8003\n\n- [Vivado\u3092GUI\u3092\u4f7f\u308f\u305a\u306b\u5b9f\u884c\u3059\u308b\u305f\u3081\u306eTcl\u30b9\u30af\u30ea\u30d7\u30c8\u9054](http://qiita.com/ikwzm/items/a0120079d2f7f86a5904)\n\n\n"}