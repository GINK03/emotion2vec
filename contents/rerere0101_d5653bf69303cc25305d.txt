{"context": "\n\n\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u306e\u4ed5\u7d44\u307f\u3092\u5b9f\u88c5\n\u4ee5\u524d\u306e\u8a18\u4e8b\u3067\u6697\u53f7\u5316\u306e\u4ed5\u7d44\u307f\u3092\u7c21\u5358\u306b\u5b9f\u88c5\u3057\u305f\u306e\u3067\u4eca\u56de\u306f\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u3082\u5b9f\u88c5\u3057\u3066\u307f\u305f\u3002\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u306f\u7c21\u5358\u306b\u3044\u3046\u3068RSA\u79d8\u5bc6\u9375\u3092\u6301\u3063\u3066\u3044\u308b\u4eba\u304c\u9069\u5f53\u306a\u6587\u5b57\u5217\u3092\u9001\u308b\u6642\u3001\u9001\u308b\u6587\u5b57\u5217\u306e\u30cf\u30c3\u30b7\u30e5\u3092\u6697\u53f7\u5316\u3057\u3066\u30bb\u30c3\u30c8\u3067\u9001\u308b\u4ed5\u7d44\u307f\u3002\u305d\u306e\u6587\u7ae0\u3092\u3082\u3089\u3063\u305f\u4eba\u306f\u3001\u516c\u958b\u9375\u3092\u6301\u3063\u3066\u3044\u308c\u3070\u3001\u305d\u306e\u6697\u53f7\u6587\u304b\u3089\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u53d6\u308a\u51fa\u305b\u308b\u3002\u3055\u3089\u306b\u5143\u306e\u6587\u5b57\u5217\u304b\u3089\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\u3067\u304d\u308b\u306e\u3067\u3001\u3082\u3057\u3053\u306e\u6587\u7ae0\u304c\u6539\u3056\u3093\u3055\u308c\u3066\u3044\u306a\u3051\u308c\u3070\u3053\u308c\u3089\u306e\u4e8c\u3064\u306e\u30cf\u30c3\u30b7\u30e5\u306f\u540c\u3058\u5024\u306b\u306a\u308b\u306f\u305a\u3067\u3042\u308b\u3002\n\u8a73\u3057\u304f\u306f\u3053\u306e\u30b5\u30a4\u30c8\u306e\u56f3\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3046\u3002\u4eca\u56de\u306f\u4e00\u53f0\u306e\u30de\u30b7\u30f3\u3067\u3053\u306e\u6d41\u308c\u3092\u3084\u308b(\u3064\u3044\u3067\u306b\u6697\u53f7\u5316\u3082\u304a\u3055\u3089\u3044)\u3002\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\nruby\u3067\u7c21\u5358\u306b\u5b9f\u88c5\u3057\u305f\u3002\nrequire \"digest\"\n\u306b\u3088\u308a\u30cf\u30c3\u30b7\u30e5\u95a2\u6570Digest::MD5.hexdigest(\"Strings\")\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u305d\u308c\u3092\u5229\u7528\u3057\u3066\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\u3057\u305f\u3002\n\u4ee5\u4e0b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\nrsa_test2.rb\nrequire 'digest'\n\nclass MyRSA\n    @key = 0\n    Private_mode = 1\n    Public_mode = 0\n\n    def initialize(p, q)\n        @m = p * q\n        @l = (p - 1).lcm(q - 1)\n        @public = [*(2..@l)].each {|i| break i if (i.gcd(@l) == 1)}\n        @private = [*(2..@l)].each { |i| break i if ((@public * i) % @l == 1) }\n        @key = @private\n\n    end\n\n    def set_key(mode)\n        if mode == Public_mode then\n            @key = @public\n        elsif mode == Private_mode then\n            @key = @private\n        end\n    end\n\n    def rsa_encrypted(text)\n        text_array = text.codepoints\n        encrypted_array = text_array.map { |i| i ** @key % @m }\n        return encrypted_array\n    end\n\n    def rsa_decrypted(encrypted_array)\n        decoded_array = encrypted_array.map { |i| i ** @key % @m }\n        return decoded_array.map { |i| i.chr }.join\n\n    end\n\n    def create_signature(text)\n        md = Digest::MD5.hexdigest(text)\n        signature = rsa_encrypted(md)\n        return [text, signature]\n    end\n\n    def signature_check(text, signature)\n        if Digest::MD5.hexdigest(text) == rsa_decrypted(signature) then\n            return true\n        end\n            return false\n    end\n\nend\n\n\nPrivate_key_mode = 1\nPublic_key_mode = 0\n\nputs \"\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\\n\"\n#sender \u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u3059\u308b\u30de\u30b7\u30f3(\u79d8\u5bc6\u9375)\nkey = MyRSA.new(7, 19)\np text = \"I have a pen\" # \u5e73\u6587\nkey.set_key(Private_key_mode)\ndigital_signature = key.create_signature(text)\n\n\n#receiver \u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u3092\u53d7\u3051\u53d6\u308b\u30de\u30b7\u30f3(\u516c\u958b\u9375)\nkey.set_key(Public_key_mode)\np \"\u6539\u3056\u3093\u306a\u3057 (I have a pen)\"\np key.signature_check(digital_signature[0], digital_signature[1])\np \"\u6539\u3056\u3093\u3042\u308a (I have an apple)\"\np key.signature_check(\"I have an apple\", digital_signature[1])\n\nputs \"\\n\"\nputs \"\u6697\u53f7\u5316\\n\"\n#sender \u5e73\u6587\u306e\u6697\u53f7\u5316\u3092\u3059\u308b\u30de\u30b7\u30f3(\u516c\u958b\u9375)\np text = \"I have a pen\" # \u5e73\u6587\nkey.set_key(Public_key_mode)\nresult = key.rsa_encrypted(text)\np result\n\n#receiver \u6697\u53f7\u6587\u3092\u8907\u5408\u3057\u3066\u5e73\u6587\u3092\u53d6\u308a\u51fa\u3059\u30de\u30b7\u30f3(\u79d8\u5bc6\u9375)\nkey.set_key(Private_key_mode)\np key.rsa_decrypted(result)\n\n\n\u30af\u30e9\u30b9\u306f\nPrivate_key_mode = 1\nPublic_key_mode = 0\n\u3092\u95a2\u6570set_key(mode)\u306b\u5165\u529b\u3059\u308b\u3053\u3068\u3067\u6301\u3063\u3066\u3044\u308b\u306e\u304c\u79d8\u5bc6\u9375\u306a\u306e\u304b\u516c\u958b\u9375\u306a\u306e\u304b\u3092\u5207\u308a\u5206\u3051\u3066\u3044\u308b\u3002\u6697\u53f7\u5316\u306a\u3089\u3070\u516c\u958b\u9375\u3067\u6697\u53f7\u5316\u3057\u3066\u79d8\u5bc6\u9375\u3067\u5fa9\u53f7\u3060\u304b\u3089\u3000public_mode -> private_mode\u3001\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u306a\u3089\u3070\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3057\u3066\u516c\u958b\u9375\u3067\u5fa9\u53f7\u3060\u304b\u3089 private_mode -> public_mode\u3068\u3044\u3046\u611f\u3058\u3002signature_check\u306e\u8fd4\u308a\u5024\u306f\u516c\u958b\u9375\u306e\u30da\u30a2\u306e\u79d8\u5bc6\u9375\u3092\u6301\u3064\u76f8\u624b\u304b\u3064\u3001\u6539\u3056\u3093\u306e\u7591\u3044\u304c\u306a\u304b\u3063\u305f\u3089true, \u305d\u306e\u307b\u304b\u306ffalse\u3068\u306a\u308b\u4ed5\u7d44\u307f\u3002\n#\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u306e\u4ed5\u7d44\u307f\u3092\u5b9f\u88c5\n[\u4ee5\u524d\u306e\u8a18\u4e8b](http://qiita.com/rerere0101/items/07ded08cb673353c7cd4)\u3067\u6697\u53f7\u5316\u306e\u4ed5\u7d44\u307f\u3092\u7c21\u5358\u306b\u5b9f\u88c5\u3057\u305f\u306e\u3067\u4eca\u56de\u306f\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u3082\u5b9f\u88c5\u3057\u3066\u307f\u305f\u3002\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u306f\u7c21\u5358\u306b\u3044\u3046\u3068RSA\u79d8\u5bc6\u9375\u3092\u6301\u3063\u3066\u3044\u308b\u4eba\u304c\u9069\u5f53\u306a\u6587\u5b57\u5217\u3092\u9001\u308b\u6642\u3001\u9001\u308b\u6587\u5b57\u5217\u306e\u30cf\u30c3\u30b7\u30e5\u3092\u6697\u53f7\u5316\u3057\u3066\u30bb\u30c3\u30c8\u3067\u9001\u308b\u4ed5\u7d44\u307f\u3002\u305d\u306e\u6587\u7ae0\u3092\u3082\u3089\u3063\u305f\u4eba\u306f\u3001\u516c\u958b\u9375\u3092\u6301\u3063\u3066\u3044\u308c\u3070\u3001\u305d\u306e\u6697\u53f7\u6587\u304b\u3089\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u53d6\u308a\u51fa\u305b\u308b\u3002\u3055\u3089\u306b\u5143\u306e\u6587\u5b57\u5217\u304b\u3089\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\u3067\u304d\u308b\u306e\u3067\u3001\u3082\u3057\u3053\u306e\u6587\u7ae0\u304c\u6539\u3056\u3093\u3055\u308c\u3066\u3044\u306a\u3051\u308c\u3070\u3053\u308c\u3089\u306e\u4e8c\u3064\u306e\u30cf\u30c3\u30b7\u30e5\u306f\u540c\u3058\u5024\u306b\u306a\u308b\u306f\u305a\u3067\u3042\u308b\u3002\n\u8a73\u3057\u304f\u306f[\u3053\u306e\u30b5\u30a4\u30c8](http://itpro.nikkeibp.co.jp/article/COLUMN/20060704/242422/)\u306e\u56f3\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3046\u3002\u4eca\u56de\u306f\u4e00\u53f0\u306e\u30de\u30b7\u30f3\u3067\u3053\u306e\u6d41\u308c\u3092\u3084\u308b(\u3064\u3044\u3067\u306b\u6697\u53f7\u5316\u3082\u304a\u3055\u3089\u3044)\u3002\n\n#\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\nruby\u3067\u7c21\u5358\u306b\u5b9f\u88c5\u3057\u305f\u3002\n```require \"digest\" ```\n\u306b\u3088\u308a\u30cf\u30c3\u30b7\u30e5\u95a2\u6570```Digest::MD5.hexdigest(\"Strings\")```\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u306e\u3067\u305d\u308c\u3092\u5229\u7528\u3057\u3066\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u8a08\u7b97\u3057\u305f\u3002\n\u4ee5\u4e0b\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\n```ruby:rsa_test2.rb\nrequire 'digest'\n\nclass MyRSA\n\t@key = 0\n\tPrivate_mode = 1\n\tPublic_mode = 0\n\n\tdef initialize(p, q)\n\t\t@m = p * q\n\t\t@l = (p - 1).lcm(q - 1)\n\t\t@public = [*(2..@l)].each {|i| break i if (i.gcd(@l) == 1)}\n\t\t@private = [*(2..@l)].each { |i| break i if ((@public * i) % @l == 1) }\n\t\t@key = @private\n\n\tend\n\n\tdef set_key(mode)\n\t\tif mode == Public_mode then\n\t\t\t@key = @public\n\t\telsif mode == Private_mode then\n\t\t\t@key = @private\n\t\tend\n\tend\n\n\tdef rsa_encrypted(text)\n\t\ttext_array = text.codepoints\n\t\tencrypted_array = text_array.map { |i| i ** @key % @m }\n\t\treturn encrypted_array\n\tend\n\n\tdef rsa_decrypted(encrypted_array)\n\t\tdecoded_array = encrypted_array.map { |i| i ** @key % @m }\n\t\treturn decoded_array.map { |i| i.chr }.join\n\n\tend\n\n\tdef create_signature(text)\n\t\tmd = Digest::MD5.hexdigest(text)\n\t\tsignature = rsa_encrypted(md)\n\t\treturn [text, signature]\n\tend\n\n\tdef signature_check(text, signature)\n\t\tif Digest::MD5.hexdigest(text) == rsa_decrypted(signature) then\n\t\t\treturn true\n\t\tend\n\t\t\treturn false\n\tend\n\nend\n\n\nPrivate_key_mode = 1\nPublic_key_mode = 0\n\nputs \"\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\\n\"\n#sender \u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u3059\u308b\u30de\u30b7\u30f3(\u79d8\u5bc6\u9375)\nkey = MyRSA.new(7, 19)\np text = \"I have a pen\" # \u5e73\u6587\nkey.set_key(Private_key_mode)\ndigital_signature = key.create_signature(text)\n\n\n#receiver \u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u3092\u53d7\u3051\u53d6\u308b\u30de\u30b7\u30f3(\u516c\u958b\u9375)\nkey.set_key(Public_key_mode)\np \"\u6539\u3056\u3093\u306a\u3057 (I have a pen)\"\np key.signature_check(digital_signature[0], digital_signature[1])\np \"\u6539\u3056\u3093\u3042\u308a (I have an apple)\"\np key.signature_check(\"I have an apple\", digital_signature[1])\n\nputs \"\\n\"\nputs \"\u6697\u53f7\u5316\\n\"\n#sender \u5e73\u6587\u306e\u6697\u53f7\u5316\u3092\u3059\u308b\u30de\u30b7\u30f3(\u516c\u958b\u9375)\np text = \"I have a pen\" # \u5e73\u6587\nkey.set_key(Public_key_mode)\nresult = key.rsa_encrypted(text)\np result\n\n#receiver \u6697\u53f7\u6587\u3092\u8907\u5408\u3057\u3066\u5e73\u6587\u3092\u53d6\u308a\u51fa\u3059\u30de\u30b7\u30f3(\u79d8\u5bc6\u9375)\nkey.set_key(Private_key_mode)\np key.rsa_decrypted(result)\n```\n\n\n\u30af\u30e9\u30b9\u306f\n```Private_key_mode = 1\nPublic_key_mode = 0```\n\u3092\u95a2\u6570set_key(mode)\u306b\u5165\u529b\u3059\u308b\u3053\u3068\u3067\u6301\u3063\u3066\u3044\u308b\u306e\u304c\u79d8\u5bc6\u9375\u306a\u306e\u304b\u516c\u958b\u9375\u306a\u306e\u304b\u3092\u5207\u308a\u5206\u3051\u3066\u3044\u308b\u3002\u6697\u53f7\u5316\u306a\u3089\u3070\u516c\u958b\u9375\u3067\u6697\u53f7\u5316\u3057\u3066\u79d8\u5bc6\u9375\u3067\u5fa9\u53f7\u3060\u304b\u3089\u3000public_mode -> private_mode\u3001\u30c7\u30b8\u30bf\u30eb\u7f72\u540d\u306a\u3089\u3070\u79d8\u5bc6\u9375\u3067\u6697\u53f7\u5316\u3057\u3066\u516c\u958b\u9375\u3067\u5fa9\u53f7\u3060\u304b\u3089 private_mode -> public_mode\u3068\u3044\u3046\u611f\u3058\u3002signature_check\u306e\u8fd4\u308a\u5024\u306f\u516c\u958b\u9375\u306e\u30da\u30a2\u306e\u79d8\u5bc6\u9375\u3092\u6301\u3064\u76f8\u624b\u304b\u3064\u3001\u6539\u3056\u3093\u306e\u7591\u3044\u304c\u306a\u304b\u3063\u305f\u3089true, \u305d\u306e\u307b\u304b\u306ffalse\u3068\u306a\u308b\u4ed5\u7d44\u307f\u3002\n\n", "tags": ["Ruby", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3", "\u6697\u53f7\u5316", "\u30cd\u30c3\u30c8\u30ef\u30fc\u30af", "\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0"]}