{"tags": ["cakephp2.x", "ACL"], "context": " More than 1 year has passed since last update.\n\n\u958b\u767a\u74b0\u5883\nUbuntu Server 14.04.3 LTS\nCakePHP 2.7.6\n\ncomposer\u304c\u5c0e\u5165\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\nCakePHP\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f/dev\uff08\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\uff09/public_html/home/\u3068\u3044\u3046\u540d\u79f0\u3067\u8a2d\u7f6e\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n\n\u53c2\u8003\u306b\u3057\u305f\u30d6\u30ed\u30b0\n\u30a2\u30b7\u30a2\u30eb\u3055\u3093\u306e\u300cCakePHP2\u3067\u7c21\u5358\u306bACL\u3092\u4f7f\u3046\u65b9\u6cd5\u300d\nhttp://blog.asial.co.jp/1088\n\n\u4f5c\u696d\u306e\u9032\u3081\u65b9\n\u57fa\u672c\u7684\u306b\u4f5c\u696d\u5185\u5bb9\u306f\u30a2\u30b7\u30a2\u30eb\u3055\u3093\u306e\u30d6\u30ed\u30b0\u3092\u5f15\u7528\u3057\u307e\u3059\u3002\n\u6700\u65b0\u306eCake\u3067ACL\u306b\u89e6\u308c\u305f\u3044\u4eba\u306b\u53c2\u8003\u306b\u306a\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n\n(1)\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u6e96\u5099\u3068\u8a2d\u5b9a\n\n1. \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u8a2d\u7f6e\nAcl-master.zip\u3092\u3069\u3053\u304b\u3089\u304b\u63a2\u3057\u3066\u304d\u307e\u3059\u3002\n\u203b\u4e0a\u8a18\u306e\u3069\u3053\u304b\u3089\u304b\u306f\u3001\u5185\u5bb9\u3092\u4fdd\u8a3c\u3059\u308b\u3082\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u89e3\u51cd\u3059\u308b\u3068Acl-Master\u30d5\u30a9\u30eb\u30c0\u304c\u51fa\u6765\u308b\u306e\u3067Acl\u306b\u30ea\u30cd\u30fc\u30e0\u3057app/Plugin/Acl\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n2. admin\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b\n\u4ee5\u4e0b\u306e\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3057\u307e\u3059\u3002\n\napp/Config/core.php\n//Configure::write('Routing.prefixes', array('admin'));\n\n\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\napp/Config/bootstrap.php\nCakePlugin::load('Acl', array('bootstrap' => true));\n\n\n\n(2)\u30c6\u30fc\u30d6\u30eb\u306e\u4f5c\u6210\nphpmyadmin\u3042\u305f\u308a\u304b\u3089\u4f5c\u6210\u3059\u308b\u306e\u304c\u4fbf\u5229\u3067\u3059\u3002\u79c1\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7167\u5408\u9806\u5e8f\u3092utf8_general.ci\u306b\u8a2d\u5b9a\u3057\u307e\u3057\u305f\u3002\n\n1. ARO\uff08\u30ea\u30af\u30a8\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\u30c6\u30fc\u30d6\u30eb\u306e\u4f5c\u6210\n\nsql\nCREATE TABLE users (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(255) NOT NULL UNIQUE,\n    password CHAR(40) NOT NULL,\n    group_id INT(11) NOT NULL,\n    created DATETIME,\n    modified DATETIME\n);\nCREATE TABLE groups (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    created DATETIME,\n    modified DATETIME\n);\n\n\n\n2. ACO\uff08\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\u306e\u4f5c\u6210\n\nsql\nCREATE TABLE posts (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    user_id INT(11) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    body TEXT,\n    created DATETIME,\n    modified DATETIME\n);\nCREATE TABLE widgets (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    part_no VARCHAR(12),\n    quantity INT(11)\n);\n\n\n\n(3)\u7aef\u672b\u4e0a\u3067\u306e\u4f5c\u696d\n\n1. bake\u3059\u308b\n\ncmd\ncd public_html/home/app/Console\nphp cake.php bake all\n----------------------------------\nPossoble ~\n1. Group\n2. Post\n3. User\n4. Widget\n\n\n\u203b1\uff5e4\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\n\n2. ACL\u30c6\u30fc\u30d6\u30eb\u306e\u521d\u671f\u5316\n\ncmd\ncd public_htm1l/home/app/Console\nphp cake.php schema create DbAcl\n\n\n\u203b2\u56de\u306e\u554f\u3044\u5408\u308f\u305b\u3068\u3082y\u3068\u3057\u307e\u3059\n\n(4)\u30b0\u30eb\u30fc\u30d7\u3068\u30e6\u30fc\u30b6\u3092\u8ffd\u52a0\u3059\u308b\u305f\u3081\u306e\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3059\u308b\n\u4ee5\u4e0b\u3001\u307b\u307c\u30b3\u30d4\u30da\u3002\n\napp/Controller/UsersController.php\nApp::uses('AppController', 'Controller');\nclass UsersController extends AppController {\n    // \u3053\u3053\u304b\u3089\n    public function login() {\n        if ($this->request->is('post')) {\n            if ($this->Auth->login()) {\n                $this->redirect($this->Auth->redirect());\n            } else {\n                $this->Session->setFlash('Your username or password was incorrect.');\n            }\n        }\n    }\n    public function logout() {\n        //Leave empty for now.\n    }\n    // \u3053\u3053\u307e\u3067\n\n\n\napp/View/Users/login.ctp\n<?php\n    echo $this->Form->create('User', array('action' => 'login'));\n    echo $this->Form->inputs(array(\n        'legend' => __('Login'),\n        'username',\n        'password'\n    ));\n    echo $this->Form->end('Login');\n\n\n\napp/Model/User.php\n<?php\nApp::uses('AppModel', 'Model');\n// \u3053\u3053\u304b\u3089\nApp::uses('AuthComponent', 'Controller/Component');\n// \u3053\u3053\u307e\u3067\nclass User extends AppModel {\n    // \u3053\u3053\u304b\u3089\n    public function beforeSave($options = array()) {\n        $this->data['User']['password'] = AuthComponent::password($this->data['User']['password']);\n        return true;\n    }\n    // \u3053\u3053\u307e\u3067\n\n\n\napp/Controller/AppController.php\n<?php\n    App::uses('Controller', 'Controller');\n    class AppController extends Controller {\n        // \u3053\u3053\u304b\u3089\n        public $components = array(\n            'Acl',\n            'Auth' => array(\n                'authorize' => array(\n                    'Actions' => array('actionPath' => 'controllers')\n                )\n            ),\n            'Session'\n        );\n        public $helpers = array('Html', 'Form', 'Session');\n        public function beforeFilter() {\n            //Configure AuthComponent\n            $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login');\n            $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login');\n            $this->Auth->loginRedirect = array('controller' => 'posts', 'action' => 'add');\n        }\n        // \u3053\u3053\u307e\u3067\n    }\n\n\n\u203b\u3053\u3053\u307e\u3067\u3067\u3044\u3063\u305f\u3093\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3068\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n(5)\u30ea\u30af\u30a8\u30b9\u30bf\u3068\u3057\u3066\u30d3\u30d8\u30a4\u30d3\u30a2\u306b\u8a2d\u5b9a\n\napp/Model/User.php\n<?php\nApp::uses('AppModel', 'Model');\nApp::uses('AuthComponent', 'Controller/Component');\nclass User extends AppModel {\n    // \u3053\u3053\u304b\u3089\n    public $belongsTo = array('Group');\n    public $actsAs = array('Acl' => array('type' => 'requester'));\n    public function parentNode() {\n        if (!$this->id && empty($this->data)) {\n            return null;\n        }\n        if (isset($this->data['User']['group_id'])) {\n            $groupId = $this->data['User']['group_id'];\n        } else {\n            $groupId = $this->field('group_id');\n        }\n        if (!$groupId) {\n            return null;\n        } else {\n            return array('Group' => array('id' => $groupId));\n        }\n    }\n    // \u3053\u3053\u307e\u3067\n\n\n\u203b\u3053\u3053\u3067\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30a8\u30e9\u30fc\u8868\u793a\u3055\u308c\u307e\u3059\u3002\nError: Cannot redeclare User::$belongsTo\nFile: /home/dev/public_html/home/app/Model/User.php\nLine: 89\n\nbake\u3067\u4f5c\u6210\u3055\u308c\u305f$belongsTo\u30e1\u30bd\u30c3\u30c9\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3057\u3087\u3046\u3002\n/**\n * belongsTo associations\n *\n * @var array\n */\n/*\n    public $belongsTo = array(\n        'Group' => array(\n            'className' => 'Group',\n            'foreignKey' => 'group_id',\n            'conditions' => '',\n            'fields' => '',\n            'order' => ''\n        )\n    );\n*/\n\n\u203b\u4e0a\u8a18\u4f5c\u696d\u5f8c\u306b\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3068\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\napp/Model/Group.php\n<?php\nApp::uses('AppModel', 'Model');\nclass Group extends AppModel {\n    // \u3053\u3053\u304b\u3089\n    public $actsAs = array('Acl' => array('type' => 'requester'));\n    public function parentNode() {\n        return null;\n    }\n    // \u3053\u3053\u307e\u3067\n\n\n\n(6)\u4e00\u6642\u7684\u306a\u8a8d\u8a3c\u306e\u8a31\u53ef\n\u30db\u30fc\u30e0\u753b\u9762\u304b\u3089\u672a\u767b\u9332\u30e6\u30fc\u30b6\u30fc\u3092\u767b\u9332\u3059\u308b\u305f\u3081\u3001\u4e00\u6642\u7684\u306b\u8a8d\u8a3c\u306a\u3057\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u3092\u8a31\u53ef\u3057\u307e\u3059\u3002\n\napp/Controller/UsersController.php\n<?php\nApp::uses('AppController', 'Controller');\nclass UsersController extends AppController {\n    // \u3053\u3053\u304b\u3089\n    public function beforeFilter() {\n        parent::beforeFilter();\n        $this->Auth->allow();\n    }\n    // \u3053\u3053\u307e\u3067\n    public function login() {\n        if ($this->request->is('post')) {\n            if ($this->Auth->login()) {\n                $this->redirect($this->Auth->redirect());\n            } else {\n                $this->Session->setFlash('Your username or password was incorrect.');\n            }\n        }\n    }\n    public function logout() {\n        //Leave empty for now.\n    }\n\n\n\napp/Controller/GroupsController.php\n<?php\nApp::uses('AppController', 'Controller');\nclass GroupsController extends AppController {\n    // \u3053\u3053\u304b\u3089\n    public function beforeFilter() {\n        parent::beforeFilter();\n        $this->Auth->allow();\n    }\n    // \u3053\u3053\u307e\u3067\n\n\n\n(7)\u30db\u30fc\u30e0\u753b\u9762\u304b\u3089\u30e6\u30fc\u30b6\u30fc\u767b\u9332\n\u30a2\u30b7\u30a2\u30eb\u3055\u3093\u306e\u8a18\u4e8b\u3092\u5143\u306b\u4ee5\u4e0b\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\n\u30b0\u30eb\u30fc\u30d7\uff1aadministrators\u3001managers\u3001users\n\u30e6\u30fc\u30b6\u3000\uff1aadminuser\u3001manageuser\u3001useruser\n\u30b0\u30eb\u30fc\u30d7\u2192\u30e6\u30fc\u30b6\u30fc\u306e\u9806\u3067\u4f5c\u6210\u3057\u3066\u3044\u304d\u307e\u3059\u304c\u3001Submit\u3092\u62bc\u3059\u3068\u6b21\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\nError: Call to a member function success() on a non-object\nFile: /home/dev/public_html/home/app/Controller/GroupsController.php\nLine: 57\n\nFlash\u30b3\u30f3\u30dd\u30fc\u30f3\u30c8\u304c\u8aad\u307f\u8fbc\u307e\u308c\u3066\u3044\u306a\u3044\u30a8\u30e9\u30fc\u306a\u306e\u3067\u3001bake\u3067\u751f\u6210\u3055\u308c\u305f\u8a72\u5f53\u3057\u305d\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u306f\u3059\u3079\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8ffd\u52a0\u4fee\u6b63\u3057\u307e\u3059\u3002\npublic $components = array('Paginator', 'Flash');\n\n\u203b\u4f5c\u696d\u7d42\u4e86\u5f8c\u3001aros\u30c6\u30fc\u30d6\u30eb\u3092\u898b\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n1   NULL    Group   1   NULL    1   4\n2   NULL    Group   2   NULL    5   8\n3   NULL    Group   3   NULL    9   12\n4   1   User    1   NULL    2   3\n5   2   User    2   NULL    6   7\n6   3   User    3   NULL    10  11\n\n\n(8)\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5b9f\u884c\n~/admin/acl/\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\nCakePHP 2.7.6\u3067\u306f\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\nError: Class 'String' not found\nFile: /home/dev/public_html/home/app/Plugin/Acl/Controller/Component/AclReflectorComponent.php\nLine: 17\n\nString\u30af\u30e9\u30b9\u304c\u8aad\u307f\u8fbc\u307e\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u4ee5\u4e0b\u306eApp\u30af\u30e9\u30b9\u3092\u5ba3\u8a00\u3057\u307e\u3059\u3002\n\napp\\Plugin\\Acl\\Controller\\Component\\AclReflectorComponent.php\nApp::uses('String', 'Utility');\n\n\n\u300cMissing ACOs\u300d\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u753b\u9762\u4e0a\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u5217\u6319\u3055\u308c\u307e\u3059\u3002\nYou can update the ACOs by clicking on the following link : Synchronize ACOs\n\u3055\u3089\u306b\u300cSynchronize ACOs\u300d\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n<?php\nError: Acl.UsersController could not be found.\nError: Create the class UsersController below in file: /home/dev/public_html/home/app/Plugin/Acl/Controller/UsersController.php\nclass UsersController extends AclAppController {\n\n}\n\nAclAppController.php\u306bUsersController\u3078\u306e\u30a2\u30af\u30bb\u30b9\u6a29\uff08\u30e1\u30bd\u30c3\u30c9\uff09\u304c\u306a\u3044\u3068\u6012\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u8a72\u5f53\u306e\u30d5\u30a1\u30a4\u30eb\u3059\u3079\u3066\u306b\u5148\u307b\u3069\u3068\u540c\u3058\u3088\u3046\u306b\u4e00\u6642\u7684\u306b\u8a8d\u8a3c\u306a\u3057\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u3092\u8a31\u53ef\u3057\u307e\u3059\u3002\n\u3059\u3067\u306bbeforeFilter\u30e1\u30bd\u30c3\u30c9\u304c\u3042\u308b\u3082\u306e\u306f$this->Auth->allow();\u306e\u307f\u8ffd\u8a18\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n    public function beforeFilter() {\n        parent::beforeFilter();\n        $this->Auth->allow();\n    }\n\n\u300cThe Role model is not configured to act as an ACL requester\u300d\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\nbootstrap.php\u306eThe model name used for the user role (typically 'Role' or 'Group')\u3092'Group'\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\napp\\Plugin\\Acl\\Config\\bootstrap.php\nConfigure :: write('acl.aro.role.model', 'Group');\n\n\n\u3053\u308c\u3067\u3088\u3046\u3084\u304fACL\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u52d5\u4f5c\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n#\u958b\u767a\u74b0\u5883\nUbuntu Server 14.04.3 LTS\nCakePHP 2.7.6\n\n- composer\u304c\u5c0e\u5165\u3055\u308c\u3066\u3044\u308b\u3082\u306e\u3068\u3057\u307e\u3059\u3002\n- CakePHP\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f/dev\uff08\u30a2\u30ab\u30a6\u30f3\u30c8\u540d\uff09/public_html/home/\u3068\u3044\u3046\u540d\u79f0\u3067\u8a2d\u7f6e\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n#\u53c2\u8003\u306b\u3057\u305f\u30d6\u30ed\u30b0\n\u30a2\u30b7\u30a2\u30eb\u3055\u3093\u306e\u300cCakePHP2\u3067\u7c21\u5358\u306bACL\u3092\u4f7f\u3046\u65b9\u6cd5\u300d\nhttp://blog.asial.co.jp/1088\n\n#\u4f5c\u696d\u306e\u9032\u3081\u65b9\n\u57fa\u672c\u7684\u306b\u4f5c\u696d\u5185\u5bb9\u306f**\u30a2\u30b7\u30a2\u30eb\u3055\u3093\u306e\u30d6\u30ed\u30b0\u3092\u5f15\u7528**\u3057\u307e\u3059\u3002\n\u6700\u65b0\u306eCake\u3067ACL\u306b\u89e6\u308c\u305f\u3044\u4eba\u306b\u53c2\u8003\u306b\u306a\u308c\u3070\u5e78\u3044\u3067\u3059\u3002\n\n#(1)\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u6e96\u5099\u3068\u8a2d\u5b9a\n##1. \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u8a2d\u7f6e\nAcl-master.zip\u3092[\u3069\u3053\u304b\u3089](https://github.com/cakephp/acl)\u304b\u63a2\u3057\u3066\u304d\u307e\u3059\u3002\n\u203b\u4e0a\u8a18\u306e*\u3069\u3053\u304b\u3089*\u304b\u306f\u3001\u5185\u5bb9\u3092\u4fdd\u8a3c\u3059\u308b\u3082\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u89e3\u51cd\u3059\u308b\u3068Acl-Master\u30d5\u30a9\u30eb\u30c0\u304c\u51fa\u6765\u308b\u306e\u3067Acl\u306b\u30ea\u30cd\u30fc\u30e0\u3057app/Plugin/Acl\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n##2. admin\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3059\u308b\n\u4ee5\u4e0b\u306e\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u5916\u3057\u307e\u3059\u3002\n\n```app/Config/core.php\n//Configure::write('Routing.prefixes', array('admin'));\n```\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```app/Config/bootstrap.php\nCakePlugin::load('Acl', array('bootstrap' => true));\n```\n#(2)\u30c6\u30fc\u30d6\u30eb\u306e\u4f5c\u6210\n\nphpmyadmin\u3042\u305f\u308a\u304b\u3089\u4f5c\u6210\u3059\u308b\u306e\u304c\u4fbf\u5229\u3067\u3059\u3002\u79c1\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u7167\u5408\u9806\u5e8f\u3092utf8_general.ci\u306b\u8a2d\u5b9a\u3057\u307e\u3057\u305f\u3002\n\n##1. ARO\uff08\u30ea\u30af\u30a8\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\u30c6\u30fc\u30d6\u30eb\u306e\u4f5c\u6210\n```language:sql\nCREATE TABLE users (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(255) NOT NULL UNIQUE,\n    password CHAR(40) NOT NULL,\n    group_id INT(11) NOT NULL,\n    created DATETIME,\n    modified DATETIME\n);\nCREATE TABLE groups (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    created DATETIME,\n    modified DATETIME\n);\n```\n\n##2. ACO\uff08\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\u306e\u4f5c\u6210\n```language:sql\nCREATE TABLE posts (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    user_id INT(11) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    body TEXT,\n    created DATETIME,\n    modified DATETIME\n);\nCREATE TABLE widgets (\n    id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    part_no VARCHAR(12),\n    quantity INT(11)\n);\n```\n\n#(3)\u7aef\u672b\u4e0a\u3067\u306e\u4f5c\u696d\n\n##1. bake\u3059\u308b\n```language:cmd\ncd public_html/home/app/Console\nphp cake.php bake all\n----------------------------------\nPossoble ~\n1. Group\n2. Post\n3. User\n4. Widget\n```\n\u203b1\uff5e4\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\n\n##2. ACL\u30c6\u30fc\u30d6\u30eb\u306e\u521d\u671f\u5316\n\n```language:cmd\ncd public_htm1l/home/app/Console\nphp cake.php schema create DbAcl\n```\n\u203b2\u56de\u306e\u554f\u3044\u5408\u308f\u305b\u3068\u3082y\u3068\u3057\u307e\u3059\n\n#(4)\u30b0\u30eb\u30fc\u30d7\u3068\u30e6\u30fc\u30b6\u3092\u8ffd\u52a0\u3059\u308b\u305f\u3081\u306e\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3059\u308b\n\u4ee5\u4e0b\u3001\u307b\u307c\u30b3\u30d4\u30da\u3002\n\n```app/Controller/UsersController.php\nApp::uses('AppController', 'Controller');\nclass UsersController extends AppController {\n    // \u3053\u3053\u304b\u3089\n    public function login() {\n        if ($this->request->is('post')) {\n            if ($this->Auth->login()) {\n                $this->redirect($this->Auth->redirect());\n            } else {\n                $this->Session->setFlash('Your username or password was incorrect.');\n            }\n        }\n    }\n    public function logout() {\n        //Leave empty for now.\n    }\n    // \u3053\u3053\u307e\u3067\n```\n\n```app/View/Users/login.ctp\n<?php\n    echo $this->Form->create('User', array('action' => 'login'));\n    echo $this->Form->inputs(array(\n        'legend' => __('Login'),\n        'username',\n        'password'\n    ));\n    echo $this->Form->end('Login');\n```\n\n```app/Model/User.php\n<?php\nApp::uses('AppModel', 'Model');\n// \u3053\u3053\u304b\u3089\nApp::uses('AuthComponent', 'Controller/Component');\n// \u3053\u3053\u307e\u3067\nclass User extends AppModel {\n    // \u3053\u3053\u304b\u3089\n    public function beforeSave($options = array()) {\n        $this->data['User']['password'] = AuthComponent::password($this->data['User']['password']);\n        return true;\n    }\n    // \u3053\u3053\u307e\u3067\n```\n\n```app/Controller/AppController.php\n<?php\n    App::uses('Controller', 'Controller');\n    class AppController extends Controller {\n        // \u3053\u3053\u304b\u3089\n        public $components = array(\n            'Acl',\n            'Auth' => array(\n                'authorize' => array(\n                    'Actions' => array('actionPath' => 'controllers')\n                )\n            ),\n            'Session'\n        );\n        public $helpers = array('Html', 'Form', 'Session');\n        public function beforeFilter() {\n            //Configure AuthComponent\n            $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login');\n            $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login');\n            $this->Auth->loginRedirect = array('controller' => 'posts', 'action' => 'add');\n        }\n        // \u3053\u3053\u307e\u3067\n    }\n```\n\u203b\u3053\u3053\u307e\u3067\u3067\u3044\u3063\u305f\u3093\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3068\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n#(5)\u30ea\u30af\u30a8\u30b9\u30bf\u3068\u3057\u3066\u30d3\u30d8\u30a4\u30d3\u30a2\u306b\u8a2d\u5b9a\n\n```app/Model/User.php\n<?php\nApp::uses('AppModel', 'Model');\nApp::uses('AuthComponent', 'Controller/Component');\nclass User extends AppModel {\n    // \u3053\u3053\u304b\u3089\n    public $belongsTo = array('Group');\n    public $actsAs = array('Acl' => array('type' => 'requester'));\n    public function parentNode() {\n        if (!$this->id && empty($this->data)) {\n            return null;\n        }\n        if (isset($this->data['User']['group_id'])) {\n            $groupId = $this->data['User']['group_id'];\n        } else {\n            $groupId = $this->field('group_id');\n        }\n        if (!$groupId) {\n            return null;\n        } else {\n            return array('Group' => array('id' => $groupId));\n        }\n    }\n    // \u3053\u3053\u307e\u3067\n```\n\u203b\u3053\u3053\u3067\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30a8\u30e9\u30fc\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```\nError: Cannot redeclare User::$belongsTo\nFile: /home/dev/public_html/home/app/Model/User.php\nLine: 89\n```\n\nbake\u3067\u4f5c\u6210\u3055\u308c\u305f$belongsTo\u30e1\u30bd\u30c3\u30c9\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u307e\u3057\u3087\u3046\u3002\n\n```php\n/**\n * belongsTo associations\n *\n * @var array\n */\n/*\n\tpublic $belongsTo = array(\n\t\t'Group' => array(\n\t\t\t'className' => 'Group',\n\t\t\t'foreignKey' => 'group_id',\n\t\t\t'conditions' => '',\n\t\t\t'fields' => '',\n\t\t\t'order' => ''\n\t\t)\n\t);\n*/\n```\n\n\u203b\u4e0a\u8a18\u4f5c\u696d\u5f8c\u306b\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u307f\u308b\u3068\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```app/Model/Group.php\n<?php\nApp::uses('AppModel', 'Model');\nclass Group extends AppModel {\n    // \u3053\u3053\u304b\u3089\n    public $actsAs = array('Acl' => array('type' => 'requester'));\n    public function parentNode() {\n        return null;\n    }\n    // \u3053\u3053\u307e\u3067\n```\n\n#(6)\u4e00\u6642\u7684\u306a\u8a8d\u8a3c\u306e\u8a31\u53ef\n\n\u30db\u30fc\u30e0\u753b\u9762\u304b\u3089\u672a\u767b\u9332\u30e6\u30fc\u30b6\u30fc\u3092\u767b\u9332\u3059\u308b\u305f\u3081\u3001\u4e00\u6642\u7684\u306b\u8a8d\u8a3c\u306a\u3057\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u3092\u8a31\u53ef\u3057\u307e\u3059\u3002\n\n```app/Controller/UsersController.php\n<?php\nApp::uses('AppController', 'Controller');\nclass UsersController extends AppController {\n    // \u3053\u3053\u304b\u3089\n    public function beforeFilter() {\n        parent::beforeFilter();\n        $this->Auth->allow();\n    }\n    // \u3053\u3053\u307e\u3067\n    public function login() {\n        if ($this->request->is('post')) {\n            if ($this->Auth->login()) {\n                $this->redirect($this->Auth->redirect());\n            } else {\n                $this->Session->setFlash('Your username or password was incorrect.');\n            }\n        }\n    }\n    public function logout() {\n        //Leave empty for now.\n    }\n```\n\n```app/Controller/GroupsController.php\n<?php\nApp::uses('AppController', 'Controller');\nclass GroupsController extends AppController {\n    // \u3053\u3053\u304b\u3089\n    public function beforeFilter() {\n        parent::beforeFilter();\n        $this->Auth->allow();\n    }\n    // \u3053\u3053\u307e\u3067\n```\n\n#(7)\u30db\u30fc\u30e0\u753b\u9762\u304b\u3089\u30e6\u30fc\u30b6\u30fc\u767b\u9332\n\u30a2\u30b7\u30a2\u30eb\u3055\u3093\u306e\u8a18\u4e8b\u3092\u5143\u306b\u4ee5\u4e0b\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\n\u30b0\u30eb\u30fc\u30d7\uff1aadministrators\u3001managers\u3001users\n\u30e6\u30fc\u30b6\u3000\uff1aadminuser\u3001manageuser\u3001useruser\n\n\u30b0\u30eb\u30fc\u30d7\u2192\u30e6\u30fc\u30b6\u30fc\u306e\u9806\u3067\u4f5c\u6210\u3057\u3066\u3044\u304d\u307e\u3059\u304c\u3001Submit\u3092\u62bc\u3059\u3068\u6b21\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```\nError: Call to a member function success() on a non-object\nFile: /home/dev/public_html/home/app/Controller/GroupsController.php\nLine: 57\n```\n\nFlash\u30b3\u30f3\u30dd\u30fc\u30f3\u30c8\u304c\u8aad\u307f\u8fbc\u307e\u308c\u3066\u3044\u306a\u3044\u30a8\u30e9\u30fc\u306a\u306e\u3067\u3001bake\u3067\u751f\u6210\u3055\u308c\u305f\u8a72\u5f53\u3057\u305d\u3046\u306a\u30d5\u30a1\u30a4\u30eb\u306f\u3059\u3079\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8ffd\u52a0\u4fee\u6b63\u3057\u307e\u3059\u3002\n\n```php\npublic $components = array('Paginator', 'Flash');\n```\n\n\u203b\u4f5c\u696d\u7d42\u4e86\u5f8c\u3001aros\u30c6\u30fc\u30d6\u30eb\u3092\u898b\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```cmd\n1 \tNULL\tGroup \t1 \tNULL\t1 \t4\n2 \tNULL\tGroup \t2 \tNULL\t5 \t8\n3 \tNULL\tGroup \t3 \tNULL\t9 \t12\n4 \t1 \tUser \t1 \tNULL\t2 \t3\n5 \t2 \tUser \t2 \tNULL\t6 \t7\n6 \t3 \tUser \t3 \tNULL\t10 \t11\n```\n\n#(8)\u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5b9f\u884c\n~/admin/acl/\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\nCakePHP 2.7.6\u3067\u306f\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3057\u305f\u3002\n\n```\nError: Class 'String' not found\nFile: /home/dev/public_html/home/app/Plugin/Acl/Controller/Component/AclReflectorComponent.php\nLine: 17\n```\n\nString\u30af\u30e9\u30b9\u304c\u8aad\u307f\u8fbc\u307e\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u4ee5\u4e0b\u306eApp\u30af\u30e9\u30b9\u3092\u5ba3\u8a00\u3057\u307e\u3059\u3002\n\n```app\\Plugin\\Acl\\Controller\\Component\\AclReflectorComponent.php\nApp::uses('String', 'Utility');\n```\n\u300cMissing ACOs\u300d\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u753b\u9762\u4e0a\u306b\u30d5\u30a1\u30a4\u30eb\u304c\u5217\u6319\u3055\u308c\u307e\u3059\u3002\nYou can update the ACOs by clicking on the following link : Synchronize ACOs\n\u3055\u3089\u306b\u300cSynchronize ACOs\u300d\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u30a8\u30e9\u30fc\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```\n<?php\nError: Acl.UsersController could not be found.\nError: Create the class UsersController below in file: /home/dev/public_html/home/app/Plugin/Acl/Controller/UsersController.php\nclass UsersController extends AclAppController {\n\n}\n```\n\nAclAppController.php\u306bUsersController\u3078\u306e\u30a2\u30af\u30bb\u30b9\u6a29\uff08\u30e1\u30bd\u30c3\u30c9\uff09\u304c\u306a\u3044\u3068\u6012\u3089\u308c\u3066\u3044\u307e\u3059\u3002\n\u8a72\u5f53\u306e\u30d5\u30a1\u30a4\u30eb\u3059\u3079\u3066\u306b\u5148\u307b\u3069\u3068\u540c\u3058\u3088\u3046\u306b\u4e00\u6642\u7684\u306b\u8a8d\u8a3c\u306a\u3057\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u3092\u8a31\u53ef\u3057\u307e\u3059\u3002\n\u3059\u3067\u306bbeforeFilter\u30e1\u30bd\u30c3\u30c9\u304c\u3042\u308b\u3082\u306e\u306f$this->Auth->allow();\u306e\u307f\u8ffd\u8a18\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```php\n    public function beforeFilter() {\n        parent::beforeFilter();\n        $this->Auth->allow();\n    }\n```\n\n\u300cThe Role model is not configured to act as an ACL requester\u300d\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\nbootstrap.php\u306eThe model name used for the user role (typically 'Role' or 'Group')\u3092'Group'\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```app\\Plugin\\Acl\\Config\\bootstrap.php\nConfigure :: write('acl.aro.role.model', 'Group');\n```\n\n\u3053\u308c\u3067\u3088\u3046\u3084\u304fACL\u30d7\u30e9\u30b0\u30a4\u30f3\u304c\u52d5\u4f5c\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n![cake-acl.jpg](https://qiita-image-store.s3.amazonaws.com/0/98753/80b0e9b2-6e0c-2ba0-d67d-9024f0f67caa.jpeg)\n\n\n\n\n\n"}