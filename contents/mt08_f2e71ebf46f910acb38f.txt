{"context": "\n\n\u6982\u8981\n\nRaspberryPi3\u3067\u306f\u3001USB\u30b9\u30c8\u30fc\u30ec\u30b8\u304b\u3089\u8d77\u52d5\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3089\u3057\u304f\u3001\u305d\u306e\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306e\u5bfe\u5fdc\u3057\u305f\u3089\u3057\u3044(\u307e\u3060\u30d9\u30fc\u30bf\u6271\u3044)\u3002\n\u30bd\u30fc\u30b9\n\n\n\nRASPBERRY PI BLOG:: PI 3 BOOTING PART I: USB MASS STORAGE BOOT BETA\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8d77\u52d5\u306e\u8aac\u660e\u3092\u3042\u3057\u305f\u3059\u308b\u3001\u3068\u306e\u3053\u3068\u3002(stay tuned for the next part on booting over Ethernet tomorrow)\nHOW TO BOOT FROM A USB MASS STORAGE DEVICE ON A RASPBERRY PI 3\n\n\n\u3042\u3001\u307b\u3093\u3068\u306b\u3001\u8d77\u52d5\u3057\u305f..\n\n\n\u74b0\u5883\n\nRaspberry Pi 3 \n2016-05-27-raspbian-jessie-lite.img\nUSB\u30b9\u30c8\u30ec\u30fc\u30b8(USB\u306eSD\u30ab\u30fc\u30c9\u30ea\u30fc\u30c0\u306bmicroSD..\u610f\u5473\u3042\u308b\u306e\u304b?!)\n\n\n\u624b\u9806\n\n\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306e\u66f4\u65b0\u30fb\u8a2d\u5b9a (microSD\u306b\u3066)\n\n\u307e\u305a\u306f\u901a\u5e38\u901a\u308a\u306b\u3001microSD\u306b\u3001Raspbian\u3092\u66f8\u304d\u8fbc\u3093\u3067\u4f5c\u696d\u306f\u3058\u3081\u308b\n\n# APT\u30ec\u30dd\u30b8\u30c8\u30ea\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u66f4\u65b0.\nsudo apt-get update\n#\n# Raspbian lite\u3067\u306f\u3001rpi-update\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb.\nsudo apt-get install rpi-update -y\n#\n# 'next'\u30d6\u30e9\u30f3\u30c1\u304b\u3089\u3001\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u7b49\u3005\u3001\u66f4\u65b0.\nsudo BRANCH=next rpi-update\n# \u4eca\u56de\u4f7f\u7528\u3057\u305f\u3082\u306e\n# > *** If no errors appeared, your firmware was successfully updated to 193f081a0ed502b62483aa707a79cf245db9b028\n#\n# USB\u30d6\u30fc\u30c8\u30e2\u30fc\u30c9\u3092\u6709\u52b9\u306b.\necho program_usb_boot_mode=1 | sudo tee -a /boot/config.txt\n#\n# \u73fe\u5728\u306e otp\u306e\u5024\u3092\u78ba\u8a8d.\nvcgencmd otp_dump | grep 17:\n# > 17:1020000a\n#\n# \u518d\u8d77\u52d5\nsudo reboot\n#\n# otp\u306e\u5024\u3092\u78ba\u8a8d\nvcgencmd otp_dump | grep 17:\n# > 17:3020000a \u3068\u306a\u3063\u3066\u3044\u308c\u3070OK\n\n\nUSB\u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u6e96\u5099\n\n\nUSB\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u3089\u305a\u3071\u3044\u306b\u633f\u3059 ( => /dev/sda \u306b\u306a\u308b\u306f\u305a)\npi@raspberrypi:~ $ ls -l /dev/sda\nls: cannot access /dev/sda: No such file or directory\npi@raspberrypi:~ $ ls -l /dev/sda\nbrw------- 1 root root 8, 0 Aug  4 19:57 /dev/sda\npi@raspberrypi:~ $ \n\n\n\nsudo parted /dev/sda\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210\n\nparted\u306b\u6253\u3064\u30b3\u30de\u30f3\u30c9\nmktable msdos\nYes\nmkpart primary fat32 0% 100M\nmkpart primary ext4 100M 100%\nprint\nquit\n\n\n\n\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d5\u30a9\u30fc\u30de\u30c3\u30c8(mkfs)\n\nmkfs\nsudo mkfs.vfat -n BOOT -F 32 /dev/sda1\nsudo mkfs.ext4 /dev/sda2\n\n\n\n\n\u5b9f\u884c\u4f8b\n\nparted\u3068mkfs(\u30d5\u30a9\u30fc\u30de\u30c3\u30c8)\u306e\u5b9f\u884c\u4f8b\npi@raspberrypi:~ $ sudo parted /dev/sda\nGNU Parted 3.2\nUsing /dev/sda\nWelcome to GNU Parted! Type 'help' to view a list of commands.\n(parted) mktable msdos                                                    \nWarning: The existing disk label on /dev/sda will be destroyed and all data on this disk will be lost. Do you want to continue?\nYes/No? Yes                                                               \n(parted) mkpart primary fat32 0% 100M                                     \n(parted) mkpart primary ext4 100M 100%                                    \n(parted) print                                                            \nModel: Generic STORAGE DEVICE (scsi)\nDisk /dev/sda: 3905MB\nSector size (logical/physical): 512B/512B\nPartition Table: msdos\nDisk Flags: \n\nNumber  Start   End     Size    Type     File system  Flags\n 1      1049kB  99.6MB  98.6MB  primary  fat32        lba\n 2      99.6MB  3905MB  3805MB  primary  ext4         lba\n\n(parted) quit                                                             \nInformation: You may need to update /etc/fstab.\n\npi@raspberrypi:~ $ sudo mkfs.vfat -n BOOT -F 32 /dev/sda1       \nmkfs.fat 3.0.27 (2014-11-12)\npi@raspberrypi:~ $ sudo mkfs.ext4 /dev/sda2\nmke2fs 1.42.12 (29-Aug-2014)\nCreating filesystem with 929024 4k blocks and 232464 inodes\nFilesystem UUID: 2cf0a8cc-917b-4bb5-9e37-982695d7c4e6\nSuperblock backups stored on blocks: \n    32768, 98304, 163840, 229376, 294912, 819200, 884736\n\nAllocating group tables: done                            \nWriting inode tables: done                            \nCreating journal (16384 blocks): done\nWriting superblocks and filesystem accounting information: done \n\npi@raspberrypi:~ $ \n\n\n\n\n\u4eca\u4f7f\u3063\u3066\u308bRaspbian\u306e\u30b7\u30b9\u30c6\u30e0\u3092USB\u3078\u30b3\u30d4\u30fc\n\n\u4eca\u4f7f\u3063\u3066\u308bRaspbian\u306e\u30b7\u30b9\u30c6\u30e0\u3092USB\u3078\u30b3\u30d4\u30fc.\nsudo mkdir /mnt/target\nsudo mount /dev/sda2 /mnt/target/\nsudo mkdir /mnt/target/boot\nsudo mount /dev/sda1 /mnt/target/boot/\nsudo apt-get update; sudo apt-get install rsync\nsudo rsync -ax --progress / /boot /mnt/target\n\n\n\n\u6642\u9593\u3092\u8a08\u3063\u3066\u307f\u305f\u3089\n# Raspbian Lite\u306b\u3066\u3002\nreal    6m57.916s\nuser    0m23.290s\nsys 0m26.180s\n\n\n\n\nssh\u30db\u30b9\u30c8\u30ad\u30fc\u306e\u518d\u751f\u6210\n\nssh\u30db\u30b9\u30c8\u30ad\u30fc\u306e\u518d\u751f\u6210.\ncd /mnt/target\nsudo mount --bind /dev dev\nsudo mount --bind /sys sys\nsudo mount --bind /proc proc\nsudo chroot /mnt/target\nrm /etc/ssh/ssh_host*\ndpkg-reconfigure openssh-server\nexit\nsudo umount dev\nsudo umount sys\nsudo umount proc\n\n\n\n\n/boot/cmdline.txt\u3068/etc/fstab\u306e\u7de8\u96c6\n\nmmcblk0p => sda \u307f\u305f\u3044\u306b\u3059\u308b\n\nsudo sed -i \"s,root=/dev/mmcblk0p2,root=/dev/sda2,\" /mnt/target/boot/cmdline.txt\nsudo sed -i \"s,/dev/mmcblk0p,/dev/sda,\" /mnt/target/etc/fstab\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u30a2\u30f3\u30de\u30a6\u30f3\u30c8\u3057\u3066\u3001\u3089\u305a\u3071\u3044\u96fb\u6e90\u30aa\u30d5. (\u3061\u3083\u3093\u3068\u30aa\u30d5\u306b\u306a\u308b\u306e\u3092\u5f85\u3064\u3088\u3046\u306b)\ncd ~\nsudo umount /mnt/target/boot \nsudo umount /mnt/target\nsudo poweroff \n\n\n\nUSB\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8d77\u52d5\n\n\u96fb\u6e90\u3092\u629c\u3044\u3066\u3001\nSD\u30ab\u30fc\u30c9\u3092\u629c\u3044\u3066\u3001\n\u96fb\u6e90\u3092\u3055\u3059\u3002\n=> \u3059\u3079\u3066\u304c\u3046\u307e\u304f\u884c\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001Pi\u304c\u6570\u79d2\u5f8c\u306b\u8d77\u52d5\u3092\u958b\u59cb\u3059\u308b\u306f\u305a\u3060\u3002\n\n\n\n\n\u305d\u306e\u4ed6\n\nqiitapoi@twitter\u306b\u3066\n\n## \u6982\u8981\n- RaspberryPi3\u3067\u306f\u3001USB\u30b9\u30c8\u30fc\u30ec\u30b8\u304b\u3089\u8d77\u52d5\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3089\u3057\u304f\u3001\u305d\u306e\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306e\u5bfe\u5fdc\u3057\u305f\u3089\u3057\u3044(\u307e\u3060\u30d9\u30fc\u30bf\u6271\u3044)\u3002\n- \u30bd\u30fc\u30b9\n    - [RASPBERRY PI BLOG:: PI 3 BOOTING PART I: USB MASS STORAGE BOOT BETA](https://www.raspberrypi.org/blog/pi-3-booting-part-i-usb-mass-storage-boot/)\n<br>\\# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u8d77\u52d5\u306e\u8aac\u660e\u3092\u3042\u3057\u305f\u3059\u308b\u3001\u3068\u306e\u3053\u3068\u3002(stay tuned for the next part on booting over Ethernet tomorrow)\n    - [HOW TO BOOT FROM A USB MASS STORAGE DEVICE ON A RASPBERRY PI 3](https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/msd.md)\n- \u3042\u3001\u307b\u3093\u3068\u306b\u3001\u8d77\u52d5\u3057\u305f..\n\n## \u74b0\u5883\n- Raspberry Pi 3 \n- `2016-05-27-raspbian-jessie-lite.img`\n- USB\u30b9\u30c8\u30ec\u30fc\u30b8(USB\u306eSD\u30ab\u30fc\u30c9\u30ea\u30fc\u30c0\u306bmicroSD..\u610f\u5473\u3042\u308b\u306e\u304b?!)\n\n## \u624b\u9806\n\n### \u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306e\u66f4\u65b0\u30fb\u8a2d\u5b9a (**microSD**\u306b\u3066)\n- <font color='red'>\u307e\u305a\u306f\u901a\u5e38\u901a\u308a\u306b\u3001microSD\u306b\u3001Raspbian\u3092\u66f8\u304d\u8fbc\u3093\u3067\u4f5c\u696d\u306f\u3058\u3081\u308b</font>\n\n```bash\n# APT\u30ec\u30dd\u30b8\u30c8\u30ea\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u66f4\u65b0.\nsudo apt-get update\n#\n# Raspbian lite\u3067\u306f\u3001rpi-update\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb.\nsudo apt-get install rpi-update -y\n#\n# 'next'\u30d6\u30e9\u30f3\u30c1\u304b\u3089\u3001\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u7b49\u3005\u3001\u66f4\u65b0.\nsudo BRANCH=next rpi-update\n# \u4eca\u56de\u4f7f\u7528\u3057\u305f\u3082\u306e\n# > *** If no errors appeared, your firmware was successfully updated to 193f081a0ed502b62483aa707a79cf245db9b028\n#\n# USB\u30d6\u30fc\u30c8\u30e2\u30fc\u30c9\u3092\u6709\u52b9\u306b.\necho program_usb_boot_mode=1 | sudo tee -a /boot/config.txt\n#\n# \u73fe\u5728\u306e otp\u306e\u5024\u3092\u78ba\u8a8d.\nvcgencmd otp_dump | grep 17:\n# > 17:1020000a\n#\n# \u518d\u8d77\u52d5\nsudo reboot\n#\n# otp\u306e\u5024\u3092\u78ba\u8a8d\nvcgencmd otp_dump | grep 17:\n# > 17:3020000a \u3068\u306a\u3063\u3066\u3044\u308c\u3070OK\n```\n\n\n### USB\u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u6e96\u5099\n1. USB\u30b9\u30c8\u30ec\u30fc\u30b8\u3092\u3089\u305a\u3071\u3044\u306b\u633f\u3059 ( => `/dev/sda` \u306b\u306a\u308b\u306f\u305a)\n\n    ```shell-session\npi@raspberrypi:~ $ ls -l /dev/sda\nls: cannot access /dev/sda: No such file or directory\npi@raspberrypi:~ $ ls -l /dev/sda\nbrw------- 1 root root 8, 0 Aug  4 19:57 /dev/sda\npi@raspberrypi:~ $ \n```\n\n2. `sudo parted /dev/sda`<br>\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210\n\n    ```txt:parted\u306b\u6253\u3064\u30b3\u30de\u30f3\u30c9\nmktable msdos\nYes\nmkpart primary fat32 0% 100M\nmkpart primary ext4 100M 100%\nprint\nquit\n```\n\n3. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d5\u30a9\u30fc\u30de\u30c3\u30c8(mkfs)\n\n    ```bash:mkfs\nsudo mkfs.vfat -n BOOT -F 32 /dev/sda1\nsudo mkfs.ext4 /dev/sda2\n```\n\n4. \u5b9f\u884c\u4f8b\n\n    ```shell-session:parted\u3068mkfs(\u30d5\u30a9\u30fc\u30de\u30c3\u30c8)\u306e\u5b9f\u884c\u4f8b\npi@raspberrypi:~ $ sudo parted /dev/sda\nGNU Parted 3.2\nUsing /dev/sda\nWelcome to GNU Parted! Type 'help' to view a list of commands.\n(parted) mktable msdos                                                    \nWarning: The existing disk label on /dev/sda will be destroyed and all data on this disk will be lost. Do you want to continue?\nYes/No? Yes                                                               \n(parted) mkpart primary fat32 0% 100M                                     \n(parted) mkpart primary ext4 100M 100%                                    \n(parted) print                                                            \nModel: Generic STORAGE DEVICE (scsi)\nDisk /dev/sda: 3905MB\nSector size (logical/physical): 512B/512B\nPartition Table: msdos\nDisk Flags: \n\n    Number  Start   End     Size    Type     File system  Flags\n     1      1049kB  99.6MB  98.6MB  primary  fat32        lba\n     2      99.6MB  3905MB  3805MB  primary  ext4         lba\n\n    (parted) quit                                                             \nInformation: You may need to update /etc/fstab.\n\n    pi@raspberrypi:~ $ sudo mkfs.vfat -n BOOT -F 32 /dev/sda1       \nmkfs.fat 3.0.27 (2014-11-12)\npi@raspberrypi:~ $ sudo mkfs.ext4 /dev/sda2\nmke2fs 1.42.12 (29-Aug-2014)\nCreating filesystem with 929024 4k blocks and 232464 inodes\nFilesystem UUID: 2cf0a8cc-917b-4bb5-9e37-982695d7c4e6\nSuperblock backups stored on blocks: \n    \t32768, 98304, 163840, 229376, 294912, 819200, 884736\n\n    Allocating group tables: done                            \nWriting inode tables: done                            \nCreating journal (16384 blocks): done\nWriting superblocks and filesystem accounting information: done \n\n    pi@raspberrypi:~ $ \n```\n\n\n5. \u4eca\u4f7f\u3063\u3066\u308bRaspbian\u306e\u30b7\u30b9\u30c6\u30e0\u3092USB\u3078\u30b3\u30d4\u30fc\n\n    ```bash:\u4eca\u4f7f\u3063\u3066\u308bRaspbian\u306e\u30b7\u30b9\u30c6\u30e0\u3092USB\u3078\u30b3\u30d4\u30fc.\nsudo mkdir /mnt/target\nsudo mount /dev/sda2 /mnt/target/\nsudo mkdir /mnt/target/boot\nsudo mount /dev/sda1 /mnt/target/boot/\nsudo apt-get update; sudo apt-get install rsync\nsudo rsync -ax --progress / /boot /mnt/target\n```\n\n    ```txt:\u6642\u9593\u3092\u8a08\u3063\u3066\u307f\u305f\u3089\n# Raspbian Lite\u306b\u3066\u3002\nreal\t6m57.916s\nuser\t0m23.290s\nsys\t0m26.180s\n```\n\n\n6. ssh\u30db\u30b9\u30c8\u30ad\u30fc\u306e\u518d\u751f\u6210\n\n    ```bash:ssh\u30db\u30b9\u30c8\u30ad\u30fc\u306e\u518d\u751f\u6210.\ncd /mnt/target\nsudo mount --bind /dev dev\nsudo mount --bind /sys sys\nsudo mount --bind /proc proc\nsudo chroot /mnt/target\nrm /etc/ssh/ssh_host*\ndpkg-reconfigure openssh-server\nexit\nsudo umount dev\nsudo umount sys\nsudo umount proc\n```\n\n\n7. `/boot/cmdline.txt`\u3068`/etc/fstab`\u306e\u7de8\u96c6\n    - mmcblk0p => sda \u307f\u305f\u3044\u306b\u3059\u308b\n\n    ```bash\nsudo sed -i \"s,root=/dev/mmcblk0p2,root=/dev/sda2,\" /mnt/target/boot/cmdline.txt\nsudo sed -i \"s,/dev/mmcblk0p,/dev/sda,\" /mnt/target/etc/fstab\n```\n\n8. \u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306e\u30a2\u30f3\u30de\u30a6\u30f3\u30c8\u3057\u3066\u3001\u3089\u305a\u3071\u3044\u96fb\u6e90\u30aa\u30d5. (\u3061\u3083\u3093\u3068\u30aa\u30d5\u306b\u306a\u308b\u306e\u3092\u5f85\u3064\u3088\u3046\u306b)\n\n    ```bash\ncd ~\nsudo umount /mnt/target/boot \nsudo umount /mnt/target\nsudo poweroff \n```\n\n9. USB\u30b9\u30c8\u30ec\u30fc\u30b8\u3067\u8d77\u52d5\n    - \u96fb\u6e90\u3092\u629c\u3044\u3066\u3001\n    - SD\u30ab\u30fc\u30c9\u3092\u629c\u3044\u3066\u3001\n    - \u96fb\u6e90\u3092\u3055\u3059\u3002\n    - => \u3059\u3079\u3066\u304c\u3046\u307e\u304f\u884c\u3063\u3066\u3044\u308b\u5834\u5408\u306f\u3001Pi\u304c\u6570\u79d2\u5f8c\u306b\u8d77\u52d5\u3092\u958b\u59cb\u3059\u308b\u306f\u305a\u3060\u3002\n\n\n\n## \u305d\u306e\u4ed6\n- [qiitapoi@twitter\u306b\u3066](https://twitter.com/qiitapoi/status/761404408173244416)\n\n<!-- https://twitter.com/dexdev/status/776713696391245824 -->\n", "tags": ["RaspberryPi", "raspbian"]}