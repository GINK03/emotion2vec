{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u6a5f\u68b0\u5b66\u7fd2\u3092\u5b66\u3076\u7b2c\u4e00\u6b69\u3068\u3057\u3066\u5b9a\u756a\u306eCoursera\u306eMachine Learning\u30b3\u30fc\u30b9\uff08Stanford\u3001Andrew Ng\u5148\u751f\uff09\u3002\u3053\u306e\u30b3\u30fc\u30b9\u306eMatlab/Octave\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8ab2\u984c\u3092Python\u3067\u5b9f\u88c5\u3059\u308b\u30b7\u30ea\u30fc\u30ba\u3002\n\u4eca\u56de\u306fex-7 \u6559\u5e2b\u306a\u3057\u5b66\u7fd2\u306e\u5f8c\u534a\u3001\u4e3b\u6210\u5206\u5206\u6790(Principal Component Analysis, PCA)\u3092\u3084\u308a\u307e\u3059\u3002\n\n\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\n\u5404\u7a2e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u307e\u3059\u3002\nimport numpy as np\nimport scipy.io as scio\nimport matplotlib.pyplot as plt\nfrom sklearn import decomposition\n\n\n\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u30fb\u8868\u793a\nMatlab\u306e.mat\u5f62\u5f0f\u306e\u30c7\u30fc\u30bf\u3092scipy.io.loadmat()\u3067\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\u30c7\u30fc\u30bf\u306f32x32\u30d4\u30af\u30bb\u30eb\u306e256\u968e\u8abf\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u753b\u50cf\u304c5000\u679a\u30025000x1024\u306e2\u6b21\u5143\u884c\u5217\u306b\u5165\u3063\u3066\u304d\u307e\u3059\u3002\n\u3053\u308c\u3092\u3068\u308a\u3042\u3048\u305a\u305d\u306e\u307e\u307e\u8868\u793a\uff08\u6700\u521d\u306e100\u753b\u50cf\u3060\u3051\uff09\u3057\u3066\u307f\u307e\u3059\u3002\ndata = scio.loadmat('ex7faces.mat')\nX = data['X'] # X\u306f5000x1024\u306e2\u6b21\u5143\u884c\u5217\n\nfig = plt.figure()\nplt.subplots_adjust(left=None, bottom=None, right=None, top=None, wspace=None, hspace=None)\nfor i in range(0,100):\n    ax = fig.add_subplot(10,10,i+1)\n    ax.axis('off')\n    ax.imshow(X[i].reshape(32,32).T, cmap = plt.get_cmap('gray'))\nplt.show()\n\n\u51fa\u529b\u306f\u3053\u3061\u3089\u3002\n\n\n\u4e3b\u6210\u5206\u5206\u6790\u306e\u5b9f\u65bd\n32x32\u30d4\u30af\u30bb\u30eb = 1024\u6b21\u5143 \u3067\u8868\u73fe\u3055\u308c\u3066\u3044\u308b\u5143\u753b\u50cf\u30c7\u30fc\u30bf\u306b\u4e3b\u6210\u5206\u5206\u6790\u3092\u304b\u3051\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001100\u6b21\u5143\u307e\u3067\u30c7\u30fc\u30bf\u3092\u7e2e\u6e1b\u3057\u307e\u3059\u3002\u4e3b\u6210\u5206\u5206\u6790\u306f sklearn.decomposition.PCA()\u30af\u30e9\u30b9\u4e00\u767a\u3067\u3059\u3002\u30d1\u30e9\u30e1\u30fc\u30bfn_components= \u3067\u3044\u304f\u3064\u307e\u3067\u4e3b\u6210\u5206\u3092\u53d6\u308b\u304b\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\npca = decomposition.PCA(n_components=100)\npca.fit(X)\n\n\n\u4e3b\u6210\u5206\u306e\u53ef\u8996\u5316\n\u4e3b\u6210\u5206\u5206\u6790\u306e\u7d50\u679c\u306f\u3001pca.components_\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002100x1024\u306e2\u6b21\u5143\u884c\u5217\u3067\u3059\u3002\u3053\u306e\u4e3b\u6210\u5206\u30d9\u30af\u30c8\u30eb\u3092\u305d\u306e\u307e\u307e\u8868\u793a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u6700\u521d\u306e36\u4e3b\u6210\u5206\u3060\u3051\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\nfig = plt.figure()\nplt.subplots_adjust(left=None, bottom=None, right=None, top=None, wspace=None, hspace=None)\nfor i in range(0,36):\n    ax = fig.add_subplot(6,6,i+1)\n    ax.axis('off')\n    ax.imshow(pca.components_[i].reshape(32,32).T, cmap = plt.get_cmap('gray'))\nplt.show()\n\n\u7d50\u679c\u306f\u3053\u3061\u3089\u3002\n\n\n\u6b21\u5143\u7e2e\u6e1b\u3068\u518d\u69cb\u7bc9\n\u4e3b\u6210\u5206\u5206\u6790\u306f\u3001\u3082\u3068\u3082\u30681024\u6b21\u5143\u30d9\u30af\u30c8\u30eb\u3067\u8868\u73fe\u3055\u308c\u3066\u3044\u305f\u753b\u50cf\u60c5\u5831\u3092\u3001100\u6b21\u5143\u307e\u3067\u7e2e\u6e1b\u3057\u3066\u3044\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u6b21\u5143\u7e2e\u6e1b\u3057\u305f\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306f\u3001pca.transform(X)\u3067\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff085000x100\u306e2\u6b21\u5143\u30d9\u30af\u30c8\u30eb\uff09\u3002\n\u3053\u308c\u306b\u4e3b\u6210\u5206\u30d9\u30af\u30c8\u30eb\u3092\u639b\u3051\u3066\u30015000x1024\u306e2\u6b21\u5143\u30d9\u30af\u30c8\u30eb\u3092\u5fa9\u5143\u3057\u307e\u3059\u3002\u5fa9\u5143\u3057\u305f\u30c7\u30fc\u30bf\u306f\u3001\u5143\u30c7\u30fc\u30bf\u3092100\u306e\u4e3b\u6210\u5206\u3067\u5727\u7e2e\u3057\u3066\u3001\u8868\u793a\u3067\u304d\u308b\u3088\u3046\u306b\u5fa9\u5143\u3057\u305f\u3082\u306e\u3068\u306a\u308a\u307e\u3059\u3002\u518d\u69cb\u7bc9\u3057\u305f\u7d50\u679c\u306e\u6700\u521d\u306e100\u500b\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3059\u3002\nXreduce = pca.transform(X) # \u6b21\u5143\u7e2e\u6e1b\u3002\u7d50\u679c\u306f5000x100\u884c\u5217\nXrecon = np.dot(Xreduce, pca.components_) # \u518d\u69cb\u7bc9\u3002\u7d50\u679c\u306f5000x1024\u884c\u5217\n\nfig = plt.figure()\nplt.subplots_adjust(left=None, bottom=None, right=None, top=None, wspace=None, hspace=None)\nfor i in range(0,100):\n    ax = fig.add_subplot(10,10,i+1)\n    ax.axis('off')\n    ax.imshow(Xrecon[i].reshape(32,32).T, cmap = plt.get_cmap('gray'))\nplt.show()\n\n\u7d50\u679c\u306f\u3053\u3061\u3089\u3002\u4e0a\u306b\u3042\u308b\u5143\u753b\u50cf\u3068\u6bd4\u3079\u308b\u3068\u3001\u30c7\u30a3\u30c6\u30fc\u30eb\u306f\u5931\u308f\u308c\u3066\u3044\u308b\u3082\u306e\u306e\u3001\u304a\u304a\u307e\u304b\u306a\u7279\u5fb4\u306f\u5fa9\u5143\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n\n\u304a\u308f\u308a\u306b\n\u4eca\u56de\u3082\u30b7\u30f3\u30d7\u30eb\u306a\u30b3\u30fc\u30c9\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n### \u306f\u3058\u3081\u306b\n\u6a5f\u68b0\u5b66\u7fd2\u3092\u5b66\u3076\u7b2c\u4e00\u6b69\u3068\u3057\u3066\u5b9a\u756a\u306eCoursera\u306eMachine Learning\u30b3\u30fc\u30b9\uff08Stanford\u3001Andrew Ng\u5148\u751f\uff09\u3002\u3053\u306e\u30b3\u30fc\u30b9\u306eMatlab/Octave\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8ab2\u984c\u3092Python\u3067\u5b9f\u88c5\u3059\u308b\u30b7\u30ea\u30fc\u30ba\u3002\n\u4eca\u56de\u306fex-7 \u6559\u5e2b\u306a\u3057\u5b66\u7fd2\u306e\u5f8c\u534a\u3001\u4e3b\u6210\u5206\u5206\u6790(Principal Component Analysis, PCA)\u3092\u3084\u308a\u307e\u3059\u3002\n\n### \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\n\u5404\u7a2e\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\u3057\u307e\u3059\u3002\n\n```py\nimport numpy as np\nimport scipy.io as scio\nimport matplotlib.pyplot as plt\nfrom sklearn import decomposition\n```\n\n### \u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u30fb\u8868\u793a\nMatlab\u306e.mat\u5f62\u5f0f\u306e\u30c7\u30fc\u30bf\u3092`scipy.io.loadmat()`\u3067\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\u30c7\u30fc\u30bf\u306f32x32\u30d4\u30af\u30bb\u30eb\u306e256\u968e\u8abf\u30b0\u30ec\u30fc\u30b9\u30b1\u30fc\u30eb\u753b\u50cf\u304c5000\u679a\u30025000x1024\u306e2\u6b21\u5143\u884c\u5217\u306b\u5165\u3063\u3066\u304d\u307e\u3059\u3002\n\u3053\u308c\u3092\u3068\u308a\u3042\u3048\u305a\u305d\u306e\u307e\u307e\u8868\u793a\uff08\u6700\u521d\u306e100\u753b\u50cf\u3060\u3051\uff09\u3057\u3066\u307f\u307e\u3059\u3002\n\n```py\ndata = scio.loadmat('ex7faces.mat')\nX = data['X'] # X\u306f5000x1024\u306e2\u6b21\u5143\u884c\u5217\n\nfig = plt.figure()\nplt.subplots_adjust(left=None, bottom=None, right=None, top=None, wspace=None, hspace=None)\nfor i in range(0,100):\n    ax = fig.add_subplot(10,10,i+1)\n    ax.axis('off')\n    ax.imshow(X[i].reshape(32,32).T, cmap = plt.get_cmap('gray'))\nplt.show()\n```\n\n\u51fa\u529b\u306f\u3053\u3061\u3089\u3002\n![ex7-3.png](https://qiita-image-store.s3.amazonaws.com/0/96897/20ae7879-79be-1cb2-19bf-b91e16fb9a3f.png)\n\n### \u4e3b\u6210\u5206\u5206\u6790\u306e\u5b9f\u65bd\n32x32\u30d4\u30af\u30bb\u30eb = 1024\u6b21\u5143 \u3067\u8868\u73fe\u3055\u308c\u3066\u3044\u308b\u5143\u753b\u50cf\u30c7\u30fc\u30bf\u306b\u4e3b\u6210\u5206\u5206\u6790\u3092\u304b\u3051\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001100\u6b21\u5143\u307e\u3067\u30c7\u30fc\u30bf\u3092\u7e2e\u6e1b\u3057\u307e\u3059\u3002\u4e3b\u6210\u5206\u5206\u6790\u306f `sklearn.decomposition.PCA()`\u30af\u30e9\u30b9\u4e00\u767a\u3067\u3059\u3002\u30d1\u30e9\u30e1\u30fc\u30bf`n_components=` \u3067\u3044\u304f\u3064\u307e\u3067\u4e3b\u6210\u5206\u3092\u53d6\u308b\u304b\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n```py\npca = decomposition.PCA(n_components=100)\npca.fit(X)\n```\n\n### \u4e3b\u6210\u5206\u306e\u53ef\u8996\u5316\n\u4e3b\u6210\u5206\u5206\u6790\u306e\u7d50\u679c\u306f\u3001`pca.components_`\u306b\u683c\u7d0d\u3055\u308c\u3066\u3044\u307e\u3059\u3002100x1024\u306e2\u6b21\u5143\u884c\u5217\u3067\u3059\u3002\u3053\u306e\u4e3b\u6210\u5206\u30d9\u30af\u30c8\u30eb\u3092\u305d\u306e\u307e\u307e\u8868\u793a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u6700\u521d\u306e36\u4e3b\u6210\u5206\u3060\u3051\u8868\u793a\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```py\nfig = plt.figure()\nplt.subplots_adjust(left=None, bottom=None, right=None, top=None, wspace=None, hspace=None)\nfor i in range(0,36):\n    ax = fig.add_subplot(6,6,i+1)\n    ax.axis('off')\n    ax.imshow(pca.components_[i].reshape(32,32).T, cmap = plt.get_cmap('gray'))\nplt.show()\n```\n\n\u7d50\u679c\u306f\u3053\u3061\u3089\u3002\n![ex7-4.png](https://qiita-image-store.s3.amazonaws.com/0/96897/bcf23b94-04eb-81eb-47fd-184950fc82db.png)\n\n### \u6b21\u5143\u7e2e\u6e1b\u3068\u518d\u69cb\u7bc9\n\u4e3b\u6210\u5206\u5206\u6790\u306f\u3001\u3082\u3068\u3082\u30681024\u6b21\u5143\u30d9\u30af\u30c8\u30eb\u3067\u8868\u73fe\u3055\u308c\u3066\u3044\u305f\u753b\u50cf\u60c5\u5831\u3092\u3001100\u6b21\u5143\u307e\u3067\u7e2e\u6e1b\u3057\u3066\u3044\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u6b21\u5143\u7e2e\u6e1b\u3057\u305f\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306f\u3001`pca.transform(X)`\u3067\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff085000x100\u306e2\u6b21\u5143\u30d9\u30af\u30c8\u30eb\uff09\u3002\n\u3053\u308c\u306b\u4e3b\u6210\u5206\u30d9\u30af\u30c8\u30eb\u3092\u639b\u3051\u3066\u30015000x1024\u306e2\u6b21\u5143\u30d9\u30af\u30c8\u30eb\u3092\u5fa9\u5143\u3057\u307e\u3059\u3002\u5fa9\u5143\u3057\u305f\u30c7\u30fc\u30bf\u306f\u3001\u5143\u30c7\u30fc\u30bf\u3092100\u306e\u4e3b\u6210\u5206\u3067\u5727\u7e2e\u3057\u3066\u3001\u8868\u793a\u3067\u304d\u308b\u3088\u3046\u306b\u5fa9\u5143\u3057\u305f\u3082\u306e\u3068\u306a\u308a\u307e\u3059\u3002\u518d\u69cb\u7bc9\u3057\u305f\u7d50\u679c\u306e\u6700\u521d\u306e100\u500b\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u3066\u307f\u307e\u3059\u3002\n\n```py\nXreduce = pca.transform(X) # \u6b21\u5143\u7e2e\u6e1b\u3002\u7d50\u679c\u306f5000x100\u884c\u5217\nXrecon = np.dot(Xreduce, pca.components_) # \u518d\u69cb\u7bc9\u3002\u7d50\u679c\u306f5000x1024\u884c\u5217\n\nfig = plt.figure()\nplt.subplots_adjust(left=None, bottom=None, right=None, top=None, wspace=None, hspace=None)\nfor i in range(0,100):\n    ax = fig.add_subplot(10,10,i+1)\n    ax.axis('off')\n    ax.imshow(Xrecon[i].reshape(32,32).T, cmap = plt.get_cmap('gray'))\nplt.show()\n```\n\n\u7d50\u679c\u306f\u3053\u3061\u3089\u3002\u4e0a\u306b\u3042\u308b\u5143\u753b\u50cf\u3068\u6bd4\u3079\u308b\u3068\u3001\u30c7\u30a3\u30c6\u30fc\u30eb\u306f\u5931\u308f\u308c\u3066\u3044\u308b\u3082\u306e\u306e\u3001\u304a\u304a\u307e\u304b\u306a\u7279\u5fb4\u306f\u5fa9\u5143\u3055\u308c\u3066\u3044\u308b\u306e\u304c\u308f\u304b\u308a\u307e\u3059\u3002\n\n![ex7-5.png](https://qiita-image-store.s3.amazonaws.com/0/96897/76864f88-b630-e461-280d-d30af837f0d0.png)\n\n### \u304a\u308f\u308a\u306b\n\n\u4eca\u56de\u3082\u30b7\u30f3\u30d7\u30eb\u306a\u30b3\u30fc\u30c9\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n", "tags": ["MachineLearning", "\u6a5f\u68b0\u5b66\u7fd2", "Python", "coursera", "scikit-learn"]}