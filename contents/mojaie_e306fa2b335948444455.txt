{"context": " More than 1 year has passed since last update.\u30df\u30e9\u30fc-\u30e9\u30d3\u30f3\u7d20\u6570\u5224\u5b9a\u6cd5 - Wikipedia\nhttp://ja.wikipedia.org/wiki/%E3%83%9F%E3%83%A9%E3%83%BC-%E3%83%A9%E3%83%93%E3%83%B3%E7%B4%A0%E6%95%B0%E5%88%A4%E5%AE%9A%E6%B3%95\n\u5c11\u306a\u304f\u3068\u30825\u6841\u304f\u3089\u3044\u307e\u3067\u306e\u6574\u6570\u306f\u6b63\u78ba\u306b\u5224\u5b9a\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\nMillerRabinTest.java\n// Miller-Rabin\u7d20\u6570\u5224\u5b9a\u30af\u30e9\u30b9\nclass MillerRabinTest{\n\n    // n\u304c\u7d20\u6570\u306a\u3089true\u3001n\u304c\u5408\u6210\u6570\u306a\u3089false\u3092\u8fd4\u3059\n    // k\u306f\u5224\u5b9a\u30b5\u30a4\u30af\u30eb\u6570\u3067\u3001k\u304c\u5927\u304d\u3044\u307b\u3069\u7d20\u6570\u5224\u5b9a\u304c\u6b63\u78ba\u306b\u306a\u308a\u3001\u901f\u5ea6\u306f\u4f4e\u4e0b\u3059\u308b\u3002\n    public static boolean isPrime(int n, int k) {\n        // 2\u306f\u7d20\u6570\n        if (n == 2) {\n            return true;\n        }\n        // 1\u306f\u7d20\u6570\u3067\u306f\u306a\u3044\n        // 2\u4ee5\u5916\u306e\u5076\u6570\u306f\u7d20\u6570\u3067\u306f\u306a\u3044\n        if (n == 1 || n % 2 == 0) {\n            return false;\n        }\n        // n-1\u30922\u306e\u3079\u304d\u4e57\u3067\u5272\u3063\u30662^s*d\u306e\u5f62\u5f0f\u306b\u5909\u5f62\n        int d = n - 1;\n        int s = 0;\n        while (d % 2 == 0) {\n            d = d / 2;\n            s++;\n        }\n        // \u5224\u5b9a\u30b5\u30a4\u30af\u30eb\n        for (int i = 0; i < k; i++) {\n            boolean isPP = false;\n            // 1\u304b\u3089n-1\u306e\u7bc4\u56f2\u304b\u3089\u6574\u6570a\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u9078\u3076\n            int a = (int) (Math.round((n - 2) * Math.random()) + 1);\n            // a^d mod n \u304c1\u3082\u3057\u304f\u306fn-1\u306a\u3089\u3001n\u306fprobably prime\n            int r = modPow(a, d, n);\n            if (r == 1 || r == n - 1) {\n                isPP = true;\n            }\n            // r^2 mod n \u304c-1\u306a\u3089\u3001n\u306fprobably prime\n            for (int j = 0; j < s; j++) {\n                r = modPow(r, 2, n);\n                if (r == n - 1) {\n                    isPP = true;\n                }\n            }\n            // \u4e0a\u8a18\u306e\u3069\u3061\u3089\u306b\u3082\u5f53\u3066\u306f\u307e\u3089\u306a\u3044\u5834\u5408\u3001n\u306fcomposite\n            if (!isPP) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    // \u3079\u304d\u5270\u4f59\u306e\u8a08\u7b97\n    private static int modPow(long x, int k, int m) {\n        if (k == 0) {\n            return 1;\n        }\n        if (k % 2 == 0) {\n            return modPow(x * x % m, k / 2, m);\n        } else {\n            return (int) (modPow(x, k - 1, m) * x % m);\n        }\n    }\n}\n\n\n\u30df\u30e9\u30fc-\u30e9\u30d3\u30f3\u7d20\u6570\u5224\u5b9a\u6cd5 - Wikipedia\nhttp://ja.wikipedia.org/wiki/%E3%83%9F%E3%83%A9%E3%83%BC-%E3%83%A9%E3%83%93%E3%83%B3%E7%B4%A0%E6%95%B0%E5%88%A4%E5%AE%9A%E6%B3%95\n\n\u5c11\u306a\u304f\u3068\u30825\u6841\u304f\u3089\u3044\u307e\u3067\u306e\u6574\u6570\u306f\u6b63\u78ba\u306b\u5224\u5b9a\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n```java:MillerRabinTest.java\n// Miller-Rabin\u7d20\u6570\u5224\u5b9a\u30af\u30e9\u30b9\nclass MillerRabinTest{\n\n\t// n\u304c\u7d20\u6570\u306a\u3089true\u3001n\u304c\u5408\u6210\u6570\u306a\u3089false\u3092\u8fd4\u3059\n\t// k\u306f\u5224\u5b9a\u30b5\u30a4\u30af\u30eb\u6570\u3067\u3001k\u304c\u5927\u304d\u3044\u307b\u3069\u7d20\u6570\u5224\u5b9a\u304c\u6b63\u78ba\u306b\u306a\u308a\u3001\u901f\u5ea6\u306f\u4f4e\u4e0b\u3059\u308b\u3002\n\tpublic static boolean isPrime(int n, int k) {\n\t\t// 2\u306f\u7d20\u6570\n\t\tif (n == 2) {\n\t\t\treturn true;\n\t\t}\n\t\t// 1\u306f\u7d20\u6570\u3067\u306f\u306a\u3044\n\t\t// 2\u4ee5\u5916\u306e\u5076\u6570\u306f\u7d20\u6570\u3067\u306f\u306a\u3044\n\t\tif (n == 1 || n % 2 == 0) {\n\t\t\treturn false;\n\t\t}\n\t\t// n-1\u30922\u306e\u3079\u304d\u4e57\u3067\u5272\u3063\u30662^s*d\u306e\u5f62\u5f0f\u306b\u5909\u5f62\n\t\tint d = n - 1;\n\t\tint s = 0;\n\t\twhile (d % 2 == 0) {\n\t\t\td = d / 2;\n\t\t\ts++;\n\t\t}\n\t\t// \u5224\u5b9a\u30b5\u30a4\u30af\u30eb\n\t\tfor (int i = 0; i < k; i++) {\n\t\t\tboolean isPP = false;\n\t\t\t// 1\u304b\u3089n-1\u306e\u7bc4\u56f2\u304b\u3089\u6574\u6570a\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u9078\u3076\n\t\t\tint a = (int) (Math.round((n - 2) * Math.random()) + 1);\n\t\t\t// a^d mod n \u304c1\u3082\u3057\u304f\u306fn-1\u306a\u3089\u3001n\u306fprobably prime\n\t\t\tint r = modPow(a, d, n);\n\t\t\tif (r == 1 || r == n - 1) {\n\t\t\t\tisPP = true;\n\t\t\t}\n\t\t\t// r^2 mod n \u304c-1\u306a\u3089\u3001n\u306fprobably prime\n\t\t\tfor (int j = 0; j < s; j++) {\n\t\t\t\tr = modPow(r, 2, n);\n\t\t\t\tif (r == n - 1) {\n\t\t\t\t\tisPP = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// \u4e0a\u8a18\u306e\u3069\u3061\u3089\u306b\u3082\u5f53\u3066\u306f\u307e\u3089\u306a\u3044\u5834\u5408\u3001n\u306fcomposite\n\t\t\tif (!isPP) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\t\n\t// \u3079\u304d\u5270\u4f59\u306e\u8a08\u7b97\n\tprivate static int modPow(long x, int k, int m) {\n\t\tif (k == 0) {\n\t\t\treturn 1;\n\t\t}\n\t\tif (k % 2 == 0) {\n\t\t\treturn modPow(x * x % m, k / 2, m);\n\t\t} else {\n\t\t\treturn (int) (modPow(x, k - 1, m) * x % m);\n\t\t}\n\t}\n}\n```", "tags": ["Java", "\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"]}