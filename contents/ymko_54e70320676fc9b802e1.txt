{"context": " More than 1 year has passed since last update.docker\u30b3\u30f3\u30c6\u30ca\u3067nfs\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u3001\u30db\u30b9\u30c8\u5074\u304b\u3089\u30de\u30a6\u30f3\u30c8\u3057\u3066\u307f\u308b\u3002\n\ndocker\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# yum install docker\n# systemctl enable docker\n# systemctl start docker\n\n\n\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u3063\u3066\u4f5c\u696d\n// systemd\u3092\u4f7f\u3046\u305f\u3081(nfs\u30c7\u30fc\u30e2\u30f3\u8d77\u52d5\u7528)\n$ docker run --privileged=true -d --name nfstest -p 2049:2049 -i -t centos:centos7 /sbin/init\n$ docker exec -i -t nfstest /bin/bash\n\n// xfs\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u3063\u3066\u516c\u958b\n# cd /home\n# fallocate -l 1GB xfs.dat\n# ls -l\n-rw-r--r-- 1 root root 1000000000 Dec 10 10:08 xfs.dat\n# yum install xfsprogs\n# ll /dev/loop*\nbrw-rw---- 1 root disk  7,   0 Dec 10 12:42 /dev/loop0\nbrw-rw---- 1 root disk  7,   1 Dec 10 12:42 /dev/loop1\ncrw------- 1 root root 10, 237 Dec 10 12:42 /dev/loop-control\n# mknod /dev/loop2 b 7 2\n# losetup /dev/loop2 xfs.dat\n# mkfs -t xfs /dev/loop2\n# mkdir /home/xfs\n# mount -o inode64 -t xfs /dev/loop2 /home/xfs\n\n// nfs\u516c\u958b(\u30db\u30b9\u30c8\u5236\u9650\u7121\u3057\u3000*\u306e\u5f8c\u306b\u30b9\u30da\u30fc\u30b9\u7121\u3057\u306b\u3057\u306a\u3044\u3068\u30c0\u30e1)\n# yum install nfs-utils\n# vi /etc/exports.d/xfs.exports\n/home/xfs *(rw)\n# systemctl start rpcbind\n# systemctl start nfs\n\n\ndocker\u30db\u30b9\u30c8\u5074\n# ip addr\n5: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP\n    link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff\n    inet 172.17.42.1/16 scope global docker0\n# mount -t nfs 172.17.42.1:/home/xfs /mnt\n# df -T\n172.17.42.1:/home/xfs nfs4          973184    32896   940288    4% /mnt\n\n\n\u53c2\u8003\nCentOS 7\u306eDocker\u30b3\u30f3\u30c6\u30ca\u5185\u3067systemd\u3092\u4f7f\u3063\u3066\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3059\u308b - Qiita\nhttp://qiita.com/yunano/items/9637ee21a71eba197345\nDocker\u3067\u4e0d\u8981\u306b\u306a\u3063\u305f\u30b3\u30f3\u30c6\u30ca\u3084\u30a4\u30e1\u30fc\u30b8\u3092\u524a\u9664\u3059\u308b - @znz blog\nhttp://blog.n-z.jp/blog/2013-12-24-docker-rm.html\n$ docker rm `docker ps -a -q`\n$ docker rmi $(docker images | awk '/^<none>/ { print $3 }')\n\n[docker]\u30b3\u30f3\u30c6\u30ca\u5185\u3067systemd\u3092\u7a3c\u50cd\u3055\u305b\u306a\u304c\u3089\u3001\u30ed\u30b0\u30a4\u30f3\u3082\u3057\u305f\u3044\u30fb\u30fb - \u300e\u30b7\u30b9\u30c6\u30e0\u30ce\u30f2\u30cb\u30ef\u30bd\u30c8\u300f\nhttp://blog.goo.ne.jp/system-oni800/e/b84f8824f09cd665e0b880709609ece0\n\u30b3\u30f3\u30c6\u30ca\u306b\u5165\u308a\u305f\u3044\uff1f\u305d\u308c docker exec \u3067\u3067\u304d\u308b\u3088 - Qiita\nhttp://qiita.com/yosisa/items/a5670e4da3ff22e9411a\ndocker - Failed to get D-Bus connection: No connection to service manager.\u306e\u5bfe\u51e6 - Qiita\nhttp://qiita.com/tukiyo3/items/b24e4dc62de59d4a7570\n\u3064\u307e\u308a\u306f\u3053\u3046\u3059\u308b\n// \u30c7\u30fc\u30e2\u30f3\u30e2\u30fc\u30c9\u3067init\u3092\u8d77\u52d5\n$ docker run --privileged=true -d --name test -p 2049:2049 -i -t centos:centos7 /sbin/init\n// exec\u30b3\u30de\u30f3\u30c9\u3067\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n$ docker exec -i -t test /bin/bash\n[root@4130ba7fe6e2 /]# ps awx\n  PID TTY      STAT   TIME COMMAND\n    1 ?        Ss     0:00 /sbin/init\n   62 ?        Ss     0:00 /usr/lib/systemd/systemd-journald\n   84 ?        Ss     0:00 /bin/bash\n  103 ?        R+     0:00 ps awx\n\n[CentOS] NFS\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u300cwriting fd to kernel failed: errno 111 (Connection refused)\u300d\u3068\u3044\u3046\u30a8\u30e9\u30fc\u306b\u306a\u308b - Life with IT\nhttp://l-w-i.net/t/centos/nfs_100.txt\ndocker\u30b3\u30f3\u30c6\u30ca\u3067nfs\u30b5\u30fc\u30d0\u30fc\u3092\u8d77\u52d5\u3057\u3001\u30db\u30b9\u30c8\u5074\u304b\u3089\u30de\u30a6\u30f3\u30c8\u3057\u3066\u307f\u308b\u3002\n\n# docker\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n# yum install docker\n# systemctl enable docker\n# systemctl start docker\n```\n\n# \u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u3063\u3066\u4f5c\u696d\n\n```bash\n// systemd\u3092\u4f7f\u3046\u305f\u3081(nfs\u30c7\u30fc\u30e2\u30f3\u8d77\u52d5\u7528)\n$ docker run --privileged=true -d --name nfstest -p 2049:2049 -i -t centos:centos7 /sbin/init\n$ docker exec -i -t nfstest /bin/bash\n\n// xfs\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u3063\u3066\u516c\u958b\n# cd /home\n# fallocate -l 1GB xfs.dat\n# ls -l\n-rw-r--r-- 1 root root 1000000000 Dec 10 10:08 xfs.dat\n# yum install xfsprogs\n# ll /dev/loop*\nbrw-rw---- 1 root disk  7,   0 Dec 10 12:42 /dev/loop0\nbrw-rw---- 1 root disk  7,   1 Dec 10 12:42 /dev/loop1\ncrw------- 1 root root 10, 237 Dec 10 12:42 /dev/loop-control\n# mknod /dev/loop2 b 7 2\n# losetup /dev/loop2 xfs.dat\n# mkfs -t xfs /dev/loop2\n# mkdir /home/xfs\n# mount -o inode64 -t xfs /dev/loop2 /home/xfs\n\n// nfs\u516c\u958b(\u30db\u30b9\u30c8\u5236\u9650\u7121\u3057\u3000*\u306e\u5f8c\u306b\u30b9\u30da\u30fc\u30b9\u7121\u3057\u306b\u3057\u306a\u3044\u3068\u30c0\u30e1)\n# yum install nfs-utils\n# vi /etc/exports.d/xfs.exports\n/home/xfs *(rw)\n# systemctl start rpcbind\n# systemctl start nfs\n```\n\n# docker\u30db\u30b9\u30c8\u5074\n\n```bash\n# ip addr\n5: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP\n    link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff\n    inet 172.17.42.1/16 scope global docker0\n# mount -t nfs 172.17.42.1:/home/xfs /mnt\n# df -T\n172.17.42.1:/home/xfs nfs4          973184    32896   940288    4% /mnt\n```\n\n# \u53c2\u8003\n\nCentOS 7\u306eDocker\u30b3\u30f3\u30c6\u30ca\u5185\u3067systemd\u3092\u4f7f\u3063\u3066\u30b5\u30fc\u30d3\u30b9\u3092\u8d77\u52d5\u3059\u308b - Qiita\nhttp://qiita.com/yunano/items/9637ee21a71eba197345\n\nDocker\u3067\u4e0d\u8981\u306b\u306a\u3063\u305f\u30b3\u30f3\u30c6\u30ca\u3084\u30a4\u30e1\u30fc\u30b8\u3092\u524a\u9664\u3059\u308b - @znz blog\nhttp://blog.n-z.jp/blog/2013-12-24-docker-rm.html\n\n```bash\n$ docker rm `docker ps -a -q`\n$ docker rmi $(docker images | awk '/^<none>/ { print $3 }')\n```\n\n[docker]\u30b3\u30f3\u30c6\u30ca\u5185\u3067systemd\u3092\u7a3c\u50cd\u3055\u305b\u306a\u304c\u3089\u3001\u30ed\u30b0\u30a4\u30f3\u3082\u3057\u305f\u3044\u30fb\u30fb - \u300e\u30b7\u30b9\u30c6\u30e0\u30ce\u30f2\u30cb\u30ef\u30bd\u30c8\u300f\nhttp://blog.goo.ne.jp/system-oni800/e/b84f8824f09cd665e0b880709609ece0\n\n\n\u30b3\u30f3\u30c6\u30ca\u306b\u5165\u308a\u305f\u3044\uff1f\u305d\u308c docker exec \u3067\u3067\u304d\u308b\u3088 - Qiita\nhttp://qiita.com/yosisa/items/a5670e4da3ff22e9411a\ndocker - Failed to get D-Bus connection: No connection to service manager.\u306e\u5bfe\u51e6 - Qiita\nhttp://qiita.com/tukiyo3/items/b24e4dc62de59d4a7570\n\n\u3064\u307e\u308a\u306f\u3053\u3046\u3059\u308b\n\n```bash\n// \u30c7\u30fc\u30e2\u30f3\u30e2\u30fc\u30c9\u3067init\u3092\u8d77\u52d5\n$ docker run --privileged=true -d --name test -p 2049:2049 -i -t centos:centos7 /sbin/init\n// exec\u30b3\u30de\u30f3\u30c9\u3067\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n$ docker exec -i -t test /bin/bash\n[root@4130ba7fe6e2 /]# ps awx\n  PID TTY      STAT   TIME COMMAND\n    1 ?        Ss     0:00 /sbin/init\n   62 ?        Ss     0:00 /usr/lib/systemd/systemd-journald\n   84 ?        Ss     0:00 /bin/bash\n  103 ?        R+     0:00 ps awx\n```\n\n[CentOS] NFS\u30b5\u30fc\u30d0\u3092\u8d77\u52d5\u3057\u3088\u3046\u3068\u3059\u308b\u3068\u300cwriting fd to kernel failed: errno 111 (Connection refused)\u300d\u3068\u3044\u3046\u30a8\u30e9\u30fc\u306b\u306a\u308b - Life with IT\nhttp://l-w-i.net/t/centos/nfs_100.txt\n", "tags": ["docker", "nfs"]}