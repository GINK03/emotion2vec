{"context": " More than 1 year has passed since last update.ieserver\u767b\u9332\u753b\u9762\nhttp://ieserver.net/entry.html\nieserver\u30ed\u30b0\u30a4\u30f3\u753b\u9762\nhttp://ieserver.net/login.html\ncd ~\nwget http://ieserver.net/ddns-update.txt\n\ncd /usr/local\nsudo mkdir ddns\nsudo cp ~/ddns-update.txt /usr/local/ddns/ddns-update.pl\n\nsudo nano ddns-update.pl\n\n\nddns-update.pl\n#!/usr/bin/perl\n\n# ieServer.Net \u5c02\u7528 DDNS IP \u30a2\u30c9\u30ec\u30b9\u66f4\u65b0\u30b9\u30af\u30ea\u30d7\u30c8 - ddns-update.pl\n# \u4f5c\u6210\u8005\uff1a\u5c71\u672c\u606d\u5f18@Agora Inc.\u3000\u4f5c\u6210\u65e5:2004/03/24\n#\n# \u56de\u7dda\u5272\u308a\u5f53\u3066\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\u3092\u78ba\u8a8d\u3057\u3001\u5909\u5316\u304c\u3042\u308c\u3070\u65b0IP\u30a2\u30c9\u30ec\u30b9\u3092\n# DDNS\u306b\u767b\u9332\u3002\u5f53\u30b3\u30de\u30f3\u30c9\u3092\u4e00\u5b9a\u306e\u9593\u9694\u3067\u5b9f\u884c\u3057\u3001IP\u30a2\u30c9\u30ec\u30b9\u306e\u5909\u5316\u3092\u76e3\u8996\uff06\n# \u66f4\u65b0\u51e6\u7406\u3059\u308b\u3002\u5229\u7528\u306b\u306f perl wget cron \u304c\u5229\u7528\u53ef\u80fd\u3067\u3042\u308b\u5fc5\u8981\u3042\u308a\u3002\n#\n# \u56de\u7dda\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u305f IP\u30a2\u30c9\u30ec\u30b9 \u306f http://ieserver.net/ipcheck.shtml\n# \u3078\u306e\u30a2\u30af\u30bb\u30b9\u306b\u3088\u3063\u3066\u78ba\u8a8d\u3002\n#\n# cron \u306b\u3066\u5f53\u30b3\u30de\u30f3\u30c9\u3092\u7b49\u9593\u9694\u3067\u5b9f\u884c\u3057\u3001\u56de\u7ddaIP\u3092\u78ba\u8a8d\u3002\u5909\u5316\u304c\u3042\u308c\u3070DDNS\u306b\n# IP\u30a2\u30c9\u30ec\u30b9\u3092\u767b\u9332\u3002DDNS\u30b5\u30fc\u30d0\u30fc\u3078\u306e\u8ca0\u8377\u8efd\u6e1b\u306e\u70b9\u304b\u3089\u5b9f\u884c\u9593\u9694\u306f10\u5206\u4ee5\u4e0a\u3068\n# \u3059\u308b\u3053\u3068\u3002\n# crontab\u8a2d\u5b9a\u4f8b(/usr/local/ddns/ddns.pl\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u304d10\u5206\u9593\u9694\u3067\u5b9f\u884c)\n# 5,15,25,35,45,55 * * * * /usr/local/ddns/ddns-update.pl\n\n# \u4ee5\u4e0b\uff12\u30d5\u30a1\u30a4\u30eb\u306e\u914d\u7f6e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u597d\u307f\u306b\u5fdc\u3058\u8a2d\u5b9a\n# 1. \u8a2d\u5b9aIP\u30a2\u30c9\u30ec\u30b9\u30ef\u30fc\u30af\u30d5\u30a1\u30a4\u30eb\n$CURRENT_IP_FILE = \"/usr/local/ddns/current_ip\";\n\n#  2. \u8a2d\u5b9a\u72b6\u6cc1\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\n$LOG_FILE        = \"/usr/local/ddns/ip_update.log\";\n\n# \u56de\u7ddaIP\u78ba\u8a8d\u30da\u30fc\u30b8URL\n$REMOTE_ADDR_CHK = \"http://ieserver.net/ipcheck.shtml\";\n# DDNS\u66f4\u65b0\u30da\u30fc\u30b8URL\n# wget\u3092SSL\u63a5\u7d9a\u53ef\u80fd\u3067\u30d3\u30eb\u30c9\u3057\u3066\u3044\u308b\u306a\u3089\u3001https:// \u3067\u306e\u63a5\u7d9a\u3092\u63a8\u5968\n$DDNS_UPDATE     = \"https://ieserver.net/cgi-bin/dip.cgi\";\n\n# ieServer.Net\u306b\u3066\u53d6\u5f97\u3057\u305f\u30a2\u30ab\u30a6\u30f3\u30c8\uff08\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\uff09\u60c5\u5831\u3092\u8a18\u5165\n$ACCOUNT         = \"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u540d\";     # \u30a2\u30ab\u30a6\u30f3\u30c8(\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3)\u540d\u8a2d\u5b9a\n$DOMAIN          = \"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u3067\u9078\u629e\u3057\u305f\u30c9\u30e1\u30a4\u30f3\u540d\";     # \u30c9\u30e1\u30a4\u30f3\u540d\u8a2d\u5b9a\n$PASSWORD        = \"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u3067\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\";     # \u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\n\nif(!open(FILE,\"$CURRENT_IP_FILE\")) {\n    $CURRENT_IP = '0.0.0.0';\n    } else {\n    $CURRENT_IP = <FILE>;\n    close FILE;\n}\n\n$NEW_IP = '0.0.0.0';\n$NEW_IP = `wget -q -O - $REMOTE_ADDR_CHK`;\n\nif ($NEW_IP ne \"0.0.0.0\" and $CURRENT_IP ne $NEW_IP) {\n\n    $STATUS = `wget -q -O - '$DDNS_UPDATE?username=$ACCOUNT&domain=$DOMAIN&password=$PASSWORD&updatehost=1'`;\n\n    if ($STATUS =~ m/$NEW_IP/) {    \n        open (FILE ,\">$CURRENT_IP_FILE\");\n        print FILE $NEW_IP;\n        close FILE;\n        $TIME = localtime;\n        open (FILE ,\">>$LOG_FILE\");\n        print FILE \"$TIME $ACCOUNT.$DOMAIN Updated $CURRENT_IP to $NEW_IP\\n\";\n        close FILE;\u3000\n    } else {\n        $TIME = localtime;\n        open (FILE ,\">>$LOG_FILE\");\n        print FILE \"$TIME $ACCOUNT.$DOMAIN Update aborted $CURRENT_IP to $NEW_IP\\n\";\n        close FILE;\n    }\n}\nexit;\n\n\nsudo chmod 700 ddns-update.pl\n\nsudo crontab -e\n5,15,25,35,45,55 * * * * /usr/local/ddns/ddns-update.pl\n\n\n\u30ed\u30b0\u306e\u78ba\u8a8d\nsudo cat /usr/local/ddns/ip_update.log\n\nieserver\u767b\u9332\u753b\u9762\nhttp://ieserver.net/entry.html\n\nieserver\u30ed\u30b0\u30a4\u30f3\u753b\u9762\nhttp://ieserver.net/login.html\n\n```bash\ncd ~\nwget http://ieserver.net/ddns-update.txt\n```\n\n```bash\ncd /usr/local\nsudo mkdir ddns\nsudo cp ~/ddns-update.txt /usr/local/ddns/ddns-update.pl\n```\n\n```bash\nsudo nano ddns-update.pl\n```\n\n```pl:ddns-update.pl\n#!/usr/bin/perl\n\n# ieServer.Net \u5c02\u7528 DDNS IP \u30a2\u30c9\u30ec\u30b9\u66f4\u65b0\u30b9\u30af\u30ea\u30d7\u30c8 - ddns-update.pl\n# \u4f5c\u6210\u8005\uff1a\u5c71\u672c\u606d\u5f18@Agora Inc.\u3000\u4f5c\u6210\u65e5:2004/03/24\n#\n# \u56de\u7dda\u5272\u308a\u5f53\u3066\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\u3092\u78ba\u8a8d\u3057\u3001\u5909\u5316\u304c\u3042\u308c\u3070\u65b0IP\u30a2\u30c9\u30ec\u30b9\u3092\n# DDNS\u306b\u767b\u9332\u3002\u5f53\u30b3\u30de\u30f3\u30c9\u3092\u4e00\u5b9a\u306e\u9593\u9694\u3067\u5b9f\u884c\u3057\u3001IP\u30a2\u30c9\u30ec\u30b9\u306e\u5909\u5316\u3092\u76e3\u8996\uff06\n# \u66f4\u65b0\u51e6\u7406\u3059\u308b\u3002\u5229\u7528\u306b\u306f perl wget cron \u304c\u5229\u7528\u53ef\u80fd\u3067\u3042\u308b\u5fc5\u8981\u3042\u308a\u3002\n#\n# \u56de\u7dda\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u305f IP\u30a2\u30c9\u30ec\u30b9 \u306f http://ieserver.net/ipcheck.shtml\n# \u3078\u306e\u30a2\u30af\u30bb\u30b9\u306b\u3088\u3063\u3066\u78ba\u8a8d\u3002\n#\n# cron \u306b\u3066\u5f53\u30b3\u30de\u30f3\u30c9\u3092\u7b49\u9593\u9694\u3067\u5b9f\u884c\u3057\u3001\u56de\u7ddaIP\u3092\u78ba\u8a8d\u3002\u5909\u5316\u304c\u3042\u308c\u3070DDNS\u306b\n# IP\u30a2\u30c9\u30ec\u30b9\u3092\u767b\u9332\u3002DDNS\u30b5\u30fc\u30d0\u30fc\u3078\u306e\u8ca0\u8377\u8efd\u6e1b\u306e\u70b9\u304b\u3089\u5b9f\u884c\u9593\u9694\u306f10\u5206\u4ee5\u4e0a\u3068\n# \u3059\u308b\u3053\u3068\u3002\n# crontab\u8a2d\u5b9a\u4f8b(/usr/local/ddns/ddns.pl\u306b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u7f6e\u304d10\u5206\u9593\u9694\u3067\u5b9f\u884c)\n# 5,15,25,35,45,55 * * * * /usr/local/ddns/ddns-update.pl\n\n# \u4ee5\u4e0b\uff12\u30d5\u30a1\u30a4\u30eb\u306e\u914d\u7f6e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306f\u597d\u307f\u306b\u5fdc\u3058\u8a2d\u5b9a\n# 1. \u8a2d\u5b9aIP\u30a2\u30c9\u30ec\u30b9\u30ef\u30fc\u30af\u30d5\u30a1\u30a4\u30eb\n$CURRENT_IP_FILE = \"/usr/local/ddns/current_ip\";\n\n#  2. \u8a2d\u5b9a\u72b6\u6cc1\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\n$LOG_FILE        = \"/usr/local/ddns/ip_update.log\";\n\n# \u56de\u7ddaIP\u78ba\u8a8d\u30da\u30fc\u30b8URL\n$REMOTE_ADDR_CHK = \"http://ieserver.net/ipcheck.shtml\";\n# DDNS\u66f4\u65b0\u30da\u30fc\u30b8URL\n# wget\u3092SSL\u63a5\u7d9a\u53ef\u80fd\u3067\u30d3\u30eb\u30c9\u3057\u3066\u3044\u308b\u306a\u3089\u3001https:// \u3067\u306e\u63a5\u7d9a\u3092\u63a8\u5968\n$DDNS_UPDATE     = \"https://ieserver.net/cgi-bin/dip.cgi\";\n\n# ieServer.Net\u306b\u3066\u53d6\u5f97\u3057\u305f\u30a2\u30ab\u30a6\u30f3\u30c8\uff08\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3\uff09\u60c5\u5831\u3092\u8a18\u5165\n$ACCOUNT         = \"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u3057\u305f\u30e6\u30fc\u30b6\u30fc\u540d\";     # \u30a2\u30ab\u30a6\u30f3\u30c8(\u30b5\u30d6\u30c9\u30e1\u30a4\u30f3)\u540d\u8a2d\u5b9a\n$DOMAIN          = \"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u3067\u9078\u629e\u3057\u305f\u30c9\u30e1\u30a4\u30f3\u540d\";     # \u30c9\u30e1\u30a4\u30f3\u540d\u8a2d\u5b9a\n$PASSWORD        = \"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u3067\u8a2d\u5b9a\u3057\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\";     # \u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a\n\nif(!open(FILE,\"$CURRENT_IP_FILE\")) {\n    $CURRENT_IP = '0.0.0.0';\n    } else {\n    $CURRENT_IP = <FILE>;\n    close FILE;\n}\n\n$NEW_IP = '0.0.0.0';\n$NEW_IP = `wget -q -O - $REMOTE_ADDR_CHK`;\n\nif ($NEW_IP ne \"0.0.0.0\" and $CURRENT_IP ne $NEW_IP) {\n\n    $STATUS = `wget -q -O - '$DDNS_UPDATE?username=$ACCOUNT&domain=$DOMAIN&password=$PASSWORD&updatehost=1'`;\n    \n    if ($STATUS =~ m/$NEW_IP/) {    \n        open (FILE ,\">$CURRENT_IP_FILE\");\n        print FILE $NEW_IP;\n        close FILE;\n        $TIME = localtime;\n        open (FILE ,\">>$LOG_FILE\");\n        print FILE \"$TIME $ACCOUNT.$DOMAIN Updated $CURRENT_IP to $NEW_IP\\n\";\n        close FILE;\u3000\n    } else {\n        $TIME = localtime;\n        open (FILE ,\">>$LOG_FILE\");\n        print FILE \"$TIME $ACCOUNT.$DOMAIN Update aborted $CURRENT_IP to $NEW_IP\\n\";\n        close FILE;\n    }\n}\nexit;\n```\n\n```bash\nsudo chmod 700 ddns-update.pl\n```\n\n```bash\nsudo crontab -e\n5,15,25,35,45,55 * * * * /usr/local/ddns/ddns-update.pl\n```\n\n## \u30ed\u30b0\u306e\u78ba\u8a8d\n\n```bash\nsudo cat /usr/local/ddns/ip_update.log\n```\n\n", "tags": ["Linux", "Debian", "DDNS"]}