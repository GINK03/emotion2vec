{"context": " More than 1 year has passed since last update.\n\n\u80cc\u666f\n\n2014\u5e746\u6708\u304b\u3089\u3001Android\u52c9\u5f37\u3092\u59cb\u3081\u3066\u3001\u307e\u3060\u521d\u5fc3\u8005\u3060\u3002\nUSB Camera\u3092Android external device\u3068\u3057\u3066\u4f7f\u3044\u305f\u3044\uff08\u5927\u304d\u3044\u76ee\u6a19\u3060\u3063\u305f\uff09\n\n\n\u76ee\u7684\n\nUSB\u30c7\u30d0\u30a4\u30b9\u3068\u901a\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\n\u901a\u4fe1\u524d\u306b\u3001\u30c7\u30d0\u30a4\u30b9\u767a\u898b\u3001\u5217\u6319\u3001\u8a31\u53ef\u53d6\u5f97\u306a\u3069\u306e\u4f5c\u696d\u3092\u8aac\u660e\u3059\u308b\n\n\n\u5b50\u4f9b\u3001\u6bcd\u3001\u304a\u83d3\u5b50\n\n\u4f55\u3053\u308c\uff1f\n\n\u79c1\u306f\u3001\u521d\u3081\u3066\u3053\u306e\u6587\u66f8\u3092\u8aad\u3093\u3060\u3068\u304d\u306b\u3001\u901a\u4fe1\u4ee5\u5916\u306e\u51e6\u7406\u306f\u3001\u4f55\u306e\u3064\u3082\u308a\u304b\u306e\u3053\u3068\u304c\u3001\u5168\u7136\u5206\u304b\u3089\u306a\u3044\n\u305d\u306e\u4ed6\u306e\u521d\u5fc3\u8005\u306f\u3001\u540c\u611f\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\n\u3053\u3053\u3067\u3001\u5b50\u4f9b\u3001\u6bcd\u3001\u304a\u83d3\u5b50\u306e\u4f8b\u3067\u3001\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3046\n\n\n\u5b50\u4f9b = \u30e6\u30fc\u30b6\n\u6bcd  = \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\n\u304a\u83d3\u5b50 = USB\u30c7\u30d0\u30a4\u30b9\n\n\n\n\n\u5b50\u4f9b\u306f\u3001\u3069\u3046\u304a\u83d3\u5b50\u3092\u3082\u3089\u3048\u308b\u304b\n\n\u4e16\u754c\u306b\u3001\u3044\u308d\u3044\u308d\u306a\u304a\u83d3\u5b50\u304c\u3042\u308b\u3051\u3069\u3001\u6bcd\u306f\u3001\u81ea\u5206\u306e\u5b50\u4f9b\u3092\u98df\u3079\u308c\u308b\u304a\u83d3\u5b50\u306b\u5bfe\u3057\u3066\u3001\u304a\u83d3\u5b50\u30ea\u30b9\u30c8\u3092\u6301\u3063\u3066\u3044\u308b\n\u3053\u306e\u304a\u83d3\u5b50\u30ea\u30b9\u30c8\u3088\u308a\u3001\u6bcd\u306f\u3001\u73fe\u5728\u306b\u8cb0\u3048\u308b\u304a\u83d3\u5b50\u304b\u3089\u3001\u304a\u83d3\u5b50\u3092\u5217\u6319\u3059\u308b\u3001\u5b50\u4f9b\u306b\u9078\u629e\u3055\u305b\u308b\n\u5b50\u4f9b\u306f\u3001\u597d\u304d\u306a\u304a\u83d3\u5b50\u306b\u3001\u98df\u3079\u305f\u3044\u3092\u558b\u3063\u3066\u3001\u6bcd\u306f\u3001\u3053\u306e\u304a\u83d3\u5b50\u3092\u5b50\u4f9b\u306b\u3042\u3052\u308b\n\n\n\u901a\u4fe1\u524d\u306b\u3001\u3044\u308d\u3044\u308d\u306a\u4f5c\u696d\u3092\u8aac\u660e\u3059\u308b\n\n\u83d3\u5b50\u30ea\u30b9\u30c8\n\n\n\u6bcd\u306f\u3001\u6301\u3063\u3066\u3044\u308b\u83d3\u5b50\u30ea\u30b9\u30c8\u304c\u3001res/xml\u306e\u4e0b\u306b\u3001\u653e\u7f6e\u3067\u304d\u308b\uff08\u4f8b\uff1ares/xml/device_filter.xml\uff09\n\u5e0c\u671b\u3059\u308b USB \u30c7\u30d0\u30a4\u30b9\u3092\u7279\u5b9a\u3057\u305f\u5bfe\u5fdc\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u5ba3\u8a00\u3059\u308b\u65b9\u6cd5\u306e\u4f8b\u3092\u4ee5\u4e0b\u306b\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<resources>\n    <usb-device vendor-id=\"1234\" product-id=\"5678\" class=\"255\" subclass=\"66\" protocol=\"1\" />\n</resources>\n\n\n\u4ee5\u4e0a\u306e\u6761\u4ef6\u3088\u308a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08\u6bcd\uff09\u304c\u3001\u30c7\u30d0\u30a4\u30b9\u3092\u9078\u3079\u308c\u3066\u3001\u305d\u306e\u4ee5\u5916\u306e\u304a\u83d3\u5b50\u3092\u7121\u8996\u3059\u308b\n\u5c0e\u5165\n\n\n<activity ...>\n...\n    <intent-filter>\n        <action android:name=\"android.hardware.usb.action.USB_DEVICE_ATTACHED\" />\n    </intent-filter>\n\n    <meta-data android:name=\"android.hardware.usb.action.USB_DEVICE_ATTACHED\"\n        android:resource=\"@xml/device_filter\" />\n</activity>\n\n\n\u4ee5\u4e0b\u306e\u30ed\u30b0\u3092\u53c2\u7167\u3057\u3066\u3001vendor-id\u306a\u3069\u306e\u610f\u5473\u3092\u7406\u89e3\u3067\u304d\u308b\u3068\u601d\u3046\n\nUsbDevice[mName=/dev/bus/usb/001/002,mVendorId=1133,mProductId=2093,mClass=239,mSubclass=2,mProtocol=1,mInterfaces=[Landroid.os.Parcelable;@41eabd00]\n\n\n\u304a\u83d3\u5b50\u3092\u5217\u6319\u3059\u308b\n\n\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3(\u6bcd)\u306f\u3001\u83d3\u5b50\u30ea\u30b9\u30c8\u3088\u308a\u3001\u9078\u3079\u51fa\u3057\u305f\u304a\u83d3\u5b50\u3092\u3001\u30e6\u30fc\u30b6\uff08\u5b50\u4f9b\uff09\u306b\u5217\u6319\u3059\u308b\n\nUsbManager manager = (UsbManager) getSystemService(Context.USB_SERVICE);\n...\nHashMap<String, UsbDevice> deviceList = manager.getDeviceList();\nIterator<UsbDevice> deviceIterator = deviceList.values().iterator();\nwhile(deviceIterator.hasNext()){\n    UsbDevice device = deviceIterator.next()\n    //your code\n}\n\n\nDialogframent\u306a\u3069\u30af\u30e9\u30b9\u3092\u4f7f\u3063\u3066\u3001\u30e6\u30fc\u30b6\uff08\u5b50\u4f9b\uff09\u3092\u898b\u305b\u308b\u3088\u3046\u306b\u306a\u308b\n\n\n\u98df\u3079\u305f\u3044\n\n\nUSB \u30c7\u30d0\u30a4\u30b9\u3068\u901a\u4fe1\u3059\u308b\u524d\u306b\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u30e6\u30fc\u30b6\u304b\u3089\u8a31\u53ef\u3092\u5f97\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u540c\u3058\u304f\u3001\u5b50\u4f9b\u306f\u3001\u300c\u98df\u3079\u305f\u3044\u300d\u3068\u8a00\u3063\u3066\u3001\u6bcd\u306f\u5206\u304b\u308b\u3088\u3046\u306b\u306a\u308b\n\u5b9f\u88c5\u306b\u5bfe\u3057\u3066\u3001\u4e09\u3064\u306e\u30dd\u30a4\u30f3\u30c8\u304c\u3042\u308b\n\n\u30d6\u30ed\u30fc\u30c9\u30ad\u30e3\u30b9\u30c8\u30ec\u30b7\u30fc\u30d0\u3092\u4f5c\u6210\n\n\nprivate static final String ACTION_USB_PERMISSION =\n    \"com.android.example.USB_PERMISSION\";\nprivate final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() {\n\n    public void onReceive(Context context, Intent intent) {\n        String action = intent.getAction();\n        if (ACTION_USB_PERMISSION.equals(action)) {\n            synchronized (this) {\n                UsbDevice device = (UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);\n\n                if (intent.getBooleanExtra(UsbManager.EXTRA_PERMISSION_GRANTED, false)) {\n                    if(device != null){\n                      //call method to set up device communication\n                   }\n                } \n                else {\n                    Log.d(TAG, \"permission denied for device \" + device);\n                }\n            }\n        }\n    }\n};\n\n\n2. registerReceiver\u3092\u3001onCreate\u30e1\u30bd\u30c3\u30c9\u306b\u8a2d\u5b9a\u3059\u308b\n\nUsbManager mUsbManager = (UsbManager) getSystemService(Context.USB_SERVICE);\nprivate static final String ACTION_USB_PERMISSION =\n    \"com.android.example.USB_PERMISSION\";\n...\nmPermissionIntent = PendingIntent.getBroadcast(this, 0, new Intent(ACTION_USB_PERMISSION), 0);\nIntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);\nregisterReceiver(mUsbReceiver, filter);\n\n\n3. \u30e6\u30fc\u30b6\u306b\u30c7\u30d0\u30a4\u30b9\u3068\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u8a31\u53ef\u3092\u5f97\u308b\u305f\u3081\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u8868\u793a\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b requestPermission() \u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\n\nUsbDevice device;\n...\nmUsbManager.requestPermission(device, mPermissionIntent);\n\n\n\u88dc\u8db3\n\n\u3053\u306e\u6587\u66f8\u306f\u3001\u521d\u5fc3\u8005\u306f\u3001USB\u30c7\u30d0\u30a4\u30b9\u3092\u901a\u4fe1\u3059\u308b\u305f\u3081\u306b\u3001\u30c7\u30d0\u30a4\u30b9\u767a\u898b\u3001\u5217\u6319\u3001\u8a31\u53ef\u53d6\u5f97\u3092\u8aac\u660e\u3059\u308b\u3051\u3069\u3001\u8a73\u3057\u3044\u5185\u5bb9\u3092\u3053\u3053\u306e\u6587\u66f8\u3092\u898b\u3066\u304f\u3060\u3055\u3044\n\n## \u80cc\u666f\n* 2014\u5e746\u6708\u304b\u3089\u3001Android\u52c9\u5f37\u3092\u59cb\u3081\u3066\u3001\u307e\u3060\u521d\u5fc3\u8005\u3060\u3002\n* USB Camera\u3092Android external device\u3068\u3057\u3066\u4f7f\u3044\u305f\u3044\uff08\u5927\u304d\u3044\u76ee\u6a19\u3060\u3063\u305f\uff09\n\n## \u76ee\u7684\n* USB\u30c7\u30d0\u30a4\u30b9\u3068\u901a\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\n* \u901a\u4fe1\u524d\u306b\u3001\u30c7\u30d0\u30a4\u30b9\u767a\u898b\u3001\u5217\u6319\u3001\u8a31\u53ef\u53d6\u5f97\u306a\u3069\u306e\u4f5c\u696d\u3092\u8aac\u660e\u3059\u308b\n\n## \u5b50\u4f9b\u3001\u6bcd\u3001\u304a\u83d3\u5b50\n#### \u4f55\u3053\u308c\uff1f\n* \u79c1\u306f\u3001\u521d\u3081\u3066[\u3053\u306e\u6587\u66f8](http://developer.android.com/guide/topics/connectivity/usb/host.html)\u3092\u8aad\u3093\u3060\u3068\u304d\u306b\u3001\u901a\u4fe1\u4ee5\u5916\u306e\u51e6\u7406\u306f\u3001\u4f55\u306e\u3064\u3082\u308a\u304b\u306e\u3053\u3068\u304c\u3001\u5168\u7136\u5206\u304b\u3089\u306a\u3044\n* \u305d\u306e\u4ed6\u306e\u521d\u5fc3\u8005\u306f\u3001\u540c\u611f\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\n* \u3053\u3053\u3067\u3001\u5b50\u4f9b\u3001\u6bcd\u3001\u304a\u83d3\u5b50\u306e\u4f8b\u3067\u3001\u8aac\u660e\u3057\u305f\u3044\u3068\u601d\u3046\n * \u5b50\u4f9b = \u30e6\u30fc\u30b6\n * \u6bcd  = \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\n * \u304a\u83d3\u5b50 = USB\u30c7\u30d0\u30a4\u30b9\n\n#### \u5b50\u4f9b\u306f\u3001\u3069\u3046\u304a\u83d3\u5b50\u3092\u3082\u3089\u3048\u308b\u304b\n* \u4e16\u754c\u306b\u3001\u3044\u308d\u3044\u308d\u306a\u304a\u83d3\u5b50\u304c\u3042\u308b\u3051\u3069\u3001\u6bcd\u306f\u3001\u81ea\u5206\u306e\u5b50\u4f9b\u3092\u98df\u3079\u308c\u308b\u304a\u83d3\u5b50\u306b\u5bfe\u3057\u3066\u3001\u304a`\u83d3\u5b50\u30ea\u30b9\u30c8`\u3092\u6301\u3063\u3066\u3044\u308b\n* \u3053\u306e\u304a\u83d3\u5b50\u30ea\u30b9\u30c8\u3088\u308a\u3001\u6bcd\u306f\u3001\u73fe\u5728\u306b\u8cb0\u3048\u308b\u304a\u83d3\u5b50\u304b\u3089\u3001`\u304a\u83d3\u5b50\u3092\u5217\u6319\u3059\u308b`\u3001\u5b50\u4f9b\u306b\u9078\u629e\u3055\u305b\u308b\n* \u5b50\u4f9b\u306f\u3001\u597d\u304d\u306a\u304a\u83d3\u5b50\u306b\u3001`\u98df\u3079\u305f\u3044`\u3092\u558b\u3063\u3066\u3001\u6bcd\u306f\u3001\u3053\u306e\u304a\u83d3\u5b50\u3092\u5b50\u4f9b\u306b\u3042\u3052\u308b\n\n## \u901a\u4fe1\u524d\u306b\u3001\u3044\u308d\u3044\u308d\u306a\u4f5c\u696d\u3092\u8aac\u660e\u3059\u308b\n####  `\u83d3\u5b50\u30ea\u30b9\u30c8`\n* \u6bcd\u306f\u3001\u6301\u3063\u3066\u3044\u308b`\u83d3\u5b50\u30ea\u30b9\u30c8`\u304c\u3001res/xml\u306e\u4e0b\u306b\u3001\u653e\u7f6e\u3067\u304d\u308b\uff08\u4f8b\uff1ares/xml/device_filter.xml\uff09\n* \u5e0c\u671b\u3059\u308b USB \u30c7\u30d0\u30a4\u30b9\u3092\u7279\u5b9a\u3057\u305f\u5bfe\u5fdc\u3059\u308b\u30ea\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u3092\u5ba3\u8a00\u3059\u308b\u65b9\u6cd5\u306e\u4f8b\u3092\u4ee5\u4e0b\u306b\n\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<resources>\n    <usb-device vendor-id=\"1234\" product-id=\"5678\" class=\"255\" subclass=\"66\" protocol=\"1\" />\n</resources>\n```\n\n* \u4ee5\u4e0a\u306e\u6761\u4ef6\u3088\u308a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08\u6bcd\uff09\u304c\u3001\u30c7\u30d0\u30a4\u30b9\u3092\u9078\u3079\u308c\u3066\u3001\u305d\u306e\u4ee5\u5916\u306e\u304a\u83d3\u5b50\u3092\u7121\u8996\u3059\u308b\n\n* \u5c0e\u5165\n\n```\n\n<activity ...>\n...\n    <intent-filter>\n        <action android:name=\"android.hardware.usb.action.USB_DEVICE_ATTACHED\" />\n    </intent-filter>\n\n    <meta-data android:name=\"android.hardware.usb.action.USB_DEVICE_ATTACHED\"\n        android:resource=\"@xml/device_filter\" />\n</activity>\n```\n\n* \u4ee5\u4e0b\u306e\u30ed\u30b0\u3092\u53c2\u7167\u3057\u3066\u3001vendor-id\u306a\u3069\u306e\u610f\u5473\u3092\u7406\u89e3\u3067\u304d\u308b\u3068\u601d\u3046\n\n```\nUsbDevice[mName=/dev/bus/usb/001/002,mVendorId=1133,mProductId=2093,mClass=239,mSubclass=2,mProtocol=1,mInterfaces=[Landroid.os.Parcelable;@41eabd00]\n```\n\n#### `\u304a\u83d3\u5b50\u3092\u5217\u6319\u3059\u308b`\n* \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3(\u6bcd)\u306f\u3001`\u83d3\u5b50\u30ea\u30b9\u30c8`\u3088\u308a\u3001\u9078\u3079\u51fa\u3057\u305f\u304a\u83d3\u5b50\u3092\u3001\u30e6\u30fc\u30b6\uff08\u5b50\u4f9b\uff09\u306b\u5217\u6319\u3059\u308b\n\n```\nUsbManager manager = (UsbManager) getSystemService(Context.USB_SERVICE);\n...\nHashMap<String, UsbDevice> deviceList = manager.getDeviceList();\nIterator<UsbDevice> deviceIterator = deviceList.values().iterator();\nwhile(deviceIterator.hasNext()){\n    UsbDevice device = deviceIterator.next()\n    //your code\n}\n```\n\n* Dialogframent\u306a\u3069\u30af\u30e9\u30b9\u3092\u4f7f\u3063\u3066\u3001\u30e6\u30fc\u30b6\uff08\u5b50\u4f9b\uff09\u3092\u898b\u305b\u308b\u3088\u3046\u306b\u306a\u308b\n\n\n#### `\u98df\u3079\u305f\u3044`\n* USB \u30c7\u30d0\u30a4\u30b9\u3068\u901a\u4fe1\u3059\u308b\u524d\u306b\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306f\u30e6\u30fc\u30b6\u304b\u3089\u8a31\u53ef\u3092\u5f97\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\u540c\u3058\u304f\u3001\u5b50\u4f9b\u306f\u3001\u300c\u98df\u3079\u305f\u3044\u300d\u3068\u8a00\u3063\u3066\u3001\u6bcd\u306f\u5206\u304b\u308b\u3088\u3046\u306b\u306a\u308b\n\n* \u5b9f\u88c5\u306b\u5bfe\u3057\u3066\u3001\u4e09\u3064\u306e\u30dd\u30a4\u30f3\u30c8\u304c\u3042\u308b\n\n* 1. \u30d6\u30ed\u30fc\u30c9\u30ad\u30e3\u30b9\u30c8\u30ec\u30b7\u30fc\u30d0\u3092\u4f5c\u6210\n\n```\nprivate static final String ACTION_USB_PERMISSION =\n    \"com.android.example.USB_PERMISSION\";\nprivate final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() {\n\n    public void onReceive(Context context, Intent intent) {\n        String action = intent.getAction();\n        if (ACTION_USB_PERMISSION.equals(action)) {\n            synchronized (this) {\n                UsbDevice device = (UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);\n\n                if (intent.getBooleanExtra(UsbManager.EXTRA_PERMISSION_GRANTED, false)) {\n                    if(device != null){\n                      //call method to set up device communication\n                   }\n                } \n                else {\n                    Log.d(TAG, \"permission denied for device \" + device);\n                }\n            }\n        }\n    }\n};\n```\n\n* 2. registerReceiver\u3092\u3001onCreate\u30e1\u30bd\u30c3\u30c9\u306b\u8a2d\u5b9a\u3059\u308b\n\n```\nUsbManager mUsbManager = (UsbManager) getSystemService(Context.USB_SERVICE);\nprivate static final String ACTION_USB_PERMISSION =\n    \"com.android.example.USB_PERMISSION\";\n...\nmPermissionIntent = PendingIntent.getBroadcast(this, 0, new Intent(ACTION_USB_PERMISSION), 0);\nIntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);\nregisterReceiver(mUsbReceiver, filter);\n```\n\n* 3. \u30e6\u30fc\u30b6\u306b\u30c7\u30d0\u30a4\u30b9\u3068\u63a5\u7d9a\u3059\u308b\u305f\u3081\u306e\u8a31\u53ef\u3092\u5f97\u308b\u305f\u3081\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u3092\u8868\u793a\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b requestPermission() \u30e1\u30bd\u30c3\u30c9\u3092\u547c\u3073\u51fa\u3059\n\n```\nUsbDevice device;\n...\nmUsbManager.requestPermission(device, mPermissionIntent);\n```\n\n\n## \u88dc\u8db3\n* \u3053\u306e\u6587\u66f8\u306f\u3001\u521d\u5fc3\u8005\u306f\u3001USB\u30c7\u30d0\u30a4\u30b9\u3092\u901a\u4fe1\u3059\u308b\u305f\u3081\u306b\u3001\u30c7\u30d0\u30a4\u30b9\u767a\u898b\u3001\u5217\u6319\u3001\u8a31\u53ef\u53d6\u5f97\u3092\u8aac\u660e\u3059\u308b\u3051\u3069\u3001\u8a73\u3057\u3044\u5185\u5bb9\u3092[\u3053\u3053](http://developer.android.com/guide/topics/connectivity/usb/host.html)\u306e\u6587\u66f8\u3092\u898b\u3066\u304f\u3060\u3055\u3044\n", "tags": ["Android", "Java", "USB", "\u901a\u4fe1"]}