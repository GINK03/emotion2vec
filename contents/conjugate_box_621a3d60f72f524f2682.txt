{"context": "\u3053\u308c\u306fHierarchical Probabilistic Neural Network Language Model \u306b\u767b\u5834\u3059\u308bHierarchical Softmax(\u4ee5\u964dhSm)\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u66f8\u304f\u3082\u306e\u3067\u3059\uff0e\n\u5206\u985e\u554f\u984c(\u7279\u306bsoftmax\u95a2\u6570)\u306b\u95a2\u3059\u308b\u57fa\u672c\u7684\u306a\u77e5\u8b58\u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\uff0e\u3042\u3068\u30cf\u30d5\u30de\u30f3\u6728\u304c\u3069\u306e\u3088\u3046\u306b\u69cb\u6210\u3055\u308c\u308b\u304b\u306b\u3064\u3044\u3066\u77e5\u3063\u3066\u3044\u308b\u65b9\u3068\u7406\u89e3\u304c\u30b9\u30e0\u30fc\u30ba\u306b\u9032\u3080\u304b\u3068\u601d\u3044\u307e\u3059\uff0e\n\n\u624b\u6cd5\u306e\u80cc\u666f\nNeural Network\u3092\u7528\u3044\u3066\u6587\u5b57\u5217\u306e\u751f\u6210\u3092\u3059\u308b\u5834\u5408\uff0c\u4e00\u822c\u306b\u30e9\u30d9\u30eb(\u5358\u8a9e)\u306e\u4e88\u6e2c\u306b\u306fSoftmax\u95a2\u6570\u304c\u7528\u3044\u3089\u308c\u308b\uff0eSoftmax\u95a2\u6570\u306fml=\u27e8wl,x\u27e9ml=\u27e8wl,x\u27e9m_l = \\langle \\mathbf{w}_l, \\mathbf{x} \\rangle\u3068\u3057\u305f\u6642\uff0c\np(l\\mid \\mathbf{x}) = \\frac{1}{Z} exp(m_l)\\\\\nZ=\\sum_k^K exp(m_k)\np(l\u2223x)=1Zexp(ml)Z=K\u2211kexp(mk)p(l\u2223x)=1Zexp(ml)Z=\u2211kKexp(mk){p(l\\mid \\mathbf{x}) = \\frac{1}{Z} exp(m_l)\\\\\nZ=\\sum_k^K exp(m_k)\n}\n\u3067\u5b9a\u7fa9\u3055\u308c\u308b\u95a2\u6570\u3067\u3042\u308b\uff0e\u81ea\u7136\u8a00\u8a9e\u3067\u8a9e\u5f59\u3092\u8003\u3048\u308b\u5834\u5408\uff0c\u8f9e\u66f8\u306f\u6570\u4e07\u5358\u4f4d\u306e\u30b5\u30a4\u30ba\u306b\u306a\u308b\uff0e\u305d\u306e\u305f\u3081\uff0cZ=\u2211Kkexp(mk)Z=\u2211Kkexp(mk)Z=\\sum_k^K exp(m_k)\u306e\u8a08\u7b97\u304c\u975e\u5e38\u306b\u30cf\u30a4\u30b3\u30b9\u30c8\u306b\u306a\u308b\u3068\u3044\u3046\u554f\u984c\u304c\u3042\u3063\u305f\uff0e\n\u3053\u306e\u554f\u984c\u3092\u89e3\u6c7a\u3057\u3088\u3046\u3068\u3059\u308b\u624b\u6cd5\u306b\u306f\uff0c\u304a\u3088\u305d\u6b21\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u3042\u308b\uff0e\n\u968e\u5c64\u5206\u985e1\n\u3000\u30af\u30e9\u30b9\u306b\u968e\u5c64\u69cb\u9020\u3092\u8003\u3048\u308b\uff0e\n\u3000\u4eca\u56de\u6271\u3046hSm\u306f\u3053\u308c\u306e\u4e00\u7a2e\uff0e\nNoise Constrastive Estimation2\n\u3000\u9593\u63a5\u7684\u306b\u78ba\u7387\u5206\u5e03ppp\u3092\u5b66\u7fd2\u3059\u308b\uff0e\n\u3000\u6d41\u884c\u308a\u306eGenerative Adversarial Net\u306f\u3053\u308c\u3092NN\u3068\u3057\u3066\u591a\u5c64\u5316\u3057\u305f\u3082\u306e\nNegative sample3\n\u3000\u6b63\u89e3\u4ee5\u5916\u306e\u30e9\u30d9\u30eb\u3092\u30b5\u30f3\u30d7\u30eb\u3057\u3066\u6570\u3092\u6e1b\u3089\u3057\uff0c\u591a\u30af\u30e9\u30b9\u3068\u3057\u3066\u5b66\u7fd2\u3059\u308b\u3082\u306e\uff0e\n\u3000NCE\u3068\u6df7\u5408\u3055\u308c\u3084\u3059\u3044\u6c17\u304c\u3059\u308b\u304c\u5225\uff0e\nSelf-normalization\n\u3000\u6b63\u5247\u5316\u9805\u3092\u6d3b\u7528\u3057\u3066Z=1Z=1Z=1\u306b\u306a\u308b\u3088\u3046\u306b\u5236\u7d04\u3092\u304b\u3051\u308b\u307d\u3044\uff0e\u8a73\u3057\u304f\u628a\u63e1\u3057\u3066\u306a\u3044\n\u672c\u8a18\u4e8b\u306f\uff0c\u968e\u5c64\u5206\u985e\u3092\u5b9f\u73fe\u3059\u308b\u6728\u69cb\u9020\u3092\u7528\u3044\u305fsoftmax\u306e\u6027\u8cea\u306b\u3064\u3044\u3066\u8a71\u3059\u3082\u306e\u3067\u3059\uff0e\n\nHierarchical Softmax\u3068\u306f\n\u5f0f\u3092\u7d30\u3005\u66f8\u3044\u3066\u3082\u9762\u5012\u306a\u306e\u3067\uff0c\u56f3\u3067\u306e\u8aac\u660e\u3092\u8a66\u307f\u308b\uff0e\n4\u30af\u30e9\u30b9\u306e\u5206\u985e\u554f\u984c\u3067\uff0c\u305d\u308c\u305e\u308c\u306e\u30e9\u30d9\u30eb\u304cl1,l2,l3,l4l1,l2,l3,l4l_1,l_2,l_3,l_4\u3060\u3068\u3059\u308b\uff0e\u3053\u306e\u5206\u985e\u554f\u984c\u3092\u56f3\u3067\u8aac\u660e\u3059\u308b\u3068\uff0c\u6700\u521dRoot\u30ce\u30fc\u30c9\u306b\u3044\u3066\uff0c\u305d\u308c\u305e\u308c\u306e\u30e9\u30d9\u30eb\u306b\u5bfe\u5fdc\u3059\u308bleaf\u30ce\u30fc\u30c9\u304c\u3042\u3063\u3066\uff0c\u305d\u306e\u3069\u308c\u304b\u306b\u79fb\u308b\u306e\u3068\u540c\u3058\u306b\u306a\u308b\uff0e\n\n\u3053\u308c\u306b\u5bfe\u3057\uff0chSm\u306f\u6b21\u306e\u3088\u3046\u306b\u30e9\u30d9\u30eb\u306b\u69cb\u9020\u3092\u8003\u3048\u308b\uff0e\n\n\u5148\u306e\u8aac\u660e\u306b\u57fa\u3065\u3051\u3070\uff0cRoot\u30ce\u30fc\u30c9\u306b\u3044\u3066\uff0c\u6700\u521d\u306fh1h1h_1\u30ce\u30fc\u30c9\u304bh2h2h_2\u30ce\u30fc\u30c9\u30ce\u30fc\u30c9\u306b\u884c\u304f\u304b\u3092\u5206\u985e\u554f\u984c\u3068\u3057\u3066\u6c7a\u5b9a\u3059\u308b\uff0e\u4f8b\u3048\u3070h1h_1\u30ce\u30fc\u30c9\u306b\u79fb\u3063\u305f\u3068\u3057\u3066\uff0c\u6b21\u306fl1l_1\u30ce\u30fc\u30c9\u304bl2l_2\u30ce\u30fc\u30c9\u306b\u79fb\u308b\u304b\u3092\u5206\u985e\u554f\u984c\u3068\u3057\u3066\u6c7a\u5b9a\u3059\u308b\uff0e\n\u3053\u306e\u3088\u3046\u306bhSm\u306f\u69cb\u6210\u3057\u305f2\u5206\u6728\u3092\u6d3b\u7528\u3059\u308b\u3053\u3068\u3067\n\n\u5404\u30ce\u30fc\u30c9\u306e\u5206\u985e\u306fbinary classification\u306a\u306e\u3067ZZ\u306e\u8a08\u7b97\u3082\u554f\u984c\u3067\u306a\u304f\u306a\u308b\uff0e\n\u5206\u985e\u3092\u6c7a\u5b9a\u3059\u308b\u306e\u306b\u5fc5\u8981\u306a\u30d9\u30af\u30c8\u30eb\u306e\u6570\u304c\u5bfe\u6570\u306e\u30aa\u30fc\u30c0\u3067\u3059\u3080\u3088\u3046\u306b\u306a\u308b\n\n\u3068\u3044\u3046\u30e1\u30ea\u30c3\u30c8\u3092\u6301\u3064\uff0e\u3053\u308c\u3089\u306e\u7d50\u679c\u3068\u3057\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u66f4\u65b0\u3092\u9ad8\u901f\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b4\uff0e\n\nHierarchical Softmax\u306e\u6027\u8cea\nhSm\u306e\u6027\u8cea\u3068\u3057\u3066\u6b21\u306e\u70b9\u3092\u6319\u3052\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\n\n\u66f4\u65b0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u30d9\u30af\u30c8\u30eb\u306e\u6570\u304c\u5bfe\u6570\u30aa\u30fc\u30c0\u306b\u306a\u308b\uff0e\n\u30cf\u30d5\u30de\u30f3\u6728\u3092\u7528\u3044\u308b\u306a\u3069\u3059\u308b\u3068\u5404\u30ce\u30fc\u30c9\u3067\u30c7\u30fc\u30bf\u304cbalanced data\u306b\u8fd1\u3065\u304f\n\u901a\u5e38\u306e\u591a\u30af\u30e9\u30b9softmax\u3067\u306f\u4e0a\u624b\u304f\u5b66\u7fd2\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u304c\uff0c\u968e\u5c64\u5316\u3057\u305f\u3082\u306e\u3067\u306f\u6349\u3048\u308c\u304d\u308c\u306a\u3044\u5834\u5408\u304c\u5b58\u5728\u3059\u308b\n\n1\u306f\u4e0a\u3067\u898b\u305f\u3082\u306e\u3068\u540c\u3058\u3067\u3042\u308b\uff0e2\u3082\uff0c\u30cf\u30d5\u30de\u30f3\u6728\u304c\u3069\u3093\u306a\u3082\u306e\u304b\u8003\u3048\u3066\u3082\u3089\u3048\u308c\u3070\u9069\u5f53\u306b\u5206\u304b\u308b\u3068\u601d\u30465\uff0e\u3068\u3044\u3046\u3053\u3068\u3067\uff0c3\u306e\u8aac\u660e\u3092\u6700\u5f8c\u3068\u3057\u3066\u672c\u8a18\u4e8b\u306f\u7d42\u308f\u308b\uff0e\n\nhierarhical Softmax\u306e\u8fd1\u4f3c\u306b\u3064\u3044\u3066\n\u4f8b\u3048\u3070\u771f\u306e\u5206\u5e03\u304c\u6b21\u306e\u56f3\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3042\u3063\u305f\u3068\u3059\u308b\uff0e\n\n\u3053\u308c\u306f\u5148\u8ff0\u306e4\u30af\u30e9\u30b9\u306e\u5834\u5408\u3067\u3042\u308a\uff0c\u901a\u5e38\u306esoftmax\u95a2\u6570\u3067\u3042\u308c\u3070\u3053\u306e\u5f62\u306f\u6349\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\u3057\u304b\u3057\uff0chSm\u306e\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306a\u5f62\u3067\u5206\u985e\u3092\u3059\u308b\u3053\u3068\u306b\u306a\u308b\uff0e\u307e\u305a\u7a7a\u9593\u3092\u30ce\u30fc\u30c9h1h_1\u3068\u30ce\u30fc\u30c9h2h_2\u306b\u8a72\u5f53\u3059\u308b\u3088\u3046\u306b\u533a\u5207\u3063\u3066\n\n\u6b21\u306b\u305d\u308c\u305e\u308c\u533a\u5207\u3089\u308c\u305f\u9818\u57df\u3067\u518d\u5ea6\u5206\u985e\u3092\u884c\u3063\u3066\n\n\u306e\u3088\u3046\u306a\u5f62\u306b\u306a\u308b\uff0e\u305d\u3057\u3066\u3053\u306e\u65b9\u6cd5\u3067\u306f\uff0c\u30ab\u30e9\u30d5\u30eb\u306a4\u30af\u30e9\u30b9\u306e\u56f3\u306e\u5834\u5408\u3092\u6b63\u78ba\u306b\u6349\u3048\u308b\u3053\u3068\u306f\u3067\u304d\u306a\u3044\uff0e6\n\n\u307e\u3068\u3081\u7684\u306a\u3082\u306e\n\u30e1\u30ea\u30c3\u30c8\n\nHierarchical Softmax\u306f\u6728\u69cb\u9020\u3092\u6d3b\u7528\u3059\u308b\uff0e\n\u5404\u30ce\u30fc\u30c9\u306e\u5206\u985e\u306fbinary classification\u306a\u306e\u3067ZZ\u306e\u8a08\u7b97\u3082\u554f\u984c\u3067\u306a\u304f\u306a\u308b\uff0e\n\u5206\u985e\u3092\u6c7a\u5b9a\u3059\u308b\u306e\u306b\u5fc5\u8981\u306a\u30d9\u30af\u30c8\u30eb\u306e\u6570\u304c\u5bfe\u6570\u306e\u30aa\u30fc\u30c0\u3067\u3059\u3080\u3088\u3046\u306b\u306a\u308b\n\u6728\u69cb\u9020\u3092\u4e0a\u624b\u304f\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\uff0c\u4f8b\u3048\u3070balanced data\u306b\u8fd1\u3065\u304f\u306a\u3069\u826f\u3044\u3053\u3068\u304c\u3042\u308b\n\n\u30c7\u30e1\u30ea\u30c3\u30c8\n\n\u968e\u5c64\u5316\u306b\u3088\u3063\u3066\u8868\u73fe\u529b\u304c\u4e0b\u304c\u308b\uff0e\nGPU\u3067\u306e\u9ad8\u901f\u5316\u306e\u6069\u6075\u3092\u4eab\u53d7\u3057\u306b\u304f\u3044\n\n\n\n\n\n\u65b9\u5411\u6027\u306f\u9055\u3046\u3051\u3069Local Deep Kernel Learning for Efficient Non-linear SVM Prediction\u3082\u3053\u308c\u306e\u4e00\u7a2e\u306b\u306a\u308b\u306f\u305a\uff0eICML2013\u8aad\u307f\u4f1a Local Deep Kernel Learning for Efficient Non-linear SVM Prediction\u3067\u89e3\u8aac\u3055\u308c\u3066\u308b\u65b9\u304c\u3044\u308b\uff0e\u00a0\u21a9\n\n\nNoise-Contrastive Estimation of Unnormalized Statistical Models,with Applications to Natural Image Statistics\u00a0\u21a9\n\n\nDistributed Representations of Words and Phrases and their Compositionality\u00a0\u21a9\n\n\n\u4e26\u5217\u5316\u3092\u7528\u3044\u3066\u3088\u308a\u9ad8\u901f\u5316\u3057\u3088\u3046\u307f\u305f\u3044\u306a\u8a71Word2vec\u306e\u4e26\u5217\u5b9f\u884c\u6642\u306e\u5b66\u7fd2\u901f\u5ea6\u306e\u6539\u5584\u3082\u3042\u308b\u00a0\u21a9\n\n\n\u5fc5\u8981\u306a\u3089\u8ffd\u8a18\u3059\u308b\u306e\u3067\u30b3\u30e1\u30f3\u30c8\u3067\u3082\u66f8\u3044\u3066\u4e0b\u3055\u3044\u00a0\u21a9\n\n\nHierarchical Probabilistic Neural Network Language Model\u3067\u306fhSm\u3092\u4f7f\u3063\u305f\u30e2\u30c7\u30eb\u306b\u3082\u304b\u304b\u308f\u3089\u305a\uff0cperplexity\u306e\u5411\u4e0a\u304c\u5831\u544a\u3055\u308c\u3066\u3044\u308b\uff0e\u3053\u308c\u306f\u30e2\u30c7\u30eb\u304clog Bi-linear\u3067\u5165\u529b\u30d9\u30af\u30c8\u30eb\u81ea\u4f53\u306e\u81ea\u7531\u5ea6\u304c\u9ad8\u304b\u3063\u305f\u3053\u3068\uff0c\u307e\u305f\u30bf\u30b9\u30af\u304cperplexity\u3067\u6a5f\u68b0\u7ffb\u8a33\u306e\u3088\u3046\u306a\u8907\u96d1\u306a\u3053\u3068\u3092\u5fc5\u8981\u3068\u3057\u306a\u304b\u3063\u305f\u3053\u3068\uff0cbalanced data\u306b\u8fd1\u3065\u3044\u305f\u5f71\u97ff\u306b\u3088\u308b\u3082\u306e\uff0c\u7b49\u304c\u8003\u3048\u3089\u308c\u308b\u00a0\u21a9\n\n\n\n\u3053\u308c\u306f[Hierarchical Probabilistic Neural Network Language Model] (http://www.iro.umontreal.ca/~lisa/pointeurs/hierarchical-nnlm-aistats05.pdf) \u306b\u767b\u5834\u3059\u308bHierarchical Softmax(\u4ee5\u964dhSm)\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u66f8\u304f\u3082\u306e\u3067\u3059\uff0e\n\u5206\u985e\u554f\u984c(\u7279\u306bsoftmax\u95a2\u6570)\u306b\u95a2\u3059\u308b\u57fa\u672c\u7684\u306a\u77e5\u8b58\u3092\u5fc5\u8981\u3068\u3057\u307e\u3059\uff0e\u3042\u3068\u30cf\u30d5\u30de\u30f3\u6728\u304c\u3069\u306e\u3088\u3046\u306b\u69cb\u6210\u3055\u308c\u308b\u304b\u306b\u3064\u3044\u3066\u77e5\u3063\u3066\u3044\u308b\u65b9\u3068\u7406\u89e3\u304c\u30b9\u30e0\u30fc\u30ba\u306b\u9032\u3080\u304b\u3068\u601d\u3044\u307e\u3059\uff0e\n\n##\u624b\u6cd5\u306e\u80cc\u666f\n\nNeural Network\u3092\u7528\u3044\u3066\u6587\u5b57\u5217\u306e\u751f\u6210\u3092\u3059\u308b\u5834\u5408\uff0c\u4e00\u822c\u306b\u30e9\u30d9\u30eb(\u5358\u8a9e)\u306e\u4e88\u6e2c\u306b\u306fSoftmax\u95a2\u6570\u304c\u7528\u3044\u3089\u308c\u308b\uff0eSoftmax\u95a2\u6570\u306f$m_l = \\langle \\mathbf{w}_l, \\mathbf{x} \\rangle$\u3068\u3057\u305f\u6642\uff0c\n\n```math\np(l\\mid \\mathbf{x}) = \\frac{1}{Z} exp(m_l)\\\\\nZ=\\sum_k^K exp(m_k)\n```\n\n\u3067\u5b9a\u7fa9\u3055\u308c\u308b\u95a2\u6570\u3067\u3042\u308b\uff0e\u81ea\u7136\u8a00\u8a9e\u3067\u8a9e\u5f59\u3092\u8003\u3048\u308b\u5834\u5408\uff0c\u8f9e\u66f8\u306f\u6570\u4e07\u5358\u4f4d\u306e\u30b5\u30a4\u30ba\u306b\u306a\u308b\uff0e\u305d\u306e\u305f\u3081\uff0c$Z=\\sum_k^K exp(m_k)$\u306e\u8a08\u7b97\u304c\u975e\u5e38\u306b\u30cf\u30a4\u30b3\u30b9\u30c8\u306b\u306a\u308b\u3068\u3044\u3046\u554f\u984c\u304c\u3042\u3063\u305f\uff0e\n\u3053\u306e\u554f\u984c\u3092\u89e3\u6c7a\u3057\u3088\u3046\u3068\u3059\u308b\u624b\u6cd5\u306b\u306f\uff0c\u304a\u3088\u305d\u6b21\u306e\u3088\u3046\u306a\u3082\u306e\u304c\u3042\u308b\uff0e\n\n**\u968e\u5c64\u5206\u985e[^7]**\n\u3000\u30af\u30e9\u30b9\u306b\u968e\u5c64\u69cb\u9020\u3092\u8003\u3048\u308b\uff0e\n\u3000\u4eca\u56de\u6271\u3046hSm\u306f\u3053\u308c\u306e\u4e00\u7a2e\uff0e\n**Noise Constrastive Estimation[^4]**\n\u3000\u9593\u63a5\u7684\u306b\u78ba\u7387\u5206\u5e03$p$\u3092\u5b66\u7fd2\u3059\u308b\uff0e\n\u3000\u6d41\u884c\u308a\u306eGenerative Adversarial Net\u306f\u3053\u308c\u3092NN\u3068\u3057\u3066\u591a\u5c64\u5316\u3057\u305f\u3082\u306e\n**Negative sample[^5]**\n\u3000\u6b63\u89e3\u4ee5\u5916\u306e\u30e9\u30d9\u30eb\u3092\u30b5\u30f3\u30d7\u30eb\u3057\u3066\u6570\u3092\u6e1b\u3089\u3057\uff0c\u591a\u30af\u30e9\u30b9\u3068\u3057\u3066\u5b66\u7fd2\u3059\u308b\u3082\u306e\uff0e\n\u3000NCE\u3068\u6df7\u5408\u3055\u308c\u3084\u3059\u3044\u6c17\u304c\u3059\u308b\u304c\u5225\uff0e\n**Self-normalization**\n\u3000\u6b63\u5247\u5316\u9805\u3092\u6d3b\u7528\u3057\u3066$Z=1$\u306b\u306a\u308b\u3088\u3046\u306b\u5236\u7d04\u3092\u304b\u3051\u308b\u307d\u3044\uff0e\u8a73\u3057\u304f\u628a\u63e1\u3057\u3066\u306a\u3044\n\n\n[^4]: [Noise-Contrastive Estimation of Unnormalized Statistical Models,with Applications to Natural Image Statistics](https://www.cs.helsinki.fi/u/ahyvarin/papers/Gutmann12JMLR.pdf)\n\n[^5]: [Distributed Representations of Words and Phrases and their Compositionality](https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf)\n\n[^7]: \u65b9\u5411\u6027\u306f\u9055\u3046\u3051\u3069[Local Deep Kernel Learning for Efficient Non-linear SVM Prediction](http://research.microsoft.com/en-us/um/people/manik/pubs%5Cjose13.pdf)\u3082\u3053\u308c\u306e\u4e00\u7a2e\u306b\u306a\u308b\u306f\u305a\uff0e[ICML2013\u8aad\u307f\u4f1a Local Deep Kernel Learning for Efficient Non-linear SVM Prediction](http://www.slideshare.net/beam2d/icml2013-local-deep-kernel-learning)\u3067\u89e3\u8aac\u3055\u308c\u3066\u308b\u65b9\u304c\u3044\u308b\uff0e\n\n\n\u672c\u8a18\u4e8b\u306f\uff0c\u968e\u5c64\u5206\u985e\u3092\u5b9f\u73fe\u3059\u308b\u6728\u69cb\u9020\u3092\u7528\u3044\u305fsoftmax\u306e\u6027\u8cea\u306b\u3064\u3044\u3066\u8a71\u3059\u3082\u306e\u3067\u3059\uff0e\n\n##Hierarchical Softmax\u3068\u306f\n\n\u5f0f\u3092\u7d30\u3005\u66f8\u3044\u3066\u3082\u9762\u5012\u306a\u306e\u3067\uff0c\u56f3\u3067\u306e\u8aac\u660e\u3092\u8a66\u307f\u308b\uff0e\n4\u30af\u30e9\u30b9\u306e\u5206\u985e\u554f\u984c\u3067\uff0c\u305d\u308c\u305e\u308c\u306e\u30e9\u30d9\u30eb\u304c$l_1,l_2,l_3,l_4$\u3060\u3068\u3059\u308b\uff0e\u3053\u306e\u5206\u985e\u554f\u984c\u3092\u56f3\u3067\u8aac\u660e\u3059\u308b\u3068\uff0c\u6700\u521dRoot\u30ce\u30fc\u30c9\u306b\u3044\u3066\uff0c\u305d\u308c\u305e\u308c\u306e\u30e9\u30d9\u30eb\u306b\u5bfe\u5fdc\u3059\u308bleaf\u30ce\u30fc\u30c9\u304c\u3042\u3063\u3066\uff0c\u305d\u306e\u3069\u308c\u304b\u306b\u79fb\u308b\u306e\u3068\u540c\u3058\u306b\u306a\u308b\uff0e\n![\u7121\u984c\u306e\u56f3\u5f62\u63cf\u753b.png](https://qiita-image-store.s3.amazonaws.com/0/11762/06d78bad-a7ed-d835-4e2b-d63a1c2abc82.png)\n\u3053\u308c\u306b\u5bfe\u3057\uff0chSm\u306f\u6b21\u306e\u3088\u3046\u306b\u30e9\u30d9\u30eb\u306b\u69cb\u9020\u3092\u8003\u3048\u308b\uff0e\n![\u7121\u984c\u306e\u56f3\u5f62\u63cf\u753b (1).png](https://qiita-image-store.s3.amazonaws.com/0/11762/e3a36c80-87a4-1bc9-1904-3522741de1fb.png)\n\u5148\u306e\u8aac\u660e\u306b\u57fa\u3065\u3051\u3070\uff0cRoot\u30ce\u30fc\u30c9\u306b\u3044\u3066\uff0c\u6700\u521d\u306f$h_1$\u30ce\u30fc\u30c9\u304b$h_2$\u30ce\u30fc\u30c9\u30ce\u30fc\u30c9\u306b\u884c\u304f\u304b\u3092\u5206\u985e\u554f\u984c\u3068\u3057\u3066\u6c7a\u5b9a\u3059\u308b\uff0e\u4f8b\u3048\u3070$h_1$\u30ce\u30fc\u30c9\u306b\u79fb\u3063\u305f\u3068\u3057\u3066\uff0c\u6b21\u306f$l_1$\u30ce\u30fc\u30c9\u304b$l_2$\u30ce\u30fc\u30c9\u306b\u79fb\u308b\u304b\u3092\u5206\u985e\u554f\u984c\u3068\u3057\u3066\u6c7a\u5b9a\u3059\u308b\uff0e\n\u3053\u306e\u3088\u3046\u306bhSm\u306f\u69cb\u6210\u3057\u305f2\u5206\u6728\u3092\u6d3b\u7528\u3059\u308b\u3053\u3068\u3067\n\n- \u5404\u30ce\u30fc\u30c9\u306e\u5206\u985e\u306fbinary classification\u306a\u306e\u3067$Z$\u306e\u8a08\u7b97\u3082\u554f\u984c\u3067\u306a\u304f\u306a\u308b\uff0e\n- \u5206\u985e\u3092\u6c7a\u5b9a\u3059\u308b\u306e\u306b\u5fc5\u8981\u306a\u30d9\u30af\u30c8\u30eb\u306e\u6570\u304c\u5bfe\u6570\u306e\u30aa\u30fc\u30c0\u3067\u3059\u3080\u3088\u3046\u306b\u306a\u308b\n\n\u3068\u3044\u3046\u30e1\u30ea\u30c3\u30c8\u3092\u6301\u3064\uff0e\u3053\u308c\u3089\u306e\u7d50\u679c\u3068\u3057\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u66f4\u65b0\u3092\u9ad8\u901f\u5316\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b[^2]\uff0e\n[^2]: \u4e26\u5217\u5316\u3092\u7528\u3044\u3066\u3088\u308a\u9ad8\u901f\u5316\u3057\u3088\u3046\u307f\u305f\u3044\u306a\u8a71[Word2vec\u306e\u4e26\u5217\u5b9f\u884c\u6642\u306e\u5b66\u7fd2\u901f\u5ea6\u306e\u6539\u5584](http://www.slideshare.net/naoakiokazaki/word2vec)\u3082\u3042\u308b\n\n\n##Hierarchical Softmax\u306e\u6027\u8cea\n\nhSm\u306e\u6027\u8cea\u3068\u3057\u3066\u6b21\u306e\u70b9\u3092\u6319\u3052\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\n\n1. \u66f4\u65b0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u30d9\u30af\u30c8\u30eb\u306e\u6570\u304c\u5bfe\u6570\u30aa\u30fc\u30c0\u306b\u306a\u308b\uff0e\n2. \u30cf\u30d5\u30de\u30f3\u6728\u3092\u7528\u3044\u308b\u306a\u3069\u3059\u308b\u3068\u5404\u30ce\u30fc\u30c9\u3067\u30c7\u30fc\u30bf\u304cbalanced data\u306b\u8fd1\u3065\u304f\n3. \u901a\u5e38\u306e\u591a\u30af\u30e9\u30b9softmax\u3067\u306f\u4e0a\u624b\u304f\u5b66\u7fd2\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u305f\u304c\uff0c\u968e\u5c64\u5316\u3057\u305f\u3082\u306e\u3067\u306f\u6349\u3048\u308c\u304d\u308c\u306a\u3044\u5834\u5408\u304c\u5b58\u5728\u3059\u308b\n\n1\u306f\u4e0a\u3067\u898b\u305f\u3082\u306e\u3068\u540c\u3058\u3067\u3042\u308b\uff0e2\u3082\uff0c\u30cf\u30d5\u30de\u30f3\u6728\u304c\u3069\u3093\u306a\u3082\u306e\u304b\u8003\u3048\u3066\u3082\u3089\u3048\u308c\u3070\u9069\u5f53\u306b\u5206\u304b\u308b\u3068\u601d\u3046[^8]\uff0e\u3068\u3044\u3046\u3053\u3068\u3067\uff0c3\u306e\u8aac\u660e\u3092\u6700\u5f8c\u3068\u3057\u3066\u672c\u8a18\u4e8b\u306f\u7d42\u308f\u308b\uff0e\n[^8]:  \u5fc5\u8981\u306a\u3089\u8ffd\u8a18\u3059\u308b\u306e\u3067\u30b3\u30e1\u30f3\u30c8\u3067\u3082\u66f8\u3044\u3066\u4e0b\u3055\u3044\n\n###hierarhical Softmax\u306e\u8fd1\u4f3c\u306b\u3064\u3044\u3066\n\n\u4f8b\u3048\u3070\u771f\u306e\u5206\u5e03\u304c\u6b21\u306e\u56f3\u306e\u3088\u3046\u306a\u3082\u306e\u3067\u3042\u3063\u305f\u3068\u3059\u308b\uff0e\n![multi.png](https://qiita-image-store.s3.amazonaws.com/0/11762/2c010fd0-466f-cb1c-801d-1fbc07849747.png)\n\u3053\u308c\u306f\u5148\u8ff0\u306e4\u30af\u30e9\u30b9\u306e\u5834\u5408\u3067\u3042\u308a\uff0c\u901a\u5e38\u306esoftmax\u95a2\u6570\u3067\u3042\u308c\u3070\u3053\u306e\u5f62\u306f\u6349\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u308b\uff0e\u3057\u304b\u3057\uff0chSm\u306e\u5834\u5408\u306f\u6b21\u306e\u3088\u3046\u306a\u5f62\u3067\u5206\u985e\u3092\u3059\u308b\u3053\u3068\u306b\u306a\u308b\uff0e\u307e\u305a\u7a7a\u9593\u3092\u30ce\u30fc\u30c9$h_1$\u3068\u30ce\u30fc\u30c9$h_2$\u306b\u8a72\u5f53\u3059\u308b\u3088\u3046\u306b\u533a\u5207\u3063\u3066\n![hSm-root.png](https://qiita-image-store.s3.amazonaws.com/0/11762/fb7ee55b-2a26-ae7f-ed39-b409b33334cf.png)\n\u6b21\u306b\u305d\u308c\u305e\u308c\u533a\u5207\u3089\u308c\u305f\u9818\u57df\u3067\u518d\u5ea6\u5206\u985e\u3092\u884c\u3063\u3066\n![hSm-split.png](https://qiita-image-store.s3.amazonaws.com/0/11762/3a429d00-1751-a306-03bc-21836543c04f.png)\n\u306e\u3088\u3046\u306a\u5f62\u306b\u306a\u308b\uff0e\u305d\u3057\u3066\u3053\u306e\u65b9\u6cd5\u3067\u306f\uff0c\u30ab\u30e9\u30d5\u30eb\u306a4\u30af\u30e9\u30b9\u306e\u56f3\u306e\u5834\u5408\u3092\u6b63\u78ba\u306b\u6349\u3048\u308b\u3053\u3068\u306f\u3067\u304d\u306a\u3044\uff0e[^1]\n\n[^1]: Hierarchical Probabilistic Neural Network Language Model\u3067\u306fhSm\u3092\u4f7f\u3063\u305f\u30e2\u30c7\u30eb\u306b\u3082\u304b\u304b\u308f\u3089\u305a\uff0cperplexity\u306e\u5411\u4e0a\u304c\u5831\u544a\u3055\u308c\u3066\u3044\u308b\uff0e\u3053\u308c\u306f\u30e2\u30c7\u30eb\u304clog Bi-linear\u3067\u5165\u529b\u30d9\u30af\u30c8\u30eb\u81ea\u4f53\u306e\u81ea\u7531\u5ea6\u304c\u9ad8\u304b\u3063\u305f\u3053\u3068\uff0c\u307e\u305f\u30bf\u30b9\u30af\u304cperplexity\u3067\u6a5f\u68b0\u7ffb\u8a33\u306e\u3088\u3046\u306a\u8907\u96d1\u306a\u3053\u3068\u3092\u5fc5\u8981\u3068\u3057\u306a\u304b\u3063\u305f\u3053\u3068\uff0cbalanced data\u306b\u8fd1\u3065\u3044\u305f\u5f71\u97ff\u306b\u3088\u308b\u3082\u306e\uff0c\u7b49\u304c\u8003\u3048\u3089\u308c\u308b\n\n##\u307e\u3068\u3081\u7684\u306a\u3082\u306e\n\n\u30e1\u30ea\u30c3\u30c8\n\n- Hierarchical Softmax\u306f\u6728\u69cb\u9020\u3092\u6d3b\u7528\u3059\u308b\uff0e\n- \u5404\u30ce\u30fc\u30c9\u306e\u5206\u985e\u306fbinary classification\u306a\u306e\u3067$Z$\u306e\u8a08\u7b97\u3082\u554f\u984c\u3067\u306a\u304f\u306a\u308b\uff0e\n- \u5206\u985e\u3092\u6c7a\u5b9a\u3059\u308b\u306e\u306b\u5fc5\u8981\u306a\u30d9\u30af\u30c8\u30eb\u306e\u6570\u304c\u5bfe\u6570\u306e\u30aa\u30fc\u30c0\u3067\u3059\u3080\u3088\u3046\u306b\u306a\u308b\n- \u6728\u69cb\u9020\u3092\u4e0a\u624b\u304f\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\uff0c\u4f8b\u3048\u3070balanced data\u306b\u8fd1\u3065\u304f\u306a\u3069\u826f\u3044\u3053\u3068\u304c\u3042\u308b\n\n\u30c7\u30e1\u30ea\u30c3\u30c8\n\n- \u968e\u5c64\u5316\u306b\u3088\u3063\u3066\u8868\u73fe\u529b\u304c\u4e0b\u304c\u308b\uff0e\n- GPU\u3067\u306e\u9ad8\u901f\u5316\u306e\u6069\u6075\u3092\u4eab\u53d7\u3057\u306b\u304f\u3044\n", "tags": ["\u6a5f\u68b0\u5b66\u7fd2", "NeuralNetwork", "HierarchicalSoftmax", "\u968e\u5c64\u5206\u985e\u5668"]}