{"context": "Google Sheets\uff08\u6614\u306fGoogle Spreadsheets\u3068\u547c\u3070\u308c\u3066\u305f\uff09\u306e\u30c7\u30fc\u30bf\u3092Ruby\u304b\u3089\u8aad\u307f\u66f8\u304d\u3059\u308b\u65b9\u6cd5\u3092\u8abf\u3079\u3066\u3082\u3001\u60c5\u5831\u304c\u53e4\u304f\u3066OAuth\u306e\u8a8d\u8a3c\u306a\u3069\u306e\u624b\u9806\u304c\u5909\u308f\u3063\u3066\u3044\u305f\u308a\u3001\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\u306e\u7d30\u304b\u3044\u90e8\u5206\u304c\u7121\u304b\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u30012016\u5e74\u73fe\u5728\u306e\u65b9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\u203b\u3053\u3061\u3089\u306e\u8a18\u4e8b\u306f\u624b\u9806\u3068\u30b3\u30fc\u30c9\u306e\u30e1\u30e2\u3067\u3059\u306e\u3067\u3001\u30ad\u30e3\u30d7\u30c1\u30e3\u753b\u50cf\u6709\u308a\u306e\u8a73\u7d30\u624b\u9806\u3092\u78ba\u8a8d\u3055\u308c\u305f\u3044\u5834\u5408\u306f\u3053\u3061\u3089\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n[2016\u6700\u65b0\u7248]Google Sheets\u306bRuby\u30d7\u30ed\u30b0\u30e9\u30e0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30fb\u66f8\u304d\u8fbc\u307f\u3092\u884c\u3046\u624b\u9806\n\n\u524d\u6e96\u5099\uff1aGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u3078\u306eOAuth\u8a8d\u8a3c\n\nGoogle Developers Console\u4e0a\u3067\u3001Google Drive API\u3092\u6709\u52b9\u306b\u3059\u308b\nGoogle Developers Console\u306b\u4f7f\u7528\u3057\u305f\u3044Google\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\u521d\u3081\u3066\u30a2\u30af\u30bb\u30b9\u3057\u305f\u5834\u5408\u306f\u3001Developers Console\u4e0a\u306b\u4e00\u3064\u3082\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u4f5c\u3089\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001Getting started\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\nGetting started\u753b\u9762\n\u3053\u306e\u753b\u9762\u3067\u3001API\u3092\u5229\u7528\u3059\u308b\u306e\u30dc\u30c3\u30af\u30b9\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\u3059\u308b\u3068\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u597d\u304d\u306a\u540d\u524d\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u65b0\u898f\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u81ea\u52d5\u7684\u306b\u4f5c\u6210\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30db\u30fc\u30e0\u753b\u9762\uff08\u4ee5\u4e0b\u306e\u753b\u50cf\u306e\u753b\u9762\uff09\u306b\u98db\u3070\u3055\u308c\u308b\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u5de6\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u3001\u300cAPI\u3068\u8a8d\u8a3c\u300d-\u300cAPI\u300d\u3092\u9078\u3073\u3001\u53f3\u306e\u30e1\u30a4\u30f3\u753b\u9762\u304b\u3089\u300cDrive API\u300d\u3092\u63a2\u3057\u3066\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nAPI\u3092\u6709\u52b9\u306b\u3059\u308b\u30dc\u30bf\u30f3\u3092\u62bc\u305b\u3070\u3001Google Drive API\u304c\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u3053\u308c\u3067Drive API\u306e\u6709\u52b9\u5316\u304c\u5b8c\u4e86\u3067\u3059\u3002\n\u8907\u6570\u306eGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u6240\u6709\u3057\u3066\u3044\u3066\u3001\u30de\u30eb\u30c1\u30a2\u30ab\u30a6\u30f3\u30c8\uff08\u53f3\u4e0a\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u4f7f\u3044\u305f\u3044Google\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u9078\u629e\u3067\u304d\u308b\u6a5f\u80fd\uff09\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3068\u3001\u81ea\u5206\u306e\u4f7f\u3044\u305f\u3044\u30a2\u30ab\u30a6\u30f3\u30c8\u3067Google Developer Console\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u5834\u5408\u306f\u3001Chrome\u306a\u3069\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30bf\u30d6\u6a5f\u80fd\u3092\u958b\u3044\u3066\u3001\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30e2\u30fc\u30c9\u3067Developer console\u3092\u958b\u304f\u3068\u3046\u307e\u304f\u3044\u304d\u307e\u3059\u3002\n\n\u8a8d\u8a3c\u60c5\u5831\u306e\u8ffd\u52a0\u3001OAuth\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u306e\u4f5c\u6210\n\u7d9a\u3044\u3066\u3001OAuth\u8a8d\u8a3c\u3067\u4f7f\u7528\u3059\u308b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u5de6\u30e1\u30cb\u30e5\u30fc\u306e\u300cAPI\u3068\u8a8d\u8a3c\u300d-\u300c\u8a8d\u8a3c\u60c5\u5831\u300d\u3092\u9078\u629e\u3059\u308b\u3068\u3001\u8a8d\u8a3c\u60c5\u5831\u304c\u4e00\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u306eAPI\u8a8d\u8a3c\u60c5\u5831\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u753b\u50cf\u306e\u3088\u3046\u306bAPI\u8a8d\u8a3c\u60c5\u5831\u306e\u65b0\u898f\u4f5c\u6210\u3092\u4fc3\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u300cOAuth2.0\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u300d\u4f5c\u6210\u3092\u9078\u629e\u3057\u307e\u3059\u3002\nAPI\u8a8d\u8a3c\u60c5\u5831\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u753b\u50cf\n\u78ba\u8a8d\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u300c\u540c\u610f\u753b\u9762\u3092\u8a2d\u5b9a\u300d\u3092\u30af\u30ea\u30c3\u30af\u3002\nOAuth\u8a8d\u8a3c\u3092\u884c\u3046\u969b\u306b\u8868\u793a\u3055\u308c\u308b\u540c\u610f\u753b\u9762\u306e\u4f5c\u6210\u3092\u884c\u3044\u307e\u3059\u304c\u3001\u300c\u30b5\u30fc\u30d3\u30b9\u540d\u300d\u306e\u307f\u5165\u529b\u3059\u308c\u3070OK\u3067\u3059\u3002\u4ed6\u306e\u9805\u76ee\u306f\u5fc5\u9808\u9805\u76ee\u3067\u306a\u3044\u306e\u3067\u3001\u5fc5\u8981\u306a\u3089\u3042\u3068\u304b\u3089\u8ffd\u52a0\u3059\u308c\u3070\u3044\u3044\u3067\u3059\u306d\u3002\n\u3059\u308b\u3068\u6b21\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u4f5c\u6210\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u300c\u305d\u306e\u4ed6\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\u3053\u308c\u306fMac\u4e0a\u3067\u8d70\u3089\u305b\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f7f\u3046\u306e\u3067\u3001\u4ed6\u306e\u9805\u76ee\u3067\u3074\u3063\u305f\u308a\u6765\u308b\u9805\u76ee\u304c\u7121\u3044\u304b\u3089\u3067\u3059\u3002\u3082\u3057\u3001\u30b9\u30de\u30db\u30a2\u30d7\u30ea\u306a\u3069\u5f53\u3066\u306f\u307e\u308b\u9805\u76ee\u304c\u3042\u308c\u3070\u3001\u305d\u308c\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3053\u308c\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u4f5c\u6210\u304c\u5b8c\u4e86\u3067\u3059\u3002\u753b\u9762\u4e0a\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u4e00\u5f0f\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u304c\u3001\u3053\u308c\u3089\u3092\u30b3\u30d4\u30da\u3057\u3066\u4f7f\u3046\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u7279\u306b\u6587\u5b57\u306e\u7f85\u5217\u306e\u63a7\u3048\u306a\u3069\u306f\u4e0d\u8981\u3067\u3059\u3002\n\u5b9f\u969b\u306b\u30a2\u30d7\u30ea\u304b\u3089Google Drive\uff08Google sheets\uff09\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306b\u4f7f\u3046\u3001\u8a8d\u8a3c\u60c5\u5831\u4e00\u5f0f\u304c\u8a18\u8f09\u3055\u308c\u305fjson\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306b\u3001\u4e0b\u77e2\u5370\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u4e0b\u3055\u3044\u3002\n\u3053\u308c\u3067\u8a8d\u8a3c\u60c5\u5831\u306e\u8ffd\u52a0\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u306e\u4f5c\u6210\u304c\u5b8c\u4e86\u3002\n\n\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30fb\u30c8\u30fc\u30af\u30f3(refresh token)\u3092\u53d6\u5f97\u3059\u308b\n\u3053\u3053\u304b\u3089\u6700\u3082\u8907\u96d1\u306a\u64cd\u4f5c\u3067\u3042\u308b\u3001\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30fb\u30c8\u30fc\u30af\u30f3(refresh token)\u306e\u53d6\u5f97\u3092\u884c\u3044\u307e\u3059\u3002\n\u5148\u307b\u3069\u306e\u624b\u9806\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u3001\u3053\u3093\u306a\u611f\u3058\u306e\u306a\u304c\uff5e\u3044\u540d\u524d\u306e\u540d\u524d\u306ejson\u30d5\u30a1\u30a4\u30eb\nclient_secret_474352116113-52e....ui23u1.apps.googleusercontent.com.json\n\u306e\u4e2d\u8eab\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nclient_secret_xxxx.json\n{\n    \"installed\":\n    {\n        \"client_id\":\"679357212348-52eh246FooBarBazkawndi3v7ajk6w8.apps.googleusercontent.com\",\n        \"project_id\":\"my-project\",\n        \"auth_uri\":\"https://accounts.google.com/o/oauth2/auth\",\n        \"token_uri\":\"https://accounts.google.com/o/oauth2/token\",\n        \"auth_provider_x509_cert_url\":\"https://www.googleapis.com/oauth2/v1/certs\",\n        \"client_secret\":\"FooBarBazHXZl069mskl2Nkq5mi\",\n        \"redirect_uris\":\n        [\n            \"urn:ietf:wg:oauth:2.0:oob\",\n            \"http://localhost\"\n        ]\n    }\n}\n\n\n\u672c\u5f53\u306f\u4e0a\u8a18\u306e\u4e2d\u8eab\u306f\u6539\u884c\u3055\u308c\u305a\u306b1\u884c\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u898b\u3084\u3059\u3044\u3088\u3046\u306b\u6539\u884c\u3068\u30a4\u30f3\u30c7\u30f3\u30c8\u3092\u52a0\u3048\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u4e2d\u304b\u3089\u3001client_id\u3001redirect_uris\u3092\u53d6\u308a\u51fa\u3057\u3001\u4ee5\u4e0b\u306eURL\u306e\u8a72\u5f53\u90e8\u5206\u306b\u5f53\u3066\u306f\u3081\u3066\u3001\u305d\u306eURL\u306b\u5bfe\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u306eURL\u30d0\u30fc\u304b\u3089\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3044\u307e\u3059\u3002redirect_uris\u306f2\u3064\u3042\u3063\u3066\u8ff7\u3044\u307e\u3059\u304c\u3001urn:ietf:wg:oauth:2.0:oob\u306e\u307b\u3046\u3092\u4f7f\u3044\u307e\u3059\u3002\nhttps://accounts.google.com/o/oauth2/auth?client_id=[\u5148\u307b\u3069\u53d6\u5f97\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID]&redirect_uri=[\u5148\u307b\u3069\u8a2d\u5b9a\u3057\u305f\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI]&scope=https://www.googleapis.com/auth/drive&response_type=code&approval_prompt=force&access_type=offline\n\n\u305d\u3046\u3059\u308b\u3068\u30d6\u30e9\u30a6\u30b6\u4e0a\u3067\u4e0b\u56f3\u306e\u3088\u3046\u306b\u8a8d\u8a3c\u3092\u6c42\u3081\u308b\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u300c\u8a31\u53ef\u300d\u3092\u9078\u629e\nOAuth\u8a8d\u8a3c\u8a31\u53ef\u753b\u9762\n\u305d\u3046\u3059\u308b\u3068\u3001\u6b21\u306e\u753b\u9762\u3067\u8a8d\u8a3c\u30b3\u30fc\u30c9\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u5fd8\u308c\u305a\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\u3042\u3068\u306f\u5148\u7a0b\u3068\u540c\u3058\u3088\u3046\u306bjson\u30d5\u30a1\u30a4\u30eb\u304b\u3089client_id\u3001client_secret\u306e\u5024\u3092\u30b3\u30d4\u3063\u3066\u304d\u3066\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u30bf\u30fc\u30df\u30ca\u30eb\u304b\u3089\u5b9f\u884c\u3057\u307e\u3059\u3002\ncurl -d client_id=[\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID] -d client_secret=[\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8] -d redirect_uri=[\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI] -d grant_type=authorization_code -d code=[\u8a8d\u8a3c\u30b3\u30fc\u30c9] https://accounts.google.com/o/oauth2/token\n\n\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u53d6\u5f97\u306b\u6210\u529f\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306ajson\u5f62\u5f0f\u306e\u8fd4\u308a\u5024\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\u3053\u306e\u4e2d\u306erefresh_token\u304c\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u306b\u306a\u308a\u307e\u3059\u3002\uff08\u4e0b\u8a18\u306e\u8fd4\u308a\u5024\u306f\u305d\u308c\u3063\u307d\u3044\u6587\u5b57\u5217\u3092\u5f53\u3066\u8fbc\u3093\u3060\u507d\u7269\u306a\u306e\u3067\u3001\u4f7f\u3048\u307e\u305b\u3093\u3002\u5b89\u5fc3\u3057\u3066\u4e0b\u3055\u3044\u3001\u5909\u3048\u3066\u307e\u3059\u304b\u3089m(_ _)m \uff09\n$ curl -d client_id=679357212348-52eh246FooBarBazkawndi3v7ajk6w8.apps.googleusercontent.com -d client_secret=FooBarBazHXZl069mskl2Nkq5mi -d redirect_uri=urn:ietf:wg:oauth:2.0:oob -d grant_type=authorization_code -d code=4/MMgXtsAkasfynmUMPasdkd5hn6P-bsasdtpwFzFOPassafd https://accounts.google.com/o/oauth2/token\n{\n  \"access_token\" : \"uja12.asurun1_xlaksjdfask11ASssboqvBeB1-s-UPASlX0S-JJkqSUYReQKk23raljfaASAD221dfa-q\",\n  \"token_type\" : \"Bearer\",\n  \"expires_in\" : 3600,\n  \"refresh_token\" : \"1/eFasdfsfDzpUQ0TjiJt-dkVuIN57WFHJfQNNyqNh7DDFSAFASDFun6zK6XiATaASDF\"\n}\n\n\u3061\u306a\u307f\u306b\u3001\n{\n  \"error\" : \"invalid_grant\",\n  \"error_description\" : \"Invalid code.\"\n}\n\n\u3084\u3001\n{\n  \"error\" : \"invalid_grant\",\n  \"error_description\" : \"Code was already redeemed.\"\n}\n\n\u306e\u30a8\u30e9\u30fc\u304c\u8fd4\u3063\u3066\u304d\u305f\u5834\u5408\u306f\u3001\u30d6\u30e9\u30a6\u30b6\u306bURL\u3092\u6253\u3061\u8fbc\u3093\u3067\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u305f\u3068\u3053\u308d\u307e\u3067\u3082\u3069\u308a\u3001\u65b0\u898f\u306e\u30b3\u30fc\u30c9\u3092\u767a\u884c\u3057\u3066\u518d\u5ea6curl\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3053\u308c\u3067\u3088\u3046\u3084\u304f\u3001Google Sheets\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308bRuby\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u308c\u308b\u6bb5\u968e\u307e\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u53c2\u8003\nGoogle Drive\u306e\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306bRuby\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5\nGoogle drive : redirect_uri_mismatch - Stack Overflow\n\n\nRuby\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089Google Sheets\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\n\u3042\u3068\u306f\u3001\u4e0a\u8a18\u3067\u5165\u624b\u3057\u305f\u5404\u7a2e\u8a8d\u8a3c\u60c5\u5831\u3092\u4f7f\u3063\u3066\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3059\u308b\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8\u3092Ruby\u3067\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\ngoogle-drive gem\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nRuby\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u306b\u306fgoogle_drive\u3068\u3044\u3046\u305d\u306e\u540d\u3082\u305d\u306e\u901a\u308a\u306egem\u304c\u5fc5\u8981\u3067\u3059\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306aGemfile\u3092\u4f5c\u6210\u3057\u3066\u3001\n# A sample Gemfile\nsource \"https://rubygems.org\"\n\ngem 'google_drive'\n\nbundler\u3067Gem\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ bundle install --path .bundle\nFetching gem metadata from https://rubygems.org/........\nFetching version metadata from https://rubygems.org/...\nFetching dependency metadata from https://rubygems.org/..\nResolving dependencies...\nInstalling i18n 0.7.0\nInstalling json 1.8.3 with native extensions\nInstalling minitest 5.8.2\nInstalling thread_safe 0.3.5\nInstalling addressable 2.3.8\nInstalling extlib 0.9.16\nInstalling multi_json 1.11.2\nInstalling multipart-post 2.0.0\nInstalling jwt 1.5.2\nInstalling little-plugger 1.1.4\nInstalling memoist 0.12.0\nInstalling retriable 1.4.1\nInstalling mini_portile 0.6.2\nInstalling oauth 0.4.7\nInstalling multi_xml 0.5.5\nInstalling rack 1.6.4\nUsing bundler 1.11.2\nInstalling tzinfo 1.2.2\nInstalling launchy 2.4.3\nInstalling autoparse 0.3.3\nInstalling faraday 0.9.2\nInstalling logging 2.0.0\nInstalling nokogiri 1.6.6.2 with native extensions\nInstalling activesupport 4.2.4\nInstalling signet 0.6.1\nInstalling oauth2 1.0.0\nInstalling googleauth 0.4.2\nInstalling google-api-client 0.8.6\nInstalling google_drive 1.0.2\nBundle complete! 1 Gemfile dependency, 29 gems now installed.\nBundled gems are installed into ./.bundle.\n\n\nRuby\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4f5c\u6210\n\u3053\u308c\u3067\u5fc5\u8981\u306a\u3082\u306e\u306f\u4e00\u901a\u308a\u305d\u308d\u3063\u305f\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u884c\u3068\u5217\u3092\u51fa\u529b\u3055\u305b\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u3066\u4e0b\u3055\u3044\u3002\u4ee5\u4e0b\u306eYOUR_XXXX\u3068\u3044\u3046\u3068\u3053\u308d\u306b\u306f\u3001\u3053\u308c\u307e\u3067\u4f7f\u3063\u3066\u304d\u305f\u5404\u7a2e\u30ad\u30fc\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\u3072\u3068\u3064\u898b\u6163\u308c\u306a\u3044\u300cYOUR_SPREAD_SHEET_KEY\u300d\u3068\u3044\u3046\u6240\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u306b\u306f\u3001Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eURL\u306e/d/\u3068/edet\u3067\u631f\u307e\u308c\u305f\u30e9\u30f3\u30c0\u30e0\u6587\u5b57\u5217\u3092\u5165\u529b\u3057\u307e\u3059\u3002\nhttps://docs.google.com/spreadsheets/d/23assdkfa-AASDFASlkasfslasdf23kl-IN123kkdsj/edit#gid=1186906454\n\n\u304c\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3044\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eURL\u306a\u3089\u3070\u300123assdkfa-AASDFASlkasfslasdf23kl-IN123kkdsj\u304c\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u30ad\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n\ntest_connect_ss.rb\nrequire \"rubygems\"\nrequire \"google_drive\"\n\ndef show_spreadsheet\n  client_id     = \"YOUR_CLIENT_ID\"\n  client_secret = \"YOUR_CLIENT_SECRET\"\n  refresh_token = \"YOUR_REFRESH_TOKEN\"\n  client = OAuth2::Client.new(\n    client_id,\n    client_secret,\n    site: \"https://accounts.google.com\",\n    token_url: \"/o/oauth2/token\",\n    authorize_url: \"/o/oauth2/auth\")\n  auth_token = OAuth2::AccessToken.from_hash(client,{:refresh_token => refresh_token, :expires_at => 3600})\n  auth_token = auth_token.refresh!\n  session = GoogleDrive.login_with_oauth(auth_token.token)\n  ws = session.spreadsheet_by_key(\"YOUR_SPREAD_SHEET_KEY\").worksheets[0]\n\n  # \u30ec\u30b3\u30fc\u30c9\u6570\u3092\u53d6\u5f97\n  p ws.num_rows\n  # \u30ab\u30e9\u30e0\u6570\u3092\u53d6\u5f97\n  p ws.num_cols\nend\n\nshow_spreadsheet\n\n\n\u3042\u3068\u306f\u3001\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u3001\n$ bundle exec ruby test_connect_ss.rb\n67\n44\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u884c\u3068\u5217\u306e\u30ab\u30a6\u30f3\u30c8\u6570\u304c\u623b\u3063\u3066\u304d\u305f\u3089\u5b8c\u6210\u3067\u3059\u3002\n\u66f8\u304d\u8fbc\u307f\u306f\u4e0a\u8a18\u306ews\u3068\u3044\u3046\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5909\u66f4\u3057\u3066save\u30e1\u30bd\u30c3\u30c9\u3092\u53e9\u304f\u3060\u3051\u3067\u3059\u3002\n#59\u884c\u300150\u5217\u76ee\u306e\u30bb\u30eb\u306b\"test_input!\"\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u66f8\u304d\u8fbc\u307f\nws[59, 50] = \"test_input!\"\nws.save\n\n\u8a8d\u8a3c\u306a\u3069\u306e\u524d\u6e96\u5099\u304c\u5927\u5909\u3067\u3057\u305f\u3051\u3069\u3001Gem\u3092\u4f7f\u3048\u3070\u7d50\u69cb\u7c21\u5358\u306bRuby\u304b\u3089\u64cd\u4f5c\u3067\u304d\u307e\u3059\u306d\uff01\n\u3053\u308c\u3067\u66f8\u985e\u4ed5\u4e8b\u3092\u81ea\u52d5\u5316\u3057\u3066\u697d\u3059\u308b\u306a\u3069\u3001\u3044\u308d\u3044\u308d\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\u305c\u3072\u4f7f\u3063\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u307e\u305b\u30fc\u3002\n\nGoogle Sheets\uff08\u6614\u306fGoogle Spreadsheets\u3068\u547c\u3070\u308c\u3066\u305f\uff09\u306e\u30c7\u30fc\u30bf\u3092Ruby\u304b\u3089\u8aad\u307f\u66f8\u304d\u3059\u308b\u65b9\u6cd5\u3092\u8abf\u3079\u3066\u3082\u3001\u60c5\u5831\u304c\u53e4\u304f\u3066OAuth\u306e\u8a8d\u8a3c\u306a\u3069\u306e\u624b\u9806\u304c\u5909\u308f\u3063\u3066\u3044\u305f\u308a\u3001\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u306e\u53d6\u5f97\u306e\u7d30\u304b\u3044\u90e8\u5206\u304c\u7121\u304b\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u30012016\u5e74\u73fe\u5728\u306e\u65b9\u6cd5\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n\u203b\u3053\u3061\u3089\u306e\u8a18\u4e8b\u306f\u624b\u9806\u3068\u30b3\u30fc\u30c9\u306e\u30e1\u30e2\u3067\u3059\u306e\u3067\u3001\u30ad\u30e3\u30d7\u30c1\u30e3\u753b\u50cf\u6709\u308a\u306e\u8a73\u7d30\u624b\u9806\u3092\u78ba\u8a8d\u3055\u308c\u305f\u3044\u5834\u5408\u306f\u3053\u3061\u3089\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n[[2016\u6700\u65b0\u7248]Google Sheets\u306bRuby\u30d7\u30ed\u30b0\u30e9\u30e0\u304b\u3089\u30a2\u30af\u30bb\u30b9\u30fb\u66f8\u304d\u8fbc\u307f\u3092\u884c\u3046\u624b\u9806](http://www.meguroman.com/write-into-google-sheets-from-external-ruby-program/)\n\n## \u524d\u6e96\u5099\uff1aGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u3078\u306eOAuth\u8a8d\u8a3c\n\n### Google Developers Console\u4e0a\u3067\u3001Google Drive API\u3092\u6709\u52b9\u306b\u3059\u308b\n\n[Google Developers Console](https://console.developers.google.com/project)\u306b\u4f7f\u7528\u3057\u305f\u3044Google\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\u521d\u3081\u3066\u30a2\u30af\u30bb\u30b9\u3057\u305f\u5834\u5408\u306f\u3001Developers Console\u4e0a\u306b\u4e00\u3064\u3082\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u4f5c\u3089\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u3001Getting started\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n[Getting started\u753b\u9762](http://www.meguroman.com/write-into-google-sheets-from-external-ruby-program/#toc_2)\n\n\u3053\u306e\u753b\u9762\u3067\u3001API\u3092\u5229\u7528\u3059\u308b\u306e\u30dc\u30c3\u30af\u30b9\u3092\u30af\u30ea\u30c3\u30af\u3057\u307e\u3059\u3002\u3059\u308b\u3068\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u304c\u8868\u793a\u3055\u308c\u308b\u306e\u3067\u3001\u597d\u304d\u306a\u540d\u524d\u3067\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u65b0\u898f\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u81ea\u52d5\u7684\u306b\u4f5c\u6210\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30db\u30fc\u30e0\u753b\u9762\uff08\u4ee5\u4e0b\u306e\u753b\u50cf\u306e\u753b\u9762\uff09\u306b\u98db\u3070\u3055\u308c\u308b\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u5de6\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u3001\u300cAPI\u3068\u8a8d\u8a3c\u300d-\u300cAPI\u300d\u3092\u9078\u3073\u3001\u53f3\u306e\u30e1\u30a4\u30f3\u753b\u9762\u304b\u3089\u300cDrive API\u300d\u3092\u63a2\u3057\u3066\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nAPI\u3092\u6709\u52b9\u306b\u3059\u308b\u30dc\u30bf\u30f3\u3092\u62bc\u305b\u3070\u3001Google Drive API\u304c\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u3053\u308c\u3067Drive API\u306e\u6709\u52b9\u5316\u304c\u5b8c\u4e86\u3067\u3059\u3002\n\n\n\u8907\u6570\u306eGoogle\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u6240\u6709\u3057\u3066\u3044\u3066\u3001\u30de\u30eb\u30c1\u30a2\u30ab\u30a6\u30f3\u30c8\uff08\u53f3\u4e0a\u306e\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u4f7f\u3044\u305f\u3044Google\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u9078\u629e\u3067\u304d\u308b\u6a5f\u80fd\uff09\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u3068\u3001\u81ea\u5206\u306e\u4f7f\u3044\u305f\u3044\u30a2\u30ab\u30a6\u30f3\u30c8\u3067Google Developer Console\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u5834\u5408\u306f\u3001Chrome\u306a\u3069\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30bf\u30d6\u6a5f\u80fd\u3092\u958b\u3044\u3066\u3001\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30e2\u30fc\u30c9\u3067Developer console\u3092\u958b\u304f\u3068\u3046\u307e\u304f\u3044\u304d\u307e\u3059\u3002\n\n### \u8a8d\u8a3c\u60c5\u5831\u306e\u8ffd\u52a0\u3001OAuth\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u306e\u4f5c\u6210\n\n\u7d9a\u3044\u3066\u3001OAuth\u8a8d\u8a3c\u3067\u4f7f\u7528\u3059\u308b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u5de6\u30e1\u30cb\u30e5\u30fc\u306e\u300cAPI\u3068\u8a8d\u8a3c\u300d-\u300c\u8a8d\u8a3c\u60c5\u5831\u300d\u3092\u9078\u629e\u3059\u308b\u3068\u3001\u8a8d\u8a3c\u60c5\u5831\u304c\u4e00\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u306eAPI\u8a8d\u8a3c\u60c5\u5831\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u753b\u50cf\u306e\u3088\u3046\u306bAPI\u8a8d\u8a3c\u60c5\u5831\u306e\u65b0\u898f\u4f5c\u6210\u3092\u4fc3\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u300cOAuth2.0\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u300d\u4f5c\u6210\u3092\u9078\u629e\u3057\u307e\u3059\u3002\n\n[API\u8a8d\u8a3c\u60c5\u5831\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u753b\u50cf](http://www.meguroman.com/write-into-google-sheets-from-external-ruby-program/#toc_3)\n\n\u78ba\u8a8d\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u305f\u3089\u3001\u300c\u540c\u610f\u753b\u9762\u3092\u8a2d\u5b9a\u300d\u3092\u30af\u30ea\u30c3\u30af\u3002\n\nOAuth\u8a8d\u8a3c\u3092\u884c\u3046\u969b\u306b\u8868\u793a\u3055\u308c\u308b\u540c\u610f\u753b\u9762\u306e\u4f5c\u6210\u3092\u884c\u3044\u307e\u3059\u304c\u3001\u300c\u30b5\u30fc\u30d3\u30b9\u540d\u300d\u306e\u307f\u5165\u529b\u3059\u308c\u3070OK\u3067\u3059\u3002\u4ed6\u306e\u9805\u76ee\u306f\u5fc5\u9808\u9805\u76ee\u3067\u306a\u3044\u306e\u3067\u3001\u5fc5\u8981\u306a\u3089\u3042\u3068\u304b\u3089\u8ffd\u52a0\u3059\u308c\u3070\u3044\u3044\u3067\u3059\u306d\u3002\n\n\u3059\u308b\u3068\u6b21\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u4f5c\u6210\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u300c\u305d\u306e\u4ed6\u300d\u3092\u9078\u629e\u3057\u307e\u3059\u3002\u3053\u308c\u306fMac\u4e0a\u3067\u8d70\u3089\u305b\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f7f\u3046\u306e\u3067\u3001\u4ed6\u306e\u9805\u76ee\u3067\u3074\u3063\u305f\u308a\u6765\u308b\u9805\u76ee\u304c\u7121\u3044\u304b\u3089\u3067\u3059\u3002\u3082\u3057\u3001\u30b9\u30de\u30db\u30a2\u30d7\u30ea\u306a\u3069\u5f53\u3066\u306f\u307e\u308b\u9805\u76ee\u304c\u3042\u308c\u3070\u3001\u305d\u308c\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u3053\u308c\u3067\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u4f5c\u6210\u304c\u5b8c\u4e86\u3067\u3059\u3002\u753b\u9762\u4e0a\u306b\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u4e00\u5f0f\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u304c\u3001\u3053\u308c\u3089\u3092\u30b3\u30d4\u30da\u3057\u3066\u4f7f\u3046\u308f\u3051\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u7279\u306b\u6587\u5b57\u306e\u7f85\u5217\u306e\u63a7\u3048\u306a\u3069\u306f\u4e0d\u8981\u3067\u3059\u3002\n\n\n\u5b9f\u969b\u306b\u30a2\u30d7\u30ea\u304b\u3089Google Drive\uff08Google sheets\uff09\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u969b\u306b\u4f7f\u3046\u3001\u8a8d\u8a3c\u60c5\u5831\u4e00\u5f0f\u304c\u8a18\u8f09\u3055\u308c\u305fjson\u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u305f\u3081\u306b\u3001\u4e0b\u77e2\u5370\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u3053\u308c\u3067\u8a8d\u8a3c\u60c5\u5831\u306e\u8ffd\u52a0\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u306e\u4f5c\u6210\u304c\u5b8c\u4e86\u3002\n\n### \u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30fb\u30c8\u30fc\u30af\u30f3(refresh token)\u3092\u53d6\u5f97\u3059\u308b\n\n\u3053\u3053\u304b\u3089\u6700\u3082\u8907\u96d1\u306a\u64cd\u4f5c\u3067\u3042\u308b\u3001\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30fb\u30c8\u30fc\u30af\u30f3(refresh token)\u306e\u53d6\u5f97\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u5148\u307b\u3069\u306e\u624b\u9806\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u305f\u3001\u3053\u3093\u306a\u611f\u3058\u306e\u306a\u304c\uff5e\u3044\u540d\u524d\u306e\u540d\u524d\u306ejson\u30d5\u30a1\u30a4\u30eb\n`client_secret_474352116113-52e....ui23u1.apps.googleusercontent.com.json`\n\u306e\u4e2d\u8eab\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```client_secret_xxxx.json\n{\n\t\"installed\":\n\t{\n\t\t\"client_id\":\"679357212348-52eh246FooBarBazkawndi3v7ajk6w8.apps.googleusercontent.com\",\n\t\t\"project_id\":\"my-project\",\n\t\t\"auth_uri\":\"https://accounts.google.com/o/oauth2/auth\",\n\t\t\"token_uri\":\"https://accounts.google.com/o/oauth2/token\",\n\t\t\"auth_provider_x509_cert_url\":\"https://www.googleapis.com/oauth2/v1/certs\",\n\t\t\"client_secret\":\"FooBarBazHXZl069mskl2Nkq5mi\",\n\t\t\"redirect_uris\":\n\t\t[\n\t\t\t\"urn:ietf:wg:oauth:2.0:oob\",\n\t\t\t\"http://localhost\"\n\t\t]\n\t}\n}\n```\n\n\u672c\u5f53\u306f\u4e0a\u8a18\u306e\u4e2d\u8eab\u306f\u6539\u884c\u3055\u308c\u305a\u306b1\u884c\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u898b\u3084\u3059\u3044\u3088\u3046\u306b\u6539\u884c\u3068\u30a4\u30f3\u30c7\u30f3\u30c8\u3092\u52a0\u3048\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u306e\u4e2d\u304b\u3089\u3001`client_id`\u3001`redirect_uris`\u3092\u53d6\u308a\u51fa\u3057\u3001\u4ee5\u4e0b\u306eURL\u306e\u8a72\u5f53\u90e8\u5206\u306b\u5f53\u3066\u306f\u3081\u3066\u3001\u305d\u306eURL\u306b\u5bfe\u3057\u3066\u30d6\u30e9\u30a6\u30b6\u306eURL\u30d0\u30fc\u304b\u3089\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3044\u307e\u3059\u3002`redirect_uris`\u306f2\u3064\u3042\u3063\u3066\u8ff7\u3044\u307e\u3059\u304c\u3001`urn:ietf:wg:oauth:2.0:oob`\u306e\u307b\u3046\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```\nhttps://accounts.google.com/o/oauth2/auth?client_id=[\u5148\u307b\u3069\u53d6\u5f97\u3057\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID]&redirect_uri=[\u5148\u307b\u3069\u8a2d\u5b9a\u3057\u305f\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI]&scope=https://www.googleapis.com/auth/drive&response_type=code&approval_prompt=force&access_type=offline\n```\n\n\u305d\u3046\u3059\u308b\u3068\u30d6\u30e9\u30a6\u30b6\u4e0a\u3067\u4e0b\u56f3\u306e\u3088\u3046\u306b\u8a8d\u8a3c\u3092\u6c42\u3081\u308b\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u300c\u8a31\u53ef\u300d\u3092\u9078\u629e\n\n[OAuth\u8a8d\u8a3c\u8a31\u53ef\u753b\u9762](http://www.meguroman.com/write-into-google-sheets-from-external-ruby-program/#toc_4)\n\n\u305d\u3046\u3059\u308b\u3068\u3001\u6b21\u306e\u753b\u9762\u3067\u8a8d\u8a3c\u30b3\u30fc\u30c9\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u5fd8\u308c\u305a\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\u3042\u3068\u306f\u5148\u7a0b\u3068\u540c\u3058\u3088\u3046\u306bjson\u30d5\u30a1\u30a4\u30eb\u304b\u3089`client_id`\u3001`client_secret`\u306e\u5024\u3092\u30b3\u30d4\u3063\u3066\u304d\u3066\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u30bf\u30fc\u30df\u30ca\u30eb\u304b\u3089\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\ncurl -d client_id=[\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID] -d client_secret=[\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b7\u30fc\u30af\u30ec\u30c3\u30c8] -d redirect_uri=[\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI] -d grant_type=authorization_code -d code=[\u8a8d\u8a3c\u30b3\u30fc\u30c9] https://accounts.google.com/o/oauth2/token\n```\n\n\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u53d6\u5f97\u306b\u6210\u529f\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306ajson\u5f62\u5f0f\u306e\u8fd4\u308a\u5024\u304c\u5f97\u3089\u308c\u307e\u3059\u3002\u3053\u306e\u4e2d\u306e`refresh_token`\u304c\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3\u306b\u306a\u308a\u307e\u3059\u3002\uff08\u4e0b\u8a18\u306e\u8fd4\u308a\u5024\u306f\u305d\u308c\u3063\u307d\u3044\u6587\u5b57\u5217\u3092\u5f53\u3066\u8fbc\u3093\u3060\u507d\u7269\u306a\u306e\u3067\u3001\u4f7f\u3048\u307e\u305b\u3093\u3002\u5b89\u5fc3\u3057\u3066\u4e0b\u3055\u3044\u3001\u5909\u3048\u3066\u307e\u3059\u304b\u3089m(_ _)m \uff09\n\n```zsh\n$ curl -d client_id=679357212348-52eh246FooBarBazkawndi3v7ajk6w8.apps.googleusercontent.com -d client_secret=FooBarBazHXZl069mskl2Nkq5mi -d redirect_uri=urn:ietf:wg:oauth:2.0:oob -d grant_type=authorization_code -d code=4/MMgXtsAkasfynmUMPasdkd5hn6P-bsasdtpwFzFOPassafd https://accounts.google.com/o/oauth2/token\n{\n  \"access_token\" : \"uja12.asurun1_xlaksjdfask11ASssboqvBeB1-s-UPASlX0S-JJkqSUYReQKk23raljfaASAD221dfa-q\",\n  \"token_type\" : \"Bearer\",\n  \"expires_in\" : 3600,\n  \"refresh_token\" : \"1/eFasdfsfDzpUQ0TjiJt-dkVuIN57WFHJfQNNyqNh7DDFSAFASDFun6zK6XiATaASDF\"\n}\n```\n\n\u3061\u306a\u307f\u306b\u3001\n\n```\n{\n  \"error\" : \"invalid_grant\",\n  \"error_description\" : \"Invalid code.\"\n}\n```\n\n\u3084\u3001\n\n```\n{\n  \"error\" : \"invalid_grant\",\n  \"error_description\" : \"Code was already redeemed.\"\n}\n```\n\n\u306e\u30a8\u30e9\u30fc\u304c\u8fd4\u3063\u3066\u304d\u305f\u5834\u5408\u306f\u3001\u30d6\u30e9\u30a6\u30b6\u306bURL\u3092\u6253\u3061\u8fbc\u3093\u3067\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u305f\u3068\u3053\u308d\u307e\u3067\u3082\u3069\u308a\u3001\u65b0\u898f\u306e\u30b3\u30fc\u30c9\u3092\u767a\u884c\u3057\u3066\u518d\u5ea6curl\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u3053\u308c\u3067\u3088\u3046\u3084\u304f\u3001Google Sheets\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308bRuby\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u308c\u308b\u6bb5\u968e\u307e\u3067\u304d\u307e\u3057\u305f\u3002\n\n> \u53c2\u8003  \n> [Google Drive\u306e\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306bRuby\u3067\u30a2\u30af\u30bb\u30b9\u3059\u308b\u65b9\u6cd5](http://qiita.com/yumiyon/items/d7c370b3b8582431a3de)  \n>[Google drive : redirect_uri_mismatch - Stack Overflow](http://stackoverflow.com/questions/12710262/google-drive-redirect-uri-mismatch)\n\n\n## Ruby\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089Google Sheets\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\n\n\u3042\u3068\u306f\u3001\u4e0a\u8a18\u3067\u5165\u624b\u3057\u305f\u5404\u7a2e\u8a8d\u8a3c\u60c5\u5831\u3092\u4f7f\u3063\u3066\u3001\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3059\u308b\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8\u3092Ruby\u3067\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\n### google-drive gem\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nRuby\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u306b\u306f[google_drive\u3068\u3044\u3046\u305d\u306e\u540d\u3082\u305d\u306e\u901a\u308a\u306egem](https://github.com/gimite/google-drive-ruby)\u304c\u5fc5\u8981\u3067\u3059\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306aGemfile\u3092\u4f5c\u6210\u3057\u3066\u3001\n\n```Gemfile\n# A sample Gemfile\nsource \"https://rubygems.org\"\n\ngem 'google_drive'\n```\n\nbundler\u3067Gem\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$ bundle install --path .bundle\nFetching gem metadata from https://rubygems.org/........\nFetching version metadata from https://rubygems.org/...\nFetching dependency metadata from https://rubygems.org/..\nResolving dependencies...\nInstalling i18n 0.7.0\nInstalling json 1.8.3 with native extensions\nInstalling minitest 5.8.2\nInstalling thread_safe 0.3.5\nInstalling addressable 2.3.8\nInstalling extlib 0.9.16\nInstalling multi_json 1.11.2\nInstalling multipart-post 2.0.0\nInstalling jwt 1.5.2\nInstalling little-plugger 1.1.4\nInstalling memoist 0.12.0\nInstalling retriable 1.4.1\nInstalling mini_portile 0.6.2\nInstalling oauth 0.4.7\nInstalling multi_xml 0.5.5\nInstalling rack 1.6.4\nUsing bundler 1.11.2\nInstalling tzinfo 1.2.2\nInstalling launchy 2.4.3\nInstalling autoparse 0.3.3\nInstalling faraday 0.9.2\nInstalling logging 2.0.0\nInstalling nokogiri 1.6.6.2 with native extensions\nInstalling activesupport 4.2.4\nInstalling signet 0.6.1\nInstalling oauth2 1.0.0\nInstalling googleauth 0.4.2\nInstalling google-api-client 0.8.6\nInstalling google_drive 1.0.2\nBundle complete! 1 Gemfile dependency, 29 gems now installed.\nBundled gems are installed into ./.bundle.\n```\n\n### Ruby\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u4f5c\u6210\n\n\u3053\u308c\u3067\u5fc5\u8981\u306a\u3082\u306e\u306f\u4e00\u901a\u308a\u305d\u308d\u3063\u305f\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306e\u884c\u3068\u5217\u3092\u51fa\u529b\u3055\u305b\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u3044\u3066\u4e0b\u3055\u3044\u3002\u4ee5\u4e0b\u306eYOUR_XXXX\u3068\u3044\u3046\u3068\u3053\u308d\u306b\u306f\u3001\u3053\u308c\u307e\u3067\u4f7f\u3063\u3066\u304d\u305f\u5404\u7a2e\u30ad\u30fc\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n\u3072\u3068\u3064\u898b\u6163\u308c\u306a\u3044\u300cYOUR_SPREAD_SHEET_KEY\u300d\u3068\u3044\u3046\u6240\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u306b\u306f\u3001Google\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eURL\u306e`/d/`\u3068`/edet`\u3067\u631f\u307e\u308c\u305f\u30e9\u30f3\u30c0\u30e0\u6587\u5b57\u5217\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\n```\nhttps://docs.google.com/spreadsheets/d/23assdkfa-AASDFASlkasfslasdf23kl-IN123kkdsj/edit#gid=1186906454\n```\n\n\u304c\u30a2\u30af\u30bb\u30b9\u3057\u305f\u3044\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u306eURL\u306a\u3089\u3070\u3001`23assdkfa-AASDFASlkasfslasdf23kl-IN123kkdsj`\u304c\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u30ad\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\n\n```test_connect_ss.rb\nrequire \"rubygems\"\nrequire \"google_drive\"\n\ndef show_spreadsheet\n  client_id     = \"YOUR_CLIENT_ID\"\n  client_secret = \"YOUR_CLIENT_SECRET\"\n  refresh_token = \"YOUR_REFRESH_TOKEN\"\n  client = OAuth2::Client.new(\n    client_id,\n    client_secret,\n    site: \"https://accounts.google.com\",\n    token_url: \"/o/oauth2/token\",\n    authorize_url: \"/o/oauth2/auth\")\n  auth_token = OAuth2::AccessToken.from_hash(client,{:refresh_token => refresh_token, :expires_at => 3600})\n  auth_token = auth_token.refresh!\n  session = GoogleDrive.login_with_oauth(auth_token.token)\n  ws = session.spreadsheet_by_key(\"YOUR_SPREAD_SHEET_KEY\").worksheets[0]\n\n  # \u30ec\u30b3\u30fc\u30c9\u6570\u3092\u53d6\u5f97\n  p ws.num_rows\n  # \u30ab\u30e9\u30e0\u6570\u3092\u53d6\u5f97\n  p ws.num_cols\nend\n\nshow_spreadsheet\n```\n\n\u3042\u3068\u306f\u3001\u3053\u308c\u3092\u5b9f\u884c\u3057\u3066\u3001\n\n```\n$ bundle exec ruby test_connect_ss.rb\n67\n44\n```\n\n\u3068\u3044\u3046\u611f\u3058\u3067\u884c\u3068\u5217\u306e\u30ab\u30a6\u30f3\u30c8\u6570\u304c\u623b\u3063\u3066\u304d\u305f\u3089\u5b8c\u6210\u3067\u3059\u3002\n\n\u66f8\u304d\u8fbc\u307f\u306f\u4e0a\u8a18\u306ews\u3068\u3044\u3046\u30b9\u30d7\u30ec\u30c3\u30c9\u30b7\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5909\u66f4\u3057\u3066save\u30e1\u30bd\u30c3\u30c9\u3092\u53e9\u304f\u3060\u3051\u3067\u3059\u3002\n\n```ruby\n#59\u884c\u300150\u5217\u76ee\u306e\u30bb\u30eb\u306b\"test_input!\"\u3068\u3044\u3046\u6587\u5b57\u5217\u3092\u66f8\u304d\u8fbc\u307f\nws[59, 50] = \"test_input!\"\nws.save\n```\n\n\u8a8d\u8a3c\u306a\u3069\u306e\u524d\u6e96\u5099\u304c\u5927\u5909\u3067\u3057\u305f\u3051\u3069\u3001Gem\u3092\u4f7f\u3048\u3070\u7d50\u69cb\u7c21\u5358\u306bRuby\u304b\u3089\u64cd\u4f5c\u3067\u304d\u307e\u3059\u306d\uff01\n\u3053\u308c\u3067\u66f8\u985e\u4ed5\u4e8b\u3092\u81ea\u52d5\u5316\u3057\u3066\u697d\u3059\u308b\u306a\u3069\u3001\u3044\u308d\u3044\u308d\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\u305c\u3072\u4f7f\u3063\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u307e\u305b\u30fc\u3002\n\n", "tags": ["gas", "GoogleSpreadSheet", "googleapi", "Ruby"]}