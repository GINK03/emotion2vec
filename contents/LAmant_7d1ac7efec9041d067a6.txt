{"tags": ["knife", "chef", "AWS", "knife-zero"], "context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\nAmaon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306bKnife-Zero\u3092\u4ecb\u3057\u3066Chef\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\u307b\u307c\u4ee5\u4e0b\u306esawanoboly\u6c0f\u306e\u8a18\u4e8b\u306e\u901a\u308a\u306b\u9032\u3081\u308b\u305f\u3081\u3001EC2\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306b\u5fc5\u8981\u306a\u624b\u9806\u306e\u307f\u3092\u8a18\u8ff0\u3059\u308b\u3002\n\nKnife-Zero\u3092\u4f5c\u3063\u305f\u3002\n\n\n\u524d\u63d0\u6761\u4ef6\n\n\u74b0\u5883\n\n\u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8OS : CentOS 6.5\nVagrant : 1.6.5\nBundler : 1.7.7\nEC2 AMI : Amazon Linux AMI 2014.09.1 (HVM)\nAWS\u4e0a\u306bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u30fbSSH\u63a5\u7d9a\u304c\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\u3002\n\n[local@localhost VagrantEC2]$ vagrant up --provider=aws\nBringing machine 'default' up with 'aws' provider...\n==> default: HandleBoxUrl middleware is deprecated. Use HandleBox instead.\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000...\n\n[local@localhost VagrantEC2]$ vagrant ssh-config --host ec2 >> ~/.ssh/config\n[local@localhost VagrantEC2]$ ssh ec2\n\n       __|  __|_  )\n       _|  (     /   Amazon Linux AMI\n      ___|\\___|___|\n\nhttps://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n16 package(s) needed for security, out of 41 available\nRun \"sudo yum update\" to apply all updates.\n[ec2-user@ip-172-31-29-xx ~]$ \n\nVagrant\u7d4c\u7531\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u7acb\u3061\u4e0a\u3052\u304b\u3089SSH\u63a5\u7d9a\u304c\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\u307e\u3067\u3092\u78ba\u8a8d\u3002\n\nEC2\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\n\u203b\u3053\u306e\u9805\u76ee\u306f\u5fc5\u9808\u3067\u306f\u3042\u308a\u307e\u305b\u3093\n\u3000ec2\u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6\u30fc(ec2-user)\u3067\u3082\u3053\u308c\u4ee5\u964d\u306e\u51e6\u7406\u306f\u53ef\u80fd\u3002\n\u3000\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u3092\u884c\u308f\u306a\u3044\u5834\u5408\u306f\u3001\u4ee5\u964d\u306e\u51e6\u7406\u306eSSH\u63a5\u7d9a\u30e6\u30fc\u30b6\u30fc\u304a\u3088\u3073\u8a8d\u8a3c\u9375\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6\u30fc\u306e\u3082\u306e\u306b\u8aad\u307f\u66ff\u3048\u308b\u3053\u3068\u3002\n\u3000\nKnife-Zero\u5b9f\u884c\u306e\u969b\u306bEC2\u5074\u3067\u4f7f\u7528\u3059\u308b\u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\u3002\n[ec2-user@ip-172-31-29-xx ~]$ sudo su -                                        \n[root@ip-172-31-29-xx ~]# adduser remote\n[root@ip-172-31-29-xx ~]# passwd remote \n\nsudo\u6a29\u9650\u3092\u6301\u305f\u305b\u308b\u3002\n\nvisudo\nremote ALL=(ALL) ALL\n\n\n\u3000\nSSH\u8a8d\u8a3c\u9375\u3092\u4f5c\u6210\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u304b\u3089SSH\u63a5\u7d9a\u3092\u884c\u3048\u308b\u3088\u3046\u74b0\u5883\u3092\u69cb\u7bc9\u3002\n[local@localhost ~]$ ssh-keygen -t rsa\nGenerating public/private rsa key pair.\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000...\n\n[local@localhost VagrantEC2]$ ssh remote@(EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\uff09 -i ~/.ssh/id_rsa\nEnter passphrase for key '/home/local/.ssh/id_rsa': \nLast login: Wed Dec  3 08:13:20 2014 from penta.tokai-soft.net\n\n       __|  __|_  )\n       _|  (     /   Amazon Linux AMI\n      ___|\\___|___|\n\nhttps://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n16 package(s) needed for security, out of 41 available\nRun \"sudo yum update\" to apply all updates.\n[remote@ip-172-31-29-xx ~]$ \n\n\n\u3000\n\n\nSSH\u8a8d\u8a3c\u306e\u8a2d\u5b9a\u306e\u4ed5\u65b9\u304c\u308f\u304b\u3089\u306a\u3044\u5834\u5408 \n\n\u3000\u3000\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\n\u3000\u3000ssh\u516c\u958b\u9375\u8a8d\u8a3c\u3092\u5b9f\u88c5\u3059\u308b\uff08\u81ea\u5206\u30e1\u30e2\uff09\n\u3000\u3000SSH \u30ed\u30b0\u30a4\u30f3\u3067 Permission Denied\n\nKnife-Zero\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304a\u3088\u3073\u5b9f\u884c\n\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4ee5\u4e0b\u306bChef-Repo\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3002\nbundle init\u3092\u884c\u3044\u3001Knife-Zero\u5b9f\u884c\u74b0\u5883\u3092\u4f5c\u6210\u3059\u308b\u3002\n[local@localhost Chef-Repo]$ bundle init\n\n\u3000\n\u4f5c\u6210\u3055\u308c\u305fGemfile\u306b\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bKnife-Zero\u304a\u3088\u3073\u5fc5\u8981\u306agem\u3092\u8a18\u8ff0\u3057\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\nGemfile\nsource \"https://rubygems.org\"                                                                      \n\ngem 'chef'                                           \ngem 'knife-zero'\ngem 'rb-readline'\n\n\n[local@localhost Chef-Repo]$ bundle install --path vendor/bundle\n\n\u3000\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u7121\u4e8b\u6210\u529f\u3057\u305f\u3089\u3001knife\u30b3\u30de\u30f3\u30c9\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u52d5\u4f5c\u3092\u30ed\u30fc\u30ab\u30eb\u30e2\u30fc\u30c9\u306b\u3059\u308b\u305f\u3081knife.rb\u3092\u4f5c\u308b\u3002\n[local@localhost Chef-Repo]$ mkdir .chef\n[local@localhost Chef-Repo]$ echo 'local_mode true' > .chef/knife.rb\n\n\u6b21\u306b\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5165\u529b\u3057\u3001EC2\u306bChef\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n[local@localhost Chef-Repo]$ bundle exec knife zero bootstrap <EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9> -x remote -i ~/.ssh/id_rsa --hint ec2 --sudo\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\u89e3\u8aac\n\n-x user\u3000 \u3000 \uff1aSSH\u63a5\u7d9a\u30e6\u30fc\u30b6\u30fc\u540d\n-i key_path \uff1aSSH\u8a8d\u8a3c\u9375\u306e\u30d1\u30b9\n--hint ec2\u3000\uff1aOhai\u30d2\u30f3\u30c8\u3092EC2\u306b\u8a2d\u5b9a\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000Ohai\u306f\u63a5\u7d9a\u5148\u30ce\u30fc\u30c9\u306e\u69cb\u6210\u60c5\u5831\uff08\u30e1\u30bf\u30c7\u30fc\u30bf\uff09\u3092\u53ce\u96c6\u3059\u308b\u30c4\u30fc\u30eb\u3067\u3042\u308a\u3001\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u8a2d\u5b9a\u3055\u308c\u305f\u30d2\u30f3\u30c8\u306b\u5f93\u3044\u3001\u69cb\u6210\u60c5\u5831\u3092\u53ce\u96c6\u3001JSON\u5f62\u5f0f\u306b\u6574\u5f62\u3001\u307e\u305fChef-Client\u306b\u63d0\u4f9b\u3092\u884c\u3046\u3002\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3053\u3053\u3067\u306f\u3001EC2\u30ce\u30fc\u30c9\u306e\u69cb\u6210\u60c5\u5831\u3092\u53ce\u96c6\u3059\u308b\u3088\u3046\u30d2\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3002\n--sudo\u3000\u3000\u3000 \uff1asudo\u6a29\u9650\u3067\u5b9f\u884c\u3055\u305b\u308b\n\nEC2\u3078\u306e\u63a5\u7d9a\u304c\u958b\u59cb\u3055\u308c\u308b\u3002\n\u9014\u4e2d\u3001SSH\u8a8d\u8a3c\u9375\u304a\u3088\u3073\u63a5\u7d9a\u5148\u30e6\u30fc\u30b6\u30fc\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8981\u6c42\u3055\u308c\u308b\u305f\u3081\u3001\u5165\u529b\u3059\u308b\u3002\nDL is deprecated, please use Fiddle\nffi-yajl/json_gem is deprecated, these monkeypatches will be dropped shortly\nWARNING: No knife configuration file found\nWARN: No cookbooks directory found at or above current directory.  Assuming /home/local/Chef-Repo.\nConnecting to (EC2\u306eIP\u30a2\u30c9\u30ec\u30b9)\nEnter passphrase for /home/local/.ssh/id_rsa:\u3000\u2190 SSH\u8a8d\u8a3c\u9375\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\nknife sudo password:\nEnter your password: \u2190 \u63a5\u7d9a\u5148\u30e6\u30fc\u30b6\u30fc\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\nInstalling Chef Client...\n\n\u3000\n\u8a8d\u8a3c\u304c\u554f\u984c\u306a\u304f\u901a\u308c\u3070\u3001\u4ee5\u4e0b\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u3001Chef\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3002\nStarting Chef Client, version 11.16.4\nCreating a new client identity for ip-172-31-29-xx.ap-northeast-1.compute.internal using the validator key.\nresolving cookbooks for run list: []\nSynchronizing Cookbooks:\nCompiling Cookbooks...\n[2014-12-03T08:13:43+00:00] WARN: Node ip-172-31-29-xx.ap-northeast-1.compute.internal has an empty run list.\nConverging 0 resources\n\nRunning handlers:\nRunning handlers complete\nChef Client finished, 0/0 resources updated in 1.591018293 seconds\n[local@localhost Chef-Repo]$ \n\n\u3000\n\u6700\u5f8c\u306b\u3001EC2\u5074\u3067Chef\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u3002\n[remote@ip-172-31-29-xx ~]$ chef-\nchef-apply   chef-client  chef-shell   chef-solo    \n[remote@ip-172-31-29-xx ~]$ chef-client -v\nChef: 11.16.4\n\n\n\u30ec\u30b7\u30d4\u306e\u9069\u7528\nbootstrap\u304c\u6210\u529f\u3057\u305f\u3053\u3068\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u7ba1\u7406\u30ce\u30fc\u30c9\u3068\u3057\u3066\u767b\u9332\u3055\u308c\u305f\u3002\n[local@localhost Chef-Repo]$ bundle exec knife node list\n\nip-172-31-29-xx.ap-northeast-1.compute.internal\n\n\u3000\n\u53c2\u8003\u5143\u306b\u5f93\u3044\u3001knife zero chef_client\u3092\u7528\u3044\u3066\u3001\u30ce\u30fc\u30c9\u306b\u30ec\u30b7\u30d4\u3092\u5b9f\u884c\u3055\u305b\u308b\u3002\n\u3053\u3053\u3067\u306f\u81ea\u4f5c\u306escala\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30ec\u30b7\u30d4\u3092EC2\u306b\u9069\u7528\u3059\u308b\u3002\n\u3000\n\u307e\u305a\u306f\u3001\u30ce\u30fc\u30c9\u306erun_list\u306bsetup-scala\u30ec\u30b7\u30d4\u3092\u8ffd\u52a0\u3059\u308b\u3002\n[local@localhost Chef-Repo]$ bundle exec knife node run_list add ip-172-31-29-xx.ap-northeast-1.compute.internal setup-scala\n\n\u6b21\u306b\u3001chef_client \u3067run_list\u306b\u767b\u9332\u3055\u308c\u305f\u30ec\u30b7\u30d4\u3092\u5b9f\u884c\u3055\u305b\u308b\u3002\n\n[local@localhost Chef-Repo]$ bundle exec knife zero chef_client 'name:*' --attribute ec2.public_ipv4 -x remote -i ~/.ssh/id_rsa.pem --sudo\n\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\u89e3\u8aac\n\n--attribute attribute_name\n\n\u3000\u3000bootstrap\u6642\u306bOhai\u304c\u53ce\u96c6\u3057\u305f\u69cb\u6210\u60c5\u5831\u3092\u53c2\u7167\u3059\u308b\u3002\n\u3000\u3000\u3053\u3053\u3067\u306f\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d1\u30d6\u30ea\u30c3\u30afIP\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u3002\n\u3000\n\u6700\u5f8c\u306b\u3001EC2\u5074\u3067\u78ba\u8a8d\u3002\u554f\u984c\u306a\u304f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u3066\u3044\u308b\u3002\n[remote@ip-172-31-29-xx ~]$ scala -version\nScala code runner version 2.9.2 -- Copyright 2002-2011, LAMP/EPFL\n\n\n\u53c2\u8003\n\nKnife-Zero\u3092\u4f5c\u3063\u305f\u3002\nhttp://buta9999.hatenablog.jp/entry/2014/11/26/025708\nhttp://www.creationline.com/lab/6401\n\n# \u76ee\u7684\nAmaon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306bKnife-Zero\u3092\u4ecb\u3057\u3066Chef\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n\u307b\u307c\u4ee5\u4e0b\u306esawanoboly\u6c0f\u306e\u8a18\u4e8b\u306e\u901a\u308a\u306b\u9032\u3081\u308b\u305f\u3081\u3001EC2\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u969b\u306b\u5fc5\u8981\u306a\u624b\u9806\u306e\u307f\u3092\u8a18\u8ff0\u3059\u308b\u3002\n\n* [Knife-Zero\u3092\u4f5c\u3063\u305f\u3002](http://qiita.com/sawanoboly/items/218a7b03ddec6be45e34)\n\n\n# \u524d\u63d0\u6761\u4ef6\n## \u74b0\u5883\n* \u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8OS : CentOS 6.5\n* Vagrant : 1.6.5\n* Bundler : 1.7.7\n* EC2 AMI : Amazon Linux AMI 2014.09.1 (HVM)\n\n* AWS\u4e0a\u306bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u30fbSSH\u63a5\u7d9a\u304c\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\u3002\n\n```\n[local@localhost VagrantEC2]$ vagrant up --provider=aws\nBringing machine 'default' up with 'aws' provider...\n==> default: HandleBoxUrl middleware is deprecated. Use HandleBox instead.\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000...\n\n[local@localhost VagrantEC2]$ vagrant ssh-config --host ec2 >> ~/.ssh/config\n[local@localhost VagrantEC2]$ ssh ec2\n\n       __|  __|_  )\n       _|  (     /   Amazon Linux AMI\n      ___|\\___|___|\n\nhttps://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n16 package(s) needed for security, out of 41 available\nRun \"sudo yum update\" to apply all updates.\n[ec2-user@ip-172-31-29-xx ~]$ \n```\n\nVagrant\u7d4c\u7531\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u7acb\u3061\u4e0a\u3052\u304b\u3089SSH\u63a5\u7d9a\u304c\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\u307e\u3067\u3092\u78ba\u8a8d\u3002\n\n# EC2\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\n\n**\u203b\u3053\u306e\u9805\u76ee\u306f\u5fc5\u9808\u3067\u306f\u3042\u308a\u307e\u305b\u3093**\n\u3000*ec2\u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6\u30fc(ec2-user)\u3067\u3082\u3053\u308c\u4ee5\u964d\u306e\u51e6\u7406\u306f\u53ef\u80fd\u3002*\n\u3000*\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u3092\u884c\u308f\u306a\u3044\u5834\u5408\u306f\u3001\u4ee5\u964d\u306e\u51e6\u7406\u306eSSH\u63a5\u7d9a\u30e6\u30fc\u30b6\u30fc\u304a\u3088\u3073\u8a8d\u8a3c\u9375\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u30e6\u30fc\u30b6\u30fc\u306e\u3082\u306e\u306b\u8aad\u307f\u66ff\u3048\u308b\u3053\u3068\u3002*\n\n\u3000\nKnife-Zero\u5b9f\u884c\u306e\u969b\u306bEC2\u5074\u3067\u4f7f\u7528\u3059\u308b\u30e6\u30fc\u30b6\u30fc\u3092\u8ffd\u52a0\u3002\n\n```\n[ec2-user@ip-172-31-29-xx ~]$ sudo su -                                        \n[root@ip-172-31-29-xx ~]# adduser remote\n[root@ip-172-31-29-xx ~]# passwd remote \n```\n\nsudo\u6a29\u9650\u3092\u6301\u305f\u305b\u308b\u3002\n\n```vim:visudo\nremote ALL=(ALL) ALL\n```\n\n\u3000\nSSH\u8a8d\u8a3c\u9375\u3092\u4f5c\u6210\u3057\u3001\u30ed\u30fc\u30ab\u30eb\u304b\u3089SSH\u63a5\u7d9a\u3092\u884c\u3048\u308b\u3088\u3046\u74b0\u5883\u3092\u69cb\u7bc9\u3002\n\n```\n[local@localhost ~]$ ssh-keygen -t rsa\nGenerating public/private rsa key pair.\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000...\n\n[local@localhost VagrantEC2]$ ssh remote@(EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\uff09 -i ~/.ssh/id_rsa\nEnter passphrase for key '/home/local/.ssh/id_rsa': \nLast login: Wed Dec  3 08:13:20 2014 from penta.tokai-soft.net\n\n       __|  __|_  )\n       _|  (     /   Amazon Linux AMI\n      ___|\\___|___|\n\nhttps://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n16 package(s) needed for security, out of 41 available\nRun \"sudo yum update\" to apply all updates.\n[remote@ip-172-31-29-xx ~]$ \n\n```\n\u3000\n\n* **SSH\u8a8d\u8a3c\u306e\u8a2d\u5b9a\u306e\u4ed5\u65b9\u304c\u308f\u304b\u3089\u306a\u3044\u5834\u5408** \n\n\u3000\u3000\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\n\u3000\u3000[ssh\u516c\u958b\u9375\u8a8d\u8a3c\u3092\u5b9f\u88c5\u3059\u308b\uff08\u81ea\u5206\u30e1\u30e2\uff09](http://qiita.com/HamaTech/items/21bb9761f326c4d4aa65)\n\u3000\u3000[SSH \u30ed\u30b0\u30a4\u30f3\u3067 Permission Denied](http://qiita.com/youcune/items/2f427979403771f2e03a)\n\n# Knife-Zero\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304a\u3088\u3073\u5b9f\u884c\n\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4ee5\u4e0b\u306bChef-Repo\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3002\nbundle init\u3092\u884c\u3044\u3001Knife-Zero\u5b9f\u884c\u74b0\u5883\u3092\u4f5c\u6210\u3059\u308b\u3002\n\n```\n[local@localhost Chef-Repo]$ bundle init\n```\n\n\u3000\n\u4f5c\u6210\u3055\u308c\u305fGemfile\u306b\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306bKnife-Zero\u304a\u3088\u3073\u5fc5\u8981\u306agem\u3092\u8a18\u8ff0\u3057\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```ruby:Gemfile\nsource \"https://rubygems.org\"                                                                      \n\ngem 'chef'                                           \ngem 'knife-zero'\ngem 'rb-readline'\n```\n\n```\n[local@localhost Chef-Repo]$ bundle install --path vendor/bundle\n```\n\n\u3000\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u7121\u4e8b\u6210\u529f\u3057\u305f\u3089\u3001knife\u30b3\u30de\u30f3\u30c9\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u52d5\u4f5c\u3092\u30ed\u30fc\u30ab\u30eb\u30e2\u30fc\u30c9\u306b\u3059\u308b\u305f\u3081knife.rb\u3092\u4f5c\u308b\u3002\n\n```\n[local@localhost Chef-Repo]$ mkdir .chef\n[local@localhost Chef-Repo]$ echo 'local_mode true' > .chef/knife.rb\n```\n\n\u6b21\u306b\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5165\u529b\u3057\u3001EC2\u306bChef\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\n\n```\n[local@localhost Chef-Repo]$ bundle exec knife zero bootstrap <EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9> -x remote -i ~/.ssh/id_rsa --hint ec2 --sudo\n```\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\u89e3\u8aac\n\n* `-x user`\u3000 \u3000 \uff1aSSH\u63a5\u7d9a\u30e6\u30fc\u30b6\u30fc\u540d\n\n* `-i key_path` \uff1aSSH\u8a8d\u8a3c\u9375\u306e\u30d1\u30b9\n\n* `--hint ec2`\u3000\uff1aOhai\u30d2\u30f3\u30c8\u3092EC2\u306b\u8a2d\u5b9a\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000Ohai\u306f\u63a5\u7d9a\u5148\u30ce\u30fc\u30c9\u306e\u69cb\u6210\u60c5\u5831\uff08\u30e1\u30bf\u30c7\u30fc\u30bf\uff09\u3092\u53ce\u96c6\u3059\u308b\u30c4\u30fc\u30eb\u3067\u3042\u308a\u3001\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u8a2d\u5b9a\u3055\u308c\u305f\u30d2\u30f3\u30c8\u306b\u5f93\u3044\u3001\u69cb\u6210\u60c5\u5831\u3092\u53ce\u96c6\u3001JSON\u5f62\u5f0f\u306b\u6574\u5f62\u3001\u307e\u305fChef-Client\u306b\u63d0\u4f9b\u3092\u884c\u3046\u3002\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3053\u3053\u3067\u306f\u3001EC2\u30ce\u30fc\u30c9\u306e\u69cb\u6210\u60c5\u5831\u3092\u53ce\u96c6\u3059\u308b\u3088\u3046\u30d2\u30f3\u30c8\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u3002\n\n* `--sudo`\u3000\u3000\u3000 \uff1asudo\u6a29\u9650\u3067\u5b9f\u884c\u3055\u305b\u308b\n\nEC2\u3078\u306e\u63a5\u7d9a\u304c\u958b\u59cb\u3055\u308c\u308b\u3002\n\u9014\u4e2d\u3001SSH\u8a8d\u8a3c\u9375\u304a\u3088\u3073\u63a5\u7d9a\u5148\u30e6\u30fc\u30b6\u30fc\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8981\u6c42\u3055\u308c\u308b\u305f\u3081\u3001\u5165\u529b\u3059\u308b\u3002\n\n```\nDL is deprecated, please use Fiddle\nffi-yajl/json_gem is deprecated, these monkeypatches will be dropped shortly\nWARNING: No knife configuration file found\nWARN: No cookbooks directory found at or above current directory.  Assuming /home/local/Chef-Repo.\nConnecting to (EC2\u306eIP\u30a2\u30c9\u30ec\u30b9)\nEnter passphrase for /home/local/.ssh/id_rsa:\u3000\u2190 SSH\u8a8d\u8a3c\u9375\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\nknife sudo password:\nEnter your password: \u2190 \u63a5\u7d9a\u5148\u30e6\u30fc\u30b6\u30fc\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\nInstalling Chef Client...\n```\n\n\u3000\n\u8a8d\u8a3c\u304c\u554f\u984c\u306a\u304f\u901a\u308c\u3070\u3001\u4ee5\u4e0b\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u3001Chef\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u308b\u3002\n\n```\nStarting Chef Client, version 11.16.4\nCreating a new client identity for ip-172-31-29-xx.ap-northeast-1.compute.internal using the validator key.\nresolving cookbooks for run list: []\nSynchronizing Cookbooks:\nCompiling Cookbooks...\n[2014-12-03T08:13:43+00:00] WARN: Node ip-172-31-29-xx.ap-northeast-1.compute.internal has an empty run list.\nConverging 0 resources\n\nRunning handlers:\nRunning handlers complete\nChef Client finished, 0/0 resources updated in 1.591018293 seconds\n[local@localhost Chef-Repo]$ \n```\n\n\u3000\n\u6700\u5f8c\u306b\u3001EC2\u5074\u3067Chef\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\u3002\n\n```\n[remote@ip-172-31-29-xx ~]$ chef-\nchef-apply   chef-client  chef-shell   chef-solo    \n[remote@ip-172-31-29-xx ~]$ chef-client -v\nChef: 11.16.4\n```\n\n# \u30ec\u30b7\u30d4\u306e\u9069\u7528\n\nbootstrap\u304c\u6210\u529f\u3057\u305f\u3053\u3068\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u7ba1\u7406\u30ce\u30fc\u30c9\u3068\u3057\u3066\u767b\u9332\u3055\u308c\u305f\u3002\n\n```\n[local@localhost Chef-Repo]$ bundle exec knife node list\n\nip-172-31-29-xx.ap-northeast-1.compute.internal\n```\n\n\u3000\n\u53c2\u8003\u5143\u306b\u5f93\u3044\u3001knife zero chef_client\u3092\u7528\u3044\u3066\u3001\u30ce\u30fc\u30c9\u306b\u30ec\u30b7\u30d4\u3092\u5b9f\u884c\u3055\u305b\u308b\u3002\n\u3053\u3053\u3067\u306f\u81ea\u4f5c\u306escala\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30ec\u30b7\u30d4\u3092EC2\u306b\u9069\u7528\u3059\u308b\u3002\n\u3000\n\u307e\u305a\u306f\u3001\u30ce\u30fc\u30c9\u306erun_list\u306bsetup-scala\u30ec\u30b7\u30d4\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n```\n[local@localhost Chef-Repo]$ bundle exec knife node run_list add ip-172-31-29-xx.ap-northeast-1.compute.internal setup-scala\n```\n\n\u6b21\u306b\u3001chef_client \u3067run_list\u306b\u767b\u9332\u3055\u308c\u305f\u30ec\u30b7\u30d4\u3092\u5b9f\u884c\u3055\u305b\u308b\u3002\n\n```\n\n[local@localhost Chef-Repo]$ bundle exec knife zero chef_client 'name:*' --attribute ec2.public_ipv4 -x remote -i ~/.ssh/id_rsa.pem --sudo\n\n```\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\u89e3\u8aac\n\n* `--attribute attribute_name`\n\n\u3000\u3000bootstrap\u6642\u306bOhai\u304c\u53ce\u96c6\u3057\u305f\u69cb\u6210\u60c5\u5831\u3092\u53c2\u7167\u3059\u308b\u3002\n\u3000\u3000\u3053\u3053\u3067\u306f\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d1\u30d6\u30ea\u30c3\u30afIP\u3092\u53c2\u7167\u3057\u3066\u3044\u308b\u3002\n\n\u3000\n\u6700\u5f8c\u306b\u3001EC2\u5074\u3067\u78ba\u8a8d\u3002\u554f\u984c\u306a\u304f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3057\u3066\u3044\u308b\u3002\n\n```\n[remote@ip-172-31-29-xx ~]$ scala -version\nScala code runner version 2.9.2 -- Copyright 2002-2011, LAMP/EPFL\n```\n\n# \u53c2\u8003\n\n* [Knife-Zero\u3092\u4f5c\u3063\u305f\u3002](http://qiita.com/sawanoboly/items/218a7b03ddec6be45e34)\n* http://buta9999.hatenablog.jp/entry/2014/11/26/025708\n* http://www.creationline.com/lab/6401\n"}