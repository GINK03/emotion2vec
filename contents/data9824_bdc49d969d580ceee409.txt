{"context": " More than 1 year has passed since last update.\u3053\u308c\u306a\u3089\u5206\u304b\u308b\u6700\u9069\u5316\u6570\u5b66 3.2 \u306b\u8a18\u8f09\u306e\u901a\u308a\u3001\u30cb\u30e5\u30fc\u30c8\u30f3\u30e9\u30d5\u30bd\u30f3\u6cd5\uff08\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\uff09\u3092\u7528\u3044\u3066\u3001\u95a2\u6570\u306b\u6700\u5927\u5024\u30fb\u6700\u5c0f\u5024\u3092\u53d6\u3089\u305b\u308b\u5909\u6570\u306e\u5024\u3092\u6c42\u3081\u307e\u3059\u3002\n\n1\u5909\u6570\u306e\u5834\u5408\n\nframe()\npar(mfcol=c(1, 1))\npar(mar=c(2, 2, 1, 0.1))\npar(mgp=c(1, 0.2, 0))\nxrange <- c(-3, 3)\nyrange <- c(-1, 1)\nf <- function(x) { cos(x) }\ndx <- function(x) { -sin(x) }\ndxdx <- function(x) { -cos(x) }\nnewton <- function(x0, f, df, d2f) {\n\n    x <- x0\n    eps <- 1e-6\n    i <- 1\n    # \u89e3\u306e\u79fb\u52d5\u91cf\u304c\u5341\u5206\u5c0f\u3055\u304f\u306a\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3059\u3002\n    repeat {\n        oldx <- x\n        x <- x - df(x) / d2f(x)\n        lines(c(oldx, x), c(i - 1, i) * 0.05 - 0.5, type=\"o\", col=2)\n        cat(\"i=\", i, \"x=\" , x, \"f(x)=\", f(x), \"df(x)=\", df(x), \"\\n\")\n        if (abs(x - oldx) < eps) {\n            break\n        }\n        i <- i + 1\n    }\n    x\n}\n\ncurve(f, xlim=range(xrange), ylim=range(yrange))\nnewton(-1, f, dx, dxdx)\n\n\n\u591a\u5909\u6570\u306e\u5834\u5408\n\nframe()\npar(mfcol=c(1, 2))\npar(mar=c(2, 2, 1, 0.1))\npar(mgp=c(1, 0.2, 0))\n\nnewton <- function(x0, f, df, dxdx, dxdy, dydx, dydy) {\n\n    x <- x0\n    eps <- 1e-12\n    i <- 1\n    repeat {\n        oldx <- x\n        # \u52fe\u914d\u2207f\u3092\u6c42\u3081\u308b\u3002\n        gradientf <- c(dx(x), dy(x))\n        # \u30d8\u30c3\u30bb\u884c\u5217H\u3092\u6c42\u3081\u308b\u3002\n        H <- matrix(c(dxdx(x), dxdy(x), dydx(x), dydy(x)), 2, byrow=T)\n        # H\u0394x=-\u2207f\u3092\u89e3\u304d\u3001\u0394x=-H^-1 \u2207f\u3092\u6c42\u3081\u308b\u3002\n        deltax <- solve(H, -gradientf)\n        x <- x + deltax\n        xy <- cbind(oldx, x)\n        lines(xy[1, ], xy[2, ], type=\"o\", col=1)\n        cat(\"i=\", i, \"x=\" , x, \"f(x)=\", f(x), \"df(x)=\", df(x), \"\\n\")\n        # ||\u0394x||^2 \u304c\u5341\u5206\u5c0f\u3055\u304f\u306a\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3059\u3002\n        if (sum(deltax * deltax) < eps) {\n            break\n        }\n        i <- i + 1\n    }\n    x\n}\n\ndraw <- function() {\n    xgrid <- seq(-3, 3, 0.1)\n    ygrid <- seq(-3, 3, 0.1)\n    zgrid <- outer(xgrid, ygrid, Vectorize(function(x, y){ f(c(x, y)) }))\n    image(xgrid, ygrid, zgrid, xlim=range(xgrid), ylim=range(ygrid), xlab=\"x[1]\", ylab=\"x[2]\", main=\"f(x)\", col=rainbow(450)[256:1])\n    contour(xgrid, ygrid, zgrid, xlim=range(xgrid), ylim=range(ygrid), add=T)\n    newton(c(1, 0.5), f, dx, dxdx, dxdy, dydx, dydy)\n}\n\nf <- function(x){ -x[1] ^ 2 - 4 * x[2] ^ 2 + 5 * x[1] }\ndx <- function(x){ -2 * x[1] + 5 }\ndy <- function(x){ - 8 * x[2] }\ndxdx <- function(x){ -2 }\ndxdy <- function(x){ 0 }\ndydx <- function(x){ 0 }\ndydy <- function(x){ -8 }\ndraw()\n\nf <- function(x){ cos(x[1]) + cos(x[2]) }\ndx <- function(x){ -sin(x[1]) }\ndy <- function(x){ -sin(x[2]) }\ndxdx <- function(x){ -cos(x[1]) }\ndxdy <- function(x){ 0 }\ndydx <- function(x){ 0 }\ndydy <- function(x){ -cos(x[2]) }\ndraw()\n\n# f <- function(x){ x[1] ^ 3 + x[2] ^ 3 - 9 * x[1] * x[2] + 27 }\n# dx <- function(x){ 3 * x[1] ^ 2 - 9 * x[2] }\n# dy <- function(x){ 3 * x[2] ^ 2 - 9 * x[1] }\n# dxdx <- function(x){ 6 * x[1] }\n# dxdy <- function(x){ -9 }\n# dydx <- function(x){ -9 }\n# dydy <- function(x){ 6 * x[2] }\n# draw()\n\n[\u3053\u308c\u306a\u3089\u5206\u304b\u308b\u6700\u9069\u5316\u6570\u5b66](http://www.amazon.co.jp/dp/4320017862) 3.2 \u306b\u8a18\u8f09\u306e\u901a\u308a\u3001\u30cb\u30e5\u30fc\u30c8\u30f3\u30e9\u30d5\u30bd\u30f3\u6cd5\uff08\u30cb\u30e5\u30fc\u30c8\u30f3\u6cd5\uff09\u3092\u7528\u3044\u3066\u3001\u95a2\u6570\u306b\u6700\u5927\u5024\u30fb\u6700\u5c0f\u5024\u3092\u53d6\u3089\u305b\u308b\u5909\u6570\u306e\u5024\u3092\u6c42\u3081\u307e\u3059\u3002\n\n## 1\u5909\u6570\u306e\u5834\u5408\n\n![OPT3.NewtonRaphson1D.png](https://qiita-image-store.s3.amazonaws.com/0/12670/0fcb60f9-da86-49a5-e980-43f9b81895f5.png)\n\n```r\nframe()\npar(mfcol=c(1, 1))\npar(mar=c(2, 2, 1, 0.1))\npar(mgp=c(1, 0.2, 0))\nxrange <- c(-3, 3)\nyrange <- c(-1, 1)\nf <- function(x) { cos(x) }\ndx <- function(x) { -sin(x) }\ndxdx <- function(x) { -cos(x) }\nnewton <- function(x0, f, df, d2f) {\n\t\n\tx <- x0\n\teps <- 1e-6\n\ti <- 1\n\t# \u89e3\u306e\u79fb\u52d5\u91cf\u304c\u5341\u5206\u5c0f\u3055\u304f\u306a\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3059\u3002\n\trepeat {\n\t\toldx <- x\n\t\tx <- x - df(x) / d2f(x)\n\t\tlines(c(oldx, x), c(i - 1, i) * 0.05 - 0.5, type=\"o\", col=2)\n\t\tcat(\"i=\", i, \"x=\" , x, \"f(x)=\", f(x), \"df(x)=\", df(x), \"\\n\")\n\t\tif (abs(x - oldx) < eps) {\n\t\t\tbreak\n\t\t}\n\t\ti <- i + 1\n\t}\n\tx\n}\n\ncurve(f, xlim=range(xrange), ylim=range(yrange))\nnewton(-1, f, dx, dxdx)\n```\n\n## \u591a\u5909\u6570\u306e\u5834\u5408\n\n![OPT4.NewtonRaphson2D.png](https://qiita-image-store.s3.amazonaws.com/0/12670/b0049210-80c9-51d5-bf92-6af8dfc20b8c.png)\n\n```r\nframe()\npar(mfcol=c(1, 2))\npar(mar=c(2, 2, 1, 0.1))\npar(mgp=c(1, 0.2, 0))\n\nnewton <- function(x0, f, df, dxdx, dxdy, dydx, dydy) {\n\t\n\tx <- x0\n\teps <- 1e-12\n\ti <- 1\n\trepeat {\n\t\toldx <- x\n\t\t# \u52fe\u914d\u2207f\u3092\u6c42\u3081\u308b\u3002\n\t\tgradientf <- c(dx(x), dy(x))\n\t\t# \u30d8\u30c3\u30bb\u884c\u5217H\u3092\u6c42\u3081\u308b\u3002\n\t\tH <- matrix(c(dxdx(x), dxdy(x), dydx(x), dydy(x)), 2, byrow=T)\n\t\t# H\u0394x=-\u2207f\u3092\u89e3\u304d\u3001\u0394x=-H^-1 \u2207f\u3092\u6c42\u3081\u308b\u3002\n\t\tdeltax <- solve(H, -gradientf)\n\t\tx <- x + deltax\n\t\txy <- cbind(oldx, x)\n\t\tlines(xy[1, ], xy[2, ], type=\"o\", col=1)\n\t\tcat(\"i=\", i, \"x=\" , x, \"f(x)=\", f(x), \"df(x)=\", df(x), \"\\n\")\n\t\t# ||\u0394x||^2 \u304c\u5341\u5206\u5c0f\u3055\u304f\u306a\u308b\u307e\u3067\u7e70\u308a\u8fd4\u3059\u3002\n\t\tif (sum(deltax * deltax) < eps) {\n\t\t\tbreak\n\t\t}\n\t\ti <- i + 1\n\t}\n\tx\n}\n\ndraw <- function() {\n\txgrid <- seq(-3, 3, 0.1)\n\tygrid <- seq(-3, 3, 0.1)\n\tzgrid <- outer(xgrid, ygrid, Vectorize(function(x, y){ f(c(x, y)) }))\n\timage(xgrid, ygrid, zgrid, xlim=range(xgrid), ylim=range(ygrid), xlab=\"x[1]\", ylab=\"x[2]\", main=\"f(x)\", col=rainbow(450)[256:1])\n\tcontour(xgrid, ygrid, zgrid, xlim=range(xgrid), ylim=range(ygrid), add=T)\n\tnewton(c(1, 0.5), f, dx, dxdx, dxdy, dydx, dydy)\n}\n\nf <- function(x){ -x[1] ^ 2 - 4 * x[2] ^ 2 + 5 * x[1] }\ndx <- function(x){ -2 * x[1] + 5 }\ndy <- function(x){ - 8 * x[2] }\ndxdx <- function(x){ -2 }\ndxdy <- function(x){ 0 }\ndydx <- function(x){ 0 }\ndydy <- function(x){ -8 }\ndraw()\n\nf <- function(x){ cos(x[1]) + cos(x[2]) }\ndx <- function(x){ -sin(x[1]) }\ndy <- function(x){ -sin(x[2]) }\ndxdx <- function(x){ -cos(x[1]) }\ndxdy <- function(x){ 0 }\ndydx <- function(x){ 0 }\ndydy <- function(x){ -cos(x[2]) }\ndraw()\n\n# f <- function(x){ x[1] ^ 3 + x[2] ^ 3 - 9 * x[1] * x[2] + 27 }\n# dx <- function(x){ 3 * x[1] ^ 2 - 9 * x[2] }\n# dy <- function(x){ 3 * x[2] ^ 2 - 9 * x[1] }\n# dxdx <- function(x){ 6 * x[1] }\n# dxdy <- function(x){ -9 }\n# dydx <- function(x){ -9 }\n# dydy <- function(x){ 6 * x[2] }\n# draw()\n```\n", "tags": ["R", "\u6570\u5024\u8a08\u7b97"]}