{"tags": ["Logstash1.4.2"], "context": " More than 1 year has passed since last update.Elasticsearch\u3001kibana\u3068\u304d\u3066\u3001\u6b21\u306fLogstash\u3092\u5165\u308c\u307e\u3059\n\n\u74b0\u5883\n\nVirtualBox 4.3\nubuntu 14.04\njava8(1.8.0_25)\nlogstash(1.4.2)\n\n\nlogstash\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ cd \n$ wget https://download.elasticsearch.org/logstash/logstash/logstash-1.4.2.tar.gz\n$ sudo mv logstash-1.4.2.tar.gz /usr/local/\n$ cd /usr/local\n$ sudo tar zxvf logstash-1.4.2.tar.gz\n$ sudo ln -s logstash-1.4.2 logstash\n\n\u203b\u6700\u65b0\u7248\u306fhttp://logstash.net/\n\n\u8d77\u52d5\u3068\u52d5\u4f5c\u78ba\u8a8d\n\u4ee5\u4e0b\u306e\u3088\u3046\u306aApache\u30ed\u30b0\u3092\u7528\u610f\u3057\u307e\u3057\u305f\n\naccess.log\n[ip] - - [27/Apr/2015:01:05:10 +0900] \"GET [url]\" \"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70\"\n\n\n\u203bip,url\u306f\u4f0f\u305b\u3066\u3042\u308a\u307e\u3059\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\ntest.conf\n$ cd /usr/local/logstash\n$ sudo mkdir conf\n$ cd conf\n$ sudo vim test.conf\n-----\ninput { stdin {} }\n\nfilter {\n  grok {\n    match => { \"message\" => \"%{COMBINEDAPACHELOG}\" }\n    break_on_match => false\n    tag_on_failure => [\"parse_failure\"]\n  }\n  date {\n    match => [ \"timestamp\" , \"dd/MMM/yyyy:HH:mm:ss Z\" ]\n    locale => \"en\"\n  }\n}\n\noutput {\n  stdout { codec => rubydebug }\n}\n-----\n\n\n\u8d77\u52d5\u3068\u52d5\u4f5c\u78ba\u8a8d\n$ /usr/local/logstash/bin/logstash -f /usr/local/logstash/conf/test.conf\n\u6a19\u6e96\u5165\u529b\u306b\u306a\u308b\u306e\u3067\u3001\u3053\u3053\u306b\u4e0a\u8a18\u30ed\u30b0\u3092\u8cbc\u308a\u4ed8\u3051\u307e\u3059\n[ip] - - [27/Apr/2015:01:05:10 +0900] \"GET [url]\" \"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70\"\nEnter\u3067\u5b9f\u884c\n\n{\n        \"message\" => \"[ip] - - [27/Apr/2015:01:04:24 +0900] \\\"GET [url]\" 200 1375 \\\"-\\\" \\\"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70\\\"\",\n       \"@version\" => \"1\",\n     \"@timestamp\" => \"2015-04-26T16:04:24.000Z\",\n           \"host\" => \"[host]\",\n       \"clientip\" => \"[ip]\",\n          \"ident\" => \"[ident]\",\n           \"auth\" => \"[auth]\",\n      \"timestamp\" => \"27/Apr/2015:01:04:24 +0900\",\n           \"verb\" => \"GET\",\n        \"request\" => \"[url]\",\n    \"httpversion\" => \"1.1\",\n       \"response\" => \"200\",\n          \"bytes\" => \"1375\",\n       \"referrer\" => \"[referrer]\",\n          \"agent\" => \"\\\"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70\\\"\"\n}\n\n\u30d1\u30fc\u30b9\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\n\n\n\n\u8a2d\u5b9a\n\u8aac\u660e\n\n\n\n\ninput\n\u5165\u529b\u30ed\u30b0\u306e\u30d1\u30b9\u7b49\u3092\u8a18\u8f09\u3059\u308b\u3002\u4eca\u56de\u306f\u6a19\u6e96\u5165\u529b\n\n\nfilter\n\u5165\u529b\u30ed\u30b0\u306b\u5bfe\u3057\u3066\u8a2d\u5b9a\u3059\u308b\u30d5\u30a3\u30eb\u30bf\u3092\u8a18\u8ff0\u3059\u308b\n\n\ngrok\n\u975e\u5b9a\u578b\u306a\u30ed\u30b0\u3092\u51e6\u7406\u3059\u308b\u8a2d\u5b9a\n\n\nmatch\n\u5165\u529b\u3055\u308c\u305f\u30ed\u30b0\u3092\u30de\u30c3\u30c1\u30f3\u30b0\u3055\u305b\u308b\u3002\u4eca\u56de\u306fCOMBINEDAPACHELOG\u5f62\u5f0f\u3067\u30de\u30c3\u30c1\u30f3\u30b0\n\n\ndate\n\u6642\u9593\u30d1\u30fc\u30b9\u8a2d\u5b9a\n\n\noutput\n\u30d1\u30fc\u30b9\u7d50\u679c\u306e\u51fa\u529b\u5148\u3002\u4eca\u56de\u306f\u6a19\u6e96\u51fa\u529b\n\n\n\nElasticsearch\u3001kibana\u3068\u304d\u3066\u3001\u6b21\u306fLogstash\u3092\u5165\u308c\u307e\u3059\n\n# \u74b0\u5883\n * VirtualBox 4.3\n * ubuntu 14.04\n * java8(1.8.0_25)\n * logstash(1.4.2)\n\n## logstash\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```bash\n$ cd \n$ wget https://download.elasticsearch.org/logstash/logstash/logstash-1.4.2.tar.gz\n$ sudo mv logstash-1.4.2.tar.gz /usr/local/\n$ cd /usr/local\n$ sudo tar zxvf logstash-1.4.2.tar.gz\n$ sudo ln -s logstash-1.4.2 logstash\n```\n\u203b\u6700\u65b0\u7248\u306fhttp://logstash.net/\n\n## \u8d77\u52d5\u3068\u52d5\u4f5c\u78ba\u8a8d\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306aApache\u30ed\u30b0\u3092\u7528\u610f\u3057\u307e\u3057\u305f\n\n```text:access.log\n[ip] - - [27/Apr/2015:01:05:10 +0900] \"GET [url]\" \"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70\"\n```\n\u203bip,url\u306f\u4f0f\u305b\u3066\u3042\u308a\u307e\u3059\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u4f5c\u6210\n\n```text:test.conf\n$ cd /usr/local/logstash\n$ sudo mkdir conf\n$ cd conf\n$ sudo vim test.conf\n-----\ninput { stdin {} }\n\nfilter {\n  grok {\n    match => { \"message\" => \"%{COMBINEDAPACHELOG}\" }\n    break_on_match => false\n    tag_on_failure => [\"parse_failure\"]\n  }\n  date {\n    match => [ \"timestamp\" , \"dd/MMM/yyyy:HH:mm:ss Z\" ]\n    locale => \"en\"\n  }\n}\n                                         \noutput {\n  stdout { codec => rubydebug }\n}\n-----\n```\n\n\u8d77\u52d5\u3068\u52d5\u4f5c\u78ba\u8a8d\n\n```bash\n$ /usr/local/logstash/bin/logstash -f /usr/local/logstash/conf/test.conf\n\u6a19\u6e96\u5165\u529b\u306b\u306a\u308b\u306e\u3067\u3001\u3053\u3053\u306b\u4e0a\u8a18\u30ed\u30b0\u3092\u8cbc\u308a\u4ed8\u3051\u307e\u3059\n[ip] - - [27/Apr/2015:01:05:10 +0900] \"GET [url]\" \"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70\"\nEnter\u3067\u5b9f\u884c\n\n{\n        \"message\" => \"[ip] - - [27/Apr/2015:01:04:24 +0900] \\\"GET [url]\" 200 1375 \\\"-\\\" \\\"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70\\\"\",\n       \"@version\" => \"1\",\n     \"@timestamp\" => \"2015-04-26T16:04:24.000Z\",\n           \"host\" => \"[host]\",\n       \"clientip\" => \"[ip]\",\n          \"ident\" => \"[ident]\",\n           \"auth\" => \"[auth]\",\n      \"timestamp\" => \"27/Apr/2015:01:04:24 +0900\",\n           \"verb\" => \"GET\",\n        \"request\" => \"[url]\",\n    \"httpversion\" => \"1.1\",\n       \"response\" => \"200\",\n          \"bytes\" => \"1375\",\n       \"referrer\" => \"[referrer]\",\n          \"agent\" => \"\\\"Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12F70\\\"\"\n}\n```\n\u30d1\u30fc\u30b9\u3055\u308c\u307e\u3057\u305f\u3002\n\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\n\n|`\u8a2d\u5b9a`    |`\u8aac\u660e`                  |\n|----------|--------------------------|\n|**input**  |\u5165\u529b\u30ed\u30b0\u306e\u30d1\u30b9\u7b49\u3092\u8a18\u8f09\u3059\u308b\u3002\u4eca\u56de\u306f\u6a19\u6e96\u5165\u529b|\n|**filter**|\u5165\u529b\u30ed\u30b0\u306b\u5bfe\u3057\u3066\u8a2d\u5b9a\u3059\u308b\u30d5\u30a3\u30eb\u30bf\u3092\u8a18\u8ff0\u3059\u308b|\n|**grok**|\u975e\u5b9a\u578b\u306a\u30ed\u30b0\u3092\u51e6\u7406\u3059\u308b\u8a2d\u5b9a|\n|**match**|\u5165\u529b\u3055\u308c\u305f\u30ed\u30b0\u3092\u30de\u30c3\u30c1\u30f3\u30b0\u3055\u305b\u308b\u3002\u4eca\u56de\u306fCOMBINEDAPACHELOG\u5f62\u5f0f\u3067\u30de\u30c3\u30c1\u30f3\u30b0|\n|**date**|\u6642\u9593\u30d1\u30fc\u30b9\u8a2d\u5b9a|\n|**output**|\u30d1\u30fc\u30b9\u7d50\u679c\u306e\u51fa\u529b\u5148\u3002\u4eca\u56de\u306f\u6a19\u6e96\u51fa\u529b|\n"}