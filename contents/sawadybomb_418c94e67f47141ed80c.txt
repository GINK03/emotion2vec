{"context": " More than 1 year has passed since last update.Excel VBA\u3067\u7d44\u3093\u3060\u51e6\u7406\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u6642\u3001\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u306b\u79fb\u3063\u3066\u3057\u307e\u3046\u3068\u3069\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u3069\u306e\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u306e\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u3088\u3046\u306a\u5834\u5408\u3001\u30a8\u30e9\u30fc\u767a\u751f\u7b87\u6240\u3068\u5185\u5bb9\u3092\u51fa\u529b\u3059\u308b\u753b\u9762\u3092\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3055\u305b\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\u3068\u30c7\u30d0\u30c3\u30b0\u304c\u697d\u3067\u3059\u3002\n\u65b9\u6cd5\u3068\u3057\u3066\u306f\u3001\u30a8\u30e9\u30fc\u5185\u5bb9\u30ec\u30dd\u30fc\u30c8\u7528\u306e\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u3001\u30a8\u30e9\u30fc\u30c8\u30e9\u30c3\u30d7\u304b\u3089\u5f53\u8a72\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u547c\u3076\u3068\u3044\u3046\u304d\u308f\u3081\u3066\u539f\u59cb\u7684\u306a\u65b9\u6cd5\u3067\u3059\u3002\n\u30a8\u30e9\u30fc\u30ec\u30dd\u30fc\u30c8\u7528\u30e2\u30b8\u30e5\u30fc\u30eb\n\nErrorFunction.bas\nOption Explicit\n\nPublic Sub displayError( _\n    plErrNum As Long, _\n    psErrDesc As String, _\n    psErrApl As String, _\n    psErrModule As String, _\n    psErrProc As String, _\n    Optional pvErrNote As Variant)\n\n    On Error Resume Next\n\n    Dim sBuffer As String\n\n    If IsMissing(pvErrNote) = False Then\n        sBuffer = \"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\" & vbCrLf & _\n                    \"\u30a8\u30e9\u30fc\u756a\u53f7\" & vbTab & vbTab & \":\" & Space(1) & CStr(plErrNum) & vbCrLf & _\n                    \"\u30a8\u30e9\u30fc\u5185\u5bb9\" & vbTab & vbTab & \":\" & Space(1) & psErrDesc & vbCrLf & _\n                    \"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrApl & vbCrLf & _\n                    \"\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrModule & vbCrLf & _\n                    \"\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrProc & vbCrLf & _\n                    \"\u5099\u8003\" & vbTab & vbTab & \":\" & Space(1) & pvErrNote & vbCrLf\n    Else\n        sBuffer = \"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\" & vbCrLf & _\n                    \"\u30a8\u30e9\u30fc\u756a\u53f7\" & vbTab & vbTab & \":\" & Space(1) & CStr(plErrNum) & vbCrLf & _\n                    \"\u30a8\u30e9\u30fc\u5185\u5bb9\" & vbTab & vbTab & \":\" & Space(1) & psErrDesc & vbCrLf & _\n                    \"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrApl & vbCrLf & _\n                    \"\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrModule & vbCrLf & _\n                    \"\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrProc & vbCrLf\n    End If\n\n\n    Call MsgBox(sBuffer, vbCritical + vbOKOnly)\n\nEnd Sub\n\n\n\u30a8\u30e9\u30fc\u547c\u3073\u51fa\u3057\u5074\u30e2\u30b8\u30e5\u30fc\u30eb\n\nhoge.bas\nOption Explicit\n\nPrivate Const msMODULE_NAME = \"hoge.bas\" as String\n\nPublic Sub hoge\n    On Error GoTo ErrTrap\n\n    Const sPROC_NAME = \"hoge\" as String\n\n    '+ \u51e6\u7406\u5185\u5bb9\u3092\u66f8\u304f\n\nEndProc:\n    Exit Sub\n\nErrTrap:\n    Call ErrorFunction.displayError(Err.Number, Err.Description, Err.Source, msMODULE_NAME, sPROC_NAME)\n    GoTo EndProc\n\nEnd sub\n\n\nExcel VBA\u3067\u7d44\u3093\u3060\u51e6\u7406\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u6642\u3001\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u306b\u79fb\u3063\u3066\u3057\u307e\u3046\u3068\u3069\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u3069\u306e\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u306e\u304b\u3088\u304f\u308f\u304b\u3089\u306a\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u305d\u306e\u3088\u3046\u306a\u5834\u5408\u3001\u30a8\u30e9\u30fc\u767a\u751f\u7b87\u6240\u3068\u5185\u5bb9\u3092\u51fa\u529b\u3059\u308b\u753b\u9762\u3092\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3055\u305b\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f\u3068\u30c7\u30d0\u30c3\u30b0\u304c\u697d\u3067\u3059\u3002\n\n\u65b9\u6cd5\u3068\u3057\u3066\u306f\u3001\u30a8\u30e9\u30fc\u5185\u5bb9\u30ec\u30dd\u30fc\u30c8\u7528\u306e\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7528\u610f\u3057\u3066\u304a\u304d\u3001\u30a8\u30e9\u30fc\u30c8\u30e9\u30c3\u30d7\u304b\u3089\u5f53\u8a72\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u547c\u3076\u3068\u3044\u3046\u304d\u308f\u3081\u3066\u539f\u59cb\u7684\u306a\u65b9\u6cd5\u3067\u3059\u3002\n\n\u30a8\u30e9\u30fc\u30ec\u30dd\u30fc\u30c8\u7528\u30e2\u30b8\u30e5\u30fc\u30eb\n\n```vbnet:ErrorFunction.bas\nOption Explicit\n\nPublic Sub displayError( _\n    plErrNum As Long, _\n    psErrDesc As String, _\n    psErrApl As String, _\n    psErrModule As String, _\n    psErrProc As String, _\n    Optional pvErrNote As Variant)\n\n    On Error Resume Next\n    \n    Dim sBuffer As String\n    \n    If IsMissing(pvErrNote) = False Then\n        sBuffer = \"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\" & vbCrLf & _\n                    \"\u30a8\u30e9\u30fc\u756a\u53f7\" & vbTab & vbTab & \":\" & Space(1) & CStr(plErrNum) & vbCrLf & _\n                    \"\u30a8\u30e9\u30fc\u5185\u5bb9\" & vbTab & vbTab & \":\" & Space(1) & psErrDesc & vbCrLf & _\n                    \"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrApl & vbCrLf & _\n                    \"\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrModule & vbCrLf & _\n                    \"\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrProc & vbCrLf & _\n                    \"\u5099\u8003\" & vbTab & vbTab & \":\" & Space(1) & pvErrNote & vbCrLf\n    Else\n        sBuffer = \"\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\" & vbCrLf & _\n                    \"\u30a8\u30e9\u30fc\u756a\u53f7\" & vbTab & vbTab & \":\" & Space(1) & CStr(plErrNum) & vbCrLf & _\n                    \"\u30a8\u30e9\u30fc\u5185\u5bb9\" & vbTab & vbTab & \":\" & Space(1) & psErrDesc & vbCrLf & _\n                    \"\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrApl & vbCrLf & _\n                    \"\u30e2\u30b8\u30e5\u30fc\u30eb\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrModule & vbCrLf & _\n                    \"\u30d7\u30ed\u30b7\u30fc\u30b8\u30e3\u540d\" & vbTab & vbTab & \":\" & Space(1) & psErrProc & vbCrLf\n    End If\n    \n    \n    Call MsgBox(sBuffer, vbCritical + vbOKOnly)\n    \nEnd Sub\n```\n\n\u30a8\u30e9\u30fc\u547c\u3073\u51fa\u3057\u5074\u30e2\u30b8\u30e5\u30fc\u30eb\n\n```vbnet:hoge.bas\nOption Explicit\n\nPrivate Const msMODULE_NAME = \"hoge.bas\" as String\n\nPublic Sub hoge\n    On Error GoTo ErrTrap\n\n    Const sPROC_NAME = \"hoge\" as String\n\n    '+ \u51e6\u7406\u5185\u5bb9\u3092\u66f8\u304f\n\nEndProc:\n    Exit Sub\n\nErrTrap:\n    Call ErrorFunction.displayError(Err.Number, Err.Description, Err.Source, msMODULE_NAME, sPROC_NAME)\n    GoTo EndProc\n\nEnd sub\n```\n", "tags": ["Excel", "VBA"]}