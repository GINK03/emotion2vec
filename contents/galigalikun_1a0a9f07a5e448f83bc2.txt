{"context": " More than 1 year has passed since last update.cocos2dx 3.5\u3067\u306e\u30e1\u30e2\ncocos2dx\u516c\u5f0f\u306eplugin-x\uff08\u516c\u5f0f\u3060\u3088\u306d\u3002\u3002\uff09\u3092lua\u3060\u3068\u3069\u3046\u4f7f\u3046\u306e\u304b\u8a66\u3057\u305f\u30e1\u30e2\nhttp://www.cocos2d-x.org/wiki/Facebook_integration_instruction_for_Cocos2d-x_and_Cocos2d-x-Lua_on_android\n\u3092\u53c2\u8003\u306bflurry,twitter\u3092\u5165\u308c\u3066\u307f\u305f\n$ cd frameworks/cocos2d-x/plugin/tools/\n$ ./publish.sh flurry\n$ ./publish.sh twitter\n\nndk,sdk,ant\u306e\u30d1\u30b9\u3092\u805e\u304b\u308c\u308b\u306e\u3067\u968f\u6642\nflurry twitter\u3068\u304b\u66f8\u304f\u3068\u3044\u3051\u308b\u3089\u3057\u3044\u3051\u3069cpp\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3068\u304d\u304b\u3089\u3046\u307e\u304f\u3044\u3063\u305f\u3053\u3068\u304c\u306a\u3044\n\nframework/runtime-src/proj.android/jni/Android.mk\nLOCAL_PATH := $(call my-dir)\n\ninclude $(CLEAR_VARS)\n\nLOCAL_MODULE := cocos2dlua_shared\n\nLOCAL_MODULE_FILENAME := libcocos2dlua\n\nLOCAL_SRC_FILES := \\\n../../Classes/AppDelegate.cpp \\\n../../Classes/ide-support/SimpleConfigParser.cpp \\\n../../../cocos2d-x/plugin/luabindings/auto/lua_cocos2dx_pluginx_auto.cpp \\\n../../../cocos2d-x/plugin/luabindings/manual/lua_pluginx_basic_conversions.cpp \\\n../../../cocos2d-x/plugin/luabindings/manual/lua_pluginx_manual_callback.cpp \\\n../../../cocos2d-x/plugin/luabindings/manual/lua_pluginx_manual_protocols.cpp \\\nhellolua/main.cpp\n\nLOCAL_C_INCLUDES := \\\n$(LOCAL_PATH)/../../Classes/protobuf-lite \\\n$(LOCAL_PATH)/../../Classes/runtime \\\n$(LOCAL_PATH)/../../Classes \\\n$(LOCAL_PATH)/../../../cocos2d-x/external \\\n$(LOCAL_PATH)/../../../cocos2d-x/tools/simulator/libsimulator/lib \\\n$(LOCAL_PATH)/../../../cocos2d-x/plugin/luabindings/auto \\\n$(LOCAL_PATH)/../../../cocos2d-x/plugin/luabindings/manual\n\n# _COCOS_HEADER_ANDROID_BEGIN\n# _COCOS_HEADER_ANDROID_END\n\nLOCAL_STATIC_LIBRARIES := cocos2d_lua_static\nLOCAL_STATIC_LIBRARIES += cocos2d_simulator_static\nLOCAL_STATIC_LIBRARIES += PluginProtocolStatic\n\n# _COCOS_LIB_ANDROID_BEGIN\n# _COCOS_LIB_ANDROID_END\n\ninclude $(BUILD_SHARED_LIBRARY)\n\n$(call import-module,scripting/lua-bindings/proj.android)\n$(call import-module,tools/simulator/libsimulator/proj.android)\n$(call import-module,plugin/protocols/proj.android/jni) \n\n# _COCOS_LIB_IMPORT_ANDROID_BEGIN\n# _COCOS_LIB_IMPORT_ANDROID_END\n\n\nLOCAL_SRC_FILES\u3068LOCAL_C_INCLUDES\u306b\u8ffd\u52a0\n\nframeworks/runtime-src/proj.android/jni/hellolua/main.cpp\n#include \"AppDelegate.h\"\n#include \"cocos2d.h\"\n#include \"platform/android/jni/JniHelper.h\"\n#include <jni.h>\n#include <android/log.h>\n#include \"ide-support/SimpleConfigParser.h\"\n#include \"PluginJniHelper.h\"\n\n#define  LOG_TAG    \"main\"\n#define  LOGD(...)  __android_log_print(ANDROID_LOG_DEBUG,LOG_TAG,__VA_ARGS__)\n\nusing namespace cocos2d;\n\nvoid cocos_android_app_init (JNIEnv* env, jobject thiz) {\n    LOGD(\"cocos_android_app_init\");\n    AppDelegate *pAppDelegate = new AppDelegate();\n\n    JavaVM* vm;\n    env->GetJavaVM(&vm);\n    PluginJniHelper::setJavaVM(vm);\n}\n\nextern \"C\"\n{\n    bool Java_org_cocos2dx_lua_AppActivity_nativeIsLandScape(JNIEnv *env, jobject thisz)\n    {\n        return SimpleConfigParser::getInstance()->isLanscape();\n    }\n\n        bool Java_org_cocos2dx_lua_AppActivity_nativeIsDebug(JNIEnv *env, jobject thisz)\n        {\n        return false;    \n        }\n}\n\n\n\npluginjnihelper\u3092\u8ffd\u52a0\u3057\u305f\n\nframeworks/runtime-src/proj.android/src/org/cocos2dx/lua/AppActivity.java\n\nimport org.cocos2dx.lib.Cocos2dxGLSurfaceView;\nimport org.cocos2dx.plugin.PluginWrapper;\n\n    @Override\n    public Cocos2dxGLSurfaceView onCreateView() {\n        Cocos2dxGLSurfaceView glSurfaceView = super.onCreateView();\n        PluginWrapper.init(this);\n        PluginWrapper.setGLSurfaceView(glSurfaceView);\n\n\n        return glSurfaceView;\n    }\n\n\n\nimport\u3068onCreateView\u3092\u8ffd\u52a0\u3057\u305f\n\nframeworks/runtime-src/proj.android/project.properties\n\n\nandroid.library.reference.2=../../cocos2d-x/plugin/protocols/proj.android\nandroid.library.reference.3=../../cocos2d-x/plugin/plugins/flurry/proj.android\nandroid.library.reference.4=../../cocos2d-x/plugin/plugins/twitter/proj.android\n\n\n\nlibrary\u306e\u30d1\u30b9\u8ffd\u52a0\n\nmv frameworks/cocos2d-x/plugin/plugins/flurry/proj.android/sdk frameworks/cocos2d-x/plugin/plugins/flurry/proj.android/libs\n\nmv frameworks/cocos2d-x/plugin/plugins/twitter/proj.android/sdk frameworks/cocos2d-x/plugin/plugins/twitter/proj.android/libs\n\n\u6614\u306fsdk\u306e\u30d1\u30b9\u3067\u3082\u3088\u304b\u3063\u305f\u3089\u3057\u3044\u3051\u3069\u4eca\u306eandroid-sdk\u3060\u3068libs\u4ee5\u4e0b\u306b\u304a\u304b\u306a\u3044\u3068\u3060\u3081\u307f\u305f\u3044\u306a\u306e\u3067\u3002\n\u672c\u5f53\u306f\u3082\u3063\u3068\u3044\u3044\u65b9\u6cd5\u304c\u3042\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\nframeworks/runtime-src/Classes/AppDelegate.cpp\n\n#include \"lua_cocos2dx_pluginx_auto.hpp\"\n#include \"lua_pluginx_manual_callback.h\"\n#include \"lua_pluginx_manual_protocols.h\"\n\n\n\nbool AppDelegate::applicationDidFinishLaunching()\n{\n    // set default FPS\n    Director::getInstance()->setAnimationInterval(1.0 / 60.0f);\n\n    // register lua module\n    auto engine = LuaEngine::getInstance();\n    ScriptEngineManager::getInstance()->setScriptEngine(engine);\n    auto stack = engine->getLuaStack();\n    auto L = stack->getLuaState();\n\n    lua_module_register(L);\n\n    register_all_pluginx_protocols(L);\n    register_all_pluginx_manual_callback(L);\n    register_all_pluginx_manual_protocols(L);\n\n    register_all_packages();\n\n    stack->setXXTEAKeyAndSign(\"2dxLua\", strlen(\"2dxLua\"), \"XXTEA\", strlen(\"XXTEA\"));\n\n\n    if (engine->executeScriptFile(\"src/main.lua\"))\n    {\n        return false;\n    }\n\n    return true;\n}\n\n\n\n\u3053\u308c\u3067\u3084\u3063\u3068lua\u304b\u3089\u547d\u4ee4\u3092\u306a\u3052\u308c\u308b\u3088\u3046\u306b\u3002\n\nsrc/main.lua\n\n    local analytics = plugin.PluginManager:getInstance():loadPlugin(\"AnalyticsFlurry\")\n    if DEBUG > 1 then\n        analytics:setDebugMode(true)\n    end\n    analytics:startSession(\"todo\")\n    analytics:setCaptureUncaughtException(true)\n    analytics:setSessionContinueMillis(10000)\n\n\n\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\ntwitter\u306f\u3053\u3093\u306a\u611f\u3058\n\nsrc/app/views/ShopScene.lua\n\nlocal ShopScene = class(\"ShopScene\", cc.load(\"mvc\").ViewBase)\n\nShopScene.RESOURCE_FILENAME = \"ShopScene.csb\"\n\nfunction ShopScene:onCreate()\n\n    local twitter = plugin.PluginManager:getInstance():loadPlugin(\"ShareTwitter\")\n    if DEBUG > 1 then\n        twitter:setDebugMode(true);\n    end\n    twitter:configDeveloperInfo({ TwitterKey = \"todo\", TwitterSecret = \"todo\"})\n\n\n        local s = cc.Director:getInstance():getWinSize()\n\n        local target = cc.RenderTexture:create(s.width, s.height, cc.TEXTURE2_D_PIXEL_FORMAT_RGB_A8888)\n        target:retain()\n        target:setPosition(cc.p(s.width / 2, s.height / 2)) \n\n    root:getChildByName(\"ScrollView\"):getChildByName(\"Share\"):addTouchEventListener(function(sender, eventType)\n        printInfo(\"share touch\")\n        if eventType == 2 then\n\n            target:clear(math.random(), math.random(), math.random(), math.random())\n            target:begin()\n            cc.Director:getInstance():getRunningScene():visit()\n            target:endToLua()\n            target:saveToFile(\"t.png\", cc.IMAGE_FORMAT_PNG)\n\n            twitter:share({SharedText = \"share test\", SharedImagePath = \"t.png\"}, function(ret, msg)\n                printInfo(\"share:%d:%s\", ret, msg)\n            end)\n\n        end\n    end)\n\n\n        end                                                    \n    end) \nend\n\nreturn ShopScene\n\n\n\n\n\ncocos2dx 3.5\u3067\u306e\u30e1\u30e2\n\n\ncocos2dx\u516c\u5f0f\u306eplugin-x\uff08\u516c\u5f0f\u3060\u3088\u306d\u3002\u3002\uff09\u3092lua\u3060\u3068\u3069\u3046\u4f7f\u3046\u306e\u304b\u8a66\u3057\u305f\u30e1\u30e2\n\n\nhttp://www.cocos2d-x.org/wiki/Facebook_integration_instruction_for_Cocos2d-x_and_Cocos2d-x-Lua_on_android\n\n\u3092\u53c2\u8003\u306bflurry,twitter\u3092\u5165\u308c\u3066\u307f\u305f\n\n\n## \n\n```\n$ cd frameworks/cocos2d-x/plugin/tools/\n$ ./publish.sh flurry\n$ ./publish.sh twitter\n```\n\nndk,sdk,ant\u306e\u30d1\u30b9\u3092\u805e\u304b\u308c\u308b\u306e\u3067\u968f\u6642\n\nflurry twitter\u3068\u304b\u66f8\u304f\u3068\u3044\u3051\u308b\u3089\u3057\u3044\u3051\u3069cpp\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u3068\u304d\u304b\u3089\u3046\u307e\u304f\u3044\u3063\u305f\u3053\u3068\u304c\u306a\u3044\n\n\n\n```framework/runtime-src/proj.android/jni/Android.mk\nLOCAL_PATH := $(call my-dir)\n\ninclude $(CLEAR_VARS)\n\nLOCAL_MODULE := cocos2dlua_shared\n\nLOCAL_MODULE_FILENAME := libcocos2dlua\n\nLOCAL_SRC_FILES := \\\n../../Classes/AppDelegate.cpp \\\n../../Classes/ide-support/SimpleConfigParser.cpp \\\n../../../cocos2d-x/plugin/luabindings/auto/lua_cocos2dx_pluginx_auto.cpp \\\n../../../cocos2d-x/plugin/luabindings/manual/lua_pluginx_basic_conversions.cpp \\\n../../../cocos2d-x/plugin/luabindings/manual/lua_pluginx_manual_callback.cpp \\\n../../../cocos2d-x/plugin/luabindings/manual/lua_pluginx_manual_protocols.cpp \\\nhellolua/main.cpp\n\nLOCAL_C_INCLUDES := \\\n$(LOCAL_PATH)/../../Classes/protobuf-lite \\\n$(LOCAL_PATH)/../../Classes/runtime \\\n$(LOCAL_PATH)/../../Classes \\\n$(LOCAL_PATH)/../../../cocos2d-x/external \\\n$(LOCAL_PATH)/../../../cocos2d-x/tools/simulator/libsimulator/lib \\\n$(LOCAL_PATH)/../../../cocos2d-x/plugin/luabindings/auto \\\n$(LOCAL_PATH)/../../../cocos2d-x/plugin/luabindings/manual\n\n# _COCOS_HEADER_ANDROID_BEGIN\n# _COCOS_HEADER_ANDROID_END\n\nLOCAL_STATIC_LIBRARIES := cocos2d_lua_static\nLOCAL_STATIC_LIBRARIES += cocos2d_simulator_static\nLOCAL_STATIC_LIBRARIES += PluginProtocolStatic\n\n# _COCOS_LIB_ANDROID_BEGIN\n# _COCOS_LIB_ANDROID_END\n\ninclude $(BUILD_SHARED_LIBRARY)\n\n$(call import-module,scripting/lua-bindings/proj.android)\n$(call import-module,tools/simulator/libsimulator/proj.android)\n$(call import-module,plugin/protocols/proj.android/jni) \n\n# _COCOS_LIB_IMPORT_ANDROID_BEGIN\n# _COCOS_LIB_IMPORT_ANDROID_END\n```\n\nLOCAL_SRC_FILES\u3068LOCAL_C_INCLUDES\u306b\u8ffd\u52a0\n\n\n```cpp:frameworks/runtime-src/proj.android/jni/hellolua/main.cpp\n#include \"AppDelegate.h\"\n#include \"cocos2d.h\"\n#include \"platform/android/jni/JniHelper.h\"\n#include <jni.h>\n#include <android/log.h>\n#include \"ide-support/SimpleConfigParser.h\"\n#include \"PluginJniHelper.h\"\n\n#define  LOG_TAG    \"main\"\n#define  LOGD(...)  __android_log_print(ANDROID_LOG_DEBUG,LOG_TAG,__VA_ARGS__)\n\nusing namespace cocos2d;\n\nvoid cocos_android_app_init (JNIEnv* env, jobject thiz) {\n    LOGD(\"cocos_android_app_init\");\n    AppDelegate *pAppDelegate = new AppDelegate();\n\n    JavaVM* vm;\n    env->GetJavaVM(&vm);\n    PluginJniHelper::setJavaVM(vm);\n}\n\nextern \"C\"\n{\n    bool Java_org_cocos2dx_lua_AppActivity_nativeIsLandScape(JNIEnv *env, jobject thisz)\n    {\n        return SimpleConfigParser::getInstance()->isLanscape();\n    }\n\n        bool Java_org_cocos2dx_lua_AppActivity_nativeIsDebug(JNIEnv *env, jobject thisz)\n        {\n        return false;    \n        }\n}\n\n```\n\npluginjnihelper\u3092\u8ffd\u52a0\u3057\u305f\n\n```java:frameworks/runtime-src/proj.android/src/org/cocos2dx/lua/AppActivity.java\n\nimport org.cocos2dx.lib.Cocos2dxGLSurfaceView;\nimport org.cocos2dx.plugin.PluginWrapper;\n\n    @Override\n    public Cocos2dxGLSurfaceView onCreateView() {\n        Cocos2dxGLSurfaceView glSurfaceView = super.onCreateView();\n        PluginWrapper.init(this);\n        PluginWrapper.setGLSurfaceView(glSurfaceView);\n\n\n        return glSurfaceView;\n    }\n\n```\n\nimport\u3068onCreateView\u3092\u8ffd\u52a0\u3057\u305f\n\n```frameworks/runtime-src/proj.android/project.properties\n\n\nandroid.library.reference.2=../../cocos2d-x/plugin/protocols/proj.android\nandroid.library.reference.3=../../cocos2d-x/plugin/plugins/flurry/proj.android\nandroid.library.reference.4=../../cocos2d-x/plugin/plugins/twitter/proj.android\n\n```\n\n\nlibrary\u306e\u30d1\u30b9\u8ffd\u52a0\n\n\n```\n\nmv frameworks/cocos2d-x/plugin/plugins/flurry/proj.android/sdk frameworks/cocos2d-x/plugin/plugins/flurry/proj.android/libs\n\nmv frameworks/cocos2d-x/plugin/plugins/twitter/proj.android/sdk frameworks/cocos2d-x/plugin/plugins/twitter/proj.android/libs\n```\n\n\u6614\u306fsdk\u306e\u30d1\u30b9\u3067\u3082\u3088\u304b\u3063\u305f\u3089\u3057\u3044\u3051\u3069\u4eca\u306eandroid-sdk\u3060\u3068libs\u4ee5\u4e0b\u306b\u304a\u304b\u306a\u3044\u3068\u3060\u3081\u307f\u305f\u3044\u306a\u306e\u3067\u3002\n\u672c\u5f53\u306f\u3082\u3063\u3068\u3044\u3044\u65b9\u6cd5\u304c\u3042\u308b\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\n\n\n```cpp:frameworks/runtime-src/Classes/AppDelegate.cpp\n\n#include \"lua_cocos2dx_pluginx_auto.hpp\"\n#include \"lua_pluginx_manual_callback.h\"\n#include \"lua_pluginx_manual_protocols.h\"\n\n\n\nbool AppDelegate::applicationDidFinishLaunching()\n{\n    // set default FPS\n    Director::getInstance()->setAnimationInterval(1.0 / 60.0f);\n   \n    // register lua module\n    auto engine = LuaEngine::getInstance();\n    ScriptEngineManager::getInstance()->setScriptEngine(engine);\n    auto stack = engine->getLuaStack();\n    auto L = stack->getLuaState();\n\n    lua_module_register(L);\n\n    register_all_pluginx_protocols(L);\n    register_all_pluginx_manual_callback(L);\n    register_all_pluginx_manual_protocols(L);\n\n    register_all_packages();\n\n    stack->setXXTEAKeyAndSign(\"2dxLua\", strlen(\"2dxLua\"), \"XXTEA\", strlen(\"XXTEA\"));\n\n    \n    if (engine->executeScriptFile(\"src/main.lua\"))\n    {\n        return false;\n    }\n    \n    return true;\n}\n\n```\n\n\n\u3053\u308c\u3067\u3084\u3063\u3068lua\u304b\u3089\u547d\u4ee4\u3092\u306a\u3052\u308c\u308b\u3088\u3046\u306b\u3002\n\n```lua:src/main.lua\n\n    local analytics = plugin.PluginManager:getInstance():loadPlugin(\"AnalyticsFlurry\")\n    if DEBUG > 1 then\n        analytics:setDebugMode(true)\n    end\n    analytics:startSession(\"todo\")\n    analytics:setCaptureUncaughtException(true)\n    analytics:setSessionContinueMillis(10000)\n\n\n```\n\n\n\u3053\u3093\u306a\u611f\u3058\u3067\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\n\n\ntwitter\u306f\u3053\u3093\u306a\u611f\u3058\n\n```lua:src/app/views/ShopScene.lua\n\nlocal ShopScene = class(\"ShopScene\", cc.load(\"mvc\").ViewBase)\n\nShopScene.RESOURCE_FILENAME = \"ShopScene.csb\"\n\nfunction ShopScene:onCreate()\n\n    local twitter = plugin.PluginManager:getInstance():loadPlugin(\"ShareTwitter\")\n    if DEBUG > 1 then\n        twitter:setDebugMode(true);\n    end\n    twitter:configDeveloperInfo({ TwitterKey = \"todo\", TwitterSecret = \"todo\"})\n\n\n        local s = cc.Director:getInstance():getWinSize()\n\n    \tlocal target = cc.RenderTexture:create(s.width, s.height, cc.TEXTURE2_D_PIXEL_FORMAT_RGB_A8888)\n    \ttarget:retain()\n    \ttarget:setPosition(cc.p(s.width / 2, s.height / 2)) \n\n    root:getChildByName(\"ScrollView\"):getChildByName(\"Share\"):addTouchEventListener(function(sender, eventType)\n        printInfo(\"share touch\")\n        if eventType == 2 then\n\n            target:clear(math.random(), math.random(), math.random(), math.random())\n            target:begin()\n            cc.Director:getInstance():getRunningScene():visit()\n            target:endToLua()\n            target:saveToFile(\"t.png\", cc.IMAGE_FORMAT_PNG)\n                                                                          \n            twitter:share({SharedText = \"share test\", SharedImagePath = \"t.png\"}, function(ret, msg)\n                printInfo(\"share:%d:%s\", ret, msg)\n            end)\n\n        end\n    end)\n\n                                                               \n        end                                                    \n    end) \nend\n\nreturn ShopScene\n\n```\n\n\n", "tags": ["cocos2d-x", "Lua"]}