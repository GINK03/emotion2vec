{"context": "\n\n\u6982\u8981\nMicrosoft\u304c\u4f5c\u3063\u305fSAT Solver\u306eZ3\u3092\u7528\u3044\u3066\uff0c\u57fa\u672c\u7684\u306a\u8ad6\u7406\u7d20\u5b50\u3092\u518d\u73fe\u3059\u308b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u7bc9\u3092\u884c\u3046\uff0e\n\u305d\u308c\u306b\u4f34\u3044\uff0c\uff11\u3064\u306e\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u3067\u306fXOR\u304c\u518d\u73fe\u4e0d\u80fd\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3059\uff0e\n\u307e\u305f\uff0cXOR\u518d\u73fe\u53ef\u80fd\u306a\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u6210\u3092\u793a\u3059\uff0e\n\n\u95a2\u9023\u3059\u308b\u8a18\u4e8b\nZ3\u306b\u3088\u308b\u6c4e\u7528\u5927\u57df\u7684\u6700\u9069\u5316\nhttp://qiita.com/kotauchisunsun/items/90bce940a1c08ca1b7ae\n\n\u5b9f\u88c5\u3059\u308b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\n\u975e\u5e38\u306b\u5358\u7d14\u306a\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\uff12\u5165\u529b\uff11\u51fa\u529b\u306e\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u3092\u6271\u3046\uff0e\n\u51fa\u529b\u306f\nif w1 * i1 + w2 * i2 + b > 0:\n    return 1\nelse:\n    return 0\n\n\n\n\u5b9f\u969b\u306e\u30b3\u30fc\u30c9\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u7528\u3044\u3066\u5b9f\u884c\u3059\u308b\uff0e\nnn_test.py:\n#coding:utf-8\nimport sys\nfrom z3 import *\n\ndef and_def(w1,w2,b,s):\n    for i in [0,1]:\n        for j in [0,1]:\n            if i*j==1:\n                ex = w1 * i + w2 * j + b > 0\n            else:\n                ex = w1 * i + w2 * j + b <= 0\n            print ex\n            s.add(ex)\n            print s.check()\n            print s.model()\n\ndef or_def(w1,w2,b,s):\n    for i in [0,1]:\n        for j in [0,1]:\n            if i+j>0:\n                ex = w1 * i + w2 * j + b > 0\n            else:\n                ex = w1 * i + w2 * j + b <= 0\n            print ex\n            s.add(ex)\n            print s.check()\n            print s.model()\n\ndef nand_def(w1,w2,b,s):\n    for i in [0,1]:\n        for j in [0,1]:\n            if not i*j==1:\n                ex = w1 * i + w2 * j + b > 0\n            else:\n                ex = w1 * i + w2 * j + b <= 0\n            print ex\n            s.add(ex)\n            print s.check()\n            print s.model()\n\ndef xor_def(w1,w2,b,s):\n    for i in [0,1]:\n        for j in [0,1]:\n            if i+j==1:\n                ex = w1 * i + w2 * j + b > 0.0\n            else:\n                ex = w1 * i + w2 * j + b <= 0.0\n            print ex\n            s.add(ex)\n            print s.check()\n            print s.model()\n\nif __name__ == \"__main__\":\n    i1 = Real('i1')\n    i2 = Real('i2')\n\n    w1 = Real('w1')\n    w2 = Real('w2')\n    b  = Real('b')\n\n    out = Real('out')\n\n    s = Solver()\n\n    table = {\n        \"and\"  : and_def,\n        \"or\"   : or_def, \n        \"nand\" : nand_def,\n        \"xor\"  : xor_def,\n    }\n\n    table[sys.argv[1]](w1,w2,b,s)\n\n\nand\u306e\u5834\u5408\n\n\n\ni1\ni2\n\u51fa\u529b\n\n\n\n\n0\n0\n0\n\n\n0\n1\n0\n\n\n1\n0\n0\n\n\n1\n1\n1\n\n\n\n\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30c9\n$ python nn_test.py and\n> w1*0 + w2*0 + b <= 0\n> sat\n> [b = 0]\n> w1*0 + w2*1 + b <= 0\n> sat\n> [w2 = 0, b = 0]\n> w1*1 + w2*0 + b <= 0\n> sat\n> [w2 = 0, b = 0, w1 = 0]\n> w1*1 + w2*1 + b > 0\n> sat\n> [w2 = 1, b = -1, w1 = 1]\n\n\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\u3057\u305f\u304c\u3063\u3066\uff0cand\u3092\u8868\u3059\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u306f\uff0c\nw1 = 1\nw2 = 1\nb = -1\n\n\u3067\u8868\u3055\u308c\u308b\uff0e\n\nor\u306e\u5834\u5408\n\n\n\ni1\ni2\n\u51fa\u529b\n\n\n\n\n0\n0\n0\n\n\n0\n1\n1\n\n\n1\n0\n1\n\n\n1\n1\n1\n\n\n\n\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30c9\n$ python nn_test.py or\n> w1*0 + w2*0 + b <= 0\n> sat\n> [b = 0]\n> w1*0 + w2*1 + b > 0\n> sat\n> [w2 = 1, b = 0]\n> w1*1 + w2*0 + b > 0\n> sat\n> [w2 = 1, b = 0, w1 = 1]\n> w1*1 + w2*1 + b > 0\n> sat\n> [w2 = 1, b = 0, w1 = 1]\n\n\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\u3057\u305f\u304c\u3063\u3066\uff0cor\u3092\u8868\u3059\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u306f\uff0c\nw1 = 1\nw2 = 1\nb  = 0\n\n\u3067\u8868\u3055\u308c\u308b\uff0e\n\nnand\u306e\u5834\u5408\n\n\n\ni1\ni2\n\u51fa\u529b\n\n\n\n\n0\n0\n1\n\n\n0\n1\n1\n\n\n1\n0\n1\n\n\n1\n1\n0\n\n\n\n\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30c9\n$ python nn_test.py nand\n> w1*0 + w2*0 + b > 0\n> sat\n> [b = 1]\n> w1*0 + w2*1 + b > 0\n> sat\n> [w2 = 0, b = 1]\n> w1*1 + w2*0 + b > 0\n> sat\n> [w2 = 0, b = 1, w1 = 0]\n> w1*1 + w2*1 + b <= 0\n> sat\n> [w2 = -1, b = 2, w1 = -1]\n\n\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\u3057\u305f\u304c\u3063\u3066\uff0cnand\u3092\u8868\u3059\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u306f\uff0c\nw1 = -1\nw2 = -1\nb  = 2\n\n\u3067\u8868\u3055\u308c\u308b\uff0enand\u304c\u3067\u304d\u305f\u306e\u3067\uff0c\u3053\u308c\u3092\u3082\u3063\u3066\uff0c\u4efb\u610f\u306e\u8ad6\u7406\u56de\u8def\u304c\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u3088\u3063\u3066\u69cb\u7bc9\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\nxor\u306e\u5834\u5408\n\n\n\ni1\ni2\n\u51fa\u529b\n\n\n\n\n0\n0\n0\n\n\n0\n1\n1\n\n\n1\n0\n1\n\n\n1\n1\n0\n\n\n\n\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30c9\n$ python nn_test.py xor\nw1*0 + w2*0 + b <= 0\nsat\n[b = 0]\nw1*0 + w2*1 + b > 0\nsat\n[w2 = 1, b = 0]\nw1*1 + w2*0 + b > 0\nsat\n[w2 = 1, b = 0, w1 = 1]\nw1*1 + w2*1 + b <= 0\nunsat\nTraceback (most recent call last):\n  File \"nn_test.py\", line 73, in <module>\n    table[sys.argv[1]](w1,w2,b,s)\n  File \"nn_test.py\", line 51, in xor_def\n    print s.model()\n  File \"/usr/lib/python2.7/dist-packages/z3.py\", line 6100, in model\n    raise Z3Exception(\"model is not available\")\nz3types.Z3Exception: model is not available\n\nunsat\u3068\u51fa\u529b\u3055\u308c\u3066\u3057\u307e\u3063\u305f\uff0e\u3053\u308c\u304b\u30891\u3064\u306e\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u304b\u3089\uff0cxor\u306e\u69cb\u7bc9\u306f\u4e0d\u80fd\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\n\u3053\u308c\u306fxor\u306e\u51fa\u529b\u304c\u7dda\u5f62\u5206\u96e2\u4e0d\u80fd\u306a\u3053\u3068\u304b\u3089\u8d77\u3053\u308b\u554f\u984c\u3067\uff0c\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u754c\u9688\u3067\u306f\u3088\u304f\u77e5\u3089\u308c\u305f\u554f\u984c\u3060\uff0e\u3053\u308c\u304cz3\u3092\u7528\u3044\u3066\u3082\u78ba\u8a8d\u3067\u304d\u305f\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\n2\u6bb5\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u3088\u308bxor\u306e\u69cb\u7bc9\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u8003\u3048\u308b\uff0e\n\u3053\u308c\u306f\u5165\u529b\u5c64\u30922\u5165\u529b\u306b\u3057\u3066\uff0c2\u6bb5\u306b\u3057\u305f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u3042\u308b\uff0e\u3053\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u7528\u3044\u308b\u3053\u3068\u3067\uff0cxor\u304c\u69cb\u7bc9\u3067\u304d\u308b\u304b\u78ba\u304b\u3081\u308b\uff0e\n\nxor_nn_test.py:\n#coding:utf-8\n\nfrom z3 import *\n\nif __name__ == \"__main__\":\n\n    w1 = Real('w1')\n    w2 = Real('w2')\n    w3 = Real('w3')\n    w4 = Real('w4')\n    w5 = Real('w5')\n    w6 = Real('w6')\n\n    b1  = Real('b1')\n    b2  = Real('b2')\n    b3  = Real('b3')\n\n    s = Solver()\n\n    for i in [0.0,1.0]:\n        for j in [0.0,1.0]:\n\n            print \"-*-\" * 10\n            o1 = Real('o1%d%d'%(i,j))\n            o2 = Real('o2%d%d'%(i,j))\n            o3 = Real('o3%d%d'%(i,j))\n\n            s.add(o1 == If(w1 * i + w2 * j + b1 > 0.0 , 1.0, 0.0))\n            s.add(o2 == If(w3 * i + w4 * j + b2 > 0.0 , 1.0, 0.0))\n            s.add(o3 == w5 * o1 + w6 * o2 + b3)\n\n            if i+j==1:\n                s.add(o3 > 0.0)\n            else:\n                s.add(o3 <= 0.0)\n            print s.check()\n            print s.model()\n\n$ python xor_nn_test.py\n> -*--*--*--*--*--*--*--*--*--*-\n> sat\n> [w5 = 0,\n>  w6 = 0,\n>  b3 = 0,\n>  b2 = 1,\n>  b1 = 1,\n>  o300 = 0,\n>  o200 = 1,\n>  o100 = 1]\n> -*--*--*--*--*--*--*--*--*--*-\n> sat\n> [o301 = 1,\n>  w4 = 0,\n>  o300 = 0,\n>  o201 = 0,\n>  o101 = 0,\n>  b3 = 1,\n>  b2 = 0,\n>  o200 = 0,\n>  w5 = -1,\n>  w2 = -1,\n>  o100 = 1,\n>  w6 = 0,\n>  b1 = 1]\n> -*--*--*--*--*--*--*--*--*--*-\n> sat\n> [o301 = 1,\n>  w3 = -1,\n>  o300 = 0,\n>  o101 = 1,\n>  b2 = 1,\n>  o200 = 1,\n>  w5 = 1,\n>  o310 = 1,\n>  w6 = -1,\n>  b1 = 0,\n>  w4 = 0,\n>  o201 = 1,\n>  b3 = 1,\n>  w2 = 1,\n>  o110 = 0,\n>  o100 = 0,\n>  o210 = 0,\n>  w1 = 0]\n> -*--*--*--*--*--*--*--*--*--*-\n> sat\n> [o301 = 1,\n>  w3 = -1,\n>  o300 = 0,\n>  o101 = 1,\n>  b2 = 2,\n>  o200 = 1,\n>  w5 = 1,\n>  o310 = 1,\n>  w6 = 1,\n>  b1 = 0,\n>  w4 = -1,\n>  o201 = 1,\n>  o111 = 1,\n>  b3 = -1,\n>  w2 = 1,\n>  o110 = 1,\n>  o211 = 0,\n>  o311 = 0,\n>  o100 = 0,\n>  o210 = 1,\n>  w1 = 1]\n\nsat\u3057\u305f\u3053\u3068\u306b\u3088\u308a\uff0c\u56f3\u793a\u3057\u305f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067xor\u304c\u518d\u73fe\u3067\u304d\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\u305d\u306e\u6642\u306e\u5024\u306f\nw1 = 1\nw2 = 1\nw3 = -1\nw4 = -1\nw5 = 1\nw6 = 1\nb1 = 0\nb2 = 2\nb3 = -1\n\n\u3068\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\u3053\u306e\u4fc2\u6570\u304b\u3089\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u3064\u3044\u3066\u8003\u5bdf\u3092\u884c\u3046\u3068\uff0c\n\u5de6\u4e0a\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\nw1 = 1\nw2 = 1\nb1 = 0\n\n\u3068\u3044\u3046\u4fc2\u6570\u304b\u3089\u69cb\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\u3053\u306e\u7d50\u679c\uff0c\u5de6\u4e0a\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\"OR\"\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\u5de6\u4e0b\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\nw3 = -1\nw4 = -1\nb2 = 2\n\n\u3068\u3044\u3046\u4fc2\u6570\u304b\u3089\u69cb\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\u3053\u306e\u7d50\u679c\uff0c\u5de6\u4e0b\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\"nand\"\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\u6700\u5f8c\u306e\u53f3\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\nw5 = 1\nw6 = 1\nb3 = -1\n\n\u3068\u3044\u3046\u4fc2\u6570\u304b\u3089\u69cb\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\u3053\u306e\u7d50\u679c\uff0c\u5de6\u4e0b\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\"and\"\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\u3053\u3053\u3067\u51fa\u529b\u3092out\u3068\u3059\u308b\u3068\nout = (i1 or i2) and not (i1 and i2)\n\u30c9\u30e2\u30eb\u30ac\u30f3\u5247\u306b\u3088\u308a\uff0c\nout = (i1 or i2) and (not i1 or not i2)\nout = (i1 and not i1) or (i1 and not i2) or (i2 and not i1) or (i2 and not i2)\n\u3053\u3053\u3067\ni1 and not i1 = false\ni2 and not i2 = false\n\u306a\u306e\u3067\nout = (i1 and not i2) or (i2 and not i1)\nout = i1 xor i2\n\u3068\u306a\u308a\uff0cout\u304ci1,i2\u306exor\u51fa\u529b\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\uff0c\u3053\u3053\u304b\u3089\u3082\u5206\u304b\u308b\uff0e\n\u3057\u305f\u304c\u3063\u3066\uff0c\uff12\u6bb5\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067xor\u51fa\u529b\u3092Z3\u306b\u3088\u308a\u518d\u73fe\u3067\u304d\u305f\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\n\u307e\u3068\u3081\nZ3\u306b\u3088\u308a\u5358\u7d14\u306a\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u3067\uff0cand,or,nand\u304c\u69cb\u7bc9\u53ef\u80fd\u3067\u3042\u308a\uff0cnand\u304c\u69cb\u7bc9\u4e0d\u80fd\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u305f\uff0e\n\u307e\u305f\uff0cZ3\u3067\uff12\u6bb5\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067xor\u304c\u69cb\u7bc9\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u305f\uff0e\u307e\u305f\uff0c\u305d\u306e\u90e8\u5206\u306e\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u304c\uff0cand,or,nand\u3068\u540c\u7b49\u306e\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\uff0c\u8ad6\u7406\u5f0f\u304b\u3089\u3082xor\u304c\u51fa\u529b\u3055\u308c\u308b\u3053\u3068\u3092\u793a\u3057\u305f\uff0e\n#\u6982\u8981\nMicrosoft\u304c\u4f5c\u3063\u305fSAT Solver\u306eZ3\u3092\u7528\u3044\u3066\uff0c\u57fa\u672c\u7684\u306a\u8ad6\u7406\u7d20\u5b50\u3092\u518d\u73fe\u3059\u308b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u7bc9\u3092\u884c\u3046\uff0e\n\u305d\u308c\u306b\u4f34\u3044\uff0c\uff11\u3064\u306e\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u3067\u306fXOR\u304c\u518d\u73fe\u4e0d\u80fd\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3059\uff0e\n\u307e\u305f\uff0cXOR\u518d\u73fe\u53ef\u80fd\u306a\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u6210\u3092\u793a\u3059\uff0e\n\n#\u95a2\u9023\u3059\u308b\u8a18\u4e8b\n\nZ3\u306b\u3088\u308b\u6c4e\u7528\u5927\u57df\u7684\u6700\u9069\u5316\nhttp://qiita.com/kotauchisunsun/items/90bce940a1c08ca1b7ae\n\n#\u5b9f\u88c5\u3059\u308b\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\n\u975e\u5e38\u306b\u5358\u7d14\u306a\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\uff12\u5165\u529b\uff11\u51fa\u529b\u306e\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u3092\u6271\u3046\uff0e\n\n\u51fa\u529b\u306f\n\n```py\nif w1 * i1 + w2 * i2 + b > 0:\n    return 1\nelse:\n    return 0\n```\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/139643/702b632c-b5bf-b104-5a8a-dd17b072e774.png)\n\n\n#\u5b9f\u969b\u306e\u30b3\u30fc\u30c9\n\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u7528\u3044\u3066\u5b9f\u884c\u3059\u308b\uff0e\n\nnn_test.py:\n\n```py\n#coding:utf-8\nimport sys\nfrom z3 import *\n\ndef and_def(w1,w2,b,s):\n    for i in [0,1]:\n        for j in [0,1]:\n            if i*j==1:\n                ex = w1 * i + w2 * j + b > 0\n            else:\n                ex = w1 * i + w2 * j + b <= 0\n            print ex\n            s.add(ex)\n            print s.check()\n            print s.model()\n\ndef or_def(w1,w2,b,s):\n    for i in [0,1]:\n        for j in [0,1]:\n            if i+j>0:\n                ex = w1 * i + w2 * j + b > 0\n            else:\n                ex = w1 * i + w2 * j + b <= 0\n            print ex\n            s.add(ex)\n            print s.check()\n            print s.model()\n\ndef nand_def(w1,w2,b,s):\n    for i in [0,1]:\n        for j in [0,1]:\n            if not i*j==1:\n                ex = w1 * i + w2 * j + b > 0\n            else:\n                ex = w1 * i + w2 * j + b <= 0\n            print ex\n            s.add(ex)\n            print s.check()\n            print s.model()\n\ndef xor_def(w1,w2,b,s):\n    for i in [0,1]:\n        for j in [0,1]:\n            if i+j==1:\n                ex = w1 * i + w2 * j + b > 0.0\n            else:\n                ex = w1 * i + w2 * j + b <= 0.0\n            print ex\n            s.add(ex)\n            print s.check()\n            print s.model()\n\nif __name__ == \"__main__\":\n    i1 = Real('i1')\n    i2 = Real('i2')\n\n    w1 = Real('w1')\n    w2 = Real('w2')\n    b  = Real('b')\n\n    out = Real('out')\n\n    s = Solver()\n\n    table = {\n        \"and\"  : and_def,\n        \"or\"   : or_def, \n        \"nand\" : nand_def,\n        \"xor\"  : xor_def,\n    }\n\n    table[sys.argv[1]](w1,w2,b,s)\n```\n\n#and\u306e\u5834\u5408\n| i1 | i2 | \u51fa\u529b |\n|:-:|:-:|:-:|\n| 0  | 0 | 0 |\n| 0  | 1 | 0 |\n| 1  | 0 | 0 |\n| 1  | 1 | 1 |\n\n\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30c9\n\n```shell-session\n$ python nn_test.py and\n> w1*0 + w2*0 + b <= 0\n> sat\n> [b = 0]\n> w1*0 + w2*1 + b <= 0\n> sat\n> [w2 = 0, b = 0]\n> w1*1 + w2*0 + b <= 0\n> sat\n> [w2 = 0, b = 0, w1 = 0]\n> w1*1 + w2*1 + b > 0\n> sat\n> [w2 = 1, b = -1, w1 = 1]\n```\n\n\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\u3057\u305f\u304c\u3063\u3066\uff0cand\u3092\u8868\u3059\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u306f\uff0c\n\n```\nw1 = 1\nw2 = 1\nb = -1\n```\n\n\u3067\u8868\u3055\u308c\u308b\uff0e\n\n\n#or\u306e\u5834\u5408\n| i1 | i2 | \u51fa\u529b |\n|:-:|:-:|:-:|\n| 0  | 0 | 0 |\n| 0  | 1 | 1 |\n| 1  | 0 | 1 |\n| 1  | 1 | 1 |\n\n\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30c9\n\n```shell-session\n$ python nn_test.py or\n> w1*0 + w2*0 + b <= 0\n> sat\n> [b = 0]\n> w1*0 + w2*1 + b > 0\n> sat\n> [w2 = 1, b = 0]\n> w1*1 + w2*0 + b > 0\n> sat\n> [w2 = 1, b = 0, w1 = 1]\n> w1*1 + w2*1 + b > 0\n> sat\n> [w2 = 1, b = 0, w1 = 1]\n```\n\n\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\u3057\u305f\u304c\u3063\u3066\uff0cor\u3092\u8868\u3059\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u306f\uff0c\n\n```\nw1 = 1\nw2 = 1\nb  = 0\n```\n\n\u3067\u8868\u3055\u308c\u308b\uff0e\n\n\n#nand\u306e\u5834\u5408\n| i1 | i2 | \u51fa\u529b |\n|:-:|:-:|:-:|\n| 0  | 0 | 1 |\n| 0  | 1 | 1 |\n| 1  | 0 | 1 |\n| 1  | 1 | 0 |\n\n\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30c9\n\n```shell-session\n$ python nn_test.py nand\n> w1*0 + w2*0 + b > 0\n> sat\n> [b = 1]\n> w1*0 + w2*1 + b > 0\n> sat\n> [w2 = 0, b = 1]\n> w1*1 + w2*0 + b > 0\n> sat\n> [w2 = 0, b = 1, w1 = 0]\n> w1*1 + w2*1 + b <= 0\n> sat\n> [w2 = -1, b = 2, w1 = -1]\n```\n\n\u3068\u3044\u3046\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\u3057\u305f\u304c\u3063\u3066\uff0cnand\u3092\u8868\u3059\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u306f\uff0c\n\n```\nw1 = -1\nw2 = -1\nb  = 2\n```\n\n\u3067\u8868\u3055\u308c\u308b\uff0enand\u304c\u3067\u304d\u305f\u306e\u3067\uff0c\u3053\u308c\u3092\u3082\u3063\u3066\uff0c\u4efb\u610f\u306e\u8ad6\u7406\u56de\u8def\u304c\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u3088\u3063\u3066\u69cb\u7bc9\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\n\n#xor\u306e\u5834\u5408\n| i1 | i2 | \u51fa\u529b |\n|:-:|:-:|:-:|\n| 0  | 0 | 0 |\n| 0  | 1 | 1 |\n| 1  | 0 | 1 |\n| 1  | 1 | 0 |\n\n\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30c9\n\n```shell-session\n$ python nn_test.py xor\nw1*0 + w2*0 + b <= 0\nsat\n[b = 0]\nw1*0 + w2*1 + b > 0\nsat\n[w2 = 1, b = 0]\nw1*1 + w2*0 + b > 0\nsat\n[w2 = 1, b = 0, w1 = 1]\nw1*1 + w2*1 + b <= 0\nunsat\nTraceback (most recent call last):\n  File \"nn_test.py\", line 73, in <module>\n    table[sys.argv[1]](w1,w2,b,s)\n  File \"nn_test.py\", line 51, in xor_def\n    print s.model()\n  File \"/usr/lib/python2.7/dist-packages/z3.py\", line 6100, in model\n    raise Z3Exception(\"model is not available\")\nz3types.Z3Exception: model is not available\n```\n\nunsat\u3068\u51fa\u529b\u3055\u308c\u3066\u3057\u307e\u3063\u305f\uff0e\u3053\u308c\u304b\u30891\u3064\u306e\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u304b\u3089\uff0cxor\u306e\u69cb\u7bc9\u306f\u4e0d\u80fd\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\n\u3053\u308c\u306fxor\u306e\u51fa\u529b\u304c\u7dda\u5f62\u5206\u96e2\u4e0d\u80fd\u306a\u3053\u3068\u304b\u3089\u8d77\u3053\u308b\u554f\u984c\u3067\uff0c\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u754c\u9688\u3067\u306f\u3088\u304f\u77e5\u3089\u308c\u305f\u554f\u984c\u3060\uff0e\u3053\u308c\u304cz3\u3092\u7528\u3044\u3066\u3082\u78ba\u8a8d\u3067\u304d\u305f\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\n\n#2\u6bb5\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u3088\u308bxor\u306e\u69cb\u7bc9\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u8003\u3048\u308b\uff0e\n\u3053\u308c\u306f\u5165\u529b\u5c64\u30922\u5165\u529b\u306b\u3057\u3066\uff0c2\u6bb5\u306b\u3057\u305f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067\u3042\u308b\uff0e\u3053\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u7528\u3044\u308b\u3053\u3068\u3067\uff0cxor\u304c\u69cb\u7bc9\u3067\u304d\u308b\u304b\u78ba\u304b\u3081\u308b\uff0e\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/139643/fc8b86be-3719-0893-fc96-3ae8f1c162a3.png)\n\nxor_nn_test.py:\n\n```py\n#coding:utf-8\n\nfrom z3 import *\n\nif __name__ == \"__main__\":\n\n    w1 = Real('w1')\n    w2 = Real('w2')\n    w3 = Real('w3')\n    w4 = Real('w4')\n    w5 = Real('w5')\n    w6 = Real('w6')\n    \n    b1  = Real('b1')\n    b2  = Real('b2')\n    b3  = Real('b3')\n\n    s = Solver()\n\n    for i in [0.0,1.0]:\n        for j in [0.0,1.0]:\n\n            print \"-*-\" * 10\n            o1 = Real('o1%d%d'%(i,j))\n            o2 = Real('o2%d%d'%(i,j))\n            o3 = Real('o3%d%d'%(i,j))\n\n            s.add(o1 == If(w1 * i + w2 * j + b1 > 0.0 , 1.0, 0.0))\n            s.add(o2 == If(w3 * i + w4 * j + b2 > 0.0 , 1.0, 0.0))\n            s.add(o3 == w5 * o1 + w6 * o2 + b3)\n            \n            if i+j==1:\n                s.add(o3 > 0.0)\n            else:\n                s.add(o3 <= 0.0)\n            print s.check()\n            print s.model()\n```\n\n```\n$ python xor_nn_test.py\n> -*--*--*--*--*--*--*--*--*--*-\n> sat\n> [w5 = 0,\n>  w6 = 0,\n>  b3 = 0,\n>  b2 = 1,\n>  b1 = 1,\n>  o300 = 0,\n>  o200 = 1,\n>  o100 = 1]\n> -*--*--*--*--*--*--*--*--*--*-\n> sat\n> [o301 = 1,\n>  w4 = 0,\n>  o300 = 0,\n>  o201 = 0,\n>  o101 = 0,\n>  b3 = 1,\n>  b2 = 0,\n>  o200 = 0,\n>  w5 = -1,\n>  w2 = -1,\n>  o100 = 1,\n>  w6 = 0,\n>  b1 = 1]\n> -*--*--*--*--*--*--*--*--*--*-\n> sat\n> [o301 = 1,\n>  w3 = -1,\n>  o300 = 0,\n>  o101 = 1,\n>  b2 = 1,\n>  o200 = 1,\n>  w5 = 1,\n>  o310 = 1,\n>  w6 = -1,\n>  b1 = 0,\n>  w4 = 0,\n>  o201 = 1,\n>  b3 = 1,\n>  w2 = 1,\n>  o110 = 0,\n>  o100 = 0,\n>  o210 = 0,\n>  w1 = 0]\n> -*--*--*--*--*--*--*--*--*--*-\n> sat\n> [o301 = 1,\n>  w3 = -1,\n>  o300 = 0,\n>  o101 = 1,\n>  b2 = 2,\n>  o200 = 1,\n>  w5 = 1,\n>  o310 = 1,\n>  w6 = 1,\n>  b1 = 0,\n>  w4 = -1,\n>  o201 = 1,\n>  o111 = 1,\n>  b3 = -1,\n>  w2 = 1,\n>  o110 = 1,\n>  o211 = 0,\n>  o311 = 0,\n>  o100 = 0,\n>  o210 = 1,\n>  w1 = 1]\n```\n\nsat\u3057\u305f\u3053\u3068\u306b\u3088\u308a\uff0c\u56f3\u793a\u3057\u305f\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067xor\u304c\u518d\u73fe\u3067\u304d\u308b\u3053\u3068\u304c\u5206\u304b\u3063\u305f\uff0e\u305d\u306e\u6642\u306e\u5024\u306f\n\n```\nw1 = 1\nw2 = 1\nw3 = -1\nw4 = -1\nw5 = 1\nw6 = 1\nb1 = 0\nb2 = 2\nb3 = -1\n```\n\n\u3068\u306a\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\u3053\u306e\u4fc2\u6570\u304b\u3089\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u3064\u3044\u3066\u8003\u5bdf\u3092\u884c\u3046\u3068\uff0c\n\u5de6\u4e0a\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\n\n```\nw1 = 1\nw2 = 1\nb1 = 0\n```\n\n\u3068\u3044\u3046\u4fc2\u6570\u304b\u3089\u69cb\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\u3053\u306e\u7d50\u679c\uff0c\u5de6\u4e0a\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\"OR\"\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\n\n\u5de6\u4e0b\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\n\n```\nw3 = -1\nw4 = -1\nb2 = 2\n```\n\n\u3068\u3044\u3046\u4fc2\u6570\u304b\u3089\u69cb\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\u3053\u306e\u7d50\u679c\uff0c\u5de6\u4e0b\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\"nand\"\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\n\n\u6700\u5f8c\u306e\u53f3\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\n\n```\nw5 = 1\nw6 = 1\nb3 = -1\n```\n\n\u3068\u3044\u3046\u4fc2\u6570\u304b\u3089\u69cb\u6210\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\u3053\u306e\u7d50\u679c\uff0c\u5de6\u4e0b\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\"and\"\u3067\u3042\u308b\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\n\u3053\u3053\u3067\u51fa\u529b\u3092out\u3068\u3059\u308b\u3068\n\nout = (i1 or i2) and not (i1 and i2)\n\u30c9\u30e2\u30eb\u30ac\u30f3\u5247\u306b\u3088\u308a\uff0c\nout = (i1 or i2) and (not i1 or not i2)\nout = (i1 and not i1) or (i1 and not i2) or (i2 and not i1) or (i2 and not i2)\n\u3053\u3053\u3067\ni1 and not i1 = false\ni2 and not i2 = false\n\u306a\u306e\u3067\nout = (i1 and not i2) or (i2 and not i1)\nout = i1 xor i2\n\n\u3068\u306a\u308a\uff0cout\u304ci1,i2\u306exor\u51fa\u529b\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u304c\uff0c\u3053\u3053\u304b\u3089\u3082\u5206\u304b\u308b\uff0e\n\u3057\u305f\u304c\u3063\u3066\uff0c\uff12\u6bb5\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067xor\u51fa\u529b\u3092Z3\u306b\u3088\u308a\u518d\u73fe\u3067\u304d\u305f\u3053\u3068\u304c\u5206\u304b\u308b\uff0e\n\n\n#\u307e\u3068\u3081\nZ3\u306b\u3088\u308a\u5358\u7d14\u306a\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u3067\uff0cand,or,nand\u304c\u69cb\u7bc9\u53ef\u80fd\u3067\u3042\u308a\uff0cnand\u304c\u69cb\u7bc9\u4e0d\u80fd\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u305f\uff0e\n\u307e\u305f\uff0cZ3\u3067\uff12\u6bb5\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3067xor\u304c\u69cb\u7bc9\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u305f\uff0e\u307e\u305f\uff0c\u305d\u306e\u90e8\u5206\u306e\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u304c\uff0cand,or,nand\u3068\u540c\u7b49\u306e\u52d5\u4f5c\u3092\u78ba\u8a8d\u3057\uff0c\u8ad6\u7406\u5f0f\u304b\u3089\u3082xor\u304c\u51fa\u529b\u3055\u308c\u308b\u3053\u3068\u3092\u793a\u3057\u305f\uff0e\n", "tags": ["Python", "SAT", "\u6a5f\u68b0\u5b66\u7fd2", "Z3", "\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af"]}