{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\n\u4ee5\u524d\u3001JScript\u3067WMI\uff08\u305d\u306e\uff11\uff09\u3067\u30d7\u30ed\u30d1\u30c6\u30a3\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f\u3002\n\u305d\u3053\u3067\u4f5c\u3063\u305f\u30e1\u30bd\u30c3\u30c9\u3092\u5229\u7528\u3059\u308b\u306b\u3042\u305f\u308a\u3001\u7279\u6b8a\u306a\u6319\u52d5\u3092\u3059\u308b\u3082\u306e\u3001\u30af\u30a8\u30ea\u306e\u8a18\u8ff0\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\nPing\nWMI\u306e\u30af\u30e9\u30b9\u306b\u300cWin32_PingStatus\u300d\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u308c\u306f\u3001\u30af\u30a8\u30ea\u306b\u300cSELECT * FROM Win32_PingStatus\u300d\u3092\u8a2d\u5b9a\u3057\u3066\u3082\u4f55\u3082\u304a\u3053\u308a\u307e\u305b\u3093\u3002\n\uff08\u7d50\u679c\u306f\u3001\uff11\u884c\u3082\u5e30\u3063\u3066\u304d\u307e\u305b\u3093\u3002\uff09\nWHERE\u53e5\u306b\u300cAddress\u300d\u3092\u6307\u5b9a\u3057\u3066\u307f\u308b\u3068\u3001Ping\u306e\u7d50\u679c\u304c\u8fd4\u3055\u308c\u307e\u3059\u3002\nvar query = \"SELECT Address,StatusCode FROM Win32_PingStatus WHERE Address = '192.168.0.1'\";\nvar props = wmiProps(query);\nvar csv = props2csv(props);\nWScript.Echo(csv);\n\n\u7d50\u679c\u306f\u3001\u300cStatusCode\u300d\u306b\u5165\u3063\u3066\u304d\u307e\u3059\u3002\n\u7d50\u679c\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\uff08\u539f\u6587\u306e\u307e\u307e\u8a18\u8f09\u3057\u3066\u307e\u3059\u3002\uff09\n\n\n\nValue\nMeaning\n\nValue\nMeaning\n\n\n\n\n0\nSuccess\n\n11011\nBad Request\n\n\n11001\nBuffer Too Small\n\n11012\nBad Route\n\n\n11002\nDestination Net Unreachable\n\n11013\nTimeToLive Expired Transit\n\n\n11003\nDestination Host Unreachable\n\n11014\nTimeToLive Expired Reassembly\n\n\n11004\nDestination Protocol Unreachable\n\n11015\nParameter Problem\n\n\n11005\nDestination Port Unreachable\n\n11016\nSource Quench\n\n\n11006\nNo Resources\n\n11017\nOption Too Big\n\n\n11007\nBad Option\n\n11018\nBad Destination\n\n\n11008\nHardware Error\n\n11032\nNegotiating IPSEC\n\n\n11009\nPacket Too Big\n\n11050\nGeneral Failure\n\n\n11010\nRequest Timed Out\n\n\n\n\n\n\n\nWQL\n\n\u69cb\u6587\nWMI\u3067\u8a2d\u5b9a\u3059\u308b\u30af\u30a8\u30ea\u306f\u3001WQL\uff08WMI Query Language\uff09\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002\nSQL\u306e\u30af\u30a8\u30ea\u3068\u4f3c\u3066\u3044\u307e\u3059\u304c\u3001\u7570\u306a\u308b\u90e8\u5206\u304c\u3042\u308a\u307e\u3059\u3002\n\uff08SQL\u306e\u6a5f\u80fd\u5236\u9650\u7248\u307f\u305f\u3044\u306a\u611f\u3058\u3067\u3059\u3002\uff09\n\nWQL\u69cb\u6587\nSELECT properties FROM class [WHERE conditions]\n\n\nproperties\n\u3053\u306e\u90e8\u5206\u3067\u4f7f\u3048\u308b\u306e\u306f\u3001\u5404\u30af\u30e9\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u540d\u3068\u300c\u300d\u3067\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3082\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u300c\u300d\u306f\u5168\u3066\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\nSQL\u3068\u7570\u306a\u308b\u70b9\u3068\u3057\u3066\u3001\u5185\u90e8\u3067\u306e\u6f14\u7b97\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\nOK\nSELECT * FROM Win32_Process\nSELECT Caption,ProcessID,WorkingSetSize FROM Win32_Process\nNG\nSELECT Caption,FileSystem,Size - FreeSpace FROM Win32_LogicalDisk WHERE DriveType = '3'\n\n\nclass\n\u30af\u30e9\u30b9\u306e\u90e8\u5206\u306f\u3001WMI\u30af\u30e9\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4e3b\u306b\u4f7f\u3046\u306e\u304c\u300cWin32 Provider\u300d\u306b\u5c5e\u3059\u308b\u30af\u30e9\u30b9\u3067\u3059\u3002\nSQL\u3068\u7570\u306a\u308b\u70b9\u3068\u3057\u3066\u3001\uff11\u3064\u306e\u30af\u30e9\u30b9\u3057\u304b\u6307\u5b9a\u3067\u304d\u307e\u305b\u3093\u3002\n\nconditions\n\u6761\u4ef6\u3092\u6307\u5b9a\u3059\u308b\u90e8\u5206\u3067\u3059\u3002\n\u6761\u4ef6\u306e\u63a5\u7d9a\u306f\u3001\u62ec\u5f27\u300c()\u300d\u3001\u304b\u3064\u300cAND\u300d\u3001\u307e\u305f\u306f\u300cOR\u300d\u304c\u4f7f\u3048\u307e\u3059\u3002\n\u307e\u305f\u3001\u5024\u306e\u6761\u4ef6\u5f0f\u306f\n\u6f14\u7b97\u5b50\u3068\u3057\u3066\u3001\u7b49\u3057\u3044\u300c=\u300d\u3001\u672a\u6e80\u300c<\u300d\u3001\u4ee5\u4e0b\u300c<=\u300d\u3001\u3088\u308a\u5927\u304d\u3044\u300c>\u300d\u3001\u4ee5\u4e0a\u300c>=\u300d\u3001\u7b49\u3057\u304f\u306a\u3044\u300c<>\u300d\n\u304c\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\u307e\u305f\u3001\u300cIS NOT NULL\u300d\u300cIS NULL\u300d\u300cLIKE\u300d\u3082\u5229\u7528\u51fa\u6765\u307e\u3059\u3002\n\n\u30c9\u30e9\u30a4\u30d6C\u3068D\u306e\u60c5\u5831\nSELECT * FROM Win32_LogicalDisk WHERE DeviceID = 'C:' OR DeviceID = 'D:'\n\u30c9\u30e9\u30a4\u30d6C\u3068D\u3067\u7a7a\u304d\u5bb9\u91cf\u304c\uff11G\u672a\u6e80\u306e\u60c5\u5831\nSELECT * FROM Win32_LogicalDisk WHERE (DeviceID = 'C:' OR DeviceID = 'D:') AND FreeSpace < 1048576\nSQL\u95a2\u9023\u306e\u30b5\u30fc\u30d3\u30b9\u60c5\u5831\nSELECT * FROM Win32_Service WHERE Name LIKE '%SQL%'\n\n\ndatetime\nWMI\u3067\u5229\u7528\u3059\u308bdatetime\u578b\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u3001yyyymmddHHMMSS.xxxxxx\u00b1UUU\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001JScript\u306eDate\u578b\u304b\u3089\u3001datetime\u578b\u306e\u751f\u6210\u3001datetime\u578b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u51fa\u529b\u306e\uff12\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\nUUU\u306e\u00b1\u304c\u901a\u5e38\u3068\u306f\u9006\u306b\u8a2d\u5b9a\u3059\u308b\u3088\u3046\u3067\u3001\u308f\u304b\u308a\u3065\u3089\u304f\u306a\u308a\u305d\u3046\u306a\u306e\u3067UTC\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\nfunction wmiDate(date) {\n    var datetime = null;\n    if (date && date instanceof Date) {\n        // \u300cSWbemDateTime\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n        datetime = new ActiveXObject(\"WbemScripting.SWbemDateTime\");\n        datetime.Year = date.getUTCFullYear();                     // \u5e74\n        datetime.Month = date.getUTCMonth() + 1;                   // \u6708\n        datetime.Day = date.getUTCDate();                          // \u65e5\n        datetime.Hours = date.getUTCHours();                       // \u6642\n        datetime.Minutes = date.getUTCMinutes();                   // \u5206\n        datetime.Seconds = date.getUTCSeconds();                   // \u79d2\n        datetime.Microseconds = date.getUTCMilliseconds() * 1000;  // \u30df\u30ea\u79d2\n    }\n    return datetime;\n}\n\nfunction wmiDateFormat(date) {\n    var ret = null;\n    if (date && date instanceof Date) {\n        ret = date.getUTCFullYear()                         // \u5e74\n            + (\"0\" + (date.getUTCMonth() + 1)).slice(-2)    // \u6708\n            + (\"0\" + date.getUTCDate()).slice(-2)           // \u65e5\n            + (\"0\" + date.getUTCHours()).slice(-2)          // \u6642\n            + (\"0\" + date.getUTCMinutes()).slice(-2)        // \u5206\n            + (\"0\" + date.getUTCSeconds()).slice(-2) + \".\"  // \u79d2\n            + (\"00\" + date.getUTCMilliseconds()).slice(-3)  // \u30df\u30ea\u79d2\n            + \"000+000\";                                    // \u30ca\u30ce\u79d2\uff0bUTC\n    }\n    return ret;\n}\n\n\u3053\u308c\u3092\u5229\u7528\u3059\u308b\u3068\u3001\u672c\u65e50\u6642\u4ee5\u964d\u306e\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u306a\u3069\u304c\u51fa\u6765\u307e\u3059\u3002\nvar now = new Date();\nvar date = new Date(now.getYear(), now.getMonth(), now.getDate(), 0, 0, 0, 0);\nvar wmidate = wmiDateFormat(date);\n// var wmidate = wmiDate(date);\nvar query = \"SELECT Category,EventCode,Message,TimeWritten FROM Win32_NTLogEvent WHERE TimeWritten >= '\" + wmidate + \"'\";\nvar props = wmiProps(query);\nvar csv = props2csv(props);\nWScript.Echo(csv);\n\n\u4e00\u5fdc\u3001WMI\u306edatetime\u578b\u304b\u3089JScript\u306eDate\u578b\u3078\u623b\u3059\u30e1\u30bd\u30c3\u30c9\u3082\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\nfunction wmiDate2date(datetime) {\n    var date = null;\n    try {\n        // \u5909\u63db\n        date = new Date(Date.parse(datetime.GetVarDate()));\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        date = null;\n        // throw e;\n    }\n    return date;\n}\n\n\n## \u306f\u3058\u3081\u306b\n\n\u4ee5\u524d\u3001[JScript\u3067WMI\uff08\u305d\u306e\uff11\uff09](http://qiita.com/tnakagawa/items/ae579f19d74dd86e40c6)\u3067\u30d7\u30ed\u30d1\u30c6\u30a3\u306e\u4e00\u89a7\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f\u3002\n\u305d\u3053\u3067\u4f5c\u3063\u305f\u30e1\u30bd\u30c3\u30c9\u3092\u5229\u7528\u3059\u308b\u306b\u3042\u305f\u308a\u3001\u7279\u6b8a\u306a\u6319\u52d5\u3092\u3059\u308b\u3082\u306e\u3001\u30af\u30a8\u30ea\u306e\u8a18\u8ff0\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\n## Ping\n\nWMI\u306e\u30af\u30e9\u30b9\u306b\u300cWin32_PingStatus\u300d\u304c\u3042\u308a\u307e\u3059\u3002\n\u3053\u308c\u306f\u3001\u30af\u30a8\u30ea\u306b\u300cSELECT * FROM Win32_PingStatus\u300d\u3092\u8a2d\u5b9a\u3057\u3066\u3082\u4f55\u3082\u304a\u3053\u308a\u307e\u305b\u3093\u3002\n\uff08\u7d50\u679c\u306f\u3001\uff11\u884c\u3082\u5e30\u3063\u3066\u304d\u307e\u305b\u3093\u3002\uff09\n\nWHERE\u53e5\u306b\u300cAddress\u300d\u3092\u6307\u5b9a\u3057\u3066\u307f\u308b\u3068\u3001Ping\u306e\u7d50\u679c\u304c\u8fd4\u3055\u308c\u307e\u3059\u3002\n\n```js\nvar query = \"SELECT Address,StatusCode FROM Win32_PingStatus WHERE Address = '192.168.0.1'\";\nvar props = wmiProps(query);\nvar csv = props2csv(props);\nWScript.Echo(csv);\n```\n\n\u7d50\u679c\u306f\u3001\u300cStatusCode\u300d\u306b\u5165\u3063\u3066\u304d\u307e\u3059\u3002\n\u7d50\u679c\u30b3\u30fc\u30c9\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\uff08[\u539f\u6587](http://msdn.microsoft.com/en-us/library/aa394350%28v=vs.85%29.aspx)\u306e\u307e\u307e\u8a18\u8f09\u3057\u3066\u307e\u3059\u3002\uff09\n\n|Value|Meaning||Value|Meaning|\n|:--|:--|:--:|:--|:--|\n|0|Success| |11011|Bad Request|\n|11001|Buffer Too Small| |11012|Bad Route|\n|11002|Destination Net Unreachable| |11013|TimeToLive Expired Transit|\n|11003|Destination Host Unreachable| |11014|TimeToLive Expired Reassembly|\n|11004|Destination Protocol Unreachable| |11015|Parameter Problem|\n|11005|Destination Port Unreachable| |11016|Source Quench|\n|11006|No Resources| |11017|Option Too Big|\n|11007|Bad Option| |11018|Bad Destination|\n|11008|Hardware Error| |11032|Negotiating IPSEC|\n|11009|Packet Too Big| |11050|General Failure|\n|11010|Request Timed Out| ||\n\n\n## WQL\n\n### \u69cb\u6587\n\nWMI\u3067\u8a2d\u5b9a\u3059\u308b\u30af\u30a8\u30ea\u306f\u3001WQL\uff08WMI Query Language\uff09\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002\nSQL\u306e\u30af\u30a8\u30ea\u3068\u4f3c\u3066\u3044\u307e\u3059\u304c\u3001\u7570\u306a\u308b\u90e8\u5206\u304c\u3042\u308a\u307e\u3059\u3002\n\uff08SQL\u306e\u6a5f\u80fd\u5236\u9650\u7248\u307f\u305f\u3044\u306a\u611f\u3058\u3067\u3059\u3002\uff09\n\n> __WQL\u69cb\u6587__\n> SELECT _properties_ FROM _class_ [WHERE _conditions_]\n\n***\n_properties_\n\n\u3053\u306e\u90e8\u5206\u3067\u4f7f\u3048\u308b\u306e\u306f\u3001\u5404\u30af\u30e9\u30b9\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u540d\u3068\u300c*\u300d\u3067\u3059\u3002\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3082\u4f7f\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u300c*\u300d\u306f\u5168\u3066\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u51fa\u529b\u3057\u307e\u3059\u3002\nSQL\u3068\u7570\u306a\u308b\u70b9\u3068\u3057\u3066\u3001\u5185\u90e8\u3067\u306e\u6f14\u7b97\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\n>__OK__\n> SELECT * FROM Win32_Process\n> SELECT Caption,ProcessID,WorkingSetSize FROM Win32_Process\n> __NG__\n> ~~SELECT Caption,FileSystem,Size - FreeSpace FROM Win32_LogicalDisk WHERE DriveType = '3'~~\n\n***\n_class_\n\n\u30af\u30e9\u30b9\u306e\u90e8\u5206\u306f\u3001WMI\u30af\u30e9\u30b9\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4e3b\u306b\u4f7f\u3046\u306e\u304c\u300cWin32 Provider\u300d\u306b\u5c5e\u3059\u308b\u30af\u30e9\u30b9\u3067\u3059\u3002\nSQL\u3068\u7570\u306a\u308b\u70b9\u3068\u3057\u3066\u3001\uff11\u3064\u306e\u30af\u30e9\u30b9\u3057\u304b\u6307\u5b9a\u3067\u304d\u307e\u305b\u3093\u3002\n\n***\n_conditions_\n\n\u6761\u4ef6\u3092\u6307\u5b9a\u3059\u308b\u90e8\u5206\u3067\u3059\u3002\n\u6761\u4ef6\u306e\u63a5\u7d9a\u306f\u3001\u62ec\u5f27\u300c()\u300d\u3001\u304b\u3064\u300cAND\u300d\u3001\u307e\u305f\u306f\u300cOR\u300d\u304c\u4f7f\u3048\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u5024\u306e\u6761\u4ef6\u5f0f\u306f\n\u6f14\u7b97\u5b50\u3068\u3057\u3066\u3001\u7b49\u3057\u3044\u300c=\u300d\u3001\u672a\u6e80\u300c<\u300d\u3001\u4ee5\u4e0b\u300c<=\u300d\u3001\u3088\u308a\u5927\u304d\u3044\u300c>\u300d\u3001\u4ee5\u4e0a\u300c>=\u300d\u3001\u7b49\u3057\u304f\u306a\u3044\u300c<>\u300d\n\u304c\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u300cIS NOT NULL\u300d\u300cIS NULL\u300d\u300cLIKE\u300d\u3082\u5229\u7528\u51fa\u6765\u307e\u3059\u3002\n\n> __\u30c9\u30e9\u30a4\u30d6C\u3068D\u306e\u60c5\u5831__\n> SELECT * FROM Win32_LogicalDisk WHERE DeviceID = 'C:' OR DeviceID = 'D:'\n> \n> __\u30c9\u30e9\u30a4\u30d6C\u3068D\u3067\u7a7a\u304d\u5bb9\u91cf\u304c\uff11G\u672a\u6e80\u306e\u60c5\u5831__\n> SELECT * FROM Win32_LogicalDisk WHERE (DeviceID = 'C:' OR DeviceID = 'D:') AND FreeSpace < 1048576\n>\n> __SQL\u95a2\u9023\u306e\u30b5\u30fc\u30d3\u30b9\u60c5\u5831__\n> SELECT * FROM Win32_Service WHERE Name LIKE '%SQL%'\n\n\n### datetime\n\nWMI\u3067\u5229\u7528\u3059\u308bdatetime\u578b\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306f\u3001`yyyymmddHHMMSS.xxxxxx\u00b1UUU`\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u305d\u3053\u3067\u3001JScript\u306eDate\u578b\u304b\u3089\u3001datetime\u578b\u306e\u751f\u6210\u3001datetime\u578b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u51fa\u529b\u306e\uff12\u30e1\u30bd\u30c3\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n`UUU`\u306e\u00b1\u304c\u901a\u5e38\u3068\u306f\u9006\u306b\u8a2d\u5b9a\u3059\u308b\u3088\u3046\u3067\u3001\u308f\u304b\u308a\u3065\u3089\u304f\u306a\u308a\u305d\u3046\u306a\u306e\u3067UTC\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```js\nfunction wmiDate(date) {\n    var datetime = null;\n    if (date && date instanceof Date) {\n        // \u300cSWbemDateTime\u300d\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u751f\u6210\n        datetime = new ActiveXObject(\"WbemScripting.SWbemDateTime\");\n        datetime.Year = date.getUTCFullYear();                     // \u5e74\n        datetime.Month = date.getUTCMonth() + 1;                   // \u6708\n        datetime.Day = date.getUTCDate();                          // \u65e5\n        datetime.Hours = date.getUTCHours();                       // \u6642\n        datetime.Minutes = date.getUTCMinutes();                   // \u5206\n        datetime.Seconds = date.getUTCSeconds();                   // \u79d2\n        datetime.Microseconds = date.getUTCMilliseconds() * 1000;  // \u30df\u30ea\u79d2\n    }\n    return datetime;\n}\n\nfunction wmiDateFormat(date) {\n    var ret = null;\n    if (date && date instanceof Date) {\n        ret = date.getUTCFullYear()                         // \u5e74\n            + (\"0\" + (date.getUTCMonth() + 1)).slice(-2)    // \u6708\n            + (\"0\" + date.getUTCDate()).slice(-2)           // \u65e5\n            + (\"0\" + date.getUTCHours()).slice(-2)          // \u6642\n            + (\"0\" + date.getUTCMinutes()).slice(-2)        // \u5206\n            + (\"0\" + date.getUTCSeconds()).slice(-2) + \".\"  // \u79d2\n            + (\"00\" + date.getUTCMilliseconds()).slice(-3)  // \u30df\u30ea\u79d2\n            + \"000+000\";                                    // \u30ca\u30ce\u79d2\uff0bUTC\n    }\n    return ret;\n}\n```\n\n\u3053\u308c\u3092\u5229\u7528\u3059\u308b\u3068\u3001\u672c\u65e50\u6642\u4ee5\u964d\u306e\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\u306a\u3069\u304c\u51fa\u6765\u307e\u3059\u3002\n\n```js\nvar now = new Date();\nvar date = new Date(now.getYear(), now.getMonth(), now.getDate(), 0, 0, 0, 0);\nvar wmidate = wmiDateFormat(date);\n// var wmidate = wmiDate(date);\nvar query = \"SELECT Category,EventCode,Message,TimeWritten FROM Win32_NTLogEvent WHERE TimeWritten >= '\" + wmidate + \"'\";\nvar props = wmiProps(query);\nvar csv = props2csv(props);\nWScript.Echo(csv);\n```\n\n\u4e00\u5fdc\u3001WMI\u306edatetime\u578b\u304b\u3089JScript\u306eDate\u578b\u3078\u623b\u3059\u30e1\u30bd\u30c3\u30c9\u3082\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n```js\nfunction wmiDate2date(datetime) {\n    var date = null;\n    try {\n        // \u5909\u63db\n        date = new Date(Date.parse(datetime.GetVarDate()));\n    } catch (e) {\n        // \u30a8\u30e9\u30fc\u306e\u5834\u5408\n        date = null;\n        // throw e;\n    }\n    return date;\n}\n```\n", "tags": ["JScript", "WMI"]}