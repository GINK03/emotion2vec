{"context": " More than 1 year has passed since last update.cap [env] deploy \u3057\u305f\u6642\u306bmkdir\u3067permission denied\u306b\u906d\u9047\u3057\u305f\u3002\n\u691c\u7d22\u3059\u308b\u3068\u3059\u3050\u51fa\u3066\u304f\u308b\u8a71\u306a\u306e\u3067\u3001\u3042\u308b\u3042\u308b\u306a\u3093\u3060\u308d\u3046\u3051\u3069\u30e1\u30e2\u3057\u3066\u304a\u304f\u3002\n\u554f\u984c\u306e\u30b3\u30fc\u30c9\u306f\u3053\u306e\u30bf\u30b9\u30af\u4ee5\u964d\u306edeploy:check\u95a2\u4fc2\n\ncapistrano-3.2.1/lib/capistrano/tasks/deploy.rake\n 43   namespace :check do\n 44     desc 'Check shared and release directories exist'\n 45     task :directories do\n 46       on release_roles :all do\n 47         execute :mkdir, '-pv', shared_path, releases_path\n 48       end\n 49     end\n\n\nshared_path\u3068\u304breleases_path\u306e\u5834\u6240\u306b\u6a29\u9650\u304c\u306a\u3044\u3068\u6012\u3089\u308c\u308b\u3002\n\u516c\u5f0f\u3068\u304b\u3053\u306e\u8fba\u3092\u898b\u308b\u3068\u3001sudo\u3092\u4f7f\u3046\u65b9\u6cd5\u304c\u7d39\u4ecb\u3055\u308c\u3066\u305f\u306e\u3067\u771f\u4f3c\u3057\u3066\u307f\u305f\u3002\n\u4eca\u56de\u306f\u3042\u304f\u307e\u3067cap [env] deploy\u3092\u4f7f\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u3001deploy:check:directories\u3092orverwrite\u3059\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\ndeploy.rb\nnamespace :deploy do\n  Rake::Task[\"deploy:check:directories\"].clear\n\n  namespace :check do\n    desc '(overwrite) Check shared and release directories exist'\n    task :directories do\n      on release_roles :all do\n        execute :sudo, :mkdir, '-pv', shared_path, releases_path\n        execute :sudo, :chown, '-R', \"#{fetch(:user)}:#{fetch(:group)}\", deploy_to\n      end\n    end\n  end\n\n\n(\u305f\u3076\u3093)\u30df\u30bd\u306fdeploy:check:directories\u3092\u4e00\u65e6\u6d88\u3057\u3066\u304b\u3089\u5b9a\u7fa9\u3057\u3066\u308b\u3068\u3053\u308d\u3002\n\u305d\u308c\u3068\u3001mkdir\u306e\u5f8c\u306bchown\u3067deploy_to\u306e\u6240\u6709\u8005\u3092\u5909\u3048\u3066\u308b\u3068\u3053\u308d\u3002\ndeploy:check:directories\u306f\u4e00\u65e6\u6d88\u3055\u306a\u3044\u3068\u3001overwrite\u3057\u3066\u3082\u53e4\u3044\u65b9\u306e\u30bf\u30b9\u30af\u304c\u547c\u3070\u308c\u3066\u89e3\u6c7a\u3057\u306a\u304b\u3063\u305f\u3002\nchown\u3057\u3066\u308b\u306e\u306f\u3001deploy:check:directories\u4ee5\u964d\u306e\u30bf\u30b9\u30af\u3067\u3082mkdir\u3057\u3066\u308b\u306e\u3067\u3001\u4e38\u3054\u3068\u6240\u6709\u8005\u3092\u5909\u3048\u3066\u3001\u4ee5\u964d\u306e\u51e6\u7406\u3067\u306fsudo\u4e0d\u8981\u306b\u3057\u305f\u304b\u3063\u305f\u305f\u3081\u3002\ncap [env] deploy \u3057\u305f\u6642\u306bmkdir\u3067permission denied\u306b\u906d\u9047\u3057\u305f\u3002\n\u691c\u7d22\u3059\u308b\u3068\u3059\u3050\u51fa\u3066\u304f\u308b\u8a71\u306a\u306e\u3067\u3001\u3042\u308b\u3042\u308b\u306a\u3093\u3060\u308d\u3046\u3051\u3069\u30e1\u30e2\u3057\u3066\u304a\u304f\u3002\n\n\u554f\u984c\u306e\u30b3\u30fc\u30c9\u306f\u3053\u306e\u30bf\u30b9\u30af\u4ee5\u964d\u306edeploy:check\u95a2\u4fc2\n\n```capistrano-3.2.1/lib/capistrano/tasks/deploy.rake\n 43   namespace :check do\n 44     desc 'Check shared and release directories exist'\n 45     task :directories do\n 46       on release_roles :all do\n 47         execute :mkdir, '-pv', shared_path, releases_path\n 48       end\n 49     end\n```\n\nshared_path\u3068\u304breleases_path\u306e\u5834\u6240\u306b\u6a29\u9650\u304c\u306a\u3044\u3068\u6012\u3089\u308c\u308b\u3002\n[\u516c\u5f0f](http://capistranorb.com/documentation/getting-started/authentication-and-authorisation/)\u3068\u304b[\u3053\u306e\u8fba](http://stackoverflow.com/questions/19948809/capistrano-3-sudo-task)\u3092\u898b\u308b\u3068\u3001sudo\u3092\u4f7f\u3046\u65b9\u6cd5\u304c\u7d39\u4ecb\u3055\u308c\u3066\u305f\u306e\u3067\u771f\u4f3c\u3057\u3066\u307f\u305f\u3002\n\u4eca\u56de\u306f\u3042\u304f\u307e\u3067cap [env] deploy\u3092\u4f7f\u3044\u305f\u304b\u3063\u305f\u306e\u3067\u3001deploy:check:directories\u3092orverwrite\u3059\u308b\u3053\u3068\u306b\u3057\u305f\u3002\n\n```deploy.rb\nnamespace :deploy do\n  Rake::Task[\"deploy:check:directories\"].clear\n\n  namespace :check do\n    desc '(overwrite) Check shared and release directories exist'\n    task :directories do\n      on release_roles :all do\n        execute :sudo, :mkdir, '-pv', shared_path, releases_path\n        execute :sudo, :chown, '-R', \"#{fetch(:user)}:#{fetch(:group)}\", deploy_to\n      end\n    end\n  end\n```\n\n(\u305f\u3076\u3093)\u30df\u30bd\u306fdeploy:check:directories\u3092\u4e00\u65e6\u6d88\u3057\u3066\u304b\u3089\u5b9a\u7fa9\u3057\u3066\u308b\u3068\u3053\u308d\u3002\n\u305d\u308c\u3068\u3001mkdir\u306e\u5f8c\u306bchown\u3067deploy_to\u306e\u6240\u6709\u8005\u3092\u5909\u3048\u3066\u308b\u3068\u3053\u308d\u3002\ndeploy:check:directories\u306f\u4e00\u65e6\u6d88\u3055\u306a\u3044\u3068\u3001overwrite\u3057\u3066\u3082\u53e4\u3044\u65b9\u306e\u30bf\u30b9\u30af\u304c\u547c\u3070\u308c\u3066\u89e3\u6c7a\u3057\u306a\u304b\u3063\u305f\u3002\nchown\u3057\u3066\u308b\u306e\u306f\u3001deploy:check:directories\u4ee5\u964d\u306e\u30bf\u30b9\u30af\u3067\u3082mkdir\u3057\u3066\u308b\u306e\u3067\u3001\u4e38\u3054\u3068\u6240\u6709\u8005\u3092\u5909\u3048\u3066\u3001\u4ee5\u964d\u306e\u51e6\u7406\u3067\u306fsudo\u4e0d\u8981\u306b\u3057\u305f\u304b\u3063\u305f\u305f\u3081\u3002\n", "tags": ["capistrano3.2.1", "Ruby"]}