{"tags": ["VBA", "ExcelVBA"], "context": "\n\n\u61f8\u5ff5\uff08\u8ab0\u304b\u6559\u3048\u3066\u304f\u3060\u3055\u3044\uff09\nExcel Vba \u306b\u3066\u3001\u518d\u8d77\u3063\u3066\u4f7f\u3063\u3066\u3082\u3044\u3044\u306e\uff1f\u7b11\n\u3057\u305f\u308a\u9854\u3067\u300c32bit\u7248\u3060\u3068\u30ea\u30bd\u30fc\u30b9\u4e0d\u8db3\u306b\u306a\u308a\u3084\u3059\u3044\u300d\u3068\u304b\u4f55\u3068\u304b\u8a00\u308f\u308c\u305f\u3053\u3068\u304c\u6c57\n\nVBA\u306e\u30a8\u30e9\u30fc\u306f\u51e6\u7406\u3057\u3065\u3089\u3044\u6c57\n'\n' \u4f7f\u3044\u65b9\n' \u4ee5\u4e0b\u306e Test01 \u3092\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u5185\u306b\u8a18\u8ff0\u3001\u30a4\u30df\u30c7\u30a3\u30a8\u30a4\u30c8\u3088\u308a\u76f4\u63a5\u8d77\u52d5\u3059\u308b\u3002\n'\nPublic Sub Test01()\n    Dim wPaths$()\n    Call createFilelist(Environ(\"USERPROFILE\"), wPaths)\n    Dim i&\n    For i = LBound(wPaths) To UBound(wPaths)\n        ThisWorkbook.Sheets(\"Sheet1\").Cells(i + 1, 1) = wPaths(i)\n    Next\nEnd Sub\n\n\n'\n' \u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u4f5c\u6210\u3059\u308b\n' \nPublic Sub createFilelist(ByRef argSearchPath$, ByRef argFileList$())\n\n    Dim FSO             As Object\n    Dim wSubFolder      As Object\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    On Error GoTo End_Of_createFilelist\n    For Each wSubFolder In FSO.GetFolder(argSearchPath).SubFolders\n        Call createFilelist(wSubFolder.Path, argFileList$)\n    Next\n\n    Dim wFile           As Object\n    For Each wFile In FSO.GetFolder(argSearchPath).Files\n        Call extendArray(argFileList, wFile.Path)\n    Next\n\n    Set FSO = Nothing\nEnd_Of_createFilelist:\n    On Error GoTo 0\nEnd Sub\n\n'\n' \u914d\u5217\u9805\u76ee\u3092\u62e1\u5f35\u3057\u3001\u7b2c2\u5f15\u6570(Option)\u3092\u8ffd\u52a0\u3059\u308b\nPublic Sub extendArray(ByRef list As Variant, Optional addItem = Null)\n    Dim i&\n    On Error Resume Next\n    i = UBound(list)\n    If Err.Number = 0 Then\n        ReDim Preserve list(UBound(list) + 1)\n    Else\n        ReDim Preserve list(0)\n    End If\n    On Error GoTo 0\n    If IsNull(addItem) = False Then\n        If IsObject(addItem) = True Then\n            Set list(UBound(list)) = addItem\n        Else\n            list(UBound(list)) = addItem\n        End If\n    End If\nEnd Sub\n\n# \u61f8\u5ff5\uff08\u8ab0\u304b\u6559\u3048\u3066\u304f\u3060\u3055\u3044\uff09\nExcel Vba \u306b\u3066\u3001\u518d\u8d77\u3063\u3066\u4f7f\u3063\u3066\u3082\u3044\u3044\u306e\uff1f\u7b11\n\u3057\u305f\u308a\u9854\u3067\u300c32bit\u7248\u3060\u3068\u30ea\u30bd\u30fc\u30b9\u4e0d\u8db3\u306b\u306a\u308a\u3084\u3059\u3044\u300d\u3068\u304b\u4f55\u3068\u304b\u8a00\u308f\u308c\u305f\u3053\u3068\u304c\u6c57\n\n# VBA\u306e\u30a8\u30e9\u30fc\u306f\u51e6\u7406\u3057\u3065\u3089\u3044\u6c57\n\n\n\n```vba\n'\n' \u4f7f\u3044\u65b9\n' \u4ee5\u4e0b\u306e Test01 \u3092\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u5185\u306b\u8a18\u8ff0\u3001\u30a4\u30df\u30c7\u30a3\u30a8\u30a4\u30c8\u3088\u308a\u76f4\u63a5\u8d77\u52d5\u3059\u308b\u3002\n'\nPublic Sub Test01()\n    Dim wPaths$()\n    Call createFilelist(Environ(\"USERPROFILE\"), wPaths)\n    Dim i&\n    For i = LBound(wPaths) To UBound(wPaths)\n        ThisWorkbook.Sheets(\"Sheet1\").Cells(i + 1, 1) = wPaths(i)\n    Next\nEnd Sub\n\n\n'\n' \u30b5\u30d6\u30d5\u30a9\u30eb\u30c0\u5185\u306e\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u4f5c\u6210\u3059\u308b\n' \nPublic Sub createFilelist(ByRef argSearchPath$, ByRef argFileList$())\n\n    Dim FSO             As Object\n    Dim wSubFolder      As Object\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    On Error GoTo End_Of_createFilelist\n    For Each wSubFolder In FSO.GetFolder(argSearchPath).SubFolders\n        Call createFilelist(wSubFolder.Path, argFileList$)\n    Next\n\n    Dim wFile           As Object\n    For Each wFile In FSO.GetFolder(argSearchPath).Files\n        Call extendArray(argFileList, wFile.Path)\n    Next\n\n    Set FSO = Nothing\nEnd_Of_createFilelist:\n    On Error GoTo 0\nEnd Sub\n\n'\n' \u914d\u5217\u9805\u76ee\u3092\u62e1\u5f35\u3057\u3001\u7b2c2\u5f15\u6570(Option)\u3092\u8ffd\u52a0\u3059\u308b\nPublic Sub extendArray(ByRef list As Variant, Optional addItem = Null)\n    Dim i&\n    On Error Resume Next\n    i = UBound(list)\n    If Err.Number = 0 Then\n        ReDim Preserve list(UBound(list) + 1)\n    Else\n        ReDim Preserve list(0)\n    End If\n    On Error GoTo 0\n    If IsNull(addItem) = False Then\n        If IsObject(addItem) = True Then\n            Set list(UBound(list)) = addItem\n        Else\n            list(UBound(list)) = addItem\n        End If\n    End If\nEnd Sub\n"}