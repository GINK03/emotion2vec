{"tags": ["Node.js", "Express.js", "I18n", "ECT"], "context": "\u591a\u8a00\u8a9e\u30b5\u30a4\u30c8\u3092\u69cb\u7bc9\u3057\u305f\u3044\u3002\n\u203b\u300c\u2248\u2248\u2248\u300d\u306f\u7701\u7565\u3092\u8868\u3059\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\n$ node -v\nv6.2.1\n\n$ cat package.json\n{\n  \u2248\u2248\u2248\n  \"dependencies\": {\n    \"ect\": \"^0.5.9\",\n    \"express\": \"~4.13.1\",\n    \"i18n\": \"~0.8.2\",\n    \u2248\u2248\u2248\n  },\n  \u2248\u2248\u2248\n}\n\n\nlocales\u306e\u7528\u610f\n$ mkdir locales\n\n$ cat locales/en.json\n{\n  \"i18ntest\": {\n    \"Hello\": \"Hello world!\"\n  }\n}\n\n$ cat locales/ja.json\n{\n  \"i18ntest\": {\n    \"Hello\": \"\u7d20\u6575\u306a\u4e16\u754c\uff01\"\n  }\n}\n\n\napp.js\n\u2248\u2248\u2248\nvar ect = require('ect');\nvar i18n = require('i18n');\n\u2248\u2248\u2248\n// view engine setup\nvar ectRenderer = ect({ watch: true, root: __dirname + '/views', ext : '.ect' });\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'ect');\napp.engine('ect', ectRenderer.render);\n\u2248\u2248\u2248\n// i18n settings\ni18n.configure({\n  locales: ['ja', 'en'],\n  defaultLocale: 'ja',\n  directory: __dirname + '/locales',\n  objectNotation: true\n});\n\napp.use(i18n.init);\n\napp.use(function (req, res, next) {\n  if (req.session.locale) {\n    i18n.setLocale(req, req.session.locale);\n  }\n  next();\n});\n\u2248\u2248\u2248\n\n\n\u4f7f\u3044\u65b9\n$ cat app.js\n\u2248\u2248\u2248\nvar test = require('../routes/test');\n\u2248\u2248\u2248\napp.use('/', test);\n\u2248\u2248\u2248\n\n$ cat routes/test.js\nvar express = require('express');\nvar router = express.Router();\n\nrouter.get('/', function(req, res, next) {\n  res.render('test', {});\n}\n\nmodule.exports = router;\n\n$ cat views/test.ect\n<!DOCTYPE html>\n<html>\n        <head>\n                <meta charset=\"UTF-8\">\n                <title><%= @__(\"i18ntest.Hello\") %></title>\n        </head>\n        <body>\n                <h1><%= @__(\"i18ntest.Hello\") %></h1>\n        </body>\n</html>\n\n\n\u78ba\u8a8d\u65b9\u6cd5\n\u30d6\u30e9\u30a6\u30b6\u306e\u8a00\u8a9e\u8a2d\u5b9a\u3092\u65e5\u672c\u8a9e/\u82f1\u8a9e\u306b\u3057\u3066\u30a2\u30af\u30bb\u30b9\n\u4f8b\uff09Chrome(51.0.2704.103 (64-bit))\uff1a\u82f1\u8a9e\uff1a\n\n\n\u5fdc\u7528\u7de8\n$ cat routes/test.js\nvar express = require('express');\nvar router = express.Router();\n\nrouter.get('/', function(req, res, next) {\n  res.render('test', { message: 'Hello' });\n}\n\nmodule.exports = router;\n\n$ cat views/test.ect\n<!DOCTYPE html>\n<html>\n        <head>\n                <meta charset=\"UTF-8\">\n                <title><%= @__(\"i18ntest.Hello\") %></title>\n        </head>\n        <body>\n                <h1><%= @__(\"i18ntest.\" + @message) %></h1>\n        </body>\n</html>\n\n\u591a\u8a00\u8a9e\u30b5\u30a4\u30c8\u3092\u69cb\u7bc9\u3057\u305f\u3044\u3002\n\n\u203b\u300c\u2248\u2248\u2248\u300d\u306f\u7701\u7565\u3092\u8868\u3059\n\n# \u30d0\u30fc\u30b8\u30e7\u30f3\n\n```\n$ node -v\nv6.2.1\n```\n\n```\n$ cat package.json\n{\n  \u2248\u2248\u2248\n  \"dependencies\": {\n    \"ect\": \"^0.5.9\",\n    \"express\": \"~4.13.1\",\n    \"i18n\": \"~0.8.2\",\n    \u2248\u2248\u2248\n  },\n  \u2248\u2248\u2248\n}\n```\n\n# locales\u306e\u7528\u610f\n\n```\n$ mkdir locales\n```\n```\n$ cat locales/en.json\n{\n  \"i18ntest\": {\n    \"Hello\": \"Hello world!\"\n  }\n}\n```\n```\n$ cat locales/ja.json\n{\n  \"i18ntest\": {\n    \"Hello\": \"\u7d20\u6575\u306a\u4e16\u754c\uff01\"\n  }\n}\n```\n\n# app.js\n\n```\n\u2248\u2248\u2248\nvar ect = require('ect');\nvar i18n = require('i18n');\n\u2248\u2248\u2248\n// view engine setup\nvar ectRenderer = ect({ watch: true, root: __dirname + '/views', ext : '.ect' });\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'ect');\napp.engine('ect', ectRenderer.render);\n\u2248\u2248\u2248\n// i18n settings\ni18n.configure({\n  locales: ['ja', 'en'],\n  defaultLocale: 'ja',\n  directory: __dirname + '/locales',\n  objectNotation: true\n});\n\napp.use(i18n.init);\n\napp.use(function (req, res, next) {\n  if (req.session.locale) {\n    i18n.setLocale(req, req.session.locale);\n  }\n  next();\n});\n\u2248\u2248\u2248\n```\n\n# \u4f7f\u3044\u65b9\n\n```\n$ cat app.js\n\u2248\u2248\u2248\nvar test = require('../routes/test');\n\u2248\u2248\u2248\napp.use('/', test);\n\u2248\u2248\u2248\n```\n```\n$ cat routes/test.js\nvar express = require('express');\nvar router = express.Router();\n\nrouter.get('/', function(req, res, next) {\n  res.render('test', {});\n}\n\nmodule.exports = router;\n```\n```\n$ cat views/test.ect\n<!DOCTYPE html>\n<html>\n        <head>\n                <meta charset=\"UTF-8\">\n                <title><%= @__(\"i18ntest.Hello\") %></title>\n        </head>\n        <body>\n                <h1><%= @__(\"i18ntest.Hello\") %></h1>\n        </body>\n</html>\n```\n\n# \u78ba\u8a8d\u65b9\u6cd5\n\n\u30d6\u30e9\u30a6\u30b6\u306e\u8a00\u8a9e\u8a2d\u5b9a\u3092\u65e5\u672c\u8a9e/\u82f1\u8a9e\u306b\u3057\u3066\u30a2\u30af\u30bb\u30b9\n\u4f8b\uff09Chrome(51.0.2704.103 (64-bit))\uff1a\u82f1\u8a9e\uff1a\n<img width=\"693\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-06-22 23.06.19.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/130752/4c536202-7015-1d9c-0b6d-4b8c9d87f854.png\">\n\n# \u5fdc\u7528\u7de8\n\n```\n$ cat routes/test.js\nvar express = require('express');\nvar router = express.Router();\n\nrouter.get('/', function(req, res, next) {\n  res.render('test', { message: 'Hello' });\n}\n\nmodule.exports = router;\n```\n```\n$ cat views/test.ect\n<!DOCTYPE html>\n<html>\n        <head>\n                <meta charset=\"UTF-8\">\n                <title><%= @__(\"i18ntest.Hello\") %></title>\n        </head>\n        <body>\n                <h1><%= @__(\"i18ntest.\" + @message) %></h1>\n        </body>\n</html>\n```\n"}