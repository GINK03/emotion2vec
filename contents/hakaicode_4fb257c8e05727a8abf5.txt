{"context": " More than 1 year has passed since last update.\u3053\u306e\u8a18\u4e8b\u306f\u300cDokcer\u30b3\u30f3\u30c6\u30ca\u4e0a\u306b\u958b\u767a\u74b0\u5883\u4e00\u5f0f\u3092\u69cb\u7bc9\u3059\u308b\u300d\u306e\u4e00\u90e8\u3067\u3059\u3002\n\n\u73fe\u5728\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\n\nVPS\u306b\u30db\u30b9\u30c8\u306bUbuntu\u3092\u5165\u308c\u308b\ndns\u3092\u69cb\u7bc9\u3059\u308b\nnginx\u3092\u69cb\u7bc9\u3059\u308b\nGitBucket\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b <-\u30a4\u30de\u30b3\u30b3\nSelenium\u7528\u306eJenkins\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\nDesktop\u74b0\u5883(IntelliJ IDEA)\u3092\u69cb\u7bc9\u3059\u308b\n\n\nDockerfile\nGitBucket\u306fJava\u4ee5\u5916\u7279\u306b\u7d44\u307f\u5408\u308f\u305b\u306a\u3044\u306e\u3067\u3001Java8\u306e\u516c\u5f0f\u30a4\u30e1\u30fc\u30b8\u3067\u3082\u3044\u3044\u306e\u3067\u3059\u304c\u3001Ubuntu14.04\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n# GitBucket Dockerfile\nFROM ubuntu:14.04\nENV DEBIAN_FRONTEND noninteractive\n\n# Install.\nRUN apt-get update && apt-get -y upgrade\n && apt-get install -y build-essential software-properties-common\n && apt-get install -y byobu curl git htop man zip unzip wget\n && rm -rf /var/lib/apt/lists/*\n# Install java 8\nRUN add-apt-repository ppa:webupd8team/java -y && apt-get update\n && (echo oracle-java8-installer shared/accepted-oracle-license-v1-1 select true | /usr/bin/debconf-set-selections) && apt-get install -y oracle-java8-installer oracle-java8-set-default\n && rm -rf /var/lib/apt/lists/*\n\nENV HOME /root\nRUN locale-gen ja_JP.UTF-8\nENV LANG       ja_JP.UTF-8\nENV LC_ALL     ja_JP.UTF-8\n\n# time\nRUN cp /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n\n#user\nENV USER gitbucket\nRUN /usr/sbin/useradd $USER\nWORKDIR /home/$USER\nUSER $USER\n\njava\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u30e9\u30a4\u30bb\u30f3\u30b9\u306b\u540c\u610f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067debconf-set-selections\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\nbuild.sh\n#/bin/sh\n\n. ../../setenv.sh\nCONTAINER=gitbucket\n\ncd $DOCKER_HOME/$CONTAINER\ndocker build --force-rm -t \"lavans-$CONTAINER:latest\" .\n\n\n$ chmod 755 *.sh\n$ ./build.sh\n\n\nGitBucket\u53d6\u5f97\n\nupdate.sh\n#/bin/sh\n\nVERSION=3.1.1\n\n. ../../setenv.sh\n\nwget https://github.com/takezoe/gitbucket/releases/download/$VERSION/gitbucket.war -O gitbucket-$VERSION.war\nrm gitbucket.war\nln -s gitbucket-$VERSION.war gitbucket.war\n\n\n\n\u8d77\u52d5\u7d42\u4e86\u30b9\u30af\u30ea\u30d7\u30c8\n\nrun.sh\n#/bin/sh\n\n. ../setenv.sh\nCONTAINER=gitbucket\n\ndocker run -v  $DOCKER_DIR/$CONTAINER/:/home/$CONTAINER -u $CONTAINER -d \\\n  -e HOME=\"/home/$CONTAINER\" \\\n  --name $CONTAINER -p 8080:8080 --dns=$IP \\\n  lavans-$CONTAINER java -Xmx256m -jar $CONTAINER.war\n#--host=gitbucket.lavans.jp\n\n\nGitBucket\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306f/home/gitbucket/.gitbucket\u306b\u5165\u308b\u306e\u3067\nHOME\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30de\u30a6\u30f3\u30c8\u3057\u3066\u4f7f\u3046\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002gitbucket\u306e\u8d77\u52d5\u30aa\u30d7\u30b7\u30e7\u30f3\u306b-Xmx256m\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\nkill.sh\n#!/bin/sh\n\nCONTAINER=gitbucket\ndocker kill $CONTAINER; docker rm $CONTAINER\n\n\n\n\u3053\u306e\u8a18\u4e8b\u306f\u300c[Dokcer\u30b3\u30f3\u30c6\u30ca\u4e0a\u306b\u958b\u767a\u74b0\u5883\u4e00\u5f0f\u3092\u69cb\u7bc9\u3059\u308b](http://qiita.com/hakaicode/items/5522a5ad1c280b9cf757)\u300d\u306e\u4e00\u90e8\u3067\u3059\u3002\n\n## \u73fe\u5728\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\n\n* [VPS\u306b\u30db\u30b9\u30c8\u306bUbuntu\u3092\u5165\u308c\u308b](http://qiita.com/hakaicode/items/5522a5ad1c280b9cf757)\n* [dns\u3092\u69cb\u7bc9\u3059\u308b](http://qiita.com/hakaicode/items/478ba39055c101d6197d)\n* [nginx\u3092\u69cb\u7bc9\u3059\u308b](http://qiita.com/hakaicode/items/38cbed889a03a33cdfcf)\n* GitBucket\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b <-\u30a4\u30de\u30b3\u30b3\n* [Selenium\u7528\u306eJenkins\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b](http://qiita.com/hakaicode/items/9a4ccf9faf63a4d9d3e4)\n* [Desktop\u74b0\u5883(IntelliJ IDEA)\u3092\u69cb\u7bc9\u3059\u308b]()\n\n## Dockerfile\n\nGitBucket\u306fJava\u4ee5\u5916\u7279\u306b\u7d44\u307f\u5408\u308f\u305b\u306a\u3044\u306e\u3067\u3001Java8\u306e[\u516c\u5f0f\u30a4\u30e1\u30fc\u30b8](https://hub.docker.com/r/library/java/tags/)\u3067\u3082\u3044\u3044\u306e\u3067\u3059\u304c\u3001Ubuntu14.04\u306b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```Dockerfile\n# GitBucket Dockerfile\nFROM ubuntu:14.04\nENV DEBIAN_FRONTEND noninteractive\n\n# Install.\nRUN apt-get update && apt-get -y upgrade\n && apt-get install -y build-essential software-properties-common\n && apt-get install -y byobu curl git htop man zip unzip wget\n && rm -rf /var/lib/apt/lists/*\n# Install java 8\nRUN add-apt-repository ppa:webupd8team/java -y && apt-get update\n && (echo oracle-java8-installer shared/accepted-oracle-license-v1-1 select true | /usr/bin/debconf-set-selections) && apt-get install -y oracle-java8-installer oracle-java8-set-default\n && rm -rf /var/lib/apt/lists/*\n\nENV HOME /root\nRUN locale-gen ja_JP.UTF-8\nENV LANG       ja_JP.UTF-8\nENV LC_ALL     ja_JP.UTF-8\n\n# time\nRUN cp /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n\n#user\nENV USER gitbucket\nRUN /usr/sbin/useradd $USER\nWORKDIR /home/$USER\nUSER $USER\n```\n\njava\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u30e9\u30a4\u30bb\u30f3\u30b9\u306b\u540c\u610f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306e\u3067debconf-set-selections\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002\n\n```bash:build.sh\n#/bin/sh\n\n. ../../setenv.sh\nCONTAINER=gitbucket\n\ncd $DOCKER_HOME/$CONTAINER\ndocker build --force-rm -t \"lavans-$CONTAINER:latest\" .\n```\n\n```shell-session\n$ chmod 755 *.sh\n$ ./build.sh\n```\n\n## GitBucket\u53d6\u5f97\n\n```bash:update.sh\n#/bin/sh\n\nVERSION=3.1.1\n\n. ../../setenv.sh\n\nwget https://github.com/takezoe/gitbucket/releases/download/$VERSION/gitbucket.war -O gitbucket-$VERSION.war\nrm gitbucket.war\nln -s gitbucket-$VERSION.war gitbucket.war\n```\n\n\n## \u8d77\u52d5\u7d42\u4e86\u30b9\u30af\u30ea\u30d7\u30c8\n\n```sh:run.sh\n#/bin/sh\n\n. ../setenv.sh\nCONTAINER=gitbucket\n\ndocker run -v  $DOCKER_DIR/$CONTAINER/:/home/$CONTAINER -u $CONTAINER -d \\\n  -e HOME=\"/home/$CONTAINER\" \\\n  --name $CONTAINER -p 8080:8080 --dns=$IP \\\n  lavans-$CONTAINER java -Xmx256m -jar $CONTAINER.war\n#--host=gitbucket.lavans.jp\n```\n\nGitBucket\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306f/home/gitbucket/.gitbucket\u306b\u5165\u308b\u306e\u3067\nHOME\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u30de\u30a6\u30f3\u30c8\u3057\u3066\u4f7f\u3046\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002gitbucket\u306e\u8d77\u52d5\u30aa\u30d7\u30b7\u30e7\u30f3\u306b-Xmx256m\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n```sh:kill.sh\n#!/bin/sh\n\nCONTAINER=gitbucket\ndocker kill $CONTAINER; docker rm $CONTAINER\n```\n", "tags": ["docker", "GitBucket", "Ubuntu"]}