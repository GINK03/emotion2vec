{"context": " More than 1 year has passed since last update.iOS\u3067\u30b2\u30fc\u30e0\u958b\u767a\u3092\u3059\u308b\u305f\u3081\u306b\u3001SpriteKit\u304c\u3042\u308a\u307e\u3059\u3002\n\u3067\u3082\u3001UIKit\u7528\u3044\u3066\u30b2\u30fc\u30e0\u958b\u767a\u304c\u3067\u304d\u306a\u3044\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u305f\u3060\u3001UIKit\u306f\u30b2\u30fc\u30e0\u5c02\u7528\u3067\u306f\u306a\u3044\u306e\u3067\u3001SpriteKit\u306b\u5bfe\u3057\u3066\u51e6\u7406\u901f\u5ea6\u304c\u9045\u3044\u3001\u307e\u305f\u7269\u7406\u6f14\u7b97\u3092\u8a18\u8ff0\u3059\u308b\u306e\u304c\u5927\u5909\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u304c\u3042\u308a\u307e\u3059\u3002\n\u672c\u8a18\u4e8b\u3067\u306f\u3001SpriteKit\u3001UIKit\u305d\u308c\u305e\u308c\u3092\u7528\u3044\u3066\u540c\u3058\u52d5\u4f5c\u3092\u3059\u308b\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3057\u3001\u4e21\u8005\u3092\u6bd4\u8f03\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u753b\u9762\u4e2d\u592e\u304b\u3089\u7121\u6570\u306e\u30dc\u30fc\u30eb\u3092\u767a\u751f\u3055\u305b\u3001\u304a\u4e92\u3044\u306b\u3001\u885d\u7a81\u3055\u305b\u308b\u30b3\u30fc\u30c9\u3092\u3001\u305d\u308c\u305e\u308cSpriteKit\u3068UIKit\u3067\u8a18\u8ff0\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u307e\u305a\u3001SpriteKit\u306e\u65b9\u304b\u3089\u3002\n\nGameScene.m\n#import \"GameScene.h\"\n\n@interface GameScene () <SKPhysicsContactDelegate>\n{\n    int count;\n}\n@end\n\n@implementation GameScene\n\n-(void)didMoveToView:(SKView *)view {\n    /* Setup your scene here */\n    count = 0;\n    self.physicsBody = [SKPhysicsBody bodyWithEdgeLoopFromRect:self.frame];\n    self.physicsWorld.contactDelegate = self;\n}\n\n-(void)createBall{\n    CGFloat radius = 5;\n    float angle = (arc4random() % UINT32_MAX)*2*M_PI;\n    float speed = 60.0;\n    CGFloat velocityX = speed * cosf(angle);\n    CGFloat velocityY = speed * sinf(angle);\n\n    SKShapeNode *ball = [SKShapeNode node];\n    ball.name = @\"ball\";\n    ball.position = CGPointMake(CGRectGetMidX(self.frame), CGRectGetMidY(self.frame) );\n\n    CGMutablePathRef path = CGPathCreateMutable();\n    CGPathAddArc(path, NULL, 0, 0, radius, 0, M_PI * 2, YES);\n    ball.path = path;\n    ball.fillColor = [SKColor orangeColor];\n    ball.strokeColor = [SKColor clearColor];\n\n    CGPathRelease(path);\n\n    ball.physicsBody = [SKPhysicsBody bodyWithCircleOfRadius:radius];\n    ball.physicsBody.affectedByGravity = NO;\n    ball.physicsBody.velocity = CGVectorMake(velocityX, velocityY);\n    ball.physicsBody.restitution = 1.0f;\n    ball.physicsBody.linearDamping = 0;\n    ball.physicsBody.friction = 0;\n    ball.physicsBody.usesPreciseCollisionDetection = NO;\n    ball.physicsBody.allowsRotation = NO;\n\n    [self addChild:ball];\n}\n\n-(void)update:(CFTimeInterval)currentTime {\n    //100\u56de\u306e\u30dc\u30fc\u30eb\u304c\u51fa\u73fe\n    if (count < 100) {\n        [self createBall];\n        count++;\n    }\n}\n\n@end\n\n\n\u4e0a\u8a18\u306e\u30b7\u30fc\u30f3\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u753b\u9762\u4e2d\u592e\u304b\u3089\u30dc\u30fc\u30eb\u304c\u98db\u3073\u51fa\u3057\u3066\u3001\u304a\u4e92\u3044\u306b\u885d\u7a81\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\n\n\u4e0a\u8a18\u3067\u306f8.2fps\u3068\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u60aa\u3044\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3067\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3092\u64ae\u5f71\u3057\u305f\u305f\u3081\u3067\u3059\u3002\nOpenGL ES\u3092\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3067\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3059\u308b\u3068\u30d1\u30d5\u30a9\u30fc\u30de\u30b9\u30f3\u304c\u975e\u5e38\u306b\u60aa\u304f\u306a\u308b\u306e\u3067\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u691c\u8a3c\u306f\u5fc5\u305a\u5b9f\u6a5f\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u6b21\u306b\u3001UIKit\u306e\u65b9\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\nUIView\u3092\u7d99\u627f\u3057\u305f\u3001Ball\u30af\u30e9\u30b9\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u885d\u7a81\u306e\u30ed\u30b8\u30c3\u30af\u306f\u3001\u81ea\u5206\u3067\u8a18\u8ff0\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\nBall.h\n#import <Foundation/Foundation.h>\n#import <UIKit/UIKit.h>\n\n@interface Ball : UIView\n\n@property(nonatomic) CGVector speed;\n\n@end\n\n\n\nViewController.m\n#import \"ViewController.h\"\n#import \"Ball.h\"\n\n@interface ViewController ()\n{\n    int count;\n    NSTimer *sTimer;\n    NSMutableArray *ballArray;\n    IBOutlet UILabel *countLabel;\n}\n\n@end\n\n@implementation ViewController\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n    // Do any additional setup after loading the view, typically from a nib.\n    count = 0;\n    sTimer = [NSTimer scheduledTimerWithTimeInterval:1.0/60.0\n                                              target:self\n                                            selector:@selector(doAction)\n                                            userInfo:nil\n                                             repeats:YES];\n    ballArray = [NSMutableArray new];\n}\n\n//\u30bf\u30a4\u30de\u30fc\u304b\u3089\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n-(void)doAction{\n\n    //100\u500b\u306e\u30dc\u30fc\u30eb\u304c\u767a\u751f\n    if (count < 100) {\n        [self createBall];\n        count++;\n    }\n\n    [self moveBall];\n    [self collisionInArray:ballArray];\n}\n\n//\u30dc\u30fc\u30eb\u3092\u751f\u6210\n-(void)createBall{\n    Ball *ball = [Ball new];\n    ball.frame = CGRectMake(0, 0, 10, 10);\n    ball.center = self.view.center;\n    ball.backgroundColor = [UIColor orangeColor];\n    ball.layer.cornerRadius = ball.frame.size.width/2.0;\n    float speed = 1.0;\n    float angle = (arc4random() % UINT32_MAX)*2*M_PI;\n    float speedX = speed * cosf(angle);\n    float speedY = speed * sinf(angle);\n    ball.speed = CGVectorMake(speedX, speedY);\n    [self.view addSubview:ball];\n    [ballArray addObject:ball];\n\n    //\u30dc\u30fc\u30eb\u3092\u30ab\u30a6\u30f3\u30c8\n    countLabel.text = [NSString stringWithFormat:@\"%d\", [countLabel.text intValue]+1];\n}\n\n//\u30dc\u30fc\u30eb\u3092\u52d5\u304b\u3059\n-(void)moveBall{\n    [ballArray enumerateObjectsUsingBlock:^(Ball *ball, NSUInteger idx, BOOL *stop) {\n\n        //\u30dc\u30fc\u30eb\u306e\u79fb\u52d5\n        ball.center = CGPointMake(ball.center.x+ball.speed.dx,\n                                  ball.center.y+ball.speed.dy);\n\n        //\u7aef\u3067\u53cd\u5c04\n        if (ball.center.x<0) {\n            ball.speed = CGVectorMake(fabsf(ball.speed.dx), ball.speed.dy);\n        }\n        if (ball.center.x>self.view.frame.size.width){\n            ball.speed = CGVectorMake(-fabsf(ball.speed.dx), ball.speed.dy);\n        }\n        if (ball.center.y<0){\n            ball.speed = CGVectorMake(ball.speed.dx, fabsf(ball.speed.dy));\n        }\n        if (ball.center.y>self.view.frame.size.height){\n            ball.speed = CGVectorMake(ball.speed.dx, -fabsf(ball.speed.dy));\n        }\n    }];\n}\n\n//\u30dc\u30fc\u30eb\u306e\u885d\u7a81\n-(void)collisionInArray:(NSArray *)viewArray{\n    [ballArray enumerateObjectsUsingBlock:^(Ball *view1, NSUInteger i, BOOL *stop1) {\n        for (NSUInteger j=i+1; j<[ballArray count]; j++) {\n            Ball *view2 = ballArray[j];\n\n            //\u5186\u5f62\u306e\u5224\u5b9a\u306f\u9ad8\u30b3\u30b9\u30c8\u306a\u305f\u3081\u3001\u6700\u521d\u306b\u77e9\u5f62\u3067\u5224\u5b9a\n            float hitRadiusX = (view1.frame.size.width+view2.frame.size.width)/2.0;\n            float hitRadiusY = (view1.frame.size.height+view2.frame.size.height)/2.0;\n            float hitRadius = (hitRadiusX+hitRadiusY)/2.0;\n\n            float distanceY =   view2.center.y - view1.center.y;\n            if (fabsf(distanceY) > hitRadius) {\n                continue;\n            }\n\n            float distanceX =  view2.center.x - view1.center.x;\n            if (fabsf(distanceX) > hitRadius) {\n                continue;\n            }\n\n            //\u5186\u5f62\u3067\u885d\u7a81\u5224\u5b9a\n            float distance = sqrtf(distanceX*distanceX+ distanceY*distanceY);\n            if (distance < hitRadius) {\n\n                //\u885d\u7a81\u5f8c\u306e\u30b9\u30d4\u30fc\u30c9\u8a08\u7b97\n                CGVector unitVector;\n                unitVector.dx = distanceX/distance;\n                unitVector.dy = distanceY/distance;\n                double e = 1.0;\n                double speedFrom = view1.speed.dx*unitVector.dx+view1.speed.dy*unitVector.dy;\n                double speedTo = view2.speed.dx*unitVector.dx+view2.speed.dy*unitVector.dy;\n                double aN = 0.5*(1+e)*(speedTo-speedFrom);\n                double dSx1 = aN*unitVector.dx;\n                double dSy1 = aN*unitVector.dy;\n                double dSx2 = -aN*unitVector.dx;\n                double dSy2 = -aN*unitVector.dy;\n                view1.speed = CGVectorMake(view1.speed.dx+dSx1, view1.speed.dy+dSy1);\n                view2.speed = CGVectorMake(view2.speed.dx+dSx2, view2.speed.dy+dSy2);\n\n                //2\u3064\u306e\u30dc\u30fc\u30eb\u306e\u91cd\u306a\u308a\u306e\u89e3\u6d88\n                float overlap = hitRadius-distance;\n                float radius1 = (view1.frame.size.width+view1.frame.size.height)/2.0;\n                float radius2 = (view2.frame.size.width+view2.frame.size.height)/2.0;\n                float totalMass = radius1*radius1 + radius2*radius2;\n                float move1 = overlap/totalMass*radius2*radius2;\n                float move2 = overlap/totalMass*radius1*radius1;\n                float cosign = distanceX/distance;\n                float sign = distanceY/distance;\n                float dx1 = -move1*cosign;\n                float dy1 = -move1*sign;\n                float dx2 = move2*cosign;\n                float dy2 = move2*sign;\n                view1.center = CGPointMake(view1.center.x+dx1, view1.center.y+dy1);\n                view2.center = CGPointMake(view2.center.x+dx2, view2.center.y+dy2);\n            }\n        }\n    }];\n}\n\n- (void)didReceiveMemoryWarning {\n    [super didReceiveMemoryWarning];\n    // Dispose of any resources that can be recreated.\n}\n\n@end\n\n\n\u4ee5\u4e0b\u306f\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3067\u3059\u3002SpriteKit\u306e\u969b\u3068\u540c\u69d8\u306b\u3001\u30dc\u30fc\u30eb\u304c\u885d\u7a81\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\n\nSpriteKit\u306e\u969b\u3068\u9006\u306b\u3001\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3060\u3068\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u826f\u304f\u306a\u308a\u3059\u304e\u308b\u306e\u3067\u3001UIKit\u306e\u5834\u5408\u3082\u5b9f\u6a5f\u3067\u306e\u691c\u8a3c\u304c\u5927\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\n\u4e21\u8005\u3067\u3001\u30dc\u30fc\u30eb\u306e\u6570\u3092\u5909\u3048\u3066\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u6bd4\u8f03\u3057\u305f\u7d50\u679c\u304c\u4ee5\u4e0b\u3067\u3059\u3002\n\u691c\u8a3c\u306b\u306f\u624b\u5143\u306eiPhone5\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n\nSpriteKit\u306e\u65b9\u306f\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001UIKit\u306e\u65b9\u306e\u30ed\u30b8\u30c3\u30af\u3067\u306f\u5168\u3066\u306e\u30dc\u30fc\u30eb\u306e\u540c\u58eb\u306e\u7d44\u307f\u5408\u308f\u305b\u306b\u5bfe\u3057\u3066\u885d\u7a81\u5224\u5b9a\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u30dc\u30fc\u30eb\u306e\u6570\u304c\u5897\u3048\u308b\u3068\u8a08\u7b97\u91cf\u304c\u81a8\u5927\u306b\u306a\u308a\u307e\u3059\u3002\n\u3055\u3059\u304c\u306b\u30dc\u30fc\u30eb\u306e\u6570\u304c\u591a\u3044\u5834\u5408\u306e\u52d5\u4f5c\u611f\u899a\u306fSpriteKit\u306e\u65b9\u304c\u30b9\u30e0\u30fc\u30ba\u3067\u3059\u304c\u3001UIKit\u306e\u65b9\u3082CPU\u306e\u4f7f\u7528\u7387\u306a\u3069\u3067\u306f\u610f\u5916\u306b\u5065\u95d8\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001SpriteKit\u306e\u65b9\u3067\u306f\u30dc\u30fc\u30eb\u306e\u30b9\u30d4\u30fc\u30c9\u304c\u901f\u304f\u3066\u3082\u52d5\u304d\u304c\u81ea\u7136\u306b\u898b\u3048\u307e\u3057\u305f\u304c\u3001UIKit\u306e\u65b9\u3067\u306f\u30dc\u30fc\u30eb\u304c\u65e9\u3044\u3068\u30ab\u30af\u30ab\u30af\u3057\u305f\u308a\u971e\u3093\u3067\u898b\u3048\u308b\u50be\u5411\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u4ee5\u4e0a\u306b\u3088\u308a\u3001\u6fc0\u3057\u3044\u30a2\u30af\u30b7\u30e7\u30f3\u3084\u8907\u96d1\u306a\u7269\u7406\u8a08\u7b97\u304c\u5fc5\u8981\u306a\u30b2\u30fc\u30e0\u306f\u672c\u8077\u306eSpriteKit\n\u3092\u9078\u629e\u3057\u305f\u65b9\u304c\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u305d\u308c\u307b\u3069\u6fc0\u3057\u3044\u30a2\u30af\u30b7\u30e7\u30f3\u3084\u8907\u96d1\u306a\u7269\u7406\u8a08\u7b97\u304c\u5fc5\u8981\u3067\u306a\u3044\u30b2\u30fc\u30e0\u3067\u3042\u308c\u3070\u3001UIKit\u3067\u30b2\u30fc\u30e0\u3092\u4f5c\u308b\u3053\u3068\u3092\u691c\u8a0e\u3059\u308b\u306e\u3082\u30a2\u30ea\u304b\u3068\u601d\u3044\u307e\u3059\u3002\nUIKit\u3067\u30b2\u30fc\u30e0\u3092\u4f5c\u308c\u3070\u3001\u30c4\u30fc\u30eb\u306e\u30ce\u30a6\u30cf\u30a6\u3092\u305d\u306e\u307e\u307e\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u308b\u3068\u3044\u3046\u30e1\u30ea\u30c3\u30c8\u3082\u3042\u308a\u307e\u3059\u3057\u306d\u3002\n\u3069\u3046\u3084\u3089\u3001\u59a5\u5f53\u306a\u7d50\u679c\u306b\u843d\u3061\u7740\u3044\u305f\u3088\u3046\u3067\u3059\u3002\n\u3061\u306a\u307f\u306b\u3001\u4ee5\u524d\u306bUIKit\u3092\u4f5c\u3063\u3066\u5f3e\u5e55\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u4f5c\u3063\u3066\u307f\u305f\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u6d41\u77f3\u306b\u5f3e\u6570\u304c\u5897\u3048\u308b\u3068\u51e6\u7406\u843d\u3061\u3057\u307e\u3059\u304c\u3001\u7d50\u69cb\u904a\u3079\u308b\u3082\u306e\u306f\u4f5c\u308c\u308b\u3088\u3046\u3067\u3059\u3002\nhttps://itunes.apple.com/jp/app/star-gradiator-free/id806155270\n\u4eca\u56de\u306e\u30bd\u30fc\u30b9\u306f\u3001\u4ee5\u4e0b\u306b\u30a2\u30c3\u30d7\u3057\u304a\u304d\u307e\u3059\u306d\u3002\nhttps://github.com/yukinaga/CollisionPerformanceTestSpriteKit\nhttps://github.com/yukinaga/CollisionPerformanceTestUIKit\niOS\u3067\u30b2\u30fc\u30e0\u958b\u767a\u3092\u3059\u308b\u305f\u3081\u306b\u3001SpriteKit\u304c\u3042\u308a\u307e\u3059\u3002\n\u3067\u3082\u3001UIKit\u7528\u3044\u3066\u30b2\u30fc\u30e0\u958b\u767a\u304c\u3067\u304d\u306a\u3044\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u305f\u3060\u3001UIKit\u306f\u30b2\u30fc\u30e0\u5c02\u7528\u3067\u306f\u306a\u3044\u306e\u3067\u3001SpriteKit\u306b\u5bfe\u3057\u3066\u51e6\u7406\u901f\u5ea6\u304c\u9045\u3044\u3001\u307e\u305f\u7269\u7406\u6f14\u7b97\u3092\u8a18\u8ff0\u3059\u308b\u306e\u304c\u5927\u5909\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u304c\u3042\u308a\u307e\u3059\u3002\n\u672c\u8a18\u4e8b\u3067\u306f\u3001SpriteKit\u3001UIKit\u305d\u308c\u305e\u308c\u3092\u7528\u3044\u3066\u540c\u3058\u52d5\u4f5c\u3092\u3059\u308b\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3057\u3001\u4e21\u8005\u3092\u6bd4\u8f03\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3001\u753b\u9762\u4e2d\u592e\u304b\u3089\u7121\u6570\u306e\u30dc\u30fc\u30eb\u3092\u767a\u751f\u3055\u305b\u3001\u304a\u4e92\u3044\u306b\u3001\u885d\u7a81\u3055\u305b\u308b\u30b3\u30fc\u30c9\u3092\u3001\u305d\u308c\u305e\u308cSpriteKit\u3068UIKit\u3067\u8a18\u8ff0\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u307e\u305a\u3001SpriteKit\u306e\u65b9\u304b\u3089\u3002\n\n```objc:GameScene.m\n#import \"GameScene.h\"\n\n@interface GameScene () <SKPhysicsContactDelegate>\n{\n    int count;\n}\n@end\n\n@implementation GameScene\n\n-(void)didMoveToView:(SKView *)view {\n    /* Setup your scene here */\n    count = 0;\n    self.physicsBody = [SKPhysicsBody bodyWithEdgeLoopFromRect:self.frame];\n    self.physicsWorld.contactDelegate = self;\n}\n\n-(void)createBall{\n    CGFloat radius = 5;\n    float angle = (arc4random() % UINT32_MAX)*2*M_PI;\n    float speed = 60.0;\n    CGFloat velocityX = speed * cosf(angle);\n    CGFloat velocityY = speed * sinf(angle);\n\n    SKShapeNode *ball = [SKShapeNode node];\n    ball.name = @\"ball\";\n    ball.position = CGPointMake(CGRectGetMidX(self.frame), CGRectGetMidY(self.frame) );\n    \n    CGMutablePathRef path = CGPathCreateMutable();\n    CGPathAddArc(path, NULL, 0, 0, radius, 0, M_PI * 2, YES);\n    ball.path = path;\n    ball.fillColor = [SKColor orangeColor];\n    ball.strokeColor = [SKColor clearColor];\n    \n    CGPathRelease(path);\n    \n    ball.physicsBody = [SKPhysicsBody bodyWithCircleOfRadius:radius];\n    ball.physicsBody.affectedByGravity = NO;\n    ball.physicsBody.velocity = CGVectorMake(velocityX, velocityY);\n    ball.physicsBody.restitution = 1.0f;\n    ball.physicsBody.linearDamping = 0;\n    ball.physicsBody.friction = 0;\n    ball.physicsBody.usesPreciseCollisionDetection = NO;\n    ball.physicsBody.allowsRotation = NO;\n    \n    [self addChild:ball];\n}\n\n-(void)update:(CFTimeInterval)currentTime {\n    //100\u56de\u306e\u30dc\u30fc\u30eb\u304c\u51fa\u73fe\n    if (count < 100) {\n        [self createBall];\n        count++;\n    }\n}\n\n@end\n```\n\u4e0a\u8a18\u306e\u30b7\u30fc\u30f3\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u753b\u9762\u4e2d\u592e\u304b\u3089\u30dc\u30fc\u30eb\u304c\u98db\u3073\u51fa\u3057\u3066\u3001\u304a\u4e92\u3044\u306b\u885d\u7a81\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\n![iOS Simulator Screen Shot 2015.01.06 21.00.43.png](https://qiita-image-store.s3.amazonaws.com/0/35297/53009c60-ed81-5c4e-10e7-c00433aebff1.png)\n\u4e0a\u8a18\u3067\u306f8.2fps\u3068\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u60aa\u3044\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3067\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3092\u64ae\u5f71\u3057\u305f\u305f\u3081\u3067\u3059\u3002\nOpenGL ES\u3092\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3067\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3059\u308b\u3068\u30d1\u30d5\u30a9\u30fc\u30de\u30b9\u30f3\u304c\u975e\u5e38\u306b\u60aa\u304f\u306a\u308b\u306e\u3067\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u691c\u8a3c\u306f\u5fc5\u305a\u5b9f\u6a5f\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u6b21\u306b\u3001UIKit\u306e\u65b9\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\nUIView\u3092\u7d99\u627f\u3057\u305f\u3001Ball\u30af\u30e9\u30b9\u3092\u4f5c\u308a\u307e\u3059\u3002\n\u885d\u7a81\u306e\u30ed\u30b8\u30c3\u30af\u306f\u3001\u81ea\u5206\u3067\u8a18\u8ff0\u3057\u306a\u3051\u308c\u3070\u3044\u3051\u307e\u305b\u3093\u3002\n\n```objc:Ball.h\n#import <Foundation/Foundation.h>\n#import <UIKit/UIKit.h>\n\n@interface Ball : UIView\n\n@property(nonatomic) CGVector speed;\n\n@end\n```\n\n```objc:ViewController.m\n#import \"ViewController.h\"\n#import \"Ball.h\"\n\n@interface ViewController ()\n{\n    int count;\n    NSTimer *sTimer;\n    NSMutableArray *ballArray;\n    IBOutlet UILabel *countLabel;\n}\n\n@end\n\n@implementation ViewController\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n    // Do any additional setup after loading the view, typically from a nib.\n    count = 0;\n    sTimer = [NSTimer scheduledTimerWithTimeInterval:1.0/60.0\n                                              target:self\n                                            selector:@selector(doAction)\n                                            userInfo:nil\n                                             repeats:YES];\n    ballArray = [NSMutableArray new];\n}\n\n//\u30bf\u30a4\u30de\u30fc\u304b\u3089\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n-(void)doAction{\n    \n    //100\u500b\u306e\u30dc\u30fc\u30eb\u304c\u767a\u751f\n    if (count < 100) {\n        [self createBall];\n        count++;\n    }\n    \n    [self moveBall];\n    [self collisionInArray:ballArray];\n}\n\n//\u30dc\u30fc\u30eb\u3092\u751f\u6210\n-(void)createBall{\n    Ball *ball = [Ball new];\n    ball.frame = CGRectMake(0, 0, 10, 10);\n    ball.center = self.view.center;\n    ball.backgroundColor = [UIColor orangeColor];\n    ball.layer.cornerRadius = ball.frame.size.width/2.0;\n    float speed = 1.0;\n    float angle = (arc4random() % UINT32_MAX)*2*M_PI;\n    float speedX = speed * cosf(angle);\n    float speedY = speed * sinf(angle);\n    ball.speed = CGVectorMake(speedX, speedY);\n    [self.view addSubview:ball];\n    [ballArray addObject:ball];\n    \n    //\u30dc\u30fc\u30eb\u3092\u30ab\u30a6\u30f3\u30c8\n    countLabel.text = [NSString stringWithFormat:@\"%d\", [countLabel.text intValue]+1];\n}\n\n//\u30dc\u30fc\u30eb\u3092\u52d5\u304b\u3059\n-(void)moveBall{\n    [ballArray enumerateObjectsUsingBlock:^(Ball *ball, NSUInteger idx, BOOL *stop) {\n        \n        //\u30dc\u30fc\u30eb\u306e\u79fb\u52d5\n        ball.center = CGPointMake(ball.center.x+ball.speed.dx,\n                                  ball.center.y+ball.speed.dy);\n        \n        //\u7aef\u3067\u53cd\u5c04\n        if (ball.center.x<0) {\n            ball.speed = CGVectorMake(fabsf(ball.speed.dx), ball.speed.dy);\n        }\n        if (ball.center.x>self.view.frame.size.width){\n            ball.speed = CGVectorMake(-fabsf(ball.speed.dx), ball.speed.dy);\n        }\n        if (ball.center.y<0){\n            ball.speed = CGVectorMake(ball.speed.dx, fabsf(ball.speed.dy));\n        }\n        if (ball.center.y>self.view.frame.size.height){\n            ball.speed = CGVectorMake(ball.speed.dx, -fabsf(ball.speed.dy));\n        }\n    }];\n}\n\n//\u30dc\u30fc\u30eb\u306e\u885d\u7a81\n-(void)collisionInArray:(NSArray *)viewArray{\n    [ballArray enumerateObjectsUsingBlock:^(Ball *view1, NSUInteger i, BOOL *stop1) {\n        for (NSUInteger j=i+1; j<[ballArray count]; j++) {\n            Ball *view2 = ballArray[j];\n            \n            //\u5186\u5f62\u306e\u5224\u5b9a\u306f\u9ad8\u30b3\u30b9\u30c8\u306a\u305f\u3081\u3001\u6700\u521d\u306b\u77e9\u5f62\u3067\u5224\u5b9a\n            float hitRadiusX = (view1.frame.size.width+view2.frame.size.width)/2.0;\n            float hitRadiusY = (view1.frame.size.height+view2.frame.size.height)/2.0;\n            float hitRadius = (hitRadiusX+hitRadiusY)/2.0;\n            \n            float distanceY =   view2.center.y - view1.center.y;\n            if (fabsf(distanceY) > hitRadius) {\n                continue;\n            }\n            \n            float distanceX =  view2.center.x - view1.center.x;\n            if (fabsf(distanceX) > hitRadius) {\n                continue;\n            }\n            \n            //\u5186\u5f62\u3067\u885d\u7a81\u5224\u5b9a\n            float distance = sqrtf(distanceX*distanceX+ distanceY*distanceY);\n            if (distance < hitRadius) {\n                \n                //\u885d\u7a81\u5f8c\u306e\u30b9\u30d4\u30fc\u30c9\u8a08\u7b97\n                CGVector unitVector;\n                unitVector.dx = distanceX/distance;\n                unitVector.dy = distanceY/distance;\n                double e = 1.0;\n                double speedFrom = view1.speed.dx*unitVector.dx+view1.speed.dy*unitVector.dy;\n                double speedTo = view2.speed.dx*unitVector.dx+view2.speed.dy*unitVector.dy;\n                double aN = 0.5*(1+e)*(speedTo-speedFrom);\n                double dSx1 = aN*unitVector.dx;\n                double dSy1 = aN*unitVector.dy;\n                double dSx2 = -aN*unitVector.dx;\n                double dSy2 = -aN*unitVector.dy;\n                view1.speed = CGVectorMake(view1.speed.dx+dSx1, view1.speed.dy+dSy1);\n                view2.speed = CGVectorMake(view2.speed.dx+dSx2, view2.speed.dy+dSy2);\n                \n                //2\u3064\u306e\u30dc\u30fc\u30eb\u306e\u91cd\u306a\u308a\u306e\u89e3\u6d88\n                float overlap = hitRadius-distance;\n                float radius1 = (view1.frame.size.width+view1.frame.size.height)/2.0;\n                float radius2 = (view2.frame.size.width+view2.frame.size.height)/2.0;\n                float totalMass = radius1*radius1 + radius2*radius2;\n                float move1 = overlap/totalMass*radius2*radius2;\n                float move2 = overlap/totalMass*radius1*radius1;\n                float cosign = distanceX/distance;\n                float sign = distanceY/distance;\n                float dx1 = -move1*cosign;\n                float dy1 = -move1*sign;\n                float dx2 = move2*cosign;\n                float dy2 = move2*sign;\n                view1.center = CGPointMake(view1.center.x+dx1, view1.center.y+dy1);\n                view2.center = CGPointMake(view2.center.x+dx2, view2.center.y+dy2);\n            }\n        }\n    }];\n}\n\n- (void)didReceiveMemoryWarning {\n    [super didReceiveMemoryWarning];\n    // Dispose of any resources that can be recreated.\n}\n\n@end\n```\n\n\u4ee5\u4e0b\u306f\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u3067\u3059\u3002SpriteKit\u306e\u969b\u3068\u540c\u69d8\u306b\u3001\u30dc\u30fc\u30eb\u304c\u885d\u7a81\u3092\u7e70\u308a\u8fd4\u3057\u307e\u3059\u3002\n![iOS Simulator Screen Shot 2015.01.06 21.19.18.png](https://qiita-image-store.s3.amazonaws.com/0/35297/10dd3eeb-976a-40bc-f3de-d189f469242a.png)\nSpriteKit\u306e\u969b\u3068\u9006\u306b\u3001\u30b7\u30df\u30e5\u30ec\u30fc\u30bf\u3060\u3068\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u826f\u304f\u306a\u308a\u3059\u304e\u308b\u306e\u3067\u3001UIKit\u306e\u5834\u5408\u3082\u5b9f\u6a5f\u3067\u306e\u691c\u8a3c\u304c\u5927\u4e8b\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u4e21\u8005\u3067\u3001\u30dc\u30fc\u30eb\u306e\u6570\u3092\u5909\u3048\u3066\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u6bd4\u8f03\u3057\u305f\u7d50\u679c\u304c\u4ee5\u4e0b\u3067\u3059\u3002\n\u691c\u8a3c\u306b\u306f\u624b\u5143\u306eiPhone5\u3092\u4f7f\u3044\u307e\u3057\u305f\u3002\n![image](https://qiita-image-store.s3.amazonaws.com/0/35297/6bfdd2fb-acf0-32f9-b631-df15ba481b0f.png)\n\nSpriteKit\u306e\u65b9\u306f\u308f\u304b\u308a\u307e\u305b\u3093\u304c\u3001UIKit\u306e\u65b9\u306e\u30ed\u30b8\u30c3\u30af\u3067\u306f\u5168\u3066\u306e\u30dc\u30fc\u30eb\u306e\u540c\u58eb\u306e\u7d44\u307f\u5408\u308f\u305b\u306b\u5bfe\u3057\u3066\u885d\u7a81\u5224\u5b9a\u3092\u884c\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u30dc\u30fc\u30eb\u306e\u6570\u304c\u5897\u3048\u308b\u3068\u8a08\u7b97\u91cf\u304c\u81a8\u5927\u306b\u306a\u308a\u307e\u3059\u3002\n\u3055\u3059\u304c\u306b\u30dc\u30fc\u30eb\u306e\u6570\u304c\u591a\u3044\u5834\u5408\u306e\u52d5\u4f5c\u611f\u899a\u306fSpriteKit\u306e\u65b9\u304c\u30b9\u30e0\u30fc\u30ba\u3067\u3059\u304c\u3001UIKit\u306e\u65b9\u3082CPU\u306e\u4f7f\u7528\u7387\u306a\u3069\u3067\u306f\u610f\u5916\u306b\u5065\u95d8\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001SpriteKit\u306e\u65b9\u3067\u306f\u30dc\u30fc\u30eb\u306e\u30b9\u30d4\u30fc\u30c9\u304c\u901f\u304f\u3066\u3082\u52d5\u304d\u304c\u81ea\u7136\u306b\u898b\u3048\u307e\u3057\u305f\u304c\u3001UIKit\u306e\u65b9\u3067\u306f\u30dc\u30fc\u30eb\u304c\u65e9\u3044\u3068\u30ab\u30af\u30ab\u30af\u3057\u305f\u308a\u971e\u3093\u3067\u898b\u3048\u308b\u50be\u5411\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n\u4ee5\u4e0a\u306b\u3088\u308a\u3001\u6fc0\u3057\u3044\u30a2\u30af\u30b7\u30e7\u30f3\u3084\u8907\u96d1\u306a\u7269\u7406\u8a08\u7b97\u304c\u5fc5\u8981\u306a\u30b2\u30fc\u30e0\u306f\u672c\u8077\u306eSpriteKit\n\u3092\u9078\u629e\u3057\u305f\u65b9\u304c\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u305d\u308c\u307b\u3069\u6fc0\u3057\u3044\u30a2\u30af\u30b7\u30e7\u30f3\u3084\u8907\u96d1\u306a\u7269\u7406\u8a08\u7b97\u304c\u5fc5\u8981\u3067\u306a\u3044\u30b2\u30fc\u30e0\u3067\u3042\u308c\u3070\u3001UIKit\u3067\u30b2\u30fc\u30e0\u3092\u4f5c\u308b\u3053\u3068\u3092\u691c\u8a0e\u3059\u308b\u306e\u3082\u30a2\u30ea\u304b\u3068\u601d\u3044\u307e\u3059\u3002\nUIKit\u3067\u30b2\u30fc\u30e0\u3092\u4f5c\u308c\u3070\u3001\u30c4\u30fc\u30eb\u306e\u30ce\u30a6\u30cf\u30a6\u3092\u305d\u306e\u307e\u307e\u4f7f\u3046\u3053\u3068\u3082\u3067\u304d\u308b\u3068\u3044\u3046\u30e1\u30ea\u30c3\u30c8\u3082\u3042\u308a\u307e\u3059\u3057\u306d\u3002\n\u3069\u3046\u3084\u3089\u3001\u59a5\u5f53\u306a\u7d50\u679c\u306b\u843d\u3061\u7740\u3044\u305f\u3088\u3046\u3067\u3059\u3002\n\n\u3061\u306a\u307f\u306b\u3001\u4ee5\u524d\u306bUIKit\u3092\u4f5c\u3063\u3066\u5f3e\u5e55\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u4f5c\u3063\u3066\u307f\u305f\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u6d41\u77f3\u306b\u5f3e\u6570\u304c\u5897\u3048\u308b\u3068\u51e6\u7406\u843d\u3061\u3057\u307e\u3059\u304c\u3001\u7d50\u69cb\u904a\u3079\u308b\u3082\u306e\u306f\u4f5c\u308c\u308b\u3088\u3046\u3067\u3059\u3002\nhttps://itunes.apple.com/jp/app/star-gradiator-free/id806155270\n\n\u4eca\u56de\u306e\u30bd\u30fc\u30b9\u306f\u3001\u4ee5\u4e0b\u306b\u30a2\u30c3\u30d7\u3057\u304a\u304d\u307e\u3059\u306d\u3002\nhttps://github.com/yukinaga/CollisionPerformanceTestSpriteKit\nhttps://github.com/yukinaga/CollisionPerformanceTestUIKit\n", "tags": ["Xcode", "Objective-C", "SpriteKit", "UIKit", "iOS"]}