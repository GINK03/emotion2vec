{"context": " More than 1 year has passed since last update.\n\n\u76ee\u7684\nWeb+DB Press Vol.87 \u306e Flux \u306e\u8a18\u4e8b \u304c\u7d20\u6674\u3089\u3057\u304b\u3063\u305f\u306e\u3067\u3001facebook/flux \u3067\u66f8\u304d\u63db\u3048\u3066\u307f\u305f\u3002\n\uff08\u8a18\u4e8b\u3067\u306f fluxxor\uff09\n\u3061\u306a\u307f\u306b\u96d1\u8a8c\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306f \u3053\u3061\u3089\u306e\u300cEmerging Web Technology\u7814\u7a76\u5ba4\u300d\n\u4e0b\u8a18todo\u30b5\u30f3\u30d7\u30eb\u3092\u53c2\u8003\u306b\u3057\u305f\n- [https://github.com/facebook/flux/tree/master/examples/flux-todomvc]\n\n\u30d5\u30a1\u30a4\u30eb\u69cb\u6210\n.\n\u251c\u2500\u2500 dest\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 app.js\n\u251c\u2500\u2500 index.html\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 app.jsx\n    \u2514\u2500\u2500 app_dispatcher.js\n\n\npackage\nreactify \u3067\u306f\u306a\u304f babelify \u3092\u4f7f\u3046\n\npacage.json\n{\n  \"devDependencies\": {\n    \"babelify\": \"^6.1.2\",\n    \"browserify\": \"^10.2.4\",\n    \"watchify\": \"^3.2.3\"\n  },\n  \"scripts\": {\n    \"watch\": \"watchify -t babelify src/app.jsx -o dest/app.js -v\"\n  },\n  \"dependencies\": {\n    \"flux\": \"^2.0.3\",\n    \"keymirror\": \"^0.1.1\",\n    \"object-assign\": \"^3.0.0\",\n    \"react\": \"^0.13.3\"\n  }\n}\n\n\n\n$ npm install\n$ npm run watch\n\n\ncode\n\nsrc/app.jsx\nvar EventEmitter = require('events').EventEmitter;\nvar React = require('react');\nvar assign = require('object-assign');\nvar keyMirror = require('keymirror');\n\nvar AppDispatcher = require('./app_dispatcher');\n\nvar CounterConstants = keyMirror({\n    UPDATE_COUNTER: null\n});\n\n\n// Store\nvar CHANGE_EVENT = 'change';\nvar counter = 0;\n\nvar CounterStore = assign({}, EventEmitter.prototype, {\n    getCounter: function() {\n        return counter;\n    },\n    emitChange: function() {\n        this.emit(CHANGE_EVENT);\n    },\n    addChangeListener: function(callback) {\n        this.on(CHANGE_EVENT, callback);\n    },\n    onUpdateCounter: function(value) {\n        counter += value;\n    }\n});\n\nAppDispatcher.register(function(action) {\n    switch(action.actionType) {\n        case CounterConstants.UPDATE_COUNTER:\n            CounterStore.onUpdateCounter(action.value);\n            CounterStore.emitChange();\n            break;\n        default:\n            // no op\n    }\n});\n\n\n// Action\nvar CounterActions = {\n    plusCounter: function() {\n        AppDispatcher.dispatch({\n            actionType: CounterConstants.UPDATE_COUNTER,\n            value: 1\n        });\n    },\n    minusCounter: function() {\n        AppDispatcher.dispatch({\n            actionType: CounterConstants.UPDATE_COUNTER,\n            value: -1\n        });\n    }\n};\n\n\n// View\nfunction getCounterState() {\n    return {\n        value: CounterStore.getCounter()\n    };\n}\n\nvar CounterAppView = React.createClass({\n    getInitialState: function() {\n        return getCounterState();\n    },\n    componentDidMount: function() {\n        CounterStore.addChangeListener(this.onChange);\n    },\n    render: function() {\n        return (\n            <div>\n                <span>count: {this.state.value}</span>\n                <CounterView />\n            </div>\n        );\n    },\n    onChange: function() {\n        this.setState(getCounterState());\n    }\n});\n\nvar CounterView = React.createClass({\n    render: function() {\n        return (\n            <div>\n                <div>\n                    <button onClick={this.onClickPlus}>+1</button>\n                    <button onClick={this.onClickMinus}>-1</button>\n                </div>\n            </div>\n        );\n    },\n    onClickPlus: function() {\n        CounterActions.plusCounter();\n    },\n    onClickMinus: function() {\n        CounterActions.minusCounter();\n    }\n});\n\nReact.render(\n    <CounterAppView />,\n    document.getElementById('app-container')\n);\n\n\n\nsrc/app_dispatcher.js\nvar Dispatcher = require('flux').Dispatcher;\n\nmodule.exports = new Dispatcher();\n\n\n\nindex.html\n<!doctype html>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Flux</title>\n    </head>\n    <body>\n        <div id=\"app-container\"></div>\n\n        <script src=\"dest/app.js\"></script>\n    </body>\n</html>\n\n\n\n\u8868\u793a\n$ python -m SimpleHTTPServer 8000\n\n\nhttp://localhost:8000\n\n\n\n\u7d9a\u304d\n\nES6 \u306e class \u306a\u3069\u3092\u4f7f\u3063\u3066\u66f8\u304d\u63db\u3048\u3066\u307f\u305f\n\n\n\u611f\u60f3\n\nES6\u3067\u66f8\u304d\u63db\u3048\u3088\u3046\u304b\u3068\u601d\u3063\u305f\u3051\u3069\u30c4\u30e9\u305d\u3046...\nflux \u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u4f55\u3092\u4f7f\u3046\u306e\u304c\u3044\u3044\u306e\u3084\u3089...\n\n\n\u53c2\u8003\n\nhttp://gihyo.jp/magazine/wdpress/archive/2015/vol87\nhttps://github.com/facebook/flux/\n\n\n## \u76ee\u7684\n[Web+DB Press Vol.87 \u306e Flux \u306e\u8a18\u4e8b](http://gihyo.jp/magazine/wdpress/archive/2015/vol87) \u304c\u7d20\u6674\u3089\u3057\u304b\u3063\u305f\u306e\u3067\u3001[facebook/flux](https://github.com/facebook/flux) \u3067\u66f8\u304d\u63db\u3048\u3066\u307f\u305f\u3002\n\uff08\u8a18\u4e8b\u3067\u306f [fluxxor](http://fluxxor.com/)\uff09\n\n\u3061\u306a\u307f\u306b\u96d1\u8a8c\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306f [\u3053\u3061\u3089\u306e\u300cEmerging Web Technology\u7814\u7a76\u5ba4\u300d](http://gihyo.jp/magazine/wdpress/archive/2015/vol87/support)\n\n\u4e0b\u8a18todo\u30b5\u30f3\u30d7\u30eb\u3092\u53c2\u8003\u306b\u3057\u305f\n- [https://github.com/facebook/flux/tree/master/examples/flux-todomvc]\n\n\n## \u30d5\u30a1\u30a4\u30eb\u69cb\u6210\n\n```\n.\n\u251c\u2500\u2500 dest\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 app.js\n\u251c\u2500\u2500 index.html\n\u251c\u2500\u2500 package.json\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 app.jsx\n    \u2514\u2500\u2500 app_dispatcher.js\n```\n\n## package\n\nreactify \u3067\u306f\u306a\u304f babelify \u3092\u4f7f\u3046\n\n```pacage.json\n{\n  \"devDependencies\": {\n    \"babelify\": \"^6.1.2\",\n    \"browserify\": \"^10.2.4\",\n    \"watchify\": \"^3.2.3\"\n  },\n  \"scripts\": {\n    \"watch\": \"watchify -t babelify src/app.jsx -o dest/app.js -v\"\n  },\n  \"dependencies\": {\n    \"flux\": \"^2.0.3\",\n    \"keymirror\": \"^0.1.1\",\n    \"object-assign\": \"^3.0.0\",\n    \"react\": \"^0.13.3\"\n  }\n}\n\n```\n\n```\n$ npm install\n$ npm run watch\n```\n\n## code\n\n```src/app.jsx\nvar EventEmitter = require('events').EventEmitter;\nvar React = require('react');\nvar assign = require('object-assign');\nvar keyMirror = require('keymirror');\n\nvar AppDispatcher = require('./app_dispatcher');\n\nvar CounterConstants = keyMirror({\n    UPDATE_COUNTER: null\n});\n\n\n// Store\nvar CHANGE_EVENT = 'change';\nvar counter = 0;\n\nvar CounterStore = assign({}, EventEmitter.prototype, {\n    getCounter: function() {\n        return counter;\n    },\n    emitChange: function() {\n        this.emit(CHANGE_EVENT);\n    },\n    addChangeListener: function(callback) {\n        this.on(CHANGE_EVENT, callback);\n    },\n    onUpdateCounter: function(value) {\n        counter += value;\n    }\n});\n\nAppDispatcher.register(function(action) {\n    switch(action.actionType) {\n        case CounterConstants.UPDATE_COUNTER:\n            CounterStore.onUpdateCounter(action.value);\n            CounterStore.emitChange();\n            break;\n        default:\n            // no op\n    }\n});\n\n\n// Action\nvar CounterActions = {\n    plusCounter: function() {\n        AppDispatcher.dispatch({\n            actionType: CounterConstants.UPDATE_COUNTER,\n            value: 1\n        });\n    },\n    minusCounter: function() {\n        AppDispatcher.dispatch({\n            actionType: CounterConstants.UPDATE_COUNTER,\n            value: -1\n        });\n    }\n};\n\n\n// View\nfunction getCounterState() {\n    return {\n        value: CounterStore.getCounter()\n    };\n}\n\nvar CounterAppView = React.createClass({\n    getInitialState: function() {\n        return getCounterState();\n    },\n    componentDidMount: function() {\n        CounterStore.addChangeListener(this.onChange);\n    },\n    render: function() {\n        return (\n            <div>\n                <span>count: {this.state.value}</span>\n                <CounterView />\n            </div>\n        );\n    },\n    onChange: function() {\n        this.setState(getCounterState());\n    }\n});\n\nvar CounterView = React.createClass({\n    render: function() {\n        return (\n            <div>\n                <div>\n                    <button onClick={this.onClickPlus}>+1</button>\n                    <button onClick={this.onClickMinus}>-1</button>\n                </div>\n            </div>\n        );\n    },\n    onClickPlus: function() {\n        CounterActions.plusCounter();\n    },\n    onClickMinus: function() {\n        CounterActions.minusCounter();\n    }\n});\n\nReact.render(\n    <CounterAppView />,\n    document.getElementById('app-container')\n);\n```\n\n```src/app_dispatcher.js\nvar Dispatcher = require('flux').Dispatcher;\n\nmodule.exports = new Dispatcher();\n```\n\n```index.html\n<!doctype html>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Flux</title>\n    </head>\n    <body>\n        <div id=\"app-container\"></div>\n\n        <script src=\"dest/app.js\"></script>\n    </body>\n</html>\n```\n\n## \u8868\u793a\n\n```\n$ python -m SimpleHTTPServer 8000\n```\n\n- http://localhost:8000\n\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-03 0.20.12.png](https://qiita-image-store.s3.amazonaws.com/0/41656/3fb3784f-2d3e-965e-eff8-33d1bc7e8d04.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-07-03 0.20.12.png\")\n\n\n## \u7d9a\u304d\n\n- [ES6 \u306e class \u306a\u3069\u3092\u4f7f\u3063\u3066\u66f8\u304d\u63db\u3048\u3066\u307f\u305f](http://qiita.com/cortyuming/items/bf24a087b4831ffa20f8)\n\n\n## \u611f\u60f3\n\n- ES6\u3067\u66f8\u304d\u63db\u3048\u3088\u3046\u304b\u3068\u601d\u3063\u305f\u3051\u3069\u30c4\u30e9\u305d\u3046...\n- flux \u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u4f55\u3092\u4f7f\u3046\u306e\u304c\u3044\u3044\u306e\u3084\u3089...\n\n\n## \u53c2\u8003\n\n- http://gihyo.jp/magazine/wdpress/archive/2015/vol87\n- https://github.com/facebook/flux/\n", "tags": ["JavaScript", "reactjs", "flux"]}