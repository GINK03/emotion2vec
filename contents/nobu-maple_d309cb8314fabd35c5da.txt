{"context": "\u904e\u53bb\u306b\u3069\u3053\u304b\u3067\u62fe\u3063\u305f\u3082\u306e\n\u3068\u308a\u3042\u3048\u305a\u3001\u4fdd\u5b58\u306e\u610f\u5473\u3067\u66f8\u304d\u8fbc\u307f\n\u8d85\u4fbf\u5229\u3067\u3059\n\u4f5c\u8005\u3055\u3093\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\n\nbase64.js\n\n/**\n * :: base64.js  BASE64\u306e\u8aad\u307f\u66f8\u304d\u3092\u884c\u306a\u3046\u30d0\u30c3\u30c1\n * \n * \u30a8\u30f3\u30b3\u30fc\u30c9\u65b9\u6cd5\uff1a\n *   cscript //nologo base64.js encode \u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb > hoge.txt\n * \n * \u30c7\u30b3\u30fc\u30c9\u65b9\u6cd5\uff1a\n *   cscript //nologo base64.js decode hoge.txt \u5fa9\u5143\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u30d1\u30b9\n * \n **/\n\n// ----------------- \u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570 --------------\nvar action_type = WScript.Arguments.Unnamed(0); // encode or decode\n  //log( action_type );\n\n\n// ----------------- \u95a2\u6570 --------------\nfunction log(s){ WScript.Echo( s ); }\n\n\n// \u30a8\u30f3\u30b3\u30fc\u30c9\u5b9f\u884c\nfunction base64encode( target_file_path )\n{\n  // \u30d5\u30a1\u30a4\u30eb\u3092\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3068\u3057\u3066\u8aad\u307f\u53d6\u308a\n  var stream = new ActiveXObject('ADODB.Stream');\n  stream.Type = 1; // binary\n  stream.Open();\n  stream.LoadFromFile( target_file_path );\n  var binary_data = stream.Read( -1 ); // -1:read all\n\n  // \u65b0\u898fXML\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n  var xml = new ActiveXObject(\"Microsoft.XMLDOM\");\n  xml.loadXML('<?xml version=\"1.0\" ?> <root/>');\n  xml.documentElement.setAttribute(\"xmlns:dt\", \"urn:schemas-microsoft-com:datatypes\");\n\n  // \u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306e\u30ce\u30fc\u30c9\u3092\u4f5c\u6210\n  var node = xml.createElement(\"file-node\");\n  node.dataType = \"bin.base64\";\n\n  // \u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\n  node.nodeTypedValue = binary_data;\n  xml.documentElement.appendChild( node );\n\n  // \u305d\u306e\u30ce\u30fc\u30c9\u304b\u3089BASE64\u30a8\u30f3\u30b3\u30fc\u30c9\u6e08\u307f\u6587\u5b57\u5217\u3092\u53d6\u308a\u51fa\u3059\n  var base64encoded_text = node.text;\n  return base64encoded_text;\n};\n\n\n// \u30c7\u30b3\u30fc\u30c9\u5b9f\u884c\nfunction base64decode( encoded_text_path, binary_file_save_path )\n{\n  // BASE64\u6587\u5b57\u5217\u3092\u53d6\u5f97\n  var fso_r = WScript.CreateObject( \"Scripting.FileSystemObject\" );\n  var base64str = fso_r.OpenTextFile( encoded_text_path, 1 ).ReadAll();\n\n  // \u65b0\u898fXML\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n  var xml = WScript.CreateObject(\"Microsoft.XMLDOM\");\n\n  // BASE64\u6587\u5b57\u5217\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306e\u30ce\u30fc\u30c9\u3092\u4f5c\u6210\n  var node = xml.createElement(\"base64-node\");\n  node.dataType = \"bin.base64\";\n\n  // \u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n  node.text = base64str;\n  var binary_data = node.nodeTypedValue;\n\n  // \u66f8\u304d\u8fbc\u307f\n  var sw = new ActiveXObject(\"ADODB.Stream\");\n  sw.Type = 1; // binary\n  sw.Open();\n  sw.Write( binary_data );\n  sw.SaveToFile( binary_file_save_path );\n  sw.Close();\n};\n\n\n// ----------------- \u30e1\u30a4\u30f3\u51e6\u7406 --------------\nif( action_type == \"encode\" )\n{\n  var target_file_path = WScript.Arguments.Unnamed(1);\n  //log( target_file_path );\n  var ret =  base64encode( target_file_path );\n\n  // \u30a8\u30f3\u30b3\u30fc\u30c9\u7d50\u679c\u3092\u51fa\u529b\n  log( ret );\n}\nelse if( action_type == \"decode\" )\n{\n  var encoded_text_path = WScript.Arguments.Unnamed(1);\n  var binary_file_save_path = WScript.Arguments.Unnamed(2);\n\n  // \u30c7\u30b3\u30fc\u30c9\u7d50\u679c\u3092\u4fdd\u5b58\n  base64decode( encoded_text_path, binary_file_save_path );\n}\n\n\n\n\u3053\u308c\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u300c\u6587\u5b57\u300d\u306b\u3057\u3066\u3057\u307e\u3048\u3070\u3001\u30e1\u30fc\u30eb\u306e\u672c\u6587\u3067\u9001\u308b\u3053\u3068\u3082\u3067\u304d\u3061\u3083\u3046\u30e8\n\u904e\u53bb\u306b\u3069\u3053\u304b\u3067\u62fe\u3063\u305f\u3082\u306e\n\u3068\u308a\u3042\u3048\u305a\u3001\u4fdd\u5b58\u306e\u610f\u5473\u3067\u66f8\u304d\u8fbc\u307f\n\n\u8d85\u4fbf\u5229\u3067\u3059\n\u4f5c\u8005\u3055\u3093\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\n\n\n\n```base64.js\n\n/**\n * :: base64.js  BASE64\u306e\u8aad\u307f\u66f8\u304d\u3092\u884c\u306a\u3046\u30d0\u30c3\u30c1\n * \n * \u30a8\u30f3\u30b3\u30fc\u30c9\u65b9\u6cd5\uff1a\n *   cscript //nologo base64.js encode \u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb > hoge.txt\n * \n * \u30c7\u30b3\u30fc\u30c9\u65b9\u6cd5\uff1a\n *   cscript //nologo base64.js decode hoge.txt \u5fa9\u5143\u30d5\u30a1\u30a4\u30eb\u306e\u4fdd\u5b58\u30d1\u30b9\n * \n **/\n\n// ----------------- \u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5f15\u6570 --------------\nvar action_type = WScript.Arguments.Unnamed(0); // encode or decode\n  //log( action_type );\n\n\n// ----------------- \u95a2\u6570 --------------\nfunction log(s){ WScript.Echo( s ); }\n\n\n// \u30a8\u30f3\u30b3\u30fc\u30c9\u5b9f\u884c\nfunction base64encode( target_file_path )\n{\n  // \u30d5\u30a1\u30a4\u30eb\u3092\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3068\u3057\u3066\u8aad\u307f\u53d6\u308a\n  var stream = new ActiveXObject('ADODB.Stream');\n  stream.Type = 1; // binary\n  stream.Open();\n  stream.LoadFromFile( target_file_path );\n  var binary_data = stream.Read( -1 ); // -1:read all\n  \n  // \u65b0\u898fXML\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n  var xml = new ActiveXObject(\"Microsoft.XMLDOM\");\n  xml.loadXML('<?xml version=\"1.0\" ?> <root/>');\n  xml.documentElement.setAttribute(\"xmlns:dt\", \"urn:schemas-microsoft-com:datatypes\");\n  \n  // \u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306e\u30ce\u30fc\u30c9\u3092\u4f5c\u6210\n  var node = xml.createElement(\"file-node\");\n  node.dataType = \"bin.base64\";\n  \n  // \u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\n  node.nodeTypedValue = binary_data;\n  xml.documentElement.appendChild( node );\n  \n  // \u305d\u306e\u30ce\u30fc\u30c9\u304b\u3089BASE64\u30a8\u30f3\u30b3\u30fc\u30c9\u6e08\u307f\u6587\u5b57\u5217\u3092\u53d6\u308a\u51fa\u3059\n  var base64encoded_text = node.text;\n  return base64encoded_text;\n};\n\n\n// \u30c7\u30b3\u30fc\u30c9\u5b9f\u884c\nfunction base64decode( encoded_text_path, binary_file_save_path )\n{\n  // BASE64\u6587\u5b57\u5217\u3092\u53d6\u5f97\n  var fso_r = WScript.CreateObject( \"Scripting.FileSystemObject\" );\n  var base64str = fso_r.OpenTextFile( encoded_text_path, 1 ).ReadAll();\n  \n  // \u65b0\u898fXML\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n  var xml = WScript.CreateObject(\"Microsoft.XMLDOM\");\n  \n  // BASE64\u6587\u5b57\u5217\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306e\u30ce\u30fc\u30c9\u3092\u4f5c\u6210\n  var node = xml.createElement(\"base64-node\");\n  node.dataType = \"bin.base64\";\n  \n  // \u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n  node.text = base64str;\n  var binary_data = node.nodeTypedValue;\n  \n  // \u66f8\u304d\u8fbc\u307f\n  var sw = new ActiveXObject(\"ADODB.Stream\");\n  sw.Type = 1; // binary\n  sw.Open();\n  sw.Write( binary_data );\n  sw.SaveToFile( binary_file_save_path );\n  sw.Close();\n};\n\n\n// ----------------- \u30e1\u30a4\u30f3\u51e6\u7406 --------------\nif( action_type == \"encode\" )\n{\n  var target_file_path = WScript.Arguments.Unnamed(1);\n  //log( target_file_path );\n  var ret =  base64encode( target_file_path );\n  \n  // \u30a8\u30f3\u30b3\u30fc\u30c9\u7d50\u679c\u3092\u51fa\u529b\n  log( ret );\n}\nelse if( action_type == \"decode\" )\n{\n  var encoded_text_path = WScript.Arguments.Unnamed(1);\n  var binary_file_save_path = WScript.Arguments.Unnamed(2);\n  \n  // \u30c7\u30b3\u30fc\u30c9\u7d50\u679c\u3092\u4fdd\u5b58\n  base64decode( encoded_text_path, binary_file_save_path );\n}\n\n```\n\n\n\u3053\u308c\u3067\u30d5\u30a1\u30a4\u30eb\u3092\u300c\u6587\u5b57\u300d\u306b\u3057\u3066\u3057\u307e\u3048\u3070\u3001\u30e1\u30fc\u30eb\u306e\u672c\u6587\u3067\u9001\u308b\u3053\u3068\u3082\u3067\u304d\u3061\u3083\u3046\u30e8\n\n", "tags": ["base64", "JScript"]}