{"context": " More than 1 year has passed since last update.\u5f37\u3044\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u4f7f\u3046\u3068\u30ad\u30fc\u306f\u5747\u4e00\u306b\u5206\u6563\u3055\u308c\u308b\u306f\u305a\u3060\u3051\u3069\u3001MD5\u306f\u5f37\u304f\u306a\u3044\u3089\u3057\u3044\u3002\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n                                                                                           161038431783640996747061834539477326541\n10.10.10.1        datacenter1 rack1       Up     Normal  56.08 KB        59.76%              92566278802770359146832254620092330417\n10.10.10.2        datacenter1 rack1       Up     Normal  60.69 KB        5.16%               101344869056471442016922121422834278883\n10.10.10.3        datacenter1 rack1       Up     Normal  56.18 KB        18.41%              132670840620665264014573975366691587616\n10.10.10.4        datacenter1 rack1       Up     Normal  60.49 KB        5.90%               142707366785106214210137953545520747214\n10.10.10.5        datacenter1 rack1       Up     Normal  56.18 KB        10.77%              161038431783640996747061834539477326541\n\n\u30d0\u30c3\u30e9\u30d0\u30e9\u3002\n\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u3044\u306a\u3044\u306e\u3067initial_token\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n\u30d7\u30ed\u30bb\u30b9\u6b62\u3081\u3066\u3082OK\u306a\u5834\u5408\n1.\u307e\u305a\u30d7\u30ed\u30bb\u30b9\u3092\u843d\u3068\u3059\n# /etc/init.d/cassandra stop\n\n2.\u30c7\u30fc\u30bf\u524a\u9664\n# rm -rf /var/lib/cassandra/data/*\n# rm -rf /var/lib/cassandra/commitlog/*\n# rm -rf /var/lib/cassandra/aved_caches/*\n\n3.initial_token\u3092\u8a08\u7b97\u3059\u308b\n# token-generator 5\nDC #1:\n  Node #1:                                        0\n  Node #2:   34028236692093846346337460743176821145\n  Node #3:   68056473384187692692674921486353642290\n  Node #4:  102084710076281539039012382229530463435\n  Node #5:  136112946768375385385349842972707284580\n\n4.\u5404Node\u3054\u3068\u306binitial_token\u3092\u8a2d\u5b9a\n\n/etc/cassandra/cassandra.yaml\n# Node1\ninitial_token: 0\n# Node2\ninitial_token: 34028236692093846346337460743176821145\n# Node3\ninitial_token: 68056473384187692692674921486353642290\n# Node4\ninitial_token: 102084710076281539039012382229530463435\n# Node5\ninitial_token: 136112946768375385385349842972707284580\n\n\n5.\u8d77\u52d5\n# /etc/init.d/cassandra start\nStarting Cassandra:                                        [  OK  ]\n\n6.\u30ea\u30f3\u30b0\u78ba\u8a8d\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n10.34.68.186    datacenter1 rack1       Up     Normal  9.08 KB         100.00%             0\n\n\u304b\u3089\u306e\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n                                                                                           34028236692093846346337460743176821145\n10.10.10.1        datacenter1 rack1       Up     Normal  13.51 KB        80.00%              0\n10.10.10.2        datacenter1 rack1       Up     Normal  ?               20.00%              34028236692093846346337460743176821145\n\n\u3044\u3044\u611f\u3058\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n                                                                                           136112946768375385385349842972707284580\n10.10.10.1        datacenter1 rack1       Up     Normal  6.72 KB         60.00%              0\n10.10.10.2        datacenter1 rack1       Up     Normal  13.51 KB        20.00%              34028236692093846346337460743176821145\n10.10.10.3        datacenter1 rack1       Up     Normal  6.72 KB         20.00%              68056473384187692692674921486353642290\n10.10.10.4        datacenter1 rack1       Up     Joining 6.72 KB         0.00%               102084710076281539039012382229530463435\n10.10.10.5        datacenter1 rack1       Up     Joining 4.58 KB         0.00%               136112946768375385385349842972707284580\n\nJoining!!\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n                                                                                           136112946768375385385349842972707284580\n10.10.10.1        datacenter1 rack1       Up     Normal  15.57 KB        20.00%              0\n10.10.10.2        datacenter1 rack1       Up     Normal  6.72 KB         20.00%              34028236692093846346337460743176821145\n10.10.10.3        datacenter1 rack1       Up     Normal  6.72 KB         20.00%              68056473384187692692674921486353642290\n10.10.10.4        datacenter1 rack1       Up     Normal  6.72 KB         20.00%              102084710076281539039012382229530463435\n10.10.10.5        datacenter1 rack1       Up     Normal  4.58 KB         20.00%              136112946768375385385349842972707284580\n\n\u3074\u3063\u305f\u3093\u3053\u30ab\u30f3\u30ab\u30f3\n\n\u30aa\u30f3\u30e9\u30a4\u30f3\u3067\u5909\u66f4\u3059\u308b\u5834\u5408\nnodetool move\u3092\u5404\u30ce\u30fc\u30c9\u3067\u5b9f\u884c\n# nodetool -h ${NODE_IP} move ${\u5272\u308a\u5f53\u3066\u308bTOKEN}\n\n\u6642\u9593\u304c\u304b\u304b\u308b\u3089\u3057\u3044\u306e\u3067\u3001\u6b62\u3081\u308c\u308b\u306a\u3089\u6b62\u3081\u3088\u3046\u3002\n\n\u5f37\u3044\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u3092\u4f7f\u3046\u3068\u30ad\u30fc\u306f\u5747\u4e00\u306b\u5206\u6563\u3055\u308c\u308b\u306f\u305a\u3060\u3051\u3069\u3001MD5\u306f\u5f37\u304f\u306a\u3044\u3089\u3057\u3044\u3002\n\n```\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n                                                                                           161038431783640996747061834539477326541\n10.10.10.1        datacenter1 rack1       Up     Normal  56.08 KB        59.76%              92566278802770359146832254620092330417\n10.10.10.2        datacenter1 rack1       Up     Normal  60.69 KB        5.16%               101344869056471442016922121422834278883\n10.10.10.3        datacenter1 rack1       Up     Normal  56.18 KB        18.41%              132670840620665264014573975366691587616\n10.10.10.4        datacenter1 rack1       Up     Normal  60.49 KB        5.90%               142707366785106214210137953545520747214\n10.10.10.5        datacenter1 rack1       Up     Normal  56.18 KB        10.77%              161038431783640996747061834539477326541\n```\n\n\u30d0\u30c3\u30e9\u30d0\u30e9\u3002\n\u30c7\u30fc\u30bf\u304c\u5165\u3063\u3066\u3044\u306a\u3044\u306e\u3067initial_token\u3092\u8a2d\u5b9a\u3059\u308b\u3002\n\n##\u30d7\u30ed\u30bb\u30b9\u6b62\u3081\u3066\u3082OK\u306a\u5834\u5408\n\n1.\u307e\u305a\u30d7\u30ed\u30bb\u30b9\u3092\u843d\u3068\u3059\n\n```\n# /etc/init.d/cassandra stop\n```\n\n2.\u30c7\u30fc\u30bf\u524a\u9664\n\n```\n# rm -rf /var/lib/cassandra/data/*\n# rm -rf /var/lib/cassandra/commitlog/*\n# rm -rf /var/lib/cassandra/aved_caches/*\n```\n\n3.initial_token\u3092\u8a08\u7b97\u3059\u308b\n\n```\n# token-generator 5\nDC #1:\n  Node #1:                                        0\n  Node #2:   34028236692093846346337460743176821145\n  Node #3:   68056473384187692692674921486353642290\n  Node #4:  102084710076281539039012382229530463435\n  Node #5:  136112946768375385385349842972707284580\n```\n\n4.\u5404Node\u3054\u3068\u306binitial_token\u3092\u8a2d\u5b9a\n\n```/etc/cassandra/cassandra.yaml\n# Node1\ninitial_token: 0\n# Node2\ninitial_token: 34028236692093846346337460743176821145\n# Node3\ninitial_token: 68056473384187692692674921486353642290\n# Node4\ninitial_token: 102084710076281539039012382229530463435\n# Node5\ninitial_token: 136112946768375385385349842972707284580\n```\n\n5.\u8d77\u52d5\n\n```\n# /etc/init.d/cassandra start\nStarting Cassandra:                                        [  OK  ]\n```\n\n6.\u30ea\u30f3\u30b0\u78ba\u8a8d\n\n```\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n10.34.68.186    datacenter1 rack1       Up     Normal  9.08 KB         100.00%             0\n```\n\n\u304b\u3089\u306e\n\n```\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n                                                                                           34028236692093846346337460743176821145\n10.10.10.1        datacenter1 rack1       Up     Normal  13.51 KB        80.00%              0\n10.10.10.2        datacenter1 rack1       Up     Normal  ?               20.00%              34028236692093846346337460743176821145\n```\n\n\u3044\u3044\u611f\u3058\n\n```\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n                                                                                           136112946768375385385349842972707284580\n10.10.10.1        datacenter1 rack1       Up     Normal  6.72 KB         60.00%              0\n10.10.10.2        datacenter1 rack1       Up     Normal  13.51 KB        20.00%              34028236692093846346337460743176821145\n10.10.10.3        datacenter1 rack1       Up     Normal  6.72 KB         20.00%              68056473384187692692674921486353642290\n10.10.10.4        datacenter1 rack1       Up     Joining 6.72 KB         0.00%               102084710076281539039012382229530463435\n10.10.10.5        datacenter1 rack1       Up     Joining 4.58 KB         0.00%               136112946768375385385349842972707284580\n```\n\nJoining!!\n\n```\n# nodetool ring\nNote: Ownership information does not include topology, please specify a keyspace.\nAddress         DC          Rack        Status State   Load            Owns                Token\n                                                                                           136112946768375385385349842972707284580\n10.10.10.1        datacenter1 rack1       Up     Normal  15.57 KB        20.00%              0\n10.10.10.2        datacenter1 rack1       Up     Normal  6.72 KB         20.00%              34028236692093846346337460743176821145\n10.10.10.3        datacenter1 rack1       Up     Normal  6.72 KB         20.00%              68056473384187692692674921486353642290\n10.10.10.4        datacenter1 rack1       Up     Normal  6.72 KB         20.00%              102084710076281539039012382229530463435\n10.10.10.5        datacenter1 rack1       Up     Normal  4.58 KB         20.00%              136112946768375385385349842972707284580\n```\n\n\u3074\u3063\u305f\u3093\u3053\u30ab\u30f3\u30ab\u30f3\n\n## \u30aa\u30f3\u30e9\u30a4\u30f3\u3067\u5909\u66f4\u3059\u308b\u5834\u5408\n\n`nodetool move`\u3092\u5404\u30ce\u30fc\u30c9\u3067\u5b9f\u884c\n\n```\n# nodetool -h ${NODE_IP} move ${\u5272\u308a\u5f53\u3066\u308bTOKEN}\n```\n\n\u6642\u9593\u304c\u304b\u304b\u308b\u3089\u3057\u3044\u306e\u3067\u3001\u6b62\u3081\u308c\u308b\u306a\u3089\u6b62\u3081\u3088\u3046\u3002", "tags": ["Cassandra"]}