{"tags": ["atlas", "packer"], "context": " \u3053\u306e\u8a18\u4e8b\u306f\u6700\u7d42\u66f4\u65b0\u65e5\u304b\u30891\u5e74\u4ee5\u4e0a\u304c\u7d4c\u904e\u3057\u3066\u3044\u307e\u3059\u3002Packer \u3092\u4f7f\u3048\u3070 Vagrant Box \u3084 Docker \u30a4\u30e1\u30fc\u30b8\u3001AMI\u3092\u7c21\u5358\u306b\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3088\u306d\u3002\n\u6700\u8fd1\u3060\u30681\u304b\u3089Template\u3092\u66f8\u304b\u306a\u304f\u3066\u3082\u3001\u8ab0\u304b\u304c\u4f5c\u6210\u3057\u305f\u30a4\u30a4\u3082\u306e\u304c\u3042\u308b\u306e\u3067\u8abf\u5b50\u306b\u4e57\u3063\u3066\u8272\u3005\u4f5c\u3063\u3066\u3057\u307e\u3063\u3066\u30fb\u30fb\u30fb\n\u6c17\u304c\u3064\u3044\u305f\u3089\u30de\u30b7\u30f3\u306eSSD\u3092\u98df\u3044\u6f70\u3057\u3066\u3044\u305f\u306a\u3093\u3066\u3053\u3068\u3082\u3001\u304d\u3063\u3068\u3042\u308b\u3067\u3057\u3087\u3046\u3002\n\u4f5c\u6210\u3057\u305f Vagrant Box \u3084 Docker \u30a4\u30e1\u30fc\u30b8\u3092\u516c\u958b\u3059\u308b\u5834\u5408\u306f\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u306a\u304f\u3066\u306f\u3044\u3051\u307e\u305b\u3093\u304c\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u30ef\u30af\u30ef\u30af\u3059\u308b\u306e\u306f\u521d\u3081\u3060\u3051\u3067\u3059\u3002\u3060\u3093\u3060\u3093\u5f85\u3061\u6642\u9593\u304c\u9000\u5c48\u306b\u306a\u3063\u3066\u304d\u307e\u3059\u3002\n\u3042\u30fc\u3001\u30ea\u30e2\u30fc\u30c8\u3067 Packer \u3092\u5b9f\u884c\u3057\u3066\u304a\u3044\u305f\u3089\u81ea\u52d5\u3067\u914d\u5e03\u53ef\u80fd\u306a\u72b6\u614b\u307e\u3067\u6301\u3063\u3066\u3044\u3066\u304f\u308c\u306a\u3044\u304b\u306a\u3041\n\u305d\u3093\u306a\u9858\u671b\u3092\u53f6\u3048\u3066\u304f\u308c\u308b\uff08\u304b\u3082\u3057\u308c\u306a\u3044\uff09\u306e\u304c\u3001Atlas \u3067\u3059\u3002\nAtlas \u306f Vagrant\u3084Packer\u3092\u958b\u767a\u3057\u3066\u3044\u308b Hashicorp \u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d3\u30b9\u3067\u3001Vagrant Box \u306e\u30db\u30b9\u30c6\u30a3\u30f3\u30b0\u3084\u691c\u7d22\u3001\u51c4\u3059\u304e\u3066\u9f3b\u8840\u304c\u51fa\u3066\u3057\u307e\u3046 Vagrant Share \u306a\u3069\u3092\u63d0\u4f9b\u3057\u3066\u3044\u305f Vagrant Cloud \u306e\u4ee3\u66ff\u3068\u306a\u308b\u3001\u65b0\u3057\u3044\u30d7\u30ed\u30c0\u30af\u30c8\u3067\u3059\u3002\nHashicorp\u793e\u306e\u65b0\u30b5\u30fc\u30d3\u30b9ATLAS\u3068\u5468\u8fba\u30c4\u30fc\u30eb\u306e\u307e\u3068\u3081\n\u3053\u306e Atlas \u3092\u4f7f\u3046\u3068\u3001Packer \u3092\u30ea\u30e2\u30fc\u30c8\u3067\u5b9f\u884c\u3057\u3001\u69cb\u7bc9\u3055\u308c\u305f Vagrant Box \u3084 Docker \u30a4\u30e1\u30fc\u30b8\u3001AMI\u3092\u4fdd\u7ba1\u3001\u516c\u958b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nAtlas \u30a2\u30ab\u30a6\u30f3\u30c8\n\u904e\u53bb\u306b Vagrant Cloud \u3092\u5229\u7528\u3057\u3066\u3044\u305f\u5834\u5408\u306f\u3001\u305d\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\u3002\n\u5229\u7528\u3057\u305f\u3053\u3068\u304c\u306a\u3051\u308c\u3070\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u3087\u3046\u3002\n\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u5f8c\u3001Personal Settings \u30da\u30fc\u30b8\u3067 Token \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u751f\u6210\u3057\u305f\u30c8\u30fc\u30af\u30f3\u3092\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n.bashrc\nexport ATLAS_TOKEN=VZCJUQMKVWqjP99oys-mx6h2PicLbpzBiBtAxHV_DvRDTMtsWEQdidA8YCydSH1Ctmo\n\n\n\nPacker Template \u306e\u6e96\u5099\n\u4eca\u56de\u306f \u682a\u5f0f\u4f1a\u793e\u6642\u96e8\u5802 \u3055\u3093\u304c\u516c\u958b\u3057\u3066\u3044\u308b shiguredo/packer-templates \u3092\u4f7f\u3063\u3066\u3001CentOS 7 \u306e Vagrant Box \u3092\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\ntemplate.json \u3092\u57fa\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u7de8\u96c6\u3092\u884c\u3044\u307e\u3059\u3002\n\n\nPush\n\u3053\u306e\u30d3\u30eb\u30c9\u8a2d\u5b9a\u306e\u540d\u524d\u3092 Atlas\u30a2\u30ab\u30a6\u30f3\u30c8\u540d/\u30d3\u30eb\u30c9\u8a2d\u5b9a\u540d \u306e\u5f62\u5f0f\u3067\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\ntemplate.json\n\"push\": {\n  \"name\": \"niwashun/centos70-build-configuration\"\n}\n\n\n\u203b\u30d3\u30eb\u30c9\u540d\u306b centos-7.0 \u306e\u3088\u3046\u306b\u30c9\u30c3\u30c8\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3068\u3001\u3053\u306e\u5f8c\u3067\u5b9f\u884c\u3059\u308b packer push \u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u307f\u305f\u3044\u3067\u3059\n\nBuilders\n\u5143\u3005\u8a18\u8f09\u3055\u308c\u3066\u3044\u308bISO\u30d5\u30a1\u30a4\u30eb\u304c\u7121\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u5909\u66f4\u3057\u307e\u3059\u3002\n\ntemplate.json\n\"builders\": [\n  {\n    \"type\": \"virtualbox-iso\",\n    ...\n    \"iso_checksum\": \"154ba47b7a37e52e0100310c3aeb8f9d9daf4806\",\n    \"iso_checksum_type\": \"sha1\",\n    \"iso_url\": \"http://ftp.iij.ad.jp/pub/linux/centos/7.0.1406/isos/x86_64/CentOS-7.0-1406-x86_64-DVD.iso\",\n    ...\n  },\n  {\n    \"type\": \"vmware-iso\",\n    ...\n    \"iso_checksum\": \"154ba47b7a37e52e0100310c3aeb8f9d9daf4806\",\n    \"iso_checksum_type\": \"sha1\",\n    \"iso_url\": \"http://ftp.iij.ad.jp/pub/linux/centos/7.0.1406/isos/x86_64/CentOS-7.0-1406-x86_64-DVD.iso\",\n    ...\n  }\n]   \n\n\n\nVariables\n\u5fc5\u9808\u3067\u306f\u306a\u3044\u3067\u3059\u304c\u3001Atlas \u30a2\u30ab\u30a6\u30f3\u30c8\u540d \u3068 Vagrant Box\u540d\u3092\u5909\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\ntemplate.json\n\"variables\": {\n  \"atlas_username\": \"niwashun\",\n  \"atlas_name\": \"centos-7.0\",\n}\n\n\n\nPost-Processors\nVMware \u3068 VirtualBox \u7528\u306e Atlas post-processor \u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\nvariables \u3092\u5b9a\u7fa9\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f artifact \u3092\u9069\u5b9c\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002 \n\ntemplate.json\n\"post-processors\": [\n  {\n    \"type\": \"atlas\",\n    \"only\": [\"vmware-iso\"],\n    \"artifact\": \"{{user `atlas_username`}}/{{user `atlas_name`}}\",\n    \"artifact_type\": \"vagrant.box\",\n    \"metadata\": {\n      \"provider\": \"vmware_desktop\",\n      \"version\": \"0.0.1\"\n    }\n  },\n  {\n    \"type\": \"atlas\",\n    \"only\": [\"virtualbox-iso\"],\n    \"artifact\": \"{{user `atlas_username`}}/{{user `atlas_name`}}\",\n    \"artifact_type\": \"vagrant.box\",\n    \"metadata\": {\n      \"provider\": \"virtualbox\",\n      \"version\": \"0.0.1\"\n    }\n  }\n]\n\n\n\u6700\u7d42\u7684\u306b\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\nPush \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\n\u3044\u3088\u3044\u3088\u30ea\u30e2\u30fc\u30c8\u3067\u30d3\u30eb\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u7de8\u96c6\u3057\u305f template.json \u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067 packer push \u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\ncommand-line\n$ packer push -create template.json\n\n\n\u6210\u529f\u3059\u308b\u3068\u3001Push successful to 'niwashun/centos70-build-configuration' \u3068\u3044\u3046\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\u3067\u306f\u3001Atlas \u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\ntemplate.json \u3067\u6307\u5b9a\u3057\u305f\u30d3\u30eb\u30c9\u540d\u304b\u3089\u3001Builder\u6bce\u306e\u72b6\u6cc1\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n\u4f55\u5ea6\u304b packer push \u3057\u3066\u3044\u308b\u3068\u3001\u305d\u306e\u5c65\u6b74\u3082\u30b3\u30b3\u306b\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\nvirtualbox-iso \u306e\u53f3\u7aef\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u3001\u8a73\u7d30\u306a\u30d3\u30eb\u30c9\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30d3\u30eb\u30c9\u304c\u5b8c\u4e86\u3059\u308b\u3068\u30b9\u30c6\u30fc\u30bf\u30b9\u304c finished \u3084 error \u306b\u5909\u308f\u308a\u307e\u3059\u3002\n\n\n\n$ vagrant init niwashun/centos-7.0\nA `Vagrantfile` has been placed in this directory. You are now\nready to `vagrant up` your first virtual environment! Please read\nthe comments in the Vagrantfile as well as documentation on\n`vagrantup.com` for more information on using Vagrant.\n\n\u69cb\u7bc9\u76f4\u5f8c\u306e Box \u30d5\u30a1\u30a4\u30eb\u306f Private \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u72b6\u614b\u3067\u8a66\u3057\u3066\u307f\u305f\u3044\u5834\u5408\u306f vagrant login \u304c\u5fc5\u8981\u3067\u3059\u3002\n$ vagrant up\nBringing machine 'default' up with 'virtualbox' provider...\n==> default: Box 'niwashun/centos-7.0' could not be found. Attempting to find and install...\n    default: Box Provider: virtualbox\n    default: Box Version: >= 0\nThe box 'niwashun/centos-7.0' could not be found or\ncould not be accessed in the remote catalog. If this is a private\nbox on Vagrant Cloud, please verify you're logged in via\n`vagrant login`. Also, please double-check the name. The expanded\nURL and error message are shown below:\n\nURL: [\"https://vagrantcloud.com/niwashun/centos-7.0\"]\nError: The requested URL returned error: 404 Not Found\n\nvagrant login \u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n$ vagrant login\nIn a moment we'll ask for your username and password to Vagrant Cloud.\nAfter authenticating, we will store an access token locally. Your\nlogin details will be transmitted over a secure connection, and are\nnever stored on disk locally.\n\nIf you don't have a Vagrant Cloud account, sign up at vagrantcloud.com\n\nUsername or Email: niwashun\nPassword (will be hidden): \nYou're now logged in!\n\n\u3053\u308c\u3067 vagrant up \u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u30fb\u30fb\u30fb\n$ vagrant up\nBringing machine 'default' up with 'virtualbox' provider...\n==> default: Box 'niwashun/centos-7.0' could not be found. Attempting to find and install...\n    default: Box Provider: virtualbox\n    default: Box Version: >= 0\n==> default: Loading metadata for box 'niwashun/centos-7.0'\n    default: URL: https://vagrantcloud.com/niwashun/centos-7.0\n==> default: Adding box 'niwashun/centos-7.0' (v0.0.1) for provider: virtualbox\n    default: Downloading: https://vagrantcloud.com/niwashun/boxes/centos-7.0/versions/0.0.1/providers/virtualbox.box\nThe \"metadata.json\" file for the box 'niwashun/centos-7.0' was not found.\nBoxes require this file in order for Vagrant to determine the\nprovider it was made for. If you made the box, please add a\n\"metadata.json\" file to it. If someone else made the box, please\nnotify the box creator that the box is corrupt. Documentation for\nbox file format can be found at the URL below:\n\nhttp://docs.vagrantup.com/v2/boxes/format.html\n\n\u30fb\u30fb\u30fb\uff01\n\u3067\u3001\u3067\u304d\u306d\u3047\u30c3\uff01\uff1f\nMissing metadata.json (Packer (push) -> ATLAS (build) -> Vagrant (download)) #2090\n\u3050\u3075\u3049\n\n\u53c2\u8003\nPacker in Atlas: Automate the Building and Managing of Vagrant Boxes and Machine Images\n\nPacker \u3092\u4f7f\u3048\u3070 Vagrant Box \u3084 Docker \u30a4\u30e1\u30fc\u30b8\u3001AMI\u3092\u7c21\u5358\u306b\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3088\u306d\u3002\n\n\u6700\u8fd1\u3060\u30681\u304b\u3089Template\u3092\u66f8\u304b\u306a\u304f\u3066\u3082\u3001\u8ab0\u304b\u304c\u4f5c\u6210\u3057\u305f\u30a4\u30a4\u3082\u306e\u304c\u3042\u308b\u306e\u3067\u8abf\u5b50\u306b\u4e57\u3063\u3066\u8272\u3005\u4f5c\u3063\u3066\u3057\u307e\u3063\u3066\u30fb\u30fb\u30fb\n\u6c17\u304c\u3064\u3044\u305f\u3089\u30de\u30b7\u30f3\u306eSSD\u3092\u98df\u3044\u6f70\u3057\u3066\u3044\u305f\u306a\u3093\u3066\u3053\u3068\u3082\u3001\u304d\u3063\u3068\u3042\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u4f5c\u6210\u3057\u305f Vagrant Box \u3084 Docker \u30a4\u30e1\u30fc\u30b8\u3092\u516c\u958b\u3059\u308b\u5834\u5408\u306f\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u306a\u304f\u3066\u306f\u3044\u3051\u307e\u305b\u3093\u304c\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306b\u30ef\u30af\u30ef\u30af\u3059\u308b\u306e\u306f\u521d\u3081\u3060\u3051\u3067\u3059\u3002\u3060\u3093\u3060\u3093\u5f85\u3061\u6642\u9593\u304c\u9000\u5c48\u306b\u306a\u3063\u3066\u304d\u307e\u3059\u3002\n\n*\u3042\u30fc\u3001\u30ea\u30e2\u30fc\u30c8\u3067 Packer \u3092\u5b9f\u884c\u3057\u3066\u304a\u3044\u305f\u3089\u81ea\u52d5\u3067\u914d\u5e03\u53ef\u80fd\u306a\u72b6\u614b\u307e\u3067\u6301\u3063\u3066\u3044\u3066\u304f\u308c\u306a\u3044\u304b\u306a\u3041*\n\n\u305d\u3093\u306a\u9858\u671b\u3092\u53f6\u3048\u3066\u304f\u308c\u308b\uff08\u304b\u3082\u3057\u308c\u306a\u3044\uff09\u306e\u304c\u3001[Atlas](https://atlas.hashicorp.com/) \u3067\u3059\u3002\n\nAtlas \u306f Vagrant\u3084Packer\u3092\u958b\u767a\u3057\u3066\u3044\u308b [Hashicorp](https://hashicorp.com/) \u304c\u63d0\u4f9b\u3057\u3066\u3044\u308b\u30b5\u30fc\u30d3\u30b9\u3067\u3001Vagrant Box \u306e\u30db\u30b9\u30c6\u30a3\u30f3\u30b0\u3084\u691c\u7d22\u3001\u51c4\u3059\u304e\u3066\u9f3b\u8840\u304c\u51fa\u3066\u3057\u307e\u3046 *Vagrant Share* \u306a\u3069\u3092\u63d0\u4f9b\u3057\u3066\u3044\u305f [Vagrant Cloud](https://vagrantcloud.com/) \u306e\u4ee3\u66ff\u3068\u306a\u308b\u3001\u65b0\u3057\u3044\u30d7\u30ed\u30c0\u30af\u30c8\u3067\u3059\u3002\n\n[Hashicorp\u793e\u306e\u65b0\u30b5\u30fc\u30d3\u30b9ATLAS\u3068\u5468\u8fba\u30c4\u30fc\u30eb\u306e\u307e\u3068\u3081](http://pocketstudio.jp/log3/2014/12/10/what_is_atlas/)\n\n\u3053\u306e Atlas \u3092\u4f7f\u3046\u3068\u3001Packer \u3092\u30ea\u30e2\u30fc\u30c8\u3067\u5b9f\u884c\u3057\u3001\u69cb\u7bc9\u3055\u308c\u305f Vagrant Box \u3084 Docker \u30a4\u30e1\u30fc\u30b8\u3001AMI\u3092\u4fdd\u7ba1\u3001\u516c\u958b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n## Atlas \u30a2\u30ab\u30a6\u30f3\u30c8\n\n\u904e\u53bb\u306b Vagrant Cloud \u3092\u5229\u7528\u3057\u3066\u3044\u305f\u5834\u5408\u306f\u3001\u305d\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\u3002\n\u5229\u7528\u3057\u305f\u3053\u3068\u304c\u306a\u3051\u308c\u3070\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3057\u3087\u3046\u3002\n\n\u30a2\u30ab\u30a6\u30f3\u30c8\u4f5c\u6210\u5f8c\u3001Personal Settings \u30da\u30fc\u30b8\u3067 *Token* \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 21.27.18.png](https://qiita-image-store.s3.amazonaws.com/0/23886/f3367b9d-226f-61c3-083b-034ec607bb05.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 21.27.18.png\")\n\n\n\u751f\u6210\u3057\u305f\u30c8\u30fc\u30af\u30f3\u3092\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```bash:.bashrc\nexport ATLAS_TOKEN=VZCJUQMKVWqjP99oys-mx6h2PicLbpzBiBtAxHV_DvRDTMtsWEQdidA8YCydSH1Ctmo\n```\n\n## Packer Template \u306e\u6e96\u5099\n\n\u4eca\u56de\u306f [\u682a\u5f0f\u4f1a\u793e\u6642\u96e8\u5802](https://shiguredo.jp/) \u3055\u3093\u304c\u516c\u958b\u3057\u3066\u3044\u308b [shiguredo/packer-templates](https://github.com/shiguredo/packer-templates) \u3092\u4f7f\u3063\u3066\u3001CentOS 7 \u306e Vagrant Box \u3092\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\ntemplate.json \u3092\u57fa\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u7de8\u96c6\u3092\u884c\u3044\u307e\u3059\u3002\n\n---\n\n### Push\n\n\u3053\u306e\u30d3\u30eb\u30c9\u8a2d\u5b9a\u306e\u540d\u524d\u3092 `Atlas\u30a2\u30ab\u30a6\u30f3\u30c8\u540d/\u30d3\u30eb\u30c9\u8a2d\u5b9a\u540d` \u306e\u5f62\u5f0f\u3067\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```json:template.json\n\"push\": {\n  \"name\": \"niwashun/centos70-build-configuration\"\n}\n```\n*\u203b\u30d3\u30eb\u30c9\u540d\u306b `centos-7.0` \u306e\u3088\u3046\u306b\u30c9\u30c3\u30c8\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u3068\u3001\u3053\u306e\u5f8c\u3067\u5b9f\u884c\u3059\u308b `packer push` \u304c\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u307f\u305f\u3044\u3067\u3059*\n\n### Builders\n\n\u5143\u3005\u8a18\u8f09\u3055\u308c\u3066\u3044\u308bISO\u30d5\u30a1\u30a4\u30eb\u304c\u7121\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u307f\u305f\u3044\u306a\u306e\u3067\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```json:template.json\n\"builders\": [\n  {\n    \"type\": \"virtualbox-iso\",\n    ...\n    \"iso_checksum\": \"154ba47b7a37e52e0100310c3aeb8f9d9daf4806\",\n    \"iso_checksum_type\": \"sha1\",\n    \"iso_url\": \"http://ftp.iij.ad.jp/pub/linux/centos/7.0.1406/isos/x86_64/CentOS-7.0-1406-x86_64-DVD.iso\",\n    ...\n  },\n  {\n    \"type\": \"vmware-iso\",\n    ...\n    \"iso_checksum\": \"154ba47b7a37e52e0100310c3aeb8f9d9daf4806\",\n    \"iso_checksum_type\": \"sha1\",\n    \"iso_url\": \"http://ftp.iij.ad.jp/pub/linux/centos/7.0.1406/isos/x86_64/CentOS-7.0-1406-x86_64-DVD.iso\",\n    ...\n  }\n]   \n```\n\n### Variables\n\n\u5fc5\u9808\u3067\u306f\u306a\u3044\u3067\u3059\u304c\u3001Atlas \u30a2\u30ab\u30a6\u30f3\u30c8\u540d \u3068 Vagrant Box\u540d\u3092\u5909\u6570\u3068\u3057\u3066\u5b9a\u7fa9\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n```json:template.json\n\"variables\": {\n  \"atlas_username\": \"niwashun\",\n  \"atlas_name\": \"centos-7.0\",\n}\n```\n\n### Post-Processors\n\nVMware \u3068 VirtualBox \u7528\u306e Atlas post-processor \u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n*variables* \u3092\u5b9a\u7fa9\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f *artifact* \u3092\u9069\u5b9c\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002 \n\n```json:template.json\n\"post-processors\": [\n  {\n    \"type\": \"atlas\",\n    \"only\": [\"vmware-iso\"],\n    \"artifact\": \"{{user `atlas_username`}}/{{user `atlas_name`}}\",\n    \"artifact_type\": \"vagrant.box\",\n    \"metadata\": {\n      \"provider\": \"vmware_desktop\",\n      \"version\": \"0.0.1\"\n    }\n  },\n  {\n    \"type\": \"atlas\",\n    \"only\": [\"virtualbox-iso\"],\n    \"artifact\": \"{{user `atlas_username`}}/{{user `atlas_name`}}\",\n    \"artifact_type\": \"vagrant.box\",\n    \"metadata\": {\n      \"provider\": \"virtualbox\",\n      \"version\": \"0.0.1\"\n    }\n  }\n]\n```\n\n\u6700\u7d42\u7684\u306b\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n<script src=\"https://gist.github.com/niwashun/2e2c058915bc30ec9a3b.js\"></script>\n\n## Push \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\n\n\u3044\u3088\u3044\u3088\u30ea\u30e2\u30fc\u30c8\u3067\u30d3\u30eb\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u7de8\u96c6\u3057\u305f `template.json` \u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067 `packer push` \u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```bash:command-line\n$ packer push -create template.json\n```\n\n\u6210\u529f\u3059\u308b\u3068\u3001`Push successful to 'niwashun/centos70-build-configuration'` \u3068\u3044\u3046\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\u3067\u306f\u3001Atlas \u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 22.21.00.png](https://qiita-image-store.s3.amazonaws.com/0/23886/3f85e0d6-e615-3350-24cb-96d67a866eb8.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 22.21.00.png\")\n\n`template.json` \u3067\u6307\u5b9a\u3057\u305f\u30d3\u30eb\u30c9\u540d\u304b\u3089\u3001Builder\u6bce\u306e\u72b6\u6cc1\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 22.17.44.png](https://qiita-image-store.s3.amazonaws.com/0/23886/601da8a4-6054-f100-2e8e-6fab481d7026.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 22.17.44.png\")\n\n\u4f55\u5ea6\u304b `packer push` \u3057\u3066\u3044\u308b\u3068\u3001\u305d\u306e\u5c65\u6b74\u3082\u30b3\u30b3\u306b\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 22.18.02.png](https://qiita-image-store.s3.amazonaws.com/0/23886/418f900d-5deb-2dab-6923-e011e7f62e0e.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 22.18.02.png\")\n\n`virtualbox-iso` \u306e\u53f3\u7aef\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u3001\u8a73\u7d30\u306a\u30d3\u30eb\u30c9\u72b6\u6cc1\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 22.18.41.png](https://qiita-image-store.s3.amazonaws.com/0/23886/80d15aea-c6e9-172c-ed0e-c19011f2a4cb.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-15 22.18.41.png\")\n\n\u30d3\u30eb\u30c9\u304c\u5b8c\u4e86\u3059\u308b\u3068\u30b9\u30c6\u30fc\u30bf\u30b9\u304c *finished* \u3084 *error* \u306b\u5909\u308f\u308a\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-16 12.27.50.png](https://qiita-image-store.s3.amazonaws.com/0/23886/8bfba05f-e17b-f8b7-b608-9c049b42ce4f.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-16 12.27.50.png\")\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-16 12.28.22.png](https://qiita-image-store.s3.amazonaws.com/0/23886/d60cdac6-5e80-3b29-b4ec-f85dd07ff51f.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-16 12.28.22.png\")\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-18 15.03.26.png](https://qiita-image-store.s3.amazonaws.com/0/23886/3f4d7e3e-75ce-427f-e04d-a931cf3e1feb.png \"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2015-05-18 15.03.26.png\")\n\n```\n$ vagrant init niwashun/centos-7.0\nA `Vagrantfile` has been placed in this directory. You are now\nready to `vagrant up` your first virtual environment! Please read\nthe comments in the Vagrantfile as well as documentation on\n`vagrantup.com` for more information on using Vagrant.\n```\n\n\u69cb\u7bc9\u76f4\u5f8c\u306e Box \u30d5\u30a1\u30a4\u30eb\u306f *Private* \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u72b6\u614b\u3067\u8a66\u3057\u3066\u307f\u305f\u3044\u5834\u5408\u306f `vagrant login` \u304c\u5fc5\u8981\u3067\u3059\u3002\n\n```\n$ vagrant up\nBringing machine 'default' up with 'virtualbox' provider...\n==> default: Box 'niwashun/centos-7.0' could not be found. Attempting to find and install...\n    default: Box Provider: virtualbox\n    default: Box Version: >= 0\nThe box 'niwashun/centos-7.0' could not be found or\ncould not be accessed in the remote catalog. If this is a private\nbox on Vagrant Cloud, please verify you're logged in via\n`vagrant login`. Also, please double-check the name. The expanded\nURL and error message are shown below:\n\nURL: [\"https://vagrantcloud.com/niwashun/centos-7.0\"]\nError: The requested URL returned error: 404 Not Found\n```\n\n`vagrant login` \u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```\n$ vagrant login\nIn a moment we'll ask for your username and password to Vagrant Cloud.\nAfter authenticating, we will store an access token locally. Your\nlogin details will be transmitted over a secure connection, and are\nnever stored on disk locally.\n\nIf you don't have a Vagrant Cloud account, sign up at vagrantcloud.com\n\nUsername or Email: niwashun\nPassword (will be hidden): \nYou're now logged in!\n```\n\n\u3053\u308c\u3067 `vagrant up` \u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u30fb\u30fb\u30fb\n\n```\n$ vagrant up\nBringing machine 'default' up with 'virtualbox' provider...\n==> default: Box 'niwashun/centos-7.0' could not be found. Attempting to find and install...\n    default: Box Provider: virtualbox\n    default: Box Version: >= 0\n==> default: Loading metadata for box 'niwashun/centos-7.0'\n    default: URL: https://vagrantcloud.com/niwashun/centos-7.0\n==> default: Adding box 'niwashun/centos-7.0' (v0.0.1) for provider: virtualbox\n    default: Downloading: https://vagrantcloud.com/niwashun/boxes/centos-7.0/versions/0.0.1/providers/virtualbox.box\nThe \"metadata.json\" file for the box 'niwashun/centos-7.0' was not found.\nBoxes require this file in order for Vagrant to determine the\nprovider it was made for. If you made the box, please add a\n\"metadata.json\" file to it. If someone else made the box, please\nnotify the box creator that the box is corrupt. Documentation for\nbox file format can be found at the URL below:\n\nhttp://docs.vagrantup.com/v2/boxes/format.html\n```\n\n\u30fb\u30fb\u30fb\uff01\n\u3067\u3001\u3067\u304d\u306d\u3047\u30c3\uff01\uff1f\n\n[Missing metadata.json (Packer (push) -> ATLAS (build) -> Vagrant (download)) #2090](https://github.com/mitchellh/packer/issues/2090)\n\n\u3050\u3075\u3049\n\n## \u53c2\u8003\n\n[Packer in Atlas: Automate the Building and Managing of Vagrant Boxes and Machine Images](https://hashicorp.com/blog/atlas-packer-vagrant.html)\n\n"}