{"context": " More than 1 year has passed since last update.http://jawsug-cli.doorkeeper.jp/events/15122 \u3067\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599\u3067\u3059\u3002\nhttp://qiita.com/tcsh/items/41e1aa3c77c469c92e84 \u3067\u69cb\u7bc9\u3057\u305fVPC\u4e0a\u306b\u3001AWS CLI\u3092\u5229\u7528\u3057\u3066EC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n(\u4e0a\u8a18\u8a18\u4e8b\u4e2d\u3067\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u74b0\u5883\u5909\u6570\u3001\u30b7\u30a7\u30eb\u5909\u6570\u304c\u4e0b\u8a18\u306e\u624b\u9806\u3067\u306f\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002)\n\u4eca\u56de\u306f\u3001EC2\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u773a\u3081\u306a\u304c\u3089\u4f5c\u696d\u3059\u308b\u3068\u3001CLI\u3067\u306e\u4f5c\u696d\u306e\u610f\u5473\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u524d\u63d0\u6761\u4ef6\n\nEC2\u306b\u3064\u3044\u3066\u30d5\u30eb\u6a29\u9650\u304c\u3042\u308b\u3002\nhttp://qiita.com/tcsh/items/41e1aa3c77c469c92e84 \u306e\u624b\u9806\u3092\u5b9f\u65bd\u3057\u3066\u3044\u308b\u3002(\u5909\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b)\n\n\n0. \u4e8b\u524d\u78ba\u8a8d\n\n\u7a3c\u52d5\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u3001\u624b\u9806\u306e\u6700\u5f8c\u306b\u5168\u3066\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n\u5fc5\u305a\u3001\u540c\u4e00\u30ea\u30fc\u30b8\u30e7\u30f3\u3001\u540c\u4e00VPC\u3067\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-instances --filters Name=vpc-id,Values=${VPC_ID} Name=instance-state-name,Values=running\n\n\n\n\u7d50\u679c\n   {\n     \"Reservations\": []\n   }\n\n\n\n1. \u30ad\u30fc\u30da\u30a2\u306e\u4f5c\u6210\n\n\u30ad\u30fc\u30da\u30a2\u306e\u78ba\u8a8d\nEC2\u306e\u30ad\u30fc\u30da\u30a2\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-key-pairs\n\n\n\n\u7d50\u679c\n   {\n     \"KeyPairs\": []\n   }\n\n\n\n\u30ad\u30fc\u30da\u30a2\u306e\u4f5c\u6210\n\u30ad\u30fc\u30da\u30a2\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u30ad\u30fc\u30da\u30a2\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n(\u30ad\u30fc\u30da\u30a2\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3082\u3001\u4ee5\u4e0b\u306e\u624b\u9806\u3092\u30b9\u30e0\u30fc\u30ba\u306b\u884c\u3046\u305f\u3081\u306b\u3001\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u7528\u306e\u30ad\u30fc\u30da\u30a2\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3092\u304a\u5968\u3081\u3057\u307e\u3059\u3002)\n\n\u30b3\u30de\u30f3\u30c9\n   $ EC2_KEY_NAME=\"${AWS_DEFAULT_REGION}-prject01\"\n   $ FILE_SSH_KEY=\"${HOME}/.ssh/${EC2_KEY_NAME}.pem\"\n   $ aws ec2 create-key-pair --key-name ${EC2_KEY_NAME} --query 'KeyMaterial' --output text > ${FILE_SSH_KEY}; cat ${FILE_SSH_KEY}\n   $ chmod 400 ${FILE_SSH_KEY}\n\n\n\n\u30ad\u30fc\u30da\u30a2\u306e\u78ba\u8a8d\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-key-pairs --key-name ${EC2_KEY_NAME}\n\n\n\n\u7d50\u679c\n   {\n     \"KeyPairs\": [\n         {\n             \"KeyName\": \"ap-northeast-1-prject01\",\n             \"KeyFingerprint\": \"XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX\"\n         }\n     ]\n   }\n\n\n\n2. AMI\u30a4\u30e1\u30fc\u30b8\u306e\u9078\u629e\n\nAmazon Linux\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u6c7a\u5b9a\nAmazon Linux\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6c7a\u5b9a\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9(\u4f8b)\n   $ EC2_AMI_VERSION='2015.03.0'\n\n\n\nAMI ID\u306e\u53d6\u5f97\n\u305d\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u5229\u7528\u53ef\u80fd\u306aAmazon Linux\u306eAMI ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9(\u4f8b)\n   $ EC2_AMI_ID=`aws ec2 describe-images --owners amazon --filters Name=description,Values=\"Amazon Linux AMI ${EC2_AMI_VERSION} x86_64 HVM EBS\" --query 'Images[].ImageId' --output text`; echo ${EC2_AMI_ID}\n\n\n\n3. Private\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5 (Subnet01)\n\u6700\u521d\u306b\u3001Private\u30b5\u30d6\u30cd\u30c3\u30c8\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4e0a\u3052\u3066\u307f\u307e\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306e\u6c7a\u5b9a\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u3092\u6c7a\u5b9a\u3057\u307e\u3059\u3002\n(\u3053\u3053\u3067\u306f\u7121\u6599\u67a0\u3067\u3082\u5229\u7528\u3067\u304d\u308bt2.micro\u3092\u9078\u629e\u3057\u307e\u3059\u3002)\n\n\u30b3\u30de\u30f3\u30c9\n   $ EC2_INSTANCE_TYPE='t2.micro'\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u8d77\u52d5\nPrivate\u30b5\u30d6\u30cd\u30c3\u30c8\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 run-instances \\\n       --image-id ${EC2_AMI_ID} \\\n       --instance-type ${EC2_INSTANCE_TYPE} \\\n       --key-name ${EC2_KEY_NAME} \\\n       --security-group-ids ${VPC_SG_ID} \\\n       --subnet-id ${VPC_NET01_ID}\n\n\n\n\u7d50\u679c\n   {\n     \"OwnerId\": \"XXXXXXXXXXXX\",\n     \"ReservationId\": \"r-XXXXXXXX\",\n     \"Groups\": [],\n     \"Instances\": [\n         {\n             \"Monitoring\": {\n                 \"State\": \"disabled\"\n             },\n             \"PublicDnsName\": null,\n             \"RootDeviceType\": \"ebs\",\n             \"State\": {\n                 \"Code\": 0,\n                 \"Name\": \"pending\"\n             },\n             \"EbsOptimized\": false,\n             \"LaunchTime\": \"2014-11-23T11:42:59.000Z\",\n             \"PrivateIpAddress\": \"10.192.1.XXX\",\n             \"ProductCodes\": [],\n             \"VpcId\": \"vpc-XXXXXXXX\",\n             \"StateTransitionReason\": null,\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"ImageId\": \"ami-b5a7ea85\",\n             \"PrivateDnsName\": \"ip-10-192-1-XXX.ap-northeast-1.compute.internal\",\n             \"KeyName\": \"ap-northeast-1-prject01\",\n             \"SecurityGroups\": [\n                 {\n                     \"GroupName\": \"SSHLoginSecurityGroup\",\n                     \"GroupId\": \"sg-XXXXXXXX\"\n                 }\n             ],\n             \"ClientToken\": null,\n             \"SubnetId\": \"subnet-XXXXXXXX\",\n             \"InstanceType\": \"t2.micro\",\n             \"NetworkInterfaces\": [\n                 {\n                     \"Status\": \"in-use\",\n                     \"MacAddress\": \"XX:XX:XX:XX:XX:XX\",\n                     \"SourceDestCheck\": true,\n                     \"VpcId\": \"vpc-XXXXXXXX\",\n                     \"Description\": null,\n                     \"NetworkInterfaceId\": \"eni-XXXXXXXX\",\n                     \"PrivateIpAddresses\": [\n                         {\n                             \"Primary\": true,\n                             \"PrivateIpAddress\": \"10.192.1.XXX\"\n                         }\n                     ],\n                     \"Attachment\": {\n                         \"Status\": \"attaching\",\n                         \"DeviceIndex\": 0,\n                         \"DeleteOnTermination\": true,\n                         \"AttachmentId\": \"eni-attach-XXXXXXXX\",\n                         \"AttachTime\": \"2014-11-23T11:42:59.000Z\"\n                     },\n                     \"Groups\": [\n                         {\n                             \"GroupName\": \"SSHLoginSecurityGroup\",\n                             \"GroupId\": \"sg-XXXXXXXX\"\n                         }\n                     ],\n                     \"SubnetId\": \"subnet-XXXXXXXX\",\n                     \"OwnerId\": \"XXXXXXXXXXXX\",\n                     \"PrivateIpAddress\": \"10.192.1.XXX\"\n                 }\n             ],\n             \"SourceDestCheck\": true,\n             \"Placement\": {\n                 \"Tenancy\": \"default\",\n                 \"GroupName\": null,\n                 \"AvailabilityZone\": \"ap-northeast-1a\"\n             },\n             \"Hypervisor\": \"xen\",\n             \"BlockDeviceMappings\": [],\n             \"Architecture\": \"x86_64\",\n             \"StateReason\": {\n                 \"Message\": \"pending\",\n                 \"Code\": \"pending\"\n             },\n             \"RootDeviceName\": \"/dev/xvda\",\n             \"VirtualizationType\": \"hvm\",\n             \"AmiLaunchIndex\": 0\n         }\n     ]\n   }\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u306e\u53d6\u5f97\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ VPC_NET01_INSTANCES=`aws ec2 describe-instances --filter Name=subnet-id,Values=${VPC_NET01_ID} --query 'Reservations[].Instances[].InstanceId' --output text`; echo ${VPC_NET01_INSTANCES}\n\n\n\n\u7d50\u679c\n   i-XXXXXXXX\n\n\n\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9\u306e\u53d6\u5f97\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\u30a2\u30c9\u30ec\u30b9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u3001\u306e\u3061\u307b\u3069Public\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089SSH\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3068\u304d\u306b\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ VPC_NET01_INSTANCE_ADDR=`aws ec2 describe-instances --filter Name=subnet-id,Values=${VPC_NET01_ID} --query 'Reservations[].Instances[].PrivateIpAddress' --output text`; echo ${VPC_NET01_INSTANCE_ADDR}\n\n\n\n\u7d50\u679c\n   10.192.1.XXX\n\n\n\u30ce\u30fc\u30c8: \u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u3001Subnet03\u3067\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u306f\u884c\u3044\u307e\u305b\u3093\u3002 (Subnet01\u3068\u540c\u3058\u624b\u9806\u306e\u305f\u3081)\n\n4. Public\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5 (Subnet11)\n\u7d9a\u3044\u3066\u3001Public\u30b5\u30d6\u30cd\u30c3\u30c8\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u3053\u306e\u30b5\u30d6\u30cd\u30c3\u30c8\u306f\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u6642\u306bPublicIP\u30a2\u30c9\u30ec\u30b9\u304c\u81ea\u52d5\u7684\u306b\u4ed8\u304b\u306a\u3044\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u308b\u306e\u3067\u3001EIP\u3092\u624b\u52d5\u3067\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001VPC\u5185\u306b\u8d77\u52d5\u3055\u308c\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304cDNS\u30db\u30b9\u30c8\u540d\u3092\u53d6\u5f97\u3057\u306a\u3044\u8a2d\u5b9a\u3067\u8d77\u52d5\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u8d77\u52d5\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 run-instances \\\n       --image-id ${EC2_AMI_ID} \\\n       --instance-type ${EC2_INSTANCE_TYPE} \\\n       --key-name ${EC2_KEY_NAME} \\\n       --security-group-ids ${VPC_SG_ID} \\\n       --subnet-id ${VPC_NET11_ID}\n\n\n\n\u7d50\u679c\n   {\n     \"OwnerId\": \"XXXXXXXXXXXX\",\n     \"ReservationId\": \"r-XXXXXXXX\",\n     \"Groups\": [],\n     \"Instances\": [\n         {\n             \"Monitoring\": {\n                 \"State\": \"disabled\"\n             },\n             \"PublicDnsName\": null,\n             \"RootDeviceType\": \"ebs\",\n             \"State\": {\n                 \"Code\": 0,\n                 \"Name\": \"pending\"\n             },\n             \"EbsOptimized\": false,\n             \"LaunchTime\": \"2014-11-23T09:26:44.000Z\",\n             \"PrivateIpAddress\": \"10.192.129.XX\",\n             \"ProductCodes\": [],\n             \"VpcId\": \"vpc-XXXXXXXX\",\n             \"StateTransitionReason\": null,\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"ImageId\": \"ami-XXXXXXXX\",\n             \"PrivateDnsName\": \"ip-10-192-129-XX.ap-northeast-1.compute.internal\",\n             \"KeyName\": \"ap-northeast-1-prject01\",\n             \"SecurityGroups\": [\n                 {\n                     \"GroupName\": \"SSHLoginSecurityGroup\",\n                     \"GroupId\": \"sg-XXXXXXXX\"\n                 }\n             ],\n             \"ClientToken\": null,\n             \"SubnetId\": \"subnet-XXXXXXXX\",\n             \"InstanceType\": \"t2.micro\",\n             \"NetworkInterfaces\": [\n                 {\n                     \"Status\": \"in-use\",\n                     \"MacAddress\": \"XX:XX:XX:XX:XX:XX\",\n                     \"SourceDestCheck\": true,\n                     \"VpcId\": \"vpc-XXXXXXXX\",\n                     \"Description\": null,\n                     \"NetworkInterfaceId\": \"eni-XXXXXXXX\",\n                     \"PrivateIpAddresses\": [\n                         {\n                             \"Primary\": true,\n                             \"PrivateIpAddress\": \"10.192.129.XX\"\n                         }\n                     ],\n                     \"Attachment\": {\n                         \"Status\": \"attaching\",\n                         \"DeviceIndex\": 0,\n                         \"DeleteOnTermination\": true,\n                         \"AttachmentId\": \"eni-attach-XXXXXXXX\",\n                         \"AttachTime\": \"2014-11-23T09:26:44.000Z\"\n                     },\n                     \"Groups\": [\n                         {\n                             \"GroupName\": \"SSHLoginSecurityGroup\",\n                             \"GroupId\": \"sg-XXXXXXXX\"\n                         }\n                     ],\n                     \"SubnetId\": \"subnet-XXXXXXXX\",\n                     \"OwnerId\": \"XXXXXXXXXXXX\",\n                     \"PrivateIpAddress\": \"10.192.129.XX\"\n                 }\n             ],\n             \"SourceDestCheck\": true,\n             \"Placement\": {\n                 \"Tenancy\": \"default\",\n                 \"GroupName\": null,\n                 \"AvailabilityZone\": \"ap-northeast-1a\"\n             },\n             \"Hypervisor\": \"xen\",\n             \"BlockDeviceMappings\": [],\n             \"Architecture\": \"x86_64\",\n             \"StateReason\": {\n                 \"Message\": \"pending\",\n                 \"Code\": \"pending\"\n             },\n             \"RootDeviceName\": \"/dev/xvda\",\n             \"VirtualizationType\": \"hvm\",\n             \"AmiLaunchIndex\": 0\n         }\n     ]\n   }\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u306e\u53d6\u5f97\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ VPC_NET11_INSTANCES=`aws ec2 describe-instances --filter Name=subnet-id,Values=${VPC_NET11_ID} --query 'Reservations[].Instances[].InstanceId' --output text`; echo ${VPC_NET11_INSTANCES}\n\n\n\nEIP\u306e\u78ba\u8a8d\n\u65e2\u306b\u5272\u308a\u5f53\u3066\u3092\u53d7\u3051\u3066\u3044\u308bPublicIP\u30a2\u30c9\u30ec\u30b9\u304c\u306a\u3044\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n(\u3082\u3057EIP\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u95a2\u9023\u4ed8\u3051\u3057\u3066\u3044\u306a\u3044\u3082\u306e\u304c\u3042\u308b\u3068\u3001\u975e\u5229\u7528\u306b\u3088\u308b\u8ab2\u91d1\u304c\u767a\u751f\u3057\u3066\u3044\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002)\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-addresses\n\n\n\n\u7d50\u679c\n   {\n     \"Addresses\": []\n   }\n\n\n\nEIP\u306e\u4f5c\u6210\nPublicIP\u30a2\u30c9\u30ec\u30b9(Elastic IP Address)\u306e\u5272\u308a\u5f53\u3066\u3092\u53d7\u3051\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 allocate-address\n\n\n\n\u7d50\u679c\n   {\n     \"PublicIp\": \"aaa.bbb.ccc.ddd\",\n     \"Domain\": \"vpc\",\n     \"AllocationId\": \"eipalloc-XXXXXXXX\"\n   }\n\n\n\nEIP ID\u306e\u53d6\u5f97\n\u672a\u95a2\u9023\u4ed8\u3051\u306e(\u3055\u304d\u307b\u3069\u5272\u308a\u5f53\u3066\u3092\u53d7\u3051\u305f)PublicIP\u30a2\u30c9\u30ec\u30b9\u306eEIP\u5272\u5f53\u3066ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ EC2_EIP_ID=`aws ec2 describe-addresses | jq -r '.Addresses[] | select(has(\"AssociationId\") | not).AllocationId'`; echo ${EC2_EIP_ID}\n\n\n\n\u7d50\u679c\n   eipalloc-XXXXXXXX\n\n\n\nEIP\u306e\u95a2\u9023\u4ed8\u3051\nEIP\u3092EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 associate-address --allocation-id ${EC2_EIP_ID} --instance-id ${VPC_NET11_INSTANCES}\n\n\n\n\u7d50\u679c\n   {\n     \"AssociationId\": \"eipassoc-8bfbbaee\"\n   }\n\n\n\nEIP\u306e\u78ba\u8a8d\nEIP\u304cEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u95a2\u9023\u4ed8\u3051\u3089\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-addresses --allocation-ids ${EC2_EIP_ID}\n\n\n\n\u7d50\u679c\n   {\n     \"Addresses\": [\n         {\n             \"Domain\": \"vpc\",\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"NetworkInterfaceId\": \"eni-XXXXXXXX\",\n             \"AssociationId\": \"eipassoc-XXXXXXXX\",\n             \"NetworkInterfaceOwnerId\": \"XXXXXXXXXXXX\",\n             \"PublicIp\": \"aaa.bbb.ccc.ddd\",\n             \"AllocationId\": \"eipalloc-XXXXXXXX\",\n             \"PrivateIpAddress\": \"10.192.129.XX\"\n         }\n     ]\n   }\n\n\n\nEIP\u306e\u30a2\u30c9\u30ec\u30b9\u53d6\u5f97\nEIP\u304c\u6301\u3064\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u3001\u306e\u3061\u307b\u3069EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3068\u304d\u306b\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ EC2_EIP_ADDR=`aws ec2 describe-addresses --allocation-ids ${EC2_EIP_ID} --query 'Addresses[].PublicIp' --output text`; echo ${EC2_EIP_ADDR}\n\n\n\n\u7d50\u679c\n   aaa.bbb.ccc.ddd\n\n\n\n\u30ed\u30b0\u30a4\u30f3 (Public\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9 NET11)\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ ssh -i ${FILE_SSH_KEY} ec2-user@${EC2_EIP_ADDR}\n\n\n\n\u7d50\u679c\n   The authenticity of host 'aaa.bbb.ccc.ddd (aaa.bbb.ccc.ddd)' can't be established.\n   RSA key fingerprint is XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX.\n   Are you sure you want to continue connecting (yes/no)?\n\n\n\n\u5165\u529b\n   yes(Enter)\n\n\n\n\u7d50\u679c\n   Warning: Permanently added 'aaa.bbb.ccc.ddd' (RSA) to the list of known hosts.\n\n        __|  __|_  )\n        _|  (     /   Amazon Linux AMI\n       ___|\\___|___|\n\n   https://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n   [ec2-user@ip-10-192-129-XX ~]$\n\n\n\u3053\u308c\u3067Public\u30b5\u30d6\u30cd\u30c3\u30c8\u3067\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3057\u305f\u3002\n\u7d9a\u3044\u3066\u3001\u3055\u304d\u307b\u3069Private\u30b5\u30d6\u30cd\u30c3\u30c8\u3067\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u3088\u3046\u306b\u30ad\u30fc\u30da\u30a2\u3092\u3053\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u8ee2\u9001\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9(\u30ed\u30fc\u30ab\u30eb\u306e\u30bf\u30fc\u30df\u30ca\u30eb)\n   $ scp -i ${FILE_SSH_KEY} ${FILE_SSH_KEY} ec2-user@${EC2_EIP_ADDR}:.ssh/\n\n\n\n\u7d50\u679c\n   ap-northeast-1-prject01.pem                                100% 1675     1.6KB/s   00:00\n\n\n\n\u30ed\u30b0\u30a4\u30f3 (Private\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9 NET01)\n\u30ad\u30fc\u30da\u30a2\u3092\u8ee2\u9001\u3057\u305f\u3089\u3001\u65e9\u901fPublic\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u3001Private\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   [ec2-user@ip-10-192-129-XX ~]$ export AWS_DEFAULT_REGION='ap-northeast-1'\n   [ec2-user@ip-10-192-129-XX ~]$ EC2_KEY_NAME=\"${AWS_DEFAULT_REGION}-prject01\"\n   [ec2-user@ip-10-192-129-XX ~]$ FILE_SSH_KEY=\"${HOME}/.ssh/${EC2_KEY_NAME}.pem\"\n   [ec2-user@ip-10-192-129-XX ~]$ VPC_NET01_INSTANCE_ADDR='${Subnet01\u3067\u8d77\u52d5\u3057\u305f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9}'\n\n\n\u30ce\u30fc\u30c8: \u300cSubnet01\u3067\u8d77\u52d5\u3057\u305f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9\u300d\u306e\u78ba\u8a8d\u65b9\u6cd5\u30ed\u30fc\u30ab\u30eb\u306e\u30bf\u30fc\u30df\u30ca\u30eb:\n\n\u30b3\u30de\u30f3\u30c9\n     echo ${VPC_NET01_INSTANCE_ADDR}\n\n\n\n\u7d50\u679c\n    10.192.1.XXX\n\n\nSSH\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   [ec2-user@ip-10-192-129-XX ~]$ ssh -i ${FILE_SSH_KEY} ec2-user@${VPC_NET01_INSTANCE_ADDR}\n\n\n\n\u7d50\u679c\n   The authenticity of host '10.192.1.XXX (10.192.1.XXX)' can't be established.\n   RSA key fingerprint is XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX.\n   Are you sure you want to continue connecting (yes/no)?\n\n\n\n\u5165\u529b\n   yes(Enter)\n\n\n\n\u7d50\u679c\n   Warning: Permanently added '10.192.1.XXX' (RSA) to the list of known hosts.\n\n        __|  __|_  )\n        _|  (     /   Amazon Linux AMI\n       ___|\\___|___|\n\n   https://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n   [ec2-user@ip-10-192-1-XXX ~]$\n\n\n\u3053\u308c\u3067Private\u30b5\u30d6\u30cd\u30c3\u30c8\u3067\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3057\u305f\u3002\nPrivate\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   [ec2-user@ip-10-192-1-XXX ~]$ exit\n\n\n\n\u7d50\u679c\n   [ec2-user@ip-10-192-129-XX ~]$\n\n\nPublic\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   [ec2-user@ip-10-192-129-XX ~]$ exit\n\n\n\n\u7d50\u679c\n   $\n\n\n\n5. \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5(Subnet13)\n\u6700\u5f8c\u306b\u3001Public\u30b5\u30d6\u30cd\u30c3\u30c8\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u3082\u3046\u4e00\u3064\u8d77\u52d5\u3057\u307e\u3059\u3002\n\u3053\u306e\u30b5\u30d6\u30cd\u30c3\u30c8\u306f\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u6642\u306bPublicIP\u30a2\u30c9\u30ec\u30b9\u304c\u81ea\u52d5\u7684\u306b\u4ed8\u304f\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u308b\u306e\u3067\u3001EIP\u306e\u624b\u52d5\u8ffd\u52a0\u624b\u9806\u306f\u4e0d\u8981\u3067\u3059\u3002\n\u4eca\u56de\u306fVPC\u306e\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3044\u3001VPC\u5185\u306b\u8d77\u52d5\u3055\u308c\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304cDNS\u30db\u30b9\u30c8\u540d\u3092\u53d6\u5f97\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3001\u6319\u52d5\u306e\u9055\u3044\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\nVPC\u306e\u8a2d\u5b9a\u5909\u66f4 (DNS\u30db\u30b9\u30c8\u540d\u6709\u52b9\u5316)\n\n-[ VPC(DNS\u30db\u30b9\u30c8\u540d)\u8a2d\u5b9a\u306e\u78ba\u8a8d ]-\n\u307e\u305a\u3001\u73fe\u5728\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067false\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-vpc-attribute --vpc-id ${VPC_ID} --attribute enableDnsHostnames\n\n\n\n\u7d50\u679c\n   {\n     \"VpcId\": \"vpc-4865b82d\",\n     \"EnableDnsHostnames\": {\n         \"Value\": false\n     }\n   }\n\n\n\n-[ VPC(DNS\u30db\u30b9\u30c8\u540d)\u8a2d\u5b9a\u306e\u6709\u52b9\u5316 ]-\nDNS\u30db\u30b9\u30c8\u540d\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 modify-vpc-attribute --vpc-id ${VPC_ID} --enable-dns-hostnames\n\n\n\n\u7d50\u679c\n   (\u623b\u308a\u5024\u306a\u3057)\n\n\n\n-[ VPC(DNS\u30db\u30b9\u30c8\u540d)\u8a2d\u5b9a\u306e\u78ba\u8a8d ]-\n\u5909\u66f4\u5f8c\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-vpc-attribute --vpc-id ${VPC_ID} --attribute enableDnsHostnames\n\n\n\n\u7d50\u679c\n   {\n     \"VpcId\": \"vpc-4865b82d\",\n     \"EnableDnsHostnames\": {\n         \"Value\": true\n     }\n   }\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u8d77\u52d5\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 run-instances \\\n     --image-id ${EC2_AMI_ID} \\\n     --instance-type ${EC2_INSTANCE_TYPE} \\\n     --key-name ${EC2_KEY_NAME} \\\n     --security-group-ids ${VPC_SG_ID} \\\n     --subnet-id ${VPC_NET13_ID}\n\n\n\n\u7d50\u679c\n   {\n     \"OwnerId\": \"XXXXXXXXXXXX\",\n     \"ReservationId\": \"r-XXXXXXXX\",\n     \"Groups\": [],\n     \"Instances\": [\n         {\n             \"Monitoring\": {\n                 \"State\": \"disabled\"\n             },\n             \"PublicDnsName\": null,\n             \"RootDeviceType\": \"ebs\",\n             \"State\": {\n                 \"Code\": 0,\n                 \"Name\": \"pending\"\n             },\n             \"EbsOptimized\": false,\n             \"LaunchTime\": \"2014-11-23T12:18:59.000Z\",\n             \"PrivateIpAddress\": \"10.192.131.XX\",\n             \"ProductCodes\": [],\n             \"VpcId\": \"vpc-XXXXXXXX\",\n             \"StateTransitionReason\": null,\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"ImageId\": \"ami-XXXXXXXX\",\n             \"PrivateDnsName\": \"ip-10-192-131-XX.ap-northeast-1.compute.internal\",\n             \"KeyName\": \"ap-northeast-1-prject01\",\n             \"SecurityGroups\": [\n                 {\n                     \"GroupName\": \"SSHLoginSecurityGroup\",\n                     \"GroupId\": \"sg-XXXXXXXX\"\n                 }\n             ],\n             \"ClientToken\": null,\n             \"SubnetId\": \"subnet-XXXXXXXX\",\n             \"InstanceType\": \"t2.micro\",\n             \"NetworkInterfaces\": [\n                 {\n                     \"Status\": \"in-use\",\n                     \"MacAddress\": \"XX:XX:XX:XX:XX:XX\",\n                     \"SourceDestCheck\": true,\n                     \"VpcId\": \"vpc-XXXXXXXX\",\n                     \"Description\": null,\n                     \"NetworkInterfaceId\": \"eni-XXXXXXXX\",\n                     \"PrivateIpAddresses\": [\n                         {\n                             \"PrivateDnsName\": \"ip-10-192-131-XX.ap-northeast-1.compute.internal\",\n                             \"Primary\": true,\n                             \"PrivateIpAddress\": \"10.192.131.XX\"\n                         }\n                     ],\n                     \"PrivateDnsName\": \"ip-10-192-131-XX.ap-northeast-1.compute.internal\",\n                     \"Attachment\": {\n                         \"Status\": \"attaching\",\n                         \"DeviceIndex\": 0,\n                         \"DeleteOnTermination\": true,\n                         \"AttachmentId\": \"eni-attach-XXXXXXXX\",\n                         \"AttachTime\": \"2014-11-23T12:18:59.000Z\"\n                     },\n                     \"Groups\": [\n                         {\n                             \"GroupName\": \"SSHLoginSecurityGroup\",\n                             \"GroupId\": \"sg-XXXXXXXX\"\n                         }\n                     ],\n                     \"SubnetId\": \"subnet-XXXXXXXX\",\n                     \"OwnerId\": \"XXXXXXXXXXXX\",\n                     \"PrivateIpAddress\": \"10.192.131.XX\"\n                 }\n             ],\n             \"SourceDestCheck\": true,\n             \"Placement\": {\n                 \"Tenancy\": \"default\",\n                 \"GroupName\": null,\n                 \"AvailabilityZone\": \"ap-northeast-1c\"\n             },\n             \"Hypervisor\": \"xen\",\n             \"BlockDeviceMappings\": [],\n             \"Architecture\": \"x86_64\",\n             \"StateReason\": {\n                 \"Message\": \"pending\",\n                 \"Code\": \"pending\"\n             },\n             \"RootDeviceName\": \"/dev/xvda\",\n             \"VirtualizationType\": \"hvm\",\n             \"AmiLaunchIndex\": 0\n         }\n     ]\n   }\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u306e\u53d6\u5f97\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ VPC_NET13_INSTANCES=`aws ec2 describe-instances --filter Name=subnet-id,Values=${VPC_NET13_ID} --query 'Reservations[].Instances[].InstanceId' --output text`; echo ${VPC_NET13_INSTANCES}\n\n\n\nPublicDnsName\u306e\u53d6\u5f97\n\u5b9f\u969b\u306ePublic DNS\u540d\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ VPC_NET13_INSTANCE_NAME_PUBLIC=`aws ec2 describe-instances --instance-ids ${VPC_NET13_INSTANCES} --query 'Reservations[].Instances[].PublicDnsName' --output text`; echo ${VPC_NET13_INSTANCE_NAME_PUBLIC}\n\n\n\n\u7d50\u679c\n   ec2-aaa-bbb-ccc-ddd.ap-northeast-1.compute.amazonaws.com\n\n\n\n\u30ed\u30b0\u30a4\u30f3\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u3001Public DNS\u540d\u3092\u6307\u5b9a\u3057\u3066SSH\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ ssh -i ${FILE_SSH_KEY} ec2-user@${VPC_NET13_INSTANCE_NAME_PUBLIC}\n\n\n\n\u7d50\u679c\n   The authenticity of host 'ec2-aaa-bbb-ccc-ddd.ap-northeast-1.compute.amazonaws.com (aaa.bbb.ccc.ddd)' can't be established.\n   RSA key fingerprint is XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX.\n   Are you sure you want to continue connecting (yes/no)?\n\n\n\n\u5165\u529b\n   yes(Enter)\n\n\n\n\u7d50\u679c\n   Warning: Permanently added 'ec2-aaa-bbb-ccc-ddd.ap-northeast-1.compute.amazonaws.com,aaa.bbb.ccc.ddd' (RSA) to the list of known hosts.\n\n          __|  __|_  )\n          _|  (     /   Amazon Linux AMI\n         ___|\\___|___|\n\n   https://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n   10 package(s) needed for security, out of 24 available\n   Run \"sudo yum update\" to apply all updates.\n   [ec2-user@ip-10-192-131-90 ~]$\n\n\n\u3053\u308c\u3067Public\u30b5\u30d6\u30cd\u30c3\u30c8\u3067\u8d77\u52d5\u3057\u305f2\u3064\u76ee\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3057\u305f\u3002\n\n6. \u5168\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u7d42\u4e86\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8907\u6570\u8d77\u52d5\u3057\u305f\u307e\u307e\u3060\u3068\u3001\u7121\u6599\u67a0\u3092\u8d85\u3048\u3066\u8ab2\u91d1\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u4eca\u56de\u306eVPC\u4e0a\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u5168\u3066\u7d42\u4e86\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u7a3c\u52d5\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u53d6\u5f97\n\u307e\u305a\u3001VPC\u4e0a\u3067\u7a3c\u52d5\u3057\u3066\u3044\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ ARRAY_EC2_INSTANCES=`aws ec2 describe-instances --filters Name=instance-state-name,Values=running --query 'Reservations[].Instances[].InstanceId' --output text`; echo ${ARRAY_EC2_INSTANCES}\n\n\n\n\u7d50\u679c\n   i-XXXXXXXX i-YYYYYYYY i-ZZZZZZZZ\n\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\nVPC\u4e0a\u3067\u7a3c\u52d5\u3057\u3066\u3044\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-instance-status --instance-ids ${ARRAY_EC2_INSTANCES} --query 'InstanceStatuses[].[InstanceId,InstanceState.Name]' --output table\n\n\n\n\u7d50\u679c\n   ---------------------------\n   | DescribeInstanceStatus  |\n   +-------------+-----------+\n   |  i-XXXXXXXX |  running  |\n   |  i-YYYYYYYY |  running  |\n   |  i-ZZZZZZZZ |  running  |\n   +-------------+-----------+\n\n\n\n\u7a3c\u52d5\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u7d42\u4e86\n\u30b9\u30c6\u30fc\u30bf\u30b9\u304crunning\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u5168\u3066\u7d42\u4e86\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 terminate-instances --instance-ids ${ARRAY_EC2_INSTANCES}\n\n\n\n\u7d50\u679c\n   {\n     \"TerminatingInstances\": [\n         {\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"CurrentState\": {\n                 \"Code\": 32,\n                 \"Name\": \"shutting-down\"\n             },\n             \"PreviousState\": {\n                 \"Code\": 16,\n                 \"Name\": \"running\"\n             }\n         },\n         {\n             \"InstanceId\": \"i-YYYYYYYY\",\n             \"CurrentState\": {\n                 \"Code\": 32,\n                 \"Name\": \"shutting-down\"\n             },\n             \"PreviousState\": {\n                 \"Code\": 16,\n                 \"Name\": \"running\"\n             }\n         },\n         {\n             \"InstanceId\": \"i-ZZZZZZZZ\",\n             \"CurrentState\": {\n                 \"Code\": 32,\n                 \"Name\": \"shutting-down\"\n             },\n             \"PreviousState\": {\n                 \"Code\": 16,\n                 \"Name\": \"running\"\n             }\n         }\n     ]\n   }\n\n\n\n\u5bfe\u8c61\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u7d42\u4e86\u78ba\u8a8d\n\u7d42\u4e86\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5168\u3066\u7d42\u4e86\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-instances --instance-ids ${ARRAY_EC2_INSTANCES} \\\n     --query 'Reservations[].Instances[].[InstanceId,State.Name]' --output table\n\n\n\n\u7d50\u679c\n   ------------------------------\n   |      DescribeInstances     |\n   +-------------+--------------+\n   |  i-5b863a92 |  terminated  |\n   |  i-afba7759 |  terminated  |\n   |  i-d9db162f |  terminated  |\n   +-------------+--------------+\n\n\n\n\u7a3c\u52d5\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\nVPC\u4e0a\u306b\u30b9\u30c6\u30fc\u30bf\u30b9\u304crunning\u306b\u306a\u3063\u3066\u3044\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\n   $ aws ec2 describe-instances --filters Name=instance-state-name,Values=running \\\n     --query 'Reservations[].Instances[].InstanceId' --output text\n\n\n\n\u7d50\u679c\n   (\u623b\u308a\u5024\u306a\u3057)\n\n\n\nEIP\u306e\u8fd4\u5374\n\u5fd8\u308c\u305a\u306bEIP\u3092\u8fd4\u5374\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u30b3\u30de\u30f3\u30c9\n  $ aws ec2 release-address --allocation-id ${EC2_EIP_ID}\n\n\n\n\u7d50\u679c\n  (\u623b\u308a\u5024\u306a\u3057)\n\n\n\n\u30b3\u30de\u30f3\u30c9\n  $ aws ec2 describe-addresses\n\n\n\n\u7d50\u679c\n  {\n    \"Addresses\": []\n  }\n\n\n\n\u7d42\u4e86\n\u4ee5\u4e0a\u3067\u3001VPC\u4e0a\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5/\u7d42\u4e86\u3059\u308b\u30cf\u30f3\u30ba\u30aa\u30f3\u306f\u5b8c\u4e86\u3067\u3059\u3002\nhttp://jawsug-cli.doorkeeper.jp/events/15122 \u3067\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u8cc7\u6599\u3067\u3059\u3002\n\nhttp://qiita.com/tcsh/items/41e1aa3c77c469c92e84 \u3067\u69cb\u7bc9\u3057\u305fVPC\u4e0a\u306b\u3001AWS CLI\u3092\u5229\u7528\u3057\u3066EC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n(\u4e0a\u8a18\u8a18\u4e8b\u4e2d\u3067\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u74b0\u5883\u5909\u6570\u3001\u30b7\u30a7\u30eb\u5909\u6570\u304c\u4e0b\u8a18\u306e\u624b\u9806\u3067\u306f\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002)\n\n\u4eca\u56de\u306f\u3001EC2\u30de\u30cd\u30b8\u30e1\u30f3\u30c8\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u773a\u3081\u306a\u304c\u3089\u4f5c\u696d\u3059\u308b\u3068\u3001CLI\u3067\u306e\u4f5c\u696d\u306e\u610f\u5473\u304c\u308f\u304b\u308a\u3084\u3059\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n\n\u524d\u63d0\u6761\u4ef6\n========\n\n* EC2\u306b\u3064\u3044\u3066\u30d5\u30eb\u6a29\u9650\u304c\u3042\u308b\u3002\n\n* http://qiita.com/tcsh/items/41e1aa3c77c469c92e84 \u306e\u624b\u9806\u3092\u5b9f\u65bd\u3057\u3066\u3044\u308b\u3002(\u5909\u6570\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b)\n\n\n\n0. \u4e8b\u524d\u78ba\u8a8d\n===========\n\n\n\u7a3c\u52d5\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\n--------------------------------------\n\n\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u3001\u624b\u9806\u306e\u6700\u5f8c\u306b\u5168\u3066\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\n\n\u5fc5\u305a\u3001\u540c\u4e00\u30ea\u30fc\u30b8\u30e7\u30f3\u3001\u540c\u4e00VPC\u3067\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-instances --filters Name=vpc-id,Values=${VPC_ID} Name=instance-state-name,Values=running\n```\n\n```json:\u7d50\u679c:\n   {\n     \"Reservations\": []\n   }\n```\n\n\n1. \u30ad\u30fc\u30da\u30a2\u306e\u4f5c\u6210\n=================\n\n\n\u30ad\u30fc\u30da\u30a2\u306e\u78ba\u8a8d\n--------------\n\nEC2\u306e\u30ad\u30fc\u30da\u30a2\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-key-pairs\n```\n\n```json:\u7d50\u679c:\n   {\n     \"KeyPairs\": []\n   }\n```\n\n\n\u30ad\u30fc\u30da\u30a2\u306e\u4f5c\u6210\n--------------\n\n\u30ad\u30fc\u30da\u30a2\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u30ad\u30fc\u30da\u30a2\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n(\u30ad\u30fc\u30da\u30a2\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u3082\u3001\u4ee5\u4e0b\u306e\u624b\u9806\u3092\u30b9\u30e0\u30fc\u30ba\u306b\u884c\u3046\u305f\u3081\u306b\u3001\u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u7528\u306e\u30ad\u30fc\u30da\u30a2\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u3092\u304a\u5968\u3081\u3057\u307e\u3059\u3002)\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ EC2_KEY_NAME=\"${AWS_DEFAULT_REGION}-prject01\"\n   $ FILE_SSH_KEY=\"${HOME}/.ssh/${EC2_KEY_NAME}.pem\"\n   $ aws ec2 create-key-pair --key-name ${EC2_KEY_NAME} --query 'KeyMaterial' --output text > ${FILE_SSH_KEY}; cat ${FILE_SSH_KEY}\n   $ chmod 400 ${FILE_SSH_KEY}\n```\n\n\n\u30ad\u30fc\u30da\u30a2\u306e\u78ba\u8a8d\n--------------\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-key-pairs --key-name ${EC2_KEY_NAME}\n```\n\n```json:\u7d50\u679c:\n   {\n     \"KeyPairs\": [\n         {\n             \"KeyName\": \"ap-northeast-1-prject01\",\n             \"KeyFingerprint\": \"XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX\"\n         }\n     ]\n   }\n```\n\n\n2. AMI\u30a4\u30e1\u30fc\u30b8\u306e\u9078\u629e\n====================\n\n\nAmazon Linux\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u6c7a\u5b9a\n----------------------------\n\nAmazon Linux\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6c7a\u5b9a\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9(\u4f8b):\n   $ EC2_AMI_VERSION='2015.03.0'\n```\n\n\nAMI ID\u306e\u53d6\u5f97\n------------\n\n\u305d\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3067\u5229\u7528\u53ef\u80fd\u306aAmazon Linux\u306eAMI ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9(\u4f8b):\n   $ EC2_AMI_ID=`aws ec2 describe-images --owners amazon --filters Name=description,Values=\"Amazon Linux AMI ${EC2_AMI_VERSION} x86_64 HVM EBS\" --query 'Images[].ImageId' --output text`; echo ${EC2_AMI_ID}\n```\n\n\n3. Private\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5 (Subnet01)\n=====================================\n\n\u6700\u521d\u306b\u3001Private\u30b5\u30d6\u30cd\u30c3\u30c8\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4e0a\u3052\u3066\u307f\u307e\u3059\u3002\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306e\u6c7a\u5b9a\n------------------------\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u3092\u6c7a\u5b9a\u3057\u307e\u3059\u3002\n\n(\u3053\u3053\u3067\u306f\u7121\u6599\u67a0\u3067\u3082\u5229\u7528\u3067\u304d\u308bt2.micro\u3092\u9078\u629e\u3057\u307e\u3059\u3002)\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ EC2_INSTANCE_TYPE='t2.micro'\n```\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u8d77\u52d5\n------------------\n\nPrivate\u30b5\u30d6\u30cd\u30c3\u30c8\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 run-instances \\\n       --image-id ${EC2_AMI_ID} \\\n       --instance-type ${EC2_INSTANCE_TYPE} \\\n       --key-name ${EC2_KEY_NAME} \\\n       --security-group-ids ${VPC_SG_ID} \\\n       --subnet-id ${VPC_NET01_ID}\n```\n\n```json:\u7d50\u679c:\n   {\n     \"OwnerId\": \"XXXXXXXXXXXX\",\n     \"ReservationId\": \"r-XXXXXXXX\",\n     \"Groups\": [],\n     \"Instances\": [\n         {\n             \"Monitoring\": {\n                 \"State\": \"disabled\"\n             },\n             \"PublicDnsName\": null,\n             \"RootDeviceType\": \"ebs\",\n             \"State\": {\n                 \"Code\": 0,\n                 \"Name\": \"pending\"\n             },\n             \"EbsOptimized\": false,\n             \"LaunchTime\": \"2014-11-23T11:42:59.000Z\",\n             \"PrivateIpAddress\": \"10.192.1.XXX\",\n             \"ProductCodes\": [],\n             \"VpcId\": \"vpc-XXXXXXXX\",\n             \"StateTransitionReason\": null,\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"ImageId\": \"ami-b5a7ea85\",\n             \"PrivateDnsName\": \"ip-10-192-1-XXX.ap-northeast-1.compute.internal\",\n             \"KeyName\": \"ap-northeast-1-prject01\",\n             \"SecurityGroups\": [\n                 {\n                     \"GroupName\": \"SSHLoginSecurityGroup\",\n                     \"GroupId\": \"sg-XXXXXXXX\"\n                 }\n             ],\n             \"ClientToken\": null,\n             \"SubnetId\": \"subnet-XXXXXXXX\",\n             \"InstanceType\": \"t2.micro\",\n             \"NetworkInterfaces\": [\n                 {\n                     \"Status\": \"in-use\",\n                     \"MacAddress\": \"XX:XX:XX:XX:XX:XX\",\n                     \"SourceDestCheck\": true,\n                     \"VpcId\": \"vpc-XXXXXXXX\",\n                     \"Description\": null,\n                     \"NetworkInterfaceId\": \"eni-XXXXXXXX\",\n                     \"PrivateIpAddresses\": [\n                         {\n                             \"Primary\": true,\n                             \"PrivateIpAddress\": \"10.192.1.XXX\"\n                         }\n                     ],\n                     \"Attachment\": {\n                         \"Status\": \"attaching\",\n                         \"DeviceIndex\": 0,\n                         \"DeleteOnTermination\": true,\n                         \"AttachmentId\": \"eni-attach-XXXXXXXX\",\n                         \"AttachTime\": \"2014-11-23T11:42:59.000Z\"\n                     },\n                     \"Groups\": [\n                         {\n                             \"GroupName\": \"SSHLoginSecurityGroup\",\n                             \"GroupId\": \"sg-XXXXXXXX\"\n                         }\n                     ],\n                     \"SubnetId\": \"subnet-XXXXXXXX\",\n                     \"OwnerId\": \"XXXXXXXXXXXX\",\n                     \"PrivateIpAddress\": \"10.192.1.XXX\"\n                 }\n             ],\n             \"SourceDestCheck\": true,\n             \"Placement\": {\n                 \"Tenancy\": \"default\",\n                 \"GroupName\": null,\n                 \"AvailabilityZone\": \"ap-northeast-1a\"\n             },\n             \"Hypervisor\": \"xen\",\n             \"BlockDeviceMappings\": [],\n             \"Architecture\": \"x86_64\",\n             \"StateReason\": {\n                 \"Message\": \"pending\",\n                 \"Code\": \"pending\"\n             },\n             \"RootDeviceName\": \"/dev/xvda\",\n             \"VirtualizationType\": \"hvm\",\n             \"AmiLaunchIndex\": 0\n         }\n     ]\n   }\n```\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u306e\u53d6\u5f97\n--------------------\n\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ VPC_NET01_INSTANCES=`aws ec2 describe-instances --filter Name=subnet-id,Values=${VPC_NET01_ID} --query 'Reservations[].Instances[].InstanceId' --output text`; echo ${VPC_NET01_INSTANCES}\n```\n\n```text:\u7d50\u679c:\n   i-XXXXXXXX\n```\n\n\n\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9\u306e\u53d6\u5f97\n--------------------------\n\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8IP\u30a2\u30c9\u30ec\u30b9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u306f\u3001\u306e\u3061\u307b\u3069Public\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089SSH\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3068\u304d\u306b\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ VPC_NET01_INSTANCE_ADDR=`aws ec2 describe-instances --filter Name=subnet-id,Values=${VPC_NET01_ID} --query 'Reservations[].Instances[].PrivateIpAddress' --output text`; echo ${VPC_NET01_INSTANCE_ADDR}\n```\n\n```text:\u7d50\u679c:\n   10.192.1.XXX\n```\n\n\u30ce\u30fc\u30c8: \u3053\u306e\u30cf\u30f3\u30ba\u30aa\u30f3\u3067\u306f\u3001Subnet03\u3067\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u306f\u884c\u3044\u307e\u305b\u3093\u3002 (Subnet01\u3068\u540c\u3058\u624b\u9806\u306e\u305f\u3081)\n\n\n4. Public\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5 (Subnet11)\n====================================\n\n\u7d9a\u3044\u3066\u3001Public\u30b5\u30d6\u30cd\u30c3\u30c8\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u30b5\u30d6\u30cd\u30c3\u30c8\u306f\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u6642\u306bPublicIP\u30a2\u30c9\u30ec\u30b9\u304c\u81ea\u52d5\u7684\u306b\u4ed8\u304b\u306a\u3044\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u308b\u306e\u3067\u3001EIP\u3092\u624b\u52d5\u3067\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\u4eca\u56de\u306f\u3001VPC\u5185\u306b\u8d77\u52d5\u3055\u308c\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304cDNS\u30db\u30b9\u30c8\u540d\u3092\u53d6\u5f97\u3057\u306a\u3044\u8a2d\u5b9a\u3067\u8d77\u52d5\u3057\u3066\u307f\u307e\u3059\u3002\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u8d77\u52d5\n------------------\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 run-instances \\\n       --image-id ${EC2_AMI_ID} \\\n       --instance-type ${EC2_INSTANCE_TYPE} \\\n       --key-name ${EC2_KEY_NAME} \\\n       --security-group-ids ${VPC_SG_ID} \\\n       --subnet-id ${VPC_NET11_ID}\n```\n\n```json:\u7d50\u679c:\n   {\n     \"OwnerId\": \"XXXXXXXXXXXX\",\n     \"ReservationId\": \"r-XXXXXXXX\",\n     \"Groups\": [],\n     \"Instances\": [\n         {\n             \"Monitoring\": {\n                 \"State\": \"disabled\"\n             },\n             \"PublicDnsName\": null,\n             \"RootDeviceType\": \"ebs\",\n             \"State\": {\n                 \"Code\": 0,\n                 \"Name\": \"pending\"\n             },\n             \"EbsOptimized\": false,\n             \"LaunchTime\": \"2014-11-23T09:26:44.000Z\",\n             \"PrivateIpAddress\": \"10.192.129.XX\",\n             \"ProductCodes\": [],\n             \"VpcId\": \"vpc-XXXXXXXX\",\n             \"StateTransitionReason\": null,\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"ImageId\": \"ami-XXXXXXXX\",\n             \"PrivateDnsName\": \"ip-10-192-129-XX.ap-northeast-1.compute.internal\",\n             \"KeyName\": \"ap-northeast-1-prject01\",\n             \"SecurityGroups\": [\n                 {\n                     \"GroupName\": \"SSHLoginSecurityGroup\",\n                     \"GroupId\": \"sg-XXXXXXXX\"\n                 }\n             ],\n             \"ClientToken\": null,\n             \"SubnetId\": \"subnet-XXXXXXXX\",\n             \"InstanceType\": \"t2.micro\",\n             \"NetworkInterfaces\": [\n                 {\n                     \"Status\": \"in-use\",\n                     \"MacAddress\": \"XX:XX:XX:XX:XX:XX\",\n                     \"SourceDestCheck\": true,\n                     \"VpcId\": \"vpc-XXXXXXXX\",\n                     \"Description\": null,\n                     \"NetworkInterfaceId\": \"eni-XXXXXXXX\",\n                     \"PrivateIpAddresses\": [\n                         {\n                             \"Primary\": true,\n                             \"PrivateIpAddress\": \"10.192.129.XX\"\n                         }\n                     ],\n                     \"Attachment\": {\n                         \"Status\": \"attaching\",\n                         \"DeviceIndex\": 0,\n                         \"DeleteOnTermination\": true,\n                         \"AttachmentId\": \"eni-attach-XXXXXXXX\",\n                         \"AttachTime\": \"2014-11-23T09:26:44.000Z\"\n                     },\n                     \"Groups\": [\n                         {\n                             \"GroupName\": \"SSHLoginSecurityGroup\",\n                             \"GroupId\": \"sg-XXXXXXXX\"\n                         }\n                     ],\n                     \"SubnetId\": \"subnet-XXXXXXXX\",\n                     \"OwnerId\": \"XXXXXXXXXXXX\",\n                     \"PrivateIpAddress\": \"10.192.129.XX\"\n                 }\n             ],\n             \"SourceDestCheck\": true,\n             \"Placement\": {\n                 \"Tenancy\": \"default\",\n                 \"GroupName\": null,\n                 \"AvailabilityZone\": \"ap-northeast-1a\"\n             },\n             \"Hypervisor\": \"xen\",\n             \"BlockDeviceMappings\": [],\n             \"Architecture\": \"x86_64\",\n             \"StateReason\": {\n                 \"Message\": \"pending\",\n                 \"Code\": \"pending\"\n             },\n             \"RootDeviceName\": \"/dev/xvda\",\n             \"VirtualizationType\": \"hvm\",\n             \"AmiLaunchIndex\": 0\n         }\n     ]\n   }\n```\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u306e\u53d6\u5f97\n--------------------\n\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ VPC_NET11_INSTANCES=`aws ec2 describe-instances --filter Name=subnet-id,Values=${VPC_NET11_ID} --query 'Reservations[].Instances[].InstanceId' --output text`; echo ${VPC_NET11_INSTANCES}\n```\n\n\nEIP\u306e\u78ba\u8a8d\n---------\n\n\u65e2\u306b\u5272\u308a\u5f53\u3066\u3092\u53d7\u3051\u3066\u3044\u308bPublicIP\u30a2\u30c9\u30ec\u30b9\u304c\u306a\u3044\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n(\u3082\u3057EIP\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u95a2\u9023\u4ed8\u3051\u3057\u3066\u3044\u306a\u3044\u3082\u306e\u304c\u3042\u308b\u3068\u3001\u975e\u5229\u7528\u306b\u3088\u308b\u8ab2\u91d1\u304c\u767a\u751f\u3057\u3066\u3044\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002)\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-addresses\n```\n\n```json:\u7d50\u679c:\n   {\n     \"Addresses\": []\n   }\n```\n\n\nEIP\u306e\u4f5c\u6210\n---------\n\nPublicIP\u30a2\u30c9\u30ec\u30b9(Elastic IP Address)\u306e\u5272\u308a\u5f53\u3066\u3092\u53d7\u3051\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 allocate-address\n```\n\n```json:\u7d50\u679c:\n   {\n     \"PublicIp\": \"aaa.bbb.ccc.ddd\",\n     \"Domain\": \"vpc\",\n     \"AllocationId\": \"eipalloc-XXXXXXXX\"\n   }\n```\n\n\nEIP ID\u306e\u53d6\u5f97\n------------\n\n\u672a\u95a2\u9023\u4ed8\u3051\u306e(\u3055\u304d\u307b\u3069\u5272\u308a\u5f53\u3066\u3092\u53d7\u3051\u305f)PublicIP\u30a2\u30c9\u30ec\u30b9\u306eEIP\u5272\u5f53\u3066ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ EC2_EIP_ID=`aws ec2 describe-addresses | jq -r '.Addresses[] | select(has(\"AssociationId\") | not).AllocationId'`; echo ${EC2_EIP_ID}\n```\n\n```text:\u7d50\u679c:\n   eipalloc-XXXXXXXX\n```\n\n\nEIP\u306e\u95a2\u9023\u4ed8\u3051\n-------------\n\nEIP\u3092EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u95a2\u9023\u4ed8\u3051\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 associate-address --allocation-id ${EC2_EIP_ID} --instance-id ${VPC_NET11_INSTANCES}\n```\n\n```json:\u7d50\u679c:\n   {\n     \"AssociationId\": \"eipassoc-8bfbbaee\"\n   }\n```\n\n\nEIP\u306e\u78ba\u8a8d\n---------\n\nEIP\u304cEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u95a2\u9023\u4ed8\u3051\u3089\u308c\u305f\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-addresses --allocation-ids ${EC2_EIP_ID}\n```\n\n```json:\u7d50\u679c:\n   {\n     \"Addresses\": [\n         {\n             \"Domain\": \"vpc\",\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"NetworkInterfaceId\": \"eni-XXXXXXXX\",\n             \"AssociationId\": \"eipassoc-XXXXXXXX\",\n             \"NetworkInterfaceOwnerId\": \"XXXXXXXXXXXX\",\n             \"PublicIp\": \"aaa.bbb.ccc.ddd\",\n             \"AllocationId\": \"eipalloc-XXXXXXXX\",\n             \"PrivateIpAddress\": \"10.192.129.XX\"\n         }\n     ]\n   }\n```\n\n\nEIP\u306e\u30a2\u30c9\u30ec\u30b9\u53d6\u5f97\n-----------------\n\nEIP\u304c\u6301\u3064\u30b0\u30ed\u30fc\u30d0\u30ebIP\u30a2\u30c9\u30ec\u30b9\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u306f\u3001\u306e\u3061\u307b\u3069EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3068\u304d\u306b\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ EC2_EIP_ADDR=`aws ec2 describe-addresses --allocation-ids ${EC2_EIP_ID} --query 'Addresses[].PublicIp' --output text`; echo ${EC2_EIP_ADDR}\n```\n\n```text:\u7d50\u679c:\n   aaa.bbb.ccc.ddd\n```\n\n\n\u30ed\u30b0\u30a4\u30f3 (Public\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9 NET11)\n-----------------------------------\n\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ ssh -i ${FILE_SSH_KEY} ec2-user@${EC2_EIP_ADDR}\n```\n\n```text:\u7d50\u679c:\n   The authenticity of host 'aaa.bbb.ccc.ddd (aaa.bbb.ccc.ddd)' can't be established.\n   RSA key fingerprint is XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX.\n   Are you sure you want to continue connecting (yes/no)?\n```\n\n```text:\u5165\u529b:\n   yes(Enter)\n```\n\n```text:\u7d50\u679c:\n   Warning: Permanently added 'aaa.bbb.ccc.ddd' (RSA) to the list of known hosts.\n\n        __|  __|_  )\n        _|  (     /   Amazon Linux AMI\n       ___|\\___|___|\n\n   https://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n   [ec2-user@ip-10-192-129-XX ~]$\n```\n\n\u3053\u308c\u3067Public\u30b5\u30d6\u30cd\u30c3\u30c8\u3067\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u7d9a\u3044\u3066\u3001\u3055\u304d\u307b\u3069Private\u30b5\u30d6\u30cd\u30c3\u30c8\u3067\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\u3088\u3046\u306b\u30ad\u30fc\u30da\u30a2\u3092\u3053\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u8ee2\u9001\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9(\u30ed\u30fc\u30ab\u30eb\u306e\u30bf\u30fc\u30df\u30ca\u30eb):\n   $ scp -i ${FILE_SSH_KEY} ${FILE_SSH_KEY} ec2-user@${EC2_EIP_ADDR}:.ssh/\n```\n\n```text:\u7d50\u679c:\n   ap-northeast-1-prject01.pem                                100% 1675     1.6KB/s   00:00\n```\n\n\n\u30ed\u30b0\u30a4\u30f3 (Private\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9 NET01)\n------------------------------------\n\n\u30ad\u30fc\u30da\u30a2\u3092\u8ee2\u9001\u3057\u305f\u3089\u3001\u65e9\u901fPublic\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u3001Private\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   [ec2-user@ip-10-192-129-XX ~]$ export AWS_DEFAULT_REGION='ap-northeast-1'\n   [ec2-user@ip-10-192-129-XX ~]$ EC2_KEY_NAME=\"${AWS_DEFAULT_REGION}-prject01\"\n   [ec2-user@ip-10-192-129-XX ~]$ FILE_SSH_KEY=\"${HOME}/.ssh/${EC2_KEY_NAME}.pem\"\n   [ec2-user@ip-10-192-129-XX ~]$ VPC_NET01_INSTANCE_ADDR='${Subnet01\u3067\u8d77\u52d5\u3057\u305f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9}'\n```\n\n\u30ce\u30fc\u30c8: \u300cSubnet01\u3067\u8d77\u52d5\u3057\u305f\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30a2\u30c9\u30ec\u30b9\u300d\u306e\u78ba\u8a8d\u65b9\u6cd5\u30ed\u30fc\u30ab\u30eb\u306e\u30bf\u30fc\u30df\u30ca\u30eb:\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n     echo ${VPC_NET01_INSTANCE_ADDR}\n```\n\n```text:\u7d50\u679c:\n    10.192.1.XXX\n```\n\nSSH\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   [ec2-user@ip-10-192-129-XX ~]$ ssh -i ${FILE_SSH_KEY} ec2-user@${VPC_NET01_INSTANCE_ADDR}\n```\n\n```text:\u7d50\u679c:\n   The authenticity of host '10.192.1.XXX (10.192.1.XXX)' can't be established.\n   RSA key fingerprint is XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX.\n   Are you sure you want to continue connecting (yes/no)?\n```\n\n```text:\u5165\u529b:\n   yes(Enter)\n```\n\n```text:\u7d50\u679c:\n   Warning: Permanently added '10.192.1.XXX' (RSA) to the list of known hosts.\n\n        __|  __|_  )\n        _|  (     /   Amazon Linux AMI\n       ___|\\___|___|\n\n   https://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n   [ec2-user@ip-10-192-1-XXX ~]$\n```\n\n\u3053\u308c\u3067Private\u30b5\u30d6\u30cd\u30c3\u30c8\u3067\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3057\u305f\u3002\n\nPrivate\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   [ec2-user@ip-10-192-1-XXX ~]$ exit\n```\n\n```bash:\u7d50\u679c:\n   [ec2-user@ip-10-192-129-XX ~]$\n```\n\nPublic\u30b5\u30d6\u30cd\u30c3\u30c8\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304b\u3089\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   [ec2-user@ip-10-192-129-XX ~]$ exit\n```\n\n```bash:\u7d50\u679c:\n   $\n```\n\n\n5. \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5(Subnet13)\n=============================\n\n\u6700\u5f8c\u306b\u3001Public\u30b5\u30d6\u30cd\u30c3\u30c8\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u3082\u3046\u4e00\u3064\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u30b5\u30d6\u30cd\u30c3\u30c8\u306f\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u8d77\u52d5\u6642\u306bPublicIP\u30a2\u30c9\u30ec\u30b9\u304c\u81ea\u52d5\u7684\u306b\u4ed8\u304f\u8a2d\u5b9a\u3092\u3057\u3066\u3044\u308b\u306e\u3067\u3001EIP\u306e\u624b\u52d5\u8ffd\u52a0\u624b\u9806\u306f\u4e0d\u8981\u3067\u3059\u3002\n\n\u4eca\u56de\u306fVPC\u306e\u8a2d\u5b9a\u5909\u66f4\u3092\u884c\u3044\u3001VPC\u5185\u306b\u8d77\u52d5\u3055\u308c\u308b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304cDNS\u30db\u30b9\u30c8\u540d\u3092\u53d6\u5f97\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3001\u6319\u52d5\u306e\u9055\u3044\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\nVPC\u306e\u8a2d\u5b9a\u5909\u66f4 (DNS\u30db\u30b9\u30c8\u540d\u6709\u52b9\u5316)\n---------------------------------\n\n### -[ VPC(DNS\u30db\u30b9\u30c8\u540d)\u8a2d\u5b9a\u306e\u78ba\u8a8d ]-\n\n\u307e\u305a\u3001\u73fe\u5728\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u3067false\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-vpc-attribute --vpc-id ${VPC_ID} --attribute enableDnsHostnames\n```\n\n```json:\u7d50\u679c:\n   {\n     \"VpcId\": \"vpc-4865b82d\",\n     \"EnableDnsHostnames\": {\n         \"Value\": false\n     }\n   }\n```\n\n### -[ VPC(DNS\u30db\u30b9\u30c8\u540d)\u8a2d\u5b9a\u306e\u6709\u52b9\u5316 ]-\n\nDNS\u30db\u30b9\u30c8\u540d\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 modify-vpc-attribute --vpc-id ${VPC_ID} --enable-dns-hostnames\n```\n\n```text:\u7d50\u679c:\n   (\u623b\u308a\u5024\u306a\u3057)\n```\n\n### -[ VPC(DNS\u30db\u30b9\u30c8\u540d)\u8a2d\u5b9a\u306e\u78ba\u8a8d ]-\n\n\u5909\u66f4\u5f8c\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-vpc-attribute --vpc-id ${VPC_ID} --attribute enableDnsHostnames\n```\n\n```json:\u7d50\u679c:\n   {\n     \"VpcId\": \"vpc-4865b82d\",\n     \"EnableDnsHostnames\": {\n         \"Value\": true\n     }\n   }\n```\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u8d77\u52d5\n------------------\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 run-instances \\\n     --image-id ${EC2_AMI_ID} \\\n     --instance-type ${EC2_INSTANCE_TYPE} \\\n     --key-name ${EC2_KEY_NAME} \\\n     --security-group-ids ${VPC_SG_ID} \\\n     --subnet-id ${VPC_NET13_ID}\n```\n\n```json:\u7d50\u679c:\n   {\n     \"OwnerId\": \"XXXXXXXXXXXX\",\n     \"ReservationId\": \"r-XXXXXXXX\",\n     \"Groups\": [],\n     \"Instances\": [\n         {\n             \"Monitoring\": {\n                 \"State\": \"disabled\"\n             },\n             \"PublicDnsName\": null,\n             \"RootDeviceType\": \"ebs\",\n             \"State\": {\n                 \"Code\": 0,\n                 \"Name\": \"pending\"\n             },\n             \"EbsOptimized\": false,\n             \"LaunchTime\": \"2014-11-23T12:18:59.000Z\",\n             \"PrivateIpAddress\": \"10.192.131.XX\",\n             \"ProductCodes\": [],\n             \"VpcId\": \"vpc-XXXXXXXX\",\n             \"StateTransitionReason\": null,\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"ImageId\": \"ami-XXXXXXXX\",\n             \"PrivateDnsName\": \"ip-10-192-131-XX.ap-northeast-1.compute.internal\",\n             \"KeyName\": \"ap-northeast-1-prject01\",\n             \"SecurityGroups\": [\n                 {\n                     \"GroupName\": \"SSHLoginSecurityGroup\",\n                     \"GroupId\": \"sg-XXXXXXXX\"\n                 }\n             ],\n             \"ClientToken\": null,\n             \"SubnetId\": \"subnet-XXXXXXXX\",\n             \"InstanceType\": \"t2.micro\",\n             \"NetworkInterfaces\": [\n                 {\n                     \"Status\": \"in-use\",\n                     \"MacAddress\": \"XX:XX:XX:XX:XX:XX\",\n                     \"SourceDestCheck\": true,\n                     \"VpcId\": \"vpc-XXXXXXXX\",\n                     \"Description\": null,\n                     \"NetworkInterfaceId\": \"eni-XXXXXXXX\",\n                     \"PrivateIpAddresses\": [\n                         {\n                             \"PrivateDnsName\": \"ip-10-192-131-XX.ap-northeast-1.compute.internal\",\n                             \"Primary\": true,\n                             \"PrivateIpAddress\": \"10.192.131.XX\"\n                         }\n                     ],\n                     \"PrivateDnsName\": \"ip-10-192-131-XX.ap-northeast-1.compute.internal\",\n                     \"Attachment\": {\n                         \"Status\": \"attaching\",\n                         \"DeviceIndex\": 0,\n                         \"DeleteOnTermination\": true,\n                         \"AttachmentId\": \"eni-attach-XXXXXXXX\",\n                         \"AttachTime\": \"2014-11-23T12:18:59.000Z\"\n                     },\n                     \"Groups\": [\n                         {\n                             \"GroupName\": \"SSHLoginSecurityGroup\",\n                             \"GroupId\": \"sg-XXXXXXXX\"\n                         }\n                     ],\n                     \"SubnetId\": \"subnet-XXXXXXXX\",\n                     \"OwnerId\": \"XXXXXXXXXXXX\",\n                     \"PrivateIpAddress\": \"10.192.131.XX\"\n                 }\n             ],\n             \"SourceDestCheck\": true,\n             \"Placement\": {\n                 \"Tenancy\": \"default\",\n                 \"GroupName\": null,\n                 \"AvailabilityZone\": \"ap-northeast-1c\"\n             },\n             \"Hypervisor\": \"xen\",\n             \"BlockDeviceMappings\": [],\n             \"Architecture\": \"x86_64\",\n             \"StateReason\": {\n                 \"Message\": \"pending\",\n                 \"Code\": \"pending\"\n             },\n             \"RootDeviceName\": \"/dev/xvda\",\n             \"VirtualizationType\": \"hvm\",\n             \"AmiLaunchIndex\": 0\n         }\n     ]\n   }\n```\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u306e\u53d6\u5f97\n--------------------\n\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ VPC_NET13_INSTANCES=`aws ec2 describe-instances --filter Name=subnet-id,Values=${VPC_NET13_ID} --query 'Reservations[].Instances[].InstanceId' --output text`; echo ${VPC_NET13_INSTANCES}\n```\n\n\nPublicDnsName\u306e\u53d6\u5f97\n-------------------\n\n\u5b9f\u969b\u306ePublic DNS\u540d\u3092\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ VPC_NET13_INSTANCE_NAME_PUBLIC=`aws ec2 describe-instances --instance-ids ${VPC_NET13_INSTANCES} --query 'Reservations[].Instances[].PublicDnsName' --output text`; echo ${VPC_NET13_INSTANCE_NAME_PUBLIC}\n```\n\n```text:\u7d50\u679c:\n   ec2-aaa-bbb-ccc-ddd.ap-northeast-1.compute.amazonaws.com\n```\n\n\n\u30ed\u30b0\u30a4\u30f3\n--------\n\n\u8d77\u52d5\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u3001Public DNS\u540d\u3092\u6307\u5b9a\u3057\u3066SSH\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ ssh -i ${FILE_SSH_KEY} ec2-user@${VPC_NET13_INSTANCE_NAME_PUBLIC}\n```\n\n```text:\u7d50\u679c:\n   The authenticity of host 'ec2-aaa-bbb-ccc-ddd.ap-northeast-1.compute.amazonaws.com (aaa.bbb.ccc.ddd)' can't be established.\n   RSA key fingerprint is XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX:XX.\n   Are you sure you want to continue connecting (yes/no)?\n```\n\n```text:\u5165\u529b:\n   yes(Enter)\n```\n\n```text:\u7d50\u679c:\n   Warning: Permanently added 'ec2-aaa-bbb-ccc-ddd.ap-northeast-1.compute.amazonaws.com,aaa.bbb.ccc.ddd' (RSA) to the list of known hosts.\n\n          __|  __|_  )\n          _|  (     /   Amazon Linux AMI\n         ___|\\___|___|\n\n   https://aws.amazon.com/amazon-linux-ami/2014.09-release-notes/\n   10 package(s) needed for security, out of 24 available\n   Run \"sudo yum update\" to apply all updates.\n   [ec2-user@ip-10-192-131-90 ~]$\n```\n\n\u3053\u308c\u3067Public\u30b5\u30d6\u30cd\u30c3\u30c8\u3067\u8d77\u52d5\u3057\u305f2\u3064\u76ee\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3057\u305f\u3002\n\n\n6. \u5168\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u7d42\u4e86\n=======================\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8907\u6570\u8d77\u52d5\u3057\u305f\u307e\u307e\u3060\u3068\u3001\u7121\u6599\u67a0\u3092\u8d85\u3048\u3066\u8ab2\u91d1\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u3001\u4eca\u56de\u306eVPC\u4e0a\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u5168\u3066\u7d42\u4e86\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\n\u7a3c\u52d5\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u53d6\u5f97\n------------------------------------\n\n\u307e\u305a\u3001VPC\u4e0a\u3067\u7a3c\u52d5\u3057\u3066\u3044\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9ID\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ ARRAY_EC2_INSTANCES=`aws ec2 describe-instances --filters Name=instance-state-name,Values=running --query 'Reservations[].Instances[].InstanceId' --output text`; echo ${ARRAY_EC2_INSTANCES}\n```\n\n```text:\u7d50\u679c:\n   i-XXXXXXXX i-YYYYYYYY i-ZZZZZZZZ\n```\n\n\n\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\n----------------------------\n\nVPC\u4e0a\u3067\u7a3c\u52d5\u3057\u3066\u3044\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-instance-status --instance-ids ${ARRAY_EC2_INSTANCES} --query 'InstanceStatuses[].[InstanceId,InstanceState.Name]' --output table\n```\n\n```text:\u7d50\u679c:\n   ---------------------------\n   | DescribeInstanceStatus  |\n   +-------------+-----------+\n   |  i-XXXXXXXX |  running  |\n   |  i-YYYYYYYY |  running  |\n   |  i-ZZZZZZZZ |  running  |\n   +-------------+-----------+\n```\n\n\n\u7a3c\u52d5\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u7d42\u4e86\n----------------------\n\n\u30b9\u30c6\u30fc\u30bf\u30b9\u304crunning\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u5168\u3066\u7d42\u4e86\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 terminate-instances --instance-ids ${ARRAY_EC2_INSTANCES}\n```\n\n```json:\u7d50\u679c:\n   {\n     \"TerminatingInstances\": [\n         {\n             \"InstanceId\": \"i-XXXXXXXX\",\n             \"CurrentState\": {\n                 \"Code\": 32,\n                 \"Name\": \"shutting-down\"\n             },\n             \"PreviousState\": {\n                 \"Code\": 16,\n                 \"Name\": \"running\"\n             }\n         },\n         {\n             \"InstanceId\": \"i-YYYYYYYY\",\n             \"CurrentState\": {\n                 \"Code\": 32,\n                 \"Name\": \"shutting-down\"\n             },\n             \"PreviousState\": {\n                 \"Code\": 16,\n                 \"Name\": \"running\"\n             }\n         },\n         {\n             \"InstanceId\": \"i-ZZZZZZZZ\",\n             \"CurrentState\": {\n                 \"Code\": 32,\n                 \"Name\": \"shutting-down\"\n             },\n             \"PreviousState\": {\n                 \"Code\": 16,\n                 \"Name\": \"running\"\n             }\n         }\n     ]\n   }\n```\n\n\n\u5bfe\u8c61\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u7d42\u4e86\u78ba\u8a8d\n--------------------------\n\n\u7d42\u4e86\u3057\u305fEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5168\u3066\u7d42\u4e86\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-instances --instance-ids ${ARRAY_EC2_INSTANCES} \\\n     --query 'Reservations[].Instances[].[InstanceId,State.Name]' --output table\n```\n\n```text:\u7d50\u679c:\n   ------------------------------\n   |      DescribeInstances     |\n   +-------------+--------------+\n   |  i-5b863a92 |  terminated  |\n   |  i-afba7759 |  terminated  |\n   |  i-d9db162f |  terminated  |\n   +-------------+--------------+\n```\n\n\n\u7a3c\u52d5\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\n--------------------------------------\n\nVPC\u4e0a\u306b\u30b9\u30c6\u30fc\u30bf\u30b9\u304crunning\u306b\u306a\u3063\u3066\u3044\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u5b58\u5728\u3057\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n   $ aws ec2 describe-instances --filters Name=instance-state-name,Values=running \\\n     --query 'Reservations[].Instances[].InstanceId' --output text\n```\n\n```text:\u7d50\u679c:\n   (\u623b\u308a\u5024\u306a\u3057)\n```\n\n\n\nEIP\u306e\u8fd4\u5374\n--------------------------------------\n\n\u5fd8\u308c\u305a\u306bEIP\u3092\u8fd4\u5374\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n  $ aws ec2 release-address --allocation-id ${EC2_EIP_ID}\n```\n\n```text:\u7d50\u679c:\n  (\u623b\u308a\u5024\u306a\u3057)\n```\n\n\n```bash:\u30b3\u30de\u30f3\u30c9:\n  $ aws ec2 describe-addresses\n```\n\n```json:\u7d50\u679c:\n  {\n    \"Addresses\": []\n  }\n```\n\n\n\n\u7d42\u4e86\n====\n\n\u4ee5\u4e0a\u3067\u3001VPC\u4e0a\u3067EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5/\u7d42\u4e86\u3059\u308b\u30cf\u30f3\u30ba\u30aa\u30f3\u306f\u5b8c\u4e86\u3067\u3059\u3002\n", "tags": ["AWS", "aws-cli", "EC2", "vpc"]}