{"context": " More than 1 year has passed since last update.\n\n\u524d\u7f6e\u304d\nCentOS+Pacemaker+Corosync+DRBD\u3067\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306aHA\u69cb\u6210\u3092\u4f5c\u308a\u3001\u305d\u3053\u306bOracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\nHA\u69cb\u6210\u3092OSS\u3067\u4f5c\u3063\u3066\u304a\u3044\u3066\u308f\u3056\u308f\u3056Oracle\u3092\u4f7f\u3046\u4eba\u306f\u5c11\u306a\u3044\u306e\u304b\u3001\u3042\u307e\u308a\u5b9f\u88c5\u4f8b\u304c\u7121\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u62d9\u3044\u5185\u5bb9\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30b7\u30b9\u30c6\u30e0\u69cb\u6210\n\n\u30ce\u30fc\u30c9A\u3000\u30db\u30b9\u30c8\u540d:OraSv1\u3000eth0:192.168.10.101\u3000eth1:192.168.1.101\n\u30ce\u30fc\u30c9B\u3000\u30db\u30b9\u30c8\u540d:OraSv2\u3000eth0:192.168.10.102\u3000eth1:192.168.1.102\n\u30b5\u30fc\u30d3\u30b9\u7528LAN\u3000192.168.10.0/24\u3000\u4eee\u60f3IP:192.168.10.100\n\u6b7b\u6d3b\u76e3\u8996\u7528LAN\u3000192.168.1.0/24\n\n\n\n\u4f7f\u3063\u305f\u3082\u306e\nCentOS 6.6\ndrbd 8.4\npacemaker 1.1.12\ncorosync 2.3.4\nOracle 12c Standard Edition One\n\n\u53c2\u8003\u8a18\u4e8b\n\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3044\u305f\u3057\u307e\u3057\u305f\u3002\n\u5927\u5909\u52c9\u5f37\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u672c\u5f53\u306b\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\nCentOS6.5\u3067DRBD8.4\u3092\u4f7f\u3063\u3066\u307f\u308b\nServer World\u3000Oracle 12c\n\nLinux-HA\u306e\u69cb\u7bc9\n\u30ce\u30fc\u30c9\uff12\u53f0\u306b\u5bfe\u3057\u3066\u4ee5\u4e0b\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\nCentOS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nDRBD\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nPacemaker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3053\u3053\u306e\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u5225\u306e\u826f\u8a18\u4e8b\u304c\u591a\u6570\u3042\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n\u5225\u30da\u30fc\u30b8\u306b\u3056\u3063\u304f\u308a\u30e1\u30e2\u66f8\u304d\u3057\u307e\u3057\u305f\u306e\u3067\u3001\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nCentOS6.6\u306eLinux-HA\u3067DRBD\u3092\u69cb\u7bc9\u3059\u308b\u624b\u9806\u3081\u3082\n\nOracle 12c \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nOracle\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u30ea\u30b9\u30ca\u30fc\u4f5c\u6210\n\u4ee5\u4e0b\u306e\u53c2\u8003\u30b5\u30a4\u30c8\u306e\u901a\u308a\u306b\u3001\u30ea\u30b9\u30ca\u30fc\u306e\u4f5c\u6210\u307e\u3067\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\u30ce\u30fc\u30c9\uff12\u53f0\u306e\u4e21\u65b9\u3067\u5b9f\u65bd\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u53c2\u8003\u3000Server World\u3000Oracle 12c\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u524d\u8a2d\u5b9a\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u30ea\u30b9\u30ca\u30fc\u306e\u8ffd\u52a0\n\n\nOracle\u30c7\u30fc\u30bf\u683c\u7d0d\u9818\u57df\u306e\u8a2d\u5b9a\uff08\u30ce\u30fc\u30c9A\uff09\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\u306e\u524d\u306b\u3001DRBD\u304c\u7ba1\u7406\u3059\u308b\u30c7\u30a3\u30b9\u30af\u9818\u57df\uff08\u4ee5\u4e0b\u306e\u4f8b\u3067\u306f/ora\uff09\u306boracle\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n\n\u30ce\u30fc\u30c9A\uff08Primary\u5074\uff09\n\nroot\u3067\u5b9f\u884c\n\n/ora\u4ee5\u4e0b\u306boradata\u3068fast_recovery_area\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\ndf\ncd /ora\nmkdir oradata\nmkdir fast_recovery_area\nchown oracle:oinstall oradata fast_recovery_area\n\n\noracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\n/ora\u4ee5\u4e0b\u306b\u30ea\u30f3\u30af\u3092\u5f35\u308b\u3053\u3068\u3067\u3001\u672c\u6765\u306f$ORACLE_BASE\u4ee5\u4e0b\u306b\u4fdd\u5b58\u3055\u308c\u308b\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u5b9f\u4f53\u3092/ora\u4ee5\u4e0b\u306b\u4fdd\u5b58\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\nln -s /ora/oradata $ORACLE_BASE\nln -s /ora/fast_recovery_area $ORACLE_BASE\nls -l $ORACLE_BASE\n\u5408\u8a08 16\ndrwxr-xr-x.  3 oracle oinstall 4096  2\u6708  8 21:58 2015 product\ndrwxrwxr-x. 19 oracle oinstall 4096  2\u6708  8 22:00 2015 diag\ndrwxr-xr-x.  2 oracle oinstall 4096  2\u6708  8 22:02 2015 checkpoints\ndrwxr-xr-x.  3 oracle oinstall 4096  2\u6708  8 22:03 2015 cfgtoollogs\nlrwxrwxrwx.  1 oracle oinstall   12  2\u6708  8 22:07 2015 oradata ->\n/ora/oradata\nlrwxrwxrwx.  1 oracle oinstall   23  2\u6708  8 22:08 2015\nfast_recovery_area -> /ora/fast_recovery_area\n\n\n\u30ce\u30fc\u30c9B\uff08Secondary\u5074\uff09\n\u3053\u3053\u3067\u306f\u4f55\u3082\u8a2d\u5b9a\u5909\u66f4\u305b\u305a\u3001\u305d\u306e\u307e\u307e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\u306b\u9032\u307f\u307e\u3059\u3002\n\nOracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\n\u5f15\u304d\u7d9a\u304d\u3001\u4ee5\u4e0b\u306e\u53c2\u8003\u30b5\u30a4\u30c8\u306e\u901a\u308a\u306b\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\u3001\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\u3092\u5b9f\u65bd\n\u3057\u307e\u3059\u3002\n\u53c2\u8003\u3000Server World\u3000Oracle 12c\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\n\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\n\n\u306a\u304a\u3001\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\u306f[1]\u306e\u74b0\u5883\u8a2d\u5b9a\u306e\u307f\u5b9f\u65bd\u3057\u307e\u3059\u3002\nOracle\u306e\u8d77\u52d5\u30fb\u505c\u6b62\u306fpacemaker\u3067\u884c\u306a\u3046\u305f\u3081\u3001[2]\u306e\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u4e0d\u8981\u3067\u3059\u3002\n\nOracle\u63a5\u7d9a\u78ba\u8a8d\n\noracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\nlsnrctl status\n\n\u30ea\u30b9\u30ca\u30fc\u304c\u52d5\u3044\u3066\u308b\u3053\u3068\u3002\nsqlplus /nolog  \nSQL> conn sys as sysdba\nSQL> select STATUS from v$instance;\nSTATUS\n------------------------------------\nOPEN\nSQL> exit\n\nSTATUS\u304cOPEN\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3002\n\nOracle\u30c7\u30fc\u30bf\u683c\u7d0d\u9818\u57df\u306e\u8a2d\u5b9a\uff08\u30ce\u30fc\u30c9B\uff09\n\u3053\u3053\u307e\u3067\u3067\u3001\u30ce\u30fc\u30c9A\u306f/ora\u4ee5\u4e0b\u3001\u30ce\u30fc\u30c9B\u306f$ORACLE_BASE\u4ee5\u4e0b\u306b\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3057\u305f\u3057\u305f\u72b6\u614b\u3067Oracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\n\u3067\u306f\u3001\u30ce\u30fc\u30c9B\u306e$ORACLE_BASE\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u6368\u3066\u3066\u3001\u30ce\u30fc\u30c9A\u304c\u4f5c\u6210\u3057\u305f/ora\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u30ce\u30fc\u30c9B\u304b\u3089\u3082\u5171\u6709\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u307e\u305a\u3001\u4e21\u30ce\u30fc\u30c9\u306eOracle\u3092\u505c\u6b62\u3057\u307e\u3059\u3002\n\n\u30ce\u30fc\u30c9A\uff08Primary\u5074\uff09\u3001\u30ce\u30fc\u30c9B\uff08Secondary\u5074\uff09\n\noracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\nOracle DB\u505c\u6b62\nsqlplus /nolog\nSQL> conn sys as sysdba\nSQL> shutdown\n\n\n\u30ce\u30fc\u30c9B\uff08Secondary\u5074\uff09\n\nroot\u3067\u5b9f\u884c\n\ncrm_mon\nOnline: [ OraSv1 OraSv2 ]\n\nMaster/Slave Set: ms-drbd_ora [drbd_ora]\n    Masters: [ OraSv1 ]\n    Slaves: [ OraSv2 ]\nResource Group: grpora\n    fs_ora     (ocf::heartbeat:Filesystem):    Started OraSv1\n    VIP1       (ocf::heartbeat:IPaddr2):       Started OraSv1\n\n\u30ce\u30fc\u30c9A\u3092\u3044\u3063\u305f\u3093standy\u306b\u3057\u3066\u3001\u30ce\u30fc\u30c9B\u306b\u5404\u30ea\u30bd\u30fc\u30b9\u3092\u5207\u308a\u66ff\u3048\u308b\u3002\ncrm node standby OraSv1\n\u5207\u308a\u66ff\u308f\u3063\u305f\u3089online\u306b\u623b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\ncrm node online OraSv1\ncrm_mon\nOnline: [ OraSv1 OraSv2 ]\n\nMaster/Slave Set: ms-drbd_ora [drbd_ora]\n    Masters: [ OraSv2 ]\n    Slaves: [ OraSv1 ]\nResource Group: grpora\n    fs_ora     (ocf::heartbeat:Filesystem):    Started OraSv2\n    VIP1       (ocf::heartbeat:IPaddr2):       Started OraSv2\n\n\u30ce\u30fc\u30c9B\u3067/ora\u304c\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\ndf\n\noracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\n$ORACLE_BASE\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u3001/ora\u4ee5\u4e0b\u3078\u306e\u30ea\u30f3\u30af\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\ncd $ORACLE_BASE\nrm -rf oradata fast_recovery_area\nln -s /ora/oradata $ORACLE_BASE\nln -s /ora/fast_recovery_area $ORACLE_BASE\nls -ltr\n\u5408\u8a08 24\ndrwxr-xr-x.  3 oracle oinstall 4096  2\u6708  8 21:58 2015 product\ndrwxrwxr-x. 19 oracle oinstall 4096  2\u6708  8 22:13 2015 diag\ndrwxr-xr-x.  2 oracle oinstall 4096  2\u6708  8 22:14 2015 checkpoints\ndrwxr-x---.  3 oracle oinstall 4096  2\u6708  8 22:20 2015 admin\ndrwxr-x---.  3 oracle oinstall 4096  2\u6708  8 22:31 2015 audit\ndrwxr-xr-x.  5 oracle oinstall 4096  2\u6708  8 22:34 2015 cfgtoollogs\nlrwxrwxrwx.  1 oracle oinstall   12  2\u6708  8 23:09 2015 oradata ->\n/ora/oradata\nlrwxrwxrwx.  1 oracle oinstall   23  2\u6708  8 23:09 2015\nfast_recovery_area -> /ora/fast_recovery_area\n\nOracle DB\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nsqlplus /nolog          \nSQL> conn sys as sysdba     \nSQL> startup        \nSQL> select STATUS from v$instance;\nSTATUS\n------------------------------------\nOPEN\n\n\u3053\u308c\u3067\u3001Oracle\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304cDRBD\u3067\uff12\u91cd\u5316\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u30e6\u30fc\u30b6\u4f5c\u6210\u3001\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\nOracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30e6\u30fc\u30b6\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\u3010SID\u3011\u306b\u306f\u5404\u81ea\u4f5c\u6210\u3057\u305f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306eSID\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\nSQL> CREATE USER hoge IDENTIFIED BY hoge_pwd;\nSQL>ALTER USER hoge QUOTA 10M ON USERS;\nSQL> GRANT CONNECT TO hoge;\nSQL> GRANT CREATE TABLE TO hoge;\nSQL> exit\n\nsqlplus hoge/hoge_pwd@\u3010SID\u3011\nSQL> create table hoge_tbl\n(\n id number,\n name varchar(50),\n furigana varchar(50),\n primary key( id )\n);\n\nSQL> insert into hoge_tbl (id, name, furigana) values (1, '\u307b\u3052', '\u30db\u30b2');\nSQL> commit;    \nSQL> select * from hoge_tbl;\nID\u3000NAME\u3000FURIGANA\n-----------------------------\n1\u3000\u307b\u3052\u3000\u3000\u30db\u30b2\nSQL> exit;  \n\n\nOracle\u8d77\u52d5\u30ce\u30fc\u30c9\u3092\u5207\u66ff\n\u30ce\u30fc\u30c9B\u3067Oracle\u3092\u505c\u6b62\u3057\u3001DRBD\u3092\u5207\u308a\u66ff\u3048\u307e\u3059\u3002\n\n\u30ce\u30fc\u30c9B\u3067\u5b9f\u65bd\n\noracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\nOracle DB\u505c\u6b62         \nsqlplus /nolog\nSQL> conn sys as sysdba\nSQL> shutdown\n\nDRBD\u306e\u5207\u308a\u66ff\u3048\ncrm_mon\nOnline: [ OraSv1 OraSv2 ]\n\nMaster/Slave Set: ms-drbd_ora [drbd_ora]\n    Masters: [ OraSv2 ]\n    Slaves: [ OraSv1 ]\nResource Group: grpora\n    fs_ora     (ocf::heartbeat:Filesystem):    Started OraSv2\n    VIP1       (ocf::heartbeat:IPaddr2):       Started OraSv2\n\n\u30ce\u30fc\u30c9B\u3092standby\u306b\u3059\u308b\u3068\u3001DRBD\u304c\u5207\u308a\u66ff\u308f\u308a\u307e\u3059\u3002\ncrm node standby OraSv2\n\u5207\u308a\u66ff\u308f\u3063\u305f\u5f8c\u306fonline\u306b\u623b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\ncrm node online OraSv2\ncrm_mon\nOnline: [ OraSv1 OraSv2 ]\n\nMaster/Slave Set: ms-drbd_ora [drbd_ora]\n    Masters: [ OraSv1 ]\n    Slaves: [ OraSv2 ]\nResource Group: grpora\n    fs_ora     (ocf::heartbeat:Filesystem):    Started OraSv1\n    VIP1       (ocf::heartbeat:IPaddr2):       Started OraSv1\n\n\n\u30ce\u30fc\u30c9A\u3067\u5b9f\u65bd\n\noracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\n\u30ce\u30fc\u30c9A\u3067/ora\u304c\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\ndf\nOracle DB\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nsqlplus /nolog          \nSQL> conn sys as sysdba     \nSQL> startup        \nSQL> select STATUS from v$instance;\nSTATUS\n------------------------------------\nOPEN\n\n\u30ce\u30fc\u30c9B\u3067\u8ffd\u52a0\u3057\u305f\u30c6\u30fc\u30d6\u30eb\u30fb\u30ec\u30b3\u30fc\u30c9\u304c\u30ce\u30fc\u30c9A\u3067\u3082\u53d6\u5f97\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\nsqlplus hoge/hoge_pwd@\u3010SID\u3011\nSQL>    select * from hoge_tbl;\nID\u3000NAME\u3000FURIGANA\n-----------------------------\n1\u3000\u307b\u3052\u3000\u3000\u30db\u30b2\nSQL>    exit;\n\n\nWeb\u30d6\u30e9\u30a6\u30b6\u3067Oracle Enterprise Manager\u306b\u30a2\u30af\u30bb\u30b9\n\u4eee\u60f3IP\u3067Oracle EM\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3053\u3068\u3082\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\nhttps://192.168.10.100:5500/em\n\u3042\u3068\u306f\u3001Oracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8d77\u52d5\u30fb\u505c\u6b62\u3092pacemaker\u3067\u7ba1\u7406\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u7d9a\u304d\u306f\u3053\u3061\u3089\u306b\u3002\nCentOS6.6\u306eLinux-HA\u3067Pacemaker\u306b\u3088\u308bOracle\u306e\u8d77\u52d5\u30fb\u505c\u6b62\u3092\u5236\u5fa1\u3059\u308b\n#\u524d\u7f6e\u304d\nCentOS+Pacemaker+Corosync+DRBD\u3067\u4ee5\u4e0b\u306e\u56f3\u306e\u3088\u3046\u306aHA\u69cb\u6210\u3092\u4f5c\u308a\u3001\u305d\u3053\u306bOracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\u3002\n\nHA\u69cb\u6210\u3092OSS\u3067\u4f5c\u3063\u3066\u304a\u3044\u3066\u308f\u3056\u308f\u3056Oracle\u3092\u4f7f\u3046\u4eba\u306f\u5c11\u306a\u3044\u306e\u304b\u3001\u3042\u307e\u308a\u5b9f\u88c5\u4f8b\u304c\u7121\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u62d9\u3044\u5185\u5bb9\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\n##\u30b7\u30b9\u30c6\u30e0\u69cb\u6210\n\n* \u30ce\u30fc\u30c9A\u3000\u30db\u30b9\u30c8\u540d:OraSv1\u3000eth0:192.168.10.101\u3000eth1:192.168.1.101\n* \u30ce\u30fc\u30c9B\u3000\u30db\u30b9\u30c8\u540d:OraSv2\u3000eth0:192.168.10.102\u3000eth1:192.168.1.102\n* \u30b5\u30fc\u30d3\u30b9\u7528LAN\u3000192.168.10.0/24\u3000\u4eee\u60f3IP:192.168.10.100\n* \u6b7b\u6d3b\u76e3\u8996\u7528LAN\u3000192.168.1.0/24\n\n![Linux-HA Oracle\u69cb\u6210.png](https://qiita-image-store.s3.amazonaws.com/0/68537/fc62ea26-8339-5d15-de7a-6698596c440a.png)\n\n### \u4f7f\u3063\u305f\u3082\u306e\n\nCentOS 6.6\ndrbd 8.4\npacemaker 1.1.12\ncorosync 2.3.4\nOracle 12c Standard Edition One\n\n### \u53c2\u8003\u8a18\u4e8b\n\u4ee5\u4e0b\u306e\u8a18\u4e8b\u3092\u53c2\u8003\u306b\u3044\u305f\u3057\u307e\u3057\u305f\u3002\n\u5927\u5909\u52c9\u5f37\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u672c\u5f53\u306b\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002\n\n[CentOS6.5\u3067DRBD8.4\u3092\u4f7f\u3063\u3066\u307f\u308b](http://qiita.com/takehironet/items/4d26198798fb4b7454f8)\n\n[Server World\u3000Oracle 12c](http://www.server-world.info/query?os=CentOS_6&p=oracle12c)\n\n# Linux-HA\u306e\u69cb\u7bc9\n\n\u30ce\u30fc\u30c9\uff12\u53f0\u306b\u5bfe\u3057\u3066\u4ee5\u4e0b\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n* CentOS\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n* DRBD\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n* Pacemaker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u3053\u3053\u306e\u624b\u9806\u306b\u3064\u3044\u3066\u306f\u5225\u306e\u826f\u8a18\u4e8b\u304c\u591a\u6570\u3042\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306f\u7701\u7565\u3057\u307e\u3059\u3002\n\n\u5225\u30da\u30fc\u30b8\u306b\u3056\u3063\u304f\u308a\u30e1\u30e2\u66f8\u304d\u3057\u307e\u3057\u305f\u306e\u3067\u3001\u53c2\u8003\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n[CentOS6.6\u306eLinux-HA\u3067DRBD\u3092\u69cb\u7bc9\u3059\u308b\u624b\u9806\u3081\u3082](http://qiita.com/takusamar/items/62d7bd70d659f42d4116)\n\n# Oracle 12c \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n## Oracle\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u30ea\u30b9\u30ca\u30fc\u4f5c\u6210\n\n\u4ee5\u4e0b\u306e\u53c2\u8003\u30b5\u30a4\u30c8\u306e\u901a\u308a\u306b\u3001\u30ea\u30b9\u30ca\u30fc\u306e\u4f5c\u6210\u307e\u3067\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\u30ce\u30fc\u30c9\uff12\u53f0\u306e\u4e21\u65b9\u3067\u5b9f\u65bd\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u53c2\u8003\u3000Server World\u3000Oracle 12c\n\n* [\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u524d\u8a2d\u5b9a](http://www.server-world.info/query?os=CentOS_6&p=oracle12c&f=1)\n* [\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb](http://www.server-world.info/query?os=CentOS_6&p=oracle12c&f=2)\n* [\u30ea\u30b9\u30ca\u30fc\u306e\u8ffd\u52a0](http://www.server-world.info/query?os=CentOS_6&p=oracle12c&f=3)\n\n## Oracle\u30c7\u30fc\u30bf\u683c\u7d0d\u9818\u57df\u306e\u8a2d\u5b9a\uff08\u30ce\u30fc\u30c9A\uff09\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\u306e\u524d\u306b\u3001DRBD\u304c\u7ba1\u7406\u3059\u308b\u30c7\u30a3\u30b9\u30af\u9818\u57df\uff08\u4ee5\u4e0b\u306e\u4f8b\u3067\u306f/ora\uff09\u306boracle\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n\n### \u30ce\u30fc\u30c9A\uff08Primary\u5074\uff09\n\n* root\u3067\u5b9f\u884c\n\n/ora\u4ee5\u4e0b\u306boradata\u3068fast_recovery_area\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```sh:\ndf\ncd /ora\nmkdir oradata\nmkdir fast_recovery_area\nchown oracle:oinstall oradata fast_recovery_area\n```\n\n* oracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\n/ora\u4ee5\u4e0b\u306b\u30ea\u30f3\u30af\u3092\u5f35\u308b\u3053\u3068\u3067\u3001\u672c\u6765\u306f$ORACLE_BASE\u4ee5\u4e0b\u306b\u4fdd\u5b58\u3055\u308c\u308b\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u306e\u5b9f\u4f53\u3092/ora\u4ee5\u4e0b\u306b\u4fdd\u5b58\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```sh:\nln -s /ora/oradata $ORACLE_BASE\nln -s /ora/fast_recovery_area $ORACLE_BASE\nls -l $ORACLE_BASE\n\u5408\u8a08 16\ndrwxr-xr-x.  3 oracle oinstall 4096  2\u6708  8 21:58 2015 product\ndrwxrwxr-x. 19 oracle oinstall 4096  2\u6708  8 22:00 2015 diag\ndrwxr-xr-x.  2 oracle oinstall 4096  2\u6708  8 22:02 2015 checkpoints\ndrwxr-xr-x.  3 oracle oinstall 4096  2\u6708  8 22:03 2015 cfgtoollogs\nlrwxrwxrwx.  1 oracle oinstall   12  2\u6708  8 22:07 2015 oradata ->\n/ora/oradata\nlrwxrwxrwx.  1 oracle oinstall   23  2\u6708  8 22:08 2015\nfast_recovery_area -> /ora/fast_recovery_area\n```\n\t\n### \u30ce\u30fc\u30c9B\uff08Secondary\u5074\uff09\n\u3053\u3053\u3067\u306f\u4f55\u3082\u8a2d\u5b9a\u5909\u66f4\u305b\u305a\u3001\u305d\u306e\u307e\u307e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\u306b\u9032\u307f\u307e\u3059\u3002\n\n## Oracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\n\n\u5f15\u304d\u7d9a\u304d\u3001\u4ee5\u4e0b\u306e\u53c2\u8003\u30b5\u30a4\u30c8\u306e\u901a\u308a\u306b\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210\u3001\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\u3092\u5b9f\u65bd\n\u3057\u307e\u3059\u3002\n\n\u53c2\u8003\u3000Server World\u3000Oracle 12c\n\n* [\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4f5c\u6210](http://www.server-world.info/query?os=CentOS_6&p=oracle12c&f=4)\n* [\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a](http://www.server-world.info/query?os=CentOS_6&p=oracle12c&f=5)\n\n\u306a\u304a\u3001\u81ea\u52d5\u8d77\u52d5\u8a2d\u5b9a\u306f[1]\u306e\u74b0\u5883\u8a2d\u5b9a\u306e\u307f\u5b9f\u65bd\u3057\u307e\u3059\u3002\nOracle\u306e\u8d77\u52d5\u30fb\u505c\u6b62\u306fpacemaker\u3067\u884c\u306a\u3046\u305f\u3081\u3001[2]\u306e\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u4e0d\u8981\u3067\u3059\u3002\n\n## Oracle\u63a5\u7d9a\u78ba\u8a8d\n\n* oracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\n```sh:\nlsnrctl status\n```\n\u30ea\u30b9\u30ca\u30fc\u304c\u52d5\u3044\u3066\u308b\u3053\u3068\u3002\n\n```sh:\nsqlplus /nolog\t\nSQL> conn sys as sysdba\nSQL> select STATUS from v$instance;\nSTATUS\n------------------------------------\nOPEN\nSQL> exit\n```\nSTATUS\u304cOPEN\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3002\n\n## Oracle\u30c7\u30fc\u30bf\u683c\u7d0d\u9818\u57df\u306e\u8a2d\u5b9a\uff08\u30ce\u30fc\u30c9B\uff09\n\n\u3053\u3053\u307e\u3067\u3067\u3001\u30ce\u30fc\u30c9A\u306f/ora\u4ee5\u4e0b\u3001\u30ce\u30fc\u30c9B\u306f$ORACLE_BASE\u4ee5\u4e0b\u306b\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3057\u305f\u3057\u305f\u72b6\u614b\u3067Oracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u3067\u306f\u3001\u30ce\u30fc\u30c9B\u306e$ORACLE_BASE\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u6368\u3066\u3066\u3001\u30ce\u30fc\u30c9A\u304c\u4f5c\u6210\u3057\u305f/ora\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u30ce\u30fc\u30c9B\u304b\u3089\u3082\u5171\u6709\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u307e\u305a\u3001\u4e21\u30ce\u30fc\u30c9\u306eOracle\u3092\u505c\u6b62\u3057\u307e\u3059\u3002\n\n### \u30ce\u30fc\u30c9A\uff08Primary\u5074\uff09\u3001\u30ce\u30fc\u30c9B\uff08Secondary\u5074\uff09\n\n* oracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\nOracle DB\u505c\u6b62\n\n```sh:\nsqlplus /nolog\nSQL> conn sys as sysdba\nSQL> shutdown\n```\n\n### \u30ce\u30fc\u30c9B\uff08Secondary\u5074\uff09\n\n* root\u3067\u5b9f\u884c\n\n`crm_mon`\n\n```sh:\nOnline: [ OraSv1 OraSv2 ]\n\nMaster/Slave Set: ms-drbd_ora [drbd_ora]\n    Masters: [ OraSv1 ]\n    Slaves: [ OraSv2 ]\nResource Group: grpora\n    fs_ora     (ocf::heartbeat:Filesystem):    Started OraSv1\n    VIP1       (ocf::heartbeat:IPaddr2):       Started OraSv1\n```\n\n\u30ce\u30fc\u30c9A\u3092\u3044\u3063\u305f\u3093standy\u306b\u3057\u3066\u3001\u30ce\u30fc\u30c9B\u306b\u5404\u30ea\u30bd\u30fc\u30b9\u3092\u5207\u308a\u66ff\u3048\u308b\u3002\n\n`crm node standby OraSv1`\n\n\u5207\u308a\u66ff\u308f\u3063\u305f\u3089online\u306b\u623b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n`crm node online OraSv1`\n\n`crm_mon`\n\n```sh:\nOnline: [ OraSv1 OraSv2 ]\n\nMaster/Slave Set: ms-drbd_ora [drbd_ora]\n    Masters: [ OraSv2 ]\n    Slaves: [ OraSv1 ]\nResource Group: grpora\n    fs_ora     (ocf::heartbeat:Filesystem):    Started OraSv2\n    VIP1       (ocf::heartbeat:IPaddr2):       Started OraSv2\n```\n\n\u30ce\u30fc\u30c9B\u3067/ora\u304c\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n`df`\n\n* oracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\n$ORACLE_BASE\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\u3057\u3001/ora\u4ee5\u4e0b\u3078\u306e\u30ea\u30f3\u30af\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n\n```sh:\ncd $ORACLE_BASE\nrm -rf oradata fast_recovery_area\nln -s /ora/oradata $ORACLE_BASE\nln -s /ora/fast_recovery_area $ORACLE_BASE\nls -ltr\n\u5408\u8a08 24\ndrwxr-xr-x.  3 oracle oinstall 4096  2\u6708  8 21:58 2015 product\ndrwxrwxr-x. 19 oracle oinstall 4096  2\u6708  8 22:13 2015 diag\ndrwxr-xr-x.  2 oracle oinstall 4096  2\u6708  8 22:14 2015 checkpoints\ndrwxr-x---.  3 oracle oinstall 4096  2\u6708  8 22:20 2015 admin\ndrwxr-x---.  3 oracle oinstall 4096  2\u6708  8 22:31 2015 audit\ndrwxr-xr-x.  5 oracle oinstall 4096  2\u6708  8 22:34 2015 cfgtoollogs\nlrwxrwxrwx.  1 oracle oinstall   12  2\u6708  8 23:09 2015 oradata ->\n/ora/oradata\nlrwxrwxrwx.  1 oracle oinstall   23  2\u6708  8 23:09 2015\nfast_recovery_area -> /ora/fast_recovery_area\n```\n\nOracle DB\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```sh:\nsqlplus /nolog\t\t\t\nSQL> conn sys as sysdba\t\t\nSQL> startup\t\t\nSQL> select STATUS from v$instance;\nSTATUS\n------------------------------------\nOPEN\n```\n\n\u3053\u308c\u3067\u3001Oracle\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304cDRBD\u3067\uff12\u91cd\u5316\u3055\u308c\u307e\u3057\u305f\u3002\n\n## \u30e6\u30fc\u30b6\u4f5c\u6210\u3001\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n\nOracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30e6\u30fc\u30b6\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\u3010SID\u3011\u306b\u306f\u5404\u81ea\u4f5c\u6210\u3057\u305f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306eSID\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\n```sh:\nSQL> CREATE USER hoge IDENTIFIED BY hoge_pwd;\nSQL>ALTER USER hoge QUOTA 10M ON USERS;\nSQL> GRANT CONNECT TO hoge;\nSQL> GRANT CREATE TABLE TO hoge;\nSQL> exit\n\nsqlplus hoge/hoge_pwd@\u3010SID\u3011\nSQL> create table hoge_tbl\n(\n id number,\n name varchar(50),\n furigana varchar(50),\n primary key( id )\n);\n\t\t\t\nSQL> insert into hoge_tbl (id, name, furigana) values (1, '\u307b\u3052', '\u30db\u30b2');\nSQL> commit;\t\nSQL> select * from hoge_tbl;\nID\u3000NAME\u3000FURIGANA\n-----------------------------\n1\u3000\u307b\u3052\u3000\u3000\u30db\u30b2\nSQL> exit;\t\n```\n\n## Oracle\u8d77\u52d5\u30ce\u30fc\u30c9\u3092\u5207\u66ff\n\n\u30ce\u30fc\u30c9B\u3067Oracle\u3092\u505c\u6b62\u3057\u3001DRBD\u3092\u5207\u308a\u66ff\u3048\u307e\u3059\u3002\n\n### \u30ce\u30fc\u30c9B\u3067\u5b9f\u65bd\n\n* oracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\nOracle DB\u505c\u6b62\t\t\t\n\n```sh:\nsqlplus /nolog\nSQL> conn sys as sysdba\nSQL> shutdown\n```\n\nDRBD\u306e\u5207\u308a\u66ff\u3048\n\n`crm_mon`\n\n```sh:\nOnline: [ OraSv1 OraSv2 ]\n\nMaster/Slave Set: ms-drbd_ora [drbd_ora]\n    Masters: [ OraSv2 ]\n    Slaves: [ OraSv1 ]\nResource Group: grpora\n    fs_ora     (ocf::heartbeat:Filesystem):    Started OraSv2\n    VIP1       (ocf::heartbeat:IPaddr2):       Started OraSv2\n```\n\n\u30ce\u30fc\u30c9B\u3092standby\u306b\u3059\u308b\u3068\u3001DRBD\u304c\u5207\u308a\u66ff\u308f\u308a\u307e\u3059\u3002\n\n`crm node standby OraSv2`\n\n\u5207\u308a\u66ff\u308f\u3063\u305f\u5f8c\u306fonline\u306b\u623b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n`crm node online OraSv2`\n\n`crm_mon`\n\n```sh:\nOnline: [ OraSv1 OraSv2 ]\n\nMaster/Slave Set: ms-drbd_ora [drbd_ora]\n    Masters: [ OraSv1 ]\n    Slaves: [ OraSv2 ]\nResource Group: grpora\n    fs_ora     (ocf::heartbeat:Filesystem):    Started OraSv1\n    VIP1       (ocf::heartbeat:IPaddr2):       Started OraSv1\n```\n\n### \u30ce\u30fc\u30c9A\u3067\u5b9f\u65bd\n\n* oracle\u30e6\u30fc\u30b6\u3067\u5b9f\u884c\n\n\u30ce\u30fc\u30c9A\u3067/ora\u304c\u30de\u30a6\u30f3\u30c8\u3055\u308c\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n`df`\n\nOracle DB\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```sh:\nsqlplus /nolog\t\t\t\nSQL> conn sys as sysdba\t\t\nSQL> startup\t\t\nSQL> select STATUS from v$instance;\nSTATUS\n------------------------------------\nOPEN\n```\n\n\u30ce\u30fc\u30c9B\u3067\u8ffd\u52a0\u3057\u305f\u30c6\u30fc\u30d6\u30eb\u30fb\u30ec\u30b3\u30fc\u30c9\u304c\u30ce\u30fc\u30c9A\u3067\u3082\u53d6\u5f97\u3067\u304d\u308b\u304b\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```sh:\nsqlplus hoge/hoge_pwd@\u3010SID\u3011\nSQL>\tselect * from hoge_tbl;\nID\u3000NAME\u3000FURIGANA\n-----------------------------\n1\u3000\u307b\u3052\u3000\u3000\u30db\u30b2\nSQL>\texit;\n```\n\t\n## Web\u30d6\u30e9\u30a6\u30b6\u3067Oracle Enterprise Manager\u306b\u30a2\u30af\u30bb\u30b9\t\n\n\u4eee\u60f3IP\u3067Oracle EM\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3053\u3068\u3082\u78ba\u8a8d\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\nhttps://192.168.10.100:5500/em\n\n\u3042\u3068\u306f\u3001Oracle\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u8d77\u52d5\u30fb\u505c\u6b62\u3092pacemaker\u3067\u7ba1\u7406\u3059\u308b\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u7d9a\u304d\u306f\u3053\u3061\u3089\u306b\u3002\n[CentOS6.6\u306eLinux-HA\u3067Pacemaker\u306b\u3088\u308bOracle\u306e\u8d77\u52d5\u30fb\u505c\u6b62\u3092\u5236\u5fa1\u3059\u308b](http://qiita.com/takusamar/items/c43f351975877ff07b10)\n", "tags": ["CentOS6.6", "drbd8.4", "pacemaker1.1.12", "corosync2.3.4", "oracle12c"]}