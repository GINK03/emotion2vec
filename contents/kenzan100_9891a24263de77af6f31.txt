{"context": " More than 1 year has passed since last update.\n\nFluentd\u3068\u306f\n\n\u3053\u3093\u306a\u611f\u3058 (\u5f15\u7528: http://codezine.jp/static/images/article/6958/6958_02.gif)\n\n\n\n\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n\nRails\u306e\u30ed\u30b0\u3068\u3001\u30a6\u30a7\u30d6\u30b5\u30fc\u30d0\u306e\u6a19\u6e96\u7684\u306a\u30ed\u30b0\u3092\u3001S3\u306b\u96c6\u7d04\u3059\u308b\u69cb\u6210\nfluentd\u306e\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u3001\u4e0b\u8a18URL\u304b\u3089\u3001\u5404\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u5225\u306b\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u95b2\u89a7\u53ef\u80fd\nhttp://docs.treasuredata.com/articles/td-agent#install-td-agent\n\n\nconf\n\ntd-agent.conf\n<match *.**>\n  type forest\n  subtype s3\n\n  <template>\n   aws_key_id xxx #IAM\u3067S3\u3078\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u3092\u3082\u3063\u305f\u3082\u306e\u3092\u6307\u5b9a(\u5f8c\u8ff0)\n   aws_sec_key xxx #IAM\u3067S3\u3078\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u3092\u3082\u3063\u305f\u3082\u306e\u3092\u6307\u5b9a(\u5f8c\u8ff0)\n   s3_bucket fluentd-logging\n   path others/\n   buffer_path /var/log/td-agent/buffer/${tag}\n\n   time_slice_format ${tag}/%Y%m%d%H\n   time_slice_wait 10m\n   flush_interval 1m\n\n   format_json true\n   include_time_key true\n   include_tag_key true\n\n   buffer_chunk_limit 256m\n  </template>\n</match>\n\n<source>\n type forward\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format apache2\n  path /var/log/httpd/access_log\n  pos_file /var/log/td-agent/apache2.access_log.pos\n  tag ${hostname}/apache.access\n </config>\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format /^\\[[^ ]* (?<time>[^\\]]*)\\] \\[(?<level>[^\\]]*)\\] \\[pid (?<pid>[^\\]]*)\\] \\[client (?<client>[^\\]]*)\\] (?<message>.*)$/\n  path /var/log/httpd/error_log\n  pos_file /var/log/td-agent/apache2.error_log.pos\n  tag ${hostname}/apache.error\n </config>\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format syslog\n  path /var/log/messages\n  pos_file /var/log/td-agent/syslog.messages.pos\n  tag ${hostname}/syslog.messages\n </config>\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format syslog\n  path /var/log/cron\n  pos_file /var/log/td-agent/syslog.cron.pos\n  tag ${hostname}/syslog.cron\n </config>\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format syslog\n  path /var/log/secure\n  pos_file /var/log/td-agent/syslog.secure.pos\n  tag ${hostname}/syslog.secure\n </config>\n</source>\n\n\ngem 'act-fluent-logger-rails', '0.0.4' #\u307e\u3060\u81ea\u793e\u74b0\u5883\u304c Rails3\u7cfb\u3060\u3063\u305f\u306e\u3067\u30010.0.4\u3092\u6307\u5b9a\n\n\nconfig/fluent-logger.yml\ndevelopment:\n  fluent_host: '0.0.0.0'\n  fluent_port: 24224\n  tag: 'rails.log'\n  messages_type: 'string'\n\nstaging:\n  fluent_host: '0.0.0.0'\n  fluent_port: 24224\n  tag: 'rails.log'\n  messages_type: 'string'\n\nproduction:\n  fluent_host: '0.0.0.0'\n  fluent_port: 24224\n  tag: 'rails.log'\n  messages_type: 'string'\n\n\n\nenvironments/production.rb\n  config.log_level = :info\n  config.logger = ActFluentLoggerRails::Logger.new\n\n\n\n\u6a29\u9650\u306e\u5909\u66f4\n\n\u30ed\u30b0\u306e\u53ce\u96c6\u306e\u305f\u3081\u306b\u6a29\u9650\u3092\u8a2d\u5b9a: http://dev.classmethod.jp/cloud/amazon-linux-fluentd-setup-plugin/\n\nIAM\u30ed\u30fc\u30eb\u3067\u3001\u7279\u5b9a\u306eS3\u30d0\u30b1\u30c3\u30c8\u3078\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u3092\u8a2d\u5b9a: https://github.com/fluent/fluent-plugin-s3#iam-policy\n\n\n\n\u30cf\u30de\u308a\u6240\n\nS3\u3078\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30bf\u30a4\u30df\u30f3\u30b0\nflush_interval\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u3001\u4e0b\u8a18\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u308b\n\nWARNING: By default, files are created on an hourly basis (around xx:10). This means that when you first import records using the plugin, no file is created immediately. The file will be created when the time_slice_format condition has been met. To change the output frequency, please modify the time_slice_format value. To write files every minute, please use %Y%m%d%H%M for the time_slice_format.\n\n\n\u53ce\u96c6\u306e\u8a2d\u8a08\u3092\u8003\u3048\u308b\n\n\u53ce\u96c6\u30dd\u30a4\u30f3\u30c8\n\nRails\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30ed\u30b0\n\nhttps://github.com/fluent/fluent-logger-ruby\n\nhttps://github.com/actindi/act-fluent-logger-rails (0.0.4\u307e\u3067\u304c Rails3.* \u7cfb)\n\n\nApache\n\naccess_log: http://docs.fluentd.org/articles/apache-to-s3\n\nerror_log: http://www.stormacq.com/storing-apache-access-and-error-logs-to-amazon-s3-with-fluentd/\n\n\n\n\u30ed\u30b0\u96c6\u7d04\n\nApache\u306e\u30ed\u30b0\u96c6\u7d04\u8a2d\u5b9a \u53c2\u8003\u306b\u306a\u308a\u305d\u3046 https://gist.github.com/vananasian/4215057\n\n\n\n\u6d3b\u7528\n\n\u3068\u308a\u3042\u3048\u305a\u3064\u3063\u3053\u3093\u3067\u3001\u5f8c\u3067EMR\u3067\u304c\u3093\u3070\u308b\n\n\nhttp://dev.classmethod.jp/cloud/aws/query-fluentd-logfiles-on-s3-with-emr/\n\n\nRedshift\u306f\u306a\u3093\u304b\u96e3\u3057\u305d\u3046\u3002\u9ad8\u305d\u3046\uff0e\uff0e\n\n\nhttp://gihyo.jp/dev/serial/01/redshift\nhttp://dev.classmethod.jp/cloud/aws/getting-started-redshift-1st-half/\nhttps://github.com/hapyrus/fluent-plugin-redshift\nhttp://developer.smartnews.be/blog/2013/10/03/easy-data-analysis-using-fluentd-redshift-and-tableau/\n\n\nMongoDB\u306a\u3089\u3001Capping Collection\u3067\u3001DB\u4e0a\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4e0a\u9650\u3092\u6c7a\u3081\u308c\u308b\u306e\u3067\u3001\u300c\u76f4\u8fd1\u306eDB\u306f\u9ad8\u901f\u3067\u691c\u7d22\u300d\u300c\u305d\u308c\u4ee5\u524d\u306e\u30c7\u30fc\u30bf\u306fS3(\u3055\u3089\u306b\u4ee5\u524d\u306e\u30c7\u30fc\u30bf\u306fGlacier)\u3067\u7ba1\u7406\u3060\u3051\u300d\u3060\u3068\u3001\u826f\u3044\u611f\u3058\u306a\u6c17\u304c\u3059\u308b\u3002\u305d\u306e\u65b9\u304c\u8a2d\u8a08\u65b9\u91dd\u3082\u3060\u3093\u3060\u3093\u3068\u6c7a\u3081\u308c\u305d\u3046\n\n\nhttp://www.mongohq.com/pricing/\n\n\n\u3042\u3068\u306f\u3001elasticsearch\u3067\u3068\u3044\u3046\u9078\u629e\u80a2\u3082\u3002\u3053\u308c\u3082\u7c21\u5358\u305d\u3046\u3002\n\n\nhttp://docs.fluentd.org/recipe/apache-logs/elasticsearch\n\n\n\n\n\u307e\u305f\u3042\u3068\u3067\n\n\u5206\u6790\u3092\u898b\u8d8a\u3057\u305f\u5404\u30ed\u30b0\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u8abf\u6574\n\u5b9f\u969b\u306b\u306a\u306b\u3067\u30c7\u30fc\u30bf\u5206\u6790\u3059\u308b\u304b\n\n\n##Fluentd\u3068\u306f\n* \u3053\u3093\u306a\u611f\u3058 (\u5f15\u7528: http://codezine.jp/static/images/article/6958/6958_02.gif)\n\n![fluentd](http://codezine.jp/static/images/article/6958/6958_02.gif)\n\n##\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\n* Rails\u306e\u30ed\u30b0\u3068\u3001\u30a6\u30a7\u30d6\u30b5\u30fc\u30d0\u306e\u6a19\u6e96\u7684\u306a\u30ed\u30b0\u3092\u3001S3\u306b\u96c6\u7d04\u3059\u308b\u69cb\u6210\n* fluentd\u306e\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u3001\u4e0b\u8a18URL\u304b\u3089\u3001\u5404\u30c7\u30a3\u30b9\u30c8\u30ea\u30d3\u30e5\u30fc\u30b7\u30e7\u30f3\u5225\u306b\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u95b2\u89a7\u53ef\u80fd\n* http://docs.treasuredata.com/articles/td-agent#install-td-agent\n\n###conf\n\n```td-agent.conf\n<match *.**>\n  type forest\n  subtype s3\n\n  <template>\n   aws_key_id xxx #IAM\u3067S3\u3078\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u3092\u3082\u3063\u305f\u3082\u306e\u3092\u6307\u5b9a(\u5f8c\u8ff0)\n   aws_sec_key xxx #IAM\u3067S3\u3078\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u3092\u3082\u3063\u305f\u3082\u306e\u3092\u6307\u5b9a(\u5f8c\u8ff0)\n   s3_bucket fluentd-logging\n   path others/\n   buffer_path /var/log/td-agent/buffer/${tag}\n\n   time_slice_format ${tag}/%Y%m%d%H\n   time_slice_wait 10m\n   flush_interval 1m\n\n   format_json true\n   include_time_key true\n   include_tag_key true\n\n   buffer_chunk_limit 256m\n  </template>\n</match>\n\n<source>\n type forward\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format apache2\n  path /var/log/httpd/access_log\n  pos_file /var/log/td-agent/apache2.access_log.pos\n  tag ${hostname}/apache.access\n </config>\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format /^\\[[^ ]* (?<time>[^\\]]*)\\] \\[(?<level>[^\\]]*)\\] \\[pid (?<pid>[^\\]]*)\\] \\[client (?<client>[^\\]]*)\\] (?<message>.*)$/\n  path /var/log/httpd/error_log\n  pos_file /var/log/td-agent/apache2.error_log.pos\n  tag ${hostname}/apache.error\n </config>\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format syslog\n  path /var/log/messages\n  pos_file /var/log/td-agent/syslog.messages.pos\n  tag ${hostname}/syslog.messages\n </config>\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format syslog\n  path /var/log/cron\n  pos_file /var/log/td-agent/syslog.cron.pos\n  tag ${hostname}/syslog.cron\n </config>\n</source>\n\n<source>\n type config_expander\n <config>\n  type tail\n  format syslog\n  path /var/log/secure\n  pos_file /var/log/td-agent/syslog.secure.pos\n  tag ${hostname}/syslog.secure\n </config>\n</source>\n```\n\n```Gemfile\ngem 'act-fluent-logger-rails', '0.0.4' #\u307e\u3060\u81ea\u793e\u74b0\u5883\u304c Rails3\u7cfb\u3060\u3063\u305f\u306e\u3067\u30010.0.4\u3092\u6307\u5b9a\n```\n\n```config/fluent-logger.yml\ndevelopment:\n  fluent_host: '0.0.0.0'\n  fluent_port: 24224\n  tag: 'rails.log'\n  messages_type: 'string'\n\nstaging:\n  fluent_host: '0.0.0.0'\n  fluent_port: 24224\n  tag: 'rails.log'\n  messages_type: 'string'\n\nproduction:\n  fluent_host: '0.0.0.0'\n  fluent_port: 24224\n  tag: 'rails.log'\n  messages_type: 'string'\n```\n\n```environments/production.rb\n  config.log_level = :info\n  config.logger = ActFluentLoggerRails::Logger.new\n```\n\n##\u6a29\u9650\u306e\u5909\u66f4\n* \u30ed\u30b0\u306e\u53ce\u96c6\u306e\u305f\u3081\u306b\u6a29\u9650\u3092\u8a2d\u5b9a: http://dev.classmethod.jp/cloud/amazon-linux-fluentd-setup-plugin/\n* IAM\u30ed\u30fc\u30eb\u3067\u3001\u7279\u5b9a\u306eS3\u30d0\u30b1\u30c3\u30c8\u3078\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u3092\u8a2d\u5b9a: https://github.com/fluent/fluent-plugin-s3#iam-policy\n\n##\u30cf\u30de\u308a\u6240\n\n* S3\u3078\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30bf\u30a4\u30df\u30f3\u30b0\n* flush_interval\u3092\u6307\u5b9a\u3057\u306a\u3044\u3068\u3001\u4e0b\u8a18\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u308b\n\n```\nWARNING: By default, files are created on an hourly basis (around xx:10). This means that when you first import records using the plugin, no file is created immediately. The file will be created when the time_slice_format condition has been met. To change the output frequency, please modify the time_slice_format value. To write files every minute, please use %Y%m%d%H%M for the time_slice_format.\n```\n\n##\u53ce\u96c6\u306e\u8a2d\u8a08\u3092\u8003\u3048\u308b\n\n###\u53ce\u96c6\u30dd\u30a4\u30f3\u30c8\n\n####Rails\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30ed\u30b0\n* https://github.com/fluent/fluent-logger-ruby\n* https://github.com/actindi/act-fluent-logger-rails (0.0.4\u307e\u3067\u304c Rails3.* \u7cfb)\n\n####Apache\n* access_log: http://docs.fluentd.org/articles/apache-to-s3\n* error_log: http://www.stormacq.com/storing-apache-access-and-error-logs-to-amazon-s3-with-fluentd/\n\n\n###\u30ed\u30b0\u96c6\u7d04\n* Apache\u306e\u30ed\u30b0\u96c6\u7d04\u8a2d\u5b9a \u53c2\u8003\u306b\u306a\u308a\u305d\u3046 https://gist.github.com/vananasian/4215057\n\n###\u6d3b\u7528\n* \u3068\u308a\u3042\u3048\u305a\u3064\u3063\u3053\u3093\u3067\u3001\u5f8c\u3067EMR\u3067\u304c\u3093\u3070\u308b\n  * http://dev.classmethod.jp/cloud/aws/query-fluentd-logfiles-on-s3-with-emr/\n* Redshift\u306f\u306a\u3093\u304b\u96e3\u3057\u305d\u3046\u3002\u9ad8\u305d\u3046\uff0e\uff0e\n  * http://gihyo.jp/dev/serial/01/redshift\n  * http://dev.classmethod.jp/cloud/aws/getting-started-redshift-1st-half/\n  * https://github.com/hapyrus/fluent-plugin-redshift\n  * http://developer.smartnews.be/blog/2013/10/03/easy-data-analysis-using-fluentd-redshift-and-tableau/\n* MongoDB\u306a\u3089\u3001Capping Collection\u3067\u3001DB\u4e0a\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4e0a\u9650\u3092\u6c7a\u3081\u308c\u308b\u306e\u3067\u3001\u300c\u76f4\u8fd1\u306eDB\u306f\u9ad8\u901f\u3067\u691c\u7d22\u300d\u300c\u305d\u308c\u4ee5\u524d\u306e\u30c7\u30fc\u30bf\u306fS3(\u3055\u3089\u306b\u4ee5\u524d\u306e\u30c7\u30fc\u30bf\u306fGlacier)\u3067\u7ba1\u7406\u3060\u3051\u300d\u3060\u3068\u3001\u826f\u3044\u611f\u3058\u306a\u6c17\u304c\u3059\u308b\u3002\u305d\u306e\u65b9\u304c\u8a2d\u8a08\u65b9\u91dd\u3082\u3060\u3093\u3060\u3093\u3068\u6c7a\u3081\u308c\u305d\u3046\n  * http://www.mongohq.com/pricing/\n* \u3042\u3068\u306f\u3001elasticsearch\u3067\u3068\u3044\u3046\u9078\u629e\u80a2\u3082\u3002\u3053\u308c\u3082\u7c21\u5358\u305d\u3046\u3002\n  * http://docs.fluentd.org/recipe/apache-logs/elasticsearch\n\n##\u307e\u305f\u3042\u3068\u3067\n* \u5206\u6790\u3092\u898b\u8d8a\u3057\u305f\u5404\u30ed\u30b0\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u8abf\u6574\n* \u5b9f\u969b\u306b\u306a\u306b\u3067\u30c7\u30fc\u30bf\u5206\u6790\u3059\u308b\u304b\n", "tags": ["\u5c0e\u5165\u624b\u9806", "fluentd"]}