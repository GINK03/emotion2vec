{"context": " More than 1 year has passed since last update.Docker\u30b3\u30f3\u30c6\u30ca\u306b\u30e1\u30fc\u30eb\u30ea\u30ec\u30fc\u30b5\u30fc\u30d0\u3092\u5c0e\u5165\u3059\u308b\u306e\u7d9a\u304d\u3067\u3059\u3002\n\u5c0e\u5165\u3057\u305f\u30e1\u30fc\u30eb\u30ea\u30ec\u30fc\u30b5\u30fc\u30d0\u306bClamSMTP\u3092\u5c0e\u5165\u3057\u3066\u3001\u30e1\u30fc\u30eb\u306e\u30a6\u30a4\u30eb\u30b9\u30ad\u30e3\u30f3\u3092\u884c\u3044\u307e\u3059\u3002\nDocker\u30b3\u30f3\u30c6\u30ca\u306bClamAV\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\u203bCentOS7\u306bClamAV\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3000\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u4e0b\u8a18URL\u304b\u3089ClamSMTP\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\nhttp://thewalter.net/stef/software/clamsmtp/clamsmtp-1.10.tar.gz\nClamSMTP\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\ntar vxf clamsmtp-1.10.tar.gz\ncd clamsmtp-1.10\n./configure && make && make install\ncp doc/clamsmtpd.conf /usr/local/etc/clamsmtpd.conf\ncp scripts/clamsmtpd.sh /etc/init.d/clamsmtpd.sh\n\n/usr/local/etc/clamsmtpd.conf\u30d5\u30a1\u30a4\u30eb\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\uff08\u629c\u7c8b\nvi /usr/local/etc/clamsmtpd.conf\nAction: drop\nClamAddress: /usr/local/sbin/clamd\nOutAddress: 10026\nListen: 0.0.0.0:10025\nHeader: X-Virus-Scanned: ClamAV using ClamSMTP\n\n/etc/clamd.conf\u30d5\u30a1\u30a4\u30eb\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\uff08\u629c\u7c8b\nvi /etc/clamd.conf\nLocalSocket /usr/local/sbin/clamd\n\n/etc/postfix/main.cf\u3000\u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u52a0\u3057\u307e\u3059\uff08\u629c\u7c8b\nvi /etc/postfix/main.cf\ncontent_filter = scan:127.0.0.1:10025\n\n/etc/postfix/master.cf \u3000\u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u52a0\u3057\u307e\u3059\uff08\u629c\u7c8b\nvi /etc/postfix/master.cf\nscan unix -       -       n       -       16       smtp\n   -o smtp_data_done_timeout=1200\n   -o smtp_send_xforward_command=yes\n   -o disable_dns_lookups=yes\n127.0.0.1:10026 inet n       -       n       -       16       smtpd\n   -o content_filter=\n   -o local_recipient_maps=\n   -o relay_recipient_maps=\n   -o smtpd_restriction_classes=\n   -o smtpd_client_restrictions=\n   -o smtpd_helo_restrictions=\n   -o smtpd_sender_restrictions=\n   -o smtpd_recipient_restrictions=permit_mynetworks,reject\n   -o mynetworks_style=host\n   -o smtpd_authorized_xforward_hosts=127.0.0.0/8\n\n\u5404\u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n  service clamd stop\n  service clamd start\n  /etc/init.d/clamsmtpd.sh start\n  service postfix restart\n\n\u30e1\u30fc\u30eb\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u30ea\u30ec\u30fc\u30b5\u30fc\u30d0\u7d4c\u7531\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\u30c6\u30b9\u30c8\u30a6\u30a4\u30eb\u30b9\u3092\u6dfb\u4ed8\u3057\u305f\u30e1\u30fc\u30eb\u3092\u9001\u4ed8\u3059\u308b\u3068/var/log/maillog\u306b\u4ee5\u4e0b\u306e\u30ed\u30b0\u304c\u8a18\u9332\u3055\u308c\u307e\u3059\u3002\nclamsmtpd: 100015: from=sample@smtp1.co.jp, to=sample2@smtp2.co.jp, status=VIRUS:Eicar-Test-Signature\nDocker\u30b3\u30f3\u30c6\u30ca\u306b\u30e1\u30fc\u30eb\u30ea\u30ec\u30fc\u30b5\u30fc\u30d0\u3092\u5c0e\u5165\u3059\u308b\u306e\u7d9a\u304d\u3067\u3059\u3002\n\n\u5c0e\u5165\u3057\u305f\u30e1\u30fc\u30eb\u30ea\u30ec\u30fc\u30b5\u30fc\u30d0\u306bClamSMTP\u3092\u5c0e\u5165\u3057\u3066\u3001\u30e1\u30fc\u30eb\u306e\u30a6\u30a4\u30eb\u30b9\u30ad\u30e3\u30f3\u3092\u884c\u3044\u307e\u3059\u3002\n\nDocker\u30b3\u30f3\u30c6\u30ca\u306bClamAV\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n\u203bCentOS7\u306bClamAV\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3000\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u4e0b\u8a18URL\u304b\u3089ClamSMTP\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\nhttp://thewalter.net/stef/software/clamsmtp/clamsmtp-1.10.tar.gz\n\nClamSMTP\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```bash\ntar vxf clamsmtp-1.10.tar.gz\ncd clamsmtp-1.10\n./configure && make && make install\ncp doc/clamsmtpd.conf /usr/local/etc/clamsmtpd.conf\ncp scripts/clamsmtpd.sh /etc/init.d/clamsmtpd.sh\n```\n/usr/local/etc/clamsmtpd.conf\u30d5\u30a1\u30a4\u30eb\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\uff08\u629c\u7c8b\n\nvi /usr/local/etc/clamsmtpd.conf\n\n```bash\nAction: drop\nClamAddress: /usr/local/sbin/clamd\nOutAddress: 10026\nListen: 0.0.0.0:10025\nHeader: X-Virus-Scanned: ClamAV using ClamSMTP\n```\n/etc/clamd.conf\u30d5\u30a1\u30a4\u30eb\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\uff08\u629c\u7c8b\n\nvi /etc/clamd.conf\n\n```bash\nLocalSocket /usr/local/sbin/clamd\n```\n\n/etc/postfix/main.cf\u3000\u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u52a0\u3057\u307e\u3059\uff08\u629c\u7c8b\n\nvi /etc/postfix/main.cf\n\n```bash\ncontent_filter = scan:127.0.0.1:10025\n```\n\n/etc/postfix/master.cf \u3000\u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u52a0\u3057\u307e\u3059\uff08\u629c\u7c8b\n\nvi /etc/postfix/master.cf\n\n```bash\nscan unix -       -       n       -       16       smtp\n   -o smtp_data_done_timeout=1200\n   -o smtp_send_xforward_command=yes\n   -o disable_dns_lookups=yes\n127.0.0.1:10026 inet n       -       n       -       16       smtpd\n   -o content_filter=\n   -o local_recipient_maps=\n   -o relay_recipient_maps=\n   -o smtpd_restriction_classes=\n   -o smtpd_client_restrictions=\n   -o smtpd_helo_restrictions=\n   -o smtpd_sender_restrictions=\n   -o smtpd_recipient_restrictions=permit_mynetworks,reject\n   -o mynetworks_style=host\n   -o smtpd_authorized_xforward_hosts=127.0.0.0/8\n```\n\n\u5404\u30b5\u30fc\u30d3\u30b9\u3092\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```bash\n  service clamd stop\n  service clamd start\n  /etc/init.d/clamsmtpd.sh start\n  service postfix restart\n```\n\n\u30e1\u30fc\u30eb\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u30ea\u30ec\u30fc\u30b5\u30fc\u30d0\u7d4c\u7531\u306e\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n\u30c6\u30b9\u30c8\u30a6\u30a4\u30eb\u30b9\u3092\u6dfb\u4ed8\u3057\u305f\u30e1\u30fc\u30eb\u3092\u9001\u4ed8\u3059\u308b\u3068/var/log/maillog\u306b\u4ee5\u4e0b\u306e\u30ed\u30b0\u304c\u8a18\u9332\u3055\u308c\u307e\u3059\u3002\n\nclamsmtpd: 100015: from=sample@smtp1.co.jp, to=sample2@smtp2.co.jp, status=VIRUS:Eicar-Test-Signature\n", "tags": ["docker", "postfix", "clamav"]}