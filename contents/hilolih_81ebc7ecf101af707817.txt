{"context": " More than 1 year has passed since last update.gollum\u3067\u306f\u81ea\u5206\u3067\u5b9a\u7fa9\u3057\u305f\u30de\u30af\u30ed\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3002\nMacros \u00b7 gollum/gollum Wiki\n\u67d0\u904a\u5712\u5730\u306e\u5f85\u3061\u6642\u9593\u3092Nokigiri\u3092\u4f7f\u3063\u3066\u8868\u793a\u3057\u3066\u307f\u305f\u3002\n\n\u30de\u30af\u30ed\u306e\u4f5c\u6210\n\u4e0a\u8a18\u30b5\u30a4\u30c8\u901a\u308a\u3001Gollum::Macro\u30af\u30e9\u30b9\u3092\u7d99\u627f\u3057\u3001render\u30e1\u30bd\u30c3\u30c9\u3092override\u3057\u305f\u3089\u5b8c\u6210\u3060\u3002\u30af\u30e9\u30b9\u540d\u304c\u305d\u306e\u307e\u307e\u30de\u30af\u30ed\u540d\u3068\u306a\u308b\u3002\u3061\u306a\u307f\u306b\u3001Nokogiri\u306fgollum\u3067\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067require\u305b\u305a\u3068\u3082\u305d\u306e\u307e\u307e\u4f7f\u3048\u308b\u3002\n\nclass Gollum::Macro::WaitDisney < Gollum::Macro\n    URL = \"http://s.tokyodisneyresort.jp/tdl/atrc_list.htm\"\n    def render(*args)\n        charset = nil\n        html = open(URL) do |f|\n            charset = f.charset # \u6587\u5b57\u7a2e\u5225\u3092\u53d6\u5f97\n            f.read # html\u3092\u8aad\u307f\u8fbc\u3093\u3067\u5909\u6570html\u306b\u6e21\u3059\n        end\n\n        # html\u3092\u30d1\u30fc\u30b9(\u89e3\u6790)\u3057\u3066\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\n        doc = Nokogiri::HTML.parse(html, nil, charset)\n        #\n        result  = \"<table><thead><tr>\"\n        result += \"<th align=\\\"center\\\">\u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u540d</th>\"\n        result += \"<th align=\\\"center\\\">\u5f85\u3061\u6642\u9593</th>\"\n        result += \"<th align=\\\"center\\\">\u66f4\u65b0\u6642\u9593</th>\"\n        result += \"</tr></thead><tbody>\"\n        list_wait_atractions( doc, args ).each do |k ,v|\n            result += \"<tr>\"\n            result += \"<td align=\\\"left\\\">#{k}\uff08#{v[:run]}\uff09</td>\"\n            result += \"<td align=\\\"left\\\">#{v[:wait]}</td>\"\n            result += \"<td align=\\\"left\\\">#{v[:update]}</td>\"\n            result += \"</tr>\"\n        end\n        result += \"</tbody></table>\"\n        result\n    end\n\n    def list_wait_atractions doc, atractions\n        lists = Hash.new\n        atractions.each do |href|\n            doc.xpath(\"//a[@href=\\\"#{href}\\\"]\").each do |node|\n                title      = node.xpath('div[@class=\"about\"]/h3').inner_text\n                run        = node.xpath('div[@class=\"about\"]/p[@class=\"run\"]').inner_text\n                waittime   = node.xpath('div[@class=\"time\"]/p[@class=\"waitTime\"]/strong').text\n                if waittime.nil? || waittime.empty?\n                    waittime = \"-\"\n                end\n                updatetime = node.xpath('p[@class=\"update\"]').text\n                lists[title] = { wait: waittime, update: updatetime, run: run }\n            end\n        end\n        lists\n    end\nend\n\n\n\u4f7f\u3044\u65b9\n\u3053\u3093\u306a\u611f\u3058\u3067markdown\u306b\u8cbc\u308a\u4ed8\u3051\u308b\u3002\n\n<<WaitDisney(\n\"/tdl/atrc/al_western.html\",\n\"/tdl/atrc/al_carib.html\",\n\"/tdl/atrc/tl_grand.html\",\n\"/tdl/atrc/tl_jets.html\",\n\"/tdl/atrc/tl_monster.html\",\n\"/tdl/atrc/tt_minnie.html\",\n\"/tdl/atrc/tt_toon.html\",\n\"/tdl/greeting/tt_mickey.html\",\n\"/tdl/atrc/wb_omnibus.html\",\n\"/tdl/atrc/fl_philhar.html\",\n\"/tdl/atrc/fl_small.html\",\n\"/tdl/atrc/fl_castle.html\",\n\"/tdl/atrc/fl_alice.html\",\n\"/tdl/atrc/fl_pooh.html\",\n\"/tdl/atrc/fl_pinocchio.html\",\n\"/tdl/atrc/fl_snow.html\",\n\"/tdl/atrc/wl_country.html\",\n)>>\n\n\n\u516c\u5f0f\u30da\u30fc\u30b8\u304c\u4f7f\u3044\u3065\u3089\u3044\u3068\u601d\u3063\u3066\u3001\u884c\u304d\u305f\u3044\u3068\u3053\u308d\u3060\u3051\u3092\u30ea\u30b9\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3064\u3082\u308a\u3067\u4f5c\u3063\u305f\u304c\u3001\u4f5c\u3063\u3066\u3044\u308b\u3046\u3061\u306b\u516c\u5f0f\u30da\u30fc\u30b8\u306b\u6163\u308c\u3066\u304d\u3066\u3057\u307e\u3063\u3066\u7d50\u5c40\u307b\u3068\u3093\u3069\u307f\u306a\u304b\u3063\u305f\u3002\ngollum\u3067\u306f\u81ea\u5206\u3067\u5b9a\u7fa9\u3057\u305f\u30de\u30af\u30ed\u3092\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n[Macros \u00b7 gollum/gollum Wiki](https://github.com/gollum/gollum/wiki/Macros)\n\n\u67d0\u904a\u5712\u5730\u306e\u5f85\u3061\u6642\u9593\u3092Nokigiri\u3092\u4f7f\u3063\u3066\u8868\u793a\u3057\u3066\u307f\u305f\u3002\n\n\u30de\u30af\u30ed\u306e\u4f5c\u6210\n-----------\n\n\u4e0a\u8a18\u30b5\u30a4\u30c8\u901a\u308a\u3001Gollum::Macro\u30af\u30e9\u30b9\u3092\u7d99\u627f\u3057\u3001render\u30e1\u30bd\u30c3\u30c9\u3092override\u3057\u305f\u3089\u5b8c\u6210\u3060\u3002\u30af\u30e9\u30b9\u540d\u304c\u305d\u306e\u307e\u307e\u30de\u30af\u30ed\u540d\u3068\u306a\u308b\u3002\u3061\u306a\u307f\u306b\u3001Nokogiri\u306fgollum\u3067\u4f7f\u3063\u3066\u3044\u308b\u306e\u3067require\u305b\u305a\u3068\u3082\u305d\u306e\u307e\u307e\u4f7f\u3048\u308b\u3002\n\n~~~ruby\n\nclass Gollum::Macro::WaitDisney < Gollum::Macro\n    URL = \"http://s.tokyodisneyresort.jp/tdl/atrc_list.htm\"\n    def render(*args)\n        charset = nil\n        html = open(URL) do |f|\n            charset = f.charset # \u6587\u5b57\u7a2e\u5225\u3092\u53d6\u5f97\n            f.read # html\u3092\u8aad\u307f\u8fbc\u3093\u3067\u5909\u6570html\u306b\u6e21\u3059\n        end\n\n        # html\u3092\u30d1\u30fc\u30b9(\u89e3\u6790)\u3057\u3066\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u751f\u6210\n        doc = Nokogiri::HTML.parse(html, nil, charset)\n        #\n        result  = \"<table><thead><tr>\"\n        result += \"<th align=\\\"center\\\">\u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u540d</th>\"\n        result += \"<th align=\\\"center\\\">\u5f85\u3061\u6642\u9593</th>\"\n        result += \"<th align=\\\"center\\\">\u66f4\u65b0\u6642\u9593</th>\"\n        result += \"</tr></thead><tbody>\"\n        list_wait_atractions( doc, args ).each do |k ,v|\n            result += \"<tr>\"\n            result += \"<td align=\\\"left\\\">#{k}\uff08#{v[:run]}\uff09</td>\"\n            result += \"<td align=\\\"left\\\">#{v[:wait]}</td>\"\n            result += \"<td align=\\\"left\\\">#{v[:update]}</td>\"\n            result += \"</tr>\"\n        end\n        result += \"</tbody></table>\"\n        result\n    end\n\n    def list_wait_atractions doc, atractions\n        lists = Hash.new\n        atractions.each do |href|\n            doc.xpath(\"//a[@href=\\\"#{href}\\\"]\").each do |node|\n                title      = node.xpath('div[@class=\"about\"]/h3').inner_text\n                run        = node.xpath('div[@class=\"about\"]/p[@class=\"run\"]').inner_text\n                waittime   = node.xpath('div[@class=\"time\"]/p[@class=\"waitTime\"]/strong').text\n                if waittime.nil? || waittime.empty?\n                    waittime = \"-\"\n                end\n                updatetime = node.xpath('p[@class=\"update\"]').text\n                lists[title] = { wait: waittime, update: updatetime, run: run }\n            end\n        end\n        lists\n    end\nend\n~~~\n\n\u4f7f\u3044\u65b9\n-----\n\n\u3053\u3093\u306a\u611f\u3058\u3067markdown\u306b\u8cbc\u308a\u4ed8\u3051\u308b\u3002\n\n~~~\n\n<<WaitDisney(\n\"/tdl/atrc/al_western.html\",\n\"/tdl/atrc/al_carib.html\",\n\"/tdl/atrc/tl_grand.html\",\n\"/tdl/atrc/tl_jets.html\",\n\"/tdl/atrc/tl_monster.html\",\n\"/tdl/atrc/tt_minnie.html\",\n\"/tdl/atrc/tt_toon.html\",\n\"/tdl/greeting/tt_mickey.html\",\n\"/tdl/atrc/wb_omnibus.html\",\n\"/tdl/atrc/fl_philhar.html\",\n\"/tdl/atrc/fl_small.html\",\n\"/tdl/atrc/fl_castle.html\",\n\"/tdl/atrc/fl_alice.html\",\n\"/tdl/atrc/fl_pooh.html\",\n\"/tdl/atrc/fl_pinocchio.html\",\n\"/tdl/atrc/fl_snow.html\",\n\"/tdl/atrc/wl_country.html\",\n)>>\n\n~~~\n\n\u516c\u5f0f\u30da\u30fc\u30b8\u304c\u4f7f\u3044\u3065\u3089\u3044\u3068\u601d\u3063\u3066\u3001\u884c\u304d\u305f\u3044\u3068\u3053\u308d\u3060\u3051\u3092\u30ea\u30b9\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3064\u3082\u308a\u3067\u4f5c\u3063\u305f\u304c\u3001\u4f5c\u3063\u3066\u3044\u308b\u3046\u3061\u306b\u516c\u5f0f\u30da\u30fc\u30b8\u306b\u6163\u308c\u3066\u304d\u3066\u3057\u307e\u3063\u3066\u7d50\u5c40\u307b\u3068\u3093\u3069\u307f\u306a\u304b\u3063\u305f\u3002\n", "tags": ["gollum", "gollum-lib"]}