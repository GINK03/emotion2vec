{"tags": ["CakePHP", "\u52c9\u5f37\u4f1a", "rest", "JavaScript", "AWS"], "context": " More than 1 year has passed since last update.\n\n \u306f\u3058\u3081\u306b\n\u672c\u6295\u7a3f\u306f\u30012015/5/22\u306b\u884c\u308f\u308c\u305f\u3001CakePHP\u3067\u5b9f\u88c5\u3059\u308b\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd - connpass\u306e\u5185\u5bb9\u306b\u3064\u3044\u3066\u307e\u3068\u3081\u305f\u8cc7\u6599\u3067\u3059\u3002\n\u4eca\u5f8c\u306e\u4e88\u5b9a\nAWS\u4e0a\u3067\u69cb\u7bc9\u3059\u308bRESTful\u30a2\u30d7\u30ea\u52c9\u5f37\u4f1a\uff5eWeb\u958b\u767a\u30ef\u30fc\u30af\u30b7\u30e7\u30c3\u30d7\uff5e - connpass\n\u4eca\u56de\u306f\u3001\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u7b2c2\u56de\u3067Backbone.js\u3092\u4f7f\u7528\u3057\u3066\u753b\u9762\u3092\u4f5c\u308a\u307e\u3057\u305f\u304c\u3001\u305d\u308c\u4ee5\u6765\u306e\u6a5f\u80fd\u8ffd\u52a0\u3067\u3059\uff01\n\n 2015/5/25\u8ffd\u8a18 - 1\nphpMyAdmin\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u3001\u3068\u3044\u3046\u65b9\u304c\u4f55\u540d\u304b\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u3057\u305f\u3002\n\n/etc/httpd/conf/httpd.conf(66\u884c\u76ee\u304b\u3089)\nUser study\nGroup apache\n\n\n\u3067\u3042\u308b\u3079\u304d\u306a\u3093\u3067\u3059\u304c\u3001\u306a\u305c\u304b\u3001\n\n/etc/httpd/conf/httpd.conf\nUser study\nGroup wheel\n\n\n\u3068\u3001Group\u304cwheel\u306b\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\nroot\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3001\u305d\u3053\u3092\u76f4\u3057\u3066apache\u518d\u8d77\u52d5(service httpd restart)\u3059\u308c\u3070OK\u3067\u3057\u305f\u3002\n\u203b\u7b2c1\u56de\u306eQiita\u8a18\u4e8b\u4f5c\u6210\u3068\u524d\u5f8c\u3057\u3066\u3001\u958b\u767a\u74b0\u5883\u306e\u5143\u3068\u3059\u308bAMI\u3092\u76f4\u524d\u306b\u4fee\u6b63\u3057\u305f\u308a\u3057\u3066\u3044\u305f\u306e\u3067\u3001\u305d\u306e\u3078\u3093\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u307e\u3061\u304c\u3063\u305f\u8a2d\u5b9a\u306eAMI\u3092\u4e00\u6642\u516c\u958b\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\u7533\u3057\u8a33\u3054\u3056\u3044\u307e\u305b\u3093\uff01\n 2015/5/25\u8ffd\u8a18 - 2\n\u30e6\u30fc\u30b6\u60c5\u5831\u306f\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3066\u304b\u3089\u4fdd\u5b58\u3057\u307e\u3059\u306e\u3067\u3001phpMyAdmin\u3067\u30c7\u30fc\u30bf\u8ffd\u52a0\u3057\u3066\u3082\u30ed\u30b0\u30a4\u30f3\u6642\u306b\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u3054\u6ce8\u610f\u4e0b\u3055\u3044\u3002\n\n \u30ed\u30b0\u30a4\u30f3\u3068\u306f\uff1f\n\u7531\u6765\u306f\u3053\u3046\u3044\u3046\u3053\u3068\u3089\u3057\u3044\u3067\u3059\u3002\n\u305d\u308c\u306f\u3055\u3066\u304a\u304d\u3001\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\u969b\u306b\u3084\u308b\u3079\u304d\u3053\u3068\u306f\u6b21\u306e\uff12\u3064\u3067\u3059\u3002\n\n\u8a8d\u8a3c - Authentication\n\u627f\u8a8d(\u8a8d\u53ef) - Authorization\n\n\n\u8a8d\u8a3c - Authentication \u3068\u306f\uff1f\n\u8a8d\u8a3c\u3068\u306f\u3001\u300c\u672c\u4eba\u78ba\u8a8d\u300d\u3068\u8a00\u3063\u3066\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n\u4eca\u56de\u4f5c\u6210\u3059\u308b\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3067\u306f\u3001\u30b7\u30f3\u30d7\u30eb\u306a\u30d5\u30a9\u30fc\u30e0\u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u3064\u307e\u308a\u3001\u300c\u30e6\u30fc\u30b6ID\u300d\u3068\u300c\u30d1\u30b9\u30ef\u30fc\u30c9\u300d\u3092\u4f7f\u7528\u3057\u3001\u6b63\u3057\u3051\u308c\u3070\u672c\u4eba\u3067\u3042\u308b\u3068\u307f\u306a\u3057\u307e\u3059\u3002\n\u300c\u30ed\u30b0\u30a4\u30f3\u300d\u3068\u3044\u3063\u305f\u5834\u5408\u901a\u5e38\u306f\u3053\u306e\u300c\u8a8d\u8a3c\u300d\u3092\u6307\u3057\u307e\u3059\u304c\u3001\u300c\u627f\u8a8d\u300d\u51e6\u7406\u3068\u30bb\u30c3\u30c8\u3067\u5b9f\u88c5\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u627f\u8a8d(\u8a8d\u53ef) - Authorization \u3068\u306f\uff1f\n\u300c\u8a8d\u8a3c\u300d\u3055\u308c\u305f\u30e6\u30fc\u30b6\u306b\u5bfe\u3057\u3001\u7279\u5b9a\u306e\u30ea\u30bd\u30fc\u30b9\u3084\u30b5\u30fc\u30d3\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u3053\u3068\u3092\u8a00\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u8a8d\u8a3c\u3055\u308c\u305f\u30e6\u30fc\u30b6\u306b\u306f\u5168\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u3053\u3068\u3068\u3057\u307e\u3059\u3002\n\n \u4eca\u56de\u306e\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u5b9f\u88c5\u306e\u7279\u6b8a\u306a\u3068\u3053\u308d\n\u3053\u306e\u52c9\u5f37\u4f1a\u306e\u5927\u524d\u63d0\u306f\u300cREST\u300d\u3001\u300cSinglePageApplication(SPA)\u300d\u3067\u3059\u3002\nSPA\u3067\u3082REST\u3067\u3082\u306a\u3044\u3001\u901a\u5e38\u306eCakePHP\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u3067\u30da\u30fc\u30b8\u751f\u6210\u3059\u308b\u666e\u901a\u306eWeb\u30a2\u30d7\u30ea\uff09\u3060\u3068\u3001\u672a\u8a8d\u8a3c\u72b6\u614b\u3067\u8a8d\u8a3c\u304c\u5fc5\u8981\u306a\u30da\u30fc\u30b8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u5834\u5408\u3001\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u307e\u3059\u3002\n\u3067\u3059\u304c\u3001SPA\u306e\u5834\u5408\u306f\u30b5\u30fc\u30d0\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306f\u5168\u3066RestAPI\u3092\u901a\u3058\u3066\u884c\u308f\u308c\u308b\u306e\u3067\u3001\u57fa\u672c\u7684\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002\u5358\u306bHTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9401(Unauthorized)\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8fd4\u3057\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u81ea\u8eab\u3067\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\u672a\u8a8d\u8a3c\u306e\u72b6\u614b\u3067\u306e\u5168\u3066\u306eAPI\u30ea\u30af\u30a8\u30b9\u30c8\u306f\u3001HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9401\u3092\u8fd4\u3059\u53ef\u80fd\u6027\u304c\u3042\u308b\u306e\u3067\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u306f\u305d\u308c\u306b\u5bfe\u5fdc\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n \u4eca\u56de\u306e\u5185\u5bb9\n\u4eca\u56de\u306f\u3001\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002\u3051\u3063\u3053\u3046\u591a\u3044\u306e\u3067\u9811\u5f35\u308a\u307e\u3057\u3087\u3046\uff01\n\n\u6a5f\u80fd\u30ea\u30b9\u30c8\n\n\u30e6\u30fc\u30b6\u767b\u9332\n\n\n\u30e6\u30fc\u30b6\u540d\u3068\u6c0f\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3001\u65b0\u898f\u30e6\u30fc\u30b6\u3092\u767b\u9332\u3057\u307e\u3059\n\n\n\u6210\u529f\u3059\u308c\u3070\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\n\n\n\n\n\u30ed\u30b0\u30a4\u30f3\n\n\n\u30e6\u30fc\u30b6\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3001\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\n\n\n\u6b63\u3057\u3051\u308c\u3070TODO\u4e00\u89a7\u753b\u9762\u306b\u9077\u79fb\n\u9593\u9055\u3063\u3066\u3044\u308c\u3070\u30a8\u30e9\u30fc\u3092\u8868\u793a\n\u65e2\u306b\u4ed6\u306e\u30e6\u30fc\u30b6\u304c\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306e\u5834\u5408\u305d\u306e\u65e8\u8868\u793a\n\u81ea\u5206\u81ea\u8eab\u304c\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3042\u308c\u3070TODO\u4e00\u89a7\u753b\u9762\u306b\u9077\u79fb\n\n\n\n\n\u30ed\u30b0\u30a2\u30a6\u30c8\n\n\n\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u72b6\u614b\u3067\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\n\n\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\n\n\n\n\n\u30d8\u30c3\u30c0\u8868\u793a\n\n\n\u30ed\u30b0\u30a4\u30f3\u4e2d\u306f\u753b\u9762\u4e0a\u90e8\uff08\u30d8\u30c3\u30c0\uff09\u306b\u30e6\u30fc\u30b6\u540d\u3068\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u3092\u5e38\u306b\u8868\u793a\u3059\u308b\u3002\n\n\n\u8a8d\u8a3c\u6e08\u307f\u30c1\u30a7\u30c3\u30af\n\n\n\u672a\u8a8d\u8a3c\u30e6\u30fc\u30b6\u306b\u3088\u308b\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306f\u5168\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\u3055\u305b\u308b\n\n\n\n\n\u753b\u9762\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\n\n\u30ed\u30b0\u30a4\u30f3\u3068\u30e6\u30fc\u30b6\u767b\u9332\n\n\n\u753b\u9762\u4e0a\u534a\u5206\u304c\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3001\u4e0b\u534a\u5206\u304c\u30e6\u30fc\u30b6\u767b\u9332\u753b\u9762\u3067\u3059\u3002\n\u30e6\u30fc\u30b6\u767b\u9332\u3067\u306f\u3001\u30e6\u30fc\u30b6\u540d\u3068\u6c0f\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u767b\u9332\u3057\u307e\u3059\u3002\n\n \u767b\u9332\u306b\u306f\u300c\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u518d\u5165\u529b\u300d\u6b04\u3092\u7528\u610f\u3059\u308b\u306e\u304c\u30bb\u30aa\u30ea\u30fc\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u30b7\u30f3\u30d7\u30eb\u306b\u3059\u308b\u70ba\u3042\u3048\u3066\u7528\u610f\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\n\n\u4f59\u529b\u304c\u3042\u308c\u3070\u4ed8\u3051\u3066\u307f\u307e\u3057\u3087\u3046\uff01\n\n\n\n\n\n\n\nTODO\u4e00\u89a7\u753b\u9762\n\n\n\u753b\u9762\u4e0a\u90e8\u306b\u30d8\u30c3\u30c0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u30e6\u30fc\u30b6\u540d\u3068\u3001\u30ab\u30c3\u30b3\u5185\u306b\u6c0f\u540d\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\n\n\n\nTODO\u8a73\u7d30\u753b\u9762\n\n\n\u540c\u3058\u304f\u30d8\u30c3\u30c0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n\n\n\n\n \u4e8b\u524d\u6e96\u5099\n\u4e8b\u524d\u6e96\u5099\u306f\u6bce\u56de\u540c\u3058\u306a\u306e\u3067\u3001\u5225\u30a8\u30f3\u30c8\u30ea\u306b\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\u516812\u56de\u306e\u52c9\u5f37\u4f1a\u3067\u3084\u3063\u3066\u3044\u308bGit\u306e\u4f7f\u3044\u65b9 - AWS\u4e0a\u3067\u69cb\u7bc9\u3059\u308bRESTful\u30a2\u30d7\u30ea\u52c9\u5f37\u4f1a\uff5eWeb\u958b\u767a\u30ef\u30fc\u30af\u30b7\u30e7\u30c3\u30d7\uff5e - Qiita\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3084\u308b\u3053\u3068\u306f\u3001\n\ngit\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u6574\u3048\u3066\u4eca\u56de\u7528\u30d6\u30e9\u30f3\u30c1vol/05\u3092\u4f5c\u6210\u3059\u308b\n\n\u3067\u3059\u3002\u307e\u305a\u3053\u308c\u3092\u3084\u308a\u307e\u3057\u3087\u3046\u3002\u4eca\u56de\u306f\u3055\u3089\u306b\u3001\n\n\u30e6\u30fc\u30b6\u767b\u9332\u7528\u306e\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n\n\u3082\u884c\u3044\u307e\u3059\u3002\n\n\u30e6\u30fc\u30b6\u767b\u9332\u7528\u306e\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n\u4f5c\u6210\u3059\u308b\u306e\u306f\u3001users\u30c6\u30fc\u30d6\u30eb\u3067\u3059\u3002\n\u307e\u305a\u3001phpMyAdmin\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u3087\u3046\u3002\nURL\u306f\u3001http://(PublicIP)/phpMyAdmin/\u3067\u3059\u3002\n\u5909\u66f4\u3057\u3066\u3044\u306a\u3051\u308c\u3070\u3001\u30e6\u30fc\u30b6\u540dstudy\u3001\u30d1\u30b9\u30ef\u30fc\u30c9study\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\u3002\n\u4e0b\u56f3\u306e\u901a\u308a\u3001\u5de6\u5074\u30da\u30a4\u30f3\u306e[study]-[New]\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u4e0b\u8a18\u306e\u901a\u308a\u8a2d\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n\u30c6\u30fc\u30d6\u30eb\u540d\nusers\n\n\u5404\u5217\u306e\u8a2d\u5b9a\n\n\n\n\u540d\u524d\n\u30c7\u30fc\u30bf\u578b\n\u9577\u3055/\u5024\n\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\n\u7167\u5408\u9806\u5e8f\n\u5c5e\u6027\nNULL\n\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\nA_I(AutoIncrement)\n\u30b3\u30e1\u30f3\u30c8\n\n\n\n\nid\nINT\n10\n\u306a\u3057\n\u3000\nUNSIGNED\n\u3000\nPRIMARY\n\u30ec\nid\n\n\nusername\nVARCHAR\n20\n\u306a\u3057\nutf8_general_ci\n\u3000\n\u3000\nUNIQUE\n\u3000\n\u30e6\u30fc\u30b6\u540d\n\n\npassword\nVARCHAR\n100\n\u306a\u3057\nutf8_general_ci\n\u3000\n\u3000\n\u3000\n\u3000\n\u30d1\u30b9\u30ef\u30fc\u30c9\n\n\nname\nVARCHAR\n50\n\u306a\u3057\nutf8_general_ci\n\u3000\n\u3000\n\u3000\n\u3000\n\u6c0f\u540d\n\n\n\n\n\u305d\u306e\u4ed6\u306e\u8a2d\u5b9a\n\n\u30c6\u30fc\u30d6\u30eb\u306e\u30b3\u30e1\u30f3\u30c8:\u30e6\u30fc\u30b6\n\n\u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3:InnoDB\n\n\u7167\u5408\u9806\u5e8f:utf8_general_ci\n\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u5b9a\u7fa9:\u7a7a\u767d\n\n\u300c\u4fdd\u5b58\u3059\u308b\u300d\u30af\u30ea\u30c3\u30af\u3067\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\uff01\n\n\u6e96\u5099\n\u3067\u306f\u3001\u6e96\u5099\u3092\u59cb\u3081\u307e\u3057\u3087\u3046\uff01\n\n\n Git\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u6574\u3048\u3066\u3001vol/05\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u6210\u3002\n\n \u30e6\u30fc\u30b6\u767b\u9332\u7528\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3002\n\n\u6e96\u5099\u304c\u3067\u304d\u305f\u3089\u3001Lesson1\u3067\u3059\uff01\n\n Lesson1 \u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\nLesson1\u3067\u306f\u3001\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u30c6\u30b9\u30c8\u306b\u306f\u3001\u7b2c1\u56de\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u300cPOSTMAN\u300d\u3092\u4f7f\u7528\u3057\u3066API\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30dd\u30a4\u30f3\u30c8\nSPA\u3067\u306a\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3001WebAPI\u3092\u4f7f\u7528\u3057\u305fSPA\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5b9f\u88c5\u306e\u4ed5\u65b9\u306e\u9055\u3044\u3092\u6291\u3048\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067TODO\u4e00\u89a7\u3092\u8868\u793a\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\n\nSPA\u3067\u306a\u3044\u901a\u5e38\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\n\u3053\u3046\u3044\u3046\u30b7\u30fc\u30b1\u30f3\u30b9\u3067\u3059\u3002\n\n\nTODO\u4e00\u89a7\u753b\u9762\u3092\u30b5\u30fc\u30d0\u306b\u8981\u6c42\n\u30b5\u30fc\u30d0\u306f\u3001\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u304b\u3089\u306e\u8981\u6c42\u306a\u306e\u3067\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9302\u3092\u8fd4\u3057\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u305b\u308b\u3002\n302\u3092\u53d7\u3051\u305f\u30d6\u30e9\u30a6\u30b6\u304c\u3001Location\u30d8\u30c3\u30c0\u3067\u6307\u5b9a\u3055\u308c\u305fURL\u3092\u8981\u6c42\n\u30b5\u30fc\u30d0\u306f\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306eHTML\u3092\u8fd4\u3059\n\n\nSPA\u306e\u5834\u5408\n\u3053\u3046\u306a\u308a\u307e\u3059\u3002\n\n\nTODO\u4e00\u89a7\u753b\u9762\u3092\u30b5\u30fc\u30d0\u306b\u8981\u6c42\n\u30b5\u30fc\u30d0\u306f\u3001\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u304b\u3089\u306e\u8981\u6c42\u306a\u306e\u3067\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9401\u3092\u8fd4\u3057\u3001\u8981\u6c42\u304c\u8a31\u53ef\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u5fdc\u7b54\u3059\u308b\u3002\n401\u3092\u53d7\u3051\u308b\u3068Javascript\u304c\u81ea\u5206\u3067\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u9055\u3044\u3092\u6291\u3048\u3066\u304a\u304d\u307e\u3057\u3087\u3046\uff01\n\n\u4f5c\u6210\u3059\u308bAPI\n\n\n\nURL\nHttp Method\n\u51e6\u7406\nController\nAction\n\n\n\n\n/rest-study/users/login.json\nPOST\n\u30ed\u30b0\u30a4\u30f3\u3059\u308b\nUsersController\nlogin\n\n\n/rest-study/users/logout.json\nPOST\n\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\nUsersController\nlogout\n\n\n/rest-study/users/loggedin.json\nGET\n\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u53d6\u5f97\uff08\u30ed\u30b0\u30a4\u30f3\u4e2d\u304b\u3069\u3046\u304b\u306e\u30c1\u30a7\u30c3\u30af\uff09\nUsersController\nloggedIn\n\n\n/rest-study/users/signup.json\nPOST\n\u30e6\u30fc\u30b6\u3092\u767b\u9332\u3059\u308b\nUsersController\nsignUp\n\n\n\n\n\u7de8\u96c6\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\n\n\n\n\u7de8\u96c6\nfile\n\u7de8\u96c6\u6982\u8981\n\n\n\n\n\u4fee\u6b63\napp/Config/routes.php\n\u8ffd\u52a0\u3059\u308bAPI\u3078\u306e\u30eb\u30fc\u30c8\u8ffd\u52a0\n\n\n\u4fee\u6b63\napp/Controller/AppController.php\nAuth\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u8a2d\u5b9a\n\n\n\u65b0\u898f\napp/Controller/UsersController.php\nAPI\u5b9f\u88c5\n\n\n\u65b0\u898f\napp/Model/User.php\n\u30e6\u30fc\u30b6\u30c6\u30fc\u30d6\u30eb\u3078\u306e\u30a2\u30af\u30bb\u30b9\n\n\n\n\nroutes.php\n\u8ffd\u52a0\u3057\u305fAPI\u3078\u306e\u30eb\u30fc\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nroutes.php\n\u301c\u7565\u301c\n /*\n  * API\n  */\n+\n+// \u30ed\u30b0\u30a4\u30f3\n+Router::connect('/users/login', array (\n+   'controller' => 'users',\n+   'action' => 'login',\n+   'method' => array (\n+       'POST'\n+   )\n+));\n+\n+// \u30ed\u30b0\u30a2\u30a6\u30c8\n+Router::connect('/users/logout', array (\n+   'controller' => 'users',\n+   'action' => 'logout',\n+   'method' => 'POST'\n+));\n+\n+// \u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af(\u30ed\u30b0\u30a4\u30f3\u60c5\u5831\u53d6\u5f97)\n+Router::connect('/users/loggedin', array (\n+   'controller' => 'users',\n+   'action' => 'loggedIn',\n+   'method' => 'GET'\n+));\n+\n+// \u30b5\u30a4\u30f3\u30a2\u30c3\u30d7\n+Router::connect('/users/signup', array (\n+   'controller' => 'users',\n+   'action' => 'signUp',\n+   'method' => array (\n+       'POST'\n+   )\n+));\n+\n+\n Router::mapResources(array (\n    'todo_lists',\n ));\n Router::parseExtensions('json');\n\u301c\u7565\u301c\n\n\n\u5358\u7d14\u306aCRUD\u3092\u5b9f\u884c\u3059\u308bAPI\u3067\u3042\u308c\u3070\u3001\nRouter::mapResources()\u95a2\u6570\u3067Controller\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u308c\u3070\nindex, view, add, edit, delete\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3078\u306e\u30eb\u30fc\u30c8\u304c\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u304c\u3001\u30ed\u30b0\u30a4\u30f3\u306eURL\u306f\u3053\u3046\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u500b\u5225\u306b\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\nRouter::connect()\u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u4e0b\u8a18\u9805\u76ee\u3092\u5168\u3066\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\nURL\n\u5b9f\u884c\u3059\u308bcontroller\n\u5b9f\u884c\u3059\u308baction\n\u5bfe\u8c61\u3068\u3059\u308bhttp\u30e1\u30bd\u30c3\u30c9\n\n\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\u3001\n\nURL -> /users/login\n\n\u5b9f\u884c\u3059\u308bcontroller -> users\n\n\u5b9f\u884c\u3059\u308baction -> login\n\n\u5bfe\u8c61\u3068\u3059\u308bhttp\u30e1\u30bd\u30c3\u30c9 -> POST\n\n\n\u306a\u306e\u3067\u3001\u4e0a\u8a18\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nAppController.php\n\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3001\u627f\u8a8d\u51e6\u7406\u3092\u8ffd\u52a0\u3002\n\nroutes.php\n class AppController extends Controller {\n-    public $components = array(\n-        'RequestHandler'\n-    );\n+   public $components = array (\n+       'RequestHandler',\n+       'Auth' => array (\n+           'authenticate' => array (\n+               'Form' => array (\n+                   'passwordHasher' => 'Blowfish'\n+               )\n+           )\n+       )\n+   );\n+\n+   public function beforeFilter() {\n+       $user = $this->Auth->user();\n+       if ($user === null\n+               && $this->request->params['controller'] !== 'users'\n+               && $this->request->params['action'] !== 'login'\n+               && $this->request->params['action'] !== 'logout'\n+               && $this->request->params['action'] !== 'loggedin'\n+               && $this->request->params['action'] !== 'signup') {\n+                   throw new UnauthorizedException();\n+       }\n+       //\u5168\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u8a31\u53ef\n+       $this->Auth->allow();\n+   }\n+\n }\n\n\n\n$components\u5909\u6570\n\u8a8d\u8a3c\u51e6\u7406\u306f\u3001CakePHP\u304c\u7528\u610f\u3057\u3066\u304f\u308c\u3066\u3044\u308bAuth\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u30d5\u30a9\u30fc\u30e0\u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30cf\u30c3\u30b7\u30e5\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u306fBlowfish\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\nbeforeFilter\u95a2\u6570\n\u5168\u3066\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u524d\u306b\u5b9f\u884c\u3055\u308c\u308b\u95a2\u6570\u304c\u3053\u306ebeforeFilter\u95a2\u6570\u3067\u3059\u3002\n\u3053\u3053\u3067\u3001\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304d\u305f\u30e6\u30fc\u30b6\u304c\u8a8d\u8a3c\u6e08\u307f\u304b\u3069\u3046\u304b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3044\u307e\u3059\u3002\n\u8a8d\u8a3c\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u30ed\u30b0\u30a4\u30f3(login)\u3001\u30e6\u30fc\u30b6\u767b\u9332(signup)\u3001\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u30c1\u30a7\u30c3\u30af(loggedin)\u4ee5\u5916\u306f\u5b9f\u884c\u51fa\u6765\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n$this->Auth->user()\u3067\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u53d6\u5f97\n\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u306a\u304b\u3063\u305f\u5834\u5408\u3001users\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u306e\u4e0b\u8a18\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u9664\u304d\u3001UnauthorizedException\u3092throw\u3057\u3066401\u30a8\u30e9\u30fc\u3092\u767a\u751f\u3055\u305b\u307e\u3059\u3002\n\n\nlogin\nloggedin\nsignup \n\n\n\n\nUsersController.php\n\u30ed\u30b0\u30a4\u30f3\u3001\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u30c1\u30a7\u30c3\u30af\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u3001\u30e6\u30fc\u30b6\u767b\u9332\u306e\u5b9f\u88c5\u3067\u3059\u3002\n\nUsersController.php\n<?php\n\nApp::uses('AppController', 'Controller');\nApp::uses('BlowfishPasswordHasher', 'Controller/Component/Auth');\n\nclass UsersController extends AppController {\n\n    public function login() {\n        $user = $this->Auth->user();\n        $res = array();\n        if ($user) {\n            if ($user['username'] === $this->request->data['username']) {\n                $res['User'] = $user;\n                $res['message'] = \"\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3059\";\n            } else {\n                $res['message'] = \"\u5225\u306e\u30e6\u30fc\u30b6\u304c\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3059\";\n            }\n        } else {\n            $this->request->data['User']['username'] = $this->request->data['username'];\n            $this->request->data['User']['password'] = $this->request->data['password'];\n            if ($this->Auth->login()) {\n                $user = $this->Auth->user();\n                $res['User'] = $user;\n                $res['message'] = \"\u30ed\u30b0\u30a4\u30f3\u6210\u529f\";\n            } else {\n                $res['message'] = \"\u30e6\u30fc\u30b6\u540d\u307e\u305f\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059\";\n            }\n        }\n        $this->set(compact('res'));\n        $this->set('_serialize', 'res');\n    }\n\n    public function loggedIn(){\n        $user = $this->Auth->user();\n        if ($user) {\n            $res['User'] = $user;\n            $res['message'] = \"\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3059\";\n            $this->set(compact('res'));\n            $this->set('_serialize', 'res');\n        }else{\n            throw new UnauthorizedException();\n        }\n    }\n\n    public function logout() {\n        $user = $this->Auth->user();\n        $res = array();\n        if ($user !== null) {\n            $this->Auth->logout();\n            $res['message'] = \"\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002\";\n        } else {\n            $res['message'] = \"\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u305b\u3093\u3002\";\n        }\n        $this->set(compact('res'));\n        $this->set('_serialize', 'res');\n    }\n\n    public function signUp() {\n        $data = $this->request->data;\n        if (isset($data['password'])) {\n            $passwordHasher = new BlowfishPasswordHasher();\n            $data['password'] = $passwordHasher->hash($data['password']);\n        }\n        $res = $this->User->save($data);\n        if($res){\n            unset($res['User']['password']);\n            $res['message'] = \"\u767b\u9332\u3057\u307e\u3057\u305f\u3002\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\uff01\";\n        }else{\n            $res['message'] = \"\u767b\u9332\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\";\n        }\n        $this->set(compact('res'));\n        $this->set('_serialize', 'res');\n    }\n\n}\n\n\n\nlogin\u95a2\u6570\n\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u7d50\u679c\u3068\u3057\u3066\u3001\u4e0b\u8a18\u306e4\u3064\u306e\u3044\u305a\u308c\u304b\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u30ed\u30b0\u30a4\u30f3\u6210\u529f\n\u30ed\u30b0\u30a4\u30f3\u5931\u6557\uff08\u30e6\u30fc\u30b6\u540dor\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3046\uff09\n\u81ea\u5206\u304c\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\n\u4ed6\u4eba\u304c\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\n\n\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u306f\u3001\n\n\n$this->request->data['User']['username']\u306b\u30e6\u30fc\u30b6\u540d\u3001\n\n$this->request->data['User']['password']\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3057\u3001\n\n$this->Auth->login()\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8fd4\u3059JSON\u306e\u9805\u76ee\u3068\u3057\u3066\u3001\u4e0b\u8a18\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\nUser -> \u30e6\u30fc\u30b6\u60c5\u5831(id, username, name)\n\nmessage -> \u51e6\u7406\u7d50\u679c\u3092\u8868\u3059\u30e1\u30c3\u30bb\u30fc\u30b8\n\n\n\u4f8b\uff08\u30ed\u30b0\u30a4\u30f3\u6210\u529f\u6642\uff09\n{\n    \"User\": {\n        \"id\": \"1\",\n        \"username\": \"test\",\n        \"name\": \"\u30c6\u30b9\u30c8\"\n    },\n    \"message\": \"\u30ed\u30b0\u30a4\u30f3\u6210\u529f\"\n}\n\n\n\nloggedIn\u95a2\u6570\n\u30e6\u30fc\u30b6\u304c\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u304b\u3069\u3046\u304b\u8abf\u3079\u307e\u3059\u3002\n\n\n$this->Auth->user()\u3067\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3001null\u3067\u306a\u3051\u308c\u3070\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3068\u5224\u65ad\u3057\u307e\u3059\u3002\n\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\u3001UnauthorizedException\u3092throw\u3057\u3066401\u30a8\u30e9\u30fc\u3092\u767a\u751f\u3055\u305b\u307e\u3059\u3002\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8fd4\u3059JSON\u306flogin\u95a2\u6570\u3068\u540c\u3058\u304f\u3001user\u3068message\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\nlogout\u95a2\u6570\n\u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\n$this->Auth->user()\u3067\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u304b\u5224\u65ad\u3057\u3001\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306a\u3089$this->Auth->logout()\u3067\u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\u306f\u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\u306f\u5b9f\u884c\u305b\u305a\u3001JSON\u306bmessage\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n\nsignUp\u95a2\u6570\nUser\u30e2\u30c7\u30eb\u3092\u4f7f\u7528\u3057\u3066\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u3001BlowfishPasswordHasher\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3057\u3066\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u305f\u6587\u5b57\u5217\u3092\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\u4fdd\u5b58\u304c\u6210\u529f\u3057\u305f\u5834\u5408JSON\u306b\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u304c\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u9664\u3044\u3066\u304a\u304d\u307e\u3059(unset($res['User']['password']);)\u3002\n\n\nUser.php\nusers\u30c6\u30fc\u30d6\u30eb\u306b\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3059\u308b\u305f\u3081\u306emodel\u3067\u3059\u3002\n\nUser.php\n<?php\n\nApp::uses('AppModel', 'Model');\n\nclass User extends AppModel {\n}\n\n\nCakePHP\u306emodel\u306e\u6a19\u6e96\u6a5f\u80fd\u4ee5\u5916\u4f55\u3082\u5b9f\u88c5\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n \u3061\u3083\u3093\u3068\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306a\u3089\u3001\u3053\u3053\u306b\u5165\u529b\u5024\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u7b49\u3092\u5b9f\u88c5\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u304c\u3001\u4eca\u56de\u306e\u30c6\u30fc\u30de\u3067\u306f\u7121\u3044\u306e\u3067\u5b9f\u88c5\u3057\u306a\u3044\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n\u3000\u52d5\u4f5c\u78ba\u8a8d\nPOSTMAN\u3067\u5404API\u3092\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\n\u5404API\u306e\u5b9f\u884c\u4f8b\u3092\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\u53c2\u8003\u306b\u3057\u3066\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\uff01\n \u30e6\u30fc\u30b6\u767b\u9332\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u3001siginin\u5b9f\u884c\u6642\u306b\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3066\u304b\u3089\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001phpMyAdmin\u3067\u30ec\u30b3\u30fc\u30c9\u8ffd\u52a0\u3057\u305f\u30c7\u30fc\u30bf\u3067\u306f\u30ed\u30b0\u30a4\u30f3\u306b\u5931\u6557\u3057\u307e\u3059\u306e\u3067\u3054\u6ce8\u610f\u4e0b\u3055\u3044\u3002\n\u4e0b\u8a18\u3001siginupAPI\u304b\u3089\u30c6\u30b9\u30c8\u3059\u308b\u3068\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u4f8b\n\n\n\n\nURL\n\u30ea\u30af\u30a8\u30b9\u30c8JSON\n\u30ec\u30b9\u30dd\u30f3\u30b9\u30b3\u30fc\u30c9\n\u30ec\u30b9\u30dd\u30f3\u30b9JSON\n\n\n\n\n/rest-study/users/signup.json\n200\n{\u3000\"username\": \"test2\",\u3000\"password\": \"test2\",\u3000\"name\": \"\u30c6\u30b9\u30c8\uff12\"}\n{\u3000\"User\": {\u3000\u3000\"username\": \"test2\",\u3000\u3000\"name\": \"\u30c6\u30b9\u30c8\uff12\",\u3000\u3000\"id\": \"65\"\u3000},\u3000\"message\": \"\u767b\u9332\u3057\u307e\u3057\u305f\u3002\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\uff01\"}\n\n\n/rest-study/users/login.json\n{\u3000\"username\":\"test\",\u3000\"password\":\"test\"}\n200\n{\u3000\"User\": {\u3000\u3000\"id\": \"1\",\u3000\u3000\"username\": \"test\",\u3000\u3000\"name\": \"\u30c6\u30b9\u30c8\"\u3000},\u3000\"message\": \"\u30ed\u30b0\u30a4\u30f3\u6210\u529f\"}\n\n\n/rest-study/users/login.json\n{\u3000\"username\":\"test\",\u3000\"password\":\"hoge\"}\n200\n{\"message\": \"\u30e6\u30fc\u30b6\u540d\u307e\u305f\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059\"}\n\n\n/rest-study/users/logout.json\n-\n200\n{\u3000\"message\": \"\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002\"}\n\n\n/rest-study/users/loggedin.json\n-\n200\n{\u3000\"User\": {\u3000\u3000\"id\": \"1\",\u3000\u3000\"username\": \"test\",\u3000\u3000\"name\": \"\u30c6\u30b9\u30c8\"\u3000},\u3000\"message\": \"\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3059\"}\n\n\n\n\n\u30a8\u30e9\u30fc\u6642\u306e\u4f8b1(\u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af - 401\u304c\u8fd4\u5374)\n\n\n\n\nURL\n\u30ea\u30af\u30a8\u30b9\u30c8JSON\n\u30ec\u30b9\u30dd\u30f3\u30b9\u30b3\u30fc\u30c9\n\u30ec\u30b9\u30dd\u30f3\u30b9JSON\n\n\n\n\n/rest-study/users/loggedin.json\n-\n401\n{\u3000\"name\": \"Unauthorized\",\u3000\"message\": \"Unauthorized\",\u3000\"url\": \"/rest-study/users/loggedIn.json\"}\n\n\n\n\n\u30a8\u30e9\u30fc\u6642\u306e\u4f8b2(\u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067TODO\u4e00\u89a7\u3092\u53d6\u5f97 - 401\u304c\u8fd4\u5374)\n\n\n\n\nURL\n\u30ea\u30af\u30a8\u30b9\u30c8JSON\n\u30ec\u30b9\u30dd\u30f3\u30b9\u30b3\u30fc\u30c9\n\u30ec\u30b9\u30dd\u30f3\u30b9JSON\n\n\n\n\n/rest-study/users/todo_lists.json\n-\n401\n{\u3000\"name\": \"Unauthorized\",\u3000\"message\": \"Unauthorized\",\u3000\"url\": \"/rest-study/users/todo_lists.json\"}\n\n\n\n\n\u5b9f\u88c5\n\u3067\u306f\u3001\u5b9f\u969b\u306b\u4fee\u6b63\u3057\u3066API\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\n app/Config/routes.php \u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n\n app/Controller/AppController.php \u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n\n app/Controller/UsersController.php \u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n\n app/Model/User.php \u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n\n \u52d5\u4f5c\u78ba\u8a8d!\n\n Git\u306b\u30b3\u30df\u30c3\u30c8\n\nGitHub\u3067\u306ediff\u8868\u793a\u3078\u306e\u30ea\u30f3\u30af\n\u7b2c5\u56de Lesson1 \u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9 \u00b7 suzukishouten-study/rest-study@59c29b0\nLesson2\u3078!\n\n Lesson2 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\nLesson2\u3067\u306f\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n\u30dd\u30a4\u30f3\u30c8\n\u3061\u3087\u3063\u3068\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\u304c\u3042\u308b\u306e\u3067\u30c1\u30a7\u30c3\u30af\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u306fAjax\u3067\u3042\u308a\u3001\u975e\u540c\u671f\u3067\u3059\u3002\u305d\u306e\u3053\u3068\u3092\u6291\u3048\u3066\u304a\u3051\u3070\u5927\u4e08\u592b\u3067\u3059\uff01\n\u30d6\u30e9\u30a6\u30b6\u3067TODO\u4e00\u89a7\u753b\u9762\u306eURL\u3092\u53e9\u3044\u305f\u5f8c\u306e\u52d5\u4f5c\u30b7\u30fc\u30b1\u30f3\u30b9\u306b\u3064\u3044\u3066\u6b21\u306b\u8aac\u660e\u3057\u307e\u3059\u3002\n\u8d77\u52d5\u6642\u306b\u3001\u307e\u305a\u30b5\u30fc\u30d0\u306b\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u53d6\u308a\u306b\u884c\u3063\u3066\u3001\u53d6\u308c\u305f\u3089\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3068\u5224\u65ad\u3057\u307e\u3059\u3002\n\uff08\u30d8\u30c3\u30c0\u306b\u8868\u793a\u3059\u308b\u30e6\u30fc\u30b6\u60c5\u5831\u306e\u53d6\u5f97\u3092\u517c\u306d\u3066\u3044\u307e\u3059\uff09\n\n\u6b63\u3057\u3044\u52d5\u4f5c\n\u3046\u307e\u304f\u52d5\u304f\u30b7\u30fc\u30b1\u30f3\u30b9\u306f\u4e0b\u56f3\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\u30ed\u30b0\u30a4\u30f3\u4e2d\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u51e6\u7406\u3092\u958b\u59cb\nXHR(XmlHttpRequest)\u3092\u4f7f\u7528\u3057\u3001\u30b5\u30fc\u30d0\u3068\u901a\u4fe1\u3057\u307e\u3059\u3002\u3053\u306e\u6642\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u53d7\u4fe1\u6642\u306b\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092XHR\u306b\u6559\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n\u30b5\u30fc\u30d0\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u4fe1\u5f8c\u3001XHR\u306f2\u3067\u6307\u5b9a\u3055\u308c\u305f\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3067\u306f\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u3092\u307f\u3066\u3001\u30e6\u30fc\u30b6\u60c5\u5831(\u30ed\u30b0\u30a4\u30f3\u6e08\u307f or \u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5224\u65ad\u306b\u5229\u7528)\u3092\u8a18\u61b6\u3057\u307e\u3059\u3002\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3057\u307e\u3059(Backbone.history.start()\u95a2\u6570)\u3002\n\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u5b9f\u884c\u3055\u308c\u3001TODO\u4e00\u89a7\u753b\u9762\u8868\u793a\u95a2\u6570\u304c\u5b9f\u884c\u3092\u958b\u59cb\n4\u3067\u8a18\u61b6\u3057\u305f\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u78ba\u8a8d\n\n\n\u30e6\u30fc\u30b6\u60c5\u5831\u304c\u53d6\u5f97\u6e08\u307f(\u30ed\u30b0\u30a4\u30f3\u6e08\u307f)\u306a\u3089\u3001TODO\u4e00\u89a7\u8868\u793a\u753b\u9762\u3092\u8868\u793a\n\u30e6\u30fc\u30b6\u60c5\u5831\u672a\u53d6\u5f97(\u672a\u30ed\u30b0\u30a4\u30f3)\u306a\u3089\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\n\n\n\n\n\u3046\u307e\u304f\u52d5\u304b\u306a\u3044\u30d1\u30bf\u30fc\u30f3\n\u524d\u56de\u307e\u3067\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u306f\u3001\u4e0a\u8a18\u306e5\u3067\u3084\u3063\u3066\u3044\u308b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u6709\u52b9\u5316(Backbone.history.start()\u95a2\u6570)\u3092\u8d77\u52d5\u6642\u306b\u3059\u3050\u3084\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u307e\u307e\u3060\u3068\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30b7\u30fc\u30b1\u30f3\u30b9\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3057\u307e\u3059(Backbone.history.start()\u95a2\u6570)\u3002\n\u30ed\u30b0\u30a4\u30f3\u4e2d\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u51e6\u7406\u3092\u958b\u59cb\nXHR(XmlHttpRequest)\u3092\u4f7f\u7528\u3057\u3001\u30b5\u30fc\u30d0\u3068\u901a\u4fe1\u3057\u307e\u3059\u3002\u3053\u306e\u6642\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u53d7\u4fe1\u6642\u306b\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092XHR\u306b\u6559\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n1\u3067\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306f\u65e2\u306b\u6709\u52b9\u306a\u306e\u3067\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u3092\u53d7\u3051\u308b\u524d\u306b\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u5b9f\u884c\u3055\u308c\u3001TODO\u4e00\u89a7\u753b\u9762\u8868\u793a\u95a2\u6570\u304c\u5b9f\u884c\u3092\u958b\u59cb\n\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u5f8c\u8a18\u9332\u3055\u308c\u308b\u4e88\u5b9a\u306e\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u78ba\u8a8d\u3002\n\n\n\u3057\u304b\u3057\u307e\u3060\u5fdc\u7b54\u304c\u306a\u3044\u306e\u3067\u3053\u3053\u3067\u306f\u30e6\u30fc\u30b6\u60c5\u5831\u304c\u672a\u53d6\u5f97\u3002\u3088\u3063\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n\n\u30b5\u30fc\u30d0\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u4fe1\u5f8c\u3001XHR\u306f2\u3067\u6307\u5b9a\u3055\u308c\u305f\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3067\u306f\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u3092\u307f\u3066\u3001\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u8a18\u61b6\u3057\u307e\u3059\u3002\u304c\u3001\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u305f\u5f8c\u3067\u3059\u3002\n\n\u4e0a\u8a18\u304b\u3089\u3001\u30ed\u30b0\u30a4\u30f3\u4e2d\u3067\u3042\u3063\u305f\u3068\u3057\u3066\u3082TODO\u4e00\u89a7\u753b\u9762\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002\n\u3053\u3046\u3044\u3063\u305f\u3001\u300c\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u304c\u8fd4\u308b\u524d\u306b\u4ed6\u306e\u51e6\u7406\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u300d\u3068\u3044\u3046\u52d5\u304d\u3092\u6291\u3048\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n\u7de8\u96c6\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\n\n\n\n\u7de8\u96c6\nfile\n\u7de8\u96c6\u6982\u8981\n\n\n\n\n\u4fee\u6b63\napp/View/Layouts/default.ctp\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u8ffd\u52a0\u3001\u4fee\u6b63\n\n\n\u4fee\u6b63\napp/webroot/js/main.js\napplication.start()\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u5909\u66f4\n\n\n\u4fee\u6b63\napp/webroot/js/app.js\n\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u7b49\n\n\n\u4fee\u6b63\napp/webroot/js/routers/router.js\n\u30eb\u30fc\u30c8\u8ffd\u52a0\n\n\n\u4fee\u6b63\napp/webroot/js/routers/controller.js\n\u30ed\u30b0\u30a4\u30f3\u95a2\u9023\u306e\u753b\u9762\u9077\u79fb\u5236\u5fa1\n\n\n\u65b0\u898f\napp/webroot/js/models/user-model.js\nAPI\u306e\u5b9f\u884c\n\n\n\u65b0\u898f\napp/webroot/js/views/login-layout-view.js\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u8868\u793a\u7528\u30d3\u30e5\u30fc\n\n\n\u65b0\u898f\napp/webroot/js/views/header-view.js\n\u30d8\u30c3\u30c0\u8868\u793a\u7528\u30d3\u30e5\u30fc\n\n\n\n\ndefault.ctp\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u8ffd\u52a0\u3002\n\ndefault.ctp\n <title>\u30b7\u30f3\u30d7\u30ebTODO\u30a2\u30d7\u30ea</title>\n </head>\n <body>\n+   <!-- \u30d8\u30c3\u30c0 -->\n+   <div id=\"header\"></div>\n    <!-- \u30b3\u30f3\u30c6\u30f3\u30c4 -->\n    <div id=\"main\"></div>\n+   \n+   <!-- \u30d8\u30c3\u30c0\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n+   <script type=\"text/template\" id=\"header-template\">\n+   <p>\u30e6\u30fc\u30b6\uff1a<%- username %>\uff08<%- name %>\uff09\u3000<input type=\"button\" id=\"logout\" value=\"\u30ed\u30b0\u30a2\u30a6\u30c8\"></input></p>\n+   <hr>\n+   </script>\n\n    <!-- TODO\u4e00\u89a7\u8868\u793a\u306e\u30ec\u30a4\u30a2\u30a6\u30c8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n  \u301c\u7565\u301c\n    </script>\n\n    <!-- \u8a73\u7d30\u753b\u9762\u306e\u30ec\u30a4\u30a2\u30a6\u30c8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n    <script type=\"text/template\" id=\"todo-detail-layout-template\">\n  \u301c\u7565\u301c\n    </script>\n\n    <!-- \u8a73\u7d30\u753b\u9762\u306e\u8868\u793a\u5185\u5bb9\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n    <script type=\"text/template\" id=\"todo-detail-item-template\">\n  \u301c\u7565\u301c\n    </script>\n\n+   <!-- \u30ed\u30b0\u30a4\u30f3\u753b\u9762\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n+   <script type=\"text/template\" id=\"login-layout-template\">\n+   <h2>\u30ed\u30b0\u30a4\u30f3</h2>\n+   <div>\n+   <p>\u30e6\u30fc\u30b6\u540d\u3000\uff1a<input type=\"text\" id=\"username\" placeholder=\"username\" autofocus></input></p>\n+   <p>\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a<input type=\"password\" id=\"password\" placeholder=\"password\"></input></p>\n+   <input type=\"button\" id=\"login\" value=\"\u30ed\u30b0\u30a4\u30f3\"></input>\n+   </div>\n+   <hr>\n+   <h2>\u30e6\u30fc\u30b6\u767b\u9332</h2>\n+   <div>\n+   <p>\u30e6\u30fc\u30b6\u540d\u3000\uff1a<input type=\"text\" id=\"signup-username\" placeholder=\"username\"></input></p>\n+   <p>\u6c0f\u540d\u3000\u3000\u3000\uff1a<input type=\"text\" id=\"signup-name\" placeholder=\"name\"></input></p>\n+   <p>\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a<input type=\"password\" id=\"signup-password\" placeholder=\"password\"></input></p>\n+   <input type=\"button\" id=\"signup\" value=\"\u767b\u9332\"></input>\n+   </div>\n+   </script>\n+\n    <!-- require -->\n    <script type=\"text/javascript\" src=\"js/require-config.js\"></script>\n    <script type=\"text/javascript\" src=\"js/lib/require.js\" data-main=\"main.js\"></script>\n\n </body>\n </html>\n\n\n\u4e0b\u8a18\u3092\u8ffd\u52a0\u3002\n\n\u30d8\u30c3\u30c0\u60c5\u5831\u3092\u8868\u793a\u3059\u308bRegion\u3092\u3059\u308bdiv\u30bf\u30b0\n\u30d8\u30c3\u30c0\u60c5\u5831\u8868\u793a\u30d3\u30e5\u30fc\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\n\n\u30e6\u30fc\u30b6\u540d\u3001\u6c0f\u540d\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u3092\u914d\u7f6e\n\n\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\n\n\u30ed\u30b0\u30a4\u30f3\u7528\u8981\u7d20\u3092\u914d\u7f6e\n\n\n\u30e6\u30fc\u30b6\u540d\n\u30d1\u30b9\u30ef\u30fc\u30c9\n\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\n\n\n\u30e6\u30fc\u30b6\u767b\u9332\u7528\u8981\u7d20\u3092\u914d\u7f6e\n\n\n\u30e6\u30fc\u30b6\u540d\n\u6c0f\u540d\n\u30d1\u30b9\u30ef\u30fc\u30c9\n\u767b\u9332\u30dc\u30bf\u30f3\n\n\n\n\n\n\nmain.js\n\nmain.js\n    require(['app'], function(Application){\n        console.log('run main2');\n        window.application = new Application();\n-       window.application.start();\n-       console.log('app start');\n    });\n });\n\n\napplication.start()\u3092\u524a\u9664\u3002\n\u3053\u308c\u306f\u3001\u5148\u7a0b\u8ff0\u3079\u305f\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\u306e\u5bfe\u5fdc\u3067\u3059\u3002\n\u5f8c\u8ff0\u3059\u308bapplication(app.js)\u5185\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\uff08\u30ed\u30b0\u30a4\u30f3\u4e2d\u304b\u3069\u3046\u304b\u78ba\u8a8d\uff09\u306e\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u3066\u304b\u3089application.start()\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u3067\u3059\u3002application.start()\u3092\u524a\u9664\u3057\u305f\u5834\u5408(\u671f\u5f85\u3059\u308b\u52d5\u4f5c)\u3068\u3001\u524a\u9664\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u306e\u52d5\u4f5c\u306e\u9055\u3044\u3092\u3001\u4eca\u5ea6\u306f\u30b3\u30fc\u30c9\u3092\u30d9\u30fc\u30b9\u306b\u8aac\u660e\u3057\u307e\u3059\u3002\n\napplication.start()\u3092\u524a\u9664\u3057\u305f\u5834\u5408(\u671f\u5f85\u3059\u308b\u52d5\u4f5c)\n\n\n/rest-study/\u306b\u30a2\u30af\u30bb\u30b9\nmain.js\u5b9f\u884c\u3002 applicaion\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u751f\u6210\u3059\u308b\u306e\u307f\n\napp.js\u306einitialize\u95a2\u6570\u5185\u3067\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u884c(loggedinAPI\u306eAjax\u901a\u4fe1\u958b\u59cb)\n\nloggedinAPI\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u53d6\u308a\u3001\n\n\n\u30ed\u30b0\u30a4\u30f3\u4e2d\u306a\u3089\u30e6\u30fc\u30b6\u60c5\u5831\u4fdd\u6301\n\u672a\u30ed\u30b0\u30a4\u30f3\u306a\u3089\u30e6\u30fc\u30b6\u60c5\u5831\u30af\u30ea\u30a2\napplication.start()\u3092\u5b9f\u884c\n\n\n\nonStart()\u304c\u5b9f\u884c\u3055\u308c\u3001Backbone.history.start()\u304c\u5b9f\u884c\u3001\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u958b\u59cb\u3055\u308c\u308b\u3002\ncontroller\u304c\u5b9f\u884c\u3055\u308c\u3001\n\n\n\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u4fdd\u6301\u3057\u3066\u3044\u308b\u5834\u5408\u3001TODO\u4e00\u89a7\u753b\u9762\u306b\u9077\u79fb\n\u30e6\u30fc\u30b6\u60c5\u5831\u304c\u30af\u30ea\u30a2\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001Backbone.history.navigate()\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762(/#login)\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\n\n\n\n\n\n\n\napplication.start()\u3092\u524a\u9664\u3057\u306a\u304b\u3063\u305f\u5834\u5408\n\n\n/rest-study/\u306b\u30a2\u30af\u30bb\u30b9\nmain.js\u5b9f\u884c\u3002 applicaion.start()\u3092\u5b9f\u884c\n\napp.js\u306einitialize\u95a2\u6570\u5185\u3067\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u884c(loggedinAPI\u306eAjax\u901a\u4fe1\u958b\u59cb)\n\nloggedinAPI\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u53d6\u308b\u524d\u306b\u3001app.js\u306eonStart()\u304c\u5b9f\u884c\u3055\u308c\u3001Backbone.history.start()\u304c\u5b9f\u884c\u3001\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u958b\u59cb\u3055\u308c\u308b\u3002\n\n\ncontroller\u304c\u5b9f\u884c\u3055\u308c\u3001\n\n\n\nloggedinAPI\u306eAjax\u901a\u4fe1\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u307e\u3060\u53d7\u3051\u53d6\u3063\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30e6\u30fc\u30b6\u60c5\u5831\u304c\u30af\u30ea\u30a2\u3055\u308c\u3066\u3044\u308b\u72b6\u614b\uff08\u521d\u671f\u5024\uff09\u306a\u306e\u3067\u3001Backbone.history.navigate()\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762(/#login)\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0(\u5b9f\u969b\u306b\u30ed\u30b0\u30a4\u30f3\u3055\u308c\u3066\u3044\u308b\u304b\u5426\u304b\u306b\u304b\u304b\u308f\u3089\u305a)\u3002\n\n\n\n\n\nloggedinAPI\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u53d6\u308a\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\n\n\n\u30ed\u30b0\u30a4\u30f3\u4e2d\u306a\u3089\u30e6\u30fc\u30b6\u60c5\u5831\u4fdd\u6301\n\u672a\u30ed\u30b0\u30a4\u30f3\u306a\u3089\u30e6\u30fc\u30b6\u60c5\u5831\u30af\u30ea\u30a2\n\u304c\u3001\u65e2\u306bcontroller\u306e\u51e6\u7406\u306f\u7d42\u308f\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b...\n\n\n\n\napp.js\n\u30ed\u30b0\u30a4\u30f3\u95a2\u9023\u306e\u5404\u51e6\u7406\u3092\u8ffd\u52a0\u3002\n\napp.js\n define(function(require){\n    console.log('run app');\n    var Router = require('routers/router');\n+   var UserModel = require('models/user-model');\n    var Application = Marionette.Application.extend({\n        initialize : function(){\n            console.log('app.initialize');\n+           // Ajax\u306e\u30a8\u30e9\u30fc\u306e\u5171\u901a\u30cf\u30f3\u30c9\u30e9\u3092\u8a2d\u5b9a\n+           $(document).ajaxError(function ( e, xhr, options , message ) {\n+               window.application.ajaxErrorHandler( e, xhr, options , message );\n+           });\n            new Router();\n+           //\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\n+           this.loginUser = new UserModel();\n+           this.getLoginUser();\n        },\n\n        onStart : function(){\n            Backbone.history.start();\n        },\n\n        regions : {\n+           headerRegion : '#header',\n            mainRegion : '#main'\n-       }\n+       },\n+       \n+       //\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u683c\u7d0d\u7528\n+       loginUser : null,\n+\n+       //\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u53d6\u5f97\n+       getLoginUser : function(){\n+           this.loginUser.getLoginUser(\n+               this.onLoggedIn,\n+               this.onNotLoggedIn\n+           );\n+       },\n+       \n+       //\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u53d6\u5f97:\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306e\u5834\u5408\n+       onLoggedIn : function(){\n+           window.application.start(); // applicaiton.start()\u306f\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u5f8c\n+       },\n+       \n+       //\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u53d6\u5f97:\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\n+       onNotLoggedIn : function(){\n+           window.application.clearLoginUser();    //\u30ed\u30b0\u30a4\u30f3\u60c5\u5831\u3092\u30af\u30ea\u30a2\u3057\u3066\u304a\u304f\n+           window.application.start(); // applicaiton.start()\u306f\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u5f8c\n+       },\n+       \n+       //\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u304b\u5224\u5b9a\n+       isLoggedIn : function(){\n+           return this.loginUser.isLoggedIn();\n+       },\n+       \n+       //\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u306e\u30af\u30ea\u30a2(\u30ed\u30b0\u30a2\u30a6\u30c8\u6642)\n+       clearLoginUser : function(){\n+           this.loginUser.clear();\n+       },\n+\n+       // ajax\u306e\u30a8\u30e9\u30fc\u3092\u5168\u3066\u3053\u3053\u3067\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n+       ajaxErrorHandler : function(e, xhr, options , message){\n+           if( xhr.status === 401 ){\n+               this.clearLoginUser();\n+               // \u672a\u8a8d\u8a3c\u306e\u5834\u5408\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u98db\u3070\u3059\n+               Backbone.history.navigate('#login', {trigger : true, replace : true});\n+           }else if(xhr.status >= 400 && xhr.status < 500){\n+               //ClientError\u306e\u5834\u5408\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\n+               alert(message);\n+           }else if(xhr.status >= 500 && xhr.status < 600){\n+               //ServerError\u306e\u5834\u5408\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\n+               alert(message);\n+           }\n+       },\n\n    });\n    return Application;\n\n\n\u4e3b\u306a\u4fee\u6b63\u70b9\u3002\n\n\u8ffd\u52a0require\n\n\u30ed\u30b0\u30a4\u30f3\u95a2\u9023\u306eAPI\u3092\u5b9f\u884c\u3059\u308b\u70ba\u3001models/user-model.js\u3092require\u3002\n\n\ninitialize\u95a2\u6570\n\nAjax\u306e\u30a8\u30e9\u30fc\u306e\u5171\u901a\u30cf\u30f3\u30c9\u30e9(ajaxErrorHandler\u95a2\u6570)\u3092\u8a2d\u5b9a\nrequire\u3057\u305fuser-model\u3092\u751f\u6210\u3057\u3001\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af(loggedinAPI)\u3092\u5b9f\u884c\u3002\n\n\nAPI\u306fgetLoginUser\u95a2\u6570\u5185\u3067\u5b9f\u884c\n\n\n\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306e\u5834\u5408\u3001onLoggedIn\u95a2\u6570\u304c\u5b9f\u884c\u3055\u308c\u308b\u3002\n\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\u3001onNotLoggedIn\u95a2\u6570\u304c\u5b9f\u884c\u3055\u308c\u308b\u3002\n####  ajaxErrorHandler\n\n\n\n\n\n\u5168\u3066\u306eAjax\u901a\u4fe1\u306e\u30a8\u30e9\u30fc\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u3002\n\nhttp status\u304c401(Unauthorized)(\u672a\u30ed\u30b0\u30a4\u30f3)\u306e\u5834\u5408\u3001Backbone.history.navigate()\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762(/#login)\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\u305d\u308c\u4ee5\u5916\u306ehttp status\u306e\u5834\u5408\u306falert\u8868\u793a\u3002\n\n\nrouter.js\n\nrouter.js\n\u301c\u7565\u301c\n        //\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u8a2d\u5b9a\n        appRoutes : {\n+           'login'             : 'login',\n            ''                  : 'todoLists',\n            'todo-lists'        : 'todoLists',\n            'todo-lists/:id'    : 'todoDetail'\n        },\n\u301c\u7565\u301c\n\n\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3078\u306e\u30eb\u30fc\u30c8\u3092\u8ffd\u52a0\u3002\n\ncontroller.js\n\ncontroller.js\n //controller\n console.log('load controller');\n define(function() {\n    console.log('run controller');\n    var TodoController = Marionette.Controller.extend({\n+       login : function(){\n+           //\u30ed\u30b0\u30a4\u30f3\u753b\u9762\n+           this.nextView('views/login-layout-view', null, true);\n+       },\n\n        todoLists : function() {\n            //Todo\u30ec\u30a4\u30a2\u30a6\u30c8\u7528\u30d3\u30e5\u30fc\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n            this.nextView('views/todo-layout-view');\n        },\n\n        todoDetail : function(id) {\n            this.nextView('views/todo-detail-layout-view', {modelId : id});\n        },\n\n-       nextView : function(viewPath, option) {\n+       nextView : function(viewPath, option, tryShowLoginScreen) {\n+           if(window.application.isLoggedIn()){\n+               //\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\n+               if(tryShowLoginScreen){\n+                   //\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306a\u306e\u306b\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u5834\u5408\u306f\n+                   //TODO\u30ea\u30b9\u30c8\u753b\u9762\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n+                   Backbone.history.navigate('#todo-lists', {trigger: true, replace: true});\n+                   return;\n+               }\n+           }else{\n+               //\u672a\u30ed\u30b0\u30a4\u30f3\n+               if(!tryShowLoginScreen){\n+                   //\u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u5834\u5408\u306f\n+                   //\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n+                   Backbone.history.navigate('#login', {trigger: true, replace: true});\n+                   return;\n+               }\n+           }\n+           //\u30d8\u30c3\u30c0\u8868\u793a\n+           this.showHeaderRegion(tryShowLoginScreen);\n+           //\u30b3\u30f3\u30c6\u30f3\u30c4\u8868\u793a\n            require([viewPath], function(View){\n                window.application.mainRegion.show(new View(option));\n            });\n        },\n-\n+       \n+       showHeaderRegion : function(tryShowLoginScreen){\n+           if(tryShowLoginScreen){\n+               //\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u9077\u79fb\u6642\u306f\u30d8\u30c3\u30c0\u975e\u8868\u793a\n+               window.application.headerRegion.empty();\n+           }else if(!window.application.headerRegion.hasView()){\n+               //\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916\u9077\u79fb\u6642\u3001\u304b\u3064\u30d8\u30c3\u30c0\u672a\u8868\u793a\u306e\u5834\u5408\u30d8\u30c3\u30c0\u8868\u793a\n+               require(['views/header-view'], function(View){\n+                   window.application.headerRegion.show(new View({\n+                       model : window.application.loginUser\n+                   }));\n+               });\n+           }\n+       }\n+       \n    });\n    return TodoController;\n });\n\n\n\nlogin\u95a2\u6570\u8ffd\u52a0\n\nnextView\u95a2\u6570\u306b\u8ffd\u52a0\u3057\u305ftryShowLoginScreen\u30d1\u30e9\u30e1\u30fc\u30bf(\u5f8c\u8ff0)\u3092true\u3067\u5b9f\u884c\n\n\nnextView\u95a2\u6570\n\n\nnextView\u95a2\u6570\u3067\u3001\u30ed\u30b0\u30a4\u30f3\u6642\u3068\u307f\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u5224\u65ad\u30ed\u30b8\u30c3\u30af\u8ffd\u52a0\n\n\n\u30ed\u30b8\u30c3\u30af\u306f\u30bd\u30fc\u30b9\u4e2d\u306e\u30b3\u30e1\u30f3\u30c8\u901a\u308a\u3002\u4e0b\u8a18\u306e2\u30d1\u30bf\u30fc\u30f3\u306e\u52d5\u4f5c\u3092\u5236\u5fa1\u3057\u3066\u3044\u308b(\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306ftryShowLoginScreen\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u5224\u5b9a)\u3002\n\n\n\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u308b\u306e\u306b\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\u306fTODO\u4e00\u89a7\u753b\u9762\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067TODO\u4e00\u89a7\u3084TODO\u8a73\u7d30\u753b\u9762(\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916)\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\u306f\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\n\n\n\n\u30b3\u30f3\u30c6\u30f3\u30c4(TODO\u4e00\u89a7\u3084\u8a73\u7d30\u753b\u9762)\u306eview\u3092\u8868\u793a\u3059\u308b\u524d\u306b\u3001\u30d8\u30c3\u30c0\u3092\u8868\u793a\u3002\n\n\nshowHeaderRegion\u95a2\u6570\n\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u8868\u793a\u6642\u306f\u30d8\u30c3\u30c0\u7528view\u3092\u975e\u8868\u793a\u306b\u3059\u308b\u3002\n\u30b3\u30f3\u30c6\u30f3\u30c4\u753b\u9762\u8868\u793a\u6642\u306f\u3001\u30d8\u30c3\u30c0\u7528view\u3092\u8868\u793a\u3059\u308b\u3002\n\n\nuser-model.js\n\n\u8ffd\u52a0\u3057\u305fAPI\u3092\u547c\u3073\u51fa\u3059\u3002\n\nuser-model.js\n//\u30ed\u30b0\u30a4\u30f3\u7528\u30e2\u30c7\u30eb\ndefine(function() {\n    var LoginModel = Backbone.Model.extend({\n\n        parse : function(response) {\n            if(response.message){\n                this.loginMessage = response.message;\n            }\n            return response.User;\n        },\n\n        loginMessage : null,\n\n        //\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u304b\u3069\u3046\u304b\u5224\u5b9a\n        isLoggedIn : function(){\n            return this.get('id') ? true : false;\n        },\n\n        //\u30ed\u30b0\u30a4\u30f3\u4e2d\u306e\u30e6\u30fc\u30b6\u60c5\u5831\u53d6\u5f97\n        getLoginUser : function(onLoggedIn, onNotLoggedIn){\n            this.urlRoot = '/rest-study/users/loggedin';\n            this.fetch(\n                {\n                    wait : true,\n                    success : function(){\n                        onLoggedIn();\n                    },\n                    error : function(){\n                        onNotLoggedIn();\n                    },\n                }\n            );\n        },\n\n        //\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n        login : function(username, password, onLoginSuccess, onLoginError){\n            this.urlRoot = '/rest-study/users/login';\n            this.save(\n                {\n                    username : username, \n                    password : password\n                }, {\n                    success : function(model){\n                        if(model.get('id')){\n                            onLoginSuccess(model.loginMessage);\n                        }else{\n                            onLoginError(model.loginMessage);\n                        }\n                    },\n                }\n            );\n        },\n\n        //\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\n        logout : function(onLogoutSuccess){\n            this.urlRoot = '/rest-study/users/logout';\n            this.save(\n                {}, \n                {\n                    success : function(model){\n                        onLogoutSuccess(model.loginMessage);\n                    },\n                }\n            );\n        },\n\n        //\u767b\u9332\uff08\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7\uff09\u3059\u308b\n        signup : function(username, password, name, onSignUpSuccess, onSignUpError){\n            this.urlRoot = '/rest-study/users/signup';\n            this.save(\n                {\n                    username : username, \n                    password : password,\n                    name     : name\n                }, {\n                    success : function(model){\n                        if(model.get('id')){\n                            onSignUpSuccess(model.loginMessage);\n                        }else{\n                            onSignUpError(model.loginMessage);\n                        }\n                    },\n                }\n            );\n        },\n    });\n    return LoginModel;\n});\n\n\n\nparse\u95a2\u6570\n\u30b5\u30fc\u30d0\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u4e0b\u8a18\u306e\u901a\u308a\u51e6\u7406\u3057\u3066\u3044\u307e\u3059\u3002\n\n\nmessage\u3092loginMessage\u5909\u6570\u306b\u4fdd\u6301\u3002\n\nUser(\u30e6\u30fc\u30b6\u60c5\u5831)\u3092\u53d6\u308a\u51fa\u3057\u3066return\u3002\n\n\n\u5404API\u306e\u5b9f\u884c\u65b9\u6cd5\n\nGET\u30e1\u30bd\u30c3\u30c9\u3067\u5b9f\u884c\u3059\u308b\u3082\u306e(loggedinAPI)\u306ffetch\u95a2\u6570\u3092\u5b9f\u884c\u3002\nPOST\u30e1\u30bd\u30c3\u30c9\u3067\u5b9f\u884c\u3059\u308b\u3082\u306e(login\u3001logout\u3001signup\u306e\u5404API\u306fsave\u95a2\u6570\u3092\u5b9f\u884c\u3002\n\u5404API\u306eURL\u306f\u3001\u5404\u95a2\u6570\u5b9f\u884c\u6642\u306burlRoot\u5909\u6570\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u3067\u6307\u5b9a\u3002\nAPI\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u53d7\u53d6\u308a\u5f8c\u306f\u3001view\u5074\u306e\u95a2\u6570\u3092\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3059\u308b\u3053\u3068\u3067view\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3002\n\u30a8\u30e9\u30fc\u6642\u306f\u3001app.js\u3067\u8a2d\u5b9a\u3057\u305fajaxErrorHandler\u95a2\u6570\u304c\u5b9f\u884c\u3055\u308c\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306f\u4f55\u3082\u3057\u306a\u3044\u3002\n\n\nlogin-layout-view.js\nMarionette.LayoutView\u3092\u7d99\u627f\u3057\u3066\u5b9f\u88c5\u3002\n\nlogin-layout-view.js\n//\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u7528\u30ec\u30a4\u30a2\u30a6\u30c8\u30d3\u30e5\u30fc\ndefine(function(require) {\n    var LoginModel = require('models/user-model');\n\n    var LoginLayoutView = Marionette.LayoutView.extend({\n        //\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n        template : '#login-layout-template',\n\n        //UI\u30d1\u30fc\u30c4\n        ui : {\n            username       : '#username',           // \u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30e6\u30fc\u30b6\u540d\n            password       : '#password',           // \u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n            loginButton    : '#login',              // \u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\n            signupUsername : '#signup-username',    // \u767b\u9332\u6642\u306e\u30e6\u30fc\u30b6\u540d\n            signupPassword : '#signup-password',    // \u767b\u9332\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n            name           : '#signup-name',        // \u767b\u9332\u6642\u306e\u6c0f\u540d\n            signupButton   : '#signup'              // \u767b\u9332\u30dc\u30bf\u30f3\n        },\n\n        //\u30a4\u30d9\u30f3\u30c8\n        events : {\n            //\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n            'click @ui.loginButton' : 'onLoginClick',\n            //\u767b\u9332\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n            'click @ui.signupButton' : 'onsignupClick',\n        },\n\n        //\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n        onLoginClick : function(){\n            //\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u304b\u3089\u6587\u5b57\u3092\u53d6\u5f97\n            var username = this.ui.username.val();    //\u30e6\u30fc\u30b6\u540d\n            var password = this.ui.password.val();    //\u30d1\u30b9\u30ef\u30fc\u30c9\n            window.application.loginUser.login(\n                username,\n                password,\n                this.onLoginSuccess,\n                this.onLoginError);\n        },\n\n        //\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u6210\u529f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n        onLoginSuccess : function(message){\n            Backbone.history.navigate('todo-lists', {trigger: true, replace: true});\n            console.log(message);\n        },\n\n        //\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u5931\u6557\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n        onLoginError : function(message){\n            alert(message);\n        },\n\n        //\u767b\u9332\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n        onsignupClick : function(){\n            //\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u304b\u3089\u6587\u5b57\u3092\u53d6\u5f97\n            var username = this.ui.signupUsername.val();    //\u30e6\u30fc\u30b6\u540d\n            var password = this.ui.signupPassword.val();    //\u30d1\u30b9\u30ef\u30fc\u30c9\n            var name = this.ui.name.val();                  //\u6c0f\u540d\n            var userModel = new LoginModel();\n            userModel.signup(\n                    username,\n                    password,\n                    name,\n                    this.onsignupSuccess,\n                    this.onsignupError);\n        },\n\n        //\u767b\u9332\u6210\u529f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n        onsignupSuccess : function(message){\n            alert(message);\n        },\n\n        //\u767b\u9332\u5931\u6557\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n        onsignupError : function(message){\n            alert(message);\n        },\n\n    });\n    return LoginLayoutView;\n});\n\n\n\u30aa\u30fc\u30bd\u30c9\u30c3\u30af\u30b9\u306a\u30d3\u30e5\u30fc\u306e\u5b9f\u88c5\u3067\u3059\u3002\n\n\nui\u5909\u6570\u3067\u5404\u5165\u529b\u9805\u76ee\u3084\u30dc\u30bf\u30f3\u306ehtml\u30a8\u30ec\u30e1\u30f3\u30c8\u3092\u8a2d\u5b9a\n\nevent\u5909\u6570\u3067\u30dc\u30bf\u30f3\u306eClick\u30a4\u30d9\u30f3\u30c8\u3068\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u3092\u7d10\u4ed8\u3051\n\u5404Click\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u3067\u306fuser-model\u3092\u4f7f\u7528\u3057\u3066API\u3092\u5b9f\u884c\n\n\n\u30ed\u30b0\u30a4\u30f3\u6642\u306f\u3001app.js\u5185\u306b\u4fdd\u6301\u3057\u3066\u3044\u308buser-model\u3092\u4f7f\u7528(\u8fd4\u3063\u3066\u304d\u305f\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u305d\u306e\u307e\u307eapp.js\u5185\u306b\u4fdd\u6301\u3059\u308b\u305f\u3081)\u3002\n\u30e6\u30fc\u30b6\u767b\u9332\u6642\u306f\u3001user-model\u3092\u65b0\u3057\u304f\u751f\u6210\u3057\u3066\u4f7f\u7528(\u8fd4\u3063\u3066\u304d\u305f\u30e6\u30fc\u30b6\u60c5\u5831\u306f\u4f7f\u7528\u3057\u306a\u3044\u305f\u3081)\n\n\nAPI\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u6642\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u5b9f\u884c\u3001\u753b\u9762\u9077\u79fb\u3084\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\u3092\u884c\u3046\n\n\n\u30ed\u30b0\u30a4\u30f3\u6210\u529f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u5185\u3067\u3001TODO\u4e00\u89a7\u753b\u9762\u306b\u9077\u79fb\u3055\u305b\u3066\u3044\u308b\n\n\n\n\nheader-view.js\nMarionette.ItemView\u3092\u7d99\u627f\u3057\u3066\u5b9f\u88c5\u3002\n\nheader-view.js\n//\u30d8\u30c3\u30c0\u7528\u30d3\u30e5\u30fc\ndefine(function(require){\n    var UserModel = require('models/user-model');\n\n    var HeaderView = Marionette.ItemView.extend({\n\n        //\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n        template : '#header-template',\n\n        ui : {\n            logoutButton : '#logout',\n        },\n\n        //DOM\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u8a2d\u5b9a\n        events : {\n            //\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n            'click @ui.logoutButton' : 'onLogoutClick',\n        },\n\n        onLogoutClick : function(){\n            var userModel = new UserModel();\n            userModel.logout(this.onLogoutSuccess);\n        },\n\n        onLogoutSuccess : function(message){\n            window.application.clearLoginUser();\n            Backbone.history.navigate('#login', {trigger : true, replace : true});\n            console.log(message);\n        },\n\n    });\n    return HeaderView;\n});\n\n\n\u3053\u308c\u3082\u30aa\u30fc\u30bd\u30c9\u30c3\u30af\u30b9\u306a\u30d3\u30e5\u30fc\u306e\u5b9f\u88c5\u3067\u3059\u3002\n\n\nui\u5909\u6570\u3067\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u3092\u8a2d\u5b9a\n\nevent\u5909\u6570\u3067onLogoutClick\u95a2\u6570\u3092\u7d10\u4ed8\u3051\n\nonLogoutClick\u95a2\u6570\u3067\u306fuser-model\u3092\u4f7f\u7528\u3057\u3066API\u3092\u5b9f\u884c\nAPI\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u6642\u306bonLogoutSuccess\u95a2\u6570\u5b9f\u884c\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\n\n\n\u5b9f\u88c5\n\u3067\u306f\u3001\u5b9f\u969b\u306b\u4fee\u6b63\u3057\u3066\u753b\u9762\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\n app/View/Layouts/default.ctp\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n\n app/webroot/js/main.js\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n\n app/webroot/js/app.js\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n\n app/webroot/js/routers/router.js\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n\n app/webroot/js/routers/controller.js\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n\n app/webroot/js/models/user-model.js\u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n\n app/webroot/js/views/login-layout-view.js\u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n\n app/webroot/js/views/header-view.js\u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n\n \u52d5\u4f5c\u78ba\u8a8d!\n\n Git\u306b\u30b3\u30df\u30c3\u30c8\n\nGitHub\u3067\u306ediff\u8868\u793a\u3078\u306e\u30ea\u30f3\u30af\n\u7b2c5\u56de Lesson2 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9 \u00b7 suzukishouten-study/rest-study@d4ae8a4\n\u4ee5\u4e0a\u3067\u3059\uff01\n\n\u6b21\u56de\u4e88\u544a\n\u6b21\u56de\u30c6\u30fc\u30de\u306f\u3001CakePHP\u3067\u30c7\u30fc\u30bf\u64cd\u4f5c\u301c\u62c5\u5f53\u8005\u30a2\u30b5\u30a4\u30f3\u6a5f\u80fd\u306e\u5b9f\u88c5\u3067\u3059\u3002\n\u4eca\u56de\u3067\u30e6\u30fc\u30b6\u304c\u8b58\u5225\u3067\u304d\u308b\u3088\u3046\u306b\u6210\u3063\u305f\u306e\u3067\u3001\u5404\u30e6\u30fc\u30b6\u306bTODO\u3092\u30a2\u30b5\u30a4\u30f3\u3059\u308b\u6a5f\u80fd\u306a\u3069\u3092\u3064\u3051\u3066\u3044\u304d\u307e\u3059\u3002\n\u307e\u305f\u305c\u3072\u3054\u53c2\u52a0\u304f\u3060\u3055\u3044\uff01\n\n\u30b3\u30e1\u30f3\u30c8/\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af\u304a\u5f85\u3061\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\u53c2\u52a0\u8005\u306e\u65b9\u3082\u3001\u305d\u3046\u3067\u306a\u3044\u65b9\u3082\u304a\u6c17\u3065\u304d\u306e\u70b9\u304c\u3042\u308c\u3070\u304a\u9858\u3044\u81f4\u3057\u307e\u3059\u3002\n\n\n## :large_blue_circle: \u306f\u3058\u3081\u306b\n\n\u672c\u6295\u7a3f\u306f\u30012015/5/22\u306b\u884c\u308f\u308c\u305f\u3001[CakePHP\u3067\u5b9f\u88c5\u3059\u308b\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd - connpass](http://aws-rest-todo.connpass.com/event/12733/)\u306e\u5185\u5bb9\u306b\u3064\u3044\u3066\u307e\u3068\u3081\u305f\u8cc7\u6599\u3067\u3059\u3002\n\n:warning:\u4eca\u5f8c\u306e\u4e88\u5b9a\n[AWS\u4e0a\u3067\u69cb\u7bc9\u3059\u308bRESTful\u30a2\u30d7\u30ea\u52c9\u5f37\u4f1a\uff5eWeb\u958b\u767a\u30ef\u30fc\u30af\u30b7\u30e7\u30c3\u30d7\uff5e - connpass](http://aws-rest-todo.connpass.com/)\n\n\u4eca\u56de\u306f\u3001\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u7b2c2\u56de\u3067Backbone.js\u3092\u4f7f\u7528\u3057\u3066\u753b\u9762\u3092\u4f5c\u308a\u307e\u3057\u305f\u304c\u3001\u305d\u308c\u4ee5\u6765\u306e\u6a5f\u80fd\u8ffd\u52a0\u3067\u3059\uff01\n\n\n---\n\n\n\n:warning: 2015/5/25\u8ffd\u8a18 - 1\n\nphpMyAdmin\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u306a\u3044\u3001\u3068\u3044\u3046\u65b9\u304c\u4f55\u540d\u304b\u3044\u3089\u3063\u3057\u3083\u3044\u307e\u3057\u305f\u3002\n\n```text:/etc/httpd/conf/httpd.conf(66\u884c\u76ee\u304b\u3089)\nUser study\nGroup apache\n```\n\n\u3067\u3042\u308b\u3079\u304d\u306a\u3093\u3067\u3059\u304c\u3001\u306a\u305c\u304b\u3001\n\n```text:/etc/httpd/conf/httpd.conf\nUser study\nGroup wheel\n```\n\n\u3068\u3001Group\u304cwheel\u306b\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\nroot\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3001\u305d\u3053\u3092\u76f4\u3057\u3066apache\u518d\u8d77\u52d5(`service httpd restart`)\u3059\u308c\u3070OK\u3067\u3057\u305f\u3002\n\u203b\u7b2c1\u56de\u306eQiita\u8a18\u4e8b\u4f5c\u6210\u3068\u524d\u5f8c\u3057\u3066\u3001\u958b\u767a\u74b0\u5883\u306e\u5143\u3068\u3059\u308bAMI\u3092\u76f4\u524d\u306b\u4fee\u6b63\u3057\u305f\u308a\u3057\u3066\u3044\u305f\u306e\u3067\u3001\u305d\u306e\u3078\u3093\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u307e\u3061\u304c\u3063\u305f\u8a2d\u5b9a\u306eAMI\u3092\u4e00\u6642\u516c\u958b\u3057\u3066\u3057\u307e\u3063\u3066\u3044\u305f\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n\u7533\u3057\u8a33\u3054\u3056\u3044\u307e\u305b\u3093\uff01\n\n:warning: 2015/5/25\u8ffd\u8a18 - 2\n\n\u30e6\u30fc\u30b6\u60c5\u5831\u306f\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3066\u304b\u3089\u4fdd\u5b58\u3057\u307e\u3059\u306e\u3067\u3001phpMyAdmin\u3067\u30c7\u30fc\u30bf\u8ffd\u52a0\u3057\u3066\u3082\u30ed\u30b0\u30a4\u30f3\u6642\u306b\u30a8\u30e9\u30fc\u306b\u306a\u308a\u307e\u3059\u3002\u3054\u6ce8\u610f\u4e0b\u3055\u3044\u3002\n\n## :large_blue_circle: \u30ed\u30b0\u30a4\u30f3\u3068\u306f\uff1f\n\n\u7531\u6765\u306f[\u3053\u3046\u3044\u3046\u3053\u3068](http://gigazine.net/news/20140430-origin-of-log-in/)\u3089\u3057\u3044\u3067\u3059\u3002\n\u305d\u308c\u306f\u3055\u3066\u304a\u304d\u3001\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3092\u5b9f\u88c5\u3059\u308b\u969b\u306b\u3084\u308b\u3079\u304d\u3053\u3068\u306f\u6b21\u306e\uff12\u3064\u3067\u3059\u3002\n\n- \u8a8d\u8a3c - Authentication\n- \u627f\u8a8d(\u8a8d\u53ef) - Authorization\n\n\n### \u8a8d\u8a3c - Authentication \u3068\u306f\uff1f\n\n\u8a8d\u8a3c\u3068\u306f\u3001\u300c\u672c\u4eba\u78ba\u8a8d\u300d\u3068\u8a00\u3063\u3066\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n\u4eca\u56de\u4f5c\u6210\u3059\u308b\u30ed\u30b0\u30a4\u30f3\u6a5f\u80fd\u3067\u306f\u3001\u30b7\u30f3\u30d7\u30eb\u306a\u30d5\u30a9\u30fc\u30e0\u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u3064\u307e\u308a\u3001\u300c\u30e6\u30fc\u30b6ID\u300d\u3068\u300c\u30d1\u30b9\u30ef\u30fc\u30c9\u300d\u3092\u4f7f\u7528\u3057\u3001\u6b63\u3057\u3051\u308c\u3070\u672c\u4eba\u3067\u3042\u308b\u3068\u307f\u306a\u3057\u307e\u3059\u3002\n\u300c\u30ed\u30b0\u30a4\u30f3\u300d\u3068\u3044\u3063\u305f\u5834\u5408\u901a\u5e38\u306f\u3053\u306e\u300c\u8a8d\u8a3c\u300d\u3092\u6307\u3057\u307e\u3059\u304c\u3001\u300c\u627f\u8a8d\u300d\u51e6\u7406\u3068\u30bb\u30c3\u30c8\u3067\u5b9f\u88c5\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n### \u627f\u8a8d(\u8a8d\u53ef) - Authorization \u3068\u306f\uff1f\n\n\u300c\u8a8d\u8a3c\u300d\u3055\u308c\u305f\u30e6\u30fc\u30b6\u306b\u5bfe\u3057\u3001\u7279\u5b9a\u306e\u30ea\u30bd\u30fc\u30b9\u3084\u30b5\u30fc\u30d3\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u3053\u3068\u3092\u8a00\u3044\u307e\u3059\u3002\n\u4eca\u56de\u306f\u3001\u8a8d\u8a3c\u3055\u308c\u305f\u30e6\u30fc\u30b6\u306b\u306f\u5168\u30ea\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\u3059\u308b\u3053\u3068\u3068\u3057\u307e\u3059\u3002\n\n\n## :large_blue_circle: \u4eca\u56de\u306e\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u5b9f\u88c5\u306e\u7279\u6b8a\u306a\u3068\u3053\u308d\n\n\u3053\u306e\u52c9\u5f37\u4f1a\u306e\u5927\u524d\u63d0\u306f\u300cREST\u300d\u3001\u300cSinglePageApplication(SPA)\u300d\u3067\u3059\u3002\nSPA\u3067\u3082REST\u3067\u3082\u306a\u3044\u3001\u901a\u5e38\u306eCakePHP\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u3067\u30da\u30fc\u30b8\u751f\u6210\u3059\u308b\u666e\u901a\u306eWeb\u30a2\u30d7\u30ea\uff09\u3060\u3068\u3001\u672a\u8a8d\u8a3c\u72b6\u614b\u3067\u8a8d\u8a3c\u304c\u5fc5\u8981\u306a\u30da\u30fc\u30b8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u5834\u5408\u3001\u30ed\u30b0\u30a4\u30f3\u30da\u30fc\u30b8\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u307e\u3059\u3002\n\u3067\u3059\u304c\u3001SPA\u306e\u5834\u5408\u306f\u30b5\u30fc\u30d0\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306f\u5168\u3066RestAPI\u3092\u901a\u3058\u3066\u884c\u308f\u308c\u308b\u306e\u3067\u3001\u57fa\u672c\u7684\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u306f\u4f7f\u7528\u3057\u307e\u305b\u3093\u3002\u5358\u306bHTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9401(Unauthorized)\u3092\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8fd4\u3057\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u30d7\u30ed\u30b0\u30e9\u30e0\u304c\u81ea\u8eab\u3067\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\u672a\u8a8d\u8a3c\u306e\u72b6\u614b\u3067\u306e\u5168\u3066\u306eAPI\u30ea\u30af\u30a8\u30b9\u30c8\u306f\u3001HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9401\u3092\u8fd4\u3059\u53ef\u80fd\u6027\u304c\u3042\u308b\u306e\u3067\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u306f\u305d\u308c\u306b\u5bfe\u5fdc\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n## :large_blue_circle: \u4eca\u56de\u306e\u5185\u5bb9\n\n\u4eca\u56de\u306f\u3001\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002\u3051\u3063\u3053\u3046\u591a\u3044\u306e\u3067\u9811\u5f35\u308a\u307e\u3057\u3087\u3046\uff01\n\n### \u6a5f\u80fd\u30ea\u30b9\u30c8\n\n- \u30e6\u30fc\u30b6\u767b\u9332\n\t- \u30e6\u30fc\u30b6\u540d\u3068\u6c0f\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3001\u65b0\u898f\u30e6\u30fc\u30b6\u3092\u767b\u9332\u3057\u307e\u3059\n\t\t- \u6210\u529f\u3059\u308c\u3070\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\n- \u30ed\u30b0\u30a4\u30f3\n\t- \u30e6\u30fc\u30b6\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3001\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\n\t\t- \u6b63\u3057\u3051\u308c\u3070TODO\u4e00\u89a7\u753b\u9762\u306b\u9077\u79fb\n\t\t- \u9593\u9055\u3063\u3066\u3044\u308c\u3070\u30a8\u30e9\u30fc\u3092\u8868\u793a\n\t\t- \u65e2\u306b\u4ed6\u306e\u30e6\u30fc\u30b6\u304c\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306e\u5834\u5408\u305d\u306e\u65e8\u8868\u793a\n\t\t- \u81ea\u5206\u81ea\u8eab\u304c\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3042\u308c\u3070TODO\u4e00\u89a7\u753b\u9762\u306b\u9077\u79fb\n- \u30ed\u30b0\u30a2\u30a6\u30c8\n\t- \u30ed\u30b0\u30a4\u30f3\u3057\u305f\u72b6\u614b\u3067\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\n\t\t- \u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\n- \u30d8\u30c3\u30c0\u8868\u793a\n\t- \u30ed\u30b0\u30a4\u30f3\u4e2d\u306f\u753b\u9762\u4e0a\u90e8\uff08\u30d8\u30c3\u30c0\uff09\u306b\u30e6\u30fc\u30b6\u540d\u3068\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u3092\u5e38\u306b\u8868\u793a\u3059\u308b\u3002\n- \u8a8d\u8a3c\u6e08\u307f\u30c1\u30a7\u30c3\u30af\n\t- \u672a\u8a8d\u8a3c\u30e6\u30fc\u30b6\u306b\u3088\u308b\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306f\u5168\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\u3055\u305b\u308b\n\n### \u753b\u9762\u306f\u3053\u3093\u306a\u611f\u3058\u3067\u3059\n\n- \u30ed\u30b0\u30a4\u30f3\u3068\u30e6\u30fc\u30b6\u767b\u9332\n\t- \u753b\u9762\u4e0a\u534a\u5206\u304c\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3001\u4e0b\u534a\u5206\u304c\u30e6\u30fc\u30b6\u767b\u9332\u753b\u9762\u3067\u3059\u3002\n\t- \u30e6\u30fc\u30b6\u767b\u9332\u3067\u306f\u3001\u30e6\u30fc\u30b6\u540d\u3068\u6c0f\u540d\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u767b\u9332\u3057\u307e\u3059\u3002\n\t- :warning: \u767b\u9332\u306b\u306f\u300c\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u518d\u5165\u529b\u300d\u6b04\u3092\u7528\u610f\u3059\u308b\u306e\u304c\u30bb\u30aa\u30ea\u30fc\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u30b7\u30f3\u30d7\u30eb\u306b\u3059\u308b\u70ba\u3042\u3048\u3066\u7528\u610f\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n\t\t- \u4f59\u529b\u304c\u3042\u308c\u3070\u4ed8\u3051\u3066\u307f\u307e\u3057\u3087\u3046\uff01\n\n![login.png](https://qiita-image-store.s3.amazonaws.com/2006/65988/71ab61e1-022b-8c70-91fe-31d16298ba81.png \"login.png\")\n\n- TODO\u4e00\u89a7\u753b\u9762\n\t- \u753b\u9762\u4e0a\u90e8\u306b\u30d8\u30c3\u30c0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u30e6\u30fc\u30b6\u540d\u3068\u3001\u30ab\u30c3\u30b3\u5185\u306b\u6c0f\u540d\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![todo-lists.png](https://qiita-image-store.s3.amazonaws.com/2006/65988/82593c2e-7a13-1f13-3469-10db2c5fec58.png \"todo-lists.png\")\n\n- TODO\u8a73\u7d30\u753b\u9762\n\t- \u540c\u3058\u304f\u30d8\u30c3\u30c0\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n![todo-detail.png](https://qiita-image-store.s3.amazonaws.com/2006/65988/cb3a8f74-9b22-b2ce-5467-3b2f0d4f3c4a.png \"todo-detail.png\")\n\n## :large_blue_circle: \u4e8b\u524d\u6e96\u5099\n\n\u4e8b\u524d\u6e96\u5099\u306f\u6bce\u56de\u540c\u3058\u306a\u306e\u3067\u3001\u5225\u30a8\u30f3\u30c8\u30ea\u306b\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n[\u516812\u56de\u306e\u52c9\u5f37\u4f1a\u3067\u3084\u3063\u3066\u3044\u308bGit\u306e\u4f7f\u3044\u65b9 - AWS\u4e0a\u3067\u69cb\u7bc9\u3059\u308bRESTful\u30a2\u30d7\u30ea\u52c9\u5f37\u4f1a\uff5eWeb\u958b\u767a\u30ef\u30fc\u30af\u30b7\u30e7\u30c3\u30d7\uff5e - Qiita](http://qiita.com/k_shimoji/items/6a66dbb93b0553fa7c7f)\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u3084\u308b\u3053\u3068\u306f\u3001\n\n- git\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u6574\u3048\u3066\u4eca\u56de\u7528\u30d6\u30e9\u30f3\u30c1`vol/05`\u3092\u4f5c\u6210\u3059\u308b\n\n\u3067\u3059\u3002\u307e\u305a\u3053\u308c\u3092\u3084\u308a\u307e\u3057\u3087\u3046\u3002\u4eca\u56de\u306f\u3055\u3089\u306b\u3001\n\n- \u30e6\u30fc\u30b6\u767b\u9332\u7528\u306e\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n\n\u3082\u884c\u3044\u307e\u3059\u3002\n\n### \u30e6\u30fc\u30b6\u767b\u9332\u7528\u306e\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\n\n\n\u4f5c\u6210\u3059\u308b\u306e\u306f\u3001`users`\u30c6\u30fc\u30d6\u30eb\u3067\u3059\u3002\n\n\u307e\u305a\u3001phpMyAdmin\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u3087\u3046\u3002\n\nURL\u306f\u3001`http://(PublicIP)/phpMyAdmin/`\u3067\u3059\u3002\n\u5909\u66f4\u3057\u3066\u3044\u306a\u3051\u308c\u3070\u3001\u30e6\u30fc\u30b6\u540d`study`\u3001\u30d1\u30b9\u30ef\u30fc\u30c9`study`\u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\u3002\n\n\u4e0b\u56f3\u306e\u901a\u308a\u3001\u5de6\u5074\u30da\u30a4\u30f3\u306e[study]-[New]\u3092\u30af\u30ea\u30c3\u30af\u3057\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n![create_table.png](https://qiita-image-store.s3.amazonaws.com/2006/65988/91df8b24-25b7-e0bd-6f87-6657a1d949f6.png \"create_table.png\")\n\n\n\u4e0b\u8a18\u306e\u901a\u308a\u8a2d\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002\n\n##### \u30c6\u30fc\u30d6\u30eb\u540d\n\n`users`\n\n##### \u5404\u5217\u306e\u8a2d\u5b9a\n\n|\u540d\u524d|\u30c7\u30fc\u30bf\u578b|\u9577\u3055/\u5024|\u30c7\u30d5\u30a9\u30eb\u30c8\u5024|\u7167\u5408\u9806\u5e8f|\u5c5e\u6027|NULL|\u30a4\u30f3\u30c7\u30c3\u30af\u30b9|A_I(AutoIncrement)|\u30b3\u30e1\u30f3\u30c8|\n|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--\n|id|INT|10|\u306a\u3057|\u3000|UNSIGNED|\u3000|PRIMARY|\u30ec|id\n|username|VARCHAR|20|\u306a\u3057|utf8_general_ci|\u3000|\u3000|UNIQUE|\u3000|\u30e6\u30fc\u30b6\u540d\n|password|VARCHAR|100|\u306a\u3057|utf8_general_ci|\u3000|\u3000|\u3000|\u3000|\u30d1\u30b9\u30ef\u30fc\u30c9\n|name|VARCHAR|50|\u306a\u3057|utf8_general_ci|\u3000|\u3000|\u3000|\u3000|\u6c0f\u540d\n\n##### \u305d\u306e\u4ed6\u306e\u8a2d\u5b9a\n\n- \u30c6\u30fc\u30d6\u30eb\u306e\u30b3\u30e1\u30f3\u30c8:`\u30e6\u30fc\u30b6`\n- \u30b9\u30c8\u30ec\u30fc\u30b8\u30a8\u30f3\u30b8\u30f3:`InnoDB`\n- \u7167\u5408\u9806\u5e8f:`utf8_general_ci`\n- \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u5b9a\u7fa9:\u7a7a\u767d\n\n\u300c\u4fdd\u5b58\u3059\u308b\u300d\u30af\u30ea\u30c3\u30af\u3067\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\uff01\n\n#### \u6e96\u5099\n\n\u3067\u306f\u3001\u6e96\u5099\u3092\u59cb\u3081\u307e\u3057\u3087\u3046\uff01\n\n- :white_check_mark: Git\u306e\u30d6\u30e9\u30f3\u30c1\u3092\u6574\u3048\u3066\u3001`vol/05`\u30d6\u30e9\u30f3\u30c1\u3092\u4f5c\u6210\u3002\n- :white_check_mark: \u30e6\u30fc\u30b6\u767b\u9332\u7528\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3002\n\n\u6e96\u5099\u304c\u3067\u304d\u305f\u3089\u3001Lesson1\u3067\u3059\uff01\n\n\n## :large_blue_circle: Lesson1 \u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\n\nLesson1\u3067\u306f\u3001\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u30c6\u30b9\u30c8\u306b\u306f\u3001\u7b2c1\u56de\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u300cPOSTMAN\u300d\u3092\u4f7f\u7528\u3057\u3066API\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u307e\u3059\u3002\n\n### \u30dd\u30a4\u30f3\u30c8\n\nSPA\u3067\u306a\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u3001WebAPI\u3092\u4f7f\u7528\u3057\u305fSPA\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5b9f\u88c5\u306e\u4ed5\u65b9\u306e\u9055\u3044\u3092\u6291\u3048\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n#### \u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067TODO\u4e00\u89a7\u3092\u8868\u793a\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\n\n##### SPA\u3067\u306a\u3044\u901a\u5e38\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\n\n\u3053\u3046\u3044\u3046\u30b7\u30fc\u30b1\u30f3\u30b9\u3067\u3059\u3002\n\n![login_seq_normal.png](https://qiita-image-store.s3.amazonaws.com/2006/65988/3b078c51-415d-c224-39a7-aa6847f2f7c0.png \"login_seq_normal.png\")\n\n1. TODO\u4e00\u89a7\u753b\u9762\u3092\u30b5\u30fc\u30d0\u306b\u8981\u6c42\n2. \u30b5\u30fc\u30d0\u306f\u3001\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u304b\u3089\u306e\u8981\u6c42\u306a\u306e\u3067\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9302\u3092\u8fd4\u3057\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u305b\u308b\u3002\n3. 302\u3092\u53d7\u3051\u305f\u30d6\u30e9\u30a6\u30b6\u304c\u3001`Location`\u30d8\u30c3\u30c0\u3067\u6307\u5b9a\u3055\u308c\u305fURL\u3092\u8981\u6c42\n4. \u30b5\u30fc\u30d0\u306f\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306eHTML\u3092\u8fd4\u3059\n\n##### SPA\u306e\u5834\u5408\n\n\u3053\u3046\u306a\u308a\u307e\u3059\u3002\n\n![login_seq_spa.png](https://qiita-image-store.s3.amazonaws.com/2006/65988/1ab09e4a-1824-319b-df96-7765d75f4b6b.png \"login_seq_spa.png\")\n\n1. TODO\u4e00\u89a7\u753b\u9762\u3092\u30b5\u30fc\u30d0\u306b\u8981\u6c42\n2. \u30b5\u30fc\u30d0\u306f\u3001\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u304b\u3089\u306e\u8981\u6c42\u306a\u306e\u3067\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9401\u3092\u8fd4\u3057\u3001\u8981\u6c42\u304c\u8a31\u53ef\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u5fdc\u7b54\u3059\u308b\u3002\n3. 401\u3092\u53d7\u3051\u308b\u3068Javascript\u304c\u81ea\u5206\u3067\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\n\u3053\u306e\u9055\u3044\u3092\u6291\u3048\u3066\u304a\u304d\u307e\u3057\u3087\u3046\uff01\n\n### \u4f5c\u6210\u3059\u308bAPI\n\n|URL|Http Method|\u51e6\u7406|Controller|Action|\n|-------------------------------|----|----------------------------------------------|----------------|--------|\n|/rest-study/users/login.json\t|POST|\u30ed\u30b0\u30a4\u30f3\u3059\u308b                                    |UsersController |login\n|/rest-study/users/logout.json\t|POST|\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b                                  |UsersController |logout\n|/rest-study/users/loggedin.json|GET |\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u53d6\u5f97\uff08\u30ed\u30b0\u30a4\u30f3\u4e2d\u304b\u3069\u3046\u304b\u306e\u30c1\u30a7\u30c3\u30af\uff09|UsersController |loggedIn\n|/rest-study/users/signup.json\t|POST|\u30e6\u30fc\u30b6\u3092\u767b\u9332\u3059\u308b                                 |UsersController |signUp\n\n### \u7de8\u96c6\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\n\n|\u7de8\u96c6|file|\u7de8\u96c6\u6982\u8981|\n|---|:----------------------------------|:----------------------|\n|\u4fee\u6b63|app/Config/routes.php              |\u8ffd\u52a0\u3059\u308bAPI\u3078\u306e\u30eb\u30fc\u30c8\u8ffd\u52a0\n|\u4fee\u6b63|app/Controller/AppController.php   |Auth\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306e\u8a2d\u5b9a\n|\u65b0\u898f|app/Controller/UsersController.php |API\u5b9f\u88c5\n|\u65b0\u898f|app/Model/User.php                 |\u30e6\u30fc\u30b6\u30c6\u30fc\u30d6\u30eb\u3078\u306e\u30a2\u30af\u30bb\u30b9\n\n\n#### routes.php\n\n\u8ffd\u52a0\u3057\u305fAPI\u3078\u306e\u30eb\u30fc\u30c8\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```diff:routes.php\n\u301c\u7565\u301c\n /*\n  * API\n  */\n+\n+// \u30ed\u30b0\u30a4\u30f3\n+Router::connect('/users/login', array (\n+\t'controller' => 'users',\n+\t'action' => 'login',\n+\t'method' => array (\n+\t\t'POST'\n+\t)\n+));\n+\n+// \u30ed\u30b0\u30a2\u30a6\u30c8\n+Router::connect('/users/logout', array (\n+\t'controller' => 'users',\n+\t'action' => 'logout',\n+\t'method' => 'POST'\n+));\n+\n+// \u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af(\u30ed\u30b0\u30a4\u30f3\u60c5\u5831\u53d6\u5f97)\n+Router::connect('/users/loggedin', array (\n+\t'controller' => 'users',\n+\t'action' => 'loggedIn',\n+\t'method' => 'GET'\n+));\n+\n+// \u30b5\u30a4\u30f3\u30a2\u30c3\u30d7\n+Router::connect('/users/signup', array (\n+\t'controller' => 'users',\n+\t'action' => 'signUp',\n+\t'method' => array (\n+\t\t'POST'\n+\t)\n+));\n+\n+\n Router::mapResources(array (\n \t'todo_lists',\n ));\n Router::parseExtensions('json');\n\u301c\u7565\u301c\n```\n\n\u5358\u7d14\u306aCRUD\u3092\u5b9f\u884c\u3059\u308bAPI\u3067\u3042\u308c\u3070\u3001\n`Router::mapResources()`\u95a2\u6570\u3067Controller\u3092\u8ffd\u52a0\u3057\u3066\u3042\u3052\u308c\u3070\n`index`, `view`, `add`, `edit`, `delete`\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3078\u306e\u30eb\u30fc\u30c8\u304c\u8a2d\u5b9a\u3055\u308c\u307e\u3059\u304c\u3001\u30ed\u30b0\u30a4\u30f3\u306eURL\u306f\u3053\u3046\u3067\u306f\u306a\u3044\u306e\u3067\u3001\u500b\u5225\u306b\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n`Router::connect()`\u95a2\u6570\u3092\u4f7f\u7528\u3057\u3066\u4e0b\u8a18\u9805\u76ee\u3092\u5168\u3066\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n- URL\n- \u5b9f\u884c\u3059\u308bcontroller\n- \u5b9f\u884c\u3059\u308baction\n- \u5bfe\u8c61\u3068\u3059\u308bhttp\u30e1\u30bd\u30c3\u30c9\n\n\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\u3001\n\n- URL -> `/users/login`\n- \u5b9f\u884c\u3059\u308bcontroller -> `users`\n- \u5b9f\u884c\u3059\u308baction -> `login`\n- \u5bfe\u8c61\u3068\u3059\u308bhttp\u30e1\u30bd\u30c3\u30c9 -> `POST`\n\n\u306a\u306e\u3067\u3001\u4e0a\u8a18\u30b3\u30fc\u30c9\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\n#### AppController.php\n\n\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3001\u627f\u8a8d\u51e6\u7406\u3092\u8ffd\u52a0\u3002\n\n```diff:routes.php\n class AppController extends Controller {\n-    public $components = array(\n-        'RequestHandler'\n-    );\n+\tpublic $components = array (\n+\t\t'RequestHandler',\n+\t\t'Auth' => array (\n+\t\t\t'authenticate' => array (\n+\t\t\t\t'Form' => array (\n+\t\t\t\t\t'passwordHasher' => 'Blowfish'\n+\t\t\t\t)\n+\t\t\t)\n+\t\t)\n+\t);\n+\n+\tpublic function beforeFilter() {\n+\t\t$user = $this->Auth->user();\n+\t\tif ($user === null\n+\t\t\t\t&& $this->request->params['controller'] !== 'users'\n+\t\t\t\t&& $this->request->params['action'] !== 'login'\n+\t\t\t\t&& $this->request->params['action'] !== 'logout'\n+\t\t\t\t&& $this->request->params['action'] !== 'loggedin'\n+\t\t\t\t&& $this->request->params['action'] !== 'signup') {\n+\t\t\t\t\tthrow new UnauthorizedException();\n+\t\t}\n+\t\t//\u5168\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u8a31\u53ef\n+\t\t$this->Auth->allow();\n+\t}\n+\n }\n```\n\n##### `$components`\u5909\u6570\n\n\u8a8d\u8a3c\u51e6\u7406\u306f\u3001CakePHP\u304c\u7528\u610f\u3057\u3066\u304f\u308c\u3066\u3044\u308b`Auth`\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u30d5\u30a9\u30fc\u30e0\u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30cf\u30c3\u30b7\u30e5\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u306f`Blowfish`\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3092\u6307\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n##### `beforeFilter`\u95a2\u6570\n\n\u5168\u3066\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u306e\u524d\u306b\u5b9f\u884c\u3055\u308c\u308b\u95a2\u6570\u304c\u3053\u306ebeforeFilter\u95a2\u6570\u3067\u3059\u3002\n\u3053\u3053\u3067\u3001\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304d\u305f\u30e6\u30fc\u30b6\u304c\u8a8d\u8a3c\u6e08\u307f\u304b\u3069\u3046\u304b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u3044\u307e\u3059\u3002\n\u8a8d\u8a3c\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u30ed\u30b0\u30a4\u30f3(login)\u3001\u30e6\u30fc\u30b6\u767b\u9332(signup)\u3001\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u30c1\u30a7\u30c3\u30af(loggedin)\u4ee5\u5916\u306f\u5b9f\u884c\u51fa\u6765\u306a\u3044\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n- `$this->Auth->user()`\u3067\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u53d6\u5f97\n- \u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u304c\u53d6\u5f97\u3067\u304d\u306a\u304b\u3063\u305f\u5834\u5408\u3001`users`\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u306e\u4e0b\u8a18\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u9664\u304d\u3001`UnauthorizedException`\u3092throw\u3057\u3066401\u30a8\u30e9\u30fc\u3092\u767a\u751f\u3055\u305b\u307e\u3059\u3002\n\t- login\n\t- loggedin\n\t- signup \n\n\n### UsersController.php\n\n\u30ed\u30b0\u30a4\u30f3\u3001\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u30c1\u30a7\u30c3\u30af\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u3001\u30e6\u30fc\u30b6\u767b\u9332\u306e\u5b9f\u88c5\u3067\u3059\u3002\n\n```php:UsersController.php\n<?php\n\nApp::uses('AppController', 'Controller');\nApp::uses('BlowfishPasswordHasher', 'Controller/Component/Auth');\n\nclass UsersController extends AppController {\n\n\tpublic function login() {\n\t\t$user = $this->Auth->user();\n\t\t$res = array();\n\t\tif ($user) {\n\t\t\tif ($user['username'] === $this->request->data['username']) {\n\t\t\t\t$res['User'] = $user;\n\t\t\t\t$res['message'] = \"\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3059\";\n\t\t\t} else {\n\t\t\t\t$res['message'] = \"\u5225\u306e\u30e6\u30fc\u30b6\u304c\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3059\";\n\t\t\t}\n\t\t} else {\n            $this->request->data['User']['username'] = $this->request->data['username'];\n            $this->request->data['User']['password'] = $this->request->data['password'];\n\t\t\tif ($this->Auth->login()) {\n\t\t\t\t$user = $this->Auth->user();\n\t\t\t\t$res['User'] = $user;\n\t\t\t\t$res['message'] = \"\u30ed\u30b0\u30a4\u30f3\u6210\u529f\";\n\t\t\t} else {\n\t\t\t\t$res['message'] = \"\u30e6\u30fc\u30b6\u540d\u307e\u305f\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059\";\n\t\t\t}\n\t\t}\n\t\t$this->set(compact('res'));\n\t\t$this->set('_serialize', 'res');\n\t}\n\n\tpublic function loggedIn(){\n\t\t$user = $this->Auth->user();\n\t\tif ($user) {\n\t\t\t$res['User'] = $user;\n\t\t\t$res['message'] = \"\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3059\";\n\t\t\t$this->set(compact('res'));\n\t\t\t$this->set('_serialize', 'res');\n\t\t}else{\n\t\t\tthrow new UnauthorizedException();\n\t\t}\n\t}\n\n\tpublic function logout() {\n\t\t$user = $this->Auth->user();\n\t\t$res = array();\n\t\tif ($user !== null) {\n\t\t\t$this->Auth->logout();\n\t\t\t$res['message'] = \"\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002\";\n\t\t} else {\n \t\t\t$res['message'] = \"\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u305b\u3093\u3002\";\n\t\t}\n\t\t$this->set(compact('res'));\n\t\t$this->set('_serialize', 'res');\n\t}\n\n\tpublic function signUp() {\n\t\t$data = $this->request->data;\n\t\tif (isset($data['password'])) {\n\t\t\t$passwordHasher = new BlowfishPasswordHasher();\n\t\t\t$data['password'] = $passwordHasher->hash($data['password']);\n\t\t}\n\t\t$res = $this->User->save($data);\n\t\tif($res){\n\t\t\tunset($res['User']['password']);\n\t\t\t$res['message'] = \"\u767b\u9332\u3057\u307e\u3057\u305f\u3002\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\uff01\";\n\t\t}else{\n\t\t\t$res['message'] = \"\u767b\u9332\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\";\n\t\t}\n\t\t$this->set(compact('res'));\n\t\t$this->set('_serialize', 'res');\n\t}\n\n}\n```\n\n#### `login`\u95a2\u6570\n\n\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u7d50\u679c\u3068\u3057\u3066\u3001\u4e0b\u8a18\u306e4\u3064\u306e\u3044\u305a\u308c\u304b\u306b\u306a\u308a\u307e\u3059\u3002\n\n- \u30ed\u30b0\u30a4\u30f3\u6210\u529f\n- \u30ed\u30b0\u30a4\u30f3\u5931\u6557\uff08\u30e6\u30fc\u30b6\u540dor\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3046\uff09\n- \u81ea\u5206\u304c\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\n- \u4ed6\u4eba\u304c\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\n\n\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u306f\u3001\n\n- `$this->request->data['User']['username']`\u306b\u30e6\u30fc\u30b6\u540d\u3001\n- `$this->request->data['User']['password']`\u306b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3057\u3001\n- `$this->Auth->login()`\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8fd4\u3059JSON\u306e\u9805\u76ee\u3068\u3057\u3066\u3001\u4e0b\u8a18\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\n\n- `User` -> \u30e6\u30fc\u30b6\u60c5\u5831(id, username, name)\n- `message` -> \u51e6\u7406\u7d50\u679c\u3092\u8868\u3059\u30e1\u30c3\u30bb\u30fc\u30b8\n\n```json:\u4f8b\uff08\u30ed\u30b0\u30a4\u30f3\u6210\u529f\u6642\uff09\n{\n    \"User\": {\n        \"id\": \"1\",\n        \"username\": \"test\",\n        \"name\": \"\u30c6\u30b9\u30c8\"\n    },\n    \"message\": \"\u30ed\u30b0\u30a4\u30f3\u6210\u529f\"\n}\n```\n\n#### `loggedIn`\u95a2\u6570\n\n\u30e6\u30fc\u30b6\u304c\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u304b\u3069\u3046\u304b\u8abf\u3079\u307e\u3059\u3002\n\n- `$this->Auth->user()`\u3067\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3001`null`\u3067\u306a\u3051\u308c\u3070\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3068\u5224\u65ad\u3057\u307e\u3059\u3002\n- \u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\u3001`UnauthorizedException`\u3092throw\u3057\u3066401\u30a8\u30e9\u30fc\u3092\u767a\u751f\u3055\u305b\u307e\u3059\u3002\n- \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8fd4\u3059JSON\u306f`login`\u95a2\u6570\u3068\u540c\u3058\u304f\u3001`user`\u3068`message`\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n#### `logout`\u95a2\u6570\n\n\u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n- `$this->Auth->user()`\u3067\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u304b\u5224\u65ad\u3057\u3001\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306a\u3089`$this->Auth->logout()`\u3067\u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n- \u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\u306f\u30ed\u30b0\u30a2\u30a6\u30c8\u51e6\u7406\u306f\u5b9f\u884c\u305b\u305a\u3001JSON\u306b`message`\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n#### `signUp`\u95a2\u6570\n\n`User`\u30e2\u30c7\u30eb\u3092\u4f7f\u7528\u3057\u3066\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3057\u307e\u3059\u3002\n\n- \u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u3001`BlowfishPasswordHasher`\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3057\u3066\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u305f\u6587\u5b57\u5217\u3092\u4fdd\u5b58\u3057\u307e\u3059\u3002\n- \u4fdd\u5b58\u304c\u6210\u529f\u3057\u305f\u5834\u5408JSON\u306b\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u304c\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u9664\u3044\u3066\u304a\u304d\u307e\u3059(`unset($res['User']['password']);`)\u3002\n\n#### User.php\n\nusers\u30c6\u30fc\u30d6\u30eb\u306b\u30c7\u30fc\u30bf\u3092\u767b\u9332\u3059\u308b\u305f\u3081\u306emodel\u3067\u3059\u3002\n\n```php:User.php\n<?php\n\nApp::uses('AppModel', 'Model');\n\nclass User extends AppModel {\n}\n```\n\nCakePHP\u306emodel\u306e\u6a19\u6e96\u6a5f\u80fd\u4ee5\u5916\u4f55\u3082\u5b9f\u88c5\u3057\u3066\u3044\u307e\u305b\u3093\u3002\n:warning: \u3061\u3083\u3093\u3068\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306a\u3089\u3001\u3053\u3053\u306b\u5165\u529b\u5024\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u7b49\u3092\u5b9f\u88c5\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u304c\u3001\u4eca\u56de\u306e\u30c6\u30fc\u30de\u3067\u306f\u7121\u3044\u306e\u3067\u5b9f\u88c5\u3057\u306a\u3044\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n\n###\u3000\u52d5\u4f5c\u78ba\u8a8d\n\nPOSTMAN\u3067\u5404API\u3092\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002\n\u5404API\u306e\u5b9f\u884c\u4f8b\u3092\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\u53c2\u8003\u306b\u3057\u3066\u3084\u3063\u3066\u307f\u307e\u3057\u3087\u3046\uff01\n:warning: \u30e6\u30fc\u30b6\u767b\u9332\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u3001`siginin`\u5b9f\u884c\u6642\u306b\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3066\u304b\u3089\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\u306a\u306e\u3067\u3001phpMyAdmin\u3067\u30ec\u30b3\u30fc\u30c9\u8ffd\u52a0\u3057\u305f\u30c7\u30fc\u30bf\u3067\u306f\u30ed\u30b0\u30a4\u30f3\u306b\u5931\u6557\u3057\u307e\u3059\u306e\u3067\u3054\u6ce8\u610f\u4e0b\u3055\u3044\u3002\n\u4e0b\u8a18\u3001`siginup`API\u304b\u3089\u30c6\u30b9\u30c8\u3059\u308b\u3068\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n- \u4f8b\n\n|URL|\u30ea\u30af\u30a8\u30b9\u30c8JSON|\u30ec\u30b9\u30dd\u30f3\u30b9\u30b3\u30fc\u30c9|\u30ec\u30b9\u30dd\u30f3\u30b9JSON|\n|---|:----------------------------------------|--------|:----------------------|\n|/rest-study/users/signup.json|200|{<br>\u3000\"username\": \"test2\",<br>\u3000\"password\": \"test2\",<br>\u3000\"name\": \"\u30c6\u30b9\u30c8\uff12\"<br>}|{<br>\u3000\"User\": {<br>\u3000\u3000\"username\": \"test2\",<br>\u3000\u3000\"name\": \"\u30c6\u30b9\u30c8\uff12\",<br>\u3000\u3000\"id\": \"65\"<br>\u3000},<br>\u3000\"message\": \"\u767b\u9332\u3057\u307e\u3057\u305f\u3002\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u3059\uff01\"<br>}\n|/rest-study/users/login.json|{<br>\u3000\"username\":\"test\",<br>\u3000\"password\":\"test\"<br>}|200|{<br>\u3000\"User\": {<br>\u3000\u3000\"id\": \"1\",<br>\u3000\u3000\"username\": \"test\",<br>\u3000\u3000\"name\": \"\u30c6\u30b9\u30c8\"<br>\u3000},<br>\u3000\"message\": \"\u30ed\u30b0\u30a4\u30f3\u6210\u529f\"<br>}                    |\n|/rest-study/users/login.json|{<br>\u3000\"username\":\"test\",<br>\u3000\"password\":\"hoge\"<br>}|200|{<br>\"message\": \"\u30e6\u30fc\u30b6\u540d\u307e\u305f\u306f\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059\"<br>}                    |\n|/rest-study/users/logout.json| - |200|{<br>\u3000\"message\": \"\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f\u3002\"<br>}|\n|/rest-study/users/loggedin.json| - |200|{<br>\u3000\"User\": {<br>\u3000\u3000\"id\": \"1\",<br>\u3000\u3000\"username\": \"test\",<br>\u3000\u3000\"name\": \"\u30c6\u30b9\u30c8\"<br>\u3000},<br>\u3000\"message\": \"\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3067\u3059\"<br>}                    \n\n- \u30a8\u30e9\u30fc\u6642\u306e\u4f8b1(\u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af - 401\u304c\u8fd4\u5374)\n\n|URL|\u30ea\u30af\u30a8\u30b9\u30c8JSON|\u30ec\u30b9\u30dd\u30f3\u30b9\u30b3\u30fc\u30c9|\u30ec\u30b9\u30dd\u30f3\u30b9JSON|\n|---|:----------------------------------------|--------|:----------------------|\n|/rest-study/users/loggedin.json| - |401|{<br>\u3000\"name\": \"Unauthorized\",<br>\u3000\"message\": \"Unauthorized\",<br>\u3000\"url\": \"/rest-study/users/loggedIn.json\"<br>}|\n\n- \u30a8\u30e9\u30fc\u6642\u306e\u4f8b2(\u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067TODO\u4e00\u89a7\u3092\u53d6\u5f97 - 401\u304c\u8fd4\u5374)\n\n|URL|\u30ea\u30af\u30a8\u30b9\u30c8JSON|\u30ec\u30b9\u30dd\u30f3\u30b9\u30b3\u30fc\u30c9|\u30ec\u30b9\u30dd\u30f3\u30b9JSON|\n|---|:----------------------------------------|--------|:----------------------|\n|/rest-study/users/todo_lists.json| - |401|{<br>\u3000\"name\": \"Unauthorized\",<br>\u3000\"message\": \"Unauthorized\",<br>\u3000\"url\": \"/rest-study/users/todo_lists.json\"<br>}|\n\n### \u5b9f\u88c5\n\n\u3067\u306f\u3001\u5b9f\u969b\u306b\u4fee\u6b63\u3057\u3066API\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n- :white_check_mark: `app/Config/routes.php` \u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n- :white_check_mark: `app/Controller/AppController.php` \u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n- :white_check_mark: `app/Controller/UsersController.php` \u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n- :white_check_mark: `app/Model/User.php` \u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n- :white_check_mark: \u52d5\u4f5c\u78ba\u8a8d!\n- :white_check_mark: Git\u306b\u30b3\u30df\u30c3\u30c8\n\n**GitHub\u3067\u306ediff\u8868\u793a\u3078\u306e\u30ea\u30f3\u30af**\n\n[\u7b2c5\u56de Lesson1 \u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9 \u00b7 suzukishouten-study/rest-study@59c29b0](https://github.com/suzukishouten-study/rest-study/commit/59c29b052dc9599002680a891987f914b83bfa38?diff=split)\n\nLesson2\u3078!\n\n\n\n## :large_blue_circle: Lesson2 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\n\nLesson2\u3067\u306f\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\n### \u30dd\u30a4\u30f3\u30c8\n\n\u3061\u3087\u3063\u3068\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\u304c\u3042\u308b\u306e\u3067\u30c1\u30a7\u30c3\u30af\u3057\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u306fAjax\u3067\u3042\u308a\u3001\u975e\u540c\u671f\u3067\u3059\u3002\u305d\u306e\u3053\u3068\u3092\u6291\u3048\u3066\u304a\u3051\u3070\u5927\u4e08\u592b\u3067\u3059\uff01\n\n\u30d6\u30e9\u30a6\u30b6\u3067TODO\u4e00\u89a7\u753b\u9762\u306eURL\u3092\u53e9\u3044\u305f\u5f8c\u306e\u52d5\u4f5c\u30b7\u30fc\u30b1\u30f3\u30b9\u306b\u3064\u3044\u3066\u6b21\u306b\u8aac\u660e\u3057\u307e\u3059\u3002\n\u8d77\u52d5\u6642\u306b\u3001\u307e\u305a\u30b5\u30fc\u30d0\u306b\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u53d6\u308a\u306b\u884c\u3063\u3066\u3001\u53d6\u308c\u305f\u3089\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u3068\u5224\u65ad\u3057\u307e\u3059\u3002\n\uff08\u30d8\u30c3\u30c0\u306b\u8868\u793a\u3059\u308b\u30e6\u30fc\u30b6\u60c5\u5831\u306e\u53d6\u5f97\u3092\u517c\u306d\u3066\u3044\u307e\u3059\uff09\n\n#### \u6b63\u3057\u3044\u52d5\u4f5c\n\n\u3046\u307e\u304f\u52d5\u304f\u30b7\u30fc\u30b1\u30f3\u30b9\u306f\u4e0b\u56f3\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n![client_flow_good.png](https://qiita-image-store.s3.amazonaws.com/2006/65988/6c9e5ae6-505b-0f04-48c6-4f42655deeff.png \"client_flow_good.png\")\n\n1. \u30ed\u30b0\u30a4\u30f3\u4e2d\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u51e6\u7406\u3092\u958b\u59cb\n2. XHR(XmlHttpRequest)\u3092\u4f7f\u7528\u3057\u3001\u30b5\u30fc\u30d0\u3068\u901a\u4fe1\u3057\u307e\u3059\u3002\u3053\u306e\u6642\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u53d7\u4fe1\u6642\u306b\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092XHR\u306b\u6559\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n3. \u30b5\u30fc\u30d0\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u4fe1\u5f8c\u3001XHR\u306f2\u3067\u6307\u5b9a\u3055\u308c\u305f\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n4. \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3067\u306f\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u3092\u307f\u3066\u3001\u30e6\u30fc\u30b6\u60c5\u5831(`\u30ed\u30b0\u30a4\u30f3\u6e08\u307f` or `\u672a\u30ed\u30b0\u30a4\u30f3`\u306e\u5224\u65ad\u306b\u5229\u7528)\u3092\u8a18\u61b6\u3057\u307e\u3059\u3002\n5. \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3057\u307e\u3059(`Backbone.history.start()`\u95a2\u6570)\u3002\n6. \u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u5b9f\u884c\u3055\u308c\u3001TODO\u4e00\u89a7\u753b\u9762\u8868\u793a\u95a2\u6570\u304c\u5b9f\u884c\u3092\u958b\u59cb\n7. 4\u3067\u8a18\u61b6\u3057\u305f\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u78ba\u8a8d\n\t- \u30e6\u30fc\u30b6\u60c5\u5831\u304c\u53d6\u5f97\u6e08\u307f(\u30ed\u30b0\u30a4\u30f3\u6e08\u307f)\u306a\u3089\u3001TODO\u4e00\u89a7\u8868\u793a\u753b\u9762\u3092\u8868\u793a\n\t- \u30e6\u30fc\u30b6\u60c5\u5831\u672a\u53d6\u5f97(\u672a\u30ed\u30b0\u30a4\u30f3)\u306a\u3089\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\n\n#### \u3046\u307e\u304f\u52d5\u304b\u306a\u3044\u30d1\u30bf\u30fc\u30f3\n\n\u524d\u56de\u307e\u3067\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3067\u306f\u3001\u4e0a\u8a18\u306e5\u3067\u3084\u3063\u3066\u3044\u308b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u6709\u52b9\u5316(`Backbone.history.start()`\u95a2\u6570)\u3092\u8d77\u52d5\u6642\u306b\u3059\u3050\u3084\u3063\u3066\u3044\u307e\u3059\u3002\n\u3053\u306e\u307e\u307e\u3060\u3068\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30b7\u30fc\u30b1\u30f3\u30b9\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n![client_flow_bad.png](https://qiita-image-store.s3.amazonaws.com/2006/65988/f7ab2794-921c-c1f8-a7d4-136299b33d22.png \"client_flow_bad.png\")\n\n\n1. \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u6709\u52b9\u306b\u3057\u307e\u3059(`Backbone.history.start()`\u95a2\u6570)\u3002\n2. \u30ed\u30b0\u30a4\u30f3\u4e2d\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u51e6\u7406\u3092\u958b\u59cb\n3. XHR(XmlHttpRequest)\u3092\u4f7f\u7528\u3057\u3001\u30b5\u30fc\u30d0\u3068\u901a\u4fe1\u3057\u307e\u3059\u3002\u3053\u306e\u6642\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u53d7\u4fe1\u6642\u306b\u5b9f\u884c\u3059\u308b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092XHR\u306b\u6559\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n4. 1\u3067\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306f\u65e2\u306b\u6709\u52b9\u306a\u306e\u3067\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u3092\u53d7\u3051\u308b\u524d\u306b\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u304c\u5b9f\u884c\u3055\u308c\u3001TODO\u4e00\u89a7\u753b\u9762\u8868\u793a\u95a2\u6570\u304c\u5b9f\u884c\u3092\u958b\u59cb\n5. \u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u5f8c\u8a18\u9332\u3055\u308c\u308b\u4e88\u5b9a\u306e\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u78ba\u8a8d\u3002\n\t- \u3057\u304b\u3057\u307e\u3060\u5fdc\u7b54\u304c\u306a\u3044\u306e\u3067\u3053\u3053\u3067\u306f\u30e6\u30fc\u30b6\u60c5\u5831\u304c\u672a\u53d6\u5f97\u3002\u3088\u3063\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n6. \u30b5\u30fc\u30d0\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u4fe1\u5f8c\u3001XHR\u306f2\u3067\u6307\u5b9a\u3055\u308c\u305f\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n7. \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u3067\u306f\u3001\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u3092\u307f\u3066\u3001\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u8a18\u61b6\u3057\u307e\u3059\u3002\u304c\u3001\u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3092\u8868\u793a\u3057\u305f\u5f8c\u3067\u3059\u3002\n\n\u4e0a\u8a18\u304b\u3089\u3001\u30ed\u30b0\u30a4\u30f3\u4e2d\u3067\u3042\u3063\u305f\u3068\u3057\u3066\u3082TODO\u4e00\u89a7\u753b\u9762\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002\n\u3053\u3046\u3044\u3063\u305f\u3001\u300c\u30b5\u30fc\u30d0\u304b\u3089\u306e\u5fdc\u7b54\u304c\u8fd4\u308b\u524d\u306b\u4ed6\u306e\u51e6\u7406\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u300d\u3068\u3044\u3046\u52d5\u304d\u3092\u6291\u3048\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n### \u7de8\u96c6\u3059\u308b\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\n\n|\u7de8\u96c6|file|\u7de8\u96c6\u6982\u8981|\n|---|:------------------------------------------------|:----------------------|\n|\u4fee\u6b63|app/View/Layouts/default.ctp                    |\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u8ffd\u52a0\u3001\u4fee\u6b63\n|\u4fee\u6b63|app/webroot/js/main.js                          |application.start()\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u5909\u66f4\n|\u4fee\u6b63|app/webroot/js/app.js                           |\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u7b49\n|\u4fee\u6b63|app/webroot/js/routers/router.js                |\u30eb\u30fc\u30c8\u8ffd\u52a0\n|\u4fee\u6b63|app/webroot/js/routers/controller.js            |\u30ed\u30b0\u30a4\u30f3\u95a2\u9023\u306e\u753b\u9762\u9077\u79fb\u5236\u5fa1\n|\u65b0\u898f|app/webroot/js/models/user-model.js             |API\u306e\u5b9f\u884c\n|\u65b0\u898f|app/webroot/js/views/login-layout-view.js       |\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u8868\u793a\u7528\u30d3\u30e5\u30fc\n|\u65b0\u898f|app/webroot/js/views/header-view.js             |\u30d8\u30c3\u30c0\u8868\u793a\u7528\u30d3\u30e5\u30fc\n\n### default.ctp\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u8ffd\u52a0\u3002\n\n```diff:default.ctp\n <title>\u30b7\u30f3\u30d7\u30ebTODO\u30a2\u30d7\u30ea</title>\n </head>\n <body>\n+\t<!-- \u30d8\u30c3\u30c0 -->\n+\t<div id=\"header\"></div>\n \t<!-- \u30b3\u30f3\u30c6\u30f3\u30c4 -->\n \t<div id=\"main\"></div>\n+\t\n+\t<!-- \u30d8\u30c3\u30c0\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n+\t<script type=\"text/template\" id=\"header-template\">\n+\t<p>\u30e6\u30fc\u30b6\uff1a<%- username %>\uff08<%- name %>\uff09\u3000<input type=\"button\" id=\"logout\" value=\"\u30ed\u30b0\u30a2\u30a6\u30c8\"></input></p>\n+\t<hr>\n+\t</script>\n \n \t<!-- TODO\u4e00\u89a7\u8868\u793a\u306e\u30ec\u30a4\u30a2\u30a6\u30c8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n  \u301c\u7565\u301c\n  \t</script>\n \n \t<!-- \u8a73\u7d30\u753b\u9762\u306e\u30ec\u30a4\u30a2\u30a6\u30c8\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n \t<script type=\"text/template\" id=\"todo-detail-layout-template\">\n  \u301c\u7565\u301c\n \t</script>\n \n \t<!-- \u8a73\u7d30\u753b\u9762\u306e\u8868\u793a\u5185\u5bb9\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n \t<script type=\"text/template\" id=\"todo-detail-item-template\">\n  \u301c\u7565\u301c\n \t</script>\n \n+\t<!-- \u30ed\u30b0\u30a4\u30f3\u753b\u9762\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8 -->\n+\t<script type=\"text/template\" id=\"login-layout-template\">\n+\t<h2>\u30ed\u30b0\u30a4\u30f3</h2>\n+\t<div>\n+\t<p>\u30e6\u30fc\u30b6\u540d\u3000\uff1a<input type=\"text\" id=\"username\" placeholder=\"username\" autofocus></input></p>\n+\t<p>\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a<input type=\"password\" id=\"password\" placeholder=\"password\"></input></p>\n+\t<input type=\"button\" id=\"login\" value=\"\u30ed\u30b0\u30a4\u30f3\"></input>\n+\t</div>\n+\t<hr>\n+\t<h2>\u30e6\u30fc\u30b6\u767b\u9332</h2>\n+\t<div>\n+\t<p>\u30e6\u30fc\u30b6\u540d\u3000\uff1a<input type=\"text\" id=\"signup-username\" placeholder=\"username\"></input></p>\n+\t<p>\u6c0f\u540d\u3000\u3000\u3000\uff1a<input type=\"text\" id=\"signup-name\" placeholder=\"name\"></input></p>\n+\t<p>\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a<input type=\"password\" id=\"signup-password\" placeholder=\"password\"></input></p>\n+\t<input type=\"button\" id=\"signup\" value=\"\u767b\u9332\"></input>\n+\t</div>\n+\t</script>\n+\n \t<!-- require -->\n \t<script type=\"text/javascript\" src=\"js/require-config.js\"></script>\n \t<script type=\"text/javascript\" src=\"js/lib/require.js\" data-main=\"main.js\"></script>\n\n </body>\n </html>\n```\n\n\u4e0b\u8a18\u3092\u8ffd\u52a0\u3002\n\n- \u30d8\u30c3\u30c0\u60c5\u5831\u3092\u8868\u793a\u3059\u308bRegion\u3092\u3059\u308bdiv\u30bf\u30b0\n- \u30d8\u30c3\u30c0\u60c5\u5831\u8868\u793a\u30d3\u30e5\u30fc\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\t- \u30e6\u30fc\u30b6\u540d\u3001\u6c0f\u540d\u3001\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u3092\u914d\u7f6e\n- \u30ed\u30b0\u30a4\u30f3\u753b\u9762\u7528\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\t- \u30ed\u30b0\u30a4\u30f3\u7528\u8981\u7d20\u3092\u914d\u7f6e\n\t\t- \u30e6\u30fc\u30b6\u540d\n\t\t- \u30d1\u30b9\u30ef\u30fc\u30c9\n\t\t- \u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\n\t- \u30e6\u30fc\u30b6\u767b\u9332\u7528\u8981\u7d20\u3092\u914d\u7f6e\n\t\t- \u30e6\u30fc\u30b6\u540d\n\t\t- \u6c0f\u540d\n\t\t- \u30d1\u30b9\u30ef\u30fc\u30c9\n\t\t- \u767b\u9332\u30dc\u30bf\u30f3\n\n### main.js\n\n```diff:main.js\n \trequire(['app'], function(Application){\n \t\tconsole.log('run main2');\n \t\twindow.application = new Application();\n-\t\twindow.application.start();\n-\t\tconsole.log('app start');\n \t});\n });\n```\n\n`application.start()`\u3092\u524a\u9664\u3002\n\u3053\u308c\u306f\u3001\u5148\u7a0b\u8ff0\u3079\u305f\u30cf\u30de\u308a\u30dd\u30a4\u30f3\u30c8\u306e\u5bfe\u5fdc\u3067\u3059\u3002\n\u5f8c\u8ff0\u3059\u308bapplication(`app.js`)\u5185\u3067\u306e\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\uff08\u30ed\u30b0\u30a4\u30f3\u4e2d\u304b\u3069\u3046\u304b\u78ba\u8a8d\uff09\u306e\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u3066\u304b\u3089application.start()\u3092\u5b9f\u884c\u3059\u308b\u305f\u3081\u3067\u3059\u3002`application.start()`\u3092\u524a\u9664\u3057\u305f\u5834\u5408(\u671f\u5f85\u3059\u308b\u52d5\u4f5c)\u3068\u3001\u524a\u9664\u3057\u306a\u304b\u3063\u305f\u5834\u5408\u306e\u52d5\u4f5c\u306e\u9055\u3044\u3092\u3001\u4eca\u5ea6\u306f\u30b3\u30fc\u30c9\u3092\u30d9\u30fc\u30b9\u306b\u8aac\u660e\u3057\u307e\u3059\u3002\n\n#### `application.start()`\u3092\u524a\u9664\u3057\u305f\u5834\u5408(\u671f\u5f85\u3059\u308b\u52d5\u4f5c)\n\n- `/rest-study/`\u306b\u30a2\u30af\u30bb\u30b9\n- main.js\u5b9f\u884c\u3002 ***applicaion\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u751f\u6210\u3059\u308b\u306e\u307f***\n- app.js\u306e`initialize`\u95a2\u6570\u5185\u3067\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u884c(`loggedin`API\u306eAjax\u901a\u4fe1\u958b\u59cb)\n- `loggedin`API\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u53d6\u308a\u3001\n\t- \u30ed\u30b0\u30a4\u30f3\u4e2d\u306a\u3089\u30e6\u30fc\u30b6\u60c5\u5831\u4fdd\u6301\n\t- \u672a\u30ed\u30b0\u30a4\u30f3\u306a\u3089\u30e6\u30fc\u30b6\u60c5\u5831\u30af\u30ea\u30a2\n\t- application.start()\u3092\u5b9f\u884c\n\t\t- `onStart()`\u304c\u5b9f\u884c\u3055\u308c\u3001`Backbone.history.start()`\u304c\u5b9f\u884c\u3001\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u958b\u59cb\u3055\u308c\u308b\u3002\n\t\t- controller\u304c\u5b9f\u884c\u3055\u308c\u3001\n\t\t\t- \u30e6\u30fc\u30b6\u60c5\u5831\u3092\u4fdd\u6301\u3057\u3066\u3044\u308b\u5834\u5408\u3001TODO\u4e00\u89a7\u753b\u9762\u306b\u9077\u79fb\n\t\t\t- \u30e6\u30fc\u30b6\u60c5\u5831\u304c\u30af\u30ea\u30a2\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3001`Backbone.history.navigate()`\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762(`/#login`)\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\n\n#### `application.start()`\u3092\u524a\u9664\u3057\u306a\u304b\u3063\u305f\u5834\u5408\n\n- `/rest-study/`\u306b\u30a2\u30af\u30bb\u30b9\n- main.js\u5b9f\u884c\u3002 ***applicaion.start()\u3092\u5b9f\u884c***\n- app.js\u306e`initialize`\u95a2\u6570\u5185\u3067\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u3092\u5b9f\u884c(`loggedin`API\u306eAjax\u901a\u4fe1\u958b\u59cb)\n- `loggedin`API\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u53d6\u308b\u524d\u306b\u3001app.js\u306e`onStart()`\u304c\u5b9f\u884c\u3055\u308c\u3001`Backbone.history.start()`\u304c\u5b9f\u884c\u3001\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u958b\u59cb\u3055\u308c\u308b\u3002\n\t- controller\u304c\u5b9f\u884c\u3055\u308c\u3001\n\t\t- `loggedin`API\u306eAjax\u901a\u4fe1\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u307e\u3060\u53d7\u3051\u53d6\u3063\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u30e6\u30fc\u30b6\u60c5\u5831\u304c\u30af\u30ea\u30a2\u3055\u308c\u3066\u3044\u308b\u72b6\u614b\uff08\u521d\u671f\u5024\uff09\u306a\u306e\u3067\u3001`Backbone.history.navigate()`\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762(`/#login`)\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0(\u5b9f\u969b\u306b\u30ed\u30b0\u30a4\u30f3\u3055\u308c\u3066\u3044\u308b\u304b\u5426\u304b\u306b\u304b\u304b\u308f\u3089\u305a)\u3002\n- `loggedin`API\u304b\u3089\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u53d7\u53d6\u308a\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306b\u8a2d\u5b9a\u3059\u308b\n\t- \u30ed\u30b0\u30a4\u30f3\u4e2d\u306a\u3089\u30e6\u30fc\u30b6\u60c5\u5831\u4fdd\u6301\n\t- \u672a\u30ed\u30b0\u30a4\u30f3\u306a\u3089\u30e6\u30fc\u30b6\u60c5\u5831\u30af\u30ea\u30a2\n\t- \u304c\u3001\u65e2\u306bcontroller\u306e\u51e6\u7406\u306f\u7d42\u308f\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u304c\u8868\u793a\u3055\u308c\u308b...\n\n### app.js\n\n\u30ed\u30b0\u30a4\u30f3\u95a2\u9023\u306e\u5404\u51e6\u7406\u3092\u8ffd\u52a0\u3002\n\n```diff:app.js\n define(function(require){\n \tconsole.log('run app');\n \tvar Router = require('routers/router');\n+\tvar UserModel = require('models/user-model');\n \tvar Application = Marionette.Application.extend({\n \t\tinitialize : function(){\n \t\t\tconsole.log('app.initialize');\n+\t\t\t// Ajax\u306e\u30a8\u30e9\u30fc\u306e\u5171\u901a\u30cf\u30f3\u30c9\u30e9\u3092\u8a2d\u5b9a\n+\t\t\t$(document).ajaxError(function ( e, xhr, options , message ) {\n+\t\t\t\twindow.application.ajaxErrorHandler( e, xhr, options , message );\n+\t\t\t});\n \t\t\tnew Router();\n+\t\t\t//\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u30b5\u30fc\u30d0\u304b\u3089\u53d6\u5f97\n+\t\t\tthis.loginUser = new UserModel();\n+\t\t\tthis.getLoginUser();\n \t\t},\n \n \t\tonStart : function(){\n \t\t\tBackbone.history.start();\n \t\t},\n \n \t\tregions : {\n+\t\t\theaderRegion : '#header',\n \t\t\tmainRegion : '#main'\n-\t\t}\n+\t\t},\n+\t\t\n+\t\t//\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u683c\u7d0d\u7528\n+\t\tloginUser : null,\n+\n+\t\t//\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u53d6\u5f97\n+\t\tgetLoginUser : function(){\n+\t\t\tthis.loginUser.getLoginUser(\n+\t\t\t\tthis.onLoggedIn,\n+\t\t\t\tthis.onNotLoggedIn\n+\t\t\t);\n+\t\t},\n+\t\t\n+\t\t//\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u53d6\u5f97:\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306e\u5834\u5408\n+\t\tonLoggedIn : function(){\n+\t\t\twindow.application.start(); // applicaiton.start()\u306f\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u5f8c\n+\t\t},\n+\t\t\n+\t\t//\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u53d6\u5f97:\u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\n+\t\tonNotLoggedIn : function(){\n+\t\t\twindow.application.clearLoginUser();\t//\u30ed\u30b0\u30a4\u30f3\u60c5\u5831\u3092\u30af\u30ea\u30a2\u3057\u3066\u304a\u304f\n+\t\t\twindow.application.start();\t// applicaiton.start()\u306f\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af\u306e\u5f8c\n+\t\t},\n+\t\t\n+\t\t//\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u304b\u5224\u5b9a\n+\t\tisLoggedIn : function(){\n+\t\t\treturn this.loginUser.isLoggedIn();\n+\t\t},\n+\t\t\n+\t\t//\u30ed\u30b0\u30a4\u30f3\u30e6\u30fc\u30b6\u60c5\u5831\u306e\u30af\u30ea\u30a2(\u30ed\u30b0\u30a2\u30a6\u30c8\u6642)\n+\t\tclearLoginUser : function(){\n+\t\t\tthis.loginUser.clear();\n+\t\t},\n+\n+\t\t// ajax\u306e\u30a8\u30e9\u30fc\u3092\u5168\u3066\u3053\u3053\u3067\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n+\t\tajaxErrorHandler : function(e, xhr, options , message){\n+\t\t\tif( xhr.status === 401 ){\n+\t\t\t\tthis.clearLoginUser();\n+\t\t\t\t// \u672a\u8a8d\u8a3c\u306e\u5834\u5408\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u98db\u3070\u3059\n+\t\t\t\tBackbone.history.navigate('#login', {trigger : true, replace : true});\n+\t\t\t}else if(xhr.status >= 400 && xhr.status < 500){\n+\t\t\t\t//ClientError\u306e\u5834\u5408\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\n+\t\t\t\talert(message);\n+\t\t\t}else if(xhr.status >= 500 && xhr.status < 600){\n+\t\t\t\t//ServerError\u306e\u5834\u5408\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\n+\t\t\t\talert(message);\n+\t\t\t}\n+\t\t},\n \n \t});\n \treturn Application;\n```\n\n\u4e3b\u306a\u4fee\u6b63\u70b9\u3002\n\n#### \u8ffd\u52a0require\n\n- \u30ed\u30b0\u30a4\u30f3\u95a2\u9023\u306eAPI\u3092\u5b9f\u884c\u3059\u308b\u70ba\u3001`models/user-model.js`\u3092require\u3002\n\n#### `initialize`\u95a2\u6570\n\n- Ajax\u306e\u30a8\u30e9\u30fc\u306e\u5171\u901a\u30cf\u30f3\u30c9\u30e9(`ajaxErrorHandler`\u95a2\u6570)\u3092\u8a2d\u5b9a\n- require\u3057\u305f`user-model`\u3092\u751f\u6210\u3057\u3001\u30ed\u30b0\u30a4\u30f3\u30c1\u30a7\u30c3\u30af(`loggedin`API)\u3092\u5b9f\u884c\u3002\n\t- API\u306f`getLoginUser`\u95a2\u6570\u5185\u3067\u5b9f\u884c\n\t\t- \u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306e\u5834\u5408\u3001`onLoggedIn`\u95a2\u6570\u304c\u5b9f\u884c\u3055\u308c\u308b\u3002\n\t\t- \u672a\u30ed\u30b0\u30a4\u30f3\u306e\u5834\u5408\u3001`onNotLoggedIn`\u95a2\u6570\u304c\u5b9f\u884c\u3055\u308c\u308b\u3002\n####  ajaxErrorHandler\n\n\u5168\u3066\u306eAjax\u901a\u4fe1\u306e\u30a8\u30e9\u30fc\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u3002\n\n- http status\u304c`401(Unauthorized)`(\u672a\u30ed\u30b0\u30a4\u30f3)\u306e\u5834\u5408\u3001`Backbone.history.navigate()`\u95a2\u6570\u3092\u5b9f\u884c\u3057\u3066\u30ed\u30b0\u30a4\u30f3\u753b\u9762(`/#login`)\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n- \u305d\u308c\u4ee5\u5916\u306ehttp status\u306e\u5834\u5408\u306falert\u8868\u793a\u3002\n\n### router.js\n\n```diff:router.js\n\u301c\u7565\u301c\n \t\t//\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u8a2d\u5b9a\n \t\tappRoutes : {\n+\t\t\t'login'             : 'login',\n\t\t\t''                  : 'todoLists',\n\t\t\t'todo-lists'        : 'todoLists',\n\t\t\t'todo-lists/:id'    : 'todoDetail'\n \t\t},\n\u301c\u7565\u301c\n```\n\n\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u3078\u306e\u30eb\u30fc\u30c8\u3092\u8ffd\u52a0\u3002\n\n### controller.js\n\n```diff:controller.js\n //controller\n console.log('load controller');\n define(function() {\n \tconsole.log('run controller');\n \tvar TodoController = Marionette.Controller.extend({\n+\t\tlogin : function(){\n+\t\t\t//\u30ed\u30b0\u30a4\u30f3\u753b\u9762\n+\t\t\tthis.nextView('views/login-layout-view', null, true);\n+\t\t},\n \n \t\ttodoLists : function() {\n \t\t\t//Todo\u30ec\u30a4\u30a2\u30a6\u30c8\u7528\u30d3\u30e5\u30fc\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n \t\t\tthis.nextView('views/todo-layout-view');\n \t\t},\n \n \t\ttodoDetail : function(id) {\n \t\t\tthis.nextView('views/todo-detail-layout-view', {modelId : id});\n \t\t},\n \n-\t\tnextView : function(viewPath, option) {\n+\t\tnextView : function(viewPath, option, tryShowLoginScreen) {\n+\t\t\tif(window.application.isLoggedIn()){\n+\t\t\t\t//\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\n+\t\t\t\tif(tryShowLoginScreen){\n+\t\t\t\t\t//\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u306a\u306e\u306b\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u5834\u5408\u306f\n+\t\t\t\t\t//TODO\u30ea\u30b9\u30c8\u753b\u9762\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n+\t\t\t\t\tBackbone.history.navigate('#todo-lists', {trigger: true, replace: true});\n+\t\t\t\t\treturn;\n+\t\t\t\t}\n+\t\t\t}else{\n+\t\t\t\t//\u672a\u30ed\u30b0\u30a4\u30f3\n+\t\t\t\tif(!tryShowLoginScreen){\n+\t\t\t\t\t//\u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u5834\u5408\u306f\n+\t\t\t\t\t//\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n+\t\t\t\t\tBackbone.history.navigate('#login', {trigger: true, replace: true});\n+\t\t\t\t\treturn;\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\t//\u30d8\u30c3\u30c0\u8868\u793a\n+\t\t\tthis.showHeaderRegion(tryShowLoginScreen);\n+\t\t\t//\u30b3\u30f3\u30c6\u30f3\u30c4\u8868\u793a\n \t\t\trequire([viewPath], function(View){\n \t\t\t\twindow.application.mainRegion.show(new View(option));\n \t\t\t});\n \t\t},\n-\n+\t\t\n+\t\tshowHeaderRegion : function(tryShowLoginScreen){\n+\t\t\tif(tryShowLoginScreen){\n+\t\t\t\t//\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u9077\u79fb\u6642\u306f\u30d8\u30c3\u30c0\u975e\u8868\u793a\n+\t\t\t\twindow.application.headerRegion.empty();\n+\t\t\t}else if(!window.application.headerRegion.hasView()){\n+\t\t\t\t//\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916\u9077\u79fb\u6642\u3001\u304b\u3064\u30d8\u30c3\u30c0\u672a\u8868\u793a\u306e\u5834\u5408\u30d8\u30c3\u30c0\u8868\u793a\n+\t\t\t\trequire(['views/header-view'], function(View){\n+\t\t\t\t\twindow.application.headerRegion.show(new View({\n+\t\t\t\t\t\tmodel : window.application.loginUser\n+\t\t\t\t\t}));\n+\t\t\t\t});\n+\t\t\t}\n+\t\t}\n+\t\t\n \t});\n \treturn TodoController;\n });\n```\n\n#### `login`\u95a2\u6570\u8ffd\u52a0\n\n- nextView\u95a2\u6570\u306b\u8ffd\u52a0\u3057\u305f`tryShowLoginScreen`\u30d1\u30e9\u30e1\u30fc\u30bf(\u5f8c\u8ff0)\u3092true\u3067\u5b9f\u884c\n\n#### `nextView`\u95a2\u6570\n\n- `nextView`\u95a2\u6570\u3067\u3001\u30ed\u30b0\u30a4\u30f3\u6642\u3068\u307f\u30ed\u30b0\u30a4\u30f3\u6642\u306e\u5224\u65ad\u30ed\u30b8\u30c3\u30af\u8ffd\u52a0\n\t- \u30ed\u30b8\u30c3\u30af\u306f\u30bd\u30fc\u30b9\u4e2d\u306e\u30b3\u30e1\u30f3\u30c8\u901a\u308a\u3002\u4e0b\u8a18\u306e2\u30d1\u30bf\u30fc\u30f3\u306e\u52d5\u4f5c\u3092\u5236\u5fa1\u3057\u3066\u3044\u308b(\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306f`tryShowLoginScreen`\u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u5224\u5b9a)\u3002\n\t\t- \u65e2\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u308b\u306e\u306b\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\u306fTODO\u4e00\u89a7\u753b\u9762\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\t\t- \u672a\u30ed\u30b0\u30a4\u30f3\u72b6\u614b\u3067TODO\u4e00\u89a7\u3084TODO\u8a73\u7d30\u753b\u9762(\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u4ee5\u5916)\u306b\u9077\u79fb\u3057\u3088\u3046\u3068\u3057\u305f\u5834\u5408\u306f\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n- \u30b3\u30f3\u30c6\u30f3\u30c4(TODO\u4e00\u89a7\u3084\u8a73\u7d30\u753b\u9762)\u306eview\u3092\u8868\u793a\u3059\u308b\u524d\u306b\u3001\u30d8\u30c3\u30c0\u3092\u8868\u793a\u3002\n\n### `showHeaderRegion`\u95a2\u6570\n\n- \u30ed\u30b0\u30a4\u30f3\u753b\u9762\u8868\u793a\u6642\u306f\u30d8\u30c3\u30c0\u7528view\u3092\u975e\u8868\u793a\u306b\u3059\u308b\u3002\n- \u30b3\u30f3\u30c6\u30f3\u30c4\u753b\u9762\u8868\u793a\u6642\u306f\u3001\u30d8\u30c3\u30c0\u7528view\u3092\u8868\u793a\u3059\u308b\u3002\n\n\n### `user-model.js`\n\n\u8ffd\u52a0\u3057\u305fAPI\u3092\u547c\u3073\u51fa\u3059\u3002\n\n```js:user-model.js\n//\u30ed\u30b0\u30a4\u30f3\u7528\u30e2\u30c7\u30eb\ndefine(function() {\n\tvar LoginModel = Backbone.Model.extend({\n\t\t\n\t\tparse : function(response) {\n\t\t\tif(response.message){\n\t\t\t\tthis.loginMessage = response.message;\n\t\t\t}\n\t\t\treturn response.User;\n\t\t},\n\n\t\tloginMessage : null,\n\n\t\t//\u30ed\u30b0\u30a4\u30f3\u6e08\u307f\u304b\u3069\u3046\u304b\u5224\u5b9a\n\t\tisLoggedIn : function(){\n\t\t\treturn this.get('id') ? true : false;\n\t\t},\n\t\t\n\t\t//\u30ed\u30b0\u30a4\u30f3\u4e2d\u306e\u30e6\u30fc\u30b6\u60c5\u5831\u53d6\u5f97\n\t\tgetLoginUser : function(onLoggedIn, onNotLoggedIn){\n\t\t\tthis.urlRoot = '/rest-study/users/loggedin';\n\t\t\tthis.fetch(\n\t\t\t\t{\n\t\t\t\t\twait : true,\n\t\t\t\t\tsuccess : function(){\n\t\t\t\t\t\tonLoggedIn();\n\t\t\t\t\t},\n\t\t\t\t\terror : function(){\n\t\t\t\t\t\tonNotLoggedIn();\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\t\n\t\t//\u30ed\u30b0\u30a4\u30f3\u3059\u308b\n\t\tlogin : function(username, password, onLoginSuccess, onLoginError){\n\t\t\tthis.urlRoot = '/rest-study/users/login';\n\t\t\tthis.save(\n\t\t\t\t{\n\t\t\t\t\tusername : username, \n\t\t\t\t\tpassword : password\n\t\t\t\t}, {\n\t\t\t\t\tsuccess : function(model){\n\t\t\t\t\t\tif(model.get('id')){\n\t\t\t\t\t\t\tonLoginSuccess(model.loginMessage);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tonLoginError(model.loginMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\t\n\t\t//\u30ed\u30b0\u30a2\u30a6\u30c8\u3059\u308b\n\t\tlogout : function(onLogoutSuccess){\n\t\t\tthis.urlRoot = '/rest-study/users/logout';\n\t\t\tthis.save(\n\t\t\t\t{}, \n\t\t\t\t{\n\t\t\t\t\tsuccess : function(model){\n\t\t\t\t\t\tonLogoutSuccess(model.loginMessage);\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\t//\u767b\u9332\uff08\u30b5\u30a4\u30f3\u30a2\u30c3\u30d7\uff09\u3059\u308b\n\t\tsignup : function(username, password, name, onSignUpSuccess, onSignUpError){\n\t\t\tthis.urlRoot = '/rest-study/users/signup';\n\t\t\tthis.save(\n\t\t\t\t{\n\t\t\t\t\tusername : username, \n\t\t\t\t\tpassword : password,\n\t\t\t\t\tname     : name\n\t\t\t\t}, {\n\t\t\t\t\tsuccess : function(model){\n\t\t\t\t\t\tif(model.get('id')){\n\t\t\t\t\t\t\tonSignUpSuccess(model.loginMessage);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tonSignUpError(model.loginMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t});\n\treturn LoginModel;\n});\n```\n\n#### `parse`\u95a2\u6570\n\n\u30b5\u30fc\u30d0\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u4e0b\u8a18\u306e\u901a\u308a\u51e6\u7406\u3057\u3066\u3044\u307e\u3059\u3002\n\n- `message`\u3092`loginMessage`\u5909\u6570\u306b\u4fdd\u6301\u3002\n- `User`(\u30e6\u30fc\u30b6\u60c5\u5831)\u3092\u53d6\u308a\u51fa\u3057\u3066return\u3002\n\n#### \u5404API\u306e\u5b9f\u884c\u65b9\u6cd5\n\n- GET\u30e1\u30bd\u30c3\u30c9\u3067\u5b9f\u884c\u3059\u308b\u3082\u306e(`loggedin`API)\u306f`fetch`\u95a2\u6570\u3092\u5b9f\u884c\u3002\n- POST\u30e1\u30bd\u30c3\u30c9\u3067\u5b9f\u884c\u3059\u308b\u3082\u306e(`login`\u3001`logout`\u3001`signup`\u306e\u5404API\u306f`save`\u95a2\u6570\u3092\u5b9f\u884c\u3002\n- \u5404API\u306eURL\u306f\u3001\u5404\u95a2\u6570\u5b9f\u884c\u6642\u306b`urlRoot`\u5909\u6570\u3092\u5909\u66f4\u3059\u308b\u3053\u3068\u3067\u6307\u5b9a\u3002\n- API\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u53d7\u53d6\u308a\u5f8c\u306f\u3001view\u5074\u306e\u95a2\u6570\u3092\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3059\u308b\u3053\u3068\u3067view\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3002\n- \u30a8\u30e9\u30fc\u6642\u306f\u3001`app.js`\u3067\u8a2d\u5b9a\u3057\u305f`ajaxErrorHandler`\u95a2\u6570\u304c\u5b9f\u884c\u3055\u308c\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u306f\u4f55\u3082\u3057\u306a\u3044\u3002\n\n\n### login-layout-view.js\n\nMarionette.LayoutView\u3092\u7d99\u627f\u3057\u3066\u5b9f\u88c5\u3002\n\n```js:login-layout-view.js\n//\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u7528\u30ec\u30a4\u30a2\u30a6\u30c8\u30d3\u30e5\u30fc\ndefine(function(require) {\n\tvar LoginModel = require('models/user-model');\n\t\n\tvar LoginLayoutView = Marionette.LayoutView.extend({\n\t\t//\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\t\ttemplate : '#login-layout-template',\n\n\t\t//UI\u30d1\u30fc\u30c4\n\t\tui : {\n\t\t\tusername       : '#username',           // \u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30e6\u30fc\u30b6\u540d\n\t\t\tpassword       : '#password',           // \u30ed\u30b0\u30a4\u30f3\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n\t\t\tloginButton    : '#login',              // \u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\n\t\t\tsignupUsername : '#signup-username',    // \u767b\u9332\u6642\u306e\u30e6\u30fc\u30b6\u540d\n\t\t\tsignupPassword : '#signup-password',    // \u767b\u9332\u6642\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\n\t\t\tname           : '#signup-name',        // \u767b\u9332\u6642\u306e\u6c0f\u540d\n\t\t\tsignupButton   : '#signup'              // \u767b\u9332\u30dc\u30bf\u30f3\n\t\t},\n\n\t\t//\u30a4\u30d9\u30f3\u30c8\n\t\tevents : {\n\t\t\t//\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n\t\t\t'click @ui.loginButton' : 'onLoginClick',\n\t\t\t//\u767b\u9332\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n\t\t\t'click @ui.signupButton' : 'onsignupClick',\n\t\t},\n\t\t\n\t\t//\u30ed\u30b0\u30a4\u30f3\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n\t\tonLoginClick : function(){\n\t\t\t//\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u304b\u3089\u6587\u5b57\u3092\u53d6\u5f97\n\t\t\tvar username = this.ui.username.val();    //\u30e6\u30fc\u30b6\u540d\n\t\t\tvar password = this.ui.password.val();    //\u30d1\u30b9\u30ef\u30fc\u30c9\n\t\t\twindow.application.loginUser.login(\n\t\t\t\tusername,\n\t\t\t\tpassword,\n\t\t\t\tthis.onLoginSuccess,\n\t\t\t\tthis.onLoginError);\n\t\t},\n\t\t\n\t\t//\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u6210\u529f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\t\tonLoginSuccess : function(message){\n\t\t\tBackbone.history.navigate('todo-lists', {trigger: true, replace: true});\n\t\t\tconsole.log(message);\n\t\t},\n\n\t\t//\u30ed\u30b0\u30a4\u30f3\u51e6\u7406\u5931\u6557\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\t\tonLoginError : function(message){\n\t\t\talert(message);\n\t\t},\n\t\t\n\t\t//\u767b\u9332\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n\t\tonsignupClick : function(){\n\t\t\t//\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u304b\u3089\u6587\u5b57\u3092\u53d6\u5f97\n\t\t\tvar username = this.ui.signupUsername.val();    //\u30e6\u30fc\u30b6\u540d\n\t\t\tvar password = this.ui.signupPassword.val();\t//\u30d1\u30b9\u30ef\u30fc\u30c9\n\t\t\tvar name = this.ui.name.val();                  //\u6c0f\u540d\n\t\t\tvar userModel = new LoginModel();\n\t\t\tuserModel.signup(\n\t\t\t\t\tusername,\n\t\t\t\t\tpassword,\n\t\t\t\t\tname,\n\t\t\t\t\tthis.onsignupSuccess,\n\t\t\t\t\tthis.onsignupError);\n\t\t},\n\n\t\t//\u767b\u9332\u6210\u529f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\t\tonsignupSuccess : function(message){\n\t\t\talert(message);\n\t\t},\n\t\t\n\t\t//\u767b\u9332\u5931\u6557\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\t\tonsignupError : function(message){\n\t\t\talert(message);\n\t\t},\n\t\t\n\t});\n\treturn LoginLayoutView;\n});\n```\n\n\u30aa\u30fc\u30bd\u30c9\u30c3\u30af\u30b9\u306a\u30d3\u30e5\u30fc\u306e\u5b9f\u88c5\u3067\u3059\u3002\n\n- `ui`\u5909\u6570\u3067\u5404\u5165\u529b\u9805\u76ee\u3084\u30dc\u30bf\u30f3\u306ehtml\u30a8\u30ec\u30e1\u30f3\u30c8\u3092\u8a2d\u5b9a\n- `event`\u5909\u6570\u3067\u30dc\u30bf\u30f3\u306eClick\u30a4\u30d9\u30f3\u30c8\u3068\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u3092\u7d10\u4ed8\u3051\n- \u5404Click\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u95a2\u6570\u3067\u306f`user-model`\u3092\u4f7f\u7528\u3057\u3066API\u3092\u5b9f\u884c\n\t- \u30ed\u30b0\u30a4\u30f3\u6642\u306f\u3001`app.js`\u5185\u306b\u4fdd\u6301\u3057\u3066\u3044\u308b`user-model`\u3092\u4f7f\u7528(\u8fd4\u3063\u3066\u304d\u305f\u30e6\u30fc\u30b6\u60c5\u5831\u3092\u305d\u306e\u307e\u307e`app.js`\u5185\u306b\u4fdd\u6301\u3059\u308b\u305f\u3081)\u3002\n\t- \u30e6\u30fc\u30b6\u767b\u9332\u6642\u306f\u3001`user-model`\u3092\u65b0\u3057\u304f\u751f\u6210\u3057\u3066\u4f7f\u7528(\u8fd4\u3063\u3066\u304d\u305f\u30e6\u30fc\u30b6\u60c5\u5831\u306f\u4f7f\u7528\u3057\u306a\u3044\u305f\u3081)\n- API\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u6642\u306b\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u5b9f\u884c\u3001\u753b\u9762\u9077\u79fb\u3084\u30e1\u30c3\u30bb\u30fc\u30b8\u8868\u793a\u3092\u884c\u3046\n\t- \u30ed\u30b0\u30a4\u30f3\u6210\u529f\u6642\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u95a2\u6570\u5185\u3067\u3001TODO\u4e00\u89a7\u753b\u9762\u306b\u9077\u79fb\u3055\u305b\u3066\u3044\u308b\n\n### header-view.js\n\nMarionette.ItemView\u3092\u7d99\u627f\u3057\u3066\u5b9f\u88c5\u3002\n\n```js:header-view.js\n//\u30d8\u30c3\u30c0\u7528\u30d3\u30e5\u30fc\ndefine(function(require){\n\tvar UserModel = require('models/user-model');\n\n\tvar HeaderView = Marionette.ItemView.extend({\n\n\t\t//\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\t\ttemplate : '#header-template',\n\n\t\tui : {\n\t\t\tlogoutButton : '#logout',\n\t\t},\n\n\t\t//DOM\u30a4\u30d9\u30f3\u30c8\u30cf\u30f3\u30c9\u30e9\u8a2d\u5b9a\n\t\tevents : {\n\t\t\t//\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u30af\u30ea\u30c3\u30af\u6642\n\t\t\t'click @ui.logoutButton' : 'onLogoutClick',\n\t\t},\n\n\t\tonLogoutClick : function(){\n\t\t\tvar userModel = new UserModel();\n\t\t\tuserModel.logout(this.onLogoutSuccess);\n\t\t},\n\n\t\tonLogoutSuccess : function(message){\n\t\t\twindow.application.clearLoginUser();\n\t\t\tBackbone.history.navigate('#login', {trigger : true, replace : true});\n\t\t\tconsole.log(message);\n\t\t},\n\n\t});\n\treturn HeaderView;\n});\n```\n\n\u3053\u308c\u3082\u30aa\u30fc\u30bd\u30c9\u30c3\u30af\u30b9\u306a\u30d3\u30e5\u30fc\u306e\u5b9f\u88c5\u3067\u3059\u3002\n\n- `ui`\u5909\u6570\u3067\u30ed\u30b0\u30a2\u30a6\u30c8\u30dc\u30bf\u30f3\u3092\u8a2d\u5b9a\n- `event`\u5909\u6570\u3067`onLogoutClick`\u95a2\u6570\u3092\u7d10\u4ed8\u3051\n- `onLogoutClick`\u95a2\u6570\u3067\u306f`user-model`\u3092\u4f7f\u7528\u3057\u3066API\u3092\u5b9f\u884c\n- API\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u6642\u306b`onLogoutSuccess`\u95a2\u6570\u5b9f\u884c\u3001\u30ed\u30b0\u30a4\u30f3\u753b\u9762\u306b\u9077\u79fb\n\n\n\n### \u5b9f\u88c5\n\n\u3067\u306f\u3001\u5b9f\u969b\u306b\u4fee\u6b63\u3057\u3066\u753b\u9762\u306e\u52d5\u4f5c\u78ba\u8a8d\u3092\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\n- :white_check_mark: `app/View/Layouts/default.ctp`\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n- :white_check_mark: `app/webroot/js/main.js`\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n- :white_check_mark: `app/webroot/js/app.js`\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n- :white_check_mark: `app/webroot/js/routers/router.js`\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n- :white_check_mark: `app/webroot/js/routers/controller.js`\u3092\u4e0a\u8a18\u306e\u901a\u308a\u4fee\u6b63\u3002\n- :white_check_mark: `app/webroot/js/models/user-model.js`\u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n- :white_check_mark: `app/webroot/js/views/login-layout-view.js`\u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n- :white_check_mark: `app/webroot/js/views/header-view.js`\u3092\u4e0a\u8a18\u306e\u901a\u308a\u65b0\u898f\u4f5c\u6210\u3002\n- :white_check_mark: \u52d5\u4f5c\u78ba\u8a8d!\n- :white_check_mark: Git\u306b\u30b3\u30df\u30c3\u30c8\n\n**GitHub\u3067\u306ediff\u8868\u793a\u3078\u306e\u30ea\u30f3\u30af**\n\n[\u7b2c5\u56de Lesson2 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u30b5\u30a4\u30c9 \u00b7 suzukishouten-study/rest-study@d4ae8a4](https://github.com/suzukishouten-study/rest-study/commit/d4ae8a42ca598eb37fe84e4af34f17017da9be30)\n\n\u4ee5\u4e0a\u3067\u3059\uff01\n\n## \u6b21\u56de\u4e88\u544a\n\n\u6b21\u56de\u30c6\u30fc\u30de\u306f\u3001[CakePHP\u3067\u30c7\u30fc\u30bf\u64cd\u4f5c\u301c\u62c5\u5f53\u8005\u30a2\u30b5\u30a4\u30f3\u6a5f\u80fd\u306e\u5b9f\u88c5](http://aws-rest-todo.connpass.com/event/12734/)\u3067\u3059\u3002\n\u4eca\u56de\u3067\u30e6\u30fc\u30b6\u304c\u8b58\u5225\u3067\u304d\u308b\u3088\u3046\u306b\u6210\u3063\u305f\u306e\u3067\u3001\u5404\u30e6\u30fc\u30b6\u306bTODO\u3092\u30a2\u30b5\u30a4\u30f3\u3059\u308b\u6a5f\u80fd\u306a\u3069\u3092\u3064\u3051\u3066\u3044\u304d\u307e\u3059\u3002\n\u307e\u305f\u305c\u3072\u3054\u53c2\u52a0\u304f\u3060\u3055\u3044\uff01\n\n## \u30b3\u30e1\u30f3\u30c8/\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af\u304a\u5f85\u3061\u3057\u3066\u304a\u308a\u307e\u3059\u3002\n\n\u53c2\u52a0\u8005\u306e\u65b9\u3082\u3001\u305d\u3046\u3067\u306a\u3044\u65b9\u3082\u304a\u6c17\u3065\u304d\u306e\u70b9\u304c\u3042\u308c\u3070\u304a\u9858\u3044\u81f4\u3057\u307e\u3059\u3002\n\n\n\n\n\n\n\n"}