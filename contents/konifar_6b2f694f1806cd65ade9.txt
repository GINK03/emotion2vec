{"tags": ["Retrofit", "Android"], "context": " More than 1 year has passed since last update.\n\n\u3084\u308a\u305f\u3044\u3053\u3068\nRetrofit\u3067\u306f\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9200\u306e\u5834\u5408\u306fsuccess\u306b\u306a\u308a\u307e\u3059\u304c\u3001404\u3084422\u3001500\u306e\u5834\u5408\u306ffailure\u306b\u306a\u308a\u307e\u3059\u3002\nApi.getUser(id, new Callback<User>() {\n    @Override\n    public void success(User user, Response response) {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9200\u306e\u5834\u5408\u306f\u3053\u3053\n    }\n\n    @Override\n    public void failure(RetrofitError error) {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9404\u3001422\u3001500\u306a\u3069\u306e\u30a8\u30e9\u30fc\u306e\u5834\u5408\u306f\u3053\u3053\n    }\n});\n\n\u305f\u3060\u3001\u30b5\u30fc\u30d0\u30fc\u5074\u3067\u30a8\u30e9\u30fc\u306e\u6642\u306b\u7279\u5b9a\u306e\u30a8\u30e9\u30fc\u30b3\u30fc\u30c9\u3084\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u3066\u305d\u308c\u3092Android\u5074\u3067\u6271\u3044\u305f\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\u4f8b\u3048\u3070\u3001GitHub\u306eAPI\u3067422\u3092\u8fd4\u3059\u6642\u3001\u30a8\u30e9\u30fc\u306e\u5185\u5bb9\u304cjson\u3067\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\u3053\u308c\u3092\u6271\u3044\u305f\u3044\u5834\u5408\u306e\u3084\u308a\u65b9\u3067\u3059\u3002\nHTTP/1.1 422 Unprocessable Entity\nContent-Length: 149\n\n{\n  \"message\": \"Validation Failed\",\n  \"errors\": [\n    {\n      \"resource\": \"Issue\",\n      \"field\": \"title\",\n      \"code\": \"missing_field\"\n    }\n  ]\n}\n\n\ngetBodyAs()\u3092\u4f7f\u3046\n\u7d50\u8ad6\u304b\u3089\u8a00\u3046\u3068\u3001 retrofitError.getBodyAs() \u3092\u4f7f\u3044\u307e\u3059\u3002\nApi.getUser(id, new Callback<User>() {\n    @Override\n    public void success(User user, Response response) {\n        // \u7565\n    }\n\n    @Override\n    public void failure(RetrofitError error) {\n        // ErrorMessage\u30e2\u30c7\u30eb\u306b\u30d1\u30fc\u30b9\u3059\u308b\n        ErrorMessage errorMessage = (ErrorMessage) error.getBodyAs(ErrorMessage.class);\n    }\n});\n\nRetrofitError\u30af\u30e9\u30b9\u306e\u4e2d\u3092\u307f\u3066\u307f\u308b\u3068\u3001Converter\u3092\u4f7f\u3063\u3066\u30ea\u30d5\u30ec\u30af\u30b7\u30e7\u30f3\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306fRetrofit\u306e\u901a\u5e38\u306e\u30d1\u30fc\u30b9\u306e\u3084\u308a\u65b9\u3068\u540c\u3058\u3067\u3059\u306d\u3002\n\nRetrofitError.java\npublic Object getBodyAs(Type type) {\n  if (response == null) {\n    return null;\n  }\n  TypedInput body = response.getBody();\n  if (body == null) {\n    return null;\n  }\n  try {\n    return converter.fromBody(body, type);\n  } catch (ConversionException e) {\n    throw new RuntimeException(e);\n  }\n}\n\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n# \u3084\u308a\u305f\u3044\u3053\u3068\nRetrofit\u3067\u306f\u3001\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9200\u306e\u5834\u5408\u306fsuccess\u306b\u306a\u308a\u307e\u3059\u304c\u3001404\u3084422\u3001500\u306e\u5834\u5408\u306ffailure\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n```java\nApi.getUser(id, new Callback<User>() {\n    @Override\n    public void success(User user, Response response) {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9200\u306e\u5834\u5408\u306f\u3053\u3053\n    }\n\n    @Override\n    public void failure(RetrofitError error) {\n        // \u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9404\u3001422\u3001500\u306a\u3069\u306e\u30a8\u30e9\u30fc\u306e\u5834\u5408\u306f\u3053\u3053\n    }\n});\n```\n\n\u305f\u3060\u3001\u30b5\u30fc\u30d0\u30fc\u5074\u3067\u30a8\u30e9\u30fc\u306e\u6642\u306b\u7279\u5b9a\u306e\u30a8\u30e9\u30fc\u30b3\u30fc\u30c9\u3084\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u3066\u305d\u308c\u3092Android\u5074\u3067\u6271\u3044\u305f\u3044\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u4f8b\u3048\u3070\u3001GitHub\u306e[API](https://developer.github.com/v3/#client-errors)\u3067422\u3092\u8fd4\u3059\u6642\u3001\u30a8\u30e9\u30fc\u306e\u5185\u5bb9\u304cjson\u3067\u8fd4\u3063\u3066\u304d\u307e\u3059\u3002\u3053\u308c\u3092\u6271\u3044\u305f\u3044\u5834\u5408\u306e\u3084\u308a\u65b9\u3067\u3059\u3002\n\n```json\nHTTP/1.1 422 Unprocessable Entity\nContent-Length: 149\n\n{\n  \"message\": \"Validation Failed\",\n  \"errors\": [\n    {\n      \"resource\": \"Issue\",\n      \"field\": \"title\",\n      \"code\": \"missing_field\"\n    }\n  ]\n}\n```\n\n# getBodyAs()\u3092\u4f7f\u3046\n\n\u7d50\u8ad6\u304b\u3089\u8a00\u3046\u3068\u3001 `retrofitError.getBodyAs()` \u3092\u4f7f\u3044\u307e\u3059\u3002\n\n```java\nApi.getUser(id, new Callback<User>() {\n    @Override\n    public void success(User user, Response response) {\n        // \u7565\n    }\n\n    @Override\n    public void failure(RetrofitError error) {\n        // ErrorMessage\u30e2\u30c7\u30eb\u306b\u30d1\u30fc\u30b9\u3059\u308b\n        ErrorMessage errorMessage = (ErrorMessage) error.getBodyAs(ErrorMessage.class);\n    }\n});\n```\n\nRetrofitError\u30af\u30e9\u30b9\u306e\u4e2d\u3092\u307f\u3066\u307f\u308b\u3068\u3001Converter\u3092\u4f7f\u3063\u3066\u30ea\u30d5\u30ec\u30af\u30b7\u30e7\u30f3\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306fRetrofit\u306e\u901a\u5e38\u306e\u30d1\u30fc\u30b9\u306e\u3084\u308a\u65b9\u3068\u540c\u3058\u3067\u3059\u306d\u3002\n\n```RetrofitError.java\npublic Object getBodyAs(Type type) {\n  if (response == null) {\n    return null;\n  }\n  TypedInput body = response.getBody();\n  if (body == null) {\n    return null;\n  }\n  try {\n    return converter.fromBody(body, type);\n  } catch (ConversionException e) {\n    throw new RuntimeException(e);\n  }\n}\n```\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n"}