{"tags": ["VBA", "Haskell"], "context": " More than 1 year has passed since last update.\uff08\u3053\u306e\u8a18\u4e8b\u306f\u306f\u3066\u306a\u30d6\u30ed\u30b0\u3000http://mmyymmdd.hatenablog.com/ \u306e\u518d\u63b2\u3067\u3059\uff09\n2015-04-16\nVBAHaskell\u306bbind1st\u3068bind2nd\u3092\u8ffd\u52a0\u3057\u305f\u3002C++\u306e\u306b\u3042\u308b\u306e\u3068\u3060\u3044\u305f\u3044\u540c\u3058\u3060\u304c\u3001VBAHaskell\u306b\u304a\u3044\u3066\u306f\u95a2\u6570\u306f\u521d\u3081\u304b\u3089\u4f55\u3089\u304b\u306e\u5f62\u3067\u675f\u7e1b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u3042\u307e\u308a\u4f7f\u3046\u5834\u9762\u306f\u306a\u3044\u3068\u601d\u3046\u3002\u610f\u5473\u7684\u306b\u306f\u5f15\u6570\u306e\"\u518d\"\u675f\u7e1b\u306a\u306e\u3067 rebind \u3068\u540d\u4ed8\u3051\u308b\u3079\u304d\u306a\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u306b\u306a\u3063\u3066\u3044\u308b\u5834\u6240\u3092\u3042\u308b\u5024\u3067\u675f\u7e1b\u3059\u308b\u308f\u3051\u3060\u304c\u3001\u4f55\u304c1st\u3067\u4f55\u304c2nd\u304b\u304c\u81ea\u5206\u3067\u3082\u5c11\u3005\u308f\u304b\u308a\u306b\u304f\u3044\u306e\u3060\u3002\n\u3053\u308c\u3092\u8aac\u660e\u3059\u308b\u305f\u3081\u306b\u3001VBAHaskell\u306e\u7d39\u4ecb\u305d\u306e5\uff08\u95a2\u6570\u306e\u30b7\u30b0\u30cd\u30c1\u30e3\uff09\u3067\u5c11\u3057\u7d39\u4ecb\u3057\u305f\u300c\u95a2\u6570\u30dd\u30a4\u30f3\u30bf\u7684\u306a\u3082\u306e\u300d\u306b\u3064\u3044\u3066\u3082\u3063\u3068\u306f\u3063\u304d\u308a\u793a\u3057\u305f\u3044\u3002\nVBA\u95a2\u6570 func \u306b\u5bfe\u5fdc\u3059\u308b p_func 1  \u306e\u5b9f\u4f53\u306f\u6b21\u306e\u914d\u5217\u3060\u3002\np_func = Array ( AddressOf  func, _\n                 placeholder, _          ' \u7b2c1\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                 placeholder, _          ' \u7b2c2\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                 placeholder)            ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0\n\nAddressOf  func\u306fLong\u5024\u3068\u3057\u3066\u6271\u3063\u3066\u3044\u308b\u30022\u3000placeholder\u306f API \u3067\u4f5c\u3063\u3066\u3044\u308b\u7279\u6b8a\u306a\u5024\u3067\u3001\u4e00\u7a2e\u306e\u30de\u30b8\u30c3\u30af\u30ca\u30f3\u30d0\u30fc\u3068\u8003\u3048\u3066\u3088\u3044\u3002\u300c\u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0\u300d\u3068\u3057\u3066\u3082placeholder \u3092\u6d41\u7528\u3057\u3066\u3044\u308b\u304c\u3001\u3053\u308c\u306f\u624b\u629c\u304d\u306b\u904e\u304e\u306a\u3044\u3002\u5225\u306b\u4f55\u3067\u3082\u3088\u304b\u3063\u305f\u306e\u3060\u3002\n\u60f3\u50cf\u3067\u304d\u308b\u3088\u3046\u306b\u3001\u7b2c1\u5f15\u6570\u3082\u3057\u304f\u306f\u7b2c2\u5f15\u6570\u3092\u675f\u7e1b\u3057\u305f\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3002\np_func(3) = Array ( AddressOf func, _\n                    3, _               ' \u7b2c1\u5f15\u6570\u306f3\u306b\u675f\u7e1b\n                    placeholder, _     ' \u7b2c2\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                    placeholder)       ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0 \n\np_func (, 3) = Array ( AddressOf func, _\n                       placeholder, _    ' \u7b2c1\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                       3, _              ' \u7b2c2\u5f15\u6570\u306f3\u306b\u675f\u7e1b\n                       placeholder)      ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0\n\nbind1st\u3068bind2nd\u306f\u6b21\u306e\u3082\u306e\u306b\u306a\u308b\u30023\nbind1st(p_func(3), 100) = Array ( AddressOf func, _\n                                  3          , _  ' \u7b2c1\u5f15\u6570\u306f\u5909\u66f4\u306a\u3057\n                                  placeholder, _  ' \u7b2c2\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                                  placeholder)    ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0  \n\nbind2nd(p_func(3), 100) = Array ( AddressOf func, _\n                                3, _             ' \u7b2c1\u5f15\u6570\u306f\u5909\u66f4\u306a\u3057\n                                100, _           ' \u7b2c2\u5f15\u6570\u306f100\u306b\u675f\u7e1b\n                                placeholder)     ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0\n\n\u3084\u3084\u3053\u3057\u3044\u306e\u306f\u95a2\u6570\u304c\u30cd\u30b9\u30c8\u3055\u308c\u305f\u5408\u6210\u95a2\u6570\u306e\u5834\u5408\u3060\u3002\np_func(p_func, p_func(, 2)) =\n       Array ( AddressOf func, _\n               Array ( AddressOf func, placeholder, placeholder, placeholder), _\n               Array ( AddressOf func, placeholder, 2, placeholder), _\n              placeholder  )\n\n\u3053\u308c\u306b\u5bfe\u3057\u3066\u3001bind1st \u3084 bind2nd \u3092\u4f5c\u3063\u305f\u3089\u3053\u3046\u3044\u3046\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u3002\nbind1st(p_func(p_func, p_func(, 2)) , 3 ) =\n     p_func(p_func(3, 3), p_func(, 2)) =\n            Array ( AddressOf func, _\n              Array ( AddressOf func, 3, 3, placeholder), _\n              Array ( AddressOf func, placeholder, 2, placeholder), _\n              placeholder\n           )\n\nbind2nd(p_func(p_func, p_func(, 2)) , 3 ) =\n     p_func(p_func, p_func(3, 2)) =\n             Array ( AddressOf func, _\n               Array ( AddressOf func, placeholder, placeholder, placeholder), _\n               Array ( AddressOf func, 3, 2, placeholder), _\n               placeholder\n            )\n\nproduct_set\u95a2\u6570 4 \u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u3042\u3052\u308b\u306e\u306b\u3053\u308c\u3089\u3092\u4f7f\u3063\u305f\u3002\n# 2015/5/17 : \u95a2\u6570\u306e\u5185\u5bb9\u3092\u6587\u5b57\u5217\u5316\u3059\u308b\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u95a2\u6570 dumpFun \u3092 Haskell_3_printM\u30e2\u30b8\u30e5\u30fc\u30eb \u306b\u8ffd\u52a0\u3057\u305f\u3002\nVBAHaskell\u306e\u7d39\u4ecb\u3000\u305d\u306e8\u3000\uff08\u30bd\u30fc\u30c8\u95a2\u9023\uff09\nVBAHaskell\u306e\u7d39\u4ecb\u3000\u305d\u306e6\u3000\uff08foldl\uff09\nVBAHaskell\u306e\u7d39\u4ecb\u3000\u305d\u306e1\u3000\uff08\u6700\u521d\u306fmapF\uff09\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9 https://github.com/mYmd/VBA\n\n\n\n\n\u30d8\u30eb\u30d1\u95a2\u6570 make_funPointer \u3092\u4f7f\u3063\u3066\u4f5c\u308c\u308b\u00a0\u21a9\n\n\n32bit Office\u3060\u304b\u3089\u3002\u307e\u306064bit\u5bfe\u5fdc\u306f\u3067\u304d\u3066\u3044\u306a\u3044\u3002\u00a0\u21a9\n\n\n\u8a18\u8ff0\u306b\u8aa4\u308a\u304c\u3042\u3063\u305f\u306e\u3067\u8a02\u6b63\uff1a2015/5/17\u00a0\u21a9\n\n\nHaskell_4_vector\u30e2\u30b8\u30e5\u30fc\u30eb\u00a0\u21a9\n\n\n\n\uff08\u3053\u306e\u8a18\u4e8b\u306f\u306f\u3066\u306a\u30d6\u30ed\u30b0\u3000http://mmyymmdd.hatenablog.com/ \u306e\u518d\u63b2\u3067\u3059\uff09\n2015-04-16\n\nVBAHaskell\u306b**bind1st**\u3068**bind2nd**\u3092\u8ffd\u52a0\u3057\u305f\u3002C++\u306e<functional>\u306b\u3042\u308b\u306e\u3068\u3060\u3044\u305f\u3044\u540c\u3058\u3060\u304c\u3001VBAHaskell\u306b\u304a\u3044\u3066\u306f\u95a2\u6570\u306f\u521d\u3081\u304b\u3089\u4f55\u3089\u304b\u306e\u5f62\u3067\u675f\u7e1b\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u3042\u307e\u308a\u4f7f\u3046\u5834\u9762\u306f\u306a\u3044\u3068\u601d\u3046\u3002\u610f\u5473\u7684\u306b\u306f\u5f15\u6570\u306e\"\u518d\"\u675f\u7e1b\u306a\u306e\u3067 rebind \u3068\u540d\u4ed8\u3051\u308b\u3079\u304d\u306a\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u306b\u306a\u3063\u3066\u3044\u308b\u5834\u6240\u3092\u3042\u308b\u5024\u3067\u675f\u7e1b\u3059\u308b\u308f\u3051\u3060\u304c\u3001\u4f55\u304c1st\u3067\u4f55\u304c2nd\u304b\u304c\u81ea\u5206\u3067\u3082\u5c11\u3005\u308f\u304b\u308a\u306b\u304f\u3044\u306e\u3060\u3002\n\n\u3053\u308c\u3092\u8aac\u660e\u3059\u308b\u305f\u3081\u306b\u3001[VBAHaskell\u306e\u7d39\u4ecb\u305d\u306e5\uff08\u95a2\u6570\u306e\u30b7\u30b0\u30cd\u30c1\u30e3\uff09](http://qiita.com/mmYYmmdd/items/a89754da3717b7c1e40d)\u3067\u5c11\u3057\u7d39\u4ecb\u3057\u305f\u300c\u95a2\u6570\u30dd\u30a4\u30f3\u30bf\u7684\u306a\u3082\u306e\u300d\u306b\u3064\u3044\u3066\u3082\u3063\u3068\u306f\u3063\u304d\u308a\u793a\u3057\u305f\u3044\u3002\n\nVBA\u95a2\u6570 **func** \u306b\u5bfe\u5fdc\u3059\u308b **p_func**  [^1]  \u306e\u5b9f\u4f53\u306f\u6b21\u306e\u914d\u5217\u3060\u3002\n\n```vbnet\np_func = Array ( AddressOf  func, _\n                 placeholder, _          ' \u7b2c1\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                 placeholder, _          ' \u7b2c2\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                 placeholder)            ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0\n```\n**`AddressOf  func`**\u306fLong\u5024\u3068\u3057\u3066\u6271\u3063\u3066\u3044\u308b\u3002[^2]\u3000**placeholder**\u306f API \u3067\u4f5c\u3063\u3066\u3044\u308b\u7279\u6b8a\u306a\u5024\u3067\u3001\u4e00\u7a2e\u306e\u30de\u30b8\u30c3\u30af\u30ca\u30f3\u30d0\u30fc\u3068\u8003\u3048\u3066\u3088\u3044\u3002\u300c\u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0\u300d\u3068\u3057\u3066\u3082**placeholder** \u3092\u6d41\u7528\u3057\u3066\u3044\u308b\u304c\u3001\u3053\u308c\u306f\u624b\u629c\u304d\u306b\u904e\u304e\u306a\u3044\u3002\u5225\u306b\u4f55\u3067\u3082\u3088\u304b\u3063\u305f\u306e\u3060\u3002\n\n\u60f3\u50cf\u3067\u304d\u308b\u3088\u3046\u306b\u3001\u7b2c1\u5f15\u6570\u3082\u3057\u304f\u306f\u7b2c2\u5f15\u6570\u3092\u675f\u7e1b\u3057\u305f\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u3082\u306e\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```vbnet\np_func(3) = Array ( AddressOf func, _\n                    3, _               ' \u7b2c1\u5f15\u6570\u306f3\u306b\u675f\u7e1b\n                    placeholder, _     ' \u7b2c2\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                    placeholder)       ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0 \n\np_func (, 3) = Array ( AddressOf func, _\n                       placeholder, _    ' \u7b2c1\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                       3, _              ' \u7b2c2\u5f15\u6570\u306f3\u306b\u675f\u7e1b\n                       placeholder)      ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0\n```\nbind1st\u3068bind2nd\u306f\u6b21\u306e\u3082\u306e\u306b\u306a\u308b\u3002[^3]\n\n```vbnet\nbind1st(p_func(3), 100) = Array ( AddressOf func, _\n                                  3          , _  ' \u7b2c1\u5f15\u6570\u306f\u5909\u66f4\u306a\u3057\n                                  placeholder, _  ' \u7b2c2\u5f15\u6570\u306e\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\n                                  placeholder)    ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0  \n\nbind2nd(p_func(3), 100) = Array ( AddressOf func, _\n                                3, _             ' \u7b2c1\u5f15\u6570\u306f\u5909\u66f4\u306a\u3057\n                                100, _           ' \u7b2c2\u5f15\u6570\u306f100\u306b\u675f\u7e1b\n                                placeholder)     ' \u95a2\u6570\u3067\u3042\u308b\u30d5\u30e9\u30b0\n```\n\u3084\u3084\u3053\u3057\u3044\u306e\u306f\u95a2\u6570\u304c\u30cd\u30b9\u30c8\u3055\u308c\u305f\u5408\u6210\u95a2\u6570\u306e\u5834\u5408\u3060\u3002\n\n```vbnet\np_func(p_func, p_func(, 2)) =\n       Array ( AddressOf func, _\n               Array ( AddressOf func, placeholder, placeholder, placeholder), _\n               Array ( AddressOf func, placeholder, 2, placeholder), _\n              placeholder  )\n```\n\u3053\u308c\u306b\u5bfe\u3057\u3066\u3001bind1st \u3084 bind2nd \u3092\u4f5c\u3063\u305f\u3089\u3053\u3046\u3044\u3046\u72b6\u614b\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```vbnet\nbind1st(p_func(p_func, p_func(, 2)) , 3 ) =\n     p_func(p_func(3, 3), p_func(, 2)) =\n            Array ( AddressOf func, _\n              Array ( AddressOf func, 3, 3, placeholder), _\n              Array ( AddressOf func, placeholder, 2, placeholder), _\n              placeholder\n           )\n\nbind2nd(p_func(p_func, p_func(, 2)) , 3 ) =\n     p_func(p_func, p_func(3, 2)) =\n             Array ( AddressOf func, _\n               Array ( AddressOf func, placeholder, placeholder, placeholder), _\n               Array ( AddressOf func, 3, 2, placeholder), _\n               placeholder\n            )\n```\n product_set\u95a2\u6570 [^4] \u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u3042\u3052\u308b\u306e\u306b\u3053\u308c\u3089\u3092\u4f7f\u3063\u305f\u3002\n\n\\# 2015/5/17 : \u95a2\u6570\u306e\u5185\u5bb9\u3092\u6587\u5b57\u5217\u5316\u3059\u308b\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u95a2\u6570 dumpFun \u3092 [Haskell_3_printM\u30e2\u30b8\u30e5\u30fc\u30eb](https://github.com/mYmd/VBA/blob/master/Haskell_3_printM.bas) \u306b\u8ffd\u52a0\u3057\u305f\u3002\n\n[VBAHaskell\u306e\u7d39\u4ecb\u3000\u305d\u306e8\u3000\uff08\u30bd\u30fc\u30c8\u95a2\u9023\uff09](http://qiita.com/mmYYmmdd/items/dd047d6af8e486465840)\n[VBAHaskell\u306e\u7d39\u4ecb\u3000\u305d\u306e6\u3000\uff08foldl\uff09](http://qiita.com/mmYYmmdd/items/e0269141f637f80258d8)\n[VBAHaskell\u306e\u7d39\u4ecb\u3000\u305d\u306e1\u3000\uff08\u6700\u521d\u306fmapF\uff09](http://qiita.com/mmYYmmdd/items/c731edf943acc0a0ebe9)\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9 https://github.com/mYmd/VBA\n\n[^1]: \u30d8\u30eb\u30d1\u95a2\u6570[ make_funPointer ](https://github.com/mYmd/VBA/blob/master/Haskell_1_Core.bas)\u3092\u4f7f\u3063\u3066\u4f5c\u308c\u308b\n[^2]: 32bit Office\u3060\u304b\u3089\u3002\u307e\u306064bit\u5bfe\u5fdc\u306f\u3067\u304d\u3066\u3044\u306a\u3044\u3002\n[^3]: \u8a18\u8ff0\u306b\u8aa4\u308a\u304c\u3042\u3063\u305f\u306e\u3067\u8a02\u6b63\uff1a2015/5/17\n[^4]: [Haskell_4_vector\u30e2\u30b8\u30e5\u30fc\u30eb](https://github.com/mYmd/VBA/blob/master/Haskell_4_vector.bas)\n"}