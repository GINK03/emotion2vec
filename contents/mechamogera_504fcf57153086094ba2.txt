{"tags": ["ROS", "Lego"], "context": " More than 1 year has passed since last update.ROS\u521d\u5fc3\u8005\u304c\u52c9\u5f37\u306e\u305f\u3081LEGO Mindstorms EV3/NXT\u306eROS indigo\u5bfe\u5fdc\u3092\u53c2\u8003\u306b\u3057\u3066\u3001\u30ec\u30b4\u30de\u30a4\u30f3\u30c9\u30b9\u30c8\u30fc\u30e0EV3\u3092ROS\u3067\u52d5\u304b\u3057\u3066\u307f\u305f\u306e\u3067\u624b\u9806\u3092\u30e1\u30e2\u3057\u3066\u304a\u304f\u3002\n\n\u4e8b\u524d\u306b\u6e96\u5099\u3057\u305f\u3053\u3068\n\n\nVirtualBox\u3067ROS\u3092\u52d5\u304b\u3057\u3066\u307f\u308b - Qiita\u306e\u624b\u9806\u3067VM\u4e0a\u306bubuntu 14.04+ROS indigo\u74b0\u5883\u3092\u69cb\u7bc9\n\u30ef\u30fc\u30af\u30b9\u30da\u30fc\u30b9\u3092~/catkin_ws/src\u306b\u4f5c\u6210\n\n$ mkdir -p ~/catkin_ws/src\n$ cd ~/catkin_ws/src\n$ catkin_init_workspace\n$ cd ~/catkin_ws\n$ catkin_make\n$ vi ~/.bashrc # setup.bash\u306e\u8aad\u307f\u8fbc\u307f\u5148\u3092~/catkin_ws/devel/setup.bash\u306b\u5909\u66f4\u3059\u308b\n$ tail -1 ~/.bashrc\nsource /opt/ros/indigo/setup.bash\n\n\nEV3\u306bev3dev\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\nEV3\u5074\u74b0\u5883\u69cb\u7bc9\npython-ev3\u306eInstall the python-ev3 on EV3\u306e\u3084\u308a\u65b9\u306b\u305d\u3063\u3066\u9032\u3081\u308b\u3002\n# \u73fe\u5728\u306e\u65e5\u6642\u78ba\u8a8d\n$ date\n# \u65e5\u6642\u304c\u305a\u308c\u3066\u3044\u305f\u3089\u4ee5\u4e0b\u306e\u4f8b\u306e\u3088\u3046\u306b\u4fee\u6b63(\u3053\u308c\u3092\u3057\u3066\u304a\u304b\u306a\u3044\u3068easy_install\u3067SSL: CERTIFICATE_VERIFY_FAILE\u3067\u30a8\u30e9\u30fc\u3068\u306a\u308b)\ndate -s \"2015/10/27 12:00:00\"\n\n$ apt-get update\n$ apt-get install virtualenv  virtualenvwrapper python-setuptools python-smbus python-pil\n$ source /etc/bash_completion.d/virtualenvwrapper\n\n$ mkvirtualenv ev3_py27 --python=/usr/bin/python2.7 --system-site-packages\n$ workon ev3_py27\n$ easy_install python-ev3\n$ easy_install rpyc\n\n\nEV3\u5074\u30bb\u30f3\u30b5\u78ba\u8a8d\n\n\u7c21\u5358\u306b\u8a66\u3059\u305f\u3081\u771f\u9762\u76ee\u306b\u7d44\u307e\u305a\u306b\u30e2\u30fc\u30bf\u30fc2\u500b\u3068\u30b8\u30e3\u30a4\u30ed\u30bb\u30f3\u30b5\u3068US(UltraSonic)\u30bb\u30f3\u30b5\u3060\u3051\u3092EV3\u306b\u63a5\u7d9a\n\u30bb\u30f3\u30b5\u306e\u30dd\u30fc\u30c8\u78ba\u8a8d\n\n$ for f in /sys/class/lego-sensor/sensor*; do echo -n \"$f: \"; cat $f/driver_name;  done\n/sys/class/lego-sensor/sensor0: lego-ev3-touch\n/sys/class/lego-sensor/sensor1: lego-ev3-gyro\n/sys/class/lego-sensor/sensor2: lego-ev3-color\n/sys/class/lego-sensor/sensor4: lego-ev3-us\n# \u3053\u308c\u3060\u3068 0:\u30bf\u30c3\u30c1\u30bb\u30f3\u30b5\u30011:\u30b8\u30e3\u30a4\u30ed\u30bb\u30f3\u30b5\u30012:\u30ab\u30e9\u30fc\u30bb\u30f3\u30b5\u30013:US\u30bb\u30f3\u30b5\n\n$ workon ev3_py27\n$ python\n>>> from ev3.lego import LegoSensor\n>>> LegoSensor(0).mode\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/root/.virtualenvs/ev3_py27/local/lib/python2.7/site-packages/python_ev3-0.0.3.0-py2.7.egg/ev3/ev3dev.py\", line 251, in __init__\nev3.ev3dev.NoSuchSensorError: No such sensor port=0 name=None\n>>> LegoSensor(1).mode\n'TOUCH'\n>>> LegoSensor(2).mode\n'COL-REFLECT'\n>>> LegoSensor(3).mode\n'GYRO-ANG'\n>>> LegoSensor(4).mode\n'US-DIST-CM'\n# \u3053\u308c\u3067\u78ba\u8a8d\u3059\u308b\u30681:\u30bf\u30c3\u30c1\u30bb\u30f3\u30b5\u30012:\u30ab\u30e9\u30fc\u30bb\u30f3\u30b5\u30013:\u30b8\u30e3\u30a4\u30ed\u30bb\u30f3\u30b5\u30014:US\u30bb\u30f3\u30b5\n# /sys/class/lego-sensor/sensorX\u306e\u756a\u53f7\u306b\u5bfe\u5fdc\u3059\u308b\u304b\u3068\u601d\u3063\u305f\u304c\u3001python-ev3\u4e0a\u3067\u306f\u3053\u306e\u30dd\u30fc\u30c8\u756a\u53f7\u6271\u3044\u306b\u306a\u308b\u3089\u3057\u3044\n>>> exit()\n\n\nEV3\u5074\u3067rpyc_classic.py\u52d5\u4f5c\n$ rpyc_classic.py\n\n\nVM\u5074\u3067mindstorms_ros\u74b0\u5883\u69cb\u7bc9\n\n\u6700\u521d\u306fnavigation\u3084joy\u306fgithub\u304b\u3089clone\u3057\u3066\u914d\u7f6e\u3057\u3066\u305f\u304c\u554f\u984c\u304c\u767a\u751f\u3057\u305f\u308a\u3057\u305f\u305f\u3081apt-get\u3067\u5165\u308c\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n$ sudo easy_install python-ev3\n$ sudo easy_install rpyc\n$ sudo easy_install nxt-python\n\n$ sudo apt-get install ros-indigo-navigation\n$ sudo apt-get install ros-indigo-joy\n\n$ git clone https://github.com/youtalk/mindstorms_ros.git\n$ cd mindstorms_ros\n$ cp -R nxt/* ~/catkin_ws/src\n$ cp -R nxt_apps/* ~/catkin_ws/src\n$ cp -R nxt_robots/* ~/catkin_ws/src\n$ cp -R ev3/* ~/catkin_ws/src\n$ cp -R ev3_robots/* ~/catkin_ws/src\n\n$ vi ~/catkin_ws/src/ev3_robot_gyro_car/robot.yaml\n# => \u30e2\u30fc\u30bf\u3001\u30bb\u30f3\u30b5\u30fc\u306e\u30dd\u30fc\u30c8\u306e\u8a2d\u5b9a\u3092\u6b63\u3057\u304f\u5bfe\u5fdc\u3055\u305b\u308b\n\n$ vi ~/catkin_ws/src/ev3_ros/scripts/ev3_ros.py\n# => Motor\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306bpulses_per_second\u304c\u306a\u3044\u3089\u3057\u3044\u306e\u3067\n#    js.velocity.append(math.radians(self.motor.pulses_per_second))\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066 js.velocity.append(1)\u306b\n\n$ cd ~/catkin_ws\n$ catkin_make\n\n\nVM\u5074\u3067gyro car\u52d5\u4f5c\n$ roscore\n\n# \u5225\u7aef\u672b\u3067\n\n$ roslaunch ev3_robot_gyro_car robot.launch host:=10.42.0.3\n\n# \u5225\u7aef\u672b\u3067\n\n$ roslaunch nxt_teleop teleop_keyboard.launch\n\n\nroslaunch nxt_teleop\u3001\u3001\u3001\u3057\u305f\u7aef\u672b\u3067\u30ad\u30fc\u30dc\u30fc\u30c9\u64cd\u4f5c\u3057\u3066\u307f\u308b\u3068\u53cd\u5fdc\u306f\u920d\u3044\u304c\u30e2\u30fc\u30bf\u30fc\u304c\u64cd\u4f5c\u306b\u9023\u52d5\u3057\u3066\u52d5\u4f5c\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n\ngyro car\u306b\u3064\u3044\u3066\u3044\u308d\u3044\u308d\u307f\u3066\u307f\u308b\n\nrqt_graph\n\n\n\nurdf\n\n\n# \u51fa\u3057\u65b9(http://wiki.ros.org/urdf\u53c2\u7167)\n$ sudo apt-get install liburdfdom-tools\n$ urdf_to_graphiz ~/catkin_ws/src/ev3_robot_gyro_car/robot.urdf\n\nROS\u521d\u5fc3\u8005\u304c\u52c9\u5f37\u306e\u305f\u3081[LEGO Mindstorms EV3/NXT\u306eROS indigo\u5bfe\u5fdc](http://www.slideshare.net/yutakakondo/lego-mindstorms-ev3ros)\u3092\u53c2\u8003\u306b\u3057\u3066\u3001\u30ec\u30b4\u30de\u30a4\u30f3\u30c9\u30b9\u30c8\u30fc\u30e0EV3\u3092ROS\u3067\u52d5\u304b\u3057\u3066\u307f\u305f\u306e\u3067\u624b\u9806\u3092\u30e1\u30e2\u3057\u3066\u304a\u304f\u3002\n\n# \u4e8b\u524d\u306b\u6e96\u5099\u3057\u305f\u3053\u3068\n\n* [VirtualBox\u3067ROS\u3092\u52d5\u304b\u3057\u3066\u307f\u308b - Qiita](http://qiita.com/oh_rusty_nail/items/b19f474b0d88eecddc1e)\u306e\u624b\u9806\u3067VM\u4e0a\u306bubuntu 14.04+ROS indigo\u74b0\u5883\u3092\u69cb\u7bc9\n* \u30ef\u30fc\u30af\u30b9\u30da\u30fc\u30b9\u3092~/catkin_ws/src\u306b\u4f5c\u6210\n\n```\n$ mkdir -p ~/catkin_ws/src\n$ cd ~/catkin_ws/src\n$ catkin_init_workspace\n$ cd ~/catkin_ws\n$ catkin_make\n$ vi ~/.bashrc # setup.bash\u306e\u8aad\u307f\u8fbc\u307f\u5148\u3092~/catkin_ws/devel/setup.bash\u306b\u5909\u66f4\u3059\u308b\n$ tail -1 ~/.bashrc\nsource /opt/ros/indigo/setup.bash\n```\n* EV3\u306bev3dev\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n# EV3\u5074\u74b0\u5883\u69cb\u7bc9\n\n[python-ev3\u306eInstall the python-ev3 on EV3](https://github.com/topikachu/python-ev3)\u306e\u3084\u308a\u65b9\u306b\u305d\u3063\u3066\u9032\u3081\u308b\u3002\n\n```bash\n# \u73fe\u5728\u306e\u65e5\u6642\u78ba\u8a8d\n$ date\n# \u65e5\u6642\u304c\u305a\u308c\u3066\u3044\u305f\u3089\u4ee5\u4e0b\u306e\u4f8b\u306e\u3088\u3046\u306b\u4fee\u6b63(\u3053\u308c\u3092\u3057\u3066\u304a\u304b\u306a\u3044\u3068easy_install\u3067SSL: CERTIFICATE_VERIFY_FAILE\u3067\u30a8\u30e9\u30fc\u3068\u306a\u308b)\ndate -s \"2015/10/27 12:00:00\"\n\n$ apt-get update\n$ apt-get install virtualenv  virtualenvwrapper python-setuptools python-smbus python-pil\n$ source /etc/bash_completion.d/virtualenvwrapper\n \n$ mkvirtualenv ev3_py27 --python=/usr/bin/python2.7 --system-site-packages\n$ workon ev3_py27\n$ easy_install python-ev3\n$ easy_install rpyc\n```\n\n# EV3\u5074\u30bb\u30f3\u30b5\u78ba\u8a8d\n\n* \u7c21\u5358\u306b\u8a66\u3059\u305f\u3081\u771f\u9762\u76ee\u306b\u7d44\u307e\u305a\u306b\u30e2\u30fc\u30bf\u30fc2\u500b\u3068\u30b8\u30e3\u30a4\u30ed\u30bb\u30f3\u30b5\u3068US(UltraSonic)\u30bb\u30f3\u30b5\u3060\u3051\u3092EV3\u306b\u63a5\u7d9a\n* \u30bb\u30f3\u30b5\u306e\u30dd\u30fc\u30c8\u78ba\u8a8d\n\n```bash\n$ for f in /sys/class/lego-sensor/sensor*; do echo -n \"$f: \"; cat $f/driver_name;  done\n/sys/class/lego-sensor/sensor0: lego-ev3-touch\n/sys/class/lego-sensor/sensor1: lego-ev3-gyro\n/sys/class/lego-sensor/sensor2: lego-ev3-color\n/sys/class/lego-sensor/sensor4: lego-ev3-us\n# \u3053\u308c\u3060\u3068 0:\u30bf\u30c3\u30c1\u30bb\u30f3\u30b5\u30011:\u30b8\u30e3\u30a4\u30ed\u30bb\u30f3\u30b5\u30012:\u30ab\u30e9\u30fc\u30bb\u30f3\u30b5\u30013:US\u30bb\u30f3\u30b5\n \n$ workon ev3_py27\n$ python\n>>> from ev3.lego import LegoSensor\n>>> LegoSensor(0).mode\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/root/.virtualenvs/ev3_py27/local/lib/python2.7/site-packages/python_ev3-0.0.3.0-py2.7.egg/ev3/ev3dev.py\", line 251, in __init__\nev3.ev3dev.NoSuchSensorError: No such sensor port=0 name=None\n>>> LegoSensor(1).mode\n'TOUCH'\n>>> LegoSensor(2).mode\n'COL-REFLECT'\n>>> LegoSensor(3).mode\n'GYRO-ANG'\n>>> LegoSensor(4).mode\n'US-DIST-CM'\n# \u3053\u308c\u3067\u78ba\u8a8d\u3059\u308b\u30681:\u30bf\u30c3\u30c1\u30bb\u30f3\u30b5\u30012:\u30ab\u30e9\u30fc\u30bb\u30f3\u30b5\u30013:\u30b8\u30e3\u30a4\u30ed\u30bb\u30f3\u30b5\u30014:US\u30bb\u30f3\u30b5\n# /sys/class/lego-sensor/sensorX\u306e\u756a\u53f7\u306b\u5bfe\u5fdc\u3059\u308b\u304b\u3068\u601d\u3063\u305f\u304c\u3001python-ev3\u4e0a\u3067\u306f\u3053\u306e\u30dd\u30fc\u30c8\u756a\u53f7\u6271\u3044\u306b\u306a\u308b\u3089\u3057\u3044\n>>> exit()\n```\n\n# EV3\u5074\u3067rpyc_classic.py\u52d5\u4f5c\n\n```bash\n$ rpyc_classic.py\n```\n\n# VM\u5074\u3067mindstorms_ros\u74b0\u5883\u69cb\u7bc9\n\n* \u6700\u521d\u306fnavigation\u3084joy\u306fgithub\u304b\u3089clone\u3057\u3066\u914d\u7f6e\u3057\u3066\u305f\u304c[\u554f\u984c](http://answers.ros.org/question/201630/orocos-bfl-not-found-while-installing-navigation-stack-ros-indigo-ubuntu-1404/)\u304c\u767a\u751f\u3057\u305f\u308a\u3057\u305f\u305f\u3081apt-get\u3067\u5165\u308c\u308b\u3088\u3046\u306b\u3057\u305f\u3002\n\n```bash\n$ sudo easy_install python-ev3\n$ sudo easy_install rpyc\n$ sudo easy_install nxt-python\n \n$ sudo apt-get install ros-indigo-navigation\n$ sudo apt-get install ros-indigo-joy\n \n$ git clone https://github.com/youtalk/mindstorms_ros.git\n$ cd mindstorms_ros\n$ cp -R nxt/* ~/catkin_ws/src\n$ cp -R nxt_apps/* ~/catkin_ws/src\n$ cp -R nxt_robots/* ~/catkin_ws/src\n$ cp -R ev3/* ~/catkin_ws/src\n$ cp -R ev3_robots/* ~/catkin_ws/src\n \n$ vi ~/catkin_ws/src/ev3_robot_gyro_car/robot.yaml\n# => \u30e2\u30fc\u30bf\u3001\u30bb\u30f3\u30b5\u30fc\u306e\u30dd\u30fc\u30c8\u306e\u8a2d\u5b9a\u3092\u6b63\u3057\u304f\u5bfe\u5fdc\u3055\u305b\u308b\n \n$ vi ~/catkin_ws/src/ev3_ros/scripts/ev3_ros.py\n# => Motor\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306bpulses_per_second\u304c\u306a\u3044\u3089\u3057\u3044\u306e\u3067\n#    js.velocity.append(math.radians(self.motor.pulses_per_second))\u3092\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3057\u3066 js.velocity.append(1)\u306b\n \n$ cd ~/catkin_ws\n$ catkin_make\n```\n\n# VM\u5074\u3067gyro car\u52d5\u4f5c\n\n```bash\n$ roscore\n \n# \u5225\u7aef\u672b\u3067\n \n$ roslaunch ev3_robot_gyro_car robot.launch host:=10.42.0.3\n \n# \u5225\u7aef\u672b\u3067\n \n$ roslaunch nxt_teleop teleop_keyboard.launch\n```\n\n* roslaunch nxt_teleop\u3001\u3001\u3001\u3057\u305f\u7aef\u672b\u3067\u30ad\u30fc\u30dc\u30fc\u30c9\u64cd\u4f5c\u3057\u3066\u307f\u308b\u3068\u53cd\u5fdc\u306f\u920d\u3044\u304c\u30e2\u30fc\u30bf\u30fc\u304c\u64cd\u4f5c\u306b\u9023\u52d5\u3057\u3066\u52d5\u4f5c\u3059\u308b\u3053\u3068\u3092\u78ba\u8a8d\n\n# gyro car\u306b\u3064\u3044\u3066\u3044\u308d\u3044\u308d\u307f\u3066\u307f\u308b\n\n* rqt_graph\n\n![gyro_car.png](https://qiita-image-store.s3.amazonaws.com/0/16768/473cda1b-c691-bc64-9fc7-f8a1dfb9c1a9.png)\n\n* urdf\n\n![gyro_car_urdf.png](https://qiita-image-store.s3.amazonaws.com/0/16768/204f1c06-ef54-2196-1070-1bae22088a65.png)\n\n```bash\n# \u51fa\u3057\u65b9(http://wiki.ros.org/urdf\u53c2\u7167)\n$ sudo apt-get install liburdfdom-tools\n$ urdf_to_graphiz ~/catkin_ws/src/ev3_robot_gyro_car/robot.urdf\n```\n\n"}