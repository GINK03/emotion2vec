{"context": " More than 1 year has passed since last update.\n\nRuby \u3067 QR \u30b3\u30fc\u30c9\u3092\u751f\u6210\n\ngem \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n$ gem install rmagick\n$ gem install rqrcode_png\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nQR\u30b3\u30fc\u30c9\u306b\u300choge\u300d\u3068\u3044\u3046\u60c5\u5831\u3092\u57cb\u3081\u8fbc\u307f\u3001\u751f\u6210\u3055\u308c\u305f QR \u30b3\u30fc\u30c9\u306e\u4e0b\u90e8\u306e\u4e2d\u5fc3\u306b\u300cid: hoge\u300d\u3092\u8868\u793a\u3057\u3066\u3001PNG\u30d5\u30a1\u30a4\u30eb\u3067\u4fdd\u5b58\u3057\u307e\u3059\u3002\n    require 'fileutils'\n    require 'RMagick'\n    require 'rqrcode'\n    require 'rqrcode_png'\n    require 'chunky_png'\n\n    text = 'hoge'\n    qrimage = \"tmp.png\"\n    width = 150\n    height = 150\n    qr = RQRCode::QRCode.new(text, :size => 10, :level => :h)\n    qr.to_img.resize(width, height).save(qrimage) # tmp.png \u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4e00\u65e6 png \u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\n\n    image = Magick::Image.read(qrimage).first\n    # x \u306f 150 \u306e\u534a\u5206\u306e 75 \u3068\u3057\u3001y \u306f 150 \u3060\u3068\u4e0b\u306b\u8868\u793a\u304c\u304b\u3076\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u30012px \u4e0a\u3052\u3066\u304a\u304f\n    draw.annotate(image, 0, 0, width / 2, height - 2, \"id: #{text}\") do\n      self.fill = '#000000'\n      self.align = Magick::CenterAlign\n      self.stroke = 'transparent'\n      self.pointsize = 8\n      self.text_antialias = true\n      self.kerning = 1\n    end\n\n    image.write(\"qr.png\")\n    FileUtils.rm(qrimage, {:force => true}) # tmp \u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\n\n\nRails \u3067 QR \u30b3\u30fc\u30c9\u3092\u751f\u6210\n\ngem \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u4e0b\u8a18\u3092 Gemfile \u306b\u8ffd\u52a0\u3057\u3066\u3001bundle install \n\nGemfile\ngem 'rmagick', :require => 'RMagick'\ngem 'rqrcode_png'\n\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nQR\u30b3\u30fc\u30c9\u306b\u300choge\u300d\u3068\u3044\u3046\u60c5\u5831\u3092\u57cb\u3081\u8fbc\u307f\u3001\u751f\u6210\u3055\u308c\u305f QR \u30b3\u30fc\u30c9\u306e\u4e0b\u90e8\u306e\u4e2d\u5fc3\u306b\u300cid: hoge\u300d\u3092\u8868\u793a\u3059\u308b\n\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u4fdd\u5b58\u305b\u305a\u3001data_url \u306b\u5909\u63db\u3057\u3066 View \u3067\u8868\u793a\u3059\u308b  \n\nController\n    require 'chunky_png/rmagick' # Magick::Image\u3001ChunkyPNG::Image \u9593\u306e\u5909\u63db\u306b\u4f7f\u7528\n\n    text = 'hoge'\n    width = 150\n    height = 150\n\n    qr = RQRCode::QRCode.new(text, :size => 10, :level => :h)\n    # ChunkyPNG::Image \u3092 Magick::Image \u306b\u5909\u63db\n    image = ChunkyPNG::RMagick.export(qr.to_img.resize(width, height))\n\n    draw = Magick::Draw.new\n    draw.annotate(image, 0, 0, width / 2, height - 2, \"id: #{shop.id}\") do\n      self.fill = '#000000'\n      self.align = Magick::LeftAlign\n      self.stroke = 'transparent'\n      self.pointsize = 8\n      self.text_antialias = true\n      self.kerning = 1\n    end\n\n    # Magick::Image \u3092 ChunkyPNG::Image \u306b\u5909\u63db\u3057\u3066\u3001DetaUrl \u306b\n    @qrpng = ChunkyPNG::RMagick.import(image).to_data_url\n\n\nView ( haml )\n%img { src: \"#{qrpng}\" }\n\n\n\u53c2\u8003URL\nhttp://dharry.hatenablog.com/entry/2013/09/08/164335\nhttp://qiita.com/ryosy383/items/c753103c93fa177e4466\n# Ruby \u3067 QR \u30b3\u30fc\u30c9\u3092\u751f\u6210\n\n## gem \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb  \n\n```\n$ gem install rmagick\n$ gem install rqrcode_png\n```\n\n## \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nQR\u30b3\u30fc\u30c9\u306b\u300choge\u300d\u3068\u3044\u3046\u60c5\u5831\u3092\u57cb\u3081\u8fbc\u307f\u3001\u751f\u6210\u3055\u308c\u305f QR \u30b3\u30fc\u30c9\u306e\u4e0b\u90e8\u306e\u4e2d\u5fc3\u306b\u300cid: hoge\u300d\u3092\u8868\u793a\u3057\u3066\u3001PNG\u30d5\u30a1\u30a4\u30eb\u3067\u4fdd\u5b58\u3057\u307e\u3059\u3002\n\n```ruby\n    require 'fileutils'\n    require 'RMagick'\n    require 'rqrcode'\n    require 'rqrcode_png'\n    require 'chunky_png'\n\n    text = 'hoge'\n    qrimage = \"tmp.png\"\n    width = 150\n    height = 150\n    qr = RQRCode::QRCode.new(text, :size => 10, :level => :h)\n    qr.to_img.resize(width, height).save(qrimage) # tmp.png \u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4e00\u65e6 png \u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\n\n    image = Magick::Image.read(qrimage).first\n    # x \u306f 150 \u306e\u534a\u5206\u306e 75 \u3068\u3057\u3001y \u306f 150 \u3060\u3068\u4e0b\u306b\u8868\u793a\u304c\u304b\u3076\u3063\u3066\u3057\u307e\u3046\u306e\u3067\u30012px \u4e0a\u3052\u3066\u304a\u304f\n    draw.annotate(image, 0, 0, width / 2, height - 2, \"id: #{text}\") do\n      self.fill = '#000000'\n      self.align = Magick::CenterAlign\n      self.stroke = 'transparent'\n      self.pointsize = 8\n      self.text_antialias = true\n      self.kerning = 1\n    end\n    \n    image.write(\"qr.png\")\n    FileUtils.rm(qrimage, {:force => true}) # tmp \u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\n```\n\n# Rails \u3067 QR \u30b3\u30fc\u30c9\u3092\u751f\u6210\n\n## gem \u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb  \n\u4e0b\u8a18\u3092 Gemfile \u306b\u8ffd\u52a0\u3057\u3066\u3001`bundle install`  \n\n```ruby:Gemfile\ngem 'rmagick', :require => 'RMagick'\ngem 'rqrcode_png'\n```\n\n## \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\nQR\u30b3\u30fc\u30c9\u306b\u300choge\u300d\u3068\u3044\u3046\u60c5\u5831\u3092\u57cb\u3081\u8fbc\u307f\u3001\u751f\u6210\u3055\u308c\u305f QR \u30b3\u30fc\u30c9\u306e\u4e0b\u90e8\u306e\u4e2d\u5fc3\u306b\u300cid: hoge\u300d\u3092\u8868\u793a\u3059\u308b  \n\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u4fdd\u5b58\u305b\u305a\u3001data_url \u306b\u5909\u63db\u3057\u3066 View \u3067\u8868\u793a\u3059\u308b  \n\n### Controller\n```ruby\n    require 'chunky_png/rmagick' # Magick::Image\u3001ChunkyPNG::Image \u9593\u306e\u5909\u63db\u306b\u4f7f\u7528\n\n    text = 'hoge'\n    width = 150\n    height = 150\n\n    qr = RQRCode::QRCode.new(text, :size => 10, :level => :h)\n    # ChunkyPNG::Image \u3092 Magick::Image \u306b\u5909\u63db\n    image = ChunkyPNG::RMagick.export(qr.to_img.resize(width, height))\n    \n    draw = Magick::Draw.new\n    draw.annotate(image, 0, 0, width / 2, height - 2, \"id: #{shop.id}\") do\n      self.fill = '#000000'\n      self.align = Magick::LeftAlign\n      self.stroke = 'transparent'\n      self.pointsize = 8\n      self.text_antialias = true\n      self.kerning = 1\n    end\n    \n    # Magick::Image \u3092 ChunkyPNG::Image \u306b\u5909\u63db\u3057\u3066\u3001DetaUrl \u306b\n    @qrpng = ChunkyPNG::RMagick.import(image).to_data_url\n```\n\n### View ( haml )\n```haml\n%img { src: \"#{qrpng}\" }\n```\n\n# \u53c2\u8003URL\n\nhttp://dharry.hatenablog.com/entry/2013/09/08/164335\nhttp://qiita.com/ryosy383/items/c753103c93fa177e4466\n", "tags": ["Ruby", "Rails", "QRcode", "QR\u30b3\u30fc\u30c9"]}