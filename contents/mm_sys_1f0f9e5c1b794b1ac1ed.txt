{"context": " More than 1 year has passed since last update.CSV\u3092TStringList\u3067\u8aad\u307f\u8fbc\u3093\u3067\u30011\u884c\u305a\u3064\u5225\u306eTStringList\u3067\u8aad\u307f\u8fbc\u3080\u3002\n\nFireMonkey.h\n///std::unique_ptr\u7528(C++11\u5bfe\u5fdc\u306e\u74b0\u5883\u7528)\n#include <memory>\n///\nvoid __fastcall FunctionReadCSV(const UnicodeString &var_file_name,\n    TStringGrid *var_string_grid);\n\n\n\nFireMonkey.cpp\nvoid __fastcall TForm1::FunctionReadCSV(const UnicodeString &var_file_name,\n    TStringGrid *var_string_grid) {\n    std::unique_ptr<TStringList>var_list(new TStringList); // csv\u8aad\u307f\u8fbc\u307f\u7528\n    std::unique_ptr<TStringList>var_temp(new TStringList); // var_list\u304b\u30891\u884c\u8aad\u307f\u8fbc\u307f\n    if (FileExists(var_file_name)) { // \u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\n        var_list->LoadFromFile(var_file_name); // \u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\n        var_string_grid->RowCount = var_list->Count; // \u884c\u6570\u3092\u8a2d\u5b9a\u3002\n        for (int i = 0; i < var_list->Count; i++) {\n            UnicodeString tmp_c = StringReplace(var_list->Strings[i], L\"\\\\,\",\n                L\"&comma;\", TReplaceFlags() << rfReplaceAll << rfIgnoreCase);\n            // \u6587\u5b57\u5217\u306b\u660e\u793a\u7684\u306a\u30ab\u30f3\u30de \\, \u304c\u6709\u308b\u3068\u304d\u306f\u4e00\u65e6\u5225\u306e\u6587\u5b57\u5217\u306b\u3057\u3066\u304a\u304f\u3002\n            var_temp->CommaText = tmp_c; // commaText\u3067\u533a\u5206\u3051\n            for (int i2 = 0; i2 < 4; i2++) { // \u5fc5\u8981\u306a\u5217\u6570\u306b\u5fdc\u3058\u30664\u306e\u90e8\u5206\u3092\u5909\u66f4\n                tmp_c = var_temp->Strings[i2];\n                tmp_c = StringReplace(tmp_c, L\"&comma;\", L\",\",\n                    TReplaceFlags() << rfReplaceAll << rfIgnoreCase);\n                // \u30ab\u30f3\u30de\u3092\u623b\u3059\u3002\u3053\u306e\u4f8b\u3067\u306f\u300c\\,\u300d\u3092\u300c,\u300d\u306b\u3057\u3066\u3044\u308b\u70b9\u306b\u6ce8\u610f\u3002\n                var_string_grid->Cells[i2][i] = tmp_c;\n            }\n        }\n    }\n}\n\n\n\u66f8\u304d\u51fa\u3057\u306f\u3053\u3061\u3089\nC++builder\u3067TStringGrid\u304b\u3089CSV\u3092\u66f8\u304d\u51fa\u3059\nCSV\u3092TStringList\u3067\u8aad\u307f\u8fbc\u3093\u3067\u30011\u884c\u305a\u3064\u5225\u306eTStringList\u3067\u8aad\u307f\u8fbc\u3080\u3002\n\n```cpp:FireMonkey.h\n///std::unique_ptr\u7528(C++11\u5bfe\u5fdc\u306e\u74b0\u5883\u7528)\n#include <memory>\n///\nvoid __fastcall FunctionReadCSV(const UnicodeString &var_file_name,\n\tTStringGrid *var_string_grid);\n```\n\n```cpp:FireMonkey.cpp\nvoid __fastcall TForm1::FunctionReadCSV(const UnicodeString &var_file_name,\n\tTStringGrid *var_string_grid) {\n\tstd::unique_ptr<TStringList>var_list(new TStringList); // csv\u8aad\u307f\u8fbc\u307f\u7528\n\tstd::unique_ptr<TStringList>var_temp(new TStringList); // var_list\u304b\u30891\u884c\u8aad\u307f\u8fbc\u307f\n\tif (FileExists(var_file_name)) { // \u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\n\t\tvar_list->LoadFromFile(var_file_name); // \u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\n\t\tvar_string_grid->RowCount = var_list->Count; // \u884c\u6570\u3092\u8a2d\u5b9a\u3002\n\t\tfor (int i = 0; i < var_list->Count; i++) {\n\t\t\tUnicodeString tmp_c = StringReplace(var_list->Strings[i], L\"\\\\,\",\n\t\t\t\tL\"&comma;\", TReplaceFlags() << rfReplaceAll << rfIgnoreCase);\n\t\t\t// \u6587\u5b57\u5217\u306b\u660e\u793a\u7684\u306a\u30ab\u30f3\u30de \\, \u304c\u6709\u308b\u3068\u304d\u306f\u4e00\u65e6\u5225\u306e\u6587\u5b57\u5217\u306b\u3057\u3066\u304a\u304f\u3002\n\t\t\tvar_temp->CommaText = tmp_c; // commaText\u3067\u533a\u5206\u3051\n\t\t\tfor (int i2 = 0; i2 < 4; i2++) { // \u5fc5\u8981\u306a\u5217\u6570\u306b\u5fdc\u3058\u30664\u306e\u90e8\u5206\u3092\u5909\u66f4\n\t\t\t\ttmp_c = var_temp->Strings[i2];\n\t\t\t\ttmp_c = StringReplace(tmp_c, L\"&comma;\", L\",\",\n\t\t\t\t\tTReplaceFlags() << rfReplaceAll << rfIgnoreCase);\n\t\t\t\t// \u30ab\u30f3\u30de\u3092\u623b\u3059\u3002\u3053\u306e\u4f8b\u3067\u306f\u300c\\,\u300d\u3092\u300c,\u300d\u306b\u3057\u3066\u3044\u308b\u70b9\u306b\u6ce8\u610f\u3002\n\t\t\t\tvar_string_grid->Cells[i2][i] = tmp_c;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n\u66f8\u304d\u51fa\u3057\u306f\u3053\u3061\u3089\n[C++builder\u3067TStringGrid\u304b\u3089CSV\u3092\u66f8\u304d\u51fa\u3059](http://qiita.com/mm_sys/items/fc4637bfb8123e739cd9)\n", "tags": ["CSV", "C++11", "cppBuilderXE8"]}