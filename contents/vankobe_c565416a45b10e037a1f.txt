{"context": " More than 1 year has passed since last update.\u72ec\u7acb\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u3064\u306a\u304e\u3053\u3080\u306e\u306f\u3001\u5927\u5909\u3067\u3059\u3002\u305d\u308c\u306f\u3001\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u6642\u306b\u3069\u3063\u3061\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a2d\u5b9a\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u306e\u304b\uff1f\u3092\u5224\u65ad\u3059\u308b\u306e\u3082\u5927\u5909\u3060\u304b\u3089\u3067\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001td-agent(fluentd)\u3068elasticsearch\u3092\u3064\u306a\u304e\u3053\u3080\u969b\u306b\u6253\u3063\u305f\u30b3\u30de\u30f3\u30c9\u3092\u63b2\u8f09\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u524d\u63d0\u3068\u3057\u3066\u3001elasticsearch\u306b\u306flogstash\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3001logstash_prefix\u3092test\u30012015\u5e749\u67088\u65e5\u306b\u884c\u3063\u3066\u3044\u308b\u3068\u4eee\u5b9a\u3057\u307e\u3059\u3002\n\nelasticsearch\u306edebug\n\n1. elasticsearch\u306e\u30ed\u30b0\u3092tail\u3059\u308b\ntail -f /var/log/elasticsearch/elasticsearch.log\n\n\n2. elasticsearch\u306b\u30ec\u30b3\u30fc\u30c9\u304c\u767b\u9332\u3055\u308c\u305f\u304b\u78ba\u8a8d\u3059\u308b\n\u307e\u305a\u306findex\uff08\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3044\u3046\u30c6\u30fc\u30d6\u30eb\uff09\u304c\u3067\u304d\u305f\u304b\u78ba\u8a8d\ncurl 'localhost:9200/_cat/indices?v'\n\n\u30ec\u30b3\u30fc\u30c9\u304c\u5165\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\ncurl 'localhost:9200/test-2015.09.08/_search?q=*&pretty'\n\n\ntd-agent\u306edebug\n\n1. td-agent\u3092\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u7acb\u3061\u4e0a\u3052\u3066\u304a\u304f\nsudo td-agent -vv\n\n/var/log/td-agent/td-agent.log\u306b\u3082\u30ed\u30b0\u306f\u51fa\u308b\u3093\u3067\u3059\u304c\u3001\u3082\u3063\u3068\u8a73\u7d30\u306a\u30ed\u30b0\u3092\u51fa\u3057\u305f\u3044\u6642\u306f\u3001\u4e00\u65e6daemon\u3092\u6b62\u3081\u3066\u3001\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u8d77\u52d5\u3059\u308b\u306e\u304c\u3088\u3044\u307f\u305f\u3044\u3067\u3059\u3002\n\n\u81ea\u5206\u304c\u306f\u307e\u3063\u305f\u3068\u3053\u308d\ntd-agent\u306b\u304a\u3044\u3066\u3001match\u3092**nginx**\u3068\u3057\u3066\u305f\u3089\u3001ltsv.nginx\u3082\u3053\u308c\u306b\u5f15\u3063\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u3001ltsv**\u304c\u5b9f\u884c\u3055\u308c\u306a\u304b\u3063\u305f\u3002\n\u89e3\u6c7a\u65b9\u6cd5\u3068\u3057\u3066\u306f\u3001**nginx**\u3092ltsv**\u306e\u4e0b\u306b\u6301\u3063\u3066\u3044\u304f\u304b\u3001\u3082\u3063\u3068\u9650\u5b9a\u7684\u306amatch\u306b\u3059\u308b\u304b\uff1f\u3067\u3059\u304c\u3001\u81ea\u5206\u306f\u5f8c\u8005\u3092\u63a1\u7528\u3057\u307e\u3057\u305f\u3002\n\ntd-agent.conf\n<match **nginx**>\n  type copy\n  <store>\n    type parser\n    format ltsv\n    time_format %d/%b/%Y:%H:%M:%S %z\n    add_prefix ltsv\n    key_name message\n  </store>\n  <store>\n    type file\n    path /tmp/fluent.log\n  </store>\n</match>\n\n<match ltsv**>\n  type elasticsearch\n  host localhost\n  port 9200\n  index_name fluentd\n  type_name fluentd\n  logstash_format true\n  logstash_prefix test\n</match>\n\n\n\n\u72ec\u7acb\u3057\u305f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u3064\u306a\u304e\u3053\u3080\u306e\u306f\u3001\u5927\u5909\u3067\u3059\u3002\u305d\u308c\u306f\u3001\u30a8\u30e9\u30fc\u304c\u51fa\u305f\u6642\u306b\u3069\u3063\u3061\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u8a2d\u5b9a\u304c\u9593\u9055\u3063\u3066\u3044\u308b\u306e\u304b\uff1f\u3092\u5224\u65ad\u3059\u308b\u306e\u3082\u5927\u5909\u3060\u304b\u3089\u3067\u3059\u3002\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001td-agent(fluentd)\u3068elasticsearch\u3092\u3064\u306a\u304e\u3053\u3080\u969b\u306b\u6253\u3063\u305f\u30b3\u30de\u30f3\u30c9\u3092\u63b2\u8f09\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\u524d\u63d0\u3068\u3057\u3066\u3001elasticsearch\u306b\u306flogstash\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3001logstash_prefix\u3092test\u30012015\u5e749\u67088\u65e5\u306b\u884c\u3063\u3066\u3044\u308b\u3068\u4eee\u5b9a\u3057\u307e\u3059\u3002\n\n\n## elasticsearch\u306edebug\n\n### 1. elasticsearch\u306e\u30ed\u30b0\u3092tail\u3059\u308b\n\n```\ntail -f /var/log/elasticsearch/elasticsearch.log\n```\n\n\n### 2. elasticsearch\u306b\u30ec\u30b3\u30fc\u30c9\u304c\u767b\u9332\u3055\u308c\u305f\u304b\u78ba\u8a8d\u3059\u308b\n\n\u307e\u305a\u306findex\uff08\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3044\u3046\u30c6\u30fc\u30d6\u30eb\uff09\u304c\u3067\u304d\u305f\u304b\u78ba\u8a8d\n\n```\ncurl 'localhost:9200/_cat/indices?v'\n```\n\n\u30ec\u30b3\u30fc\u30c9\u304c\u5165\u3063\u3066\u3044\u308b\u304b\u78ba\u8a8d\n\n```\ncurl 'localhost:9200/test-2015.09.08/_search?q=*&pretty'\n```\n\n## td-agent\u306edebug\n\n### 1. td-agent\u3092\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u7acb\u3061\u4e0a\u3052\u3066\u304a\u304f\n\n```\nsudo td-agent -vv\n```\n\n/var/log/td-agent/td-agent.log\u306b\u3082\u30ed\u30b0\u306f\u51fa\u308b\u3093\u3067\u3059\u304c\u3001\u3082\u3063\u3068\u8a73\u7d30\u306a\u30ed\u30b0\u3092\u51fa\u3057\u305f\u3044\u6642\u306f\u3001\u4e00\u65e6daemon\u3092\u6b62\u3081\u3066\u3001\u4e0a\u8a18\u30b3\u30de\u30f3\u30c9\u3067\u8d77\u52d5\u3059\u308b\u306e\u304c\u3088\u3044\u307f\u305f\u3044\u3067\u3059\u3002\n\n## \u81ea\u5206\u304c\u306f\u307e\u3063\u305f\u3068\u3053\u308d\n\ntd-agent\u306b\u304a\u3044\u3066\u3001match\u3092```**nginx**```\u3068\u3057\u3066\u305f\u3089\u3001ltsv.nginx\u3082\u3053\u308c\u306b\u5f15\u3063\u304b\u304b\u3063\u3066\u3057\u307e\u3044\u3001```ltsv**```\u304c\u5b9f\u884c\u3055\u308c\u306a\u304b\u3063\u305f\u3002\n\u89e3\u6c7a\u65b9\u6cd5\u3068\u3057\u3066\u306f\u3001```**nginx**```\u3092```ltsv**```\u306e\u4e0b\u306b\u6301\u3063\u3066\u3044\u304f\u304b\u3001\u3082\u3063\u3068\u9650\u5b9a\u7684\u306amatch\u306b\u3059\u308b\u304b\uff1f\u3067\u3059\u304c\u3001\u81ea\u5206\u306f\u5f8c\u8005\u3092\u63a1\u7528\u3057\u307e\u3057\u305f\u3002\n\n```:td-agent.conf\n<match **nginx**>\n  type copy\n  <store>\n    type parser\n    format ltsv\n    time_format %d/%b/%Y:%H:%M:%S %z\n    add_prefix ltsv\n    key_name message\n  </store>\n  <store>\n    type file\n    path /tmp/fluent.log\n  </store>\n</match>\n\n<match ltsv**>\n  type elasticsearch\n  host localhost\n  port 9200\n  index_name fluentd\n  type_name fluentd\n  logstash_format true\n  logstash_prefix test\n</match>\n```\n", "tags": ["Elasticsearch", "fluentd", "td-agent"]}