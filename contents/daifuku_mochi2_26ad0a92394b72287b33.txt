{"tags": ["hive", "SQL"], "context": "SQL\u3068\u3001SQL\u30e9\u30a4\u30af\u306a\u8a00\u8a9eHive\u3067\u306e\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3067\u3059\u3002\n\u4f8b\uff09\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u304c\u7d9a\u304f\u3068\u304d\n\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b\u5404\uff13\u3064\u305a\u3064\u30e9\u30f3\u30c0\u30e0\u306b\u62bd\u51fa\u3057\u305f\u3044\n\n\n\ncustomer_ID\nitem_name\ndate\n\n\n\n\n\u30003\nA\n\u3000\u30002016-10-11\u3000\u3000\n\n\n\u30003\nB\n\u3000\u30002016-11-11\u3000\u3000\n\n\n\u30005\nC\n\u3000 2016-12-10\u3000\n\n\n\u30002\nA\n\u3000\u30002016-09-20\u3000\u3000\n\n\n\u30003\nD\n\u3000 2016-08-09\u3000\n\n\n\n\u4ee5\u4e0b\u30af\u30a8\u30ea\nSELECT \n    sample.customer_ID,\n    sample.item_name,\n    sample.date,\n    sample.row_num\n\nFROM\n\n    (\n    SELECT\n          *, \n          row_number()             \n              over(PARTITION BY customer_ID ORDER BY rand() ) as row_num          \n    FROM        \n          table\n    ) as sample\n\nWHERE\n    sample.row_num beween 1 and 3\n\nWINDOW\u95a2\u6570\u3092\u7528\u3044\u3066\u3001\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b\u30e9\u30f3\u30c0\u30e0\u306b\u756a\u53f7\u3092\u3075\u3063\u3066\u304b\u3089\uff08\u4ee5\u4e0b\u306e\u8868\u306e\u53f3\u30ab\u30e9\u30e0\u306e\u3088\u3046\u306b\uff09\n\u305d\u306e\u756a\u53f7\u30921~3\u307e\u3067\u62bd\u51fa\u3059\u308b\u3053\u3068\u3067\u3001\n\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b3\u3064\u305a\u3064\u62bd\u51fa\u3057\u307e\u3059\u3002\n\n\n\ncustomer_ID\nitem_name\ndate\nrow_num\n\n\n\n\n\u30003\nA\n\u3000\u30002016-10-11\u3000\u3000\n1\n\n\n\u30003\nB\n\u3000\u30002016-11-11\u3000\u3000\n3\n\n\n\u30005\nC\n\u3000 2016-12-10\u3000\n1\n\n\n\u30002\nA\n\u3000\u30002016-09-20\u3000\u3000\n1\n\n\n\u30003\nD\n\u3000 2016-08-09\u3000\n2\n\n\n\nSQL\u3068\u3001SQL\u30e9\u30a4\u30af\u306a\u8a00\u8a9eHive\u3067\u306e\u30e9\u30f3\u30c0\u30e0\u30b5\u30f3\u30d7\u30ea\u30f3\u30b0\u3067\u3059\u3002\n\n\u4f8b\uff09\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u304c\u7d9a\u304f\u3068\u304d\n\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b\u5404\uff13\u3064\u305a\u3064\u30e9\u30f3\u30c0\u30e0\u306b\u62bd\u51fa\u3057\u305f\u3044\n\n|customer_ID|item_name|date| \n|:--|--------:|:--------:|\n|\u30003  |  A    |\u3000\u30002016-10-11\u3000\u3000|  \n|\u30003  |  B    |\u3000\u30002016-11-11\u3000\u3000|  \n|\u30005  |  C    |\u3000 2016-12-10\u3000|  \n|\u30002  |  A    |\u3000\u30002016-09-20\u3000\u3000|  \n|\u30003  |  D    |\u3000 2016-08-09\u3000|  \n\n\n\n\u4ee5\u4e0b\u30af\u30a8\u30ea\n\n```\nSELECT \n    sample.customer_ID,\n    sample.item_name,\n    sample.date,\n    sample.row_num\n        \nFROM\n\n    (\n    SELECT\n          *, \n          row_number()             \n              over(PARTITION BY customer_ID ORDER BY rand() ) as row_num          \n    FROM        \n          table\n    ) as sample\n\nWHERE\n    sample.row_num beween 1 and 3\n```\n\nWINDOW\u95a2\u6570\u3092\u7528\u3044\u3066\u3001\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b\u30e9\u30f3\u30c0\u30e0\u306b\u756a\u53f7\u3092\u3075\u3063\u3066\u304b\u3089\uff08\u4ee5\u4e0b\u306e\u8868\u306e\u53f3\u30ab\u30e9\u30e0\u306e\u3088\u3046\u306b\uff09\n\u305d\u306e\u756a\u53f7\u30921~3\u307e\u3067\u62bd\u51fa\u3059\u308b\u3053\u3068\u3067\u3001\n\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b3\u3064\u305a\u3064\u62bd\u51fa\u3057\u307e\u3059\u3002\n\n|customer_ID|item_name|date|row_num|\n|:--|--------:|--------:|:--------:|\n|\u30003  |  A    |\u3000\u30002016-10-11\u3000\u3000|1|  \n|\u30003  |  B    |\u3000\u30002016-11-11\u3000\u3000|3|\n|\u30005  |  C    |\u3000 2016-12-10\u3000|1|\n|\u30002  |  A    |\u3000\u30002016-09-20\u3000\u3000|1|  \n|\u30003  |  D    |\u3000 2016-08-09\u3000|2|\n\n"}