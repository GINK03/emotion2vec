{"context": "Electron\u306b\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u30aa\u30fc\u30d7\u30f3\u6642\u306epreload\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u304bexecuteJavaScript\u95a2\u6570\u3068\u304b\u306e\u3001Javascript\u3092\u57cb\u3081\u8fbc\u3093\u3067\u5b9f\u884c\u3059\u308b\u4fbf\u5229\u6a5f\u80fd\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u4ed6\u306e\u30a4\u30d9\u30f3\u30c8\u3068\u4f75\u305b\u3066\u3053\u3044\u3064\u3089\u306f\u3069\u3046\u3044\u3046\u9806\u756a\u3067\u5b9f\u884c\u3055\u308c\u308b\u306e\uff1f \u3068\u6df7\u4e71\u3057\u3066\u304d\u305f\u306e\u3067\u5b9f\u9a13\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30c6\u30b9\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\n\nmain.js\u304b\u3089index.html\u3092\u958b\u304f\nindex.html\u306epreload\u30aa\u30d7\u30b7\u30e7\u30f3\u306bpreload_index.js\u3092\u6307\u5b9a\nindex.html\u5185\u306bwebview\u30bf\u30b0\u3067webview.html\u3092\u8aad\u307f\u8fbc\u3080\nwebview.html\u306epreload\u306bpreload_webview.js\u3092\u6307\u5b9a\n\n\u30a4\u30d9\u30f3\u30c8\u304c\u767a\u751f\u3057\u305f\u3089\u3001ipc\u3067\u30e1\u30a4\u30f3\u30d7\u30ed\u30bb\u30b9\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u3001\u305d\u308c\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\u30a4\u30d9\u30f3\u30c8\u306e\u767a\u751f\u9806\u306bconsole.log\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\nmain.js\n'use strict';\nconst {app, BrowserWindow, ipcMain} = require('electron');\nconst path = require('path');\n\nlet mainWindow = null;\napp.on('window-all-closed', ()=>app.quit());\n\nlet webContentJs = `\nlet ipcRender = require('electron').ipcRenderer;\nipcRender.send('ipc', 'WebContents.executeJavaScript\u3067\u5b9f\u884c\u3055\u308c\u305fJavascript');`;\n\napp.on('ready', function() {\n    mainWindow = new BrowserWindow({\n        webPreferences: {\n            preload: path.resolve(path.join(__dirname, 'preload_index.js')),\n        },\n    });\n    mainWindow.loadURL(`file://${__dirname}/index.html`);\n\n    mainWindow.webContents.executeJavaScript(webContentJs);\n    mainWindow.webContents.on('did-finish-load', ()=> console.log('WebContents.did-finish-load\u30a4\u30d9\u30f3\u30c8'));\n    mainWindow.webContents.on('did-start-loading', ()=> console.log('WebContents.did-start-loading\u30a4\u30d9\u30f3\u30c8'));\n    mainWindow.webContents.on('dom-ready', ()=> console.log('WebContents.dom-ready\u30a4\u30d9\u30f3\u30c8'));\n\n    ipcMain.on('ipc', (event, arg)=> console.log(arg));\n\n    mainWindow.on('closed', ()=> mainWindow = null);\n    mainWindow.webContents.openDevTools({mode:'undocked'});\n});\n\n\n\nindex.html\n<!DOCTYPE html>\n<!-- \u30e1\u30a4\u30f3\u30a6\u30a3\u30f3\u30c9\u30a6-->\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\" />\n        <script>\n            const {ipcRenderer} = require('electron');\n            ipcRenderer.send('ipc', 'index.html\u5185\u306e<script>\u30bf\u30b0');\n            window.addEventListener('load', function() {\n                ipcRenderer.send('ipc', 'index.html\u306ewindow.onload');\n            });\n        </script>\n    </head>\n    <body>\n        \u3066\u3059\u3068<br>\n        <webview class=\"wv\" src=\"webview.html\" preload=\"./preload_webview.js\"></webview>\n    </body>\n</html>\n\n\n\npreload_index.js\n//\" a script that will be loaded before other scripts run in the page.\"\nconst {ipcRenderer} = require('electron');\nwindow.addEventListener('load', ()=> ipcRenderer.send('ipc', 'index.html\u306epreload\u306ewindow.onload'));\nipcRenderer.send('ipc', 'index.html\u306epreload');\n\n\n\nwebview.html\n<!DOCTYPE html>\n<!--index.html\u5185\u306b\u8aad\u307f\u8fbc\u307e\u308c\u308bwebview-->\n<html lang=\"ja\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>webview</title>\n</head>\n<body>\n    webview<br>\n</body>\n</html>\n\n\n\npreload_webview.js\nconst {ipcRenderer} = require('electron');\nwindow.addEventListener('load', ()=> ipcRenderer.send('ipc', 'webview.html\u306epreload\u306ewindow.onload'));\nipcRenderer.send('ipc', 'webview.html\u306epreload');\n\n\n\n\u5b9f\u884c\u7d50\u679c\n\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nindex.html\u306epreload\nindex.html\u5185\u306e<script>\u30bf\u30b0\nWebContents.dom-ready\u30a4\u30d9\u30f3\u30c8\nindex.html\u306epreload\u306ewindow.onload\nindex.html\u306ewindow.onload\nWebContents.did-finish-load\u30a4\u30d9\u30f3\u30c8\nWebContents.executeJavaScript\u3067\u5b9f\u884c\u3055\u308c\u305fJavascript\nwebview.html\u306epreload\nwebview.html\u306epreload\u306ewindow.onload\n\nWebContents.did-start-loading\u306f\u767a\u751f\u3057\u306a\u3044\u3093\u3067\u3059\u306d\u3002\n\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nWebContents.did-start-loading\u30a4\u30d9\u30f3\u30c8\nindex.html\u306epreload\nindex.html\u5185\u306e<script>\u30bf\u30b0\nWebContents.dom-ready\u30a4\u30d9\u30f3\u30c8\nindex.html\u306epreload\u306ewindow.onload\nindex.html\u306ewindow.onload\nWebContents.did-finish-load\u30a4\u30d9\u30f3\u30c8\nwebview.html\u306epreload\nwebview.html\u306epreload\u306ewindow.onload\n\nwebview\u306epreload\u306f\u3001WebContents.did-finish-loading\u3088\u308a\u5148\u306b\u5b9f\u884c\u3055\u308c\u308b\u304b\u3068\u601d\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\u3057\u304b\u3082\u30ea\u30ed\u30fc\u30c9\u6642\u306f\u3001executeJavascript\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\u3093\u3067\u3059\u306d\u3002\n\u5b9f\u9a13\u3057\u3066\u307f\u308b\u3082\u306e\u3067\u3059\u306d\u3002\nElectron\u306b\u306f\u30a6\u30a3\u30f3\u30c9\u30a6\u30aa\u30fc\u30d7\u30f3\u6642\u306e[preload](http://electron.atom.io/docs/v0.36.5/api/browser-window/#new-browserwindowoptions)\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u304b`executeJavaScript`\u95a2\u6570\u3068\u304b\u306e\u3001Javascript\u3092\u57cb\u3081\u8fbc\u3093\u3067\u5b9f\u884c\u3059\u308b\u4fbf\u5229\u6a5f\u80fd\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u4ed6\u306e\u30a4\u30d9\u30f3\u30c8\u3068\u4f75\u305b\u3066\u3053\u3044\u3064\u3089\u306f\u3069\u3046\u3044\u3046\u9806\u756a\u3067\u5b9f\u884c\u3055\u308c\u308b\u306e\uff1f \u3068\u6df7\u4e71\u3057\u3066\u304d\u305f\u306e\u3067\u5b9f\u9a13\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n#\u30c6\u30b9\u30c8\u30d7\u30ed\u30b0\u30e9\u30e0\n- main.js\u304b\u3089index.html\u3092\u958b\u304f\n- index.html\u306epreload\u30aa\u30d7\u30b7\u30e7\u30f3\u306bpreload_index.js\u3092\u6307\u5b9a\n- index.html\u5185\u306b[webview\u30bf\u30b0](http://electron.atom.io/docs/v0.36.5/api/web-view-tag/)\u3067webview.html\u3092\u8aad\u307f\u8fbc\u3080\n- webview.html\u306epreload\u306bpreload_webview.js\u3092\u6307\u5b9a\n\n\u30a4\u30d9\u30f3\u30c8\u304c\u767a\u751f\u3057\u305f\u3089\u3001[ipc](http://electron.atom.io/docs/v0.36.5/api/ipc-renderer)\u3067\u30e1\u30a4\u30f3\u30d7\u30ed\u30bb\u30b9\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\u3057\u3001\u305d\u308c\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\u30a4\u30d9\u30f3\u30c8\u306e\u767a\u751f\u9806\u306bconsole.log\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002\n\n```js:main.js\n'use strict';\nconst {app, BrowserWindow, ipcMain} = require('electron');\nconst path = require('path');\n\nlet mainWindow = null;\napp.on('window-all-closed', ()=>app.quit());\n\nlet webContentJs = `\nlet ipcRender = require('electron').ipcRenderer;\nipcRender.send('ipc', 'WebContents.executeJavaScript\u3067\u5b9f\u884c\u3055\u308c\u305fJavascript');`;\n\napp.on('ready', function() {\n    mainWindow = new BrowserWindow({\n        webPreferences: {\n            preload: path.resolve(path.join(__dirname, 'preload_index.js')),\n        },\n    });\n    mainWindow.loadURL(`file://${__dirname}/index.html`);\n\n    mainWindow.webContents.executeJavaScript(webContentJs);\n    mainWindow.webContents.on('did-finish-load', ()=> console.log('WebContents.did-finish-load\u30a4\u30d9\u30f3\u30c8'));\n    mainWindow.webContents.on('did-start-loading', ()=> console.log('WebContents.did-start-loading\u30a4\u30d9\u30f3\u30c8'));\n    mainWindow.webContents.on('dom-ready', ()=> console.log('WebContents.dom-ready\u30a4\u30d9\u30f3\u30c8'));\n\n    ipcMain.on('ipc', (event, arg)=> console.log(arg));\n\n    mainWindow.on('closed', ()=> mainWindow = null);\n    mainWindow.webContents.openDevTools({mode:'undocked'});\n});\n```\n```html:index.html\n<!DOCTYPE html>\n<!-- \u30e1\u30a4\u30f3\u30a6\u30a3\u30f3\u30c9\u30a6-->\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\" />\n        <script>\n            const {ipcRenderer} = require('electron');\n            ipcRenderer.send('ipc', 'index.html\u5185\u306e<script>\u30bf\u30b0');\n            window.addEventListener('load', function() {\n                ipcRenderer.send('ipc', 'index.html\u306ewindow.onload');\n            });\n        </script>\n    </head>\n    <body>\n        \u3066\u3059\u3068<br>\n        <webview class=\"wv\" src=\"webview.html\" preload=\"./preload_webview.js\"></webview>\n    </body>\n</html>\n```\n```js:preload_index.js\n//\" a script that will be loaded before other scripts run in the page.\"\nconst {ipcRenderer} = require('electron');\nwindow.addEventListener('load', ()=> ipcRenderer.send('ipc', 'index.html\u306epreload\u306ewindow.onload'));\nipcRenderer.send('ipc', 'index.html\u306epreload');\n```\n```html:webview.html\n<!DOCTYPE html>\n<!--index.html\u5185\u306b\u8aad\u307f\u8fbc\u307e\u308c\u308bwebview-->\n<html lang=\"ja\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>webview</title>\n</head>\n<body>\n    webview<br>\n</body>\n</html>\n```\n```js:preload_webview.js\nconst {ipcRenderer} = require('electron');\nwindow.addEventListener('load', ()=> ipcRenderer.send('ipc', 'webview.html\u306epreload\u306ewindow.onload'));\nipcRenderer.send('ipc', 'webview.html\u306epreload');\n```\n#\u5b9f\u884c\u7d50\u679c\n\u3053\u3093\u306a\u611f\u3058\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n```\nindex.html\u306epreload\nindex.html\u5185\u306e<script>\u30bf\u30b0\nWebContents.dom-ready\u30a4\u30d9\u30f3\u30c8\nindex.html\u306epreload\u306ewindow.onload\nindex.html\u306ewindow.onload\nWebContents.did-finish-load\u30a4\u30d9\u30f3\u30c8\nWebContents.executeJavaScript\u3067\u5b9f\u884c\u3055\u308c\u305fJavascript\nwebview.html\u306epreload\nwebview.html\u306epreload\u306ewindow.onload\n```\nWebContents.did-start-loading\u306f\u767a\u751f\u3057\u306a\u3044\u3093\u3067\u3059\u306d\u3002\n\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n```\nWebContents.did-start-loading\u30a4\u30d9\u30f3\u30c8\nindex.html\u306epreload\nindex.html\u5185\u306e<script>\u30bf\u30b0\nWebContents.dom-ready\u30a4\u30d9\u30f3\u30c8\nindex.html\u306epreload\u306ewindow.onload\nindex.html\u306ewindow.onload\nWebContents.did-finish-load\u30a4\u30d9\u30f3\u30c8\nwebview.html\u306epreload\nwebview.html\u306epreload\u306ewindow.onload\n```\n\nwebview\u306epreload\u306f\u3001WebContents.did-finish-loading\u3088\u308a\u5148\u306b\u5b9f\u884c\u3055\u308c\u308b\u304b\u3068\u601d\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\u3057\u304b\u3082\u30ea\u30ed\u30fc\u30c9\u6642\u306f\u3001executeJavascript\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\u3093\u3067\u3059\u306d\u3002\n\n\u5b9f\u9a13\u3057\u3066\u307f\u308b\u3082\u306e\u3067\u3059\u306d\u3002\n", "tags": ["Electron"]}