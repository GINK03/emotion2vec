{"context": " More than 1 year has passed since last update.CFTraq.jp \u306e\u6a5f\u80fd\u8ffd\u52a0\u3068\u3057\u3066\u30bd\u30fc\u30b7\u30e3\u30eb\u30b7\u30a7\u30a2\u6570\u3092\u53d6\u308b\u3088\u3046\u306b\u3057\u3088\u3046\u3068\u601d\u3046\u3002\u73fe\u5728\u3001\u65e5\u6b21\u3067\u30af\u30ed\u30fc\u30eb\u3057\u3066\u308b\u6848\u4ef6\u306f500\u4ef6\u5f31\u3042\u308b\u306e\u3067\u3001\u307e\u3068\u3081\u3066\u6295\u3052\u306a\u3044\u3068\u3072\u3069\u3044\u3053\u3068\u306b\u306a\u308b\u3002\u3068\u3044\u3046\u3053\u3068\u3067batch request\u3002\n\u516c\u5f0f\u60c5\u5831\u306f\u4ee5\u4e0b\nhttps://developers.facebook.com/docs/graph-api/making-multiple-requests\n\n50\u30ea\u30af\u30a8\u30b9\u30c8\u307e\u3067\u4e00\u3064\u306e\u30d0\u30c3\u30c1\u306b\u307e\u3068\u3081\u3066\u6295\u3052\u3089\u308c\u308b\u3068\u306e\u3053\u3068\u3002\n\n\n\u307e\u305a\u306fCUI\u304b\u3089curl\u3092\u4f7f\u3063\u3066\u8a66\u3057\u3066\u307f\u308b\n\nbatch.sh\ncurl -s \n    -F 'access_token=***access_token***' \n    -F 'batch=[\n        {\"method\": \"GET\", \"relative_url\": \"v2.3/?id=https://qiita.com/&fields=og_object{engagement},share\"},\n        {\"method\": \"GET\", \"relative_url\": \"v2.3/?id=http://kobito.qiita.com/&fields=og_object{engagement},share\"}\n    ]' \n    -F 'include_headers=false' \n    https://graph.facebook.com/ | jq '.'\n\n# \u5b9f\u969b\u306b\u306f1\u884c\ncurl -s -F 'access_token=***access_token***' -F 'batch=[{\"method\": \"GET\", \"relative_url\": \"v2.3/?id=https://qiita.com/&fields=og_object{engagement},share\"},{\"method\": \"GET\", \"relative_url\": \"v2.3/?id=http://kobito.qiita.com/&fields=og_object{engagement},share\"}]' -F 'include_headers=false' https://graph.facebook.com/ | jq \".\"\n\n\n\n\ncurl\u306b-s\u3092\u3064\u3051\u3066\u901a\u4fe1\u72b6\u6cc1\u306e\u8868\u793a\u3092\u7701\u7565\n\n-F 'batch=[{...}]' \u306e\u5f62\u5f0f\u3067\u30d0\u30c3\u30c1\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8a18\u8ff0\n\u5404\u30ea\u30af\u30a8\u30b9\u30c8\u306f{}\u306bJSON\u3067\u8a18\u8ff0\u3002method\u3068relative_url\u306f\u5fc5\u9808\n\n&fields=og_object{engagement},share\u3092\u4ed8\u3051\u3066\u308b\u306e\u306f\u3053\u3053\u3092\u53c2\u7167\u3002\n\n-F 'include_headers=false'\u3092\u3064\u3051\u3066Graph API\u304b\u3089\u8fd4\u3063\u3066\u304f\u308b\u6642\u306e\u30d8\u30c3\u30c0\u30fc\u3092\u7701\u7565\n\uff08\u304a\u307e\u3051\uff09\u6700\u5f8c\u306bjq '.'\u3067\u30ec\u30b9\u30dd\u30f3\u30b9\u306eJSON\u3092\u53ef\u8996\u5316\u3057\u3066\u3044\u308b\n\n\u30ec\u30b9\u30dd\u30f3\u30b9\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\nresponse.json\n[\n  {\n    \"code\": 200,\n    \"body\": \"{\\\"og_object\\\":{\\\"engagement\\\":{\\\"count\\\":629,\\\"social_sentence\\\":\\\"629 people like this.\\\"},\\\"id\\\":\\\"143935272446719\\\"},\\\"share\\\":{\\\"comment_count\\\":0,\\\"share_count\\\":629},\\\"id\\\":\\\"https:\\\\/\\\\/qiita.com\\\\/\\\"}\"\n  },\n  {\n    \"code\": 200,\n    \"body\": \"{\\\"og_object\\\":{\\\"engagement\\\":{\\\"count\\\":304,\\\"social_sentence\\\":\\\"304 people like this.\\\"},\\\"id\\\":\\\"10150590829744321\\\"},\\\"share\\\":{\\\"comment_count\\\":0,\\\"share_count\\\":304},\\\"id\\\":\\\"http:\\\\/\\\\/kobito.qiita.com\\\\/\\\"}\"\n  }\n]\n\n\n\nkoala\u3092\u4f7f\u3063\u3066ruby\u304b\u3089\u6295\u3052\u3066\u307f\u308b\nruby\u304b\u3089Graph API\u3092\u53e9\u304f\u306b\u306fkoala\u304c\u4fbf\u5229\u3002\n\nbatch.rb\n# Graph API\u306fv2.3\u3092\u4f7f\u7528\nKoala.config.api_version = \"v2.3\"\n\n# \u5358\u4e00\u306e\u30ea\u30af\u30a8\u30b9\u30c8\ngraph = Koala::Facebook::API.new(\"***access_token***\") \ngraph.get_object(\"/\", :id => \"https://qiita.com/\")\n\n# \u30d0\u30c3\u30c1\u30ea\u30af\u30a8\u30b9\u30c8\napi = Koala::Facebook::API.new(\"***access_token***\") \nresults =  api.batch do |batch_api|\n    batch_api.get_object(\"/\", :id => \"https://qiita.com/\")\n    batch_api.get_object(\"/\", :id => \"http://kobito.qiita.com/\")\nend\n\n\nresults\u306e\u4e2d\u8eab\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\nresults.rb\nresults\n => [{\"id\"=>\"https://qiita.com/\", \"shares\"=>550}, {\"id\"=>\"http://kobito.qiita.com/\", \"shares\"=>303}]\n\n\n\nrails\u306b\u7d44\u307f\u8fbc\u3093\u3067\u307f\u308b\nkoala wiki\u306b\u3061\u3087\u3046\u3069rails\u306b\u4f7f\u3046\u969b\u306e\u3084\u308a\u65b9\u304c\u8f09\u3063\u3066\u308b\u3002\nhttps://github.com/arsduo/koala/wiki/Koala-on-Rails\n\nkoala.rb\n#config/initializers/koala.rb\nKoala::Facebook::OAuth.class_eval do\n  def initialize_with_default_settings(*args)\n    raise \"application id and/or secret are not specified in the envrionment\" unless ENV['FB_APP_ID'] && ENV['FB_APP_SECRET']\n    initialize_without_default_settings(ENV['FB_APP_ID'].to_s, ENV['FB_APP_SECRET'].to_s, args.first)\n  end \n\n  alias_method_chain :initialize, :default_settings \nend\n\n# Graph API\u306fv2.3\u3092\u4f7f\u7528\nKoala.config.api_version = \"v2.3\"\n\n\nAPP_ID\u3068APP_SECRET\u306f\u74b0\u5883\u5909\u6570\u3067\u8a2d\u5b9a\u3002\nexport FB_APP_ID='***fb_app_id***'\nexport FB_APP_SECRET='***fb_app_secret***'\n\n# heroku\u306a\u3089\u4ee5\u4e0b\nheroku config:set FB_APP_ID='***fb_app_id***'\nheroku config:set FB_APP_SECRET='***fb_app_secret***'\n\n\u4f7f\u3044\u65b9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3002\n\nrails_koala.rb\nurls = [\"https://qiita.com/\", \"http://kobito.qiita.com/\"]\n\ngraph = Koala::Facebook::API.new(Koala::Facebook::OAuth.new.get_app_access_token)\n\nresults =  graph.batch do |batch_api|\n    urls.each { |url|\n        batch_api.get_object(\"/\", :id => url)\n    }\nend\n\n\nresults\u306e\u4e2d\u8eab\u306f\u3053\u3093\u306a\u611f\u3058\u3002\nresults\n => [{\"og_object\"=>{\"id\"=>\"143935272446719\", \"description\"=>\"Qiita\u306f\u3001\u30d7\u30ed\u30b0\u30e9\u30de\u306e\u305f\u3081\u306e\u6280\u8853\u60c5\u5831\u5171\u6709\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002 \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u95a2\u3059\u308bTips\u3001\u30ce\u30a6\u30cf\u30a6\u3001\u30e1\u30e2\u3092\u7c21\u5358\u306b\u8a18\u9332 &amp; \u516c\u958b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\", \"title\"=>\"Qiita - \u30d7\u30ed\u30b0\u30e9\u30de\u306e\u6280\u8853\u60c5\u5831\u5171\u6709\u30b5\u30fc\u30d3\u30b9\", \"type\"=>\"website\", \"updated_time\"=>\"2015-05-16T04:59:42+0000\", \"url\"=>\"https://qiita.com/\"}, \"share\"=>{\"comment_count\"=>0, \"share_count\"=>630}, \"id\"=>\"https://qiita.com/\"}, {\"og_object\"=>{\"id\"=>\"10150590829744321\", \"description\"=>\"\u30a8\u30f3\u30b8\u30cb\u30a2\u306e\u305f\u3081\u306eMac\u30a2\u30d7\u30ea\u300ckobito\u300d\u3092Qiita\u304c\u958b\u767a\u4e2d!\u30ea\u30ea\u30fc\u30b9\u307e\u3067\u3042\u3068\u25cb\u25cb\u65e5\u2026\", \"title\"=>\"Project ``kobito`` - ``kobito``\u5148\u884c\u5229\u7528\u30e6\u30fc\u30b6\u30fc\u52df\u96c6\u7de0\u5207\u3068\u30cb\u30e5\u30fc\u30b9\u30ec\u30bf\u30fc\u767b\u9332\", \"type\"=>\"website\", \"updated_time\"=>\"2015-05-11T11:24:27+0000\", \"url\"=>\"http://kobito.qiita.com/\"}, \"share\"=>{\"comment_count\"=>0, \"share_count\"=>304}, \"id\"=>\"http://kobito.qiita.com/\"}]\n\nLike\u6570\u306fresults[0][\"share\"][\"share_count\"]\u3068\u304b\u3067Fixnum\u3067\u53d6\u308c\u308b\u3002\n\n[CFTraq.jp](http://cftraq.jp) \u306e\u6a5f\u80fd\u8ffd\u52a0\u3068\u3057\u3066\u30bd\u30fc\u30b7\u30e3\u30eb\u30b7\u30a7\u30a2\u6570\u3092\u53d6\u308b\u3088\u3046\u306b\u3057\u3088\u3046\u3068\u601d\u3046\u3002\u73fe\u5728\u3001\u65e5\u6b21\u3067\u30af\u30ed\u30fc\u30eb\u3057\u3066\u308b\u6848\u4ef6\u306f500\u4ef6\u5f31\u3042\u308b\u306e\u3067\u3001\u307e\u3068\u3081\u3066\u6295\u3052\u306a\u3044\u3068\u3072\u3069\u3044\u3053\u3068\u306b\u306a\u308b\u3002\u3068\u3044\u3046\u3053\u3068\u3067batch request\u3002\n\n\u516c\u5f0f\u60c5\u5831\u306f\u4ee5\u4e0b\nhttps://developers.facebook.com/docs/graph-api/making-multiple-requests\n\n- 50\u30ea\u30af\u30a8\u30b9\u30c8\u307e\u3067\u4e00\u3064\u306e\u30d0\u30c3\u30c1\u306b\u307e\u3068\u3081\u3066\u6295\u3052\u3089\u308c\u308b\u3068\u306e\u3053\u3068\u3002\n\n\n# \u307e\u305a\u306fCUI\u304b\u3089curl\u3092\u4f7f\u3063\u3066\u8a66\u3057\u3066\u307f\u308b\n\n```batch.sh\ncurl -s \n\t-F 'access_token=***access_token***' \n\t-F 'batch=[\n\t\t{\"method\": \"GET\", \"relative_url\": \"v2.3/?id=https://qiita.com/&fields=og_object{engagement},share\"},\n\t\t{\"method\": \"GET\", \"relative_url\": \"v2.3/?id=http://kobito.qiita.com/&fields=og_object{engagement},share\"}\n\t]' \n\t-F 'include_headers=false' \n\thttps://graph.facebook.com/ | jq '.'\n\n# \u5b9f\u969b\u306b\u306f1\u884c\ncurl -s -F 'access_token=***access_token***' -F 'batch=[{\"method\": \"GET\", \"relative_url\": \"v2.3/?id=https://qiita.com/&fields=og_object{engagement},share\"},{\"method\": \"GET\", \"relative_url\": \"v2.3/?id=http://kobito.qiita.com/&fields=og_object{engagement},share\"}]' -F 'include_headers=false' https://graph.facebook.com/ | jq \".\"\n\n```\n\n- curl\u306b-s\u3092\u3064\u3051\u3066\u901a\u4fe1\u72b6\u6cc1\u306e\u8868\u793a\u3092\u7701\u7565\n- `-F 'batch=[{...}]'` \u306e\u5f62\u5f0f\u3067\u30d0\u30c3\u30c1\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8a18\u8ff0\n- \u5404\u30ea\u30af\u30a8\u30b9\u30c8\u306f{}\u306bJSON\u3067\u8a18\u8ff0\u3002method\u3068relative_url\u306f\u5fc5\u9808\n- `&fields=og_object{engagement},share`\u3092\u4ed8\u3051\u3066\u308b\u306e\u306f[\u3053\u3053](http://blog.hello-world.jp.net/api/2221/)\u3092\u53c2\u7167\u3002\n- `-F 'include_headers=false'`\u3092\u3064\u3051\u3066Graph API\u304b\u3089\u8fd4\u3063\u3066\u304f\u308b\u6642\u306e\u30d8\u30c3\u30c0\u30fc\u3092\u7701\u7565\n- \uff08\u304a\u307e\u3051\uff09\u6700\u5f8c\u306b`jq '.'`\u3067\u30ec\u30b9\u30dd\u30f3\u30b9\u306eJSON\u3092\u53ef\u8996\u5316\u3057\u3066\u3044\u308b\n\n\u30ec\u30b9\u30dd\u30f3\u30b9\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n```response.json\n[\n  {\n    \"code\": 200,\n    \"body\": \"{\\\"og_object\\\":{\\\"engagement\\\":{\\\"count\\\":629,\\\"social_sentence\\\":\\\"629 people like this.\\\"},\\\"id\\\":\\\"143935272446719\\\"},\\\"share\\\":{\\\"comment_count\\\":0,\\\"share_count\\\":629},\\\"id\\\":\\\"https:\\\\/\\\\/qiita.com\\\\/\\\"}\"\n  },\n  {\n    \"code\": 200,\n    \"body\": \"{\\\"og_object\\\":{\\\"engagement\\\":{\\\"count\\\":304,\\\"social_sentence\\\":\\\"304 people like this.\\\"},\\\"id\\\":\\\"10150590829744321\\\"},\\\"share\\\":{\\\"comment_count\\\":0,\\\"share_count\\\":304},\\\"id\\\":\\\"http:\\\\/\\\\/kobito.qiita.com\\\\/\\\"}\"\n  }\n]\n```\n\n\n# koala\u3092\u4f7f\u3063\u3066ruby\u304b\u3089\u6295\u3052\u3066\u307f\u308b\nruby\u304b\u3089Graph API\u3092\u53e9\u304f\u306b\u306f[koala](https://github.com/arsduo/koala)\u304c\u4fbf\u5229\u3002\n\n```batch.rb\n# Graph API\u306fv2.3\u3092\u4f7f\u7528\nKoala.config.api_version = \"v2.3\"\n\n# \u5358\u4e00\u306e\u30ea\u30af\u30a8\u30b9\u30c8\ngraph = Koala::Facebook::API.new(\"***access_token***\") \ngraph.get_object(\"/\", :id => \"https://qiita.com/\")\n\n# \u30d0\u30c3\u30c1\u30ea\u30af\u30a8\u30b9\u30c8\napi = Koala::Facebook::API.new(\"***access_token***\") \nresults =  api.batch do |batch_api|\n\tbatch_api.get_object(\"/\", :id => \"https://qiita.com/\")\n\tbatch_api.get_object(\"/\", :id => \"http://kobito.qiita.com/\")\nend\n```\n\nresults\u306e\u4e2d\u8eab\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n```results.rb\nresults\n => [{\"id\"=>\"https://qiita.com/\", \"shares\"=>550}, {\"id\"=>\"http://kobito.qiita.com/\", \"shares\"=>303}]\n```\n\n\n# rails\u306b\u7d44\u307f\u8fbc\u3093\u3067\u307f\u308b\nkoala wiki\u306b\u3061\u3087\u3046\u3069rails\u306b\u4f7f\u3046\u969b\u306e\u3084\u308a\u65b9\u304c\u8f09\u3063\u3066\u308b\u3002\nhttps://github.com/arsduo/koala/wiki/Koala-on-Rails\n\n```koala.rb\n#config/initializers/koala.rb\nKoala::Facebook::OAuth.class_eval do\n  def initialize_with_default_settings(*args)\n    raise \"application id and/or secret are not specified in the envrionment\" unless ENV['FB_APP_ID'] && ENV['FB_APP_SECRET']\n    initialize_without_default_settings(ENV['FB_APP_ID'].to_s, ENV['FB_APP_SECRET'].to_s, args.first)\n  end \n\n  alias_method_chain :initialize, :default_settings \nend\n\n# Graph API\u306fv2.3\u3092\u4f7f\u7528\nKoala.config.api_version = \"v2.3\"\n```\n\nAPP_ID\u3068APP_SECRET\u306f\u74b0\u5883\u5909\u6570\u3067\u8a2d\u5b9a\u3002\n\n```.sh\nexport FB_APP_ID='***fb_app_id***'\nexport FB_APP_SECRET='***fb_app_secret***'\n\n# heroku\u306a\u3089\u4ee5\u4e0b\nheroku config:set FB_APP_ID='***fb_app_id***'\nheroku config:set FB_APP_SECRET='***fb_app_secret***'\n```\n\n\u4f7f\u3044\u65b9\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3002\n\n```rails_koala.rb\nurls = [\"https://qiita.com/\", \"http://kobito.qiita.com/\"]\n\ngraph = Koala::Facebook::API.new(Koala::Facebook::OAuth.new.get_app_access_token)\n\nresults =  graph.batch do |batch_api|\n\turls.each { |url|\n\t\tbatch_api.get_object(\"/\", :id => url)\n\t}\nend\n```\n\nresults\u306e\u4e2d\u8eab\u306f\u3053\u3093\u306a\u611f\u3058\u3002\n\n```.rb\nresults\n => [{\"og_object\"=>{\"id\"=>\"143935272446719\", \"description\"=>\"Qiita\u306f\u3001\u30d7\u30ed\u30b0\u30e9\u30de\u306e\u305f\u3081\u306e\u6280\u8853\u60c5\u5831\u5171\u6709\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u3002 \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u95a2\u3059\u308bTips\u3001\u30ce\u30a6\u30cf\u30a6\u3001\u30e1\u30e2\u3092\u7c21\u5358\u306b\u8a18\u9332 &amp; \u516c\u958b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\", \"title\"=>\"Qiita - \u30d7\u30ed\u30b0\u30e9\u30de\u306e\u6280\u8853\u60c5\u5831\u5171\u6709\u30b5\u30fc\u30d3\u30b9\", \"type\"=>\"website\", \"updated_time\"=>\"2015-05-16T04:59:42+0000\", \"url\"=>\"https://qiita.com/\"}, \"share\"=>{\"comment_count\"=>0, \"share_count\"=>630}, \"id\"=>\"https://qiita.com/\"}, {\"og_object\"=>{\"id\"=>\"10150590829744321\", \"description\"=>\"\u30a8\u30f3\u30b8\u30cb\u30a2\u306e\u305f\u3081\u306eMac\u30a2\u30d7\u30ea\u300ckobito\u300d\u3092Qiita\u304c\u958b\u767a\u4e2d!\u30ea\u30ea\u30fc\u30b9\u307e\u3067\u3042\u3068\u25cb\u25cb\u65e5\u2026\", \"title\"=>\"Project ``kobito`` - ``kobito``\u5148\u884c\u5229\u7528\u30e6\u30fc\u30b6\u30fc\u52df\u96c6\u7de0\u5207\u3068\u30cb\u30e5\u30fc\u30b9\u30ec\u30bf\u30fc\u767b\u9332\", \"type\"=>\"website\", \"updated_time\"=>\"2015-05-11T11:24:27+0000\", \"url\"=>\"http://kobito.qiita.com/\"}, \"share\"=>{\"comment_count\"=>0, \"share_count\"=>304}, \"id\"=>\"http://kobito.qiita.com/\"}]\n```\n\nLike\u6570\u306f`results[0][\"share\"][\"share_count\"]`\u3068\u304b\u3067Fixnum\u3067\u53d6\u308c\u308b\u3002\n", "tags": ["opengraph", "Rails", "Facebook", "koala", "Ruby"]}