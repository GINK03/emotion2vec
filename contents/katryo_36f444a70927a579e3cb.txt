{"context": " More than 1 year has passed since last update.\n\n\u8ffd\u8a18\u30002012/09/22\n\u30e2\u30c3\u30af\u90e8\u5206\u3001\u30b7\u30f3\u30dc\u30eb\u3060\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u306e\u3067\u6587\u5b57\u5217\u3067\"uid\"\u3068\u3044\u3046\u98a8\u306b\u66f8\u304b\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002\u4fee\u6b63\u3057\u307e\u3057\u305f\u3002\n\u521d\u3081\u3066TDD\u3092\u3084\u3063\u3066\u308b\u306e\u3067\u3059\u3051\u3069\u3001OAuth\u8a8d\u8a3c\u306e\u30c6\u30b9\u30c8\u306e\u3084\u308a\u304b\u305f\u3092\u8abf\u3079\u308b\u306e\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u305f\u306e\u3067\u3001\u5f8c\u306e\u305f\u3081\u306b\u3053\u3053\u306b\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\nauth_spec.rb\n#coding: utf-8\nrequire 'spec_helper'\ndescribe \"A logged in user\" do\n  before do\n    OmniAuth.config.test_mode = true\n    user = FactoryGirl.create(:user)\n    OmniAuth.config.mock_auth[:twitter] = {\n      \"uid\" => \"11111\",\n      \"provider\" => \"twitter\",\n      \"info\" => {\n        \"description\" => \"\u3053\u3093\u306b\u3061\u306f\u3053\u3093\u306b\u3061\u306f\uff01\u3000\u304b\u3068\u308a\u3087\u30fc\u3067\u3059\uff01\"\n      }\n    }\n      visit \"/auth/twitter\"\n  end\n\n  after do\n    OmniAuth.config.test_mode = false\n  end\n  describe \"in items page\" do\n    it \"should add an item by the user\" do\n      visit items_path\n      click_link \"\u5ba3\u4f1d\u4e00\u89a7\"\n      click_link \"\u5ba3\u4f1d\u3092\u767b\u9332\u3059\u308b\"\n      fill_in \"item_body\", :with => \"\u30a2\u30ca\u30c6\u30de\u30fb\u30d5\u30a3\u30b8\u30af\u30b9\u3092\u305c\u3072\u30d7\u30ec\u30a4\u3057\u3066\u307f\u3066\uff01\"\n      click_button \"\u767b\u9332\"\n      click_link \"\u5ba3\u4f1d\u4e00\u89a7\"\n      page.should have_content(\"\u30a2\u30ca\u30c6\u30de\u30fb\u30d5\u30a3\u30b8\u30af\u30b9\u3092\u305c\u3072\u30d7\u30ec\u30a4\u3057\u3066\u307f\u3066\uff01\")\n      page.should have_content(\"Edit\")\n      click_link \"\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\"\n      page.should have_content(\"denki\")\n    end\n  end\nend\n\n\n\u3067\u3059\u3002\n\nOmniAuth.config.test_mode = true\n\n\u3068\n\nOmniAuth.config.mock_auth[:twitter] = \uff5b:uid\u306a\u3069\uff5d\n\n\u304c\u30dd\u30a4\u30f3\u30c8\u3002\n\u30e2\u30c3\u30af\u3092auth_spec.rb\u306e\u307b\u3046\u3067\u4f5c\u3063\u3066\u3057\u307e\u3063\u3066\u3001\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u3067\u4f5c\u3063\u305f\u30e6\u30fc\u30b6\u30fc\u306b\u306f/auth/twitter\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3082\u3089\u3046\u3053\u3068\u3067\u3001OAuth\u8a8d\u8a3c\u304c\u5b8c\u4e86\u3057\u307e\u3059\u3002OAuth\u306egem\u306fomniauth-twitter\u3092\u4f7f\u3063\u3066\u307e\u3059\u3002\nFactoryGirl\u3067\u4f5c\u308b\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\nfactories.rb\n#coding:utf-8\nFactoryGirl.define do\n  factory :item do\n    body \"\u30a2\u30ca\u30c6\u30de\u30fb\u30d5\u30a3\u30b8\u30af\u30b9\u3092\u898b\u3066\u306d\uff01\" \n    user\n  end\n  factory :user do\n    sequence(:name_twitter) { |n| \"denki#{n}\" }\n    sequence(:uid_twitter) { |n| n + 1000 }\n    point 5\n  end\n\n  factory :retweet do\n    item\n    user\n  end\nend\n\n\n\n\u53c2\u8003\nhttps://github.com/intridea/omniauth/wiki/Integration-Testing\nOmniauth\u306eGithub\u306ewiki\u306b\u306f\u3001\u30e2\u30c3\u30af\u306f\n\n:provider => 'twitter',\n\n\u3068\u3044\u3046\u98a8\u306b\u66f8\u304f\u3088\u3046\u306b\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u304c\u3001\u5b9f\u969b\u306f\u3053\u308c\u3060\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u3001Stackoverflow\u306e\nhttp://stackoverflow.com/questions/9730886/rails-rspec-and-omniauth-integration-testing\n\u3067\u6559\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u3001\u6587\u5b57\u5217\u3067\n\n\"provider\" => \"twitter\",\n\n\u3068\u66f8\u304f\u3068\u3088\u3044\u3002\n\n### \u8ffd\u8a18\u30002012/09/22\n\u30e2\u30c3\u30af\u90e8\u5206\u3001\u30b7\u30f3\u30dc\u30eb\u3060\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u3044\u306e\u3067\u6587\u5b57\u5217\u3067\"uid\"\u3068\u3044\u3046\u98a8\u306b\u66f8\u304b\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002\u4fee\u6b63\u3057\u307e\u3057\u305f\u3002\n\n\n\u521d\u3081\u3066TDD\u3092\u3084\u3063\u3066\u308b\u306e\u3067\u3059\u3051\u3069\u3001OAuth\u8a8d\u8a3c\u306e\u30c6\u30b9\u30c8\u306e\u3084\u308a\u304b\u305f\u3092\u8abf\u3079\u308b\u306e\u306b\u6642\u9593\u304c\u304b\u304b\u3063\u305f\u306e\u3067\u3001\u5f8c\u306e\u305f\u3081\u306b\u3053\u3053\u306b\u66f8\u3044\u3066\u304a\u304d\u307e\u3059\u3002\n\n```ruby:auth_spec.rb\n#coding: utf-8\nrequire 'spec_helper'\ndescribe \"A logged in user\" do\n  before do\n    OmniAuth.config.test_mode = true\n    user = FactoryGirl.create(:user)\n    OmniAuth.config.mock_auth[:twitter] = {\n      \"uid\" => \"11111\",\n      \"provider\" => \"twitter\",\n      \"info\" => {\n        \"description\" => \"\u3053\u3093\u306b\u3061\u306f\u3053\u3093\u306b\u3061\u306f\uff01\u3000\u304b\u3068\u308a\u3087\u30fc\u3067\u3059\uff01\"\n      }\n    }\n      visit \"/auth/twitter\"\n  end\n\n  after do\n    OmniAuth.config.test_mode = false\n  end\n  describe \"in items page\" do\n    it \"should add an item by the user\" do\n      visit items_path\n      click_link \"\u5ba3\u4f1d\u4e00\u89a7\"\n      click_link \"\u5ba3\u4f1d\u3092\u767b\u9332\u3059\u308b\"\n      fill_in \"item_body\", :with => \"\u30a2\u30ca\u30c6\u30de\u30fb\u30d5\u30a3\u30b8\u30af\u30b9\u3092\u305c\u3072\u30d7\u30ec\u30a4\u3057\u3066\u307f\u3066\uff01\"\n      click_button \"\u767b\u9332\"\n      click_link \"\u5ba3\u4f1d\u4e00\u89a7\"\n      page.should have_content(\"\u30a2\u30ca\u30c6\u30de\u30fb\u30d5\u30a3\u30b8\u30af\u30b9\u3092\u305c\u3072\u30d7\u30ec\u30a4\u3057\u3066\u307f\u3066\uff01\")\n      page.should have_content(\"Edit\")\n      click_link \"\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\"\n      page.should have_content(\"denki\")\n    end\n  end\nend\n```\n\n\u3067\u3059\u3002\n\n>\nOmniAuth.config.test_mode = true\n\n\u3068\n\n>\nOmniAuth.config.mock_auth[:twitter] = \uff5b:uid\u306a\u3069\uff5d\n\n\u304c\u30dd\u30a4\u30f3\u30c8\u3002\n\u30e2\u30c3\u30af\u3092auth_spec.rb\u306e\u307b\u3046\u3067\u4f5c\u3063\u3066\u3057\u307e\u3063\u3066\u3001\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u3067\u4f5c\u3063\u305f\u30e6\u30fc\u30b6\u30fc\u306b\u306f/auth/twitter\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u3082\u3089\u3046\u3053\u3068\u3067\u3001OAuth\u8a8d\u8a3c\u304c\u5b8c\u4e86\u3057\u307e\u3059\u3002OAuth\u306egem\u306fomniauth-twitter\u3092\u4f7f\u3063\u3066\u307e\u3059\u3002\n\nFactoryGirl\u3067\u4f5c\u308b\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\n```ruby:factories.rb\n#coding:utf-8\nFactoryGirl.define do\n  factory :item do\n    body \"\u30a2\u30ca\u30c6\u30de\u30fb\u30d5\u30a3\u30b8\u30af\u30b9\u3092\u898b\u3066\u306d\uff01\" \n    user\n  end\n  factory :user do\n    sequence(:name_twitter) { |n| \"denki#{n}\" }\n    sequence(:uid_twitter) { |n| n + 1000 }\n    point 5\n  end\n\n  factory :retweet do\n    item\n    user\n  end\nend\n```\n\n\n## \u53c2\u8003\nhttps://github.com/intridea/omniauth/wiki/Integration-Testing\nOmniauth\u306eGithub\u306ewiki\u306b\u306f\u3001\u30e2\u30c3\u30af\u306f\n\n>\n:provider => 'twitter',\n\n\u3068\u3044\u3046\u98a8\u306b\u66f8\u304f\u3088\u3046\u306b\u6307\u5b9a\u3055\u308c\u3066\u3044\u308b\u304c\u3001\u5b9f\u969b\u306f\u3053\u308c\u3060\u3068\u3046\u307e\u304f\u3044\u304b\u306a\u304b\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u3001Stackoverflow\u306e\nhttp://stackoverflow.com/questions/9730886/rails-rspec-and-omniauth-integration-testing\n\u3067\u6559\u3048\u3089\u308c\u308b\u3088\u3046\u306b\u3001\u6587\u5b57\u5217\u3067\n\n>\n\"provider\" => \"twitter\",\n\n\u3068\u66f8\u304f\u3068\u3088\u3044\u3002", "tags": ["Ruby", "Rails", "OmniAuth", "RSpec"]}