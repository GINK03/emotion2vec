{"context": " More than 1 year has passed since last update.\u524d\u3005\u304b\u3089\u3084\u3063\u3066\u308bTweet\u53d6\u5f97\u3092MongoDB\u306b\u6d41\u3057\u8fbc\u307f\u307e\u3059\u3002\n\u30e2\u30b8\u30e5\u30fc\u30eb\u306fMongoose\u3092\u4f7f\u3044\u307e\u3059\nhttp://mongoosejs.com/\n\nmongoose\n\nNode.js\u3067MongoDB\u3092\u4f7f\u3046\u3068\u304d\u306b\u4f7f\u3046\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002MongoDB\u516c\u5f0f\u30e2\u30b8\u30e5\u30fc\u30eb\u3088\u308a\u3082\u4eba\u6c17\u304c\u3042\u308a\u307e\u3059\u3002\n\nMongoose\u3092\u4f7f\u3063\u3066Node.js\u3068MongoDB\u306e\u63a5\u7d9a\u30b5\u30f3\u30d7\u30eb\n\u3068\u308a\u3042\u3048\u305a\u30df\u30cb\u30de\u30e0\u3063\u307d\u3044\u3082\u306e\u3092\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n$ npm install mongoose\n\n\nmongoose.js\nvar mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/n0bisuke');\n\nvar Project = mongoose.model('Project', { name: String });\n\nvar project = new Project({ name: 'ligblog' });\nproject.save(function (err) {\n  if (err) //\u5931\u6557\u6642\n  console.log('\u4fdd\u5b58\u6210\u529f');\n});\n\n\n\nQuickStart\u3092\u53c2\u8003\u306b\u3057\u3066\nhttp://mongoosejs.com/docs/guide.html\n\nmongoose.js\nvar DB_NAME = 'myapp';\n\nvar mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/'+DB_NAME);\n\nvar db = mongoose.connection;\ndb.on('error', console.error.bind(console, 'connection error:'));\ndb.once('open', function callback () {\n  console.log('connection success');\n});\n\nvar Schema   = mongoose.Schema;\n\nvar TwitterSchema = new Schema({\n    body:  {\n        text: String,\n        url: String,\n        image: String,\n        location: {\n            lat: String,\n            lon: String\n        }\n    },\n    user: {\n        twitter_id: String,\n        name: String,\n        screen_name: String,\n        description: String,\n        images: String,\n        location: {\n            lat: String,\n            lon: String\n        }\n    },\n    create_at: { type: Date, default: Date.now }\n});\n\nmongoose.model('TwModel', TwitterSchema);\nvar TwModel = mongoose.model('TwModel');\nvar twmodel = new TwModel();\n\ntwmodel.user.name = 'n0bisuke';\ntwmodel.save(function (err, data) {\n  if (err) return console.error(err);\n  console.log(data);\n});\n\n\n\u5b9f\u884c\n$ node mongoose.js\nconnection success\n{ __v: 0,\n  _id: 547c5e89993ef9e1cd5f7c39,\n  create_at: Mon Dec 01 2014 21:26:49 GMT+0900 (JST),\n  user: { name: 'n0bisuke', location: {} },\n  body: { location: {} } }\n\n\nTwitterStreamingAPI\u304b\u3089\u6d41\u3057\u8fbc\u307f\n\u4f8b\u306b\u3088\u3063\u3066\u3001\u30b5\u30f3\u30d7\u30eb\u3092\u8a66\u3057\u3066\u3044\u308b\u611f\u3058\u306a\u306e\u3067\u30d5\u30a1\u30a4\u30eb\u5206\u3051\u3068\u304b\u306f\u7121\u3057\u3067\u3059\u3002\u82e6\u7b11\n\nmongoose.js\nvar DB_NAME = 'myapp';\nvar mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/'+DB_NAME);\n\nvar db = mongoose.connection;\ndb.on('error', console.error.bind(console, 'connection error:'));\ndb.once('open', function callback () {\n  console.log('connection success');\n});\n\nvar Schema   = mongoose.Schema;\n\nvar TwitterSchema = new Schema({\n    content:  {\n        text: String,\n        url: String,\n        image: String,\n        location: {\n            lat: String,\n            lon: String\n        }\n    },\n    user: {\n        twitter_id: String,\n        name: String,\n        screen_name: String,\n        description: String,\n        images: String,\n        location: {\n            lat: String,\n            lon: String\n        }\n    },\n    create_at: { type: Date, default: Date.now }\n});\n\nmongoose.model('TwModel', TwitterSchema);\n\n/*twitter\u8a2d\u5b9a*/\nvar twitter = require('twitter');\n\nvar twit = new twitter({\n  consumer_key: 'xx',\n  consumer_secret: 'xx',\n  access_token_key: 'xx',\n  access_token_secret: 'xx'\n});\n\n/**/\n\nvar TwModel = mongoose.model('TwModel');\nvar keyword = process.argv[2]; //\u7b2c\u4e00\u5f15\u6570\nvar option = {'track': keyword};\n\nconsole.log(keyword+'\u3092\u542b\u3080\u30c4\u30a4\u30fc\u30c8\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002');\n\ntwit.stream('statuses/filter', option, function(stream) {\n    stream.on('data', function (data){\n        if(data.lang === 'ja'){\n\n            var twmodel = new TwModel();\n            twmodel.content = {\n                text: data.text\n            };\n\n            twmodel.user = {\n                screen_name: data.user.screen_name\n            };\n\n            twmodel.save(function (err, data) {\n              if (err) return console.error(err);\n              console.log(data);\n            });\n\n        }\n  });\n});\n\n\n\n\u540c\u3058\u3088\u3046\u306b\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002tweet\u3092\u53d6\u5f97\u3059\u308b\u305f\u3073\u306bMongoDB\u306b\u6d41\u3057\u8fbc\u3093\u3067\u304f\u308c\u307e\u3059\u3002\nMongoShell\u3067\u78ba\u8a8d\u3059\u308b\u3068\u3061\u3083\u3093\u3068\u4fdd\u5b58\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\n\u524d\u3005\u304b\u3089\u3084\u3063\u3066\u308bTweet\u53d6\u5f97\u3092MongoDB\u306b\u6d41\u3057\u8fbc\u307f\u307e\u3059\u3002\n\u30e2\u30b8\u30e5\u30fc\u30eb\u306fMongoose\u3092\u4f7f\u3044\u307e\u3059\n\nhttp://mongoosejs.com/\n\n\n##mongoose\n\n![](http://i.gyazo.com/f2fc5fb15f9c3e2347ea2690c5429708.png)\n\nNode.js\u3067MongoDB\u3092\u4f7f\u3046\u3068\u304d\u306b\u4f7f\u3046\u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u3059\u3002MongoDB\u516c\u5f0f\u30e2\u30b8\u30e5\u30fc\u30eb\u3088\u308a\u3082\u4eba\u6c17\u304c\u3042\u308a\u307e\u3059\u3002\n\n## Mongoose\u3092\u4f7f\u3063\u3066Node.js\u3068MongoDB\u306e\u63a5\u7d9a\u30b5\u30f3\u30d7\u30eb\n\n\u3068\u308a\u3042\u3048\u305a\u30df\u30cb\u30de\u30e0\u3063\u307d\u3044\u3082\u306e\u3092\u66f8\u3044\u3066\u307f\u307e\u3059\u3002\n\n```\n$ npm install mongoose\n```\n\n\n```mongoose.js\nvar mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/n0bisuke');\n\nvar Project = mongoose.model('Project', { name: String });\n\nvar project = new Project({ name: 'ligblog' });\nproject.save(function (err) {\n  if (err) //\u5931\u6557\u6642\n  console.log('\u4fdd\u5b58\u6210\u529f');\n});\n```\n\n\n\n![](http://i.gyazo.com/01610c83f7c0f34c6d6b9b5775d25c61.png)\n\n\nQuickStart\u3092\u53c2\u8003\u306b\u3057\u3066\nhttp://mongoosejs.com/docs/guide.html\n\n\n\n\n```mongoose.js\nvar DB_NAME = 'myapp';\n\nvar mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/'+DB_NAME);\n\nvar db = mongoose.connection;\ndb.on('error', console.error.bind(console, 'connection error:'));\ndb.once('open', function callback () {\n  console.log('connection success');\n});\n\nvar Schema   = mongoose.Schema;\n\nvar TwitterSchema = new Schema({\n\tbody:  {\n\t\ttext: String,\n\t\turl: String,\n\t\timage: String,\n\t\tlocation: {\n\t\t\tlat: String,\n\t\t\tlon: String\n\t\t}\n\t},\n\tuser: {\n\t\ttwitter_id: String,\n\t\tname: String,\n\t\tscreen_name: String,\n\t\tdescription: String,\n\t\timages: String,\n\t\tlocation: {\n\t\t\tlat: String,\n\t\t\tlon: String\n\t\t}\n\t},\n\tcreate_at: { type: Date, default: Date.now }\n});\n\nmongoose.model('TwModel', TwitterSchema);\nvar TwModel = mongoose.model('TwModel');\nvar twmodel = new TwModel();\n\ntwmodel.user.name = 'n0bisuke';\ntwmodel.save(function (err, data) {\n  if (err) return console.error(err);\n  console.log(data);\n});\n```\n\n\u5b9f\u884c\n\n```\n$ node mongoose.js\nconnection success\n{ __v: 0,\n  _id: 547c5e89993ef9e1cd5f7c39,\n  create_at: Mon Dec 01 2014 21:26:49 GMT+0900 (JST),\n  user: { name: 'n0bisuke', location: {} },\n  body: { location: {} } }\n```\n\n##TwitterStreamingAPI\u304b\u3089\u6d41\u3057\u8fbc\u307f\n\n\u4f8b\u306b\u3088\u3063\u3066\u3001\u30b5\u30f3\u30d7\u30eb\u3092\u8a66\u3057\u3066\u3044\u308b\u611f\u3058\u306a\u306e\u3067\u30d5\u30a1\u30a4\u30eb\u5206\u3051\u3068\u304b\u306f\u7121\u3057\u3067\u3059\u3002\u82e6\u7b11\n\n```mongoose.js\nvar DB_NAME = 'myapp';\nvar mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/'+DB_NAME);\n\nvar db = mongoose.connection;\ndb.on('error', console.error.bind(console, 'connection error:'));\ndb.once('open', function callback () {\n  console.log('connection success');\n});\n\nvar Schema   = mongoose.Schema;\n\nvar TwitterSchema = new Schema({\n\tcontent:  {\n\t\ttext: String,\n\t\turl: String,\n\t\timage: String,\n\t\tlocation: {\n\t\t\tlat: String,\n\t\t\tlon: String\n\t\t}\n\t},\n\tuser: {\n\t\ttwitter_id: String,\n\t\tname: String,\n\t\tscreen_name: String,\n\t\tdescription: String,\n\t\timages: String,\n\t\tlocation: {\n\t\t\tlat: String,\n\t\t\tlon: String\n\t\t}\n\t},\n\tcreate_at: { type: Date, default: Date.now }\n});\n\nmongoose.model('TwModel', TwitterSchema);\n\n/*twitter\u8a2d\u5b9a*/\nvar twitter = require('twitter');\n\nvar twit = new twitter({\n  consumer_key: 'xx',\n  consumer_secret: 'xx',\n  access_token_key: 'xx',\n  access_token_secret: 'xx'\n});\n\n/**/\n\nvar TwModel = mongoose.model('TwModel');\nvar keyword = process.argv[2]; //\u7b2c\u4e00\u5f15\u6570\nvar option = {'track': keyword};\n\nconsole.log(keyword+'\u3092\u542b\u3080\u30c4\u30a4\u30fc\u30c8\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002');\n\ntwit.stream('statuses/filter', option, function(stream) {\n\tstream.on('data', function (data){\n\t\tif(data.lang === 'ja'){\n\t\t\t\n\t\t\tvar twmodel = new TwModel();\n\t\t\ttwmodel.content = {\n\t\t\t\ttext: data.text\n\t\t\t};\n\n\t\t\ttwmodel.user = {\n\t\t\t\tscreen_name: data.user.screen_name\n\t\t\t};\n\n\t\t\ttwmodel.save(function (err, data) {\n\t\t\t  if (err) return console.error(err);\n\t\t\t  console.log(data);\n\t\t\t});\n\n\t\t}\n  });\n});\n\n```\n\n\u540c\u3058\u3088\u3046\u306b\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002tweet\u3092\u53d6\u5f97\u3059\u308b\u305f\u3073\u306bMongoDB\u306b\u6d41\u3057\u8fbc\u3093\u3067\u304f\u308c\u307e\u3059\u3002\n\nMongoShell\u3067\u78ba\u8a8d\u3059\u308b\u3068\u3061\u3083\u3093\u3068\u4fdd\u5b58\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n![](http://i.gyazo.com/b7c7ed81a1fa7823941a2c6dadbc9af4.png)\n\n", "tags": ["JavaScript", "mongoose", "Twitter", "MongoDB", "Node.js"]}