{"tags": ["Rails", "Capybara", "Ruby", "RSpec"], "context": " More than 1 year has passed since last update.\u5927\u3044\u306b\u306f\u307e\u3063\u305f\u306e\u3067\u30fb\u30fb\u30fb\u3002\n\u4e3b\u306bdelete\u306e\u6642\u306ecomfirm\u306f\u3069\u3046\u3059\u308b\u304b\u3068\u3001\u30cd\u30b9\u30c8\u306b\u3064\u3044\u3066\ngem\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u8a2d\u5b9a\u306f\u3067\u304d\u3066\u308b\u3082\u306e\u3068\u3057\u3066\u30fb\u30fb\u30fb\u3002\n\u3059\u3044\u307e\u305b\u3093\u3001\u3054\u6307\u6458\u3044\u305f\u3060\u3044\u305f\u306e\u3067\u8a18\u8f09\u3057\u307e\u3059\u3002\u4f55\u304b\u4e0d\u8db3\u306a\u70b9\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3067\u3059\u304c\uff08\u6c57\u3000\u9060\u616e\u306a\u304f\u3054\u6307\u6458\u3044\u305f\u3060\u3051\u308b\u3068\u5e78\u3044\u3067\u3059\u3002\nGemfile \ngem 'capybara'\ngem 'capybara-webkit'\n\nrails_helper.rb\u5185\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\nCapybara.javascript_driver = :webkit\n\n\u52d5\u4f5c\uff1a  \n\n\nshow\u306b'Delete'\u30ea\u30f3\u30af\u3060\u3051\u304c\u3042\u308b\n\u7121\u4e8b\u524a\u9664\u3067\u304d\u305f\u3089\u30eb\u30fc\u30c8\u3078\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3001\"Successfully Deleted a Pin\"\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u3059\n\nrequire 'rails_helper'\n\nRSpec.feature \"Deleting Hoges\", type: :feature, js: true do\n  let(:hoge) { FactoryGirl.create(:hoge) }\n\n  background do\n    visit hoge_path(hoge)\n\n    expect(page).to have_link 'Delete', href: hoge_path(hoge)\n\n    link = find_link 'Delete'\n    expect(link['data-confirm']).to eq 'Are you sure?'\n  end\n\n\n  scenario \"Accepting a confirm\" do\n    page.accept_confirm 'Are you sure?' do\n      click_link 'Delete'\n    end\n    expect(current_path).to eq root_path\n    within '.alert' do\n      expect(page).to have_content \"Successfully Deleted a hoge\"\n    end\n  end\n\n  scenario \"Dissmissing a confirm\" do\n    page.dismiss_confirm 'Are you sure?' do\n      click_link 'Delete'\n    end\n    expect(current_path).to eq hoge_path(hoge)\n  end\nend\n\nfeature\u306e\u884c\u306b, js: true\u3092\u8ffd\u52a0\u3059\u308b\u306e\u3092\u5fd8\u308c\u305a\u306b\u3002\n\u307e\u305a\u3001background\u5185\u3067\u30da\u30fc\u30b8\u306bvisit\u3057\u3066\u304a\u304f\u3002before\u307f\u305f\u3044\u306a\u3082\u306e\uff1f\n\u3064\u3044\u3067\u306b'Delete'\u30ea\u30f3\u30af\u306edata-confirm\u306e\u5024\u3092\u78ba\u8a8d\u3002\npage.accept_confirm\u3092\u4f7f\u3046\u3002\u305d\u308c\u306b\u30d6\u30ed\u30c3\u30af\u3092\u6e21\u3059\u3002\n\u30d6\u30ed\u30c3\u30af\u5185\u306b\u306f\u305d\u306econfirm\u3092\u767a\u706b\u3055\u305b\u308b\u52d5\u4f5c\u3002\u3053\u306e\u5834\u5408\u306f'Delete'\u3068\u3044\u3046\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3002\nbackground\u5185\u3067\u4e00\u5fdc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u5185\u5bb9\u306f\u78ba\u8a8d\u3057\u3066\u3044\u308b\u304c\u3001\u5b9f\u969b\u306b\u8868\u793a\u3055\u308c\u308b\u304b\u3069\u3046\u304b\u3001\u3063\u3066\u3068\u3053\u308d\u3067page.accept_confirm 'Are you sure?'\u3068\u3059\u308b\u3002\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u6307\u5b9a\u3057\u306a\u304f\u3066\u3082\u3044\u3044\u304b\u3082\u3060\u3051\u3069\u3002\nhttp://stackoverflow.com/questions/26275359/deprecation-warning-from-capybara\naccept_js_confirm\u3068\u3044\u3046\u306e\u304cdeprecated\u306b\u306a\u3063\u3066\u305f\u3002\u65b0\u3057\u3044\u60c5\u5831\u304c\u5c11\u306a\u304b\u3063\u305f\u30fb\u30fb\u30fb\u3002\n\u3067\u3001OK\u3092\u62bc\u3057\u305f\u5834\u5408\u3068\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u305f\u5834\u5408\u306e\uff12\u3064\u306b\u5206\u5c90\u3057\u305f\u3044\u3002  \nhttp://tirdadc.github.io/blog/2014/09/11/nested-feature-tests-with-capybara-and-rspec/\n\u30cd\u30b9\u30c8\u306f\u3053\u3053\u3067\u30de\u30fc\u30b8\u3055\u308c\u305f\u6a21\u69d8\u3002\nhttps://github.com/jnicklas/capybara/commit/61524b0fd32a1fb55b82853bdc4a0293e9fcdef0\n\u3042\u3068\u306fcurrent_path\u3068\u304b\u4fbf\u5229\u3002\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u304b\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3057\u305f\u5f8c\u306e\u753b\u9762\u306e\u30d1\u30b9\u78ba\u8a8d\nhttp://stackoverflow.com/questions/21592115/javascript-confirmation-dialog-in-capybara-webkit-driver\n\n\u5927\u3044\u306b\u306f\u307e\u3063\u305f\u306e\u3067\u30fb\u30fb\u30fb\u3002  \n\u4e3b\u306bdelete\u306e\u6642\u306ecomfirm\u306f\u3069\u3046\u3059\u308b\u304b\u3068\u3001\u30cd\u30b9\u30c8\u306b\u3064\u3044\u3066\n\n~~gem\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u8a2d\u5b9a\u306f\u3067\u304d\u3066\u308b\u3082\u306e\u3068\u3057\u3066\u30fb\u30fb\u30fb\u3002~~\n\n\u3059\u3044\u307e\u305b\u3093\u3001\u3054\u6307\u6458\u3044\u305f\u3060\u3044\u305f\u306e\u3067\u8a18\u8f09\u3057\u307e\u3059\u3002\u4f55\u304b\u4e0d\u8db3\u306a\u70b9\u304c\u3042\u308b\u304b\u3082\u3057\u308c\u306a\u3044\u3067\u3059\u304c\uff08\u6c57\u3000\u9060\u616e\u306a\u304f\u3054\u6307\u6458\u3044\u305f\u3060\u3051\u308b\u3068\u5e78\u3044\u3067\u3059\u3002\n\n``Gemfile``  \n\n```ruby\ngem 'capybara'\ngem 'capybara-webkit'\n```\n\n``rails_helper.rb``\u5185\u306b\u4ee5\u4e0b\u3092\u8ffd\u8a18\n\n```ruby\nCapybara.javascript_driver = :webkit\n```\n\n\u52d5\u4f5c\uff1a  \n\n- ``show``\u306b'Delete'\u30ea\u30f3\u30af\u3060\u3051\u304c\u3042\u308b\n- \u7121\u4e8b\u524a\u9664\u3067\u304d\u305f\u3089\u30eb\u30fc\u30c8\u3078\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3001``\"Successfully Deleted a Pin\"``\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u3059\n\n```ruby\nrequire 'rails_helper'\n\nRSpec.feature \"Deleting Hoges\", type: :feature, js: true do\n  let(:hoge) { FactoryGirl.create(:hoge) }\n\n  background do\n    visit hoge_path(hoge)\n\n    expect(page).to have_link 'Delete', href: hoge_path(hoge)\n\n    link = find_link 'Delete'\n    expect(link['data-confirm']).to eq 'Are you sure?'\n  end\n\n\n  scenario \"Accepting a confirm\" do\n    page.accept_confirm 'Are you sure?' do\n      click_link 'Delete'\n    end\n    expect(current_path).to eq root_path\n    within '.alert' do\n      expect(page).to have_content \"Successfully Deleted a hoge\"\n    end\n  end\n\n  scenario \"Dissmissing a confirm\" do\n    page.dismiss_confirm 'Are you sure?' do\n      click_link 'Delete'\n    end\n    expect(current_path).to eq hoge_path(hoge)\n  end\nend\n```\n\n``feature``\u306e\u884c\u306b``, js: true ``\u3092\u8ffd\u52a0\u3059\u308b\u306e\u3092\u5fd8\u308c\u305a\u306b\u3002\n\n\u307e\u305a\u3001``background``\u5185\u3067\u30da\u30fc\u30b8\u306b``visit``\u3057\u3066\u304a\u304f\u3002``before``\u307f\u305f\u3044\u306a\u3082\u306e\uff1f\n\n\u3064\u3044\u3067\u306b'Delete'\u30ea\u30f3\u30af\u306e``data-confirm``\u306e\u5024\u3092\u78ba\u8a8d\u3002\n\n``page.accept_confirm``\u3092\u4f7f\u3046\u3002\u305d\u308c\u306b\u30d6\u30ed\u30c3\u30af\u3092\u6e21\u3059\u3002  \n\u30d6\u30ed\u30c3\u30af\u5185\u306b\u306f\u305d\u306econfirm\u3092\u767a\u706b\u3055\u305b\u308b\u52d5\u4f5c\u3002\u3053\u306e\u5834\u5408\u306f'Delete'\u3068\u3044\u3046\u30ea\u30f3\u30af\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3002\n\n``background``\u5185\u3067\u4e00\u5fdc\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u5185\u5bb9\u306f\u78ba\u8a8d\u3057\u3066\u3044\u308b\u304c\u3001\u5b9f\u969b\u306b\u8868\u793a\u3055\u308c\u308b\u304b\u3069\u3046\u304b\u3001\u3063\u3066\u3068\u3053\u308d\u3067``page.accept_confirm 'Are you sure?'``\u3068\u3059\u308b\u3002\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u6307\u5b9a\u3057\u306a\u304f\u3066\u3082\u3044\u3044\u304b\u3082\u3060\u3051\u3069\u3002\n\nhttp://stackoverflow.com/questions/26275359/deprecation-warning-from-capybara\n\n``accept_js_confirm``\u3068\u3044\u3046\u306e\u304cdeprecated\u306b\u306a\u3063\u3066\u305f\u3002\u65b0\u3057\u3044\u60c5\u5831\u304c\u5c11\u306a\u304b\u3063\u305f\u30fb\u30fb\u30fb\u3002\n\n\u3067\u3001OK\u3092\u62bc\u3057\u305f\u5834\u5408\u3068\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u305f\u5834\u5408\u306e\uff12\u3064\u306b\u5206\u5c90\u3057\u305f\u3044\u3002  \n\nhttp://tirdadc.github.io/blog/2014/09/11/nested-feature-tests-with-capybara-and-rspec/\n\n\u30cd\u30b9\u30c8\u306f\u3053\u3053\u3067\u30de\u30fc\u30b8\u3055\u308c\u305f\u6a21\u69d8\u3002\n\nhttps://github.com/jnicklas/capybara/commit/61524b0fd32a1fb55b82853bdc4a0293e9fcdef0\n\n\u3042\u3068\u306f``current_path``\u3068\u304b\u4fbf\u5229\u3002\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u304b\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u3057\u305f\u5f8c\u306e\u753b\u9762\u306e\u30d1\u30b9\u78ba\u8a8d\n\nhttp://stackoverflow.com/questions/21592115/javascript-confirmation-dialog-in-capybara-webkit-driver\n"}