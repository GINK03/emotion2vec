{"context": "\n\nChatOps run on on-premises.\n\n0.\u3000\u306f\u3058\u3081\u306b\nSlack\u306eClone\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3068\u8a00\u308f\u308c\u3066\u3044\u308b Mattermost \u3092\u4f7f\u3063\u3066\n\u30aa\u30f3\u30d7\u30ec\u30df\u30b9\u74b0\u5883\u3067ChatOps\u7684\u306a\u3053\u3068\u3092\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u4eca\u56deHubot\u306a\u3069\u3092\u9593\u306b\u5165\u308c\u305a\u306bMattermost,Gitlab,Jenkins\u306e\u307f\u3067\u69cb\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001\u5341\u5206\u306a\u691c\u8a3c\u304c\u884c\u3048\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u306e\u3067\u691c\u8a3c\u74b0\u5883\u7b49\u3067\u306e\u30c7\u30e2\u3001\u7d20\u632f\u308a\u7528\u306a\u3069\u306b\u9650\u5b9a\u3057\u3066\u304a\u4f7f\u3044\u304f\u3060\u3055\u3044\u3002\n\u307e\u305f\u3001Gitlab\u53ca\u3073Mattermost\u3001Jenkins\u306f\u3059\u3067\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u524d\u63d0\u3067\u3059\u3002\n\u6642\u9593\u306b\u4f59\u88d5\u304c\u3042\u308b\u3068\u304d\u306b\u3001\u74b0\u5883\u69cb\u7bc9\u90e8\u5206\u306b\u3064\u3044\u3066\u306f\u5225\u8a18\u4e8b\u3068\u3057\u3066\u63b2\u8f09\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n2016/9/26\u8ffd\u8a18\uff1a\u4ee5\u4e0b\u306b\u74b0\u5883\u69cb\u7bc9\u306e\u8a18\u4e8b\u3092\u63b2\u8f09\u3057\u307e\u3057\u305f\u3002\nhttp://qiita.com/tbuchi888/items/66763a9af2e15fa74a3c\n\u307e\u305f\u3001Jenkins2\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u3082\u53c2\u7167\u3057\u3066\u9802\u3051\u308c\u3070\u3068\u601d\u3044\u307e\u3059\u3002\nhttp://qiita.com/tbuchi888/items/3c65cb4757225b09f08f\n\n\n1.\u3000\u9023\u643a\u6982\u8981\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a4\u30e1\u30fc\u30b8\u3067\u3000Mattermost \u3068 Gitlab \u3068 Jenkins \u3092 \u9023\u643a\u3055\u305b\u307e\u3059\u3002\n\n1.\u3000\u30c7\u30d9\u30ed\u30c3\u30d1\u30fc\u304cGitab\u3078git push\u3092\u3059\u308b\u3068Mattermost\u306e\u5bfe\u8c61\u30c1\u30e3\u30f3\u30cd\u30eb\uff08\u4ee5\u964dChat\uff09\u306bGitLab\u304b\u3089push\u306e\u60c5\u5831\u304c\u901a\u77e5\u304c\u3055\u308c\u307e\u3059\u3002\n\u3000\u3000-\u3000Gitlab\u306eSlack\u30b5\u30fc\u30d3\u30b9\u3000\u3068\u3000Mattermost\u306eIncoming\u3000Webhook\u3067\u9023\u643a\n2.\u3000\u30aa\u30da\u30ec\u30fc\u30bf\u304cChat\u3067git push\u306e\u5185\u5bb9\u3092chat\u306elink\u304b\u3089\u78ba\u8a8d\u3057\u3066\u554f\u984c\u306a\u3051\u308c\u3070\u3001\"Build!!\"\uff08\u4efb\u610f\u306e\u4e88\u3081\u767b\u9332\u3057\u305f\u6587\u5b57\u5217\uff09\u3068\u5165\u529b\u3059\u308b\u3053\u3068\u3067Jenkins\u3078\u30d3\u30eb\u30c9\u306e\u6307\u793a\u3092\u51fa\u3057\u307e\u3059\u3002\n\u3000\u3000-\u3000Mattermost\u306eOutGoing Webhook \u3068 Jenkins\u306e Build Triggers\u3067\u9023\u643a\n3.\u3000Jenkins\u304cGitlab\u304b\u3089\u5bfe\u8c61\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u3066\u30d3\u30eb\u30c9\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\n\u3000\u3000-\u3000Jenkins\u306eSouce Code Mangement\uff08gitlab-plugin\uff09\u3067\u9023\u643a\n4.\u3000Jenkins\u304c\u30d3\u30eb\u30c9\u7d50\u679c\u3092Chat\u306b\u901a\u77e5\u3057\u307e\u3059\u3002\n\u3000\u3000-\u3000Jenkins\u306ePost-build Actions\u3068Mattermost\u306eIncoming Webhook\u3067\u9023\u643a\n5.\u3000\u30aa\u30da\u30ec\u30fc\u30bf\u304cChat\u3067\u7d50\u679c\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u4ee5\u4e0b\u306fChat\u90e8\u5206\u3092\u62e1\u5927\u3057\u305f\u3082\u306e\n\n\n2. \u4f7f\u3044\u3069\u3053\u308d\n\u4eca\u56de\u8a66\u3057\u305f\u306e\u306f\u3001\u30b7\u30f3\u30d7\u30eb\u306bJenkins\u306e\u30d3\u30eb\u30c9\u3092\u884c\u3046\u307e\u3067\u3067\u3059\u304c\u3001\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30d7\u30ed\u30a4\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u4ed6\u30c4\u30fc\u30eb\uff08Digdag,terraform,Vagrant\uff08vsphere-plugin\uff09\u3084Ansible,Serverspec\u306a\u3069\u306a\u3069\uff09\u3092Jenkins\u3088\u308a\u5b9f\u884c\u3059\u308b\u90e8\u5206\u3082\u30b7\u30a7\u30eb\u7b49\u3067\u30b3\u30fc\u30c9\u5316\u3057\u9023\u643a\u3059\u308b\u3053\u3068\u3067\u3001git\u3000push\u3068\u3001Chat\u304b\u3089\u306e\u6307\u793a\u306e\u307f\u3067\u4f8b\u3048\u3070\u30c6\u30b9\u30c8\u6e08\u307f\u306eWeb\u30b5\u30fc\u30d0\u3092\u307e\u308b\u3063\u3068\u81ea\u52d5\u3067\u30b9\u30af\u30e9\u30c3\u30d7\u30a2\u30f3\u30c9\u30d3\u30eb\u30c9\u3059\u308b\u306a\u3069\u3001\u30aa\u30f3\u30d7\u30ec\u30df\u30b9\u3067\u3082\u9762\u767d\u3044\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n3. \u74b0\u5883\nVirtualBox on OSX Yosemite\u306eVM\u3068\u3057\u3066Gitlab/Mattermost\u30b5\u30fc\u30d0\u3068Jekins\u30b5\u30fc\u30d0\u306e2\u53f0\u69cb\u6210\u3067\u691c\u8a3c\u3057\u307e\u3057\u305f\u3002\n\u306a\u304a\u3001\u4e21\u30b5\u30fc\u30d0\u3067\u540d\u524d\u89e3\u6c7a\u53ef\u80fd\u306a\u3088\u3046\u306bJenkinssv\u53ca\u3073mygitlabsv\u306eIP\u30a2\u30c9\u30ec\u30b9\u306f\u30db\u30b9\u30c8\uff08OSX\uff09\u306ehosts\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n\nOS Ver.\nOSS Ver.\nmemo\n\n\n\n\nCentOS6.8\nGitlabCE ver.8.11.2\n\n\n\n-\nMattermost ver.3.30\non GitlabCE\n\n\nCentOS6.8\nJenkins ver.2.19\n\n\n\n-\n-\nGitlab Plagin ver.1.3.0\n\n\n-\n-\nMattermost Plugin ver.2.0.2\n\n\n\n\n4. \u4e8b\u524d\u6e96\u5099\u6982\u8981\n\nMattermost\u3000\u3067\n\n\n\u4eca\u56de\u7528\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nGitlab\u3000\u53ca\u3073\u3000Jenkins\u3068\u9023\u643a\u3059\u308b\u305f\u3081\u306bIncommin/Outgoing Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\nGitlab\u3067\n\n\n\u4eca\u56de\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\n\u30b5\u30fc\u30d3\u30b9-Slack\u3000\u3067\u3000Mattermost\u306eIncoming\u3000Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\nJenkins\u3000\u3067\u3000\n\n\n\u30d7\u30e9\u30b0\u30a4\u30f3\uff08gitlab\u53ca\u3073mattermost\uff09\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u4eca\u56de\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\n\n\nBuild Triggers\u3067Mattermost\u306eOutGoing Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nPost-build Actions\u3067Mattermost\u306eIncoming Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nSouce Code Mangement\uff08gitlab-plugin\uff09\u3067Gitlab\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\n\n\n\n\n4.1 Mattermost\u306e\u8a2d\u5b9a\n\n1. \u4eca\u56de\u7528\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\uff08\u4eca\u56de\u306e\u4f8b\u3067\u306fjenkins\u3068\u3044\u3046\u540d\u524d\u3067\u4f5c\u6210\uff09\n2. Gitlab\u53ca\u3073Jenkins\u3068\u5916\u90e8\u9023\u643a\u3059\u308b\u305f\u3081\u306bIncommin/Outgoing Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n3. \u521d\u671f\u72b6\u614b\u3067\u306fWebhook\u304c\u5229\u7528\u3067\u304d\u306a\u3044\u306e\u3067Sysytem\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089Custom Integrations\u306e\u8a2d\u5b9a\u3092\u6709\u52b9\uff08true\uff09\u306b\u3057\u3066save\u3057\u3066\u304b\u3089\u3001\u753b\u9762\u5de6\u4e0a\u30e1\u30cb\u30e5\u30fc\u306eSwitch to \u30c1\u30fc\u30e0\u540d\u3088\u308a\u3001Sysytem\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u629c\u3051\u307e\u3059\u3002\u306a\u304a\u3001\u8a2d\u5b9a\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n4. Integrations\u30e1\u30cb\u30e5\u30fc\u304b\u3089Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3000\n5.\u3000Gitlab \u53ca\u3073 Jenkins\u3068\u9023\u643a\u3059\u308b\u305f\u3081\u306bIncoming Webhook\u3092\u305d\u308c\u305e\u308c\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u307e\u305f\u30c1\u30e3\u30f3\u30cd\u30eb\u306f\u3001\u3055\u304d\u307b\u3069\u4f5c\u6210\u3057\u305fjenkins\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u4ee5\u4e0bGitlab\u5411\u3051\n\n\u4ee5\u4e0bJenkins\u5411\u3051\n\n\u306a\u304a\u3001\u8a2d\u5b9a\u5185\u5bb9\uff08URL\uff09\u306f\u3042\u3068\u3067\u5229\u7528\u3059\u308b\u306e\u3067\u63a7\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n\n6.\u3000Jenkins\u3068\u9023\u643a\u3059\u308b\u305f\u3081\u306bOutgoing Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30c1\u30e3\u30f3\u30cd\u30eb\u306f\u3001\u3055\u304d\u307b\u3069\u4f5c\u6210\u3057\u305fjenkins\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nTriiger Words(One Per Line)\u306b\u3066Build\u306e\u6307\u793a\u3092\u51fa\u3059\u8a00\u8449\uff08\u4eca\u56de\u306e\u4f8b\u3067\u306fBuild!!\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nCallBack URLs(One Per Line)\u3078Jenkins\u306e\u5bfe\u8c61\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092JENKINS\u306eURL/job/\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d/build?\u3068\u3044\u3046\u5f62\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\uff08\u4eca\u56de\u306e\u4f8b\u3067\u306fhttp://myjenkinssv:8080/job/mattermost/build?\uff09\n\n\u306a\u304a\u3001\u8a2d\u5b9a\u5185\u5bb9(token)\u306f\u3042\u3068\u3067\u5229\u7528\u3059\u308b\u306e\u3067\u63a7\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n\n\n4.2 Gitlab\u306e\u8a2d\u5b9a\n\n\n\u4eca\u56de\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u307e\u305f\u5f8c\u306e\u52d5\u4f5c\u78ba\u8a8d\u306e\u305f\u3081\u3001\u4f55\u304b\u3057\u3089\u306e\u30b3\u30fc\u30c9\u3092\u767b\u9332\u3057\u3066\u30b3\u30df\u30c3\u30c8\u3092\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a-\u30b5\u30fc\u30d3\u30b9\u3088\u308aSlack\u3000\u3092\u6709\u52b9\u306b\u3057\u3066\u3000Mattermost\u306eIncoming\u3000Webhook\u306eURL\uff08\uff14\uff0e\uff11\uff0e\uff15\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\n\u203b\u4ee5\u4e0b\u306f\u753b\u9762\u53d6\u308a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u306e\u95a2\u4fc2\u3067\u65e2\u306bSlack\u304c\u6709\u52b9\u306a\u305f\u3081\u30a2\u30a4\u30b3\u30f3\u304c\u30b0\u30ea\u30fc\u30f3\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u8a2d\u5b9a\u524d\u306f\u30b0\u30ec\u30fc\u3068\u306a\u308a\u307e\u3059\u3002\n\nActive\u306b\u30c1\u30a7\u30c3\u30af\u3092\u3064\u3051\u3066Slack\u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\nWebhook\u3078\u3000Mattermost\u306eIncoming\u3000Webhook\u306eURL\uff08\uff14\uff0e\uff11\uff0e\uff15\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002Username\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\uff08\u4eca\u56de\u306e\u4f8b\u3067\u306fgitlab\uff09\nSave Change\u5f8c\u306bTest\u3000setting \u30dc\u30bf\u30f3\u3088\u308a\u30c6\u30b9\u30c8\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u9001\u4fe1\u304c\u6b63\u5e38\u306b\u7d42\u4e86\u3059\u308b\u3053\u3068\u53ca\u3073Chat\u5074\u306b\u30c6\u30b9\u30c8\u306epush\u901a\u77e5\u304c\u9001\u3089\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\n4.3 Jenkins\u306e\u8a2d\u5b9a\n\n\n\u7ba1\u7406\u6a5f\u80fd\u3088\u308a\u30d7\u30e9\u30b0\u30a4\u30f3\uff08gitlab\u53ca\u3073mattermost\uff09\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n\n\n\u4eca\u56de\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306e\u4f8b\u3067\u306f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u306fmattermost\u3067\u8a2d\u5b9a\n\n\n\nSouce Code Mangement\u30bf\u30d6\u3067Gitlab\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nBuild Triggers\u30bf\u30d6\u3067Mattermost\u306eOutGoing Webhook\u306etoken\uff08\uff14\uff0e\uff11\uff0e\uff16\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nPost-build Actions\u30bf\u30d6\u306eMattermost Notifications\u306eAdvanced\u8a2d\u5b9a\u3067\nEndpoint\u3078Mattermost\u3067\u306eIncoming Webhook\u306eURL\uff08\uff14\uff0e\uff11\uff0e\uff15\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\uff09\u3092\u3001Project Channel\u3078jenkins\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\n\u306a\u304a\u3001Gitlab\u306e\u8a8d\u8a3c\u306b\u5931\u6557\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002\n\nJenkins\u5074\u3000\u8a2d\u5b9a\u3000\u3000\u3000\n\n\u3000Jenkins\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8a2d\u5b9a\u3000bash\u6709\u52b9\u5316\nroot\u30a2\u30ab\u30a6\u30f3\u30c8\u304bsudo\u3067Jenkins\u30b5\u30fc\u30d0\u3078CLI\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3001vi /etc/passwd\u7b49\u3067jenkins\u884c\u306e\u6700\u5f8c\u3092false\u304b\u3089bash\u306b\u5909\u3048\u307e\u3059\u3002\n\u5909\u66f4\u524d\u4f8b\njenkins:x:498:498:Jenkins Continuous Integration Server:/var/lib/jenkins:/bin/false\n\u5909\u66f4\u5f8c\u4f8b\njenkins:x:498:498:Jenkins Continuous Integration Server:/var/lib/jenkins:/bin/bash\n\n\u3000Jenkins\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8a2d\u5b9a\u3000SSH key\u306e\u4f5c\u6210\njenkins\u30a2\u30ab\u30a6\u30f3\u30c8\u3067SSH key\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n#su jenkins\nbash-4.1$ mkdir .ssh\nbash-4.1$ chmod 700 .ssh/\nbash-4.1$ cd .ssh/\nbash-4.1$ ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/var/lib/jenkins/.ssh/id_rsa):\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in /var/lib/jenkins/.ssh/id_rsa.\nYour public key has been saved in /var/lib/jenkins/.ssh/id_rsa.pub.\nThe key fingerprint is:\n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\nbash-4.1$ cat id_rsa.pub\nssh-rsa \n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e jenkins@JENKINS_SERVER\n# \u3053\u306e\u4e2d\u8eab\u3092gitlab\u306ejenkins\u30e6\u30fc\u30b6\u306esshkey\u3068\u3057\u3066\u767b\u9332\u3059\u308b\n\n~/.ssh/config\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\u3053\u308c\u304c\u306a\u3044\u3068SSH\u304c\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3068\u306a\u308aPermission denied\u30a8\u30e9\u30fc\u3068\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001user\u3092git\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u3059\u308b\u3068\u3053\u308d\u304c\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002\nbash-4.1$ vi ~/.ssh/config\n\n\uff03\u3000\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306e\u5909\u66f4\u3082\u5fd8\u308c\u305a\u306b\u3059\u308b\nbash-4.1$ chmod 644 config\n\nbash-4.1$ cat\u3000~/.ssh/config\nhost GITLABSERVER\n  HostName GITLABSERVER\n  User git\n  Port 22\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /var/lib/jenkins/.ssh/id_rsa\n  IdentitiesOnly yes\n  LogLevel FATAL\n\nGUI\u753b\u9762\u304b\u3089Jenkins\u306e\u5bfe\u8c61\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306eSouce Code Mangement\u30bf\u30d6\u306eCredentials\u3067\u4ee5\u4e0b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n-\u3000\u30b9\u30b3\u30fc\u30d7\u30b0\u30ed\u30fc\u30d0\u30eb\n-\u3000\u30e6\u30fc\u30b6\u30fc\u540d jenkins\n-\u3000\u79d8\u5bc6\u9375\u3000Jenkins\u30de\u30b9\u30bf\u30fc\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3092\u9078\u629e\u3057\u3066/var/lib/jenkins/.ssh/id_rsa\u3092\u5165\u529b\n-\u3000\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff1a\u9375\u751f\u6210\u306e\u6642\u306b\u3057\u3066\u3044\u3057\u305f\u3082\u306e\u3002\u306a\u3057\u306e\u5834\u5408\u306f\u521d\u671f\u8868\u793a\u3092\u6d88\u3059\u3002\n\nGitlab \u5074\nJenkins\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306e\u5c02\u7528\u30e6\u30fc\u30b6\u30fc\u3092Gitlab\u306b\u4f5c\u6210\u3057\u3001jenkins\u30b5\u30fc\u30d0\u306ejenkins\u30e6\u30fc\u30b6\u30fc\u306eid_rsa.pub\u3092sshkey\u3068\u3057\u3066\u767b\u9332\u3057\u307e\u3059\u3002\n\n\n5.\u5b9f\u884c\u4f8b\n\u4ee5\u4e0bChat\u306e\u5b9f\u884c\u4f8b\uff08\u518d\u63b2\uff09\n\n\n6.\u305d\u306e\u4ed6\u30cf\u30de\u308a\u3069\u3053\u308d\u306a\u3069\nMattermost\u306e\u65e5\u672c\u8a9e\u306e\u4e8b\u4f8b\u304c\u307e\u3060\u5c11\u306a\u3044\u3088\u3046\u3067\u3001\u7279\u306bGitlab\u3068\u306e\u9023\u643a\u90e8\u5206\u306b\u3064\u3044\u3066\n\u8abf\u3079\u308b\u306e\u306bgitlab\u8b39\u88fd\u306e\u305f\u3081\u30ad\u30fc\u30ef\u30fc\u30c9\u304c\u91cd\u8907\u3057\u3066\u3057\u307e\u3046\u305f\u3081\nGitlab\u5074\u306e\u8a2d\u5b9a\u3067Webhook\u3067\u306f\u306a\u304f\u3001\u30b5\u30fc\u30d3\u30b9\u306eSlack\u3092\u4f7f\u3046\u3068\u3044\u3046\u3068\u3053\u308d\u306b\n\u6c17\u3065\u304f\u307e\u3067\u304c\u306f\u307e\u308a\u3069\u3053\u308d\u3067\u3001\u81ea\u5206\u3068\u3057\u3066\u306f\u76f2\u70b9\u3067\u3057\u305f\u3002\nMattermost\u306f\u3000Slack Clone\u3092\u3046\u305f\u3063\u3066\u3044\u308b\u306e\u3067\u5f53\u305f\u308a\u524d\u3068\u3044\u3048\u3070\u5f53\u305f\u308a\u524d\u306a\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3002\n\u305d\u308c\u4ee5\u5916\u306f\u3001\u7279\u306b\u306f\u307e\u308a\u3069\u3053\u308d\u3082\u5c11\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u65e2\u306bGitlab\u3068Jenkins\u3092\u30aa\u30f3\u30d7\u30ec\u30df\u30b9\u3067\u5229\u7528\u3055\u308c\u3066\u3044\u308b\u74b0\u5883\u3067\u3042\u308c\u3070\u3001\u691c\u8a3c\u30ec\u30d9\u30eb\u3067\u3059\u304cMattermost\u3092\u30cf\u30d6\u3068\u3057\u3066ChatOps\u30e9\u30a4\u30af\u306a\u3053\u3068\u3092\u5b9f\u65bd\u3059\u308b\u30cf\u30fc\u30c9\u30eb\u306f\u304b\u306a\u308a\u4f4e\u3044\u3068\u611f\u3058\u307e\u3057\u305f\u3002\n\u306a\u304a\u3001\u4eca\u56de\u305f\u3081\u3057\u3066\u3044\u307e\u305b\u3093\u304cHubot\u3092\u9593\u306b\u631f\u3080\u3068\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3084\u6761\u4ef6\u306a\u3069\u3001\u3082\u3046\u5c11\u3057\u67d4\u8edf\u306b\u8a2d\u5b9a\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n7.\u53c2\u8003\n\u4eca\u56de\u306e\u691c\u8a3c\u306b\u3042\u305f\u3063\u3066\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\nhttp://qiita.com/terukizm/items/4524249dd7f1298fdc06\nhttps://docs.mattermost.com/developer/webhooks-incoming.html\nhttps://docs.mattermost.com/developer/webhooks-outgoing.html\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n# ChatOps run on on-premises.\n## 0.\u3000\u306f\u3058\u3081\u306b\nSlack\u306eClone\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3068\u8a00\u308f\u308c\u3066\u3044\u308b Mattermost \u3092\u4f7f\u3063\u3066\n\u30aa\u30f3\u30d7\u30ec\u30df\u30b9\u74b0\u5883\u3067ChatOps\u7684\u306a\u3053\u3068\u3092\u3084\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u4eca\u56deHubot\u306a\u3069\u3092\u9593\u306b\u5165\u308c\u305a\u306bMattermost,Gitlab,Jenkins\u306e\u307f\u3067\u69cb\u6210\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u5341\u5206\u306a\u691c\u8a3c\u304c\u884c\u3048\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u306e\u3067\u691c\u8a3c\u74b0\u5883\u7b49\u3067\u306e\u30c7\u30e2\u3001\u7d20\u632f\u308a\u7528\u306a\u3069\u306b\u9650\u5b9a\u3057\u3066\u304a\u4f7f\u3044\u304f\u3060\u3055\u3044\u3002\n\n\u307e\u305f\u3001Gitlab\u53ca\u3073Mattermost\u3001Jenkins\u306f\u3059\u3067\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u524d\u63d0\u3067\u3059\u3002\n\u6642\u9593\u306b\u4f59\u88d5\u304c\u3042\u308b\u3068\u304d\u306b\u3001\u74b0\u5883\u69cb\u7bc9\u90e8\u5206\u306b\u3064\u3044\u3066\u306f\u5225\u8a18\u4e8b\u3068\u3057\u3066\u63b2\u8f09\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n---\n2016/9/26\u8ffd\u8a18\uff1a\u4ee5\u4e0b\u306b\u74b0\u5883\u69cb\u7bc9\u306e\u8a18\u4e8b\u3092\u63b2\u8f09\u3057\u307e\u3057\u305f\u3002\nhttp://qiita.com/tbuchi888/items/66763a9af2e15fa74a3c\n\u307e\u305f\u3001Jenkins2\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u3082\u53c2\u7167\u3057\u3066\u9802\u3051\u308c\u3070\u3068\u601d\u3044\u307e\u3059\u3002\nhttp://qiita.com/tbuchi888/items/3c65cb4757225b09f08f\n\n---\n\n## 1.\u3000\u9023\u643a\u6982\u8981\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30a4\u30e1\u30fc\u30b8\u3067\u3000Mattermost \u3068 Gitlab \u3068 Jenkins \u3092 \u9023\u643a\u3055\u305b\u307e\u3059\u3002\n<img width=\"860\" alt=\"chatops_main01.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/d20f75c4-4a3d-b595-ebfd-53c772bbd6e3.png\">\n\n1.\u3000\u30c7\u30d9\u30ed\u30c3\u30d1\u30fc\u304cGitab\u3078`git push`\u3092\u3059\u308b\u3068Mattermost\u306e\u5bfe\u8c61\u30c1\u30e3\u30f3\u30cd\u30eb\uff08\u4ee5\u964dChat\uff09\u306bGitLab\u304b\u3089push\u306e\u60c5\u5831\u304c\u901a\u77e5\u304c\u3055\u308c\u307e\u3059\u3002\n\u3000\u3000-\u3000Gitlab\u306eSlack\u30b5\u30fc\u30d3\u30b9\u3000\u3068\u3000Mattermost\u306eIncoming\u3000Webhook\u3067\u9023\u643a\n2.\u3000\u30aa\u30da\u30ec\u30fc\u30bf\u304cChat\u3067git push\u306e\u5185\u5bb9\u3092chat\u306elink\u304b\u3089\u78ba\u8a8d\u3057\u3066\u554f\u984c\u306a\u3051\u308c\u3070\u3001\"Build!!\"\uff08\u4efb\u610f\u306e\u4e88\u3081\u767b\u9332\u3057\u305f\u6587\u5b57\u5217\uff09\u3068\u5165\u529b\u3059\u308b\u3053\u3068\u3067Jenkins\u3078\u30d3\u30eb\u30c9\u306e\u6307\u793a\u3092\u51fa\u3057\u307e\u3059\u3002\n\u3000\u3000-\u3000Mattermost\u306eOutGoing Webhook \u3068 Jenkins\u306e Build Triggers\u3067\u9023\u643a\n3.\u3000Jenkins\u304cGitlab\u304b\u3089\u5bfe\u8c61\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u3066\u30d3\u30eb\u30c9\u3092\u958b\u59cb\u3057\u307e\u3059\u3002\n\u3000\u3000-\u3000Jenkins\u306eSouce Code Mangement\uff08gitlab-plugin\uff09\u3067\u9023\u643a\n4.\u3000Jenkins\u304c\u30d3\u30eb\u30c9\u7d50\u679c\u3092Chat\u306b\u901a\u77e5\u3057\u307e\u3059\u3002\n\u3000\u3000-\u3000Jenkins\u306ePost-build Actions\u3068Mattermost\u306eIncoming Webhook\u3067\u9023\u643a\n5.\u3000\u30aa\u30da\u30ec\u30fc\u30bf\u304cChat\u3067\u7d50\u679c\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306fChat\u90e8\u5206\u3092\u62e1\u5927\u3057\u305f\u3082\u306e\n<img width=\"361\" alt=\"chat 2016-09-01 10.58.50.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/e596e705-099a-f450-91e8-7bac2ec034e5.png\">\n\n## 2. \u4f7f\u3044\u3069\u3053\u308d\n\u4eca\u56de\u8a66\u3057\u305f\u306e\u306f\u3001\u30b7\u30f3\u30d7\u30eb\u306bJenkins\u306e\u30d3\u30eb\u30c9\u3092\u884c\u3046\u307e\u3067\u3067\u3059\u304c\u3001\n\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c7\u30d7\u30ed\u30a4\u3060\u3051\u3067\u306f\u306a\u304f\u3001\u4ed6\u30c4\u30fc\u30eb\uff08Digdag,[terraform](http://qiita.com/tbuchi888/items/ce904bc9f4c2f7e5de09),Vagrant\uff08vsphere-plugin\uff09\u3084Ansible,Serverspec\u306a\u3069\u306a\u3069\uff09\u3092Jenkins\u3088\u308a\u5b9f\u884c\u3059\u308b\u90e8\u5206\u3082\u30b7\u30a7\u30eb\u7b49\u3067\u30b3\u30fc\u30c9\u5316\u3057\u9023\u643a\u3059\u308b\u3053\u3068\u3067\u3001`git\u3000push`\u3068\u3001Chat\u304b\u3089\u306e\u6307\u793a\u306e\u307f\u3067\u4f8b\u3048\u3070\u30c6\u30b9\u30c8\u6e08\u307f\u306eWeb\u30b5\u30fc\u30d0\u3092\u307e\u308b\u3063\u3068\u81ea\u52d5\u3067\u30b9\u30af\u30e9\u30c3\u30d7\u30a2\u30f3\u30c9\u30d3\u30eb\u30c9\u3059\u308b\u306a\u3069\u3001\u30aa\u30f3\u30d7\u30ec\u30df\u30b9\u3067\u3082\u9762\u767d\u3044\u3053\u3068\u304c\u3067\u304d\u308b\u3068\u601d\u3044\u307e\u3059\u3002\n\n## 3. \u74b0\u5883\nVirtualBox on OSX Yosemite\u306eVM\u3068\u3057\u3066Gitlab/Mattermost\u30b5\u30fc\u30d0\u3068Jekins\u30b5\u30fc\u30d0\u306e2\u53f0\u69cb\u6210\u3067\u691c\u8a3c\u3057\u307e\u3057\u305f\u3002\n\u306a\u304a\u3001\u4e21\u30b5\u30fc\u30d0\u3067\u540d\u524d\u89e3\u6c7a\u53ef\u80fd\u306a\u3088\u3046\u306b`Jenkinssv`\u53ca\u3073`mygitlabsv`\u306eIP\u30a2\u30c9\u30ec\u30b9\u306f\u30db\u30b9\u30c8\uff08OSX\uff09\u306ehosts\u30d5\u30a1\u30a4\u30eb\u306b\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002\n\n|OS Ver.|OSS Ver.|memo|\n|:-:|:-:|:-:|\n|CentOS6.8|GitlabCE ver.8.11.2||\n|-|Mattermost ver.3.30 |on GitlabCE|\n|CentOS6.8|Jenkins ver.2.19||\n|-|-|Gitlab Plagin ver.1.3.0|\n|-|-|Mattermost Plugin ver.2.0.2|\n\n## 4. \u4e8b\u524d\u6e96\u5099\u6982\u8981\n1. Mattermost\u3000\u3067\n    1. \u4eca\u56de\b\u7528\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n    2. Gitlab\u3000\u53ca\u3073\u3000Jenkins\u3068\u9023\u643a\u3059\u308b\u305f\u3081\u306bIncommin/Outgoing Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n2. Gitlab\u3067\n    1. \u4eca\u56de\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\n    2. \u30b5\u30fc\u30d3\u30b9-Slack\u3000\u3067\u3000Mattermost\u306eIncoming\u3000Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n3. Jenkins\u3000\u3067\u3000\n    1. \u30d7\u30e9\u30b0\u30a4\u30f3\uff08gitlab\u53ca\u3073mattermost\uff09\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n    2. \u4eca\u56de\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\n        3. Build Triggers\u3067Mattermost\u306eOutGoing Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n        4. Post-build Actions\u3067Mattermost\u306eIncoming Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n        5. Souce Code Mangement\uff08gitlab-plugin\uff09\u3067Gitlab\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n \n### 4.1 Mattermost\u306e\u8a2d\u5b9a\n<img width=\"270\" alt=\"chatops_mattermost01.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/841b18ad-2c32-d3f4-ed21-e1e63c3c870e.png\">\n1. \u4eca\u56de\u7528\u306e\u30c1\u30e3\u30f3\u30cd\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\uff08\u4eca\u56de\u306e\u4f8b\u3067\u306fjenkins\u3068\u3044\u3046\u540d\u524d\u3067\u4f5c\u6210\uff09\n2. Gitlab\u53ca\u3073Jenkins\u3068\u5916\u90e8\u9023\u643a\u3059\u308b\u305f\u3081\u306bIncommin/Outgoing Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n3. \u521d\u671f\u72b6\u614b\u3067\u306fWebhook\u304c\u5229\u7528\u3067\u304d\u306a\u3044\u306e\u3067Sysytem\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089Custom Integrations\u306e\u8a2d\u5b9a\u3092\u6709\u52b9\uff08true\uff09\u306b\u3057\u3066save\u3057\u3066\u304b\u3089\u3001\u753b\u9762\u5de6\u4e0a\u30e1\u30cb\u30e5\u30fc\u306eSwitch to \u30c1\u30fc\u30e0\u540d\u3088\u308a\u3001Sysytem\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u629c\u3051\u307e\u3059\u3002\u306a\u304a\u3001\u8a2d\u5b9a\u306f\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n<img width=\"245\" alt=\"mattermost_syscon02016-09-01 11.38.17.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/4ddca651-0106-ac8e-bcf4-6e951a5ec1e0.png\"><img width=\"536\" alt=\"mattemost_syscon1_2016-09-01 11.43.05.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/57238606-4613-6025-be12-89287f4a2593.png\">\n4. Integrations\u30e1\u30cb\u30e5\u30fc\u304b\u3089Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n<img width=\"212\" alt=\"mattermost_menu_integrations_2016-09-01 11.49.33.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/b8bff5e4-d0ab-9cd8-fa57-c07c1364ba1d.png\">\u3000<img width=\"498\" alt=\"mattermost_int_02016-09-01 11.59.33.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/70967120-6f7f-66c2-661d-88e54a920155.png\">\n\n5.\u3000Gitlab \u53ca\u3073 Jenkins\u3068\u9023\u643a\u3059\u308b\u305f\u3081\u306bIncoming Webhook\u3092\u305d\u308c\u305e\u308c\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u307e\u305f\u30c1\u30e3\u30f3\u30cd\u30eb\u306f\u3001\u3055\u304d\u307b\u3069\u4f5c\u6210\u3057\u305fjenkins\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n\u4ee5\u4e0bGitlab\u5411\u3051\n<img width=\"494\" alt=\"mattermost_Incoming 2016-09-01 15.24.08.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/c7d41cbc-ea35-023c-4369-4bb2f503a335.png\">\n\n\u4ee5\u4e0bJenkins\u5411\u3051\n<img width=\"501\" alt=\"mattermost_Incoming2016-09-01 15.23.46.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/7f9bb897-d16d-3b71-35e7-8f51cf8ee2a0.png\">\n\n\u306a\u304a\u3001\u8a2d\u5b9a\u5185\u5bb9\uff08URL\uff09\u306f\u3042\u3068\u3067\u5229\u7528\u3059\u308b\u306e\u3067\u63a7\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n<img width=\"498\" alt=\"Mattermos_Incoming_r2016-09-01 15.36.16.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/36156dee-36be-e149-2a22-43987f3a75da.png\">\n\n6.\u3000Jenkins\u3068\u9023\u643a\u3059\u308b\u305f\u3081\u306bOutgoing Webhook\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u30c1\u30e3\u30f3\u30cd\u30eb\u306f\u3001\u3055\u304d\u307b\u3069\u4f5c\u6210\u3057\u305fjenkins\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nTriiger Words(One Per Line)\u306b\u3066Build\u306e\u6307\u793a\u3092\u51fa\u3059\u8a00\u8449\uff08\u4eca\u56de\u306e\u4f8b\u3067\u306fBuild!!\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\nCallBack URLs(One Per Line)\u3078Jenkins\u306e\u5bfe\u8c61\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092`JENKINS\u306eURL/job/\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d/build?`\u3068\u3044\u3046\u5f62\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\uff08\u4eca\u56de\u306e\u4f8b\u3067\u306f`http://myjenkinssv:8080/job/mattermost/build?`\uff09\n\n<img width=\"505\" alt=\"mattermot_outgoing_0_2016-09-01 16.00.38.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/64c25d00-ce0c-0427-a704-7ccf46605429.png\">\n\n\u306a\u304a\u3001\u8a2d\u5b9a\u5185\u5bb9(token)\u306f\u3042\u3068\u3067\u5229\u7528\u3059\u308b\u306e\u3067\u63a7\u3048\u3066\u304a\u304d\u307e\u3059\u3002\n<img width=\"505\" alt=\"mattermot_outgoing_1_2016-09-01 15.59.49.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/0ea0d8e1-6f3b-33d2-da40-8aa0f9d67475.png\">\n\n### 4.2 Gitlab\u306e\u8a2d\u5b9a\n<img width=\"246\" alt=\"chatops_gitlab01.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/a11d7219-5956-15be-73e3-91f3b340374d.png\">\n\n1. \u4eca\u56de\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u307e\u305f\u5f8c\u306e\u52d5\u4f5c\u78ba\u8a8d\u306e\u305f\u3081\u3001\u4f55\u304b\u3057\u3089\u306e\u30b3\u30fc\u30c9\u3092\u767b\u9332\u3057\u3066\u30b3\u30df\u30c3\u30c8\u3092\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\n2. \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u8a2d\u5b9a-\u30b5\u30fc\u30d3\u30b9\u3088\u308aSlack\u3000\u3092\u6709\u52b9\u306b\u3057\u3066\u3000Mattermost\u306eIncoming\u3000Webhook\u306eURL\uff08\uff14\uff0e\uff11\uff0e\uff15\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n<img width=\"433\" alt=\"gitlabmenu2016-09-01 16.18.38.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/d702aad3-09b8-9c9d-bed0-2072b25afd2e.png\">\n\n\u203b\u4ee5\u4e0b\u306f\u753b\u9762\u53d6\u308a\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u306e\u95a2\u4fc2\u3067\u65e2\u306bSlack\u304c\u6709\u52b9\u306a\u305f\u3081\u30a2\u30a4\u30b3\u30f3\u304c\u30b0\u30ea\u30fc\u30f3\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u8a2d\u5b9a\u524d\u306f\u30b0\u30ec\u30fc\u3068\u306a\u308a\u307e\u3059\u3002\n\n<img width=\"432\" alt=\"gitlab_service2016-09-01 16.19.08.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/43820da8-1126-d437-2443-acbdabd0d069.png\">\n\nActive\u306b\u30c1\u30a7\u30c3\u30af\u3092\u3064\u3051\u3066Slack\u30b5\u30fc\u30d3\u30b9\u3092\u6709\u52b9\u306b\u3057\u307e\u3059\u3002\nWebhook\u3078\u3000Mattermost\u306eIncoming\u3000Webhook\u306eURL\uff08\uff14\uff0e\uff11\uff0e\uff15\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002Username\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\uff08\u4eca\u56de\u306e\u4f8b\u3067\u306fgitlab\uff09\n`Save Change`\u5f8c\u306b`Test\u3000setting` \u30dc\u30bf\u30f3\u3088\u308a\u30c6\u30b9\u30c8\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u9001\u4fe1\u304c\u6b63\u5e38\u306b\u7d42\u4e86\u3059\u308b\u3053\u3068\u53ca\u3073Chat\u5074\u306b\u30c6\u30b9\u30c8\u306epush\u901a\u77e5\u304c\u9001\u3089\u308c\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n<img width=\"427\" alt=\"gitlab_service_slack2016-09-01 16.19.33.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/4ebc2332-d669-d1b5-a637-f1c5d81c999a.png\">\n\n### 4.3 Jenkins\u306e\u8a2d\u5b9a\n<img width=\"340\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-01 18.11.14.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/1cb05d9f-674f-9291-63e9-2df5d8483e9a.png\">\n\n1. \u7ba1\u7406\u6a5f\u80fd\u3088\u308a\u30d7\u30e9\u30b0\u30a4\u30f3\uff08gitlab\u53ca\u3073mattermost\uff09\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n<img width=\"774\" alt=\"2016-08-31 13.57.25.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/d5adcf97-3efc-f7a6-0a37-4ba8b54c1ed1.png\">\n<img width=\"770\" alt=\"2016-08-31 13.55.16.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/f8e19728-f37a-aac5-e68d-3a36f7d4c91e.png\">\n2. \u4eca\u56de\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u4eca\u56de\u306e\u4f8b\u3067\u306f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u306fmattermost\u3067\u8a2d\u5b9a\n![2016-09-01 16.52.30.png](https://qiita-image-store.s3.amazonaws.com/0/117986/2565bb51-aa92-b774-6bda-d44cf8e5b0ef.png)\n\n`Souce Code Mangement`\u30bf\u30d6\u3067Gitlab\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n![2016-09-01 16.54.04.png](https://qiita-image-store.s3.amazonaws.com/0/117986/bea08987-3117-a4c5-f582-dbef67331713.png)\n\n`Build Triggers`\u30bf\u30d6\u3067Mattermost\u306eOutGoing Webhook\u306etoken\uff08\uff14\uff0e\uff11\uff0e\uff16\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-01 16.54.25.png](https://qiita-image-store.s3.amazonaws.com/0/117986/68e58561-a767-1d94-ad98-abc061eb110f.png)\n\n`Post-build Actions`\u30bf\u30d6\u306eMattermost Notifications\u306eAdvanced\u8a2d\u5b9a\u3067\nEndpoint\u3078Mattermost\u3067\u306eIncoming Webhook\u306eURL\uff08\uff14\uff0e\uff11\uff0e\uff15\u3067\u4f5c\u6210\u3057\u305f\u3082\u306e\uff09\u3092\u3001Project Channel\u3078jenkins\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-09-01 16.55.20.png](https://qiita-image-store.s3.amazonaws.com/0/117986/73ba3052-ab4a-0328-bd0f-19ed2c1618e3.png)\n\n----\n**\u306a\u304a\u3001Gitlab\u306e\u8a8d\u8a3c\u306b\u5931\u6557\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\u3092\u5b9f\u65bd\u3057\u307e\u3059\u3002**\n\n#### Jenkins\u5074\u3000\u8a2d\u5b9a\u3000\u3000\u3000\n#####\u3000Jenkins\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8a2d\u5b9a\u3000bash\u6709\u52b9\u5316\nroot\u30a2\u30ab\u30a6\u30f3\u30c8\u304bsudo\u3067Jenkins\u30b5\u30fc\u30d0\u3078CLI\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u3001`vi /etc/passwd`\u7b49\u3067jenkins\u884c\u306e\u6700\u5f8c\u3092`false`\u304b\u3089`bash`\u306b\u5909\u3048\u307e\u3059\u3002\n\n\u5909\u66f4\u524d\u4f8b\n`jenkins:x:498:498:Jenkins Continuous Integration Server:/var/lib/jenkins:/bin/false`\n\u5909\u66f4\u5f8c\u4f8b\n`jenkins:x:498:498:Jenkins Continuous Integration Server:/var/lib/jenkins:/bin/bash`\n\n#####\u3000Jenkins\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u8a2d\u5b9a\u3000SSH key\u306e\u4f5c\u6210\njenkins\u30a2\u30ab\u30a6\u30f3\u30c8\u3067SSH key\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n#su jenkins\nbash-4.1$ mkdir .ssh\nbash-4.1$ chmod 700 .ssh/\nbash-4.1$ cd .ssh/\nbash-4.1$ ssh-keygen -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/var/lib/jenkins/.ssh/id_rsa):\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in /var/lib/jenkins/.ssh/id_rsa.\nYour public key has been saved in /var/lib/jenkins/.ssh/id_rsa.pub.\nThe key fingerprint is:\n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\nbash-4.1$ cat id_rsa.pub\nssh-rsa \n\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e\uff5e jenkins@JENKINS_SERVER\n# \u3053\u306e\u4e2d\u8eab\u3092gitlab\u306ejenkins\u30e6\u30fc\u30b6\u306esshkey\u3068\u3057\u3066\u767b\u9332\u3059\u308b\n```\n\n~/.ssh/config\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\u3053\u308c\u304c\u306a\u3044\u3068SSH\u304c\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3068\u306a\u308aPermission denied\u30a8\u30e9\u30fc\u3068\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001user\u3092git\u30a2\u30ab\u30a6\u30f3\u30c8\u3068\u3059\u308b\u3068\u3053\u308d\u304c\u30dd\u30a4\u30f3\u30c8\u3067\u3059\u3002\n\n```\nbash-4.1$ vi ~/.ssh/config\n\n\uff03\u3000\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306e\u5909\u66f4\u3082\u5fd8\u308c\u305a\u306b\u3059\u308b\nbash-4.1$ chmod 644 config\n```\n\n``` \nbash-4.1$ cat\u3000~/.ssh/config\nhost GITLABSERVER\n  HostName GITLABSERVER\n  User git\n  Port 22\n  UserKnownHostsFile /dev/null\n  StrictHostKeyChecking no\n  PasswordAuthentication no\n  IdentityFile /var/lib/jenkins/.ssh/id_rsa\n  IdentitiesOnly yes\n  LogLevel FATAL\n```\n\nGUI\u753b\u9762\u304b\u3089Jenkins\u306e\u5bfe\u8c61\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e`Souce Code Mangement`\u30bf\u30d6\u306eCredentials\u3067\u4ee5\u4e0b\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n-\u3000\u30b9\u30b3\u30fc\u30d7\u30b0\u30ed\u30fc\u30d0\u30eb\n-\u3000\u30e6\u30fc\u30b6\u30fc\u540d jenkins\n-\u3000\u79d8\u5bc6\u9375\u3000Jenkins\u30de\u30b9\u30bf\u30fc\u4e0a\u306e\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u3092\u9078\u629e\u3057\u3066`/var/lib/jenkins/.ssh/id_rsa`\u3092\u5165\u529b\n-\u3000\u30d1\u30b9\u30d5\u30ec\u30fc\u30ba\uff1a\u9375\u751f\u6210\u306e\u6642\u306b\u3057\u3066\u3044\u3057\u305f\u3082\u306e\u3002\u306a\u3057\u306e\u5834\u5408\u306f\u521d\u671f\u8868\u793a\u3092\u6d88\u3059\u3002\n\n#### Gitlab \u5074\nJenkins\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306e\u5c02\u7528\u30e6\u30fc\u30b6\u30fc\u3092Gitlab\u306b\u4f5c\u6210\u3057\u3001jenkins\u30b5\u30fc\u30d0\u306ejenkins\u30e6\u30fc\u30b6\u30fc\u306eid_rsa.pub\u3092sshkey\u3068\u3057\u3066\u767b\u9332\u3057\u307e\u3059\u3002\n\n----\n\n## 5.\u5b9f\u884c\u4f8b\n\u4ee5\u4e0bChat\u306e\u5b9f\u884c\u4f8b\uff08\u518d\u63b2\uff09\n<img width=\"361\" alt=\"chat 2016-09-01 10.58.50.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117986/e596e705-099a-f450-91e8-7bac2ec034e5.png\">\n\n## 6.\u305d\u306e\u4ed6\u30cf\u30de\u308a\u3069\u3053\u308d\u306a\u3069\nMattermost\u306e\u65e5\u672c\u8a9e\u306e\u4e8b\u4f8b\u304c\u307e\u3060\u5c11\u306a\u3044\u3088\u3046\u3067\u3001\u7279\u306bGitlab\u3068\u306e\u9023\u643a\u90e8\u5206\u306b\u3064\u3044\u3066\n\u8abf\u3079\u308b\u306e\u306bgitlab\u8b39\u88fd\u306e\u305f\u3081\u30ad\u30fc\u30ef\u30fc\u30c9\u304c\u91cd\u8907\u3057\u3066\u3057\u307e\u3046\u305f\u3081\nGitlab\u5074\u306e\u8a2d\u5b9a\u3067Webhook\u3067\u306f\u306a\u304f\u3001\u30b5\u30fc\u30d3\u30b9\u306eSlack\u3092\u4f7f\u3046\u3068\u3044\u3046\u3068\u3053\u308d\u306b\n\u6c17\u3065\u304f\u307e\u3067\u304c\u306f\u307e\u308a\u3069\u3053\u308d\u3067\u3001\u81ea\u5206\u3068\u3057\u3066\u306f\u76f2\u70b9\u3067\u3057\u305f\u3002\nMattermost\u306f\u3000Slack Clone\u3092\u3046\u305f\u3063\u3066\u3044\u308b\u306e\u3067\u5f53\u305f\u308a\u524d\u3068\u3044\u3048\u3070\u5f53\u305f\u308a\u524d\u306a\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3002\n\n\u305d\u308c\u4ee5\u5916\u306f\u3001\u7279\u306b\u306f\u307e\u308a\u3069\u3053\u308d\u3082\u5c11\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u65e2\u306bGitlab\u3068Jenkins\u3092\u30aa\u30f3\u30d7\u30ec\u30df\u30b9\u3067\u5229\u7528\u3055\u308c\u3066\u3044\u308b\u74b0\u5883\u3067\u3042\u308c\u3070\u3001\u691c\u8a3c\u30ec\u30d9\u30eb\u3067\u3059\u304cMattermost\u3092\u30cf\u30d6\u3068\u3057\u3066ChatOps\u30e9\u30a4\u30af\u306a\u3053\u3068\u3092\u5b9f\u65bd\u3059\u308b\u30cf\u30fc\u30c9\u30eb\u306f\u304b\u306a\u308a\u4f4e\u3044\u3068\u611f\u3058\u307e\u3057\u305f\u3002\n\n\u306a\u304a\u3001\u4eca\u56de\u305f\u3081\u3057\u3066\u3044\u307e\u305b\u3093\u304cHubot\u3092\u9593\u306b\u631f\u3080\u3068\u3001\u30e1\u30c3\u30bb\u30fc\u30b8\u3084\u6761\u4ef6\u306a\u3069\u3001\u3082\u3046\u5c11\u3057\u67d4\u8edf\u306b\u8a2d\u5b9a\u3067\u304d\u305d\u3046\u3067\u3059\u3002\n\n## 7.\u53c2\u8003\n\n\u4eca\u56de\u306e\u691c\u8a3c\u306b\u3042\u305f\u3063\u3066\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\n - http://qiita.com/terukizm/items/4524249dd7f1298fdc06\n - https://docs.mattermost.com/developer/webhooks-incoming.html\n - https://docs.mattermost.com/developer/webhooks-outgoing.html\n\n\u4ee5\u4e0a\u3067\u3059\u3002\n", "tags": ["Mattermost", "GitLab", "Jenkins", "ChatOps", "Slack"]}