{"tags": ["Ajax", "jQuery", "FormData", "lightbox"], "context": "\n\n\u6982\u8981\n\u4ee5\u524d\u306e\u6295\u7a3fPHP\u3092\u7528\u3044\u305f\u30b7\u30f3\u30d7\u30eb\u306a\u753b\u50cf\u30ae\u30e3\u30e9\u30ea\u30fc\u306b\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6a5f\u80fd\u3092\u8ffd\u52a0\u3057\u3066\u307f\u305f\u3002\n\n\u57fa\u672c\u65b9\u91dd\n\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306fajax\u3068FormData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7528\u3044\u308b\u3002\n\u30d5\u30a9\u30fc\u30e0\u306eaction\u3067\u5225\u30da\u30fc\u30b8\u306b\u98db\u3076\u306e\u306f\u907f\u3051\u305f\u304b\u3063\u305f\u306e\u3067\u8272\u3005\u8abf\u3079\u305f\u7d50\u679c\u3001ajax\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u5b9f\u73fe\u3067\u304d\u308b\u4e8b\u304c\u5206\u304b\u3063\u305f\u3002\n\n\u5b9f\u969b\u306e\u624b\u9806\n\n1. \u4f5c\u6210html\u306e\u69cb\u6210\nHTML5\u3067\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\u203bnote1\uff1ajQuery.js\u3068lightbox\u7528css\u3078\u306e\u30ea\u30f3\u30af\u304c\u5165\u308a\u307e\u3059\u3002\n\u203bnote2\uff1atype=\"file\"\u306einput\u30d5\u30a9\u30fc\u30e0\u3092\u7528\u3044\u307e\u3059\u3002\n\u203bnote3\uff1a\u30ae\u30e3\u30e9\u30ea\u30fc\u3092\u8868\u793a\u3059\u308b\u70ba\u306e\u7a7a\u306e\u30d6\u30ed\u30c3\u30af\u3067\u3059\u3002\n\u203bnote4\uff1alightbox\u7528JS\u306f</body>\u306e\u76f4\u524d\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\nsceleton.html\n<!DOCTYPE HTML>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <script src=\"http://code.jquery.com/jquery-latest.js\" type=\"text/javascript\"></script>\n        <link rel=\"stylesheet\" href=\"./css/lightbox.css\">   <!-- note1 -->\n        <title>\u753b\u50cf\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30ae\u30e3\u30e9\u30ea\u30fc</title>\n    </head>\n    <body>\n        <section id=\"upform\" class=\"upform\">\n            <h1>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u753b\u50cf\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044</h1>\n            <form id=\"upload-form\">\n                <input id=\"ufiles\" type=\"file\" name=\"ufiles[]\" accept=\"image/*\" multiple> <!-- note2 -->\n            </form>\n            <br>\n            <hr>\n        </section>\n        <section id=\"gallery\" class=\"gallery\">\n            <h1>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u753b\u50cf\u4e00\u89a7</h1>\n            <h3>\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u62e1\u5927\u8868\u793a\u3055\u308c\u307e\u3059</h3>\n            <div id=\"views\" class=\"views\"></div> <!-- note3 -->\n        </section>\n\n       <script>\n         <!-- \u3053\u3053\u306bjQuery\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8ffd\u52a0\u3057\u3066\u884c\u304d\u307e\u3059 -->\n       </script>\n       <script type=\"text/javascript\" src=\"./js/lightbox.js\"></script> <!-- note4 -->\n    </body>\n</html>\n\n\n\n2. jQuery\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5185\u5bb9\n\u203bnote5\uff1afunction dmout()\u306fjQuery.get()\u3067\u30b7\u30f3\u30d7\u30eb\u306aGET\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u30b5\u30fc\u30d0\u306b\u9001\u3063\u3066\u3044\u307e\u3059\u3002\u30b5\u30fc\u30d0\u5074\u3067\"gallery.php\"\u3092\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u6307\u5b9a\u306eHTML\u8981\u7d20(\u3053\u3053\u3067\u306fclass=\"views\")\u3078\u51fa\u529b\u3057\u307e\u3059\u3002\u30da\u30fc\u30b8\u304c\u30ed\u30fc\u30c9\u3055\u308c\u305f\u6642\u3068jQuery.ajax()\u304c\u6210\u529f\u3057\u305f\u6642\u306b\u547c\u3070\u308c\u3066\u5b9f\u884c\u3055\u308c\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u4ed6\u306e\u826f\u3044\u65b9\u6cd5\u3092\u63a2\u3057\u305f\u65b9\u304c\u826f\u3044\u304b\u3082\u3002\n\u203bnote6\uff1aFormData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\nnew\u3067\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3057\u305f\u5f8c\u306bappend\u30e1\u30bd\u30c3\u30c9\u3067\u8981\u7d20\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\u8907\u6570\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u5ea6\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u51fa\u6765\u308b\u3088\u3046input\u30d5\u30a9\u30fc\u30e0\u306bmuliple\u5c5e\u6027\u3092\u4ed8\u52a0\u3057\u3066\u3044\u308b\u306e\u3067\u3001jQuery.each()\u3092\u4f7f\u7528\u3057\u3066\u5168\u3066\u306efile\u8981\u7d20\u3092\u9806\u306b\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\u203bnode7\uff1ajQuery.ajax()\u3067AJAX\u901a\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002FormData\u3092\u9001\u4fe1\u3057html\u3092\u53d7\u3051\u53d6\u308a\u307e\u3059\u3002processData\u3068contentType\u306ffalse\u306b\u3059\u308b\u5fc5\u8981\u304c\u6709\u308b\u3068\u306e\u4e8b\u3067\u3059\u3002\u901a\u4fe1\u304c\u6b63\u5e38\u306b\u884c\u308f\u308c\u308b\u3068.done(function())\u304c\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3055\u308c\u307e\u3059\u3002\n\njquery.script\n        $(function(){\n            // note5 \u30da\u30fc\u30b8\u30ed\u30fc\u30c9\u6642\u306e\u547c\u3073\u51fa\u3057\n            domout(\"gallery.php\", \".views\");\n\n           // id=\"ufile\"\u306e\u5909\u5316\u3067\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n            $(\"#ufiles\").change(function(){\n                // \u9078\u629e\u30d5\u30a1\u30a4\u30eb\u306e\u6709\u7121\u3092\u30c1\u30a7\u30c3\u30af\n                if (!this.files.length) {\n                    alert('\u30d5\u30a1\u30a4\u30eb\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093');\n                    return;\n                }\n\n                // note6 FormData\u3092\u7528\u610f\n                var fd = new FormData();\n                fd.append('action','upload-form');\n                $.each($(\"input[type='file']\")[0].files, function(i, file) {\n                    fd.append('ufiles['+i+']', file);\n                });\n\n                // note7 ajax\u3067FromData\u3092\u9001\u4fe1\n                $.ajax({\n                    url: 'uploader_m.php',\n                    type: 'POST',\n                    processData: false,\n                    contentType: false,\n                    dataType: 'html',\n                    data: fd\n                }).done(function(data, textStatus, jwXHR){\n                    alert(data);\n                    // note5 \u7d42\u4e86\u6642\u306e\u547c\u3073\u51fa\u3057\n                    domout(\"gallery.php\", \".views\");\n                }).fail(function(jqXHR, textStatus, errorThrown){\n                    alert('\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f : ' + textStatus\n                        + \"\\nHTTP status : \" + errorThrown);\n                });\n            });\n        });\n\n        // note5 DOM\u3078html\u3092\u51fa\u529b\n        function domout(_url, _html) {\n            $.get(_url, function(data) {\n                $(_html).html(data);\n            });\n        }\n\n\n\n3. html\u5168\u4f53\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\ncss\u3067\u30b5\u30e0\u30cd\u30a4\u30eb\u3092\u3061\u3087\u3053\u3063\u3068\u4fee\u98fe\u3057\u3066\u3044\u307e\u3059\u3002\n\nindex.html\n<!DOCTYPE HTML>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <script src=\"http://code.jquery.com/jquery-latest.js\" type=\"text/javascript\"></script>\n        <!-- lightbox\u7528CSS -->\n        <link rel=\"stylesheet\" href=\"./css/lightbox.css\">\n        <title>\u753b\u50cf\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30ae\u30e3\u30e9\u30ea\u30fc</title>\n        <!-- \u30b5\u30e0\u30cd\u30a4\u30eb\u3092\u898b\u3084\u3059\u304f -->\n        <style type=\"text/css\"\">\n         .image-link {\n             display: inline-block;\n             padding: 2px;\n             margin: 0 0.5rem 1rem 0.5rem;\n             background-color: #fff;\n             line-height: 0;\n             border-radius: 4px;\n             transition: background-color 0.5s ease-out; }\n         .image-link:hover {\n             background-color: #4ae;\n             transition: none; }\n        </style>\n    </head>\n    <body>\n        <section id=\"upform\" class=\"upform\">\n            <h1>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u753b\u50cf\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044</h1>\n            <form id=\"upload-form\">\n                <input id=\"ufiles\" type=\"file\" name=\"ufiles[]\" accept=\"image/*\" multiple>\n            </form>\n            <br>\n            <hr>\n        </section>\n        <section id=\"gallery\" class=\"gallery\">\n            <h1>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u753b\u50cf\u4e00\u89a7</h1>\n            <h3>\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u62e1\u5927\u8868\u793a\u3055\u308c\u307e\u3059</h3>\n            <div id=\"views\" class=\"views\"></div>\n        </section>\n\n       <script>\n        $(function(){\n            //\u30da\u30fc\u30b8\u30ed\u30fc\u30c9\u6642\u306e\u547c\u3073\u51fa\u3057\n            domout(\"gallery.php\", \".views\");\n\n           // id=\"ufile\"\u306e\u5909\u5316\u3067\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n            $(\"#ufiles\").change(function(){\n                // \u9078\u629e\u30d5\u30a1\u30a4\u30eb\u306e\u6709\u7121\u3092\u30c1\u30a7\u30c3\u30af\n                if (!this.files.length) {\n                    alert('\u30d5\u30a1\u30a4\u30eb\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093');\n                    return;\n                }\n\n                // FormData\u3092\u7528\u610f\n                var fd = new FormData();\n                fd.append('action','upload-form');\n                $.each($(\"input[type='file']\")[0].files, function(i, file) {\n                    fd.append('ufiles['+i+']', file);\n                });\n\n                // ajax\u3067FromData\u3092\u9001\u4fe1\n                $.ajax({\n                    url: 'uploader_m.php',\n                    type: 'POST',\n                    processData: false,\n                    contentType: false,\n                    dataType: 'html',\n                    data: fd\n                }).done(function(data, textStatus, jwXHR){\n                    alert(data);\n                    //\u7d42\u4e86\u6642\u306e\u547c\u3073\u51fa\u3057\n                    domout(\"gallery.php\", \".views\");\n                }).fail(function(jqXHR, textStatus, errorThrown){\n                    alert('\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f : ' + textStatus\n                        + \"\\nHTTP status : \" + errorThrown);\n                });\n            });\n        });\n\n        // DOM\u3078html\u3092\u51fa\u529b\n        function domout(_url, _html) {\n            $.get(_url, function(data) {\n                $(_html).html(data);\n            });\n        }\n\n       </script>\n       <!-- lightbox\u7528JS -->\n       <script type=\"text/javascript\" src=\"./js/lightbox.js\"></script>\n    </body>\n</html>\n\n\n\n4. \u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308bPHP\nPOST\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u306f$_FILES\u3067PHP\u304b\u3089\u53c2\u7167\u3067\u304d\u307e\u3059\u3002\u30b5\u30fc\u30d0\u4e0a\u3067\u306f\u53d7\u4fe1\u30d5\u30a1\u30a4\u30eb\u304c\"tmp_name\"\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5148\u306bmove_upload_file()\u3067\u79fb\u52d5\u3055\u305b\u3066\u3044\u307e\u3059\u3002\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u306b\u6ce8\u610f\u3067\u3059\u3002\n\nupload_m.php\n<?php\ndefine('FILE_PATH','./upload/'); //\u4fdd\u5b58\u3059\u308b\u30d1\u30b9\u3092\u6307\u5b9a\n\nif ( !empty($_FILES) ) {\n    for ( $i=0; $i<count($_FILES[\"ufiles\"][\"tmp_name\"]); $i++ ) {\n        // \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u6709\u308b\u4e8b\u3092\u78ba\u8a8d\n        if (is_uploaded_file($_FILES[\"ufiles\"][\"tmp_name\"][$i])) {\n            $saveFilename = FILE_PATH . $_FILES['ufiles']['name'][$i];\n\n            // \u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\n            if (move_uploaded_file($_FILES[\"ufiles\"][\"tmp_name\"][$i], $saveFilename)) {\n                echo $_FILES[\"ufiles\"][\"name\"][$i], \"\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\\n\";\n            } else {\n                echo $_FILES[\"ufiles\"][\"name\"][$i], \"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30a8\u30e9\u30fc\\n\";\n            }\n        }\n    }\n}\n?>\n\n\n\n5. \u30ae\u30e3\u30e9\u30ea\u30fc\u7528PHP\n\u57fa\u672c\u7684\u306bPHP\u3092\u7528\u3044\u305f\u30b7\u30f3\u30d7\u30eb\u306a\u753b\u50cf\u30ae\u30e3\u30e9\u30ea\u30fc\u3067\u4f7f\u7528\u3057\u305fPHP\u3068\u540c\u3058\u5185\u5bb9\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u306fgetPictures()\u3092\u547c\u3093\u3067\u304a\u304b\u306a\u3044\u3068\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002\n\ngallery.php\n<?php\n$img_dir = './upload/';\n\nfunction getPictures() {\n    global $img_dir;\n    $i = 0;\n    if ( $handle = opendir($img_dir) ) {\n        while ( ($file = readdir($handle)) !== false ) {\n            $path = $img_dir . $file;\n            if ( !is_dir($path) ) {\n                $split = explode('.', $file);\n                $name = $split[0];\n                $ext = $split[count($split) - 1];\n                if ( ($type = getPictureType($ext)) == '' ) {\n                    continue;\n                }\n                echo '<a class=\"image-link\" href=\"'.$path.'\" data-lightbox=\"imgs\" data-title=\"'.$name.'\"><img class=\"image\" src=\"'.$path.'\" width=\"120\" alt=\"'.$file.'\">';\n            }\n        }\n    }\n}\n\nfunction getPictureType($ext) {\n    if ( preg_match('/jpg|jpeg/i', $ext) ) {\n        return 'jpg';\n    } else if ( preg_match('/png/i', $ext) ) {\n        return 'png';\n    } else if ( preg_match('/gif/i', $ext) ) {\n        return 'gif';\n    } else {\n        return '';\n    }\n}\n\ngetPictures();\n\n?>\n\n\n\n\u7d50\u679c\n\u4ee5\u4e0b\u306e\u74b0\u5883\u3067\u610f\u56f3\u3057\u305f\u52d5\u4f5c\u3092\u78ba\u8a8d\u3002\nEdge 25.10586.0.0\u3067\u306f\u4e0a\u624b\u304f\u52d5\u4f5c\u3057\u306a\u304b\u3063\u305forz\n\u30b5\u30fc\u30d0\u60c5\u5831\n$ uname -a\nLinux raspi-007 4.4.10-v7+ #885 SMP Fri May 13 15:44:27 BST 2016 armv7l GNU/Linux\n$  php -version\nPHP 5.6.20-0+deb8u1 (cli) (built: Apr 28 2016 00:01:26)\nCopyright (c) 1997-2016 The PHP Group\nZend Engine v2.6.0, Copyright (c) 1998-2016 Zend Technologies\n    with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2016, by Zend Technologies\n$ apachectl -v\nServer version: Apache/2.4.10 (Raspbian)\nServer built:   Jan 23 2016 22:26:49\n\u30d6\u30e9\u30a6\u30b6\u60c5\u5831\nFireFox 46.0.1\nChrome 51.0.2704.79 m\n\n\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u3044\u305fWEB\u30b5\u30a4\u30c8\nhttp://chaika.hatenablog.com/entry/2014/04/12/001012\nhttp://qiita.com/BRS_matsuoka/items/ba79a2f500a10ddc0923\nhttp://stackoverflow.com/questions/12989442/uploading-multiple-files-using-formdata\n# \u6982\u8981\n\u4ee5\u524d\u306e\u6295\u7a3f[PHP\u3092\u7528\u3044\u305f\u30b7\u30f3\u30d7\u30eb\u306a\u753b\u50cf\u30ae\u30e3\u30e9\u30ea\u30fc](http://qiita.com/michimaru/items/767aacdedbd7f0a95d2a)\u306b\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6a5f\u80fd\u3092\u8ffd\u52a0\u3057\u3066\u307f\u305f\u3002\n# \u57fa\u672c\u65b9\u91dd\n\u30d5\u30a1\u30a4\u30eb\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306fajax\u3068FormData\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7528\u3044\u308b\u3002\n\u30d5\u30a9\u30fc\u30e0\u306eaction\u3067\u5225\u30da\u30fc\u30b8\u306b\u98db\u3076\u306e\u306f\u907f\u3051\u305f\u304b\u3063\u305f\u306e\u3067\u8272\u3005\u8abf\u3079\u305f\u7d50\u679c\u3001ajax\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u3067\u5b9f\u73fe\u3067\u304d\u308b\u4e8b\u304c\u5206\u304b\u3063\u305f\u3002\n# \u5b9f\u969b\u306e\u624b\u9806\n## 1. \u4f5c\u6210html\u306e\u69cb\u6210\nHTML5\u3067\u66f8\u3044\u3066\u3044\u304d\u307e\u3059\u3002\n\u203bnote1\uff1ajQuery.js\u3068lightbox\u7528css\u3078\u306e\u30ea\u30f3\u30af\u304c\u5165\u308a\u307e\u3059\u3002\n\u203bnote2\uff1atype=\"file\"\u306einput\u30d5\u30a9\u30fc\u30e0\u3092\u7528\u3044\u307e\u3059\u3002\n\u203bnote3\uff1a\u30ae\u30e3\u30e9\u30ea\u30fc\u3092\u8868\u793a\u3059\u308b\u70ba\u306e\u7a7a\u306e\u30d6\u30ed\u30c3\u30af\u3067\u3059\u3002\n\u203bnote4\uff1alightbox\u7528JS\u306f\\</body>\u306e\u76f4\u524d\u306b\u914d\u7f6e\u3057\u307e\u3059\u3002\n\n```sceleton.html\n<!DOCTYPE HTML>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <script src=\"http://code.jquery.com/jquery-latest.js\" type=\"text/javascript\"></script>\n        <link rel=\"stylesheet\" href=\"./css/lightbox.css\">   <!-- note1 -->\n        <title>\u753b\u50cf\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30ae\u30e3\u30e9\u30ea\u30fc</title>\n    </head>\n    <body>\n        <section id=\"upform\" class=\"upform\">\n            <h1>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u753b\u50cf\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044</h1>\n            <form id=\"upload-form\">\n                <input id=\"ufiles\" type=\"file\" name=\"ufiles[]\" accept=\"image/*\" multiple> <!-- note2 -->\n            </form>\n            <br>\n            <hr>\n        </section>\n        <section id=\"gallery\" class=\"gallery\">\n            <h1>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u753b\u50cf\u4e00\u89a7</h1>\n            <h3>\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u62e1\u5927\u8868\u793a\u3055\u308c\u307e\u3059</h3>\n            <div id=\"views\" class=\"views\"></div> <!-- note3 -->\n        </section>\n\n       <script>\n         <!-- \u3053\u3053\u306bjQuery\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8ffd\u52a0\u3057\u3066\u884c\u304d\u307e\u3059 -->\n       </script>\n       <script type=\"text/javascript\" src=\"./js/lightbox.js\"></script> <!-- note4 -->\n    </body>\n</html>\n```\n\n## 2. jQuery\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5185\u5bb9\n\u203bnote5\uff1afunction dmout()\u306f[jQuery.get()](http://js.studio-kingdom.com/jquery/ajax/get)\u3067\u30b7\u30f3\u30d7\u30eb\u306aGET\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u30b5\u30fc\u30d0\u306b\u9001\u3063\u3066\u3044\u307e\u3059\u3002\u30b5\u30fc\u30d0\u5074\u3067\"gallery.php\"\u3092\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u6307\u5b9a\u306eHTML\u8981\u7d20(\u3053\u3053\u3067\u306fclass=\"views\")\u3078\u51fa\u529b\u3057\u307e\u3059\u3002\u30da\u30fc\u30b8\u304c\u30ed\u30fc\u30c9\u3055\u308c\u305f\u6642\u3068jQuery.ajax()\u304c\u6210\u529f\u3057\u305f\u6642\u306b\u547c\u3070\u308c\u3066\u5b9f\u884c\u3055\u308c\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u4ed6\u306e\u826f\u3044\u65b9\u6cd5\u3092\u63a2\u3057\u305f\u65b9\u304c\u826f\u3044\u304b\u3082\u3002\n\u203bnote6\uff1a[FormData](https://developer.mozilla.org/ja/docs/Web/API/FormData)\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u3044\u307e\u3059\u3002\nnew\u3067\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3057\u305f\u5f8c\u306bappend\u30e1\u30bd\u30c3\u30c9\u3067\u8981\u7d20\u3092\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\u8907\u6570\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u5ea6\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u51fa\u6765\u308b\u3088\u3046input\u30d5\u30a9\u30fc\u30e0\u306bmuliple\u5c5e\u6027\u3092\u4ed8\u52a0\u3057\u3066\u3044\u308b\u306e\u3067\u3001[jQuery.each()](http://semooh.jp/jquery/api/utilities/jQuery.each/object%2C+callback/)\u3092\u4f7f\u7528\u3057\u3066\u5168\u3066\u306efile\u8981\u7d20\u3092\u9806\u306b\u8ffd\u52a0\u3057\u3066\u3044\u307e\u3059\u3002\n\u203bnode7\uff1a[jQuery.ajax()](http://js.studio-kingdom.com/jquery/ajax/ajax)\u3067AJAX\u901a\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002FormData\u3092\u9001\u4fe1\u3057html\u3092\u53d7\u3051\u53d6\u308a\u307e\u3059\u3002processData\u3068contentType\u306ffalse\u306b\u3059\u308b\u5fc5\u8981\u304c\u6709\u308b\u3068\u306e\u4e8b\u3067\u3059\u3002\u901a\u4fe1\u304c\u6b63\u5e38\u306b\u884c\u308f\u308c\u308b\u3068.done(function())\u304c\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3055\u308c\u307e\u3059\u3002\n\n```jquery.script\n        $(function(){\n            // note5 \u30da\u30fc\u30b8\u30ed\u30fc\u30c9\u6642\u306e\u547c\u3073\u51fa\u3057\n            domout(\"gallery.php\", \".views\");\n\n           // id=\"ufile\"\u306e\u5909\u5316\u3067\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n            $(\"#ufiles\").change(function(){\n                // \u9078\u629e\u30d5\u30a1\u30a4\u30eb\u306e\u6709\u7121\u3092\u30c1\u30a7\u30c3\u30af\n                if (!this.files.length) {\n                    alert('\u30d5\u30a1\u30a4\u30eb\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093');\n                    return;\n                }\n\n                // note6 FormData\u3092\u7528\u610f\n                var fd = new FormData();\n                fd.append('action','upload-form');\n                $.each($(\"input[type='file']\")[0].files, function(i, file) {\n                    fd.append('ufiles['+i+']', file);\n                });\n\n                // note7 ajax\u3067FromData\u3092\u9001\u4fe1\n                $.ajax({\n                    url: 'uploader_m.php',\n                    type: 'POST',\n                    processData: false,\n                    contentType: false,\n                    dataType: 'html',\n                    data: fd\n                }).done(function(data, textStatus, jwXHR){\n                    alert(data);\n                    // note5 \u7d42\u4e86\u6642\u306e\u547c\u3073\u51fa\u3057\n                    domout(\"gallery.php\", \".views\");\n                }).fail(function(jqXHR, textStatus, errorThrown){\n                    alert('\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f : ' + textStatus\n                        + \"\\nHTTP status : \" + errorThrown);\n                });\n            });\n        });\n\n        // note5 DOM\u3078html\u3092\u51fa\u529b\n        function domout(_url, _html) {\n            $.get(_url, function(data) {\n                $(_html).html(data);\n            });\n        }\n```\n## 3. html\u5168\u4f53\n\u3053\u3093\u306a\u611f\u3058\u3067\u3059\u3002\ncss\u3067\u30b5\u30e0\u30cd\u30a4\u30eb\u3092\u3061\u3087\u3053\u3063\u3068\u4fee\u98fe\u3057\u3066\u3044\u307e\u3059\u3002\n\n```index.html\n<!DOCTYPE HTML>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <script src=\"http://code.jquery.com/jquery-latest.js\" type=\"text/javascript\"></script>\n        <!-- lightbox\u7528CSS -->\n        <link rel=\"stylesheet\" href=\"./css/lightbox.css\">\n        <title>\u753b\u50cf\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30ae\u30e3\u30e9\u30ea\u30fc</title>\n        <!-- \u30b5\u30e0\u30cd\u30a4\u30eb\u3092\u898b\u3084\u3059\u304f -->\n        <style type=\"text/css\"\">\n         .image-link {\n             display: inline-block;\n             padding: 2px;\n             margin: 0 0.5rem 1rem 0.5rem;\n             background-color: #fff;\n             line-height: 0;\n             border-radius: 4px;\n             transition: background-color 0.5s ease-out; }\n         .image-link:hover {\n             background-color: #4ae;\n             transition: none; }\n        </style>\n    </head>\n    <body>\n        <section id=\"upform\" class=\"upform\">\n            <h1>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u753b\u50cf\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044</h1>\n            <form id=\"upload-form\">\n                <input id=\"ufiles\" type=\"file\" name=\"ufiles[]\" accept=\"image/*\" multiple>\n            </form>\n            <br>\n            <hr>\n        </section>\n        <section id=\"gallery\" class=\"gallery\">\n            <h1>\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u753b\u50cf\u4e00\u89a7</h1>\n            <h3>\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u62e1\u5927\u8868\u793a\u3055\u308c\u307e\u3059</h3>\n            <div id=\"views\" class=\"views\"></div>\n        </section>\n\n       <script>\n        $(function(){\n            //\u30da\u30fc\u30b8\u30ed\u30fc\u30c9\u6642\u306e\u547c\u3073\u51fa\u3057\n            domout(\"gallery.php\", \".views\");\n\n           // id=\"ufile\"\u306e\u5909\u5316\u3067\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n            $(\"#ufiles\").change(function(){\n                // \u9078\u629e\u30d5\u30a1\u30a4\u30eb\u306e\u6709\u7121\u3092\u30c1\u30a7\u30c3\u30af\n                if (!this.files.length) {\n                    alert('\u30d5\u30a1\u30a4\u30eb\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093');\n                    return;\n                }\n\n                // FormData\u3092\u7528\u610f\n                var fd = new FormData();\n                fd.append('action','upload-form');\n                $.each($(\"input[type='file']\")[0].files, function(i, file) {\n                    fd.append('ufiles['+i+']', file);\n                });\n\n                // ajax\u3067FromData\u3092\u9001\u4fe1\n                $.ajax({\n                    url: 'uploader_m.php',\n                    type: 'POST',\n                    processData: false,\n                    contentType: false,\n                    dataType: 'html',\n                    data: fd\n                }).done(function(data, textStatus, jwXHR){\n                    alert(data);\n                    //\u7d42\u4e86\u6642\u306e\u547c\u3073\u51fa\u3057\n                    domout(\"gallery.php\", \".views\");\n                }).fail(function(jqXHR, textStatus, errorThrown){\n                    alert('\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f : ' + textStatus\n                        + \"\\nHTTP status : \" + errorThrown);\n                });\n            });\n        });\n\n        // DOM\u3078html\u3092\u51fa\u529b\n        function domout(_url, _html) {\n            $.get(_url, function(data) {\n                $(_html).html(data);\n            });\n        }\n\n       </script>\n       <!-- lightbox\u7528JS -->\n       <script type=\"text/javascript\" src=\"./js/lightbox.js\"></script>\n    </body>\n</html>\n```\n\n## 4. \u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308bPHP\nPOST\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u60c5\u5831\u306f$\\_FILES\u3067PHP\u304b\u3089\u53c2\u7167\u3067\u304d\u307e\u3059\u3002\u30b5\u30fc\u30d0\u4e0a\u3067\u306f\u53d7\u4fe1\u30d5\u30a1\u30a4\u30eb\u304c\"tmp_name\"\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5148\u306bmove_upload_file()\u3067\u79fb\u52d5\u3055\u305b\u3066\u3044\u307e\u3059\u3002\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u66f8\u304d\u8fbc\u307f\u6a29\u9650\u306b\u6ce8\u610f\u3067\u3059\u3002\n\n```upload_m.php\n<?php\ndefine('FILE_PATH','./upload/'); //\u4fdd\u5b58\u3059\u308b\u30d1\u30b9\u3092\u6307\u5b9a\n\nif ( !empty($_FILES) ) {\n    for ( $i=0; $i<count($_FILES[\"ufiles\"][\"tmp_name\"]); $i++ ) {\n        // \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u304c\u6709\u308b\u4e8b\u3092\u78ba\u8a8d\n        if (is_uploaded_file($_FILES[\"ufiles\"][\"tmp_name\"][$i])) {\n            $saveFilename = FILE_PATH . $_FILES['ufiles']['name'][$i];\n\n            // \u30d5\u30a1\u30a4\u30eb\u306e\u79fb\u52d5\n            if (move_uploaded_file($_FILES[\"ufiles\"][\"tmp_name\"][$i], $saveFilename)) {\n                echo $_FILES[\"ufiles\"][\"name\"][$i], \"\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\\n\";\n            } else {\n                echo $_FILES[\"ufiles\"][\"name\"][$i], \"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u30a8\u30e9\u30fc\\n\";\n            }\n        }\n    }\n}\n?>\n```\n## 5. \u30ae\u30e3\u30e9\u30ea\u30fc\u7528PHP\n\u57fa\u672c\u7684\u306b[PHP\u3092\u7528\u3044\u305f\u30b7\u30f3\u30d7\u30eb\u306a\u753b\u50cf\u30ae\u30e3\u30e9\u30ea\u30fc](http://qiita.com/michimaru/items/767aacdedbd7f0a95d2a)\u3067\u4f7f\u7528\u3057\u305fPHP\u3068\u540c\u3058\u5185\u5bb9\u3067\u3059\u304c\u3001\u3053\u3053\u3067\u306fgetPictures()\u3092\u547c\u3093\u3067\u304a\u304b\u306a\u3044\u3068\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002\n\n``` gallery.php\n<?php\n$img_dir = './upload/';\n\nfunction getPictures() {\n    global $img_dir;\n    $i = 0;\n    if ( $handle = opendir($img_dir) ) {\n        while ( ($file = readdir($handle)) !== false ) {\n            $path = $img_dir . $file;\n            if ( !is_dir($path) ) {\n                $split = explode('.', $file);\n                $name = $split[0];\n                $ext = $split[count($split) - 1];\n                if ( ($type = getPictureType($ext)) == '' ) {\n                    continue;\n                }\n                echo '<a class=\"image-link\" href=\"'.$path.'\" data-lightbox=\"imgs\" data-title=\"'.$name.'\"><img class=\"image\" src=\"'.$path.'\" width=\"120\" alt=\"'.$file.'\">';\n            }\n        }\n    }\n}\n\nfunction getPictureType($ext) {\n    if ( preg_match('/jpg|jpeg/i', $ext) ) {\n        return 'jpg';\n    } else if ( preg_match('/png/i', $ext) ) {\n        return 'png';\n    } else if ( preg_match('/gif/i', $ext) ) {\n        return 'gif';\n    } else {\n        return '';\n    }\n}\n\ngetPictures();\n\n?>\n```\n# \u7d50\u679c\n\u4ee5\u4e0b\u306e\u74b0\u5883\u3067\u610f\u56f3\u3057\u305f\u52d5\u4f5c\u3092\u78ba\u8a8d\u3002\nEdge 25.10586.0.0\u3067\u306f\u4e0a\u624b\u304f\u52d5\u4f5c\u3057\u306a\u304b\u3063\u305forz\n\u30b5\u30fc\u30d0\u60c5\u5831\n$ uname -a\nLinux raspi-007 4.4.10-v7+ #885 SMP Fri May 13 15:44:27 BST 2016 armv7l GNU/Linux\n\n$  php -version\nPHP 5.6.20-0+deb8u1 (cli) (built: Apr 28 2016 00:01:26)\nCopyright (c) 1997-2016 The PHP Group\nZend Engine v2.6.0, Copyright (c) 1998-2016 Zend Technologies\n    with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2016, by Zend Technologies\n\n$ apachectl -v\nServer version: Apache/2.4.10 (Raspbian)\nServer built:   Jan 23 2016 22:26:49\n\n\u30d6\u30e9\u30a6\u30b6\u60c5\u5831\nFireFox 46.0.1\nChrome 51.0.2704.79 m\n# \u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u3044\u305fWEB\u30b5\u30a4\u30c8\nhttp://chaika.hatenablog.com/entry/2014/04/12/001012\nhttp://qiita.com/BRS_matsuoka/items/ba79a2f500a10ddc0923\nhttp://stackoverflow.com/questions/12989442/uploading-multiple-files-using-formdata\n\n\n"}