{"context": " More than 1 year has passed since last update.Node.js\u306eStream\u306b\u3064\u3044\u3066\u77e5\u3089\u306a\u304b\u3063\u305f\u306e\u3067AWS SDK\u306eS3\u306e\u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u51fa\u3057\u3092\u3057\u306a\u304c\u3089\u4f7f\u3063\u3066\u307f\u305f\u6642\u306e\u30e1\u30e2\n\n\u53c2\u8003\n\u4ee5\u4e0b\u3092\u8aad\u307e\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\nNode.js \u306e Stream API \u3067\u300c\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u300d\u3092\u6271\u3046\u65b9\u6cd5\nStream\u4eca\u6614\u7269\u8a9e\n\n\u307e\u305f\u3001\u4ee5\u4e0b\u306e\u672c\u306eStream\u306e\u6b04\u3092\u898b\u3066\u307f\u307e\u3057\u305f\u3002\n\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9JavaScript Node.js\u5165\u9580\n\nStream\u3068\u306f\n\n\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u6271\u3046\u969b\u306b\u5229\u7528\u3059\u308b\u62bd\u8c61\u7684\u306a\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\n\u4f8b\u3048\u3070\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u5834\u5408\u3001\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u30e1\u30e2\u30ea\u306b\u6301\u3063\u3066\u304b\u3089\u51e6\u7406\u3059\u308b\u306e\u3067\u306f\u306a\u304f\u3001\u5c11\u3057\u305a\u3064\u8aad\u307f\u8fbc\u307f\u306a\u304c\u3089\u9010\u6b21\u51e6\u7406\u3092\u884c\u3046\u4e8b\u3067\u52b9\u7387\u5316\u3067\u304d\u308b\u3002Node.js\u3063\u307d\u3044\nReadable Stream\u3067setEncoding\u3057\u306a\u3044\u3068Buffer\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u3057\u3066\u8aad\u307f\u8fbc\u3080\u3002\u6587\u5b57\u5217\u3068\u3057\u3066\u8aad\u307f\u8fbc\u307f\u305f\u3044\u5834\u5408\u306b\u306freadStream.setEncoding('utf-8')\u306a\u3069\u3059\u308b\u3002(Buffer\u306f\u30d0\u30a4\u30ca\u30ea\u3092\u6271\u3046\u305f\u3081\u306e\u30af\u30e9\u30b9)\n\n\n\u3084\u3063\u3066\u307f\u308b\n\u307e\u305a\u3001\u666e\u901a\u306bS3\u304b\u3089ELB\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\n\ns3.js\nvar AWS = require('aws-sdk');\n\nvar params = {\n  Bucket: 'toshihiro-elb-test',\n  Key: 'AWSLogs/xxxxx/elasticloadbalancing/ap-northeast-1/2015/05/29/694273932022_elasticloadbalancing_ap-northeast-1_LoadBlancer_20150529T1315Z_52.68.91.81_3jjesltj.log'\n}\n\nvar s3 = new AWS.S3();\ns3.getObject(params, function(err, data) {\n  if (err) console.log(err, err.stack);\n  else console.log(data);\n});\n\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n$node s3.js\n{ AcceptRanges: 'bytes',\n  LastModified: 'Fri, 29 May 2015 13:19:28 GMT',\n  ContentLength: '3138',\n  ETag: '\"c6c596d459088a4a6017f9db3570a216\"',\n  ContentType: '',\n  Metadata: {},\n  Body: <Buffer 32 30 31 35 2d 30 35 2d 32 39 54 31 33 3a 31 33 3a 35 37 2e 34 35 30 38 36 37 5a 20 4c 6f 61 64 42 6c 61 6e 63 65 72 20 31 30 31 2e 31 31 31 2e 32 30 ... > }\n\n\u4e0a\u8a18\u30b3\u30fc\u30c9\u306e\u5834\u5408\u3001\u4e00\u5ea6\u30d5\u30a1\u30a4\u30eb\u306e\u3059\u3079\u3066\u306e\u5185\u5bb9\u3092\u30e1\u30e2\u30ea\u306b\u8aad\u307f\u8fbc\u3093\u3067\u51e6\u7406\u3092\u3059\u308b\u5f62\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001Body\u90e8\u5206\u306fBuffer\u3068\u3057\u3066\u53d6\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u4e0a\u8a18Body\u90e8\u5206\uff08\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\uff09\u3092ReadableStream\u3092\u4f7f\u3063\u3066\u975e\u540c\u671f\u3067\u8aad\u307f\u8fbc\u3080\u4e8b\u3092\u3084\u3063\u3066\u307f\u307e\u3059\u3002\n\ns3.js\nvar AWS = require('aws-sdk');\n\nvar params = {\n  Bucket: 'toshihirock-elb-test',\n  Key: 'AWSLogs/xxxxxxxxxx/elasticloadbalancing/ap-northeast-1/2015/05/29/xxxxxxxx_elasticloadbalancing_ap-northeast-1_LoadBlancer_20150529T1315Z_52.68.91.81_3jjesltj.log'\n}\n\nvar s3 = new AWS.S3();\nvar s3Stream = s3.getObject(params).createReadStream();\n\ns3Stream.on('data', function(chunk) {\n  console.log(chunk);\n});\n\ns3Stream.on('end', function() {\n  console.log('end');\n});\n\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\n$node s3.js\n<Buffer 32 30 31 35 2d 30 35 2d 32 39 54 31 33 3a 31 33 3a 35 37 2e 34 35 30 38 36 37 5a 20 4c 6f 61 64 42 6c 61 6e 63 65 72 20 31 30 31 2e 31 31 31 2e 32 30 ... >\n<Buffer 61 6d 61 7a 6f 6e 61 77 73 2e 63 6f 6d 3a 38 30 2f 66 61 76 69 63 6f 6e 2e 69 63 6f 20 48 54 54 50 2f 31 2e 31 22 20 22 4d 6f 7a 69 6c 6c 61 2f 35 2e ... >\n<Buffer 35 33 37 2e 33 36 20 28 4b 48 54 4d 4c 2c 20 6c 69 6b 65 20 47 65 63 6b 6f 29 20 43 68 72 6f 6d 65 2f 34 33 2e 30 2e 32 33 35 37 2e 38 31 20 53 61 66 ... >\n<Buffer 35 33 37 2e 33 36 20 28 4b 48 54 4d 4c 2c 20 6c 69 6b 65 20 47 65 63 6b 6f 29 20 43 68 72 6f 6d 65 2f 34 33 2e 30 2e 32 33 35 37 2e 38 31 20 53 61 66 ... >\nend\n\n\u6700\u521d\u306e\u6642\u3068\u540c\u69d8\u3001Buffer\u3068\u3057\u3066\u8aad\u307f\u8fbc\u3093\u3067\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u8aad\u307f\u8fbc\u3080\u969b\u306bUTF-8\u3068\u3057\u3066\u8aad\u307f\u8fbc\u3080\u3088\u3046\u306b\u4ee5\u4e0b\u306e\u8a18\u8ff0\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\n+ s3Stream.setEncoding('utf-8');\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n$node s3.js\n2015-05-29T13:13:57.450867Z LoadBlancer \n...\n\n\u6587\u5b57\u5217\u3068\u3057\u3066\u53d6\u5f97\u3057\u3001\u8868\u793a\u3067\u304d\u307e\u3057\u305f\u3002\n\u305f\u3060\u3057\u3001\u4e0a\u8a18data\u30a4\u30d9\u30f3\u30c8\u767a\u751f\u6642\u306bchunk\u3067\u53d6\u5f97\u3067\u304d\u308b\u6587\u5b57\u5217\u306f\u8907\u6570\u884c\u306e\u6587\u5b57\u5217\u3068\u306a\u308a\u3001\uff11\u884c\u3054\u3068\u306b\u51e6\u7406\u3092\u884c\u3046\u5834\u5408\u306b\u306f\u5225\u9014\u5bfe\u5fdc\u304c\u5fc5\u8981\u3067\u3059\u3002(\u30ed\u30b0\u30921\u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u3093\u3067RDS\u306b\u767b\u9332\u3059\u308b\u306a\u3069\uff09\n\u8a66\u3057\u306bdata\u30a4\u30d9\u30f3\u30c8\u304c\u547c\u3070\u308c\u308b\u90fd\u5ea6\u3001aaaaa\u3068\u51fa\u529b\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8907\u6570\u884c\u306e\u6587\u5b57\u5217\u304cdata\u30a4\u30d9\u30f3\u30c8\u6642\u306b\u304d\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n2015-05-29T13:13:57.450867Z LoadBlancer \n...\naaaaaa\namazonaws.com:80/favicon.ico HTTP/1.1\" \"Mozilla/5.0 - -\n...\n\nchunk\u3067\u53d7\u3051\u53d6\u3063\u305f\u6642\u306b\u6539\u884c\u30b3\u30fc\u30c9\u3092\u307f\u3066\u3054\u306b\u3087\u3054\u306b\u3087\u3084\u308c\u3070\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u9762\u5012\u306a\u306e\u3067 byline \u3068\u3044\u3046npm\u304b\u3089\u63d0\u4f9b\u3055\u308c\u308bLineStream\u30af\u30e9\u30b9\u3092\u5229\u7528\u3057\u30661\u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u3081\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u307e\u305a\u306f\u3001npm\u30b3\u30de\u30f3\u30c9\u3067\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\njahewson/node-byline\n$npm install byline\n\n\u30b3\u30fc\u30c9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\u4e00\u5ea6LineStream\u3092pipe\u3057\u3066\u304b\u3089data\u30a4\u30d9\u30f3\u30c8\u3092\u53d7\u3051\u53d6\u308b\u4e8b\u30671\u884c\u3054\u3068\u306e\u51e6\u7406\u3092\u884c\u3046\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\ns3.js\nvar AWS = require('aws-sdk');\nvar LineStream = require('byline').LineStream;\n\nvar lineStream = new LineStream();\n\nvar params = {\n  Bucket: 'toshihirock-elb-test',\n  Key: 'AWSLogs/xxxxxxx/elasticloadbalancing/ap-northeast-1/2015/05/29/xxxxxxxx_elasticloadbalancing_ap-northeast-1_LoadBlancer_20150529T1315Z_52.68.91.81_3jjesltj.log'\n}\n\nvar s3 = new AWS.S3();\nvar s3Stream = s3.getObject(params).createReadStream();\ns3Stream.setEncoding('utf-8');\n\ns3Stream\n  .pipe(lineStream)\n  .on('data', function(line) {\n    console.log(line);\n    console.log('aaaaaa');\n  });\n\ns3Stream.on('end', function() {\n  console.log('end');\n});\n\n\n\u4e0a\u8a18\u3092\u5b9f\u884c\u3059\u308b\u3068\uff11\u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u3081\u3066\u3044\u308b\u4e8b\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u65b9\u6cd5\u3092\u4f7f\u3048\u3070\u4e00\u5ea6\u306b\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u8aad\u307f\u8fbc\u307e\u305a\u3001\u975e\u540c\u671f\u3067\u30d5\u30a1\u30a4\u30eb1\u884c\u3054\u3068\u306e\u51e6\u7406\u3092\u7c21\u5358\u306b\u304b\u3051\u3066\u91cd\u5b9d\u3057\u305d\u3046\u3067\u3059\u3002Lambda\u3067\u3082\u4f7f\u3046\u3068\u3088\u3055\u3052\u3067\u3059\u3002\nNode.js\u306eStream\u306b\u3064\u3044\u3066\u77e5\u3089\u306a\u304b\u3063\u305f\u306e\u3067AWS SDK\u306eS3\u306e\u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u51fa\u3057\u3092\u3057\u306a\u304c\u3089\u4f7f\u3063\u3066\u307f\u305f\u6642\u306e\u30e1\u30e2\n\n# \u53c2\u8003\n\n\u4ee5\u4e0b\u3092\u8aad\u307e\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\n+ [Node.js \u306e Stream API \u3067\u300c\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u300d\u3092\u6271\u3046\u65b9\u6cd5](http://jxck.hatenablog.com/entry/20111204/1322966453)\n+ [Stream\u4eca\u6614\u7269\u8a9e](http://yosuke-furukawa.hatenablog.com/entry/2014/12/01/155303)\n\n\u307e\u305f\u3001\u4ee5\u4e0b\u306e\u672c\u306eStream\u306e\u6b04\u3092\u898b\u3066\u307f\u307e\u3057\u305f\u3002\n\n[\u30b5\u30fc\u30d0\u30b5\u30a4\u30c9JavaScript Node.js\u5165\u9580](http://www.amazon.co.jp/%E3%82%B5%E3%83%BC%E3%83%90%E3%82%B5%E3%82%A4%E3%83%89JavaScript-Node-js%E5%85%A5%E9%96%80-%E6%B8%85%E6%B0%B4%E4%BF%8A%E5%8D%9A/dp/4048703676)\n\n# Stream\u3068\u306f\n\n+ \u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u6271\u3046\u969b\u306b\u5229\u7528\u3059\u308b\u62bd\u8c61\u7684\u306a\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\n+ \u4f8b\u3048\u3070\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u5834\u5408\u3001\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u30e1\u30e2\u30ea\u306b\u6301\u3063\u3066\u304b\u3089\u51e6\u7406\u3059\u308b\u306e\u3067\u306f\u306a\u304f\u3001\u5c11\u3057\u305a\u3064\u8aad\u307f\u8fbc\u307f\u306a\u304c\u3089\u9010\u6b21\u51e6\u7406\u3092\u884c\u3046\u4e8b\u3067\u52b9\u7387\u5316\u3067\u304d\u308b\u3002Node.js\u3063\u307d\u3044\n+ Readable Stream\u3067setEncoding\u3057\u306a\u3044\u3068Buffer\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3068\u3057\u3066\u8aad\u307f\u8fbc\u3080\u3002\u6587\u5b57\u5217\u3068\u3057\u3066\u8aad\u307f\u8fbc\u307f\u305f\u3044\u5834\u5408\u306b\u306f`readStream.setEncoding('utf-8')`\u306a\u3069\u3059\u308b\u3002(Buffer\u306f\u30d0\u30a4\u30ca\u30ea\u3092\u6271\u3046\u305f\u3081\u306e\u30af\u30e9\u30b9)\n\n# \u3084\u3063\u3066\u307f\u308b\n\n\u307e\u305a\u3001\u666e\u901a\u306bS3\u304b\u3089ELB\u306e\u30a2\u30af\u30bb\u30b9\u30ed\u30b0\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u307f\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\n\n```s3.js\nvar AWS = require('aws-sdk');\n\nvar params = {\n  Bucket: 'toshihiro-elb-test',\n  Key: 'AWSLogs/xxxxx/elasticloadbalancing/ap-northeast-1/2015/05/29/694273932022_elasticloadbalancing_ap-northeast-1_LoadBlancer_20150529T1315Z_52.68.91.81_3jjesltj.log'\n}\n\nvar s3 = new AWS.S3();\ns3.getObject(params, function(err, data) {\n  if (err) console.log(err, err.stack);\n  else console.log(data);\n});\n```\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$node s3.js\n{ AcceptRanges: 'bytes',\n  LastModified: 'Fri, 29 May 2015 13:19:28 GMT',\n  ContentLength: '3138',\n  ETag: '\"c6c596d459088a4a6017f9db3570a216\"',\n  ContentType: '',\n  Metadata: {},\n  Body: <Buffer 32 30 31 35 2d 30 35 2d 32 39 54 31 33 3a 31 33 3a 35 37 2e 34 35 30 38 36 37 5a 20 4c 6f 61 64 42 6c 61 6e 63 65 72 20 31 30 31 2e 31 31 31 2e 32 30 ... > }\n```\n\n\u4e0a\u8a18\u30b3\u30fc\u30c9\u306e\u5834\u5408\u3001\u4e00\u5ea6\u30d5\u30a1\u30a4\u30eb\u306e\u3059\u3079\u3066\u306e\u5185\u5bb9\u3092\u30e1\u30e2\u30ea\u306b\u8aad\u307f\u8fbc\u3093\u3067\u51e6\u7406\u3092\u3059\u308b\u5f62\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001Body\u90e8\u5206\u306fBuffer\u3068\u3057\u3066\u53d6\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u4e0a\u8a18Body\u90e8\u5206\uff08\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\uff09\u3092ReadableStream\u3092\u4f7f\u3063\u3066\u975e\u540c\u671f\u3067\u8aad\u307f\u8fbc\u3080\u4e8b\u3092\u3084\u3063\u3066\u307f\u307e\u3059\u3002\n\n```s3.js\nvar AWS = require('aws-sdk');\n\nvar params = {\n  Bucket: 'toshihirock-elb-test',\n  Key: 'AWSLogs/xxxxxxxxxx/elasticloadbalancing/ap-northeast-1/2015/05/29/xxxxxxxx_elasticloadbalancing_ap-northeast-1_LoadBlancer_20150529T1315Z_52.68.91.81_3jjesltj.log'\n}\n\nvar s3 = new AWS.S3();\nvar s3Stream = s3.getObject(params).createReadStream();\n\ns3Stream.on('data', function(chunk) {\n  console.log(chunk);\n});\n\ns3Stream.on('end', function() {\n  console.log('end');\n});\n```\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\n\n```\n$node s3.js\n<Buffer 32 30 31 35 2d 30 35 2d 32 39 54 31 33 3a 31 33 3a 35 37 2e 34 35 30 38 36 37 5a 20 4c 6f 61 64 42 6c 61 6e 63 65 72 20 31 30 31 2e 31 31 31 2e 32 30 ... >\n<Buffer 61 6d 61 7a 6f 6e 61 77 73 2e 63 6f 6d 3a 38 30 2f 66 61 76 69 63 6f 6e 2e 69 63 6f 20 48 54 54 50 2f 31 2e 31 22 20 22 4d 6f 7a 69 6c 6c 61 2f 35 2e ... >\n<Buffer 35 33 37 2e 33 36 20 28 4b 48 54 4d 4c 2c 20 6c 69 6b 65 20 47 65 63 6b 6f 29 20 43 68 72 6f 6d 65 2f 34 33 2e 30 2e 32 33 35 37 2e 38 31 20 53 61 66 ... >\n<Buffer 35 33 37 2e 33 36 20 28 4b 48 54 4d 4c 2c 20 6c 69 6b 65 20 47 65 63 6b 6f 29 20 43 68 72 6f 6d 65 2f 34 33 2e 30 2e 32 33 35 37 2e 38 31 20 53 61 66 ... >\nend\n```\n\n\u6700\u521d\u306e\u6642\u3068\u540c\u69d8\u3001Buffer\u3068\u3057\u3066\u8aad\u307f\u8fbc\u3093\u3067\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u8aad\u307f\u8fbc\u3080\u969b\u306bUTF-8\u3068\u3057\u3066\u8aad\u307f\u8fbc\u3080\u3088\u3046\u306b\u4ee5\u4e0b\u306e\u8a18\u8ff0\u3092\u8ffd\u8a18\u3057\u307e\u3059\u3002\n\n\n```\n+ s3Stream.setEncoding('utf-8');\n```\n\n\u5b9f\u884c\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\n$node s3.js\n2015-05-29T13:13:57.450867Z LoadBlancer \n...\n```\n\n\u6587\u5b57\u5217\u3068\u3057\u3066\u53d6\u5f97\u3057\u3001\u8868\u793a\u3067\u304d\u307e\u3057\u305f\u3002\n\n\n\u305f\u3060\u3057\u3001\u4e0a\u8a18data\u30a4\u30d9\u30f3\u30c8\u767a\u751f\u6642\u306bchunk\u3067\u53d6\u5f97\u3067\u304d\u308b\u6587\u5b57\u5217\u306f\u8907\u6570\u884c\u306e\u6587\u5b57\u5217\u3068\u306a\u308a\u3001\uff11\u884c\u3054\u3068\u306b\u51e6\u7406\u3092\u884c\u3046\u5834\u5408\u306b\u306f\u5225\u9014\u5bfe\u5fdc\u304c\u5fc5\u8981\u3067\u3059\u3002(\u30ed\u30b0\u30921\u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u3093\u3067RDS\u306b\u767b\u9332\u3059\u308b\u306a\u3069\uff09\n\n\u8a66\u3057\u306bdata\u30a4\u30d9\u30f3\u30c8\u304c\u547c\u3070\u308c\u308b\u90fd\u5ea6\u3001aaaaa\u3068\u51fa\u529b\u3059\u308b\u3088\u3046\u306b\u3059\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8907\u6570\u884c\u306e\u6587\u5b57\u5217\u304cdata\u30a4\u30d9\u30f3\u30c8\u6642\u306b\u304d\u3066\u3044\u308b\u306e\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\n```\n2015-05-29T13:13:57.450867Z LoadBlancer \n...\naaaaaa\namazonaws.com:80/favicon.ico HTTP/1.1\" \"Mozilla/5.0 - -\n...\n```\n\nchunk\u3067\u53d7\u3051\u53d6\u3063\u305f\u6642\u306b\u6539\u884c\u30b3\u30fc\u30c9\u3092\u307f\u3066\u3054\u306b\u3087\u3054\u306b\u3087\u3084\u308c\u3070\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u9762\u5012\u306a\u306e\u3067 **byline** \u3068\u3044\u3046npm\u304b\u3089\u63d0\u4f9b\u3055\u308c\u308bLineStream\u30af\u30e9\u30b9\u3092\u5229\u7528\u3057\u30661\u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u3081\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u307e\u305a\u306f\u3001npm\u30b3\u30de\u30f3\u30c9\u3067\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n[jahewson/node-byline](https://github.com/jahewson/node-byline)\n\n```\n$npm install byline\n```\n\n\u30b3\u30fc\u30c9\u3092\u5909\u66f4\u3057\u307e\u3059\u3002\n\u4e00\u5ea6LineStream\u3092pipe\u3057\u3066\u304b\u3089data\u30a4\u30d9\u30f3\u30c8\u3092\u53d7\u3051\u53d6\u308b\u4e8b\u30671\u884c\u3054\u3068\u306e\u51e6\u7406\u3092\u884c\u3046\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\n\n```s3.js\nvar AWS = require('aws-sdk');\nvar LineStream = require('byline').LineStream;\n\nvar lineStream = new LineStream();\n\nvar params = {\n  Bucket: 'toshihirock-elb-test',\n  Key: 'AWSLogs/xxxxxxx/elasticloadbalancing/ap-northeast-1/2015/05/29/xxxxxxxx_elasticloadbalancing_ap-northeast-1_LoadBlancer_20150529T1315Z_52.68.91.81_3jjesltj.log'\n}\n\nvar s3 = new AWS.S3();\nvar s3Stream = s3.getObject(params).createReadStream();\ns3Stream.setEncoding('utf-8');\n\ns3Stream\n  .pipe(lineStream)\n  .on('data', function(line) {\n    console.log(line);\n    console.log('aaaaaa');\n  });\n\ns3Stream.on('end', function() {\n  console.log('end');\n});\n```\n\n\u4e0a\u8a18\u3092\u5b9f\u884c\u3059\u308b\u3068\uff11\u884c\u3054\u3068\u306b\u8aad\u307f\u8fbc\u3081\u3066\u3044\u308b\u4e8b\u304c\u5206\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u65b9\u6cd5\u3092\u4f7f\u3048\u3070\u4e00\u5ea6\u306b\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u3092\u8aad\u307f\u8fbc\u307e\u305a\u3001\u975e\u540c\u671f\u3067\u30d5\u30a1\u30a4\u30eb1\u884c\u3054\u3068\u306e\u51e6\u7406\u3092\u7c21\u5358\u306b\u304b\u3051\u3066\u91cd\u5b9d\u3057\u305d\u3046\u3067\u3059\u3002Lambda\u3067\u3082\u4f7f\u3046\u3068\u3088\u3055\u3052\u3067\u3059\u3002\n", "tags": ["aws-sdk", "Node.js", "Stream"]}