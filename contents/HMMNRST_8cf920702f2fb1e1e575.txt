{"tags": ["\u6570\u5b66", "\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"], "context": "\u8a95\u751f\u65e5\u306e\u30d1\u30e9\u30c9\u30c3\u30af\u30b9\u3068\u306f\u3001\u300cnn \u4eba\u304c\u96c6\u307e\u3063\u305f\u3068\u304d\u306b\u305d\u306e\u4e2d\u306b\u540c\u3058\u8a95\u751f\u65e5\u306e\u7d44\u304c\u3067\u304d\u308b\u78ba\u7387 p(n)p(n) \u3092\u6c42\u3081\u308b\u300d\u3068\u3044\u3063\u305f\u554f\u984c\uff08\u8a95\u751f\u65e5\u554f\u984c\uff09\u304c\u3001\u76f4\u611f\u306b\u5408\u308f\u306a\u3044\u307b\u3069\u5927\u304d\u306a\u78ba\u7387\u3092\u3068\u308b\u3068\u3044\u3046\u3082\u306e\u300230\u4eba\u304f\u3089\u3044\u306e\u30e1\u30f3\u30d0\u30fc\u3067\u5b9f\u969b\u306b\u540c\u3058\u8a95\u751f\u65e5\u306e\u7d44\u304c\u3067\u304d\u308b\u304b\u8a66\u3059\u3068\u76db\u308a\u4e0a\u304c\u308b\u3002\u4e00\u65b9\u3067\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306e\u885d\u7a81\u3068\u3044\u3046\u8a71\u306b\u7f6e\u304d\u63db\u3048\u308b\u3068\u3001\u4e00\u898b\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u6e80\u676f\u306b\u307b\u3069\u9060\u3044\u30e1\u30f3\u30d0\u30fc\u6570\u3067\u3082\u308f\u308a\u3068\u885d\u7a81\u304c\u8d77\u304d\u3084\u3059\u3044\u3068\u3044\u3046\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u3066\u3001\u885d\u7a81\u3092\u907f\u3051\u308b\u306b\u306f\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u5341\u5206\u306b\u5927\u304d\u304f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\u3068\u3053\u308d\u3067\u3001\u3053\u306e\u554f\u984c\u3092\u8003\u3048\u308b\u3068\u304d\u306f\u3075\u3064\u3046\u300c365\u65e5\u3069\u308c\u3067\u3082\u540c\u3058\u78ba\u7387\u300d\u3068\u3044\u3046\u524d\u63d0\u3092\u304a\u304f\u304c\u3001\u51fa\u751f\u6570\u306f\u300c9\u6708\u306b\u591a\u3044\u300d\u300c\u4f11\u65e5\u306f\u5c11\u306a\u3044\u300d\u306a\u3069\u306e\u3070\u3089\u3064\u304d\u304c\u3042\u308b\u3002\u78ba\u7387\u304c\u504f\u3063\u3066\u3044\u308b\u3068\u540c\u3058\u8a95\u751f\u65e5\u306e\u7d44\u304c\u3067\u304d\u308b\u78ba\u7387\u306f\u4e0a\u304c\u308b\u306f\u305a\u3067\u3042\u308b\u3002\u3053\u308c\u3092\u5b9f\u969b\u306b\u6c42\u3081\u3066\u307f\u308b\u3002\n\n\u78ba\u7387\u4e00\u69d8\u306e\u5834\u5408\uff08\u304a\u3055\u3089\u3044\uff09\n\u300c\u5c11\u306a\u304f\u3068\u30821\u3064\u3042\u308b\u300d\u3068\u3044\u3046\u5834\u5408\u306e\u78ba\u7387\u3092\u6c42\u3081\u308b\u3068\u304d\u306f\u3001\u6b63\u53cd\u5bfe\u306e\u300c\u5168\u304f\u306a\u3044\u300d\u3068\u3044\u3046\u78ba\u7387\u3092\u6c42\u3081\u30661\u304b\u3089\u5f15\u304f\u3068\u7c21\u5358\u306a\u5834\u5408\u304c\u591a\u3044\u3002\u8a95\u751f\u65e5\u554f\u984c\u3067\u306f\u300cnn \u4eba\u306e\u8a95\u751f\u65e5\u304c\u5168\u3066\u7570\u306a\u308b\u78ba\u7387 \u02c9p(n)=1\u2212p(n)\\bar{p}(n)=1-p(n)\u300d\u3092\u6c42\u3081\u308c\u3070\u3044\u3044\u3053\u3068\u306b\u306a\u308b\u3002\u30e1\u30f3\u30d0\u30fc\u306e\u8a95\u751f\u65e5\u304c\u3068\u3042\u308b\u30d1\u30bf\u30fc\u30f3\uff08\u4f8b\u3048\u3070A\u304c1/1\u751f\u307e\u308c\u3001B\u304c1/2\u751f\u307e\u308c\u3001C\u304c1/3\u751f\u307e\u308c\u3001\u2026\uff09\u306b\u306a\u308b\u78ba\u7387\u306f\u3069\u308c\u3082 1365n\\frac{1}{365^n}\u3001\u8a95\u751f\u65e5\u304c\u5168\u3066\u7570\u306a\u308b\u5834\u5408\u306e\u6570\u306f 365Pn_{365}P_{n} \u3067\u3042\u308b\u306e\u3067\u3001\n1-p(n) = \\frac{_{365}P_{n}}{365^n} = \\frac{365!}{365^n \\left( 365-n \\right)!}\n1\u2212p(n)=365Pn365n=365!365n(365\u2212n)!{1-p(n) = \\frac{_{365}P_{n}}{365^n} = \\frac{365!}{365^n \\left( 365-n \\right)!}\n}\n\ncalc0.rb\nN = 365\na = 1.0 / N\np_bar = (1..N).inject([1]) { |ary,n| ary << ary.last * (N - n + 1) * a }\n\n\n\n\u78ba\u7387\u304c\u4e00\u69d8\u3067\u306a\u3044\u5834\u5408\n\u8a95\u751f\u65e5\u304c\u65e5\u4ed8 ii \u3067\u3042\u308b\u78ba\u7387\u3092 aia_i \uff08\u914d\u5217\u306e\u6dfb\u5b57\u306e\u90fd\u5408\u3067 0\u2264i<N0 \\le i < N \uff09\u3068\u3059\u308b\u3002\u4e00\u69d8\u306e\u3068\u304d\u3068\u540c\u3058\u3088\u3046\u306b\u3001\u5168\u54e1\u306e\u8a95\u751f\u65e5\u304c\u7570\u306a\u308b\u78ba\u7387\u3092\u5148\u306b\u6c42\u3081\u308b\u3002\n\n\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\n2014\u5e74\u306e\u51fa\u751f\u65701\u3092\u57fa\u306b\u3001\u78ba\u7387\u5206\u5e03\u306e\u914d\u5217 $a \u3068\u305d\u306e\u9577\u3055 N \u3092\u4f5c\u6210\u3059\u308b\u3002\u5b9f\u5728\u3057\u306a\u3044\u65e5\u306b\u3064\u3044\u3066\u306f\u4eba\u6570\u3092\u30bc\u30ed\u3068\u3057\u3066\u3044\u308b\u304c\u3001\u8a08\u7b97\u4e0a\u554f\u984c\u306f\u7121\u3044\u3002\n\ntest_data.rb\nx = [\n 1873, 1883, 1948, 2430, 2193, 3156, 3390, 3112, 2966, 3058, 2309, 1999, 2022, 3086, 3323, 3136, 3078, 2317, 1941, 2919, 3108, 3142, 3047, 3007, 2300, 1965, 2979, 3136, 2905, 3001, 2843,\n 2288, 2013, 2864, 3032, 2922, 2800, 3043, 2204, 2013, 2831, 2088, 2980, 3046, 2870, 2215, 1906, 2841, 3090, 2791, 2896, 2800, 2200, 1932, 2705, 3010, 2885, 2789, 2843,    0,    0,    0,\n 2230, 1886, 2922, 2967, 2887, 2819, 2797, 2238, 1934, 2908, 2915, 2918, 2764, 2878, 2215, 1896, 2830, 3112, 2899, 2880, 1928, 2028, 1925, 2776, 3047, 2944, 2683, 2770, 2019, 1879, 2446,\n 2354, 3177, 3065, 2818, 2149, 1813, 2647, 3018, 2730, 2925, 3004, 2135, 1872, 2714, 3174, 2904, 2764, 2703, 2124, 1857, 2736, 3088, 2962, 2915, 2930, 2157, 1897, 3049, 2067, 3086,    0,\n 3436, 3345, 2079, 1964, 2043, 1942, 2974, 3265, 3199, 2374, 2008, 2999, 3020, 3060, 3033, 2993, 2259, 1985, 2808, 3097, 2818, 2886, 2829, 2231, 1882, 2877, 3124, 2860, 2835, 2889, 2196,\n 1977, 2858, 3156, 2938, 2825, 3021, 2232, 1887, 2810, 3220, 2897, 2996, 2999, 2233, 2009, 3038, 3174, 2898, 2932, 2916, 2316, 1968, 2861, 3135, 3049, 2937, 2935, 2221, 2006, 2957,    0,\n 3266, 3189, 3085, 3028, 2354, 2055, 3139, 3207, 3055, 3067, 3039, 2326, 2040, 2912, 3135, 3316, 3223, 3227, 2425, 2064, 2116, 3306, 3615, 3191, 3215, 2515, 2059, 2967, 3252, 3029, 3099,\n 3159, 2371, 2121, 3028, 3331, 3236, 3164, 3284, 2354, 2114, 3017, 3482, 3064, 2721, 2725, 2414, 2159, 3129, 3256, 3257, 3041, 3113, 2291, 2156, 3007, 3289, 3134, 3052, 2892, 2377, 1994,\n 3038, 3234, 3285, 2946, 3172, 2325, 1950, 3158, 3481, 3403, 3186, 3273, 2410, 2244, 2276, 3394, 3588, 3500, 3538, 2638, 2262, 3372, 2544, 3415, 3609, 3436, 2676, 2297, 3276, 3383,    0,\n 3330, 3166, 3256, 2480, 2086, 3037, 3238, 3180, 3097, 3392, 2332, 2028, 2051, 3141, 3246, 3119, 3080, 2248, 2036, 3022, 3211, 3083, 3011, 3118, 2301, 1991, 2961, 3175, 3009, 3012, 3155,\n 2422, 2094, 2010, 3177, 3345, 3010, 3188, 2322, 2046, 2941, 3319, 2998, 2936, 2936, 2268, 1984, 2887, 3120, 3016, 3085, 3054, 2380, 1951, 1958, 3148, 3185, 3070, 3021, 2172, 1950,    0,\n 2887, 3117, 3048, 2853, 3005, 2238, 2008, 2928, 3188, 3020, 2917, 3048, 2275, 1964, 2993, 3256, 3144, 3131, 3109, 2291, 2099, 3304, 2124, 3392, 3748, 3583, 2423, 1895, 2680, 2372, 2003,\n]\nsum = x.inject(:+)\n$a = x.collect { |x_i| x_i.to_f / sum }\nN = $a.size\n\n\n\n\u7d20\u76f4\u306b\u8a08\u7b97\n\u7686\u304c\u3068\u3042\u308b\u7570\u306a\u308b\u8a95\u751f\u65e5\u306e\u30d1\u30bf\u30fc\u30f3\u306b\u306a\u308b\u78ba\u7387\u306f\u305d\u306e\u8a95\u751f\u65e5\u306b\u4f9d\u5b58\u3059\u308b\u306e\u3067\u3001\u500b\u5225\u306b\u8a08\u7b97\u3057\u3066\u8db3\u3057\u5408\u308f\u305b\u308b\u3002\u4f8b\u3048\u3070A, B, C\u306e3\u4eba\u306e\u5834\u5408\u306f\u3001\n\u5168\u54e1\u7570\u306a\u308b\u8a95\u751f\u65e5\u3068\u306a\u308b\u78ba\u7387 =\n   (A\u304c1/1\u3001B\u304c1/2\u3001C\u304c1/3\u3067\u3042\u308b\u78ba\u7387)\n + (A\u304c1/1\u3001B\u304c1/2\u3001C\u304c1/4\u3067\u3042\u308b\u78ba\u7387)\n + ...\n + (A\u304c12/31\u3001B\u304c12/30\u3001C\u304c12/29\u3067\u3042\u308b\u78ba\u7387)\n\n1 - \\left. p(n) \\right|_{n=3} = a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-1} a_{N-2} a_{N-3}\n1\u2212p(n)|n=3=a0a1a2+a0a1a3+\u22ef+aN\u22121aN\u22122aN\u22123{1 - \\left. p(n) \\right|_{n=3} = a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-1} a_{N-2} a_{N-3}\n}\n\u3053\u308c\u3092\u8a08\u7b97\u3059\u308b\u306b\u306f\u3001\u78ba\u7387\u5206\u5e03\u306e\u914d\u5217 $a \u304b\u3089 n \u500b\u3092\u53d6\u308a\u51fa\u3057\u3066\u4e26\u3079\u305f\u6570\u306e\u7a4d\u3092\u8a08\u7b97\u3057\u3001\u305d\u308c\u3092\u5168\u3066\u8db3\u3057\u5408\u308f\u305b\u308c\u3070\u3044\u3044\u3002\n\ncalc1.rb\n# \u5b89\u5168\u306e\u305f\u3081\u3001p_bar[3]\u307e\u3067\u6c42\u3081\u3066\u7d42\u4e86\u3055\u305b\u308b\np_bar = (0..3).collect { |n| $a.permutation(n).inject(0) { |sum,ary| sum + ary.inject(1, :*) } }\n\n\n\u3057\u304b\u3057\u3001\u3053\u306e\u65b9\u6cd5\u306f n = 3 \u3067\u3082\u6642\u9593\u304c\u304b\u304b\u308a\u300130\u4eba\u306e\u5834\u5408\u306a\u3069\u306b\u306f\u5230\u5e95\u5bfe\u5fdc\u3067\u304d\u306a\u3044\u3002\u9806\u5217\u304b\u3089\u7d44\u307f\u5408\u308f\u305b\u306b\u5909\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u304c\u6839\u672c\u7684\u306a\u89e3\u6c7a\u306b\u306f\u306a\u3089\u306a\u3044\u3002\n\n\u8a08\u7b97\u306e\u6539\u5584\n\u5404\u9806\u5217\u306e\u7a4d\u3092\u8db3\u3057\u5408\u308f\u305b\u308b\u3068\u3044\u3046\u5f0f\u3092 aN\u22121a_{N-1} \u3092\u542b\u3080\u9805\u3068\u542b\u307e\u306a\u3044\u9805\u306b\u5206\u3051\u3066\u307f\u308b\u3068\u3001NN \u304c\u3088\u308a\u5c0f\u3055\u3044\u554f\u984c\u306e\u8a08\u7b97\u7d50\u679c\u3092\u5229\u7528\u3057\u3066\u6c42\u3081\u3089\u308c\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\\begin{align}\n\\left. f(N, n) \\right|_{n=3} &= a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-1} a_{N-2} a_{N-3} \\\\\n&= \\left( a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-2} a_{N-3} a_{N-4} \\right) + \\left( a_0 a_1 + a_0 a_2 + \\cdots + a_{N-2} a_{N-3} \\right) n a_{N-1} \\\\\n&= f(N-1, n) + n a_{N-1} f(N-1, n-1)\n\\end{align}\nf(N,n)|n=3=a0a1a2+a0a1a3+\u22ef+aN\u22121aN\u22122aN\u22123=(a0a1a2+a0a1a3+\u22ef+aN\u22122aN\u22123aN\u22124)+(a0a1+a0a2+\u22ef+aN\u22122aN\u22123)naN\u22121=f(N\u22121,n)+naN\u22121f(N\u22121,n\u22121){\\begin{align}\n\\left. f(N, n) \\right|_{n=3} &= a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-1} a_{N-2} a_{N-3} \\\\\n&= \\left( a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-2} a_{N-3} a_{N-4} \\right) + \\left( a_0 a_1 + a_0 a_2 + \\cdots + a_{N-2} a_{N-3} \\right) n a_{N-1} \\\\\n&= f(N-1, n) + n a_{N-1} f(N-1, n-1)\n\\end{align}\n}\n\u3053\u308c\u3092\u518d\u5e30\u3067\u5b9f\u88c5\u3059\u308b\u3002\u9ad8\u901f\u5316\u306e\u305f\u3081\u306b\u3001\u540c\u3058\u8a08\u7b97\u3092\u4f55\u5ea6\u3082\u3057\u306a\u3044\u3088\u3046\u30e1\u30e2\u5316\u3059\u308b\u3002\n\ncalc2.rb\n# $a[0,m]\u304b\u3089n\u500b\u3092\u4e26\u3079\u3066\u639b\u3051\u305f\u6570\u306e\u7dcf\u548c\u3092\u6c42\u3081\u308b\u30e1\u30bd\u30c3\u30c9\n$table = Array.new(N + 1) { Array.new(N + 1) }\ndef f(m, n)\n    $table[m][n] ||= (\n        if n == 0\n            1\n        elsif m < n\n            0\n        else\n            f(m - 1, n) + n * $a[m-1] * f(m - 1, n - 1)\n        end\n    )\nend\n\np_bar = (0..N).collect { |n| f(N, n) }\n\n\n\n\u3055\u3089\u306b\u6539\u5584\n$table \u3092\u4e8b\u524d\u306b\u5168\u3066\u57cb\u3081\u3066\u3057\u307e\u3048\u3070\u3001\u518d\u5e30\u547c\u3073\u51fa\u3057\u304c\u7121\u304f\u306a\u308b\u3046\u3048\u306b p_bar[0..N] \u3092\u4e00\u5ea6\u306b\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001\u9806\u5e8f\u306b\u6c17\u3092\u4ed8\u3051\u3066 p_bar \u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u3067\u30012\u6b21\u5143\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3089\u305a\u306b\u7d50\u679c\u3092\u6c42\u3081\u3066\u3044\u308b\u3002\n\ncalc3.rb\np_bar = Array.new(N + 1, 0)\np_bar[0] = 1\n\n(1..N).each do |m|\n    (1..m).reverse_each do |n|\n        p_bar[n] += n * $a[m-1] * p_bar[n-1]\n    end\nend\n\n\n\n\u8a08\u7b97\u7d50\u679c\np(n)p(n) \u306e\u5024\u3092\u6bd4\u8f03\u3057\u3066\u307f\u308b\u3002\uff08 1 - p_bar[n] \u3067\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\uff09\n\n\n\nnn\n\u4e00\u69d8\u5206\u5e03\n\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\n\n\n\n\n20\n0.411438\n0.420638\n\n\n30\n0.706316\n0.716744\n\n\n40\n0.891232\n0.898074\n\n\n\n\u504f\u308a\u306e\u3042\u308b\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u65b9\u304c\u3001\u540c\u3058\u8a95\u751f\u65e5\u306e\u7d44\u304c\u3067\u304d\u308b\u78ba\u7387\u304c\u305f\u3057\u304b\u306b\u9ad8\u304f\u306a\u3063\u3066\u3044\u308b\u3002\u8907\u6570\u5e74\u306e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u305f\u5834\u5408\u306f\u3001\u504f\u308a\u304c\u6e1b\u308b\u305f\u3081\u5dee\u306f\u5c0f\u3055\u304f\u306a\u308b\u304c\u3001\u305d\u308c\u3067\u3082\u4e00\u69d8\u5206\u5e03\u3088\u308a\u9ad8\u3044\u78ba\u7387\u3068\u306a\u308b\u3002\n\n\n\n\n\u51fa\u5178\uff1a\u539a\u751f\u52b4\u50cd\u7701 \u4eba\u53e3\u52d5\u614b\u8abf\u67fb \u4fdd\u7ba1\u7d71\u8a08\u8868\uff08\u5831\u544a\u66f8\u975e\u63b2\u8f09\u8868\uff09 \u300c\u51fa\u751f\u6570\uff0c\u51fa\u751f\u5e74\u6708\u65e5\u6642\u30fb\u51fa\u751f\u306e\u5834\u6240\u5225\u300d\u00a0\u21a9\n\n\n\n[\u8a95\u751f\u65e5\u306e\u30d1\u30e9\u30c9\u30c3\u30af\u30b9](http://ja.wikipedia.org/wiki/\u8a95\u751f\u65e5\u306e\u30d1\u30e9\u30c9\u30c3\u30af\u30b9)\u3068\u306f\u3001\u300c$n$ \u4eba\u304c\u96c6\u307e\u3063\u305f\u3068\u304d\u306b\u305d\u306e\u4e2d\u306b\u540c\u3058\u8a95\u751f\u65e5\u306e\u7d44\u304c\u3067\u304d\u308b\u78ba\u7387 $p(n)$ \u3092\u6c42\u3081\u308b\u300d\u3068\u3044\u3063\u305f\u554f\u984c\uff08\u8a95\u751f\u65e5\u554f\u984c\uff09\u304c\u3001\u76f4\u611f\u306b\u5408\u308f\u306a\u3044\u307b\u3069\u5927\u304d\u306a\u78ba\u7387\u3092\u3068\u308b\u3068\u3044\u3046\u3082\u306e\u300230\u4eba\u304f\u3089\u3044\u306e\u30e1\u30f3\u30d0\u30fc\u3067\u5b9f\u969b\u306b\u540c\u3058\u8a95\u751f\u65e5\u306e\u7d44\u304c\u3067\u304d\u308b\u304b\u8a66\u3059\u3068\u76db\u308a\u4e0a\u304c\u308b\u3002\u4e00\u65b9\u3067\u30cf\u30c3\u30b7\u30e5\u95a2\u6570\u306e\u885d\u7a81\u3068\u3044\u3046\u8a71\u306b\u7f6e\u304d\u63db\u3048\u308b\u3068\u3001\u4e00\u898b\u30cf\u30c3\u30b7\u30e5\u5024\u306e\u6e80\u676f\u306b\u307b\u3069\u9060\u3044\u30e1\u30f3\u30d0\u30fc\u6570\u3067\u3082\u308f\u308a\u3068\u885d\u7a81\u304c\u8d77\u304d\u3084\u3059\u3044\u3068\u3044\u3046\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u3066\u3001\u885d\u7a81\u3092\u907f\u3051\u308b\u306b\u306f\u30cf\u30c3\u30b7\u30e5\u5024\u3092\u5341\u5206\u306b\u5927\u304d\u304f\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u3068\u3053\u308d\u3067\u3001\u3053\u306e\u554f\u984c\u3092\u8003\u3048\u308b\u3068\u304d\u306f\u3075\u3064\u3046\u300c365\u65e5\u3069\u308c\u3067\u3082\u540c\u3058\u78ba\u7387\u300d\u3068\u3044\u3046\u524d\u63d0\u3092\u304a\u304f\u304c\u3001\u51fa\u751f\u6570\u306f\u300c9\u6708\u306b\u591a\u3044\u300d\u300c\u4f11\u65e5\u306f\u5c11\u306a\u3044\u300d\u306a\u3069\u306e\u3070\u3089\u3064\u304d\u304c\u3042\u308b\u3002\u78ba\u7387\u304c\u504f\u3063\u3066\u3044\u308b\u3068\u540c\u3058\u8a95\u751f\u65e5\u306e\u7d44\u304c\u3067\u304d\u308b\u78ba\u7387\u306f\u4e0a\u304c\u308b\u306f\u305a\u3067\u3042\u308b\u3002\u3053\u308c\u3092\u5b9f\u969b\u306b\u6c42\u3081\u3066\u307f\u308b\u3002\n\n## \u78ba\u7387\u4e00\u69d8\u306e\u5834\u5408\uff08\u304a\u3055\u3089\u3044\uff09\n\u300c\u5c11\u306a\u304f\u3068\u30821\u3064\u3042\u308b\u300d\u3068\u3044\u3046\u5834\u5408\u306e\u78ba\u7387\u3092\u6c42\u3081\u308b\u3068\u304d\u306f\u3001\u6b63\u53cd\u5bfe\u306e\u300c\u5168\u304f\u306a\u3044\u300d\u3068\u3044\u3046\u78ba\u7387\u3092\u6c42\u3081\u30661\u304b\u3089\u5f15\u304f\u3068\u7c21\u5358\u306a\u5834\u5408\u304c\u591a\u3044\u3002\u8a95\u751f\u65e5\u554f\u984c\u3067\u306f\u300c$n$ \u4eba\u306e\u8a95\u751f\u65e5\u304c\u5168\u3066\u7570\u306a\u308b\u78ba\u7387 $\\bar{p}(n)=1-p(n)$\u300d\u3092\u6c42\u3081\u308c\u3070\u3044\u3044\u3053\u3068\u306b\u306a\u308b\u3002\u30e1\u30f3\u30d0\u30fc\u306e\u8a95\u751f\u65e5\u304c\u3068\u3042\u308b\u30d1\u30bf\u30fc\u30f3\uff08\u4f8b\u3048\u3070A\u304c1/1\u751f\u307e\u308c\u3001B\u304c1/2\u751f\u307e\u308c\u3001C\u304c1/3\u751f\u307e\u308c\u3001\u2026\uff09\u306b\u306a\u308b\u78ba\u7387\u306f\u3069\u308c\u3082 $\\frac{1}{365^n}$\u3001\u8a95\u751f\u65e5\u304c\u5168\u3066\u7570\u306a\u308b\u5834\u5408\u306e\u6570\u306f $\\_{365}P_{n}$ \u3067\u3042\u308b\u306e\u3067\u3001\n\n```math\n1-p(n) = \\frac{_{365}P_{n}}{365^n} = \\frac{365!}{365^n \\left( 365-n \\right)!}\n```\n\n```ruby:calc0.rb\nN = 365\na = 1.0 / N\np_bar = (1..N).inject([1]) { |ary,n| ary << ary.last * (N - n + 1) * a }\n```\n\n## \u78ba\u7387\u304c\u4e00\u69d8\u3067\u306a\u3044\u5834\u5408\n\u8a95\u751f\u65e5\u304c\u65e5\u4ed8 $i$ \u3067\u3042\u308b\u78ba\u7387\u3092 $a_i$ \uff08\u914d\u5217\u306e\u6dfb\u5b57\u306e\u90fd\u5408\u3067 $0 \\le i < N$ \uff09\u3068\u3059\u308b\u3002\u4e00\u69d8\u306e\u3068\u304d\u3068\u540c\u3058\u3088\u3046\u306b\u3001\u5168\u54e1\u306e\u8a95\u751f\u65e5\u304c\u7570\u306a\u308b\u78ba\u7387\u3092\u5148\u306b\u6c42\u3081\u308b\u3002\n\n### \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\n2014\u5e74\u306e\u51fa\u751f\u6570[^ref]\u3092\u57fa\u306b\u3001\u78ba\u7387\u5206\u5e03\u306e\u914d\u5217 `$a` \u3068\u305d\u306e\u9577\u3055 `N` \u3092\u4f5c\u6210\u3059\u308b\u3002\u5b9f\u5728\u3057\u306a\u3044\u65e5\u306b\u3064\u3044\u3066\u306f\u4eba\u6570\u3092\u30bc\u30ed\u3068\u3057\u3066\u3044\u308b\u304c\u3001\u8a08\u7b97\u4e0a\u554f\u984c\u306f\u7121\u3044\u3002\n\n```ruby:test_data.rb\nx = [\n 1873, 1883, 1948, 2430, 2193, 3156, 3390, 3112, 2966, 3058, 2309, 1999, 2022, 3086, 3323, 3136, 3078, 2317, 1941, 2919, 3108, 3142, 3047, 3007, 2300, 1965, 2979, 3136, 2905, 3001, 2843,\n 2288, 2013, 2864, 3032, 2922, 2800, 3043, 2204, 2013, 2831, 2088, 2980, 3046, 2870, 2215, 1906, 2841, 3090, 2791, 2896, 2800, 2200, 1932, 2705, 3010, 2885, 2789, 2843,    0,    0,    0,\n 2230, 1886, 2922, 2967, 2887, 2819, 2797, 2238, 1934, 2908, 2915, 2918, 2764, 2878, 2215, 1896, 2830, 3112, 2899, 2880, 1928, 2028, 1925, 2776, 3047, 2944, 2683, 2770, 2019, 1879, 2446,\n 2354, 3177, 3065, 2818, 2149, 1813, 2647, 3018, 2730, 2925, 3004, 2135, 1872, 2714, 3174, 2904, 2764, 2703, 2124, 1857, 2736, 3088, 2962, 2915, 2930, 2157, 1897, 3049, 2067, 3086,    0,\n 3436, 3345, 2079, 1964, 2043, 1942, 2974, 3265, 3199, 2374, 2008, 2999, 3020, 3060, 3033, 2993, 2259, 1985, 2808, 3097, 2818, 2886, 2829, 2231, 1882, 2877, 3124, 2860, 2835, 2889, 2196,\n 1977, 2858, 3156, 2938, 2825, 3021, 2232, 1887, 2810, 3220, 2897, 2996, 2999, 2233, 2009, 3038, 3174, 2898, 2932, 2916, 2316, 1968, 2861, 3135, 3049, 2937, 2935, 2221, 2006, 2957,    0,\n 3266, 3189, 3085, 3028, 2354, 2055, 3139, 3207, 3055, 3067, 3039, 2326, 2040, 2912, 3135, 3316, 3223, 3227, 2425, 2064, 2116, 3306, 3615, 3191, 3215, 2515, 2059, 2967, 3252, 3029, 3099,\n 3159, 2371, 2121, 3028, 3331, 3236, 3164, 3284, 2354, 2114, 3017, 3482, 3064, 2721, 2725, 2414, 2159, 3129, 3256, 3257, 3041, 3113, 2291, 2156, 3007, 3289, 3134, 3052, 2892, 2377, 1994,\n 3038, 3234, 3285, 2946, 3172, 2325, 1950, 3158, 3481, 3403, 3186, 3273, 2410, 2244, 2276, 3394, 3588, 3500, 3538, 2638, 2262, 3372, 2544, 3415, 3609, 3436, 2676, 2297, 3276, 3383,    0,\n 3330, 3166, 3256, 2480, 2086, 3037, 3238, 3180, 3097, 3392, 2332, 2028, 2051, 3141, 3246, 3119, 3080, 2248, 2036, 3022, 3211, 3083, 3011, 3118, 2301, 1991, 2961, 3175, 3009, 3012, 3155,\n 2422, 2094, 2010, 3177, 3345, 3010, 3188, 2322, 2046, 2941, 3319, 2998, 2936, 2936, 2268, 1984, 2887, 3120, 3016, 3085, 3054, 2380, 1951, 1958, 3148, 3185, 3070, 3021, 2172, 1950,    0,\n 2887, 3117, 3048, 2853, 3005, 2238, 2008, 2928, 3188, 3020, 2917, 3048, 2275, 1964, 2993, 3256, 3144, 3131, 3109, 2291, 2099, 3304, 2124, 3392, 3748, 3583, 2423, 1895, 2680, 2372, 2003,\n]\nsum = x.inject(:+)\n$a = x.collect { |x_i| x_i.to_f / sum }\nN = $a.size\n```\n\n[^ref]: \u51fa\u5178\uff1a\u539a\u751f\u52b4\u50cd\u7701 [\u4eba\u53e3\u52d5\u614b\u8abf\u67fb](http://www.mhlw.go.jp/toukei/list/81-1.html) \u4fdd\u7ba1\u7d71\u8a08\u8868\uff08\u5831\u544a\u66f8\u975e\u63b2\u8f09\u8868\uff09 \u300c\u51fa\u751f\u6570\uff0c\u51fa\u751f\u5e74\u6708\u65e5\u6642\u30fb\u51fa\u751f\u306e\u5834\u6240\u5225\u300d\n\n### \u7d20\u76f4\u306b\u8a08\u7b97\n\u7686\u304c\u3068\u3042\u308b\u7570\u306a\u308b\u8a95\u751f\u65e5\u306e\u30d1\u30bf\u30fc\u30f3\u306b\u306a\u308b\u78ba\u7387\u306f\u305d\u306e\u8a95\u751f\u65e5\u306b\u4f9d\u5b58\u3059\u308b\u306e\u3067\u3001\u500b\u5225\u306b\u8a08\u7b97\u3057\u3066\u8db3\u3057\u5408\u308f\u305b\u308b\u3002\u4f8b\u3048\u3070A, B, C\u306e3\u4eba\u306e\u5834\u5408\u306f\u3001\n\n```text\n\u5168\u54e1\u7570\u306a\u308b\u8a95\u751f\u65e5\u3068\u306a\u308b\u78ba\u7387 =\n   (A\u304c1/1\u3001B\u304c1/2\u3001C\u304c1/3\u3067\u3042\u308b\u78ba\u7387)\n + (A\u304c1/1\u3001B\u304c1/2\u3001C\u304c1/4\u3067\u3042\u308b\u78ba\u7387)\n + ...\n + (A\u304c12/31\u3001B\u304c12/30\u3001C\u304c12/29\u3067\u3042\u308b\u78ba\u7387)\n```\n\n```math\n1 - \\left. p(n) \\right|_{n=3} = a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-1} a_{N-2} a_{N-3}\n```\n\n\u3053\u308c\u3092\u8a08\u7b97\u3059\u308b\u306b\u306f\u3001\u78ba\u7387\u5206\u5e03\u306e\u914d\u5217 `$a` \u304b\u3089 `n` \u500b\u3092\u53d6\u308a\u51fa\u3057\u3066\u4e26\u3079\u305f\u6570\u306e\u7a4d\u3092\u8a08\u7b97\u3057\u3001\u305d\u308c\u3092\u5168\u3066\u8db3\u3057\u5408\u308f\u305b\u308c\u3070\u3044\u3044\u3002\n\n```ruby:calc1.rb\n# \u5b89\u5168\u306e\u305f\u3081\u3001p_bar[3]\u307e\u3067\u6c42\u3081\u3066\u7d42\u4e86\u3055\u305b\u308b\np_bar = (0..3).collect { |n| $a.permutation(n).inject(0) { |sum,ary| sum + ary.inject(1, :*) } }\n```\n\n\u3057\u304b\u3057\u3001\u3053\u306e\u65b9\u6cd5\u306f `n = 3` \u3067\u3082\u6642\u9593\u304c\u304b\u304b\u308a\u300130\u4eba\u306e\u5834\u5408\u306a\u3069\u306b\u306f\u5230\u5e95\u5bfe\u5fdc\u3067\u304d\u306a\u3044\u3002\u9806\u5217\u304b\u3089\u7d44\u307f\u5408\u308f\u305b\u306b\u5909\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u308b\u304c\u6839\u672c\u7684\u306a\u89e3\u6c7a\u306b\u306f\u306a\u3089\u306a\u3044\u3002\n\n### \u8a08\u7b97\u306e\u6539\u5584\n\u5404\u9806\u5217\u306e\u7a4d\u3092\u8db3\u3057\u5408\u308f\u305b\u308b\u3068\u3044\u3046\u5f0f\u3092 $a_{N-1}$ \u3092\u542b\u3080\u9805\u3068\u542b\u307e\u306a\u3044\u9805\u306b\u5206\u3051\u3066\u307f\u308b\u3068\u3001$N$ \u304c\u3088\u308a\u5c0f\u3055\u3044\u554f\u984c\u306e\u8a08\u7b97\u7d50\u679c\u3092\u5229\u7528\u3057\u3066\u6c42\u3081\u3089\u308c\u308b\u3053\u3068\u304c\u5206\u304b\u308b\u3002\n\n```math\n\\begin{align}\n\\left. f(N, n) \\right|_{n=3} &= a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-1} a_{N-2} a_{N-3} \\\\\n&= \\left( a_0 a_1 a_2 + a_0 a_1 a_3 + \\cdots + a_{N-2} a_{N-3} a_{N-4} \\right) + \\left( a_0 a_1 + a_0 a_2 + \\cdots + a_{N-2} a_{N-3} \\right) n a_{N-1} \\\\\n&= f(N-1, n) + n a_{N-1} f(N-1, n-1)\n\\end{align}\n```\n\n\u3053\u308c\u3092\u518d\u5e30\u3067\u5b9f\u88c5\u3059\u308b\u3002\u9ad8\u901f\u5316\u306e\u305f\u3081\u306b\u3001\u540c\u3058\u8a08\u7b97\u3092\u4f55\u5ea6\u3082\u3057\u306a\u3044\u3088\u3046\u30e1\u30e2\u5316\u3059\u308b\u3002\n\n```ruby:calc2.rb\n# $a[0,m]\u304b\u3089n\u500b\u3092\u4e26\u3079\u3066\u639b\u3051\u305f\u6570\u306e\u7dcf\u548c\u3092\u6c42\u3081\u308b\u30e1\u30bd\u30c3\u30c9\n$table = Array.new(N + 1) { Array.new(N + 1) }\ndef f(m, n)\n\t$table[m][n] ||= (\n\t\tif n == 0\n\t\t\t1\n\t\telsif m < n\n\t\t\t0\n\t\telse\n\t\t\tf(m - 1, n) + n * $a[m-1] * f(m - 1, n - 1)\n\t\tend\n\t)\nend\n\np_bar = (0..N).collect { |n| f(N, n) }\n```\n\n### \u3055\u3089\u306b\u6539\u5584\n`$table` \u3092\u4e8b\u524d\u306b\u5168\u3066\u57cb\u3081\u3066\u3057\u307e\u3048\u3070\u3001\u518d\u5e30\u547c\u3073\u51fa\u3057\u304c\u7121\u304f\u306a\u308b\u3046\u3048\u306b `p_bar[0..N]` \u3092\u4e00\u5ea6\u306b\u6c42\u3081\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001\u9806\u5e8f\u306b\u6c17\u3092\u4ed8\u3051\u3066 `p_bar` \u3092\u66f4\u65b0\u3059\u308b\u3053\u3068\u3067\u30012\u6b21\u5143\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u3089\u305a\u306b\u7d50\u679c\u3092\u6c42\u3081\u3066\u3044\u308b\u3002\n\n```ruby:calc3.rb\np_bar = Array.new(N + 1, 0)\np_bar[0] = 1\n\n(1..N).each do |m|\n\t(1..m).reverse_each do |n|\n\t\tp_bar[n] += n * $a[m-1] * p_bar[n-1]\n\tend\nend\n```\n\n### \u8a08\u7b97\u7d50\u679c\n$p(n)$ \u306e\u5024\u3092\u6bd4\u8f03\u3057\u3066\u307f\u308b\u3002\uff08 `1 - p_bar[n]` \u3067\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\uff09\n\n| $n$ | \u4e00\u69d8\u5206\u5e03 | \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf |\n|----:|---------:|---------:|\n|  20 | 0.411438 | 0.420638 |\n|  30 | 0.706316 | 0.716744 |\n|  40 | 0.891232 | 0.898074 |\n\n\u504f\u308a\u306e\u3042\u308b\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u65b9\u304c\u3001\u540c\u3058\u8a95\u751f\u65e5\u306e\u7d44\u304c\u3067\u304d\u308b\u78ba\u7387\u304c\u305f\u3057\u304b\u306b\u9ad8\u304f\u306a\u3063\u3066\u3044\u308b\u3002\u8907\u6570\u5e74\u306e\u30c7\u30fc\u30bf\u3092\u7528\u3044\u305f\u5834\u5408\u306f\u3001\u504f\u308a\u304c\u6e1b\u308b\u305f\u3081\u5dee\u306f\u5c0f\u3055\u304f\u306a\u308b\u304c\u3001\u305d\u308c\u3067\u3082\u4e00\u69d8\u5206\u5e03\u3088\u308a\u9ad8\u3044\u78ba\u7387\u3068\u306a\u308b\u3002\n"}