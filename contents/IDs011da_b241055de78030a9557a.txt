{"context": " More than 1 year has passed since last update.\u3010\u81ea\u52d5\u66f8\u304d\u51fa\u3057\u3055\u308c\u305f\u753b\u50cf\u3011\n\n\u3010PSD\u30c7\u30fc\u30bf\u3011\n\u30ec\u30a4\u30e4\u30fc\u30bb\u30c3\u30c8\u306b\u300cactionSet\u300d\u3068\u3044\u3046\u540d\u524d\u3092\u3064\u3051\u3066\u3001\n\u81ea\u52d5\u5316\u3057\u305f\u3044\u5185\u5bb9\u306e\u30ec\u30a4\u30e4\u30fc\u306b\u4e0a\u304b\u3089\u9806\u756a\u306blayer0,layer1...\u3068\u540d\u524d\u3092\u3064\u3051\u3066\u3044\u304f\u3002\n\u81ea\u52d5\u5316\u3059\u308b\u30ec\u30a4\u30e4\u30fc\u306e\u30bf\u30a4\u30d7\u306f\u300c\u30c6\u30ad\u30b9\u30c8\u300d\u3068\u300c\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u300d\u306e\u307f\u3002\n\n\u3010\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb\u3011\nPSD\u30c7\u30fc\u30bf\u304b\u3089\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u958b\u3044\u305f\u30a4\u30e1\u30fc\u30b8\u753b\u50cf\u3002\u30ec\u30a4\u30e4\u30fc\u30bb\u30c3\u30c8\u306e\u8868\u793a\u30fb\u975e\u8868\u793a\u5207\u66ff\u3067\u51e6\u7406\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4f5c\u6210\u3057\u305f\u30ec\u30a4\u30e4\u30fc\u304c1\u3064\u3060\u3051\u3067\u3082\u30bb\u30c3\u30c8\u306b\u5165\u308c\u3066\u7ba1\u7406\u3002\n\n\n\u66f4\u65b0\u30ea\u30b9\u30c8\nvar data = {\n\n  bnr_sale:{ // psd\u30d5\u30a1\u30a4\u30eb\u540d\n    doc:{\n      dir   :\"psd\u30d5\u30a1\u30a4\u30eb\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\",\n      upDir :\"\u30a2\u30c3\u30d7\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\",\n      format:\"png\",\n    },\n    // [layer0,layer1,layer2...] (actionSet\u5185\u306e\u30ec\u30a4\u30e4\u30fc\u9806)\n    images:{\n      shibuya:  [\"\u6e0b\u8c37\u5e97\",\"2/1\",\"(Sun)\",\"\u30be\u30a6\",\"\uffe512,500\",\"\u30b5\u30eb\",\"\uffe513,500\"],\n      ikebukuro:[\"\u6c60\u888b\u5e97\",\"2/1\",\"(Sun)\",\"\u30be\u30a6\",\"\uffe512,500\",\"\u30b5\u30eb\",\"\uffe513,500\"],\n      shinagawa:[\"\u54c1\u5ddd\u5e97\",\"2/1\",\"(Sun)\",\"\u30be\u30a6\",\"\uffe512,500\",\"\u30b5\u30eb\",\"\uffe513,500\"],\n      shinjuku: [\"\u65b0\u5bbf\u5e97\",\"7/21\",\"(Mon)\",\"\u30b5\u30eb\",\"\uffe513,500\",\"\u30a2\u30d2\u30eb\",\"\uffe514,500\"],\n      harajuku: [\"\u539f\u5bbf\u5e97\",\"7/21\",\"(Mon)\",\"\u30b5\u30eb\",\"\uffe513,500\",\"\u30a2\u30d2\u30eb\",\"\uffe514,500\"],\n      roppongi: [\"\u516d\u672c\u6728\u5e97\",\"7/21\",\"(Mon)\",\"\u30b5\u30eb\",\"\uffe513,500\",\"\u30a2\u30d2\u30eb\",\"\uffe514,500\"],\n      ginza:    [\"\u9280\u5ea7\u5e97\",\"12/22\",\"(Tue)\",\"\u30a2\u30d2\u30eb\",\"\uffe514,500\",\"\u30be\u30a6\",\"\uffe512,500\"],\n    }\n  },\n\n  img_product:{ // psd\u30d5\u30a1\u30a4\u30eb\u540d\n    doc:{\n      dir   :\"psd\u30d5\u30a1\u30a4\u30eb\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\",\n      upDir :\"\u30a2\u30c3\u30d7\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\",\n      format:\"png\",\n    },\n    // [layer0,layer1,layer2] (actionSet\u5185\u306e\u30ec\u30a4\u30e4\u30fc\u9806)\n    images:[\n      [\"\u30be\u30a6\",\"new\",\"\uffe512,500\"],\n      [\"\u30b5\u30eb\",\"new\",\"\uffe513,500\"],\n      [\"\u30a2\u30d2\u30eb\",\"new\",\"\uffe514,500\"],\n      [\"\u30be\u30a6\",\"old\",\"\uffe512,500\"],\n      [\"\u30b5\u30eb\",\"old\",\"\uffe513,500\"],\n      [\"\u30a2\u30d2\u30eb\",\"old\",\"\uffe514,500\"],\n    ]\n  }\n\n};\n\n\nimages\u304carray\u306e\u5834\u5408\u306f\u300cPSD\u30d5\u30a1\u30a4\u30eb\u540d _ 1.png\u300d\u3001object\u3067KEY\u304c\u3042\u308b\u5834\u5408\u306f\u300cPSD\u30d5\u30a1\u30a4\u30eb\u540d _ KEY.png\u300d\u3068\u3044\u3046\u540d\u79f0\u3067\u753b\u50cf\u304c\u66f8\u304d\u51fa\u3055\u308c\u308b\u3002\n\n\u95a2\u6570\n// #\u30d1\u30b9\u304b\u3089\u30ec\u30a4\u30e4\u30fc\u3092\u53d6\u5f97\nfunction getlayer(layerPath){...}\n\n// #\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u958b\u304f\nfunction openSmartObject(artLayer){...}\n\n\n=> \u30d1\u30b9\u304b\u3089\u30ec\u30a4\u30e4\u30fc\u3092\u53d6\u5f97\n=> \u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u958b\u304f\n\u3010\u51e6\u7406\u306e\u6d41\u308c\u3011\n\nPSD\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n\u300a\u66f4\u65b0\u30ea\u30b9\u30c8\u300b\u306e\u30ea\u30b9\u30c8\u306e\u9806\u756a\u3068\u540c\u69d8\u306e actionSet / layer\u756a\u53f7 \u3092\u9078\u629e\n\u30ec\u30a4\u30e4\u30fc\u304c\u300c\u30c6\u30ad\u30b9\u30c8\u30ec\u30a4\u30e4\u30fc\u300d\u304b\u300c\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u300d\u304b\u3092\u5224\u5225\n\u300c\u30c6\u30ad\u30b9\u30c8\u30ec\u30a4\u30e4\u30fc\u300d\u306e\u5834\u5408\u306f\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\n\u300c\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u300d\u306e\u5834\u5408\u306f\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u3001\u300a\u66f4\u65b0\u30ea\u30b9\u30c8\u300b\u3068\u540c\u69d8\u306e\u540d\u524d\u306e\u30ec\u30a4\u30e4\u30fc\u30bb\u30c3\u30c8\u3092\u9078\u629e\u3002\u305d\u308c\u4ee5\u5916\u306e\u30ec\u30a4\u30e4\u30fc\u30bb\u30c3\u30c8\u306f\u975e\u8868\u793a\u3002\n\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3057\u3066\u3001\u9589\u3058\u308b\n\u5909\u66f4\u304c\u52a0\u308f\u3063\u305f\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306f\u30e9\u30b9\u30bf\u30e9\u30a4\u30ba\u3057\u3066\u3001\u540c\u6642\u5229\u7528\u3057\u3066\u3044\u308b\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5f71\u97ff\u304c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u3002(\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306e\u51e6\u7406\u7d42\u4e86)\n\u753b\u50cf\u3092\u66f8\u304d\u51fa\u3059\n\u4fdd\u5b58\u305b\u305a\u306bPSD\u30d5\u30a1\u30a4\u30eb\u3092\u9589\u3058\u308b\nPSD\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f...\n\n\n\u5b9f\u884c\nfor (file in data){\n  var doc = data[file].doc,\n    type = (data[file].images instanceof Array) ? \"array\" : \"object\";\n\n  for (iI in data[file].images){\n    // \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n    app.open(new File(doc.dir+file+\".psd\"));\n    var image = data[file].images[iI];\n\n    for (iL=0; iL<image.length; iL+=1){\n      var val = image[iL];\n\n      switch (getlayer(\"actionSet/layer\"+iL).kind){\n        // \u30c6\u30ad\u30b9\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306e\u5834\u5408\n        case LayerKind.TEXT :\n          // \u30c6\u30ad\u30b9\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u4e0a\u66f8\u304d\u3059\u308b\n          getlayer(\"actionSet/layer\"+iL).textItem.contents = val;\n          break;\n        // \u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306e\u5834\u5408\n        case LayerKind.SMARTOBJECT :\n          // #\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u958b\u304f\n          openSmartObject(getlayer(\"actionSet/layer\"+iL));\n            // \u8868\u793a\u5207\u66ff\n            for (iA=0; iA<activeDocument.layerSets.length; iA+=1){\n              activeDocument.layerSets[iA].visible = false;\n            }\n            activeDocument.layerSets[val].visible = true;\n          // \u4fdd\u5b58\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u9589\u3058\u308b\n          activeDocument.close(SaveOptions.SAVECHANGES);\n          // \u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u30e9\u30b9\u30bf\u30e9\u30a4\u30ba\n          getlayer(\"actionSet/layer\"+iL).rasterize(RasterizeType.ENTIRELAYER);\n      }\n\n    }\n\n    // PNG\u306b\u66f8\u304d\u51fa\u3057\n    fileObj = new File(doc.upDir+file+'_'+(type == \"array\" ? (iI*1)+1 : iI));\n    pngOpt = new PNGSaveOptions();\n    pngOpt.interlaced = false;\n    activeDocument.saveAs(fileObj, pngOpt, true, Extension.LOWERCASE);\n\n    // \u4fdd\u5b58\u305b\u305a\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u9589\u3058\u308b\n    activeDocument.close(SaveOptions.DONOTSAVECHANGES);\n  }\n}\n\n\n\u3010\u81ea\u52d5\u66f8\u304d\u51fa\u3057\u3055\u308c\u305f\u753b\u50cf\u3011\n![\u81ea\u52d5\u66f8\u51fa\u3055\u308c\u305f\u753b\u50cf.png](https://qiita-image-store.s3.amazonaws.com/0/64055/7db34d7a-9a30-250e-a8fe-07676a1fe11a.png)\n\n\u3010PSD\u30c7\u30fc\u30bf\u3011\n\u30ec\u30a4\u30e4\u30fc\u30bb\u30c3\u30c8\u306b\u300cactionSet\u300d\u3068\u3044\u3046\u540d\u524d\u3092\u3064\u3051\u3066\u3001\n\u81ea\u52d5\u5316\u3057\u305f\u3044\u5185\u5bb9\u306e\u30ec\u30a4\u30e4\u30fc\u306b\u4e0a\u304b\u3089\u9806\u756a\u306blayer0,layer1...\u3068\u540d\u524d\u3092\u3064\u3051\u3066\u3044\u304f\u3002\n\u81ea\u52d5\u5316\u3059\u308b\u30ec\u30a4\u30e4\u30fc\u306e\u30bf\u30a4\u30d7\u306f\u300c\u30c6\u30ad\u30b9\u30c8\u300d\u3068\u300c\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u300d\u306e\u307f\u3002\n\n![psd\u30d5\u30a1\u30a4\u30eb.png](https://qiita-image-store.s3.amazonaws.com/0/64055/240c4c44-7ca4-2849-c823-a3856fe22dd9.png)\n\n\u3010\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb\u3011\nPSD\u30c7\u30fc\u30bf\u304b\u3089\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u958b\u3044\u305f\u30a4\u30e1\u30fc\u30b8\u753b\u50cf\u3002\u30ec\u30a4\u30e4\u30fc\u30bb\u30c3\u30c8\u306e\u8868\u793a\u30fb\u975e\u8868\u793a\u5207\u66ff\u3067\u51e6\u7406\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u4f5c\u6210\u3057\u305f\u30ec\u30a4\u30e4\u30fc\u304c1\u3064\u3060\u3051\u3067\u3082\u30bb\u30c3\u30c8\u306b\u5165\u308c\u3066\u7ba1\u7406\u3002\n\n![\u30b9\u30de\u30fc\u30c8\u30aa\u30d5\u3099\u30b7\u3099\u30a7\u30af\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb.png](https://qiita-image-store.s3.amazonaws.com/0/64055/8610db06-bb12-1d6b-5790-827bc535f581.png)\n\n```lang:\u66f4\u65b0\u30ea\u30b9\u30c8\nvar data = {\n\n  bnr_sale:{ // psd\u30d5\u30a1\u30a4\u30eb\u540d\n    doc:{\n      dir   :\"psd\u30d5\u30a1\u30a4\u30eb\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\",\n      upDir :\"\u30a2\u30c3\u30d7\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\",\n      format:\"png\",\n    },\n    // [layer0,layer1,layer2...] (actionSet\u5185\u306e\u30ec\u30a4\u30e4\u30fc\u9806)\n    images:{\n      shibuya:  [\"\u6e0b\u8c37\u5e97\",\"2/1\",\"(Sun)\",\"\u30be\u30a6\",\"\uffe512,500\",\"\u30b5\u30eb\",\"\uffe513,500\"],\n      ikebukuro:[\"\u6c60\u888b\u5e97\",\"2/1\",\"(Sun)\",\"\u30be\u30a6\",\"\uffe512,500\",\"\u30b5\u30eb\",\"\uffe513,500\"],\n      shinagawa:[\"\u54c1\u5ddd\u5e97\",\"2/1\",\"(Sun)\",\"\u30be\u30a6\",\"\uffe512,500\",\"\u30b5\u30eb\",\"\uffe513,500\"],\n      shinjuku: [\"\u65b0\u5bbf\u5e97\",\"7/21\",\"(Mon)\",\"\u30b5\u30eb\",\"\uffe513,500\",\"\u30a2\u30d2\u30eb\",\"\uffe514,500\"],\n      harajuku: [\"\u539f\u5bbf\u5e97\",\"7/21\",\"(Mon)\",\"\u30b5\u30eb\",\"\uffe513,500\",\"\u30a2\u30d2\u30eb\",\"\uffe514,500\"],\n      roppongi: [\"\u516d\u672c\u6728\u5e97\",\"7/21\",\"(Mon)\",\"\u30b5\u30eb\",\"\uffe513,500\",\"\u30a2\u30d2\u30eb\",\"\uffe514,500\"],\n      ginza:    [\"\u9280\u5ea7\u5e97\",\"12/22\",\"(Tue)\",\"\u30a2\u30d2\u30eb\",\"\uffe514,500\",\"\u30be\u30a6\",\"\uffe512,500\"],\n    }\n  },\n\n  img_product:{ // psd\u30d5\u30a1\u30a4\u30eb\u540d\n    doc:{\n      dir   :\"psd\u30d5\u30a1\u30a4\u30eb\u306e\u3042\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\",\n      upDir :\"\u30a2\u30c3\u30d7\u5148\u306e\u30c7\u30a3\u30ec\u30af\u30c8\",\n      format:\"png\",\n    },\n    // [layer0,layer1,layer2] (actionSet\u5185\u306e\u30ec\u30a4\u30e4\u30fc\u9806)\n    images:[\n      [\"\u30be\u30a6\",\"new\",\"\uffe512,500\"],\n      [\"\u30b5\u30eb\",\"new\",\"\uffe513,500\"],\n      [\"\u30a2\u30d2\u30eb\",\"new\",\"\uffe514,500\"],\n      [\"\u30be\u30a6\",\"old\",\"\uffe512,500\"],\n      [\"\u30b5\u30eb\",\"old\",\"\uffe513,500\"],\n      [\"\u30a2\u30d2\u30eb\",\"old\",\"\uffe514,500\"],\n    ]\n  }\n\n};\n```\n\nimages\u304carray\u306e\u5834\u5408\u306f\u300cPSD\u30d5\u30a1\u30a4\u30eb\u540d _ 1.png\u300d\u3001object\u3067KEY\u304c\u3042\u308b\u5834\u5408\u306f\u300cPSD\u30d5\u30a1\u30a4\u30eb\u540d _ KEY.png\u300d\u3068\u3044\u3046\u540d\u79f0\u3067\u753b\u50cf\u304c\u66f8\u304d\u51fa\u3055\u308c\u308b\u3002\n\n```lang:\u95a2\u6570\n// #\u30d1\u30b9\u304b\u3089\u30ec\u30a4\u30e4\u30fc\u3092\u53d6\u5f97\nfunction getlayer(layerPath){...}\n\n// #\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u958b\u304f\nfunction openSmartObject(artLayer){...}\n```\n=> [\u30d1\u30b9\u304b\u3089\u30ec\u30a4\u30e4\u30fc\u3092\u53d6\u5f97](http://qiita.com/s01038/items/d52825aa4e02a464a7c6)\n=> [\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u958b\u304f](http://qiita.com/s01038/items/1388bdcf63e058bf8848)\n\n\n\n\u3010\u51e6\u7406\u306e\u6d41\u308c\u3011\n\n* PSD\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n* \u300a\u66f4\u65b0\u30ea\u30b9\u30c8\u300b\u306e\u30ea\u30b9\u30c8\u306e\u9806\u756a\u3068\u540c\u69d8\u306e actionSet / layer\u756a\u53f7 \u3092\u9078\u629e\n* \u30ec\u30a4\u30e4\u30fc\u304c\u300c\u30c6\u30ad\u30b9\u30c8\u30ec\u30a4\u30e4\u30fc\u300d\u304b\u300c\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u300d\u304b\u3092\u5224\u5225\n* \u300c\u30c6\u30ad\u30b9\u30c8\u30ec\u30a4\u30e4\u30fc\u300d\u306e\u5834\u5408\u306f\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\n* \u300c\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u300d\u306e\u5834\u5408\u306f\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u3001\u300a\u66f4\u65b0\u30ea\u30b9\u30c8\u300b\u3068\u540c\u69d8\u306e\u540d\u524d\u306e\u30ec\u30a4\u30e4\u30fc\u30bb\u30c3\u30c8\u3092\u9078\u629e\u3002\u305d\u308c\u4ee5\u5916\u306e\u30ec\u30a4\u30e4\u30fc\u30bb\u30c3\u30c8\u306f\u975e\u8868\u793a\u3002\n* \u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30d5\u30a1\u30a4\u30eb\u3092\u4fdd\u5b58\u3057\u3066\u3001\u9589\u3058\u308b\n* \u5909\u66f4\u304c\u52a0\u308f\u3063\u305f\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306f\u30e9\u30b9\u30bf\u30e9\u30a4\u30ba\u3057\u3066\u3001\u540c\u6642\u5229\u7528\u3057\u3066\u3044\u308b\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u5f71\u97ff\u304c\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u3002(\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306e\u51e6\u7406\u7d42\u4e86)\n* \u753b\u50cf\u3092\u66f8\u304d\u51fa\u3059\n* \u4fdd\u5b58\u305b\u305a\u306bPSD\u30d5\u30a1\u30a4\u30eb\u3092\u9589\u3058\u308b\n* PSD\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f...\n\n\n\n```lang:\u5b9f\u884c\nfor (file in data){\n  var doc = data[file].doc,\n    type = (data[file].images instanceof Array) ? \"array\" : \"object\";\n\n  for (iI in data[file].images){\n    // \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n    app.open(new File(doc.dir+file+\".psd\"));\n    var image = data[file].images[iI];\n\n    for (iL=0; iL<image.length; iL+=1){\n      var val = image[iL];\n\n      switch (getlayer(\"actionSet/layer\"+iL).kind){\n        // \u30c6\u30ad\u30b9\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306e\u5834\u5408\n        case LayerKind.TEXT :\n          // \u30c6\u30ad\u30b9\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306e\u30b3\u30f3\u30c6\u30f3\u30c4\u3092\u4e0a\u66f8\u304d\u3059\u308b\n          getlayer(\"actionSet/layer\"+iL).textItem.contents = val;\n          break;\n        // \u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u306e\u5834\u5408\n        case LayerKind.SMARTOBJECT :\n          // #\u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u958b\u304f\n          openSmartObject(getlayer(\"actionSet/layer\"+iL));\n            // \u8868\u793a\u5207\u66ff\n            for (iA=0; iA<activeDocument.layerSets.length; iA+=1){\n              activeDocument.layerSets[iA].visible = false;\n            }\n            activeDocument.layerSets[val].visible = true;\n          // \u4fdd\u5b58\u3057\u3066\u30d5\u30a1\u30a4\u30eb\u3092\u9589\u3058\u308b\n          activeDocument.close(SaveOptions.SAVECHANGES);\n          // \u30b9\u30de\u30fc\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30fb\u30ec\u30a4\u30e4\u30fc\u3092\u30e9\u30b9\u30bf\u30e9\u30a4\u30ba\n          getlayer(\"actionSet/layer\"+iL).rasterize(RasterizeType.ENTIRELAYER);\n      }\n\n    }\n\n    // PNG\u306b\u66f8\u304d\u51fa\u3057\n    fileObj = new File(doc.upDir+file+'_'+(type == \"array\" ? (iI*1)+1 : iI));\n    pngOpt = new PNGSaveOptions();\n    pngOpt.interlaced = false;\n    activeDocument.saveAs(fileObj, pngOpt, true, Extension.LOWERCASE);\n\n    // \u4fdd\u5b58\u305b\u305a\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u9589\u3058\u308b\n    activeDocument.close(SaveOptions.DONOTSAVECHANGES);\n  }\n}\n```\n\n \n", "tags": ["photoshop", "JavaScript"]}