{"context": " More than 1 year has passed since last update.Amazon SNS\u3067Mobile Push\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u305f\u306e\u3067iOS\u5411\u3051\u3060\u3051\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306f\u4e0b\u8a18\u306e\u74b0\u5883\u3067\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\u25a0\u74b0\u5883\nPHP5.5.1\nAWD SDK for PHP2.4.5 \n\u305f\u3076\u3093Mobile Push\u306f2.4.4\u304b\u3089\u3067\u3059\u3002\n\u307e\u305a\u3001SDK\u3092\u4f7f\u3046\u524d\u306b\u3001AWS\u306eManagement Console\u304b\u3089\u3067push\u3067\u304d\u308b\u306e\u3067\u3001\n\u305d\u3061\u3089\u3092\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u25a0\u53c2\u8003URL\nhttp://dev.classmethod.jp/cloud/aws-amazon-sns-mobile-push-ios/\n\u6b21\u306b\u3001AWS\u306e\u30d6\u30ed\u30b0\u3067\u3059\u306d\u3002SDK\u3092\u4f7f\u3063\u305f\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u25a0Amazon Web Services \u30d6\u30ed\u30b0\nhttp://aws.typepad.com/aws_japan/2013/08/push-notifications-to-mobile-devices-using-amazon-sns.html\n\u3067\u3001\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\u6700\u4f4e\u9650\u306e\u30b3\u30fc\u30c9\u306a\u306e\u3067\u3001\u30de\u30cb\u30e5\u30a2\u30eb\u3092\u898b\u305f\u4e0a\u3067\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n<?php\nrequire'/aws_sdk_path/vendor/autoload.php';\nuse Aws\\Common\\Aws;\nuse Aws\\Common\\Enum\\Region;\nuse Aws\\Sns\\SnsClient;\n\nclass Sample {\n\n    // Amazon SDK\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n    private $obj = null;\n\n    // ManagementConsole\u3067\u767b\u9332\u3057\u305f\u30a2\u30d7\u30ea(APNS_SANDBOX:\u958b\u767a\u7528)\n    private $PlatformApplicationArn = 'arn:aws:sns:ap-northeast-1:000000000000:app/APNS_SANDBOX/sample_app'; // dummy\n\n    /**\n     * AWS SDK for PHP\n     */\n    private function getInstance() {\n        if (is_null($this->obj)) {\n            $this->obj = Aws::factory(array(\n                'key'    => 'dummy',\n                'secret' => 'dummy',\n                'region' => Region::TOKYO\n            ))->get('sns');\n        }\n        return $this->obj;\n    }\n\n    /**\n     * Push\u901a\u77e5\u5148(EndpointArn)\u3092\u767b\u9332\n     */\n    public function createPlatformEndpoint($token) {\n        $options = array(\n            'PlatformApplicationArn' => $this->PlatformApplicationArn,\n            'Token'                  => $token,\n        );\n        try {\n            $res = $this->getInstance()->createPlatformEndpoint($options);\n        } catch (Exception $e) {\n//          echo $e->getMessage();\n            return false;\n        }\n        return $res; // $res['EndpointArn']\n    }\n\n    /**\n     * \u901a\u77e5\n     */\n    public function publish($message, $EndpointArn) {\n        try {\n            $res = $this->getInstance()->publish(array(\n                'Message'   => $message,\n                'TargetArn' => $EndpointArn\n            ));\n        } catch (Exception $e) {\n//          echo $e->getMessage();\n            return false;\n        }\n        return $res;\n    }\n\n    /**\n     * \u901a\u77e5(JSON)\n     */\n    public function publishJson($args) {\n        try {\n            $res = $this->getInstance()->publish($args);\n        } catch (Exception $e) {\n//          echo $e->getMessage();\n            return false;\n        }\n        return $res;\n    }\n}\n\n$message = 'Amazon SNS Mobile Push message.';\n\n// \u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u307f\u3092\u901a\u77e5\n$AmazonSns = new Sample();\n$res = $AmazonSns->createPlatformEndpoint('dummy');\n$AmazonSns->publish($message, $res['EndpointArn']);\n\n// JSON\u5f62\u5f0f\u3067\u8272\u3005\u306a\u5024\u3092\u9001\u308b \u203b\u6587\u5b57\u5217\u306e\u4e0a\u9650\u306b\u9054\u3059\u308b\u3068\u9001\u3089\u308c\u306a\u3044\u306e\u3067\u6ce8\u610f\n$AmazonSns->publishJson(array(\n    'MessageStructure' => 'json',\n    'TargetArn' => $res['EndpointArn'],\n    'Message' => json_encode(array(\n        'APNS_SANDBOX' => json_encode(array(\n            'aps' => array(\n                'alert' => $message,\n                'badge' => 10, // int\u578b\u3067\u30a2\u30d7\u30ea\u30a2\u30a4\u30b3\u30f3\u306b\u8868\u793a\u3059\u308bbadge\u6570\u3092\u6307\u5b9a\n                'test_id' => 1 // \u597d\u304d\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u53ef\u80fd\n            )\n        ))\n    )),\n));\n\n\u4f7f\u3044\u65b9\u3068\u3057\u3066\u306f\u3001createPlatformEndpoint()\u3067token\u3092\u767b\u9332\u3057\u3001\n\u305d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3067\u8fd4\u3063\u3066\u304d\u305fEndpointArn\u3092\u5229\u7528\u3057\u3066publish()\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001\u30a2\u30d7\u30ea\u540d\uff08PlatformApplicationArn\uff09\u3082\u901a\u77e5\u5148\uff08EndpointArn\uff09\u3082\nAWS\u5074\u3067\u751f\u6210\u3055\u308c\u308b\u3082\u306e\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\u5b9f\u969b\u306b\u30b5\u30fc\u30d3\u30b9\u3067\u5229\u7528\u3059\u308b\u5834\u5408\u306f\u3001\n1,Management Console\u4e0a\u3067\u30a2\u30d7\u30ea\u3092\u767b\u9332\u3057\u3066PlatformApplicationArn\u3092\u53d6\u5f97\n2,createPlatformEndpoint()\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u306eEndpointArn\u3092DB\u7b49\u306b\u767b\u9332\n3,\u5fc5\u8981\u306a\u30e6\u30fc\u30b6\u306b\u5bfe\u3057\u3066\u3060\u3051publish()\n\u3068\u3044\u3046\u5f62\u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\nAWS\u5074\u3067\u751f\u6210\u3055\u308c\u308b\u5024\u3092\u4f7f\u3046\u306e\u306f\u3061\u3087\u3063\u3068\u9762\u5012\u304b\u306a\u30fb\u30fb\u30fb\nAmazon SNS\u3067Mobile Push\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u305f\u306e\u3067iOS\u5411\u3051\u3060\u3051\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u4eca\u56de\u306f\u4e0b\u8a18\u306e\u74b0\u5883\u3067\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\u25a0\u74b0\u5883\nPHP5.5.1\nAWD SDK for PHP2.4.5 \n\n\u305f\u3076\u3093Mobile Push\u306f2.4.4\u304b\u3089\u3067\u3059\u3002\n\n\n\u307e\u305a\u3001SDK\u3092\u4f7f\u3046\u524d\u306b\u3001AWS\u306eManagement Console\u304b\u3089\u3067push\u3067\u304d\u308b\u306e\u3067\u3001\n\u305d\u3061\u3089\u3092\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\u25a0\u53c2\u8003URL\nhttp://dev.classmethod.jp/cloud/aws-amazon-sns-mobile-push-ios/\n\n\n\u6b21\u306b\u3001AWS\u306e\u30d6\u30ed\u30b0\u3067\u3059\u306d\u3002SDK\u3092\u4f7f\u3063\u305f\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\n\u25a0Amazon Web Services \u30d6\u30ed\u30b0\nhttp://aws.typepad.com/aws_japan/2013/08/push-notifications-to-mobile-devices-using-amazon-sns.html\n\n\n\u3067\u3001\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3059\u3002\n**\u6700\u4f4e\u9650**\u306e\u30b3\u30fc\u30c9\u306a\u306e\u3067\u3001\u30de\u30cb\u30e5\u30a2\u30eb\u3092\u898b\u305f\u4e0a\u3067\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\n```php\n\n<?php\nrequire'/aws_sdk_path/vendor/autoload.php';\nuse Aws\\Common\\Aws;\nuse Aws\\Common\\Enum\\Region;\nuse Aws\\Sns\\SnsClient;\n\nclass Sample {\n\n\t// Amazon SDK\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n\tprivate $obj = null;\n\n\t// ManagementConsole\u3067\u767b\u9332\u3057\u305f\u30a2\u30d7\u30ea(APNS_SANDBOX:\u958b\u767a\u7528)\n\tprivate $PlatformApplicationArn = 'arn:aws:sns:ap-northeast-1:000000000000:app/APNS_SANDBOX/sample_app'; // dummy\n\n\t/**\n\t * AWS SDK for PHP\n\t */\n\tprivate function getInstance() {\n\t\tif (is_null($this->obj)) {\n\t\t\t$this->obj = Aws::factory(array(\n\t\t\t\t'key'    => 'dummy',\n\t\t\t\t'secret' => 'dummy',\n\t\t\t\t'region' => Region::TOKYO\n\t\t\t))->get('sns');\n\t\t}\n\t\treturn $this->obj;\n\t}\n\n\t/**\n\t * Push\u901a\u77e5\u5148(EndpointArn)\u3092\u767b\u9332\n\t */\n\tpublic function createPlatformEndpoint($token) {\n\t\t$options = array(\n\t\t\t'PlatformApplicationArn' => $this->PlatformApplicationArn,\n\t\t\t'Token'                  => $token,\n\t\t);\n\t\ttry {\n\t\t\t$res = $this->getInstance()->createPlatformEndpoint($options);\n\t\t} catch (Exception $e) {\n//\t\t\techo $e->getMessage();\n\t\t\treturn false;\n\t\t}\n\t\treturn $res; // $res['EndpointArn']\n\t}\n\n\t/**\n\t * \u901a\u77e5\n\t */\n\tpublic function publish($message, $EndpointArn) {\n\t\ttry {\n\t\t\t$res = $this->getInstance()->publish(array(\n\t\t\t\t'Message'   => $message,\n\t\t\t\t'TargetArn' => $EndpointArn\n\t\t\t));\n\t\t} catch (Exception $e) {\n//\t\t\techo $e->getMessage();\n\t\t\treturn false;\n\t\t}\n\t\treturn $res;\n\t}\n\n\t/**\n\t * \u901a\u77e5(JSON)\n\t */\n\tpublic function publishJson($args) {\n\t\ttry {\n\t\t\t$res = $this->getInstance()->publish($args);\n\t\t} catch (Exception $e) {\n//\t\t\techo $e->getMessage();\n\t\t\treturn false;\n\t\t}\n\t\treturn $res;\n\t}\n}\n\n$message = 'Amazon SNS Mobile Push message.';\n\n// \u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u307f\u3092\u901a\u77e5\n$AmazonSns = new Sample();\n$res = $AmazonSns->createPlatformEndpoint('dummy');\n$AmazonSns->publish($message, $res['EndpointArn']);\n\n// JSON\u5f62\u5f0f\u3067\u8272\u3005\u306a\u5024\u3092\u9001\u308b \u203b\u6587\u5b57\u5217\u306e\u4e0a\u9650\u306b\u9054\u3059\u308b\u3068\u9001\u3089\u308c\u306a\u3044\u306e\u3067\u6ce8\u610f\n$AmazonSns->publishJson(array(\n    'MessageStructure' => 'json',\n    'TargetArn' => $res['EndpointArn'],\n    'Message' => json_encode(array(\n        'APNS_SANDBOX' => json_encode(array(\n            'aps' => array(\n                'alert' => $message,\n                'badge' => 10, // int\u578b\u3067\u30a2\u30d7\u30ea\u30a2\u30a4\u30b3\u30f3\u306b\u8868\u793a\u3059\u308bbadge\u6570\u3092\u6307\u5b9a\n                'test_id' => 1 // \u597d\u304d\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8a2d\u5b9a\u53ef\u80fd\n            )\n        ))\n    )),\n));\n```\n\n\u4f7f\u3044\u65b9\u3068\u3057\u3066\u306f\u3001createPlatformEndpoint()\u3067token\u3092\u767b\u9332\u3057\u3001\n\u305d\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u3067\u8fd4\u3063\u3066\u304d\u305fEndpointArn\u3092\u5229\u7528\u3057\u3066publish()\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n\u6ce8\u610f\u70b9\u3068\u3057\u3066\u306f\u3001\u30a2\u30d7\u30ea\u540d\uff08PlatformApplicationArn\uff09\u3082\u901a\u77e5\u5148\uff08EndpointArn\uff09\u3082\nAWS\u5074\u3067\u751f\u6210\u3055\u308c\u308b\u3082\u306e\u3060\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n\u5b9f\u969b\u306b\u30b5\u30fc\u30d3\u30b9\u3067\u5229\u7528\u3059\u308b\u5834\u5408\u306f\u3001\n1,Management Console\u4e0a\u3067\u30a2\u30d7\u30ea\u3092\u767b\u9332\u3057\u3066PlatformApplicationArn\u3092\u53d6\u5f97\n2,createPlatformEndpoint()\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u306eEndpointArn\u3092DB\u7b49\u306b\u767b\u9332\n3,\u5fc5\u8981\u306a\u30e6\u30fc\u30b6\u306b\u5bfe\u3057\u3066\u3060\u3051publish()\n\u3068\u3044\u3046\u5f62\u304b\u306a\u3068\u601d\u3044\u307e\u3059\u3002\n\nAWS\u5074\u3067\u751f\u6210\u3055\u308c\u308b\u5024\u3092\u4f7f\u3046\u306e\u306f\u3061\u3087\u3063\u3068\u9762\u5012\u304b\u306a\u30fb\u30fb\u30fb", "tags": ["AWS", "AWS_SDK", "PHP"]}