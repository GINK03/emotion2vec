{"context": " More than 1 year has passed since last update.Embulk\u3067MySQL\u306b\u5927\u91cf\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3057\u3066\u307f\u308b - \u305d\u306e\uff11 \u306e\u7d9a\u304d\n\n\u30a8\u30e9\u30fc\u8abf\u67fb\n\u30a8\u30e9\u30fc\u3092\u307f\u308b\u611f\u3058\u3001\u4e00\u6642\u30c6\u30fc\u30d6\u30eb(bulk_tbl_*_bl_tmp*)\u3078\u306e\u30c7\u30fc\u30bf\u6295\u5165\u5b8c\u4e86\u5f8c\u3001\u5b9f\u30c6\u30fc\u30d6\u30eb(bulk_tbl)\u3078\u30de\u30fc\u30b8\u3059\u308b\u9014\u4e2d\u3001\u306a\u3093\u3089\u304b\u306e\u7406\u7531\u3067\u843d\u3061\u305f\u3063\u307d\u3044\u3002\n\u305d\u3057\u3066\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u3092DROP\u3057\u3088\u3046\u3068\u3057\u3066\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u306a\u304f\u306a\u3063\u3066\u308b\u306e\u3067\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3044\u308b\u3063\u307d\u3044\u3002\n2015-08-05 08:35:37.456 +0900 [INFO] (transaction): Connecting to jdbc:mysql://localhost:3306/bulk_db options {user=bulk_user, tcpKeepAlive=true, useCompression=true, rewriteBatchedStatements=true, connectTimeout=300000, socketTimeout=2700000}\n2015-08-05 08:35:37.672 +0900 [INFO] (transaction): SQL: INSERT INTO `bulk_tbl` (`col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20`) SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp000` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp001` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp002` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp003` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp004` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp005` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp006` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp007` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp008` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp009` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp010` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp011` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp012` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp013` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp014` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp015` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp016` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp017` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp018` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp019` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp020` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp021` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp022` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp023` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp024` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp025` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp026` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp027` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp028` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp029`\n2015-08-05 09:23:03.963 +0900 [ERROR] (transaction): Operation failed (0:08S01)\n2015-08-05 09:23:43.490 +0900 [INFO] (main): Transaction partially failed. Cleaning up the intermediate data. Use -r option to make it resumable.\n2015-08-05 09:25:03.234 +0900 [INFO] (cleanup): Connecting to jdbc:mysql://localhost:3306/bulk_db options {user=bulk_user, tcpKeepAlive=true, useCompression=true, rewriteBatchedStatements=true, connectTimeout=300000, socketTimeout=1800000}\n2015-08-05 09:25:16.514 +0900 [INFO] (cleanup): SQL: DROP TABLE IF EXISTS `bulk_tbl_0000000055c138a4090f5600_bl_tmp000`\n2015-08-05 09:55:37.335 +0900 [ERROR] (cleanup): Operation failed (0:08S01)\norg.embulk.exec.PartialExecutionException: java.lang.RuntimeException: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\n\u5b9f\u969b\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306fDROP\u3055\u308c\u305a\u6b8b\u3063\u305f\u307e\u307e\u306b\u306a\u3063\u3066\u308b\u3002\nmysql> show tables;\n+---------------------------------------------+\n| Tables_in_bulk_db                           |\n+---------------------------------------------+\n| bulk_tbl                                    |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp001 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp002 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp003 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp004 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp005 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp006 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp007 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp008 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp009 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp010 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp011 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp012 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp013 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp014 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp015 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp016 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp017 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp018 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp019 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp020 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp021 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp022 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp023 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp024 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp025 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp026 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp027 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp028 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp029 |\n+---------------------------------------------+\n30 rows in set (0.00 sec)\n\n\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u7591\u3063\u305f\u304c\u3001wait_connection\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u307e\u307e8\u6642\u9593\uff0828800 msec)\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u308c\u304c\u539f\u56e0\u3067\u306f\u306a\u3055\u305d\u3046\u3002\nmysql> show global variables like '%timeout';\n+----------------------------+----------+\n| Variable_name              | Value    |\n+----------------------------+----------+\n| connect_timeout            | 10       |\n| delayed_insert_timeout     | 300      |\n| innodb_lock_wait_timeout   | 50       |\n| innodb_rollback_on_timeout | OFF      |\n| interactive_timeout        | 28800    |\n| lock_wait_timeout          | 31536000 |\n| net_read_timeout           | 30       |\n| net_write_timeout          | 60       |\n| slave_net_timeout          | 3600     |\n| wait_timeout               | 28800    |\n+----------------------------+----------+\n10 rows in set (0.00 sec)\n\n\u3082\u3046\u4e00\u5ea6\u30ed\u30b0\u3092\u898b\u3066\u307f\u308b\u3068\u3001jdbc\u306e\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u8a2d\u5b9a\u304c300000\u30df\u30ea\u79d2\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u3053\u306e\u72b6\u614b\u3060\u3068\u30015\u5206\u3067\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u5207\u308c\u308b\u306e\u304b\u3082\u3002\n2015-08-05 08:35:37.456 +0900 [INFO] (transaction): Connecting to jdbc:mysql://localhost:3306/bulk_db options {user=bulk_user, tcpKeepAlive=true, useCompression=true, rewriteBatchedStatements=true, connectTimeout=300000, socketTimeout=2700000}\n\nEmbulk\u306e\u30bd\u30fc\u30b9\u3092\u78ba\u8a8d\u3057\u305f\u3068\u3053\u308d\u3001\u78ba\u304b\u306b300000\u30df\u30ea\u79d2\u3092\u660e\u793a\u7684\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002\n\norg.embulk.output.MySQLOutputPlugin.java\nprops.setProperty(\"connectTimeout\", \"300000\"); // milliseconds\n\n\n\u305d\u3046\u3044\u3048\u3070Embulk\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3067 option \u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u305f\u306e\u3067\u3001\u5024\u30927200000\u30df\u30ea\u79d2(120\u5206)\u306b\u8a2d\u5b9a\u3057\u3066\u307f\u308b\u3002\nout:\n   options: {connectTimeout: 7200000}\n\n\u518d\u5ea6\u5b9f\u884c\n$ embulk run ./sample/config.yml\n\n\u3067\u3082\u30a8\u30e9\u30fc\u306f\u5909\u308f\u3089\u305a\u3002\u3002\u3002\n\u3082\u3046\u4e00\u5ea6\u3055\u3063\u304d\u306e\u30ed\u30b0\u3092\u898b\u3066\u307f\u308b\u3068\u3001jdbc\u306e\u30bd\u30b1\u30c3\u30c8\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u8a2d\u5b9a\u304c2700000\u30df\u30ea\u79d2\uff0845\u5206\uff09\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n2015-08-05 08:35:37.456 +0900 [INFO] (transaction): Connecting to jdbc:mysql://localhost:3306/bulk_db options {user=bulk_user, tcpKeepAlive=true, useCompression=true, rewriteBatchedStatements=true, connectTimeout=300000, socketTimeout=2700000}\n\n\u305d\u3046\u3044\u3048\u30702700000\u30df\u30ea\u79d2\u3050\u3089\u3044\u3067\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u5207\u308c\u3066\u305f\u6c17\u304c\u3059\u308b\u3002\nThe last packet successfully received from the server was 2,839,153 milliseconds ago.  The last packet sent successfully to the server was 2,839,151 milliseconds ago.\n    at org.embulk.exec.BulkLoader$LoaderState.buildPartialExecuteException(org/embulk/exec/BulkLoader.java:331)\n\nEmbulk\u306e\u30bd\u30fc\u30b9\u3092\u78ba\u8a8d\u3057\u305f\u3068\u3053\u308d\u3001\u78ba\u304b\u306b2700000\u30df\u30ea\u79d2\u3092\u660e\u793a\u7684\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002\n\norg.embulk.output.MySQLOutputPlugin.java\nprops.setProperty(\"socketTimeout\", \"2700000\");   // milliseconds;\n\n\n\u3053\u3061\u3089\u3082Embulk\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3067option\u3068\u3057\u30667200000\u30df\u30ea\u79d2(120\u5206)\u306b\u8a2d\u5b9a\u3057\u3066\u307f\u308b\u3002\nout:\n   options: {socketTimeout: 7200000}\n\n\u518d\u5ea6\u5b9f\u884c\n$ embulk run ./sample/config.yml\n\n\u3046\u307e\u304f\u3044\u3063\u305f\u3063\u307d\u3044\uff01\uff01\nmysql> select count(col01) from bulk_tbl;\n+--------------+\n| count(col01) |\n+--------------+\n|     30000000 |\n+--------------+\n1 row in set (5 min 30.40 sec)\n\n[Embulk\u3067MySQL\u306b\u5927\u91cf\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3057\u3066\u307f\u308b - \u305d\u306e\uff11](http://qiita.com/shinyashikis@github/items/80162a252f92b3aca3a8) \u306e\u7d9a\u304d\n\n# \u30a8\u30e9\u30fc\u8abf\u67fb\n\n\u30a8\u30e9\u30fc\u3092\u307f\u308b\u611f\u3058\u3001\u4e00\u6642\u30c6\u30fc\u30d6\u30eb(bulk_tbl_\\*_bl_tmp*)\u3078\u306e\u30c7\u30fc\u30bf\u6295\u5165\u5b8c\u4e86\u5f8c\u3001\u5b9f\u30c6\u30fc\u30d6\u30eb(bulk_tbl)\u3078\u30de\u30fc\u30b8\u3059\u308b\u9014\u4e2d\u3001\u306a\u3093\u3089\u304b\u306e\u7406\u7531\u3067\u843d\u3061\u305f\u3063\u307d\u3044\u3002\n\u305d\u3057\u3066\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u3092DROP\u3057\u3088\u3046\u3068\u3057\u3066\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u306a\u304f\u306a\u3063\u3066\u308b\u306e\u3067\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3044\u308b\u3063\u307d\u3044\u3002\n\n```\n2015-08-05 08:35:37.456 +0900 [INFO] (transaction): Connecting to jdbc:mysql://localhost:3306/bulk_db options {user=bulk_user, tcpKeepAlive=true, useCompression=true, rewriteBatchedStatements=true, connectTimeout=300000, socketTimeout=2700000}\n2015-08-05 08:35:37.672 +0900 [INFO] (transaction): SQL: INSERT INTO `bulk_tbl` (`col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20`) SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp000` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp001` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp002` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp003` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp004` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp005` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp006` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp007` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp008` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp009` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp010` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp011` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp012` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp013` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp014` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp015` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp016` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp017` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp018` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp019` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp020` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp021` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp022` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp023` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp024` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp025` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp026` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp027` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp028` UNION ALL SELECT `col01`, `col02`, `col03`, `col04`, `col05`, `col06`, `col07`, `col08`, `col09`, `col10`, `col11`, `col12`, `col13`, `col14`, `col15`, `col16`, `col17`, `col18`, `col19`, `col20` FROM `bulk_tbl_0000000055c138a4090f5600_bl_tmp029`\n2015-08-05 09:23:03.963 +0900 [ERROR] (transaction): Operation failed (0:08S01)\n2015-08-05 09:23:43.490 +0900 [INFO] (main): Transaction partially failed. Cleaning up the intermediate data. Use -r option to make it resumable.\n2015-08-05 09:25:03.234 +0900 [INFO] (cleanup): Connecting to jdbc:mysql://localhost:3306/bulk_db options {user=bulk_user, tcpKeepAlive=true, useCompression=true, rewriteBatchedStatements=true, connectTimeout=300000, socketTimeout=1800000}\n2015-08-05 09:25:16.514 +0900 [INFO] (cleanup): SQL: DROP TABLE IF EXISTS `bulk_tbl_0000000055c138a4090f5600_bl_tmp000`\n2015-08-05 09:55:37.335 +0900 [ERROR] (cleanup): Operation failed (0:08S01)\norg.embulk.exec.PartialExecutionException: java.lang.RuntimeException: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n```\n\u5b9f\u969b\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306fDROP\u3055\u308c\u305a\u6b8b\u3063\u305f\u307e\u307e\u306b\u306a\u3063\u3066\u308b\u3002\n\n```\nmysql> show tables;\n+---------------------------------------------+\n| Tables_in_bulk_db                           |\n+---------------------------------------------+\n| bulk_tbl                                    |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp001 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp002 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp003 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp004 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp005 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp006 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp007 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp008 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp009 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp010 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp011 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp012 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp013 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp014 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp015 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp016 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp017 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp018 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp019 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp020 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp021 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp022 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp023 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp024 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp025 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp026 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp027 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp028 |\n| bulk_tbl_0000000055c138a4090f5600_bl_tmp029 |\n+---------------------------------------------+\n30 rows in set (0.00 sec)\n```\n\n\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u7591\u3063\u305f\u304c\u3001wait_connection\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u307e\u307e8\u6642\u9593\uff0828800 msec)\u3068\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u308c\u304c\u539f\u56e0\u3067\u306f\u306a\u3055\u305d\u3046\u3002\n\n```\nmysql> show global variables like '%timeout';\n+----------------------------+----------+\n| Variable_name              | Value    |\n+----------------------------+----------+\n| connect_timeout            | 10       |\n| delayed_insert_timeout     | 300      |\n| innodb_lock_wait_timeout   | 50       |\n| innodb_rollback_on_timeout | OFF      |\n| interactive_timeout        | 28800    |\n| lock_wait_timeout          | 31536000 |\n| net_read_timeout           | 30       |\n| net_write_timeout          | 60       |\n| slave_net_timeout          | 3600     |\n| wait_timeout               | 28800    |\n+----------------------------+----------+\n10 rows in set (0.00 sec)\n```\n\n\u3082\u3046\u4e00\u5ea6\u30ed\u30b0\u3092\u898b\u3066\u307f\u308b\u3068\u3001jdbc\u306e\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u8a2d\u5b9a\u304c300000\u30df\u30ea\u79d2\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\u3053\u306e\u72b6\u614b\u3060\u3068\u30015\u5206\u3067\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u5207\u308c\u308b\u306e\u304b\u3082\u3002\n\n```\n2015-08-05 08:35:37.456 +0900 [INFO] (transaction): Connecting to jdbc:mysql://localhost:3306/bulk_db options {user=bulk_user, tcpKeepAlive=true, useCompression=true, rewriteBatchedStatements=true, connectTimeout=300000, socketTimeout=2700000}\n```\n\nEmbulk\u306e[\u30bd\u30fc\u30b9](https://github.com/embulk/embulk-output-jdbc/blob/master/embulk-output-mysql/src/main/java/org/embulk/output/MySQLOutputPlugin.java#L91)\u3092\u78ba\u8a8d\u3057\u305f\u3068\u3053\u308d\u3001\u78ba\u304b\u306b300000\u30df\u30ea\u79d2\u3092\u660e\u793a\u7684\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002\n\n```lang:org.embulk.output.MySQLOutputPlugin.java\nprops.setProperty(\"connectTimeout\", \"300000\"); // milliseconds\n```\n\n\u305d\u3046\u3044\u3048\u3070Embulk\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3067 [option](https://github.com/embulk/embulk-output-jdbc/tree/master/embulk-output-mysql#configuration) \u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u305f\u306e\u3067\u3001\u5024\u30927200000\u30df\u30ea\u79d2(120\u5206)\u306b\u8a2d\u5b9a\u3057\u3066\u307f\u308b\u3002\n\n```\nout:\n   options: {connectTimeout: 7200000}\n```\n\n\u518d\u5ea6\u5b9f\u884c\n\n```\n$ embulk run ./sample/config.yml\n```\n\n\u3067\u3082\u30a8\u30e9\u30fc\u306f\u5909\u308f\u3089\u305a\u3002\u3002\u3002\n\n\u3082\u3046\u4e00\u5ea6\u3055\u3063\u304d\u306e\u30ed\u30b0\u3092\u898b\u3066\u307f\u308b\u3068\u3001jdbc\u306e\u30bd\u30b1\u30c3\u30c8\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u8a2d\u5b9a\u304c2700000\u30df\u30ea\u79d2\uff0845\u5206\uff09\u306b\u306a\u3063\u3066\u3044\u308b\u3002\n\n```\n2015-08-05 08:35:37.456 +0900 [INFO] (transaction): Connecting to jdbc:mysql://localhost:3306/bulk_db options {user=bulk_user, tcpKeepAlive=true, useCompression=true, rewriteBatchedStatements=true, connectTimeout=300000, socketTimeout=2700000}\n```\n\n\u305d\u3046\u3044\u3048\u30702700000\u30df\u30ea\u79d2\u3050\u3089\u3044\u3067\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u5207\u308c\u3066\u305f\u6c17\u304c\u3059\u308b\u3002\n\n```\nThe last packet successfully received from the server was 2,839,153 milliseconds ago.  The last packet sent successfully to the server was 2,839,151 milliseconds ago.\n    at org.embulk.exec.BulkLoader$LoaderState.buildPartialExecuteException(org/embulk/exec/BulkLoader.java:331)\n```\n\nEmbulk\u306e[\u30bd\u30fc\u30b9](https://github.com/embulk/embulk-output-jdbc/blob/master/embulk-output-mysql/src/main/java/org/embulk/output/MySQLOutputPlugin.java#L92)\u3092\u78ba\u8a8d\u3057\u305f\u3068\u3053\u308d\u3001\u78ba\u304b\u306b2700000\u30df\u30ea\u79d2\u3092\u660e\u793a\u7684\u306b\u6307\u5b9a\u3057\u3066\u3044\u308b\u3002\n\n```lang:org.embulk.output.MySQLOutputPlugin.java\nprops.setProperty(\"socketTimeout\", \"2700000\");   // milliseconds;\n```\n\n\u3053\u3061\u3089\u3082Embulk\u5b9a\u7fa9\u30d5\u30a1\u30a4\u30eb\u3067option\u3068\u3057\u30667200000\u30df\u30ea\u79d2(120\u5206)\u306b\u8a2d\u5b9a\u3057\u3066\u307f\u308b\u3002\n\n```\nout:\n   options: {socketTimeout: 7200000}\n```\n\n\u518d\u5ea6\u5b9f\u884c\n\n```\n$ embulk run ./sample/config.yml\n```\n\n\u3046\u307e\u304f\u3044\u3063\u305f\u3063\u307d\u3044\uff01\uff01\n\n```\nmysql> select count(col01) from bulk_tbl;\n+--------------+\n| count(col01) |\n+--------------+\n|     30000000 |\n+--------------+\n1 row in set (5 min 30.40 sec)\n```\n", "tags": ["Embulk", "MySQL"]}