{"context": " More than 1 year has passed since last update.\n\n\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u3084powershell\u306e\u5099\u5fd8\u9332\nPowerShell\u3082\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u304b\u3089\npowershell -command \"{command}\"\n\n\u306e\u5f62\u5f0f\u3067\u8d77\u52d5\u3059\u308b\u5f62\u3067\u8a18\u8f09\u3059\u308b\n\nWindows\u3067tail\u3059\u308b\n\nsample0.cmd\npowershell -command \"gc test.log -Wait\"\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u74b0\u5883\u5909\u6570\u3092\u8aad\u307f\u8fbc\u3080\n\nsetting.INI\nNAME1=hogehoge\nNAME2=fugafuga\n\n\n\nsample1.cmd\nfor /F \"eol=; tokens=1 delims=\" %%i in (setting.INI) do @set %%i\necho NAME1=%NAME1%\necho NAME2=%NAME2%\n\n\n\n\u81ea\u8eab\u306eprocessid\u53d6\u5f97\n\nsample2.cmd\npowershell -command \"get-wmiobject win32_process -filter processid=$pid | foreach-object {$_.parentprocessid;}\"\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u66f4\u65b0\u6642\u9593\u304c24\u6642\u9593\u4ee5\u5185\u304b\u5224\u5b9a\n\nsample3.cmd\nset cmd=\"$ft=$(Get-ItemProperty hoge.txt).LastWriteTime;\"\nset cmd=%cmd%\"$checkpoint=$(Get-Date).AddMinutes(-1440); \"\nset cmd=%cmd%if ($ft -gt $checkpoint){exit 0}else{exit 1}\npowershell  -Command %cmd%\nIF %ERRORLEVEL% EQU 0 (\n  ::hoge.txt\u306e\u66f4\u65b0\u6642\u9593\u306f24\u6642\u9593\u4ee5\u5185\n)\n\n\n\nDEL\u30b3\u30de\u30f3\u30c9\u306e\u30a8\u30e9\u30fc\u5224\u5b9a\n\nsample4.cmd\nDEL hoge.txt 2>&1 | FIND /V \"\"\nIF %ERRORLEVEL% EQU 0 (\n  ::\u30d5\u30a1\u30a4\u30eb\u524a\u9664\u5931\u6557\n)\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u306e\u6587\u5b57\u5217\u304c\u5b58\u5728\u3059\u308b\u884c\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u3066\u4ef6\u6570\u3092\u5909\u6570\u306b\u683c\u7d0d\n\nsample5.cmd\nFOR /f \"DELIMS=\" %%A IN ('FINDSTR /R /C:\"FIND: STR!!\" hoge.txt ^| find /c /v \"\" ') DO SET COUNT=%%A\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3057\u3066\u5225\u540d\u4fdd\u5b58\uff08\u6587\u5b57\u30b3\u30fc\u30c9\u6307\u5b9a\u53ef\uff09\n\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u3067\u7f6e\u63db\u3059\u308b\u3068\u6587\u5b57\u5316\u3051\u308b\u5834\u5408\u306a\u3069\u306b\u4fbf\u5229\nEncoding\u3067\u6307\u5b9a\u3067\u304d\u308b\u30b3\u30fc\u30c9 \n\nsample6.cmd\nset cmd=\"gci hoge.INI | %{(Get-Content -Encoding UTF8 $_)|%{$_ -replace'FIND: STR!','REPLACE: STR!!'}|Set-Content -Encoding UTF8 $_'_EDIT'}\"\npowershell  -Command %cmd%\n\n\n%%\u306fForEach-Object\u306e\u30a8\u30a4\u30ea\u30a2\u30b9\n\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u3067\u76f4\u63a5\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f%\u306b\u3059\u308b\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u5bfe\u3057\u3066\u500b\u5225\u306b\u51e6\u7406\u3092\u884c\u306a\u3046(\u30e9\u30d9\u30eb\u7248)\nfor\u306b\u307e\u3068\u3081\u3066\u66f8\u304f\u3068\u9577\u304f\u306a\u308b\u5834\u5408\u306b\u4f7f\u3063\u305f\u308a\u3059\u308b\n\nsample7.cmd\nfor /f \"delims=;\" %%i in ('dir /b /od c:\\target_dir\\*') do CALL :SAMPLE_CMD %%i\n\n::\u30d0\u30c3\u30c1\u306e\u6700\u5f8c\u306b\u30e9\u30d9\u30eb\u3092\u914d\u7f6e\n::\u30d5\u30a1\u30a4\u30eb\u3054\u3068\u306b\u3053\u306e\u30e9\u30d9\u30eb\u304c\u547c\u3070\u308c\u308b\n:SAMPLE_CMD\nset FILENAME=%1\n::\u30d5\u30a1\u30a4\u30eb\u3054\u3068\u306e\u51e6\u7406\u3092\u66f8\u304f\n\n\n\n\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u5909\u66f4\n\nsample8.cmd\npowershell  -Command \"Set-ItemProperty hoge.txt -Name LastWriteTime -Value \\\"01/31/2010 13:50\\\"\"\n\n\n#\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u3084powershell\u306e\u5099\u5fd8\u9332\n\nPowerShell\u3082\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u304b\u3089\n\n```\npowershell -command \"{command}\"\n```\n\u306e\u5f62\u5f0f\u3067\u8d77\u52d5\u3059\u308b\u5f62\u3067\u8a18\u8f09\u3059\u308b\n\n##Windows\u3067tail\u3059\u308b\n```sample0.cmd\npowershell -command \"gc test.log -Wait\"\n```\n##\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u304b\u3089\u74b0\u5883\u5909\u6570\u3092\u8aad\u307f\u8fbc\u3080\n\n```setting.INI\nNAME1=hogehoge\nNAME2=fugafuga\n```\n\n```sample1.cmd\nfor /F \"eol=; tokens=1 delims=\" %%i in (setting.INI) do @set %%i\necho NAME1=%NAME1%\necho NAME2=%NAME2%\n```\n\n\n\n##\u81ea\u8eab\u306eprocessid\u53d6\u5f97\n```sample2.cmd\npowershell -command \"get-wmiobject win32_process -filter processid=$pid | foreach-object {$_.parentprocessid;}\"\n```\n\n\n##\u30d5\u30a1\u30a4\u30eb\u306e\u66f4\u65b0\u6642\u9593\u304c24\u6642\u9593\u4ee5\u5185\u304b\u5224\u5b9a\n```sample3.cmd\nset cmd=\"$ft=$(Get-ItemProperty hoge.txt).LastWriteTime;\"\nset cmd=%cmd%\"$checkpoint=$(Get-Date).AddMinutes(-1440); \"\nset cmd=%cmd%if ($ft -gt $checkpoint){exit 0}else{exit 1}\npowershell  -Command %cmd%\nIF %ERRORLEVEL% EQU 0 (\n  ::hoge.txt\u306e\u66f4\u65b0\u6642\u9593\u306f24\u6642\u9593\u4ee5\u5185\n)\n```\n\n\n##DEL\u30b3\u30de\u30f3\u30c9\u306e\u30a8\u30e9\u30fc\u5224\u5b9a\n```sample4.cmd\nDEL hoge.txt 2>&1 | FIND /V \"\"\nIF %ERRORLEVEL% EQU 0 (\n  ::\u30d5\u30a1\u30a4\u30eb\u524a\u9664\u5931\u6557\n)\n```\n\n\n##\u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u306e\u6587\u5b57\u5217\u304c\u5b58\u5728\u3059\u308b\u884c\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u3066\u4ef6\u6570\u3092\u5909\u6570\u306b\u683c\u7d0d\n```sample5.cmd\nFOR /f \"DELIMS=\" %%A IN ('FINDSTR /R /C:\"FIND: STR!!\" hoge.txt ^| find /c /v \"\" ') DO SET COUNT=%%A\n```\n\n\n##\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u6587\u5b57\u5217\u3092\u7f6e\u63db\u3057\u3066\u5225\u540d\u4fdd\u5b58\uff08\u6587\u5b57\u30b3\u30fc\u30c9\u6307\u5b9a\u53ef\uff09\n\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u3067\u7f6e\u63db\u3059\u308b\u3068\u6587\u5b57\u5316\u3051\u308b\u5834\u5408\u306a\u3069\u306b\u4fbf\u5229\n[Encoding\u3067\u6307\u5b9a\u3067\u304d\u308b\u30b3\u30fc\u30c9 ](https://technet.microsoft.com/ja-jp/library/hh847788.aspx)\n\n```sample6.cmd\nset cmd=\"gci hoge.INI | %{(Get-Content -Encoding UTF8 $_)|%{$_ -replace'FIND: STR!','REPLACE: STR!!'}|Set-Content -Encoding UTF8 $_'_EDIT'}\"\npowershell  -Command %cmd%\n```\n%%\u306fForEach-Object\u306e\u30a8\u30a4\u30ea\u30a2\u30b9\n\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8\u3067\u76f4\u63a5\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f%\u306b\u3059\u308b\n\n##\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u5bfe\u3057\u3066\u500b\u5225\u306b\u51e6\u7406\u3092\u884c\u306a\u3046(\u30e9\u30d9\u30eb\u7248)\nfor\u306b\u307e\u3068\u3081\u3066\u66f8\u304f\u3068\u9577\u304f\u306a\u308b\u5834\u5408\u306b\u4f7f\u3063\u305f\u308a\u3059\u308b\n\n```sample7.cmd\nfor /f \"delims=;\" %%i in ('dir /b /od c:\\target_dir\\*') do CALL :SAMPLE_CMD %%i\n\n::\u30d0\u30c3\u30c1\u306e\u6700\u5f8c\u306b\u30e9\u30d9\u30eb\u3092\u914d\u7f6e\n::\u30d5\u30a1\u30a4\u30eb\u3054\u3068\u306b\u3053\u306e\u30e9\u30d9\u30eb\u304c\u547c\u3070\u308c\u308b\n:SAMPLE_CMD\nset FILENAME=%1\n::\u30d5\u30a1\u30a4\u30eb\u3054\u3068\u306e\u51e6\u7406\u3092\u66f8\u304f\n```\n\n##\u30d5\u30a1\u30a4\u30eb\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u5909\u66f4\n```sample8.cmd\npowershell  -Command \"Set-ItemProperty hoge.txt -Name LastWriteTime -Value \\\"01/31/2010 13:50\\\"\"\n```\n", "tags": ["\u30b3\u30de\u30f3\u30c9\u30d7\u30ed\u30f3\u30d7\u30c8", "PowerShell", "bat"]}