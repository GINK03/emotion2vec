{"tags": ["vuls", "docker", "AWS", "EC2", "\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"], "context": "\n\nVuls\u306e\u30ed\u30b4\n\n\n\u306f\u3058\u3081\u306b\n\u3000\u6628\u65e5\u77e5\u308a\u307e\u3057\u305f\u3001Vuls( VULnerability Scanner )\u3068\u3044\u3046\u7d20\u6674\u3089\u3057\u3044\u8106\u5f31\u6027\u8a3a\u65ad\u30c4\u30fc\u30eb\u304c\u3042\u308a\u307e\u3059\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fGitHub\u306e\u3010future-architect/vuls\u3011\u306b\u4e0a\u304c\u3063\u3066\u3044\u307e\u3059\u3002\u65e5\u672c\u306b\u3044\u308b\u65b9\u3005\u304c\u958b\u767a\u3057\u305f\u3082\u306e\u3067\u3059\u306e\u3067\u3001\u3053\u306e\u30b5\u30fc\u30d3\u30b9\u306b\u975e\u5e38\u306b\u671f\u5f85\u3057\u3066\u3044\u307e\u3059\u3002\n\u3000Vuls\u304c\u3067\u304d\u308b\u3053\u3068\u306b\u3064\u3044\u3066\u306f\u3001\u4e0b\u8a18vuls/README.ja.md\u306b\u8a18\u8f09\u3055\u308c\u308b\u3053\u3068\u3092\u5f15\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3059\u3002\n\nVuls\u306f\u4e0a\u306b\u6319\u3052\u305f\u624b\u52d5\u904b\u7528\u3067\u306e\u8ab2\u984c\u3092\u89e3\u6c7a\u3059\u308b\u30c4\u30fc\u30eb\u3067\u3042\u308a\u3001\u4ee5\u4e0b\u306e\u7279\u5fb4\u304c\u3042\u308b\u3002\n\u25cf\u3000\u30b7\u30b9\u30c6\u30e0\u306b\u95a2\u4fc2\u3042\u308b\u8106\u5f31\u6027\u306e\u307f\u6559\u3048\u3066\u304f\u308c\u308b\n\u25cf\u3000\u305d\u306e\u8106\u5f31\u6027\u306b\u8a72\u5f53\u3059\u308b\u30b5\u30fc\u30d0\u3092\u6559\u3048\u3066\u304f\u308c\u308b\n\u25cf\u3000\u81ea\u52d5\u30b9\u30ad\u30e3\u30f3\u306e\u305f\u3081\u8106\u5f31\u6027\u691c\u77e5\u306e\u6f0f\u308c\u3092\u9632\u3050\u3053\u3068\u304c\u3067\u304d\u308b\n\u25cf\u3000CRON\u306a\u3069\u3067\u5b9a\u671f\u5b9f\u884c\u3001\u30ec\u30dd\u30fc\u30c8\u3059\u308b\u3053\u3068\u3067\u8106\u5f31\u6027\u306e\u653e\u7f6e\u3092\u9632\u3050\u3053\u3068\u3067\u304d\u308b\u3000\u3000\n\n\u3000Docker\u3092\u4f7f\u3048\u3070\u3001\u7c21\u5358\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u3067\u304d\u3066\u3001\u3061\u3087\u3063\u3068\u3057\u305f\u8a2d\u5b9a\u3067\u3059\u3050Vuls\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\u3000\u6065\u305a\u304b\u3057\u3044\u306a\u304c\u3089\u3001\u81ea\u5206\u306fDocker\u3059\u3089\u3088\u304f\u89e6\u3063\u305f\u3053\u3068\u304c\u306a\u304f\u3001\u4eca\u56de\u306f\u3001Docker\u306e\u5b66\u7fd2\u3082\u517c\u306d\u3066\u3001\u81ea\u5206\u304c\u3084\u3063\u305f\u3053\u3068\u3092\u5171\u6709\u3057\u307e\u3059\u3002\n\u3000\u8a71\u304c\u305d\u308c\u307e\u3059\u304c\u3001\u6628\u5e74\u5ea6\u3001\u8106\u5f31\u6027\u5bfe\u5fdc\u306e\u696d\u52d9\u306b\u3059\u3053\u3057\u643a\u308f\u3063\u305f\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u6642\u306f\u3001\u8106\u5f31\u6027\u306e\u901a\u77e5\u304c\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u90e8\u9580\u304b\u3089\u6765\u308b\u305f\u3073\u306b\u3001\u5404\u30b7\u30b9\u30c6\u30e0\u306e\u30b5\u30fc\u30d0\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3001\u8106\u5f31\u6027\u3042\u308a\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u3092\u8abf\u67fb\u3057\u3066\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3057\u305f\u306e\u3067\u3001\u6b63\u76f4\u306b\u8a00\u3063\u3066\u3001\u5acc\u306a\u4f5c\u696d\u3067\u3057\u305f\u3002\u3067\u3059\u306e\u3067\u3001Vuls\u306e\u3053\u3068\u3092\u77e5\u3063\u3066\u304b\u3089\u3001\u305a\u3063\u3068\u982d\u304b\u3089\u96e2\u308c\u3089\u308c\u305a\u3001\u89e6\u308a\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u305f\u306e\u3067\u3001\u65e9\u901f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u89e6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\nVuls\u3092\u89e6\u3063\u3066\u307f\u3088\u3046\n\n\u52d5\u4f5c\u74b0\u5883\n\nVuls\u306e\u30db\u30b9\u30c8\n\n\n\n\nOS\nAmazon Linux\n\n\n\n\nAMI\namzn-ami-hvm-2016.03.3.x86_64-gp2\n\n\nDocker\nVersion 1.11.2\n\n\n\n\n\u30b9\u30ad\u30e3\u30f3\u5bfe\u8c61\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n\n\n\n\nOS\nAmazon Linux\n\n\n\n\nAMI\namzn-ami-hvm-2016.03.1.x86_64-gp2\n\n\n\n\n\u624b\u9806\n\n\nVuls\u7528\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\n\n\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u5468\u308a\u306f\u5272\u611b\n\n\nVuls\u7528\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3055\u308c\u308b\u3068\u3001SSH\u30ed\u30b0\u30a4\u30f3\n\n\u3053\u308c\u304b\u3089\u306fEC2\u5185\u306e\u4f5c\u696d\n\n\u3068\u308a\u3042\u3048\u305a\u3001yum update\n\n$ sudo yum update -y\n\n\ndocker\u3001docker-compose\u3001git\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n$ sudo yum -y install docker\n$ sudo pip install -U docker-compose\n$ sudo yum -y install git\n\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n$ docker --version\nDocker version 1.11.2, build b9f10c9/1.11.2\n\n$ docker-compose -v\ndocker-compose version 1.7.1, build 6c29830\n\n$ git --version\ngit version 2.7.4\n\n\nDocker\u3092\u8d77\u52d5\n\n$ sudo service docker start\n\n\nVuls\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\n\n$ git clone https://github.com/future-architect/vuls.git\n\n\n\u30a4\u30e1\u30fc\u30b8\u306e\u30d3\u30eb\u30c9\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u3066\u3001\u8d77\u52d5\n\n\n\u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b \n\n\n\n$ cd vuls/setup/docker\n\n$ sudo /usr/local/bin/docker-compose -p docker -f docker-compose.yml up -d\n\n$ sudo docker ps\n\n\n\nVuls\u306e\u8a2d\u5b9a\n\n\nTarget instance\u306bSSH\u30ed\u30b0\u30a4\u30f3\u7528\u306ekey\u3092vuls/docker/conf/\u306b\u683c\u7d0d\nTarget instance\u306bSSH\u30ed\u30b0\u30a4\u30f3\u7528\u306econfig\u30d5\u30a1\u30a4\u30eb(config.toml)\u3092vuls/docker/conf/\u306b\u4f5c\u6210\n\n\n\n[servers]\n\n[servers.172-31-21-119]\nhost        = \"172.31.21.119\"\nuser        = \"ec2-user\"\nkeyPath     = \"conf/*****.pem\"\n\n\nNVD\u304b\u3089\u3001\u8106\u5f31\u6027\u60c5\u5831\u3092\u53d6\u5f97\n\n\n\u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b \n\n\n\n$ sudo docker exec -t vuls scripts/fetch_nvd_all.sh \n\n 0 / 1 [-----------------------------]   0.00%[Jul 25 16:06:26]  INFO Fetching... https://static.nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-2002.xml.gz\n\n...\n...\n...\n\n[Jul 25 16:19:26]  INFO Refreshed 6297 Nvds.\n 0 / 1 [-----------------------------]   0.00%[Jul 25 16:19:26]  INFO Fetching... https://static.nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-2016.xml.gz\n[Jul 25 16:19:30]  INFO Fetched 3109 CVEs\n[Jul 25 16:19:30]  INFO Opening DB. datafile: /opt/vuls/cve.sqlite3\n[Jul 25 16:19:30]  INFO Migrating DB\n[Jul 25 16:19:30]  INFO Inserting CVEs...\n 3109 / 3109 [===================================================================================================================================] 100.00% 14s\n[Jul 25 16:19:45]  INFO Refreshed 3109 Nvds.\n\n\n\n\u30b9\u30ad\u30e3\u30f3\u3092\u5b9f\u884c\n\n$ sudo docker exec -t vuls vuls prepare -config=conf/config.toml\nINFO[0000] Start Preparing (config: conf/config.toml)\n[Jul 25 16:23:26]  INFO [localhost] Detecting OS...\n[Jul 25 16:23:26]  INFO [localhost] Detecting OS of servers...\n[Jul 25 16:23:26]  INFO [localhost] (1/1) Detected: 172-31-21-119: amazon 2016.03\n[Jul 25 16:23:26]  INFO [localhost] Detecting OS of containers...\n[Jul 25 16:23:26]  INFO [localhost] SSH-able servers are below...\n172-31-21-119\n[Jul 25 16:23:26]  INFO [localhost] Installing...\n[Jul 25 16:23:26]  INFO [172-31-21-119] Nothing to do\n[Jul 25 16:23:26]  INFO [localhost] Success\n\n$ sudo docker exec -t vuls scripts/scan_for_vulsrepo.sh\n\nINFO[0000] Start scanning\nINFO[0000] config: /opt/vuls/conf/config.toml\nINFO[0000] cve-dictionary: /opt/vuls/cve.sqlite3\n[Jul 25 16:23:32]  INFO [localhost] Validating Config...\n[Jul 25 16:23:32]  INFO [localhost] Detecting Server/Contianer OS...\n[Jul 25 16:23:32]  INFO [localhost] Detecting OS of servers...\n[Jul 25 16:23:32]  INFO [localhost] (1/1) Detected: 172-31-21-119: amazon 2016.03\n[Jul 25 16:23:32]  INFO [localhost] Detecting OS of containers...\n[Jul 25 16:23:32]  INFO [localhost] SSH-able servers are below...\n172-31-21-119\n[Jul 25 16:23:32]  INFO [localhost] Detecting Platforms...\n[Jul 25 16:23:32]  INFO [localhost] (1/1) 172-31-21-119 is running on aws\n[Jul 25 16:23:32]  INFO [localhost] Scanning vulnerabilities...\n[Jul 25 16:23:32]  INFO [localhost] Check required packages for scanning...\n[Jul 25 16:23:32]  INFO [localhost] Scanning vulnerable OS packages...\n[Jul 25 16:23:34]  INFO [172-31-21-119] Fetching CVE details...\n[Jul 25 16:23:34]  INFO [172-31-21-119] Done\n[Jul 25 16:23:34]  INFO [localhost] Scanning vulnerable software specified in the CPE...\n[Jul 25 16:23:34]  INFO [localhost] Insert to DB...\n[Jul 25 16:23:46]  INFO [localhost] Reporting...\n172-31-21-119 (amazon2016.03)\n=============================\nCVE-2016-1762   10.0 (High)     libxml2 in Apple iOS before 9.3, OS X before 10.11.4, Safari before 9.1, tvOS before\n                                9.2, and watchOS before 2.2 allows remote attackers to execute arbitrary code or\n                                cause a denial of service (memory corruption) via a crafted XML document.\nCVE-2016-4448   10.0 (High)     Format string vulnerability in libxml2 before 2.9.4 allows attackers to have\n                                unspecified impact via format string specifiers in unknown vectors.\nCVE-2016-1978   7.5  (High)     Use-after-free vulnerability in the ssl3_HandleECDHServerKeyExchange function in\n                                Mozilla Network Security Services (NSS) before 3.21, as used in Mozilla Firefox\n                                before 44.0, allows remote attackers to cause a denial of service or possibly have\n                                unspecified other impact by making an SSL (1) DHE or (2) ECDHE handshake at a time\n                                of high memory consumption.\nCVE-2016-0758   7.2  (High)     Integer overflow in lib/asn1_decoder.c in the Linux kernel before 4.6 allows local\n                                users to gain privileges via crafted ASN.1 data.\nCVE-2016-4557   7.2  (High)     The replace_map_fd_with_map_ptr function in kernel/bpf/verifier.c in the Linux\n                                kernel before 4.5.5 does not properly maintain an fd data structure, which allows\n                                local users to gain privileges or cause a denial of service (use-after-free) via\n                                crafted BPF instructions that reference an incorrect file descriptor.\nCVE-2016-4565   7.2  (High)     The InfiniBand (aka IB) stack in the Linux kernel before 4.5.3 incorrectly relies on\n                                the write system call, which allows local users to cause a denial of service (kernel\n                                memory write operation) or possibly have unspecified other impact via a uAPI\n                                interface.\n\n\u3000\u3000\u3000\u3000\u3000\u3000...\n\u3000\u3000\u3000\u3000\u3000\u3000...\n\u3000\u3000\u3000\u3000\u3000\u3000...\n\n\n\n\u30b9\u30ad\u30e3\u30f3\u7d50\u679c\u3092 http://\u30db\u30b9\u30c8IP\u30a2\u30c9\u30ec\u30b9/vulsrepo/\u306b \u30a2\u30af\u30bb\u30b9\u3057\u3066\u3001\u898b\u3066\u307f\u308b\u3068\u3001\u30b9\u30b2~~~ UI\u7d50\u69cb\u30a4\u30b1\u3066\u308b!\n\nTarget instance\u3092yum update\u3057\u3066\u304b\u3089\u3001\u3082\u3046\u4e00\u56de\u3084\u3063\u3066\u307f\u308b\n\n$ sudo docker exec -t vuls vuls prepare -config=conf/config.toml\n\nINFO[0000] Start Preparing (config: conf/config.toml)\n[Jul 25 16:34:19]  INFO [localhost] Detecting OS...\n[Jul 25 16:34:19]  INFO [localhost] Detecting OS of servers...\n[Jul 25 16:34:20]  INFO [localhost] (1/1) Detected: 172-31-21-119: amazon 2016.03\n[Jul 25 16:34:20]  INFO [localhost] Detecting OS of containers...\n[Jul 25 16:34:20]  INFO [localhost] SSH-able servers are below...\n172-31-21-119\n[Jul 25 16:34:20]  INFO [localhost] Installing...\n[Jul 25 16:34:20]  INFO [172-31-21-119] Nothing to do\n[Jul 25 16:34:20]  INFO [localhost] Success\n\n$ sudo docker exec -t vuls scripts/scan_for_vulsrepo.sh\n\nINFO[0000] Start scanning\nINFO[0000] config: /opt/vuls/conf/config.toml\nINFO[0000] cve-dictionary: /opt/vuls/cve.sqlite3\n[Jul 25 16:34:31]  INFO [localhost] Validating Config...\n[Jul 25 16:34:31]  INFO [localhost] Detecting Server/Contianer OS...\n[Jul 25 16:34:31]  INFO [localhost] Detecting OS of servers...\n[Jul 25 16:34:32]  INFO [localhost] (1/1) Detected: 172-31-21-119: amazon 2016.03\n[Jul 25 16:34:32]  INFO [localhost] Detecting OS of containers...\n[Jul 25 16:34:32]  INFO [localhost] SSH-able servers are below...\n172-31-21-119\n[Jul 25 16:34:32]  INFO [localhost] Detecting Platforms...\n[Jul 25 16:34:32]  INFO [localhost] (1/1) 172-31-21-119 is running on aws\n[Jul 25 16:34:32]  INFO [localhost] Scanning vulnerabilities...\n[Jul 25 16:34:32]  INFO [localhost] Check required packages for scanning...\n[Jul 25 16:34:32]  INFO [localhost] Scanning vulnerable OS packages...\n[Jul 25 16:34:33]  INFO [172-31-21-119] Fetching CVE details...\n[Jul 25 16:34:33]  INFO [172-31-21-119] Done\n[Jul 25 16:34:33]  INFO [localhost] Scanning vulnerable software specified in the CPE...\n[Jul 25 16:34:33]  INFO [localhost] Insert to DB...\n[Jul 25 16:34:33]  INFO [localhost] Reporting...\n\n172-31-21-119 (amazon2016.03)\n=============================\nNo unsecure packages.\n\n\u7d50\u679c\u306f No unsecure packages\u306b\u306a\u308a\u307e\u3057\u305f! \u3084\u306f\u308a\u3001Vuls\u304c\u8d85~~\u4fbf\u5229\u3067\u3059\u306d!\u3053\u308c\u3067\u3001\u904b\u7528\u3082\u697d\u306b\u306a\u308c\u307e\u3059!\n\n\u6700\u5f8c\n\u3000\u30af\u30e9\u30a6\u30c9\u3092\u524d\u63d0\u3068\u3057\u305f\u8a2d\u8a08\u304c\u300c\u30cb\u30e5\u30fc\u30ce\u30fc\u30de\u30eb\u300d\u306b\u306a\u3063\u305f\u4eca\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u304c\u307e\u3059\u307e\u3059\u91cd\u8981\u306b\u306a\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\u3000Amazon\u3082Inspector\u3068\u3044\u3046\u8a3a\u65ad\u7528\u306e\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308a\u307e\u3059\u3002Vuls\u3068\u9055\u3063\u3066\u3001\u5b8c\u5168\u306bAmazon\u306e\u30de\u30cd\u30b8\u30c9\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u306e\u3067\u3001\u30b5\u30fc\u30d0\u306e\u904b\u7528\u304c\u4e0d\u8981\u3067\u3059\u3002\u305d\u308c\u305e\u308c\u306e\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u5229\u7528\u8005\u304c\u81ea\u5206\u306e\u30cb\u30fc\u30ba\u306b\u3042\u3063\u305f\u3082\u306e\u3092\u5229\u7528\u3059\u308c\u3070\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u3000\u307e\u3060\u307e\u3060\u5168\u7136DeepDive\u3067\u304d\u3066\u3044\u307e\u305b\u3093\u304c\u3001Vuls\u306f\u3082Amazon Inspector\u3082\u672c\u5f53\u306b\u7d20\u6674\u3089\u3057\u3044\u30b5\u30fc\u30d3\u30b9\u3060\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u304b\u3089\u3001\u662f\u975e\u6d3b\u7528\u3057\u305f\u3044\u3067\u3059\u3002\n\n\u53c2\u8003\u306b\u306a\u3063\u305f\u30b5\u30a4\u30c8\n\nVuls: VULnerability Scanner\n\u30b5\u30fc\u30d0\u306e\u8106\u5f31\u6027\u30c1\u30a7\u30c3\u30af\u3067\u304d\u308bVuls\u3092docker\u3092\u4f7f\u3063\u3066\u8a66\u3057\u305f\n\n# Vuls\u306e\u30ed\u30b4\n![vuls_logo.png](https://qiita-image-store.s3.amazonaws.com/0/117156/851d0f3f-7b5c-8f58-c63a-7f98481aa20e.png)\n\n# \u306f\u3058\u3081\u306b\n\u3000\u6628\u65e5\u77e5\u308a\u307e\u3057\u305f\u3001Vuls( **<font color=\"red\">VUL</font>nerability <font color=\"red\">S</font>canner** )\u3068\u3044\u3046\u7d20\u6674\u3089\u3057\u3044\u8106\u5f31\u6027\u8a3a\u65ad\u30c4\u30fc\u30eb\u304c\u3042\u308a\u307e\u3059\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fGitHub\u306e[\u3010future-architect/vuls\u3011](https://github.com/future-architect/vuls)\u306b\u4e0a\u304c\u3063\u3066\u3044\u307e\u3059\u3002\u65e5\u672c\u306b\u3044\u308b\u65b9\u3005\u304c\u958b\u767a\u3057\u305f\u3082\u306e\u3067\u3059\u306e\u3067\u3001\u3053\u306e\u30b5\u30fc\u30d3\u30b9\u306b\u975e\u5e38\u306b\u671f\u5f85\u3057\u3066\u3044\u307e\u3059\u3002\n\u3000Vuls\u304c\u3067\u304d\u308b\u3053\u3068\u306b\u3064\u3044\u3066\u306f\u3001\u4e0b\u8a18[vuls/README.ja.md](https://github.com/future-architect/vuls/blob/master/README.ja.md)\u306b\u8a18\u8f09\u3055\u308c\u308b\u3053\u3068\u3092\u5f15\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3059\u3002\n>Vuls\u306f\u4e0a\u306b\u6319\u3052\u305f\u624b\u52d5\u904b\u7528\u3067\u306e\u8ab2\u984c\u3092\u89e3\u6c7a\u3059\u308b\u30c4\u30fc\u30eb\u3067\u3042\u308a\u3001\u4ee5\u4e0b\u306e\u7279\u5fb4\u304c\u3042\u308b\u3002\n>\u25cf\u3000\u30b7\u30b9\u30c6\u30e0\u306b\u95a2\u4fc2\u3042\u308b\u8106\u5f31\u6027\u306e\u307f\u6559\u3048\u3066\u304f\u308c\u308b\n>\u25cf\u3000\u305d\u306e\u8106\u5f31\u6027\u306b\u8a72\u5f53\u3059\u308b\u30b5\u30fc\u30d0\u3092\u6559\u3048\u3066\u304f\u308c\u308b\n>\u25cf\u3000\u81ea\u52d5\u30b9\u30ad\u30e3\u30f3\u306e\u305f\u3081\u8106\u5f31\u6027\u691c\u77e5\u306e\u6f0f\u308c\u3092\u9632\u3050\u3053\u3068\u304c\u3067\u304d\u308b\n>\u25cf\u3000CRON\u306a\u3069\u3067\u5b9a\u671f\u5b9f\u884c\u3001\u30ec\u30dd\u30fc\u30c8\u3059\u308b\u3053\u3068\u3067\u8106\u5f31\u6027\u306e\u653e\u7f6e\u3092\u9632\u3050\u3053\u3068\u3067\u304d\u308b\u3000\u3000\n\n\u3000**Docker\u3092\u4f7f\u3048\u3070\u3001\u7c21\u5358\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u3067\u304d\u3066\u3001\u3061\u3087\u3063\u3068\u3057\u305f\u8a2d\u5b9a\u3067\u3059\u3050Vuls\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002**\n\u3000\u6065\u305a\u304b\u3057\u3044\u306a\u304c\u3089\u3001\u81ea\u5206\u306fDocker\u3059\u3089\u3088\u304f\u89e6\u3063\u305f\u3053\u3068\u304c\u306a\u304f\u3001\u4eca\u56de\u306f\u3001Docker\u306e\u5b66\u7fd2\u3082\u517c\u306d\u3066\u3001\u81ea\u5206\u304c\u3084\u3063\u305f\u3053\u3068\u3092\u5171\u6709\u3057\u307e\u3059\u3002\n\n\u3000\u8a71\u304c\u305d\u308c\u307e\u3059\u304c\u3001\u6628\u5e74\u5ea6\u3001\u8106\u5f31\u6027\u5bfe\u5fdc\u306e\u696d\u52d9\u306b\u3059\u3053\u3057\u643a\u308f\u3063\u305f\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002\u305d\u306e\u6642\u306f\u3001\u8106\u5f31\u6027\u306e\u901a\u77e5\u304c\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u90e8\u9580\u304b\u3089\u6765\u308b\u305f\u3073\u306b\u3001\u5404\u30b7\u30b9\u30c6\u30e0\u306e\u30b5\u30fc\u30d0\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3001\u8106\u5f31\u6027\u3042\u308a\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u304b\u3092\u8abf\u67fb\u3057\u3066\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3057\u305f\u306e\u3067\u3001\u6b63\u76f4\u306b\u8a00\u3063\u3066\u3001\u5acc\u306a\u4f5c\u696d\u3067\u3057\u305f\u3002\u3067\u3059\u306e\u3067\u3001Vuls\u306e\u3053\u3068\u3092\u77e5\u3063\u3066\u304b\u3089\u3001\u305a\u3063\u3068\u982d\u304b\u3089\u96e2\u308c\u3089\u308c\u305a\u3001\u89e6\u308a\u305f\u3044\u3068\u601d\u3063\u3066\u3044\u305f\u306e\u3067\u3001\u65e9\u901f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3001\u89e6\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n# Vuls\u3092\u89e6\u3063\u3066\u307f\u3088\u3046\n## \u52d5\u4f5c\u74b0\u5883\n\n- Vuls\u306e\u30db\u30b9\u30c8\n\n|OS|Amazon Linux|\n|:--------:|:------------------:|\n|AMI|amzn-ami-hvm-2016.03.3.x86_64-gp2|\n|Docker|Version 1.11.2|\n\n- \u30b9\u30ad\u30e3\u30f3\u5bfe\u8c61\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n\n|OS|Amazon Linux|\n|:--------:|:------------------:|\n|AMI|amzn-ami-hvm-2016.03.1.x86_64-gp2|\n\n##\u624b\u9806\n- Vuls\u7528\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\n  - \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u5468\u308a\u306f\u5272\u611b\n\n- Vuls\u7528\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3055\u308c\u308b\u3068\u3001SSH\u30ed\u30b0\u30a4\u30f3\n\n**\u3053\u308c\u304b\u3089\u306fEC2\u5185\u306e\u4f5c\u696d**\n\n- \u3068\u308a\u3042\u3048\u305a\u3001yum update\n\n```\n$ sudo yum update -y\n```\n- docker\u3001docker-compose\u3001git\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n$ sudo yum -y install docker\n$ sudo pip install -U docker-compose\n$ sudo yum -y install git\n```\n- \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n```\n$ docker --version\nDocker version 1.11.2, build b9f10c9/1.11.2\n\n$ docker-compose -v\ndocker-compose version 1.7.1, build 6c29830\n\n$ git --version\ngit version 2.7.4\n```\n\n- Docker\u3092\u8d77\u52d5\n\n```\n$ sudo service docker start\n```\n- Vuls\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\n\n```\n$ git clone https://github.com/future-architect/vuls.git\n```\n\n- \u30a4\u30e1\u30fc\u30b8\u306e\u30d3\u30eb\u30c9\u3001\u30b3\u30f3\u30c6\u30ca\u3092\u4f5c\u6210\u3057\u3066\u3001\u8d77\u52d5\n  - \u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b \n\n```\n$ cd vuls/setup/docker\n\n$ sudo /usr/local/bin/docker-compose -p docker -f docker-compose.yml up -d\n\n$ sudo docker ps\n```\n\n<img width=\"989\" alt=\"\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 0028-07-25 22.37.35.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117156/ecf41378-a47b-2e25-53b0-4f935dc12157.png\">\n\n- Vuls\u306e\u8a2d\u5b9a\n  - Target instance\u306bSSH\u30ed\u30b0\u30a4\u30f3\u7528\u306ekey\u3092vuls/docker/conf/\u306b\u683c\u7d0d\n  - Target instance\u306bSSH\u30ed\u30b0\u30a4\u30f3\u7528\u306econfig\u30d5\u30a1\u30a4\u30eb(config.toml)\u3092vuls/docker/conf/\u306b\u4f5c\u6210\n\n```\n[servers]\n\n[servers.172-31-21-119]\nhost        = \"172.31.21.119\"\nuser        = \"ec2-user\"\nkeyPath     = \"conf/*****.pem\"\n```\n\n- NVD\u304b\u3089\u3001\u8106\u5f31\u6027\u60c5\u5831\u3092\u53d6\u5f97\n  - \u5c11\u3057\u6642\u9593\u304c\u304b\u304b\u308b \n\n```\n$ sudo docker exec -t vuls scripts/fetch_nvd_all.sh \n\n 0 / 1 [-----------------------------]   0.00%[Jul 25 16:06:26]  INFO Fetching... https://static.nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-2002.xml.gz\n\n...\n...\n...\n\n[Jul 25 16:19:26]  INFO Refreshed 6297 Nvds.\n 0 / 1 [-----------------------------]   0.00%[Jul 25 16:19:26]  INFO Fetching... https://static.nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-2016.xml.gz\n[Jul 25 16:19:30]  INFO Fetched 3109 CVEs\n[Jul 25 16:19:30]  INFO Opening DB. datafile: /opt/vuls/cve.sqlite3\n[Jul 25 16:19:30]  INFO Migrating DB\n[Jul 25 16:19:30]  INFO Inserting CVEs...\n 3109 / 3109 [===================================================================================================================================] 100.00% 14s\n[Jul 25 16:19:45]  INFO Refreshed 3109 Nvds.\n\n```\n\n- \u30b9\u30ad\u30e3\u30f3\u3092\u5b9f\u884c\n\n```\n$ sudo docker exec -t vuls vuls prepare -config=conf/config.toml\nINFO[0000] Start Preparing (config: conf/config.toml)\n[Jul 25 16:23:26]  INFO [localhost] Detecting OS...\n[Jul 25 16:23:26]  INFO [localhost] Detecting OS of servers...\n[Jul 25 16:23:26]  INFO [localhost] (1/1) Detected: 172-31-21-119: amazon 2016.03\n[Jul 25 16:23:26]  INFO [localhost] Detecting OS of containers...\n[Jul 25 16:23:26]  INFO [localhost] SSH-able servers are below...\n172-31-21-119\n[Jul 25 16:23:26]  INFO [localhost] Installing...\n[Jul 25 16:23:26]  INFO [172-31-21-119] Nothing to do\n[Jul 25 16:23:26]  INFO [localhost] Success\n```\n\n```\n$ sudo docker exec -t vuls scripts/scan_for_vulsrepo.sh\n\nINFO[0000] Start scanning\nINFO[0000] config: /opt/vuls/conf/config.toml\nINFO[0000] cve-dictionary: /opt/vuls/cve.sqlite3\n[Jul 25 16:23:32]  INFO [localhost] Validating Config...\n[Jul 25 16:23:32]  INFO [localhost] Detecting Server/Contianer OS...\n[Jul 25 16:23:32]  INFO [localhost] Detecting OS of servers...\n[Jul 25 16:23:32]  INFO [localhost] (1/1) Detected: 172-31-21-119: amazon 2016.03\n[Jul 25 16:23:32]  INFO [localhost] Detecting OS of containers...\n[Jul 25 16:23:32]  INFO [localhost] SSH-able servers are below...\n172-31-21-119\n[Jul 25 16:23:32]  INFO [localhost] Detecting Platforms...\n[Jul 25 16:23:32]  INFO [localhost] (1/1) 172-31-21-119 is running on aws\n[Jul 25 16:23:32]  INFO [localhost] Scanning vulnerabilities...\n[Jul 25 16:23:32]  INFO [localhost] Check required packages for scanning...\n[Jul 25 16:23:32]  INFO [localhost] Scanning vulnerable OS packages...\n[Jul 25 16:23:34]  INFO [172-31-21-119] Fetching CVE details...\n[Jul 25 16:23:34]  INFO [172-31-21-119] Done\n[Jul 25 16:23:34]  INFO [localhost] Scanning vulnerable software specified in the CPE...\n[Jul 25 16:23:34]  INFO [localhost] Insert to DB...\n[Jul 25 16:23:46]  INFO [localhost] Reporting...\n172-31-21-119 (amazon2016.03)\n=============================\nCVE-2016-1762\t10.0 (High)  \tlibxml2 in Apple iOS before 9.3, OS X before 10.11.4, Safari before 9.1, tvOS before\n             \t             \t9.2, and watchOS before 2.2 allows remote attackers to execute arbitrary code or\n             \t             \tcause a denial of service (memory corruption) via a crafted XML document.\nCVE-2016-4448\t10.0 (High)  \tFormat string vulnerability in libxml2 before 2.9.4 allows attackers to have\n             \t             \tunspecified impact via format string specifiers in unknown vectors.\nCVE-2016-1978\t7.5  (High)  \tUse-after-free vulnerability in the ssl3_HandleECDHServerKeyExchange function in\n             \t             \tMozilla Network Security Services (NSS) before 3.21, as used in Mozilla Firefox\n             \t             \tbefore 44.0, allows remote attackers to cause a denial of service or possibly have\n             \t             \tunspecified other impact by making an SSL (1) DHE or (2) ECDHE handshake at a time\n             \t             \tof high memory consumption.\nCVE-2016-0758\t7.2  (High)  \tInteger overflow in lib/asn1_decoder.c in the Linux kernel before 4.6 allows local\n             \t             \tusers to gain privileges via crafted ASN.1 data.\nCVE-2016-4557\t7.2  (High)  \tThe replace_map_fd_with_map_ptr function in kernel/bpf/verifier.c in the Linux\n             \t             \tkernel before 4.5.5 does not properly maintain an fd data structure, which allows\n             \t             \tlocal users to gain privileges or cause a denial of service (use-after-free) via\n             \t             \tcrafted BPF instructions that reference an incorrect file descriptor.\nCVE-2016-4565\t7.2  (High)  \tThe InfiniBand (aka IB) stack in the Linux kernel before 4.5.3 incorrectly relies on\n             \t             \tthe write system call, which allows local users to cause a denial of service (kernel\n             \t             \tmemory write operation) or possibly have unspecified other impact via a uAPI\n             \t             \tinterface.\n\n\u3000\u3000\u3000\u3000\u3000\u3000...\n\u3000\u3000\u3000\u3000\u3000\u3000...\n\u3000\u3000\u3000\u3000\u3000\u3000...\n\n```\n\n- \u30b9\u30ad\u30e3\u30f3\u7d50\u679c\u3092 **http://\u30db\u30b9\u30c8IP\u30a2\u30c9\u30ec\u30b9/vulsrepo/**\u306b \u30a2\u30af\u30bb\u30b9\u3057\u3066\u3001\u898b\u3066\u307f\u308b\u3068\u3001\u30b9\u30b2~~~ UI\u7d50\u69cb\u30a4\u30b1\u3066\u308b!\n<img width=\"1750\" alt=\"1.pic_hd.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/117156/1148c9d7-90ce-d8f5-bd48-49c61ba06abf.jpeg\">\n\n\n- Target instance\u3092yum update\u3057\u3066\u304b\u3089\u3001\u3082\u3046\u4e00\u56de\u3084\u3063\u3066\u307f\u308b\n\n```\n$ sudo docker exec -t vuls vuls prepare -config=conf/config.toml\n\nINFO[0000] Start Preparing (config: conf/config.toml)\n[Jul 25 16:34:19]  INFO [localhost] Detecting OS...\n[Jul 25 16:34:19]  INFO [localhost] Detecting OS of servers...\n[Jul 25 16:34:20]  INFO [localhost] (1/1) Detected: 172-31-21-119: amazon 2016.03\n[Jul 25 16:34:20]  INFO [localhost] Detecting OS of containers...\n[Jul 25 16:34:20]  INFO [localhost] SSH-able servers are below...\n172-31-21-119\n[Jul 25 16:34:20]  INFO [localhost] Installing...\n[Jul 25 16:34:20]  INFO [172-31-21-119] Nothing to do\n[Jul 25 16:34:20]  INFO [localhost] Success\n```\n\n```\n$ sudo docker exec -t vuls scripts/scan_for_vulsrepo.sh\n\nINFO[0000] Start scanning\nINFO[0000] config: /opt/vuls/conf/config.toml\nINFO[0000] cve-dictionary: /opt/vuls/cve.sqlite3\n[Jul 25 16:34:31]  INFO [localhost] Validating Config...\n[Jul 25 16:34:31]  INFO [localhost] Detecting Server/Contianer OS...\n[Jul 25 16:34:31]  INFO [localhost] Detecting OS of servers...\n[Jul 25 16:34:32]  INFO [localhost] (1/1) Detected: 172-31-21-119: amazon 2016.03\n[Jul 25 16:34:32]  INFO [localhost] Detecting OS of containers...\n[Jul 25 16:34:32]  INFO [localhost] SSH-able servers are below...\n172-31-21-119\n[Jul 25 16:34:32]  INFO [localhost] Detecting Platforms...\n[Jul 25 16:34:32]  INFO [localhost] (1/1) 172-31-21-119 is running on aws\n[Jul 25 16:34:32]  INFO [localhost] Scanning vulnerabilities...\n[Jul 25 16:34:32]  INFO [localhost] Check required packages for scanning...\n[Jul 25 16:34:32]  INFO [localhost] Scanning vulnerable OS packages...\n[Jul 25 16:34:33]  INFO [172-31-21-119] Fetching CVE details...\n[Jul 25 16:34:33]  INFO [172-31-21-119] Done\n[Jul 25 16:34:33]  INFO [localhost] Scanning vulnerable software specified in the CPE...\n[Jul 25 16:34:33]  INFO [localhost] Insert to DB...\n[Jul 25 16:34:33]  INFO [localhost] Reporting...\n\n172-31-21-119 (amazon2016.03)\n=============================\nNo unsecure packages.\n```\n\n\u7d50\u679c\u306f **No unsecure packages**\u306b\u306a\u308a\u307e\u3057\u305f! \u3084\u306f\u308a\u3001Vuls\u304c\u8d85~~\u4fbf\u5229\u3067\u3059\u306d!\u3053\u308c\u3067\u3001\u904b\u7528\u3082\u697d\u306b\u306a\u308c\u307e\u3059!\n\n# \u6700\u5f8c\n\n\u3000\u30af\u30e9\u30a6\u30c9\u3092\u524d\u63d0\u3068\u3057\u305f\u8a2d\u8a08\u304c\u300c\u30cb\u30e5\u30fc\u30ce\u30fc\u30de\u30eb\u300d\u306b\u306a\u3063\u305f\u4eca\u3001\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u304c\u307e\u3059\u307e\u3059\u91cd\u8981\u306b\u306a\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\u3000Amazon\u3082Inspector\u3068\u3044\u3046\u8a3a\u65ad\u7528\u306e\u30b5\u30fc\u30d3\u30b9\u304c\u3042\u308a\u307e\u3059\u3002Vuls\u3068\u9055\u3063\u3066\u3001\u5b8c\u5168\u306bAmazon\u306e\u30de\u30cd\u30b8\u30c9\u30b5\u30fc\u30d3\u30b9\u3067\u3059\u306e\u3067\u3001\u30b5\u30fc\u30d0\u306e\u904b\u7528\u304c\u4e0d\u8981\u3067\u3059\u3002\u305d\u308c\u305e\u308c\u306e\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059\u306e\u3067\u3001\u5229\u7528\u8005\u304c\u81ea\u5206\u306e\u30cb\u30fc\u30ba\u306b\u3042\u3063\u305f\u3082\u306e\u3092\u5229\u7528\u3059\u308c\u3070\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u3000\u307e\u3060\u307e\u3060\u5168\u7136DeepDive\u3067\u304d\u3066\u3044\u307e\u305b\u3093\u304c\u3001Vuls\u306f\u3082Amazon Inspector\u3082\u672c\u5f53\u306b\u7d20\u6674\u3089\u3057\u3044\u30b5\u30fc\u30d3\u30b9\u3060\u3068\u601d\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u304b\u3089\u3001\u662f\u975e\u6d3b\u7528\u3057\u305f\u3044\u3067\u3059\u3002\n\n# \u53c2\u8003\u306b\u306a\u3063\u305f\u30b5\u30a4\u30c8\n\n- [Vuls: VULnerability Scanner](https://github.com/future-architect/vuls/blob/master/README.ja.md)\n- [\u30b5\u30fc\u30d0\u306e\u8106\u5f31\u6027\u30c1\u30a7\u30c3\u30af\u3067\u304d\u308bVuls\u3092docker\u3092\u4f7f\u3063\u3066\u8a66\u3057\u305f](http://cross-black777.hatenablog.com/entry/2016/05/09/090000#\u5b9f\u969b\u306b\u4f7f\u3063\u3066\u307f\u308b)\n"}