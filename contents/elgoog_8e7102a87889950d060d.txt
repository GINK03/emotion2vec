{"context": "\n\n\u80cc\u666f\n\u73fe\u5728\u3001TensorFlow\u3001Chainer\u4ed6\u591a\u6570\u306eDeepLearning\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u672c\u683c\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u4f7f\u3046\u306b\u306f\u5b9f\u884c\u30b9\u30d4\u30fc\u30c9\u3001\u30af\u30aa\u30ea\u30c6\u30a3\u3001\u62e1\u5f35\u6027\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3001\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306e\u5145\u5b9f\u7b49\u591a\u304f\u306e\u9762\u3067\u3001\u305d\u308c\u3089\u306e\u4e2d\u304b\u3089\u9078\u629e\u3057\u3066\u4f7f\u7528\u3059\u308b\u306e\u304c\u9244\u677f\u306a\u72b6\u6cc1\u3067\u3059\u3002\u3082\u3061\u308d\u3093\u3001\u79c1\u3082\u30e1\u30a4\u30f3\u3067\u306f\u305d\u308c\u3089\u3092\u4f7f\u308f\u305b\u3066\u3082\u3089\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3001\u4f8b\u3048\u3070tensorFlow\u3067\u306fcomputatoin graph\u3092\u69cb\u7bc9\u3001operation\u3092\u8ffd\u52a0\u3057\u3066\u305d\u308c\u3092\u5b9f\u884c\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u3067\uff08\u884c\u5217\u3001\u6570\u5f0f\u3067\u53d6\u308a\u6271\u3046\u30a4\u30e1\u30fc\u30b8\uff09\u3001\u6839\u5e95\u306b\u3042\u308b\u53e4\u5178\u7684\u306a\u30cb\u30e5\u30fc\u30ed\u30f3\u306e\u7d50\u5408\u3068\u3044\u3046\u8003\u3048\u65b9\u304c\u96a0\u3055\u308c\u3066\u3044\u308b\u6c17\u304c\u3057\u307e\u3059\u3002\u3080\u3057\u308d\u3001\u305d\u306e\u3053\u3068\u306f\u5fd8\u308c\u3066\u7a81\u304d\u9032\u3093\u3067\u3057\u307e\u3063\u3066\u3082\u826f\u3044\u6c17\u306f\u3057\u307e\u3059\u304c\u3001\u81ea\u5206\u306e\u7406\u89e3\u3092\u6df1\u3081\u308b\u610f\u5473\u3067\u3082\u30cb\u30e5\u30fc\u30ed\u30f3\u6307\u5411\u3067\u30b9\u30af\u30e9\u30c3\u30c1\u304b\u3089\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\u4f7f\u7528\u8a00\u8a9e\u306f\u6a5f\u68b0\u5b66\u7fd2\u5206\u91ce\u3067\u306fPython\u306b\u6b8b\u5ff5\u306a\u304c\u3089\u9045\u308c\u3092\u3068\u3063\u3066\u3044\u308bRuby\u3092\u9078\u629e\u3002\nDeepLearning\u306b\u8208\u5473\u304c\u3042\u308b\u3051\u3069\u30ac\u30c3\u30c4\u30ea\u3067\u306f\u306a\u304f\u5c11\u3057\u3055\u308f\u3063\u3066\u307f\u305f\u3044\u65b9\u3001\u516c\u958b\u30e9\u30a4\u30d6\u30e9\u30ea\u304cpython\u7528\u306e\u305f\u3081\u306a\u3093\u3068\u306a\u304f\u624b\u3092\u51fa\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u65b9\u306a\u3069\u306e\u5165\u308a\u53e3\u306b\u306a\u308c\u3070\u3046\u308c\u3057\u3044\u3067\u3059\u3002\n\nRubyBrain\n\u4eca\u56de\u4f7f\u7528\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u540d\u524d\u306fRubyBrain\u3067\u3059\u3002\n\u80cc\u666f\u3067\u3082\u66f8\u3044\u305f\u3068\u304a\u308a\u73fe\u5728\u4e3b\u6d41\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u4f7f\u7528\u8005\u5074\u304b\u3089\u306f\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u7e4b\u304e\u3042\u308f\u305b\u3066\u4eba\u9593\u306e\u8133\u3092\u6a21\u5023\u3057\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u3063\u3066\u4f55\u304b\u3092\u5b66\u7fd2\u3055\u305b\u308b\u3068\u3044\u3046\u53e4\u5178\u7684\u306a\u30a4\u30e1\u30fc\u30b8\u306f\u96a0\u3055\u308c\u3001\u6570\u5f0f\u3092\u3064\u306a\u304e\u5408\u308f\u305b\u3066\u305d\u306egraph\u3092\u60c5\u5831\u304c\u6d41\u308c\u3066\u72b6\u614b\u66f4\u65b0\u3092\u884c\u3046\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\u305d\u306e\u70b9\u3067\u306f\u3001tensorFlow, Chainer\u5171\u306b\u30cd\u30fc\u30df\u30f3\u30b0\u30bb\u30f3\u30b9\u304c\u3068\u3066\u3082\u3088\u3044\u3068\u611f\u5fc3\u3057\u307e\u3059\uff08\u7279\u306bChainer\uff09\u3002tensorFlow\u306f\u6b21\u5143\u304c\u6d41\u308c\u308b\u30a4\u30e1\u30fc\u30b8\u3001chainer\u306f\u6570\u5f0f\u3092\u3064\u306a\u304e\u5408\u308f\u305b\u3066\u3044\u304f\u30a4\u30e1\u30fc\u30b8\u3067\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u57fa\u672c\u6982\u5ff5\u3092\u3046\u307e\u304f\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\n\u3067\u3001RubyBrain\u3067\u3059\u304c\u3001\u540d\u524d\u304b\u3089\u5c11\u3057\u306f\u60f3\u50cf\u3067\u304d\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u53e4\u5178\u7684\u306a\u30cb\u30e5\u30fc\u30ed\u30f3\u306e\u3064\u306a\u304e\u5408\u308f\u305b\u3092\u30a4\u30e1\u30fc\u30b8\u3057\u3066\u5b9f\u88c5\u3057\u3066\u3042\u308a\u307e\u3059\u3002\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u8868\u3059class Neuron\u3092\u7528\u610f\u3057\u3066\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u5404\u30cb\u30e5\u30fc\u30ed\u30f3\u306fNeuron class\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u8868\u73fe\u3057\u307e\u3059\u3002\u307e\u305f\u3001Ruby\u306e\u7d44\u307f\u8fbc\u307f\uff06\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u307f\u4f7f\u7528\u3057\u3066\u5b9f\u88c5\u3057\u3066\u304a\u308a\u3001\u5165\u529b\u3001\u51fa\u529b\u306b\u4f7f\u7528\u3059\u308b\u30c7\u30fc\u30bf\u69cb\u9020\u3082Ruby\u6a19\u6e96\u306eArray\u3067\u3059\u3002\u30cb\u30e5\u30fc\u30ed\u30f3\u6307\u5411\u3067\u306e\u5b9f\u88c5\u306e\u826f\u3044\u70b9\u306f\u3001\u5404\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u500b\u5225\u306b\u64cd\u4f5c\u3057\u3066\u5b9f\u9a13\u3057\u305f\u3044\u5834\u5408\u306a\u3069\u305d\u308c\u307b\u3069\u96e3\u3057\u304f\u306a\u3044\uff08\u306f\u305a\uff09\u3002\u60aa\u3044\u70b9\u306f\u3001\u3068\u306b\u304b\u304f\u9045\u3044\u3002\n\n\u4f7f\u7528\u74b0\u5883\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\n\u4eca\u56de\u4f5c\u3063\u305fgem\u306f\u3001rubygems.org\u306bruby_brain\u3068\u3057\u3066\u30ea\u30ea\u30fc\u30b9\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fgithub\u306b\u516c\u958b\u3057\u3066\u3044\u307e\u3059\u3002\nrubygems.org/gems/ruby_brain\ngithub.com/elgoog/ruby_brain\nruby_brain\u672c\u4f53\u306fRuby\u306e\u7d44\u8fbc\uff06\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u74b0\u5883\u6e96\u5099\u306b\u95a2\u3057\u3066\u306f\u5927\u304d\u306a\u554f\u984c\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u8a18\u4e8b\u306e\u5185\u5bb9\u306fRuby 2.3.1\u3067\u8a66\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u4ed6\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3082\u554f\u984c\u306a\u304f\u52d5\u304f\u306f\u305a\u3067\u3059\u3002\nirb/pry\u7b49\u3067\u9806\u6b21\u5165\u529b\u3057\u3066\u8a66\u3057\u3066\u307f\u308b\u3068\u3088\u3044\u304b\u3082\u3002\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ngem install ruby_brain\n\niRuby notebook\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\uff13\u3064\u306eexample\u3092\u53d6\u308a\u6271\u3044\u307e\u3059\u304c\u3001\u5f8c\u534a\uff12\u3064\u306eexample\u306b\u3064\u3044\u3066\u306f\u3001iRuby notebook\u3067\u3082\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\u4e00\u90e8\u3001\u672c\u8a18\u4e8b\u3068\u9055\u3046\u90e8\u5206\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3061\u3089\u306enotebook\u3082\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\nexamples/wave_form - iRuby\nexamples/mnist - iRuby\n\u672c\u8a18\u4e8b\u5185\u306e\u56f3\u306fiRuby notebook\u4e0a\u3067nyaplot\u3092\u4f7f\u3063\u3066\u63cf\u3044\u305f\u3082\u306e\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u3044\u307e\u3059\u3002\n\nExample 1 - AND\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\n\u307e\u305a\u3001\u7c21\u5358\u306a\u4f8b\u3068\u3057\u3066\uff12\u5165\u529b\u3001\uff11\u51fa\u529b\u306eAND\u306e\u52d5\u4f5c\u3092\u884c\u3046AND\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u69cb\u7bc9\u3057\u3066\u307f\u307e\u3059\u3002\nAND\u306e\u771f\u7406\u5024\u8868\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\u5165\u529b\u304c\u4e21\u65b9\u5171\uff11\u306e\u6642\u306b\u51fa\u529b\u304c\uff11\u3001\u305d\u308c\u4ee5\u5916\u306e\u6642\u306f\u51fa\u529b\u304c\uff10\u3068\u306a\u308b\u3053\u3068\u3092\u671f\u5f85\u3057\u3066\u3044\u307e\u3059\u3002\n\n\n\nin 1\nin 2\nout\n\n\n\n\n0\n0\n0\n\n\n0\n1\n0\n\n\n1\n0\n0\n\n\n1\n1\n1\n\n\n\n\n\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u306b\u4f7f\u3046\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u6e96\u5099\u3057\u307e\u3059\u3002\n\u5165\u529b\u30c7\u30fc\u30bf\u3001\u51fa\u529b\u30c7\u30fc\u30bf\u3068\u3082\u306b2\u6b21\u5143Array\u306b\u306a\u308a\u307e\u3059\u3002\u5404\u6b21\u5143\u306f\u30c7\u30fc\u30bf\u306e\u30b5\u30f3\u30d7\u30eb\u3001\u30c7\u30fc\u30bf\u306efeature\uff08\u4e0a\u8a18\u8868\u306e\u5404\u30ab\u30e9\u30e0\uff09\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\ntraining_input_set = [\n  [0, 0],\n  [0, 1],\n  [1, 0],\n  [1, 1],\n]\n\ntraining_supervisor_set = [\n  [0],\n  [0],\n  [0],\n  [1],\n]\n\ntraining_input_set\u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3078\u306e\u5165\u529b\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3001\u305d\u308c\u3092\u5165\u529b\u3057\u305f\u969b\u306b\u671f\u5f85\u3059\u308b\u51fa\u529b\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u304ctraining_supervisor_set\u3067\u3059\u3002\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u7bc9\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u9020\u306fArray\u3067\u8868\u3057\u307e\u3059\u3002\n\u5165\u529b\uff12\u3001\uff15\u3064\u306e\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u3082\u3064\u96a0\u308c\u5c64\uff11\u3001\u51fa\u529b\uff11\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u9020\u306f\u4e0b\u8a18\u306e\u901a\u308a\u8868\u73fe\u3067\u304d\u307e\u3059\u3002\n# 2 inputs\n# 5 units in a hidden layer\n# 1 output\n[2, 5, 1]\n\n\u96a0\u308c\u5c64\u304c\uff12\u5c64\u4ee5\u4e0a\u306e\u5834\u5408\u3082\u4e0b\u8a18\u306e\u3088\u3046\u306b\u7c21\u5358\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\n# 2 inputs\n# 4 units in 1st hidden layer\n# 3 units in 2nd hidden layer\n# 1 output\n[2, 4, 2, 1]\n\n\u6b21\u306b\u3001\u5b9f\u969b\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001AND\u306e\u5165\u529b\u304c\uff12\u3064\u3001\u51fa\u529b\u304c\uff11\u3064\u306a\u306e\u3067\u3001[2, 5, 1]\u306e\u69cb\u6210\u306b\u3057\u307e\u3059\u3002\n\u96a0\u308c\u5c64\u306f\uff11\u3064\u3067\u30cb\u30e5\u30fc\u30ed\u30f3\uff15\u3064\u3092\u6301\u3064\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\nrequire 'ruby_brain'\n\n# Netwwork\u30af\u30e9\u30b9\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u9020Array\u3092\u6e21\u3059\u3053\u3068\u306b\u3088\u308a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u308b\na_network = RubyBrain::Network.new([2, 5, 1])\n\n# learning_rate\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\uff08\u79c1\u306e\u8a2d\u8a08\u30df\u30b9\u3067\u3053\u3093\u306a\u3068\u3053\u308d\u3067\u5b66\u7fd2\u7387\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u307e\u3059\u3002\u3002\u6642\u9593\u53d6\u308c\u305f\u3089\u4fee\u6b63\u3059\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\uff09\na_network.learning_rate = 0.5\n\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f7f\u7528\u3059\u308b\u524d\u306b\u521d\u671f\u5316\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u3053\u3067\u5b9f\u969b\u306b\u5185\u90e8\u3067\u91cd\u307f\u7528Array\u3092\u78ba\u4fdd\u3057\u3001\u521d\u671f\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\na_network.init_network\n\n\n\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306flearn\u30e1\u30bd\u30c3\u30c9\u306b\u3001\u5165\u529b\u30c7\u30fc\u30bf\u3001\u671f\u5f85\u3059\u308b\u51fa\u529b\u30c7\u30fc\u30bf\uff08\u6559\u5e2b\u30c7\u30fc\u30bf\uff09\u3092\u4e0e\u3048\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u884c\u3044\u307e\u3059\u3002\n# max_training_cout : \u6700\u5927\u3067\u4f55\u56de\u307e\u3067\u5b66\u7fd2\u3092\u884c\u3046\u304b\u3092\u8a2d\u5b9a\n# tolerance : RMS\u30a8\u30e9\u30fc\u306e\u8a31\u5bb9\u5024\u3092\u8a2d\u5b9a\u3002\u30a8\u30e9\u30fc\u304c\u3053\u306e\u5024\u3088\u308a\u5c0f\u3055\u304f\u306a\u308b\u3068\u5b66\u7fd2\u4f1a\u6570\u304cmax_training_count\u306b\u9054\u3057\u3066\u3044\u306a\u304f\u3066\u3082\u5b66\u7fd2\u3092\u7d42\u4e86\u3059\u308b\n# monitoring_channels : \u5b66\u7fd2\u4e2d\u306b\u4f55\u3092\u30ed\u30b0\u3068\u3057\u3066\u51fa\u529b\u3059\u308b\u304b\u3092\u8a2d\u5b9a\u3002\u4eca\u306e\u3068\u3053\u308d\u4e0b\u8a18\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\na_network.learn(training_input_set, training_supervisor_set, max_training_count=3000, tolerance=0.0004, monitoring_channels=[:best_params_training])\n\n\u30e1\u30bd\u30c3\u30c9\u306e\u5b9f\u884c\u304c\u7d42\u4e86\u3057\u305f\u3089\u3001a_network\u304cAND\u52d5\u4f5c\u3092\u884c\u3046\u3088\u3046\u306b\u6700\u9069\u5316\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u52d5\u4f5c\u78ba\u8a8d\nget_forward_outputs\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u529b\u3092\u4e0e\u3048\u305f\u5834\u5408\u306e\u51fa\u529b\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nAND\u306ein1, in2\u306b\u5404\u5165\u529b\u3092\u4e0e\u3048\u3066\u78ba\u304b\u3081\u3066\u307f\u307e\u3059\u3002\na_network.get_forward_outputs([0, 0]) # => [0.00023268152328014436]\na_network.get_forward_outputs([0, 1]) # => [0.01829368167074594]\na_network.get_forward_outputs([1, 0]) # => [0.01900452216228691]\na_network.get_forward_outputs([1, 1]) # => [0.9727050287128143]\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u6b63\u3057\u304fAND\u306e\u52d5\u4f5c\u3092\u884c\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u306e\u51fa\u529b\u5024\u306f\u3001\u4e0a\u8a18\u3068\u30d4\u30c3\u30bf\u30ea\u540c\u3058\u306b\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u91cd\u307f\u306e\u521d\u671f\u5024\u304c\u30e9\u30f3\u30c0\u30e0\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u5b66\u7fd2\u304c\u7d42\u308f\u3063\u305f\u6642\u70b9\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u91cd\u307f\u304c\u79c1\u306e\u74b0\u5883\u3068\u540c\u3058\u306b\u306a\u308b\u53ef\u80fd\u6027\u306f\u975e\u5e38\u306b\u4f4e\u3044\u305f\u3081\u3067\u3059\u3002\n\u3057\u304b\u3057\u3001[1, 1]\u3092\u5165\u529b\u3057\u305f\u5834\u5408\u306b1\u306b\u8fd1\u3044\u5024\u3001\u305d\u308c\u4ee5\u5916\u306e\u5165\u529b\u306e\u5834\u54080\u306b\u8fd1\u3044\u5024\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\u4ee5\u4e0a\u3067AND\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u7bc9\u5b8c\u4e86\u3067\u3059\u3002\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u91cd\u307f\u306e\u4fdd\u5b58\uff06\u5fa9\u5143\n\u4e0a\u8a18\u306e\u4f8b\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u975e\u5e38\u306b\u5358\u7d14\u306a\u3082\u306e\u306a\u306e\u3067\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306b\u3082\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001\n\u3082\u3063\u3068\u5927\u304d\u306a\u69cb\u9020\uff06\u5927\u304d\u306a\u30c7\u30fc\u30bf\u3067\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3057\u3066\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u3063\u305f\u5834\u5408\u3001\u51fa\u6765\u4e0a\u304c\u3063\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u91cd\u307f\u3092\u518d\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u304c\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30e1\u30bd\u30c3\u30c9\u3067\u3001\u4fdd\u5b58\uff06\u5fa9\u5143\u304c\u53ef\u80fd\u3067\u3059\u3002\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306fYAML\u3067\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002\n# \u4fdd\u5b58\na_network.dump_weights_to_yaml('/path/to/saved/weights/file.yml')\n\n# \u5fa9\u5143\na_network = RubyBrain::Network.new([2, 5, 1])\na_network.init_network\na_network.load_weights_from_yaml_file('/path/to/saved/weights/file.yml')\n\n\nExample 2 - \u6ce2\u5f62\u306e\u8fd1\u4f3c\n\u6b21\u306b\u5c11\u3057\u30c7\u30fc\u30bf\u91cf\u3092\u5897\u3084\u3057\u305f\u4f8b\u3092\u898b\u308b\u305f\u3081\u3001\u9069\u5f53\u306a\u6ce2\u5f62\u3092\u4f5c\u3063\u3066\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u3068\u3057\u3066\u4f7f\u7528\u3057\u3066\u307f\u307e\u3059\u3002\niRuby notebook\u7248\u306f\u3053\u3061\u3089\uff1d\uff1e\u3000examples/wave_form - iRuby\n\u3053\u3053\u3067\u3001\u3057\u308c\u3063\u3068\u66f8\u304d\u307e\u3059\u304c\u3001\u3001\n\u73fe\u5728activation\u95a2\u6570\u3068\u3057\u3066sigmoid\u95a2\u6570\u3092\u6301\u3064\u30cb\u30e5\u30fc\u30ed\u30f3\u3057\u304b\u7528\u610f\u3057\u3066\u307e\u305b\u3093\u3002\u3002\uff08\u5b8c\u5168\u306a\u624b\u629c\u304d\u3067\u3059\u3002\u3002\uff09\n\u306a\u306e\u3067\u6700\u7d42\u5c64\u3082sigmoid\u306e\u51fa\u529b0~1\u3057\u304b\u51fa\u529b\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u5b66\u7fd2\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u30820~1\u306e\u9593\u3067\u8868\u73fe\u3059\u308b\u3088\u3046\u306b\u6ce8\u610f\u3057\u307e\u3059\u3002(\u5165\u529b\u5074\u306f0~1\u306e\u7bc4\u56f2\u5916\u3067\u3082\u5927\u4e08\u592b\u3067\u3059\u3002)\nX\u306e\u5024\u30920~1\u306e\u7bc4\u56f2\u30010.01\u30b9\u30c6\u30c3\u30d7\u3067\u7528\u610f\u3057\u307e\u3059\u3002\nX = (0..1).step(0.01).to_a\n\n(0.75\u2217sin(x\u22172\u2217\u03c0)+0.15\u2217cos(5\u2217\u03c0\u20130.023)+1)/2(0.75 * sin(x*2*\\pi) + 0.15 * cos(5*\\pi \u2013 0.023) + 1) / 2\u3092Y_IDEAL\u3068\u3057\u3066\u3001\n\u305d\u308c\u306b\u30e9\u30f3\u30c0\u30e0\u3067\u30ce\u30a4\u30ba(-0.05..0.005)\u3092\u306e\u305b\u305f\u3082\u306e\u3092Y\u3068\u3057\u307e\u3059\u3002\nY_IDEAL = X.map {|x| (0.75 * Math.sin(x*2*Math::PI) - 0.2 * Math.cos(5*x*2*Math::PI - 0.023) + 1) / 2} \nY = [Y_IDEAL, Array.new(X.size) {rand(-0.05..0.05)}].transpose.map {|e| e.inject(:+)}\n\n\u79c1\u306e\u74b0\u5883\u3067\u751f\u6210\u3057\u305fX, Y, Y_IDEAL\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\u3053\u306eX\u3092input\u3001Y\u3092output\u3068\u3057\u3066\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5b66\u7fd2\u3055\u305b\u307e\u3059\u3002\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u69cb\u6210\u306f[1, 13, 6, 1]\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\na_network = RubyBrain::Network.new([1, 13, 6, 1])\na_network.init_network\na_network.learning_rate = 0.5\na_network.learn(X.map{|e| [e]}, Y.map{|e| [e]}, max_tra2ining_count=40000, tolerance=0.0004, monitoring_channels=[:best_params_training])\n\n\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3057\u305fa_networ\u306f\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002Y_PREDICATED\u304ca_network\u306bX\u3092\u5165\u308c\u305f\u6642\u306eoutput\u306b\u306a\u308a\u307e\u3059\u3002\nY_PREDICATED = X.map{|e| [e]}.map {|a| a_network.get_forward_outputs(a).first}\n\n\u79c1\u306e\u74b0\u5883\u3067\u306e\u7d50\u679c\u3092\u30d7\u30ed\u30c3\u30c8\u3059\u308b\u3068\u4e0b\u56f3\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u826f\u3044\u611f\u3058\u3067\u6a21\u5023\u3057\u3066\u3044\u307e\u3059\u3002\n\n\nExample 3 - MNIST\nExample\u306e\u6700\u5f8c\u3068\u3057\u3066MNIST\u3092\u8a66\u3057\u3066\u307f\u307e\u3059\u300228*28\u30d4\u30af\u30bb\u30eb\u306e\u624b\u66f8\u304d\u6570\u5b57\u753b\u50cf\u30920~9\u306b\u30af\u30e9\u30b9\u5206\u3051\u3059\u308b\u6a5f\u68b0\u5b66\u7fd2\u306eHelloWorld\u7684\u306a\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u3059\u3002\niRuby notebook\u7248\u306f\u3053\u3061\u3089\u3000\uff1d\uff1e\u3000examples/mnist - iRuby\n\nMNIST\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\n\u4ed8\u5c5e\u306e\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3059\u308b\u3068MNIST\u306e\u30c7\u30fc\u30bf\u3092\u7c21\u5358\u306bRuby\u306eArray\u306b\u5165\u308c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u306f THE MNIST DATABASE of handwritten digits \u3088\u308a\u3001\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u306b\u306fmrkn\u3055\u3093\u306egem mnist\u3092\u4f7f\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\nrequire 'ruby_brain'\n\n# MNIST\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u53d6\u308a\u6271\u3046\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9\u3092\u30ed\u30fc\u30c9\nrequire 'ruby_brain/dataset/mnist/data'\n\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3001DataSet::Mnist::data\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068MNIST\u306e\u30c7\u30fc\u30bf\u3092Array\u3068\u3057\u3066\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\ndataset\u306fArray\u3067\u3001training\u7528\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3068test\u7528\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\ndataset = RubyBrain::DataSet::Mnist::data\ntraining_dataset = dataset.first\ntest_dataset = dataset.last\n\n\u5404\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\n# :input, :output\u3092key\u3068\u3059\u308bHash\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\ntraining_dataset.keys # => [:input, :output]\ntest_dataset.keys     # => [:input, :output]\n\n# \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e :input \u306f 60000(samples) x 784(28 * 28 input pixcels)\ntraining_dataset[:input].size       # => 60000\ntraining_dataset[:input].first.size # => 784\n\n# \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e :output \u306f 60000(samples) x 10(0~9\u306e10\u30af\u30e9\u30b9)\ntraining_dataset[:output].size       # => 60000\ntraining_dataset[:output].first.size # => 10\n\n# \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e:input \u306f 10000(samples) x 784(28 * 28 input pixcels)\ntest_dataset[:input].size       # => 10000\ntest_dataset[:input].first.size # => 784\n\n# \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e :output \u306f 10000(samples) x 10(0~9\u306e10\u30af\u30e9\u30b9)\ntest_dataset[:output].size       # => 10000\ntest_dataset[:output].first.size # => 10\n\n\u3053\u306e\u4f8b\u3067\u306ftraining_dataset\u306e\u6700\u521d\u306e5000\u30b5\u30f3\u30d7\u30eb\u306e\u307f\u5b9f\u969b\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002RubyBrain\u304c\u9045\u304f\u3001\u516870000\u679a\u306e\u753b\u50cf\u3092\u4f7f\u7528\u3059\u308b\u3068\u5b66\u7fd2\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u3059\u304e\u308b\u305f\u3081\u3067\u3059\u3002\n# \u6700\u521d\u306e5000\u679a\u306e\u307f\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306b\u4f7f\u7528\nNUM_TRAIN_DATA = 5000\ntraining_input = training_dataset[:input][0..(NUM_TRAIN_DATA-1)]\ntraining_supervisor = training_dataset[:output][0..(NUM_TRAIN_DATA-1)]\n# test_dataset\u306f\u3059\u3079\u3066\u4f7f\u7528\ntest_input = test_dataset[:input]\ntest_supervisor = test_dataset[:output]\n\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u7bc9\uff06\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u5b9f\u884c\n\u3053\u3053\u3067\u306f\u753b\u50cf\u304c784(28x28)\u30d4\u30af\u30bb\u30eb\u306710\u30af\u30e9\u30b9(0..9)\u5206\u985e\u3067\u3059\u3002\n\u96a0\u308c\u5c64\u306f\uff11\u5c64\u306750\u500b\u306e\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u6301\u3064\u3068\u3057\u3066\u3001[784, 50, 10]\u3068\u3057\u3066\u69cb\u6210\u3057\u307e\u3057\u305f\u3002\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u6210 [784, 50, 10]\nnetwork = RubyBrain::Network.new([training_input.first.size, 50, training_supervisor.first.size])\n# learning rate is 0.7\nnetwork.learning_rate = 0.7\n# initialize network\nnetwork.init_network\n\n\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306e\u5b9f\u884c\nnetwork.learn(training_input, training_supervisor, max_training_count=100, tolerance=0.0004, monitoring_channels=[:best_params_training])\n\n\n\u7d50\u679c\u306e\u78ba\u8a8d\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3057\u305fnetwork\u3092test_dataset\u3092\u4f7f\u3063\u3066\u8a55\u4fa1\u3067\u304d\u307e\u3059\u3002\n\u753b\u50cf\uff11\u679a\u5206\u306e\u30c7\u30fc\u30bf\uff08input\uff09\u3092network\u306b\u5165\u529b\u3057\u305f\u969b\u306e\u51fa\u529b\u304cpredicated_output\u3067\u3059\u3002\n\u3053\u306epredicated_output\u306f\u30b5\u30a4\u30ba10\u306eArray\u3067\u3001\u305d\u306eindex 0~9\u304c\u30e9\u30d9\u30eb0~9\u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u6700\u3082\u5927\u304d\u3044\u8981\u7d20\u3092\u6301\u3064index\u304cnetwork\u306e\u4e88\u60f3\u3057\u305f\u30e9\u30d9\u30eb\uff08\u6570\u5b57\uff09\u3068\u306a\u308a\u307e\u3059\u3002\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001\u624b\u66f8\u304d\u753b\u50cf\u3092\u7c21\u6613\u7684\u306bascii\u3067\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\u30d5\u30eb\u3067\u8d70\u3089\u3059\u306810000\u679a\u5206\u304cstdout\u306b\u51fa\u529b\u3055\u308c\u3001\u975e\u5e38\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u6c17\u3092\u3064\u3051\u3066\u304f\u3060\u3055\u3044\u3002\n\u6700\u5f8c\u306eaccuracy\u304c\u8a8d\u8b58\u7387\u3067\u3059\u3002\ntest_input.each_with_index do |input, i|\n  input.each_with_index do |e, j|\n    print(e > 0.3 ? 'x' : ' ')\n    puts if (j % 28) == 0\n  end\n  puts\n  supervisor_label = test_supervisor[i].index(test_supervisor[i].max)\n  predicated_output = network.get_forward_outputs(input)\n  predicated_label = predicated_output.index(predicated_output.max)\n  puts \"test_supervisor: #{supervisor_label}\"\n  puts \"predicate: #{predicated_label}\"\n  results << (supervisor_label == predicated_label)\n  puts \"------------------------------------------------------------\"\nend\n\nputs \"accuracy: #{results.count(true).to_f/results.size}\"\n\n\u5b9f\u969b\u306b\u3069\u3093\u306a\u753b\u50cf\u3067\u8aa4\u5224\u5b9a\u3092\u3057\u305f\u304b\u307f\u3066\u307f\u308b\u3068\u3001\u306a\u305c\u3053\u308c\u3092\u9593\u9055\u3046\u306e\u304b\u3063\u3066\u306e\u3082\u3044\u304f\u3064\u304b\u898b\u3089\u308c\u307e\u3057\u305f\u304c\u3001\u591a\u304f\u304c\u78ba\u304b\u306b\u9593\u9055\u3048\u308b\u53ef\u80fd\u6027\u3042\u308a\u305d\u3046\u306a\u753b\u50cf\u3067\u3057\u305f\u3002\u4ee5\u4e0b\u3001\u5224\u5b9a\u3092\u9593\u9055\u3063\u305f\u30b1\u30fc\u30b9\u306e\u4e00\u90e8\u3067\u3059\u3002\n\ntest_supervisor[8] : 5\npredicated_class : 2\n\u3000-------------------------------------------------------------------------------------\n\ntest_supervisor[33] : 4\npredicated_class : 6\n\u3000-------------------------------------------------------------------------------------\n\ntest_supervisor[66] : 6\npredicated_class : 2\n\u3000-------------------------------------------------------------------------------------\n\ntest_supervisor[73] : 9\npredicated_class : 7\n\u3000-------------------------------------------------------------------------------------\n\ntest_supervisor[92] : 9\npredicated_class : 4\n\u3000-------------------------------------------------------------------------------------\n\ntest_supervisor[104] : 9\npredicated_class : 5\n\u3000-------------------------------------------------------------------------------------\n\ntest_supervisor[149] : 2\npredicated_class : 9\n\u3000-------------------------------------------------------------------------------------\n\ntest_supervisor[151] : 9\npredicated_class : 5\n\u3000-------------------------------------------------------------------------------------\n\u79c1\u306e\u74b0\u5883\u3067\u306f\u4e0a\u8a18\u306e\u6761\u4ef6\u3067\u3001\u4f55\u56de\u304b\u305f\u3081\u3057\u3066\u307f\u30660.9312(93.12%)\u306e\u8a8d\u8b58\u7387\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u51fa\u6765\u4e0a\u304c\u3063\u305f\u91cd\u307f\u306f \u3053\u3061\u3089\n\n\u6700\u5f8c\u306b\n\u672c\u8a18\u4e8b\u306e\u30bf\u30a4\u30c8\u30eb\u306b\u30c7\u30a3\u30fc\u30d7\u30e9\u30fc\u30cb\u30f3\u30b0\u3068\u3064\u3044\u3066\u3044\u307e\u3059\u304c\u3001ReLU\u3059\u3089\u5b9f\u88c5\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u304b\u306a\u308a\u3064\u308a\u3063\u307d\u3044\u30bf\u30a4\u30c8\u30eb\u306b\u306a\u3063\u3066\u3044\u3066\u3059\u307f\u307e\u305b\u3093m(_ _)m\nMNIST\u306e\u8a8d\u8b58\u7387\u304c\u4e88\u60f3\u5916\u306b\u7c21\u5358\u306b90%\u3092\u8d85\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u3084\u306f\u308a\u3053\u3053\u304b\u3089\u66f4\u306b\u4e0a\u3052\u3066\u3044\u304f\u306e\u304c\u96e3\u3057\u3044\u3093\u3067\u3057\u3087\u3046\u306d\u3002\n\n\u3084\u308a\u305f\u304b\u3063\u305f\u3051\u3069\u3084\u3089\u306a\u304b\u3063\u305f\u3053\u3068\n\n\u30e9\u30f3\u30c0\u30e0\u30ce\u30a4\u30ba\u3092\u306e\u305b\u308b\u3068\u304d\u306b\u3001SciRuby/distribution\u3092\u4f7f\u3063\u3066\u3001\u30ac\u30a6\u30b9\u5206\u5e03\u3067\u306e\u305b\u308b\n=> \u4eca\u56de\u3001\u56f3\u306e\u751f\u6210\u306b\u521d\u3081\u3066nyaplot\u3092\u4f7f\u3063\u3066\u307f\u305f\u3068\u3053\u308d\u975e\u5e38\u306b\u4f7f\u3044\u3084\u3059\u304b\u3063\u305f\u306e\u3067\u3001\u4ed6\u306eSciRuby\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3082\u8208\u5473\u304c\u3067\u3066\u304d\u307e\u3057\u305f\u3002\u898b\u3066\u307f\u305f\u3068\u3053\u308d\u9762\u767d\u3044\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u7d50\u69cb\u3042\u3063\u305f\u306e\u3067\u4eca\u5f8c\u6a5f\u4f1a\u304c\u3042\u308c\u3070\u4f7f\u3063\u3066\u307f\u305f\u3044\u3002\n\n\n\u7591\u554f\n\u3053\u306e\u8a18\u4e8b\u3092\u66f8\u3044\u3066\u3066\u3001\u3044\u304f\u3064\u304b\u4e0d\u660e\u306a\u70b9\u304c\u3042\u3063\u305f\u306e\u3067\u3054\u5b58\u77e5\u306e\u65b9\u304c\u3044\u307e\u3057\u305f\u3089\u6559\u3048\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u52a9\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u306e\u8da3\u65e8\u3068\u306f\u95a2\u4fc2\u306a\u3044\u5185\u5bb9\u3067\u3059\u304c\u3002\u3002\n\niruby notebook\u306e\u5404cell\u306eoutput\u3092\u8868\u793a\u3055\u305b\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u65b9\u6cd5\n=> \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u304cipython\u306e\u5834\u5408\u3001%%capture\u3092\u4f7f\u3048\u308b\u3089\u3057\u3044\u3067\u3059\u304c\u3001iruby\u306e\u5834\u5408\u3069\u3046\u3059\u308b\u306e\u304b\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305anil\u3092\u6700\u5f8c\u306b\u4ed8\u52a0\u3057\u3066\u5bfe\u51e6\u3002\nnyaplot\u306eheatmap\u306egrid\u304c\u9577\u65b9\u5f62\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3092\u6b63\u65b9\u5f62\u306b\u3059\u308b\u65b9\u6cd5\n\n# \u80cc\u666f\n\u73fe\u5728\u3001TensorFlow\u3001Chainer\u4ed6\u591a\u6570\u306eDeepLearning\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u672c\u683c\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u4f7f\u3046\u306b\u306f\u5b9f\u884c\u30b9\u30d4\u30fc\u30c9\u3001\u30af\u30aa\u30ea\u30c6\u30a3\u3001\u62e1\u5f35\u6027\u3001\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3001\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306e\u5145\u5b9f\u7b49\u591a\u304f\u306e\u9762\u3067\u3001\u305d\u308c\u3089\u306e\u4e2d\u304b\u3089\u9078\u629e\u3057\u3066\u4f7f\u7528\u3059\u308b\u306e\u304c\u9244\u677f\u306a\u72b6\u6cc1\u3067\u3059\u3002\u3082\u3061\u308d\u3093\u3001\u79c1\u3082\u30e1\u30a4\u30f3\u3067\u306f\u305d\u308c\u3089\u3092\u4f7f\u308f\u305b\u3066\u3082\u3089\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u3001\u4f8b\u3048\u3070tensorFlow\u3067\u306fcomputatoin graph\u3092\u69cb\u7bc9\u3001operation\u3092\u8ffd\u52a0\u3057\u3066\u305d\u308c\u3092\u5b9f\u884c\u3068\u3044\u3046\u30a4\u30e1\u30fc\u30b8\u3067\uff08\u884c\u5217\u3001\u6570\u5f0f\u3067\u53d6\u308a\u6271\u3046\u30a4\u30e1\u30fc\u30b8\uff09\u3001\u6839\u5e95\u306b\u3042\u308b\u53e4\u5178\u7684\u306a\u30cb\u30e5\u30fc\u30ed\u30f3\u306e\u7d50\u5408\u3068\u3044\u3046\u8003\u3048\u65b9\u304c\u96a0\u3055\u308c\u3066\u3044\u308b\u6c17\u304c\u3057\u307e\u3059\u3002\u3080\u3057\u308d\u3001\u305d\u306e\u3053\u3068\u306f\u5fd8\u308c\u3066\u7a81\u304d\u9032\u3093\u3067\u3057\u307e\u3063\u3066\u3082\u826f\u3044\u6c17\u306f\u3057\u307e\u3059\u304c\u3001\u81ea\u5206\u306e\u7406\u89e3\u3092\u6df1\u3081\u308b\u610f\u5473\u3067\u3082\u30cb\u30e5\u30fc\u30ed\u30f3\u6307\u5411\u3067\u30b9\u30af\u30e9\u30c3\u30c1\u304b\u3089\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u66f8\u3044\u3066\u307f\u307e\u3057\u305f\u3002\n\u4f7f\u7528\u8a00\u8a9e\u306f\u6a5f\u68b0\u5b66\u7fd2\u5206\u91ce\u3067\u306fPython\u306b\u6b8b\u5ff5\u306a\u304c\u3089\u9045\u308c\u3092\u3068\u3063\u3066\u3044\u308bRuby\u3092\u9078\u629e\u3002\nDeepLearning\u306b\u8208\u5473\u304c\u3042\u308b\u3051\u3069\u30ac\u30c3\u30c4\u30ea\u3067\u306f\u306a\u304f\u5c11\u3057\u3055\u308f\u3063\u3066\u307f\u305f\u3044\u65b9\u3001\u516c\u958b\u30e9\u30a4\u30d6\u30e9\u30ea\u304cpython\u7528\u306e\u305f\u3081\u306a\u3093\u3068\u306a\u304f\u624b\u3092\u51fa\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u65b9\u306a\u3069\u306e\u5165\u308a\u53e3\u306b\u306a\u308c\u3070\u3046\u308c\u3057\u3044\u3067\u3059\u3002\n\n## RubyBrain\n\u4eca\u56de\u4f7f\u7528\u3059\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u540d\u524d\u306fRubyBrain\u3067\u3059\u3002\n\u80cc\u666f\u3067\u3082\u66f8\u3044\u305f\u3068\u304a\u308a\u73fe\u5728\u4e3b\u6d41\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u306f\u4f7f\u7528\u8005\u5074\u304b\u3089\u306f\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u7e4b\u304e\u3042\u308f\u305b\u3066\u4eba\u9593\u306e\u8133\u3092\u6a21\u5023\u3057\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u3063\u3066\u4f55\u304b\u3092\u5b66\u7fd2\u3055\u305b\u308b\u3068\u3044\u3046\u53e4\u5178\u7684\u306a\u30a4\u30e1\u30fc\u30b8\u306f\u96a0\u3055\u308c\u3001\u6570\u5f0f\u3092\u3064\u306a\u304e\u5408\u308f\u305b\u3066\u305d\u306egraph\u3092\u60c5\u5831\u304c\u6d41\u308c\u3066\u72b6\u614b\u66f4\u65b0\u3092\u884c\u3046\u30a4\u30e1\u30fc\u30b8\u3067\u3059\u3002\u305d\u306e\u70b9\u3067\u306f\u3001tensorFlow, Chainer\u5171\u306b\u30cd\u30fc\u30df\u30f3\u30b0\u30bb\u30f3\u30b9\u304c\u3068\u3066\u3082\u3088\u3044\u3068\u611f\u5fc3\u3057\u307e\u3059\uff08\u7279\u306bChainer\uff09\u3002tensorFlow\u306f\u6b21\u5143\u304c\u6d41\u308c\u308b\u30a4\u30e1\u30fc\u30b8\u3001chainer\u306f\u6570\u5f0f\u3092\u3064\u306a\u304e\u5408\u308f\u305b\u3066\u3044\u304f\u30a4\u30e1\u30fc\u30b8\u3067\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u57fa\u672c\u6982\u5ff5\u3092\u3046\u307e\u304f\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\n\u3067\u3001RubyBrain\u3067\u3059\u304c\u3001\u540d\u524d\u304b\u3089\u5c11\u3057\u306f\u60f3\u50cf\u3067\u304d\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u53e4\u5178\u7684\u306a\u30cb\u30e5\u30fc\u30ed\u30f3\u306e\u3064\u306a\u304e\u5408\u308f\u305b\u3092\u30a4\u30e1\u30fc\u30b8\u3057\u3066\u5b9f\u88c5\u3057\u3066\u3042\u308a\u307e\u3059\u3002\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u8868\u3059class Neuron\u3092\u7528\u610f\u3057\u3066\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u5404\u30cb\u30e5\u30fc\u30ed\u30f3\u306fNeuron class\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3067\u8868\u73fe\u3057\u307e\u3059\u3002\u307e\u305f\u3001Ruby\u306e\u7d44\u307f\u8fbc\u307f\uff06\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u307f\u4f7f\u7528\u3057\u3066\u5b9f\u88c5\u3057\u3066\u304a\u308a\u3001\u5165\u529b\u3001\u51fa\u529b\u306b\u4f7f\u7528\u3059\u308b\u30c7\u30fc\u30bf\u69cb\u9020\u3082Ruby\u6a19\u6e96\u306eArray\u3067\u3059\u3002\u30cb\u30e5\u30fc\u30ed\u30f3\u6307\u5411\u3067\u306e\u5b9f\u88c5\u306e\u826f\u3044\u70b9\u306f\u3001\u5404\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u500b\u5225\u306b\u64cd\u4f5c\u3057\u3066\u5b9f\u9a13\u3057\u305f\u3044\u5834\u5408\u306a\u3069\u305d\u308c\u307b\u3069\u96e3\u3057\u304f\u306a\u3044\uff08\u306f\u305a\uff09\u3002\u60aa\u3044\u70b9\u306f\u3001\u3068\u306b\u304b\u304f\u9045\u3044\u3002\n\n# \u4f7f\u7528\u74b0\u5883\u3001\u30e9\u30a4\u30d6\u30e9\u30ea\n\n\u4eca\u56de\u4f5c\u3063\u305fgem\u306f\u3001rubygems.org\u306bruby_brain\u3068\u3057\u3066\u30ea\u30ea\u30fc\u30b9\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306fgithub\u306b\u516c\u958b\u3057\u3066\u3044\u307e\u3059\u3002\n[rubygems.org/gems/ruby_brain](https://rubygems.org/gems/ruby_brain)\n[github.com/elgoog/ruby_brain](https://github.com/elgoog/ruby_brain)\n\nruby_brain\u672c\u4f53\u306fRuby\u306e\u7d44\u8fbc\uff06\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u307f\u3092\u4f7f\u7528\u3057\u3066\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u74b0\u5883\u6e96\u5099\u306b\u95a2\u3057\u3066\u306f\u5927\u304d\u306a\u554f\u984c\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u8a18\u4e8b\u306e\u5185\u5bb9\u306fRuby 2.3.1\u3067\u8a66\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u4ed6\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3082\u554f\u984c\u306a\u304f\u52d5\u304f\u306f\u305a\u3067\u3059\u3002\nirb/pry\u7b49\u3067\u9806\u6b21\u5165\u529b\u3057\u3066\u8a66\u3057\u3066\u307f\u308b\u3068\u3088\u3044\u304b\u3082\u3002\n\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n`gem install ruby_brain`\n\n## iRuby notebook\n\n\u3053\u306e\u8a18\u4e8b\u3067\u306f\uff13\u3064\u306eexample\u3092\u53d6\u308a\u6271\u3044\u307e\u3059\u304c\u3001\u5f8c\u534a\uff12\u3064\u306eexample\u306b\u3064\u3044\u3066\u306f\u3001iRuby notebook\u3067\u3082\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\u4e00\u90e8\u3001\u672c\u8a18\u4e8b\u3068\u9055\u3046\u90e8\u5206\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3061\u3089\u306enotebook\u3082\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n[examples/wave_form - iRuby](http://nbviewer.jupyter.org/github/elgoog/ruby_brain/blob/master/examples/wave_form.ipynb)\n[examples/mnist - iRuby](http://nbviewer.jupyter.org/github/elgoog/ruby_brain/blob/master/examples/mnist.ipynb)\n\u672c\u8a18\u4e8b\u5185\u306e\u56f3\u306fiRuby notebook\u4e0a\u3067nyaplot\u3092\u4f7f\u3063\u3066\u63cf\u3044\u305f\u3082\u306e\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u3044\u307e\u3059\u3002\n\n# Example 1 - AND\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\n\u307e\u305a\u3001\u7c21\u5358\u306a\u4f8b\u3068\u3057\u3066\uff12\u5165\u529b\u3001\uff11\u51fa\u529b\u306eAND\u306e\u52d5\u4f5c\u3092\u884c\u3046AND\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u69cb\u7bc9\u3057\u3066\u307f\u307e\u3059\u3002\nAND\u306e\u771f\u7406\u5024\u8868\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\u5165\u529b\u304c\u4e21\u65b9\u5171\uff11\u306e\u6642\u306b\u51fa\u529b\u304c\uff11\u3001\u305d\u308c\u4ee5\u5916\u306e\u6642\u306f\u51fa\u529b\u304c\uff10\u3068\u306a\u308b\u3053\u3068\u3092\u671f\u5f85\u3057\u3066\u3044\u307e\u3059\u3002\n\n| in 1 | in 2 | out |\n|:----:|:----:|:---:|\n| 0    | 0    | 0   |\n| 0    | 1    | 0   |\n| 1    | 0    | 0   |\n| 1    | 1    | 1   |\n\n## \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u5b66\u7fd2\u306b\u4f7f\u3046\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u6e96\u5099\u3057\u307e\u3059\u3002\n\u5165\u529b\u30c7\u30fc\u30bf\u3001\u51fa\u529b\u30c7\u30fc\u30bf\u3068\u3082\u306b2\u6b21\u5143Array\u306b\u306a\u308a\u307e\u3059\u3002\u5404\u6b21\u5143\u306f\u30c7\u30fc\u30bf\u306e\u30b5\u30f3\u30d7\u30eb\u3001\u30c7\u30fc\u30bf\u306efeature\uff08\u4e0a\u8a18\u8868\u306e\u5404\u30ab\u30e9\u30e0\uff09\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\n\n```ruby\ntraining_input_set = [\n  [0, 0],\n  [0, 1],\n  [1, 0],\n  [1, 1],\n]\n\ntraining_supervisor_set = [\n  [0],\n  [0],\n  [0],\n  [1],\n]\n```\ntraining_input_set\u304c\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3078\u306e\u5165\u529b\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3001\u305d\u308c\u3092\u5165\u529b\u3057\u305f\u969b\u306b\u671f\u5f85\u3059\u308b\u51fa\u529b\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u304ctraining_supervisor_set\u3067\u3059\u3002\n\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u7bc9\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u9020\u306fArray\u3067\u8868\u3057\u307e\u3059\u3002\n\u5165\u529b\uff12\u3001\uff15\u3064\u306e\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u3082\u3064\u96a0\u308c\u5c64\uff11\u3001\u51fa\u529b\uff11\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u9020\u306f\u4e0b\u8a18\u306e\u901a\u308a\u8868\u73fe\u3067\u304d\u307e\u3059\u3002\n\n```ruby\n# 2 inputs\n# 5 units in a hidden layer\n# 1 output\n[2, 5, 1]\n```\n\u96a0\u308c\u5c64\u304c\uff12\u5c64\u4ee5\u4e0a\u306e\u5834\u5408\u3082\u4e0b\u8a18\u306e\u3088\u3046\u306b\u7c21\u5358\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\n\n```ruby\n# 2 inputs\n# 4 units in 1st hidden layer\n# 3 units in 2nd hidden layer\n# 1 output\n[2, 4, 2, 1]\n```\n\n\u6b21\u306b\u3001\u5b9f\u969b\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u3063\u3066\u307f\u307e\u3059\u3002\n\u3053\u3053\u3067\u306f\u3001AND\u306e\u5165\u529b\u304c\uff12\u3064\u3001\u51fa\u529b\u304c\uff11\u3064\u306a\u306e\u3067\u3001`[2, 5, 1]`\u306e\u69cb\u6210\u306b\u3057\u307e\u3059\u3002\n\u96a0\u308c\u5c64\u306f\uff11\u3064\u3067\u30cb\u30e5\u30fc\u30ed\u30f3\uff15\u3064\u3092\u6301\u3064\u3053\u3068\u306b\u3057\u307e\u3057\u305f\u3002\n\n```ruby\nrequire 'ruby_brain'\n\n# Netwwork\u30af\u30e9\u30b9\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u9020Array\u3092\u6e21\u3059\u3053\u3068\u306b\u3088\u308a\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u308b\na_network = RubyBrain::Network.new([2, 5, 1])\n\n# learning_rate\u3092\u30bb\u30c3\u30c8\u3057\u307e\u3059\u3002\uff08\u79c1\u306e\u8a2d\u8a08\u30df\u30b9\u3067\u3053\u3093\u306a\u3068\u3053\u308d\u3067\u5b66\u7fd2\u7387\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u306b\u306a\u3063\u3066\u307e\u3059\u3002\u3002\u6642\u9593\u53d6\u308c\u305f\u3089\u4fee\u6b63\u3059\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\uff09\na_network.learning_rate = 0.5\n\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f7f\u7528\u3059\u308b\u524d\u306b\u521d\u671f\u5316\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u3053\u3067\u5b9f\u969b\u306b\u5185\u90e8\u3067\u91cd\u307f\u7528Array\u3092\u78ba\u4fdd\u3057\u3001\u521d\u671f\u5024\u3092\u8a2d\u5b9a\u3057\u307e\u3059\na_network.init_network\n```\n## \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306flearn\u30e1\u30bd\u30c3\u30c9\u306b\u3001\u5165\u529b\u30c7\u30fc\u30bf\u3001\u671f\u5f85\u3059\u308b\u51fa\u529b\u30c7\u30fc\u30bf\uff08\u6559\u5e2b\u30c7\u30fc\u30bf\uff09\u3092\u4e0e\u3048\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u884c\u3044\u307e\u3059\u3002\n\n```ruby\n# max_training_cout : \u6700\u5927\u3067\u4f55\u56de\u307e\u3067\u5b66\u7fd2\u3092\u884c\u3046\u304b\u3092\u8a2d\u5b9a\n# tolerance : RMS\u30a8\u30e9\u30fc\u306e\u8a31\u5bb9\u5024\u3092\u8a2d\u5b9a\u3002\u30a8\u30e9\u30fc\u304c\u3053\u306e\u5024\u3088\u308a\u5c0f\u3055\u304f\u306a\u308b\u3068\u5b66\u7fd2\u4f1a\u6570\u304cmax_training_count\u306b\u9054\u3057\u3066\u3044\u306a\u304f\u3066\u3082\u5b66\u7fd2\u3092\u7d42\u4e86\u3059\u308b\n# monitoring_channels : \u5b66\u7fd2\u4e2d\u306b\u4f55\u3092\u30ed\u30b0\u3068\u3057\u3066\u51fa\u529b\u3059\u308b\u304b\u3092\u8a2d\u5b9a\u3002\u4eca\u306e\u3068\u3053\u308d\u4e0b\u8a18\u306e\u8a2d\u5b9a\u3092\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\na_network.learn(training_input_set, training_supervisor_set, max_training_count=3000, tolerance=0.0004, monitoring_channels=[:best_params_training])\n```\n\u30e1\u30bd\u30c3\u30c9\u306e\u5b9f\u884c\u304c\u7d42\u4e86\u3057\u305f\u3089\u3001a_network\u304cAND\u52d5\u4f5c\u3092\u884c\u3046\u3088\u3046\u306b\u6700\u9069\u5316\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\n## \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u52d5\u4f5c\u78ba\u8a8d\nget_forward_outputs\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5165\u529b\u3092\u4e0e\u3048\u305f\u5834\u5408\u306e\u51fa\u529b\u3092\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\nAND\u306ein1, in2\u306b\u5404\u5165\u529b\u3092\u4e0e\u3048\u3066\u78ba\u304b\u3081\u3066\u307f\u307e\u3059\u3002\n\n```ruby\na_network.get_forward_outputs([0, 0]) # => [0.00023268152328014436]\na_network.get_forward_outputs([0, 1]) # => [0.01829368167074594]\na_network.get_forward_outputs([1, 0]) # => [0.01900452216228691]\na_network.get_forward_outputs([1, 1]) # => [0.9727050287128143]\n```\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u6b63\u3057\u304fAND\u306e\u52d5\u4f5c\u3092\u884c\u3063\u3066\u3044\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\u3053\u3053\u3067\u306e\u51fa\u529b\u5024\u306f\u3001\u4e0a\u8a18\u3068\u30d4\u30c3\u30bf\u30ea\u540c\u3058\u306b\u306a\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u91cd\u307f\u306e\u521d\u671f\u5024\u304c\u30e9\u30f3\u30c0\u30e0\u306b\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u5b66\u7fd2\u304c\u7d42\u308f\u3063\u305f\u6642\u70b9\u3067\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306e\u91cd\u307f\u304c\u79c1\u306e\u74b0\u5883\u3068\u540c\u3058\u306b\u306a\u308b\u53ef\u80fd\u6027\u306f\u975e\u5e38\u306b\u4f4e\u3044\u305f\u3081\u3067\u3059\u3002\n\u3057\u304b\u3057\u3001[1, 1]\u3092\u5165\u529b\u3057\u305f\u5834\u5408\u306b1\u306b\u8fd1\u3044\u5024\u3001\u305d\u308c\u4ee5\u5916\u306e\u5165\u529b\u306e\u5834\u54080\u306b\u8fd1\u3044\u5024\u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\n\u4ee5\u4e0a\u3067AND\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u7bc9\u5b8c\u4e86\u3067\u3059\u3002\n\n## \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u91cd\u307f\u306e\u4fdd\u5b58\uff06\u5fa9\u5143\n\u4e0a\u8a18\u306e\u4f8b\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u975e\u5e38\u306b\u5358\u7d14\u306a\u3082\u306e\u306a\u306e\u3067\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306b\u3082\u6642\u9593\u304c\u304b\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001\n\u3082\u3063\u3068\u5927\u304d\u306a\u69cb\u9020\uff06\u5927\u304d\u306a\u30c7\u30fc\u30bf\u3067\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3057\u3066\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u3063\u305f\u5834\u5408\u3001\u51fa\u6765\u4e0a\u304c\u3063\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u91cd\u307f\u3092\u518d\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u304c\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u4ee5\u4e0b\u306e\u30e1\u30bd\u30c3\u30c9\u3067\u3001\u4fdd\u5b58\uff06\u5fa9\u5143\u304c\u53ef\u80fd\u3067\u3059\u3002\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306fYAML\u3067\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002\n\n```ruby\n# \u4fdd\u5b58\na_network.dump_weights_to_yaml('/path/to/saved/weights/file.yml')\n\n# \u5fa9\u5143\na_network = RubyBrain::Network.new([2, 5, 1])\na_network.init_network\na_network.load_weights_from_yaml_file('/path/to/saved/weights/file.yml')\n```\n\n# Example 2 - \u6ce2\u5f62\u306e\u8fd1\u4f3c\n\u6b21\u306b\u5c11\u3057\u30c7\u30fc\u30bf\u91cf\u3092\u5897\u3084\u3057\u305f\u4f8b\u3092\u898b\u308b\u305f\u3081\u3001\u9069\u5f53\u306a\u6ce2\u5f62\u3092\u4f5c\u3063\u3066\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u3068\u3057\u3066\u4f7f\u7528\u3057\u3066\u307f\u307e\u3059\u3002\niRuby notebook\u7248\u306f\u3053\u3061\u3089\uff1d\uff1e\u3000[examples/wave_form - iRuby](http://nbviewer.jupyter.org/github/elgoog/ruby_brain/blob/master/examples/wave_form.ipynb)\n\n\u3053\u3053\u3067\u3001\u3057\u308c\u3063\u3068\u66f8\u304d\u307e\u3059\u304c\u3001\u3001\n\u73fe\u5728activation\u95a2\u6570\u3068\u3057\u3066sigmoid\u95a2\u6570\u3092\u6301\u3064\u30cb\u30e5\u30fc\u30ed\u30f3\u3057\u304b\u7528\u610f\u3057\u3066\u307e\u305b\u3093\u3002\u3002\uff08\u5b8c\u5168\u306a\u624b\u629c\u304d\u3067\u3059\u3002\u3002\uff09\n\u306a\u306e\u3067\u6700\u7d42\u5c64\u3082sigmoid\u306e\u51fa\u529b0~1\u3057\u304b\u51fa\u529b\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u5b66\u7fd2\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u30820~1\u306e\u9593\u3067\u8868\u73fe\u3059\u308b\u3088\u3046\u306b\u6ce8\u610f\u3057\u307e\u3059\u3002(\u5165\u529b\u5074\u306f0~1\u306e\u7bc4\u56f2\u5916\u3067\u3082\u5927\u4e08\u592b\u3067\u3059\u3002)\n\nX\u306e\u5024\u30920~1\u306e\u7bc4\u56f2\u30010.01\u30b9\u30c6\u30c3\u30d7\u3067\u7528\u610f\u3057\u307e\u3059\u3002\n\n```ruby\nX = (0..1).step(0.01).to_a\n```\n$(0.75 * sin(x*2*\\pi) + 0.15 * cos(5*\\pi \u2013 0.023) + 1) / 2$\u3092Y_IDEAL\u3068\u3057\u3066\u3001\n\u305d\u308c\u306b\u30e9\u30f3\u30c0\u30e0\u3067\u30ce\u30a4\u30ba(-0.05..0.005)\u3092\u306e\u305b\u305f\u3082\u306e\u3092Y\u3068\u3057\u307e\u3059\u3002\n\n```ruby\nY_IDEAL = X.map {|x| (0.75 * Math.sin(x*2*Math::PI) - 0.2 * Math.cos(5*x*2*Math::PI - 0.023) + 1) / 2} \nY = [Y_IDEAL, Array.new(X.size) {rand(-0.05..0.05)}].transpose.map {|e| e.inject(:+)}\n```\n\u79c1\u306e\u74b0\u5883\u3067\u751f\u6210\u3057\u305fX, Y, Y_IDEAL\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u307f\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n![example2_1.png](https://qiita-image-store.s3.amazonaws.com/0/40955/93682713-95b2-b03e-33dc-efdeca0c4bf8.png)\n\n\u3053\u306eX\u3092input\u3001Y\u3092output\u3068\u3057\u3066\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u5b66\u7fd2\u3055\u305b\u307e\u3059\u3002\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306f\u69cb\u6210\u306f`[1, 13, 6, 1]`\u306b\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n```ruby\na_network = RubyBrain::Network.new([1, 13, 6, 1])\na_network.init_network\na_network.learning_rate = 0.5\na_network.learn(X.map{|e| [e]}, Y.map{|e| [e]}, max_tra2ining_count=40000, tolerance=0.0004, monitoring_channels=[:best_params_training])\n```\n\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3057\u305f`a_networ`\u306f\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002Y_PREDICATED\u304c`a_network`\u306bX\u3092\u5165\u308c\u305f\u6642\u306eoutput\u306b\u306a\u308a\u307e\u3059\u3002\n\n```rb\nY_PREDICATED = X.map{|e| [e]}.map {|a| a_network.get_forward_outputs(a).first}\n```\n\u79c1\u306e\u74b0\u5883\u3067\u306e\u7d50\u679c\u3092\u30d7\u30ed\u30c3\u30c8\u3059\u308b\u3068\u4e0b\u56f3\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u826f\u3044\u611f\u3058\u3067\u6a21\u5023\u3057\u3066\u3044\u307e\u3059\u3002\n![fig(1).png](https://qiita-image-store.s3.amazonaws.com/0/40955/e14500f4-d0cb-0db9-f93f-be0d45920a30.png)\n\n# Example 3 - MNIST\nExample\u306e\u6700\u5f8c\u3068\u3057\u3066MNIST\u3092\u8a66\u3057\u3066\u307f\u307e\u3059\u300228*28\u30d4\u30af\u30bb\u30eb\u306e\u624b\u66f8\u304d\u6570\u5b57\u753b\u50cf\u30920~9\u306b\u30af\u30e9\u30b9\u5206\u3051\u3059\u308b\u6a5f\u68b0\u5b66\u7fd2\u306eHelloWorld\u7684\u306a\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u3059\u3002\niRuby notebook\u7248\u306f\u3053\u3061\u3089\u3000\uff1d\uff1e\u3000[examples/mnist - iRuby](http://nbviewer.jupyter.org/github/elgoog/ruby_brain/blob/master/examples/mnist.ipynb)\n\n## MNIST\u30c7\u30fc\u30bf\u306e\u53d6\u5f97\n\u4ed8\u5c5e\u306e\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\u3059\u308b\u3068MNIST\u306e\u30c7\u30fc\u30bf\u3092\u7c21\u5358\u306bRuby\u306eArray\u306b\u5165\u308c\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u30c7\u30fc\u30bf\u306f [THE MNIST DATABASE of handwritten digits](http://yann.lecun.com/exdb/mnist/) \u3088\u308a\u3001\u53d6\u5f97\u3057\u3066\u3044\u307e\u3059\u3002\n\u307e\u305f\u3001\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u306b\u306fmrkn\u3055\u3093\u306egem [mnist](https://rubygems.org/gems/mnist)\u3092\u4f7f\u7528\u3055\u305b\u3066\u3044\u305f\u3060\u304d\u307e\u3057\u305f\u3002\n\n```ruby\nrequire 'ruby_brain'\n\n# MNIST\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u53d6\u308a\u6271\u3046\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9\u3092\u30ed\u30fc\u30c9\nrequire 'ruby_brain/dataset/mnist/data'\n```\n\u4e0b\u8a18\u306e\u3088\u3046\u306b\u3001`DataSet::Mnist::data`\u30e1\u30bd\u30c3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068MNIST\u306e\u30c7\u30fc\u30bf\u3092Array\u3068\u3057\u3066\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\ndataset\u306fArray\u3067\u3001training\u7528\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3068test\u7528\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\n\n```ruby\ndataset = RubyBrain::DataSet::Mnist::data\ntraining_dataset = dataset.first\ntest_dataset = dataset.last\n```\n\n\u5404\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\n\n```rb\n# :input, :output\u3092key\u3068\u3059\u308bHash\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\ntraining_dataset.keys # => [:input, :output]\ntest_dataset.keys     # => [:input, :output]\n\n# \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e :input \u306f 60000(samples) x 784(28 * 28 input pixcels)\ntraining_dataset[:input].size       # => 60000\ntraining_dataset[:input].first.size # => 784\n\n# \u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e :output \u306f 60000(samples) x 10(0~9\u306e10\u30af\u30e9\u30b9)\ntraining_dataset[:output].size       # => 60000\ntraining_dataset[:output].first.size # => 10\n\n# \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e:input \u306f 10000(samples) x 784(28 * 28 input pixcels)\ntest_dataset[:input].size       # => 10000\ntest_dataset[:input].first.size # => 784\n\n# \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306e :output \u306f 10000(samples) x 10(0~9\u306e10\u30af\u30e9\u30b9)\ntest_dataset[:output].size       # => 10000\ntest_dataset[:output].first.size # => 10\n```\n\u3053\u306e\u4f8b\u3067\u306ftraining_dataset\u306e\u6700\u521d\u306e5000\u30b5\u30f3\u30d7\u30eb\u306e\u307f\u5b9f\u969b\u306e\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002RubyBrain\u304c\u9045\u304f\u3001\u516870000\u679a\u306e\u753b\u50cf\u3092\u4f7f\u7528\u3059\u308b\u3068\u5b66\u7fd2\u306b\u6642\u9593\u304c\u304b\u304b\u308a\u3059\u304e\u308b\u305f\u3081\u3067\u3059\u3002\n\n```rb\n# \u6700\u521d\u306e5000\u679a\u306e\u307f\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306b\u4f7f\u7528\nNUM_TRAIN_DATA = 5000\ntraining_input = training_dataset[:input][0..(NUM_TRAIN_DATA-1)]\ntraining_supervisor = training_dataset[:output][0..(NUM_TRAIN_DATA-1)]\n# test_dataset\u306f\u3059\u3079\u3066\u4f7f\u7528\ntest_input = test_dataset[:input]\ntest_supervisor = test_dataset[:output]\n```\n## \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u69cb\u7bc9\uff06\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u5b9f\u884c\n\u3053\u3053\u3067\u306f\u753b\u50cf\u304c784(28x28)\u30d4\u30af\u30bb\u30eb\u306710\u30af\u30e9\u30b9(0..9)\u5206\u985e\u3067\u3059\u3002\n\u96a0\u308c\u5c64\u306f\uff11\u5c64\u306750\u500b\u306e\u30cb\u30e5\u30fc\u30ed\u30f3\u3092\u6301\u3064\u3068\u3057\u3066\u3001`[784, 50, 10]`\u3068\u3057\u3066\u69cb\u6210\u3057\u307e\u3057\u305f\u3002\n\n```rb\n# \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u69cb\u6210 [784, 50, 10]\nnetwork = RubyBrain::Network.new([training_input.first.size, 50, training_supervisor.first.size])\n# learning rate is 0.7\nnetwork.learning_rate = 0.7\n# initialize network\nnetwork.init_network\n```\n\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u306e\u5b9f\u884c\n\n```rb\nnetwork.learn(training_input, training_supervisor, max_training_count=100, tolerance=0.0004, monitoring_channels=[:best_params_training])\n```\n\n## \u7d50\u679c\u306e\u78ba\u8a8d\n\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u3001\u30c8\u30ec\u30fc\u30cb\u30f3\u30b0\u3057\u305fnetwork\u3092test_dataset\u3092\u4f7f\u3063\u3066\u8a55\u4fa1\u3067\u304d\u307e\u3059\u3002\n\u753b\u50cf\uff11\u679a\u5206\u306e\u30c7\u30fc\u30bf\uff08input\uff09\u3092network\u306b\u5165\u529b\u3057\u305f\u969b\u306e\u51fa\u529b\u304cpredicated_output\u3067\u3059\u3002\n\u3053\u306epredicated_output\u306f\u30b5\u30a4\u30ba10\u306eArray\u3067\u3001\u305d\u306eindex 0~9\u304c\u30e9\u30d9\u30eb0~9\u306b\u5bfe\u5fdc\u3057\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u6700\u3082\u5927\u304d\u3044\u8981\u7d20\u3092\u6301\u3064index\u304cnetwork\u306e\u4e88\u60f3\u3057\u305f\u30e9\u30d9\u30eb\uff08\u6570\u5b57\uff09\u3068\u306a\u308a\u307e\u3059\u3002\n\u4e0b\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001\u624b\u66f8\u304d\u753b\u50cf\u3092\u7c21\u6613\u7684\u306bascii\u3067\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\u30d5\u30eb\u3067\u8d70\u3089\u3059\u306810000\u679a\u5206\u304cstdout\u306b\u51fa\u529b\u3055\u308c\u3001\u975e\u5e38\u306b\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u6c17\u3092\u3064\u3051\u3066\u304f\u3060\u3055\u3044\u3002\n\u6700\u5f8c\u306eaccuracy\u304c\u8a8d\u8b58\u7387\u3067\u3059\u3002\n\n```rb\ntest_input.each_with_index do |input, i|\n  input.each_with_index do |e, j|\n    print(e > 0.3 ? 'x' : ' ')\n    puts if (j % 28) == 0\n  end\n  puts\n  supervisor_label = test_supervisor[i].index(test_supervisor[i].max)\n  predicated_output = network.get_forward_outputs(input)\n  predicated_label = predicated_output.index(predicated_output.max)\n  puts \"test_supervisor: #{supervisor_label}\"\n  puts \"predicate: #{predicated_label}\"\n  results << (supervisor_label == predicated_label)\n  puts \"------------------------------------------------------------\"\nend\n\nputs \"accuracy: #{results.count(true).to_f/results.size}\"\n```\n\u5b9f\u969b\u306b\u3069\u3093\u306a\u753b\u50cf\u3067\u8aa4\u5224\u5b9a\u3092\u3057\u305f\u304b\u307f\u3066\u307f\u308b\u3068\u3001\u306a\u305c\u3053\u308c\u3092\u9593\u9055\u3046\u306e\u304b\u3063\u3066\u306e\u3082\u3044\u304f\u3064\u304b\u898b\u3089\u308c\u307e\u3057\u305f\u304c\u3001\u591a\u304f\u304c\u78ba\u304b\u306b\u9593\u9055\u3048\u308b\u53ef\u80fd\u6027\u3042\u308a\u305d\u3046\u306a\u753b\u50cf\u3067\u3057\u305f\u3002\u4ee5\u4e0b\u3001\u5224\u5b9a\u3092\u9593\u9055\u3063\u305f\u30b1\u30fc\u30b9\u306e\u4e00\u90e8\u3067\u3059\u3002\n\n![mnist_1_5_2.png](https://qiita-image-store.s3.amazonaws.com/0/40955/504cc547-7f43-aef3-661d-4c4b55f7262e.png)\ntest_supervisor[8] : 5\npredicated_class : 2\n\u3000-------------------------------------------------------------------------------------\n\n![mnist_2_4_6.png](https://qiita-image-store.s3.amazonaws.com/0/40955/ff89c2bb-9290-e69c-1871-8e526cd6c856.png)\ntest_supervisor[33] : 4\npredicated_class : 6\n\u3000-------------------------------------------------------------------------------------\n\n![mnist_3_6_2.png](https://qiita-image-store.s3.amazonaws.com/0/40955/73f9742a-4596-1724-cfdd-0a07537560d7.png)\ntest_supervisor[66] : 6\npredicated_class : 2\n\u3000-------------------------------------------------------------------------------------\n\n![mnist_4_9_7.png](https://qiita-image-store.s3.amazonaws.com/0/40955/a5e3a848-c818-c85e-a24d-fb04e01e2fab.png)\ntest_supervisor[73] : 9\npredicated_class : 7\n\u3000-------------------------------------------------------------------------------------\n\n![mnist_5_9_4.png](https://qiita-image-store.s3.amazonaws.com/0/40955/a1c0d197-1c7d-87f2-1e4d-e4f939bf79b7.png)\ntest_supervisor[92] : 9\npredicated_class : 4\n\u3000-------------------------------------------------------------------------------------\n\n![mnist_6_9_5.png](https://qiita-image-store.s3.amazonaws.com/0/40955/add03f61-f58f-8693-93e9-a25c9f012ed8.png)\ntest_supervisor[104] : 9\npredicated_class : 5\n\u3000-------------------------------------------------------------------------------------\n\n![mnist_7_2_9.png](https://qiita-image-store.s3.amazonaws.com/0/40955/5bc1b286-8203-22ff-b30d-b711053fe687.png)\ntest_supervisor[149] : 2\npredicated_class : 9\n\u3000-------------------------------------------------------------------------------------\n\n![mnist_8_9_5.png](https://qiita-image-store.s3.amazonaws.com/0/40955/c9c60812-f7ee-1d47-6592-dd41a9949eef.png)\ntest_supervisor[151] : 9\npredicated_class : 5\n\u3000-------------------------------------------------------------------------------------\n\n\u79c1\u306e\u74b0\u5883\u3067\u306f\u4e0a\u8a18\u306e\u6761\u4ef6\u3067\u3001\u4f55\u56de\u304b\u305f\u3081\u3057\u3066\u307f\u30660.9312(93.12%)\u306e\u8a8d\u8b58\u7387\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\u51fa\u6765\u4e0a\u304c\u3063\u305f\u91cd\u307f\u306f [\u3053\u3061\u3089](https://github.com/elgoog/weights_ruby_brain/blob/master/weights_782_50_10_1.yml)\n\n# \u6700\u5f8c\u306b\n\n\u672c\u8a18\u4e8b\u306e\u30bf\u30a4\u30c8\u30eb\u306b\u30c7\u30a3\u30fc\u30d7\u30e9\u30fc\u30cb\u30f3\u30b0\u3068\u3064\u3044\u3066\u3044\u307e\u3059\u304c\u3001ReLU\u3059\u3089\u5b9f\u88c5\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u304b\u306a\u308a\u3064\u308a\u3063\u307d\u3044\u30bf\u30a4\u30c8\u30eb\u306b\u306a\u3063\u3066\u3044\u3066\u3059\u307f\u307e\u305b\u3093m(_ _)m\nMNIST\u306e\u8a8d\u8b58\u7387\u304c\u4e88\u60f3\u5916\u306b\u7c21\u5358\u306b90%\u3092\u8d85\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u3084\u306f\u308a\u3053\u3053\u304b\u3089\u66f4\u306b\u4e0a\u3052\u3066\u3044\u304f\u306e\u304c\u96e3\u3057\u3044\u3093\u3067\u3057\u3087\u3046\u306d\u3002\n\n### \u3084\u308a\u305f\u304b\u3063\u305f\u3051\u3069\u3084\u3089\u306a\u304b\u3063\u305f\u3053\u3068\n- \u30e9\u30f3\u30c0\u30e0\u30ce\u30a4\u30ba\u3092\u306e\u305b\u308b\u3068\u304d\u306b\u3001[SciRuby/distribution](https://github.com/SciRuby/distribution)\u3092\u4f7f\u3063\u3066\u3001\u30ac\u30a6\u30b9\u5206\u5e03\u3067\u306e\u305b\u308b\n  => \u4eca\u56de\u3001\u56f3\u306e\u751f\u6210\u306b\u521d\u3081\u3066nyaplot\u3092\u4f7f\u3063\u3066\u307f\u305f\u3068\u3053\u308d\u975e\u5e38\u306b\u4f7f\u3044\u3084\u3059\u304b\u3063\u305f\u306e\u3067\u3001\u4ed6\u306eSciRuby\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u3082\u8208\u5473\u304c\u3067\u3066\u304d\u307e\u3057\u305f\u3002\u898b\u3066\u307f\u305f\u3068\u3053\u308d\u9762\u767d\u3044\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c\u7d50\u69cb\u3042\u3063\u305f\u306e\u3067\u4eca\u5f8c\u6a5f\u4f1a\u304c\u3042\u308c\u3070\u4f7f\u3063\u3066\u307f\u305f\u3044\u3002\n\n### \u7591\u554f\n\u3053\u306e\u8a18\u4e8b\u3092\u66f8\u3044\u3066\u3066\u3001\u3044\u304f\u3064\u304b\u4e0d\u660e\u306a\u70b9\u304c\u3042\u3063\u305f\u306e\u3067\u3054\u5b58\u77e5\u306e\u65b9\u304c\u3044\u307e\u3057\u305f\u3089\u6559\u3048\u3066\u3044\u305f\u3060\u3051\u308b\u3068\u52a9\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u8a18\u4e8b\u306e\u8da3\u65e8\u3068\u306f\u95a2\u4fc2\u306a\u3044\u5185\u5bb9\u3067\u3059\u304c\u3002\u3002\n\n- iruby notebook\u306e\u5404cell\u306eoutput\u3092\u8868\u793a\u3055\u305b\u306a\u3044\u3088\u3046\u306b\u3059\u308b\u65b9\u6cd5\n  => \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u304cipython\u306e\u5834\u5408\u3001`%%capture`\u3092\u4f7f\u3048\u308b\u3089\u3057\u3044\u3067\u3059\u304c\u3001iruby\u306e\u5834\u5408\u3069\u3046\u3059\u308b\u306e\u304b\u308f\u304b\u3089\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u3068\u308a\u3042\u3048\u305a`nil`\u3092\u6700\u5f8c\u306b\u4ed8\u52a0\u3057\u3066\u5bfe\u51e6\u3002\n- nyaplot\u306eheatmap\u306egrid\u304c\u9577\u65b9\u5f62\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u3092\u6b63\u65b9\u5f62\u306b\u3059\u308b\u65b9\u6cd5\n\n", "tags": ["DeepLearning", "\u6a5f\u68b0\u5b66\u7fd2", "\u6df1\u5c64\u5b66\u7fd2", "\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af", "Ruby"]}