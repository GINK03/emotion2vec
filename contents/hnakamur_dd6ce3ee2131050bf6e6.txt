{"context": " More than 1 year has passed since last update.\u4e00\u7a2e\u985e\u306e\u30b0\u30e9\u30d5\u3092\u8907\u6570\u30db\u30b9\u30c8\u306e\u5206\u3060\u3051\u4e26\u3079\u308b\u30b9\u30af\u30ea\u30fc\u30f3\u306exml\u3092\u751f\u6210\u3059\u308b\u305f\u3081\u306e\u66f8\u304d\u6368\u3066ruby\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9069\u5b9c\u7de8\u96c6\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002\u751f\u6210\u3057\u305fxml\u3092zabbix\u3067\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308c\u3070\u3055\u304f\u3063\u3068\u30b9\u30af\u30ea\u30fc\u30f3\u304c\u4f5c\u308c\u307e\u3059\u3002\ngenerate_screen_xml.rb > output.xml\n\ngenerate_screen_xml.rb\n#!/usr/bin/env ruby\nrequire 'erb'\nrequire 'date'\n\nscreen_name = 'CPU Utilization'\ngraph_name = 'CPU Utilization'\nhostnames = (1..4).map {|i| \"app%02d\" % i}\ngraph_count = hostnames.size\ncols = 2\nrows = (graph_count - 1) / cols + 1\n\nERB.new(DATA.read, nil, 2).run\n\n__END__\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<zabbix_export>\n    <version>2.0</version>\n    <date><%= DateTime.now.iso8601 %></date>\n    <screens>\n        <screen>\n            <name><%= screen_name %></name>\n            <hsize><%= cols %></hsize>\n            <vsize><%= rows %></vsize>\n            <screen_items>\n<% hostnames.each_with_index do |hostname, i| %>\n                <screen_item>\n                    <resourcetype>0</resourcetype>\n                    <width>500</width>\n                    <height>100</height>\n                    <x><%= i % cols %></x>\n                    <y><%= i / cols %></y>\n                    <colspan>1</colspan>\n                    <rowspan>1</rowspan>\n                    <elements>0</elements>\n                    <valign>0</valign>\n                    <halign>0</halign>\n                    <style>0</style>\n                    <url/>\n                    <dynamic>0</dynamic>\n                    <sort_triggers>0</sort_triggers>\n                    <resource>\n                        <name><%= graph_name %></name>\n                        <host><%= hostname %></host>\n                    </resource>\n                </screen_item>\n<% end %>\n            </screen_items>\n        </screen>\n    </screens>\n</zabbix_export>\n\n\n\u4e00\u7a2e\u985e\u306e\u30b0\u30e9\u30d5\u3092\u8907\u6570\u30db\u30b9\u30c8\u306e\u5206\u3060\u3051\u4e26\u3079\u308b\u30b9\u30af\u30ea\u30fc\u30f3\u306exml\u3092\u751f\u6210\u3059\u308b\u305f\u3081\u306e\u66f8\u304d\u6368\u3066ruby\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u3059\u3002\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9069\u5b9c\u7de8\u96c6\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002\u751f\u6210\u3057\u305fxml\u3092zabbix\u3067\u30a4\u30f3\u30dd\u30fc\u30c8\u3059\u308c\u3070\u3055\u304f\u3063\u3068\u30b9\u30af\u30ea\u30fc\u30f3\u304c\u4f5c\u308c\u307e\u3059\u3002\n\ngenerate_screen_xml.rb > output.xml\n\n```ruby:generate_screen_xml.rb\n#!/usr/bin/env ruby\nrequire 'erb'\nrequire 'date'\n\nscreen_name = 'CPU Utilization'\ngraph_name = 'CPU Utilization'\nhostnames = (1..4).map {|i| \"app%02d\" % i}\ngraph_count = hostnames.size\ncols = 2\nrows = (graph_count - 1) / cols + 1\n\nERB.new(DATA.read, nil, 2).run\n\n__END__\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<zabbix_export>\n    <version>2.0</version>\n    <date><%= DateTime.now.iso8601 %></date>\n    <screens>\n        <screen>\n            <name><%= screen_name %></name>\n            <hsize><%= cols %></hsize>\n            <vsize><%= rows %></vsize>\n            <screen_items>\n<% hostnames.each_with_index do |hostname, i| %>\n                <screen_item>\n                    <resourcetype>0</resourcetype>\n                    <width>500</width>\n                    <height>100</height>\n                    <x><%= i % cols %></x>\n                    <y><%= i / cols %></y>\n                    <colspan>1</colspan>\n                    <rowspan>1</rowspan>\n                    <elements>0</elements>\n                    <valign>0</valign>\n                    <halign>0</halign>\n                    <style>0</style>\n                    <url/>\n                    <dynamic>0</dynamic>\n                    <sort_triggers>0</sort_triggers>\n                    <resource>\n                        <name><%= graph_name %></name>\n                        <host><%= hostname %></host>\n                    </resource>\n                </screen_item>\n<% end %>\n            </screen_items>\n        </screen>\n    </screens>\n</zabbix_export>\n```", "tags": ["zabbix", "Ruby"]}