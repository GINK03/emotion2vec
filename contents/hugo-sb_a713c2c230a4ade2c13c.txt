{"context": " More than 1 year has passed since last update.\n\n\u56f3\u5f62\u3084\u6587\u5b57\u306e\u5370\u5b57\u30b5\u30f3\u30d7\u30eb\n\u5404\u7a2e\u56f3\u5f62\u3084\u6587\u5b57\u306e\u5370\u5b57\u30b5\u30f3\u30d7\u30eb\u3002\nUIElement\u6d3e\u751f\u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u3001FixedPage\u306b\u8ffd\u52a0\u3057\u3066\u3044\u304f\u3060\u3051\u3002\u7279\u306b\u8aac\u660e\u304c\u5fc5\u8981\u306a\u3068\u3053\u308d\u306f\u306a\u3044\u3068\u601d\u3046\u3051\u3069\u3001TextBlock\u306b\u95a2\u3057\u3066\u306f\u914d\u7f6e\u3057\u3084\u3059\u3044\u3088\u3046\u306bContentControl\u3067\u30e9\u30c3\u30d7\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n// Line\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Line CreateLine(double x1, double y1, double x2, double y2, Brush brush, Double thickness)\n{\n    Line line = new Line();\n    line.X1 = x1;\n    line.Y1 = y1;\n    line.X2 = x2;\n    line.Y2 = y2;\n    line.Stroke = brush;\n    line.StrokeThickness = thickness;\n    return line;\n}\n\n// Rectangle\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Rectangle CreateRect(double x, double y, double width, double height, Brush stroke, double thickness, Brush fill)\n{\n    Rectangle rect = new Rectangle();\n    Canvas.SetLeft(rect, x);\n    Canvas.SetTop(rect, y);\n    rect.Width = width;\n    rect.Height = height;\n    rect.Stroke = stroke;\n    rect.StrokeThickness = thickness;\n    rect.Fill = fill;\n    return rect;\n}\n\n// Ellipse\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Ellipse CreateEllipse(double x, double y, double width, double height, Brush stroke, double thickness, Brush fill)\n{\n    Ellipse ellipse = new Ellipse();\n    Canvas.SetLeft(ellipse, x);\n    Canvas.SetTop(ellipse, y);\n    ellipse.Width = width;\n    ellipse.Height = height;\n    ellipse.Stroke = stroke;\n    ellipse.StrokeThickness = thickness;\n    ellipse.Fill = fill;\n    return ellipse;\n\n}\n\n// Polygon\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Polygon CreatePolygon(double x, double y, double width, double height, Brush stroke, double thickness, Brush fill, IEnumerable<Point> points)\n{\n    Polygon polygon = new Polygon();\n    Canvas.SetLeft(polygon, x);\n    Canvas.SetTop(polygon, y);\n    polygon.Width = width;\n    polygon.Height = height;\n    polygon.Stretch = Stretch.None;\n    polygon.Stroke = stroke;\n    polygon.StrokeThickness = thickness;\n    polygon.Fill = fill;\n\n    foreach (var point in points)\n        polygon.Points.Add(point);\n\n    return polygon;\n}\n\n// Image\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Image CreateImage(Uri imageUri, double x, double y, double width, double height, Stretch stretch)\n{\n    Image image = new Image();\n    image.Source = new BitmapImage(imageUri);\n    Canvas.SetLeft(image, x);\n    Canvas.SetTop(image, y);\n    image.Width = width;\n    image.Height = height;\n    image.Stretch = stretch;\n    return image;\n}\n\n// TextBlock\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210(\u914d\u7f6e\u3092\u6307\u5b9a\u3059\u308b\u305f\u3081\u306eContentControl\u3067\u30e9\u30c3\u30d7\u3059\u308b\uff09\nprivate ContentControl CreateText(string text, double fontSize, Brush brush, double x, double y, double widh, double height, HorizontalAlignment hAlign, VerticalAlignment vAlign)\n{\n    ContentControl content = new ContentControl();\n    Canvas.SetLeft(content, x);\n    Canvas.SetTop(content, y);\n    content.Width = widh;\n    content.Height = height;\n\n    TextBlock tb = new TextBlock();\n    tb.Text = text;\n    tb.FontSize = fontSize;\n    tb.Foreground = brush;\n    tb.HorizontalAlignment = hAlign;\n    tb.VerticalAlignment = vAlign;\n    content.Content = tb;\n\n    return content;\n}\n\n// \u30da\u30fc\u30b8\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\nprivate FixedPage CreatePage()\n{\n    FixedPage page = new FixedPage();\n    Canvas canvas = new Canvas();\n\n    // Line\u306e\u63cf\u753b\n    for (int i = 0; i < 10; i++)\n        canvas.Children.Add(CreateLine(100.0d, 100.0d + (i * 10.0d), 200.0d, 100.0d + (i * 10.0d), Brushes.Black, 1.0d + (i * 0.5d)));\n\n    // \u77e9\u5f62\u306e\u63cf\u753b\n    canvas.Children.Add(CreateRect(250.0d, 100.0d, 100.0d, 100.0d, Brushes.Black, 1.0d, Brushes.Blue));\n\n    // \u5186\u306e\u63cf\u753b\n    canvas.Children.Add(CreateEllipse(400.0d, 100.0d, 100.0d, 100.0d, Brushes.Black, 1.0d, Brushes.Green));\n\n    // \u30dd\u30ea\u30b4\u30f3\u306e\u63cf\u753b\n    Point[] points1 = new Point[] {\n        new Point(50.0d, 0.0d),\n        new Point(0.0d, 80.0d),\n        new Point(100.0d, 80.0d)\n    };\n    canvas.Children.Add(CreatePolygon(550.0d, 100.0d, 100.0d, 100.0d, Brushes.Black, 2.0d, Brushes.Red, points1));\n\n    Point[] points2 = new Point[] {\n        new Point(0.0d, 20.0d),\n        new Point(100.0d, 20.0d),\n        new Point(50.0d, 100.0d)\n    };\n    canvas.Children.Add(CreatePolygon(550.0d, 100.0d, 100.0d, 100.0d, Brushes.Black, 2.0d, Brushes.Yellow, points2));\n\n    // \u30a4\u30e1\u30fc\u30b8\u306e\u63cf\u753b\n    Uri image_uri = new Uri(\"file://c:/temp/CAT.JPG\");\n    canvas.Children.Add(CreateImage(image_uri, 100.0d, 250.0d, 100.0d, 100.0d, Stretch.Fill));\n\n    // \u30c6\u30ad\u30b9\u30c8\u306e\u63cf\u753b\n    canvas.Children.Add(CreateRect(99.0d, 399.0d, 502.0d, 102.0d, Brushes.Black, 1.0d, null));\n    canvas.Children.Add(CreateText(\"\u5de6\u5bc4\u305b\u6587\u5b57\u5217\", 24.0d, Brushes.Black, 100.0d, 400.0d, 500.0d, 30.0d, HorizontalAlignment.Left, VerticalAlignment.Center));\n    canvas.Children.Add(CreateText(\"\u4e2d\u592e\u5bc4\u305b\u6587\u5b57\u5217\", 24.0d, Brushes.Black, 100.0d, 430.0d, 500.0d, 30.0d, HorizontalAlignment.Center, VerticalAlignment.Center));\n    canvas.Children.Add(CreateText(\"\u53f3\u5bc4\u305b\u6587\u5b57\u5217\", 24.0d, Brushes.Black, 100.0d, 460.0d, 500.0d, 30.0d, HorizontalAlignment.Right, VerticalAlignment.Center));\n\n    page.Children.Add(canvas);\n    return page;\n}\n\n// \u5370\u5237\u51e6\u7406\nprivate void PrintPage()\n{\n    LocalPrintServer lps = new LocalPrintServer();\n    PrintQueue queue = lps.DefaultPrintQueue;\n    XpsDocumentWriter writer = PrintQueue.CreateXpsDocumentWriter(queue);\n    PrintTicket ticket = queue.DefaultPrintTicket;\n\n    PrintCapabilities pcap = queue.GetPrintCapabilities();\n\n    // \u7528\u7d19\u30b5\u30a4\u30ba\u306e\u8a2d\u5b9a\n    ticket.PageMediaSize = new PageMediaSize(PageMediaSizeName.ISOA4);\n    ticket.PageOrientation = PageOrientation.Portrait;\n\n    // \u5370\u5237\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\n    FixedPage page = CreatePage();\n\n    // \u5370\u5237\u306e\u5b9f\u884c\n    writer.Write(page, ticket);\n\n}\n\n\n\u51fa\u529b\u30b5\u30f3\u30d7\u30eb\n\n## \u56f3\u5f62\u3084\u6587\u5b57\u306e\u5370\u5b57\u30b5\u30f3\u30d7\u30eb\n\n\u5404\u7a2e\u56f3\u5f62\u3084\u6587\u5b57\u306e\u5370\u5b57\u30b5\u30f3\u30d7\u30eb\u3002\n`UIElement`\u6d3e\u751f\u30af\u30e9\u30b9\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u3001`FixedPage`\u306b\u8ffd\u52a0\u3057\u3066\u3044\u304f\u3060\u3051\u3002\u7279\u306b\u8aac\u660e\u304c\u5fc5\u8981\u306a\u3068\u3053\u308d\u306f\u306a\u3044\u3068\u601d\u3046\u3051\u3069\u3001`TextBlock`\u306b\u95a2\u3057\u3066\u306f\u914d\u7f6e\u3057\u3084\u3059\u3044\u3088\u3046\u306b`ContentControl`\u3067\u30e9\u30c3\u30d7\u3059\u308b\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\n```csharp\n// Line\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Line CreateLine(double x1, double y1, double x2, double y2, Brush brush, Double thickness)\n{\n    Line line = new Line();\n    line.X1 = x1;\n    line.Y1 = y1;\n    line.X2 = x2;\n    line.Y2 = y2;\n    line.Stroke = brush;\n    line.StrokeThickness = thickness;\n    return line;\n}\n\n// Rectangle\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Rectangle CreateRect(double x, double y, double width, double height, Brush stroke, double thickness, Brush fill)\n{\n    Rectangle rect = new Rectangle();\n    Canvas.SetLeft(rect, x);\n    Canvas.SetTop(rect, y);\n    rect.Width = width;\n    rect.Height = height;\n    rect.Stroke = stroke;\n    rect.StrokeThickness = thickness;\n    rect.Fill = fill;\n    return rect;\n}\n\n// Ellipse\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Ellipse CreateEllipse(double x, double y, double width, double height, Brush stroke, double thickness, Brush fill)\n{\n    Ellipse ellipse = new Ellipse();\n    Canvas.SetLeft(ellipse, x);\n    Canvas.SetTop(ellipse, y);\n    ellipse.Width = width;\n    ellipse.Height = height;\n    ellipse.Stroke = stroke;\n    ellipse.StrokeThickness = thickness;\n    ellipse.Fill = fill;\n    return ellipse;\n\n}\n\n// Polygon\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Polygon CreatePolygon(double x, double y, double width, double height, Brush stroke, double thickness, Brush fill, IEnumerable<Point> points)\n{\n    Polygon polygon = new Polygon();\n    Canvas.SetLeft(polygon, x);\n    Canvas.SetTop(polygon, y);\n    polygon.Width = width;\n    polygon.Height = height;\n    polygon.Stretch = Stretch.None;\n    polygon.Stroke = stroke;\n    polygon.StrokeThickness = thickness;\n    polygon.Fill = fill;\n\n    foreach (var point in points)\n        polygon.Points.Add(point);\n\n    return polygon;\n}\n\n// Image\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210\nprivate Image CreateImage(Uri imageUri, double x, double y, double width, double height, Stretch stretch)\n{\n    Image image = new Image();\n    image.Source = new BitmapImage(imageUri);\n    Canvas.SetLeft(image, x);\n    Canvas.SetTop(image, y);\n    image.Width = width;\n    image.Height = height;\n    image.Stretch = stretch;\n    return image;\n}\n\n// TextBlock\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u751f\u6210(\u914d\u7f6e\u3092\u6307\u5b9a\u3059\u308b\u305f\u3081\u306eContentControl\u3067\u30e9\u30c3\u30d7\u3059\u308b\uff09\nprivate ContentControl CreateText(string text, double fontSize, Brush brush, double x, double y, double widh, double height, HorizontalAlignment hAlign, VerticalAlignment vAlign)\n{\n    ContentControl content = new ContentControl();\n    Canvas.SetLeft(content, x);\n    Canvas.SetTop(content, y);\n    content.Width = widh;\n    content.Height = height;\n\n    TextBlock tb = new TextBlock();\n    tb.Text = text;\n    tb.FontSize = fontSize;\n    tb.Foreground = brush;\n    tb.HorizontalAlignment = hAlign;\n    tb.VerticalAlignment = vAlign;\n    content.Content = tb;\n\n    return content;\n}\n\n// \u30da\u30fc\u30b8\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\nprivate FixedPage CreatePage()\n{\n    FixedPage page = new FixedPage();\n    Canvas canvas = new Canvas();\n\n    // Line\u306e\u63cf\u753b\n    for (int i = 0; i < 10; i++)\n        canvas.Children.Add(CreateLine(100.0d, 100.0d + (i * 10.0d), 200.0d, 100.0d + (i * 10.0d), Brushes.Black, 1.0d + (i * 0.5d)));\n\n    // \u77e9\u5f62\u306e\u63cf\u753b\n    canvas.Children.Add(CreateRect(250.0d, 100.0d, 100.0d, 100.0d, Brushes.Black, 1.0d, Brushes.Blue));\n\n    // \u5186\u306e\u63cf\u753b\n    canvas.Children.Add(CreateEllipse(400.0d, 100.0d, 100.0d, 100.0d, Brushes.Black, 1.0d, Brushes.Green));\n\n    // \u30dd\u30ea\u30b4\u30f3\u306e\u63cf\u753b\n    Point[] points1 = new Point[] {\n        new Point(50.0d, 0.0d),\n        new Point(0.0d, 80.0d),\n        new Point(100.0d, 80.0d)\n    };\n    canvas.Children.Add(CreatePolygon(550.0d, 100.0d, 100.0d, 100.0d, Brushes.Black, 2.0d, Brushes.Red, points1));\n\n    Point[] points2 = new Point[] {\n        new Point(0.0d, 20.0d),\n        new Point(100.0d, 20.0d),\n        new Point(50.0d, 100.0d)\n    };\n    canvas.Children.Add(CreatePolygon(550.0d, 100.0d, 100.0d, 100.0d, Brushes.Black, 2.0d, Brushes.Yellow, points2));\n\n    // \u30a4\u30e1\u30fc\u30b8\u306e\u63cf\u753b\n    Uri image_uri = new Uri(\"file://c:/temp/CAT.JPG\");\n    canvas.Children.Add(CreateImage(image_uri, 100.0d, 250.0d, 100.0d, 100.0d, Stretch.Fill));\n\n    // \u30c6\u30ad\u30b9\u30c8\u306e\u63cf\u753b\n    canvas.Children.Add(CreateRect(99.0d, 399.0d, 502.0d, 102.0d, Brushes.Black, 1.0d, null));\n    canvas.Children.Add(CreateText(\"\u5de6\u5bc4\u305b\u6587\u5b57\u5217\", 24.0d, Brushes.Black, 100.0d, 400.0d, 500.0d, 30.0d, HorizontalAlignment.Left, VerticalAlignment.Center));\n    canvas.Children.Add(CreateText(\"\u4e2d\u592e\u5bc4\u305b\u6587\u5b57\u5217\", 24.0d, Brushes.Black, 100.0d, 430.0d, 500.0d, 30.0d, HorizontalAlignment.Center, VerticalAlignment.Center));\n    canvas.Children.Add(CreateText(\"\u53f3\u5bc4\u305b\u6587\u5b57\u5217\", 24.0d, Brushes.Black, 100.0d, 460.0d, 500.0d, 30.0d, HorizontalAlignment.Right, VerticalAlignment.Center));\n\n    page.Children.Add(canvas);\n    return page;\n}\n\n// \u5370\u5237\u51e6\u7406\nprivate void PrintPage()\n{\n    LocalPrintServer lps = new LocalPrintServer();\n    PrintQueue queue = lps.DefaultPrintQueue;\n    XpsDocumentWriter writer = PrintQueue.CreateXpsDocumentWriter(queue);\n    PrintTicket ticket = queue.DefaultPrintTicket;\n\n    PrintCapabilities pcap = queue.GetPrintCapabilities();\n\n    // \u7528\u7d19\u30b5\u30a4\u30ba\u306e\u8a2d\u5b9a\n    ticket.PageMediaSize = new PageMediaSize(PageMediaSizeName.ISOA4);\n    ticket.PageOrientation = PageOrientation.Portrait;\n\n    // \u5370\u5237\u30c7\u30fc\u30bf\u306e\u4f5c\u6210\n    FixedPage page = CreatePage();\n\n    // \u5370\u5237\u306e\u5b9f\u884c\n    writer.Write(page, ticket);\n\n}\n```\n\n## \u51fa\u529b\u30b5\u30f3\u30d7\u30eb\n![print_image.png](https://qiita-image-store.s3.amazonaws.com/0/31482/b5cde098-50fe-f6fc-798d-20088a2487cb.png)\n\n", "tags": ["C#", "WPF", "\u57fa\u790e"]}