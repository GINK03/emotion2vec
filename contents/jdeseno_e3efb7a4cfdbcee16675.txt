{"context": " More than 1 year has passed since last update.\nautostereogram.js\n(function(ns) {\n  var cell_size = 120;\n\n  ns.start = function() {\n    var oversized = create_canvas(window.innerWidth+cell_size, window.innerHeight);\n    oversized.getContext('2d').drawImage(create_bg(oversized), 0, 0);\n\n    var txt_canvas = create_canvas(900, 200);\n    var txt_ctx = txt_canvas.getContext('2d');\n\n    txt_ctx.beginPath();\n      txt_ctx.fillStyle = 'black';\n      txt_ctx.fillRect(0, 0, txt_canvas.width, txt_canvas.height);\n    txt_ctx.closePath();\n\n    txt_ctx.beginPath();\n      txt_ctx.fillStyle = 'white';\n      txt_ctx.strokeStyle = 'white';\n      txt_ctx.font = \"200px sans-serif\";\n      txt_ctx.fillText(\"EGADS!\", 0, 160)\n      txt_ctx.stroke();\n      txt_ctx.fill();\n    txt_ctx.closePath();\n\n    draw_shifted_cv(txt_canvas, oversized);\n    display_clipped(oversized);\n  };\n\n  var display_clipped = function(oversized_cv) {\n    var canvas = create_canvas(window.innerWidth, window.innerHeight);\n    canvas.getContext('2d').drawImage(oversized_cv, 0, 0);\n    document.body.appendChild(canvas);\n  };\n\n  var create_canvas = function(w, h) {\n    var c = document.createElement('canvas');\n    c.width = w;\n    c.height = h;\n    return c;\n  };\n\n  var create_bg = function(canvas) {\n    var noise = function(canvas) {\n      var ctx = canvas.getContext('2d');\n      var imgdat = ctx.getImageData(0, 0, canvas.width, canvas.height);\n      var dat = imgdat.data;\n\n      var rnd, clr;\n      for (var i=0; i<dat.length; i+=4) {\n        if (Math.random() > 0.85) {\n          rnd = Math.random() + Math.random() - 1;\n          dat[i-4]   = dat[imgdat.width+i]   = dat[i]   = ~~(170 * rnd) + (Math.random() > 0.5 ? 85 : 0);\n          dat[i+1-4] = dat[imgdat.width+i+1] = dat[i+1] = ~~(170 * rnd) + (Math.random() > 0.5 ? 85 : 0);\n          dat[i+2-4] = dat[imgdat.width+i+2] = dat[i+2] = ~~(170 * rnd) + (Math.random() > 0.5 ? 85 : 0);\n        }\n        dat[i+3] = 255;\n      }\n\n      ctx.putImageData(imgdat, 0, 0);\n    };\n\n    var bg = create_canvas(canvas.width, canvas.height);\n    var bgctx = bg.getContext('2d');\n    var cv = create_canvas(cell_size, cell_size);\n    noise(cv);\n\n    for (var y=0; y<bg.height; y+=cv.height) {\n      for (var x=0; x<bg.width; x+=cv.width) {\n        bgctx.drawImage(cv, x, y);\n      }\n    }\n\n    return bg;\n  };\n\n  var draw_shifted_img = function(img, canvas) {\n    var dm_canvas = create_canvas(img.width, img.height),\n        dm_ctx    = dm_canvas.getContext('2d');\n    dm_ctx.drawImage(img, 0, 0);\n    draw_shifted_cv(dm_canvas, canvas);\n  };\n\n  var draw_shifted_cv = function(dmcv, canvas) {\n    var rect = {\n      x: (canvas.width >> 1) - (dmcv.width >> 1) - cell_size,\n      y: (canvas.height >> 1) - (dmcv.height >> 1),\n      width: dmcv.width,\n      height: dmcv.height\n    };\n\n    var dm_dat, existing, exdat, shifted, shifday;\n    var shift = 4,\n        repeat_x = ~~((canvas.width >> 1) / cell_size) + ~~((dmcv.width >> 1) / cell_size),\n        ctx = canvas.getContext('2d');\n\n    for (var j=0; j<repeat_x; j++) {\n      rect.x += cell_size;\n      rect.width = Math.min(dmcv.width, canvas.width-rect.x);\n      dm_dat = dmcv.getContext('2d').getImageData(0, 0, rect.width, rect.height).data;\n\n      existing = ctx.getImageData(rect.x, rect.y, rect.width, rect.height);\n      exdat    = existing.data,\n      shifted  = ctx.getImageData(rect.x-shift, rect.y, rect.width, rect.height),\n      shifdat  = shifted.data;\n\n      for (var i=0; i<dm_dat.length; i+=4) {\n        if (dm_dat[i]+dm_dat[i+1]+dm_dat[i+2] > 0) {\n          shifdat[i] = exdat[i];\n          shifdat[i+1] = exdat[i+1];\n          shifdat[i+2] = exdat[i+2];\n        }\n      }\n      ctx.putImageData(shifted, rect.x-shift, rect.y);\n    }\n  };\n}(this.autostereogram={}));\n\n\n\nindex.html\n<!DOCTYPE>\n<html>\n  <head>\n    <title>Canvas demo</title>\n    <style>\n      body {\n        margin: 0;\n        padding: 0;\n      }\n    </style>\n  </head>\n  <body>\n    <script type=\"text/javascript\" src=\"autostereogram.js\"></script>\n    <script type=\"text/javascript\">\n      autostereogram.start();\n    </script>\n  </body>\n</html>\n\n\n\n```js:autostereogram.js\n(function(ns) {\n  var cell_size = 120;\n\n  ns.start = function() {\n    var oversized = create_canvas(window.innerWidth+cell_size, window.innerHeight);\n    oversized.getContext('2d').drawImage(create_bg(oversized), 0, 0);\n\n    var txt_canvas = create_canvas(900, 200);\n    var txt_ctx = txt_canvas.getContext('2d');\n\n    txt_ctx.beginPath();\n      txt_ctx.fillStyle = 'black';\n      txt_ctx.fillRect(0, 0, txt_canvas.width, txt_canvas.height);\n    txt_ctx.closePath();\n\n    txt_ctx.beginPath();\n      txt_ctx.fillStyle = 'white';\n      txt_ctx.strokeStyle = 'white';\n      txt_ctx.font = \"200px sans-serif\";\n      txt_ctx.fillText(\"EGADS!\", 0, 160)\n      txt_ctx.stroke();\n      txt_ctx.fill();\n    txt_ctx.closePath();\n\n    draw_shifted_cv(txt_canvas, oversized);\n    display_clipped(oversized);\n  };\n\n  var display_clipped = function(oversized_cv) {\n    var canvas = create_canvas(window.innerWidth, window.innerHeight);\n    canvas.getContext('2d').drawImage(oversized_cv, 0, 0);\n    document.body.appendChild(canvas);\n  };\n\n  var create_canvas = function(w, h) {\n    var c = document.createElement('canvas');\n    c.width = w;\n    c.height = h;\n    return c;\n  };\n\n  var create_bg = function(canvas) {\n    var noise = function(canvas) {\n      var ctx = canvas.getContext('2d');\n      var imgdat = ctx.getImageData(0, 0, canvas.width, canvas.height);\n      var dat = imgdat.data;\n\n      var rnd, clr;\n      for (var i=0; i<dat.length; i+=4) {\n        if (Math.random() > 0.85) {\n          rnd = Math.random() + Math.random() - 1;\n          dat[i-4]   = dat[imgdat.width+i]   = dat[i]   = ~~(170 * rnd) + (Math.random() > 0.5 ? 85 : 0);\n          dat[i+1-4] = dat[imgdat.width+i+1] = dat[i+1] = ~~(170 * rnd) + (Math.random() > 0.5 ? 85 : 0);\n          dat[i+2-4] = dat[imgdat.width+i+2] = dat[i+2] = ~~(170 * rnd) + (Math.random() > 0.5 ? 85 : 0);\n        }\n        dat[i+3] = 255;\n      }\n\n      ctx.putImageData(imgdat, 0, 0);\n    };\n\n    var bg = create_canvas(canvas.width, canvas.height);\n    var bgctx = bg.getContext('2d');\n    var cv = create_canvas(cell_size, cell_size);\n    noise(cv);\n\n    for (var y=0; y<bg.height; y+=cv.height) {\n      for (var x=0; x<bg.width; x+=cv.width) {\n        bgctx.drawImage(cv, x, y);\n      }\n    }\n\n    return bg;\n  };\n\n  var draw_shifted_img = function(img, canvas) {\n    var dm_canvas = create_canvas(img.width, img.height),\n        dm_ctx    = dm_canvas.getContext('2d');\n    dm_ctx.drawImage(img, 0, 0);\n    draw_shifted_cv(dm_canvas, canvas);\n  };\n\n  var draw_shifted_cv = function(dmcv, canvas) {\n    var rect = {\n      x: (canvas.width >> 1) - (dmcv.width >> 1) - cell_size,\n      y: (canvas.height >> 1) - (dmcv.height >> 1),\n      width: dmcv.width,\n      height: dmcv.height\n    };\n\n    var dm_dat, existing, exdat, shifted, shifday;\n    var shift = 4,\n        repeat_x = ~~((canvas.width >> 1) / cell_size) + ~~((dmcv.width >> 1) / cell_size),\n        ctx = canvas.getContext('2d');\n\n    for (var j=0; j<repeat_x; j++) {\n      rect.x += cell_size;\n      rect.width = Math.min(dmcv.width, canvas.width-rect.x);\n      dm_dat = dmcv.getContext('2d').getImageData(0, 0, rect.width, rect.height).data;\n\n      existing = ctx.getImageData(rect.x, rect.y, rect.width, rect.height);\n      exdat    = existing.data,\n      shifted  = ctx.getImageData(rect.x-shift, rect.y, rect.width, rect.height),\n      shifdat  = shifted.data;\n\n      for (var i=0; i<dm_dat.length; i+=4) {\n        if (dm_dat[i]+dm_dat[i+1]+dm_dat[i+2] > 0) {\n          shifdat[i] = exdat[i];\n          shifdat[i+1] = exdat[i+1];\n          shifdat[i+2] = exdat[i+2];\n        }\n      }\n      ctx.putImageData(shifted, rect.x-shift, rect.y);\n    }\n  };\n}(this.autostereogram={}));\n```\n\n```html:index.html\n<!DOCTYPE>\n<html>\n  <head>\n    <title>Canvas demo</title>\n    <style>\n      body {\n        margin: 0;\n        padding: 0;\n      }\n    </style>\n  </head>\n  <body>\n    <script type=\"text/javascript\" src=\"autostereogram.js\"></script>\n    <script type=\"text/javascript\">\n      autostereogram.start();\n    </script>\n  </body>\n</html>\n```", "tags": ["JavaScripthtml5", "canvas3d"]}