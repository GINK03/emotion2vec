{"context": " More than 1 year has passed since last update.\n\nApache Spark\u306b\u3064\u3044\u3066\nhttp://spark.apache.org/\nApache Software Foundation\u3067\u6700\u8fd1\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u306a\u308a5\u6708\u306b\u6700\u901f\u3067\u30d0\u30fc\u30b8\u30e7\u30f31\u304c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u305f\u5206\u6563\u51e6\u7406\u57fa\u76e4\u306e\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u30d7\u30ed\u30c0\u30af\u30c8\u3002\nMapReduce on HDFS\u3068\u3053\u3068\u306a\u308a\u7e70\u308a\u8fd4\u3057\u6f14\u7b97\u51e6\u7406\u306e\u60c5\u5831\u3092\u30b7\u30a7\u30a2\u30fc\u30c9\u30e1\u30e2\u30ea\u3067\u5171\u6709\u3059\u308b\u305f\u3081\u6f14\u7b97\u901f\u5ea6\u304c\u7206\u901f\u3068\u3046\u305f\u308f\u308c\u3066\u3044\u307e\u3059\u3002\n\u30d0\u30c3\u30c1\u3067\u3057\u304b\u51e6\u7406\u3067\u304d\u306a\u304b\u3063\u305f\u90e8\u5206\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u5316\u3001\u30bf\u30a4\u30e0\u30e9\u30b0\u3092\u6e1b\u3089\u3059\u306a\u3069\u4eca\u5f8c\u5927\u304d\u306a\u671f\u5f85\u304c\u3067\u304d\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\n\u53c2\u8003\u4ed6\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\nTwitter Storm\u3068\u304b\nEC2\u3067\u7c21\u5358\u306b\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3067\u304d\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\nhttp://spark.apache.org/docs/latest/ec2-scripts.html\n\u3053\u3061\u3089\u306e\u65e5\u672c\u8a9e\u8a33\u3092\u3055\u3089\u3063\u3068\u3002\u5909\u306a\u3068\u3053\u308d\u304c\u3042\u3063\u305f\u3089\u3054\u6307\u6458\u304f\u3060\u3055\u3044\u3002\nQuick Start\u3084EC2\u3067\u306e\u5c0e\u5165\u30ac\u30a4\u30c9\u3082\u548c\u8a33\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3042\u308f\u305b\u3066\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\nQuick Start\nhttp://qiita.com/mychaelstyle/items/46440cd27ef641892a58\n\nCluster Mode Overview\nhttp://qiita.com/mychaelstyle/items/610b432a1ef1a7e3d2a0\n\n\n\nRunning Spark on EC2 (Spark \u3092EC2\u3067\u8d77\u52d5\u3059\u308b\uff09\n\nThe spark-ec2 script, located in Spark\u2019s ec2 directory, allows you to launch, manage and shut down Spark clusters on Amazon EC2. It automatically sets up Spark, Shark and HDFS on the cluster for you. This guide describes how to use spark-ec2 to launch clusters, how to run jobs on them, and how to shut them down. It assumes you\u2019ve already signed up for an EC2 account on the Amazon Web Services site.\n\nSpark\u306eec2\u30d5\u30a9\u30eb\u30c0\u306b\u914d\u7f6e\u3055\u308c\u3066\u3044\u308bspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f7f\u3048\u3070\u3001Amazon EC2\u4e0a\u306eSpark\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u8d77\u52d5\u30fb\u7ba1\u7406\u30fb\u505c\u6b62\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u81ea\u52d5\u7684\u306bSpark, Shark, HDFS\u3092\u30af\u30e9\u30b9\u30bf\u4e0a\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3002\n\u3053\u306e\u30ac\u30a4\u30c9\u306fspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5229\u7528\u3057\u3066\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u69cb\u7bc9\u3057\u305f\u308a\u3001\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3057\u305f\u308a\u3001\u30af\u30e9\u30b9\u30bf\u3092\u505c\u6b62\u3057\u305f\u308a\u3059\u308b\u305f\u3081\u306e\u65b9\u6cd5\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\nspark-ec2 is designed to manage multiple named clusters. You can launch a new cluster (telling the script its size and giving it a name), shutdown an existing cluster, or log into a cluster. \n\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u8907\u6570\u306e\u540d\u524d\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u7ba1\u7406\u3067\u304d\u308b\u3088\u3046\u306b\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b\u3002\n\u3042\u306a\u305f\u306f\uff08\u30b5\u30a4\u30ba\u3068\u540d\u524d\u3092\u6307\u5b9a\u3057\u3066\uff09\u65b0\u3057\u3044\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u8d77\u52d5\u3057\u305f\u308a\u3001\u540d\u524d\u3092\u6307\u5b9a\u3057\u3066\u8d77\u52d5\u6e08\u307f\u30af\u30e9\u30b9\u30bf\u3092\u505c\u6b62\u3057\u305f\u308a\u3001\u30af\u30e9\u30b9\u30bf\u306b\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\nEach cluster is identified by placing its machines into EC2 security groups whose names are derived from the name of the cluster.\n\n\u305d\u308c\u305e\u308c\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u306f\u914d\u7f6e\u3055\u308c\u305f\u30de\u30b7\u30f3\u3068\u30af\u30e9\u30b9\u30bf\u540d\u304b\u3089\u540d\u4ed8\u3051\u3089\u308c\u308bEC2\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u30b0\u30eb\u30fc\u30d7\u540d\u3067\u5b8c\u5168\u306b\u72ec\u7acb\u3057\u3066\u52d5\u4f5c\u3059\u308b\u3002\n\nFor example, a cluster named test will contain a master node in a security group called test-master, and a number of slave nodes in a security group called test-slaves.\n\n\u4f8b\u3048\u3070\u3042\u308btest\u3068\u540d\u4ed8\u3051\u3089\u308c\u305f\u30af\u30e9\u30b9\u30bf\u304c\u30de\u30b9\u30bf\u30fc\u30ce\u30fc\u30c9\u3092test-master\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306b\u542b\u307e\u308c\u308b\u5834\u5408\u3001\u30b9\u30ec\u30fc\u30d6\u30ce\u30fc\u30c9\u7fa4\u306ftest-slaves\u3068\u306a\u308b\u3002\n\nThe spark-ec2 script will create these security groups for you based on the cluster name you request. You can also use them to identify machines belonging to each cluster in the Amazon EC2 Console.\n\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3053\u308c\u3089\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u3042\u306a\u305f\u304c\u8981\u6c42\u3057\u305f\u30af\u30e9\u30b9\u30bf\u540d\u306b\u57fa\u3065\u3044\u3066\u751f\u6210\u3059\u308b\u3002\u3042\u306a\u305f\u306f\u305d\u308c\u3089\u3092Amazon EC2\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u305d\u308c\u305e\u308c\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u6240\u5c5e\u3055\u305b\u3066\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\nBefore You Start (\u8d77\u52d5\u306e\u524d\u306b\uff09\n\nCreate an Amazon EC2 key pair for yourself. This can be done by logging into your Amazon Web Services account through the AWS console, clicking Key Pairs on the left sidebar, and creating and downloading a key. Make sure that you set the permissions for the private key file to 600 (i.e. only you can read and write it) so that ssh will work.\n\nEC2\u3067\u30ad\u30fc\u30da\u30a2\u3092\u767b\u9332\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002AWS\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u7c21\u5358\u306b\u767b\u9332\u3067\u304d\u307e\u3059\u3002\uff08\u4ee5\u4e0b\u7565\uff09\n\nWhenever you want to use the spark-ec2 script, set the environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY to your Amazon EC2 access key ID and secret access key. These can be obtained from the AWS homepage by clicking Account > Security Credentials > Access Credentials.\n\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5229\u7528\u3057\u305f\u3044\u306a\u3089\u74b0\u5883\u5909\u6570AWS_ACCESS_KEY\u3068AWS_SECRET_ACCESS_KEY\u3092\u30a2\u30af\u30bb\u30b9\u30ad\u30fcID\u3092\u53d6\u5f97\u3057\u3066\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\uff08\u88dc\u8db3\uff09\u3053\u3053\u306b\u66f8\u3044\u3066\u3042\u308b\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u53d6\u5f97\u3088\u308a\u3082IAM\u30ed\u30fc\u30eb\u3092\u4f5c\u3063\u3066\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u4f5c\u3063\u305f\u65b9\u304c\u5b9f\u904b\u7528\u3067\u306f\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\nLaunching a Cluster\uff08\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u8d77\u52d5\u3059\u308b\uff09\n\nGo into the ec2 directory in the release of Spark you downloaded.\n\nSpark\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30fb\u89e3\u51cd\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u5185\u306eec2\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306f\u3044\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\nRun ./spark-ec2 -k  -i  -s  launch , where  is the name of your EC2 key pair (that you gave it when you created it),  is the private key file for your key pair,  is the number of slave nodes to launch (try 1 at first), and  is the name to give to \nyour cluster.\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n./spark-ec2 -k <keypair> -i <key-file> -s <num-slaves> launch <cluster-name>\n\n\u306f\u3042\u306a\u305f\u304cEC2\u3067\u767b\u9332\u3057\u305f\u30ad\u30fc\u30da\u30a2\u540d\u3001\n\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3001\n\u306f\u30b9\u30ec\u30fc\u30d6\u30ce\u30fc\u30c9\u3092\u8d77\u52d5\u3059\u308b\u6570\uff08\u5c11\u306a\u304f\u3068\u30821\u4ee5\u4e0a\uff09\n\u306f\u8d77\u52d5\u3059\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u4e0e\u3048\u308b\u4efb\u610f\u306e\u540d\u524d\u3067\u3059\u3002\n\nAfter everything launches, check that the cluster scheduler is up and sees all the slaves by going to its web UI, which will be printed at the end of the script (typically http://:8080).\n\n\u5168\u3066\u8d77\u52d5\u3057\u305f\u5f8c\u306b\u30af\u30e9\u30b9\u30bf\u30fc\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u304c\u6728\u540c\u58eb\u5168\u3066\u306e\u30b9\u30ec\u30fc\u30d6\u304cweb UI\u304b\u3089\u78ba\u8a8d\u3067\u304d\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002Web UI\u306eURL\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u5b9f\u884c\u306e\u6700\u5f8c\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\uff08\u4e00\u822c\u7684\u306b http://master-hostname>:8080/\uff09\n\nYou can also run ./spark-ec2 --help to see more usage options. The following options are worth pointing out:\n\n./spark-ec2 --help\u3092\u5b9f\u884c\u3059\u308c\u3070\u5229\u7528\u53ef\u80fd\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8868\u793a\u3067\u304d\u308b\u3002\u4e0b\u8a18\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u6709\u7528\u306a\u4e00\u90e8\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u629c\u7c8b\u3067\u3059\u3002\n\n--instance-type= can be used to specify an EC2 instance type to use. For now, the script only supports 64-bit instance types, and the default type is m1.large (which has 2 cores and 7.5 GB RAM). Refer to the Amazon pages about EC2 instance types and EC2 pricing for information about other instance types.\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u73fe\u5728\u306f64bit\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306e\u307f\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30bf\u30a4\u30d7\u306fm2.large\uff08\uff12\u30b3\u30a2\uff1a\uff17\uff0e\uff15GB\u30e1\u30e2\u30ea\uff09\u3067\u3059\u3002\u4ed6\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306b\u3064\u3044\u3066\u306fAmazon EC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u3068\u6599\u91d1\u8868\u306e\u30da\u30fc\u30b8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n--region= specifies an EC2 region in which to launch instances. The default region is us-east-1.\n\nEC2\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u306fus-east-1\uff08\u30d0\u30fc\u30b8\u30cb\u30a2\uff09\u3067\u3059\u3002\n\n--zone= can be used to specify an EC2 availability zone to launch instances in. Sometimes, you will get an error because there is not enough capacity in one zone, and you should try to launch in another.\n\nEC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3059\u308b\u30a2\u30d9\u30a4\u30e9\u30d3\u30ea\u30c6\u30a3\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u308c\u306b\u4e00\u3064\u306e\u30be\u30fc\u30f3\u306b\u5341\u5206\u306a\u30ad\u30e3\u30d1\u30b7\u30c6\u30a3\u304c\u306a\u3044\u305f\u3081\u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3059\u306e\u3067\u3001\u4ed6\u306e\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3057\u3066\u89e3\u6c7a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n--ebs-vol-size=GB will attach an EBS volume with a given amount of space to each node so that you can have a persistent HDFS cluster on your nodes across cluster restarts (see below).\n\n\u5f37\u56fa\u306aHDFS\u30af\u30e9\u30b9\u30bf\u3092\u30ce\u30fc\u30c9\u4e0a\u306b\u518d\u69cb\u7bc9\u3059\u308b\u70ba\u306b\u305d\u308c\u305e\u308c\u306e\u30ce\u30fc\u30c9\u306eEBS\u30dc\u30ea\u30e5\u30fc\u30e0\u3092GB\u5358\u4f4d\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n--spot-price=PRICE will launch the worker nodes as Spot Instances, bidding for the given maximum price (in dollars).\n\n\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u3092\u30b9\u30dd\u30c3\u30c8\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3068\u3057\u3066\u6700\u5927\u6599\u91d1\u3092\u6307\u5b9a\u3057\u30d9\u30c3\u30c9\u3057\u307e\u3059\u3002\u6700\u5927\u6599\u91d1\u306fUS\u30c9\u30eb\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n--spark-version=VERSION will pre-load the cluster with the specified version of Spark. VERSION can be a version number (e.g. \u201c0.7.3\u201d) or a specific git hash. By default, a recent version will be used.\n\n\u660e\u793a\u7684\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u3066spark\u306e\u30d7\u30ec\u30ed\u30fc\u30c9\u3092\u304a\u3053\u306a\u3044\u307e\u3059\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u306f\"0.7.3\"\u306e\u3088\u3046\u306b\u6307\u5b9a\u3059\u308b\u304bgit\u306e\u30cf\u30c3\u30b7\u30e5\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u6700\u65b0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3059\u3002\uff082014/06/09\u73fe\u5728\u306f1.0.0\uff09\n\nIf one of your launches fails due to e.g. not having the right permissions on your private key file, you can run launch with the --resume option to restart the setup process on an existing cluster.\n\n\u3082\u3057\u3082[not having the righe permissions on your private key file,]\u7b49\u8868\u793a\u3055\u308c\u3066\u8d77\u52d5\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u306f\u3001--resume\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u3066\u30ea\u30b9\u30bf\u30fc\u30c8\u3055\u305b\u308b\u3053\u3068\u3067\u5b58\u5728\u3059\u308b\u30af\u30e9\u30b9\u30bf\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u30d7\u30ed\u30bb\u30b9\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\nRunning Applications\u3000\uff08\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u7a3c\u50cd\u3055\u305b\u308b\uff09\n\nGo into the ec2 directory in the release of Spark you downloaded.\n\nSpark\u306eec2\u30d5\u30a9\u30eb\u30c0\u306b\u5165\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\nRun ./spark-ec2 -k  -i  login  to SSH into the cluster, where  and  are as above. (This is just for convenience; you could also use the EC2 console.)\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u6307\u5b9a\u306e\u30af\u30e9\u30b9\u30bf\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n./spark-ec2 -k <keypair> -i <key-file> login <cluster-name>\n\n\u3068\u306f\u524d\u8ff0\u306e\u901a\u308a\u3067\u3059\u3002\uff08\u3053\u308c\u306f\u5229\u4fbf\u6027\u306e\u305f\u3081\u3060\u3051\u306e\u6a5f\u80fd\u3067\u3059\u3002EC2\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\uff09\n\nTo deploy code or data within your cluster, you can log in and use the provided script ~/spark-ec2/copy-dir, which, given a directory path, RSYNCs it to the same location on all the slaves.\n\n\u30b3\u30fc\u30c9\u3084\u30c7\u30fc\u30bf\u3092\u3042\u306a\u305f\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u914d\u7f6e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u7528\u610f\u3055\u308c\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u3001/spark-ec2/copy-dir\u3092\u5229\u7528\u3057\u3066\u6307\u5b9a\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30d1\u30b9\u3001RSYNCs\u3067\u3001\u30b9\u30ec\u30fc\u30d6\u306e\u540c\u3058\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u914d\u5099\u3067\u304d\u307e\u3059\u3002\n\nIf your application needs to access large datasets, the fastest way to do that is to load them from Amazon S3 or an Amazon EBS device into an instance of the Hadoop Distributed File System (HDFS) on your nodes. The spark-ec2 script already sets up a HDFS instance for you. It\u2019s installed in /root/ephemeral-hdfs, and can be accessed using the bin/hadoop script in that directory. Note that the data in this HDFS goes away when you stop and restart a machine.\n\n\u3082\u3057\u3042\u306a\u305f\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u5de8\u5927\u306a\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306a\u3089\u3001\u3082\u3063\u3068\u3082\u65e9\u3044\u65b9\u6cd5\u306fAmazonS3\u304bAmazon EBS\u3067\u30d0\u30a4\u30b9\u304b\u3089\u30ce\u30fc\u30c9\u4e0a\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eHDFS\uff08Hadoop Distributed File System)\u306b\u8aad\u307f\u8fbc\u3080\u3053\u3068\u3067\u3059\u3002\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u306fHDFS\u3092\u81ea\u52d5\u7684\u306b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u69cb\u7bc9\u3057\u3066\u3044\u307e\u3059\u3002\n/root/ephemeral-hdfs\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u304a\u308a\u3001bin/hadoop\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5229\u7528\u3057\u3066\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3059\u3002\n\u30de\u30b7\u30f3\u3092\u30b9\u30c8\u30c3\u30d7\u3057\u305f\u308a\u30ea\u30b9\u30bf\u30fc\u30c8\u3059\u308b\u3068\u3053\u306eHDFS\u30af\u30e9\u30b9\u30bf\u306f\u6d88\u3048\u3066\u3057\u307e\u3046\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nThere is also a persistent HDFS instance in /root/persistent-hdfs that will keep data across cluster restarts. Typically each node has relatively little space of persistent data (about 3 GB), but you can use the --ebs-vol-size option to spark-ec2 to attach a persistent EBS volume to each node for storing the persistent HDFS.\n\n\u6c38\u7d9a\u7684\u306aHDFS\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3082/root/persistent-hdfs\u306b\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u518d\u8d77\u52d5\u3057\u3066\u3082\u3053\u308c\u3089\u306e\u30c7\u30fc\u30bf\u306f\u5b58\u7d9a\u3057\u307e\u3059\u3002\n\u4e00\u822c\u7684\u306b\u305d\u308c\u305e\u308c\u306e\u30ce\u30fc\u30c9\u306f\u95a2\u9023\u3057\u305f\u5c11\u3057\u306e\u6c38\u7d9a\u30c7\u30fc\u30bf\u30b9\u30da\u30fc\u30b9\uff083GB\u7a0b\u5ea6\uff09\u3092\u4fdd\u6301\u3057\u307e\u3059\u3001\u3057\u304b\u3057--ebs-vol-size\u30aa\u30d7\u30b7\u30e7\u30f3\u3092spark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u6c38\u7d9a\u7684EBS\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u305d\u308c\u305e\u308c\u306e\u30ce\u30fc\u30c9\u306bHDFS\u3068\u3057\u3066\u30a2\u30bf\u30c3\u30c1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nFinally, if you get errors while running your application, look at the slave\u2019s logs for that application inside of the scheduler work directory (/root/spark/work). You can also view the status of the cluster using the web UI: http://:8080.\n\n\u6700\u5f8c\u306b\u3001\u3082\u3057\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5b9f\u884c\u6642\u306b\u30a8\u30e9\u30fc\u62c5\u3063\u305f\u5834\u5408\u3001\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u306e\u30ef\u30fc\u30af\u30c7\u30a3\u30ec\u30af\u30c8\u30ea(/root/spark/work\uff09\u306e\u30b9\u30ec\u30fc\u30d6\u30ed\u30b0\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\nWeb UI\uff08http://:8080/)\u3067\u72b6\u614b\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\nConfiguration \uff08\u8a2d\u5b9a\uff09\n\nYou can edit /root/spark/conf/spark-env.sh on each machine to set Spark configuration options, such as JVM options. This file needs to be copied to every machine to reflect the change. The easiest way to do this is to use a script we provide called copy-dir. First edit your spark-env.sh file on the master, then run ~/spark-ec2/copy-dir /root/spark/conf to RSYNC it to all the workers.\n\n\u305d\u308c\u305e\u308c\u306e\u30de\u30b7\u30f3\u4e0a\u306e/root/spark/conf/spark-env.sh\u3092\u7de8\u96c6\u3057\u3066Spark\u306e\u8a2d\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070JVM\u30aa\u30d7\u30b7\u30e7\u30f3\u306a\u3069\u3002\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u5168\u3066\u306e\u30de\u30b7\u30f3\u306b\u5909\u66f4\u3092\u30b3\u30d4\u30fc\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\u3092\u7c21\u5358\u306b\u304a\u3053\u306a\u3046\u306b\u306fcopy-dir\u3092\u4f7f\u3046\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\u6700\u521d\u306b\u30de\u30b9\u30bf\u30fc\u4e0a\u3067spark-env.sh\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001~/spark-ec2/copy-dir /root/spark/conf\u3092RSYNC\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30ef\u30fc\u30ab\u30fc\u306b\u540c\u671f\u3055\u308c\u307e\u3059\u3002\n\nThe configuration guide describes the available configuration options.\n\n\u5229\u7528\u53ef\u80fd\u306a\u8a2d\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u8a2d\u5b9a\u30ac\u30a4\u30c9\u306b\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002\n\nTerminating a Cluster \uff08\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u7834\u68c4\u3059\u308b\uff09\n\nNote that there is no way to recover data on EC2 nodes after shutting them down! Make sure you have copied everything important off the nodes before stopping them.\n\n\u30af\u30e9\u30b9\u30bf\u3092\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3\u3059\u308b\u3068EC2\u30ce\u30fc\u30c9\u4e0a\u306e\u30c7\u30fc\u30bf\u3092\u30ea\u30ab\u30d0\u30fc\u3059\u308b\u65b9\u6cd5\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u505c\u6b62\u3059\u308b\u524d\u306b\u91cd\u8981\u306a\u3082\u306e\u306f\u5168\u3066\u30b3\u30d4\u30fc\u3057\u3066\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u3068\u308a\u307e\u3057\u3087\u3046\u3002\n\nGo into the ec2 directory in the release of Spark you downloaded.\nRun ./spark-ec2 destroy .\n\nSpark\u306eec2\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n./spark-ec2 destory \u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u6016\u3044\u6016\u3044\u3002\n\nPausing and Restarting Clusters (\u4e00\u6642\u505c\u6b62\u3068\u518d\u7a3c\u50cd\uff09\n\nThe spark-ec2 script also supports pausing a cluster. In this case, the VMs are stopped but not terminated, so they lose all data on ephemeral disks but keep the data in their root partitions and their persistent-hdfs. Stopped machines will not cost you any EC2 cycles, but will continue to cost money for EBS storage.\n\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u30af\u30e9\u30b9\u30bf\u306e\u4e00\u6642\u505c\u6b62\u6a5f\u80fd\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u5834\u5408\u3001VM\u306f\u505c\u6b62\u3057\u307e\u3059\u304c\u30af\u30e9\u30b9\u30bf\u306f\u7834\u68c4\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u4e00\u6642\u30c7\u30a3\u30b9\u30af\u4e0a\u306e\u30c7\u30fc\u30bf\u3092\u5931\u3046\u3053\u3068\u306f\u306a\u304f\u3001root\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u305d\u308c\u3089\u306e\u30c7\u30fc\u30bf\u3092\u4fdd\u6301\u3057\u307e\u3059\u3002\n\u30de\u30b7\u30f3\u304c\u30b9\u30c8\u30c3\u30d7\u3055\u308c\u3066\u3044\u308b\u9593\u3001EC2\u306e\u30b3\u30b9\u30c8\u306f\u304b\u304b\u308a\u307e\u305b\u3093\u304c\u3001EBS\u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u6599\u91d1\u306f\u7d99\u7d9a\u7684\u306b\u767a\u751f\u3057\u307e\u3059\u3002\n\nTo stop one of your clusters, go into the ec2 directory and run ./spark-ec2 stop .\n\n\u30af\u30e9\u30b9\u30bf\u3092\u4e00\u6642\u505c\u6b62\u3059\u308b\u70ba\u306b\u306fec2\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306f\u3044\u3063\u3066\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n./spark-ec2 stop <cluster-name>\n\n\nTo restart it later, run ./spark-ec2 -i  start .\n\n\u505c\u6b62\u3057\u305f\u30af\u30e9\u30b9\u30bf\u3092\u518d\u8d77\u52d5\u3055\u305b\u308b\u306b\u306fec2\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306f\u3044\u3063\u3066\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n./spark-ec2 -i <key-file> start <cluster-name>\n\n\nTo ultimately destroy the cluster and stop consuming EBS space, run ./spark-ec2 destroy  as described in the previous section.\n\n\u6700\u5f8c\u306b\u30af\u30e9\u30b9\u30bf\u3092\u7834\u68c4\u3001EBS\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u3044\u679c\u305f\u3057\u3066\u30b9\u30c8\u30c3\u30d7\u3059\u308b\u5834\u5408\u306f\u524d\u8ff0\u306espark-ec2 destory \u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nLimitations (\u5236\u9650\u4e8b\u9805\uff09\n\nSupport for \u201ccluster compute\u201d nodes is limited \u2013 there\u2019s no way to specify a locality group. However, you can launch slave nodes in your -slaves group manually and then use spark-ec2 launch --resume to start a cluster with them.\nIf you have a patch or suggestion for one of these limitations, feel free to contribute it!\n\n\u30af\u30e9\u30b9\u30bf\u30b3\u30f3\u30d4\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30ce\u30fc\u30c9\u6570\u306f\u5236\u9650\u304c\u3042\u308a\u307e\u3059\u3002\u30ed\u30fc\u30ab\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u660e\u793a\u3059\u308b\u65b9\u6cd5\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001-slaves\u30b0\u30eb\u30fc\u30d7\u306b\u30b9\u30ec\u30fc\u30d6\u30ce\u30fc\u30c9\u3092\u624b\u52d5\u3067\u8d77\u52d5\u3057spark-ec2\u3067\u5fa9\u5143\u30b9\u30bf\u30fc\u30c8\u3092\u3059\u308b\u3053\u3068\u3067\u30ce\u30fc\u30c9\u6570\u3092\u5897\u3084\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3082\u3057\u3053\u306e\u5236\u9650\u4e8b\u9805\u306b\u5bfe\u5fdc\u3059\u308b\u30d1\u30c3\u30c1\u3084\u63d0\u6848\u304c\u3042\u308c\u3070\u5bc4\u8d08\u3057\u3066\u304f\u3060\u3055\u3044\uff01\nhttp://spark.apache.org/docs/latest/contributing-to-spark.html\n\nAccessing Data in S3 (S3\u4e0a\u306e\u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9)\n\nSpark\u2019s file interface allows it to process data in Amazon S3 using the same URI formats that are supported for Hadoop.\n\nSpark\u306e\u30d5\u30a1\u30a4\u30eb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u306fHadoop\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u306bAmazon S3\u306b\u5bfe\u3057\u3066\u540c\u3058URI\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u30a2\u30af\u30bb\u30b9\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\nYou can specify a path in S3 as input through a URI of the form s3n:///path.\n\ns3n:///path\u306e\u66f8\u5f0f\u306eURI\u3092\u901a\u3057\u3066S3\u306e\u30d1\u30b9\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\nYou will also need to set your Amazon security credentials, either by setting the environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY before your program or through SparkContext.hadoopConfiguration.\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3059\u308b\u524d\u3001SparkContext.hadoopConfiguration\u3092\u901a\u3058\u3066Amazon\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b3\u30f3\u30d5\u30a3\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u74b0\u5883\u5909\u6570AWS_ACCESS_KEY_ID\u3068AWS_SECRET_ACCESS_KEY\u306b\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nFull instructions on S3 access using the Hadoop input libraries can be found on the Hadoop S3 page.\n\nHadoop\u306e\u5165\u529b\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u901a\u3057\u305fS3\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5c0e\u5165\u306fHadoop S3\u306e\u30da\u30fc\u30b8\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\nhttp://wiki.apache.org/hadoop/AmazonS3\n\u8a33\u8005\u6ce8\uff09\n\u3055\u3055\u3063\u3068\u8a33\u3057\u305f\u3060\u3051\u306a\u306e\u3067\u8a00\u3044\u56de\u3057\u3068\u304b\u304a\u304b\u3057\u3051\u308c\u3070\u3054\u6307\u6458\u304f\u3060\u3055\u3044\u3002\n# Apache Spark\u306b\u3064\u3044\u3066\n\nhttp://spark.apache.org/\n\nApache Software Foundation\u3067\u6700\u8fd1\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u306a\u308a5\u6708\u306b\u6700\u901f\u3067\u30d0\u30fc\u30b8\u30e7\u30f31\u304c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u305f\u5206\u6563\u51e6\u7406\u57fa\u76e4\u306e\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u30d7\u30ed\u30c0\u30af\u30c8\u3002\nMapReduce on HDFS\u3068\u3053\u3068\u306a\u308a\u7e70\u308a\u8fd4\u3057\u6f14\u7b97\u51e6\u7406\u306e\u60c5\u5831\u3092\u30b7\u30a7\u30a2\u30fc\u30c9\u30e1\u30e2\u30ea\u3067\u5171\u6709\u3059\u308b\u305f\u3081\u6f14\u7b97\u901f\u5ea6\u304c\u7206\u901f\u3068\u3046\u305f\u308f\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u30d0\u30c3\u30c1\u3067\u3057\u304b\u51e6\u7406\u3067\u304d\u306a\u304b\u3063\u305f\u90e8\u5206\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u5316\u3001\u30bf\u30a4\u30e0\u30e9\u30b0\u3092\u6e1b\u3089\u3059\u306a\u3069\u4eca\u5f8c\u5927\u304d\u306a\u671f\u5f85\u304c\u3067\u304d\u308b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\n\n\u53c2\u8003\u4ed6\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\nTwitter Storm\u3068\u304b\n\nEC2\u3067\u7c21\u5358\u306b\u30af\u30e9\u30b9\u30bf\u3092\u69cb\u7bc9\u3067\u304d\u308b\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\nhttp://spark.apache.org/docs/latest/ec2-scripts.html\n\n\u3053\u3061\u3089\u306e\u65e5\u672c\u8a9e\u8a33\u3092\u3055\u3089\u3063\u3068\u3002\u5909\u306a\u3068\u3053\u308d\u304c\u3042\u3063\u305f\u3089\u3054\u6307\u6458\u304f\u3060\u3055\u3044\u3002\n\nQuick Start\u3084EC2\u3067\u306e\u5c0e\u5165\u30ac\u30a4\u30c9\u3082\u548c\u8a33\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3042\u308f\u305b\u3066\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\n* Quick Start<br>\nhttp://qiita.com/mychaelstyle/items/46440cd27ef641892a58\n* Cluster Mode Overview<br>\nhttp://qiita.com/mychaelstyle/items/610b432a1ef1a7e3d2a0\n\n\n# Running Spark on EC2 (Spark \u3092EC2\u3067\u8d77\u52d5\u3059\u308b\uff09\n\n> The spark-ec2 script, located in Spark\u2019s ec2 directory, allows you to launch, manage and shut down Spark clusters on Amazon EC2. It automatically sets up Spark, Shark and HDFS on the cluster for you. This guide describes how to use spark-ec2 to launch clusters, how to run jobs on them, and how to shut them down. It assumes you\u2019ve already signed up for an EC2 account on the Amazon Web Services site.\n\nSpark\u306eec2\u30d5\u30a9\u30eb\u30c0\u306b\u914d\u7f6e\u3055\u308c\u3066\u3044\u308bspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f7f\u3048\u3070\u3001Amazon EC2\u4e0a\u306eSpark\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u8d77\u52d5\u30fb\u7ba1\u7406\u30fb\u505c\u6b62\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u81ea\u52d5\u7684\u306bSpark, Shark, HDFS\u3092\u30af\u30e9\u30b9\u30bf\u4e0a\u306b\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u3002\n\u3053\u306e\u30ac\u30a4\u30c9\u306fspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5229\u7528\u3057\u3066\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u69cb\u7bc9\u3057\u305f\u308a\u3001\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3057\u305f\u308a\u3001\u30af\u30e9\u30b9\u30bf\u3092\u505c\u6b62\u3057\u305f\u308a\u3059\u308b\u305f\u3081\u306e\u65b9\u6cd5\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n> spark-ec2 is designed to manage multiple named clusters. You can launch a new cluster (telling the script its size and giving it a name), shutdown an existing cluster, or log into a cluster. \n\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u8907\u6570\u306e\u540d\u524d\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u7ba1\u7406\u3067\u304d\u308b\u3088\u3046\u306b\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b\u3002\n\u3042\u306a\u305f\u306f\uff08\u30b5\u30a4\u30ba\u3068\u540d\u524d\u3092\u6307\u5b9a\u3057\u3066\uff09\u65b0\u3057\u3044\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u8d77\u52d5\u3057\u305f\u308a\u3001\u540d\u524d\u3092\u6307\u5b9a\u3057\u3066\u8d77\u52d5\u6e08\u307f\u30af\u30e9\u30b9\u30bf\u3092\u505c\u6b62\u3057\u305f\u308a\u3001\u30af\u30e9\u30b9\u30bf\u306b\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n> Each cluster is identified by placing its machines into EC2 security groups whose names are derived from the name of the cluster.\n\n\u305d\u308c\u305e\u308c\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u306f\u914d\u7f6e\u3055\u308c\u305f\u30de\u30b7\u30f3\u3068\u30af\u30e9\u30b9\u30bf\u540d\u304b\u3089\u540d\u4ed8\u3051\u3089\u308c\u308bEC2\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u30b0\u30eb\u30fc\u30d7\u540d\u3067\u5b8c\u5168\u306b\u72ec\u7acb\u3057\u3066\u52d5\u4f5c\u3059\u308b\u3002\n\n> For example, a cluster named test will contain a master node in a security group called test-master, and a number of slave nodes in a security group called test-slaves.\n\n\u4f8b\u3048\u3070\u3042\u308btest\u3068\u540d\u4ed8\u3051\u3089\u308c\u305f\u30af\u30e9\u30b9\u30bf\u304c\u30de\u30b9\u30bf\u30fc\u30ce\u30fc\u30c9\u3092test-master\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306b\u542b\u307e\u308c\u308b\u5834\u5408\u3001\u30b9\u30ec\u30fc\u30d6\u30ce\u30fc\u30c9\u7fa4\u306ftest-slaves\u3068\u306a\u308b\u3002\n\n> The spark-ec2 script will create these security groups for you based on the cluster name you request. You can also use them to identify machines belonging to each cluster in the Amazon EC2 Console.\n\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3053\u308c\u3089\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u3042\u306a\u305f\u304c\u8981\u6c42\u3057\u305f\u30af\u30e9\u30b9\u30bf\u540d\u306b\u57fa\u3065\u3044\u3066\u751f\u6210\u3059\u308b\u3002\u3042\u306a\u305f\u306f\u305d\u308c\u3089\u3092Amazon EC2\u30b3\u30f3\u30bd\u30fc\u30eb\u304b\u3089\u305d\u308c\u305e\u308c\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u6240\u5c5e\u3055\u305b\u3066\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002\n\n## Before You Start (\u8d77\u52d5\u306e\u524d\u306b\uff09\n\n> Create an Amazon EC2 key pair for yourself. This can be done by logging into your Amazon Web Services account through the AWS console, clicking Key Pairs on the left sidebar, and creating and downloading a key. Make sure that you set the permissions for the private key file to 600 (i.e. only you can read and write it) so that ssh will work.\n\nEC2\u3067\u30ad\u30fc\u30da\u30a2\u3092\u767b\u9332\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002AWS\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u7c21\u5358\u306b\u767b\u9332\u3067\u304d\u307e\u3059\u3002\uff08\u4ee5\u4e0b\u7565\uff09\n\n> Whenever you want to use the spark-ec2 script, set the environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY to your Amazon EC2 access key ID and secret access key. These can be obtained from the AWS homepage by clicking Account > Security Credentials > Access Credentials.\n\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5229\u7528\u3057\u305f\u3044\u306a\u3089\u74b0\u5883\u5909\u6570AWS_ACCESS_KEY\u3068AWS_SECRET_ACCESS_KEY\u3092\u30a2\u30af\u30bb\u30b9\u30ad\u30fcID\u3092\u53d6\u5f97\u3057\u3066\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\uff08\u88dc\u8db3\uff09\u3053\u3053\u306b\u66f8\u3044\u3066\u3042\u308b\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u53d6\u5f97\u3088\u308a\u3082IAM\u30ed\u30fc\u30eb\u3092\u4f5c\u3063\u3066\u30af\u30ec\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u4f5c\u3063\u305f\u65b9\u304c\u5b9f\u904b\u7528\u3067\u306f\u3088\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n## Launching a Cluster\uff08\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u8d77\u52d5\u3059\u308b\uff09\n\n> Go into the ec2 directory in the release of Spark you downloaded.\n\nSpark\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30fb\u89e3\u51cd\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u5185\u306eec2\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306f\u3044\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n> Run ./spark-ec2 -k <keypair> -i <key-file> -s <num-slaves> launch <cluster-name>, where <keypair> is the name of your EC2 key pair (that you gave it when you created it), <key-file> is the private key file for your key pair, <num-slaves> is the number of slave nodes to launch (try 1 at first), and <cluster-name> is the name to give to \nyour cluster.\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```shell-session\n./spark-ec2 -k <keypair> -i <key-file> -s <num-slaves> launch <cluster-name>\n```\n\n<keypair>\u306f\u3042\u306a\u305f\u304cEC2\u3067\u767b\u9332\u3057\u305f\u30ad\u30fc\u30da\u30a2\u540d\u3001\n<key-file>\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30ad\u30fc\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3001\n<num-slaves>\u306f\u30b9\u30ec\u30fc\u30d6\u30ce\u30fc\u30c9\u3092\u8d77\u52d5\u3059\u308b\u6570\uff08\u5c11\u306a\u304f\u3068\u30821\u4ee5\u4e0a\uff09\n<clushter-name>\u306f\u8d77\u52d5\u3059\u308b\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u4e0e\u3048\u308b\u4efb\u610f\u306e\u540d\u524d\u3067\u3059\u3002\n\n\n> After everything launches, check that the cluster scheduler is up and sees all the slaves by going to its web UI, which will be printed at the end of the script (typically http://<master-hostname>:8080).\n\n\u5168\u3066\u8d77\u52d5\u3057\u305f\u5f8c\u306b\u30af\u30e9\u30b9\u30bf\u30fc\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u304c\u6728\u540c\u58eb\u5168\u3066\u306e\u30b9\u30ec\u30fc\u30d6\u304cweb UI\u304b\u3089\u78ba\u8a8d\u3067\u304d\u308b\u304b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002Web UI\u306eURL\u306f\u30b9\u30af\u30ea\u30d7\u30c8\u5b9f\u884c\u306e\u6700\u5f8c\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\uff08\u4e00\u822c\u7684\u306b http://master-hostname>:8080/\uff09\n\n> You can also run ./spark-ec2 --help to see more usage options. The following options are worth pointing out:\n\n./spark-ec2 --help\u3092\u5b9f\u884c\u3059\u308c\u3070\u5229\u7528\u53ef\u80fd\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8868\u793a\u3067\u304d\u308b\u3002\u4e0b\u8a18\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u6709\u7528\u306a\u4e00\u90e8\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u629c\u7c8b\u3067\u3059\u3002\n\n> --instance-type=<INSTANCE_TYPE> can be used to specify an EC2 instance type to use. For now, the script only supports 64-bit instance types, and the default type is m1.large (which has 2 cores and 7.5 GB RAM). Refer to the Amazon pages about EC2 instance types and EC2 pricing for information about other instance types.\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u73fe\u5728\u306f64bit\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306e\u307f\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30bf\u30a4\u30d7\u306fm2.large\uff08\uff12\u30b3\u30a2\uff1a\uff17\uff0e\uff15GB\u30e1\u30e2\u30ea\uff09\u3067\u3059\u3002\u4ed6\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u306b\u3064\u3044\u3066\u306fAmazon EC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30bf\u30a4\u30d7\u3068\u6599\u91d1\u8868\u306e\u30da\u30fc\u30b8\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n> --region=<EC2_REGION> specifies an EC2 region in which to launch instances. The default region is us-east-1.\n\nEC2\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ea\u30fc\u30b8\u30e7\u30f3\u306fus-east-1\uff08\u30d0\u30fc\u30b8\u30cb\u30a2\uff09\u3067\u3059\u3002\n\n> --zone=<EC2_ZONE> can be used to specify an EC2 availability zone to launch instances in. Sometimes, you will get an error because there is not enough capacity in one zone, and you should try to launch in another.\n\nEC2\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8d77\u52d5\u3059\u308b\u30a2\u30d9\u30a4\u30e9\u30d3\u30ea\u30c6\u30a3\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u308c\u306b\u4e00\u3064\u306e\u30be\u30fc\u30f3\u306b\u5341\u5206\u306a\u30ad\u30e3\u30d1\u30b7\u30c6\u30a3\u304c\u306a\u3044\u305f\u3081\u306e\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3059\u306e\u3067\u3001\u4ed6\u306e\u30be\u30fc\u30f3\u3092\u6307\u5b9a\u3057\u3066\u89e3\u6c7a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n> --ebs-vol-size=GB will attach an EBS volume with a given amount of space to each node so that you can have a persistent HDFS cluster on your nodes across cluster restarts (see below).\n\n\u5f37\u56fa\u306aHDFS\u30af\u30e9\u30b9\u30bf\u3092\u30ce\u30fc\u30c9\u4e0a\u306b\u518d\u69cb\u7bc9\u3059\u308b\u70ba\u306b\u305d\u308c\u305e\u308c\u306e\u30ce\u30fc\u30c9\u306eEBS\u30dc\u30ea\u30e5\u30fc\u30e0\u3092GB\u5358\u4f4d\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n> --spot-price=PRICE will launch the worker nodes as Spot Instances, bidding for the given maximum price (in dollars).\n\n\u30ef\u30fc\u30ab\u30fc\u30ce\u30fc\u30c9\u3092\u30b9\u30dd\u30c3\u30c8\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3068\u3057\u3066\u6700\u5927\u6599\u91d1\u3092\u6307\u5b9a\u3057\u30d9\u30c3\u30c9\u3057\u307e\u3059\u3002\u6700\u5927\u6599\u91d1\u306fUS\u30c9\u30eb\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n> --spark-version=VERSION will pre-load the cluster with the specified version of Spark. VERSION can be a version number (e.g. \u201c0.7.3\u201d) or a specific git hash. By default, a recent version will be used.\n\n\u660e\u793a\u7684\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3057\u3066spark\u306e\u30d7\u30ec\u30ed\u30fc\u30c9\u3092\u304a\u3053\u306a\u3044\u307e\u3059\u3002\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u306f\"0.7.3\"\u306e\u3088\u3046\u306b\u6307\u5b9a\u3059\u308b\u304bgit\u306e\u30cf\u30c3\u30b7\u30e5\u3067\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u6700\u65b0\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3059\u3002\uff082014/06/09\u73fe\u5728\u306f1.0.0\uff09\n\n> If one of your launches fails due to e.g. not having the right permissions on your private key file, you can run launch with the --resume option to restart the setup process on an existing cluster.\n\n\u3082\u3057\u3082[not having the righe permissions on your private key file,]\u7b49\u8868\u793a\u3055\u308c\u3066\u8d77\u52d5\u306b\u5931\u6557\u3057\u305f\u5834\u5408\u306f\u3001--resume\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u3066\u30ea\u30b9\u30bf\u30fc\u30c8\u3055\u305b\u308b\u3053\u3068\u3067\u5b58\u5728\u3059\u308b\u30af\u30e9\u30b9\u30bf\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u30d7\u30ed\u30bb\u30b9\u3092\u5229\u7528\u3067\u304d\u307e\u3059\u3002\n\n## Running Applications\u3000\uff08\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u7a3c\u50cd\u3055\u305b\u308b\uff09\n\n> Go into the ec2 directory in the release of Spark you downloaded.\n\nSpark\u306eec2\u30d5\u30a9\u30eb\u30c0\u306b\u5165\u3063\u3066\u304f\u3060\u3055\u3044\u3002\n\n> Run ./spark-ec2 -k <keypair> -i <key-file> login <cluster-name> to SSH into the cluster, where <keypair> and <key-file> are as above. (This is just for convenience; you could also use the EC2 console.)\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u6307\u5b9a\u306e\u30af\u30e9\u30b9\u30bf\u306bSSH\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```shell-session\n./spark-ec2 -k <keypair> -i <key-file> login <cluster-name>\n```\n\n<keypair>\u3068<key-faile>\u306f\u524d\u8ff0\u306e\u901a\u308a\u3067\u3059\u3002\uff08\u3053\u308c\u306f\u5229\u4fbf\u6027\u306e\u305f\u3081\u3060\u3051\u306e\u6a5f\u80fd\u3067\u3059\u3002EC2\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u5229\u7528\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\uff09\n\n> To deploy code or data within your cluster, you can log in and use the provided script ~/spark-ec2/copy-dir, which, given a directory path, RSYNCs it to the same location on all the slaves.\n\n\u30b3\u30fc\u30c9\u3084\u30c7\u30fc\u30bf\u3092\u3042\u306a\u305f\u306e\u30af\u30e9\u30b9\u30bf\u30fc\u306b\u914d\u7f6e\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u7528\u610f\u3055\u308c\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u3001/spark-ec2/copy-dir\u3092\u5229\u7528\u3057\u3066\u6307\u5b9a\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u30d1\u30b9\u3001RSYNCs\u3067\u3001\u30b9\u30ec\u30fc\u30d6\u306e\u540c\u3058\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u914d\u5099\u3067\u304d\u307e\u3059\u3002\n\n> If your application needs to access large datasets, the fastest way to do that is to load them from Amazon S3 or an Amazon EBS device into an instance of the Hadoop Distributed File System (HDFS) on your nodes. The spark-ec2 script already sets up a HDFS instance for you. It\u2019s installed in /root/ephemeral-hdfs, and can be accessed using the bin/hadoop script in that directory. Note that the data in this HDFS goes away when you stop and restart a machine.\n\n\u3082\u3057\u3042\u306a\u305f\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u5de8\u5927\u306a\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u306a\u3089\u3001\u3082\u3063\u3068\u3082\u65e9\u3044\u65b9\u6cd5\u306fAmazonS3\u304bAmazon EBS\u3067\u30d0\u30a4\u30b9\u304b\u3089\u30ce\u30fc\u30c9\u4e0a\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eHDFS\uff08Hadoop Distributed File System)\u306b\u8aad\u307f\u8fbc\u3080\u3053\u3068\u3067\u3059\u3002\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u306fHDFS\u3092\u81ea\u52d5\u7684\u306b\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u69cb\u7bc9\u3057\u3066\u3044\u307e\u3059\u3002\n/root/ephemeral-hdfs\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u304a\u308a\u3001bin/hadoop\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5229\u7528\u3057\u3066\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u3059\u3002\n\u30de\u30b7\u30f3\u3092\u30b9\u30c8\u30c3\u30d7\u3057\u305f\u308a\u30ea\u30b9\u30bf\u30fc\u30c8\u3059\u308b\u3068\u3053\u306eHDFS\u30af\u30e9\u30b9\u30bf\u306f\u6d88\u3048\u3066\u3057\u307e\u3046\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n> There is also a persistent HDFS instance in /root/persistent-hdfs that will keep data across cluster restarts. Typically each node has relatively little space of persistent data (about 3 GB), but you can use the --ebs-vol-size option to spark-ec2 to attach a persistent EBS volume to each node for storing the persistent HDFS.\n\n\u6c38\u7d9a\u7684\u306aHDFS\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3082/root/persistent-hdfs\u306b\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u518d\u8d77\u52d5\u3057\u3066\u3082\u3053\u308c\u3089\u306e\u30c7\u30fc\u30bf\u306f\u5b58\u7d9a\u3057\u307e\u3059\u3002\n\u4e00\u822c\u7684\u306b\u305d\u308c\u305e\u308c\u306e\u30ce\u30fc\u30c9\u306f\u95a2\u9023\u3057\u305f\u5c11\u3057\u306e\u6c38\u7d9a\u30c7\u30fc\u30bf\u30b9\u30da\u30fc\u30b9\uff083GB\u7a0b\u5ea6\uff09\u3092\u4fdd\u6301\u3057\u307e\u3059\u3001\u3057\u304b\u3057--ebs-vol-size\u30aa\u30d7\u30b7\u30e7\u30f3\u3092spark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5229\u7528\u3059\u308b\u3053\u3068\u3067\u6c38\u7d9a\u7684EBS\u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u305d\u308c\u305e\u308c\u306e\u30ce\u30fc\u30c9\u306bHDFS\u3068\u3057\u3066\u30a2\u30bf\u30c3\u30c1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n> Finally, if you get errors while running your application, look at the slave\u2019s logs for that application inside of the scheduler work directory (/root/spark/work). You can also view the status of the cluster using the web UI: http://<master-hostname>:8080.\n\n\u6700\u5f8c\u306b\u3001\u3082\u3057\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5b9f\u884c\u6642\u306b\u30a8\u30e9\u30fc\u62c5\u3063\u305f\u5834\u5408\u3001\u30b9\u30b1\u30b8\u30e5\u30fc\u30e9\u30fc\u306e\u30ef\u30fc\u30af\u30c7\u30a3\u30ec\u30af\u30c8\u30ea(/root/spark/work\uff09\u306e\u30b9\u30ec\u30fc\u30d6\u30ed\u30b0\u3092\u898b\u3066\u304f\u3060\u3055\u3044\u3002\nWeb UI\uff08http://<master-hostname>:8080/)\u3067\u72b6\u614b\u3092\u78ba\u8a8d\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n## Configuration \uff08\u8a2d\u5b9a\uff09\n\n> You can edit /root/spark/conf/spark-env.sh on each machine to set Spark configuration options, such as JVM options. This file needs to be copied to every machine to reflect the change. The easiest way to do this is to use a script we provide called copy-dir. First edit your spark-env.sh file on the master, then run ~/spark-ec2/copy-dir /root/spark/conf to RSYNC it to all the workers.\n\n\u305d\u308c\u305e\u308c\u306e\u30de\u30b7\u30f3\u4e0a\u306e/root/spark/conf/spark-env.sh\u3092\u7de8\u96c6\u3057\u3066Spark\u306e\u8a2d\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070JVM\u30aa\u30d7\u30b7\u30e7\u30f3\u306a\u3069\u3002\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306f\u5168\u3066\u306e\u30de\u30b7\u30f3\u306b\u5909\u66f4\u3092\u30b3\u30d4\u30fc\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\u3092\u7c21\u5358\u306b\u304a\u3053\u306a\u3046\u306b\u306fcopy-dir\u3092\u4f7f\u3046\u3068\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\u6700\u521d\u306b\u30de\u30b9\u30bf\u30fc\u4e0a\u3067spark-env.sh\u30d5\u30a1\u30a4\u30eb\u3092\u7de8\u96c6\u3057\u3001~/spark-ec2/copy-dir /root/spark/conf\u3092RSYNC\u3059\u308b\u3053\u3068\u3067\u5168\u3066\u306e\u30ef\u30fc\u30ab\u30fc\u306b\u540c\u671f\u3055\u308c\u307e\u3059\u3002\n\n> The configuration guide describes the available configuration options.\n\n\u5229\u7528\u53ef\u80fd\u306a\u8a2d\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u306f<a href=\"http://spark.apache.org/docs/latest/configuration.html\" target=\"_blank\">\u8a2d\u5b9a\u30ac\u30a4\u30c9</a>\u306b\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002\n\n## Terminating a Cluster \uff08\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u7834\u68c4\u3059\u308b\uff09\n\n> Note that there is no way to recover data on EC2 nodes after shutting them down! Make sure you have copied everything important off the nodes before stopping them.\n\n\u30af\u30e9\u30b9\u30bf\u3092\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3\u3059\u308b\u3068EC2\u30ce\u30fc\u30c9\u4e0a\u306e\u30c7\u30fc\u30bf\u3092\u30ea\u30ab\u30d0\u30fc\u3059\u308b\u65b9\u6cd5\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u505c\u6b62\u3059\u308b\u524d\u306b\u91cd\u8981\u306a\u3082\u306e\u306f\u5168\u3066\u30b3\u30d4\u30fc\u3057\u3066\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u3068\u308a\u307e\u3057\u3087\u3046\u3002\n\n> Go into the ec2 directory in the release of Spark you downloaded.\n> Run ./spark-ec2 destroy <cluster-name>.\n\nSpark\u306eec2\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002\n./spark-ec2 destory <cluster-name>\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u6016\u3044\u6016\u3044\u3002\n\n## Pausing and Restarting Clusters (\u4e00\u6642\u505c\u6b62\u3068\u518d\u7a3c\u50cd\uff09\n\n> The spark-ec2 script also supports pausing a cluster. In this case, the VMs are stopped but not terminated, so they lose all data on ephemeral disks but keep the data in their root partitions and their persistent-hdfs. Stopped machines will not cost you any EC2 cycles, but will continue to cost money for EBS storage.\n\nspark-ec2\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u30af\u30e9\u30b9\u30bf\u306e\u4e00\u6642\u505c\u6b62\u6a5f\u80fd\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u5834\u5408\u3001VM\u306f\u505c\u6b62\u3057\u307e\u3059\u304c\u30af\u30e9\u30b9\u30bf\u306f\u7834\u68c4\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u4e00\u6642\u30c7\u30a3\u30b9\u30af\u4e0a\u306e\u30c7\u30fc\u30bf\u3092\u5931\u3046\u3053\u3068\u306f\u306a\u304f\u3001root\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u305d\u308c\u3089\u306e\u30c7\u30fc\u30bf\u3092\u4fdd\u6301\u3057\u307e\u3059\u3002\n\u30de\u30b7\u30f3\u304c\u30b9\u30c8\u30c3\u30d7\u3055\u308c\u3066\u3044\u308b\u9593\u3001EC2\u306e\u30b3\u30b9\u30c8\u306f\u304b\u304b\u308a\u307e\u305b\u3093\u304c\u3001EBS\u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u6599\u91d1\u306f\u7d99\u7d9a\u7684\u306b\u767a\u751f\u3057\u307e\u3059\u3002\n\n> To stop one of your clusters, go into the ec2 directory and run ./spark-ec2 stop <cluster-name>.\n\n\u30af\u30e9\u30b9\u30bf\u3092\u4e00\u6642\u505c\u6b62\u3059\u308b\u70ba\u306b\u306fec2\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306f\u3044\u3063\u3066\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```shell-session\n./spark-ec2 stop <cluster-name>\n```\n\n> To restart it later, run ./spark-ec2 -i <key-file> start <cluster-name>.\n\n\u505c\u6b62\u3057\u305f\u30af\u30e9\u30b9\u30bf\u3092\u518d\u8d77\u52d5\u3055\u305b\u308b\u306b\u306fec2\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u306f\u3044\u3063\u3066\u4e0b\u8a18\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```shell-session\n./spark-ec2 -i <key-file> start <cluster-name>\n```\n\n> To ultimately destroy the cluster and stop consuming EBS space, run ./spark-ec2 destroy <cluster-name> as described in the previous section.\n\n\u6700\u5f8c\u306b\u30af\u30e9\u30b9\u30bf\u3092\u7834\u68c4\u3001EBS\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u3044\u679c\u305f\u3057\u3066\u30b9\u30c8\u30c3\u30d7\u3059\u308b\u5834\u5408\u306f\u524d\u8ff0\u306espark-ec2 destory <cluster-name>\u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n## Limitations (\u5236\u9650\u4e8b\u9805\uff09\n\n> Support for \u201ccluster compute\u201d nodes is limited \u2013 there\u2019s no way to specify a locality group. However, you can launch slave nodes in your <clusterName>-slaves group manually and then use spark-ec2 launch --resume to start a cluster with them.\nIf you have a patch or suggestion for one of these limitations, feel free to contribute it!\n\n\u30af\u30e9\u30b9\u30bf\u30b3\u30f3\u30d4\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30ce\u30fc\u30c9\u6570\u306f\u5236\u9650\u304c\u3042\u308a\u307e\u3059\u3002\u30ed\u30fc\u30ab\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u3092\u660e\u793a\u3059\u308b\u65b9\u6cd5\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001<lusterName>-slaves\u30b0\u30eb\u30fc\u30d7\u306b\u30b9\u30ec\u30fc\u30d6\u30ce\u30fc\u30c9\u3092\u624b\u52d5\u3067\u8d77\u52d5\u3057spark-ec2\u3067\u5fa9\u5143\u30b9\u30bf\u30fc\u30c8\u3092\u3059\u308b\u3053\u3068\u3067\u30ce\u30fc\u30c9\u6570\u3092\u5897\u3084\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3082\u3057\u3053\u306e\u5236\u9650\u4e8b\u9805\u306b\u5bfe\u5fdc\u3059\u308b\u30d1\u30c3\u30c1\u3084\u63d0\u6848\u304c\u3042\u308c\u3070\u5bc4\u8d08\u3057\u3066\u304f\u3060\u3055\u3044\uff01\n\nhttp://spark.apache.org/docs/latest/contributing-to-spark.html\n\n## Accessing Data in S3 (S3\u4e0a\u306e\u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9)\n\n> Spark\u2019s file interface allows it to process data in Amazon S3 using the same URI formats that are supported for Hadoop.\n\nSpark\u306e\u30d5\u30a1\u30a4\u30eb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u306fHadoop\u3067\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u306bAmazon S3\u306b\u5bfe\u3057\u3066\u540c\u3058URI\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u30a2\u30af\u30bb\u30b9\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\n> You can specify a path in S3 as input through a URI of the form s3n://<bucket>/path.\n\ns3n://<bucket>/path\u306e\u66f8\u5f0f\u306eURI\u3092\u901a\u3057\u3066S3\u306e\u30d1\u30b9\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n> You will also need to set your Amazon security credentials, either by setting the environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY before your program or through SparkContext.hadoopConfiguration.\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u884c\u3059\u308b\u524d\u3001SparkContext.hadoopConfiguration\u3092\u901a\u3058\u3066Amazon\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b3\u30f3\u30d5\u30a3\u30c7\u30f3\u30b7\u30e3\u30eb\u3092\u74b0\u5883\u5909\u6570AWS_ACCESS_KEY_ID\u3068AWS_SECRET_ACCESS_KEY\u306b\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n> Full instructions on S3 access using the Hadoop input libraries can be found on the Hadoop S3 page.\n\nHadoop\u306e\u5165\u529b\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u901a\u3057\u305fS3\u3078\u306e\u30a2\u30af\u30bb\u30b9\u306e\u5c0e\u5165\u306fHadoop S3\u306e\u30da\u30fc\u30b8\u3092\u3054\u89a7\u304f\u3060\u3055\u3044\u3002\n\nhttp://wiki.apache.org/hadoop/AmazonS3\n\n\u8a33\u8005\u6ce8\uff09\n\u3055\u3055\u3063\u3068\u8a33\u3057\u305f\u3060\u3051\u306a\u306e\u3067\u8a00\u3044\u56de\u3057\u3068\u304b\u304a\u304b\u3057\u3051\u308c\u3070\u3054\u6307\u6458\u304f\u3060\u3055\u3044\u3002\n\n\n\n\n", "tags": ["Spark", "EC2", "AWS"]}