{"context": "\n\n\u306f\u3058\u3081\u306b\nAmazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9(Amazon Linux)\u306bRuby Sinatra\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u624b\u9806\u3067\u3059\u3002\nAmazon Linux\u306brbenv 1.0.0-33 + ruby-build + Ruby 2.3.1 + Sinatra 1.4.7\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u6642\u306b\u4f7f\u7528\u3057\u305fAMI\nSinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u4ee5\u4e0b\u306eAMI\u3067\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\u30fbamzn-ami-hvm-2016.03.3.x86_64-gp2 (ami-374db956)\n\nRuby Sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u74b0\u5883\n\u30fbAmazon Linux (4.4.19-29.55.amzn1.x86_64)\n# uname -a\nLinux example-ruby-sinatra-server 4.4.19-29.55.amzn1.x86_64 #1 SMP Mon Aug 29 23:29:40 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n#\n\n\n\u53c2\u8003\u30da\u30fc\u30b8\n\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\nhttps://github.com/sinatra/sinatra\nrbenv\u3092\u4f7f\u3063\u3066Sinatra\u306e\u5b9f\u884c\u74b0\u5883\u3092\u6574\u3048\u308b\u307e\u3067\nhttp://qiita.com/keita-nishimoto/items/8a89a176943a44adbebb\nRuby Sinatra\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttp://qiita.com/soushiy/items/8de8dfef5183fc3b515a\nAmazon Linux\u306bRuby on Rails\u74b0\u5883\u69cb\u7bc9(rbenv + ruby-build + Ruby 2.2.1 + Rails 4.2.1\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\nhttp://qiita.com/na0AaooQ/items/5bd62e630a2faf051a52\n\nAmazon Linux\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\n\n(1) Amazon Linux\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\nAmazon Linux\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u6642\u3001User Data\u306b\u4ee5\u4e0b\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nUserData\n#!/bin/sh\n\necho \"User Data start\"\n\nyum -y update\n\nunalias cp\ncp -f -p /usr/share/zoneinfo/Japan /etc/localtime\n\ncat << _EOT_ > /etc/sysconfig/clock\nZONE=\"Asia/Tokyo\"\nUTC=false\n_EOT_\n\nchmod 644 /etc/sysconfig/clock\n\n/etc/init.d/crond restart\n\necho \"User Data end\"\n\n\n\nAmazon Linux\u3078\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n(2) Amazon Linux\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u4f5c\u6210\u3055\u308c\u305f\u3089\u3001ec2-user\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\n\n(3) git\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ sudo su -\n# yum -y install git\n\n\n(4) Ruby\u3084Sinatra\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# yum -y install gcc-c++ patch openssl-devel readline readline-devel libyaml-devel zlib zlib-devel libffi-devel make bzip2 autoconf automake libtool bison iconv-deve\n\n\nrbenv\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n(5) rbenv\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# git clone https://github.com/sstephenson/rbenv.git /usr/local/rbenv\nCloning into '/usr/local/rbenv'...\nremote: Counting objects: 2542, done.\nremote: Total 2542 (delta 0), reused 0 (delta 0), pack-reused 2542\nReceiving objects: 100% (2542/2542), 461.51 KiB | 383.00 KiB/s, done.\nResolving deltas: 100% (1597/1597), done.\nChecking connectivity... done.\n#\n\n\n(6) rbenv\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# ls -lrta /usr/local/rbenv/\ntotal 80\ndrwxr-xr-x 13 root root  4096 Oct  2 19:31 ..\n-rw-r--r--  1 root root    35 Oct  2 19:31 .vimrc\n-rw-r--r--  1 root root   184 Oct  2 19:31 .travis.yml\ndrwxr-xr-x  2 root root  4096 Oct  2 19:31 src\n-rw-r--r--  1 root root 16571 Oct  2 19:31 README.md\ndrwxr-xr-x  3 root root  4096 Oct  2 19:31 rbenv.d\n-rw-r--r--  1 root root  1058 Oct  2 19:31 LICENSE\ndrwxr-xr-x  2 root root  4096 Oct  2 19:31 libexec\n-rw-r--r--  1 root root    97 Oct  2 19:31 .gitignore\n-rw-r--r--  1 root root  3390 Oct  2 19:31 CONDUCT.md\ndrwxr-xr-x  2 root root  4096 Oct  2 19:31 completions\ndrwxr-xr-x  2 root root  4096 Oct  2 19:31 bin\n-rw-r--r--  1 root root    19 Oct  2 19:31 .agignore\ndrwxr-xr-x  9 root root  4096 Oct  2 19:31 .\ndrwxr-xr-x  3 root root  4096 Oct  2 19:31 test\ndrwxr-xr-x  8 root root  4096 Oct  2 19:31 .git\n#\n\n\nRBENV_ROOT\u74b0\u5883\u5909\u6570\u306e\u8ffd\u52a0\n\n(7) rbenv\u7528\u306e\u74b0\u5883\u5909\u6570\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n# cp -p /etc/profile /etc/profile.ORG\n# diff /etc/profile /etc/profile.ORG\n#\n\n# echo 'export RBENV_ROOT=\"/usr/local/rbenv\"' >> /etc/profile\n# echo 'export PATH=\"${RBENV_ROOT}/bin:${PATH}\"' >> /etc/profile\n# echo 'eval \"$(rbenv init -)\"' >> /etc/profile\n\n\nRBENV_ROOT\u74b0\u5883\u5909\u6570\u306e\u6709\u52b9\u5316\u3084rbenv init\u5b9f\u884c\n\n(8) rbenv\u7528\u306e\u74b0\u5883\u5909\u6570\u3092\u8aad\u307f\u8fbc\u307f\u3001rbenv init\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n# source /etc/profile\n\n# su - root\n\n# env | grep RBENV\nRBENV_ROOT=/usr/local/rbenv\nRBENV_SHELL=bash\n#\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305frbenv\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n(9) \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305frbenv\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# which rbenv\n/usr/local/rbenv/bin/rbenv\n#\n\n# rbenv --version\nrbenv 1.0.0-33-gc7dcaf1\n#\n\n\nruby-build\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n(10) ruby-build\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nrbenv install\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u70ba\u3001rbenv\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3042\u308bruby-build\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# git clone https://github.com/sstephenson/ruby-build.git /usr/local/rbenv/plugins/ruby-build\nCloning into '/usr/local/rbenv/plugins/ruby-build'...\nremote: Counting objects: 6981, done.\nremote: Total 6981 (delta 0), reused 0 (delta 0), pack-reused 6981\nReceiving objects: 100% (6981/6981), 1.35 MiB | 614.00 KiB/s, done.\nResolving deltas: 100% (4152/4152), done.\nChecking connectivity... done.\n#\n\n\n(11) ruby-build\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# ls -lrta /usr/local/rbenv/plugins/ruby-build\ntotal 56\ndrwxr-xr-x 3 root root 4096 Oct  2 19:38 ..\n-rw-r--r-- 1 root root  474 Oct  2 19:38 .travis.yml\ndrwxr-xr-x 3 root root 4096 Oct  2 19:38 share\ndrwxr-xr-x 2 root root 4096 Oct  2 19:38 script\n-rw-r--r-- 1 root root 8799 Oct  2 19:38 README.md\n-rw-r--r-- 1 root root 1063 Oct  2 19:38 LICENSE\n-rwxr-xr-x 1 root root  357 Oct  2 19:38 install.sh\n-rw-r--r-- 1 root root 3390 Oct  2 19:38 CONDUCT.md\ndrwxr-xr-x 2 root root 4096 Oct  2 19:38 bin\ndrwxr-xr-x 7 root root 4096 Oct  2 19:38 .\ndrwxr-xr-x 5 root root 4096 Oct  2 19:38 test\ndrwxr-xr-x 8 root root 4096 Oct  2 19:38 .git\n#\n\n\nRuby 2.3.1\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n(12) \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u306aRuby\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# rbenv install -l\nAvailable versions:\n  1.8.5-p113\n  1.8.5-p114\n\u3000 (\u4e2d\u7565)\n  2.3.0\n  2.3.1\u3000\u2192\u3000\u3053\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n  2.4.0-dev\n  2.4.0-preview1\n  2.4.0-preview2\n  jruby-1.5.6\n  jruby-1.6.3\n\u3000 (\u4e2d\u7565)\n  ree-1.8.7-2011.12\n  ree-1.8.7-2012.01\n  ree-1.8.7-2012.02\n  topaz-dev\n#\n\n\n(13) Ruby 2.3.1\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# rbenv install -v 2.3.1\n\n\n(14) Ruby 2.3.1\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3059\u308b\u307e\u3067\u5f85\u3061\u307e\u3059\u3002\nAmazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306et2.micro\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5834\u5408\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\u307e\u30675\u5206\u7a0b\u304b\u304b\u308a\u307e\u3059\u306e\u3067\u5c11\u3005\u5f85\u3061\u307e\u3059\u3002\n# rbenv install -v 2.3.1\n/tmp/ruby-build.20161002194712.3034 ~\nDownloading ruby-2.3.1.tar.bz2...\n-> https://cache.ruby-lang.org/pub/ruby/2.3/ruby-2.3.1.tar.bz2\nInstalling ruby-2.3.1...\n/tmp/ruby-build.20161002194712.3034/ruby-2.3.1 /tmp/ruby-build.20161002194712.3034 ~\nchecking for ruby... /usr/bin/ruby\nconfig.guess already exists\nconfig.sub already exists\nchecking build system type... x86_64-pc-linux-gnu\nchecking host system type... x86_64-pc-linux-gnu\nchecking target system type... x86_64-pc-linux-gnu\nchecking for gcc... gcc\n\n\u3000(\u4e2d\u7565)\n\ninstalling rdoc:              /usr/local/rbenv/versions/2.3.1/share/ri/2.3.0/system\ninstalling capi-docs:         /usr/local/rbenv/versions/2.3.1/share/doc/ruby\nInstalled ruby-2.3.1 to /usr/local/rbenv/versions/2.3.1\n\n/tmp/ruby-build.20161002194712.3034 ~\n~\n#\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fRuby\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n\n(15) Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u74b0\u5883\u5168\u4f53\u306eRuby\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fRuby 2.3.1\u3078\u5207\u308a\u66ff\u3048\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# rbenv rehash\n# rbenv global 2.3.1\n#\n\n\n(16) Ruby 2.3.1\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# which ruby\n/usr/local/rbenv/shims/ruby\n#\n\n# ruby -v\nruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]\n#\n\n\nSinatra\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n(17) gem\u3092\u6700\u65b0\u306b\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# rbenv exec gem update --system\nUpdating rubygems-update\nFetching: rubygems-update-2.6.7.gem (100%)\nSuccessfully installed rubygems-update-2.6.7\nParsing documentation for rubygems-update-2.6.7\nInstalling ri documentation for rubygems-update-2.6.7\nInstalling darkfish documentation for rubygems-update-2.6.7\nDone installing documentation for rubygems-update after 30 seconds\nParsing documentation for rubygems-update-2.6.7\nDone installing documentation for rubygems-update after 0 seconds\nInstalling RubyGems 2.6.7\nRubyGems 2.6.7 installed\nParsing documentation for rubygems-2.6.7\nInstalling ri documentation for rubygems-2.6.7\n\n\u3000(\u4e2d\u7565)\n\nRubyGems installed the following executables:\n        /usr/local/rbenv/versions/2.3.1/bin/gem\n\nRuby Interactive (ri) documentation was installed. ri is kind of like man\npages for ruby libraries. You may access it like this:\n  ri Classname\n  ri Classname.class_method\n  ri Classname#instance_method\nIf you do not wish to install this documentation in the future, use the\n--no-document flag, or set it as the default in your ~/.gemrc file. See\n'gem help env' for details.\n\nRubyGems system software updated\n#\n\n\n(18) gem\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# which gem\n/usr/local/rbenv/shims/gem\n#\n\n# gem -v\n2.6.7\n#\n\n\n(19) bundler\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# rbenv exec gem install bundler\nFetching: bundler-1.13.2.gem (100%)\nSuccessfully installed bundler-1.13.2\nParsing documentation for bundler-1.13.2\nInstalling ri documentation for bundler-1.13.2\nDone installing documentation for bundler after 4 seconds\n1 gem installed\n#\n\n# rbenv exec gem list\n\n*** LOCAL GEMS ***\n\nbigdecimal (default: 1.2.8)\nbundler (1.13.2)\ndid_you_mean (1.0.0)\nio-console (default: 0.4.5)\njson (default: 1.8.3)\nminitest (5.8.3)\nnet-telnet (0.1.1)\npower_assert (0.2.6)\npsych (default: 2.0.17)\nrake (10.4.2)\nrdoc (default: 4.2.1)\nrubygems-update (2.6.7)\ntest-unit (3.1.5)\n#\n\n\n(20) Sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\ngem\u3067sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# rbenv exec gem install sinatra\nFetching: rack-1.6.4.gem (100%)\nSuccessfully installed rack-1.6.4\nFetching: tilt-2.0.5.gem (100%)\nSuccessfully installed tilt-2.0.5\nFetching: rack-protection-1.5.3.gem (100%)\nSuccessfully installed rack-protection-1.5.3\nFetching: sinatra-1.4.7.gem (100%)\nSuccessfully installed sinatra-1.4.7\nParsing documentation for rack-1.6.4\nInstalling ri documentation for rack-1.6.4\nParsing documentation for tilt-2.0.5\nInstalling ri documentation for tilt-2.0.5\nParsing documentation for rack-protection-1.5.3\nInstalling ri documentation for rack-protection-1.5.3\nParsing documentation for sinatra-1.4.7\nInstalling ri documentation for sinatra-1.4.7\nDone installing documentation for rack, tilt, rack-protection, sinatra after 262 seconds\n4 gems installed\n#\n\n\n(21) sinatra-contrib\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\ngem\u3067sinatra-contrib\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n~]# rbenv exec gem install sinatra-contrib\nFetching: backports-3.6.8.gem (100%)\nSuccessfully installed backports-3.6.8\nFetching: rack-test-0.6.3.gem (100%)\nSuccessfully installed rack-test-0.6.3\nFetching: multi_json-1.12.1.gem (100%)\nSuccessfully installed multi_json-1.12.1\nFetching: sinatra-contrib-1.4.7.gem (100%)\nSuccessfully installed sinatra-contrib-1.4.7\nParsing documentation for backports-3.6.8\nInstalling ri documentation for backports-3.6.8\nParsing documentation for rack-test-0.6.3\nInstalling ri documentation for rack-test-0.6.3\nParsing documentation for multi_json-1.12.1\nInstalling ri documentation for multi_json-1.12.1\nParsing documentation for sinatra-contrib-1.4.7\nInstalling ri documentation for sinatra-contrib-1.4.7\nDone installing documentation for backports, rack-test, multi_json, sinatra-contrib after 2 seconds\n4 gems installed\n#\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fSinatra\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3068gem\u78ba\u8a8d\n\n(22) \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fSinatra\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3068gem list\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# rbenv exec gem list\n\n*** LOCAL GEMS ***\n\nbackports (3.6.8)\nbigdecimal (default: 1.2.8)\nbundler (1.13.2)\ndid_you_mean (1.0.0)\nio-console (default: 0.4.5)\njson (default: 1.8.3)\nminitest (5.8.3)\nmulti_json (1.12.1)\nnet-telnet (0.1.1)\npower_assert (0.2.6)\npsych (default: 2.0.17)\nrack (1.6.4)\nrack-protection (1.5.3)\nrack-test (0.6.3)\nrake (10.4.2)\nrdoc (default: 4.2.1)\nrubygems-update (2.6.7)\nsinatra (1.4.7)\nsinatra-contrib (1.4.7)\ntest-unit (3.1.5)\ntilt (2.0.5)\n#\n\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fSinatra\u304c\u52d5\u4f5c\u3059\u308b\u304b\u78ba\u8a8d\n\n(23) Sinatra\u52d5\u4f5c\u78ba\u8a8d\u7528\u306e\u30b3\u30fc\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n# mkdir /root/example_app\n\n# vi /root/example_app/example.rb\n\n\n/root/example_app/example.rb\nrequire 'rubygems'\nrequire 'sinatra'\nrequire 'sinatra/reloader'\n\nget '/' do\n  \"hello world Sinatra!\"\nend\n\n\n# ll /root/example_app/example.rb\n-rw-r--r-- 1 root root 105 Oct  2 20:32 /root/example_app/example.rb\n#\n\n# cat /root/example_app/example.rb\nrequire 'rubygems'\nrequire 'sinatra'\nrequire 'sinatra/reloader'\n\nget '/' do\n  \"hello world Sinatra!\"\nend\n#\n\n\n(24) Sinatra\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nSinatra\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n-o\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u300c0.0.0.0\u300d\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u3067localhost\u4ee5\u5916\u304b\u3089\u306e\u63a5\u7d9a\u3082\u53d7\u3051\u4ed8\u3051\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002-p\u30aa\u30d7\u30b7\u30e7\u30f3\u3067http(TCP/80\u756a\u30dd\u30fc\u30c8)\u306e\u63a5\u7d9a\u3092\u53d7\u3051\u4ed8\u3051\u308b\u3088\u3046\u306b\u3057\u3066\u3001Sinatra\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n# pwd\n/root\n#\n\n# ruby /root/example_app/example.rb -o 0.0.0.0 -p 80 &\n\n\n(25) Sinatra\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u8d77\u52d5\u3057\u305f\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n# ruby /root/example_app/example.rb -o 0.0.0.0 -p 80 &\n[1] 6316\n\n# [2016-10-02 20:27:27] INFO  WEBrick 1.3.1\n[2016-10-02 20:27:27] INFO  ruby 2.3.1 (2016-04-26) [x86_64-linux]\n== Sinatra (v1.4.7) has taken the stage on 80 for development with backup from WEBrick\n[2016-10-02 20:27:27] INFO  WEBrick::HTTPServer#start: pid=6316 port=80\n\u3000(Enter\u30ad\u30fc\u3092\u62bc\u4e0b\u3057\u307e\u3059)\n#\n\n# ps awux | grep -v grep | grep ruby\nroot      6316  0.2  2.1 406720 21424 pts/1    Sl   20:27   0:00 ruby /root/example_app/example.rb -o 0.0.0.0 -p 80\n#\n\n\n(26) Web\u30d6\u30e9\u30a6\u30b6\u304b\u3089Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d8\u306ehttp\u901a\u4fe1\u3092\u8a31\u53ef\u3057\u307e\u3059\u3002\nWeb\u30d6\u30e9\u30a6\u30b6\u304b\u3089Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fSinatra\u30d8\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u70ba\u3001Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u5272\u308a\u5f53\u3066\u3066\u3044\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u300cInbound\u300d\u30eb\u30fc\u30eb\u306b\u5bfe\u3057\u3066\u3001Web\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u3046PC\u304b\u3089\u306eHTTP(TCP/80\u756a\u30dd\u30fc\u30c8)\u901a\u4fe1\u8a31\u53ef\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n\n\n(27) Web\u30d6\u30e9\u30a6\u30b6\u304b\u3089Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d8\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\nWeb\u30d6\u30e9\u30a6\u30b6\u3092\u8d77\u52d5\u3057\u3001Sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fAmazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\u3000http://EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9/\n\u4ee5\u4e0b\u306e\u3088\u3046\u306bSinatra\u306e\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u3001Sinatra\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n\nSinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210(\u4efb\u610f)\n\n(28) Sinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3082\u3057\u5fc5\u8981\u3067\u3042\u308c\u3070\u3001Sinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# vi stop_sinatra.sh\n\n\nstop_sinatra.sh\n#!/bin/bash\n\nprocess_count=`ps awux | grep -v grep | grep ruby | awk '{print $2}' | wc -l`\n\nif [ $process_count -ge 0 ] ; then\n  kill `ps awux | grep -v grep | grep ruby | awk '{print $2}'`\nfi\n\n\nSinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306b\u5b9f\u884c\u6a29\u9650\u3092\u3064\u3051\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# chmod 755 stop_sinatra.sh\n[root@example-ruby-sinatra-server ~]#\n\n\n(29) Sinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u3067Sinatra\u3092\u505c\u6b62\u3057\u307e\u3059\u3002\nSinatra\u30d7\u30ed\u30bb\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# ps awux | grep -v grep | grep ruby\nroot      3434  0.3  1.9 204016 20336 pts/0    Sl   00:56   0:00 ruby /root/example_app/example.rb -o 0.0.0.0 -p 80\n[root@example-ruby-sinatra-server ~]#\n\nSinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# ./stop_sinatra.sh\n[root@example-ruby-sinatra-server ~]# == Sinatra has ended his set (crowd applauds)\n[2016-10-03 00:56:54] INFO  going to shutdown ...\n[2016-10-03 00:56:54] INFO  WEBrick::HTTPServer#start done.\n\n[root@example-ruby-sinatra-server ~]#\n\nSinatra\u30d7\u30ed\u30bb\u30b9\u304c\u505c\u6b62\u3057\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# ps awux | grep -v grep | grep ruby\n[root@example-ruby-sinatra-server ~]#\n\n\nSinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210(\u4efb\u610f)\n\n(30) Sinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3082\u3057\u5fc5\u8981\u3067\u3042\u308c\u3070\u3001Sinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# vi start_sinatra.sh\n\n\nstart_sinatra.sh\n#!/bin/bash\n\nsinatra_bin=\"/usr/local/rbenv/shims/ruby\"\nsinatra_file=\"/root/example_app/example.rb\"\nsinatra_listen_address=\"0.0.0.0\"\nsinatra_port=\"80\"\n\nif [ -f $ruby_bin ] && [ -f $ruby_file ] ; then\n    $sinatra_bin $sinatra_file -o $sinatra_listen_address -p $sinatra_port &\nfi\n\n\nSinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306b\u5b9f\u884c\u6a29\u9650\u3092\u3064\u3051\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# chmod 755 start_sinatra.sh\n[root@example-ruby-sinatra-server ~]#\n\n\n(31) Sinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3067Sinatra\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\nSinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# ps awux | grep -v grep | grep ruby\n[root@example-ruby-sinatra-server ~]#\n\n[root@example-ruby-sinatra-server ~]# ./start_sinatra.sh\n[root@example-ruby-sinatra-server ~]# [2016-10-03 01:11:48] INFO  WEBrick 1.3.1\n[2016-10-03 01:11:48] INFO  ruby 2.3.1 (2016-04-26) [x86_64-linux]\n== Sinatra (v1.4.7) has taken the stage on 80 for development with backup from WEBrick\n[2016-10-03 01:11:48] INFO  WEBrick::HTTPServer#start: pid=3778 port=80\n\n[root@example-ruby-sinatra-server ~]#\n\nSinatra\u30d7\u30ed\u30bb\u30b9\u304c\u8d77\u52d5\u3057\u307e\u3059\u3002\n[root@example-ruby-sinatra-server ~]# ps awux | grep -v grep | grep ruby\nroot      3778  4.6  2.0 203944 20512 pts/0    Sl   01:11   0:00 ruby /root/example_app/example.rb -o 0.0.0.0 -p 80\n[root@example-ruby-sinatra-server ~]#\n\n\n\u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3002\n\u306f\u3058\u3081\u306b\n===\n\nAmazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9(Amazon Linux)\u306bRuby Sinatra\u74b0\u5883\u3092\u69cb\u7bc9\u3059\u308b\u624b\u9806\u3067\u3059\u3002\n\nAmazon Linux\u306brbenv 1.0.0-33 + ruby-build + Ruby 2.3.1 + Sinatra 1.4.7\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\nEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u6642\u306b\u4f7f\u7528\u3057\u305fAMI\n===\n\nSinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308bEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u4ee5\u4e0b\u306eAMI\u3067\u4f5c\u6210\u3057\u307e\u3057\u305f\u3002\n\n\u30fbamzn-ami-hvm-2016.03.3.x86_64-gp2 (ami-374db956)\n\nRuby Sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u74b0\u5883\n===\n\n\u30fbAmazon Linux (4.4.19-29.55.amzn1.x86_64)\n\n```\n# uname -a\nLinux example-ruby-sinatra-server 4.4.19-29.55.amzn1.x86_64 #1 SMP Mon Aug 29 23:29:40 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n#\n```\n\n\u53c2\u8003\u30da\u30fc\u30b8\n===\n\n\u4ee5\u4e0b\u306e\u30da\u30fc\u30b8\u3092\u53c2\u8003\u306b\u3055\u305b\u3066\u9802\u304d\u307e\u3057\u305f\u3002\n\nhttps://github.com/sinatra/sinatra\n\nrbenv\u3092\u4f7f\u3063\u3066Sinatra\u306e\u5b9f\u884c\u74b0\u5883\u3092\u6574\u3048\u308b\u307e\u3067\nhttp://qiita.com/keita-nishimoto/items/8a89a176943a44adbebb\n\nRuby Sinatra\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttp://qiita.com/soushiy/items/8de8dfef5183fc3b515a\n\nAmazon Linux\u306bRuby on Rails\u74b0\u5883\u69cb\u7bc9(rbenv + ruby-build + Ruby 2.2.1 + Rails 4.2.1\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb)\nhttp://qiita.com/na0AaooQ/items/5bd62e630a2faf051a52\n\nAmazon Linux\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\n===\n\n## (1) Amazon Linux\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nAmazon Linux\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u4f5c\u6210\u6642\u3001User Data\u306b\u4ee5\u4e0b\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u3001EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```bash:UserData\n#!/bin/sh\n\necho \"User Data start\"\n\nyum -y update\n\nunalias cp\ncp -f -p /usr/share/zoneinfo/Japan /etc/localtime\n\ncat << _EOT_ > /etc/sysconfig/clock\nZONE=\"Asia/Tokyo\"\nUTC=false\n_EOT_\n\nchmod 644 /etc/sysconfig/clock\n\n/etc/init.d/crond restart\n\necho \"User Data end\"\n```\n\nAmazon Linux\u3078\u30d1\u30c3\u30b1\u30fc\u30b8\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n===\n\n## (2) Amazon Linux\u306eEC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u304c\u4f5c\u6210\u3055\u308c\u305f\u3089\u3001ec2-user\u3067\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3059\u3002\n\n## (3) git\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$ sudo su -\n# yum -y install git\n```\n\n## (4) Ruby\u3084Sinatra\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306b\u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# yum -y install gcc-c++ patch openssl-devel readline readline-devel libyaml-devel zlib zlib-devel libffi-devel make bzip2 autoconf automake libtool bison iconv-deve\n```\n\nrbenv\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n===\n\n## (5) rbenv\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# git clone https://github.com/sstephenson/rbenv.git /usr/local/rbenv\nCloning into '/usr/local/rbenv'...\nremote: Counting objects: 2542, done.\nremote: Total 2542 (delta 0), reused 0 (delta 0), pack-reused 2542\nReceiving objects: 100% (2542/2542), 461.51 KiB | 383.00 KiB/s, done.\nResolving deltas: 100% (1597/1597), done.\nChecking connectivity... done.\n#\n```\n\n## (6) rbenv\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# ls -lrta /usr/local/rbenv/\ntotal 80\ndrwxr-xr-x 13 root root  4096 Oct  2 19:31 ..\n-rw-r--r--  1 root root    35 Oct  2 19:31 .vimrc\n-rw-r--r--  1 root root   184 Oct  2 19:31 .travis.yml\ndrwxr-xr-x  2 root root  4096 Oct  2 19:31 src\n-rw-r--r--  1 root root 16571 Oct  2 19:31 README.md\ndrwxr-xr-x  3 root root  4096 Oct  2 19:31 rbenv.d\n-rw-r--r--  1 root root  1058 Oct  2 19:31 LICENSE\ndrwxr-xr-x  2 root root  4096 Oct  2 19:31 libexec\n-rw-r--r--  1 root root    97 Oct  2 19:31 .gitignore\n-rw-r--r--  1 root root  3390 Oct  2 19:31 CONDUCT.md\ndrwxr-xr-x  2 root root  4096 Oct  2 19:31 completions\ndrwxr-xr-x  2 root root  4096 Oct  2 19:31 bin\n-rw-r--r--  1 root root    19 Oct  2 19:31 .agignore\ndrwxr-xr-x  9 root root  4096 Oct  2 19:31 .\ndrwxr-xr-x  3 root root  4096 Oct  2 19:31 test\ndrwxr-xr-x  8 root root  4096 Oct  2 19:31 .git\n#\n```\n\nRBENV_ROOT\u74b0\u5883\u5909\u6570\u306e\u8ffd\u52a0\n===\n\n## (7) rbenv\u7528\u306e\u74b0\u5883\u5909\u6570\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```\n# cp -p /etc/profile /etc/profile.ORG\n# diff /etc/profile /etc/profile.ORG\n#\n```\n\n```\n# echo 'export RBENV_ROOT=\"/usr/local/rbenv\"' >> /etc/profile\n# echo 'export PATH=\"${RBENV_ROOT}/bin:${PATH}\"' >> /etc/profile\n# echo 'eval \"$(rbenv init -)\"' >> /etc/profile\n```\n\nRBENV_ROOT\u74b0\u5883\u5909\u6570\u306e\u6709\u52b9\u5316\u3084rbenv init\u5b9f\u884c\n===\n\n## (8) rbenv\u7528\u306e\u74b0\u5883\u5909\u6570\u3092\u8aad\u307f\u8fbc\u307f\u3001rbenv init\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n# source /etc/profile\n```\n\n```\n# su - root\n```\n\n```\n# env | grep RBENV\nRBENV_ROOT=/usr/local/rbenv\nRBENV_SHELL=bash\n#\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305frbenv\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n===\n\n## (9) \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305frbenv\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# which rbenv\n/usr/local/rbenv/bin/rbenv\n#\n```\n\n```\n# rbenv --version\nrbenv 1.0.0-33-gc7dcaf1\n#\n```\n\nruby-build\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n===\n\n## (10) ruby-build\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\nrbenv install\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\u70ba\u3001rbenv\u306e\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3042\u308bruby-build\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# git clone https://github.com/sstephenson/ruby-build.git /usr/local/rbenv/plugins/ruby-build\nCloning into '/usr/local/rbenv/plugins/ruby-build'...\nremote: Counting objects: 6981, done.\nremote: Total 6981 (delta 0), reused 0 (delta 0), pack-reused 6981\nReceiving objects: 100% (6981/6981), 1.35 MiB | 614.00 KiB/s, done.\nResolving deltas: 100% (4152/4152), done.\nChecking connectivity... done.\n#\n```\n\n## (11) ruby-build\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# ls -lrta /usr/local/rbenv/plugins/ruby-build\ntotal 56\ndrwxr-xr-x 3 root root 4096 Oct  2 19:38 ..\n-rw-r--r-- 1 root root  474 Oct  2 19:38 .travis.yml\ndrwxr-xr-x 3 root root 4096 Oct  2 19:38 share\ndrwxr-xr-x 2 root root 4096 Oct  2 19:38 script\n-rw-r--r-- 1 root root 8799 Oct  2 19:38 README.md\n-rw-r--r-- 1 root root 1063 Oct  2 19:38 LICENSE\n-rwxr-xr-x 1 root root  357 Oct  2 19:38 install.sh\n-rw-r--r-- 1 root root 3390 Oct  2 19:38 CONDUCT.md\ndrwxr-xr-x 2 root root 4096 Oct  2 19:38 bin\ndrwxr-xr-x 7 root root 4096 Oct  2 19:38 .\ndrwxr-xr-x 5 root root 4096 Oct  2 19:38 test\ndrwxr-xr-x 8 root root 4096 Oct  2 19:38 .git\n#\n```\n\nRuby 2.3.1\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n===\n\n## (12) \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ef\u80fd\u306aRuby\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# rbenv install -l\nAvailable versions:\n  1.8.5-p113\n  1.8.5-p114\n\u3000 (\u4e2d\u7565)\n  2.3.0\n  2.3.1\u3000\u2192\u3000\u3053\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n  2.4.0-dev\n  2.4.0-preview1\n  2.4.0-preview2\n  jruby-1.5.6\n  jruby-1.6.3\n\u3000 (\u4e2d\u7565)\n  ree-1.8.7-2011.12\n  ree-1.8.7-2012.01\n  ree-1.8.7-2012.02\n  topaz-dev\n#\n```\n\n## (13) Ruby 2.3.1\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# rbenv install -v 2.3.1\n```\n\n## (14) Ruby 2.3.1\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304c\u5b8c\u4e86\u3059\u308b\u307e\u3067\u5f85\u3061\u307e\u3059\u3002\n\nAmazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306et2.micro\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5834\u5408\u3001\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u5b8c\u4e86\u307e\u30675\u5206\u7a0b\u304b\u304b\u308a\u307e\u3059\u306e\u3067\u5c11\u3005\u5f85\u3061\u307e\u3059\u3002\n\n```\n# rbenv install -v 2.3.1\n/tmp/ruby-build.20161002194712.3034 ~\nDownloading ruby-2.3.1.tar.bz2...\n-> https://cache.ruby-lang.org/pub/ruby/2.3/ruby-2.3.1.tar.bz2\nInstalling ruby-2.3.1...\n/tmp/ruby-build.20161002194712.3034/ruby-2.3.1 /tmp/ruby-build.20161002194712.3034 ~\nchecking for ruby... /usr/bin/ruby\nconfig.guess already exists\nconfig.sub already exists\nchecking build system type... x86_64-pc-linux-gnu\nchecking host system type... x86_64-pc-linux-gnu\nchecking target system type... x86_64-pc-linux-gnu\nchecking for gcc... gcc\n\n\u3000(\u4e2d\u7565)\n\ninstalling rdoc:              /usr/local/rbenv/versions/2.3.1/share/ri/2.3.0/system\ninstalling capi-docs:         /usr/local/rbenv/versions/2.3.1/share/doc/ruby\nInstalled ruby-2.3.1 to /usr/local/rbenv/versions/2.3.1\n\n/tmp/ruby-build.20161002194712.3034 ~\n~\n#\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fRuby\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n===\n\n## (15) Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u74b0\u5883\u5168\u4f53\u306eRuby\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fRuby 2.3.1\u3078\u5207\u308a\u66ff\u3048\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# rbenv rehash\n# rbenv global 2.3.1\n#\n```\n\n## (16) Ruby 2.3.1\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# which ruby\n/usr/local/rbenv/shims/ruby\n#\n```\n\n```\n# ruby -v\nruby 2.3.1p112 (2016-04-26 revision 54768) [x86_64-linux]\n#\n```\n\nSinatra\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n===\n\n## (17) gem\u3092\u6700\u65b0\u306b\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3057\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# rbenv exec gem update --system\nUpdating rubygems-update\nFetching: rubygems-update-2.6.7.gem (100%)\nSuccessfully installed rubygems-update-2.6.7\nParsing documentation for rubygems-update-2.6.7\nInstalling ri documentation for rubygems-update-2.6.7\nInstalling darkfish documentation for rubygems-update-2.6.7\nDone installing documentation for rubygems-update after 30 seconds\nParsing documentation for rubygems-update-2.6.7\nDone installing documentation for rubygems-update after 0 seconds\nInstalling RubyGems 2.6.7\nRubyGems 2.6.7 installed\nParsing documentation for rubygems-2.6.7\nInstalling ri documentation for rubygems-2.6.7\n\n\u3000(\u4e2d\u7565)\n\nRubyGems installed the following executables:\n        /usr/local/rbenv/versions/2.3.1/bin/gem\n\nRuby Interactive (ri) documentation was installed. ri is kind of like man\npages for ruby libraries. You may access it like this:\n  ri Classname\n  ri Classname.class_method\n  ri Classname#instance_method\nIf you do not wish to install this documentation in the future, use the\n--no-document flag, or set it as the default in your ~/.gemrc file. See\n'gem help env' for details.\n\nRubyGems system software updated\n#\n```\n\n## (18) gem\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# which gem\n/usr/local/rbenv/shims/gem\n#\n```\n\n```\n# gem -v\n2.6.7\n#\n```\n\n\n## (19) bundler\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# rbenv exec gem install bundler\nFetching: bundler-1.13.2.gem (100%)\nSuccessfully installed bundler-1.13.2\nParsing documentation for bundler-1.13.2\nInstalling ri documentation for bundler-1.13.2\nDone installing documentation for bundler after 4 seconds\n1 gem installed\n#\n```\n\n```\n# rbenv exec gem list\n\n*** LOCAL GEMS ***\n\nbigdecimal (default: 1.2.8)\nbundler (1.13.2)\ndid_you_mean (1.0.0)\nio-console (default: 0.4.5)\njson (default: 1.8.3)\nminitest (5.8.3)\nnet-telnet (0.1.1)\npower_assert (0.2.6)\npsych (default: 2.0.17)\nrake (10.4.2)\nrdoc (default: 4.2.1)\nrubygems-update (2.6.7)\ntest-unit (3.1.5)\n#\n```\n\n## (20) Sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\ngem\u3067sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# rbenv exec gem install sinatra\nFetching: rack-1.6.4.gem (100%)\nSuccessfully installed rack-1.6.4\nFetching: tilt-2.0.5.gem (100%)\nSuccessfully installed tilt-2.0.5\nFetching: rack-protection-1.5.3.gem (100%)\nSuccessfully installed rack-protection-1.5.3\nFetching: sinatra-1.4.7.gem (100%)\nSuccessfully installed sinatra-1.4.7\nParsing documentation for rack-1.6.4\nInstalling ri documentation for rack-1.6.4\nParsing documentation for tilt-2.0.5\nInstalling ri documentation for tilt-2.0.5\nParsing documentation for rack-protection-1.5.3\nInstalling ri documentation for rack-protection-1.5.3\nParsing documentation for sinatra-1.4.7\nInstalling ri documentation for sinatra-1.4.7\nDone installing documentation for rack, tilt, rack-protection, sinatra after 262 seconds\n4 gems installed\n#\n```\n\n## (21) sinatra-contrib\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\ngem\u3067sinatra-contrib\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n~]# rbenv exec gem install sinatra-contrib\nFetching: backports-3.6.8.gem (100%)\nSuccessfully installed backports-3.6.8\nFetching: rack-test-0.6.3.gem (100%)\nSuccessfully installed rack-test-0.6.3\nFetching: multi_json-1.12.1.gem (100%)\nSuccessfully installed multi_json-1.12.1\nFetching: sinatra-contrib-1.4.7.gem (100%)\nSuccessfully installed sinatra-contrib-1.4.7\nParsing documentation for backports-3.6.8\nInstalling ri documentation for backports-3.6.8\nParsing documentation for rack-test-0.6.3\nInstalling ri documentation for rack-test-0.6.3\nParsing documentation for multi_json-1.12.1\nInstalling ri documentation for multi_json-1.12.1\nParsing documentation for sinatra-contrib-1.4.7\nInstalling ri documentation for sinatra-contrib-1.4.7\nDone installing documentation for backports, rack-test, multi_json, sinatra-contrib after 2 seconds\n4 gems installed\n#\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fSinatra\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3068gem\u78ba\u8a8d\n===\n\n## (22) \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fSinatra\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3068gem list\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# rbenv exec gem list\n\n*** LOCAL GEMS ***\n\nbackports (3.6.8)\nbigdecimal (default: 1.2.8)\nbundler (1.13.2)\ndid_you_mean (1.0.0)\nio-console (default: 0.4.5)\njson (default: 1.8.3)\nminitest (5.8.3)\nmulti_json (1.12.1)\nnet-telnet (0.1.1)\npower_assert (0.2.6)\npsych (default: 2.0.17)\nrack (1.6.4)\nrack-protection (1.5.3)\nrack-test (0.6.3)\nrake (10.4.2)\nrdoc (default: 4.2.1)\nrubygems-update (2.6.7)\nsinatra (1.4.7)\nsinatra-contrib (1.4.7)\ntest-unit (3.1.5)\ntilt (2.0.5)\n#\n```\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fSinatra\u304c\u52d5\u4f5c\u3059\u308b\u304b\u78ba\u8a8d\n===\n\n## (23) Sinatra\u52d5\u4f5c\u78ba\u8a8d\u7528\u306e\u30b3\u30fc\u30c9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n# mkdir /root/example_app\n```\n\n```\n# vi /root/example_app/example.rb\n```\n\n```ruby:/root/example_app/example.rb\nrequire 'rubygems'\nrequire 'sinatra'\nrequire 'sinatra/reloader'\n\nget '/' do\n  \"hello world Sinatra!\"\nend\n```\n\n```\n# ll /root/example_app/example.rb\n-rw-r--r-- 1 root root 105 Oct  2 20:32 /root/example_app/example.rb\n#\n```\n\n```\n# cat /root/example_app/example.rb\nrequire 'rubygems'\nrequire 'sinatra'\nrequire 'sinatra/reloader'\n\nget '/' do\n  \"hello world Sinatra!\"\nend\n#\n```\n\n## (24) Sinatra\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\nSinatra\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n-o\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u300c0.0.0.0\u300d\u3092\u6307\u5b9a\u3059\u308b\u4e8b\u3067localhost\u4ee5\u5916\u304b\u3089\u306e\u63a5\u7d9a\u3082\u53d7\u3051\u4ed8\u3051\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002-p\u30aa\u30d7\u30b7\u30e7\u30f3\u3067http(TCP/80\u756a\u30dd\u30fc\u30c8)\u306e\u63a5\u7d9a\u3092\u53d7\u3051\u4ed8\u3051\u308b\u3088\u3046\u306b\u3057\u3066\u3001Sinatra\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n# pwd\n/root\n#\n```\n\n```\n# ruby /root/example_app/example.rb -o 0.0.0.0 -p 80 &\n```\n\n## (25) Sinatra\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u8d77\u52d5\u3057\u305f\u4e8b\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n# ruby /root/example_app/example.rb -o 0.0.0.0 -p 80 &\n[1] 6316\n\n# [2016-10-02 20:27:27] INFO  WEBrick 1.3.1\n[2016-10-02 20:27:27] INFO  ruby 2.3.1 (2016-04-26) [x86_64-linux]\n== Sinatra (v1.4.7) has taken the stage on 80 for development with backup from WEBrick\n[2016-10-02 20:27:27] INFO  WEBrick::HTTPServer#start: pid=6316 port=80\n\u3000(Enter\u30ad\u30fc\u3092\u62bc\u4e0b\u3057\u307e\u3059)\n#\n```\n\n```\n# ps awux | grep -v grep | grep ruby\nroot      6316  0.2  2.1 406720 21424 pts/1    Sl   20:27   0:00 ruby /root/example_app/example.rb -o 0.0.0.0 -p 80\n#\n```\n\n## (26) Web\u30d6\u30e9\u30a6\u30b6\u304b\u3089Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d8\u306ehttp\u901a\u4fe1\u3092\u8a31\u53ef\u3057\u307e\u3059\u3002\n\nWeb\u30d6\u30e9\u30a6\u30b6\u304b\u3089Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fSinatra\u30d8\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u70ba\u3001Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306b\u5272\u308a\u5f53\u3066\u3066\u3044\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30b0\u30eb\u30fc\u30d7\u306e\u300cInbound\u300d\u30eb\u30fc\u30eb\u306b\u5bfe\u3057\u3066\u3001Web\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u3046PC\u304b\u3089\u306eHTTP(TCP/80\u756a\u30dd\u30fc\u30c8)\u901a\u4fe1\u8a31\u53ef\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n![WS000058.JPG](https://qiita-image-store.s3.amazonaws.com/0/63647/b62e3404-e394-f77d-d963-8518747759ba.jpeg)\n\n![WS000057.JPG](https://qiita-image-store.s3.amazonaws.com/0/63647/aa6e718b-daf4-f776-35f1-3b282519532a.jpeg)\n\n## (27) Web\u30d6\u30e9\u30a6\u30b6\u304b\u3089Amazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u30d8\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\nWeb\u30d6\u30e9\u30a6\u30b6\u3092\u8d77\u52d5\u3057\u3001Sinatra\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305fAmazon EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9\u3092\u6307\u5b9a\u3057\u3066\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002\n\n\u3000http://EC2\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306eIP\u30a2\u30c9\u30ec\u30b9/\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306bSinatra\u306e\u30da\u30fc\u30b8\u304c\u8868\u793a\u3055\u308c\u308c\u3070\u3001Sinatra\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306f\u5b8c\u4e86\u3067\u3059\u3002\n\n![WS000056.JPG](https://qiita-image-store.s3.amazonaws.com/0/63647/08ceaf68-6952-e762-c96e-3a6be6d1dc35.jpeg)\n\nSinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210(\u4efb\u610f)\n===\n\n## (28) Sinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u3082\u3057\u5fc5\u8981\u3067\u3042\u308c\u3070\u3001Sinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# vi stop_sinatra.sh\n```\n\n```bash:stop_sinatra.sh\n#!/bin/bash\n\nprocess_count=`ps awux | grep -v grep | grep ruby | awk '{print $2}' | wc -l`\n\nif [ $process_count -ge 0 ] ; then\n  kill `ps awux | grep -v grep | grep ruby | awk '{print $2}'`\nfi\n```\n\nSinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306b\u5b9f\u884c\u6a29\u9650\u3092\u3064\u3051\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# chmod 755 stop_sinatra.sh\n[root@example-ruby-sinatra-server ~]#\n```\n\n## (29) Sinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u3067Sinatra\u3092\u505c\u6b62\u3057\u307e\u3059\u3002\n\nSinatra\u30d7\u30ed\u30bb\u30b9\u304c\u8d77\u52d5\u3057\u3066\u3044\u308b\u3068\u3057\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# ps awux | grep -v grep | grep ruby\nroot      3434  0.3  1.9 204016 20336 pts/0    Sl   00:56   0:00 ruby /root/example_app/example.rb -o 0.0.0.0 -p 80\n[root@example-ruby-sinatra-server ~]#\n```\n\nSinatra\u505c\u6b62\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# ./stop_sinatra.sh\n[root@example-ruby-sinatra-server ~]# == Sinatra has ended his set (crowd applauds)\n[2016-10-03 00:56:54] INFO  going to shutdown ...\n[2016-10-03 00:56:54] INFO  WEBrick::HTTPServer#start done.\n\n[root@example-ruby-sinatra-server ~]#\n```\n\nSinatra\u30d7\u30ed\u30bb\u30b9\u304c\u505c\u6b62\u3057\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# ps awux | grep -v grep | grep ruby\n[root@example-ruby-sinatra-server ~]#\n```\n\n\nSinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210(\u4efb\u610f)\n===\n\n## (30) Sinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u3082\u3057\u5fc5\u8981\u3067\u3042\u308c\u3070\u3001Sinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# vi start_sinatra.sh\n```\n\n```bash:start_sinatra.sh\n#!/bin/bash\n\nsinatra_bin=\"/usr/local/rbenv/shims/ruby\"\nsinatra_file=\"/root/example_app/example.rb\"\nsinatra_listen_address=\"0.0.0.0\"\nsinatra_port=\"80\"\n\nif [ -f $ruby_bin ] && [ -f $ruby_file ] ; then\n    $sinatra_bin $sinatra_file -o $sinatra_listen_address -p $sinatra_port &\nfi\n```\n\nSinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30d1\u30fc\u30df\u30c3\u30b7\u30e7\u30f3\u306b\u5b9f\u884c\u6a29\u9650\u3092\u3064\u3051\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# chmod 755 start_sinatra.sh\n[root@example-ruby-sinatra-server ~]#\n```\n\n## (31) Sinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3067Sinatra\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\n\nSinatra\u8d77\u52d5\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# ps awux | grep -v grep | grep ruby\n[root@example-ruby-sinatra-server ~]#\n```\n\n```\n[root@example-ruby-sinatra-server ~]# ./start_sinatra.sh\n[root@example-ruby-sinatra-server ~]# [2016-10-03 01:11:48] INFO  WEBrick 1.3.1\n[2016-10-03 01:11:48] INFO  ruby 2.3.1 (2016-04-26) [x86_64-linux]\n== Sinatra (v1.4.7) has taken the stage on 80 for development with backup from WEBrick\n[2016-10-03 01:11:48] INFO  WEBrick::HTTPServer#start: pid=3778 port=80\n\n[root@example-ruby-sinatra-server ~]#\n```\n\nSinatra\u30d7\u30ed\u30bb\u30b9\u304c\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n[root@example-ruby-sinatra-server ~]# ps awux | grep -v grep | grep ruby\nroot      3778  4.6  2.0 203944 20512 pts/0    Sl   01:11   0:00 ruby /root/example_app/example.rb -o 0.0.0.0 -p 80\n[root@example-ruby-sinatra-server ~]#\n```\n\n***\n\n\u4ee5\u4e0a\u306b\u306a\u308a\u307e\u3059\u3002\n\n", "tags": ["Ruby", "Sinatra", "AWS", "ruby-build", "rbenv"]}