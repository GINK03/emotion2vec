{"context": "\n\n \u304a\u984c\nSlack\u306eSlash\u30b3\u30de\u30f3\u30c9\u3067\u3001\u6614\u61d0\u304b\u3057\u3044\u30b2\u30fc\u30e0\u98a8\u306eEmoji\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u751f\u6210\u3057\u307e\u3059\u3002\nWeb\u30b5\u30fc\u30d3\u30b9\u5074\u306f Google Apps Script \u3067\u5b9f\u88c5\u3057\u307e\u3059\u3002\nSlack\u306e\u5916\u90e8Integration\u306e\u7121\u6599\u67a0\u3068\nGoogle Apps Script\u3067\u5b9f\u73fe\u53ef\u80fd\u306a\u304a\u624b\u8efd\u69cb\u6210\u3067\u3059\u3002\n\n Google Apps Script \u306e\u5b9f\u88c5\n\n \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\n\n Underscore.js \u3092\u8ffd\u52a0\nM3i7wmUA_5n0NSEaa6NnNqOBao7QLBR4j \u3067\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u691c\u7d22\u3057\u3001Underscore \u3092\u8ffd\u52a0\u3057\u307e\u3059\n\n\n \u30b3\u30fc\u30c9\nfunction doGet(e) {\n  var _ = Underscore.load();\n  r = Math.random()\n  var game;\n  if (r > 0.5) {\n    game = bomb(_);\n  } else {\n    game = dokan(_);\n  }\n  var res = {\"text\": game};\n  return ContentService.createTextOutput(JSON.stringify(res)).setMimeType(ContentService.MimeType.JSON);\n}\n\nfunction bomb(_) {\n  var bombTemplate = \"<%=parts[0]%>:black_large_square:<%=parts[1]%>:black_large_square:<%=parts[2]%>\\n\" +\n    \"<%=parts[3]%><%=parts[4]%><%=parts[5]%><%=parts[6]%><%=parts[7]%>\\n\" +\n    \"<%=parts[8]%>:black_large_square:<%=parts[9]%>:black_large_square:<%=parts[10]%>\\n\" +\n    \"<%=parts[11]%><%=parts[12]%><%=parts[13]%><%=parts[14]%><%=parts[15]%>\\n\" +\n    \"<%=parts[16]%>:black_large_square:<%=parts[17]%>:black_large_square:<%=parts[18]%>\\n\";\n  var parts = [\":bomb:\", \":fire:\", \":skull:\", \":hole:\", \":ghost:\", \":japanese_goblin:\", \":moyai:\", \":dragon:\", \":athletic_shoe:\"];\n  parts = _.sample(parts, 7);\n  parts.push(\":walking:\");\n  parts.push(\":key:\");\n  parts.push(\":door:\");\n  for (var i = 0;i<10;i++) {\n    parts.push(\":grey_question:\");    \n  }\n  parts = _.shuffle(parts)\n  var t = _.template(bombTemplate);\n  var result = t({parts: parts});\n  return result;\n}\n\nfunction dokan(_) {\n  var dokanTemplate = \":cloud::cloud::cloud::cloud:<%=sunMoon%>:cloud::cloud:\\n\" +\n    \":large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle:\\n\" +\n    \":large_blue_circle::large_blue_circle:<%=onQuestionBlock%><%=onBlockEnemy1%>:large_blue_circle::large_blue_circle::large_blue_circle:\\n\" +\n    \":large_blue_circle::black_large_square::question::black_large_square::large_blue_circle::large_blue_circle::japanese_castle:\\n\" +\n    \":large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::black_large_square::black_large_square:\\n\" +\n    \":runner::large_blue_circle::large_blue_circle:<%=onBlockEnemy2%>:black_large_square::black_large_square::black_large_square:\\n\" +\n    \":black_large_square::large_blue_circle::large_blue_circle::black_large_square::black_large_square::black_large_square::black_large_square:\\n\"\n\n  var sunMoon = sunMoonSample(_);\n  var onQuestionBlock = onQuestionBlockSample(_);\n  var onBlockEnemy1 = onBlockEnemySample(_);\n  var onBlockEnemy2 = onBlockEnemySample(_);\n\n  var t = _.template(dokanTemplate);\n  var result = t({sunMoon: sunMoon, onQuestionBlock: onQuestionBlock, onBlockEnemy1: onBlockEnemy1, onBlockEnemy2: onBlockEnemy2});\n  return result;\n}\n\nfunction sunMoonSample(_) {\n  return _.sample([\":sunny:\", \":crescent_moon:\"]);\n}\n\nfunction onQuestionBlockSample(_) {\n  return _.sample([\":mushroom:\", \":star2:\", \":seedling:\"]);\n}\n\nfunction onBlockEnemySample(_) {\n  return _.sample([\":turtle:\", \":blowfish:\", \":fire:\"]);\n}\n\n\n \u516c\u958b\u8a2d\u5b9a\nSlack \u306e Slash \u30b3\u30de\u30f3\u30c9\u3068 Google Apps Script \u306e\u9023\u643a\u8a2d\u5b9a\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\nSlack\u306eSlash Commands+Google Apps Script\u3067\u7121\u6599\u3067\u7121\u6599\u30dc\u30c3\u30c8\u751f\u6d3b - Tbpgr Blog\n\n \u30c7\u30e2\n/ossan_hoihoi \u30b3\u30de\u30f3\u30c9\u3067\u5b9f\u884c\u53ef\u80fd\u3067\u3059\n\n\n \u96d1\u611f\n\u30db\u30a4\u30db\u30a4\u3067\u304d\u305f\u306e\u3060\u308d\u3046\u304b\uff1f\n\n \u95a2\u9023\u8cc7\u6599\n\nGAS\u3067Spreadsheet\u306e\u7bc4\u56f2\u53d6\u5f97\u6642\u306eTips\nsimula-innovation/gas-underscore - GitHub\nUnderscore.js\n\n\nAdvent Calendar\n\u660e\u65e5\u306f \u7d75\u3092\u63cf\u304fWeb\u30c7\u30b6\u30a4\u30ca\u30fc\u306e\u6e4a\u5ddd\u3042\u3044( @llminatoll ) \u3055\u3093\u3067\u3059\uff01\n## <i class='fa fa-gamepad'></i> \u304a\u984c\nSlack\u306eSlash\u30b3\u30de\u30f3\u30c9\u3067\u3001\u6614\u61d0\u304b\u3057\u3044\u30b2\u30fc\u30e0\u98a8\u306eEmoji\u3092\u30e9\u30f3\u30c0\u30e0\u306b\u751f\u6210\u3057\u307e\u3059\u3002\nWeb\u30b5\u30fc\u30d3\u30b9\u5074\u306f Google Apps Script \u3067\u5b9f\u88c5\u3057\u307e\u3059\u3002\n\nSlack\u306e\u5916\u90e8Integration\u306e\u7121\u6599\u67a0\u3068\nGoogle Apps Script\u3067\u5b9f\u73fe\u53ef\u80fd\u306a\u304a\u624b\u8efd\u69cb\u6210\u3067\u3059\u3002\n\n## <i class='fa fa-chrome'></i> Google Apps Script \u306e\u5b9f\u88c5\n### <i class='fa fa-book'></i> \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u8ffd\u52a0\n#### <i class='fa fa-plus-square'></i> Underscore.js \u3092\u8ffd\u52a0\n`M3i7wmUA_5n0NSEaa6NnNqOBao7QLBR4j` \u3067\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u691c\u7d22\u3057\u3001Underscore \u3092\u8ffd\u52a0\u3057\u307e\u3059\n\n![gas_add_library.png](https://qiita-image-store.s3.amazonaws.com/0/43480/6022cb51-78a2-21eb-0bc3-6660766dd0fd.png)\n\n### <i class='fa fa-code'></i> \u30b3\u30fc\u30c9\n```javascripot\nfunction doGet(e) {\n  var _ = Underscore.load();\n  r = Math.random()\n  var game;\n  if (r > 0.5) {\n    game = bomb(_);\n  } else {\n    game = dokan(_);\n  }\n  var res = {\"text\": game};\n  return ContentService.createTextOutput(JSON.stringify(res)).setMimeType(ContentService.MimeType.JSON);\n}\n\nfunction bomb(_) {\n  var bombTemplate = \"<%=parts[0]%>:black_large_square:<%=parts[1]%>:black_large_square:<%=parts[2]%>\\n\" +\n    \"<%=parts[3]%><%=parts[4]%><%=parts[5]%><%=parts[6]%><%=parts[7]%>\\n\" +\n    \"<%=parts[8]%>:black_large_square:<%=parts[9]%>:black_large_square:<%=parts[10]%>\\n\" +\n    \"<%=parts[11]%><%=parts[12]%><%=parts[13]%><%=parts[14]%><%=parts[15]%>\\n\" +\n    \"<%=parts[16]%>:black_large_square:<%=parts[17]%>:black_large_square:<%=parts[18]%>\\n\";\n  var parts = [\":bomb:\", \":fire:\", \":skull:\", \":hole:\", \":ghost:\", \":japanese_goblin:\", \":moyai:\", \":dragon:\", \":athletic_shoe:\"];\n  parts = _.sample(parts, 7);\n  parts.push(\":walking:\");\n  parts.push(\":key:\");\n  parts.push(\":door:\");\n  for (var i = 0;i<10;i++) {\n    parts.push(\":grey_question:\");    \n  }\n  parts = _.shuffle(parts)\n  var t = _.template(bombTemplate);\n  var result = t({parts: parts});\n  return result;\n}\n\nfunction dokan(_) {\n  var dokanTemplate = \":cloud::cloud::cloud::cloud:<%=sunMoon%>:cloud::cloud:\\n\" +\n    \":large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle:\\n\" +\n    \":large_blue_circle::large_blue_circle:<%=onQuestionBlock%><%=onBlockEnemy1%>:large_blue_circle::large_blue_circle::large_blue_circle:\\n\" +\n    \":large_blue_circle::black_large_square::question::black_large_square::large_blue_circle::large_blue_circle::japanese_castle:\\n\" +\n    \":large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::large_blue_circle::black_large_square::black_large_square:\\n\" +\n    \":runner::large_blue_circle::large_blue_circle:<%=onBlockEnemy2%>:black_large_square::black_large_square::black_large_square:\\n\" +\n    \":black_large_square::large_blue_circle::large_blue_circle::black_large_square::black_large_square::black_large_square::black_large_square:\\n\"\n\n  var sunMoon = sunMoonSample(_);\n  var onQuestionBlock = onQuestionBlockSample(_);\n  var onBlockEnemy1 = onBlockEnemySample(_);\n  var onBlockEnemy2 = onBlockEnemySample(_);\n\n  var t = _.template(dokanTemplate);\n  var result = t({sunMoon: sunMoon, onQuestionBlock: onQuestionBlock, onBlockEnemy1: onBlockEnemy1, onBlockEnemy2: onBlockEnemy2});\n  return result;\n}\n\nfunction sunMoonSample(_) {\n  return _.sample([\":sunny:\", \":crescent_moon:\"]);\n}\n\nfunction onQuestionBlockSample(_) {\n  return _.sample([\":mushroom:\", \":star2:\", \":seedling:\"]);\n}\n\nfunction onBlockEnemySample(_) {\n  return _.sample([\":turtle:\", \":blowfish:\", \":fire:\"]);\n}\n```\n\n### <i class='fa fa-globe'></i> \u516c\u958b\u8a2d\u5b9a\nSlack \u306e Slash \u30b3\u30de\u30f3\u30c9\u3068 Google Apps Script \u306e\u9023\u643a\u8a2d\u5b9a\u306b\u3064\u3044\u3066\u306f\u4ee5\u4e0b\u3092\u53c2\u7167\u304f\u3060\u3055\u3044\n\n[Slack\u306eSlash Commands+Google Apps Script\u3067\u7121\u6599\u3067\u7121\u6599\u30dc\u30c3\u30c8\u751f\u6d3b - Tbpgr Blog](http://tbpgr.hatenablog.com/entry/2016/11/25/234846)\n\n## <i class='fa fa-flask'></i> \u30c7\u30e2\n`/ossan_hoihoi` \u30b3\u30de\u30f3\u30c9\u3067\u5b9f\u884c\u53ef\u80fd\u3067\u3059\n\n![ossan_hoihoi.gif](https://qiita-image-store.s3.amazonaws.com/0/43480/ca6e6df2-c403-c8b3-5faa-e1bdb69e42ef.gif)\n\n## <i class=\"fa fa-comments-o\" style=\"font-size:1em;\"></i> \u96d1\u611f\n\u30db\u30a4\u30db\u30a4\u3067\u304d\u305f\u306e\u3060\u308d\u3046\u304b\uff1f\n\n## <i class='fa fa-book'></i> \u95a2\u9023\u8cc7\u6599\n* [GAS\u3067Spreadsheet\u306e\u7bc4\u56f2\u53d6\u5f97\u6642\u306eTips](http://hhmmm.hateblo.jp/entry/2016/04/11/181203)\n* [simula-innovation/gas-underscore - GitHub](https://github.com/simula-innovation/gas-underscore)\n* [Underscore.js](http://underscorejs.org/#shuffle)\n\n## Advent Calendar\n\u660e\u65e5\u306f **\u7d75\u3092\u63cf\u304fWeb\u30c7\u30b6\u30a4\u30ca\u30fc\u306e\u6e4a\u5ddd\u3042\u3044( @llminatoll )** \u3055\u3093\u3067\u3059\uff01\n", "tags": ["emoji", "Slack", "GoogleAppsScript"]}