{"context": " More than 1 year has passed since last update.\n\n\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\nRoutefile\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\nvpc_id = \"vpc-xxxxxxxx\"\nregion = \"ap-northeast-1\"\nzone = \"route53.local.\"\nhosted_zone zone do\n  vpc region, vpc_id\n\n  AWS::EC2.new(region: region).vpcs[vpc_id].instances.each {|instance|\n    next if instance.tags.Name == nil\n    next if instance.tags.Name.empty?\n    rrset \"#{instance.tags.Name}.#{zone}\", \"A\" do\n      ttl 60\n      resource_records instance.private_ip_address\n    end\n  }\n\n  AWS::RDS.new(region: region).instances.to_a.each do |instance|\n    rrset \"#{instance.db_instance_identifier}.#{zone}\", \"CNAME\" do\n      ttl 60\n      resource_records(\n        instance.endpoint_address\n      )\n    end\n  end\n\n  AWS::ElastiCache.new(region: region).client.describe_cache_clusters[:cache_clusters].each do |cluster|\n    rrset \"#{cluster[:cache_cluster_id]}.#{zone}\", \"CNAME\" do\n      ttl 60\n      resource_records(\n        cluster[:configuration_endpoint][:address]\n      )\n    end\n  end\n\n  AWS::Redshift.new(region: region).client.describe_clusters[:clusters].each do |cluster|\n    rrset \"#{cluster[:cluster_identifier]}.#{zone}\", \"CNAME\" do\n      ttl 60\n      resource_records(\n        cluster[:endpoint][:address]\n      )\n    end\n  end\nend\n\n\n\n\u9069\u7528\nbundle exec roadwork -a -f Routefile --target-zone \"route53.local\"\n\n\u3042\u3068\u306f\u3053\u308c\u3092CI\u3067\u56de\u3059\u3068\u304b\n\n## \u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n```ruby:Routefile\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\nvpc_id = \"vpc-xxxxxxxx\"\nregion = \"ap-northeast-1\"\nzone = \"route53.local.\"\nhosted_zone zone do\n  vpc region, vpc_id\n\n  AWS::EC2.new(region: region).vpcs[vpc_id].instances.each {|instance|\n    next if instance.tags.Name == nil\n    next if instance.tags.Name.empty?\n    rrset \"#{instance.tags.Name}.#{zone}\", \"A\" do\n      ttl 60\n      resource_records instance.private_ip_address\n    end\n  }\n\n  AWS::RDS.new(region: region).instances.to_a.each do |instance|\n    rrset \"#{instance.db_instance_identifier}.#{zone}\", \"CNAME\" do\n      ttl 60\n      resource_records(\n        instance.endpoint_address\n      )\n    end\n  end\n\n  AWS::ElastiCache.new(region: region).client.describe_cache_clusters[:cache_clusters].each do |cluster|\n    rrset \"#{cluster[:cache_cluster_id]}.#{zone}\", \"CNAME\" do\n      ttl 60\n      resource_records(\n        cluster[:configuration_endpoint][:address]\n      )\n    end\n  end\n\n  AWS::Redshift.new(region: region).client.describe_clusters[:clusters].each do |cluster|\n    rrset \"#{cluster[:cluster_identifier]}.#{zone}\", \"CNAME\" do\n      ttl 60\n      resource_records(\n        cluster[:endpoint][:address]\n      )\n    end\n  end\nend\n```\n\n## \u9069\u7528\n```bash\nbundle exec roadwork -a -f Routefile --target-zone \"route53.local\"\n```\n\n\u3042\u3068\u306f\u3053\u308c\u3092CI\u3067\u56de\u3059\u3068\u304b\n", "tags": ["roadworker", "route53"]}