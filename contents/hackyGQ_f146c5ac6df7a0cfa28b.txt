{"context": "\u30e6\u30fc\u30b6\u30fc\u30ed\u30fc\u30ab\u30eb\u304c\u63d0\u4f9b\u3092\u958b\u59cb\u3057\u305f\u4eba\u5de5\u77e5\u80fdBot API\u3067\u3061\u3087\u3063\u3068\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nhttp://ai.userlocal.jp/\nFacebook MessengerBot\nNodejs\nMessenger\u304b\u3089\u5165\u529b\u3055\u308c\u305f\u6587\u5b57\u5217\u3092\u8a00\u308f\u308c\u305f\u901a\u308a\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u3066\u3001\u6295\u3052\u3066\u3001\u5e30\u3063\u3066\u6765\u305f\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\u3060\u3051\u3068\u3044\u3046\u5168\u304f\u3072\u306d\u308a\u306e\u306a\u3044Bot\u3092\u3064\u304f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u4e0b\u8a18\u306e\u901a\u308a\n\n\nDemo\u30d3\u30c7\u30aa\nhttps://www.facebook.com/kj.kno000/videos/1835041870056933/\n\u4f5c\u308a\u304b\u3051\u306e Bot\u306e\u30b3\u30fc\u30c9\u3092\u90e8\u5206\u7684\u306b\u6301\u3063\u3066\u304d\u305f\u306e\u3067\u3001\u30a2\u30ec\u3067\u3059\u304c\u3002\n\u4e00\u5fdc\u3001\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\nFacebook\u306eBot\u306e\u4f5c\u308a\u65b9\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u306b\u8a73\u3057\u3044\u8aac\u660e\u304c\u3042\u308a\u307e\u3059\u3002\nhttp://qiita.com/pochi-sato/items/f3f5598e36c1fa92d840\n\nrouter.post('/', function (req, res, next) {\n    var messaging_events = req.body.entry[0].messaging,\n        replayMessages = [];\n    var baseURL = \"\";\n    for (i = 0; i < messaging_events.length; i++) {\n        event = req.body.entry[0].messaging[i];\n        sender = event.sender.id;\n        if (event.message && event.message.text) {\n            var typedCommand = event.message.text;\n            console.log(\"typed: \", typedCommand);\n            var msg = encodeURIComponent(typedCommand);\n            baseURL = \"https://chatbot-api.userlocal.jp/api/chat?message=\"+msg+\"&key=\"+aiKey;\n            heyAI(baseURL);\n        }\n    }\n    res.sendStatus(200);\n});\n\nfunction heyAI(url) {\n    console.log(\"heyAI function started!\");\n    console.log(\"url\",url);\n    var options = {\n        uri: url,\n        gzip: false,\n        json: true\n    };\n\n    request(options, function (err, response, body) {\n        if (err || response.statusCode != 200) {\n            console.log(\"Error/\u30a8\u30e9\u30fc\u3067\u3059\u3088\", err);\n            return;\n        }\n        var items = body;\n        var apiStatus = items.status;\n        var text =\"\";\n        text = items.result;\n        text = \"Something wrong man!!!!\";\n        sendTextMessage(sender, text.substring(0,320));\n    });\n}\n\n\n\u4e8c\u671f\u306e\u52df\u96c6\u3082\u59cb\u307e\u3063\u305f\u307f\u305f\u3044\u3067\u3059\u3002\nhttp://ai.userlocal.jp/#download\n\u30e6\u30fc\u30b6\u30fc\u30ed\u30fc\u30ab\u30eb\u304c\u63d0\u4f9b\u3092\u958b\u59cb\u3057\u305f\u4eba\u5de5\u77e5\u80fdBot API\u3067\u3061\u3087\u3063\u3068\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\nhttp://ai.userlocal.jp/\n\nFacebook MessengerBot\nNodejs\n\nMessenger\u304b\u3089\u5165\u529b\u3055\u308c\u305f\u6587\u5b57\u5217\u3092\u8a00\u308f\u308c\u305f\u901a\u308a\u30a8\u30f3\u30b3\u30fc\u30c9\u3057\u3066\u3001\u6295\u3052\u3066\u3001\u5e30\u3063\u3066\u6765\u305f\u7d50\u679c\u3092\u8868\u793a\u3059\u308b\u3060\u3051\u3068\u3044\u3046\u5168\u304f\u3072\u306d\u308a\u306e\u306a\u3044Bot\u3092\u3064\u304f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n###\u30d1\u30e9\u30e1\u30fc\u30bf\u306f\u4e0b\u8a18\u306e\u901a\u308a\n<img width=\"939\" alt=\"Screen Shot 2016-06-20 at 4.25.28 PM.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/24723/7d609f57-94c9-47d7-34b0-649e07c0b5ca.png\">\n\n\n#####Demo\u30d3\u30c7\u30aa\nhttps://www.facebook.com/kj.kno000/videos/1835041870056933/\n\n\u4f5c\u308a\u304b\u3051\u306e Bot\u306e\u30b3\u30fc\u30c9\u3092\u90e8\u5206\u7684\u306b\u6301\u3063\u3066\u304d\u305f\u306e\u3067\u3001\u30a2\u30ec\u3067\u3059\u304c\u3002\n\u4e00\u5fdc\u3001\u8f09\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\nFacebook\u306eBot\u306e\u4f5c\u308a\u65b9\u306b\u3064\u3044\u3066\u306f\u3053\u3061\u3089\u306b\u8a73\u3057\u3044\u8aac\u660e\u304c\u3042\u308a\u307e\u3059\u3002\nhttp://qiita.com/pochi-sato/items/f3f5598e36c1fa92d840\n\n```js\n\nrouter.post('/', function (req, res, next) {\n    var messaging_events = req.body.entry[0].messaging,\n        replayMessages = [];\n    var baseURL = \"\";\n    for (i = 0; i < messaging_events.length; i++) {\n        event = req.body.entry[0].messaging[i];\n        sender = event.sender.id;\n        if (event.message && event.message.text) {\n            var typedCommand = event.message.text;\n            console.log(\"typed: \", typedCommand);\n            var msg = encodeURIComponent(typedCommand);\n            baseURL = \"https://chatbot-api.userlocal.jp/api/chat?message=\"+msg+\"&key=\"+aiKey;\n            heyAI(baseURL);\n        }\n    }\n    res.sendStatus(200);\n});\n\nfunction heyAI(url) {\n    console.log(\"heyAI function started!\");\n    console.log(\"url\",url);\n    var options = {\n        uri: url,\n        gzip: false,\n        json: true\n    };\n\n    request(options, function (err, response, body) {\n        if (err || response.statusCode != 200) {\n            console.log(\"Error/\u30a8\u30e9\u30fc\u3067\u3059\u3088\", err);\n            return;\n        }\n        var items = body;\n        var apiStatus = items.status;\n        var text =\"\";\n        text = items.result;\n        text = \"Something wrong man!!!!\";\n        sendTextMessage(sender, text.substring(0,320));\n    });\n}\n\n```\n\n\u4e8c\u671f\u306e\u52df\u96c6\u3082\u59cb\u307e\u3063\u305f\u307f\u305f\u3044\u3067\u3059\u3002\nhttp://ai.userlocal.jp/#download\n", "tags": ["nodejs", "FacebookMessengerBot", "\u30e6\u30fc\u30b6\u30fc\u30ed\u30fc\u30ab\u30eb", "bot"]}