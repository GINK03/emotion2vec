{"context": "\n\nAWS SDK for PHP V3\u306e\u975e\u540c\u671f\u51e6\u7406\u3092SES\u3067\u8a66\u3057\u3066\u307f\u308b\n\u3061\u3087\u3063\u3068\u524d\u3067\u3059\u304c\u3001AWS SDK for PHP\u304c\u975e\u540c\u671f\u51e6\u7406\u306b\u5bfe\u5fdc\u3057\u307e\u3057\u305f\u3002\nConcurrency in Version 3 of the AWS SDK for PHP\n\u975e\u540c\u671f\u51e6\u7406\u3092\u4f7f\u3046\u3068\u4e26\u5217\u5b9f\u884c\u3057\u3084\u3059\u3044\u3068\u306e\u3053\u3068\u3067\u3001SES\u306e\u30e1\u30fc\u30eb\u9001\u4fe1API\u3067\u9806\u6b21\u51e6\u7406\u3068\u975e\u540c\u671f\u51e6\u7406\u306e\u5b9f\u884c\u6642\u9593\u3092\u6bd4\u8f03\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u5fc5\u8981\u74b0\u5883\n\nPHP >= 5.5\n\n\n\u6e96\u5099\ncomposer\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n$ curl -sS https://getcomposer.org/installer | php\n$ php composer.phar require aws/aws-sdk-php:~3.0\n\n\n\u30e1\u30fc\u30eb\u9001\u4fe1\uff1a\u9806\u6b21\u51e6\u7406\u7248\uff08sync.php)\n<?php\n\nrequire 'vendor/autoload.php';\n\ndefine('MY_LIMIT', 24);\n\nuse Aws\\Ses\\SesClient;\n\n$client = SesClient::factory(array(\n    'version'=> 'latest',     \n    'region' => 'us-east-1',\n));\n\n$request = array();\n$request['Source'] = '(\u9001\u4fe1\u5143\u30a2\u30c9\u30ec\u30b9)';\n$request['Destination']['ToAddresses'] = array('(\u9001\u4fe1\u5148\u30a2\u30c9\u30ec\u30b9)');\n$request['Message']['Subject']['Data'] = 'ses';\n$request['Message']['Body']['Text']['Data'] = 'example';\n\nfor ($i = 0; $i < MY_LIMIT; $i++) {\n    try {\n        $result = $client->sendEmail($request);\n        $messageId = $result->get('MessageId');\n        echo(\"Email sent! Message ID: $messageId\".\"\\n\");\n    } catch (Exception $e) {\n        echo(\"The email was not sent. Error message: \");\n        echo($e->getMessage().\"\\n\");\n    }\n}\n\n\n\u30e1\u30fc\u30eb\u9001\u4fe1\uff1a\u975e\u540c\u671f\u51e6\u7406\u7248\uff08async.php)\n6\u4e26\u5217\u3067\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n<?php\n\nrequire 'vendor/autoload.php';\n\ndefine('MY_LIMIT', 24);\ndefine('MY_CONCURRENCY', 6);\n\nuse Aws\\Ses\\SesClient;\nuse GuzzleHttp\\Promise;\n\n$client = SesClient::factory(array(\n    'version'=> 'latest',     \n    'region' => 'us-east-1',\n));\n\n$request = array();\n$request['Source'] = '(\u9001\u4fe1\u5143\u30a2\u30c9\u30ec\u30b9)';\n$request['Destination']['ToAddresses'] = array('(\u9001\u4fe1\u5148\u30a2\u30c9\u30ec\u30b9)');\n$request['Message']['Subject']['Data'] = 'ses';\n$request['Message']['Body']['Text']['Data'] = 'example';\n\n$promiseGenerator = function($total) use ($client, $request) {\n    for ($i = 0; $i < $total; $i++) {\n        yield $client->sendEmailAsync($request);\n    }\n};\n\n$promise = Promise\\each_limit(\n    $promiseGenerator(MY_LIMIT),\n    MY_CONCURRENCY,\n    function ($result) {\n        $messageId = $result->get('MessageId');\n        echo(\"Email sent! Message ID: $messageId\".\"\\n\");\n    },\n    function (Exception $e) {\n        echo(\"The email was not sent. Error message: \");\n        echo($e->getMessage().\"\\n\");\n    }\n);\n$promise->wait();\n\n\n\u6bd4\u8f03\ntime\u30b3\u30de\u30f3\u30c9\u3067\u6bd4\u8f03\u3057\u307e\u3057\u305f\u3002\n$ php -v \nPHP 5.6.26 (cli) (built: Sep 15 2016 13:22:01) \nCopyright (c) 1997-2016 The PHP Group\nZend Engine v2.6.0, Copyright (c) 1998-2016 Zend Technologies\n    with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2016, by Zend Technologies\n$ time php sync.php\n$ time php async.php\n\n3\u56de\u305a\u3064\u5b9f\u884c\u3057\u305f\u5834\u5408\u306ereal\u5024\u306e\u5e73\u5747\u5024\u304c\u4ee5\u4e0b\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\n\n\nsync.php\nasync.php\n\n\n\n\n9.403 \u79d2\n2.557 \u79d2\n\n\n\n\u975e\u540c\u671f\u51e6\u7406\u3067\u4e26\u5217\u5b9f\u884c\u3059\u308b\u30683\u500d\u4ee5\u4e0a\u901f\u304f\u306a\u308a\u307e\u3057\u305f\uff01\n# AWS SDK for PHP V3\u306e\u975e\u540c\u671f\u51e6\u7406\u3092SES\u3067\u8a66\u3057\u3066\u307f\u308b\n\n\u3061\u3087\u3063\u3068\u524d\u3067\u3059\u304c\u3001AWS SDK for PHP\u304c\u975e\u540c\u671f\u51e6\u7406\u306b\u5bfe\u5fdc\u3057\u307e\u3057\u305f\u3002\n\n[Concurrency in Version 3 of the AWS SDK for PHP](https://blogs.aws.amazon.com/php/post/Tx3OJWBAYNU6HMG/Concurrency-in-Version-3-of-the-AWS-SDK-for-PHP)\n\n\u975e\u540c\u671f\u51e6\u7406\u3092\u4f7f\u3046\u3068\u4e26\u5217\u5b9f\u884c\u3057\u3084\u3059\u3044\u3068\u306e\u3053\u3068\u3067\u3001SES\u306e\u30e1\u30fc\u30eb\u9001\u4fe1API\u3067\u9806\u6b21\u51e6\u7406\u3068\u975e\u540c\u671f\u51e6\u7406\u306e\u5b9f\u884c\u6642\u9593\u3092\u6bd4\u8f03\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n## \u5fc5\u8981\u74b0\u5883\n\n- PHP >= 5.5\n\n## \u6e96\u5099\n\ncomposer\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n$ curl -sS https://getcomposer.org/installer | php\n$ php composer.phar require aws/aws-sdk-php:~3.0\n```\n\n## \u30e1\u30fc\u30eb\u9001\u4fe1\uff1a\u9806\u6b21\u51e6\u7406\u7248\uff08sync.php)\n\n```php\n<?php\n\nrequire 'vendor/autoload.php';\n\ndefine('MY_LIMIT', 24);\n\nuse Aws\\Ses\\SesClient;\n\n$client = SesClient::factory(array(\n    'version'=> 'latest',     \n    'region' => 'us-east-1',\n));\n\n$request = array();\n$request['Source'] = '(\u9001\u4fe1\u5143\u30a2\u30c9\u30ec\u30b9)';\n$request['Destination']['ToAddresses'] = array('(\u9001\u4fe1\u5148\u30a2\u30c9\u30ec\u30b9)');\n$request['Message']['Subject']['Data'] = 'ses';\n$request['Message']['Body']['Text']['Data'] = 'example';\n\nfor ($i = 0; $i < MY_LIMIT; $i++) {\n    try {\n        $result = $client->sendEmail($request);\n        $messageId = $result->get('MessageId');\n        echo(\"Email sent! Message ID: $messageId\".\"\\n\");\n    } catch (Exception $e) {\n        echo(\"The email was not sent. Error message: \");\n        echo($e->getMessage().\"\\n\");\n    }\n}\n```\n\n## \u30e1\u30fc\u30eb\u9001\u4fe1\uff1a\u975e\u540c\u671f\u51e6\u7406\u7248\uff08async.php)\n\n6\u4e26\u5217\u3067\u5b9f\u884c\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\n```php\n<?php\n\nrequire 'vendor/autoload.php';\n\ndefine('MY_LIMIT', 24);\ndefine('MY_CONCURRENCY', 6);\n\nuse Aws\\Ses\\SesClient;\nuse GuzzleHttp\\Promise;\n\n$client = SesClient::factory(array(\n    'version'=> 'latest',     \n    'region' => 'us-east-1',\n));\n\n$request = array();\n$request['Source'] = '(\u9001\u4fe1\u5143\u30a2\u30c9\u30ec\u30b9)';\n$request['Destination']['ToAddresses'] = array('(\u9001\u4fe1\u5148\u30a2\u30c9\u30ec\u30b9)');\n$request['Message']['Subject']['Data'] = 'ses';\n$request['Message']['Body']['Text']['Data'] = 'example';\n\n$promiseGenerator = function($total) use ($client, $request) {\n    for ($i = 0; $i < $total; $i++) {\n        yield $client->sendEmailAsync($request);\n    }\n};\n\n$promise = Promise\\each_limit(\n    $promiseGenerator(MY_LIMIT),\n    MY_CONCURRENCY,\n    function ($result) {\n        $messageId = $result->get('MessageId');\n        echo(\"Email sent! Message ID: $messageId\".\"\\n\");\n    },\n    function (Exception $e) {\n        echo(\"The email was not sent. Error message: \");\n        echo($e->getMessage().\"\\n\");\n    }\n);\n$promise->wait();\n```\n\n## \u6bd4\u8f03\n\ntime\u30b3\u30de\u30f3\u30c9\u3067\u6bd4\u8f03\u3057\u307e\u3057\u305f\u3002\n\n```\n$ php -v \nPHP 5.6.26 (cli) (built: Sep 15 2016 13:22:01) \nCopyright (c) 1997-2016 The PHP Group\nZend Engine v2.6.0, Copyright (c) 1998-2016 Zend Technologies\n    with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2016, by Zend Technologies\n$ time php sync.php\n$ time php async.php\n```\n\n3\u56de\u305a\u3064\u5b9f\u884c\u3057\u305f\u5834\u5408\u306ereal\u5024\u306e\u5e73\u5747\u5024\u304c\u4ee5\u4e0b\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\n|sync.php|async.php|\n|:-----------|------------:|:------------:|\n|9.403 \u79d2|2.557 \u79d2|\n\n\u975e\u540c\u671f\u51e6\u7406\u3067\u4e26\u5217\u5b9f\u884c\u3059\u308b\u30683\u500d\u4ee5\u4e0a\u901f\u304f\u306a\u308a\u307e\u3057\u305f\uff01\n\n", "tags": ["PHP", "AWS", "ses"]}