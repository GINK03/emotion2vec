{"tags": ["Django1.6.1", "Ubuntu14.04", "vagrant1.7.2", "apache22.4.7"], "context": "Vagrant\u3067\u7acb\u3066\u7d42\u308f\u3063\u305fUbuntu Guest OS\u4e0a\u3067django wepapp\u3092\u52d5\u304b\u3057\u3066\u307f\u305f\u6642\u306e\u8a18\u9332\u3002\napache\u7528\u306e\u8cc7\u6750\u7f6e\u304f\u5148\u3068\u304b\u602a\u3057\u3044\u306e\u3067\u9593\u9055\u3044\u304c\u5224\u660e\u6b21\u7b2c\u9069\u5b9c\u76f4\u3057\u307e\u3059\u3002\n\n\u74b0\u5883\ndjango 1.6.1\napache2 2.4.7\nlibapache2-mod-wsgi 3.4\nvagrant 1.7.2\nVagrant Guest: Ubuntu 14.04\nVagrant Host: Cent OS 6.6 (\u3068\u3044\u3046\u304bConoha)\n\n\u524d\u63d0\nVagrant Guest OS\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ca\u3073\u8d77\u52d5\u6e08\u307f\u3002\n\ndjango\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u53c2\u8003\uff1ahttp://qiita.com/mountcedar/items/179fb0d9f4f87f9241c6\n$ sudo apt-get update\n$ sudo apt-get install -y apache2 libapache2-mod-wsgi\n$ sudo apt-get install -y python-django\n\n\ndjango\u3067\u30c6\u30b9\u30c8\u7528\u306b\u4f55\u304b\u4f5c\u308b\ndjango-admin startproject webservice\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u5f62\u306b\u306a\u308b\u3002\nwebservices/\n  django.wsgi\u2605\u6700\u521d\u306f\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u8ffd\u52a0\u3059\u308b\n  manage.py\n  webservices/\n    __init__.py\n    settings.py\n    urls.py\n    wsgi.py\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\ndjango.wsgi\n#!/usr/bin/env python\n# coding: utf-8\n\nimport os\nimport sys\n\nsys.path.append('<webservices\u3092\u914d\u7f6e\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea>')\nsys.path.append('<webservices\u3092\u914d\u7f6e\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea>/webservices')\n\nos.environ[ 'DJANGO_SETTINGS_MODULE' ] = 'webservices.settings'\n\nimport django.core.handlers.wsgi\napplication = django.core.handlers.wsgi.WSGIHandler()\n\n\n/etc/apache2/sites-available/django\nWSGIScriptAlias /services <django.wsgi\u306e\u7d76\u5bfe\u30d1\u30b9>\n\n<Directory /home/issei/django/webservices/>\nOrder deny,allow\nAllow from all\n</Directory>\n\n\nVagrant\u306eHost - Guest\u9593\u3092\u7e4b\u3050\n\n\n\n\nHost\nGuest\n\n\n\n\nHTTP\n8888\n8000\n\n\n\n\nHost\u5074\u8a2d\u5b9a\n\niptables\nCent OS\u306eiptables\u306f\u3053\u3053\u3002\n/etc/sysconfig/iptables\nREJECT\u30eb\u30fc\u30eb\u3088\u308a\u3082\u4e0a\u306b\u66f8\u304b\u306a\u3044\u3068REJECT\u3055\u308c\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3002\n(\u524d\u7565)\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 8888 -j ACCEPT \u2605\u3053\u306e\u884c\u3092\u8ffd\u52a0\u3059\u308b\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n\n\nVagrantfile\n\u53c2\u8003\uff1ahttp://qiita.com/ftakao2007/items/0ec05c2ef3c14cdbea11#2-4\nhost\u3068guest\u3092\u7e4b\u3050\u30eb\u30fc\u30eb\u3068\u3001NIC\u3092\u30d6\u30ea\u30c3\u30b8\u63a5\u7d9a\u3059\u308b\u8a2d\u5b9a\u3092\u6709\u52b9\u306b\u3059\u308b\u3002\n  #(\u524d\u7565)\n  # config.vm.network \"forwarded_port\", guest: 80, host: 8080\n  config.vm.network \"forwarded_port\", guest: 8000, host: 8888, id:\"http\" #\u2605\u3053\u306e\u884c\u3092\u8ffd\u52a0\u3059\u308b\n\n  config.vm.network \"public_network\" #\u2605\u3053\u306e\u884c\u3092\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\u3059\u308b\n\n\nGuest\u5074\u8a2d\u5b9a\n\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\"ufw(uncomplicated firewall)\"\u3092\u4f7f\u3046\u3002\n\n\u6709\u52b9\u5316\n$ sudo ufw enable\n\n\n\u30dd\u30fc\u30c88000\u756a\u3092\u8a31\u53ef\u3059\u308b\n$ sudo ufw allow 8000\n\n\u203bSSH\u3067\u4f5c\u696d\u3057\u3066\u308b\u306e\u3067\u4e0b\u8a18\u3082\u6050\u3089\u304f\u5fc5\u9808\u3002\n$ sudo ufw allow 22\n\n\n\u53cd\u6620\u3059\u308b\n$ sudo ufw reload\n\n\n\u78ba\u8a8d\u3059\u308b\n$ sudo ufw status\n\n\ndjango\u8d77\u52d5\u3059\u308b\nmanage.py\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u5f8c\n$ python manage.py runserver 0.0.0.0:8000\n\n\u3053\u308c\u3067Host OS\u306e\"\u30b0\u30ed\u30fc\u30d0\u30eb\u30a2\u30c9\u30ec\u30b9:8888\"\u304b\u3089django\u306bHTTP\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u306f\u305a\u3002\nVagrant\u3067\u7acb\u3066\u7d42\u308f\u3063\u305fUbuntu Guest OS\u4e0a\u3067django wepapp\u3092\u52d5\u304b\u3057\u3066\u307f\u305f\u6642\u306e\u8a18\u9332\u3002\napache\u7528\u306e\u8cc7\u6750\u7f6e\u304f\u5148\u3068\u304b\u602a\u3057\u3044\u306e\u3067\u9593\u9055\u3044\u304c\u5224\u660e\u6b21\u7b2c\u9069\u5b9c\u76f4\u3057\u307e\u3059\u3002\n\n# \u74b0\u5883\n\ndjango 1.6.1\napache2 2.4.7\nlibapache2-mod-wsgi 3.4\n\nvagrant 1.7.2\nVagrant Guest: Ubuntu 14.04\nVagrant Host: Cent OS 6.6 (\u3068\u3044\u3046\u304bConoha)\n\n## \u524d\u63d0\n\nVagrant Guest OS\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u53ca\u3073\u8d77\u52d5\u6e08\u307f\u3002\n\n# django\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u53c2\u8003\uff1ahttp://qiita.com/mountcedar/items/179fb0d9f4f87f9241c6\n\n```\n$ sudo apt-get update\n$ sudo apt-get install -y apache2 libapache2-mod-wsgi\n$ sudo apt-get install -y python-django\n```\n\n# django\u3067\u30c6\u30b9\u30c8\u7528\u306b\u4f55\u304b\u4f5c\u308b\n\n```\ndjango-admin startproject webservice\n```\n\n\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306a\u5f62\u306b\u306a\u308b\u3002\n\n```\nwebservices/\n  django.wsgi\u2605\u6700\u521d\u306f\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u8ffd\u52a0\u3059\u308b\n  manage.py\n  webservices/\n    __init__.py\n    settings.py\n    urls.py\n    wsgi.py\n```\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\n```django.wsgi\n#!/usr/bin/env python\n# coding: utf-8\n\nimport os\nimport sys\n\nsys.path.append('<webservices\u3092\u914d\u7f6e\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea>')\nsys.path.append('<webservices\u3092\u914d\u7f6e\u3057\u305f\u30c7\u30a3\u30ec\u30af\u30c8\u30ea>/webservices')\n\nos.environ[ 'DJANGO_SETTINGS_MODULE' ] = 'webservices.settings'\n\nimport django.core.handlers.wsgi\napplication = django.core.handlers.wsgi.WSGIHandler()\n```\n\n/etc/apache2/sites-available/django\n\n```\nWSGIScriptAlias /services <django.wsgi\u306e\u7d76\u5bfe\u30d1\u30b9>\n\n<Directory /home/issei/django/webservices/>\nOrder deny,allow\nAllow from all\n</Directory>\n```\n\n# Vagrant\u306eHost - Guest\u9593\u3092\u7e4b\u3050\n\n||Host|Guest|\n|----|----|----|\n|HTTP|8888|8000|\n\n## Host\u5074\u8a2d\u5b9a\n\n### iptables\n\nCent OS\u306eiptables\u306f\u3053\u3053\u3002\n\n/etc/sysconfig/iptables\n\nREJECT\u30eb\u30fc\u30eb\u3088\u308a\u3082\u4e0a\u306b\u66f8\u304b\u306a\u3044\u3068REJECT\u3055\u308c\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3002\n\n```shell-session\n(\u524d\u7565)\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 8888 -j ACCEPT \u2605\u3053\u306e\u884c\u3092\u8ffd\u52a0\u3059\u308b\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n```\n\n### Vagrantfile\n\n\u53c2\u8003\uff1ahttp://qiita.com/ftakao2007/items/0ec05c2ef3c14cdbea11#2-4\n\nhost\u3068guest\u3092\u7e4b\u3050\u30eb\u30fc\u30eb\u3068\u3001NIC\u3092\u30d6\u30ea\u30c3\u30b8\u63a5\u7d9a\u3059\u308b\u8a2d\u5b9a\u3092\u6709\u52b9\u306b\u3059\u308b\u3002\n\n```rb\n  #(\u524d\u7565)\n  # config.vm.network \"forwarded_port\", guest: 80, host: 8080\n  config.vm.network \"forwarded_port\", guest: 8000, host: 8888, id:\"http\" #\u2605\u3053\u306e\u884c\u3092\u8ffd\u52a0\u3059\u308b\n\n  config.vm.network \"public_network\" #\u2605\u3053\u306e\u884c\u3092\u30b3\u30e1\u30f3\u30c8\u30a4\u30f3\u3059\u308b\n```\n\n## Guest\u5074\u8a2d\u5b9a\n\n\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\"ufw(uncomplicated firewall)\"\u3092\u4f7f\u3046\u3002\n\n### \u6709\u52b9\u5316\n\n```shell-session\n$ sudo ufw enable\n```\n\n### \u30dd\u30fc\u30c88000\u756a\u3092\u8a31\u53ef\u3059\u308b\n\n```shell-session\n$ sudo ufw allow 8000\n```\n\n\u203bSSH\u3067\u4f5c\u696d\u3057\u3066\u308b\u306e\u3067\u4e0b\u8a18\u3082\u6050\u3089\u304f\u5fc5\u9808\u3002\n\n```shell-session\n$ sudo ufw allow 22\n```\n\n### \u53cd\u6620\u3059\u308b\n\n```shell-session\n$ sudo ufw reload\n```\n\n### \u78ba\u8a8d\u3059\u308b\n\n```shell-session\n$ sudo ufw status\n```\n\n# django\u8d77\u52d5\u3059\u308b\n\nmanage.py\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u5f8c\n\n```\n$ python manage.py runserver 0.0.0.0:8000\n```\n\n\u3053\u308c\u3067Host OS\u306e\"\u30b0\u30ed\u30fc\u30d0\u30eb\u30a2\u30c9\u30ec\u30b9:8888\"\u304b\u3089django\u306bHTTP\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u306f\u305a\u3002\n\n\n"}