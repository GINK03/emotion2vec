{"tags": ["python2.7", "lambda", "Apex"], "context": "\n\n\u6982\u8981\n\npython-lambda-local\u3067\u30ed\u30fc\u30ab\u30eb\u958b\u767a\nApex\u3067\u30c7\u30d7\u30ed\u30a4\u3059\u308b\n\n\u7d44\u307f\u5408\u308f\u305b\u305f\u74b0\u5883\u3092\u8aac\u660e\u3057\u307e\u3059\n\n\n\u4e8b\u524d\u6e96\u5099\n\n\u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\npip install python-lambda-local\npip install boto3\n\n\nApex\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncurl https://raw.githubusercontent.com/apex/apex/master/install.sh | sudo sh\n\n\u203b AWS\u3000config/credentials\u3092\u4e8b\u524d\u306b\u8a2d\u5b9a\n\u203b IAM\u30e6\u30fc\u30b6\u306biam:CreateRole\u3092\u5272\u308a\u5f53\u3066\u308b\u5fc5\u8981\u3042\u308a\n\n\nApex\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\nscaffold\u3092\u4f5c\u6210\nmkdir hello-project\ncd hello-project\napex init\n\n... \u5bfe\u8a71\u30e2\u30fc\u30c9\u3067\u5165\u529b ...\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\n\nproject.json\n{\n  ...\n  \"runtime\": \"python\",\n\u3000\u3000\u3000\u3000\"environment\": {} //\u5171\u901a\u306e\u74b0\u5883\u5909\u6570\n  ...\n}\n\n\n\n.apexignore\nevent.json\nrequirements.txt\n*.pyc\n\n\n\n\nLambda\u3092\u4f5c\u6210\n\nFunction\u3092\u4f5c\u6210\n\nfunctions/hello/_apex_main.py\ndef handle(event, context):\n  print 'Hello Lamba'\n  return 'success'\n\n\n\n\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\u3053\u3053\u3067\u3082\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3067\u304d\u308b\n\nfunctions/hello/event.json\n{\n  \"description\": \"about this function\"\n}\n\n\n\nLambda\u306b\u6e21\u3059\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n\u52d5\u4f5c\u78ba\u8a8d\u306b\u5fc5\u8981\n\nfunctions/hello/event.json\n{\n  \"key\": \"value\"\n}\n\n\n\n\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\nfunctions/hello\npip install $\u30e9\u30a4\u30d6\u30e9\u30ea\u540d -t .\npip freeze > requirements.txt\n\n\n\n\nAWS\u3067\u5b9f\u884c\n\n\u30c7\u30d7\u30ed\u30a4\napex deploy\n\n\n\u5b9f\u884c\napex invoke < event.json\n\n\n\nLocal\u3067\u52d5\u4f5c\u78ba\u8a8d\n\npython-lambda-local\u3092\u5b9f\u884c\n\u6bce\u56deAWS\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u306e\u306f\u624b\u9593\n\nfunctions/hello\npython-lambda-local -l . -f handle -t 5 _apex_main.py event.json\n\n\n\n\n\u8ab2\u984c\n\n\u74b0\u5883\u5909\u6570\nAWS Lambda\u306ePython\u30e9\u30f3\u30bf\u30a4\u30e0\u306f\u74b0\u5883\u5909\u6570\u3092\u4f7f\u3048\u306a\u3044\n\nApex\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308bzip\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u3001\u74b0\u5883\u5909\u6570\u3092\u5b9a\u7fa9\u3059\u308b.env.json\u304c\u542b\u307e\u308c\u3066\u3044\u308b\n\u5b9f\u884c\u6642\u306b.env.json\u306e\u5185\u5bb9\u3092\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\n\n\n_apex_main.py\nimport json\nwith open('.env.json') as f:\n    os.environ.update(json.load(f, encoding='utf-8'))\n\ndef handle(event, context):\n\n\n# \u6982\u8981\n\n1. python-lambda-local\u3067\u30ed\u30fc\u30ab\u30eb\u958b\u767a\n2. Apex\u3067\u30c7\u30d7\u30ed\u30a4\u3059\u308b\n\n\u7d44\u307f\u5408\u308f\u305b\u305f\u74b0\u5883\u3092\u8aac\u660e\u3057\u307e\u3059\n\n***\n\n# \u4e8b\u524d\u6e96\u5099\n\n## \u5fc5\u8981\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```bash\npip install python-lambda-local\npip install boto3\n```\n\n## Apex\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```bash\ncurl https://raw.githubusercontent.com/apex/apex/master/install.sh | sudo sh\n```\n\u203b AWS\u3000config/credentials\u3092\u4e8b\u524d\u306b\u8a2d\u5b9a\n\u203b IAM\u30e6\u30fc\u30b6\u306biam:CreateRole\u3092\u5272\u308a\u5f53\u3066\u308b\u5fc5\u8981\u3042\u308a\n\n***\n\n# Apex\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\n## scaffold\u3092\u4f5c\u6210\n\n```\u001dbash\nmkdir hello-project\ncd hello-project\napex init\n\n... \u5bfe\u8a71\u30e2\u30fc\u30c9\u3067\u5165\u529b ...\n\n```\n\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u5909\u66f4\n```\u001dproject.json\n{\n  ...\n  \"runtime\": \"python\",\n\u3000\u3000\u3000\u3000\"environment\": {} //\u5171\u901a\u306e\u74b0\u5883\u5909\u6570\n  ...\n}\n```\n\n```\u001d.apexignore\nevent.json\nrequirements.txt\n*.pyc\n```\n\n***\n\n# Lambda\u3092\u4f5c\u6210\n\n## Function\u3092\u4f5c\u6210\n```\u001dfunctions/hello/_apex_main.py\ndef handle(event, context):\n  print 'Hello Lamba'\n  return 'success'\n```\n\n## \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\n\u3053\u3053\u3067\u3082\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3067\u304d\u308b\n\n```functions/hello/event.json\n{\n  \"description\": \"about this function\"\n}\n```\n\n## Lambda\u306b\u6e21\u3059\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\n\u52d5\u4f5c\u78ba\u8a8d\u306b\u5fc5\u8981\n\n```\u001dfunctions/hello/event.json\n{\n  \"key\": \"value\"\n}\n```\n\n## \u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n```\u001dbash:functions/hello\npip install $\u30e9\u30a4\u30d6\u30e9\u30ea\u540d -t .\u001d\u001d\npip freeze > requirements.txt\n```\n\n***\n\n# AWS\u3067\u5b9f\u884c\n\n## \u30c7\u30d7\u30ed\u30a4\n\n```\u001dbash\napex deploy\n```\n\n## \u5b9f\u884c\n\n```\u001dbash\napex invoke < event.json\n```\n\n***\n\n# Local\u3067\u52d5\u4f5c\u78ba\u8a8d\n\n## python-lambda-local\u3092\u5b9f\u884c\n\u6bce\u56deAWS\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u306e\u306f\u624b\u9593\n\n```\u001dbash:functions/hello\npython-lambda-local -l . -f handle -t 5 _apex_main.py event.json\n```\n\n***\n\n# \u8ab2\u984c\n\n## \u74b0\u5883\u5909\u6570\nAWS Lambda\u306ePython\u30e9\u30f3\u30bf\u30a4\u30e0\u306f\u74b0\u5883\u5909\u6570\u3092\u4f7f\u3048\u306a\u3044\n\n* Apex\u304c\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308bzip\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u3001\u74b0\u5883\u5909\u6570\u3092\u5b9a\u7fa9\u3059\u308b`\u001d.env.json`\u304c\u542b\u307e\u308c\u3066\u3044\u308b\n* \u5b9f\u884c\u6642\u306b`\u001d.env.json`\u306e\u5185\u5bb9\u3092\u74b0\u5883\u5909\u6570\u306b\u8a2d\u5b9a\u3057\u3066\u3042\u3052\u308b\n\n```_apex_main.py\nimport json\nwith open('.env.json') as f:\n    os.environ.update(json.load(f, encoding='utf-8'))\n\ndef handle(event, context):\n```\n"}