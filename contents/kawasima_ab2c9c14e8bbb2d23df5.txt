{"context": " More than 1 year has passed since last update.Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ed\u30b0\u3092\u3001logrotate\u3067\u4e00\u5f8b\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3055\u305b\u305f\u3044\u3001\u3068\u3044\u3046\u8a71\u3092\u3068\u304d\u3069\u304d\u805e\u304d\u307e\u3059\u3002\nlog4j\u306e\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u5916\u90e8\u304b\u3089\u6307\u793a\u3059\u308b\u8853\u306f\u3001ExternallyRolledFileAppender\u3092\u4f7f\u3048\u3070\u53ef\u80fd\u3067\u3059\u3002\n<appender name=\"file\" class=\"org.apache.log4j.varia.ExternallyRolledFileAppender\">\n    <param name=\"file\" value=\"application.log\" /> \n    <param name=\"threshold\" value=\"INFO\"/>\n    <param name=\"port\" value=\"9000\"/>\n    <param name=\"append\" value=\"true\" />\n</appender>\n\norg.apache.log4j.varia.Roller \u3092\u4f7f\u3063\u3066\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u6307\u793a\u3092\u9001\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u304c\u3001\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u304c*.1\u304c\u81ea\u52d5\u3067\u4f5c\u3089\u308c\u3066\u3057\u307e\u3044\u3001\u3046\u307e\u304f\u3042\u308a\u307e\u305b\u3093\u3002\n\u305d\u3053\u3067\u3001\u4ed6\u306e\u30ed\u30b0\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30ca\u30d6\u30eb\u306a\u30d7\u30ed\u30bb\u30b9\u305f\u3061\u3068\u540c\u3058\u3088\u3046\u306b\u3001SIGHUP\u3092\u53d7\u3051\u53d6\u3063\u305f\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u5ea6\u30af\u30ed\u30fc\u30ba\u3057\u3001\u518d\u5ea6\u958b\u304d\u76f4\u3059\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3059\u3002\npublic class LogRotatableFileAppender extends FileAppender {\n    public LogRotatableFileAppender() {\n        Signal.handle(new Signal(\"HUP\"), new SignalHandler() {\n            @Override\n            public void handle(Signal signal) {\n                closeFile();\n                activateOptions();\n            }\n        });\n    }\n}\n\n\u3053\u308c\u3067\u3001\u4f8b\u3048\u3070Tomcat\u3067\u52d5\u3044\u3066\u3044\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306blogrotate.conf\u306bpostrotate\u3067SIGHUP\u3092tomcat\u30d7\u30ed\u30bb\u30b9\u306b\u9001\u308b\u3088\u3046\u306b\u3059\u308c\u3070\u3001logrotate\u3067\u8a2d\u5b9a\u306b\u3057\u305f\u304c\u3044\u3001\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\nlogrotate.conf\n/var/log/app.log\n{\n    rotate 6\n    size=100k \n    missingok \n    daily\n    sharedscripts \n    postrotate\n        /bin/kill -HUP `cat /var/run/tomcat.pid 2>/dev/null` 2> /dev/null\n    endscript\n}\n\n\nWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ed\u30b0\u3092\u3001logrotate\u3067\u4e00\u5f8b\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3055\u305b\u305f\u3044\u3001\u3068\u3044\u3046\u8a71\u3092\u3068\u304d\u3069\u304d\u805e\u304d\u307e\u3059\u3002\n\nlog4j\u306e\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3092\u5916\u90e8\u304b\u3089\u6307\u793a\u3059\u308b\u8853\u306f\u3001ExternallyRolledFileAppender\u3092\u4f7f\u3048\u3070\u53ef\u80fd\u3067\u3059\u3002\n\n```xml\n<appender name=\"file\" class=\"org.apache.log4j.varia.ExternallyRolledFileAppender\">\n    <param name=\"file\" value=\"application.log\" /> \n    <param name=\"threshold\" value=\"INFO\"/>\n    <param name=\"port\" value=\"9000\"/>\n    <param name=\"append\" value=\"true\" />\n</appender>\n```\norg.apache.log4j.varia.Roller \u3092\u4f7f\u3063\u3066\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u6307\u793a\u3092\u9001\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u304c\u3001\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u30d5\u30a1\u30a4\u30eb\u304c*.1\u304c\u81ea\u52d5\u3067\u4f5c\u3089\u308c\u3066\u3057\u307e\u3044\u3001\u3046\u307e\u304f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\n\u305d\u3053\u3067\u3001\u4ed6\u306e\u30ed\u30b0\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30ca\u30d6\u30eb\u306a\u30d7\u30ed\u30bb\u30b9\u305f\u3061\u3068\u540c\u3058\u3088\u3046\u306b\u3001SIGHUP\u3092\u53d7\u3051\u53d6\u3063\u305f\u3089\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u5ea6\u30af\u30ed\u30fc\u30ba\u3057\u3001\u518d\u5ea6\u958b\u304d\u76f4\u3059\u3088\u3046\u306b\u3057\u3066\u307f\u307e\u3059\u3002\n\n```java\npublic class LogRotatableFileAppender extends FileAppender {\n    public LogRotatableFileAppender() {\n        Signal.handle(new Signal(\"HUP\"), new SignalHandler() {\n            @Override\n            public void handle(Signal signal) {\n                closeFile();\n                activateOptions();\n            }\n        });\n    }\n}\n```\n\n\u3053\u308c\u3067\u3001\u4f8b\u3048\u3070Tomcat\u3067\u52d5\u3044\u3066\u3044\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b`logrotate.conf`\u306bpostrotate\u3067SIGHUP\u3092tomcat\u30d7\u30ed\u30bb\u30b9\u306b\u9001\u308b\u3088\u3046\u306b\u3059\u308c\u3070\u3001logrotate\u3067\u8a2d\u5b9a\u306b\u3057\u305f\u304c\u3044\u3001\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```text:logrotate.conf\n/var/log/app.log\n{\n    rotate 6\n    size=100k \n    missingok \n    daily\n    sharedscripts \n    postrotate\n        /bin/kill -HUP `cat /var/run/tomcat.pid 2>/dev/null` 2> /dev/null\n    endscript\n}\n```\n\n\n", "tags": ["log4j1.2.17", "logrotate", "Linux"]}