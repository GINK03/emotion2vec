{"tags": ["gas", "spreadsheet"], "context": " More than 1 year has passed since last update.Spread Sheet \u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ec\u30a4\u30a2\u30a6\u30c8\u306e\u51fa\u7d0d\u5e33\u3092\u4f5c\u3063\u305f.\n\n\u305d\u306e\u65e5\u306e\u652f\u51fa\u306f in \u5c0f\u8a08 \u3068 out \u5c0f\u8a08 \u306b\u307e\u3068\u3081\u3089\u308c, \u8ca1\u5e03 \u306f\u524d\u65e5\u306e\u7e70\u8d8a\u304b\u3089\u53ce\u652f\u3068\u9280\u884c\u6b8b\u9ad8\u3092\u5f15\u3044\u305f\u3082\u306e\u3068\u306a\u3063\u3066\u3044\u308b.\n\u4efb\u610f\u306e\u65e5\u306e\u8ca1\u5e03\u72b6\u6cc1\u3092\u4e88\u6e2c\u3067\u304d\u308b\u306e\u3067\u4fbf\u5229.\n\u53ce\u652f\u306e\u8a18\u8ff0\u30eb\u30fc\u30eb\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b.\n\n\u53ce\u5165\u306e\u5834\u5408\u306f\u6b63\u306e\u6570\u3067\u8868\u3059\n\u652f\u51fa\u306e\u5834\u5408\u306f\u8ca0\u306e\u6570\u3067\u8868\u3059\n\u9280\u884c\u3078\u306e\u5165\u91d1/\u51fa\u91d1\u306f\u982d\u306b B \u3068\u4ed8\u3051\u308b\n\u3069\u3093\u306a\u3082\u306e\u3092\u8cb7\u3063\u305f\u304b\u306a\u3069\u306f\u30e1\u30e2\u3067\u30bb\u30eb\u306b\u4ed8\u8a18\u3059\u308b\n\n\u3053\u3053\u3067, \u305d\u306e\u65e5\u3054\u3068\u306e in \u5c0f\u8a08, out \u5c0f\u8a08 \u3092\u51fa\u529b\u3059\u308b\u305f\u3081\u306b\u306f,\n\n\nin \u5c0f\u8a08: \u652f\u51fa\u8a18\u5165\u6b04\u306e\u6b63\u306e\u6570\u306e\u307f\u5408\u8a08\u3059\u308b. \u9280\u884c\u3078\u306e\u5165\u51fa\u91d1\u306f\u9664\u304f\n\nout \u5c0f\u8a08: \u652f\u51fa\u8a18\u5165\u6b04\u306e\u8ca0\u306e\u6570\u306e\u307f\u5408\u8a08\u3059\u308b. \u9280\u884c\u3078\u306e\u5165\u51fa\u91d1\u306f\u9664\u304f\n\n\u3068\u3044\u3046\u64cd\u4f5c\u304c\u5fc5\u8981\u3067\u3042\u308a, Spread Sheet \u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u95a2\u6570\u3092\u4f7f\u3046\u3068\u3060\u308b\u3044\u6c17\u304c\u3057\u305f (\u7bc4\u56f2\u3059\u3079\u3066\u306e\u30bb\u30eb\u306b\u5bfe\u3057\u3066 IF \u3067\u8abf\u3079\u305f\u308a).\n\u305d\u306e\u305f\u3081, \u72ec\u81ea\u95a2\u6570 (Custom Function) \u3092\u5b9a\u7fa9\u3057\u3066, \u4f7f\u3046\u3053\u3068\u3068\u3057\u305f.\n\u307e\u305a\u30c4\u30fc\u30eb > \u30b9\u30af\u30ea\u30d7\u30c8 \u30a8\u30c7\u30a3\u30bf... \u304b\u3089\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u3092\u7acb\u3061\u4e0a\u3052\u308b.\n\n\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u4fdd\u5b58.\nfunction \u5165\u91d1(target_list){\n  sum = 0;\n  for (var i = 0; i < target_list[0].length; i++) {\n    target_cell = target_list[0][i];\n    if (target_cell > 0) sum += target_cell;\n  }\n  return sum;\n}\n\nfunction \u51fa\u91d1(target_list){\n  sum = 0\n  for (var i = 0; i < target_list[0].length; i++) {\n    target_cell = target_list[0][i];\n    if (target_cell < 0) sum += target_cell;\n  }\n  return sum;\n}\n\n\u7bc4\u56f2\u306e\u5834\u5408, 1 \u884c\u3067\u3082 2 \u6b21\u5143\u914d\u5217\u3067\u6e21\u3055\u308c\u308b\u306e\u3067\u6ce8\u610f.\n\u3053\u3053\u3067\u5b9a\u7fa9\u3057\u305f\u95a2\u6570\u306f\u305d\u306e\u307e\u307e Spread Sheet \u304b\u3089\u547c\u3073\u51fa\u305b\u308b.\n\n\u7570\u69d8\u306b\u7c21\u5358\u306b\u3067\u304d\u3066\u4fbf\u5229.\n\nReferences\n\nGoogleAppsScript - Spreadsheet\u306e\u72ec\u81ea\u95a2\u6570\u3092GAS\u3067\u4f5c\u308b\u3088\u2606 - Qiita\nCustom Functions in Google Sheets - Google Apps Script \u2014 Google Developers\n\n\nSpread Sheet \u3067\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ec\u30a4\u30a2\u30a6\u30c8\u306e\u51fa\u7d0d\u5e33\u3092\u4f5c\u3063\u305f.\n\n![2014-11-29_14_07_05.png](https://qiita-image-store.s3.amazonaws.com/289/29618/1b56f813-515b-826c-b9dc-91880fe14c76.png \"2014-11-29_14_07_05.png\")\n\n\u305d\u306e\u65e5\u306e\u652f\u51fa\u306f `in \u5c0f\u8a08` \u3068 `out \u5c0f\u8a08` \u306b\u307e\u3068\u3081\u3089\u308c, `\u8ca1\u5e03` \u306f\u524d\u65e5\u306e\u7e70\u8d8a\u304b\u3089\u53ce\u652f\u3068\u9280\u884c\u6b8b\u9ad8\u3092\u5f15\u3044\u305f\u3082\u306e\u3068\u306a\u3063\u3066\u3044\u308b.\n\u4efb\u610f\u306e\u65e5\u306e\u8ca1\u5e03\u72b6\u6cc1\u3092\u4e88\u6e2c\u3067\u304d\u308b\u306e\u3067\u4fbf\u5229.\n\n\u53ce\u652f\u306e\u8a18\u8ff0\u30eb\u30fc\u30eb\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b.\n\n- \u53ce\u5165\u306e\u5834\u5408\u306f\u6b63\u306e\u6570\u3067\u8868\u3059\n- \u652f\u51fa\u306e\u5834\u5408\u306f\u8ca0\u306e\u6570\u3067\u8868\u3059\n- \u9280\u884c\u3078\u306e\u5165\u91d1/\u51fa\u91d1\u306f\u982d\u306b `B` \u3068\u4ed8\u3051\u308b\n- \u3069\u3093\u306a\u3082\u306e\u3092\u8cb7\u3063\u305f\u304b\u306a\u3069\u306f\u30e1\u30e2\u3067\u30bb\u30eb\u306b\u4ed8\u8a18\u3059\u308b\n\n\u3053\u3053\u3067, \u305d\u306e\u65e5\u3054\u3068\u306e `in \u5c0f\u8a08`, `out \u5c0f\u8a08` \u3092\u51fa\u529b\u3059\u308b\u305f\u3081\u306b\u306f,\n\n- `in \u5c0f\u8a08`: \u652f\u51fa\u8a18\u5165\u6b04\u306e\u6b63\u306e\u6570\u306e\u307f\u5408\u8a08\u3059\u308b. \u9280\u884c\u3078\u306e\u5165\u51fa\u91d1\u306f\u9664\u304f\n- `out \u5c0f\u8a08`: \u652f\u51fa\u8a18\u5165\u6b04\u306e\u8ca0\u306e\u6570\u306e\u307f\u5408\u8a08\u3059\u308b. \u9280\u884c\u3078\u306e\u5165\u51fa\u91d1\u306f\u9664\u304f\n\n\u3068\u3044\u3046\u64cd\u4f5c\u304c\u5fc5\u8981\u3067\u3042\u308a, Spread Sheet \u3067\u63d0\u4f9b\u3055\u308c\u3066\u3044\u308b\u95a2\u6570\u3092\u4f7f\u3046\u3068\u3060\u308b\u3044\u6c17\u304c\u3057\u305f (\u7bc4\u56f2\u3059\u3079\u3066\u306e\u30bb\u30eb\u306b\u5bfe\u3057\u3066 IF \u3067\u8abf\u3079\u305f\u308a).\n\u305d\u306e\u305f\u3081, \u72ec\u81ea\u95a2\u6570 (Custom Function) \u3092\u5b9a\u7fa9\u3057\u3066, \u4f7f\u3046\u3053\u3068\u3068\u3057\u305f.\n\n\u307e\u305a`\u30c4\u30fc\u30eb` > `\u30b9\u30af\u30ea\u30d7\u30c8 \u30a8\u30c7\u30a3\u30bf...` \u304b\u3089\u30b9\u30af\u30ea\u30d7\u30c8\u30a8\u30c7\u30a3\u30bf\u3092\u7acb\u3061\u4e0a\u3052\u308b.\n\n![2014-11-29_14_16_35.png](https://qiita-image-store.s3.amazonaws.com/289/29618/bcf6f867-33ab-7829-9cf2-17be5eeb134b.png \"2014-11-29_14_16_35.png\")\n\n\n\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u4fdd\u5b58.\n\n```javascript\nfunction \u5165\u91d1(target_list){\n  sum = 0;\n  for (var i = 0; i < target_list[0].length; i++) {\n    target_cell = target_list[0][i];\n    if (target_cell > 0) sum += target_cell;\n  }\n  return sum;\n}\n\nfunction \u51fa\u91d1(target_list){\n  sum = 0\n  for (var i = 0; i < target_list[0].length; i++) {\n    target_cell = target_list[0][i];\n    if (target_cell < 0) sum += target_cell;\n  }\n  return sum;\n}\n```\n\n\u7bc4\u56f2\u306e\u5834\u5408, 1 \u884c\u3067\u3082 2 \u6b21\u5143\u914d\u5217\u3067\u6e21\u3055\u308c\u308b\u306e\u3067\u6ce8\u610f.\n\n\u3053\u3053\u3067\u5b9a\u7fa9\u3057\u305f\u95a2\u6570\u306f\u305d\u306e\u307e\u307e Spread Sheet \u304b\u3089\u547c\u3073\u51fa\u305b\u308b.\n\n![ 2014-11-29 14.20.22.png](https://qiita-image-store.s3.amazonaws.com/289/29618/9e833573-d6ae-fc91-4867-02346eaccd47.png \" 2014-11-29 14.20.22.png\")\n\n\u7570\u69d8\u306b\u7c21\u5358\u306b\u3067\u304d\u3066\u4fbf\u5229.\n\n## References\n\n- [GoogleAppsScript - Spreadsheet\u306e\u72ec\u81ea\u95a2\u6570\u3092GAS\u3067\u4f5c\u308b\u3088\u2606 - Qiita](http://qiita.com/soundTricker/items/c9fa4470c59ef677dd5a)\n- [Custom Functions in Google Sheets - Google Apps Script \u2014 Google Developers](https://developers.google.com/apps-script/guides/sheets/functions#using_a_custom_function)\n"}