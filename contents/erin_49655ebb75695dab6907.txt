{"context": "\n\n\u306f\u3058\u3081\u306b\nHaskell\u306eYesod\u3001Scala\u306ePlay2\u306b\u7d9a\u304f\u7b2c\u4e09\u5f3e\u3068\u3057\u3066\u3001\u4eca\u56de\u306fElixir\u306ePhoenix\u306b\u3066CRUD\u51e6\u7406\u304a\u3088\u3073\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3046Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\n\u306a\u304a\u3001\u4eca\u56de\u306e\u30b3\u30fc\u30c9\u306f\u4e0b\u8a18\u3067\u516c\u958b\u3057\u3066\u3044\u307e\u3059\u3002\nhttps://github.com/imahiro-t/phoenix-app.git\n\u4ed6\u306e\u95a2\u6570\u578b\u8a00\u8a9e\u306eWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u306e\u5b9f\u88c5\u306f\u3053\u3061\u3089\nYesod 1.4\u3067\u306eCRUD\u51e6\u7406\u304a\u3088\u3073\u30e1\u30fc\u30eb\u9001\u4fe1\uff08stack\u306b\u3088\u308b\u958b\u767a\u74b0\u5883\u306e\u69cb\u7bc9\u304b\u3089keter\u306b\u3088\u308b\u30c7\u30d7\u30ed\u30a4\u307e\u3067\uff09\nPlay 2.5\u3067\u306eCRUD\u51e6\u7406\u304a\u3088\u3073\u30e1\u30fc\u30eb\u9001\u4fe1\uff08activator\u306b\u3088\u308b\u958b\u767a\u74b0\u5883\u306e\u69cb\u7bc9\u304b\u3089keter\u306b\u3088\u308b\u30c7\u30d7\u30ed\u30a4\u307e\u3067\uff09\n\n\u74b0\u5883\nKona Linux UE 2.0\uff08Ubuntu 16.04 LTS\uff09\uff08\u958b\u767a\u74b0\u5883\uff09\nAmazon EC2\u200e\uff08Ubuntu 14.04 LTS\uff09\uff08\u5b9f\u884c\u74b0\u5883\uff09\nMySQL 5.7.15\n\n\u4f5c\u6210\u3059\u308bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\n\u643a\u5e2f\u96fb\u8a71\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u6a5f\u80fd\u306b\u306f\u3001\u4e88\u5b9a\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u305d\u306e\u958b\u59cb\u65e5\u6642\u306e\u25cb\u5206\u524d\u306b\u30a2\u30e9\u30fc\u30e0\u3092\u306a\u3089\u3059\u6a5f\u80fd\u304c\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u79c1\u306e\u30ac\u30e9\u30db\uff08AQUOS K SHF32\uff09\u3067\u306f\u30a2\u30e9\u30fc\u30e0\u306f\u547c\u51fa\u97f3\u306e\u8a2d\u5b9a\u3068\u9023\u52d5\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3001\u666e\u6bb5\u547c\u51fa\u97f3\u3092\u5207\u3063\u3066\u30d0\u30a4\u30d6\u306e\u307f\u3067\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u5f53\u7136\u30a2\u30e9\u30fc\u30e0\u306f\u9cf4\u3089\u305a\u3001\u305d\u308c\u3060\u3051\u306a\u3089\u307e\u3060\u3057\u3082\u3001\u30d0\u30a4\u30d6\u3059\u3089\u3057\u3066\u304f\u308c\u306a\u3044\u3068\u3044\u3046\u4f7f\u3044\u52dd\u624b\u306e\u60aa\u3055\u3002\n\u6982\u8981\u306f\u3001\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001\u4ef6\u540d\u3001\u65e5\u4ed8\u3001\u6642\u9593\u3001\u901a\u77e5\uff08\u25cb\u5206\u524d\uff09\u3001\u8aac\u660e\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u30b5\u30fc\u30d0\u5074\u3067\u305d\u306e\u901a\u77e5\u6642\u523b\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u3001\u30e1\u30fc\u30eb\u3092\u914d\u4fe1\u3057\u3066\u304f\u308c\u308b\u3068\u3044\u3046Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\n\n\nElixir\u3001Phoenix\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\u307e\u305a\u306f\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u958b\u767a\u74b0\u5883\u306bElixir\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nElixir\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\n$ wget https://packages.erlang-solutions.com/erlang-solutions_1.0_all.deb && sudo dpkg -i erlang-solutions_1.0_all.deb\n$ sudo apt-get update\n$ sudo apt-get install esl-erlang\n$ sudo apt-get install elixir\n\n\u6b21\u306b\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u958b\u767a\u74b0\u5883\u306bPhoenix\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nPhoenix\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\n$ mix archive.install https://github.com/phoenixframework/archives/raw/master/phoenix_new.ez\n\nElixir\u306e\u300cmix\u300d\u306f\u3001Scala\u306e\u300cactivator\u300d\u3084Haskell\u306e\u300cstack\u300d\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u300cNode.js (>= 5.0.0)\u300d\u300cBrunch\u300d\u3001\u3055\u3089\u306bLinux\u74b0\u5883\u3067\u306f\u300cinotify-tools\u300d\u304c\u5fc5\u8981\u3068\u306e\u3053\u3068\u3067\u3059\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\nNode.js\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\nBrunch\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\ninotify-tools\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n$ mix phoenix.new notify --database mysql\n$ cd notify\n\nmix phoenix.new [\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d]\u306fPheonix\u7528\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3001\u4eca\u56de\u306f\u300cnotify\u300d\u3068\u3044\u3046\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3067\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306bMySQL\u3092\u4f7f\u3063\u305fPheonix\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\uff08Brunch\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001--no-brunch\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\uff09\nnotify\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306b\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\u306e\u3067\u3001\u5f8c\u306fnotify\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u3067\u30d5\u30a1\u30a4\u30eb\u306e\u8ffd\u52a0\u3001\u7de8\u96c6\u3092\u884c\u3063\u3066\u3044\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\nModel\u306e\u4f5c\u6210\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306e\u3084\u308a\u53d6\u308a\u306fEcto\u3068\u3044\u3046ORM\u306e\u3088\u3046\u306a\u30e2\u30c7\u30eb\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u7d10\u4ed8\u3051\u3092\u884c\u3046\u30de\u30c3\u30d1\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\u6642\u306bconfig/dev.exs\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306e\u63a5\u7d9a\u306e\u305f\u3081\u306e\u8a2d\u5b9a\u304c\u81ea\u52d5\u7684\u306b\u4f5c\u3089\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u30e6\u30fc\u30b6\u540d\u3084\u30d1\u30b9\u30ef\u30fc\u30c9\u7b49\u3001\u8a2d\u5b9a\u5185\u5bb9\u3092\u9069\u5b9c\u5909\u66f4\u3057\u3066Model\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nconfig/dev.exs\n          \u30fb\n          \u30fb\nconfig :notify, Notify.Repo,\n  adapter: Ecto.Adapters.MySQL,\n  username: \"root\",\n  password: \"\",\n  database: \"notify_phoenix\",\n  pool_size: 20\n\n\n$ mix ecto.create\n$ mix phoenix.gen.model Notification notifications subject:string action_date:date action_time:time notify_before:integer summary:text notify_date_time:datetime sent:boolean\n$ mix ecto.migrate\n\n\u4e0a\u8a18\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u308b\u3060\u3051\u3067\u306a\u304f\u3001web/models/notification.ex\u306b\u30d5\u30a9\u30fc\u30e0\u3068\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u3084\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306e\u30b9\u30b1\u30eb\u30c8\u30f3\u304c\u5b9f\u88c5\u3055\u308c\u305f\u30c7\u30fc\u30bf\u30e2\u30c7\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\u4eca\u56de\u306eWeb\u30a2\u30d7\u30ea\u3067\u306f\u3001\u300cnotify_date_time\u300d\u3084\u300csent\u300d\u306f\u30d5\u30a9\u30fc\u30e0\u5185\u3067\u4f7f\u7528\u3057\u306a\u3044\u30ab\u30e9\u30e0\u3068\u306a\u308a\u3001\u300csummary\u300d\u306f\u5165\u529b\u304c\u4efb\u610f\u306e\u30ab\u30e9\u30e0\u3068\u306a\u308a\u307e\u3059\u306e\u3067web/models/notification.ex\u5185\u306echangeset\u3092\u4e00\u90e8\u4fee\u6b63\u3057\u307e\u3059\u3002\n\nweb/models/notification.ex\ndefmodule Notify.Notification do\n          \u30fb\n          \u30fb\n  def changeset(struct, params \\\\ %{}) do\n    struct\n    |> cast(params, [:subject, :action_date, :action_time, :notify_before, :summary])\n    |> validate_required([:subject, :action_date, :action_time, :notify_before])\n  end\nend\n\n\n\u306a\u304a\u3001mix phoenix.gen.model \u30fb\u30fb\u30fb\u3092mix phoenix.gen.html \u30fb\u30fb\u30fb\u306b\u3059\u308b\u3068\u3001\u5f8c\u8ff0\u3059\u308bController\u3084View\uff08\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u542b\u3080\uff09\u306b\u81f3\u308b\u307e\u3067\u3001\u3059\u3079\u3066\u3092\u81ea\u52d5\u751f\u6210\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\uff08URL\u30d1\u30bf\u30fc\u30f3\u304b\u3089\u30cf\u30f3\u30c9\u30e9\u30fc\u3078\u306e\u5bfe\u5fdc\u4ed8\u3051\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\nweb/routes.ex\ndefmodule Notify.Router do\n          \u30fb\n          \u30fb\n  scope \"/\", Notify do\n          \u30fb\n          \u30fb\n    resources \"/notify\", NotifyController, except: [:show]\n  end\nend\n\n\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u306fget \"/notify\", NotifyController, :index\u3084post \"/notify\", NotifyController, :create\u306e\u3088\u3046\u306b\u500b\u5225\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u304f\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u57fa\u672c\u7684\u306aCRUD\u51e6\u7406\u306e\u307f\u306e\u305f\u3081resources \"/notify\", NotifyController, except: [:show]\u3067\u4e00\u62ec\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\uff08\u4eca\u56de\u306eWeb\u30a2\u30d7\u30ea\u3067\u306f\u4f7f\u7528\u3057\u306a\u3044\u306e\u3067except: [:show]\u3067Notify.NotifyController.show\u95a2\u6570\u3078\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u5916\u3057\u3066\u3044\u307e\u3059\u3002\uff09\n\nController\uff08\u30cf\u30f3\u30c9\u30e9\u30fc\uff09\u306e\u4f5c\u6210\nPhoenix\u3067\u306f\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u306b\u3088\u308a\u3001URL\u30d1\u30bf\u30fc\u30f3\u304b\u3089\u8a72\u5f53\u3059\u308b\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\nweb/controllers/notify_controller.ex\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\nweb/controllers/notify_controller.ex\ndefmodule Notify.NotifyController do\n  use Notify.Web, :controller\n\n  alias Notify.Notification\n\n  def index(conn, _params) do\n    changeset = Notification.changeset(%Notification{})\n    conn\n    |> assign(:notifications_sent_not_yet, notifications_sent_not_yet)\n    |> assign(:notifications_sent, notifications_sent)\n    |> assign(:changeset, changeset)\n    |> assign(:title, \"\u767b\u9332\u753b\u9762\")\n    |> render(\"index.html\")\n  end\n\n  def create(conn, %{\"notification\" => notification_params}) do\n    changeset = Notification.changeset(%Notification{}, notification_params |> modify_action_time)\n\n    case Repo.insert(changeset) do\n      {:ok, notification} ->\n        notify_date_time = calc_notify_date_time(notification)\n        notification\n        |> Ecto.Changeset.change(%{notify_date_time: notify_date_time})\n        |> Repo.update!\n        conn\n        |> put_flash(:info, \"[#{notification.subject}]\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\")\n        |> redirect(to: notify_path(conn, :index))\n      {:error, changeset} ->\n        conn\n        |> assign(:notifications_sent_not_yet, notifications_sent_not_yet)\n        |> assign(:notifications_sent, notifications_sent)\n        |> assign(:changeset, changeset)\n        |> assign(:title, \"\u767b\u9332\u753b\u9762\")\n        |> render(\"index.html\")\n    end\n  end\n\n  def edit(conn, %{\"id\" => id}) do\n    notification = Repo.get!(Notification, id)\n    changeset = Notification.changeset(notification)\n    conn\n    |> assign(:notification, notification)\n    |> assign(:changeset, changeset)\n    |> assign(:title, \"\u7de8\u96c6\u753b\u9762\")\n    |> render(\"edit.html\")\n  end\n\n  def update(conn, %{\"id\" => id, \"notification\" => notification_params}) do\n    notification = Repo.get!(Notification, id)\n    changeset = Notification.changeset(notification, notification_params |> modify_action_time)\n\n    case Repo.update(changeset) do\n      {:ok, notification} ->\n        notify_date_time = calc_notify_date_time(notification)\n        notification\n        |> Ecto.Changeset.change(%{notify_date_time: notify_date_time, sent: false})\n        |> Repo.update!\n        conn\n        |> put_flash(:info, \"[#{notification.subject}]\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\")\n        |> redirect(to: notify_path(conn, :index))\n      {:error, changeset} ->\n        conn\n        |> assign(:notification, notification)\n        |> assign(:changeset, changeset)\n        |> assign(:title, \"\u7de8\u96c6\u753b\u9762\")\n        |> render(\"edit.html\")\n    end\n  end\n\n  def delete(conn, %{\"id\" => id}) do\n    notification = Repo.get!(Notification, id)\n\n    Repo.delete!(notification)\n    conn\n    |> put_flash(:info, \"[#{notification.subject}]\u3092\u524a\u9664\u3057\u307e\u3057\u305f\")\n    |> redirect(to: notify_path(conn, :index))\n  end\n\n  defp modify_action_time(params) do\n    r = ~r/^\\d{2}:\\d{2}$/\n    %{params | \"action_time\" => Regex.replace(r, params[\"action_time\"], \"\\\\0\" <> \":00\")}\n  end\n\n  defp notifications_sent_not_yet do\n    Notification\n    |> where([u], u.sent == false)\n    |> Repo.all\n  end\n\n  defp notifications_sent do\n    Notification\n    |> where([u], u.sent == true)\n    |> Repo.all\n  end\n\n  defp calc_notify_date_time(notification) do\n    Ecto.DateTime.from_date_and_time(notification.action_date, notification.action_time)\n    |> add_minutes(-(notification.notify_before))\n  end\n\n  defp add_minutes(date_time, minutes) do\n    date_time\n    |> Ecto.DateTime.to_erl\n    |> :calendar.datetime_to_gregorian_seconds\n    |> Kernel.+(60 * minutes)\n    |> :calendar.gregorian_seconds_to_datetime\n    |> :calendar.local_time_to_universal_time_dst\n    |> hd\n    |> Ecto.DateTime.from_erl\n  end\nend\n\n\n\nGET\u3067/notify\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306findex\u304c\u547c\u3070\u308c\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u901a\u77e5\u4e88\u5b9a\u306e\u30ec\u30b3\u30fc\u30c9\u30ea\u30b9\u30c8\u3068\u901a\u77e5\u6e08\u307f\u306e\u30ec\u30b3\u30fc\u30c9\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3057\u3001\u767b\u9332\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\nPOST\u3067/notify\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306fcreate\u304c\u547c\u3070\u308c\u3001\u5165\u529b\u5185\u5bb9\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3057\u3001\u305d\u306e\u5f8c\u901a\u77e5\u65e5\u6642\u3092\u8a08\u7b97\u3057\u3066\u304b\u3089\u518d\u5ea6\u30ec\u30b3\u30fc\u30c9\u3092\u66f4\u65b0\u3057\u3001\u767b\u9332\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\nGET\u3067/notify/:id/edit\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306fedit\u304c\u547c\u3070\u308c\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089id\u306b\u8a72\u5f53\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u3001\u7de8\u96c6\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\nPUT\u3067/notify/:id\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306f\u3001update\u304c\u547c\u3070\u308c\u3001\u5165\u529b\u5185\u5bb9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u66f4\u65b0\u3057\u3001\u305d\u306e\u5f8c\u901a\u77e5\u65e5\u6642\u3092\u8a08\u7b97\u3057\u3066\u304b\u3089\u518d\u5ea6\u30ec\u30b3\u30fc\u30c9\u3092\u66f4\u65b0\u3057\u3001\u767b\u9332\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\nDELETE\u3067/notify/:id\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306f\u3001delete\u304c\u547c\u3070\u308c\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089id\u306b\u8a72\u5f53\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3057\u3001\u767b\u9332\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\u300cPUT\u300d\u3084\u300cDELETE\u300d\u306fHTML\u306eFORM\u3067\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u30d5\u30a9\u30fc\u30e0\u5185\u306eHIDDEN\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\"_method\"\u5c5e\u6027\u3092\u3082\u305f\u305b\u308b\u3053\u3068\u3067\u5185\u90e8\u7684\u306b\u5b9f\u73fe\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\u30ec\u30b3\u30fc\u30c9\u306e\u767b\u9332\u3001\u66f4\u65b0\u306fEcto.Changeset\u3092\u4ecb\u3057\u3066\u884c\u3046\u3053\u3068\u306b\u306a\u308a\u3001\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3082\u307e\u305a\u306fEcto.Changeset\u306b\u5909\u63db\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\nEcto.Changeset\u306f\u5dee\u5206\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3092\u884c\u3046\u305f\u3081\u3001Notify.Notification.changeset\u5185\u3067\u308f\u3056\u308f\u3056select\u6587\u3092\u767a\u884c\u3057\u3066\u30d5\u30a9\u30fc\u30e0\u306e\u5165\u529b\u5185\u5bb9\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ec\u30b3\u30fc\u30c9\u3068\u306e\u5dee\u5206\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u305d\u306e\u305f\u3081\u3001action_date\u3001action_time\u3001notify_before\u304b\u3089notify_date_time\u3092\u8a08\u7b97\u3059\u308b\u5834\u5408\u3001\u5148\u306b\u767b\u9332\u30fb\u66f4\u65b0\u51e6\u7406\u3092\u884c\u3044\u3001\u305d\u306e\u5f8c\u3001\u767b\u9332\u30fb\u66f4\u65b0\u304c\u5b8c\u4e86\u3057\u305f\u30ec\u30b3\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u901a\u77e5\u65e5\u6642\u306e\u8a08\u7b97\u3092\u884c\u3063\u3066\u518d\u5ea6\u30ec\u30b3\u30fc\u30c9\u306e\u66f4\u65b0\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\nView\u306e\u4f5c\u6210\n\u307e\u305a\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u5171\u901a\u70b9\u30d7\u30ec\u30fc\u30c8\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\uff08jQuery\u3092\u8aad\u307f\u3053\u3093\u3060\u308a\u3001\u30bf\u30a4\u30c8\u30eb\u30ed\u30b4\u3092\u6d88\u3057\u305f\u308a\u3002\uff09\n\nweb/templates/layout/app.html.eex\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"author\" content=\"\">\n\n    <title><%= @title %></title>\n    <link rel=\"stylesheet\" href=\"<%= static_path(@conn, \"/css/app.css\") %>\">\n    <script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js\"></script>\n  </head>\n\n  <body>\n    <div class=\"container\">\n      <h2><%= @title %></h2>\n\n      <p class=\"alert alert-info\" role=\"alert\"><%= get_flash(@conn, :info) %></p>\n      <p class=\"alert alert-danger\" role=\"alert\"><%= get_flash(@conn, :error) %></p>\n\n      <main role=\"main\">\n        <%= render @view_module, @view_template, assigns %>\n      </main>\n\n    </div> <!-- /container -->\n    <script src=\"<%= static_path(@conn, \"/js/app.js\") %>\"></script>\n  </body>\n</html>\n\n\n\u6b21\u306b\u767b\u9332\u753b\u9762\u3068\u7de8\u96c6\u753b\u9762\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u8aad\u307f\u8fbc\u3080View\u3092web/views/notify_view.ex\u306b\u3002\n\nweb/views/notify_view.ex\ndefmodule Notify.NotifyView do\n  use Notify.Web, :view\nend\n\n\nPhoenix\u3067\u306fPnoenix.HTML\u3092\u5229\u7528\u3057\u3066\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u8a18\u8ff0\u3092\u884c\u3046\u306e\u3067\u3059\u304c\u3001Pnoenix.HTML\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u30d5\u30a9\u30fc\u30e0\u306b\u4f7f\u7528\u3059\u308b\u65e5\u4ed8\u578b\u3068\u65e5\u6642\u578b\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304c\u72ec\u81ea\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\uff08\u5e74\u30fb\u6708\u30fb\u65e5\u304c\u305d\u308c\u305e\u308c\u30b3\u30f3\u30dc\u30dc\u30c3\u30af\u30b9\u306b\u306a\u3063\u3066\u3044\u308b\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\uff09\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001<input type=\"date\">\u3084<input type=\"time\">\u304c\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u5225\u9014\u30d8\u30eb\u30d1\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\nweb/views/form_helpers.ex\ndefmodule Notify.FormHelpers do\n  use Phoenix.HTML\n\n  def date_input(form, field, opts) do\n    input(:date, form, field, opts)\n  end\n\n  def time_input(form, field, opts) do\n    input(:time, form, field, opts)\n  end\n\n  defp input(type, form, field, opts) do\n    opts =\n      opts\n      |> Keyword.put_new(:type, type)\n      |> Keyword.put_new(:id, field_id(form, field))\n      |> Keyword.put_new(:name, field_name(form, field))\n      |> Keyword.put_new(:value, field_value(form, field))\n    tag(:input, opts)\n  end\nend\n\n\n\nweb/web.ex\ndefmodule Notify.Web do\n          \u30fb\n          \u30fb\n  def view do\n    quote do\n          \u30fb\n          \u30fb\n      import Notify.FormHelpers\n    end\n  end\n          \u30fb\n          \u30fb\nend\n\n\n\u767b\u9332\u753b\u9762\u3068\u7de8\u96c6\u753b\u9762\u306e\u5171\u901a\u30d5\u30a9\u30fc\u30e0\u3092web/templates/notify/form.html.eex\u306b\u3002\n\nweb/templates/notify/form.html.eex\n<%\n    notify_before_options =\n        [{\"5\u5206\u524d\",\"5\"},{\"10\u5206\u524d\",\"10\"},{\"15\u5206\u524d\",\"15\"},{\"20\u5206\u524d\",\"20\"}] ++\n        [{\"30\u5206\u524d\",\"30\"},{\"45\u5206\u524d\",\"45\"},{\"1\u6642\u9593\u524d\",\"60\"},{\"2\u6642\u9593\u524d\",\"120\"}]\n%>\n<div class=\"form-group\">\n    <%= label @form, :subject, \"\u4ef6\u540d\", class: \"control-label\" %>\n    <%= text_input @form, :subject, class: \"form-control\", required: \"\" %>\n    <%= error_tag @form, :subject %>\n</div>\n\n<div class=\"form-group\">\n    <%= label @form, :action_date, \"\u65e5\u4ed8\", class: \"control-label\" %>\n    <%= date_input @form, :action_date, class: \"form-control\", required: \"\" %>\n    <%= error_tag @form, :action_date %>\n</div>\n\n<div class=\"form-group\">\n    <%= label @form, :action_time, \"\u6642\u9593\", class: \"control-label\" %>\n    <%= time_input @form, :action_time, class: \"form-control\", required: \"\" %>\n    <%= error_tag @form, :action_time %>\n</div>\n\n<div class=\"form-group\">\n    <%= label @form, :notify_before, \"\u901a\u77e5\", class: \"control-label\" %>\n    <%= select @form, :notify_before, notify_before_options, class: \"form-control\", required: \"\" %>\n    <%= error_tag @form, :notify_before %>\n</div>\n\n<div class=\"form-group\">\n    <%= label @form, :summary, \"\u8aac\u660e\", class: \"control-label\" %>\n    <%= textarea @form, :summary, class: \"form-control\" %>\n    <%= error_tag @form, :summary %>\n</div>\n\n\n\u300c\u65e5\u4ed8\u300d\u3068\u300c\u6642\u9593\u300d\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u3064\u3044\u3066\u306f\u3001\u5148\u307b\u3069\u4f5c\u6210\u3057\u305f\u30d8\u30eb\u30d1\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u95a2\u6570\u3092\u547c\u3073\u51fa\u3057\u3066\u3044\u307e\u3059\u3002\n\u767b\u9332\u753b\u9762\u3092web/templates/notify/index.html.eex\u306b\u3002\n\nweb/templates/notify/index.html.eex\n<table class=\"table\">\n    <thead>\n    <tr>\n        <th>\u901a\u77e5\u30ea\u30b9\u30c8</th>\n        <th></th>\n    </tr>\n    </thead>\n    <tbody>\n    <%= for notification <- @notifications_sent_not_yet do %>\n    <tr>\n        <td><%= notification.subject %></td>\n        <td class=\"text-right\">\n            <%= link \"\u7de8\u96c6\", to: notify_path(@conn, :edit, notification), class: \"btn btn-default btn-xs\" %>\n            <%= link \"\u524a\u9664\", to: notify_path(@conn, :delete, notification), method: :delete, data: [confirm: \"\u524a\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304b?\"], class: \"btn btn-danger btn-xs\" %>\n        </td>\n    </tr>\n    <% end %>\n    </tbody>\n</table>\n\n<%= form_for @changeset, notify_path(@conn, :create), fn form -> %>\n<%= if @changeset.action do %>\n<div class=\"alert alert-danger\">\n    <p>\u5165\u529b\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3059</p>\n</div>\n<% end %>\n\n<%= render \"form.html\", changeset: @changeset, form: form %>\n\n<div class=\"button-group\">\n    <%= submit \"\u767b\u9332\", class: \"btn btn-primary create\" %>\n</div>\n\n<% end %>\n\n<table class=\"table\">\n    <thead>\n    <tr>\n        <th>\u901a\u77e5\u6e08\u30ea\u30b9\u30c8</th>\n        <th></th>\n    </tr>\n    </thead>\n    <tbody>\n    <%= for notification <- @notifications_sent do %>\n    <tr>\n        <td><%= notification.subject %></td>\n        <td class=\"text-right\">\n            <%= link \"\u7de8\u96c6\", to: notify_path(@conn, :edit, notification), class: \"btn btn-default btn-xs\" %>\n            <%= link \"\u524a\u9664\", to: notify_path(@conn, :delete, notification), method: :delete, data: [confirm: \"\u524a\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304b?\"], class: \"btn btn-danger btn-xs\" %>\n        </td>\n    </tr>\n    <% end %>\n    </tbody>\n</table>\n\n\n\u7de8\u96c6\u753b\u9762\u3092web/templates/notify/edit.html.eex\u306b\u3002\n\nweb/templates/notify/edit.html.eex\n<%= form_for @changeset, notify_path(@conn, :update, @notification), fn form -> %>\n<%= if @changeset.action do %>\n<div class=\"alert alert-danger\">\n    <p>\u5165\u529b\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3059</p>\n</div>\n<% end %>\n\n<%= render \"form.html\", changeset: @changeset, form: form %>\n\n<div class=\"button-group\">\n    <%= submit \"\u66f4\u65b0\", class: \"btn btn-primary update\", id: \"update_btn\" %>\n    <%= submit \"\u524a\u9664\", class: \"btn delete\", id: \"delete_btn\" %>\n</div>\n\n<% end %>\n\n<%= link \"HOME\", to: notify_path(@conn, :index) %>\n\n\n\u66f4\u65b0\u30dc\u30bf\u30f3\u30fb\u524a\u9664\u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u305f\u969b\u306b\u3001\u96a0\u3057\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\"_method\"\u306e\u5024\u3092\"put\"\u3068\"delete\"\u306b\u5207\u308a\u66ff\u3048\u308bJavaScript\u3092web/static/js/app.js\u306b\u3002\n\nweb/static/js/app.js\n          \u30fb\n          \u30fb\n$(function(){\n    $('#update_btn').click(function(){\n        $('input[name=\"_method\"]').val('put');\n    });\n    $('#delete_btn').click(function(e){\n        if (window.confirm('\u524a\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304b?')) {\n            $('input[name=\"_method\"]').val('delete');\n        } else {\n            e.preventDefault();\n        }\n    });\n});\n\n\n\u6700\u5f8c\u306bCSS\u3092web/static/css/app.css\u306b\u3002\n\nweb/static/css/app.css\nh2 {\n    background-color: #F36636;\n    color: #FFFFFF;\n    border-radius: 5px;\n    padding: 5px;\n    text-align: center;\n    width: 280px;\n}\n.container, .alert, main {\n    width: 280px;\n}\n.button-group {\n    text-align: center;\n}\nbutton.create {\n    width: 280px;\n}\nbutton.update, button.delete {\n    width: 135px;\n}\n\n\n\u203bBrunch\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001\u4e0a\u8a18\uff12\u3064\u306fpriv/static/js/app.js\u3068priv/static/css/app.css\u306e\u4e0b\u90e8\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u30bf\u30a4\u30de\u30fc\u306e\u4f5c\u6210\n\u901a\u77e5\u6642\u523b\u306b\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3046\u305f\u3081\u30011\u5206\u9593\u9694\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u691c\u7d22\u3057\u3001\u8a72\u5f53\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u304c\u3042\u308b\u5834\u5408\u306b\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u66f4\u65b0\u3001\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\n\u307e\u305a\u306f\u30e1\u30fc\u30eb\u9001\u4fe1\u306e\u305f\u3081\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092mix.ex\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nmix.ex\ndefmodule Notify.Mixfile do\n          \u30fb\n          \u30fb\n  def application do\n    [mod: {Notify, []},\n     applications: [:phoenix, :phoenix_pubsub, :phoenix_html, :cowboy, :logger, :gettext,\n                    :phoenix_ecto, :mariaex, :bamboo, :bamboo_smtp]]\n  end\n          \u30fb\n          \u30fb\n  defp deps do\n    [{:phoenix, \"~> 1.2.1\"},\n     {:phoenix_pubsub, \"~> 1.0\"},\n     {:phoenix_ecto, \"~> 3.0\"},\n     {:mariaex, \">= 0.0.0\"},\n     {:phoenix_html, \"~> 2.6\"},\n     {:phoenix_live_reload, \"~> 1.0\", only: :dev},\n     {:gettext, \"~> 0.11\"},\n     {:cowboy, \"~> 1.0\"},\n     {:bamboo, \"~> 0.7\"},\n     {:bamboo_smtp, \"~> 1.2.1\"}]\n  end\n          \u30fb\n          \u30fb\nend\n\n\n\u30e1\u30fc\u30eb\u30e2\u30b8\u30e5\u30fc\u30eb\u3092Notify.Mailer\u3068\u3057\u3066\u767b\u9332\u3057\u307e\u3059\u3002\n\nlib/notify/mailer.ex\ndefmodule Notify.Mailer do\n  use Bamboo.Mailer, otp_app: :notify\nend\n\n\n\u30e1\u30fc\u30eb\u9001\u4fe1\u7528\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092config/dev.exs\u3068config/config.exs\u306b\u3002\n\nconfig/dev.exs\n          \u30fb\n          \u30fb\nconfig :notify, Notify.Mailer,\n  adapter: Bamboo.SMTPAdapter,\n  server: \"localhost\",\n  port: 25,\n  username: \"\",\n  password: \"\",\n  tls: :never, # can be `:always` or `:never`\n  ssl: false, # can be `true`\n  retries: 1\n\n\n\nconfig/config.exs\n          \u30fb\n          \u30fb\n# General application configuration\nconfig :notify,\n  ecto_repos: [Notify.Repo],\n  mail_from: \"NOTIFY SENDER <from@xxxxxx.xxx>\",\n  mail_to: \"to@xxxxxx.xxx\"\n          \u30fb\n          \u30fb\n\n\n\u672a\u901a\u77e5\u304b\u3064\u901a\u77e5\u6642\u523b\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u691c\u7d22\u3057\u3001\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3046\u30e2\u30b8\u30e5\u30fc\u30eb\u3092web/controllers/notify_checker.ex\u306b\u3002\n\nweb/controllers/notify_checker.ex\ndefmodule Notify.NotifyChecker do\n  import Ecto.Query\n\n  alias Notify.Repo\n  alias Notify.Notification\n  alias Notify.Mailer\n  alias Notify.Email\n\n  def check_notify do\n    for n <- notifications_to_send do\n      send_mail n\n      update_table n\n    end\n  end\n\n  defp notifications_to_send do\n    Notification\n    |> where([u], u.sent == false and u.notify_date_time <= from_now(0, \"microsecond\"))\n    |> Repo.all\n  end\n\n  defp send_mail(notification) do\n    notification\n    |> Email.notify_mail\n    |> Mailer.deliver_now\n  end\n\n  defp update_table(notification) do\n    notification\n    |> Ecto.Changeset.change(%{sent: true})\n    |> Repo.update!\n  end\nend\n\ndefmodule Notify.Email do\n  import Bamboo.Email\n\n  def notify_mail(notification) do\n    new_email\n    |> to(Application.get_env(:notify, :mail_to))\n    |> from(Application.get_env(:notify, :mail_from))\n    |> subject(\"\u3010\u901a\u77e5\u3011 #{notification.subject}\")\n    |> text_body(notification |> notify_body)\n  end\n\n  defp notify_body(notification) do\n    \"\"\"\n    [\u4ef6\u540d]\n    #{notification.subject}\n    [\u65e5\u4ed8]\n    #{notification.action_date}\n    [\u6642\u9593]\n    #{notification.action_time}\n    [\u901a\u77e5]\n    #{Ecto.DateTime.utc |> to_local_date_time}\n    [\u8aac\u660e]\n    #{notification.summary}\n    \"\"\"\n  end\n\n  defp to_local_date_time(utc_date_time) do\n    utc_date_time\n    |> Ecto.DateTime.to_erl\n    |> :calendar.universal_time_to_local_time\n    |> Ecto.DateTime.from_erl\n  end\nend\n\n\n\u30bf\u30a4\u30de\u30fc\u306fGenServer\u306b\u3057\u3066Supervisor\u304c\u7ba1\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\nlib/notify/timer.ex\ndefmodule Notify.Timer do\n  use GenServer\n\n  def start_link(name) do\n    GenServer.start_link(__MODULE__, :ok, name: name)\n  end\n\n  def init(:ok) do\n    check_forever\n    {:ok, %{}}\n  end\n\n  def handle_info(:check_notify, _) do\n    spawn(fn -> Notify.NotifyChecker.check_notify end)\n    check_forever\n    {:noreply, \"\"}\n  end\n\n  defp check_forever do\n    {_, _, sec} = Ecto.Time.utc |> Ecto.Time.to_erl\n    Process.send_after(self, :check_notify, (60-sec)*1000)\n  end\n\nend\n\n\n\nlib/notify.ex\ndefmodule Notify do\n  use Application\n  def start(_type, _args) do\n    children = [\n          \u30fb\n          \u30fb\n      worker(Notify.Timer, [Notify.Timer]),\n    ]\n          \u30fb\n          \u30fb\n  end\n          \u30fb\n          \u30fb\nend\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n$ mix deps.get\n$ mix phoenix.server\n\nhttp://localhost:4000/notify\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\nExrm\u306b\u3088\u308b\u30c7\u30d7\u30ed\u30a4\n\u6700\u5f8c\u306bElixir Release Manager\uff08Exrm\uff09\u3092\u4f7f\u3063\u3066Amazon EC2\u200e\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u306f\u30e2\u30b8\u30e5\u30fc\u30eb\u3092mix.ex\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\nmix.ex\ndefmodule Notify.Mixfile do\n          \u30fb\n          \u30fb\n  defp deps do\n    [{:phoenix, \"~> 1.2.1\"},\n     {:phoenix_pubsub, \"~> 1.0\"},\n     {:phoenix_ecto, \"~> 3.0\"},\n     {:mariaex, \">= 0.0.0\"},\n     {:phoenix_html, \"~> 2.6\"},\n     {:phoenix_live_reload, \"~> 1.0\", only: :dev},\n     {:gettext, \"~> 0.11\"},\n     {:cowboy, \"~> 1.0\"},\n     {:bamboo, \"~> 0.7\"},\n     {:bamboo_smtp, \"~> 1.2.1\"},\n     {:exrm, \"~> 1.0\"}]\n  end\n          \u30fb\n          \u30fb\nend\n\n\n\u30db\u30b9\u30c8\u540d\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\nconfig/prod.exs\n          \u30fb\n          \u30fb\nconfig :notify, Notify.Endpoint,\n  http: [port: {:system, \"PORT\"}],\n  url: [host: \"host.xxxx.xx\"],\n  cache_static_manifest: \"priv/static/manifest.json\",\n  root: \".\",\n  server: true,\n  version: Mix.Project.config[:version]\n          \u30fb\n          \u30fb\n\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9\u3068\u30e1\u30fc\u30eb\u9001\u4fe1\u7528\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306fconfig/prod.secret.exs\u306b\u884c\u3044\u307e\u3059\u3002\n\nconfig/prod.secret.exs\n          \u30fb\n          \u30fb\nconfig :notify, Notify.Repo,\n  adapter: Ecto.Adapters.MySQL,\n  username: \"root\",\n  password: \"\",\n  database: \"notify_phoenix\",\n  pool_size: 20\n\nconfig :notify, Notify.Mailer,\n  adapter: Bamboo.SMTPAdapter,\n  server: \"localhost\",\n  port: 25,\n  username: \"\",\n  password: \"\",\n  tls: :never, # can be `:always` or `:never`\n  ssl: false, # can be `true`\n  retries: 1\n\n\n\u30c7\u30d7\u30ed\u30a4\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ mix deps.get\n$ MIX_ENV=prod mix phoenix.digest\n$ MIX_ENV=prod mix compile\n$ MIX_ENV=prod mix release\n\n\u4f5c\u6210\u3055\u308c\u305frel/notify/releases/0.0.1/notify.tar.gz\u3092\u30b5\u30fc\u30d0\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3001\u4e88\u3081\u4f5c\u6210\u3057\u3066\u304a\u3044\u305f/opt/notify_phoenix/\u5185\u306b\u653e\u308a\u8fbc\u3093\u3067\u89e3\u51cd\u3057\u307e\u3059\u3002\n\u6b21\u306b\u8d77\u52d5\u7528\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092/etc/init/notify_phoenix.conf\u306b\u3002\n\n/etc/init/notify_phoenix.conf\ndescription \"notify_phoenix\"\n\nsetuid ubuntu\nsetgid ubuntu\n\nstart on runlevel [2345]\nstop on runlevel [016]\n\nexpect stop\nrespawn\n\nenv MIX_ENV=prod\nexport MIX_ENV\n\n## Uncomment the following two lines if we configured\n## our port with an environment variable.\nenv PORT=4444\nexport PORT\n\n## Add app HOME directory.\nenv HOME=/opt/notify_phoenix\nexport HOME\n\npre-start exec /bin/sh $HOME/bin/notify start\n\npost-stop exec /bin/sh $HOME/bin/notify stop\n\n\n\u8d77\u52d5\u3057\u307e\u3059\u3002\n$ sudo start notify_phoenix\n\nhttp://host.xxxx.xx:4444/notify\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u3055\u3044\u3054\u306b\n\u95a2\u6570\u578b\u8a00\u8a9e\u306eWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u3057\u3066\u3001\u4eca\u56de\u306fElixir\u306ePhoenix\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\nElixir\u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u8a18\u8ff0\u65b9\u6cd5\u304c\u3068\u3066\u3082\u697d\u3057\u304f\u3001\u3067\u304d\u308b\u3060\u3051\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092\u4f7f\u3046\u3088\u3046\u5fc3\u304c\u3051\u3066\u3044\u305f\u3089\u3001\u81ea\u7136\u3068\u5ba3\u8a00\u7684\u306a\u8a18\u8ff0\u3092\u6301\u3064\u5c0f\u3055\u306a\u95a2\u6570\u304c\u305f\u304f\u3055\u3093\u51fa\u6765\u307e\u3057\u305f\u3002\n\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306f\u30c7\u30fc\u30bf\u3092\u5909\u63db\u3057\u3066\u3044\u304f\u904e\u7a0b\u304c\u3088\u304f\u5206\u304b\u308a\u3001\u4e3b\u8ef8\u3067\u306a\u3044\u3082\u306e\u3092\u5916\u90e8\u95a2\u6570\u3068\u3057\u3066\u653e\u308a\u51fa\u3059\u3053\u3068\u3067\u3001\u95a2\u6570\u306e\u8cac\u52d9\u3092\u9650\u5b9a\u7684\u3059\u308b\u3068\u3044\u3046\u826f\u3044\u7fd2\u6163\u304c\u8eab\u306b\u3064\u304d\u305d\u3046\u3067\u3059\u3002\nPhoenix\u3082\u6d17\u7df4\u3055\u308c\u305fWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3001Elixir\u3068Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u76f8\u6027\u306e\u826f\u3055\u3092\u611f\u3058\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\u7570\u306a\u308b\u8a00\u8a9e\u30fb\u7570\u306a\u308bWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3082\u3001\u6bce\u5ea6\u4f3c\u305f\u601d\u60f3\u3092\u6301\u3064\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u540c\u3058Web\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5b9f\u88c5\u306e\u6d41\u308c\u306f\u3060\u3044\u305f\u3044\u540c\u3058\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306eElixir\uff0bPhoenix\u306e\u958b\u767a\u52b9\u7387\u306f\u7fa4\u3092\u629c\u3044\u3066\u3044\u308b\u3068\u611f\u3058\u307e\u3057\u305f\u3002\nElixir\u3067\u306f\u305d\u308c\u305e\u308c\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u72ec\u7acb\u3057\u3066\u3044\u3066\u3001\u76f8\u4e92\u304c\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u3084\u308a\u53d6\u308a\u3067\u52d5\u3044\u3066\u3044\u308b\u3089\u3057\u3044\u306e\u3067\u3059\u304c\u3001\u8868\u9762\u4e0a\u306e\u5b9f\u88c5\u3067\u306f\u305d\u308c\u3092\u611f\u3058\u308b\u3053\u3068\u306f\u3067\u304d\u305a\u3001\u901a\u5e38\u306e\u95a2\u6570\u547c\u3073\u51fa\u3057\u306e\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u3002\uff08\u95a2\u6570\u304c\u547c\u3070\u308c\u308b\u3068\u95a2\u6570\u5185\u90e8\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u3092\u884c\u3063\u3066\u3044\u308b\u611f\u3058\u3060\u3068\u601d\u3044\u307e\u3059\u3002\uff09\n\u4eca\u56de\u306eWeb\u30a2\u30d7\u30ea\u3067\u3082\u3001Ecto\u3084Mailer\u3001Timer\u306a\u3069\u304c\u305d\u308c\u305e\u308c\u72ec\u7acb\u3057\u305f\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u6301\u3063\u3066\u52d5\u3044\u3066\u3044\u308b\u306e\u3067\u3001\u76f8\u4e92\u306b\u4f9d\u5b58\u95a2\u4fc2\u304c\u767a\u751f\u305b\u305a\u3001\u4f8b\u3048\u3070\u5225\u30d7\u30ed\u30bb\u30b9\u3067\u52d5\u3044\u3066\u3044\u308bTimer\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u308a\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u305f\u308a\u3059\u308b\u969b\u306b\u3082\u3001\u95a2\u6570\u578b\u8a00\u8a9e\u3067\u3042\u308a\u306a\u304c\u3089\u5f15\u6570\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u60c5\u5831\u3084\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306e\u60c5\u5831\u3092\u6e21\u3059\u5fc5\u8981\u304c\u306a\u304f\u3001\u3068\u3066\u3082\u3059\u3063\u304d\u308a\u3068\u3057\u305f\u30b3\u30fc\u30c9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\uff08\u304b\u3068\u8a00\u3063\u3066\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u5024\u3092\u6301\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3082\u306a\u304f\u3001\u3069\u3061\u3089\u304b\u3068\u8a00\u3048\u3070DI\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3057\u3087\u3046\u304b\u3002\uff09\n\u4ed6\u306e\u8a00\u8a9e\u3067\u3082\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u306b\u3088\u308b\u540c\u69d8\u306e\u5b9f\u88c5\u306f\u53ef\u80fd\u306a\u306e\u3067\u3057\u3087\u3046\u304c\u3001Elixir\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u304c\u300c\u3053\u308c\u300d\u3068\u3044\u3046\u306e\u304c\u958b\u767a\u52b9\u7387\u306e\u9762\u3067\u5927\u304d\u3044\u306e\u3060\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n# \u306f\u3058\u3081\u306b\n\nHaskell\u306eYesod\u3001Scala\u306ePlay2\u306b\u7d9a\u304f\u7b2c\u4e09\u5f3e\u3068\u3057\u3066\u3001\u4eca\u56de\u306fElixir\u306ePhoenix\u306b\u3066CRUD\u51e6\u7406\u304a\u3088\u3073\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3046Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u4eca\u56de\u306e\u30b3\u30fc\u30c9\u306f\u4e0b\u8a18\u3067\u516c\u958b\u3057\u3066\u3044\u307e\u3059\u3002\nhttps://github.com/imahiro-t/phoenix-app.git\n\n\u4ed6\u306e\u95a2\u6570\u578b\u8a00\u8a9e\u306eWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u306e\u5b9f\u88c5\u306f\u3053\u3061\u3089\n[Yesod 1.4\u3067\u306eCRUD\u51e6\u7406\u304a\u3088\u3073\u30e1\u30fc\u30eb\u9001\u4fe1\uff08stack\u306b\u3088\u308b\u958b\u767a\u74b0\u5883\u306e\u69cb\u7bc9\u304b\u3089keter\u306b\u3088\u308b\u30c7\u30d7\u30ed\u30a4\u307e\u3067\uff09](http://qiita.com/erin/items/55e0109e4be6b3257bef)\n[Play 2.5\u3067\u306eCRUD\u51e6\u7406\u304a\u3088\u3073\u30e1\u30fc\u30eb\u9001\u4fe1\uff08activator\u306b\u3088\u308b\u958b\u767a\u74b0\u5883\u306e\u69cb\u7bc9\u304b\u3089keter\u306b\u3088\u308b\u30c7\u30d7\u30ed\u30a4\u307e\u3067\uff09](http://qiita.com/erin/items/1a49e728b42473a9364f)\n\n# \u74b0\u5883\n\nKona Linux UE 2.0\uff08Ubuntu 16.04 LTS\uff09\uff08\u958b\u767a\u74b0\u5883\uff09\nAmazon EC2\u200e\uff08Ubuntu 14.04 LTS\uff09\uff08\u5b9f\u884c\u74b0\u5883\uff09\nMySQL 5.7.15\n\n# \u4f5c\u6210\u3059\u308bWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\n\n\u643a\u5e2f\u96fb\u8a71\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u6a5f\u80fd\u306b\u306f\u3001\u4e88\u5b9a\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u305d\u306e\u958b\u59cb\u65e5\u6642\u306e\u25cb\u5206\u524d\u306b\u30a2\u30e9\u30fc\u30e0\u3092\u306a\u3089\u3059\u6a5f\u80fd\u304c\u3042\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\u79c1\u306e\u30ac\u30e9\u30db\uff08AQUOS K SHF32\uff09\u3067\u306f\u30a2\u30e9\u30fc\u30e0\u306f\u547c\u51fa\u97f3\u306e\u8a2d\u5b9a\u3068\u9023\u52d5\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3001\u666e\u6bb5\u547c\u51fa\u97f3\u3092\u5207\u3063\u3066\u30d0\u30a4\u30d6\u306e\u307f\u3067\u4f7f\u7528\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u5f53\u7136\u30a2\u30e9\u30fc\u30e0\u306f\u9cf4\u3089\u305a\u3001\u305d\u308c\u3060\u3051\u306a\u3089\u307e\u3060\u3057\u3082\u3001\u30d0\u30a4\u30d6\u3059\u3089\u3057\u3066\u304f\u308c\u306a\u3044\u3068\u3044\u3046\u4f7f\u3044\u52dd\u624b\u306e\u60aa\u3055\u3002\n\n\u6982\u8981\u306f\u3001\u30b5\u30a4\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3001\u4ef6\u540d\u3001\u65e5\u4ed8\u3001\u6642\u9593\u3001\u901a\u77e5\uff08\u25cb\u5206\u524d\uff09\u3001\u8aac\u660e\u3092\u767b\u9332\u3059\u308b\u3068\u3001\u30b5\u30fc\u30d0\u5074\u3067\u305d\u306e\u901a\u77e5\u6642\u523b\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u3001\u30e1\u30fc\u30eb\u3092\u914d\u4fe1\u3057\u3066\u304f\u308c\u308b\u3068\u3044\u3046Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\n\n![notify_index.png](https://qiita-image-store.s3.amazonaws.com/0/94455/49ef8e08-d20a-e8ed-2c0b-db229da00df5.png)\n![notify_edit.png](https://qiita-image-store.s3.amazonaws.com/0/94455/a23143ca-6b18-90a6-0886-8d5e272081b8.png)\n\n# Elixir\u3001Phoenix\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n\u307e\u305a\u306f\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u958b\u767a\u74b0\u5883\u306bElixir\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n[Elixir\u306e\u516c\u5f0f\u30b5\u30a4\u30c8](http://elixir-lang.org/install.html)\n\n```\n$ wget https://packages.erlang-solutions.com/erlang-solutions_1.0_all.deb && sudo dpkg -i erlang-solutions_1.0_all.deb\n$ sudo apt-get update\n$ sudo apt-get install esl-erlang\n$ sudo apt-get install elixir\n```\n\n\u6b21\u306b\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u958b\u767a\u74b0\u5883\u306bPhoenix\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n[Phoenix\u306e\u516c\u5f0f\u30b5\u30a4\u30c8](http://www.phoenixframework.org/docs/installation)\n\n```\n$ mix archive.install https://github.com/phoenixframework/archives/raw/master/phoenix_new.ez\n```\n\nElixir\u306e\u300cmix\u300d\u306f\u3001Scala\u306e\u300cactivator\u300d\u3084Haskell\u306e\u300cstack\u300d\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002\n\n\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u300cNode.js (>= 5.0.0)\u300d\u300cBrunch\u300d\u3001\u3055\u3089\u306bLinux\u74b0\u5883\u3067\u306f\u300cinotify-tools\u300d\u304c\u5fc5\u8981\u3068\u306e\u3053\u3068\u3067\u3059\u306e\u3067\u3001\u305d\u308c\u305e\u308c\u306e\u516c\u5f0f\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n[Node.js\u306e\u516c\u5f0f\u30b5\u30a4\u30c8](https://nodejs.org/en/download/)\n[Brunch\u306e\u516c\u5f0f\u30b5\u30a4\u30c8](http://brunch.io/)\n[inotify-tools\u306e\u516c\u5f0f\u30b5\u30a4\u30c8](https://github.com/rvoicilas/inotify-tools/wiki)\n\n# \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\n\n```\n$ mix phoenix.new notify --database mysql\n$ cd notify\n```\n\n`mix phoenix.new [\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d]`\u306fPheonix\u7528\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u6210\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3001\u4eca\u56de\u306f\u300cnotify\u300d\u3068\u3044\u3046\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u540d\u3067\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306bMySQL\u3092\u4f7f\u3063\u305fPheonix\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\uff08Brunch\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001`--no-brunch`\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u3064\u3051\u3066\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\uff09\n\nnotify\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u306b\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\u306e\u3067\u3001\u5f8c\u306fnotify\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u5185\u3067\u30d5\u30a1\u30a4\u30eb\u306e\u8ffd\u52a0\u3001\u7de8\u96c6\u3092\u884c\u3063\u3066\u3044\u304f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n# Model\u306e\u4f5c\u6210\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306e\u3084\u308a\u53d6\u308a\u306f[Ecto](https://hexdocs.pm/ecto/Ecto.html)\u3068\u3044\u3046ORM\u306e\u3088\u3046\u306a\u30e2\u30c7\u30eb\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u7d10\u4ed8\u3051\u3092\u884c\u3046\u30de\u30c3\u30d1\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u3044\u307e\u3059\u3002\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\u6642\u306b`config/dev.exs`\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u306e\u63a5\u7d9a\u306e\u305f\u3081\u306e\u8a2d\u5b9a\u304c\u81ea\u52d5\u7684\u306b\u4f5c\u3089\u308c\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u30e6\u30fc\u30b6\u540d\u3084\u30d1\u30b9\u30ef\u30fc\u30c9\u7b49\u3001\u8a2d\u5b9a\u5185\u5bb9\u3092\u9069\u5b9c\u5909\u66f4\u3057\u3066Model\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```config/dev.exs\n          \u30fb\n          \u30fb\nconfig :notify, Notify.Repo,\n  adapter: Ecto.Adapters.MySQL,\n  username: \"root\",\n  password: \"\",\n  database: \"notify_phoenix\",\n  pool_size: 20\n```\n\n```\n$ mix ecto.create\n$ mix phoenix.gen.model Notification notifications subject:string action_date:date action_time:time notify_before:integer summary:text notify_date_time:datetime sent:boolean\n$ mix ecto.migrate\n```\n\n\u4e0a\u8a18\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u308b\u3060\u3051\u3067\u306a\u304f\u3001`web/models/notification.ex`\u306b\u30d5\u30a9\u30fc\u30e0\u3068\u306e\u30de\u30c3\u30d4\u30f3\u30b0\u3084\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306e\u30b9\u30b1\u30eb\u30c8\u30f3\u304c\u5b9f\u88c5\u3055\u308c\u305f\u30c7\u30fc\u30bf\u30e2\u30c7\u30eb\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\n\n\u4eca\u56de\u306eWeb\u30a2\u30d7\u30ea\u3067\u306f\u3001\u300cnotify_date_time\u300d\u3084\u300csent\u300d\u306f\u30d5\u30a9\u30fc\u30e0\u5185\u3067\u4f7f\u7528\u3057\u306a\u3044\u30ab\u30e9\u30e0\u3068\u306a\u308a\u3001\u300csummary\u300d\u306f\u5165\u529b\u304c\u4efb\u610f\u306e\u30ab\u30e9\u30e0\u3068\u306a\u308a\u307e\u3059\u306e\u3067`web/models/notification.ex`\u5185\u306e`changeset`\u3092\u4e00\u90e8\u4fee\u6b63\u3057\u307e\u3059\u3002\n\n```web/models/notification.ex\ndefmodule Notify.Notification do\n          \u30fb\n          \u30fb\n  def changeset(struct, params \\\\ %{}) do\n    struct\n    |> cast(params, [:subject, :action_date, :action_time, :notify_before, :summary])\n    |> validate_required([:subject, :action_date, :action_time, :notify_before])\n  end\nend\n```\n\n\u306a\u304a\u3001`mix phoenix.gen.model \u30fb\u30fb\u30fb`\u3092`mix phoenix.gen.html \u30fb\u30fb\u30fb`\u306b\u3059\u308b\u3068\u3001\u5f8c\u8ff0\u3059\u308bController\u3084View\uff08\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u542b\u3080\uff09\u306b\u81f3\u308b\u307e\u3067\u3001\u3059\u3079\u3066\u3092\u81ea\u52d5\u751f\u6210\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n# \u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\n\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\uff08URL\u30d1\u30bf\u30fc\u30f3\u304b\u3089\u30cf\u30f3\u30c9\u30e9\u30fc\u3078\u306e\u5bfe\u5fdc\u4ed8\u3051\uff09\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n```web/routes.ex\ndefmodule Notify.Router do\n          \u30fb\n          \u30fb\n  scope \"/\", Notify do\n          \u30fb\n          \u30fb\n    resources \"/notify\", NotifyController, except: [:show]\n  end\nend\n```\n\n\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u306f`get \"/notify\", NotifyController, :index`\u3084`post \"/notify\", NotifyController, :create`\u306e\u3088\u3046\u306b\u500b\u5225\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u304f\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u304c\u3001\u4eca\u56de\u306f\u57fa\u672c\u7684\u306aCRUD\u51e6\u7406\u306e\u307f\u306e\u305f\u3081`resources \"/notify\", NotifyController, except: [:show]`\u3067\u4e00\u62ec\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\uff08\u4eca\u56de\u306eWeb\u30a2\u30d7\u30ea\u3067\u306f\u4f7f\u7528\u3057\u306a\u3044\u306e\u3067`except: [:show]`\u3067`Notify.NotifyController.show`\u95a2\u6570\u3078\u306e\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u5916\u3057\u3066\u3044\u307e\u3059\u3002\uff09\n\n# Controller\uff08\u30cf\u30f3\u30c9\u30e9\u30fc\uff09\u306e\u4f5c\u6210\n\nPhoenix\u3067\u306f\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u8a2d\u5b9a\u306b\u3088\u308a\u3001URL\u30d1\u30bf\u30fc\u30f3\u304b\u3089\u8a72\u5f53\u3059\u308b\u30cf\u30f3\u30c9\u30e9\u30fc\u304c\u547c\u3073\u51fa\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n`web/controllers/notify_controller.ex`\u306b\u4e0b\u8a18\u306e\u5b9f\u88c5\u3092\u3002\n\n```web/controllers/notify_controller.ex\ndefmodule Notify.NotifyController do\n  use Notify.Web, :controller\n\n  alias Notify.Notification\n\n  def index(conn, _params) do\n    changeset = Notification.changeset(%Notification{})\n    conn\n    |> assign(:notifications_sent_not_yet, notifications_sent_not_yet)\n    |> assign(:notifications_sent, notifications_sent)\n    |> assign(:changeset, changeset)\n    |> assign(:title, \"\u767b\u9332\u753b\u9762\")\n    |> render(\"index.html\")\n  end\n\n  def create(conn, %{\"notification\" => notification_params}) do\n    changeset = Notification.changeset(%Notification{}, notification_params |> modify_action_time)\n\n    case Repo.insert(changeset) do\n      {:ok, notification} ->\n        notify_date_time = calc_notify_date_time(notification)\n        notification\n        |> Ecto.Changeset.change(%{notify_date_time: notify_date_time})\n        |> Repo.update!\n        conn\n        |> put_flash(:info, \"[#{notification.subject}]\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f\")\n        |> redirect(to: notify_path(conn, :index))\n      {:error, changeset} ->\n        conn\n        |> assign(:notifications_sent_not_yet, notifications_sent_not_yet)\n        |> assign(:notifications_sent, notifications_sent)\n        |> assign(:changeset, changeset)\n        |> assign(:title, \"\u767b\u9332\u753b\u9762\")\n        |> render(\"index.html\")\n    end\n  end\n\n  def edit(conn, %{\"id\" => id}) do\n    notification = Repo.get!(Notification, id)\n    changeset = Notification.changeset(notification)\n    conn\n    |> assign(:notification, notification)\n    |> assign(:changeset, changeset)\n    |> assign(:title, \"\u7de8\u96c6\u753b\u9762\")\n    |> render(\"edit.html\")\n  end\n\n  def update(conn, %{\"id\" => id, \"notification\" => notification_params}) do\n    notification = Repo.get!(Notification, id)\n    changeset = Notification.changeset(notification, notification_params |> modify_action_time)\n\n    case Repo.update(changeset) do\n      {:ok, notification} ->\n        notify_date_time = calc_notify_date_time(notification)\n        notification\n        |> Ecto.Changeset.change(%{notify_date_time: notify_date_time, sent: false})\n        |> Repo.update!\n        conn\n        |> put_flash(:info, \"[#{notification.subject}]\u3092\u66f4\u65b0\u3057\u307e\u3057\u305f\")\n        |> redirect(to: notify_path(conn, :index))\n      {:error, changeset} ->\n        conn\n        |> assign(:notification, notification)\n        |> assign(:changeset, changeset)\n        |> assign(:title, \"\u7de8\u96c6\u753b\u9762\")\n        |> render(\"edit.html\")\n    end\n  end\n\n  def delete(conn, %{\"id\" => id}) do\n    notification = Repo.get!(Notification, id)\n\n    Repo.delete!(notification)\n    conn\n    |> put_flash(:info, \"[#{notification.subject}]\u3092\u524a\u9664\u3057\u307e\u3057\u305f\")\n    |> redirect(to: notify_path(conn, :index))\n  end\n\n  defp modify_action_time(params) do\n    r = ~r/^\\d{2}:\\d{2}$/\n    %{params | \"action_time\" => Regex.replace(r, params[\"action_time\"], \"\\\\0\" <> \":00\")}\n  end\n\n  defp notifications_sent_not_yet do\n    Notification\n    |> where([u], u.sent == false)\n    |> Repo.all\n  end\n\n  defp notifications_sent do\n    Notification\n    |> where([u], u.sent == true)\n    |> Repo.all\n  end\n\n  defp calc_notify_date_time(notification) do\n    Ecto.DateTime.from_date_and_time(notification.action_date, notification.action_time)\n    |> add_minutes(-(notification.notify_before))\n  end\n\n  defp add_minutes(date_time, minutes) do\n    date_time\n    |> Ecto.DateTime.to_erl\n    |> :calendar.datetime_to_gregorian_seconds\n    |> Kernel.+(60 * minutes)\n    |> :calendar.gregorian_seconds_to_datetime\n    |> :calendar.local_time_to_universal_time_dst\n    |> hd\n    |> Ecto.DateTime.from_erl\n  end\nend\n\n```\n\nGET\u3067/notify\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306f`index`\u304c\u547c\u3070\u308c\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089\u901a\u77e5\u4e88\u5b9a\u306e\u30ec\u30b3\u30fc\u30c9\u30ea\u30b9\u30c8\u3068\u901a\u77e5\u6e08\u307f\u306e\u30ec\u30b3\u30fc\u30c9\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3057\u3001\u767b\u9332\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\nPOST\u3067/notify\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306f`create`\u304c\u547c\u3070\u308c\u3001\u5165\u529b\u5185\u5bb9\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u767b\u9332\u3057\u3001\u305d\u306e\u5f8c\u901a\u77e5\u65e5\u6642\u3092\u8a08\u7b97\u3057\u3066\u304b\u3089\u518d\u5ea6\u30ec\u30b3\u30fc\u30c9\u3092\u66f4\u65b0\u3057\u3001\u767b\u9332\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\nGET\u3067/notify/:id/edit\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306f`edit`\u304c\u547c\u3070\u308c\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089id\u306b\u8a72\u5f53\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u3092\u53d6\u5f97\u3057\u3001\u7de8\u96c6\u753b\u9762\u3092\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\nPUT\u3067/notify/:id\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306f\u3001`update`\u304c\u547c\u3070\u308c\u3001\u5165\u529b\u5185\u5bb9\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u66f4\u65b0\u3057\u3001\u305d\u306e\u5f8c\u901a\u77e5\u65e5\u6642\u3092\u8a08\u7b97\u3057\u3066\u304b\u3089\u518d\u5ea6\u30ec\u30b3\u30fc\u30c9\u3092\u66f4\u65b0\u3057\u3001\u767b\u9332\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\nDELETE\u3067/notify/:id\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u3068\u304d\u306f\u3001`delete`\u304c\u547c\u3070\u308c\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304b\u3089id\u306b\u8a72\u5f53\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u3092\u524a\u9664\u3057\u3001\u767b\u9332\u753b\u9762\u306b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u300cPUT\u300d\u3084\u300cDELETE\u300d\u306fHTML\u306eFORM\u3067\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u304c\u3001\u30d5\u30a9\u30fc\u30e0\u5185\u306eHIDDEN\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\"_method\"\u5c5e\u6027\u3092\u3082\u305f\u305b\u308b\u3053\u3068\u3067\u5185\u90e8\u7684\u306b\u5b9f\u73fe\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u30ec\u30b3\u30fc\u30c9\u306e\u767b\u9332\u3001\u66f4\u65b0\u306fEcto.Changeset\u3092\u4ecb\u3057\u3066\u884c\u3046\u3053\u3068\u306b\u306a\u308a\u3001\u30d5\u30a9\u30fc\u30e0\u304b\u3089\u306e\u5165\u529b\u5185\u5bb9\u3082\u307e\u305a\u306fEcto.Changeset\u306b\u5909\u63db\u3055\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\nEcto.Changeset\u306f\u5dee\u5206\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3092\u884c\u3046\u305f\u3081\u3001Notify.Notification.changeset\u5185\u3067\u308f\u3056\u308f\u3056select\u6587\u3092\u767a\u884c\u3057\u3066\u30d5\u30a9\u30fc\u30e0\u306e\u5165\u529b\u5185\u5bb9\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30ec\u30b3\u30fc\u30c9\u3068\u306e\u5dee\u5206\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3057\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u305d\u306e\u305f\u3081\u3001action_date\u3001action_time\u3001notify_before\u304b\u3089notify_date_time\u3092\u8a08\u7b97\u3059\u308b\u5834\u5408\u3001\u5148\u306b\u767b\u9332\u30fb\u66f4\u65b0\u51e6\u7406\u3092\u884c\u3044\u3001\u305d\u306e\u5f8c\u3001\u767b\u9332\u30fb\u66f4\u65b0\u304c\u5b8c\u4e86\u3057\u305f\u30ec\u30b3\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u901a\u77e5\u65e5\u6642\u306e\u8a08\u7b97\u3092\u884c\u3063\u3066\u518d\u5ea6\u30ec\u30b3\u30fc\u30c9\u306e\u66f4\u65b0\u51e6\u7406\u3092\u884c\u3063\u3066\u3044\u307e\u3059\u3002\n\n# View\u306e\u4f5c\u6210\n\n\u307e\u305a\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u5171\u901a\u70b9\u30d7\u30ec\u30fc\u30c8\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\uff08jQuery\u3092\u8aad\u307f\u3053\u3093\u3060\u308a\u3001\u30bf\u30a4\u30c8\u30eb\u30ed\u30b4\u3092\u6d88\u3057\u305f\u308a\u3002\uff09\n\n```web/templates/layout/app.html.eex\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"author\" content=\"\">\n\n    <title><%= @title %></title>\n    <link rel=\"stylesheet\" href=\"<%= static_path(@conn, \"/css/app.css\") %>\">\n    <script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js\"></script>\n  </head>\n\n  <body>\n    <div class=\"container\">\n      <h2><%= @title %></h2>\n\n      <p class=\"alert alert-info\" role=\"alert\"><%= get_flash(@conn, :info) %></p>\n      <p class=\"alert alert-danger\" role=\"alert\"><%= get_flash(@conn, :error) %></p>\n\n      <main role=\"main\">\n        <%= render @view_module, @view_template, assigns %>\n      </main>\n\n    </div> <!-- /container -->\n    <script src=\"<%= static_path(@conn, \"/js/app.js\") %>\"></script>\n  </body>\n</html>\n```\n\n\u6b21\u306b\u767b\u9332\u753b\u9762\u3068\u7de8\u96c6\u753b\u9762\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u8aad\u307f\u8fbc\u3080View\u3092`web/views/notify_view.ex`\u306b\u3002\n\n```web/views/notify_view.ex\ndefmodule Notify.NotifyView do\n  use Notify.Web, :view\nend\n```\n\nPhoenix\u3067\u306f[Pnoenix.HTML](https://hexdocs.pm/phoenix_html/Phoenix.HTML.html)\u3092\u5229\u7528\u3057\u3066\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u8a18\u8ff0\u3092\u884c\u3046\u306e\u3067\u3059\u304c\u3001Pnoenix.HTML\u3067\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u30d5\u30a9\u30fc\u30e0\u306b\u4f7f\u7528\u3059\u308b\u65e5\u4ed8\u578b\u3068\u65e5\u6642\u578b\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304c\u72ec\u81ea\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\uff08\u5e74\u30fb\u6708\u30fb\u65e5\u304c\u305d\u308c\u305e\u308c\u30b3\u30f3\u30dc\u30dc\u30c3\u30af\u30b9\u306b\u306a\u3063\u3066\u3044\u308b\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\uff09\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u3001`<input type=\"date\">`\u3084`<input type=\"time\">`\u304c\u4f7f\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u5225\u9014\u30d8\u30eb\u30d1\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```web/views/form_helpers.ex\ndefmodule Notify.FormHelpers do\n  use Phoenix.HTML\n\n  def date_input(form, field, opts) do\n    input(:date, form, field, opts)\n  end\n\n  def time_input(form, field, opts) do\n    input(:time, form, field, opts)\n  end\n\n  defp input(type, form, field, opts) do\n    opts =\n      opts\n      |> Keyword.put_new(:type, type)\n      |> Keyword.put_new(:id, field_id(form, field))\n      |> Keyword.put_new(:name, field_name(form, field))\n      |> Keyword.put_new(:value, field_value(form, field))\n    tag(:input, opts)\n  end\nend\n```\n\n```web/web.ex\ndefmodule Notify.Web do\n          \u30fb\n          \u30fb\n  def view do\n    quote do\n          \u30fb\n          \u30fb\n      import Notify.FormHelpers\n    end\n  end\n          \u30fb\n          \u30fb\nend\n```\n\n\u767b\u9332\u753b\u9762\u3068\u7de8\u96c6\u753b\u9762\u306e\u5171\u901a\u30d5\u30a9\u30fc\u30e0\u3092`web/templates/notify/form.html.eex`\u306b\u3002\n\n```web/templates/notify/form.html.eex\n<%\n    notify_before_options =\n        [{\"5\u5206\u524d\",\"5\"},{\"10\u5206\u524d\",\"10\"},{\"15\u5206\u524d\",\"15\"},{\"20\u5206\u524d\",\"20\"}] ++\n        [{\"30\u5206\u524d\",\"30\"},{\"45\u5206\u524d\",\"45\"},{\"1\u6642\u9593\u524d\",\"60\"},{\"2\u6642\u9593\u524d\",\"120\"}]\n%>\n<div class=\"form-group\">\n    <%= label @form, :subject, \"\u4ef6\u540d\", class: \"control-label\" %>\n    <%= text_input @form, :subject, class: \"form-control\", required: \"\" %>\n    <%= error_tag @form, :subject %>\n</div>\n\n<div class=\"form-group\">\n    <%= label @form, :action_date, \"\u65e5\u4ed8\", class: \"control-label\" %>\n    <%= date_input @form, :action_date, class: \"form-control\", required: \"\" %>\n    <%= error_tag @form, :action_date %>\n</div>\n\n<div class=\"form-group\">\n    <%= label @form, :action_time, \"\u6642\u9593\", class: \"control-label\" %>\n    <%= time_input @form, :action_time, class: \"form-control\", required: \"\" %>\n    <%= error_tag @form, :action_time %>\n</div>\n\n<div class=\"form-group\">\n    <%= label @form, :notify_before, \"\u901a\u77e5\", class: \"control-label\" %>\n    <%= select @form, :notify_before, notify_before_options, class: \"form-control\", required: \"\" %>\n    <%= error_tag @form, :notify_before %>\n</div>\n\n<div class=\"form-group\">\n    <%= label @form, :summary, \"\u8aac\u660e\", class: \"control-label\" %>\n    <%= textarea @form, :summary, class: \"form-control\" %>\n    <%= error_tag @form, :summary %>\n</div>\n```\n\n\u300c\u65e5\u4ed8\u300d\u3068\u300c\u6642\u9593\u300d\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u3064\u3044\u3066\u306f\u3001\u5148\u307b\u3069\u4f5c\u6210\u3057\u305f\u30d8\u30eb\u30d1\u30fc\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u95a2\u6570\u3092\u547c\u3073\u51fa\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u767b\u9332\u753b\u9762\u3092`web/templates/notify/index.html.eex`\u306b\u3002\n\n```web/templates/notify/index.html.eex\n<table class=\"table\">\n    <thead>\n    <tr>\n        <th>\u901a\u77e5\u30ea\u30b9\u30c8</th>\n        <th></th>\n    </tr>\n    </thead>\n    <tbody>\n    <%= for notification <- @notifications_sent_not_yet do %>\n    <tr>\n        <td><%= notification.subject %></td>\n        <td class=\"text-right\">\n            <%= link \"\u7de8\u96c6\", to: notify_path(@conn, :edit, notification), class: \"btn btn-default btn-xs\" %>\n            <%= link \"\u524a\u9664\", to: notify_path(@conn, :delete, notification), method: :delete, data: [confirm: \"\u524a\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304b?\"], class: \"btn btn-danger btn-xs\" %>\n        </td>\n    </tr>\n    <% end %>\n    </tbody>\n</table>\n\n<%= form_for @changeset, notify_path(@conn, :create), fn form -> %>\n<%= if @changeset.action do %>\n<div class=\"alert alert-danger\">\n    <p>\u5165\u529b\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3059</p>\n</div>\n<% end %>\n\n<%= render \"form.html\", changeset: @changeset, form: form %>\n\n<div class=\"button-group\">\n    <%= submit \"\u767b\u9332\", class: \"btn btn-primary create\" %>\n</div>\n\n<% end %>\n\n<table class=\"table\">\n    <thead>\n    <tr>\n        <th>\u901a\u77e5\u6e08\u30ea\u30b9\u30c8</th>\n        <th></th>\n    </tr>\n    </thead>\n    <tbody>\n    <%= for notification <- @notifications_sent do %>\n    <tr>\n        <td><%= notification.subject %></td>\n        <td class=\"text-right\">\n            <%= link \"\u7de8\u96c6\", to: notify_path(@conn, :edit, notification), class: \"btn btn-default btn-xs\" %>\n            <%= link \"\u524a\u9664\", to: notify_path(@conn, :delete, notification), method: :delete, data: [confirm: \"\u524a\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304b?\"], class: \"btn btn-danger btn-xs\" %>\n        </td>\n    </tr>\n    <% end %>\n    </tbody>\n</table>\n```\n\n\u7de8\u96c6\u753b\u9762\u3092`web/templates/notify/edit.html.eex`\u306b\u3002\n\n```web/templates/notify/edit.html.eex\n<%= form_for @changeset, notify_path(@conn, :update, @notification), fn form -> %>\n<%= if @changeset.action do %>\n<div class=\"alert alert-danger\">\n    <p>\u5165\u529b\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3059</p>\n</div>\n<% end %>\n\n<%= render \"form.html\", changeset: @changeset, form: form %>\n\n<div class=\"button-group\">\n    <%= submit \"\u66f4\u65b0\", class: \"btn btn-primary update\", id: \"update_btn\" %>\n    <%= submit \"\u524a\u9664\", class: \"btn delete\", id: \"delete_btn\" %>\n</div>\n\n<% end %>\n\n<%= link \"HOME\", to: notify_path(@conn, :index) %>\n```\n\n\u66f4\u65b0\u30dc\u30bf\u30f3\u30fb\u524a\u9664\u30dc\u30bf\u30f3\u304c\u62bc\u3055\u308c\u305f\u969b\u306b\u3001\u96a0\u3057\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\"_method\"\u306e\u5024\u3092\"put\"\u3068\"delete\"\u306b\u5207\u308a\u66ff\u3048\u308bJavaScript\u3092`web/static/js/app.js`\u306b\u3002\n\n```web/static/js/app.js\n          \u30fb\n          \u30fb\n$(function(){\n    $('#update_btn').click(function(){\n        $('input[name=\"_method\"]').val('put');\n    });\n    $('#delete_btn').click(function(e){\n        if (window.confirm('\u524a\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304b?')) {\n            $('input[name=\"_method\"]').val('delete');\n        } else {\n            e.preventDefault();\n        }\n    });\n});\n```\n\n\u6700\u5f8c\u306bCSS\u3092`web/static/css/app.css`\u306b\u3002\n\n```web/static/css/app.css\nh2 {\n    background-color: #F36636;\n    color: #FFFFFF;\n    border-radius: 5px;\n    padding: 5px;\n    text-align: center;\n    width: 280px;\n}\n.container, .alert, main {\n    width: 280px;\n}\n.button-group {\n    text-align: center;\n}\nbutton.create {\n    width: 280px;\n}\nbutton.update, button.delete {\n    width: 135px;\n}\n```\n\n\u203bBrunch\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u306f\u3001\u4e0a\u8a18\uff12\u3064\u306f`priv/static/js/app.js`\u3068`priv/static/css/app.css`\u306e\u4e0b\u90e8\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n# \u30bf\u30a4\u30de\u30fc\u306e\u4f5c\u6210\n\n\u901a\u77e5\u6642\u523b\u306b\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3046\u305f\u3081\u30011\u5206\u9593\u9694\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u691c\u7d22\u3057\u3001\u8a72\u5f53\u3059\u308b\u30ec\u30b3\u30fc\u30c9\u304c\u3042\u308b\u5834\u5408\u306b\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u66f4\u65b0\u3001\u30e1\u30fc\u30eb\u306e\u9001\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u30e1\u30fc\u30eb\u9001\u4fe1\u306e\u305f\u3081\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092`mix.ex`\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```mix.ex\ndefmodule Notify.Mixfile do\n          \u30fb\n          \u30fb\n  def application do\n    [mod: {Notify, []},\n     applications: [:phoenix, :phoenix_pubsub, :phoenix_html, :cowboy, :logger, :gettext,\n                    :phoenix_ecto, :mariaex, :bamboo, :bamboo_smtp]]\n  end\n          \u30fb\n          \u30fb\n  defp deps do\n    [{:phoenix, \"~> 1.2.1\"},\n     {:phoenix_pubsub, \"~> 1.0\"},\n     {:phoenix_ecto, \"~> 3.0\"},\n     {:mariaex, \">= 0.0.0\"},\n     {:phoenix_html, \"~> 2.6\"},\n     {:phoenix_live_reload, \"~> 1.0\", only: :dev},\n     {:gettext, \"~> 0.11\"},\n     {:cowboy, \"~> 1.0\"},\n     {:bamboo, \"~> 0.7\"},\n     {:bamboo_smtp, \"~> 1.2.1\"}]\n  end\n          \u30fb\n          \u30fb\nend\n```\n\n\u30e1\u30fc\u30eb\u30e2\u30b8\u30e5\u30fc\u30eb\u3092Notify.Mailer\u3068\u3057\u3066\u767b\u9332\u3057\u307e\u3059\u3002\n\n```lib/notify/mailer.ex\ndefmodule Notify.Mailer do\n  use Bamboo.Mailer, otp_app: :notify\nend\n```\n\n\u30e1\u30fc\u30eb\u9001\u4fe1\u7528\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092`config/dev.exs`\u3068`config/config.exs`\u306b\u3002\n\n```config/dev.exs\n          \u30fb\n          \u30fb\nconfig :notify, Notify.Mailer,\n  adapter: Bamboo.SMTPAdapter,\n  server: \"localhost\",\n  port: 25,\n  username: \"\",\n  password: \"\",\n  tls: :never, # can be `:always` or `:never`\n  ssl: false, # can be `true`\n  retries: 1\n```\n\n```config/config.exs\n          \u30fb\n          \u30fb\n# General application configuration\nconfig :notify,\n  ecto_repos: [Notify.Repo],\n  mail_from: \"NOTIFY SENDER <from@xxxxxx.xxx>\",\n  mail_to: \"to@xxxxxx.xxx\"\n          \u30fb\n          \u30fb\n```\n\n\u672a\u901a\u77e5\u304b\u3064\u901a\u77e5\u6642\u523b\u306e\u30ec\u30b3\u30fc\u30c9\u3092\u691c\u7d22\u3057\u3001\u30e1\u30fc\u30eb\u9001\u4fe1\u3092\u884c\u3046\u30e2\u30b8\u30e5\u30fc\u30eb\u3092`web/controllers/notify_checker.ex`\u306b\u3002\n\n```web/controllers/notify_checker.ex\ndefmodule Notify.NotifyChecker do\n  import Ecto.Query\n\n  alias Notify.Repo\n  alias Notify.Notification\n  alias Notify.Mailer\n  alias Notify.Email\n\n  def check_notify do\n    for n <- notifications_to_send do\n      send_mail n\n      update_table n\n    end\n  end\n\n  defp notifications_to_send do\n    Notification\n    |> where([u], u.sent == false and u.notify_date_time <= from_now(0, \"microsecond\"))\n    |> Repo.all\n  end\n\n  defp send_mail(notification) do\n    notification\n    |> Email.notify_mail\n    |> Mailer.deliver_now\n  end\n\n  defp update_table(notification) do\n    notification\n    |> Ecto.Changeset.change(%{sent: true})\n    |> Repo.update!\n  end\nend\n\ndefmodule Notify.Email do\n  import Bamboo.Email\n\n  def notify_mail(notification) do\n    new_email\n    |> to(Application.get_env(:notify, :mail_to))\n    |> from(Application.get_env(:notify, :mail_from))\n    |> subject(\"\u3010\u901a\u77e5\u3011 #{notification.subject}\")\n    |> text_body(notification |> notify_body)\n  end\n\n  defp notify_body(notification) do\n    \"\"\"\n    [\u4ef6\u540d]\n    #{notification.subject}\n    [\u65e5\u4ed8]\n    #{notification.action_date}\n    [\u6642\u9593]\n    #{notification.action_time}\n    [\u901a\u77e5]\n    #{Ecto.DateTime.utc |> to_local_date_time}\n    [\u8aac\u660e]\n    #{notification.summary}\n    \"\"\"\n  end\n\n  defp to_local_date_time(utc_date_time) do\n    utc_date_time\n    |> Ecto.DateTime.to_erl\n    |> :calendar.universal_time_to_local_time\n    |> Ecto.DateTime.from_erl\n  end\nend\n```\n\n\u30bf\u30a4\u30de\u30fc\u306fGenServer\u306b\u3057\u3066Supervisor\u304c\u7ba1\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n```lib/notify/timer.ex\ndefmodule Notify.Timer do\n  use GenServer\n\n  def start_link(name) do\n    GenServer.start_link(__MODULE__, :ok, name: name)\n  end\n\n  def init(:ok) do\n    check_forever\n    {:ok, %{}}\n  end\n\n  def handle_info(:check_notify, _) do\n    spawn(fn -> Notify.NotifyChecker.check_notify end)\n    check_forever\n    {:noreply, \"\"}\n  end\n\n  defp check_forever do\n    {_, _, sec} = Ecto.Time.utc |> Ecto.Time.to_erl\n    Process.send_after(self, :check_notify, (60-sec)*1000)\n  end\n\nend\n```\n\n```lib/notify.ex\ndefmodule Notify do\n  use Application\n  def start(_type, _args) do\n    children = [\n          \u30fb\n          \u30fb\n      worker(Notify.Timer, [Notify.Timer]),\n    ]\n          \u30fb\n          \u30fb\n  end\n          \u30fb\n          \u30fb\nend\n```\n\n# \u52d5\u4f5c\u78ba\u8a8d\n\n```\n$ mix deps.get\n$ mix phoenix.server\n```\n\n`http://localhost:4000/notify`\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n# Exrm\u306b\u3088\u308b\u30c7\u30d7\u30ed\u30a4\n\n\u6700\u5f8c\u306b[Elixir Release Manager](https://github.com/bitwalker/exrm)\uff08Exrm\uff09\u3092\u4f7f\u3063\u3066Amazon EC2\u200e\u306b\u30c7\u30d7\u30ed\u30a4\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u307e\u305a\u306f\u30e2\u30b8\u30e5\u30fc\u30eb\u3092`mix.ex`\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\n```mix.ex\ndefmodule Notify.Mixfile do\n          \u30fb\n          \u30fb\n  defp deps do\n    [{:phoenix, \"~> 1.2.1\"},\n     {:phoenix_pubsub, \"~> 1.0\"},\n     {:phoenix_ecto, \"~> 3.0\"},\n     {:mariaex, \">= 0.0.0\"},\n     {:phoenix_html, \"~> 2.6\"},\n     {:phoenix_live_reload, \"~> 1.0\", only: :dev},\n     {:gettext, \"~> 0.11\"},\n     {:cowboy, \"~> 1.0\"},\n     {:bamboo, \"~> 0.7\"},\n     {:bamboo_smtp, \"~> 1.2.1\"},\n     {:exrm, \"~> 1.0\"}]\n  end\n          \u30fb\n          \u30fb\nend\n```\n\n\u30db\u30b9\u30c8\u540d\u306e\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n```config/prod.exs\n          \u30fb\n          \u30fb\nconfig :notify, Notify.Endpoint,\n  http: [port: {:system, \"PORT\"}],\n  url: [host: \"host.xxxx.xx\"],\n  cache_static_manifest: \"priv/static/manifest.json\",\n  root: \".\",\n  server: true,\n  version: Mix.Project.config[:version]\n          \u30fb\n          \u30fb\n```\n\n\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9\u3068\u30e1\u30fc\u30eb\u9001\u4fe1\u7528\u306e\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306f`config/prod.secret.exs`\u306b\u884c\u3044\u307e\u3059\u3002\n\n```config/prod.secret.exs\n          \u30fb\n          \u30fb\nconfig :notify, Notify.Repo,\n  adapter: Ecto.Adapters.MySQL,\n  username: \"root\",\n  password: \"\",\n  database: \"notify_phoenix\",\n  pool_size: 20\n\nconfig :notify, Notify.Mailer,\n  adapter: Bamboo.SMTPAdapter,\n  server: \"localhost\",\n  port: 25,\n  username: \"\",\n  password: \"\",\n  tls: :never, # can be `:always` or `:never`\n  ssl: false, # can be `true`\n  retries: 1\n```\n\n\u30c7\u30d7\u30ed\u30a4\u7528\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n```\n$ mix deps.get\n$ MIX_ENV=prod mix phoenix.digest\n$ MIX_ENV=prod mix compile\n$ MIX_ENV=prod mix release\n```\n\n\u4f5c\u6210\u3055\u308c\u305f`rel/notify/releases/0.0.1/notify.tar.gz`\u3092\u30b5\u30fc\u30d0\u306b\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3001\u4e88\u3081\u4f5c\u6210\u3057\u3066\u304a\u3044\u305f`/opt/notify_phoenix/`\u5185\u306b\u653e\u308a\u8fbc\u3093\u3067\u89e3\u51cd\u3057\u307e\u3059\u3002\n\n\u6b21\u306b\u8d77\u52d5\u7528\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u3092`/etc/init/notify_phoenix.conf`\u306b\u3002\n\n```/etc/init/notify_phoenix.conf\ndescription \"notify_phoenix\"\n\nsetuid ubuntu\nsetgid ubuntu\n\nstart on runlevel [2345]\nstop on runlevel [016]\n\nexpect stop\nrespawn\n\nenv MIX_ENV=prod\nexport MIX_ENV\n\n## Uncomment the following two lines if we configured\n## our port with an environment variable.\nenv PORT=4444\nexport PORT\n\n## Add app HOME directory.\nenv HOME=/opt/notify_phoenix\nexport HOME\n\npre-start exec /bin/sh $HOME/bin/notify start\n\npost-stop exec /bin/sh $HOME/bin/notify stop\n```\n\n\u8d77\u52d5\u3057\u307e\u3059\u3002\n\n```\n$ sudo start notify_phoenix\n```\n\n`http://host.xxxx.xx:4444/notify`\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\n# \u3055\u3044\u3054\u306b\n\n\u95a2\u6570\u578b\u8a00\u8a9e\u306eWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u3057\u3066\u3001\u4eca\u56de\u306fElixir\u306ePhoenix\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\nElixir\u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u306e\u8a18\u8ff0\u65b9\u6cd5\u304c\u3068\u3066\u3082\u697d\u3057\u304f\u3001\u3067\u304d\u308b\u3060\u3051\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092\u4f7f\u3046\u3088\u3046\u5fc3\u304c\u3051\u3066\u3044\u305f\u3089\u3001\u81ea\u7136\u3068\u5ba3\u8a00\u7684\u306a\u8a18\u8ff0\u3092\u6301\u3064\u5c0f\u3055\u306a\u95a2\u6570\u304c\u305f\u304f\u3055\u3093\u51fa\u6765\u307e\u3057\u305f\u3002\n\n\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u306f\u30c7\u30fc\u30bf\u3092\u5909\u63db\u3057\u3066\u3044\u304f\u904e\u7a0b\u304c\u3088\u304f\u5206\u304b\u308a\u3001\u4e3b\u8ef8\u3067\u306a\u3044\u3082\u306e\u3092\u5916\u90e8\u95a2\u6570\u3068\u3057\u3066\u653e\u308a\u51fa\u3059\u3053\u3068\u3067\u3001\u95a2\u6570\u306e\u8cac\u52d9\u3092\u9650\u5b9a\u7684\u3059\u308b\u3068\u3044\u3046\u826f\u3044\u7fd2\u6163\u304c\u8eab\u306b\u3064\u304d\u305d\u3046\u3067\u3059\u3002\n\nPhoenix\u3082\u6d17\u7df4\u3055\u308c\u305fWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3001Elixir\u3068Web\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u76f8\u6027\u306e\u826f\u3055\u3092\u611f\u3058\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\n\n\u7570\u306a\u308b\u8a00\u8a9e\u30fb\u7570\u306a\u308bWeb\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3082\u3001\u6bce\u5ea6\u4f3c\u305f\u601d\u60f3\u3092\u6301\u3064\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u540c\u3058Web\u30a2\u30d7\u30ea\u3092\u4f5c\u3063\u3066\u3044\u308b\u306e\u3067\u3001\u5b9f\u88c5\u306e\u6d41\u308c\u306f\u3060\u3044\u305f\u3044\u540c\u3058\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306eElixir\uff0bPhoenix\u306e\u958b\u767a\u52b9\u7387\u306f\u7fa4\u3092\u629c\u3044\u3066\u3044\u308b\u3068\u611f\u3058\u307e\u3057\u305f\u3002\n\nElixir\u3067\u306f\u305d\u308c\u305e\u308c\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u72ec\u7acb\u3057\u3066\u3044\u3066\u3001\u76f8\u4e92\u304c\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u3084\u308a\u53d6\u308a\u3067\u52d5\u3044\u3066\u3044\u308b\u3089\u3057\u3044\u306e\u3067\u3059\u304c\u3001\u8868\u9762\u4e0a\u306e\u5b9f\u88c5\u3067\u306f\u305d\u308c\u3092\u611f\u3058\u308b\u3053\u3068\u306f\u3067\u304d\u305a\u3001\u901a\u5e38\u306e\u95a2\u6570\u547c\u3073\u51fa\u3057\u306e\u3088\u3046\u306b\u898b\u3048\u307e\u3059\u3002\uff08\u95a2\u6570\u304c\u547c\u3070\u308c\u308b\u3068\u95a2\u6570\u5185\u90e8\u3067\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u3092\u884c\u3063\u3066\u3044\u308b\u611f\u3058\u3060\u3068\u601d\u3044\u307e\u3059\u3002\uff09\n\n\u4eca\u56de\u306eWeb\u30a2\u30d7\u30ea\u3067\u3082\u3001Ecto\u3084Mailer\u3001Timer\u306a\u3069\u304c\u305d\u308c\u305e\u308c\u72ec\u7acb\u3057\u305f\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u6301\u3063\u3066\u52d5\u3044\u3066\u3044\u308b\u306e\u3067\u3001\u76f8\u4e92\u306b\u4f9d\u5b58\u95a2\u4fc2\u304c\u767a\u751f\u305b\u305a\u3001\u4f8b\u3048\u3070\u5225\u30d7\u30ed\u30bb\u30b9\u3067\u52d5\u3044\u3066\u3044\u308bTimer\u304c\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u308a\u30e1\u30fc\u30eb\u3092\u9001\u4fe1\u3057\u305f\u308a\u3059\u308b\u969b\u306b\u3082\u3001\u95a2\u6570\u578b\u8a00\u8a9e\u3067\u3042\u308a\u306a\u304c\u3089\u5f15\u6570\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u60c5\u5831\u3084\u30b3\u30f3\u30d5\u30a3\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u306e\u60c5\u5831\u3092\u6e21\u3059\u5fc5\u8981\u304c\u306a\u304f\u3001\u3068\u3066\u3082\u3059\u3063\u304d\u308a\u3068\u3057\u305f\u30b3\u30fc\u30c9\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\uff08\u304b\u3068\u8a00\u3063\u3066\u30b0\u30ed\u30fc\u30d0\u30eb\u306b\u5024\u3092\u6301\u3063\u3066\u3044\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3082\u306a\u304f\u3001\u3069\u3061\u3089\u304b\u3068\u8a00\u3048\u3070DI\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3057\u3087\u3046\u304b\u3002\uff09\n\n\u4ed6\u306e\u8a00\u8a9e\u3067\u3082\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u306b\u3088\u308b\u540c\u69d8\u306e\u5b9f\u88c5\u306f\u53ef\u80fd\u306a\u306e\u3067\u3057\u3087\u3046\u304c\u3001Elixir\u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u304c\u300c\u3053\u308c\u300d\u3068\u3044\u3046\u306e\u304c\u958b\u767a\u52b9\u7387\u306e\u9762\u3067\u5927\u304d\u3044\u306e\u3060\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n", "tags": ["Elixir", "Phoenix"]}