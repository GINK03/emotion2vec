{"context": "\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u30ad\u30fc\u306e\u767a\u884c\u306f\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\nMicrosoft\u306eCognitive Service\u306e\u4e00\u3064\u3001Bing Speech API\u3092\u4f7f\u3046\u624b\u9806\u3092\u307e\u3068\u3081\u307e\u3057\u305f\n\n\u97f3\u58f0\u306e\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u306f\u4ee5\u4e0b\u304b\u3089\u3002\n\n\u65e5\u672c\u8a9e\u97f3\u58f0\u30b5\u30f3\u30d7\u30eb\n\n(ns bing-speech.core\n  (:gen-class)\n  (:require [clj-http.client :as http]\n            [clojure.data.json :as json]))\n\n(def issue-token-endpoint\n  \"\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u767a\u884c\u7528\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\"\n  \"https://api.cognitive.microsoft.com/sts/v1.0/issueToken\")\n\n(def recognize-endpoint\n  \"\u97f3\u58f0\u8a8d\u8b58\u7528\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\"\n  \"https://speech.platform.bing.com/recognize\")\n\n(def subscription-key\n  \"Bing Speech\u306e\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u30ad\u30fc\"\n    \"abcdefghijklmnopqrstuvwxyz123456\")\n\n(defn issue-token [key]\n  \"\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\"\n  (let [res (http/post issue-token-endpoint\n                       {:headers {\"Content-Type\" \"application/x-www-form-urlencoded\"\n                                  \"Ocp-Apim-Subscription-Key\" key}})]\n    (res :body)))\n\n(defn uuid []\n  \"UUID\u3092\u751f\u6210\u3059\u308b\"\n  (str (java.util.UUID/randomUUID)))\n\n(defn recognize [token path]\n  \"path\u306b\u3042\u308bWAV\u30d5\u30a1\u30a4\u30eb\u3092\u97f3\u58f0\u8a8d\u8b58\u3059\u308b\"\n  (let [scenarios \"scenarios=smd\"\n        appid \"appid=D4D52672-91D7-4C74-8AD8-42B1D98141A5\"\n        locale \"locale=ja-JP\"\n        os \"device.os=MacOS\"\n        version \"version=3.0\"\n        fmt \"format=json\"\n        instanceid (format \"instanceid=%s\" (uuid))\n        requestid (format \"requestid=%s\" (uuid))\n        url (format \"%s?%s&%s&%s&%s&%s&%s&%s&%s\" recognize-endpoint scenarios appid locale os version fmt\n                    instanceid requestid)\n        authorization (format \"Bearer %s\" token)\n        content-type \"audio/wav; codec=\\\"audio/pcm\\\"; samplerate=44100\"]\n    (http/post url {:headers {\"Authorization\" authorization \"Content-Type\" content-type}\n                    :body (clojure.java.io/input-stream path)})))\n\n(let [token (issue-token subscription-key)\n      result (recognize token \"aiueo1.wav\")]\n  ((((json/read-str (result :body)) \"results\") 0) \"name\"))\n;=> \"\u3042\u3044\u3046\u3048\u304a\"\n\n\u3053\u306e\u5206\u91ce\u306f\u5168\u7136\u77e5\u3089\u306a\u3044\u306e\u3067\u8a8d\u8b58\u7387\u306b\u3064\u3044\u3066\u306f\u306a\u3093\u3068\u3082\u8a00\u3048\u307e\u305b\u3093\u304c\u3001\u3053\u3093\u306a\u304a\u624b\u8efd\u306b\u3067\u304d\u308b\u306e\u306f\u51c4\u3044\u3067\u3059\u306d\u3002\n\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u30ad\u30fc\u306e\u767a\u884c\u306f\u4ee5\u4e0b\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\n\n* [Microsoft\u306eCognitive Service\u306e\u4e00\u3064\u3001Bing Speech API\u3092\u4f7f\u3046\u624b\u9806\u3092\u307e\u3068\u3081\u307e\u3057\u305f](http://magicbullet.hatenablog.jp/entry/CognitiveService_BingSpeechAPI)\n\n\u97f3\u58f0\u306e\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u306f\u4ee5\u4e0b\u304b\u3089\u3002\n\n* [\u65e5\u672c\u8a9e\u97f3\u58f0\u30b5\u30f3\u30d7\u30eb](http://www.gavo.t.u-tokyo.ac.jp/~mine/B3enshu2000/samples.html)\n\n```clj\n(ns bing-speech.core\n  (:gen-class)\n  (:require [clj-http.client :as http]\n            [clojure.data.json :as json]))\n\n(def issue-token-endpoint\n  \"\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u767a\u884c\u7528\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\"\n  \"https://api.cognitive.microsoft.com/sts/v1.0/issueToken\")\n\n(def recognize-endpoint\n  \"\u97f3\u58f0\u8a8d\u8b58\u7528\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\"\n  \"https://speech.platform.bing.com/recognize\")\n\n(def subscription-key\n  \"Bing Speech\u306e\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u30ad\u30fc\"\n    \"abcdefghijklmnopqrstuvwxyz123456\")\n\n(defn issue-token [key]\n  \"\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3059\u308b\"\n  (let [res (http/post issue-token-endpoint\n                       {:headers {\"Content-Type\" \"application/x-www-form-urlencoded\"\n                                  \"Ocp-Apim-Subscription-Key\" key}})]\n    (res :body)))\n\n(defn uuid []\n  \"UUID\u3092\u751f\u6210\u3059\u308b\"\n  (str (java.util.UUID/randomUUID)))\n\n(defn recognize [token path]\n  \"path\u306b\u3042\u308bWAV\u30d5\u30a1\u30a4\u30eb\u3092\u97f3\u58f0\u8a8d\u8b58\u3059\u308b\"\n  (let [scenarios \"scenarios=smd\"\n        appid \"appid=D4D52672-91D7-4C74-8AD8-42B1D98141A5\"\n        locale \"locale=ja-JP\"\n        os \"device.os=MacOS\"\n        version \"version=3.0\"\n        fmt \"format=json\"\n        instanceid (format \"instanceid=%s\" (uuid))\n        requestid (format \"requestid=%s\" (uuid))\n        url (format \"%s?%s&%s&%s&%s&%s&%s&%s&%s\" recognize-endpoint scenarios appid locale os version fmt\n                    instanceid requestid)\n        authorization (format \"Bearer %s\" token)\n        content-type \"audio/wav; codec=\\\"audio/pcm\\\"; samplerate=44100\"]\n    (http/post url {:headers {\"Authorization\" authorization \"Content-Type\" content-type}\n                    :body (clojure.java.io/input-stream path)})))\n\n(let [token (issue-token subscription-key)\n      result (recognize token \"aiueo1.wav\")]\n  ((((json/read-str (result :body)) \"results\") 0) \"name\"))\n;=> \"\u3042\u3044\u3046\u3048\u304a\"\n```\n\n\u3053\u306e\u5206\u91ce\u306f\u5168\u7136\u77e5\u3089\u306a\u3044\u306e\u3067\u8a8d\u8b58\u7387\u306b\u3064\u3044\u3066\u306f\u306a\u3093\u3068\u3082\u8a00\u3048\u307e\u305b\u3093\u304c\u3001\u3053\u3093\u306a\u304a\u624b\u8efd\u306b\u3067\u304d\u308b\u306e\u306f\u51c4\u3044\u3067\u3059\u306d\u3002\n", "tags": ["BingSpeechRecognitionAPI", "Clojure"]}