{"context": " More than 1 year has passed since last update.// \u30ab\u30e1\u30e9\u30c7\u30d0\u30a4\u30b9\u304b\u3089\u306e\u5165\u529b\u3092\u4f5c\u6210\u3057\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u8ffd\u52a0\u3059\u308b\nNSError *error = nil;\n_camera = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];\n\nif ([_camera lockForConfiguration:&error]) {\n    [_camera setFocusMode:AVCaptureFocusModeContinuousAutoFocus];\n    _camera.autoFocusRangeRestriction = AVCaptureAutoFocusRangeRestrictionNear;\n    if ([_camera isExposureModeSupported:AVCaptureExposureModeAutoExpose]){\n        [_camera setExposureMode:AVCaptureExposureModeAutoExpose];\n    }\n    [_camera unlockForConfiguration];\n}\n\n[_camera addObserver:self forKeyPath:@\"adjustingFocus\" options:NSKeyValueObservingOptionNew context:nil];\n\n// \u753b\u9762\u9077\u79fb\u6642\u306a\u3069\u4e0d\u8981\u306b\u306a\u3063\u305f\u3089remove\u3057\u306a\u3044\u3068\u518d\u5ea6add\u3057\u305f\u3068\u304d\u306b\u843d\u3061\u308b\n//    [_camera removeObserver:self forKeyPath:@\"adjustingFocus\"];\n/**\n *  \u72b6\u614b\u304c\u5909\u5316\u3057\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u306e\u306f\u3053\u3061\u3089\n */\n- (void)observeValueForKeyPath:(NSString *)keyPath \n\u3000ofObject:(id)object \n\u3000change:(NSDictionary *)change \n\u3000context:(void *)context\n{\n    // \u30d4\u30f3\u30c8\u306e\u72b6\u614b\u304c\u5909\u5316\u3059\u308b\u5ea6\u306b\u3053\u306e\u30b3\u30fc\u30c9\u304c\u547c\u3070\u308c\u307e\u3059\u3002\n    // \u3053\u3053\u306b\u5b9f\u88c5\u3092\u66f8\u304f\u4e8b\u3067\u30d4\u30f3\u30c8\u5408\u3063\u305f/\u5916\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u67a0\u306e\u8868\u793a/\u975e\u8868\u793a\u304c\u51fa\u6765\u307e\u3059\u3002\n    if( [keyPath isEqualToString:@\"adjustingFocus\"] ){\n        BOOL adjustingFocus = [[change objectForKey:NSKeyValueChangeNewKey] isEqualToNumber:[NSNumber numberWithInt:1] ];\n    if (adjustingFocus) {\n        _focusing=true;\n        _finishedFocus = false;\n        NSLog(@\"focusing\");\n    }\n    else {\n        if (_focusing) {\n            _focusing = false;\n            _finishedFocus = true;\n            NSLog(@\"finishFocus\");\n        }\n    }\n}\n\n}\n    // \u30ab\u30e1\u30e9\u30c7\u30d0\u30a4\u30b9\u304b\u3089\u306e\u5165\u529b\u3092\u4f5c\u6210\u3057\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u8ffd\u52a0\u3059\u308b\n    NSError *error = nil;\n    _camera = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];\n    \n    if ([_camera lockForConfiguration:&error]) {\n        [_camera setFocusMode:AVCaptureFocusModeContinuousAutoFocus];\n        _camera.autoFocusRangeRestriction = AVCaptureAutoFocusRangeRestrictionNear;\n        if ([_camera isExposureModeSupported:AVCaptureExposureModeAutoExpose]){\n            [_camera setExposureMode:AVCaptureExposureModeAutoExpose];\n        }\n        [_camera unlockForConfiguration];\n    }\n\n    [_camera addObserver:self forKeyPath:@\"adjustingFocus\" options:NSKeyValueObservingOptionNew context:nil];\n\n// \u753b\u9762\u9077\u79fb\u6642\u306a\u3069\u4e0d\u8981\u306b\u306a\u3063\u305f\u3089remove\u3057\u306a\u3044\u3068\u518d\u5ea6add\u3057\u305f\u3068\u304d\u306b\u843d\u3061\u308b\n//    [_camera removeObserver:self forKeyPath:@\"adjustingFocus\"];\n\n\n/**\n *  \u72b6\u614b\u304c\u5909\u5316\u3057\u305f\u3068\u304d\u306b\u547c\u3070\u308c\u308b\u306e\u306f\u3053\u3061\u3089\n */\n- (void)observeValueForKeyPath:(NSString *)keyPath \n\u3000ofObject:(id)object \n\u3000change:(NSDictionary *)change \n\u3000context:(void *)context\n{\n    // \u30d4\u30f3\u30c8\u306e\u72b6\u614b\u304c\u5909\u5316\u3059\u308b\u5ea6\u306b\u3053\u306e\u30b3\u30fc\u30c9\u304c\u547c\u3070\u308c\u307e\u3059\u3002\n    // \u3053\u3053\u306b\u5b9f\u88c5\u3092\u66f8\u304f\u4e8b\u3067\u30d4\u30f3\u30c8\u5408\u3063\u305f/\u5916\u308c\u305f\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u67a0\u306e\u8868\u793a/\u975e\u8868\u793a\u304c\u51fa\u6765\u307e\u3059\u3002\n    if( [keyPath isEqualToString:@\"adjustingFocus\"] ){\n        BOOL adjustingFocus = [[change objectForKey:NSKeyValueChangeNewKey] isEqualToNumber:[NSNumber numberWithInt:1] ];\n        \n        if (adjustingFocus) {\n            _focusing=true;\n            _finishedFocus = false;\n            NSLog(@\"focusing\");\n        }\n        else {\n            if (_focusing) {\n                _focusing = false;\n                _finishedFocus = true;\n                NSLog(@\"finishFocus\");\n            }\n        }\n    }\n}\n", "tags": ["AVCaptureDevice", "\u30ab\u30e1\u30e9", "kvo"]}