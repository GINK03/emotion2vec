{"context": " More than 1 year has passed since last update.\n\n\u524d\u56de\u307e\u3067\u306e\u307e\u3068\u3081\n\n\u74b0\u5883\u69cb\u7bc9\u7de8\n\n\nhttp://qiita.com/pullphone/items/98c31a21d0b50dc51b95\n\n\nReact Tutorial \u7de8\n\n\nhttp://qiita.com/pullphone/items/efcaee59cf2a5725c61d\n\n\n\n\n\u4eca\u56de\u306e\u30c6\u30fc\u30de\n\n\u305d\u3082\u305d\u3082 Redux \u3068\u306f\uff1f\nRedux \u3067\u5b9f\u88c5\u3059\u308b\u306b\u3042\u305f\u3063\u3066\u306e\u30c6\u30f3\u30d7\u30ec\u30fb\u304a\u7d04\u675f\nReact \u3068 Redux \u3092\u3064\u306a\u3050\n\n\n\u305d\u3082\u305d\u3082 Redux \u3068\u306f\u4f55\u8005\u306a\u306e\u304b\uff1f\n\nReact State \u306e\u843d\u3068\u3057\u7a74\n\u3055\u3066\u3001\u524d\u56de\u7d39\u4ecb\u3057\u305f React Component \u3067\u4f7f\u3048\u308b State \u306f Component \u5185\u3067\u3001\u3044\u308f\u3086\u308b\u300c\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u300d\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3001\u3064\u3044\u3064\u3044\u7121\u95c7\u306b\u4f7f\u3044\u304c\u3061\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u304c\u3001\u305d\u3046\u3057\u3066\u7121\u95c7\u306b State \u3092\u4f7f\u3046\u3053\u3068\u306e\u843d\u3068\u3057\u7a74\u3068\u3057\u3066\u6700\u305f\u308b\u3082\u306e\u306b \u4ed6\u306e Component \u304b\u3089\u5909\u66f4\u3057\u305f\u304f\u306a\u3063\u305f\u6642\u306b\u8f9b\u304f\u306a\u308b \u3068\u3044\u3046\u70b9\u304c\u3042\u308a\u307e\u3059\uff08\u3053\u308c\u306f\u5225\u306b React \u306b\u9650\u3063\u305f\u3053\u3068\u3067\u306f\u306a\u304f\u3001\u4ed6\u306e\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\uff08Angular \u3068\u304b Knockout \u3068\u304b Vue \u3068\u304b\uff09\u3067\u3082\u8a00\u3048\u308b\u3053\u3068\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\uff09\u3002\n\u5177\u4f53\u4f8b\u3068\u3057\u3066\u3001\u524d\u56de\u4f5c\u3063\u305f Root Component \u306e this.state.showBox \u3092\u3082\u3057 Box Component \u5074\u304b\u3089\u3082\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\u306f\u3069\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u3088\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\u4e00\u3064\u306e\u30d1\u30bf\u30fc\u30f3\u3068\u3057\u3066\u3001\u89aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304b\u3089\u5c02\u7528\u306e\u95a2\u6570\u3092 Props \u3067\u6e21\u3057\u3001\u305d\u308c\u3092\u5b50\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u5b9f\u884c\u3059\u308b\u3001\u3068\u3044\u3046\u3088\u3046\u306a\u65b9\u6cd5\u304c\u6319\u3052\u3089\u308c\u307e\u3059\u3002\n\nsrc/components/Root.js\nimport React, { Component, PropTypes } from 'react';\n\nimport Box from './Box';\n\nexport default class Root extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showBox: false,\n    };\n  }\n\n  handleClick() {\n    this.setState({showBox: !this.state.showBox});\n  }\n\n  // this.state.showBox \u3092\u5909\u66f4\u3059\u308b\u3060\u3051\u306e\u95a2\u6570\n  changeShowBox(bool) {\n    this.setState({showBox: bool});\n  }\n\n  render() {\n    const btnName = this.state.showBox ? 'Box\u975e\u8868\u793a' : 'Box\u8868\u793a';\n    const boxComponent = this.state.showBox ? (\n      <Box changeShowBoxFunc={(bool) => this.changeShowBox(bool)}>Sample Box</Box>\n    ) : null;\n\n    return (\n      <div className=\"container\">\n        <h1>{this.props.title}</h1>\n        {boxComponent}\n        {/* onClick \u30a4\u30d9\u30f3\u30c8\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u6642\u306b handleClick() \u3092\u547c\u3073\u51fa\u3059 */}\n        <button className=\"btn btn-primary\" onClick={() => this.handleClick()}>{btnName}</button>\n        <div>\n          {this.props.children}\n        </div>\n      </div>\n    );\n  }\n}\n\nRoot.propTypes = {\n  title: PropTypes.string.isRequired,\n  children: PropTypes.any.isRequired,\n};\n\n\n\nsrc/components/Box.js\nimport React, { Component, PropTypes } from 'react';\n\nexport default class Box extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <div className=\"panel panel-default\">\n        <div className=\"panel-body\">\n          {this.props.children}\n          {/* \u89aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304b\u3089\u6e21\u3063\u3066\u304d\u305f\u95a2\u6570\u3092\u305d\u306e\u307e\u307e\u5b9f\u884c */}\n          <button className=\"btn btn-primary\" onClick={() => this.props. changeShowBoxFunc(false)}>Close</button>\n        </div>\n      </div>\n    );\n  }\n}\n\nBox.propTypes = {\n  children: PropTypes.any.isRequired,\n  changeShowBoxFunc: PropTypes.func,\n};\n\n\n\u3057\u304b\u3057\u3001\u3053\u306e\u65b9\u6cd5\u306f\u66f4\u306a\u308b\u554f\u984c\u70b9\u3092\u751f\u307f\u51fa\u3059\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\u3055\u3089\u306b\u591a\u5c64\u69cb\u9020\u306b\u306a\u3063\u305f\u6642\u306b\u3069\u3046\u3059\u3093\u306e\uff1f \u3068\u3044\u3046\u554f\u984c\n\n\n\u5c64\u306e\u6570\u3060\u3051 Props \u3067\u53d7\u3051\u6e21\u3059\u5fc5\u8981\u304c\u51fa\u3066\u304f\u308b\n\n\n\n\u3053\u306e Component \u306e\u95a2\u6570\u3001\u3069\u306e Component \u306e\u3001\u3069\u306e State \u3092\u5909\u3048\u3066\u3093\u306e\uff1f \u3068\u3044\u3046\u554f\u984c\n\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306a1\u5c64\u304f\u3089\u3044\u3067\u3042\u308c\u3070\u306a\u3093\u3068\u306a\u304f\u308f\u304b\u308b\u3051\u3069\u3001\u5c64\u304c\u5897\u3048\u308b\u3068 State \u3092\u5909\u66f4\u3057\u3066\u3044\u308b\u7b87\u6240\u304c\u30d1\u30c3\u3068\u898b\u3067\u5206\u304b\u308a\u3065\u3089\u304f\u306a\u308b\n\n\n\n\u306a\u3069\u306a\u3069\u2026\u3064\u307e\u308a\u3001 \u898f\u6a21\u304c\u5c0f\u3055\u3044\u3046\u3061\u306f\u3044\u3044\u3051\u3069\u30c7\u30ab\u304f\u306a\u308b\u3068\u3084\u3063\u3071\u8f9b\u3044\u3088\u306d\u30fc \u3068\u3044\u3046 \u3069\u3053\u306b\u3067\u3082\u3042\u308b\u3042\u306e\u554f\u984c \u3068\u3044\u3048\u3070\u306a\u3093\u3068\u306a\u304f\u4f1d\u308f\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001\u3053\u308c\u3092\u89e3\u6d88\u3059\u308b\u305f\u3081\u306e\uff08\u3060\u3051\u3058\u3083\u306a\u3044\u3067\u3059\u304c\u2026\uff09\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u304c\u5b9f\u306f\u6628\u4eca\u8a71\u984c\u306e\u3001Facebook \u793e\u304c\u63d0\u5531\u3057\u3066\u3044\u308b Flux \u3068\u547c\u3070\u308c\u308b\u30a2\u30ec \u3067\u3059\u3002\n\nFlux \u3068 Redux\n\u3053\u306e\u9805\u306f\u500b\u4eba\u7684\u898b\u89e3\u3092\u542b\u307f\u307e\u3059\nFlux \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306b\u3064\u3044\u3066\u306e\u8a73\u3057\u3044\u8aac\u660e\u306f\u7701\u304d\u307e\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u7279\u5fb4\u304c\u3042\u308b\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3068\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u30c7\u30fc\u30bf\u304c1\u65b9\u5411\u306b\u3057\u304b\u6d41\u308c\u306a\u3044\n\n\n\u306e\u3067\u6d41\u308c\u3092\u8ffd\u3044\u3084\u3059\u3044\n\n\n\u3069\u3053\u3067\u4f55\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u304b\u304c\u308f\u304b\u308a\u3084\u3059\u304f\u306a\u308b\n\n\n\u30b9\u30d1\u30b2\u30c3\u30c6\u30a3\u306a\u30b3\u30fc\u30c9\u306b\u306a\u308a\u306b\u304f\u3044\n\uff08\u305d\u306e\u5206\u30b3\u30fc\u30c9\u91cf\u306f\u591a\u304f\u306a\u308b\uff09\n\n\n\n\u305d\u3046\u3057\u3066 Facebook \u304c Flux \u3092\u63d0\u5531\u3057\u305f\u306f\u3044\u3044\u3082\u306e\u306e\u3001\u5b9f\u306f Fb \u304c\u7528\u610f\u3057\u305f\u306e\u306f dispatcher \u3068\u547c\u3070\u308c\u308b Flux \u3092\u69cb\u6210\u3059\u308b1\u8981\u7d20\u3060\u3051\u3067\u3042\u308a\u3001\u305d\u306e\u5b9f\u88c5\u3092\u57fa\u306b\u3057\u305f Flux \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u7fa4\u96c4\u5272\u62e0\u3059\u308b\u72b6\u6cc1\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\u305d\u3053\u306b\u98af\u723d\u3068\u73fe\u308c\u305f\u306e\u304c Flux \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u767a\u5c55\u3055\u305b\u3001\u305d\u3053\u305d\u3053\u5b9f\u7528\u7684\u306a\u4f5c\u308a\u3067\u3001\u3057\u304b\u3082\uff08React \u3067\u306e\u4f7f\u7528\u304c\u63a8\u5968\u3055\u308c\u3066\u306f\u3044\u308b\u3082\u306e\u306e\uff09React \u4ee5\u5916\u306e\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3082\u4f7f\u3048\u308b\u3068\u3044\u3046\u3001Flux \u7cfb\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3068\u3057\u3066\u306f\u982d\u4e00\u3064\u629c\u3051\u51fa\u305f\u611f\u306e\u3042\u308b Redux \u3068\u3044\u3046\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\nRedux \u306e\u7279\u5fb4\u306f\u2026\n\nStore \u304c\u30b0\u30ed\u30fc\u30d0\u30eb\u306b1\u500b\n\n\n\u3059\u3079\u3066\u306e State \u3092\u4e00\u3064\u306e Store \u304c\u7ba1\u7406\u3059\u308b\u306e\u3067\u898b\u901a\u3057\u304c\u826f\u304f\u306a\u308b\n\n\n\u3069\u3053\u304b\u3089\u3067\u3082\u30fb\u3069\u306e State \u3067\u3082\u53c2\u7167\u30fb\u66f4\u65b0\u304c\u3067\u304d\u308b\n\n\nReducer \u3092\u5206\u5272\u3059\u308b\u3053\u3068\u3067\u3001\u6a5f\u80fd\u5358\u4f4d\u3067\u306e\u30b3\u30fc\u30c9\u5206\u5272\u306f\u3057\u3084\u3059\u3044\n\n\nReducer\uff08State \u306e\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\uff09\u306b\u72b6\u614b\u3092\u6301\u305f\u305b\u306a\u3044\n\n\nReducer \u304c\u30b9\u30c6\u30fc\u30c8\u30ec\u30b9\u306a\u95a2\u6570(Pure Function)\n\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u304c\u30b9\u30c6\u30fc\u30c8\u30ec\u30b9\u306b\u306a\u308b\u3053\u3068\u3067\u3001\u30c6\u30b9\u30c8\u304c\u3057\u3084\u3059\u304f\u306a\u308b\n\u3061\u306a\u307f\u306b Action \u306e\u90e8\u5206\u3082\u72b6\u614b\u3092\u6301\u305f\u306a\u3044\n\n\n\n\u3068\u3044\u3046\u3001Flux \u3068\u306f\u4f3c\u3066\u975e\u306a\u308b\u3082\u306e\u3001\u3068\u3044\u3063\u305f\u611f\u3058\u306e\u4ed5\u4e0a\u304c\u308a\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306d\u3002\n\nRedux \u3067\u306a\u306b\u304b\u5b9f\u88c5\u3057\u3066\u307f\u308b\n\u3055\u3066\u3001\u65e9\u901f\u3067\u3059\u304c Redux \u3092\u4f7f\u3063\u3066\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\u4f8b\u3048\u3070\u3001TODO\u30ea\u30b9\u30c8\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u3092 Redux \u3067\u4f5c\u308b\u3068\u3057\u305f\u3089\u3001\u3069\u306e\u3088\u3046\u306b\u4f5c\u308c\u3070\u826f\u3044\u306e\u3067\u3057\u3087\u3046\uff1f\n\u6ce8: \u3053\u306e\u9805\u306e\u5b9f\u88c5\u30b5\u30f3\u30d7\u30eb\u306f\u307b\u3068\u3093\u3069\u52d5\u4f5c\u30c6\u30b9\u30c8\u3057\u3066\u307e\u305b\u3093\n\nRedux \u5074\u306e\u5b9f\u88c5\n\u5b9f\u88c5\u9806\u306b\u306f\u305d\u308c\u305e\u308c\u306e\u597d\u307f\u3082\u82e5\u5e72\u3042\u308a\u307e\u3059\u304c\u3001\u57fa\u672c\u7684\u306b\u306f\u4ee5\u4e0b\u306e\u69d8\u306a\u9806\u756a\u3067\u5b9f\u88c5\u3057\u3066\u3044\u304f\u306e\u304c\u3044\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n(1) Action \u306e Type Constants \u3092\u5217\u6319\u3057\u305f\u3082\u306e\nTODO\u30ea\u30b9\u30c8\u3068\u547c\u3070\u308c\u308b\u3082\u306e\u306b\u6700\u4f4e\u9650\u5fc5\u8981\u306a\u6a5f\u80fd\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3057\u3087\u3046\u304b\u3002\n\nTODO\u30ea\u30b9\u30c8\u306b\u9805\u76ee\u3092\u8ffd\u52a0\u3059\u308b\nTODO\u30ea\u30b9\u30c8\u304b\u3089\u9805\u76ee\u3092\u524a\u9664\u3059\u308b\n\u6307\u5b9a\u3057\u305f\u9805\u76ee\u306e\u5b9f\u884c\u6e08\u307f\u30d5\u30e9\u30b0\u3092\u5909\u66f4\u3059\u308b\n\n\u3059\u306a\u308f\u3061\u4e0a\u8a18\u304c Action \u306e\u7a2e\u985e\u306b\u3042\u305f\u308a\u3001\u3053\u306e3\u3064\u3092 Reducer \u304c\u5224\u5225\u3067\u304d\u308b\u3088\u3046\u306a\u5024\u304c\u5fc5\u8981\u3068\u306a\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u3092\u5b9a\u7fa9\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u756a\u6700\u521d\u306b\u4f5c\u308a\u307e\u3059\u3002\n\u306a\u304a\u3001\u5b9f\u88c5\u306b\u3088\u3063\u3066\u306f Action \u5185\u90e8\u306b\u542b\u3081\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u5f8c\u3005\u306e\u3053\u3068\u3092\u8003\u3048\u308b\u3068\u5225\u306b\u5206\u3051\u3066\u304a\u3044\u305f\u307b\u3046\u304c\u826f\u3044\u6c17\u304c\u3057\u307e\u3059\u3002\n\nsrc/constants/Todo.js\nexport const ADD_TODO = 'ADD_TODO';\nexport const DEL_TODO = 'DEL_TODO';\nexport const CHANGE_DID_FLAG = 'CHANGE_DID_FLAG';\n\n\n\u3053\u306e\u5b9a\u6570\u306e\u66f8\u304d\u65b9\u306b\u95a2\u3057\u3066\u7279\u306b\u6c7a\u307e\u308a\u306f\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u767a\u884c\u3055\u308c\u305f Action \u304c\u3059\u3079\u3066\u306e Reducer \u95a2\u6570\u3092\u901a\u308a Action \u304c\u3069\u3053\u306e Reducer \u306e\u3069\u306e\u51e6\u7406\u306b\u5411\u3051\u3089\u308c\u305f\u3082\u306e\u304b\u3092\u5224\u5225\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u306e\u3067\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5358\u4f4d\u306e\u30b9\u30b3\u30fc\u30d7\u3067\u30e6\u30cb\u30fc\u30af\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff08\u5927\u898f\u6a21\u306b\u306a\u308b\u5834\u5408\u306f\u6a5f\u80fd\u306e\u304b\u305f\u307e\u308a\u5358\u4f4d\u3067\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306e\u3088\u3046\u306a\u3082\u306e\u3092 prefix \u3068\u3057\u3066\u3064\u3051\u308b\u3068\u304b\u306e\u5de5\u592b\u304c\u3042\u3063\u305f\u307b\u3046\u304c\u826f\u3055\u305d\u3046\uff09\u3002\n\n(2) Reducer \u3092\u4f5c\u308b\uff08State \u306e\u8a2d\u8a08\uff09\n\u3053\u3053\u3067\u3001TODO\u30ea\u30b9\u30c8\u3068\u3057\u3066\u5fc5\u8981\u306a State \u306e\u69cb\u9020\u3092\u56fa\u3081\u3001\u5148\u307b\u3069\u5217\u6319\u3057\u305f const \u3092\u3082\u3068\u306b State \u306e\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u3092\u66f8\u304d\u307e\u3059\u3002\n\nsrc/reducers/Todo.js\nimport * as Todo from '../constants/Todo';\n\nconst initialState = {\n  todoList: [],\n  id: 0,\n  didCount: 0,\n};\n\nexport default function todo(state = initialState, action) {\n  const todoList = [].concat(state.todoList);\n  const actionId = action.id;\n\n  switch (action.type) {\n    case Todo.ADD_TODO:\n      const { name, dueTo } = action.todo;\n      const stateId = state.id + 1;\n      todoList.push({stateId, name, dueTo, did: false});\n      return Object.assign({}, state, {\n        todoList,\n        id: stateId,\n      });\n    case Todo.DEL_TODO:\n      const filteredList = todoList.filter(item => item.id != actionId);\n      return Object.assign({}, state, {\n        filteredList,\n      });\n    case Todo.CHANGE_DID_FLAG:\n      const targetIndex = todoList.findIndex(item => item.id == actionId);\n      if (targetIndex != -1) {\n        return state;\n      }\n\n      const flag = action.flag;\n      const didCount = flag ? state.didCount + 1 : state.didCount - 1;\n      todoList[targetIndex].did = flag;\n      return Object.assign({}, state, {\n        todoList,\n        didCount,\n      });\n    default:\n      return state;\n  }\n}\n\n\n\u307e\u305a\u306f import * as Todo from '../contants/Todo' \u3067\u5148\u307b\u3069\u4f5c\u3063\u305f Action \u306e\u30bf\u30a4\u30d7\u5b9a\u7fa9\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001Reducder \u95a2\u6570\u3068\u3057\u3066 todo() \u3092\u5b9f\u88c5\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u524d\u306b\u521d\u671f State \u3068\u3057\u3066 const initialState = {...} \u3068\u3044\u3046\u5b9a\u7fa9\u3092\u3057\u3066\u304a\u304d\u307e\u3059\uff08\u3053\u3053\u304c State \u306e\u69cb\u9020\u306b\u5f53\u305f\u308b\u90e8\u5206\u3067\u3059\u304c\u3001\u5b9f\u88c5\u3092\u898b\u308c\u3070\u5206\u304b\u308b\u901a\u308a\u3001\u3042\u304f\u307e\u3067\u3082\u521d\u671f State \u3092\u6c7a\u3081\u3066\u3044\u308b\u3060\u3051\u306e\u305f\u3081\u3001\u5b9f\u88c5\u306b\u3088\u3063\u3066\u306f\u3053\u3053\u304b\u3089 State \u304c\u5927\u304d\u304f\u5909\u308f\u3063\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u3082\u3042\u308a\u307e\u3059\uff09\u3002\ntodo() \u306f\u3001\u524d\u306b\u6301\u3063\u3066\u3044\u305f State \u3068 Action \u3092\u53d7\u3051\u53d6\u308a\u3001action.type \u306e\u5024\u306b\u5fdc\u3058\u3066switch\u6587\u306b\u3088\u308a\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u3092\u6c7a\u5b9a\u3057\u307e\u3059\uff08\u4eee\u306b\u30d1\u30bf\u30fc\u30f3\u304c\u5c11\u306a\u3044\u5834\u5408\u306fif\u6587\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\uff09\u3002\n\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u304c\u6c7a\u5b9a\u3057\u305f\u3089\u3001\u305d\u306e\u30ed\u30b8\u30c3\u30af\u306b\u5f93\u3044\u65b0\u3057\u3044 State \u3092\u8fd4\u3057\u307e\u3059\u3002\n\u3053\u3053\u3067\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308b\u306e\u306f\u3001 Reducer \u306f\u72b6\u614b\u3092\u6301\u305f\u306a\u3044 \u3068\u3044\u3046\u70b9\u3067\u3001\u5f15\u6570\u3068\u3057\u3066\u6e21\u3063\u3066\u304d\u305f State \u304c Object \u3084 Array \u306e\u5834\u5408\u306f \u76f4\u63a5\u66f8\u304d\u63db\u3048\u3066\u306f\u3044\u3051\u307e\u305b\u3093\u3002\n\u306e\u3067\u3001State \u304c Object \u306e\u5834\u5408\u306f Object.assign() \u3092\u3001Array \u306e\u5834\u5408\u306f [].concat() \u306a\u3069\u3092\u4f7f\u3063\u3066\u65b0\u3057\u3044 Object \u3084 Array \u306b\u3057\u305f\u3046\u3048\u3067\u5024\u306e\u5909\u66f4\u3092\u53cd\u6620\u3057\u3066 return \u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nMemo: \u306a\u305c\u76f4\u63a5\u66f8\u304d\u63db\u3048\u3061\u3083\u30c0\u30e1\uff1f\n\n\u306a\u305c\u76f4\u63a5 State \u3092\u64cd\u4f5c\u3057\u3066\u306f\u3044\u3051\u306a\u3044\u306e\u304b\uff1f\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u8aac\u660e\u3057\u307e\u3057\u3087\u3046\u3002\nRedux \u306f Reducer \u95a2\u6570\u3092\u5b9f\u884c\u3057\u305f\u5f8c \u53d7\u3051\u53d6\u3063\u305f State \u3092\u524d\u5f8c\u3067\u6bd4\u8f03\u3057\u3066\u7570\u306a\u308b\u72b6\u614b\u306e\u6642\u306e\u307f \u65b0\u3057\u3044\u65b9\u306e State \u3092\u63a1\u7528\u3059\u308b\u3001\u3068\u3044\u3046\u52d5\u304d\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\u4ee5\u4e0b\u306f\u3001Redux \u304c Action \u3092 Reducer \u95a2\u6570\u306b\u901a\u3059\u90e8\u5206\u306e\u6838\u3068\u306a\u308b\u90e8\u5206\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\nhttps://github.com/reactjs/redux/blob/63fe8503c1a04487f78284d1abddfd87f537f1e7/src/combineReducers.js#L123-L137\n\u30cf\u30a4\u30e9\u30a4\u30c8\u3057\u3066\u3044\u308b\u90e8\u5206\u306b\u3054\u6ce8\u76ee\u304f\u3060\u3055\u3044\u3002\nvar previousStateForKey = state[key] \u3068\u3044\u3046\u7b87\u6240\u3067\u3001Reducer \u3092\u5b9f\u884c\u3059\u308b\u524d\u306e State \u3092\u6301\u3063\u3066\u304d\u3066\u3044\u3066\u3001var nextStateForKey = reducer(previousStateForKey, action) \u3068\u3044\u3046\u7b87\u6240\u3067\u305d\u306e State \u3068\u767a\u884c\u3055\u308c\u305f Action \u3092 Reducer \u95a2\u6570\u3092\u901a\u3057\u3066\u3044\u307e\u3059\u3002\n\u305d\u3057\u3066\u3001hasChanged = hasChanged || nextStateForKey !== previousStateForKey \u3068\u3044\u3046\u90e8\u5206\u3067\u524d\u5f8c\u3092\u6bd4\u8f03\u3057\u3066\u3044\u307e\u3059\u306d\u3002\n\u3053\u3053\u3067\u3001JavaScript \u306e\u4ed5\u69d8\u3068\u3057\u3066 \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u578b\u306f\u7121\u6761\u4ef6\u3067\u53c2\u7167\u6e21\u3057\u306b\u306a\u308b \u3068\u3044\u3046\u70b9\u304c\u3042\u308a\u307e\u3059\u3002\n\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u4eba\u306f\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nvar a = {a: 'aaa', b: 'bbb'};\n\nvar b = a;\nb.b = 'bbbb';\n\nvar c = (function (item) {\n  item.c = 'ccc';\n  return item;\n})(b);\n\n// \u4e0b\u8a18\u306e console.log() \u306f\u3059\u3079\u3066 {a: 'aaa', b: 'bbbb', c: 'ccc'} \u3068\u3044\u3046\u7d50\u679c\u306b\u306a\u308b\nconsole.log(a);\nconsole.log(b);\nconsole.log(c);\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001Reducer \u3067\u5f15\u6570\u306e State \u3092\u76f4\u63a5\u5909\u66f4\u3057\u3061\u3083\u30c0\u30e1\u2026\u3068\u3044\u3046\u3088\u308a\u3001\u76f4\u63a5\u5909\u66f4\u3057\u3066\u3082\u5168\u304f\u610f\u5473\u304c\u7121\u3044\u308f\u3051\u3067\u3059\u3002\n\n(3) Action \u3092\u4f5c\u308b\nAction \u306f Flux \u3067\u306f ActionCreator \u3068\u547c\u3070\u308c\u308b\u7b87\u6240\u306e\u3082\u306e\u3067\u3059\u304c\u3001Redux \u3067\u306f\u524d\u8ff0\u3057\u305f\u901a\u308a\u3001\u3053\u3061\u3089\u3082\u305f\u3060\u306e\u95a2\u6570\uff08\u306e\u96c6\u5408\u4f53\uff09\u3067\u3059\u3002\n\nsrc/actions/Todo.js\nimport * as Todo from '../constants/Todo';\n\nexport function addTodo(name, dueTo) {\n  return {\n    type: Todo.ADD_TODO,\n    todo: {name, dueTo},\n  };\n}\n\nexport function delTodo(id) {\n  return {\n    type: Todo.DEL_TODO,\n    id,\n  };\n}\n\nexport function changeDidFlag(id, flag) {\n  return {\n    type: Todo.DEL_TODO,\n    id,\n    flag,\n  };\n}\n\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001type \u306b\u5165\u3063\u305f const \u304c Reducer \u95a2\u6570\u306e switch \u306b\u5bfe\u5fdc\u3059\u308b\u3088\u3046\u306a\u30c7\u30fc\u30bf\u3092 return \u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u3064\u307e\u308a\u2026\n// \u3053\u306e Action \u306f\u2026\nexport function addTodo(name, dueTo) {\n  return {\n    type: Todo.ADD_TODO,\n    todo: {name, dueTo},\n  };\n}\n\n// Reducer \u306e\u3053\u306e\u90e8\u5206\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\uff08\u4e0a\u8a18 Action \u304c\u767a\u884c\u3055\u308c\u308b\u3068\u3001\u3053\u306e\u90e8\u5206\u3067\u51e6\u7406\u3055\u308c\u308b\uff09\n...\n    case Todo.ADD_TODO:\n      const { name, dueTo } = action.todo;\n      const stateId = state.id + 1;\n      todoList.push({stateId, name, dueTo, did: false});\n      return Object.assign({}, state, {\n        todoList,\n        id: stateId,\n      });\n...\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\n\u3053\u308c\u3067\u3001Redux \u5074\u306e\u5b9f\u88c5\u306f\u4e00\u901a\u308a\u7d42\u308f\u308a\u307e\u3057\u305f\u3002\n\nReact \u3068\u306e\u3064\u306a\u304e\u8fbc\u307f\n\u3055\u3066\u3001\u3044\u3088\u3044\u3088 React \u3068\u306e\u3064\u306a\u304e\u8fbc\u307f\u306b\u5165\u308a\u307e\u3059\u3002\nRedux \u306f\u5148\u306b\u8ff0\u3079\u305f\u3068\u304a\u308a\u3001React \u4ee5\u5916\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u3082\u9069\u5408\u6027\u304c\u3042\u308a\u307e\u3059\u304c\u3001React \u306e\u5834\u5408\u306f\u516c\u5f0f\u3067\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\u305d\u308c\u306b\u3057\u305f\u304c\u3063\u3066\u7d44\u307f\u8fbc\u3080\u3060\u3051\u3067 React \u4e0a\u3067 Redux \u3092\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n(1) rootReducer \u3092\u4f5c\u308b\n\u4eca\u56de\u306e\u5834\u5408\u3001Reducer \u304c\u307e\u30601\u3064\u3057\u304b\u306a\u3044\u305f\u3081 Reducer \u3092\u307e\u3068\u3081\u308b\u5fc5\u8981\u6027\u306f\u5fc5\u305a\u3057\u3082\u3042\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\uff08\u307e\u3068\u3081\u306a\u304f\u3066\u3082\u3044\u3051\u307e\u3059\uff09\u304c\u3001\u4eca\u5f8c\u8907\u6570\u306b\u306a\u308b\u3053\u3068\u3092\u8003\u3048\u3066\u4e00\u5fdc\u3084\u3063\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\nsrc/rootReducer.js\nimport { combineReducers } from 'redux';\nimport todo from './reducers/todo';\n\nconst rootReducer = combineReducers({\n  todo,\n});\n\nexport default rootReducer;\n\n\n\n(2) Store \u3092\u4f5c\u308b\n\u5148\u306b\u4f5c\u3063\u305f rootReducer \u3092\u5165\u308c\u308b\u7bb1\u3068\u306a\u308b Store \u3092\u4f5c\u308a\u307e\u3059\u3002\n\nsrc/store.js\nimport { compose, createStore } from 'redux';\nimport rootReducer from './rootReducer';\n\nexport default function createFinalStore() {\n  const finalCreateStore = compose()(createStore);\n  return finalCreateStore(rootReducer);\n}\n\n\n\n(3) Store \u3092 Provider \u306b\u6e21\u3059\n\u3053\u306e Store \u3092 Redux \u3068 React \u3068\u306e\u30d6\u30ea\u30c3\u30b8\u306e\u5f79\u5272\u3092\u3057\u3066\u304f\u308c\u308b Provider \u306b\u6e21\u3057\u307e\u3059\u3002\n\nsrc/app.js\nimport React from 'react';\nimport { render } from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport Root from './components/Root';\nimport createFinalStore from './store';\n\nconst store = createFinalStore();\n\nrender(\n    <Provider store={store}>\n      <Root title=\"react test\">\n        \u3066\u3059\u3068\n      </Root>\n    </Provider>,\n    document.getElementById('app')\n);\n\n\n\n(4) connect \u3092\u4f7f\u3063\u3066 Component \u3067 State \u3078\u306e\u30a2\u30af\u30bb\u30b9\u3068 Action \u95a2\u6570\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n\u3055\u3089\u306b\u3001Reducer \u306b\u4ed8\u3044\u3066\u3044\u308b State \u3068 Action \u95a2\u6570\u3092 Component \u304b\u3089\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u3001React \u304b\u3089 Redux \u306e State \u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u308a Action \u95a2\u6570\u3092\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nimport React, { Component, PropTypes } from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport * as TodoActions from '../actions/Todo';\n\nimport Box from './Box';\nimport PostalCodeAjax from './PostalCodeAjax';\n\nexport default class Root extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showBox: true,\n    };\n  }\n\n  handleClick() {\n    this.setState({showBox: !this.state.showBox});\n  }\n\n  render() {\n    const btnName = this.state.showBox ? 'Box\u975e\u8868\u793a' : 'Box\u8868\u793a';\n    const boxTitle = this.state.boxTitle;\n    const boxComponent = this.state.showBox ? (\n      <Box boxTitleP={boxTitle}>Sample Box</Box>\n    ) : null;\n\n    return (\n      <div className=\"container\">\n        <h1>{this.props.title}</h1>\n        boxTitle: <input type=\"text\" onChange={elm => this.setState({boxTitle: elm.target.value})} />\n        {boxComponent}\n        <button className=\"btn btn-primary\" onClick={() => this.handleClick()}>{btnName}</button>\n        <div>\n          {this.props.children}\n        </div>\n        <PostalCodeAjax />\n      </div>\n    );\n  }\n}\n\nRoot.propTypes = {\n  title: PropTypes.string.isRequired,\n  children: PropTypes.any.isRequired,\n  todo: PropTypes.object.isRequired,\n  todoActions: PropTypes.object.isRequired,\n};\n\n// state \u306e\u4e2d\u306b store.js \u306e combineReducers \u3067\u6307\u5b9a\u3057\u305f\u30ad\u30fc\u306e State \u304c\u5168\u90e8\u5165\u3063\u3066\u304f\u308b\nfunction mapStateToProps(state) {\n  return {\n    todo: state.todo,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    todoActions: bindActionCreators(TodoActions, dispatch),\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Root);\n\n\u4e0a\u8a18\u306e\u4f8b\u306e\u5834\u5408\u3001State \u53c2\u7167\u3084 Action \u95a2\u6570\u306e\u5b9f\u884c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n// state\nconst todoList = this.props.todo.todoList;\n\n// action\nthis.props.todoActions.addTodo('todo', '9am');\n\n// \u30b5\u30f3\u30d7\u30eb\u898b\u3066\u308b\u3068\u3088\u304f\u898b\u304b\u3051\u3066\u4f7f\u3048\u308b\u3068\u601d\u3063\u305f ES6 \u7684\u306a\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\n// \u51e6\u7406\u3067\u4f7f\u3046 state, action \u3092\u3068\u308a\u3042\u3048\u305a\u51fa\u3057\u3066\u304a\u304f\u307f\u305f\u3044\u306a\nconst { todo, todoAction } = this.props; \n\n\nAjax\nRedux \u4e0a\u3067 Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u3059\u308b\u5834\u5408\u306b3\u3064\u30dd\u30a4\u30f3\u30c8\u304c\u3042\u308a\u307e\u3059\u3002\n\nAjax \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u3059\u308b\u306e\u306f Action \u95a2\u6570\u3067\n\u72b6\u614b\u9077\u79fb\u306e\u305f\u3081\u306b Action \u95a2\u6570\u3092\u5206\u3051\u308b\n\nreact-thunk \u3068\u3044\u3046 Middleware \u3092\u5165\u308c\u308b\n\n\nAjax \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u3059\u308b\u306e\u306f Action \u95a2\u6570\u3067\n\u3044\u3056 Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3046\u3068\u3059\u308b\u3068\u3001\u554f\u984c\u3068\u306a\u308b\u306e\u306f\u3069\u3053\u3067\u305d\u306e\u51e6\u7406\u3092\u3084\u308b\u306e\u304b\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u306d\u3002\n\u300cAjax \u3067\u53d6\u3063\u3066\u304d\u305f\u30c7\u30fc\u30bf\u3092 State \u306b\u5165\u308c\u308b\u3093\u3060\u3057 Reducer \u3058\u3083\u306a\u3044\u306e\uff1f\u300d\u3068\u601d\u3046\u65b9\u3082\u3044\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u305d\u306e\u5834\u5408\u30ed\u30fc\u30c9\u4e2d\u304b\u3089\u5b8c\u4e86\u2026\u306a\u3069\u306e\u72b6\u614b\u9077\u79fb\u304c\u3057\u3065\u3089\u304f\u306a\u308a\u307e\u3059\u3057\u3001\u3042\u304f\u307e\u3067\u3082 Reducer \u306f State \u306e\u72b6\u614b\u7ba1\u7406\uff08Object \u3068\u304b Array \u306b\u8981\u7d20\u3092\u5165\u308c\u305f\u308a\u8db3\u3057\u305f\u308a\u2026\uff09\u3068\u3044\u3046\u30d7\u30ea\u30df\u30c6\u30a3\u30d6\u306a\u6a5f\u80fd\u3092\u62c5\u5f53\u3059\u308b\u306e\u304c\u30d9\u30bf\u30fc\u3089\u3057\u3044\u306e\u3067\u3001Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u306f Action \u95a2\u6570\u306e\u4e2d\u3067\u3084\u3063\u305f\u307b\u3046\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\n\u72b6\u614b\u9077\u79fb\u306e\u305f\u3081\u306b Action \u95a2\u6570\u3092\u5206\u3051\u308b\n\u3055\u3066\u3001Action \u95a2\u6570\u3067\u3084\u308b\u3068\u306f\u8a00\u3044\u307e\u3057\u305f\u304c\u3001\u3069\u306e\u3088\u3046\u306b\u3084\u308c\u3070\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\n\u5148\u306b\u4f5c\u3063\u305fTODO\u30ea\u30b9\u30c8\u306e\u6a5f\u80fd\u62e1\u5f35\u3067\u300c\u30b5\u30fc\u30d0\u30fc\u306b\u30ea\u30b9\u30c8\u3092\u30bb\u30fc\u30d6\u3059\u308b\u300d\u3068\u3044\u3046\u6a5f\u80fd\u3092\u4f5c\u308b\u3068\u3057\u307e\u3057\u3087\u3046\u3002\n\nsrc/constants/Todo.js\nexport const ADD_TODO = 'ADD_TODO';\nexport const DEL_TODO = 'DEL_TODO';\nexport const CHANGE_DID_FLAG = 'CHANGE_DID_FLAG';\n\nexport const SAVE_LIST_AJAX_REQUEST = 'SAVE_LIST_AJAX_REQUEST';\nexport const SAVE_LIST_AJAX_RESULT = 'SAVE_LIST_AJAX_RESULT';\n\n\n\nsrc/reducers/todo.js\nimport * as Todo from '../contants/Todo';\n\nconst initialState = {\n  todoList: [],\n  id: 0,\n  didCount: 0,\n  saveLoading: false,\n  saveLoaded: false,\n  saveResult: false,\n};\n\nexport default function todo(state = initialState, action) {\n  const todoList = [].concat(state.todoList);\n  const actionId = action.id;\n\n  switch (action.type) {\n    case Todo.ADD_TODO:\n      const { name, dueTo } = action.todo;\n      const stateId = state.id + 1;\n      todoList.push({stateId, name, dueTo, did: false});\n      return Object.assign({}, state, {\n        todoList,\n        id: stateId,\n      });\n    case Todo.DEL_TODO:\n      const filteredList = todoList.filter(item => item.id != actionId);\n      return Object.assign({}, state, {\n        filteredList,\n      });\n    case Todo.CHANGE_DID_FLAG:\n      const targetIndex = todoList.findIndex(item => item.id == actionId);\n      if (targetIndex != -1) {\n        return state;\n      }\n\n      const flag = action.flag;\n      const didCount = flag ? state.didCount + 1 : state.didCount - 1;\n      todoList[targetIndex].did = flag;\n      return Object.assign({}, state, {\n        todoList,\n        didCount,\n      });\n    case Todo.SAVE_LIST_AJAX_REQUEST:\n      return Object.assign({}, state, {\n        saveLoading: true,\n        saveLoaded: false,\n        saveResult: false,\n      });\n    case Todo.SAVE_LIST_AJAX_RESULT:\n      return Object.assign({}, state, {\n        saveLoading: false,\n        saveLoaded: true,\n        saveResult: action.result,\n      });\n    default:\n      return state;\n  }\n}\n\n\n\nsrc/actions/Todo.js\nimport Axios from 'axios';\nimport * as Todo from '../constants/Todo';\n\nexport function addTodo(name, dueTo) {\n  return {\n    type: Todo.ADD_TODO,\n    todo: {name, dueTo},\n  };\n}\n\nexport function delTodo(id) {\n  return {\n    type: Todo.DEL_TODO,\n    id,\n  };\n}\n\nexport function changeDidFlag(id, flag) {\n  return {\n    type: Todo.DEL_TODO,\n    id,\n    flag,\n  };\n}\n\nexport function saveTodoList(data) {\n  return dispatch => {\n    dispatch(saveTodoListRequest());\n\n    Axios.post('/todo_list', data).then(\n      response => dispatch(saveTodoListResult(response.data.result))\n    ).catch(\n      () => dispatch(saveTodoListResult(false))\n    );\n  };\n}\n\nfunction saveTodoListRequest() {\n  return {\n    type: Todo.SAVE_LIST_AJAX_REQUEST,\n  };\n}\n\nfunction saveTodoListResult(result) {\n  return {\n    type: Todo.SAVE_LIST_AJAX_RESULT,\n    result,\n  };\n}\n\n\n\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\n\nsaveTodoList() \u306b\u3088\u308a\u2026\n\n\n\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u76f4\u524d\u306b saveTodoListRequest() \u3092\u5b9f\u884c\u3057 State \u3092\u5909\u66f4\n(Ajax \u30ea\u30af\u30a8\u30b9\u30c8)\n\u7d42\u4e86\u5f8c\u3001\u7d50\u679c\u3092\u53d7\u3051\u53d6\u308a saveTodoListResult() \u3092\u5b9f\u884c\u3057 State \u3092\u5909\u66f4\n\n\n\u3053\u3053\u3067\u306f POST \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u305f\u3081\u3001data.result \u3068\u3044\u3046\u5358\u7d14\u306a\u3082\u306e\u3092\u53d7\u3051\u53d6\u3063\u3066\u3044\u308b\u304c\u3001GET \u30ea\u30af\u30a8\u30b9\u30c8\u306b\u3088\u308a\u53d6\u5f97\u3057\u305f\u30ea\u30b9\u30c8\u3092 State \u306b\u5165\u308c\u308b\u3001\u3068\u3044\u3046\u3088\u3046\u306a\u51e6\u7406\u3082\u540c\u3058\u3088\u3046\u306b\u53ef\u80fd\n\n\n\n\n\n\u3068\u3044\u3046\u5f62\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u3053\u3067\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308b\u306e\u306f\u3001\u300c\u30b5\u30fc\u30d0\u30fc\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u3044\u308b\u300d\u3068\u3044\u3046\u30b9\u30c6\u30fc\u30bf\u30b9\u3068\u300c\u7d42\u308f\u3063\u305f\uff08\u6210\u529f\u30fb\u5931\u6557\uff09\u300d\u3068\u3044\u3046\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u5206\u3051\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\u4e0a\u8a18\u306e\u5834\u5408\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u4e2d\u306e\u5834\u5408\u306f saveLoading == true && saveLoaded == false \u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u304b\u3089\u3001\u305d\u306e\u9593\u306f\u30b9\u30d4\u30ca\u30fc\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u51fa\u3059\u3001\u3068\u3044\u3046\u3088\u3046\u306a\u5236\u5fa1\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\u307e\u305f\u3001\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u975e\u540c\u671f\u7684\u306a\u51e6\u7406\u3092 Action \u95a2\u6570\u306e\u4e2d\u3067\u884c\u3046\u306b\u306f\u3001dispatch \u3092\u53d7\u3051\u53d6\u308b\u95a2\u6570\u3092\u8fd4\u3057\u3001\u305d\u306e\u4e2d\u306b\u5b9f\u884c\u3057\u305f\u3044\u51e6\u7406\u3092\u66f8\u304f\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u305d\u3057\u3066\u3001\u5b9f\u884c\u3057\u305f\u3044\u5225\u306e Action \u95a2\u6570\u3092 dispatch(saveTodoListRequest()) \u3068\u3044\u3046\u5f62\u3067\u30e9\u30c3\u30d7\u3057\u3066\u3084\u308b\u3053\u3068\u3067\u5225\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nreact-thunk \u3068\u3044\u3046 Middleware \u3092\u5165\u308c\u308b\n\u3055\u3066\u3001\u3053\u306e\u307e\u307e\u3060\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3057\u307e\u3044\u52d5\u304d\u307e\u305b\u3093\u3002\n\u3068\u3044\u3046\u306e\u306f\u3001\u5b9f\u306f\u5148\u306b\u51fa\u3057\u305f\u300cdispatch \u3092\u53d7\u3051\u53d6\u308b\u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570\u300d\u3092 Action \u95a2\u6570\u3068\u3057\u3066\u4f7f\u3046\u305f\u3081\u306b Middleware \u304c\u5fc5\u8981\u306b\u306a\u308b\u305f\u3081\u3067\u3059\u3002\nReact \u3067 Middleware \u3092\u4f7f\u3046\u969b\u306b\u306f Store \u3092\u4f5c\u308b\u7b87\u6240\u3067\u9069\u7528\u3057\u307e\u3059\u3002\n\nsrc/store.js\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport Thunk from 'redux-thunk';\n\nimport rootReducer from './rootReducer';\n\nexport default function createFinalStore() {\n  const finalCreateStore = compose(applyMiddleware(Thunk))(createStore);\n  return finalCreateStore(rootReducer);\n}\n\n\n\u3053\u308c\u3067\u3001Redux \u304b\u3089 Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\uff08\u8ffd\u8a18\uff09Action \u95a2\u6570\u3092\u5206\u3051\u305a\u306b\u66f8\u304f\n\u3082\u3057\u4e00\u3064\u306e Reducer \u3067\u8907\u6570\u306e\u7a2e\u985e\u306e Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u304c\u5fc5\u8981\u306a\u5834\u5408\u3001\u7d30\u304b\u3044\u30c7\u30fc\u30bf\u306e\u51fa\u3057\u5206\u3051\u3068\u304b\u304c\u5fc5\u8981\u306a\u3051\u308c\u3070\u3001\u3053\u3046\u3044\u3046\u611f\u3058\u306e\u5171\u901a\u95a2\u6570\u3092\u66f8\u3051\u3070\u6bd4\u8f03\u7684\u3059\u3063\u304d\u308a\u66f8\u3051\u305d\u3046\u3002\nfunction requestPostAjax(url, data, requestFunc, fetchedFunc) {\n  return dispatch => {\n    dispatch(requestFunc());\n\n    Axios.post(url, data).then(\n      response => dispatch(fetchedFunc(true, response.data))\n    ).catch(\n      () => dispatch(fetchedFunc(false))\n    );\n  };\n}\n\nexport function saveTodoList(data) {\n  return requestPostAjax(\n    '/todo_list',\n    data,\n    () => {\n       return {\n          type: Todo.SAVE_LIST_AJAX_REQUEST,\n       };\n    },\n    result, data => {\n       return {\n          type: Todo.SAVE_LIST_AJAX_REQUEST,\n          result,\n          data,\n       };\n    }\n  );\n}\n\n\n\u307e\u3068\u3081\n\nRedux \u3068\u306f Flux \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u767a\u5c55\u3055\u305b\u305f\u305d\u3053\u305d\u3053\u4f7f\u308f\u308c\u3066\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\nRedux \u3067\u5b9f\u88c5\u3059\u308b\u4e0a\u3067\u306e\u304a\u4f5c\u6cd5\n\n\nState Object \u306f\u76f4\u63a5\u89e6\u3063\u3061\u3083\u30c0\u30e1\nAjax \u30ea\u30af\u30a8\u30b9\u30c8\u306f Action \u95a2\u6570\u3067\nreact-thunk \u3092\u5165\u308c\u3066 dispatch \u3092\u53d7\u3051\u53d6\u308b\u95a2\u6570\u3092\u8fd4\u305b\u3070\u975e\u540c\u671f\u51e6\u7406\u3082\u3067\u304d\u308b\u305e\u3044\n\n\nReact \u3068\u306f react-redux \u3092\u3064\u304b\u3063\u3066\u3064\u306a\u304e\u8fbc\u3080\n\n\nReducer \u3092\u307e\u3068\u3081\u308b\nStore \u3092\u4f5c\u308b\nStore \u3092 Provider \u306b\u6e21\u3059\nComponent \u304c State \u3068 Action \u95a2\u6570\u7fa4\u3092\u307e\u3068\u3081\u3066 Props \u3068\u3057\u3066\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b connect \u3059\u308b\n\n\n\n\n## \u524d\u56de\u307e\u3067\u306e\u307e\u3068\u3081\n+ \u74b0\u5883\u69cb\u7bc9\u7de8\n\t+ http://qiita.com/pullphone/items/98c31a21d0b50dc51b95\n+ React Tutorial \u7de8\n\t+ http://qiita.com/pullphone/items/efcaee59cf2a5725c61d\n\n## \u4eca\u56de\u306e\u30c6\u30fc\u30de\n+ \u305d\u3082\u305d\u3082 Redux \u3068\u306f\uff1f\n+ Redux \u3067\u5b9f\u88c5\u3059\u308b\u306b\u3042\u305f\u3063\u3066\u306e\u30c6\u30f3\u30d7\u30ec\u30fb\u304a\u7d04\u675f\n+ React \u3068 Redux \u3092\u3064\u306a\u3050\n\n## \u305d\u3082\u305d\u3082 Redux \u3068\u306f\u4f55\u8005\u306a\u306e\u304b\uff1f\n### React State \u306e\u843d\u3068\u3057\u7a74\n\u3055\u3066\u3001\u524d\u56de\u7d39\u4ecb\u3057\u305f React Component \u3067\u4f7f\u3048\u308b `State` \u306f Component \u5185\u3067\u3001\u3044\u308f\u3086\u308b\u300c\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u300d\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3001\u3064\u3044\u3064\u3044\u7121\u95c7\u306b\u4f7f\u3044\u304c\u3061\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u304c\u3001\u305d\u3046\u3057\u3066\u7121\u95c7\u306b State \u3092\u4f7f\u3046\u3053\u3068\u306e\u843d\u3068\u3057\u7a74\u3068\u3057\u3066\u6700\u305f\u308b\u3082\u306e\u306b **\u4ed6\u306e Component \u304b\u3089\u5909\u66f4\u3057\u305f\u304f\u306a\u3063\u305f\u6642\u306b\u8f9b\u304f\u306a\u308b** \u3068\u3044\u3046\u70b9\u304c\u3042\u308a\u307e\u3059\uff08\u3053\u308c\u306f\u5225\u306b React \u306b\u9650\u3063\u305f\u3053\u3068\u3067\u306f\u306a\u304f\u3001\u4ed6\u306e\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\uff08Angular \u3068\u304b Knockout \u3068\u304b Vue \u3068\u304b\uff09\u3067\u3082\u8a00\u3048\u308b\u3053\u3068\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\uff09\u3002\n\n\u5177\u4f53\u4f8b\u3068\u3057\u3066\u3001\u524d\u56de\u4f5c\u3063\u305f Root Component \u306e `this.state.showBox` \u3092\u3082\u3057 Box Component \u5074\u304b\u3089\u3082\u5909\u66f4\u3057\u305f\u3044\u5834\u5408\u306f\u3069\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u3088\u3044\u3067\u3057\u3087\u3046\u304b\uff1f\n\n\u4e00\u3064\u306e\u30d1\u30bf\u30fc\u30f3\u3068\u3057\u3066\u3001\u89aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304b\u3089\u5c02\u7528\u306e\u95a2\u6570\u3092 Props \u3067\u6e21\u3057\u3001\u305d\u308c\u3092\u5b50\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u5b9f\u884c\u3059\u308b\u3001\u3068\u3044\u3046\u3088\u3046\u306a\u65b9\u6cd5\u304c\u6319\u3052\u3089\u308c\u307e\u3059\u3002\n\n```js:src/components/Root.js\nimport React, { Component, PropTypes } from 'react';\n\nimport Box from './Box';\n\nexport default class Root extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showBox: false,\n    };\n  }\n\n  handleClick() {\n    this.setState({showBox: !this.state.showBox});\n  }\n\n  // this.state.showBox \u3092\u5909\u66f4\u3059\u308b\u3060\u3051\u306e\u95a2\u6570\n  changeShowBox(bool) {\n    this.setState({showBox: bool});\n  }\n\n  render() {\n    const btnName = this.state.showBox ? 'Box\u975e\u8868\u793a' : 'Box\u8868\u793a';\n    const boxComponent = this.state.showBox ? (\n      <Box changeShowBoxFunc={(bool) => this.changeShowBox(bool)}>Sample Box</Box>\n    ) : null;\n\n    return (\n      <div className=\"container\">\n        <h1>{this.props.title}</h1>\n        {boxComponent}\n        {/* onClick \u30a4\u30d9\u30f3\u30c8\u304c\u547c\u3073\u51fa\u3055\u308c\u305f\u6642\u306b handleClick() \u3092\u547c\u3073\u51fa\u3059 */}\n        <button className=\"btn btn-primary\" onClick={() => this.handleClick()}>{btnName}</button>\n        <div>\n          {this.props.children}\n        </div>\n      </div>\n    );\n  }\n}\n\nRoot.propTypes = {\n  title: PropTypes.string.isRequired,\n  children: PropTypes.any.isRequired,\n};\n```\n\n```js:src/components/Box.js\nimport React, { Component, PropTypes } from 'react';\n\nexport default class Box extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <div className=\"panel panel-default\">\n        <div className=\"panel-body\">\n          {this.props.children}\n          {/* \u89aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u304b\u3089\u6e21\u3063\u3066\u304d\u305f\u95a2\u6570\u3092\u305d\u306e\u307e\u307e\u5b9f\u884c */}\n          <button className=\"btn btn-primary\" onClick={() => this.props. changeShowBoxFunc(false)}>Close</button>\n        </div>\n      </div>\n    );\n  }\n}\n\nBox.propTypes = {\n  children: PropTypes.any.isRequired,\n  changeShowBoxFunc: PropTypes.func,\n};\n```\n\n\u3057\u304b\u3057\u3001\u3053\u306e\u65b9\u6cd5\u306f\u66f4\u306a\u308b\u554f\u984c\u70b9\u3092\u751f\u307f\u51fa\u3059\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n+ **\u3055\u3089\u306b\u591a\u5c64\u69cb\u9020\u306b\u306a\u3063\u305f\u6642\u306b\u3069\u3046\u3059\u3093\u306e\uff1f** \u3068\u3044\u3046\u554f\u984c\n\t+ \u5c64\u306e\u6570\u3060\u3051 Props \u3067\u53d7\u3051\u6e21\u3059\u5fc5\u8981\u304c\u51fa\u3066\u304f\u308b\n+ **\u3053\u306e Component \u306e\u95a2\u6570\u3001\u3069\u306e Component \u306e\u3001\u3069\u306e State \u3092\u5909\u3048\u3066\u3093\u306e\uff1f** \u3068\u3044\u3046\u554f\u984c\n\t+ \u4e0a\u8a18\u306e\u3088\u3046\u306a1\u5c64\u304f\u3089\u3044\u3067\u3042\u308c\u3070\u306a\u3093\u3068\u306a\u304f\u308f\u304b\u308b\u3051\u3069\u3001\u5c64\u304c\u5897\u3048\u308b\u3068 State \u3092\u5909\u66f4\u3057\u3066\u3044\u308b\u7b87\u6240\u304c\u30d1\u30c3\u3068\u898b\u3067\u5206\u304b\u308a\u3065\u3089\u304f\u306a\u308b\n\n\u306a\u3069\u306a\u3069\u2026\u3064\u307e\u308a\u3001 **\u898f\u6a21\u304c\u5c0f\u3055\u3044\u3046\u3061\u306f\u3044\u3044\u3051\u3069\u30c7\u30ab\u304f\u306a\u308b\u3068\u3084\u3063\u3071\u8f9b\u3044\u3088\u306d\u30fc** \u3068\u3044\u3046 ***\u3069\u3053\u306b\u3067\u3082\u3042\u308b\u3042\u306e\u554f\u984c*** \u3068\u3044\u3048\u3070\u306a\u3093\u3068\u306a\u304f\u4f1d\u308f\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u305d\u3057\u3066\u3001\u3053\u308c\u3092\u89e3\u6d88\u3059\u308b\u305f\u3081\u306e\uff08\u3060\u3051\u3058\u3083\u306a\u3044\u3067\u3059\u304c\u2026\uff09\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u304c\u5b9f\u306f\u6628\u4eca\u8a71\u984c\u306e\u3001Facebook \u793e\u304c\u63d0\u5531\u3057\u3066\u3044\u308b **`Flux` \u3068\u547c\u3070\u308c\u308b\u30a2\u30ec** \u3067\u3059\u3002\n\n### Flux \u3068 Redux\n**\u3053\u306e\u9805\u306f\u500b\u4eba\u7684\u898b\u89e3\u3092\u542b\u307f\u307e\u3059**\n\nFlux \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306b\u3064\u3044\u3066\u306e\u8a73\u3057\u3044\u8aac\u660e\u306f\u7701\u304d\u307e\u3059\u304c\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u7279\u5fb4\u304c\u3042\u308b\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3068\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n+ \u30c7\u30fc\u30bf\u304c1\u65b9\u5411\u306b\u3057\u304b\u6d41\u308c\u306a\u3044\n\t+ \u306e\u3067\u6d41\u308c\u3092\u8ffd\u3044\u3084\u3059\u3044\n+ \u3069\u3053\u3067\u4f55\u304c\u884c\u308f\u308c\u3066\u3044\u308b\u304b\u304c\u308f\u304b\u308a\u3084\u3059\u304f\u306a\u308b\n\t+ \u30b9\u30d1\u30b2\u30c3\u30c6\u30a3\u306a\u30b3\u30fc\u30c9\u306b\u306a\u308a\u306b\u304f\u3044\n\t+ \uff08\u305d\u306e\u5206\u30b3\u30fc\u30c9\u91cf\u306f\u591a\u304f\u306a\u308b\uff09\n\n\u305d\u3046\u3057\u3066 Facebook \u304c Flux \u3092\u63d0\u5531\u3057\u305f\u306f\u3044\u3044\u3082\u306e\u306e\u3001\u5b9f\u306f Fb \u304c\u7528\u610f\u3057\u305f\u306e\u306f `dispatcher` \u3068\u547c\u3070\u308c\u308b Flux \u3092\u69cb\u6210\u3059\u308b1\u8981\u7d20\u3060\u3051\u3067\u3042\u308a\u3001\u305d\u306e\u5b9f\u88c5\u3092\u57fa\u306b\u3057\u305f Flux \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u7fa4\u96c4\u5272\u62e0\u3059\u308b\u72b6\u6cc1\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u305d\u3053\u306b\u98af\u723d\u3068\u73fe\u308c\u305f\u306e\u304c Flux \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u767a\u5c55\u3055\u305b\u3001\u305d\u3053\u305d\u3053\u5b9f\u7528\u7684\u306a\u4f5c\u308a\u3067\u3001\u3057\u304b\u3082\uff08React \u3067\u306e\u4f7f\u7528\u304c\u63a8\u5968\u3055\u308c\u3066\u306f\u3044\u308b\u3082\u306e\u306e\uff09React \u4ee5\u5916\u306e\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3082\u4f7f\u3048\u308b\u3068\u3044\u3046\u3001Flux \u7cfb\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3068\u3057\u3066\u306f\u982d\u4e00\u3064\u629c\u3051\u51fa\u305f\u611f\u306e\u3042\u308b `Redux` \u3068\u3044\u3046\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\n\nRedux \u306e\u7279\u5fb4\u306f\u2026\n\n+ Store \u304c\u30b0\u30ed\u30fc\u30d0\u30eb\u306b1\u500b\n\t+ \u3059\u3079\u3066\u306e State \u3092\u4e00\u3064\u306e Store \u304c\u7ba1\u7406\u3059\u308b\u306e\u3067\u898b\u901a\u3057\u304c\u826f\u304f\u306a\u308b\n\t\t+ \u3069\u3053\u304b\u3089\u3067\u3082\u30fb\u3069\u306e State \u3067\u3082\u53c2\u7167\u30fb\u66f4\u65b0\u304c\u3067\u304d\u308b\n  \t+ Reducer \u3092\u5206\u5272\u3059\u308b\u3053\u3068\u3067\u3001\u6a5f\u80fd\u5358\u4f4d\u3067\u306e\u30b3\u30fc\u30c9\u5206\u5272\u306f\u3057\u3084\u3059\u3044\n+ Reducer\uff08State \u306e\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\uff09\u306b\u72b6\u614b\u3092\u6301\u305f\u305b\u306a\u3044\n\t+ Reducer \u304c\u30b9\u30c6\u30fc\u30c8\u30ec\u30b9\u306a\u95a2\u6570(*Pure Function*)\n\t+ \u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u304c\u30b9\u30c6\u30fc\u30c8\u30ec\u30b9\u306b\u306a\u308b\u3053\u3068\u3067\u3001\u30c6\u30b9\u30c8\u304c\u3057\u3084\u3059\u304f\u306a\u308b\n\t+ \u3061\u306a\u307f\u306b Action \u306e\u90e8\u5206\u3082\u72b6\u614b\u3092\u6301\u305f\u306a\u3044\n\n\u3068\u3044\u3046\u3001Flux \u3068\u306f\u4f3c\u3066\u975e\u306a\u308b\u3082\u306e\u3001\u3068\u3044\u3063\u305f\u611f\u3058\u306e\u4ed5\u4e0a\u304c\u308a\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u306d\u3002\n\n## Redux \u3067\u306a\u306b\u304b\u5b9f\u88c5\u3057\u3066\u307f\u308b\n\n\u3055\u3066\u3001\u65e9\u901f\u3067\u3059\u304c Redux \u3092\u4f7f\u3063\u3066\u5b9f\u88c5\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\n\n\u4f8b\u3048\u3070\u3001TODO\u30ea\u30b9\u30c8\u306e\u30c7\u30fc\u30bf\u69cb\u9020\u3092 Redux \u3067\u4f5c\u308b\u3068\u3057\u305f\u3089\u3001\u3069\u306e\u3088\u3046\u306b\u4f5c\u308c\u3070\u826f\u3044\u306e\u3067\u3057\u3087\u3046\uff1f\n\n**\u6ce8: \u3053\u306e\u9805\u306e\u5b9f\u88c5\u30b5\u30f3\u30d7\u30eb\u306f\u307b\u3068\u3093\u3069\u52d5\u4f5c\u30c6\u30b9\u30c8\u3057\u3066\u307e\u305b\u3093**\n\n### Redux \u5074\u306e\u5b9f\u88c5\n\u5b9f\u88c5\u9806\u306b\u306f\u305d\u308c\u305e\u308c\u306e\u597d\u307f\u3082\u82e5\u5e72\u3042\u308a\u307e\u3059\u304c\u3001\u57fa\u672c\u7684\u306b\u306f\u4ee5\u4e0b\u306e\u69d8\u306a\u9806\u756a\u3067\u5b9f\u88c5\u3057\u3066\u3044\u304f\u306e\u304c\u3044\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n#### (1) Action \u306e Type Constants \u3092\u5217\u6319\u3057\u305f\u3082\u306e\nTODO\u30ea\u30b9\u30c8\u3068\u547c\u3070\u308c\u308b\u3082\u306e\u306b\u6700\u4f4e\u9650\u5fc5\u8981\u306a\u6a5f\u80fd\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u611f\u3058\u3067\u3057\u3087\u3046\u304b\u3002\n\n+ TODO\u30ea\u30b9\u30c8\u306b\u9805\u76ee\u3092\u8ffd\u52a0\u3059\u308b\n+ TODO\u30ea\u30b9\u30c8\u304b\u3089\u9805\u76ee\u3092\u524a\u9664\u3059\u308b\n+ \u6307\u5b9a\u3057\u305f\u9805\u76ee\u306e\u5b9f\u884c\u6e08\u307f\u30d5\u30e9\u30b0\u3092\u5909\u66f4\u3059\u308b\n\n\u3059\u306a\u308f\u3061\u4e0a\u8a18\u304c Action \u306e\u7a2e\u985e\u306b\u3042\u305f\u308a\u3001\u3053\u306e3\u3064\u3092 Reducer \u304c\u5224\u5225\u3067\u304d\u308b\u3088\u3046\u306a\u5024\u304c\u5fc5\u8981\u3068\u306a\u308b\u306e\u3067\u3059\u304c\u3001\u305d\u308c\u3092\u5b9a\u7fa9\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4e00\u756a\u6700\u521d\u306b\u4f5c\u308a\u307e\u3059\u3002\n\n\u306a\u304a\u3001\u5b9f\u88c5\u306b\u3088\u3063\u3066\u306f Action \u5185\u90e8\u306b\u542b\u3081\u3066\u3057\u307e\u3063\u3066\u3044\u308b\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u5f8c\u3005\u306e\u3053\u3068\u3092\u8003\u3048\u308b\u3068\u5225\u306b\u5206\u3051\u3066\u304a\u3044\u305f\u307b\u3046\u304c\u826f\u3044\u6c17\u304c\u3057\u307e\u3059\u3002\n\n```js:src/constants/Todo.js\nexport const ADD_TODO = 'ADD_TODO';\nexport const DEL_TODO = 'DEL_TODO';\nexport const CHANGE_DID_FLAG = 'CHANGE_DID_FLAG';\n```\n\n\u3053\u306e\u5b9a\u6570\u306e\u66f8\u304d\u65b9\u306b\u95a2\u3057\u3066\u7279\u306b\u6c7a\u307e\u308a\u306f\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u304c\u3001\u767a\u884c\u3055\u308c\u305f Action \u304c\u3059\u3079\u3066\u306e Reducer \u95a2\u6570\u3092\u901a\u308a Action \u304c\u3069\u3053\u306e Reducer \u306e\u3069\u306e\u51e6\u7406\u306b\u5411\u3051\u3089\u308c\u305f\u3082\u306e\u304b\u3092\u5224\u5225\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u306e\u3067\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5358\u4f4d\u306e\u30b9\u30b3\u30fc\u30d7\u3067\u30e6\u30cb\u30fc\u30af\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff08\u5927\u898f\u6a21\u306b\u306a\u308b\u5834\u5408\u306f\u6a5f\u80fd\u306e\u304b\u305f\u307e\u308a\u5358\u4f4d\u3067\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u306e\u3088\u3046\u306a\u3082\u306e\u3092 prefix \u3068\u3057\u3066\u3064\u3051\u308b\u3068\u304b\u306e\u5de5\u592b\u304c\u3042\u3063\u305f\u307b\u3046\u304c\u826f\u3055\u305d\u3046\uff09\u3002\n\n#### (2) Reducer \u3092\u4f5c\u308b\uff08State \u306e\u8a2d\u8a08\uff09\n\u3053\u3053\u3067\u3001TODO\u30ea\u30b9\u30c8\u3068\u3057\u3066\u5fc5\u8981\u306a State \u306e\u69cb\u9020\u3092\u56fa\u3081\u3001\u5148\u307b\u3069\u5217\u6319\u3057\u305f const \u3092\u3082\u3068\u306b State \u306e\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u3092\u66f8\u304d\u307e\u3059\u3002\n\n```js:src/reducers/Todo.js\nimport * as Todo from '../constants/Todo';\n\nconst initialState = {\n  todoList: [],\n  id: 0,\n  didCount: 0,\n};\n\nexport default function todo(state = initialState, action) {\n  const todoList = [].concat(state.todoList);\n  const actionId = action.id;\n\n  switch (action.type) {\n    case Todo.ADD_TODO:\n      const { name, dueTo } = action.todo;\n      const stateId = state.id + 1;\n      todoList.push({stateId, name, dueTo, did: false});\n      return Object.assign({}, state, {\n        todoList,\n        id: stateId,\n      });\n    case Todo.DEL_TODO:\n      const filteredList = todoList.filter(item => item.id != actionId);\n      return Object.assign({}, state, {\n        filteredList,\n      });\n    case Todo.CHANGE_DID_FLAG:\n      const targetIndex = todoList.findIndex(item => item.id == actionId);\n      if (targetIndex != -1) {\n        return state;\n      }\n\n      const flag = action.flag;\n      const didCount = flag ? state.didCount + 1 : state.didCount - 1;\n      todoList[targetIndex].did = flag;\n      return Object.assign({}, state, {\n        todoList,\n        didCount,\n      });\n    default:\n      return state;\n  }\n}\n```\n\n\u307e\u305a\u306f `import * as Todo from '../contants/Todo'` \u3067\u5148\u307b\u3069\u4f5c\u3063\u305f Action \u306e\u30bf\u30a4\u30d7\u5b9a\u7fa9\u3092\u547c\u3073\u51fa\u3057\u307e\u3059\u3002\n\n\u305d\u3057\u3066\u3001Reducder \u95a2\u6570\u3068\u3057\u3066 `todo()` \u3092\u5b9f\u88c5\u3057\u307e\u3059\u304c\u3001\u305d\u306e\u524d\u306b\u521d\u671f State \u3068\u3057\u3066 `const initialState = {...}` \u3068\u3044\u3046\u5b9a\u7fa9\u3092\u3057\u3066\u304a\u304d\u307e\u3059\uff08\u3053\u3053\u304c State \u306e\u69cb\u9020\u306b\u5f53\u305f\u308b\u90e8\u5206\u3067\u3059\u304c\u3001\u5b9f\u88c5\u3092\u898b\u308c\u3070\u5206\u304b\u308b\u901a\u308a\u3001\u3042\u304f\u307e\u3067\u3082\u521d\u671f State \u3092\u6c7a\u3081\u3066\u3044\u308b\u3060\u3051\u306e\u305f\u3081\u3001\u5b9f\u88c5\u306b\u3088\u3063\u3066\u306f\u3053\u3053\u304b\u3089 State \u304c\u5927\u304d\u304f\u5909\u308f\u3063\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u3082\u3042\u308a\u307e\u3059\uff09\u3002\n\n`todo()` \u306f\u3001\u524d\u306b\u6301\u3063\u3066\u3044\u305f State \u3068 Action \u3092\u53d7\u3051\u53d6\u308a\u3001`action.type` \u306e\u5024\u306b\u5fdc\u3058\u3066switch\u6587\u306b\u3088\u308a\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u3092\u6c7a\u5b9a\u3057\u307e\u3059\uff08\u4eee\u306b\u30d1\u30bf\u30fc\u30f3\u304c\u5c11\u306a\u3044\u5834\u5408\u306fif\u6587\u3067\u3082\u69cb\u3044\u307e\u305b\u3093\uff09\u3002\n\n\u66f4\u65b0\u30ed\u30b8\u30c3\u30af\u304c\u6c7a\u5b9a\u3057\u305f\u3089\u3001\u305d\u306e\u30ed\u30b8\u30c3\u30af\u306b\u5f93\u3044\u65b0\u3057\u3044 State \u3092\u8fd4\u3057\u307e\u3059\u3002\n\n\u3053\u3053\u3067\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308b\u306e\u306f\u3001 **Reducer \u306f\u72b6\u614b\u3092\u6301\u305f\u306a\u3044** \u3068\u3044\u3046\u70b9\u3067\u3001\u5f15\u6570\u3068\u3057\u3066\u6e21\u3063\u3066\u304d\u305f State \u304c Object \u3084 Array \u306e\u5834\u5408\u306f **\u76f4\u63a5\u66f8\u304d\u63db\u3048\u3066\u306f\u3044\u3051\u307e\u305b\u3093\u3002**\n\n\u306e\u3067\u3001State \u304c Object \u306e\u5834\u5408\u306f `Object.assign()` \u3092\u3001Array \u306e\u5834\u5408\u306f `[].concat()` \u306a\u3069\u3092\u4f7f\u3063\u3066\u65b0\u3057\u3044 Object \u3084 Array \u306b\u3057\u305f\u3046\u3048\u3067\u5024\u306e\u5909\u66f4\u3092\u53cd\u6620\u3057\u3066 return \u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n##### ***Memo: \u306a\u305c\u76f4\u63a5\u66f8\u304d\u63db\u3048\u3061\u3083\u30c0\u30e1\uff1f***\n\u306a\u305c\u76f4\u63a5 State \u3092\u64cd\u4f5c\u3057\u3066\u306f\u3044\u3051\u306a\u3044\u306e\u304b\uff1f\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u8aac\u660e\u3057\u307e\u3057\u3087\u3046\u3002\n\nRedux \u306f Reducer \u95a2\u6570\u3092\u5b9f\u884c\u3057\u305f\u5f8c **\u53d7\u3051\u53d6\u3063\u305f State \u3092\u524d\u5f8c\u3067\u6bd4\u8f03\u3057\u3066\u7570\u306a\u308b\u72b6\u614b\u306e\u6642\u306e\u307f** \u65b0\u3057\u3044\u65b9\u306e State \u3092\u63a1\u7528\u3059\u308b\u3001\u3068\u3044\u3046\u52d5\u304d\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u4ee5\u4e0b\u306f\u3001Redux \u304c Action \u3092 Reducer \u95a2\u6570\u306b\u901a\u3059\u90e8\u5206\u306e\u6838\u3068\u306a\u308b\u90e8\u5206\u306e\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\nhttps://github.com/reactjs/redux/blob/63fe8503c1a04487f78284d1abddfd87f537f1e7/src/combineReducers.js#L123-L137\n\n\u30cf\u30a4\u30e9\u30a4\u30c8\u3057\u3066\u3044\u308b\u90e8\u5206\u306b\u3054\u6ce8\u76ee\u304f\u3060\u3055\u3044\u3002\n\n`var previousStateForKey = state[key]` \u3068\u3044\u3046\u7b87\u6240\u3067\u3001Reducer \u3092\u5b9f\u884c\u3059\u308b\u524d\u306e State \u3092\u6301\u3063\u3066\u304d\u3066\u3044\u3066\u3001`var nextStateForKey = reducer(previousStateForKey, action)` \u3068\u3044\u3046\u7b87\u6240\u3067\u305d\u306e State \u3068\u767a\u884c\u3055\u308c\u305f Action \u3092 Reducer \u95a2\u6570\u3092\u901a\u3057\u3066\u3044\u307e\u3059\u3002\n\n\u305d\u3057\u3066\u3001`hasChanged = hasChanged || nextStateForKey !== previousStateForKey` \u3068\u3044\u3046\u90e8\u5206\u3067\u524d\u5f8c\u3092\u6bd4\u8f03\u3057\u3066\u3044\u307e\u3059\u306d\u3002\n\n\u3053\u3053\u3067\u3001JavaScript \u306e\u4ed5\u69d8\u3068\u3057\u3066 **\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u578b\u306f\u7121\u6761\u4ef6\u3067\u53c2\u7167\u6e21\u3057\u306b\u306a\u308b** \u3068\u3044\u3046\u70b9\u304c\u3042\u308a\u307e\u3059\u3002\n\n\u3088\u304f\u308f\u304b\u3089\u306a\u3044\u4eba\u306f\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nvar a = {a: 'aaa', b: 'bbb'};\n\nvar b = a;\nb.b = 'bbbb';\n\nvar c = (function (item) {\n  item.c = 'ccc';\n  return item;\n})(b);\n\n// \u4e0b\u8a18\u306e console.log() \u306f\u3059\u3079\u3066 {a: 'aaa', b: 'bbbb', c: 'ccc'} \u3068\u3044\u3046\u7d50\u679c\u306b\u306a\u308b\nconsole.log(a);\nconsole.log(b);\nconsole.log(c);\n```\n\n\u3068\u3044\u3046\u3053\u3068\u3067\u3001Reducer \u3067\u5f15\u6570\u306e State \u3092\u76f4\u63a5\u5909\u66f4\u3057\u3061\u3083\u30c0\u30e1\u2026\u3068\u3044\u3046\u3088\u308a\u3001\u76f4\u63a5\u5909\u66f4\u3057\u3066\u3082\u5168\u304f\u610f\u5473\u304c\u7121\u3044\u308f\u3051\u3067\u3059\u3002\n\n#### (3) Action \u3092\u4f5c\u308b\n`Action` \u306f Flux \u3067\u306f ActionCreator \u3068\u547c\u3070\u308c\u308b\u7b87\u6240\u306e\u3082\u306e\u3067\u3059\u304c\u3001Redux \u3067\u306f\u524d\u8ff0\u3057\u305f\u901a\u308a\u3001\u3053\u3061\u3089\u3082\u305f\u3060\u306e\u95a2\u6570\uff08\u306e\u96c6\u5408\u4f53\uff09\u3067\u3059\u3002\n\n```js:src/actions/Todo.js\nimport * as Todo from '../constants/Todo';\n\nexport function addTodo(name, dueTo) {\n  return {\n    type: Todo.ADD_TODO,\n    todo: {name, dueTo},\n  };\n}\n\nexport function delTodo(id) {\n  return {\n    type: Todo.DEL_TODO,\n    id,\n  };\n}\n\nexport function changeDidFlag(id, flag) {\n  return {\n    type: Todo.DEL_TODO,\n    id,\n    flag,\n  };\n}\n```\n\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u3001`type` \u306b\u5165\u3063\u305f const \u304c Reducer \u95a2\u6570\u306e switch \u306b\u5bfe\u5fdc\u3059\u308b\u3088\u3046\u306a\u30c7\u30fc\u30bf\u3092 return \u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\u3064\u307e\u308a\u2026\n\n```js:\n// \u3053\u306e Action \u306f\u2026\nexport function addTodo(name, dueTo) {\n  return {\n    type: Todo.ADD_TODO,\n    todo: {name, dueTo},\n  };\n}\n\n// Reducer \u306e\u3053\u306e\u90e8\u5206\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\uff08\u4e0a\u8a18 Action \u304c\u767a\u884c\u3055\u308c\u308b\u3068\u3001\u3053\u306e\u90e8\u5206\u3067\u51e6\u7406\u3055\u308c\u308b\uff09\n...\n    case Todo.ADD_TODO:\n      const { name, dueTo } = action.todo;\n      const stateId = state.id + 1;\n      todoList.push({stateId, name, dueTo, did: false});\n      return Object.assign({}, state, {\n        todoList,\n        id: stateId,\n      });\n...\n```\n\n\u3068\u3044\u3046\u308f\u3051\u3067\u3059\u3002\n\n\u3053\u308c\u3067\u3001Redux \u5074\u306e\u5b9f\u88c5\u306f\u4e00\u901a\u308a\u7d42\u308f\u308a\u307e\u3057\u305f\u3002\n\n### React \u3068\u306e\u3064\u306a\u304e\u8fbc\u307f\n\u3055\u3066\u3001\u3044\u3088\u3044\u3088 React \u3068\u306e\u3064\u306a\u304e\u8fbc\u307f\u306b\u5165\u308a\u307e\u3059\u3002\n\nRedux \u306f\u5148\u306b\u8ff0\u3079\u305f\u3068\u304a\u308a\u3001React \u4ee5\u5916\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3068\u3082\u9069\u5408\u6027\u304c\u3042\u308a\u307e\u3059\u304c\u3001React \u306e\u5834\u5408\u306f\u516c\u5f0f\u3067\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\u305d\u308c\u306b\u3057\u305f\u304c\u3063\u3066\u7d44\u307f\u8fbc\u3080\u3060\u3051\u3067 React \u4e0a\u3067 Redux \u3092\u5229\u7528\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n#### (1) rootReducer \u3092\u4f5c\u308b\n\u4eca\u56de\u306e\u5834\u5408\u3001Reducer \u304c\u307e\u30601\u3064\u3057\u304b\u306a\u3044\u305f\u3081 Reducer \u3092\u307e\u3068\u3081\u308b\u5fc5\u8981\u6027\u306f\u5fc5\u305a\u3057\u3082\u3042\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\uff08\u307e\u3068\u3081\u306a\u304f\u3066\u3082\u3044\u3051\u307e\u3059\uff09\u304c\u3001\u4eca\u5f8c\u8907\u6570\u306b\u306a\u308b\u3053\u3068\u3092\u8003\u3048\u3066\u4e00\u5fdc\u3084\u3063\u3066\u304a\u304d\u307e\u3057\u3087\u3046\u3002\n\n```js:src/rootReducer.js\nimport { combineReducers } from 'redux';\nimport todo from './reducers/todo';\n\nconst rootReducer = combineReducers({\n  todo,\n});\n\nexport default rootReducer;\n```\n\n#### (2) Store \u3092\u4f5c\u308b\n\u5148\u306b\u4f5c\u3063\u305f rootReducer \u3092\u5165\u308c\u308b\u7bb1\u3068\u306a\u308b `Store` \u3092\u4f5c\u308a\u307e\u3059\u3002\n\n```js:src/store.js\nimport { compose, createStore } from 'redux';\nimport rootReducer from './rootReducer';\n\nexport default function createFinalStore() {\n  const finalCreateStore = compose()(createStore);\n  return finalCreateStore(rootReducer);\n}\n```\n\n#### (3) Store \u3092 Provider \u306b\u6e21\u3059\n\u3053\u306e Store \u3092 Redux \u3068 React \u3068\u306e\u30d6\u30ea\u30c3\u30b8\u306e\u5f79\u5272\u3092\u3057\u3066\u304f\u308c\u308b Provider \u306b\u6e21\u3057\u307e\u3059\u3002\n\n```js:src/app.js\nimport React from 'react';\nimport { render } from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport Root from './components/Root';\nimport createFinalStore from './store';\n\nconst store = createFinalStore();\n\nrender(\n    <Provider store={store}>\n      <Root title=\"react test\">\n        \u3066\u3059\u3068\n      </Root>\n    </Provider>,\n    document.getElementById('app')\n);\n```\n\n#### (4) connect \u3092\u4f7f\u3063\u3066 Component \u3067 State \u3078\u306e\u30a2\u30af\u30bb\u30b9\u3068 Action \u95a2\u6570\u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u3059\u308b\n\u3055\u3089\u306b\u3001Reducer \u306b\u4ed8\u3044\u3066\u3044\u308b State \u3068 Action \u95a2\u6570\u3092 Component \u304b\u3089\u4f7f\u3048\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u306b\u3088\u308a\u3001React \u304b\u3089 Redux \u306e State \u306b\u30a2\u30af\u30bb\u30b9\u3057\u305f\u308a Action \u95a2\u6570\u3092\u5b9f\u884c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n```\nimport React, { Component, PropTypes } from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport * as TodoActions from '../actions/Todo';\n\nimport Box from './Box';\nimport PostalCodeAjax from './PostalCodeAjax';\n\nexport default class Root extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showBox: true,\n    };\n  }\n\n  handleClick() {\n    this.setState({showBox: !this.state.showBox});\n  }\n\n  render() {\n    const btnName = this.state.showBox ? 'Box\u975e\u8868\u793a' : 'Box\u8868\u793a';\n    const boxTitle = this.state.boxTitle;\n    const boxComponent = this.state.showBox ? (\n      <Box boxTitleP={boxTitle}>Sample Box</Box>\n    ) : null;\n\n    return (\n      <div className=\"container\">\n        <h1>{this.props.title}</h1>\n        boxTitle: <input type=\"text\" onChange={elm => this.setState({boxTitle: elm.target.value})} />\n        {boxComponent}\n        <button className=\"btn btn-primary\" onClick={() => this.handleClick()}>{btnName}</button>\n        <div>\n          {this.props.children}\n        </div>\n        <PostalCodeAjax />\n      </div>\n    );\n  }\n}\n\nRoot.propTypes = {\n  title: PropTypes.string.isRequired,\n  children: PropTypes.any.isRequired,\n  todo: PropTypes.object.isRequired,\n  todoActions: PropTypes.object.isRequired,\n};\n\n// state \u306e\u4e2d\u306b store.js \u306e combineReducers \u3067\u6307\u5b9a\u3057\u305f\u30ad\u30fc\u306e State \u304c\u5168\u90e8\u5165\u3063\u3066\u304f\u308b\nfunction mapStateToProps(state) {\n  return {\n    todo: state.todo,\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    todoActions: bindActionCreators(TodoActions, dispatch),\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Root);\n```\n\n\u4e0a\u8a18\u306e\u4f8b\u306e\u5834\u5408\u3001State \u53c2\u7167\u3084 Action \u95a2\u6570\u306e\u5b9f\u884c\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308c\u3070\u826f\u3044\u3067\u3059\u3002\n\n```\n// state\nconst todoList = this.props.todo.todoList;\n\n// action\nthis.props.todoActions.addTodo('todo', '9am');\n\n// \u30b5\u30f3\u30d7\u30eb\u898b\u3066\u308b\u3068\u3088\u304f\u898b\u304b\u3051\u3066\u4f7f\u3048\u308b\u3068\u601d\u3063\u305f ES6 \u7684\u306a\u30b7\u30f3\u30bf\u30c3\u30af\u30b9\n// \u51e6\u7406\u3067\u4f7f\u3046 state, action \u3092\u3068\u308a\u3042\u3048\u305a\u51fa\u3057\u3066\u304a\u304f\u307f\u305f\u3044\u306a\nconst { todo, todoAction } = this.props; \n```\n\n### Ajax\nRedux \u4e0a\u3067 Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u3059\u308b\u5834\u5408\u306b3\u3064\u30dd\u30a4\u30f3\u30c8\u304c\u3042\u308a\u307e\u3059\u3002\n\n+ Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u3059\u308b\u306e\u306f Action \u95a2\u6570\u3067\n+ \u72b6\u614b\u9077\u79fb\u306e\u305f\u3081\u306b Action \u95a2\u6570\u3092\u5206\u3051\u308b\n+ `react-thunk` \u3068\u3044\u3046 Middleware \u3092\u5165\u308c\u308b\n\n#### Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u3059\u308b\u306e\u306f Action \u95a2\u6570\u3067\n\u3044\u3056 Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3046\u3068\u3059\u308b\u3068\u3001\u554f\u984c\u3068\u306a\u308b\u306e\u306f\u3069\u3053\u3067\u305d\u306e\u51e6\u7406\u3092\u3084\u308b\u306e\u304b\u3001\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u306d\u3002\n\n\u300cAjax \u3067\u53d6\u3063\u3066\u304d\u305f\u30c7\u30fc\u30bf\u3092 State \u306b\u5165\u308c\u308b\u3093\u3060\u3057 Reducer \u3058\u3083\u306a\u3044\u306e\uff1f\u300d\u3068\u601d\u3046\u65b9\u3082\u3044\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u305d\u306e\u5834\u5408\u30ed\u30fc\u30c9\u4e2d\u304b\u3089\u5b8c\u4e86\u2026\u306a\u3069\u306e\u72b6\u614b\u9077\u79fb\u304c\u3057\u3065\u3089\u304f\u306a\u308a\u307e\u3059\u3057\u3001\u3042\u304f\u307e\u3067\u3082 Reducer \u306f State \u306e\u72b6\u614b\u7ba1\u7406\uff08Object \u3068\u304b Array \u306b\u8981\u7d20\u3092\u5165\u308c\u305f\u308a\u8db3\u3057\u305f\u308a\u2026\uff09\u3068\u3044\u3046\u30d7\u30ea\u30df\u30c6\u30a3\u30d6\u306a\u6a5f\u80fd\u3092\u62c5\u5f53\u3059\u308b\u306e\u304c\u30d9\u30bf\u30fc\u3089\u3057\u3044\u306e\u3067\u3001Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u306f Action \u95a2\u6570\u306e\u4e2d\u3067\u3084\u3063\u305f\u307b\u3046\u304c\u826f\u3044\u3067\u3057\u3087\u3046\u3002\n\n#### \u72b6\u614b\u9077\u79fb\u306e\u305f\u3081\u306b Action \u95a2\u6570\u3092\u5206\u3051\u308b\n\u3055\u3066\u3001Action \u95a2\u6570\u3067\u3084\u308b\u3068\u306f\u8a00\u3044\u307e\u3057\u305f\u304c\u3001\u3069\u306e\u3088\u3046\u306b\u3084\u308c\u3070\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u304b\uff1f\n\n\u5148\u306b\u4f5c\u3063\u305fTODO\u30ea\u30b9\u30c8\u306e\u6a5f\u80fd\u62e1\u5f35\u3067\u300c\u30b5\u30fc\u30d0\u30fc\u306b\u30ea\u30b9\u30c8\u3092\u30bb\u30fc\u30d6\u3059\u308b\u300d\u3068\u3044\u3046\u6a5f\u80fd\u3092\u4f5c\u308b\u3068\u3057\u307e\u3057\u3087\u3046\u3002\n\n```js:src/constants/Todo.js\nexport const ADD_TODO = 'ADD_TODO';\nexport const DEL_TODO = 'DEL_TODO';\nexport const CHANGE_DID_FLAG = 'CHANGE_DID_FLAG';\n\nexport const SAVE_LIST_AJAX_REQUEST = 'SAVE_LIST_AJAX_REQUEST';\nexport const SAVE_LIST_AJAX_RESULT = 'SAVE_LIST_AJAX_RESULT';\n```\n\n```js:src/reducers/todo.js\nimport * as Todo from '../contants/Todo';\n\nconst initialState = {\n  todoList: [],\n  id: 0,\n  didCount: 0,\n  saveLoading: false,\n  saveLoaded: false,\n  saveResult: false,\n};\n\nexport default function todo(state = initialState, action) {\n  const todoList = [].concat(state.todoList);\n  const actionId = action.id;\n\n  switch (action.type) {\n    case Todo.ADD_TODO:\n      const { name, dueTo } = action.todo;\n      const stateId = state.id + 1;\n      todoList.push({stateId, name, dueTo, did: false});\n      return Object.assign({}, state, {\n        todoList,\n        id: stateId,\n      });\n    case Todo.DEL_TODO:\n      const filteredList = todoList.filter(item => item.id != actionId);\n      return Object.assign({}, state, {\n        filteredList,\n      });\n    case Todo.CHANGE_DID_FLAG:\n      const targetIndex = todoList.findIndex(item => item.id == actionId);\n      if (targetIndex != -1) {\n        return state;\n      }\n\n      const flag = action.flag;\n      const didCount = flag ? state.didCount + 1 : state.didCount - 1;\n      todoList[targetIndex].did = flag;\n      return Object.assign({}, state, {\n        todoList,\n        didCount,\n      });\n    case Todo.SAVE_LIST_AJAX_REQUEST:\n      return Object.assign({}, state, {\n        saveLoading: true,\n        saveLoaded: false,\n        saveResult: false,\n      });\n    case Todo.SAVE_LIST_AJAX_RESULT:\n      return Object.assign({}, state, {\n        saveLoading: false,\n        saveLoaded: true,\n        saveResult: action.result,\n      });\n    default:\n      return state;\n  }\n}\n```\n\n```js:src/actions/Todo.js\nimport Axios from 'axios';\nimport * as Todo from '../constants/Todo';\n\nexport function addTodo(name, dueTo) {\n  return {\n    type: Todo.ADD_TODO,\n    todo: {name, dueTo},\n  };\n}\n\nexport function delTodo(id) {\n  return {\n    type: Todo.DEL_TODO,\n    id,\n  };\n}\n\nexport function changeDidFlag(id, flag) {\n  return {\n    type: Todo.DEL_TODO,\n    id,\n    flag,\n  };\n}\n\nexport function saveTodoList(data) {\n  return dispatch => {\n    dispatch(saveTodoListRequest());\n\n    Axios.post('/todo_list', data).then(\n      response => dispatch(saveTodoListResult(response.data.result))\n    ).catch(\n      () => dispatch(saveTodoListResult(false))\n    );\n  };\n}\n\nfunction saveTodoListRequest() {\n  return {\n    type: Todo.SAVE_LIST_AJAX_REQUEST,\n  };\n}\n\nfunction saveTodoListResult(result) {\n  return {\n    type: Todo.SAVE_LIST_AJAX_RESULT,\n    result,\n  };\n}\n```\n\n\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\n\n+ saveTodoList() \u306b\u3088\u308a\u2026\n\t+ \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u76f4\u524d\u306b saveTodoListRequest() \u3092\u5b9f\u884c\u3057 State \u3092\u5909\u66f4\n\t+ (Ajax \u30ea\u30af\u30a8\u30b9\u30c8)\n\t+ \u7d42\u4e86\u5f8c\u3001\u7d50\u679c\u3092\u53d7\u3051\u53d6\u308a saveTodoListResult() \u3092\u5b9f\u884c\u3057 State \u3092\u5909\u66f4\n\t\t+ \u3053\u3053\u3067\u306f POST \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u305f\u3081\u3001`data.result` \u3068\u3044\u3046\u5358\u7d14\u306a\u3082\u306e\u3092\u53d7\u3051\u53d6\u3063\u3066\u3044\u308b\u304c\u3001GET \u30ea\u30af\u30a8\u30b9\u30c8\u306b\u3088\u308a\u53d6\u5f97\u3057\u305f\u30ea\u30b9\u30c8\u3092 State \u306b\u5165\u308c\u308b\u3001\u3068\u3044\u3046\u3088\u3046\u306a\u51e6\u7406\u3082\u540c\u3058\u3088\u3046\u306b\u53ef\u80fd\n\n\u3068\u3044\u3046\u5f62\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u3053\u3067\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308b\u306e\u306f\u3001\u300c\u30b5\u30fc\u30d0\u30fc\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u3063\u3066\u3044\u308b\u300d\u3068\u3044\u3046\u30b9\u30c6\u30fc\u30bf\u30b9\u3068\u300c\u7d42\u308f\u3063\u305f\uff08\u6210\u529f\u30fb\u5931\u6557\uff09\u300d\u3068\u3044\u3046\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u5206\u3051\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\n\u4e0a\u8a18\u306e\u5834\u5408\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u4e2d\u306e\u5834\u5408\u306f `saveLoading == true && saveLoaded == false` \u306b\u306a\u3063\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u304b\u3089\u3001\u305d\u306e\u9593\u306f\u30b9\u30d4\u30ca\u30fc\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u3092\u51fa\u3059\u3001\u3068\u3044\u3046\u3088\u3046\u306a\u5236\u5fa1\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u3053\u306e\u3088\u3046\u306b\u3057\u3066\u975e\u540c\u671f\u7684\u306a\u51e6\u7406\u3092 Action \u95a2\u6570\u306e\u4e2d\u3067\u884c\u3046\u306b\u306f\u3001`dispatch` \u3092\u53d7\u3051\u53d6\u308b\u95a2\u6570\u3092\u8fd4\u3057\u3001\u305d\u306e\u4e2d\u306b\u5b9f\u884c\u3057\u305f\u3044\u51e6\u7406\u3092\u66f8\u304f\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u305d\u3057\u3066\u3001\u5b9f\u884c\u3057\u305f\u3044\u5225\u306e Action \u95a2\u6570\u3092 `dispatch(saveTodoListRequest())` \u3068\u3044\u3046\u5f62\u3067\u30e9\u30c3\u30d7\u3057\u3066\u3084\u308b\u3053\u3068\u3067\u5225\u306e\u51e6\u7406\u3092\u5b9f\u884c\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n#### react-thunk \u3068\u3044\u3046 Middleware \u3092\u5165\u308c\u308b\n\u3055\u3066\u3001\u3053\u306e\u307e\u307e\u3060\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u3066\u3057\u307e\u3044\u52d5\u304d\u307e\u305b\u3093\u3002\n\n\u3068\u3044\u3046\u306e\u306f\u3001\u5b9f\u306f\u5148\u306b\u51fa\u3057\u305f\u300cdispatch \u3092\u53d7\u3051\u53d6\u308b\u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570\u300d\u3092 Action \u95a2\u6570\u3068\u3057\u3066\u4f7f\u3046\u305f\u3081\u306b Middleware \u304c\u5fc5\u8981\u306b\u306a\u308b\u305f\u3081\u3067\u3059\u3002\n\nReact \u3067 Middleware \u3092\u4f7f\u3046\u969b\u306b\u306f Store \u3092\u4f5c\u308b\u7b87\u6240\u3067\u9069\u7528\u3057\u307e\u3059\u3002\n\n```js:src/store.js\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport Thunk from 'redux-thunk';\n\nimport rootReducer from './rootReducer';\n\nexport default function createFinalStore() {\n  const finalCreateStore = compose(applyMiddleware(Thunk))(createStore);\n  return finalCreateStore(rootReducer);\n}\n```\n\n\u3053\u308c\u3067\u3001Redux \u304b\u3089 Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n### \uff08\u8ffd\u8a18\uff09Action \u95a2\u6570\u3092\u5206\u3051\u305a\u306b\u66f8\u304f\n\u3082\u3057\u4e00\u3064\u306e Reducer \u3067\u8907\u6570\u306e\u7a2e\u985e\u306e Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u304c\u5fc5\u8981\u306a\u5834\u5408\u3001\u7d30\u304b\u3044\u30c7\u30fc\u30bf\u306e\u51fa\u3057\u5206\u3051\u3068\u304b\u304c\u5fc5\u8981\u306a\u3051\u308c\u3070\u3001\u3053\u3046\u3044\u3046\u611f\u3058\u306e\u5171\u901a\u95a2\u6570\u3092\u66f8\u3051\u3070\u6bd4\u8f03\u7684\u3059\u3063\u304d\u308a\u66f8\u3051\u305d\u3046\u3002\n\n```\nfunction requestPostAjax(url, data, requestFunc, fetchedFunc) {\n  return dispatch => {\n    dispatch(requestFunc());\n\n    Axios.post(url, data).then(\n      response => dispatch(fetchedFunc(true, response.data))\n    ).catch(\n      () => dispatch(fetchedFunc(false))\n    );\n  };\n}\n\nexport function saveTodoList(data) {\n  return requestPostAjax(\n    '/todo_list',\n    data,\n    () => {\n       return {\n          type: Todo.SAVE_LIST_AJAX_REQUEST,\n       };\n    },\n    result, data => {\n       return {\n          type: Todo.SAVE_LIST_AJAX_REQUEST,\n          result,\n          data,\n       };\n    }\n  );\n}\n```\n\n## \u307e\u3068\u3081\n+ Redux \u3068\u306f Flux \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u767a\u5c55\u3055\u305b\u305f\u305d\u3053\u305d\u3053\u4f7f\u308f\u308c\u3066\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\n+ Redux \u3067\u5b9f\u88c5\u3059\u308b\u4e0a\u3067\u306e\u304a\u4f5c\u6cd5\n\t+ State Object \u306f\u76f4\u63a5\u89e6\u3063\u3061\u3083\u30c0\u30e1\n\t+ Ajax \u30ea\u30af\u30a8\u30b9\u30c8\u306f Action \u95a2\u6570\u3067\n\t+ react-thunk \u3092\u5165\u308c\u3066 dispatch \u3092\u53d7\u3051\u53d6\u308b\u95a2\u6570\u3092\u8fd4\u305b\u3070\u975e\u540c\u671f\u51e6\u7406\u3082\u3067\u304d\u308b\u305e\u3044\n+ React \u3068\u306f react-redux \u3092\u3064\u304b\u3063\u3066\u3064\u306a\u304e\u8fbc\u3080\n\t+ Reducer \u3092\u307e\u3068\u3081\u308b\n\t+ Store \u3092\u4f5c\u308b\n\t+ Store \u3092 Provider \u306b\u6e21\u3059\n\t+ Component \u304c State \u3068 Action \u95a2\u6570\u7fa4\u3092\u307e\u3068\u3081\u3066 Props \u3068\u3057\u3066\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b connect \u3059\u308b\n", "tags": ["ECMAScript6", "redux", "Node.js", "JavaScript", "React"]}