{"context": " More than 1 year has passed since last update.\n\nExcel \u30b7\u30fc\u30c8\u3092 CSV \u3067\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b VBScript\n\nxls2csv.vbs\nOption Explicit\n'--------------------------------------\n' Config\n'--------------------------------------\nconst SKIP_COUNT = 0 ' \u30d8\u30c3\u30c0\u884c\u51fa\u529b\u3059\u308b\n'const SKIP_COUNT = 1 ' \u30d8\u30c3\u30c0\u884c\u51fa\u529b\u3057\u306a\u3044\nconst FILE_FORMAT = 6 ' CSV (xlCSV)\n'const FILE_FORMAT = -4158 ' TSV (xlText/xlCurrentPlatformText)\nconst FILE_EXT = \".csv\"\n'const FILE_EXT = \".tsv\"\n\n'--------------------------------------\n' Globals\n'--------------------------------------\ndim wshShell\ndim winShell\ndim fso\ndim excel\nset wshShell = CreateObject(\"WScript.Shell\")\nset winShell = CreateObject(\"Shell.Application\")\nset fso = CreateObject(\"Scripting.FileSystemObject\")\nset excel = CreateObject(\"Excel.Application\")\nexcel.Visible = False\n\n'--------------------------------------\n' Functions\n'--------------------------------------\nsub XlsToCvs(xls, csvFolder)\n    dim book, sheet, fileName, table\n    dim i, c\n    set book = excel.WorkBooks.Open(xls,,True) ' Read Only\n    for each sheet in book.WorkSheets\n\n        if sheet.Range(\"A1\") = \"\" then\n            ' \u5de6\u4e0a\u7aef\u306e\u30bb\u30eb\u304b\u3089\u7a7a\u3060\u3063\u305f\u3089\u3001\u975e\u30c7\u30fc\u30bf\u7528\u30b7\u30fc\u30c8\u3068\u307f\u306a\u3057\u3066\u30b9\u30ad\u30c3\u30d7\u3059\u308b\n        else\n            fileName = csvFolder & \"\\\" & sheet.Name & FILE_EXT\n            'WScript.Echo(fileName)\n            ' \u30b7\u30fc\u30c8\u3092\u65b0\u898fbook\u306b\u30b3\u30d4\u30fc\u3059\u308b\n            sheet.Copy\n            ' \u30b3\u30d4\u30fc\u5148\u304cActiveWorkbook\u306b\u306a\u308b\n            with excel.ActiveWorkbook\n                .WorkSheets(1).EnableCalculation = False\n\n                ' \u5de6\u4e0a\u7aef\u304b\u3089\u7a7a\u884c\u7a7a\u5217\u3067\u56f2\u307e\u308c\u305f\u9818\u57df\u3092\u30c7\u30fc\u30bf\u7bc4\u56f2\u3068\u3059\u308b\n                set table = .WorkSheets(1).Range(\"A1\").CurrentRegion\n\n                'clearAround table           ' \u30c7\u30fc\u30bf\u7bc4\u56f2\u5916\u3092\u6d88\u53bb\n                removeGhostCells table      ' \u4f59\u5206\u306a\u7a7a\u767d\u884c\u30fb\u5217\u3092\u9664\u53bb\n                'keepLocalFormat table       ' \u8868\u793a\u66f8\u5f0f\u3092\u7dad\u6301\n                'keepConditionalFormat table ' \u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u3092\u7dad\u6301\n                'escapeSpecialChars table    ' \u7279\u6b8a\u6587\u5b57\u3092\u30a8\u30b9\u30b1\u30fc\u30d7\n                'fillEmptyCells table, \"\\N\"      ' \u7a7a\u767d\u30bb\u30eb\u306b\u5024\u3092\u8a2d\u5b9a\n\n                'toSqlLiterals table         ' SQL \u306e\u30ea\u30c6\u30e9\u30eb\u8868\u73fe\n\n                ' \u30d8\u30c3\u30c0\u884c\u3092SKIP_COUNT\u884c\u5206\u524a\u9664\n                if SKIP_COUNT > 0 then\n                    .WorkSheets(1).Cells.Rows(\"1:\" & SKIP_COUNT).EntireRow.Delete\n                end if\n\n                ' \u30d5\u30a1\u30a4\u30eb\u5f62\u5f0f\u3092\u6307\u5b9a\u3057\u3066\uff11\u30b7\u30fc\u30c8\u3092\u4fdd\u5b58\n                excel.DisplayAlerts = False\n                .SaveAs fileName, FILE_FORMAT\n                .Close\n                excel.DisplayAlerts = True\n            end with\n            'forceQuote(fileName)                ' \u5168\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u5f15\u7528\u7b26\u4ed8\u3051\n            'setLineTerminator fileName, vbLf    ' \u30ec\u30b3\u30fc\u30c9\u533a\u5207\u308a\u3092\u5909\u66f4\n            'convertToUTF8(fileName)             ' BOM\u306a\u3057UTF-8\u306b\u5909\u63db\n        end if\n    next\n    book.Close False \nend sub\n\nsub clearAround(rng)\n    dim data\n    data = rng.Value ' \u5024\u3092\u914d\u5217\u306b\u9000\u907f\n    rng.parent.Cells.ClearContents ' \u66f8\u5f0f\u3092\u6b8b\u3057\u3064\u3064\u5168\u30bb\u30eb\u6d88\u53bb\n    rng.Value = data\nend sub\n\nsub removeGhostCells(rng)\n    const xlCellTypeLastCell = 11\n    dim corner, margin, dr, dc\n    set corner = rng.cells(rng.Rows.Count, rng.Columns.Count)\n    set margin = rng.SpecialCells(xlCellTypeLastCell)\n    dr = margin.Row - corner.Row\n    dc = margin.Column - corner.Column\n    if 0 < dr then\n        corner.Offset(1,0).Resize(dr).EntireRow.Delete\n    end if\n    if 0 < dc then\n        corner.Offset(0,1).Resize(,dc).EntireColumn.Delete\n    end if\nend sub\n\nsub keepLocalFormat(rng)\n    dim col, c, numberCells\n    for each col in rng.Columns\n        set numberCells = collectNumberCells(col)\n        if not numberCells is Nothing then\n            set c = numberCells.Rows(1)\n            if c.NumberFormat <> \"General\" and c.NumberFormat <> c.NumberFormatLocal then\n                c.EntireColumn.NumberFormat = c.NumberFormatLocal\n            end if\n        end if\n    next\nend sub\n\nsub keepConditionalFormat(rng)\n    const xlExpression = 2\n    dim fc, addrs, c\n    addrs = \"\"\n    for each fc in rng.FormatConditions\n        ' if fc.NumberFormat <> \"\" then ' \u306a\u305c\u304b\u30a8\u30e9\u30fc\u306b\u306a\u308b\n            addrs = addrs & fc.AppliesTo.Address & \",\"\n        ' end if\n    next\n    if addrs = \"\" then exit sub\n    addrs = Left(addrs, Len(addrs)-1)\n    for each c in rng.Parent.Range(addrs)\n        c.Value = \"'\" & c.Text\n    next\nend sub\n\nsub escapeSpecialChars(rng)\n    excel.DisplayAlerts = False\n    rng.Replace vbLf, \"\\n\"\n    'rng.Replace vbCr, \"\\r\"\n    'rng.Replace vbTab, \"\\t\"\n    'rng.Replace \"\"\"\", \"\\x22\"\n    'rng.Replace \",\", \"\\x2C\"\n    excel.DisplayAlerts = True\nend sub\n\nsub fillEmptyCells(rng, val)\n    dim emptyCells\n    set emptyCells = collectEmptyCells(rng)\n    if not emptyCells is Nothing then\n        emptyCells.Value = val\n    end if\nend sub\n\nsub toSqlLiterals(rng)\n    dim col, c, emptyCells\n    for each col in rng.Columns\n        set c = col.Find(\"*\", col.Rows(1))\n        select case TypeName(c.Value)\n            case \"Date\"     col.NumberFormat = \"'yyyy-mm-dd hh:mm:ss'\"\n            case \"String\"   col.NumberFormat = \"'@'\"\n            case \"Currency\" col.NumberFormat = \"0.00\"\n        end select\n    next\n    set emptyCells = collectEmptyCells(rng)\n    if not emptyCells is Nothing then\n        emptyCells.NumberFormat = \"@\"\n        emptyCells.Value = \"NULL\"\n    end if\nend sub\n\nsub forceQuote(file)\n    const ForReading = 1, ForWriting = 2\n    dim csv, sep\n    if fso.GetExtensionName(file) = \"csv\" then\n        sep = \",\"\n    else\n        sep = \"\\t\"\n    end if\n    with fso.OpenTextFile(file, ForReading)\n        csv = .ReadAll\n        .Close\n    end with\n    with new RegExp\n        .Pattern = \"(\"\"?)((\"\"\"\"|\\n|.)*?)\\1(\" & sep & \"|\\r\\n|$)\"\n        .Global = True\n        csv = .Replace(csv, \"\"\"$2\"\"$4\")\n        csv = Left(csv, Len(csv) -2)    ' \u30b4\u30df\u3068\u308a\n    end with\n    with fso.OpenTextFile(file, ForWriting)\n        .Write(csv)\n        .Close\n    end with\nend sub\n\nsub setLineTerminator(file, eol)\n    const ForReading = 1, ForWriting = 2\n    dim csv\n    with fso.OpenTextFile(file, ForReading)\n        csv = .ReadAll\n        .Close\n    end with\n    with fso.OpenTextFile(file, ForWriting)\n        .Write(Replace(csv, vbCrLf, eol))\n        .Close\n    end with\nend sub\n\nsub convertToUtf8(file)\n    dim ps\n    ps = \"powershell -c \"\"&{[IO.File]::WriteAllLines($args[0], $(gc $args[0]))}\"\"\" ' PowerShell 2.0\u4ee5\u4e0a\n    'ps = \"powershell -c \"\"&{[IO.File]::WriteAllText($args[0], $(gc $args[0] -RAW))}\"\"\" ' PowerShell3.0\u4ee5\u4e0a\n    wshShell.run ps & \" \"\"\" & file & \"\"\"\", 0\nend sub\n\nfunction collectEmptyCells(rng)\n    const xlCellTypeBlanks = 4\n    set collectEmptyCells = Nothing\non error resume next\n    set collectEmptyCells = rng.SpecialCells(xlCellTypeBlanks)\non error goto 0\nend function\n\nfunction collectNumberCells(rng)\n    const xlCellTypeConstants = 2, xlNumbers = 1\n    set collectNumberCells = Nothing\non error resume next\n    set collectNumberCells = rng.SpecialCells(xlCellTypeConstants, xlNumbers)\non error goto 0\nend function\n\n'--------------------------------------\n' Main\n'--------------------------------------\nsub Main()\n    dim file, ext, folder\n    if WScript.Arguments.Count = 0 then\n        WScript.Echo(\"Excel\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\")\n        exit sub\n    end if\n    for each file in WScript.Arguments\n        file = fso.GetAbsolutePathName(file)\n        if not fso.FileExists(file) then \n            WScript.Echo(file & \"\u304c\u3042\u308a\u307e\u305b\u3093\")\n            exit sub\n        end if\n\n        ext = fso.GetExtensionName(file)\n        if ext <> \"xls\" and ext <> \"xlsx\" then\n            WScript.Echo(file & \"\u306fExcel\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u3042\u308a\u307e\u305b\u3093\")\n            exit sub\n        end if\n\n        folder = wshShell.SpecialFolders(\"Desktop\") & \"\\\" & fso.GetBaseName(file) ' \u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306b\u4fdd\u5b58\n        'folder = fso.GetParentFolderName(file) & \"\\\" & fso.GetBaseName(file) ' xls\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u5834\u6240\u306b\u4fdd\u5b58\n        'folder = wshShell.CurrentDirectory & \"\\\" & fso.GetBaseName(file) ' \u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u5b58\uff08\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5c02\u7528\uff09\n        if fso.FileExists(folder) then \n            WScript.Echo(folder & \"\u30d5\u30a9\u30eb\u30c0\u30fc\u304c\u4f5c\u6210\u3067\u304d\u307e\u305b\u3093\")\n            exit sub\n        elseif not fso.FolderExists(folder) then\n            fso.CreateFolder(folder)\n        end if\n\n        ' \u5909\u63db\u5b9f\u884c\n        XlsToCvs file, folder\n\n        'winShell.Explore folder ' CSV\u3092\u4fdd\u5b58\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u3092 Explorer \u3067\u958b\u304f\n    next\n    WScript.Echo(\"\u5b8c\u4e86\u3057\u307e\u3057\u305f\")\nend sub\n\n\nMain\n\nexcel.Quit\nset excel = Nothing\nWScript.Quit\n\n\n\n\u4f7f\u3044\u65b9\n\u4e0a\u8a18\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4efb\u610f\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4fdd\u5b58\u3057\u3001\u62e1\u5f35\u5b50\u3092'.vbs'\u3068\u3059\u308b\u3002\u6587\u5b57\u30b3\u30fc\u30c9\u306f Shift_JIS \u306b\u3059\u308b\u3053\u3068\u3002UTF-8 \u3060\u3068\u65e5\u672c\u8a9e\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n\u305d\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30a2\u30a4\u30b3\u30f3\u3078 Excel \u30d5\u30a1\u30a4\u30eb(.xls/.xslx)\u3092\u304a\u3082\u3080\u308d\u306b\u30c9\u30e9\u30c3\u30af\uff06\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3068\u3001\u540c\u540d\u306e\u30d5\u30a9\u30eb\u30c0\u304c\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306b\u4f5c\u6210\u3055\u308c\u3001\u914d\u4e0b\u306b\u5404\u30b7\u30fc\u30c8\u304cCSV\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3055\u308c\u308b\u3002Excel\u30d5\u30a1\u30a4\u30eb\u306f\u8907\u6570\u307e\u3068\u3081\u3066\u6e21\u3057\u3066\u3082\u3088\u3044\u3002\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u5b9f\u884c\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b cscript.exe \u3092\u4f7f\u3046\u304c\u3001\u5f15\u6570\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306f\u52b9\u304b\u306a\u3044\u306e\u3067\u60aa\u3057\u304b\u3089\u305a\u3002\nC:\\work>cscript xls2csv.vbs Book1.xlsx\nMicrosoft (R) Windows Script Host Version 5.812\nCopyright (C) Microsoft Corporation. All rights reserved.\n\n\u5b8c\u4e86\u3057\u307e\u3057\u305f\n\nWindows 10 / Excel 2013 \u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\u3002\n\u3082\u3068\u306f Excel \u306e CSV \u4fdd\u5b58\u64cd\u4f5c\u3092\u81ea\u52d5\u5316\u3057\u305f\u3060\u3051\u306e\u5358\u7d14\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3060\u3063\u305f\u304c\u5e74\u5b63\u304c\u5165\u3063\u3066\u3044\u3066\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u3044\u308f\u3086\u308b Excel CSV \u5f62\u5f0f\u306b\u52a0\u3048\u3044\u308d\u3044\u308d\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\u30b3\u30e1\u30f3\u30c8\u3092\u5916\u3059\u3060\u3051\u306a\u306e\u3067\u3001\u30bd\u30fc\u30b9\u3068\u30b3\u30e1\u30f3\u30c8\u3092\u773a\u3081\u308c\u3070\u3060\u3044\u305f\u3044\u308f\u304b\u308b\u3068\u601d\u3046\u3002\u9069\u5b9c\u3001\u7528\u9014\u306b\u5fdc\u3058\u3066\u53d6\u6368\u3057\u3066\u307b\u3057\u3044\u3002\n\u3042\u304f\u307e\u3067\u6280\u8853\u8005\u5411\u3051\u306e\u516c\u958b\u306a\u306e\u3067\u3001\u500b\u4eba\u306e\u8cac\u4efb\u7bc4\u56f2\u3067\u4f7f\u7528\u3057\u3066\u307b\u3057\u3044\u3002\u307e\u305f\u3053\u308c\u3092\u4e00\u822c\u306e\u4eba\u304c\u4f7f\u3046\u306e\u306f\u3044\u308d\u3044\u308d\u554f\u984c\u304c\u3042\u3063\u3066\u3088\u308d\u3057\u304f\u306a\u3044\u3002\n\u4f8b\u3048\u3070\u3001\u30a8\u30e9\u30fc\u51e6\u7406\u306e\u624b\u629c\u304d\u306b\u3088\u308a\u7570\u5e38\u7d42\u4e86\u5f8c\u306b\u6b8b\u3063\u3066\u3057\u307e\u3046 Excel \u30d7\u30ed\u30bb\u30b9\u306f\u81ea\u5206\u3067\u5bfe\u51e6\u3067\u304d\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\u307e\u305f\u3001WSH/VBScript \u306f\u53e4\u3044\u6280\u8853\u3067\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u4e0a\u306e\u554f\u984c\u304c\u3042\u308b\u3068\u3044\u3046\u306e\u306b\u3001\u5185\u5bb9\u3092\u78ba\u8a8d\u3067\u304d\u306a\u3044\u4e00\u822c\u306e\u4eba\u304cvbs\u30d5\u30a1\u30a4\u30eb\u306e\u5b9f\u884c\u306b\u5bfe\u3057\u3066\u8b66\u6212\u5fc3\u3092\u4e0b\u3052\u308b\u3088\u3046\u306a\u6a5f\u4f1a\u3092\u4eca\u66f4\u5897\u3084\u3057\u3066\u3057\u305f\u304f\u306f\u306a\u3044\u3002\n\n\u89e3\u8aac\u3068\u3044\u3046\u304b\u30dc\u30e4\u30ad\n\u3082\u3068\u306f\uff11\uff10\u5e74\u3050\u3089\u3044\u524d\u306b\u66f8\u3044\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u306a\u306e\u3060\u3051\u3069\u3001\u4eca\u3067\u3082\u52d5\u304b\u305b\u308b\u3053\u3068\u306b\u3061\u3087\u3063\u3068\u3073\u3063\u304f\u308a\u3002\u9006\u306b\u3001Excel \u304c\u76f8\u5909\u308f\u3089\u305a\u30af\u30bd\u3067\u5f53\u6642\u304b\u3089\u4e00\u3064\u3082\u9032\u6b69\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u306b\u3082\u3055\u3089\u306b\u3073\u3063\u304f\u308a\u3002\u305d\u308c\u304c\u30d0\u30b0\u3068\u304b\u8a2d\u8a08\u4e0a\u306e\u3057\u304c\u3089\u307f\u3068\u304b\u3067\u306f\u306a\u304f\u3001\u5358\u306a\u308b\u610f\u56f3\u7684\u306a\u30a4\u30e4\u304c\u3089\u305b\u3060\u3063\u305f\u3053\u3068\u306f\u3001\u3042\u3042\u3001\u4eca\u306a\u3089\u5206\u304b\u308b\u3088\u3002\n\n\u30c7\u30fc\u30bf\u7bc4\u56f2\u5916\u3092\u6d88\u53bb\n\n\u30b7\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u7bc4\u56f2\u5916\u306e\u30bb\u30eb\u304c\u4f7f\u308f\u308c\u3066\u3044\u3066\u3001CSV\u306b\u3054\u307f\u30c7\u30fc\u30bf\u3068\u306a\u3063\u3066\u51fa\u529b\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u306f\u308b\u306e\u306f\u666e\u901a\u306b\u3042\u308b\u3002\n\u5358\u4f53\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u3092\u4f5c\u3063\u3066\u3044\u308b\u3068\u304d\u306a\u3069\u3001\u5b9a\u6570\u3084\u30c7\u30fc\u30bf\u884c\u306b\u5bfe\u3059\u308b\u30e1\u30e2\uff08\u691c\u8a3c\u5185\u5bb9\u3084\u9805\u756a\u306a\u3069\uff09\u3092\u7f6e\u3044\u3066\u304a\u3051\u308b\u3068\u610f\u5916\u3068\u4fbf\u5229\u3060\u3063\u305f\u308a\u3059\u308b\u3002\nclearAround() \u306f\u6307\u5b9a\u306e\u30bb\u30eb\u7bc4\u56f2\u306e\u5916\u90e8\u306b\u3042\u308b\u3059\u3079\u3066\u306e\u30bb\u30eb\u306e\u5024\u3092\u6d88\u53bb\u3059\u308b\u3002\u6570\u5f0f\u306f\u5024\u306b\u7f6e\u304d\u63db\u308f\u308b\u306e\u3067\u3001\u6d88\u53bb\u3055\u308c\u308b\u30bb\u30eb\u3078\u306e\u53c2\u7167\u304c\u3042\u3063\u3066\u3082\u5024\u306f\u58ca\u308c\u306a\u3044\u3002\n\u4f59\u5206\u306a\u7a7a\u767d\u884c\u30fb\u5217\u3092\u9664\u53bb\n\u3069\u3046\u3044\u3046\u308f\u3051\u304b\u3001\u30c7\u30fc\u30bf\u306e\u306a\u3044\u306f\u305a\u306e\u4f59\u5206\u306a\u7a7a\u884c\u3084\u7a7a\u5217\u304cCSV\u51fa\u529b\u306b\u8ffd\u52a0\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308b\u3002\u898b\u304b\u3051\u304c\u7a7a\u3067\u3082Excel\u306b\u306f\u8996\u3048\u308b\u5e7d\u970a\u30bb\u30eb\u304c\u3042\u308b\u3089\u3057\u304f\u3001\u3053\u3046\u306a\u308b\u3068\u305d\u308c\u304c\u3044\u305d\u3046\u306a\u5f8c\u308d\u306e\u884c\u3084\u5217\u306e\u8fba\u308a\u3092\u4e38\u3054\u3068\u524a\u9664\u3059\u308b\u3057\u304b\u306a\u3044\u3002\nremoveGhoistCells() \u306f\u305d\u306e\u4f5c\u696d\u3092\u81ea\u52d5\u3067\u884c\u3046\u3002\n\n\u8868\u793a\u66f8\u5f0f\u3092\u7dad\u6301\n\n\u3069\u3046\u3044\u3046\u308f\u3051\u304b\u3001CSV \u306b\u51fa\u529b\u3057\u305f\u3068\u304d\u306b\u3001\u5024\u306e\u8868\u793a\u66f8\u5f0f\u304b\u52dd\u624b\u306b\u5909\u3048\u3089\u308c\u3066\u3057\u307e\u3046\u3053\u3068\u304c\u3042\u308b\u3002\u65e5\u4ed8\u3001\u6642\u523b\u3001\u901a\u8ca8\u306a\u3069\u304c\u5f71\u97ff\u3092\u53d7\u3051\u308b\u3088\u3046\u3060\u304c\u3001\u7279\u306b\u65e5\u4ed8\u304c\u7c73\u56fd\u5f0f\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u306f\u8179\u7acb\u305f\u3057\u3044\u3002\nExcel \u306f\u30bb\u30eb\u306e\u66f8\u5f0f\uff08\u8868\u793a\u5f62\u5f0f\uff09\u3092\u3001\u7c73\u56fd\u306b\u5408\u308f\u305b\u305f\u57fa\u672c\u66f8\u5f0f\u3068\u30ed\u30b1\u30fc\u30eb\u4f9d\u5b58\u306e\u5730\u57df\u66f8\u5f0f\u306e\uff12\u91cd\u3067\u6301\u3063\u3066\u3044\u3066\u3001\u4e21\u8005\u306b\u9055\u3044\u304c\u3042\u308b\u5834\u5408\u3001CSV\u51fa\u529b\u3067\u306f\u30ed\u30b1\u30fc\u30eb\u306b\u4f9d\u5b58\u3057\u306a\u3044\u57fa\u672c\u66f8\u5f0f\uff08\u7c73\u56fd\u66f8\u5f0f\uff09\u304c\u512a\u5148\u3055\u308c\u308b\u3002Excel \u306e\u300c\u30bb\u30eb\u306e\u8868\u793a\u8a2d\u5b9a\u300d\uff1e\uff5b\u8868\u793a\u5f62\u5f0f\u300d\u753b\u9762\u3067\u5148\u982d\u306b\u30a2\u30b9\u30bf\u30ea\u30b9\u30af(*)\u304c\u3064\u3044\u3066\u3044\u308b\u66f8\u5f0f\u304c\u305d\u308c\u3089\u3057\u3044\u3002\nkeepLocalFormat()\u306f\u5730\u57df\u66f8\u5f0f\u3067\u57fa\u672c\u66f8\u5f0f\u3092\u4e0a\u66f8\u304d\u3059\u308b\u3002\n\n\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u3092\u7dad\u6301\n\n\u3069\u3046\u3044\u3046\u308f\u3051\u304b\u3001\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u306f CSV \u51fa\u529b\u306b\u9069\u7528\u3055\u308c\u306a\u3044\u3002\n\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u306a\u3093\u3066\u4f7f\u3063\u305f\u3053\u3068\u3042\u308b\u3060\u308d\u3046\u304b\u3002\u307e\u3042\u3001\u30c7\u30fc\u30bf\u7528\u306e\u30b7\u30fc\u30c8\u306b\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u304c\u4f7f\u308f\u308c\u308b\u3053\u3068\u306f\u306a\u3044\u3060\u308d\u3046\u3057\u3001AVIVA\u3078\u3067\u3082\u884c\u304b\u306a\u3044\u9650\u308a\u307b\u3068\u3093\u3069\u306e\u6280\u8853\u8005\u306b\u306f\u7121\u7e01\u306a\u8a71\u3060\u3002\nkeepConditionalFormat()\u306f\u3001\u30bb\u30eb\u306b\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u304c\u3042\u308c\u3070\u73fe\u5728\u306e\u8868\u793a\u6587\u5b57\u5217\u3092\u30bb\u30eb\u5024\u306b\u8a2d\u5b9a\u3059\u308b\u3002\u305f\u3060\u3057\u30eb\u30fc\u30d7\u3067\u5404\u30bb\u30eb\u3092\u66f4\u65b0\u3059\u308b\u306e\u3067\u91cd\u3044\u51e6\u7406\u306b\u306a\u308b\u3002\n\n\u7279\u6b8a\u6587\u5b57\u3092\u30a8\u30b9\u30b1\u30fc\u30d7\n\nExcel \u306e\u30bb\u30eb\u5185\u6539\u884c\u306f CSV \u51fa\u529b\u3067\u306f LF \u3068\u3057\u3066\u51fa\u529b\u3055\u308c\u308b\u3002\u30ec\u30b3\u30fc\u30c9\u3092\uff11\u884c\u306b\u7d0d\u3081\u305f\u3044\u5834\u5408 LF \u3092\u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u3066\u304a\u304d\u305f\u3044\u3002\nescapeSpecialChars() \u306f\u30bb\u30eb\u6587\u5b57\u5217\u306e LF \u3092\"\u00a5n\"\u306b\u7f6e\u63db\u3059\u308b\u3002\u305f\u3060\u306e\u6587\u5b57\u5217\u7f6e\u63db\u306a\u306e\u3067\u3001\u5fc5\u8981\u306a\u3089\u305d\u308c\u4ee5\u5916\u306e\u30d1\u30bf\u30fc\u30f3\u3082\u8ffd\u52a0\u3067\u304d\u308b\u3002\n\n\u7a7a\u30bb\u30eb\u306b\u5024\u3092\u8a2d\u5b9a\n\n\u30bb\u30eb\u306b\u5024\u304c\u5165\u3063\u3066\u3044\u306a\u3044\u3068\u3001CSV\u51fa\u529b\u3067\u306f\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u7a7a\u306b\u306a\u308b\u3002\u53d6\u308a\u8fbc\u307f\u5074\u306e\u4ed5\u69d8\u306b\u3088\u3063\u3066\u306f\u3001NULL\u3084\\N\u306a\u3069\u7a7a\u5024\u3092\u793a\u3059\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u308c\u305f\u3044\u3002\nfillEmptyCells()\u306f\u5168\u3066\u306e\u7a7a\u30bb\u30eb\u306b\u6307\u5b9a\u306e\u5024\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3002\n\u7a7a\u3068NULL\u3092\u533a\u5225\u3057\u305f\u3044\u3053\u3068\u3082\u3042\u308b\u3002\u7a7a\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u307e\u307e\u306b\u3057\u3066\u304a\u304d\u305f\u3044\u30bb\u30eb\u306b\u306f\u3001\u3042\u3089\u304b\u3058\u3081\u30b7\u30f3\u30b0\u30eb\u30af\u30aa\u30fc\u30c8(')\u306e\u307f\u3092\u5165\u529b\u3057\u3066\u304a\u3051\u3070\u3044\u3044\u3002\u30b7\u30f3\u30b0\u30eb\u30af\u30aa\u30fc\u30c8\u306e\u307f\u306e\u30bb\u30eb\u306f\u7a7a\u6587\u5b57\u5217\u3092\u5024\u3068\u3057\u3066\u3082\u3064\u30bb\u30eb\u3067\u3042\u308a\u3001\u7a7a\u30bb\u30eb\u3068\u306f\u5224\u5b9a\u3055\u308c\u306a\u304f\u306a\u308b\u306e\u3067\u7a7a\u5024\u306e\u8a2d\u5b9a\u5bfe\u8c61\u3068\u306f\u306a\u3089\u306a\u3044\u304c\u3001CSV\u51fa\u529b\u3067\u306f\u5024\u306e\u306a\u3044\u7a7a\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u306a\u308b\u3002\u3082\u3046\u3001\u81ea\u5206\u3067\u3082\u4f55\u3092\u8a00\u3063\u3066\u3044\u308b\u306e\u304b\u308f\u304b\u3089\u306a\u3044\u3002\n\nSQL \u306e\u30ea\u30c6\u30e9\u30eb\u8868\u73fe\n\n\u3044\u3063\u305d\u3001INSERT \u6587\u3092\u751f\u6210\u3055\u305b\u305f\u304f\u306a\u308b\u306e\u3082\u7121\u7406\u306f\u306a\u3044\u3002\ntoSqlLiterals()\u306f\u305d\u308c\u7528\u306e\u3064\u3082\u308a\u3060\u3063\u305f\u304c\u3001\u307e\u3060\u3084\u308a\u304b\u3051\u306e\u3088\u3046\u3060\u3002\u4e2d\u9014\u534a\u7aef\u306a\u306e\u3067\u3042\u3066\u306b\u3057\u306a\u3044\u3067\u307b\u3057\u3044\u3002\u3082\u3046\u5c11\u3057\u4f55\u3068\u304b\u3067\u304d\u305f\u306f\u305a\u306a\u306e\u3060\u304c\u3001\u4eca\u66f4\u3084\u308b\u6c17\u3082\u8d77\u304d\u306a\u3044\u3002\n\n\u5168\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u5f15\u7528\u7b26\u4ed8\u3051\n\nExcel CSV \u306f\u57fa\u672c\u7684\u306b\u5404\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u30af\u30aa\u30fc\u30c8\u306a\u3057\u3067\u51fa\u529b\u3059\u308b\u3002\u305f\u3060\u3057\u3001\u5024\u306b\u6539\u884c\u3001\u30ab\u30f3\u30de(,)\u3001\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8(\")\u306a\u3069\u304c\u542b\u307e\u308c\u308b\u5834\u5408\u306b\u3001\u305d\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u56f2\u307e\u308c\u308b\u3002\n\u3069\u3046\u305b\u306a\u3089\u5168\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u56f2\u3093\u3067\u3082\u3089\u3063\u305f\u65b9\u304c\u53d6\u308a\u8fbc\u307f\u5074\u306e\u51e6\u7406\u304c\u697d\u306b\u306a\u308b\u3002\nforceQuote() \u306f\u5168\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u56f2\u307f\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n\u30ec\u30b3\u30fc\u30c9\u533a\u5207\u308a\u3092\u5909\u66f4\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ec\u30b3\u30fc\u30c9\u533a\u5207\u306f\u6539\u884c\u30b3\u30fc\u30c9(CRLF)\u3002\nsetLineTerminator() \u306f CRLF \u3092\u4efb\u610f\u306e\u6587\u5b57\u5217\u3067\u7f6e\u63db\u3059\u308b\u3002\u30bb\u30eb\u5185\u6539\u884c\uff08LF\uff09\u306f\u7f6e\u63db\u3055\u308c\u306a\u3044\u3002\n\nBOM\u306a\u3057UTF-8\u306b\u5909\u63db\n\n\u3069\u3046\u3044\u3046\u308f\u3051\u304b\u3001Excel \u3084 WSH \u306f UTF-8 \u51fa\u529b\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u306a\u3044\u3002Windows \u754c\u9688\u3067\u3044\u3046\u30e6\u30cb\u30b3\u30fc\u30c9\u30b5\u30dd\u30fc\u30c8\u3068\u306fUTF16(LE)\u306e\u3053\u3068\u3060\u3063\u305f\u308a\u3059\u308b\u3002 \nPowerShell \u304c\u51fa\u3066\u3084\u3063\u3068 UTF-8 \u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\u3057\u304b\u3057\u305d\u308c\u306f\u3001\u672c\u5f53\u306b\u8179\u7acb\u305f\u3057\u3044\u3053\u3068\u3060\u304c\u3001\u305d\u308c\u306f BOM \u4ed8\u304d UTF-8 \u3068\u3044\u3046\u3001\u672c\u5f53\u306b\u610f\u5473\u306e\u5206\u304b\u3089\u306a\u3044\u3001\u672c\u5f53\u306b\u30d8\u30f3\u306a\u3001\u4f59\u8a08\u306a\u3001\u3053\u306e\u3001\u672c\u5f53\u306b\u3001\u30af\u30d3\u3092\u7d5e\u3081\u3066\u3084\uff52\uff59\nconvertToUtf8()\u306f\u3001Shift_JIS \u3092 BOM \u306a\u3057\u306e UTF-8 \u306b\u5909\u63db\u3059\u308b\u3002WSH \u304b\u3089PowerShell \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8d77\u52d5\u3057\u3066\u5b9f\u73fe\u3057\u3066\u3044\u308b\u306e\u306f\u8ca0\u3051\u3060\u3002\n\u6539\u884c\u30b3\u30fc\u30c9\u304c\u5168\u3066\uff08\u30bb\u30eb\u5185\u6539\u884c\u3082\u542b\u3081\u3066\uff09 CRLF \u306b\u66f8\u304d\u623b\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u6ce8\u610f\u3002\u305d\u308c\u306f\u56f0\u308b\u3053\u3068\u3067\u3082\u306a\u3044\u304c\u3001\u56f0\u308b\u3068\u3044\u3046\u5834\u5408\u3001 PowerShell 3.0 \u4ee5\u4e0a\u306e\u74b0\u5883\u3067\u3042\u308c\u3070\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3055\u308c\u3066\u3044\u308b\uff12\u3064\u3081\u306e PowerShell \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5bfe\u5fdc\u3067\u304d\u305d\u3046\u306a\u611f\u3058\u306a\u306e\u3067\u8a66\u3057\u3066\u307b\u3057\u3044\u3002\n\nWSH/VBScript \u306b\u3064\u3044\u3066\n\u4ee5\u4e0b\u306b\u8a73\u3057\u3044\u3002\n\u30ec\u30ac\u30b7\u30fc\u74b0\u5883\u306e\u305f\u3081\u306eWindows Script Host(WSH)\u306e\u89e3\u8aac - Qiita\nWSH/VBScript \u306f\u30aa\u30ef\u30b3\u30f3\u306a\u306e\u3067\u3001\u4eca\u304b\u3089\u5b66\u7fd2\u3059\u308b\u4fa1\u5024\u306f\u4e4f\u3057\u3044\u3002\u8981\u671b\u304c\u3042\u308c\u3070\u96a3\u306e\u5e2d\u306e\u30cf\u30b2\u305f\u304a\u3063\u3055\u3093\u306b\u6295\u3052\u3066\u307b\u3057\u3044\u3002\n# Excel \u30b7\u30fc\u30c8\u3092 CSV \u3067\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3059\u308b VBScript\n\n```vbnet:xls2csv.vbs\nOption Explicit\n'--------------------------------------\n' Config\n'--------------------------------------\nconst SKIP_COUNT = 0 ' \u30d8\u30c3\u30c0\u884c\u51fa\u529b\u3059\u308b\n'const SKIP_COUNT = 1 ' \u30d8\u30c3\u30c0\u884c\u51fa\u529b\u3057\u306a\u3044\nconst FILE_FORMAT = 6 ' CSV (xlCSV)\n'const FILE_FORMAT = -4158 ' TSV (xlText/xlCurrentPlatformText)\nconst FILE_EXT = \".csv\"\n'const FILE_EXT = \".tsv\"\n\n'--------------------------------------\n' Globals\n'--------------------------------------\ndim wshShell\ndim winShell\ndim fso\ndim excel\nset wshShell = CreateObject(\"WScript.Shell\")\nset winShell = CreateObject(\"Shell.Application\")\nset fso = CreateObject(\"Scripting.FileSystemObject\")\nset excel = CreateObject(\"Excel.Application\")\nexcel.Visible = False\n\n'--------------------------------------\n' Functions\n'--------------------------------------\nsub XlsToCvs(xls, csvFolder)\n    dim book, sheet, fileName, table\n    dim i, c\n    set book = excel.WorkBooks.Open(xls,,True) ' Read Only\n    for each sheet in book.WorkSheets\n\n        if sheet.Range(\"A1\") = \"\" then\n            ' \u5de6\u4e0a\u7aef\u306e\u30bb\u30eb\u304b\u3089\u7a7a\u3060\u3063\u305f\u3089\u3001\u975e\u30c7\u30fc\u30bf\u7528\u30b7\u30fc\u30c8\u3068\u307f\u306a\u3057\u3066\u30b9\u30ad\u30c3\u30d7\u3059\u308b\n        else\n            fileName = csvFolder & \"\\\" & sheet.Name & FILE_EXT\n            'WScript.Echo(fileName)\n            ' \u30b7\u30fc\u30c8\u3092\u65b0\u898fbook\u306b\u30b3\u30d4\u30fc\u3059\u308b\n            sheet.Copy\n            ' \u30b3\u30d4\u30fc\u5148\u304cActiveWorkbook\u306b\u306a\u308b\n            with excel.ActiveWorkbook\n                .WorkSheets(1).EnableCalculation = False\n\n                ' \u5de6\u4e0a\u7aef\u304b\u3089\u7a7a\u884c\u7a7a\u5217\u3067\u56f2\u307e\u308c\u305f\u9818\u57df\u3092\u30c7\u30fc\u30bf\u7bc4\u56f2\u3068\u3059\u308b\n                set table = .WorkSheets(1).Range(\"A1\").CurrentRegion\n\n                'clearAround table           ' \u30c7\u30fc\u30bf\u7bc4\u56f2\u5916\u3092\u6d88\u53bb\n                removeGhostCells table      ' \u4f59\u5206\u306a\u7a7a\u767d\u884c\u30fb\u5217\u3092\u9664\u53bb\n                'keepLocalFormat table       ' \u8868\u793a\u66f8\u5f0f\u3092\u7dad\u6301\n                'keepConditionalFormat table ' \u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u3092\u7dad\u6301\n                'escapeSpecialChars table    ' \u7279\u6b8a\u6587\u5b57\u3092\u30a8\u30b9\u30b1\u30fc\u30d7\n                'fillEmptyCells table, \"\\N\"      ' \u7a7a\u767d\u30bb\u30eb\u306b\u5024\u3092\u8a2d\u5b9a\n\n                'toSqlLiterals table         ' SQL \u306e\u30ea\u30c6\u30e9\u30eb\u8868\u73fe\n\n                ' \u30d8\u30c3\u30c0\u884c\u3092SKIP_COUNT\u884c\u5206\u524a\u9664\n                if SKIP_COUNT > 0 then\n                    .WorkSheets(1).Cells.Rows(\"1:\" & SKIP_COUNT).EntireRow.Delete\n                end if\n\n                ' \u30d5\u30a1\u30a4\u30eb\u5f62\u5f0f\u3092\u6307\u5b9a\u3057\u3066\uff11\u30b7\u30fc\u30c8\u3092\u4fdd\u5b58\n                excel.DisplayAlerts = False\n                .SaveAs fileName, FILE_FORMAT\n                .Close\n                excel.DisplayAlerts = True\n            end with\n            'forceQuote(fileName)                ' \u5168\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u5f15\u7528\u7b26\u4ed8\u3051\n            'setLineTerminator fileName, vbLf    ' \u30ec\u30b3\u30fc\u30c9\u533a\u5207\u308a\u3092\u5909\u66f4\n            'convertToUTF8(fileName)             ' BOM\u306a\u3057UTF-8\u306b\u5909\u63db\n        end if\n    next\n    book.Close False \nend sub\n\nsub clearAround(rng)\n    dim data\n    data = rng.Value ' \u5024\u3092\u914d\u5217\u306b\u9000\u907f\n    rng.parent.Cells.ClearContents ' \u66f8\u5f0f\u3092\u6b8b\u3057\u3064\u3064\u5168\u30bb\u30eb\u6d88\u53bb\n    rng.Value = data\nend sub\n\nsub removeGhostCells(rng)\n    const xlCellTypeLastCell = 11\n    dim corner, margin, dr, dc\n    set corner = rng.cells(rng.Rows.Count, rng.Columns.Count)\n    set margin = rng.SpecialCells(xlCellTypeLastCell)\n    dr = margin.Row - corner.Row\n    dc = margin.Column - corner.Column\n    if 0 < dr then\n        corner.Offset(1,0).Resize(dr).EntireRow.Delete\n    end if\n    if 0 < dc then\n        corner.Offset(0,1).Resize(,dc).EntireColumn.Delete\n    end if\nend sub\n\nsub keepLocalFormat(rng)\n    dim col, c, numberCells\n    for each col in rng.Columns\n        set numberCells = collectNumberCells(col)\n        if not numberCells is Nothing then\n            set c = numberCells.Rows(1)\n            if c.NumberFormat <> \"General\" and c.NumberFormat <> c.NumberFormatLocal then\n                c.EntireColumn.NumberFormat = c.NumberFormatLocal\n            end if\n        end if\n    next\nend sub\n\nsub keepConditionalFormat(rng)\n    const xlExpression = 2\n    dim fc, addrs, c\n    addrs = \"\"\n    for each fc in rng.FormatConditions\n        ' if fc.NumberFormat <> \"\" then ' \u306a\u305c\u304b\u30a8\u30e9\u30fc\u306b\u306a\u308b\n            addrs = addrs & fc.AppliesTo.Address & \",\"\n        ' end if\n    next\n    if addrs = \"\" then exit sub\n    addrs = Left(addrs, Len(addrs)-1)\n    for each c in rng.Parent.Range(addrs)\n        c.Value = \"'\" & c.Text\n    next\nend sub\n\nsub escapeSpecialChars(rng)\n    excel.DisplayAlerts = False\n    rng.Replace vbLf, \"\\n\"\n    'rng.Replace vbCr, \"\\r\"\n    'rng.Replace vbTab, \"\\t\"\n    'rng.Replace \"\"\"\", \"\\x22\"\n    'rng.Replace \",\", \"\\x2C\"\n    excel.DisplayAlerts = True\nend sub\n\nsub fillEmptyCells(rng, val)\n    dim emptyCells\n    set emptyCells = collectEmptyCells(rng)\n    if not emptyCells is Nothing then\n        emptyCells.Value = val\n    end if\nend sub\n\nsub toSqlLiterals(rng)\n    dim col, c, emptyCells\n    for each col in rng.Columns\n        set c = col.Find(\"*\", col.Rows(1))\n        select case TypeName(c.Value)\n            case \"Date\"     col.NumberFormat = \"'yyyy-mm-dd hh:mm:ss'\"\n            case \"String\"   col.NumberFormat = \"'@'\"\n            case \"Currency\" col.NumberFormat = \"0.00\"\n        end select\n    next\n    set emptyCells = collectEmptyCells(rng)\n    if not emptyCells is Nothing then\n        emptyCells.NumberFormat = \"@\"\n        emptyCells.Value = \"NULL\"\n    end if\nend sub\n\nsub forceQuote(file)\n    const ForReading = 1, ForWriting = 2\n    dim csv, sep\n    if fso.GetExtensionName(file) = \"csv\" then\n        sep = \",\"\n    else\n        sep = \"\\t\"\n    end if\n    with fso.OpenTextFile(file, ForReading)\n        csv = .ReadAll\n        .Close\n    end with\n    with new RegExp\n        .Pattern = \"(\"\"?)((\"\"\"\"|\\n|.)*?)\\1(\" & sep & \"|\\r\\n|$)\"\n        .Global = True\n        csv = .Replace(csv, \"\"\"$2\"\"$4\")\n        csv = Left(csv, Len(csv) -2)    ' \u30b4\u30df\u3068\u308a\n    end with\n    with fso.OpenTextFile(file, ForWriting)\n        .Write(csv)\n        .Close\n    end with\nend sub\n\nsub setLineTerminator(file, eol)\n    const ForReading = 1, ForWriting = 2\n    dim csv\n    with fso.OpenTextFile(file, ForReading)\n        csv = .ReadAll\n        .Close\n    end with\n    with fso.OpenTextFile(file, ForWriting)\n        .Write(Replace(csv, vbCrLf, eol))\n        .Close\n    end with\nend sub\n\nsub convertToUtf8(file)\n    dim ps\n    ps = \"powershell -c \"\"&{[IO.File]::WriteAllLines($args[0], $(gc $args[0]))}\"\"\" ' PowerShell 2.0\u4ee5\u4e0a\n    'ps = \"powershell -c \"\"&{[IO.File]::WriteAllText($args[0], $(gc $args[0] -RAW))}\"\"\" ' PowerShell3.0\u4ee5\u4e0a\n    wshShell.run ps & \" \"\"\" & file & \"\"\"\", 0\nend sub\n\nfunction collectEmptyCells(rng)\n    const xlCellTypeBlanks = 4\n    set collectEmptyCells = Nothing\non error resume next\n    set collectEmptyCells = rng.SpecialCells(xlCellTypeBlanks)\non error goto 0\nend function\n\nfunction collectNumberCells(rng)\n    const xlCellTypeConstants = 2, xlNumbers = 1\n    set collectNumberCells = Nothing\non error resume next\n    set collectNumberCells = rng.SpecialCells(xlCellTypeConstants, xlNumbers)\non error goto 0\nend function\n\n'--------------------------------------\n' Main\n'--------------------------------------\nsub Main()\n    dim file, ext, folder\n    if WScript.Arguments.Count = 0 then\n        WScript.Echo(\"Excel\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\")\n        exit sub\n    end if\n    for each file in WScript.Arguments\n        file = fso.GetAbsolutePathName(file)\n        if not fso.FileExists(file) then \n            WScript.Echo(file & \"\u304c\u3042\u308a\u307e\u305b\u3093\")\n            exit sub\n        end if\n\n        ext = fso.GetExtensionName(file)\n        if ext <> \"xls\" and ext <> \"xlsx\" then\n            WScript.Echo(file & \"\u306fExcel\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u3042\u308a\u307e\u305b\u3093\")\n            exit sub\n        end if\n\n        folder = wshShell.SpecialFolders(\"Desktop\") & \"\\\" & fso.GetBaseName(file) ' \u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306b\u4fdd\u5b58\n        'folder = fso.GetParentFolderName(file) & \"\\\" & fso.GetBaseName(file) ' xls\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u5834\u6240\u306b\u4fdd\u5b58\n        'folder = wshShell.CurrentDirectory & \"\\\" & fso.GetBaseName(file) ' \u30ab\u30ec\u30f3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4fdd\u5b58\uff08\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u5c02\u7528\uff09\n        if fso.FileExists(folder) then \n            WScript.Echo(folder & \"\u30d5\u30a9\u30eb\u30c0\u30fc\u304c\u4f5c\u6210\u3067\u304d\u307e\u305b\u3093\")\n            exit sub\n        elseif not fso.FolderExists(folder) then\n            fso.CreateFolder(folder)\n        end if\n\n        ' \u5909\u63db\u5b9f\u884c\n        XlsToCvs file, folder\n\n        'winShell.Explore folder ' CSV\u3092\u4fdd\u5b58\u3057\u305f\u30d5\u30a9\u30eb\u30c0\u3092 Explorer \u3067\u958b\u304f\n    next\n    WScript.Echo(\"\u5b8c\u4e86\u3057\u307e\u3057\u305f\")\nend sub\n\n\nMain\n\nexcel.Quit\nset excel = Nothing\nWScript.Quit\n```\n\n# \u4f7f\u3044\u65b9\n\n\u4e0a\u8a18\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u4efb\u610f\u306e\u30d5\u30a1\u30a4\u30eb\u540d\u3067\u4fdd\u5b58\u3057\u3001\u62e1\u5f35\u5b50\u3092'.vbs'\u3068\u3059\u308b\u3002\u6587\u5b57\u30b3\u30fc\u30c9\u306f Shift_JIS \u306b\u3059\u308b\u3053\u3068\u3002UTF-8 \u3060\u3068\u65e5\u672c\u8a9e\u3067\u30a8\u30e9\u30fc\u306b\u306a\u308b\u3002\n\n\u305d\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u30a2\u30a4\u30b3\u30f3\u3078 Excel \u30d5\u30a1\u30a4\u30eb(.xls/.xslx)\u3092\u304a\u3082\u3080\u308d\u306b\u30c9\u30e9\u30c3\u30af\uff06\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3068\u3001\u540c\u540d\u306e\u30d5\u30a9\u30eb\u30c0\u304c\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u306b\u4f5c\u6210\u3055\u308c\u3001\u914d\u4e0b\u306b\u5404\u30b7\u30fc\u30c8\u304cCSV\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3055\u308c\u308b\u3002Excel\u30d5\u30a1\u30a4\u30eb\u306f\u8907\u6570\u307e\u3068\u3081\u3066\u6e21\u3057\u3066\u3082\u3088\u3044\u3002\n\n\u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u304b\u3089\u5b9f\u884c\u3059\u308b\u306b\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b cscript.exe \u3092\u4f7f\u3046\u304c\u3001\u5f15\u6570\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306f\u52b9\u304b\u306a\u3044\u306e\u3067\u60aa\u3057\u304b\u3089\u305a\u3002\n\n```dos\nC:\\work>cscript xls2csv.vbs Book1.xlsx\nMicrosoft (R) Windows Script Host Version 5.812\nCopyright (C) Microsoft Corporation. All rights reserved.\n\n\u5b8c\u4e86\u3057\u307e\u3057\u305f\n```\nWindows 10 / Excel 2013 \u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\u3002\n\n\u3082\u3068\u306f Excel \u306e CSV \u4fdd\u5b58\u64cd\u4f5c\u3092\u81ea\u52d5\u5316\u3057\u305f\u3060\u3051\u306e\u5358\u7d14\u306a\u30b9\u30af\u30ea\u30d7\u30c8\u3060\u3063\u305f\u304c\u5e74\u5b63\u304c\u5165\u3063\u3066\u3044\u3066\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u3044\u308f\u3086\u308b Excel CSV \u5f62\u5f0f\u306b\u52a0\u3048\u3044\u308d\u3044\u308d\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002\u30b3\u30e1\u30f3\u30c8\u3092\u5916\u3059\u3060\u3051\u306a\u306e\u3067\u3001\u30bd\u30fc\u30b9\u3068\u30b3\u30e1\u30f3\u30c8\u3092\u773a\u3081\u308c\u3070\u3060\u3044\u305f\u3044\u308f\u304b\u308b\u3068\u601d\u3046\u3002\u9069\u5b9c\u3001\u7528\u9014\u306b\u5fdc\u3058\u3066\u53d6\u6368\u3057\u3066\u307b\u3057\u3044\u3002\n\n\u3042\u304f\u307e\u3067\u6280\u8853\u8005\u5411\u3051\u306e\u516c\u958b\u306a\u306e\u3067\u3001\u500b\u4eba\u306e\u8cac\u4efb\u7bc4\u56f2\u3067\u4f7f\u7528\u3057\u3066\u307b\u3057\u3044\u3002\u307e\u305f\u3053\u308c\u3092\u4e00\u822c\u306e\u4eba\u304c\u4f7f\u3046\u306e\u306f\u3044\u308d\u3044\u308d\u554f\u984c\u304c\u3042\u3063\u3066\u3088\u308d\u3057\u304f\u306a\u3044\u3002\n\n\u4f8b\u3048\u3070\u3001\u30a8\u30e9\u30fc\u51e6\u7406\u306e\u624b\u629c\u304d\u306b\u3088\u308a\u7570\u5e38\u7d42\u4e86\u5f8c\u306b\u6b8b\u3063\u3066\u3057\u307e\u3046 Excel \u30d7\u30ed\u30bb\u30b9\u306f\u81ea\u5206\u3067\u5bfe\u51e6\u3067\u304d\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\u307e\u305f\u3001WSH/VBScript \u306f\u53e4\u3044\u6280\u8853\u3067\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30fc\u4e0a\u306e\u554f\u984c\u304c\u3042\u308b\u3068\u3044\u3046\u306e\u306b\u3001\u5185\u5bb9\u3092\u78ba\u8a8d\u3067\u304d\u306a\u3044\u4e00\u822c\u306e\u4eba\u304cvbs\u30d5\u30a1\u30a4\u30eb\u306e\u5b9f\u884c\u306b\u5bfe\u3057\u3066\u8b66\u6212\u5fc3\u3092\u4e0b\u3052\u308b\u3088\u3046\u306a\u6a5f\u4f1a\u3092\u4eca\u66f4\u5897\u3084\u3057\u3066\u3057\u305f\u304f\u306f\u306a\u3044\u3002\n\n# \u89e3\u8aac\u3068\u3044\u3046\u304b\u30dc\u30e4\u30ad\n\n\u3082\u3068\u306f\uff11\uff10\u5e74\u3050\u3089\u3044\u524d\u306b\u66f8\u3044\u305f\u30b9\u30af\u30ea\u30d7\u30c8\u306a\u306e\u3060\u3051\u3069\u3001\u4eca\u3067\u3082\u52d5\u304b\u305b\u308b\u3053\u3068\u306b\u3061\u3087\u3063\u3068\u3073\u3063\u304f\u308a\u3002\u9006\u306b\u3001Excel \u304c\u76f8\u5909\u308f\u3089\u305a\u30af\u30bd\u3067\u5f53\u6642\u304b\u3089\u4e00\u3064\u3082\u9032\u6b69\u3057\u3066\u3044\u306a\u3044\u3053\u3068\u306b\u3082\u3055\u3089\u306b\u3073\u3063\u304f\u308a\u3002\u305d\u308c\u304c\u30d0\u30b0\u3068\u304b\u8a2d\u8a08\u4e0a\u306e\u3057\u304c\u3089\u307f\u3068\u304b\u3067\u306f\u306a\u304f\u3001\u5358\u306a\u308b\u610f\u56f3\u7684\u306a\u30a4\u30e4\u304c\u3089\u305b\u3060\u3063\u305f\u3053\u3068\u306f\u3001\u3042\u3042\u3001\u4eca\u306a\u3089\u5206\u304b\u308b\u3088\u3002\n\n##### **\u30c7\u30fc\u30bf\u7bc4\u56f2\u5916\u3092\u6d88\u53bb**\n\n\u30b7\u30fc\u30c8\u306e\u30c7\u30fc\u30bf\u7bc4\u56f2\u5916\u306e\u30bb\u30eb\u304c\u4f7f\u308f\u308c\u3066\u3044\u3066\u3001CSV\u306b\u3054\u307f\u30c7\u30fc\u30bf\u3068\u306a\u3063\u3066\u51fa\u529b\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u306f\u308b\u306e\u306f\u666e\u901a\u306b\u3042\u308b\u3002\n\n\u5358\u4f53\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u3092\u4f5c\u3063\u3066\u3044\u308b\u3068\u304d\u306a\u3069\u3001\u5b9a\u6570\u3084\u30c7\u30fc\u30bf\u884c\u306b\u5bfe\u3059\u308b\u30e1\u30e2\uff08\u691c\u8a3c\u5185\u5bb9\u3084\u9805\u756a\u306a\u3069\uff09\u3092\u7f6e\u3044\u3066\u304a\u3051\u308b\u3068\u610f\u5916\u3068\u4fbf\u5229\u3060\u3063\u305f\u308a\u3059\u308b\u3002\n\n`clearAround()` \u306f\u6307\u5b9a\u306e\u30bb\u30eb\u7bc4\u56f2\u306e\u5916\u90e8\u306b\u3042\u308b\u3059\u3079\u3066\u306e\u30bb\u30eb\u306e\u5024\u3092\u6d88\u53bb\u3059\u308b\u3002\u6570\u5f0f\u306f\u5024\u306b\u7f6e\u304d\u63db\u308f\u308b\u306e\u3067\u3001\u6d88\u53bb\u3055\u308c\u308b\u30bb\u30eb\u3078\u306e\u53c2\u7167\u304c\u3042\u3063\u3066\u3082\u5024\u306f\u58ca\u308c\u306a\u3044\u3002\n\n**\u4f59\u5206\u306a\u7a7a\u767d\u884c\u30fb\u5217\u3092\u9664\u53bb**\n\n\u3069\u3046\u3044\u3046\u308f\u3051\u304b\u3001\u30c7\u30fc\u30bf\u306e\u306a\u3044\u306f\u305a\u306e\u4f59\u5206\u306a\u7a7a\u884c\u3084\u7a7a\u5217\u304cCSV\u51fa\u529b\u306b\u8ffd\u52a0\u3055\u308c\u308b\u3053\u3068\u304c\u3042\u308b\u3002\u898b\u304b\u3051\u304c\u7a7a\u3067\u3082Excel\u306b\u306f\u8996\u3048\u308b\u5e7d\u970a\u30bb\u30eb\u304c\u3042\u308b\u3089\u3057\u304f\u3001\u3053\u3046\u306a\u308b\u3068\u305d\u308c\u304c\u3044\u305d\u3046\u306a\u5f8c\u308d\u306e\u884c\u3084\u5217\u306e\u8fba\u308a\u3092\u4e38\u3054\u3068\u524a\u9664\u3059\u308b\u3057\u304b\u306a\u3044\u3002\n\n`removeGhoistCells()` \u306f\u305d\u306e\u4f5c\u696d\u3092\u81ea\u52d5\u3067\u884c\u3046\u3002\n\n\n##### **\u8868\u793a\u66f8\u5f0f\u3092\u7dad\u6301**\n\n\u3069\u3046\u3044\u3046\u308f\u3051\u304b\u3001CSV \u306b\u51fa\u529b\u3057\u305f\u3068\u304d\u306b\u3001\u5024\u306e\u8868\u793a\u66f8\u5f0f\u304b\u52dd\u624b\u306b\u5909\u3048\u3089\u308c\u3066\u3057\u307e\u3046\u3053\u3068\u304c\u3042\u308b\u3002\u65e5\u4ed8\u3001\u6642\u523b\u3001\u901a\u8ca8\u306a\u3069\u304c\u5f71\u97ff\u3092\u53d7\u3051\u308b\u3088\u3046\u3060\u304c\u3001\u7279\u306b\u65e5\u4ed8\u304c\u7c73\u56fd\u5f0f\u306b\u306a\u3063\u3066\u3057\u307e\u3046\u306e\u306f\u8179\u7acb\u305f\u3057\u3044\u3002\n\nExcel \u306f\u30bb\u30eb\u306e\u66f8\u5f0f\uff08\u8868\u793a\u5f62\u5f0f\uff09\u3092\u3001\u7c73\u56fd\u306b\u5408\u308f\u305b\u305f\u57fa\u672c\u66f8\u5f0f\u3068\u30ed\u30b1\u30fc\u30eb\u4f9d\u5b58\u306e\u5730\u57df\u66f8\u5f0f\u306e\uff12\u91cd\u3067\u6301\u3063\u3066\u3044\u3066\u3001\u4e21\u8005\u306b\u9055\u3044\u304c\u3042\u308b\u5834\u5408\u3001CSV\u51fa\u529b\u3067\u306f\u30ed\u30b1\u30fc\u30eb\u306b\u4f9d\u5b58\u3057\u306a\u3044\u57fa\u672c\u66f8\u5f0f\uff08\u7c73\u56fd\u66f8\u5f0f\uff09\u304c\u512a\u5148\u3055\u308c\u308b\u3002Excel \u306e\u300c\u30bb\u30eb\u306e\u8868\u793a\u8a2d\u5b9a\u300d\uff1e\uff5b\u8868\u793a\u5f62\u5f0f\u300d\u753b\u9762\u3067\u5148\u982d\u306b\u30a2\u30b9\u30bf\u30ea\u30b9\u30af(*)\u304c\u3064\u3044\u3066\u3044\u308b\u66f8\u5f0f\u304c\u305d\u308c\u3089\u3057\u3044\u3002\n\n`keepLocalFormat()`\u306f\u5730\u57df\u66f8\u5f0f\u3067\u57fa\u672c\u66f8\u5f0f\u3092\u4e0a\u66f8\u304d\u3059\u308b\u3002\n\n##### **\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u3092\u7dad\u6301**\n\n\u3069\u3046\u3044\u3046\u308f\u3051\u304b\u3001\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u306f CSV \u51fa\u529b\u306b\u9069\u7528\u3055\u308c\u306a\u3044\u3002\n\n\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u306a\u3093\u3066\u4f7f\u3063\u305f\u3053\u3068\u3042\u308b\u3060\u308d\u3046\u304b\u3002\u307e\u3042\u3001\u30c7\u30fc\u30bf\u7528\u306e\u30b7\u30fc\u30c8\u306b\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u304c\u4f7f\u308f\u308c\u308b\u3053\u3068\u306f\u306a\u3044\u3060\u308d\u3046\u3057\u3001AVIVA\u3078\u3067\u3082\u884c\u304b\u306a\u3044\u9650\u308a\u307b\u3068\u3093\u3069\u306e\u6280\u8853\u8005\u306b\u306f\u7121\u7e01\u306a\u8a71\u3060\u3002\n\n`keepConditionalFormat()`\u306f\u3001\u30bb\u30eb\u306b\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u304c\u3042\u308c\u3070\u73fe\u5728\u306e\u8868\u793a\u6587\u5b57\u5217\u3092\u30bb\u30eb\u5024\u306b\u8a2d\u5b9a\u3059\u308b\u3002\u305f\u3060\u3057\u30eb\u30fc\u30d7\u3067\u5404\u30bb\u30eb\u3092\u66f4\u65b0\u3059\u308b\u306e\u3067\u91cd\u3044\u51e6\u7406\u306b\u306a\u308b\u3002\n\n##### **\u7279\u6b8a\u6587\u5b57\u3092\u30a8\u30b9\u30b1\u30fc\u30d7**\n\nExcel \u306e\u30bb\u30eb\u5185\u6539\u884c\u306f CSV \u51fa\u529b\u3067\u306f LF \u3068\u3057\u3066\u51fa\u529b\u3055\u308c\u308b\u3002\u30ec\u30b3\u30fc\u30c9\u3092\uff11\u884c\u306b\u7d0d\u3081\u305f\u3044\u5834\u5408 LF \u3092\u30a8\u30b9\u30b1\u30fc\u30d7\u3057\u3066\u304a\u304d\u305f\u3044\u3002\n\nescapeSpecialChars() \u306f\u30bb\u30eb\u6587\u5b57\u5217\u306e LF \u3092\"\u00a5n\"\u306b\u7f6e\u63db\u3059\u308b\u3002\u305f\u3060\u306e\u6587\u5b57\u5217\u7f6e\u63db\u306a\u306e\u3067\u3001\u5fc5\u8981\u306a\u3089\u305d\u308c\u4ee5\u5916\u306e\u30d1\u30bf\u30fc\u30f3\u3082\u8ffd\u52a0\u3067\u304d\u308b\u3002\n##### **\u7a7a\u30bb\u30eb\u306b\u5024\u3092\u8a2d\u5b9a**\n\n\u30bb\u30eb\u306b\u5024\u304c\u5165\u3063\u3066\u3044\u306a\u3044\u3068\u3001CSV\u51fa\u529b\u3067\u306f\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u7a7a\u306b\u306a\u308b\u3002\u53d6\u308a\u8fbc\u307f\u5074\u306e\u4ed5\u69d8\u306b\u3088\u3063\u3066\u306f\u3001NULL\u3084\\N\u306a\u3069\u7a7a\u5024\u3092\u793a\u3059\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u308c\u305f\u3044\u3002\n\n`fillEmptyCells()`\u306f\u5168\u3066\u306e\u7a7a\u30bb\u30eb\u306b\u6307\u5b9a\u306e\u5024\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3002\n\n\u7a7a\u3068NULL\u3092\u533a\u5225\u3057\u305f\u3044\u3053\u3068\u3082\u3042\u308b\u3002\u7a7a\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u307e\u307e\u306b\u3057\u3066\u304a\u304d\u305f\u3044\u30bb\u30eb\u306b\u306f\u3001\u3042\u3089\u304b\u3058\u3081\u30b7\u30f3\u30b0\u30eb\u30af\u30aa\u30fc\u30c8(')\u306e\u307f\u3092\u5165\u529b\u3057\u3066\u304a\u3051\u3070\u3044\u3044\u3002\u30b7\u30f3\u30b0\u30eb\u30af\u30aa\u30fc\u30c8\u306e\u307f\u306e\u30bb\u30eb\u306f\u7a7a\u6587\u5b57\u5217\u3092\u5024\u3068\u3057\u3066\u3082\u3064\u30bb\u30eb\u3067\u3042\u308a\u3001\u7a7a\u30bb\u30eb\u3068\u306f\u5224\u5b9a\u3055\u308c\u306a\u304f\u306a\u308b\u306e\u3067\u7a7a\u5024\u306e\u8a2d\u5b9a\u5bfe\u8c61\u3068\u306f\u306a\u3089\u306a\u3044\u304c\u3001CSV\u51fa\u529b\u3067\u306f\u5024\u306e\u306a\u3044\u7a7a\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u306a\u308b\u3002\u3082\u3046\u3001\u81ea\u5206\u3067\u3082\u4f55\u3092\u8a00\u3063\u3066\u3044\u308b\u306e\u304b\u308f\u304b\u3089\u306a\u3044\u3002\n\n\n##### **SQL \u306e\u30ea\u30c6\u30e9\u30eb\u8868\u73fe**\n\n\u3044\u3063\u305d\u3001INSERT \u6587\u3092\u751f\u6210\u3055\u305b\u305f\u304f\u306a\u308b\u306e\u3082\u7121\u7406\u306f\u306a\u3044\u3002\n\n`toSqlLiterals()`\u306f\u305d\u308c\u7528\u306e\u3064\u3082\u308a\u3060\u3063\u305f\u304c\u3001\u307e\u3060\u3084\u308a\u304b\u3051\u306e\u3088\u3046\u3060\u3002\u4e2d\u9014\u534a\u7aef\u306a\u306e\u3067\u3042\u3066\u306b\u3057\u306a\u3044\u3067\u307b\u3057\u3044\u3002\u3082\u3046\u5c11\u3057\u4f55\u3068\u304b\u3067\u304d\u305f\u306f\u305a\u306a\u306e\u3060\u304c\u3001\u4eca\u66f4\u3084\u308b\u6c17\u3082\u8d77\u304d\u306a\u3044\u3002\n\n##### **\u5168\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u5f15\u7528\u7b26\u4ed8\u3051**\n\nExcel CSV \u306f\u57fa\u672c\u7684\u306b\u5404\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u30af\u30aa\u30fc\u30c8\u306a\u3057\u3067\u51fa\u529b\u3059\u308b\u3002\u305f\u3060\u3057\u3001\u5024\u306b\u6539\u884c\u3001\u30ab\u30f3\u30de(,)\u3001\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8(\")\u306a\u3069\u304c\u542b\u307e\u308c\u308b\u5834\u5408\u306b\u3001\u305d\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u56f2\u307e\u308c\u308b\u3002\n\n\u3069\u3046\u305b\u306a\u3089\u5168\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u3067\u56f2\u3093\u3067\u3082\u3089\u3063\u305f\u65b9\u304c\u53d6\u308a\u8fbc\u307f\u5074\u306e\u51e6\u7406\u304c\u697d\u306b\u306a\u308b\u3002\n\n`forceQuote()` \u306f\u5168\u3066\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30c0\u30d6\u30eb\u30af\u30aa\u30fc\u30c8\u56f2\u307f\u3092\u8ffd\u52a0\u3059\u308b\u3002\n\n\n##### **\u30ec\u30b3\u30fc\u30c9\u533a\u5207\u308a\u3092\u5909\u66f4**\n\n\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ec\u30b3\u30fc\u30c9\u533a\u5207\u306f\u6539\u884c\u30b3\u30fc\u30c9(CRLF)\u3002\n\n`setLineTerminator()` \u306f CRLF \u3092\u4efb\u610f\u306e\u6587\u5b57\u5217\u3067\u7f6e\u63db\u3059\u308b\u3002\u30bb\u30eb\u5185\u6539\u884c\uff08LF\uff09\u306f\u7f6e\u63db\u3055\u308c\u306a\u3044\u3002\n\n##### **BOM\u306a\u3057UTF-8\u306b\u5909\u63db**\n\n\u3069\u3046\u3044\u3046\u308f\u3051\u304b\u3001Excel \u3084 WSH \u306f UTF-8 \u51fa\u529b\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u306a\u3044\u3002Windows \u754c\u9688\u3067\u3044\u3046\u30e6\u30cb\u30b3\u30fc\u30c9\u30b5\u30dd\u30fc\u30c8\u3068\u306fUTF16(LE)\u306e\u3053\u3068\u3060\u3063\u305f\u308a\u3059\u308b\u3002 \n\nPowerShell \u304c\u51fa\u3066\u3084\u3063\u3068 UTF-8 \u304c\u4f7f\u3048\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002\n\n\u3057\u304b\u3057\u305d\u308c\u306f\u3001\u672c\u5f53\u306b\u8179\u7acb\u305f\u3057\u3044\u3053\u3068\u3060\u304c\u3001\u305d\u308c\u306f **BOM \u4ed8\u304d UTF-8** \u3068\u3044\u3046\u3001\u672c\u5f53\u306b\u610f\u5473\u306e\u5206\u304b\u3089\u306a\u3044\u3001\u672c\u5f53\u306b\u30d8\u30f3\u306a\u3001\u4f59\u8a08\u306a\u3001\u3053\u306e\u3001\u672c\u5f53\u306b\u3001\u30af\u30d3\u3092\u7d5e\u3081\u3066\u3084\uff52\uff59\n\n`convertToUtf8()`\u306f\u3001Shift_JIS \u3092 BOM \u306a\u3057\u306e UTF-8 \u306b\u5909\u63db\u3059\u308b\u3002WSH \u304b\u3089PowerShell \u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8d77\u52d5\u3057\u3066\u5b9f\u73fe\u3057\u3066\u3044\u308b\u306e\u306f\u8ca0\u3051\u3060\u3002\n\n\u6539\u884c\u30b3\u30fc\u30c9\u304c\u5168\u3066\uff08\u30bb\u30eb\u5185\u6539\u884c\u3082\u542b\u3081\u3066\uff09 CRLF \u306b\u66f8\u304d\u623b\u3055\u308c\u3066\u3057\u307e\u3046\u306e\u3067\u6ce8\u610f\u3002\u305d\u308c\u306f\u56f0\u308b\u3053\u3068\u3067\u3082\u306a\u3044\u304c\u3001\u56f0\u308b\u3068\u3044\u3046\u5834\u5408\u3001 PowerShell 3.0 \u4ee5\u4e0a\u306e\u74b0\u5883\u3067\u3042\u308c\u3070\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3055\u308c\u3066\u3044\u308b\uff12\u3064\u3081\u306e PowerShell \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u5bfe\u5fdc\u3067\u304d\u305d\u3046\u306a\u611f\u3058\u306a\u306e\u3067\u8a66\u3057\u3066\u307b\u3057\u3044\u3002\n\n# WSH/VBScript \u306b\u3064\u3044\u3066\n\n\u4ee5\u4e0b\u306b\u8a73\u3057\u3044\u3002\n\n[\u30ec\u30ac\u30b7\u30fc\u74b0\u5883\u306e\u305f\u3081\u306eWindows Script Host(WSH)\u306e\u89e3\u8aac](http://qiita.com/mima_ita/items/127e171db67aaee6ef30) - Qiita\n\nWSH/VBScript \u306f\u30aa\u30ef\u30b3\u30f3\u306a\u306e\u3067\u3001\u4eca\u304b\u3089\u5b66\u7fd2\u3059\u308b\u4fa1\u5024\u306f\u4e4f\u3057\u3044\u3002\u8981\u671b\u304c\u3042\u308c\u3070\u96a3\u306e\u5e2d\u306e\u30cf\u30b2\u305f\u304a\u3063\u3055\u3093\u306b\u6295\u3052\u3066\u307b\u3057\u3044\u3002\n", "tags": ["Excel", "CSV", "VBScript", "WSH"]}