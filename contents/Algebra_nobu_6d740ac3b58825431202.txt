{"context": "\n\n\u3010\u74b0\u5883\u3011\n\u3000windows8.1\n\u3000Excel 2013\n\u3000ruby 2.3.0\n\u3000gem 2.5.1\n\n\u3010\u6982\u8981\u3011\n\u3000\u4f50\u3005\u6728\u5e0c\u306e\u5199\u771f\u304b\u3089\u8272\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u3001Excel\u306e\u30bb\u30eb\u306b\u5857\u308a\u3064\u3076\u3057\u307e\u3059\u3002\n\n\u3010\u30d5\u30a9\u30eb\u30c0\u69cb\u6210\u3011\n|---sasaki_excel\n\u3000\u3000\u3000\u3000|---sasaki_excel.rb\n\u3000\u3000\u3000\u3000|---sasaki.jpg\uff08\u4f50\u3005\u6728\u5e0c\u306e\u753b\u50cf\uff09\n\u3053\u3061\u3089\u306e\u753b\u50cf\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n\n\n\u3010\u30d7\u30ed\u30b0\u30e9\u30e0\u3011\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u753b\u50cf\u30b5\u30a4\u30ba\u3067\u306f\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u884c\u6642\u9593\u304c\u3068\u3093\u3067\u3082\u306a\u304f\u9577\u304b\u3063\u305f\u305f\u3081\u3001\n\u3000\u753b\u50cf\u306e\u30b5\u30a4\u30ba\u3092\u30b3\u30fc\u30c9\u5185\u3067\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\n\u3000Ruby\u3082Python\u3068\u6bd4\u3079\u3066\u30b3\u30fc\u30c9\u304c\u77ed\u304f\u7406\u89e3\u3057\u3084\u3059\u3044\u306e\u304cgood!!\n\nsasaki_excel.rb\nrequire 'rubyXL'\nrequire 'chunky_png'\n\nimage = ChunkyPNG::Image.from_file('sasaki.png')\n# \u30d4\u30af\u30bb\u30eb\u5024\u5909\u66f4\nimage = image.resample_bilinear!(100, 100)\n\n# Excel\u4f5c\u6210 & \u30b7\u30fc\u30c8\u9078\u629e\nwb = RubyXL::Workbook.new\nws = wb[0]\n\npul_wh = 0\n\nfor w in 0..99 do\n  for h in 0..99 do\n    # RGB\u30ab\u30e9\u30fc\u309216\u9032\u6570\u3078\u5909\u63db\n    hex_color = ChunkyPNG::Color.to_hex(image.pixels[pul_wh])[1,6]\n    ws.add_cell(w, h, '')\n    # \u5857\u308a\u3064\u3076\u3057\n    ws.sheet_data[w][h].change_fill(hex_color)\n    # \u884c\u3001\u5217\u306e\u5e45\u5909\u66f4\n    ws.change_column_width(w, 0.01)\n    ws.change_row_height(h, 5)\n    pul_wh += 1\n  end\nend\n\nwb.write(\"sasaki_nozomi.xlsx\")\n\n\n\n\u3010\u7d50\u679c\u3011\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3053\u3093\u306a\u611f\u3058\n\u3000\n\u3000\u624b\u3067\u8868\u793a\u500d\u7387\u3092\u5909\u66f4\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\n\u3000\n\n\u3010\u53c2\u8003\u30b5\u30a4\u30c8\u3011\n\u3000rubyXL-github\n\u3000chunky_png\n\n\u3010\u4ed6\u8a00\u8a9e\u7248\u3011\n\u3000Python\u7248\u306f\u3053\u3061\u3089\n\u3000Node.js\u7248\u306f\u3053\u3061\u3089\n#\u3010\u74b0\u5883\u3011\n\u3000windows8.1\n\u3000Excel 2013\n\u3000ruby 2.3.0\n\u3000gem 2.5.1\n\n#\u3010\u6982\u8981\u3011\n\u3000\u4f50\u3005\u6728\u5e0c\u306e\u5199\u771f\u304b\u3089\u8272\u306e\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u3001Excel\u306e\u30bb\u30eb\u306b\u5857\u308a\u3064\u3076\u3057\u307e\u3059\u3002\n\n#\u3010\u30d5\u30a9\u30eb\u30c0\u69cb\u6210\u3011\n|---sasaki_excel\n\u3000\u3000\u3000\u3000|---sasaki_excel.rb\n\u3000\u3000\u3000\u3000|---sasaki.jpg\uff08\u4f50\u3005\u6728\u5e0c\u306e\u753b\u50cf\uff09\n\n\u3053\u3061\u3089\u306e\u753b\u50cf\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n![sasaki.png](https://qiita-image-store.s3.amazonaws.com/0/121997/0c3d8f11-522d-b3f8-5bb3-a60f142d2f9e.png)\n\n#\u3010\u30d7\u30ed\u30b0\u30e9\u30e0\u3011\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u753b\u50cf\u30b5\u30a4\u30ba\u3067\u306f\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u5b9f\u884c\u6642\u9593\u304c\u3068\u3093\u3067\u3082\u306a\u304f\u9577\u304b\u3063\u305f\u305f\u3081\u3001\n\u3000\u753b\u50cf\u306e\u30b5\u30a4\u30ba\u3092\u30b3\u30fc\u30c9\u5185\u3067\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\n\u3000Ruby\u3082Python\u3068\u6bd4\u3079\u3066\u30b3\u30fc\u30c9\u304c\u77ed\u304f\u7406\u89e3\u3057\u3084\u3059\u3044\u306e\u304cgood!!\n\n```rb:sasaki_excel.rb\nrequire 'rubyXL'\nrequire 'chunky_png'\n\nimage = ChunkyPNG::Image.from_file('sasaki.png')\n# \u30d4\u30af\u30bb\u30eb\u5024\u5909\u66f4\nimage = image.resample_bilinear!(100, 100)\n\n# Excel\u4f5c\u6210 & \u30b7\u30fc\u30c8\u9078\u629e\nwb = RubyXL::Workbook.new\nws = wb[0]\n\npul_wh = 0\n\nfor w in 0..99 do\n  for h in 0..99 do\n    # RGB\u30ab\u30e9\u30fc\u309216\u9032\u6570\u3078\u5909\u63db\n    hex_color = ChunkyPNG::Color.to_hex(image.pixels[pul_wh])[1,6]\n    ws.add_cell(w, h, '')\n    # \u5857\u308a\u3064\u3076\u3057\n    ws.sheet_data[w][h].change_fill(hex_color)\n    # \u884c\u3001\u5217\u306e\u5e45\u5909\u66f4\n    ws.change_column_width(w, 0.01)\n    ws.change_row_height(h, 5)\n    pul_wh += 1\n  end\nend\n\nwb.write(\"sasaki_nozomi.xlsx\")\n```\n\n#\u3010\u7d50\u679c\u3011\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3053\u3093\u306a\u611f\u3058\n\u3000<img width=\"514\" alt=\"default.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/121997/f9fbc24f-659c-ce01-45fe-fd55d401e653.png\">\n\n\u3000\u624b\u3067\u8868\u793a\u500d\u7387\u3092\u5909\u66f4\u3059\u308b\u3068\u3053\u3093\u306a\u611f\u3058\n\u3000<img width=\"224\" alt=\"after.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/121997/7cb9c6e7-a692-d6e8-3e62-0069a0456c40.png\">\n\n#\u3010\u53c2\u8003\u30b5\u30a4\u30c8\u3011\n\u3000[rubyXL-github](https://github.com/weshatheleopard/rubyXL)\n\u3000[chunky_png](http://www.rubydoc.info/gems/chunky_png/toplevel)\n\n#\u3010\u4ed6\u8a00\u8a9e\u7248\u3011\n\u3000[Python\u7248\u306f\u3053\u3061\u3089](http://qiita.com/Algebra_nobu/items/4e2b36bdb38434e183de)\n\u3000[Node.js\u7248\u306f\u3053\u3061\u3089](http://qiita.com/Algebra_nobu/items/33781129460eb0338b1b)\n", "tags": ["Ruby", "Windows", "Windows8.1", "Excel"]}