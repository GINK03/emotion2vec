{"context": " More than 1 year has passed since last update.\u67d0\u5fa1\u65b9\u304b\u3089 Edison-fluentd-elasticsearch-kibana \u3068\u3044\u3046\u96fb\u6ce2\u3092\u53d7\u4fe1\u3057\u305f\u306e\u3067\u3001vagrant + chef \u3067\u304a\u305f\u3081\u3057\u74b0\u5883\u69cb\u7bc9\u3057\u3066\u307f\u308b\uff0e\n\u30db\u30b9\u30c8\u540d\u306f\u3068\u308a\u3042\u3048\u305a fluentd \u3067\u3044\u304f\uff0e\n\u30ea\u30dd\u30b8\u30c8\u30ea\nhttps://github.com/tac0x2a/vagrant_chef_fluent-ui\n\nVagrant\u306e\u6e96\u5099\n\u30ce\u30fc\u30c9\u7acb\u3066\u308b\uff0e\n$ vagrant box add ubuntu1410 http://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_ubuntu-14.10_chef-provisionerless.box\n$ vagrant init ubuntu1410\n$ vagrant up\n\n\u30ce\u30fc\u30c9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\n$ vagrant ssh-config --host fluentd >> ~/.ssh/config\n\n\nChef\u306e\u6e96\u5099\n\nGemfile\nsource 'https://rubygems.org'\ngem 'knife-solo'\n\n\n\u30ce\u30fc\u30c9\u306bchef\u3092\u5165\u308c\u308b\n$ bundle\n$ bundle exec knife solo init .\n$ bundle exec knife solo prepare fluentd\n\n\nfluentd\n\n\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nCookbook\u3092\u4f5c\u308b\n$ bundle exec knife cookbook create fluentd -o site-cookbooks\n$ emacs site-cookbooks/fluentd/recipes/default.rb\n\n\nsite-cookbooks/fluentd/recipes/default.rb\n#\n# Cookbook Name:: fluentd\n# Recipe:: default\n#\n# Copyright 2014, TAC\n#\n# All rights reserved - Do Not Redistribute\n#\npackages = [\"build-essential\", \"ruby-dev\", \"libssl-dev\"]\npackages.each do |p|\n  package p do\n    action :install\n  end\nend\n\ngem_packages = [\"fluentd-ui\"]\ngem_packages.each do |p|\n  gem_package p do\n    action :install\n    end\nend\n\n\n\n\u5b9f\u884c\n$ bundle exec knife solo cook fluentd -o fluentd\n\n\n\u30b5\u30fc\u30d3\u30b9\u958b\u59cb\n\nsite-cookbooks/fluentd/recipes/default.rb\n+ template \"fluentd-ui\" do\n+   path \"/etc/init.d/fluentd-ui\"\n+   owner \"root\"\n+   group \"root\"\n+   mode 0755\n+ end\n+  \n+ service \"fluentd-ui\" do\n+   supports :start => true, :stop => true\n+   action [:start, :enable]\n+ end\n\n\nfluentd-ui \u30b5\u30fc\u30d3\u30b9\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\nsite-cookbooks/fluentd/templates/default/fluentd-ui.erb\n#!/bin/sh\n\nexport PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin\n\nNAME=\"fluentd-ui\"\nFLUENTD_UI_PATH=\"/usr/local/bin\"\nPIDFILE=/run/${NAME}.pid\n\ncase \"$1\" in\n    start)\n        start-stop-daemon --background --start --quiet --pidfile $PIDFILE \\\n                          --make-pidfile --exec $FLUENTD_UI_PATH/$NAME -- start\n        ;;\n    stop)\n        $FLUENTD_UI_PATH/$NAME stop\n        rm -f $PIDFILE\n        ;;\n    status)\n        $FLUENTD_UI_PATH/$NAME status\n        ;;\n    *)\n        ;;\nesac\n\nexit 0\n\n\n\n\u30db\u30b9\u30c8PC\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\n\nVagrantfile\n+ config.vm.network \"private_network\", ip: \"192.168.33.10\"\n\n\nVagrant\u306e\u8a2d\u5b9a\u5909\u3048\u305f\u306e\u3067\u518d\u8d77\u52d5\n$ vagrant halt\n$ vagrant up\n$ bundle exec knife solo cook fluentd -o fluentd\n\n\u3067\u3001http://192.168.33.10:9292 \u3078\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\uff0e\uff0e\uff0e\n\u8d77\u52d5\u3057\u3066\u308b\uff01\uff01\nusername: admin, password: changeme \u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\uff0e\n\n\u88dc\u8db3:\u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089Clone\u3057\u3066\u304d\u305f\u3089\uff0e\uff0e\uff0e\n$ vagrant ssh-config --host fluentd >> ~/.ssh/config\n$ bundle\n$ bundle exec knife solo init .\n$ bundle exec knife solo prepare fluentd\n$ bundle exec knife solo cook fluentd -o fluentd\n\n\n\u67d0\u5fa1\u65b9\u304b\u3089 `Edison-fluentd-elasticsearch-kibana` \u3068\u3044\u3046\u96fb\u6ce2\u3092\u53d7\u4fe1\u3057\u305f\u306e\u3067\u3001vagrant + chef \u3067\u304a\u305f\u3081\u3057\u74b0\u5883\u69cb\u7bc9\u3057\u3066\u307f\u308b\uff0e\n\n\u30db\u30b9\u30c8\u540d\u306f\u3068\u308a\u3042\u3048\u305a `fluentd` \u3067\u3044\u304f\uff0e\n\n\u30ea\u30dd\u30b8\u30c8\u30ea\nhttps://github.com/tac0x2a/vagrant_chef_fluent-ui\n\n# Vagrant\u306e\u6e96\u5099\n\u30ce\u30fc\u30c9\u7acb\u3066\u308b\uff0e\n\n```bash:\n$ vagrant box add ubuntu1410 http://opscode-vm-bento.s3.amazonaws.com/vagrant/virtualbox/opscode_ubuntu-14.10_chef-provisionerless.box\n$ vagrant init ubuntu1410\n$ vagrant up\n```\n\n\u30ce\u30fc\u30c9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\n\n```\n$ vagrant ssh-config --host fluentd >> ~/.ssh/config\n```\n\n# Chef\u306e\u6e96\u5099\n\n```Ruby:Gemfile\nsource 'https://rubygems.org'\ngem 'knife-solo'\n```\n\n\u30ce\u30fc\u30c9\u306bchef\u3092\u5165\u308c\u308b\n\n```\n$ bundle\n$ bundle exec knife solo init .\n$ bundle exec knife solo prepare fluentd\n```\n\n# fluentd\n## \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nCookbook\u3092\u4f5c\u308b\n\n```\n$ bundle exec knife cookbook create fluentd -o site-cookbooks\n$ emacs site-cookbooks/fluentd/recipes/default.rb\n```\n\n```ruby:site-cookbooks/fluentd/recipes/default.rb\n#\n# Cookbook Name:: fluentd\n# Recipe:: default\n#\n# Copyright 2014, TAC\n#\n# All rights reserved - Do Not Redistribute\n#\npackages = [\"build-essential\", \"ruby-dev\", \"libssl-dev\"]\npackages.each do |p|\n  package p do\n    action :install\n  end\nend\n\ngem_packages = [\"fluentd-ui\"]\ngem_packages.each do |p|\n  gem_package p do\n    action :install\n    end\nend\n\n```\n\n\u5b9f\u884c\n\n```\n$ bundle exec knife solo cook fluentd -o fluentd\n```\n\n## \u30b5\u30fc\u30d3\u30b9\u958b\u59cb\n```diff:site-cookbooks/fluentd/recipes/default.rb\n+ template \"fluentd-ui\" do\n+   path \"/etc/init.d/fluentd-ui\"\n+   owner \"root\"\n+   group \"root\"\n+   mode 0755\n+ end\n+  \n+ service \"fluentd-ui\" do\n+   supports :start => true, :stop => true\n+   action [:start, :enable]\n+ end\n```\n\nfluentd-ui \u30b5\u30fc\u30d3\u30b9\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\n\n```site-cookbooks/fluentd/templates/default/fluentd-ui.erb\n#!/bin/sh\n\nexport PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin\n\nNAME=\"fluentd-ui\"\nFLUENTD_UI_PATH=\"/usr/local/bin\"\nPIDFILE=/run/${NAME}.pid\n\ncase \"$1\" in\n    start)\n        start-stop-daemon --background --start --quiet --pidfile $PIDFILE \\\n                          --make-pidfile --exec $FLUENTD_UI_PATH/$NAME -- start\n        ;;\n    stop)\n        $FLUENTD_UI_PATH/$NAME stop\n        rm -f $PIDFILE\n        ;;\n    status)\n        $FLUENTD_UI_PATH/$NAME status\n        ;;\n    *)\n        ;;\nesac\n\nexit 0\n\n```\n\n\u30db\u30b9\u30c8PC\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\n\n```diff:Vagrantfile\n+ config.vm.network \"private_network\", ip: \"192.168.33.10\"\n```\n\nVagrant\u306e\u8a2d\u5b9a\u5909\u3048\u305f\u306e\u3067\u518d\u8d77\u52d5\n\n```\n$ vagrant halt\n$ vagrant up\n$ bundle exec knife solo cook fluentd -o fluentd\n```\n\n\u3067\u3001http://192.168.33.10:9292 \u3078\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3068\uff0e\uff0e\uff0e\n\n\u8d77\u52d5\u3057\u3066\u308b\uff01\uff01\n\nusername: admin, password: changeme \u3067\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u308b\uff0e\n\n# \u88dc\u8db3:\u30ea\u30dd\u30b8\u30c8\u30ea\u304b\u3089Clone\u3057\u3066\u304d\u305f\u3089\uff0e\uff0e\uff0e\n```\n$ vagrant ssh-config --host fluentd >> ~/.ssh/config\n$ bundle\n$ bundle exec knife solo init .\n$ bundle exec knife solo prepare fluentd\n$ bundle exec knife solo cook fluentd -o fluentd\n```\n", "tags": ["chef", "fluentd", "vagrant"]}