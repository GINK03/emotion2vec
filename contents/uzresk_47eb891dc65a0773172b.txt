{"context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nAWS SDK for Java\u3092\u4f7f\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u901a\u5e38\u306e\u540c\u671f\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306e\u4ed6\u3001\u30de\u30eb\u30c1\u30d1\u30fc\u30c8\u3067\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u30de\u30eb\u30c1\u30d1\u30fc\u30c8\u3067\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306f\u3001\u8ee2\u9001\u6642\u306b\u3044\u304f\u3064\u304b\u306e\u30d1\u30fc\u30c8\u306b\u5206\u5272\u3057\u3066\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3001\u3069\u308c\u304b\u306e\u30d1\u30fc\u30c8\u304c\u8ee2\u9001\u5931\u6557\u3057\u305f\u5834\u5408\u306b\u306f\u81ea\u52d5\u7684\u306b\u518d\u9001\u51e6\u7406\u3092\u884c\u3063\u3066\u304f\u308c\u307e\u3059\u3002\u8ee2\u9001\u304c\u5168\u90e8\u7d42\u308f\u3063\u305f\u6bb5\u968e\u3067S3\u306f\u30d1\u30fc\u30c8\u3092\u7d44\u307f\u7acb\u3066\u3066\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n\u6e96\u5099\n\u5c0f\u3055\u3044\u30d5\u30a1\u30a4\u30eb\u3060\u3068\u3059\u3050\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u7d42\u308f\u3063\u3066\u3057\u307e\u3046\u306e\u306710MB\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u304a\u304d\u307e\u3059\u3002\u79c1\u306e\u74b0\u5883\u306fmac\u306a\u306e\u3067dd\u3067\u4f5c\u308c\u307e\u3059\u3002\n\ndd if=/dev/zero of=10mfile bs=1048576 count=10\n\n\u3061\u306a\u307f\u306blinux\u3067\u3082\u540c\u3058\u3067\u3059\u3002windows\u306e\u5834\u5408\u306ffsutil\u3092\u4f7f\u3046\u3068\u3088\u3044\u3067\u3057\u3087\u3046\u3002\n\nsingle upload\n\nS3SingleUpload.java\npackage aws.s3.upload;\n\nimport java.io.File;\n\nimport com.amazonaws.auth.AWSCredentialsProvider;\nimport com.amazonaws.auth.profile.ProfileCredentialsProvider;\nimport com.amazonaws.services.s3.AmazonS3;\nimport com.amazonaws.services.s3.AmazonS3Client;\nimport com.amazonaws.services.s3.model.PutObjectRequest;\n\npublic class S3SingleUpload {\n\n    public static void main(String[] args) {\n\n        AWSCredentialsProvider provider = new ProfileCredentialsProvider(\"uzr\");\n\n        // s3client\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\n        AmazonS3 s3client = new AmazonS3Client(provider.getCredentials());\n\n        File file = new File(\"/Users/yuzuru/Downloads/10mfile\");\n        long start = System.currentTimeMillis();\n\n        // \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n        // PutObjectRequest\u306e\u5f15\u6570\u306f\u30d0\u30b1\u30c3\u30c8\u540d\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5f8c\u306e\u540d\u524d\u3001File\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\n        s3client.putObject(new PutObjectRequest(\"data.uzr\", \"10mfile\",file));\n\n        // \u51e6\u7406\u6642\u9593\u3092\u53d6\u5f97\n        long end = System.currentTimeMillis();\n        long interval = end - start;\n        System.out.println(\"\u51e6\u7406\u6642\u9593\uff1a\" + interval + \"\u30df\u30ea\u79d2\");\n        System.out.println(\"upload finish.\");\n    }\n\n}\n\n\n\n\nmultipart upload\n\u30de\u30eb\u30c1\u30d1\u30fc\u30c8\u3067\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306fListner\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\u7d42\u4e86\u30a4\u30d9\u30f3\u30c8\u306e\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3084\u9032\u6357\u72b6\u6cc1\u306e\u78ba\u8a8d\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\nS3MultiparatUpload.java\npackage aws.s3.upload;\n\nimport java.io.File;\n\nimport com.amazonaws.auth.AWSCredentialsProvider;\nimport com.amazonaws.auth.profile.ProfileCredentialsProvider;\nimport com.amazonaws.event.ProgressEvent;\nimport com.amazonaws.event.ProgressEventType;\nimport com.amazonaws.event.ProgressListener;\nimport com.amazonaws.services.s3.model.PutObjectRequest;\nimport com.amazonaws.services.s3.transfer.TransferManager;\nimport com.amazonaws.services.s3.transfer.TransferManagerConfiguration;\nimport com.amazonaws.services.s3.transfer.TransferProgress;\nimport com.amazonaws.services.s3.transfer.Upload;\n\npublic class S3MultiparatUpload {\n\n    public static void main(String[] args) {\n\n        AWSCredentialsProvider provider = new ProfileCredentialsProvider(\"uzr\");\n\n        TransferManager tm = new TransferManager(provider.getCredentials());\n\n        File file = new File(\"/Users/yuzuru/Downloads/10mfile\");\n        long start = System.currentTimeMillis();\n\n        Upload upload = tm.upload(new PutObjectRequest(\"data.uzr\", \"10mfile\",\n                file));\n\n        // Listner\u3092\u4ed5\u8fbc\u307f\u307e\u3059\u3002\n        upload.addProgressListener(new ProgressListener() {\n            /**\n             * \u9032\u6357\u72b6\u6cc1\u304c\u5909\u308f\u3063\u305f\u3089\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n             * ProgressEvent\u304b\u3089\u306f\u3001\u8ee2\u9001\u30d0\u30a4\u30c8\u6570\u3084\u30d1\u30fc\u30bb\u30f3\u30c6\u30fc\u30b8\u306a\u3069\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n             * \u3053\u3053\u3067\u306f\u8ee2\u9001\u5b8c\u4e86\u5f8c\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u3059\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n             */\n            @Override\n            public void progressChanged(ProgressEvent progressEvent) {\n                if (ProgressEventType.TRANSFER_COMPLETED_EVENT == progressEvent.getEventType()) {\n                    long end = System.currentTimeMillis();\n                    long interval = end - start;\n                    System.out.println(\"\u51e6\u7406\u6642\u9593\uff1a\" + interval + \"\u30df\u30ea\u79d2\");\n                    System.out.println(\"upload finish.\");                   \n                }\n            }\n        });\n\n    }\n\n}\n\n\n\n\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u306f\u7d39\u4ecb\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001upload\u6642\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306fTransferManagerConfiguration\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u3053\u3093\u306a\u611f\u3058\n\nTransferManagerConfiguration_sample.java\n        TransferManager tm = new TransferManager(provider.getCredentials());\n\n        TransferManagerConfiguration configuration = new TransferManagerConfiguration();\n        configuration.setMinimumUploadPartSize(5 * MB);\n        configuration.setMultipartUploadThreshold(5 * GB);\n        tm.setConfiguration(configuration);\n\n\n# \u306f\u3058\u3081\u306b\n\nAWS SDK for Java\u3092\u4f7f\u3063\u305f\u30d5\u30a1\u30a4\u30eb\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\n\u901a\u5e38\u306e\u540c\u671f\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306e\u4ed6\u3001\u30de\u30eb\u30c1\u30d1\u30fc\u30c8\u3067\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u30de\u30eb\u30c1\u30d1\u30fc\u30c8\u3067\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306f\u3001\u8ee2\u9001\u6642\u306b\u3044\u304f\u3064\u304b\u306e\u30d1\u30fc\u30c8\u306b\u5206\u5272\u3057\u3066\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3001\u3069\u308c\u304b\u306e\u30d1\u30fc\u30c8\u304c\u8ee2\u9001\u5931\u6557\u3057\u305f\u5834\u5408\u306b\u306f\u81ea\u52d5\u7684\u306b\u518d\u9001\u51e6\u7406\u3092\u884c\u3063\u3066\u304f\u308c\u307e\u3059\u3002\u8ee2\u9001\u304c\u5168\u90e8\u7d42\u308f\u3063\u305f\u6bb5\u968e\u3067S3\u306f\u30d1\u30fc\u30c8\u3092\u7d44\u307f\u7acb\u3066\u3066\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304f\u308c\u307e\u3059\u3002\n\n# \u6e96\u5099\n\u5c0f\u3055\u3044\u30d5\u30a1\u30a4\u30eb\u3060\u3068\u3059\u3050\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u7d42\u308f\u3063\u3066\u3057\u307e\u3046\u306e\u306710MB\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u3063\u3066\u304a\u304d\u307e\u3059\u3002\u79c1\u306e\u74b0\u5883\u306fmac\u306a\u306e\u3067dd\u3067\u4f5c\u308c\u307e\u3059\u3002\n```\ndd if=/dev/zero of=10mfile bs=1048576 count=10\n```\n\u3061\u306a\u307f\u306blinux\u3067\u3082\u540c\u3058\u3067\u3059\u3002windows\u306e\u5834\u5408\u306ffsutil\u3092\u4f7f\u3046\u3068\u3088\u3044\u3067\u3057\u3087\u3046\u3002\n\n# single upload\n\n```S3SingleUpload.java\npackage aws.s3.upload;\n\nimport java.io.File;\n\nimport com.amazonaws.auth.AWSCredentialsProvider;\nimport com.amazonaws.auth.profile.ProfileCredentialsProvider;\nimport com.amazonaws.services.s3.AmazonS3;\nimport com.amazonaws.services.s3.AmazonS3Client;\nimport com.amazonaws.services.s3.model.PutObjectRequest;\n\npublic class S3SingleUpload {\n\n\tpublic static void main(String[] args) {\n\n\t\tAWSCredentialsProvider provider = new ProfileCredentialsProvider(\"uzr\");\n\n\t\t// s3client\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u4f5c\u6210\n\t\tAmazonS3 s3client = new AmazonS3Client(provider.getCredentials());\n\t\t\n\t\tFile file = new File(\"/Users/yuzuru/Downloads/10mfile\");\n\t\tlong start = System.currentTimeMillis();\n\t\t\n\t\t// \u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u307e\u3059\u3002\n\t\t// PutObjectRequest\u306e\u5f15\u6570\u306f\u30d0\u30b1\u30c3\u30c8\u540d\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u5f8c\u306e\u540d\u524d\u3001File\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3067\u3059\u3002\n\t\ts3client.putObject(new PutObjectRequest(\"data.uzr\", \"10mfile\",file));\n\t\t\n\t\t// \u51e6\u7406\u6642\u9593\u3092\u53d6\u5f97\n\t\tlong end = System.currentTimeMillis();\n\t\tlong interval = end - start;\n\t\tSystem.out.println(\"\u51e6\u7406\u6642\u9593\uff1a\" + interval + \"\u30df\u30ea\u79d2\");\n\t\tSystem.out.println(\"upload finish.\");\n\t}\n\n}\n\n```\n\n# multipart upload\n\n\u30de\u30eb\u30c1\u30d1\u30fc\u30c8\u3067\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u306fListner\u3092\u30bb\u30c3\u30c8\u3059\u308b\u3053\u3068\u3067\u7d42\u4e86\u30a4\u30d9\u30f3\u30c8\u306e\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3084\u9032\u6357\u72b6\u6cc1\u306e\u78ba\u8a8d\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n```S3MultiparatUpload.java\npackage aws.s3.upload;\n\nimport java.io.File;\n\nimport com.amazonaws.auth.AWSCredentialsProvider;\nimport com.amazonaws.auth.profile.ProfileCredentialsProvider;\nimport com.amazonaws.event.ProgressEvent;\nimport com.amazonaws.event.ProgressEventType;\nimport com.amazonaws.event.ProgressListener;\nimport com.amazonaws.services.s3.model.PutObjectRequest;\nimport com.amazonaws.services.s3.transfer.TransferManager;\nimport com.amazonaws.services.s3.transfer.TransferManagerConfiguration;\nimport com.amazonaws.services.s3.transfer.TransferProgress;\nimport com.amazonaws.services.s3.transfer.Upload;\n\npublic class S3MultiparatUpload {\n\n\tpublic static void main(String[] args) {\n\n\t\tAWSCredentialsProvider provider = new ProfileCredentialsProvider(\"uzr\");\n\n\t\tTransferManager tm = new TransferManager(provider.getCredentials());\n\n\t\tFile file = new File(\"/Users/yuzuru/Downloads/10mfile\");\n\t\tlong start = System.currentTimeMillis();\n\t\t\n\t\tUpload upload = tm.upload(new PutObjectRequest(\"data.uzr\", \"10mfile\",\n\t\t\t\tfile));\n\t\t\n\t\t// Listner\u3092\u4ed5\u8fbc\u307f\u307e\u3059\u3002\n\t\tupload.addProgressListener(new ProgressListener() {\n\t\t\t/**\n\t\t\t * \u9032\u6357\u72b6\u6cc1\u304c\u5909\u308f\u3063\u305f\u3089\u547c\u3070\u308c\u308b\u30e1\u30bd\u30c3\u30c9\n\t\t\t * ProgressEvent\u304b\u3089\u306f\u3001\u8ee2\u9001\u30d0\u30a4\u30c8\u6570\u3084\u30d1\u30fc\u30bb\u30f3\u30c6\u30fc\u30b8\u306a\u3069\u304c\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002\n\t\t\t * \u3053\u3053\u3067\u306f\u8ee2\u9001\u5b8c\u4e86\u5f8c\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u3059\u3088\u3046\u306b\u3057\u3066\u3044\u307e\u3059\u3002\n\t\t\t */\n\t\t\t@Override\n\t\t\tpublic void progressChanged(ProgressEvent progressEvent) {\n\t\t\t\tif (ProgressEventType.TRANSFER_COMPLETED_EVENT == progressEvent.getEventType()) {\n\t\t\t\t\tlong end = System.currentTimeMillis();\n\t\t\t\t\tlong interval = end - start;\n\t\t\t\t\tSystem.out.println(\"\u51e6\u7406\u6642\u9593\uff1a\" + interval + \"\u30df\u30ea\u79d2\");\n\t\t\t\t\tSystem.out.println(\"upload finish.\");\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t}\n\n}\n\n```\n\n\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3067\u306f\u7d39\u4ecb\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001upload\u6642\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306fTransferManagerConfiguration\u3092\u5229\u7528\u3057\u307e\u3059\u3002\n\u3053\u3093\u306a\u611f\u3058\n\n```TransferManagerConfiguration_sample.java\n\t\tTransferManager tm = new TransferManager(provider.getCredentials());\n\n\t\tTransferManagerConfiguration configuration = new TransferManagerConfiguration();\n\t\tconfiguration.setMinimumUploadPartSize(5 * MB);\n\t\tconfiguration.setMultipartUploadThreshold(5 * GB);\n\t\ttm.setConfiguration(configuration);\n```\n", "tags": ["AWS", "AWS_SDK", "S3"]}