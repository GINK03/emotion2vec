{"context": "Q. TLS\u306emaster secret\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e48\u30d0\u30a4\u30c8\u3088\u308a\u9577\u304f\u306a\u308b\u306e\uff1f96\u30d0\u30a4\u30c8\u3050\u3089\u3044\uff1f\nA. \u9055\u3044\u307e\u3059\u3002\n\n\u524d\u63d0\n\u3053\u306e\u8a71\u304c\u901a\u3058\u308b\u306e\u306fTLS1.0\uff5eTLS1.2\u3067\u3059\u3002TLS1.3\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\n\n\u672c\u6587\nmaster_secret\u306e\u7b97\u51fa\u65b9\u5f0f\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\u666e\u901a\u306emaster_secret\u306fClientHello.Random, ServerHello.Random, pre_master_secret\u306e3\u5024\u304b\u3089\u7b97\u51fa\u3057\u307e\u3059\u304c\uff08\u62d9\u7a3f SSL/TLS\uff08SSL3.0\uff5eTLS1.2\uff09\u306e\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u3092\u5fa9\u7fd2\u3059\u308b \u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\uff09\u3001extended master secret\u62e1\u5f35\u304c\u6709\u52b9\u306a\u3068\u304d\u306f\u3001\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u306eClientHello\u304b\u3089ClientKeyExchange\u307e\u3067\u306e\u5e73\u6587\u30d1\u30fc\u30c8\u5168\u4f53\u3092\u30cf\u30c3\u30b7\u30e5\u3057\u3001\u305d\u308c\u3068pre_master_secret\u3092\u5143\u306bmaster_secret\u3092\u7b97\u51fa\u3057\u307e\u3059\u3002\n\u300c\u5e73\u6587\u30d1\u30fc\u30c8\u5168\u4f53\u300d\u306e\u7bc4\u56f2\u306b\u306f\u3001ClientHello.Random\u3068ServerHello.Random\u3082\u542b\u307e\u308c\u307e\u3059\u306e\u3067\u3001\u8981\u306fmaster_secret\u306e\u7b97\u51fa\u5143\u30c7\u30fc\u30bf\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u7a2e\u985e\u304c\u5897\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\nmaster_secret\u304c\u7b97\u51fa\u3055\u308c\u308c\u3070\u3001\u305d\u306e\u5f8c\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u666e\u901a\u306eTLS\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u3002\n\n\u3053\u306e\u62e1\u5f35\u306f\u5fc5\u8981\u304b\uff1f\n\u3053\u308c\u306fTriple Handshake\u653b\u6483\u306e\u8105\u5a01\u3092\u3069\u3046\u8a55\u4fa1\u3059\u308b\u304b\u306e\u554f\u984c\u3067\u3059\u3002\nTriple Handshake\u653b\u6483\u306b\u306f\u8907\u6570\u306e\u30d0\u30ea\u30a8\u30fc\u30b7\u30e7\u30f3\u304c\u3042\u308a\u307e\u3059\u304c\u3001\u516c\u5f0f\u30b5\u30a4\u30c8\u3067\u8ff0\u3079\u3089\u308c\u3066\u3044\u308b\u5178\u578b\u7684\u306a\u653b\u6483\u4f8b\u306f3\u6bb5\u968e\u304b\u3089\u6210\u308a\u7acb\u3063\u3066\u304a\u308a\u3001\u305d\u306e\u6700\u7d42\u6bb5\u968e (step 3) \u3092\u3088\u304f\u898b\u308b\u3068\u3001\u5b9f\u306f\u4e00\u90e8\u306eTLS\u88fd\u54c1\u306b\u5f53\u6642\u5b58\u5728\u3057\u3066\u3044\u305f\u4e0d\u5177\u5408\u3092\u7a81\u304f\u5f62\u3067\u884c\u308f\u308c\u3066\u3044\u308b\u306e\u3067\u3059\u3002\u4e0d\u5177\u5408\u3055\u3048\u306a\u3051\u308c\u3070\u3001step 2\u307e\u3067\u3057\u304b\u9032\u3081\u307e\u305b\u3093\u306e\u3067\u3001\u305d\u308c\u306a\u3089Triple Handshake\u653b\u6483\u306f\u5927\u304d\u306a\u8105\u5a01\u3067\u306f\u306a\u3044\u3068\u8003\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3057\u304b\u3057\u5c06\u6765\u7684\u306b\u3001\u3053\u308c\u3092\u6539\u826f\u3057\u305f\u5fdc\u7528\u7684\u306a\u653b\u6483\u6cd5\u304c\u767a\u898b\u3055\u308c\u308b\u304b\u3082\u77e5\u308c\u306a\u3044\u3068\u8003\u3048\u308b\u306a\u3089\u3001\u3084\u306f\u308aRFC7627\u304c\u5fc5\u8981\u3068\u3082\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\u305d\u3093\u306a\u308f\u3051\u3067\u3001\u4e16\u306e\u4e2dRFC7627\u5bfe\u5fdc\u306f\u610f\u5916\u3068\u9045\u304f\u3001\u672a\u5bfe\u5fdc\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3084\u30b5\u30fc\u30d0\u304c\u307e\u3060\u307e\u3060\u6b8b\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u3053\u306e\u62e1\u5f35\u306fTriple Handshake\u5bfe\u7b56\u306b\u306a\u308b\u306e\u304b\uff1f\n\u304b\u3064\u3066\u306eCVE-2009-3555\u8106\u5f31\u6027\u3092\u53d7\u3051\u3066\u3001TLS\u518d\u30cd\u30b4\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u306e\u88dc\u5f37\u7b56\u3068\u3057\u3066\u767b\u5834\u3057\u305fRFC5746\u304c\u3001Triple Handshake\u653b\u6483\u306b\u306f\u3055\u3063\u3071\u308a\u7121\u529b\u3060\u3063\u305f\u308f\u3051\u3067\u3001\u3067\u306fRFC7627\u306f\u672c\u5f53\u306b\u5927\u4e08\u592b\u306a\u306e\u304b\u6c17\u306b\u306a\u308b\u3068\u3053\u308d\u3067\u3059\u3088\u306d\u3002\nRFC7627\u306f\u516c\u5f0f\u30b5\u30a4\u30c8\u306e3\u6bb5\u968e\u306e\u3046\u3061\u6700\u521d (step 1) \u306b\u4f5c\u7528\u3057\u3001\u5225\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u3060\u304cmaster_secret\u306f\u540c\u3058\u3001\u3068\u3044\u3046\u72b6\u614b\u3092\u4f5c\u3089\u305b\u306a\u3044\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002ClientHello.Random, ServerHello.Random, pre_master_secret\u306b\u52a0\u3048\u3066\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u3082master_secret\u7b97\u51fa\u306e\u5143\u30c7\u30fc\u30bf\u306b\u4f7f\u308f\u308c\u307e\u3059\u306e\u3067\u3001\u653b\u6483\u30b5\u30fc\u30d0A\u304c\u88ab\u5bb3\u30af\u30e9\u30a4\u30a2\u30f3\u30c8C\u306b\u9001\u308b\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u3068\u3001\u88ab\u5bb3\u30b5\u30fc\u30d0S\u304c\u653b\u6483\u30af\u30e9\u30a4\u30a2\u30f3\u30c8A\u306b\u9001\u308b\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u304c\u4e00\u81f4\u3057\u306a\u3051\u308c\u3070\u3001master_secret\u306f\u540c\u3058\u306b\u306a\u3089\u306a\u3044\u3068\u3001\u307e\u3042\u305d\u3046\u3044\u3063\u305f\u7406\u5c48\u3067\u3059\u3002\n\u3002\u3002\u3002\u3069\u3046\u601d\u3044\u307e\u3059\uff1f\u306a\u3093\u3068\u3044\u3046\u304b\u3001Triple Handshake\u8ad6\u6587\u306e\u653b\u6483\u30b7\u30ca\u30ea\u30aa\u306b\u306f\u6709\u52b9\u3067\u3082\u3001\u8ab0\u304b\u304c\u4f55\u304b\u5225\u306e\u5fdc\u7528\u3092\u601d\u3044\u3064\u3044\u305f\u3089\u3001\u3042\u3063\u3055\u308a\u8fc2\u56de\u3055\u308c\u3066\u3057\u307e\u3046\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u3044\u3046\u4e88\u611f\u304c\u3057\u306a\u304f\u3082\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u307e\u3042\u3001\u305d\u306e\u6642\u306f\u305d\u306e\u6642\u3067\u307e\u305f\u4f55\u304b\u8003\u3048\u308c\u3070\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u3002\n\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\nE. Rescorla, et al. (2010)\nTransport Layer Security (TLS) Renegotiation Indication Extension\nhttps://tools.ietf.org/html/rfc5746 (Google\u7ffb\u8a33)\nK. Bhargavan, et al. (2015)\nTransport Layer Security (TLS) Session Hash and Extended Master Secret Extension\nhttps://tools.ietf.org/html/rfc7627 (Google\u7ffb\u8a33)\nTriple Handshakes Considered Harmful: Breaking and Fixing Authentication over TLS\nhttps://mitls.org/pages/attacks/3SHAKE (Google\u7ffb\u8a33)\nSSL/TLS\uff08SSL3.0\uff5eTLS1.2\uff09\u306e\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u3092\u5fa9\u7fd2\u3059\u308b\nhttp://qiita.com/n-i-e/items/41673fd16d7bd1189a29\nQ. TLS\u306emaster secret\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e48\u30d0\u30a4\u30c8\u3088\u308a\u9577\u304f\u306a\u308b\u306e\uff1f96\u30d0\u30a4\u30c8\u3050\u3089\u3044\uff1f\nA. \u9055\u3044\u307e\u3059\u3002\n\n#\u524d\u63d0\n\n\u3053\u306e\u8a71\u304c\u901a\u3058\u308b\u306e\u306fTLS1.0\uff5eTLS1.2\u3067\u3059\u3002TLS1.3\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\n\n#\u672c\u6587\n\nmaster_secret\u306e\u7b97\u51fa\u65b9\u5f0f\u304c\u5909\u308f\u308a\u307e\u3059\u3002\n\n\u666e\u901a\u306emaster_secret\u306fClientHello.Random, ServerHello.Random, pre_master_secret\u306e3\u5024\u304b\u3089\u7b97\u51fa\u3057\u307e\u3059\u304c\uff08\u62d9\u7a3f [SSL/TLS\uff08SSL3.0\uff5eTLS1.2\uff09\u306e\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u3092\u5fa9\u7fd2\u3059\u308b](http://qiita.com/n-i-e/items/41673fd16d7bd1189a29) \u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\uff09\u3001extended master secret\u62e1\u5f35\u304c\u6709\u52b9\u306a\u3068\u304d\u306f\u3001\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u306eClientHello\u304b\u3089ClientKeyExchange\u307e\u3067\u306e\u5e73\u6587\u30d1\u30fc\u30c8\u5168\u4f53\u3092\u30cf\u30c3\u30b7\u30e5\u3057\u3001\u305d\u308c\u3068pre_master_secret\u3092\u5143\u306bmaster_secret\u3092\u7b97\u51fa\u3057\u307e\u3059\u3002\n\n\u300c\u5e73\u6587\u30d1\u30fc\u30c8\u5168\u4f53\u300d\u306e\u7bc4\u56f2\u306b\u306f\u3001ClientHello.Random\u3068ServerHello.Random\u3082\u542b\u307e\u308c\u307e\u3059\u306e\u3067\u3001\u8981\u306fmaster_secret\u306e\u7b97\u51fa\u5143\u30c7\u30fc\u30bf\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u7a2e\u985e\u304c\u5897\u3048\u308b\u3068\u3044\u3046\u3053\u3068\u3067\u3059\u3002\n\nmaster_secret\u304c\u7b97\u51fa\u3055\u308c\u308c\u3070\u3001\u305d\u306e\u5f8c\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u666e\u901a\u306eTLS\u3068\u5909\u308f\u308a\u307e\u305b\u3093\u3002\n\n#\u3053\u306e\u62e1\u5f35\u306f\u5fc5\u8981\u304b\uff1f\n\n\u3053\u308c\u306fTriple Handshake\u653b\u6483\u306e\u8105\u5a01\u3092\u3069\u3046\u8a55\u4fa1\u3059\u308b\u304b\u306e\u554f\u984c\u3067\u3059\u3002\n\nTriple Handshake\u653b\u6483\u306b\u306f\u8907\u6570\u306e\u30d0\u30ea\u30a8\u30fc\u30b7\u30e7\u30f3\u304c\u3042\u308a\u307e\u3059\u304c\u3001[\u516c\u5f0f\u30b5\u30a4\u30c8](https://mitls.org/pages/attacks/3SHAKE)\u3067\u8ff0\u3079\u3089\u308c\u3066\u3044\u308b\u5178\u578b\u7684\u306a\u653b\u6483\u4f8b\u306f3\u6bb5\u968e\u304b\u3089\u6210\u308a\u7acb\u3063\u3066\u304a\u308a\u3001\u305d\u306e\u6700\u7d42\u6bb5\u968e (step 3) \u3092\u3088\u304f\u898b\u308b\u3068\u3001\u5b9f\u306f\u4e00\u90e8\u306eTLS\u88fd\u54c1\u306b\u5f53\u6642\u5b58\u5728\u3057\u3066\u3044\u305f\u4e0d\u5177\u5408\u3092\u7a81\u304f\u5f62\u3067\u884c\u308f\u308c\u3066\u3044\u308b\u306e\u3067\u3059\u3002\u4e0d\u5177\u5408\u3055\u3048\u306a\u3051\u308c\u3070\u3001step 2\u307e\u3067\u3057\u304b\u9032\u3081\u307e\u305b\u3093\u306e\u3067\u3001\u305d\u308c\u306a\u3089Triple Handshake\u653b\u6483\u306f\u5927\u304d\u306a\u8105\u5a01\u3067\u306f\u306a\u3044\u3068\u8003\u3048\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n\u3057\u304b\u3057\u5c06\u6765\u7684\u306b\u3001\u3053\u308c\u3092\u6539\u826f\u3057\u305f\u5fdc\u7528\u7684\u306a\u653b\u6483\u6cd5\u304c\u767a\u898b\u3055\u308c\u308b\u304b\u3082\u77e5\u308c\u306a\u3044\u3068\u8003\u3048\u308b\u306a\u3089\u3001\u3084\u306f\u308aRFC7627\u304c\u5fc5\u8981\u3068\u3082\u8003\u3048\u3089\u308c\u307e\u3059\u3002\n\n\u305d\u3093\u306a\u308f\u3051\u3067\u3001\u4e16\u306e\u4e2dRFC7627\u5bfe\u5fdc\u306f\u610f\u5916\u3068\u9045\u304f\u3001\u672a\u5bfe\u5fdc\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3084\u30b5\u30fc\u30d0\u304c\u307e\u3060\u307e\u3060\u6b8b\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n#\u3053\u306e\u62e1\u5f35\u306fTriple Handshake\u5bfe\u7b56\u306b\u306a\u308b\u306e\u304b\uff1f\n\n\u304b\u3064\u3066\u306eCVE-2009-3555\u8106\u5f31\u6027\u3092\u53d7\u3051\u3066\u3001TLS\u518d\u30cd\u30b4\u30b7\u30a8\u30fc\u30b7\u30e7\u30f3\u306e\u88dc\u5f37\u7b56\u3068\u3057\u3066\u767b\u5834\u3057\u305fRFC5746\u304c\u3001Triple Handshake\u653b\u6483\u306b\u306f\u3055\u3063\u3071\u308a\u7121\u529b\u3060\u3063\u305f\u308f\u3051\u3067\u3001\u3067\u306fRFC7627\u306f\u672c\u5f53\u306b\u5927\u4e08\u592b\u306a\u306e\u304b\u6c17\u306b\u306a\u308b\u3068\u3053\u308d\u3067\u3059\u3088\u306d\u3002\n\nRFC7627\u306f[\u516c\u5f0f\u30b5\u30a4\u30c8](https://mitls.org/pages/attacks/3SHAKE)\u306e3\u6bb5\u968e\u306e\u3046\u3061\u6700\u521d (step 1) \u306b\u4f5c\u7528\u3057\u3001\u5225\u306e\u30bb\u30c3\u30b7\u30e7\u30f3\u3060\u304cmaster_secret\u306f\u540c\u3058\u3001\u3068\u3044\u3046\u72b6\u614b\u3092\u4f5c\u3089\u305b\u306a\u3044\u3068\u3044\u3046\u3082\u306e\u3067\u3059\u3002ClientHello.Random, ServerHello.Random, pre_master_secret\u306b\u52a0\u3048\u3066\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u3082master_secret\u7b97\u51fa\u306e\u5143\u30c7\u30fc\u30bf\u306b\u4f7f\u308f\u308c\u307e\u3059\u306e\u3067\u3001\u653b\u6483\u30b5\u30fc\u30d0A\u304c\u88ab\u5bb3\u30af\u30e9\u30a4\u30a2\u30f3\u30c8C\u306b\u9001\u308b\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u3068\u3001\u88ab\u5bb3\u30b5\u30fc\u30d0S\u304c\u653b\u6483\u30af\u30e9\u30a4\u30a2\u30f3\u30c8A\u306b\u9001\u308b\u30b5\u30fc\u30d0\u8a3c\u660e\u66f8\u304c\u4e00\u81f4\u3057\u306a\u3051\u308c\u3070\u3001master_secret\u306f\u540c\u3058\u306b\u306a\u3089\u306a\u3044\u3068\u3001\u307e\u3042\u305d\u3046\u3044\u3063\u305f\u7406\u5c48\u3067\u3059\u3002\n\n\u3002\u3002\u3002\u3069\u3046\u601d\u3044\u307e\u3059\uff1f\u306a\u3093\u3068\u3044\u3046\u304b\u3001Triple Handshake\u8ad6\u6587\u306e\u653b\u6483\u30b7\u30ca\u30ea\u30aa\u306b\u306f\u6709\u52b9\u3067\u3082\u3001\u8ab0\u304b\u304c\u4f55\u304b\u5225\u306e\u5fdc\u7528\u3092\u601d\u3044\u3064\u3044\u305f\u3089\u3001\u3042\u3063\u3055\u308a\u8fc2\u56de\u3055\u308c\u3066\u3057\u307e\u3046\u3093\u3058\u3083\u306a\u3044\u304b\u3068\u3044\u3046\u4e88\u611f\u304c\u3057\u306a\u304f\u3082\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u307e\u3042\u3001\u305d\u306e\u6642\u306f\u305d\u306e\u6642\u3067\u307e\u305f\u4f55\u304b\u8003\u3048\u308c\u3070\u3044\u3044\u306e\u3067\u3057\u3087\u3046\u3002\n\n#\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\nE. Rescorla, et al. (2010)\nTransport Layer Security (TLS) Renegotiation Indication Extension\nhttps://tools.ietf.org/html/rfc5746 ([Google\u7ffb\u8a33](http://rfcs.web.fc2.com/rfc5746.html))\n\nK. Bhargavan, et al. (2015)\nTransport Layer Security (TLS) Session Hash and Extended Master Secret Extension\nhttps://tools.ietf.org/html/rfc7627 ([Google\u7ffb\u8a33](http://rfcs.web.fc2.com/rfc7627.html))\n\nTriple Handshakes Considered Harmful: Breaking and Fixing Authentication over TLS\nhttps://mitls.org/pages/attacks/3SHAKE ([Google\u7ffb\u8a33](https://translate.google.com/translate?sl=en&tl=ja&u=https%3A%2F%2Fmitls.org%2Fpages%2Fattacks%2F3SHAKE))\n\nSSL/TLS\uff08SSL3.0\uff5eTLS1.2\uff09\u306e\u30cf\u30f3\u30c9\u30b7\u30a7\u30a4\u30af\u3092\u5fa9\u7fd2\u3059\u308b\nhttp://qiita.com/n-i-e/items/41673fd16d7bd1189a29\n", "tags": ["SSL", "TLS", "\u6697\u53f7"]}