{"context": "\u3053\u306e\u8a18\u4e8b\u306f\u30d5\u30ed\u30e0\u30b9\u30af\u30e9\u30c3\u30c1 Advent Calendar 2016\u306e11\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\u6700\u8fd1\u306fPython\u3067TensorFlow\u3084Chainer\u3092\u4f7f\u3063\u3066\u307f\u308b\u3053\u3068\u304c\u6d41\u884c\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u3042\u3048\u3066R\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3042\u308bneuralnet\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306eneuralnet.pdf\u306b\u3042\u308b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u53c2\u8003\u306b\u3057\u307e\u3059\u3002\n\n\u60f3\u5b9a\u8aad\u8005\n\n\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u3092\u52c9\u5f37\u3092\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u4eba\n\u7d71\u8a08\u5b66\u306e\u52c9\u5f37\u3092\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u4eba\nR\u3092\u89e6\u3063\u305f\u3053\u3068\u304c\u3042\u308b\u4eba\nR\u3067\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u3092\u4f7f\u3044\u305f\u3044\u4eba\n\n\n\u6e96\u5099\n\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n> install.packages(\"neuralnet\")\n> library(\"neuralnet\")\n\n\nXOR\u554f\u984c\n\u5358\u7d14\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u3067\u306f\u5b66\u7fd2\u3067\u304d\u306a\u3044\u3001XOR\u306e\u5b66\u7fd2\u3092\u3057\u307e\u3059\u3002\n\u307e\u305a\u306f\u3001\u30c7\u30fc\u30bf\u306e\u6e96\u5099\u3002\n> XOR <- c(0,1,1,0)\n> xor.data <- data.frame(expand.grid(c(0,1), c(0,1)), XOR)\n\nxor.data\u306f\u3053\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n> xor.data\n  Var1 Var2 XOR\n1    0    0   0\n2    1    0   1\n3    0    1   1\n4    1    1   0\n\n\u305d\u3057\u3066\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\nnet.xor <- neuralnet(XOR~Var1+Var2, xor.data, hidden=4, rep=5)\n\n\u7b2c1\u5f15\u6570\u306f\u30e2\u30c7\u30eb\u3001\u7b2c2\u5f15\u6570\u306f\u8a13\u7df4\u30c7\u30fc\u30bf\u3067\u3059\u3002\u307e\u305f\u3001hidden\u3067\u306f\u96a0\u308c\u30cb\u30e5\u30fc\u30ed\u30f3\u306e\u6570\u3092\u6307\u5b9a\u3057\u3001rep\u306f\u8a13\u7df4\u306e\u56de\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\uff08\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3067\u306f\u96a0\u308c\u30cb\u30e5\u30fc\u30ed\u30f3\u30922\u3068\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u5b66\u7fd2\u306e\u7cbe\u5ea6\u304c\u4f4e\u304b\u3063\u305f\u306e\u30674\u306b\u3057\u3066\u3044\u307e\u3059\u3002\uff09\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u3057\u3066\u306f\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n> plot(net.xor, rep=\"best\")\n\n\nrep=\"best\"\u306b\u3088\u3063\u3066\u8aa4\u5dee\u304c\u6700\u3082\u5c0f\u3055\u304b\u3063\u305f\u3082\u306e\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\nnet.xor\u304c\u6b63\u3057\u304fXOR\u3092\u8868\u3059\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n> xor.data[-3]\n  Var1 Var2\n1    0    0\n2    1    0\n3    0    1\n4    1    1\n\n> compute(net.xor, xor.data[-3])$net.result\n                [,1]\n[1,] -0.005591322981\n[2,]  0.991365312571\n[3,]  1.003765769383\n[4,]  0.006757999021\n\n4\u3064\u306e\u5165\u529b\u306b\u5bfe\u3057\u3066\u3001\u305d\u308c\u305e\u308c\u6982\u306d\u6b63\u3057\u3044\u7b54\u3048\u304c\u5f97\u3089\u308c\u307e\u3057\u305f\u3002\n\n\u4e0d\u598a\u30c7\u30fc\u30bf\u306e\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\n\u6b21\u306f\u4e0d\u598a\u306b\u95a2\u3059\u308b\u30c7\u30fc\u30bf\u3092\u6271\u3044\u307e\u3059\u3002\n\uff08\u30bb\u30f3\u30b7\u30c6\u30a3\u30d6\u306a\u30c7\u30fc\u30bf\u3067\u3059\u304c\u3001\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3067\u4f7f\u3063\u3066\u3044\u305f\u306e\u3067\u3002\u3002\uff09\n> data(infert, package=\"datasets\")\n> infert\n    education age parity induced case spontaneous stratum pooled.stratum\n1      0-5yrs  26      6       1    1           2       1              3\n2      0-5yrs  42      1       1    1           0       2              1\n3      0-5yrs  39      6       2    1           0       3              4\n4      0-5yrs  34      4       2    1           0       4              2\n5     6-11yrs  35      3       1    1           1       5             32\n6     6-11yrs  36      4       2    1           1       6             36\n7     6-11yrs  23      1       0    1           0       7              6\n8     6-11yrs  32      2       0    1           0       8             22\n9     6-11yrs  21      1       0    1           1       9              5\n10    6-11yrs  28      2       0    1           0      10             19\n11    6-11yrs  29      2       1    1           0      11             20\n12    6-11yrs  37      4       2    1           1      12             37\n13    6-11yrs  31      1       1    1           0      13              9\n14    6-11yrs  29      3       2    1           0      14             29\n15    6-11yrs  31      2       1    1           1      15             21\n16    6-11yrs  27      2       2    1           0      16             18\n17    6-11yrs  30      5       2    1           1      17             38\n18    6-11yrs  26      1       0    1           1      18              7\n19    6-11yrs  25      3       2    1           1      19             28\n20    6-11yrs  44      1       0    1           1      20             17\n...(\u7701\u7565)\n [ reached getOption(\"max.print\") -- omitted 123 rows ]\n\n\u30c7\u30fc\u30bf\u306e\u8aac\u660e\u306f\u3053\u3061\u3089\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\u81ea\u7136\u30fb\u4eba\u5de5\u6d41\u7523\u5f8c\u306e\u4e0d\u598a\u75c7\u306b\u3064\u3044\u3066\u306e\u30c7\u30fc\u30bf\u3067\u3059\u3002\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\nnet.infert <- neuralnet(case~parity+induced+spontaneous, infert,\u3000err.fct=\"ce\", linear.output=FALSE, likelihood=TRUE)\n\n\u88ab\u9a13\u8005\u304b\u5bfe\u7167\u7fa4\u304b\u3092\u8868\u3059case\u3092\u76ee\u7684\u5909\u6570\u3068\u3057\u3001parity\uff08\u5b9f\u9a13\u56de\u6570\uff1f\uff09\u3001induced\uff08\u4eba\u5de5\u6d41\u7523\uff09\u3001spontaneous\uff08\u81ea\u7136\u6d41\u7523\uff09\u3092\u8aac\u660e\u5909\u6570\uff08\u5171\u5909\u91cf\uff09\u3068\u3057\u305f\u30e2\u30c7\u30eb\u3067\u3059\u3002\nerr.fct\u306f\u8aa4\u5dee\u95a2\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002ce\u306e\u5834\u5408\u306f\u30af\u30ed\u30b9\u30a8\u30f3\u30c8\u30ed\u30d4\u30fc\u3067\u3001sse\u306e\u5834\u5408\u306f\u4e8c\u4e57\u8aa4\u5dee\u3068\u306a\u308a\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u4e8c\u4e57\u8aa4\u5dee\u3067\u3059\u3002\nlinear.output\u306fact.fct\u3092\u51fa\u529b\u5c64\u306e\u30cb\u30e5\u30fc\u30ed\u30f3\u306b\u9069\u7528\u3057\u306a\u3044\u5834\u5408\u306fTRUE\u306b\u3001\u9069\u7528\u3059\u308b\u5834\u5408\u306fFALSE\u306b\u3057\u307e\u3059\u3002\nact.fct\u306f\u6d3b\u6027\u5316\u95a2\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u95a2\u6570\u3068\u306a\u308a\u307e\u3059\u3002\nlikelihood\u304cTRUE\u306e\u3068\u304d\u3001\u8aa4\u5dee\u95a2\u6570\u304c\u8ca0\u306e\u5bfe\u6570\u5c24\u5ea6\u3068\u540c\u7b49\u3068\u306a\u308b\u5834\u5408\u306b\u60c5\u5831\u91cf\u898f\u6e96\u306eAIC\u3068BIC\u304c\u8a08\u7b97\u3055\u308c\u307e\u3059\u3002\n\u6b21\u306bgwplot\u3067\u5404\u5171\u5909\u91cf\u306e\u76ee\u7684\u5909\u6570\u306b\u5bfe\u3059\u308bGeneralized Weight\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u307e\u3059\u3002\n> par(mfrow = c(1,3))\n> gwplot(net.infert, selected.covariate=\"parity\", max=3.5, min=-2)\n> gwplot(net.infert, selected.covariate=\"parity\", max=3.5, min=-2)\n> gwplot(net.infert, selected.covariate=\"induced\", max=3.5, min=-2)\n> gwplot(net.infert, selected.covariate=\"spontaneous\", max=3.5, min=-2)\n\n\nGeneralized Weight\u306f\u5171\u5909\u91cf\u306e\u76ee\u7684\u5909\u6570\u3078\u306e\u5f71\u97ff\u5ea6\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u30020\u4ed8\u8fd1\u306b\u96c6\u307e\u308b\u5834\u5408\u306f\u4f59\u308a\u5f71\u97ff\u3092\u4e0e\u3048\u306a\u3044\u3053\u3068\u3092\u8868\u3057\u307e\u3059\u3002\nspontaneous\u306f\u4ed6\u3068\u6bd4\u8f03\u3059\u308b\u3068\u5f71\u97ff\u5ea6\u304c\u5927\u304d\u3044\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\u6700\u5f8c\u306bconfidence.interval\u3067Generalized Weight\u306e\u4fe1\u983c\u533a\u9593\u3068NIC\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\nconfidence.interval(net.infert)\n$lower.ci\n$lower.ci[[1]]\n$lower.ci[[1]][[1]]\n              [,1]\n[1,]  0.2378732931\n[2,] -0.7767930421\n[3,] -5.6821658449\n[4,] -8.7671639096\n\n$lower.ci[[1]][[2]]\n              [,1]\n[1,] -0.7548627922\n[2,] -6.4897821363\n\n\n\n$upper.ci\n$upper.ci[[1]]\n$upper.ci[[1]][[1]]\n             [,1]\n[1,] 2.8480852032\n[2,] 4.5389670051\n[3,] 0.7944060804\n[4,] 1.0157270261\n\n$upper.ci[[1]][[2]]\n              [,1]\n[1,]  4.3246718745\n[2,] -0.7591746629\n\n\n\n$nic\n[1] 135.6941297\n\n\n\u6b21\u306b\u3084\u308a\u305f\u3044\u3053\u3068\nR\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u4ed6\u306b\u3082\u300cnnet\u300d\u3068\u3044\u3046\u3082\u306e\u304c\u3042\u308b\u306e\u3067\u3001\u6b21\u306f\u305d\u308c\u3092\u89e6\u3063\u3066\u307f\u3088\u3046\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\nhttps://cran.r-project.org/web/packages/neuralnet/neuralnet.pdf\n\u3053\u306e\u8a18\u4e8b\u306f[\u30d5\u30ed\u30e0\u30b9\u30af\u30e9\u30c3\u30c1 Advent Calendar 2016](http://qiita.com/advent-calendar/2016/fromscratch)\u306e11\u65e5\u76ee\u306e\u8a18\u4e8b\u3067\u3059\u3002\n\n\u6700\u8fd1\u306fPython\u3067TensorFlow\u3084Chainer\u3092\u4f7f\u3063\u3066\u307f\u308b\u3053\u3068\u304c\u6d41\u884c\u3063\u3066\u3044\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u3042\u3048\u3066R\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\u3067\u3042\u308b[neuralnet](https://cran.r-project.org/web/packages/neuralnet/index.html)\u3092\u4f7f\u3063\u3066\u307f\u307e\u3057\u305f\u3002\n\n\u516c\u5f0f\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306e[neuralnet.pdf](https://cran.r-project.org/web/packages/neuralnet/neuralnet.pdf)\u306b\u3042\u308b\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u53c2\u8003\u306b\u3057\u307e\u3059\u3002\n\n# \u60f3\u5b9a\u8aad\u8005\n\n- \u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u3092\u52c9\u5f37\u3092\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u4eba\n- \u7d71\u8a08\u5b66\u306e\u52c9\u5f37\u3092\u3057\u305f\u3053\u3068\u304c\u3042\u308b\u4eba\n- R\u3092\u89e6\u3063\u305f\u3053\u3068\u304c\u3042\u308b\u4eba\n- R\u3067\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u3092\u4f7f\u3044\u305f\u3044\u4eba\n\n# \u6e96\u5099\n\n\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n> install.packages(\"neuralnet\")\n> library(\"neuralnet\")\n```\n\n# XOR\u554f\u984c\n\n\u5358\u7d14\u30d1\u30fc\u30bb\u30d7\u30c8\u30ed\u30f3\u3067\u306f\u5b66\u7fd2\u3067\u304d\u306a\u3044\u3001XOR\u306e\u5b66\u7fd2\u3092\u3057\u307e\u3059\u3002\n\u307e\u305a\u306f\u3001\u30c7\u30fc\u30bf\u306e\u6e96\u5099\u3002\n\n```\n> XOR <- c(0,1,1,0)\n> xor.data <- data.frame(expand.grid(c(0,1), c(0,1)), XOR)\n```\n\nxor.data\u306f\u3053\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```\n> xor.data\n  Var1 Var2 XOR\n1    0    0   0\n2    1    0   1\n3    0    1   1\n4    1    1   0\n```\n\n\u305d\u3057\u3066\u3001\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\n```\nnet.xor <- neuralnet(XOR~Var1+Var2, xor.data, hidden=4, rep=5)\n```\n\n\u7b2c1\u5f15\u6570\u306f\u30e2\u30c7\u30eb\u3001\u7b2c2\u5f15\u6570\u306f\u8a13\u7df4\u30c7\u30fc\u30bf\u3067\u3059\u3002\u307e\u305f\u3001`hidden`\u3067\u306f\u96a0\u308c\u30cb\u30e5\u30fc\u30ed\u30f3\u306e\u6570\u3092\u6307\u5b9a\u3057\u3001`rep`\u306f\u8a13\u7df4\u306e\u56de\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\uff08\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3067\u306f\u96a0\u308c\u30cb\u30e5\u30fc\u30ed\u30f3\u30922\u3068\u3057\u3066\u3044\u307e\u3057\u305f\u304c\u3001\u5b66\u7fd2\u306e\u7cbe\u5ea6\u304c\u4f4e\u304b\u3063\u305f\u306e\u30674\u306b\u3057\u3066\u3044\u307e\u3059\u3002\uff09\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3068\u3057\u3066\u306f\u3053\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n```\n> plot(net.xor, rep=\"best\")\n```\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/61088/8fb4481f-58e8-d3d4-c10d-e48843a8bb40.png)\n\n`rep=\"best\"`\u306b\u3088\u3063\u3066\u8aa4\u5dee\u304c\u6700\u3082\u5c0f\u3055\u304b\u3063\u305f\u3082\u306e\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u3066\u3044\u307e\u3059\u3002\n\nnet.xor\u304c\u6b63\u3057\u304fXOR\u3092\u8868\u3059\u3053\u3068\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\n```\n> xor.data[-3]\n  Var1 Var2\n1    0    0\n2    1    0\n3    0    1\n4    1    1\n\n> compute(net.xor, xor.data[-3])$net.result\n                [,1]\n[1,] -0.005591322981\n[2,]  0.991365312571\n[3,]  1.003765769383\n[4,]  0.006757999021\n```\n\n4\u3064\u306e\u5165\u529b\u306b\u5bfe\u3057\u3066\u3001\u305d\u308c\u305e\u308c\u6982\u306d\u6b63\u3057\u3044\u7b54\u3048\u304c\u5f97\u3089\u308c\u307e\u3057\u305f\u3002\n\n# \u4e0d\u598a\u30c7\u30fc\u30bf\u306e\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u56de\u5e30\n\n\u6b21\u306f\u4e0d\u598a\u306b\u95a2\u3059\u308b\u30c7\u30fc\u30bf\u3092\u6271\u3044\u307e\u3059\u3002\n\uff08\u30bb\u30f3\u30b7\u30c6\u30a3\u30d6\u306a\u30c7\u30fc\u30bf\u3067\u3059\u304c\u3001\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3067\u4f7f\u3063\u3066\u3044\u305f\u306e\u3067\u3002\u3002\uff09\n\n```\n> data(infert, package=\"datasets\")\n> infert\n    education age parity induced case spontaneous stratum pooled.stratum\n1      0-5yrs  26      6       1    1           2       1              3\n2      0-5yrs  42      1       1    1           0       2              1\n3      0-5yrs  39      6       2    1           0       3              4\n4      0-5yrs  34      4       2    1           0       4              2\n5     6-11yrs  35      3       1    1           1       5             32\n6     6-11yrs  36      4       2    1           1       6             36\n7     6-11yrs  23      1       0    1           0       7              6\n8     6-11yrs  32      2       0    1           0       8             22\n9     6-11yrs  21      1       0    1           1       9              5\n10    6-11yrs  28      2       0    1           0      10             19\n11    6-11yrs  29      2       1    1           0      11             20\n12    6-11yrs  37      4       2    1           1      12             37\n13    6-11yrs  31      1       1    1           0      13              9\n14    6-11yrs  29      3       2    1           0      14             29\n15    6-11yrs  31      2       1    1           1      15             21\n16    6-11yrs  27      2       2    1           0      16             18\n17    6-11yrs  30      5       2    1           1      17             38\n18    6-11yrs  26      1       0    1           1      18              7\n19    6-11yrs  25      3       2    1           1      19             28\n20    6-11yrs  44      1       0    1           1      20             17\n...(\u7701\u7565)\n [ reached getOption(\"max.print\") -- omitted 123 rows ]\n```\n\n\u30c7\u30fc\u30bf\u306e\u8aac\u660e\u306f[\u3053\u3061\u3089](http://www.is.titech.ac.jp/~mase/mase/html.jp/temp/infert.jp.html)\u3092\u3054\u53c2\u7167\u304f\u3060\u3055\u3044\u3002\n\u81ea\u7136\u30fb\u4eba\u5de5\u6d41\u7523\u5f8c\u306e\u4e0d\u598a\u75c7\u306b\u3064\u3044\u3066\u306e\u30c7\u30fc\u30bf\u3067\u3059\u3002\n\n\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\n\n```\nnet.infert <- neuralnet(case~parity+induced+spontaneous, infert,\u3000err.fct=\"ce\", linear.output=FALSE, likelihood=TRUE)\n```\n\n\u88ab\u9a13\u8005\u304b\u5bfe\u7167\u7fa4\u304b\u3092\u8868\u3059`case`\u3092\u76ee\u7684\u5909\u6570\u3068\u3057\u3001`parity`\uff08\u5b9f\u9a13\u56de\u6570\uff1f\uff09\u3001`induced`\uff08\u4eba\u5de5\u6d41\u7523\uff09\u3001`spontaneous`\uff08\u81ea\u7136\u6d41\u7523\uff09\u3092\u8aac\u660e\u5909\u6570\uff08\u5171\u5909\u91cf\uff09\u3068\u3057\u305f\u30e2\u30c7\u30eb\u3067\u3059\u3002\n`err.fct`\u306f\u8aa4\u5dee\u95a2\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002`ce`\u306e\u5834\u5408\u306f\u30af\u30ed\u30b9\u30a8\u30f3\u30c8\u30ed\u30d4\u30fc\u3067\u3001`sse`\u306e\u5834\u5408\u306f\u4e8c\u4e57\u8aa4\u5dee\u3068\u306a\u308a\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u4e8c\u4e57\u8aa4\u5dee\u3067\u3059\u3002\n`linear.output`\u306f`act.fct`\u3092\u51fa\u529b\u5c64\u306e\u30cb\u30e5\u30fc\u30ed\u30f3\u306b\u9069\u7528\u3057\u306a\u3044\u5834\u5408\u306f`TRUE`\u306b\u3001\u9069\u7528\u3059\u308b\u5834\u5408\u306f`FALSE`\u306b\u3057\u307e\u3059\u3002\n`act.fct`\u306f\u6d3b\u6027\u5316\u95a2\u6570\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30ed\u30b8\u30b9\u30c6\u30a3\u30c3\u30af\u95a2\u6570\u3068\u306a\u308a\u307e\u3059\u3002\n`likelihood`\u304c`TRUE`\u306e\u3068\u304d\u3001\u8aa4\u5dee\u95a2\u6570\u304c\u8ca0\u306e\u5bfe\u6570\u5c24\u5ea6\u3068\u540c\u7b49\u3068\u306a\u308b\u5834\u5408\u306b\u60c5\u5831\u91cf\u898f\u6e96\u306eAIC\u3068BIC\u304c\u8a08\u7b97\u3055\u308c\u307e\u3059\u3002\n\n\u6b21\u306b`gwplot`\u3067\u5404\u5171\u5909\u91cf\u306e\u76ee\u7684\u5909\u6570\u306b\u5bfe\u3059\u308bGeneralized Weight\u3092\u30d7\u30ed\u30c3\u30c8\u3057\u307e\u3059\u3002\n\n```\n> par(mfrow = c(1,3))\n> gwplot(net.infert, selected.covariate=\"parity\", max=3.5, min=-2)\n> gwplot(net.infert, selected.covariate=\"parity\", max=3.5, min=-2)\n> gwplot(net.infert, selected.covariate=\"induced\", max=3.5, min=-2)\n> gwplot(net.infert, selected.covariate=\"spontaneous\", max=3.5, min=-2)\n```\n\n![image](https://qiita-image-store.s3.amazonaws.com/0/61088/e663d215-1a27-5300-a482-f44c3ed629ce.png)\n\nGeneralized Weight\u306f\u5171\u5909\u91cf\u306e\u76ee\u7684\u5909\u6570\u3078\u306e\u5f71\u97ff\u5ea6\u3092\u8868\u3057\u3066\u3044\u307e\u3059\u30020\u4ed8\u8fd1\u306b\u96c6\u307e\u308b\u5834\u5408\u306f\u4f59\u308a\u5f71\u97ff\u3092\u4e0e\u3048\u306a\u3044\u3053\u3068\u3092\u8868\u3057\u307e\u3059\u3002\n`spontaneous`\u306f\u4ed6\u3068\u6bd4\u8f03\u3059\u308b\u3068\u5f71\u97ff\u5ea6\u304c\u5927\u304d\u3044\u306e\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u6700\u5f8c\u306b`confidence.interval`\u3067Generalized Weight\u306e\u4fe1\u983c\u533a\u9593\u3068NIC\u3092\u8a08\u7b97\u3057\u307e\u3059\u3002\n\n```\nconfidence.interval(net.infert)\n$lower.ci\n$lower.ci[[1]]\n$lower.ci[[1]][[1]]\n              [,1]\n[1,]  0.2378732931\n[2,] -0.7767930421\n[3,] -5.6821658449\n[4,] -8.7671639096\n\n$lower.ci[[1]][[2]]\n              [,1]\n[1,] -0.7548627922\n[2,] -6.4897821363\n\n\n\n$upper.ci\n$upper.ci[[1]]\n$upper.ci[[1]][[1]]\n             [,1]\n[1,] 2.8480852032\n[2,] 4.5389670051\n[3,] 0.7944060804\n[4,] 1.0157270261\n\n$upper.ci[[1]][[2]]\n              [,1]\n[1,]  4.3246718745\n[2,] -0.7591746629\n\n\n\n$nic\n[1] 135.6941297\n```\n\n# \u6b21\u306b\u3084\u308a\u305f\u3044\u3053\u3068\n\nR\u306e\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30d1\u30c3\u30b1\u30fc\u30b8\u306f\u4ed6\u306b\u3082\u300c[nnet](https://cran.r-project.org/web/packages/nnet/index.html)\u300d\u3068\u3044\u3046\u3082\u306e\u304c\u3042\u308b\u306e\u3067\u3001\u6b21\u306f\u305d\u308c\u3092\u89e6\u3063\u3066\u307f\u3088\u3046\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n# \u53c2\u8003\n\nhttps://cran.r-project.org/web/packages/neuralnet/neuralnet.pdf\n", "tags": ["R", "\u30cb\u30e5\u30fc\u30e9\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af"]}