{"context": "\n\npasteboardAsString\n\npasteboardAsString.scpt\nuse framework \"AppKit\"\nuse framework \"Foundation\"\n\nreturn my pasteboardAsString()\n\non pasteboardAsString()\n    --require framework: AppKit, Foundation\n    set pasteboard to current application's NSPasteboard's generalPasteboard\n    return (pasteboard's stringForType:(current application's NSPasteboardTypeString)) as text\nend pasteboardAsString\n\n\n\n\u66f4\u65b0\u5c65\u6b74\n\n2016-02-01: AppKit\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306eNSPasteboard\u30af\u30e9\u30b9\u3068NSAttributedString\u30af\u30e9\u30b9\u3092\u4f7f\u3063\u3066\u4f5c\u6210\n2016-09-24: stringForType\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\n\n\npasteboardAsHTML\n\npasteboardAsHTML.scpt\nuse framework \"AppKit\"\nuse framework \"Foundation\"\n\nreturn my pasteboardAsHTML()\n\non pasteboardAsHTML()\n    --require framework: AppKit, Foundation\n    set pasteboard to current application's NSPasteboard's generalPasteboard\n    set HTML to pasteboard's stringForType:(current application's NSPasteboardTypeHTML)\n    if HTML = missing value then\n        set RTF to pasteboard's dataForType:(current application's NSPasteboardTypeRTF)\n        if RTF = missing value then\n            error\n        end if\n        set attributedString to current application's NSAttributedString's alloc()'s initWithRTF:RTF documentAttributes:(missing value)\n        set attributes to current application's NSDictionary's dictionaryWithObject:(current application's NSHTMLTextDocumentType) forKey:(current application's NSDocumentTypeDocumentAttribute)\n        set HTMLData to attributedString's dataFromRange:{location:0, |length|:attributedString's |length|()} documentAttributes:attributes |error|:(missing value)\n        set HTML to current application's NSString's alloc()'s initWithData:HTMLData encoding:(current application's NSUTF8StringEncoding)\n    end if\n    return HTML as text\nend pasteboardAsHTML\n\n\n\n\u66f4\u65b0\u5c65\u6b74\n\n2016-02-01: AppKit\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306eNSPasteboard\u30af\u30e9\u30b9\u3068NSAttributedString\u30af\u30e9\u30b9\u3092\u4f7f\u3063\u3066\u4f5c\u6210\n2016-09-24: stringForType\u30e1\u30bd\u30c3\u30c9\u3068dataForType\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\n\n\n## pasteboardAsString\n\n```pasteboardAsString.scpt\nuse framework \"AppKit\"\nuse framework \"Foundation\"\n\nreturn my pasteboardAsString()\n\non pasteboardAsString()\n\t--require framework: AppKit, Foundation\n\tset pasteboard to current application's NSPasteboard's generalPasteboard\n\treturn (pasteboard's stringForType:(current application's NSPasteboardTypeString)) as text\nend pasteboardAsString\n```\n\n\n### \u66f4\u65b0\u5c65\u6b74\n\n* 2016-02-01: AppKit\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306eNSPasteboard\u30af\u30e9\u30b9\u3068NSAttributedString\u30af\u30e9\u30b9\u3092\u4f7f\u3063\u3066\u4f5c\u6210\n* 2016-09-24: `stringForType`\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\n\n\n\n## pasteboardAsHTML\n\n```pasteboardAsHTML.scpt\nuse framework \"AppKit\"\nuse framework \"Foundation\"\n\nreturn my pasteboardAsHTML()\n\non pasteboardAsHTML()\n\t--require framework: AppKit, Foundation\n\tset pasteboard to current application's NSPasteboard's generalPasteboard\n\tset HTML to pasteboard's stringForType:(current application's NSPasteboardTypeHTML)\n\tif HTML = missing value then\n\t\tset RTF to pasteboard's dataForType:(current application's NSPasteboardTypeRTF)\n\t\tif RTF = missing value then\n\t\t\terror\n\t\tend if\n\t\tset attributedString to current application's NSAttributedString's alloc()'s initWithRTF:RTF documentAttributes:(missing value)\n\t\tset attributes to current application's NSDictionary's dictionaryWithObject:(current application's NSHTMLTextDocumentType) forKey:(current application's NSDocumentTypeDocumentAttribute)\n\t\tset HTMLData to attributedString's dataFromRange:{location:0, |length|:attributedString's |length|()} documentAttributes:attributes |error|:(missing value)\n\t\tset HTML to current application's NSString's alloc()'s initWithData:HTMLData encoding:(current application's NSUTF8StringEncoding)\n\tend if\n\treturn HTML as text\nend pasteboardAsHTML\n```\n\n\n### \u66f4\u65b0\u5c65\u6b74\n\n* 2016-02-01: AppKit\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306eNSPasteboard\u30af\u30e9\u30b9\u3068NSAttributedString\u30af\u30e9\u30b9\u3092\u4f7f\u3063\u3066\u4f5c\u6210\n* 2016-09-24: `stringForType`\u30e1\u30bd\u30c3\u30c9\u3068`dataForType`\u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u7528\n\n\n\n", "tags": ["AppleScript"]}