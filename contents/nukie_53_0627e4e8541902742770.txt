{"tags": ["VBA"], "context": "\n\n\u6e2c\u5b9a\u6761\u4ef6\n\n\u5b9f\u884c\u74b0\u5883\uff1aWindows 10 Pro 64bit / Microsoft Excel 2016 64bit\n\u691c\u7d22\u6587\u5b57\u5217\uff1a2\u6587\u5b57\u76ee\u304c\"b\"\u3001\u6b8b\u308a\u304c\"a\"\u304b\u3089\u306a\u308b10\u4e07\u6587\u5b57\u306e\u6587\u5b57\u5217 \"abaaa....a\"\n\u30eb\u30fc\u30d7\u56de\u6570\uff1a1\u4e07\u56de\n\u6642\u9593\u6e2c\u5b9a\u65b9\u6cd5\uff1aVBA\u306eTimer\u95a2\u6570\u3092\u7528\u3044\u305f\u7c21\u6613\u8a08\u6e2c\n\n\n\u6e2c\u5b9a\u7d50\u679c\n\n\n\n\u65b9\u6cd5\n\u6642\u9593\uff08\u79d2\uff09\n\n\n\n\nInStr\u95a2\u6570\n0.141\n\n\nInStrRev\u95a2\u6570\n4.352\n\n\nLike\u6f14\u7b97\u5b50\n0.000\n\n\n\u6b63\u898f\u8868\u73fe\uff08\u4e8b\u524d\u30d0\u30a4\u30f3\u30c9\uff09\n0.008\n\n\n\u6b63\u898f\u8868\u73fe\uff08\u5b9f\u884c\u6642\u30d0\u30a4\u30f3\u30c9\uff09\n0.141\n\n\nReplace\u95a2\u6570\n1.563\n\n\n\n\n\u4f7f\u7528\u3057\u305f\u30b3\u30fc\u30c9\nSub \u7279\u5b9a\u306e1\u6587\u5b57\u691c\u7d22\u901f\u5ea6\u30d9\u30f3\u30c1\u30de\u30fc\u30af()\n'\u8981\u53c2\u7167\u8a2d\u5b9a\"Microsoft VBScript Regular Expression 5.5\"\n\n    '\u6761\u4ef6\n        '\u691c\u7d22\u6587\u5b57\u5217 \u3053\u306e\u4e2d\u304b\u3089\"b\"\u3092\u63a2\u3059\n        Dim tgtTxt As String\n        Let tgtTxt = \"ab\" & VBA.String$(99998, \"a\")\n\n        '\u30eb\u30fc\u30d7\u56de\u6570\n        Const LOOP_CNT& = 10000\n\n\n    '\u6e96\u5099\n        '\u4e8b\u524d\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u6b63\u898f\u8868\u73fe\n        Dim earlyBindRegExp As RegExp\n        Set earlyBindRegExp = New RegExp\n        Let earlyBindRegExp.Pattern = \"b\"\n\n        '\u5b9f\u884c\u6642\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u6b63\u898f\u8868\u73fe\n        Dim lateBindRegExp As Object\n        Set lateBindRegExp = New RegExp\n        Let lateBindRegExp.Pattern = \"b\"\n\n        '\u8a08\u6e2c\u3068\u304b\u30eb\u30fc\u30d7\u7528\n        Dim st!, i&, result As Boolean\n        Const MY_FORMAT$ = \"0.000\"\n\n    '----------------------------------------------------------\n\n    'Instr\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = (VBA.InStr(1, tgtTxt, \"b\") <> 0)\n    Next i\n    Debug.Print \"InStr\", VBA.Format$(Timer - st, MY_FORMAT)\n\n    '----------------------------------------------------------\n\n    'InstrRev\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = (VBA.InStrRev(tgtTxt, \"b\") <> 0)\n    Next i\n    Debug.Print \"InStrRev\", VBA.Format$(Timer - st, MY_FORMAT)\n\n    '----------------------------------------------------------\n\n    'Like\u6f14\u7b97\u5b50\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = (tgtTxt Like \"*b*\")\n    Next i\n    Debug.Print \"Like\", VBA.Format$(Timer - st, MY_FORMAT)\n\n    '----------------------------------------------------------\n\n    '\u4e8b\u524d\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u6b63\u898f\u8868\u73fe\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = earlyBindRegExp.Test(tgtTxt)\n    Next i\n    Debug.Print \"EarlyRegExp\", VBA.Format$(Timer - st, MY_FORMAT)\n\n    '----------------------------------------------------------\n\n    '\u5b9f\u884c\u6642\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u6b63\u898f\u8868\u73fe\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = lateBindRegExp.Test(tgtTxt)\n    Next i\n    Debug.Print \"LateRegExp\", VBA.Format$(Timer - st, MY_FORMAT)\n\n    '----------------------------------------------------------\n\n    'Replace\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = (VBA.Len(tgtTxt) <> VBA.Len(VBA.Replace(tgtTxt, \"b\", \"\")))\n    Next i\n    Debug.Print \"Replace\", VBA.Format$(Timer - st, MY_FORMAT)\n\nEnd Sub\n\n\n\u308f\u304b\u3063\u305f\u3053\u3068\n\u53c2\u7167\u8a2d\u5b9a\u7b49\u306e\u624b\u9593\u3092\u8003\u3048\u308b\u3068Like\u6f14\u7b97\u5b50\u304c\u6271\u3044\u3084\u3059\u304f\u3001\u51fa\u6765\u308b\u3053\u3068\u3082\u305d\u308c\u306a\u308a\u306b\u591a\u3044\u306e\u3067\u512a\u79c0\u3002\n\uff08\u305f\u3060\u3057Win7 64bit Excel 2010 32bit\u306e\u74b0\u5883\u3067\u306fInStr\u306e\u65b9\u304c\u65e9\u304b\u3063\u305f\u8a18\u61b6\u304c\u3042\u308b\u306e\u3067\u74b0\u5883\u306b\u3088\u3063\u3066\u306f\u5909\u5316\u3059\u308b\u304b\u3082\uff09\nInStr/InStrRev\u95a2\u6570\u306f\u8a72\u5f53\u6587\u5b57\u304c\u898b\u3064\u304b\u3063\u305f\u6642\u70b9\u3067\u51e6\u7406\u3092\u7d42\u4e86\u3057\u3066\u3044\u308b\u3002\n# \u6e2c\u5b9a\u6761\u4ef6\n+ \u5b9f\u884c\u74b0\u5883\uff1aWindows 10 Pro 64bit / Microsoft Excel 2016 64bit\n+ \u691c\u7d22\u6587\u5b57\u5217\uff1a2\u6587\u5b57\u76ee\u304c\"b\"\u3001\u6b8b\u308a\u304c\"a\"\u304b\u3089\u306a\u308b10\u4e07\u6587\u5b57\u306e\u6587\u5b57\u5217 \"abaaa....a\"\n+ \u30eb\u30fc\u30d7\u56de\u6570\uff1a1\u4e07\u56de\n+ \u6642\u9593\u6e2c\u5b9a\u65b9\u6cd5\uff1aVBA\u306eTimer\u95a2\u6570\u3092\u7528\u3044\u305f\u7c21\u6613\u8a08\u6e2c\n\n\n# \u6e2c\u5b9a\u7d50\u679c\n|\u65b9\u6cd5|\u6642\u9593\uff08\u79d2\uff09|\n|:---|---:|\n|InStr\u95a2\u6570|0.141|\n|InStrRev\u95a2\u6570| 4.352|\n|Like\u6f14\u7b97\u5b50| 0.000|\n|\u6b63\u898f\u8868\u73fe\uff08\u4e8b\u524d\u30d0\u30a4\u30f3\u30c9\uff09|  0.008|\n|\u6b63\u898f\u8868\u73fe\uff08\u5b9f\u884c\u6642\u30d0\u30a4\u30f3\u30c9\uff09| 0.141|\n|Replace\u95a2\u6570 |1.563|\n\n\n# \u4f7f\u7528\u3057\u305f\u30b3\u30fc\u30c9\n\n\n```vbnet\nSub \u7279\u5b9a\u306e1\u6587\u5b57\u691c\u7d22\u901f\u5ea6\u30d9\u30f3\u30c1\u30de\u30fc\u30af()\n'\u8981\u53c2\u7167\u8a2d\u5b9a\"Microsoft VBScript Regular Expression 5.5\"\n    \n    '\u6761\u4ef6\n        '\u691c\u7d22\u6587\u5b57\u5217 \u3053\u306e\u4e2d\u304b\u3089\"b\"\u3092\u63a2\u3059\n        Dim tgtTxt As String\n        Let tgtTxt = \"ab\" & VBA.String$(99998, \"a\")\n        \n        '\u30eb\u30fc\u30d7\u56de\u6570\n        Const LOOP_CNT& = 10000\n    \n    \n    '\u6e96\u5099\n        '\u4e8b\u524d\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u6b63\u898f\u8868\u73fe\n        Dim earlyBindRegExp As RegExp\n        Set earlyBindRegExp = New RegExp\n        Let earlyBindRegExp.Pattern = \"b\"\n        \n        '\u5b9f\u884c\u6642\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u6b63\u898f\u8868\u73fe\n        Dim lateBindRegExp As Object\n        Set lateBindRegExp = New RegExp\n        Let lateBindRegExp.Pattern = \"b\"\n        \n        '\u8a08\u6e2c\u3068\u304b\u30eb\u30fc\u30d7\u7528\n        Dim st!, i&, result As Boolean\n        Const MY_FORMAT$ = \"0.000\"\n    \n    '----------------------------------------------------------\n    \n    'Instr\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = (VBA.InStr(1, tgtTxt, \"b\") <> 0)\n    Next i\n    Debug.Print \"InStr\", VBA.Format$(Timer - st, MY_FORMAT)\n    \n    '----------------------------------------------------------\n    \n    'InstrRev\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = (VBA.InStrRev(tgtTxt, \"b\") <> 0)\n    Next i\n    Debug.Print \"InStrRev\", VBA.Format$(Timer - st, MY_FORMAT)\n    \n    '----------------------------------------------------------\n    \n    'Like\u6f14\u7b97\u5b50\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = (tgtTxt Like \"*b*\")\n    Next i\n    Debug.Print \"Like\", VBA.Format$(Timer - st, MY_FORMAT)\n    \n    '----------------------------------------------------------\n    \n    '\u4e8b\u524d\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u6b63\u898f\u8868\u73fe\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = earlyBindRegExp.Test(tgtTxt)\n    Next i\n    Debug.Print \"EarlyRegExp\", VBA.Format$(Timer - st, MY_FORMAT)\n    \n    '----------------------------------------------------------\n    \n    '\u5b9f\u884c\u6642\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u6b63\u898f\u8868\u73fe\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = lateBindRegExp.Test(tgtTxt)\n    Next i\n    Debug.Print \"LateRegExp\", VBA.Format$(Timer - st, MY_FORMAT)\n    \n    '----------------------------------------------------------\n    \n    'Replace\n    Let st = Timer\n    For i = 1 To LOOP_CNT\n        Let result = (VBA.Len(tgtTxt) <> VBA.Len(VBA.Replace(tgtTxt, \"b\", \"\")))\n    Next i\n    Debug.Print \"Replace\", VBA.Format$(Timer - st, MY_FORMAT)\n   \nEnd Sub\n```\n# \u308f\u304b\u3063\u305f\u3053\u3068\n\u53c2\u7167\u8a2d\u5b9a\u7b49\u306e\u624b\u9593\u3092\u8003\u3048\u308b\u3068Like\u6f14\u7b97\u5b50\u304c\u6271\u3044\u3084\u3059\u304f\u3001\u51fa\u6765\u308b\u3053\u3068\u3082\u305d\u308c\u306a\u308a\u306b\u591a\u3044\u306e\u3067\u512a\u79c0\u3002\n\uff08\u305f\u3060\u3057Win7 64bit Excel 2010 32bit\u306e\u74b0\u5883\u3067\u306fInStr\u306e\u65b9\u304c\u65e9\u304b\u3063\u305f\u8a18\u61b6\u304c\u3042\u308b\u306e\u3067\u74b0\u5883\u306b\u3088\u3063\u3066\u306f\u5909\u5316\u3059\u308b\u304b\u3082\uff09\n\nInStr/InStrRev\u95a2\u6570\u306f\u8a72\u5f53\u6587\u5b57\u304c\u898b\u3064\u304b\u3063\u305f\u6642\u70b9\u3067\u51e6\u7406\u3092\u7d42\u4e86\u3057\u3066\u3044\u308b\u3002\n\n"}