{"context": " More than 1 year has passed since last update.Python\u7528\u30af\u30ed\u30fc\u30ea\u30f3\u30b0\u517c\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3042\u308bScrapy\u3092\u4f7f\u7528\u3057\u3066\u3001Web\u30da\u30fc\u30b8\u306e\u30bf\u30a4\u30c8\u30eb\u3068URL\u3092\u518d\u5e30\u7684\u306b\u53d6\u5f97\u3057\u3066csv\u5f62\u5f0f\u306b\u51fa\u529b\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\uff08\u30b5\u30a4\u30c8\u30de\u30c3\u30d7\u7684\u306a\u3082\u306e\u3092\u30ea\u30b9\u30c8\u5316\u3059\u308b\u30a4\u30e1\u30fc\u30b8\u3067\u3057\u3087\u3046\u304b\uff09\n\u203b\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\nresult.csv\n\n\n\nURL\n\u30bf\u30a4\u30c8\u30eb\n\n\n\n\nhttp://www.example.com\n\u30c8\u30c3\u30d7\n\n\nhttp://www.example.com/news\n\u30cb\u30e5\u30fc\u30b9\n\n\nhttp://www.example.com/news/2015\n2015\u5e74\u306e\u30cb\u30e5\u30fc\u30b9\n\n\n\u2026\n\u2026\n\n\n\n\n\u74b0\u5883\n\nOS\uff1aCentOS7 (64bit)\nPython\u30d0\u30fc\u30b8\u30e7\u30f3\uff1a2.7.5 (CentOS7\u306b\u6a19\u6e96\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3082\u306e)\npip\u30d0\u30fc\u30b8\u30e7\u30f3\uff1a6.0.8\nScrapy\u30d0\u30fc\u30b8\u30e7\u30f3\uff1a0.24.5\n\n\nScrapy\u306e\u5c0e\u5165\nPython\u306fCentOS7\u306b\u6a19\u6e96\u30672.7\u7cfb\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u203b\u3061\u306a\u307f\u306b\u3001Scrapy\u306f\u73fe\u5728 Python 3\u7cfb\u3067\u306f\u52d5\u304d\u307e\u305b\u3093\u3002(\u5bfe\u5fdc\u306f\u9032\u3081\u3089\u308c\u3066\u3044\u307e\u3059\uff09\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3001pip\u304b\u3089Scrapy\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n$ sudo pip install Scrapy\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3001Scrapy\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n$ scrapy startproject HelloScrapy\n\u4f5c\u6210\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4e2d\u8eab\u306f\u4ee5\u4e0b\u306e\u69d8\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u3053\u306e\u4e2d\u3067\u3001\u4eca\u56de\u4f7f\u7528\u3059\u308b\u306e\u306f\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n\nitems.py\uff1a\u30b9\u30af\u30ec\u30a4\u30d7\u3057\u305f\u30c7\u30fc\u30bf\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\nsettings.py\uff1aScrapy\u306e\u69d8\u3005\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002(\u6307\u5b9a\u53ef\u80fd\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u306fScrapy\u306e\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\uff1ahttp://doc.scrapy.org/en/latest/topics/settings.html\u304b\u3089\u78ba\u8a8d\u3067\u304d\u307e\u3059\uff09\n\n\u307e\u305f\u3001Scrapy\u306f\u5bfe\u8c61\u306e\u30b5\u30a4\u30c8\u3092\u3069\u306e\u3088\u3046\u306b\u30af\u30ed\u30fc\u30eb\u3001\u30b9\u30af\u30ec\u30a4\u30d7\u3059\u308b\u304b\u3092\u5b9a\u7fa9\u3059\u308b\u305f\u3081\u306bSpider\u3068\u547c\u3070\u308c\u308b\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u3053\u306eSpider\u3092\u5b9a\u7fa9\u3059\u308b\u305f\u3081\u306b\u3001\u5148\u306espiders\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\"hellospider.py\"\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\u3053\u3053\u307e\u3067\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u69cb\u6210\u306f\u4ee5\u4e0b\u306e\u69d8\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n\n\nitems.py\n\u307e\u305a\u306fitems.py\u3092\u7de8\u96c6\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306fWeb\u30da\u30fc\u30b8\u306e\u30bf\u30a4\u30c8\u30eb\u3068URL\u3092\u53d6\u5f97\u3059\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\nitems.py\nfrom scrapy.item import Item, Field\n\nclass PageInfoItem(Item):\n    URL = Field()\n    title = Field()\n    pass\n\n\n\nsettings.py\n\u7d9a\u3044\u3066\u3001settings.py\u3092\u7de8\u96c6\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u79c1\u306f\u4ee5\u4e0b\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\n\n\nDOWNLOAD_DELAY \uff1a1\u3064\u306e\u30da\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304b\u3089\u3001\u6b21\u306e\u30da\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u3059\u308b\u307e\u3067\u306e\u9593\u9694\uff08\u5358\u4f4d\uff1a\u79d2\uff09\n\nROBOTSTXT_OBEY \uff1arobots.txt\u304c\u3042\u308b\u5834\u5408\u306f\u3001\u305d\u308c\u306b\u5f93\u3046\u304b\u3069\u3046\u304b\n\nDEPTH_LIMIT \uff1a\u518d\u5e30\u7684\u306b\u63a2\u67fb\u3092\u884c\u3046\u6df1\u3055\uff080\u306f\u7121\u5236\u9650\uff09\n\n\nsettings.py\nDOWNLOAD_DELAY = 3\nROBOTSTXT_OBEY = True\nDEPTH_LIMIT = 5\n\n\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u306e\u610f\u56f3\u306f\u3001\u76f8\u624b\u306e\u30b5\u30fc\u30d0\u30fc\u8ca0\u8377\u3092\u304b\u3051\u306a\u3044\u3088\u30463\u79d2\u7a0b\u5ea6\u306e\u30af\u30ed\u30fc\u30eb\u9593\u9694\u3092\u8a2d\u3051\u3001robots.txt\u306b\u5f93\u3063\u3066\u63a2\u67fb\u3092\u884c\u3044\u305f\u304b\u3063\u305f\u304b\u3089\u3067\u3059\u3002\n(AutoThrottle\u306b\u3088\u308b\u81ea\u52d5\u8abf\u6574\u3082\u3067\u304d\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u8a73\u3057\u304f\u77e5\u308a\u305f\u3044\u65b9\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u898b\u3066\u304f\u3060\u3055\u3044\uff09\n\u307e\u305f\u3001\u63a2\u67fb\u304c\u3042\u307e\u308a\u6df1\u3059\u304e\u3066\u3082\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u4eca\u56de\u306f\u5236\u9650\u3092\u8a2d\u3051\u3066\u3044\u307e\u3059\u3002\n\nhellospider.py\n\u6700\u5f8c\u306b\u3001\u672c\u547d\u3067\u3042\u308bhellospider\u306b\u81ea\u4f5c\u306eSpider\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\nhellospider.py\nfrom scrapy.contrib.spiders import CrawlSpider, Rule\nfrom scrapy.contrib.linkextractors import LinkExtractor\nfrom scrapy.selector import Selector\nfrom HelloScrapy.items import PageInfoItem\n\nclass HelloSpider(CrawlSpider):\n    # scrapy\u3092CLI\u304b\u3089\u5b9f\u884c\u3059\u308b\u3068\u304d\u306e\u8b58\u5225\u5b50\n    name = 'hello'\n    # spider\u306b\u63a2\u67fb\u3092\u8a31\u53ef\u3059\u308b\u30c9\u30e1\u30a4\u30f3\n    allowed_domains = [\"www.example.com\"]\n    # \u8d77\u70b9(\u63a2\u67fb\u3092\u958b\u59cb\u3059\u308b)URL\n    start_urls = [\"http://www.example.com\"]\n    # LinkExtractor\u306e\u5f15\u6570\u3067\u7279\u5b9a\u306e\u30eb\u30fc\u30eb(\u4f8b\u3048\u3070URL\u306bnew\u3092\u542b\u3080\u30da\u30fc\u30b8\u306e\u307f\u30b9\u30af\u30ec\u30a4\u30d7\u3059\u308b\u306a\u3069)\u3092\u6307\u5b9a\u53ef\u80fd\u3060\u304c\u3001\u4eca\u56de\u306f\u5168\u3066\u306e\u30da\u30fc\u30b8\u3092\u5bfe\u8c61\u3068\u3059\u308b\u305f\u3081\u5f15\u6570\u306f\u306a\u3057\n    # Rule\u306b\u30de\u30c3\u30c1\u3057\u305f\u30da\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3068\u3001callback\u306b\u6307\u5b9a\u3057\u305f\u95a2\u6570\u304c\u547c\u3070\u308c\u308b\n    # follow\u3092True\u306b\u3059\u308b\u3068\u3001\u518d\u5e30\u7684\u306b\u63a2\u67fb\u3092\u884c\u3046\n    rules = [Rule(LinkExtractor(), callback='parse_pageinfo', follow=True)]\n\n    def parse_pageinfo(self, response):\n        sel = Selector(response)\n        item = PageInfoItem()\n        item['URL'] = response.url\n        # \u30da\u30fc\u30b8\u306e\u3069\u306e\u90e8\u5206\u3092\u30b9\u30af\u30ec\u30a4\u30d7\u3059\u308b\u304b\u3092\u6307\u5b9a\n        # xPath\u5f62\u5f0f\u3067\u306e\u6307\u5b9a\u306b\u52a0\u3048\u3001CSS\u5f62\u5f0f\u3067\u306e\u6307\u5b9a\u3082\u53ef\u80fd\n        item['title'] = sel.xpath('/html/head/title/text()').extract()\n        return item\n\n\n\u5b8c\u6210\u3067\u3059\u3002\n\n\u5b9f\u884c\n\u5f8c\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308c\u3070\u3001\u6307\u5b9a\u3057\u305f\u8d77\u70b9URL\u304b\u3089\u518d\u5e30\u7684\u306b\u30af\u30ed\u30fc\u30eb\uff06\u30b9\u30af\u30ec\u30a4\u30d7\u304c\u5b9f\u884c\u3055\u308c\u3001\u7d50\u679c\u304ccsv\u3068\u3057\u3066\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n$ scrapy crawl hello -o result.csv\n(\u5f15\u6570\u306fhellospider.py\u3067\u306f\u306a\u304f\u3001\u305d\u306e\u4e2d\u3067\u5b9a\u7fa9\u3057\u305f\u8b58\u5225\u5b50\u3067\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044)\n\u3061\u306a\u307f\u306b\u3001\u7d50\u679c\u306fjson\u3084xml\u5f62\u5f0f\u3067\u3082\u51fa\u529b\u53ef\u80fd\u3067\u3059\u3002\n\u81ea\u4f5c\u306eWeb\u30b5\u30a4\u30c8\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\u901a\u308a\u306b\u51fa\u529b\u3067\u304d\u3066\u3044\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\u203b\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u4e0a\u306eWeb\u30b5\u30a4\u30c8\u306b\u5bfe\u3057\u3066\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f\u3001\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002\n\u53c2\u8003\uff1a\nhttp://doc.scrapy.org/en/latest/\nhttp://orangain.hatenablog.com/entry/scrapy\nhttp://akiniwa.hatenablog.jp/entry/2013/04/15/001411\nPython\u7528\u30af\u30ed\u30fc\u30ea\u30f3\u30b0\u517c\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3042\u308b**Scrapy**\u3092\u4f7f\u7528\u3057\u3066\u3001Web\u30da\u30fc\u30b8\u306e\u30bf\u30a4\u30c8\u30eb\u3068URL\u3092\u518d\u5e30\u7684\u306b\u53d6\u5f97\u3057\u3066csv\u5f62\u5f0f\u306b\u51fa\u529b\u3057\u3066\u307f\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\uff08\u30b5\u30a4\u30c8\u30de\u30c3\u30d7\u7684\u306a\u3082\u306e\u3092\u30ea\u30b9\u30c8\u5316\u3059\u308b\u30a4\u30e1\u30fc\u30b8\u3067\u3057\u3087\u3046\u304b\uff09\n\u203b\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\n**result.csv**\n\n| URL                               | \u30bf\u30a4\u30c8\u30eb   |\n|:----------------------------------|:----------|\n| `http://www.example.com`          | \u30c8\u30c3\u30d7     |\n| `http://www.example.com/news`     | \u30cb\u30e5\u30fc\u30b9   |\n| `http://www.example.com/news/2015`| 2015\u5e74\u306e\u30cb\u30e5\u30fc\u30b9 |\n| \u2026                                 | \u2026         |\n# \u74b0\u5883\n* OS\uff1aCentOS7 (64bit)\n* Python\u30d0\u30fc\u30b8\u30e7\u30f3\uff1a2.7.5 (CentOS7\u306b\u6a19\u6e96\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3082\u306e)\n* pip\u30d0\u30fc\u30b8\u30e7\u30f3\uff1a6.0.8\n* Scrapy\u30d0\u30fc\u30b8\u30e7\u30f3\uff1a0.24.5\n\n# Scrapy\u306e\u5c0e\u5165\nPython\u306fCentOS7\u306b\u6a19\u6e96\u30672.7\u7cfb\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u305d\u3061\u3089\u3092\u4f7f\u3044\u307e\u3059\u3002\n\u203b\u3061\u306a\u307f\u306b\u3001Scrapy\u306f\u73fe\u5728 Python 3\u7cfb\u3067\u306f\u52d5\u304d\u307e\u305b\u3093\u3002(\u5bfe\u5fdc\u306f\u9032\u3081\u3089\u308c\u3066\u3044\u307e\u3059\uff09\n\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3001pip\u304b\u3089Scrapy\u3092\u5c0e\u5165\u3057\u307e\u3059\u3002\n`$ sudo pip install Scrapy`\n\n# \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u4f5c\u6210\n\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u3001Scrapy\u7528\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n`$ scrapy startproject HelloScrapy`\n\n\u4f5c\u6210\u3057\u305f\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4e2d\u8eab\u306f\u4ee5\u4e0b\u306e\u69d8\u306b\u306a\u3063\u3066\u3044\u308b\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n![Scrapy_skeleton_half.png](https://qiita-image-store.s3.amazonaws.com/0/70865/b939c9af-9bc4-c4d0-07a0-14ad06afba9e.png)\n\n\u3053\u306e\u4e2d\u3067\u3001\u4eca\u56de\u4f7f\u7528\u3059\u308b\u306e\u306f\u4ee5\u4e0b\u306e\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\n\n* **items.py**\uff1a\u30b9\u30af\u30ec\u30a4\u30d7\u3057\u305f\u30c7\u30fc\u30bf\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306e\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n* **settings.py**\uff1aScrapy\u306e\u69d8\u3005\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002(\u6307\u5b9a\u53ef\u80fd\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u306fScrapy\u306e\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\uff1a[http://doc.scrapy.org/en/latest/topics/settings.html](http://doc.scrapy.org/en/latest/topics/settings.html)\u304b\u3089\u78ba\u8a8d\u3067\u304d\u307e\u3059\uff09\n\n\u307e\u305f\u3001Scrapy\u306f\u5bfe\u8c61\u306e\u30b5\u30a4\u30c8\u3092\u3069\u306e\u3088\u3046\u306b\u30af\u30ed\u30fc\u30eb\u3001\u30b9\u30af\u30ec\u30a4\u30d7\u3059\u308b\u304b\u3092\u5b9a\u7fa9\u3059\u308b\u305f\u3081\u306b**Spider**\u3068\u547c\u3070\u308c\u308b\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\u3053\u306eSpider\u3092\u5b9a\u7fa9\u3059\u308b\u305f\u3081\u306b\u3001\u5148\u306espiders\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\"hellospider.py\"\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\n\n\u3053\u3053\u307e\u3067\u3067\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u69cb\u6210\u306f\u4ee5\u4e0b\u306e\u69d8\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n![Scrapy_skeleton2_half.png](https://qiita-image-store.s3.amazonaws.com/0/70865/cff02523-6429-96b7-23a3-220b981a3ff0.png)\n\n# items.py\n\u307e\u305a\u306fitems.py\u3092\u7de8\u96c6\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u4eca\u56de\u306fWeb\u30da\u30fc\u30b8\u306e\u30bf\u30a4\u30c8\u30eb\u3068URL\u3092\u53d6\u5f97\u3059\u308b\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u69d8\u306a\u30af\u30e9\u30b9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```py:items.py\nfrom scrapy.item import Item, Field\n\nclass PageInfoItem(Item):\n\tURL = Field()\n\ttitle = Field()\n\tpass\n```\n\n# settings.py\n\u7d9a\u3044\u3066\u3001settings.py\u3092\u7de8\u96c6\u3057\u3066\u3044\u304d\u307e\u3059\u3002\n\u79c1\u306f\u4ee5\u4e0b\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f\u3002\n\n* **DOWNLOAD_DELAY** \uff1a1\u3064\u306e\u30da\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304b\u3089\u3001\u6b21\u306e\u30da\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u3059\u308b\u307e\u3067\u306e\u9593\u9694\uff08\u5358\u4f4d\uff1a\u79d2\uff09\n* **ROBOTSTXT_OBEY** \uff1arobots.txt\u304c\u3042\u308b\u5834\u5408\u306f\u3001\u305d\u308c\u306b\u5f93\u3046\u304b\u3069\u3046\u304b\n* **DEPTH_LIMIT** \uff1a\u518d\u5e30\u7684\u306b\u63a2\u67fb\u3092\u884c\u3046\u6df1\u3055\uff080\u306f\u7121\u5236\u9650\uff09\n\n```py:settings.py\nDOWNLOAD_DELAY = 3\nROBOTSTXT_OBEY = True\nDEPTH_LIMIT = 5\n```\n\n\u4e0a\u8a18\u306e\u8a2d\u5b9a\u306e\u610f\u56f3\u306f\u3001\u76f8\u624b\u306e\u30b5\u30fc\u30d0\u30fc\u8ca0\u8377\u3092\u304b\u3051\u306a\u3044\u3088\u30463\u79d2\u7a0b\u5ea6\u306e\u30af\u30ed\u30fc\u30eb\u9593\u9694\u3092\u8a2d\u3051\u3001robots.txt\u306b\u5f93\u3063\u3066\u63a2\u67fb\u3092\u884c\u3044\u305f\u304b\u3063\u305f\u304b\u3089\u3067\u3059\u3002\n(AutoThrottle\u306b\u3088\u308b\u81ea\u52d5\u8abf\u6574\u3082\u3067\u304d\u308b\u3088\u3046\u306a\u306e\u3067\u3001\u8a73\u3057\u304f\u77e5\u308a\u305f\u3044\u65b9\u306f\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u898b\u3066\u304f\u3060\u3055\u3044\uff09\n\u307e\u305f\u3001\u63a2\u67fb\u304c\u3042\u307e\u308a\u6df1\u3059\u304e\u3066\u3082\u6642\u9593\u304c\u304b\u304b\u308b\u306e\u3067\u3001\u4eca\u56de\u306f\u5236\u9650\u3092\u8a2d\u3051\u3066\u3044\u307e\u3059\u3002\n\n# hellospider.py\n\u6700\u5f8c\u306b\u3001\u672c\u547d\u3067\u3042\u308bhellospider\u306b\u81ea\u4f5c\u306eSpider\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\n```hellospider.py\nfrom scrapy.contrib.spiders import CrawlSpider, Rule\nfrom scrapy.contrib.linkextractors import LinkExtractor\nfrom scrapy.selector import Selector\nfrom HelloScrapy.items import PageInfoItem\n\nclass HelloSpider(CrawlSpider):\n    # scrapy\u3092CLI\u304b\u3089\u5b9f\u884c\u3059\u308b\u3068\u304d\u306e\u8b58\u5225\u5b50\n    name = 'hello'\n    # spider\u306b\u63a2\u67fb\u3092\u8a31\u53ef\u3059\u308b\u30c9\u30e1\u30a4\u30f3\n    allowed_domains = [\"www.example.com\"]\n    # \u8d77\u70b9(\u63a2\u67fb\u3092\u958b\u59cb\u3059\u308b)URL\n    start_urls = [\"http://www.example.com\"]\n    # LinkExtractor\u306e\u5f15\u6570\u3067\u7279\u5b9a\u306e\u30eb\u30fc\u30eb(\u4f8b\u3048\u3070URL\u306bnew\u3092\u542b\u3080\u30da\u30fc\u30b8\u306e\u307f\u30b9\u30af\u30ec\u30a4\u30d7\u3059\u308b\u306a\u3069)\u3092\u6307\u5b9a\u53ef\u80fd\u3060\u304c\u3001\u4eca\u56de\u306f\u5168\u3066\u306e\u30da\u30fc\u30b8\u3092\u5bfe\u8c61\u3068\u3059\u308b\u305f\u3081\u5f15\u6570\u306f\u306a\u3057\n    # Rule\u306b\u30de\u30c3\u30c1\u3057\u305f\u30da\u30fc\u30b8\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u3068\u3001callback\u306b\u6307\u5b9a\u3057\u305f\u95a2\u6570\u304c\u547c\u3070\u308c\u308b\n    # follow\u3092True\u306b\u3059\u308b\u3068\u3001\u518d\u5e30\u7684\u306b\u63a2\u67fb\u3092\u884c\u3046\n    rules = [Rule(LinkExtractor(), callback='parse_pageinfo', follow=True)]\n    \n    def parse_pageinfo(self, response):\n        sel = Selector(response)\n        item = PageInfoItem()\n        item['URL'] = response.url\n        # \u30da\u30fc\u30b8\u306e\u3069\u306e\u90e8\u5206\u3092\u30b9\u30af\u30ec\u30a4\u30d7\u3059\u308b\u304b\u3092\u6307\u5b9a\n        # xPath\u5f62\u5f0f\u3067\u306e\u6307\u5b9a\u306b\u52a0\u3048\u3001CSS\u5f62\u5f0f\u3067\u306e\u6307\u5b9a\u3082\u53ef\u80fd\n        item['title'] = sel.xpath('/html/head/title/text()').extract()\n        return item\n```\n\n\u5b8c\u6210\u3067\u3059\u3002\n# \u5b9f\u884c\n\u5f8c\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308c\u3070\u3001\u6307\u5b9a\u3057\u305f\u8d77\u70b9URL\u304b\u3089\u518d\u5e30\u7684\u306b\u30af\u30ed\u30fc\u30eb\uff06\u30b9\u30af\u30ec\u30a4\u30d7\u304c\u5b9f\u884c\u3055\u308c\u3001\u7d50\u679c\u304ccsv\u3068\u3057\u3066\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n`$ scrapy crawl hello -o result.csv`\n(\u5f15\u6570\u306fhellospider.py\u3067\u306f\u306a\u304f\u3001\u305d\u306e\u4e2d\u3067\u5b9a\u7fa9\u3057\u305f\u8b58\u5225\u5b50\u3067\u3042\u308b\u3053\u3068\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044)\n\n\u3061\u306a\u307f\u306b\u3001\u7d50\u679c\u306fjson\u3084xml\u5f62\u5f0f\u3067\u3082\u51fa\u529b\u53ef\u80fd\u3067\u3059\u3002\n\u81ea\u4f5c\u306eWeb\u30b5\u30a4\u30c8\u3067\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u304c\u3001\u5b8c\u6210\u30a4\u30e1\u30fc\u30b8\u901a\u308a\u306b\u51fa\u529b\u3067\u304d\u3066\u3044\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n**\u203b\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u4e0a\u306eWeb\u30b5\u30a4\u30c8\u306b\u5bfe\u3057\u3066\u5b9f\u884c\u3059\u308b\u5834\u5408\u306f\u3001\u81ea\u5df1\u8cac\u4efb\u3067\u304a\u9858\u3044\u3057\u307e\u3059\u3002**\n\n\u53c2\u8003\uff1a\n[http://doc.scrapy.org/en/latest/](http://doc.scrapy.org/en/latest/)\n[http://orangain.hatenablog.com/entry/scrapy](http://orangain.hatenablog.com/entry/scrapy)\n[http://akiniwa.hatenablog.jp/entry/2013/04/15/001411](http://akiniwa.hatenablog.jp/entry/2013/04/15/001411)\n", "tags": ["Python", "Scrapy"]}