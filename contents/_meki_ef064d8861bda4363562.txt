{"context": " More than 1 year has passed since last update.\n\n\u6982\u8981\nC# \u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u304b\u3089 Microsoft Word \u6587\u66f8\u3092\u4f5c\u6210\u30fb\u7de8\u96c6\u30fb\u4fdd\u5b58\u3059\u308b\u65b9\u6cd5\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u306e\u3067\u3001\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u63b2\u8f09\u3057\u307e\u3059\u3002\n\n\u6e96\u5099\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u53c2\u7167\u3092\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u30a8\u30af\u30b9\u30d7\u30ed\u30fc\u30e9\u306e [\u53c2\u7167\u306e\u8ffd\u52a0] \u3067\u3001 \"Microsoft.Office.Interop.Word\" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\uff08\u9805\u76ee\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u3068\u304d\u306f\u691c\u7d22\u30c0\u30a4\u30a2\u30ed\u30b0\u53f3\u4e0a\u306e\u691c\u7d22\u30d0\u30fc\u306b \"Word\" \u3068\u304b\u5165\u308c\u308b\u3068\u3067\u3066\u304d\u307e\u3059\uff09\n\n\n\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u4ee5\u4e0b\u306b\u63b2\u8f09\u3059\u308b\u306e\u306f\u3001\n\n\u306e\u3088\u3046\u306a\u30ef\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb (out.docx) \u3092\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3059\u308b\u305f\u3081\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\u30b3\u30fc\u30c9\u81ea\u4f53\u306f\u305d\u308c\u307b\u3069\u96e3\u3057\u304f\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u79c1\u306e\u7406\u89e3\u3057\u305f\u7bc4\u56f2\u3067\u306f\u3001 Document \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7de8\u96c6\u3059\u308b\u3068\u304d\u306f Document \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u3089\u8272\u3005\u306a\u65b9\u6cd5\u3067 Range \u3092\u62bd\u51fa\u3057\u3066\u7de8\u96c6\u64cd\u4f5c\u3092\u884c\u3046\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing Microsoft.Office.Interop.Word;\nusing Word = Microsoft.Office.Interop.Word;\n\nnamespace WordSample\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            try\n            {\n\n                // Word \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n                Word.Application word = new Word.Application();\n                // Word \u306e GUI \u3092\u8d77\u52d5\u3057\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n                word.Visible = false;\n\n                // \u65b0\u898f\u6587\u66f8\u3092\u4f5c\u6210\n                Document document = word.Documents.Add();\n\n                // \u30d8\u30c3\u30c0\u30fc\u3092\u7de8\u96c6\n                editHeaderSample(ref document, 10, WdColorIndex.wdPink, \"Header Area\");\n\n                // \u30d5\u30c3\u30bf\u30fc\u3092\u7de8\u96c6\n                editFooterSample(ref document, 10, WdColorIndex.wdBlue, \"Footer Area\");\n\n                // \u898b\u51fa\u3057\u3092\u8ffd\u52a0\n                addHeadingSample(ref document, \"\u898b\u51fa\u3057\");\n\n                // \u30d1\u30e9\u30b0\u30e9\u30d5\u3092\u8ffd\u52a0\n                document.Content.Paragraphs.Add();\n\n                // \u30c6\u30ad\u30b9\u30c8\u3092\u8ffd\u52a0\n                addTextSample(ref document, WdColorIndex.wdGreen, \"Hello, \");\n                addTextSample(ref document, WdColorIndex.wdRed, \"World\");\n\n                // \u540d\u524d\u3092\u4ed8\u3051\u3066\u4fdd\u5b58\n                object filename = System.IO.Directory.GetCurrentDirectory() + @\"\\out.docx\";\n                document.SaveAs2(ref filename);\n\n                // \u6587\u66f8\u3092\u9589\u3058\u308b\n                document.Close();\n                document = null;\n                word.Quit();\n                word = null;\n\n                Console.WriteLine(\"Document created successfully !\");\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine(ex.Message);\n            }\n        }\n\n        /// <summary>\n        /// \u6587\u66f8\u306e\u30d8\u30c3\u30c0\u30fc\u3092\u7de8\u96c6\u3059\u308b.\n        /// </summary>\n        private static void editHeaderSample(ref Document document, int fontSize, WdColorIndex color, string text)\n        {\n            foreach (Section section in document.Sections)\n            {\n                //Get the header range and add the header details.\n                Range headerRange = section.Headers[WdHeaderFooterIndex.wdHeaderFooterPrimary].Range;\n                headerRange.Fields.Add(headerRange, WdFieldType.wdFieldPage);\n                headerRange.ParagraphFormat.Alignment = WdParagraphAlignment.wdAlignParagraphCenter;\n                headerRange.Font.ColorIndex = color;\n                headerRange.Font.Size = fontSize;\n                headerRange.Text = text;\n            }\n        }\n\n        /// <summary>\n        /// \u6587\u66f8\u306e\u30d5\u30c3\u30bf\u30fc\u3092\u7de8\u96c6\u3059\u308b.\n        /// </summary>\n        private static void editFooterSample(ref Document document, int fontSize, WdColorIndex color, string text)\n        {\n            foreach (Section wordSection in document.Sections)\n            {\n                //Get the footer range and add the footer details.\n                Range footerRange = wordSection.Footers[WdHeaderFooterIndex.wdHeaderFooterPrimary].Range;\n                footerRange.Font.ColorIndex = color;\n                footerRange.Font.Size = fontSize;\n                footerRange.ParagraphFormat.Alignment = WdParagraphAlignment.wdAlignParagraphCenter;\n                footerRange.Text = text;\n            }\n        }\n\n        /// <summary>\n        /// \u6587\u66f8\u306b\u898b\u51fa\u3057\u3092\u8ffd\u52a0\u3059\u308b.\n        /// </summary>\n        private static void addHeadingSample(ref Document document, string text)\n        {\n            Paragraph para = document.Content.Paragraphs.Add(System.Reflection.Missing.Value);\n            object styleHeading1 = \"\u898b\u51fa\u3057 1\";\n            para.Range.set_Style(ref styleHeading1);\n            para.Range.Text = text;\n            para.Range.InsertParagraphAfter();\n        }\n\n        /// <summary>\n        /// \u6587\u66f8\u306e\u672b\u5c3e\u4f4d\u7f6e\u3092\u53d6\u5f97\u3059\u308b.\n        /// </summary>\n        /// <returns></returns>\n        private static int getLastPosition(ref Document document)\n        {\n            return document.Content.End - 1;\n        }\n\n        /// <summary>\n        /// \u6587\u66f8\u306e\u672b\u5c3e\u306b\u30c6\u30ad\u30b9\u30c8\u3092\u8ffd\u52a0\u3059\u308b.\n        /// </summary>\n        private static void addTextSample(ref Document document, WdColorIndex color, string text)\n        {\n            int before = getLastPosition(ref document);\n            Range rng = document.Range(document.Content.End - 1, document.Content.End - 1);\n            rng.Text += text;\n            int after = getLastPosition(ref document);\n\n            document.Range(before, after).Font.ColorIndex = color;\n        }\n    }\n}\n\n# \u6982\u8981\n\nC# \u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u304b\u3089 Microsoft Word \u6587\u66f8\u3092\u4f5c\u6210\u30fb\u7de8\u96c6\u30fb\u4fdd\u5b58\u3059\u308b\u65b9\u6cd5\u3092\u8abf\u3079\u3066\u307f\u307e\u3057\u305f\u306e\u3067\u3001\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3092\u63b2\u8f09\u3057\u307e\u3059\u3002\n\n# \u6e96\u5099\n\n\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u53c2\u7167\u3092\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\u30bd\u30ea\u30e5\u30fc\u30b7\u30e7\u30f3\u30a8\u30af\u30b9\u30d7\u30ed\u30fc\u30e9\u306e [\u53c2\u7167\u306e\u8ffd\u52a0] \u3067\u3001 \"Microsoft.Office.Interop.Word\" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\uff08\u9805\u76ee\u304c\u898b\u3064\u304b\u3089\u306a\u3044\u3068\u304d\u306f\u691c\u7d22\u30c0\u30a4\u30a2\u30ed\u30b0\u53f3\u4e0a\u306e\u691c\u7d22\u30d0\u30fc\u306b \"Word\" \u3068\u304b\u5165\u308c\u308b\u3068\u3067\u3066\u304d\u307e\u3059\uff09\n\n![001.jpg](https://qiita-image-store.s3.amazonaws.com/0/14284/dfe8775e-abda-f36a-ade1-dde48deffb44.jpeg)\n\n# \u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\n\u4ee5\u4e0b\u306b\u63b2\u8f09\u3059\u308b\u306e\u306f\u3001\n![002.jpg](https://qiita-image-store.s3.amazonaws.com/0/14284/801d85a7-652f-6516-7c2d-f9ee5b92fe35.jpeg)\n\u306e\u3088\u3046\u306a\u30ef\u30fc\u30c9\u30d5\u30a1\u30a4\u30eb (out.docx) \u3092\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u3068\u540c\u3058\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u4f5c\u6210\u3059\u308b\u305f\u3081\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3059\u3002\n\n\u30b3\u30fc\u30c9\u81ea\u4f53\u306f\u305d\u308c\u307b\u3069\u96e3\u3057\u304f\u306a\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\u79c1\u306e\u7406\u89e3\u3057\u305f\u7bc4\u56f2\u3067\u306f\u3001 Document \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7de8\u96c6\u3059\u308b\u3068\u304d\u306f Document \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304b\u3089\u8272\u3005\u306a\u65b9\u6cd5\u3067 Range \u3092\u62bd\u51fa\u3057\u3066\u7de8\u96c6\u64cd\u4f5c\u3092\u884c\u3046\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n```csharp\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing Microsoft.Office.Interop.Word;\nusing Word = Microsoft.Office.Interop.Word;\n\nnamespace WordSample\n{\n\tclass Program\n\t{\n\t\tstatic void Main(string[] args)\n\t\t{\n\n\t\t\ttry\n\t\t\t{\n\n\t\t\t\t// Word \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u4f5c\u6210\n\t\t\t\tWord.Application word = new Word.Application();\n\t\t\t\t// Word \u306e GUI \u3092\u8d77\u52d5\u3057\u306a\u3044\u3088\u3046\u306b\u3059\u308b\n\t\t\t\tword.Visible = false;\n\n\t\t\t\t// \u65b0\u898f\u6587\u66f8\u3092\u4f5c\u6210\n\t\t\t\tDocument document = word.Documents.Add();\n\n\t\t\t\t// \u30d8\u30c3\u30c0\u30fc\u3092\u7de8\u96c6\n\t\t\t\teditHeaderSample(ref document, 10, WdColorIndex.wdPink, \"Header Area\");\n\n\t\t\t\t// \u30d5\u30c3\u30bf\u30fc\u3092\u7de8\u96c6\n\t\t\t\teditFooterSample(ref document, 10, WdColorIndex.wdBlue, \"Footer Area\");\n\n\t\t\t\t// \u898b\u51fa\u3057\u3092\u8ffd\u52a0\n\t\t\t\taddHeadingSample(ref document, \"\u898b\u51fa\u3057\");\n\n\t\t\t\t// \u30d1\u30e9\u30b0\u30e9\u30d5\u3092\u8ffd\u52a0\n\t\t\t\tdocument.Content.Paragraphs.Add();\n\n\t\t\t\t// \u30c6\u30ad\u30b9\u30c8\u3092\u8ffd\u52a0\n\t\t\t\taddTextSample(ref document, WdColorIndex.wdGreen, \"Hello, \");\n\t\t\t\taddTextSample(ref document, WdColorIndex.wdRed, \"World\");\n\n\t\t\t\t// \u540d\u524d\u3092\u4ed8\u3051\u3066\u4fdd\u5b58\n\t\t\t\tobject filename = System.IO.Directory.GetCurrentDirectory() + @\"\\out.docx\";\n\t\t\t\tdocument.SaveAs2(ref filename);\n\n\t\t\t\t// \u6587\u66f8\u3092\u9589\u3058\u308b\n\t\t\t\tdocument.Close();\n\t\t\t\tdocument = null;\n\t\t\t\tword.Quit();\n\t\t\t\tword = null;\n\n\t\t\t\tConsole.WriteLine(\"Document created successfully !\");\n\t\t\t}\n\t\t\tcatch (Exception ex)\n\t\t\t{\n\t\t\t\tConsole.WriteLine(ex.Message);\n\t\t\t}\n\t\t}\n\n\t\t/// <summary>\n\t\t/// \u6587\u66f8\u306e\u30d8\u30c3\u30c0\u30fc\u3092\u7de8\u96c6\u3059\u308b.\n\t\t/// </summary>\n\t\tprivate static void editHeaderSample(ref Document document, int fontSize, WdColorIndex color, string text)\n\t\t{\n\t\t\tforeach (Section section in document.Sections)\n\t\t\t{\n\t\t\t\t//Get the header range and add the header details.\n\t\t\t\tRange headerRange = section.Headers[WdHeaderFooterIndex.wdHeaderFooterPrimary].Range;\n\t\t\t\theaderRange.Fields.Add(headerRange, WdFieldType.wdFieldPage);\n\t\t\t\theaderRange.ParagraphFormat.Alignment = WdParagraphAlignment.wdAlignParagraphCenter;\n\t\t\t\theaderRange.Font.ColorIndex = color;\n\t\t\t\theaderRange.Font.Size = fontSize;\n\t\t\t\theaderRange.Text = text;\n\t\t\t}\n\t\t}\n\n\t\t/// <summary>\n\t\t/// \u6587\u66f8\u306e\u30d5\u30c3\u30bf\u30fc\u3092\u7de8\u96c6\u3059\u308b.\n\t\t/// </summary>\n\t\tprivate static void editFooterSample(ref Document document, int fontSize, WdColorIndex color, string text)\n\t\t{\n\t\t\tforeach (Section wordSection in document.Sections)\n\t\t\t{\n\t\t\t\t//Get the footer range and add the footer details.\n\t\t\t\tRange footerRange = wordSection.Footers[WdHeaderFooterIndex.wdHeaderFooterPrimary].Range;\n\t\t\t\tfooterRange.Font.ColorIndex = color;\n\t\t\t\tfooterRange.Font.Size = fontSize;\n\t\t\t\tfooterRange.ParagraphFormat.Alignment = WdParagraphAlignment.wdAlignParagraphCenter;\n\t\t\t\tfooterRange.Text = text;\n\t\t\t}\n\t\t}\n\n\t\t/// <summary>\n\t\t/// \u6587\u66f8\u306b\u898b\u51fa\u3057\u3092\u8ffd\u52a0\u3059\u308b.\n\t\t/// </summary>\n\t\tprivate static void addHeadingSample(ref Document document, string text)\n\t\t{\n\t\t\tParagraph para = document.Content.Paragraphs.Add(System.Reflection.Missing.Value);\n\t\t\tobject styleHeading1 = \"\u898b\u51fa\u3057 1\";\n\t\t\tpara.Range.set_Style(ref styleHeading1);\n\t\t\tpara.Range.Text = text;\n\t\t\tpara.Range.InsertParagraphAfter();\n\t\t}\n\n\t\t/// <summary>\n\t\t/// \u6587\u66f8\u306e\u672b\u5c3e\u4f4d\u7f6e\u3092\u53d6\u5f97\u3059\u308b.\n\t\t/// </summary>\n\t\t/// <returns></returns>\n\t\tprivate static int getLastPosition(ref Document document)\n\t\t{\n\t\t\treturn document.Content.End - 1;\n\t\t}\n\n\t\t/// <summary>\n\t\t/// \u6587\u66f8\u306e\u672b\u5c3e\u306b\u30c6\u30ad\u30b9\u30c8\u3092\u8ffd\u52a0\u3059\u308b.\n\t\t/// </summary>\n\t\tprivate static void addTextSample(ref Document document, WdColorIndex color, string text)\n\t\t{\n\t\t\tint before = getLastPosition(ref document);\n\t\t\tRange rng = document.Range(document.Content.End - 1, document.Content.End - 1);\n\t\t\trng.Text += text;\n\t\t\tint after = getLastPosition(ref document);\n\n\t\t\tdocument.Range(before, after).Font.ColorIndex = color;\n\t\t}\n\t}\n}\n```\n", "tags": ["C#", "Word"]}