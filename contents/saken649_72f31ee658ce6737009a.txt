{"context": "\u672a\u3060\u306bHyper-V+Docker\u306ePHP\u958b\u767a\u74b0\u5883\u304c\u843d\u3061\u7740\u304b\u306a\u3044\u3002\n\u4eca\u5ea6\u306fDocker\u30b3\u30f3\u30c6\u30ca\u5316\u3057\u305fMariaDB\u306b\u3001\u8af8\u3005\u306e\u30a2\u30d7\u30ea\u304b\u3089\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u554f\u984c\u304c\u52c3\u767a\u3057\u305f\u306e\u3067\u3001\u305d\u306e\u8a66\u884c\u932f\u8aa4\u5de5\u7a0b\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n\u74b0\u5883\n\nWindows10 Proffesional\nHyper-V\nDocker for Windows\n\n\n\u4f55\u304cMariaDB\u306b\u7e4b\u304c\u3089\u306a\u3044\uff1f\n\nA5:SQL mk-2\nCakePHP2\n\n\u3084\u3063\u3066\u307f\u308b\u3068\u5bfe\u51e6\u6cd5\u304c\u9055\u3044\u307e\u3057\u305f\u3002\n\n\u73fe\u72b6\u306e\u69cb\u6210\n\u73fe\u72b6docker-compose.yml\u306b\u8a18\u8f09\u3057\u3066\u3044\u308b\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\ndocker-compose.yml\nversion: '2'\nservices:\n  mariadb:\n    container_name: mariadb\n    image: mariadb:user\n    ports:\n      - '3306:3306'\n    volumes:\n      - db:/var/lib/mysql\n    privileged: true\n    command: /sbin/init\n  php_app:\n    container_name: php_app\n    image: php7:user\n    expose:\n      - '9000'\n    ports:\n      - '8080:80'\n    volumes:\n      - ../app_dir/:/var/www/html\n    depends_on:\n      - mariadb\n    privileged: true\n    command: /sbin/init\nvolumes:\n  db:\n\n\n\ndocker_ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                            NAMES\n2814f7b46798        php7:user           \"/sbin/init\"        5 days ago          Up 3 hours          9000/tcp, 0.0.0.0:8080->80/tcp   php_app\nc376bb48006c        mariadb:user        \"/sbin/init\"        5 days ago          Up 3 hours          0.0.0.0:3306->3306/tcp           mariadb\n\n\n\nmariadb:user\n\u516c\u5f0f\u306ecentos\u30b3\u30f3\u30c6\u30ca(CentOS7)\u306bMariaDB\u3092\u624b\u52d5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3082\u306e\u3002\n\u5358\u7d14\u306bUbuntu\u306b\u6163\u308c\u3066\u3044\u306a\u3044\u306e\u3068\u3001\u30af\u30a8\u30ea\u30ed\u30b0\u306e\u8a2d\u5b9a\u3092\u4e88\u3081\u3057\u3066\u304a\u304d\u305f\u304b\u3063\u305f\u306e\u3067\u81ea\u4f5c\u3002\nphp7:user\n\u3053\u308c\u3082\u516c\u5f0fcentos\u30b3\u30f3\u30c6\u30ca\u306bPHP7.1\u3068XDebug\u3092\u624b\u52d5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3082\u306e\u3002\n\u540c\u3058\u304fUbuntu\u306b\u6163\u308c\u3066\u3044\u306a\u3044\u306e\u3068\u3001XDebug\u306e\u8a2d\u5b9a\u3092\u4e88\u3081\u3057\u3066\u304a\u304d\u305f\u304b\u3063\u305f\u306e\u3067\u81ea\u4f5c\u3002\n\n\nA5:SQL\u304c\u7e4b\u304c\u3089\u306a\u3044\uff01\n\n\u30a8\u30e9\u30fc\u5185\u5bb9\n\u300c#28000Access denied for user 'root'@'gateway' (using password: NO)\u300d\n\n\u30db\u30b9\u30c8\u540d: localhost (\u30dd\u30fc\u30c8: 3306)\n\u30e6\u30fc\u30b6\u30fc\u540d: root\n\u30d1\u30b9\u30ef\u30fc\u30c9\u7121\u3057\u3002\ndocker exec\u3057\u305f\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u304b\u3089\u306e\u30ed\u30b0\u30a4\u30f3\u306f\u53ef\u80fd\u3002\n\n\u8a66\u884c\u932f\u8aa4\n\u3069\u3046\u3084\u3089\u5916\u90e8\u30a2\u30af\u30bb\u30b9\u95a2\u9023\u306e\u8a2d\u5b9a\u304c\u602a\u3057\u3044\u3002\n\nMariaDB\nMariaDB [mysql]> SELECT `Host`, `User`, `Password` FROM user;\n+--------------+------+-------------------------------------------+\n| Host         | User | Password                                  |\n+--------------+------+-------------------------------------------+\n| localhost    | root |                                           |\n| 2814f7b46798 | root |                                           |\n| 127.0.0.1    | root |                                           |\n| ::1          | root |                                           |\n| localhost    |      |                                           |\n| 2814f7b46798 |      |                                           |\n+--------------+------+-------------------------------------------+\n6 rows in set (0.00 sec)\n\n\n\u203b\u300c2814f7b46798\u300d\u306fphp_app\u30b3\u30f3\u30c6\u30ca\u306e\u30b3\u30f3\u30c6\u30caID\u3067\u3059\u3002\n\u3053\u3053\u304b\u3089\u8aad\u307f\u53d6\u308b\u9650\u308a\u3001\u3053\u306eMaraDB\u306b\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u30db\u30b9\u30c8\u306f\u300clocalhost\u300d\u300c127.0.0.1\u300d\u300cphp_app\u300d\u30b3\u30f3\u30c6\u30ca\u306e3\u3064\u3002\n\u300c::1\u300d\u306f\u3001\n\n/etc/hosts\nsh-4.2# cat /etc/hosts\n127.0.0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\n\n\n\u3068\u306e\u3053\u3068\u3067\u3001\u6050\u3089\u304f\u300clocalhost\u300d\u3068\u540c\u7fa9\u3002\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u898b\u308b\u9650\u308a\u3001\u300cgateway\u300d\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u6271\u3044\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3001\u305d\u308c\u3058\u3083\u3042\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u307e\u305b\u3093\u306d\u3002\n\n\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\n\u3068\u3044\u3046\u308f\u3051\u3067\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u308a\u307e\u3059\u3002\n\nMariaDB\nMariaDB [(none)]> USE mysql;\nDatabase changed\n\n-- a5m2\u30e6\u30fc\u30b6\u30fc\u3092\u3001gateway\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u7528\u30e6\u30fc\u30b6\u30fc\u3068\u3057\u3066\u4f5c\u6210\nMariaDB [mysql]> CREATE USER a5m2@gateway IDENTIFIED BY 'a5m2';\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [mysql]> SELECT `Host`, `User`, `Password` FROM user;\n+--------------+------+-------------------------------------------+\n| Host         | User | Password                                  |\n+--------------+------+-------------------------------------------+\n| localhost    | root |                                           |\n| 2814f7b46798 | root |                                           |\n| 127.0.0.1    | root |                                           |\n| ::1          | root |                                           |\n| localhost    |      |                                           |\n| 2814f7b46798 |      |                                           |\n| gateway      | a5m2 | *7367A95690040CB321E09B233CC56FCCB6AB2E0A |\n+--------------+------+-------------------------------------------+\n7 rows in set (0.00 sec)\n\n-- a5m2\u30e6\u30fc\u30b6\u30fc\u306b\u5168\u6a29\u9650\u3092\u8a2d\u5b9a\nMariaDB [mysql]> GRANT ALL PRIVILEGES ON *.* TO a5m2@gateway WITH GRANT OPTION;\nQuery OK, 0 rows affected (0.00 sec)\n\n\nHost\u306f\u300c%\u300d(Host\u304c\u4f55\u3067\u3082\u53ef)\u3067\u3082\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u3064\u307e\u308a\u306f\u8ab0\u3067\u3082\u30a2\u30af\u30bb\u30b9\u53ef\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u3044\u304f\u3089\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3068\u306f\u3044\u3048\u3001\u3061\u3087\u3063\u3068\u826f\u304f\u306a\u3044\u4e0a\u3001\u4eca\u56de\u306fHost\u304c\u3061\u3083\u3093\u3068\u5206\u304b\u3063\u3066\u3044\u308b\u306e\u3067\u6307\u5b9a\u3057\u307e\u3057\u305f\u3002\n\u6539\u3081\u3066A5:SQL\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n\u30db\u30b9\u30c8\u540d: localhost (\u30dd\u30fc\u30c8: 3306)\n\u30e6\u30fc\u30b6\u30fc\u540d: a5m2\n\u30d1\u30b9\u30ef\u30fc\u30c9: a5m2\n\u3053\u308c\u3067A5SQL\u304b\u3089\u7e4b\u304c\u308a\u307e\u3057\u305f\u3002\u4e00\u4ef6\u843d\u7740\u3002\n\n\u539f\u56e0\nWindows\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u306flocalhost\u3067\u306f\u306a\u304f\u5916\u90e8\u30db\u30b9\u30c8\u6271\u3044\u306b\u306a\u308b\u3089\u3057\u304f\u3001\u305d\u306e\u30db\u30b9\u30c8\u304b\u3089\u306e\u63a5\u7d9a\u8a2d\u5b9a\u304c\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u3002\n\u3088\u3063\u3066\u3001Windows\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u7528\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u3063\u3066\u89e3\u6c7a\u3002\n\nCakePHP2\u304b\u3089\u3082\u7e4b\u304c\u3089\u306a\u3044\uff01\n\u30d8\u30fc\u30a4\uff01\u4eca\u5ea6\u306f\u4f55\u30c7\u30b9\u30ab\u30fc\uff01\uff1f\n\n\u30a8\u30e9\u30fc\u5185\u5bb9\nDatabase connection \"Mysql\" is missing, or could not be created.\nSQLSTATE[HY000] [2002] Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2)\n\n\napp/Config/database.php\npublic $default = array(\n    'datasource' => 'Database/Mysql',\n    'persistent' => false,\n    'host' => 'localhost',\n    'login' => 'root',\n    'password' => '',\n    'database' => 'database',\n    'prefix' => '',\n    'encoding' => 'utf8',\n);\n\n\nA5:SQL\u304c\u7e4b\u304c\u3063\u305f\u3068\u601d\u3063\u305f\u3089\u4eca\u5ea6\u306fCakePHP2\u304b\u3089\u30a8\u30e9\u30fc\u304c\u3002\n\u307e\u30fc\u305flocalhost\u3058\u3083\u7e4b\u304c\u3089\u306a\u3044\u306e\u304b\u3002\u3002\n\n\u8a66\u884c\u932f\u8aa4\n\u4e00\u65e6\u300chost\u300d\u3092\u30eb\u30fc\u30d7\u30d0\u30c3\u30af\u30a2\u30c9\u30ec\u30b9\u3067\u3042\u308b127.0.0.1\u306b\u3057\u3066\u307f\u307e\u3059\u3002\nDatabase connection \"Mysql\" is missing, or could not be created.\nSQLSTATE[HY000] [2003] Can't connect to MySQL server on '127.0.0.1' (111)\n\n\u72b6\u6cc1\u5909\u308f\u3089\u305a\u3002\nDocker\u3067\u5225\u30b3\u30f3\u30c6\u30ca\u306b\u3059\u308b\uff1d\u5225\u30db\u30b9\u30c8\u3067DB\u304c\u52d5\u3044\u3066\u3044\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\nMariaDB\nMariaDB [mysql]> SELECT `Host`, `User`, `Password` FROM user;\n+--------------+------+-------------------------------------------+\n| Host         | User | Password                                  |\n+--------------+------+-------------------------------------------+\n| localhost    | root |                                           |\n| 2814f7b46798 | root |                                           |\n| 127.0.0.1    | root |                                           |\n| ::1          | root |                                           |\n| localhost    |      |                                           |\n| 2814f7b46798 |      |                                           |\n| gateway      | a5m2 | *7367A95690040CB321E09B233CC56FCCB6AB2E0A |\n+--------------+------+-------------------------------------------+\n7 rows in set (0.00 sec)\n\n\n\u3068\u306f\u3044\u3048\u3001\u30b3\u30f3\u30c6\u30caID\u304c\u3061\u3083\u3093\u3068mysql.user\u30c6\u30fc\u30d6\u30eb\u306b\u3082\u3042\u308b\u306e\u3067\u3001\u7e4b\u304c\u308a\u305d\u3046\u306a\u3082\u306e\u3067\u3059\u304c\u3001\u7e4b\u304c\u3089\u306a\u3044\u306e\u306f\u4f55\u6545\u306a\u3093\u3067\u3057\u3087\u3046\u306d\u3002\n\n\u63a5\u7d9a\u5148\u306e\u5909\u66f4\n\u91c8\u7136\u3068\u3057\u307e\u305b\u3093\u304c\u3001\u4eca\u5ea6\u306fIP\u76f4\u6307\u5b9a\u3057\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u306fMariaDB\u30b3\u30f3\u30c6\u30ca\u306eIP\u3092\u8abf\u3079\u307e\u3059\u3002\n\n/etc/hosts\nsh-4.2# cat /etc/hosts\n127.0.0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n172.18.0.3      c376bb48006c\n\n\n\ndocker_ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                            NAMES\n2814f7b46798        php7:user           \"/sbin/init\"        5 days ago          Up 3 hours          9000/tcp, 0.0.0.0:8080->80/tcp   php_app\nc376bb48006c        mariadb:user        \"/sbin/init\"        5 days ago          Up 3 hours          0.0.0.0:3306->3306/tcp           mariadb\n\n\nMariaDB\u30b3\u30f3\u30c6\u30ca\u306e\u30b3\u30f3\u30c6\u30caID\u304c\u300cc376bb48006c\u300d\u306a\u306e\u3067\u3001\u6050\u3089\u304f\u300c172.10.0.3\u300d\u3068\u3044\u3046\u306e\u304c\u3053\u306e\u30b3\u30f3\u30c6\u30ca\u306eIP\u3067\u3057\u3087\u3046\u3002\n\napp/Config/database.php\npublic $default = array(\n    'datasource' => 'Database/Mysql',\n    'persistent' => false,\n    'host' => '172.10.0.3',\n    'login' => 'root',\n    'password' => '',\n    'database' => 'database',\n    'prefix' => '',\n    'encoding' => 'utf8',\n);\n\n\n\u3055\u3066\u3002\nDatabase connection \"Mysql\" is missing, or could not be created.\nSQLSTATE[28000] [1045] Access denied for user 'root'@'ic_v3.dockercompose_default' (using password: NO)\n\n\u30db\u30b9\u30c8\u540d\u304c\u304a\u304b\u3057\u3044\u3067\u3059\u306d\u2026\uff1f\n\u8a66\u3057\u306b\u5148\u7a0b\u4f5c\u3063\u305fa5m2\u30e6\u30fc\u30b6\u30fc\u3067\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\napp/Config/database.php\npublic $default = array(\n    'datasource' => 'Database/Mysql',\n    'persistent' => false,\n    'host' => '172.10.0.3',\n    'login' => 'a5m2',\n    'password' => 'a5m2',\n    'database' => 'database',\n    'prefix' => '',\n    'encoding' => 'utf8',\n);\n\n\nCakePHP is able to connect to the database.\n\n\u7121\u4e8b\u7e4b\u304c\u308a\u306f\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u4f55\u304b\u91c8\u7136\u3068\u3057\u306a\u3044\u3002\u3002\n\u3053\u308c\u3082\u300cgateway\u300d\u30db\u30b9\u30c8\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3068\u898b\u306a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u3002\u3002\n\n\u539f\u56e0\n\u5225\u30b3\u30f3\u30c6\u30ca\uff1d\u5225\u30db\u30b9\u30c8\u3089\u3057\u3044\u306e\u3067\u3001DB\u30b3\u30f3\u30c6\u30ca\u306eIP\u3092\u8abf\u3079\u3066\u76f4\u306b\u6307\u5b9a\u3059\u308b\u3002\n\u305d\u306e\u969b\u306f\u3001\u30db\u30b9\u30c8PC\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3068\u306a\u308b\u3089\u3057\u3044\uff1f\u306e\u3067\u3001\u30db\u30b9\u30c8\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u306e\u3068\u540c\u7b49\u306e\u6a29\u9650\u3092\u6301\u3063\u305f\u30e6\u30fc\u30b6\u30fc\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n\u307e\u3068\u3081\n\u3068\u308a\u3042\u3048\u305a\u3001\u5916\u90e8\u30db\u30b9\u30c8\u304b\u3089\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u3066root\u540c\u69d8\u306e\u6a29\u9650\u3092\u6301\u3064\u30e6\u30fc\u30b6\u30fc\u3092MariaDB\u4e0a\u306b\u4f5c\u3089\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\n\u305d\u3057\u3066\u3001\u57fa\u672c\u305d\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f7f\u3063\u3066\u30a2\u30ec\u30b3\u30ec\u3059\u308b\u3002\n\n\u304a\u307e\u3051\n\u516c\u5f0f\u306eMariaDB\u30b3\u30f3\u30c6\u30ca\u3092\u4f7f\u308f\u305a\u306b\u3001\u81ea\u4f5c\u3057\u305f\u304b\u3089\u968f\u6240\u3067\u30cf\u30de\u3063\u3066\u3044\u308b\u3088\u3046\u306a\u6c17\u304c\u3057\u306a\u304f\u3082\u306a\u3044\u3067\u3059\u3002\nUbuntu\u3092\u907f\u3051\u3066\u304d\u307e\u3057\u305f\u304c\u3001\u3053\u3053\u3089\u3067Ubuntu\u306b\u3082\u6163\u308c\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u306d\u3002\u3002\n\u63a2\u3057\u65b9\u304c\u60aa\u3044\u306e\u304b\u3001\u30b3\u30f3\u30c6\u30ca\u9023\u643a\u3084\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u3067\u306e\u904b\u7528\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u304c\u610f\u5916\u3068\u5c11\u306a\u304f\u3066\u3001\u5272\u3068\u624b\u5f53\u305f\u308a\u6b21\u7b2c\u3084\u3063\u3066\u308b\u611f\u304c\u5f37\u3044\u3067\u3059\u3002\nHyper-V+Docker\u3067\u306ePHP\u958b\u767a\u74b0\u5883\u69cb\u7bc9\u306f\u3001\u307e\u3060\u307e\u3060\u524d\u9014\u591a\u96e3\u306a\u3088\u3046\u3067\u3059\u3002\u3002\n\u672a\u3060\u306bHyper-V+Docker\u306ePHP\u958b\u767a\u74b0\u5883\u304c\u843d\u3061\u7740\u304b\u306a\u3044\u3002\n\u4eca\u5ea6\u306fDocker\u30b3\u30f3\u30c6\u30ca\u5316\u3057\u305fMariaDB\u306b\u3001\u8af8\u3005\u306e\u30a2\u30d7\u30ea\u304b\u3089\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u306a\u3044\u554f\u984c\u304c\u52c3\u767a\u3057\u305f\u306e\u3067\u3001\u305d\u306e\u8a66\u884c\u932f\u8aa4\u5de5\u7a0b\u3092\u307e\u3068\u3081\u307e\u3057\u305f\u3002\n\n# \u74b0\u5883\n\n- Windows10 Proffesional\n- Hyper-V\n- Docker for Windows\n\n# \u4f55\u304cMariaDB\u306b\u7e4b\u304c\u3089\u306a\u3044\uff1f\n\n- A5:SQL mk-2\n- CakePHP2\n\n\u3084\u3063\u3066\u307f\u308b\u3068\u5bfe\u51e6\u6cd5\u304c\u9055\u3044\u307e\u3057\u305f\u3002\n\n# \u73fe\u72b6\u306e\u69cb\u6210\n\n\u73fe\u72b6docker-compose.yml\u306b\u8a18\u8f09\u3057\u3066\u3044\u308b\u5185\u5bb9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002\n\n```docker-compose.yml\nversion: '2'\nservices:\n  mariadb:\n    container_name: mariadb\n    image: mariadb:user\n    ports:\n      - '3306:3306'\n    volumes:\n      - db:/var/lib/mysql\n    privileged: true\n    command: /sbin/init\n  php_app:\n    container_name: php_app\n    image: php7:user\n    expose:\n      - '9000'\n    ports:\n      - '8080:80'\n    volumes:\n      - ../app_dir/:/var/www/html\n    depends_on:\n      - mariadb\n    privileged: true\n    command: /sbin/init\nvolumes:\n  db:\n```\n\n\n```bash:docker_ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                            NAMES\n2814f7b46798        php7:user           \"/sbin/init\"        5 days ago          Up 3 hours          9000/tcp, 0.0.0.0:8080->80/tcp   php_app\nc376bb48006c        mariadb:user        \"/sbin/init\"        5 days ago          Up 3 hours          0.0.0.0:3306->3306/tcp           mariadb\n```\n\n- mariadb:user  \n\u516c\u5f0f\u306ecentos\u30b3\u30f3\u30c6\u30ca(CentOS7)\u306bMariaDB\u3092\u624b\u52d5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3082\u306e\u3002  \n\u5358\u7d14\u306bUbuntu\u306b\u6163\u308c\u3066\u3044\u306a\u3044\u306e\u3068\u3001\u30af\u30a8\u30ea\u30ed\u30b0\u306e\u8a2d\u5b9a\u3092\u4e88\u3081\u3057\u3066\u304a\u304d\u305f\u304b\u3063\u305f\u306e\u3067\u81ea\u4f5c\u3002\n- php7:user  \n\u3053\u308c\u3082\u516c\u5f0fcentos\u30b3\u30f3\u30c6\u30ca\u306bPHP7.1\u3068XDebug\u3092\u624b\u52d5\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u3082\u306e\u3002  \n\u540c\u3058\u304fUbuntu\u306b\u6163\u308c\u3066\u3044\u306a\u3044\u306e\u3068\u3001XDebug\u306e\u8a2d\u5b9a\u3092\u4e88\u3081\u3057\u3066\u304a\u304d\u305f\u304b\u3063\u305f\u306e\u3067\u81ea\u4f5c\u3002\n\n# A5:SQL\u304c\u7e4b\u304c\u3089\u306a\u3044\uff01\n### \u30a8\u30e9\u30fc\u5185\u5bb9\n\n```\n\u300c#28000Access denied for user 'root'@'gateway' (using password: NO)\u300d\n```\n\n\u30db\u30b9\u30c8\u540d: `localhost` (\u30dd\u30fc\u30c8: 3306)\n\u30e6\u30fc\u30b6\u30fc\u540d: `root`\n\u30d1\u30b9\u30ef\u30fc\u30c9\u7121\u3057\u3002\ndocker exec\u3057\u305f\u30b3\u30f3\u30bd\u30fc\u30eb\u4e0a\u304b\u3089\u306e\u30ed\u30b0\u30a4\u30f3\u306f\u53ef\u80fd\u3002\n\n### \u8a66\u884c\u932f\u8aa4\n\n\u3069\u3046\u3084\u3089\u5916\u90e8\u30a2\u30af\u30bb\u30b9\u95a2\u9023\u306e\u8a2d\u5b9a\u304c\u602a\u3057\u3044\u3002\n\n```MariaDB:MariaDB\nMariaDB [mysql]> SELECT `Host`, `User`, `Password` FROM user;\n+--------------+------+-------------------------------------------+\n| Host         | User | Password                                  |\n+--------------+------+-------------------------------------------+\n| localhost    | root |                                           |\n| 2814f7b46798 | root |                                           |\n| 127.0.0.1    | root |                                           |\n| ::1          | root |                                           |\n| localhost    |      |                                           |\n| 2814f7b46798 |      |                                           |\n+--------------+------+-------------------------------------------+\n6 rows in set (0.00 sec)\n```\n\n\u203b\u300c2814f7b46798\u300d\u306fphp_app\u30b3\u30f3\u30c6\u30ca\u306e\u30b3\u30f3\u30c6\u30caID\u3067\u3059\u3002\n\n\u3053\u3053\u304b\u3089\u8aad\u307f\u53d6\u308b\u9650\u308a\u3001\u3053\u306eMaraDB\u306b\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u30db\u30b9\u30c8\u306f\u300clocalhost\u300d\u300c127.0.0.1\u300d\u300cphp_app\u300d\u30b3\u30f3\u30c6\u30ca\u306e3\u3064\u3002\n\u300c::1\u300d\u306f\u3001\n\n```bash:/etc/hosts\nsh-4.2# cat /etc/hosts\n127.0.0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\n```\n\n\u3068\u306e\u3053\u3068\u3067\u3001\u6050\u3089\u304f\u300clocalhost\u300d\u3068\u540c\u7fa9\u3002\n\n\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u898b\u308b\u9650\u308a\u3001\u300cgateway\u300d\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u6271\u3044\u306b\u306a\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3001\u305d\u308c\u3058\u3083\u3042\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u307e\u305b\u3093\u306d\u3002\n\n### \u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\n\u3068\u3044\u3046\u308f\u3051\u3067\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u308b\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u308a\u307e\u3059\u3002\n\n```MariaDB:MariaDB\nMariaDB [(none)]> USE mysql;\nDatabase changed\n\n-- a5m2\u30e6\u30fc\u30b6\u30fc\u3092\u3001gateway\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u7528\u30e6\u30fc\u30b6\u30fc\u3068\u3057\u3066\u4f5c\u6210\nMariaDB [mysql]> CREATE USER a5m2@gateway IDENTIFIED BY 'a5m2';\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [mysql]> SELECT `Host`, `User`, `Password` FROM user;\n+--------------+------+-------------------------------------------+\n| Host         | User | Password                                  |\n+--------------+------+-------------------------------------------+\n| localhost    | root |                                           |\n| 2814f7b46798 | root |                                           |\n| 127.0.0.1    | root |                                           |\n| ::1          | root |                                           |\n| localhost    |      |                                           |\n| 2814f7b46798 |      |                                           |\n| gateway      | a5m2 | *7367A95690040CB321E09B233CC56FCCB6AB2E0A |\n+--------------+------+-------------------------------------------+\n7 rows in set (0.00 sec)\n\n-- a5m2\u30e6\u30fc\u30b6\u30fc\u306b\u5168\u6a29\u9650\u3092\u8a2d\u5b9a\nMariaDB [mysql]> GRANT ALL PRIVILEGES ON *.* TO a5m2@gateway WITH GRANT OPTION;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\nHost\u306f\u300c%\u300d(Host\u304c\u4f55\u3067\u3082\u53ef)\u3067\u3082\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u3064\u307e\u308a\u306f\u8ab0\u3067\u3082\u30a2\u30af\u30bb\u30b9\u53ef\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u3044\u304f\u3089\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3068\u306f\u3044\u3048\u3001\u3061\u3087\u3063\u3068\u826f\u304f\u306a\u3044\u4e0a\u3001\u4eca\u56de\u306fHost\u304c\u3061\u3083\u3093\u3068\u5206\u304b\u3063\u3066\u3044\u308b\u306e\u3067\u6307\u5b9a\u3057\u307e\u3057\u305f\u3002\n\n\u6539\u3081\u3066A5:SQL\u306e\u8a2d\u5b9a\u3092\u3057\u307e\u3059\u3002\n\u30db\u30b9\u30c8\u540d: `localhost` (\u30dd\u30fc\u30c8: 3306)\n\u30e6\u30fc\u30b6\u30fc\u540d: `a5m2`\n\u30d1\u30b9\u30ef\u30fc\u30c9: `a5m2`\n\n\u3053\u308c\u3067A5SQL\u304b\u3089\u7e4b\u304c\u308a\u307e\u3057\u305f\u3002\u4e00\u4ef6\u843d\u7740\u3002\n\n### \u539f\u56e0\n\nWindows\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u306flocalhost\u3067\u306f\u306a\u304f\u5916\u90e8\u30db\u30b9\u30c8\u6271\u3044\u306b\u306a\u308b\u3089\u3057\u304f\u3001\u305d\u306e\u30db\u30b9\u30c8\u304b\u3089\u306e\u63a5\u7d9a\u8a2d\u5b9a\u304c\u3055\u308c\u3066\u3044\u306a\u304b\u3063\u305f\u3002\n\u3088\u3063\u3066\u3001Windows\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u7528\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u3063\u3066\u89e3\u6c7a\u3002\n\n# CakePHP2\u304b\u3089\u3082\u7e4b\u304c\u3089\u306a\u3044\uff01\n\n\u30d8\u30fc\u30a4\uff01\u4eca\u5ea6\u306f\u4f55\u30c7\u30b9\u30ab\u30fc\uff01\uff1f\n\n### \u30a8\u30e9\u30fc\u5185\u5bb9\n\n```\nDatabase connection \"Mysql\" is missing, or could not be created.\nSQLSTATE[HY000] [2002] Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2)\n```\n\n```php:app/Config/database.php\npublic $default = array(\n    'datasource' => 'Database/Mysql',\n    'persistent' => false,\n    'host' => 'localhost',\n    'login' => 'root',\n    'password' => '',\n    'database' => 'database',\n    'prefix' => '',\n    'encoding' => 'utf8',\n);\n```\n\nA5:SQL\u304c\u7e4b\u304c\u3063\u305f\u3068\u601d\u3063\u305f\u3089\u4eca\u5ea6\u306fCakePHP2\u304b\u3089\u30a8\u30e9\u30fc\u304c\u3002\n\u307e\u30fc\u305flocalhost\u3058\u3083\u7e4b\u304c\u3089\u306a\u3044\u306e\u304b\u3002\u3002\n\n### \u8a66\u884c\u932f\u8aa4\n\n\u4e00\u65e6\u300chost\u300d\u3092\u30eb\u30fc\u30d7\u30d0\u30c3\u30af\u30a2\u30c9\u30ec\u30b9\u3067\u3042\u308b`127.0.0.1`\u306b\u3057\u3066\u307f\u307e\u3059\u3002\n\n```\nDatabase connection \"Mysql\" is missing, or could not be created.\nSQLSTATE[HY000] [2003] Can't connect to MySQL server on '127.0.0.1' (111)\n```\n\n\u72b6\u6cc1\u5909\u308f\u3089\u305a\u3002\nDocker\u3067\u5225\u30b3\u30f3\u30c6\u30ca\u306b\u3059\u308b\uff1d\u5225\u30db\u30b9\u30c8\u3067DB\u304c\u52d5\u3044\u3066\u3044\u308b\u3001\u3068\u3044\u3046\u3053\u3068\u306a\u306e\u3067\u3057\u3087\u3046\u304b\u3002\n\n```MariaDB:MariaDB\nMariaDB [mysql]> SELECT `Host`, `User`, `Password` FROM user;\n+--------------+------+-------------------------------------------+\n| Host         | User | Password                                  |\n+--------------+------+-------------------------------------------+\n| localhost    | root |                                           |\n| 2814f7b46798 | root |                                           |\n| 127.0.0.1    | root |                                           |\n| ::1          | root |                                           |\n| localhost    |      |                                           |\n| 2814f7b46798 |      |                                           |\n| gateway      | a5m2 | *7367A95690040CB321E09B233CC56FCCB6AB2E0A |\n+--------------+------+-------------------------------------------+\n7 rows in set (0.00 sec)\n```\n\n\u3068\u306f\u3044\u3048\u3001\u30b3\u30f3\u30c6\u30caID\u304c\u3061\u3083\u3093\u3068mysql.user\u30c6\u30fc\u30d6\u30eb\u306b\u3082\u3042\u308b\u306e\u3067\u3001\u7e4b\u304c\u308a\u305d\u3046\u306a\u3082\u306e\u3067\u3059\u304c\u3001\u7e4b\u304c\u3089\u306a\u3044\u306e\u306f\u4f55\u6545\u306a\u3093\u3067\u3057\u3087\u3046\u306d\u3002\n\n### \u63a5\u7d9a\u5148\u306e\u5909\u66f4\n\u91c8\u7136\u3068\u3057\u307e\u305b\u3093\u304c\u3001\u4eca\u5ea6\u306fIP\u76f4\u6307\u5b9a\u3057\u3066\u307f\u307e\u3059\u3002\n\u307e\u305a\u306fMariaDB\u30b3\u30f3\u30c6\u30ca\u306eIP\u3092\u8abf\u3079\u307e\u3059\u3002\n\n```bash:/etc/hosts\nsh-4.2# cat /etc/hosts\n127.0.0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n172.18.0.3      c376bb48006c\n```\n\n```bash:docker_ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                            NAMES\n2814f7b46798        php7:user           \"/sbin/init\"        5 days ago          Up 3 hours          9000/tcp, 0.0.0.0:8080->80/tcp   php_app\nc376bb48006c        mariadb:user        \"/sbin/init\"        5 days ago          Up 3 hours          0.0.0.0:3306->3306/tcp           mariadb\n```\n\nMariaDB\u30b3\u30f3\u30c6\u30ca\u306e\u30b3\u30f3\u30c6\u30caID\u304c\u300cc376bb48006c\u300d\u306a\u306e\u3067\u3001\u6050\u3089\u304f\u300c172.10.0.3\u300d\u3068\u3044\u3046\u306e\u304c\u3053\u306e\u30b3\u30f3\u30c6\u30ca\u306eIP\u3067\u3057\u3087\u3046\u3002\n\n```php:app/Config/database.php\npublic $default = array(\n    'datasource' => 'Database/Mysql',\n    'persistent' => false,\n    'host' => '172.10.0.3',\n    'login' => 'root',\n    'password' => '',\n    'database' => 'database',\n    'prefix' => '',\n    'encoding' => 'utf8',\n);\n```\n\n\u3055\u3066\u3002\n\n```\nDatabase connection \"Mysql\" is missing, or could not be created.\nSQLSTATE[28000] [1045] Access denied for user 'root'@'ic_v3.dockercompose_default' (using password: NO)\n```\n\n\u30db\u30b9\u30c8\u540d\u304c\u304a\u304b\u3057\u3044\u3067\u3059\u306d\u2026\uff1f\n\u8a66\u3057\u306b\u5148\u7a0b\u4f5c\u3063\u305fa5m2\u30e6\u30fc\u30b6\u30fc\u3067\u8a66\u3057\u3066\u307f\u307e\u3059\u3002\n\n```php:app/Config/database.php\npublic $default = array(\n    'datasource' => 'Database/Mysql',\n    'persistent' => false,\n    'host' => '172.10.0.3',\n    'login' => 'a5m2',\n    'password' => 'a5m2',\n    'database' => 'database',\n    'prefix' => '',\n    'encoding' => 'utf8',\n);\n```\n\n```\nCakePHP is able to connect to the database.\n```\n\n\u7121\u4e8b\u7e4b\u304c\u308a\u306f\u3057\u305f\u306e\u3067\u3059\u304c\u3001\u4f55\u304b\u91c8\u7136\u3068\u3057\u306a\u3044\u3002\u3002\n\u3053\u308c\u3082\u300cgateway\u300d\u30db\u30b9\u30c8\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3068\u898b\u306a\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3057\u3087\u3046\u304b\u3002\u3002\n\n### \u539f\u56e0\n\n\u5225\u30b3\u30f3\u30c6\u30ca\uff1d\u5225\u30db\u30b9\u30c8\u3089\u3057\u3044\u306e\u3067\u3001DB\u30b3\u30f3\u30c6\u30ca\u306eIP\u3092\u8abf\u3079\u3066\u76f4\u306b\u6307\u5b9a\u3059\u308b\u3002\n\u305d\u306e\u969b\u306f\u3001\u30db\u30b9\u30c8PC\u304b\u3089\u306e\u30a2\u30af\u30bb\u30b9\u3068\u306a\u308b\u3089\u3057\u3044\uff1f\u306e\u3067\u3001\u30db\u30b9\u30c8\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3059\u308b\u306e\u3068\u540c\u7b49\u306e\u6a29\u9650\u3092\u6301\u3063\u305f\u30e6\u30fc\u30b6\u30fc\u3092\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n\n# \u307e\u3068\u3081\n\u3068\u308a\u3042\u3048\u305a\u3001\u5916\u90e8\u30db\u30b9\u30c8\u304b\u3089\u30a2\u30af\u30bb\u30b9\u51fa\u6765\u3066root\u540c\u69d8\u306e\u6a29\u9650\u3092\u6301\u3064\u30e6\u30fc\u30b6\u30fc\u3092MariaDB\u4e0a\u306b\u4f5c\u3089\u306a\u3044\u3068\u3044\u3051\u306a\u3044\u3002\n\u305d\u3057\u3066\u3001\u57fa\u672c\u305d\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u4f7f\u3063\u3066\u30a2\u30ec\u30b3\u30ec\u3059\u308b\u3002\n\n# \u304a\u307e\u3051\n\u516c\u5f0f\u306eMariaDB\u30b3\u30f3\u30c6\u30ca\u3092\u4f7f\u308f\u305a\u306b\u3001\u81ea\u4f5c\u3057\u305f\u304b\u3089\u968f\u6240\u3067\u30cf\u30de\u3063\u3066\u3044\u308b\u3088\u3046\u306a\u6c17\u304c\u3057\u306a\u304f\u3082\u306a\u3044\u3067\u3059\u3002\nUbuntu\u3092\u907f\u3051\u3066\u304d\u307e\u3057\u305f\u304c\u3001\u3053\u3053\u3089\u3067Ubuntu\u306b\u3082\u6163\u308c\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u306d\u3002\u3002\n\n\u63a2\u3057\u65b9\u304c\u60aa\u3044\u306e\u304b\u3001\u30b3\u30f3\u30c6\u30ca\u9023\u643a\u3084\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u3067\u306e\u904b\u7528\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u3066\u3044\u308b\u30b5\u30a4\u30c8\u304c\u610f\u5916\u3068\u5c11\u306a\u304f\u3066\u3001\u5272\u3068\u624b\u5f53\u305f\u308a\u6b21\u7b2c\u3084\u3063\u3066\u308b\u611f\u304c\u5f37\u3044\u3067\u3059\u3002\nHyper-V+Docker\u3067\u306ePHP\u958b\u767a\u74b0\u5883\u69cb\u7bc9\u306f\u3001\u307e\u3060\u307e\u3060\u524d\u9014\u591a\u96e3\u306a\u3088\u3046\u3067\u3059\u3002\u3002\n", "tags": ["docker", "PHP", "CakePHP", "a5m2", "mariadb"]}