{"context": "\n\nVue.js\u306edata\u4fdd\u5b58\u3068\u5fa9\u5143\n\u30c7\u30fc\u30bf\u4fdd\u5b58\nthis.saveData = JSON.stringify(this.$data);\n\n\u5fa9\u5143\nvar obj = JSON.parse(this.saveData);\nfor (var k in obj) this[k] = obj[k];\n\n\u521d\u671f\u5024\u3084\u4efb\u610f\u306e\u5834\u6240\u306edata\u3092\u4fdd\u5b58\u3057\u3066\u304a\u3051\u3070\n\u8868\u793a\u72b6\u614b\u307e\u3067\u7c21\u5358\u306b\u5143\u901a\u308a\u306b\u51fa\u6765\u3066\u4fbf\u5229\u3067\u3059\u3002\n\n\u7c21\u6613\u7248\u3000\u30c7\u30e2\nhttps://jsfiddle.net/kebvw0sh/1/\n\n<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>vue.js \u843d\u3061\u7269\u30d1\u30ba\u30eb\u30b2\u30fc\u30e0</title>\n<style>\n.container {display: flex;}\n.waku {width: 20px;height: 20px;}\n</style>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/vue/2.0.7/vue.min.js\"></script>\n</head>\n<body>\n<div id=\"app\">\n   <h3>vue.js \u843d\u3061\u7269\u30d1\u30ba\u30eb\u30b2\u30fc\u30e0</h3>\n   <p>start\u3092\u62bc\u3057\u3066\u304b\u3089\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u77e2\u5370\u30ad\u30fc\u3067\u64cd\u4f5c\u3057\u307e\u3059</p>\n   <input type=\"button\" @click=\"startFn\" value=\"START\" v-if=\"gameStart == false\">\n   <p v-if=\"gameOver\">GAME OVER</p>\n   <div v-for=\"i in 20\" class=\"container\" v-if=\"gameStart\">\n      <div v-for=\"j in 10\" class=\"waku\" :style=\"{ backgroundColor: ['gray', 'green'][yx[i-1][j-1]] }\">\n         {{ yx[i-1][j-1] }}\n      </div>\n   </div>\n</div>\n<script>\nvar blocks = [\n   [[0, 0], [1, 0], [0, 1], [1, 1]],  // square\n   [[-1, 0], [0, 0], [1, 0], [2, 0]],  // tetris\n   [[-1, 0], [0, 0], [0, 1], [1, 1]],  // key1\n   [[-1, 1], [0, 1], [0, 0], [1, 0]],  // key2\n   [[-1, 0], [0, 0], [1, 0], [-1, 1]],  // L1\n   [[-1, 0], [0, 0], [1, 0], [1, 1]],  // L2\n   [[-1, 0], [0, 0], [1, 0], [0, 1]],  // T\n];\n\nvar vm = new Vue({\n   el: '#app',\n   data: {\n      yx: [],\n      block: [],\n      blockX: 0,\n      blockY: 0,\n      blockMemo: [],\n      timerID: null,\n      gameStart: false,\n      gameOver: false,\n   },\n   methods: {\n      startFn: function() {\n         for (var i = 0; i < 20; i++) {\n            this.yx[i] = [];\n            for (var j = 0; j < 10; j++) {\n               this.yx[i][j] = 0;\n            }\n         }\n         this.gameStart = true;\n         this.createFn();\n         this.timerID = setInterval(this.fallFn, 500);\n      },\n      keydownFn: function(rotate, dx, dy) {\n         if (!this.gameOver && this.checkFn(rotate, dx, dy)) this.drawFn(rotate, dx, dy);\n      },\n      checkFn: function(rotate, dx, dy) {\n         var yx = this.yx.map(v => v.slice());\n         var block = this.block.map(v => v.slice());\n         this.blockMemo.forEach(v => {\n            yx[v[0]][v[1]] = 0;\n         });\n         if (rotate) block = block.map(v => [v[1] * -1, v[0]]);\n         var flag = block.every(v => {\n            var x = v[0] + this.blockX + dx;\n            var y = v[1] + this.blockY + dy;\n            return (y >= 0 && y < 20 && x >= 0 && x < 10 && yx[y][x] == 0);\n         });\n         return flag;\n      },\n      drawFn: function(rotate, dx, dy) {\n         this.blockMemo.forEach(v => {\n            this.yx[v[0]][v[1]] = 0;\n         });\n         this.blockMemo = [];\n         if (rotate) this.block = this.block.map(v => [v[1] * -1, v[0]]);\n         this.blockX += dx;\n         this.blockY += dy;\n         this.block.forEach(v => {\n            if (this.yx[v[1] + this.blockY][v[0] + this.blockX] != 0) this.gameOver = true;\n            this.yx[v[1] + this.blockY][v[0] + this.blockX] = 1;\n            this.blockMemo.push([v[1] + this.blockY, v[0] + this.blockX]);\n         });\n         if (this.gameOver) clearInterval(this.timerID);\n         this.yx.push();\n      },\n      createFn: function() {\n         this.blockMemo = [];\n         this.blockX = 4;\n         this.blockY = 1;\n         this.block = blocks[Math.floor(Math.random() * 7)].map(v => [v[0], v[1]]);\n         this.drawFn(false, 0, 0);\n      },\n      deleteFn: function() {\n         this.yx = this.yx.filter(v => (v.join(\"\") != \"1111111111\"));\n         while (this.yx.length < 20) {\n            this.yx.unshift([0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\n         }\n      },\n      fallFn: function() {\n         if (this.checkFn(false, 0, 1)) {\n            this.drawFn(false, 0, 1);\n         } else {\n            this.deleteFn();\n            this.createFn();\n         }\n      }\n   },\n});\n\ndocument.onkeydown = function(e) {\n   if (e.keyCode == 38) vm.keydownFn(true, 0, 0); //up\n   else if (e.keyCode == 37) vm.keydownFn(false, -1, 0); //left\n   else if (e.keyCode == 40) vm.keydownFn(false, 0, 1); //down\n   else if (e.keyCode == 39) vm.keydownFn(false, 1, 0); //right\n};\n</script>\n</body>\n</html>\n\nJavaScript\u3067\u843d\u3061\u7269\u30d1\u30ba\u30eb\u30b2\u30fc\u30e0\nhttp://pie.karou.jp/zh.html\n\n\u53c2\u8003\n\u30cb\u30b3\u30cb\u30b3\u52d5\u753b\u300c\u30c6\u30c8\u30ea\u30b9\u30921\u6642\u9593\u5f37\u3067\u4f5c\u3063\u3066\u307f\u305f\u3010\u5b9f\u6cc1\u89e3\u8aac\u3011\u300d\n###Vue.js\u306edata\u4fdd\u5b58\u3068\u5fa9\u5143\n\u30c7\u30fc\u30bf\u4fdd\u5b58\n\n````\nthis.saveData = JSON.stringify(this.$data);\n````\n\u5fa9\u5143\n\n````\nvar obj = JSON.parse(this.saveData);\nfor (var k in obj) this[k] = obj[k];\n````\n\u521d\u671f\u5024\u3084\u4efb\u610f\u306e\u5834\u6240\u306edata\u3092\u4fdd\u5b58\u3057\u3066\u304a\u3051\u3070\n\u8868\u793a\u72b6\u614b\u307e\u3067\u7c21\u5358\u306b\u5143\u901a\u308a\u306b\u51fa\u6765\u3066\u4fbf\u5229\u3067\u3059\u3002\n### \u7c21\u6613\u7248\u3000\u30c7\u30e2\nhttps://jsfiddle.net/kebvw0sh/1/\n\n![index.jpeg](https://qiita-image-store.s3.amazonaws.com/0/54926/f917bc07-45f7-b881-1273-f578d6f4aeb3.jpeg)\n\n```\n<!doctype html>\n<html lang=\"ja\">\n<head>\n<meta charset=\"utf-8\">\n<title>vue.js \u843d\u3061\u7269\u30d1\u30ba\u30eb\u30b2\u30fc\u30e0</title>\n<style>\n.container {display: flex;}\n.waku {width: 20px;height: 20px;}\n</style>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/vue/2.0.7/vue.min.js\"></script>\n</head>\n<body>\n<div id=\"app\">\n   <h3>vue.js \u843d\u3061\u7269\u30d1\u30ba\u30eb\u30b2\u30fc\u30e0</h3>\n   <p>start\u3092\u62bc\u3057\u3066\u304b\u3089\u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u77e2\u5370\u30ad\u30fc\u3067\u64cd\u4f5c\u3057\u307e\u3059</p>\n   <input type=\"button\" @click=\"startFn\" value=\"START\" v-if=\"gameStart == false\">\n   <p v-if=\"gameOver\">GAME OVER</p>\n   <div v-for=\"i in 20\" class=\"container\" v-if=\"gameStart\">\n      <div v-for=\"j in 10\" class=\"waku\" :style=\"{ backgroundColor: ['gray', 'green'][yx[i-1][j-1]] }\">\n         {{ yx[i-1][j-1] }}\n      </div>\n   </div>\n</div>\n<script>\nvar blocks = [\n   [[0, 0], [1, 0], [0, 1], [1, 1]],  // square\n   [[-1, 0], [0, 0], [1, 0], [2, 0]],  // tetris\n   [[-1, 0], [0, 0], [0, 1], [1, 1]],  // key1\n   [[-1, 1], [0, 1], [0, 0], [1, 0]],  // key2\n   [[-1, 0], [0, 0], [1, 0], [-1, 1]],  // L1\n   [[-1, 0], [0, 0], [1, 0], [1, 1]],  // L2\n   [[-1, 0], [0, 0], [1, 0], [0, 1]],  // T\n];\n\nvar vm = new Vue({\n   el: '#app',\n   data: {\n      yx: [],\n      block: [],\n      blockX: 0,\n      blockY: 0,\n      blockMemo: [],\n      timerID: null,\n      gameStart: false,\n      gameOver: false,\n   },\n   methods: {\n      startFn: function() {\n         for (var i = 0; i < 20; i++) {\n            this.yx[i] = [];\n            for (var j = 0; j < 10; j++) {\n               this.yx[i][j] = 0;\n            }\n         }\n         this.gameStart = true;\n         this.createFn();\n         this.timerID = setInterval(this.fallFn, 500);\n      },\n      keydownFn: function(rotate, dx, dy) {\n         if (!this.gameOver && this.checkFn(rotate, dx, dy)) this.drawFn(rotate, dx, dy);\n      },\n      checkFn: function(rotate, dx, dy) {\n         var yx = this.yx.map(v => v.slice());\n         var block = this.block.map(v => v.slice());\n         this.blockMemo.forEach(v => {\n            yx[v[0]][v[1]] = 0;\n         });\n         if (rotate) block = block.map(v => [v[1] * -1, v[0]]);\n         var flag = block.every(v => {\n            var x = v[0] + this.blockX + dx;\n            var y = v[1] + this.blockY + dy;\n            return (y >= 0 && y < 20 && x >= 0 && x < 10 && yx[y][x] == 0);\n         });\n         return flag;\n      },\n      drawFn: function(rotate, dx, dy) {\n         this.blockMemo.forEach(v => {\n            this.yx[v[0]][v[1]] = 0;\n         });\n         this.blockMemo = [];\n         if (rotate) this.block = this.block.map(v => [v[1] * -1, v[0]]);\n         this.blockX += dx;\n         this.blockY += dy;\n         this.block.forEach(v => {\n            if (this.yx[v[1] + this.blockY][v[0] + this.blockX] != 0) this.gameOver = true;\n            this.yx[v[1] + this.blockY][v[0] + this.blockX] = 1;\n            this.blockMemo.push([v[1] + this.blockY, v[0] + this.blockX]);\n         });\n         if (this.gameOver) clearInterval(this.timerID);\n         this.yx.push();\n      },\n      createFn: function() {\n         this.blockMemo = [];\n         this.blockX = 4;\n         this.blockY = 1;\n         this.block = blocks[Math.floor(Math.random() * 7)].map(v => [v[0], v[1]]);\n         this.drawFn(false, 0, 0);\n      },\n      deleteFn: function() {\n         this.yx = this.yx.filter(v => (v.join(\"\") != \"1111111111\"));\n         while (this.yx.length < 20) {\n            this.yx.unshift([0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\n         }\n      },\n      fallFn: function() {\n         if (this.checkFn(false, 0, 1)) {\n            this.drawFn(false, 0, 1);\n         } else {\n            this.deleteFn();\n            this.createFn();\n         }\n      }\n   },\n});\n\ndocument.onkeydown = function(e) {\n   if (e.keyCode == 38) vm.keydownFn(true, 0, 0); //up\n   else if (e.keyCode == 37) vm.keydownFn(false, -1, 0); //left\n   else if (e.keyCode == 40) vm.keydownFn(false, 0, 1); //down\n   else if (e.keyCode == 39) vm.keydownFn(false, 1, 0); //right\n};\n</script>\n</body>\n</html>\n```\nJavaScript\u3067\u843d\u3061\u7269\u30d1\u30ba\u30eb\u30b2\u30fc\u30e0\nhttp://pie.karou.jp/zh.html\n### \u53c2\u8003\n\u30cb\u30b3\u30cb\u30b3\u52d5\u753b\u300c\u30c6\u30c8\u30ea\u30b9\u30921\u6642\u9593\u5f37\u3067\u4f5c\u3063\u3066\u307f\u305f\u3010\u5b9f\u6cc1\u89e3\u8aac\u3011\u300d\n", "tags": ["HTML5", "JavaScript", "vue.js"]}