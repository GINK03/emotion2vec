{"context": " More than 1 year has passed since last update.Erlang/OTP 18 \u306e\u5b9f\u884c\u74b0\u5883\uff08ERTS \u30d0\u30fc\u30b8\u30e7\u30f3 7.0\uff09\u3067\u306f\u3001\u6642\u523b\u306b\u95a2\u9023\u3059\u308b\u65b0\u3057\u3044 API \u3068\u3001Time Warp\uff08\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\uff09\u30e2\u30fc\u30c9\u304c\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001ERTS \u30e6\u30fc\u30b6\u30fc\u30ac\u30a4\u30c9\u306e\u300cTime and Time Correction in Erlang\u300d\u4e2d\u3067\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308b\u6982\u5ff5\u306b\u3064\u3044\u3066\u3001\u5b9f\u9a13\u3092\u901a\u3057\u3066\u78ba\u8a8d\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\nOTP 17 \u307e\u3067\u306f erlang:now/0 \u3092\u4f7f\u3044\u307e\u308f\u3057\u3066\u304d\u305f\nOTP 18 \u3088\u308a\u524d\u306e\u30ea\u30ea\u30fc\u30b9\u3067\u306f\u3001\u73fe\u5728\u6642\u523b\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u53d6\u5f97\u3059\u308b API \u3068\u3057\u3066\u3001erlang:now/0 \u304c\u4f7f\u308f\u308c\u3066\u304d\u307e\u3057\u305f\u3002\u307e\u305f\u3001\u985e\u4f3c\u306e\u3082\u306e\u306b os:timestamp/0 \u3082\u3042\u308a\u307e\u3059\u3002\u524d\u8005\u306f Erlang \u5b9f\u884c\u74b0\u5883\uff08Erlang VM\uff09\u306e\u4e2d\u3067\u7ba1\u7406\u3055\u308c\u3066\u3044\u308b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304b\u3089\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u53d6\u5f97\u3057\u3001\u5f8c\u8005\u306f OS \u304c\u7ba1\u7406\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\n1> F = fun() -> {erlang:now(), os:timestamp()} end.\n#Fun<erl_eval.20.54118792>\n2> F().\n{{1449,412303,848793},{1449,412303,848798}}\n\n\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f\u5de6\u304b\u3089\u3001\u30e1\u30ac\u79d2\u3001\u79d2\u3001\u30de\u30a4\u30af\u30ed\u79d2\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u3053\u308c\u3089\u3092\u8db3\u3057\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u3001UNIX \u30a8\u30dd\u30c3\u30af\u304b\u3089\u306e\u7d4c\u904e\u6642\u9593\u3092\u3001\u30de\u30a4\u30af\u30ed\u79d2\u306e\u5206\u89e3\u80fd\u3067\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u306a\u304a\u3001erlang:now() \u306f\u3001\u5358\u306b now() \u3068\u66f8\u304f\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n3> {MegaSecs, Secs, MicroSecs} = now().\n{1449,412312,352252}\n4> CurrentTimeMicro = MegaSecs * 1000000000000 + Secs * 1000000 + MicroSecs.\n1449412312352252\n5> CurrentTimeMicro div 1000000.\n1449412312\n\n$ date --date='@1449412312'\nSun Dec  6 22:31:52 CST 2015\n\n\uff08\u3061\u306a\u307f\u306b CST \u306f China Standard Time \u3067\u3059\u3002\u3044\u307e\u4e0a\u6d77\u306b\u4f4f\u3093\u3067\u307e\u3059\uff09\n\u6700\u521d\u306e\u4f8b\u3067\u3001erlang:now/0 \u3068 os:timestamp/0 \u306e\u8fd4\u3057\u305f\u5024\u306b\uff15\u30de\u30a4\u30af\u30ed\u79d2\u306e\u958b\u304d\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u3001\uff12\u3064\u306e\u95a2\u6570\u3092\u540c\u6642\u3067\u306f\u306a\u304f\u9806\u756a\u306b\u547c\u3093\u3060\u305f\u3081\u3067\u3059\u3002\n\n\u7528\u9014\uff11\uff1a\u73fe\u5728\u6642\u523b\u3092\u53d6\u5f97\u3059\u308b\nerlang:now/0 \u306f\u3044\u304f\u3064\u304b\u306e\u7528\u9014\u306b\u4f7f\u308f\u308c\u3066\u304d\u307e\u3057\u305f\u3002\u6700\u521d\u306b\u601d\u3044\u6d6e\u304b\u3076\u7528\u9014\u306f\u3001\u3042\u305f\u308a\u307e\u3048\u3067\u3059\u304c\u300c\u73fe\u5728\u65e5\u6642\u306e\u53d6\u5f97\u300d\u3067\u3059\u3002calendar \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u306f\u3001\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u5404\u7a2e\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u5f62\u5f0f\u3078\u5909\u63db\u3059\u308b\u95a2\u6570\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n5> calendar:now_to_local_time(now()).\n{{2015,12,6},{22,32,49}}    %% 2015\u5e7412\u67086\u65e5\u300022\u664232\u520649\u79d2\n\n\n\u7528\u9014\uff12\uff1a\u7d4c\u904e\u6642\u9593\u3092\u8a08\u308b\n\uff12\u3064\u76ee\u306e\u7528\u9014\u306f\u300c\u7d4c\u904e\u6642\u9593\u306e\u6e2c\u5b9a\u300d\u3067\u3059\u3002timer \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u95a2\u6570\u3092\u4f7f\u3046\u3068\u3001\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304b\u3089\u7d4c\u904e\u6642\u9593\u3092\u3001\u30de\u30a4\u30af\u30ed\u79d2\u306e\u5206\u89e3\u80fd\u3067\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n6> Start = now().\n{1449,412383,80755}\n7> End = now().\n{1449,412387,489901}\n8> timer:now_diff(End, Start).\n4409146\u3000 %% \u5358\u4f4d\uff1a\u30de\u30a4\u30af\u30ed\u79d2\n9> timer:now_diff(End, Start) / 1000000.\n4.409146\u3000%% \u5358\u4f4d\uff1a\u79d2\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u3042\u308b\u4e00\u5b9a\u306e\u9593\u9694\u3067\u51e6\u7406\u3092\u5b9f\u884c\u3057\u305f\u308a\u3001\u901a\u4fe1\u3067\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u767a\u751f\u3055\u305b\u305f\u308a\u3001\u6027\u80fd\u3092\u6e2c\u5b9a\u3057\u305f\u308a\u3068\u3044\u3063\u305f\u3053\u3068\u304c\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\n\u7528\u9014\uff13\uff1a\u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u751f\u6210\u3059\u308b\n\uff13\u3064\u3081\u306e\u7528\u9014\u306f\u300c\u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u306e\u751f\u6210\u300d\u3067\u3059\u3002erlang:now/0 \u306f\u3001\u5358\u306b\u73fe\u5728\u6642\u523b\u3092\u8fd4\u3059\u3060\u3051\u3067\u306a\u304f\u3001\u305d\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304c strictly monotonically increasing number\uff08\u72ed\u7fa9\u306e\u5358\u8abf\u5897\u52a0\u6570\uff09\u3067\u3042\u308b\u3053\u3068\u3092\u4fdd\u8a3c\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u8907\u6570\u306e\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u540c\u6642\u306b\uff08\uff11\u30de\u30a4\u30af\u30ed\u79d2\u672a\u6e80\u306e\u6642\u5dee\u3067\uff09\u547c\u3070\u308c\u3066\u3082\u3001\u5fc5\u305a\u300c\u524d\u56de\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7 \uff1c \u4eca\u56de\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u300d\u3068\u306a\u308b\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002\n\u3053\u308c\u306b\u3088\u308a\u3001\u30e6\u30cb\u30fc\u30af\u306a\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3ID\u306e\u751f\u6210\u306a\u3069\u306b\u3082\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u6642\u523b\u95a2\u9023 API \u306b\u6c42\u3081\u3089\u308c\u3066\u304d\u305f\uff13\u3064\u306e\u8981\u4ef6\n\u3053\u308c\u3089\u306e\u7528\u9014\u304b\u3089\u3001\u6642\u523b\u95a2\u9023\u306e API \u306b\u6c42\u3081\u3089\u308c\u308b\u8981\u4ef6\u306b\u306f\u3001\u4ee5\u4e0b\u306e\uff13\u3064\u304c\u3042\u308b\u3068\u8a00\u3048\u305d\u3046\u3067\u3059\u3002\n\n\n\n\n\u8981\u4ef6\n\u8aac\u660e\n\n\n\n\n1\n\u73fe\u5728\u6642\u523b\u3092\u6b63\u78ba\u306b\u5f97\u3089\u308c\u308b\nOS \u304c\u63d0\u4f9b\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u793a\u3059\u6642\u523b\u304c\u3001\u5e38\u306b\u5f97\u3089\u308c\u308b\n\n\n2\n\u7d4c\u904e\u6642\u9593\u3092\u6b63\u78ba\u306b\u6e2c\u5b9a\u3067\u304d\u308b\n\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u5dee\u304b\u3089\u3001\u7d4c\u904e\u6642\u9593\u3092\u8a08\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n\n\n3\n\u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u5f97\u3089\u308c\u308b\n\u95a2\u6570\u3092\u547c\u3076\u6bce\u306b\u3001\u91cd\u8907\u3057\u306a\u3044\u5024\u304c\u8fd4\u3055\u308c\u308b\u3053\u3068\u304c\u4fdd\u8a3c\u3055\u308c\u3066\u3044\u308b\u3002\u4e00\u4f8b\u3068\u3057\u3066 strictly monotonically increasing number \u304c\u3042\u308b\n\n\n\n\uff13\u306f\u5fc5\u305a\u3057\u3082\u6642\u523b\u95a2\u9023\u306e API \u3067\u5b9f\u73fe\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057 OTP 18 \u3088\u308a\u524d\u306e\u30ea\u30ea\u30fc\u30b9\u3067\u306f erlang:now/0 \u304c\u305d\u306e\u5f79\u5272\u3092\u62c5\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\nerlang:now/0 \u306f\u307e\u3082\u306a\u304f\u5ec3\u6b62\u3055\u308c\u308b\n\u3053\u306e\u3088\u3046\u306b\u3001\u3042\u308b\u610f\u5473\u3067\u4fbf\u5229\u306b\u4f7f\u308f\u308c\u3066\u304d\u305f erlang:now/0 \u3067\u3059\u304c\u3001OTP 18 \u3067\u306f deprecated \u3068\u306a\u308a\u307e\u3057\u305f\u3002\u8fd1\u3005\u5ec3\u6b62\u3055\u308c\u308b\u4e88\u5b9a\u3067\u3059\u3002\u306a\u305c\u3067\u3057\u3087\u3046\u304b\uff1f\n\n\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u4fee\u6b63\u306b\u5bfe\u5fdc\u3057\u304d\u308c\u306a\u3044\nerlang:now/0 \u306f\u30de\u30b7\u30f3\u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u3001\u3044\u3064\u3082\u6b63\u78ba\u3067\u3042\u308b\u3053\u3068\u3092\u524d\u63d0\u306b\u4f5c\u3089\u308c\u305f\u3088\u3046\u306a\u95a2\u6570\u3067\u3059\u3002\u30af\u30ed\u30c3\u30af\u304c\u6b63\u78ba\u3067\u3042\u308b\u9650\u308a\u3001\uff13\u3064\u306e\u8981\u4ef6\u3092\u540c\u6642\u306b\u6e80\u305f\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u3082\u3057\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5927\u304d\u304f\u30ba\u30ec\u3066\u3001\u6b63\u3057\u3044\u6642\u9593\u306b\u4fee\u6b63\u3055\u308c\u305f\u306a\u3089...\u3001erlang:now/0 \u3067\u306f\u6570\u5341\u5206\u7a0b\u5ea6\u306e\u4fee\u6b63\u306a\u3089\u5bfe\u5fdc\u3067\u304d\u307e\u3059\u304c\u3001\u305d\u308c\u4ee5\u4e0a\u3060\u3068\u53b3\u3057\u304f\u306a\u308a\u307e\u3059\u3002\n\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u3044\u3064\u3082\u6b63\u78ba\u3067\u3042\u308c\u3070\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u73fe\u5b9f\u306f\u305d\u3046\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u653e\u3063\u3066\u304a\u3051\u3070\u5c11\u3057\u305a\u3064\u72c2\u3063\u3066\u3044\u304d\u307e\u3059\u306e\u3067\u3001\u6b63\u3057\u3044\u6642\u523b\u306b\u5408\u308f\u305b\u76f4\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u7279\u306b\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u30b2\u30b9\u30c8\u5074\u3067\u306f\u3053\u306e\u50be\u5411\u304c\u5f37\u3044\u3088\u3046\u3067\u3059\u3002\u3082\u3063\u3068\u7cbe\u5ea6\u306e\u9ad8\u3044\u30af\u30ed\u30c3\u30af\u3001\u4f8b\u3048\u3070\u539f\u5b50\u6642\u8a08\u3092\u642d\u8f09\u3059\u308c\u3070\u3044\u3044\u3088\u3046\u306b\u3082\u601d\u3048\u307e\u3059\u304c\u3001\u3053\u308c\u3067\u6551\u3048\u308b\u306e\u306f\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u30db\u30b9\u30c8\u5074\u306e\u307f\u3067\u3001\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3067\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u30b2\u30b9\u30c8\u5074\u306e\u30af\u30ed\u30c3\u30af\u307e\u3067\u306f\u76f4\u305b\u307e\u305b\u3093\u3002\u305d\u306e\u305f\u3081\u3001NTP\u306a\u3069\u3067\u88dc\u6b63\u3059\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u3053\u308c\u3082\u5e38\u306b\u5229\u7528\u53ef\u80fd\u306a\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\u3055\u3089\u306b\u3001\u4eca\u5f8c\u306f IoT\uff08\u30e2\u30ce\u306e\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\uff09\u30c7\u30d0\u30a4\u30b9\u3082\u5897\u3048\u3066\u304f\u308b\u3067\u3057\u3087\u3046\u3002\u305d\u306e\u3088\u3046\u306a\u30c7\u30d0\u30a4\u30b9\u3067\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u30d0\u30c3\u30c6\u30ea\u30fc\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u6301\u305f\u305a\u3001\u30b7\u30b9\u30c6\u30e0\u8d77\u52d5\u76f4\u5f8c\u306f\u30af\u30ed\u30c3\u30af\u304c\u521d\u671f\u72b6\u614b\u306b\u306a\u308b\u3082\u306e\u3082\u591a\u3044\u3067\u3059\u3002\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u8d77\u52d5\u3057\u3066\u3057\u3070\u3089\u304f\u3057\u3066\u304b\u3089\u3001NTP\u306a\u3069\u306b\u3088\u3063\u3066\u6642\u523b\u304c\u5408\u3046\u3001\u306a\u3093\u3066\u3053\u3068\u304c\u666e\u901a\u306b\u884c\u308f\u308c\u3066\u3044\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\nOTP 18 \u306e\u65b0\u3057\u3044\u6642\u523b\u95a2\u9023 API \u3068\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u306f\u3001\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u4fee\u6b63\u306b\u95a2\u3059\u308b\u554f\u984c\u3092\u3001\u6839\u672c\u7684\u306b\u89e3\u6c7a\u3059\u308b\u305f\u3081\u306b\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u5b9f\u9a13\uff11\uff1a\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u72c2\u308f\u305b\u3066\u307f\u308b\n\u65b0\u3057\u3044 API \u3092\u898b\u308b\u524d\u306b\u3001\u307e\u305a\u306f erlang:now/0 \u304c\u3069\u3093\u306a\u98a8\u306b\u632f\u308b\u821e\u3046\u304b\u3001\u305d\u3057\u3066\u3001\u305d\u308c\u304c\u306a\u305c\u554f\u984c\u306a\u306e\u304b\u3092\u5b9f\u9a13\u3067\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002x86_64 \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30fc\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u3067 GNU/Linux\uff08CentOS 7\uff09\u3068 Erlang/OTP \u3092\u7a3c\u50cd\u3055\u305b\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u4fee\u6b63\u3057\u3066\u307f\u307e\u3059\u3002\n\u3053\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u306f ntpd \u306b\u3088\u308b\u6642\u523b\u5408\u308f\u305b\u306f\u884c\u3063\u3066\u3044\u307e\u305b\u3093\u3002ntpdate \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3001OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u5408\u308f\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n$ sudo ntpdate -b jp.pool.ntp.org\n 6 Dec 22:36:37 ntpdate[2766]: step time server 129.250.35.251 offset 0.014679 sec\n\n\n\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u72b6\u614b\nOTP 18 \u3067\u306f erl \u306e\u8d77\u52d5\u5f15\u6570\u306b\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9 +C \u304c\u8ffd\u52a0\u3055\u308c\u307e\u3057\u305f\u3002\n$ erl +C hoge\nInvalid time warp mode: hoge\nUsage: beam.smp [flags] [ -- [init_args] ]\nThe flags are:\n...\n-C mode        set time warp mode; valid modes are:\n               no_time_warp|single_time_warp|multi_time_warp\n\n\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u3068\u306f\u3001Erlang \u5b9f\u884c\u74b0\u5883\u5185\u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u3001\u672a\u6765\u3084\u904e\u53bb\u306e\u6642\u9593\u306b\u30b8\u30e3\u30f3\u30d7\u3059\u308b\u3053\u3068\u3092\u6307\u3057\u3066\u3044\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306f no_time_warp \u3067\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306f\u7981\u6b62\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u306f OTP 18 \u3088\u308a\u524d\u306e\u30ea\u30ea\u30fc\u30b9\u3068\u4e92\u63db\u6027\u3092\u4fdd\u3064\u305f\u3081\u306e\u30e2\u30fc\u30c9\u3067\u3001\u3053\u306e\u8a2d\u5b9a\u306e\u307e\u307e\u4f7f\u3063\u3066\u3082\u3001\u65b0\u3057\u3044 API \u306e\u6069\u6075\u3092\u30d5\u30eb\u306b\u53d7\u3051\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\u307e\u305a\u306f\u5f93\u6765\u306e\u52d5\u4f5c\u3092\u77e5\u308b\u305f\u3081\u306b\u3001\u3053\u306e\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\u3057\u3066\u307f\u307e\u3059\u3002\n\u307e\u305f\u3001\u904e\u53bb\u306e\u30ea\u30ea\u30fc\u30b9\u304b\u3089\u3059\u3067\u306b +c \u3068\u3044\u3046\u30d5\u30e9\u30b0\u3082\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306f date/time correction \uff08\u65e5\u4ed8\u6642\u523b\u306e\u4fee\u6b63\uff09\u6a5f\u80fd\u306e\u30aa\u30f3\u30fb\u30aa\u30d5\u3092\u5207\u308a\u66ff\u3048\u308b\u305f\u3081\u306e\u3082\u306e\u3067\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306f true \uff08\u4fee\u6b63\u6a5f\u80fd\u3092\u30aa\u30f3\u306b\u3059\u308b\uff09\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u3061\u3089\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u307e\u307e\u306b\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\u3082\u3057\u30aa\u30d5\u306b\u3059\u308b\u3068\u3001no_time_warp \u3082\u542b\u3081\u3066\u3001\u6642\u523b\u4fee\u6b63\u306b\u95a2\u3059\u308b\u6a5f\u80fd\u304c\u52d5\u4f5c\u3057\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u306a\u304a\u3001OTP \u306f 2015\u5e7412\u6708\u4e0a\u65ec\u6642\u70b9\u3067\u6700\u65b0\u306e 18.1.5 \u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n$ cat /etc/centos-release\nCentOS Linux release 7.1.1503 (Core)\n$ kerl list installations\n18.1.5_hipe /home/tatsuya/erlang/18.1.5_hipe\n17.5.6.5_hipe /home/tatsuya/erlang/17.5.6.5_hipe\n$ source ~/erlang/18.1.5_hipe/activate\n$ kerl active\nThe current active installation is:\n/home/tatsuya/erlang/18.1.5_hipe\n$ erl\nErlang/OTP 18 [erts-7.1] [source] [64-bit] [smp:2:2] [async-threads:10] [hipe] [kernel-poll:false]\n\nEshell V7.1  (abort with ^G)\n1> (Ctrl + G)\nUser switch command\n --> q\n$ curl -O https://raw.githubusercontent.com/tatsuya6502/erlang-examples/master/show-otp-version.escript\n$ chmod +x show-otp-version.escript\n$ echo $(./show-otp-version.escript)\n18.1.5\n\n\u52d5\u4f5c\u78ba\u8a8d\u306e\u305f\u3081\u306b\u3001\u7c21\u5358\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n-module(t1).\n\n-compile(export_all).\n\n-spec print_time_legacy() -> ok.\nprint_time_legacy() ->\n    OSTS = os:timestamp(),\n    Now  = now(),\n    LocalTimeOSTS = calendar:now_to_local_time(OSTS),\n    LocalTimeNow  = calendar:now_to_local_time(Now),\n    Diff = timer:now_diff(Now, OSTS),\n    io:format(\"---------~n\"\n              \"os:timestamp ~p -> ~p~n\"\n              \"erlang:now   ~p -> ~p (~w us)~n\",\n              [OSTS, LocalTimeOSTS,\n               Now, LocalTimeNow, Diff]).\n\n-spec repeat_time_legacy() -> timer:tref().\nrepeat_time_legacy() ->\n    {ok, TRef} =\n        timer:apply_interval(1000, ?MODULE, print_time_legacy, []),\n    TRef.\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002print_time_legacy/0 \u306f\u3001os:timestamp/0 \u3068 erlang:now()/0 \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3068\u3001calendar:now_to_localtime/1 \u3067\u5909\u63db\u3057\u305f\u73fe\u5728\u6642\u523b\u3092\u8868\u793a\u3057\u307e\u3059\u3002\u305d\u3057\u3066\u3001\u6700\u5f8c\u306b\u3001\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u6642\u9593\u5dee\u3092\u3001\u30de\u30a4\u30af\u30ed\u79d2\u306e\u7cbe\u5ea6\u3067\u8868\u793a\u3057\u307e\u3059\u3002\n$ erl\n1> c(t1).\nt1.erl:7: Warning: erlang:now/0: Deprecated BIF. See the \"Time and Time\nCorrection in Erlang\" chapter of the ERTS User's Guide for more\ninformation.\n{ok,t1}\n2> t1:print_time_legacy().\n---------\nos:timestamp {1449,412756,285759} -> {{2015,12,6},{22,39,16}}\nerlang:now   {1449,412756,285763} -> {{2015,12,6},{22,39,16}} (4 us)\nok\n3>\n\nrepeat_time_legacy/0 \u306f\u3001print_time_legacy/0 \u304c\uff11\u79d2\u9593\u9694\u3067\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u3001\u30bf\u30a4\u30de\u30fc\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u623b\u308a\u5024\u306f\u3001\u30bf\u30a4\u30de\u30fc\u306e Ref \u3067\u3059\u3002\n3> TR = t1:repeat_time_legacy().\ninterval,#Ref<0.0.1.97>\n4> ---------\nos:timestamp {1449,412765,128993} -> {{2015,12,6},{22,39,25}}\nerlang:now   {1449,412765,128997} -> {{2015,12,6},{22,39,25}} (4 us)\n---------\nos:timestamp {1449,412766,129985} -> {{2015,12,6},{22,39,26}}\nerlang:now   {1449,412766,129989} -> {{2015,12,6},{22,39,26}} (4 us)\n---------\nos:timestamp {1449,412767,130912} -> {{2015,12,6},{22,39,27}}\nerlang:now   {1449,412767,130915} -> {{2015,12,6},{22,39,27}} (3 us)\n---------\nos:timestamp {1449,412768,128955} -> {{2015,12,6},{22,39,28}}\nerlang:now   {1449,412768,128959} -> {{2015,12,6},{22,39,28}} (4 us)\n4> timer:cancel(TR).\n{ok,cancel}\n5>\n\n\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u5dee\u306f\u6570\u30de\u30a4\u30af\u30ed\u79d2\u306b\u304a\u3055\u307e\u3063\u3066\u3044\u307e\u3059\u3002\n\n\u6642\u523b\u3092\u9032\u307e\u305b\u3066\u307f\u308b\n\u3067\u306f\u3001repeat_time_legacy/0 \u304c\u52d5\u4f5c\u3057\u3066\u3044\u308b\u72b6\u614b\u3067\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9032\u3081\u3066\u307f\u307e\u3059\u3002\n$ date\nSun Dec  6 22:41:48 CST 2015\n$ sudo date 12062243\nSun Dec  6 22:43:00 CST 2015\n\nprint_time_legacy/0 \u306e\u8868\u793a\u3092\u898b\u308b\u3068\u3001os:timestamp/0 \u5074\u3067\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u6642\u523b\u304c\u3059\u3050\u306b\u53cd\u6620\u3055\u308c\u307e\u3057\u305f\u3002\u4e00\u65b9\u3067 erlang:now/0 \u5074\u306e\u6642\u523b\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u3002\n---------\nos:timestamp {1449,412919,449076} -> {{2015,12,6},{22,41,59}}\nerlang:now   {1449,412919,449079} -> {{2015,12,6},{22,41,59}} (3 us)\n---------\nos:timestamp {1449,412920,448004} -> {{2015,12,6},{22,42,0}}\nerlang:now   {1449,412920,448008} -> {{2015,12,6},{22,42,0}} (4 us)\n---------\nos:timestamp {1449,412980,315715} -> {{2015,12,6},{22,43,0}}    %% <-- \uff11\u5206\u9032\u3093\u3060\nerlang:now   {1449,412921,448009} -> {{2015,12,6},{22,42,1}} (-58867706 us)\n---------\nos:timestamp {1449,412981,315559} -> {{2015,12,6},{22,43,1}}\nerlang:now   {1449,412922,447852} -> {{2015,12,6},{22,42,2}} (-58867707 us)\n\n\u304c\u300130\u79d2\u307b\u3069\u5f85\u3064\u3068\u3001\u305d\u306e\u5dee\u304c\u5c11\u3057\u305a\u3064\u7e2e\u307e\u308a\u59cb\u3081\u307e\u3057\u305f\uff01\nos:timestamp {1449,413014,316449} -> {{2015,12,6},{22,43,34}}\nerlang:now   {1449,412955,448742} -> {{2015,12,6},{22,42,35}} (-58867707 us)\n---------\nos:timestamp {1449,413015,316755} -> {{2015,12,6},{22,43,35}}\nerlang:now   {1449,412956,449830} -> {{2015,12,6},{22,42,36}} (-58866925 us)\n---------\nos:timestamp {1449,413016,316950} -> {{2015,12,6},{22,43,36}}\nerlang:now   {1449,412957,459793} -> {{2015,12,6},{22,42,37}} (-58857157 us)\n---------\nos:timestamp {1449,413017,307114} -> {{2015,12,6},{22,43,37}}\nerlang:now   {1449,412958,459626} -> {{2015,12,6},{22,42,38}} (-58847488 us)\n---------\nos:timestamp {1449,413018,297016} -> {{2015,12,6},{22,43,38}}\nerlang:now   {1449,412959,459194} -> {{2015,12,6},{22,42,39}} (-58837822 us)\n\n\uff11\u5206\u9593\u306b\u3064\u304d\u30010.5\u79d2\u304f\u3089\u3044\u306e\u30da\u30fc\u30b9\u3067\u5dee\u304c\u7e2e\u307e\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u3068\u3044\u3046\u3053\u3068\u306f\u3001\uff11\u5206\u306e\u30ba\u30ec\u306a\u3089\u3001\uff12\u6642\u9593\u307b\u3069\u304b\u3051\u308c\u3070\u5b9f\u6642\u9593\u306b\u8ffd\u3044\u3064\u304d\u305d\u3046\u3067\u3059\u3002\n\n\u6642\u523b\u3092\u9045\u3089\u305b\u3066\u307f\u308b\n\u3067\u306f\u3001\u3053\u306e\u300c\u30af\u30ed\u30c3\u30af\u304c\u9032\u3093\u3060\u72b6\u614b\u300d\u304b\u3089\u3001\u6b63\u3057\u3044\u6642\u523b\u306b\u5408\u308f\u305b\u76f4\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u6642\u523b\u304c\u7d04\uff11\u5206\u904e\u53bb\u306b\u623b\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n$ sudo ntpdate -b jp.pool.ntp.org\n...\n\n---------\nos:timestamp {1449,413191,594393} -> {{2015,12,6},{22,46,31}}\nerlang:now   {1449,413134,448930} -> {{2015,12,6},{22,45,34}} (-57145463 us)\n---------\nos:timestamp {1449,413192,587868} -> {{2015,12,6},{22,46,32}}\nerlang:now   {1449,413135,452106} -> {{2015,12,6},{22,45,35}} (-57135762 us)\n---------\nos:timestamp {1449,413134,760236} -> {{2015,12,6},{22,45,34}}    %% <-- \uff11\u5206\u9045\u308c\u305f\nerlang:now   {1449,413136,458810} -> {{2015,12,6},{22,45,36}} (1698574 us)\n---------\nos:timestamp {1449,413135,754355} -> {{2015,12,6},{22,45,35}}\nerlang:now   {1449,413137,462637} -> {{2015,12,6},{22,45,37}} (1708282 us)\n---------\nos:timestamp {1449,413136,742354} -> {{2015,12,6},{22,45,36}}\nerlang:now   {1449,413138,460285} -> {{2015,12,6},{22,45,38}} (1717931 us)\n\n...\uff08\u4e2d\u7565\uff09...\n\n---------\nos:timestamp {1449,413365,422641} -> {{2015,12,6},{22,49,25}}\nerlang:now   {1449,413365,448937} -> {{2015,12,6},{22,49,25}} (26296 us)\n---------\nos:timestamp {1449,413366,432637} -> {{2015,12,6},{22,49,26}}\nerlang:now   {1449,413366,449071} -> {{2015,12,6},{22,49,26}} (16434 us)\n---------\nos:timestamp {1449,413367,442907} -> {{2015,12,6},{22,49,27}}\nerlang:now   {1449,413367,449472} -> {{2015,12,6},{22,49,27}} (6565 us)\n---------\nos:timestamp {1449,413368,451275} -> {{2015,12,6},{22,49,28}}\nerlang:now   {1449,413368,447995} -> {{2015,12,6},{22,49,28}} (-3280 us)\n---------\nos:timestamp {1449,413369,449201} -> {{2015,12,6},{22,49,29}}\nerlang:now   {1449,413369,449204} -> {{2015,12,6},{22,49,29}} (3 us)\n---------\nos:timestamp {1449,413370,450116} -> {{2015,12,6},{22,49,30}}\nerlang:now   {1449,413370,450119} -> {{2015,12,6},{22,49,30}} (3 us)\n---------\nos:timestamp {1449,413371,448543} -> {{2015,12,6},{22,49,31}}\nerlang:now   {1449,413371,448546} -> {{2015,12,6},{22,49,31}} (3 us)\n\nos:timestamp/0 \u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f\u904e\u53bb\u306b\u623b\u308a\u307e\u3057\u305f\u304c\u3001erlang:now/0 \u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f\u3001\u7d76\u5bfe\u306b\u904e\u53bb\u3078\u306f\u623b\u308a\u307e\u305b\u3093\u3002\u3053\u308c\u306f\u3001\u8981\u4ef6\uff13\u3067\u6319\u3052\u305f\u3001strictly monotonically increasing number \u3092\u6e80\u305f\u3059\u305f\u3081\u3067\u3059\u3002\n\u3084\u306f\u308a\u5f90\u3005\u306b\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u5dee\u304c\u72ed\u307e\u3063\u3066\u3044\u304d\u3001\u6700\u5f8c\u306f\u30ba\u30ec\u304c\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\nerlang:now/0 \u3067\u306f\uff13\u3064\u306e\u7528\u9014\u3092\u540c\u6642\u306b\u6e80\u305f\u305b\u306a\u3044\n\u3053\u306e\u5b9f\u9a13\u3067\u3001\u4ee5\u4e0b\u306e\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\n\u65e5\u4ed8\u6642\u523b\u306e\u4fee\u6b63\u6a5f\u80fd\u3068\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\uff08+c true +C no_time_warp\uff09\u3067\u52d5\u4f5c\u3057\u3066\u308b\u6642\u306b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5909\u66f4\u3055\u308c\u308b\u3068\u3001Erlang \u5b9f\u884c\u74b0\u5883\u306f\u3001\u5185\u90e8\u30af\u30ed\u30c3\u30af\u3092\u308f\u305a\u304b\u306b\u65e9\u3081\u305f\u308a\u9045\u3089\u305b\u305f\u308a\u3059\u308b\u3053\u3068\u3067\u3001\u5f90\u3005\u306b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306b\u540c\u671f\u3055\u305b\u3066\u3044\u304f\n\u7d04\uff11\u5206\u306e\u5dee\u306e\u6642\u306f\u3001\u540c\u671f\u3067\u304d\u308b\u307e\u3067\uff12\u6642\u9593\u307b\u3069\u304b\u304b\u308b\n\n\u5148\u307b\u3069\uff13\u3064\u306e\u7528\u9014\u3092\u6319\u3052\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u52d5\u4f5c\u3067\u306f\u3001\u8981\u4ef6\uff11\u304c\u4e00\u6642\u7684\u306b\u6e80\u305f\u305b\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u8981\u4ef6\uff12\u306b\u3082\u591a\u5c11\u306e\u8aa4\u5dee\u306e\u5f71\u97ff\u304c\u51fa\u307e\u3059\u3002\n\n\n\n\n\u8981\u4ef6\n\u6e80\u305f\u305b\u308b\uff1f\n\u8aac\u660e\n\n\n\n\n1\n\u73fe\u5728\u6642\u523b\u3092\u6b63\u78ba\u306b\u5f97\u3089\u308c\u308b\n\u6e80\u305f\u305b\u306a\u3044\n\u540c\u671f\u3067\u304d\u308b\u307e\u3067 OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3068\u306f\u7570\u306a\u308b\u6642\u9593\u304c\u8fd4\u3055\u308c\u308b\n\n\n2\n\u7d4c\u904e\u6642\u9593\u3092\u6b63\u78ba\u306b\u6e2c\u5b9a\u3067\u304d\u308b\n\u3042\u308b\u7a0b\u5ea6\u6e80\u305f\u305b\u308b\n\u5b9f\u884c\u74b0\u5883\u306e\u30af\u30ed\u30c3\u30af\u304c\u65e9\u307e\u3063\u305f\u308a\u9045\u307e\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u3001\u591a\u5c11\u306e\u8aa4\u5dee\u304c\u751f\u3058\u308b\n\n\n3\n\u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u5f97\u3089\u308c\u308b\n\u6e80\u305f\u305b\u308b\n\n\n\n\n\u4eca\u56de\u306e\u3088\u3046\u306a\u7d04\uff11\u5206\u306e\u4fee\u6b63\u306a\u3089\u554f\u984c\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3053\u308c\u304c\u3082\u3057\u6570\u65e5\u3001\u6570\u30ab\u6708\u3001\u6570\u5e74\u3060\u3063\u305f\u3089...\u3001\u540c\u671f\u3067\u304d\u308b\u307e\u3067\u9577\u3044\u6642\u9593\u304c\u304b\u304b\u308b\u3053\u3068\u304c\u4e88\u60f3\u3055\u308c\u307e\u3059\u3002\u305d\u306e\u5834\u5408\u306f\u3001\u7de9\u3084\u304b\u306a\u540c\u671f\u3092\u3042\u304d\u3089\u3081\u3066\u3001Erlang \u5b9f\u884c\u74b0\u5883\u3092\u518d\u8d77\u52d5\u3057\u305f\u307b\u3046\u304c\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\u5b9f\u9a13\uff12\uff1aerlang:now/0 \u306e\u307e\u307e\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u3092 multi_time_warp \u306b\u3059\u308b\nmulti_time_warp \u306f\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u3092\u4f55\u5ea6\u3067\u3082\u8a31\u3059\u30e2\u30fc\u30c9\u3067\u3059\u3002\uff13\u3064\u306e\u8981\u4ef6\u3092\u540c\u6642\u306b\u6e80\u305f\u3059\u305f\u3081\u306b\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002\u305f\u3060\u3057\u3001\u65b0\u3057\u3044 API \u3092\u4f7f\u3046\u3053\u3068\u304c\u524d\u63d0\u3068\u306a\u3063\u3066\u304a\u308a\u3001erlang:now/0 \u306f\u3046\u307e\u304f\u52d5\u304d\u307e\u305b\u3093\u3002\u3042\u3048\u3066\u3069\u3046\u306a\u308b\u304b\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u307e\u305a\u306f\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9032\u3081\u3066\u69d8\u5b50\u3092\u898b\u307e\u3059\u3002\n$ erl +C multi_time_warp\n1> TR = t1:repeat_time_legacy().\n\n...\uff08\u4e2d\u7565\uff09...\n\n---------\nos:timestamp {1449,413463,778835} -> {{2015,12,6},{22,51,3}}\nerlang:now   {1449,413463,778838} -> {{2015,12,6},{22,51,3}} (3 us)\n---------\nos:timestamp {1449,413464,778928} -> {{2015,12,6},{22,51,4}}\nerlang:now   {1449,413464,778931} -> {{2015,12,6},{22,51,4}} (3 us)\n---------\nos:timestamp {1449,413520,586649} -> {{2015,12,6},{22,52,0}}    %% <-- \uff11\u5206\u9032\u3093\u3060\nerlang:now   {1449,413465,780749} -> {{2015,12,6},{22,51,5}} (-54805900 us)\n---------\nos:timestamp {1449,413521,584824} -> {{2015,12,6},{22,52,1}}\nerlang:now   {1449,413466,778924} -> {{2015,12,6},{22,51,6}} (-54805900 us)\n---------\n\n20\u79d2\u307b\u3069\u5f85\u3064\u3068 erlang:now/0 \u306b\u53cd\u6620\u3055\u308c\u307e\u3057\u305f\u3002\uff11\u5206\u307b\u3069\u672a\u6765\u3078\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u3057\u305f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n---------\nos:timestamp {1449,413539,584833} -> {{2015,12,6},{22,52,19}}\nerlang:now   {1449,413484,778933} -> {{2015,12,6},{22,51,24}} (-54805900 us)\n---------\nos:timestamp {1449,413540,584901} -> {{2015,12,6},{22,52,20}}\nerlang:now   {1449,413540,584904} -> {{2015,12,6},{22,52,20}} (3 us) %% <-- \uff11\u5206\u9032\u3093\u3060\n---------\nos:timestamp {1449,413541,584880} -> {{2015,12,6},{22,52,21}}\nerlang:now   {1449,413541,584883} -> {{2015,12,6},{22,52,21}} (3 us)\n\n\u4eca\u5ea6\u306f\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9045\u3089\u305b\u307e\u3059\u3002\n---------\nos:timestamp {1449,413579,584737} -> {{2015,12,6},{22,52,59}}\nerlang:now   {1449,413579,584740} -> {{2015,12,6},{22,52,59}} (3 us)\n---------\nos:timestamp {1449,413580,584721} -> {{2015,12,6},{22,53,0}}\nerlang:now   {1449,413580,584724} -> {{2015,12,6},{22,53,0}} (3 us)\n---------\nos:timestamp {1449,413526,650929} -> {{2015,12,6},{22,52,6}}    %% <-- \uff11\u5206\u9045\u308c\u305f\nerlang:now   {1449,413581,584852} -> {{2015,12,6},{22,53,1}} (54933923 us)\n---------\nos:timestamp {1449,413527,650829} -> {{2015,12,6},{22,52,7}}\nerlang:now   {1449,413582,584752} -> {{2015,12,6},{22,53,2}} (54933923 us)\n\n20\u79d2\u307b\u3069\u5f85\u3064\u3068 erlang:now/0 \u306e\u8868\u3059\u73fe\u5728\u6642\u523b\u304c {22,53,19} \u306e\u307e\u307e\u52d5\u304b\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\uff01\n---------\nos:timestamp {1449,413542,651066} -> {{2015,12,6},{22,52,22}}\nerlang:now   {1449,413597,584987} -> {{2015,12,6},{22,53,17}} (54933921 us)\n---------\nos:timestamp {1449,413543,649822} -> {{2015,12,6},{22,52,23}}\nerlang:now   {1449,413598,583745} -> {{2015,12,6},{22,53,18}} (54933923 us)\n---------\nos:timestamp {1449,413544,650759} -> {{2015,12,6},{22,52,24}}\nerlang:now   {1449,413599,584682} -> {{2015,12,6},{22,53,19}} (54933923 us)  %% <-- \u6b62\u307e\u3063\u305f!?\n---------\nos:timestamp {1449,413545,650699} -> {{2015,12,6},{22,52,25}}\nerlang:now   {1449,413599,584683} -> {{2015,12,6},{22,53,19}} (53933984 us)\n---------\nos:timestamp {1449,413546,650708} -> {{2015,12,6},{22,52,26}}\nerlang:now   {1449,413599,584684} -> {{2015,12,6},{22,53,19}} (52933976 us)\n---------\nos:timestamp {1449,413547,650583} -> {{2015,12,6},{22,52,27}}\nerlang:now   {1449,413599,584685} -> {{2015,12,6},{22,53,19}} (51934102 us)\n---------\nos:timestamp {1449,413548,650827} -> {{2015,12,6},{22,52,28}}\nerlang:now   {1449,413599,584686} -> {{2015,12,6},{22,53,19}} (50933859 us)\n\n\u3067\u3082\u3088\u304f\u898b\u308b\u3068\u3001erlang:now/0 \u3092\u547c\u3076\u3054\u3068\u306b\uff11\u30de\u30a4\u30af\u30ed\u79d2\u3060\u3051\u9032\u3093\u3067\u307e\u3059\u3002\u3053\u308c\u306f\u8981\u4ef6\uff13\u3092\u6e80\u305f\u3059\u305f\u3081\u3067\u3059\u306d\u3002\n%% `erlang:now/0` \u3092\u547c\u3076\u3054\u3068\u306b\uff11\u30de\u30a4\u30af\u30ed\u79d2\u3060\u3051\u9032\u3093\u3067\u308b\n\nerlang:now   {1449,413599,584682} -> ...\nerlang:now   {1449,413599,584683} -> ...\nerlang:now   {1449,413599,584684} -> ...\nerlang:now   {1449,413599,584685} -> ...\nerlang:now   {1449,413599,584686} -> ...\n\n\n\u305f\u3057\u304b\u306b\u3053\u308c\u3067\u306f\u4f7f\u3048\u306a\u3044\n\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u3092 multi_time_warp \u306b\u3057\u305f\u3068\u3053\u308d\u3001erlang:now/0 \u3067\u306f\u8981\u4ef6\uff11\u304c\u300c\u3042\u308b\u7a0b\u5ea6\u300d\u6e80\u305f\u305b\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u304c\u3001\u305d\u308c\u3068\u5f15\u304d\u63db\u3048\u306b\u8981\u4ef6\uff12\u304c\u6e80\u305f\u305b\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n\n\n\n\u8981\u4ef6\n\u6e80\u305f\u305b\u308b\uff1f\n\u8aac\u660e\n\n\n\n\n1\n\u73fe\u5728\u6642\u523b\u3092\u6b63\u78ba\u306b\u5f97\u3089\u308c\u308b\n\u9032\u307e\u305b\u305f\u6642\u306f\u6e80\u305f\u305b\u308b\u3001 \u9045\u3089\u305b\u305f\u6642\u306f\u6e80\u305f\u305b\u306a\u3044\n\u9045\u3089\u305b\u305f\u6642\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u8ffd\u3044\u3064\u3044\u3066\u304f\u308b\u307e\u3067\u3001\u307b\u307c\u540c\u3058\u6642\u523b\u3092\u8fd4\u3057\u7d9a\u3051\u308b\uff08\u547c\u3076\u6bce\u306b\uff11\u30de\u30a4\u30af\u30ed\u79d2\u3060\u3051\u9032\u3080\u304c\uff09\n\n\n2\n\u7d4c\u904e\u6642\u9593\u3092\u6b63\u78ba\u306b\u6e2c\u5b9a\u3067\u304d\u308b\n\u6e80\u305f\u305b\u306a\u3044\n\u9032\u307e\u305b\u305f\u6642\u306f\u9032\u3093\u3060\u5206\u3060\u3051\u306e\u6642\u9593\u304c\u7d4c\u904e\u6642\u9593\u306b\u4e0a\u4e57\u305b\u3055\u308c\u308b\u3002\u9045\u3089\u305b\u305f\u6642\u306f\u3001\u7d4c\u904e\u6642\u9593\u304c\u307b\u3070\uff10\u306b\u306a\u308b\n\n\n3\n\u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u5f97\u3089\u308c\u308b\n\u6e80\u305f\u305b\u308b\n\n\n\n\n\n\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\u3082\u963b\u5bb3\u3055\u308c\u308b\n\u5b9f\u9a13\uff11\u3001\u5b9f\u9a13\uff12\u5171\u306b\u3001\u8981\u4ef6\uff13\u306f\u5e38\u306b\u6e80\u305f\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002erlang:now/0 \u3092\u30e6\u30cb\u30fc\u30af\u306a\u5024\u306e\u751f\u6210\u306b\u4f7f\u3063\u3066\u3044\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u591a\u6570\u5b58\u5728\u3059\u308b\u305f\u3081\u3001\u3053\u3053\u3060\u3051\u306f\u3069\u3046\u3057\u3066\u3082\u6e80\u305f\u3055\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002\u4e00\u65b9\u3001\u3053\u306e\u3053\u3068\u304c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6027\u80fd\uff08\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\uff09\u3092\u963b\u5bb3\u3059\u308b\u8981\u56e0\u306b\u3082\u306a\u3063\u3066\u3044\u307e\u3059\u3002\nerlang:now/0 \u304c\u8907\u6570\u306e Erlang \u8efd\u91cf\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u540c\u6642\u306b\u547c\u3070\u308c\u305f\u5834\u5408\u3067\u3082\u3001\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304c strictly monotonically increasing number \u3067\u3042\u308b\u3053\u3068\u3092\u4fdd\u8a3c\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u305d\u306e\u305f\u3081\u306b\u306f\u3001\u30ed\u30c3\u30af\u3092\u5c0e\u5165\u3057\u3066\u3001\u8907\u6570\u306e\u547c\u3073\u51fa\u3057\u3092\u3001\u9806\u756a\u306b\u51e6\u7406\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u3082\u3057\u3001\u305f\u304f\u3055\u3093\u306e\u8efd\u91cf\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u540c\u6642\u306b\u547c\u3073\u51fa\u3055\u308c\u305f\u3089\u3001\u3053\u306e\u9010\u6b21\u51e6\u7406\u304c\u6027\u80fd\u4e0a\u306e\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\u3082\u3057\u7528\u9014\u304c\uff11\u306e\u73fe\u5728\u6642\u523b\u3068\u304b\uff12\u306e\u7d4c\u904e\u6642\u9593\u3060\u3063\u305f\u3068\u304d\u3001\u6027\u80fd\u3092\u72a0\u7272\u306b\u3057\u3066\u307e\u3067 strictly monotonically increasing number \u3092\u4fdd\u8a3c\u3057\u3066\u3082\u3001\u7121\u99c4\u306b\u7d42\u308f\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u65b0\u3057\u3044 API \u3067\u306f\u7d4c\u904e\u6642\u9593\u3068\u73fe\u5728\u6642\u523b\u3092\u5225\u7ba1\u7406\n\u65b0\u3057\u3044 API \u3067\u306f\u3001multi_time_warp \u306e\u6642\u306b\u3001\uff13\u3064\u306e\u8981\u4ef6\u304c\u540c\u6642\u306b\u6e80\u305f\u305b\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u305f\u3081\u306b\u3001\u307e\u305a\u300c\u7d4c\u904e\u6642\u9593\u300d\u3068\u300c\u73fe\u5728\u6642\u523b\u300d\u3092\u5225\u306b\u7ba1\u7406\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u524d\u8005\u3092\u300cErlang monotonic time\u300d\u3001\u5f8c\u8005\u3092\u300cErlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u300d\u3068\u547c\u3073\u307e\u3059\u3002\n\n\u7d4c\u904e\u6642\u9593\uff1aErlang Monotonic Time\nerlang:monotonic_time/0 \u3068 erlang:monotonic_time/1 \u306f\u7d4c\u904e\u6642\u9593\u3092\u8fd4\u3057\u3001\u305d\u306e\u5024\u306f monotonically increasing number\uff08\u5e83\u7fa9\u306e\u5358\u8abf\u5897\u52a0\u6570\uff09\u3068\u306a\u308a\u307e\u3059\u3002\u3064\u307e\u308a\u300c\u524d\u56de\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3000\u2266\u3000\u4eca\u56de\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u300d\u3067\u3042\u308b\u3053\u3068\u304c\u4fdd\u8a3c\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\u3053\u3053\u3067 erlang:now/0 \u3068\u306f\u7570\u306a\u308a\u3001\u7d9a\u3051\u3066\u547c\u3093\u3060\u6642\u306b\u3001\u540c\u3058\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304c\u8fd4\u308b\u5834\u5408\u304c\u3042\u308b\u3053\u3068\u306b\u6ce8\u76ee\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u8981\u4ef6\u3092\u7de9\u3081\u305f\u3053\u3068\u306b\u3088\u308a\u30ed\u30c3\u30af\u304c\u4e0d\u7528\u3068\u306a\u308a\u3001\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\u306e\u554f\u984c\u3082\u89e3\u6c7a\u3057\u307e\u3059\u3002\nerlang:monotonic_time/0 \u306f\u7d4c\u904e\u6642\u9593\u3092 Erlang \u5b9f\u884c\u74b0\u5883\u306b\u4f9d\u5b58\u3059\u308b\u30cd\u30a4\u30c6\u30a3\u30d6\u306e\u5206\u89e3\u80fd\uff08resolution\u3001\u307e\u305f\u306f\u3001time unit \u3068\u547c\u3073\u307e\u3059\uff09\u3067\u8fd4\u3057\u307e\u3059\u3002erlang:monotonic_time/1 \u306f\u3001\u30cd\u30a4\u30c6\u30a3\u30d6\u306e time unit \u3092\u3001\u5f15\u6570\u3067\u4e0e\u3048\u305f time unit \u306b\u5909\u63db\u3057\u3066\u304b\u3089\u8fd4\u3057\u307e\u3059\u3002\n1> erlang:monotonic_time().\n-576460745061874838\n2> erlang:monotonic_time(nano_seconds).\n-576460739326652626\n3> erlang:monotonic_time(micro_seconds).\n-576460732117796\n4> erlang:monotonic_time(milli_seconds).\n-576460727635\n5> erlang:monotonic_time(seconds).\n-576460724\n\n\u30cd\u30a4\u30c6\u30a3\u30d6\u306e\u5206\u89e3\u80fd\u306f erlang:convert_time_unit(1, seconds, native) \u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n6> erlang:convert_time_unit(1, seconds, native).\n1000000000\n\n\u3053\u306e\u4f8b\u3067\u306f\u5206\u89e3\u80fd\u306f10\u306e\uff19\u4e57\u3067\u3001\u6700\u5c0f\u5358\u4f4d\u306f\uff11\u79d2 \u00d7 10\u306e\u30de\u30a4\u30ca\u30b9\uff19\u4e57\u3001\u3059\u306a\u308f\u3061\u30ca\u30ce\u79d2\u3060\u3068\u308f\u304b\u308a\u307e\u3059\u3002\u306a\u304a\u5206\u89e3\u80fd\uff08resolution\uff09\u306f\u3001\u7cbe\u5ea6\uff08accuracy\uff09\u3068\u306f\u5225\u7269\u3067\u3059\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3044\u3002monotonic time \u304c\u30ca\u30ce\u79d2\u3067\u8fd4\u3055\u308c\u308b\u304b\u3089\u3068\u3044\u3063\u3066\u3001\u30ca\u30ce\u79d2\u306e\u30ec\u30d9\u30eb\u3067\u6b63\u78ba\u306b\u6642\u3092\u523b\u3093\u3067\u3044\u308b\u3068\u306f\u9650\u308a\u307e\u305b\u3093\u3002\u3080\u3057\u308d\u3001\u305d\u3046\u3067\u306a\u3044\u3053\u3068\u304c\u666e\u901a\u3067\u3059\u3002\nerlang:monotonic_time/0 \u306e\u623b\u308a\u5024\u306f\u6574\u6570\u306a\u306e\u3067\u3001\u7528\u9014\uff12\u306e\u7d4c\u904e\u6642\u9593\u3092\u8a08\u308b\u306b\u306f\u3001\u5358\u306b\u5927\u304d\u3044\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304b\u3089\u3001\u5c0f\u3055\u3044\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u5f15\u3051\u3070\u3044\u3044\u3067\u3059\u3002\u30cd\u30a4\u30c6\u30a3\u30d6\u306e time unit \u3092\u4f7f\u7528\u3057\u305f\u5834\u5408\u306f\u3001erlang:convert_time_unit/3 \u3067\u76ee\u7684\u306e time unit \u306b\u5909\u63db\u3059\u308b\u3068\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n7> Start = erlang:monotonic_time().\n-576460698329582382\n8> End = erlang:monotonic_time().\n-576460692495322130\n9> End - Start.\n5834260252\n10> erlang:convert_time_unit(End - Start, native, milli_seconds).\n5834\n\n\u306a\u304a\u3001\u3042\u308b Erlang \u5b9f\u884c\u74b0\u5883\u3067\u53d6\u5f97\u3057\u305f monotonic time \u3092\u3001\u4ed6\u306e Erlang \u5b9f\u884c\u74b0\u5883\u3067\u53d6\u5f97\u3057\u305f\u305d\u308c\u3068\u3001\u524d\u5f8c\u306e\u6bd4\u8f03\u3092\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002monotonic time \u306f\u300c\u3042\u308b\u4efb\u610f\u306e\u6642\u70b9\u300d\u304b\u3089\u306e\u7d4c\u904e\u6642\u9593\u3092\u8868\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3001\u305d\u306e\u8d77\u70b9\u304c\u3044\u3064\u306a\u306e\u304b\u306f\u500b\u3005\u306e\u5b9f\u884c\u74b0\u5883\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002\u5b9f\u884c\u74b0\u5883\u9593\u3067\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u524d\u5f8c\u6bd4\u8f03\u3092\u3057\u305f\u3044\u3068\u304d\u306f\u3001\u6b21\u306e\u9805\u3067\u7d39\u4ecb\u3059\u308b\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u53d6\u5f97\u3057\u3066\u3001monotonic time \u304b\u3089\u5b9f\u969b\u306e\u6642\u523b\u306b\u5909\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nErlang monotonic time \u306f\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306e\u5f71\u97ff\u3092\u53d7\u3051\u307e\u305b\u3093\u3002OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5909\u66f4\u3055\u308c\u3066\u3082\u3001\u305d\u306e\u5f71\u97ff\u3092\u53d7\u3051\u305a\u3001\u5358\u8abf\u306b\u5897\u52a0\u3057\u7d9a\u3051\u307e\u3059\u3002\u3053\u306e\u3053\u3068\u304c\u3001\u65b0\u3057\u3044 API \u306e\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308a\u307e\u3059\u3002\n\nErlang Monotonic Time \u304b\u3089 Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3078\u306e\u30aa\u30d5\u30bb\u30c3\u30c8\nErlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u306f\u5b9f\u969b\u306e\u6642\u523b\u3092\u8868\u3057\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306e\u5bfe\u8c61\u3068\u306a\u308a\u307e\u3059\u3002multi_time_warp \u30e2\u30fc\u30c9\u306e\u6642\u306b\u3001OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u904e\u53bb\u3084\u672a\u6765\u3078\u5909\u66f4\u3055\u308c\u305f\u3089\u3001Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3082\u540c\u3058\u3088\u3046\u306b\u5909\u66f4\u3055\u308c\u307e\u3059\u3002\nerlang:time_offset/0 \u3068 erlang:time_offset/1 \u306f Erlang monotonic time \u304b\u3089 Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3078\u306e\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u8fd4\u3057\u307e\u3059\u3002\u3064\u307e\u308a erlang:monotonic_time/0 \u304c\u8fd4\u3057\u305f\u5024\u306b\u3001erlang:time_offset/0 \u304c\u8fd4\u3057\u305f\u5024\u3092\u8db3\u3059\u3068\u3001\u8981\u4ef6\uff11\u306e\u73fe\u5728\u6642\u523b\uff08Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3001UNIX \u30a8\u30dd\u30c3\u30af\u304b\u3089\u306e\u7d4c\u904e\u6642\u9593\uff09\u304c\u3001\u30cd\u30a4\u30c6\u30a3\u30d6\u306e time unit \u3067\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\u3053\u306e\u3088\u3046\u306b\u66f8\u304f\u3068\u3001Erlang \u5b9f\u884c\u74b0\u5883\u306e\u4e2d\u306b monotonic time \u3092\u5b9f\u73fe\u3059\u308b\u30a8\u30f3\u30b8\u30f3\u3068\u3001\u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3092\u5b9f\u73fe\u3059\u308b\u30a8\u30f3\u30b8\u30f3\u306e\u3001\uff12\u3064\u306e\u30a8\u30f3\u30b8\u30f3\u304c\u5165\u3063\u3066\u3044\u308b\u3088\u3046\u306b\u601d\u3048\u307e\u3059\u304c\u3001\u5f8c\u8005\u306f\u3042\u304f\u307e\u3067\u3082\u6982\u5ff5\u4e0a\u306e\u3082\u306e\u3067\u3001\u30b3\u30fc\u30c9\u3067\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002Erlang \u5b9f\u884c\u74b0\u5883\u306b\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u306e\u306f\u3001monotonic time \u3092\u523b\u307f\u7d9a\u3051\u308b\u30a8\u30f3\u30b8\u30f3\u3068\u3001\u3053\u306e time offset \u3060\u3051\u3067\u3059\u3002\n11> MT = erlang:monotonic_time().\n-576460636631757928\n12> OS = erlang:time_offset().\n2025874384294795734\n13> MT + OS.\n1449413747663037806\n14> erlang:convert_time_unit(MT + OS, native, milli_seconds).\n1449413747663\n\n\n\u3053\u306e\u64cd\u4f5c\u3092\u5408\u6210\u3057\u305f erlang:system_time/0 \u3068 erlang:system_time/1 \u3082\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u666e\u6bb5\u306f\u305d\u3061\u3089\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\u307e\u305f\u3001\u3055\u3089\u306b\u3053\u308c\u3092 erlang:now/0 \u5f62\u5f0f\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306b\u5909\u63db\u3057\u3066\u304b\u3089\u8fd4\u3059 erlang:timestamp/0 \u3082\u3042\u308a\u307e\u3059\u3002\n15> erlang:system_time(milli_seconds).\n1449413805302\n16> erlang:timestamp().\n{1449,413821,303246}\n17> calendar:now_to_local_time(erlang:timestamp()).\n{{2015,12,6},{22,57,6}}\n\n\u305f\u3060\u3057\u3001erlang:timestamp/0 \u304c\u8fd4\u3059\u5024\u306f\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306e\u5bfe\u8c61\u3068\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u8981\u4ef6\uff13\u306f\u6e80\u305f\u3057\u307e\u305b\u3093\u3002\u6b21\u306e\u9805\u3067\u7d39\u4ecb\u3059\u308b\u95a2\u6570\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u8981\u4ef6\uff13\u3092\u6e80\u305f\u3059\u5c02\u7528\u95a2\u6570\n\u8981\u4ef6\uff13\u3092\u6e80\u305f\u3059\u305f\u3081\u306b\u3001\u5c02\u7528\u306e\u95a2\u6570 erlang:unique_integer/0 \u3068 erlang:unique_integer/1 \u304c\u7528\u610f\u3055\u308c\u307e\u3057\u305f\u3002\n18> erlang:unique_integer().\n-576460752303423486\n19> erlang:unique_integer().\n-576460752303423482\n20> erlang:unique_integer([positive]).\n11\n21> erlang:unique_integer([positive]).\n15\n22> erlang:unique_integer([positive, monotonic]).\n1\n23> erlang:unique_integer([positive, monotonic]).\n2\n24> erlang:unique_integer([positive, monotonic]).\n3\n\nerlang:unique_integer/0 \u306f\u30e6\u30cb\u30fc\u30af\u306a\u6574\u6570\u3092\u8fd4\u3059\u3053\u3068\u3060\u3051\u304c\u4fdd\u8a3c\u3055\u308c\u3066\u304a\u308a\u3001\u6b63\u306e\u6574\u6570\u3068\u8ca0\u306e\u6574\u6570\u304c\u3001\u305d\u306e\u5927\u5c0f\u306b\u95a2\u4fc2\u306a\u304f\u8fd4\u3055\u308c\u307e\u3059\u3002\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u3057\u3066\u3001positive \u3092\u4e0e\u3048\u308b\u3068\u3001\u6b63\u306e\u6574\u6570\u3060\u3051\u3092\u8fd4\u3059\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002monotinic \u3092\u4e0e\u3048\u308b\u3068\u3001erlang:now/0 \u306e\u3088\u3046\u306a\u3001\u300c\u524d\u56de\u306e\u5024 \uff1c \u4eca\u56de\u306e\u5024\u300d\u3068\u306a\u308b\u6574\u6570\u3092\u8fd4\u3059\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u72ec\u7acb\u3057\u305f\u95a2\u6570\u306b\u3057\u305f\u3053\u3068\u3067\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u5f71\u97ff\u3092\u53d7\u3051\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\u307e\u305f\u3001\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\u3092\u6539\u5584\u3059\u308b\u305f\u3081\u306b\u3001\u69d8\u3005\u306a\u30c6\u30af\u30cb\u30c3\u30af\u304c\u7528\u3044\u3089\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\u5b9f\u9a13\uff13\uff1amulti_time_warp \u30e2\u30fc\u30c9\u3067\u65b0\u3057\u3044 API \u3092\u8a66\u3059\n\u65b0\u3057\u3044 API \u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u52d5\u4f5c\u78ba\u8a8d\u306e\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n-module(t2).\n\n-compile(export_all).\n\n-spec print_time_otp18() -> ok.\nprint_time_otp18() ->\n    OSTS = os:timestamp(),\n    MT   = erlang:monotonic_time(),\n    TOS  = erlang:time_offset(),\n    LocalTimeOSTS = calendar:now_to_local_time(OSTS),\n    LocalTimeMT   = calendar:now_to_local_time(system_time_to_now(MT + TOS)),\n    Diff = timer:now_diff(system_time_to_now(MT + TOS), OSTS),\n    io:format(\"---------~n\"\n              \"os:timestamp   ~p -> ~p~n\"\n              \"monotonic_time ~w~n\"\n              \"time_offset    ~w~n\"\n              \"                                    -> ~p (~w us)~n\",\n              [OSTS, LocalTimeOSTS,\n               MT, TOS, LocalTimeMT, Diff]).\n\n-spec repeat_time_otp18() -> timer:tref().\nrepeat_time_otp18() ->\n    {ok, TRef} =\n        timer:apply_interval(1000, ?MODULE, print_time_otp18, []),\n    TRef.\n\n-spec system_time_to_now(integer()) -> erlang:timestamp().\nsystem_time_to_now(NativeSystemTime) ->\n    ST = erlang:convert_time_unit(NativeSystemTime, native, micro_seconds),\n    MegaSecs = ST div 1000000000000,\n    Secs = ST div 1000000 - MegaSecs * 1000000,\n    MicroSecs = ST rem 1000000,\n    {MegaSecs, Secs, MicroSecs}.\n\nsystem_time_to_now/1 \u306f\u30cd\u30a4\u30c6\u30a3\u30d6 time unit \u306e Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3092 erlang:now/0 \u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306b\u5909\u63db\u3059\u308b\u305f\u3081\u306b\u4f5c\u308a\u307e\u3057\u305f\u3002\u5b9f\u969b\u306e\u904b\u7528\u3067\u306f\u3001erlang:monotinic_time/0 \u3068 erlang:time_offset/0 \u3092\u4f7f\u308f\u305a\u306b\u3001erlang:timestamp/0 \u3067\u4e00\u6c17\u306b\u6c42\u3081\u308b\u307b\u3046\u304c\u697d\u3067\u3057\u3087\u3046\u3002\n\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n$ erl +C multi_time_warp\n...\n1> c(t2).\n{ok,t2}\n2> t2:print_time_otp18().\n---------\nos:timestamp   {1449,414031,427546} -> {{2015,12,6},{23,0,31}}\nmonotonic_time -576460700481595263\ntime_offset    2025874731852149836\n                                    -> {{2015,12,6},{23,0,31}} (-56992 us)\nok\n3> TR2 = t2:repeat_time_otp18().\n{interval,#Ref<0.0.1.97>}\n4> ---------\nos:timestamp   {1449,414049,442162} -> {{2015,12,6},{23,0,49}}\nmonotonic_time -576460682466981138\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,0,49}} (4 us)\n---------\nos:timestamp   {1449,414050,447735} -> {{2015,12,6},{23,0,50}}\nmonotonic_time -576460681461409266\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,0,50}} (3 us)\n\n\n\u6642\u523b\u3092\u9032\u307e\u305b\u3066\u307f\u308b\n\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9032\u3081\u307e\u3059\u3002\n---------\nos:timestamp   {1449,414061,442729} -> {{2015,12,6},{23,1,1}}\nmonotonic_time -576460670466414376\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,1,1}} (4 us)\n---------\nos:timestamp   {1449,414120,165533} -> {{2015,12,6},{23,2,0}}   %% <-- \uff11\u5206\u9032\u3093\u3060\nmonotonic_time -576460669467591586\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,1,2}} (-57723977 us)\n---------\nos:timestamp   {1449,414121,165884} -> {{2015,12,6},{23,2,1}}\nmonotonic_time -576460668467240566\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,1,3}} (-57723977 us)\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u300140\u79d2\u307b\u3069\u7d4c\u3063\u3066\u304b\u3089 erlang:time_offset/0 \u304c\u5909\u66f4\u3055\u308c\u3001OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3068\u540c\u3058\u6642\u9593\u304c\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u6642\u523b\u3092\u9032\u3081\u305f\u6642\u306f\u3001\u8981\u4ef6\uff11\u306e\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97\u304c\u6e80\u305f\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n---------\nos:timestamp   {1449,414159,166963} -> {{2015,12,6},{23,2,39}}\nmonotonic_time -576460630466161469\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,1,41}} (-57723977 us)\n---------\nos:timestamp   {1449,414160,166153} -> {{2015,12,6},{23,2,40}}\nmonotonic_time -576460629466971281\ntime_offset    2025874789633128715   \u3000\u3000\u3000\u3000\u3000\u3000                        %% <-- \u5909\u308f\u3063\u305f\n                                    -> {{2015,12,6},{23,2,40}} (4 us)  %% <-- \uff11\u5206\u9032\u3093\u3060\n---------\nos:timestamp   {1449,414161,167540} -> {{2015,12,6},{23,2,41}}\nmonotonic_time -576460628465584511\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,2,41}} (4 us)\n\n\u4e00\u65b9\u3067\u3001erlang:monotinic_time/0 \u306f\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u5909\u66f4\u306e\u5f71\u97ff\u3092\u53d7\u3051\u305a\u3001\u5358\u8abf\u306b\u5897\u52a0\u3057\u7d9a\u3051\u307e\u3057\u305f\u3002\n1> erlang:convert_time_unit(-576460629466971281 - -576460630466161469,\n1>                          native, micro_seconds).\n999190\n\n\u3053\u308c\u306b\u3088\u308a\u8981\u4ef6\uff12\u306e\u7d4c\u904e\u6642\u9593\u3092\u8a08\u308b\u3053\u3068\u3082\u5e38\u306b\u6e80\u305f\u3055\u308c\u307e\u3059\u3002\n\n\u6642\u523b\u3092\u9045\u3089\u305b\u3066\u307f\u308b\n\u4eca\u5ea6\u306f\u6642\u523b\u3092\u623b\u3057\u307e\u3059\u3002\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9045\u3089\u305b\u307e\u3057\u305f\u3002\n---------\nos:timestamp   {1449,414352,166058} -> {{2015,12,6},{23,5,52}}\nmonotonic_time -576460437467066070\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,5,52}} (4 us)\n---------\nos:timestamp   {1449,414353,166167} -> {{2015,12,6},{23,5,53}}\nmonotonic_time -576460436466957641\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,5,53}} (4 us)\n---------\nos:timestamp   {1449,414296,450902} -> {{2015,12,6},{23,4,56}}   %% <-- \uff11\u5206\u9045\u308c\u305f\nmonotonic_time -576460435467079298\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,5,54}} (57715147 us)\n---------\nos:timestamp   {1449,414297,451731} -> {{2015,12,6},{23,4,57}}\nmonotonic_time -576460434466249931\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,5,55}} (57715147 us)\n\n45\u79d2\u307b\u3069\u7d4c\u3063\u3066\u304b\u3089\u3001erlang:time_offset/0 \u306b\u3082\u53cd\u6620\u3055\u308c\u307e\u3057\u305f\u3002\u6642\u523b\u3092\u9045\u3089\u305b\u305f\u6642\u3082\u3001\u8981\u4ef6\uff11\u306e\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97\u304c\u6e80\u305f\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n---------\nos:timestamp   {1449,414341,454290} -> {{2015,12,6},{23,5,41}}\nmonotonic_time -576460390463691730\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,6,39}} (57715146 us)\n\n---------\nos:timestamp   {1449,414342,451029} -> {{2015,12,6},{23,5,42}}\nmonotonic_time -576460389466952117\ntime_offset    2025874731917985060                                     %% <-- \u5909\u308f\u3063\u305f\n                                    -> {{2015,12,6},{23,5,42}} (3 us)  %% <-- \uff11\u5206\u9045\u308c\u305f\n---------\nos:timestamp   {1449,414343,450941} -> {{2015,12,6},{23,5,43}}\nmonotonic_time -576460388467040215\ntime_offset    2025874731917985060\n                                    -> {{2015,12,6},{23,5,43}} (3 us)\n\n\n\u3084\u306f\u308a erlang:monotinic_time/0 \u306f\u5f71\u97ff\u3092\u53d7\u3051\u305a\u3001\u5358\u8abf\u306b\u5897\u52a0\u3057\u7d9a\u3051\u307e\u3057\u305f\u3002\n1> erlang:convert_time_unit(-576460389466952117 - -576460390463691730,\n1>                          native, micro_seconds).\n996739\n\n\n\u7d50\u8ad6\n\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u3092 multi_time_warp \u306b\u3057\u3066\u3001\u65b0\u3057\u3044 API \u3092\u8a66\u3057\u305f\u3068\u3053\u308d\u3001\u8981\u4ef6\uff11\u3068\u8981\u4ef6\uff12\u304c\u5e38\u306b\u6e80\u305f\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\u8981\u4ef6\uff13\u306b\u3064\u3044\u3066\u306f\u5b9f\u9a13\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001\u6642\u523b\u304b\u3089\u72ec\u7acb\u3057\u305f\u95a2\u6570\u304c\u5c0e\u5165\u3055\u308c\u305f\u305f\u3081\u3001\u305d\u306e\u52b9\u679c\u306f\u660e\u78ba\u3067\u3057\u3087\u3046\u3002\u307e\u3068\u3081\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n\n\n\u8981\u4ef6\n\u6e80\u305f\u305b\u308b\uff1f\n\u8aac\u660e\n\n\n\n\n1\n\u73fe\u5728\u6642\u523b\u3092\u6b63\u78ba\u306b\u5f97\u3089\u308c\u308b\n\u6e80\u305f\u305b\u308b\nOS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5909\u66f4\u3055\u308c\u305f\u6642\u306f\u3001\u6570\u5341\u79d2\u4ee5\u5185\u306b\u30aa\u30d5\u30bb\u30c3\u30c8\u306b\u53cd\u6620\u3055\u308c\u3001\u6b63\u3057\u3044\u6642\u523b\u304c\u5f97\u3089\u308c\u308b\n\n\n2\n\u7d4c\u904e\u6642\u9593\u3092\u6b63\u78ba\u306b\u6e2c\u5b9a\u3067\u304d\u308b\n\u6e80\u305f\u305b\u308b\nmonotonic time \u306f\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u5f71\u97ff\u3092\u53d7\u3051\u305a\u306b\u5358\u8abf\u5897\u52a0\u3059\u308b\n\n\n3\n\u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u5f97\u3089\u308c\u308b\n\u6e80\u305f\u305b\u308b\n\u5b9f\u9a13\u3067\u306f\u672a\u78ba\u8a8d\u3060\u304c\u3001\u6642\u523b\u304b\u3089\u72ec\u7acb\u3057\u305f\u95a2\u6570\u304c\u5c0e\u5165\u3055\u308c\u305f\u305f\u3081\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u5f71\u97ff\u3092\u53d7\u3051\u306a\u3044\u3068\u8003\u3048\u3089\u308c\u308b\n\n\n\n\u306a\u304a\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e no_time_warp \u306e\u307e\u307e\u3060\u3068\u3001\u305b\u3063\u304b\u304f\u65b0\u3057\u3044 API \u3092\u4f7f\u7528\u3057\u3066\u3082\u3001Erlang system clock \u304c\u7de9\u3084\u304b\u306b\u540c\u671f\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u3001\u8981\u4ef6\uff11\u304c\u6e80\u305f\u305b\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3044\u3002\uff08no_time_warp \u3067\u306f time offset \u306f\u5909\u308f\u3089\u305a\u306b\u3001monotonic time \u306e\u9032\u884c\u901f\u5ea6\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\uff09\n\n\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306e\u691c\u51fa\nOTP 18 \u3067\u306f\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u304c\u8d77\u3053\u3063\u305f\u6642\u306b\u3001\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n$ erl +C multi_time_warp\n...\n1> erlang:monitor(time_offset, clock_service).\n#Ref<0.0.1.416>\n2> receive Msg -> Msg end.\n\n\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9032\u3081\u308b\u3068...\n{'CHANGE',#Ref<0.0.1.416>,time_offset,clock_service,\n          2025874833587923080}\n\n\u65b0\u3057\u3044\u30aa\u30d5\u30bb\u30c3\u30c8 2025874833587923080 \u304c\u901a\u77e5\u3055\u308c\u307e\u3057\u305f\u3002\u3053\u306e\u3088\u3046\u306b\u3001\u30af\u30ed\u30c3\u30af\u3092\u76e3\u8996\u3057\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u304c\u8d77\u3053\u308b\u3054\u3068\u306b\u65b0\u3057\u3044 \u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u53d7\u3051\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u307e\u3068\u3081\nOTP 18 \u3088\u308a\u524d\u306e\u30ea\u30ea\u30fc\u30b9\u3067\u306f erlang:now/0 \u306b\uff13\u3064\u306e\u8981\u4ef6\u304c\u6c42\u3081\u3089\u308c\u3066\u3044\u305f\u305f\u3081\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u3092\u8d77\u3053\u3059\u3068\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08\u304a\u3088\u3073\u3001OTP\u81ea\u4f53\uff09\u304c\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u306a\u304f\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u305d\u306e\u305f\u3081\u3001Erlang \u5b9f\u884c\u74b0\u5883\u306f\u3001OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5909\u66f4\u3055\u308c\u305f\u6642\u306b\u3001\u305d\u306e\u3053\u3068\u3092\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u96a0\u3057\u306a\u304c\u3089\u3001\u6b63\u3057\u3044\u6642\u523b\u3078\u7de9\u3084\u304b\u306b\u540c\u671f\u3059\u308b\u4ed5\u7d44\u307f\u306b\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u304c\u8d77\u3053\u3089\u306a\u3044\u3053\u3068\u306b\u3088\u308a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ed\u30b8\u30c3\u30af\u306f\u7c21\u7565\u5316\u3055\u308c\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4e00\u65b9\u3067\u3001\u305a\u308c\u305f\u6642\u9593\u304c\u623b\u308b\u307e\u3067\u3001\u9577\u3044\u6642\u9593\u304c\uff08\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u4f55\u5e74\u9593\u3082\uff09\u304b\u304b\u308b\u3068\u3044\u3046\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u307e\u305f\u3001erlang:now/0 \u306f\u5185\u90e8\u3067\u30ed\u30c3\u30af\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\u306e\u554f\u984c\u3082\u3042\u308a\u307e\u3057\u305f\u3002\nOTP 18 \u3067\u306f\u65b0\u3057\u3044\u6642\u523b\u95a2\u9023 API \u3068\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u3092\u5c0e\u5165\u3057\u305f\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u304c\u8d77\u3053\u3063\u305f\u6642\u3067\u3082\u3001\uff13\u3064\u306e\u8981\u4ef6\u3092\u6e80\u305f\u3057\u305f\u307e\u307e\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\u9069\u5207\u306a\u5bfe\u5fdc\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002Erlang \u5b9f\u884c\u74b0\u5883\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u5909\u66f4\u3092\u96a0\u3059\u306e\u3067\u306f\u306a\u304f\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u5373\u5ea7\u306b\u901a\u77e5\u3057\u3066\u5bfe\u5fdc\u3092\u59d4\u306d\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ed\u30b8\u30c3\u30af\u306f\u8907\u96d1\u306b\u306a\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u307b\u3068\u3093\u3069\u306e\u5834\u5408\u3001\u8981\u4ef6\u306b\u5373\u3057\u305f\u3001\u3088\u308a\u5805\u7262\u306a\u3082\u306e\u306b\u306a\u308b\u3068\u671f\u5f85\u3055\u308c\u307e\u3059\u3002\n\u300cErlang Run-Time System Application(ERTS) User's Guide\u300d\u306e\u300cTime and Time Correction in Erlang\u300d\u3067\u306f\u3001\u65b0\u3057\u3044 API \u3078\u306e\u5207\u308a\u66ff\u3048\u65b9\u6cd5\u3092\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5177\u4f53\u4f8b\u3092\u6319\u3052\u3066\u89e3\u8aac\u3057\u3066\u3044\u307e\u3059\u3002\u305c\u3072\u4e00\u5ea6\u3001\u8aad\u3093\u3067\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\nRetrieve Erlang System Time\uff08Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3092\u53d6\u5f97\u3059\u308b\uff09\nMeasure Elapsed Time\uff08\u7d4c\u904e\u6642\u9593\u3092\u6e2c\u5b9a\u3059\u308b\uff09\nDetermine Order of Events\uff08\u30a4\u30d9\u30f3\u30c8\u304c\u767a\u751f\u3057\u305f\u9806\u5e8f\u3092\u6c7a\u5b9a\u3059\u308b\uff09\nDetermine Order of Events With Time of the Event\uff08\u30a4\u30d9\u30f3\u30c8\u304c\u767a\u751f\u3057\u305f\u6642\u523b\u3092\u5143\u306b\u3001\u305d\u306e\u9806\u5e8f\u3092\u6c7a\u5b9a\u3059\u308b\uff09\nCreate a Unique Name\uff08\u30e6\u30cb\u30fc\u30af\u306a\u540d\u524d\u3092\u751f\u6210\u3059\u308b\uff09\nSeed Random Number Generation With a Unique Value\uff08\u4e71\u6570\u751f\u6210\u5668\u306b\u30e6\u30cb\u30fc\u30af\u306a\u30b7\u30fc\u30c9\u5024\u3092\u4e0e\u3048\u308b\uff09\n\n\u6700\u5f8c\u306e\u4f8b\u306f\u3001random \u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u60f3\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u305d\u3046\u3044\u3046\u66f8\u304d\u63db\u3048\u3092\u3059\u308b\u3088\u308a\u3082\u3001\u65b0\u305f\u306b\u5c0e\u5165\u3055\u308c\u305f rand \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5207\u308a\u66ff\u3048\u308b\u3053\u3068\u304c\u7d76\u5bfe\u304a\u52e7\u3081\u3067\u3059\u3002\n\nOTP 18.0-rc2\u3067\u5165\u3063\u305f\u7591\u4f3c\u4e71\u6570rand\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u3064\u3044\u3066\n\n\u307e\u305f\u3001Time and Time Correction in Erlang \u3067\u306f\u3001\u3082\u3046\u3072\u3068\u3064\u306e\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9 single_time_warp \u306b\u3064\u3044\u3066\u3082\u89e3\u8aac\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u3061\u3089\u306f\u3001\u65e2\u5b58\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u307b\u3068\u3093\u3069\u5909\u66f4\u305b\u305a IoT \u30c7\u30d0\u30a4\u30b9\u306b\u5bfe\u5fdc\u3055\u305b\u305f\u3044\u6642\u306a\u3069\u306b\u5f79\u7acb\u3061\u305d\u3046\u3067\u3059\u3002\nErlang/OTP 18 \u306e\u5b9f\u884c\u74b0\u5883\uff08ERTS \u30d0\u30fc\u30b8\u30e7\u30f3 7.0\uff09\u3067\u306f\u3001\u6642\u523b\u306b\u95a2\u9023\u3059\u308b\u65b0\u3057\u3044 API \u3068\u3001Time Warp\uff08\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\uff09\u30e2\u30fc\u30c9\u304c\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002\u3053\u306e\u8a18\u4e8b\u3067\u306f\u3001ERTS \u30e6\u30fc\u30b6\u30fc\u30ac\u30a4\u30c9\u306e\u300c[Time and Time Correction in Erlang](http://www.erlang.org/doc/apps/erts/time_correction.html)\u300d\u4e2d\u3067\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308b\u6982\u5ff5\u306b\u3064\u3044\u3066\u3001\u5b9f\u9a13\u3092\u901a\u3057\u3066\u78ba\u8a8d\u3057\u3088\u3046\u3068\u601d\u3044\u307e\u3059\u3002\n\n\n## OTP 17 \u307e\u3067\u306f `erlang:now/0` \u3092\u4f7f\u3044\u307e\u308f\u3057\u3066\u304d\u305f\n\nOTP 18 \u3088\u308a\u524d\u306e\u30ea\u30ea\u30fc\u30b9\u3067\u306f\u3001\u73fe\u5728\u6642\u523b\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u53d6\u5f97\u3059\u308b API \u3068\u3057\u3066\u3001`erlang:now/0` \u304c\u4f7f\u308f\u308c\u3066\u304d\u307e\u3057\u305f\u3002\u307e\u305f\u3001\u985e\u4f3c\u306e\u3082\u306e\u306b `os:timestamp/0` \u3082\u3042\u308a\u307e\u3059\u3002\u524d\u8005\u306f Erlang \u5b9f\u884c\u74b0\u5883\uff08Erlang VM\uff09\u306e\u4e2d\u3067\u7ba1\u7406\u3055\u308c\u3066\u3044\u308b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304b\u3089\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u53d6\u5f97\u3057\u3001\u5f8c\u8005\u306f OS \u304c\u7ba1\u7406\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304b\u3089\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n```erl\n1> F = fun() -> {erlang:now(), os:timestamp()} end.\n#Fun<erl_eval.20.54118792>\n2> F().\n{{1449,412303,848793},{1449,412303,848798}}\n```\n\n\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f\u5de6\u304b\u3089\u3001\u30e1\u30ac\u79d2\u3001\u79d2\u3001\u30de\u30a4\u30af\u30ed\u79d2\u3068\u306a\u3063\u3066\u304a\u308a\u3001\u3053\u308c\u3089\u3092\u8db3\u3057\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u3001[UNIX \u30a8\u30dd\u30c3\u30af](https://ja.wikipedia.org/wiki/UNIX%E6%99%82%E9%96%93)\u304b\u3089\u306e\u7d4c\u904e\u6642\u9593\u3092\u3001\u30de\u30a4\u30af\u30ed\u79d2\u306e\u5206\u89e3\u80fd\u3067\u5f97\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u306a\u304a\u3001`erlang:now()` \u306f\u3001\u5358\u306b `now()` \u3068\u66f8\u304f\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\n```erl\n3> {MegaSecs, Secs, MicroSecs} = now().\n{1449,412312,352252}\n4> CurrentTimeMicro = MegaSecs * 1000000000000 + Secs * 1000000 + MicroSecs.\n1449412312352252\n5> CurrentTimeMicro div 1000000.\n1449412312\n```\n\n```shell-session\n$ date --date='@1449412312'\nSun Dec  6 22:31:52 CST 2015\n```\n\n\uff08\u3061\u306a\u307f\u306b CST \u306f China Standard Time \u3067\u3059\u3002\u3044\u307e\u4e0a\u6d77\u306b\u4f4f\u3093\u3067\u307e\u3059\uff09\n\n\u6700\u521d\u306e\u4f8b\u3067\u3001`erlang:now/0` \u3068 `os:timestamp/0` \u306e\u8fd4\u3057\u305f\u5024\u306b\uff15\u30de\u30a4\u30af\u30ed\u79d2\u306e\u958b\u304d\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u308c\u306f\u3001\uff12\u3064\u306e\u95a2\u6570\u3092\u540c\u6642\u3067\u306f\u306a\u304f\u9806\u756a\u306b\u547c\u3093\u3060\u305f\u3081\u3067\u3059\u3002\n\n\n### \u7528\u9014\uff11\uff1a\u73fe\u5728\u6642\u523b\u3092\u53d6\u5f97\u3059\u308b\n\n`erlang:now/0` \u306f\u3044\u304f\u3064\u304b\u306e\u7528\u9014\u306b\u4f7f\u308f\u308c\u3066\u304d\u307e\u3057\u305f\u3002\u6700\u521d\u306b\u601d\u3044\u6d6e\u304b\u3076\u7528\u9014\u306f\u3001\u3042\u305f\u308a\u307e\u3048\u3067\u3059\u304c\u300c\u73fe\u5728\u65e5\u6642\u306e\u53d6\u5f97\u300d\u3067\u3059\u3002`calendar` \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u306f\u3001\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u5404\u7a2e\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u5f62\u5f0f\u3078\u5909\u63db\u3059\u308b\u95a2\u6570\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n```erl\n5> calendar:now_to_local_time(now()).\n{{2015,12,6},{22,32,49}}    %% 2015\u5e7412\u67086\u65e5\u300022\u664232\u520649\u79d2\n```\n\n\n### \u7528\u9014\uff12\uff1a\u7d4c\u904e\u6642\u9593\u3092\u8a08\u308b\n\n\uff12\u3064\u76ee\u306e\u7528\u9014\u306f\u300c\u7d4c\u904e\u6642\u9593\u306e\u6e2c\u5b9a\u300d\u3067\u3059\u3002`timer` \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u95a2\u6570\u3092\u4f7f\u3046\u3068\u3001\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304b\u3089\u7d4c\u904e\u6642\u9593\u3092\u3001\u30de\u30a4\u30af\u30ed\u79d2\u306e\u5206\u89e3\u80fd\u3067\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\n```erl\n6> Start = now().\n{1449,412383,80755}\n7> End = now().\n{1449,412387,489901}\n8> timer:now_diff(End, Start).\n4409146\u3000 %% \u5358\u4f4d\uff1a\u30de\u30a4\u30af\u30ed\u79d2\n9> timer:now_diff(End, Start) / 1000000.\n4.409146\u3000%% \u5358\u4f4d\uff1a\u79d2\n```\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u3042\u308b\u4e00\u5b9a\u306e\u9593\u9694\u3067\u51e6\u7406\u3092\u5b9f\u884c\u3057\u305f\u308a\u3001\u901a\u4fe1\u3067\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u767a\u751f\u3055\u305b\u305f\u308a\u3001\u6027\u80fd\u3092\u6e2c\u5b9a\u3057\u305f\u308a\u3068\u3044\u3063\u305f\u3053\u3068\u304c\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002\n\n\n### \u7528\u9014\uff13\uff1a\u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u751f\u6210\u3059\u308b\n\n\uff13\u3064\u3081\u306e\u7528\u9014\u306f\u300c\u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u306e\u751f\u6210\u300d\u3067\u3059\u3002`erlang:now/0` \u306f\u3001\u5358\u306b\u73fe\u5728\u6642\u523b\u3092\u8fd4\u3059\u3060\u3051\u3067\u306a\u304f\u3001\u305d\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304c strictly monotonically increasing number\uff08\u72ed\u7fa9\u306e\u5358\u8abf\u5897\u52a0\u6570\uff09\u3067\u3042\u308b\u3053\u3068\u3092\u4fdd\u8a3c\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u8907\u6570\u306e\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u540c\u6642\u306b\uff08\uff11\u30de\u30a4\u30af\u30ed\u79d2\u672a\u6e80\u306e\u6642\u5dee\u3067\uff09\u547c\u3070\u308c\u3066\u3082\u3001\u5fc5\u305a\u300c\u524d\u56de\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7 \uff1c \u4eca\u56de\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u300d\u3068\u306a\u308b\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002\n\n\u3053\u308c\u306b\u3088\u308a\u3001\u30e6\u30cb\u30fc\u30af\u306a\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3ID\u306e\u751f\u6210\u306a\u3069\u306b\u3082\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n### \u6642\u523b\u95a2\u9023 API \u306b\u6c42\u3081\u3089\u308c\u3066\u304d\u305f\uff13\u3064\u306e\u8981\u4ef6\n\n\u3053\u308c\u3089\u306e\u7528\u9014\u304b\u3089\u3001\u6642\u523b\u95a2\u9023\u306e API \u306b\u6c42\u3081\u3089\u308c\u308b\u8981\u4ef6\u306b\u306f\u3001\u4ee5\u4e0b\u306e\uff13\u3064\u304c\u3042\u308b\u3068\u8a00\u3048\u305d\u3046\u3067\u3059\u3002\n\n   | \u8981\u4ef6 | \u8aac\u660e\n:-:|:----|:----\n 1 | \u73fe\u5728\u6642\u523b\u3092\u6b63\u78ba\u306b\u5f97\u3089\u308c\u308b | OS \u304c\u63d0\u4f9b\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u793a\u3059\u6642\u523b\u304c\u3001\u5e38\u306b\u5f97\u3089\u308c\u308b\n 2 | \u7d4c\u904e\u6642\u9593\u3092\u6b63\u78ba\u306b\u6e2c\u5b9a\u3067\u304d\u308b | \uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u5dee\u304b\u3089\u3001\u7d4c\u904e\u6642\u9593\u3092\u8a08\u308b\u3053\u3068\u304c\u3067\u304d\u308b\n 3 | \u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u5f97\u3089\u308c\u308b | \u95a2\u6570\u3092\u547c\u3076\u6bce\u306b\u3001\u91cd\u8907\u3057\u306a\u3044\u5024\u304c\u8fd4\u3055\u308c\u308b\u3053\u3068\u304c\u4fdd\u8a3c\u3055\u308c\u3066\u3044\u308b\u3002\u4e00\u4f8b\u3068\u3057\u3066 strictly monotonically increasing number \u304c\u3042\u308b\n\n\uff13\u306f\u5fc5\u305a\u3057\u3082\u6642\u523b\u95a2\u9023\u306e API \u3067\u5b9f\u73fe\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u3057\u304b\u3057 OTP 18 \u3088\u308a\u524d\u306e\u30ea\u30ea\u30fc\u30b9\u3067\u306f `erlang:now/0` \u304c\u305d\u306e\u5f79\u5272\u3092\u62c5\u3063\u3066\u304d\u307e\u3057\u305f\u3002\n\n\n## `erlang:now/0` \u306f\u307e\u3082\u306a\u304f\u5ec3\u6b62\u3055\u308c\u308b\n\n\u3053\u306e\u3088\u3046\u306b\u3001\u3042\u308b\u610f\u5473\u3067\u4fbf\u5229\u306b\u4f7f\u308f\u308c\u3066\u304d\u305f `erlang:now/0` \u3067\u3059\u304c\u3001OTP 18 \u3067\u306f deprecated \u3068\u306a\u308a\u307e\u3057\u305f\u3002\u8fd1\u3005\u5ec3\u6b62\u3055\u308c\u308b\u4e88\u5b9a\u3067\u3059\u3002\u306a\u305c\u3067\u3057\u3087\u3046\u304b\uff1f\n\n\n### \u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u4fee\u6b63\u306b\u5bfe\u5fdc\u3057\u304d\u308c\u306a\u3044\n\n`erlang:now/0` \u306f\u30de\u30b7\u30f3\u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u3001\u3044\u3064\u3082\u6b63\u78ba\u3067\u3042\u308b\u3053\u3068\u3092\u524d\u63d0\u306b\u4f5c\u3089\u308c\u305f\u3088\u3046\u306a\u95a2\u6570\u3067\u3059\u3002\u30af\u30ed\u30c3\u30af\u304c\u6b63\u78ba\u3067\u3042\u308b\u9650\u308a\u3001\uff13\u3064\u306e\u8981\u4ef6\u3092\u540c\u6642\u306b\u6e80\u305f\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u3057\u304b\u3057\u3001\u3082\u3057\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5927\u304d\u304f\u30ba\u30ec\u3066\u3001\u6b63\u3057\u3044\u6642\u9593\u306b\u4fee\u6b63\u3055\u308c\u305f\u306a\u3089...\u3001`erlang:now/0` \u3067\u306f\u6570\u5341\u5206\u7a0b\u5ea6\u306e\u4fee\u6b63\u306a\u3089\u5bfe\u5fdc\u3067\u304d\u307e\u3059\u304c\u3001\u305d\u308c\u4ee5\u4e0a\u3060\u3068\u53b3\u3057\u304f\u306a\u308a\u307e\u3059\u3002\n\n\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u3044\u3064\u3082\u6b63\u78ba\u3067\u3042\u308c\u3070\u826f\u3044\u306e\u3067\u3059\u304c\u3001\u73fe\u5b9f\u306f\u305d\u3046\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\u653e\u3063\u3066\u304a\u3051\u3070\u5c11\u3057\u305a\u3064\u72c2\u3063\u3066\u3044\u304d\u307e\u3059\u306e\u3067\u3001\u6b63\u3057\u3044\u6642\u523b\u306b\u5408\u308f\u305b\u76f4\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\u7279\u306b\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u30b2\u30b9\u30c8\u5074\u3067\u306f\u3053\u306e\u50be\u5411\u304c\u5f37\u3044\u3088\u3046\u3067\u3059\u3002\u3082\u3063\u3068\u7cbe\u5ea6\u306e\u9ad8\u3044\u30af\u30ed\u30c3\u30af\u3001\u4f8b\u3048\u3070\u539f\u5b50\u6642\u8a08\u3092\u642d\u8f09\u3059\u308c\u3070\u3044\u3044\u3088\u3046\u306b\u3082\u601d\u3048\u307e\u3059\u304c\u3001\u3053\u308c\u3067\u6551\u3048\u308b\u306e\u306f\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u30db\u30b9\u30c8\u5074\u306e\u307f\u3067\u3001\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u3067\u30a8\u30df\u30e5\u30ec\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u30b2\u30b9\u30c8\u5074\u306e\u30af\u30ed\u30c3\u30af\u307e\u3067\u306f\u76f4\u305b\u307e\u305b\u3093\u3002\u305d\u306e\u305f\u3081\u3001NTP\u306a\u3069\u3067\u88dc\u6b63\u3059\u308b\u308f\u3051\u3067\u3059\u304c\u3001\u3053\u308c\u3082\u5e38\u306b\u5229\u7528\u53ef\u80fd\u306a\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002\n\n\u3055\u3089\u306b\u3001\u4eca\u5f8c\u306f IoT\uff08\u30e2\u30ce\u306e\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\uff09\u30c7\u30d0\u30a4\u30b9\u3082\u5897\u3048\u3066\u304f\u308b\u3067\u3057\u3087\u3046\u3002\u305d\u306e\u3088\u3046\u306a\u30c7\u30d0\u30a4\u30b9\u3067\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u30d0\u30c3\u30c6\u30ea\u30fc\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u6301\u305f\u305a\u3001\u30b7\u30b9\u30c6\u30e0\u8d77\u52d5\u76f4\u5f8c\u306f\u30af\u30ed\u30c3\u30af\u304c\u521d\u671f\u72b6\u614b\u306b\u306a\u308b\u3082\u306e\u3082\u591a\u3044\u3067\u3059\u3002\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u8d77\u52d5\u3057\u3066\u3057\u3070\u3089\u304f\u3057\u3066\u304b\u3089\u3001NTP\u306a\u3069\u306b\u3088\u3063\u3066\u6642\u523b\u304c\u5408\u3046\u3001\u306a\u3093\u3066\u3053\u3068\u304c\u666e\u901a\u306b\u884c\u308f\u308c\u3066\u3044\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\nOTP 18 \u306e\u65b0\u3057\u3044\u6642\u523b\u95a2\u9023 API \u3068\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u306f\u3001\u3053\u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u4fee\u6b63\u306b\u95a2\u3059\u308b\u554f\u984c\u3092\u3001\u6839\u672c\u7684\u306b\u89e3\u6c7a\u3059\u308b\u305f\u3081\u306b\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002\n\n\n## \u5b9f\u9a13\uff11\uff1a\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u72c2\u308f\u305b\u3066\u307f\u308b\n\n\u65b0\u3057\u3044 API \u3092\u898b\u308b\u524d\u306b\u3001\u307e\u305a\u306f `erlang:now/0` \u304c\u3069\u3093\u306a\u98a8\u306b\u632f\u308b\u821e\u3046\u304b\u3001\u305d\u3057\u3066\u3001\u305d\u308c\u304c\u306a\u305c\u554f\u984c\u306a\u306e\u304b\u3092\u5b9f\u9a13\u3067\u78ba\u8a8d\u3057\u307e\u3057\u3087\u3046\u3002x86_64 \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30fc\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u3067 GNU/Linux\uff08CentOS 7\uff09\u3068 Erlang/OTP \u3092\u7a3c\u50cd\u3055\u305b\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u4fee\u6b63\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u3053\u306e\u4eee\u60f3\u30de\u30b7\u30f3\u306f ntpd \u306b\u3088\u308b\u6642\u523b\u5408\u308f\u305b\u306f\u884c\u3063\u3066\u3044\u307e\u305b\u3093\u3002`ntpdate` \u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u3001OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u5408\u308f\u305b\u3066\u304a\u304d\u307e\u3059\u3002\n\n```shell-session\n$ sudo ntpdate -b jp.pool.ntp.org\n 6 Dec 22:36:37 ntpdate[2766]: step time server 129.250.35.251 offset 0.014679 sec\n```\n\n\n### \u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u72b6\u614b\n\nOTP 18 \u3067\u306f `erl` \u306e\u8d77\u52d5\u5f15\u6570\u306b\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9 `+C` \u304c\u8ffd\u52a0\u3055\u308c\u307e\u3057\u305f\u3002\n\n```shell-session\n$ erl +C hoge\nInvalid time warp mode: hoge\nUsage: beam.smp [flags] [ -- [init_args] ]\nThe flags are:\n...\n-C mode        set time warp mode; valid modes are:\n               no_time_warp|single_time_warp|multi_time_warp\n```\n\n\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u3068\u306f\u3001Erlang \u5b9f\u884c\u74b0\u5883\u5185\u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u3001\u672a\u6765\u3084\u904e\u53bb\u306e\u6642\u9593\u306b\u30b8\u30e3\u30f3\u30d7\u3059\u308b\u3053\u3068\u3092\u6307\u3057\u3066\u3044\u307e\u3059\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306f `no_time_warp` \u3067\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306f\u7981\u6b62\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u306f OTP 18 \u3088\u308a\u524d\u306e\u30ea\u30ea\u30fc\u30b9\u3068\u4e92\u63db\u6027\u3092\u4fdd\u3064\u305f\u3081\u306e\u30e2\u30fc\u30c9\u3067\u3001\u3053\u306e\u8a2d\u5b9a\u306e\u307e\u307e\u4f7f\u3063\u3066\u3082\u3001\u65b0\u3057\u3044 API \u306e\u6069\u6075\u3092\u30d5\u30eb\u306b\u53d7\u3051\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002\u307e\u305a\u306f\u5f93\u6765\u306e\u52d5\u4f5c\u3092\u77e5\u308b\u305f\u3081\u306b\u3001\u3053\u306e\u30e2\u30fc\u30c9\u3067\u8d77\u52d5\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u307e\u305f\u3001\u904e\u53bb\u306e\u30ea\u30ea\u30fc\u30b9\u304b\u3089\u3059\u3067\u306b `+c` \u3068\u3044\u3046\u30d5\u30e9\u30b0\u3082\u7528\u610f\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u308c\u306f date/time correction \uff08\u65e5\u4ed8\u6642\u523b\u306e\u4fee\u6b63\uff09\u6a5f\u80fd\u306e\u30aa\u30f3\u30fb\u30aa\u30d5\u3092\u5207\u308a\u66ff\u3048\u308b\u305f\u3081\u306e\u3082\u306e\u3067\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306f `true` \uff08\u4fee\u6b63\u6a5f\u80fd\u3092\u30aa\u30f3\u306b\u3059\u308b\uff09\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u3061\u3089\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u307e\u307e\u306b\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044\u3002\u3082\u3057\u30aa\u30d5\u306b\u3059\u308b\u3068\u3001`no_time_warp` \u3082\u542b\u3081\u3066\u3001\u6642\u523b\u4fee\u6b63\u306b\u95a2\u3059\u308b\u6a5f\u80fd\u304c\u52d5\u4f5c\u3057\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u306a\u304a\u3001OTP \u306f 2015\u5e7412\u6708\u4e0a\u65ec\u6642\u70b9\u3067\u6700\u65b0\u306e 18.1.5 \u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\u3002\n\n```shell-session\n$ cat /etc/centos-release\nCentOS Linux release 7.1.1503 (Core)\n$ kerl list installations\n18.1.5_hipe /home/tatsuya/erlang/18.1.5_hipe\n17.5.6.5_hipe /home/tatsuya/erlang/17.5.6.5_hipe\n$ source ~/erlang/18.1.5_hipe/activate\n$ kerl active\nThe current active installation is:\n/home/tatsuya/erlang/18.1.5_hipe\n$ erl\nErlang/OTP 18 [erts-7.1] [source] [64-bit] [smp:2:2] [async-threads:10] [hipe] [kernel-poll:false]\n\nEshell V7.1  (abort with ^G)\n1> (Ctrl + G)\nUser switch command\n --> q\n$ curl -O https://raw.githubusercontent.com/tatsuya6502/erlang-examples/master/show-otp-version.escript\n$ chmod +x show-otp-version.escript\n$ echo $(./show-otp-version.escript)\n18.1.5\n```\n\n\u52d5\u4f5c\u78ba\u8a8d\u306e\u305f\u3081\u306b\u3001\u7c21\u5358\u306a\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\n\n```erlang\n-module(t1).\n\n-compile(export_all).\n\n-spec print_time_legacy() -> ok.\nprint_time_legacy() ->\n    OSTS = os:timestamp(),\n    Now  = now(),\n    LocalTimeOSTS = calendar:now_to_local_time(OSTS),\n    LocalTimeNow  = calendar:now_to_local_time(Now),\n    Diff = timer:now_diff(Now, OSTS),\n    io:format(\"---------~n\"\n              \"os:timestamp ~p -> ~p~n\"\n              \"erlang:now   ~p -> ~p (~w us)~n\",\n              [OSTS, LocalTimeOSTS,\n               Now, LocalTimeNow, Diff]).\n\n-spec repeat_time_legacy() -> timer:tref().\nrepeat_time_legacy() ->\n    {ok, TRef} =\n        timer:apply_interval(1000, ?MODULE, print_time_legacy, []),\n    TRef.\n```\n\n\u30b3\u30f3\u30d1\u30a4\u30eb\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002`print_time_legacy/0` \u306f\u3001`os:timestamp/0` \u3068 `erlang:now()/0` \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3068\u3001`calendar:now_to_localtime/1` \u3067\u5909\u63db\u3057\u305f\u73fe\u5728\u6642\u523b\u3092\u8868\u793a\u3057\u307e\u3059\u3002\u305d\u3057\u3066\u3001\u6700\u5f8c\u306b\u3001\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u6642\u9593\u5dee\u3092\u3001\u30de\u30a4\u30af\u30ed\u79d2\u306e\u7cbe\u5ea6\u3067\u8868\u793a\u3057\u307e\u3059\u3002\n\n\n```erl\n$ erl\n1> c(t1).\nt1.erl:7: Warning: erlang:now/0: Deprecated BIF. See the \"Time and Time\nCorrection in Erlang\" chapter of the ERTS User's Guide for more\ninformation.\n{ok,t1}\n2> t1:print_time_legacy().\n---------\nos:timestamp {1449,412756,285759} -> {{2015,12,6},{22,39,16}}\nerlang:now   {1449,412756,285763} -> {{2015,12,6},{22,39,16}} (4 us)\nok\n3>\n```\n\n`repeat_time_legacy/0` \u306f\u3001`print_time_legacy/0` \u304c\uff11\u79d2\u9593\u9694\u3067\u5b9f\u884c\u3055\u308c\u308b\u3088\u3046\u3001\u30bf\u30a4\u30de\u30fc\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u623b\u308a\u5024\u306f\u3001\u30bf\u30a4\u30de\u30fc\u306e Ref \u3067\u3059\u3002\n\n```erl\n3> TR = t1:repeat_time_legacy().\ninterval,#Ref<0.0.1.97>\n4> ---------\nos:timestamp {1449,412765,128993} -> {{2015,12,6},{22,39,25}}\nerlang:now   {1449,412765,128997} -> {{2015,12,6},{22,39,25}} (4 us)\n---------\nos:timestamp {1449,412766,129985} -> {{2015,12,6},{22,39,26}}\nerlang:now   {1449,412766,129989} -> {{2015,12,6},{22,39,26}} (4 us)\n---------\nos:timestamp {1449,412767,130912} -> {{2015,12,6},{22,39,27}}\nerlang:now   {1449,412767,130915} -> {{2015,12,6},{22,39,27}} (3 us)\n---------\nos:timestamp {1449,412768,128955} -> {{2015,12,6},{22,39,28}}\nerlang:now   {1449,412768,128959} -> {{2015,12,6},{22,39,28}} (4 us)\n4> timer:cancel(TR).\n{ok,cancel}\n5>\n```\n\n\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u5dee\u306f\u6570\u30de\u30a4\u30af\u30ed\u79d2\u306b\u304a\u3055\u307e\u3063\u3066\u3044\u307e\u3059\u3002\n\n\n#### \u6642\u523b\u3092\u9032\u307e\u305b\u3066\u307f\u308b\n\n\u3067\u306f\u3001`repeat_time_legacy/0` \u304c\u52d5\u4f5c\u3057\u3066\u3044\u308b\u72b6\u614b\u3067\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9032\u3081\u3066\u307f\u307e\u3059\u3002\n\n```shell-session\n$ date\nSun Dec  6 22:41:48 CST 2015\n$ sudo date 12062243\nSun Dec  6 22:43:00 CST 2015\n```\n\n`print_time_legacy/0` \u306e\u8868\u793a\u3092\u898b\u308b\u3068\u3001`os:timestamp/0` \u5074\u3067\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u6642\u523b\u304c\u3059\u3050\u306b\u53cd\u6620\u3055\u308c\u307e\u3057\u305f\u3002\u4e00\u65b9\u3067 `erlang:now/0` \u5074\u306e\u6642\u523b\u306f\u5909\u308f\u308a\u307e\u305b\u3093\u3002\n\n```erl\n---------\nos:timestamp {1449,412919,449076} -> {{2015,12,6},{22,41,59}}\nerlang:now   {1449,412919,449079} -> {{2015,12,6},{22,41,59}} (3 us)\n---------\nos:timestamp {1449,412920,448004} -> {{2015,12,6},{22,42,0}}\nerlang:now   {1449,412920,448008} -> {{2015,12,6},{22,42,0}} (4 us)\n---------\nos:timestamp {1449,412980,315715} -> {{2015,12,6},{22,43,0}}    %% <-- \uff11\u5206\u9032\u3093\u3060\nerlang:now   {1449,412921,448009} -> {{2015,12,6},{22,42,1}} (-58867706 us)\n---------\nos:timestamp {1449,412981,315559} -> {{2015,12,6},{22,43,1}}\nerlang:now   {1449,412922,447852} -> {{2015,12,6},{22,42,2}} (-58867707 us)\n```\n\n\u304c\u300130\u79d2\u307b\u3069\u5f85\u3064\u3068\u3001\u305d\u306e\u5dee\u304c\u5c11\u3057\u305a\u3064\u7e2e\u307e\u308a\u59cb\u3081\u307e\u3057\u305f\uff01\n\n```erl\nos:timestamp {1449,413014,316449} -> {{2015,12,6},{22,43,34}}\nerlang:now   {1449,412955,448742} -> {{2015,12,6},{22,42,35}} (-58867707 us)\n---------\nos:timestamp {1449,413015,316755} -> {{2015,12,6},{22,43,35}}\nerlang:now   {1449,412956,449830} -> {{2015,12,6},{22,42,36}} (-58866925 us)\n---------\nos:timestamp {1449,413016,316950} -> {{2015,12,6},{22,43,36}}\nerlang:now   {1449,412957,459793} -> {{2015,12,6},{22,42,37}} (-58857157 us)\n---------\nos:timestamp {1449,413017,307114} -> {{2015,12,6},{22,43,37}}\nerlang:now   {1449,412958,459626} -> {{2015,12,6},{22,42,38}} (-58847488 us)\n---------\nos:timestamp {1449,413018,297016} -> {{2015,12,6},{22,43,38}}\nerlang:now   {1449,412959,459194} -> {{2015,12,6},{22,42,39}} (-58837822 us)\n```\n\n\uff11\u5206\u9593\u306b\u3064\u304d\u30010.5\u79d2\u304f\u3089\u3044\u306e\u30da\u30fc\u30b9\u3067\u5dee\u304c\u7e2e\u307e\u3063\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u3068\u3044\u3046\u3053\u3068\u306f\u3001\uff11\u5206\u306e\u30ba\u30ec\u306a\u3089\u3001\uff12\u6642\u9593\u307b\u3069\u304b\u3051\u308c\u3070\u5b9f\u6642\u9593\u306b\u8ffd\u3044\u3064\u304d\u305d\u3046\u3067\u3059\u3002\n\n\n#### \u6642\u523b\u3092\u9045\u3089\u305b\u3066\u307f\u308b\n\n\u3067\u306f\u3001\u3053\u306e\u300c\u30af\u30ed\u30c3\u30af\u304c\u9032\u3093\u3060\u72b6\u614b\u300d\u304b\u3089\u3001\u6b63\u3057\u3044\u6642\u523b\u306b\u5408\u308f\u305b\u76f4\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u6642\u523b\u304c\u7d04\uff11\u5206\u904e\u53bb\u306b\u623b\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n```shell-session\n$ sudo ntpdate -b jp.pool.ntp.org\n...\n```\n\n```erl\n---------\nos:timestamp {1449,413191,594393} -> {{2015,12,6},{22,46,31}}\nerlang:now   {1449,413134,448930} -> {{2015,12,6},{22,45,34}} (-57145463 us)\n---------\nos:timestamp {1449,413192,587868} -> {{2015,12,6},{22,46,32}}\nerlang:now   {1449,413135,452106} -> {{2015,12,6},{22,45,35}} (-57135762 us)\n---------\nos:timestamp {1449,413134,760236} -> {{2015,12,6},{22,45,34}}    %% <-- \uff11\u5206\u9045\u308c\u305f\nerlang:now   {1449,413136,458810} -> {{2015,12,6},{22,45,36}} (1698574 us)\n---------\nos:timestamp {1449,413135,754355} -> {{2015,12,6},{22,45,35}}\nerlang:now   {1449,413137,462637} -> {{2015,12,6},{22,45,37}} (1708282 us)\n---------\nos:timestamp {1449,413136,742354} -> {{2015,12,6},{22,45,36}}\nerlang:now   {1449,413138,460285} -> {{2015,12,6},{22,45,38}} (1717931 us)\n\n...\uff08\u4e2d\u7565\uff09...\n\n---------\nos:timestamp {1449,413365,422641} -> {{2015,12,6},{22,49,25}}\nerlang:now   {1449,413365,448937} -> {{2015,12,6},{22,49,25}} (26296 us)\n---------\nos:timestamp {1449,413366,432637} -> {{2015,12,6},{22,49,26}}\nerlang:now   {1449,413366,449071} -> {{2015,12,6},{22,49,26}} (16434 us)\n---------\nos:timestamp {1449,413367,442907} -> {{2015,12,6},{22,49,27}}\nerlang:now   {1449,413367,449472} -> {{2015,12,6},{22,49,27}} (6565 us)\n---------\nos:timestamp {1449,413368,451275} -> {{2015,12,6},{22,49,28}}\nerlang:now   {1449,413368,447995} -> {{2015,12,6},{22,49,28}} (-3280 us)\n---------\nos:timestamp {1449,413369,449201} -> {{2015,12,6},{22,49,29}}\nerlang:now   {1449,413369,449204} -> {{2015,12,6},{22,49,29}} (3 us)\n---------\nos:timestamp {1449,413370,450116} -> {{2015,12,6},{22,49,30}}\nerlang:now   {1449,413370,450119} -> {{2015,12,6},{22,49,30}} (3 us)\n---------\nos:timestamp {1449,413371,448543} -> {{2015,12,6},{22,49,31}}\nerlang:now   {1449,413371,448546} -> {{2015,12,6},{22,49,31}} (3 us)\n```\n\n`os:timestamp/0` \u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f\u904e\u53bb\u306b\u623b\u308a\u307e\u3057\u305f\u304c\u3001`erlang:now/0` \u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f\u3001\u7d76\u5bfe\u306b\u904e\u53bb\u3078\u306f\u623b\u308a\u307e\u305b\u3093\u3002\u3053\u308c\u306f\u3001\u8981\u4ef6\uff13\u3067\u6319\u3052\u305f\u3001strictly monotonically increasing number \u3092\u6e80\u305f\u3059\u305f\u3081\u3067\u3059\u3002\n\n\u3084\u306f\u308a\u5f90\u3005\u306b\uff12\u3064\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u5dee\u304c\u72ed\u307e\u3063\u3066\u3044\u304d\u3001\u6700\u5f8c\u306f\u30ba\u30ec\u304c\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n\n### `erlang:now/0` \u3067\u306f\uff13\u3064\u306e\u7528\u9014\u3092\u540c\u6642\u306b\u6e80\u305f\u305b\u306a\u3044\n\n\u3053\u306e\u5b9f\u9a13\u3067\u3001\u4ee5\u4e0b\u306e\u3053\u3068\u304c\u308f\u304b\u308a\u307e\u3057\u305f\u3002\n\n- \u65e5\u4ed8\u6642\u523b\u306e\u4fee\u6b63\u6a5f\u80fd\u3068\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\uff08`+c true +C no_time_warp`\uff09\u3067\u52d5\u4f5c\u3057\u3066\u308b\u6642\u306b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5909\u66f4\u3055\u308c\u308b\u3068\u3001Erlang \u5b9f\u884c\u74b0\u5883\u306f\u3001\u5185\u90e8\u30af\u30ed\u30c3\u30af\u3092\u308f\u305a\u304b\u306b\u65e9\u3081\u305f\u308a\u9045\u3089\u305b\u305f\u308a\u3059\u308b\u3053\u3068\u3067\u3001\u5f90\u3005\u306b\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306b\u540c\u671f\u3055\u305b\u3066\u3044\u304f\n- \u7d04\uff11\u5206\u306e\u5dee\u306e\u6642\u306f\u3001\u540c\u671f\u3067\u304d\u308b\u307e\u3067\uff12\u6642\u9593\u307b\u3069\u304b\u304b\u308b\n\n\u5148\u307b\u3069\uff13\u3064\u306e\u7528\u9014\u3092\u6319\u3052\u307e\u3057\u305f\u304c\u3001\u3053\u306e\u52d5\u4f5c\u3067\u306f\u3001\u8981\u4ef6\uff11\u304c\u4e00\u6642\u7684\u306b\u6e80\u305f\u305b\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u8981\u4ef6\uff12\u306b\u3082\u591a\u5c11\u306e\u8aa4\u5dee\u306e\u5f71\u97ff\u304c\u51fa\u307e\u3059\u3002\n\n   | \u8981\u4ef6 | \u6e80\u305f\u305b\u308b\uff1f | \u8aac\u660e\n:-:|:-----------------|:----------|:-----------------------------------\n 1 | \u73fe\u5728\u6642\u523b\u3092\u6b63\u78ba\u306b\u5f97\u3089\u308c\u308b   | \u6e80\u305f\u305b\u306a\u3044 | \u540c\u671f\u3067\u304d\u308b\u307e\u3067 OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3068\u306f\u7570\u306a\u308b\u6642\u9593\u304c\u8fd4\u3055\u308c\u308b\n 2 | \u7d4c\u904e\u6642\u9593\u3092\u6b63\u78ba\u306b\u6e2c\u5b9a\u3067\u304d\u308b | \u3042\u308b\u7a0b\u5ea6\u6e80\u305f\u305b\u308b  | \u5b9f\u884c\u74b0\u5883\u306e\u30af\u30ed\u30c3\u30af\u304c\u65e9\u307e\u3063\u305f\u308a\u9045\u307e\u3063\u305f\u308a\u3059\u308b\u306e\u3067\u3001\u591a\u5c11\u306e\u8aa4\u5dee\u304c\u751f\u3058\u308b\n 3 | \u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u5f97\u3089\u308c\u308b | \u6e80\u305f\u305b\u308b |\n\n\u4eca\u56de\u306e\u3088\u3046\u306a\u7d04\uff11\u5206\u306e\u4fee\u6b63\u306a\u3089\u554f\u984c\u306a\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u3053\u308c\u304c\u3082\u3057\u6570\u65e5\u3001\u6570\u30ab\u6708\u3001\u6570\u5e74\u3060\u3063\u305f\u3089...\u3001\u540c\u671f\u3067\u304d\u308b\u307e\u3067\u9577\u3044\u6642\u9593\u304c\u304b\u304b\u308b\u3053\u3068\u304c\u4e88\u60f3\u3055\u308c\u307e\u3059\u3002\u305d\u306e\u5834\u5408\u306f\u3001\u7de9\u3084\u304b\u306a\u540c\u671f\u3092\u3042\u304d\u3089\u3081\u3066\u3001Erlang \u5b9f\u884c\u74b0\u5883\u3092\u518d\u8d77\u52d5\u3057\u305f\u307b\u3046\u304c\u3044\u3044\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\n\n\n## \u5b9f\u9a13\uff12\uff1a`erlang:now/0` \u306e\u307e\u307e\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u3092 `multi_time_warp` \u306b\u3059\u308b\n\n`multi_time_warp` \u306f\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u3092\u4f55\u5ea6\u3067\u3082\u8a31\u3059\u30e2\u30fc\u30c9\u3067\u3059\u3002\uff13\u3064\u306e\u8981\u4ef6\u3092\u540c\u6642\u306b\u6e80\u305f\u3059\u305f\u3081\u306b\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002\u305f\u3060\u3057\u3001\u65b0\u3057\u3044 API \u3092\u4f7f\u3046\u3053\u3068\u304c\u524d\u63d0\u3068\u306a\u3063\u3066\u304a\u308a\u3001`erlang:now/0` \u306f\u3046\u307e\u304f\u52d5\u304d\u307e\u305b\u3093\u3002\u3042\u3048\u3066\u3069\u3046\u306a\u308b\u304b\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u307e\u305a\u306f\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9032\u3081\u3066\u69d8\u5b50\u3092\u898b\u307e\u3059\u3002\n\n```erl\n$ erl +C multi_time_warp\n1> TR = t1:repeat_time_legacy().\n\n...\uff08\u4e2d\u7565\uff09...\n\n---------\nos:timestamp {1449,413463,778835} -> {{2015,12,6},{22,51,3}}\nerlang:now   {1449,413463,778838} -> {{2015,12,6},{22,51,3}} (3 us)\n---------\nos:timestamp {1449,413464,778928} -> {{2015,12,6},{22,51,4}}\nerlang:now   {1449,413464,778931} -> {{2015,12,6},{22,51,4}} (3 us)\n---------\nos:timestamp {1449,413520,586649} -> {{2015,12,6},{22,52,0}}    %% <-- \uff11\u5206\u9032\u3093\u3060\nerlang:now   {1449,413465,780749} -> {{2015,12,6},{22,51,5}} (-54805900 us)\n---------\nos:timestamp {1449,413521,584824} -> {{2015,12,6},{22,52,1}}\nerlang:now   {1449,413466,778924} -> {{2015,12,6},{22,51,6}} (-54805900 us)\n---------\n```\n\n20\u79d2\u307b\u3069\u5f85\u3064\u3068 `erlang:now/0` \u306b\u53cd\u6620\u3055\u308c\u307e\u3057\u305f\u3002\uff11\u5206\u307b\u3069\u672a\u6765\u3078\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u3057\u305f\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n```erl\n---------\nos:timestamp {1449,413539,584833} -> {{2015,12,6},{22,52,19}}\nerlang:now   {1449,413484,778933} -> {{2015,12,6},{22,51,24}} (-54805900 us)\n---------\nos:timestamp {1449,413540,584901} -> {{2015,12,6},{22,52,20}}\nerlang:now   {1449,413540,584904} -> {{2015,12,6},{22,52,20}} (3 us) %% <-- \uff11\u5206\u9032\u3093\u3060\n---------\nos:timestamp {1449,413541,584880} -> {{2015,12,6},{22,52,21}}\nerlang:now   {1449,413541,584883} -> {{2015,12,6},{22,52,21}} (3 us)\n```\n\n\u4eca\u5ea6\u306f\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9045\u3089\u305b\u307e\u3059\u3002\n\n```erl\n---------\nos:timestamp {1449,413579,584737} -> {{2015,12,6},{22,52,59}}\nerlang:now   {1449,413579,584740} -> {{2015,12,6},{22,52,59}} (3 us)\n---------\nos:timestamp {1449,413580,584721} -> {{2015,12,6},{22,53,0}}\nerlang:now   {1449,413580,584724} -> {{2015,12,6},{22,53,0}} (3 us)\n---------\nos:timestamp {1449,413526,650929} -> {{2015,12,6},{22,52,6}}    %% <-- \uff11\u5206\u9045\u308c\u305f\nerlang:now   {1449,413581,584852} -> {{2015,12,6},{22,53,1}} (54933923 us)\n---------\nos:timestamp {1449,413527,650829} -> {{2015,12,6},{22,52,7}}\nerlang:now   {1449,413582,584752} -> {{2015,12,6},{22,53,2}} (54933923 us)\n```\n\n20\u79d2\u307b\u3069\u5f85\u3064\u3068 `erlang:now/0` \u306e\u8868\u3059\u73fe\u5728\u6642\u523b\u304c `{22,53,19}` \u306e\u307e\u307e\u52d5\u304b\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3057\u305f\uff01\n\n```erl\n---------\nos:timestamp {1449,413542,651066} -> {{2015,12,6},{22,52,22}}\nerlang:now   {1449,413597,584987} -> {{2015,12,6},{22,53,17}} (54933921 us)\n---------\nos:timestamp {1449,413543,649822} -> {{2015,12,6},{22,52,23}}\nerlang:now   {1449,413598,583745} -> {{2015,12,6},{22,53,18}} (54933923 us)\n---------\nos:timestamp {1449,413544,650759} -> {{2015,12,6},{22,52,24}}\nerlang:now   {1449,413599,584682} -> {{2015,12,6},{22,53,19}} (54933923 us)  %% <-- \u6b62\u307e\u3063\u305f!?\n---------\nos:timestamp {1449,413545,650699} -> {{2015,12,6},{22,52,25}}\nerlang:now   {1449,413599,584683} -> {{2015,12,6},{22,53,19}} (53933984 us)\n---------\nos:timestamp {1449,413546,650708} -> {{2015,12,6},{22,52,26}}\nerlang:now   {1449,413599,584684} -> {{2015,12,6},{22,53,19}} (52933976 us)\n---------\nos:timestamp {1449,413547,650583} -> {{2015,12,6},{22,52,27}}\nerlang:now   {1449,413599,584685} -> {{2015,12,6},{22,53,19}} (51934102 us)\n---------\nos:timestamp {1449,413548,650827} -> {{2015,12,6},{22,52,28}}\nerlang:now   {1449,413599,584686} -> {{2015,12,6},{22,53,19}} (50933859 us)\n```\n\n\u3067\u3082\u3088\u304f\u898b\u308b\u3068\u3001`erlang:now/0` \u3092\u547c\u3076\u3054\u3068\u306b\uff11\u30de\u30a4\u30af\u30ed\u79d2\u3060\u3051\u9032\u3093\u3067\u307e\u3059\u3002\u3053\u308c\u306f\u8981\u4ef6\uff13\u3092\u6e80\u305f\u3059\u305f\u3081\u3067\u3059\u306d\u3002\n\n```erl\n%% `erlang:now/0` \u3092\u547c\u3076\u3054\u3068\u306b\uff11\u30de\u30a4\u30af\u30ed\u79d2\u3060\u3051\u9032\u3093\u3067\u308b\n\nerlang:now   {1449,413599,584682} -> ...\nerlang:now   {1449,413599,584683} -> ...\nerlang:now   {1449,413599,584684} -> ...\nerlang:now   {1449,413599,584685} -> ...\nerlang:now   {1449,413599,584686} -> ...\n```\n\n### \u305f\u3057\u304b\u306b\u3053\u308c\u3067\u306f\u4f7f\u3048\u306a\u3044\n\n\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u3092 `multi_time_warp` \u306b\u3057\u305f\u3068\u3053\u308d\u3001`erlang:now/0` \u3067\u306f\u8981\u4ef6\uff11\u304c\u300c\u3042\u308b\u7a0b\u5ea6\u300d\u6e80\u305f\u305b\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u304c\u3001\u305d\u308c\u3068\u5f15\u304d\u63db\u3048\u306b\u8981\u4ef6\uff12\u304c\u6e80\u305f\u305b\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\n\n   | \u8981\u4ef6 | \u6e80\u305f\u305b\u308b\uff1f | \u8aac\u660e\n:-:|:-----------------|:----------|:-----------------------------------\n 1 | \u73fe\u5728\u6642\u523b\u3092\u6b63\u78ba\u306b\u5f97\u3089\u308c\u308b   | \u9032\u307e\u305b\u305f\u6642\u306f\u6e80\u305f\u305b\u308b\u3001 \u9045\u3089\u305b\u305f\u6642\u306f\u6e80\u305f\u305b\u306a\u3044 | \u9045\u3089\u305b\u305f\u6642\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u8ffd\u3044\u3064\u3044\u3066\u304f\u308b\u307e\u3067\u3001\u307b\u307c\u540c\u3058\u6642\u523b\u3092\u8fd4\u3057\u7d9a\u3051\u308b\uff08\u547c\u3076\u6bce\u306b\uff11\u30de\u30a4\u30af\u30ed\u79d2\u3060\u3051\u9032\u3080\u304c\uff09\n 2 | \u7d4c\u904e\u6642\u9593\u3092\u6b63\u78ba\u306b\u6e2c\u5b9a\u3067\u304d\u308b | \u6e80\u305f\u305b\u306a\u3044 | \u9032\u307e\u305b\u305f\u6642\u306f\u9032\u3093\u3060\u5206\u3060\u3051\u306e\u6642\u9593\u304c\u7d4c\u904e\u6642\u9593\u306b\u4e0a\u4e57\u305b\u3055\u308c\u308b\u3002\u9045\u3089\u305b\u305f\u6642\u306f\u3001\u7d4c\u904e\u6642\u9593\u304c\u307b\u3070\uff10\u306b\u306a\u308b\n 3 | \u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u5f97\u3089\u308c\u308b | \u6e80\u305f\u305b\u308b |\n\n\n### \u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\u3082\u963b\u5bb3\u3055\u308c\u308b\n\n\u5b9f\u9a13\uff11\u3001\u5b9f\u9a13\uff12\u5171\u306b\u3001\u8981\u4ef6\uff13\u306f\u5e38\u306b\u6e80\u305f\u3055\u308c\u3066\u3044\u307e\u3057\u305f\u3002`erlang:now/0` \u3092\u30e6\u30cb\u30fc\u30af\u306a\u5024\u306e\u751f\u6210\u306b\u4f7f\u3063\u3066\u3044\u308b\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u591a\u6570\u5b58\u5728\u3059\u308b\u305f\u3081\u3001\u3053\u3053\u3060\u3051\u306f\u3069\u3046\u3057\u3066\u3082\u6e80\u305f\u3055\u306a\u3044\u3068\u3044\u3051\u307e\u305b\u3093\u3002\u4e00\u65b9\u3001\u3053\u306e\u3053\u3068\u304c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u6027\u80fd\uff08\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\uff09\u3092\u963b\u5bb3\u3059\u308b\u8981\u56e0\u306b\u3082\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n`erlang:now/0` \u304c\u8907\u6570\u306e Erlang \u8efd\u91cf\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u540c\u6642\u306b\u547c\u3070\u308c\u305f\u5834\u5408\u3067\u3082\u3001\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304c strictly monotonically increasing number \u3067\u3042\u308b\u3053\u3068\u3092\u4fdd\u8a3c\u3057\u306a\u3051\u308c\u3070\u306a\u308a\u307e\u305b\u3093\u3002\u305d\u306e\u305f\u3081\u306b\u306f\u3001\u30ed\u30c3\u30af\u3092\u5c0e\u5165\u3057\u3066\u3001\u8907\u6570\u306e\u547c\u3073\u51fa\u3057\u3092\u3001\u9806\u756a\u306b\u51e6\u7406\u3059\u308b\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\u3082\u3057\u3001\u305f\u304f\u3055\u3093\u306e\u8efd\u91cf\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u540c\u6642\u306b\u547c\u3073\u51fa\u3055\u308c\u305f\u3089\u3001\u3053\u306e\u9010\u6b21\u51e6\u7406\u304c\u6027\u80fd\u4e0a\u306e\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\u3082\u3057\u7528\u9014\u304c\uff11\u306e\u73fe\u5728\u6642\u523b\u3068\u304b\uff12\u306e\u7d4c\u904e\u6642\u9593\u3060\u3063\u305f\u3068\u304d\u3001\u6027\u80fd\u3092\u72a0\u7272\u306b\u3057\u3066\u307e\u3067 strictly monotonically increasing number \u3092\u4fdd\u8a3c\u3057\u3066\u3082\u3001\u7121\u99c4\u306b\u7d42\u308f\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u3002\n\n\n## \u65b0\u3057\u3044 API \u3067\u306f\u7d4c\u904e\u6642\u9593\u3068\u73fe\u5728\u6642\u523b\u3092\u5225\u7ba1\u7406\n\n\u65b0\u3057\u3044 API \u3067\u306f\u3001`multi_time_warp` \u306e\u6642\u306b\u3001\uff13\u3064\u306e\u8981\u4ef6\u304c\u540c\u6642\u306b\u6e80\u305f\u305b\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u305d\u306e\u305f\u3081\u306b\u3001\u307e\u305a\u300c\u7d4c\u904e\u6642\u9593\u300d\u3068\u300c\u73fe\u5728\u6642\u523b\u300d\u3092\u5225\u306b\u7ba1\u7406\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u524d\u8005\u3092\u300cErlang monotonic time\u300d\u3001\u5f8c\u8005\u3092\u300cErlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u300d\u3068\u547c\u3073\u307e\u3059\u3002\n\n\n### \u7d4c\u904e\u6642\u9593\uff1aErlang Monotonic Time\n\n`erlang:monotonic_time/0` \u3068 `erlang:monotonic_time/1` \u306f\u7d4c\u904e\u6642\u9593\u3092\u8fd4\u3057\u3001\u305d\u306e\u5024\u306f monotonically increasing number\uff08\u5e83\u7fa9\u306e\u5358\u8abf\u5897\u52a0\u6570\uff09\u3068\u306a\u308a\u307e\u3059\u3002\u3064\u307e\u308a\u300c\u524d\u56de\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3000\u2266\u3000\u4eca\u56de\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u300d\u3067\u3042\u308b\u3053\u3068\u304c\u4fdd\u8a3c\u3055\u308c\u3066\u3044\u307e\u3059\u3002\n\n\u3053\u3053\u3067 `erlang:now/0` \u3068\u306f\u7570\u306a\u308a\u3001\u7d9a\u3051\u3066\u547c\u3093\u3060\u6642\u306b\u3001\u540c\u3058\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304c\u8fd4\u308b\u5834\u5408\u304c\u3042\u308b\u3053\u3068\u306b\u6ce8\u76ee\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u8981\u4ef6\u3092\u7de9\u3081\u305f\u3053\u3068\u306b\u3088\u308a\u30ed\u30c3\u30af\u304c\u4e0d\u7528\u3068\u306a\u308a\u3001\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\u306e\u554f\u984c\u3082\u89e3\u6c7a\u3057\u307e\u3059\u3002\n\n`erlang:monotonic_time/0` \u306f\u7d4c\u904e\u6642\u9593\u3092 Erlang \u5b9f\u884c\u74b0\u5883\u306b\u4f9d\u5b58\u3059\u308b\u30cd\u30a4\u30c6\u30a3\u30d6\u306e\u5206\u89e3\u80fd\uff08resolution\u3001\u307e\u305f\u306f\u3001time unit \u3068\u547c\u3073\u307e\u3059\uff09\u3067\u8fd4\u3057\u307e\u3059\u3002`erlang:monotonic_time/1` \u306f\u3001\u30cd\u30a4\u30c6\u30a3\u30d6\u306e time unit \u3092\u3001\u5f15\u6570\u3067\u4e0e\u3048\u305f time unit \u306b\u5909\u63db\u3057\u3066\u304b\u3089\u8fd4\u3057\u307e\u3059\u3002\n\n```erl\n1> erlang:monotonic_time().\n-576460745061874838\n2> erlang:monotonic_time(nano_seconds).\n-576460739326652626\n3> erlang:monotonic_time(micro_seconds).\n-576460732117796\n4> erlang:monotonic_time(milli_seconds).\n-576460727635\n5> erlang:monotonic_time(seconds).\n-576460724\n```\n\n\u30cd\u30a4\u30c6\u30a3\u30d6\u306e\u5206\u89e3\u80fd\u306f `erlang:convert_time_unit(1, seconds, native)` \u3067\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002\n\n```erl\n6> erlang:convert_time_unit(1, seconds, native).\n1000000000\n```\n\n\u3053\u306e\u4f8b\u3067\u306f\u5206\u89e3\u80fd\u306f10\u306e\uff19\u4e57\u3067\u3001\u6700\u5c0f\u5358\u4f4d\u306f\uff11\u79d2 \u00d7 10\u306e\u30de\u30a4\u30ca\u30b9\uff19\u4e57\u3001\u3059\u306a\u308f\u3061\u30ca\u30ce\u79d2\u3060\u3068\u308f\u304b\u308a\u307e\u3059\u3002\u306a\u304a\u5206\u89e3\u80fd\uff08resolution\uff09\u306f\u3001\u7cbe\u5ea6\uff08accuracy\uff09\u3068\u306f\u5225\u7269\u3067\u3059\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3044\u3002monotonic time \u304c\u30ca\u30ce\u79d2\u3067\u8fd4\u3055\u308c\u308b\u304b\u3089\u3068\u3044\u3063\u3066\u3001\u30ca\u30ce\u79d2\u306e\u30ec\u30d9\u30eb\u3067\u6b63\u78ba\u306b\u6642\u3092\u523b\u3093\u3067\u3044\u308b\u3068\u306f\u9650\u308a\u307e\u305b\u3093\u3002\u3080\u3057\u308d\u3001\u305d\u3046\u3067\u306a\u3044\u3053\u3068\u304c\u666e\u901a\u3067\u3059\u3002\n\n`erlang:monotonic_time/0` \u306e\u623b\u308a\u5024\u306f\u6574\u6570\u306a\u306e\u3067\u3001\u7528\u9014\uff12\u306e\u7d4c\u904e\u6642\u9593\u3092\u8a08\u308b\u306b\u306f\u3001\u5358\u306b\u5927\u304d\u3044\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u304b\u3089\u3001\u5c0f\u3055\u3044\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3092\u5f15\u3051\u3070\u3044\u3044\u3067\u3059\u3002\u30cd\u30a4\u30c6\u30a3\u30d6\u306e time unit \u3092\u4f7f\u7528\u3057\u305f\u5834\u5408\u306f\u3001`erlang:convert_time_unit/3` \u3067\u76ee\u7684\u306e time unit \u306b\u5909\u63db\u3059\u308b\u3068\u3044\u3044\u3067\u3057\u3087\u3046\u3002\n\n```erl\n7> Start = erlang:monotonic_time().\n-576460698329582382\n8> End = erlang:monotonic_time().\n-576460692495322130\n9> End - Start.\n5834260252\n10> erlang:convert_time_unit(End - Start, native, milli_seconds).\n5834\n```\n\n\u306a\u304a\u3001\u3042\u308b Erlang \u5b9f\u884c\u74b0\u5883\u3067\u53d6\u5f97\u3057\u305f monotonic time \u3092\u3001\u4ed6\u306e Erlang \u5b9f\u884c\u74b0\u5883\u3067\u53d6\u5f97\u3057\u305f\u305d\u308c\u3068\u3001\u524d\u5f8c\u306e\u6bd4\u8f03\u3092\u3059\u308b\u3053\u3068\u306f\u3067\u304d\u307e\u305b\u3093\u3002monotonic time \u306f\u300c\u3042\u308b\u4efb\u610f\u306e\u6642\u70b9\u300d\u304b\u3089\u306e\u7d4c\u904e\u6642\u9593\u3092\u8868\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u3001\u305d\u306e\u8d77\u70b9\u304c\u3044\u3064\u306a\u306e\u304b\u306f\u500b\u3005\u306e\u5b9f\u884c\u74b0\u5883\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002\u5b9f\u884c\u74b0\u5883\u9593\u3067\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u524d\u5f8c\u6bd4\u8f03\u3092\u3057\u305f\u3044\u3068\u304d\u306f\u3001\u6b21\u306e\u9805\u3067\u7d39\u4ecb\u3059\u308b\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u53d6\u5f97\u3057\u3066\u3001monotonic time \u304b\u3089\u5b9f\u969b\u306e\u6642\u523b\u306b\u5909\u63db\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\nErlang monotonic time \u306f\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306e\u5f71\u97ff\u3092\u53d7\u3051\u307e\u305b\u3093\u3002OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5909\u66f4\u3055\u308c\u3066\u3082\u3001\u305d\u306e\u5f71\u97ff\u3092\u53d7\u3051\u305a\u3001\u5358\u8abf\u306b\u5897\u52a0\u3057\u7d9a\u3051\u307e\u3059\u3002\u3053\u306e\u3053\u3068\u304c\u3001\u65b0\u3057\u3044 API \u306e\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308a\u307e\u3059\u3002\n\n\n### Erlang Monotonic Time \u304b\u3089 Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3078\u306e\u30aa\u30d5\u30bb\u30c3\u30c8\n\nErlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u306f\u5b9f\u969b\u306e\u6642\u523b\u3092\u8868\u3057\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306e\u5bfe\u8c61\u3068\u306a\u308a\u307e\u3059\u3002`multi_time_warp` \u30e2\u30fc\u30c9\u306e\u6642\u306b\u3001OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u904e\u53bb\u3084\u672a\u6765\u3078\u5909\u66f4\u3055\u308c\u305f\u3089\u3001Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3082\u540c\u3058\u3088\u3046\u306b\u5909\u66f4\u3055\u308c\u307e\u3059\u3002\n\n`erlang:time_offset/0` \u3068 `erlang:time_offset/1` \u306f Erlang monotonic time \u304b\u3089 Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3078\u306e\u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u8fd4\u3057\u307e\u3059\u3002\u3064\u307e\u308a `erlang:monotonic_time/0` \u304c\u8fd4\u3057\u305f\u5024\u306b\u3001`erlang:time_offset/0` \u304c\u8fd4\u3057\u305f\u5024\u3092\u8db3\u3059\u3068\u3001\u8981\u4ef6\uff11\u306e\u73fe\u5728\u6642\u523b\uff08Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3001UNIX \u30a8\u30dd\u30c3\u30af\u304b\u3089\u306e\u7d4c\u904e\u6642\u9593\uff09\u304c\u3001\u30cd\u30a4\u30c6\u30a3\u30d6\u306e time unit \u3067\u6c42\u3081\u3089\u308c\u307e\u3059\u3002\n\n\u3053\u306e\u3088\u3046\u306b\u66f8\u304f\u3068\u3001Erlang \u5b9f\u884c\u74b0\u5883\u306e\u4e2d\u306b monotonic time \u3092\u5b9f\u73fe\u3059\u308b\u30a8\u30f3\u30b8\u30f3\u3068\u3001\u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3092\u5b9f\u73fe\u3059\u308b\u30a8\u30f3\u30b8\u30f3\u306e\u3001\uff12\u3064\u306e\u30a8\u30f3\u30b8\u30f3\u304c\u5165\u3063\u3066\u3044\u308b\u3088\u3046\u306b\u601d\u3048\u307e\u3059\u304c\u3001\u5f8c\u8005\u306f\u3042\u304f\u307e\u3067\u3082\u6982\u5ff5\u4e0a\u306e\u3082\u306e\u3067\u3001\u30b3\u30fc\u30c9\u3067\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u308f\u3051\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002Erlang \u5b9f\u884c\u74b0\u5883\u306b\u5b9f\u88c5\u3055\u308c\u3066\u3044\u308b\u306e\u306f\u3001monotonic time \u3092\u523b\u307f\u7d9a\u3051\u308b\u30a8\u30f3\u30b8\u30f3\u3068\u3001\u3053\u306e time offset \u3060\u3051\u3067\u3059\u3002\n\n```erl\n11> MT = erlang:monotonic_time().\n-576460636631757928\n12> OS = erlang:time_offset().\n2025874384294795734\n13> MT + OS.\n1449413747663037806\n14> erlang:convert_time_unit(MT + OS, native, milli_seconds).\n1449413747663\n\n```\n\n\u3053\u306e\u64cd\u4f5c\u3092\u5408\u6210\u3057\u305f `erlang:system_time/0` \u3068 `erlang:system_time/1` \u3082\u7528\u610f\u3055\u308c\u3066\u3044\u308b\u306e\u3067\u3001\u666e\u6bb5\u306f\u305d\u3061\u3089\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308b\u3067\u3057\u3087\u3046\u3002\u307e\u305f\u3001\u3055\u3089\u306b\u3053\u308c\u3092 `erlang:now/0` \u5f62\u5f0f\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306b\u5909\u63db\u3057\u3066\u304b\u3089\u8fd4\u3059 `erlang:timestamp/0` \u3082\u3042\u308a\u307e\u3059\u3002\n\n```erl\n15> erlang:system_time(milli_seconds).\n1449413805302\n16> erlang:timestamp().\n{1449,413821,303246}\n17> calendar:now_to_local_time(erlang:timestamp()).\n{{2015,12,6},{22,57,6}}\n```\n\n\u305f\u3060\u3057\u3001`erlang:timestamp/0` \u304c\u8fd4\u3059\u5024\u306f\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306e\u5bfe\u8c61\u3068\u306a\u308a\u307e\u3059\u306e\u3067\u3001\u8981\u4ef6\uff13\u306f\u6e80\u305f\u3057\u307e\u305b\u3093\u3002\u6b21\u306e\u9805\u3067\u7d39\u4ecb\u3059\u308b\u95a2\u6570\u3092\u4f7f\u3046\u3053\u3068\u306b\u306a\u308a\u307e\u3059\u3002\n\n\n### \u8981\u4ef6\uff13\u3092\u6e80\u305f\u3059\u5c02\u7528\u95a2\u6570\n\n\u8981\u4ef6\uff13\u3092\u6e80\u305f\u3059\u305f\u3081\u306b\u3001\u5c02\u7528\u306e\u95a2\u6570 `erlang:unique_integer/0` \u3068 `erlang:unique_integer/1` \u304c\u7528\u610f\u3055\u308c\u307e\u3057\u305f\u3002\n\n```erl\n18> erlang:unique_integer().\n-576460752303423486\n19> erlang:unique_integer().\n-576460752303423482\n20> erlang:unique_integer([positive]).\n11\n21> erlang:unique_integer([positive]).\n15\n22> erlang:unique_integer([positive, monotonic]).\n1\n23> erlang:unique_integer([positive, monotonic]).\n2\n24> erlang:unique_integer([positive, monotonic]).\n3\n```\n\n`erlang:unique_integer/0` \u306f\u30e6\u30cb\u30fc\u30af\u306a\u6574\u6570\u3092\u8fd4\u3059\u3053\u3068\u3060\u3051\u304c\u4fdd\u8a3c\u3055\u308c\u3066\u304a\u308a\u3001\u6b63\u306e\u6574\u6570\u3068\u8ca0\u306e\u6574\u6570\u304c\u3001\u305d\u306e\u5927\u5c0f\u306b\u95a2\u4fc2\u306a\u304f\u8fd4\u3055\u308c\u307e\u3059\u3002\u30aa\u30d7\u30b7\u30e7\u30f3\u3068\u3057\u3066\u3001`positive` \u3092\u4e0e\u3048\u308b\u3068\u3001\u6b63\u306e\u6574\u6570\u3060\u3051\u3092\u8fd4\u3059\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002`monotinic` \u3092\u4e0e\u3048\u308b\u3068\u3001`erlang:now/0` \u306e\u3088\u3046\u306a\u3001\u300c\u524d\u56de\u306e\u5024 \uff1c \u4eca\u56de\u306e\u5024\u300d\u3068\u306a\u308b\u6574\u6570\u3092\u8fd4\u3059\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n\u72ec\u7acb\u3057\u305f\u95a2\u6570\u306b\u3057\u305f\u3053\u3068\u3067\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u5f71\u97ff\u3092\u53d7\u3051\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\u307e\u305f\u3001\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\u3092\u6539\u5584\u3059\u308b\u305f\u3081\u306b\u3001\u69d8\u3005\u306a\u30c6\u30af\u30cb\u30c3\u30af\u304c\u7528\u3044\u3089\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\n\n\n## \u5b9f\u9a13\uff13\uff1a`multi_time_warp` \u30e2\u30fc\u30c9\u3067\u65b0\u3057\u3044 API \u3092\u8a66\u3059\n\n\u65b0\u3057\u3044 API \u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u3087\u3046\u3002\u52d5\u4f5c\u78ba\u8a8d\u306e\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u7528\u610f\u3057\u307e\u3057\u305f\u3002\n\n```erlang\n-module(t2).\n\n-compile(export_all).\n\n-spec print_time_otp18() -> ok.\nprint_time_otp18() ->\n    OSTS = os:timestamp(),\n    MT   = erlang:monotonic_time(),\n    TOS  = erlang:time_offset(),\n    LocalTimeOSTS = calendar:now_to_local_time(OSTS),\n    LocalTimeMT   = calendar:now_to_local_time(system_time_to_now(MT + TOS)),\n    Diff = timer:now_diff(system_time_to_now(MT + TOS), OSTS),\n    io:format(\"---------~n\"\n              \"os:timestamp   ~p -> ~p~n\"\n              \"monotonic_time ~w~n\"\n              \"time_offset    ~w~n\"\n              \"                                    -> ~p (~w us)~n\",\n              [OSTS, LocalTimeOSTS,\n               MT, TOS, LocalTimeMT, Diff]).\n\n-spec repeat_time_otp18() -> timer:tref().\nrepeat_time_otp18() ->\n    {ok, TRef} =\n        timer:apply_interval(1000, ?MODULE, print_time_otp18, []),\n    TRef.\n\n-spec system_time_to_now(integer()) -> erlang:timestamp().\nsystem_time_to_now(NativeSystemTime) ->\n    ST = erlang:convert_time_unit(NativeSystemTime, native, micro_seconds),\n    MegaSecs = ST div 1000000000000,\n    Secs = ST div 1000000 - MegaSecs * 1000000,\n    MicroSecs = ST rem 1000000,\n    {MegaSecs, Secs, MicroSecs}.\n```\n\n`system_time_to_now/1` \u306f\u30cd\u30a4\u30c6\u30a3\u30d6 time unit \u306e Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3092 `erlang:now/0` \u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306b\u5909\u63db\u3059\u308b\u305f\u3081\u306b\u4f5c\u308a\u307e\u3057\u305f\u3002\u5b9f\u969b\u306e\u904b\u7528\u3067\u306f\u3001`erlang:monotinic_time/0` \u3068 `erlang:time_offset/0` \u3092\u4f7f\u308f\u305a\u306b\u3001`erlang:timestamp/0` \u3067\u4e00\u6c17\u306b\u6c42\u3081\u308b\u307b\u3046\u304c\u697d\u3067\u3057\u3087\u3046\u3002\n\n\u3053\u306e\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u95a2\u6570\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002\n\n```erl\n$ erl +C multi_time_warp\n...\n1> c(t2).\n{ok,t2}\n2> t2:print_time_otp18().\n---------\nos:timestamp   {1449,414031,427546} -> {{2015,12,6},{23,0,31}}\nmonotonic_time -576460700481595263\ntime_offset    2025874731852149836\n                                    -> {{2015,12,6},{23,0,31}} (-56992 us)\nok\n3> TR2 = t2:repeat_time_otp18().\n{interval,#Ref<0.0.1.97>}\n4> ---------\nos:timestamp   {1449,414049,442162} -> {{2015,12,6},{23,0,49}}\nmonotonic_time -576460682466981138\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,0,49}} (4 us)\n---------\nos:timestamp   {1449,414050,447735} -> {{2015,12,6},{23,0,50}}\nmonotonic_time -576460681461409266\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,0,50}} (3 us)\n```\n\n### \u6642\u523b\u3092\u9032\u307e\u305b\u3066\u307f\u308b\n\n\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9032\u3081\u307e\u3059\u3002\n\n```erl\n---------\nos:timestamp   {1449,414061,442729} -> {{2015,12,6},{23,1,1}}\nmonotonic_time -576460670466414376\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,1,1}} (4 us)\n---------\nos:timestamp   {1449,414120,165533} -> {{2015,12,6},{23,2,0}}   %% <-- \uff11\u5206\u9032\u3093\u3060\nmonotonic_time -576460669467591586\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,1,2}} (-57723977 us)\n---------\nos:timestamp   {1449,414121,165884} -> {{2015,12,6},{23,2,1}}\nmonotonic_time -576460668467240566\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,1,3}} (-57723977 us)\n```\n\n\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u300140\u79d2\u307b\u3069\u7d4c\u3063\u3066\u304b\u3089 `erlang:time_offset/0` \u304c\u5909\u66f4\u3055\u308c\u3001OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3068\u540c\u3058\u6642\u9593\u304c\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u6642\u523b\u3092\u9032\u3081\u305f\u6642\u306f\u3001\u8981\u4ef6\uff11\u306e\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97\u304c\u6e80\u305f\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\n\n```erl\n---------\nos:timestamp   {1449,414159,166963} -> {{2015,12,6},{23,2,39}}\nmonotonic_time -576460630466161469\ntime_offset    2025874731909147872\n                                    -> {{2015,12,6},{23,1,41}} (-57723977 us)\n---------\nos:timestamp   {1449,414160,166153} -> {{2015,12,6},{23,2,40}}\nmonotonic_time -576460629466971281\ntime_offset    2025874789633128715   \u3000\u3000\u3000\u3000\u3000\u3000                        %% <-- \u5909\u308f\u3063\u305f\n                                    -> {{2015,12,6},{23,2,40}} (4 us)  %% <-- \uff11\u5206\u9032\u3093\u3060\n---------\nos:timestamp   {1449,414161,167540} -> {{2015,12,6},{23,2,41}}\nmonotonic_time -576460628465584511\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,2,41}} (4 us)\n```\n\n\u4e00\u65b9\u3067\u3001`erlang:monotinic_time/0` \u306f\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u5909\u66f4\u306e\u5f71\u97ff\u3092\u53d7\u3051\u305a\u3001\u5358\u8abf\u306b\u5897\u52a0\u3057\u7d9a\u3051\u307e\u3057\u305f\u3002\n\n```erl\n1> erlang:convert_time_unit(-576460629466971281 - -576460630466161469,\n1>                          native, micro_seconds).\n999190\n```\n\n\u3053\u308c\u306b\u3088\u308a\u8981\u4ef6\uff12\u306e\u7d4c\u904e\u6642\u9593\u3092\u8a08\u308b\u3053\u3068\u3082\u5e38\u306b\u6e80\u305f\u3055\u308c\u307e\u3059\u3002\n\n\n### \u6642\u523b\u3092\u9045\u3089\u305b\u3066\u307f\u308b\n\n\u4eca\u5ea6\u306f\u6642\u523b\u3092\u623b\u3057\u307e\u3059\u3002\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9045\u3089\u305b\u307e\u3057\u305f\u3002\n\n```erl\n---------\nos:timestamp   {1449,414352,166058} -> {{2015,12,6},{23,5,52}}\nmonotonic_time -576460437467066070\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,5,52}} (4 us)\n---------\nos:timestamp   {1449,414353,166167} -> {{2015,12,6},{23,5,53}}\nmonotonic_time -576460436466957641\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,5,53}} (4 us)\n---------\nos:timestamp   {1449,414296,450902} -> {{2015,12,6},{23,4,56}}   %% <-- \uff11\u5206\u9045\u308c\u305f\nmonotonic_time -576460435467079298\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,5,54}} (57715147 us)\n---------\nos:timestamp   {1449,414297,451731} -> {{2015,12,6},{23,4,57}}\nmonotonic_time -576460434466249931\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,5,55}} (57715147 us)\n```\n\n45\u79d2\u307b\u3069\u7d4c\u3063\u3066\u304b\u3089\u3001`erlang:time_offset/0` \u306b\u3082\u53cd\u6620\u3055\u308c\u307e\u3057\u305f\u3002\u6642\u523b\u3092\u9045\u3089\u305b\u305f\u6642\u3082\u3001\u8981\u4ef6\uff11\u306e\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97\u304c\u6e80\u305f\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```erl\n---------\nos:timestamp   {1449,414341,454290} -> {{2015,12,6},{23,5,41}}\nmonotonic_time -576460390463691730\ntime_offset    2025874789633128715\n                                    -> {{2015,12,6},{23,6,39}} (57715146 us)\n\n---------\nos:timestamp   {1449,414342,451029} -> {{2015,12,6},{23,5,42}}\nmonotonic_time -576460389466952117\ntime_offset    2025874731917985060                                     %% <-- \u5909\u308f\u3063\u305f\n                                    -> {{2015,12,6},{23,5,42}} (3 us)  %% <-- \uff11\u5206\u9045\u308c\u305f\n---------\nos:timestamp   {1449,414343,450941} -> {{2015,12,6},{23,5,43}}\nmonotonic_time -576460388467040215\ntime_offset    2025874731917985060\n                                    -> {{2015,12,6},{23,5,43}} (3 us)\n\n```\n\n\u3084\u306f\u308a `erlang:monotinic_time/0` \u306f\u5f71\u97ff\u3092\u53d7\u3051\u305a\u3001\u5358\u8abf\u306b\u5897\u52a0\u3057\u7d9a\u3051\u307e\u3057\u305f\u3002\n\n```erl\n1> erlang:convert_time_unit(-576460389466952117 - -576460390463691730,\n1>                          native, micro_seconds).\n996739\n```\n\n### \u7d50\u8ad6\n\n\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u3092 `multi_time_warp` \u306b\u3057\u3066\u3001\u65b0\u3057\u3044 API \u3092\u8a66\u3057\u305f\u3068\u3053\u308d\u3001\u8981\u4ef6\uff11\u3068\u8981\u4ef6\uff12\u304c\u5e38\u306b\u6e80\u305f\u3055\u308c\u308b\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3057\u305f\u3002\u8981\u4ef6\uff13\u306b\u3064\u3044\u3066\u306f\u5b9f\u9a13\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u304c\u3001\u6642\u523b\u304b\u3089\u72ec\u7acb\u3057\u305f\u95a2\u6570\u304c\u5c0e\u5165\u3055\u308c\u305f\u305f\u3081\u3001\u305d\u306e\u52b9\u679c\u306f\u660e\u78ba\u3067\u3057\u3087\u3046\u3002\u307e\u3068\u3081\u308b\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n   | \u8981\u4ef6 | \u6e80\u305f\u305b\u308b\uff1f | \u8aac\u660e\n:-:|:-----------------|:----------|:-----------------------------------\n 1 | \u73fe\u5728\u6642\u523b\u3092\u6b63\u78ba\u306b\u5f97\u3089\u308c\u308b   | \u6e80\u305f\u305b\u308b | OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5909\u66f4\u3055\u308c\u305f\u6642\u306f\u3001\u6570\u5341\u79d2\u4ee5\u5185\u306b\u30aa\u30d5\u30bb\u30c3\u30c8\u306b\u53cd\u6620\u3055\u308c\u3001\u6b63\u3057\u3044\u6642\u523b\u304c\u5f97\u3089\u308c\u308b\n 2 | \u7d4c\u904e\u6642\u9593\u3092\u6b63\u78ba\u306b\u6e2c\u5b9a\u3067\u304d\u308b | \u6e80\u305f\u305b\u308b | monotonic time \u306f\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u5f71\u97ff\u3092\u53d7\u3051\u305a\u306b\u5358\u8abf\u5897\u52a0\u3059\u308b\n 3 | \u30e6\u30cb\u30fc\u30af\u306a\u6570\u5024\u3092\u5f97\u3089\u308c\u308b | \u6e80\u305f\u305b\u308b | \u5b9f\u9a13\u3067\u306f\u672a\u78ba\u8a8d\u3060\u304c\u3001\u6642\u523b\u304b\u3089\u72ec\u7acb\u3057\u305f\u95a2\u6570\u304c\u5c0e\u5165\u3055\u308c\u305f\u305f\u3081\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u5f71\u97ff\u3092\u53d7\u3051\u306a\u3044\u3068\u8003\u3048\u3089\u308c\u308b\n\n\u306a\u304a\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u306e `no_time_warp` \u306e\u307e\u307e\u3060\u3068\u3001\u305b\u3063\u304b\u304f\u65b0\u3057\u3044 API \u3092\u4f7f\u7528\u3057\u3066\u3082\u3001Erlang system clock \u304c\u7de9\u3084\u304b\u306b\u540c\u671f\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3057\u307e\u3044\u3001\u8981\u4ef6\uff11\u304c\u6e80\u305f\u305b\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3044\u307e\u3059\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3044\u3002\uff08`no_time_warp` \u3067\u306f time offset \u306f\u5909\u308f\u3089\u305a\u306b\u3001monotonic time \u306e\u9032\u884c\u901f\u5ea6\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\uff09\n\n\n## \u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u306e\u691c\u51fa\n\nOTP 18 \u3067\u306f\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u304c\u8d77\u3053\u3063\u305f\u6642\u306b\u3001\u901a\u77e5\u3092\u53d7\u3051\u53d6\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002\n\n```erl\n$ erl +C multi_time_warp\n...\n1> erlang:monitor(time_offset, clock_service).\n#Ref<0.0.1.416>\n2> receive Msg -> Msg end.\n```\n\n\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u3092\u7d04\uff11\u5206\u9032\u3081\u308b\u3068...\n\n```erl\n{'CHANGE',#Ref<0.0.1.416>,time_offset,clock_service,\n          2025874833587923080}\n```\n\n\u65b0\u3057\u3044\u30aa\u30d5\u30bb\u30c3\u30c8 `2025874833587923080` \u304c\u901a\u77e5\u3055\u308c\u307e\u3057\u305f\u3002\u3053\u306e\u3088\u3046\u306b\u3001\u30af\u30ed\u30c3\u30af\u3092\u76e3\u8996\u3057\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u304c\u8d77\u3053\u308b\u3054\u3068\u306b\u65b0\u3057\u3044 \u30aa\u30d5\u30bb\u30c3\u30c8\u3092\u53d7\u3051\u53d6\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n## \u307e\u3068\u3081\n\nOTP 18 \u3088\u308a\u524d\u306e\u30ea\u30ea\u30fc\u30b9\u3067\u306f `erlang:now/0` \u306b\uff13\u3064\u306e\u8981\u4ef6\u304c\u6c42\u3081\u3089\u308c\u3066\u3044\u305f\u305f\u3081\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u3092\u8d77\u3053\u3059\u3068\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08\u304a\u3088\u3073\u3001OTP\u81ea\u4f53\uff09\u304c\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u306a\u304f\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u305d\u306e\u305f\u3081\u3001Erlang \u5b9f\u884c\u74b0\u5883\u306f\u3001OS \u306e\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u304c\u5909\u66f4\u3055\u308c\u305f\u6642\u306b\u3001\u305d\u306e\u3053\u3068\u3092\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u96a0\u3057\u306a\u304c\u3089\u3001\u6b63\u3057\u3044\u6642\u523b\u3078\u7de9\u3084\u304b\u306b\u540c\u671f\u3059\u308b\u4ed5\u7d44\u307f\u306b\u306a\u3063\u3066\u3044\u307e\u3057\u305f\u3002\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u304c\u8d77\u3053\u3089\u306a\u3044\u3053\u3068\u306b\u3088\u308a\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ed\u30b8\u30c3\u30af\u306f\u7c21\u7565\u5316\u3055\u308c\u305f\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u4e00\u65b9\u3067\u3001\u305a\u308c\u305f\u6642\u9593\u304c\u623b\u308b\u307e\u3067\u3001\u9577\u3044\u6642\u9593\u304c\uff08\u5834\u5408\u306b\u3088\u3063\u3066\u306f\u4f55\u5e74\u9593\u3082\uff09\u304b\u304b\u308b\u3068\u3044\u3046\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u307e\u305f\u3001`erlang:now/0` \u306f\u5185\u90e8\u3067\u30ed\u30c3\u30af\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u30fc\u306e\u554f\u984c\u3082\u3042\u308a\u307e\u3057\u305f\u3002\n\nOTP 18 \u3067\u306f\u65b0\u3057\u3044\u6642\u523b\u95a2\u9023 API \u3068\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9\u3092\u5c0e\u5165\u3057\u305f\u3053\u3068\u306b\u3088\u3063\u3066\u3001\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u304c\u8d77\u3053\u3063\u305f\u6642\u3067\u3082\u3001\uff13\u3064\u306e\u8981\u4ef6\u3092\u6e80\u305f\u3057\u305f\u307e\u307e\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\u9069\u5207\u306a\u5bfe\u5fdc\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3057\u305f\u3002Erlang \u5b9f\u884c\u74b0\u5883\u306f\u3001\u30b7\u30b9\u30c6\u30e0\u30af\u30ed\u30c3\u30af\u306e\u5909\u66f4\u3092\u96a0\u3059\u306e\u3067\u306f\u306a\u304f\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u5373\u5ea7\u306b\u901a\u77e5\u3057\u3066\u5bfe\u5fdc\u3092\u59d4\u306d\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u30ed\u30b8\u30c3\u30af\u306f\u8907\u96d1\u306b\u306a\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u304c\u3001\u307b\u3068\u3093\u3069\u306e\u5834\u5408\u3001\u8981\u4ef6\u306b\u5373\u3057\u305f\u3001\u3088\u308a\u5805\u7262\u306a\u3082\u306e\u306b\u306a\u308b\u3068\u671f\u5f85\u3055\u308c\u307e\u3059\u3002\n\n\u300cErlang Run-Time System Application(ERTS) User's Guide\u300d\u306e\u300c[Time and Time Correction in Erlang](http://www.erlang.org/doc/apps/erts/time_correction.html)\u300d\u3067\u306f\u3001\u65b0\u3057\u3044 API \u3078\u306e\u5207\u308a\u66ff\u3048\u65b9\u6cd5\u3092\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5177\u4f53\u4f8b\u3092\u6319\u3052\u3066\u89e3\u8aac\u3057\u3066\u3044\u307e\u3059\u3002\u305c\u3072\u4e00\u5ea6\u3001\u8aad\u3093\u3067\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n- Retrieve Erlang System Time\uff08Erlang \u30b7\u30b9\u30c6\u30e0\u30bf\u30a4\u30e0\u3092\u53d6\u5f97\u3059\u308b\uff09\n- Measure Elapsed Time\uff08\u7d4c\u904e\u6642\u9593\u3092\u6e2c\u5b9a\u3059\u308b\uff09\n- Determine Order of Events\uff08\u30a4\u30d9\u30f3\u30c8\u304c\u767a\u751f\u3057\u305f\u9806\u5e8f\u3092\u6c7a\u5b9a\u3059\u308b\uff09\n- Determine Order of Events With Time of the Event\uff08\u30a4\u30d9\u30f3\u30c8\u304c\u767a\u751f\u3057\u305f\u6642\u523b\u3092\u5143\u306b\u3001\u305d\u306e\u9806\u5e8f\u3092\u6c7a\u5b9a\u3059\u308b\uff09\n- Create a Unique Name\uff08\u30e6\u30cb\u30fc\u30af\u306a\u540d\u524d\u3092\u751f\u6210\u3059\u308b\uff09\n- Seed Random Number Generation With a Unique Value\uff08\u4e71\u6570\u751f\u6210\u5668\u306b\u30e6\u30cb\u30fc\u30af\u306a\u30b7\u30fc\u30c9\u5024\u3092\u4e0e\u3048\u308b\uff09\n\n\u6700\u5f8c\u306e\u4f8b\u306f\u3001`random` \u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u60f3\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u304c\u3001\u305d\u3046\u3044\u3046\u66f8\u304d\u63db\u3048\u3092\u3059\u308b\u3088\u308a\u3082\u3001\u65b0\u305f\u306b\u5c0e\u5165\u3055\u308c\u305f `rand` \u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u5207\u308a\u66ff\u3048\u308b\u3053\u3068\u304c\u7d76\u5bfe\u304a\u52e7\u3081\u3067\u3059\u3002\n\n- [OTP 18.0-rc2\u3067\u5165\u3063\u305f\u7591\u4f3c\u4e71\u6570rand\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u3064\u3044\u3066](http://qiita.com/jj1bdx/items/225e1d82cffbf0003918)\n\n\u307e\u305f\u3001Time and Time Correction in Erlang \u3067\u306f\u3001\u3082\u3046\u3072\u3068\u3064\u306e\u30bf\u30a4\u30e0\u30ef\u30fc\u30d7\u30e2\u30fc\u30c9 `single_time_warp` \u306b\u3064\u3044\u3066\u3082\u89e3\u8aac\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u3053\u3061\u3089\u306f\u3001\u65e2\u5b58\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u307b\u3068\u3093\u3069\u5909\u66f4\u305b\u305a IoT \u30c7\u30d0\u30a4\u30b9\u306b\u5bfe\u5fdc\u3055\u305b\u305f\u3044\u6642\u306a\u3069\u306b\u5f79\u7acb\u3061\u305d\u3046\u3067\u3059\u3002\n", "tags": ["Erlang", "Elixir"]}