{"context": "\n\n\u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u306b\u5bfe\u5fdc\u3057\u305fLEN\n\u30c6\u30b9\u30c8\u3057\u3066\u307f\u305f\u3089LEN\u304c\u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u6210\u3002\n\n\u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u5bfe\u5fdcLen\n'--------------------------------------------------------------\n'  \u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u5bfe\u5fdcLen\n'--------------------------------------------------------------\nFunction LenEx(ByVal strBuf As String) As Long\n\n    Dim bytBuf() As Byte\n    Dim lngBuf As Long\n    Dim i As Long\n    Dim lngLen As Long\n\n    lngLen = 0\n\n    If Len(strBuf) = 0 Then\n        LenEx = 0\n        Exit Function\n    End If\n\n    bytBuf = strBuf\n\n    For i = LBound(bytBuf) To UBound(bytBuf) Step 2\n\n        lngBuf = LShift(bytBuf(i + 1), 8) + bytBuf(i)\n\n        Select Case lngBuf\n            '\u4e0a\u4f4d\u30b5\u30ed\u30b2\u30fc\u30c8\n            Case &HD800& To &HDBFF&\n                lngLen = lngLen + 1\n            '\u4e0b\u4f4d\u30b5\u30ed\u30b2\u30fc\u30c8\n            Case &HDC00& To &HDFFF&\n                '\u30ab\u30a6\u30f3\u30c8\u3057\u306a\u3044\n            Case Else\n                lngLen = lngLen + 1\n        End Select\n\n    Next\n\n    LenEx = lngLen\n\nEnd Function\n'------------------------------------------------------------------------------------------------------------------------\n' \u5de6\u30b7\u30d5\u30c8\n'------------------------------------------------------------------------------------------------------------------------\nFunction LShift(ByVal lngValue As Long, ByVal lngKeta As Long) As Long\n    LShift = lngValue * (2 ^ lngKeta)\nEnd Function\n\n\n\u4ed6\u306e\u30bd\u30fc\u30b9\u3092\u3054\u3089\u3093\u306b\u306a\u308a\u305f\u3044\u65b9\u306f\u3053\u3061\u3089\u3078\nExcel\u3092\u4fbf\u5229\u306b\u3059\u308b250\u4ee5\u4e0a\u306e\u6a5f\u80fd\u3092\u4f53\u7cfb\u5316\u3057\u305f\u30a2\u30c9\u30a4\u30f3\u306f\u3053\u3061\u3089\u3067\u3059\u3002\n\u300cRelaxTools Addin\u300d\u7a93\u306e\u675c\u5927\u8cde\u53d7\u8cde\u30bd\u30d5\u30c8\nhttp://software.opensquare.net/relaxtools/\n#\u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u306b\u5bfe\u5fdc\u3057\u305fLEN\n\n\u30c6\u30b9\u30c8\u3057\u3066\u307f\u305f\u3089LEN\u304c\u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u306e\u3067\u4f5c\u6210\u3002\n\n```vb.net:\u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u5bfe\u5fdcLen\n'--------------------------------------------------------------\n'  \u30b5\u30ed\u30b2\u30fc\u30c8\u30da\u30a2\u5bfe\u5fdcLen\n'--------------------------------------------------------------\nFunction LenEx(ByVal strBuf As String) As Long\n\n    Dim bytBuf() As Byte\n    Dim lngBuf As Long\n    Dim i As Long\n    Dim lngLen As Long\n    \n    lngLen = 0\n    \n    If Len(strBuf) = 0 Then\n        LenEx = 0\n        Exit Function\n    End If\n    \n    bytBuf = strBuf\n    \n    For i = LBound(bytBuf) To UBound(bytBuf) Step 2\n    \n        lngBuf = LShift(bytBuf(i + 1), 8) + bytBuf(i)\n    \n        Select Case lngBuf\n            '\u4e0a\u4f4d\u30b5\u30ed\u30b2\u30fc\u30c8\n            Case &HD800& To &HDBFF&\n                lngLen = lngLen + 1\n            '\u4e0b\u4f4d\u30b5\u30ed\u30b2\u30fc\u30c8\n            Case &HDC00& To &HDFFF&\n                '\u30ab\u30a6\u30f3\u30c8\u3057\u306a\u3044\n            Case Else\n                lngLen = lngLen + 1\n        End Select\n    \n    Next\n    \n    LenEx = lngLen\n\nEnd Function\n'------------------------------------------------------------------------------------------------------------------------\n' \u5de6\u30b7\u30d5\u30c8\n'------------------------------------------------------------------------------------------------------------------------\nFunction LShift(ByVal lngValue As Long, ByVal lngKeta As Long) As Long\n    LShift = lngValue * (2 ^ lngKeta)\nEnd Function\n```\n\n\u4ed6\u306e\u30bd\u30fc\u30b9\u3092\u3054\u3089\u3093\u306b\u306a\u308a\u305f\u3044\u65b9\u306f\u3053\u3061\u3089\u3078\nExcel\u3092\u4fbf\u5229\u306b\u3059\u308b250\u4ee5\u4e0a\u306e\u6a5f\u80fd\u3092\u4f53\u7cfb\u5316\u3057\u305f\u30a2\u30c9\u30a4\u30f3\u306f\u3053\u3061\u3089\u3067\u3059\u3002\n\u300cRelaxTools Addin\u300d\u7a93\u306e\u675c\u5927\u8cde\u53d7\u8cde\u30bd\u30d5\u30c8\nhttp://software.opensquare.net/relaxtools/\n", "tags": ["VBA", "Excel"]}