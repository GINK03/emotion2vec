{"context": " More than 1 year has passed since last update.=====================\nClockwork\u306f\u5b9a\u671f\u7684\u306a\u51e6\u7406\u304c\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\n\u4f7f\u3044\u65b9\u3082\u7c21\u5358\u3067\u3059\u304c\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\nClockwork\u306fcron\u306e\u4ee3\u66ff\u306b\u4f7f\u3048\u307e\u3059\u3002Ruby\u306a\u306e\u3067DSL\u8a18\u6cd5\u3084\u4fbf\u5229\u306a\u95a2\u6570\u304c\u4f7f\u3048\u307e\u3059\u3002\n(Rails\u3067\u5229\u7528\u3059\u308b\u3068ActionPack\u306a\u3069\u66f4\u306b\u4fbf\u5229\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u4f7f\u3048\u307e\u3059\u3002)\n\nRegister\n\u5b9a\u671f\u7684\u306b\u51e6\u7406\u3059\u308b\u5185\u5bb9\u3092every\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\nevery\u306f\u671f\u9593\u3001\u51e6\u7406(\u30b8\u30e7\u30d6)\u3001\u6761\u4ef6\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nevery([period], [job name], [options]) [{job block}]\n\n\nPeriod\n\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3059\u308b\u671f\u9593(\u9593\u9694)\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u671f\u9593\u306e\u5358\u4f4d\u306f\u79d2\u3001\u5206\u3001\u6642\u3001\u65e5\u3001\u9031\u3067\u3059\u3002\n[\u6570\u5b57].[\u5358\u4f4d\u306e\u30ad\u30fc\u30ef\u30fc\u30c9]\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u30ad\u30fc\u30ef\u30fc\u30c9\u306e\u5358\u6570\u5f62\u3068\u8907\u6570\u5f62\u306f\u30a8\u30a4\u30ea\u30a2\u30b9\u3067\u3059\u3002\n(\u6570\u5b57\u304c1\u306a\u3089\u5358\u6570\u5f62\u30012\u4ee5\u4e0a\u306a\u3089\u8907\u6570\u5f62\u3092\u4f7f\u3046\u3068\u3088\u3044\u3067\u3059\u3002)\n\n\nList\n\n\n\n\u5358\u4f4d\n\u5358\u6570\u5f62\n\u8907\u6570\u5f62\nSource\n\n\n\n\n\u79d2\nsecond\nseconds\nperiod * 1\n\n\n\u5206\nminute\nminutes\nperiod * 60\n\n\n\u6642\nhour\nhours\nperiod * 3600\n\n\n\u65e5\nday\ndays\nperiod * 86400\n\n\n\u9031\nweek\nweeks\nperiod * 604800\n\n\n\n\nExample\nevery(4.seconds, '4.seconds.job')  # 4\u79d2\u9593\u9694\nevery(2.hours, '2.hours.job')      # 2\u6642\u9593\u9593\u9694\nevery(1.day, '1.day.job')          # 1\u65e5\u9593\u9694\n\n\nOptions\n\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3059\u308b\u6761\u4ef6\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u6761\u4ef6\u306b\u306fat\u3068if\u304c\u3042\u308a\u307e\u3059\u3002\n\nat\n\u4f55\u6642\u306b\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3059\u308b\u304b\u6307\u5b9a\u3057\u307e\u3059\u3002\n'[\u6642]:[\u5206]' \u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n(\u6642\u9593\u306f\u8907\u6570\u306e\u6307\u5b9a\u304c\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u66dc\u65e5\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002)\n\n\nList\n\n\n\n\u6307\u5b9a\nperiod\nat\n\u51e6\u7406\u3055\u308c\u308b\u6642\u9593\n\n\n\n\n\u6642\u5206\n1.day\n'01:30'\n1\u664230\u5206\n\n\n0\u7701\u7565\n1.day\n'1:30'\n1\u664230\u5206\n\n\n\u6bce\u6642\n1.hour\n'**:30'\n\u6bce\u664230\u5206\n\n\n\u8907\u6570\n1.hour\n['12:00', '18:00']\n12\u6642\u306818\u6642\n\n\n\u66dc\u65e5\n1.week\n'Saturday 12:00'\n\u571f\u66dc\u65e5\u306e12\u6642\n\n\n\n\nWeek day list\n\u66dc\u65e5\u306f\u7701\u7565\u3092\u5408\u308f\u305b\u308b\u30684\u30d1\u30bf\u30fc\u30f3\u3042\u308a\u307e\u3059\u3002\n\u30a8\u30a4\u30ea\u30a2\u30b9\u306a\u306e\u3067\u597d\u304d\u306a\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u4f7f\u3048\u307e\u3059\u3002\n\n\n\n\u66dc\u65e5\n\u6307\u5b9a1\n\u6307\u5b9a2\n\u6307\u5b9a3\n\u6307\u5b9a4\n\n\n\n\n\u65e5\nsunday\nSunday\nsun\nSun\n\n\n\u6708\nmonday\nMonday\nmon\nMon\n\n\n\u706b\ntuesday\nTuesday\ntue\nTue\n\n\n\u6c34\nwednesday\nWednesday\nwed\nWed\n\n\n\u6728\nthursday\nThursday\nthu\nThu\n\n\n\u91d1\nfriday\nFriday\nfri\nFri\n\n\n\u571f\nsaturday\nSaturday\nsat\nSat\n\n\n\n\nExample\nevery(1.day, 'job', at: '01:30')             # 1\u664230\u5206\nevery(1.day, 'job', at: '1:30')              # 1\u664230\u5206\nevery(1.hour, 'job', at: '**:30')            # \u6bce\u664230\u5206\nevery(1.hour, 'job', at: ['12:00', '18:00']) # 12\u6642\u306818\u6642\nevery(1.week, 'job', at: 'Saturday 12:00')   # \u571f\u66dc\u65e5\u306e12\u6642\n\n\nAnti-pattern\nperiod\u3068at\u306e\u7d44\u5408\u305b\u306b\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\u4f8b\u3067\u306f\u6bce\u664230\u5206\u306e\u6307\u5b9a\u3067\u3059\u304c\u671f\u9593\u304c1\u65e5\u9593\u9694\u306a\u306e\u3067\u3001Clockwork\u304c12\u6642\u306b\u30b9\u30bf\u30fc\u30c8\u3059\u308b\u3068\n\u521d\u56de\u306f12\u664230\u5206\u306b\u5b9f\u884c\u3055\u308c\u3066\u3001\u6b21\u56de\u306f\u7fcc\u65e5\u306e12\u664230\u5206\u306b\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\nevery(1.day, 'job', at: '**:30') # \u6bce\u664230\u5206\u3067\u306f\u5b9f\u884c\u3057\u306a\u3044\uff01\n\n\nif\n\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3059\u308b\u6761\u4ef6\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\nlambda { |t| [\u5f0f] } \u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n(\u5f0f\u306b\u6642\u9593\u304c\u4e0d\u8981\u306a\u3089`|t|`\u3092`|_|`\u306b\u5909\u66f4\u3057\u307e\u3059\u3002)\n\n\nExample\n\u6708\u521d\u3084\u6708\u672b\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\nevery(1.day, 'job', at: '9:00', if: lambda { |t| t.day == 1 }) # \u6708\u521d\u306e9\u6642\nevery(1.day, 'job', at: '21:00', if: lambda { |t| t.day == Date.new(t.year, t.month, -1).day }) # \u6708\u672b\u306e21\u6642\n\n\nPractical\n\u51e6\u7406\u306e\u5931\u6557\u3092\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3057\u3066\u30a2\u30e9\u30fc\u30c8\u3092\u901a\u77e5\u3059\u308b\u3053\u3068\u304c\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u307e\u3059\u3002\n(Sidekiq\u3092\u5229\u7528\u3059\u308b\u3068\u975e\u540c\u671f\u51e6\u7406\u306e\u5b9f\u88c5\u304c\u7c21\u5358\u3067\u3059\u3002)\nevery(1.minute, 'Failure::Worker', if: lambda { |_| Failure.all.count > 0 }) do \n  Failure::Worker.perform_async\nend\n\n\nJob\n\u5b9f\u884c\u3059\u308b\u30b8\u30e7\u30d6\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n(\u30b8\u30e7\u30d6\u306fSidekiq\u306a\u3069\u3092\u5229\u7528\u304c\u5fc5\u8981\u3067\u3059\u3002)\nevery(period, [job name], options) [{job block}] \u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n{job block}\u306b\u8a18\u8ff0\u3059\u308b\u65b9\u6cd5\u3068[job name]\u3092\u5229\u7528\u3057\u3066handler\u306b\u8a18\u8ff0\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\n\n\nJob block\n\u671f\u9593\u3001\u6761\u4ef6\u3001\u30b8\u30e7\u30d6\u3092\u307e\u3068\u3081\u3066\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\nevery(1.second, '1.second.job') do\n  puts \"Running job\"\nend\n\n\nhandler\n\u671f\u9593\u3001\u6761\u4ef6\u3068\u30b8\u30e7\u30d6\u3092\u5206\u3051\u3066\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\nhandler do |job|\n  case job\n  when '1.second.job'\n    \"Running job\"\n  end \nend\n\nevery(1.second, '1.second.job')\n\n\nExample\n\nPractical\nRails\u306e\u4f8b\u3067\u3059\u304c\u3001\u74b0\u5883(\u958b\u767a\u3084\u672c\u756a)\u306b\u5408\u308f\u305b\u3066\u5236\u5fa1\u3067\u304d\u307e\u3059\u3002\n\nclock.rb\nrequire_relative '../config/boot'\nrequire_relative '../config/environment'\n\nrequire 'clockwork'\ninclude Clockwork\n\ncase Rails.env\nwhen 'development'\n  every(1.second, 'seconds.job') do\n    puts \"Running development job\"\n  end\nwhen 'staging'\n  every(1.minute, 'minutes.job') do\n    puts \"Running staging job\"\n  end\nwhen 'production'\n  every(1.hour, 'hours.job') do\n    puts \"Running staging job\"\n  end\nelse # Unknown\n  every(1.day, 'days.job') do\n    puts \"Running production job\"\n  end  \nend\n\n# Shared jobs\nevery(1.week, 'weeks.job') do\n  puts \"Running common job\"\nend\n\n\n\nAnti-pattern\nRuby\u306f\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u306e\u51e6\u7406\u3092\u3057\u306a\u3044\u3068\u30b8\u30e7\u30d6\u304c\u671f\u5f85\u3057\u305f\u6642\u9593\u306b\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002\n\u4f8b\u3067\u306f1\u79d2\u9593\u9694\u306810\u79d2\u9593\u9694\u306e\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u3057\u304b\u3057\u300110\u79d2\u9593\u9694\u306e\u30b8\u30e7\u30d6\u3067\n20\u79d2\u306e\u5f85\u3061\u304c\u767a\u751f\u3059\u308b\u306e\u30671\u79d2\u9593\u9694\u306e\u30b8\u30e7\u30d6\u308220\u79d2\u5f85\u305f\u3055\u308c\u307e\u3059\u3002\nevery(1.second, '1.second.job') {sleep 0}\nevery(10.seconds, '10.seconds.job') {sleep 20}\n\n\nTips\ncron\u3068\u306f\u9055\u3044worker\u306e\u5f15\u6570\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u6307\u5b9a\u3067\u304d\u308b\u3068\u3053\u308d\u304c\u3068\u3066\u3082\u4fbf\u5229\u3067\u3059\u3002\n(\u3082\u3061\u308d\u3093\u30cf\u30c3\u30b7\u30e5\u3082\u4f7f\u3048\u307e\u3059\u3002)\nevery(1.minute, 'Time::Worker') do \n  Time::Worker.perform_async(Time.now, {foo: :bar})\nend\n\n=====================\n\n[Clockwork](https://github.com/tomykaira/clockwork)\u306f\u5b9a\u671f\u7684\u306a\u51e6\u7406\u304c\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u308b\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002\n\u4f7f\u3044\u65b9\u3082\u7c21\u5358\u3067\u3059\u304c\u3001\u305b\u3063\u304b\u304f\u306a\u306e\u3067\u30c1\u30fc\u30c8\u30b7\u30fc\u30c8\u3092\u4f5c\u308a\u307e\u3057\u305f\u3002\n\nClockwork\u306f**cron**\u306e\u4ee3\u66ff\u306b\u4f7f\u3048\u307e\u3059\u3002Ruby\u306a\u306e\u3067DSL\u8a18\u6cd5\u3084\u4fbf\u5229\u306a\u95a2\u6570\u304c\u4f7f\u3048\u307e\u3059\u3002\n(Rails\u3067\u5229\u7528\u3059\u308b\u3068ActionPack\u306a\u3069\u66f4\u306b\u4fbf\u5229\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u4f7f\u3048\u307e\u3059\u3002)\n\n\n# Register\n\n\u5b9a\u671f\u7684\u306b\u51e6\u7406\u3059\u308b\u5185\u5bb9\u3092`every`\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002\n`every`\u306f\u671f\u9593\u3001\u51e6\u7406(\u30b8\u30e7\u30d6)\u3001\u6761\u4ef6\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```\nevery([period], [job name], [options]) [{job block}]\n```\n\n## Period\n\n\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3059\u308b\u671f\u9593(\u9593\u9694)\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u671f\u9593\u306e\u5358\u4f4d\u306f`\u79d2`\u3001`\u5206`\u3001`\u6642`\u3001`\u65e5`\u3001`\u9031`\u3067\u3059\u3002\n\n```\n[\u6570\u5b57].[\u5358\u4f4d\u306e\u30ad\u30fc\u30ef\u30fc\u30c9]\u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n\u30ad\u30fc\u30ef\u30fc\u30c9\u306e\u5358\u6570\u5f62\u3068\u8907\u6570\u5f62\u306f\u30a8\u30a4\u30ea\u30a2\u30b9\u3067\u3059\u3002\n(\u6570\u5b57\u304c1\u306a\u3089\u5358\u6570\u5f62\u30012\u4ee5\u4e0a\u306a\u3089\u8907\u6570\u5f62\u3092\u4f7f\u3046\u3068\u3088\u3044\u3067\u3059\u3002)\n```\n\n### List\n\n| \u5358\u4f4d | \u5358\u6570\u5f62  | \u8907\u6570\u5f62  | Source          |\n|:----:|:-------:|:-------:|:----------------|\n|  \u79d2  | second  | seconds  | period * 1      |\n|  \u5206  | minute  | minutes | period * 60     |\n|  \u6642  | hour    | hours   | period * 3600   |\n|  \u65e5  | day     | days    | period * 86400  |\n|  \u9031  | week    | weeks   | period * 604800 |\n\n### Example\n\n```ruby\nevery(4.seconds, '4.seconds.job')  # 4\u79d2\u9593\u9694\nevery(2.hours, '2.hours.job')      # 2\u6642\u9593\u9593\u9694\nevery(1.day, '1.day.job')          # 1\u65e5\u9593\u9694\n```\n\n## Options\n\n\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3059\u308b\u6761\u4ef6\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u6761\u4ef6\u306b\u306f`at`\u3068`if`\u304c\u3042\u308a\u307e\u3059\u3002\n\n### at\n\n\u4f55\u6642\u306b\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3059\u308b\u304b\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```\n'[\u6642]:[\u5206]' \u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n(\u6642\u9593\u306f\u8907\u6570\u306e\u6307\u5b9a\u304c\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u66dc\u65e5\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002)\n```\n\n#### List\n\n| \u6307\u5b9a  | period | at                 | \u51e6\u7406\u3055\u308c\u308b\u6642\u9593  |\n|:-----:|:------:|:-------------------|:----------------|\n| \u6642\u5206  | 1.day  | '01:30'            | 1\u664230\u5206         |\n| 0\u7701\u7565 | 1.day  | '1:30'             | 1\u664230\u5206         |\n| \u6bce\u6642  | 1.hour | '**:30'            | \u6bce\u664230\u5206        |\n| \u8907\u6570  | 1.hour | ['12:00', '18:00'] | 12\u6642\u306818\u6642      |\n| \u66dc\u65e5  | 1.week | 'Saturday 12:00'   | \u571f\u66dc\u65e5\u306e12\u6642    |\n\n##### Week day list\n\n\u66dc\u65e5\u306f\u7701\u7565\u3092\u5408\u308f\u305b\u308b\u30684\u30d1\u30bf\u30fc\u30f3\u3042\u308a\u307e\u3059\u3002\n\u30a8\u30a4\u30ea\u30a2\u30b9\u306a\u306e\u3067\u597d\u304d\u306a\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u4f7f\u3048\u307e\u3059\u3002\n\n| \u66dc\u65e5 | \u6307\u5b9a1     | \u6307\u5b9a2     | \u6307\u5b9a3 | \u6307\u5b9a4 |\n|:----:|:---------:|:---------:|:-----:|:-----:|\n|  \u65e5  | sunday    | Sunday    |  sun  |  Sun  | \n|  \u6708  | monday    | Monday    |  mon  |  Mon  |\n|  \u706b  | tuesday   | Tuesday   |  tue  |  Tue  |\n|  \u6c34  | wednesday | Wednesday |  wed  |  Wed  |\n|  \u6728  | thursday  | Thursday  |  thu  |  Thu  |\n|  \u91d1  | friday    | Friday    |  fri  |  Fri  | \n|  \u571f  | saturday  | Saturday  |  sat  |  Sat  | \n\n#### Example\n\n```ruby\nevery(1.day, 'job', at: '01:30')             # 1\u664230\u5206\nevery(1.day, 'job', at: '1:30')              # 1\u664230\u5206\nevery(1.hour, 'job', at: '**:30')            # \u6bce\u664230\u5206\nevery(1.hour, 'job', at: ['12:00', '18:00']) # 12\u6642\u306818\u6642\nevery(1.week, 'job', at: 'Saturday 12:00')   # \u571f\u66dc\u65e5\u306e12\u6642\n```\n\n##### Anti-pattern\n\n`period`\u3068`at`\u306e\u7d44\u5408\u305b\u306b\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002\n\n\u4f8b\u3067\u306f\u6bce\u664230\u5206\u306e\u6307\u5b9a\u3067\u3059\u304c\u671f\u9593\u304c1\u65e5\u9593\u9694\u306a\u306e\u3067\u3001Clockwork\u304c12\u6642\u306b\u30b9\u30bf\u30fc\u30c8\u3059\u308b\u3068\n\u521d\u56de\u306f12\u664230\u5206\u306b\u5b9f\u884c\u3055\u308c\u3066\u3001\u6b21\u56de\u306f\u7fcc\u65e5\u306e12\u664230\u5206\u306b\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\n\n```ruby\nevery(1.day, 'job', at: '**:30') # \u6bce\u664230\u5206\u3067\u306f\u5b9f\u884c\u3057\u306a\u3044\uff01\n```\n\n### if\n\n\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3059\u308b\u6761\u4ef6\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n\n```\nlambda { |t| [\u5f0f] } \u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n(\u5f0f\u306b\u6642\u9593\u304c\u4e0d\u8981\u306a\u3089`|t|`\u3092`|_|`\u306b\u5909\u66f4\u3057\u307e\u3059\u3002)\n```\n\n#### Example\n\n\u6708\u521d\u3084\u6708\u672b\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n```ruby\nevery(1.day, 'job', at: '9:00', if: lambda { |t| t.day == 1 }) # \u6708\u521d\u306e9\u6642\nevery(1.day, 'job', at: '21:00', if: lambda { |t| t.day == Date.new(t.year, t.month, -1).day }) # \u6708\u672b\u306e21\u6642\n```\n\n##### Practical\n\n\u51e6\u7406\u306e\u5931\u6557\u3092\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3057\u3066\u30a2\u30e9\u30fc\u30c8\u3092\u901a\u77e5\u3059\u308b\u3053\u3068\u304c\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u307e\u3059\u3002\n([Sidekiq](http://mperham.github.io/sidekiq/)\u3092\u5229\u7528\u3059\u308b\u3068\u975e\u540c\u671f\u51e6\u7406\u306e\u5b9f\u88c5\u304c\u7c21\u5358\u3067\u3059\u3002)\n\n```ruby\nevery(1.minute, 'Failure::Worker', if: lambda { |_| Failure.all.count > 0 }) do \n  Failure::Worker.perform_async\nend\n```\n\n## Job\n\n\u5b9f\u884c\u3059\u308b\u30b8\u30e7\u30d6\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002\n(\u30b8\u30e7\u30d6\u306f[Sidekiq](https://github.com/tomykaira/clockwork#use-with-queueing)\u306a\u3069\u3092\u5229\u7528\u304c\u5fc5\u8981\u3067\u3059\u3002)\n\n```\nevery(period, [job name], options) [{job block}] \u3067\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\n{job block}\u306b\u8a18\u8ff0\u3059\u308b\u65b9\u6cd5\u3068[job name]\u3092\u5229\u7528\u3057\u3066handler\u306b\u8a18\u8ff0\u3059\u308b\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\n```\n\n### Job block\n\n\u671f\u9593\u3001\u6761\u4ef6\u3001\u30b8\u30e7\u30d6\u3092\u307e\u3068\u3081\u3066\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\n\n```ruby\nevery(1.second, '1.second.job') do\n  puts \"Running job\"\nend\n```\n\n### handler\n\n\u671f\u9593\u3001\u6761\u4ef6\u3068\u30b8\u30e7\u30d6\u3092\u5206\u3051\u3066\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002\n\n```ruby\nhandler do |job|\n  case job\n  when '1.second.job'\n    \"Running job\"\n  end \nend\n\nevery(1.second, '1.second.job')\n```\n\n### Example\n\n#### Practical\n\n`Rails`\u306e\u4f8b\u3067\u3059\u304c\u3001\u74b0\u5883(\u958b\u767a\u3084\u672c\u756a)\u306b\u5408\u308f\u305b\u3066\u5236\u5fa1\u3067\u304d\u307e\u3059\u3002\n\n```ruby:clock.rb\nrequire_relative '../config/boot'\nrequire_relative '../config/environment'\n\nrequire 'clockwork'\ninclude Clockwork\n\ncase Rails.env\nwhen 'development'\n  every(1.second, 'seconds.job') do\n    puts \"Running development job\"\n  end\nwhen 'staging'\n  every(1.minute, 'minutes.job') do\n    puts \"Running staging job\"\n  end\nwhen 'production'\n  every(1.hour, 'hours.job') do\n    puts \"Running staging job\"\n  end\nelse # Unknown\n  every(1.day, 'days.job') do\n    puts \"Running production job\"\n  end  \nend\n\n# Shared jobs\nevery(1.week, 'weeks.job') do\n  puts \"Running common job\"\nend\n```\n\n#### Anti-pattern\n\nRuby\u306f\u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u306e\u51e6\u7406\u3092\u3057\u306a\u3044\u3068\u30b8\u30e7\u30d6\u304c\u671f\u5f85\u3057\u305f\u6642\u9593\u306b\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002\n\n\u4f8b\u3067\u306f1\u79d2\u9593\u9694\u306810\u79d2\u9593\u9694\u306e\u30b8\u30e7\u30d6\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002\u3057\u304b\u3057\u300110\u79d2\u9593\u9694\u306e\u30b8\u30e7\u30d6\u3067\n20\u79d2\u306e\u5f85\u3061\u304c\u767a\u751f\u3059\u308b\u306e\u30671\u79d2\u9593\u9694\u306e\u30b8\u30e7\u30d6\u308220\u79d2\u5f85\u305f\u3055\u308c\u307e\u3059\u3002\n\n```ruby\nevery(1.second, '1.second.job') {sleep 0}\nevery(10.seconds, '10.seconds.job') {sleep 20}\n```\n\n\n# Tips\n\n**cron**\u3068\u306f\u9055\u3044`worker`\u306e\u5f15\u6570\u306b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u6307\u5b9a\u3067\u304d\u308b\u3068\u3053\u308d\u304c\u3068\u3066\u3082\u4fbf\u5229\u3067\u3059\u3002\n(\u3082\u3061\u308d\u3093\u30cf\u30c3\u30b7\u30e5\u3082\u4f7f\u3048\u307e\u3059\u3002)\n\n```ruby\nevery(1.minute, 'Time::Worker') do \n  Time::Worker.perform_async(Time.now, {foo: :bar})\nend\n```\n", "tags": ["Ruby", "sidekiq", "Rails", "clockwork"]}