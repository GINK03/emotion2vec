{"context": " More than 1 year has passed since last update.\n\npython \u306e unittest \u3067 selenium \u306e phantomjs webdriver \u3092\u4f7f\u3046\n\n\u809d\n\n\u5148\u306b pip install selenium \u3057\u3066\u304a\u304f\n\nphantomjs \u306b\u30d1\u30b9\u901a\u3057\u3066\u304a\u304f\nuseragent\u306e\u6307\u5b9a\u306f desired_capabilities \u3067\u3067\u304d\u308b\u3089\u3057\u3044\n\u3064\u3044\u3067\u306bwebdriver\u306e\u8a2d\u5b9a\u306f\u30af\u30e9\u30b9\u306e\u30c7\u30b3\u30ec\u30fc\u30bf\u306b\u5207\u308a\u51fa\u3057\u3066\u307f\u305f\n\u6700\u5f8c\u306b driver.quit() \u3057\u3066\u304a\u304b\u306a\u3044\u3068\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u304c\u4fdd\u5b58\u3055\u308c\u306a\u304b\u3063\u305f\u308a\u3059\u308b\n\n\ntest.py\n#!/usr/bin/env python\n# -*- coding:utf-8 -*-\n\nimport os\nimport unittest\nimport commands\n\nfrom selenium import webdriver\nfrom selenium.common.exceptions import NoSuchElementException\n\nUSER_AGENT = \"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.0 Mobile/11D257 Safari/9537.53\"\n\n\ndef unittest_phantomjs_webdriver_decorator(klass):\n    def __setUpClass(cls):\n        (status, phantomjs_path) = commands.getstatusoutput(\"which phantomjs\")\n        if not status == 0:\n            raise StandardError(\"phantomjs is not found!!\")\n\n        cls.driver = webdriver.PhantomJS(\n            executable_path=phantomjs_path,\n            service_log_path=\"/dev/stdout\",\n            desired_capabilities={\n                'phantomjs.page.settings.userAgent': USER_AGENT,\n            },\n            # proxy\u901a\u3059\u5834\u5408\n            #service_args=[\n            #    '--proxy=127.0.0.1:9999',\n            #    '--proxy-type=http',\n            #],\n        )\n        cls.driver.set_window_size(1400, 1000)\n        cls.driver.implicitly_wait(1)\n\n    def __tearDownClass(cls):\n        cls.driver.quit()\n\n    klass.setUpClass = classmethod(__setUpClass)\n    klass.tearDownClass = classmethod(__tearDownClass)\n    return klass\n\n\n@unittest_phantomjs_webdriver_decorator\nclass AccessTest(unittest.TestCase):\n\n    def test_google(self):\n        driver = self.driver\n        url = \"\"\"http://google.com\"\"\"\n        driver.get(url)\n        driver.save_screenshot(\"google.png\")\n\n    def test_amazon(self):\n        driver = self.driver\n        url = \"\"\"http://amazon.com\"\"\"\n        driver.get(url)\n        driver.save_screenshot(\"amazon.png\")\n\nif __name__ == \"__main__\":\n    unittest.main()\n\n\n# python \u306e unittest \u3067 selenium \u306e phantomjs webdriver \u3092\u4f7f\u3046\n\n## \u809d\n\n* \u5148\u306b `pip install selenium` \u3057\u3066\u304a\u304f\n* `phantomjs` \u306b\u30d1\u30b9\u901a\u3057\u3066\u304a\u304f\n* useragent\u306e\u6307\u5b9a\u306f `desired_capabilities` \u3067\u3067\u304d\u308b\u3089\u3057\u3044\n* \u3064\u3044\u3067\u306bwebdriver\u306e\u8a2d\u5b9a\u306f\u30af\u30e9\u30b9\u306e\u30c7\u30b3\u30ec\u30fc\u30bf\u306b\u5207\u308a\u51fa\u3057\u3066\u307f\u305f\n* \u6700\u5f8c\u306b `driver.quit()` \u3057\u3066\u304a\u304b\u306a\u3044\u3068\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u304c\u4fdd\u5b58\u3055\u308c\u306a\u304b\u3063\u305f\u308a\u3059\u308b\n\n```py:test.py\n#!/usr/bin/env python\n# -*- coding:utf-8 -*-\n\nimport os\nimport unittest\nimport commands\n\nfrom selenium import webdriver\nfrom selenium.common.exceptions import NoSuchElementException\n\nUSER_AGENT = \"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.0 Mobile/11D257 Safari/9537.53\"\n\n\ndef unittest_phantomjs_webdriver_decorator(klass):\n    def __setUpClass(cls):\n        (status, phantomjs_path) = commands.getstatusoutput(\"which phantomjs\")\n        if not status == 0:\n            raise StandardError(\"phantomjs is not found!!\")\n\n        cls.driver = webdriver.PhantomJS(\n            executable_path=phantomjs_path,\n            service_log_path=\"/dev/stdout\",\n            desired_capabilities={\n                'phantomjs.page.settings.userAgent': USER_AGENT,\n            },\n            # proxy\u901a\u3059\u5834\u5408\n            #service_args=[\n            #    '--proxy=127.0.0.1:9999',\n            #    '--proxy-type=http',\n            #],\n        )\n        cls.driver.set_window_size(1400, 1000)\n        cls.driver.implicitly_wait(1)\n\n    def __tearDownClass(cls):\n        cls.driver.quit()\n\n    klass.setUpClass = classmethod(__setUpClass)\n    klass.tearDownClass = classmethod(__tearDownClass)\n    return klass\n\n\n@unittest_phantomjs_webdriver_decorator\nclass AccessTest(unittest.TestCase):\n\n    def test_google(self):\n        driver = self.driver\n        url = \"\"\"http://google.com\"\"\"\n        driver.get(url)\n        driver.save_screenshot(\"google.png\")\n\n    def test_amazon(self):\n        driver = self.driver\n        url = \"\"\"http://amazon.com\"\"\"\n        driver.get(url)\n        driver.save_screenshot(\"amazon.png\")\n\nif __name__ == \"__main__\":\n    unittest.main()\n```\n", "tags": ["Python", "Selenium", "PhantomJS"]}