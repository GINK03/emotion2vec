{"context": "\n\nAWS EB\u306eEC2\u3078\u306e\u7a81\u7136\u306e\u30c7\u30d7\u30ed\u30a4\u5931\u6557\n\u958b\u767a\u7528\u306e\u74b0\u5883\u3092 AWS ElasticBeanstalk\u3067EC2(t2.micro)\u3067\u3084\u3063\u3066\u305f\u306e\u3067\u3059\u304c\u3001\u3042\u308b\u6642\u304b\u3089\u30c7\u30d7\u30ed\u30a4\u304c\u5931\u6557\u7d9a\u304d\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u307e\u3057\u305f\u3002\n\n\u539f\u56e0\u3092\u63a2\u308b\nEB\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u6642\u306e\u6319\u52d5\u306f\u3001 /var/log/eb-activity.log \u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u5931\u6557\u3057\u3066\u308b\u3068\u3053\u308d\u3092\u63a2\u3057\u307e\u3057\u3087\u3046\u3002\n[2016-07-02T03:22:47.996Z] INFO  [9470]  - [Application /AppDeployStage0/AppDeployPreHook/06_npm_install.sh] : Activity execution failed, because: ++ /opt/elasticbeanstalk/bin/get-config container -k app_staging_dir\n\n\uff08\u7565\uff09\n\n  > node-sass@3.8.0 install /var/app/ondeck/node_modules/node-sass\n  > node scripts/install.js\n\n\n   (Executor::NonZeroExitStatus)\n\n\n[2016-07-02T03:22:48.000Z] INFO  [9470]  - [Application /AppDeployStage0/AppDeployPreHook/06_npm_install.sh] : Activity failed.\n\n\u3053\u3093\u306a\u611f\u3058\u306e\u30ed\u30b0\u304c\u51fa\u307e\u3059\u3002\n\u3053\u308c\u306fnpm install\u7528\u306e\u81ea\u4f5c\u306e\u30c7\u30d7\u30ed\u30a4\u30d5\u30c3\u30af\u306e\u51e6\u7406\u3067\u3059\u3002\nNonZeroExitStatus\u3068\u66f8\u3044\u3066\u3042\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u4f55\u3089\u304b\u306e\u7570\u5e38\u51e6\u7406\u304c\u884c\u308f\u308c\u3066\u308b\u3063\u307d\u3044\u3068\u3044\u3046\u4e8b\u306f\u5206\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u30a8\u30e9\u30fc\u5185\u5bb9\u3060\u3068\u4f55\u304c\u539f\u56e0\u304b\u3044\u307e\u3044\u3061\u5206\u304b\u3089\u306a\u3044\u306e\u3067\u3059\u304c\u3001OOM Killer\uff08\u30e1\u30e2\u30ea\u4e0d\u8db3\uff09\u306a\u7591\u3044\u304c\u3002\n\n\u30b9\u30ef\u30c3\u30d7\u9818\u57df\u306e\u78ba\u4fdd\nt2.micro\u306a\u306e\u3067\u30e1\u30e2\u30ea\u304c\uff11G\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u30b9\u30ef\u30c3\u30d7\u9818\u57df\u3092\uff11G\u5897\u3084\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u307e\u305a\u73fe\u72b6\u306e\u78ba\u8a8d\n$ grep Mem /proc/meminfo \nMemTotal:        1019336 kB\nMemFree:          568256 kB\nMemAvailable:     598736 kB\n$ grep Swap /proc/meminfo \nSwapCached:            0 kB\nSwapTotal:             0 kB\nSwapFree:              0 kB\n$ free\n             total       used       free     shared    buffers     cached\nMem:       1019336     451064     568272         80      23544      95392\n-/+ buffers/cache:     332128     687208\nSwap:            0          0          0\n$ df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9   \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/xvda1       7.8G  4.0G  3.7G   52% /\ndevtmpfs         490M   56K  490M    1% /dev\ntmpfs            498M     0  498M    0% /dev/shm\n\n\n\u30b9\u30ef\u30c3\u30d7\u9818\u57df\u78ba\u4fdd\n$ sudo dd if=/dev/zero of=/swapfile bs=1M count=1024\n1024+0 \u30ec\u30b3\u30fc\u30c9\u5165\u529b\n1024+0 \u30ec\u30b3\u30fc\u30c9\u51fa\u529b\n1073741824 \u30d0\u30a4\u30c8 (1.1 GB) \u30b3\u30d4\u30fc\u3055\u308c\u307e\u3057\u305f\u3001 14.0276 \u79d2\u3001 76.5 MB/\u79d2\n$ sudo mkswap /swapfile \n\u30b9\u30ef\u30c3\u30d7\u7a7a\u9593\u30d0\u30fc\u30b8\u30e7\u30f31\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3001\u30b5\u30a4\u30ba = 1048572 KiB\n\u30e9\u30d9\u30eb\u306f\u3042\u308a\u307e\u305b\u3093, UUID=274ae598-42ab-41e0-b229-bb0a2ccb6c09\n$ sudo swapon /swapfile \nswapon: /swapfile: \u5b89\u5168\u3067\u306a\u3044\u6a29\u9650 0644 \u3092\u6301\u3061\u307e\u3059\u3002 0600 \u304c\u304a\u52e7\u3081\u3067\u3059\u3002\n$ sudo chmod 600 /swapfile \n$ ls -l /swapfile \n-rw------- 1 root root 1073741824  7\u6708  2 03:36 /swapfile\n\n\n\u78ba\u8a8d\n$ grep Swap /proc/meminfo \nSwapCached:            0 kB\nSwapTotal:       1048572 kB\nSwapFree:        1048572 kB\n$ free\n             total       used       free     shared    buffers     cached\nMem:       1019336     956532      62804         80      20928     602920\n-/+ buffers/cache:     332684     686652\nSwap:      1048572          0    1048572\n$ df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9   \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/xvda1       7.8G  5.0G  2.7G   65% /\ndevtmpfs         490M   56K  490M    1% /dev\ntmpfs            498M     0  498M    0% /dev/shm\n\n\u30b9\u30ef\u30c3\u30d7\u9818\u57df\u306e\u78ba\u4fdd\u306f\u8272\u3093\u306a\u6240\u306b\u3084\u308a\u65b9\u304c\u8f09\u3063\u3066\u307e\u3059\u306e\u3067\u3001\u8a73\u3057\u304f\u306f\u30b0\u30b0\u30c3\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n\u30c7\u30d7\u30ed\u30a4\u6210\u529f\n\u3053\u308c\u3067\u30b9\u30ef\u30c3\u30d7\u9818\u57df\u3092\u78ba\u4fdd\u3057\u3066\u304b\u3089\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u3089\u3001\u3046\u307e\u304f\u884c\u304d\u307e\u3057\u305f\u3002\nRails\u306easset precompile\u304c\u540c\u69d8\u306b\u30e1\u30e2\u30ea\u4e0d\u8db3\u306b\u306a\u308b\u306e\u306f\u4f55\u5ea6\u3082\u7d4c\u9a13\u3042\u308b\u3093\u3067\u3059\u304c\u3001npm install\u3082\u30e1\u30e2\u30ea\u98df\u3046\u3093\u3067\u3059\u306d\u3002\n\u826f\u304b\u3063\u305f\u3089\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n# AWS EB\u306eEC2\u3078\u306e\u7a81\u7136\u306e\u30c7\u30d7\u30ed\u30a4\u5931\u6557\n\n\u958b\u767a\u7528\u306e\u74b0\u5883\u3092 AWS ElasticBeanstalk\u3067EC2(t2.micro)\u3067\u3084\u3063\u3066\u305f\u306e\u3067\u3059\u304c\u3001\u3042\u308b\u6642\u304b\u3089\u30c7\u30d7\u30ed\u30a4\u304c\u5931\u6557\u7d9a\u304d\u306b\u306a\u3063\u3066\u3057\u307e\u3063\u3066\u307e\u3057\u305f\u3002\n\n# \u539f\u56e0\u3092\u63a2\u308b\n\nEB\u3078\u306e\u30c7\u30d7\u30ed\u30a4\u6642\u306e\u6319\u52d5\u306f\u3001 `/var/log/eb-activity.log` \u3067\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\u5931\u6557\u3057\u3066\u308b\u3068\u3053\u308d\u3092\u63a2\u3057\u307e\u3057\u3087\u3046\u3002\n\n```\n[2016-07-02T03:22:47.996Z] INFO  [9470]  - [Application /AppDeployStage0/AppDeployPreHook/06_npm_install.sh] : Activity execution failed, because: ++ /opt/elasticbeanstalk/bin/get-config container -k app_staging_dir\n\n\uff08\u7565\uff09\n\n  > node-sass@3.8.0 install /var/app/ondeck/node_modules/node-sass\n  > node scripts/install.js\n\n\n   (Executor::NonZeroExitStatus)\n\n\n[2016-07-02T03:22:48.000Z] INFO  [9470]  - [Application /AppDeployStage0/AppDeployPreHook/06_npm_install.sh] : Activity failed.\n```\n\n\u3053\u3093\u306a\u611f\u3058\u306e\u30ed\u30b0\u304c\u51fa\u307e\u3059\u3002\n\u3053\u308c\u306fnpm install\u7528\u306e\u81ea\u4f5c\u306e\u30c7\u30d7\u30ed\u30a4\u30d5\u30c3\u30af\u306e\u51e6\u7406\u3067\u3059\u3002\n\nNonZeroExitStatus\u3068\u66f8\u3044\u3066\u3042\u308b\u306e\u3067\u3001\u3053\u3053\u3067\u4f55\u3089\u304b\u306e\u7570\u5e38\u51e6\u7406\u304c\u884c\u308f\u308c\u3066\u308b\u3063\u307d\u3044\u3068\u3044\u3046\u4e8b\u306f\u5206\u304b\u308a\u307e\u3059\u3002\n\u3053\u306e\u30a8\u30e9\u30fc\u5185\u5bb9\u3060\u3068\u4f55\u304c\u539f\u56e0\u304b\u3044\u307e\u3044\u3061\u5206\u304b\u3089\u306a\u3044\u306e\u3067\u3059\u304c\u3001OOM Killer\uff08\u30e1\u30e2\u30ea\u4e0d\u8db3\uff09\u306a\u7591\u3044\u304c\u3002\n\n## \u30b9\u30ef\u30c3\u30d7\u9818\u57df\u306e\u78ba\u4fdd\n\nt2.micro\u306a\u306e\u3067\u30e1\u30e2\u30ea\u304c\uff11G\u3057\u304b\u3042\u308a\u307e\u305b\u3093\u3002\n\u30b9\u30ef\u30c3\u30d7\u9818\u57df\u3092\uff11G\u5897\u3084\u3057\u3066\u307f\u307e\u3059\u3002\n\n### \u307e\u305a\u73fe\u72b6\u306e\u78ba\u8a8d\n```bash\n$ grep Mem /proc/meminfo \nMemTotal:        1019336 kB\nMemFree:          568256 kB\nMemAvailable:     598736 kB\n$ grep Swap /proc/meminfo \nSwapCached:            0 kB\nSwapTotal:             0 kB\nSwapFree:              0 kB\n$ free\n             total       used       free     shared    buffers     cached\nMem:       1019336     451064     568272         80      23544      95392\n-/+ buffers/cache:     332128     687208\nSwap:            0          0          0\n$ df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9   \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/xvda1       7.8G  4.0G  3.7G   52% /\ndevtmpfs         490M   56K  490M    1% /dev\ntmpfs            498M     0  498M    0% /dev/shm\n```\n\n### \u30b9\u30ef\u30c3\u30d7\u9818\u57df\u78ba\u4fdd\n\n```bash\n$ sudo dd if=/dev/zero of=/swapfile bs=1M count=1024\n1024+0 \u30ec\u30b3\u30fc\u30c9\u5165\u529b\n1024+0 \u30ec\u30b3\u30fc\u30c9\u51fa\u529b\n1073741824 \u30d0\u30a4\u30c8 (1.1 GB) \u30b3\u30d4\u30fc\u3055\u308c\u307e\u3057\u305f\u3001 14.0276 \u79d2\u3001 76.5 MB/\u79d2\n$ sudo mkswap /swapfile \n\u30b9\u30ef\u30c3\u30d7\u7a7a\u9593\u30d0\u30fc\u30b8\u30e7\u30f31\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3001\u30b5\u30a4\u30ba = 1048572 KiB\n\u30e9\u30d9\u30eb\u306f\u3042\u308a\u307e\u305b\u3093, UUID=274ae598-42ab-41e0-b229-bb0a2ccb6c09\n$ sudo swapon /swapfile \nswapon: /swapfile: \u5b89\u5168\u3067\u306a\u3044\u6a29\u9650 0644 \u3092\u6301\u3061\u307e\u3059\u3002 0600 \u304c\u304a\u52e7\u3081\u3067\u3059\u3002\n$ sudo chmod 600 /swapfile \n$ ls -l /swapfile \n-rw------- 1 root root 1073741824  7\u6708  2 03:36 /swapfile\n```\n\n### \u78ba\u8a8d\n\n```bash\n$ grep Swap /proc/meminfo \nSwapCached:            0 kB\nSwapTotal:       1048572 kB\nSwapFree:        1048572 kB\n$ free\n             total       used       free     shared    buffers     cached\nMem:       1019336     956532      62804         80      20928     602920\n-/+ buffers/cache:     332684     686652\nSwap:      1048572          0    1048572\n$ df -h\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9   \u30b5\u30a4\u30ba  \u4f7f\u7528  \u6b8b\u308a \u4f7f\u7528% \u30de\u30a6\u30f3\u30c8\u4f4d\u7f6e\n/dev/xvda1       7.8G  5.0G  2.7G   65% /\ndevtmpfs         490M   56K  490M    1% /dev\ntmpfs            498M     0  498M    0% /dev/shm\n```\n\n\u30b9\u30ef\u30c3\u30d7\u9818\u57df\u306e\u78ba\u4fdd\u306f\u8272\u3093\u306a\u6240\u306b\u3084\u308a\u65b9\u304c\u8f09\u3063\u3066\u307e\u3059\u306e\u3067\u3001\u8a73\u3057\u304f\u306f\u30b0\u30b0\u30c3\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n\n# \u30c7\u30d7\u30ed\u30a4\u6210\u529f\n\n\u3053\u308c\u3067\u30b9\u30ef\u30c3\u30d7\u9818\u57df\u3092\u78ba\u4fdd\u3057\u3066\u304b\u3089\u30c7\u30d7\u30ed\u30a4\u3057\u305f\u3089\u3001\u3046\u307e\u304f\u884c\u304d\u307e\u3057\u305f\u3002\nRails\u306easset precompile\u304c\u540c\u69d8\u306b\u30e1\u30e2\u30ea\u4e0d\u8db3\u306b\u306a\u308b\u306e\u306f\u4f55\u5ea6\u3082\u7d4c\u9a13\u3042\u308b\u3093\u3067\u3059\u304c\u3001npm install\u3082\u30e1\u30e2\u30ea\u98df\u3046\u3093\u3067\u3059\u306d\u3002\n\u826f\u304b\u3063\u305f\u3089\u8a66\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002\n", "tags": ["AWS", "npm", "Node.js", "ElasticBeanstalk", "EC2"]}