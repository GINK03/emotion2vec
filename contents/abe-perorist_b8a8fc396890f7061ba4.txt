{"context": " More than 1 year has passed since last update.\n\n\u3053\u306e\u8a18\u4e8b\u306e\u76ee\u7684\n\u4eca\u56de\u306f\u3001\u300c2\u3064\u306etable\u306b\u5b58\u5728\u3059\u308buid\u306e\u30e6\u30cb\u30fc\u30af\u6570\u3092\u6628\u65e51\u65e5\u5206\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306e\u30af\u30a8\u30ea\u300d\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\u305f\u3060\u3044\u307e\u904b\u55b6\u4e2d\u306ePlayer!\u3067Treasure Data\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30c7\u30fc\u30bfExport\u306b\u4f7f\u3046Hive QL\u3092\u8a2d\u5b9a\u3057\u305f\u969b\u306e\u3061\u3087\u3063\u3068\u3057\u305f\u77e5\u8b58\u306e\u5171\u6709\u3002\n\u6570\u5024\u306e\u5206\u6790\u4f53\u5236\u306b\u3064\u3044\u3066\u306f\u3001\u3053\u3061\u3089\u306e\u8a18\u4e8b\u3092\u3054\u53c2\u8003\u304f\u3060\u3055\u3044\u3002iPhone\u30a2\u30d7\u30ea\u306e\u6570\u5024\u5206\u6790\u4f53\u5236\u3092\u4e00\u6319\u516c\u958b\n\n\u3067\u304d\u308b\u3053\u3068\n\u4f8b\u3048\u3070\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306btable\u304c2\u3064\u3042\u308b\u3068\u3057\u307e\u3059\u3002\nnews_show\n\n\n\ntime\nuid\nnews_id\n\n\n\n\nOct 02, 2015 @ 02:39:21 AM\n1\n10\n\n\nOct 02, 2015 @ 02:19:17 AM\n2\n20\n\n\nOct 02, 2015 @ 01:18:47 AM\n3\n30\n\n\n\npicks_list\n\n\n\ntime\nuid\nnews_id\n\n\n\n\nOct 02, 2015 @ 02:35:28 AM\n1\n11\n\n\nOct 02, 2015 @ 02:08:27 AM\n4\n22\n\n\nOct 02, 2015 @ 01:56:15 AM\n5\n33\n\n\n\n\u305d\u306e2\u3064\u306etable\u306b\u5b58\u5728\u3059\u308b\u30e6\u30cb\u30fc\u30afuid\u6570\u3092\u3001\u6628\u65e51\u65e5\u5206\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u5177\u4f53\u7684\u306a\u30af\u30a8\u30ea\n\nHiveQL\nSELECT \n  td_time_format(time,\n    'yy-MM-dd',\n    'Asia/Tokyo') AS d,  /// \u5143\u30c7\u30fc\u30bf\u306etime\u304cUNIX\u306a\u306e\u3067\u3001JST\u306b\u5909\u63db\n  COUNT(DISTINCT uid) AS active_users  /// \u30a2\u30af\u30c6\u30a3\u30d6\u30e6\u30fc\u30b6\u30fc\u3068\u3057\u3066\u3001\u30e6\u30cb\u30fc\u30af\u306auid\u6570\u3092\u53d6\u5f97\nFROM (\n    SELECT \n      uid,\n      time\n    FROM\n      news_show\n  UNION\n  ALL SELECT \n    uid,\n    time\n  FROM\n    picks_list\n  ) tmp  /// ()\u5185\u3067\u3001picks_list\u3068news_show\u306euid\u3068time\u3092\u5408\u4f53\u3055\u305b\u3066\u3044\u308b\nWHERE\n  td_time_range(time,\n    td_time_add(td_scheduled_time(),\n      '-1d'),\n    td_scheduled_time())  /// \u30af\u30ed\u30fc\u30f3\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u6bce\u65e5\u591c\u4e2d\u306e12\u6642\u306b\u56de\u3059\u306e\u3067\u3001\u524d\u65e500:00 ~ 23:59\u307e\u3067\u53d6\u5f97\u3067\u304d\u308b\nGROUP BY\n  td_time_format(time,\n    'yy-MM-dd',\n    'Asia/Tokyo')\n\n\n\nExport\u7d50\u679c(to Google Spreadsheet)\n\n\n\nd\nactive_users\n\n\n\n\n2015-10-01\n5\n\n\n\n\n\u307e\u3068\u3081\nTreasure Data\u306e\u5834\u5408\u3001Supported Hive UDFs (User Defined Functions)\u3067\u691c\u7d22\u3059\u308b\u3068\u3001\u304b\u306a\u308a\u306e\u78ba\u7387\u3067\u60a9\u307f\u306f\u89e3\u6c7a\u3057\u307e\u3059\u3002\n\u305f\u3060\u3001\u4eca\u56de\u306f\u30012\u3064\u306etable\u306b\u5171\u901a\u3059\u308buid\u3092\u7e26\u306b\u4e26\u3079\u305f\u304b\u3063\u305f(\u3053\u306e\u8868\u73fe\u304c\u6b63\u3057\u3044\u304b\u308f\u304b\u308a\u307e\u305b\u3093\u304c)\u306e\u3067\u3001\u63a2\u3057\u65b9\u304c\u30a4\u30de\u30a4\u30c1\u308f\u304b\u3089\u305a\u82e6\u52b4\u3057\u307e\u3057\u305f\u3002\n\u305d\u306e\u305f\u3081\u3001\u5171\u6709\u3057\u3066\u304a\u3053\u3046\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n# \u3053\u306e\u8a18\u4e8b\u306e\u76ee\u7684\n\n\u4eca\u56de\u306f\u3001\u300c2\u3064\u306etable\u306b\u5b58\u5728\u3059\u308buid\u306e\u30e6\u30cb\u30fc\u30af\u6570\u3092\u6628\u65e51\u65e5\u5206\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306e\u30af\u30a8\u30ea\u300d\u3092\u8a18\u8f09\u3057\u307e\u3059\u3002\n\n\u305f\u3060\u3044\u307e\u904b\u55b6\u4e2d\u306e[Player!](https://itunes.apple.com/jp/app/player!-your-sports-news-curator/id897872395)\u3067Treasure Data\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u30c7\u30fc\u30bfExport\u306b\u4f7f\u3046Hive QL\u3092\u8a2d\u5b9a\u3057\u305f\u969b\u306e\u3061\u3087\u3063\u3068\u3057\u305f\u77e5\u8b58\u306e\u5171\u6709\u3002\n\n\u6570\u5024\u306e\u5206\u6790\u4f53\u5236\u306b\u3064\u3044\u3066\u306f\u3001\u3053\u3061\u3089\u306e\u8a18\u4e8b\u3092\u3054\u53c2\u8003\u304f\u3060\u3055\u3044\u3002[iPhone\u30a2\u30d7\u30ea\u306e\u6570\u5024\u5206\u6790\u4f53\u5236\u3092\u4e00\u6319\u516c\u958b](http://qiita.com/abe-perorist/items/67064e3fe97c97637473)\n\n## \u3067\u304d\u308b\u3053\u3068\n\u4f8b\u3048\u3070\u3001\u4e0b\u8a18\u306e\u3088\u3046\u306btable\u304c2\u3064\u3042\u308b\u3068\u3057\u307e\u3059\u3002\n\n\nnews_show\n\n| time | uid | news_id |\n| --- | --- | --- |\n| Oct 02, 2015 @ 02:39:21 AM | 1 | 10 |\n| Oct 02, 2015 @ 02:19:17 AM | 2 | 20 |\n| Oct 02, 2015 @ 01:18:47 AM | 3 | 30 |\n\npicks_list\n\n| time | uid | news_id |\n| --- | --- | --- |\n| Oct 02, 2015 @ 02:35:28 AM | 1 | 11 |\n| Oct 02, 2015 @ 02:08:27 AM | 4 | 22 |\n| Oct 02, 2015 @ 01:56:15 AM | 5 | 33 |\n\n\n\u305d\u306e2\u3064\u306etable\u306b\u5b58\u5728\u3059\u308b\u30e6\u30cb\u30fc\u30afuid\u6570\u3092\u3001\u6628\u65e51\u65e5\u5206\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\n\n\n## \u5177\u4f53\u7684\u306a\u30af\u30a8\u30ea\n\n```HiveQL:HiveQL\nSELECT \n  td_time_format(time,\n    'yy-MM-dd',\n    'Asia/Tokyo') AS d,  /// \u5143\u30c7\u30fc\u30bf\u306etime\u304cUNIX\u306a\u306e\u3067\u3001JST\u306b\u5909\u63db\n  COUNT(DISTINCT uid) AS active_users  /// \u30a2\u30af\u30c6\u30a3\u30d6\u30e6\u30fc\u30b6\u30fc\u3068\u3057\u3066\u3001\u30e6\u30cb\u30fc\u30af\u306auid\u6570\u3092\u53d6\u5f97\nFROM (\n    SELECT \n      uid,\n      time\n    FROM\n      news_show\n  UNION\n  ALL SELECT \n    uid,\n    time\n  FROM\n    picks_list\n  ) tmp  /// ()\u5185\u3067\u3001picks_list\u3068news_show\u306euid\u3068time\u3092\u5408\u4f53\u3055\u305b\u3066\u3044\u308b\nWHERE\n  td_time_range(time,\n    td_time_add(td_scheduled_time(),\n      '-1d'),\n    td_scheduled_time())  /// \u30af\u30ed\u30fc\u30f3\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3092\u6bce\u65e5\u591c\u4e2d\u306e12\u6642\u306b\u56de\u3059\u306e\u3067\u3001\u524d\u65e500:00 ~ 23:59\u307e\u3067\u53d6\u5f97\u3067\u304d\u308b\nGROUP BY\n  td_time_format(time,\n    'yy-MM-dd',\n    'Asia/Tokyo')\n```\n\n#### Export\u7d50\u679c(to Google Spreadsheet)\n\n| d | active_users |\n| --- | --- |\n| 2015-10-01 | 5 |\n\n\n\n## \u307e\u3068\u3081\nTreasure Data\u306e\u5834\u5408\u3001[Supported Hive UDFs (User Defined Functions)](http://docs.treasuredata.com/articles/udfs#stq=&stp=0)\u3067\u691c\u7d22\u3059\u308b\u3068\u3001\u304b\u306a\u308a\u306e\u78ba\u7387\u3067\u60a9\u307f\u306f\u89e3\u6c7a\u3057\u307e\u3059\u3002\n\u305f\u3060\u3001\u4eca\u56de\u306f\u30012\u3064\u306etable\u306b\u5171\u901a\u3059\u308buid\u3092\u7e26\u306b\u4e26\u3079\u305f\u304b\u3063\u305f(\u3053\u306e\u8868\u73fe\u304c\u6b63\u3057\u3044\u304b\u308f\u304b\u308a\u307e\u305b\u3093\u304c)\u306e\u3067\u3001\u63a2\u3057\u65b9\u304c\u30a4\u30de\u30a4\u30c1\u308f\u304b\u3089\u305a\u82e6\u52b4\u3057\u307e\u3057\u305f\u3002\n\u305d\u306e\u305f\u3081\u3001\u5171\u6709\u3057\u3066\u304a\u3053\u3046\u3068\u601d\u3044\u307e\u3057\u305f\u3002\n", "tags": ["TreasureData", "hive", "hiveql"]}