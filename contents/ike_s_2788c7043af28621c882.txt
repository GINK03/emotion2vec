{"tags": ["Kafka0.8.1"], "context": " More than 1 year has passed since last update.\u3053\u3053\u3067\u306f\u30b5\u30fc\u30d0\u30fc\u3092\uff12\u53f0\u304b\u3089\uff14\u53f0\u306b\u5897\u8a2d\u3059\u308b\u3068\u60f3\u5b9a\n\u73fe\u72b6\u3092\u78ba\u8a8d\n$ kafka-topics.sh --describe --zookeeper localhost:2181/kafka  --topic test_queue\nTopic:test_queue    PartitionCount:64   ReplicationFactor:2 Configs:\n    Topic: test_queue   Partition: 0    Leader: 1   Replicas: 0,1   Isr: 1,0\n    Topic: test_queue   Partition: 1    Leader: 1   Replicas: 1,0   Isr: 1,0\n...\n\n0,1\u306e\u307f\u306b\u5272\u308a\u632f\u3089\u308c\u3066\u3044\u308b\nconfig\u4f5c\u6210\n\ntopics-to-move.json\n{\"topics\":\n     [{\"topic\": \"test_queue\"}],\n     \"version\":1\n}\n\n\n\u5b9f\u884c\n$ kafka-reassign-partitions.sh  --zookeeper localhost:2181/kafka --topics-to-move-json-file test.json  --broker-list \"0,1,2,3\"  --generate\n\nCurrent partition replica assignment\n{\"version\":1,\"partitions\":...\n\nProposed partition reassignment configuration\n{\"version\":1,\"partitions\":...\n\n\n'Proposed partition reassignment configuration'\u4ee5\u4e0b\u306eJSON\u3092partitions-to-move.json\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\n$ kafka-reassign-partitions.sh  --zookeeper localhost:2181/kafka --reassignment-json-file partitions-to-move.json  --execute\n\n\u78ba\u8a8d\n$ kafka-topics.sh --describe --zookeeper localhost:2181/kafka  --topic test_queue\nTopic:test_queue    PartitionCount:64   ReplicationFactor:2 Configs:\n    Topic: test_queue   Partition: 0    Leader: 0   Replicas: 0,3   Isr: 0,3\n    Topic: test_queue   Partition: 1    Leader: 1   Replicas: 1,0   Isr: 1,0\n    Topic: test_queue   Partition: 2    Leader: 1   Replicas: 2,1   Isr: 1,2\n...\n\nReplicas, Isr\u304c2,3\u306b\u3082\u5272\u308a\u632f\u3089\u308c\u3066\u3044\u308c\u3070OK\n\u53c2\u8003\nhttps://cwiki.apache.org/confluence/display/KAFKA/Replication+tools#Replicationtools-6.ReassignPartitionsTool\n\u3053\u3053\u3067\u306f\u30b5\u30fc\u30d0\u30fc\u3092\uff12\u53f0\u304b\u3089\uff14\u53f0\u306b\u5897\u8a2d\u3059\u308b\u3068\u60f3\u5b9a\n\n\u73fe\u72b6\u3092\u78ba\u8a8d\n\n```bash\n$ kafka-topics.sh --describe --zookeeper localhost:2181/kafka  --topic test_queue\nTopic:test_queue\tPartitionCount:64\tReplicationFactor:2\tConfigs:\n\tTopic: test_queue\tPartition: 0\tLeader: 1\tReplicas: 0,1\tIsr: 1,0\n\tTopic: test_queue\tPartition: 1\tLeader: 1\tReplicas: 1,0\tIsr: 1,0\n...\n```\n\n0,1\u306e\u307f\u306b\u5272\u308a\u632f\u3089\u308c\u3066\u3044\u308b\n\nconfig\u4f5c\u6210\n\n```topics-to-move.json\n{\"topics\":\n     [{\"topic\": \"test_queue\"}],\n     \"version\":1\n}\n```\n\n\u5b9f\u884c\n\n```bash\n$ kafka-reassign-partitions.sh  --zookeeper localhost:2181/kafka --topics-to-move-json-file test.json  --broker-list \"0,1,2,3\"  --generate\n\nCurrent partition replica assignment\n{\"version\":1,\"partitions\":...\n\nProposed partition reassignment configuration\n{\"version\":1,\"partitions\":...\n\n```\n'Proposed partition reassignment configuration'\u4ee5\u4e0b\u306eJSON\u3092partitions-to-move.json\u3068\u3044\u3046\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\n\n```bash\n$ kafka-reassign-partitions.sh  --zookeeper localhost:2181/kafka --reassignment-json-file partitions-to-move.json  --execute\n```\n\n\u78ba\u8a8d\n\n```bash\n$ kafka-topics.sh --describe --zookeeper localhost:2181/kafka  --topic test_queue\nTopic:test_queue\tPartitionCount:64\tReplicationFactor:2\tConfigs:\n\tTopic: test_queue\tPartition: 0\tLeader: 0\tReplicas: 0,3\tIsr: 0,3\n\tTopic: test_queue\tPartition: 1\tLeader: 1\tReplicas: 1,0\tIsr: 1,0\n\tTopic: test_queue\tPartition: 2\tLeader: 1\tReplicas: 2,1\tIsr: 1,2\n...\n```\n\nReplicas, Isr\u304c2,3\u306b\u3082\u5272\u308a\u632f\u3089\u308c\u3066\u3044\u308c\u3070OK\n\n\n\u53c2\u8003\nhttps://cwiki.apache.org/confluence/display/KAFKA/Replication+tools#Replicationtools-6.ReassignPartitionsTool\n"}