{"context": "\u627f\u524d\n\u30fb\u30ab\u30fc\u30cd\u30eb\u30c8\u30ea\u30c3\u30af\n\u30fbR de \u300e\u30ab\u30fc\u30cd\u30eb\u591a\u5909\u91cf\u89e3\u6790\u300f\n\u30fbR de \u300e\u30ab\u30fc\u30cd\u30eb\u591a\u5909\u91cf\u89e3\u6790\u300f-2\n\u6559\u79d1\u66f8\n\u300e\u30ab\u30fc\u30cd\u30eb\u591a\u5909\u91cf\u89e3\u6790\u300f\n\u300e\u30d1\u30bf\u30fc\u30f3\u8a8d\u8b58\u3068\u6a5f\u68b0\u5b66\u7fd2\u300f\n\n\u5fa9\u7fd2\n$\u03c6(x_i)\u03c6(x_j)$\u306e\u5f62\u3067\u66f8\u3051\u308b\u95a2\u6570\u306f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k(x_i,x_j)$\u3068\u3057\u3066\u6271\u3048\u3001\n\u30b0\u30e9\u30e0\u884c\u5217$K$\u3092\u6c42\u3081\u308b\u4e8b\u3067\u3001\u4f8b\u3048\u3070\u7121\u9650\u306e\u7279\u5fb4\u91cf\u3092\u8003\u616e\u3057\u305f\u8fd1\u4f3c\u304c\u7c21\u5358\u306b\u884c\u3048\u305f\u3002\n(\u30ab\u30fc\u30cd\u30eb\u30c8\u30ea\u30c3\u30af)\n\u3053\u308c\u3067\u306f\u307e\u3060\u4e0d\u4fbf\u3067\u3059\u3002\n\u524d\u56de\u306b\u7d39\u4ecb\u3057\u305f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k(x_i,x_j)$\uff1a\u30ac\u30a6\u30b9\u30ab\u30fc\u30cd\u30eb\u3068\u547c\u3070\u308c\u307e\u3059\u3001\u3084\u3001\u305d\u308c\u306b\u5bfe\u5fdc\u3059\u308b$\u03c6(x)$\u306f\u3001\u7a7a\u304b\u3089\u964d\u3063\u3066\u304d\u305f\u3082\u306e\u3067\u3059\u3002\n\\begin{eqnarray}\nk(x_i, x_j)&=&\u03b1\\ \\mathrm{exp}\\left(-\\beta\\ ||x_i-x_j||^2\\right)\\tag{1}\\\\\n\u03c6(x)&=&\\left(A\\ \\mathrm{exp}\\left(-B(x-z)^2\\right)\\mid\\ z\\in\\mathbb{R} \\right) \\tag{2}\\\\\n\\end{eqnarray}\n\n\u3053\u306e\u307e\u307e\u3060\u3068\u3001\u7a7a\u304b\u3089\u964d\u3063\u3066\u304d\u305f\u7279\u5fb4\u91cf\u30d9\u30af\u30c8\u30eb\u306e\u5185\u7a4d\u3092\u6c42\u3081\u305f\u308a\u3001\u7a7a\u304b\u3089\u964d\u3063\u3066\u304d\u305f\u95a2\u6570\u3092\u306a\u3093\u3089\u304b\u306e\u7279\u5fb4\u30d9\u30af\u30c8\u30eb\u306e\u5185\u7a4d\u306b\u5206\u89e3\u3067\u304d\u308b\u304b\u3092\u78ba\u304b\u3081\u306a\u3044\u3068\u3001\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u3068\u3057\u3066\u4f7f\u3048\u306a\u3044\u3002\n\u305d\u308c\u306f\u9762\u5012\u3002\n\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u304c\u5fc5\u305a\u6e80\u305f\u3059(\u304b\u3064\u7c21\u4fbf\u306b\u691c\u8a3c\u53ef\u80fd\u306a)\u6027\u8cea\u304c\u660e\u3089\u304b\u306b\u306a\u308c\u3070\u3001\u7279\u5fb4\u91cf\u304b\u3089\u96e2\u308c\u3066\u3001\u3044\u304d\u306a\u308a\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u304b\u3069\u3046\u304b\u3092\u691c\u8a3c\u3067\u304d\u308b\u3002\n\u305d\u308c\u304c(\u534a)\u6b63\u5b9a\u5024\u6027\u3068\u3001\u518d\u751f\u6027\u3068\u547c\u3070\u308c\u308b\u6027\u8cea\u3002\n\n\u518d\u751f\u6027\n\u5185\u7a4d\u306e\u8a18\u53f7\u3092\u5c11\u3057\u5909\u3048\u307e\u3059\u3002\nA^TB=\\left<A,\\ B\\right>\n\n\u7279\u5fb4\u30d9\u30af\u30c8\u30eb$\u03c6(x)$\u3092\u3001\u9069\u5f53\u306a\u95a2\u6570$f$\u3068\u4efb\u610f\u306e\u5165\u529b$\\cdot$\u3092\u7528\u3044\u3066\u3001\n\u03c6(x)=f(x,\\ \\cdot)\n\n\u3068\u8868\u3059\u6642\u3001\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u306f\u3001\u7279\u5fb4\u30d9\u30af\u30c8\u30eb\u306e\u5185\u7a4d\u3060\u304b\u3089\u3001\n\\begin{eqnarray}\nk(x_i, x_j)&=&\\left<\u03c6(x_i),\\ \u03c6(x_j)\\right>\\\\\n&=&\\left<f(x_i,\\ \\cdot),\\ f(x_j,\\ \\cdot)\\right>\n\\end{eqnarray}\n\n\u95a2\u6570$f$\u304c\u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k$\u3068\u4e00\u81f4\u3059\u308b\u6642\u3001\n\\begin{eqnarray}\nk(x_i, x_j)&=&\\left<k(x_i,\\ \\cdot),\\ k(x_j,\\ \\cdot)\\right>\\tag{3}\\\\\n\\end{eqnarray}\n\n(3)\u3092\u3088\u304f\u898b\u308b\u3068\u3001$g(x)=k(x_i,\\ \\cdot),\\ x=x_j$\u3068\u3057\u3066\u3001\n\\begin{eqnarray}\ng(x)&=&\\left<g(\\cdot),\\ k(x,\\ \\cdot)\\right>\\tag{4}\\\\\n&=&\\left<g(\\cdot),\\ \u03c6(x)\\right>\\tag{5}\n\\end{eqnarray}\n\n\u3053\u306e\u6642\u3001$\u03c6(x)$\u304c\u518d\u751f\u6027\u3092\u6301\u3064\u3068\u8a00\u3044\u3001$\u03c6(x)$\u3092\u518d\u751f\u6838\u3068\u547c\u3073\u307e\u3059\u3002\n\u65b0\u3057\u3044\u95a2\u6570$f'(x,\\ \\cdot)$\u3092\u7528\u610f\u3057\u305f\u6642\u3001\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u3068\u3057\u3066\u5229\u7528\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u306f\u3001\n\u518d\u751f\u6027\u3092\u6301\u3064\u304b\u3069\u3046\u304b\u3067\u5224\u65ad\u3067\u304d\u308b\u3002\n\uff08\u203b \u3053\u3053\u3067\u306f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u2192\u518d\u751f\u6838\u3067\u3042\u308b\u4e8b\u3092\u793a\u3057\u3066\u304a\u308a\u3001\n\u3000\u3000\u9006\u65b9\u5411\u306e\u8a3c\u660e\uff1a\u518d\u751f\u6838\u2192\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u3092\u5272\u611b\u3057\u3066\u3044\u307e\u3059\u3002\uff09\n\n\u6b63\u5b9a\u5024\u6027\n\u4eca\u3001$\u03c6(x)$\u304c\u518d\u751f\u6838\u3067\u3042\u308b\u3068\u3057\u307e\u3059\u3002\n\u30d9\u30af\u30c8\u30eb\u7fa4$\\left(\u03c6(x_1),\\ \u03c6(x_2),...,\\ \u03c6(x_n)\\right)$\u3092\u57fa\u5e95\u3068\u3059\u308b\u7a7a\u9593\u4e2d\u306e\u4efb\u610f\u306e\u70b9$f(\\cdot)$\u306f\u3001\n\\begin{eqnarray}\nf&=&w_1\u03c6(x_1)+w_2\u03c6(x_2)+...+w_n\u03c6(x_n)\\\\\n&=&\\sum_{i=1}^nw_i\\ \u03c6(x_i)\\tag{6}\n\\end{eqnarray}\n\n\u5f93\u3063\u3066\u3001\u4efb\u610f\u306e\u5143$f(\\cdot)$\u3068$g(\\cdot)$\u306e\u5185\u7a4d\u306f\u3001\u518d\u751f\u6027\u3092\u7528\u3044\u3066\u3001\n\\begin{eqnarray}\n\\left<f(\\cdot),g(\\cdot)\\right>\n&=&\\left<\\sum_{i=1}^n\u03b1_i\\ \u03c6(x_i),\n\\sum_{i=1}^n\u03b2_i\\ \u03c6(x_i)\\right>\\\\\n&=&\\left<\\sum_{i=1}^n\u03b1_i\\ k(\\cdot,x_i)\n,\\sum_{i=1}^n\u03b2_i\\ k(\\cdot,x_i)\\right> \\\\\n&=&\\sum_{i=1}^n\\sum_{j=1}^n\u03b1_i\u03b2_j\\left<k(\\cdot,\\ x_i),\\ k(\\cdot,\\ x_j)\\right>\\\\\n&=&\\sum_{i=1}^n\\sum_{j=1}^n\u03b1_i\u03b2_j\\ k(x_i,\\ x_i) \\tag{7}\n\\end{eqnarray}\n\n\u3068\u3053\u308d\u3067\u3001\u5185\u7a4d\u306f$\u22650$\u3092\u3068\u308b\u306e\u3067\u3001(7)\u53f3\u8fba\u306f\u6b63\u3002\n\\sum_{i=1}^n\\sum_{j=1}^n\u03b1_i\u03b2_j\\ k(x_i,\\ x_i)\u22650\\tag{8}\n\n\u30b0\u30e9\u30e0\u884c\u5217$K$\u306e\u8981\u7d20$k(x_i, x_j)$\u304c\u5f0f(8)\u3092\u6e80\u305f\u3059\u6642\u3001\nK=\\left(k(x_i, x_j)\\right)^n_{i, j=1} \n=\\left[\\begin{array}{ccc}\nk(x_1, x_1) & \\ldots & k(x_1, x_n)\\\\\n\\vdots & \\ddots & \\vdots\\\\\nk(x_n, x_1) & \\ldots & k(x_n, x_n)\\\\\n\\end{array}\n\\right]\\tag{9}\n\n$K$\u304c\u534a\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3001\u3068\u8a00\u3044\u307e\u3059\u3002\n\n\u3068\u3044\u3046\u4e8b\u306f\u3001\n\u30001. \u30b0\u30e9\u30e0\u884c\u5217$K$\u304c\u6b63\u5b9a\u5024\u3067\u3042\u308c\u3070\u3001\n\u30002. \u305d\u306e\u8981\u7d20\u306f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k(x_i, x_j)$\u3068\u3057\u3066\u53d6\u308a\u6271\u3048\u3001\n\u30003. \u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k$\u306f\u518d\u751f\u6027\u3092\u6e80\u305f\u3059\u304b\u3089\u8a08\u7b97\u697d\u52dd\u3002\n\u3053\u3046\u3057\u305f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u3092\u6b63\u5b9a\u5024\u30ab\u30fc\u30cd\u30eb\u3068\u547c\u3076\u3002\n\u3055\u3089\u306b\u8a00\u3048\u3070\u3001\n\u30004. \u6b63\u5b9a\u5024\u884c\u5217\u3067\u3042\u308c\u3070\u4e0a\u306e\u30ed\u30b8\u30c3\u30af\u3092\u6e80\u8db3\u3059\u308b\u3068\u3044\u3046\u4e8b\u306f\u3001\n\u30005. \u6b63\u5b9a\u5024\u6027\u3092\u5d29\u3055\u306a\u3044\u7bc4\u56f2\u3067\u884c\u5217$K$\u3092$K'$\u306b\u5909\u63db\u3067\u304d\u308c\u3070\u3001\n\u30006. \u3044\u304f\u3089\u3067\u3082\u65b0\u3057\u3044\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u304c\u4f5c\u308a\u51fa\u305b\u308b\u3002\n\n\u6b63\u5b9a\u5024\u30ab\u30fc\u30cd\u30eb\u306e\u5909\u63db\n\\begin{eqnarray}\nk_{add}&=&k_1(x_i,x_j)+k_2(x_i,x_j)\\\\\nk_{mul}&=&k_1(x_i,x_j)k_2(x_i,x_j)\n\\end{eqnarray}\n\n2\u3064\u306e\u6b63\u5b9a\u5024\u30ab\u30fc\u30cd\u30eb\u306e\u548c$k_{add}$\u3068\u7a4d$k_{mul}$\u3082\u6b63\u5b9a\u5024\u306b\u306a\u308b\u3002\n\u3053\u308c\u3092\u5229\u7528\u3059\u308b\u3068\u3001\n\u4f8b\u3048\u3070\u3001\u4efb\u610f\u6b21\u5143\u306e$x$\u306b\u5bfe\u3057\u3066\u3001$x^Tx$\u306f\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3002\n\u5f93\u3063\u3066\u3001\u5b9a\u6570\u52a0\u7b97\u30fb\u3079\u304d\u4e57\u306e\u5909\u63db\u3092\u52a0\u3048\u305f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\nk(x_i,x_j)=(x_i^Tx_j+c)^p\\tag{10}\n\n\u306f\u3001\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3002(\u591a\u9805\u5f0f\u30ab\u30fc\u30cd\u30eb\u3068\u547c\u3070\u308c\u308b)\n\u524d\u3005\u56de\u306e\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u3001\nset.seed(1)\nN <- 18\nx <- runif(N,-2,2)      # X\u5ea7\u6a19\ne <- rnorm(N, 0, 0.03)  # \u6b63\u898f\u8aa4\u5dee\n\nA <- 0.7  # \u5b9a\u7fa9\u57df\u306e\u771f\u3093\u4e2d\u3060\u3051\u51f8\u306b\u3057\u305f\u3044\ny <- rep(0, N)\n  y[abs(x)<A] <- -0.5*x[abs(x) < A]^2+0.3\n  y <- round(y -0.05*x + e, 3)\n\n\n$p=5$\u3068\u3057\u3066\u3001\np <- 5\nB <- 1\n# K\u3092\u6c42\u3081\u308b\nK <- matrix(0, N, N)\nfor(i in 1:N)\n  for(j in 1:N)\n    K[i, j] <- (abs(x[i]*x[j])+B)^p\n\n# \u6b63\u898f\u5316\u9805\nlambda <- 0.01\nw <- ginv(K+lambda*diag(N)) %*% t(y)\n\n# predict\nx_k <- seq(-2, 2, length=200)\ny_k <- rep(0, length=200)\nfor(k in 1:200)\n  for(i in 1:N)\n    y_k[k] <- y_k[k]+w[i]*(abs(x[i]*x_k[k])+B)^p\n\n\u3042\u3068\u306ffor\u6587\u3067\u304a\u7d75\u63cf\u304d\u3002\n\u03bb\u56fa\u5b9a\n\nB\u56fa\u5b9a\n\n\u627f\u524d\n\u30fb[\u30ab\u30fc\u30cd\u30eb\u30c8\u30ea\u30c3\u30af](http://qiita.com/kilometer/items/66e6116cc661019ead59)\n\u30fb[R de \u300e\u30ab\u30fc\u30cd\u30eb\u591a\u5909\u91cf\u89e3\u6790\u300f](http://qiita.com/kilometer/items/58376b9a103743329b2f)\n\u30fb[R de \u300e\u30ab\u30fc\u30cd\u30eb\u591a\u5909\u91cf\u89e3\u6790\u300f-2](http://qiita.com/kilometer/items/c12774a1d8974432d6d5#_reference-b7be7d65fb6be7b5f40f)\n\n\u6559\u79d1\u66f8\n[\u300e\u30ab\u30fc\u30cd\u30eb\u591a\u5909\u91cf\u89e3\u6790\u300f](https://www.amazon.co.jp/dp/4000069713)\n[\u300e\u30d1\u30bf\u30fc\u30f3\u8a8d\u8b58\u3068\u6a5f\u68b0\u5b66\u7fd2\u300f](https://www.amazon.co.jp/dp/4621061224)\n\n# \u5fa9\u7fd2\n$\u03c6(x_i)\u03c6(x_j)$\u306e\u5f62\u3067\u66f8\u3051\u308b\u95a2\u6570\u306f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k(x_i,x_j)$\u3068\u3057\u3066\u6271\u3048\u3001\n\u30b0\u30e9\u30e0\u884c\u5217$K$\u3092\u6c42\u3081\u308b\u4e8b\u3067\u3001\u4f8b\u3048\u3070\u7121\u9650\u306e\u7279\u5fb4\u91cf\u3092\u8003\u616e\u3057\u305f\u8fd1\u4f3c\u304c\u7c21\u5358\u306b\u884c\u3048\u305f\u3002\n(\u30ab\u30fc\u30cd\u30eb\u30c8\u30ea\u30c3\u30af)\n\n\u3053\u308c\u3067\u306f\u307e\u3060\u4e0d\u4fbf\u3067\u3059\u3002\n\n[\u524d\u56de](http://qiita.com/kilometer/items/66e6116cc661019ead59)\u306b\u7d39\u4ecb\u3057\u305f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k(x_i,x_j)$\uff1a\u30ac\u30a6\u30b9\u30ab\u30fc\u30cd\u30eb\u3068\u547c\u3070\u308c\u307e\u3059\u3001\u3084\u3001\u305d\u308c\u306b\u5bfe\u5fdc\u3059\u308b$\u03c6(x)$\u306f\u3001\u7a7a\u304b\u3089\u964d\u3063\u3066\u304d\u305f\u3082\u306e\u3067\u3059\u3002\n\n```math\n\\begin{eqnarray}\nk(x_i, x_j)&=&\u03b1\\ \\mathrm{exp}\\left(-\\beta\\ ||x_i-x_j||^2\\right)\\tag{1}\\\\\n\u03c6(x)&=&\\left(A\\ \\mathrm{exp}\\left(-B(x-z)^2\\right)\\mid\\ z\\in\\mathbb{R} \\right) \\tag{2}\\\\\n\\end{eqnarray}\n```\n\n\u3053\u306e\u307e\u307e\u3060\u3068\u3001\u7a7a\u304b\u3089\u964d\u3063\u3066\u304d\u305f\u7279\u5fb4\u91cf\u30d9\u30af\u30c8\u30eb\u306e\u5185\u7a4d\u3092\u6c42\u3081\u305f\u308a\u3001\u7a7a\u304b\u3089\u964d\u3063\u3066\u304d\u305f\u95a2\u6570\u3092\u306a\u3093\u3089\u304b\u306e\u7279\u5fb4\u30d9\u30af\u30c8\u30eb\u306e\u5185\u7a4d\u306b\u5206\u89e3\u3067\u304d\u308b\u304b\u3092\u78ba\u304b\u3081\u306a\u3044\u3068\u3001\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u3068\u3057\u3066\u4f7f\u3048\u306a\u3044\u3002\n\n\u305d\u308c\u306f\u9762\u5012\u3002\n\n\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u304c**\u5fc5\u305a**\u6e80\u305f\u3059(\u304b\u3064\u7c21\u4fbf\u306b\u691c\u8a3c\u53ef\u80fd\u306a)\u6027\u8cea\u304c\u660e\u3089\u304b\u306b\u306a\u308c\u3070\u3001\u7279\u5fb4\u91cf\u304b\u3089\u96e2\u308c\u3066\u3001\u3044\u304d\u306a\u308a\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u304b\u3069\u3046\u304b\u3092\u691c\u8a3c\u3067\u304d\u308b\u3002\n\n\u305d\u308c\u304c(\u534a)**\u6b63\u5b9a\u5024\u6027**\u3068\u3001**\u518d\u751f\u6027**\u3068\u547c\u3070\u308c\u308b\u6027\u8cea\u3002\n\n# \u518d\u751f\u6027\n\n\u5185\u7a4d\u306e\u8a18\u53f7\u3092\u5c11\u3057\u5909\u3048\u307e\u3059\u3002\n\n```math\nA^TB=\\left<A,\\ B\\right>\n```\n\n\u7279\u5fb4\u30d9\u30af\u30c8\u30eb$\u03c6(x)$\u3092\u3001\u9069\u5f53\u306a\u95a2\u6570$f$\u3068\u4efb\u610f\u306e\u5165\u529b$\\cdot$\u3092\u7528\u3044\u3066\u3001\n\n```math\n\u03c6(x)=f(x,\\ \\cdot)\n```\n\n\u3068\u8868\u3059\u6642\u3001\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u306f\u3001\u7279\u5fb4\u30d9\u30af\u30c8\u30eb\u306e\u5185\u7a4d\u3060\u304b\u3089\u3001\n\n```math\n\\begin{eqnarray}\nk(x_i, x_j)&=&\\left<\u03c6(x_i),\\ \u03c6(x_j)\\right>\\\\\n&=&\\left<f(x_i,\\ \\cdot),\\ f(x_j,\\ \\cdot)\\right>\n\\end{eqnarray}\n```\n\n\u95a2\u6570$f$\u304c\u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k$\u3068\u4e00\u81f4\u3059\u308b\u6642\u3001\n\n```math\n\\begin{eqnarray}\nk(x_i, x_j)&=&\\left<k(x_i,\\ \\cdot),\\ k(x_j,\\ \\cdot)\\right>\\tag{3}\\\\\n\\end{eqnarray}\n```\n\n(3)\u3092\u3088\u304f\u898b\u308b\u3068\u3001$g(x)=k(x_i,\\ \\cdot),\\ x=x_j$\u3068\u3057\u3066\u3001\n\n```math\n\\begin{eqnarray}\ng(x)&=&\\left<g(\\cdot),\\ k(x,\\ \\cdot)\\right>\\tag{4}\\\\\n&=&\\left<g(\\cdot),\\ \u03c6(x)\\right>\\tag{5}\n\\end{eqnarray}\n```\n\n\u3053\u306e\u6642\u3001$\u03c6(x)$\u304c**\u518d\u751f\u6027**\u3092\u6301\u3064\u3068\u8a00\u3044\u3001$\u03c6(x)$\u3092**\u518d\u751f\u6838**\u3068\u547c\u3073\u307e\u3059\u3002\n\u65b0\u3057\u3044\u95a2\u6570$f'(x,\\ \\cdot)$\u3092\u7528\u610f\u3057\u305f\u6642\u3001\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u3068\u3057\u3066\u5229\u7528\u3067\u304d\u308b\u304b\u3069\u3046\u304b\u306f\u3001\n\u518d\u751f\u6027\u3092\u6301\u3064\u304b\u3069\u3046\u304b\u3067\u5224\u65ad\u3067\u304d\u308b\u3002\n\n\uff08\u203b \u3053\u3053\u3067\u306f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u2192\u518d\u751f\u6838\u3067\u3042\u308b\u4e8b\u3092\u793a\u3057\u3066\u304a\u308a\u3001\n\u3000\u3000\u9006\u65b9\u5411\u306e\u8a3c\u660e\uff1a\u518d\u751f\u6838\u2192\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u3092\u5272\u611b\u3057\u3066\u3044\u307e\u3059\u3002\uff09\n\n# \u6b63\u5b9a\u5024\u6027\n\n\n\u4eca\u3001$\u03c6(x)$\u304c\u518d\u751f\u6838\u3067\u3042\u308b\u3068\u3057\u307e\u3059\u3002\n\n\u30d9\u30af\u30c8\u30eb\u7fa4$\\left(\u03c6(x_1),\\ \u03c6(x_2),...,\\ \u03c6(x_n)\\right)$\u3092\u57fa\u5e95\u3068\u3059\u308b\u7a7a\u9593\u4e2d\u306e\u4efb\u610f\u306e\u70b9$f(\\cdot)$\u306f\u3001\n\n```math\n\\begin{eqnarray}\nf&=&w_1\u03c6(x_1)+w_2\u03c6(x_2)+...+w_n\u03c6(x_n)\\\\\n&=&\\sum_{i=1}^nw_i\\ \u03c6(x_i)\\tag{6}\n\\end{eqnarray}\n```\n\n\u5f93\u3063\u3066\u3001\u4efb\u610f\u306e\u5143$f(\\cdot)$\u3068$g(\\cdot)$\u306e\u5185\u7a4d\u306f\u3001\u518d\u751f\u6027\u3092\u7528\u3044\u3066\u3001\n\n```math\n\\begin{eqnarray}\n\\left<f(\\cdot),g(\\cdot)\\right>\n&=&\\left<\\sum_{i=1}^n\u03b1_i\\ \u03c6(x_i),\n\\sum_{i=1}^n\u03b2_i\\ \u03c6(x_i)\\right>\\\\\n&=&\\left<\\sum_{i=1}^n\u03b1_i\\ k(\\cdot,x_i)\n,\\sum_{i=1}^n\u03b2_i\\ k(\\cdot,x_i)\\right> \\\\\n&=&\\sum_{i=1}^n\\sum_{j=1}^n\u03b1_i\u03b2_j\\left<k(\\cdot,\\ x_i),\\ k(\\cdot,\\ x_j)\\right>\\\\\n&=&\\sum_{i=1}^n\\sum_{j=1}^n\u03b1_i\u03b2_j\\ k(x_i,\\ x_i) \\tag{7}\n\\end{eqnarray}\n```\n\n\u3068\u3053\u308d\u3067\u3001\u5185\u7a4d\u306f$\u22650$\u3092\u3068\u308b\u306e\u3067\u3001(7)\u53f3\u8fba\u306f\u6b63\u3002\n\n```math\n\\sum_{i=1}^n\\sum_{j=1}^n\u03b1_i\u03b2_j\\ k(x_i,\\ x_i)\u22650\\tag{8}\n```\n\n\u30b0\u30e9\u30e0\u884c\u5217$K$\u306e\u8981\u7d20$k(x_i, x_j)$\u304c\u5f0f(8)\u3092\u6e80\u305f\u3059\u6642\u3001\n\n```math\nK=\\left(k(x_i, x_j)\\right)^n_{i, j=1} \n=\\left[\\begin{array}{ccc}\nk(x_1, x_1) & \\ldots & k(x_1, x_n)\\\\\n\\vdots & \\ddots & \\vdots\\\\\nk(x_n, x_1) & \\ldots & k(x_n, x_n)\\\\\n\\end{array}\n\\right]\\tag{9}\n```\n\n$K$\u304c\u534a**\u6b63\u5b9a\u5024**\u3067\u3042\u308b\u3001\u3068\u8a00\u3044\u307e\u3059\u3002\n\n\n# \u3068\u3044\u3046\u4e8b\u306f\u3001\n\n\u30001. \u30b0\u30e9\u30e0\u884c\u5217$K$\u304c**\u6b63\u5b9a\u5024**\u3067\u3042\u308c\u3070\u3001\n\u30002. \u305d\u306e\u8981\u7d20\u306f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k(x_i, x_j)$\u3068\u3057\u3066\u53d6\u308a\u6271\u3048\u3001\n\u30003. \u30ab\u30fc\u30cd\u30eb\u95a2\u6570$k$\u306f**\u518d\u751f\u6027**\u3092\u6e80\u305f\u3059\u304b\u3089\u8a08\u7b97\u697d\u52dd\u3002\n\n\u3053\u3046\u3057\u305f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\u3092**\u6b63\u5b9a\u5024\u30ab\u30fc\u30cd\u30eb**\u3068\u547c\u3076\u3002\n\u3055\u3089\u306b\u8a00\u3048\u3070\u3001\n\n\u30004. \u6b63\u5b9a\u5024\u884c\u5217\u3067\u3042\u308c\u3070\u4e0a\u306e\u30ed\u30b8\u30c3\u30af\u3092\u6e80\u8db3\u3059\u308b\u3068\u3044\u3046\u4e8b\u306f\u3001\n\u30005. \u6b63\u5b9a\u5024\u6027\u3092\u5d29\u3055\u306a\u3044\u7bc4\u56f2\u3067\u884c\u5217$K$\u3092$K'$\u306b\u5909\u63db\u3067\u304d\u308c\u3070\u3001\n\u30006. \u3044\u304f\u3089\u3067\u3082**\u65b0\u3057\u3044\u30ab\u30fc\u30cd\u30eb\u95a2\u6570**\u304c\u4f5c\u308a\u51fa\u305b\u308b\u3002\n\n# \u6b63\u5b9a\u5024\u30ab\u30fc\u30cd\u30eb\u306e\u5909\u63db\n\n\n```math\n\\begin{eqnarray}\nk_{add}&=&k_1(x_i,x_j)+k_2(x_i,x_j)\\\\\nk_{mul}&=&k_1(x_i,x_j)k_2(x_i,x_j)\n\\end{eqnarray}\n```\n\n2\u3064\u306e\u6b63\u5b9a\u5024\u30ab\u30fc\u30cd\u30eb\u306e\u548c$k_{add}$\u3068\u7a4d$k_{mul}$\u3082\u6b63\u5b9a\u5024\u306b\u306a\u308b\u3002\n\n\u3053\u308c\u3092\u5229\u7528\u3059\u308b\u3068\u3001\n\n\u4f8b\u3048\u3070\u3001\u4efb\u610f\u6b21\u5143\u306e$x$\u306b\u5bfe\u3057\u3066\u3001$x^Tx$\u306f\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3002\n\u5f93\u3063\u3066\u3001\u5b9a\u6570\u52a0\u7b97\u30fb\u3079\u304d\u4e57\u306e\u5909\u63db\u3092\u52a0\u3048\u305f\u30ab\u30fc\u30cd\u30eb\u95a2\u6570\n\n```math\nk(x_i,x_j)=(x_i^Tx_j+c)^p\\tag{10}\n```\n\n\u306f\u3001\u6b63\u5b9a\u5024\u3067\u3042\u308b\u3002(\u591a\u9805\u5f0f\u30ab\u30fc\u30cd\u30eb\u3068\u547c\u3070\u308c\u308b)\n\n[\u524d\u3005\u56de](http://qiita.com/kilometer/items/58376b9a103743329b2f)\u306e\u30b5\u30f3\u30d7\u30eb\u30c7\u30fc\u30bf\u3092\u7528\u3044\u3066\u3001\n\n```R\nset.seed(1)\nN <- 18\nx <- runif(N,-2,2)      # X\u5ea7\u6a19\ne <- rnorm(N, 0, 0.03)  # \u6b63\u898f\u8aa4\u5dee\n\nA <- 0.7  # \u5b9a\u7fa9\u57df\u306e\u771f\u3093\u4e2d\u3060\u3051\u51f8\u306b\u3057\u305f\u3044\ny <- rep(0, N)\n  y[abs(x)<A] <- -0.5*x[abs(x) < A]^2+0.3\n  y <- round(y -0.05*x + e, 3)\n```\n<img width=350 src=https://qiita-image-store.s3.amazonaws.com/0/92401/54540c27-285d-c191-4e00-4de321ac3c11.png>\n\n$p=5$\u3068\u3057\u3066\u3001\n\n```R\np <- 5\nB <- 1\n# K\u3092\u6c42\u3081\u308b\nK <- matrix(0, N, N)\nfor(i in 1:N)\n  for(j in 1:N)\n    K[i, j] <- (abs(x[i]*x[j])+B)^p\n\n# \u6b63\u898f\u5316\u9805\nlambda <- 0.01\nw <- ginv(K+lambda*diag(N)) %*% t(y)\n\n# predict\nx_k <- seq(-2, 2, length=200)\ny_k <- rep(0, length=200)\nfor(k in 1:200)\n  for(i in 1:N)\n    y_k[k] <- y_k[k]+w[i]*(abs(x[i]*x_k[k])+B)^p\n```\n\n\u3042\u3068\u306ffor\u6587\u3067\u304a\u7d75\u63cf\u304d\u3002\n\n\u03bb\u56fa\u5b9a\n<img width=500, src=https://qiita-image-store.s3.amazonaws.com/0/92401/4e12ad88-88e0-5f96-8c7e-d957b937314e.png>\n\nB\u56fa\u5b9a\n<img width=500 src=https://qiita-image-store.s3.amazonaws.com/0/92401/cda48447-6eb3-7456-b20a-03540ea5aa57.png>\n", "tags": ["\u7d71\u8a08\u5b66", "R"]}