{"tags": ["Java", "Scala", "fluentd"], "context": " More than 1 year has passed since last update.\n\n\u306f\u3058\u3081\u306b\nFluentd \u306e in_tail \u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u969b\u306b\u3001\n\u7279\u5225\u306a\u5f62\u5f0f\u3067\u306f\u306a\u3044\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3060\u3068\u6b63\u898f\u8868\u73fe\u3092\u99c6\u4f7f\u3057\u3066\u9811\u5f35\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u304c\nJSON\u5f62\u5f0f\u3067\u30ed\u30b0\u3092\u51fa\u529b\u3057\u3066\u3057\u307e\u3048\u3070\u305d\u3093\u306a\u624b\u9593\u3082\u7121\u304f\u306a\u308a\u307e\u3059\u3002\n\uff08grep\u30d3\u30ea\u30c6\u30a3\u306f\u4f4e\u3044\u3067\u3059\u304c\u30fb\u30fb\u30fb\uff09\n\n\u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5b9a\u7fa9\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u73fe\u6642\u70b9\u3067\u6700\u65b0\u306e\u3082\u306e\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\nMaven\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\n\npom.xml\n<dependencies>\n    <dependency>\n        <groupId>org.slf4j</groupId>\n        <artifactId>slf4j-api</artifactId>\n        <version>1.7.12</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback</groupId>\n        <artifactId>logback-core</artifactId>\n        <version>1.1.3</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback</groupId>\n        <artifactId>logback-classic</artifactId>\n        <version>1.1.3</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback.contrib</groupId>\n        <artifactId>logback-json-core</artifactId>\n        <version>0.1.2</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback.contrib</groupId>\n        <artifactId>logback-json-classic</artifactId>\n        <version>0.1.2</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback.contrib</groupId>\n        <artifactId>logback-jackson</artifactId>\n        <version>0.1.2</version>\n    </dependency>\n    <dependency>\n        <groupId>com.fasterxml.jackson.core</groupId>\n        <artifactId>jackson-core</artifactId>\n        <version>2.5.2</version>\n    </dependency>\n    <dependency>\n        <groupId>com.fasterxml.jackson.core</groupId>\n        <artifactId>jackson-databind</artifactId>\n        <version>2.5.2</version>\n    </dependency>\n    <dependency>\n        <groupId>com.fasterxml.jackson.core</groupId>\n        <artifactId>jackson-annotations</artifactId>\n        <version>2.5.2</version>\n    </dependency>\n</dependencies>\n\n\nSBT\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\n\nbuild.sbt\nlibraryDependencies ++= Seq(\n  \"org.slf4j\" % \"slf4j-api\" % \"1.7.12\",\n  \"ch.qos.logback\" % \"logback-core\" % \"1.1.3\",\n  \"ch.qos.logback\" % \"logback-classic\" % \"1.1.3\",\n  \"ch.qos.logback.contrib\" % \"logback-json-core\" % \"0.1.2\",\n  \"ch.qos.logback.contrib\" % \"logback-json-classic\" % \"0.1.2\",\n  \"ch.qos.logback.contrib\" % \"logback-jackson\" % \"0.1.2\",\n  \"com.fasterxml.jackson.core\" % \"jackson-core\" % \"2.5.2\",\n  \"com.fasterxml.jackson.core\" % \"jackson-databind\" % \"2.5.2\",\n  \"com.fasterxml.jackson.core\" % \"jackson-annotations\" % \"2.5.2\"\n)\n\n\n\n\u88dc\u8db31\nJackson2 \u3092\u4f7f\u3046\u306b\u306f logback-jackson 0.1.2 \u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nlogback-jackson 0.1.1 \u306f Jackson1 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u3002\nJackson1 \u3068 Jackson2 \u306f\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n\u88dc\u8db32\nlogback-json-classic 0.1.2 \u306f org.slf4j.Marker \u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u305f\u3081\n\u51fa\u529b\u3059\u308bJSON\u306b\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\nMDC\u306a\u3069\u306f\u666e\u901a\u306b\u4f7f\u3048\u307e\u3059\u3002\n\n\u88dc\u8db33\njackson-annotations \u306f\u4e0d\u8981\u304b\u3082\u3057\u308c\u307e\u305b\u3093\uff08\u672a\u78ba\u8a8d\uff09\n\nlogback.xml \u306e\u5b9a\u7fa9\n\nlogback.xml\n<property name=\"MONITORING_LOG\" value=\"${LOG_DIR}/monitoring.log\" />\n<appender name=\"FILE_MONITORING\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\">\n    <file>${MONITORING_LOG}</file>\n    <rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\">\n        <fileNamePattern>${MONITORING_LOG}.%d.gz</fileNamePattern>\n        <maxHistory>14</maxHistory>\n    </rollingPolicy>\n    <encoder class=\"ch.qos.logback.core.encoder.LayoutWrappingEncoder\">\n        <layout class=\"ch.qos.logback.contrib.json.classic.JsonLayout\">\n            <jsonFormatter class=\"ch.qos.logback.contrib.jackson.JacksonJsonFormatter\">\n                <!-- <prettyPrint>true</prettyPrint> -->\n            </jsonFormatter>\n            <timestampFormat>yyyy-MM-dd'T'HH:mm:ss.SSSXXX</timestampFormat>\n            <includeContextName>false</includeContextName>\n            <appendLineSeparator>true</appendLineSeparator>\n        </layout>\n        <charset>UTF-8</charset>\n    </encoder>\n</appender>\n\n<root level=\"INFO\">\n    <appender-ref ref=\"FILE_MONITORING\" />\n</root>\n\n\n\n\u88dc\u8db34\n\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u4f7f\u3063\u3066\u3044\u308b XXX \u306f JDK7 \u304b\u3089\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n\n\u88dc\u8db35\n\u7d30\u304b\u3044\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u3092\u898b\u308b\u3068\u5927\u4f53\u5206\u304b\u308b\u306f\u305a\u3067\u3059\u3002\nhttps://github.com/qos-ch/logback-contrib/blob/2161638c59572c33e76220306ac4b6fbbf863776/json/core/src/main/java/ch/qos/logback/contrib/json/JsonLayoutBase.java\nhttps://github.com/qos-ch/logback-contrib/blob/2161638c59572c33e76220306ac4b6fbbf863776/json/classic/src/main/java/ch/qos/logback/contrib/json/classic/JsonLayout.java\nhttps://github.com/qos-ch/logback-contrib/blob/2161638c59572c33e76220306ac4b6fbbf863776/jackson/src/main/java/ch/qos/logback/contrib/jackson/JacksonJsonFormatter.java\n\n\u30ed\u30b0\n\u51fa\u529b\u7d50\u679c\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u6587\u5b57\u5217\u5185\u306e\u6539\u884c\u6587\u5b57\u306a\u3069\u306f \\n \u3067\u51fa\u529b\u3055\u308c\u308b\u305f\u3081\u30011\u3064\u306e\u30ed\u30b0\u30a8\u30f3\u30c8\u30ea\u306b\u3064\u304d1\u884c\u306b\u306a\u308a\u307e\u3059\u3002\n\nmonitoring.log\n{\"timestamp\":\"2015-04-05T14:45:28.481+09:00\",\"level\":\"WARN\",\"thread\":\"pool-1-thread-1-ScalaTest-running-SQSHelperSpec\",\"logger\":\"helpers.aws.sqs.SQSHelperSpec\",\"message\":\"com.amazonaws.AmazonClientException: Unable to load AWS credentials from any provider in the chain\"}\n{\"timestamp\":\"2015-04-05T14:45:31.526+09:00\",\"level\":\"WARN\",\"thread\":\"pool-1-thread-1-ScalaTest-running-SQSHelperSpec\",\"logger\":\"helpers.aws.sqs.SQSHelperSpec\",\"message\":\"com.amazonaws.AmazonClientException: Unable to load AWS credentials from any provider in the chain\"}\n{\"timestamp\":\"2015-04-05T14:45:31.775+09:00\",\"level\":\"WARN\",\"thread\":\"pool-1-thread-1-ScalaTest-running-SQSHelperSpec\",\"logger\":\"helpers.aws.sqs.SQSHelperSpec\",\"message\":\"com.amazonaws.AmazonClientException: Unable to load AWS credentials from any provider in the chain\"}\n{\"timestamp\":\"2015-04-05T14:45:31.864+09:00\",\"level\":\"WARN\",\"thread\":\"pool-1-thread-1-ScalaTest-running-SQSHelperSpec\",\"logger\":\"helpers.aws.sqs.SQSHelperSpec\",\"message\":\"com.amazonaws.AmazonClientException: Unable to load AWS credentials from any provider in the chain\"}\n\n\n# \u306f\u3058\u3081\u306b\nFluentd \u306e in_tail \u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u3080\u969b\u306b\u3001\n\u7279\u5225\u306a\u5f62\u5f0f\u3067\u306f\u306a\u3044\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3060\u3068\u6b63\u898f\u8868\u73fe\u3092\u99c6\u4f7f\u3057\u3066\u9811\u5f35\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u304c\nJSON\u5f62\u5f0f\u3067\u30ed\u30b0\u3092\u51fa\u529b\u3057\u3066\u3057\u307e\u3048\u3070\u305d\u3093\u306a\u624b\u9593\u3082\u7121\u304f\u306a\u308a\u307e\u3059\u3002\n\uff08grep\u30d3\u30ea\u30c6\u30a3\u306f\u4f4e\u3044\u3067\u3059\u304c\u30fb\u30fb\u30fb\uff09\n\n# \u4f9d\u5b58\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5b9a\u7fa9\n\u30d0\u30fc\u30b8\u30e7\u30f3\u306f\u73fe\u6642\u70b9\u3067\u6700\u65b0\u306e\u3082\u306e\u3092\u57cb\u3081\u8fbc\u3093\u3067\u3044\u307e\u3059\u3002\n\nMaven\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\n\n```xml:pom.xml\n<dependencies>\n    <dependency>\n        <groupId>org.slf4j</groupId>\n        <artifactId>slf4j-api</artifactId>\n        <version>1.7.12</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback</groupId>\n        <artifactId>logback-core</artifactId>\n        <version>1.1.3</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback</groupId>\n        <artifactId>logback-classic</artifactId>\n        <version>1.1.3</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback.contrib</groupId>\n        <artifactId>logback-json-core</artifactId>\n        <version>0.1.2</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback.contrib</groupId>\n        <artifactId>logback-json-classic</artifactId>\n        <version>0.1.2</version>\n    </dependency>\n    <dependency>\n        <groupId>ch.qos.logback.contrib</groupId>\n        <artifactId>logback-jackson</artifactId>\n        <version>0.1.2</version>\n    </dependency>\n    <dependency>\n        <groupId>com.fasterxml.jackson.core</groupId>\n        <artifactId>jackson-core</artifactId>\n        <version>2.5.2</version>\n    </dependency>\n    <dependency>\n        <groupId>com.fasterxml.jackson.core</groupId>\n        <artifactId>jackson-databind</artifactId>\n        <version>2.5.2</version>\n    </dependency>\n    <dependency>\n        <groupId>com.fasterxml.jackson.core</groupId>\n        <artifactId>jackson-annotations</artifactId>\n        <version>2.5.2</version>\n    </dependency>\n</dependencies>\n```\n\nSBT\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\n\n```scala:build.sbt\nlibraryDependencies ++= Seq(\n  \"org.slf4j\" % \"slf4j-api\" % \"1.7.12\",\n  \"ch.qos.logback\" % \"logback-core\" % \"1.1.3\",\n  \"ch.qos.logback\" % \"logback-classic\" % \"1.1.3\",\n  \"ch.qos.logback.contrib\" % \"logback-json-core\" % \"0.1.2\",\n  \"ch.qos.logback.contrib\" % \"logback-json-classic\" % \"0.1.2\",\n  \"ch.qos.logback.contrib\" % \"logback-jackson\" % \"0.1.2\",\n  \"com.fasterxml.jackson.core\" % \"jackson-core\" % \"2.5.2\",\n  \"com.fasterxml.jackson.core\" % \"jackson-databind\" % \"2.5.2\",\n  \"com.fasterxml.jackson.core\" % \"jackson-annotations\" % \"2.5.2\"\n)\n```\n\n## \u88dc\u8db31\nJackson2 \u3092\u4f7f\u3046\u306b\u306f logback-jackson 0.1.2 \u3092\u4f7f\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nlogback-jackson 0.1.1 \u306f Jackson1 \u306b\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u3002\nJackson1 \u3068 Jackson2 \u306f\u30cd\u30fc\u30e0\u30b9\u30da\u30fc\u30b9\u304c\u7570\u306a\u308a\u307e\u3059\u3002\n\n## \u88dc\u8db32\nlogback-json-classic 0.1.2 \u306f `org.slf4j.Marker` \u306b\u5bfe\u5fdc\u3057\u3066\u3044\u306a\u3044\u305f\u3081\n\u51fa\u529b\u3059\u308bJSON\u306b\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\nMDC\u306a\u3069\u306f\u666e\u901a\u306b\u4f7f\u3048\u307e\u3059\u3002\n\n## \u88dc\u8db33\njackson-annotations \u306f\u4e0d\u8981\u304b\u3082\u3057\u308c\u307e\u305b\u3093\uff08\u672a\u78ba\u8a8d\uff09\n\n\n# logback.xml \u306e\u5b9a\u7fa9\n\n```xml:logback.xml\n<property name=\"MONITORING_LOG\" value=\"${LOG_DIR}/monitoring.log\" />\n<appender name=\"FILE_MONITORING\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\">\n    <file>${MONITORING_LOG}</file>\n    <rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\">\n        <fileNamePattern>${MONITORING_LOG}.%d.gz</fileNamePattern>\n        <maxHistory>14</maxHistory>\n    </rollingPolicy>\n    <encoder class=\"ch.qos.logback.core.encoder.LayoutWrappingEncoder\">\n        <layout class=\"ch.qos.logback.contrib.json.classic.JsonLayout\">\n            <jsonFormatter class=\"ch.qos.logback.contrib.jackson.JacksonJsonFormatter\">\n                <!-- <prettyPrint>true</prettyPrint> -->\n            </jsonFormatter>\n            <timestampFormat>yyyy-MM-dd'T'HH:mm:ss.SSSXXX</timestampFormat>\n            <includeContextName>false</includeContextName>\n            <appendLineSeparator>true</appendLineSeparator>\n        </layout>\n        <charset>UTF-8</charset>\n    </encoder>\n</appender>\n\n<root level=\"INFO\">\n    <appender-ref ref=\"FILE_MONITORING\" />\n</root>\n```\n\n## \u88dc\u8db34\n\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u4f7f\u3063\u3066\u3044\u308b XXX \u306f JDK7 \u304b\u3089\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n\n## \u88dc\u8db35\n\u7d30\u304b\u3044\u30aa\u30d7\u30b7\u30e7\u30f3\u306b\u3064\u3044\u3066\u306f\u4e0b\u8a18\u3092\u898b\u308b\u3068\u5927\u4f53\u5206\u304b\u308b\u306f\u305a\u3067\u3059\u3002\nhttps://github.com/qos-ch/logback-contrib/blob/2161638c59572c33e76220306ac4b6fbbf863776/json/core/src/main/java/ch/qos/logback/contrib/json/JsonLayoutBase.java\nhttps://github.com/qos-ch/logback-contrib/blob/2161638c59572c33e76220306ac4b6fbbf863776/json/classic/src/main/java/ch/qos/logback/contrib/json/classic/JsonLayout.java\nhttps://github.com/qos-ch/logback-contrib/blob/2161638c59572c33e76220306ac4b6fbbf863776/jackson/src/main/java/ch/qos/logback/contrib/jackson/JacksonJsonFormatter.java\n\n\n# \u30ed\u30b0\n\u51fa\u529b\u7d50\u679c\u306f\u4e0b\u8a18\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\u6587\u5b57\u5217\u5185\u306e\u6539\u884c\u6587\u5b57\u306a\u3069\u306f \\n \u3067\u51fa\u529b\u3055\u308c\u308b\u305f\u3081\u30011\u3064\u306e\u30ed\u30b0\u30a8\u30f3\u30c8\u30ea\u306b\u3064\u304d1\u884c\u306b\u306a\u308a\u307e\u3059\u3002\n\n```json:monitoring.log\n{\"timestamp\":\"2015-04-05T14:45:28.481+09:00\",\"level\":\"WARN\",\"thread\":\"pool-1-thread-1-ScalaTest-running-SQSHelperSpec\",\"logger\":\"helpers.aws.sqs.SQSHelperSpec\",\"message\":\"com.amazonaws.AmazonClientException: Unable to load AWS credentials from any provider in the chain\"}\n{\"timestamp\":\"2015-04-05T14:45:31.526+09:00\",\"level\":\"WARN\",\"thread\":\"pool-1-thread-1-ScalaTest-running-SQSHelperSpec\",\"logger\":\"helpers.aws.sqs.SQSHelperSpec\",\"message\":\"com.amazonaws.AmazonClientException: Unable to load AWS credentials from any provider in the chain\"}\n{\"timestamp\":\"2015-04-05T14:45:31.775+09:00\",\"level\":\"WARN\",\"thread\":\"pool-1-thread-1-ScalaTest-running-SQSHelperSpec\",\"logger\":\"helpers.aws.sqs.SQSHelperSpec\",\"message\":\"com.amazonaws.AmazonClientException: Unable to load AWS credentials from any provider in the chain\"}\n{\"timestamp\":\"2015-04-05T14:45:31.864+09:00\",\"level\":\"WARN\",\"thread\":\"pool-1-thread-1-ScalaTest-running-SQSHelperSpec\",\"logger\":\"helpers.aws.sqs.SQSHelperSpec\",\"message\":\"com.amazonaws.AmazonClientException: Unable to load AWS credentials from any provider in the chain\"}\n```\n"}