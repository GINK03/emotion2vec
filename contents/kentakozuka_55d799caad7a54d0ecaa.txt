{"tags": ["archLinux"], "context": "\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\nhttps://wiki.archlinuxjp.org/\nhttp://lespedeza93.blogspot.jp/2015/08/archlinuxuefi-gpt-lvm2_9.html\nhttp://archlinux-blogger.blogspot.jp/2015/02/arch-linux-os-uefi-gpt-xfs-archlinux.html\nhttp://archlinux-blogger.blogspot.jp/2016/03/arch-linux-x-gnome.html\nhttp://mofoolog.hateblo.jp/entry/archlinux-cinnamon-gdm-setting-1602\nhttp://d.hatena.ne.jp/defiant/20110217/1297931082\nhttps://gist.github.com/jasonwryan/4618490\nhttps://gist.github.com/mattiaslundberg/8620837\nhttps://loganmarchione.com/2014/11/arch-linux-encrypted-lvm-hardware-2/\n<\u6700\u7d42\u52d5\u4f5c\u78ba\u8a8d\u65e5\uff1a2017/01/19>\nUEFI\u30e2\u30fc\u30c9\u304b\u78ba\u8a8d\n# ls /sys/firmware/\napci dmi efi memmap\n\n\u30ad\u30fc\u30dc\u30fc\u30c9\u30ec\u30a4\u30a2\u30a6\u30c8\u3092\u5909\u66f4\n# loadkeys jp106\n\n\u7121\u7ddaLAN\u8a2d\u5b9a\n# ip link show\n# ip link set <interface> up\n# iwlist <interface> scanning | grep ESSID\n# wpa_supplicant -B -i <interface> -c <(wpa_passphrase <ESSID> <password>)\n# dhcpcd\n# ping google.com\n\n\u30c7\u30a3\u30b9\u30af\u3092LUKS\u3067\u6697\u53f7\u5316\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u5fa9\u53f7\u5316\n# cryptsetup luksOpen <disk> <luks-disk-name>\n\n\u30c7\u30a3\u30b9\u30af\u30fblvm\u306e\u4f7f\u7528\u72b6\u6cc1\u3092\u78ba\u8a8d\n# lsblk\n# df -h\n# lvscan\n\n\n\u3010\u4efb\u610f\u3011\u30c7\u30a3\u30b9\u30af\u3092\u30af\u30ea\u30fc\u30f3\n# sgdisk --zap-all /dev/sdX\n\n\nlvm\u3092\u524a\u9664\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\n# lvremove -f <vg-name>\n# pvremove -f <pv-name>\n\n\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\n\u306fESP\uff08ef00\uff09\u306b\u8a2d\u5b9a\n\u306flvm\u7528\uff088e00\uff09\u306b\u8a2d\u5b9a\n# gdisk <disk>\nGPT fdisk (gdisk) version 0.8.6\n\nPartition table scan:\n  MBR: not present\n  BSD: not present\n  APM: not present\n  GPT: not present\n\nCreating new GPT entries.\n\nCommand (? for help): o\nThis option deletes all partitions and creates a new protective MBR.\nProceed? (Y/N): y\n\nCommand (? for help): n\nPartition number :\nFirst sector:\nLast sector: +512M\nHex code or GUID: ef00\n\nCommand (? for help): n\nPartition number:\nFirst sector:\nLast sector: \nHex code or GUID: 8e00\n\nCommand (? for help): w\nFinal checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING\nPARTITIONS!!\n\nDo you want to proceed?: y\nOK; writing new GUID partition table (GPT) to /dev/sda.\nThe operation has completed successfully.\n\n\u3061\u3083\u3093\u3068\u3067\u304d\u305f\u304b\u78ba\u8a8d\n# lsblk\n\n\nLUKS\n# modprobe -a dm-mod dm_crypt\n\n# cryptsetup -v -y -c aes-xts-plain64 -s 512 -h sha512 -i 5000 --use-random luksFormat <disk02>\n# cryptsetup open <disk02> <luks-disk-name>\n\n-v = verbose\n-y = verify password, ask twice, and complain if they don\u2019t match\n-c = specify the cipher used\n-s = specify the key size used\n-h = specify the hash used\n-i = number of milliseconds to spend passphrase processing (if using anything more than sha1, must be great than 1000)\n\u2013use-random = which random number generator to use\nluksFormat = to initialize the partition and set a passphrase\n/dev/sda3 = the partition to encrypt\n\n\u3061\u3083\u3093\u3068\u3067\u304d\u305f\u304b\u78ba\u8a8d\n# lvmdiskscan\n\n\nLVM\nlvm\u3092\u4f5c\u6210\n100%\u306b\u3059\u308b\u306b\u306f\u3000-l 100%FREE\n# pvcreate /dev/mapper/<luks-disk-name>\n# vgcreate <vg-name> /dev/mapper/<luks-disk-name>\n# lvcreate -L 8G <vg-name> -n <lv-swap-name>\n# lvcreate -L 64G <vg-name> -n <lv-root-name>\n\n\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u6210\n\u30b9\u30ef\u30c3\u30d7\u306f\u30aa\u30f3\u306b\u3059\u308b\n# mkfs.vfat -F32 <disk01>\n# mkswap /dev/<vg-name>/<lv-swap-name>\n# swapon /dev/<vg-name>/<lv-swap-name>\n# mkfs.ext4 /dev/<vg-name>/<lv-root-name>\n\n\n\u30de\u30a6\u30f3\u30c8\n# mount /dev/<vg-name>/<lv-root-name> /mnt\n# mkdir -p /mnt/boot/efi\n# mount <disk01> /mnt/boot/efi\n\n\n\u30df\u30e9\u30fc\u306e\u9806\u756a\u3092\u5909\u66f4\n# vi /etc/pacman.d/mirrorlist\n\n##\n## Arch Linux repository mirrorlist\n## Sorted by mirror score from mirror status page\n## Generated on 2015-01-01\n##\n\n## Score: 2.4, Japan\nServer = http://ftp.jaist.ac.jp/pub/Linux/ArchLinux/$repo/os/$arch\n...\n\n\u30d9\u30fc\u30b9\u30b7\u30b9\u30c6\u30e0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# pacstrap /mnt base base-devel\n\nfstab\u306b\u8a18\u8ff0\n# genfstab -U -p /mnt >> /mnt/etc/fstab\n\nchroot\u3059\u308b\n# arch-chroot /mnt /bin/bash\n\n\u30ed\u30b1\u30fc\u30eb\u306e\u8a2d\u5b9a\n# vi /etc/locale.gen\n...\n#en_SG ISO-8859-1  \nen_US.UTF-8 UTF-8\n#en_US ISO-8859-1  \n...\n#ja_JP.EUC-JP EUC-JP  \nja_JP.UTF-8 UTF-8\n#ka_GE.UTF-8 UTF-8 \n...\n\n# locale-gen\n\n# echo LANG=en_US.UTF-8 > /etc/locale.conf\n# export LANG=en_US.UTF-8\n\n\u30ad\u30fc\u30dc\u30fc\u30c9\u30ec\u30a4\u30a2\u30a6\u30c8\u3092\u5909\u66f4\n# loadkeys jp106\n\n# vi /etc/vconsole.conf\nKEYMAP=jp106\n\n\u30af\u30ed\u30c3\u30af\u3092\u8a2d\u5b9a\n# ln -s /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n# hwclock --systohc --utc\n\n\u30db\u30b9\u30c8\u540d\n# echo <hostname> > /etc/hostname\n\n# vi /etc/hosts\n...\n#<ip-address> <hostname .domain.org=\"\"> <hostname>\n127.0.0.1 localhost.localdomain localhost <hostname>\n::1  localhost.localdomain localhost <hostname>\n...\n\n\ninitramfs\ninitramfs\u3092\u4f5c\u6210\n# vi /etc/mkinitcpio.conf\n...\nHOOKS=\"base udev autodetect modconf block encrypt lvm2 filesystems keyboard fsck\"\n...\n\n# mkinitcpio -p linux\n\n\n\u30e6\u30fc\u30b6\u8a2d\u5b9a\n\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n# passwd\n\n\u4e00\u822c\u30e6\u30fc\u30b6\u3092\u8a2d\u5b9a\n# useradd -m -g users -G wheel -s /bin/bash <username>\n# passwd <username>]\n\n\u7121\u7ddaLAN\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\n# pacman -S wireless_tools\n# pacman -S wpa_supplicant\n\n\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u8a2d\u5b9a\n# pacman -S intel-ucode\n\n\n\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\n\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nlvm\u3068luks\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u306fGRUB\u304cdevice mapper\u3092\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nThen, we need to install Grub. Since we are using lvm and luks, we need Grub to support device mapper.\necho \"sys-boot/grub device-mapper\" >> /etc/portage/package.use/grub \nemerge grub\n# pacman -S grub dosfstools efibootmgr\n\n\u4ee5\u4e0b\u3092\u8a18\u8ff0\uff08GRUB_CMDLINE_LINUX\u9805\u76ee\u306f\u65e2\u5b58\u3067\u3059\u304c\u3001GRUB_ENABLE_CRYPTODISK\u9805\u76ee\u306f\u65b0\u3057\u304f\u8a18\u8ff0\u3057\u307e\u3059\u3002\uff09\ncryptdevice\u306f\u901a\u5e38\u306e/dev/sdx\u306a\u3069\u3067\u3082\u8a18\u8ff0\u53ef\u80fd\u3067\u3059\u304c\u3001\u65b0\u3057\u3044\u30c7\u30d0\u30a4\u30b9\u306a\u3069\u3092\u8ffd\u52a0\u3059\u308b\u3068\u9806\u756a\u304c\u5909\u66f4\u3055\u308c\u3001\u8a8d\u8b58\u3057\u306a\u304f\u306a\u308b\u6050\u308c\u304c\u3042\u308a\u307e\u3059\u3002\n# vi /etc/default/grub\n...\nGRUB_CMDLINE_LINUX=\"cryptdevice=/dev/disk/by-uuid/<UUId>:<luks-disk-name>\"\n...\nGRUB_ENABLE_CRYPTODISK=y\n\nGRUB2\u3092ESP\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n# grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=arch_grub --recheck\n\n# mkdir /boot/efi/EFI/boot\n# cp /boot/efi/EFI/arch_grub/grubx64.efi  /boot/efi/EFI/boot/bootx64.efi\n\n# grub-mkconfig -o /boot/grub/grub.cfg\n\n\nchroot\u3092\u629c\u3051\u3066\u3001\u3059\u3079\u3066\u30a2\u30f3\u30de\u30a6\u30f3\u30c8\u3057\u3066\u30ea\u30d6\u30fc\u30c8\n# exit\n# umount -R /mnt\n# reboot\n\n# visudo\n\n...\n## Uncomment to allow members of group wheel to execute any command\n%wheel ALL=(ALL) ALL\n...\n\n\n\u7121\u7ddaLAN\u8a2d\u5b9a\n# ip link show\n# ip link set <interface> up\n# iwlist <interface> scanning | grep ESSID\n# wpa_supplicant -B -i <interface> -c <(wpa_passphrase <ESSID> <password>)\n# dhcpcd\n# ping google.com\n\n\nCLI\u3067\u4f7f\u3046\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# pacman -S vim bash-completion\n\n# timedatectl set-ntp true\n\n# vim /etc/systemd/timesyncd.conf\n...\n[Time]\nNTP=ntp1.jst.mfeed.ad.jp ntp2.jst.mfeed.ad.jp ntp3.jst.mfeed.ad.jp\nFallbackNTP=0.arch.pool.ntp.org 1.arch.pool.ntp.org 2.arch.pool.ntp.org 3.arch.pool.ntp.org\n...\n\n# systemctl -l status systemd-timesyncd\n\n\nX\nX\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066startx\n# pacman -S xorg-server xorg-server-utils xorg-xinit xorg-xclock xterm xorg-twm\n# lspci | grep VGA\n# pacman -S xf86-video-intel\n\n# startx\n\n\nGNOME\n\nGNOME\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u30ea\u30d6\u30fc\u30c8\n# pacman -S gnome gnome-extra\n\n# systemctl enable gdm.service\n\n# reboot\n\n\n\u8272\u3005\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3068\u304f\n# vim /etc/pacman.conf\n\n...\n[archlinuxfr]\nSigLevel = Never\nServer = http://repo.archlinux.fr/$arch\n\n# pacman -Syu\n# pacman -S wget git expac jshon firefox guake gimp inkscape openssh rsync yaourt\n# yaourt -Syu\n\n\n\u65e5\u672c\u8a9e\u8868\u793a\u306e\u305f\u3081\n$ yaourt -S packer\n\n\n\u7de8\u96c6\u3059\u308b\u304b\u805e\u304b\u308c\u305f\u3089No\u3067\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n$ packer -S otf-ipaexfont\n\n# vim /etc/fonts/conf.avail/71-no-embedded-bitmaps.conf\n\n<?xml version=\"1.0\"?>\n<!DOCTYPE fontconfig SYSTEM \"fonts.dtd\">\n<fontconfig>\n  <match target=\"font\">\n    <edit mode=\"assign\" name=\"embeddedbitmap\">\n      <bool>false</bool>\n    </edit>\n    <edit mode=\"assign\" name=\"hintstyle\">\n       <const>hintnone</const>\n    </edit>\n  </match>\n</fontconfig>\n\n# ln -s /etc/fonts/conf.avail/71-no-embedded-bitmaps.conf /etc/fonts/conf.d/71-no-embedded-bitmaps.conf\n\n\nFcitx-Mozc\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n# gsettings set org.gnome.settings-daemon.plugins.keyboard active false\n# pacman -S fcitx fcitx-mozc fcitx-configtool fcitx-im\n\n\n\n\u30ea\u30d6\u30fc\u30c8\n# reboot\n\n$ vim ~/.xprofile\nexport GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport XMODIFIERS=@im=fcitx\nexport DefaultIMModule=fcitx\nsetxkbmap -model jp106 -layout jp\nfcitx-autostart &\n\n# vim /etc/X11/xorg.conf\n\nSection \"InputClass\"\n        Identifier \"evdev keyboard catchall\"\n        MatchIsKeyboard \"on\"\n        MatchDevicePath \"/dev/input/event*\"\n        Driver \"evdev\"\n        Option \"XkbModel\" \"jp106\"\n        Option \"XkbLayout\" \"jp\"\nEndSection\n\ngsettings set org.gnome.settings-daemon.plugins.xsettings overrides \"{'Gtk/IMModule':<'fcitx'>}\"\n\n[Fcitx configuration]\u3092\u8d77\u52d5\n[Imput Method]\u306b[Mozc]\u306e\u307f\u8868\u793a\u3055\u305b\u308b\n[Appearance]\u306e[Status Panel Hide Mode]\u3092[Show]\u306b\u3059\u308b\n[Settings]\u3092\u8d77\u52d5\n[Region & Language]\u3067[Input Method]\u306bJapanese\u3092\u8a2d\u5b9a\u3059\u308b\n\u30ea\u30d6\u30fc\u30c8\n# reboot\n\n\u4ee5\u4e0b\u306e\u30b5\u30a4\u30c8\u3092\u53c2\u8003\u306b\u3057\u307e\u3057\u305f\u3002\nhttps://wiki.archlinuxjp.org/\nhttp://lespedeza93.blogspot.jp/2015/08/archlinuxuefi-gpt-lvm2_9.html\nhttp://archlinux-blogger.blogspot.jp/2015/02/arch-linux-os-uefi-gpt-xfs-archlinux.html\nhttp://archlinux-blogger.blogspot.jp/2016/03/arch-linux-x-gnome.html\nhttp://mofoolog.hateblo.jp/entry/archlinux-cinnamon-gdm-setting-1602\nhttp://d.hatena.ne.jp/defiant/20110217/1297931082\nhttps://gist.github.com/jasonwryan/4618490\nhttps://gist.github.com/mattiaslundberg/8620837\nhttps://loganmarchione.com/2014/11/arch-linux-encrypted-lvm-hardware-2/\n\n\n<\u6700\u7d42\u52d5\u4f5c\u78ba\u8a8d\u65e5\uff1a2017/01/19>\n\n\nUEFI\u30e2\u30fc\u30c9\u304b\u78ba\u8a8d\n\n```\n# ls /sys/firmware/\napci dmi efi memmap\n```\n\n\u30ad\u30fc\u30dc\u30fc\u30c9\u30ec\u30a4\u30a2\u30a6\u30c8\u3092\u5909\u66f4\n\n```\n# loadkeys jp106\n```\n\n\u7121\u7ddaLAN\u8a2d\u5b9a\n\n```\n# ip link show\n# ip link set <interface> up\n# iwlist <interface> scanning | grep ESSID\n# wpa_supplicant -B -i <interface> -c <(wpa_passphrase <ESSID> <password>)\n# dhcpcd\n# ping google.com\n```\n\n\u30c7\u30a3\u30b9\u30af\u3092LUKS\u3067\u6697\u53f7\u5316\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u5fa9\u53f7\u5316\n\n```\n# cryptsetup luksOpen <disk> <luks-disk-name>\n```\n\n\u30c7\u30a3\u30b9\u30af\u30fblvm\u306e\u4f7f\u7528\u72b6\u6cc1\u3092\u78ba\u8a8d\n\n```\n# lsblk\n# df -h\n# lvscan\n```\n\n## \u3010\u4efb\u610f\u3011\u30c7\u30a3\u30b9\u30af\u3092\u30af\u30ea\u30fc\u30f3\n\n```\n# sgdisk --zap-all /dev/sdX\n```\n\n##### lvm\u3092\u524a\u9664\u3059\u308b\u5834\u5408\u306f\u4ee5\u4e0b\n\n```\n# lvremove -f <vg-name>\n# pvremove -f <pv-name>\n```\n\n## \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\n\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\n<disk01>\u306fESP\uff08ef00\uff09\u306b\u8a2d\u5b9a\n<disk02>\u306flvm\u7528\uff088e00\uff09\u306b\u8a2d\u5b9a\n\n```\n# gdisk <disk>\nGPT fdisk (gdisk) version 0.8.6\n\nPartition table scan:\n  MBR: not present\n  BSD: not present\n  APM: not present\n  GPT: not present\n \nCreating new GPT entries.\n \nCommand (? for help): o\nThis option deletes all partitions and creates a new protective MBR.\nProceed? (Y/N): y\n \nCommand (? for help): n\nPartition number :\nFirst sector:\nLast sector: +512M\nHex code or GUID: ef00\n \nCommand (? for help): n\nPartition number:\nFirst sector:\nLast sector: \nHex code or GUID: 8e00\n \nCommand (? for help): w\nFinal checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING\nPARTITIONS!!\n \nDo you want to proceed?: y\nOK; writing new GUID partition table (GPT) to /dev/sda.\nThe operation has completed successfully.\n```\n\u3061\u3083\u3093\u3068\u3067\u304d\u305f\u304b\u78ba\u8a8d\n\n```\n# lsblk\n```\n\n## LUKS\n\n```\n# modprobe -a dm-mod dm_crypt\n\n# cryptsetup -v -y -c aes-xts-plain64 -s 512 -h sha512 -i 5000 --use-random luksFormat <disk02>\n# cryptsetup open <disk02> <luks-disk-name>\n\n-v = verbose\n-y = verify password, ask twice, and complain if they don\u2019t match\n-c = specify the cipher used\n-s = specify the key size used\n-h = specify the hash used\n-i = number of milliseconds to spend passphrase processing (if using anything more than sha1, must be great than 1000)\n\u2013use-random = which random number generator to use\nluksFormat = to initialize the partition and set a passphrase\n/dev/sda3 = the partition to encrypt\n```\n\n\u3061\u3083\u3093\u3068\u3067\u304d\u305f\u304b\u78ba\u8a8d\n\n```\n# lvmdiskscan\n```\n\n## LVM\nlvm\u3092\u4f5c\u6210\n100%\u306b\u3059\u308b\u306b\u306f\u3000-l 100%FREE\n\n```\n# pvcreate /dev/mapper/<luks-disk-name>\n# vgcreate <vg-name> /dev/mapper/<luks-disk-name>\n# lvcreate -L 8G <vg-name> -n <lv-swap-name>\n# lvcreate -L 64G <vg-name> -n <lv-root-name>\n```\n\n## \u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\n\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3092\u4f5c\u6210\n\u30b9\u30ef\u30c3\u30d7\u306f\u30aa\u30f3\u306b\u3059\u308b\n\n```\n# mkfs.vfat -F32 <disk01>\n# mkswap /dev/<vg-name>/<lv-swap-name>\n# swapon /dev/<vg-name>/<lv-swap-name>\n# mkfs.ext4 /dev/<vg-name>/<lv-root-name>\n```\n\n## \u30de\u30a6\u30f3\u30c8\n\n```\n# mount /dev/<vg-name>/<lv-root-name> /mnt\n# mkdir -p /mnt/boot/efi\n# mount <disk01> /mnt/boot/efi\n```\n\n## \u30df\u30e9\u30fc\u306e\u9806\u756a\u3092\u5909\u66f4\n\n```\n# vi /etc/pacman.d/mirrorlist\n\n##\n## Arch Linux repository mirrorlist\n## Sorted by mirror score from mirror status page\n## Generated on 2015-01-01\n##\n \n## Score: 2.4, Japan\nServer = http://ftp.jaist.ac.jp/pub/Linux/ArchLinux/$repo/os/$arch\n...\n```\n\n\u30d9\u30fc\u30b9\u30b7\u30b9\u30c6\u30e0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# pacstrap /mnt base base-devel\n```\n\nfstab\u306b\u8a18\u8ff0\n\n```\n# genfstab -U -p /mnt >> /mnt/etc/fstab\n```\n\nchroot\u3059\u308b\n\n```\n# arch-chroot /mnt /bin/bash\n```\n\n\u30ed\u30b1\u30fc\u30eb\u306e\u8a2d\u5b9a\n\n```\n# vi /etc/locale.gen\n...\n#en_SG ISO-8859-1  \nen_US.UTF-8 UTF-8\n#en_US ISO-8859-1  \n...\n#ja_JP.EUC-JP EUC-JP  \nja_JP.UTF-8 UTF-8\n#ka_GE.UTF-8 UTF-8 \n...\n```\n\n```\n# locale-gen\n```\n\n```\n# echo LANG=en_US.UTF-8 > /etc/locale.conf\n# export LANG=en_US.UTF-8\n```\n\n\u30ad\u30fc\u30dc\u30fc\u30c9\u30ec\u30a4\u30a2\u30a6\u30c8\u3092\u5909\u66f4\n\n```\n# loadkeys jp106\n```\n\n```\n# vi /etc/vconsole.conf\nKEYMAP=jp106\n```\n\n\u30af\u30ed\u30c3\u30af\u3092\u8a2d\u5b9a\n\n```\n# ln -s /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n# hwclock --systohc --utc\n```\n\n\u30db\u30b9\u30c8\u540d\n\n```\n# echo <hostname> > /etc/hostname\n```\n\n\n```\n# vi /etc/hosts\n...\n#<ip-address> <hostname .domain.org=\"\"> <hostname>\n127.0.0.1 localhost.localdomain localhost <hostname>\n::1  localhost.localdomain localhost <hostname>\n...\n```\n\n## initramfs\ninitramfs\u3092\u4f5c\u6210\n\n```\n# vi /etc/mkinitcpio.conf\n...\nHOOKS=\"base udev autodetect modconf block encrypt lvm2 filesystems keyboard fsck\"\n...\n```\n\n\n```\n# mkinitcpio -p linux\n```\n\n## \u30e6\u30fc\u30b6\u8a2d\u5b9a\n\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\n\n```\n# passwd\n```\n\n\u4e00\u822c\u30e6\u30fc\u30b6\u3092\u8a2d\u5b9a\n\n```\n# useradd -m -g users -G wheel -s /bin/bash <username>\n# passwd <username>]\n```\n\n\u7121\u7ddaLAN\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u304a\u304f\n\n```\n# pacman -S wireless_tools\n# pacman -S wpa_supplicant\n```\n\n\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u8a2d\u5b9a\n\n```\n# pacman -S intel-ucode\n```\n\n## \u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\n\u30d6\u30fc\u30c8\u30ed\u30fc\u30c0\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nlvm\u3068luks\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081\u306b\u306fGRUB\u304cdevice mapper\u3092\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\nThen, we need to install Grub. Since we are using lvm and luks, we need Grub to support device mapper.\n\necho \"sys-boot/grub device-mapper\" >> /etc/portage/package.use/grub \nemerge grub\n\n```\n# pacman -S grub dosfstools efibootmgr\n```\n\n\u4ee5\u4e0b\u3092\u8a18\u8ff0\uff08GRUB_CMDLINE_LINUX\u9805\u76ee\u306f\u65e2\u5b58\u3067\u3059\u304c\u3001GRUB_ENABLE_CRYPTODISK\u9805\u76ee\u306f\u65b0\u3057\u304f\u8a18\u8ff0\u3057\u307e\u3059\u3002\uff09\ncryptdevice\u306f\u901a\u5e38\u306e/dev/sdx\u306a\u3069\u3067\u3082\u8a18\u8ff0\u53ef\u80fd\u3067\u3059\u304c\u3001\u65b0\u3057\u3044\u30c7\u30d0\u30a4\u30b9\u306a\u3069\u3092\u8ffd\u52a0\u3059\u308b\u3068\u9806\u756a\u304c\u5909\u66f4\u3055\u308c\u3001\u8a8d\u8b58\u3057\u306a\u304f\u306a\u308b\u6050\u308c\u304c\u3042\u308a\u307e\u3059\u3002\n\n\n```\n# vi /etc/default/grub\n...\nGRUB_CMDLINE_LINUX=\"cryptdevice=/dev/disk/by-uuid/<UUId>:<luks-disk-name>\"\n...\nGRUB_ENABLE_CRYPTODISK=y\n```\n\nGRUB2\u3092ESP\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u307e\u3059\u3002\n\n```\n# grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=arch_grub --recheck\n\n# mkdir /boot/efi/EFI/boot\n# cp /boot/efi/EFI/arch_grub/grubx64.efi  /boot/efi/EFI/boot/bootx64.efi\n\n# grub-mkconfig -o /boot/grub/grub.cfg\n```\n\n##chroot\u3092\u629c\u3051\u3066\u3001\u3059\u3079\u3066\u30a2\u30f3\u30de\u30a6\u30f3\u30c8\u3057\u3066\u30ea\u30d6\u30fc\u30c8\n\n```\n# exit\n# umount -R /mnt\n# reboot\n```\n\n\n```\n# visudo\n \n...\n## Uncomment to allow members of group wheel to execute any command\n%wheel ALL=(ALL) ALL\n...\n```\n\n##### \u7121\u7ddaLAN\u8a2d\u5b9a\n\n```\n# ip link show\n# ip link set <interface> up\n# iwlist <interface> scanning | grep ESSID\n# wpa_supplicant -B -i <interface> -c <(wpa_passphrase <ESSID> <password>)\n# dhcpcd\n# ping google.com\n```\n\n##### CLI\u3067\u4f7f\u3046\u30c4\u30fc\u30eb\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# pacman -S vim bash-completion\n```\n\n\n```\n# timedatectl set-ntp true\n```\n\n\n```\n# vim /etc/systemd/timesyncd.conf\n...\n[Time]\nNTP=ntp1.jst.mfeed.ad.jp ntp2.jst.mfeed.ad.jp ntp3.jst.mfeed.ad.jp\nFallbackNTP=0.arch.pool.ntp.org 1.arch.pool.ntp.org 2.arch.pool.ntp.org 3.arch.pool.ntp.org\n...\n```\n\n```\n# systemctl -l status systemd-timesyncd\n```\n\n## X\nX\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066startx\n\n```\n# pacman -S xorg-server xorg-server-utils xorg-xinit xorg-xclock xterm xorg-twm\n# lspci | grep VGA\n# pacman -S xf86-video-intel\n\n# startx\n```\n\n## GNOME\n##### GNOME\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3066\u30ea\u30d6\u30fc\u30c8\n\n```\n# pacman -S gnome gnome-extra\n\n# systemctl enable gdm.service\n\n# reboot\n```\n\n\n\n\n##### \u8272\u3005\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3068\u304f\n\n```\n# vim /etc/pacman.conf\n \n...\n[archlinuxfr]\nSigLevel = Never\nServer = http://repo.archlinux.fr/$arch\n```\n\n```\n# pacman -Syu\n# pacman -S wget git expac jshon firefox guake gimp inkscape openssh rsync yaourt\n# yaourt -Syu\n```\n\n\n## \u65e5\u672c\u8a9e\u8868\u793a\u306e\u305f\u3081\n\n```\n$ yaourt -S packer\n```\n\n##### \u7de8\u96c6\u3059\u308b\u304b\u805e\u304b\u308c\u305f\u3089No\u3067\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u3002\n\n```\n$ packer -S otf-ipaexfont\n```\n\n```\n# vim /etc/fonts/conf.avail/71-no-embedded-bitmaps.conf\n \n<?xml version=\"1.0\"?>\n<!DOCTYPE fontconfig SYSTEM \"fonts.dtd\">\n<fontconfig>\n  <match target=\"font\">\n    <edit mode=\"assign\" name=\"embeddedbitmap\">\n      <bool>false</bool>\n    </edit>\n    <edit mode=\"assign\" name=\"hintstyle\">\n       <const>hintnone</const>\n    </edit>\n  </match>\n</fontconfig>\n```\n\n```\n# ln -s /etc/fonts/conf.avail/71-no-embedded-bitmaps.conf /etc/fonts/conf.d/71-no-embedded-bitmaps.conf\n```\n\n\n## Fcitx-Mozc\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n\n```\n# gsettings set org.gnome.settings-daemon.plugins.keyboard active false\n# pacman -S fcitx fcitx-mozc fcitx-configtool fcitx-im\n\n```\n\n##### \u30ea\u30d6\u30fc\u30c8\n\n```\n# reboot\n```\n\n```\n$ vim ~/.xprofile\nexport GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport XMODIFIERS=@im=fcitx\nexport DefaultIMModule=fcitx\nsetxkbmap -model jp106 -layout jp\nfcitx-autostart &\n```\n\n```\n# vim /etc/X11/xorg.conf\n\nSection \"InputClass\"\n        Identifier \"evdev keyboard catchall\"\n        MatchIsKeyboard \"on\"\n        MatchDevicePath \"/dev/input/event*\"\n        Driver \"evdev\"\n        Option \"XkbModel\" \"jp106\"\n        Option \"XkbLayout\" \"jp\"\nEndSection\n```\n\n```\ngsettings set org.gnome.settings-daemon.plugins.xsettings overrides \"{'Gtk/IMModule':<'fcitx'>}\"\n```\n\n\n[Fcitx configuration]\u3092\u8d77\u52d5\n[Imput Method]\u306b[Mozc]\u306e\u307f\u8868\u793a\u3055\u305b\u308b\n[Appearance]\u306e[Status Panel Hide Mode]\u3092[Show]\u306b\u3059\u308b\n\n[Settings]\u3092\u8d77\u52d5\n[Region & Language]\u3067[Input Method]\u306bJapanese\u3092\u8a2d\u5b9a\u3059\u308b\n\n\n\n\u30ea\u30d6\u30fc\u30c8\n\n```\n# reboot\n```\n"}