{"context": "\n\n\u6982\u8981\n\u4eca\u66f4\u3060\u304c\u3001Chart.js\u3067doughnut\u3092\u66f8\u3044\u3066\u307f\u305f\u306e\u3067\u3001\u30e1\u30e2\u3002\n\n\u30d0\u30fc\u30b8\u30e7\u30f3\u30fb\u52d5\u4f5c\u78ba\u8a8d\u74b0\u5883\nChart.js: https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.js\n\u52d5\u4f5c\u78ba\u8a8d\u74b0\u5883: mac os x Yosemite, Firefox 47.0\n\ndoughnut\u5b8c\u6210\u56f3\n\n\n\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n\ndoughnut\u306e\u30c7\u30fc\u30bf\u90e8\nvar data = {\n    labels: [\n        \"Red\",\n        \"Blue\",\n        \"Yellow\",\n        \"Green\",\n        \"Orange\",\n        \"Pink\"\n    ],\n    datasets: [\n        {\n            data: [20000, 5000, 10000, 15000, 10000, 20],\n            backgroundColor: [\n                \"#FF6384\",\n                \"#36A2EB\",\n                \"#FFCE56\",\n                \"#339900\",\n                \"#ff6633\",\n                \"#cc0099\"\n            ],\n            hoverBackgroundColor: [\n                \"#FF6384\",\n                \"#36A2EB\",\n                \"#FFCE56\",\n                \"#339900\",\n                \"#ff6633\",\n                \"#cc0099\"\n            ]\n     }]\n};\n\nvar doughnutData = {\n    type: 'doughnut',\n    data: data,\n     options: {\n        legend: {\n            position: \"bottom\",\n            onClick: function(event, legendItem) {}     \n        },\n        tooltips: {\n            enabled: false\n        }\n     }\n};\n\n\n\nafterDatasetsDraw\u3092\u767b\u9332\nChart.plugins.register({\n    afterDatasetsDraw: function(chartInstance, easing) {\n        if (chartInstance.config.type == \"doughnut\") {\n            var ctx = chartInstance.chart.ctx;\n            var sum = 0;\n            chartInstance.data.datasets.forEach(function (dataset, i) {\n                var meta = chartInstance.getDatasetMeta(i);\n                if (!meta.hidden) {\n                    meta.data.forEach(function(element, index) {\n                        ctx.fillStyle = 'white';\n\n                        var fontSize = 16;\n                        var fontStyle = 'normal';\n                        var fontFamily = 'Helvetica Neue';\n                        ctx.font = Chart.helpers.fontString(fontSize, fontStyle, fontFamily);\n\n\n                        var dataString = chartInstance.data.labels[index];\n                        var dataString2 = dataset.data[index];\n\n                        ctx.textAlign = 'center';\n                        ctx.textBaseline = 'middle';\n\n                        var padding = 5;\n                        var position = element.tooltipPosition();\n\n                        ctx.fillText(dataString, position.x, position.y - (fontSize / 2) - padding);\n                        ctx.fillText(dataString2, position.x, position.y - (fontSize / 2) - padding + fontSize);\n\n                        // \u5186\u306e\u4e2d\u5fc3\u306b\u8868\u793a\u3059\u308b\u5408\u8a08\u3092\u96c6\u8a08\u3059\u308b\n                        sum += dataset.data[index];\n                    });\n                }\n            });\n\n            ctx.fillStyle = 'black';\n            var fontSize = 60;\n            var fontStyle = 'normal';\n            var fontFamily = \"Helvetica Neue\";\n            ctx.font = Chart.helpers.fontString(fontSize, fontStyle, fontFamily);\n\n            ctx.textAlign = 'center';\n            ctx.textBaseline = 'middle';\n            ctx.fillText(sum.toString(), 300, 290);\n        }\n    }\n});\n\n\n\n\u30e1\u30e2\u306a\u306e\u3067\u3044\u3058\u3087\u3002\n#\u6982\u8981\n\u4eca\u66f4\u3060\u304c\u3001Chart.js\u3067doughnut\u3092\u66f8\u3044\u3066\u307f\u305f\u306e\u3067\u3001\u30e1\u30e2\u3002\n\n#\u30d0\u30fc\u30b8\u30e7\u30f3\u30fb\u52d5\u4f5c\u78ba\u8a8d\u74b0\u5883\nChart.js: https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.js\n\u52d5\u4f5c\u78ba\u8a8d\u74b0\u5883: mac os x Yosemite, Firefox 47.0\n\n#doughnut\u5b8c\u6210\u56f3\n![doughnut.png](https://qiita-image-store.s3.amazonaws.com/0/98668/443b0854-8163-0a4d-0d77-1ac224d13dbd.png)\n\n#\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\n```json:doughnut\u306e\u30c7\u30fc\u30bf\u90e8\nvar data = {\n    labels: [\n        \"Red\",\n        \"Blue\",\n        \"Yellow\",\n\t\t\"Green\",\n\t\t\"Orange\",\n\t\t\"Pink\"\n    ],\n    datasets: [\n        {\n            data: [20000, 5000, 10000, 15000, 10000, 20],\n            backgroundColor: [\n                \"#FF6384\",\n                \"#36A2EB\",\n                \"#FFCE56\",\n\t\t\t\t\"#339900\",\n\t\t\t\t\"#ff6633\",\n\t\t\t\t\"#cc0099\"\n            ],\n            hoverBackgroundColor: [\n                \"#FF6384\",\n                \"#36A2EB\",\n                \"#FFCE56\",\n\t\t\t\t\"#339900\",\n\t\t\t\t\"#ff6633\",\n\t\t\t\t\"#cc0099\"\n            ]\n     }]\n};\n\nvar doughnutData = {\n    type: 'doughnut',\n    data: data,\n\t options: {\n\t \tlegend: {\n\t\t\tposition: \"bottom\",\n\t\t\tonClick: function(event, legendItem) {} \t\n\t\t},\n\t\ttooltips: {\n\t\t\tenabled: false\n\t\t}\n\t }\n};\n```\n\n```js:afterDatasetsDraw\u3092\u767b\u9332\nChart.plugins.register({\n\tafterDatasetsDraw: function(chartInstance, easing) {\n\t\tif (chartInstance.config.type == \"doughnut\") {\n\t\t\tvar ctx = chartInstance.chart.ctx;\n\t\t\tvar sum = 0;\n\t\t\tchartInstance.data.datasets.forEach(function (dataset, i) {\n\t\t\t\tvar meta = chartInstance.getDatasetMeta(i);\n\t\t\t\tif (!meta.hidden) {\n\t\t\t\t\tmeta.data.forEach(function(element, index) {\n\t\t\t\t\t\tctx.fillStyle = 'white';\n\n\t\t\t\t\t\tvar fontSize = 16;\n\t\t\t\t\t\tvar fontStyle = 'normal';\n\t\t\t\t\t\tvar fontFamily = 'Helvetica Neue';\n\t\t\t\t\t\tctx.font = Chart.helpers.fontString(fontSize, fontStyle, fontFamily);\n\n\n\t\t\t\t\t\tvar dataString = chartInstance.data.labels[index];\n\t\t\t\t\t\tvar dataString2 = dataset.data[index];\n\n\t\t\t\t\t\tctx.textAlign = 'center';\n\t\t\t\t\t\tctx.textBaseline = 'middle';\n\n\t\t\t\t\t\tvar padding = 5;\n\t\t\t\t\t\tvar position = element.tooltipPosition();\n\n\t\t\t\t\t\tctx.fillText(dataString, position.x, position.y - (fontSize / 2) - padding);\n\t\t\t\t\t\tctx.fillText(dataString2, position.x, position.y - (fontSize / 2) - padding + fontSize);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// \u5186\u306e\u4e2d\u5fc3\u306b\u8868\u793a\u3059\u308b\u5408\u8a08\u3092\u96c6\u8a08\u3059\u308b\n\t\t\t\t\t\tsum += dataset.data[index];\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tctx.fillStyle = 'black';\n\t\t\tvar fontSize = 60;\n\t\t\tvar fontStyle = 'normal';\n\t\t\tvar fontFamily = \"Helvetica Neue\";\n\t\t\tctx.font = Chart.helpers.fontString(fontSize, fontStyle, fontFamily);\n\t\t\t\n\t\t\tctx.textAlign = 'center';\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tctx.fillText(sum.toString(), 300, 290);\n\t\t}\n\t}\n});\n\n```\n\n\u30e1\u30e2\u306a\u306e\u3067\u3044\u3058\u3087\u3002\n", "tags": ["JavaScript", "chart.js"]}