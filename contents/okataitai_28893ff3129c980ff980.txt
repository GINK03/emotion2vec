{"tags": ["golang", "goquery", "scraping", "Go", "GitHub"], "context": "Go\u306e\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u7cfb\u30e9\u30a4\u30d6\u30e9\u30ea\u307e\u3068\u3081\u306e\u4e2d\u304b\u3089goquery\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u30bf\u30fc\u30b2\u30c3\u30c8\u306fGithubRanking\u3002\n\u3061\u306a\u307f\u306b\u3001\u305f\u3060\u305f\u3060\u30e9\u30f3\u30ad\u30f3\u30b0\u60c5\u5831\u3092\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306fGithubAPI\u3092\u4f7f\u3048\u3070\u3044\u3051\u307e\u3059\u3002\n\n\u30bf\u30fc\u30b2\u30c3\u30c8\n\nGithub Repositories Ranking\n\u30da\u30fc\u30b8\u30f3\u30b0\u3092\u305f\u3069\u308a\u306a\u304c\u3089\u4e0a\u4f4d1000\u4ef6\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u540d\u3068star\u306e\u6570\u3092\u53d6\u5f97\u3059\u308b\n\n\n\n\u5229\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\n\n\ngoquery\n\n\njQuery\u306b\u8fd1\u3057\u3044\u95a2\u6570\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\u30bb\u30ec\u30af\u30bf\u3082\u4f7f\u3048\u308b\u30b9\u30fc\u30d1\u30fc\u4fbf\u5229\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\n\n\n\n\n\u3044\u3056\u3001\u30b9\u30af\u30ec\u30d4\u30f3\u30b0\uff01\n\ngoquery\u306e\u8ffd\u52a0\n% go get github.com/PuerkitoBio/goquery\n\n\nDOM\u306e\u8abf\u67fb\n\n\u30d6\u30e9\u30a6\u30b6\u306e\u30c7\u30d9\u30ed\u30c3\u30d1\u30fc\u30b3\u30f3\u30bd\u30fc\u30eb\u3068\u304b\u3001Firebug\u3068\u304b\u4f7f\u3063\u3066DOM\u3092\u8abf\u67fb\u3059\u308b\ngoquery\u306fjQuery\u306e\u30bb\u30ec\u30af\u30bf\u304c\u307b\u307c\u4f7f\u3048\u308b\u306e\u3067\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u30bb\u30ec\u30af\u30bf\u306b\u5f53\u3066\u3092\u3064\u3051\u3066js\u66f8\u3044\u3066\u53d6\u5f97\u8981\u7d20\u3092\u78ba\u8a8d\u3057\u3066\u304f\u306e\u304c\u52b9\u7387\u304c\u826f\u3044\n\n\n\u4f8b\uff09\u30b3\u30f3\u30bd\u30fc\u30eb\u306b$(\"a.list-group-item\")\u3092\u5165\u529b\u3057\u3066\u53d6\u5f97\u8981\u7d20\u3092\u898b\u3066\u307f\u308b\n\n\n\n\n\n\u30d7\u30ed\u30b0\u30e9\u30e0\npackage main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"strings\"\n    \"time\"\n\n    \"github.com/PuerkitoBio/goquery\"\n)\n\nconst (\n    targetfqdn = \"github-ranking.com\"\n)\n\nfunc IsRelativePath(url string) bool {\n    if strings.Index(url, \"//\") == 0 {\n        return false\n    } else if strings.Index(url, \"/\") == 0 {\n        return true\n    } else {\n        return false\n    }\n}\n\nfunc GetAbsoluteURLFromRelativePath(scheme string, fqdn string, relativePath string) string {\n    return scheme + \"://\" + fqdn + relativePath\n}\n\nfunc hasNextPageURL(doc *goquery.Document) (string, bool) {\n    nexturl, exists := doc.Find(\"ul > li.next > a\").First().Attr(\"href\")\n    if exists == true && IsRelativePath(nexturl) {\n        return GetAbsoluteURLFromRelativePath(\"https\", targetfqdn, nexturl), true\n    }\n    return nexturl, false\n}\n\nfunc outputRepoAndStar(groupItemSelection *goquery.Selection) {\n    groupItemSelection.Each(func(i int, s *goquery.Selection) {\n        repositorie := s.Find(\"span.name span.hidden-lg\").Text()\n        stars := s.Find(\"span.stargazers_count\").Text()\n        fmt.Printf(\"\u2605 %s : %s\\n\", strings.TrimSpace(stars), strings.TrimSpace(repositorie))\n    })\n}\n\nfunc main() {\n    doc, err := goquery.NewDocument(GetAbsoluteURLFromRelativePath(\"https\", targetfqdn, \"/repositories\"))\n    nexturl, hasNext := \"\", true\n    if err != nil {\n        log.Fatal(err)\n    }\n    for hasNext {\n        outputRepoAndStar(doc.Find(\"a.list-group-item\"))\n        nexturl, hasNext = hasNextPageURL(doc)\n        doc, err = goquery.NewDocument(nexturl)\n        time.Sleep(3000)\n    }\n}\n\n\n\u30dd\u30a4\u30f3\u30c8\n\nfunc NewDocument\n\n\ndoc, err := goquery.NewDocument(GetAbsoluteURLFromRelativePath(\"https\", targetfqdn, \"/repositories\"))\u306e\u3088\u3046\u306b\u5229\u7528\n\u5f15\u6570\u306eURL\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u9001\u4ed8\u3057\u3066\u30ec\u30b9\u30dd\u30f3\u30b9\u53d6\u5f97&DOM\u306e\u30ed\u30fc\u30c9&\u89e3\u6790\u307e\u3067\u3057\u3066\u304f\u308c\u308b\n\n\nfunc (*Selection) Find\n\n\ndoc.Find(\"a.list-group-item\")\u306e\u3088\u3046\u306b\u5f15\u6570\u306b\u30bb\u30ec\u30af\u30bf\u3092\u6307\u5b9a\n\n\nfunc (*Selection) First\n\n\nnexturl, exists := doc.Find(\"ul > li.next > a\").First()\u306e\u3088\u3046\u306bFind\u95a2\u6570\u3067\u6307\u5b9a\u3057\u305f\u30bb\u30ec\u30af\u30bf\u306b\u30d2\u30c3\u30c8\u3059\u308b\u8981\u7d20\u306e\u4e2d\u304b\u3089\uff11\u756a\u76ee\u306e\u8981\u7d20\u3092\u53d6\u5f97\n\n\nfunc (*Selection) Attr\n\n\nnexturl, exists := doc.Find(\"ul > li.next > a\").First().Attr(\"href\")\u306e\u3088\u3046\u306b\u5bfe\u8c61\u8981\u7d20\u306e\u5c5e\u6027\u5024\u3092\u53d6\u5f97\u3059\u308b\n\n\n\u5b9f\u884c\n\nGoSublime\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u306e\u3067Command + 9\u3067Sublime\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u958b\u304f\n\n\nGoSublime\u306e\u5165\u308c\u65b9\u306f10\u5206\u3067\u7d42\u308f\u308bGo\u8a00\u8a9e\u306e\u958b\u767a\u74b0\u5883\u69cb\u7bc9\u3092\u53c2\u7167\n\n\n\u30b3\u30f3\u30bd\u30fc\u30eb\u3067run\n\n\n\n\u7d50\u679c\n1000\u4ef6\u53d6\u5f97\u5b8c\u4e86\n[ `run` | done: 1.188862586s ]\n    \u2605 77733 : bootstrap\n    \u2605 35984 : free-programming-books\n    \u2605 35311 : angular.js\n    \u2605 34715 : node\n    \u2605 34492 : d3\n    \u2605 33394 : jquery\n    \u2605 30484 : Font-Awesome\n    \u2605 28736 : html5-boilerplate\n    \u2605 25849 : awesome\n    \u2605 24954 : rails\n    \u2605 23174 : impress.js\n    \u2605 22520 : meteor\n\n    ......\u7701\u7565......\n\n    \u2605 2763 : generator-angular-ful...\n    \u2605 2762 : JazzHands\n    \u2605 2762 : bottle\n    \u2605 2760 : serf\n    \u2605 2757 : nock\n    \u2605 2755 : scraperjs\n    \u2605 2755 : cool-retro-term\n    \u2605 2750 : passenger\n    \u2605 2748 : heatmap.js\n    \u2605 2747 : peerjs\n\n\n\u53c2\u8003\nhttps://godoc.org/github.com/PuerkitoBio/goquery\n[Go\u306e\u30b9\u30af\u30ec\u30a4\u30d4\u30f3\u30b0\u7cfb\u30e9\u30a4\u30d6\u30e9\u30ea\u307e\u3068\u3081](http://qiita.com/okataitai/items/db6999ea1ab39ec0bd3e)\u306e\u4e2d\u304b\u3089goquery\u3092\u30d4\u30c3\u30af\u30a2\u30c3\u30d7\u3057\u3066\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002\n\u30bf\u30fc\u30b2\u30c3\u30c8\u306f[GithubRanking](https://github-ranking.com)\u3002\n\u3061\u306a\u307f\u306b\u3001\u305f\u3060\u305f\u3060\u30e9\u30f3\u30ad\u30f3\u30b0\u60c5\u5831\u3092\u53d6\u5f97\u3057\u305f\u3044\u5834\u5408\u306f[GithubAPI](https://developer.github.com/v3/search/)\u3092\u4f7f\u3048\u3070\u3044\u3051\u307e\u3059\u3002\n\n# \u30bf\u30fc\u30b2\u30c3\u30c8\n* [Github Repositories Ranking](https://github-ranking.com/repositories)\n* \u30da\u30fc\u30b8\u30f3\u30b0\u3092\u305f\u3069\u308a\u306a\u304c\u3089\u4e0a\u4f4d1000\u4ef6\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u540d\u3068star\u306e\u6570\u3092\u53d6\u5f97\u3059\u308b\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-03 23.38.36.png](https://qiita-image-store.s3.amazonaws.com/0/60915/91799e73-ca8b-f0eb-e568-368ef9bd5fc6.png)\n\n\n# \u5229\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\n* [goquery](https://github.com/PuerkitoBio/goquery)\n\t* [jQuery](http://api.jquery.com/)\u306b\u8fd1\u3057\u3044\u95a2\u6570\u304c\u7528\u610f\u3055\u308c\u3066\u304a\u308a\u3001\u30bb\u30ec\u30af\u30bf\u3082\u4f7f\u3048\u308b\u30b9\u30fc\u30d1\u30fc\u4fbf\u5229\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\n\n# \u3044\u3056\u3001\u30b9\u30af\u30ec\u30d4\u30f3\u30b0\uff01\n## goquery\u306e\u8ffd\u52a0\n```\n% go get github.com/PuerkitoBio/goquery\n```\n\n## DOM\u306e\u8abf\u67fb\n* \u30d6\u30e9\u30a6\u30b6\u306e\u30c7\u30d9\u30ed\u30c3\u30d1\u30fc\u30b3\u30f3\u30bd\u30fc\u30eb\u3068\u304b\u3001Firebug\u3068\u304b\u4f7f\u3063\u3066DOM\u3092\u8abf\u67fb\u3059\u308b\n* goquery\u306fjQuery\u306e\u30bb\u30ec\u30af\u30bf\u304c\u307b\u307c\u4f7f\u3048\u308b\u306e\u3067\u3001\u30b3\u30f3\u30bd\u30fc\u30eb\u3067\u30bb\u30ec\u30af\u30bf\u306b\u5f53\u3066\u3092\u3064\u3051\u3066js\u66f8\u3044\u3066\u53d6\u5f97\u8981\u7d20\u3092\u78ba\u8a8d\u3057\u3066\u304f\u306e\u304c\u52b9\u7387\u304c\u826f\u3044\n * \u4f8b\uff09\u30b3\u30f3\u30bd\u30fc\u30eb\u306b`$(\"a.list-group-item\")`\u3092\u5165\u529b\u3057\u3066\u53d6\u5f97\u8981\u7d20\u3092\u898b\u3066\u307f\u308b\n\n![\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8 2016-03-03 23.59.57.png](https://qiita-image-store.s3.amazonaws.com/0/60915/5af6c5d7-cd6c-0aa7-5803-bc406b43d566.png)\n\n## \u30d7\u30ed\u30b0\u30e9\u30e0\n\n```go\npackage main\n\nimport (\n\t\"fmt\"\n\t\"log\"\n\t\"strings\"\n\t\"time\"\n\n\t\"github.com/PuerkitoBio/goquery\"\n)\n\nconst (\n\ttargetfqdn = \"github-ranking.com\"\n)\n\nfunc IsRelativePath(url string) bool {\n\tif strings.Index(url, \"//\") == 0 {\n\t\treturn false\n\t} else if strings.Index(url, \"/\") == 0 {\n\t\treturn true\n\t} else {\n\t\treturn false\n\t}\n}\n\nfunc GetAbsoluteURLFromRelativePath(scheme string, fqdn string, relativePath string) string {\n\treturn scheme + \"://\" + fqdn + relativePath\n}\n\nfunc hasNextPageURL(doc *goquery.Document) (string, bool) {\n\tnexturl, exists := doc.Find(\"ul > li.next > a\").First().Attr(\"href\")\n\tif exists == true && IsRelativePath(nexturl) {\n\t\treturn GetAbsoluteURLFromRelativePath(\"https\", targetfqdn, nexturl), true\n\t}\n\treturn nexturl, false\n}\n\nfunc outputRepoAndStar(groupItemSelection *goquery.Selection) {\n\tgroupItemSelection.Each(func(i int, s *goquery.Selection) {\n\t\trepositorie := s.Find(\"span.name span.hidden-lg\").Text()\n\t\tstars := s.Find(\"span.stargazers_count\").Text()\n\t\tfmt.Printf(\"\u2605 %s : %s\\n\", strings.TrimSpace(stars), strings.TrimSpace(repositorie))\n\t})\n}\n\nfunc main() {\n\tdoc, err := goquery.NewDocument(GetAbsoluteURLFromRelativePath(\"https\", targetfqdn, \"/repositories\"))\n\tnexturl, hasNext := \"\", true\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\tfor hasNext {\n\t\toutputRepoAndStar(doc.Find(\"a.list-group-item\"))\n\t\tnexturl, hasNext = hasNextPageURL(doc)\n\t\tdoc, err = goquery.NewDocument(nexturl)\n\t\ttime.Sleep(3000)\n\t}\n}\n```\n\n## \u30dd\u30a4\u30f3\u30c8\n### func NewDocument\n* `\tdoc, err := goquery.NewDocument(GetAbsoluteURLFromRelativePath(\"https\", targetfqdn, \"/repositories\"))`\u306e\u3088\u3046\u306b\u5229\u7528\n* \u5f15\u6570\u306eURL\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u9001\u4ed8\u3057\u3066\u30ec\u30b9\u30dd\u30f3\u30b9\u53d6\u5f97&DOM\u306e\u30ed\u30fc\u30c9&\u89e3\u6790\u307e\u3067\u3057\u3066\u304f\u308c\u308b\n\n### func (*Selection) Find\n* `doc.Find(\"a.list-group-item\")`\u306e\u3088\u3046\u306b\u5f15\u6570\u306b\u30bb\u30ec\u30af\u30bf\u3092\u6307\u5b9a\n\n\n### func (*Selection) First\n* `nexturl, exists := doc.Find(\"ul > li.next > a\").First()`\u306e\u3088\u3046\u306bFind\u95a2\u6570\u3067\u6307\u5b9a\u3057\u305f\u30bb\u30ec\u30af\u30bf\u306b\u30d2\u30c3\u30c8\u3059\u308b\u8981\u7d20\u306e\u4e2d\u304b\u3089\uff11\u756a\u76ee\u306e\u8981\u7d20\u3092\u53d6\u5f97\n\n### func (*Selection) Attr\n* `nexturl, exists := doc.Find(\"ul > li.next > a\").First().Attr(\"href\")`\u306e\u3088\u3046\u306b\u5bfe\u8c61\u8981\u7d20\u306e\u5c5e\u6027\u5024\u3092\u53d6\u5f97\u3059\u308b\n\n\n## \u5b9f\u884c\n* GoSublime\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u306e\u3067`Command + 9`\u3067Sublime\u306e\u30b3\u30f3\u30bd\u30fc\u30eb\u3092\u958b\u304f\n\t* GoSublime\u306e\u5165\u308c\u65b9\u306f[10\u5206\u3067\u7d42\u308f\u308bGo\u8a00\u8a9e\u306e\u958b\u767a\u74b0\u5883\u69cb\u7bc9](http://qiita.com/okataitai/items/a6f966d2075d69d21e74)\u3092\u53c2\u7167\n* \u30b3\u30f3\u30bd\u30fc\u30eb\u3067`run`\n\n### \u7d50\u679c\n1000\u4ef6\u53d6\u5f97\u5b8c\u4e86\n\n```\n[ `run` | done: 1.188862586s ]\n\t\u2605 77733 : bootstrap\n\t\u2605 35984 : free-programming-books\n\t\u2605 35311 : angular.js\n\t\u2605 34715 : node\n\t\u2605 34492 : d3\n\t\u2605 33394 : jquery\n\t\u2605 30484 : Font-Awesome\n\t\u2605 28736 : html5-boilerplate\n\t\u2605 25849 : awesome\n\t\u2605 24954 : rails\n\t\u2605 23174 : impress.js\n\t\u2605 22520 : meteor\n\t\n\t......\u7701\u7565......\n\n\t\u2605 2763 : generator-angular-ful...\n\t\u2605 2762 : JazzHands\n\t\u2605 2762 : bottle\n\t\u2605 2760 : serf\n\t\u2605 2757 : nock\n\t\u2605 2755 : scraperjs\n\t\u2605 2755 : cool-retro-term\n\t\u2605 2750 : passenger\n\t\u2605 2748 : heatmap.js\n\t\u2605 2747 : peerjs\n```\n\n# \u53c2\u8003\nhttps://godoc.org/github.com/PuerkitoBio/goquery\n"}