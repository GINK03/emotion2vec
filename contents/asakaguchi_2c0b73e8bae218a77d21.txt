{"context": "\u304a\u4ed5\u4e8b\u306e\u90fd\u5408\u3067\u3001Excel for Mac 2011\uff08\u6b63\u78ba\u306b\u306f\u3001Visual Basic for Applications\uff09\u304b\u3089 Web API \u3092\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u751f\u3058\u305f\u305f\u3081\u3001\u8abf\u3079\u305f\u3053\u3068\u3092\u5099\u5fd8\u9332\u3068\u3057\u3066\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\nMacScript \u95a2\u6570\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\n\u4e00\u756a\u304a\u624b\u8efd\u306a\u306e\u306f\u3001VBA \u306e MacScript \u95a2\u6570\u3092\u4f7f\u3063\u3066\u3001AppleScript \u7d4c\u7531\u3067 curl \u30b3\u30de\u30f3\u30c9\u3092\u53e9\u304f\u65b9\u6cd5\u3067\u3059\u3002\nFunction getHttp(url As String, query As String) As String\n    Dim command As String\n\n    command = \"do shell script  \"\"curl --get -d '\" & query & \"' \" & url & \"\"\"\"\n    getHttp = MacScript(command)\nEnd Function\n\n\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3092 Visual Basic Editor1 \u3092\u958b\u3044\u3066\u3001\u6a19\u6e96\u30e2\u30fc\u30b8\u30e5\u30fc\u30eb2\u306b\u30b3\u30d4\u30fc\uff06\u30da\u30fc\u30b9\u30c8\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\u4f7f\u7528\u4f8b\u3068\u3057\u3066\u3001OpenWeatherMap \u304b\u3089\u5929\u6c17\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u624b\u9806\u3092\u7d39\u4ecb\u3057\u307e\u3059\u30023\n\n\u30bb\u30eb A1 \u306b\u3001\u5929\u6c17\u3092\u8abf\u3079\u305f\u3044\u90fd\u5e02\u540d\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001Fukuoka,jp \u3068\u5165\u529b\u3057\u307e\u3059\u3002\n\u30bb\u30eb A2 \u306b\u3001Web API \u306e URL http://api.openweathermap.org/data/2.1/forecast/city \u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u30bb\u30eb A3 \u306b\u3001\u30af\u30a8\u30ea\u30fc\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3092\u7d44\u307f\u7acb\u3066\u308b\u5f0f =\"q=\" & A1 \u3092\u5165\u529b\u3057\u307e\u3059\u3002 \n\u30bb\u30eb A4 \u306b\u3001=getHttp(A2, A3) \u3068\u5165\u529b\u3057\u307e\u3059\u3002\n\n\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u3001\u30bb\u30eb A4 \u306b\u798f\u5ca1\u306e\u5929\u6c17\u60c5\u5831\u304c JSON \u5f62\u5f0f\u306e\u6587\u5b57\u5217\u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\u304a\u624b\u8efd\u3067\u306f\u3042\u308b\u3093\u3067\u3059\u304c\u3001\u5c11\u3057\u53cd\u5fdc\u304c\u920d\u3044\u3068\u3044\u3046\u304b\u3001\u306a\u3093\u3068\u306a\u304f\u9045\u3044\u611f\u3058\u304c\u3057\u307e\u3057\u305f\u3002\u308f\u305f\u3057\u306e\u304a\u4ed5\u4e8b\u7684\u306b\u306f\u3001\u3053\u308c\u3067\u5341\u5206\u3060\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u3082\u3063\u3068\u826f\u3044\u624b\u306f\u306a\u3044\u304b\u3068\u8abf\u3079\u3066\u307f\u308b\u3068\u3001Stack Overflow \u3067\u30d9\u30b9\u30c8\u306a\u89e3\u6c7a\u7b56\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\nC \u30e9\u30a4\u30d6\u30e9\u30ea\u306e popen \u95a2\u6570\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\nStack Overflow \u3067\u306e\u8cea\u554f How do I issue an HTTP GET from Excel VBA for Mac 2011  \u306e Franco Rondini \u3055\u3093\u306e\u56de\u7b54\u304c\u305d\u308c\u3067\u3059\u3002\n\u4f7f\u3044\u65b9\u306f\u3001\u5148\u307b\u3069\u7d39\u4ecb\u3057\u305f\u3068\u304a\u308a\u3067\u3059\uff08\u5148\u307b\u3069\u306e\u4f7f\u7528\u4f8b\u306f\u3001\u3053\u3053\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u4f8b\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\uff09\u3002\u305f\u3060\u3057\u3001\u30bb\u30eb A4 \u306b\u6295\u5165\u3059\u308b\u5f0f\u3092 =HTTPGet(A2, A3) \u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\nOption Explicit\n\n' execShell() function courtesy of Robert Knight via StackOverflow\n' http://stackoverflow.com/questions/6136798/vba-shell-function-in-office-2011-for-mac\n\nPrivate Declare Function popen Lib \"libc.dylib\" (ByVal command As String, ByVal mode As String) As Long\nPrivate Declare Function pclose Lib \"libc.dylib\" (ByVal file As Long) As Long\nPrivate Declare Function fread Lib \"libc.dylib\" (ByVal outStr As String, ByVal size As Long, ByVal items As Long, ByVal stream As Long) As Long\nPrivate Declare Function feof Lib \"libc.dylib\" (ByVal file As Long) As Long\n\nFunction execShell(command As String, Optional ByRef exitCode As Long) As String\n    Dim file As Long\n    file = popen(command, \"r\")\n\n    If file = 0 Then\n        Exit Function\n    End If\n\n    While feof(file) = 0\n        Dim chunk As String\n        Dim read As Long\n        chunk = Space(50)\n        read = fread(chunk, 1, Len(chunk) - 1, file)\n        If read > 0 Then\n            chunk = Left$(chunk, read)\n            execShell = execShell & chunk\n        End If\n    Wend\n\n    exitCode = pclose(file)\nEnd Function\n\nFunction HTTPGet(sUrl As String, sQuery As String) As String\n\n    Dim sCmd As String\n    Dim sResult As String\n    Dim lExitCode As Long\n\n    sCmd = \"curl --get -d \"\"\" & sQuery & \"\"\"\" & \" \" & sUrl\n    sResult = execShell(sCmd, lExitCode)\n\n    ' ToDo check lExitCode\n\n    HTTPGet = sResult\n\nEnd Function\n\n\n\u4f59\u8ac7\n\u3053\u308c\u3067\u3001\u3069\u308c\u304f\u3089\u3044\u65e9\u304f\u306a\u3063\u305f\u304b\u3068\u3044\u3046\u3068\u3001\u6c17\u6301\u3061\u65e9\u304f\u306a\u3063\u305f\u3068\u3044\u3046\u611f\u3058\u3067\u3057\u3087\u3046\u304b\u3002\n\u3042\u3068\u3001HTTPGet \u3068\u3044\u3046\u95a2\u6570\u540d\u3068\u304b\u30b3\u30fc\u30c9\u306e\u8a18\u6cd5\u306b\u3044\u307e\u3072\u3068\u3064\u99b4\u67d3\u3081\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u3066\u8a66\u3057\u307e\u3057\u305f\u3002\u307e\u305f\u3001HTTP POST \u306e\u65b9\u3082 postHttp \u3068\u3044\u3046\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u8a66\u3057\u305f\u308a\u3057\u307e\u3057\u305f\u3002\nFunction getHttp(url As String, query As String) As String\n    Dim command As String\n    Dim result As String\n    Dim exitCode As Long\n\n    command = \"curl --get -d \"\"\" & query & \"\"\"\" & \" \" & url\n    result = execShell(command, exitCode)\n\n    ' ToDo check exitCode\n\n    getHttp = result\nEnd Function\n\nFunction postHttp(url As String, query As String) As String\n    Dim command As String\n    Dim result As String\n    Dim exitCode As Long\n\n    command = \"curl -d \"\"\" & query & \"\"\"\" & \" \" & url\n    result = execShell(command, exitCode)\n\n    ' ToDo check exitCode\n\n    postHttp = result\nEnd Function\n\nP.S.\n\u500b\u4eba\u7684\u306b\u306f\u3001\u6700\u521d\u306b\u7d39\u4ecb\u3057\u305f\u304a\u624b\u8efd\u306a\u65b9\u3067\u3001\u5229\u7528\u3059\u308b\u304b\u306a\u30fc\u3068\u3044\u3063\u305f\u611f\u3058\u3067\u3059\u3002\u30d9\u30b9\u30c8\u306a\u89e3\u6c7a\u7b56\u304c\u3042\u308a\u307e\u3057\u305f\u3068\u7d39\u4ecb\u3057\u3066\u304a\u3044\u3066\u30a2\u30ec\u306a\u3093\u3067\u3059\u304c . . . (^^;A\n\n\n\n\nExcel \u306e [\u30c4\u30fc\u30eb] \u30e1\u30cb\u30e5\u30fc\u304b\u3089 [\u30de\u30af\u30ed] -> [Visual Basic Editor] \u3092\u9078\u629e\u3059\u308b\u3068\u3001Visual Basic Editor \u306e\u753b\u9762\u306b\u5207\u308a\u66ff\u308f\u308a\u307e\u3059\u3002\u00a0\u21a9\n\n\n\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u306a\u3051\u308c\u3070\u3001[\u633f\u5165] \u30e1\u30cb\u30e5\u30fc\u304b\u3089 [\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb] \u3092\u9078\u629e\u3059\u308b\u3068\u3001\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\uff08Module1\uff09\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\u00a0\u21a9\n\n\nvia Stack Overflow \u3067\u306e\u8cea\u554f How do I issue an HTTP GET from Excel VBA for Mac 2011  \u306e Franco Rondini \u3055\u3093\u306e\u56de\u7b54\u00a0\u21a9\n\n\n\n\n\u304a\u4ed5\u4e8b\u306e\u90fd\u5408\u3067\u3001Excel for Mac 2011\uff08\u6b63\u78ba\u306b\u306f\u3001Visual Basic for Applications\uff09\u304b\u3089 Web API \u3092\u547c\u3073\u51fa\u3059\u5fc5\u8981\u304c\u751f\u3058\u305f\u305f\u3081\u3001\u8abf\u3079\u305f\u3053\u3068\u3092\u5099\u5fd8\u9332\u3068\u3057\u3066\u6b8b\u3057\u3066\u304a\u304d\u307e\u3059\u3002\n\n## MacScript \u95a2\u6570\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\n\u4e00\u756a\u304a\u624b\u8efd\u306a\u306e\u306f\u3001VBA \u306e MacScript \u95a2\u6570\u3092\u4f7f\u3063\u3066\u3001AppleScript \u7d4c\u7531\u3067 `curl` \u30b3\u30de\u30f3\u30c9\u3092\u53e9\u304f\u65b9\u6cd5\u3067\u3059\u3002\n\n```\nFunction getHttp(url As String, query As String) As String\n    Dim command As String\n    \n    command = \"do shell script  \"\"curl --get -d '\" & query & \"' \" & url & \"\"\"\"\n    getHttp = MacScript(command)\nEnd Function\n```\n\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3092 Visual Basic Editor[^1] \u3092\u958b\u3044\u3066\u3001\u6a19\u6e96\u30e2\u30fc\u30b8\u30e5\u30fc\u30eb[^2]\u306b\u30b3\u30d4\u30fc\uff06\u30da\u30fc\u30b9\u30c8\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n[^1]: Excel \u306e [\u30c4\u30fc\u30eb] \u30e1\u30cb\u30e5\u30fc\u304b\u3089 [\u30de\u30af\u30ed] -> [Visual Basic Editor] \u3092\u9078\u629e\u3059\u308b\u3068\u3001Visual Basic Editor \u306e\u753b\u9762\u306b\u5207\u308a\u66ff\u308f\u308a\u307e\u3059\u3002\n[^2]: \u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u306a\u3051\u308c\u3070\u3001[\u633f\u5165] \u30e1\u30cb\u30e5\u30fc\u304b\u3089 [\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb] \u3092\u9078\u629e\u3059\u308b\u3068\u3001\u6a19\u6e96\u30e2\u30b8\u30e5\u30fc\u30eb\uff08Module1\uff09\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\n\n\u4f7f\u7528\u4f8b\u3068\u3057\u3066\u3001[OpenWeatherMap](http://openweathermap.org) \u304b\u3089\u5929\u6c17\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u624b\u9806\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002[^3]\n\n[^3]: via [Stack Overflow](http://stackoverflow.com/) \u3067\u306e\u8cea\u554f [How do I issue an HTTP GET from Excel VBA for Mac 2011](http://stackoverflow.com/questions/15981960/how-do-i-issue-an-http-get-from-excel-vba-for-mac-2011)  \u306e [Franco Rondini \u3055\u3093\u306e\u56de\u7b54](http://stackoverflow.com/a/15994195)\n\n1. \u30bb\u30eb A1 \u306b\u3001\u5929\u6c17\u3092\u8abf\u3079\u305f\u3044\u90fd\u5e02\u540d\u3092\u5165\u529b\u3057\u307e\u3059\u3002\u4f8b\u3048\u3070\u3001`Fukuoka,jp` \u3068\u5165\u529b\u3057\u307e\u3059\u3002\n2. \u30bb\u30eb A2 \u306b\u3001Web API \u306e URL `http://api.openweathermap.org/data/2.1/forecast/city` \u3092\u5165\u529b\u3057\u307e\u3059\u3002\n3. \u30bb\u30eb A3 \u306b\u3001\u30af\u30a8\u30ea\u30fc\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3092\u7d44\u307f\u7acb\u3066\u308b\u5f0f `=\"q=\" & A1` \u3092\u5165\u529b\u3057\u307e\u3059\u3002 \n4. \u30bb\u30eb A4 \u306b\u3001`=getHttp(A2, A3)` \u3068\u5165\u529b\u3057\u307e\u3059\u3002\n\n\u3057\u3070\u3089\u304f\u3059\u308b\u3068\u3001\u30bb\u30eb A4 \u306b\u798f\u5ca1\u306e\u5929\u6c17\u60c5\u5831\u304c JSON \u5f62\u5f0f\u306e\u6587\u5b57\u5217\u3067\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\n\u304a\u624b\u8efd\u3067\u306f\u3042\u308b\u3093\u3067\u3059\u304c\u3001\u5c11\u3057\u53cd\u5fdc\u304c\u920d\u3044\u3068\u3044\u3046\u304b\u3001\u306a\u3093\u3068\u306a\u304f\u9045\u3044\u611f\u3058\u304c\u3057\u307e\u3057\u305f\u3002\u308f\u305f\u3057\u306e\u304a\u4ed5\u4e8b\u7684\u306b\u306f\u3001\u3053\u308c\u3067\u5341\u5206\u3060\u3063\u305f\u306e\u3067\u3059\u304c\u3001\u3082\u3063\u3068\u826f\u3044\u624b\u306f\u306a\u3044\u304b\u3068\u8abf\u3079\u3066\u307f\u308b\u3068\u3001Stack Overflow \u3067\u30d9\u30b9\u30c8\u306a\u89e3\u6c7a\u7b56\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n## C \u30e9\u30a4\u30d6\u30e9\u30ea\u306e popen \u95a2\u6570\u3092\u5229\u7528\u3059\u308b\u65b9\u6cd5\n[Stack Overflow](http://stackoverflow.com/) \u3067\u306e\u8cea\u554f [How do I issue an HTTP GET from Excel VBA for Mac 2011](http://stackoverflow.com/questions/15981960/how-do-i-issue-an-http-get-from-excel-vba-for-mac-2011)  \u306e [Franco Rondini \u3055\u3093\u306e\u56de\u7b54](http://stackoverflow.com/a/15994195)\u304c\u305d\u308c\u3067\u3059\u3002\n\n\u4f7f\u3044\u65b9\u306f\u3001\u5148\u307b\u3069\u7d39\u4ecb\u3057\u305f\u3068\u304a\u308a\u3067\u3059\uff08\u5148\u307b\u3069\u306e\u4f7f\u7528\u4f8b\u306f\u3001\u3053\u3053\u3067\u7d39\u4ecb\u3055\u308c\u3066\u3044\u305f\u4f8b\u3092\u4f7f\u7528\u3057\u307e\u3057\u305f\uff09\u3002\u305f\u3060\u3057\u3001\u30bb\u30eb A4 \u306b\u6295\u5165\u3059\u308b\u5f0f\u3092 `=HTTPGet(A2, A3)` \u306b\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n```\nOption Explicit\n\n' execShell() function courtesy of Robert Knight via StackOverflow\n' http://stackoverflow.com/questions/6136798/vba-shell-function-in-office-2011-for-mac\n\nPrivate Declare Function popen Lib \"libc.dylib\" (ByVal command As String, ByVal mode As String) As Long\nPrivate Declare Function pclose Lib \"libc.dylib\" (ByVal file As Long) As Long\nPrivate Declare Function fread Lib \"libc.dylib\" (ByVal outStr As String, ByVal size As Long, ByVal items As Long, ByVal stream As Long) As Long\nPrivate Declare Function feof Lib \"libc.dylib\" (ByVal file As Long) As Long\n\nFunction execShell(command As String, Optional ByRef exitCode As Long) As String\n    Dim file As Long\n    file = popen(command, \"r\")\n\n    If file = 0 Then\n        Exit Function\n    End If\n\n    While feof(file) = 0\n        Dim chunk As String\n        Dim read As Long\n        chunk = Space(50)\n        read = fread(chunk, 1, Len(chunk) - 1, file)\n        If read > 0 Then\n            chunk = Left$(chunk, read)\n            execShell = execShell & chunk\n        End If\n    Wend\n\n    exitCode = pclose(file)\nEnd Function\n\nFunction HTTPGet(sUrl As String, sQuery As String) As String\n\n    Dim sCmd As String\n    Dim sResult As String\n    Dim lExitCode As Long\n\n    sCmd = \"curl --get -d \"\"\" & sQuery & \"\"\"\" & \" \" & sUrl\n    sResult = execShell(sCmd, lExitCode)\n\n    ' ToDo check lExitCode\n\n    HTTPGet = sResult\n\nEnd Function\n```\n\n## \u4f59\u8ac7\n\u3053\u308c\u3067\u3001\u3069\u308c\u304f\u3089\u3044\u65e9\u304f\u306a\u3063\u305f\u304b\u3068\u3044\u3046\u3068\u3001\u6c17\u6301\u3061\u65e9\u304f\u306a\u3063\u305f\u3068\u3044\u3046\u611f\u3058\u3067\u3057\u3087\u3046\u304b\u3002\n\n\u3042\u3068\u3001HTTPGet \u3068\u3044\u3046\u95a2\u6570\u540d\u3068\u304b\u30b3\u30fc\u30c9\u306e\u8a18\u6cd5\u306b\u3044\u307e\u3072\u3068\u3064\u99b4\u67d3\u3081\u306a\u304b\u3063\u305f\u306e\u3067\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u66f8\u304d\u63db\u3048\u3066\u8a66\u3057\u307e\u3057\u305f\u3002\u307e\u305f\u3001HTTP POST \u306e\u65b9\u3082 postHttp \u3068\u3044\u3046\u95a2\u6570\u3092\u8ffd\u52a0\u3057\u3066\u8a66\u3057\u305f\u308a\u3057\u307e\u3057\u305f\u3002\n\n\n```\nFunction getHttp(url As String, query As String) As String\n    Dim command As String\n    Dim result As String\n    Dim exitCode As Long\n\n    command = \"curl --get -d \"\"\" & query & \"\"\"\" & \" \" & url\n    result = execShell(command, exitCode)\n\n    ' ToDo check exitCode\n\n    getHttp = result\nEnd Function\n\nFunction postHttp(url As String, query As String) As String\n    Dim command As String\n    Dim result As String\n    Dim exitCode As Long\n\n    command = \"curl -d \"\"\" & query & \"\"\"\" & \" \" & url\n    result = execShell(command, exitCode)\n\n    ' ToDo check exitCode\n\n    postHttp = result\nEnd Function\n```\n\nP.S.\n\u500b\u4eba\u7684\u306b\u306f\u3001\u6700\u521d\u306b\u7d39\u4ecb\u3057\u305f\u304a\u624b\u8efd\u306a\u65b9\u3067\u3001\u5229\u7528\u3059\u308b\u304b\u306a\u30fc\u3068\u3044\u3063\u305f\u611f\u3058\u3067\u3059\u3002\u30d9\u30b9\u30c8\u306a\u89e3\u6c7a\u7b56\u304c\u3042\u308a\u307e\u3057\u305f\u3068\u7d39\u4ecb\u3057\u3066\u304a\u3044\u3066\u30a2\u30ec\u306a\u3093\u3067\u3059\u304c . . . (^^;A\n", "tags": ["VBA", "Excel"]}