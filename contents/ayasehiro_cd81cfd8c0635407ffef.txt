{"context": " More than 1 year has passed since last update.\n\nFlashAir W-03\u306b\u65b0\u3057\u3044Lua\u95a2\u6570\u304c\u8ffd\u52a0\u3055\u308c\u305f\uff01\n\u30002015\u5e7410\u670827\u65e5\u306bFlashAir W-03\u30b7\u30ea\u30fc\u30ba\u306e\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u304c\u30d0\u30fc\u30b8\u30e7\u30f3V3.00.01\u306b\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3055\u308c\u307e\u3057\u305f\u3002\u66f4\u65b0\u5c65\u6b74\u306b\u306f\u7279\u306b\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u304c\u3001W-03\u767a\u58f2\u5f53\u521d\u304b\u3089\u642d\u8f09\u3055\u308c\u305fLua\u30b9\u30af\u30ea\u30d7\u30c8\u74b0\u5883\u306b\u304a\u3044\u3066\u3082\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u304c\u3055\u308c\u3001\u65b0\u3057\u3044\u95a2\u6570\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3057\u305f\u3002\n\u3000\u30d0\u30fc\u30b8\u30e7\u30f3V3.00.01\u30ea\u30ea\u30fc\u30b9\u5f53\u521d\u306fFlashAir Developers\u30b5\u30a4\u30c8\u3067Lua\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u304c\u66f4\u65b0\u3055\u308c\u305a\u3001\u65b0\u3057\u3044\u95a2\u6570\u306e\u4f7f\u3044\u65b9\u306f\u8a66\u884c\u932f\u8aa4\u304c\u6c42\u3081\u3089\u308c\u307e\u3057\u305f\u304c\u300112\u67084\u65e5\u3053\u308d\u3001\u3064\u3044\u306bLua\u95a2\u6570\u30ea\u30d5\u30a1\u30f3\u30ec\u30f3\u30b9\u304c\u66f4\u65b0\u3055\u308c\u3001\u65b0\u3057\u3044\u95a2\u6570\u306e\u4f7f\u3044\u65b9\u304c\u516c\u958b\u3055\u308c\u307e\u3057\u305f\u3002\n\u3000Lua\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\n\u3000Lua\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306e\u66f4\u65b0\u516c\u958b\u4ee5\u524d\u306b\u3001\u65b0\u3057\u3044\u95a2\u6570\u306e\u3072\u3068\u3064\u3067\u3042\u308bsharedmemory\u95a2\u6570\u306b\u3064\u3044\u3066\u306f\u8a66\u884c\u932f\u8aa4\u306e\u672b\u3001\u4f7f\u3044\u65b9\u3092\u89e3\u6790\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\u3000Lua\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089\u5171\u6709\u30e1\u30e2\u30ea\u3092\u5229\u7528\u3059\u308b\n\u3000\u4eca\u56de\u306f\u3001\u65b0\u3057\u3044\u95a2\u6570\u306e\u4e00\u3064\u3067\u3042\u308bfa.spi\u95a2\u6570\u3092\u4f7f\u3063\u3066\u3001FlashAir\u304b\u3089\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2SPI\u3067\u3001Airio RP\u3068I2C\u63a5\u7d9a\u3057\u305fIO\u30a8\u30ad\u30b9\u30d1\u30f3\u30c0MCP23017\u3092\u5236\u5fa1\u3057\u3066\u307f\u307e\u3059\u3002\n\n\u69cb\u6210\n\u3000\u5fc5\u8981\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\nAirio RP \uff08\u30b9\u30a4\u30c3\u30c1\u30b5\u30a4\u30a8\u30f3\u30b9 \u3001\u30de\u30eb\u30c4\u30fc\u30d1\u30fc\u30c4\uff09\nFlashAir W-03 V3.00.01\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u6e08\u307f\u306e\u3082\u306e\nMCP23017 \uff08\u79cb\u6708\u96fb\u5b50\u901a\u5546\uff09\n\u62b5\u6297\uff0810K\u03a9\uff09\uff12\u500b\uff08I2C\u30e9\u30a4\u30f3\u306e\u30d7\u30eb\u30a2\u30c3\u30d7\u7528\uff09\n\u30d6\u30ec\u30c3\u30c9\u30dc\u30fc\u30c9\n\u52d5\u4f5c\u78ba\u8a8d\u7528\u306eLED\u3068\u62b5\u6297\n\n\n\u3000\u4eca\u56de\u3001MCP23017\u306f\u30a2\u30c9\u30ec\u30b9\u8a2d\u5b9a\u30d4\u30f3A0\u301c2\u3092\uff13\u672c\u3068\u3082GND\u306b\u63a5\u7d9a\u3057\u30660x20\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001MCP23017\u306eGPIO\u306e\u52d5\u4f5c\u78ba\u8a8d\u7528\u306bGPIOA\u3068GPIOB\u306e\u4ee3\u8868\u30d4\u30f3\u306bLED\u3092\u63a5\u7d9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u3000I2C\u63a5\u7d9a\u306e\uff12\u672c\u306e\u7dda\uff08SDA\u3001SCL\uff09\u306f\u300110K\u03a9\u62b5\u6297\u3067\u30d7\u30eb\u30a2\u30c3\u30d7\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\nCONFIG\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\u3000FlashAir\u306eSD_WLAN\u30d5\u30a9\u30eb\u30c0\u5185\u306eCONFIG\u30d5\u30a1\u30a4\u30eb\u306b\u3001\u4ee5\u4e0b\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002IFMODE\u306fFlashAir\u306eGPIO\u30e2\u30fc\u30c9\u3092ON\u306b\u3057\u3066\u3044\u307e\u3059\u3002LUA_RUN_SCRIPT\u306fFlashAir\u306e\u96fb\u6e90\u6295\u5165\u5f8c\u3059\u3050\u306b\u6307\u5b9a\u306eLua\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3067\u3059\u3002\nIFMODE=1\nLUA_RUN_SCRIPT=/mcp23017sample.lua\n\n\u3000\u203bSD_WLAN\u30d5\u30a9\u30eb\u30c0\u3068CONFIG\u30d5\u30a1\u30a4\u30eb\u306f\u4e0d\u53ef\u8996\u5c5e\u6027\u30d5\u30a1\u30a4\u30eb\u306a\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\nLua\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\n\u3000FlashAir\u306e\u30eb\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u306b\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\uff08mcp23017sample.lua\uff09\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\u3000\u3053\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001MCP23017\u306eGPIOA\u3068GPIOB\u306e\u54048\u672c\u306eGPIO\u30d4\u30f3\u3092\u4ea4\u4e92\u306b\uff11\u79d2\u305a\u3064HIGH\u3068LOW\u3092\u5207\u308a\u66ff\u3048\u3066\u3044\u307e\u3059\u3002GPIOA\u3068GPIOB\u306eGPIO\u30d4\u30f3\u306bLED\u3092\u63a5\u7d9a\u3059\u308c\u3070\u3001\uff11\u79d2\u305a\u3064\u4ea4\u4e92\u306b\u70b9\u6ec5\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n(2015/12/8\u8ffd\u8a18)fa.spi(\"init\", N)\u306b\u3064\u3044\u3066\n\u3000fa.spi(\"init\", N)\u306eN\u5024\u306b\u3064\u3044\u3066\u3001@Seg_Faul\u3055\u3093\u304c\u89e3\u6790\u3057\u3066\u304f\u308c\u305f\u306e\u3067\u3001\u4ee3\u8868\u7684\u306a\u5024\uff1dSPI\u5468\u6ce2\u6570\u5024\u3067\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\n26400000\uff1d\u7d041Hz\u30fb\u30fb\u30fb\u52d5\u4f5c\u3057\u306a\u3044\n528000\uff1d\u7d0450Hz\u30fb\u30fb\u30fb\u4ee5\u4e0b\u5168\u3066\u52d5\u4f5c\u3057\u305f\n253000\uff1d\u7d04100Hz\n25900\uff1d\u7d041kHz\n3000\uff1d\u7d048.8kHz\n2225\uff1d\u7d0410kHz\n1000\uff1d\u7d0426kHz\uff08default\uff09\n645\uff1d\u7d0420kHz\n245\uff1d\u7d04100kHz\n67\uff1d\u7d04300kHz\n32\uff1d\u7d04500kHz\n12\uff1d\u7d04800kHz\n5\uff1d\u7d041MHz\n1\uff1d\u7d041.2MHz\n\n\nmcp23017sample.lua\n-- FlashAir AirioRP\n-- I2C IO Expander MCP23017\nfunction write_i2c_command(addr,data1, data2)\n    fa.spi(\"cs\",0)\n    fa.spi(\"write\",0x00)  --I2C\u30b3\u30de\u30f3\u30c9\u9001\u4fe1\n    fa.spi(\"write\",0x02)  --2\u30d0\u30a4\u30c8\u6307\u5b9a\n    fa.spi(\"write\",addr)  --I2C\u30c7\u30d0\u30a4\u30b9\u306e\u30a2\u30c9\u30ec\u30b9\uff0b0\n    fa.spi(\"write\",data1)\n    fa.spi(\"write\",data2)\n    fa.spi(\"cs\",1)\nend\n\nfa.spi(\"init\", 1) --Airio RP\u306f1\u301c528000\u306e\u4ee3\u8868\u5024\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\nfa.spi(\"mode\", 2) --Airio RP\u306f2\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\n\nwrite_i2c_command(0x40, 0x00, 0x00) --GPIOA\u3092Output\u306b\u6307\u5b9a\nwrite_i2c_command(0x40, 0x01, 0x00) --GPIOB\u3092Output\u306b\u6307\u5b9a\n\nwhile(1) do\n    write_i2c_command(0x40, 0x12, 0xFF) --GPIOA\u3092\u3059\u3079\u3066HIGH\u306b\u6307\u5b9a\n    sleep(1000)\n    write_i2c_command(0x40, 0x12, 0x00) --GPIOA\u3092\u3059\u3079\u3066LOW\u306b\u6307\u5b9a\n    sleep(1000)\n    write_i2c_command(0x40, 0x13, 0xFF) --GPIOB\u3092\u3059\u3079\u3066HIGH\u306b\u6307\u5b9a\n    sleep(1000)\n    write_i2c_command(0x40, 0x13, 0x00) --GPIOB\u3092\u3059\u3079\u3066LOW\u306b\u6307\u5b9a\n    sleep(1000)\nend\n\n\n\n\u307e\u3068\u3081\n\u3000\u4ee5\u4e0a\u3067\u3001FlashAir\u304b\u3089Airio RP\u4e0a\u306eSPI-I2C\u30d6\u30ea\u30c3\u30b8\uff08CP2120\uff09\u3092\u4f7f\u3063\u3066\u3001\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2SPI\u3067I2C\u30c7\u30d0\u30a4\u30b9\u3067\u3042\u308bMCP23017\u306eGPIO\u30d4\u30f3\u306eHIGH/LOW\u3092\u5236\u5fa1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u3053\u308c\u3067\u3001FlashAir\u306b\u4e00\u6c17\u306b16\u672c\u306eGPIO\u3092\u5897\u8a2d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u3066\u3001\u5fdc\u7528\u306e\u5e45\u304c\u5927\u304d\u304f\u5e83\u304c\u308a\u307e\u3059\u306d\u3002\u307e\u305f\u3001\u540c\u3058\u3088\u3046\u306bIO\u30a8\u30ad\u30b9\u30d1\u30f3\u30c0\u4ee5\u5916\u306eI2C\u30c7\u30d0\u30a4\u30b9\u3082\u5236\u5fa1\u3067\u304d\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n\u53c2\u8003\u8cc7\u6599\n\u3000Airio RP\u306b\u3064\u3044\u3066\n\u3000FlashAir\u30d7\u30ed\u30c8\u30bf\u30a4\u30d4\u30f3\u30b0\u30dc\u30fc\u30c9\u300cAirio RP\u300d\n\u3000MCP23017\u306b\u3064\u3044\u3066\n\u3000MCP23017\u30c7\u30fc\u30bf\u30b7\u30fc\u30c8\n#FlashAir W-03\u306b\u65b0\u3057\u3044Lua\u95a2\u6570\u304c\u8ffd\u52a0\u3055\u308c\u305f\uff01\n\u30002015\u5e7410\u670827\u65e5\u306bFlashAir W-03\u30b7\u30ea\u30fc\u30ba\u306e\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u304c\u30d0\u30fc\u30b8\u30e7\u30f3V3.00.01\u306b\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3055\u308c\u307e\u3057\u305f\u3002\u66f4\u65b0\u5c65\u6b74\u306b\u306f\u7279\u306b\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u304c\u3001W-03\u767a\u58f2\u5f53\u521d\u304b\u3089\u642d\u8f09\u3055\u308c\u305fLua\u30b9\u30af\u30ea\u30d7\u30c8\u74b0\u5883\u306b\u304a\u3044\u3066\u3082\u3001\u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u304c\u3055\u308c\u3001\u65b0\u3057\u3044\u95a2\u6570\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3057\u305f\u3002\n\u3000\u30d0\u30fc\u30b8\u30e7\u30f3V3.00.01\u30ea\u30ea\u30fc\u30b9\u5f53\u521d\u306fFlashAir Developers\u30b5\u30a4\u30c8\u3067Lua\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u304c\u66f4\u65b0\u3055\u308c\u305a\u3001\u65b0\u3057\u3044\u95a2\u6570\u306e\u4f7f\u3044\u65b9\u306f\u8a66\u884c\u932f\u8aa4\u304c\u6c42\u3081\u3089\u308c\u307e\u3057\u305f\u304c\u300112\u67084\u65e5\u3053\u308d\u3001\u3064\u3044\u306bLua\u95a2\u6570\u30ea\u30d5\u30a1\u30f3\u30ec\u30f3\u30b9\u304c\u66f4\u65b0\u3055\u308c\u3001\u65b0\u3057\u3044\u95a2\u6570\u306e\u4f7f\u3044\u65b9\u304c\u516c\u958b\u3055\u308c\u307e\u3057\u305f\u3002\n\n\u3000[Lua\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9](https://flashair-developers.com/ja/documents/api/lua/reference/)\n\n\u3000Lua\u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u306e\u66f4\u65b0\u516c\u958b\u4ee5\u524d\u306b\u3001\u65b0\u3057\u3044\u95a2\u6570\u306e\u3072\u3068\u3064\u3067\u3042\u308bsharedmemory\u95a2\u6570\u306b\u3064\u3044\u3066\u306f\u8a66\u884c\u932f\u8aa4\u306e\u672b\u3001\u4f7f\u3044\u65b9\u3092\u89e3\u6790\u3057\u3066\u3044\u307e\u3057\u305f\u3002\n\n\u3000[Lua\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089\u5171\u6709\u30e1\u30e2\u30ea\u3092\u5229\u7528\u3059\u308b](https://flashair-developers.com/ja/support/forum/#/discussion/64)\n\n\u3000\u4eca\u56de\u306f\u3001\u65b0\u3057\u3044\u95a2\u6570\u306e\u4e00\u3064\u3067\u3042\u308bfa.spi\u95a2\u6570\u3092\u4f7f\u3063\u3066\u3001FlashAir\u304b\u3089\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2SPI\u3067\u3001Airio RP\u3068I2C\u63a5\u7d9a\u3057\u305fIO\u30a8\u30ad\u30b9\u30d1\u30f3\u30c0MCP23017\u3092\u5236\u5fa1\u3057\u3066\u307f\u307e\u3059\u3002\n\n#\u69cb\u6210\n\u3000\u5fc5\u8981\u306a\u3082\u306e\u306f\u4ee5\u4e0b\u306e\u3068\u304a\u308a\u3067\u3059\u3002\n\n- Airio RP \uff08[\u30b9\u30a4\u30c3\u30c1\u30b5\u30a4\u30a8\u30f3\u30b9](https://www.switch-science.com/catalog/2373/) \u3001[\u30de\u30eb\u30c4\u30fc\u30d1\u30fc\u30c4](http://www.marutsu.co.jp/pc/i/557784/)\uff09\n- FlashAir W-03 V3.00.01\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u6e08\u307f\u306e\u3082\u306e\n- MCP23017 \uff08[\u79cb\u6708\u96fb\u5b50\u901a\u5546](http://akizukidenshi.com/catalog/g/gI-09486/)\uff09\n- \u62b5\u6297\uff0810K\u03a9\uff09\uff12\u500b\uff08I2C\u30e9\u30a4\u30f3\u306e\u30d7\u30eb\u30a2\u30c3\u30d7\u7528\uff09\n- \u30d6\u30ec\u30c3\u30c9\u30dc\u30fc\u30c9\n- \u52d5\u4f5c\u78ba\u8a8d\u7528\u306eLED\u3068\u62b5\u6297\n\n![airiorp_mcp23017.jpg](https://qiita-image-store.s3.amazonaws.com/0/89137/f1a899bc-5751-7a67-5ea5-18611a2c8114.jpeg)\n\n\u3000\u4eca\u56de\u3001MCP23017\u306f\u30a2\u30c9\u30ec\u30b9\u8a2d\u5b9a\u30d4\u30f3A0\u301c2\u3092\uff13\u672c\u3068\u3082GND\u306b\u63a5\u7d9a\u3057\u30660x20\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u307e\u305f\u3001MCP23017\u306eGPIO\u306e\u52d5\u4f5c\u78ba\u8a8d\u7528\u306bGPIOA\u3068GPIOB\u306e\u4ee3\u8868\u30d4\u30f3\u306bLED\u3092\u63a5\u7d9a\u3057\u3066\u3044\u307e\u3059\u3002\n\u3000I2C\u63a5\u7d9a\u306e\uff12\u672c\u306e\u7dda\uff08SDA\u3001SCL\uff09\u306f\u300110K\u03a9\u62b5\u6297\u3067\u30d7\u30eb\u30a2\u30c3\u30d7\u3057\u3066\u3042\u308a\u307e\u3059\u3002\n\n#CONFIG\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a\n\u3000FlashAir\u306eSD_WLAN\u30d5\u30a9\u30eb\u30c0\u5185\u306eCONFIG\u30d5\u30a1\u30a4\u30eb\u306b\u3001\u4ee5\u4e0b\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002IFMODE\u306fFlashAir\u306eGPIO\u30e2\u30fc\u30c9\u3092ON\u306b\u3057\u3066\u3044\u307e\u3059\u3002LUA_RUN_SCRIPT\u306fFlashAir\u306e\u96fb\u6e90\u6295\u5165\u5f8c\u3059\u3050\u306b\u6307\u5b9a\u306eLua\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u8d77\u52d5\u3059\u308b\u305f\u3081\u306e\u8a2d\u5b9a\u3067\u3059\u3002\n```IFMODE=1\nLUA_RUN_SCRIPT=/mcp23017sample.lua\n```\n\n\u3000\u203bSD_WLAN\u30d5\u30a9\u30eb\u30c0\u3068CONFIG\u30d5\u30a1\u30a4\u30eb\u306f\u4e0d\u53ef\u8996\u5c5e\u6027\u30d5\u30a1\u30a4\u30eb\u306a\u306e\u3067\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n#Lua\u30b9\u30af\u30ea\u30d7\u30c8\u30d5\u30a1\u30a4\u30eb\n\u3000FlashAir\u306e\u30eb\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u306b\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u8a18\u8ff0\u3057\u305f\u30c6\u30ad\u30b9\u30c8\u30d5\u30a1\u30a4\u30eb\uff08mcp23017sample.lua\uff09\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002\n\u3000\u3053\u306e\u30b3\u30fc\u30c9\u3067\u306f\u3001MCP23017\u306eGPIOA\u3068GPIOB\u306e\u54048\u672c\u306eGPIO\u30d4\u30f3\u3092\u4ea4\u4e92\u306b\uff11\u79d2\u305a\u3064HIGH\u3068LOW\u3092\u5207\u308a\u66ff\u3048\u3066\u3044\u307e\u3059\u3002GPIOA\u3068GPIOB\u306eGPIO\u30d4\u30f3\u306bLED\u3092\u63a5\u7d9a\u3059\u308c\u3070\u3001\uff11\u79d2\u305a\u3064\u4ea4\u4e92\u306b\u70b9\u6ec5\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n\n(2015/12/8\u8ffd\u8a18)fa.spi(\"init\", N)\u306b\u3064\u3044\u3066\n\u3000fa.spi(\"init\", N)\u306eN\u5024\u306b\u3064\u3044\u3066\u3001@Seg_Faul\u3055\u3093\u304c[\u89e3\u6790\u3057\u3066\u304f\u308c\u305f](https://twitter.com/Seg_Faul/status/674197300592312320)\u306e\u3067\u3001\u4ee3\u8868\u7684\u306a\u5024\uff1dSPI\u5468\u6ce2\u6570\u5024\u3067\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u307f\u307e\u3057\u305f\u3002\u7d50\u679c\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3068\u306a\u308a\u307e\u3057\u305f\u3002\n\n- 26400000\uff1d\u7d041Hz\u30fb\u30fb\u30fb\u52d5\u4f5c\u3057\u306a\u3044\n- 528000\uff1d\u7d0450Hz\u30fb\u30fb\u30fb\u4ee5\u4e0b\u5168\u3066\u52d5\u4f5c\u3057\u305f\n- 253000\uff1d\u7d04100Hz\n- 25900\uff1d\u7d041kHz\n- 3000\uff1d\u7d048.8kHz\n- 2225\uff1d\u7d0410kHz\n- 1000\uff1d\u7d0426kHz\uff08default\uff09\n- 645\uff1d\u7d0420kHz\n- 245\uff1d\u7d04100kHz\n- 67\uff1d\u7d04300kHz\n- 32\uff1d\u7d04500kHz\n- 12\uff1d\u7d04800kHz\n- 5\uff1d\u7d041MHz\n- 1\uff1d\u7d041.2MHz\n\n\n```mcp23017sample.lua\n-- FlashAir AirioRP\n-- I2C IO Expander MCP23017\nfunction write_i2c_command(addr,data1, data2)\n\tfa.spi(\"cs\",0)\n\tfa.spi(\"write\",0x00)  --I2C\u30b3\u30de\u30f3\u30c9\u9001\u4fe1\n\tfa.spi(\"write\",0x02)  --2\u30d0\u30a4\u30c8\u6307\u5b9a\n\tfa.spi(\"write\",addr)  --I2C\u30c7\u30d0\u30a4\u30b9\u306e\u30a2\u30c9\u30ec\u30b9\uff0b0\n\tfa.spi(\"write\",data1)\n\tfa.spi(\"write\",data2)\n\tfa.spi(\"cs\",1)\nend\n\nfa.spi(\"init\", 1) --Airio RP\u306f1\u301c528000\u306e\u4ee3\u8868\u5024\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\nfa.spi(\"mode\", 2) --Airio RP\u306f2\u3067\u52d5\u4f5c\u78ba\u8a8d\u6e08\u307f\n\nwrite_i2c_command(0x40, 0x00, 0x00) --GPIOA\u3092Output\u306b\u6307\u5b9a\nwrite_i2c_command(0x40, 0x01, 0x00) --GPIOB\u3092Output\u306b\u6307\u5b9a\n\nwhile(1) do\n\twrite_i2c_command(0x40, 0x12, 0xFF) --GPIOA\u3092\u3059\u3079\u3066HIGH\u306b\u6307\u5b9a\n\tsleep(1000)\n\twrite_i2c_command(0x40, 0x12, 0x00) --GPIOA\u3092\u3059\u3079\u3066LOW\u306b\u6307\u5b9a\n\tsleep(1000)\n\twrite_i2c_command(0x40, 0x13, 0xFF) --GPIOB\u3092\u3059\u3079\u3066HIGH\u306b\u6307\u5b9a\n\tsleep(1000)\n\twrite_i2c_command(0x40, 0x13, 0x00) --GPIOB\u3092\u3059\u3079\u3066LOW\u306b\u6307\u5b9a\n\tsleep(1000)\nend\n```\n\n#\u307e\u3068\u3081\n\u3000\u4ee5\u4e0a\u3067\u3001FlashAir\u304b\u3089Airio RP\u4e0a\u306eSPI-I2C\u30d6\u30ea\u30c3\u30b8\uff08CP2120\uff09\u3092\u4f7f\u3063\u3066\u3001\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2SPI\u3067I2C\u30c7\u30d0\u30a4\u30b9\u3067\u3042\u308bMCP23017\u306eGPIO\u30d4\u30f3\u306eHIGH/LOW\u3092\u5236\u5fa1\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3057\u305f\u3002\u3053\u308c\u3067\u3001FlashAir\u306b\u4e00\u6c17\u306b16\u672c\u306eGPIO\u3092\u5897\u8a2d\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u3066\u3001\u5fdc\u7528\u306e\u5e45\u304c\u5927\u304d\u304f\u5e83\u304c\u308a\u307e\u3059\u306d\u3002\u307e\u305f\u3001\u540c\u3058\u3088\u3046\u306bIO\u30a8\u30ad\u30b9\u30d1\u30f3\u30c0\u4ee5\u5916\u306eI2C\u30c7\u30d0\u30a4\u30b9\u3082\u5236\u5fa1\u3067\u304d\u308b\u306e\u3067\u306f\u306a\u3044\u304b\u3068\u601d\u3044\u307e\u3059\u3002\n\n#\u53c2\u8003\u8cc7\u6599\n\u3000Airio RP\u306b\u3064\u3044\u3066\n\u3000[FlashAir\u30d7\u30ed\u30c8\u30bf\u30a4\u30d4\u30f3\u30b0\u30dc\u30fc\u30c9\u300cAirio RP\u300d](https://flashair-developers.com/ja/documents/resources/airiorp/)\n\n\u3000MCP23017\u306b\u3064\u3044\u3066\n\u3000[MCP23017\u30c7\u30fc\u30bf\u30b7\u30fc\u30c8](http://ww1.microchip.com/downloads/en/DeviceDoc/21952b.pdf)\n", "tags": ["FlashAir", "I2C", "MCP23017", "Lua"]}