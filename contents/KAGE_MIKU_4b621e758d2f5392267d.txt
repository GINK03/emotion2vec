{"context": "\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\uff0c Tomcat \u4e0a\u3067\u7a3c\u50cd\u3057\u3066\u3044\u308b GitBucket \u306e\u66f4\u65b0\u624b\u9806\u306e\u81ea\u5206\u7528\u30e1\u30e2\u3067\u3059\uff0e\u81ea\u5206\u306f 3.12 \u304b\u3089 4.5 \u3078\u306e\u66f4\u65b0\u3092\u884c\u3044\u307e\u3057\u305f\uff0e\n\n\u81ea\u5206\u306e\u74b0\u5883\n\nVersions\n\n\nCentOS 7.2\nTomcat 7.0.54\nJVM 1.8.0\nGitBucket 3.12\n\n\nDirectories\n\n\nGitBucket\u306e gitbucket.home \u306f /var/lib/gitbucket\n\nTomcat\u306e CATALINA_HOME \u306f /usr/share/tomcat\n\n\n\n\n\u624b\u9806\u5185\u306e${gitbucket.home}\u3068\u304b${CATAILNA_HOME}\u3068\u304b\u306f\u5404\u3005\u306e\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u9069\u5b9c\u5909\u3048\u3066\u304f\u3060\u3055\u3044\uff0e\n\n\u624b\u9806\n\n1. \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n\u3068\u308a\u3042\u3048\u305a\u601d\u8003\u505c\u6b62\u7684\u306b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3059\u308b\u7656\u304c\u306a\u304b\u306a\u304b\u629c\u3051\u307e\u305b\u3093\uff0e\u3053\u306e\u624b\u9806\u306f\u98db\u3070\u3057\u3066\u3082\u3044\u3044\u3067\u3059\uff0e\n$ mkdir -p ~/backup/gitbucket\n$ sudo cp -R ${gitbucket.home}\u3000~/backup/gitbucket/gitbucket-home\n$ sudo cp -R ${CATALINA_HOME}/webapps/gitbucket ~/backup/gitbucket/gitbucket\n$ sudo cp ${CATALINA_HOME}/webapps/gitbucket.war ~/backup/gitbucket/gitbucket.war\n\n\n2. \u65e7GitBucket\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c3.13\u4ee5\u524d\u306e\u5834\u5408\nGitBucket\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c 3.13\u4ee5\u524d \u306e\u72b6\u614b\u304b\u3089 4.x \u306b\u66f4\u65b0\u3057\u3088\u3046\u3068\u3059\u308b\u3068(\u591a\u5206)tomcat\u8d77\u52d5\u6642\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3059\uff0e\n$ sudo cat /var/log/tomcat/localhost.2016-10-29.log\nOct 29, 2016 1:11:34 PM org.apache.catalina.core.StandardContext listenerStart\nSEVERE: Exception sending context initialized event to listener instance of class gitbucket.core.servlet.InitializeListener\njava.lang.Exception: GitBucket can't migrate from this version. Please update to 3.14 at first.\n.\n.\n.\n\n\u305d\u306e\u305f\u3081\uff0c\u307e\u305a\u306f 3.14 \u306b\u66f4\u65b0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\u65e2\u306b3.14\u4ee5\u964d\u306e\u65b9\u306f\u3053\u306e\u7bc0\u306e\u624b\u9806\u306f\u98db\u3070\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n$ cd ${CATALINA_HOME}/webapps\n$ sudo systemctl stop tomcat\n$ sudo rm -rf gitbucket gitbucket.war\n$ sudo wget https://github.com/gitbucket/gitbucket/releases/download/3.14/gitbucket.war\n$ sudo unzip gitbucket.war -d gitbucket\n\n\u5b97\u6559\u4e0a\u306e\u7406\u7531\u3067gitbucket\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea(\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u304b\u683c\u7d0d\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea)\u3092\u5909\u66f4\u3057\u3066\u3044\u308b\u65b9\u306f\u518d\u5ea6\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n$ sudo vim gitbucket/WEB-INF/web.xml\n\n\nweb.xml\n<!-- \u4fee\u6b63\u524d\u306e\u8a2d\u5b9a\u3092\u629c\u7c8b -->\n<!--\n<context-param>\n    <param-name>gitbucket.home</param-name>\n    <param-value>PATH_TO_DATADIR</param-value>\n</context-param>\n-->\n\n<!-- \u4fee\u6b63\u5f8c\u306e\u8a2d\u5b9a\u3092\u629c\u7c8b -->\n<!-- \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u89e3\u9664\u3057\u3066gitbucket.home\u306evalue\u3092\u8a2d\u5b9a -->\n<context-param>\n    <param-name>gitbucket.home</param-name>\n    <param-value>${gitbucket.home}</param-value>\n</context-param>\n\n\n\u3053\u3053\u3067\u4e00\u65e6\u8d77\u52d5\u3057\u3066\u30c6\u30b9\u30c8\uff0e \n\u5fc5\u305a\u4e00\u5ea6\u306ftomcat\u3092\u8d77\u52d5\u3057\u3066gitbucket\u3078\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304f\u3060\u3055\u3044\n$ sudo systemctl start tomcat\n\ngitbucket\u3078\u30a2\u30af\u30bb\u30b9\u3057\u3066\uff0c\u30ed\u30b4\u306e\u90e8\u5206\u304c\u4e0b\u306e\u753b\u50cf\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u305f\u3089 3.14 \u3078\u306e\u66f4\u65b0\u306f\u5b8c\u4e86\u3067\u3059\uff0e\u3042\u3068\u306f\u5ff5\u306e\u305f\u3081repositories\u306e\u78ba\u8a8d\u3068\u304b\uff0e\n\n\u5f8c\u306f\u307b\u307c\u540c\u3058\u624b\u9806\u3067 4.5 \u3078\u66f4\u65b0\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\n\n3. \u65e7GitBucket\u30d0\u30fc\u30b8\u30e7\u30f3\u304c3.14\u4ee5\u964d\u306e\u5834\u5408\n\u6587\u9762\u306f3.13\u4ee5\u524d\u306e\u5834\u5408\u3068\u307b\u307c\u540c\u3058\u3067\u304f\u3069\u3044\u3067\u3059\u3054\u3081\u3093\u306a\u3055\u3044\uff0e\n$ cd ${CATALINA_HOME}/webapps\n$ sudo systemctl stop tomcat\n$ sudo rm -rf gitbucket gitbucket.war\n$ sudo wget https://github.com/gitbucket/gitbucket/releases/download/4.5/gitbucket.war\n$ sudo unzip gitbucket.war -d gitbucket\n\n\u5b97\u6559\u4e0a\u306e\u7406\u7531\u3067gitbucket\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea(\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u304b\u683c\u7d0d\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea)\u3092\u5909\u66f4\u3057\u3066\u3044\u308b\u65b9\u306f\u518d\u5ea6\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n$ sudo vim gitbucket/WEB-INF/web.xml\n\n\nweb.xml\n<!-- \u4fee\u6b63\u524d\u306e\u8a2d\u5b9a\u3092\u629c\u7c8b -->\n<!--\n<context-param>\n    <param-name>gitbucket.home</param-name>\n    <param-value>PATH_TO_DATADIR</param-value>\n</context-param>\n-->\n\n<!-- \u4fee\u6b63\u5f8c\u306e\u8a2d\u5b9a\u3092\u629c\u7c8b -->\n<!-- \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u89e3\u9664\u3057\u3066gitbucket.home\u306evalue\u3092\u8a2d\u5b9a -->\n<context-param>\n    <param-name>gitbucket.home</param-name>\n    <param-value>${gitbucket.home}</param-value>\n</context-param>\n\n\n\u3053\u3053\u3067\u4e00\u65e6\u8d77\u52d5\u3057\u3066\u30c6\u30b9\u30c8\uff0e \n$ sudo systemctl start tomcat\n\ngitbucket\u3078\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3057\u3066\uff0c\u30ed\u30b4\u306e\u90e8\u5206\u304c\u4e0b\u306e\u753b\u50cf\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u305f\u3089 4.5 \u3078\u306e\u66f4\u65b0\u306f\u5b8c\u4e86\u3067\u3059\uff0e\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f \n\n\u306a\u3093\u304b\u3044\u308d\u3044\u308d\u3068\u30ab\u30c3\u30b3\u3088\u304f\u306a\u3063\u3066\u3044\u3066\u611f\u52d5\u2026\n\n\u53c2\u8003\n\ngitbucket/gitbucket\n\n\u30bf\u30a4\u30c8\u30eb\u306e\u901a\u308a\uff0c **Tomcat** \u4e0a\u3067\u7a3c\u50cd\u3057\u3066\u3044\u308b **GitBucket** \u306e\u66f4\u65b0\u624b\u9806\u306e\u81ea\u5206\u7528\u30e1\u30e2\u3067\u3059\uff0e\u81ea\u5206\u306f **3.12** \u304b\u3089 **4.5** \u3078\u306e\u66f4\u65b0\u3092\u884c\u3044\u307e\u3057\u305f\uff0e\n\n\n# \u81ea\u5206\u306e\u74b0\u5883\n* Versions\n\t* CentOS 7.2\n\t* Tomcat 7.0.54\n\t* JVM 1.8.0\n\t* GitBucket 3.12\n* Directories\n\t* GitBucket\u306e **gitbucket.home** \u306f **/var/lib/gitbucket**\n\t* Tomcat\u306e **CATALINA_HOME** \u306f **/usr/share/tomcat**\n\n\u624b\u9806\u5185\u306e`${gitbucket.home}`\u3068\u304b`${CATAILNA_HOME}`\u3068\u304b\u306f\u5404\u3005\u306e\u74b0\u5883\u306b\u5408\u308f\u305b\u3066\u9069\u5b9c\u5909\u3048\u3066\u304f\u3060\u3055\u3044\uff0e\n\n\n# \u624b\u9806\n## 1. \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\n\u3068\u308a\u3042\u3048\u305a\u601d\u8003\u505c\u6b62\u7684\u306b\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3059\u308b\u7656\u304c\u306a\u304b\u306a\u304b\u629c\u3051\u307e\u305b\u3093\uff0e\u3053\u306e\u624b\u9806\u306f\u98db\u3070\u3057\u3066\u3082\u3044\u3044\u3067\u3059\uff0e\n\n```console\n$ mkdir -p ~/backup/gitbucket\n$ sudo cp -R ${gitbucket.home}\u3000~/backup/gitbucket/gitbucket-home\n$ sudo cp -R ${CATALINA_HOME}/webapps/gitbucket ~/backup/gitbucket/gitbucket\n$ sudo cp ${CATALINA_HOME}/webapps/gitbucket.war ~/backup/gitbucket/gitbucket.war\n```\n\n\n## 2. \u65e7GitBucket\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c3.13\u4ee5\u524d\u306e\u5834\u5408\nGitBucket\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c **3.13\u4ee5\u524d** \u306e\u72b6\u614b\u304b\u3089 **4.x** \u306b\u66f4\u65b0\u3057\u3088\u3046\u3068\u3059\u308b\u3068(\u591a\u5206)tomcat\u8d77\u52d5\u6642\u306b\u4e0b\u8a18\u306e\u3088\u3046\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3059\uff0e\n\n```console\n$ sudo cat /var/log/tomcat/localhost.2016-10-29.log\nOct 29, 2016 1:11:34 PM org.apache.catalina.core.StandardContext listenerStart\nSEVERE: Exception sending context initialized event to listener instance of class gitbucket.core.servlet.InitializeListener\njava.lang.Exception: GitBucket can't migrate from this version. Please update to 3.14 at first.\n.\n.\n.\n```\n\n\u305d\u306e\u305f\u3081\uff0c\u307e\u305a\u306f **3.14** \u306b\u66f4\u65b0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\u65e2\u306b3.14\u4ee5\u964d\u306e\u65b9\u306f\u3053\u306e\u7bc0\u306e\u624b\u9806\u306f\u98db\u3070\u3057\u3066\u304f\u3060\u3055\u3044\uff0e\n\n```console\n$ cd ${CATALINA_HOME}/webapps\n$ sudo systemctl stop tomcat\n$ sudo rm -rf gitbucket gitbucket.war\n$ sudo wget https://github.com/gitbucket/gitbucket/releases/download/3.14/gitbucket.war\n$ sudo unzip gitbucket.war -d gitbucket\n```\n\n\u5b97\u6559\u4e0a\u306e\u7406\u7531\u3067gitbucket\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea(\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u304b\u683c\u7d0d\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea)\u3092\u5909\u66f4\u3057\u3066\u3044\u308b\u65b9\u306f\u518d\u5ea6\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n\n```console\n$ sudo vim gitbucket/WEB-INF/web.xml\n```\n\n```web.xml\n<!-- \u4fee\u6b63\u524d\u306e\u8a2d\u5b9a\u3092\u629c\u7c8b -->\n<!--\n<context-param>\n    <param-name>gitbucket.home</param-name>\n    <param-value>PATH_TO_DATADIR</param-value>\n</context-param>\n-->\n\n<!-- \u4fee\u6b63\u5f8c\u306e\u8a2d\u5b9a\u3092\u629c\u7c8b -->\n<!-- \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u89e3\u9664\u3057\u3066gitbucket.home\u306evalue\u3092\u8a2d\u5b9a -->\n<context-param>\n    <param-name>gitbucket.home</param-name>\n    <param-value>${gitbucket.home}</param-value>\n</context-param>\n```\n\n\u3053\u3053\u3067\u4e00\u65e6\u8d77\u52d5\u3057\u3066\u30c6\u30b9\u30c8\uff0e \n**\u5fc5\u305a\u4e00\u5ea6\u306ftomcat\u3092\u8d77\u52d5\u3057\u3066gitbucket\u3078\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304f\u3060\u3055\u3044**\n\n```console\n$ sudo systemctl start tomcat\n```\n\ngitbucket\u3078\u30a2\u30af\u30bb\u30b9\u3057\u3066\uff0c\u30ed\u30b4\u306e\u90e8\u5206\u304c\u4e0b\u306e\u753b\u50cf\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u305f\u3089 **3.14** \u3078\u306e\u66f4\u65b0\u306f\u5b8c\u4e86\u3067\u3059\uff0e\u3042\u3068\u306f\u5ff5\u306e\u305f\u3081repositories\u306e\u78ba\u8a8d\u3068\u304b\uff0e\n\n![gitbucket_3_14.png](https://qiita-image-store.s3.amazonaws.com/0/35230/ab180320-5bbf-83c8-070a-cf53d324c7fc.png \"gitbucket_3_14.png\")\n\n\u5f8c\u306f\u307b\u307c\u540c\u3058\u624b\u9806\u3067 **4.5** \u3078\u66f4\u65b0\u3057\u3066\u3044\u304d\u307e\u3059\uff0e\n\n\n## 3. \u65e7GitBucket\u30d0\u30fc\u30b8\u30e7\u30f3\u304c3.14\u4ee5\u964d\u306e\u5834\u5408\n\u6587\u9762\u306f3.13\u4ee5\u524d\u306e\u5834\u5408\u3068\u307b\u307c\u540c\u3058\u3067\u304f\u3069\u3044\u3067\u3059\u3054\u3081\u3093\u306a\u3055\u3044\uff0e\n\n```console\n$ cd ${CATALINA_HOME}/webapps\n$ sudo systemctl stop tomcat\n$ sudo rm -rf gitbucket gitbucket.war\n$ sudo wget https://github.com/gitbucket/gitbucket/releases/download/4.5/gitbucket.war\n$ sudo unzip gitbucket.war -d gitbucket\n```\n\n\u5b97\u6559\u4e0a\u306e\u7406\u7531\u3067gitbucket\u306e\u30db\u30fc\u30e0\u30c7\u30a3\u30ec\u30af\u30c8\u30ea(\u30ea\u30dd\u30b8\u30c8\u30ea\u3068\u304b\u683c\u7d0d\u3059\u308b\u30c7\u30a3\u30ec\u30af\u30c8\u30ea)\u3092\u5909\u66f4\u3057\u3066\u3044\u308b\u65b9\u306f\u518d\u5ea6\u8a2d\u5b9a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff0e\n\n```console\n$ sudo vim gitbucket/WEB-INF/web.xml\n```\n\n```web.xml\n<!-- \u4fee\u6b63\u524d\u306e\u8a2d\u5b9a\u3092\u629c\u7c8b -->\n<!--\n<context-param>\n    <param-name>gitbucket.home</param-name>\n    <param-value>PATH_TO_DATADIR</param-value>\n</context-param>\n-->\n\n<!-- \u4fee\u6b63\u5f8c\u306e\u8a2d\u5b9a\u3092\u629c\u7c8b -->\n<!-- \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u3092\u89e3\u9664\u3057\u3066gitbucket.home\u306evalue\u3092\u8a2d\u5b9a -->\n<context-param>\n    <param-name>gitbucket.home</param-name>\n    <param-value>${gitbucket.home}</param-value>\n</context-param>\n```\n\n\u3053\u3053\u3067\u4e00\u65e6\u8d77\u52d5\u3057\u3066\u30c6\u30b9\u30c8\uff0e \n\n```console\n$ sudo systemctl start tomcat\n```\n\ngitbucket\u3078\u518d\u5ea6\u30a2\u30af\u30bb\u30b9\u3057\u3066\uff0c\u30ed\u30b4\u306e\u90e8\u5206\u304c\u4e0b\u306e\u753b\u50cf\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u305f\u3089 **4.5** \u3078\u306e\u66f4\u65b0\u306f\u5b8c\u4e86\u3067\u3059\uff0e\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f:tada::tada::tada: \n\n\n![gitbucket_4_5.png](https://qiita-image-store.s3.amazonaws.com/0/35230/bb4ba44d-0b75-49bd-40b5-8ce12a1750ec.png \"gitbucket_4_5.png\")\n\n\u306a\u3093\u304b\u3044\u308d\u3044\u308d\u3068\u30ab\u30c3\u30b3\u3088\u304f\u306a\u3063\u3066\u3044\u3066\u611f\u52d5\u2026\n\n\n# \u53c2\u8003\n* [gitbucket/gitbucket](https://github.com/gitbucket/gitbucket)\n", "tags": ["CentOS", "Tomcat", "GitBucket"]}