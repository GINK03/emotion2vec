{"context": " More than 1 year has passed since last update.keepalived\u3067\u4eee\u60f3IP\u3092\u4f53\u9a13 - Qiita\u306e\u7d9a\u304d\u3002\n\n\u53c2\u8003\n\nDebian squeeze \u3067 lvs \u3068 keepalived \u3092\u4f7f\u3063\u3066\u8ca0\u8377\u5206\u6563\u3092\u3084\u3063\u3066\u307f\u308b\uff08\u5fa9\u7fd2\u7de8\uff09 - \u3088\u3046\u3078\u3044\u306e\u65e5\u3005\u7cbe\u9032 XP\n\n\n\u901a\u5e38master\u5074\n\nkeepalived.conf\nglobal_defs {\n   notification_email {\n     admin@hoge.com\n   }\n   notification_email_from master@hoge.com\n   smtp_server 192.168.100.3\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n}\n\nvrrp_instance VI_1 {\n   interface eth1\n   state MASTER\n   virtual_router_id 51\n   priority 101\n   virtual_ipaddress {\n       192.168.100.103\n   }\n+  notify_master \"/etc/keepalived/master.sh\"\n+  notify_backup \"/etc/keepalived/backup.sh\"\n}\n\n\n\n\u901a\u5e38backup\u5074\n\nkeepalived.conf\nglobal_defs {\n   notification_email {\n     admin@hoge.com\n   }\n   notification_email_from master@hoge.com\n   smtp_server 192.168.100.3\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n}\n\nvrrp_instance VI_1 {\n   interface eth1\n   state BACKUP\n   virtual_router_id 51\n   priority 101\n   virtual_ipaddress {\n       192.168.100.103\n   }\n+  notify_master \"/etc/keepalived/master.sh\"\n+  notify_backup \"/etc/keepalived/backup.sh\"\n}\n\n\n\n\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\n\n/etc/keepalived/master.sh\nsystemctl start mariadb\n\n\n\n/etc/keepalived/backup.sh\nsystemctl stop mariadb\n\n\n\n\u8a2d\u5b9a\u9069\u7528\nsystemctl restart keepalived\n\n\n\n\u52d5\u4f5c\u78ba\u8a8d\n\nmaster\u306b\u306a\u3063\u305f\u3089mariadb\u304c\u8d77\u52d5\nbackup\u306b\u306a\u3063\u305f\u3089mariadb\u304c\u505c\u6b62\n\n\u3092\u78ba\u8a8d\u3002\n\n[keepalived\u3067\u4eee\u60f3IP\u3092\u4f53\u9a13 - Qiita](http://qiita.com/tukiyo3/items/dc355dd456c0973b5a39)\u306e\u7d9a\u304d\u3002\n\n## \u53c2\u8003\n\n* [Debian squeeze \u3067 lvs \u3068 keepalived \u3092\u4f7f\u3063\u3066\u8ca0\u8377\u5206\u6563\u3092\u3084\u3063\u3066\u307f\u308b\uff08\u5fa9\u7fd2\u7de8\uff09 - \u3088\u3046\u3078\u3044\u306e\u65e5\u3005\u7cbe\u9032 XP](http://inokara.hateblo.jp/entry/2013/10/03/232403)\n\n## \u901a\u5e38master\u5074\n\n```diff:keepalived.conf\nglobal_defs {\n   notification_email {\n     admin@hoge.com\n   }\n   notification_email_from master@hoge.com\n   smtp_server 192.168.100.3\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n}\n\nvrrp_instance VI_1 {\n   interface eth1\n   state MASTER\n   virtual_router_id 51\n   priority 101\n   virtual_ipaddress {\n       192.168.100.103\n   }\n+  notify_master \"/etc/keepalived/master.sh\"\n+  notify_backup \"/etc/keepalived/backup.sh\"\n}\n```\n\n## \u901a\u5e38backup\u5074\n\n```diff:keepalived.conf\nglobal_defs {\n   notification_email {\n     admin@hoge.com\n   }\n   notification_email_from master@hoge.com\n   smtp_server 192.168.100.3\n   smtp_connect_timeout 30\n   router_id LVS_DEVEL\n}\n\nvrrp_instance VI_1 {\n   interface eth1\n   state BACKUP\n   virtual_router_id 51\n   priority 101\n   virtual_ipaddress {\n       192.168.100.103\n   }\n+  notify_master \"/etc/keepalived/master.sh\"\n+  notify_backup \"/etc/keepalived/backup.sh\"\n}\n```\n\n## \u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\n\n```bash:/etc/keepalived/master.sh\nsystemctl start mariadb\n```\n\n\n```bash:/etc/keepalived/backup.sh\nsystemctl stop mariadb\n```\n\n\n```bash:\u8a2d\u5b9a\u9069\u7528\nsystemctl restart keepalived\n```\n\n## \u52d5\u4f5c\u78ba\u8a8d\n\n* master\u306b\u306a\u3063\u305f\u3089mariadb\u304c\u8d77\u52d5\n* backup\u306b\u306a\u3063\u305f\u3089mariadb\u304c\u505c\u6b62\n\n\u3092\u78ba\u8a8d\u3002\n", "tags": ["keepalived"]}