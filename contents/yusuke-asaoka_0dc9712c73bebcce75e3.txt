{"context": "\n\n\u3053\u306eAPI\u306b\u3064\u3044\u3066\n\u4ee5\u524d\u306eDeveloper Trial\u304b\u3089\u4eca\u56de\u6b63\u5f0f\u7248\u3068\u3057\u3066LINE MESSAGE API\u304c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u307e\u3057\u305f\u3002\n\u7121\u6599\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u4f7f\u7528\u3067\u304d\u308b\u7bc4\u56f2\u304c\u6bd4\u8f03\u7684\u591a\u3044\u306e\u3067\u3001\u3053\u308c\u304b\u3089\u591a\u5c90\u306b\u6e21\u3063\u3066\u6d3b\u8e8d\u304c\u671f\u5f85\u3067\u304d\u305d\u3046\u3067\u3059\u306d\u3002\nLINE BUSINESS CENTER\n\u3055\u3089\u306b\u4eca\u56de\u8907\u6570\u306e\u8a00\u8a9e\u306b\u5bfe\u5fdc\u3057\u305fSDK\u3082\u516c\u958b\u3055\u308c\u307e\u3057\u305f\u3002\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3082\u65e5\u672c\u8a9e\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u3067\u4f7f\u3044\u3084\u3059\u304f\u5b9f\u88c5\u304c\u3088\u308a\u7c21\u5358\u306b\u306a\u308a\u307e\u3057\u305f\u3002\nAPI Reference\n\u4eca\u56de\u306e\u5185\u5bb9\u306f\u4ee5\u524d\u6295\u7a3f\u3057\u305fDeveloper Trial\u7528\u306e\u300cLINE BOT\u3092\u4f7f\u7528\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u300d\u3068\u540c\u69d8\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u8fd4\u4e8b\u3092\u3059\u308bBOT\u3067\u3059\u3002\n\n\u4e8b\u524d\u6e96\u5099\n\n\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u767b\u9332\n\uff08Channel Secret\u3001Channel Access Token\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002SSL\u306e\u4f7f\u7528\u3067\u304d\u308b\u30b5\u30fc\u30d0\u30fc\u3092\u7528\u610f\u3057\u3066Webhook URL\u306b\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\uff09\ncomposer\u3092\u4f7f\u7528\u3057\u3066SDK\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttps://github.com/line/line-bot-sdk-php\n\nrequire_once('./vendor/autoload.php');\n\nnew LineMessage;\n\nclass LineMessage{\n\n  private $token = '[Channel Access Token]';\n  private $secret = '[Channel Secret]';\n  private $profile_array = array(); //\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u683c\u7d0d\u3059\u308b\u914d\u5217 displayName:\u8868\u793a\u540d userId:\u30e6\u30fc\u30b6\u8b58\u5225\u5b50 pictureUrl:\u753b\u50cfURL statusMessage:\u30b9\u30c6\u30fc\u30bf\u30b9\u30e1\u30c3\u30bb\u30fc\u30b8\n\n  private $replyToken;\n  private $userId;\n  private $httpClient;\n  private $bot;\n\n  function __construct(){\n\n    $json_string = file_get_contents('php://input');\n    $jsonObj = json_decode($json_string);\n    $this->userId = $jsonObj->{\"events\"}[0]->{\"source\"}->{\"userId\"};\n    $this->replyToken = $jsonObj->{\"events\"}[0]->{\"replyToken\"};\n\n    $this->httpClient = new \\LINE\\LINEBot\\HTTPClient\\CurlHTTPClient($this->token);\n    $this->bot = new \\LINE\\LINEBot($this->httpClient, ['channelSecret' => $this->secret]);\n\n    $this->get_profile();\n\n  }\n\n  function get_profile(){\n\n    $response = $this->bot->getProfile($this->userId);\n\n    if ($response->isSucceeded()) {\n\n      $profile = $response->getJSONDecodedBody();\n      $displayName = $profile['displayName'];\n      $userId = $profile['userId'];\n      $pictureUrl = $profile['pictureUrl'];\n      $statusMessage = $profile['statusMessage'];\n      $this->profile_array = array(\"displayName\"=>$displayName,\"userId\"=>$userId,\"pictureUrl\"=>$pictureUrl,\"statusMessage\"=>$statusMessage);\n      $this->reply_message();\n    }\n  }\n\n  function reply_message(){\n\n    $textMessageBuilder = new \\LINE\\LINEBot\\MessageBuilder\\TextMessageBuilder($this->profile_array[\"displayName\"].\"\u3055\u3093\u3053\u3093\u306b\u3061\u306f\uff01\");\n    $response = $this->bot->replyMessage($this->replyToken, $textMessageBuilder);   \n  }\n\n}\n\n\n\u6ce8\u610f\u4e8b\u9805\uff08\u203b2016/10/25\u6642\u70b9\uff09\n\u73fe\u6642\u70b9\u3067API Reference\u3092\u53c2\u8003\u306b\u5b9f\u88c5\u3059\u308b\u3068\u5e7e\u3064\u304b\u306e\u4e0d\u5177\u5408\u304c\u751f\u3058\u307e\u3059\u3002\n\u4fee\u6b63\u6e08 (2016/10/27)\nGet Profile\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u53d6\u5f97\u90e8\u5206\n\u8aa4\n$profile = decode_json($response->getBody);\n\u6b63\n$profile = json_decode($response->getRawBody());\n\n\u95a2\u6570\u306edecode_json\u3092json_decode\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\ngetBody\u306f\u4f7f\u3048\u306a\u3044\u307f\u305f\u3044\u3067\u3059\u3001GitHub\u3092\u53c2\u8003\u306b\u3059\u308b\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u30dc\u30c7\u30a3\u90e8\u5206\u3092\u53d6\u5f97\u3059\u308b\u969b\u306b\u306f\u3069\u3046\u3084\u3089getRawBody\u3092\u4f7f\u7528\u3059\u308b\u306e\u304c\u6b63\u89e3\u307f\u305f\u3044\u3067\u3059\u3002\n\n\u8ffd\u8a18\uff08\u203b2016/10/27\u6642\u70b9\uff09\nAPI Reference\u306b\u4fee\u6b63\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\u65e7\n$profile = decode_json($response->getBody);\n\u65b0\n$profile = $response->getJSONDecodedBody();\n\n\u3053\u3061\u3089\u306egetJSONDecodedBody\u3092\u4f7f\u7528\u3059\u308b\u4e8b\u306b\u3088\u308a\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u306b\u5bfe\u3057\u3066JSON\u3092\u30c7\u30b3\u30fc\u30c9\u3057\u305f\u914d\u5217\u3067\u53d6\u5f97\u3067\u304d\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n#\u3053\u306eAPI\u306b\u3064\u3044\u3066\n\n\n\u4ee5\u524d\u306eDeveloper Trial\u304b\u3089\u4eca\u56de\u6b63\u5f0f\u7248\u3068\u3057\u3066LINE MESSAGE API\u304c\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u307e\u3057\u305f\u3002\n\u7121\u6599\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u4f7f\u7528\u3067\u304d\u308b\u7bc4\u56f2\u304c\u6bd4\u8f03\u7684\u591a\u3044\u306e\u3067\u3001\u3053\u308c\u304b\u3089\u591a\u5c90\u306b\u6e21\u3063\u3066\u6d3b\u8e8d\u304c\u671f\u5f85\u3067\u304d\u305d\u3046\u3067\u3059\u306d\u3002\n[LINE BUSINESS CENTER](https://business.line.me/ja/services/bot)\n\n\u3055\u3089\u306b\u4eca\u56de\u8907\u6570\u306e\u8a00\u8a9e\u306b\u5bfe\u5fdc\u3057\u305fSDK\u3082\u516c\u958b\u3055\u308c\u307e\u3057\u305f\u3002\n\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9\u3082\u65e5\u672c\u8a9e\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u308b\u306e\u3067\u4f7f\u3044\u3084\u3059\u304f\u5b9f\u88c5\u304c\u3088\u308a\u7c21\u5358\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n[API Reference](https://devdocs.line.me/ja/)\n\n\n\u4eca\u56de\u306e\u5185\u5bb9\u306f\u4ee5\u524d\u6295\u7a3f\u3057\u305fDeveloper Trial\u7528\u306e[\u300cLINE BOT\u3092\u4f7f\u7528\u3057\u3066\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u53d6\u5f97\u3059\u308b\u300d](http://qiita.com/yusuke-asaoka/items/0fa63d1e5cf27fe48aaa)\u3068\u540c\u69d8\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u8fd4\u4e8b\u3092\u3059\u308bBOT\u3067\u3059\u3002\n\n#\u4e8b\u524d\u6e96\u5099\n- \u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u767b\u9332\n\uff08**Channel Secret**\u3001**Channel Access Token**\u304c\u5fc5\u8981\u306b\u306a\u308a\u307e\u3059\u3002SSL\u306e\u4f7f\u7528\u3067\u304d\u308b\u30b5\u30fc\u30d0\u30fc\u3092\u7528\u610f\u3057\u3066**Webhook URL**\u306b\u8a2d\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\uff09\n\n- composer\u3092\u4f7f\u7528\u3057\u3066SDK\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nhttps://github.com/line/line-bot-sdk-php\n\n```php\nrequire_once('./vendor/autoload.php');\n\nnew LineMessage;\n\nclass LineMessage{\n\n  private $token = '[Channel Access Token]';\n  private $secret = '[Channel Secret]';\n  private $profile_array = array(); //\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u683c\u7d0d\u3059\u308b\u914d\u5217 displayName:\u8868\u793a\u540d userId:\u30e6\u30fc\u30b6\u8b58\u5225\u5b50 pictureUrl:\u753b\u50cfURL statusMessage:\u30b9\u30c6\u30fc\u30bf\u30b9\u30e1\u30c3\u30bb\u30fc\u30b8\n  \n  private $replyToken;\n  private $userId;\n  private $httpClient;\n  private $bot;\n\n  function __construct(){\n\n    $json_string = file_get_contents('php://input');\n    $jsonObj = json_decode($json_string);\n    $this->userId = $jsonObj->{\"events\"}[0]->{\"source\"}->{\"userId\"};\n    $this->replyToken = $jsonObj->{\"events\"}[0]->{\"replyToken\"};\n\t\t\n    $this->httpClient = new \\LINE\\LINEBot\\HTTPClient\\CurlHTTPClient($this->token);\n    $this->bot = new \\LINE\\LINEBot($this->httpClient, ['channelSecret' => $this->secret]);\n\n    $this->get_profile();\n\n  }\n\n  function get_profile(){\n\n    $response = $this->bot->getProfile($this->userId);\n\n    if ($response->isSucceeded()) {\n\t\t\t\n      $profile = $response->getJSONDecodedBody();\n      $displayName = $profile['displayName'];\n      $userId = $profile['userId'];\n      $pictureUrl = $profile['pictureUrl'];\n      $statusMessage = $profile['statusMessage'];\n      $this->profile_array = array(\"displayName\"=>$displayName,\"userId\"=>$userId,\"pictureUrl\"=>$pictureUrl,\"statusMessage\"=>$statusMessage);\n      $this->reply_message();\n    }\n  }\n\n  function reply_message(){\n\n    $textMessageBuilder = new \\LINE\\LINEBot\\MessageBuilder\\TextMessageBuilder($this->profile_array[\"displayName\"].\"\u3055\u3093\u3053\u3093\u306b\u3061\u306f\uff01\");\n    $response = $this->bot->replyMessage($this->replyToken, $textMessageBuilder);\t\n  }\n\n}\n```\n\n#\u6ce8\u610f\u4e8b\u9805\uff08\u203b2016/10/25\u6642\u70b9\uff09\n\n~~\u73fe\u6642\u70b9\u3067[API Reference](https://devdocs.line.me/ja/)\u3092\u53c2\u8003\u306b\u5b9f\u88c5\u3059\u308b\u3068\u5e7e\u3064\u304b\u306e\u4e0d\u5177\u5408\u304c\u751f\u3058\u307e\u3059\u3002~~\n**\u4fee\u6b63\u6e08 (2016/10/27)**\n\n**Get Profile**\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u53d6\u5f97\u90e8\u5206\n\n```php\n\u8aa4\n$profile = decode_json($response->getBody);\n\u6b63\n$profile = json_decode($response->getRawBody());\n```\n\u95a2\u6570\u306edecode_json\u3092[**json_decode**](http://php.net/manual/ja/function.json-decode.php)\u306b\u5909\u66f4\u3057\u307e\u3059\u3002\n**getBody**\u306f\u4f7f\u3048\u306a\u3044\u307f\u305f\u3044\u3067\u3059\u3001[GitHub](https://github.com/line/line-bot-sdk-php#user-content-response)\u3092\u53c2\u8003\u306b\u3059\u308b\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u30dc\u30c7\u30a3\u90e8\u5206\u3092\u53d6\u5f97\u3059\u308b\u969b\u306b\u306f\u3069\u3046\u3084\u3089**getRawBody**\u3092\u4f7f\u7528\u3059\u308b\u306e\u304c\u6b63\u89e3\u307f\u305f\u3044\u3067\u3059\u3002\n\n#\u8ffd\u8a18\uff08\u203b2016/10/27\u6642\u70b9\uff09\n[API Reference](https://devdocs.line.me/ja/)\u306b\u4fee\u6b63\u304c\u3042\u308a\u307e\u3057\u305f\u3002\n\n```php\n\u65e7\n$profile = decode_json($response->getBody);\n\u65b0\n$profile = $response->getJSONDecodedBody();\n```\n\u3053\u3061\u3089\u306e**getJSONDecodedBody**\u3092\u4f7f\u7528\u3059\u308b\u4e8b\u306b\u3088\u308a\u30ec\u30b9\u30dd\u30f3\u30b9\u30dc\u30c7\u30a3\u306b\u5bfe\u3057\u3066JSON\u3092\u30c7\u30b3\u30fc\u30c9\u3057\u305f\u914d\u5217\u3067\u53d6\u5f97\u3067\u304d\u308b\u307f\u305f\u3044\u3067\u3059\u3002\n", "tags": ["linebot", "LINEmessagingAPI", "PHP"]}